<!DOCTYPE html><html><head><title>Help for package Correlplot</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Correlplot}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aircraft'><p>Characteristics of aircraft</p></a></li>
<li><a href='#aircraftR'><p>Correlations between characteristics of aircraft</p></a></li>
<li><a href='#angleToR'>
<p>Convert angles to correlations.</p></a></li>
<li><a href='#artificialR'><p>Correlations for 10 generated variables</p></a></li>
<li><a href='#athletesR'><p>Correlation matrix of characteristics of Australian athletes</p></a></li>
<li><a href='#banknotes'>
<p>Swiss banknote data</p></a></li>
<li><a href='#berkeleyR'><p>Correlation matrix for boys of the Berkeley Guidance Study</p></a></li>
<li><a href='#cathedralsR'><p>Correlation matrix for height and length</p></a></li>
<li><a href='#correlogram'>
<p>Plot a correlogram</p></a></li>
<li><a href='#countriesR'><p>Correlations between educational and demographic variables</p></a></li>
<li><a href='#fit_angles'><p>Fit angles to a correlation matrix</p></a></li>
<li><a href='#FitRDeltaQSym'><p>Approximation of a correlation matrix with column adjustment and symmetric low rank factorization</p></a></li>
<li><a href='#FitRwithPCAandWALS'>
<p>Calculate a low-rank approximation to the correlation matrix with four methods</p></a></li>
<li><a href='#fysiologyR'><p>Correlations between thirtheen fysiological variables</p></a></li>
<li><a href='#ggbplot'>
<p>Create a biplot with ggplot2</p></a></li>
<li><a href='#ggcorrelogram'>
<p>Create a correlogram as a ggplot object.</p></a></li>
<li><a href='#ggtally'>
<p>Create a correlation tally stick on a biplot vector</p></a></li>
<li><a href='#gobletsR'><p>Correlations between size measurements of archeological goblets</p></a></li>
<li><a href='#HeartAttack'>
<p>Myocardial infarction or Heart attack data</p></a></li>
<li><a href='#ipSymLS'>
<p>Function for obtaining a weighted least squares low-rank approximation of a symmetric matrix</p></a></li>
<li><a href='#jointlim'><p>Establish limits for x and y axis</p></a></li>
<li><a href='#Keller'>
<p>Program <code>Keller</code> calculates a rank p approximation to a correlation matrix according to Keller's method.</p></a></li>
<li><a href='#Kernels'>
<p>Wheat kernel data</p></a></li>
<li><a href='#linangplot'><p>Linang plot</p></a></li>
<li><a href='#lincos'>
<p>Linearized cosine function</p></a></li>
<li><a href='#pco'><p>Principal Coordinate Analysis</p></a></li>
<li><a href='#PearsonLee'><p>Heights of mothers and daughters</p></a></li>
<li><a href='#pfa'><p>Principal factor analysis</p></a></li>
<li><a href='#proteinR'><p>Correlations between sources of protein</p></a></li>
<li><a href='#proteinsR'><p>Correlations between sources of protein</p></a></li>
<li><a href='#recordsR'><p>Correlations between  national track records for men</p></a></li>
<li><a href='#rmse'>
<p>Calculate the root mean squared error</p></a></li>
<li><a href='#rmsePCAandWALS'>
<p>Generate a table of root mean square error (RMSE) statistics for principal component analysis (PCA) and</p>
weighted alternating least squares (WALS).</a></li>
<li><a href='#storksR'><p>Correlations between three  variables</p></a></li>
<li><a href='#students'><p>Marks for 5 student exams</p></a></li>
<li><a href='#studentsR'><p>Correlations between marks for 5 exams</p></a></li>
<li><a href='#tally'>
<p>Create a tally on a biplot vector</p></a></li>
<li><a href='#tr'><p>Compute the trace of a matrix</p></a></li>
<li><a href='#wAddPCA'>
<p>Low-rank matrix approximation by weighted alternating least squares</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Collection of Functions for Graphing Correlation Matrices</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-23</td>
</tr>
<tr>
<td>Author:</td>
<td>Jan Graffelman [aut, cre],
  Jan De Leeuw [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jan Graffelman &lt;jan.graffelman@upc.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0), calibrate</td>
</tr>
<tr>
<td>Imports:</td>
<td>corrplot, xtable, MASS, lsei, ggplot2</td>
</tr>
<tr>
<td>Description:</td>
<td>Routines for the graphical representation of correlation matrices by means of correlograms, MDS maps and biplots obtained by PCA, PFA or WALS (weighted alternating least squares); See Graffelman &amp; De Leeuw (2023) &lt;<a href="https://doi.org/10.1080%2F00031305.2023.2186952">doi:10.1080/00031305.2023.2186952</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a>, <a href="http://www-eio.upc.es/~jan/">http://www-eio.upc.es/~jan/</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-23 08:51:07 UTC; TanitSunShine</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-23 15:12:52 UTC</td>
</tr>
</table>
<hr>
<h2 id='aircraft'>Characteristics of aircraft</h2><span id='topic+aircraft'></span>

<h3>Description</h3>

<p>Four variables registered for 21 types of aircraft.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("aircraft")</code></pre>


<h3>Format</h3>

<p>A data frame with 21 observations on the following 4 variables.
</p>

<dl>
<dt><code>SPR</code></dt><dd><p>specific power</p>
</dd>
<dt><code>RGF</code></dt><dd><p>flight range factor</p>
</dd>
<dt><code>PLF</code></dt><dd><p>payload</p>
</dd>
<dt><code>SLF</code></dt><dd><p>sustained load factor</p>
</dd>
</dl>



<h3>Source</h3>

<p>Gower and Hand, Table 2.1</p>


<h3>References</h3>

<p>Gower, J.C. and Hand, D.J. (1996) <em>Biplots</em>, Chapman &amp; Hall, London</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aircraft)
str(aircraft)
</code></pre>

<hr>
<h2 id='aircraftR'>Correlations between characteristics of aircraft</h2><span id='topic+aircraftR'></span>

<h3>Description</h3>

<p>Correlations between SPR (specific power), RGF (flight range factor),
PLF (payload) and SLF (sustained load factor) for 21 types of aircraft.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aircraftR)</code></pre>


<h3>Format</h3>

<p>a matrix containing the correlations</p>


<h3>Source</h3>

<p>Gower and Hand, Table 2.1</p>


<h3>References</h3>

<p>Gower, J.C. and Hand, D.J. (1996) <em>Biplots</em>, Chapman &amp; Hall, London</p>

<hr>
<h2 id='angleToR'>
Convert angles to correlations.
</h2><span id='topic+angleToR'></span>

<h3>Description</h3>

<p>Function <code>angleToR</code> converts a vector of angles (in radians) to an
estimate of the correlation matrix, given an interpretation function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>angleToR(x, ifun = "cos")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="angleToR_+3A_x">x</code></td>
<td>
<p>a vector of angles (in radians)</p>
</td></tr>
<tr><td><code id="angleToR_+3A_ifun">ifun</code></td>
<td>
<p>the interpretation function (&quot;cos&quot; or &quot;lincos&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A correlation matrix</p>


<h3>Author(s)</h3>

<p>Jan Graffelman (jan.graffelman@upc.edu)</p>


<h3>References</h3>

<p>Graffelman, J. (2012) Linear-angle correlation plots: new graphs for revealing correlation structure. Journal of Computational and Graphical Statistics. 22(1): 92-106. 
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+cos">cos</a></code>,<code><a href="#topic+lincos">lincos</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>angles &lt;- c(0,pi/3)
R &lt;- angleToR(angles)
print(R)
</code></pre>

<hr>
<h2 id='artificialR'>Correlations for 10 generated variables</h2><span id='topic+artificialR'></span>

<h3>Description</h3>

<p>A 10 by 10 artificial correlation matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(artificialR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Trosset (2005), Table 1.</p>


<h3>References</h3>

<p>Trosset, M.W. (2005) Visualizing correlation. <em>Journal of Computational and Graphical Statistics</em>,
14(1), pp. 1&ndash;19.
</p>

<hr>
<h2 id='athletesR'>Correlation matrix of characteristics of Australian athletes</h2><span id='topic+athletesR'></span>

<h3>Description</h3>

<p>Correlation matrix of 12 characteristics of Austration athletes (Sex,
Height, Weight, Lean Body Mass, RCC, WCC, Hc, Hg, Ferr, BMI, SSF, Bfat)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(athletesR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Weisberg (2005), file ais.txt</p>


<h3>References</h3>

<p>Weisberg, S. (2005) <em>Applied Linear Regression</em>. Third edition, John Wiley &amp; Sons,
New Jersey.
</p>

<hr>
<h2 id='banknotes'>
Swiss banknote data
</h2><span id='topic+banknotes'></span>

<h3>Description</h3>

<p>The Swiss banknote data consist of six measures taken on 200 banknotes, of which 100 are counterfeits, and 100 are normal. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("banknotes")</code></pre>


<h3>Format</h3>

<p>A data frame with 200 observations on the following 7 variables.
</p>

<dl>
<dt><code>Length</code></dt><dd><p>Banknote length</p>
</dd>
<dt><code>Left</code></dt><dd><p>Left width</p>
</dd>
<dt><code>Right</code></dt><dd><p>Right width</p>
</dd>
<dt><code>Bottom</code></dt><dd><p>Bottom margin</p>
</dd>
<dt><code>Top</code></dt><dd><p>Top margin</p>
</dd>
<dt><code>Diagonal</code></dt><dd><p>Length of the diagonal of the image</p>
</dd>
<dt><code>Counterfeit</code></dt><dd><p>0 = normal, 1 = counterfeit</p>
</dd>
</dl>



<h3>References</h3>

<p>Weisberg, S. (2005) Applied Linear Regression. Third edition. John Wiley &amp; Sons, New Jersey.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(banknotes)
</code></pre>

<hr>
<h2 id='berkeleyR'>Correlation matrix for boys of the Berkeley Guidance Study</h2><span id='topic+berkeleyR'></span>

<h3>Description</h3>

<p>Correlation matrix for sex, height and weight at age 2, 9 and 18 and somatotype
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(berkeleyR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Weisberg (2005), file BGSBoys.txt</p>


<h3>References</h3>

<p>Weisberg, S. (2005) <em>Applied Linear Regression</em>. Third edition, John Wiley &amp; Sons,
New Jersey.
</p>

<hr>
<h2 id='cathedralsR'>Correlation matrix for height and length</h2><span id='topic+cathedralsR'></span>

<h3>Description</h3>

<p>Correlation between nave height and total length</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cathedralsR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Weisberg (2005), file cathedral.txt</p>


<h3>References</h3>

<p>Weisberg, S. (2005) <em>Applied Linear Regression</em>. Third edition, John Wiley &amp; Sons,
New Jersey.
</p>

<hr>
<h2 id='correlogram'>
Plot a correlogram
</h2><span id='topic+correlogram'></span>

<h3>Description</h3>

<p><code>correlogram</code> plots a correlogram for a correlation matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>correlogram(R,labs=colnames(R),ifun="cos",cex=1,main="",ntrials=50,
            xlim=c(-1.2,1.2),ylim=c(-1.2,1.2),pos=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="correlogram_+3A_r">R</code></td>
<td>
<p>a correlation matrix.</p>
</td></tr>
<tr><td><code id="correlogram_+3A_labs">labs</code></td>
<td>
<p>a vector of labels for the variables.</p>
</td></tr>
<tr><td><code id="correlogram_+3A_ifun">ifun</code></td>
<td>
<p>the interpretation function (&quot;cos&quot; or &quot;lincos&quot;)</p>
</td></tr>
<tr><td><code id="correlogram_+3A_cex">cex</code></td>
<td>
<p>character expansion factor for the variable labels</p>
</td></tr>
<tr><td><code id="correlogram_+3A_main">main</code></td>
<td>
<p>a title for the correlogram</p>
</td></tr>
<tr><td><code id="correlogram_+3A_ntrials">ntrials</code></td>
<td>
<p>number of starting points for the optimization routine</p>
</td></tr>
<tr><td><code id="correlogram_+3A_xlim">xlim</code></td>
<td>
<p>limits for the x axis (e.g. c(-1.2,1.2))</p>
</td></tr>
<tr><td><code id="correlogram_+3A_ylim">ylim</code></td>
<td>
<p>limits for the y axis (e.g. c(-1.2,1.2))</p>
</td></tr>
<tr><td><code id="correlogram_+3A_pos">pos</code></td>
<td>
<p>if specified, overrules the calculated label positions for the variables.</p>
</td></tr>
<tr><td><code id="correlogram_+3A_...">...</code></td>
<td>
<p>additional arguments for the <code>plot</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>correlogram</code> makes a correlogram on the basis of a set of
angles. All angles are given w.r.t the positive x-axis. Variables are
represented by unit vectors emanating from the origin.
</p>


<h3>Value</h3>

<p>A vector of angles</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Trosset, M.W. (2005) Visualizing correlation. Journal of Computational and Graphical Statistics
14(1), pp. 1&ndash;19</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_angles">fit_angles</a></code>,<code><a href="stats.html#topic+nlminb">nlminb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(rnorm(90),ncol=3)
R &lt;- cor(X)
angles &lt;- correlogram(R)
</code></pre>

<hr>
<h2 id='countriesR'>Correlations between educational and demographic variables</h2><span id='topic+countriesR'></span>

<h3>Description</h3>

<p>Correlations between infant mortality, educational and demographic variables
(infd, phys, dens, agds, lit, hied, gnp)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(countriesR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Chatterjee and Hadi (1988)</p>


<h3>References</h3>

<p>Chatterjee, S. and Hadi, A.S. (1988), <em>Sensitivity Analysis in Regression</em>.
Wiley, New York.
</p>

<hr>
<h2 id='fit_angles'>Fit angles to a correlation matrix</h2><span id='topic+fit_angles'></span>

<h3>Description</h3>

<p><code>fit_angles</code> finds a set of optimal angles for representing a
particular correlation matrix by angles between vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_angles(R, ifun = "cos", ntrials = 10, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_angles_+3A_r">R</code></td>
<td>
<p>a correlation matrix.</p>
</td></tr>
<tr><td><code id="fit_angles_+3A_ifun">ifun</code></td>
<td>
<p>an angle interpretation function (cosine, by default).</p>
</td></tr>
<tr><td><code id="fit_angles_+3A_ntrials">ntrials</code></td>
<td>
<p>number of trials for optimization routine <code>nlminb</code></p>
</td></tr>
<tr><td><code id="fit_angles_+3A_verbose">verbose</code></td>
<td>
<p>be silent (FALSE), or produce more output (TRUE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of angles (in radians)</p>


<h3>Author(s)</h3>

<p> anonymous </p>


<h3>References</h3>

<p>Trosset, M.W. (2005) Visualizing correlation. Journal of Computational and Graphical Statistics
14(1), pp. 1&ndash;19</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nlminb">nlminb</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(rnorm(90),ncol=3)
R &lt;- cor(X)
angles &lt;- fit_angles(R)
print(angles)
</code></pre>

<hr>
<h2 id='FitRDeltaQSym'>Approximation of a correlation matrix with column adjustment and symmetric low rank factorization</h2><span id='topic+FitRDeltaQSym'></span>

<h3>Description</h3>

<p>Program <code>FitRDeltaQSym</code> calculates a low rank factorization for a correlation matrix. It adjusts for column effects, and the approximation is therefore asymmetric.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitRDeltaQSym(R, W = NULL, nd = 2, eps = 1e-10, delta = 0, q = colMeans(R),
              itmax.inner = 1000, itmax.outer = 1000, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FitRDeltaQSym_+3A_r">R</code></td>
<td>
<p>A correlation matrix</p>
</td></tr>
<tr><td><code id="FitRDeltaQSym_+3A_w">W</code></td>
<td>
<p>A weight matrix (optional)</p>
</td></tr>
<tr><td><code id="FitRDeltaQSym_+3A_nd">nd</code></td>
<td>
<p>The rank of the low rank approximation</p>
</td></tr>
<tr><td><code id="FitRDeltaQSym_+3A_eps">eps</code></td>
<td>
<p>The convergence criterion</p>
</td></tr>
<tr><td><code id="FitRDeltaQSym_+3A_delta">delta</code></td>
<td>
<p>Initial value for the scalar adjustment (zero by default)</p>
</td></tr>
<tr><td><code id="FitRDeltaQSym_+3A_q">q</code></td>
<td>
<p>Initial values for the column adjustments (random by default)</p>
</td></tr>
<tr><td><code id="FitRDeltaQSym_+3A_itmax.inner">itmax.inner</code></td>
<td>
<p>Maximum number of iterations for the inner loop of the algorithm</p>
</td></tr>
<tr><td><code id="FitRDeltaQSym_+3A_itmax.outer">itmax.outer</code></td>
<td>
<p>Maximum number of iterations for the outer loop of the algorithm</p>
</td></tr>
<tr><td><code id="FitRDeltaQSym_+3A_verbose">verbose</code></td>
<td>
<p>Print information or not</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Program <code>FitRDeltaQSym</code> implements an iterative algorithm for the low rank factorization of the correlation matrix. It decomposes the correlation matrix as R = delta J + 1 q' + G G' + E. The approximation of R is ultimately asymmetric, but the low rank factorization used for biplotting (G G') is symmetric. 
</p>


<h3>Value</h3>

<p>A list object with fields:
</p>
<table>
<tr><td><code>delta</code></td>
<td>
<p>The final scalar adjustment</p>
</td></tr>
<tr><td><code>Rhat</code></td>
<td>
<p>The final approximation to the correlation matrix</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>The matrix of biplot vectors</p>
</td></tr>
<tr><td><code>rmse</code></td>
<td>
<p>The root mean squared error</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The final column adjustments</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Graffelman, J. and De Leeuw, J. (2023) Improved approximation and visualization of the correlation matrix. The American Statistician pp. 1&ndash;20. Available online as latest article  <a href="https://doi.org/10.1080/00031305.2023.2186952">doi:10.1080/00031305.2023.2186952</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wAddPCA">wAddPCA</a>,<a href="#topic+ipSymLS">ipSymLS</a>,<a href="#topic+Keller">Keller</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HeartAttack)
X &lt;- HeartAttack[,1:7]
X[,7] &lt;- log(X[,7])
colnames(X)[7] &lt;- "logPR"
R &lt;- cor(X)
W &lt;- matrix(1, 7, 7)
diag(W) &lt;- 0
out.sym &lt;- FitRDeltaQSym(R, W, eps=1e-6) 
Rhat &lt;- out.sym$Rhat
</code></pre>

<hr>
<h2 id='FitRwithPCAandWALS'>
Calculate a low-rank approximation to the correlation matrix with four methods
</h2><span id='topic+FitRwithPCAandWALS'></span>

<h3>Description</h3>

<p>Function <code>FitRwithPCAandWALS</code> uses principal component analysis (PCA) and weighted alternating least squares (WALS) to
calculate different low-rank approximations to the correlation matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitRwithPCAandWALS(R, nd = 2, itmaxout = 10000, itmaxin = 10000, eps = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FitRwithPCAandWALS_+3A_r">R</code></td>
<td>
<p>The correlation matrix</p>
</td></tr>
<tr><td><code id="FitRwithPCAandWALS_+3A_nd">nd</code></td>
<td>
<p>The dimensionality of the low-rank solution (2 by default)</p>
</td></tr>
<tr><td><code id="FitRwithPCAandWALS_+3A_itmaxout">itmaxout</code></td>
<td>
<p>Maximum number of iterations for the outer loop of the algorithm</p>
</td></tr>
<tr><td><code id="FitRwithPCAandWALS_+3A_itmaxin">itmaxin</code></td>
<td>
<p>Maximum number of iterations for the inner loop of the algorithm</p>
</td></tr>
<tr><td><code id="FitRwithPCAandWALS_+3A_eps">eps</code></td>
<td>
<p>Numerical criterion for convergence of the outer loop</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Four methods are run succesively: standard PCA; PCA with an additive adjustment; WALS avoiding the fit of the diagonal;
WALS avoiding the fit of the diagonal and with an additive adjustment.
</p>


<h3>Value</h3>

<p>A list object with fields:
</p>
<table>
<tr><td><code>Rhat.pca</code></td>
<td>
<p>Low-rank approximation obtained by PCA</p>
</td></tr>
<tr><td><code>Rhat.pca.adj</code></td>
<td>
<p>Low-rank approximation obtained by PCA with adjustment</p>
</td></tr>
<tr><td><code>Rhat.wals</code></td>
<td>
<p>Low-rank approximation obtained by WALS without fitting the diagonal</p>
</td></tr>
<tr><td><code>Rhat.wals.adj</code></td>
<td>
<p>Low-rank approximation obtained by WALS without fitting the diagonal and with adjustment</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Graffelman, J. and De Leeuw, J. (2023) Improved approximation and visualization of the correlation matrix. The American Statistician pp. 1&ndash;20. Available online as latest article  <a href="https://doi.org/10.1080/00031305.2023.2186952">doi:10.1080/00031305.2023.2186952</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+wAddPCA">wAddPCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HeartAttack)
X &lt;- HeartAttack[,1:7]
X[,7] &lt;- log(X[,7])
colnames(X)[7] &lt;- "logPR"
R &lt;- cor(X)
## Not run: 
out &lt;- FitRwithPCAandWALS(R)

## End(Not run)
</code></pre>

<hr>
<h2 id='fysiologyR'>Correlations between thirtheen fysiological variables</h2><span id='topic+fysiologyR'></span>

<h3>Description</h3>

<p>Correlations of 13 fysiological variables (sys, dia, p.p., pul, cort,
u.v., tot/100, adr/100, nor/100, adr/tot, tot/hr, adr/hr, nor/hr)
obtained from 48 medical students
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fysiologyR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Hills (1969), Table 1.</p>


<h3>References</h3>

<p>Hills, M (1969) On looking at large correlation matices
<em>Biometrika</em> 56(2): pp. 249.
</p>

<hr>
<h2 id='ggbplot'>
Create a biplot with ggplot2
</h2><span id='topic+ggbplot'></span>

<h3>Description</h3>

<p>Function <code>ggbiplot</code> creates a biplot of a matrix with ggplot2 graphics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggbplot(A, B, main = "", circle = TRUE, xlab = "", ylab = "", main.size = 8,
xlim = c(-1, 1), ylim = c(-1, 1), rowcolor = "red", rowch = 1, colcolor = "blue",
colch = 1, rowarrow = FALSE, colarrow = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggbplot_+3A_a">A</code></td>
<td>
<p>A dataframe with coordinates and names for the biplot row markers</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_b">B</code></td>
<td>
<p>A dataframe with coordinates and names for the biplot column markers</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_main">main</code></td>
<td>
<p>A title for the biplot</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_circle">circle</code></td>
<td>
<p>Draw a unit circle (<code>circle=TRUE</code>) or not (<code>circle=FALSE</code>)</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_xlab">xlab</code></td>
<td>
<p>The label for the x axis</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_ylab">ylab</code></td>
<td>
<p>The label for the y axis</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_main.size">main.size</code></td>
<td>
<p>Size of the main title</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_xlim">xlim</code></td>
<td>
<p>Limits for the horizontal axis</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_ylim">ylim</code></td>
<td>
<p>Limits for the vertical axis</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_rowcolor">rowcolor</code></td>
<td>
<p>Color used for the row markers</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_rowch">rowch</code></td>
<td>
<p>Symbol used for the row markers</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_colcolor">colcolor</code></td>
<td>
<p>Color used for the column markers</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_colch">colch</code></td>
<td>
<p>Symbol used for the column markers</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_rowarrow">rowarrow</code></td>
<td>
<p>Draw arrows from the origin to the row markers (<code>rowarrow=TRUE</code>) or not</p>
</td></tr>
<tr><td><code id="ggbplot_+3A_colarrow">colarrow</code></td>
<td>
<p>Draw arrows from the origin to the column markers (<code>colarrow=TRUE</code>) or not</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dataframes <code>A</code> and <code>B</code> must consists of three columns labeled &quot;PA1&quot;, &quot;PA2&quot; (coordinates of the first and second principal axis) and a column &quot;strings&quot; with the labels for the coordinates.
</p>
<p>Dataframe <code>B</code> is optional. If it is not specified, a biplot with a single set of markers is constructed, for which the row settings must be specified.</p>


<h3>Value</h3>

<p>A ggplot2 object</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Graffelman, J. and De Leeuw, J. (2023) On the visualisation of the correlation matrix. Available online. <a href="https://doi.org/10.48550/arXiv.2211.13150">doi:10.48550/arXiv.2211.13150</a></p>


<h3>See Also</h3>

<p><code>bplot</code>,<code><a href="#topic+ggtally">ggtally</a></code>,<code><a href="stats.html#topic+biplot">biplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("HeartAttack")
X &lt;- as.matrix(HeartAttack[,1:7])
n &lt;- nrow(X)
Xt &lt;- scale(X)/sqrt(n-1)
res.svd &lt;- svd(Xt)
Fs &lt;- sqrt(n)*res.svd$u # standardized principal components
Gp &lt;- crossprod(t(res.svd$v),diag(res.svd$d)) # biplot coordinates for variables
rows.df &lt;- data.frame(Fs[,1:2],as.character(1:n))
colnames(rows.df) &lt;- c("PA1","PA2","strings")
cols.df &lt;- data.frame(Gp[,1:2],colnames(X))
colnames(cols.df) &lt;- c("PA1","PA2","strings")
ggbplot(rows.df,cols.df,xlab="PA1",ylab="PA2",main="PCA")
</code></pre>

<hr>
<h2 id='ggcorrelogram'>
Create a correlogram as a ggplot object.
</h2><span id='topic+ggcorrelogram'></span>

<h3>Description</h3>

<p>Function <code>ggcorrelogram</code> creates a correlogram of a correlation matrix using ggplot graphics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggcorrelogram(R, labs = colnames(R), ifun = "cos", cex = 1, main = "", ntrials = 50,
              xlim = c(-1.2, 1.2), ylim = c(-1.2, 1.2), hjust = 1, vjust = 2, size = 2,
	      main.size = 8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggcorrelogram_+3A_r">R</code></td>
<td>
<p>a correlation matrix</p>
</td></tr>
<tr><td><code id="ggcorrelogram_+3A_labs">labs</code></td>
<td>
<p>a vector of labels for the variables</p>
</td></tr>
<tr><td><code id="ggcorrelogram_+3A_ifun">ifun</code></td>
<td>
<p>the interpretation function (&quot;cos&quot; or &quot;lincos&quot;)</p>
</td></tr>
<tr><td><code id="ggcorrelogram_+3A_cex">cex</code></td>
<td>
<p>character expansion factor for the variable labels</p>
</td></tr>
<tr><td><code id="ggcorrelogram_+3A_main">main</code></td>
<td>
<p>a title for the correlogram</p>
</td></tr>
<tr><td><code id="ggcorrelogram_+3A_ntrials">ntrials</code></td>
<td>
<p>number of starting points for the optimization routine</p>
</td></tr>
<tr><td><code id="ggcorrelogram_+3A_xlim">xlim</code></td>
<td>
<p>limits for the x axis (e.g. c(-1.2,1.2))</p>
</td></tr>
<tr><td><code id="ggcorrelogram_+3A_ylim">ylim</code></td>
<td>
<p>limits for the y axis (e.g. c(-1.2,1.2))</p>
</td></tr>
<tr><td><code id="ggcorrelogram_+3A_hjust">hjust</code></td>
<td>
<p>horizontal adjustment of variable labels (by default 1 for all variables)</p>
</td></tr>
<tr><td><code id="ggcorrelogram_+3A_vjust">vjust</code></td>
<td>
<p>vertical adjustment of variable labels (by default 2 for all variables)</p>
</td></tr>
<tr><td><code id="ggcorrelogram_+3A_size">size</code></td>
<td>
<p>font size for the labels of the variables</p>
</td></tr>
<tr><td><code id="ggcorrelogram_+3A_main.size">main.size</code></td>
<td>
<p>font size of the main title of the correlogram</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ggcorrelogram</code> makes a correlogram on the basis of a set of
angles. All angles are given w.r.t the positive x-axis. Variables are
represented by unit vectors emanating from the origin.
</p>


<h3>Value</h3>

<p>A ggplot object. Field <code>theta</code> of the output contains the angles for the variables. 
</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Trosset, M.W. (2005) Visualizing correlation. Journal of Computational and Graphical Statistics
14(1), pp. 1&ndash;19</p>


<h3>See Also</h3>

<p><code><a href="#topic+correlogram">correlogram</a></code>,<code><a href="#topic+fit_angles">fit_angles</a></code>,<code><a href="stats.html#topic+nlminb">nlminb</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> set.seed(123)
 X &lt;- matrix(rnorm(90),ncol=3)
 R &lt;- cor(X)
 angles &lt;- ggcorrelogram(R)
</code></pre>

<hr>
<h2 id='ggtally'>
Create a correlation tally stick on a biplot vector
</h2><span id='topic+ggtally'></span>

<h3>Description</h3>

<p>Function <code>ggtally</code> puts a series of dots along a biplot vector of a correlation matrix,
so marking the change in correlation along the vector with specified values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggtally(G, p1, adj = 0, values = seq(-1, 1, by = 0.2), dotsize = 0.1, dotcolour = "black")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggtally_+3A_g">G</code></td>
<td>
<p>A matrix (or vector) of biplot markers</p>
</td></tr>
<tr><td><code id="ggtally_+3A_p1">p1</code></td>
<td>
<p>A ggplot2 object with a biplot</p>
</td></tr>
<tr><td><code id="ggtally_+3A_adj">adj</code></td>
<td>
<p>A scalar adjustment for the correlations</p>
</td></tr>
<tr><td><code id="ggtally_+3A_values">values</code></td>
<td>
<p>Values of the correlations to be marked off by dots</p>
</td></tr>
<tr><td><code id="ggtally_+3A_dotsize">dotsize</code></td>
<td>
<p>Size of the dot</p>
</td></tr>
<tr><td><code id="ggtally_+3A_dotcolour">dotcolour</code></td>
<td>
<p>Colour of the dot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Any set of values for the correlation to be marked off can be used, though a standard scale with 0.2 increments is recommmended. 
</p>


<h3>Value</h3>

<p>A ggplot2 object with the updated biplot</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Graffelman, J. and De Leeuw, J. (2023) On the visualisation of the correlation matrix. Available online. <a href="https://doi.org/10.48550/arXiv.2211.13150">doi:10.48550/arXiv.2211.13150</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+ggbplot">ggbplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(calibrate)
data(goblets)
R &lt;- cor(goblets)
out.sd &lt;- eigen(R)
V  &lt;- out.sd$vectors[,1:2]
Dl &lt;- diag(out.sd$values[1:2])
Gp &lt;- crossprod(t(V),sqrt(Dl))
pca.df &lt;- data.frame(Gp)
pca.df$strings &lt;- colnames(R)
colnames(pca.df) &lt;- c("PA1","PA2","strings")
p1 &lt;- ggbplot(pca.df,pca.df,main="PCA correlation biplot",xlab="",ylab="",rowarrow=TRUE,
              rowcolor="blue",rowch="",colch="")
p1 &lt;- ggtally(Gp,p1,values=seq(-0.2,0.6,by=0.2),dotsize=0.1)
</code></pre>

<hr>
<h2 id='gobletsR'>Correlations between size measurements of archeological goblets</h2><span id='topic+gobletsR'></span>

<h3>Description</h3>

<p>Correlations between 6 size measurements of archeological goblets</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gobletsR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Manly (1989)</p>


<h3>References</h3>

<p>Manly, B.F.J. (1989) <em>Multivariate statistical methods: a
primer</em>. Chapman and Hall, London.
</p>

<hr>
<h2 id='HeartAttack'>
Myocardial infarction or Heart attack data
</h2><span id='topic+HeartAttack'></span>

<h3>Description</h3>

<p>Data set consisting of 101 observations of patients who suffered a heart attack.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("HeartAttack")</code></pre>


<h3>Format</h3>

<p>A data frame with 101 observations on the following 8 variables.
</p>

<dl>
<dt><code>Pulse</code></dt><dd><p>Pulse</p>
</dd>
<dt><code>CI</code></dt><dd><p>Cardiac index</p>
</dd>
<dt><code>SI</code></dt><dd><p>Systolic index</p>
</dd>
<dt><code>DBP</code></dt><dd><p>Diastolic blood pressure</p>
</dd>
<dt><code>PA</code></dt><dd><p>Pulmonary artery pressure</p>
</dd>
<dt><code>VP</code></dt><dd><p>Ventricular pressure</p>
</dd>
<dt><code>PR</code></dt><dd><p>Pulmonary resistance</p>
</dd>
<dt><code>Status</code></dt><dd><p>Deceased or survived</p>
</dd>
</dl>



<h3>Source</h3>

<p>Table 18.1, (Saporta 1990, pp. 452&ndash;454)</p>


<h3>References</h3>

<p>Saporta, G. (1990) Probabilites analyse des donnees et statistique. Paris, Editions technip</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HeartAttack)
str(HeartAttack)
</code></pre>

<hr>
<h2 id='ipSymLS'>
Function for obtaining a weighted least squares low-rank approximation of a symmetric matrix
</h2><span id='topic+ipSymLS'></span>

<h3>Description</h3>

<p>Function <code>ipSymLS</code> implements an alternating least squares algorithm that uses both decomposition and block relaxation
to find the optimal positive semidefinite approxation of given rank p to a known symmetric matrix of order n.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipSymLS(target, w = matrix(1, dim(target)[1], dim(target)[2]), ndim = 2,
        init = FALSE, itmax = 100, eps = 1e-06, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipSymLS_+3A_target">target</code></td>
<td>
<p>Symmetric matrix to be approximated</p>
</td></tr>
<tr><td><code id="ipSymLS_+3A_w">w</code></td>
<td>
<p>Matrix of weights</p>
</td></tr>
<tr><td><code id="ipSymLS_+3A_ndim">ndim</code></td>
<td>
<p>Number of dimensions extracted (2 by default)</p>
</td></tr>
<tr><td><code id="ipSymLS_+3A_init">init</code></td>
<td>
<p>Initial value for the solution (optional; if supplied should be a matrix of dimensions <code>nrow(target)</code> by <code>ndim</code>)</p>
</td></tr>
<tr><td><code id="ipSymLS_+3A_itmax">itmax</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="ipSymLS_+3A_eps">eps</code></td>
<td>
<p>Tolerance criterion for convergence</p>
</td></tr>
<tr><td><code id="ipSymLS_+3A_verbose">verbose</code></td>
<td>
<p>Show the iteration history (<code>verbose=TRUE</code>) or not (<code>verbose=FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the coordinates for the variables</p>


<h3>Author(s)</h3>

<p>deleeuw@stat.ucla.edu</p>


<h3>References</h3>

<p>De Leeuw, J. (2006) A decomposition method for weighted least squares low-rank approximation of symmetric matrices. Department of Statistics, UCLA. Retrieved from https://escholarship.org/uc/item/1wh197mh
</p>
<p>Graffelman, J. and De Leeuw, J. (2023) Improved approximation and visualization of the correlation matrix. The American Statistician pp. 1&ndash;20. Available online as latest article  <a href="https://doi.org/10.1080/00031305.2023.2186952">doi:10.1080/00031305.2023.2186952</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(banknotes)
R &lt;- cor(banknotes)
W &lt;- matrix(1,nrow(R),nrow(R))
diag(W) &lt;- 0
Fp.als &lt;- ipSymLS(R,w=W,verbose=TRUE,eps=1e-15)
Rhat.als &lt;- Fp.als%*%t(Fp.als)
</code></pre>

<hr>
<h2 id='jointlim'>Establish limits for x and y axis</h2><span id='topic+jointlim'></span>

<h3>Description</h3>

<p>jointlim computes a sensible range for x and y axis if two sets of
points are to be plotted simultaneously
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jointlim(X, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jointlim_+3A_x">X</code></td>
<td>
<p>Matrix of coordinates</p>
</td></tr>
<tr><td><code id="jointlim_+3A_y">Y</code></td>
<td>
<p>Matrix of coordinates</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>xlim</code></td>
<td>
<p>minimum and maximum for x-range</p>
</td></tr>
<tr><td><code>ylim</code></td>
<td>
<p>minimum and maximum for y-range</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(runif(20),ncol=2)
Y &lt;- matrix(runif(20),ncol=2)
print(jointlim(X,Y)$xlim)
</code></pre>

<hr>
<h2 id='Keller'>
Program <code>Keller</code> calculates a rank p approximation to a correlation matrix according to Keller's method.
</h2><span id='topic+Keller'></span>

<h3>Description</h3>

<p>Keller's method is based on iterated eigenvalue decompositions that are used to adjust the diagonal of the correlation matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Keller(R, eps = 1e-06, nd = 2, itmax = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Keller_+3A_r">R</code></td>
<td>
<p>A correlation matrix</p>
</td></tr>
<tr><td><code id="Keller_+3A_eps">eps</code></td>
<td>
<p>Numerical criterion for convergence (default <code>eps=1e-06)</code></p>
</td></tr>
<tr><td><code id="Keller_+3A_nd">nd</code></td>
<td>
<p>Number of dimensions used in the spectral decomposition (default <code>nd=2</code>)</p>
</td></tr>
<tr><td><code id="Keller_+3A_itmax">itmax</code></td>
<td>
<p>The maximum number of iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the approximation to the correlation matrix-</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Keller, J.B. (1962) Factorization of Matrices by Least-Squares. Biometrika, 49(1 and 2) pp. 239&ndash;242.
</p>
<p>Graffelman, J. and De Leeuw, J. (2023) Improved approximation and visualization of the correlation matrix. The American Statistician pp. 1&ndash;20. Available online as latest article  <a href="https://doi.org/10.1080/00031305.2023.2186952">doi:10.1080/00031305.2023.2186952</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ipSymLS">ipSymLS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Kernels)
R &lt;- cor(Kernels)
Rhat &lt;- Keller(R)
</code></pre>

<hr>
<h2 id='Kernels'>
Wheat kernel data
</h2><span id='topic+Kernels'></span>

<h3>Description</h3>

<p>Wheat kernel data set taken from the UCI Machine Learning Repository
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Kernels")</code></pre>


<h3>Format</h3>

<p>A data frame with 210 observations on the following 8 variables.
</p>

<dl>
<dt><code>area</code></dt><dd><p>Area of the kernel</p>
</dd>
<dt><code>perimeter</code></dt><dd><p>Perimeter of the kernel</p>
</dd>
<dt><code>compactness</code></dt><dd><p>Compactness (C = 4*pi*A/P^2)</p>
</dd>
<dt><code>length</code></dt><dd><p>Length of the kernel</p>
</dd>
<dt><code>width</code></dt><dd><p>Width of the kernel</p>
</dd>
<dt><code>asymmetry</code></dt><dd><p>Asymmetry coefficient</p>
</dd>
<dt><code>groove</code></dt><dd><p>Length of the groove of the kernel</p>
</dd>
<dt><code>variety</code></dt><dd><p>Variety (1=Kama, 2=Rosa, 3=Canadian)</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://archive.ics.uci.edu/ml/datasets/seeds
</p>


<h3>References</h3>

<p>M. Charytanowicz, J. Niewczas, P. Kulczycki, P.A. Kowalski, S. Lukasik, S. Zak, A Complete Gradient Clustering Algorithm for Features Analysis of X-ray Images. in: Information Technologies in Biomedicine, Ewa Pietka, Jacek Kawa (eds.), Springer-Verlag, Berlin-Heidelberg, 2010, pp. 15-24.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Kernels)
</code></pre>

<hr>
<h2 id='linangplot'>Linang plot</h2><span id='topic+linangplot'></span>

<h3>Description</h3>

<p><code>linangplot</code> produces a plot of two variables, such that the correlation between the two variables is linear in the angle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linangplot(x, y, tmx = NULL, tmy = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linangplot_+3A_x">x</code></td>
<td>
<p>x variable</p>
</td></tr>
<tr><td><code id="linangplot_+3A_y">y</code></td>
<td>
<p>y variable</p>
</td></tr>
<tr><td><code id="linangplot_+3A_tmx">tmx</code></td>
<td>
<p>vector of tickmarks for the x variable</p>
</td></tr>
<tr><td><code id="linangplot_+3A_tmy">tmy</code></td>
<td>
<p>vector of tickmarks for the y variable</p>
</td></tr>
<tr><td><code id="linangplot_+3A_...">...</code></td>
<td>
<p>additional arguments for the plot routine</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Xt</code></td>
<td>
<p>coordinates of the points</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>axes for the plot</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>correlation coefficient</p>
</td></tr>
<tr><td><code>angledegrees</code></td>
<td>
<p>angle between axes in degrees</p>
</td></tr>
<tr><td><code>angleradians</code></td>
<td>
<p>angle between axes in radians</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>correlation coefficient</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code><code><a href="#topic+correlogram">correlogram</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- runif(10)
y &lt;- rnorm(10)
linangplot(x,y)
</code></pre>

<hr>
<h2 id='lincos'>
Linearized cosine function
</h2><span id='topic+lincos'></span>

<h3>Description</h3>

<p>Function <code>lincos</code> linearizes the cosine function over the interval
[0,2pi]. The function returns -2/pi*x + 1 over [0,pi] and 2/pi*x - 3
over [pi,2pi]  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lincos(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lincos_+3A_x">x</code></td>
<td>
<p>angle in radians</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a real number in [-1,1].</p>


<h3>Author(s)</h3>

<p>Jan Graffelman (jan.graffelman@upc.edu)</p>


<h3>References</h3>

<p>Graffelman, J. (2012) Linear-angle correlation plots: new graphs for revealing correlation structure. Journal of Computational and Graphical Statistics. 22(1): 92-106. 
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+cos">cos</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>angle &lt;- pi
y &lt;- lincos(angle)
print(y)
</code></pre>

<hr>
<h2 id='pco'>Principal Coordinate Analysis</h2><span id='topic+pco'></span>

<h3>Description</h3>

<p><code>pco</code> is a program for Principal Coordinate Analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pco(Dis)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pco_+3A_dis">Dis</code></td>
<td>
<p>A distance or dissimilarity matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The program <code>pco</code> does a principal coordinates analysis of a 
dissimilarity (or distance) matrix (Dij) where the diagonal elements, 
Dii, are zero.
</p>
<p>Note that when we dispose of a similarity matrix rather that a distance
matrix, a transformation is needed before calling coorprincipal. For 
instance, if Sij is a similarity matrix, Dij might be obtained as
Dij = 1 - Sij/diag(Sij)
</p>
<p>Goodness of fit calculations need to be revised such as to deal
(in different ways) with negative eigenvalues.
</p>


<h3>Value</h3>

<table>
<tr><td><code>PC</code></td>
<td>
<p>the principal coordinates</p>
</td></tr>
<tr><td><code>Dl</code></td>
<td>
<p>all eigenvalues of the solution</p>
</td></tr>
<tr><td><code>Dk</code></td>
<td>
<p>the positive eigenvalues of the solution</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>double centred matrix for the eigenvalue decomposition</p>
</td></tr>
<tr><td><code>decom</code></td>
<td>
<p>the goodness of fit table</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+cmdscale">cmdscale</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>citynames &lt;- c("Aberystwyth","Brighton","Carlisle","Dover","Exeter","Glasgow","Hull",
"Inverness","Leeds","London","Newcastle", "Norwich")    
A &lt;-matrix(c(
0,244,218,284,197,312,215,469,166,212,253,270,
244,0,350,77,167,444,221,583,242,53,325,168,
218,350,0,369,347,94,150,251,116,298,57,284,
284,77,369,0,242,463,236,598,257,72,340,164,
197,167,347,242,0,441,279,598,269,170,359,277,
312,444,94,463,441,0,245,169,210,392,143,378,
215,221,150,236,279,245,0,380,55,168,117,143,
469,583,251,598,598,169,380,0,349,531,264,514,
166,242,116,257,269,210,55,349,0,190,91,173,
212,53,298,72,170,392,168,531,190,0,273,111,
253,325,57,340,359,143,117,264,91,273,0,256,
270,168,284,164,277,378,143,514,173,111,256,0),ncol=12)
rownames(A) &lt;- citynames
colnames(A) &lt;- citynames
out &lt;- pco(A)
plot(out$PC[,2],-out$PC[,1],pch=19,asp=1)
textxy(out$PC[,2],-out$PC[,1],rownames(A))
</code></pre>

<hr>
<h2 id='PearsonLee'>Heights of mothers and daughters</h2><span id='topic+PearsonLee'></span>

<h3>Description</h3>

<p>Heights of 1375 mothers and daughters (in cm) in the UK in 1893-1898. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PearsonLee)</code></pre>


<h3>Format</h3>

<p>dataframe with Mheight and Dheight</p>


<h3>Source</h3>

<p>Weisberg, Chapter 1</p>


<h3>References</h3>

<p>Weisberg, S. (2005) <em>Applied Linear Regression</em>, John
Wiley &amp; Sons, New Jersey</p>

<hr>
<h2 id='pfa'>Principal factor analysis</h2><span id='topic+pfa'></span>

<h3>Description</h3>

<p>Program <code>pfa</code> performs (iterative) principal factor analysis, which
is based on the computation of eigenvalues of the reduced correlation matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pfa(X, option = "data", m = 2, initial.communality = "R2", crit = 0.001, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pfa_+3A_x">X</code></td>
<td>
<p>A data matrix or correlation matrix</p>
</td></tr>
<tr><td><code id="pfa_+3A_option">option</code></td>
<td>
<p>Specifies the type of matrix supplied by argument
<code>X</code>. Values for <code>option</code> are <code>data</code>, <code>cor</code> or
<code>cov</code>. <code>data</code> is the default.</p>
</td></tr>
<tr><td><code id="pfa_+3A_m">m</code></td>
<td>
<p> The number of factors to extract (2 by default)</p>
</td></tr>
<tr><td><code id="pfa_+3A_initial.communality">initial.communality</code></td>
<td>
<p> Method for computing initial
communalites. Possibilities are <code>R2</code>  or <code>maxcor</code>.</p>
</td></tr>
<tr><td><code id="pfa_+3A_crit">crit</code></td>
<td>
<p> The criterion for convergence. The default is
<code>0.001</code>. A smaller value will require more iterations before
convergence is reached.</p>
</td></tr>
<tr><td><code id="pfa_+3A_verbose">verbose</code></td>
<td>
<p> When set to <code>TRUE</code>, additional numerical output
is shown.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Res</code></td>
<td>
<p> Matrix of residuals </p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p> Diagonal matrix with specific variances </p>
</td></tr>
<tr><td><code>La</code></td>
<td>
<p> Matrix of loadings </p>
</td></tr>
<tr><td><code>Shat</code></td>
<td>
<p> Estimated correlation matrix</p>
</td></tr>
<tr><td><code>Fs</code></td>
<td>
<p> Factor scores</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Mardia, K.V., Kent, J.T. and Bibby, J.M. (1979) Multivariate analysis.
</p>
<p>Rencher, A.C. (1995) Methods of multivriate analysis.
</p>
<p>Satorra, A. and Neudecker, H. (1998) Least-Squares Approximation of
off-Diagonal Elements of a Variance Matrix in the Context of Factor
Analysis. Econometric Theory 14(1) pp. 156&ndash;157.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+princomp">princomp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>   X &lt;- matrix(rnorm(100),ncol=2)
   out.pfa &lt;- pfa(X)
#  based on a correlation matrix
   R &lt;- cor(X)
   out.pfa &lt;- pfa(R,option="cor")
</code></pre>

<hr>
<h2 id='proteinR'>Correlations between sources of protein</h2><span id='topic+proteinR'></span>

<h3>Description</h3>

<p>Correlations between sources of protein for a number of countries (Red
meat, White meat, Eggs, Milk, Fish, Cereals, Starchy food, Nuts,
Fruits and vegetables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(proteinR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Manly (1989)</p>


<h3>References</h3>

<p>Manly, B.F.J. (1989) <em>Multivariate statistical methods: a
primer</em>. Chapman and Hall, London.
</p>

<hr>
<h2 id='proteinsR'>Correlations between sources of protein</h2><span id='topic+proteinsR'></span>

<h3>Description</h3>

<p>Correlations between sources of protein for a number of countries (Red
meat, White meat, Eggs, Milk, Fish, Cereals, Starchy food, Nuts,
Fruits and vegetables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(proteinR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Manly (1989)</p>


<h3>References</h3>

<p>Manly, B.F.J. (1989) <em>Multivariate statistical methods: a
primer</em>. Chapman and Hall, London.
</p>

<hr>
<h2 id='recordsR'>Correlations between  national track records for men</h2><span id='topic+recordsR'></span>

<h3>Description</h3>

<p>Correlations between national track records for men
(100m,200m,400m,800m,1500m,5000m,10.000m and Marathon
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(recordsR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Johnson and Wichern, Table 8.6</p>


<h3>References</h3>

<p>Johnson, R.A. and Wichern, D.W. (2002) <em>Applied Multivariate
Statistical Analysis.</em> Fifth edition. New Jersey: Prentice Hall.
</p>

<hr>
<h2 id='rmse'>
Calculate the root mean squared error
</h2><span id='topic+rmse'></span>

<h3>Description</h3>

<p>Program <code>rmse</code> calculates the RMSE for a matrix approximation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmse(R, Rhat, W = matrix(1, nrow(R), ncol(R)) - diag(nrow(R)),
     verbose = FALSE, per.variable = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmse_+3A_r">R</code></td>
<td>
<p>The original matrix</p>
</td></tr>
<tr><td><code id="rmse_+3A_rhat">Rhat</code></td>
<td>
<p>The approximating matrix</p>
</td></tr>
<tr><td><code id="rmse_+3A_w">W</code></td>
<td>
<p>A symmetric matrix of weights</p>
</td></tr>
<tr><td><code id="rmse_+3A_verbose">verbose</code></td>
<td>
<p>Print output (<code>verbose=TRUE</code>) or not (<code>verbose=FALSE</code>)</p>
</td></tr>
<tr><td><code id="rmse_+3A_per.variable">per.variable</code></td>
<td>
<p>Calculate the RMSE for the whole matrix (<code>per.variable=FALSE</code>) or
for each variable seperately (<code>per.variable=TRUE</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, function <code>rmse</code> assumes a symmetric correlation matrix as input, together with its approximation. The approximation does not need to be symmetric.
Weight matrix W has to be symmetric. By default, the diagonal is excluded from RMSE calcuations (W = J - I). To include it, specify W = J, that is set W = matrix(1, nrow(R), ncol(R))
</p>


<h3>Value</h3>

<p>the calculated rmse</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Graffelman, J. and De Leeuw, J. (2023) Improved approximation and visualization of the correlation matrix. The American Statistician pp. 1&ndash;20. <a href="https://doi.org/10.1080/00031305.2023.2186952">doi:10.1080/00031305.2023.2186952</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(banknotes)
X &lt;- as.matrix(banknotes[,1:6])
p &lt;- ncol(X)
J &lt;- matrix(1,p,p)
R &lt;- cor(X)
out.sd &lt;- eigen(R)
V &lt;- out.sd$vectors
Dl &lt;- diag(out.sd$values)
V2 &lt;- V[,1:2]
D2 &lt;- Dl[1:2,1:2]
Rhat &lt;- V2%*%D2%*%t(V2)
rmse(R,Rhat,W=J)
</code></pre>

<hr>
<h2 id='rmsePCAandWALS'>
Generate a table of root mean square error (RMSE) statistics for principal component analysis (PCA) and
weighted alternating least squares (WALS).
</h2><span id='topic+rmsePCAandWALS'></span>

<h3>Description</h3>

<p>Function <code>rmsePCAandWALS</code> creates table with the RMSE for each variable, for a low-rank
approximation to the correlation matrix obtained by PCA or WALS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmsePCAandWALS(R, output, digits = 4, omit.diagonals = c(FALSE,FALSE,TRUE,TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmsePCAandWALS_+3A_r">R</code></td>
<td>
<p>The correlation matrix</p>
</td></tr>
<tr><td><code id="rmsePCAandWALS_+3A_output">output</code></td>
<td>
<p>A list object with four approximationst to the correlation matrix</p>
</td></tr>
<tr><td><code id="rmsePCAandWALS_+3A_digits">digits</code></td>
<td>
<p>The number of digits used in the output</p>
</td></tr>
<tr><td><code id="rmsePCAandWALS_+3A_omit.diagonals">omit.diagonals</code></td>
<td>
<p>Vector of four logicals for omitting the diagonal of the correlation matrix
for RMSE calculations. Defaults to c(FALSE,FALSE,TRUE,TRUE), to include the diagonal
for PCA and exclude it for WALS</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with one row per variable and four columns for RMSE statistics.</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Graffelman, J. and De Leeuw, J. (2023) Improved approximation and visualization of the correlation matrix. The American Statistician pp. 1&ndash;20. <a href="https://doi.org/10.1080/00031305.2023.2186952">doi:10.1080/00031305.2023.2186952</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FitRwithPCAandWALS">FitRwithPCAandWALS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HeartAttack)
X &lt;- HeartAttack[,1:7]
X[,7] &lt;- log(X[,7])
colnames(X)[7] &lt;- "logPR"
R &lt;- cor(X)
## Not run: 
out &lt;- FitRwithPCAandWALS(R)
Results &lt;- rmsePCAandWALS(R,out)

## End(Not run)
</code></pre>

<hr>
<h2 id='storksR'>Correlations between three  variables</h2><span id='topic+storksR'></span>

<h3>Description</h3>

<p>Danish data from 1953-1977 giving the correlations between nesting storks,
human birth rate and per capita electricity consumption.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(storksR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Gabriel and Odoroff, Table 1.</p>


<h3>References</h3>

<p>Gabriel, K. R. and Odoroff, C. L. (1990) Biplots in biomedical research.
<em>Statistics in Medicine</em> 9(5): pp. 469-485.
</p>

<hr>
<h2 id='students'>Marks for 5 student exams</h2><span id='topic+students'></span>

<h3>Description</h3>

<p>Matrix of marks for five exams, two with closed books and
three with open books (Mechanics (C), Vectors (C),
Algebra (O), Analysis (O) and Statistics (O)).    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(students)</code></pre>


<h3>Format</h3>

<p>A data matrix</p>


<h3>Source</h3>

<p>Mardia et al., Table 1.2.1</p>


<h3>References</h3>

<p>Mardia, K.V., Kent, J.T. and Bibby, J.M. (1979) <em>Multivariate
Analysis</em>, Academic Press London.
</p>

<hr>
<h2 id='studentsR'>Correlations between marks for 5 exams</h2><span id='topic+studentsR'></span>

<h3>Description</h3>

<p>Correlation matrix of marks for five exams, two with closed books and
three with open books (Mechanics (C), Vectors (C),
Algebra (O), Analysis (O) and Statistics (O)).    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(studentsR)</code></pre>


<h3>Format</h3>

<p>A matrix of correlations</p>


<h3>Source</h3>

<p>Mardia et al., Table 1.2.1</p>


<h3>References</h3>

<p>Mardia, K.V., Kent, J.T. and Bibby, J.M. (1979) <em>Multivariate
Analysis</em>, Academic Press London.
</p>

<hr>
<h2 id='tally'>
Create a tally on a biplot vector
</h2><span id='topic+tally'></span>

<h3>Description</h3>

<p>Function <code>tally</code> marks of a set of dots on a biplot vector. It is thought for biplot vectors representing correlations,
such that their correlation scale becomes visible, without doing a full calibration with tick marks and tick mark labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tally(G, adj = 0, values = seq(-1, 1, by = 0.2), pch = 19, dotcolor = "black", cex = 0.5,
      color.negative = "red", color.positive = "blue")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tally_+3A_g">G</code></td>
<td>
<p>Matrix with biplot coordinates of the variables</p>
</td></tr>
<tr><td><code id="tally_+3A_adj">adj</code></td>
<td>
<p>A scalar adjustment for the correlations</p>
</td></tr>
<tr><td><code id="tally_+3A_values">values</code></td>
<td>
<p>The values of the correlations to be marked off by dots</p>
</td></tr>
<tr><td><code id="tally_+3A_pch">pch</code></td>
<td>
<p>The character code used for marking off correlations</p>
</td></tr>
<tr><td><code id="tally_+3A_dotcolor">dotcolor</code></td>
<td>
<p>The colour of the dots that are marked off</p>
</td></tr>
<tr><td><code id="tally_+3A_cex">cex</code></td>
<td>
<p>The character expansion factor for a dot.</p>
</td></tr>
<tr><td><code id="tally_+3A_color.negative">color.negative</code></td>
<td>
<p>The colour of the segments of the negative part of the correlation scale</p>
</td></tr>
<tr><td><code id="tally_+3A_color.positive">color.positive</code></td>
<td>
<p>The colour of the segments of the positive part of the correlation scale</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>References</h3>

<p>Graffelman, J. and De Leeuw, J. (2023) Improved approximation and visualization of the correlation matrix.
The American Statistician pp. 1&ndash;20. <a href="https://doi.org/10.1080/00031305.2023.2186952">doi:10.1080/00031305.2023.2186952</a></p>


<h3>See Also</h3>

<p><code>bplot</code>, <code><a href="survey.html#topic+calibrate">calibrate</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(goblets)
R &lt;- cor(goblets)
results &lt;- eigen(R)
V  &lt;- results$vectors
Dl &lt;- diag(results$values)
#
# Calculate correlation biplot coordinates
#
G  &lt;- crossprod(t(V[,1:2]),sqrt(Dl[1:2,1:2]))
#
# Make the biplot
#
bplot(G,G,rowch=NA,colch=NA,collab=colnames(R),
      xl=c(-1.1,1.1),yl=c(-1.1,1.1))
#
# Create a correlation tally stick for variable X1
#
tally(G[1,])
</code></pre>

<hr>
<h2 id='tr'>Compute the trace of a matrix</h2><span id='topic+tr'></span>

<h3>Description</h3>

<p><code>tr</code> computes the trace of a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tr(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tr_+3A_x">X</code></td>
<td>
<p>a (square) matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the trace (a scalar)
</p>


<h3>Author(s)</h3>

<p> Jan Graffelman (jan.graffelman@upc.edu) </p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(runif(25),ncol=5)
print(X)
print(tr(X))
</code></pre>

<hr>
<h2 id='wAddPCA'>
Low-rank matrix approximation by weighted alternating least squares
</h2><span id='topic+wAddPCA'></span>

<h3>Description</h3>

<p>Function <code>wAddPCA</code> calculates a weighted least squares approximation of low rank to a given matrix. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wAddPCA(x, w = matrix(1, nrow(x), ncol(x)), p = 2, add = "all", bnd = "opt",
        itmaxout = 1000, itmaxin = 1000, epsout = 1e-06, epsin = 1e-06,
	verboseout = TRUE, verbosein = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wAddPCA_+3A_x">x</code></td>
<td>
<p>The data matrix to be approximated</p>
</td></tr>
<tr><td><code id="wAddPCA_+3A_w">w</code></td>
<td>
<p>The weight matrix</p>
</td></tr>
<tr><td><code id="wAddPCA_+3A_p">p</code></td>
<td>
<p>The dimensionality of the low-rank solution (2 by default)</p>
</td></tr>
<tr><td><code id="wAddPCA_+3A_add">add</code></td>
<td>
<p>The additive adjustment to be employed. Can be &quot;all&quot; (default), &quot;nul&quot; (no adjustment),
&quot;one&quot; (adjustment by a single scalar), &quot;row&quot; (adjustment by a row) or &quot;col&quot; (adjustment by a
column).</p>
</td></tr>
<tr><td><code id="wAddPCA_+3A_bnd">bnd</code></td>
<td>
<p>Can be &quot;opt&quot; (default), &quot;all&quot;, &quot;row&quot; or &quot;col&quot;.</p>
</td></tr>
<tr><td><code id="wAddPCA_+3A_itmaxout">itmaxout</code></td>
<td>
<p>Maximum number of iterations for the outer loop of the algorithm</p>
</td></tr>
<tr><td><code id="wAddPCA_+3A_itmaxin">itmaxin</code></td>
<td>
<p>Maximum number of iterations for the inner loop of the algorithm</p>
</td></tr>
<tr><td><code id="wAddPCA_+3A_epsout">epsout</code></td>
<td>
<p>Numerical criterion for convergence of the outer loop</p>
</td></tr>
<tr><td><code id="wAddPCA_+3A_epsin">epsin</code></td>
<td>
<p>Numerical criterion for convergence of the inner loop</p>
</td></tr>
<tr><td><code id="wAddPCA_+3A_verboseout">verboseout</code></td>
<td>
<p>Be verbose on the outer loop iterations</p>
</td></tr>
<tr><td><code id="wAddPCA_+3A_verbosein">verbosein</code></td>
<td>
<p>Be verbose on the inner loop iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object with fields:
</p>
<table>
<tr><td><code>a</code></td>
<td>
<p>The left matrix (A) of the factorization X = AB'</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>The right matrix (B) of the factorization X = AB'</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>The product AB'</p>
</td></tr>
<tr><td><code>f</code></td>
<td>
<p>The final value of the loss function</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>Vector for rows used to construct rank 1 weights</p>
</td></tr>
<tr><td><code>v</code></td>
<td>
<p>Vector for columns used to construct rank 1 weights</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The vector with row adjustments</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>The vector with column adjustments</p>
</td></tr>
<tr><td><code>itel</code></td>
<td>
<p>Iterations needed for convergence</p>
</td></tr> 
<tr><td><code>delta</code></td>
<td>
<p>The additive adjustment</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The low-rank approximation to <code>x</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>jan@deleeuwpdx.net</p>


<h3>References</h3>

<p>Graffelman, J. and De Leeuw, J. (2023) Improved approximation and visualization of the correlation matrix. The American Statistician pp. 1&ndash;20. Available online as latest article  <a href="https://doi.org/10.1080/00031305.2023.2186952">doi:10.1080/00031305.2023.2186952</a>
</p>
<p>https://jansweb.netlify
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ipSymLS">ipSymLS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HeartAttack)
X &lt;- HeartAttack[,1:7]
X[,7] &lt;- log(X[,7])
colnames(X)[7] &lt;- "logPR"
R &lt;- cor(X)
W &lt;- matrix(1, 7, 7)
diag(W) &lt;- 0
Wals.out &lt;- wAddPCA(R, W, add = "nul", verboseout = FALSE) 
Rhat &lt;- Wals.out$y
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
