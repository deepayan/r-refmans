<!DOCTYPE html><html><head><title>Help for package LCCR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LCCR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#LCCR-package'>
<p>Latent Class Capture-Recapture Models</p></a></li>
<li><a href='#aggr_data'><p>Aggregate capture-recapture data</p></a></li>
<li><a href='#confint.estLCCR'><p>Confidence interval</p></a></li>
<li><a href='#data_sim1'><p>Simulated data 1</p></a></li>
<li><a href='#data_sim2'><p>Simulated data 2</p></a></li>
<li><a href='#data_sim3'><p>Simulated data 3</p></a></li>
<li><a href='#data_sim4'><p>Simulated data 4</p></a></li>
<li><a href='#design_matrix_logit'><p>Design matrix for recursive logit parametrization</p></a></li>
<li><a href='#design_matrix_loglin'><p>Design matrix for loglinear parametrization</p></a></li>
<li><a href='#estLCCR'><p>Estimate latent class models for capture-recapture data with individual covariates</p></a></li>
<li><a href='#estLCCRcon'><p>CML estimation of latent class models for capture-recapture data with individual covariates</p></a></li>
<li><a href='#freq_data'><p>Convert capture-recapture configurations into frequency data</p></a></li>
<li><a href='#matrix_logit'><p>Design matrices of saturated logit parametrization</p></a></li>
<li><a href='#plot'><p>Plot profile confidence interval</p></a></li>
<li><a href='#print'><p>Print the output</p></a></li>
<li><a href='#simLCCR'><p>Simulate capture-recapture data from a latent class model with individual covariates</p></a></li>
<li><a href='#sq'><p>Build matrix of binary vectors of a fixed lenght</p></a></li>
<li><a href='#summary'><p>Summary of output</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Latent Class Capture-Recapture Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-12-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Francesco Bartolucci [aut, cre],
  Antonio Forcina [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francesco Bartolucci &lt;francesco.bartolucci@unipg.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of latent class models with individual covariates for capture-recapture data. See Forcina and Bartolucci (2021)&lt;<a href="https://doi.org/10.48550/arXiv.2106.03811">doi:10.48550/arXiv.2106.03811</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-04 20:17:44 UTC; francescobartolucci</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-04 20:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='LCCR-package'>
Latent Class Capture-Recapture Models
</h2><span id='topic+LCCR-package'></span><span id='topic+LCCR'></span>

<h3>Description</h3>

<p>Estimation of latent class models with individual covariates for capture-recapture data. See Forcina and Bartolucci (2021)&lt;arxiv:2106.03811&gt;.
</p>


<h3>Details</h3>

<p>The package provides functions to specify latent class models for capture-recapture data with individual covariates, simulate data from the specified model and estimate it on the basis of observed data, including the possibility to obtain a profile confidence interval for the population size.
</p>
<p>The latent class models may be specified by a log-linear or a recursive logit parametrization of the conditional distribution of the capture configurations given the latent class. The log-linear parametrization is based on main effects that may depend on some covariates and may include bivariate interaction terms. The recursive logit parametrization allows us to model the dependence of capture probabilities on previous capture history. Linear constraints on the model parameters may be assumed to make the model more parsimonious. Covariates may also affect the latent class weights by a Multinomial logit parametrization.
</p>
<p>Estimation of the specified model is based on the unconditional likelihood method following the approach formalized in Forcina and Bartolucci (2021), which may be seen as a refinement of the one in Liu et al. (2017). The approach uses as additional parameters the weights associated to the different strata that are estimated together with the model parameters and the population size. Functions for constructing a profile confidence interval for the population size are provided; this proceduire is recommended as an alternative to using the normal approximation.
</p>
<p>Functions for conditional maximum likelihood estimation as described in Bartolucci and Forcina (2006) are also included in the package.
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci [aut, cre], Antonio Forcina [aut]
</p>
<p>Maintainer: Francesco Bartolucci &lt;francesco.bartolucci@unipg.it&gt;
</p>


<h3>References</h3>

<p>Bartolucci, F. and Forcina, A. (2006). Estimating the size of a closed population by modeling latent and observed heterogeneity. <em>Journal of the American Statistical Association</em>, <b>101</b>, 786-794.
</p>
<p>Forcina, A. and Bartolucci, F. (2021). Estimating the size of a closed population by modeling latent and observed heterogeneity, <em>arXiv:2106.03811</em>.
</p>
<p>Liu, Y., Li, P., and Qin, J. (2017). Maximum empirical likelihood estimation for abundance in a closed population from capture-recapture data. <em>Biometrika</em>, <b>104</b>, 527-543.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_sim2)
# estimate latent class model with 2 classes, same main log-linear effect across lists,
# one covariate affecting the weights, and bivariate interaction between consecutive lists
est = estLCCR(Y=data_sim2$Y,H=2,W=data_sim2$W,biv=matrix(c(1,2,3,4,2,3,4,5),4),main="same")
est
# compute profile confidence interval
conf = confint(est)
conf
plot(conf)

</code></pre>

<hr>
<h2 id='aggr_data'>Aggregate capture-recapture data</h2><span id='topic+aggr_data'></span>

<h3>Description</h3>

<p>Given a matrix of individual capture configurations, and the corresponding matrix and array of covariates (affecting the class weights and the conditional capture probabilities given the latent class), the function aggregates data, providing a stratified capture-recapture format.</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggr_data(Y, W = NULL, X = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggr_data_+3A_y">Y</code></td>
<td>
<p>matrix of frequencies of capture configurations</p>
</td></tr>
<tr><td><code id="aggr_data_+3A_w">W</code></td>
<td>
<p>matrix of covariates affecting the class weights</p>
</td></tr>
<tr><td><code id="aggr_data_+3A_x">X</code></td>
<td>
<p>array of covariates affecting the conditional capture probabilities</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Ya</code></td>
<td>
<p>matrix of aggregated frequencies of capture configurations</p>
</td></tr>
<tr><td><code>Wa</code></td>
<td>
<p>matrix of aggregated covariates affecting the class weights</p>
</td></tr>
<tr><td><code>Xa</code></td>
<td>
<p>array of aggregated covariates affecting the conditional capture probabilities</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Forcina</p>


<h3>See Also</h3>

<p><code><a href="#topic+freq_data">freq_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># case without covariates
Y = rbind(c(0,1,0,0,0,0,0,0),c(0,0,0,1,0,0,0,0),c(0,0,0,0,0,0,1,0))
aggr_data(Y)

# case with covariates
W = c(1,1,2); X = as.matrix(c(0,0,2))
aggr_data(Y,W,X)
</code></pre>

<hr>
<h2 id='confint.estLCCR'>Confidence interval</h2><span id='topic+confint.estLCCR'></span>

<h3>Description</h3>

<p>Profile confidence interval for a latent class model with covariates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'estLCCR'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.estLCCR_+3A_object">object</code></td>
<td>
<p>output from <code><a href="#topic+estLCCR">estLCCR</a></code></p>
</td></tr>
<tr><td><code id="confint.estLCCR_+3A_parm">parm</code></td>
<td>
<p>step of the grid of values of the population size</p>
</td></tr>
<tr><td><code id="confint.estLCCR_+3A_level">level</code></td>
<td>
<p>the confidence level required</p>
</td></tr>
<tr><td><code id="confint.estLCCR_+3A_...">...</code></td>
<td>
<p>additional argument(s) for methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Forcina</p>


<h3>References</h3>

<p>Forcina, A. and Bartolucci, F. (2021). Estimating the size of a closed population by modeling latent and observed heterogeneity, <em>arXiv:2106.03811</em>.
</p>
<p>Liu, Y., Li, P., and Qin, J. (2017). Maximum empirical likelihood estimation for abundance in a closed population from capture-recapture data. <em>Biometrika</em>, <b>104</b>, 527-543.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+estLCCR">estLCCR</a></code>, <code><a href="#topic+plot.confLCCR">plot.confLCCR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_sim2)
est = estLCCR(Y=data_sim2$Y,H=2,W=data_sim2$W,biv=matrix(c(1,2,3,4,2,3,4,5),4),main="same")
conf = confint(est)
plot(conf)

</code></pre>

<hr>
<h2 id='data_sim1'>Simulated data 1</h2><span id='topic+data_sim1'></span>

<h3>Description</h3>

<p>Simulated capture-recapture data from a latent class model with 2 classes having the same weight on 5 lists.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_sim1)</code></pre>


<h3>Format</h3>

<p>A matrix containing the capture configurations at individual level.
</p>


<h3>References</h3>

<p>Forcina, A. and Bartolucci, F. (2021). Estimating the size of a closed population by modeling latent and observed heterogeneity, <em>arXiv:2106.03811</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_sim1)
est = estLCCR(Y=data_sim1,H=2)

</code></pre>

<hr>
<h2 id='data_sim2'>Simulated data 2</h2><span id='topic+data_sim2'></span>

<h3>Description</h3>

<p>Simulated capture-recapture data from a latent class model with 2 classes, one covariate affecting the class weights, and bivariate loglinear interactions between consecutive lists.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_sim2)</code></pre>


<h3>Format</h3>

<p>A list containing capture configurations at individual level and corresponding covariates.
</p>

<dl>
<dt><code>Y</code></dt><dd><p>capture configurations</p>
</dd>
<dt><code>W</code></dt><dd><p>values of the covariate affecting the class weights</p>
</dd>
</dl>



<h3>References</h3>

<p>Forcina, A. and Bartolucci, F. (2021). Estimating the size of a closed population by modeling latent and observed heterogeneity, <em>arXiv:2106.03811</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_sim2)
est = estLCCR(Y=data_sim2$Y,H=2,W=data_sim2$W,biv=matrix(c(1,2,3,4,2,3,4,5),4),main="same")

</code></pre>

<hr>
<h2 id='data_sim3'>Simulated data 3</h2><span id='topic+data_sim3'></span>

<h3>Description</h3>

<p>Simulated capture-recapture data from a latent class model with 3 classes, one covariate affecting the logits of each response, and lag dependence.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_sim3)</code></pre>


<h3>Format</h3>

<p>A list containing capture configurations at individual level and corresponding covariates.
</p>

<dl>
<dt><code>Y</code></dt><dd><p>capture configurations</p>
</dd>
<dt><code>X</code></dt><dd><p>values of the covariate affecting the conditional capture probabilities given the latent class</p>
</dd>
</dl>



<h3>References</h3>

<p>Forcina, A. and Bartolucci, F. (2021). Estimating the size of a closed population by modeling latent and observed heterogeneity, <em>arXiv:2106.03811</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_sim3)
est = estLCCR(Y=data_sim3$Y,H=3,model="logit",X=data_sim3$X,flag="atleast")

</code></pre>

<hr>
<h2 id='data_sim4'>Simulated data 4</h2><span id='topic+data_sim4'></span>

<h3>Description</h3>

<p>Simulated stratified capture-recapture data from a latent class model with 2 classes and covariates affecting both the class weights and the conditional capture probabilities given the latent class.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_sim4)</code></pre>


<h3>Format</h3>

<p>A list containing capture configurations at individual level and corresponding covariates.
</p>

<dl>
<dt><code>Y</code></dt><dd><p>capture configurations</p>
</dd>
<dt><code>W</code></dt><dd><p>values of the covariate affecting the class weights</p>
</dd>
<dt><code>X</code></dt><dd><p>values of the covariate affecting the conditional capture probabilities given the latent class</p>
</dd>
</dl>



<h3>References</h3>

<p>Forcina, A. and Bartolucci, F. (2021). Estimating the size of a closed population by modeling latent and observed heterogeneity, <em>arXiv:2106.03811</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_sim4)
est = estLCCR(Y=data_sim4$Y,H=2,X=data_sim4$X,W=data_sim4$W)
</code></pre>

<hr>
<h2 id='design_matrix_logit'>Design matrix for recursive logit parametrization</h2><span id='topic+design_matrix_logit'></span>

<h3>Description</h3>

<p>For a latent class model for capture-recapture data, it provides design matrices for the recursive logit parametrization used to formulate the conditional distribution of capture configurations given the latent class. It is possible to include the effect of covariates and of previous captures.</p>


<h3>Usage</h3>

<pre><code class='language-R'>design_matrix_logit(J, H = 1, main = c("LC", "same", "Rasch"), X = NULL,
                    free_cov = c("no", "class", "resp", "both"),
                    flag = c("no", "prev", "sum", "atleast"),
                    free_flag = c("no", "class", "resp", "both"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="design_matrix_logit_+3A_j">J</code></td>
<td>
<p>number of capture occasions</p>
</td></tr>
<tr><td><code id="design_matrix_logit_+3A_h">H</code></td>
<td>
<p>number of latent classes</p>
</td></tr>
<tr><td><code id="design_matrix_logit_+3A_main">main</code></td>
<td>
<p>&quot;LC&quot; for the latent class model in which there is a separate main effect for each capture occasion and latent class; &quot;same&quot; for the constrained model in which the main effect is the same across capture occasions but different across latent classes; &quot;Rasch&quot; for the constrained model in which each main effect is expressed in an additive form with a parameter related to the latent class and another parameter related to the capture occasion</p>
</td></tr>
<tr><td><code id="design_matrix_logit_+3A_x">X</code></td>
<td>
<p>array of covariates (n. strata x n. covariates x n. responses)</p>
</td></tr>
<tr><td><code id="design_matrix_logit_+3A_free_cov">free_cov</code></td>
<td>
<p>&quot;no&quot; for constant effect of the covariates across capture occasions and latent classes; &quot;class&quot; for effect of covariates varying only with the latent class; &quot;resp&quot; for effect of covariates varying only with the capture occasion; &quot;both&quot; for effect of covariates varying with the capture occasion and the latent class</p>
</td></tr>
<tr><td><code id="design_matrix_logit_+3A_flag">flag</code></td>
<td>
<p>&quot;no&quot; for no lag effect; &quot;prev&quot; for effect of the previous capture occasion only; &quot;sum&quot; for the effect of the sum of the previous capture occasions; &quot;atleast&quot; for the effect of at least one capture at the previous occasions</p>
</td></tr>
<tr><td><code id="design_matrix_logit_+3A_free_flag">free_flag</code></td>
<td>
<p>&quot;no&quot; for constant effect of the previous capture occasions with respect to the occasion and the latent class; &quot;class&quot; for free effect only with respect to the latent class; &quot;int&quot; for free effect only with respect to the occasion; &quot;both&quot; for free effect with respect to capture occasion and latent class</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>M</code></td>
<td>
<p>design matrices</p>
</td></tr>
<tr><td><code>par_list</code></td>
<td>
<p>list of parameter names</p>
</td></tr>
<tr><td><code>Main</code></td>
<td>
<p>list of capture configurations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Foricna</p>


<h3>References</h3>

<p>Forcina, A. and Bartolucci, F. (2021). Estimating the size of a closed population by modeling latent and observed heterogeneity, <em>arXiv:2106.03811</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+design_matrix_loglin">design_matrix_loglin</a></code>, <code><a href="#topic+matrix_logit">matrix_logit</a></code>, <code><a href="#topic+estLCCR">estLCCR</a></code>
</p>

<hr>
<h2 id='design_matrix_loglin'>Design matrix for loglinear parametrization</h2><span id='topic+design_matrix_loglin'></span>

<h3>Description</h3>

<p>For a latent class model for capture-recapture data, it provides design matrices for the loglinear parametrization used to formulate the conditional distribution of the capture configurations given the latent class. It is possible to include the effect of covariates and bivariate interactions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>design_matrix_loglin(J, H = 1, main = c("LC", "same", "Rasch"), X = NULL,
                     free_cov = c("no", "class", "resp", "both"),
                     biv = NULL, free_biv = c("no", "class", "int", "both"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="design_matrix_loglin_+3A_j">J</code></td>
<td>
<p>number of capture occasions</p>
</td></tr>
<tr><td><code id="design_matrix_loglin_+3A_h">H</code></td>
<td>
<p>number of latent classes</p>
</td></tr>
<tr><td><code id="design_matrix_loglin_+3A_main">main</code></td>
<td>
<p>&quot;LC&quot; for the latent class model in which there is a separate main effect for each capture occasion and latent class; &quot;same&quot; for the constrained model in which the main effect is the same across capture occasions but different across latent classes; &quot;Rasch&quot; for the constrained model in which each main effect is expressed in an additive form with a parameter related to the latent class and another parameter related to the capture occasion</p>
</td></tr>
<tr><td><code id="design_matrix_loglin_+3A_x">X</code></td>
<td>
<p>array of covariates (n. strata x n. covariates x n. responses)</p>
</td></tr>
<tr><td><code id="design_matrix_loglin_+3A_free_cov">free_cov</code></td>
<td>
<p>&quot;no&quot; for constant effect of the covariates across capture occasions and latent classes; &quot;class&quot; for effect of covariates varying only with the latent class; &quot;resp&quot; for effect of covariates varying only with the capture occasion; &quot;both&quot; for effect of covariates varying with the capture occasion and the latent class</p>
</td></tr>
<tr><td><code id="design_matrix_loglin_+3A_biv">biv</code></td>
<td>
<p>matrix with two columns containing the list of bivariate interactions</p>
</td></tr>
<tr><td><code id="design_matrix_loglin_+3A_free_biv">free_biv</code></td>
<td>
<p>&quot;no&quot; for constant bivariate interation effect with respect to the occasion and the latent class; &quot;class&quot; for free interaction with respect to the latent class; &quot;int&quot; for free effect only with respect to the interation; &quot;both&quot; for free effect with respect to interation and latent class</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>M</code></td>
<td>
<p>design matrices</p>
</td></tr>
<tr><td><code>par_list</code></td>
<td>
<p>list of parameter names</p>
</td></tr>
<tr><td><code>Main</code></td>
<td>
<p>list of capture configurations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Foricna</p>


<h3>References</h3>

<p>Forcina, A. and Bartolucci, F. (2021). Estimating the size of a closed population by modeling latent and observed heterogeneity, <em>arXiv:2106.03811</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+design_matrix_logit">design_matrix_logit</a></code>, <code><a href="#topic+estLCCR">estLCCR</a></code>
</p>

<hr>
<h2 id='estLCCR'>Estimate latent class models for capture-recapture data with individual covariates</h2><span id='topic+estLCCR'></span>

<h3>Description</h3>

<p>For a latent class model for stratified capture-recapture data with individual covariates, it estimates the model on the basis of observed data by the unconditional likelihood method, exploiting weights associated to the different strata. Estimation of the model parameters, included the population size, is based on an EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estLCCR(Y, H, model = c("loglin", "logit"), W = NULL, X = NULL, N = NULL, biv = NULL,
        flag = c("no", "prev", "sum", "atleast"),
        main = c("LC", "same", "Rasch"),
        free_cov = c("no", "class", "resp", "both"),
        free_biv = c("no", "class", "int", "both"),
        free_flag = c("no", "class", "resp", "both"),
        N0 = NULL, be0 = NULL, la0 = NULL, maxit = 5000,
        verb = TRUE, init_rand = FALSE, se_out = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estLCCR_+3A_y">Y</code></td>
<td>
<p>matrix of frequencies for each stratum (by row)</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_h">H</code></td>
<td>
<p>number of latent classes</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_model">model</code></td>
<td>
<p>&quot;loglin&quot; for loglinear parametrization; &quot;logit&quot; for recursive logit parametrization</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_w">W</code></td>
<td>
<p>matrix of covariates on the class weights</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_x">X</code></td>
<td>
<p>array of covariates (n. strata x n. covariates x n. responses)</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_n">N</code></td>
<td>
<p>fixed population size</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_biv">biv</code></td>
<td>
<p>matrix with two columns containing the list of bivariate interactions (for loglinear parametrization)</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_flag">flag</code></td>
<td>
<p>&quot;no&quot; for no lag effect; &quot;prev&quot; for effect of the previous capture occasion only; &quot;sum&quot; for the effect of the sum of the previous capture occasions; &quot;atleast&quot; for the effect of at least one capture at the previous occasions (for recursive logit parametrization)</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_main">main</code></td>
<td>
<p>&quot;LC&quot; for the latent class model in which there is a separate main effect for each capture occasion and latent class; &quot;same&quot; for the constrained model in which the main effect is the same across capture occasions but different across latent classes; &quot;Rasch&quot; for the constrained model in which each main effect is expressed in an additive form with a parameter related to the latent class and another parameter related to the capture occasion</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_free_cov">free_cov</code></td>
<td>
<p>&quot;no&quot; for constant effect of the covariates across capture occasions and latent classes; &quot;class&quot; for effect of covariates varying only with the latent class; &quot;resp&quot; for effect of covariates varying only with the capture occasion; &quot;both&quot; for effect of covariates varying with the capture occasion and the latent class</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_free_biv">free_biv</code></td>
<td>
<p>&quot;no&quot; for constant bivariate interation effect with respect to the occasion and the latent class; &quot;class&quot; for free interaction with respect to the latent class; &quot;int&quot; for free effect only with respect to the interation; &quot;both&quot; for free effect with respect to interation and latent class (for loglinear parametrization)</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_free_flag">free_flag</code></td>
<td>
<p>&quot;no&quot; for constant effect of the previous capture occasions with respect to the occasion and the latent class; &quot;class&quot; for free effect only with respect to the latent class; &quot;int&quot; for free effect only with respect to the occasion; &quot;both&quot; for free effect with respect to capture occasion and latent class (for recursive logit parametrization)</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_n0">N0</code></td>
<td>
<p>initial value of the population size</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_be0">be0</code></td>
<td>
<p>initial value of the parameters affecting the class weights</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_la0">la0</code></td>
<td>
<p>initial value of the parameters affecting the conditional distribution of capture configurations given the latent class</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the EM algorithm</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_verb">verb</code></td>
<td>
<p>to have partial output during the model fitting</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_init_rand">init_rand</code></td>
<td>
<p>to use a random initialization of the parameters</p>
</td></tr>
<tr><td><code id="estLCCR_+3A_se_out">se_out</code></td>
<td>
<p>to require computation of the standard errors</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>be</code></td>
<td>
<p>estimate of the parameters affecting the class weights</p>
</td></tr>
<tr><td><code>la</code></td>
<td>
<p>estimate of the parameters affecting the conditional distribution of capture configurations given the latent class</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>final log-likelihood value</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>estimate of the population size</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>value of AIC for model selection</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>value of BIC for model selection</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>design matrices used for the recursive logit or loglinear parametrization of the conditional distribution of capture configurations given the latent class</p>
</td></tr>
<tr><td><code>tauv</code></td>
<td>
<p>estimate of the weights of each stratum</p>
</td></tr>
<tr><td><code>phiv</code></td>
<td>
<p>estimate of the probability of being never captured for each stratum</p>
</td></tr>
<tr><td><code>seN</code></td>
<td>
<p>standard error for the estimate of N</p>
</td></tr>
<tr><td><code>sebe</code></td>
<td>
<p>standard error for the estimate of beta</p>
</td></tr>
<tr><td><code>sela</code></td>
<td>
<p>standard error for the estimate of lambda</p>
</td></tr>
<tr><td><code>lk1</code></td>
<td>
<p>component of the log-likelihood based on the binomial factor in N</p>
</td></tr>
<tr><td><code>lk2</code></td>
<td>
<p>component of the log-likelihood involving N and the overall probability of being never captured</p>
</td></tr>
<tr><td><code>lk3</code></td>
<td>
<p>component of the log-likelihood involving the capture probabilities</p>
</td></tr>
<tr><td><code>lk4</code></td>
<td>
<p>component of the log-likelihood involving the stratum weights</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Forcina</p>


<h3>References</h3>

<p>Forcina, A. and Bartolucci, F. (2021). Estimating the size of a closed population by modeling latent and observed heterogeneity, <em>arXiv:2106.03811</em>.
</p>
<p>Liu, Y., Li, P., and Qin, J. (2017). Maximum empirical likelihood estimation for abundance in a closed population from capture-recapture data. <em>Biometrika</em>, <b>104</b>, 527-543.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+design_matrix_logit">design_matrix_logit</a></code>, <code><a href="#topic+design_matrix_loglin">design_matrix_loglin</a></code>, <code><a href="#topic+simLCCR">simLCCR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# estimate latent class model with 2 classes having the same weight on 5 lists
data(data_sim1)
est = estLCCR(Y=data_sim1,H=2)
est

# estimate latent class model with 2 classes, one covariate affecting the weights and bivariate 
# loglinear interactions between consecutive lists
data(data_sim2)
est = estLCCR(Y=data_sim2$Y,H=2,W=data_sim2$W,biv=matrix(c(1,2,3,4,2,3,4,5),4),main="same")
est

# estimate latent class model with 3 classes, one covariate affecting the logits of each response,
# and lag dependence
data(data_sim3)
est = estLCCR(Y=data_sim3$Y,H=3,model="logit",X=data_sim3$X,flag="atleast")
est

# estimate latent class model with 2 classes and covariates affecting both the class weights and
# conditional capture probabilities given the latent class
data(data_sim4)
est = estLCCR(Y=data_sim4$Y,H=2,X=data_sim4$X,W=data_sim4$W)
est

</code></pre>

<hr>
<h2 id='estLCCRcon'>CML estimation of latent class models for capture-recapture data with individual covariates</h2><span id='topic+estLCCRcon'></span>

<h3>Description</h3>

<p>For a latent class model for stratified capture-recapture data with individual covariates, it estimates the model on the basis of observed data by the conditional likelihood method, exploiting weights associated to the different strata. Estimation of the model parameters, included the population size, is based on an EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estLCCRcon(Y, H, model = c("loglin", "logit"), W = NULL, X = NULL, N = NULL, biv = NULL,
        flag = c("no", "prev", "sum", "atleast"),
        main = c("LC", "same", "Rasch"),
        free_cov = c("no", "class", "resp", "both"),
        free_biv = c("no", "class", "int", "both"),
        free_flag = c("no", "class", "resp", "both"),
        N0 = NULL, be0 = NULL, la0 = NULL, maxit = 5000,
        verb = TRUE, init_rand = FALSE, se_out = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estLCCRcon_+3A_y">Y</code></td>
<td>
<p>matrix of frequencies for each stratum (by row)</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_h">H</code></td>
<td>
<p>number of latent classes</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_model">model</code></td>
<td>
<p>&quot;loglin&quot; for loglinear parametrization; &quot;logit&quot; for recursive logit parametrization</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_w">W</code></td>
<td>
<p>matrix of covariates on the class weights</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_x">X</code></td>
<td>
<p>array of covariates (n. strata x n. covariates x n. responses)</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_n">N</code></td>
<td>
<p>fixed population size</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_biv">biv</code></td>
<td>
<p>matrix with two columns containing the list of bivariate interactions (for loglinear parametrization)</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_flag">flag</code></td>
<td>
<p>&quot;no&quot; for no lag effect; &quot;prev&quot; for effect of the previous capture occasion only; &quot;sum&quot; for the effect of the sum of the previous capture occasions; &quot;atleast&quot; for the effect of at least one capture at the previous occasions (for recursive logit parametrization)</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_main">main</code></td>
<td>
<p>&quot;LC&quot; for the latent class model in which there is a separate main effect for each capture occasion and latent class; &quot;same&quot; for the constrained model in which the main effect is the same across capture occasions but different across latent classes; &quot;Rasch&quot; for the constrained model in which each main effect is expressed in an additive form with a parameter related to the latent class and another parameter related to the capture occasion</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_free_cov">free_cov</code></td>
<td>
<p>&quot;no&quot; for constant effect of the covariates across capture occasions and latent classes; &quot;class&quot; for effect of covariates varying only with the latent class; &quot;resp&quot; for effect of covariates varying only with the capture occasion; &quot;both&quot; for effect of covariates varying with the capture occasion and the latent class</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_free_biv">free_biv</code></td>
<td>
<p>&quot;no&quot; for constant bivariate interation effect with respect to the occasion and the latent class; &quot;class&quot; for free interaction with respect to the latent class; &quot;int&quot; for free effect only with respect to the interation; &quot;both&quot; for free effect with respect to interation and latent class (for loglinear parametrization)</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_free_flag">free_flag</code></td>
<td>
<p>&quot;no&quot; for constant effect of the previous capture occasions with respect to the occasion and the latent class; &quot;class&quot; for free effect only with respect to the latent class; &quot;int&quot; for free effect only with respect to the occasion; &quot;both&quot; for free effect with respect to capture occasion and latent class (for recursive logit parametrization)</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_n0">N0</code></td>
<td>
<p>initial value of the population size</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_be0">be0</code></td>
<td>
<p>initial value of the parameters affecting the class weights</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_la0">la0</code></td>
<td>
<p>initial value of the parameters affecting the conditional distribution of capture configurations given the latent class</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations of the EM algorithm</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_verb">verb</code></td>
<td>
<p>to have partial output during the model fitting</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_init_rand">init_rand</code></td>
<td>
<p>to use a random initialization of the parameters</p>
</td></tr>
<tr><td><code id="estLCCRcon_+3A_se_out">se_out</code></td>
<td>
<p>to require computation of the standard errors</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>be</code></td>
<td>
<p>estimate of the parameters affecting the class weights</p>
</td></tr>
<tr><td><code>la</code></td>
<td>
<p>estimate of the parameters affecting the conditional distribution of capture configurations given the latent class</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>final log-likelihood value</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>estimate of the population size</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>value of AIC for model selection</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>value of BIC for model selection</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>design matrices used for the recursive logit or loglinear parametrization of the conditional distribution of capture configurations given the latent class</p>
</td></tr>
<tr><td><code>phiv</code></td>
<td>
<p>estimate of the probability of being never captured for each stratum</p>
</td></tr>
<tr><td><code>seN</code></td>
<td>
<p>standard error for the estimate of N</p>
</td></tr>
<tr><td><code>sebe</code></td>
<td>
<p>standard error for the estimate of beta</p>
</td></tr>
<tr><td><code>sela</code></td>
<td>
<p>standard error for the estimate of lambda</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Forcina</p>


<h3>References</h3>

<p>Bartolucci, F. and Forcina, A. (2006). Estimating the size of a closed population by modeling latent and observed heterogeneity. <em>Journal of the American Statistical Association</em>, <b>101</b>, 786-794.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+design_matrix_logit">design_matrix_logit</a></code>, <code><a href="#topic+design_matrix_loglin">design_matrix_loglin</a></code>, <code><a href="#topic+simLCCR">simLCCR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# estimate latent class model with 2 classes having the same weight on 5 lists
data(data_sim1)
est = estLCCRcon(Y=data_sim1,H=2)
est

# estimate latent class model with 2 classes, one covariate affecting the weights and bivariate 
# loglinear interactions between consecutive lists
data(data_sim2)
est = estLCCRcon(Y=data_sim2$Y,H=2,W=data_sim2$W,biv=matrix(c(1,2,3,4,2,3,4,5),4),main="same")
est

# estimate latent class model with 3 classes, one covariate affecting the logits of each response,
# and lag dependence
data(data_sim3)
est = estLCCRcon(Y=data_sim3$Y,H=3,model="logit",X=data_sim3$X,flag="atleast")
est

# estimate latent class model with 2 classes and covariates affecting both the class weights and
# conditional capture probabilities given the latent class
data(data_sim4)
est = estLCCRcon(Y=data_sim4$Y,H=2,X=data_sim4$X,W=data_sim4$W)
est

</code></pre>

<hr>
<h2 id='freq_data'>Convert capture-recapture configurations into frequency data</h2><span id='topic+freq_data'></span>

<h3>Description</h3>

<p>Given a matrix of observed capture-recapture configurations, convert the data to a matrix of frequencies having the same number of rows and a number of columns equal to the number of possible configurations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>freq_data(R)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="freq_data_+3A_r">R</code></td>
<td>
<p>Matrix of size n (sample size) x J (number of capture occastions) of observed capture-recapture configurations</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>Matrix of frequency of each capture configuration of size n x (2^J)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Forcina
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aggr_data">aggr_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>R = rbind(c(0,0,0,1),c(0,1,0,0),c(0,0,1,1),c(1,1,1,1))
Y = freq_data(R)
</code></pre>

<hr>
<h2 id='matrix_logit'>Design matrices of saturated logit parametrization</h2><span id='topic+matrix_logit'></span>

<h3>Description</h3>

<p>For J binary responses, it provides design matrices A and B used to express the saturated recursive logit parametrization of type log(p) = [A*eta-B*log(1+exp(eta))].</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrix_logit(J)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrix_logit_+3A_j">J</code></td>
<td>
<p>number of capture occasions</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>A</code></td>
<td>
<p>first matrix involved in the recursive logit parametrization</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>second matrix involved in the recursive logit parametrization</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Foricna</p>


<h3>References</h3>

<p>Forcina, A. and Bartolucci, F. (2021). Estimating the size of a closed population by modeling latent and observed heterogeneity, <em>arXiv:2106.03811</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+matrix_logit">matrix_logit</a></code>, <code><a href="#topic+estLCCR">estLCCR</a></code>
</p>

<hr>
<h2 id='plot'>Plot profile confidence interval</h2><span id='topic+plot.confLCCR'></span>

<h3>Description</h3>

<p>Plot for output from <code>confint.estLCCR</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'confLCCR'
plot(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>an object of class <code>condLCCR</code></p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>further possible arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>M</code></td>
<td>
<p>matrix of binary configurations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Forcina</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(data_sim2)
est = estLCCR(Y=data_sim2$Y,H=2,W=data_sim2$W,biv=matrix(c(1,2,3,4,2,3,4,5),4),main="same")
conf = confint(est)
plot(conf)

</code></pre>

<hr>
<h2 id='print'>Print the output</h2><span id='topic+print.estLCCR'></span><span id='topic+print.estLCCRcon'></span><span id='topic+print.confLCCR'></span>

<h3>Description</h3>

<p>Given the output, it is written in a readable form.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'estLCCR'
print(x, ...)
## S3 method for class 'estLCCRcon'
print(x, ...)
## S3 method for class 'confLCCR'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_+3A_x">x</code></td>
<td>
<p>output from <code><a href="#topic+estLCCR">estLCCR</a></code>, <code><a href="#topic+estLCCRcon">estLCCRcon</a></code> or <code><a href="#topic+confint.estLCCR">confint.estLCCR</a></code></p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Forcina</p>

<hr>
<h2 id='simLCCR'>Simulate capture-recapture data from a latent class model with individual covariates</h2><span id='topic+simLCCR'></span>

<h3>Description</h3>

<p>The function simulates capture-recapture data from a latent class model with individual covariates that may affect the class weights and/or the conditional distribution of capture configurations given the latent class. The data may be in disaggregated form (with each stratum having unitary dimension) or aggregated form (with strata having generic dimension).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simLCCR(H, J, be, la, N, model = c("loglin", "logit"), Wc = NULL, Xc = NULL, biv = NULL,
        flag = c("no", "prev", "sum", "atleast"),
        main = c("LC", "same", "Rasch"), 
        free_cov = c("no", "class", "resp", "both"),
        free_biv = c("no", "class", "int", "both"),
        free_flag = c("no", "class", "resp", "both"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simLCCR_+3A_h">H</code></td>
<td>
<p>number of latent classes</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_j">J</code></td>
<td>
<p>number of capture occasions</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_be">be</code></td>
<td>
<p>value of the parameters affecting the class weights</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_la">la</code></td>
<td>
<p>value of the parameters affecting the conditional distribution of capture configurations given the latent</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_n">N</code></td>
<td>
<p>population size (with individual data); vector containing the size of any stratum (with aggregated data)</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_model">model</code></td>
<td>
<p>population size (with individual data); vector containing the size of any stratum (with aggregated data)</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_wc">Wc</code></td>
<td>
<p>matrix of covariates affecting the class weights at population level</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_xc">Xc</code></td>
<td>
<p>array of covariates at population level (n. strata x n. covariates x n. responses)</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_biv">biv</code></td>
<td>
<p>matrix with two columns containing the list of bivariate interactions (for loglinear parametrization)</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_flag">flag</code></td>
<td>
<p>&quot;no&quot; for no lag effect; &quot;prev&quot; for effect of the previous capture occasion only; &quot;sum&quot; for the effect of the sum of the previous capture occasions; &quot;atleast&quot; for the effect of at least one capture at the previous occasions (for recursive logit parametrization)</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_main">main</code></td>
<td>
<p>&quot;LC&quot; for the latent class model in which there is a separate main effect for each capture occasion and latent class; &quot;same&quot; for the constrained model in which the main effect is the same across capture occasions but different across latent classes; &quot;Rasch&quot; for the constrained model in which each main effect is expressed in an additive form with a parameter related to the latent class and another parameter related to the capture occasion</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_free_cov">free_cov</code></td>
<td>
<p>&quot;no&quot; for constant effect of the covariates across capture occasions and latent classes; &quot;class&quot; for effect of covariates varying only with the latent class; &quot;resp&quot; for effect of covariates varying only with the capture occasion; &quot;both&quot; for effect of covariates varying with the capture occasion and the latent class</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_free_biv">free_biv</code></td>
<td>
<p>&quot;no&quot; for constant bivariate interation effect with respect to the occasion and the latent class; &quot;class&quot; for free interaction with respect to the latent class; &quot;int&quot; for free effect only with respect to the interation; &quot;both&quot; for free effect with respect to interation and latent class (for loglinear parametrization)</p>
</td></tr>
<tr><td><code id="simLCCR_+3A_free_flag">free_flag</code></td>
<td>
<p>&quot;no&quot; for constant effect of the previous capture occasions with respect to the occasion and the latent class; &quot;class&quot; for free effect only with respect to the latent class; &quot;int&quot; for free effect only with respect to the occasion; &quot;both&quot; for free effect with respect to capture occasion and latent class (for recursive logit parametrization)</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Y</code></td>
<td>
<p>matrix of frequencies for each stratum (by row), only for captured indivdiuals</p>
</td></tr>
<tr><td><code>Yc</code></td>
<td>
<p>matrix of frequencies for each stratum (by row), for all indivdiuals</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>matrix of class weights for each stratum</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>matrix of the conditional distribution of capture configurations given the latent class</p>
</td></tr>
<tr><td><code>Pm</code></td>
<td>
<p>matrix of the distribution of the capture configurations (with aggregated data)</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>matrix of single capture occasions (with individual data), only for captured individuals</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>vector of latent classes (with individual data)</p>
</td></tr>
<tr><td><code>Rc</code></td>
<td>
<p>matrix of single capture occasions (with individual data), for all individuals</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>matrix of covariates affecting the class weights, only for captured individuals</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>array of covariates affecting the conditional distribution of capture configurations given the latent class, only for captured individuals</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Forcina</p>


<h3>References</h3>

<p>Forcina, A. and Bartolucci, F. (2021). Estimating the size of a closed population by modeling latent and observed heterogeneity, <em>arXiv:2106.03811</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+design_matrix_logit">design_matrix_logit</a></code>, <code><a href="#topic+design_matrix_loglin">design_matrix_loglin</a></code>, <code><a href="#topic+estLCCR">estLCCR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate data from latent class model with 2 classes having the same weight on 5 lists
out = simLCCR(2,5,be=0,la=c(rep(-1,5),rep(1,5)),N=200)

# simulate data from a latent class model with 2 classes, one covariate affecting the weights and 
# bivariate loglinear interactions between consecutive lists
Wc = rnorm(200)
out = simLCCR(2,6,be=c(0,1),la=c(-1,1,1),N=200,Wc=Wc,biv=matrix(c(1,2,3,4,2,3,4,5),4),main="same")

# simulate data from a latent class model with 3 classes, one covariate affecting the logits of 
# each response, and lag dependence
Xc = rnorm(200)
out = simLCCR(3,6,model="logit",be=c(0,0),la=c(rep(-1,6),rep(0,6),rep(1,6),1,1),N=200,Xc=Xc,
              flag="atleast")

# simulate data from latent class model with 2 classes and covariates affecting both class weights
# and conditional probabilities of capture configurations given the latent class
Wc = c(-1,0,1); Xc = rnorm(3)
out = simLCCR(2,5,be=c(0,0),la=c(rep(-1,5),rep(1,5),1),N=c(100,100,100),Wc=Wc,Xc=Xc)
</code></pre>

<hr>
<h2 id='sq'>Build matrix of binary vectors of a fixed lenght</h2><span id='topic+sq'></span>

<h3>Description</h3>

<p>It creates all possible binary (with elements equal to 0 or 1) vectors of a specified length; these vectors are casted in a matrix having a number of columns equal to the vector length. If required, the binary vectors are constrained to have the same total (sum of their elements).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sq(J, t = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sq_+3A_j">J</code></td>
<td>
<p>legnth of binary vectors</p>
</td></tr>
<tr><td><code id="sq_+3A_t">t</code></td>
<td>
<p>possible fixed total</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>M</code></td>
<td>
<p>matrix containing all binary vectors</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Forcina</p>


<h3>Examples</h3>

<pre><code class='language-R'># build matrix of all possible binary vectors of legnth 5
  M = sq(5)
  
# build matrix of all possible binary vectors of legnth 5 with total equal 2
  M = sq(5,2)
</code></pre>

<hr>
<h2 id='summary'>Summary of output</h2><span id='topic+summary.estLCCR'></span><span id='topic+summary.estLCCRcon'></span><span id='topic+summary.confLCCR'></span>

<h3>Description</h3>

<p>Summary of output from fitting latent class models for capture-recapture data with covariates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'estLCCR'
summary(object, ...)
## S3 method for class 'estLCCRcon'
summary(object, ...)
## S3 method for class 'confLCCR'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>output from <code><a href="#topic+estLCCR">estLCCR</a></code>,<code><a href="#topic+estLCCRcon">estLCCRcon</a></code> or <code><a href="#topic+confint.estLCCR">confint.estLCCR</a></code></p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Antonio Forcina
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
