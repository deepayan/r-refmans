<!DOCTYPE html><html><head><title>Help for package seacarb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {seacarb}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alkalinity'><p>Example data file for function at</p></a></li>
<li><a href='#amp'><p>pH value of the AMP buffer</p></a></li>
<li><a href='#bjerrum'><p>Bjerrum plot</p></a></li>
<li><a href='#bor'><p>Total boron concentration (mol/kg)</p></a></li>
<li><a href='#buffer'><p>Buffer parameters of the seawater carbonate system</p></a></li>
<li><a href='#buffergen'><p>Buffer factors of the seawater carbonate system as defined by Hagens and</p>
Middelburg (2016)</a></li>
<li><a href='#buffesm'><p>Buffer capacities of the seawater carbonate system from Egleston et al. (2010), corrected and enhanced</p></a></li>
<li><a href='#carb'><p>Parameters of the seawater carbonate system</p></a></li>
<li><a href='#carbb'><p>Parameters of the seawater carbonate system with boron addition</p></a></li>
<li><a href='#carbfull'><p>Parameters of the seawater carbonate system - extension of carb</p></a></li>
<li><a href='#d2p'><p>Converts depth in meters to pressure in dbar</p></a></li>
<li><a href='#derivnum'><p>Numerical derivatives of seawater carbonate system variables</p></a></li>
<li><a href='#eos2teos_chem'><p>Convert temperature and salinity from EOS-80 to TEOS-10</p></a></li>
<li><a href='#eos2teos_geo'><p>Convert temperature and salinity from EOS-80 to TEOS-10</p></a></li>
<li><a href='#errors'><p>Uncertainty propagation for computed marine carbonate system variables</p></a></li>
<li><a href='#f2pCO2'><p>Converts the CO2 fugacity to CO2 partial pressure</p></a></li>
<li><a href='#fCO2insi'><p>fCO2 at in situ temperature</p></a></li>
<li><a href='#fH'><p>Total activity coefficient for H+</p></a></li>
<li><a href='#K0'><p>Henry's constant mol/(kg/atm)</p></a></li>
<li><a href='#K1'><p>First dissociation constant of carbonic acid (mol/kg)</p></a></li>
<li><a href='#K1p'><p>First dissociation constant of phosphoric acid (mol/kg)</p></a></li>
<li><a href='#K2'><p>Second dissociation constant of carbonic acid (mol/kg)</p></a></li>
<li><a href='#K2p'><p>Second dissociation constant of phosphoric acid (mol/kg)</p></a></li>
<li><a href='#K2si'><p>Second dissociation constant of Si(OH)4</p></a></li>
<li><a href='#K3p'><p>Third dissociation constant of phosphoric acid (mol/kg)</p></a></li>
<li><a href='#Kb'><p>Dissociation constant of boric acid (mol/kg)</p></a></li>
<li><a href='#kconv'><p>Conversion factors to change the pH scale of dissociation constants</p></a></li>
<li><a href='#Kf'><p>Equilibrium constant of hydrogen fluoride (mol/kg)</p></a></li>
<li><a href='#kfg'><p>variable for internal use</p></a></li>
<li><a href='#Khs'><p>Dissociation constant of hydrogen sulfide (mol/kg)</p></a></li>
<li><a href='#Kn'><p>Dissociation constant of ammonium (mol/kg)</p></a></li>
<li><a href='#Ks'><p>Stability constant of hydrogen sulfate (mol/kg)</p></a></li>
<li><a href='#Ksi'><p>Dissociation constant of Si(OH)4</p></a></li>
<li><a href='#Kspa'><p>Solubility product of aragonite (mol/kg)</p></a></li>
<li><a href='#Kspc'><p>Solubility product of calcite (mol/kg)</p></a></li>
<li><a href='#Kw'><p>Ion product of water (mol2/kg2)</p></a></li>
<li><a href='#oa'><p>Perturbation of the seawater carbonate system</p></a></li>
<li><a href='#Om'><p>Carbonate saturation state for magnesian calcites</p></a></li>
<li><a href='#p2d'><p>Converts pressure in dbar to depth in meters</p></a></li>
<li><a href='#p2fCO2'><p>Converts pCO2 (partial pressure in CO2) into fCO2 (fugacity of CO2)</p></a></li>
<li><a href='#p2xCO2'><p>Converts partial pressure of CO2 to mole fraction of CO2</p></a></li>
<li><a href='#pCa'><p>pCa</p></a></li>
<li><a href='#pCO2insi'><p>pCO2 at in situ temperature</p></a></li>
<li><a href='#Pcoeffs'><p>Coefficients used for pressure-correcting the equilibrium constants</p></a></li>
<li><a href='#Pcorrect'><p>Pressure correction of equilibrium constants</p></a></li>
<li><a href='#pgas'><p>pgas</p></a></li>
<li><a href='#pH'><p>Potentiometric pH</p></a></li>
<li><a href='#pHconv'><p>Conversion of pH</p></a></li>
<li><a href='#pHinsi'><p>pH at in situ temperature and pressure</p></a></li>
<li><a href='#pHnbs2sws'><p>Converts pH from NBS to SWS scale</p></a></li>
<li><a href='#pHslope'><p>Slope of the calibration curve of a pH electrode</p></a></li>
<li><a href='#pHspec'><p>Calculates pHT from results of spectrophotometric measurements</p></a></li>
<li><a href='#pHsws2nbs'><p>Converts pH from SWS to NBS scale</p></a></li>
<li><a href='#pmix'><p>pmix</p></a></li>
<li><a href='#ppH'><p>ppH</p></a></li>
<li><a href='#psi'><p>Molar ratio of CO2 released vs CaCO3 precipitated</p></a></li>
<li><a href='#pTA'><p>pTA</p></a></li>
<li><a href='#rho'><p>Density of seawater  (kg/m3)</p></a></li>
<li><a href='#sa2sp_chem'><p>From absolute to practical salinity</p></a></li>
<li><a href='#sa2sp_geo'><p>From absolute to practical salinity</p></a></li>
<li><a href='#seacarb_test_P0'><p>Test data file (at P=0) to test the use of the carb function</p></a></li>
<li><a href='#seacarb_test_P300'><p>Test data file (at P=300) to test the use of the carb function</p></a></li>
<li><a href='#seaFET'><p>Test seaFET data file</p></a></li>
<li><a href='#sf_calc'><p>Calculation of calibrated pH for seaFET sensor</p></a></li>
<li><a href='#sf_calib'><p>Calibration coefficients for seaFET sensor</p></a></li>
<li><a href='#sir'>
<p>Parameters of the seawater carbonate system including the substrate-inhibitor-ratio (SIR)</p></a></li>
<li><a href='#sir_b'>
<p>Parameters of the seawater carbonate system with boron addition, including the substrate-inhibitor-ratio (SIR)</p></a></li>
<li><a href='#sir_full'>
<p>Parameters of the seawater carbonate system including the substrate-inhibitor-ratio (SIR) - extension of carb</p></a></li>
<li><a href='#sp2sa_chem'><p>From Practical to absolute salinity</p></a></li>
<li><a href='#sp2sa_geo'><p>From practical to absolute salinity</p></a></li>
<li><a href='#speciation'><p>ionic forms as a function of pH</p></a></li>
<li><a href='#teos2eos_chem'><p>Convert temperature and salinity from TEOS-10 to EOS-80</p></a></li>
<li><a href='#teos2eos_geo'><p>Convert temperature and salinity from TEOS-10 to EOS-80</p></a></li>
<li><a href='#theta'><p>Potential temperature of seawater</p></a></li>
<li><a href='#tris'><p>pH of TRIS buffer</p></a></li>
<li><a href='#vapress'><p>Computes vapor pressure of seawater</p></a></li>
<li><a href='#x2pCO2'><p>Converts mole fraction to partial pressure of CO2</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Seawater Carbonate Chemistry</td>
</tr>
<tr>
<td>Version:</td>
<td>3.3.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-14</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), oce, gsw, SolveSAPHE</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates parameters of the seawater carbonate system and assists the design of ocean acidification perturbation experiments.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=seacarb">https://CRAN.R-project.org/package=seacarb</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-15 13:39:30 UTC; gattuso</td>
</tr>
<tr>
<td>Author:</td>
<td>Jean-Pierre Gattuso [aut, cre, cph],
  Jean-Marie Epitalon [aut],
  Heloise Lavigne [aut],
  James Orr [aut],
  Bernard Gentili [ctb],
  Mathilde Hagens [ctb],
  Andreas Hofmann [ctb],
  Jens-Daniel Mueller [ctb],
  Aur√©lien Proye [ctb],
  James Rae [ctb],
  Karline Soetaert [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jean-Pierre Gattuso &lt;jean-pierre.gattuso@imev-mer.fr&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-15 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='alkalinity'>Example data file for function at</h2><span id='topic+alkalinity'></span>

<h3>Description</h3>

<p>The variables are:
</p>

<ul>
<li><p> volume: Volume of acid added to the sample in ml	
</p>
</li>
<li><p> E: Potential measured during the titration in mV	
</p>
</li>
<li><p> temperature: Temperature in degrees Celsius	
</p>
</li>
<li><p> weight: Weight of the sample in g
</p>
</li>
<li><p> S: Salinity
</p>
</li>
<li><p> normality : Normality of the acid
</p>
</li>
<li><p> ETris: Potential used for the calibration of the electrode in mV
</p>
</li>
<li><p> pHTris: pH used for the calibration of the electrode with the TRIS buffer
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>alkalinity</code></pre>


<h3>Format</h3>

<p>A data frame with 29 rows and 8 variables</p>


<h3>Source</h3>

<p>Data come from a potentiometric titration performed by Steeve Comeau.
</p>

<hr>
<h2 id='amp'>pH value of the AMP buffer</h2><span id='topic+amp'></span>

<h3>Description</h3>

<p>pH value of the AMP buffer (on the total scale in mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>amp(S=35,T=25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="amp_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="amp_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.</p>


<h3>Value</h3>

<table>
<tr><td><code>AMP</code></td>
<td>
<p>pH value of the AMP buffer (on the total scale in mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tris">tris</a></code>, <code><a href="#topic+pHslope">pHslope</a></code>, <code><a href="#topic+pH">pH</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	##Example from Dickson et al. (2007)
	amp(S=35,T=25)
</code></pre>

<hr>
<h2 id='bjerrum'>Bjerrum plot</h2><span id='topic+bjerrum'></span>

<h3>Description</h3>

<p>Plot the concentration of the various ionic forms of a molecule as a function of pH</p>


<h3>Usage</h3>

<pre><code class='language-R'>bjerrum(K1=K1(), K2=NULL, K3=NULL, phmin=2, phmax=12, by=0.1, conc=1, 
     type="l", col="black",  ylab="Relative concentration (%)", add=FALSE, ...)
     </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bjerrum_+3A_k1">K1</code></td>
<td>
<p>First dissociation constant</p>
</td></tr>
<tr><td><code id="bjerrum_+3A_k2">K2</code></td>
<td>
<p>Second dissociation constant, default is NULL</p>
</td></tr>
<tr><td><code id="bjerrum_+3A_k3">K3</code></td>
<td>
<p>Third dissociation constant, default is NULL</p>
</td></tr>
<tr><td><code id="bjerrum_+3A_phmin">phmin</code></td>
<td>
<p>Minimum pH value, default is 2</p>
</td></tr>
<tr><td><code id="bjerrum_+3A_phmax">phmax</code></td>
<td>
<p>Maximum pH value, default is 12</p>
</td></tr>
<tr><td><code id="bjerrum_+3A_by">by</code></td>
<td>
<p>Increment on the pH axis, default is 0.1</p>
</td></tr>
<tr><td><code id="bjerrum_+3A_conc">conc</code></td>
<td>
<p>concentration of molecule, default is 1</p>
</td></tr>
<tr><td><code id="bjerrum_+3A_type">type</code></td>
<td>
<p>Type of plot, default is line</p>
</td></tr>
<tr><td><code id="bjerrum_+3A_col">col</code></td>
<td>
<p>Color of plot, default is black</p>
</td></tr>
<tr><td><code id="bjerrum_+3A_ylab">ylab</code></td>
<td>
<p>Label of Y axis, default is (mol/kg)</p>
</td></tr>
<tr><td><code id="bjerrum_+3A_add">add</code></td>
<td>
<p>false:start new, true: add to current, default is false</p>
</td></tr>
<tr><td><code id="bjerrum_+3A_...">...</code></td>
<td>
<p>Graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>) and any further arguments of plot, typically <code><a href="graphics.html#topic+plot.default">plot.default</a></code>, may also be supplied as arguments to this function. Hence, the high-level graphics control arguments described under <code><a href="graphics.html#topic+par">par</a></code> and the arguments to <code><a href="graphics.html#topic+title">title</a></code> may be supplied to this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the concentration is plotted in mol/kg only if conc is given is mol/kg
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert <a href="mailto:K.Soetaert@nioo.knaw.nl">K.Soetaert@nioo.knaw.nl</a>
</p>


<h3>References</h3>

<p>Zeebe, R. E. and Wolf-Gladrow D. A., 2001 <em>CO2 in seawater: equilibrium, kinetics, isotopes</em>. Amsterdam: Elsevier, 346 pp.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+matplot">matplot</a></code>, <code><a href="graphics.html#topic+par">par</a></code>, <code><a href="#topic+speciation">speciation</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Plot the bjerrum plot for the carbonate system using the default values
bjerrum(K1(),K2(),main="DIC speciation",lwd=2) 
abline(v=-log10(K1()),col="grey")
mtext(side=3,at=-log10(K1()),"pK1")
abline(v=-log10(K2()),col="grey")
mtext(side=3,at=-log10(K2()),"pK2")
legend("left",lty=1:3,lwd=2,legend=c(expression(CO[2]),expression(HCO[3]^"-"),
	expression(CO[3]^"2-")))

## Plot the bjerrum plot for phosphate using the default values
bjerrum(K1p(),K2p(),K3p(),main="phosphate speciation",lwd=2)
legend("left",lty=1:4,lwd=2,legend=c(expression(H[3]~PO[4]),
	expression(H[2]~PO[4]^"-"),
expression(HPO[4]^"2-"),expression(PO[4]^"3-")))

## Plot the bjerrum plot for the carbonate system using the values other 
##	than the default ones, showing the effect of temperature
bjerrum(K1(T=25,S=35),K2(T=25,S=35),conc=1.3,main="effect of temperature" )
bjerrum(K1(T=0,S=35),K2(T=0,S=35),conc=1.3,add=TRUE,col="red")
legend("left",lty=1,col=c("black","red"),legend=c("T=25 oC","T=0 oC"))
legend("right",lty=1:3,legend=c(expression(CO[2]),expression(HCO[3]^"-"),
	expression(CO[3]^"2-")))

## Plot the bjerrum plot for the carbonate system using the values other 
##	than the default ones, showing the effect of salinity
bjerrum(K1(T=25,S=35),K2(T=25,S=35),conc=1.3,main="effect of salinity" )
bjerrum(K1(T=25,S=5),K2(T=25,S=5),conc=1.3,add=TRUE,col="blue")
legend("left",lty=1,col=c("black","blue"),legend=c("S=35","S=5"))
legend("right",lty=1:3,legend=c(expression(CO[2]),expression(HCO[3]^"-"),
	expression(CO[3]^"2-")))

## Plot the bjerrum plot for the carbonate system using the values other 
##	than the default ones, showing the effect of pressure
bjerrum(K1(P=0),K2(P=0),conc=1.3,main="effect of pressure" )
bjerrum(K1(P=300),K2(P=300),conc=1.3,add=TRUE,col="green")
legend("left",lty=1,col=c("black","green"),legend=c("P=0","P=300"),title="atm")
legend("right",lty=1:3,legend=c(expression(CO[2]),expression(HCO[3]^"-"),
	expression(CO[3]^"2-")))
</code></pre>

<hr>
<h2 id='bor'>Total boron concentration (mol/kg)</h2><span id='topic+bor'></span>

<h3>Description</h3>

<p>total boron concentration (<code class="reqn">mol\ kg^{-1}</code>)</p>


<h3>Usage</h3>

<pre><code class='language-R'>bor(S, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bor_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="bor_+3A_b">b</code></td>
<td>
<p>&quot;l10&quot; for using the formulation of Lee et al. (2010), &quot;u74&quot; for using the Uppstrom (1974), or &quot;k18&quot; for using the Kulinski et al. (2018), default is &quot;u74&quot; </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the formulation of Kulinski et al. (2018) is specifically designed for the Baltic Sea. Three formulations are described in their paper:
</p>

<ul>
<li><p> based on their measurements: TB = [umol/kg] = 10.838 * S + 13.821
</p>
</li>
<li><p> based on Kremling (1970 and 1972): TB [umol/kg] = 11.44 * S + 12.6; R2 = 0.95
</p>
</li>
<li><p> consensus regression (Kremling + their data): TB [umol/kg] = 11.405 * S + 11.869; R2 = 0.97s
</p>
</li></ul>

<p>The latter formulation is used here.
</p>


<h3>Value</h3>

<table>
<tr><td><code>bor</code></td>
<td>
<p>total boron concentration (<code class="reqn">mol\ kg^{-1}</code>))</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Heloise Lavigne, Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>DOE 1994 <em>Handbook of methods for the analysis of the various parameters of the carbon dioxide system in sea water</em>. ORNL/CDIAC-74. Oak Ridge,Tenn.: Carbon Dioxide Information Analysis Center, Oak Ridge National Laboratory.
</p>
<p>Kulinski K., Szymczycha B., Koziorowska K., Hammer K. &amp; Schneider B., 2018. Anomaly of total boron concentration in the brackish waters of the Baltic Sea and its consequence for the CO2 system calculations. <em>Marine Chemistry</em>. doi:s10.1016/j.marchem.2018.05.007.
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantic oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bor(35, "l10")
</code></pre>

<hr>
<h2 id='buffer'>Buffer parameters of the seawater carbonate system</h2><span id='topic+buffer'></span>

<h3>Description</h3>

<p>Returns buffer parameters of the seawater carbonate system.</p>


<h3>Usage</h3>

<pre><code class='language-R'>buffer(flag, var1, var2, S = 35, T = 25, Patm = 1, P = 0, Pt = 0, Sit = 0, 
  k1k2 = "x", kf = "x", ks = "d", pHscale = "T", b = "u74", warn = "y", 
  eos = "eos80", long = 1e+20, lat = 1e+20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="buffer_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="buffer_+3A_var1">var1</code></td>
<td>
<p>enter value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="buffer_+3A_var2">var2</code></td>
<td>
<p>enter value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="buffer_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="buffer_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="buffer_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm</p>
</td></tr>
<tr><td><code id="buffer_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="buffer_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="buffer_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="buffer_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="buffer_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="buffer_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickon (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="buffer_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="buffer_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="buffer_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for constants; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
<tr><td><code id="buffer_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="buffer_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="buffer_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>PhiD</code></td>
<td>
<p>PhiD, chemical buffer factor (dpH/d[DIC]); input/output of dissolved CO2 (unit pH per mol/kg)</p>
</td></tr>
<tr><td><code>BetaD</code></td>
<td>
<p>BetaD, homogeneous or Revelle buffer factor (dln(pCO2)/dln[DIC]); input/output of dissolved CO2</p>
</td></tr>
<tr><td><code>PiD</code></td>
<td>
<p>PiD, chemical buffer factor (dpCO2/d[DIC]); input/output of dissolved CO2 (<code class="reqn">\mu atm</code> per mol/kg)</p>
</td></tr>
<tr><td><code>PhiB</code></td>
<td>
<p>PhiB, chemical buffer factor (dpH/d[DIC]); from input/output of bicarbonate (unit pH per mol/kg)</p>
</td></tr>
<tr><td><code>BetaB</code></td>
<td>
<p>BetaB, homogeneous buffer factor (dln(pCO2)/dln[DIC]); input/output of bicarbonate</p>
</td></tr>
<tr><td><code>PiB</code></td>
<td>
<p>PiB, chemical buffer factor (dpCO2/d[DIC]); input/output of dissolved CO2 (<code class="reqn">\mu atm</code> per mol/kg)</p>
</td></tr>
<tr><td><code>PhiC</code></td>
<td>
<p>PhiC, chemical buffer factor (dpH/d[DIC]); input/output of carbonate (unit pH per mol/kg)</p>
</td></tr>
<tr><td><code>BetaC</code></td>
<td>
<p>BetaC, homogeneous buffer factor (dln(pCO2)/dln[DIC]); input/output of carbonate</p>
</td></tr>
<tr><td><code>PiC</code></td>
<td>
<p>PiC, chemical buffer factor (dpCO2/d[DIC]); input/output of carbonate (<code class="reqn">\mu atm</code> per mol/kg)</p>
</td></tr>
<tr><td><code>PhiH</code></td>
<td>
<p>PhiH, chemical buffer factor (dpH/d[ALK]); input/output of strong acid (unit pH per mol/kg)</p>
</td></tr>
<tr><td><code>PiH</code></td>
<td>
<p>PiH, chemical buffer factor (dpCO2/d[ALK]); input/output of strong acid (<code class="reqn">\mu atm</code> per mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Heloise Lavigne, Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
</p>
<p>Frankignoulle M., 1994 A complete set of buffer factors for acid/base CO2 system in seawater. <em>Journal of Marine Systems</em> <b>5</b>, 111-118.
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006 Dissociation constants of carbonic acid in seawateras a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.  
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Computation with a couple of variables
buffer(flag=8, var1=8.2, var2=0.00234, S=35, T=25, Patm=1, P=0, Pt=0, 
	Sit=0, pHscale="T", kf="pf", k1k2="l", b="u74")

## Using vectors as arguments
flag &lt;- c(8, 2, 8)
var1 &lt;- c(8.2, 7.477544e-06, 8.2)
var2 &lt;- c(0.002343955, 0.001649802, 2400e-6)
S &lt;- c(35, 35, 30)
T &lt;- c(25, 25, 30)
P &lt;- c(0, 0, 0)
Pt &lt;- c(0, 0, 0)
Sit &lt;- c(0, 0, 0)
kf &lt;- c("pf", "pf", "pf")
k1k2 &lt;- c("l", "l", "l")
pHscale &lt;- c("T", "T", "T")
b &lt;- c("l10", "l10", "l10")
buffer(flag=flag, var1=var1, var2=var2, S=S, T=T, P=P, Pt=Pt, 
	Sit=Sit, kf=kf, k1k2=k1k2, pHscale=pHscale, b=b)


## Test for all flags 

flag &lt;- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 21, 22, 23, 24, 25)

var1 &lt;- c(8.200000, 7.477544e-06, 7.477544e-06, 7.477544e-06, 7.477544e-06, 8.2, 
	8.2, 8.2, 8.2, 0.001685024, 0.001685024, 0.001685024,  0.0002888382, 
	0.0002888382, 0.002391252, 264.2008, 264.2008, 264.2008, 264.2008, 264.2008)

var2 &lt;- c(7.477544e-06, 0.001685024, 0.0002888382, 0.002391252, 0.001981340, 
	0.001685024, 0.0002888382, 0.002391252, 0.001981340, 0.0002888382, 0.002391252,
	0.001981340,  0.002391252, 0.001981340, 0.001981340, 8.2, 0.001685024, 
	0.0002888382, 0.002391252, 0.001981340)

buffer(flag=flag, var1=var1, var2=var2)

</code></pre>

<hr>
<h2 id='buffergen'>Buffer factors of the seawater carbonate system as defined by Hagens and 
Middelburg (2016)</h2><span id='topic+buffergen'></span>

<h3>Description</h3>

<p>Returns the suite of buffer factors presented in Table 3 of Hagens and Middelburg 
(2016), as well as the proton concentration buffer factor (beta.H of Hofmann et al, 2010) and 
the classic Revelle factor. For practical purposes, this function excludes the nitrate and 
nitrite acid-base systems presented in this paper, as well as the fully protonoted form of 
sulfate (H2SO4) and fully deprotonated form of sulfide (S2-), as their contributions to total 
alkalinity under natural seawater conditions are negligible. Its input arguments are 
identical to those in the carbfull function of seacarb.</p>


<h3>Usage</h3>

<pre><code class='language-R'>buffergen(flag, var1, var2, S=35, T=25, Patm=1, P=0, Pt=0, Sit=0, k1k2="x", kf="x",
                 ks="d", pHscale="T", b="u74", gas="potential", NH4t=0, HSt=0)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="buffergen_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="buffergen_+3A_var1">var1</code></td>
<td>
<p>Value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="buffergen_+3A_var2">var2</code></td>
<td>
<p>Value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="buffergen_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="buffergen_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="buffergen_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="buffergen_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="buffergen_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="buffergen_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="buffergen_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="buffergen_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="buffergen_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickson (1990) and &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="buffergen_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="buffergen_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="buffergen_+3A_gas">gas</code></td>
<td>
<p>used to indicate the convention for INPUT pCO2, i.e., when it is an input variable (flags 21 to 25): &quot;insitu&quot; indicates it is referenced to in situ pressure and in situ temperature; &quot;potential&quot; indicates it is referenced to 1 atm pressure and potential temperature; and &quot;standard&quot; indicates it is referenced to 1 atm pressure and in situ temperature. All three options should give identical results at surface pressure. This option is not used when pCO2 is not an input variable (flags 1 to 15). The default is &quot;potential&quot; and should be a unique value..</p>
</td></tr>
<tr><td><code id="buffergen_+3A_nh4t">NH4t</code></td>
<td>
<p>Concentration of total ammonium in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="buffergen_+3A_hst">HSt</code></td>
<td>
<p>Concentration of total hydrogen sulfide in mol/kg; set to 0 if NA</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs, Ksi and K2si, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, the pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>



<h3>Value</h3>

<p>The function returns a list containing the following matrices:
</p>
<table>
<tr><td><code>Carbfull</code></td>
<td>
<p>Output of the carbfull function that is used within buffergen</p>
</td></tr>
<tr><td><code>dALK.dH</code></td>
<td>
<p>Sensitivity of ALK to a change in proton concentration (dimensionless). Species-specific.</p>
</td></tr>
<tr><td><code>dtotX.dH</code></td>
<td>
<p>Sensitivity of an acid-base species to a change in proton concentration (dimensionless). Species-specific.</p>
</td></tr>
<tr><td><code>dALK.dX</code></td>
<td>
<p>Sensitivity of ALK to a change in an acid-base species (dimensionless). Species-specific.</p>
</td></tr>
<tr><td><code>dtotX.dX</code></td>
<td>
<p>Sensitivity of an acid-base species to a change in its total concentration (dimensionless). Species-specific.</p>
</td></tr>
<tr><td><code>dALK.dpH</code></td>
<td>
<p>Sensitivity of ALK to a change in pH (mol/kg-soln). Species-specific.</p>
</td></tr>
<tr><td><code>dtotX.dpH</code></td>
<td>
<p>Sensitivity of an acid-species to a change in pH (mol/kg-soln). Species-specific.</p>
</td></tr>
<tr><td><code>dH.dALK</code></td>
<td>
<p>Sensitivity of proton concentration to a change in ALK (dimensionless). Values are the same for all species and all acid-base systems, except for the fluoride and sulfate acid-base systems, which slightly deviate due to pH scale conversion effects.</p>
</td></tr>
<tr><td><code>dH.dtotX</code></td>
<td>
<p>Sensitivity of an acid-species to a change in its total concentration (dimensionless). Values are the same for all species of a specific acid-base system.</p>
</td></tr>
<tr><td><code>dX.dALK</code></td>
<td>
<p>Sensitivity of an acid-species to a change in its total concentration (dimensionless). Species-specific.</p>
</td></tr>
<tr><td><code>dX.dtotX</code></td>
<td>
<p>Sensitivity of an acid-species to a change in its total concentration (dimensionless). Species-specific.</p>
</td></tr>
<tr><td><code>dpH.dALK</code></td>
<td>
<p>Sensitivity of pH due to a change in ALK ((mol/kg-soln)-1). Values are the same for all species and all acid-base systems, except for the fluoride and sulfate acid-base systems, which slightly deviate due to pH scale conversion effects.</p>
</td></tr>
<tr><td><code>dpH.dtotX</code></td>
<td>
<p>Sensitivity of pH due to a change in the total concentration of an acid-base system ((mol/kg-soln)-1). Values are the same for all species of a specific acid-base system.</p>
</td></tr>
<tr><td><code>beta.H</code></td>
<td>
<p>proton concentration buffer factor (Eq.4 of Hagens and Middelburg (2016), dimensionless)</p>
</td></tr>   
<tr><td><code>RF</code></td>
<td>
<p>Revelle factor (dimensionless)</p>
</td></tr>
</table>
<p>If the total concentration of an acid-base system is 0, the values of the buffer factors corresponding to all species of that acid-base system return NA.
</p>


<h3>Author(s)</h3>

<p>Mathilde Hagens <a href="mailto:m.hagens@uu.nl">m.hagens@uu.nl</a>
</p>


<h3>References</h3>

<p>Hagens M. and Middelburg J. J., 2016 Generalised expressions for the response of pH to changes in ocean chemistry. <em>Geochimica et Cosmochimica Acta</em> <b>187</b> 334-349.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## With a couple of variables
buffergen(flag=8, var1=8.2, var2=0.00234, S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0,
	pHscale="T", kf="pf", k1k2="l", ks="d", b="u74", gas="potential", NH4t=0, HSt=0)

## With a couple of variables and non-zero nutrient concentrations
buffergen(flag=8, var1=8.2, var2=0.00234, S=35, T=25, P=0, Patm=1.0, Pt=5e-6, Sit=2e-6,
	pHscale="T", kf="pf", k1k2="l", ks="d", b="u74", gas="potential", NH4t=10e-6, HSt=0.1e-6)

## Using vectors as arguments
flag &lt;- c(8, 2, 8)
var1 &lt;- c(8.2, 7.477544e-06, 8.2)
var2 &lt;- c(0.002343955, 0.001649802, 2400e-6)
S &lt;- c(35, 35, 30)
T &lt;- c(25, 25, 30)
P &lt;- c(0, 0, 0)
Pt &lt;- c(0, 0, 0)
Sit &lt;- c(0, 0, 0)
kf &lt;- c("pf", "pf", "pf")
k1k2 &lt;- c("l", "l", "l")
pHscale &lt;- c("T", "T", "T")
b &lt;- c("l10", "l10", "l10")
gas &lt;- c("potential")
NH4t &lt;- c(0, 0, 0)
HSt &lt;- c(0, 0, 0)
buffergen(flag=flag, var1=var1, var2=var2, S=S, T=T, P=P, Pt=Pt, Sit=Sit, 
  kf=kf, k1k2=k1k2, pHscale=pHscale, b=b, gas=gas, NH4t=NH4t, HSt=HSt)

## Test with all flags 
flag &lt;- c((1:15), (21:25))
var1 &lt;- c(8.200000, 7.308171e-06, 7.308171e-06, 7.308171e-06, 7.308171e-06, 
	8.2, 8.2, 8.2, 8.2, 0.001646857, 0.001646857, 0.001646857, 0.0002822957, 
	0.0002822957, 0.00234, 258.2164, 258.2164, 258.2164, 258.2164, 258.2164 )
var2 &lt;- c(7.308171e-06, 0.001646857, 0.0002822957, 0.00234, 0.001936461, 
	0.001646857, 0.0002822957, 0.00234, 0.001936461, 0.0002822957, 
	0.00234, 0.001936461,  0.00234, 0.001936461, 0.001936461, 8.2, 
	0.001646857, 0.0002822957, 0.00234, 0.001936461)
buffergen(flag=flag, var1=var1, var2=var2)
</code></pre>

<hr>
<h2 id='buffesm'>Buffer capacities of the seawater carbonate system from Egleston et al. (2010), corrected and enhanced</h2><span id='topic+buffesm'></span>

<h3>Description</h3>

<p>Returns the six buffer factors of the seawater carbonate system as defined by Egleston, Sabine and Morel (2010), denoted here as ESM. Also returns the classic Revelle factor (relative change in pCO2 over that for DIC). In ESM, there are errors in the equations in Table 1 for <code class="reqn">S</code>, <code class="reqn">\Omega_{DIC}</code>, and <code class="reqn">\Omega_{Alk}</code>. These errors have been corrected here.  The results of this routine have been validated: when input concentrations of Pt and Sit are set to zero, they produce results that are identical to those shown in ESM's Fig. 2. But when Pt and Sit are nonzero, contributions from phosphoric and silicic acid systems are taken into account, an improvement to the Egleston et al. (2010) approach. This routine was inspired and adapted from seacarb's &ldquo;buffer&rdquo; function. Its input arguments are indentical to those in the &ldquo;buffer&rdquo; and &ldquo;carb&rdquo; functions of seacarb.</p>


<h3>Usage</h3>

<pre><code class='language-R'>buffesm(flag, var1, var2, S = 35, T = 25, Patm = 1, P = 0, Pt = 0, Sit = 0, 
  k1k2 = "x", kf = "x", ks = "d", pHscale = "T", b = "u74", warn = "y", 
  eos = "eos80", long = 1e+20, lat = 1e+20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="buffesm_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="buffesm_+3A_var1">var1</code></td>
<td>
<p>enter value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="buffesm_+3A_var2">var2</code></td>
<td>
<p>enter value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="buffesm_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="buffesm_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="buffesm_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default 1 atm</p>
</td></tr>
<tr><td><code id="buffesm_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="buffesm_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg; set to 0 if NA; when nonzero, account for phosphoric acid system, unlike in Egleston et al. (2010).</p>
</td></tr>
<tr><td><code id="buffesm_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg; set to 0 if NA; when nonzero, account for silicic acid system, unlike in Egleston et al. (2010).</p>
</td></tr>
<tr><td><code id="buffesm_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="buffesm_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="buffesm_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickon (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="buffesm_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="buffesm_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="buffesm_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for constants; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
<tr><td><code id="buffesm_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="buffesm_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="buffesm_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For K0:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>gammaDIC</code></td>
<td>
<p><code class="reqn">\gamma_{DIC}</code>, ocean's capacity to buffer changes in [CO2] due to accumulation of CO2 from the atmosphere <code class="reqn">(\partial ln[CO_2]/\partial DIC)^{-1}</code>  (units = mol/kg; multiply by 1000 to get mmol/kg, i.e., the units presented in Egleston et al., 2010)</p>
</td></tr>
<tr><td><code>betaDIC</code></td>
<td>
<p><code class="reqn">\beta_{DIC}</code>,  ocean's capacity to buffer changes in [H+] due to accumulation of CO2 from the atmosphere <code class="reqn">(\partial ln[H^+]/\partial DIC)^{-1}</code> (units = mol/kg)</p>
</td></tr>
<tr><td><code>omegaDIC</code></td>
<td>
<p><code class="reqn">\Omega_{DIC}</code>, ocean's capacity to buffer changes in <code class="reqn">[CO_3^{2-}]</code> due to accumulation of CO2 from the atmosphere <code class="reqn">(\partial ln[CO_3^{2-}]/\partial DIC)^{-1}</code>; same as <code class="reqn">(\partial ln \Omega_A / \partial DIC)^{-1}</code> and <code class="reqn">(\partial ln \Omega_C / \partial DIC)^{-1}</code> (units= mol/kg) </p>
</td></tr>
<tr><td><code>gammaALK</code></td>
<td>
<p><code class="reqn">\gamma_{Alk}</code>, ocean's capacity to buffer changes in [CO2] due to changes in alkalinity <code class="reqn">(\partial ln[CO_2]/\partial ALK)^-1</code>  (units = mol/kg)</p>
</td></tr>
<tr><td><code>betaALK</code></td>
<td>
<p><code class="reqn">\beta_{Alk}</code>,  ocean's capacity to buffer changes in [H+] due to changes in alkalinity <code class="reqn">(\partial ln[H^+]/\partial ALK)^{-1}</code> (units = mol/kg)</p>
</td></tr>
<tr><td><code>omegaALK</code></td>
<td>
<p><code class="reqn">\Omega_{Alk}</code>, ocean's capacity to buffer changes in <code class="reqn">[CO_3^{2-}]</code> due to changes in alkalinity <code class="reqn">(\partial ln[CO_3^{2-}]/\partial ALK)^{-1}</code>; same as <code class="reqn">(\partial ln \Omega_A / \partial ALK)^{-1}</code> and <code class="reqn">(\partial ln \Omega_C / \partial ALK)^{-1}</code> (units = mol/kg)</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Revelle factor, relative change in <code class="reqn">[CO_2]</code> or <code class="reqn">pCO_2</code> over the relative change in DIC <code class="reqn">(\partial ln[CO_2]/\partial ln DIC)^{-1}</code>  (unitless)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James Orr <a href="mailto:James.Orr@lsce.ipsl.fr">James.Orr@lsce.ipsl.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Egleston, E. S., Sabine, C. L. and Morel, F. M. M.,  2010 Revelle revisited: Buffer factors that quantify the response of ocean chemistry to changes in DIC and alkalinity, Global Biogeochem. Cycles <b>24</b>, GB1002, doi:10.1029/2008GB003407. 
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of hydrogen ion concentration in seawater from 5 to 40oC: standard potentials at salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
</p>
<p>Frankignoulle M., 1994 A complete set of buffer factors for acid/base CO2 system in seawater. <em>Journal of Marine Systems</em> <b>5</b>, 111-118.
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006 Dissociation constants of carbonic acid in seawateras a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.  
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Computation with a couple of variables
buffesm(flag=8, var1=8.2, var2=0.00234, S=35, T=25, P=0, Pt=0, 
	Sit=0, pHscale="T", kf="pf", k1k2="l", b="u74")

## Using vectors as arguments
flag &lt;- c(8, 2, 8)
var1 &lt;- c(8.2, 7.477544e-06, 8.2)
var2 &lt;- c(0.002343955, 0.001649802, 2400e-6)
S &lt;- c(35, 35, 30)
T &lt;- c(25, 25, 30)
P &lt;- c(0, 0, 0)
Pt &lt;- c(0, 0, 0)
Sit &lt;- c(0, 0, 0)
kf &lt;- c("pf", "pf", "pf")
k1k2 &lt;- c("l", "l", "l")
pHscale &lt;- c("T", "T", "T")
b &lt;- c("l10", "l10", "l10")
buffesm(flag=flag, var1=var1, var2=var2, S=S, T=T, P=P, Pt=Pt, 
	Sit=Sit, kf=kf, k1k2=k1k2, pHscale=pHscale, b=b)

## Test for all flags 
flag &lt;- c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 21, 22, 23, 24, 25)

var1 &lt;- c(8.200000, 7.477544e-06, 7.477544e-06, 7.477544e-06, 7.477544e-06, 8.2, 
	8.2, 8.2, 8.2, 0.001685024, 0.001685024, 0.001685024,  0.0002888382, 
	0.0002888382, 0.002391252, 264.2008, 264.2008, 264.2008, 264.2008, 264.2008)
var2 &lt;- c(7.477544e-06, 0.001685024, 0.0002888382, 0.002391252, 0.001981340, 
	0.001685024, 0.0002888382, 0.002391252, 0.001981340, 0.0002888382, 0.002391252,
	0.001981340,  0.002391252, 0.001981340, 0.001981340, 8.2, 0.001685024, 
	0.0002888382, 0.002391252, 0.001981340)
buffesm(flag=flag, var1=var1, var2=var2)

## Compute 2 additional factors of interest (ratios of relative changes)
be &lt;- buffesm(flag=flag, var1=var1, var2=var2, S=S, T=T, P=P, Pt=Pt, 
	Sit=Sit, kf=kf, k1k2=k1k2, pHscale=pHscale, b=b)
#     Ratio of gammaDIC/betaDIC = d ln [H+] / d ln pCO2
      Hfac &lt;- (be$gammaDIC/be$betaDIC)                         #H+ factor
#     Ratio of gammaDIC/omegaDIC = d ln [CO32-] / d ln pCO2
      Satfac &lt;- (be$gammaDIC/be$omegaDIC)                      #Saturation factor

</code></pre>

<hr>
<h2 id='carb'>Parameters of the seawater carbonate system</h2><span id='topic+carb'></span>

<h3>Description</h3>

<p>Returns parameters of the seawater carbonate system.</p>


<h3>Usage</h3>

<pre><code class='language-R'>carb(flag, var1, var2, S=35, T=25, Patm=1, P=0, Pt=0, Sit=0,
        k1k2="x", kf="x", ks="d", pHscale="T", b="u74", gas="potential", 
        warn="y", eos="eos80", long=1.e20, lat=1.e20)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="carb_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="carb_+3A_var1">var1</code></td>
<td>
<p>Value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="carb_+3A_var2">var2</code></td>
<td>
<p>Value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="carb_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="carb_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="carb_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="carb_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="carb_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="carb_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="carb_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="carb_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="carb_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickson (1990) and &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="carb_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="carb_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="carb_+3A_gas">gas</code></td>
<td>
<p>used to indicate the convention for INPUT pCO2, i.e., when it is an input variable (flags 21 to 25): &quot;insitu&quot; indicates it is referenced to in situ pressure and in situ temperature; &quot;potential&quot; indicates it is referenced to 1 atm pressure and potential temperature; and &quot;standard&quot; indicates it is referenced to 1 atm pressure and in situ temperature. All three options should give identical results at surface pressure. This option is not used when pCO2 is not an input variable (flags 1 to 15). The default is &quot;potential&quot;.</p>
</td></tr>
<tr><td><code id="carb_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for constants; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
<tr><td><code id="carb_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="carb_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="carb_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code>Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Hydrostatic pressure in bar</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>CO2 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>&quot;standard&quot; pCO2, CO2 partial pressure computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>&quot;standard&quot; fCO2, CO2 fugacity computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2pot</code></td>
<td>
<p>&quot;potential&quot; pCO2, CO2 partial pressure computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2pot</code></td>
<td>
<p>&quot;potential&quot; fCO2, CO2 fugacity computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; pCO2, CO2 partial pressure computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; fCO2, CO2 fugacity computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>HCO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>CO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>DIC concentration (mol/kg)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>Omega calcite, calcite saturation state</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>Heloise Lavigne, James Orr and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G. and Riley J. P., 1979 The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base. I. The ionic product of water. <em>Marine Chemistry</em> <b>7</b>, 89-99.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen ion concentration in seawater from 5 to 40oC: standard potentials at salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34.
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 1995. Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010. Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b>, 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Marine Chemistry <b>165</b>, 66-67.
</p>
<p>Weiss, R. F., 1974. Carbon dioxide in water and seawater: the solubility of a non-ideal gas, <em>Mar.  Chem.</em>, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A., 1980. Nitrous oxide solubility in water and seawater, <em>Marine Chemistry</em>, <b>8</b>, 347-359.
</p>
<p>Zeebe R. E. and Wolf-Gladrow D. A., 2001 <em>CO2 in seawater: equilibrium, kinetics, isotopes</em>. Amsterdam: Elsevier, 346 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## 1. With a couple of variables
carb(flag=8, var1=8.2, var2=0.00234, S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0,
	pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")

## 2. Using vectors as arguments
flag &lt;- c(8, 2, 8)
var1 &lt;- c(8.2, 7.477544e-06, 8.2)
var2 &lt;- c(0.002343955, 0.001649802, 2400e-6)
S &lt;- c(35, 35, 30)
T &lt;- c(25, 25, 30)
P &lt;- c(0, 0, 0)
Pt &lt;- c(0, 0, 0)
Sit &lt;- c(0, 0, 0)
kf &lt;- c("pf", "pf", "pf")
k1k2 &lt;- c("l", "l", "l")
pHscale &lt;- c("T", "T", "T")
b &lt;- c("l10", "l10", "l10")
carb(flag=flag, var1=var1, var2=var2, S=S, T=T, P=P,
	Pt=Pt, Sit=Sit, kf=kf, k1k2=k1k2, pHscale=pHscale, b=b)

## 3. Special case: when input pH is on NBS scale (not a standard option in seacarb) 
##    -&gt; example for pH-Alk input pair (flag 8) and Cai &amp; Wang (1998) K1,K2 
pHNBS &lt;- c(8.2, 8.1, 8.0)
talk &lt;- c(2300, 2350, 2400) * 1e-6
S &lt;- c(35, 32.5, 30)
T &lt;- c(25, 15, 10)

## 3a. convert pHNBS to pHSWS (using total activity coeff. fH), then use carb with pHscale="SWS"
pHSWS &lt;- pHnbs2sws(pHNBS, S=S, T=T)
carb(flag=8, var1=pHSWS, var2=talk, S=S, T=T, P=0, Patm=1.0, Pt=0, Sit=0,
	pHscale="SWS", kf="pf", k1k2="cw", ks="d", b="u74")

## 3b. conversely for input pairs without pH,  convert computed pH on SWS scale to NBS scale, 
##     with function pHsws2nbs
##    -&gt; example for Alk-DIC input pair (flag 15) and Cai &amp; Wang (1998) K1,K2 
dic &lt;- c(2000., 2030., 2060) * 1e-6
output = carb(flag=15, var1=talk, var2=dic, S=S, T=T, P=0, Patm=1.0, Pt=0, Sit=0,
	pHscale="SWS", kf="pf", k1k2="cw", ks="d", b="u74")
pHNBS  = pHsws2nbs(output$pH, S=S, T=T)

## 4. Test with all flags 
flag &lt;- c((1:15), (21:25))
var1 &lt;- c(8.200000, 7.308171e-06, 7.308171e-06, 7.308171e-06, 7.308171e-06, 
	8.2, 8.2, 8.2, 8.2, 0.001646857, 0.001646857, 0.001646857, 0.0002822957, 
	0.0002822957, 0.00234, 258.2164, 258.2164, 258.2164, 258.2164, 258.2164 )
var2 &lt;- c(7.308171e-06, 0.001646857, 0.0002822957, 0.00234, 0.001936461, 
	0.001646857, 0.0002822957, 0.00234, 0.001936461, 0.0002822957, 
	0.00234, 0.001936461,  0.00234, 0.001936461, 0.001936461, 8.2, 
	0.001646857, 0.0002822957, 0.00234, 0.001936461)
carb(flag=flag, var1=var1, var2=var2)

## 5. Test using a data frame 
data(seacarb_test_P0)	#test data set for P=0 (surface)
tab &lt;- seacarb_test_P0[14:19,]

## 5a. method 1 using the column numbers
carb(flag=tab[[1]], var1=tab[[2]], var2=tab[[3]], S=tab[[4]], T=tab[[5]], 
P=tab[[6]], Sit=tab[[8]], Pt=tab[[7]])

## 5b. method 2 using the column names
carb(flag=tab$flag, var1=tab$var1, var2=tab$var2, S=tab$S, T=tab$T, 
P=tab$P, Sit=tab$Sit, Pt=tab$Pt)

</code></pre>

<hr>
<h2 id='carbb'>Parameters of the seawater carbonate system with boron addition</h2><span id='topic+carbb'></span>

<h3>Description</h3>

<p>Returns parameters of the seawater carbonate system when boron is added.</p>


<h3>Usage</h3>

<pre><code class='language-R'>carbb(flag, var1, var2, S=35, T=25, Patm=1, P=0, Pt=0, Sit=0, 
  k1k2="x", kf="x", ks="d", pHscale="T", b="u74", gas="potential", badd=0, 
  warn="y", eos = "eos80", long = 1e+20, lat = 1e+20)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="carbb_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="carbb_+3A_var1">var1</code></td>
<td>
<p>Value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="carbb_+3A_var2">var2</code></td>
<td>
<p>Value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="carbb_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="carbb_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="carbb_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="carbb_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="carbb_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="carbb_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="carbb_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="carbb_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="carbb_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickson (1990) and &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="carbb_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="carbb_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="carbb_+3A_gas">gas</code></td>
<td>
<p>used to indicate the convention for INPUT pCO2, i.e., when it is an input variable (flags 21 to 25): &quot;insitu&quot; indicates it is referenced to in situ pressure and in situ temperature; &quot;potential&quot; indicates it is referenced to 1 atm pressure and potential temperature; and &quot;standard&quot; indicates it is referenced to 1 atm pressure and in situ temperature. All three options should give identical results at surface pressure. This option is not used when pCO2 is not an input variable (flags 1 to 15). The default is &quot;potential&quot;.</p>
</td></tr>
<tr><td><code id="carbb_+3A_badd">badd</code></td>
<td>
<p>Amount of boron added in mol/kg.</p>
</td></tr>
<tr><td><code id="carbb_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for constants; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
<tr><td><code id="carbb_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="carbb_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="carbb_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code>Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Hydrostatic pressure in bar</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>CO2 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>&quot;standard&quot; pCO2, CO2 partial pressure computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>&quot;standard&quot; fCO2, CO2 fugacity computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2pot</code></td>
<td>
<p>&quot;potential&quot; pCO2, CO2 partial pressure computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2pot</code></td>
<td>
<p>&quot;potential&quot; fCO2, CO2 fugacity computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; pCO2, CO2 partial pressure computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; fCO2, CO2 fugacity computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>HCO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>CO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>DIC concentration (mol/kg)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>Omega calcite, calcite saturation state</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>Heloise Lavigne, James Orr and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G. and Riley J. P., 1979 The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base. I. The ionic product of water. <em>Marine Chemistry</em> <b>7</b>, 89-99.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen ion concentration in seawater from 5 to 40oC: standard potentials at salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 1995. Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010. Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Weiss, R. F., 1974. Carbon dioxide in water and seawater: the solubility of
a non-ideal gas, <em>Mar.  Chem.</em>, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A., 1980. Nitrous oxide solubility in water and
seawater, <em>Marine Chemistry</em>, <b>8</b>, 347-359.
</p>
<p>Zeebe R. E. and Wolf-Gladrow D. A., 2001 <em>CO2 in seawater: equilibrium, kinetics, isotopes</em>. Amsterdam: Elsevier, 346 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## With a couple of variables
carbb(flag=8, var1=8.2, var2=0.00234, S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0,
	pHscale="T", kf="pf", k1k2="l", ks="d", b="u74", badd=0)

</code></pre>

<hr>
<h2 id='carbfull'>Parameters of the seawater carbonate system - extension of carb</h2><span id='topic+carbfull'></span>

<h3>Description</h3>

<p>Returns parameters of the seawater carbonate system, including the ammonium and 
sulfide acid-base systems, as well as full acid-base speciation</p>


<h3>Usage</h3>

<pre><code class='language-R'>carbfull(flag, var1, var2, S=35, T=25, Patm=1, P=0, Pt=0, Sit=0,
        k1k2="x", kf="x", ks="d", pHscale="T", b="u74", gas="potential",
        NH4t=0, HSt=0)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="carbfull_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="carbfull_+3A_var1">var1</code></td>
<td>
<p>Value of the first variable in mol/kg-soln, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="carbfull_+3A_var2">var2</code></td>
<td>
<p>Value of the second variable in mol/kg-soln, except for pH</p>
</td></tr>
<tr><td><code id="carbfull_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="carbfull_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="carbfull_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="carbfull_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="carbfull_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg-soln; set to 0 if NA</p>
</td></tr>
<tr><td><code id="carbfull_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg-soln; set to 0 if NA</p>
</td></tr>
<tr><td><code id="carbfull_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="carbfull_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="carbfull_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickson (1990) and &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="carbfull_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="carbfull_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="carbfull_+3A_gas">gas</code></td>
<td>
<p>used to indicate the convention for INPUT pCO2, i.e., when it is an input variable (flags 21 to 25): &quot;insitu&quot; indicates it is referenced to in situ pressure and in situ temperature; &quot;potential&quot; indicates it is referenced to 1 atm pressure and potential temperature; and &quot;standard&quot; indicates it is referenced to 1 atm pressure and in situ temperature. All three options should give identical results at surface pressure. This option is not used when pCO2 is not an input variable (flags 1 to 15). The default is &quot;potential&quot;.</p>
</td></tr>
<tr><td><code id="carbfull_+3A_nh4t">NH4t</code></td>
<td>
<p>Concentration of total ammonium in mol/kg-soln; set to 0 if NA</p>
</td></tr>
<tr><td><code id="carbfull_+3A_hst">HSt</code></td>
<td>
<p>Concentration of total hydrogen sulfide in mol/kg-soln; set to 0 if NA</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs, Ksi and K2si, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, the pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>



<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code>Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Hydrostatic pressure in bar</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>CO2 concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>&quot;standard&quot; pCO2, CO2 partial pressure computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>&quot;standard&quot; fCO2, CO2 fugacity computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2pot</code></td>
<td>
<p>&quot;potential&quot; pCO2, CO2 partial pressure computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2pot</code></td>
<td>
<p>&quot;potential&quot; fCO2, CO2 fugacity computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; pCO2, CO2 partial pressure computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; fCO2, CO2 fugacity computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>HCO3 concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>CO3 concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>DIC concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg-soln)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>Omega calcite, calcite saturation state</p>
</td></tr>
<tr><td><code>NH4</code></td>
<td>
<p>NH4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>NH3</code></td>
<td>
<p>NH3 concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>BOH3</code></td>
<td>
<p>B(OH)3 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>BOH4</code></td>
<td>
<p>B(OH)4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>H3PO4</code></td>
<td>
<p>H3PO4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>H2PO4</code></td>
<td>
<p>H2PO4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>HPO4</code></td>
<td>
<p>HPO4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>PO4</code></td>
<td>
<p>PO4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>H2S</code></td>
<td>
<p>H2S concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>HS</code></td>
<td>
<p>HS concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>SiOH4</code></td>
<td>
<p>SiOH4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>SiOOH3</code></td>
<td>
<p>SiOOH3 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>SiO2OH2</code></td>
<td>
<p>SiO2OH2 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>HF</code></td>
<td>
<p>HF concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>F</code></td>
<td>
<p>F concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>HSO4</code></td>
<td>
<p>HSO4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>SO4</code></td>
<td>
<p>SO4 concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>H concentration at specified pH scale (mol/kg-soln)</p>
</td></tr>
<tr><td><code>OH</code></td>
<td>
<p>OH concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>NH4t</code></td>
<td>
<p>Supplied NHt concentration (mol/kg-soln); values are recycled if necessary</p>
</td></tr> 
<tr><td><code>BOR</code></td>
<td>
<p>Calculated total borate concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>Pt</code></td>
<td>
<p>Supplied Pt concentration (mol/kg-soln); values are recycled if necessary</p>
</td></tr> 
<tr><td><code>HSt</code></td>
<td>
<p>Supplied HSt concentration (mol/kg-soln); values are recycled if necessary</p>
</td></tr>  
<tr><td><code>Sit</code></td>
<td>
<p>Supplied Sit concentration (mol/kg-soln); values are recycled if necessary</p>
</td></tr> 
<tr><td><code>FLUO</code></td>
<td>
<p>Calculated total fluoride concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>ST</code></td>
<td>
<p>Calculated total sulfate concentration (mol/kg-soln)</p>
</td></tr> 
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2014)</p>


<h3>Author(s)</h3>

<p>Heloise Lavigne, James Orr, Mathilde Hagens and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G. and Riley J. P., 1979 The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base. I. The ionic product of water. <em>Marine Chemistry</em> <b>7</b>, 89-99.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>22</b>, vol49 29-34. 
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 1995. Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010. Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2014. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences Discussions</em> <b>11</b>, 5327-5397.
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Mar. Chem. 165, 66-67.
</p>
<p>Weiss, R. F., 1974. Carbon dioxide in water and seawater: the solubility of a non-ideal gas, <em>Mar.  Chem.</em>, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A., 1980. Nitrous oxide solubility in water and seawater, <em>Mar. Chem.</em>, <b>8</b>, 347-359.
</p>
<p>Zeebe R. E. and Wolf-Gladrow D. A., 2001 <em>CO2 in seawater: equilibrium, kinetics, isotopes</em>. Amsterdam: Elsevier, 346 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## With a couple of variables
carbfull(flag=8, var1=8.2, var2=0.00234, S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0,
	pHscale="T", kf="pf", k1k2="l", ks="d", b="u74", gas="potential", NH4t=0, HSt=0)

## With a couple of variables and non-zero nutrient concentrations
carbfull(flag=8, var1=8.2, var2=0.00234, S=35, T=25, P=0, Patm=1.0, Pt=5e-6, Sit=2e-6,
	pHscale="T", kf="pf", k1k2="l", ks="d", b="u74", gas="potential", NH4t=10e-6, HSt=0.1e-6)

## Using vectors as arguments
flag &lt;- c(8, 2, 8)
var1 &lt;- c(8.2, 7.477544e-06, 8.2)
var2 &lt;- c(0.002343955, 0.001649802, 2400e-6)
S &lt;- c(35, 35, 30)
T &lt;- c(25, 25, 30)
P &lt;- c(0, 0, 0)
Pt &lt;- c(0, 0, 0)
Sit &lt;- c(0, 0, 0)
kf &lt;- c("pf", "pf", "pf")
k1k2 &lt;- c("l", "l", "l")
pHscale &lt;- c("T", "T", "T")
b &lt;- c("l10", "l10", "l10")
gas &lt;- c("potential", "potential", "potential")
NH4t &lt;- c(0, 0, 0)
HSt &lt;- c(0, 0, 0)
carbfull(flag=flag, var1=var1, var2=var2, S=S, T=T, P=P, Pt=Pt, Sit=Sit, 
  kf=kf, k1k2=k1k2, pHscale=pHscale, b=b, gas=gas, NH4t=NH4t, HSt=HSt)

## Test with all flags 
flag &lt;- c((1:15), (21:25))
var1 &lt;- c(8.200000, 7.308171e-06, 7.308171e-06, 7.308171e-06, 7.308171e-06, 
	8.2, 8.2, 8.2, 8.2, 0.001646857, 0.001646857, 0.001646857, 0.0002822957, 
	0.0002822957, 0.00234, 258.2164, 258.2164, 258.2164, 258.2164, 258.2164 )
var2 &lt;- c(7.308171e-06, 0.001646857, 0.0002822957, 0.00234, 0.001936461, 
	0.001646857, 0.0002822957, 0.00234, 0.001936461, 0.0002822957, 
	0.00234, 0.001936461,  0.00234, 0.001936461, 0.001936461, 8.2, 
	0.001646857, 0.0002822957, 0.00234, 0.001936461)
carbfull(flag=flag, var1=var1, var2=var2)
</code></pre>

<hr>
<h2 id='d2p'>Converts depth in meters to pressure in dbar</h2><span id='topic+d2p'></span>

<h3>Description</h3>

<p>Converts depth in meters to pressure in dbar</p>


<h3>Usage</h3>

<pre><code class='language-R'>d2p(depth, lat=40)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d2p_+3A_depth">depth</code></td>
<td>
<p>Depth in meters</p>
</td></tr>
<tr><td><code id="d2p_+3A_lat">lat</code></td>
<td>
<p>Latitude in degrees, N and S is irrelevant, default is 40o</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>pressure</code></td>
<td>
<p>Pressure corresponding to the depth given, in dbar</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Heloise Lavigne and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Saunders P. M., 1981. Practical conversion of pressure to depth. <em>J. Phys. Oceanogr.</em> <b>11</b>: 573-574.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+p2d">p2d</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d2p(depth=7500, lat=30)  
</code></pre>

<hr>
<h2 id='derivnum'>Numerical derivatives of seawater carbonate system variables</h2><span id='topic+derivnum'></span>

<h3>Description</h3>

<p>Returns numerical derivatives of the seawater carbonate system output variables with respect to input variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>derivnum(varid, flag, var1, var2, S=35, T=25, Patm=1, P=0, Pt=0, Sit=0,
       k1k2="x", kf="x", ks="d", pHscale="T", b="u74", gas="potential", warn="y", 
       eos = "eos80", long = 1e+20, lat = 1e+20)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="derivnum_+3A_varid">varid</code></td>
<td>
<p>Variable length, case insensitive, character identificator of variable with respect to which derivatives are requested.
Possible values are:
</p>
<p>'1' or 'var1'  :  Variable 1 of the input pair (This is TAlk if flag is 15)
</p>
<p>'2' or 'var2'  :  Variable 2 of the input pair (This is DIC  if flag is 15)
</p>
<p>'sil', 'silt', 'tsil' or 'silicate'      : Total silicate concentration
</p>
<p>'phos', 'phost', 'tphos' or 'phosphate'  : Total phosphate concentration
</p>
<p>'t', 'temp' or 'temperature' : temperature
</p>
<p>'s', 'sal' or 'salinity'     : salinity
</p>
<p>'K0','K1','K2','Kb','Kw','Kspa' or 'Kspc' : one of the dissociation constants
</p>
<p>'bor' : total boron
</p>
</td></tr>
<tr><td><code id="derivnum_+3A_flag">flag</code></td>
<td>
<p>select the input pair of carbonate-system variables
available by choosing the following flag:
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="derivnum_+3A_var1">var1</code></td>
<td>
<p>Value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="derivnum_+3A_var2">var2</code></td>
<td>
<p>Value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="derivnum_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="derivnum_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="derivnum_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="derivnum_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="derivnum_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="derivnum_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="derivnum_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="derivnum_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="derivnum_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickson (1990) and &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr>
<tr><td><code id="derivnum_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="derivnum_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="derivnum_+3A_gas">gas</code></td>
<td>
<p>used to indicate the convention for INPUT pCO2, i.e., when it is an input variable (flags 21 to 25): &quot;insitu&quot; indicates it is referenced to in situ pressure and in situ temperature; &quot;potential&quot; indicates it is referenced to 1 atm pressure and potential temperature; and &quot;standard&quot; indicates it is referenced to 1 atm pressure and in situ temperature. All three options should give identical results at surface pressure. This option is not used when pCO2 is not an input variable (flags 1 to 15). The default is &quot;potential&quot;.</p>
</td></tr>
<tr><td><code id="derivnum_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for constants; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
<tr><td><code id="derivnum_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="derivnum_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="derivnum_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This subroutine has same input parameters as subroutine carb(). For details on these parameters,
refer to documentation of 'carb'.
</p>
<p>This subroutine computes partial derivatives of each output variable with respect to
each of the input variable (including each of the two chosen carbonate system
variables, each of the nutrients (total silicon and total phosphorus), temperature,
and salinity.
</p>
<p>It computes these derivatives (dy/dx) using the method of central differences, i.e.,
</p>

<ul>
<li><p> for dx, it adds a positive and negative perturbation, same and equal in magnitude, to each input variable, one at a time, and
</p>
</li>
<li><p> for dy, it then computes the corresponding induced change in output variables
</p>
</li></ul>

<p>All arguments but the first (varid), can be given as scalers or vectors. If the
lengths of the vectors differs, only the longest vector is retained and the other
arguments are set equal to the first value of the other vectors are used. Hence users
should use either vectors with the same dimension or one vector for one argument and
scalars for others; otherwise, results may not be as intended.
</p>
<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>H</code></td>
<td>
<p>derivative of [H+] concentration  (mol/kg/...)</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>derivative of pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>derivative of CO2 concentration (mol/kg/...)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>&quot;standard&quot; pCO2, CO2 partial pressure computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm/...)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>&quot;standard&quot; fCO2, CO2 fugacity computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm/...)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>derivative of HCO3 concentration (mol/kg/...)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>derivative of CO3 concentration (mol/kg/...)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>derivative of DIC concentration (mol/kg/...)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>derivative of ALK, total alkalinity (mol/kg/...)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>derivative of Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>derivative of Omega calcite, calcite saturation state</p>
</td></tr>
</table>
<p>If all input data have the same 'flag' value, returned data frame does not show
derivatives of input pair of carbonate system variables. For example, if all input
flags are 15, the input pair is DIC and ALK; hence, derivatives of DIC and ALK are
not returned.
</p>
<p>Units of derivative dy/dx is unit(y)/unit(x) where unit(x) are as follows:
</p>
<table>
<tr><td><code>degree C</code></td>
<td>
<p>when x is Temperature</p>
</td></tr>
<tr><td><code>psu</code></td>
<td>
<p>when x is Salinity</p>
</td></tr>
<tr><td><code>uatm</code></td>
<td>
<p>when x is pCO2</p>
</td></tr>
<tr><td><code>mol/kg</code></td>
<td>
<p>for all other cases</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon, James Orr, and Jean-Pierre Gattuso<a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G. and Riley J. P., 1979 The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base. I. The ionic product of water. <em>Marine Chemistry</em> <b>7</b>, 89-99.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>22</b>, vol49 29-34.
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 1995. Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010. Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], <em>Marine  Chemistry</em>, <b>165</b>, 66-67.
</p>
<p>Weiss, R. F., 1974. Carbon dioxide in water and seawater: the solubility of a non-ideal gas, <em>Marine  Chemistry</em>, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A., 1980. Nitrous oxide solubility in water and seawater, <em>Marine  Chemistry</em>, <b>8</b>, 347-359.
</p>
<p>Zeebe R. E. and Wolf-Gladrow D. A., 2001 <em>CO2 in seawater: equilibrium, kinetics, isotopes</em>. Amsterdam: Elsevier, 346 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## 1) For the input pair ALK and DIC (var1 and var2 when flag=15)
##    compute derivatives of all output varialbes 
##    with respect to DIC (i.e., var2)
derivnum(varid='var2', flag=15, var1=2300e-6, var2=2000e-6, 
         S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0,
         pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")

## 2) For the input pair pH and ALK (var1 and var2 when flag=8)
##    compute derivatives of all output variables 
##    with respect to [H+] concentration
derivnum(varid='var1', flag=8, var1=8.2, var2=0.00234, 
         S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0,
         pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")

## 3) Using vectors as arguments and compute derivatives of all output 
##    variables with respect to temperature
flag &lt;- c(8, 2, 8)
var1 &lt;- c(8.2, 7.477544e-06, 8.2)
var2 &lt;- c(0.002343955, 0.001649802, 2400e-6)
S &lt;- c(35, 35, 30)
T &lt;- c(25, 25, 30)
P &lt;- c(0, 0, 0)
Pt &lt;- c(0, 0, 0)
Sit &lt;- c(0, 0, 0)
kf &lt;- c("pf", "pf", "pf")
k1k2 &lt;- c("l", "l", "l")
pHscale &lt;- c("T", "T", "T")
b &lt;- c("u74", "u74", "u74")
derivnum(varid='T', flag=flag, var1=var1, var2=var2, S=S, T=T, P=P,
         Pt=Pt, Sit=Sit, kf=kf, k1k2=k1k2, pHscale=pHscale, b=b)

# For more examples of use of derivnum.R,
# consult the code of seacarb's errors routine.
</code></pre>

<hr>
<h2 id='eos2teos_chem'>Convert temperature and salinity from EOS-80 to TEOS-10</h2><span id='topic+eos2teos_chem'></span>

<h3>Description</h3>

<p>Converts in situ temperature to conservative temperature and practical to absolute salinity (SA). Salinity conversion depends on total alkalinity as well as the concentrations of dissolved inorganic carbon, nitrate and silicate.</p>


<h3>Usage</h3>

<pre><code class='language-R'>eos2teos_chem(SP, T, P=0, TA=2300e-6, DIC=2000e-6, NO3=0, SIOH4=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eos2teos_chem_+3A_sp">SP</code></td>
<td>
<p>Practical salinity on the practical salinity scale</p>
</td></tr>
<tr><td><code id="eos2teos_chem_+3A_t">T</code></td>
<td>
<p>In situ temperature in deg. C</p>
</td></tr>
<tr><td><code id="eos2teos_chem_+3A_p">P</code></td>
<td>
<p>Sea water pressure in dbar</p>
</td></tr>
<tr><td><code id="eos2teos_chem_+3A_ta">TA</code></td>
<td>
<p>Total alkalinity, in mol/kg, default is 2300 √Ç¬µmol/kg</p>
</td></tr>
<tr><td><code id="eos2teos_chem_+3A_dic">DIC</code></td>
<td>
<p>Dissolved inorganic carbon concentration in mol/kg, default is 2000 √Ç¬µmol/kg</p>
</td></tr>
<tr><td><code id="eos2teos_chem_+3A_no3">NO3</code></td>
<td>
<p>Total nitrate concentration in mol/kg, default is 0</p>
</td></tr>
<tr><td><code id="eos2teos_chem_+3A_sioh4">SIOH4</code></td>
<td>
<p>Total silicate concentration in mol/kg, default is 0</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Conversion from practical to absolute salinity depends on carbonate system parameters and ion concentration which mostly affect water density anomalies.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>CT</code></td>
<td>
<p>Conservative temperature (deg C)</p>
</td></tr>
<tr><td><code>SA</code></td>
<td>
<p>Absolute salinity (g/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon
</p>


<h3>References</h3>

<p>McDougall T. J., Jackett D. R., Millero F. J., Pawlowicz R. and Barker P. M., 2012. A global algorithm for estimating Absolute Salinity. <em>Ocean Science</em> <b>8</b>, 1123-1134.
</p>
<p>Pawlowicz R., Wright D. G. and Millero F. J., 2011. The effects of biogeochemical processes on oceanic conductivity/salinity/density relationships and the characterization of real seawater. <em>Ocean Science</em> <b>7</b>, 363-387.
</p>
<p>Pawlowicz R., 2013. What every oceanographer needs to know about TEOS-10 (The TEOS-10 Primer). http://www.teos-10.org/
</p>


<h3>See Also</h3>

<p>teos2eos_chem does the reverse, eos2teos_geo, sp2sa_chem
</p>
<p>package gsw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Calculate Conservative Temperature and Absolute Salinity of a sample with 
   # Practical salinity of 35 psu, in-situ temperature of 18 deg C,
   # at 0 dbar and total alkalinity of 0.00234 mol/kg and DIC of 0.00202 mol/kg
   f &lt;- eos2teos_chem(SP=35, T=18, P=0, TA=0.00234, DIC=0.00202)
   CT &lt;- f$CT     # Conservative Temperature
   SA &lt;- f$SA     # Absolute Salinity
</code></pre>

<hr>
<h2 id='eos2teos_geo'>Convert temperature and salinity from EOS-80 to TEOS-10</h2><span id='topic+eos2teos_geo'></span>

<h3>Description</h3>

<p>Converts in situ to conservative temperature and practical to absolute salinity (SA). Salinity conversion depends on depth and geographic location. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eos2teos_geo(SP, T, P=0, long=1.e20, lat=1.e20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eos2teos_geo_+3A_sp">SP</code></td>
<td>
<p>Practical salinity on the practical salinity scale</p>
</td></tr>
<tr><td><code id="eos2teos_geo_+3A_t">T</code></td>
<td>
<p>In situ temperature in deg. C</p>
</td></tr>
<tr><td><code id="eos2teos_geo_+3A_p">P</code></td>
<td>
<p>Sea water pressure in dbar</p>
</td></tr>
<tr><td><code id="eos2teos_geo_+3A_long">long</code></td>
<td>
<p>Longitude in decimal degrees [ 0 ... +360 ] or  [ -180 ... +180 ]</p>
</td></tr>
<tr><td><code id="eos2teos_geo_+3A_lat">lat</code></td>
<td>
<p>Latitude in decimal degrees [-90 ... 90]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Conversion from practical to absolute salinity depends on water density anomaly which is correlated with silicate concentration. This function relies on silicate concentration taken from WOA (World Ocean Atlas) to evaluate density anomaly.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>CT</code></td>
<td>
<p>Conservative temperature (deg C)</p>
</td></tr>
<tr><td><code>SA</code></td>
<td>
<p>Absolute salinity (g/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon
</p>


<h3>References</h3>

<p>McDougall T. J., Jackett D. R., Millero F. J., Pawlowicz R. and Barker P. M., 2012. A global algorithm for estimating Absolute Salinity. <em>Ocean Science</em> <b>8</b>, 1123-1134.
</p>
<p>Pawlowicz R., 2013. What every oceanographer needs to know about TEOS-10 (The TEOS-10 Primer). http://www.teos-10.org/
</p>


<h3>See Also</h3>

<p>teos2eos_geo does the reverse, eos2teos_chem, sp2sa_geo, package gsw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Calculate conservative temperature and absolute salinity of a sample with 
   # Practical salinity of 35 psu, in situ temperature of 18 deg C,
   # depth is 10 dbar and location is 188 degrees East and 4 degrees North.
   f &lt;- eos2teos_geo(SP=35, T=18, P=10, long=188, lat=4)
   CT &lt;- f$CT     # Conservative temperature
   SA &lt;- f$SA     # Absolute salinity
</code></pre>

<hr>
<h2 id='errors'>Uncertainty propagation for computed marine carbonate system variables</h2><span id='topic+errors'></span>

<h3>Description</h3>

<p>Estimates combined standard uncertainties in computed carbonate system variables by propagating inout uncertainties (standard uncertainties) in six input variables, including (Orr et al., Mar. Chem., in press):
</p>

<ul>
<li><p> the input pair of carbonate system variables, 
</p>
</li>
<li><p> the 2 input nutrients (silicate and phosphate concentrations),
</p>
</li>
<li><p> temperature and salinity. It also accounts for
</p>
</li>
<li><p> the errors in the key dissociation constants pK0, pK1, pK2, pKb, pKw, pKspa and pKspc
</p>
</li>
<li><p> the error in total boron
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>errors(flag, var1, var2, S=35, T=25, Patm=1, P=0, Pt=0, Sit=0, 
              evar1=0, evar2=0, eS=0.01, eT=0.01, ePt=0, eSit=0, 
              epK=c(0.002, 0.0075, 0.015, 0.01, 0.01, 0.02, 0.02),
              eBt=0.02, method = "ga", r=0.0, runs=10000,
              k1k2='x', kf='x', ks="d", pHscale="T", b="u74", gas="potential", 
              warn="y", eos = "eos80", long = 1e+20, lat = 1e+20)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="errors_+3A_flag">flag</code></td>
<td>
<p>select the pair of carbonate system input variables. The flags to be used are as follows:
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="errors_+3A_var1">var1</code></td>
<td>
<p>Value of the first variable (in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code id="errors_+3A_var2">var2</code></td>
<td>
<p>Value of the second variable (in mol/kg, except for pH)</p>
</td></tr>
<tr><td><code id="errors_+3A_s">S</code></td>
<td>
<p>Salinity (practical salinity scale)</p>
</td></tr>
<tr><td><code id="errors_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="errors_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="errors_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="errors_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total dissolved inorganic phosphorus (mol/kg); set to 0 if NA</p>
</td></tr>
<tr><td><code id="errors_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total dissolved inorganic silicon (mol/kg); set to 0 if NA</p>
</td></tr>
<tr><td><code id="errors_+3A_evar1">evar1</code></td>
<td>
<p>Standard uncertainty in var1 of input pair of carbonate system variables</p>
</td></tr>
<tr><td><code id="errors_+3A_evar2">evar2</code></td>
<td>
<p>Standard uncertainty in var2 of input pair of carbonate system variables</p>
</td></tr>
<tr><td><code id="errors_+3A_es">eS</code></td>
<td>
<p>Standard uncertainty in salinity; default is 0.01</p>
</td></tr>
<tr><td><code id="errors_+3A_et">eT</code></td>
<td>
<p>Standard uncertainty in temperature (degree C); default is 0.01</p>
</td></tr>
<tr><td><code id="errors_+3A_ept">ePt</code></td>
<td>
<p>Standard uncertainty in total dissolved inorganic phosphorus concentration (mol/kg)</p>
</td></tr>
<tr><td><code id="errors_+3A_esit">eSit</code></td>
<td>
<p>Standard uncertainty in total dissolved inorganic silicon concentration (mol/kg)</p>
</td></tr>
<tr><td><code id="errors_+3A_epk">epK</code></td>
<td>
<p>Standard uncertainty) in 7 key dissociation constants: pK0, pK1, pK2, pKb, pKw, pKspa and pKspc. This is a vector. The default is c(0.002, 0.0075, 0.015, 0.01, 0.01, 0.02, 0.02).</p>
</td></tr>
<tr><td><code id="errors_+3A_ebt">eBt</code></td>
<td>
<p>Standard uncertainty in total boron, given as a
relative fractional error. The default is 0.02, which equates to a 2% error</p>
</td></tr>
<tr><td><code id="errors_+3A_method">method</code></td>
<td>
<p>Case insensitive character string to choose the error-propagation method: 1) Gaussian, 
2) Method of Moments, or 3) Monte Carlo).<br />
These methods are specified using the 2-letter codes &quot;ga&quot;, &quot;mo&quot;, or &quot;mc&quot;, respectively. The default is &quot;ga&quot; (Gaussian).</p>
</td></tr>
<tr><td><code id="errors_+3A_r">r</code></td>
<td>
<p>Correlation coefficient between standard uncertainties of var1 and var2 (only useful with method=&quot;mo&quot;,
i.e., ignored for the 2 other methods, the default is r=0.0</p>
</td></tr>
<tr><td><code id="errors_+3A_runs">runs</code></td>
<td>
<p>Number of random samples (ignored unless method=&quot;mc&quot;; the default is runs=10000</p>
</td></tr>
<tr><td><code id="errors_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="errors_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="errors_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickson (1990) and &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr>
<tr><td><code id="errors_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="errors_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="errors_+3A_gas">gas</code></td>
<td>
<p>used to indicate the convention for INPUT pCO2, i.e., when it is an input variable (flags 21 to 25): &quot;insitu&quot; indicates it is referenced to in situ pressure and in situ temperature; &quot;potential&quot; indicates it is referenced to 1 atm pressure and potential temperature; and &quot;standard&quot; indicates it is referenced to 1 atm pressure and in situ temperature. All three options should give identical results at surface pressure. This option is not used when pCO2 is not an input variable (flags 1 to 15). The default is &quot;potential&quot;.</p>
</td></tr>
<tr><td><code id="errors_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for constants; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
<tr><td><code id="errors_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="errors_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="errors_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Complete information on routine uncertainty propagation for the marine carbon dioxide system can be found in Orr et al. (in press). This function requires users to specify each input standard uncertainty as either the standard deviation or the standard error of the mean. The latter implies much smaller propagated uncertainties, but is appropriate only when interested in the error in the mean, not the error of a given measurement. Beware that it is easy to fool oneself when using the standard error of the mean rather than the standard deviation.
</p>
<p>This function requires different types of standard uncertainties:
</p>

<ul>
<li><p> Standard uncertainties for evar1, evar2, eS, eT, ePt, eSit (same units as the input data, e.g., mol/kg);
</p>
</li>
<li><p> Standard uncertainties in pK units for epK; and
</p>
</li>
<li><p> Standard uncertainties in relative fractional units (between 0.0 and 1.0) for eBt.
</p>
</li></ul>

<p>This function propagates standard uncertainty from input to output variables using one of three methods: 
</p>

<ul>
<li><p> Gaussian:
The Gaussian method is the standard technique for estimating a
computed variable's (z) second moment (its variance or standard
deviation) based on a first-order approximation to z.  More
precisely, we use here the basic 1st order, 2nd moment
uncertainty analysis (a type of Taylor expansion), assuming no
covariance between input variables.  This is the approach used by
Dickson and Riley (1978). It is the default method.
</p>
</li>
<li><p> Method of moments: The method of moments is a more general form
of the Gaussian method. But in addition, it also accounts for
covariance between input variables.  In this case, the 'errors'
routine allows the user to specify a value of the correlation
coefficient 'r', having a value between -1.0 and 1.0, to indicate
the correlation between standard uncertainties of the input pair of
carbonate system variables. That correlation is used to compute
the covariance. But by default, it is assumed that there is no
covariance (r=0.0).
</p>
</li>
<li><p> Monte Carlo:
The Monte Carlo method is a brute-force approach relying on
repeated random sampling of input errors, adding those to each
input variables, calculating the corresponding output variables
for each sample, and finally assessing the standard deviation in
each output variables.
</p>
</li></ul>

<p>This function has many input parameters that are identical to those in the carb function. For their details, refer to the 'carb' documentation.
</p>
<p>All parameters may be scalars or vectors except epK, eBt, method, runs, and gas.
</p>

<ul>
<li><p> runs and eBt must be scalars
</p>
</li>
<li><p> method and gas must each consist of a character string
</p>
</li>
<li><p> epK may be a vector of 7 values. In that case, it must list errors for 
pK0, pK1, pK2, pKb, pKw, pKspa and pKspc, respectively.
That set of errors is identical for all input data.
Alternatively, users may specify 'epK=NULL' or 'epK=0' to set all 7 values to zero
and thus neglect errors in the equilibrium constants. 
</p>
</li></ul>

<p>In constrast, for evar1, evar2, r, eS, eT, ePt and eSit:
</p>

<ul>
<li><p>  if they are vectors, they represent standard uncertainties associated with each data point
</p>
</li>
<li><p>  if they are scalars (single real numbers), they represent one standard uncertainty value each associated to all data points
</p>
</li></ul>

<p>The same remark applies to parameter r (correlation coefficient).
</p>
<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a 2-dimensional dataframe, with the following columns:
</p>
<table>
<tr><td><code>H</code></td>
<td>
<p>combined standard uncertainty in [H+] concentration (mol/kg)</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>combined standard uncertainty in pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>combined standard uncertainty in CO2 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>combined standard uncertainty in &quot;standard&quot; pCO2, CO2 partial pressure computed at in situ temperature and atmospheric pressure (uatm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>combined standard uncertainty in &quot;standard&quot; fCO2, CO2 fugacity computed at in situ temperature and atmospheric pressure (uatm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>combined standard uncertainty in HCO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>combined standard uncertainty in CO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>combined standard uncertainty in DIC concentration (mol/kg)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>combined standard uncertainty in ALK, total alkalinity (mol/kg)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>combined standard uncertainty in Omega aragonite (aragonite saturation state)</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>combined standard uncertainty in Omega calcite   (calcite saturation state)</p>
</td></tr>
</table>
<p>If all input data have the same 'flag' value, the returned data frame does not show combined standard uncertainties on input pair of carbonate system variables. For example, if all input flags are 15, the input pair is DIC and ALK; hence, errors on DIC and ALK are not returned.
</p>


<h3>Correlation coefficient</h3>

<p>By default, 'r' is zero. However, for some pairs the user may want to specify a different value. For example, measurements of pCO2 and pH are often anti-correlated. The same goes for two other pairs: 'CO2 and CO3' and 'pCO2 and CO3'.  But even for these cases, care is needed before using non-zero values of 'r'.
</p>
<p>When the user wishes to propagate standard uncertainties for an individual measurement, 'r' should ALWAYS be zero if each member of the input pair is measured independently. In this case, we are interested in the correlation between the uncertainties in those measurements, not in the correlation between the measurements themselves. Uncertainties from those measurements are probably not correlated if they come from different instruments. Conversely, if users are interested in the error in the mean of a distribution of measurements (i.e., if they are propagating standard errors instead of standard deviations), one should then also account for the correlation between the measurements of the two variables of the input pair.
</p>
<p>For input pairs where one member is pH (flags 1, 6, 7, 8, 9, and 21), this 'errors' function automatically inverses the sign of 'r'. The reason for that is that the associated derivatives are computed in terms of the hydrogen ion concentration (H+), not pH. Therefore for each of these 6 flags, if the user wants to compute their own 'r' that should be done by (1) using the H+ concentration instead of pH, and (2) inversing the sign of that computed 'r' before passing it as an argument to this routine. Usually though (when not calculating r for pH), the user may just use the 'r' in the expected way.  For example, to include the covariance term when there is a perfect anticorrelation of pH with pCO2, one would use 'r=-1.0'.
</p>


<h3>Computation time</h3>

<p>Computation time depends on the method chosen; the Monte Carlo method takes much longer to execute. The computational time required for the Monte Carlo method is proportional to the number of runs. More runs, implies improved accuracy: runs = 10000 appears a minimum to obtain an accuracy of less than 1%. Accuracy is inversely proportional to the number of runs.
</p>
<p>Computation time also depends on the chosen pair of input variables. For example, with the input pair DIC and Total alkalinity (flag=15), it is much longer than for input pair pH and Total alkalinity (flag=8)
</p>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon, James Orr, and Jean-Pierre Gattuso<a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson, A. G. and Riley, J. P., 1978 The effect of analytical error on the evaluation of the components of the aquatic carbon-dioxide system, <em>Marine  Chemistry</em>, <b>6</b>, 77-85.
</p>
<p>Dickson A. G. and Riley J. P., 1979 The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base. I. The ionic product of water. <em>Marine Chemistry</em> <b>7</b>, 89-99.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of hydrogen ion concentration in seawater from 5 to 40oC: standard potentials at salinities from 20 to 45. <em>Analytical Chemistry</em> <b>22</b>, vol49 29-34.
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 1995. Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010. Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M., Dickson A. and Gattuso J.-P., in press. Routine uncertainty propagation for the marine carbon dioxide system. <em>Marine Chemistry</em>. 
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], <em>Marine  Chemistry</em>, <b>165</b>, 66-67.
</p>
<p>Weiss, R. F., 1974. Carbon dioxide in water and seawater: the solubility of a non-ideal gas, <em>Marine  Chemistry</em>, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A., 1980. Nitrous oxide solubility in water and seawater, <em>Marine  Chemistry</em>, <b>8</b>, 347-359.
</p>
<p>Zeebe R. E. and Wolf-Gladrow D. A., 2001 <em>CO2 in seawater: equilibrium, kinetics, isotopes</em>. Amsterdam: Elsevier, 346 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## 1) For the input pair ALK and DIC (var1 and var2 when flag=15),
## compute resulting uncertainty from given uncertainty on ALK and DIC (5 umol/kg)
## and default uncertainties in dissociation constants and total boron
## using the default method (Gaussian)
errors(flag=15, var1=2300e-6, var2=2000e-6, S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0, 
       evar1=5e-6, evar2=5e-6, eS=0, eT=0, ePt=0, eSit=0, 
       pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")
## Typical output:
## H             pH          CO2           fCO2      pCO2      HCO3          ...
## 3.721614e-10  0.01796767  5.441869e-07  19.25338  19.31504  9.170116e-06  ...

## 2) Do the same as in one, but assign a 4% uncertainty to total boron
##    This uncertainty is the amount by which estimates from Lee et al (2010) and 
##    Uppstrom (1974) differ. The default for the latter is eBt=0.02.
errors(flag=15, var1=2300e-6, var2=2000e-6, S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0, 
       evar1=5e-6, evar2=5e-6, eS=0, eT=0, ePt=0, eSit=0, eBt=0.04,
       pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")

## 3) For the input pair pH and ALK (var1 and var2 when flag=8)
## compute standard errors in output variables from errors in input variables, i.e., 
## for pH (0.005 pH units) and in ALK (5 umol/kg), along with
## errors in total dissolved inorganic phosphorus (0.1 umol/kg) and
## total dissolved inorganic silicon (2 umol/kg) concentrations, while
## assuming no uncertainty in dissociation constants &amp; boron, using the Gaussian method:
errors(flag=8, var1=8.25, var2=2300e-6,  S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0, 
       evar1=0.005, evar2=5e-6, eS=0, eT=0, ePt=0.1, eSit=2, epK=0, eBt=0,
       method="ga", pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")

## 4) For the input pair pCO2 and pH (var1 and var2 when flag=21)
## compute standard errors in output variables from errors in input variables, i.e., 
## for pCO2 (2 uatm) and pH (0.005 pH units), with no uncertainties in Pt and Sit
## nor in the dissociation constants BUT a perfect anticorrelation between pCO2 and pH,
## (the input pair) using the Method of moments:
errors(flag=21, var1=400, var2=8.1,  S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0, 
       evar1=2, evar2=0.005, eS=0, eT=0, ePt=0.0, eSit=0, epK=0, eBt=0, 
       method="mo", r=-1.0, pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")

## 5) Use vectors as arguments and compute errors on all output variables
## using Monte Carlo method taking into account input errors on pH, ALK, DIC
## and dissociation constants (pKx)
flag &lt;- c(8, 15)
var1 &lt;- c(8.2, 0.002394, 8.25)
var2 &lt;- c(0.002343955, 0.002017)
S &lt;- c(35, 35)
T &lt;- c(25, 25)
P &lt;- 0
Pt &lt;- 0
Sit &lt;- 0
evar1 &lt;- c(0.005, 2e-6)
evar2 &lt;- c(2e-6, 2e-6)
epKx &lt;- c(0.002, 0.01, 0.02, 0.01, 0.01, 0.01, 0.01)
eBtx = 0.01
method &lt;- "mc"
kf &lt;- "pf"
k1k2 &lt;- "l"
pHscale &lt;- "T"
b &lt;- "u74"
## NOTE that the following is executable but enclosed in "donttest" 
## because it takes too long to run when submiting to CRAN
## and is therefore rejected
errors(flag=flag, var1=var1, var2=var2, S=S, T=T, P=P, Pt=Pt, Sit=Sit, 
       evar1=evar1, evar2=evar2, eS=0, eT=0, ePt=0, eSit=0, epK=epKx, eBt=eBtx,
       method=method, runs=10000, kf=kf, k1k2=k1k2, pHscale=pHscale, b=b)
</code></pre>

<hr>
<h2 id='f2pCO2'>Converts the CO2 fugacity to CO2 partial pressure</h2><span id='topic+f2pCO2'></span>

<h3>Description</h3>

<p>Converts fCO2 (fugacity of CO2) into pCO2 (partial pressure in CO2)</p>


<h3>Usage</h3>

<pre><code class='language-R'>f2pCO2(T = 25, Patm=1, P=0, fCO2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f2pCO2_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="f2pCO2_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default 1 atm</p>
</td></tr>
<tr><td><code id="f2pCO2_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar, default is 0 bar (surface)</p>
</td></tr>
<tr><td><code id="f2pCO2_+3A_fco2">fCO2</code></td>
<td>
<p>Fugacity of CO2 in <code class="reqn">\mu</code>atm, the same units as that for the pCO2 output</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>pCO2</code></td>
<td>
<p>Partial pressure of CO2 in <code class="reqn">\mu</code>atm, the same units as that for the fCO2 input</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>Heloise Lavigne, Jean-Pierre Gattuso, and James Orr <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007. Guide to best
practices for ocean CO2 measurements. <em>PICES Special Publication</em>
<b>3</b>, 1-191.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Weiss, R. F. and Price, B. A., 1980. Nitrous oxide solubility in water and seawater, <em>Marine Chemistry</em>, <b>8</b>, 347-359, 1980.
</p>
<p>Weiss, R. F., 1974. Carbon dioxide in water and seawater: the solubility of a non-ideal gas, <em>Mar.  Chem.</em>, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A., 1980. Nitrous oxide solubility in water and seawater, <em>Marine Chemistry</em>, <b>8</b>, 347-359.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+p2fCO2">p2fCO2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f2pCO2(T=25, Patm=1.0, P=0, fCO2=380)  
</code></pre>

<hr>
<h2 id='fCO2insi'>fCO2 at in situ temperature</h2><span id='topic+fCO2insi'></span>

<h3>Description</h3>

<p>Correction to compensate for the difference in temperature between the temperature of measurement and in situ temperature.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fCO2insi(fCO2lab = 400, Tlab = 20, SST = 19)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fCO2insi_+3A_fco2lab">fCO2lab</code></td>
<td>
<p>Fugacity of CO2 measured in the lab in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="fCO2insi_+3A_tlab">Tlab</code></td>
<td>
<p>Temperaure of measurment in the lab in in degrees Celsius, default is 20oC</p>
</td></tr>
<tr><td><code id="fCO2insi_+3A_sst">SST</code></td>
<td>
<p>Temperature in degrees Celsius, default is 19oC</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fCO2insi</code></td>
<td>
<p>Fugacity of CO2 at in situ temperature in <code class="reqn">\mu</code>atm, the same units as that for the fCO2 input.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The empirical correction applied is from Takahashi (1993) as recommended by Pierrot et al. (2009)</p>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Pierrot D., Neill C., Sullivan K., Castle R., Wanninkhof R., L√É¬ºger H., Johannessen T., Olsen A., Feely R. A. and Cosca C. E., 2009. Recommendations for autonomous underway pCO2 measuring systems and data-reduction routines. <em>Deep-Sea Res. II</em> <b>56</b>, 512-522.
</p>
<p>Takahashi T., Olafsson J., Goddard J. G., Chipman D. W. and Sutherland S. C., 1993. Seasonal variation of CO2 and nutrients in the high-latitude surface oceans: a comparative study. <em>Glob. Biogeochem. Cycles</em> <b>7</b>, 843-878.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+f2pCO2">f2pCO2</a></code>, <code><a href="#topic+pCO2insi">pCO2insi</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fCO2insi(fCO2lab = 400, SST = 15, Tlab = 16)
</code></pre>

<hr>
<h2 id='fH'>Total activity coefficient for H+</h2><span id='topic+fH'></span>

<h3>Description</h3>

<p>Compute total hydrogen ion activity coefficient.
The activity coefficient (fH) is used to convert from H+ concentration on SWS scale 
to H+ activity (ah), as used for NBS scale; likewise fH is used to make the conversion 
in the opposite direction, from the NBS scale to the SWS scale. Here, fH is taken from 
Takahashi et al (1982, GEOSECS Pacific Expedition, Chap 3, p. 80) who say:
fH is the total activity coeff., which includes contributions from HSO4- 
and HF [as well as H+].
</p>
<p>Takahashi et al. (1982) computed a relationship for fH based on the experimental data
from Culberson &amp; Pytkowicz (1973), who determined it experimentally as a function
of temperature and salinity.  The approach is old and full of uncertainty.
Newer approaches are more complicated (Pitzer equations) 
and big uncertainties remain (Marion et al., 2011; Pilson, 2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fH(S=35, T=25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fH_+3A_s">S</code></td>
<td>
<p>Salinity on the practical salinity scale, default is 35</p>
</td></tr>
<tr><td><code id="fH_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This total activity coefficient appears in
the following basic chemistry equation: <code class="reqn"> ah = fH * hsws</code>, 
where  <code class="reqn">ah</code>  is the activity of hydrogen ion,
<code class="reqn">fH</code>  is the total activity coefficient, and
<code class="reqn">hsws = [H+] + [HSO4-] + [HF]</code>. In other words, 
<code class="reqn">hsws</code> is the total hydrogen ion conccentration on the seawater scale.
</p>
<p>The two pH scales of concern are defined as <code class="reqn">pHNBS = -log10(ah)</code> and 
<code class="reqn">pHSWS = -log10(hsws)</code>.  
</p>


<h3>Value</h3>

<table>
<tr><td><code>fH</code></td>
<td>
<p>Total activity coefficient for H+</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James Orr <a href="mailto:james.orr@lsce.ipsl.fr">james.orr@lsce.ipsl.fr</a>
</p>


<h3>References</h3>

<p>Culberson, C.H., &amp; Pytkowicz, R.M. (1973). Ionization of water in seawater. 
<em>Marine Chemistry</em>, <b>1(4)</b>, 309-316.
</p>
<p>Marion G.M., Millero F.J., Camoes M.F., Spitzer P., Feistel R., Chen C.T.A. 2011. pH of seawater. 
<em>Marine Chemistry</em> <b>126</b> 89-96.
</p>
<p>Pilson M.E.Q. (2013) An introduction to the chemistry of the sea, 
2 edn. Cambridge, UK: Cambridge University Press.
</p>
<p>Takahashi T., Williams R.T., and Ros D.L. (1982) Carbonate chemistry. 
GEOSECS Pacific Expedition, Volume 3, Hydrographic Data 1973-1974, 77-83.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pHnbs2sws">pHnbs2sws</a></code> and <code><a href="#topic+pHsws2nbs">pHsws2nbs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Compute fH
   f = fH(T=25, S=35)
   print(f)
## Check value: The result is 0.7134043
</code></pre>

<hr>
<h2 id='K0'>Henry's constant mol/(kg/atm)</h2><span id='topic+K0'></span>

<h3>Description</h3>

<p>Henry's constant mol/(kg/atm)</p>


<h3>Usage</h3>

<pre><code class='language-R'>K0(S=35, T=25, P=0, Patm=1, warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K0_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="K0_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="K0_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="K0_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="K0_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for K0; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formulation is only valid for specific ranges of temperature and salinity: 
</p>

<ul>
<li><p> S ranging between 0 and 45 and T ranging between -1 and 45oC.
</p>
</li></ul>

<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>
<p>For pressure corrections: the pressure correction term of Weiss (1974) is used.
</p>


<h3>Value</h3>

<table>
<tr><td><code>K0</code></td>
<td>
<p>Henry's constant mol/(kg/atm)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon, Aurelien Proye, and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Weiss R. F., 1974 Carbon dioxide in water and seawater: the solubility of a non-ideal gas. <em>Marine Chemistry</em> <b>2</b>, 203-215.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  K0(S=35,T=25,P=0)
</code></pre>

<hr>
<h2 id='K1'>First dissociation constant of carbonic acid (mol/kg)</h2><span id='topic+K1'></span>

<h3>Description</h3>

<p>First dissociation constant of carbonic acid (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>K1(S=35, T=25, P=0, k1k2="x", pHscale="T", kSWS2scale="x", ktotal2SWS_P0="x", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K1_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="K1_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="K1_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="K1_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="K1_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="K1_+3A_ksws2scale">kSWS2scale</code></td>
<td>
<p>Conversion factor from the seawater scale (SWS) to the pH scale selected at the hydrostatic pressure value indicated. It is not required for all formulations of K1 and K2, nor when the hydrostatic pressure is 0. It is advised to use default value &quot;x&quot;, in  which case it is computed when required.</p>
</td></tr>
<tr><td><code id="K1_+3A_ktotal2sws_p0">ktotal2SWS_P0</code></td>
<td>
<p>Conversion factor from the total scale to the SWS at an hydrostatic pressure of 0. It is not required for all formulations of K1 and K2. It is advised to use default value &quot;x&quot;, in  which case it is computed when required.</p>
</td></tr>
<tr><td><code id="K1_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for K1; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constant is recommended by Guide to Best Practices for Ocean CO2 Measurements (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): formulation is that of Waters et al (2014). See below.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length. 
</p>
<p>The pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).</p>


<h3>Value</h3>

<table>
<tr><td><code>K1</code></td>
<td>
<p>First dissociation constant of carbonic acid (mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>DOE 1994 <em>Handbook of methods for the analysis of the various parameters of the carbon dioxide system in sea water</em>. ORNL/CDIAC-74. Oak Ridge,Tenn.: Carbon Dioxide Information Analysis Center, Oak Ridge National Laboratory.
</p>
<p>Lueker T. J., Dickson A. G., and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., Pierrot D., Lee K., Wanninkhof R., Feely R., Sabine C. L., Key R. M. and Takahashi T., 2002. Dissociation constants for carbonic acid determined from field measurements. Deep Sea Research Part I: Oceanographic Research Papers <b>49</b>:1705-1723.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H., and Pierrot D., 2006 Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Mojica Prieto F. J. and Millero F. J., 2002. The values of pK1 + pK2 for the dissociation of carbonic acid in seawater. <em>Geochimica et Cosmochimica Acta</em> <b>66</b>, 2529-2540.
</p>
<p>Papadimitriou S., Loucaides S., R√É¬©rolle V. M. C., Kennedy P., Achterberg E. P., Dickson A. G., Mowlem M. and Kennedy H., 2018. The stoichiometric dissociation constants of carbonic acid in seawater brines from 298 to 267 K. <em>Geochimica et Cosmochimica Acta</em> <b>220</b>, 55-70.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>..
</p>
<p>Sulpis O., Lauvset S. K. and Hagens M., 2020. Current estimates of K1* and K2* appear inconsistent with measured CO2 system parameters in cold oceanic regions. <em>Ocean Science</em> <b>16</b>, 847-862.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], <em>Marine Chemistry</em> <b>165</b>, 66-67.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+K2">K2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  K1(S=35,T=25,P=0,k1k2="l",pHscale="T")
</code></pre>

<hr>
<h2 id='K1p'>First dissociation constant of phosphoric acid (mol/kg)</h2><span id='topic+K1p'></span>

<h3>Description</h3>

<p>First dissociation constant of phosphoric acid (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>K1p(S=35, T=25, P=0, pHscale="T", kSWS2scale="x", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K1p_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="K1p_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="K1p_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="K1p_+3A_phscale">pHscale</code></td>
<td>
<p>Choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="K1p_+3A_ksws2scale">kSWS2scale</code></td>
<td>
<p>Conversion factor from the seawater scale (SWS) to the pH scale selected at the hydrostatic pressure value indicated. It is advised to use default value &quot;x&quot;, in which case it is computed when required.</p>
</td></tr>
<tr><td><code id="K1p_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for K1p; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formulation is only valid for specific ranges of temperature and salinity: 
</p>

<ul>
<li><p> S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p>The pressure correction was applied on the seawater scale. Hence, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>K1p</code></td>
<td>
<p>First dissociation constant of phosphoric acid (mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon, Heloise Lavigne, Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.</p>


<h3>See Also</h3>

<p><code><a href="#topic+K2p">K2p</a></code>, <code><a href="#topic+K3p">K3p</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  K1p(35,25,0)
</code></pre>

<hr>
<h2 id='K2'>Second dissociation constant of carbonic acid (mol/kg)</h2><span id='topic+K2'></span>

<h3>Description</h3>

<p>Second dissociation constant of carbonic acid (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>K2(S=35, T=25, P=0, k1k2="x", pHscale="T", kSWS2scale="x", ktotal2SWS_P0="x", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K2_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="K2_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="K2_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="K2_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="K2_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="K2_+3A_ksws2scale">kSWS2scale</code></td>
<td>
<p>Conversion factor from the seawater scale (SWS) to the pH scale selected at the hydrostatic pressure value indicated. It is not required for all formulations of K1 and K2, nor when the hydrostatic pressure is 0. It is advised to use default value &quot;x&quot;, in which case it is computed when required.</p>
</td></tr>
<tr><td><code id="K2_+3A_ktotal2sws_p0">ktotal2SWS_P0</code></td>
<td>
<p>Conversion factor from the total scale to the SWS at an hydrostatic pressure of 0. It is not required for all formulations of K1 and K2. It is advised to use default value &quot;x&quot;, in which case it is computed when required.</p>
</td></tr>
<tr><td><code id="K2_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for K2; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constant is recommended by Guide to Best Practices for Ocean CO2 Measurements (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): S ranging from 19.6 to 41 and T ranging between 15 to 35oC.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length. 
</p>
<p>The pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).</p>


<h3>Value</h3>

<table>
<tr><td><code>K2</code></td>
<td>
<p>Second dissociation constant of carbonic acid (mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon, Heloise Lavigne, Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>The Lueker et al. (2000) constant is recommended by Guide to Best Practices for Ocean CO2 Measurements (2007). The Roy et al. (1993) constant is recommended by DOE (1994).
</p>
<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>DOE 1994 <em>Handbook of methods for the analysis of the various parameters of the carbon dioxide system in sea water</em>. ORNL/CDIAC-74. Oak Ridge,Tenn.: Carbon Dioxide Information Analysis Center, Oak Ridge National Laboratory.
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006 Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Mojica Prieto F. J. and Millero F. J., 2002. The values of pK1 + pK2 for the dissociation of carbonic acid in seawater. <em>Geochimica et Cosmochimica Acta</em> <b>66</b>, 2529-2540.
</p>
<p>Papadimitriou S., Loucaides S., R√É¬©rolle V. M. C., Kennedy P., Achterberg E. P., Dickson A. G., Mowlem M. and Kennedy H., 2018. The stoichiometric dissociation constants of carbonic acid in seawater brines from 298 to 267 K. <em>Geochimica et Cosmochimica Acta</em> <b>220</b>, 55-70.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>..
</p>
<p>Sulpis O., Lauvset S. K. and Hagens M., 2020. Current estimates of K1* and K2* appear inconsistent with measured CO2 system parameters in cold oceanic regions. <em>Ocean Science</em> <b>16</b>, 847-862.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], <em>Marine Chemistry</em> <b>165</b>, 66-67.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+K1">K1</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  K2(35,25,0)
</code></pre>

<hr>
<h2 id='K2p'>Second dissociation constant of phosphoric acid (mol/kg)</h2><span id='topic+K2p'></span>

<h3>Description</h3>

<p>Second dissociation constant of phosphoric acid (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>K2p(S=35, T=25, P=0, pHscale="T", kSWS2scale="x", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K2p_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="K2p_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="K2p_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="K2p_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="K2p_+3A_ksws2scale">kSWS2scale</code></td>
<td>
<p>Conversion factor from the seawater scale (SWS) to the pH scale selected at the hydrostatic pressure value indicated. It is advised to use default value &quot;x&quot;, in which case it is computed when required.</p>
</td></tr>
<tr><td><code id="K2p_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for K2p; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formulation is only valid for specific ranges of temperature and salinity: 
</p>

<ul>
<li><p> S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p>The pressure correction was applied on the seawater scale. Hence, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>K2p</code></td>
<td>
<p>Second dissociation constant of phosphoric acid (mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon, Heloise Lavigne, Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.</p>


<h3>See Also</h3>

<p><code><a href="#topic+K1p">K1p</a></code>, <code><a href="#topic+K3p">K3p</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  K2p(35,25,0)
</code></pre>

<hr>
<h2 id='K2si'>Second dissociation constant of Si(OH)4</h2><span id='topic+K2si'></span>

<h3>Description</h3>

<p>Second dissociation constant of Si(OH)4 (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>K2si(S=35, T=25, P=0, pHscale="T", kSWS2scale="x", ktotal2SWS_P0="x")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K2si_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="K2si_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="K2si_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="K2si_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="K2si_+3A_ksws2scale">kSWS2scale</code></td>
<td>
<p>Conversion factor from the seawater scale (SWS) to the pH scale selected at the hydrostatic pressure value indicated. It is advised to use default value &quot;x&quot;, in which case it is computed when required.</p>
</td></tr>
<tr><td><code id="K2si_+3A_ktotal2sws_p0">ktotal2SWS_P0</code></td>
<td>
<p>Conversion factor from the total scale to the SWS at an hydrostatic pressure of 0. It is advised to use default value &quot;x&quot;, in which case it is computed when required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This equation is modified from Wischmeyer et al. (2003), who fitted the temperature-dependent K2si from Nordstrom et al. (1990) for freshwater to a value of 12.56 for T=25 and an ionic strength of 0.5 mol/kg. The temperature and salinity ranges in which it is valid are not well constrained.
</p>
<p>The pressure correction is applied on the seawater scale. Hence, values are first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value is transformed back to the required scale (T, F or SWS).
</p>
<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>K2si</code></td>
<td>
<p>Second dissociation constant of Si(OH)4 (mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mathilde Hagens (<a href="mailto:M.Hagens@uu.nl">M.Hagens@uu.nl</a>)
</p>


<h3>References</h3>

<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Nordstrom D. K., L. N. Plummer, D. Langmuir, E. Busenberg, H. M. May, B. F. Jones, D. L. Parkhurst, 1990 Revised chemical equilibrium data from major mineral reactions and their limitations. In: Melchior, D.C., R. L. Bassett (Eds.) Chemical Modeling of Aqueous Systems. <em>IIACS Series</em> <b>416</b>. American Chemical Society, Washington, DC.
</p>
<p>Wischmeyer A. G., Y. Del Amo, M. Brzezinski, D. A. Wolf-Gladrow, 1995 Theoretical constraints on the uptake of silicic acid species by marine diatoms. <em>Marine Chemistry</em> <b>82</b>: 13-29.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  K2si(S=35, T=25, P=0, pHscale="T")
</code></pre>

<hr>
<h2 id='K3p'>Third dissociation constant of phosphoric acid (mol/kg)</h2><span id='topic+K3p'></span>

<h3>Description</h3>

<p>Third dissociation constant of phosphoric acid (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>K3p(S=35, T=25, P=0, pHscale="T", kSWS2scale="x", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K3p_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="K3p_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="K3p_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="K3p_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="K3p_+3A_ksws2scale">kSWS2scale</code></td>
<td>
<p>Conversion factor from the seawater scale (SWS) to the pH scale selected at the hydrostatic pressure value indicated. It is advised to use default value &quot;x&quot;, in which case it is computed when required.</p>
</td></tr>
<tr><td><code id="K3p_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for K3p; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formulation is only valid for specific ranges of temperature and salinity: 
</p>

<ul>
<li><p> S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p>The pressure correction was applied on the seawater scale. Hence, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>K3p</code></td>
<td>
<p>Third dissociation constant of phosphoric acid (mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon, Heloise Lavigne, Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.</p>


<h3>See Also</h3>

<p><code><a href="#topic+K1p">K1p</a></code>, <code><a href="#topic+K2p">K2p</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  K3p(35,25,0)
</code></pre>

<hr>
<h2 id='Kb'>Dissociation constant of boric acid (mol/kg)</h2><span id='topic+Kb'></span>

<h3>Description</h3>

<p>Dissociation constant of boric acid (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kb(S=35, T=25, P=0, pHscale="T", kSWS2scale="x", ktotal2SWS_P0="x", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kb_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="Kb_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="Kb_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="Kb_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="Kb_+3A_ksws2scale">kSWS2scale</code></td>
<td>
<p>Conversion factor from the seawater scale (SWS) to the pH scale selected at the hydrostatic pressure value indicated. It is advised to use default value &quot;x&quot;, in which case it is computed when required.</p>
</td></tr>
<tr><td><code id="Kb_+3A_ktotal2sws_p0">ktotal2SWS_P0</code></td>
<td>
<p>Conversion factor from the total scale to the SWS at an hydrostatic pressure of 0. It is advised to use default value &quot;x&quot;, in which case it is computed when required.</p>
</td></tr>
<tr><td><code id="Kb_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for Kb; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formulation is only valid for specific ranges of temperature and salinity: 
</p>

<ul>
<li><p> S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p>The pressure correction is applied on the seawater scale. Hence, values are first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value transformed back to the required scale (T, F or SWS).
</p>
<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Kb</code></td>
<td>
<p>Dissociation constant of boric acid (mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon, Heloise Lavigne, Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., 1990 Thermodynamics of the dissociation of boric acid in synthetic seawater from 273.15 to 318.15 K. <em>Deep-Sea Research</em> <b>375</b>, 755-766.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>DOE 1994 <em>Handbook of methods for the analysis of the various parameters of the carbon dioxide system in sea water</em>. ORNL/CDIAC-74. Oak Ridge,Tenn.: Carbon Dioxide Information Analysis Center, Oak Ridge National Laboratory.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Kb(S=35,T=25,P=0,pHscale="T")
</code></pre>

<hr>
<h2 id='kconv'>Conversion factors to change the pH scale of dissociation constants</h2><span id='topic+kconv'></span>

<h3>Description</h3>

<p>Conversion factors from the total scale to the free and seawater scales</p>


<h3>Usage</h3>

<pre><code class='language-R'>kconv(S=35, T=25, P=0, kf, Ks, Kff, warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kconv_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="kconv_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="kconv_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="kconv_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994);
if the fonction Kf was used previously, the default value is the value given for the argument kf in the fonction Kf. If the Kf function was not used previously, the default value is &quot;pf&quot;, except if T is outside the range 9 to 33oC or of S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>	
<tr><td><code id="kconv_+3A_ks">Ks</code></td>
<td>
<p>Stability constant of hydrogen sulfate (mol/kg) at given S, T and P, optional;
if not given, it will be computed, if given, it allows for speed optimisation</p>
</td></tr>
<tr><td><code id="kconv_+3A_kff">Kff</code></td>
<td>
<p>Stability constant of hydrogen fluoride (mol/kg) on free pH scale at given S, T and P, optional;
if not given, it will be computed, if given, it allows for speed optimisation and kf parameter is then ignored</p>
</td></tr>
<tr><td><code id="kconv_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for constants; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is critical to consider that each formulation is valid in specific ranges of temperature and salinity:
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p>Note that kconv may be called in many functions (i.e. K1, K2, K1p, K2p, K3p, Kw, Ksi, K2si, etc...) without user controls it. 
To force a particular formulation for Kf, it is recommended to call kconv() first then pass the resulting conversion factors
to these functions.
</p>


<h3>Value</h3>

<p>The function returns a list with 6 conversion factors :
</p>
<table>
<tr><td><code>ktotal2SWS</code></td>
<td>
<p>to convert from the total scale to seawater scale</p>
</td></tr>
<tr><td><code>ktotal2free</code></td>
<td>
<p>to convert from the total scale to the free scale</p>
</td></tr>
<tr><td><code>kfree2SWS</code></td>
<td>
<p>to convert from the free scale to the seawater scale</p>
</td></tr>  
<tr><td><code>kfree2total</code></td>
<td>
<p>to convert from the free scale to total scale</p>
</td></tr>
<tr><td><code>kSWS2total</code></td>
<td>
<p>to convert from the seawater scale to the total scale</p>
</td></tr>
<tr><td><code>kSWS2free</code></td>
<td>
<p>to convert from the seawater scale to the free scale</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert <a href="mailto:K.Soetaert@nioo.knaw.nl">K.Soetaert@nioo.knaw.nl</a>
</p>


<h3>References</h3>

<p>Dickson A.G. and F.J. Millero, 1987 A comparison of the equilibrium constants for the dissociation of carbonic acid in seawater media. <em>Deep-Sea Research</em> <b>34</b>:1733-1743.</p>


<h3>See Also</h3>

<p><code><a href="#topic+pHconv">pHconv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##To convert dissociation constants from the total scale to the free scale
## (at salinity=35, temperature=25oC and atmospheric pressure):
kconv(35,25,0)
conv &lt;- kconv()
 c(K1_total=K1(),K1_SWS=K1()*conv$ktotal2SWS,K1_free=K1()*conv$ktotal2free)  
</code></pre>

<hr>
<h2 id='Kf'>Equilibrium constant of hydrogen fluoride (mol/kg)</h2><span id='topic+Kf'></span>

<h3>Description</h3>

<p>Stability constant of hydrogen fluoride (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kf(S=35, T=25, P=0, kf="x", pHscale="T", Ks_p0="x", Ks_p="x", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kf_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="Kf_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="Kf_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="Kf_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994), default is &quot;pf&quot;. Attention do not use a vector for this argument.</p>
</td></tr>
<tr><td><code id="Kf_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="Kf_+3A_ks_p0">Ks_p0</code></td>
<td>
<p>Stability constant of hydrogen sulfate (mol/kg) at pressure zero;
needed if kf = &quot;pf&quot; ; if needed and not given or set to &quot;x&quot;, it is computed; if given, computation speed is increased</p>
</td></tr>
<tr><td><code id="Kf_+3A_ks_p">Ks_p</code></td>
<td>
<p>Stability constant of hydrogen sulfate (mol/kg) at chosen pressure;
if not given or set to &quot;x&quot;, it is computed; if given, computation speed is increased</p>
</td></tr>
<tr><td><code id="Kf_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for Kf; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Perez and Fraga (1987) constant is recommended by Guide to Best Practices for Ocean CO2 Measurements (2007). The Dickson and Riley (1979 in Dickson and Goyet, 1994) constant is recommended by DOE (1994). 
</p>
<p>It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length. 
</p>
<p>The pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>


<h3>Value</h3>

<table>
<tr><td><code>Kf</code></td>
<td>
<p>Stability constant of hydrogen fluoride (mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon, Heloise Lavigne, Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G. and Riley J. P., 1979 The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base. I. The ionic product of water. <em>Marine Chemistry</em> <b>7</b>, 89-99.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>DOE 1994 <em>Handbook of methods for the analysis of the various parameters of the carbon dioxide system in sea water</em>. ORNL/CDIAC-74. Oak Ridge,Tenn.: Carbon Dioxide Information Analysis Center, Oak Ridge National Laboratory.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Kf(S=35,T=25,P=0,kf="pf",pHscale="T")
</code></pre>

<hr>
<h2 id='kfg'>variable for internal use</h2><span id='topic+kfg'></span>

<h3>Description</h3>

<p>nothing</p>

<hr>
<h2 id='Khs'>Dissociation constant of hydrogen sulfide (mol/kg)</h2><span id='topic+Khs'></span>

<h3>Description</h3>

<p>Dissociation constant of hydrogen sulfide (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>Khs(S=35, T=25, P=0, pHscale="T", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Khs_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="Khs_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="Khs_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="Khs_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="Khs_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for Khs; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formulation is only valid for specific ranges of temperature and salinity: 
</p>

<ul>
<li><p> S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p>The pressure correction is applied on the seawater scale. Hence, the values are first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value is transformed back to the required scale (T, F or SWS).
</p>
<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Khs</code></td>
<td>
<p>Dissociation constant of hydrogen sulfide</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert <a href="mailto:K.Soetaert@nioo.knaw.nl">K.Soetaert@nioo.knaw.nl</a> and Heloise Lavigne
</p>


<h3>References</h3>

<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> 59: 661-677.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Khs(S=35,T=25,P=0, pHscale="T")
</code></pre>

<hr>
<h2 id='Kn'>Dissociation constant of ammonium (mol/kg)</h2><span id='topic+Kn'></span>

<h3>Description</h3>

<p>Dissociation constant of ammonium on the total scale (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kn(S=35, T=25, P=0, pHscale="T", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kn_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="Kn_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="Kn_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="Kn_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="Kn_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for Kn; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formulation is only valid for specific ranges of temperature and salinity: 
</p>

<ul>
<li><p> S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p>The pressure correction is applied on the seawater scale. Hence, values are first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value is transformed back to the required scale (T, F or SWS).
</p>
<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Kn</code></td>
<td>
<p>Dissociation constant of ammonium (mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert <a href="mailto:K.Soetaert@nioo.knaw.nl">K.Soetaert@nioo.knaw.nl</a> and Heloise Lavigne
</p>


<h3>References</h3>

<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Kn(S=35,T=25,P=0, pHscale="T")
</code></pre>

<hr>
<h2 id='Ks'>Stability constant of hydrogen sulfate (mol/kg)</h2><span id='topic+Ks'></span>

<h3>Description</h3>

<p>Stability constant of hydrogen sulfate (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ks(S=35, T=25, P=0, ks="d", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ks_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="Ks_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="Ks_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="Ks_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickson (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="Ks_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for Ks; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Dickson (1990) constant is recommended by Guide to Best Practices for Ocean CO2 Measurements (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length. 
</p>
<p>The pressure correction is applied on the free scale as described by Millero (1995), and the value transformed back to the required scale (T, F or SWS).
</p>


<h3>Value</h3>

<table>
<tr><td><code>Ks</code></td>
<td>
<p>Stability constant of hydrogen sulfate (mol/kg), pHscale = free scale</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Heloise Lavigne, Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen ion concentration in seawater from 5 to 40oC: standard potentials at salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. </p>


<h3>Examples</h3>

<pre><code class='language-R'>  Ks(S=35,T=25,P=0, ks="d")
</code></pre>

<hr>
<h2 id='Ksi'>Dissociation constant of Si(OH)4</h2><span id='topic+Ksi'></span>

<h3>Description</h3>

<p>Dissociation constant of Si(OH)4 on total scale (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ksi(S=35, T=25, P=0, pHscale="T", kSWS2scale="x", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ksi_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="Ksi_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="Ksi_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="Ksi_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="Ksi_+3A_ksws2scale">kSWS2scale</code></td>
<td>
<p>Conversion factor from the seawater scale (SWS) to the pH scale selected at the hydrostatic pressure value indicated. It is advised to use default value &quot;x&quot;, in which case it is computed when required.</p>
</td></tr>
<tr><td><code id="Ksi_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for Ksi; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formulation is only valid for specific ranges of temperature and salinity: 
</p>

<ul>
<li><p> S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p>The pressure correction is applied on the seawater scale. Hence, values are first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value is transformed back to the required scale (T, F or SWS).
</p>
<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Ksi</code></td>
<td>
<p>Dissociation constant of Si(OH)4 (mol/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert <a href="mailto:K.Soetaert@nioo.knaw.nl">K.Soetaert@nioo.knaw.nl</a> and Heloise Lavigne
</p>


<h3>References</h3>

<p>DOE 1994 <em>Handbook of methods for the analysis of the various parameters of the carbon dioxide system in sea water</em>. ORNL/CDIAC-74. Oak Ridge,Tenn.: Carbon Dioxide Information Analysis Center, Oak Ridge National Laboratory.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Ksi(S=35, T=25, P=0, pHscale="T")
</code></pre>

<hr>
<h2 id='Kspa'>Solubility product of aragonite (mol/kg)</h2><span id='topic+Kspa'></span>

<h3>Description</h3>

<p>Solubility product of aragonite (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kspa(S=35, T=25, P=0, warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kspa_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="Kspa_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="Kspa_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="Kspa_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for Kspa; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formulation is only valid for specific ranges of temperature and salinity: 
</p>

<ul>
<li><p> S ranging between 5 and 44 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>Pressure coorection was performed as described by Millero (1995).
</p>
<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Kspa</code></td>
<td>
<p>Solubility product of aragonite (mol2/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica et Cosmochimica Acta</em> <b>59</b> 661-677.
</p>
<p>Mucci A., 1983 The solubility of calcite and aragonite in seawater at various salinities, temperature, and one atmosphere total pressure. <em>American Journal of Science</em> <b>283</b>: 780-799.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Kspc">Kspc</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Kspa(S=35,T=25,P=0)
</code></pre>

<hr>
<h2 id='Kspc'>Solubility product of calcite (mol/kg)</h2><span id='topic+Kspc'></span>

<h3>Description</h3>

<p>Solubility product of calcite (mol/kg)</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kspc(S=35, T=25, P=0, warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kspc_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="Kspc_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="Kspc_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="Kspc_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for Kspc; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formulation is only valid for specific ranges of temperature and salinity: 
</p>

<ul>
<li><p> S ranging between 5 and 44 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The pressure coorection was performed as described by Millero (1995).
</p>
<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Kspc</code></td>
<td>
<p>Solubility product of calcite (mol2/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica et Cosmochimica Acta</em> <b>59</b> 661-677.
</p>
<p>Mucci A., 1983 The solubility of calcite and aragonite in seawater at various salinities, temperature, and one atmosphere total pressure. <em>American Journal of Science</em> <b>283</b>: 780-799.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Kspa">Kspa</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	Kspc(S=35,T=25,P=0)
</code></pre>

<hr>
<h2 id='Kw'>Ion product of water (mol2/kg2)</h2><span id='topic+Kw'></span>

<h3>Description</h3>

<p>Ion product of water (mol2/kg2)</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kw(S=35, T=25, P=0, pHscale="T", kSWS2scale="x", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Kw_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="Kw_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="Kw_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="Kw_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="Kw_+3A_ksws2scale">kSWS2scale</code></td>
<td>
<p>Conversion factor from the seawater scale (SWS) to the pH scale selected at the hydrostatic pressure value indicated. It is advised to use default value &quot;x&quot;, in which case it is computed when required.</p>
</td></tr>
<tr><td><code id="Kw_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for Kw; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formulation is only valid for specific ranges of temperature and salinity: 
</p>

<ul>
<li><p> S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p>The pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Kw</code></td>
<td>
<p>Ion product of water (mol2/kg2)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Heloise Lavigne, Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica et Cosmochimica Acta</em> <b>59</b> 661-677.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Kw(S=35,T=25,P=0,pHscale="T")
</code></pre>

<hr>
<h2 id='oa'>Perturbation of the seawater carbonate system</h2><span id='topic+oa'></span>

<h3>Description</h3>

<p>Describes the various approaches that can be used to alter the seawater carbonate system. Its main purpose is to assist the design of ocean acidification perturbation experiments.</p>


<h3>Usage</h3>

<pre><code class='language-R'>oa(flag, var1, var2, pCO2f, pCO2s=1e6, S=35, T=25, P=0, 
	Pt=0, Sit=0, k1k2='x', kf='x', ks="d", pHscale="T", plot=FALSE, 
	b="u74", eos = "eos80", long = 1e+20, lat = 1e+20)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oa_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available to describe the initial seawater. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="oa_+3A_var1">var1</code></td>
<td>
<p>Value of the first variable available to describe the initial seawater, in mol/kg except for pH and for pCO2 in uatm</p>
</td></tr>
<tr><td><code id="oa_+3A_var2">var2</code></td>
<td>
<p>Value of the second variable available to describe the initial seawater, in mol/kg except for pH</p>
</td></tr>
<tr><td><code id="oa_+3A_pco2f">pCO2f</code></td>
<td>
<p>pCO2 target value, in uatm</p>
</td></tr>
<tr><td><code id="oa_+3A_pco2s">pCO2s</code></td>
<td>
<p>pCO2s is the pCO2, in uatm, of the &ldquo;high-CO2&rdquo; seawater that will be mixed with &ldquo;normal seawater&rdquo;. The default value is 10^6 uatm, that is seawater bubbled with pure CO2 gas and saturated with CO2.</p>
</td></tr>
<tr><td><code id="oa_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="oa_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25</p>
</td></tr>
<tr><td><code id="oa_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="oa_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg, default is 0</p>
</td></tr>
<tr><td><code id="oa_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg, default is 0</p>
</td></tr>
<tr><td><code id="oa_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="oa_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="oa_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickon (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="oa_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="oa_+3A_plot">plot</code></td>
<td>
<p>A plot of the different perturbation methods can be plotted in a DIC vs ALK field with pCO2 isoclines are drawn in the back. Default is false.</p>
</td></tr>
<tr><td><code id="oa_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot;.</p>
</td></tr>
<tr><td><code id="oa_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="oa_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="oa_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>



<h3>Value</h3>

<p>The function returns a list built as follows: 
</p>
<table>
<tr><td><code>description</code></td>
<td>
<p>A table describing in plain English the various ways to reach the target pCO2. Note that if a vector is given in argument only the first value is used.</p>
</td></tr>
<tr><td><code>perturbation</code></td>
<td>
<p>Table providing key parameters for the following methods:
</p>
<p><em>CO2 bubbling</em>: high-CO2 air is bubbled in seawater. The first parameter is the value of the pCO2 in the air required to bubble the seawater (in uatm).
</p>
<p><em>SW mixing</em>: mixing of &ldquo;normal&rdquo; and &ldquo;high-CO2&rdquo; seawater. The fist parameter, &ldquo;Weight fraction high-CO2 SW&rdquo; or wf, is the weight fraction of the high-CO2 seawater per kg seawater.
</p>
<p><em>Addition of acid</em>: strong acid is added to seawater. Note that this method is not recommended because it does not closely mimic natural ocean acidification (Gattuso and Lavigne, 2009). The first parameter, H+ (mol/kg), is the amount of H+ that must be added (mol/kg). The acid must be fortified with NaCl in order to have the same salinity than seawater.
</p>
<p><em>Addition of HCO3 and acid</em>: bicarbonate (HCO3) and a strong acid are added. The first parameter, HCO3, is the amount of HCO3 that must be added (mol/kg). The second parameter, H+, is the quantity of H+ that must be added (mol/kg). The acid must be fortified with NaCl in order to have the same salinity than seawater.
</p>
<p><em>Addition of CO3 and acid</em>: carbonate, CO3, and a strong acid are added. The first parameter, HCO3, is the quantity of CO3 that must be added (mol/kg). The second parameter, H+, is the quantity of H+ that must be added (mol/kg).
</p>
</td></tr>
<tr><td><code>summary</code></td>
<td>
<p>Table summarizing the carbonate chemistry before and after applying each perturbation: pCO2 bubbling, mixing with high-CO2 seawater, addition of strong acid, and addition of bicarbonate/carbonate and strong acid.</p>
</td></tr>
</table>


<h3>Warnings</h3>


<ul>
<li><p> It is recommended to use concentrated solutions of acid or base in order to add small volumes.
</p>
</li>
<li><p> The addition of strong acid does not simulate well natural ocean acidification (higher concentration of dissolved inorganic carbon at constant total alkalinity) since it generates a decrease in total alkalinity while dissolved inorganic carbon is kept constant.
</p>
</li>
<li><p> Other important advice is provided in Gattuso and Lavigne (2009), Schulz et al. (2009) and in the &ldquo;Guide for Best Practices on Ocean Acidification Research and Data Reporting&rdquo; (<a href="https://www.iaea.org/sites/default/files/18/06/oa-guide-to-best-practices.pdf">https://www.iaea.org/sites/default/files/18/06/oa-guide-to-best-practices.pdf</a>)
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Author(s)</h3>

<p>Heloise Lavigne and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
</p>
<p>Gattuso J.-P. and Lavigne H., 2009 Technical note: approaches and software tools to investigate the impact of ocean acidification. <em>Biogeosciences</em> <b>21</b>, 6:2121-2133. 
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993 The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>.
</p>
<p>Schulz K. G., Barcelos e Ramos J., Zeebe R. E. and Riebesell U., 2009 CO2 perturbation experiments: similarities and differences between dissolved inorganic carbon and total alkalinity manipulations. <em>Biogeosciences</em> <b>6</b>, 2145-2153.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Marine Chemistry 165, 66-67.
</p>
<p>Zeebe R. E. and Wolf-Gladrow D. A., 2001 <em>CO2 in seawater: equilibrium, kinetics, isotopes</em>. Amsterdam: Elsevier, 346 pp.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+carb">carb</a></code>, <code><a href="#topic+pgas">pgas</a></code>, <code><a href="#topic+pmix">pmix</a></code>, <code><a href="#topic+ppH">ppH</a></code>, <code><a href="#topic+pTA">pTA</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>oa(flag=24, var1=384, var2=2325e-6, pCO2s=1e6, pCO2f=793, S=34.3, T=16, 
	P=0, pHscale="T", kf="pf", k1k2="l", ks="d", plot=TRUE, b="u74")
</code></pre>

<hr>
<h2 id='Om'>Carbonate saturation state for magnesian calcites</h2><span id='topic+Om'></span>

<h3>Description</h3>

<p>Calculates the calcium carbonate saturation state for magnesian calcite</p>


<h3>Usage</h3>

<pre><code class='language-R'>Om(x, flag, var1, var2, k1k2='x', kf='x', ks="d", pHscale="T", b="u74")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Om_+3A_x">x</code></td>
<td>
<p>mole fraction of magnesium ions, note that the function is only valid for x ranging between 0 and 0.25</p>
</td></tr>
<tr><td><code id="Om_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="Om_+3A_var1">var1</code></td>
<td>
<p>Value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="Om_+3A_var2">var2</code></td>
<td>
<p>Value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="Om_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="Om_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="Om_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickson (1990) and &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="Om_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="Om_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is important to note that this function is <b>only valid</b> for:
</p>

<ul>
<li><p> Salinity = 35	
</p>
</li>
<li><p> Temperature = 25 degrees Celsius	
</p>
</li>
<li><p> Hydrostatic pressure = 0 bar (surface)  	
</p>
</li>
<li><p> Concentration of total phosphate = 0 mol/kg
</p>
</li>
<li><p> Concentration of total silicate = 0 mol/kg
</p>
</li></ul>

<p>Note that the stoichiometric solubility products with respect to Mg-calcite minerals have not been determined experimentally. The saturation state with respect to Mg-calcite minerals is therefore calculated based on ion activities, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">
\Omega_{x} = \frac{ \{Ca^{2+}\}^{1-x} \{Mg^{2+}\}^{x} \{CO_{3}\}^{2-} } { K_{x} }
</code>
</p>

<p>The ion activity {a} is calculated based on the observed ion concentrations [C] multiplied by the total ion activity coefficient, <code class="reqn">\gamma_T</code>, which has been determined experimentally or from theory (e.g. Millero &amp; Pierrot 1998): {a}=<code class="reqn">\gamma_T</code>[C]. Because a true equilibrium cannot be achieved with respect to Mg-calcite minerals, <code class="reqn">K_x</code> represents a metastable equilibrium state obtained from what has been referred to as stoichiometric saturation (Thorstenson &amp; Plummer 1977; a term not equivalent to the definition of the stoichiometric solubility product, see for example Morse et al. (2006) and references therein). In the present calculation calcium and magnesium concentrations were calculated based on salinity. Total ion activity coefficients with respect to <code class="reqn">Ca^{2+}</code>, <code class="reqn">Mg^{2+}</code>, and <code class="reqn">CO_{3}^{2-}</code> were adopted from Millero &amp; Pierrot (1998).  
</p>
<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>



<h3>Value</h3>

<p>The function returns a list with
</p>
<table>
<tr><td><code>OmegaMgCa_biogenic</code></td>
<td>
<p>Mg-calcite saturation state for minimally prepared biogenic Mg-calcite.</p>
</td></tr>
<tr><td><code>OmegaMgCa_biogenic_cleaned</code></td>
<td>
<p>Mg-calcite saturation state for cleaned and annealed biogenic Mg-calcite.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Heloise Lavigne, Andreas J. Andersson and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Only the references related to the saturation state of magnesian calcite are listed below; the other references are listed under the carb function.
</p>
<p>Andersson A. J., Mackenzie F. T., Nicholas R. B., 2008, Life on the margin: implications of ocean acidification on Mg-calcite, high latitude and cold-water marine calcifiers. <em>Marine Ecology Progress Series</em> <b>373</b>, 265-273.
</p>
<p>Bischoff W. D., Mackenzie F. T. and Bishop F. C., 1987. Stabilities of synthetic magnesian calcites in aqueous solution: comparison with biogenic materials. <em>Geochimica et Cosmochimica Acta</em> <b>51</b>:1413-1423.
</p>
<p>Millero F. J. and Pierrot D., 1998. A chemical equilibrium model for natural waters. <em>Aquatic Geochemistry</em> <b>4</b>, 153-199.
</p>
<p>Morse J. W., Andersson A. J. and Mackenzie F. T., 2006. Initial responses of carbonate-rich shelf sediments to rising atmospheric pCO2 and ocean acidification: Role of high Mg-calcites. <em>Geochimica et Cosmochimica Acta</em> <b>70</b>, 5814-5830.
</p>
<p>Plummer L. N. and Mackenzie F. T., 1974. Predicting mineral solubility from rate data: application to the dissolution of magnesian calcites. <em>American Journal of Science</em> <b>274</b>:61-83.
</p>
<p>Thorstenson D.C. and Plummer L.N., 1977. Equilibrium criteria for two component solids reacting with fixed composition in an aqueous phase-example: the magnesian calcites. <em>American Journal of Science</em> <b>277</b>, 1203-1233.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Om(x=seq(0.01, 0.252, 0.01), flag=8, var1=8.2, var2=0.00234, 
  k1k2='x', kf='x', ks="d", pHscale="T", b="u74")
</code></pre>

<hr>
<h2 id='p2d'>Converts pressure in dbar to depth in meters</h2><span id='topic+p2d'></span>

<h3>Description</h3>

<p>Converts pressure in dbar to depth in meters</p>


<h3>Usage</h3>

<pre><code class='language-R'>p2d(pressure, lat=40)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p2d_+3A_pressure">pressure</code></td>
<td>
<p>Pressure in dbar</p>
</td></tr>
<tr><td><code id="p2d_+3A_lat">lat</code></td>
<td>
<p>Latitude in degrees, N and S is irrelevant, default is 40o</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>depth</code></td>
<td>
<p>Depth corresponding to the pressure given, in meters</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Heloise Lavigne and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Saunders P. M., 1981. Practical conversion of pressure to depth. <em>J. Phys. Oceanogr.</em> <b>11</b>: 573-574.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+d2p">d2p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p2d(pressure=7686, lat=30)  
</code></pre>

<hr>
<h2 id='p2fCO2'>Converts pCO2 (partial pressure in CO2) into fCO2 (fugacity of CO2)</h2><span id='topic+p2fCO2'></span>

<h3>Description</h3>

<p>Converts pCO2 (partial pressure in CO2) into fCO2 (fugacity of CO2)</p>


<h3>Usage</h3>

<pre><code class='language-R'>p2fCO2(T = 25, Patm=1, P=0, pCO2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p2fCO2_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="p2fCO2_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="p2fCO2_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar, default is 0 bar (surface)</p>
</td></tr>
<tr><td><code id="p2fCO2_+3A_pco2">pCO2</code></td>
<td>
<p>Partial pressure in CO2 in <code class="reqn">\mu</code>atm, the same units as that for the fugacity output</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>fCO2</code></td>
<td>
<p>Fugacity of CO2 in <code class="reqn">\mu</code>atm, the same units as that for the pCO2 input.</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>Heloise Lavigne, Jean-Pierre Gattuso, and James Orr <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Weiss, R. F., 1974. Carbon dioxide in water and seawater: the solubility of a non-ideal gas, <em>Mar.  Chem.</em>, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A., 1980. Nitrous oxide solubility in water and seawater, <em>Marine Chemistry</em>, <b>8</b>, 347-359.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+f2pCO2">f2pCO2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p2fCO2(T=25, Patm=0.97, P=0, pCO2=380)  
</code></pre>

<hr>
<h2 id='p2xCO2'>Converts partial pressure of CO2 to mole fraction of CO2</h2><span id='topic+p2xCO2'></span>

<h3>Description</h3>

<p>Converts pCO2 (partial pressure of CO2) into xCO2 (mole fraction of CO2)</p>


<h3>Usage</h3>

<pre><code class='language-R'>p2xCO2(S=35, T=25, Patm=1, pCO2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p2xCO2_+3A_s">S</code></td>
<td>
<p>Salinity on the practical salinity scale, default is 35</p>
</td></tr>
<tr><td><code id="p2xCO2_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="p2xCO2_+3A_patm">Patm</code></td>
<td>
<p>Atmospheric pressure in atmospheres, default is 1.0 (this is not the hydrostatic pressure)</p>
</td></tr>
<tr><td><code id="p2xCO2_+3A_pco2">pCO2</code></td>
<td>
<p>Partial pressure of CO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The xCO2 (ppm) is computed from pCO2 (<code class="reqn">\mu</code>atm) using the
following equation: <code class="reqn"> xCO2 = pCO2 / (Patm - pH2O)</code>, where pH20 is the vapor pressure of seawater computed following best practices (Dickson et al., 2007). That computed pH20 is identical, when rounded to the 4th decimal place, with that computed by the equation from Weiss and Price (1980).</p>


<h3>Value</h3>

<table>
<tr><td><code>xCO2</code></td>
<td>
<p>Mole fraction of CO2 in ppm.</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>James Orr <a href="mailto:james.orr@lsce.ipsl.fr">james.orr@lsce.ipsl.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., Sabine C. L. and Christian J. R. (2007) Guide to best
practices for ocean CO2 measurements. <em>PICES Special Publication</em>
<b>3</b>, 1-191.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Weiss, R. F. (1974) Carbon dioxide in water and seawater: the
solubility of a non-ideal gas, Marine Chemistry, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A. (1980) Nitrous oxide solubility in water
and seawater, Marine Chemistry, <b>8</b>, 347-359.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+x2pCO2">x2pCO2</a></code> and <code><a href="#topic+vapress">vapress</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Convert atmospheric pressure from mbar to atm
   Patm_mbar = 1052                 # in millibar
   Patm      = Patm_mbar / 1013.25  # in atm
## Compute xCO2 from pCO2
   pCO2 = 380
   xCO2 = p2xCO2(T=25, S=35, Patm=Patm, pCO2=pCO2)
   print(xCO2)
## The result is 377.1546 ppm 
</code></pre>

<hr>
<h2 id='pCa'>pCa</h2><span id='topic+pCa'></span>

<h3>Description</h3>

<p>Calculates the changes in the saturation states of aragonite and calcite resulting from the manipulation of the calcium concentration</p>


<h3>Usage</h3>

<pre><code class='language-R'>pCa(flag, var1, var2, Ca, S=35, T=20, P=0, Pt=0, Sit=0, k1k2="x", 
	kf="x", ks="d", pHscale="T", b="u74", eos = "eos80", long = 1e+20, lat = 1e+20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pCa_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="pCa_+3A_var1">var1</code></td>
<td>
<p>Value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="pCa_+3A_var2">var2</code></td>
<td>
<p>Value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="pCa_+3A_ca">Ca</code></td>
<td>
<p>Calcium concentration in mol/kg</p>
</td></tr>
<tr><td><code id="pCa_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="pCa_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="pCa_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="pCa_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg</p>
</td></tr>
<tr><td><code id="pCa_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg</p>
</td></tr>
<tr><td><code id="pCa_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="pCa_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="pCa_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickon (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="pCa_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="pCa_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot;.</p>
</td></tr>
<tr><td><code id="pCa_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="pCa_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="pCa_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>comment</code></td>
<td>
<p>The initial or final state water</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Pressure in bar</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>CO2 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>pCO2, CO2 partial pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>fCO2, CO2 fugacity (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>HCO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>CO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>DIC concentration (mol/kg)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>Omega calcite, calcite saturation state</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Ben-Yaakov S. and Goldhaber M. B., 1973 The influence of sea water composition on the apparent constants of the carbonate system. <em>Deep-Sea Research</em> <b>20</b>, 87-99.
</p>
<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Gattuso J.-P. and Lavigne H, 2009 Perturbation experiments to investigate the impact of ocean acidification: approaches and software tools. <em>Biogeosciences</em> <b>6</b>, 4413-4439.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Marine Chemistry 165, 66-67.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pCa(flag=15, var1=2302e-6, var2=2050e-6, Ca=0.01028, S=35, T=20, P=0, 
	Pt=0, Sit=0, pHscale="T", kf="pf", k1k2="l", ks="d", b="u74") # with normal Ca concentration
pCa(flag=15, var1=2302e-6, var2=2050e-6, Ca=0.01028/2, S=35, T=20, P=0, 
	Pt=0, Sit=0, pHscale="T", kf="pf", k1k2="l", ks="d", b="u74") # with 0.5 * Ca concentration
</code></pre>

<hr>
<h2 id='pCO2insi'>pCO2 at in situ temperature</h2><span id='topic+pCO2insi'></span>

<h3>Description</h3>

<p>Correction to compensate for the difference in temperature between the temperature of measurement and in situ temperature.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pCO2insi(pCO2lab = 400, Tlab = 20, SST = 19)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pCO2insi_+3A_pco2lab">pCO2lab</code></td>
<td>
<p>Partial pressure of CO2 measured in the lab in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="pCO2insi_+3A_tlab">Tlab</code></td>
<td>
<p>Temperature of measurement in the lab in in degrees Celsius, default is 20oC</p>
</td></tr>
<tr><td><code id="pCO2insi_+3A_sst">SST</code></td>
<td>
<p>Temperature in degrees Celsius, default is 19oC</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>pCO2insi</code></td>
<td>
<p>Partial pressure of CO2 at in situ temperature in <code class="reqn">\mu</code>atm, the same units as that for the pCO2 input.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The empirical correction applied is from Takahashi (1993) as recommended by Pierrot et al. (2009)</p>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Pierrot D., Neill C., Sullivan K., Castle R., Wanninkhof R., L√É¬ºger H., Johannessen T., Olsen A., Feely R. A. and Cosca C. E., 2009. Recommendations for autonomous underway pCO2 measuring systems and data-reduction routines. <em>Deep-Sea Res. II</em> <b>56</b>, 512-522.
</p>
<p>Takahashi T., Olafsson J., Goddard J. G., Chipman D. W. and Sutherland S. C., 1993. Seasonal variation of CO2 and nutrients in the high-latitude surface oceans: a comparative study. <em>Glob. Biogeochem. Cycles</em> <b>7</b>, 843-878.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+f2pCO2">f2pCO2</a></code>, <code><a href="#topic+fCO2insi">fCO2insi</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pCO2insi(pCO2lab = 400, SST = 15, Tlab = 16)
</code></pre>

<hr>
<h2 id='Pcoeffs'>Coefficients used for pressure-correcting the equilibrium constants</h2><span id='topic+Pcoeffs'></span>

<h3>Description</h3>

<p>Pressure corrections are based on the following equations: 
</p>
<p style="text-align: center;"><code class="reqn">
  \ln{\frac{K_{i}^{P}}{K_{i}^{0}}} = -\frac{\Delta V_{i}}{RT}.P + 0.5\frac{\Delta K_{i}}{RT}.P^{2} 
 </code>
</p>

<p>with 
</p>
<p style="text-align: center;"><code class="reqn">
   \Delta V_{i} = a_{0} + a_{1}T + a_{2}T^{2}
 </code>
</p>

<p>and 
</p>
<p style="text-align: center;"><code class="reqn">
   \Delta K_{i} = b_{0} + b_{1}T + b_{2}T^{2}
</code>
</p>

<p>The variables are:
</p>

<ul>
<li><p> K indicating the type of equilibrium constant
</p>
</li>
<li><p> coefficient <code class="reqn">a_0</code>
</p>
</li>
<li><p> coefficient <code class="reqn">a_1</code>
</p>
</li>
<li><p> coefficient <code class="reqn">a_2</code>
</p>
</li>
<li><p> coefficient <code class="reqn">b_0</code>
</p>
</li>
<li><p> coefficient <code class="reqn">b_1</code>
</p>
</li>
<li><p> coefficient <code class="reqn">b_2</code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Pcoeffs</code></pre>


<h3>Format</h3>

<p>A data frame with 15 rows and 7 variables</p>


<h3>Details</h3>

<p>For Kb, to be consistent with Millero (1979) a2 was changed to -2.608e-3 instead of 2.608e-3 (value given in Millero, 1995)
For Kw, coefficients are from Millero (1983).
</p>


<h3>Source</h3>

<p>Millero F. J., 1979 The thermodynamics of the carbonate system in seawater. <em>Geochemica et Cosmochemica Acta</em> <b>43</b>: 1651-1661.
</p>
<p>Millero F. J., 1983 Influence of pressure on chemical processes in the sea. pp. 1-88. In J. P. Riley and R. Chester (eds.), Chemical Oceanography. Academic Press, New York.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>


<h3>See Also</h3>

<p>Pcorrect
</p>

<hr>
<h2 id='Pcorrect'>Pressure correction of equilibrium constants</h2><span id='topic+Pcorrect'></span>

<h3>Description</h3>

<p>Computes the pressure correction of the equilibrium constants</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pcorrect(Kvalue, Ktype, T=25, S=35, P=0, pHscale="T", 
  kconv2ScaleP0="x", kconv2Scale="x", warn="y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pcorrect_+3A_kvalue">Kvalue</code></td>
<td>
<p>Value of the constant at P=0 (hydrostatic pressure in bar, surface = 0)</p>
</td></tr>
<tr><td><code id="Pcorrect_+3A_ktype">Ktype</code></td>
<td>
<p>Name of the constant, 
</p>

<ul>
<li><p> K1	First dissociation constant of carbonic acid (mol/kg)
</p>
</li>
<li><p> K2	Second dissociation constant of carbonic acid (mol/kg)
</p>
</li>
<li><p> Kb	Dissociation constant of boric acid (mol/kg)
</p>
</li>
<li><p> Kw	Ion product of water (mol2/kg2)
</p>
</li>
<li><p> Ks	Stability constant of hydrogen sulfate (mol/kg)
</p>
</li>
<li><p> Kf	Stability constant of hydrogen fluoride (mol/kg)
</p>
</li>
<li><p> Kspc	Solubility product of calcite (mol/kg)
</p>
</li>
<li><p> Kspa	Solubility product of aragonite (mol/kg)
</p>
</li>
<li><p> K1p	First dissociation constant of phosphoric acid (mol/kg)
</p>
</li>
<li><p> K2p	Second dissociation constant of phosphoric acid (mol/kg)
</p>
</li>
<li><p> K3p	Third dissociation constant of phosphoric acid (mol/kg)
</p>
</li>
<li><p> Khs	Dissociation constant of hydrogen sufide(mol/kg)
</p>
</li>
<li><p> Kn	Dissociation constant of ammonium (mol/kg)
</p>
</li>
<li><p> Ksi	Dissociation constant of Si(OH)4 (mol/kg)
</p>
</li>
<li><p> K2si	Second dissociation constant of Si(OH)4 (mol/kg)
</p>
</li></ul>
</td></tr>
<tr><td><code id="Pcorrect_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="Pcorrect_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="Pcorrect_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="Pcorrect_+3A_phscale">pHscale</code></td>
<td>
<p>pHscale of the constant given in Kvalue</p>
</td></tr>
<tr><td><code id="Pcorrect_+3A_kconv2scalep0">kconv2ScaleP0</code></td>
<td>
<p>Conversion factor from the pH scale selected to the SWS (or free for Kf) scale at pressure zero. It is advised to use default value &quot;x&quot;, in which case it is computed when required. (may slow down the computation)</p>
</td></tr>
<tr><td><code id="Pcorrect_+3A_kconv2scale">kconv2Scale</code></td>
<td>
<p>Conversion factor from the pH scale selected to the SWS (or free for Kf) scale at the hydrostatic pressure value indicated. It is advised to use default value &quot;x&quot;, in which case it is computed when required. (may slow down the computation)</p>
</td></tr>
<tr><td><code id="Pcorrect_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for constants; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The pressure correction is applied on the seawater scale for K1, K2, K1p, K2p, K3p, Kb, Khs, Kn, Ksi, K2si and Kw. Hence the K value is first converted on the seawater scale if needed. After pressure correction, the constant is converted back to the initial pH scale.
</p>
</li>
<li><p> The pressure correction is applied on the free scale for Kf.
</p>
</li>
<li><p> There is no issue of pH scale for Ks, Kspa and Kspc.
</p>
</li></ul>



<h3>Value</h3>

<p>The equilibrium constant given in argument but after pressure correction
</p>


<h3>Author(s)</h3>

<p>Heloise Lavigne and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica et Cosmochimica Acta</em> <b>59</b> 661-677.
</p>


<h3>See Also</h3>

<p>Pcoeffs
</p>


<h3>Examples</h3>

<pre><code class='language-R'>k10 &lt;- K1(T=25, P=0, S=35)
Pcorrect(Kvalue=k10, Ktype="K1", P=300, T=25, S=35, pHscale="T")
</code></pre>

<hr>
<h2 id='pgas'>pgas</h2><span id='topic+pgas'></span>

<h3>Description</h3>

<p>Calculates the carbonate chemistry after changes in pCO2 generated by gas bubbling</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgas(flag, var1, var2, pCO2g, S=35, T=20, P=0, Pt=0, Sit=0, k1k2="x", 
	kf="x", ks="d", pHscale="T", b="u74", eos = "eos80", long = 1e+20, lat = 1e+20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgas_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="pgas_+3A_var1">var1</code></td>
<td>
<p>Value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="pgas_+3A_var2">var2</code></td>
<td>
<p>Value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="pgas_+3A_pco2g">pCO2g</code></td>
<td>
<p>CO2 partial pressure of the gas used for bubbling in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="pgas_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="pgas_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="pgas_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="pgas_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg</p>
</td></tr>
<tr><td><code id="pgas_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg</p>
</td></tr>
<tr><td><code id="pgas_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="pgas_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="pgas_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickon (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="pgas_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="pgas_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot;.</p>
</td></tr>
<tr><td><code id="pgas_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="pgas_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="pgas_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>comment</code></td>
<td>
<p>The initial or final state water</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Pressure in bar</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>CO2 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>pCO2, CO2 partial pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>fCO2, CO2 fugacity (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>HCO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>CO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>DIC concentration (mol/kg)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>Omega calcite, calcite saturation state</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso and Heloise Lavigne <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G. and Riley J. P., 1979 The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base. I. The ionic product of water. <em>Marine Chemistry</em> <b>7</b>, 89-99.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Gattuso J.-P. and Lavigne H, 2009 Perturbation experiments to investigate the impact of ocean acidification: approaches and software tools. <em>Biogeosciences</em> <b>6</b>, 4413-4439.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Marine Chemistry 165, 66-67.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pgas(flag=15, var1=2302e-6, var2=2050e-6, pCO2g=750, S=35, T=20, P=0, 
	Pt=0, Sit=0, pHscale="T", kf="pf", k1k2="l", ks="d", b="u74") 
</code></pre>

<hr>
<h2 id='pH'>Potentiometric pH</h2><span id='topic+pH'></span>

<h3>Description</h3>

<p>Calculation of potentiometric pH</p>


<h3>Usage</h3>

<pre><code class='language-R'>	pH(Ex=-67,Etris=-72.4,S=35,T=25)
	
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pH_+3A_ex">Ex</code></td>
<td>
<p>e.m.f. of the seawater sample in mV, default is 67</p>
</td></tr>
<tr><td><code id="pH_+3A_etris">Etris</code></td>
<td>
<p>e.m.f. of the TRIS buffer in mV, default is -72.4</p>
</td></tr>
<tr><td><code id="pH_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="pH_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.</p>


<h3>Value</h3>

<table>
<tr><td><code>pH</code></td>
<td>
<p>Potentiometric pH (in mol/kg on the total scale)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tris">tris</a></code>, <code><a href="#topic+amp">amp</a></code>, <code><a href="#topic+pHslope">pHslope</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	##Example from Dickson et al. (2007)
	pH(Ex=-67,Etris=-72.4,S=35,T=25)
</code></pre>

<hr>
<h2 id='pHconv'>Conversion of pH</h2><span id='topic+pHconv'></span>

<h3>Description</h3>

<p>Converts pH from one scale to another one chosen between the total scale, the free scale and the seawater scale</p>


<h3>Usage</h3>

<pre><code class='language-R'>pHconv(flag=1, pH=8.10, S=35, T=25, P=0, ks="d")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pHconv_+3A_flag">flag</code></td>
<td>
<p>choice of the type of conversion :
flag=1: seawater scale to total scale
flag=2: free scale to total scale
flag=3: total scale to seawater scale
flag=4: total scale to free scale
flag=5: seawater scale to free scale
flag=6: free scale to seawater scale
default is flag=1</p>
</td></tr>
<tr><td><code id="pHconv_+3A_ph">pH</code></td>
<td>
<p>Enter the value of pH which need to be converted, default is 8.100</p>
</td></tr>
<tr><td><code id="pHconv_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="pHconv_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="pHconv_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
<tr><td><code id="pHconv_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickon (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The Dickson (1990) constant is recommended by the Guide to Best Practices for Ocean CO2 Measurements (2007). It is critical to consider that each formulation is valid in specific ranges of temperature and salinity:
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.</p>


<h3>Value</h3>

<p>The function returns the values of pH converted
</p>


<h3>Author(s)</h3>

<p>Heloise Lavigne and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A.G. and F.J. Millero, 1987 A comparison of the equilibrium constants for the dissociation of carbonic acid in seawater media. <em>Deep-Sea Research</em> <b>34</b>:1733-1743.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+kconv">kconv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##To convert pH=8.10 from the seawater scale to the total scale
##at salinity=35, temperature=25oC and atmospheric pressure:

  pHc &lt;- pHconv(flag=1, pH=8.10, S=35, T=25, P=0, ks="d")

##note that pHc is the value of the pH converted in total scale

## By using vectors
## to convert the pH values : 8, 8.05, 8.10, 8.15, 8.20 
## from the free to the total scale

pH &lt;- c(8, 8.05, 8.10, 8.15, 8.20)
pHc &lt;- pHconv(flag=2, pH=pH, S=35, T=25, P=0, ks="d")

## note that pHc is a vector containing the value of the pH converted 
## to the total scale
</code></pre>

<hr>
<h2 id='pHinsi'>pH at in situ temperature and pressure</h2><span id='topic+pHinsi'></span>

<h3>Description</h3>

<p>pH at in situ temperature and pressure</p>


<h3>Usage</h3>

<pre><code class='language-R'>pHinsi(pH=8.2, ALK=2.4e-3, Tinsi=20, Tlab=25, Pinsi=0, S=35, Pt=0, Sit=0, 
  k1k2 = "x", kf = "x", ks="d", pHscale = "T", b="u74", eos = "eos80", 
  long = 1e+20, lat = 1e+20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pHinsi_+3A_ph">pH</code></td>
<td>
<p>pH measured in the laboratory</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_alk">ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg)</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_tinsi">Tinsi</code></td>
<td>
<p>In situ temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_tlab">Tlab</code></td>
<td>
<p>Measurement temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_pinsi">Pinsi</code></td>
<td>
<p>In situ hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_pt">Pt</code></td>
<td>
<p>value of the concentration of total phosphate in mol/kg</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_sit">Sit</code></td>
<td>
<p>the value of the total silicate in mol/kg</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickon (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="pHinsi_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_b">b</code></td>
<td>
<p>&quot;l10&quot; for computing boron total from the Lee et al. (2010) formulation or &quot;u74&quot; for using the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="pHinsi_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="pHinsi_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<table>
<tr><td><code>pH</code></td>
<td>
<p>pH at in situ temperature and pressure</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso, <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Hunter K. A., 1998. The temperature dependence of pH in surface seawater. <em>Deep-Sea Research (Part I, Oceanographic Research Papers)</em> <b>45</b>(11):1919-1930.
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84. 
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Marine Chemistry 165, 66-67.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  pHinsi(pH=8.2,ALK=2.4e-3,Tinsi=25,Tlab=25,Pinsi=200,S=35,Pt=0,Sit=0)
</code></pre>

<hr>
<h2 id='pHnbs2sws'>Converts pH from NBS to SWS scale</h2><span id='topic+pHnbs2sws'></span>

<h3>Description</h3>

<p>Converts pH on NBS scale to pH on SWS scale pCO2. 
The NBS-to-SWS conversion is done with the total activity coefficient fH (combined activity coeff for H+, HSO4-, and HF)
from Takahashi et al. (1982) based on data from Culberson and Pytkowicz (1973). The approach is old and full of uncertainty.
Newer approaches are more complicated (Pitzer equations) and big uncertainties remain (Marion et al., 2011; Pilson, 2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pHnbs2sws(pHNBS, S=35, T=25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pHnbs2sws_+3A_phnbs">pHNBS</code></td>
<td>
<p>pH on NBS scale</p>
</td></tr>
<tr><td><code id="pHnbs2sws_+3A_s">S</code></td>
<td>
<p>Salinity on the practical salinity scale, default is 35</p>
</td></tr>
<tr><td><code id="pHnbs2sws_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The pHSWS is computed from pHNBS using the total activity coefficient and 
relying on the following basic chemistry equation: <code class="reqn"> ah = fH * hsws</code>, 
where  <code class="reqn">ah</code>  is the activity of hydrogen ion,
<code class="reqn">fH</code>  is the total activity coefficient, and
<code class="reqn">hsws = [H+] + [HSO4-] + [HF]</code>. In other words, 
<code class="reqn">hsws</code> is the hydrogen ion concentration on the seawater scale.
</p>
<p>The two pH scales are defined as <code class="reqn">pHNBS = -log10(ah)</code> and 
<code class="reqn">pHSWS = -log10(hsws)</code>.  
</p>


<h3>Value</h3>

<table>
<tr><td><code>pHSWS</code></td>
<td>
<p>pH on SWS scale</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James Orr <a href="mailto:james.orr@lsce.ipsl.fr">james.orr@lsce.ipsl.fr</a>
</p>


<h3>References</h3>

<p>Culberson, C.H., &amp; Pytkowicz, R.M. (1973). Ionization of water in seawater. 
<em>Marine Chemistry</em>, <b>1(4)</b>, 309-316.
</p>
<p>Marion G.M., Millero F.J., Camoes M.F., Spitzer P., Feistel R., Chen C.T.A. 2011. pH of seawater. 
<em>Marine Chemistry</em> <b>126</b> 89-96.
</p>
<p>Pilson M.E.Q. (2013) An introduction to the chemistry of the sea, 
2 edn. Cambridge, UK: Cambridge University Press.
</p>
<p>Takahashi T., Williams R.T., and Ros D.L. (1982) Carbonate chemistry. 
GEOSECS Pacific Expedition, Volume 3, Hydrographic Data 1973-1974, 77-83.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fH">fH</a></code> and <code><a href="#topic+pHsws2nbs">pHsws2nbs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Convert pHNBS to pHSWS
   pHNBS = 8.0                          # pH on the NBS scale
   pHSWS = pHnbs2sws(pHNBS, T=25, S=35) # pH on the SWS scale
   print(pHSWS)
## Check value: the result should be 7.853336
</code></pre>

<hr>
<h2 id='pHslope'>Slope of the calibration curve of a pH electrode</h2><span id='topic+pHslope'></span>

<h3>Description</h3>

<p>Slope of the calibration curve of a pH electrode (percent of theoretical slope)</p>


<h3>Usage</h3>

<pre><code class='language-R'>pHslope(Etris=-72.4,Eamp=4.9,S=35,T=25)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pHslope_+3A_etris">Etris</code></td>
<td>
<p>e.m.f. of the TRIS buffer in mV, default is -72.4</p>
</td></tr>
<tr><td><code id="pHslope_+3A_eamp">Eamp</code></td>
<td>
<p>e.m.f. of the AMP buffer in mV, default is 4.9</p>
</td></tr>
<tr><td><code id="pHslope_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="pHslope_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.</p>


<h3>Value</h3>

<table>
<tr><td><code>pHslope</code></td>
<td>
<p>Slope of the calibration curve (in percent of theoretical slope)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tris">tris</a></code>, <code><a href="#topic+amp">amp</a></code>, <code><a href="#topic+pH">pH</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	##Example from Dickson et al. (2007)
	pHslope(Etris=-72.4,Eamp=4.9,S=35,T=25)
</code></pre>

<hr>
<h2 id='pHspec'>Calculates pHT from results of spectrophotometric measurements</h2><span id='topic+pHspec'></span>

<h3>Description</h3>

<p>Calculates pH of a water sample from absorbance ratios R, obtained from spectrophotometric measurements with pH indicator dyes (on the total scale in mol/kg-soln)</p>


<h3>Usage</h3>

<pre><code class='language-R'>pHspec(S=35, T=25, R=1, d="mCP", k="m18", warn="y")

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pHspec_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="pHspec_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="pHspec_+3A_r">R</code></td>
<td>
<p>Absorbance ratio, default is 1</p>
</td></tr>
<tr><td><code id="pHspec_+3A_d">d</code></td>
<td>
<p>Dye used for spectrophotometric measurement, default is &quot;mCP&quot;</p>
</td></tr>
<tr><td><code id="pHspec_+3A_k">k</code></td>
<td>
<p>&quot;m18&quot; for using mCP characterization by Mueller and Rehder (2018)</p>
</td></tr> 
<tr><td><code id="pHspec_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when S and/or T go beyond the valid range for the chosen d and k; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model used to calculate the return value of this function is based on experimental data. It is critical to consider that the formulation refers to the conditions studied during the characterization experiment and is only valid for the studied ranges of temperature and salinity:
</p>

<ul>
<li><p> Mueller and Rehder (2018): S ranging between 0 and 40, T ranging between 5 and 35oC, and the dye used being m-Cresol purple (mCP) with R referring to the ratio of absorbances at wavelengths 578 and 434 nm.
</p>
</li></ul>

<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>pHspec</code></td>
<td>
<p>The function returns the pH value of a water sample from absorbance ratios R, obtained from spectrophotometric measurements with pH indicator dyes (on the total scale in mol/kg-soln)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jens Daniel Mueller <a href="mailto:jens.mueller@io-warnemuende.de">jens.mueller@io-warnemuende.de</a>
Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Mueller, J. D. and Rehder, G., 2018 Metrology for pH Measurements in Brackish Waters - Part 2: Experimental Characterization of Purified meta-Cresol Purple for Spectrophotometric pHT Measurements. <em>Frontiers in Marine Science</em> <b>5:177</b>, 1-9. https://doi.org/10.3389/fmars.2018.00177
</p>


<h3>See Also</h3>

<p><code><a href="#topic+amp">amp</a></code>, <code><a href="#topic+pHslope">pHslope</a></code>, <code><a href="#topic+pH">pH</a></code>. <code><a href="#topic+tris">tris</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	##Example should give test value pHT = 7.6713
	 pHspec(S=35, T=25, R=1, d="mCP", k="m18", warn="y")
</code></pre>

<hr>
<h2 id='pHsws2nbs'>Converts pH from SWS to NBS scale</h2><span id='topic+pHsws2nbs'></span>

<h3>Description</h3>

<p>Converts pH on SWS scale to pH on NBS scale pCO2. 
The SWS-to-NBS conversion is done with the total activity coefficient fH (combined activity coeff for H+, HSO4-, and HF)
from Takahashi et al. (1982) based on data from Culberson and Pytkowicz (1973). The approach is old and full of uncertainty.
Newer approaches are more complicated (Pitzer equations) and big uncertainties remain (Marion et al., 2011; Pilson, 2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pHsws2nbs(pHSWS, S=35, T=25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pHsws2nbs_+3A_phsws">pHSWS</code></td>
<td>
<p>pH on SWS scale</p>
</td></tr>
<tr><td><code id="pHsws2nbs_+3A_s">S</code></td>
<td>
<p>Salinity on the practical salinity scale, default is 35</p>
</td></tr>
<tr><td><code id="pHsws2nbs_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The pHNBS is computed from pHSWS using the total activity coefficient and 
relying on the following basic chemistry equation: <code class="reqn"> ah = fH * hsws</code>, 
where  <code class="reqn">ah</code>  is the activity of hydrogen ion,
<code class="reqn">fH</code>  is the total activity coefficient, and
<code class="reqn">hsws = [H+] + [HSO4-] + [HF]</code>. In other words, 
<code class="reqn">hsws</code> is the hydrogen ion concentration on the seawater scale.
</p>
<p>The two pH scales are defined as <code class="reqn">pHNBS = -log10(ah)</code> and 
<code class="reqn">pHSWS = -log10(hsws)</code>.  
</p>


<h3>Value</h3>

<table>
<tr><td><code>pHNBS</code></td>
<td>
<p>pH on NBS scale</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James Orr <a href="mailto:james.orr@lsce.ipsl.fr">james.orr@lsce.ipsl.fr</a>
</p>


<h3>References</h3>

<p>Culberson, C.H., &amp; Pytkowicz, R.M. (1973). Ionization of water in seawater. 
<em>Marine Chemistry</em>, <b>1(4)</b>, 309-316.
</p>
<p>Marion G.M., Millero F.J., Camoes M.F., Spitzer P., Feistel R., Chen C.T.A. 2011. pH of seawater. 
<em>Marine Chemistry</em> <b>126</b> 89-96.
</p>
<p>Pilson M.E.Q. (2013) An introduction to the chemistry of the sea, 
2 edn. Cambridge, UK: Cambridge University Press.
</p>
<p>Takahashi T., Williams R.T., and Ros D.L. (1982) Carbonate chemistry. 
GEOSECS Pacific Expedition, Volume 3, Hydrographic Data 1973-1974, 77-83.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fH">fH</a></code> and <code><a href="#topic+pHnbs2sws">pHnbs2sws</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Convert pHSWS to pHNBS
   pHSWS = 7.853336                     # pH on the SWS scale
   pHNBS = pHsws2nbs(pHSWS, T=25, S=35) # pH on the NBS scale
   print(pHNBS)
## Check value: the result should be 8.0
</code></pre>

<hr>
<h2 id='pmix'>pmix</h2><span id='topic+pmix'></span>

<h3>Description</h3>

<p>Calculates the carbonate chemistry after mixing of two water samples with different pCO2</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmix(flag, var1, var2, pCO2s, wf, S=35, T=20, P=0, Pt=0, Sit=0, k1k2="x", 
	kf="x", ks="d", pHscale="T", b="u74", eos = "eos80", long = 1e+20, lat = 1e+20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmix_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="pmix_+3A_var1">var1</code></td>
<td>
<p>Value of the first variable in mol/kg except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="pmix_+3A_var2">var2</code></td>
<td>
<p>Value of the second variable in mol/kg except for pH</p>
</td></tr>
<tr><td><code id="pmix_+3A_pco2s">pCO2s</code></td>
<td>
<p>Partial pressure of the high CO2 component in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="pmix_+3A_wf">wf</code></td>
<td>
<p>Weight fraction of the high CO2 seawater per kg seawater</p>
</td></tr>
<tr><td><code id="pmix_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="pmix_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="pmix_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="pmix_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg</p>
</td></tr>
<tr><td><code id="pmix_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg</p>
</td></tr>
<tr><td><code id="pmix_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="pmix_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="pmix_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickon (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="pmix_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="pmix_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot;.</p>
</td></tr>
<tr><td><code id="pmix_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="pmix_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="pmix_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>comment</code></td>
<td>
<p>The initial or final state water</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Pressure in bar</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>CO2 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>pCO2, CO2 partial pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>fCO2, CO2 fugacity (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>HCO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>CO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>DIC concentration (mol/kg)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>Omega calcite, calcite saturation state</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso and Heloise Lavigne<a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G. and Riley J. P., 1979 The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base. I. The ionic product of water. <em>Marine Chemistry</em> <b>7</b>, 89-99.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Gattuso J.-P. and Lavigne H., 2009. Perturbation experiments to investigate the impact of ocean acidification: approaches and software tools. <em>Biogeosciences</em> <b>6</b>, 4413-4439.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006 Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Marine Chemistry 165, 66-67.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pmix(flag=24, var1=384, var2=2302e-6, pCO2s=1e6, wf=0.003, S=34.3, 
	T=16, P=0, pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")
</code></pre>

<hr>
<h2 id='ppH'>ppH</h2><span id='topic+ppH'></span>

<h3>Description</h3>

<p>Calculates the carbonate chemistry after pH manipulations through addition of acid or base</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppH(flag, sys, var1, var2, pCO2a, vol, N, S=35, T=20, P=0, Pt=0, 
	Sit=0, pHscale="T", k1k2="x", kf="x", ks="d", eos = "eos80", 
	long = 1e+20, lat = 1e+20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppH_+3A_flag">flag</code></td>
<td>
<p>Select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="ppH_+3A_sys">sys</code></td>
<td>
<p>0 if the manipulation is carried out in a system closed to the atmosphere or 1 if its is carried out in a system open to the atmosphere</p>
</td></tr>
<tr><td><code id="ppH_+3A_var1">var1</code></td>
<td>
<p>Value of the first variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="ppH_+3A_var2">var2</code></td>
<td>
<p>Value of the second variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="ppH_+3A_pco2a">pCO2a</code></td>
<td>
<p>CO2 partial pressure in the atmosphere pCO2 in <code class="reqn">\mu</code>atm. It is only used in systems open to the atmosphere (i.e. when sys=1)</p>
</td></tr>
<tr><td><code id="ppH_+3A_vol">vol</code></td>
<td>
<p>Volume of acid or base added in liter. By convention, it is given a negative sign for acid additions and a positive sign for base additions. The acid must be fortified with NaCl in order to have the same salinity than seawater.</p>
</td></tr>
<tr><td><code id="ppH_+3A_n">N</code></td>
<td>
<p>Normality of the acid or base in mol/kg</p>
</td></tr>
<tr><td><code id="ppH_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="ppH_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="ppH_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="ppH_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg</p>
</td></tr>
<tr><td><code id="ppH_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg</p>
</td></tr>
<tr><td><code id="ppH_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="ppH_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="ppH_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickon (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="ppH_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for using the total scale, &quot;F&quot; for using the free scale and &quot;SWS&quot; for using the seawater scale, default is total scale</p>
</td></tr>
<tr><td><code id="ppH_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="ppH_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="ppH_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>comment</code></td>
<td>
<p>The initial or final state water</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Pressure in bar</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>CO2 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>pCO2, CO2 partial pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>fCO2, CO2 fugacity (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>HCO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>CO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>DIC concentration (mol/kg)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>Omega calcite, calcite saturation state</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso and Heloise Lavigne<a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
</p>
<p>Gattuso J.-P. and Lavigne H., 2009 Perturbation experiments to investigate the impact of ocean acidification: approaches and software tools. <em>Biogeosciences</em> <b>6</b>, 4413-4439.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006 Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Marine Chemistry 165, 66-67.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+buffer">buffer</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ppH(flag=24, sys=0, var1=384, var2=2302e-6, pCO2a=384, vol=-12e-3, 
	N=0.01, S=34.3, T=16, P=0, pHscale="T", kf="pf", k1k2="l", ks="d")

ppH(flag=24, sys=1, var1=384, var2=2302e-6, pCO2a=384, vol=-12e-3, 
	N=0.01, S=34.3, T=16, P=0, pHscale="T", kf="pf", k1k2="l", ks="d")
</code></pre>

<hr>
<h2 id='psi'>Molar ratio of CO2 released vs CaCO3 precipitated</h2><span id='topic+psi'></span>

<h3>Description</h3>

<p>Returns the molar ratio of CO2 released vs CaCO3 precipitated described by Frankignoulle et al. (1994).</p>


<h3>Usage</h3>

<pre><code class='language-R'>psi(flag, var1, var2, S=35, T=20, Patm, P=0, Pt=0, Sit=0, pHscale="T", 
	kf="x", k1k2="x", ks="d", eos = "eos80", long = 1e+20, lat = 1e+20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psi_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="psi_+3A_var1">var1</code></td>
<td>
<p>enter value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="psi_+3A_var2">var2</code></td>
<td>
<p>enter value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="psi_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="psi_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="psi_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="psi_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="psi_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="psi_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="psi_+3A_phscale">pHscale</code></td>
<td>
<p>choice of pH scale: &quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="psi_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="psi_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="psi_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickon (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr>
<tr><td><code id="psi_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="psi_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="psi_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>psi</code></td>
<td>
<p>ratio of CO2 released vs CaCO3 precipitated (mol/mol)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso and Heloise Lavigne <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
</p>
<p>Frankignoulle M., 1994 A complete set of buffer factors for acid/base CO2 system in seawater. <em>Journal of Marine Systems</em> <b>5</b>, 111-118.
</p>
<p>Frankignoulle M., Canon C. and Gattuso J.P., 1994 Marine calcification as a source of carbon dioxide- Positive feedback of increasing atmospheric CO2. <em>Limnology and Oceanography</em> <b>2</b>, 458-462.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006 Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Marine Chemistry 165, 66-67.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+speciation">speciation</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Calculation using the numerical example given in Frankignoulle et al. (1994)
psi(flag=24, var1=350, var2=2400e-6, S=35, T=25, P=0, Pt=0, 
	Sit=0, pHscale="T", kf="pf", k1k2="l", ks="d")
</code></pre>

<hr>
<h2 id='pTA'>pTA</h2><span id='topic+pTA'></span>

<h3>Description</h3>

<p>Calculates the carbonate chemistry following addition of <code class="reqn">CO_3^{2-}</code> or <code class="reqn">HCO_3^-</code></p>


<h3>Usage</h3>

<pre><code class='language-R'>pTA(flag, sys=0, var1, var2, pCO2a, co3, hco3, S=35, T=20, P=0, 
	Pt=0, Sit=0, k1k2="x", kf="x", ks="d", pHscale="T", b="u74", 
	eos = "eos80", long = 1e+20, lat = 1e+20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pTA_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="pTA_+3A_sys">sys</code></td>
<td>
<p>0 if the manipulation is carried out in a system closed to the atmosphere or 1 if its is carried out in a system open to the atmosphere</p>
</td></tr>
<tr><td><code id="pTA_+3A_var1">var1</code></td>
<td>
<p>Value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="pTA_+3A_var2">var2</code></td>
<td>
<p>Value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="pTA_+3A_pco2a">pCO2a</code></td>
<td>
<p>CO2 partial pressure in the atmosphere pCO2 in <code class="reqn">\mu</code>atm. It is only used in systems open to the atmosphere (i.e. when sys=1)</p>
</td></tr>
<tr><td><code id="pTA_+3A_co3">co3</code></td>
<td>
<p>Amount of <code class="reqn">CO_3^{2-}</code> added in <code class="reqn">mol\,kg^{-1}</code></p>
</td></tr>
<tr><td><code id="pTA_+3A_hco3">hco3</code></td>
<td>
<p>Amount of <code class="reqn">HCO_3^{2-}</code> added in <code class="reqn">mol\,kg^{-1}</code></p>
</td></tr>
<tr><td><code id="pTA_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="pTA_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="pTA_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="pTA_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg</p>
</td></tr>
<tr><td><code id="pTA_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg</p>
</td></tr>
<tr><td><code id="pTA_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="pTA_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="pTA_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickon (1990), &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="pTA_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="pTA_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot;.</p>
</td></tr>
<tr><td><code id="pTA_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="pTA_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="pTA_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For K0:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>comment</code></td>
<td>
<p>The initial or final state water</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Pressure in bar</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>CO2 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>pCO2, CO2 partial pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>fCO2, CO2 fugacity (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>HCO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>CO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>DIC concentration (mol/kg)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>Omega calcite, calcite saturation state</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G. and Riley J. P., 1979 The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base. I. The ionic product of water. <em>Marine Chemistry</em> <b>7</b>, 89-99.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Gattuso J.-P. and Lavigne H., 2009 Perturbation experiments to investigate the impact of ocean acidification: approaches and software tools. <em>Biogeosciences</em> <b>6</b>, 4413-4439.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Millero F. J., 1995 Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010 Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006 Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Marine Chemistry 165, 66-67.
</p>
<p>Weiss, R. F., 1974. Carbon dioxide in water and seawater: the solubility of
a non-ideal gas, <em>Mar.  Chem.</em>, <b>2</b>, 203-215.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pTA(flag=24, sys=0, var1=384, var2=2302e-6, pCO2a=384, co3=260e-6, 
	hco3=1000e-6, S=34.3, T=16, P=0, pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")

pTA(flag=24, sys=1, var1=384, var2=2302e-6, pCO2a=384, co3=260e-6, 
	hco3=1000e-6, S=34.3, T=16, P=0, pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")
</code></pre>

<hr>
<h2 id='rho'>Density of seawater  (kg/m3)</h2><span id='topic+rho'></span>

<h3>Description</h3>

<p>Calculates the density of seawater (<code class="reqn">kg\ m^{-3}</code>)</p>


<h3>Usage</h3>

<pre><code class='language-R'>rho(S = 35, T = 25, P = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rho_+3A_s">S</code></td>
<td>
<p>Practical Salinity (PSS-78), default is 35</p>
</td></tr>
<tr><td><code id="rho_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius (ITS-90), default is 25oC</p>
</td></tr>
<tr><td><code id="rho_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0), default is 0</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>rho</code></td>
<td>
<p>Density of seawater (kg/m3)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aurelien Proye and Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Millero F. J. and Poisson A., 1981 International one-atmosphere equation of state of seawater. <em>Deep-Sea Research</em> <b>28A</b>, 625-629.</p>


<h3>Examples</h3>

<pre><code class='language-R'>	rho(35,25,0)
</code></pre>

<hr>
<h2 id='sa2sp_chem'>From absolute to practical salinity</h2><span id='topic+sa2sp_chem'></span>

<h3>Description</h3>

<p>Converts from absolute to practical salinity (SP). Salinity conversion depends on total alkalinity as well as the concentrations of dissolved inorganic carbon, nitrate and silicate.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sa2sp_chem(SA, TA=2300e-6, DIC=2000e-6, NO3=0, SIOH4=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sa2sp_chem_+3A_sa">SA</code></td>
<td>
<p>Absolute salinity in g/kg</p>
</td></tr>
<tr><td><code id="sa2sp_chem_+3A_ta">TA</code></td>
<td>
<p>Total alkalinity, in mol/kg, default is 2300 √Ç¬µmol/kg</p>
</td></tr>
<tr><td><code id="sa2sp_chem_+3A_dic">DIC</code></td>
<td>
<p>Dissolved inorganic carbon concentration in mol/kg, default is 2000 √Ç¬µmol/kg</p>
</td></tr>
<tr><td><code id="sa2sp_chem_+3A_no3">NO3</code></td>
<td>
<p>Total nitrate concentration in mol/kg, default is 0</p>
</td></tr>
<tr><td><code id="sa2sp_chem_+3A_sioh4">SIOH4</code></td>
<td>
<p>Total silicate concentration in mol/kg, default is 0</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Convert from absolute to practical salinity from carbon system parameters and ion concentration which most affect water density anomalies.
</p>


<h3>Value</h3>

<table>
<tr><td><code>SP</code></td>
<td>
<p>Practical salinity (in psu)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon
</p>


<h3>References</h3>

<p>McDougall T. J., Jackett D. R., Millero F. J., Pawlowicz R. and Barker P. M., 2012. A global algorithm for estimating Absolute Salinity. <em>Ocean Science</em> <b>8</b>, 1123-1134.
</p>
<p>Pawlowicz R., Wright D. G. and Millero F. J., 2011. The effects of biogeochemical processes on oceanic conductivity/salinity/density relationships and the characterization of real seawater. <em>Ocean Science</em> <b>7</b>, 363-387.
</p>
<p>Pawlowicz R., 2013. What every oceanographer needs to know about TEOS-10 (The TEOS-10 Primer). http://www.teos-10.org/
</p>


<h3>See Also</h3>

<p>sp2sa_chem does the reverse, sa2sp_geo
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Calculate the practical salinity of a sample with Absolute Salinity of 35 g/kg,
   # Total Alkalinity of 0.00234 mol/kg and DIC of 0.00202 mol/kg
   SP &lt;- sa2sp_chem(SA=35, TA=0.00234, DIC=0.00202)
</code></pre>

<hr>
<h2 id='sa2sp_geo'>From absolute to practical salinity</h2><span id='topic+sa2sp_geo'></span>

<h3>Description</h3>

<p>Converts from absolute to practical salinity based on depth and geographic location.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sa2sp_geo(SA, P=0, long=1.e20, lat=1.e20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sa2sp_geo_+3A_sa">SA</code></td>
<td>
<p>Absolute salinity in g/kg</p>
</td></tr>
<tr><td><code id="sa2sp_geo_+3A_p">P</code></td>
<td>
<p>Sea water pressure in dbar</p>
</td></tr>
<tr><td><code id="sa2sp_geo_+3A_long">long</code></td>
<td>
<p>Longitude in decimal degrees [ 0 ... +360 ] or  [ -180 ... +180 ]</p>
</td></tr>
<tr><td><code id="sa2sp_geo_+3A_lat">lat</code></td>
<td>
<p>Latitude in decimal degrees [-90 ... 90]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is almost an alias of subroutine gsw_SP_from_SA from gsw package on which it relies. The only difference is in that depth and location are optional. If location is not given, or incomplete (either longitude or latitude missing), an arbitrary location is chosen: the mid equatorial atlantic ocean. Note that this implies an error on computed SA ranging from 0 up to 0.02 g/kg.
</p>


<h3>Value</h3>

<table>
<tr><td><code>SP</code></td>
<td>
<p>Practical salinity (psu)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon
</p>


<h3>References</h3>

<p>McDougall T. J., Jackett D. R., Millero F. J., Pawlowicz R. and Barker P. M., 2012. A global algorithm for estimating Absolute Salinity. <em>Ocean Science</em> <b>8</b>, 1123-1134.
</p>
<p>Pawlowicz R., 2013. What every oceanographer needs to know about TEOS-10 (The TEOS-10 Primer). http://www.teos-10.org/
</p>


<h3>See Also</h3>

<p>sp2sa_geo does the reverse, sa2sp_chem
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Calculate the practical salinity of a sample whose absolute Salinity is 35,
   # depth is 10 dbar and location is 188 degrees East and 4 degrees North.
   SP &lt;- sa2sp_geo(35, 10, 188, 4)
</code></pre>

<hr>
<h2 id='seacarb_test_P0'>Test data file (at P=0) to test the use of the carb function</h2><span id='topic+seacarb_test_P0'></span>

<h3>Description</h3>

<p>The variables are:
</p>

<ul>
<li><p> Flag indicating which couple of variables is used
</p>
</li>
<li><p> Value of the first variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm
</p>
</li>
<li><p> Value of the second variable in mol/kg, except for pH
</p>
</li>
<li><p> Salinity
</p>
</li>
<li><p> Temperature in degrees Celsius
</p>
</li>
<li><p> Hydrostatic pressure in bar (surface = 0)
</p>
</li>
<li><p> Value of the concentration of total phosphate in mol/kg
</p>
</li>
<li><p> Value of the total silicate in mol/kg
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>seacarb_test_P0</code></pre>


<h3>Format</h3>

<p>A data frame with 20 rows and 8 variables</p>


<h3>Source</h3>

<p>None, these data were invented for this purpose. The input variables were chosen in order to check that the carbonate chemistry is identical for all flags.</p>

<hr>
<h2 id='seacarb_test_P300'>Test data file (at P=300) to test the use of the carb function</h2><span id='topic+seacarb_test_P300'></span>

<h3>Description</h3>

<p>The variables are:
</p>

<ul>
<li><p> Flag indicating which couple of variables is used
</p>
</li>
<li><p> Value of the first variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm
</p>
</li>
<li><p> Value of the second variable in mol/kg, except for pH
</p>
</li>
<li><p> Salinity
</p>
</li>
<li><p> Temperature in degrees Celsius
</p>
</li>
<li><p> Hydrostatic pressure in bar (P=300)
</p>
</li>
<li><p> Value of the concentration of total phosphate in mol/kg
</p>
</li>
<li><p> Value of the total silicate in mol/kg
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>seacarb_test_P300</code></pre>


<h3>Format</h3>

<p>A data frame with 20 rows and 8 variables</p>


<h3>Source</h3>

<p>None, these data were invented for this purpose. The input variables were chosen in order to check that the carbonate chemistry is identical for all flags.</p>

<hr>
<h2 id='seaFET'>Test seaFET data file</h2><span id='topic+seaFET'></span>

<h3>Description</h3>

<p>Short test file for using with functions sf_calc and sf_calib. It is an excerpt of a file produced by a SeaFET pH sensor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seaFET</code></pre>


<h3>Format</h3>

<p>A data frame with 8 variables (datetime, Eint, Eext, Salinity, Temperature, pHspectro, E0int25, E0ext25) and 10 rows
</p>

<hr>
<h2 id='sf_calc'>Calculation of calibrated pH for seaFET sensor</h2><span id='topic+sf_calc'></span>

<h3>Description</h3>

<p>The function sf_calc() calculates pH time series (pHint_tot and pHext_tot) for SeaFET pH sensors, using calibration coefficients E0int25 and E0ext25 from the function sf_calib(). Both functions are R-adaptations from MATLAB scripts published by Bresnahan et al. (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sf_calc(calEint=0.0865, calEext= -0.93, E0int25 =-0.39, 
  E0ext25=-1.46, calT=16.2, calSal=35.6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sf_calc_+3A_caleint">calEint</code></td>
<td>
<p>EINT (V), default is 0.0865</p>
</td></tr>
<tr><td><code id="sf_calc_+3A_caleext">calEext</code></td>
<td>
<p>EEXT (V), default is -0.93</p>
</td></tr>
<tr><td><code id="sf_calc_+3A_e0int25">E0int25</code></td>
<td>
<p>Coeficient of calibration related to the internal sensor and obtained via sf_calib function, default is -0.39. If time-serie, we use the mean per periode of deployement</p>
</td></tr>
<tr><td><code id="sf_calc_+3A_e0ext25">E0ext25</code></td>
<td>
<p>Coeficient of calibration related to the external sensor and obtained via sf_calib function, default is -1.46. If time-serie, we use the mean per periode of deployement</p>
</td></tr>
<tr><td><code id="sf_calc_+3A_calt">calT</code></td>
<td>
<p>Temperature in degrees Celsius, default is 16.2</p>
</td></tr>
<tr><td><code id="sf_calc_+3A_calsal">calSal</code></td>
<td>
<p>Salinity, default is 35.6</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input values should be vectors of equal length. E0int25 and E0ext25 should be constant throughout the time series. When multiple reference samples are available for one SeaFET deployment, mean E0int25 and mean E0ext25 should be calculated and used in sf_calc(). Each unique SeaFET deployment requires a new calculation of mean E0int25 and mean E0ext25 based on reference pH samples (total hydrogen ion scale). For detailed SeaFET calibration instructions and recommendations see Bresnahan et al. (2014) and Rivest et al. (2016).
</p>


<h3>Value</h3>

<p>This function returns a dataframe comprising 2 variables: 
</p>
<table>
<tr><td><code>pHint_tot</code></td>
<td>
<p>Calibrated pH of the internal sensor at in situ temperature.</p>
</td></tr>
<tr><td><code>pHext_tot</code></td>
<td>
<p>Calibrated pH of the external sensor at in situ temperature.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Samir Alliouane, Lydia Kapsenberg, Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Bresnahan, P. J. J., Martz, T. R., Takeshita, Y., Johnson, K. S., and LaShomb, M., 2014. Best practices for autonomous measurement of seawater pH with the Honeywell Durafet. <em>Methods Oceanogr.</em> <b>9</b>, 44-60.
</p>
<p>Martz, T.R., Connery, J.G., and Johnson, K.S., 2010. Testing the Honeywell Durafet for seawater pH applications. <em>Limnol. Oceanogr. Meth.</em> <b>8</b>, 172-184.
</p>
<p>Rivest, E.B., O'Brien, M., Kapsenberg, L., Gotschalk, C.C., Blanchette, C.A., Hoshijima, U., and Hofmann, G.E., 2016. Beyond the benchtop and the benthos: dataset management planning and design for time series of ocean carbonate chemistry associated with Durafet(c)-based pH sensors. <em>Ecological Informatics</em> <b>36</b>, 209-220.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sf_calib">sf_calib</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sf_calc(calEint=0.0865, calEext= -0.93, E0int25 =-0.39, 
  E0ext25=-1.46, calT=16.2, calSal=35.6)

## Using the test file seaFET
sf_calc(calEint=seaFET$Eint, calEext=seaFET$Eext, 
  E0int25=seaFET$E0int25, E0ext25=seaFET$E0ext25, 
  calT=seaFET$Temperature, calSal=seaFET$Salinity)
</code></pre>

<hr>
<h2 id='sf_calib'>Calibration coefficients for seaFET sensor</h2><span id='topic+sf_calib'></span>

<h3>Description</h3>

<p>Calibration coefficients E0INT,25, E0EXT,25</p>


<h3>Usage</h3>

<pre><code class='language-R'>sf_calib(calEint=0.0865, calEext=-0.93, calpH=8.132, calT=16.2, calSal=35.6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sf_calib_+3A_caleint">calEint</code></td>
<td>
<p>EINT (V), default is 0.0865</p>
</td></tr>
<tr><td><code id="sf_calib_+3A_caleext">calEext</code></td>
<td>
<p>EEXT (V), default is -0.93</p>
</td></tr>
<tr><td><code id="sf_calib_+3A_calph">calpH</code></td>
<td>
<p>spectrophotometric pH in Total scale, default is 8.132</p>
</td></tr>
<tr><td><code id="sf_calib_+3A_calt">calT</code></td>
<td>
<p>Temperature in degrees Celsius, default is 16.2</p>
</td></tr>
<tr><td><code id="sf_calib_+3A_calsal">calSal</code></td>
<td>
<p>Salinity, default is 35.6</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Outputs E0INT25 and E0EXT25 must be calculated for each reference sample collected during a SeaFET deployment. Multiple E0INT25 and E0EXT25 may be calculated if there is more than one reference sample for a given deployment. As such, arguments can be given as unique numbers or as vectors (vectors should be of the same length).
</p>
<p>It is critical that Eint (calEint) and Eext (calEext) recorded by the SeaFET match reference sample measurements of temperature (calT), salinity (calSal), and spectrophotometric pH (calpH, total hydrogen ion scale) taken at the same time. Note that SeaFET temperature measurements may require calibration via an applied offset. When possible, calibrated CTD temperature and salinity measurements may be used, while spectrophotometric pH measurements always require discrete 'reference' water samples (unless in situ, certified, seawater-based, Tris pH buffer is used). The accepted time offset between collection of reference samples and SeaFET measurements depends on the hydrology and pH variability of the location. For detailed SeaFET calibration instructions and recommendations see Bresnahan et al. (2014) and Rivest et al. (2016).
</p>


<h3>Value</h3>

<p>This function returns a dataframe comprising 2 variables: 
</p>
<table>
<tr><td><code>E0int25</code></td>
<td>
<p>Calibration coefficients of the internal sensor at 25oC.</p>
</td></tr>
<tr><td><code>E0ext25</code></td>
<td>
<p>Calibration coefficients of the external sensor at 25oC.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Samir Alliouane, Lydia Kapsenberg, Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Bresnahan, P. J. J., Martz, T. R., Takeshita, Y., Johnson, K. S., and LaShomb, M., 2014. Best practices for autonomous measurement of seawater pH with the Honeywell Durafet. <em>Methods Oceanogr.</em> <b>9</b>, 44-60.
</p>
<p>Martz, T.R., Connery, J.G., and Johnson, K.S., 2010. Testing the Honeywell Durafet for seawater pH applications. <em>Limnol. Oceanogr. Meth.</em> <b>8</b>, 172-184.
</p>
<p>Rivest, E.B., O'Brien, M., Kapsenberg, L., Gotschalk, C.C., Blanchette, C.A., Hoshijima, U., and Hofmann, G.E., 2016. Beyond the benchtop and the benthos: dataset management planning and design for time series of ocean carbonate chemistry associated with Durafet(c)-based pH sensors. <em>Ecological Informatics</em> <b>36</b>, 209-220.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sf_calc">sf_calc</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sf_calib(calEint=0.0865, calEext=-0.93, calpH=8.132, calT=16.2, calSal=35.6)

## Using the test file seaFET
sf_calib(calEint=seaFET$Eint, calEext=seaFET$Eext, 
  calpH=seaFET$pHspectro, calT=seaFET$Temperature, 
  calSal=seaFET$Salinity)
</code></pre>

<hr>
<h2 id='sir'>
Parameters of the seawater carbonate system including the substrate-inhibitor-ratio (SIR)
</h2><span id='topic+sir'></span>

<h3>Description</h3>

<p>This function is a modification of <em>carb</em>. It returns parameters of the seawater carbonate system, as well as additional parameters relevant to the substrate-inhibitor-ratio (SIR).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sir(flag, var1, var2, S = 35, T = 25, Patm = 1, P = 0, 
               Pt = 0, Sit = 0, k1k2 = "x", kf = "x", ks = "d", pHscale = "T", 
               b = "u74", gas = "potential", warn = "y", eos = "eos80", 
               long = 1e+20, lat = 1e+20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sir_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="sir_+3A_var1">var1</code></td>
<td>
<p>Value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="sir_+3A_var2">var2</code></td>
<td>
<p>Value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="sir_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="sir_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="sir_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="sir_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="sir_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="sir_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="sir_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="sir_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="sir_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickson (1990) and &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="sir_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="sir_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="sir_+3A_gas">gas</code></td>
<td>
<p>used to indicate the convention for INPUT pCO2, i.e., when it is an input variable (flags 21 to 25): &quot;insitu&quot; indicates it is referenced to in situ pressure and in situ temperature; &quot;potential&quot; indicates it is referenced to 1 atm pressure and potential temperature; and &quot;standard&quot; indicates it is referenced to 1 atm pressure and in situ temperature. All three options should give identical results at surface pressure. This option is not used when pCO2 is not an input variable (flags 1 to 15). The default is &quot;potential&quot;.</p>
</td></tr>
<tr><td><code id="sir_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for constants; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
<tr><td><code id="sir_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="sir_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="sir_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the &quot;substrate-inhibitor ratio (SIR)&quot; (i.e. [HCO3-]/[H+]) which is used as a metric to predict carbonate chemistry dependency of biotic calcium carbonate formation (Bach, 2015).  Please note that hydrogen ion concentrations in the output [HCO3-]/[H+] are on the <em>free scale</em>, regardless of the input pH scale. We have included pH and [H+] outputs on multiple scales as a teaching exercise to show how calculating the SIR on different scales changes its meaning.
</p>
<p>The function is based on <em>carb</em> and therefore also returns parameters of the seawater carbonate system.
</p>
<p><b><em>carb</em> details</b>:
</p>
<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code>Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Hydrostatic pressure in bar</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>CO2 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>&quot;standard&quot; pCO2, CO2 partial pressure computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>&quot;standard&quot; fCO2, CO2 fugacity computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2pot</code></td>
<td>
<p>&quot;potential&quot; pCO2, CO2 partial pressure computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2pot</code></td>
<td>
<p>&quot;potential&quot; fCO2, CO2 fugacity computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; pCO2, CO2 partial pressure computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; fCO2, CO2 fugacity computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>HCO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>CO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>DIC concentration (mol/kg)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>Omega calcite, calcite saturation state</p>
</td></tr>
<tr><td><code>SIR</code></td>
<td>
<p>substrate inhibitor ratio: [HCO3]/[H_free] (mol:<code class="reqn">\mu</code>mol)</p>
</td></tr>
<tr><td><code>H_free</code></td>
<td>
<p>H ion concentration on free scale (<code class="reqn">\mu</code>mol/kg)</p>
</td></tr>
<tr><td><code>H_sws</code></td>
<td>
<p>H ion concentration on seawater scale (<code class="reqn">\mu</code>mol/kg)</p>
</td></tr>
<tr><td><code>H_t</code></td>
<td>
<p>H ion concentration on total scale (<code class="reqn">\mu</code>mol/kg)</p>
</td></tr>
<tr><td><code>pH_free</code></td>
<td>
<p>pH calculated on the free scale</p>
</td></tr>
<tr><td><code>pH_sws</code></td>
<td>
<p>pH calculated on the seawater scale</p>
</td></tr>
<tr><td><code>pH_t</code></td>
<td>
<p>pH calculated on the total scale</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>Kimberlee Baldry, Lennart Bach and Jean-Pierre Gattuso, 
<a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Bach L. T., 2015 Reconsidering the role of carbonate ion concentration in calcification by marine organisms. <em>Biogeosciences</em> <b>12</b>, 4939-4951.
</p>
<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G. and Riley J. P., 1979 The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base. I. The ionic product of water. <em>Marine Chemistry</em> <b>7</b>, 89-99.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen ion concentration in seawater from 5 to 40oC: standard potentials at salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 1995. Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010. Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b>, 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Marine Chemistry <b>165</b>, 66-67.
</p>
<p>Weiss, R. F., 1974. Carbon dioxide in water and seawater: the solubility of a non-ideal gas, <em>Mar.  Chem.</em>, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A., 1980. Nitrous oxide solubility in water and seawater, <em>Marine Chemistry</em>, <b>8</b>, 347-359.
</p>
<p>Zeebe R. E. and Wolf-Gladrow D. A., 2001 <em>CO2 in seawater: equilibrium, kinetics, isotopes</em>. Amsterdam: Elsevier, 346 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## With a couple of variables
sir(flag=8, var1=8.2, var2=0.00234, S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0,
	pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")

## Using vectors as arguments
flag &lt;- c(8, 2, 8)
var1 &lt;- c(8.2, 7.477544e-06, 8.2)
var2 &lt;- c(0.002343955, 0.001649802, 2400e-6)
S &lt;- c(35, 35, 30)
T &lt;- c(25, 25, 30)
P &lt;- c(0, 0, 0)
Pt &lt;- c(0, 0, 0)
Sit &lt;- c(0, 0, 0)
kf &lt;- c("pf", "pf", "pf")
k1k2 &lt;- c("l", "l", "l")
pHscale &lt;- c("T", "T", "T")
b &lt;- c("l10", "l10", "l10")
sir(flag=flag, var1=var1, var2=var2, S=S, T=T, P=P,
  Pt=Pt, Sit=Sit, kf=kf, k1k2=k1k2, pHscale=pHscale, b=b)

## Test with all flags 
flag &lt;- c((1:15), (21:25))
var1 &lt;- c(8.200000, 7.308171e-06, 7.308171e-06, 7.308171e-06, 7.308171e-06, 
	8.2, 8.2, 8.2, 8.2, 0.001646857, 0.001646857, 0.001646857, 0.0002822957, 
	0.0002822957, 0.00234, 258.2164, 258.2164, 258.2164, 258.2164, 258.2164 )
var2 &lt;- c(7.308171e-06, 0.001646857, 0.0002822957, 0.00234, 0.001936461, 
	0.001646857, 0.0002822957, 0.00234, 0.001936461, 0.0002822957, 
	0.00234, 0.001936461,  0.00234, 0.001936461, 0.001936461, 8.2, 
	0.001646857, 0.0002822957, 0.00234, 0.001936461)
sir(flag=flag, var1=var1, var2=var2)

## Test using a data frame 
data(seacarb_test_P0)	#test data set for P=0 (surface)
tab &lt;- seacarb_test_P0[14:19,]

## method 1 using the column numbers
sir(flag=tab[[1]], var1=tab[[2]], var2=tab[[3]], S=tab[[4]], T=tab[[5]], 
P=tab[[6]], Sit=tab[[8]], Pt=tab[[7]])

## method 2 using the column names
sir(flag=tab$flag, var1=tab$var1, var2=tab$var2, S=tab$S, T=tab$T, 
P=tab$P, Sit=tab$Sit, Pt=tab$Pt)
</code></pre>

<hr>
<h2 id='sir_b'>
Parameters of the seawater carbonate system with boron addition, including the substrate-inhibitor-ratio (SIR)
</h2><span id='topic+sir_b'></span>

<h3>Description</h3>

<p>This function is a modification of <em>carbb</em>. It returns parameters of the seawater carbonate system when boron is added, as well as additional parameters relevant to the SIR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sir_b(flag, var1, var2, S=35, T=25, Patm=1, P=0, Pt=0, Sit=0, 
  k1k2="x", kf="x", ks="d", pHscale="T", b="u74", gas="potential", badd=0, 
  warn="y", eos = "eos80", long = 1e+20, lat = 1e+20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sir_b_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="sir_b_+3A_var1">var1</code></td>
<td>
<p>Value of the first  variable in mol/kg, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="sir_b_+3A_var2">var2</code></td>
<td>
<p>Value of the second  variable in mol/kg, except for pH</p>
</td></tr>
<tr><td><code id="sir_b_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="sir_b_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="sir_b_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="sir_b_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="sir_b_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="sir_b_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg; set to 0 if NA</p>
</td></tr>
<tr><td><code id="sir_b_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="sir_b_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="sir_b_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickson (1990) and &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="sir_b_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="sir_b_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="sir_b_+3A_gas">gas</code></td>
<td>
<p>used to indicate the convention for INPUT pCO2, i.e., when it is an input variable (flags 21 to 25): &quot;insitu&quot; indicates it is referenced to in situ pressure and in situ temperature; &quot;potential&quot; indicates it is referenced to 1 atm pressure and potential temperature; and &quot;standard&quot; indicates it is referenced to 1 atm pressure and in situ temperature. All three options should give identical results at surface pressure. This option is not used when pCO2 is not an input variable (flags 1 to 15). The default is &quot;potential&quot;.</p>
</td></tr>
<tr><td><code id="sir_b_+3A_badd">badd</code></td>
<td>
<p>Amount of boron added in mol/kg.</p>
</td></tr>
<tr><td><code id="sir_b_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when T or S go beyond the valid range for constants; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
<tr><td><code id="sir_b_+3A_eos">eos</code></td>
<td>
<p>&quot;teos10&quot; to specify T and S according to Thermodynamic Equation Of Seawater - 2010 (TEOS-10); &quot;eos80&quot; to specify T and S according to EOS-80.</p>
</td></tr>
<tr><td><code id="sir_b_+3A_long">long</code></td>
<td>
<p>longitude of data point, used when eos parameter is &quot;teos10&quot; as a conversion parameter from absolute to practical salinity.</p>
</td></tr>
<tr><td><code id="sir_b_+3A_lat">lat</code></td>
<td>
<p>latitude of data point, used when eos parameter is &quot;teos10&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the &quot;substrate-inhibitor ratio (SIR)&quot; (i.e. [HCO3-]/[H+]) which is used as a metric to predict carbonate chemistry dependency of biotic calcium carbonate formation (Bach, 2015).  Please note that hydrogen ion concentrations in the output [HCO3-]/[H+] are on the <em>free scale</em>, regardless of the input pH scale. We have included pH and [H+] outputs on multiple scales as a teaching exercise to show how calculating the SIR on different scales changes its meaning.
</p>
<p>The function is based on <em>carbb</em> and therefore also returns parameters of the seawater carbonate system when boron is added. 
</p>
<p><b><em>carbb</em> details</b>:
</p>
<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs and Ksi, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, The pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>

<p>long and lat are used as conversion parameters from absolute to practical salinity: when seawater is not of standard composition, practical salinity alone is not sufficient to compute absolute salinity and vice-versa. One needs to know the density. When long and lat are given, density is inferred from WOA silicate concentration at given location. When they are not, an arbitrary geographic point is chosen: mid equatorial Atlantic. Note that this implies an error on computed salinity up to 0.02 g/kg.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code>Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Hydrostatic pressure in bar</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>CO2 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>&quot;standard&quot; pCO2, CO2 partial pressure computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>&quot;standard&quot; fCO2, CO2 fugacity computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2pot</code></td>
<td>
<p>&quot;potential&quot; pCO2, CO2 partial pressure computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2pot</code></td>
<td>
<p>&quot;potential&quot; fCO2, CO2 fugacity computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; pCO2, CO2 partial pressure computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; fCO2, CO2 fugacity computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>HCO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>CO3 concentration (mol/kg)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>DIC concentration (mol/kg)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>Omega calcite, calcite saturation state</p>
</td></tr>
<tr><td><code>SIR</code></td>
<td>
<p>substrate inhibitor ratio: [HCO3]/[HCO3]/[H_free]  (mol:<code class="reqn">\mu</code>mol)</p>
</td></tr>
<tr><td><code>H_free</code></td>
<td>
<p>H ion concentration on free scale (<code class="reqn">\mu</code>mol/kg)</p>
</td></tr>
<tr><td><code>H_sws</code></td>
<td>
<p>H ion concentration on seawater scale (<code class="reqn">\mu</code>mol/kg)</p>
</td></tr>
<tr><td><code>H_t</code></td>
<td>
<p>H ion concentration on total scale (<code class="reqn">\mu</code>mol/kg)</p>
</td></tr>
<tr><td><code>pH_free</code></td>
<td>
<p>pH calculated on the free scale</p>
</td></tr>
<tr><td><code>pH_sws</code></td>
<td>
<p>pH calculated on the seawater scale</p>
</td></tr>
<tr><td><code>pH_t</code></td>
<td>
<p>pH calculated on the total scale</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>Kimberlee Baldry, Lennart Bach and Jean-Pierre Gattuso, 
<a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Bach L. T., 2015 Reconsidering the role of carbonate ion concentration in calcification by marine organisms. <em>Biogeosciences</em> <b>12</b>, 4939-4951.
</p>
<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen ion concentration in seawater from 5 to 40oC: standard potentials at salinities from 20 to 45. <em>Analytical Chemistry</em> <b>49</b>, 29-34. 
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 1995. Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010. Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Weiss, R. F., 1974. Carbon dioxide in water and seawater: the solubility of
a non-ideal gas, <em>Mar.  Chem.</em>, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A., 1980. Nitrous oxide solubility in water and
seawater, <em>Marine Chemistry</em>, <b>8</b>, 347-359.
</p>
<p>Zeebe R. E. and Wolf-Gladrow D. A., 2001 <em>CO2 in seawater: equilibrium, kinetics, isotopes</em>. Amsterdam: Elsevier, 346 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## With a couple of variables
sir_b(flag=8, var1=8.2, var2=0.00234, S=35, T=25, P=0, Patm=1.0, 
  Pt=0, Sit=0,pHscale="T", kf="pf", k1k2="l", ks="d", b="u74", badd=0)

</code></pre>

<hr>
<h2 id='sir_full'>
Parameters of the seawater carbonate system including the substrate-inhibitor-ratio (SIR) - extension of carb
</h2><span id='topic+sir_full'></span>

<h3>Description</h3>

<p>This function is a modification of carb. It returns parameters of the seawater carbonate system, including the ammonium and sulfide acid-base systems, as well as full acid-base speciation and additional parameters relevant to the SIR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sir_full(flag, var1, var2, S=35, T=25, Patm=1, P=0, Pt=0, Sit=0,
        k1k2="x", kf="x", ks="d", pHscale="T", b="u74", gas="potential",
        NH4t=0, HSt=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sir_full_+3A_flag">flag</code></td>
<td>
<p>select the couple of variables available. The flags which can be used are: 
</p>
<p>flag = 1      pH and CO2 given
</p>
<p>flag = 2      CO2 and HCO3 given
</p>
<p>flag = 3      CO2 and CO3 given
</p>
<p>flag = 4      CO2 and ALK given
</p>
<p>flag = 5      CO2 and DIC given
</p>
<p>flag = 6      pH and HCO3 given
</p>
<p>flag = 7      pH and CO3 given
</p>
<p>flag = 8      pH and ALK given
</p>
<p>flag = 9      pH and DIC given
</p>
<p>flag = 10     HCO3 and CO3 given
</p>
<p>flag = 11     HCO3 and ALK given
</p>
<p>flag = 12     HCO3 and DIC given
</p>
<p>flag = 13     CO3 and ALK given
</p>
<p>flag = 14     CO3 and DIC given
</p>
<p>flag = 15     ALK and DIC given
</p>
<p>flag = 21     pCO2 and pH given
</p>
<p>flag = 22     pCO2 and HCO3 given
</p>
<p>flag = 23     pCO2 and CO3 given
</p>
<p>flag = 24     pCO2 and ALK given
</p>
<p>flag = 25     pCO2 and DIC given
</p>
</td></tr>
<tr><td><code id="sir_full_+3A_var1">var1</code></td>
<td>
<p>Value of the first variable in mol/kg-soln, except for pH and for pCO2 in <code class="reqn">\mu</code>atm</p>
</td></tr>
<tr><td><code id="sir_full_+3A_var2">var2</code></td>
<td>
<p>Value of the second variable in mol/kg-soln, except for pH</p>
</td></tr>
<tr><td><code id="sir_full_+3A_s">S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code id="sir_full_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code id="sir_full_+3A_patm">Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm, default is 1 atm</p>
</td></tr>
<tr><td><code id="sir_full_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0)</p>
</td></tr>
<tr><td><code id="sir_full_+3A_pt">Pt</code></td>
<td>
<p>Concentration of total phosphate in mol/kg-soln; set to 0 if NA</p>
</td></tr>
<tr><td><code id="sir_full_+3A_sit">Sit</code></td>
<td>
<p>Concentration of total silicate in mol/kg-soln; set to 0 if NA</p>
</td></tr>
<tr><td><code id="sir_full_+3A_k1k2">k1k2</code></td>
<td>
<p>&quot;cw&quot; for using K1 and K2 from Cai &amp; Wang (1998), &quot;l&quot; from Lueker et al. (2000), &quot;m02&quot; from Millero et al. (2002), &quot;m06&quot; from Millero et al. (2006), &quot;m10&quot; from Millero (2010), &quot;mp2&quot; from Mojica Prieto et al. (2002), &quot;p18&quot; from Papadimitriou et al. (2018), &quot;r&quot; from Roy et al. (1993), &quot;sb21&quot; from Shockman &amp; Byrne (2021), &quot;s20&quot; from Sulpis et al. (2020), and &quot;w14&quot; from Waters et al. (2014). &quot;x&quot; is the default flag; the default value is then &quot;l&quot;, except if T is outside the range 2 to 35oC and/or S is outside the range 19 to 43. In these cases, the default value is &quot;w14&quot;.</p>
</td></tr>
<tr><td><code id="sir_full_+3A_kf">kf</code></td>
<td>
<p>&quot;pf&quot; for using Kf from Perez and Fraga (1987) and &quot;dg&quot; for using Kf from Dickson and Riley (1979 in Dickson and Goyet, 1994). &quot;x&quot; is the default flag; the default value is then &quot;pf&quot;, except if T is outside the range 9 to 33oC and/or S is outside the range 10 to 40. In these cases, the default is &quot;dg&quot;.</p>
</td></tr>
<tr><td><code id="sir_full_+3A_ks">ks</code></td>
<td>
<p>&quot;d&quot; for using Ks from Dickson (1990) and &quot;k&quot; for using Ks from Khoo et al. (1977), default is &quot;d&quot;</p>
</td></tr> 
<tr><td><code id="sir_full_+3A_phscale">pHscale</code></td>
<td>
<p>&quot;T&quot; for the total scale, &quot;F&quot; for the free scale and &quot;SWS&quot; for using the seawater scale, default is &quot;T&quot; (total scale)</p>
</td></tr>
<tr><td><code id="sir_full_+3A_b">b</code></td>
<td>
<p>Concentration of total boron. &quot;l10&quot; for the Lee et al. (2010) formulation or &quot;u74&quot; for the Uppstrom (1974) formulation, default is &quot;u74&quot; </p>
</td></tr>
<tr><td><code id="sir_full_+3A_gas">gas</code></td>
<td>
<p>used to indicate the convention for INPUT pCO2, i.e., when it is an input variable (flags 21 to 25): &quot;insitu&quot; indicates it is referenced to in situ pressure and in situ temperature; &quot;potential&quot; indicates it is referenced to 1 atm pressure and potential temperature; and &quot;standard&quot; indicates it is referenced to 1 atm pressure and in situ temperature. All three options should give identical results at surface pressure. This option is not used when pCO2 is not an input variable (flags 1 to 15). The default is &quot;potential&quot;.</p>
</td></tr>
<tr><td><code id="sir_full_+3A_nh4t">NH4t</code></td>
<td>
<p>Concentration of total ammonium in mol/kg-soln; set to 0 if NA</p>
</td></tr>
<tr><td><code id="sir_full_+3A_hst">HSt</code></td>
<td>
<p>Concentration of total hydrogen sulfide in mol/kg-soln; set to 0 if NA</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the &quot;substrate-inhibitor ratio (SIR)&quot; (i.e. [HCO3-]/[H+]) which is used as a metric to predict carbonate chemistry dependency of biotic calcium carbonate formation (Bach, 2015).  Please note that hydrogen ion concentrations in the output [HCO3-]/[H+] are on the <em>free scale</em>, regardless of the input pH scale. We have included pH and [H+] outputs on multiple scales as a teaching exercise to show how calculating the SIR on different scales changes its meaning.
</p>
<p>The function is based on <em>carbfull</em> and therefore also returns parameters of the seawater carbonate system, including the ammonium and sulfide acid- base systems, as well as full acid-base speciation.
</p>
<p><b><em>carbfull</em> details</b>:
</p>
<p>The Lueker et al. (2000) constants for K1 and K2, the Perez and Fraga (1987) constant for Kf and the Dickson (1990) constant for Ks are recommended by Dickson et al. (2007). It is, however, critical to consider that each formulation is only valid for specific ranges of temperature and salinity:
</p>
<p><em>For K1 and K2:</em>
</p>

<ul>
<li><p> Cai and Wang (1998): S ranging between 0 and 40 and T ranging between 0.2 and 30oC.
</p>
</li>
<li><p> Roy et al. (1993): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Lueker et al. (2000): S ranging between 19 and 43 and T ranging between 2 and 35oC.
</p>
</li>
<li><p> Mojica Prieto et al. (2002): S ranging from 5 to 42 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Millero et al. (2002): S ranging from 34 to 37 and T ranging between -1.6 and 35oC.
</p>
</li>
<li><p> Millero et al. (2006): S ranging between 0.1 and 50 and T ranging between 1 and 50oC.
</p>
</li>
<li><p> Millero (2010): S ranging between 1 and 50 and T ranging between 0 and 50oC. Millero (2010) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;. 
</p>
</li>
<li><p> Waters et al.(2014): S ranging between 1 and 50 and T ranging between 0 and 50oC. Waters (2014) provides a K1 and K2 formulation for the seawater, total and free pH scales. Therefore, when this method is used and if P=0, K1 and K2 are computed with the formulation corresponding to the pH scale given in the flag &quot;pHscale&quot;.
</p>
</li>
<li><p> Papadimitriou et al. (2018): S ranging from 33 to 100 and T ranging between -6 to 25oC.
</p>
</li>
<li><p> Sulpis et al. (2020): S ranging from 30.7 to 37.6 and T ranging between -1.7 to 31.8oC.
</p>
</li>
<li><p> Shockman &amp; Byrne (2021): for K2, S ranging from 19.6 to 41 and T ranging between 15 to 35oC. For K1, formulation is that of Waters et al.
</p>
</li></ul>

<p><em>For Kf:</em>
</p>

<ul>
<li><p> Perez and Fraga (1987): S ranging between 10 and 40 and T ranging between 9 and 33oC.
</p>
</li>
<li><p> Dickson and Riley (1979 in Dickson and Goyet, 1994): S ranging between 0 and 45 and T ranging between 0 and 45oC.
</p>
</li></ul>

<p><em>For Ks:</em>
</p>

<ul>
<li><p> Dickson (1990): S ranging between 5 and 45 and T ranging between 0 and 45oC.
</p>
</li>
<li><p> Khoo et al. (1977): S ranging between 20 and 45 and T ranging between 5 and 40oC.
</p>
</li></ul>

<p>The arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It is recommended to use either vectors with the same dimension or one vector for one argument and numbers for the other arguments.
</p>
<p><em>Pressure corrections and pH scale:</em>
</p>

<ul>
<li><p> For K0, the pressure correction term of Weiss (1974) is used.
</p>
</li>
<li><p> For K1, K2, pK1, pK2, pK3, Kw, Kb, Khs, Ksi and K2si, the pressure correction was applied on the seawater scale. Hence, if needed, values were first transformed from the total scale to the seawater scale, the pressure correction applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li>
<li><p> For Kf, the pressure correction was applied on the free scale. The formulation of Dickson and Riley (1979 in Dickson and Goyet, 1994) provides Kf on the free scale but that of Perez and Fraga (1987) provides it on the total scale. Hence, in that case, Kf was first transformed from the total scale to the free scale. With both formulations, the pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Ks, the pressure correction was applied on the free scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS). 
</p>
</li>
<li><p> For Kn, the pressure correction was applied on the seawater scale. The pressure correction was applied as described by Millero (1995), and the value was transformed back to the required scale (T, F or SWS).
</p>
</li></ul>



<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>S</code></td>
<td>
<p>Salinity</p>
</td></tr>
<tr><td><code>T</code></td>
<td>
<p>Temperature in degrees Celsius</p>
</td></tr>
<tr><td><code>Patm</code></td>
<td>
<p>Surface atmospheric pressure in atm</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Hydrostatic pressure in bar</p>
</td></tr>
<tr><td><code>pH</code></td>
<td>
<p>pH</p>
</td></tr>
<tr><td><code>CO2</code></td>
<td>
<p>CO2 concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>pCO2</code></td>
<td>
<p>&quot;standard&quot; pCO2, CO2 partial pressure computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2</code></td>
<td>
<p>&quot;standard&quot; fCO2, CO2 fugacity computed at in situ temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2pot</code></td>
<td>
<p>&quot;potential&quot; pCO2, CO2 partial pressure computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2pot</code></td>
<td>
<p>&quot;potential&quot; fCO2, CO2 fugacity computed at potential temperature and atmospheric pressure (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>pCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; pCO2, CO2 partial pressure computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>fCO2insitu</code></td>
<td>
<p>&quot;in situ&quot; fCO2, CO2 fugacity computed at in situ temperature and total pressure (atm + hydrostatic) (<code class="reqn">\mu</code>atm)</p>
</td></tr>
<tr><td><code>HCO3</code></td>
<td>
<p>HCO3 concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>CO3</code></td>
<td>
<p>CO3 concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>DIC concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>ALK</code></td>
<td>
<p>ALK, total alkalinity (mol/kg-soln)</p>
</td></tr>
<tr><td><code>OmegaAragonite</code></td>
<td>
<p>Omega aragonite, aragonite saturation state</p>
</td></tr>
<tr><td><code>OmegaCalcite</code></td>
<td>
<p>Omega calcite, calcite saturation state</p>
</td></tr>
<tr><td><code>NH4</code></td>
<td>
<p>NH4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>NH3</code></td>
<td>
<p>NH3 concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>BOH3</code></td>
<td>
<p>B(OH)3 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>BOH4</code></td>
<td>
<p>B(OH)4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>H3PO4</code></td>
<td>
<p>H3PO4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>H2PO4</code></td>
<td>
<p>H2PO4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>HPO4</code></td>
<td>
<p>HPO4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>PO4</code></td>
<td>
<p>PO4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>H2S</code></td>
<td>
<p>H2S concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>HS</code></td>
<td>
<p>HS concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>SiOH4</code></td>
<td>
<p>SiOH4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>SiOOH3</code></td>
<td>
<p>SiOOH3 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>SiO2OH2</code></td>
<td>
<p>SiO2OH2 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>HF</code></td>
<td>
<p>HF concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>F</code></td>
<td>
<p>F concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>HSO4</code></td>
<td>
<p>HSO4 concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>SO4</code></td>
<td>
<p>SO4 concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>H concentration at specified pH scale (mol/kg-soln)</p>
</td></tr>
<tr><td><code>OH</code></td>
<td>
<p>OH concentration (mol/kg-soln)</p>
</td></tr>
<tr><td><code>NH4t</code></td>
<td>
<p>Supplied NHt concentration (mol/kg-soln); values are recycled if necessary</p>
</td></tr> 
<tr><td><code>BOR</code></td>
<td>
<p>Calculated total borate concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>Pt</code></td>
<td>
<p>Supplied Pt concentration (mol/kg-soln); values are recycled if necessary</p>
</td></tr> 
<tr><td><code>HSt</code></td>
<td>
<p>Supplied HSt concentration (mol/kg-soln); values are recycled if necessary</p>
</td></tr>  
<tr><td><code>Sit</code></td>
<td>
<p>Supplied Sit concentration (mol/kg-soln); values are recycled if necessary</p>
</td></tr> 
<tr><td><code>FLUO</code></td>
<td>
<p>Calculated total fluoride concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>ST</code></td>
<td>
<p>Calculated total sulfate concentration (mol/kg-soln)</p>
</td></tr> 
<tr><td><code>SIR</code></td>
<td>
<p>substrate inhibitor ratio: [HCO3]/[H_free]  (mol:<code class="reqn">\mu</code>mol)</p>
</td></tr>
<tr><td><code>H_free</code></td>
<td>
<p>H ion concentration on free scale (<code class="reqn">\mu</code>mol/kg)</p>
</td></tr>
<tr><td><code>H_sws</code></td>
<td>
<p>H ion concentration on seawater scale (<code class="reqn">\mu</code>mol/kg)</p>
</td></tr>
<tr><td><code>H_t</code></td>
<td>
<p>H ion concentration on total scale (<code class="reqn">\mu</code>mol/kg)</p>
</td></tr>
<tr><td><code>pH_free</code></td>
<td>
<p>pH calculated on the free scale</p>
</td></tr>
<tr><td><code>pH_sws</code></td>
<td>
<p>pH calculated on the seawater scale</p>
</td></tr>
<tr><td><code>pH_t</code></td>
<td>
<p>pH calculated on the total scale</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2014)</p>


<h3>Author(s)</h3>

<p>Kimberlee Baldry, Lennart Bach and Jean-Pierre Gattuso, 
<a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a>
</p>


<h3>References</h3>

<p>Bach L. T., 2015 Reconsidering the role of carbonate ion concentration in calcification by marine organisms. <em>Biogeosciences</em> <b>12</b>, 4939-4951.
</p>
<p>Cai W. J., and Wang Y., 1998. The chemistry, fluxes, and sources of carbon dioxide in the estuarine waters of the Satilla and Altamaha Rivers, Georgia. <em>Limnology and Oceanography</em> <b>43</b>, 657-668.
</p>
<p>Dickson A. G. and Riley J. P., 1979 The estimation of acid dissociation constants in seawater media from potentiometric titrations with strong base. I. The ionic product of water. <em>Marine Chemistry</em> <b>7</b>, 89-99.
</p>
<p>Dickson A. G., 1990 Standard potential of the reaction: AgCI(s) + 1/2H2(g) = Ag(s) + HCI(aq), and the standard acidity constant of the ion HSO4 in synthetic sea water from 273.15 to 318.15 K. <em>Journal of Chemical Thermodynamics</em> <b>22</b>, 113-127.
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Khoo H. K., Ramette R. W., Culberson C. H. and Bates R. G., 1977 Determination of Hydrogen Ion Concentration in Seawater from 5 to 40oC: Standard Potentials at Salinities from 20 to 45. <em>Analytical Chemistry</em> <b>22</b>, vol49 29-34. 
</p>
<p>Lee K., Tae-Wook K., Byrne R.H., Millero F.J., Feely R.A. and Liu Y-M, 2010 The universal ratio of the boron to chlorinity for the North Pacific and North Atlantoc oceans. <em>Geochimica et Cosmochimica Acta</em> <b>74</b> 1801-1811.
</p>
<p>Lueker T. J., Dickson A. G. and Keeling C. D., 2000 Ocean pCO2 calculated from dissolved inorganic carbon, alkalinity, and equations for K1 and K2: validation based on laboratory measurements of CO2 in gas and seawater at equilibrium. <em>Marine Chemistry</em> <b>70</b> 105-119.
</p>
<p>Millero F. J., 1995. Thermodynamics of the carbon dioxide system in the oceans. <em>Geochimica Cosmochimica Acta</em> <b>59</b>: 661-677.
</p>
<p>Millero F. J., 2010. Carbonate constant for estuarine waters. <em>Marine and Freshwater Research</em> <b>61</b>: 139-142.
</p>
<p>Millero F. J., Graham T. B., Huang F., Bustos-Serrano H. and Pierrot D., 2006. Dissociation constants of carbonic acid in seawater as a function of salinity and temperature.  <em>Marine Chemistry</em> <b>100</b>, 80-84.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2014. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences Discussions</em> <b>11</b>, 5327-5397.
</p>
<p>Perez F. F. and Fraga F., 1987 Association constant of fluoride and hydrogen ions in seawater. <em>Marine Chemistry</em> <b>21</b>, 161-168.
</p>
<p>Roy R. N., Roy L. N., Vogel K. M., Porter-Moore C., Pearson T., Good C. E., Millero F. J. and Campbell D. M., 1993. The dissociation constants of carbonic acid in seawater at salinities 5 to 45 and temperatures 0 to 45oC. <em>Marine Chemistry</em> <b>44</b>, 249-267.
</p>
<p>Schockman, K.M., Byrne, R.H., 2021. Spectrophotometric determination of the bicarbonate dissociation constant in seawater, <em>Geochimica et Cosmochimica Acta</em>.
</p>
<p>Uppstrom L.R., 1974 The boron/chlorinity ratio of the deep-sea water from the Pacific Ocean. <em>Deep-Sea Research I</em> <b>21</b> 161-162.
</p>
<p>Waters, J., Millero, F. J., and Woosley, R. J., 2014. Corrigendum to &ldquo;The free proton concentration scale for seawater pH&rdquo;, [MARCHE: 149 (2013) 8-22], Mar. Chem. 165, 66-67.
</p>
<p>Weiss, R. F., 1974. Carbon dioxide in water and seawater: the solubility of a non-ideal gas, <em>Mar.  Chem.</em>, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A., 1980. Nitrous oxide solubility in water and seawater, <em>Mar. Chem.</em>, <b>8</b>, 347-359.
</p>
<p>Zeebe R. E. and Wolf-Gladrow D. A., 2001 <em>CO2 in seawater: equilibrium, kinetics, isotopes</em>. Amsterdam: Elsevier, 346 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## With a couple of variables
sir_full(flag=8, var1=8.2, var2=0.00234, S=35, T=25, P=0, Patm=1.0, Pt=0, Sit=0,
	pHscale="T", kf="pf", k1k2="l", ks="d", b="u74", gas="potential", NH4t=0, HSt=0)

## With a couple of variables and non-zero nutrient concentrations
sir_full(flag=8, var1=8.2, var2=0.00234, S=35, T=25, P=0, Patm=1.0, Pt=5e-6, Sit=2e-6,
	pHscale="T", kf="pf", k1k2="l", ks="d", b="u74", gas="potential", NH4t=10e-6, HSt=0.1e-6)

## Using vectors as arguments
flag &lt;- c(8, 2, 8)
var1 &lt;- c(8.2, 7.477544e-06, 8.2)
var2 &lt;- c(0.002343955, 0.001649802, 2400e-6)
S &lt;- c(35, 35, 30)
T &lt;- c(25, 25, 30)
P &lt;- c(0, 0, 0)
Pt &lt;- c(0, 0, 0)
Sit &lt;- c(0, 0, 0)
kf &lt;- c("pf", "pf", "pf")
k1k2 &lt;- c("l", "l", "l")
pHscale &lt;- c("T", "T", "T")
b &lt;- c("l10", "l10", "l10")
gas &lt;- c("potential", "potential", "potential")
NH4t &lt;- c(0, 0, 0)
HSt &lt;- c(0, 0, 0)
sir_full(flag=flag, var1=var1, var2=var2, S=S, T=T, P=P, Pt=Pt, Sit=Sit, 
  kf=kf, k1k2=k1k2, pHscale=pHscale, b=b, gas=gas, NH4t=NH4t, HSt=HSt)

## Test with all flags 
flag &lt;- c((1:15), (21:25))
var1 &lt;- c(8.200000, 7.308171e-06, 7.308171e-06, 7.308171e-06, 7.308171e-06, 
	8.2, 8.2, 8.2, 8.2, 0.001646857, 0.001646857, 0.001646857, 0.0002822957, 
	0.0002822957, 0.00234, 258.2164, 258.2164, 258.2164, 258.2164, 258.2164 )
var2 &lt;- c(7.308171e-06, 0.001646857, 0.0002822957, 0.00234, 0.001936461, 
	0.001646857, 0.0002822957, 0.00234, 0.001936461, 0.0002822957, 
	0.00234, 0.001936461,  0.00234, 0.001936461, 0.001936461, 8.2, 
	0.001646857, 0.0002822957, 0.00234, 0.001936461)
sir_full(flag=flag, var1=var1, var2=var2)
</code></pre>

<hr>
<h2 id='sp2sa_chem'>From Practical to absolute salinity</h2><span id='topic+sp2sa_chem'></span>

<h3>Description</h3>

<p>Converts from practical to absolute salinity based on total alkalinity as well as on the concentrations of dissolved inorganic carbon, nitrate and silicate.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sp2sa_chem(SP, TA=2300e-6, DIC=2000e-6, NO3=0, SIOH4=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sp2sa_chem_+3A_sp">SP</code></td>
<td>
<p>Practical salinity on the practical salinity scale</p>
</td></tr>
<tr><td><code id="sp2sa_chem_+3A_ta">TA</code></td>
<td>
<p>Total alkalinity, in mol/kg, default is 2300 √Ç¬µmol/kg</p>
</td></tr>
<tr><td><code id="sp2sa_chem_+3A_dic">DIC</code></td>
<td>
<p>Dissolved inorganic carbon concentration in mol/kg, default is 2000 √Ç¬µmol/kg</p>
</td></tr>
<tr><td><code id="sp2sa_chem_+3A_no3">NO3</code></td>
<td>
<p>Total nitrate concentration in mol/kg, default is 0</p>
</td></tr>
<tr><td><code id="sp2sa_chem_+3A_sioh4">SIOH4</code></td>
<td>
<p>Total silicate concentration in mol/kg, default is 0</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Converts from practical to absolute salinity from carbonate system parameters and ion concentration which mostly affect water density anomalies.
</p>


<h3>Value</h3>

<table>
<tr><td><code>SA</code></td>
<td>
<p>Absolute salinity (g/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon
</p>


<h3>References</h3>

<p>McDougall T. J., Jackett D. R., Millero F. J., Pawlowicz R. and Barker P. M., 2012. A global algorithm for estimating Absolute Salinity. <em>Ocean Science</em> <b>8</b>, 1123-1134.
</p>
<p>Pawlowicz R., Wright D. G. and Millero F. J., 2011. The effects of biogeochemical processes on oceanic conductivity/salinity/density relationships and the characterization of real seawater. <em>Ocean Science</em> <b>7</b>, 363-387.
</p>
<p>Pawlowicz R., 2013. What every oceanographer needs to know about TEOS-10 (The TEOS-10 Primer). http://www.teos-10.org/
</p>


<h3>See Also</h3>

<p>sa2sp_chem does the reverse, sp2sa_geo
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Calculate the absolute salinity of a sample with practical Salinity of 35,
   # Total Alkalinity of 0.00234 mol/kg and DIC of 0.00202 mol/kg
   SA &lt;- sp2sa_chem(SP=35, TA=0.00234, DIC=0.00202)
</code></pre>

<hr>
<h2 id='sp2sa_geo'>From practical to absolute salinity</h2><span id='topic+sp2sa_geo'></span>

<h3>Description</h3>

<p>Converts from practical to absolute salinity based on depth and geographic location.</p>


<h3>Usage</h3>

<pre><code class='language-R'>sp2sa_geo(SP, P=0, long=1.e20, lat=1.e20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sp2sa_geo_+3A_sp">SP</code></td>
<td>
<p>Practical salinity on the practical salinity scale</p>
</td></tr>
<tr><td><code id="sp2sa_geo_+3A_p">P</code></td>
<td>
<p>Sea water pressure in dbar</p>
</td></tr>
<tr><td><code id="sp2sa_geo_+3A_long">long</code></td>
<td>
<p>Longitude in decimal degrees [ 0 ... +360 ] or  [ -180 ... +180 ]</p>
</td></tr>
<tr><td><code id="sp2sa_geo_+3A_lat">lat</code></td>
<td>
<p>Latitude in decimal degrees [-90 ... 90]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is almost an alias of function gsw_SA_from_SP of the gsw package on which it relies. The only difference is in that depth and location are optional.  If location is not given, or incomplete (either longitude or latitude missing), an arbitrary location is chosen: the mid equatorial atlantic ocean. Note that this implies an error on computed SA ranging from 0 up to 0.02 g/kg.
</p>


<h3>Value</h3>

<table>
<tr><td><code>SA</code></td>
<td>
<p>Absolute salinity (g/kg)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon
</p>


<h3>References</h3>

<p>McDougall T. J., Jackett D. R., Millero F. J., Pawlowicz R. and Barker P. M., 2012. A global algorithm for estimating Absolute Salinity. <em>Ocean Science</em> <b>8</b>, 1123-1134.
</p>
<p>Pawlowicz R., 2013. What every oceanographer needs to know about TEOS-10 (The TEOS-10 Primer). http://www.teos-10.org/
</p>


<h3>See Also</h3>

<p>sa2sp_geo does the reverse, sp2sa_chem
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Calculate the absolute salinity of a sample whose practical Salinity is 35,
   # depth is 10 dbar and location is 188 degrees East and 4 degrees North.
   SA &lt;- sp2sa_geo(35, 10, 188, 4)     # 34.711778344814114
</code></pre>

<hr>
<h2 id='speciation'>ionic forms as a function of pH</h2><span id='topic+speciation'></span>

<h3>Description</h3>

<p>Estimates the concentration of the various ionic forms of a molecule as a function of pH</p>


<h3>Usage</h3>

<pre><code class='language-R'>speciation(K1=K1(), K2=NULL, K3=NULL, pH, conc=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="speciation_+3A_k1">K1</code></td>
<td>
<p>First dissociation constant</p>
</td></tr>
<tr><td><code id="speciation_+3A_k2">K2</code></td>
<td>
<p>Second dissociation constant, default is NULL</p>
</td></tr>
<tr><td><code id="speciation_+3A_k3">K3</code></td>
<td>
<p>Third dissociation constant, default is NULL</p>
</td></tr>
<tr><td><code id="speciation_+3A_ph">pH</code></td>
<td>
<p>pH value, default is 8</p>
</td></tr>
<tr><td><code id="speciation_+3A_conc">conc</code></td>
<td>
<p>concentration of molecule in mol/kg, default is 1 mol/kg</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a data frame containing the following concentrations (in mol/kg if conc is given in mol/kg):
</p>
<table>
<tr><td><code>C1</code></td>
<td>
<p>ionic form 1, univalent, bivalent and trivalent molecules</p>
</td></tr>
<tr><td><code>C2</code></td>
<td>
<p>ionic form 2, univalent, bivalent and trivalent molecules</p>
</td></tr>
<tr><td><code>C3</code></td>
<td>
<p>ionic form 3, bivalent and trivalent molecules</p>
</td></tr>
<tr><td><code>C4</code></td>
<td>
<p>ionic form 4, trivalent molecules</p>
</td></tr>    
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert <a href="mailto:K.Soetaert@nioo.knaw.nl">K.Soetaert@nioo.knaw.nl</a>
</p>


<h3>References</h3>

<p>Zeebe R. E. and Wolf-Gladrow D. A., 2001 <em>CO2 in seawater: equilibrium, kinetics, isotopes</em>. Amsterdam: Elsevier, 346 pp.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bjerrum">bjerrum</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Speciation of divalent species; example to estimate the various ionic forms
## of dissolved inorganic carbon  (DIC = 0.0021 mol/kg) at a salinity of 35,
## a temperature of 25oC and an hydrostatic pressure of 0:
spec &lt;- speciation (K1(35, 25, 0), K2(35, 25, 0), pH=8, conc=0.0021)
## where (spec\$C1=[CO2], spec\$C2=[HCO3-], spec\$C3=[CO3--])

## Speciation of trivalent species (e.g.,  H3PO4, H2PO4-, HPO4--, PO4---)
speciation(K1p(), K2p(), K3p(), conc=0.001)

## Effect of temperature on pCO2 - Figure 1.4.18 of Zeebe and Wolf-Gladrow (2001)
Tseq &lt;- seq(0, 30, by=0.5)
pHseq &lt;- carb(flag=15, var1=2300e-6, var2=1900e-6, S=35, T=Tseq, P=0)$pH
CO2  &lt;- speciation(K1(T=Tseq), K2(T=Tseq), conc=1900, pH=pHseq)$C1
pCO2 &lt;- CO2/K0(T=Tseq)
plot(Tseq, pCO2, xlab="Temperature (oC)", ylab="pCO2 (uatm)", type="l", 
	main="effect of temperature on pCO2")
legend("topleft", c(expression(sum(CO[2])==1900~umol~kg^"-1"), 
	expression(TA==2300~umol~kg^"-1")))
</code></pre>

<hr>
<h2 id='teos2eos_chem'>Convert temperature and salinity from TEOS-10 to EOS-80</h2><span id='topic+teos2eos_chem'></span>

<h3>Description</h3>

<p>Converts conservative temperature to in situ temperature and absolute salinity to practical salinity (SP). Salinity conversion depends on total alkalinity as well as on the concentrations of dissolved inorganic carbon, nitrate and silicate.</p>


<h3>Usage</h3>

<pre><code class='language-R'>teos2eos_chem(SA, CT, P=0, TA=2300e-6, DIC=2000e-6, NO3=0, SIOH4=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="teos2eos_chem_+3A_sa">SA</code></td>
<td>
<p>Absolute salinity in g/kg</p>
</td></tr>
<tr><td><code id="teos2eos_chem_+3A_ct">CT</code></td>
<td>
<p>Conservative temperature in degrees C</p>
</td></tr>
<tr><td><code id="teos2eos_chem_+3A_p">P</code></td>
<td>
<p>Sea water pressure in dbar</p>
</td></tr>
<tr><td><code id="teos2eos_chem_+3A_ta">TA</code></td>
<td>
<p>Total alkalinity, in mol/kg, default is 2300 √Ç¬µmol/kg</p>
</td></tr>
<tr><td><code id="teos2eos_chem_+3A_dic">DIC</code></td>
<td>
<p>Dissolved inorganic carbon concentration in mol/kg, default is 2000 √Ç¬µmol/kg</p>
</td></tr>
<tr><td><code id="teos2eos_chem_+3A_no3">NO3</code></td>
<td>
<p>Total nitrate concentration in mol/kg, default is 0</p>
</td></tr>
<tr><td><code id="teos2eos_chem_+3A_sioh4">SIOH4</code></td>
<td>
<p>Total silicate concentration in mol/kg, default is 0</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Conversion from absolute to practical salinity depends on carbonate system parameters and ion concentration which mostly affect water density anomalies.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>T</code></td>
<td>
<p>In situ temperature (deg C)</p>
</td></tr>
<tr><td><code>SP</code></td>
<td>
<p>Practical salinity (psu)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon
</p>


<h3>References</h3>

<p>McDougall T. J., Jackett D. R., Millero F. J., Pawlowicz R. and Barker P. M., 2012. A global algorithm for estimating Absolute Salinity. <em>Ocean Science</em> <b>8</b>, 1123-1134.
</p>
<p>Pawlowicz R., Wright D. G. and Millero F. J., 2011. The effects of biogeochemical processes on oceanic conductivity/salinity/density relationships and the characterization of real seawater. <em>Ocean Science</em> <b>7</b>, 363-387.
</p>
<p>Pawlowicz R., 2013. What every oceanographer needs to know about TEOS-10 (The TEOS-10 Primer). http://www.teos-10.org/
</p>


<h3>See Also</h3>

<p>eos2teos_chem, teos2eos_geo, sa2sp_cham, package gsw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Calculate in situ temperature and practical salinity of a sample with 
   # Absolute salinity of 35 g/kg, Conservative temperature of 18 deg C,
   # at 0 dbar and Total alkalinity of 0.00234 mol/kg and DIC of 0.00202 mol/kg
   f &lt;- teos2eos_chem(SA=35, CT=18, P=0, TA=0.00234, DIC=0.00202)
   T &lt;- f$T     # insitu temperature
   SP &lt;- f$SP     # Practical salinity
</code></pre>

<hr>
<h2 id='teos2eos_geo'>Convert temperature and salinity from TEOS-10 to EOS-80</h2><span id='topic+teos2eos_geo'></span>

<h3>Description</h3>

<p>Converts conservative temperature to in situ temperature and absolute salinity to practical salinity (SP). Salinity conversion depends on depth and geographic location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>teos2eos_geo(SA, CT, P=0, long=1.e20, lat=1.e20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="teos2eos_geo_+3A_sa">SA</code></td>
<td>
<p>Absolute salinity in g/kg</p>
</td></tr>
<tr><td><code id="teos2eos_geo_+3A_ct">CT</code></td>
<td>
<p>Conservative temperature in degrees C</p>
</td></tr>
<tr><td><code id="teos2eos_geo_+3A_p">P</code></td>
<td>
<p>Sea water pressure in dbar</p>
</td></tr>
<tr><td><code id="teos2eos_geo_+3A_long">long</code></td>
<td>
<p>Longitude in decimal degrees [ 0 ... +360 ] or  [ -180 ... +180 ]</p>
</td></tr>
<tr><td><code id="teos2eos_geo_+3A_lat">lat</code></td>
<td>
<p>Latitude in decimal degrees [-90 ... 90]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Conversion from absolute to practical salinity depends on water density anomaly which is correlated with silicate concentration. This function relies on silicate concentration taken from WOA (World Ocean Atlas) to evaluate the density anomaly.
</p>


<h3>Value</h3>

<p>The function returns a data frame containing the following columns:
</p>
<table>
<tr><td><code>T</code></td>
<td>
<p>In situ temperature (deg C)</p>
</td></tr>
<tr><td><code>SP</code></td>
<td>
<p>Practical salinity (psu)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Marie Epitalon
</p>


<h3>References</h3>

<p>McDougall T. J., Jackett D. R., Millero F. J., Pawlowicz R. and Barker P. M., 2012. A global algorithm for estimating Absolute Salinity. <em>Ocean Science</em> <b>8</b>, 1123-1134.
</p>
<p>Pawlowicz R., Wright D. G. and Millero F. J., 2011. The effects of biogeochemical processes on oceanic conductivity/salinity/density relationships and the characterization of real seawater. <em>Ocean Science</em> <b>7</b>, 363-387.
</p>
<p>Pawlowicz R., 2013. What every oceanographer needs to know about TEOS-10 (The TEOS-10 Primer). http://www.teos-10.org/
</p>


<h3>See Also</h3>

<p>eos2teos_geo does the reverse, teos2eos_chem, sa2sp_geo, package gsw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   # Calculate in situ temperature and practical salinity of a sample with 
   # Absolute salinity of 35 g/kg, conservative temperature of 18 deg C,
   # depth is 10 dbar and location is 188 degrees East and 4 degrees North.
   f &lt;- teos2eos_geo(SA=35, CT=18, P=10, long=188, lat=4)
   T &lt;- f$T     # in situ temperature
   SP &lt;- f$SP     # Practical salinity
</code></pre>

<hr>
<h2 id='theta'>Potential temperature of seawater</h2><span id='topic+theta'></span>

<h3>Description</h3>

<p>Computes theta, the potential temperature of seawater given
original temperature, salinity, pressure, and reference pressure</p>


<h3>Usage</h3>

<pre><code class='language-R'>theta(S=35, T=25, P=0, Pref=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theta_+3A_s">S</code></td>
<td>
<p>Salinity on the practical salinity scale, default is 35</p>
</td></tr>
<tr><td><code id="theta_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="theta_+3A_p">P</code></td>
<td>
<p>Hydrostatic pressure in bar (surface = 0; 1000 db = 100 bar), default is 0</p>
</td></tr>
<tr><td><code id="theta_+3A_pref">Pref</code></td>
<td>
<p>Reference hydrostatic pressure in bar, default is 0</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the potential temperature of seawater relative to a
chosen reference pressure following Fofonoff and Millard (1983).
The potential temperature <code class="reqn">\theta</code> is the temperature that a
water parcel would have if were moved adiabatically to another pressure
level <code>Pref</code>.  Typically, the potential temperature is referenced
to the surface (<code class="reqn">Pref=0</code>).  The potential teperature depends on
the original salinity <code>S</code>, <em>in-situ</em> temperature <code>T</code>
and pressure <code>P</code>.
</p>
<p>This routine is essentially a wrapper for the <code><a href="oce.html#topic+swTheta">swTheta</a></code>
routine of the 'oce' package. Unlike the latter, pressure units here
are given in bars and method=&quot;unesco&quot; is prescribed.
</p>


<h3>Value</h3>

<table>
<tr><td><code>theta</code></td>
<td>
<p>potential temperature of seawater (C)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James Orr <a href="mailto:james.orr@lsce.ipsl.fr">james.orr@lsce.ipsl.fr</a>
</p>


<h3>References</h3>

<p>Fofonoff, P. and R. C. Millard Jr, 1983. Algorithms for computation of fundamental properties of seawater. <em>Unesco Technical Papers in Marine Science</em>, <b>44</b>, 53 pp.</p>


<h3>See Also</h3>

<p><code><a href="oce.html#topic+swTheta">swTheta</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   #Calculate the potential temperature for a sample at 1000 db referenced to the surface
   theta &lt;- theta(S=35, T=25, P=100, Pref=0)
</code></pre>

<hr>
<h2 id='tris'>pH of TRIS buffer</h2><span id='topic+tris'></span>

<h3>Description</h3>

<p>Calculates the pH value of TRIS buffered artificial seawater solutions (on the total scale in mol/kg-soln)</p>


<h3>Usage</h3>

<pre><code class='language-R'>tris(S=35,T=25,b=0.04,k="d98",warn="y")

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tris_+3A_s">S</code></td>
<td>
<p>Salinity, default is 35</p>
</td></tr>
<tr><td><code id="tris_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="tris_+3A_b">b</code></td>
<td>
<p>Molality if TRIS/TRISH+ in moles per kg of water, default is 0.04 mol/kg-H20</p>
</td></tr>
<tr><td><code id="tris_+3A_k">k</code></td>
<td>
<p>&quot;d98&quot; for DelValls and Dickson 1998, &quot;m18&quot; for using tris characterization by Mueller et al (2018), default is &quot;d98&quot;</p>
</td></tr> 
<tr><td><code id="tris_+3A_warn">warn</code></td>
<td>
<p>&quot;y&quot; to show warnings when S,T and/or b go beyond the valid range for the chosen k; &quot;n&quot; to supress warnings. The default is &quot;y&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The models used to calculate the return value of this function are based on experimental data. It is critical to consider that each formulation refers to the artificial seawater solution applied during the characterization experiment and is only valid for the studied ranges of temperature and salinity:
</p>

<ul>
<li><p> DelValls and Dickson (1998): S ranging between 20 and 40, T ranging between 0 and 45oC, and b being 0.04 mol/kg-H20.
</p>
</li>
<li><p> Mueller et al. (2018): S ranging between 5 and 40, T ranging between 5 and 45oC, and b ranging between 0.01 and 0.04 mol/kg-H20.
</p>
</li></ul>

<p>Note that the arguments can be given as a unique number or as vectors. If the lengths of the vectors are different, the longer vector is retained and only the first value of the other vectors is used. It can therefore be critical to use vectors of the same length.
</p>


<h3>Value</h3>

<table>
<tr><td><code>tris</code></td>
<td>
<p>The function returns the pH value of TRIS buffered artificial seawater solutions (on the total scale in mol/kg-soln)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jean-Pierre Gattuso <a href="mailto:jean-pierre.gattuso@imev-mer.fr">jean-pierre.gattuso@imev-mer.fr</a> and Jens Daniel Mueller <a href="mailto:jens.mueller@io-warnemuende.de">jens.mueller@io-warnemuende.de</a> 
</p>


<h3>References</h3>

<p>DelValls, T. A., and Dickson, A. G., 1998 The pH of buffers based on 2-amino-2-hydroxymethyl-1,3-propanediol ('tris') in synthetic sea water. <em>Deep Sea Research Part I: Oceanographic Research Papers</em> <b>45(9)</b>, 1541-1554. https://doi.org/10.1016/S0967-0637(98)00019-3
</p>
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Mueller, J. D., Bastkowski, F., Sander, B., Seitz, S., Turner, D. R., Dickson, A. G., and Rehder, G., 2018 Metrology for pH measurements in brackish waters- Part 1: Extending electrochemical pHT measurements of TRIS buffers to salinities 5-20. <em>Frontiers in Marine Science</em> <b>5:176</b>, 1-12. https://doi.org/10.3389/fmars.2018.00176
</p>


<h3>See Also</h3>

<p><code><a href="#topic+amp">amp</a></code>, <code><a href="#topic+pHslope">pHslope</a></code>, <code><a href="#topic+pH">pH</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	##Example from Mueller et al. (2018), should give test value pHT = 8.0703
	 tris(S=20,T=25,b=0.04,k="m18")
</code></pre>

<hr>
<h2 id='vapress'>Computes vapor pressure of seawater</h2><span id='topic+vapress'></span>

<h3>Description</h3>

<p>Computes vapor pressure of seawater (atm) from temperature and salinity</p>


<h3>Usage</h3>

<pre><code class='language-R'>vapress(S=35, T=25, form="d2007")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vapress_+3A_s">S</code></td>
<td>
<p>Salinity on the practical salinity scale, default is 35</p>
</td></tr>
<tr><td><code id="vapress_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="vapress_+3A_form">form</code></td>
<td>
<p>choose either &quot;d2007&quot; for the best-practices formulation to compute vapor pressure of seawater from Dickson et al. (2007) or &quot;wp1980&quot; for the formulation from weiss and Price (1980).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the vapor pressure of seawater pH20 following best practices
(Dickson et al., 2007). That computed pH20 is identical, when rounded
to the 4th decimal place, with that computed by the equation from
Weiss and Price (1980).</p>


<h3>Value</h3>

<table>
<tr><td><code>vapress</code></td>
<td>
<p>Vapor pressure of seawater in atm</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>James Orr <a href="mailto:james.orr@lsce.ipsl.fr">james.orr@lsce.ipsl.fr</a>
</p>


<h3>References</h3>

<p>Dickson A. G., Sabine C. L. and Christian J. R. (2007) Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Weiss, R. F. (1974) Carbon dioxide in water and seawater: the solubility of a non-ideal gas, Marine Chemistry, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A. (1980) Nitrous oxide solubility in water and seawater, Marine Chemistry, <b>8</b>, 347-359.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+x2pCO2">x2pCO2</a></code>, and <code><a href="#topic+p2xCO2">p2xCO2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   pH20 &lt;- vapress(S=35, T=25, form="d2007")
</code></pre>

<hr>
<h2 id='x2pCO2'>Converts mole fraction to partial pressure of CO2</h2><span id='topic+x2pCO2'></span>

<h3>Description</h3>

<p>Converts xCO2 (mole fraction of CO2) into pCO2 (partial pressure of CO2)</p>


<h3>Usage</h3>

<pre><code class='language-R'>x2pCO2(S=35, T=25, Patm=1.0, xCO2=400)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="x2pCO2_+3A_s">S</code></td>
<td>
<p>Salinity on the practical salinity scale, default is 35</p>
</td></tr>
<tr><td><code id="x2pCO2_+3A_t">T</code></td>
<td>
<p>Temperature in degrees Celsius, default is 25oC</p>
</td></tr>
<tr><td><code id="x2pCO2_+3A_patm">Patm</code></td>
<td>
<p>Atmospheric pressure in atmospheres, default is 1.0</p>
</td></tr>
<tr><td><code id="x2pCO2_+3A_xco2">xCO2</code></td>
<td>
<p>Mole fraction of CO2 in ppm, default is 400</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mole fraction xCO2 (ppm) is computed from pCO2 (<code class="reqn">\mu</code>atm) using the following equation: <code class="reqn"> xCO2 = pCO2 (Patm - pH2O)</code>, where pH20 is the vapor pressure of seawater computed following best practices (Dickson et al., 2007). That computed pH20 is identical, when rounded to the 4th decimal place, with that computed by the equation from Weiss and Price (1980).</p>


<h3>Value</h3>

<table>
<tr><td><code>pCO2</code></td>
<td>
<p>Partial pressure of CO2 in <code class="reqn">\mu</code>atm.</p>
</td></tr>
</table>


<h3>Note</h3>

<p><b>Warning:</b> pCO2 estimates below 100 m are subject to considerable uncertainty. See Weiss (1974) and Orr et al. (2015)</p>


<h3>Author(s)</h3>

<p>James Orr <a href="mailto:james.orr@lsce.ipsl.fr">james.orr@lsce.ipsl.fr</a>
</p>


<h3>References</h3>

 
<p>Dickson A. G., Sabine C. L. and Christian J. R., 2007 Guide to best practices for ocean CO2 measurements. <em>PICES Special Publication</em> <b>3</b>, 1-191.
</p>
<p>Orr J. C., Epitalon J.-M. and Gattuso J.-P., 2015. Comparison of seven packages that compute ocean carbonate chemistry. <em>Biogeosciences</em> <b>12</b>, 1483-1510.
</p>
<p>Weiss, R. F. (1974) Carbon dioxide in water and seawater: the solubility of a non-ideal gas, Marine Chemistry, <b>2</b>, 203-215.
</p>
<p>Weiss, R. F. and Price, B. A. (1980) Nitrous oxide solubility in water and seawater, Marine Chemistry, <b>8</b>, 347-359.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+p2xCO2">p2xCO2</a></code> and <code><a href="#topic+vapress">vapress</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Atmospheric pressure is rarely equal to 1 atm exactly 
## Over the Southern Ocean Patm=0.97 is more realistic
   pCO2_socn &lt;- x2pCO2(S=35, T=0, Patm=0.97, xCO2=400.0)
   print(pCO2_socn)
## The result (385.6322 uatm) is 12 uatm less than if it was wrongly assumed that Patm=1.0

## Show effect of temperature on pCO2 computed from xCO2, and on resulting variables from "carb"
S &lt;- 35
ALK &lt;- 2300e-6
T &lt;- seq(0,30,5)
xCO2 &lt;- 400
pCO2 &lt;- x2pCO2(S=35, T=T, Patm=1, xCO2=400)
results &lt;- carb(flag=24, var1=pCO2, var2=ALK, S=S, T=T, P=0, Pt=0, Sit=0, 
  pHscale="T", kf="pf", k1k2="l", ks="d", b="u74")
print(results)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
