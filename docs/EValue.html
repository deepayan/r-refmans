<!DOCTYPE html><html lang="en"><head><title>Help for package EValue</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EValue}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bf_func'><p>Internal function used to calculate arbitrary bias factors.</p></a></li>
<li><a href='#bias_plot'><p>Plot bias factor as function of confounding relative risks</p></a></li>
<li><a href='#confounded_meta'><p>Sensitivity analysis for unmeasured confounding in meta-analyses</p></a></li>
<li><a href='#confounding'><p>Unmeasured confounding</p></a></li>
<li><a href='#convert_measures'><p>Convert an effect measure</p></a></li>
<li><a href='#deg_func'><p>Internal function used to fit roots of a polynomial made up of the product of</p>
bias factors.</a></li>
<li><a href='#effect_measures'><p>Declare an effect measure</p></a></li>
<li><a href='#evalue'><p>Compute an E-value for unmeasured confounding</p></a></li>
<li><a href='#evalues.HR'><p>Compute E-value for a hazard ratio and its confidence interval limits</p></a></li>
<li><a href='#evalues.IC'><p>Compute an E-value for unmeasured confounding for an additive interaction contrast</p></a></li>
<li><a href='#evalues.MD'><p>Compute E-value for a difference of means and its confidence interval limits</p></a></li>
<li><a href='#evalues.OLS'><p>Compute E-value for a linear regression coefficient estimate</p></a></li>
<li><a href='#evalues.OR'><p>Compute E-value for an odds ratio and its confidence interval limits</p></a></li>
<li><a href='#evalues.RD'><p>Compute E-value for a population-standardized risk difference and its</p>
confidence interval limits</a></li>
<li><a href='#evalues.RR'><p>Compute E-value for a risk ratio or rate ratio and its confidence interval</p>
limits</a></li>
<li><a href='#lead'><p>An example dataset</p></a></li>
<li><a href='#misclassification'><p>Misclassification</p></a></li>
<li><a href='#multi_bias'><p>Create a set of biases for a multi-bias sensitivity analysis</p></a></li>
<li><a href='#multi_bound'><p>Calculate a bound for the bias</p></a></li>
<li><a href='#multi_evalue'><p>Calculate a multiple-bias E-value</p></a></li>
<li><a href='#selection'><p>Selection bias</p></a></li>
<li><a href='#selection_evalue'><p>Compute selection bias E-value for a hazard ratio and its confidence interval</p>
limits</a></li>
<li><a href='#sens_plot'><p>Plots for sensitivity analyses</p></a></li>
<li><a href='#soyMeta'><p>A meta-analysis on soy intake and breast cancer risk (Trock et al., 2006)</p></a></li>
<li><a href='#svalues.HR'><p>Compute selection bias E-value for an estimate and its confidence interval</p>
limits</a></li>
<li><a href='#svalues.OR'><p>Compute selection bias E-value for an odds ratio and its confidence interval</p>
limits</a></li>
<li><a href='#svalues.RR'><p>Compute selection bias E-value for a risk ratio or rate ratio and its</p>
confidence interval limits</a></li>
<li><a href='#threshold'><p>Compute E-value for single value of risk ratio</p></a></li>
<li><a href='#threshold_selection'><p>Compute selection bias E-value for single value of risk ratio as well as a</p>
statement about what parameters it refers to</a></li>
<li><a href='#toyMeta'><p>An example meta-analysis</p></a></li>
<li><a href='#twoXtwoRR'><p>Estimate risk ratio and compute CI limits from two-by-two table</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sensitivity Analyses for Unmeasured Confounding and Other Biases
in Observational Studies and Meta-Analyses</td>
</tr>
<tr>
<td>Version:</td>
<td>4.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Conducts sensitivity analyses for unmeasured confounding, selection bias, and measurement error (individually or in combination; VanderWeele &amp; Ding (2017) &lt;<a href="https://doi.org/10.7326%2FM16-2607">doi:10.7326/M16-2607</a>&gt;; Smith &amp; VanderWeele (2019) &lt;<a href="https://doi.org/10.1097%2FEDE.0000000000001032">doi:10.1097/EDE.0000000000001032</a>&gt;; VanderWeele &amp; Li (2019) &lt;<a href="https://doi.org/10.1093%2Faje%2Fkwz133">doi:10.1093/aje/kwz133</a>&gt;; Smith &amp; VanderWeele (2021) &lt;<a href="https://doi.org/10.48550/arXiv.2005.02908">doi:10.48550/arXiv.2005.02908</a>&gt;). Also conducts sensitivity analyses for unmeasured confounding in meta-analyses (Mathur &amp; VanderWeele (2020a) &lt;<a href="https://doi.org/10.1080%2F01621459.2018.1529598">doi:10.1080/01621459.2018.1529598</a>&gt;; Mathur &amp; VanderWeele (2020b) &lt;<a href="https://doi.org/10.1097%2FEDE.0000000000001180">doi:10.1097/EDE.0000000000001180</a>&gt;) and for additive measures of effect modification (Mathur et al., under review).  </td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, ggplot2 (&ge; 2.2.1), metafor, metadat,
methods, boot, MetaUtility, dplyr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-27 18:49:25 UTC; mmathur</td>
</tr>
<tr>
<td>Author:</td>
<td>Maya B. Mathur [cre, aut],
  Louisa H. Smith [aut],
  Peng Ding [aut],
  Tyler J. VanderWeele [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maya B. Mathur &lt;mmathur@stanford.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-28 04:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bf_func'>Internal function used to calculate arbitrary bias factors.</h2><span id='topic+bf_func'></span>

<h3>Description</h3>

<p>Internal function used to calculate arbitrary bias factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bf_func(rr1, rr2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bf_func_+3A_rr1">rr1</code></td>
<td>
<p>A number. A risk ratio that is a component of a bias factors</p>
</td></tr>
<tr><td><code id="bf_func_+3A_rr2">rr2</code></td>
<td>
<p>A number. The other risk ratio that is a component of a bias
factors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the value of the expression. Used for calculating bias
factors.
</p>

<hr>
<h2 id='bias_plot'>Plot bias factor as function of confounding relative risks</h2><span id='topic+bias_plot'></span>

<h3>Description</h3>

<p>Plots the bias factor required to explain away a provided relative risk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bias_plot(RR, xmax)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bias_plot_+3A_rr">RR</code></td>
<td>
<p>The relative risk</p>
</td></tr>
<tr><td><code id="bias_plot_+3A_xmax">xmax</code></td>
<td>
<p>Upper limit of x-axis.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># recreate the plot in VanderWeele and Ding (2017)
bias_plot(RR=3.9, xmax=20)
</code></pre>

<hr>
<h2 id='confounded_meta'>Sensitivity analysis for unmeasured confounding in meta-analyses</h2><span id='topic+confounded_meta'></span>

<h3>Description</h3>

<p>This function implements the sensitivity analyses of Mathur &amp; VanderWeele (2020a, 2020b). It computes point estimates, standard errors, and confidence intervals
for (1) <code>Prop</code>, the proportion of studies with true causal effect sizes above or below a chosen threshold <code>q</code> as a function of the bias parameters;
(2) the minimum bias factor on the relative risk scale (<code>Tmin</code>) required to reduce to
less than <code>r</code> the proportion of studies with true causal effect sizes more extreme than
<code>q</code>; and (3) the counterpart to (2) in which bias is parameterized as the minimum
relative risk for both confounding associations (<code>Gmin</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confounded_meta(
  method = "calibrated",
  q,
  r = NA,
  tail = NA,
  CI.level = 0.95,
  give.CI = TRUE,
  R = 1000,
  muB = NA,
  muB.toward.null = FALSE,
  dat = NA,
  yi.name = NA,
  vi.name = NA,
  sigB = NA,
  yr = NA,
  vyr = NA,
  t2 = NA,
  vt2 = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confounded_meta_+3A_method">method</code></td>
<td>
<p><code>"calibrated"</code> or <code>"parametric"</code>. See Details.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_q">q</code></td>
<td>
<p>True causal effect size chosen as the threshold for a meaningfully large effect.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_r">r</code></td>
<td>
<p>For <code>Tmin</code> and <code>Gmin</code>, value to which the proportion of meaningfully strong effect sizes is to be reduced.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_tail">tail</code></td>
<td>
<p><code>"above"</code> for the proportion of effects above <code>q</code>; <code>"below"</code> for
the proportion of effects below <code>q</code>. By default, is set to <code>"above"</code> if the pooled point estimate (<code>method = "parametric"</code>) or median of the calibrated estimates (<code>method = "calibrated"</code>) is above 1 on the relative risk scale and is set to <code>"below"</code> otherwise.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_ci.level">CI.level</code></td>
<td>
<p>Confidence level as a proportion (e.g., 0.95).</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_give.ci">give.CI</code></td>
<td>
<p>Logical. If <code>TRUE</code>, confidence intervals are provided. Otherwise, only point estimates are provided.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_r">R</code></td>
<td>
<p>Number  of  bootstrap  iterates for confidence interval estimation. Only used if <code>method = "calibrated"</code> and <code>give.CI = TRUE</code>.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_mub">muB</code></td>
<td>
<p>Mean bias factor on the log scale across studies (greater than 0). When considering bias that is of homogeneous strength across studies (i.e., <code>method = "calibrated"</code> or <code>method = "parametric"</code> with <code>sigB = 0</code>), <code>muB</code> represents the log-bias factor in each study. If <code>muB</code> is not specified, then only <code>Tmin</code> and <code>Gmin</code> will be returned, not <code>Prop</code>.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_mub.toward.null">muB.toward.null</code></td>
<td>
<p>Whether you want to consider bias that has on average shifted studies' point estimates away from the null (<code>FALSE</code>; the default) or that has on average shifted studies' point estimates toward the null (<code>TRUE</code>). See Details.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_dat">dat</code></td>
<td>
<p>Dataframe containing studies' point estimates and variances. Only used if <code>method = "calibrated"</code>.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_yi.name">yi.name</code></td>
<td>
<p>Name of variable in <code>dat</code> containing studies' point estimates on the log-relative risk scale. Only used if <code>method = "calibrated"</code>.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_vi.name">vi.name</code></td>
<td>
<p>Name of variable in <code>dat</code> containing studies' variance estimates. Only used if <code>method = "calibrated"</code>.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_sigb">sigB</code></td>
<td>
<p>Standard deviation of log bias factor across studies. Only used if <code>method = "parametric"</code>.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_yr">yr</code></td>
<td>
<p>Pooled point estimate (on log-relative risk scale) from confounded meta-analysis. Only used if <code>method = "parametric"</code>.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_vyr">vyr</code></td>
<td>
<p>Estimated variance of pooled point estimate from confounded meta-analysis. Only used if <code>method = "parametric"</code>.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_t2">t2</code></td>
<td>
<p>Estimated heterogeneity (<code class="reqn">\tau^2</code>) from confounded meta-analysis. Only used if <code>method = "parametric"</code>.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_vt2">vt2</code></td>
<td>
<p>Estimated variance of <code class="reqn">\tau^2</code> from confounded meta-analysis. Only used if <code>method = "parametric"</code>.</p>
</td></tr>
<tr><td><code id="confounded_meta_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>confounded_meta</code>.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Specifying the sensitivity parameters on the bias</h4>

<p>By convention, the average log-bias factor, <code>muB</code>, is taken to be greater than 0 (Mathur &amp; VanderWeele, 2020a; Ding &amp; VanderWeele, 2017). Confounding can operate on average either away from or toward the null, a choice specified via <code>muB.toward.null</code>. The most common choice for sensitivity analysis is to consider bias that operates on average away from the null, which is <code>confounded_meta</code>'s default. In such an analysis, correcting for the bias involves shifting studies' estimates back toward the null by <code>muB</code> (i.e., if <code>yr &gt; 0</code>, the estimates will be corrected downward; if <code>yr &lt; 0</code>, they will be corrected upward). Alternatively, to consider bias that operates on average away from the null, you would still specify <code>muB &gt; 0</code> but would also specify <code>muB.toward.null = TRUE</code>. For detailed guidance on choosing the sensitivity parameters <code>muB</code> and <code>sigB</code>, see Section 5 of Mathur &amp; VanderWeele (2020a).
</p>



<h4>Specifying the threshold <code>q</code></h4>

<p>For detailed guidance on choosing the threshold <code>q</code>, see the Supplement of Mathur &amp; VanderWeele (2020a).
</p>



<h4>Specifying the estimation method</h4>

<p>By default, <code>confounded_meta</code> performs estimation using a <strong>calibrated method</strong> (Mathur &amp; VanderWeele, 2020b) that extends work by Wang et al. (2019). This method makes no assumptions about the distribution of population effects and performs well in meta-analyses with as few as 10 studies, and performs well even when the proportion being estimated is close to 0 or 1. However, it only accommodates bias whose strength is the same in all studies (homogeneous bias). When using this method, the following arguments need to be specified:
</p>

<ul>
<li> <p><code>q</code>
</p>
</li>
<li> <p><code>r</code> (if you want to estimate <code>Tmin</code> and <code>Gmin</code>)
</p>
</li>
<li> <p><code>muB</code>
</p>
</li>
<li> <p><code>dat</code>
</p>
</li>
<li> <p><code>yi.name</code>
</p>
</li>
<li> <p><code>vi.name</code>
</p>
</li></ul>

<p>The <strong>parametric method</strong> assumes that the population effects are approximately normal and that the number of studies is large. Parametric confidence intervals should only be used when the proportion estimate is between 0.15 and 0.85 (and <code>confounded_meta</code> will issue a warning otherwise). Unlike the calibrated method, the parametric method can accommodate bias that is heterogeneous across studies (specifically, bias that is log-normal across studies). When using this method, the following arguments need to be specified:
</p>

<ul>
<li> <p><code>q</code>
</p>
</li>
<li> <p><code>r</code> (if you want to estimate <code>Tmin</code> and <code>Gmin</code>)
</p>
</li>
<li> <p><code>muB</code>
</p>
</li>
<li> <p><code>sigB</code>
</p>
</li>
<li> <p><code>yr</code>
</p>
</li>
<li> <p><code>vyr</code> (if you want confidence intervals)
</p>
</li>
<li> <p><code>t2</code>
</p>
</li>
<li> <p><code>vt2</code> (if you want confidence intervals)
</p>
</li></ul>




<h4>Effect size measures other than log-relative risks</h4>

<p>If your meta-analysis uses effect sizes other than log-relative risks, you should first approximately convert them to log-relative risks, for example via <code><a href="#topic+convert_measures">convert_measures()</a></code> and then pass the converted point estimates or meta-analysis estimates to <code>confounded_meta</code>.
</p>



<h4>Interpreting <code>Tmin</code> and <code>Gmin</code></h4>

<p><code>Tmin</code> is defined as the minimum average bias factor on the relative risk scale that would be required to reduce to less than <code>r</code> the proportion of studies with true causal effect sizes stronger than the threshold <code>q</code>, assuming that the bias factors are log-normal across studies with standard deviation <code>sigB</code>. <code>Gmin</code> is defined as the minimum confounding strength on the relative risk scale &ndash; that is, the relative risk relating unmeasured confounder(s) to both the exposure and the outcome &ndash; on average among the meta-analyzed studies, that would be required to reduce to less than <code>r</code> the proportion of studies with true causal effect sizes stronger than the threshold <code>q</code>, again assuming that bias factors are log-normal across studies with standard deviation <code>sigB</code>. <code>Gmin</code> is a one-to-one transformation of <code>Tmin</code> given by <code class="reqn">Gmin = Tmin + \sqrt{Tmin * (Tmin - 1)} </code>. If the estimated proportion of meaningfully strong effect sizes is already less than <code>r</code> even without the introduction of any bias, <code>Tmin</code> and <code>Gmin</code> will be set to 1. (These definitions of <code>Tmin</code> and <code>Gmin</code> are generalizations of those given in Mathur &amp; VanderWeele, 2020a, who defined these quantities in terms of bias that is homogeneous across studies. You can conduct analyses with homogeneous bias by setting <code>sigB = 0</code>.)
</p>
<p>The direction of bias represented by <code>Tmin</code> and <code>Gmin</code> is dependent on the argument <code>tail</code>: when <code>tail = "above"</code>, these metrics consider bias that had operated to <em>increase</em> studies' point estimates, and when <code>tail = "below"</code>, these metrics consider bias that had operated to <em>decrease</em> studies' point estimates. Such bias could operate toward or away from the null depending on whether the pooled point estimate <code>yr</code> happens to fall above or below the null. As such, the direction of bias represented by <code>Tmin</code> and <code>Gmin</code> may or may not match that specified by the argument <code>muB.toward.null</code> (which is used only for estimation of <code>Prop</code>).
</p>



<h4>When these methods should be used</h4>

<p>These methods perform well only in meta-analyses with at least 10 studies; we do not recommend reporting them in smaller meta-analyses. Additionally, it only makes sense to consider proportions of effects stronger than a threshold when the heterogeneity estimate <code>t2</code> is greater than 0. For meta-analyses with fewer than 10 studies or with a heterogeneity estimate of 0, you can simply report E-values for the point estimate via <code><a href="#topic+evalue">evalue()</a></code> (VanderWeele &amp; Ding, 2017; see Mathur &amp; VanderWeele (2020a), Section 7.2 for interpretation in the meta-analysis context).
</p>



<h3>References</h3>

<p>Mathur MB &amp; VanderWeele TJ (2020a). Sensitivity analysis for unmeasured confounding in meta-analyses. <em>Journal of the American Statistical Association</em>.
</p>
<p>Mathur MB &amp; VanderWeele TJ (2020b). Robust metrics and sensitivity analyses for meta-analyses of heterogeneous effects. <em>Epidemiology</em>.
</p>
<p>Mathur MB &amp; VanderWeele TJ (2019). New statistical metrics for meta-analyses of heterogeneous effects. <em>Statistics in Medicine</em>.
</p>
<p>Ding P &amp; VanderWeele TJ (2016). Sensitivity analysis without assumptions. <em>Epidemiology</em>.
</p>
<p>VanderWeele TJ &amp; Ding P (2017). Introducing the E-value. <em>Annals of Internal Medicine</em>.
</p>
<p>Wang C-C &amp; Lee W-C (2019). A simple method to estimate prediction intervals and
predictive distributions: Summarizing meta-analyses
beyond means and confidence intervals. <em>Research Synthesis Methods</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##### Using Calibrated Method #####
d = metafor::escalc(measure="RR", ai=tpos, bi=tneg,
                    ci=cpos, di=cneg, data=metadat::dat.bcg)

# obtaining all three estimators and inference
# number of bootstrap iterates
# should be larger in practice
R = 100
confounded_meta( method="calibrated",  # for both methods
                 q = log(0.90),
                 r = 0.20,
                 tail="below",
                 muB = log(1.5),
                 dat = d,
                 yi.name = "yi",
                 vi.name = "vi",
                 R = 100 )

# passing only arguments needed for prop point estimate
confounded_meta( method="calibrated",
                 q = log(0.90),
                 tail="below",
                 muB = log(1.5),
                 give.CI = FALSE,
                 dat = d,
                 yi.name = "yi",
                 vi.name = "vi" )

# passing only arguments needed for Tmin, Gmin point estimates
confounded_meta( method="calibrated",
                 q = log(0.90),
                 r = 0.10,
                 tail="below",
                 give.CI = FALSE,
                 dat = d,
                 yi.name = "yi",
                 vi.name = "vi" )

##### Using Parametric Method #####
# fit random-effects meta-analysis
m = metafor::rma.uni(yi= d$yi,
                     vi=d$vi,
                     knha=TRUE,
                     measure="RR",
                     method="REML" )

yr = as.numeric(m$b)  # metafor returns on log scale
vyr = as.numeric(m$vb)
t2 = m$tau2
vt2 = m$se.tau2^2

# obtaining all three estimators and inference
# now the proportion considers heterogeneous bias
confounded_meta( method = "parametric",
                 q=log(0.90),
                 r=0.20,
                 tail = "below",
                 muB=log(1.5),
                 sigB=0.1,
                 yr=yr,
                 vyr=vyr,
                 t2=t2,
                 vt2=vt2,
                 CI.level=0.95 )

# passing only arguments needed for prop point estimate
confounded_meta( method = "parametric",
                 q=log(0.90),
                 tail = "below",
                 muB=log(1.5),
                 sigB = 0,
                 yr=yr,
                 t2=t2,
                 CI.level=0.95 )

# passing only arguments needed for Tmin, Gmin point estimates
confounded_meta( method = "parametric",
                 q = log(0.90),
                 sigB = 0,
                 r = 0.10,
                 tail = "below",
                 yr=yr,
                 t2=t2,
                 CI.level=0.95 )
</code></pre>

<hr>
<h2 id='confounding'>Unmeasured confounding</h2><span id='topic+confounding'></span>

<h3>Description</h3>

<p>A type of bias. Declares that unmeasured confounding will be a
component of interest in the multi-bias sensitivity analysis. Generally used
within other functions, its output is returned invisibly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confounding(..., verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confounding_+3A_...">...</code></td>
<td>
<p>Other arguments. Not currently used for this function.</p>
</td></tr>
<tr><td><code id="confounding_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, returns warnings and messages immediately.
Defaults to <code>FALSE</code> because it is generally used within the <code><a href="#topic+multi_bias">multi_bias()</a></code>
function, which will print the same messages/warnings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a list with components <code>n</code> (2, the degree of the
polynomial in the numerator), <code>d</code> (1, the degree of the polynomial in the
denominator), <code>mess</code> (any messages/warnings that should be printed for the
user), and <code>bias</code> (&quot;confounding&quot;).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># returns invisibly without print()
print(confounding())

# Calculate an E-value for unmeasured confounding only
multi_evalue(est = RR(4), biases = confounding())

</code></pre>

<hr>
<h2 id='convert_measures'>Convert an effect measure</h2><span id='topic+convert_measures'></span><span id='topic+toRR'></span><span id='topic+toMD'></span>

<h3>Description</h3>

<p>These helper functions are mostly used internally to convert
<a href="#topic+effect_measures">effect measures</a> for the calculation of E-values. The
approximate conversion of odds and hazard ratios to risk ratios depends on
whether the rare outcome assumption is made.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toRR(est, rare, delta = 1, ...)

toMD(est, delta = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_measures_+3A_est">est</code></td>
<td>
<p>The effect estimate; constructed with one of <code><a href="#topic+RR">RR()</a></code>, <code><a href="#topic+OR">OR()</a></code>, <code><a href="#topic+HR">HR()</a></code>,
<code><a href="#topic+MD">MD()</a></code>, <code><a href="#topic+OLS">OLS()</a></code>.</p>
</td></tr>
<tr><td><code id="convert_measures_+3A_rare">rare</code></td>
<td>
<p>When converting a <code><a href="#topic+OR">OR()</a></code> or <code><a href="#topic+HR">HR()</a></code> estimate, a logical indicating
whether the outcome is sufficiently rare to approximate a risk ratio.</p>
</td></tr>
<tr><td><code id="convert_measures_+3A_delta">delta</code></td>
<td>
<p>When converting an <code><a href="#topic+OLS">OLS()</a></code> estimate, the contrast of interest
in the exposure. Defaults to 1 (a 1-unit contrast in the exposure).</p>
</td></tr>
<tr><td><code id="convert_measures_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses the conversions listed in Table 2 of VanderWeele TJ, Ding P.
<em>Sensitivity Analysis in Observational Research: Introducing the E-Value.</em>
Annals of Internal Medicine. 2017;167(4):268–75.
</p>
<p>See references.
</p>
<p>Regarding the continuous outcome, the function uses the effect-size
conversions in Chinn (2000) and VanderWeele (2017) to approximately convert
the mean difference between these exposure &quot;groups&quot; to the odds ratio that
would arise from dichotomizing the continuous outcome.
</p>


<h3>Value</h3>

<p>An object of class &quot;estimate&quot; and the desired effect measure. Also
includes as an attribute its conversion history.
</p>


<h3>References</h3>

<p>Chinn, S (2000). A simple method for converting an odds ratio to
effect size for use in meta-analysis. <em>Statistics in Medicine</em>, 19(22),
3127-3131.
</p>
<p>VanderWeele, TJ (2017). On a square-root transformation of the odds ratio for
a common outcome. <em>Epidemiology</em>, 28(6), e58.
</p>
<p>VanderWeele TJ (2020). <em>Optimal approximate conversions of odds ratios and
hazard ratios to risk ratios.</em> Biometrics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Both odds ratios are 3, but will be treated differently
# depending on whether rare outcome assumption is reasonable
OR(3, rare = FALSE)
OR(3, rare = TRUE)
toRR(OR(3, rare = FALSE))
toRR(OR(3, rare = TRUE))
attributes(toRR(toMD(OLS(3, sd = 1.2), delta = 1)))
</code></pre>

<hr>
<h2 id='deg_func'>Internal function used to fit roots of a polynomial made up of the product of
bias factors.</h2><span id='topic+deg_func'></span>

<h3>Description</h3>

<p>Internal function used to fit roots of a polynomial made up of the product of
bias factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deg_func(x, y, n, d)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="deg_func_+3A_x">x</code></td>
<td>
<p>A number. The variable to solve for.</p>
</td></tr>
<tr><td><code id="deg_func_+3A_y">y</code></td>
<td>
<p>A number. The observed risk ratio.</p>
</td></tr>
<tr><td><code id="deg_func_+3A_n">n</code></td>
<td>
<p>A number. Degree of polynomial in the numerator.</p>
</td></tr>
<tr><td><code id="deg_func_+3A_d">d</code></td>
<td>
<p>A number. Degree of polynomial in the denominator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the value of the expression. Used for root solving. At the
function's roots, will return 0.
</p>

<hr>
<h2 id='effect_measures'>Declare an effect measure</h2><span id='topic+effect_measures'></span><span id='topic+RR'></span><span id='topic+OR'></span><span id='topic+HR'></span><span id='topic+RD'></span><span id='topic+OLS'></span><span id='topic+MD'></span>

<h3>Description</h3>

<p>These functions allow the user to declare that an estimate is a
certain type of effect measure: risk ratio (<code>RR</code>), odds ratio (<code>OR</code>),
hazard ratio (<code>HR</code>), risk difference (<code>RD</code>), linear regression coefficient
(<code>OLS</code>), or mean standardized difference (<code>MD</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RR(est)

OR(est, rare)

HR(est, rare)

RD(est)

OLS(est, sd)

MD(est)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="effect_measures_+3A_est">est</code></td>
<td>
<p>The effect estimate (numeric).</p>
</td></tr>
<tr><td><code id="effect_measures_+3A_rare">rare</code></td>
<td>
<p>Logical. Whether the outcome is sufficiently rare for use of risk
ratio approximates; if not, approximate conversions are used. Used only for
<code><a href="#topic+HR">HR()</a></code> and <code><a href="#topic+OR">OR()</a></code>; see Details.</p>
</td></tr>
<tr><td><code id="effect_measures_+3A_sd">sd</code></td>
<td>
<p>The standard deviation of the outcome (or residual standard
deviation). Used only for <code><a href="#topic+OLS">OLS()</a></code>; see Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <a href="#topic+convert_measures">conversion functions</a> use these objects to
convert between effect measures when necessary to calculate E-values. Read
more about the conversions in Table 2 of VanderWeele TJ, Ding P.
<em>Sensitivity Analysis in Observational Research: Introducing the E-Value.</em>
Annals of Internal Medicine. 2017;167(4):268–75.
</p>
<p>See also VanderWeele TJ. <em>Optimal approximate conversions of odds ratios
and hazard ratios to risk ratios.</em> Biometrics. 2019 Jan 6;(September
2018):1–7.
</p>
<p>For <code><a href="#topic+OLS">OLS()</a></code>, <code>sd</code> must be specified. A true standardized mean difference
for linear regression would use <code>sd</code> = SD( Y | X, C ), where Y is the
outcome, X is the exposure of interest, and C are any adjusted covariates.
See Examples for how to extract this from <code>lm</code>. A conservative
approximation would instead use <code>sd</code> = SD( Y ). Regardless, the
reported E-value for the confidence interval treats <code>sd</code> as known, not
estimated.
</p>


<h3>Value</h3>

<p>An object of classes &quot;estimate&quot; and the measure of interest,
containing the effect estimate and any other attributes to be used in
future calculations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Both odds ratios are 3, but will be treated differently in E-value calculations
# depending on whether rare outcome assumption is reasonable
OR(3, rare = FALSE)
OR(3, rare = TRUE)
evalue(OR(3, rare = FALSE))
evalue(OR(3, rare = TRUE))
attributes(OR(3, rare = FALSE))

# If an estimate was constructed via conversion from another effect measure,
# we can see the history of a conversion using the summary() function
summary(toRR(OR(3, rare = FALSE)))
summary(toRR(OLS(3, sd = 1)))

# Estimating sd for an OLS estimate
# first standardizing conservatively by SD(Y)
data(lead)
ols = lm(age ~ income, data = lead)
est = ols$coefficients[2]
sd = sd(lead$age)
summary(evalue(OLS(est, sd)))
# now use residual SD to avoid conservatism
# here makes very little difference because income and age are
# not highly correlated
sd = summary(ols)$sigma
summary(evalue(OLS(est, sd)))
</code></pre>

<hr>
<h2 id='evalue'>Compute an E-value for unmeasured confounding</h2><span id='topic+evalue'></span>

<h3>Description</h3>

<p>Returns a data frame containing point estimates, the lower confidence limit,
and the upper confidence limit on the risk ratio scale (possibly through an
approximate conversion) as well as E-values for the point estimate and the
confidence interval limit closer to the null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalue(est, lo = NA, hi = NA, se = NA, delta = 1, true = c(0, 1), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evalue_+3A_est">est</code></td>
<td>
<p>The effect estimate that was observed but which is suspected to be
biased. A number of class &quot;estimate&quot; (constructed with <code><a href="#topic+RR">RR()</a></code>, <code><a href="#topic+OR">OR()</a></code>,
<code><a href="#topic+HR">HR()</a></code>, <code><a href="#topic+OLS">OLS()</a></code>, or <code><a href="#topic+MD">MD()</a></code>; for E-values for risk differences,
see <code><a href="#topic+evalues.RD">evalues.RD()</a></code>).</p>
</td></tr>
<tr><td><code id="evalue_+3A_lo">lo</code></td>
<td>
<p>Optional. Lower bound of the confidence interval. If not an object
of class &quot;estimate&quot;, assumed to be on the same scale as <code>est</code>.</p>
</td></tr>
<tr><td><code id="evalue_+3A_hi">hi</code></td>
<td>
<p>Optional. Upper bound of the confidence interval. If not an object
of class &quot;estimate&quot;, assumed to be on the same scale as <code>est</code>.</p>
</td></tr>
<tr><td><code id="evalue_+3A_se">se</code></td>
<td>
<p>The standard error of the point estimate, for <code>est</code> of class &quot;OLS&quot;</p>
</td></tr>
<tr><td><code id="evalue_+3A_delta">delta</code></td>
<td>
<p>The contrast of interest in the exposure, for <code>est</code> of class &quot;OLS&quot;</p>
</td></tr>
<tr><td><code id="evalue_+3A_true">true</code></td>
<td>
<p>A number to which to shift the observed estimate to. Defaults to
1 for ratio measures (<code><a href="#topic+RR">RR()</a></code>, <code><a href="#topic+OR">OR()</a></code>, <code><a href="#topic+HR">HR()</a></code>) and 0 for additive measures
(<code><a href="#topic+OLS">OLS()</a></code>, <code><a href="#topic+MD">MD()</a></code>).</p>
</td></tr>
<tr><td><code id="evalue_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An E-value for unmeasured confounding is minimum strength of
association, on the risk ratio scale, that unmeasured confounder(s) would
need to have with both the treatment and the outcome to fully explain away
a specific treatment–outcome association, conditional on the measured
covariates.
</p>
<p>The estimate is converted appropriately before the E-value is calculated.
See <a href="#topic+convert_measures">conversion functions</a> for more details. The point
estimate and confidence limits after conversion are returned, as is the
E-value for the point estimate and the confidence limit closest to the
proposed &quot;true&quot; value (by default, the null value.)
</p>
<p>For an <code><a href="#topic+OLS">OLS()</a></code> estimate, the E-value is for linear regression with a
continuous exposure and outcome. Regarding the continuous exposure, the
choice of <code>delta</code> defines essentially a dichotomization in the
exposure between hypothetical groups of subjects with exposures equal to an
arbitrary value <em>c</em> versus to another hypothetical group with
exposures equal to <em>c</em> + <code>delta</code>.
</p>
<p>For example, if resulting E-value is 2, this means that unmeasured
confounder(s) would need to double the probability of a subject's having
exposure equal to <em>c</em> + <code>delta</code> instead of <em>c</em>, and would
also need to double the probability of being high versus low on the
outcome, in which the cutoff for &quot;high&quot; versus &quot;low&quot; is arbitrary subject
to some distributional assumptions (Chinn, 2000).
</p>


<h3>References</h3>


<ol>
<li><p> Ding &amp; VanderWeele (2016). Sensitivity analysis without assumptions. <em>Epidemiology.</em> 27(3), 368.
</p>
</li>
<li><p> VanderWeele &amp; Ding (2017). Sensitivity analysis in observational research: Introducing the E-value. <em>Annals of Internal Medicine.</em> 27(3), 368.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'># compute E-value for leukemia example in VanderWeele and Ding (2017)
evalue(RR(0.80), 0.71, 0.91)

# you can also pass just the point estimate
# and return just the E-value for the point estimate with summary()
summary(evalue(RR(0.80)))

# demonstrate symmetry of E-value
# this apparently causative association has same E-value as the above
summary(evalue(RR(1 / 0.80)))

# E-value for a non-null true value
summary(evalue(RR(2), true = 1.5))

## Hsu and Small (2013 Biometrics) Data
## sensitivity analysis after log-linear or logistic regression
head(lead)

## log linear model -- obtain the conditional risk ratio
lead.loglinear = glm(lead ~ ., family = binomial(link = "log"),
                         data = lead[,-1])
est_se = summary(lead.loglinear)$coef["smoking", c(1, 2)]

est      = RR(exp(est_se[1]))
lowerRR  = exp(est_se[1] - 1.96*est_se[2])
upperRR  = exp(est_se[1] + 1.96*est_se[2])
evalue(est, lowerRR, upperRR)

## logistic regression -- obtain the conditional odds ratio
lead.logistic = glm(lead ~ ., family = binomial(link = "logit"),
                        data = lead[,-1])
est_se = summary(lead.logistic)$coef["smoking", c(1, 2)]

est      = OR(exp(est_se[1]), rare = FALSE)
lowerOR  = exp(est_se[1] - 1.96*est_se[2])
upperOR  = exp(est_se[1] + 1.96*est_se[2])
evalue(est, lowerOR, upperOR)

## linear regression
# standardizing conservatively by SD(Y)
ols = lm(age ~ income, data = lead)
est = OLS(ols$coefficients[2], sd = sd(lead$age))

# for a 1-unit increase in income 
evalue(est = est, 
       se = summary(ols)$coefficients['income', 'Std. Error'])

# for a 0.5-unit increase in income
evalue(est = est,
       se = summary(ols)$coefficients['income', 'Std. Error'],
       delta = 0.5)

# E-value for Cohen's d = 0.5 with SE = 0.25
evalue(est = MD(.5), se = .25)

# compute E-value for HR = 0.56 with CI: [0.46, 0.69]
# for a common outcome
evalue(HR(0.56, rare = FALSE), lo = 0.46, hi = 0.69)
# for a rare outcome
evalue(HR(0.56, rare = TRUE), lo = 0.46, hi = 0.69)
</code></pre>

<hr>
<h2 id='evalues.HR'>Compute E-value for a hazard ratio and its confidence interval limits</h2><span id='topic+evalues.HR'></span>

<h3>Description</h3>

<p>Returns a data frame containing point estimates, the lower confidence limit,
and the upper confidence limit on the risk ratio scale (through an
approximate conversion if needed when outcome is common ) as well as E-values
for the point estimate and the confidence interval limit closer to the null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalues.HR(est, lo = NA, hi = NA, rare = NA, true = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evalues.HR_+3A_est">est</code></td>
<td>
<p>The point estimate</p>
</td></tr>
<tr><td><code id="evalues.HR_+3A_lo">lo</code></td>
<td>
<p>The lower limit of the confidence interval</p>
</td></tr>
<tr><td><code id="evalues.HR_+3A_hi">hi</code></td>
<td>
<p>The upper limit of the confidence interval</p>
</td></tr>
<tr><td><code id="evalues.HR_+3A_rare">rare</code></td>
<td>
<p>1 if outcome is rare (&lt;15 percent at end of follow-up); 0 if
outcome is not rare (&gt;15 percent at end of follow-up)</p>
</td></tr>
<tr><td><code id="evalues.HR_+3A_true">true</code></td>
<td>
<p>The true HR to which to shift the observed point estimate.
Typically set to 1 to consider a null true effect.</p>
</td></tr>
<tr><td><code id="evalues.HR_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># compute E-value for HR = 0.56 with CI: [0.46, 0.69]
# for a common outcome
evalues.HR(0.56, 0.46, 0.69, rare = FALSE)
</code></pre>

<hr>
<h2 id='evalues.IC'>Compute an E-value for unmeasured confounding for an additive interaction contrast</h2><span id='topic+evalues.IC'></span>

<h3>Description</h3>

<p>Computes the E-value for an additive interaction contrast, representing the difference between stratum Z=1 and stratum Z=0
in the causal risk differences for a binary treatment X.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalues.IC(
  stat,
  true = 0,
  unidirBias = FALSE,
  unidirBiasDirection = NA,
  p1_1,
  p1_0,
  n1_1,
  n1_0,
  f1,
  p0_1,
  p0_0,
  n0_1,
  n0_0,
  f0,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evalues.IC_+3A_stat">stat</code></td>
<td>
<p>The statistic for which to compute the E-value (&quot;est&quot; for the interaction
contrast point estimate or &quot;CI&quot; for its lower confidence interval limit)</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_true">true</code></td>
<td>
<p>The true (unconfounded) value to which to shift the specified statistic (point estimate or confidence interval limit). Should be smaller than the confounded statistic.</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_unidirbias">unidirBias</code></td>
<td>
<p>Whether the direction of confounding bias is assumed to be the same
in both strata of Z (TRUE or FALSE); see Details</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_unidirbiasdirection">unidirBiasDirection</code></td>
<td>
<p>If bias is assumed to be unidirectional, its assumed direction (&quot;positive&quot;, &quot;negative&quot;, or &quot;unknown&quot;; see Details). If bias is not assumed to be unidirectional, this argument should be NA.</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_p1_1">p1_1</code></td>
<td>
<p>The probability of the outcome in stratum Z=1 with treatment X=1</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_p1_0">p1_0</code></td>
<td>
<p>The probability of the outcome in stratum Z=1 with treatment X=0</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_n1_1">n1_1</code></td>
<td>
<p>The sample size in stratum Z=1 with treatment X=1</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_n1_0">n1_0</code></td>
<td>
<p>The sample size in stratum Z=1 with treatment X=0</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_f1">f1</code></td>
<td>
<p>The probability in stratum Z=1 of having treatment X=1</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_p0_1">p0_1</code></td>
<td>
<p>The probability of the outcome in stratum Z=0 with treatment X=1</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_p0_0">p0_0</code></td>
<td>
<p>The probability of the outcome in stratum Z=0 with treatment X=0</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_n0_1">n0_1</code></td>
<td>
<p>The sample size in stratum Z=0 with treatment X=1</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_n0_0">n0_0</code></td>
<td>
<p>The sample size in stratum Z=0 with treatment X=0</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_f0">f0</code></td>
<td>
<p>The probability in stratum Z=0 of treatment X=1</p>
</td></tr>
<tr><td><code id="evalues.IC_+3A_alpha">alpha</code></td>
<td>
<p>The alpha-level to be used for p-values and confidence intervals</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>E-values for additive effect modification</h4>

<p>The interaction contrast is a measure of additive effect modification that represents the difference between stratum Z=1 versus stratum Z=0 of the causal risk differences relating a treatment X to an outcome Y. The estimated interaction contrast is given by:
</p>
<p><code>(p1_1 - p1_0) - (p0_1 - p0_0)</code>
</p>
<p>To use this function, the strata (Z) should be coded such that the confounded interaction contrast is positive rather than negative.
</p>
<p>If, in one or both strata of Z, there are unmeasured confounders of the treatment-outcome association, then the interaction contrast may be biased as well (Mathur et al., 2021). The E-value for the interaction contrast represents the minimum strength of association, on the risk ratio scale, that unmeasured confounder(s) would need to have with both the treatment (X) and the outcome (Y) in both strata of Z to fully explain away the observed interaction contrast, conditional on the measured covariates. This bound is attained when the strata have confounding bias in opposite directions (&quot;potentially multidirectional bias&quot;). Alternatively, if one assumes that the direction of confounding is the same in each stratum of Z (&quot;unidirectional bias&quot;), then the E-value for the interaction contrast is defined as the minimum strength of association, on the risk ratio scale, that unmeasured confounder(s) would need to have with both the treatment (X) and the outcome (Y) in <em>at least one</em> stratum of Z to fully explain away the observed interaction contrast, conditional on the measured covariates. This bound under unidirectional confounding arises when one stratum is unbiased. See Mathur et al. (2021) for details.
</p>
<p>As for the standard E-value for main effects (Ding &amp; VanderWeele, 2016; VanderWeele &amp; Ding, 2017), the E-value for the interaction contrast can be computed for both the point estimate and the lower confidence interval limit, and it can be also be calculated for shifting the estimate or confidence interval to a non-null value via the argument <code>true</code>.
</p>



<h4>Specifying the bias direction</h4>

<p>The argument <code>unidirBias</code> indicates whether you are assuming unidirectional bias (<code>unidirBias = TRUE</code>) or not (<code>unidirBias = FALSE</code>). The latter is the default because it is more conservative and requires the fewest assumptions. When setting <code>unidirBias = FALSE</code>, there is no need to specify the direction of bias via <code>unidirBiasDir</code>. However, when setting <code>unidirBias = TRUE</code>, the direction of bias does need to be specified via <code>unidirBiasDir</code>, whose options are:
</p>

<ul>
<li> <p><code>unidirBiasDir = "positive"</code>: Assumes that the risk differences in both strata of Z are positively biased.
</p>
</li>
<li> <p><code>unidirBiasDir = "negative"</code>: Assumes that the risk differences in both strata of Z are negatively biased.
</p>
</li>
<li> <p><code>unidirBiasDir = "unknown"</code>: Assumes that the risk differences in both strata of Z are biased in the same direction, but that the direction could be either positive or negative.
</p>
</li></ul>




<h4>Adjusted interaction contrasts</h4>

<p>If your estimated interaction contrast has been adjusted for covariates, then you can use covariate-adjusted probabilities for <code>p1_1</code>, <code>p1_0</code>, <code>p0_1</code>, and <code>p0_0</code>. For example, these could be fitted probabilities from a covariate-adjusted regression model.
</p>



<h4>Multiplicative effect modification</h4>

<p>For multiplicative measures of effect modification (e.g., the ratio of risk ratios between the two strata of Z), you can simply use the function <code>evalue</code>. To allow the bias to be potentially multidirectional, you would pass the square-root of your multiplicative effect modification estimate on the risk ratio scale to <code>evalue</code> rather than the estimate itself. To assume unidirectional bias, regardless of direction, you would pass the multiplicative effect modification estimate itself to <code>evalue</code>. See Mathur et al. (2021) for details.
</p>



<h3>Value</h3>

<p>Returns a list containing two dataframes (<code>evalues</code> and <code>RDt</code>). The E-value itself can be accessed as <code>evalues$evalue</code>.
</p>
<p>The dataframe <code>evalues</code> contains the E-value, the corresponding bias factor, the bound on the interaction contrast if confounding were to attain that bias factor (this bound will be close to <code>true</code>, by construction), and the direction of bias when the bias factor is attained. If you specify that the bias is potentially multidirectional, is unidirectional and positive, or is unidirectional and negative, the returned direction of bias will simply be what you requested. If you specify unidirectional bias of unknown direction, the bias direction will be either positive or negative depending on which direction produces the maximum bias.
</p>
<p>The dataframe <code>RDt</code> contains, for each stratum and for the interaction contrast, bias-corrected estimates (risk differences for the strata and the interaction contrast for <code>stratum = effectMod</code>), their standard errors, their confidence intervals, and their p-values. These estimates are bias-corrected for the worst-case bias that could arise for confounder(s) whose strength of association are no more severe than the requested E-value for either the estimate or the confidence interval (i.e., the bias factor indicated by <code>evalues$biasFactor</code>). The bias-corrected risk differences for the two strata (<code>stratum = "1"</code> and <code>stratum = "0"</code>) are corrected in the direction(s) indicated by <code>evalues$biasDir</code>.
</p>
<p>If you specify unidirectional bias of unknown direction, the E-value is calculated by taking the minimum of the E-value under positive unidirectional bias and the E-value under negative unidirectional bias. With this specification, a third dataframe (<code>candidates</code>) will be returned. This is similar to <code>evalues</code>, but contains the results for positive unidirectional bias and negative unidirectional bias (the two &quot;candidate&quot; E-values that were considered).
</p>


<h3>References</h3>


<ol>
<li><p> Mathur MB, Smith LH, Yoshida K, Ding P, VanderWeele TJ (2021). E-values for effect modification and approximations for causal interaction. Under review.
</p>
</li>
<li><p> Ding P &amp; VanderWeele TJ (2016). Sensitivity analysis without assumptions. <em>Epidemiology.</em> 27(3), 368.
</p>
</li>
<li><p> VanderWeele TJ &amp; Ding P (2017). Sensitivity analysis in observational research: Introducing the E-value. <em>Annals of Internal Medicine.</em> 27(3), 368.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>### Letenneur et al. (2000) example data
# this is the example given in Mathur et al. (2021)
# Z: sex (w = women, m = male; males are the reference category)
# Y: dementia (1 = developed dementia, 0 = did not develop dementia )
# X: low education (1 = up to 7 years, 0 = at least 12 years)
# n: sample size

# data for women
nw_1 = 2988
nw_0 = 364
dw = data.frame(  Y = c(1, 1, 0, 0),
                  X = c(1, 0, 1, 0),
                  n = c( 158, 6, nw_1-158, nw_0-6 ) )

# data for men
nm_1 = 1790
nm_0 = 605
dm = data.frame(  Y = c(1, 1, 0, 0),
                  X = c(1, 0, 1, 0),
                  n = c( 64, 17, nm_1-64, nm_0-17 ) )

# P(Y = 1 | X = 1) and P(Y = 1 | X = 0) for women and for men
( pw_1 = dw$n[ dw$X == 1 &amp; dw$Y == 1 ] / sum(dw$n[ dw$X == 1 ]) )
( pw_0 = dw$n[ dw$X == 0 &amp; dw$Y == 1 ] / sum(dw$n[ dw$X == 0 ]) )
( pm_1 = dm$n[ dm$X == 1 &amp; dm$Y == 1 ] / sum(dm$n[ dm$X == 1 ]) )
( pm_0 = dm$n[ dm$X == 0 &amp; dm$Y == 1 ] / sum(dm$n[ dm$X == 0 ]) )

# prevalence of low education among women and among men
fw = nw_1 / (nw_1 + nw_0)
fm = nm_1 / (nm_1 + nm_0)

# confounded interaction contrast estimate
( pw_1 - pw_0 ) - ( pm_1 - pm_0 )

### E-values without making assumptions on direction of confounding bias
# for interaction contrast point estimate
evalues.IC( stat = "est",
       
            p1_1 = pw_1,
            p1_0 = pw_0,
            n1_1 = nw_1,
            n1_0 = nw_0,
            f1 = fw,
            
            p0_1 = pm_1,
            p0_0 = pm_0,
            n0_1 = nm_1,
            n0_0 = nm_0,
            f0 = fm )

# and for its lower CI limit
evalues.IC( stat = "CI",
            
            p1_1 = pw_1,
            p1_0 = pw_0,
            n1_1 = nw_1,
            n1_0 = nw_0,
            f1 = fw,
            
            p0_1 = pm_1,
            p0_0 = pm_0,
            n0_1 = nm_1,
            n0_0 = nm_0,
            f0 = fm )

### E-values assuming unidirectonal confounding of unknown direction
# for interaction contrast point estimate
evalues.IC( stat = "est",
            unidirBias = TRUE,
            unidirBiasDirection = "unknown",
            
            p1_1 = pw_1,
            p1_0 = pw_0,
            n1_1 = nw_1,
            n1_0 = nw_0,
            f1 = fw,
            
            p0_1 = pm_1,
            p0_0 = pm_0,
            n0_1 = nm_1,
            n0_0 = nm_0,
            f0 = fm )

# and for its lower CI limit
evalues.IC( stat = "CI",
            unidirBias = TRUE,
            unidirBiasDirection = "unknown",
            
            p1_1 = pw_1,
            p1_0 = pw_0,
            n1_1 = nw_1,
            n1_0 = nw_0,
            f1 = fw,
            
            p0_1 = pm_1,
            p0_0 = pm_0,
            n0_1 = nm_1,
            n0_0 = nm_0,
            f0 = fm )
</code></pre>

<hr>
<h2 id='evalues.MD'>Compute E-value for a difference of means and its confidence interval limits</h2><span id='topic+evalues.MD'></span>

<h3>Description</h3>

<p>Returns a data frame containing point estimates, the lower confidence limit,
and the upper confidence limit on the risk ratio scale (through an
approximate conversion) as well as E-values for the point estimate and the
confidence interval limit closer to the null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalues.MD(est, se = NA, true = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evalues.MD_+3A_est">est</code></td>
<td>
<p>The point estimate as a standardized difference (i.e., Cohen's d)</p>
</td></tr>
<tr><td><code id="evalues.MD_+3A_se">se</code></td>
<td>
<p>The standard error of the point estimate</p>
</td></tr>
<tr><td><code id="evalues.MD_+3A_true">true</code></td>
<td>
<p>The true standardized mean difference to which to shift the
observed point estimate. Typically set to 0 to consider a null true effect.</p>
</td></tr>
<tr><td><code id="evalues.MD_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Regarding the continuous outcome, the function uses the effect-size conversions in Chinn (2000)
and VanderWeele (2017) to approximately convert the mean difference between the exposed versus unexposed groups
to the odds ratio that would arise from dichotomizing the continuous outcome.
</p>
<p>For example, if resulting E-value is 2, this means that unmeasured confounder(s) would need to double
the probability of a subject's being exposed versus not being exposed, and would also need to
double the probability of being high versus low on the outcome, in which the cutoff for &quot;high&quot; versus
&quot;low&quot; is arbitrary subject to some distributional assumptions (Chinn, 2000).
</p>


<h3>References</h3>

<p>Chinn, S (2000). A simple method for converting an odds ratio to effect size for use in meta-analysis. <em>Statistics in Medicine</em>, 19(22), 3127-3131.
</p>
<p>VanderWeele, TJ (2017). On a square-root transformation of the odds ratio for a common outcome. <em>Epidemiology</em>, 28(6), e58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># compute E-value if Cohen's d = 0.5 with SE = 0.25
evalues.MD(.5, .25)
</code></pre>

<hr>
<h2 id='evalues.OLS'>Compute E-value for a linear regression coefficient estimate</h2><span id='topic+evalues.OLS'></span>

<h3>Description</h3>

<p>Returns a data frame containing point estimates, the lower confidence limit,
and the upper confidence limit on the risk ratio scale (through an
approximate conversion) as well as E-values for the point estimate and the
confidence interval limit closer to the null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalues.OLS(est, se = NA, sd, delta = 1, true = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evalues.OLS_+3A_est">est</code></td>
<td>
<p>The linear regression coefficient estimate (standardized or
unstandardized)</p>
</td></tr>
<tr><td><code id="evalues.OLS_+3A_se">se</code></td>
<td>
<p>The standard error of the point estimate</p>
</td></tr>
<tr><td><code id="evalues.OLS_+3A_sd">sd</code></td>
<td>
<p>The standard deviation of the outcome (or residual standard
deviation); see Details</p>
</td></tr>
<tr><td><code id="evalues.OLS_+3A_delta">delta</code></td>
<td>
<p>The contrast of interest in the exposure</p>
</td></tr>
<tr><td><code id="evalues.OLS_+3A_true">true</code></td>
<td>
<p>The true standardized mean difference to which to shift the
observed point estimate. Typically set to 0 to consider a null true effect.</p>
</td></tr>
<tr><td><code id="evalues.OLS_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is for linear regression with a continuous exposure
and outcome. Regarding the continuous exposure, the choice of <code>delta</code>
defines essentially a dichotomization in the exposure between hypothetical
groups of subjects with exposures equal to an arbitrary value <em>c</em> versus
to another hypothetical group with exposures equal to <em>c</em> +
<code>delta</code>. Regarding the continuous outcome, the function uses the
effect-size conversions in Chinn (2000) and VanderWeele (2017) to
approximately convert the mean difference between these exposure &quot;groups&quot; to
the odds ratio that would arise from dichotomizing the continuous outcome.
</p>
<p>For example, if resulting E-value is 2, this means that unmeasured
confounder(s) would need to double the probability of a subject's having
exposure equal to <em>c</em> + <code>delta</code> instead of <em>c</em>, and would also
need to double the probability of being high versus low on the outcome, in
which the cutoff for &quot;high&quot; versus &quot;low&quot; is arbitrary subject to some
distributional assumptions (Chinn, 2000).
</p>
<p>A true standardized mean difference for linear regression would use <code>sd</code>
= SD(Y | X, C), where Y is the outcome, X is the exposure of interest, and C
are any adjusted covariates. See Examples for how to extract this from
<code>lm</code>. A conservative approximation would instead use <code>sd</code> = SD(Y).
Regardless, the reported E-value for the confidence interval treats <code>sd</code>
as known, not estimated.
</p>


<h3>References</h3>

<p>Chinn, S (2000). A simple method for converting an odds ratio to
effect size for use in meta-analysis. <em>Statistics in Medicine</em>, 19(22),
3127-3131.
</p>
<p>VanderWeele, TJ (2017). On a square-root transformation of the odds ratio for
a common outcome. <em>Epidemiology</em>, 28(6), e58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># first standardizing conservatively by SD(Y)
data(lead)
ols = lm(age ~ income, data = lead)

# for a 1-unit increase in income
evalues.OLS(est = ols$coefficients[2],
            se = summary(ols)$coefficients['income', 'Std. Error'],
            sd = sd(lead$age))

# for a 0.5-unit increase in income
evalues.OLS(est = ols$coefficients[2],
            se = summary(ols)$coefficients['income', 'Std. Error'],
            sd = sd(lead$age),
            delta = 0.5)

# now use residual SD to avoid conservatism
# here makes very little difference because income and age are
# not highly correlated
evalues.OLS(est = ols$coefficients[2],
            se = summary(ols)$coefficients['income', 'Std. Error'],
            sd = summary(ols)$sigma)
</code></pre>

<hr>
<h2 id='evalues.OR'>Compute E-value for an odds ratio and its confidence interval limits</h2><span id='topic+evalues.OR'></span>

<h3>Description</h3>

<p>Returns a data frame containing point estimates, the lower confidence limit,
and the upper confidence limit on the risk ratio scale (through an
approximate conversion if needed when outcome is common) as well as E-values
for the point estimate and the confidence interval limit closer to the null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalues.OR(est, lo = NA, hi = NA, rare = NA, true = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evalues.OR_+3A_est">est</code></td>
<td>
<p>The point estimate</p>
</td></tr>
<tr><td><code id="evalues.OR_+3A_lo">lo</code></td>
<td>
<p>The lower limit of the confidence interval</p>
</td></tr>
<tr><td><code id="evalues.OR_+3A_hi">hi</code></td>
<td>
<p>The upper limit of the confidence interval</p>
</td></tr>
<tr><td><code id="evalues.OR_+3A_rare">rare</code></td>
<td>
<p>1 if outcome is rare (&lt;15 percent at end of follow-up); 0 if
outcome is not rare (&gt;15 percent at end of follow-up)</p>
</td></tr>
<tr><td><code id="evalues.OR_+3A_true">true</code></td>
<td>
<p>The true OR to which to shift the observed point estimate.
Typically set to 1 to consider a null true effect.</p>
</td></tr>
<tr><td><code id="evalues.OR_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># compute E-values for OR = 0.86 with CI: [0.75, 0.99]
# for a common outcome
evalues.OR(0.86, 0.75, 0.99, rare = FALSE)

## Example 2
## Hsu and Small (2013 Biometrics) Data
## sensitivity analysis after log-linear or logistic regression

head(lead)

## log linear model -- obtain the conditional risk ratio
lead.loglinear = glm(lead ~ ., family = binomial(link = "log"),
                         data = lead[,-1])
est = summary(lead.loglinear)$coef["smoking", c(1, 2)]

RR       = exp(est[1])
lowerRR  = exp(est[1] - 1.96*est[2])
upperRR  = exp(est[1] + 1.96*est[2])
evalues.RR(RR, lowerRR, upperRR)

## logistic regression -- obtain the conditional odds ratio
lead.logistic = glm(lead ~ ., family = binomial(link = "logit"),
                        data = lead[,-1])
est = summary(lead.logistic)$coef["smoking", c(1, 2)]

OR       = exp(est[1])
lowerOR  = exp(est[1] - 1.96*est[2])
upperOR  = exp(est[1] + 1.96*est[2])
evalues.OR(OR, lowerOR, upperOR, rare=FALSE)
</code></pre>

<hr>
<h2 id='evalues.RD'>Compute E-value for a population-standardized risk difference and its
confidence interval limits</h2><span id='topic+evalues.RD'></span>

<h3>Description</h3>

<p>Returns E-values for the point estimate and the lower confidence interval
limit for a positive risk difference. If the risk difference is negative, the
exposure coding should be first be reversed to yield a positive risk
difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalues.RD(n11, n10, n01, n00, true = 0, alpha = 0.05, grid = 1e-04, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evalues.RD_+3A_n11">n11</code></td>
<td>
<p>Number of exposed, diseased individuals</p>
</td></tr>
<tr><td><code id="evalues.RD_+3A_n10">n10</code></td>
<td>
<p>Number of exposed, non-diseased individuals</p>
</td></tr>
<tr><td><code id="evalues.RD_+3A_n01">n01</code></td>
<td>
<p>Number of unexposed, diseased individuals</p>
</td></tr>
<tr><td><code id="evalues.RD_+3A_n00">n00</code></td>
<td>
<p>Number of unexposed, non-diseased individuals</p>
</td></tr>
<tr><td><code id="evalues.RD_+3A_true">true</code></td>
<td>
<p>True value of risk difference to which to shift the point
estimate. Usually set to 0 to consider the null.</p>
</td></tr>
<tr><td><code id="evalues.RD_+3A_alpha">alpha</code></td>
<td>
<p>Alpha level</p>
</td></tr>
<tr><td><code id="evalues.RD_+3A_grid">grid</code></td>
<td>
<p>Spacing for grid search of E-value</p>
</td></tr>
<tr><td><code id="evalues.RD_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## example 1
## Hammond and Holl (1958 JAMA) Data
## Two by Two Table
##          Lung Cancer    No Lung Cancer
##Smoker    397            78557
##Nonsmoker 51             108778

# E-value to shift observed risk difference to 0
evalues.RD(397, 78557, 51, 108778)

# E-values to shift observed risk difference to other null values
evalues.RD(397, 78557, 51, 108778, true = 0.001)
</code></pre>

<hr>
<h2 id='evalues.RR'>Compute E-value for a risk ratio or rate ratio and its confidence interval
limits</h2><span id='topic+evalues.RR'></span>

<h3>Description</h3>

<p>Returns a data frame containing point estimates, the lower confidence limit,
and the upper confidence limit for the risk ratio (as provided by the user)
as well as E-values for the point estimate and the confidence interval limit
closer to the null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evalues.RR(est, lo = NA, hi = NA, true = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evalues.RR_+3A_est">est</code></td>
<td>
<p>The point estimate</p>
</td></tr>
<tr><td><code id="evalues.RR_+3A_lo">lo</code></td>
<td>
<p>The lower limit of the confidence interval</p>
</td></tr>
<tr><td><code id="evalues.RR_+3A_hi">hi</code></td>
<td>
<p>The upper limit of the confidence interval</p>
</td></tr>
<tr><td><code id="evalues.RR_+3A_true">true</code></td>
<td>
<p>The true RR to which to shift the observed point estimate.
Typically set to 1 to consider a null true effect.</p>
</td></tr>
<tr><td><code id="evalues.RR_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># compute E-value for leukemia example in VanderWeele and Ding (2017)
evalues.RR(0.80, 0.71, 0.91)

# you can also pass just the point estimate
evalues.RR(0.80)

# demonstrate symmetry of E-value
# this apparently causative association has same E-value as the above
evalues.RR(1 / 0.80)
</code></pre>

<hr>
<h2 id='lead'>An example dataset</h2><span id='topic+lead'></span>

<h3>Description</h3>

<p>An example dataset from Hsu and Small (Biometrics, 2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lead
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 3340 rows and 18 columns.
</p>

<hr>
<h2 id='misclassification'>Misclassification</h2><span id='topic+misclassification'></span>

<h3>Description</h3>

<p>A type of bias. Declares that (differential) misclassification
will be a component of interest in the multi-bias sensitivity analysis.
Generally used within other functions; its output is returned invisibly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>misclassification(
  ...,
  rare_outcome = FALSE,
  rare_exposure = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="misclassification_+3A_...">...</code></td>
<td>
<p>Arguments describing the type of misclassification. Currently two
options: &quot;outcome&quot; or &quot;exposure&quot;.</p>
</td></tr>
<tr><td><code id="misclassification_+3A_rare_outcome">rare_outcome</code></td>
<td>
<p>Logical. Is the outcome rare enough that outcome odds
ratios approximate risk ratios? Only needed when considering exposure
misclassification. Note that <code>rare_outcome = FALSE</code> returns an error, as
this option is not currently available.</p>
</td></tr>
<tr><td><code id="misclassification_+3A_rare_exposure">rare_exposure</code></td>
<td>
<p>Logical. Is the exposure rare enough that exposure odds
ratios approximate risk ratios? Only needed when considering exposure
misclassification.</p>
</td></tr>
<tr><td><code id="misclassification_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, returns warnings and messages immediately.
Defaults to <code>FALSE</code> because it is generally used within the <code><a href="#topic+multi_bias">multi_bias()</a></code>
function, which will print the same messages/warnings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a list with components whose values depend on the
options chosen: <code>n</code> (the degree of the polynomial in the numerator), <code>d</code>
(the degree of the polynomial in the denominator), <code>m</code> (the parameters in
the bias factor), <code>mess</code> (any messages/warnings that should be printed for
the user), and <code>bias</code>(&quot;misclassification&quot;).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># returns invisibly without print()
print(misclassification("outcome"))

# Calculate an E-value for misclassification
multi_evalue(est = RR(4),
         biases = misclassification("exposure",
                  rare_outcome = TRUE, rare_exposure = TRUE))

</code></pre>

<hr>
<h2 id='multi_bias'>Create a set of biases for a multi-bias sensitivity analysis</h2><span id='topic+multi_bias'></span>

<h3>Description</h3>

<p>Multiple biases (<code><a href="#topic+confounding">confounding()</a></code>, <code><a href="#topic+selection">selection()</a></code>, and/or
<code><a href="#topic+misclassification">misclassification()</a></code>) can be assessed simultaneously after creating a
<code>multi_bias</code> object using this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_bias(..., verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multi_bias_+3A_...">...</code></td>
<td>
<p>Biases (<code><a href="#topic+confounding">confounding()</a></code>, <code><a href="#topic+selection">selection()</a></code>, and/or
<code><a href="#topic+misclassification">misclassification()</a></code>), each possibly including arguments specifying more
detail about the bias of interest. Selection and confounding should be
listed in the order in which they affect the data (see <a href="../articles/multiple-bias.html#ordering-of-the-biases">ordering of the biases</a>)</p>
</td></tr>
<tr><td><code id="multi_bias_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, returns warnings and messages immediately.
Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a list with components whose values depend on the
options chosen: <code>n</code> (the degree of the polynomial in the numerator), <code>d</code>
(the degree of the polynomial in the denominator), <code>m</code> (the parameters in
the bias factor), <code>mess</code> (any messages/warnings that should be printed for
the user), and <code>bias</code>(&quot;misclassification&quot;).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>biases &lt;- multi_bias(confounding(),
                     selection("general"))

# print() lists the arguments for the multi_bound() function
print(biases)

# summary() provides more information
# with parameters in latex notation if latex = TRUE
summary(biases, latex = TRUE)

# Calculate a bound
multi_bound(biases = biases,
            RRAUc = 1.5, RRUcY = 2, RRUsYA1 = 1.25,
            RRSUsA1 = 4, RRUsYA0 = 3, RRSUsA0 = 2)
</code></pre>

<hr>
<h2 id='multi_bound'>Calculate a bound for the bias</h2><span id='topic+multi_bound'></span>

<h3>Description</h3>

<p>Function used to calculate the maximum factor by which a risk
ratio is biased, given possible values for each of the parameters that
describe the bias factors for each type of bias.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_bound(
  biases,
  RRAUc = NULL,
  RRUcY = NULL,
  RRUsYA1 = NULL,
  RRSUsA1 = NULL,
  RRUsYA0 = NULL,
  RRSUsA0 = NULL,
  RRAUscS = NULL,
  RRUscYS = NULL,
  RRAYy = NULL,
  ORYAa = NULL,
  RRYAa = NULL,
  RRAYyS = NULL,
  ORYAaS = NULL,
  RRYAaS = NULL,
  RRAUsS = NULL,
  RRUsYS = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multi_bound_+3A_biases">biases</code></td>
<td>
<p>A set of biases (or single bias) to include in the calculation
of the bound. A single object constructed with the <code><a href="#topic+multi_bias">multi_bias()</a></code> function,
it may include any or all of <code><a href="#topic+confounding">confounding()</a></code>, <code><a href="#topic+selection">selection()</a></code>, and
<code><a href="#topic+misclassification">misclassification()</a></code>, and any of the options described in the
documentation for those functions.</p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rrauc">RRAUc</code></td>
<td>
<p>Named parameter values with which to calculate a bound. Names must
correspond to the parameters defining the biases provided by <code>biases</code>. Help
with names can be found by running <code>print(multi_bias(...))</code> for the biases
of interest. Unnecessary parameters are ignored with a warning.</p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rrucy">RRUcY</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rrusya1">RRUsYA1</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rrsusa1">RRSUsA1</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rrusya0">RRUsYA0</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rrsusa0">RRSUsA0</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rrauscs">RRAUscS</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rruscys">RRUscYS</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rrayy">RRAYy</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_oryaa">ORYAa</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rryaa">RRYAa</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rrayys">RRAYyS</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_oryaas">ORYAaS</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rryaas">RRYAaS</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rrauss">RRAUsS</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
<tr><td><code id="multi_bound_+3A_rrusys">RRUsYS</code></td>
<td>
<p>See <code>RRAUc</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The names of the parameters in the bound can be found for a given
set of biases with <code>print(biases)</code>. Running <code>summary(biases)</code> shows the
equivalent notation used in the output of the <code><a href="#topic+multi_evalue">multi_evalue()</a></code> function.
</p>


<h3>Value</h3>

<p>Returns the value of the bound formed as a function of the provided
parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>multi_bound(multi_bias(confounding()),
            RRAUc = 2.2, RRUcY = 1.7)

biases &lt;- multi_bias(confounding(), selection("S = U"),
                     misclassification("exposure",
                     rare_outcome = TRUE, rare_exposure = FALSE))

print(biases)

multi_bound(biases,
            RRAUc = 3, RRUcY = 2, RRSUsA1 = 2.3,
            RRSUsA0 = 1.7, ORYAaS = 5.2)

</code></pre>

<hr>
<h2 id='multi_evalue'>Calculate a multiple-bias E-value</h2><span id='topic+multi_evalue'></span><span id='topic+multi_evalues.HR'></span><span id='topic+multi_evalues.OR'></span><span id='topic+multi_evalues.RR'></span>

<h3>Description</h3>

<p>Calculate an E-value for a specified set of biases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi_evalue(biases, est, ...)

multi_evalues.HR(
  biases,
  est,
  lo = NA,
  hi = NA,
  rare = NULL,
  true = 1,
  verbose = TRUE,
  ...
)

multi_evalues.OR(
  biases,
  est,
  lo = NA,
  hi = NA,
  rare = NULL,
  true = 1,
  verbose = TRUE,
  ...
)

multi_evalues.RR(biases, est, lo = NA, hi = NA, true = 1, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multi_evalue_+3A_biases">biases</code></td>
<td>
<p>An object created by <code><a href="#topic+multi_bias">multi_bias()</a></code> (or a single bias) to
include in the calculation of the E-value. May include any or all of
<code><a href="#topic+confounding">confounding()</a></code>, <code><a href="#topic+selection">selection()</a></code>, and <code><a href="#topic+misclassification">misclassification()</a></code>, and any of the
options described in the documentation for those functions.</p>
</td></tr>
<tr><td><code id="multi_evalue_+3A_est">est</code></td>
<td>
<p>The effect estimate that was observed but which is suspected to be
biased. This may be of class &quot;estimate&quot; (constructed with <code><a href="#topic+RR">RR()</a></code>, <code><a href="#topic+OR">OR()</a></code>,
or <code><a href="#topic+HR">HR()</a></code>, or more information can be provided using the other arguments.</p>
</td></tr>
<tr><td><code id="multi_evalue_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
<tr><td><code id="multi_evalue_+3A_lo">lo</code></td>
<td>
<p>Optional. Lower bound of the confidence interval. If not an object
of class &quot;estimate&quot;, assumed to be on the same scale as <code>est</code>.</p>
</td></tr>
<tr><td><code id="multi_evalue_+3A_hi">hi</code></td>
<td>
<p>Optional. Upper bound of the confidence interval. If not an object
of class &quot;estimate&quot;, assumed to be on the same scale as <code>est</code>.</p>
</td></tr>
<tr><td><code id="multi_evalue_+3A_rare">rare</code></td>
<td>
<p>Logical indicating whether outcome is sufficiently rare for
risk ratio approximation to hold.</p>
</td></tr>
<tr><td><code id="multi_evalue_+3A_true">true</code></td>
<td>
<p>A number to which to shift the observed estimate to. Defaults to
</p>

<ol>
<li><p> If not an object of class &quot;estimate&quot;, assumed to be on the same scale as
<code>est</code>.
</p>
</li></ol>
</td></tr>
<tr><td><code id="multi_evalue_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating whether or not to print information about
which parameters the multi-bias E-value refers to. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a multiple bias E-value, of class &quot;multi_evalue&quot;, describing
the value that each of a number of parameters would have to have for the
observed effect measure to be completely explained by bias.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Calculate an E-value for unmeasured confounding
multi_evalue(est = RR(4), biases = confounding())
# Equivalent to
evalues.RR(4)

# Calculate a multi-bias E-value for selection bias
# and misclassification
multi_evalue(est = RR(2.5),
         biases = multi_bias(selection("selected"),
                   misclassification("outcome")))

# Calculate a multi-bias E-value for all three
# available types of bias
biases &lt;- multi_bias(confounding(),
                     selection("general", "S = U"),
                     misclassification("exposure",
                            rare_outcome = TRUE))
multi_evalue(est = RR(2.5), biases = biases)

# Calculate a multi-bias E-value for a non-rare OR
# using the square root approximation
multi_evalue(est = OR(2.5, rare = FALSE), biases = biases)

# Calculate a non-null multi-bias E-value
multi_evalue(est = RR(2.5), biases = biases, true = 2)

</code></pre>

<hr>
<h2 id='selection'>Selection bias</h2><span id='topic+selection'></span>

<h3>Description</h3>

<p>A type of bias. Declares that selection bias will be a component
of interest in the multi-bias sensitivity analysis. Generally used within
other functions; its output is returned invisibly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selection(..., verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selection_+3A_...">...</code></td>
<td>
<p>Optional arguments describing the type of potential selection
bias. Options are &quot;general&quot; (general selection bias, the default if no
options are chosen), &quot;increased risk&quot; and &quot;decreased risk&quot; (assumptions
about the direction of risk in the selected population), &quot;S = U&quot;
(simplification used if the biasing characteristic is common to the entire
selected population), and &quot;selected&quot; (when the target of inference is the
selected population only). Errors are produced when incompatible
assumptions are chosen.</p>
</td></tr>
<tr><td><code id="selection_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, returns warnings and messages immediately.
Defaults to <code>FALSE</code> because it is generally used within the <code><a href="#topic+multi_bias">multi_bias()</a></code>
function, which will print the same messages/warnings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a list with components whose values depend on the
options chosen: <code>n</code> (the degree of the polynomial in the numerator), <code>d</code>
(the degree of the polynomial in the denominator),<code>mess</code> (any
messages/warnings that should be printed for the user), and
<code>bias</code>(&quot;selection&quot;).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># returns invisibly without print()
print(selection("general", "increased risk"))

# Calculate an E-value for selection bias only
multi_evalue(est = RR(4),
         biases = selection("general", "increased risk"))

</code></pre>

<hr>
<h2 id='selection_evalue'>Compute selection bias E-value for a hazard ratio and its confidence interval
limits</h2><span id='topic+selection_evalue'></span>

<h3>Description</h3>

<p>Returns a data frame containing point estimates, the lower confidence limit,
and the upper confidence limit on the risk ratio scale (through an
approximate conversion if needed when outcome is common) as well as E-values
for the point estimate and the confidence interval limit closer to the null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selection_evalue(
  est,
  lo = NA,
  hi = NA,
  true = 1,
  sel_pop = FALSE,
  S_eq_U = FALSE,
  risk_inc = FALSE,
  risk_dec = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="selection_evalue_+3A_est">est</code></td>
<td>
<p>The point estimate: a risk, odds, or hazard ratio. An object of
class &quot;estimate&quot;, it should be constructed with functions <code><a href="#topic+RR">RR()</a></code>, <code><a href="#topic+OR">OR()</a></code>,
or <code><a href="#topic+HR">HR()</a></code>.</p>
</td></tr>
<tr><td><code id="selection_evalue_+3A_lo">lo</code></td>
<td>
<p>The lower limit of the confidence interval</p>
</td></tr>
<tr><td><code id="selection_evalue_+3A_hi">hi</code></td>
<td>
<p>The upper limit of the confidence interval</p>
</td></tr>
<tr><td><code id="selection_evalue_+3A_true">true</code></td>
<td>
<p>The true value to which to shift the observed point estimate.
Typically set to 1 to consider a null true effect.</p>
</td></tr>
<tr><td><code id="selection_evalue_+3A_sel_pop">sel_pop</code></td>
<td>
<p>Whether inference is specific to selected population (TRUE) or
entire population (FALSE). Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="selection_evalue_+3A_s_eq_u">S_eq_U</code></td>
<td>
<p>Whether the unmeasured factor is assumed to be a defining
characteristic of the selected population. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="selection_evalue_+3A_risk_inc">risk_inc</code></td>
<td>
<p>Whether selection is assumed to be associated with increased
risk of the outcome in both exposure groups. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="selection_evalue_+3A_risk_dec">risk_dec</code></td>
<td>
<p>Whether selection is assumed to be associated with decreased
risk of the outcome in both exposure groups. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="selection_evalue_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A selection bias E-value is a summary measure that helps assess
susceptibility of a result to selection bias. Each of one or more
parameters characterizing the extent of the bias must be greater than or
equal to this value to be sufficient to shift an estimate (<code>est</code>) to
the null or other true value (<code>true</code>). The parameters, as defined in
Smith and VanderWeele 2019, depend on assumptions an investigator is
willing to make (see arguments <code>sel_pop</code>, <code>S_eq_U</code>,
<code>risk_inc</code>, <code>risk_dec</code>). The function prints a
message about which parameters the selection bias E-value refers to given
the assumptions made. See the cited article for details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples from Smith and VanderWeele 2019

# Zika virus example
selection_evalue(OR(73.1, rare = TRUE), lo = 13.0)

# Endometrial cancer example
selection_evalue(OR(2.30, rare = TRUE), true = 11.98, S_eq_U = TRUE, risk_inc = TRUE)

# Obesity paradox example
selection_evalue(RR(1.50), lo = 1.22, sel_pop = TRUE)

</code></pre>

<hr>
<h2 id='sens_plot'>Plots for sensitivity analyses</h2><span id='topic+sens_plot'></span>

<h3>Description</h3>

<p>Produces line plots (<code>type="line"</code>) showing the average bias factor across studies on the relative risk (RR) scale vs. the estimated proportion
of studies with true RRs above or below a chosen threshold <code>q</code>.
The plot secondarily includes a X-axis showing the minimum strength of confounding
to produce the given bias factor. The shaded region represents a pointwise confidence band.
Alternatively, produces distribution plots (<code>type="dist"</code>) for a specific bias factor showing the observed and
true distributions of RRs with a red line marking exp(<code>q</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sens_plot(
  method = "calibrated",
  type,
  q,
  CI.level = 0.95,
  tail = NA,
  muB.toward.null = FALSE,
  give.CI = TRUE,
  Bmin = 0,
  Bmax = log(4),
  breaks.x1 = NA,
  breaks.x2 = NA,
  muB,
  sigB,
  yr,
  vyr = NA,
  t2,
  vt2 = NA,
  R = 1000,
  dat = NA,
  yi.name = NA,
  vi.name = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sens_plot_+3A_method">method</code></td>
<td>
<p><code>"calibrated"</code> or <code>"parametric"</code>. See Details.</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_type">type</code></td>
<td>
<p><code>dist</code> for distribution plot; <code>line</code> for line plot (see Details)</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_q">q</code></td>
<td>
<p>True causal effect size chosen as the threshold for a meaningfully large effect</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_ci.level">CI.level</code></td>
<td>
<p>Pointwise confidence level as a proportion (e.g., 0.95).</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_tail">tail</code></td>
<td>
<p><code>"above"</code> for the proportion of effects above <code>q</code>; <code>"below"</code> for
the proportion of effects below <code>q</code>. By default, is set to <code>"above"</code> if the pooled point estimate (<code>method = "parametric"</code>) or median of the calibrated estimates (<code>method = "calibrated"</code>) is above 1 on the relative risk scale and is set to <code>"below"</code> otherwise.</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_mub.toward.null">muB.toward.null</code></td>
<td>
<p>Whether you want to consider bias that has on average shifted studies' point estimates away from the null (<code>FALSE</code>; the default) or that has on average shifted studies' point estimates toward the null (<code>TRUE</code>). See Details.</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_give.ci">give.CI</code></td>
<td>
<p>Logical. If <code>TRUE</code>, a pointwise confidence intervals is plotted.</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_bmin">Bmin</code></td>
<td>
<p>Lower limit of lower X-axis on the log scale (only needed if <code>type = "line"</code>).</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_bmax">Bmax</code></td>
<td>
<p>Upper limit of lower X-axis on the log scale (only needed if <code>type = "line"</code>)</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_breaks.x1">breaks.x1</code></td>
<td>
<p>Breaks for lower X-axis (bias factor) on RR scale. (optional for <code>type = "line"</code>; not used for <code>type = "dist"</code>).</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_breaks.x2">breaks.x2</code></td>
<td>
<p>Breaks for upper X-axis (confounding strength) on RR scale (optional for <code>type = "line"</code>; not used for <code>type = "dist"</code>)</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_mub">muB</code></td>
<td>
<p>Single mean bias factor on log scale (only needed if <code>type = "dist"</code>)</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_sigb">sigB</code></td>
<td>
<p>Standard deviation of log bias factor across studies (only used if <code>method = "parametric"</code>)</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_yr">yr</code></td>
<td>
<p>Pooled point estimate (on log scale) from confounded meta-analysis (only used if <code>method = "parametric"</code>)</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_vyr">vyr</code></td>
<td>
<p>Estimated variance of pooled point estimate from confounded meta-analysis (only used if <code>method = "parametric"</code>)</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_t2">t2</code></td>
<td>
<p>Estimated heterogeneity (<code class="reqn">\tau^2</code>) from confounded meta-analysis (only used if <code>method = "parametric"</code>)</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_vt2">vt2</code></td>
<td>
<p>Estimated variance of <code class="reqn">\tau^2</code> from confounded meta-analysis (only used if <code>method = "parametric"</code>)</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_r">R</code></td>
<td>
<p>Number  of  bootstrap  iterates for confidence interval estimation. Only used if <code>method = "calibrated"</code> and <code>give.CI = TRUE</code>.</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_dat">dat</code></td>
<td>
<p>Dataframe containing studies' point estimates and variances. Only used if <code>method = "calibrated"</code>.</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_yi.name">yi.name</code></td>
<td>
<p>Name of variable in <code>dat</code> containing studies' point estimates. Only used if <code>method = "calibrated"</code>.</p>
</td></tr>
<tr><td><code id="sens_plot_+3A_vi.name">vi.name</code></td>
<td>
<p>Name of variable in <code>dat</code> containing studies' variance estimates. Only used if <code>method = "calibrated"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls <code>confounded_meta</code> to get the point estimate and confidence interval at each value of the bias factor. See <code>?confounded_meta</code> for details.
</p>
<p>Note that <code>Bmin</code> and <code>Bmax</code> are specified on the log scale for consistency with the <code>muB</code> argument and with the function <code>confounded_meta</code>, whereas <code>breaks.x1</code> and <code>breaks.x2</code> are specified on the relative risk scale to facilitate adjustments to the plot appearance.
</p>


<h3>References</h3>

<p>Mathur MB &amp; VanderWeele TJ (2020a). Sensitivity analysis for unmeasured confounding in meta-analyses. <em>Journal of the American Statistical Association</em>.
</p>
<p>Mathur MB &amp; VanderWeele TJ (2020b). Robust metrics and sensitivity analyses for meta-analyses of heterogeneous effects. <em>Epidemiology</em>.
</p>
<p>Wang C-C &amp; Lee W-C (2019). A simple method to estimate prediction intervals and
predictive distributions: Summarizing meta-analyses
beyond means and confidence intervals. <em>Research Synthesis Methods</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##### Example 1: Calibrated Line Plots #####

# simulated dataset with exponentially distributed 
#  population effects
# we will use the calibrated method to avoid normality assumption
data(toyMeta)

# without confidence band
sens_plot( method = "calibrated",
           type="line",
           q=log(.9),
           tail = "below",
           dat = toyMeta,
           yi.name = "est",
           vi.name = "var",
           give.CI = FALSE )


# # with confidence band and a different threshold, q
# # commented out because takes a while too run
# sens_plot( method = "calibrated",
#            type="line",
#            q=0,
#            tail = "below",
#            dat = toyMeta,
#            yi.name = "est",
#            vi.name = "var",
#            give.CI = TRUE,
#            R = 300 ) # should be higher in practice


##### Example 2: Calibrated and Parametric Line Plots #####

# example dataset
d = metafor::escalc(measure="RR",
                    ai=tpos,
                    bi=tneg,
                    ci=cpos,
                    di=cneg,
                    data=metadat::dat.bcg)

# without confidence band
sens_plot( method = "calibrated",
           type="line",
           tail = "below",
           q=log(1.1),
           dat = d,
           yi.name = "yi",
           vi.name = "vi",
           give.CI = FALSE )

# # with confidence band
# # commented out because it takes a while
# # this example gives bootstrap warnings because of its small sample size
# sens_plot( method = "calibrated",
#            type="line",
#            q=log(1.1),
#            R = 500,  # should be higher in practice (e.g., 1000)
#            dat = d,
#            yi.name = "yi",
#            vi.name = "vi",
#            give.CI = TRUE )


# now with heterogeneous bias across studies (via sigB) and with confidence band
sens_plot( method = "parametric",
           type="line",
           q=log(1.1),
           yr=log(1.3),
           vyr = .05,
           vt2 = .001,
           t2=0.4,
           sigB = 0.1,
           Bmin=0,
           Bmax=log(4) )

##### Distribution Line Plot #####

# distribution plot: apparently causative
sens_plot( type="dist",
           q=log(1.1),
           muB=log(2),
           sigB = 0.1,
           yr=log(1.3),
           t2=0.4 )

# distribution plot: apparently preventive
sens_plot( type="dist",
           q=log(0.90),
           muB=log(1.5),
           sigB = 0.1,
           yr=log(0.7),
           t2=0.2 )
</code></pre>

<hr>
<h2 id='soyMeta'>A meta-analysis on soy intake and breast cancer risk (Trock et al., 2006)</h2><span id='topic+soyMeta'></span>

<h3>Description</h3>

<p>A meta-analysis of observational studies (12 case-control and six cohort or nested case-control) on the association of soy-food intake with breast cancer risk. Data are from Trock et al.'s (2006) Table 1. This dataset was used as the applied example in Mathur &amp; VanderWeele (2020a).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soyMeta
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 20 rows and 3 columns.
</p>


<h3>Details</h3>

<p>The variables are as follows:
</p>

<ul>
<li> <p><code>author</code> Last name of the study's first author.
</p>
</li>
<li> <p><code>est</code> Point estimate on the log-relative risk or log-odds ratio scale.
</p>
</li>
<li> <p><code>var</code> Variance of the log-relative risk or log-odds ratio.
</p>
</li></ul>



<h3>References</h3>

<p>Trock BJ, Hilakivi-Clarke L, Clark R (2006). Meta-analysis of soy intake and breast cancer risk. <em>Journal of the National Cancer Institute</em>.
</p>
<p>Mathur MB &amp; VanderWeele TJ (2020a). Sensitivity analysis for unmeasured confounding in meta-analyses. <em>Journal of the American Statistical Association</em>.
</p>

<hr>
<h2 id='svalues.HR'>Compute selection bias E-value for an estimate and its confidence interval
limits</h2><span id='topic+svalues.HR'></span>

<h3>Description</h3>

<p>Returns a data frame containing point estimates, the lower confidence limit,
and the upper confidence limit on the risk ratio scale (through an
approximate conversion if needed when outcome is common) as well as selection bias
E-values for the point estimate and the confidence interval limit closer to the null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svalues.HR(
  est,
  lo = NA,
  hi = NA,
  rare = NA,
  true = 1,
  sel_pop = FALSE,
  S_eq_U = FALSE,
  risk_inc = FALSE,
  risk_dec = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="svalues.HR_+3A_est">est</code></td>
<td>
<p>The point estimate</p>
</td></tr>
<tr><td><code id="svalues.HR_+3A_lo">lo</code></td>
<td>
<p>The lower limit of the confidence interval</p>
</td></tr>
<tr><td><code id="svalues.HR_+3A_hi">hi</code></td>
<td>
<p>The upper limit of the confidence interval</p>
</td></tr>
<tr><td><code id="svalues.HR_+3A_rare">rare</code></td>
<td>
<p>1 if outcome is rare (&lt;15 percent at end of follow-up); 0 if
outcome is not rare (&gt;15 percent at end of follow-up)</p>
</td></tr>
<tr><td><code id="svalues.HR_+3A_true">true</code></td>
<td>
<p>The true HR to which to shift the observed point estimate.
Typically set to 1 to consider a null true effect.</p>
</td></tr>
<tr><td><code id="svalues.HR_+3A_sel_pop">sel_pop</code></td>
<td>
<p>Whether inference is specific to selected population (TRUE) or
entire population (FALSE). Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.HR_+3A_s_eq_u">S_eq_U</code></td>
<td>
<p>Whether the unmeasured factor is assumed to be a defining
characteristic of the selected population. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.HR_+3A_risk_inc">risk_inc</code></td>
<td>
<p>Whether selection is assumed to be associated with increased
risk of the outcome in both exposure groups. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.HR_+3A_risk_dec">risk_dec</code></td>
<td>
<p>Whether selection is assumed to be associated with decreased
risk of the outcome in both exposure groups. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.HR_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A selection bias E-value is a summary measure that helps assess
susceptibility of a result to selection bias. Each of one or more
parameters characterizing the extent of the bias must be greater than or
equal to this value to be sufficient to shift an estimate (<code>est</code>) to
the null or other true value (<code>true</code>). The parameters, as defined in
Smith and VanderWeele 2019, depend on assumptions an investigator is
willing to make (see arguments <code>sel_pop</code>, <code>S_eq_U</code>,
<code>risk_inc</code>, <code>risk_dec</code>). The <code>svalues.XX</code> functions print a
message about which parameters the selection bias E-value refers to given
the assumptions made. See the cited article for details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples from Smith and VanderWeele 2019

# Obesity paradox example
svalues.RR(est = 1.50, lo = 1.22, sel_pop = TRUE)
</code></pre>

<hr>
<h2 id='svalues.OR'>Compute selection bias E-value for an odds ratio and its confidence interval
limits</h2><span id='topic+svalues.OR'></span>

<h3>Description</h3>

<p>Returns a data frame containing point estimates, the lower confidence limit,
and the upper confidence limit on the risk ratio scale (through an
approximate conversion if needed when outcome is common) as well as E-values
for the point estimate and the confidence interval limit closer to the null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svalues.OR(
  est,
  lo = NA,
  hi = NA,
  rare = NA,
  true = 1,
  sel_pop = FALSE,
  S_eq_U = FALSE,
  risk_inc = FALSE,
  risk_dec = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="svalues.OR_+3A_est">est</code></td>
<td>
<p>The point estimate</p>
</td></tr>
<tr><td><code id="svalues.OR_+3A_lo">lo</code></td>
<td>
<p>The lower limit of the confidence interval</p>
</td></tr>
<tr><td><code id="svalues.OR_+3A_hi">hi</code></td>
<td>
<p>The upper limit of the confidence interval</p>
</td></tr>
<tr><td><code id="svalues.OR_+3A_rare">rare</code></td>
<td>
<p>1 if outcome is rare (&lt;15 percent at end of follow-up); 0 if
outcome is not rare (&gt;15 percent at end of follow-up)</p>
</td></tr>
<tr><td><code id="svalues.OR_+3A_true">true</code></td>
<td>
<p>The true OR to which to shift the observed point estimate.
Typically set to 1 to consider a null true effect.</p>
</td></tr>
<tr><td><code id="svalues.OR_+3A_sel_pop">sel_pop</code></td>
<td>
<p>Whether inference is specific to selected population (TRUE) or
entire population (FALSE). Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.OR_+3A_s_eq_u">S_eq_U</code></td>
<td>
<p>Whether the unmeasured factor is assumed to be a defining
characteristic of the selected population. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.OR_+3A_risk_inc">risk_inc</code></td>
<td>
<p>Whether selection is assumed to be associated with increased
risk of the outcome in both exposure groups. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.OR_+3A_risk_dec">risk_dec</code></td>
<td>
<p>Whether selection is assumed to be associated with decreased
risk of the outcome in both exposure groups. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.OR_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A selection bias E-value is a summary measure that helps assess
susceptibility of a result to selection bias. Each of one or more
parameters characterizing the extent of the bias must be greater than or
equal to this value to be sufficient to shift an estimate (<code>est</code>) to
the null or other true value (<code>true</code>). The parameters, as defined in
Smith and VanderWeele 2019, depend on assumptions an investigator is
willing to make (see arguments <code>sel_pop</code>, <code>S_eq_U</code>,
<code>risk_inc</code>, <code>risk_dec</code>). The <code>svalues.XX</code> functions print a
message about which parameters the selection bias E-value refers to given
the assumptions made. See the cited article for details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples from Smith and VanderWeele 2019

# Zika virus example
svalues.OR(est = 73.1, rare = TRUE, lo = 13.0)

# Endometrial cancer example
svalues.OR(est = 2.30, rare = TRUE, true = 11.98, S_eq_U = TRUE, risk_inc = TRUE)
</code></pre>

<hr>
<h2 id='svalues.RR'>Compute selection bias E-value for a risk ratio or rate ratio and its
confidence interval limits</h2><span id='topic+svalues.RR'></span>

<h3>Description</h3>

<p>Returns a data frame containing point estimates, the lower confidence limit,
and the upper confidence limit for the risk ratio (as provided by the user)
as well as selection bias E-values for the point estimate and the confidence
interval limit closer to the null.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>svalues.RR(
  est,
  lo = NA,
  hi = NA,
  true = 1,
  sel_pop = FALSE,
  S_eq_U = FALSE,
  risk_inc = FALSE,
  risk_dec = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="svalues.RR_+3A_est">est</code></td>
<td>
<p>The point estimate</p>
</td></tr>
<tr><td><code id="svalues.RR_+3A_lo">lo</code></td>
<td>
<p>The lower limit of the confidence interval</p>
</td></tr>
<tr><td><code id="svalues.RR_+3A_hi">hi</code></td>
<td>
<p>The upper limit of the confidence interval</p>
</td></tr>
<tr><td><code id="svalues.RR_+3A_true">true</code></td>
<td>
<p>The true RR to which to shift the observed point estimate.
Typically set to 1 to consider a null true effect.</p>
</td></tr>
<tr><td><code id="svalues.RR_+3A_sel_pop">sel_pop</code></td>
<td>
<p>Whether inference is specific to selected population (TRUE) or
entire population (FALSE). Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.RR_+3A_s_eq_u">S_eq_U</code></td>
<td>
<p>Whether the unmeasured factor is assumed to be a defining
characteristic of the selected population. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.RR_+3A_risk_inc">risk_inc</code></td>
<td>
<p>Whether selection is assumed to be associated with increased
risk of the outcome in both exposure groups. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.RR_+3A_risk_dec">risk_dec</code></td>
<td>
<p>Whether selection is assumed to be associated with decreased
risk of the outcome in both exposure groups. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="svalues.RR_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A selection bias E-value is a summary measure that helps assess
susceptibility of a result to selection bias. Each of one or more parameters
characterizing the extent of the bias must be greater than or equal to this
value to be sufficient to shift an estimate (<code>est</code>) to the null or other
true value (<code>true</code>). The parameters, as defined in Smith and VanderWeele
2019, depend on assumptions an investigator is willing to make (see arguments
<code>sel_pop</code>, <code>S_eq_U</code>, <code>risk_inc</code>, <code>risk_dec</code>). The
<code>svalues.XX</code> functions print a message about which parameters the
selection bias E-value refers to given the assumptions made. See the cited
article for details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples from Smith and VanderWeele 2019

# Zika virus example
svalues.RR(est = 73.1, lo = 13.0)

# Endometrial cancer example
svalues.RR(est = 2.30, true = 11.98, S_eq_U = TRUE, risk_inc = TRUE)

# Obesity paradox example
svalues.RR(est = 1.50, lo = 1.22, sel_pop = TRUE)
</code></pre>

<hr>
<h2 id='threshold'>Compute E-value for single value of risk ratio</h2><span id='topic+threshold'></span>

<h3>Description</h3>

<p>Computes E-value for a single value of the risk ratio. Users should typically
call the relevant <code>evalues.XX()</code> function rather than this internal
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threshold(x, true = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="threshold_+3A_x">x</code></td>
<td>
<p>The risk ratio</p>
</td></tr>
<tr><td><code id="threshold_+3A_true">true</code></td>
<td>
<p>The true RR to which to shift the observed point estimate.
Typically set to 1 to consider a null true effect.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1
## Hammond and Holl (1958 JAMA) Data
## Two by Two Table
#          Lung Cancer    No Lung Cancer
# Smoker    397            78557
# Nonsmoker 51             108778

# first get RR and CI bounds
twoXtwoRR(397, 78557, 51, 108778)

# then compute E-values
evalues.RR(10.729780, 8.017457, 14.359688)
</code></pre>

<hr>
<h2 id='threshold_selection'>Compute selection bias E-value for single value of risk ratio as well as a
statement about what parameters it refers to</h2><span id='topic+threshold_selection'></span>

<h3>Description</h3>

<p>Computes selection bias E-value for a single value of the risk ratio. Users
should typically call the relevant <code>svalues.XX()</code> function rather than
this internal function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threshold_selection(
  x,
  true = 1,
  sel_pop = FALSE,
  S_eq_U = FALSE,
  risk_inc = FALSE,
  risk_dec = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="threshold_selection_+3A_x">x</code></td>
<td>
<p>The risk ratio</p>
</td></tr>
<tr><td><code id="threshold_selection_+3A_true">true</code></td>
<td>
<p>The true RR to which to shift the observed point estimate.
Typically set to 1 to consider a null true effect.</p>
</td></tr>
<tr><td><code id="threshold_selection_+3A_sel_pop">sel_pop</code></td>
<td>
<p>Whether inference is specific to selected population (TRUE) or
entire population (FALSE). Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="threshold_selection_+3A_s_eq_u">S_eq_U</code></td>
<td>
<p>Whether the unmeasured factor is assumed to be a defining
characteristic of the selected population. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="threshold_selection_+3A_risk_inc">risk_inc</code></td>
<td>
<p>Whether selection is assumed to be associated with increased
risk of the outcome in both exposure groups. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="threshold_selection_+3A_risk_dec">risk_dec</code></td>
<td>
<p>Whether selection is assumed to be associated with decreased
risk of the outcome in both exposure groups. Defaults to FALSE.</p>
</td></tr>
</table>

<hr>
<h2 id='toyMeta'>An example meta-analysis</h2><span id='topic+toyMeta'></span>

<h3>Description</h3>

<p>A simple simulated meta-analysis of 50 studies with exponentially distributed population effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toyMeta
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 50 rows and 2 columns.
</p>


<h3>Details</h3>

<p>The variables are as follows:
</p>

<ul>
<li> <p><code>est</code> Point estimate on the log-relative risk scale.
</p>
</li>
<li> <p><code>var</code> Variance of the log-relative risk.
</p>
</li></ul>


<hr>
<h2 id='twoXtwoRR'>Estimate risk ratio and compute CI limits from two-by-two table</h2><span id='topic+twoXtwoRR'></span>

<h3>Description</h3>

<p>Given counts in a two-by-two table, computes risk ratio and confidence
interval limits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twoXtwoRR(n11, n10, n01, n00, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="twoXtwoRR_+3A_n11">n11</code></td>
<td>
<p>Number exposed (X=1) and diseased (D=1)</p>
</td></tr>
<tr><td><code id="twoXtwoRR_+3A_n10">n10</code></td>
<td>
<p>Number exposed (X=1) and not diseased (D=0)</p>
</td></tr>
<tr><td><code id="twoXtwoRR_+3A_n01">n01</code></td>
<td>
<p>Number unexposed (X=0) and diseased (D=1)</p>
</td></tr>
<tr><td><code id="twoXtwoRR_+3A_n00">n00</code></td>
<td>
<p>Number unexposed (X=0) and not diseased (D=0)</p>
</td></tr>
<tr><td><code id="twoXtwoRR_+3A_alpha">alpha</code></td>
<td>
<p>Alpha level associated with confidence interval</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Hammond and Holl (1958 JAMA) Data
# Two by Two Table
#          Lung Cancer    No Lung Cancer
# Smoker    397            78557
# Nonsmoker 51             108778

twoXtwoRR(397, 78557, 51, 108778)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
