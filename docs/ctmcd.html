<!DOCTYPE html><html><head><title>Help for package ctmcd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ctmcd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ctmcd-package'>
<p>Estimating the Parameters of a Continuous-Time Markov Chain from</p>
Discrete-Time Data</a></li>
<li><a href='#ctmcdlogLik'>
<p>Discrete-Time Data Log-Likelihood Function</p></a></li>
<li><a href='#gm'>
<p>Generator Matrix Estimation</p></a></li>
<li><a href='#gm.default'>
<p>Generator Matrix Estimation</p></a></li>
<li><a href='#gmci'>
<p>Confidence / Credibility Intervals for Generator Matrix Objects</p></a></li>
<li><a href='#gmci.default'>
<p>Confidence / Credibility Intervals for Generator Matrix Objects</p></a></li>
<li><a href='#gmDA'>
<p>Diagonal Adjustment</p></a></li>
<li><a href='#gmEM'>
<p>Expectation-Maximization Algorithm</p></a></li>
<li><a href='#gmGS'>
<p>Gibbs Sampler</p></a></li>
<li><a href='#gmQO'>
<p>Quasi-Optimization</p></a></li>
<li><a href='#gmWA'>
<p>Weighted Adjustment</p></a></li>
<li><a href='#plot.gm'>
<p>Plot Function for Generator Matrix Estimation Objects</p></a></li>
<li><a href='#plot.gmci'>
<p>Plot Function for Generator Matrix Confidence / Credibility Interval Objects</p></a></li>
<li><a href='#plotM'>
<p>Matrix Plot Function</p></a></li>
<li><a href='#print.gm'>
<p>Print Method for Generator Matrix Estimation Objects</p></a></li>
<li><a href='#print.gmci'>
<p>Print Method for Generator Matrix Confidence / Credibility Interval Objects</p></a></li>
<li><a href='#rNijTRiT_ModRej'>
<p>C++ Based Modified Rejection Sampling</p></a></li>
<li><a href='#rNijTRiT_Unif'>
<p>C++ Based Uniformization Sampling</p></a></li>
<li><a href='#summary.gm'>
<p>Extended Output for Generator Matrix Estimate Objects</p></a></li>
<li><a href='#tm_abs'>
<p>Single Year Corporate Credit Rating Transititions</p></a></li>
<li><a href='#tmci'>
<p>Delta Method Confidence Intervals for Matrix Exponential Transformations of Generator Matrix Objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimating the Parameters of a Continuous-Time Markov Chain from
Discrete-Time Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-07</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of Markov generator matrices from discrete-time observations. The implemented approaches comprise diagonal and weighted adjustment of matrix logarithm based candidate solutions as in Israel (2001) &lt;<a href="https://doi.org/10.1111%2F1467-9965.00114">doi:10.1111/1467-9965.00114</a>&gt; as well as a quasi-optimization approach. Moreover, the expectation-maximization algorithm and the Gibbs sampling approach of Bladt and Sorensen (2005) &lt;<a href="https://doi.org/10.1111%2Fj.1467-9868.2005.00508.x">doi:10.1111/j.1467-9868.2005.00508.x</a>&gt; are included.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.12), coda, expm, numDeriv</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, R.rsp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-08 18:35:26 UTC; Stefan</td>
</tr>
<tr>
<td>Author:</td>
<td>Marius Pfeuffer [aut, cre],
  Greig Smith [ctb],
  Goncalo dos Reis [ctb],
  Linda Moestel [ctb],
  Matthias Fischer [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marius Pfeuffer &lt;marius.pfeuffer@fau.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-09 09:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ctmcd-package'>
Estimating the Parameters of a Continuous-Time Markov Chain from
Discrete-Time Data
</h2><span id='topic+ctmcd-package'></span><span id='topic+ctmcd'></span>

<h3>Description</h3>

<p>Functions for estimating Markov generator matrices from discrete-time observations.
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer [aut, cre],
  Greig Smith [ctb],
  Goncalo dos Reis [ctb],
  Linda Moestel [ctb],
  Matthias Fischer [ctb]
</p>
<p>Maintainer: Marius Pfeuffer &lt;marius.pfeuffer@fau.de&gt;
</p>


<h3>References</h3>

<p>M. Pfeuffer: ctmcd: An R Package for Estimating the Parameters of a Continuous-Time Markov Chain from Discrete-Time Data. The R Journal 9(2):127-141, 2017
</p>
<p>M. Pfeuffer. Generator Matrix Approximation Based on Discrete-Time Rating Migration Data. Master
Thesis, Ludwig Maximilian University of Munich, 2016
</p>
<p>R. B. Israel et al.: Finding Generators for Markov Chains via Empirical Transition Matrices, with Applications to Credit Ratings. Mathematical Finance 11(2):245-265, 2001
</p>
<p>E. Kreinin and M. Sidelnikova: Regularization Algorithms for Transition Matrices. Algo Research Quarterly 4(1):23-40, 2001
</p>
<p>M. Bladt and M. Soerensen: Statistical Inference for Discretely Observed Markov Jump Processes. Journal of the Royal Statistical Society B 67(3):395-410, 2005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(tm_abs)

## Maximum Likelihood Generator Matrix Estimate
gm0=matrix(1,8,8)
diag(gm0)=0
diag(gm0)=-rowSums(gm0)
gm0[8,]=0

gmem=gm(tm_abs,te=1,method="EM",gmguess=gm0)
plot(gmem)

## Confidence Interval
ciem=gmci(gmem,alpha=0.05)
plot(ciem)

</code></pre>

<hr>
<h2 id='ctmcdlogLik'>
Discrete-Time Data Log-Likelihood Function
</h2><span id='topic+ctmcdlogLik'></span>

<h3>Description</h3>

<p>Function for evaluating the likelihood function of a continuous-time Markov chain given discrete-time data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctmcdlogLik(gm, tmabs, te)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ctmcdlogLik_+3A_gm">gm</code></td>
<td>

<p>generator matrix of continuous-time Markov chain
</p>
</td></tr>
<tr><td><code id="ctmcdlogLik_+3A_tmabs">tmabs</code></td>
<td>

<p>matrix of absolute transition frequencies
</p>
</td></tr>
<tr><td><code id="ctmcdlogLik_+3A_te">te</code></td>
<td>

<p>time elapsed in transition process
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>log-likelihood value
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tm_abs)

## Initial guess for generator matrix (absorbing default state)
gm0=matrix(1,8,8)
diag(gm0)=0
diag(gm0)=-rowSums(gm0)
gm0[8,]=0

## Log-likelihood of initial guess
ctmcdlogLik(gm0,tm_abs,1)
</code></pre>

<hr>
<h2 id='gm'>
Generator Matrix Estimation
</h2><span id='topic+gm'></span>

<h3>Description</h3>

<p>Generic function to estimate the parameters of a continuous Markov chain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gm(tm, te, method, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gm_+3A_tm">tm</code></td>
<td>

<p>matrix of either absolute transition frequencies (if method is &quot;EM&quot; or &quot;GS&quot;) or relative transition frequencies (if method is &quot;DA&quot;, &quot;WA&quot; of &quot;QO&quot;)
</p>
</td></tr>
<tr><td><code id="gm_+3A_te">te</code></td>
<td>

<p>time elapsed in transition process
</p>
</td></tr>
<tr><td><code id="gm_+3A_method">method</code></td>
<td>

<p>method to derive generator matrix: &quot;DA&quot; - Diagonal Adjustment, &quot;WA&quot; - Weighted Adjustment, &quot;QO&quot; - Quasi-Optimization, &quot;EM&quot; - Expectation-Maximization Algorithm, &quot;GS&quot; - Gibbs Sampler
</p>
</td></tr>
<tr><td><code id="gm_+3A_...">...</code></td>
<td>
<p>Additional Arguments:
</p>

<ul>
<li><p> gmguess: initial guess for generator matrix estimation procedure (if method is &quot;EM&quot;)
</p>
</li>
<li><p> prior: prior parametrization (if method is &quot;GS&quot;)
</p>
</li>
<li><p> burnin: burn-in period (if method is &quot;GS&quot;)
</p>
</li>
<li><p> eps: convergence criterion (if method is &quot;EM&quot;)
</p>
</li>
<li><p> conv_pvalue,conv_freq: convergence criterion (if method is &quot;GS&quot;)
</p>
</li>
<li><p> niter: maximum number of iterations (if method is &quot;EM&quot; or &quot;GS&quot;)
</p>
</li>
<li><p> sampl_func: optional self-written path sampling function for endpoint-conditioned Markov processes (if method is &quot;GS&quot;)
</p>
</li>
<li><p> combmat: matrix stating combined use of modified rejection sampling / uniformization sampling algorithms (if method is &quot;GS&quot;)
</p>
</li>
<li><p> sampl_method: sampling method for deriving endpoint-conditioned Markov process path: &quot;Unif&quot; - Uniformization Sampling, &quot;ModRej&quot; - Modified Rejection Sampling (if method is &quot;GS&quot;)
</p>
</li>
<li><p> logmethod: method to compute matrix logarithm (if method is &quot;DA&quot;, &quot;WA&quot; or &quot;QO&quot;, see <code>?logm</code> from <code>expm</code> package for more information)
</p>
</li>
<li><p> expmethod: method to compute matrix exponential (if method is &quot;EM&quot; or &quot;GS&quot;, see <code>?expm</code> from <code>expm</code> package for more information)
</p>
</li>
<li><p> verbose: 
verbose mode (if method is &quot;EM&quot; or &quot;GS&quot;)
</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>

<p>The methods &quot;DA&quot;, &quot;WA&quot; and &quot;QO&quot; provide adjustments of a matrix logarithm based candidate solution, &quot;EM&quot; gives the maximum likelihood estimate and &quot;GS&quot; a posterior mean estimate in a Bayesian setting with conjugate Gamma priors.
</p>


<h3>Value</h3>

<p>generator matrix estimate
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>References</h3>

<p>G. dos Reis, M. Pfeuffer, G. Smith: Capturing Rating Momentum in the Estimation of Probabilities of Default, With Application to Credit Rating Migrations (In Preparation), 2018
</p>
<p>M. Pfeuffer: Generator Matrix Approximation Based on Discrete Time Rating Migration Data. Master Thesis, University of Munich, 2016
</p>
<p>Y. Inamura: Estimating Continuous Time Transition Matrices from Discretely Observed Data. Bank of Japan Working Paper Series, 2006
</p>
<p>R. B. Israel et al.: Finding Generators for Markov Chains via Empirical Transition Matrices, with Applications to Credit Ratings. Mathematical Finance 11(2):245-265, 2001
</p>
<p>E. Kreinin and M. Sidelnikova: Regularization Algorithms for Transition Matrices. Algo Research Quarterly 4(1):23-40, 2001
</p>
<p>M. Bladt and M. Soerensen: Statistical Inference for Discretely Observed Markov Jump Processes. Journal of the Royal Statistical Society B 67(3):395-410, 2005
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gmDA">gmDA</a></code>, <code><a href="#topic+gmWA">gmWA</a></code>, <code><a href="#topic+gmQO">gmQO</a></code>, <code><a href="#topic+gmEM">gmEM</a></code>, <code><a href="#topic+gmGS">gmGS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tm_abs)

## Maximum Likelihood Generator Matrix Estimate
gm0=matrix(1,8,8)
diag(gm0)=0
diag(gm0)=-rowSums(gm0)
gm0[8,]=0

gmem=gm(tm_abs,te=1,method="EM",gmguess=gm0)
gmem

## Quasi Optimization Estimate
tm_rel=rbind((tm_abs/rowSums(tm_abs))[1:7,],c(rep(0,7),1))

gmqo=gm(tm_rel,te=1,method="QO")
gmqo
</code></pre>

<hr>
<h2 id='gm.default'>
Generator Matrix Estimation
</h2><span id='topic+gm.default'></span>

<h3>Description</h3>

<p>Default function to estimate the parameters of a continuous Markov chain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
gm(tm, te, method, gmguess = NULL, prior = NULL, burnin = NULL, 
eps = 1e-06, conv_pvalue = 0.05, conv_freq = 10, niter = 10000, sampl_func = NULL, 
combmat = NULL, sampl_method = "Unif", logmethod = "Eigen", expmethod = "PadeRBS", 
verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gm.default_+3A_tm">tm</code></td>
<td>

<p>matrix of either absolute transition frequencies (if method is &quot;EM&quot; or &quot;GS&quot;) or relative transition frequencies (if method is &quot;DA&quot;, &quot;WA&quot; of &quot;QO&quot;)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_te">te</code></td>
<td>

<p>time elapsed in transition process
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_method">method</code></td>
<td>

<p>method to derive generator matrix: &quot;DA&quot; - Diagonal Adjustment, &quot;WA&quot; - Weighted Adjustment, &quot;QO&quot; - Quasi-Optimization, &quot;EM&quot; - Expectation-Maximization Algorithm, &quot;GS&quot; - Gibbs Sampler
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_gmguess">gmguess</code></td>
<td>

<p>initial guess for generator matrix estimation procedure (if method is &quot;EM&quot;)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_prior">prior</code></td>
<td>

<p>prior parametrization (if method is &quot;GS&quot;)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_burnin">burnin</code></td>
<td>

<p>burn-in period (if method is &quot;GS&quot;)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_eps">eps</code></td>
<td>

<p>convergence criterion (if method is &quot;EM&quot; or &quot;GS&quot;)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_conv_pvalue">conv_pvalue</code></td>
<td>

<p>convergence criterion: stop, if Heidelberger and Welch's diagnostic assumes convergence (see coda package)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_conv_freq">conv_freq</code></td>
<td>

<p>convergence criterion: absolute frequency of convergence evaluations
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_niter">niter</code></td>
<td>

<p>maximum number of iterations (if method is &quot;EM&quot; or &quot;GS&quot;)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_sampl_func">sampl_func</code></td>
<td>

<p>optional self-written path sampling function for endpoint-conditioned Markov processes (if method is &quot;GS&quot;)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_combmat">combmat</code></td>
<td>

<p>matrix stating combined use of modified rejection sampling / uniformization sampling algorithms (if method is &quot;GS&quot;)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_sampl_method">sampl_method</code></td>
<td>

<p>sampling method for deriving endpoint-conditioned Markov process path: &quot;Unif&quot; - Uniformization Sampling, &quot;ModRej&quot; - Modified Rejection Sampling (if method is &quot;GS&quot;)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_logmethod">logmethod</code></td>
<td>

<p>method to compute matrix logarithm (if method is &quot;DA&quot;, &quot;WA&quot; or &quot;QO&quot;, see <code>?logm</code> from <code>expm</code> package for more information)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_expmethod">expmethod</code></td>
<td>

<p>method to compute matrix exponential (if method is &quot;EM&quot; or &quot;GS&quot;, see <code>?expm</code> from <code>expm</code> package for more information)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_verbose">verbose</code></td>
<td>

<p>verbose mode (if method is &quot;EM&quot; or &quot;GS&quot;)
</p>
</td></tr>
<tr><td><code id="gm.default_+3A_...">...</code></td>
<td>

<p>additional arguments
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The methods &quot;DA&quot;, &quot;WA&quot; and &quot;QO&quot; provide adjustments of a matrix logarithm based candidate solution, &quot;EM&quot; gives the maximum likelihood estimate and &quot;GS&quot; a posterior mean estimate in a Bayesian setting with conjugate Gamma priors.
</p>


<h3>Value</h3>

<p>generator matrix estimate
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>References</h3>

<p>M. Pfeuffer: Generator Matrix Approximation Based on Discrete Time Rating Migration Data. Master Thesis, University of Munich, 2016
</p>
<p>Y. Inamura: Estimating Continuous Time Transition Matrices from Discretely Observed Data. Bank of Japan Working Paper Series, 2006
</p>
<p>R. B. Israel et al.: Finding Generators for Markov Chains via Empirical Transition Matrices, with Applications to Credit Ratings. Mathematical Finance 11(2):245-265, 2001
</p>
<p>E. Kreinin and M. Sidelnikova: Regularization Algorithms for Transition Matrices. Algo Research Quarterly 4(1):23-40, 2001
</p>
<p>M. Bladt and M. Soerensen: Statistical Inference for Discretely Observed Markov Jump Processes. Journal of the Royal Statistical Society B 67(3):395-410, 2005
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gmDA">gmDA</a></code>, <code><a href="#topic+gmWA">gmWA</a></code>, <code><a href="#topic+gmQO">gmQO</a></code>, <code><a href="#topic+gmEM">gmEM</a></code>, <code><a href="#topic+gmGS">gmGS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tm_abs)

## Maximum Likelihood Generator Matrix Estimate
gm0=matrix(1,8,8)
diag(gm0)=0
diag(gm0)=-rowSums(gm0)
gm0[8,]=0

gmem=gm(tm_abs,te=1,method="EM",gmguess=gm0)
gmem

## Quasi Optimization Estimate
tm_rel=rbind((tm_abs/rowSums(tm_abs))[1:7,],c(rep(0,7),1))

gmqo=gm(tm_rel,te=1,method="QO")
gmqo
</code></pre>

<hr>
<h2 id='gmci'>
Confidence / Credibility Intervals for Generator Matrix Objects
</h2><span id='topic+gmci'></span>

<h3>Description</h3>

<p>Generic function to derive confidence / credibility intervals for &quot;EM&quot; or &quot;GS&quot; based generator matrix objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmci(gm, alpha, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gmci_+3A_gm">gm</code></td>
<td>

<p>a &quot;EM&quot; or &quot;GS&quot; generator matrix object
</p>
</td></tr>
<tr><td><code id="gmci_+3A_alpha">alpha</code></td>
<td>

<p>significance level
</p>
</td></tr>
<tr><td><code id="gmci_+3A_...">...</code></td>
<td>
<p>additional arguments:
</p>

<ul>
<li><p> eps: threshold for which generator matrix parameters are assumed to be fixed at zero (if &quot;EM&quot; object)
</p>
</li>
<li><p> cimethod: &quot;Direct&quot; and &quot;SdR&quot; use analytical expressions of the Fisher information matrix, &quot;BS&quot; employs the numerical approach of Bladt and Soerensen, 2009 (if &quot;EM&quot; object)
</p>
</li>
<li><p> expmethod: method to compute matrix exponentials (see <code>?expm</code> from <code>expm</code> package for more information)
</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>

<p>If gm is based on the &quot;EM&quot; method (expectation-maximization algorithm), the function computes a Wald confidence interval based on the method of Oakes, 1999. IF gm is based on the &quot;GS&quot; method (Gibbs sampler), the function computes an equal-tailed credibility interval.
</p>


<h3>Value</h3>

<p>generator matrix confidence bounds
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>References</h3>

<p>M. Bladt and M. Soerensen. Efficient Estimation of Transition Rates Between Credit Ratings from Observations at Discrete Time Points. Quantitative Finance, 9(2):147-160, 2009
</p>
<p>D. Oakes. Direct calculation of the information matrix via the EM algorithm. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 61(2):479-482, 1999
</p>
<p>G. Smith and G. dos Reis. Robust and Consistent Estimation of Generators in Credit Risk. Quantitative Finance 18(6):983-1001, 2018
</p>
<p>G. dos Reis, M. Pfeuffer, G. Smith: Capturing Rating Momentum in the Estimation of Probabilities of Default, With Application to Credit Rating Migrations (In Preparation), 2018
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(tm_abs)

## Maximum Likelihood Generator Matrix Estimate
gm0=matrix(1,8,8)
diag(gm0)=0
diag(gm0)=-rowSums(gm0)
gm0[8,]=0

gmem=gm(tm_abs,te=1,method="EM",gmguess=gm0)

## Oakes Confidence Interval
ciem=gmci(gmem,alpha=0.05)
ciem

</code></pre>

<hr>
<h2 id='gmci.default'>
Confidence / Credibility Intervals for Generator Matrix Objects
</h2><span id='topic+gmci.default'></span><span id='topic+ciEMBS'></span><span id='topic+ciEMSdR'></span><span id='topic+ciEMoFI'></span><span id='topic+ciEMDM'></span><span id='topic+ciGS'></span>

<h3>Description</h3>

<p>Default function to derive confidence / credibility intervals for &quot;EM&quot; or &quot;GS&quot; based generator matrix objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
gmci(gm, alpha, eps = 1e-04, cimethod="Direct", expmethod = "PadeRBS", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gmci.default_+3A_gm">gm</code></td>
<td>

<p>a &quot;EM&quot; or &quot;GS&quot; generator matrix object
</p>
</td></tr>
<tr><td><code id="gmci.default_+3A_alpha">alpha</code></td>
<td>

<p>significance level
</p>
</td></tr>
<tr><td><code id="gmci.default_+3A_eps">eps</code></td>
<td>

<p>threshold for which generator matrix parameters are assumed to be fixed at zero (if &quot;EM&quot; object)
</p>
</td></tr>
<tr><td><code id="gmci.default_+3A_cimethod">cimethod</code></td>
<td>

<p>&quot;Direct&quot; or &quot;SdR&quot; use analytical expressions of the Fisher information matrix, &quot;BS&quot; emloy the numerical expressions of Bladt and Soerensen, 2009 (if &quot;EM&quot; object)
</p>
</td></tr>
<tr><td><code id="gmci.default_+3A_expmethod">expmethod</code></td>
<td>

<p>method to compute matrix exponentials (see <code>?expm</code> from <code>expm</code> package for more information)
</p>
</td></tr>
<tr><td><code id="gmci.default_+3A_...">...</code></td>
<td>

<p>additional arguments
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If gm is based on the &quot;EM&quot; method (expectation-maximization algorithm), the function computes a Wald confidence interval based on the method of Oakes, 1999. IF gm is based on the &quot;GS&quot; method (Gibbs sampler), the function computes an equal-tailed credibility interval.
</p>


<h3>Value</h3>

<p>generator matrix confidence bounds
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>References</h3>

<p>G. dos Reis, M. Pfeuffer, G. Smith: Capturing Rating Momentum in the Estimation of Probabilities of Default, With Application to Credit Rating Migrations (In Preparation), 2018
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(tm_abs)

## Maximum Likelihood Generator Matrix Estimate
gm0=matrix(1,8,8)
diag(gm0)=0
diag(gm0)=-rowSums(gm0)
gm0[8,]=0

gmem=gm(tm_abs,te=1,method="EM",gmguess=gm0)

## Oakes Confidence Interval
ciem=gmci(gmem,alpha=0.05)
ciem

</code></pre>

<hr>
<h2 id='gmDA'>
Diagonal Adjustment
</h2><span id='topic+gmDA'></span>

<h3>Description</h3>

<p>Function for deriving a Markov generator matrix estimate based on the diagonal adjustment method of Israel et al., 2001
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmDA(tmrel, te, logmethod = "Eigen")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gmDA_+3A_tmrel">tmrel</code></td>
<td>

<p>matrix of relative transition frequencies
</p>
</td></tr>
<tr><td><code id="gmDA_+3A_te">te</code></td>
<td>

<p>time elapsed in transition process
</p>
</td></tr>
<tr><td><code id="gmDA_+3A_logmethod">logmethod</code></td>
<td>

<p>method for computation of matrix logarithm, by default eigendecomposition is chosen (see <code>?logm</code> from <code>expm</code> package for more information)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A candidate solution is derived by the matrix logarithm and then adjusted in order to fulfil the properties of a Markov generator matrix.
</p>


<h3>Value</h3>

<p>generator matrix estimate
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>References</h3>

<p>R. B. Israel et al.: Finding Generators for Markov Chains via Empirical Transition Matrices, with Applications to Credit Ratings. Mathematical Finance 11(2):245-265, 2001
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Derive matrix of relative transition frequencies
data(tm_abs)
tm_rel=rbind((tm_abs/rowSums(tm_abs))[1:7,],c(rep(0,7),1))

## Derive diagonal adjustment generator matrix estimate
gmda=gmDA(tm_rel,1)
gmda
</code></pre>

<hr>
<h2 id='gmEM'>
Expectation-Maximization Algorithm
</h2><span id='topic+gmEM'></span>

<h3>Description</h3>

<p>Function for deriving a Markov generator matrix estimate by an instance of the expectation-maximization algorithm (described by Bladt and Soerensen, 2005)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmEM(tmabs, te, gmguess, eps = 1e-06, niter = 10000, expmethod = "PadeRBS", 
verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gmEM_+3A_tmabs">tmabs</code></td>
<td>

<p>matrix of absolute transition frequencies
</p>
</td></tr>
<tr><td><code id="gmEM_+3A_te">te</code></td>
<td>

<p>time elapsed in transition process
</p>
</td></tr>
<tr><td><code id="gmEM_+3A_gmguess">gmguess</code></td>
<td>

<p>initial guess (for generator matrix)
</p>
</td></tr>
<tr><td><code id="gmEM_+3A_eps">eps</code></td>
<td>

<p>stop criterion: stop, if relative change in log-likelihood is smaller than eps
</p>
</td></tr>
<tr><td><code id="gmEM_+3A_niter">niter</code></td>
<td>

<p>stop criterion: maximum number of iterations
</p>
</td></tr>
<tr><td><code id="gmEM_+3A_expmethod">expmethod</code></td>
<td>

<p>method for computation of matrix exponential, by default &quot;PadeRBS&quot; is chosen (see <code>?expm</code> from <code>expm</code> package for more information)
</p>
</td></tr>
<tr><td><code id="gmEM_+3A_verbose">verbose</code></td>
<td>

<p>verbose mode
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A maximum likelihood generator matrix estimate is derived by an instance of the expectation-maximization algorithm. 
</p>


<h3>Value</h3>

<p>generator matrix estimate
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>References</h3>

<p>M. Bladt and M. Soerensen: Statistical Inference for Discretely Observed Markov Jump Processes. Journal of the Royal Statistical Society B 67(3):395-410, 2005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tm_abs)

## Initial guess for generator matrix (absorbing default state)
gm0=matrix(1,8,8)
diag(gm0)=0
diag(gm0)=-rowSums(gm0)
gm0[8,]=0

## Derive expectation-maximization algorithm generator matrix estimate
gmem=gmEM(tmabs=tm_abs,1,gmguess=gm0,verbose=TRUE)
gmem
</code></pre>

<hr>
<h2 id='gmGS'>
Gibbs Sampler
</h2><span id='topic+gmGS'></span>

<h3>Description</h3>

<p>Function for deriving a Markov generator matrix estimate by Gibbs sampling (described by Bladt and Soerensen, 2005)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmGS(tmabs, te, prior, burnin, conv_pvalue = 0, conv_freq = 10,
niter = 10000, sampl_method = "Unif", expmethod = "PadeRBS", verbose = FALSE, 
combmat=NULL, sampl_func = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gmGS_+3A_tmabs">tmabs</code></td>
<td>

<p>matrix of absolute transition frequencies
</p>
</td></tr>
<tr><td><code id="gmGS_+3A_te">te</code></td>
<td>

<p>time elapsed in transition process
</p>
</td></tr>
<tr><td><code id="gmGS_+3A_prior">prior</code></td>
<td>

<p>list of prior parameters (Gamma prior)
</p>
</td></tr>
<tr><td><code id="gmGS_+3A_burnin">burnin</code></td>
<td>

<p>number of burn-in iterations
</p>
</td></tr>
<tr><td><code id="gmGS_+3A_conv_pvalue">conv_pvalue</code></td>
<td>

<p>convergence criterion: stop, if Heidelberger and Welch's diagnostic assumes convergence (see coda package), convergence check is only employed if conv_pvalue&gt;0
</p>
</td></tr>
<tr><td><code id="gmGS_+3A_conv_freq">conv_freq</code></td>
<td>

<p>convergence criterion: absolute frequency of convergence evaluations
</p>
</td></tr>
<tr><td><code id="gmGS_+3A_niter">niter</code></td>
<td>

<p>stop criterion: stop, if maximum number of iterations is exceeded
</p>
</td></tr>
<tr><td><code id="gmGS_+3A_sampl_method">sampl_method</code></td>
<td>

<p>method for sampling paths from endpoint-conditioned Markov processes. options: &quot;Unif&quot; - Uniformization sampling, &quot;ModRej&quot; - Modified Rejection Sampling
</p>
</td></tr>
<tr><td><code id="gmGS_+3A_expmethod">expmethod</code></td>
<td>

<p>method for computation of matrix exponential, by default &quot;PadeRBS&quot; is chosen (see <code>?expm</code> from <code>expm</code> package for more information)
</p>
</td></tr>
<tr><td><code id="gmGS_+3A_verbose">verbose</code></td>
<td>

<p>verbose mode
</p>
</td></tr>
<tr><td><code id="gmGS_+3A_combmat">combmat</code></td>
<td>

<p>matrix specifying the combined use of sampling methods: &quot;U&quot; - uniformization sampling, &quot;M&quot; - modified rejection sampling
</p>
</td></tr>
<tr><td><code id="gmGS_+3A_sampl_func">sampl_func</code></td>
<td>

<p>interface for own endpoint-conditioned Markov process sampling function
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A posterior mean generator matrix estimate is derived by Gibbs Sampling. The gamma distribution is used as prior.
</p>


<h3>Value</h3>

<p>generator matrix estimate
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>References</h3>

<p>M. Bladt and M. Soerensen: Statistical Inference for Discretely Observed Markov Jump Processes. Journal of the Royal Statistical Society B 67(3):395-410, 2005
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rNijTRiT_ModRej">rNijTRiT_ModRej</a></code>, <code><a href="#topic+rNijTRiT_Unif">rNijTRiT_Unif</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tm_abs)

## Example prior parametrization (absorbing default state)
pr=list()
pr[[1]]=matrix(1,8,8)
pr[[1]][8,]=0

pr[[2]]=c(rep(5,7),Inf)

## Derive Gibbs sampling generator matrix estimate

gmgs=gmGS(tmabs=tm_abs,te=1,sampl_method="Unif",prior=pr,burnin=10,niter=100,verbose=TRUE)
gmgs


</code></pre>

<hr>
<h2 id='gmQO'>
Quasi-Optimization
</h2><span id='topic+gmQO'></span>

<h3>Description</h3>

<p>Function for deriving a Markov generator matrix estimate based on the quasi-optimization procedure of Kreinin and Sidelnikova, 2001
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmQO(tmrel, te, logmethod = "Eigen")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gmQO_+3A_tmrel">tmrel</code></td>
<td>

<p>matrix of relative transition frequencies
</p>
</td></tr>
<tr><td><code id="gmQO_+3A_te">te</code></td>
<td>

<p>time elapsed in transition process
</p>
</td></tr>
<tr><td><code id="gmQO_+3A_logmethod">logmethod</code></td>
<td>

<p>method for computation of matrix logarithm, by default eigendecomposition is chosen (see <code>?logm</code> from <code>expm</code> package for more information)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From the set of possible Markov generator matrices, the one is chosen which is closest to a matrix logarithm based candidate solution in terms of sum of squared deviations.
</p>


<h3>Value</h3>

<p>generator matrix estimate
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>References</h3>

<p>E. Kreinin and M. Sidelnikova: Regularization Algorithms for Transition Matrices. Algo Research Quarterly 4(1):23-40, 2001
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tm_abs)
## Derive matrix of relative transition frequencies
data(tm_abs)
tm_rel=rbind((tm_abs/rowSums(tm_abs))[1:7,],c(rep(0,7),1))

## Derive quasi optimization generator matrix estimate
gmqo=gmQO(tm_rel,1)
gmqo
</code></pre>

<hr>
<h2 id='gmWA'>
Weighted Adjustment
</h2><span id='topic+gmWA'></span>

<h3>Description</h3>

<p>Function for deriving a Markov generator matrix estimate based on the weighted adjustment method of Israel et al., 2001
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmWA(tmrel, te, logmethod = "Eigen")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gmWA_+3A_tmrel">tmrel</code></td>
<td>

<p>matrix of relative transition frequencies
</p>
</td></tr>
<tr><td><code id="gmWA_+3A_te">te</code></td>
<td>

<p>time elapsed in transition process
</p>
</td></tr>
<tr><td><code id="gmWA_+3A_logmethod">logmethod</code></td>
<td>

<p>method for computation of matrix logarithm, by default eigendecomposition is chosen (see <code>?logm</code> from <code>expm</code> package for more information)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A candidate solution is derived by the matrix logarithm and then adjusted in order to fulfil the properties of a Markov generator matrix.
</p>


<h3>Value</h3>

<p>generator matrix estimate
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>References</h3>

<p>R. B. Israel et al.: Finding Generators for Markov Chains via Empirical Transition Matrices, with Applications to Credit Ratings. Mathematical Finance 11(2):245-265, 2001
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Derive matrix of relative transition frequencies
data(tm_abs)
tm_rel=rbind((tm_abs/rowSums(tm_abs))[1:7,],c(rep(0,7),1))

## Derive weighted adjustment generator matrix estimate
gmwa=gmWA(tm_rel,1)
gmwa
</code></pre>

<hr>
<h2 id='plot.gm'>
Plot Function for Generator Matrix Estimation Objects
</h2><span id='topic+plot.gm'></span>

<h3>Description</h3>

<p>Function for visualizing the output of a generator matrix estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gm'
plot(x, mattext, col = c("grey", "red"), main = x$method, las = 1, 
xlab = "To", ylab = "From", xnames, ynames, cex = 1, fig = 3, opacity_factor, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gm_+3A_x">x</code></td>
<td>

<p>a generator matrix estimation object
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_mattext">mattext</code></td>
<td>

<p>optional: matrix of strings replacing the parameter estimates
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_col">col</code></td>
<td>

<p>two element vector of basis colors for positive and negative parameter estimate entries
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_main">main</code></td>
<td>

<p>optional: plot title
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_las">las</code></td>
<td>

<p>orientation of x and y axis elements
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_xlab">xlab</code></td>
<td>

<p>x axis name
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_ylab">ylab</code></td>
<td>

<p>y axis name
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_xnames">xnames</code></td>
<td>

<p>description of x axis elements
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_ynames">ynames</code></td>
<td>

<p>description of y axis elements
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_cex">cex</code></td>
<td>

<p>font size
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_fig">fig</code></td>
<td>

<p>number of significant figure to be plotted
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_opacity_factor">opacity_factor</code></td>
<td>

<p>two element vector for specification of opacity for positive and negative parameter entry highlighting (must be greater than zero)
</p>
</td></tr>
<tr><td><code id="plot.gm_+3A_...">...</code></td>
<td>

<p>additional arguments
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no value, plot function
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.gm">print.gm</a></code>, <code><a href="#topic+summary.gm">summary.gm</a></code>, <code><a href="#topic+plotM">plotM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tm_abs)

## Maximum Likelihood Generator Matrix Estimate
gm0=matrix(1,8,8)
diag(gm0)=0
diag(gm0)=-rowSums(gm0)
gm0[8,]=0

gmem=gm(tm_abs,te=1,method="EM",gmguess=gm0)
plot(gmem)
</code></pre>

<hr>
<h2 id='plot.gmci'>
Plot Function for Generator Matrix Confidence / Credibility Interval Objects
</h2><span id='topic+plot.gmci'></span>

<h3>Description</h3>

<p>Function for visualizing the boundaries of generator matrix confidence / credibility intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gmci'
plot(x, mattext, col = c("grey", "red"), main, las = 1, xlab = "To",
ylab = "From", xnames, ynames, cex = 1, fig = 2, opacity_factor, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gmci_+3A_x">x</code></td>
<td>

<p>a generator matrix confidence / credibility interval object
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_mattext">mattext</code></td>
<td>

<p>optional: matrix of strings replacing the parameter estimates
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_col">col</code></td>
<td>

<p>two element vector of basis colors for positive and negative parameter estimate entries
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_main">main</code></td>
<td>

<p>optional: plot title
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_las">las</code></td>
<td>

<p>orientation of x and y axis elements
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_xlab">xlab</code></td>
<td>

<p>x axis name
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_ylab">ylab</code></td>
<td>

<p>y axis name
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_xnames">xnames</code></td>
<td>

<p>description of x axis elements
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_ynames">ynames</code></td>
<td>

<p>description of y axis elements
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_cex">cex</code></td>
<td>

<p>font size
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_fig">fig</code></td>
<td>

<p>number of significant figures to be plotted
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_opacity_factor">opacity_factor</code></td>
<td>

<p>two element vector for specification of opacity for positive and negative parameter entry highlighting (must be greater than zero)
</p>
</td></tr>
<tr><td><code id="plot.gmci_+3A_...">...</code></td>
<td>

<p>additional arguments
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no value, plot function
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.gmci">print.gmci</a></code>, <code><a href="#topic+plotM">plotM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(tm_abs)

## Maximum Likelihood Generator Matrix Estimate
gm0=matrix(1,8,8)
diag(gm0)=0
diag(gm0)=-rowSums(gm0)
gm0[8,]=0

gmem=gm(tm_abs,te=1,method="EM",gmguess=gm0)
plot(gmem)

## Confidence Interval
ciem=gmci(gmem,alpha=0.05)
plot(ciem)

</code></pre>

<hr>
<h2 id='plotM'>
Matrix Plot Function
</h2><span id='topic+plotM'></span>

<h3>Description</h3>

<p>Function to visualize matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotM(mat, mattext, col = c("grey", "red"), main, las = 1, xlab = "To", 
ylab = "From", xnames, ynames, cex = min(1, nrow(mat)/8), fig = 3, opacity_factor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotM_+3A_mat">mat</code></td>
<td>

<p>a matrix
</p>
</td></tr>
<tr><td><code id="plotM_+3A_mattext">mattext</code></td>
<td>

<p>optional: matrix of strings replacing the original matrix entries
</p>
</td></tr>
<tr><td><code id="plotM_+3A_col">col</code></td>
<td>

<p>two element vector of basis colors for positive and negative matrix entries
</p>
</td></tr>
<tr><td><code id="plotM_+3A_main">main</code></td>
<td>

<p>optional: plot title
</p>
</td></tr>
<tr><td><code id="plotM_+3A_las">las</code></td>
<td>

<p>orientation of x and y axis elements
</p>
</td></tr>
<tr><td><code id="plotM_+3A_xlab">xlab</code></td>
<td>

<p>x axis name
</p>
</td></tr>
<tr><td><code id="plotM_+3A_ylab">ylab</code></td>
<td>

<p>y axis name
</p>
</td></tr>
<tr><td><code id="plotM_+3A_xnames">xnames</code></td>
<td>

<p>description of x axis elements
</p>
</td></tr>
<tr><td><code id="plotM_+3A_ynames">ynames</code></td>
<td>

<p>description of y axis elements
</p>
</td></tr>
<tr><td><code id="plotM_+3A_cex">cex</code></td>
<td>

<p>font size
</p>
</td></tr>
<tr><td><code id="plotM_+3A_fig">fig</code></td>
<td>

<p>number of significant figures to be plotted
</p>
</td></tr>
<tr><td><code id="plotM_+3A_opacity_factor">opacity_factor</code></td>
<td>

<p>two element vector for specification of opacity for positive and negative parameter entry highlighting (must be greater than zero)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no value, plot function
</p>


<h3>Author(s)</h3>

<p>Marius Pfeuffer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.gm">plot.gm</a></code>, <code><a href="#topic+plot.gmci">plot.gmci</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gm0=matrix(1,8,8)
diag(gm0)=0
diag(gm0)=-rowSums(gm0)
gm0[8,]=0

plotM(gm0)
</code></pre>

<hr>
<h2 id='print.gm'>
Print Method for Generator Matrix Estimation Objects
</h2><span id='topic+print.gm'></span>

<h3>Description</h3>

<p>Function for printing the results of a generator matrix estimation</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.gm_+3A_x">x</code></td>
<td>

<p>a generator matrix estimation object
</p>
</td></tr>
<tr><td><code id="print.gm_+3A_...">...</code></td>
<td>

<p>additional arguments
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>generator matrix
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.gm">summary.gm</a></code>, <code><a href="#topic+plot.gm">plot.gm</a></code>
</p>

<hr>
<h2 id='print.gmci'>
Print Method for Generator Matrix Confidence / Credibility Interval Objects
</h2><span id='topic+print.gmci'></span>

<h3>Description</h3>

<p>Function for printing the boundaries of a generator matrix confidence / credibility interval</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gmci'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.gmci_+3A_x">x</code></td>
<td>

<p>a generator matrix confidence / credibility interval
</p>
</td></tr>
<tr><td><code id="print.gmci_+3A_...">...</code></td>
<td>

<p>additional arguments
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>generator matrix confidence bounds
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.gmci">plot.gmci</a></code>
</p>

<hr>
<h2 id='rNijTRiT_ModRej'>
C++ Based Modified Rejection Sampling
</h2><span id='topic+rNijTRiT_ModRej'></span>

<h3>Description</h3>

<p>Function for generating initial and endpoint-conditioned Markov process sampling paths for a given discrete-time transition matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rNijTRiT_ModRej(tmabs, te, gm) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rNijTRiT_ModRej_+3A_tmabs">tmabs</code></td>
<td>

<p>matrix of absolute transition frequencies
</p>
</td></tr>
<tr><td><code id="rNijTRiT_ModRej_+3A_te">te</code></td>
<td>

<p>time elapsed in transition process
</p>
</td></tr>
<tr><td><code id="rNijTRiT_ModRej_+3A_gm">gm</code></td>
<td>

<p>generator matrix
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function for the simulation of paths from an endpoint-conditioned Markov process. Returns number of transitions NijT and cumulative holding times RiT.
</p>


<h3>Value</h3>

<p>endpoint-conditioned sampling path
</p>


<h3>Author(s)</h3>

<p>Jon Fintzi, Marius Pfeuffer
</p>


<h3>References</h3>

<p>J. Fintzi: R Package ECctmc, 2016.
</p>
<p>A. Hobolth and E. A. Stone: Simulation from Endpoint-Conditioned, Continuous-Time Markov Chains on a Finite State Space, with Applications to Molecular Evolution. Annals of Applied Statistics 3(3):1204-1231, 2009
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tm_abs)

## Initial guess for generator matrix (absorbing default state)

gm=matrix(1,8,8)
diag(gm)=0
diag(gm)=-rowSums(gm)
gm[8,]=0

rNijTRiT_ModRej(tm_abs,1,gm)
</code></pre>

<hr>
<h2 id='rNijTRiT_Unif'>
C++ Based Uniformization Sampling
</h2><span id='topic+rNijTRiT_Unif'></span>

<h3>Description</h3>

<p>Function for generating initial and endpoint-conditioned Markov process sampling paths for a given discrete-time transition matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rNijTRiT_Unif(tmabs, te, gm, tpm) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rNijTRiT_Unif_+3A_tmabs">tmabs</code></td>
<td>

<p>matrix of absolute transition frequencies
</p>
</td></tr>
<tr><td><code id="rNijTRiT_Unif_+3A_te">te</code></td>
<td>

<p>time elapsed in transition process
</p>
</td></tr>
<tr><td><code id="rNijTRiT_Unif_+3A_gm">gm</code></td>
<td>

<p>generator matrix
</p>
</td></tr>
<tr><td><code id="rNijTRiT_Unif_+3A_tpm">tpm</code></td>
<td>

<p>discrete-time transition probability matrix, matrix exponential of gm
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Function for the simulation of paths from an endpoint-conditioned Markov process. Returns number of transitions NijT and cumulative holding times RiT.
</p>


<h3>Value</h3>

<p>endpoint-conditioned sampling path
</p>


<h3>Author(s)</h3>

<p>Jon Fintzi, Marius Pfeuffer
</p>


<h3>References</h3>

<p>J. Fintzi: R Package ECctmc, 2016.
</p>
<p>A. Hobolth and E. A. Stone: Simulation from Endpoint-Conditioned, Continuous-Time Markov Chains on a Finite State Space, with Applications to Molecular Evolution. Annals of Applied Statistics 3(3):1204-1231, 2009
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tm_abs)

## Generator Matrix
gm=matrix(1,8,8)
diag(gm)=0
diag(gm)=-rowSums(gm)
gm[8,]=0

## Transition Probability Matrix
library(expm)
te=1
tpm=expm(gm*te)

rNijTRiT_Unif(tm_abs,te,gm,tpm)
</code></pre>

<hr>
<h2 id='summary.gm'>
Extended Output for Generator Matrix Estimate Objects
</h2><span id='topic+summary.gm'></span>

<h3>Description</h3>

<p>Function for providing results and extended output of a generator matrix estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.gm_+3A_object">object</code></td>
<td>

<p>a generator matrix estimation object
</p>
</td></tr>
<tr><td><code id="summary.gm_+3A_...">...</code></td>
<td>

<p>additional arguments
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>estimation summary
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.gm">print.gm</a></code>, <code><a href="#topic+plot.gm">plot.gm</a></code>
</p>

<hr>
<h2 id='tm_abs'>
Single Year Corporate Credit Rating Transititions
</h2><span id='topic+tm_abs'></span>

<h3>Description</h3>

<p>Matrix of Standard and Poor's Global Corporate Rating Transition Frequencies 2000 (NR Removed)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("tm_abs")</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:8, 1:8] 17 2 0 0 0 0 0 0 1 455 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:8] &quot;AAA&quot; &quot;AA&quot; &quot;A&quot; &quot;BBB&quot; ...
..$ : chr [1:8] &quot;AAA&quot; &quot;AA&quot; &quot;A&quot; &quot;BBB&quot; ...
</p>


<h3>References</h3>

<p>European Securities and Markets Authority, 2016 
</p>
<p>https://cerep.esma.europa.eu/cerep-web/statistics/transitionMatrice.xhtml
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tm_abs)

## Matrix of relative transition frequencies
tm_rel=rbind((tm_abs/rowSums(tm_abs))[1:7,],c(rep(0,7),1))
tm_rel

</code></pre>

<hr>
<h2 id='tmci'>
Delta Method Confidence Intervals for Matrix Exponential Transformations of Generator Matrix Objects
</h2><span id='topic+tmci'></span>

<h3>Description</h3>

<p>Generic function to derive delta method based confidence intervals for matrix exponential transformations of &quot;EM&quot; based generator matrix objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tmci(gmem, alpha, te, eps = 1e-04, expmethod = "PadeRBS")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tmci_+3A_gmem">gmem</code></td>
<td>

<p>an &quot;EM&quot; generator matrix object
</p>
</td></tr>
<tr><td><code id="tmci_+3A_alpha">alpha</code></td>
<td>

<p>significance level
</p>
</td></tr>
<tr><td><code id="tmci_+3A_te">te</code></td>
<td>

<p>discrete time horizon for which the interval is supposed to be computed
</p>
</td></tr>
<tr><td><code id="tmci_+3A_eps">eps</code></td>
<td>

<p>threshold for which generator matrix parameters are assumed to be fixed at zero
</p>
</td></tr>
<tr><td><code id="tmci_+3A_expmethod">expmethod</code></td>
<td>

<p>method to compute matrix exponentials (see <code>?expm</code> from <code>expm</code> package for more information)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence intervals for discrete-time transition matrix predictions given generator matrix estimates are computed by using the delta method for matrix exponential transformations. 
</p>


<h3>Value</h3>

<p>transition matrix confidence bounds
</p>


<h3>References</h3>

<p>G. dos Reis, M. Pfeuffer, G. Smith: Capturing Rating Momentum in the Estimation of Probabilities of Default, With Application to Credit Rating Migrations (In Preparation), 2018
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(tm_abs)

## Maximum Likelihood Generator Matrix Estimate
gm0=matrix(1,8,8)
diag(gm0)=0
diag(gm0)=-rowSums(gm0)
gm0[8,]=0

gmem=gm(tm_abs,te=1,method="EM",gmguess=gm0)

## 2.5 Year Transition Matrix Confidence Interval
citm=tmci(gmem,alpha=0.05,te=2.5)
citm

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
