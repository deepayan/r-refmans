<!DOCTYPE html><html><head><title>Help for package merlin</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {merlin}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef.merlin'><p>Extract Model Coefficients</p></a></li>
<li><a href='#coef.mlrcs'><p>Extract Model Coefficients</p></a></li>
<li><a href='#coef.mlsurv'><p>Extract Model Coefficients</p></a></li>
<li><a href='#heart.valve'><p>Aortic valve replacement surgery data</p></a></li>
<li><a href='#logLik.merlin'><p>Extract Log-Likelihood</p></a></li>
<li><a href='#logLik.mlrcs'><p>Extract Log-Likelihood</p></a></li>
<li><a href='#logLik.mlsurv'><p>Extract Log-Likelihood</p></a></li>
<li><a href='#merlin'><p>merlin - Mixed Effects Regression for Linear, Nonlinear and User-defined models</p></a></li>
<li><a href='#merlin_util_ap'><p>merlin_util_ap - returns the current estimate of the ith ancillary parameter for the associated model</p></a></li>
<li><a href='#merlin_util_ap_mod'><p>merlin_util_ap_mod - returns the current estimate of the ith ancillary parameter for the specified model</p></a></li>
<li><a href='#merlin_util_depvar'><p>merlin_util_depvar - returns the response variable(s)</p></a></li>
<li><a href='#merlin_util_ev'><p>merlin_util_ev - returns the observation-level expected value of the outcome</p></a></li>
<li><a href='#merlin_util_ev_deriv'><p>merlin_util_ev_deriv - returns the first derivative with respect to time of the</p>
observation-level expected value of the outcome</a></li>
<li><a href='#merlin_util_ev_deriv_mod'><p>merlin_util_ev_deriv - returns the first derivative with respect to time of the</p>
observation-level expected value of the specified outcome</a></li>
<li><a href='#merlin_util_ev_deriv2'><p>merlin_util_ev_deriv2 - returns the second derivative with respect to time of the</p>
observation-level expected value of the outcome</a></li>
<li><a href='#merlin_util_ev_deriv2_mod'><p>merlin_util_ev_deriv2_mod - returns the second derivative with respect to time of the</p>
observation-level expected value of the specified outcome</a></li>
<li><a href='#merlin_util_ev_integ'><p>merlin_util_ev_integ - returns the integral with respect to time of the</p>
observation-level expected value of the outcome</a></li>
<li><a href='#merlin_util_ev_integ_mod'><p>merlin_util_ev_integ_mod - returns the integral with respect to time of the</p>
observation-level expected value of the specified outcome</a></li>
<li><a href='#merlin_util_ev_mod'><p>merlin_util_ev_mod - returns the observation-level expected value of the outcome for a specified model</p></a></li>
<li><a href='#merlin_util_timevar'><p>merlin_util_timevar - returns the time variable</p></a></li>
<li><a href='#merlin_util_xzb'><p>merlin_util_xzb - returns the observation-level complex predictor</p></a></li>
<li><a href='#merlin_util_xzb_deriv'><p>merlin_util_xzb_deriv - returns the first derivative with respect to time of the</p>
observation-level complex predictor</a></li>
<li><a href='#merlin_util_xzb_deriv_mod'><p>merlin_util_xzb_deriv_mod - returns the first derivative with respect to time of the</p>
observation-level complex predictor of a specified model</a></li>
<li><a href='#merlin_util_xzb_deriv2'><p>merlin_util_xzb_deriv2 - returns the second derivative with respect to time of the</p>
observation-level complex predictor</a></li>
<li><a href='#merlin_util_xzb_deriv2_mod'><p>merlin_util_xzb_deriv2_mod - returns the second derivative with respect to time of the</p>
observation-level complex predictor of the specified model</a></li>
<li><a href='#merlin_util_xzb_integ'><p>merlin_util_xzb_integ - returns the integral with respect to time of the</p>
observation-level complex predictor</a></li>
<li><a href='#merlin_util_xzb_integ_mod'><p>merlin_util_xzb_integ_mod - returns the integral with respect to time of the</p>
observation-level complex predictor of the specified model</a></li>
<li><a href='#merlin_util_xzb_mod'><p>merlin_util_xzb_mod - returns the observation-level complex predictor of the specified model</p></a></li>
<li><a href='#mlrcs'><p>Fit multi-level restricted cubic spline model</p></a></li>
<li><a href='#mlsurv'><p>Fit proportional hazards survival models</p></a></li>
<li><a href='#pbc'><p>Mayo Clinic primary biliary cirrhosis data</p></a></li>
<li><a href='#predict.merlin'><p>predict.merlin - post-estimation tools for merlin</p></a></li>
<li><a href='#print.merlin'><p>Print <code>merlin</code> Fits</p></a></li>
<li><a href='#print.mlrcs'><p>Print <code>mlrcs</code> Fits</p></a></li>
<li><a href='#print.mlsurv'><p>Print <code>mlsurv</code> Fits</p></a></li>
<li><a href='#sim3'><p>Simulated 3-level survival data</p></a></li>
<li><a href='#summary.merlin'><p>Summarizing <code>merlin</code> Fits</p></a></li>
<li><a href='#summary.mlrcs'><p>Summarizing <code>mlrcs</code> Fits</p></a></li>
<li><a href='#summary.mlsurv'><p>Summarizing <code>mlsurv</code> Fits</p></a></li>
<li><a href='#vcov.merlin'><p>Calculate Variance-Covariance Matrix for a <code>merlin</code> Model Object</p></a></li>
<li><a href='#vcov.mlrcs'><p>Calculate Variance-Covariance Matrix for a <code>mlrcs</code> Model Object</p></a></li>
<li><a href='#vcov.mlsurv'><p>Calculate Variance-Covariance Matrix for a <code>mlsurv</code> Model Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Mixed Effects Regression for Linear, Non-Linear and User-Defined
Models</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits linear, non-linear, and user-defined mixed effects regression models following 
  the framework developed by Crowther (2017) &lt;<a href="https://doi.org/10.48550/arXiv.1710.02223">doi:10.48550/arXiv.1710.02223</a>&gt;. 'merlin' can fit multivariate 
  outcome models of any type, each of which could be repeatedly measured (longitudinal), with 
  any number of levels, and with any number of random effects at each level. Standard 
  distributions/models available include the Bernoulli, Gaussian, Poisson, beta, 
  negative-binomial, and time-to-event/survival models include the exponential, 
  Gompertz, Royston-Parmar, Weibull and general hazard model. 'merlin' provides a 
  flexible predictor syntax, allowing the user to define variables, random effects, 
  spline and fractional polynomial functions, functions of 
  other outcome models, and any interaction between each of them. Non-linear and 
  time-dependent effects are seamlessly incorporated into the predictor. 'merlin' 
  allows multivariate normal random effects, which are integrated out using Gaussian 
  quadrature or Monte-Carlo integration. Note, 'merlin' is based on the 'Stata' package 
  of the same name, described in Crowther (2018) &lt;<a href="https://doi.org/10.48550/arXiv.1806.01615">doi:10.48550/arXiv.1806.01615</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, randtoolbox, statmod, stats, survival, tools</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, nlme, rmarkdown, testthat</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.mjcrowther.co.uk/software/merlin">https://www.mjcrowther.co.uk/software/merlin</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Language:</td>
<td>en_GB</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-29 15:06:24 UTC; ellessenne</td>
</tr>
<tr>
<td>Author:</td>
<td>Emma Martin [aut],
  Alessandro Gasparini [aut],
  Michael Crowther [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Crowther &lt;michael.crowther@le.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-29 17:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef.merlin'>Extract Model Coefficients</h2><span id='topic+coef.merlin'></span><span id='topic+coef.summary.merlin'></span>

<h3>Description</h3>

<p><code>coef</code> extracts model coefficients from a <code>merlin</code> model fit. <code>coefficients</code> is an alias for it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merlin'
coef(object, ...)

## S3 method for class 'summary.merlin'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.merlin_+3A_object">object</code></td>
<td>
<p>An object of class <code>merlin</code> or <code>summary.merlin</code>.</p>
</td></tr>
<tr><td><code id="coef.merlin_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

<hr>
<h2 id='coef.mlrcs'>Extract Model Coefficients</h2><span id='topic+coef.mlrcs'></span><span id='topic+coef.summary.mlrcs'></span>

<h3>Description</h3>

<p><code>coef</code> extracts model coefficients from a <code>mlrcs</code> model fit. <code>coefficients</code> is an alias for it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlrcs'
coef(object, ...)

## S3 method for class 'summary.mlrcs'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.mlrcs_+3A_object">object</code></td>
<td>
<p>An object of class <code>mlrcs</code> or <code>summary.mlrcs</code>.</p>
</td></tr>
<tr><td><code id="coef.mlrcs_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

<hr>
<h2 id='coef.mlsurv'>Extract Model Coefficients</h2><span id='topic+coef.mlsurv'></span><span id='topic+coef.summary.mlsurv'></span>

<h3>Description</h3>

<p><code>coef</code> extracts model coefficients from a <code>mlsurv</code> model fit. <code>coefficients</code> is an alias for it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlsurv'
coef(object, ...)

## S3 method for class 'summary.mlsurv'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.mlsurv_+3A_object">object</code></td>
<td>
<p>An object of class <code>mlsurv</code> or <code>summary.mlsurv</code>.</p>
</td></tr>
<tr><td><code id="coef.mlsurv_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

<hr>
<h2 id='heart.valve'>Aortic valve replacement surgery data</h2><span id='topic+heart.valve'></span><span id='topic+heart.valve.merlin'></span>

<h3>Description</h3>

<p>This is longitudinal data on an observational study on detecting effects of different heart valves, differing on type of tissue, implanted in the aortic position.
The data consists of longitudinal measurements on three different heart function outcomes, after surgery occurred.
There are several baseline covariates available, and also survival data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(heart.valve)

data(heart.valve.merlin)
</code></pre>


<h3>Format</h3>

<p>This is a data frame in the unbalanced format, that is, with one row per observation.
The data consists in columns for patient identification, time of measurements, longitudinal multiple longitudinal measurements, baseline covariates, and survival data.
The column names are identified as follows:
</p>

<dl>
<dt><code>num</code></dt><dd><p>number for patient identification.</p>
</dd>
<dt><code>sex</code></dt><dd><p>gender of patient (<code>0=</code>Male and <code>1=</code>Female).</p>
</dd>
<dt><code>age</code></dt><dd><p>age of patient at day of surgery (years).</p>
</dd>
<dt><code>time</code></dt><dd><p>observed time point, with surgery date as the time origin (years).</p>
</dd>
<dt><code>fuyrs</code></dt><dd><p>maximum follow up time, with surgery date as the time origin (years).</p>
</dd>
<dt><code>status</code></dt><dd><p>censoring indicator (<code>1=</code>died and <code>0=</code>lost at follow up).</p>
</dd>
<dt><code>grad</code></dt><dd><p>valve gradient at follow-up visit.</p>
</dd>
<dt><code>log.grad</code></dt><dd><p>natural log transformation of <code>grad</code>.</p>
</dd>
<dt><code>lvmi</code></dt><dd><p>left ventricular mass index (standardised) at follow-up visit.</p>
</dd>
<dt><code>log.lvmi</code></dt><dd><p>natural log transformation of <code>lvmi</code>.</p>
</dd>
<dt><code>ef</code></dt><dd><p>ejection fraction at follow-up visit.</p>
</dd>
<dt><code>bsa</code></dt><dd><p>preoperative body surface area.</p>
</dd>
<dt><code>lvh</code></dt><dd><p>preoperative left ventricular hypertrophy.</p>
</dd>
<dt><code>prenyha</code></dt><dd><p>preoperative New York Heart Association (NYHA) classification (<code>1=</code>I/II and <code>3=</code>III/IV).</p>
</dd>
<dt><code>redo</code></dt><dd><p>previous cardiac surgery.</p>
</dd>
<dt><code>size</code></dt><dd><p>size of the valve (millimetres).</p>
</dd>
<dt><code>con.cabg</code></dt><dd><p>concomitant coronary artery bypass graft.</p>
</dd>
<dt><code>creat</code></dt><dd><p>preoperative serum creatinine (<code class="reqn">\mu</code>mol/mL).</p>
</dd>
<dt><code>dm</code></dt><dd><p>preoperative diabetes.</p>
</dd>
<dt><code>acei</code></dt><dd><p>preoperative use of ace inhibitor.</p>
</dd>
<dt><code>lv</code></dt><dd><p>preoperative left ventricular ejection fraction (LVEF) (<code>1=</code>good, <code>2=</code>moderate, and <code>3=</code>poor).</p>
</dd>
<dt><code>emergenc</code></dt><dd><p>operative urgency (<code>0=</code>elective, <code>1=</code>urgent, and <code>3=</code>emergency).</p>
</dd>
<dt><code>hc</code></dt><dd><p>preoperative high cholesterol (<code>0=</code>absent, <code>1=</code>present treated, and <code>2=</code>present untreated).</p>
</dd>
<dt><code>sten.reg.mix</code></dt><dd><p>aortic valve haemodynamics (<code>1=</code>stenosis, <code>2=</code>regurgitation, <code>3=</code>mixed).</p>
</dd>
<dt><code>hs</code></dt><dd><p>implanted aortic prosthesis type (<code>1=</code>homograft and <code>0=</code>stentless porcine tissue).</p>
</dd>
</dl>

<p>An object of class <code>data.frame</code> with 629 rows and 29 columns.
</p>


<h3>Note</h3>

<p><code>heart.valve.merlin</code> is a version of the <code>heart.valve</code> dataset in <code>merlin</code> format.
</p>


<h3>Source</h3>

<p>Mr Eric Lim (<a href="http://www.drericlim.com">http://www.drericlim.com</a>)
</p>


<h3>References</h3>

<p>Lim E, Ali A, Theodorou P, Sousa I, Ashrafian H, Chamageorgakis T, Duncan M, Diggle P, Pepper J. A longitudinal study of the profile and predictors of left ventricular mass regression after stentless aortic valve replacement. <em>Ann Thorac Surg.</em> 2008; <strong>85(6)</strong>: 2026-2029.
</p>

<hr>
<h2 id='logLik.merlin'>Extract Log-Likelihood</h2><span id='topic+logLik.merlin'></span><span id='topic+logLik.summary.merlin'></span>

<h3>Description</h3>

<p>Extract log-likelihood of a <code>merlin</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merlin'
logLik(object, ...)

## S3 method for class 'summary.merlin'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.merlin_+3A_object">object</code></td>
<td>
<p>An object of class <code>merlin</code> or <code>summary.merlin</code>.</p>
</td></tr>
<tr><td><code id="logLik.merlin_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

<hr>
<h2 id='logLik.mlrcs'>Extract Log-Likelihood</h2><span id='topic+logLik.mlrcs'></span><span id='topic+logLik.summary.mlrcs'></span>

<h3>Description</h3>

<p>Extract log-likelihood of a <code>mlrcs</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlrcs'
logLik(object, ...)

## S3 method for class 'summary.mlrcs'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.mlrcs_+3A_object">object</code></td>
<td>
<p>An object of class <code>mlrcs</code> or <code>summary.mlrcs</code>.</p>
</td></tr>
<tr><td><code id="logLik.mlrcs_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

<hr>
<h2 id='logLik.mlsurv'>Extract Log-Likelihood</h2><span id='topic+logLik.mlsurv'></span><span id='topic+logLik.summary.mlsurv'></span>

<h3>Description</h3>

<p>Extract log-likelihood of a <code>mlsurv</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlsurv'
logLik(object, ...)

## S3 method for class 'summary.mlsurv'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.mlsurv_+3A_object">object</code></td>
<td>
<p>An object of class <code>mlsurv</code> or <code>summary.mlsurv</code>.</p>
</td></tr>
<tr><td><code id="logLik.mlsurv_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

<hr>
<h2 id='merlin'>merlin - Mixed Effects Regression for Linear, Nonlinear and User-defined models</h2><span id='topic+merlin'></span>

<h3>Description</h3>

<p>merlin fits linear, non-linear and user-defined mixed effects regression models. merlin can fit
multivariate outcome models of any type, each of which could be repeatedly measured
(longitudinal), with any number of levels, and with any number of random effects at each level.
Standard distributions/models available include the Bernoulli, Gaussian, Poisson, beta,
negative-binomial, and time-to-event/survival models include the exponential, Gompertz,
Weibull, Royston-Parmar, and general hazard model. merlin provides a
flexible predictor syntax, allowing the user to define variables, random effects, spline and
fractional polynomial functions, functions of other outcome models, and any interaction
between each of them. Non-linear and time-dependent effects are seamlessly incorporated into
the predictor. merlin allows multivariate normal random effects, which are integrated out
using Gaussian quadrature or Monte-Carlo integration. Relative survival (excess hazard) models
are supported. Utility functions are provided to allow user-defined models to be specified,
in conjunction with the complex predictor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin(
  model,
  from = NULL,
  family = "gaussian",
  link = NULL,
  timevar = NULL,
  covariance = "diagonal",
  data,
  userf = NULL,
  sweights = NULL,
  levels = NULL,
  predict = FALSE,
  predtype = NULL,
  predmodel = NULL,
  causes = NULL,
  at = NULL,
  contrast = NULL,
  modelfit = NULL,
  control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_+3A_model">model</code></td>
<td>
<p>specify the fixed and random elements for each model outcome.
Where there are multiple outcomes, the models should be specified in a list.
Each model should be specified as a formula (e.g. <code>y~x</code>).
A number of different element types can be specified, including
</p>

<ul>
<li><p> varname - an independent variable from the data set
</p>
</li>
<li><p> random-effects - a random-effect at the cluster level can be specified using <code>M#[cluster level]</code>, for example <code>M1[id]</code> would define a random intercept at the ID level.
Each independent random-effect should be given a unique name, if two random-effects are given the same name they will be treated as shared random-effects.
</p>
</li>
<li> <p><code>rcs()</code> - restricted cubic spline terms, this option can be used to include a restricted cubic spline function, with the degrees of freedom (number of spline terms) specified using the <code>df</code> sub-option, with the boundary knots assumed to be at the minimum and maximum of the variable, with internal knots placed at equally spaced centiles.
Other default options <code>orthog = TRUE</code>, which by default orthogonalises the splines, <code>log = FALSE</code>, which can be used to calculate splines of the log of the variable and <code>event = F</code>, which can be used to calculate the internal knots based only on observations that experienced the event of interest (for survival models).
</p>
</li>
<li> <p><code>srcs()</code> is a shorthand element, equivalent to <code>rcs(..., log = TRUE, event = TRUE)</code>, for use with survival models.
</p>
</li>
<li> <p><code>fp()</code> - fractional polynomials of order 1 or 2 can be specified, the sub-option <code>powers</code> is used to specify the powers of the <code>fp</code> model.
</p>
</li>
<li> <p><code>EV[depvar]</code> - the expected value of the response of a submodel.
</p>
</li>
<li> <p><code>dEV[depvar]</code> - the first derivative with respect to time of the expected value of the response of a submodel.
</p>
</li>
<li> <p><code>d2EV[depvar]</code> - the second derivative with respect to time of the expected value of the response of a submodel.
</p>
</li>
<li> <p><code>iEV[depvar]</code> - the integral with respect to time of the expected value of the response of a submodel.
</p>
</li>
<li> <p><code>XB[depvar]</code> - the expected value of the complex predictor of a submodel.
</p>
</li>
<li> <p><code>dXB[depvar]</code> - the first derivative with respect to time of the expected value of the complex predictor of a submodel.
</p>
</li>
<li> <p><code>d2XB[depvar]</code> - the second derivative with respect to time of the expected value of the complex predictor of a submodel.
</p>
</li>
<li> <p><code>iXB[depvar]</code> - the integral with respect to time of the expected value of the complex predictor of a submodel.
</p>
</li>
<li> <p><code>bhazard(varname)</code> - invokes a relative survival (excess hazard) model.
<code>varname</code> specifies the expected hazard rate at the event time.
</p>
</li>
<li> <p><code>exposure(varname)</code> - include <code>log(varname)</code> in the linear predictor, with a coefficient of 1.
For use with <code>family = "poisson"</code>.
</p>
</li>
<li> <p><code>ap(#)</code> - defines the number of ancillary parameters.
Used with <code>family="user"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="merlin_+3A_from">from</code></td>
<td>
<p>this is an optional argument giving the initial values for the full parameter vector, for more details on how to specify the initial estimates see the vignette.</p>
</td></tr>
<tr><td><code id="merlin_+3A_family">family</code></td>
<td>
<p>a vector of strings specifying the family for each outcome specified in model.
The currently available models include,
</p>

<ul>
<li> <p><code>gaussian</code> - Gaussian distribution
</p>
</li>
<li> <p><code>bernoulli</code> - Bernoulli distribution
</p>
</li>
<li> <p><code>poisson</code> - Poisson distribution
</p>
</li>
<li> <p><code>beta</code> - Beta distribution
</p>
</li>
<li> <p><code>negbinomial</code> - Negative binomial distribution
</p>
</li></ul>

<p>with survival models including,
</p>

<ul>
<li> <p><code>exponential</code> - exponential distribution
</p>
</li>
<li> <p><code>weibull</code> - Weibull distribution
</p>
</li>
<li> <p><code>gompertz</code> - Gompertz distribution
</p>
</li>
<li> <p><code>rp</code> - Royston-Parmar model (complex predictor on the log cumulative hazard scale)
</p>
</li>
<li> <p><code>loghazard</code> - general log hazard model (complex predictor on the log hazard scale)
</p>
</li></ul>

<p>and user-defined,
</p>

<ul>
<li> <p><code>user</code> - fit a user-defined model, which should be written using <code>merlin</code>'s utility functions.
The name of your user-defined function should be passed through the <code>userf</code> option.
</p>
</li>
<li> <p><code>null</code> - is a convenience tool to define additional complex predictors, that do not contribute to the log likelihood.
For use with <code>family = "user"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="merlin_+3A_link">link</code></td>
<td>
<p>string vector defining the link functions for each model.
Default is <code>"identity"</code> for all models.
If specified, you must define a link function for all submodels.
Options include <code>"identity"</code>, <code>"log"</code> and <code>"logit"</code>.</p>
</td></tr>
<tr><td><code id="merlin_+3A_timevar">timevar</code></td>
<td>
<p>specifies the variable which represents time, this is necessary when a function of time is used in the linear predictor of a survival model as it may interact with other elements of the model.</p>
</td></tr>
<tr><td><code id="merlin_+3A_covariance">covariance</code></td>
<td>
<p>the structure of the variance-covariance matrix can be varied, the default is <code>diagonal</code> where all diagonal elements of the variance-covariance matrix are estimated uniquely, <code>identity</code> assumes all diagonal elements are equal and <code>unstructured</code> estimates all elements of the variance-covariance matrix.</p>
</td></tr>
<tr><td><code id="merlin_+3A_data">data</code></td>
<td>
<p>a data frame containing all variables required for fitting the model.
Can be a <code>tibble</code> object.</p>
</td></tr>
<tr><td><code id="merlin_+3A_userf">userf</code></td>
<td>
<p>string vector defining the name of the user-written functions for each <code>family="user"</code>.
Each function must be in memory and should return the observation level contribution to the log-likelihood.</p>
</td></tr>
<tr><td><code id="merlin_+3A_sweights">sweights</code></td>
<td>
<p>Not documented.</p>
</td></tr>
<tr><td><code id="merlin_+3A_levels">levels</code></td>
<td>
<p>if the model contains random-effects then a vector giving the order of levels must be specified, from the highest level to the lowest, e.g. <code>levels=c("practice","id")</code>.</p>
</td></tr>
<tr><td><code id="merlin_+3A_predict">predict</code></td>
<td>
<p>Not documented.</p>
</td></tr>
<tr><td><code id="merlin_+3A_predtype">predtype</code></td>
<td>
<p>Not documented.</p>
</td></tr>
<tr><td><code id="merlin_+3A_predmodel">predmodel</code></td>
<td>
<p>Not documented.</p>
</td></tr>
<tr><td><code id="merlin_+3A_causes">causes</code></td>
<td>
<p>Not documented.</p>
</td></tr>
<tr><td><code id="merlin_+3A_at">at</code></td>
<td>
<p>Not documented.</p>
</td></tr>
<tr><td><code id="merlin_+3A_contrast">contrast</code></td>
<td>
<p>Not documented.</p>
</td></tr>
<tr><td><code id="merlin_+3A_modelfit">modelfit</code></td>
<td>
<p>Not documented.</p>
</td></tr>
<tr><td><code id="merlin_+3A_control">control</code></td>
<td>
<p>A list of parameters that control the estimation algorithm.
Generally it should not be modified, unless there are convergence issues.
Possible values are:
</p>

<ul>
<li> <p><code>ip</code> An optional vector of integers specifying the number of integration points to be used when integrating out the random effects.
A different number of <code>ip</code> can be specified for each <code>level</code> (from highest to lowest level).
If only a single number is given then <code>merlin</code> will assume that number of integration points at all levels.
Default is <code>ip = 7</code> for each level using Gauss-Hermite quadrature, or <code>ip = 100</code> for each level using Monte-Carlo integration;
</p>
</li>
<li> <p><code>intmethod</code> The method used for numerically integrating out the random-effects in order to calculate the likelihood for a mixed effects model which includes random effects.
Options include <code>ghermite</code> for non-adaptive Gauss-Hermite quadrature, <code>halton</code> for Monte-Carlo integration using Halton sequences, <code>sobol</code> for Monte-Carlo integration using Sobol sequences, or <code>mc</code> for standard Monte-Carlo integration using normal draws.
The default is <code>ghermite</code>.
Level-specific integration techniques can be specified, for example, with a three level model, we may use Gauss-Hermite quadrature at the highest level, and Monte-Carlo integration with Halton sequences at level 2, using <code>intmethod = c("ghermite","halton")</code>.
</p>
</li>
<li> <p><code>debug</code> Not documented.
</p>
</li>
<li> <p><code>verbose</code> Not documented.
</p>
</li>
<li> <p><code>optim.method</code> The <code>optim</code> method to be used.
Defaults to Nelder-Mead, see <a href="stats.html#topic+optim">optim</a> for available methods.
</p>
</li>
<li> <p><code>maxit</code> The maximum number of iterations for the optimisation routine.
Defaults to 5000.
</p>
</li></ul>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emma C. Martin, Alessandro Gasparini and Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear, non-linear and user-defined models.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.merlin">predict.merlin</a></code>
</p>
<p><code><a href="#topic+merlin_util_depvar">merlin_util_depvar</a></code>, <code><a href="#topic+merlin_util_timevar">merlin_util_timevar</a></code>,
<code><a href="#topic+merlin_util_xzb">merlin_util_xzb</a></code>, <code><a href="#topic+merlin_util_xzb_mod">merlin_util_xzb_mod</a></code>
<code><a href="#topic+merlin_util_xzb_deriv">merlin_util_xzb_deriv</a></code>, <code><a href="#topic+merlin_util_xzb_deriv_mod">merlin_util_xzb_deriv_mod</a></code>
<code><a href="#topic+merlin_util_xzb_deriv2">merlin_util_xzb_deriv2</a></code>, <code><a href="#topic+merlin_util_xzb_deriv2_mod">merlin_util_xzb_deriv2_mod</a></code>
<code><a href="#topic+merlin_util_xzb_integ">merlin_util_xzb_integ</a></code>, <code><a href="#topic+merlin_util_xzb_integ_mod">merlin_util_xzb_integ_mod</a></code>
<code><a href="#topic+merlin_util_ev">merlin_util_ev</a></code>, <code><a href="#topic+merlin_util_ev_mod">merlin_util_ev_mod</a></code>
<code><a href="#topic+merlin_util_ev_deriv">merlin_util_ev_deriv</a></code>, <code><a href="#topic+merlin_util_ev_deriv_mod">merlin_util_ev_deriv_mod</a></code>
<code><a href="#topic+merlin_util_ev_deriv2">merlin_util_ev_deriv2</a></code>, <code><a href="#topic+merlin_util_ev_deriv2_mod">merlin_util_ev_deriv2_mod</a></code>
<code><a href="#topic+merlin_util_ev_integ">merlin_util_ev_integ</a></code>, <code><a href="#topic+merlin_util_ev_integ_mod">merlin_util_ev_integ_mod</a></code>
<code><a href="#topic+merlin_util_ap">merlin_util_ap</a></code>, <code><a href="#topic+merlin_util_ap_mod">merlin_util_ap_mod</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(merlin)
data(pbc.merlin, package = "merlin")

# Linear fixed-effects model
merlin(logb ~ year,
       family = "gaussian",
       data = pbc.merlin)

# Linear mixed-effects model with random intercept and slope at ID level
merlin(logb ~ year + M1[id] * 1 + year:M2[id] * 1,
       family = "gaussian",
       levels = "id",
       data = pbc.merlin)

# Joint longitudinal and survival model with shared random effects
merlin(model = list(logb ~ year + M1[id] * 1,
                    Surv(stime, died) ~ trt + M1[id]),
       family = c("gaussian", "weibull"),
       levels = "id",
       data = pbc.merlin)

# Joint longitudinal and survival model with expected value
merlin(model = list(logb ~ year + M1[id] * 1,
                    Surv(stime, died) ~ trt + EV[logb]),
       family = c("gaussian", "weibull"),
       levels = "id",
       timevar = c("year","stime"),
       data = pbc.merlin)

# Gaussian distribution - implemented as a user-written family
logl_gaussian &lt;- function(gml)
{
  y    &lt;- merlin_util_depvar(gml)
  xzb  &lt;- merlin_util_xzb(gml)
  se   &lt;- exp(merlin_util_ap(gml,1))

  mu   &lt;- (sweep(xzb,1,y,"-"))^2
  logl &lt;- ((-0.5 * log(2*pi) - log(se)) - (mu/(2 * se^2)))
  return(logl)
}

merlin(logb ~ year + ap(1), family = "user", data = pbc.merlin,
                                  userf = "logl_gaussian")

# 3-level Weibull model
merlin(Surv(stime1,dead1) ~ age + M1[id1]*1 + M2[id2]*1,
       levels=c("id1","id2"), family="weibull", data=sim3)

## End(Not run)
</code></pre>

<hr>
<h2 id='merlin_util_ap'>merlin_util_ap - returns the current estimate of the ith ancillary parameter for the associated model</h2><span id='topic+merlin_util_ap'></span>

<h3>Description</h3>

<p>merlin_util_ap - returns the current estimate of the ith ancillary parameter for the associated model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_ap(gml, i)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_ap_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_ap_+3A_i">i</code></td>
<td>
<p>index for which ancillary parameter to extract</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_ap_mod'>merlin_util_ap_mod - returns the current estimate of the ith ancillary parameter for the specified model</h2><span id='topic+merlin_util_ap_mod'></span>

<h3>Description</h3>

<p>merlin_util_ap_mod - returns the current estimate of the ith ancillary parameter for the specified model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_ap_mod(gml, m, i)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_ap_mod_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_ap_mod_+3A_m">m</code></td>
<td>
<p>specifies the merlin submodel</p>
</td></tr>
<tr><td><code id="merlin_util_ap_mod_+3A_i">i</code></td>
<td>
<p>index for which ancillary parameter to extract</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_depvar'>merlin_util_depvar - returns the response variable(s)</h2><span id='topic+merlin_util_depvar'></span>

<h3>Description</h3>

<p>Utility function to extract the dependent variable(s) for the current model. If the model
is a survival/time-to-event model, then it will contain the event times in the first column
and the event indicator in the second.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_depvar(gml)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_depvar_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emma C. Martin, Alessandro Gasparini and Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_ev'>merlin_util_ev - returns the observation-level expected value of the outcome</h2><span id='topic+merlin_util_ev'></span>

<h3>Description</h3>

<p>Utility function to extract the expected value of the outcome at the current parameter estimates
for a particular model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_ev(gml, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_ev_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_ev_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_ev_deriv'>merlin_util_ev_deriv - returns the first derivative with respect to time of the
observation-level expected value of the outcome</h2><span id='topic+merlin_util_ev_deriv'></span>

<h3>Description</h3>

<p>Utility function to extract d/dt of the expected value of the outcome at the current
parameter estimates for a particular model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_ev_deriv(gml, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_ev_deriv_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_ev_deriv_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(merlin)
data(pbc.merlin, package = "merlin")

# Linear fixed-effects model
merlin(model = list(logb ~ year),
       family = "gaussian",
       data = pbc.merlin)
</code></pre>

<hr>
<h2 id='merlin_util_ev_deriv_mod'>merlin_util_ev_deriv - returns the first derivative with respect to time of the
observation-level expected value of the specified outcome</h2><span id='topic+merlin_util_ev_deriv_mod'></span>

<h3>Description</h3>

<p>Utility function to extract d/dt of the expected value of the outcome at the current
parameter estimates for a specified model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_ev_deriv_mod(gml, m, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_ev_deriv_mod_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_ev_deriv_mod_+3A_m">m</code></td>
<td>
<p>specifies the merlin submodel</p>
</td></tr>
<tr><td><code id="merlin_util_ev_deriv_mod_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_ev_deriv2'>merlin_util_ev_deriv2 - returns the second derivative with respect to time of the
observation-level expected value of the outcome</h2><span id='topic+merlin_util_ev_deriv2'></span>

<h3>Description</h3>

<p>merlin_util_ev_deriv2 - returns the second derivative with respect to time of the
observation-level expected value of the outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_ev_deriv2(gml, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_ev_deriv2_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_ev_deriv2_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_ev_deriv2_mod'>merlin_util_ev_deriv2_mod - returns the second derivative with respect to time of the
observation-level expected value of the specified outcome</h2><span id='topic+merlin_util_ev_deriv2_mod'></span>

<h3>Description</h3>

<p>merlin_util_ev_deriv2_mod - returns the second derivative with respect to time of the
observation-level expected value of the specified outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_ev_deriv2_mod(gml, m, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_ev_deriv2_mod_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_ev_deriv2_mod_+3A_m">m</code></td>
<td>
<p>specifies the merlin submodel</p>
</td></tr>
<tr><td><code id="merlin_util_ev_deriv2_mod_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_ev_integ'>merlin_util_ev_integ - returns the integral with respect to time of the
observation-level expected value of the outcome</h2><span id='topic+merlin_util_ev_integ'></span>

<h3>Description</h3>

<p>merlin_util_ev_integ - returns the integral with respect to time of the
observation-level expected value of the outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_ev_integ(gml, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_ev_integ_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_ev_integ_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_ev_integ_mod'>merlin_util_ev_integ_mod - returns the integral with respect to time of the
observation-level expected value of the specified outcome</h2><span id='topic+merlin_util_ev_integ_mod'></span>

<h3>Description</h3>

<p>merlin_util_ev_integ_mod - returns the integral with respect to time of the
observation-level expected value of the specified outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_ev_integ_mod(gml, m, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_ev_integ_mod_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_ev_integ_mod_+3A_m">m</code></td>
<td>
<p>specifies the merlin submodel</p>
</td></tr>
<tr><td><code id="merlin_util_ev_integ_mod_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_ev_mod'>merlin_util_ev_mod - returns the observation-level expected value of the outcome for a specified model</h2><span id='topic+merlin_util_ev_mod'></span>

<h3>Description</h3>

<p>Utility function to extract the expected value of the outcome at the current parameter estimates
for a specified model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_ev_mod(gml, m, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_ev_mod_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_ev_mod_+3A_m">m</code></td>
<td>
<p>specifies the model</p>
</td></tr>
<tr><td><code id="merlin_util_ev_mod_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_timevar'>merlin_util_timevar - returns the time variable</h2><span id='topic+merlin_util_timevar'></span>

<h3>Description</h3>

<p>Utility function to extract the time variable(s) for the current model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_timevar(gml)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_timevar_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_xzb'>merlin_util_xzb - returns the observation-level complex predictor</h2><span id='topic+merlin_util_xzb'></span>

<h3>Description</h3>

<p>Utility function to extract the complex predictor evaluated at the current parameter estimates
for a particular model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_xzb(gml, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_xzb_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emma C. Martin, Alessandro Gasparini and Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(merlin)
data(pbc.merlin, package = "merlin")

# Linear fixed-effects model
merlin(model = list(logb ~ year),
       family = "gaussian",
       data = pbc.merlin)
</code></pre>

<hr>
<h2 id='merlin_util_xzb_deriv'>merlin_util_xzb_deriv - returns the first derivative with respect to time of the
observation-level complex predictor</h2><span id='topic+merlin_util_xzb_deriv'></span>

<h3>Description</h3>

<p>Utility function to extract d/dt of the complex predictor evaluated at the current
parameter estimates for a particular model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_xzb_deriv(gml, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_xzb_deriv_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_deriv_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(merlin)
data(pbc.merlin, package = "merlin")

# Linear fixed-effects model
merlin(model = list(logb ~ year),
       family = "gaussian",
       data = pbc.merlin)
</code></pre>

<hr>
<h2 id='merlin_util_xzb_deriv_mod'>merlin_util_xzb_deriv_mod - returns the first derivative with respect to time of the
observation-level complex predictor of a specified model</h2><span id='topic+merlin_util_xzb_deriv_mod'></span>

<h3>Description</h3>

<p>merlin_util_xzb_deriv_mod - returns the first derivative with respect to time of the
observation-level complex predictor of a specified model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_xzb_deriv_mod(gml, m, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_xzb_deriv_mod_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_deriv_mod_+3A_m">m</code></td>
<td>
<p>specifies the merlin submodel</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_deriv_mod_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_xzb_deriv2'>merlin_util_xzb_deriv2 - returns the second derivative with respect to time of the
observation-level complex predictor</h2><span id='topic+merlin_util_xzb_deriv2'></span>

<h3>Description</h3>

<p>merlin_util_xzb_deriv2 - returns the second derivative with respect to time of the
observation-level complex predictor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_xzb_deriv2(gml, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_xzb_deriv2_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_deriv2_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_xzb_deriv2_mod'>merlin_util_xzb_deriv2_mod - returns the second derivative with respect to time of the
observation-level complex predictor of the specified model</h2><span id='topic+merlin_util_xzb_deriv2_mod'></span>

<h3>Description</h3>

<p>merlin_util_xzb_deriv2_mod - returns the second derivative with respect to time of the
observation-level complex predictor of the specified model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_xzb_deriv2_mod(gml, m, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_xzb_deriv2_mod_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_deriv2_mod_+3A_m">m</code></td>
<td>
<p>specifies the merlin submodel</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_deriv2_mod_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_xzb_integ'>merlin_util_xzb_integ - returns the integral with respect to time of the
observation-level complex predictor</h2><span id='topic+merlin_util_xzb_integ'></span>

<h3>Description</h3>

<p>merlin_util_xzb_integ - returns the integral with respect to time of the
observation-level complex predictor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_xzb_integ(gml, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_xzb_integ_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_integ_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_xzb_integ_mod'>merlin_util_xzb_integ_mod - returns the integral with respect to time of the
observation-level complex predictor of the specified model</h2><span id='topic+merlin_util_xzb_integ_mod'></span>

<h3>Description</h3>

<p>merlin_util_xzb_integ_mod - returns the integral with respect to time of the
observation-level complex predictor of the specified model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_xzb_integ_mod(gml, m, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_xzb_integ_mod_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_integ_mod_+3A_m">m</code></td>
<td>
<p>specifies the merlin submodel</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_integ_mod_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='merlin_util_xzb_mod'>merlin_util_xzb_mod - returns the observation-level complex predictor of the specified model</h2><span id='topic+merlin_util_xzb_mod'></span>

<h3>Description</h3>

<p>Utility function to extract the complex predictor evaluated at the current parameter estimates
for a particular model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merlin_util_xzb_mod(gml, m, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merlin_util_xzb_mod_+3A_gml">gml</code></td>
<td>
<p>merlin object - should not be edited</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_mod_+3A_m">m</code></td>
<td>
<p>specifies the merlin submodel</p>
</td></tr>
<tr><td><code id="merlin_util_xzb_mod_+3A_t">t</code></td>
<td>
<p>specifies the variable which represents time</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects regression of linear and non-linear models.
</p>

<hr>
<h2 id='mlrcs'>Fit multi-level restricted cubic spline model</h2><span id='topic+mlrcs'></span>

<h3>Description</h3>

<p>Fit multi-level restricted cubic spline model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlrcs(formula, random = NULL, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlrcs_+3A_formula">formula</code></td>
<td>
<p>A model formula for the fixed-effects in the model. Must include one restricted cubic spline term, specified as <code>rcs(variable, df = #)</code>.</p>
</td></tr>
<tr><td><code id="mlrcs_+3A_random">random</code></td>
<td>
<p>A formula for the random-effects in the model. Random-effects should be specified as a one-sided formula, e.g. <code>~ 1 + trt | id</code> for random effect on the intercept and treatment at the <code>id</code> level. Random-effects can be estimated at any number of nested random-effect levels by providing a list of one-sided formulas. When specifying random-effect at multiple levels. The one-sided formula should be given in order, starting with the highest level.
Only required when <code>rcs = TRUE</code>.</p>
</td></tr>
<tr><td><code id="mlrcs_+3A_data">data</code></td>
<td>
<p>A data frame containing all variables required for fitting the model.</p>
</td></tr>
<tr><td><code id="mlrcs_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <a href="#topic+merlin">merlin</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>mlrcs</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Two-level model
data("pbc.merlin", package = "merlin")
fit &lt;- mlrcs(formula = logp ~ 1 + rcs(year, df = 4) + age + trt,
             random  = ~ 1 + trt | id,
             data = pbc.merlin
)
summary(fit)

# Three-level model
fit &lt;- mlrcs(formula = logp ~ 1 + rcs(year, df = 4) + age + trt,
             random  = list(~ 1 | region,
                            ~ 1 + trt | id),
             data = pbc.merlin
)
summary(fit)

## End(Not run)


</code></pre>

<hr>
<h2 id='mlsurv'>Fit proportional hazards survival models</h2><span id='topic+mlsurv'></span>

<h3>Description</h3>

<p>Fit proportional hazards survival models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlsurv(
  formula,
  distribution,
  df = NULL,
  powers = NULL,
  rcs = TRUE,
  data,
  from.null = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlsurv_+3A_formula">formula</code></td>
<td>
<p>A model formula, where the left-hand side is a <a href="survival.html#topic+Surv">Surv</a> object.</p>
</td></tr>
<tr><td><code id="mlsurv_+3A_distribution">distribution</code></td>
<td>
<p>A parametric distribution for the baseline hazard.
Possible values are <code>exponential</code>, <code>weibull</code>, <code>gompertz</code>, <code>rp</code>, <code>logchazard</code>, and <code>loghazard</code>.
<code>rp</code> is equivalent to a <code>logchazard</code> model with restricted cubic splines (argument <code>rcs = TRUE</code>).</p>
</td></tr>
<tr><td><code id="mlsurv_+3A_df">df</code></td>
<td>
<p>Represents the number of degrees of freedom used for the restricted cubic splines when flexibly modelling the baseline hazard.
Only required when <code>rcs = TRUE</code>.</p>
</td></tr>
<tr><td><code id="mlsurv_+3A_powers">powers</code></td>
<td>
<p>A vector representing the degree of the fractional polynomials used to model the baseline hazard (with a maximum degree of 2).
Only required when <code>rcs = FALSE</code>.</p>
</td></tr>
<tr><td><code id="mlsurv_+3A_rcs">rcs</code></td>
<td>
<p>Use restricted cubic splines when flexibly modelling the baseline hazard? Defaults to <code>TRUE</code>, and the alternative is using fractional polynomials.</p>
</td></tr>
<tr><td><code id="mlsurv_+3A_data">data</code></td>
<td>
<p>A data frame containing all variables required for fitting the model.
Can be a <code>tibble</code> object.</p>
</td></tr>
<tr><td><code id="mlsurv_+3A_from.null">from.null</code></td>
<td>
<p>A vector of starting values for the null model (used to get improved starting values). This is mostly useful when experiencing issues with default starting values or convergence issues.</p>
</td></tr>
<tr><td><code id="mlsurv_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <a href="#topic+merlin">merlin</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>mlsurv</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Weibull model
library(survival)
data("pbc.merlin", package = "merlin")
fit &lt;- mlsurv(
  formula = Surv(stime, died) ~ trt,
  distribution = "weibull",
  data = pbc.merlin
)
summary(fit)

# Royston-Parmar model with 3 degrees of freedom
fit &lt;- mlsurv(
  formula = Surv(stime, died) ~ trt,
  distribution = "rp",
  df = 3,
  data = pbc.merlin
)
summary(fit)

## Not run: 
# Flexible parametric model on the log-hazard scale with fractional polynomials
fit &lt;- mlsurv(
  formula = Surv(stime, died) ~ trt,
  distribution = "loghazard",
  powers = c(0, 1),
  rcs = FALSE,
  data = pbc.merlin
)
summary(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='pbc'>Mayo Clinic primary biliary cirrhosis data</h2><span id='topic+pbc'></span><span id='topic+pbc.merlin'></span>

<h3>Description</h3>

<p>This data is from the Mayo Clinic trial in primary biliary
cirrhosis (PBC) of the liver conducted between 1974 and 1984. A total of
424 PBC patients, referred to Mayo Clinic during that ten-year interval met
eligibility criteria for the randomized placebo controlled trial of the
drug D-penicillamine, but only the first 312 cases in the data set
participated in the randomized trial. Therefore, the data here are for the
312 patients with largely complete data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pbc)

data(pbc.merlin)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1945 observations on the following 20 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p>patients identifier; in total there are 312 patients.</p>
</dd>
<dt><code>years</code></dt><dd><p>number of years between registration and the earlier of death, transplantation, or study analysis time.</p>
</dd>
<dt><code>status</code></dt><dd><p>a factor with levels <code>alive</code>, <code>transplanted</code> and <code>dead</code>.</p>
</dd>
<dt><code>drug</code></dt><dd><p>a factor with levels <code>placebo</code> and <code>D-penicil</code>.</p>
</dd>
<dt><code>age</code></dt><dd><p>at registration in years.</p>
</dd>
<dt><code>sex</code></dt><dd><p>a factor with levels <code>male</code> and <code>female</code>.</p>
</dd>
<dt><code>year</code></dt><dd><p>number of years between enrollment and this visit date, remaining values on the line of data refer to this visit.</p>
</dd>
<dt><code>ascites</code></dt><dd><p>a factor with levels <code>No</code> and <code>Yes</code>.</p>
</dd>
<dt><code>hepatomegaly</code></dt><dd><p>a factor with levels <code>No</code> and <code>Yes</code>.</p>
</dd>
<dt><code>spiders</code></dt><dd><p>a factor with levels <code>No</code> and <code>Yes</code>.</p>
</dd>
<dt><code>edema</code></dt><dd><p>a factor with levels <code>No edema</code> (i.e. no edema and no diuretic therapy for edema), <code>edema no diuretics</code> (i.e. edema present without diuretics, or edema resolved by diuretics), and <code>edema despite diuretics</code> (i.e. edema despite diuretic therapy).</p>
</dd>
<dt><code>serBilir</code></dt><dd><p>serum bilirubin in mg/dl.</p>
</dd>
<dt><code>serChol</code></dt><dd><p>serum cholesterol in mg/dl.</p>
</dd>
<dt><code>albumin</code></dt><dd><p>albumin in mg/dl.</p>
</dd>
<dt><code>alkaline</code></dt><dd><p>alkaline phosphatase in U/liter.</p>
</dd>
<dt><code>SGOT</code></dt><dd><p>SGOT in U/ml.</p>
</dd>
<dt><code>platelets</code></dt><dd><p>platelets per cubic ml/1000.</p>
</dd>
<dt><code>prothrombin</code></dt><dd><p>prothrombin time in seconds.</p>
</dd>
<dt><code>histologic</code></dt><dd><p>histologic stage of disease.</p>
</dd>
<dt><code>status2</code></dt><dd><p>a numeric vector with the value 1 denoting if the patient was dead, and 0 if the patient was alive or transplanted.</p>
</dd>
</dl>

<p>An object of class <code>data.frame</code> with 1945 rows and 25 columns.
</p>


<h3>Note</h3>

<p><code>pbc.merlin</code> is a version of the <code>pbc</code> dataset in <code>merlin</code> format.
</p>


<h3>Source</h3>

<p><code><a href="survival.html#topic+pbc">pbc</a></code>.
</p>


<h3>References</h3>

<p>Fleming T, Harrington D. <em>Counting Processes and Survival Analysis</em>.
1991; New York: Wiley.
</p>
<p>Therneau T, Grambsch P. <em>Modeling Survival Data: Extending the Cox
Model</em>. 2000; New York: Springer-Verlag.
</p>

<hr>
<h2 id='predict.merlin'>predict.merlin - post-estimation tools for merlin</h2><span id='topic+predict.merlin'></span>

<h3>Description</h3>

<p>predictions following the fit of a merlin model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merlin'
predict(
  object,
  stat = "eta",
  type = "fixedonly",
  predmodel = 1,
  causes = NULL,
  at = NULL,
  contrast = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.merlin_+3A_object">object</code></td>
<td>
<p>merlin model object</p>
</td></tr>
<tr><td><code id="predict.merlin_+3A_stat">stat</code></td>
<td>
<p>specifies which prediction, which can be one of:
</p>

<ul>
<li> <p><code>eta</code> the expected value of the complex predictor
</p>
</li>
<li> <p><code>mu</code> the expected value of the response variable
</p>
</li>
<li> <p><code>hazard</code> the hazard function
</p>
</li>
<li> <p><code>chazard</code> the cumulative hazard function
</p>
</li>
<li> <p><code>logchazard</code> the log cumulative hazard function
</p>
</li>
<li> <p><code>survival</code> the survival function
</p>
</li>
<li> <p><code>cif</code> the cumulative incidence function
</p>
</li>
<li> <p><code>rmst</code> calculates the restricted mean survival time, which is the integral of the
survival function within the interval (0,t], where t is the time at which predictions are made.
If multiple survival models have been specified in your merlin model, then it will assume all
of them are cause-specific competing risks models, and include them in the calculation. If
this is not the case, you can override which models are included by using the <code>causes</code>
option. <code>rmst = t - totaltimelost</code>.
</p>
</li>
<li> <p><code>timelost</code>  calculates the time lost due to a particular event occurring, within
the interval (0,t].  In a single event survival model, this is the integral of the cif between
(0,t].  If multiple survival models are specified in the merlin model then by default all are
assumed to be cause-specific event time models contributing to the calculation. This can be
overridden using the <code>causes</code> option.
</p>
</li>
<li> <p><code>totaltimelost</code> total time lost due to all competing events, within (0,t]. If multiple
survival models are specified in the <code>merlin</code> model then by default all are assumed to
be cause-specific event time models contributing to the calculation. This can be overridden
using the <code>causes</code> option. <code>totaltimelost</code> is the sum of the <code>timelost</code> due to
all causes.
</p>
</li>
<li> <p><code>cifdifference</code> calculates the difference in <code>cif</code> predictions between values 
of a covariate specified using the <code>contrast</code> option.
</p>
</li>
<li> <p><code>hdifference</code> calculates the difference in <code>hazard</code> predictions between values 
of a covariate specified using the <code>contrast</code> option. 
</p>
</li>
<li> <p><code>rmstdifference</code> calculates the difference in <code>rmst</code> predictions between values 
of a covariate specified using the <code>contrast</code> option. 
</p>
</li>
<li> <p><code>mudifference</code> calculates the difference in <code>mu</code> predictions between values 
of a covariate specified using the <code>contrast</code> option. 
</p>
</li>
<li> <p><code>etadifference</code> calculates the difference in <code>eta</code> predictions between values 
of a covariate specified using the <code>contrast</code> option.  
</p>
</li></ul>
</td></tr>
<tr><td><code id="predict.merlin_+3A_type">type</code></td>
<td>
<p>the type of prediction, either:
</p>

<ul>
<li> <p><code>fixedonly</code> prediction calculated based only on the fixed effects; the default.
</p>
</li>
<li> <p><code>marginal</code> prediction calculated marginally with respect to the latent variables. the
<code>stat</code> is calculated by integrating the prediction function with respect to all the latent
variables over their entire support.
</p>
</li></ul>
</td></tr>
<tr><td><code id="predict.merlin_+3A_predmodel">predmodel</code></td>
<td>
<p>specifies which model to obtain predictions from; default is <code>predmodel=1</code></p>
</td></tr>
<tr><td><code id="predict.merlin_+3A_causes">causes</code></td>
<td>
<p>is for use when calculating predictions from a competing risks <code>merlin</code> model.
By default, <code>cif</code>, <code>rmst</code>, <code>timelost</code> and <code>totaltimelost</code> assume that all
survival models included in the merlin model are cause-specific hazard models contributing to
the calculation. If this is not the case, then you can specify which models (indexed using
the order they appear in your merlin model by using the <code>causes</code> option, e.g.
<code>causes=c(1,2)</code>.</p>
</td></tr>
<tr><td><code id="predict.merlin_+3A_at">at</code></td>
<td>
<p>specify covariate values for prediction. Fixed values of covariates should be specified
in a list e.g. at = c(&quot;trt&quot; = 1, &quot;age&quot; = 50).</p>
</td></tr>
<tr><td><code id="predict.merlin_+3A_contrast">contrast</code></td>
<td>
<p>specifies the values of a covariate to be used when comparing statistics, 
such as when using the <code>cifdifference</code> option to compare cumulative incidence functions, 
e.g. <code>contrast = c("trt" = 0, "trt" = 1)</code>.</p>
</td></tr>
<tr><td><code id="predict.merlin_+3A_...">...</code></td>
<td>
<p>other options</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emma C. Martin, Alessandro Gasparini and Michael J. Crowther
</p>


<h3>References</h3>

<p>Crowther MJ. Extended multivariate generalised linear and non-linear mixed
effects models. <a href="https://arxiv.org/abs/1710.02223">https://arxiv.org/abs/1710.02223</a>
</p>
<p>Crowther MJ. merlin - a unified framework for data analysis and methods development
in Stata. <a href="https://arxiv.org/abs/1806.01615">https://arxiv.org/abs/1806.01615</a>
</p>
<p>Martin EC, Gasparini A, Crowther MJ. merlin - an R package for mixed effects
regression of linear, non-linear and user-defined models.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+merlin">merlin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(merlin)
data(pbc.merlin, package = "merlin")

# Linear fixed-effects model
mod &lt;-merlin(model = list(logb ~ year),
             family = "gaussian",
             data = pbc.merlin)
predict(mod,stat="eta",type="fixedonly")

</code></pre>

<hr>
<h2 id='print.merlin'>Print <code>merlin</code> Fits</h2><span id='topic+print.merlin'></span>

<h3>Description</h3>

<p>Print the coefficients from a <code>merlin</code> fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merlin'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.merlin_+3A_x">x</code></td>
<td>
<p>An object of class <code>merlin</code>.</p>
</td></tr>
<tr><td><code id="print.merlin_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="print.merlin_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

<hr>
<h2 id='print.mlrcs'>Print <code>mlrcs</code> Fits</h2><span id='topic+print.mlrcs'></span>

<h3>Description</h3>

<p>Print the coefficients from a <code>mlrsc</code> fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlrcs'
print(x, digits = max(3L, getOption("digits") - 3L), simplify = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mlrcs_+3A_x">x</code></td>
<td>
<p>An object of class <code>mlrcs</code>.</p>
</td></tr>
<tr><td><code id="print.mlrcs_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="print.mlrcs_+3A_simplify">simplify</code></td>
<td>
<p>Should non-interpretable coefficients be hidden (e.g. splines and flexible polynomials terms)? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="print.mlrcs_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

<hr>
<h2 id='print.mlsurv'>Print <code>mlsurv</code> Fits</h2><span id='topic+print.mlsurv'></span>

<h3>Description</h3>

<p>Print the coefficients from a <code>mlsurv</code> fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlsurv'
print(x, digits = max(3L, getOption("digits") - 3L), simplify = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mlsurv_+3A_x">x</code></td>
<td>
<p>An object of class <code>mlsurv</code>.</p>
</td></tr>
<tr><td><code id="print.mlsurv_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="print.mlsurv_+3A_simplify">simplify</code></td>
<td>
<p>Should non-interpretable coefficients be hidden (e.g. splines and flexible polynomials terms)? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="print.mlsurv_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

<hr>
<h2 id='sim3'>Simulated 3-level survival data</h2><span id='topic+sim3'></span>

<h3>Description</h3>

<p>Simulated 3-level survival data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sim3)
</code></pre>


<h3>Format</h3>

<p>A data frame...
</p>

<hr>
<h2 id='summary.merlin'>Summarizing <code>merlin</code> Fits</h2><span id='topic+summary.merlin'></span><span id='topic+print.summary.merlin'></span>

<h3>Description</h3>

<p>These functions are all methods for class <code>merlin</code> or <code>summary.merlin</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merlin'
summary(object, sig = 0.95, ...)

## S3 method for class 'summary.merlin'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.merlin_+3A_object">object</code></td>
<td>
<p>An object of class <code>merlin</code></p>
</td></tr>
<tr><td><code id="summary.merlin_+3A_sig">sig</code></td>
<td>
<p>Significancy level for confidence intervals. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="summary.merlin_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="summary.merlin_+3A_x">x</code></td>
<td>
<p>An object of class <code>summary.merlin</code></p>
</td></tr>
<tr><td><code id="summary.merlin_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to use when printing.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.mlrcs'>Summarizing <code>mlrcs</code> Fits</h2><span id='topic+summary.mlrcs'></span><span id='topic+print.summary.mlrcs'></span>

<h3>Description</h3>

<p>These functions are all methods for class <code>mlrcs</code> or <code>summary.mlrcs</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlrcs'
summary(object, sig = 0.95, ...)

## S3 method for class 'summary.mlrcs'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mlrcs_+3A_object">object</code></td>
<td>
<p>An object of class <code>mlrcs</code></p>
</td></tr>
<tr><td><code id="summary.mlrcs_+3A_sig">sig</code></td>
<td>
<p>Significancy level for confidence intervals. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="summary.mlrcs_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="summary.mlrcs_+3A_x">x</code></td>
<td>
<p>An object of class <code>summary.mlrcs</code></p>
</td></tr>
<tr><td><code id="summary.mlrcs_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to use when printing.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.mlsurv'>Summarizing <code>mlsurv</code> Fits</h2><span id='topic+summary.mlsurv'></span><span id='topic+print.summary.mlsurv'></span>

<h3>Description</h3>

<p>These functions are all methods for class <code>mlsurv</code> or <code>summary.mlsurv</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlsurv'
summary(object, sig = 0.95, ...)

## S3 method for class 'summary.mlsurv'
print(x, digits = max(3, getOption("digits") - 3), simplify = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mlsurv_+3A_object">object</code></td>
<td>
<p>An object of class <code>mlsurv</code></p>
</td></tr>
<tr><td><code id="summary.mlsurv_+3A_sig">sig</code></td>
<td>
<p>Significancy level for confidence intervals. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="summary.mlsurv_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
<tr><td><code id="summary.mlsurv_+3A_x">x</code></td>
<td>
<p>An object of class <code>summary.mlsurv</code></p>
</td></tr>
<tr><td><code id="summary.mlsurv_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="summary.mlsurv_+3A_simplify">simplify</code></td>
<td>
<p>Should non-interpretable coefficients be hidden (e.g. splines and flexible polynomials terms)? Defaults to TRUE.</p>
</td></tr>
</table>

<hr>
<h2 id='vcov.merlin'>Calculate Variance-Covariance Matrix for a <code>merlin</code> Model Object</h2><span id='topic+vcov.merlin'></span><span id='topic+vcov.summary.merlin'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of all estimated parameters of a fitted <code>merlin</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merlin'
vcov(object, ...)

## S3 method for class 'summary.merlin'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.merlin_+3A_object">object</code></td>
<td>
<p>An object of class <code>merlin</code> or <code>summary.merlin</code>.</p>
</td></tr>
<tr><td><code id="vcov.merlin_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

<hr>
<h2 id='vcov.mlrcs'>Calculate Variance-Covariance Matrix for a <code>mlrcs</code> Model Object</h2><span id='topic+vcov.mlrcs'></span><span id='topic+vcov.summary.mlrcs'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of all estimated parameters of a fitted <code>mlrcs</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlrcs'
vcov(object, ...)

## S3 method for class 'summary.mlrcs'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.mlrcs_+3A_object">object</code></td>
<td>
<p>An object of class <code>mlrcs</code> or <code>summary.mlrcs</code>.</p>
</td></tr>
<tr><td><code id="vcov.mlrcs_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

<hr>
<h2 id='vcov.mlsurv'>Calculate Variance-Covariance Matrix for a <code>mlsurv</code> Model Object</h2><span id='topic+vcov.mlsurv'></span><span id='topic+vcov.summary.mlsurv'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of all estimated parameters of a fitted <code>mlsurv</code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlsurv'
vcov(object, ...)

## S3 method for class 'summary.mlsurv'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.mlsurv_+3A_object">object</code></td>
<td>
<p>An object of class <code>mlsurv</code> or <code>summary.mlsurv</code>.</p>
</td></tr>
<tr><td><code id="vcov.mlsurv_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
