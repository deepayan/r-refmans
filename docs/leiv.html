<!DOCTYPE html><html lang="en"><head><title>Help for package leiv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {leiv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#leiv'><p>Bivariate Linear Errors-In-Variables Estimation</p></a></li>
<li><a href='#leiv-internal'><p>Probability Density Utilities</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>2.0-7</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bivariate Linear Errors-In-Variables Estimation</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-01-11</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Leonard &lt;davidsleonard@outlook.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.9.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, graphics</td>
</tr>
<tr>
<td>Suggests:</td>
<td>grDevices</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate the slope and intercept of a bivariate
	linear relationship by calculating a posterior density
	that is invariant to interchange and scaling of the
	coordinates.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.r-project.org">http://www.r-project.org</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-01-11 14:47:41 UTC; macuser</td>
</tr>
<tr>
<td>Author:</td>
<td>David Leonard [aut, cre]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-01-11 16:53:08</td>
</tr>
</table>
<hr>
<h2 id='leiv'>Bivariate Linear Errors-In-Variables Estimation</h2><span id='topic+leiv'></span><span id='topic+leiv-class'></span><span id='topic+leiv-package'></span><span id='topic+print-methods'></span><span id='topic+print+2CANY-method'></span><span id='topic+print+2Cleiv-method'></span><span id='topic+plot-methods'></span><span id='topic+plot+2CANY+2CANY-method'></span><span id='topic+plot+2Cleiv+2Cmissing-method'></span>

<h3>Description</h3>

<p>Generates a linear errors-in-variables object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leiv(formula, data, subset, prior = NULL,
      n = NULL, cor = NULL, sdRatio = NULL, xMean = 0, yMean = 0,
      probIntCalc = FALSE, level = 0.95, subdivisions = 100,
      rel.tol = .Machine$double.eps^0.25, abs.tol = 0.1*rel.tol, ...)

## S4 method for signature 'leiv'
print(x, digits = max(3, getOption("digits") - 3), ...)
## S4 method for signature 'leiv,missing'
plot(x, plotType = "density", xlim = NULL, ylim = NULL,
     xlab = NULL, ylab = NULL, col = NULL, lwd = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="leiv_+3A_formula">formula</code></td>
<td>
<p>an optional object of class <code>"<a href="stats.html#topic+formula">formula</a>"</code> (or one that can be coerced to that class): a symbolic description of the model to be fitted.  The details of model specification are given in the &lsquo;Details&rsquo; section of the documentation for <code><a href="stats.html#topic+lm">lm</a></code>.  An intercept is always included and integrated out as a nuisance parameter: <code>y ~ x</code>, <code>y ~ 0 + x</code>, and <code>y ~ x - 1</code> are equivalent.  If not provided, the sufficient statistics <code>n</code>, <code>cor</code>, and <code>sdRatio</code> must be provided.</p>
</td></tr>
<tr><td><code id="leiv_+3A_data">data</code></td>
<td>
<p>an optional data frame (or object coercible by <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> to a data frame) containing the variables in the model.  If not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>, typically the environment from which <code>leiv</code> is called.</p>
</td></tr>
<tr><td><code id="leiv_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="leiv_+3A_prior">prior</code></td>
<td>
<p>an optional object of class <code>leiv</code> to use as the prior density of the scale invariant slope; otherwise the rotationally invariant Cauchy density is used.</p>
</td></tr>
<tr><td><code id="leiv_+3A_n">n</code></td>
<td>
<p>an optional sample size (if <code>formula</code> is missing).</p>
</td></tr>
<tr><td><code id="leiv_+3A_cor">cor</code>, <code id="leiv_+3A_sdratio">sdRatio</code></td>
<td>
<p>optional sample correlation <code>cor(x,y)</code> and ratio <code>sd(y)/sd(x)</code> (if <code>formula</code> is missing).</p>
</td></tr>
<tr><td><code id="leiv_+3A_xmean">xMean</code>, <code id="leiv_+3A_ymean">yMean</code></td>
<td>
<p>optional sample means <code>mean(x)</code> and <code>mean(y)</code> (if <code>formula</code> is missing).</p>
</td></tr>
<tr><td><code id="leiv_+3A_probintcalc">probIntCalc</code></td>
<td>
<p>logical; if <code>TRUE</code> returns the shortest (100*<code>level</code>)% probability intervals; if <code>FALSE</code> (the default) no probability intervals are returned.</p>
</td></tr>
<tr><td><code id="leiv_+3A_level">level</code></td>
<td>
<p>the probability level requested (if <code>probIntCalc = TRUE</code>).</p>
</td></tr>
<tr><td><code id="leiv_+3A_subdivisions">subdivisions</code></td>
<td>
<p>the maximum number of subintervals (see <code><a href="stats.html#topic+integrate">integrate</a></code>).</p>
</td></tr>
<tr><td><code id="leiv_+3A_rel.tol">rel.tol</code></td>
<td>
<p>the relative accuracy requested (see <code><a href="stats.html#topic+integrate">integrate</a></code>).</p>
</td></tr>
<tr><td><code id="leiv_+3A_abs.tol">abs.tol</code></td>
<td>
<p>the absolute accuracy requested (see <code><a href="stats.html#topic+integrate">integrate</a></code>).</p>
</td></tr>
<tr><td><code id="leiv_+3A_x">x</code></td>
<td>
<p>a <code>leiv</code> object.</p>
</td></tr>
<tr><td><code id="leiv_+3A_digits">digits</code></td>
<td>
<p>controls formating of <a href="base.html#topic+numeric">numeric</a> objects.</p>
</td></tr>
<tr><td><code id="leiv_+3A_plottype">plotType</code></td>
<td>
<p>specifies the type of plot; if <code>plotType = "density"</code> (the default) then the posterior density of the slope is plotted; if <code>plotType = "scatter"</code> then a scatter plot with the fitted line.</p>
</td></tr>
<tr><td><code id="leiv_+3A_xlim">xlim</code>, <code id="leiv_+3A_ylim">ylim</code></td>
<td>
<p><var>x</var> limits <code>c(x1,x2)</code> and <var>y</var> limits <code>c(y1,y2)</code> of the plot.</p>
</td></tr>
<tr><td><code id="leiv_+3A_xlab">xlab</code>, <code id="leiv_+3A_ylab">ylab</code></td>
<td>
<p>labels for the <var>x</var> and <var>y</var> axes of the plot.</p>
</td></tr>
<tr><td><code id="leiv_+3A_col">col</code>, <code id="leiv_+3A_lwd">lwd</code></td>
<td>
<p>color and width of plotted lines.</p>
</td></tr>
<tr><td><code id="leiv_+3A_...">...</code></td>
<td>
<p>additional argument(s) for generic methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use <code>leiv</code> to estimate the slope and intercept of a bivariate linear relationship when both variables are observed with error.  The method is exact when the true values and the errors are normally distributed.  The posterior density depends on the data only through the correlation coefficient and ratio of standard deviations; it is invariant to interchange and scaling of the coordinates.
</p>


<h3>Value</h3>

<p><code>leiv</code> returns an object of class <code>"leiv"</code> with the following components:
</p>
<table role = "presentation">
<tr><td><code>slope</code></td>
<td>
<p>the (posterior median) slope estimate.</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p>the (maximum likelihood) intercept estimate.</p>
</td></tr>
<tr><td><code>slopeInt</code></td>
<td>
<p>the shortest (100*<code>level</code>)% probability interval of the slope.</p>
</td></tr>
<tr><td><code>interceptInt</code></td>
<td>
<p>the shortest (100*<code>level</code>)% probability interval of the intercept.</p>
</td></tr>
<tr><td><code>density</code></td>
<td>
<p>the posterior probability density function.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of (<var>x</var>,<var>y</var>) pairs.</p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p>the sample correlation <code>cor(x,y)</code>.</p>
</td></tr>
<tr><td><code>sdRatio</code></td>
<td>
<p>the ratio <code>sd(y)/sd(x)</code>.</p>
</td></tr>
<tr><td><code>xMean</code></td>
<td>
<p>the sample mean <code>mean(x)</code>.</p>
</td></tr>
<tr><td><code>yMean</code></td>
<td>
<p>the sample mean <code>mean(y)</code>.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>probIntCalc</code></td>
<td>
<p>the logical probability interval request.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>the probability level of the probability interval.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the <var>x</var> data.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the <var>y</var> data.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Numerical integration is used to normalize the posterior density.  When the data is nearly linear, normalization using the default tolerance parameters may fail.  Specifying <code>abs.tol = 1e-6</code> (or smaller) may help, but expect a longer run time.  In general, <code>rel.tol</code> cannot be less than <code>max(50*.Machine$double.eps, 0.5e-28)</code> if <code>abs.tol &lt;= 0</code>.  In addition, when using a sharply peaked <code>leiv</code> object as a prior density, normalization may fail.  In this case, an alternative is to first fit using the default Cauchy prior, then multiply by the appropriate ratio of prior densities and tackle the normalization outside of the <code>leiv</code> environment.
</p>


<h3>Author(s)</h3>

<p>David Leonard</p>


<h3>References</h3>

<p>Leonard, David. (2011). &ldquo;Estimating a Bivariate Linear Relationship.&rdquo; <em>Bayesian Analysis</em>, 6:727-754. DOI:10.1214/11-BA627.
</p>
<p>Zellner, Arnold. (1971). <em>An Introduction to Bayesian Inference in Econometrics</em>, Chapter 5. John Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code> for formula syntax; <code><a href="stats.html#topic+integrate">integrate</a></code> for control parameters.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate artificial data 
set.seed(1123)
n &lt;- 20
X &lt;- rnorm(n, mean=5, sd=4) # true x
x &lt;- X + rnorm(n, mean=0, sd=5) # observed x
Y &lt;- 2 + X # true y
y &lt;- Y + rnorm(n, mean=0, sd=3) # observed y

## fit with default options
fit &lt;- leiv(y ~ x)
print(fit)
plot(fit) # density plot
dev.new()
plot(fit,plotType="scatter")

## calculate a density to use as an informative prior density of
## the scale invariant slope in a subsequent fit
fit0 &lt;- leiv(n=10, cor=0.5, sdRatio=1.0)
print(fit0)

## refit the data using the informative prior density
fit1 &lt;- leiv(y ~ x, prior=fit0, abs.tol=1e-6)
print(fit1)
</code></pre>

<hr>
<h2 id='leiv-internal'>Probability Density Utilities</h2><span id='topic+p50'></span><span id='topic+probInt'></span>

<h3>Description</h3>

<p><code>p50</code> calculates the median of the <code><a href="#topic+leiv">leiv</a></code> posterior probability density.  <code>probInt</code> calculates the shortest probability interval of the <code><a href="#topic+leiv">leiv</a></code> posterior probability density for a given probability level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p50(p, interval, subdivisions = 100,
      rel.tol = .Machine$double.eps^0.25,
      abs.tol = rel.tol)

probInt(p, interval, level, subdivisions = 100,
      rel.tol = .Machine$double.eps^0.25,
      abs.tol = rel.tol)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="leiv-internal_+3A_p">p</code></td>
<td>
<p>a normalized probability density function.</p>
</td></tr>
<tr><td><code id="leiv-internal_+3A_interval">interval</code></td>
<td>
<p>a vector containing the endpoints of the interval to be searched.</p>
</td></tr>
<tr><td><code id="leiv-internal_+3A_level">level</code></td>
<td>
<p>the probability level requested.</p>
</td></tr>
<tr><td><code id="leiv-internal_+3A_subdivisions">subdivisions</code></td>
<td>
<p>the maximum number of subintervals (see <code><a href="stats.html#topic+integrate">integrate</a></code>).</p>
</td></tr>
<tr><td><code id="leiv-internal_+3A_rel.tol">rel.tol</code></td>
<td>
<p>the relative accuracy requested (see <code><a href="stats.html#topic+integrate">integrate</a></code>).</p>
</td></tr>
<tr><td><code id="leiv-internal_+3A_abs.tol">abs.tol</code></td>
<td>
<p>the absolute accuracy requested (see <code><a href="stats.html#topic+integrate">integrate</a></code>, <code><a href="stats.html#topic+optimize">optimize</a></code> and <code><a href="stats.html#topic+uniroot">uniroot</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internal functions for integrating the posterior density returned by the function <code><a href="#topic+leiv">leiv</a></code>.  These functions are not meant to be called by the user.
</p>


<h3>Value</h3>

<p><code>p50</code> returns a numeric scalar. <code>probInt</code> returns a 2-dimensional numeric vector of interval endpoints.
</p>


<h3>Note</h3>

<p><code>p</code> must accept a vector of inputs and produce a vector of function evaluations at those points.
<code>rel.tol</code> cannot be less than <code>max(50*.Machine$double.eps, 0.5e-28)</code> if <code>abs.tol &lt;= 0</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+leiv">leiv</a></code> for general information; <code><a href="stats.html#topic+integrate">integrate</a></code> for control parameters.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
