<!DOCTYPE html><html><head><title>Help for package cranlike</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cranlike}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cranlike'><p>Tools for CRAN-like Repositories</p></a></li>
<li><a href='#add_PACKAGES'><p>Add R packages to the package database</p></a></li>
<li><a href='#create_empty_PACKAGES'><p>Create an empty package database</p></a></li>
<li><a href='#package_versions'><p>List all packages and versions in a CRAN-like repository</p></a></li>
<li><a href='#remove_PACKAGES'><p>Remove package from a package database</p></a></li>
<li><a href='#update_PACKAGES'><p>Create or update PACKAGES* files for a CRAN-like repository</p></a></li>
<li><a href='#with_db'><p>Perform a DB query, without explicit locking</p></a></li>
<li><a href='#with_db_lock'><p>Perform a DB query, with locking</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Tools for 'CRAN'-Like Repositories</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Author:</td>
<td>G치bor Cs치rdi</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>G치bor Cs치rdi &lt;csardi.gabor@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of functions to manage 'CRAN'-like repositories
    efficiently.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/r-hub/cranlike">https://github.com/r-hub/cranlike</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/r-hub/cranlike/issues">https://github.com/r-hub/cranlike/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>DBI, debugme, desc (&ge; 1.1.0), RSQLite, tools, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, mockery, testthat, withr, zip</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-24 20:51:36 UTC; gaborcsardi</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-24 21:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cranlike'>Tools for CRAN-like Repositories</h2><span id='topic+cranlike-package'></span><span id='topic+cranlike'></span>

<h3>Description</h3>

<p>A set of functions to manage CRAN-like repositories efficiently.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/r-hub/cranlike">https://github.com/r-hub/cranlike</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/r-hub/cranlike/issues">https://github.com/r-hub/cranlike/issues</a>
</p>
</li></ul>


<hr>
<h2 id='add_PACKAGES'>Add R packages to the package database</h2><span id='topic+add_PACKAGES'></span>

<h3>Description</h3>

<p>The files must exist in the directory. If the package database does
not exist, then it will be created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_PACKAGES(files, dir = ".", fields = NULL, xcolumns = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_PACKAGES_+3A_files">files</code></td>
<td>
<p>Files to add, only the file names, without the path.
You can use <code><a href="base.html#topic+basename">base::basename()</a></code> to chop off the path.</p>
</td></tr>
<tr><td><code id="add_PACKAGES_+3A_dir">dir</code></td>
<td>
<p>Package directory.</p>
</td></tr>
<tr><td><code id="add_PACKAGES_+3A_fields">fields</code></td>
<td>
<p>Fields to use in the database if the database is
created.</p>
</td></tr>
<tr><td><code id="add_PACKAGES_+3A_xcolumns">xcolumns</code></td>
<td>
<p>Extra scalar columns to add to the database.
Should be a named list of character scalars or <code>NULL</code> for no extra
columns.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other PACKAGES manipulation: 
<code><a href="#topic+remove_PACKAGES">remove_PACKAGES</a>()</code>,
<code><a href="#topic+update_PACKAGES">update_PACKAGES</a>()</code>
</p>

<hr>
<h2 id='create_empty_PACKAGES'>Create an empty package database</h2><span id='topic+create_empty_PACKAGES'></span>

<h3>Description</h3>

<p>Create an empty package database if it does not exist.
It also updates the PACKAGES* files from the new (empty) database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_empty_PACKAGES(dir = ".", fields = NULL, xcolumns = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_empty_PACKAGES_+3A_dir">dir</code></td>
<td>
<p>Character vector describing the location of the repository
(directory including source or binary packages) to generate the
&lsquo;<span class="file">PACKAGES</span>&rsquo;, &lsquo;<span class="file">PACKAGES.gz</span>&rsquo; and &lsquo;<span class="file">PACKAGES.rds</span>&rsquo; files
from and write them to.
</p>
</td></tr>
<tr><td><code id="create_empty_PACKAGES_+3A_fields">fields</code></td>
<td>

<p>a character vector giving the fields to be used in the
&lsquo;<span class="file">PACKAGES</span>&rsquo;, &lsquo;<span class="file">PACKAGES.gz</span>&rsquo; and &lsquo;<span class="file">PACKAGES.rds</span>&rsquo; files in
addition to the default ones, or <code>NULL</code> (default).
</p>
<p>The default corresponds to
the fields needed by <code><a href="utils.html#topic+available.packages">available.packages</a></code>:
<code>"Package"</code>, <code>"Version"</code>, <code>"Priority"</code>,
<code>"Depends"</code>, <code>"Imports"</code>, <code>"LinkingTo"</code>,
<code>"Suggests"</code>, <code>"Enhances"</code>, <code>"OS_type"</code>,
<code>"License"</code> and <code>"Archs"</code>, and those fields will always
be included, plus
the file name in field <code>"File"</code> if <code>addFile = TRUE</code>
and the path to the subdirectory in field <code>"Path"</code> if subdirectories
are used.
</p>
</td></tr>
<tr><td><code id="create_empty_PACKAGES_+3A_xcolumns">xcolumns</code></td>
<td>
<p>Extra scalar columns to add to the database.
Should be a named list of character scalars or <code>NULL</code> for no extra
columns.</p>
</td></tr>
</table>

<hr>
<h2 id='package_versions'>List all packages and versions in a CRAN-like repository</h2><span id='topic+package_versions'></span>

<h3>Description</h3>

<p>List all packages and versions in a CRAN-like repository
</p>


<h3>Usage</h3>

<pre><code class='language-R'>package_versions(dir = ".", xcolumns = character())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="package_versions_+3A_dir">dir</code></td>
<td>
<p>Path to the repository.</p>
</td></tr>
<tr><td><code id="package_versions_+3A_xcolumns">xcolumns</code></td>
<td>
<p>Extra columns to include in the result.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with at least three columns:
<code>Package</code>, <code>Version</code>, <code>MD5sum</code>.
</p>

<hr>
<h2 id='remove_PACKAGES'>Remove package from a package database</h2><span id='topic+remove_PACKAGES'></span>

<h3>Description</h3>

<p>The files will be first removed from the database, and then
from the directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_PACKAGES(files, dir = ".")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_PACKAGES_+3A_files">files</code></td>
<td>
<p>Files to remove. They must still exist at the time this
function is called.</p>
</td></tr>
<tr><td><code id="remove_PACKAGES_+3A_dir">dir</code></td>
<td>
<p>Package directory.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other PACKAGES manipulation: 
<code><a href="#topic+add_PACKAGES">add_PACKAGES</a>()</code>,
<code><a href="#topic+update_PACKAGES">update_PACKAGES</a>()</code>
</p>

<hr>
<h2 id='update_PACKAGES'>Create or update PACKAGES* files for a CRAN-like repository</h2><span id='topic+update_PACKAGES'></span>

<h3>Description</h3>

<p>This function is similar to <code><a href="tools.html#topic+writePACKAGES">tools::write_PACKAGES()</a></code>, with some
differences:
</p>

<ul>
<li><p> It always uses the <code>MD5sum</code> field.
</p>
</li>
<li><p> It defaults to <code>addFiles = TRUE</code>, to allow following the package
files better.
</p>
</li>
<li><p> It does not support the <code>verbose</code>, <code>unpacked</code>, and <code>subdirs</code>
arguments currently.
</p>
</li>
<li><p> It uses a database to speed up the indexing process, and only
reindexes files that have added, removed or updated.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>update_PACKAGES(
  dir = ".",
  fields = NULL,
  type = c("source", "mac.binary", "win.binary"),
  xcolumns = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_PACKAGES_+3A_dir">dir</code></td>
<td>
<p>Character vector describing the location of the repository
(directory including source or binary packages) to generate the
&lsquo;<span class="file">PACKAGES</span>&rsquo;, &lsquo;<span class="file">PACKAGES.gz</span>&rsquo; and &lsquo;<span class="file">PACKAGES.rds</span>&rsquo; files
from and write them to.
</p>
</td></tr>
<tr><td><code id="update_PACKAGES_+3A_fields">fields</code></td>
<td>

<p>a character vector giving the fields to be used in the
&lsquo;<span class="file">PACKAGES</span>&rsquo;, &lsquo;<span class="file">PACKAGES.gz</span>&rsquo; and &lsquo;<span class="file">PACKAGES.rds</span>&rsquo; files in
addition to the default ones, or <code>NULL</code> (default).
</p>
<p>The default corresponds to
the fields needed by <code><a href="utils.html#topic+available.packages">available.packages</a></code>:
<code>"Package"</code>, <code>"Version"</code>, <code>"Priority"</code>,
<code>"Depends"</code>, <code>"Imports"</code>, <code>"LinkingTo"</code>,
<code>"Suggests"</code>, <code>"Enhances"</code>, <code>"OS_type"</code>,
<code>"License"</code> and <code>"Archs"</code>, and those fields will always
be included, plus
the file name in field <code>"File"</code> if <code>addFile = TRUE</code>
and the path to the subdirectory in field <code>"Path"</code> if subdirectories
are used.
</p>
</td></tr>
<tr><td><code id="update_PACKAGES_+3A_type">type</code></td>
<td>

<p>Type of packages: currently source &lsquo;<span class="file">.tar.{gz,bz2,xz}</span>&rsquo; archives,
and macOS or Windows binary (&lsquo;<span class="file">.tgz</span>&rsquo; or &lsquo;<span class="file">.zip</span>&rsquo;,
respectively) packages are supported.  Defaults to
<code>"win.binary"</code> on Windows and to <code>"source"</code> otherwise.
</p>
</td></tr>
<tr><td><code id="update_PACKAGES_+3A_xcolumns">xcolumns</code></td>
<td>
<p>Extra scalar columns to add to the database.
Should be a named list of character scalars or <code>NULL</code> for no extra
columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>update_PACKAGES</code> uses a SQLite database to aid updating PACKAGES*
files quickly. It this database does not exist, then it will be created
based on the existing PACKAGES* files. If no PACKAGES* files exist,
either, then these will be created via <code>tools::write_PACKAGES()</code>.
</p>


<h3>See Also</h3>

<p>Other PACKAGES manipulation: 
<code><a href="#topic+add_PACKAGES">add_PACKAGES</a>()</code>,
<code><a href="#topic+remove_PACKAGES">remove_PACKAGES</a>()</code>
</p>

<hr>
<h2 id='with_db'>Perform a DB query, without explicit locking</h2><span id='topic+with_db'></span>

<h3>Description</h3>

<p>This is for read operations. They can also be called from
within a transaction. In this case the database handle will
be reused.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>with_db(db_file, expr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="with_db_+3A_db_file">db_file</code></td>
<td>
<p>File of the DB.</p>
</td></tr>
<tr><td><code id="with_db_+3A_expr">expr</code></td>
<td>
<p>Expression to evaluate, it can refer to the connection
handle as <code>db</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='with_db_lock'>Perform a DB query, with locking</h2><span id='topic+with_db_lock'></span>

<h3>Description</h3>

<p>This creates a transaction, and an exclusive lock.
It always creates a new DB connection, and closes it on exit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>with_db_lock(db_file, expr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="with_db_lock_+3A_db_file">db_file</code></td>
<td>
<p>File of the DB.</p>
</td></tr>
<tr><td><code id="with_db_lock_+3A_expr">expr</code></td>
<td>
<p>Expression to evaluate, it can refer to the connection
handle as <code>db</code>.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
