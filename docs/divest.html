<!DOCTYPE html><html lang="en"><head><title>Help for package divest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {divest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#divest.capabilities'><p>Report package capabilities</p></a></li>
<li><a href='#readDicom'><p>Read one or more DICOM directories</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-03-04</td>
</tr>
<tr>
<td>Title:</td>
<td>Get Images Out of DICOM Format Quickly</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jon Clayden &lt;code@clayden.org&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, RNifti (&ge; 1.8.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RNifti</td>
</tr>
<tr>
<td>Suggests:</td>
<td>jsonlite, tinytest, covr</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools to sort DICOM-format medical image files, and
    convert them to NIfTI-1 format.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-3-Clause">BSD_3_clause</a> + file LICENCE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jonclayden/divest">https://github.com/jonclayden/divest</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jonclayden/divest/issues">https://github.com/jonclayden/divest/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-05 18:14:03 UTC; jon</td>
</tr>
<tr>
<td>Author:</td>
<td>Jon Clayden <a href="https://orcid.org/0000-0002-6608-0619"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Chris Rorden [aut],
  Martin J Fiedler [cph],
  Cong Xu [cph],
  Pascal Gloor [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-05 18:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='divest.capabilities'>Report package capabilities</h2><span id='topic+divest.capabilities'></span>

<h3>Description</h3>

<p>This function summarises the capabilities of the package as compiled for the
current machine, analogously to the <code>base</code> function <code><a href="base.html#topic+capabilities">capabilities()</a></code>. It
identifies the support available for various input and output formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>divest.capabilities(what = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="divest.capabilities_+3A_what">what</code></td>
<td>
<p>A character vector of components to extract, or <code>NULL</code>,
the default, which indicates the full set of capabilities.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named logical vector, indicating whether plain JPEG, JPEG-LS and
JPEG2000 DICOM transfer syntaxes are supported by the current build of the
package, and also whether <code>zlib</code> is available to produce compressed NIfTI
output files from <code><a href="#topic+convertDicom">convertDicom()</a></code>.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden <a href="mailto:code@clayden.org">code@clayden.org</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readDicom">readDicom()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>divest.capabilities()
</code></pre>

<hr>
<h2 id='readDicom'>Read one or more DICOM directories</h2><span id='topic+readDicom'></span><span id='topic+convertDicom'></span><span id='topic+sortDicom'></span><span id='topic+scanDicom'></span>

<h3>Description</h3>

<p>These functions are R wrappers around the DICOM-to-NIfTI conversion routines
provided by <code>dcm2niix</code>. They scan directories containing DICOM files,
potentially pertaining to more than one image series, read them and/or merge
them into a list of <code>niftiImage</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readDicom(path = ".", subset = NULL, flipY = TRUE, crop = FALSE,
  forceStack = FALSE, verbosity = 0L, labelFormat = "T%t_N%n_S%s",
  depth = 5L, interactive = base::interactive(), output = NULL)

convertDicom(path = ".", subset = NULL, flipY = TRUE, crop = FALSE,
  forceStack = FALSE, verbosity = 0L, labelFormat = "T%t_N%n_S%s",
  depth = 5L, interactive = base::interactive(), output = path)

sortDicom(path = ".", forceStack = FALSE, verbosity = 0L,
  labelFormat = "T%t_N%n_S%s/%b", depth = 5L, nested = NA,
  keepUnsorted = FALSE, output = path)

scanDicom(path = ".", forceStack = FALSE, verbosity = 0L,
  labelFormat = "T%t_N%n_S%s", depth = 5L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readDicom_+3A_path">path</code></td>
<td>
<p>A character vector of paths to scan for DICOM files. Each will
examined in turn. The default is the current working directory.
<code>readDicom</code> (only) will accept paths to individual DICOM files,
rather than directories. Alternatively, for <code>readDicom</code> and
<code>sortDicom</code>, a data frame like the one returned by <code>scanDicom</code>,
from which file paths will be read.</p>
</td></tr>
<tr><td><code id="readDicom_+3A_subset">subset</code></td>
<td>
<p>If <code>path</code> is a data frame, an expression which will be
evaluated in the context of the data frame to determine which series to
convert. Should evaluate to a logical vector. If <code>path</code> is a
character vector, <code>scanDicom</code> is called on the path(s) first to
produce the data frame. If this is specified, and does not evaluate to
<code>NULL</code>, the read will be noninteractive, irrespective of the value of
the <code>interactive</code> argument.</p>
</td></tr>
<tr><td><code id="readDicom_+3A_flipy">flipY</code></td>
<td>
<p>If <code>TRUE</code>, the default, then images will be flipped in the
Y-axis. This is usually desirable, given the difference between
orientation conventions in the DICOM and NIfTI-1 formats.</p>
</td></tr>
<tr><td><code id="readDicom_+3A_crop">crop</code></td>
<td>
<p>If <code>TRUE</code>, then <code>dcm2niix</code> will attempt to crop excess
neck slices from brain images.</p>
</td></tr>
<tr><td><code id="readDicom_+3A_forcestack">forceStack</code></td>
<td>
<p>If <code>TRUE</code>, images with the same series number will
always be stacked together as long as their dimensions are compatible. If
<code>FALSE</code>, the default, images will be separated if they differ in
echo, coil or exposure number, echo time, protocol name or orientation.</p>
</td></tr>
<tr><td><code id="readDicom_+3A_verbosity">verbosity</code></td>
<td>
<p>Integer value between -2 and 3, controlling the amount of
output generated during the conversion. A value of -1 will suppress all
output from <code>dcm2niix</code> except warnings and errors; -2 also suppresses
warnings.</p>
</td></tr>
<tr><td><code id="readDicom_+3A_labelformat">labelFormat</code></td>
<td>
<p>A <code><a href="base.html#topic+sprintf">sprintf</a></code>-style string specifying the
format to use for the final image labels or paths. See Details.</p>
</td></tr>
<tr><td><code id="readDicom_+3A_depth">depth</code></td>
<td>
<p>The maximum subdirectory depth in which to search for DICOM
files, relative to each <code>path</code>.</p>
</td></tr>
<tr><td><code id="readDicom_+3A_interactive">interactive</code></td>
<td>
<p>If <code>TRUE</code>, the default in interactive sessions, the
requested paths will first be scanned and a list of DICOM series will be
presented. You may then choose which series to convert.</p>
</td></tr>
<tr><td><code id="readDicom_+3A_output">output</code></td>
<td>
<p>The directory to write converted or copied NIfTI files to, or
<code>NULL</code>. In the latter case, which isn't valid for <code>sortDicom</code>,
images are converted in memory and returned as R objects.</p>
</td></tr>
<tr><td><code id="readDicom_+3A_nested">nested</code></td>
<td>
<p>For <code>sortDicom</code>, should the sorted files be created
within the source directory (<code>TRUE</code>), or in the current working
directory (<code>FALSE</code>)? Now soft-deprecated in favour of <code>output</code>,
which is more flexible.</p>
</td></tr>
<tr><td><code id="readDicom_+3A_keepunsorted">keepUnsorted</code></td>
<td>
<p>For <code>sortDicom</code>, should the unsorted files be left
in place, or removed after they are copied into their new locations? The
default, <code>FALSE</code>, corresponds to a move rather than a copy. If
creating new files fails then the old ones will not be deleted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>scanDicom</code> function parses directories full of DICOM files and
returns information about the acquisition series they contain.
<code>readDicom</code> reads these files and converts them to (internal) NIfTI
images (whose pixel data can be extracted using <code>as.array</code>).
<code>convertDicom</code> performs the same conversion but writes to NIfTI files
by default, instead of retaining the images in memory. <code>sortDicom</code>
renames the files, but does not convert them.
</p>
<p>The <code>labelFormat</code> argument describes the string format used for image
labels and sorted files. Valid codes, each escaped with a percentage sign,
include <code>a</code> for coil number, <code>b</code> for the source file base name,
<code>c</code> for image comments, <code>d</code> for series description, <code>e</code> for
echo number, <code>f</code> for the source directory, <code>i</code> for patient ID,
<code>j</code> for the series instance UID, <code>k</code> for the study instance UID,
<code>l</code> for the procedure step description, <code>m</code> for manufacturer,
<code>n</code> for patient name, <code>p</code> for protocol name, <code>q</code> for
scanning sequence, <code>r</code> for instance number, <code>s</code> for series number,
<code>t</code> for the date and time, <code>u</code> for acquisition number, <code>v</code>
for vendor, <code>x</code> for study ID and <code>z</code> for sequence name. For
<code>sortDicom</code> the label forms the new file path, and may include one or
more slashes to create subdirectories. A &quot;.dcm&quot; suffix will be added to file
names if no extension is specified.
</p>


<h3>Value</h3>

<p><code>readDicom</code> and <code>convertDicom</code> return a list of
<code>niftiImage</code> objects if <code>output</code> is <code>NULL</code>; otherwise
(invisibly) a vector of paths to NIfTI-1 files created in the target
directory. Returned images typically have attributes containing additional
metadata extracted from the DICOM headers, either in a JSON string or (if
the <code>jsonlite</code> package is available), in individually parsed
elements. The <code>scanDicom</code> function returns a data frame containing
information about each DICOM series found. <code>sortDicom</code> is mostly
called for its side-effect, but also (invisibly) returns a list detailing
source and target paths.
</p>


<h3>Author(s)</h3>

<p>Jon Clayden <a href="mailto:code@clayden.org">code@clayden.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- system.file("extdata", "raw", package="divest")
scanDicom(path)
readDicom(path, interactive=FALSE)
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+imageAttributes'></span><span id='topic+imageAttributes+3C-'></span><span id='topic+fromBidsJson'></span><span id='topic+toBidsJson'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>RNifti</dt><dd><p><code><a href="RNifti.html#topic+bidsJson">fromBidsJson</a></code>, <code><a href="RNifti.html#topic+imageAttributes">imageAttributes</a></code>, <code><a href="RNifti.html#topic+imageAttributes">imageAttributes&lt;-</a></code>, <code><a href="RNifti.html#topic+bidsJson">toBidsJson</a></code></p>
</dd>
</dl>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
