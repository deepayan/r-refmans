<!DOCTYPE html><html lang="en"><head><title>Help for package ivreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ivreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CigaretteDemand'><p>U.S. Cigarette Demand Data</p></a></li>
<li><a href='#coef.ivreg'><p>Methods for <code>"ivreg"</code> Objects</p></a></li>
<li><a href='#confint.ivreg'><p>Summary and Inference Methods for <code>"ivreg"</code> Objects</p></a></li>
<li><a href='#influence.ivreg'><p>Deletion and Other Diagnostic Methods for <code>"ivreg"</code> Objects</p></a></li>
<li><a href='#ivreg'><p>Instrumental-Variable Regression by 2SLS, 2SM, or 2SMM Estimation</p></a></li>
<li><a href='#ivreg.fit'><p>Fitting Instrumental-Variable Regressions by 2SLS, 2SM, or 2SMM Estimation</p></a></li>
<li><a href='#Kmenta'><p>Partly Artificial Data on the U.S. Economy</p></a></li>
<li><a href='#SchoolingReturns'><p>U.S. Returns to Schooling Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Instrumental-Variables Regression by '2SLS', '2SM', or '2SMM',
with Diagnostics</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6-5</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-19</td>
</tr>
<tr>
<td>Description:</td>
<td>Instrumental variable estimation for linear models by two-stage least-squares (2SLS) regression or by robust-regression via M-estimation (2SM) or MM-estimation (2SMM). The main ivreg() model-fitting function is designed to provide a workflow as similar as possible to standard lm() regression. A wide range of methods is provided for fitted ivreg model objects, including extensive functionality for computing and graphing regression diagnostics in addition to other standard model tools.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>car (&ge; 3.0-9), Formula, lmtest, MASS, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>AER, effects (&ge; 4.2.0), knitr, insight, parallel, rmarkdown,
sandwich, testthat, modelsummary, gt, ggplot2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/zeileis/ivreg/issues/">https://github.com/zeileis/ivreg/issues/</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://zeileis.github.io/ivreg/">https://zeileis.github.io/ivreg/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-19 09:14:58 UTC; zeileis</td>
</tr>
<tr>
<td>Author:</td>
<td>John Fox <a href="https://orcid.org/0000-0002-1196-8012"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Christian Kleiber <a href="https://orcid.org/0000-0002-6781-4733"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Achim Zeileis <a href="https://orcid.org/0000-0003-0918-3766"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Nikolas Kuschnig <a href="https://orcid.org/0000-0002-6642-2543"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  R Core Team [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Achim Zeileis &lt;Achim.Zeileis@R-project.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-19 10:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CigaretteDemand'>U.S. Cigarette Demand Data</h2><span id='topic+CigaretteDemand'></span>

<h3>Description</h3>

<p>Determinants of cigarette demand for the 48 continental US States in 1995 and
compared between 1995 and 1985.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CigaretteDemand", package = "ivreg")
</code></pre>


<h3>Format</h3>

<p>A data frame with 48 rows and 10 columns.
</p>

<dl>
<dt>packs</dt><dd><p>Number of cigarette packs per capita sold in 1995.</p>
</dd>
<dt>rprice</dt><dd><p>Real price in 1995 (including sales tax).</p>
</dd>
<dt>rincome</dt><dd><p>Real per capita income in 1995.</p>
</dd>
<dt>salestax</dt><dd><p>Sales tax in 1995.</p>
</dd>
<dt>cigtax</dt><dd><p>Cigarette-specific taxes (federal and average local excise taxes) in 1995.</p>
</dd>
<dt>packsdiff</dt><dd><p>Difference in <code>log(packs)</code> (between 1995 and 1985).</p>
</dd>
<dt>pricediff</dt><dd><p>Difference in <code>log(rprice)</code> (between 1995 and 1985).</p>
</dd>
<dt>incomediff</dt><dd><p>Difference in <code>log(rincome)</code> (between 1995 and 1985).</p>
</dd>
<dt>salestaxdiff</dt><dd><p>Difference in <code>salestax</code> (between 1995 and 1985).</p>
</dd>
<dt>cigtaxdiff</dt><dd><p>Difference in <code>cigtax</code> (between 1995 and 1985).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are taken from the online complements to Stock and Watson (2007) and
had been prepared as panel data (in long form) in <code><a href="AER.html#topic+CigarettesSW">CigarettesSW</a></code>
from the AER package (Kleiber and Zeileis 2008). Here, the data are provided by
state (in wide form), readily preprocessed to contain all variables needed for
illustrations of OLS and IV regressions. More related examples from Stock and
Watson (2007) are provided in the AER package in <code><a href="AER.html#topic+StockWatson2007">StockWatson2007</a></code>.
A detailed discussion of the various cigarette demand examples with R code
is provided by Hanck et al. (2020, Chapter 12).
</p>


<h3>Source</h3>

<p>Online complements to Stock and Watson (2007).
</p>


<h3>References</h3>

<p>Hanck, C., Arnold, M., Gerber, A., and Schmelzer, M. (2020).
<em>Introduction to Econometrics with R</em>. <a href="https://www.econometrics-with-r.org/">https://www.econometrics-with-r.org/</a>
</p>
<p>Kleiber, C. and Zeileis, A. (2008). <em>Applied Econometrics with R</em>. Springer-Verlag
</p>
<p>Stock, J.H. and Watson, M.W. (2007). <em>Introduction to Econometrics</em>, 2nd ed., Addison Wesley.
</p>


<h3>See Also</h3>

<p><code><a href="AER.html#topic+CigarettesSW">CigarettesSW</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data
data("CigaretteDemand", package = "ivreg")

## basic price elasticity: OLS vs. IV
cig_ols &lt;- lm(log(packs) ~ log(rprice), data = CigaretteDemand)
cig_iv &lt;- ivreg(log(packs) ~ log(rprice) | salestax, data = CigaretteDemand)
cbind(OLS = coef(cig_ols), IV = coef(cig_iv))

## adjusting for income differences (exogenous)
cig_iv2 &lt;- ivreg(log(packs) ~ log(rprice) + log(rincome) | salestax + log(rincome),
  data = CigaretteDemand)
## adding a second instrument for log(rprice)
cig_iv3 &lt;- update(cig_iv2, . ~ . | . + cigtax)

## comparison using heteroscedasticity-consistent standard errors
library("lmtest")
library("sandwich")
coeftest(cig_iv2, vcov = vcovHC, type = "HC1")
coeftest(cig_iv3, vcov = vcovHC, type = "HC1")

## long-run price elasticity using differences between 1995 and 1985
cig_ivdiff1 &lt;- ivreg(packsdiff ~ pricediff + incomediff | incomediff + salestaxdiff,
  data = CigaretteDemand)
cig_ivdiff2 &lt;- update(cig_ivdiff1, . ~ . | . - salestaxdiff + cigtaxdiff)
cig_ivdiff3 &lt;- update(cig_ivdiff1, . ~ . | . + cigtaxdiff)
coeftest(cig_ivdiff1, vcov = vcovHC, type = "HC1")
coeftest(cig_ivdiff2, vcov = vcovHC, type = "HC1")
coeftest(cig_ivdiff3, vcov = vcovHC, type = "HC1")
</code></pre>

<hr>
<h2 id='coef.ivreg'>Methods for <code>"ivreg"</code> Objects</h2><span id='topic+coef.ivreg'></span><span id='topic+ivregMethods'></span><span id='topic+vcov.ivreg'></span><span id='topic+bread.ivreg'></span><span id='topic+estfun.ivreg'></span><span id='topic+terms.ivreg'></span><span id='topic+model.matrix.ivreg'></span><span id='topic+predict.ivreg'></span><span id='topic+print.ivreg'></span><span id='topic+update.ivreg'></span><span id='topic+residuals.ivreg'></span><span id='topic+Effect.ivreg'></span><span id='topic+formula.ivreg'></span><span id='topic+find_formula.ivreg'></span><span id='topic+alias.ivreg'></span><span id='topic+qr.ivreg'></span><span id='topic+vcovHC.ivreg'></span><span id='topic+model.matrix.ivreg_projected'></span><span id='topic+weights.ivreg'></span>

<h3>Description</h3>

<p>Various methods for processing <code>"ivreg"</code> objects; for diagnostic methods,
see <code><a href="#topic+ivregDiagnostics">ivregDiagnostics</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ivreg'
coef(object, component = c("stage2", "stage1"), complete = TRUE, ...)

## S3 method for class 'ivreg'
vcov(object, component = c("stage2", "stage1"), complete = TRUE, ...)

## S3 method for class 'ivreg'
bread(x, ...)

## S3 method for class 'ivreg'
estfun(x, ...)

## S3 method for class 'ivreg'
vcovHC(x, ...)

## S3 method for class 'ivreg'
terms(x, component = c("regressors", "instruments", "full"), ...)

## S3 method for class 'ivreg'
model.matrix(
  object,
  component = c("regressors", "projected", "instruments"),
  ...
)

## S3 method for class 'ivreg_projected'
model.matrix(object, ...)

## S3 method for class 'ivreg'
predict(
  object,
  newdata,
  type = c("response", "terms"),
  na.action = na.pass,
  se.fit = FALSE,
  interval = c("none", "confidence", "prediction"),
  df = Inf,
  level = 0.95,
  weights,
  ...
)

## S3 method for class 'ivreg'
print(x, digits = max(3, getOption("digits") - 3), ...)

## S3 method for class 'ivreg'
update(object, formula., ..., evaluate = TRUE)

## S3 method for class 'ivreg'
residuals(
  object,
  type = c("response", "projected", "regressors", "working", "deviance", "pearson",
    "partial", "stage1"),
  ...
)

## S3 method for class 'ivreg'
Effect(focal.predictors, mod, ...)

## S3 method for class 'ivreg'
formula(x, component = c("complete", "regressors", "instruments"), ...)

## S3 method for class 'ivreg'
find_formula(x, ...)

## S3 method for class 'ivreg'
alias(object, ...)

## S3 method for class 'ivreg'
qr(x, ...)

## S3 method for class 'ivreg'
weights(object, type = c("variance", "robustness"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.ivreg_+3A_object">object</code>, <code id="coef.ivreg_+3A_model">model</code>, <code id="coef.ivreg_+3A_mod">mod</code></td>
<td>
<p>An object of class <code>"ivreg"</code>.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_component">component</code></td>
<td>
<p>For <code><a href="stats.html#topic+terms">terms</a></code>, <code>"regressors"</code>, <code>"instruments"</code>, or <code>"full"</code>; 
for <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>, <code>"projected"</code>, <code>"regressors"</code>, or <code>"instruments"</code>;
for <code><a href="stats.html#topic+formula">formula</a></code>, <code>"regressors"</code>, <code>"instruments"</code>,  or <code>"complete"</code>;
for <code><a href="stats.html#topic+coef">coef</a></code> and <code><a href="stats.html#topic+vcov">vcov</a></code>, <code>"stage2"</code> or <code>"stage1"</code>.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_complete">complete</code></td>
<td>
<p>If <code>TRUE</code>, the default, the returned coefficient vector (for <code>coef</code>) or coefficient-covariance matrix (for <code>vcov</code>) includes elements for aliased regressors.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_...">...</code></td>
<td>
<p>arguments to pass down.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_x">x</code></td>
<td>
<p>An object of class <code>"ivreg"</code>.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_newdata">newdata</code></td>
<td>
<p>Values of predictors for which to obtain predicted values; if missing
predicted (i.e., fitted) values are computed for the data to which the model was fit.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_type">type</code></td>
<td>
<p>For <code>predict</code>, one of <code>"response"</code> (the default)  or <code>"terms"</code>;
for <code>residuals</code>, one of <code>"response"</code> (the default), <code>"projected"</code>, <code>"regressors"</code>,
<code>"working"</code>, <code>"deviance"</code>, <code>"pearson"</code>, or <code>"partial"</code>; 
<code>type = "working"</code> and <code>"response"</code> are equivalent, as are 
<code>type = "deviance"</code> and <code>"pearson"</code>; for <code>weights</code>, <code>"variance"</code> (the default)
for invariance-variance weights (which is <code>NULL</code> for an unweighted fit) 
or <code>"robustness"</code> for robustness weights (available for M or MM estimation).</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_na.action">na.action</code></td>
<td>
<p><code>na</code> method to apply to predictor values for predictions; default is <code><a href="stats.html#topic+na.pass">na.pass</a></code>.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_se.fit">se.fit</code></td>
<td>
<p>Compute standard errors of predicted values (default <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_interval">interval</code></td>
<td>
<p>Type of interval to compute for predicted values: <code>"none"</code> (the default),
<code>"confidence"</code> for confidence intervals for the expected response, or <code>"prediction"</code> for
prediction intervals for future observations.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_df">df</code></td>
<td>
<p>For <code>predict</code>, degrees of freedom for computing t-distribution confidence- or prediction-interval limits; the
default, <code>Inf</code>, is equivalent to using the normal distribution; if <code>NULL</code>, 
<code>df</code> is taken from the residual degrees of freedom for the model.
These tests are not to be confused with the <em>regression diagnostics</em> provided elsewhere in the <span class="pkg">ivreg</span>
package: see <code><a href="#topic+ivregDiagnostics">ivregDiagnostics</a></code>.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_level">level</code></td>
<td>
<p>for confidence or prediction intervals, default <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_weights">weights</code></td>
<td>
<p>Either a numeric vector or a one-sided formula to provide weights for prediction
intervals when the fit is weighted. If <code>weights</code> and <code>newdata</code> are missing, the weights
are those used for fitting the model.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_digits">digits</code></td>
<td>
<p>For printing.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_formula.">formula.</code></td>
<td>
<p>To update model.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_evaluate">evaluate</code></td>
<td>
<p>If <code>TRUE</code>, the default, the updated model is evaluated; if <code>FALSE</code> the updated call is returned.</p>
</td></tr>
<tr><td><code id="coef.ivreg_+3A_focal.predictors">focal.predictors</code></td>
<td>
<p>Focal predictors for effect plot, see <code><a href="effects.html#topic+effect">Effect</a></code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+ivreg">ivreg</a></code>, <code><a href="#topic+ivreg.fit">ivreg.fit</a></code>, <code><a href="#topic+ivregDiagnostics">ivregDiagnostics</a></code>
</p>

<hr>
<h2 id='confint.ivreg'>Summary and Inference Methods for <code>"ivreg"</code> Objects</h2><span id='topic+confint.ivreg'></span><span id='topic+summary.ivreg'></span><span id='topic+print.summary.ivreg'></span><span id='topic+anova.ivreg'></span><span id='topic+Anova.ivreg'></span><span id='topic+linearHypothesis.ivreg'></span>

<h3>Description</h3>

<p>Summary method, including Wald tests and (by default) certain diagnostic tests, for
<code>"ivreg"</code> model objects, as well as other related inference functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ivreg'
confint(
  object,
  parm,
  level = 0.95,
  component = c("stage2", "stage1"),
  complete = TRUE,
  vcov. = NULL,
  df = NULL,
  ...
)

## S3 method for class 'ivreg'
summary(object, vcov. = NULL, df = NULL, diagnostics = NULL, ...)

## S3 method for class 'summary.ivreg'
print(
  x,
  digits = max(3, getOption("digits") - 3),
  signif.stars = getOption("show.signif.stars"),
  ...
)

## S3 method for class 'ivreg'
anova(object, object2, test = "F", vcov. = NULL, ...)

## S3 method for class 'ivreg'
Anova(mod, test.statistic = c("F", "Chisq"), vcov. = NULL, ...)

## S3 method for class 'ivreg'
linearHypothesis(
  model,
  hypothesis.matrix,
  rhs = NULL,
  test = c("F", "Chisq"),
  vcov. = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.ivreg_+3A_object">object</code>, <code id="confint.ivreg_+3A_object2">object2</code>, <code id="confint.ivreg_+3A_model">model</code>, <code id="confint.ivreg_+3A_mod">mod</code></td>
<td>
<p>An object of class <code>"ivreg"</code>.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_parm">parm</code></td>
<td>
<p>parameters for which confidence intervals are to be computed; a vector or numbers or names; the default is all parameters.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_level">level</code></td>
<td>
<p>confidence level; the default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_component">component</code></td>
<td>
<p>Character indicating <code>"stage2"</code> or <code>"stage1"</code>.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_complete">complete</code></td>
<td>
<p>If <code>TRUE</code>, the default, the returned coefficient vector (for <code>coef</code>) or coefficient-covariance matrix (for <code>vcov</code>) includes elements for aliased regressors.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_vcov.">vcov.</code></td>
<td>
<p>Optionally either a coefficient covariance matrix or a function to compute such a covariance
matrix from fitted <code>ivreg</code> model objects. If <code>NULL</code> (the default) the standard covariance matrix
(based on the information matrix) is used. Alternatively, covariance matrices (e.g., clustered and/or
heteroscedasticity-consistent) can be plugged in to adjust Wald tests or confidence intervals etc.
In <code>summary</code>, if <code>diagnostics = TRUE</code>, <code>vcov.</code> must be a function (not a matrix) because
the alternative covariances are also needed for certain auxiliary models in the diagnostic tests.
If <code>vcov.</code> is a function, the <code>...</code> argument can be used to pass on further arguments to
this function.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_df">df</code></td>
<td>
<p>For <code>summary</code>, optional residual degrees of freedom to use in computing model summary.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_...">...</code></td>
<td>
<p>arguments to pass down.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_diagnostics">diagnostics</code></td>
<td>
<p>Report 2SLS &quot;diagnostic&quot; tests in model summary (default is <code>TRUE</code>). 
These tests are not to be confused with the <em>regression diagnostics</em> provided elsewhere in the <span class="pkg">ivreg</span>
package: see <code><a href="#topic+ivregDiagnostics">ivregDiagnostics</a></code>.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_x">x</code></td>
<td>
<p>An object of class <code>"summary.ivreg"</code>.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_digits">digits</code></td>
<td>
<p>Minimal number of significant digits for printing.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_signif.stars">signif.stars</code></td>
<td>
<p>Show &quot;significance stars&quot; in summary output?</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_test">test</code>, <code id="confint.ivreg_+3A_test.statistic">test.statistic</code></td>
<td>
<p>Test statistics for ANOVA table computed by <code>anova</code>, <code><a href="car.html#topic+Anova">Anova</a></code>,
or <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code>. Only <code>test = "F"</code> is supported by <code>anova</code>; this is also
the default for <code>Anova</code> and <code>linearHypothesis</code>, which also allow <code>test = "Chisq"</code> for
asymptotic tests.</p>
</td></tr>
<tr><td><code id="confint.ivreg_+3A_hypothesis.matrix">hypothesis.matrix</code>, <code id="confint.ivreg_+3A_rhs">rhs</code></td>
<td>
<p>For formulating a linear hypothesis; see the documentation
for <code><a href="car.html#topic+linearHypothesis">linearHypothesis</a></code> for details.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+ivreg">ivreg</a></code>, <code><a href="#topic+ivreg.fit">ivreg.fit</a></code>, <code><a href="#topic+ivregDiagnostics">ivregDiagnostics</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data and model
data("CigaretteDemand", package = "ivreg")
m &lt;- ivreg(log(packs) ~ log(rincome) | log(rprice) | salestax, data = CigaretteDemand)

## summary including diagnostics
summary(m)

## replicate global F test from summary (against null model) "by hand"
m0 &lt;- ivreg(log(packs) ~ 1, data = CigaretteDemand)
anova(m0, m)

## or via linear hypothesis test
car::linearHypothesis(m, c("log(rincome)", "log(rprice)"))

## confidence intervals
confint(m)

## just the Wald tests for the coefficients
library("lmtest")
coeftest(m)

## plug in a heteroscedasticity-consistent HC1 covariance matrix (from sandwich)
library("sandwich")
## - as a function passing additional type argument through ...
coeftest(m, vcov = vcovHC, type = "HC1")
## - as a function without additional arguments
hc1 &lt;- function(object, ...) vcovHC(object, type = "HC1", ...)
coeftest(m, vcov = hc1)
## - as a matrix
vc1 &lt;- vcovHC(m, type = "HC1")
coeftest(m, vcov = vc1)

## in summary() with diagnostics = TRUE use one of the function specifications,
## the matrix is only possible when diagnostics = FALSE
summary(m, vcov = vcovHC, type = "HC1")     ## function + ...
summary(m, vcov = hc1)                      ## function
summary(m, vcov = vc1, diagnostics = FALSE) ## matrix

## in confint() and anova() any of the three specifications can be used
anova(m0, m, vcov = vcovHC, type = "HC1")   ## function + ...
anova(m0, m, vcov = hc1)                    ## function
anova(m0, m, vcov = vc1)                    ## matrix

</code></pre>

<hr>
<h2 id='influence.ivreg'>Deletion and Other Diagnostic Methods for <code>"ivreg"</code> Objects</h2><span id='topic+influence.ivreg'></span><span id='topic+ivregDiagnostics'></span><span id='topic+rstudent.ivreg'></span><span id='topic+cooks.distance.ivreg'></span><span id='topic+dfbeta.influence.ivreg'></span><span id='topic+hatvalues.ivreg'></span><span id='topic+rstudent.influence.ivreg'></span><span id='topic+hatvalues.influence.ivreg'></span><span id='topic+cooks.distance.influence.ivreg'></span><span id='topic+qqPlot.ivreg'></span><span id='topic+qqPlot.influence.ivreg'></span><span id='topic+influencePlot.ivreg'></span><span id='topic+influencePlot.influence.ivreg'></span><span id='topic+infIndexPlot.ivreg'></span><span id='topic+infIndexPlot.influence.ivreg'></span><span id='topic+model.matrix.influence.ivreg'></span><span id='topic+avPlots.ivreg'></span><span id='topic+avPlot.ivreg'></span><span id='topic+mcPlots.ivreg'></span><span id='topic+mcPlot.ivreg'></span><span id='topic+Boot.ivreg'></span><span id='topic+crPlots.ivreg'></span><span id='topic+crPlot.ivreg'></span><span id='topic+ceresPlots.ivreg'></span><span id='topic+ceresPlot.ivreg'></span><span id='topic+plot.ivreg'></span><span id='topic+outlierTest.ivreg'></span><span id='topic+spreadLevelPlot.ivreg'></span><span id='topic+ncvTest.ivreg'></span><span id='topic+deviance.ivreg'></span><span id='topic+dfbeta.ivreg'></span><span id='topic+influence.rivreg'></span>

<h3>Description</h3>

<p>Methods for computing deletion and other regression diagnostics for 2SLS regression.
It's generally more efficient to compute the deletion diagnostics via the <code>influence</code>
method and then to extract the various specific diagnostics with the methods for
<code>"influence.ivreg"</code> objects. Other diagnostics for linear models, such as
added-variable plots (<code><a href="car.html#topic+avPlots">avPlots</a></code>) and component-plus-residual
plots (<code><a href="car.html#topic+crPlots">crPlots</a></code>), also work, as do effect plots
(e.g., <code><a href="effects.html#topic+predictorEffects">predictorEffects</a></code>) with residuals (see the examples below).
The pointwise confidence envelope for the <code><a href="car.html#topic+qqPlot">qqPlot</a></code> method assumes an independent random sample
from the t distribution with degrees of freedom equal to the residual degrees of
freedom for the model and so are approximate, because the studentized residuals aren't
independent.
</p>
<p>For additional information, see the vignette
<a href="../doc/Diagnostics-for-2SLS-Regression.pdf">Diagnostics for 2SLS Regression</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ivreg'
influence(
  model,
  sigma. = n &lt;= 1000,
  type = c("stage2", "both", "maximum"),
  applyfun = NULL,
  ncores = NULL,
  ...
)

## S3 method for class 'ivreg'
rstudent(model, ...)

## S3 method for class 'ivreg'
cooks.distance(model, ...)

## S3 method for class 'influence.ivreg'
dfbeta(model, ...)

## S3 method for class 'ivreg'
dfbeta(model, ...)

## S3 method for class 'ivreg'
hatvalues(model, type = c("stage2", "both", "maximum", "stage1"), ...)

## S3 method for class 'influence.ivreg'
rstudent(model, ...)

## S3 method for class 'influence.ivreg'
hatvalues(model, ...)

## S3 method for class 'influence.ivreg'
cooks.distance(model, ...)

## S3 method for class 'influence.ivreg'
qqPlot(
  x,
  ylab = paste("Studentized Residuals(", deparse(substitute(x)), ")", sep = ""),
  distribution = c("t", "norm"),
  ...
)

## S3 method for class 'ivreg'
influencePlot(model, ...)

## S3 method for class 'influence.ivreg'
influencePlot(model, ...)

## S3 method for class 'ivreg'
infIndexPlot(model, ...)

## S3 method for class 'influence.ivreg'
infIndexPlot(model, ...)

## S3 method for class 'influence.ivreg'
model.matrix(object, ...)

## S3 method for class 'ivreg'
avPlots(model, terms, ...)

## S3 method for class 'ivreg'
avPlot(model, ...)

## S3 method for class 'ivreg'
mcPlots(model, terms, ...)

## S3 method for class 'ivreg'
mcPlot(model, ...)

## S3 method for class 'ivreg'
Boot(
  object,
  f = coef,
  labels = names(f(object)),
  R = 999,
  method = "case",
  ncores = 1,
  ...
)

## S3 method for class 'ivreg'
crPlots(model, terms, ...)

## S3 method for class 'ivreg'
crPlot(model, ...)

## S3 method for class 'ivreg'
ceresPlots(model, terms, ...)

## S3 method for class 'ivreg'
ceresPlot(model, ...)

## S3 method for class 'ivreg'
plot(x, ...)

## S3 method for class 'ivreg'
qqPlot(x, distribution = c("t", "norm"), ...)

## S3 method for class 'ivreg'
outlierTest(model, ...)

## S3 method for class 'ivreg'
spreadLevelPlot(x, main = "Spread-Level Plot", ...)

## S3 method for class 'ivreg'
ncvTest(model, ...)

## S3 method for class 'ivreg'
deviance(object, ...)

## S3 method for class 'rivreg'
influence(model, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="influence.ivreg_+3A_model">model</code>, <code id="influence.ivreg_+3A_x">x</code>, <code id="influence.ivreg_+3A_object">object</code></td>
<td>
<p>A <code>"ivreg"</code> or <code>"influence.ivreg"</code> object.</p>
</td></tr>
<tr><td><code id="influence.ivreg_+3A_sigma.">sigma.</code></td>
<td>
<p>If <code>TRUE</code> (the default for 1000 or fewer cases), the deleted value
of the residual standard deviation is computed for each case; if <code>FALSE</code>, the
overall residual standard deviation is used to compute other deletion diagnostics.</p>
</td></tr>
<tr><td><code id="influence.ivreg_+3A_type">type</code></td>
<td>
<p>If <code>"stage2"</code> (the default), hatvalues are for the second stage regression;
if <code>"both"</code>, the hatvalues are the geometric mean of the casewise hatvalues for the
two stages; if <code>"maximum"</code>, the hatvalues are the larger of the casewise
hatvalues for the two stages. In computing the geometric mean or casewise maximum hatvalues,
the hatvalues for each stage are first divided by their average (number of coefficients in
stage regression/number of cases); the geometric mean or casewise maximum values are then
multiplied by the average hatvalue from the second stage.</p>
</td></tr>
<tr><td><code id="influence.ivreg_+3A_applyfun">applyfun</code></td>
<td>
<p>Optional loop replacement function that should work like
<code><a href="base.html#topic+lapply">lapply</a></code> with arguments <code>function(X, FUN, ...)</code>. The default
is to use a loop unless the <code>ncores</code> argument is specified (see below).</p>
</td></tr>
<tr><td><code id="influence.ivreg_+3A_ncores">ncores</code></td>
<td>
<p>Numeric, number of cores to be used in parallel computations. If set
to an integer the <code>applyfun</code> is set to use either <code><a href="parallel.html#topic+clusterApply">parLapply</a></code>
(on Windows) or
</p>
<p><code><a href="parallel.html#topic+mclapply">mclapply</a></code>
(otherwise) with the desired number of cores.</p>
</td></tr>
<tr><td><code id="influence.ivreg_+3A_...">...</code></td>
<td>
<p>arguments to be passed down.</p>
</td></tr>
<tr><td><code id="influence.ivreg_+3A_ylab">ylab</code></td>
<td>
<p>The vertical axis label.</p>
</td></tr>
<tr><td><code id="influence.ivreg_+3A_distribution">distribution</code></td>
<td>
<p><code>"t"</code> (the default) or <code>"norm"</code>.</p>
</td></tr>
<tr><td><code id="influence.ivreg_+3A_terms">terms</code></td>
<td>
<p>Terms for which added-variable plots are to be constructed; the default,
if the argument isn't specified, is the <code>"regressors"</code> component of the model formula.</p>
</td></tr>
<tr><td><code id="influence.ivreg_+3A_f">f</code>, <code id="influence.ivreg_+3A_labels">labels</code>, <code id="influence.ivreg_+3A_r">R</code></td>
<td>
<p>see <code><a href="car.html#topic+Boot">Boot</a></code>.</p>
</td></tr>
<tr><td><code id="influence.ivreg_+3A_method">method</code></td>
<td>
<p>only <code>"case"</code> (case resampling) is supported: see <code><a href="car.html#topic+Boot">Boot</a></code>.</p>
</td></tr>
<tr><td><code id="influence.ivreg_+3A_main">main</code></td>
<td>
<p>Main title for the graph.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>In the case of <code>influence.ivreg</code>, an object of class <code>"influence.ivreg"</code>
with the following components:
</p>

<dl>
<dt><code>coefficients</code></dt><dd><p>the estimated regression coefficients</p>
</dd>
<dt><code>model</code></dt><dd><p>the model matrix</p>
</dd>
<dt><code>dfbeta</code></dt><dd><p>influence on coefficients</p>
</dd>
<dt><code>sigma</code></dt><dd><p>deleted values of the residual standard deviation</p>
</dd>
<dt><code>dffits</code></dt><dd><p>overall influence on the regression coefficients</p>
</dd>
<dt><code>cookd</code></dt><dd><p>Cook's distances</p>
</dd>
<dt><code>hatvalues</code></dt><dd><p>hatvalues</p>
</dd>
<dt><code>rstudent</code></dt><dd><p>Studentized residuals</p>
</dd>
<dt><code>df.residual</code></dt><dd><p>residual degrees of freedom</p>
</dd>
</dl>

<p>In the case of other methods, such as <code>rstudent.ivreg</code> or
<code>rstudent.influence.ivreg</code>, the corresponding diagnostic statistics.
Many other methods (e.g., <code>crPlot.ivreg</code>, <code>avPlot.ivreg</code>, <code>Effect.ivreg</code>)
draw graphs.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ivreg">ivreg</a></code>, <code><a href="car.html#topic+avPlots">avPlots</a></code>,
<code><a href="car.html#topic+crPlots">crPlots</a></code>, <code><a href="effects.html#topic+predictorEffects">predictorEffects</a></code>,
<code><a href="car.html#topic+qqPlot">qqPlot</a></code>, <code><a href="car.html#topic+influencePlot">influencePlot</a></code>,
<code><a href="car.html#topic+infIndexPlot">infIndexPlot</a></code>, <code><a href="car.html#topic+Boot">Boot</a></code>,
<code><a href="car.html#topic+outlierTest">outlierTest</a></code>, <code><a href="car.html#topic+spreadLevelPlot">spreadLevelPlot</a></code>,
<code><a href="car.html#topic+ncvTest">ncvTest</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kmenta.eq1 &lt;- ivreg(Q ~ P + D | D + F + A, data = Kmenta)
summary(kmenta.eq1)
car::avPlots(kmenta.eq1)
car::mcPlots(kmenta.eq1)
car::crPlots(kmenta.eq1)
car::ceresPlots(kmenta.eq1)
car::influencePlot(kmenta.eq1)
car::influenceIndexPlot(kmenta.eq1)
car::qqPlot(kmenta.eq1)
car::spreadLevelPlot(kmenta.eq1)
plot(effects::predictorEffects(kmenta.eq1, residuals = TRUE))
set.seed &lt;- 12321 # for reproducibility
confint(car::Boot(kmenta.eq1, R = 250)) # 250 reps for brevity
car::outlierTest(kmenta.eq1)
car::ncvTest(kmenta.eq1)

</code></pre>

<hr>
<h2 id='ivreg'>Instrumental-Variable Regression by 2SLS, 2SM, or 2SMM Estimation</h2><span id='topic+ivreg'></span>

<h3>Description</h3>

<p>Fit instrumental-variable regression by two-stage least squares (2SLS). This is
equivalent to direct instrumental-variables estimation when the number of
instruments is equal to the number of regressors. Alternative robust-regression
estimators are also provided, based on M-estimation (2SM) and MM-estimation
(2SMM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivreg(
  formula,
  instruments,
  data,
  subset,
  na.action,
  weights,
  offset,
  contrasts = NULL,
  model = TRUE,
  y = TRUE,
  x = FALSE,
  method = c("OLS", "M", "MM"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ivreg_+3A_formula">formula</code>, <code id="ivreg_+3A_instruments">instruments</code></td>
<td>
<p>formula specification(s) of the regression
relationship and the instruments. Either <code>instruments</code> is missing and
<code>formula</code> has three parts as in <code>y ~ x1 + x2 | z1 + z2 + z3</code>
(recommended) or <code>formula</code> is <code>y ~ x1 + x2</code> and <code>instruments</code>
is a one-sided formula <code>~ z1 + z2 + z3</code> (only for backward
compatibility).</p>
</td></tr>
<tr><td><code id="ivreg_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
By default the variables are taken from the environment of the
<code>formula</code>.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in fitting the model.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_na.action">na.action</code></td>
<td>
<p>a function that indicates what should happen when the data
contain <code>NA</code>s. The default is set by the <code>na.action</code> option.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_offset">offset</code></td>
<td>
<p>an optional offset that can be used to specify an a priori
known component to be included during fitting.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_contrasts">contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> of
<code><a href="stats.html#topic+model.matrix">model.matrix.default</a></code>.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_model">model</code>, <code id="ivreg_+3A_x">x</code>, <code id="ivreg_+3A_y">y</code></td>
<td>
<p>logicals.  If <code>TRUE</code> the corresponding components of
the fit (the model frame, the model matrices, the response) are returned. These
components are necessary for computing regression diagnostics.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_method">method</code></td>
<td>
<p>the method used to fit the stage 1 and 2 regression: 
<code>"OLS"</code> for traditional 2SLS regression (the default), 
<code>"M"</code> for M-estimation, or <code>"MM"</code> for MM-estimation, with the
latter two robust-regression methods implemented via the <code><a href="MASS.html#topic+rlm">rlm</a></code> 
function in the <span class="pkg">MASS</span> package.</p>
</td></tr>
<tr><td><code id="ivreg_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="#topic+ivreg.fit">ivreg.fit</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ivreg</code> is the high-level interface to the work-horse function
<code><a href="#topic+ivreg.fit">ivreg.fit</a></code>. A set of standard methods (including <code>print</code>,
<code>summary</code>, <code>vcov</code>, <code>anova</code>, <code>predict</code>, <code>residuals</code>,
<code>terms</code>, <code>model.matrix</code>, <code>bread</code>, <code>estfun</code>) is available
and described in <code><a href="#topic+ivregMethods">ivregMethods</a></code>. For methods related to regression
diagnostics, see <code><a href="#topic+ivregDiagnostics">ivregDiagnostics</a></code>.
</p>
<p>Regressors and instruments for <code>ivreg</code> are most easily specified in a
formula with two parts on the right-hand side, e.g., <code>y ~ x1 + x2 | z1
+ z2 + z3</code>, where <code>x1</code> and <code>x2</code> are the explanatory variables and <code>z1</code>,
<code>z2</code>, and <code>z3</code> are the instrumental variables. Note that exogenous regressors
have to be included as instruments for themselves. 
</p>
<p>For example, if there is
one exogenous regressor <code>ex</code> and one endogenous regressor <code>en</code>
with instrument <code>in</code>, the appropriate formula would be <code>y ~ en +
ex | in + ex</code>. Alternatively, a formula with three parts on the right-hand
side can also be used: <code>y ~ ex | en | in</code>. The latter is typically more convenient, if
there is a large number of exogenous regressors.
</p>
<p>Moreover, two further equivalent specification strategies are possible that are
typically less convenient compared to the strategies above. One option is to use
an update formula with a <code>.</code> in the second part of the formula is used:
<code>y ~ en + ex | . - en + in</code>. Another option is to use a separate formula
for the instruments (only for backward compatibility with earlier versions):
<code>formula = y ~ en + ex, instruments = ~ in + ex</code>.
</p>
<p>Internally, all specifications are converted to the version with two parts
on the right-hand side.
</p>


<h3>Value</h3>

<p><code>ivreg</code> returns an object of class <code>"ivreg"</code> that inherits from
class <code>"lm"</code>, with the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>parameter estimates, from the stage-2 regression.</p>
</td></tr> 
<tr><td><code>residuals</code></td>
<td>
<p>vector of model residuals.</p>
</td></tr> 
<tr><td><code>residuals1</code></td>
<td>
<p>matrix of residuals from the stage-1 regression.</p>
</td></tr>
<tr><td><code>residuals2</code></td>
<td>
<p>vector of residuals from the stage-2 regression.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>vector of predicted means for the response.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>either the vector of weights used (if any) or <code>NULL</code> (if none).</p>
</td></tr> 
<tr><td><code>offset</code></td>
<td>
<p>either the offset used (if any) or <code>NULL</code> (if none).</p>
</td></tr> 
<tr><td><code>estfun</code></td>
<td>
<p>a matrix containing the empirical estimating functions.</p>
</td></tr> 
<tr><td><code>n</code></td>
<td>
<p>number of observations.</p>
</td></tr> 
<tr><td><code>nobs</code></td>
<td>
<p>number of observations with non-zero weights.</p>
</td></tr> 
<tr><td><code>p</code></td>
<td>
<p>number of columns in the model matrix x of regressors.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>number of columns in the instrumental variables model matrix z</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>numeric rank of the model matrix for the stage-2 regression.</p>
</td></tr> 
<tr><td><code>df.residual</code></td>
<td>
<p>residual degrees of freedom for fitted model.</p>
</td></tr> 
<tr><td><code>cov.unscaled</code></td>
<td>
<p>unscaled covariance matrix for the coefficients.</p>
</td></tr> 
<tr><td><code>sigma</code></td>
<td>
<p>residual standard deviation.</p>
</td></tr>
<tr><td><code>qr</code></td>
<td>
<p>QR decomposition for the stage-2 regression.</p>
</td></tr>
<tr><td><code>qr1</code></td>
<td>
<p>QR decomposition for the stage-1 regression.</p>
</td></tr>
<tr><td><code>rank1</code></td>
<td>
<p>numeric rank of the model matrix for the stage-1 regression.</p>
</td></tr>
<tr><td><code>coefficients1</code></td>
<td>
<p>matrix of coefficients from the stage-1 regression.</p>
</td></tr>
<tr><td><code>df.residual1</code></td>
<td>
<p>residual degrees of freedom for the stage-1 regression.</p>
</td></tr> 
<tr><td><code>exogenous</code></td>
<td>
<p>columns of the <code>"regressors"</code> matrix that are exogenous.</p>
</td></tr>
<tr><td><code>endogenous</code></td>
<td>
<p>columns of the <code>"regressors"</code> matrix that are endogenous.</p>
</td></tr>
<tr><td><code>instruments</code></td>
<td>
<p>columns of the <code>"instruments"</code> matrix that are
instruments for the endogenous variables.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the method used for the stage 1 and 2 regressions, one of <code>"OLS"</code>,
<code>"M"</code>, or <code>"MM"</code>.</p>
</td></tr>
<tr><td><code>rweights</code></td>
<td>
<p>a matrix of robustness weights with columns for each of the stage-1
regressions and for the stage-2 regression (in the last column) if the fitting method is 
<code>"M"</code> or <code>"MM"</code>, <code>NULL</code> if the fitting method is <code>"OLS"</code>.</p>
</td></tr>
<tr><td><code>hatvalues</code></td>
<td>
<p>a matrix of hatvalues. For <code>method = "OLS"</code>, the matrix consists of two
columns, for each of the stage-1 and stage-2 regression; for <code>method = "M"</code> or <code>"MM"</code>,
there is one column for <em>each</em> stage=1 regression and for the stage-2 regression. </p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>residual degrees of freedom for fitted model.</p>
</td></tr> 
<tr><td><code>call</code></td>
<td>
<p>the original function call.</p>
</td></tr> 
<tr><td><code>formula</code></td>
<td>
<p>the model formula.</p>
</td></tr>
<tr><td><code>na.action</code></td>
<td>
<p>function applied to missing values in the model fit.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>a list with elements <code>"regressors"</code> and <code>"instruments"</code> 
containing the terms objects for the respective components.</p>
</td></tr> 
<tr><td><code>levels</code></td>
<td>
<p>levels of the categorical regressors.</p>
</td></tr> 
<tr><td><code>contrasts</code></td>
<td>
<p>the contrasts used for categorical regressors.</p>
</td></tr> 
<tr><td><code>model</code></td>
<td>
<p>the full model frame (if <code>model = TRUE</code>).</p>
</td></tr> 
<tr><td><code>y</code></td>
<td>
<p>the response vector (if <code>y = TRUE</code>).</p>
</td></tr> 
<tr><td><code>x</code></td>
<td>
<p>a list with elements <code>"regressors"</code>, <code>"instruments"</code>, <code>"projected"</code>,
containing the model matrices from the respective components (if <code>x = TRUE</code>). 
<code>"projected"</code> is the matrix of regressors projected on the image of the instruments.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Greene, W.H. (2003) <em>Econometric Analysis</em>, 5th ed., Upper Saddle River: Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ivreg.fit">ivreg.fit</a></code>, <code><a href="#topic+ivregDiagnostics">ivregDiagnostics</a></code>, <code><a href="#topic+ivregMethods">ivregMethods</a></code>,
<code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+lmfit">lm.fit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## data
data("CigaretteDemand", package = "ivreg")

## model 
m &lt;- ivreg(log(packs) ~ log(rprice) + log(rincome) | salestax + log(rincome),
  data = CigaretteDemand)
summary(m)
summary(m, vcov = sandwich::sandwich, df = Inf)

## ANOVA
m2 &lt;- update(m, . ~ . - log(rincome) | . - log(rincome))
anova(m, m2)
car::Anova(m)

## same model specified by formula with three-part right-hand side
ivreg(log(packs) ~ log(rincome) | log(rprice) | salestax, data = CigaretteDemand)

# Robust 2SLS regression
data("Kmenta", package = "ivreg")
Kmenta1 &lt;- Kmenta
Kmenta1[20, "Q"] &lt;- 95 # corrupted data
deq &lt;- ivreg(Q ~ P + D | D + F + A, data=Kmenta) # demand equation, uncorrupted data
deq1 &lt;- ivreg(Q ~ P + D | D + F + A, data=Kmenta1) # standard 2SLS, corrupted data
deq2 &lt;- ivreg(Q ~ P + D | D + F + A, data=Kmenta1, subset=-20) # standard 2SLS, removing bad case
deq3 &lt;- ivreg(Q ~ P + D | D + F + A, data=Kmenta1, method="MM") # 2SLS MM estimation
car::compareCoefs(deq, deq1, deq2, deq3)
round(deq3$rweights, 2) # robustness weights

</code></pre>

<hr>
<h2 id='ivreg.fit'>Fitting Instrumental-Variable Regressions by 2SLS, 2SM, or 2SMM Estimation</h2><span id='topic+ivreg.fit'></span>

<h3>Description</h3>

<p>Fit instrumental-variable regression by two-stage least squares (2SLS). This is
equivalent to direct instrumental-variables estimation when the number of
instruments is equal to the number of predictors. Alternative robust-regression
estimation is also supported, based on M-estimation (22M) or MM-estimation (2SMM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ivreg.fit(
  x,
  y,
  z,
  weights,
  offset,
  method = c("OLS", "M", "MM"),
  rlm.args = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ivreg.fit_+3A_x">x</code></td>
<td>
<p>regressor matrix.</p>
</td></tr>
<tr><td><code id="ivreg.fit_+3A_y">y</code></td>
<td>
<p>vector for the response variable.</p>
</td></tr>
<tr><td><code id="ivreg.fit_+3A_z">z</code></td>
<td>
<p>instruments matrix.</p>
</td></tr>
<tr><td><code id="ivreg.fit_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.</p>
</td></tr>
<tr><td><code id="ivreg.fit_+3A_offset">offset</code></td>
<td>
<p>an optional offset that can be used to specify an a priori
known component to be included during fitting.</p>
</td></tr>
<tr><td><code id="ivreg.fit_+3A_method">method</code></td>
<td>
<p>the method used to fit the stage 1 and 2 regression: 
<code>"OLS"</code> for traditional 2SLS regression (the default), 
<code>"M"</code> for M-estimation, or <code>"MM"</code> for MM-estimation, with the
latter two robust-regression methods implemented via the <code><a href="MASS.html#topic+rlm">rlm</a></code> 
function in the <span class="pkg">MASS</span> package.</p>
</td></tr>
<tr><td><code id="ivreg.fit_+3A_rlm.args">rlm.args</code></td>
<td>
<p>a list of optional arguments to be passed to the <code><a href="MASS.html#topic+rlm">rlm</a></code> 
function in the <span class="pkg">MASS</span> package if robust regression is used for the stage 1 and 2 regressions.</p>
</td></tr>
<tr><td><code id="ivreg.fit_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="stats.html#topic+lmfit">lm.fit</a></code>
or <code><a href="stats.html#topic+lmfit">lm.wfit</a></code>, respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+ivreg">ivreg</a></code> is the high-level interface to the work-horse function
<code>ivreg.fit</code>. <code>ivreg.fit</code> is essentially a convenience interface to
<code><a href="stats.html#topic+lmfit">lm.fit</a></code> (or <code><a href="stats.html#topic+lmfit">lm.wfit</a></code>)
for first projecting <code>x</code> onto the image of
<code>z</code>, then running a regression of <code>y</code> on the projected
<code>x</code>, and computing the residual standard deviation.
</p>


<h3>Value</h3>

<p><code>ivreg.fit</code> returns an unclassed list with the following
components: 
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>parameter estimates, from the stage-2 regression.</p>
</td></tr> 
<tr><td><code>residuals</code></td>
<td>
<p>vector of model residuals.</p>
</td></tr> 
<tr><td><code>residuals1</code></td>
<td>
<p>matrix of residuals from the stage-1 regression.</p>
</td></tr>
<tr><td><code>residuals2</code></td>
<td>
<p>vector of residuals from the stage-2 regression.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>vector of predicted means for the response.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>either the vector of weights used (if any) or <code>NULL</code> (if none).</p>
</td></tr> 
<tr><td><code>offset</code></td>
<td>
<p>either the offset used (if any) or <code>NULL</code> (if none).</p>
</td></tr> 
<tr><td><code>estfun</code></td>
<td>
<p>a matrix containing the empirical estimating functions.</p>
</td></tr> 
<tr><td><code>n</code></td>
<td>
<p>number of observations.</p>
</td></tr> 
<tr><td><code>nobs</code></td>
<td>
<p>number of observations with non-zero weights.</p>
</td></tr> 
<tr><td><code>p</code></td>
<td>
<p>number of columns in the model matrix x of regressors.</p>
</td></tr>
<tr><td><code>q</code></td>
<td>
<p>number of columns in the instrumental variables model matrix z</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>numeric rank of the model matrix for the stage-2 regression.</p>
</td></tr> 
<tr><td><code>df.residual</code></td>
<td>
<p>residual degrees of freedom for fitted model.</p>
</td></tr> 
<tr><td><code>cov.unscaled</code></td>
<td>
<p>unscaled covariance matrix for the coefficients.</p>
</td></tr> 
<tr><td><code>sigma</code></td>
<td>
<p>residual standard error; when method is <code>"M"</code> or <code>"MM"</code>, this
is based on the MAD of the residuals (around 0) &mdash; see <code><a href="stats.html#topic+mad">mad</a></code>.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>projection of x matrix onto span of z.</p>
</td></tr>
<tr><td><code>qr</code></td>
<td>
<p>QR decomposition for the stage-2 regression.</p>
</td></tr>
<tr><td><code>qr1</code></td>
<td>
<p>QR decomposition for the stage-1 regression.</p>
</td></tr>
<tr><td><code>rank1</code></td>
<td>
<p>numeric rank of the model matrix for the stage-1 regression.</p>
</td></tr>
<tr><td><code>coefficients1</code></td>
<td>
<p>matrix of coefficients from the stage-1 regression.</p>
</td></tr>
<tr><td><code>df.residual1</code></td>
<td>
<p>residual degrees of freedom for the stage-1 regression.</p>
</td></tr> 
<tr><td><code>exogenous</code></td>
<td>
<p>columns of the <code>"regressors"</code> matrix that are exogenous.</p>
</td></tr>
<tr><td><code>endogenous</code></td>
<td>
<p>columns of the <code>"regressors"</code> matrix that are endogenous.</p>
</td></tr>
<tr><td><code>instruments</code></td>
<td>
<p>columns of the <code>"instruments"</code> matrix that are
instruments for the endogenous variables.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the method used for the stage 1 and 2 regressions, one of <code>"OLS"</code>,
<code>"M"</code>, or <code>"MM"</code>.</p>
</td></tr>
<tr><td><code>rweights</code></td>
<td>
<p>a matrix of robustness weights with columns for each of the stage-1
regressions and for the stage-2 regression (in the last column) if the fitting method is 
<code>"M"</code> or <code>"MM"</code>, <code>NULL</code> if the fitting method is <code>"OLS"</code>.</p>
</td></tr>
<tr><td><code>hatvalues</code></td>
<td>
<p>a matrix of hatvalues. For <code>method = "OLS"</code>, the matrix consists of two
columns, for each of the stage-1 and stage-2 regression; for <code>method = "M"</code> or <code>"MM"</code>,
there is one column for <em>each</em> stage-1 regression and for the stage-2 regression. </p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+ivreg">ivreg</a></code>, <code><a href="stats.html#topic+lmfit">lm.fit</a></code>, 
<code><a href="stats.html#topic+lmfit">lm.wfit</a></code>, <code><a href="MASS.html#topic+rlm">rlm</a></code>, <code><a href="stats.html#topic+mad">mad</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data
data("CigaretteDemand", package = "ivreg")

## high-level interface
m &lt;- ivreg(log(packs) ~ log(rprice) + log(rincome) | salestax + log(rincome),
  data = CigaretteDemand)

## low-level interface
y &lt;- m$y
x &lt;- model.matrix(m, component = "regressors")
z &lt;- model.matrix(m, component = "instruments")
ivreg.fit(x, y, z)$coefficients

</code></pre>

<hr>
<h2 id='Kmenta'>Partly Artificial Data on the U.S. Economy</h2><span id='topic+Kmenta'></span>

<h3>Description</h3>

<p>These are partly contrived data from Kmenta (1986), constructed
to illustrate estimation of a simultaneous-equation econometric model. The data
are an annual time-series for the U.S. economy from 1922 to 1941. The values of the
exogenous variables D, and F, and A are real, while those of the endogenous
variables Q and P are simulated according to the linear simultaneous equation model 
fit in the examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Kmenta", package = "ivreg")
</code></pre>


<h3>Format</h3>

<p>A data frame with 20 rows and 5 columns.
</p>

<dl>
<dt>Q</dt><dd><p>food consumption per capita.</p>
</dd>
<dt>P</dt><dd><p>ratio of food prices to general consumer prices.</p>
</dd>
<dt>D</dt><dd><p>disposable income in constant dollars.</p>
</dd>
<dt>F</dt><dd><p>ratio of preceding year's prices received by farmers to general consumer prices.</p>
</dd>
<dt>A</dt><dd><p>time in years.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kmenta, J. (1986) <em>Elements of Econometrics</em>, 2nd ed., Macmillan.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ivreg">ivreg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Kmenta", package = "ivreg") 
deq &lt;- ivreg(Q ~ P + D     | D + F + A, data = Kmenta) # demand equation
seq &lt;- ivreg(Q ~ P + F + A | D + F + A, data = Kmenta) # supply equation
summary(deq, tests = TRUE)
summary(seq, tests = TRUE)
</code></pre>

<hr>
<h2 id='SchoolingReturns'>U.S. Returns to Schooling Data</h2><span id='topic+SchoolingReturns'></span>

<h3>Description</h3>

<p>Data from the U.S. National Longitudinal Survey of Young Men (NLSYM) in 1976
but using some variables dating back to earlier years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SchoolingReturns", package = "ivreg")
</code></pre>


<h3>Format</h3>

<p>A data frame with 3010 rows and 22 columns.
</p>

<dl>
<dt>wage</dt><dd><p>Raw wages in 1976 (in cents per hour).</p>
</dd>
<dt>education</dt><dd><p>Education in 1976 (in years).</p>
</dd>
<dt>experience</dt><dd><p>Years of labor market experience, computed as <code>age - education - 6</code>.</p>
</dd>
<dt>ethnicity</dt><dd><p>Factor indicating ethnicity. Is the individual African-American
(<code>"afam"</code>) or not (<code>"other"</code>)?</p>
</dd>
<dt>smsa</dt><dd><p>Factor. Does the individual reside in a SMSA (standard metropolitan statistical area) in 1976?</p>
</dd>
<dt>south</dt><dd><p>Factor. Does the individual reside in the South in 1976?</p>
</dd>
<dt>age</dt><dd><p>Age in 1976 (in years).</p>
</dd>
<dt>nearcollege</dt><dd><p>Factor. Did the individual grow up near a 4-year college?</p>
</dd>
<dt>nearcollege2</dt><dd><p>Factor. Did the individual grow up near a 2-year college?</p>
</dd>
<dt>nearcollege4</dt><dd><p>Factor. Did the individual grow up near a 4-year public or private college?</p>
</dd>
<dt>enrolled</dt><dd><p>Factor. Is the individual enrolled in college in 1976?</p>
</dd>
<dt>married</dt><dd><p>factor. Is the individual married in 1976?</p>
</dd>
<dt>education66</dt><dd><p>Education in 1966 (in years).</p>
</dd>
<dt>smsa66</dt><dd><p>Factor. Does the individual reside in a SMSA in 1966?</p>
</dd>
<dt>south66</dt><dd><p>Factor. Does the individual reside in the South in 1966?</p>
</dd>
<dt>feducation</dt><dd><p>Father's educational attainment (in years). Imputed with average if missing.</p>
</dd>
<dt>meducation</dt><dd><p>Mother's educational attainment (in years). Imputed with average if missing.</p>
</dd>
<dt>fameducation</dt><dd><p>Ordered factor coding family education class (from 1 to 9).</p>
</dd>
<dt>kww</dt><dd><p>Knowledge world of work (KWW) score.</p>
</dd>
<dt>iq</dt><dd><p>Normed intelligence quotient (IQ) score</p>
</dd>
<dt>parents14</dt><dd><p>Factor coding living with parents at age 14:
both parents, single mother, step parent, other</p>
</dd>
<dt>library14</dt><dd><p>Factor. Was there a library card in home at age 14?</p>
</dd>
</dl>



<h3>Details</h3>

<p>Investigating the causal link of schooling on earnings in a classical model
for wage determinants is problematic because it can be argued that schooling
is endogenous. Hence, one possible strategy is to use an exogonous variable
as an instrument for the years of education. In his well-known study, Card (1995)
uses geographical proximity to a college when growing up as such an instrument,
showing that this significantly increases both the years of education and the
wage level obtained on the labor market. Using instrumental variables regression
Card (1995) shows that the estimated returns to schooling are much higher than
when simply using ordinary least squares.
</p>
<p>The data are taken from the supplementary material for Verbeek (2004) and are based
on the work of Card (1995). The U.S. National Longitudinal Survey of Young Men
(NLSYM) began in 1966 and included 5525 men, then aged between 14 and 24.
Card (1995) employs labor market information from the 1976 NLSYM interview which
also included information about educational attainment. Out of the 3694 men
still included in that wave of NLSYM, 3010 provided information on both wages
and education yielding the subset of observations provided in <code>SchoolingReturns</code>.
</p>
<p>The examples replicate the results from Verbeek (2004) who used the simplest
specifications from Card (1995). Including further region or family background
characteristics improves the model significantly but does not affect much the
main coefficients of interest, namely that of years of education.
</p>


<h3>Source</h3>

<p>Supplementary material for Verbeek (2004).
</p>


<h3>References</h3>

<p>Card, D. (1995). Using Geographical Variation in College Proximity to Estimate the Return to
Schooling. In: Christofides, L.N., Grant, E.K., and Swidinsky, R. (eds.),
<em>Aspects of Labour Market Behaviour: Essays in Honour of John Vanderkamp</em>,
University of Toronto Press, Toronto, 201-222.
</p>
<p>Verbeek, M. (2004). <em>A Guide to Modern Econometrics</em>, 2nd ed. John Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data
data("SchoolingReturns", package = "ivreg")

## Table 5.1 in Verbeek (2004) / Table 2(1) in Card (1995)
## Returns to education: 7.4%
m_ols &lt;- lm(log(wage) ~ education + poly(experience, 2, raw = TRUE) + ethnicity + smsa + south,
  data = SchoolingReturns)
summary(m_ols)

## Table 5.2 in Verbeek (2004) / similar to Table 3(1) in Card (1995)
m_red &lt;- lm(education ~ poly(age, 2, raw = TRUE) + ethnicity + smsa + south + nearcollege,
  data = SchoolingReturns)
summary(m_red)

## Table 5.3 in Verbeek (2004) / similar to Table 3(5) in Card (1995)
## Returns to education: 13.3%
m_iv &lt;- ivreg(log(wage) ~ education + poly(experience, 2, raw = TRUE) + ethnicity + smsa + south |
  nearcollege + poly(age, 2, raw = TRUE) + ethnicity + smsa + south,
  data = SchoolingReturns)
summary(m_iv)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
