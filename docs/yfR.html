<!DOCTYPE html><html lang="en-US"><head><title>Help for package yfR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {yfR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#yf_cachefolder_get'><p>Returns the default folder for caching</p></a></li>
<li><a href='#yf_collection_get'><p>Downloads a collection of data from Yahoo Finance</p></a></li>
<li><a href='#yf_convert_to_wide'><p>Transforms a long (stacked) data frame into a list of wide data frames</p></a></li>
<li><a href='#yf_get'><p>Download financial data from Yahoo Finance</p></a></li>
<li><a href='#yf_get_available_collections'><p>Returns available collections</p></a></li>
<li><a href='#yf_get_dividends'><p>Get Yahoo Finance Dividends from a single stock</p></a></li>
<li><a href='#yf_index_composition'><p>Get current composition of stock indices</p></a></li>
<li><a href='#yf_index_list'><p>Get available indices in package</p></a></li>
<li><a href='#yf_live_prices'><p>Yahoo Finance Live Prices</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Downloads and Organizes Financial Data from Yahoo Finance</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Facilitates download of financial data from Yahoo Finance <a href="https://finance.yahoo.com/">https://finance.yahoo.com/</a>, 
 a vast repository of stock price data across multiple financial exchanges. The package offers a local caching system
 and support for parallel computation.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ropensci/yfR">https://github.com/ropensci/yfR</a>, <a href="https://docs.ropensci.org/yfR/">https://docs.ropensci.org/yfR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/yfR/issues">https://github.com/ropensci/yfR/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stringr, tidyr, lubridate, furrr, purrr, future, tibble, zoo,
cli, readr, rvest, dplyr, quantmod (&ge; 0.4.20), magrittr,
humanize, methods, pingr, tidyselect, glue, httr, jsonlite</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), ggplot2, covr,
spelling</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-16 10:47:39 UTC; msperlin</td>
</tr>
<tr>
<td>Author:</td>
<td>Marcelo Perlin [aut, cre],
  Nic Crane [rev] (Nic reviewed the package (v. 0.0.5) for rOpenSci, see
    &lt;https://github.com/ropensci/software-review/issues/523&gt;),
  Alexander Fischer [rev] (Alexander reviewed the package (v. 0.0.5) for
    rOpenSci, see
    &lt;https://github.com/ropensci/software-review/issues/523&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcelo Perlin &lt;marceloperlin@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-16 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling 'rhs(lhs)'.
</p>

<hr>
<h2 id='yf_cachefolder_get'>Returns the default folder for caching</h2><span id='topic+yf_cachefolder_get'></span>

<h3>Description</h3>

<p>By default, yfR uses a temp dir to store files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yf_cachefolder_get()
</code></pre>


<h3>Value</h3>

<p>a path (string)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(yf_cachefolder_get())
</code></pre>

<hr>
<h2 id='yf_collection_get'>Downloads a collection of data from Yahoo Finance</h2><span id='topic+yf_collection_get'></span>

<h3>Description</h3>

<p>This function will use a set collection of YF data, such as index components
and will download all data from Yahoo Finance using <code><a href="#topic+yf_get">yf_get</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yf_collection_get(
  collection,
  first_date = Sys.Date() - 30,
  last_date = Sys.Date(),
  do_parallel = FALSE,
  do_cache = TRUE,
  cache_folder = yf_cachefolder_get(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="yf_collection_get_+3A_collection">collection</code></td>
<td>
<p>A collection to fetch data (e.g. &quot;SP500&quot;, &quot;IBOV&quot;, &quot;FTSE&quot; ).
See function <code><a href="#topic+yf_get_available_collections">yf_get_available_collections</a></code> for finding all
available collections</p>
</td></tr>
<tr><td><code id="yf_collection_get_+3A_first_date">first_date</code></td>
<td>
<p>The first date of query (Date or character as YYYY-MM-DD)</p>
</td></tr>
<tr><td><code id="yf_collection_get_+3A_last_date">last_date</code></td>
<td>
<p>The last date of query (Date or character as YYYY-MM-DD)</p>
</td></tr>
<tr><td><code id="yf_collection_get_+3A_do_parallel">do_parallel</code></td>
<td>
<p>Flag for using parallel or not (default = FALSE).
Before using parallel, make sure you call function future::plan() first.
See &lt;https://furrr.futureverse.org/&gt; for more details.</p>
</td></tr>
<tr><td><code id="yf_collection_get_+3A_do_cache">do_cache</code></td>
<td>
<p>Use cache system? (default = TRUE)</p>
</td></tr>
<tr><td><code id="yf_collection_get_+3A_cache_folder">cache_folder</code></td>
<td>
<p>Where to save cache files?
(default = yfR::yf_cachefolder_get() )</p>
</td></tr>
<tr><td><code id="yf_collection_get_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+yf_get">yf_get</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with financial prices from collection
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

df_yf &lt;- yf_collection_get(collection = "IBOV",
                           first_date = Sys.Date() - 30,
                           last_date = Sys.Date()
)


</code></pre>

<hr>
<h2 id='yf_convert_to_wide'>Transforms a long (stacked) data frame into a list of wide data frames</h2><span id='topic+yf_convert_to_wide'></span>

<h3>Description</h3>

<p>Transforms a long (stacked) data frame into a list of wide data frames
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yf_convert_to_wide(df_in)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="yf_convert_to_wide_+3A_df_in">df_in</code></td>
<td>
<p>dataframe in the long format (probably the output of yf_get())</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with dataframes in the wide format (each element is a
different column)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
my_f &lt;- system.file("extdata/example_data_yfR.rds", package = "yfR")
df_tickers &lt;- readRDS(my_f)

print(df_tickers)

l_wide &lt;- yf_convert_to_wide(df_tickers)
l_wide
</code></pre>

<hr>
<h2 id='yf_get'>Download financial data from Yahoo Finance</h2><span id='topic+yf_get'></span>

<h3>Description</h3>

<p>Based on a ticker (id of a stock) and time period, this function will
download stock price data from Yahoo Finance and organizes it in the long
format. Yahoo Finance &lt;https://finance.yahoo.com/&gt; provides a vast repository of
stock price data around the globe. It cover a significant number of markets
and assets, being used extensively in academic research and teaching. In
the website you can lookup the ticker of a company.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yf_get(
  tickers,
  first_date = Sys.Date() - 30,
  last_date = Sys.Date(),
  thresh_bad_data = 0.75,
  bench_ticker = "^GSPC",
  type_return = "arit",
  freq_data = "daily",
  how_to_aggregate = "last",
  do_complete_data = FALSE,
  do_cache = TRUE,
  cache_folder = yf_cachefolder_get(),
  do_parallel = FALSE,
  be_quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="yf_get_+3A_tickers">tickers</code></td>
<td>
<p>A single or vector of tickers. If not sure whether the ticker is
available, search for it in YF &lt;https://finance.yahoo.com/&gt;.</p>
</td></tr>
<tr><td><code id="yf_get_+3A_first_date">first_date</code></td>
<td>
<p>The first date of query (Date or character as YYYY-MM-DD)</p>
</td></tr>
<tr><td><code id="yf_get_+3A_last_date">last_date</code></td>
<td>
<p>The last date of query (Date or character as YYYY-MM-DD)</p>
</td></tr>
<tr><td><code id="yf_get_+3A_thresh_bad_data">thresh_bad_data</code></td>
<td>
<p>A percentage threshold for defining bad data. The
dates of the benchmark ticker are compared to each asset. If the percentage
of non-missing dates with respect to the benchmark ticker is lower than
thresh_bad_data, the function will ignore the asset (default = 0.75)</p>
</td></tr>
<tr><td><code id="yf_get_+3A_bench_ticker">bench_ticker</code></td>
<td>
<p>The ticker of the benchmark asset used to compare dates.
My suggestion is to use the main stock index of the market from where the
data is coming from (default = ^GSPC (SP500, US market))</p>
</td></tr>
<tr><td><code id="yf_get_+3A_type_return">type_return</code></td>
<td>
<p>Type of price return to calculate:
'arit' - arithmetic (default), 'log' - log returns.</p>
</td></tr>
<tr><td><code id="yf_get_+3A_freq_data">freq_data</code></td>
<td>
<p>Frequency of financial data: 'daily' (default),
'weekly', 'monthly', 'yearly'</p>
</td></tr>
<tr><td><code id="yf_get_+3A_how_to_aggregate">how_to_aggregate</code></td>
<td>
<p>Defines whether to aggregate the data using the
first observations of the aggregating period or last ('first', 'last').
For example, if freq_data = 'yearly' and how_to_aggregate = 'last', the
last available day of the year will be used for all
aggregated values such as price_adjusted. (Default = &quot;last&quot;)</p>
</td></tr>
<tr><td><code id="yf_get_+3A_do_complete_data">do_complete_data</code></td>
<td>
<p>Return a complete/balanced dataset? If TRUE, all
missing pairs of ticker-date will be replaced by NA or closest price
(see input do_fill_missing_prices). Default = FALSE.</p>
</td></tr>
<tr><td><code id="yf_get_+3A_do_cache">do_cache</code></td>
<td>
<p>Use cache system? (default = TRUE)</p>
</td></tr>
<tr><td><code id="yf_get_+3A_cache_folder">cache_folder</code></td>
<td>
<p>Where to save cache files?
(default = yfR::yf_cachefolder_get() )</p>
</td></tr>
<tr><td><code id="yf_get_+3A_do_parallel">do_parallel</code></td>
<td>
<p>Flag for using parallel or not (default = FALSE).
Before using parallel, make sure you call function future::plan() first.
See &lt;https://furrr.futureverse.org/&gt; for more details.</p>
</td></tr>
<tr><td><code id="yf_get_+3A_be_quiet">be_quiet</code></td>
<td>
<p>Flag for not printing statements (default = FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the financial data for working days, when markets
are open. All price data is <strong>measured</strong> at the unit of the financial
exchange. For example, price
data for META (NYSE/US) is measures in dollars, while price data for
PETR3.SA (B3/BR) is measured in Reais (Brazilian currency).
</p>
<p>The return dataframe contains the following columns:
</p>

<dl>
<dt>ticker</dt><dd><p>The requested tickers (ids of stocks)</p>
</dd>
<dt>ref_date</dt><dd><p>The reference day (this can also be year/month/week when
using argument freq_data)</p>
</dd>
<dt>price_open</dt><dd><p>The opening price of the day/period</p>
</dd>
<dt>price_high</dt><dd><p>The highest price of the day/period</p>
</dd>
<dt>price_close</dt><dd><p>The close/last price of the day/period</p>
</dd>
<dt>volume</dt><dd><p>The financial volume of the day/period</p>
</dd>
<dt>price_adjusted</dt><dd><p>The stock price adjusted for corporate events such
as splits, dividends and others &ndash; this is usually what you want/need for
studying stocks as it represents the actual financial performance of
stockholders</p>
</dd>
<dt>ret_adjusted_prices</dt><dd><p>The arithmetic or log return (see input type_return) for
the adjusted stock prices</p>
</dd>
<dt>ret_adjusted_prices</dt><dd><p>The arithmetic or log return (see input type_return) for
the closing stock prices</p>
</dd>
<dt>cumret_adjusted_prices</dt><dd><p>The accumulated arithmetic/log return for the period (starts at 100%)</p>
</dd>
</dl>



<h3>The cache system</h3>

<p>The yfR's cache system is basically a bunch of rds files that are saved every time
data is imported from YF. It indexes all data by ticker and time period. Whenever
a user asks for a dataset, it first checks if the ticker/time period exists in
cache and, if it does, loads the data from the rds file.
</p>
<p>By default, a temporary folder is used (see function
<a href="#topic+yf_cachefolder_get">yf_cachefolder_get</a>, which means that all cache files are
session-persistent. In practice, whenever you restart your R/RStudio session,
all cache files are lost. This is a choice I've made due to the fact that
merging adjusted stock price data after corporate events (dividends/splits)
is a mess and prone to errors. This only happens for stock price data,
and not indices data.
</p>
<p>If you really need a persistent cache folder, which is Ok for indices data,
simply set a path with argument cache_folder (see warning section).
</p>


<h3>Warning</h3>

<p>Be aware that when using cache system in a local folder (and not the default
tempdir()), the aggregate prices series might not match if
a split or dividends event happens in between cache files.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

tickers &lt;- c("TSLA", "MMM")

first_date &lt;- Sys.Date() - 30
last_date &lt;- Sys.Date()

df_yf &lt;- yf_get(
  tickers = tickers,
  first_date = first_date,
  last_date = last_date
)

print(df_yf)

</code></pre>

<hr>
<h2 id='yf_get_available_collections'>Returns available collections</h2><span id='topic+yf_get_available_collections'></span>

<h3>Description</h3>

<p>Returns available collections
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yf_get_available_collections(print_description = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="yf_get_available_collections_+3A_print_description">print_description</code></td>
<td>
<p>Logical (TRUE/FALSE) - flag for printing description of
available indices/collections</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string vector with available collections
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
print(yf_get_available_collections())
</code></pre>

<hr>
<h2 id='yf_get_dividends'>Get Yahoo Finance Dividends from a single stock</h2><span id='topic+yf_get_dividends'></span>

<h3>Description</h3>

<p>This function will use the json api to retrieve dividends from Yahoo finance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yf_get_dividends(ticker, first_date = Sys.Date() - 365, last_date = Sys.Date())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="yf_get_dividends_+3A_ticker">ticker</code></td>
<td>
<p>a single ticker symbol</p>
</td></tr>
<tr><td><code id="yf_get_dividends_+3A_first_date">first_date</code></td>
<td>
<p>The first date of query (Date or character as YYYY-MM-DD)</p>
</td></tr>
<tr><td><code id="yf_get_dividends_+3A_last_date">last_date</code></td>
<td>
<p>The last date of query (Date or character as YYYY-MM-DD)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble with dividends
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yf_get_dividends(ticker = "PETR4.SA")

</code></pre>

<hr>
<h2 id='yf_index_composition'>Get current composition of stock indices</h2><span id='topic+yf_index_composition'></span>

<h3>Description</h3>

<p>Get current composition of stock indices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yf_index_composition(
  mkt_index,
  do_cache = TRUE,
  cache_folder = yf_cachefolder_get(),
  force_fallback = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="yf_index_composition_+3A_mkt_index">mkt_index</code></td>
<td>
<p>the index (e.g. IBOV, SP500, FTSE)</p>
</td></tr>
<tr><td><code id="yf_index_composition_+3A_do_cache">do_cache</code></td>
<td>
<p>Use cache system? (default = TRUE)</p>
</td></tr>
<tr><td><code id="yf_index_composition_+3A_cache_folder">cache_folder</code></td>
<td>
<p>Where to save cache files?
(default = yfR::yf_cachefolder_get() )</p>
</td></tr>
<tr><td><code id="yf_index_composition_+3A_force_fallback">force_fallback</code></td>
<td>
<p>Logical (TRUE/FALSE). Forces the function to use the
fallback system</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the index composition (column might vary)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df_sp500 &lt;- yf_index_composition("SP500")
</code></pre>

<hr>
<h2 id='yf_index_list'>Get available indices in package</h2><span id='topic+yf_index_list'></span>

<h3>Description</h3>

<p>This function will return all available market indices that are registered
in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yf_index_list(print_description = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="yf_index_list_+3A_print_description">print_description</code></td>
<td>
<p>Logical (TRUE/FALSE) - flag for printing description of
available indices/collections</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of mkt indices
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
indices &lt;- yf_index_list()
indices
</code></pre>

<hr>
<h2 id='yf_live_prices'>Yahoo Finance Live Prices</h2><span id='topic+yf_live_prices'></span>

<h3>Description</h3>

<p>This function will use the json api to retrieve live prices from Yahoo finance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yf_live_prices(ticker)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="yf_live_prices_+3A_ticker">ticker</code></td>
<td>
<p>a single ticker symbol</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble with live prices
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yfR::yf_live_prices("PETR4.SA")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
