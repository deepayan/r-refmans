<!DOCTYPE html><html lang="en"><head><title>Help for package simode</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {simode}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confint.profile.simode'><p>Calculates confidence intervals for the model parameters</p></a></li>
<li><a href='#plot_trace'><p>Plot optimization trace of a call to <code>simode</code></p></a></li>
<li><a href='#plot.confint.simode'><p>Plot confidence intervals for the model parameters</p></a></li>
<li><a href='#plot.list.simode'><p>Plot the fit/estimates of a <code>list.simode</code> object</p></a></li>
<li><a href='#plot.profile.simode'><p>Plot the likelihood profiles for the model parameters</p></a></li>
<li><a href='#plot.simode'><p>Plot the fit/estimates of a <code>simode</code> object</p></a></li>
<li><a href='#print.confint.simode'><p>Print method for <code>confint.simode</code> objects</p></a></li>
<li><a href='#print.profile.simode'><p>Print method for <code>profile.simode</code> objects</p></a></li>
<li><a href='#print.simode'><p>Print method for <code>simode</code> objects</p></a></li>
<li><a href='#print.summary.simode'><p>Print method for <code>summary.simode</code> objects</p></a></li>
<li><a href='#profile.simode'><p>Calculate likelihood profiles for the model parameters</p></a></li>
<li><a href='#simode'><p>Statistical inference of ordinary differential equations using</p>
separable integral-matching</a></li>
<li><a href='#simode.control'><p>Class containing control parameters for a call to <code>simode</code></p></a></li>
<li><a href='#sir_example'><p>Example dataset for a multi-group SIR model</p></a></li>
<li><a href='#solve_ode'><p>Ordinary differential equations solver</p></a></li>
<li><a href='#summary.list.simode'><p>Summary method for <code>list.simode</code> objects</p></a></li>
<li><a href='#summary.simode'><p>Summary method for <code>simode</code> objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Inference for Systems of Ordinary Differential
Equations using Separable Integral-Matching</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements statistical inference for systems of ordinary differential equations,
  that uses the integral-matching criterion and takes advantage of the separability of parameters,
  in order to obtain initial parameter estimates for nonlinear least squares optimization. 
  Dattner &amp; Yaari (2018) &lt;<a href="https://doi.org/10.48550/arXiv.1807.04202">doi:10.48550/arXiv.1807.04202</a>&gt;. 
  Dattner et al. (2017) &lt;<a href="https://doi.org/10.1098%2Frsif.2016.0525">doi:10.1098/rsif.2016.0525</a>&gt;.
  Dattner &amp; Klaassen (2015) &lt;<a href="https://doi.org/10.1214%2F15-EJS1053">doi:10.1214/15-EJS1053</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>deSolve, pracma, quadprog, glmnet, ncvreg,</td>
</tr>
<tr>
<td>Suggests:</td>
<td>parallel, knitr, testthat (&ge; 3.0.0), rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-16 20:32:54 UTC; ry2460</td>
</tr>
<tr>
<td>Author:</td>
<td>Itai Dattner [aut],
  Rami Yaari [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rami Yaari &lt;ramiyaari@gmail.com&gt;</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-16 20:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='confint.profile.simode'>Calculates confidence intervals for the model parameters</h2><span id='topic+confint.profile.simode'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for the model parameters,
based on the given likelihood profiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'profile.simode'
confint(object, parm = NULL, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.profile.simode_+3A_object">object</code></td>
<td>
<p>A fitted model object: <code>profile.simode</code> object returned by a call to <code><a href="stats.html#topic+profile">profile</a></code>.</p>
</td></tr>
<tr><td><code id="confint.profile.simode_+3A_parm">parm</code></td>
<td>
<p>A specification of which parameters are to be given confidence intervals (named vector).
If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="confint.profile.simode_+3A_level">level</code></td>
<td>
<p>The confidence level required.</p>
</td></tr>
<tr><td><code id="confint.profile.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The confidence intervals.
</p>

<hr>
<h2 id='plot_trace'>Plot optimization trace of a call to <code>simode</code></h2><span id='topic+plot_trace'></span>

<h3>Description</h3>

<p>Plot a trace of the loss values and parameter estimates during
the integral-matching/nonlinear least squares optimization within a call to <code>simode</code>.
For the traces to exist, the arguments <code>save_im_trace</code> and/or
<code>save_nls_trace</code> in <code><a href="#topic+simode.control">simode.control</a></code> should be set to true,
when calling <code>simode</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_trace(
  x,
  show = c("nls", "im", "both"),
  which = NULL,
  mfrow = par("mfrow"),
  cols = list(nls_fit = "blue", im_fit = "green"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_trace_+3A_x">x</code></td>
<td>
<p><code>simode</code> object returned by a call to <code><a href="#topic+simode">simode</a></code>.</p>
</td></tr>
<tr><td><code id="plot_trace_+3A_show">show</code></td>
<td>
<p>Whether to plot the estimates obtained
using nonlinear least squares ('nls'), integral-matching ('im') or both ('both').</p>
</td></tr>
<tr><td><code id="plot_trace_+3A_which">which</code></td>
<td>
<p>Which parameters' traces to plot. If NULL, the
trace for all the parameters in <code>x</code> will be plotted.</p>
</td></tr>
<tr><td><code id="plot_trace_+3A_mfrow">mfrow</code></td>
<td>
<p>A vector of the form c(nr,nc) setting the layout of
subplots in one plot (see also <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
<tr><td><code id="plot_trace_+3A_cols">cols</code></td>
<td>
<p>List of colors for each element of the plot.</p>
</td></tr>
<tr><td><code id="plot_trace_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.confint.simode'>Plot confidence intervals for the model parameters</h2><span id='topic+plot.confint.simode'></span>

<h3>Description</h3>

<p>Plot confidence intervals for the model parameters of a <code>simode</code> object,
calculated based on likelihood profiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'confint.simode'
plot(
  x,
  which = NULL,
  pars_true = NULL,
  legend = F,
  cols = list(fit = "blue", true = "black"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.confint.simode_+3A_x">x</code></td>
<td>
<p><code>confint.simode</code> object returned by a call to <code><a href="stats.html#topic+confint">confint</a></code></p>
</td></tr>
<tr><td><code id="plot.confint.simode_+3A_which">which</code></td>
<td>
<p>Which parameters to plot the confidence intervals for.
If empty, the plot will include all of the parameters in x.</p>
</td></tr>
<tr><td><code id="plot.confint.simode_+3A_pars_true">pars_true</code></td>
<td>
<p>The true parameter values (if are known).</p>
</td></tr>
<tr><td><code id="plot.confint.simode_+3A_legend">legend</code></td>
<td>
<p>Whether or not to add a figure legend.</p>
</td></tr>
<tr><td><code id="plot.confint.simode_+3A_cols">cols</code></td>
<td>
<p>List of colors for each element of the plot.</p>
</td></tr>
<tr><td><code id="plot.confint.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.list.simode'>Plot the fit/estimates of a <code>list.simode</code> object</h2><span id='topic+plot.list.simode'></span>

<h3>Description</h3>

<p>Plot the fit or parameter estimates obtained from a call to <code>simode</code>
with <code>obs_sets&gt;1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'list.simode'
plot(
  x,
  type = c("fit", "est"),
  show = c("nls", "im", "both"),
  which = NULL,
  pars_true = NULL,
  time = NULL,
  plot_mean_sd = F,
  plot_im_smooth = F,
  legend = F,
  mfrow = par("mfrow"),
  cols = list(nls_fit = "blue", im_fit = "green", true = "black", obs = "red", im_smooth
    = "magenta"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.list.simode_+3A_x">x</code></td>
<td>
<p><code>list.simode</code> object.</p>
</td></tr>
<tr><td><code id="plot.list.simode_+3A_type">type</code></td>
<td>
<p>Type of plot - 'fit' to plot the fitted equations
and 'est' to plot the parameter estimates.</p>
</td></tr>
<tr><td><code id="plot.list.simode_+3A_show">show</code></td>
<td>
<p>Whether to plot the fit/estimates obtained
using nonlinear least squares ('nls'), integral-matching ('im') or both ('both').</p>
</td></tr>
<tr><td><code id="plot.list.simode_+3A_which">which</code></td>
<td>
<p>Which variables to plot in case <code>type='fit'</code>, or which
parameters to plot in case <code>type='est'</code>. If empty, the plot will include
all of the variables/parameters in x.</p>
</td></tr>
<tr><td><code id="plot.list.simode_+3A_pars_true">pars_true</code></td>
<td>
<p>The true parameter values (if are known). Should be
named using the parameter names. If given, the true values for
the variables/parameters will be added to the plot.</p>
</td></tr>
<tr><td><code id="plot.list.simode_+3A_time">time</code></td>
<td>
<p>The time points to use for the fitted curves
(relevant only for <code>type='fit'</code>).
If not given then the time points of the observations in x will be used.</p>
</td></tr>
<tr><td><code id="plot.list.simode_+3A_plot_mean_sd">plot_mean_sd</code></td>
<td>
<p>Plot the mean and standard deviation for the fit/estimates
of the <code>simode</code> objects in <code>x</code>. To be used when <code>x</code> is the
result of fitting monte-carlo simulations.</p>
</td></tr>
<tr><td><code id="plot.list.simode_+3A_plot_im_smooth">plot_im_smooth</code></td>
<td>
<p>Whether or not to plot the smoothed curves created and
used by the integral-matching procedure (relevant only for <code>type='fit'</code>).</p>
</td></tr>
<tr><td><code id="plot.list.simode_+3A_legend">legend</code></td>
<td>
<p>Whether or not to add a figure legend.</p>
</td></tr>
<tr><td><code id="plot.list.simode_+3A_mfrow">mfrow</code></td>
<td>
<p>A vector of the form c(nr,nc) setting the layout of
subplots in one plot (see also <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
<tr><td><code id="plot.list.simode_+3A_cols">cols</code></td>
<td>
<p>List of colors for each element of the plot.</p>
</td></tr>
<tr><td><code id="plot.list.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.profile.simode'>Plot the likelihood profiles for the model parameters</h2><span id='topic+plot.profile.simode'></span>

<h3>Description</h3>

<p>Plot the likelihood profiles for the model parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'profile.simode'
plot(
  x,
  which = NULL,
  mfrow = par("mfrow"),
  cols = list(fit = "blue", threshold = "red"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.profile.simode_+3A_x">x</code></td>
<td>
<p><code>profile.simode</code> object returned by a call to <code><a href="stats.html#topic+profile">profile</a></code>.</p>
</td></tr>
<tr><td><code id="plot.profile.simode_+3A_which">which</code></td>
<td>
<p>Which parameters to plot the likelihood profiles for.
If empty, the plot will include all of the parameters in x.</p>
</td></tr>
<tr><td><code id="plot.profile.simode_+3A_mfrow">mfrow</code></td>
<td>
<p>A vector of the form c(nr,nc) setting the layout of
subplots in one plot (see also <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
<tr><td><code id="plot.profile.simode_+3A_cols">cols</code></td>
<td>
<p>List of colors for each element of the plot.</p>
</td></tr>
<tr><td><code id="plot.profile.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>

<hr>
<h2 id='plot.simode'>Plot the fit/estimates of a <code>simode</code> object</h2><span id='topic+plot.simode'></span>

<h3>Description</h3>

<p>Plot the fit or parameter estimates obtained from a call to <code>simode</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simode'
plot(
  x,
  type = c("fit", "est"),
  show = c("nls", "im", "both"),
  which = NULL,
  pars_true = NULL,
  time = NULL,
  plot_im_smooth = F,
  legend = F,
  mfrow = par("mfrow"),
  cols = list(nls_fit = "blue", im_fit = "green", true = "black", obs = "red", im_smooth
    = "magenta"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.simode_+3A_x">x</code></td>
<td>
<p><code>simode</code> object returned by a call to <code><a href="#topic+simode">simode</a></code>.</p>
</td></tr>
<tr><td><code id="plot.simode_+3A_type">type</code></td>
<td>
<p>Type of plot - 'fit' to plot the fitted variables
and 'est' to plot the parameter estimates.</p>
</td></tr>
<tr><td><code id="plot.simode_+3A_show">show</code></td>
<td>
<p>Whether to plot the fit/estimates obtained
using nonlinear least squares ('nls'), integral-matching ('im') or both ('both').</p>
</td></tr>
<tr><td><code id="plot.simode_+3A_which">which</code></td>
<td>
<p>Which variables to plot in case <code>type='fit'</code>, or which
parameters to plot in case <code>type='est'</code>. If empty, the plot will include
all of the variables/parameters in x.</p>
</td></tr>
<tr><td><code id="plot.simode_+3A_pars_true">pars_true</code></td>
<td>
<p>The true parameter values (if are known). Should be
named using the parameter names. If given, the true values for
the variables/parameters will be added to the plot.</p>
</td></tr>
<tr><td><code id="plot.simode_+3A_time">time</code></td>
<td>
<p>The time points to use for the fitted curves
(relevant only for <code>type='fit'</code>).
If not given then the time points of the observations in x will be used.</p>
</td></tr>
<tr><td><code id="plot.simode_+3A_plot_im_smooth">plot_im_smooth</code></td>
<td>
<p>Whether or not to plot the smoothed curves created and
used by the integral-matching procedure (relevant only for <code>type='fit'</code>).</p>
</td></tr>
<tr><td><code id="plot.simode_+3A_legend">legend</code></td>
<td>
<p>Whether or not to add a figure legend.</p>
</td></tr>
<tr><td><code id="plot.simode_+3A_mfrow">mfrow</code></td>
<td>
<p>A vector of the form c(nr,nc) setting the layout of
subplots in one plot (see also <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
<tr><td><code id="plot.simode_+3A_cols">cols</code></td>
<td>
<p>List of colors for each element of the plot.</p>
</td></tr>
<tr><td><code id="plot.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>

<hr>
<h2 id='print.confint.simode'>Print method for <code>confint.simode</code> objects</h2><span id='topic+print.confint.simode'></span>

<h3>Description</h3>

<p>Print method for <code>confint.simode</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'confint.simode'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.confint.simode_+3A_x">x</code></td>
<td>
<p>The <code>confint.simode</code> object.</p>
</td></tr>
<tr><td><code id="print.confint.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>

<hr>
<h2 id='print.profile.simode'>Print method for <code>profile.simode</code> objects</h2><span id='topic+print.profile.simode'></span>

<h3>Description</h3>

<p>Print method for <code>profile.simode</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'profile.simode'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.profile.simode_+3A_x">x</code></td>
<td>
<p>The <code>profile.simode</code> object.</p>
</td></tr>
<tr><td><code id="print.profile.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s)for methods.</p>
</td></tr>
</table>

<hr>
<h2 id='print.simode'>Print method for <code>simode</code> objects</h2><span id='topic+print.simode'></span>

<h3>Description</h3>

<p>Print method for <code>simode</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simode'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.simode_+3A_x">x</code></td>
<td>
<p>The <code>simode</code> object.</p>
</td></tr>
<tr><td><code id="print.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.simode'>Print method for <code>summary.simode</code> objects</h2><span id='topic+print.summary.simode'></span>

<h3>Description</h3>

<p>Print method for <code>summary.simode</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.simode'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.simode_+3A_x">x</code></td>
<td>
<p>The <code>summary.simode</code> object.</p>
</td></tr>
<tr><td><code id="print.summary.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>

<hr>
<h2 id='profile.simode'>Calculate likelihood profiles for the model parameters</h2><span id='topic+profile.simode'></span>

<h3>Description</h3>

<p>Calculate likelihood profiles for the model parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simode'
profile(
  fitted,
  which = NULL,
  optim_type = c("nls", "both"),
  step_size,
  max_steps = 100,
  alpha = 0.05,
  skip_err = T,
  trace = 0,
  save_to_log = F,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profile.simode_+3A_fitted">fitted</code></td>
<td>
<p><code>simode</code> object returned by a call to <code><a href="#topic+simode">simode</a></code>.</p>
</td></tr>
<tr><td><code id="profile.simode_+3A_which">which</code></td>
<td>
<p>Which parameters to estimate the profile for.</p>
</td></tr>
<tr><td><code id="profile.simode_+3A_optim_type">optim_type</code></td>
<td>
<p>Whether to calculate the profiles based on
maximum-likelihood optimization only ('nls') or based on integral-matching
followed by maximum-likelihood optimization ('both').</p>
</td></tr>
<tr><td><code id="profile.simode_+3A_step_size">step_size</code></td>
<td>
<p>Step size for profiling (one value for all parameters or
a value for each parameter in <code>which</code>).</p>
</td></tr>
<tr><td><code id="profile.simode_+3A_max_steps">max_steps</code></td>
<td>
<p>Maximum number of steps to take in each direction.</p>
</td></tr>
<tr><td><code id="profile.simode_+3A_alpha">alpha</code></td>
<td>
<p>Maximum (two-sided) likelihood ratio test confidence level to find.</p>
</td></tr>
<tr><td><code id="profile.simode_+3A_skip_err">skip_err</code></td>
<td>
<p>Whether on not to stop the calculation if encountering a problem
with one point in the profile.</p>
</td></tr>
<tr><td><code id="profile.simode_+3A_trace">trace</code></td>
<td>
<p>Report level (0-4), with higher values producing more tracing information.</p>
</td></tr>
<tr><td><code id="profile.simode_+3A_save_to_log">save_to_log</code></td>
<td>
<p>Whether to redirect output to log file. The log file
will be saved to tempdir().</p>
</td></tr>
<tr><td><code id="profile.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the call to <code><a href="#topic+simode">simode</a></code>, which returned the fitted object given to
this method, included a user-defined likelihood function (with the <code>calc_nll</code> argument),
then the likelihood profiles will be calculated using this function. Otherwise,
the profiles will be calculated using a likelihood based on a Gaussian distribuion
with fixed sigma, where sigma will be estimated in the background together with
the rest of the model parameters.
</p>


<h3>Value</h3>

<p>The likelihood profiles.
</p>

<hr>
<h2 id='simode'>Statistical inference of ordinary differential equations using
separable integral-matching</h2><span id='topic+simode'></span>

<h3>Description</h3>

<p>Estimating the parameters of an ODE system in two stages:
1) Estimate the parameters using separable integral-matching,
2) Estimate the parameters using nonlinear least squares
starting from the values obtained in stage 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simode(
  equations,
  pars,
  time,
  obs,
  obs_sets = 1,
  nlin_pars = NULL,
  likelihood_pars = NULL,
  fixed = NULL,
  start = NULL,
  lower = NULL,
  upper = NULL,
  im_method = c("separable", "non-separable"),
  decouple_equations = F,
  gen_obs = NULL,
  calc_nll = NULL,
  simode_ctrl = simode.control(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simode_+3A_equations">equations</code></td>
<td>
<p>Named vector. The equations describing the ODE system.
Each element of the vector should contain a character representation
of the right-hand side of an equation, and should be named according to
the left-hand side of the equation (i.e., the variable name).
An equation can contain parameters appearing in <code>pars</code>,
variables appearing in the equations names, observed non-modeled variables
appearing in <code>obs</code>, and/or any function of 't',
which is a reserved symbol for the time domain.</p>
</td></tr>
<tr><td><code id="simode_+3A_pars">pars</code></td>
<td>
<p>The names of the parameters and initial conditions
to be estimated. An initial condition name for a certain variable
is the name given to the relevant equation in <code>equations</code>
(e.g., if an equation is named 'x' than its initial condition should be named 'x'
as well). Note: The symbol 't' is reserved for the time domain and cannot be
used as a parameter name.</p>
</td></tr>
<tr><td><code id="simode_+3A_time">time</code></td>
<td>
<p>Time points of the observations. Either a vector,
if the same time points were used for observing all variables,
or a list of vectors the length of <code>obs</code>, of which each element
is the length of the relevant element in <code>obs</code>.</p>
</td></tr>
<tr><td><code id="simode_+3A_obs">obs</code></td>
<td>
<p>Named list. The observations. When <code>obs_sets=1</code>, <code>obs</code>
should contain a list of vectors with observations of either a variable described
by one of the equations (named according to the relevant equation name)
or a non-modeled variable appearing in one of the equations.
Each observations vector should be the length of the relevant time vector.
When <code>obs_sets&gt;1</code>, <code>obs</code> should contain a list,
where each list member is a list that fits the description in the case of <code>obs_sets=1</code>.</p>
</td></tr>
<tr><td><code id="simode_+3A_obs_sets">obs_sets</code></td>
<td>
<p>Number of observations sets. When <code>obs_sets&gt;1</code>, the function will
fit the set of observations according to the value of <code>obs_sets_fit</code> in <code>simode_ctrl</code>.</p>
</td></tr>
<tr><td><code id="simode_+3A_nlin_pars">nlin_pars</code></td>
<td>
<p>Names of parameters or initial conditions
that will be estimated in stage 1 using nonlinear least squares optimization.
The parameter names in <code>nlin_pars</code> must appear in <code>pars</code>.</p>
</td></tr>
<tr><td><code id="simode_+3A_likelihood_pars">likelihood_pars</code></td>
<td>
<p>Names of likelihood parameters not appearing in the ODE system,
which are needed for the the user-defined function <code>calc_nll</code>.
The parameter names in <code>likelihood_pars</code> must appear in <code>pars</code>.</p>
</td></tr>
<tr><td><code id="simode_+3A_fixed">fixed</code></td>
<td>
<p>Named vector. Fixed values for one or more of the ODE system parameters or
initial conditions. Parameters in this list will not be estimated.</p>
</td></tr>
<tr><td><code id="simode_+3A_start">start</code></td>
<td>
<p>Named vector. Starting values for optimization of parameters/initial conditions.
Must contain starting values for all the parameters in <code>nlin_pars</code>
and <code>likelihood_pars</code>. If im_method=&quot;non-seperable&quot;, can optionally contain
starting values for any other parameter/initial condition.</p>
</td></tr>
<tr><td><code id="simode_+3A_lower">lower</code></td>
<td>
<p>Named vector. Lower bounds for any parameter/initial condition.</p>
</td></tr>
<tr><td><code id="simode_+3A_upper">upper</code></td>
<td>
<p>Named vector. Upper bounds for any parameter/initial condition.</p>
</td></tr>
<tr><td><code id="simode_+3A_im_method">im_method</code></td>
<td>
<p>The method to use for integral-matching. Default &quot;separable&quot;
means that linear parameters are estimated directly while &quot;non-separable&quot;
means that linear parameters are estimated using nonlinear least squares optimization.
If none of the parameters are linear then the default can be used.</p>
</td></tr>
<tr><td><code id="simode_+3A_decouple_equations">decouple_equations</code></td>
<td>
<p>Whether to fit each equation separately
in the integral-matching stage.</p>
</td></tr>
<tr><td><code id="simode_+3A_gen_obs">gen_obs</code></td>
<td>
<p>A user-defined function for completing missing observations (see Details).</p>
</td></tr>
<tr><td><code id="simode_+3A_calc_nll">calc_nll</code></td>
<td>
<p>A user-defined function for calculating negative log-likelihood for
the model (see Details).</p>
</td></tr>
<tr><td><code id="simode_+3A_simode_ctrl">simode_ctrl</code></td>
<td>
<p>Various control parameters. See <code><a href="#topic+simode.control">simode.control</a></code>.</p>
</td></tr>
<tr><td><code id="simode_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>optim</code>, <code>gen_obs</code> and <code>calc_nll</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>gen_obs</code> can be used in cases of a partially observed system,
for which observations of the missing variables can be generated given values for the
system parameters. The function will be called during the optimization using integral-matching.<br />
It must be defined as
<code>gen_obs &lt;- function(equations, pars, x0, time, obs, ...)</code>, where:
</p>

<ul>
<li> <p><code>equations</code> the ODE equations
</p>
</li>
<li> <p><code>pars</code> the parameter values
</p>
</li>
<li> <p><code>x0</code> the initial conditions
</p>
</li>
<li> <p><code>time</code> the timing of the observations (vector or list)
</p>
</li>
<li> <p><code>obs</code> the observations
</p>
</li>
<li> <p><code>...</code> additional parameters passed from the call to <code><a href="#topic+simode">simode</a></code>
</p>
</li></ul>

<p>The function should return a list with two items:
</p>

<ul>
<li> <p><code>time</code> the vector or list of time points of the observations
</p>
</li>
<li> <p><code>obs</code> the list of observations with the newly generated observations
</p>
</li></ul>

<p><code>calc_nll</code> allows the user to pass his own likelihood function to be used in the
optimization in the second stage (if not defined, the default nonlinear least squares
optimization will be used). The likelihood function will also be used in a following
call to <code><a href="stats.html#topic+profile">profile</a></code>, for the calculation of likelihood profiles.
It must be defined as
<code>calc_nll &lt;- function(pars, time, obs, model_out, ...)</code>, where:
</p>

<ul>
<li> <p><code>pars</code> the parameter values
</p>
</li>
<li> <p><code>time</code> the timing of the observations (vector or list)
</p>
</li>
<li> <p><code>obs</code> the observations
</p>
</li>
<li> <p><code>model_out</code> the model output returned from a call to <code><a href="#topic+solve_ode">solve_ode</a></code>.
If <code>time</code> is a list with possibly different times for each variable
then <code>model_out</code> will contain a union of all these times.
</p>
</li>
<li> <p><code>...</code> additional parameters passed from the call to <code><a href="#topic+simode">simode</a></code>
</p>
</li></ul>

<p>The function should return the negative log-likelihood.
</p>


<h3>Value</h3>

<p>If <code>obs_sets=1</code>, the function returns a <code>simode</code> object containing the
parameter estimates after integral-matching (stage 1) and after
nonlinear least squares optimization (stage 2). If <code>obs_sets&gt;1</code> and
<code>obs_sets_fit!="together"</code> in <code>simode_ctrl</code>, the function
returns a <code>list.simode</code> object which is a list of <code>simode</code> objects
the length of <code>obs_sets</code>.
</p>


<h3>References</h3>

<p>Dattner &amp; Klaassen (2015). Optimal Rate of Direct Estimators in Systems of Ordinary Differential Equations Linear in Functions of the Parameters,
Electronic Journal of Statistics, Vol. 9, No. 2, 1939-1973.
</p>
<p>Dattner, Miller, Petrenko, Kadouriz, Jurkevitch &amp; Huppert (2017). Modelling and Parameter Inference of Predator-prey Dynamics in Heterogeneous Environments Using The Direct Integral Approach,
Journal of The Royal Society Interface 14.126: 20160525.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## =================================================
## Predator-Prey Lotka-Volterra model
## =================================================

## generate model equations and parameters (X=Prey,Y=Predator)
pars &lt;- c('alpha','beta','gamma','delta')
vars &lt;- c('X','Y')
eq_X &lt;- 'alpha*X-beta*X*Y'
eq_Y &lt;- 'delta*X*Y-gamma*Y'
equations &lt;- c(eq_X,eq_Y)
names(equations) &lt;- vars
x0 &lt;- c(0.9,0.9)
names(x0) &lt;- vars
theta &lt;- c(2/3,4/3,1,1)
names(theta) &lt;- pars

## generate observations
n &lt;- 50
time &lt;- seq(0,25,length.out=n)
model_out &lt;- solve_ode(equations,theta,x0,time)
x_det &lt;- model_out[,vars]
set.seed(1000)
sigma &lt;- 0.05
obs &lt;- list()
for(i in 1:length(vars)) {
  obs[[i]] &lt;- pmax(0, rnorm(n,x_det[,i],sigma))
}
names(obs) &lt;- vars

## estimate model parameters with known initial conditions
simode_fit1 &lt;- simode(equations=equations, pars=pars, fixed=x0, time=time, obs=obs)
plot(simode_fit1, type='fit', time=seq(0,25,length.out=100), pars_true=theta, mfrow=c(2,1))
plot(simode_fit1, type='est', pars_true=theta)


## estimate model parameters and initial conditions
simode_fit2 &lt;- simode(equations=equations, pars=c(pars,vars), time=time, obs=obs)
plot(simode_fit2, type='fit', time=seq(0,25,length.out=100), pars_true=c(theta,x0), mfrow=c(2,1))
plot(simode_fit2, type='est', pars_true=c(theta,x0))

profiles_fit2 &lt;- profile(simode_fit2,step_size=0.01,max_steps=50)
plot(profiles_fit2,mfrow=c(2,3))
ci_fit2 &lt;- confint(profiles_fit2)
ci_fit2
plot(ci_fit2,pars_true=c(theta,x0),legend=T)


</code></pre>

<hr>
<h2 id='simode.control'>Class containing control parameters for a call to <code>simode</code></h2><span id='topic+simode.control'></span>

<h3>Description</h3>

<p>Class containing control parameters for a call to <code>simode</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simode.control(
  optim_type = c("both", "im", "nls"),
  im_optim_method = c("BFGS", "Nelder-Mead", "CG", "L-BFGS-B", "SANN", "Brent"),
  nls_optim_method = c("BFGS", "Nelder-Mead", "CG", "L-BFGS-B", "SANN", "Brent"),
  im_optim_control = list(),
  nls_optim_control = list(),
  ode_control = list(method = "lsoda"),
  im_smoothing = c("splines", "kernel", "none"),
  im_grid_size = 0,
  bw_factor = 1.5,
  use_pars2vars_mapping = F,
  trace = 0,
  save_im_trace = F,
  save_nls_trace = F,
  obs_sets_fit = c("separate", "separate_x0", "together"),
  parallel = F,
  save_to_log = F,
  reg_alpha = -1,
  reg_pkg = c("glmnet", "ncvreg")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simode.control_+3A_optim_type">optim_type</code></td>
<td>
<p>Controls what optimization will be performed: either only
integral-matching ('im'), only nonlinear least squares ('nls') or both
(the default, i.e., first integral-matching then nonlinear least squares starting
from the integral-matching estimates).</p>
</td></tr>
<tr><td><code id="simode.control_+3A_im_optim_method">im_optim_method</code></td>
<td>
<p>Method for optimization during the integral-matching stage.
Accepted values are any method supported by the <code>method</code> argument in <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="simode.control_+3A_nls_optim_method">nls_optim_method</code></td>
<td>
<p>Method for optimization during the nonlinear least squares stage.
Accepted values are the same as in <code>im_optim_method</code>.</p>
</td></tr>
<tr><td><code id="simode.control_+3A_im_optim_control">im_optim_control</code></td>
<td>
<p>A list with control parameters for optimization during the
integral-matching stage. Can include anything that would appear in the <code>control</code> argument
in <code>optim</code> (depending on the choice of <code>im_optim_method</code>).
See <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="simode.control_+3A_nls_optim_control">nls_optim_control</code></td>
<td>
<p>Control parameters for optimization during the
nonlinear least squares stage (as in <code>im_optim_control</code>)</p>
</td></tr>
<tr><td><code id="simode.control_+3A_ode_control">ode_control</code></td>
<td>
<p>A list with control parameters for the ODE solver. Can include the argument
<code>method</code> appearing in the arguments to <code><a href="deSolve.html#topic+ode">ode</a></code>, as well as any other control parameters
accepted as additional parameters in the call to <code><a href="deSolve.html#topic+ode">ode</a></code>.</p>
</td></tr>
<tr><td><code id="simode.control_+3A_im_smoothing">im_smoothing</code></td>
<td>
<p>Choice of type of smoothing during the integral-matching stage (see Details).</p>
</td></tr>
<tr><td><code id="simode.control_+3A_im_grid_size">im_grid_size</code></td>
<td>
<p>Number of points used in integral-matching grid
(not relevant when <code>im_smoothing='kernel'</code>). Value &lt;=0 means the grid size
will be set according to maximum number of observations for any of the
equations in the call to <code>simode</code>.</p>
</td></tr>
<tr><td><code id="simode.control_+3A_bw_factor">bw_factor</code></td>
<td>
<p>Controls the bandwidth when <code>im_smoothing='kernel'</code>.
The bandwidth for each equation will be bw_factor*the maximum time interval
between two observations (should be &gt;= 1).</p>
</td></tr>
<tr><td><code id="simode.control_+3A_use_pars2vars_mapping">use_pars2vars_mapping</code></td>
<td>
<p>Whether to use pars2vars mapping (see Details).</p>
</td></tr>
<tr><td><code id="simode.control_+3A_trace">trace</code></td>
<td>
<p>Report level (0-4), with higher values producing more tracing information (see Details).</p>
</td></tr>
<tr><td><code id="simode.control_+3A_save_im_trace">save_im_trace</code></td>
<td>
<p>Whether to save trace information of integral-matching optimization,
which can then be plotted using <code><a href="#topic+plot_trace">plot_trace</a></code>.</p>
</td></tr>
<tr><td><code id="simode.control_+3A_save_nls_trace">save_nls_trace</code></td>
<td>
<p>Whether to save trace information of nonlinear least squares optimization,
which can then be plotted using <code><a href="#topic+plot_trace">plot_trace</a></code>.</p>
</td></tr>
<tr><td><code id="simode.control_+3A_obs_sets_fit">obs_sets_fit</code></td>
<td>
<p>Controls the way multiple observation sets are fitted:
either &quot;separate&quot; (each set can be fitted with its own parameter values and initial
conditions), &quot;separate_x0&quot; (same parameter values fitted for all sets while initial conditions
may be different for each set) or &quot;together&quot; (fitting the mean of all observations sets).</p>
</td></tr>
<tr><td><code id="simode.control_+3A_parallel">parallel</code></td>
<td>
<p>Controls whether to fit  sequentially or in parallel multiple observation
sets (<code>obs_sets&gt;1</code> in the call to <code><a href="#topic+simode">simode</a></code>) that are fitted separately
(<code>obs_sets_fit="separate"</code>).
Fitting in parallel requires that the parallel package will be installed.
When running in parallel, output will not be displayed regardless of the trace level.
Instead, one can set <code>save_to_log</code> to true to save the output to a log file.</p>
</td></tr>
<tr><td><code id="simode.control_+3A_save_to_log">save_to_log</code></td>
<td>
<p>Controls whether to redirect output to a log file.
If true, output will be saved to the file 'simode.log' in tempdir.</p>
</td></tr>
<tr><td><code id="simode.control_+3A_reg_alpha">reg_alpha</code></td>
<td>
<p>Value of tuning parameter alpha for regularization during the
integral-matching stage. Negative value means no regularization. A value between
0 and 1 controls the type of regularization (see <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> and
<code><a href="ncvreg.html#topic+ncvreg">ncvreg</a></code>).</p>
</td></tr>
<tr><td><code id="simode.control_+3A_reg_pkg">reg_pkg</code></td>
<td>
<p>What package to use for regularization (in case reg_alpha&gt;=0).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible values for <code>im_smoothing</code> are “splines” (the default),
in which case smoothing will be performed using <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>
with generalized cross-validation, “kernel”, using own kernel smoother function,
or “none” (using the observations as is, with interpolation if necessary).
<code>use_pars2vars_mapping</code> controls whether to use a mapping of which equations
are affected by each of the parameters. When set to true, previous matrices computed as part of
the integral-matching estimation are stored during the integral-matching optimization,
and are updated only for the equations that were affected by the change in the
parameter estimates from the previous iteration.
When the number of equations is large and some of the parameters affect only a few equations,
setting this option to true can significantly reduce the optimization time during
the integral-matching stage (while increasing the storage usage).
This is especially true with derivative based optimization methods (such as “BFGS” of optim)
which updates only one of the optimized parameters in each iteration.
<code>trace</code> has 5 possible levels:<br />
With trace=0, there would be no output displayed if there are no errors.<br />
With trace=1, a message will be displayed at the beginning and end of each optimization stage.<br />
With trace=2, non-critical errors occurring during the optimization iterations will be displayed.<br />
With trace=3, non-critical warnings occurring during the optimization iterations will be displayed.<br />
With trace=4, the calculated loss value for each iteration of the integral-matching and
nonlinear least squares optimizations will be displayed.
</p>

<hr>
<h2 id='sir_example'>Example dataset for a multi-group SIR model</h2><span id='topic+sir_example'></span>

<h3>Description</h3>

<p>A model for the spread of a seasonal influenza epidemics in two groups
over five seasons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sir_example
</code></pre>


<h3>Format</h3>

<p>A list containing the following variables:
</p>

<dl>
<dt>equations</dt><dd><p>The ODE equations describing the system, including
ten equations for the susceptible dynamics (2 groups * 5 seasons) and
ten equations for the infected dynamics.</p>
</dd>
<dt>beta</dt><dd><p>The 2x2 transmission matrix parameters (in time unit of weeks).</p>
</dd>
<dt>gamma</dt><dd><p>The recovery rate parameter (in time unit of weeks).</p>
</dd>
<dt>kappa</dt><dd><p>The relative infectiousness of seasons 2-5 compared to season 1.</p>
</dd>
<dt>S0</dt><dd><p>The initial conditions for the susceptible variables.</p>
</dd>
<dt>I0</dt><dd><p>The initial conditions for the infected variables.</p>
</dd>
<dt>time</dt><dd><p>Times in which the observations were made (in weeks).</p>
</dd>
<dt>obs</dt><dd><p>A list of observations of the infected variables,
generated using Gaussian measurement error with sigma=1e-3.</p>
</dd>
</dl>


<hr>
<h2 id='solve_ode'>Ordinary differential equations solver</h2><span id='topic+solve_ode'></span>

<h3>Description</h3>

<p>A wrapper for the <a href="deSolve.html#topic+ode">ode</a> function that solves a system of
ordinary differential equations described using symbolic equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solve_ode(equations, pars, x0, time, xvars = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="solve_ode_+3A_equations">equations</code></td>
<td>
<p>The equations describing the ODE system. See <a href="#topic+simode">simode</a>.</p>
</td></tr>
<tr><td><code id="solve_ode_+3A_pars">pars</code></td>
<td>
<p>The parameter values. Named according to their names in <code>equations</code>.</p>
</td></tr>
<tr><td><code id="solve_ode_+3A_x0">x0</code></td>
<td>
<p>The initial conditions. Named accroding to the names of <code>equations</code>.</p>
</td></tr>
<tr><td><code id="solve_ode_+3A_time">time</code></td>
<td>
<p>The time points for which the ODE variables' values will be computed.</p>
</td></tr>
<tr><td><code id="solve_ode_+3A_xvars">xvars</code></td>
<td>
<p>External observations of time-dependant variables refered to in <code>equations</code></p>
</td></tr>
<tr><td><code id="solve_ode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix whose first column contains the given time points
and subsequent columns hold the computed ODE equations' values at these time points.
</p>

<hr>
<h2 id='summary.list.simode'>Summary method for <code>list.simode</code> objects</h2><span id='topic+summary.list.simode'></span>

<h3>Description</h3>

<p>Summary method for <code>list.simode</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'list.simode'
summary(
  object,
  sum_mean_sd = F,
  pars_true = NULL,
  digits = max(3, getOption("digits") - 3),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.list.simode_+3A_object">object</code></td>
<td>
<p><code>list.simode</code> object returned by a call to <code><a href="#topic+simode">simode</a></code>
with <code>obs_sets&gt;1</code></p>
</td></tr>
<tr><td><code id="summary.list.simode_+3A_sum_mean_sd">sum_mean_sd</code></td>
<td>
<p>Whether to calculate mean and standard deviation
for the parameter estimates in the fits included in the given <code>object</code>.
To be used when <code>object</code> is the result of fitting monte-carlo simulations.</p>
</td></tr>
<tr><td><code id="summary.list.simode_+3A_pars_true">pars_true</code></td>
<td>
<p>The true parameter values (relevant only for
when <code>sum_mean_sd=T</code>). When given, the summary will also include the
bias and RMSE for each parameter estimate.</p>
</td></tr>
<tr><td><code id="summary.list.simode_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to use.</p>
</td></tr>
<tr><td><code id="summary.list.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The mean and standard deviation for the
loss values and parameter estimates obtained from the integral-matching
and nonlinear least squares optimizations. If <code>pars_true</code> is given, then
will also calculate bias and RMSE for the parameter estimates.
</p>

<hr>
<h2 id='summary.simode'>Summary method for <code>simode</code> objects</h2><span id='topic+summary.simode'></span>

<h3>Description</h3>

<p>Summary method for <code>simode</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simode'
summary(object, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.simode_+3A_object">object</code></td>
<td>
<p>The <code>simode</code> object.</p>
</td></tr>
<tr><td><code id="summary.simode_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to use.</p>
</td></tr>
<tr><td><code id="summary.simode_+3A_...">...</code></td>
<td>
<p>Additional argument(s) for methods.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
