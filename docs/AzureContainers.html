<!DOCTYPE html><html><head><title>Help for package AzureContainers</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AzureContainers}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aci'><p>Azure Container Instance class</p></a></li>
<li><a href='#aci_ports'><p>Utilities for specifying ACI configuration information</p></a></li>
<li><a href='#acr'><p>Azure Container Registry class</p></a></li>
<li><a href='#agent_pool'><p>Utility function for specifying Kubernetes agent pools</p></a></li>
<li><a href='#aks'><p>Azure Kubernetes Service class</p></a></li>
<li><a href='#aks_pools'><p>Vectorised utility function for specifying Kubernetes agent pools</p></a></li>
<li><a href='#call_docker'><p>Call the docker commandline tool</p></a></li>
<li><a href='#call_docker_compose'><p>Call the docker-compose commandline tool</p></a></li>
<li><a href='#call_helm'><p>Call the Helm commandline tool</p></a></li>
<li><a href='#call_kubectl'><p>Call the Kubernetes commandline tool, kubectl</p></a></li>
<li><a href='#create_aci'><p>Create Azure Container Instance (ACI)</p></a></li>
<li><a href='#create_acr'><p>Create Azure Container Registry (ACR)</p></a></li>
<li><a href='#create_aks'><p>Create Azure Kubernetes Service (AKS)</p></a></li>
<li><a href='#delete_aci'><p>Delete an Azure Container Instance (ACI)</p></a></li>
<li><a href='#delete_acr'><p>Delete an Azure Container Registry (ACR)</p></a></li>
<li><a href='#delete_aks'><p>Delete an Azure Kubernetes Service (AKS)</p></a></li>
<li><a href='#docker_registry'><p>Create a new Docker registry object</p></a></li>
<li><a href='#DockerRegistry'><p>Docker registry class</p></a></li>
<li><a href='#get_aci'><p>Get Azure Container Instance (ACI)</p></a></li>
<li><a href='#get_acr'><p>Get Azure Container Registry (ACR)</p></a></li>
<li><a href='#get_aks'><p>Get Azure Kubernetes Service (AKS)</p></a></li>
<li><a href='#is_acr'><p>Utility functions to test whether an object is of the given class.</p></a></li>
<li><a href='#kubernetes_cluster'><p>Create a new Kubernetes cluster object</p></a></li>
<li><a href='#KubernetesCluster'><p>Kubernetes cluster class</p></a></li>
<li><a href='#list_kubernetes_versions'><p>List available Kubernetes versions</p></a></li>
<li><a href='#list_vm_sizes'><p>List available VM sizes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Interface to 'Container Instances', 'Docker Registry' and
'Kubernetes' in 'Azure'</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>An interface to container functionality in Microsoft's 'Azure' cloud: <a href="https://azure.microsoft.com/en-us/product-categories/containers/">https://azure.microsoft.com/en-us/product-categories/containers/</a>. Manage 'Azure Container Instance' (ACI), 'Azure Container Registry' (ACR) and 'Azure Kubernetes Service' (AKS) resources, push and pull images, and deploy services. On the client side, lightweight shells to the 'docker', 'docker-compose', 'kubectl' and 'helm' commandline tools are provided. Part of the 'AzureR' family of packages.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Azure/AzureContainers">https://github.com/Azure/AzureContainers</a>
<a href="https://github.com/Azure/AzureR">https://github.com/Azure/AzureR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Azure/AzureContainers/issues">https://github.com/Azure/AzureContainers/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, AzureRMR (&ge; 2.0.0), AzureGraph (&ge; 1.1.0), openssl,
httr, R6, processx</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, uuid, MASS, bcrypt, randomForest,
plumber, RestRserve, AzureKeyVault</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-07-09 05:35:09 UTC; hongo</td>
</tr>
<tr>
<td>Author:</td>
<td>Hong Ooi [aut, cre],
  Bill Liang [ctb] (Assistance debugging MMLS on Kubernetes),
  Ramkumar Chandrasekaran [ctb] (Original blog article on Dockerising
    MMLS),
  Microsoft [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hong Ooi &lt;hongooi73@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-07-09 06:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aci'>Azure Container Instance class</h2><span id='topic+aci'></span><span id='topic+az_container_instance'></span>

<h3>Description</h3>

<p>Class representing an Azure Container Instance (ACI) resource.
</p>


<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class:
</p>

<ul>
<li> <p><code>new(...)</code>: Initialize a new ACI object.
</p>
</li>
<li> <p><code>restart()</code>, <code>start()</code>: Start a stopped container. These methods are synonyms for each other.
</p>
</li>
<li> <p><code>stop()</code>: Stop a container.
</p>
</li></ul>



<h3>Details</h3>

<p>Initializing a new object of this class can either retrieve an existing ACI resource, or create a new resource on the host. Generally, the best way to initialize an object is via the <code>get_aci</code>, <code>create_aci</code> or <code>list_acis</code> methods of the az_resource_group class, which handle the details automatically.
</p>


<h3>See Also</h3>

<p><a href="#topic+acr">acr</a>, <a href="#topic+aks">aks</a>
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/container-instances/">ACI documentation</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/container-instances/">API reference</a>
</p>
<p><a href="https://docs.docker.com/engine/reference/commandline/cli/">Docker commandline reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

myaci &lt;- rg$get_aci("mycontainer")

myaci$stop()
myaci$restart()


## End(Not run)
</code></pre>

<hr>
<h2 id='aci_ports'>Utilities for specifying ACI configuration information</h2><span id='topic+aci_ports'></span><span id='topic+aci_creds'></span><span id='topic+get_aci_credentials_list'></span>

<h3>Description</h3>

<p>Utilities for specifying ACI configuration information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aci_ports(port = c(80L, 443L), protocol = "TCP")

aci_creds(server, username = NULL, password = NULL)

get_aci_credentials_list(lst)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aci_ports_+3A_port">port</code>, <code id="aci_ports_+3A_protocol">protocol</code></td>
<td>
<p>For <code>aci_ports</code>, vectors of the port numbers and protocols to open for the instance.</p>
</td></tr>
<tr><td><code id="aci_ports_+3A_server">server</code>, <code id="aci_ports_+3A_username">username</code>, <code id="aci_ports_+3A_password">password</code></td>
<td>
<p>For <code>aci_creds</code>, the authentication details for a Docker registry. See <a href="#topic+docker_registry">docker_registry</a>.</p>
</td></tr>
<tr><td><code id="aci_ports_+3A_lst">lst</code></td>
<td>
<p>for <code>get_aci_credentials_list</code>, a list of objects.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are helper functions to be used in specifying the configuration for a container instance. Only <code>aci_ports</code> and <code>aci_creds</code> are meant to be called by the user; <code>get_aci_credentials_list</code> is exported to workaround namespacing issues on startup.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_aci">create_aci</a>, <a href="#topic+aci">aci</a>, <a href="#topic+docker_registry">docker_registry</a>
</p>

<hr>
<h2 id='acr'>Azure Container Registry class</h2><span id='topic+acr'></span><span id='topic+az_container_registry'></span>

<h3>Description</h3>

<p>Class representing an Azure Container Registry (ACR) resource. For working with the registry endpoint itself, including uploading and downloading images etc, see <a href="#topic+docker_registry">docker_registry</a>.
</p>


<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class:
</p>

<ul>
<li> <p><code>new(...)</code>: Initialize a new ACR object. See 'Details'.
</p>
</li>
<li> <p><code>add_role_assignment(principal, role, scope=NULL, ...)</code>: Adds a role for the specified principal. This is an override mainly to handle AKS objects, so that the Kubernetes cluster can be granted access to the registry. You can use the <code>...</code> arguments to supply authentication details for AzureGraph, which is used to retrieve the cluster service principal.
</p>
</li>
<li> <p><code>list_credentials</code>: Return the username and passwords for this registry. Only valid if the Admin user for the registry has been enabled.
</p>
</li>
<li> <p><code>list_policies</code>: Return the policies for this registry.
</p>
</li>
<li> <p><code>list_usages</code>: Return the usage for this registry.
</p>
</li>
<li> <p><code>get_docker_registry(username, password)</code>: Return an object representing the Docker registry endpoint.
</p>
</li></ul>



<h3>Details</h3>

<p>Initializing a new object of this class can either retrieve an existing registry resource, or create a new registry on the host. Generally, the best way to initialize an object is via the <code>get_acr</code>, <code>create_acr</code> or <code>list_acrs</code> methods of the az_resource_group class, which handle the details automatically.
</p>
<p>Note that this class is separate from the Docker registry itself. This class exposes methods for working with the Azure resource: listing credentials, updating resource tags, updating and deleting the resource, and so on.
</p>
<p>For working with the registry, including uploading and downloading images, updating tags, deleting layers and images etc, use the endpoint object generated with <code>get_docker_registry</code>. This method takes two optional arguments:
</p>

<ul>
<li> <p><code>username</code>: The username that Docker will use to authenticate with the registry.
</p>
</li>
<li> <p><code>password</code>: The password that Docker will use to authenticate with the registry.
</p>
</li></ul>

<p>By default, these arguments will be retrieved from the ACR resource. They will only exist if the resource was created with <code>admin_user_enabled=TRUE</code>. Currently AzureContainers does not support authentication methods other than a username/password combination.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_acr">create_acr</a>, <a href="#topic+get_acr">get_acr</a>, <a href="#topic+delete_acr">delete_acr</a>, <a href="#topic+list_acrs">list_acrs</a>
</p>
<p><a href="#topic+docker_registry">docker_registry</a> for interacting with the Docker registry endpoint
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/container-registry/">Azure Container Registry</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/containerregistry/registries">API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

myacr &lt;- rg$get_acr("myregistry")

myacr$list_credentials()
myacr$list_policies()

# see who has push and pull access
myacr$list_role_assignments()

# grant a Kubernetes cluster pull access
myaks &lt;- rg$get_aks("myaks")
myacr$add_role_assignment(myaks, "Acrpull")

# get the registry endpoint (for interactive use)
myacr$get_docker_registry()

# get the registry endpoint (admin user account)
myacr$get_docker_registry(as_admin=TRUE)


## End(Not run)
</code></pre>

<hr>
<h2 id='agent_pool'>Utility function for specifying Kubernetes agent pools</h2><span id='topic+agent_pool'></span>

<h3>Description</h3>

<p>Utility function for specifying Kubernetes agent pools
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agent_pool(name, count, size = "Standard_DS2_v2", os = "Linux",
  disksize = 0, use_scaleset = TRUE, low_priority = FALSE,
  autoscale_nodes = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agent_pool_+3A_name">name</code></td>
<td>
<p>The name(s) of the pool(s).</p>
</td></tr>
<tr><td><code id="agent_pool_+3A_count">count</code></td>
<td>
<p>The number of nodes per pool.</p>
</td></tr>
<tr><td><code id="agent_pool_+3A_size">size</code></td>
<td>
<p>The VM type (size) to use for the pool. To see a list of available VM sizes, use the <a href="#topic+list_vm_sizes">list_vm_sizes</a> method for the resource group or subscription classes.</p>
</td></tr>
<tr><td><code id="agent_pool_+3A_os">os</code></td>
<td>
<p>The operating system to use for the pool. Can be &quot;Linux&quot; or &quot;Windows&quot;.</p>
</td></tr>
<tr><td><code id="agent_pool_+3A_disksize">disksize</code></td>
<td>
<p>The OS disk size in gigabytes for each node in the pool. A value of 0 means to use the default disk size for the VM type.</p>
</td></tr>
<tr><td><code id="agent_pool_+3A_use_scaleset">use_scaleset</code></td>
<td>
<p>Whether to use a VM scaleset instead of individual VMs for this pool. A scaleset offers greater flexibility than individual VMs, and is the recommended method of creating an agent pool.</p>
</td></tr>
<tr><td><code id="agent_pool_+3A_low_priority">low_priority</code></td>
<td>
<p>If this pool uses a scaleset, whether it should be made up of spot (low-priority) VMs. A spot VM pool is cheaper, but is subject to being evicted to make room for other, higher-priority workloads. Ignored if <code>use_scaleset=FALSE</code>.</p>
</td></tr>
<tr><td><code id="agent_pool_+3A_autoscale_nodes">autoscale_nodes</code></td>
<td>
<p>The cluster autoscaling parameters for the pool. To enable autoscaling, set this to a vector of 2 numbers giving the minimum and maximum size of the agent pool. Ignored if <code>use_scaleset=FALSE</code>.</p>
</td></tr>
<tr><td><code id="agent_pool_+3A_...">...</code></td>
<td>
<p>Other named arguments, to be used as parameters for the agent pool.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>agent_pool</code> is a convenience function to simplify the task of specifying the agent pool for a Kubernetes cluster.
</p>


<h3>Value</h3>

<p>An object of class <code>agent_pool</code>, suitable for passing to the <code>create_aks</code> constructor method.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_aks">create_aks</a>, <a href="#topic+list_vm_sizes">list_vm_sizes</a>
</p>
<p><a href="https://docs.microsoft.com/en-us/rest/api/aks/managedclusters/createorupdate#managedclusteragentpoolprofile">Agent pool parameters on Microsoft Docs</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># pool of 5 Linux GPU-enabled VMs
agent_pool("pool1", 5, size="Standard_NC6s_v3")

# pool of 3 Windows Server VMs, 500GB disk size each
agent_pool("pool1", 3, os="Windows", disksize=500)

# enable cluster autoscaling, with a minimum of 1 and maximum of 10 nodes
agent_pool("pool1", 5, autoscale_nodes=c(1, 10))

# use individual VMs rather than scaleset
agent_pool("vmpool1", 3, use_scaleset=FALSE)

</code></pre>

<hr>
<h2 id='aks'>Azure Kubernetes Service class</h2><span id='topic+aks'></span><span id='topic+az_kubernetes_service'></span>

<h3>Description</h3>

<p>Class representing an Azure Kubernetes Service (AKS) resource. For working with the cluster endpoint itself, including deploying images, creating services etc, see <a href="#topic+kubernetes_cluster">kubernetes_cluster</a>.
</p>


<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class:
</p>

<ul>
<li> <p><code>new(...)</code>: Initialize a new AKS object.
</p>
</li>
<li> <p><code>get_cluster(config, role)</code>: Return an object representing the Docker registry endpoint.
</p>
</li>
<li> <p><code>get_agent_pool(pollname)</code>: Returns an object of class <code>az_agent_pool</code> representing an agent pool. This class inherits from <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a>; it currently has no extra methods, but these may be added in the future.
</p>
</li>
<li> <p><code>list_agent_pools()</code>: Returns a list of agent pool objects.
</p>
</li>
<li> <p><code>create_agent_pool(poolname, ..., wait=FALSE)</code>: Creates a new agent pool. See the <a href="#topic+agent_pool">agent_pool</a> function for further arguments to this method.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;delete_agent_pool(poolname, confirm=TRUE. wait=FALSE)&#8288;</code>: Deletes an agent pool.
</p>
</li>
<li> <p><code>list_cluster_resources()</code>: Returns a list of all the Azure resources managed by the cluster.
</p>
</li>
<li> <p><code>update_aad_password(name=NULL, duration=NULL, ...)</code>: Update the password for Azure Active Directory integration, returning the new password invisibly. See 'Updating credentials' below.
</p>
</li>
<li> <p><code>update_service_password(name=NULL, duration=NULL, ...)</code>: Update the password for the service principal used to manage the cluster resources, returning the new password invisibly.  See 'Updating credentials' below.
</p>
</li></ul>



<h3>Details</h3>

<p>Initializing a new object of this class can either retrieve an existing AKS resource, or create a new resource on the host. Generally, the best way to initialize an object is via the <code>get_aks</code>, <code>create_aks</code> or <code>list_aks</code> methods of the az_resource_group class, which handle the details automatically.
</p>
<p>Note that this class is separate from the Kubernetes cluster itself. This class exposes methods for working with the Azure resource: updating resource tags, updating and deleting the resource (including updating the Kubernetes version), and so on.
</p>
<p>For working with the cluster, including deploying images, services, etc use the object generated with the <code>get_cluster</code> method. This method takes two optional arguments:
</p>

<ul>
<li> <p><code>config</code>: The file in which to store the cluster configuration details. By default, this will be located in the AzureR configuration directory if it exists (see <a href="AzureAuth.html#topic+AzureR_dir">AzureAuth::AzureR_dir</a>); otherwise, in the R temporary directory. To use the Kubernetes default <code style="white-space: pre;">&#8288;~/.kube/config&#8288;</code> file, set this argument to NULL. Any existing file in the given location will be overwritten.
</p>
</li>
<li> <p><code>role</code>: This can be <code>"User"</code> (the default) or <code>"Admin"</code>.
</p>
</li></ul>



<h3>Updating credentials</h3>

<p>An AKS resource can have up to three service principals associated with it. Two of these are for Azure Active Directory (AAD) integration. The third is used to manage the subsidiary resources (VMs, networks, disks, etc) used by the cluster, if it doesn't have a service identity.
</p>
<p>Any service principals used by the AKS resource will have secret passwords, which have to be refreshed as they expire. The <code>update_aad_password()</code> and <code>update_service_password()</code> methods let you refresh the passwords for the cluster's service principals. Their arguments are:
</p>

<ul>
<li> <p><code>name</code>: An optional friendly name for the password.
</p>
</li>
<li> <p><code>duration</code>: The duration for which the new password is valid. Defaults to 2 years.
</p>
</li>
<li> <p><code>...</code>: Other arguments passed to <code>AzureGraph::create_graph_login</code>. Note that these are used to authenticate with Microsoft Graph, which does the actual work of updating the service principals, not to the cluster itself.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+create_aks">create_aks</a>, <a href="#topic+get_aks">get_aks</a>, <a href="#topic+delete_aks">delete_aks</a>, <a href="#topic+list_aks">list_aks</a>, <a href="AzureAuth.html#topic+AzureR_dir">AzureAuth::AzureR_dir</a>, <a href="AzureGraph.html#topic+graph_login">AzureGraph::create_graph_login</a>
</p>
<p><a href="#topic+kubernetes_cluster">kubernetes_cluster</a> for interacting with the cluster endpoint
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/aks/">AKS documentation</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/aks/">API reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

myaks &lt;- rg$get_aks("mycluster")

# sync with Azure: AKS resource creation can take a long time, use this to track status
myaks$sync_fields()

# get the cluster endpoint
kubclus &lt;- myaks$get_cluster()

# list of agent pools
myaks$list_agent_pools()

# create a new agent pool, then delete it
pool &lt;- myaks$create_agent_pool("pool2", 3, size="Standard_DS3_v2")
pool$delete()

# refresh the service principal password (mostly for legacy clusters without a managed identity)
myaks$update_service_password()

# refresh the service principal password, using custom credentials to authenticate with MS Graph
# arguments here are for Graph, not AKS!
myaks$update_service_password(app="app_id", password="app_password")


## End(Not run)
</code></pre>

<hr>
<h2 id='aks_pools'>Vectorised utility function for specifying Kubernetes agent pools</h2><span id='topic+aks_pools'></span>

<h3>Description</h3>

<p>Vectorised utility function for specifying Kubernetes agent pools
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aks_pools(name, count, size = "Standard_DS2_v2", os = "Linux")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aks_pools_+3A_name">name</code></td>
<td>
<p>The name(s) of the pool(s).</p>
</td></tr>
<tr><td><code id="aks_pools_+3A_count">count</code></td>
<td>
<p>The number of nodes per pool.</p>
</td></tr>
<tr><td><code id="aks_pools_+3A_size">size</code></td>
<td>
<p>The VM type (size) to use for the pool. To see a list of available VM sizes, use the <a href="#topic+list_vm_sizes">list_vm_sizes</a> method for the resource group or subscription classes.</p>
</td></tr>
<tr><td><code id="aks_pools_+3A_os">os</code></td>
<td>
<p>The operating system to use for the pool. Can be &quot;Linux&quot; or &quot;Windows&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a convenience function to simplify the task of specifying the agent pool for a Kubernetes cluster. You can specify multiple pools by providing vectors as input arguments; any scalar inputs will be replicated to match.
</p>
<p><code>aks_pools</code> is deprecated; please use <a href="#topic+agent_pool">agent_pool</a> going forward.
</p>


<h3>Value</h3>

<p>A list of lists, suitable for passing to the <code>create_aks</code> constructor method.
</p>


<h3>See Also</h3>

<p><a href="#topic+list_vm_sizes">list_vm_sizes</a>, <a href="#topic+agent_pool">agent_pool</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 1 pool of 5 Linux VMs
aks_pools("pool1", 5)

# 1 pool of 3 Windows Server VMs
aks_pools("pool1", 3, os="Windows")

# 2 pools with different VM sizes per pool
aks_pools(c("pool1", "pool2"), count=c(3, 3), size=c("Standard_DS2_v2", "Standard_DS3_v2"))

</code></pre>

<hr>
<h2 id='call_docker'>Call the docker commandline tool</h2><span id='topic+call_docker'></span>

<h3>Description</h3>

<p>Call the docker commandline tool
</p>


<h3>Usage</h3>

<pre><code class='language-R'>call_docker(cmd = "", ..., echo = getOption("azure_containers_tool_echo",
  TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="call_docker_+3A_cmd">cmd</code></td>
<td>
<p>The docker command. This should be a <em>vector</em> of individual docker arguments, but can also be a single commandline string. See below.</p>
</td></tr>
<tr><td><code id="call_docker_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to <a href="processx.html#topic+run">processx::run</a>.</p>
</td></tr>
<tr><td><code id="call_docker_+3A_echo">echo</code></td>
<td>
<p>Whether to echo the output of the command to the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls the <code>docker</code> binary, which must be located in your search path. AzureContainers will search for the binary at package startup, and print a warning if it is not found.
</p>
<p>The docker command should be specified as a vector of the individual arguments, which is what <code>processx::run</code> expects. If a single string is passed, for convenience and back-compatibility reasons <code>call_docker</code> will split it into arguments for you. This is prone to error, for example if you are working with pathnames that contain spaces, so it's strongly recommended to pass a vector of arguments as a general practice.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>status</code>: The exit status of the docker tool. If this is <code>NA</code>, then the process was killed and had no exit status.
</p>
</li>
<li> <p><code>stdout</code>: The standard output of the command, in a character scalar.
</p>
</li>
<li> <p><code>stderr</code>: The standard error of the command, in a character scalar.
</p>
</li>
<li> <p><code>timeout</code>: Whether the process was killed because of a timeout.
</p>
</li>
<li> <p><code>cmdline</code>: The command line.
</p>
</li></ul>

<p>The first four components are from <code>processx::run</code>; AzureContainers adds the last to make it easier to construct scripts that can be run outside R.
</p>


<h3>See Also</h3>

<p><a href="processx.html#topic+run">processx::run</a>, <a href="#topic+call_docker_compose">call_docker_compose</a>, <a href="#topic+call_kubectl">call_kubectl</a> for the equivalent interface to the <code>kubectl</code> Kubernetes tool
</p>
<p><a href="#topic+docker_registry">docker_registry</a>
</p>
<p><a href="https://docs.docker.com/engine/reference/commandline/cli/">Docker command line reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# without any args, prints the docker help screen
call_docker()

# build an image: recommended usage
call_docker(c("build", "-t", "myimage", "."))

# alternative usage, will be split into individual arguments
call_docker("build -t myimage .")

# list running containers
call_docker(c("container", "ls"))

# prune unused containers and images
call_docker(c("container", "prune", "-f"))
call_docker(c("image", "prune", "-f"))


## End(Not run)
</code></pre>

<hr>
<h2 id='call_docker_compose'>Call the docker-compose commandline tool</h2><span id='topic+call_docker_compose'></span>

<h3>Description</h3>

<p>Call the docker-compose commandline tool
</p>


<h3>Usage</h3>

<pre><code class='language-R'>call_docker_compose(cmd = "", ...,
  echo = getOption("azure_containers_tool_echo", TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="call_docker_compose_+3A_cmd">cmd</code></td>
<td>
<p>The docker-compose command line to execute. This should be a <em>vector</em> of individual docker-compose arguments, but can also be a single commandline string. See below.</p>
</td></tr>
<tr><td><code id="call_docker_compose_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to <a href="processx.html#topic+run">processx::run</a>.</p>
</td></tr>
<tr><td><code id="call_docker_compose_+3A_echo">echo</code></td>
<td>
<p>Whether to echo the output of the command to the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls the <code>docker-compose</code> binary, which must be located in your search path. AzureContainers will search for the binary at package startup, and print a warning if it is not found.
</p>
<p>The docker-compose command should be specified as a vector of the individual arguments, which is what <code>processx::run</code> expects. If a single string is passed, for convenience and back-compatibility reasons <code>call_docker_compose</code> will split it into arguments for you. This is prone to error, for example if you are working with pathnames that contain spaces, so it's strongly recommended to pass a vector of arguments as a general practice.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>status</code>: The exit status of the docker-compose tool. If this is <code>NA</code>, then the process was killed and had no exit status.
</p>
</li>
<li> <p><code>stdout</code>: The standard output of the command, in a character scalar.
</p>
</li>
<li> <p><code>stderr</code>: The standard error of the command, in a character scalar.
</p>
</li>
<li> <p><code>timeout</code>: Whether the process was killed because of a timeout.
</p>
</li>
<li> <p><code>cmdline</code>: The command line.
</p>
</li></ul>

<p>The first four components are from <code>processx::run</code>; AzureContainers adds the last to make it easier to construct scripts that can be run outside R.
</p>


<h3>See Also</h3>

<p><a href="processx.html#topic+run">processx::run</a>, <a href="#topic+call_docker">call_docker</a>, <a href="#topic+call_kubectl">call_kubectl</a> for the equivalent interface to the <code>kubectl</code> Kubernetes tool
</p>
<p><a href="#topic+docker_registry">docker_registry</a>
</p>
<p><a href="https://docs.docker.com/compose/">Docker-compose command line reference</a>
</p>

<hr>
<h2 id='call_helm'>Call the Helm commandline tool</h2><span id='topic+call_helm'></span>

<h3>Description</h3>

<p>Call the Helm commandline tool
</p>


<h3>Usage</h3>

<pre><code class='language-R'>call_helm(cmd = "", config = NULL, ...,
  echo = getOption("azure_containers_tool_echo", TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="call_helm_+3A_cmd">cmd</code></td>
<td>
<p>The Helm command line to execute. This should be a <em>vector</em> of individual helm arguments, but can also be a single commandline string. See below.</p>
</td></tr>
<tr><td><code id="call_helm_+3A_config">config</code></td>
<td>
<p>The pathname of the cluster config file, if required.</p>
</td></tr>
<tr><td><code id="call_helm_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to <a href="processx.html#topic+run">processx::run</a>.</p>
</td></tr>
<tr><td><code id="call_helm_+3A_echo">echo</code></td>
<td>
<p>Whether to echo the output of the command to the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls the <code>helm</code> binary, which must be located in your search path. AzureContainers will search for the binary at package startup, and print a warning if it is not found.
</p>
<p>The helm command should be specified as a vector of the individual arguments, which is what <code>processx::run</code> expects. If a single string is passed, for convenience and back-compatibility reasons <code>call_docker_compose</code> will split it into arguments for you. This is prone to error, for example if you are working with pathnames that contain spaces, so it's strongly recommended to pass a vector of arguments as a general practice.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>status</code>: The exit status of the helm tool. If this is <code>NA</code>, then the process was killed and had no exit status.
</p>
</li>
<li> <p><code>stdout</code>: The standard output of the command, in a character scalar.
</p>
</li>
<li> <p><code>stderr</code>: The standard error of the command, in a character scalar.
</p>
</li>
<li> <p><code>timeout</code>: Whether the process was killed because of a timeout.
</p>
</li>
<li> <p><code>cmdline</code>: The command line.
</p>
</li></ul>

<p>The first four components are from <code>processx::run</code>; AzureContainers adds the last to make it easier to construct scripts that can be run outside R.
</p>


<h3>See Also</h3>

<p><a href="processx.html#topic+run">processx::run</a>, <a href="#topic+call_docker">call_docker</a>, <a href="#topic+call_kubectl">call_kubectl</a>
</p>
<p><a href="#topic+kubernetes_cluster">kubernetes_cluster</a>
</p>
<p><a href="https://kubernetes.io/docs/reference/kubectl/overview/">Kubectl command line reference</a>
</p>

<hr>
<h2 id='call_kubectl'>Call the Kubernetes commandline tool, kubectl</h2><span id='topic+call_kubectl'></span>

<h3>Description</h3>

<p>Call the Kubernetes commandline tool, kubectl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>call_kubectl(cmd = "", config = NULL, ...,
  echo = getOption("azure_containers_tool_echo", TRUE))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="call_kubectl_+3A_cmd">cmd</code></td>
<td>
<p>The kubectl command line to execute. This should be a <em>vector</em> of individual kubectl arguments, but can also be a single commandline string. See below.</p>
</td></tr>
<tr><td><code id="call_kubectl_+3A_config">config</code></td>
<td>
<p>The pathname of the cluster config file, if required.</p>
</td></tr>
<tr><td><code id="call_kubectl_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to <a href="processx.html#topic+run">processx::run</a>.</p>
</td></tr>
<tr><td><code id="call_kubectl_+3A_echo">echo</code></td>
<td>
<p>Whether to echo the output of the command to the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls the <code>kubectl</code> binary, which must be located in your search path. AzureContainers will search for the binary at package startup, and print a warning if it is not found.
</p>
<p>The kubectl command should be specified as a vector of the individual arguments, which is what <code>processx::run</code> expects. If a single string is passed, for convenience and back-compatibility reasons <code>call_docker_compose</code> will split it into arguments for you. This is prone to error, for example if you are working with pathnames that contain spaces, so it's strongly recommended to pass a vector of arguments as a general practice.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li> <p><code>status</code>: The exit status of the kubectl tool. If this is <code>NA</code>, then the process was killed and had no exit status.
</p>
</li>
<li> <p><code>stdout</code>: The standard output of the command, in a character scalar.
</p>
</li>
<li> <p><code>stderr</code>: The standard error of the command, in a character scalar.
</p>
</li>
<li> <p><code>timeout</code>: Whether the process was killed because of a timeout.
</p>
</li>
<li> <p><code>cmdline</code>: The command line.
</p>
</li></ul>

<p>The first four components are from <code>processx::run</code>; AzureContainers adds the last to make it easier to construct scripts that can be run outside R.
</p>


<h3>See Also</h3>

<p><a href="processx.html#topic+run">processx::run</a>, <a href="#topic+call_docker">call_docker</a>, <a href="#topic+call_helm">call_helm</a>
</p>
<p><a href="#topic+kubernetes_cluster">kubernetes_cluster</a>
</p>
<p><a href="https://kubernetes.io/docs/reference/kubectl/overview/">Kubectl command line reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# without any args, prints the kubectl help screen
call_kubectl()

# append "--help" to get help for a command
call_kubectl(c("create", "--help"))

# deploy a service from a yaml file
call_kubectl(c("create", "-f", "deployment.yaml"))

# get deployment and service status
call_kubectl(c("get", "deployment"))
call_kubectl(c("get", "service"))


## End(Not run)
</code></pre>

<hr>
<h2 id='create_aci'>Create Azure Container Instance (ACI)</h2><span id='topic+create_aci'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>create_aci(name, location = self$location,
           container = name, image,
           registry_creds = list(),
           cores = 1, memory = 8,
           os = c("Linux", "Windows"),
           command = list(), env_vars = list(),
           ports = aci_ports(), dns_name = name, public_ip = TRUE,
           restart = c("Always", "OnFailure", "Never"), managed_identity = TRUE,
           ...)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the ACI service.
</p>
</li>
<li> <p><code>location</code>: The location/region in which to create the ACI service. Defaults to this resource group's location.
</p>
</li>
<li> <p><code>container</code>: The name of the running container.
</p>
</li>
<li> <p><code>image</code>: The name of the image to run.
</p>
</li>
<li> <p><code>registry_creds</code>: Docker registry authentication credentials, if the image is stored in a private registry. See 'Details'.
</p>
</li>
<li> <p><code>cores</code>: The number of CPU cores for the instance.
</p>
</li>
<li> <p><code>memory</code>: The memory size in GB for the instance.
</p>
</li>
<li> <p><code>os</code>: The operating system to run in the instance.
</p>
</li>
<li> <p><code>command</code>: A list of commands to run in the instance. This is similar to the <code>--entrypoint</code> commandline argument to <code style="white-space: pre;">&#8288;docker run&#8288;</code>; see <a href="https://docs.microsoft.com/en-us/azure/container-instances/container-instances-start-command">here</a> for some examples.
</p>
</li>
<li> <p><code>env_vars</code>: A list of name-value pairs to set as environment variables in the instance.
</p>
</li>
<li> <p><code>secure_env_vars</code>: A list of name-value pairs to set as <em>secure</em> environment variables in the instance. The values of these variables are not visible in the container's properties, eg when viewed in the Azure portal or via the CLI.
</p>
</li>
<li> <p><code>ports</code>: The network ports to open. By default, opens ports 80 and 443. See 'Details'.
</p>
</li>
<li> <p><code>dns_name</code>: The domain name prefix for the instance. Only takes effect if <code>public_ip=TRUE</code>.
</p>
</li>
<li> <p><code>public_ip</code>: Whether the instance should be publicly accessible.
</p>
</li>
<li> <p><code>restart</code>: Whether to restart the instance should an event occur.
</p>
</li>
<li> <p><code>managed_identity</code>: Whether to assign the container instance a managed identity.
</p>
</li>
<li> <p><code>...</code>: Other named arguments to pass to the az_resource initialization function.
</p>
</li></ul>



<h3>Details</h3>

<p>An ACI resource is a running container hosted in Azure. See the <a href="https://docs.microsoft.com/en-us/azure/container-instances/">documentation for the resource</a> for more information. Currently ACI only supports a single image in an instance.
</p>
<p>To supply the registry authentication credentials, the <code>registry_creds</code> argument should contain either an <a href="#topic+acr">ACR</a> object, a <a href="#topic+docker_registry">docker_registry</a> object, or the result of a call to the <a href="#topic+aci_creds">aci_creds</a> function.
</p>
<p>The ports to open should be obtained by calling the <a href="#topic+aci_ports">aci_ports</a> function. This takes a vector of port numbers as well as the protocol (TCP or UDP) for each port.
</p>


<h3>Value</h3>

<p>An object of class <code>az_container_instance</code> representing the instance.
</p>


<h3>See Also</h3>

<p><a href="#topic+get_aci">get_aci</a>, <a href="#topic+delete_aci">delete_aci</a>, <a href="#topic+list_acis">list_acis</a>
</p>
<p><a href="#topic+az_container_instance">az_container_instance</a>
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/container-instances/">ACI documentation</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/container-instances/">API reference</a>
</p>
<p><a href="https://docs.docker.com/engine/reference/commandline/cli/">Docker commandline reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

# get the ACR resource that contains the image
myacr &lt;- rg$get_acr("myregistry", as_admin=TRUE)

rg$create_aci("mycontainer",
    image="myregistry.azurecr.io/myimage:latest",
    registry_creds=myacr)


## End(Not run)
</code></pre>

<hr>
<h2 id='create_acr'>Create Azure Container Registry (ACR)</h2><span id='topic+create_acr'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>create_acr(name, location = self$location,
           admin_user_enabled = TRUE, sku = "Standard", ...)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the container registry.
</p>
</li>
<li> <p><code>location</code>: The location/region in which to create the container registry. Defaults to this resource group's location.
</p>
</li>
<li> <p><code>admin_user_enabled</code>: Whether to enable the Admin user. Currently this must be <code>TRUE</code> for ACI to pull from the registry.
</p>
</li>
<li> <p><code>sku</code>: Either &quot;Basic&quot;, &quot;Standard&quot; (the default) or &quot;Premium&quot;.
</p>
</li>
<li> <p><code>wait</code>: Whether to wait until the ACR resource provisioning is complete.
</p>
</li>
<li> <p><code>...</code>: Other named arguments to pass to the az_resource initialization function.
</p>
</li></ul>



<h3>Details</h3>

<p>An ACR resource is a Docker registry hosted in Azure. See the <a href="https://docs.microsoft.com/en-us/azure/container-registry/">documentation for the resource</a> for more information. To work with the registry (transfer images, retag images, etc) see the <a href="#topic+docker_registry">documentation for the registry endpoint</a>.
</p>


<h3>Value</h3>

<p>An object of class <code>az_container_registry</code> representing the registry resource.
</p>


<h3>See Also</h3>

<p><a href="#topic+get_acr">get_acr</a>, <a href="#topic+delete_acr">delete_acr</a>, <a href="#topic+list_acrs">list_acrs</a>
</p>
<p><a href="#topic+az_container_registry">az_container_registry</a>
</p>
<p><a href="#topic+docker_registry">docker_registry</a> for the registry endpoint
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/container-registry/">ACR documentation</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/containerregistry/registries">API reference</a>
</p>
<p><a href="https://docs.docker.com/registry/spec/api/">Docker registry API</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

rg$create_acr("myregistry")


## End(Not run)
</code></pre>

<hr>
<h2 id='create_aks'>Create Azure Kubernetes Service (AKS)</h2><span id='topic+create_aks'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>create_aks(name, location = self$location,
           dns_prefix = name, kubernetes_version = NULL,
           enable_rbac = FALSE, agent_pools = agent_pool("pool1", 3),
           login_user = "", login_passkey = "",
           cluster_service_principal = NULL, managed_identity = TRUE,
           private_cluster = FALSE,
           properties = list(), ..., wait = TRUE)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the Kubernetes service.
</p>
</li>
<li> <p><code>location</code>: The location/region in which to create the service. Defaults to this resource group's location.
</p>
</li>
<li> <p><code>dns_prefix</code>: The domain name prefix to use for the cluster endpoint. The actual domain name will start with this argument, followed by a string of pseudorandom characters.
</p>
</li>
<li> <p><code>kubernetes_version</code>: The Kubernetes version to use. If not specified, uses the most recent version of Kubernetes available.
</p>
</li>
<li> <p><code>enable_rbac</code>: Whether to enable Kubernetes role-based access controls (which is distinct from Azure AD RBAC).
</p>
</li>
<li> <p><code>agent_pools</code>: The pool specification(s) for the cluster. See 'Details'.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;login_user,login_passkey&#8288;</code>: Optionally, a login username and public key (on Linux). Specify these if you want to be able to ssh into the cluster nodes.
</p>
</li>
<li> <p><code>cluster_service_principal</code>: The service principal that AKS will use to manage the cluster resources. This should be a list, with the first component being the client ID and the second the client secret. If not supplied, a new service principal will be created (requires an interactive session). Ignored if <code>managed_identity=TRUE</code>, which is the default.
</p>
</li>
<li> <p><code>managed_identity</code>: Whether the cluster should have a managed identity assigned to it. If <code>FALSE</code>, a service principal will be used to manage the cluster's resources; see 'Details' below.
</p>
</li>
<li> <p><code>private_cluster</code>: Whether this cluster is private (not visible from the public Internet). A private cluster is accessible only to hosts on its virtual network.
</p>
</li>
<li> <p><code>properties</code>: A named list of further Kubernetes-specific properties to pass to the initialization function.
</p>
</li>
<li> <p><code>wait</code>: Whether to wait until the AKS resource provisioning is complete. Note that provisioning a Kubernetes cluster can take several minutes.
</p>
</li>
<li> <p><code>...</code>: Other named arguments to pass to the initialization function.
</p>
</li></ul>



<h3>Details</h3>

<p>An AKS resource is a Kubernetes cluster hosted in Azure. See the <a href="#topic+aks">documentation for the resource</a> for more information. To work with the cluster (deploy images, define and start services, etc) see the <a href="#topic+kubernetes_cluster">documentation for the cluster endpoint</a>.
</p>
<p>The nodes for an AKS cluster are organised into <em>agent pools</em>, also known as <em>node pools</em>, which are homogenous groups of virtual machines. To specify the details for a single agent pool, use the <code>agent_pool</code> function, which returns an S3 object of that class. To specify the details for multiple pools, you can supply a list of such objects, or a single call to the <code>aks_pools</code> function; see the examples below. Note that <code>aks_pools</code> is older, and does not support all the possible parameters for an agent pool.
</p>
<p>Of the agent pools in a cluster, at least one must be a <em>system pool</em>, which is used to host critical system pods such as CoreDNS and tunnelfront. If you specify more than one pool, the first pool will be treated as the system pool. Note that there are certain <a href="https://docs.microsoft.com/en-us/azure/aks/use-system-pools">extra requirements</a> for the system pool.
</p>
<p>An AKS cluster requires an identity to manage the low-level resources it uses, such as virtual machines and networks. The default and recommended method is to use a <em>managed identity</em>, in which all the details of this process are handled by AKS. In AzureContainers version 1.2.1 and older, a <em>service principal</em> was used instead, which is an older and less automated method. By setting <code>managed_identity=FALSE</code>, you can continue using a service principal instead of a managed identity.
</p>
<p>One thing to be aware of with service principals is that they have a secret password that will expire eventually. By default, the password for a newly-created service principal will expire after one year. You should run the <code>update_service_password</code> method of the AKS object to reset/update the password before it expires.
</p>


<h3>Value</h3>

<p>An object of class <code>az_kubernetes_service</code> representing the service.
</p>


<h3>See Also</h3>

<p><a href="#topic+get_aks">get_aks</a>, <a href="#topic+delete_aks">delete_aks</a>, <a href="#topic+list_aks">list_aks</a>, <a href="#topic+agent_pool">agent_pool</a>, <a href="#topic+aks_pools">aks_pools</a>
</p>
<p><a href="#topic+az_kubernetes_service">az_kubernetes_service</a>
</p>
<p><a href="#topic+kubernetes_cluster">kubernetes_cluster</a> for the cluster endpoint
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/aks/">AKS documentation</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/aks/">API reference</a>
</p>
<p><a href="https://kubernetes.io/docs/reference/">Kubernetes reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

rg$create_aks("mycluster", agent_pools=agent_pool("pool1", 5))

# GPU-enabled cluster
rg$create_aks("mygpucluster", agent_pools=agent_pool("pool1", 5, size="Standard_NC6s_v3"))

# multiple agent pools
rg$create_aks("mycluster", agent_pools=list(
    agent_pool("pool1", 2),
    agent_pool("pool2", 3, size="Standard_NC6s_v3")
))

# deprecated alternative for multiple pools
rg$create_aks("mycluster",
    agent_pools=aks_pools(c("pool1", "pool2"), c(2, 3), c("Standard_DS2_v2", "Standard_NC6s_v3")))


## End(Not run)
</code></pre>

<hr>
<h2 id='delete_aci'>Delete an Azure Container Instance (ACI)</h2><span id='topic+delete_aci'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>delete_aci(name, confirm=TRUE, wait=FALSE)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the container instance.
</p>
</li>
<li> <p><code>confirm</code>: Whether to ask for confirmation before deleting.
</p>
</li>
<li> <p><code>wait</code>: Whether to wait until the deletion is complete.
</p>
</li></ul>



<h3>Value</h3>

<p>NULL on successful deletion.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_aci">create_aci</a>, <a href="#topic+get_aci">get_aci</a>
</p>
<p><a href="#topic+az_container_instance">az_container_instance</a>
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/container-instances/">ACI documentation</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/container-instances/">API reference</a>
</p>
<p><a href="https://docs.docker.com/engine/reference/commandline/cli/">Docker commandline reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

rg$delete_aci("mycontainer")


## End(Not run)
</code></pre>

<hr>
<h2 id='delete_acr'>Delete an Azure Container Registry (ACR)</h2><span id='topic+delete_acr'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>delete_acr(name, confirm=TRUE, wait=FALSE)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the container registry.
</p>
</li>
<li> <p><code>confirm</code>: Whether to ask for confirmation before deleting.
</p>
</li>
<li> <p><code>wait</code>: Whether to wait until the deletion is complete.
</p>
</li></ul>



<h3>Value</h3>

<p>NULL on successful deletion.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_acr">create_acr</a>, <a href="#topic+get_acr">get_acr</a>
</p>
<p><a href="#topic+az_container_registry">az_container_registry</a>
</p>
<p><a href="#topic+docker_registry">docker_registry</a> for the registry endpoint
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/container-registry/">ACR documentation</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/containerregistry/registries">API reference</a>
</p>
<p><a href="https://docs.docker.com/registry/spec/api/">Docker registry API</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

rg$delete_acr("myregistry")


## End(Not run)
</code></pre>

<hr>
<h2 id='delete_aks'>Delete an Azure Kubernetes Service (AKS)</h2><span id='topic+delete_aks'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>delete_aks(name, confirm=TRUE, wait=FALSE)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: The name of the Kubernetes service.
</p>
</li>
<li> <p><code>confirm</code>: Whether to ask for confirmation before deleting.
</p>
</li>
<li> <p><code>wait</code>: Whether to wait until the deletion is complete.
</p>
</li></ul>



<h3>Value</h3>

<p>NULL on successful deletion.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_aks">create_aks</a>, <a href="#topic+get_aks">get_aks</a>
</p>
<p><a href="#topic+az_kubernetes_service">az_kubernetes_service</a>
</p>
<p><a href="#topic+kubernetes_cluster">kubernetes_cluster</a> for the cluster endpoint
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/aks/">AKS documentation</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/aks/">API reference</a>
</p>
<p><a href="https://kubernetes.io/docs/reference/">Kubernetes reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

rg$delete_aks("mycluster")


## End(Not run)
</code></pre>

<hr>
<h2 id='docker_registry'>Create a new Docker registry object</h2><span id='topic+docker_registry'></span>

<h3>Description</h3>

<p>Create a new Docker registry object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>docker_registry(server, tenant = "common", username = NULL,
  password = NULL, app = .az_cli_app_id, ..., domain = "azurecr.io",
  token = NULL, login = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="docker_registry_+3A_server">server</code></td>
<td>
<p>The registry server. This can be a URL (&quot;https://myregistry.azurecr.io&quot;) or a domain name label (&quot;myregistry&quot;); if the latter, the value of the <code>domain</code> argument is appended to obtain the full hostname.</p>
</td></tr>
<tr><td><code id="docker_registry_+3A_tenant">tenant</code>, <code id="docker_registry_+3A_username">username</code>, <code id="docker_registry_+3A_password">password</code>, <code id="docker_registry_+3A_app">app</code>, <code id="docker_registry_+3A_...">...</code></td>
<td>
<p>Authentication arguments to <a href="AzureAuth.html#topic+get_azure_token">AzureAuth::get_azure_token</a>. See 'Details' below.</p>
</td></tr>
<tr><td><code id="docker_registry_+3A_domain">domain</code></td>
<td>
<p>The default domain for the registry server.</p>
</td></tr>
<tr><td><code id="docker_registry_+3A_token">token</code></td>
<td>
<p>An OAuth token, of class <a href="AzureAuth.html#topic+AzureToken">AzureAuth::AzureToken</a>. If supplied, the authentication details for the registry will be inferred from this.</p>
</td></tr>
<tr><td><code id="docker_registry_+3A_login">login</code></td>
<td>
<p>Whether to perform a local login (requires that you have Docker installed). This is necessary if you want to push or pull images.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two ways to authenticate with an Azure Docker registry: via Azure Active Directory (AAD), or with a username and password. The latter is simpler, while the former is more complex but also more flexible and secure.
</p>
<p>The default method of authenticating is via AAD. Without any arguments, <code>docker_registry</code> will authenticate using the AAD credentials of the currently logged-in user. You can change this by supplying the appropriate arguments to <code>docker_registry</code>, which will be passed to <code>AzureAuth::get_azure_token</code>; alternatively, you can provide an existing token object.
</p>
<p>To authenticate via the admin user account, set <code>app=NULL</code> and supply the admin username and password in the corresponding arguments. Note that for this to work, the registry must have been created with the admin account enabled.
</p>
<p>Authenticating with a service principal can be done either indirectly via AAD, or via a username and password. See the examples below. The latter method is recommended, as it is both faster and allows easier interoperability with AKS and ACI.
</p>


<h3>Value</h3>

<p>An R6 object of class <code>DockerRegistry</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+DockerRegistry">DockerRegistry</a> for methods available for interacting with the registry, <a href="#topic+call_docker">call_docker</a>
</p>
<p><a href="#topic+kubernetes_cluster">kubernetes_cluster</a> for the corresponding function to create a Kubernetes cluster object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# connect to the Docker registry 'myregistry.azurecr.io', authenticating as the current user
docker_registry("myregistry")

# same, but providing a full URL
docker_registry("https://myregistry.azurecr.io")

# authenticating via the admin account
docker_registry("myregistry", username="admin", password="password", app=NULL)

# authenticating with a service principal, method 1: recommended
docker_registry("myregistry", username="app_id", password="client_creds", app=NULL)

# authenticating with a service principal, method 2
docker_registry("myregistry", app="app_id", password="client_creds")

# authenticating from a managed service identity (MSI)
token &lt;- AzureAuth::get_managed_token("https://management.azure.com/")
docker_registry("myregistry", token=token)

# you can also interact with a registry outside Azure
# note that some registry methods, and AAD authentication, may not work in this case
docker_registry("https://hub.docker.com", username="mydockerid", password="password", app=NULL)


## End(Not run)
</code></pre>

<hr>
<h2 id='DockerRegistry'>Docker registry class</h2><span id='topic+DockerRegistry'></span>

<h3>Description</h3>

<p>Class representing a <a href="https://docs.docker.com/registry/">Docker registry</a>. Note that this class can be used to interface with any Docker registry that supports the HTTP V2 API, not just those created via the Azure Container Registry service. Use the <a href="#topic+docker_registry">docker_registry</a> function to instantiate new objects of this class.
</p>


<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class:
</p>

<ul>
<li> <p><code>login(...)</code>: Do a local login to the registry via <code style="white-space: pre;">&#8288;docker login&#8288;</code>; necessary if you want to push and pull images. By default, instantiating a new object of this class will also log you in. See 'Details' below.
</p>
</li>
<li> <p><code>push(src_image, dest_image, ...)</code>: Push an image to the registry, using <code style="white-space: pre;">&#8288;docker tag&#8288;</code> and <code style="white-space: pre;">&#8288;docker push&#8288;</code>.
</p>
</li>
<li> <p><code>pull(image, ...)</code>: Pull an image from the registry, using <code style="white-space: pre;">&#8288;docker pull&#8288;</code>.
</p>
</li>
<li> <p><code>get_image_manifest(image, tag="latest")</code>: Gets the manifest for an image.
</p>
</li>
<li> <p><code>get_image_digest(image, tag="latest")</code>: Gets the digest (SHA hash) for an image.
</p>
</li>
<li> <p><code>delete_image(image, digest, confirm=TRUE)</code>: Deletes an image from the registry.
</p>
</li>
<li> <p><code>list_repositories()</code>: Lists the repositories (images) in the registry.
</p>
</li></ul>



<h3>Details</h3>

<p>The arguments to the <code>login()</code> method are:
</p>

<ul>
<li> <p><code>tenant</code>: The Azure Active Directory (AAD) tenant for the registry.
</p>
</li>
<li> <p><code>username</code>: The username that Docker will use to authenticate with the registry. This can be either the admin username, if the registry was created with an admin account, or the ID of a registered app that has access to the registry.
</p>
</li>
<li> <p><code>password</code>: The password that Docker will use to authenticate with the registry.
</p>
</li>
<li> <p><code>app</code>: The app ID to use to authenticate with the registry. Set this to NULL to authenticate with a username and password, rather than via AAD.
</p>
</li>
<li> <p><code>...</code>: Further arguments passed to <a href="AzureAuth.html#topic+get_azure_token">AzureAuth::get_azure_token</a>.
</p>
</li>
<li> <p><code>token</code>: An Azure token object. If supplied, all authentication details will be inferred from this.
</p>
</li></ul>

<p>The <code>login()</code>, <code>push()</code> and <code>pull()</code> methods for this class call the <code>docker</code> commandline tool under the hood. This allows all the features supported by Docker to be available immediately, with a minimum of effort. Any calls to the <code>docker</code> tool will also contain the full commandline as the <code>cmdline</code> attribute of the (invisible) returned value; this allows scripts to be developed that can be run outside R.
</p>


<h3>See Also</h3>

<p><a href="#topic+acr">acr</a>, <a href="#topic+docker_registry">docker_registry</a>, <a href="#topic+call_docker">call_docker</a>
</p>
<p><a href="https://docs.docker.com/engine/reference/commandline/cli/">Docker commandline reference</a>
</p>
<p><a href="https://docs.docker.com/registry/spec/api/">Docker registry API</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

reg &lt;- docker_registry("myregistry")

reg$list_repositories()

# create an image from a Dockerfile in the current directory
call_docker(c("build", "-t", "myimage", "."))

# push the image
reg$push("myimage")

reg$get_image_manifest("myimage")
reg$get_image_digest("myimage")


## End(Not run)
</code></pre>

<hr>
<h2 id='get_aci'>Get Azure Container Instance (ACI)</h2><span id='topic+get_aci'></span><span id='topic+list_acis'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>get_aci(name)
list_acis()
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: For <code>get_aci()</code>, the name of the container instance resource.
</p>
</li></ul>



<h3>Details</h3>

<p>The <code>AzureRMR::az_resource_group</code> class has both <code>get_aci()</code> and <code>list_acis()</code> methods, while the <code>AzureRMR::az_subscription</code> class only has the latter.
</p>


<h3>Value</h3>

<p>For <code>get_aci()</code>, an object of class <code>az_container_instance</code> representing the instance resource.
</p>
<p>For <code>list_acis()</code>, a list of such objects.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_aci">create_aci</a>, <a href="#topic+delete_aci">delete_aci</a>
</p>
<p><a href="#topic+az_container_instance">az_container_instance</a>
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/container-instances/">ACI documentation</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/container-instances/">API reference</a>
</p>
<p><a href="https://docs.docker.com/engine/reference/commandline/cli/">Docker commandline reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

rg$get_aci("mycontainer")


## End(Not run)
</code></pre>

<hr>
<h2 id='get_acr'>Get Azure Container Registry (ACR)</h2><span id='topic+get_acr'></span><span id='topic+list_acrs'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>get_acr(name)
list_acrs()
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: For <code>get_acr()</code>, the name of the container registry resource.
</p>
</li></ul>



<h3>Details</h3>

<p>The <code>AzureRMR::az_resource_group</code> class has both <code>get_acr()</code> and <code>list_acrs()</code> methods, while the <code>AzureRMR::az_subscription</code> class only has the latter.
</p>


<h3>Value</h3>

<p>For <code>get_acr()</code>, an object of class <code>az_container_registry</code> representing the registry resource.
</p>
<p>For <code>list_acrs()</code>, a list of such objects.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_acr">create_acr</a>, <a href="#topic+delete_acr">delete_acr</a>
</p>
<p><a href="#topic+az_container_registry">az_container_registry</a>
</p>
<p><a href="#topic+docker_registry">docker_registry</a> for the registry endpoint
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/container-registry/">ACR documentation</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/containerregistry/registries">API reference</a>
</p>
<p><a href="https://docs.docker.com/registry/spec/api/">Docker registry API</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

rg$get_acr("myregistry")


## End(Not run)
</code></pre>

<hr>
<h2 id='get_aks'>Get Azure Kubernetes Service (AKS)</h2><span id='topic+get_aks'></span><span id='topic+list_aks'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> class.
</p>


<h3>Usage</h3>

<pre>get_aks(name)
list_aks()
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>name</code>: For <code>get_aks()</code>, the name of the Kubernetes service.
</p>
</li></ul>



<h3>Details</h3>

<p>The <code>AzureRMR::az_resource_group</code> class has both <code>get_aks()</code> and <code>list_aks()</code> methods, while the <code>AzureRMR::az_subscription</code> class only has the latter.
</p>


<h3>Value</h3>

<p>For <code>get_aks()</code>, an object of class <code>az_kubernetes_service</code> representing the service.
</p>
<p>For <code>list_aks()</code>, a list of such objects.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_aks">create_aks</a>, <a href="#topic+delete_aks">delete_aks</a>
</p>
<p><a href="#topic+az_kubernetes_service">az_kubernetes_service</a>
</p>
<p><a href="#topic+kubernetes_cluster">kubernetes_cluster</a> for the cluster endpoint
</p>
<p><a href="https://docs.microsoft.com/en-us/azure/aks/">AKS documentation</a> and
<a href="https://docs.microsoft.com/en-us/rest/api/aks/">API reference</a>
</p>
<p><a href="https://kubernetes.io/docs/reference/">Kubernetes reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

rg$get_aks("mycluster")


## End(Not run)
</code></pre>

<hr>
<h2 id='is_acr'>Utility functions to test whether an object is of the given class.</h2><span id='topic+is_acr'></span><span id='topic+is_aks'></span><span id='topic+is_aci'></span><span id='topic+is_docker_registry'></span><span id='topic+is_kubernetes_cluster'></span>

<h3>Description</h3>

<p>Utility functions to test whether an object is of the given class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_acr(object)

is_aks(object)

is_aci(object)

is_docker_registry(object)

is_kubernetes_cluster(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_acr_+3A_object">object</code></td>
<td>
<p>An R object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are simple wrappers around <code>R6::is.R6</code> and <code>inherits</code>.
</p>


<h3>Value</h3>

<p>TRUE or FALSE depending on whether the object is an R6 object of the specified class.
</p>

<hr>
<h2 id='kubernetes_cluster'>Create a new Kubernetes cluster object</h2><span id='topic+kubernetes_cluster'></span>

<h3>Description</h3>

<p>Create a new Kubernetes cluster object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kubernetes_cluster(config = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kubernetes_cluster_+3A_config">config</code></td>
<td>
<p>The name of the file containing the configuration details for the cluster. This should be a YAML or JSON file in the standard Kubernetes configuration format. Set this to NULL to use the default <code style="white-space: pre;">&#8288;~/.kube/config&#8288;</code> file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use this function to instantiate a new object of the <code>KubernetesCluster</code> class, for interacting with a Kubernetes cluster.
</p>


<h3>Value</h3>

<p>An R6 object of class <code>KubernetesCluster</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+KubernetesCluster">KubernetesCluster</a> for methods for working with the cluster, <a href="#topic+call_kubectl">call_kubectl</a>, <a href="#topic+call_helm">call_helm</a>
</p>
<p><a href="#topic+docker_registry">docker_registry</a> for the corresponding function to create a Docker registry object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

kubernetes_cluster()
kubernetes_cluster("myconfig.yaml")


## End(Not run)
</code></pre>

<hr>
<h2 id='KubernetesCluster'>Kubernetes cluster class</h2><span id='topic+KubernetesCluster'></span>

<h3>Description</h3>

<p>Class representing a <a href="https://kubernetes.io/docs/home/">Kubernetes</a> cluster. Note that this class can be used to interface with any Docker registry that supports the HTTP V2 API, not just those created via the Azure Container Registry service. Use the <a href="#topic+kubernetes_cluster">kubernetes_cluster</a> function to instantiate new objects of this class.
</p>


<h3>Methods</h3>

<p>The following methods are available, in addition to those provided by the <a href="AzureRMR.html#topic+az_resource">AzureRMR::az_resource</a> class:
</p>

<ul>
<li> <p><code>new(...)</code>: Initialize a new registry object. See 'Initialization' below.
</p>
</li>
<li> <p><code>create_registry_secret(registry, secret_name, email)</code>: Provide authentication secret for a Docker registry. See 'Secrets' below.
</p>
</li>
<li> <p><code>delete_registry_secret(secret_name)</code>: Delete a registry authentication secret.
</p>
</li>
<li> <p><code>create(file, ...)</code>: Creates a deployment or service from a file, using <code style="white-space: pre;">&#8288;kubectl create -f&#8288;</code>.
</p>
</li>
<li> <p><code>get(type, ...)</code>: Get information about resources, using <code style="white-space: pre;">&#8288;kubectl get&#8288;</code>.
</p>
</li>
<li> <p><code>run(name, image, ...)</code>: Run an image using <code style="white-space: pre;">&#8288;kubectl run --image&#8288;</code>.
</p>
</li>
<li> <p><code>expose(name, type, file, ...)</code>: Expose a service using <code style="white-space: pre;">&#8288;kubectl expose&#8288;</code>. If the <code>file</code> argument is provided, read service information from there.
</p>
</li>
<li> <p><code>delete(type, name, file, ...)</code>: Delete a resource (deployment or service) using <code style="white-space: pre;">&#8288;kubectl delete&#8288;</code>. If the <code>file</code> argument is provided, read resource information from there.
</p>
</li>
<li> <p><code>apply(file, ...)</code>: Apply a configuration file, using <code style="white-space: pre;">&#8288;kubectl apply -f&#8288;</code>.
</p>
</li>
<li> <p><code>show_dashboard(port, ...)</code>: Display the cluster dashboard. By default, use local port 30000.
</p>
</li>
<li> <p><code>kubectl(cmd, ...)</code>: Run an arbitrary <code>kubectl</code> command on this cluster. Called by the other methods above.
</p>
</li>
<li> <p><code>helm(cmd, ...)</code>: Run a <code>helm</code> command on this cluster.
</p>
</li></ul>



<h3>Initialization</h3>

<p>The <code>new()</code> method takes one argument: <code>config</code>, the name of the file containing the configuration details for the cluster. This should be a YAML or JSON file in the standard Kubernetes configuration format. Set this to NULL to use the default <code style="white-space: pre;">&#8288;~/.kube/config&#8288;</code> file.
</p>


<h3>Secrets</h3>

<p>The recommended way to allow a cluster to authenticate with a Docker registry is to give its service principal the appropriate role-based access. However, you can also authenticate with a username and password. To do this, call the <code>create_registry_secret</code> method with the following arguments:
</p>

<ul>
<li> <p><code>registry</code>: An object of class either <a href="#topic+acr">acr</a> representing an Azure Container Registry service, or <a href="#topic+DockerRegistry">DockerRegistry</a> representing the registry itself.
</p>
</li>
<li> <p><code>secret_name</code>: The name to give the secret. Defaults to the name of the registry server.
</p>
</li>
<li> <p><code>email</code>: The email address for the Docker registry.
</p>
</li></ul>



<h3>Kubectl and helm</h3>

<p>The methods for this class call the <code>kubectl</code> and <code>helm</code> commandline tools, passing the <code>--config</code> option to specify the configuration information for the cluster. This allows all the features supported by Kubernetes to be available immediately and with a minimum of effort, although it does require that the tools be installed. The returned object from a call to <code>kubectl</code> or <code>helm</code> will contain the following components:
</p>

<ul>
<li> <p><code>status</code>: The exit status. If this is <code>NA</code>, then the process was killed and had no exit status.
</p>
</li>
<li> <p><code>stdout</code>: The standard output of the command, in a character scalar.
</p>
</li>
<li> <p><code>stderr</code>: The standard error of the command, in a character scalar.
</p>
</li>
<li> <p><code>timeout</code>: Whether the process was killed because of a timeout.
</p>
</li>
<li> <p><code>cmdline</code>: The command line.
</p>
</li></ul>

<p>The first four components are from <code>processx::run</code>; AzureContainers adds the last to make it easier to construct scripts that can be run outside R.
</p>


<h3>See Also</h3>

<p><a href="#topic+aks">aks</a>, <a href="#topic+call_kubectl">call_kubectl</a>, <a href="#topic+call_helm">call_helm</a>
</p>
<p><a href="https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands">Kubectl commandline reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

# get the cluster endpoint
kubclus &lt;- rg$get_aks("mycluster")$get_cluster()

# get registry authentication secret
kubclus$create_registry_secret(rg$get_acr("myregistry"))

# deploy a service
kubclus$create("deployment.yaml")

# deploy a service from an Internet URL
kubclus$create("https://example.com/deployment.yaml")

# can also supply the deployment parameters inline
kubclus$create("
apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: model1
spec:
  replicas: 1
  template:
    metadata:
      labels:
        app: model1
    spec:
      containers:
      - name: model1
        image: myregistry.azurecr.io/model1
        ports:
        - containerPort: 8000
      imagePullSecrets:
      - name: myregistry.azurecr.io
---
apiVersion: v1
kind: Service
metadata:
  name: model1-svc
spec:
  selector:
    app: model1
  type: LoadBalancer
  ports:
  - protocol: TCP
    port: 8000")

# track status
kubclus$get("deployment")
kubclus$get("service")


## End(Not run)
</code></pre>

<hr>
<h2 id='list_kubernetes_versions'>List available Kubernetes versions</h2><span id='topic+list_kubernetes_versions'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_subscription">AzureRMR::az_subscription</a> and <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> classes.
</p>


<h3>Usage</h3>

<pre>## R6 method for class 'az_subscription'
list_kubernetes_versions(location)

## R6 method for class 'az_resource_group'
list_kubernetes_versions()
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>location</code>: For the az_subscription class method, the location for which to obtain available Kubernetes versions.
</p>
</li></ul>



<h3>Value</h3>

<p>A vector of strings, which are the Kubernetes versions that can be used when creating a cluster.
</p>


<h3>See Also</h3>

<p><a href="#topic+create_aks">create_aks</a>
</p>
<p><a href="https://kubernetes.io/docs/reference/">Kubernetes reference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

rg &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")$
    get_resource_group("rgname")

rg$list_kubernetes_versions()


## End(Not run)
</code></pre>

<hr>
<h2 id='list_vm_sizes'>List available VM sizes</h2><span id='topic+list_vm_sizes'></span>

<h3>Description</h3>

<p>Method for the <a href="AzureRMR.html#topic+az_subscription">AzureRMR::az_subscription</a> and <a href="AzureRMR.html#topic+az_resource_group">AzureRMR::az_resource_group</a> classes.
</p>


<h3>Usage</h3>

<pre>## R6 method for class 'az_subscription'
list_vm_sizes(location, name_only = FALSE)

## R6 method for class 'az_resource_group'
list_vm_sizes(name_only = FALSE)
</pre>


<h3>Arguments</h3>


<ul>
<li> <p><code>location</code>: For the subscription class method, the location/region for which to obtain available VM sizes.
</p>
</li>
<li> <p><code>name_only</code>: Whether to return only a vector of names, or all information on each VM size.
</p>
</li></ul>



<h3>Value</h3>

<p>If <code>name_only</code> is TRUE, a character vector of names. If FALSE, a data frame containing the following information for each VM size: the name, number of cores, OS disk size, resource disk size, memory, and maximum data disks.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

sub &lt;- AzureRMR::get_azure_login()$
    get_subscription("subscription_id")

sub$list_vm_sizes("australiaeast")

# same output as above
rg &lt;- sub$create_resource_group("rgname", location="australiaeast")
rg$list_vm_sizes()


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
