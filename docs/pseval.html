<!DOCTYPE html><html><head><title>Help for package pseval</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pseval}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+2B.ps'><p>Modify a psdesign object by adding on new components.</p></a></li>
<li><a href='#add_bootstrap'><p>Bootstrap resampling parameters</p></a></li>
<li><a href='#add_estimate'><p>Estimate parameters</p></a></li>
<li><a href='#add_integration'><p>Integration models</p></a></li>
<li><a href='#add_riskmodel'><p>Add risk model to a psdesign object</p></a></li>
<li><a href='#calc_risk'><p>Calculate the risk and functions of the risk</p></a></li>
<li><a href='#calc_STG'><p>Calculate the Standardized total gain</p></a></li>
<li><a href='#empirical_TE'><p>Compute the empirical Treatment Efficacy</p></a></li>
<li><a href='#empirical_VE'><p>Compute the empirical Treatment Efficacy</p></a></li>
<li><a href='#expand_augdata'><p>Expand augmented data using the integration function</p></a></li>
<li><a href='#generate_example_data'><p>Generate sample data used for testing</p></a></li>
<li><a href='#integrate_bivnorm'><p>Bivariate normal integration models for the missing S(1)</p></a></li>
<li><a href='#integrate_nonparametric'><p>Nonparametric integration model for the missing S(1)</p></a></li>
<li><a href='#integrate_parametric'><p>Parametric integration model for the missing S(1)</p></a></li>
<li><a href='#integrate_semiparametric'><p>Semiparametric integration model using the location-scale model</p></a></li>
<li><a href='#plot.psdesign'><p>Plot summary statistics for a psdesign object</p></a></li>
<li><a href='#print.psdesign'><p>Concisely print information about a psdesign object</p></a></li>
<li><a href='#ps_bootstrap'><p>Estimate parameters from a specified model using bootstrap resampling and estimated maximum likelihood</p></a></li>
<li><a href='#ps_estimate'><p>Estimate parameters from a specified model using estimated maximum likelihood</p></a></li>
<li><a href='#psdesign'><p>Specify a design for a principal surrogate evaluation</p></a></li>
<li><a href='#pseudo_score'><p>Estimate parameters from a specified model using pseudo-score</p></a></li>
<li><a href='#risk_binary'><p>Risk model for binary outcome</p></a></li>
<li><a href='#risk_continuous'><p>Risk model for continuous outcome</p></a></li>
<li><a href='#risk_exponential'><p>Exponential risk model for time to event outcome</p></a></li>
<li><a href='#risk_poisson'><p>Poisson risk model for count outcomes</p></a></li>
<li><a href='#risk_weibull'><p>Weibull risk model for time to event outcome</p></a></li>
<li><a href='#risk.logit'><p>Logit link function</p></a></li>
<li><a href='#risk.probit'><p>Probit link function</p></a></li>
<li><a href='#riskcalc'><p>Calculate risks with handlers for survival data</p></a></li>
<li><a href='#sp_locscale'><p>Fit the semi-parametric location-scale model</p></a></li>
<li><a href='#stg'><p>Compute the standardized total gain</p></a></li>
<li><a href='#summarize_bs'><p>Summarize bootstrap samples</p></a></li>
<li><a href='#summary.psdesign'><p>Summary method for psdesign objects</p></a></li>
<li><a href='#TE'><p>Treatment efficacy contrast functions</p></a></li>
<li><a href='#verify_trt'><p>Check that a variable is suitable for using as binary treatment indicator</p></a></li>
<li><a href='#wem_test'><p>Test for wide effect modification</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Methods for Evaluating Principal Surrogates of Treatment
Response</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-01-10</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael C Sachs &lt;sachsmc@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains the core methods for the evaluation of principal
    surrogates in a single clinical trial. Provides a flexible interface for
    defining models for the risk given treatment and the surrogate, the models
    for integration over the missing counterfactual surrogate responses, and the
    estimation methods. Estimated maximum likelihood and pseudo-score can be used
    for estimation, and the bootstrap for inference. A variety of post-estimation
    summary methods are provided, including print, summary, plot, and testing.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, testthat, knitr, printr, rmarkdown</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-01-28 07:18:52 UTC; micsac</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael C Sachs [aut, cre],
  Erin E Gabriel [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-01-28 07:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='+2B.ps'>Modify a psdesign object by adding on new components.</h2><span id='topic++2B.ps'></span>

<h3>Description</h3>

<p>This operator allows you to add objects to a psdesign object, such as integration models and risk models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ps'
p1 + p2
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B2B.ps_+3A_p1">p1</code></td>
<td>
<p>An object of class <a href="#topic+psdesign">psdesign</a></p>
</td></tr>
<tr><td><code id="+2B2B.ps_+3A_p2">p2</code></td>
<td>
<p>Another object to be added to <code>p1</code>, see list below for possible options
</p>
<p>If the first object is an object of class <code>psdesign</code>, you can add
the following types of objects, and it will return a modified psdesign
object. Users will generally add them in the order that they appear.
</p>

<ul>
<li> <p><code>integration</code>: Add or replace integration model
</p>
</li>
<li> <p><code>riskmodel</code>: Add or replace risk model
</p>
</li>
<li> <p><code>estimate</code>: Estimate parameters
</p>
</li>
<li> <p><code>bootstrap</code>: Bootstrap estimates
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='add_bootstrap'>Bootstrap resampling parameters</h2><span id='topic+add_bootstrap'></span>

<h3>Description</h3>

<p>Bootstrap resampling parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_bootstrap(psdesign, bootstrap)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_bootstrap_+3A_psdesign">psdesign</code></td>
<td>
<p>A psdesign object, it must have risk model and integration model components</p>
</td></tr>
<tr><td><code id="add_bootstrap_+3A_bootstrap">bootstrap</code></td>
<td>
<p>A bootstrap object created by <a href="#topic+ps_bootstrap">ps_bootstrap</a></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
test &lt;- psdesign(generate_example_data(n = 100), Z = Z, Y = Y.obs, S = S.obs, BIP = BIP)
est1 &lt;- test + integrate_parametric(S.1 ~ BIP) + risk_binary() + ps_estimate(method = "BFGS")
est1 + ps_bootstrap(method = "BFGS", start = est1$estimates$par, n.boots = 50)

## End(Not run)
</code></pre>

<hr>
<h2 id='add_estimate'>Estimate parameters</h2><span id='topic+add_estimate'></span>

<h3>Description</h3>

<p>Estimate parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_estimate(psdesign, estimate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_estimate_+3A_psdesign">psdesign</code></td>
<td>
<p>A psdesign object, it must have risk model and integration model components</p>
</td></tr>
<tr><td><code id="add_estimate_+3A_estimate">estimate</code></td>
<td>
<p>An estimate object created by <a href="#topic+ps_estimate">ps_estimate</a></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>test &lt;- psdesign(generate_example_data(n = 100), Z = Z, Y = Y.obs, S = S.obs, BIP = BIP)
test + integrate_parametric(S.1 ~ BIP) + risk_binary(D = 50) + ps_estimate(method = "BFGS")
</code></pre>

<hr>
<h2 id='add_integration'>Integration models</h2><span id='topic+add_integration'></span>

<h3>Description</h3>

<p>Add integration model to a psdesign object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_integration(psdesign, integration)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_integration_+3A_psdesign">psdesign</code></td>
<td>
<p>A psdesign object</p>
</td></tr>
<tr><td><code id="add_integration_+3A_integration">integration</code></td>
<td>
<p>An integration object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a list of the available integration models. The fundamental problem in surrogate evaluation is that there are unobserved values of the counterfactual surrogate responses S(1). In the estimated maximum likelihood framework, for subjects missing the S(1) values, we use an auxiliary pre-treatment variable or set of variables W that is observed for every subject to estimate the distribution of S(1) | W. Typically, this W is a BIP. Then for each missing S(1), we integrate likelihood contributions over each non-missing S(1) given their value of W, and average over the contributions.
</p>

<ul>
<li> <p><a href="#topic+integrate_parametric">integrate_parametric</a> This is a parametric integration model that fits a linear model for the mean of S(1) | W and assumes a Gaussian distribution.
</p>
</li>
<li> <p><a href="#topic+integrate_bivnorm">integrate_bivnorm</a> This is another parametric integration model that assumes that S(1) and W are jointly normally distributed. The user must specify their mean, variances and correlation.
</p>
</li>
<li> <p><a href="#topic+integrate_nonparametric">integrate_nonparametric</a> This is a non-parametric integration model that is only valid for categorical S(1) and W. It uses the observed proportions to estimate the joint distribution of S(1), W.
</p>
</li>
<li> <p><a href="#topic+integrate_semiparametric">integrate_semiparametric</a> This is a semi-parametric model that uses the semi-parametric location scale model of Heagerty and Pepe (1999). Models are specified for the location of S(1) | W and the scale of S(1) | W. Then integrations are drawn from the empirical distribution of the residuals from that model, which are then transformed to the appropriate location and scale.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
test &lt;- psdesign(generate_example_data(n = 100), Z = Z, Y = Y.obs, S = S.obs, BIP = BIP)
add_integration(test, integrate_parametric(S.1 ~ BIP))
test + integrate_parametric(S.1 ~ BIP)  # same as above

</code></pre>

<hr>
<h2 id='add_riskmodel'>Add risk model to a psdesign object</h2><span id='topic+add_riskmodel'></span>

<h3>Description</h3>

<p>Add risk model to a psdesign object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_riskmodel(psdesign, riskmodel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_riskmodel_+3A_psdesign">psdesign</code></td>
<td>
<p>A psdesign object</p>
</td></tr>
<tr><td><code id="add_riskmodel_+3A_riskmodel">riskmodel</code></td>
<td>
<p>A risk model object, from the list above</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The risk model component specifies the likelihood for the data. This involves specifying the distribution of the outcome variable, whether it is binary or time-to-event, and specifying how the surrogate S(1) and the treatment Z interact and affect the outcome. We use the formula notation to be consistent with other regression type models in R. Below is a list of available risk models.
</p>

<ul>
<li> <p><a href="#topic+risk_binary">risk_binary</a> This is a generic risk model for binary outcomes. The user can specify the formula, and link function using either <a href="#topic+risk.logit">risk.logit</a> for the logistic link, or <a href="#topic+risk.probit">risk.probit</a> for the probit link. Custom link functions may also be specified, which take a single numeric vector argument, and returns a vector of corresponding probabilities.
</p>
</li>
<li> <p><a href="#topic+risk_weibull">risk_weibull</a> This is a parameterization of the Weibull model for time-to-event outcomes that is consistent with that of <a href="stats.html#topic+rweibull">rweibull</a>. The user specifies the formula for the linear predictor of the scale parameter.
</p>
</li>
<li> <p><a href="#topic+risk_exponential">risk_exponential</a> This is a simple exponential model for a time-to-event outcome.
</p>
</li>
<li> <p><a href="#topic+risk_poisson">risk_poisson</a> This is a Poisson model for count outcomes. It allows for offsets in the formula.
</p>
</li>
<li> <p><a href="#topic+risk_continuous">risk_continuous</a> This is a Gaussian model for continuous outcomes. It assumes that larger values of the outcome are harmful (e.g. blood pressure)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>test &lt;- psdesign(generate_example_data(n = 100), Z = Z, Y = Y.obs, S = S.obs, BIP = BIP) +
     integrate_parametric(S.1 ~ BIP)
add_riskmodel(test, risk_binary())
test + risk_binary() # same as above
</code></pre>

<hr>
<h2 id='calc_risk'>Calculate the risk and functions of the risk</h2><span id='topic+calc_risk'></span>

<h3>Description</h3>

<p>Computes the treatment efficacy (TE) and other functions of the risk in each
treatment arm over the range of surrogate values observed in the data. TE(s)
is defined as 1 - risk(s, z = 1)/risk(s, z = 0), where z is the treatment
indicator. If any other variables are present in the risk model, then the
risk is computed at their median value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_risk(psdesign, contrast = "TE", t, sig.level = 0.05,
  CI.type = "band", n.samps = 5000, bootstraps = TRUE,
  newdata = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_risk_+3A_psdesign">psdesign</code></td>
<td>
<p>A psdesign object. It must contain a risk model, an
integration model, and estimated parameters. Bootstrapped parameters are
optional</p>
</td></tr>
<tr><td><code id="calc_risk_+3A_contrast">contrast</code></td>
<td>
<p>The contrast function, or the name of the contrast function.
See details.</p>
</td></tr>
<tr><td><code id="calc_risk_+3A_t">t</code></td>
<td>
<p>For time to event outcomes, a fixed time <code>t</code> may be provided to
compute the cumulative distribution function. If not, the restricted mean
survival time is used. Omit for binary outcomes.</p>
</td></tr>
<tr><td><code id="calc_risk_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level for bootstrap confidence intervals</p>
</td></tr>
<tr><td><code id="calc_risk_+3A_ci.type">CI.type</code></td>
<td>
<p>Character string, &quot;pointwise&quot; for pointwise confidence
intervals, and &quot;band&quot; for simultaneous confidence band.</p>
</td></tr>
<tr><td><code id="calc_risk_+3A_n.samps">n.samps</code></td>
<td>
<p>The number of samples to take over the range of S.1 at which
the contrast is calculated</p>
</td></tr>
<tr><td><code id="calc_risk_+3A_bootstraps">bootstraps</code></td>
<td>
<p>If true, and bootstrapped estimates are present, will
calculate bootstrap standard errors and confidence bands.</p>
</td></tr>
<tr><td><code id="calc_risk_+3A_newdata">newdata</code></td>
<td>
<p>Vector of S values. If present, will calculate the contrast
function at values of newdata instead of the observed S.1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The contrast function is a function that takes 2 inputs, the risk_0
and risk_1, and returns some one dimensional function of those two inputs.
It must be vectorized. Some built-in functions are <code>"TE"</code> for treatment
efficacy = 1 - risk_1(s)/risk_0(s), <code>"RR"</code> for relative risk =
risk_1(s)/risk_0(s), <code>"logRR"</code> for log of the relative risk, and
<code>"RD"</code> for the risk difference = risk_1(s) - risk_0(s).
</p>


<h3>Value</h3>

<p>A data frame containing columns for the S values, the computed
contrast function at S, R0, and R1 at those S values, and optionally
standard errors and confidence intervals computed using bootstrapped
estimates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# same result passing function name or function
calc_risk(binary.boot, contrast = "TE", n.samps = 20)
calc_risk(binary.boot, contrast = function(R0, R1) 1 - R1/R0, n.samps = 20)

## End(Not run)
</code></pre>

<hr>
<h2 id='calc_STG'>Calculate the Standardized total gain</h2><span id='topic+calc_STG'></span>

<h3>Description</h3>

<p>Computes the standardized total gain for the risk difference. Optionally produces bootstrap standard errors and confidence intervals. The standardized total gain is the area between the risk difference curve and the horizontal line at the marginal risk difference. If the outcome is time to event then the STG is time-dependent, and a time point for evaluation is needed. If one is not provided then the restricted mean survival is estimated from the data and used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_STG(psdesign, t, sig.level = 0.05, n.samps = 5000,
  bootstraps = TRUE, permute = TRUE, permute.times = 2000,
  progress.bar = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_STG_+3A_psdesign">psdesign</code></td>
<td>
<p>A psdesign object. It must contain a risk model, an
integration model, and estimated parameters. Bootstrapped parameters are
optional</p>
</td></tr>
<tr><td><code id="calc_STG_+3A_t">t</code></td>
<td>
<p>For time to event outcomes, a fixed time <code>t</code> may be provided to
compute the cumulative distribution function. If not, the restricted mean
survival time is used. Omit for binary outcomes.</p>
</td></tr>
<tr><td><code id="calc_STG_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level for bootstrap confidence intervals</p>
</td></tr>
<tr><td><code id="calc_STG_+3A_n.samps">n.samps</code></td>
<td>
<p>The number of samples to take over the range of S.1 at which
the VE is calculated</p>
</td></tr>
<tr><td><code id="calc_STG_+3A_bootstraps">bootstraps</code></td>
<td>
<p>If true, and bootstrapped estimates are present, will
calculate bootstrap standard errors and confidence interval.</p>
</td></tr>
<tr><td><code id="calc_STG_+3A_permute">permute</code></td>
<td>
<p>Not used, included for backwards compatibility</p>
</td></tr>
<tr><td><code id="calc_STG_+3A_permute.times">permute.times</code></td>
<td>
<p>Not used, included for backwards compatibility</p>
</td></tr>
<tr><td><code id="calc_STG_+3A_progress.bar">progress.bar</code></td>
<td>
<p>Not used, included for backwards compatibility</p>
</td></tr>
</table>

<hr>
<h2 id='empirical_TE'>Compute the empirical Treatment Efficacy</h2><span id='topic+empirical_TE'></span>

<h3>Description</h3>

<p>Compute the empirical Treatment Efficacy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>empirical_TE(psdesign, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="empirical_TE_+3A_psdesign">psdesign</code></td>
<td>
<p>An object of class <a href="#topic+psdesign">psdesign</a></p>
</td></tr>
<tr><td><code id="empirical_TE_+3A_t">t</code></td>
<td>
<p>Fixed time for time to event outcomes to compute TE. If missing, uses restricted mean survival.</p>
</td></tr>
</table>

<hr>
<h2 id='empirical_VE'>Compute the empirical Treatment Efficacy</h2><span id='topic+empirical_VE'></span>

<h3>Description</h3>

<p>Included for backwards compatibility
</p>


<h3>Usage</h3>

<pre><code class='language-R'>empirical_VE(psdesign, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="empirical_VE_+3A_psdesign">psdesign</code></td>
<td>
<p>An object of class <a href="#topic+psdesign">psdesign</a></p>
</td></tr>
<tr><td><code id="empirical_VE_+3A_t">t</code></td>
<td>
<p>Fixed time for time to event outcomes to compute TE. If missing, uses restricted mean survival.</p>
</td></tr>
</table>

<hr>
<h2 id='expand_augdata'>Expand augmented data using the integration function</h2><span id='topic+expand_augdata'></span>

<h3>Description</h3>

<p>Expand augmented data using the integration function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand_augdata(model, psdesign, D = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand_augdata_+3A_model">model</code></td>
<td>
<p>Formula defining the risk model</p>
</td></tr>
<tr><td><code id="expand_augdata_+3A_psdesign">psdesign</code></td>
<td>
<p>An object of class <a href="#topic+psdesign">psdesign</a>, that contains at least 1 integration model</p>
</td></tr>
<tr><td><code id="expand_augdata_+3A_d">D</code></td>
<td>
<p>The number of samples to take for the simulated annealing</p>
</td></tr>
</table>

<hr>
<h2 id='generate_example_data'>Generate sample data used for testing</h2><span id='topic+generate_example_data'></span>

<h3>Description</h3>

<p>Generate sample data used for testing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_example_data(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate_example_data_+3A_n">n</code></td>
<td>
<p>Integer, the sample size</p>
</td></tr>
</table>

<hr>
<h2 id='integrate_bivnorm'>Bivariate normal integration models for the missing S(1)</h2><span id='topic+integrate_bivnorm'></span>

<h3>Description</h3>

<p>This model assumes that the pair [S(1), W] is bivariate normal, where W is
the BIP. The means, standard deviations, and correlation are estimated or
fixed before calling this function. Then the conditional normal formula is
applied in order to get the distribution of S(1) | W. That distribution is
used to integrate over the missing S(1) values. This method requires a BIP in the
design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate_bivnorm(x = "S.1", mu = c(0, 0), sd = c(1, 1), rho = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integrate_bivnorm_+3A_x">x</code></td>
<td>
<p>expression identifying the variable to be integrated. Typically this is S.1 or S.0</p>
</td></tr>
<tr><td><code id="integrate_bivnorm_+3A_mu">mu</code></td>
<td>
<p>means of the pair of surrogates, missing one first</p>
</td></tr>
<tr><td><code id="integrate_bivnorm_+3A_sd">sd</code></td>
<td>
<p>standard deviations of the pair, missing one first</p>
</td></tr>
<tr><td><code id="integrate_bivnorm_+3A_rho">rho</code></td>
<td>
<p>the correlation between X1 and X2</p>
</td></tr>
</table>

<hr>
<h2 id='integrate_nonparametric'>Nonparametric integration model for the missing S(1)</h2><span id='topic+integrate_nonparametric'></span>

<h3>Description</h3>

<p>Both S(1) and the BIP or set of BIPs must be categorical. This model integrates over the estimated distribution of S(1) | BIP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate_nonparametric(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integrate_nonparametric_+3A_formula">formula</code></td>
<td>
<p>Formula specifying the integration model for the surrogate
under treatment. Generally the candidate surrogate will be on the left side
in the formula, and the BIP or BIPs will be on the right side. In this case
the BIP and the S(1) must be categorical.</p>
</td></tr>
<tr><td><code id="integrate_nonparametric_+3A_...">...</code></td>
<td>
<p>Not currently used</p>
</td></tr>
</table>

<hr>
<h2 id='integrate_parametric'>Parametric integration model for the missing S(1)</h2><span id='topic+integrate_parametric'></span>

<h3>Description</h3>

<p>Parametric integration model for the missing S(1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate_parametric(formula, family = gaussian, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integrate_parametric_+3A_formula">formula</code></td>
<td>
<p>Formula specifying the integration model for the surrogate
under treatment. Generally the candidate surrogate will be on the left side
in the formula, and the BIP or BIPs will be on the right side</p>
</td></tr>
<tr><td><code id="integrate_parametric_+3A_family">family</code></td>
<td>
<p>Assumed distribution for the integration model. Must be
compatible with the <code>family</code> argument of <a href="stats.html#topic+glm">glm</a>. Currently only
Gaussian models are supported</p>
</td></tr>
<tr><td><code id="integrate_parametric_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="stats.html#topic+glm">glm</a></p>
</td></tr>
</table>

<hr>
<h2 id='integrate_semiparametric'>Semiparametric integration model using the location-scale model</h2><span id='topic+integrate_semiparametric'></span>

<h3>Description</h3>

<p>Semiparametric integration model using the location-scale model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate_semiparametric(formula.location, formula.scale, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integrate_semiparametric_+3A_formula.location">formula.location</code></td>
<td>
<p>Formula specifying the integration model for the location component of the surrogate
under treatment. Generally the candidate surrogate will be on the left side
in the formula, and the BIP or BIPs will be on the right side</p>
</td></tr>
<tr><td><code id="integrate_semiparametric_+3A_formula.scale">formula.scale</code></td>
<td>
<p>Formula specifying the integration model for the scale component of the surrogate
under treatment. Generally the candidate surrogate will be on the left side
in the formula, and the BIP or BIPs will be on the right side</p>
</td></tr>
<tr><td><code id="integrate_semiparametric_+3A_...">...</code></td>
<td>
<p>Other parameters passed to <a href="#topic+sp_locscale">sp_locscale</a></p>
</td></tr>
</table>

<hr>
<h2 id='plot.psdesign'>Plot summary statistics for a psdesign object</h2><span id='topic+plot.psdesign'></span>

<h3>Description</h3>

<p>Plot the treatment efficacy or another contrast of risk versus S.1 for an
estimated psdesign object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psdesign'
plot(x, t, contrast = "TE", sig.level = 0.05,
  CI.type = "band", n.samps = 500, xlab = "S.1", ylab = contrast,
  col = 1, lty = 1, lwd = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.psdesign_+3A_x">x</code></td>
<td>
<p>A <a href="#topic+psdesign">psdesign</a> object that contains a risk model, integration
model, and valid estimates</p>
</td></tr>
<tr><td><code id="plot.psdesign_+3A_t">t</code></td>
<td>
<p>For time to event outcomes, a fixed time <code>t</code> may be provided to
compute the cumulative distribution function. If not, the restricted mean
survival time is used. Omit for binary outcomes.</p>
</td></tr>
<tr><td><code id="plot.psdesign_+3A_contrast">contrast</code></td>
<td>
<p>Name of contrast function to plot. <code>"TE"</code> or <code>"VE"</code> for treatment (vaccine)
efficacy = 1 - risk_1(s)/risk_0(s), <code>"RR"</code> for relative risk =
risk_1(s)/risk_0(s), <code>"logRR"</code> for log of the relative risk,
<code>"risk"</code> for the risk in each treatment arm, and <code>"RD"</code> for the
risk difference = risk_1(s) - risk_0(s). You can also pass a custom
function directly as long as it takes 2 vectors as input (risk0 and risk1)
and returns 1 vector of the same length.</p>
</td></tr>
<tr><td><code id="plot.psdesign_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level used for confidence bands on the contrast
curve. This is only used if bootstrapped estimates are available.</p>
</td></tr>
<tr><td><code id="plot.psdesign_+3A_ci.type">CI.type</code></td>
<td>
<p>Character string, &quot;pointwise&quot; for pointwise confidence
intervals, and &quot;band&quot; for simultaneous confidence band.</p>
</td></tr>
<tr><td><code id="plot.psdesign_+3A_n.samps">n.samps</code></td>
<td>
<p>Number of samples to use over the range of S.1 for plotting
the curve</p>
</td></tr>
<tr><td><code id="plot.psdesign_+3A_xlab">xlab</code></td>
<td>
<p>X-axis label</p>
</td></tr>
<tr><td><code id="plot.psdesign_+3A_ylab">ylab</code></td>
<td>
<p>Y-axis label</p>
</td></tr>
<tr><td><code id="plot.psdesign_+3A_col">col</code></td>
<td>
<p>Vector of integers specifying colors for each curve.</p>
</td></tr>
<tr><td><code id="plot.psdesign_+3A_lty">lty</code></td>
<td>
<p>Vector of integers specifying linetypes for each curve.</p>
</td></tr>
<tr><td><code id="plot.psdesign_+3A_lwd">lwd</code></td>
<td>
<p>Vector of numeric values for line widths.</p>
</td></tr>
<tr><td><code id="plot.psdesign_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <a href="base.html#topic+plot">plot</a></p>
</td></tr>
</table>

<hr>
<h2 id='print.psdesign'>Concisely print information about a psdesign object</h2><span id='topic+print.psdesign'></span>

<h3>Description</h3>

<p>Concisely print information about a psdesign object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psdesign'
print(x, digits = 3, sig.level = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.psdesign_+3A_x">x</code></td>
<td>
<p>An object of class <a href="#topic+psdesign">psdesign</a></p>
</td></tr>
<tr><td><code id="print.psdesign_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to display</p>
</td></tr>
<tr><td><code id="print.psdesign_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level to use for computing bootstrapped confidence intervals</p>
</td></tr>
<tr><td><code id="print.psdesign_+3A_...">...</code></td>
<td>
<p>Currently unused</p>
</td></tr>
</table>

<hr>
<h2 id='ps_bootstrap'>Estimate parameters from a specified model using bootstrap resampling and estimated maximum likelihood</h2><span id='topic+ps_bootstrap'></span>

<h3>Description</h3>

<p>Estimate parameters from a specified model using bootstrap resampling and estimated maximum likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ps_bootstrap(n.boots = 200, progress.bar = TRUE, start = NULL,
  method = "BFGS", control = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ps_bootstrap_+3A_n.boots">n.boots</code></td>
<td>
<p>Number of bootstrap replicates</p>
</td></tr>
<tr><td><code id="ps_bootstrap_+3A_progress.bar">progress.bar</code></td>
<td>
<p>Logical, if true will display a progress bar in the console</p>
</td></tr>
<tr><td><code id="ps_bootstrap_+3A_start">start</code></td>
<td>
<p>Vector of starting values, if NULL, will come up with starting values</p>
</td></tr>
<tr><td><code id="ps_bootstrap_+3A_method">method</code></td>
<td>
<p>Method to use for optimization, can be &quot;pseudo-score&quot; for
categorical S with nonparametric integration, or any of the methods
available in <a href="stats.html#topic+optim">optim</a>. Defaults to &quot;BFGS&quot;</p>
</td></tr>
<tr><td><code id="ps_bootstrap_+3A_control">control</code></td>
<td>
<p>List of control parameters for passed to <a href="stats.html#topic+optim">optim</a></p>
</td></tr>
<tr><td><code id="ps_bootstrap_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="stats.html#topic+optim">optim</a></p>
</td></tr>
</table>

<hr>
<h2 id='ps_estimate'>Estimate parameters from a specified model using estimated maximum likelihood</h2><span id='topic+ps_estimate'></span>

<h3>Description</h3>

<p>Estimate parameters from a specified model using estimated maximum likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ps_estimate(start = NULL, method = "BFGS", control = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ps_estimate_+3A_start">start</code></td>
<td>
<p>Vector of starting values, if NULL, will come up with starting
values</p>
</td></tr>
<tr><td><code id="ps_estimate_+3A_method">method</code></td>
<td>
<p>Method to use for optimization, can be &quot;pseudo-score&quot; for
categorical BIP, or any of the methods
available in <a href="stats.html#topic+optim">optim</a>. Defaults to &quot;BFGS&quot;</p>
</td></tr>
<tr><td><code id="ps_estimate_+3A_control">control</code></td>
<td>
<p>List of control parameters for passed to <a href="stats.html#topic+optim">optim</a></p>
</td></tr>
<tr><td><code id="ps_estimate_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="stats.html#topic+optim">optim</a> or <a href="#topic+pseudo_score">pseudo_score</a>.</p>
</td></tr>
</table>

<hr>
<h2 id='psdesign'>Specify a design for a principal surrogate evaluation</h2><span id='topic+psdesign'></span>

<h3>Description</h3>

<p>Generate mappings that describe how variables in the data are mapped to
components of the principal surrogate analysis. Other than <code>data</code>, this
is a list of key-value pairs describing the common elements of a ps analysis.
The required keys are Z, Y, and S. Optional keys are BIP, CPV, BSM, and
weights. These elements are described in details below. Additional keys-value
pairs can be included in <code>...</code>. This function generates an augmented
dataset and additional information for subsequent steps in the analysis. In
the subsequent steps, refer to the variables by the keys. See
<a href="#topic+add_integration">add_integration</a> and <a href="#topic+add_riskmodel">add_riskmodel</a> for information on how to
proceed in the analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psdesign(data, Z, Y, S, BIP = NULL, CPV = NULL, BSM = NULL,
  weights = NULL, tau, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psdesign_+3A_data">data</code></td>
<td>
<p>Data frame containing data to be analyzed</p>
</td></tr>
<tr><td><code id="psdesign_+3A_z">Z</code></td>
<td>
<p>Expression defining the treatment variable which has 2 levels</p>
</td></tr>
<tr><td><code id="psdesign_+3A_y">Y</code></td>
<td>
<p>Expression defining the outcome variable. For binary events this
should be coded as 0/1 or a factor with 2 levels. For censored
time-to-event outcomes this can be a call to <a href="survival.html#topic+Surv">Surv</a></p>
</td></tr>
<tr><td><code id="psdesign_+3A_s">S</code></td>
<td>
<p>Expression defining the candidate surrogate</p>
</td></tr>
<tr><td><code id="psdesign_+3A_bip">BIP</code></td>
<td>
<p>Optional expression defining the baseline irrelevant predictor</p>
</td></tr>
<tr><td><code id="psdesign_+3A_cpv">CPV</code></td>
<td>
<p>Optional expression defining the closeout placebo vaccination
measurement</p>
</td></tr>
<tr><td><code id="psdesign_+3A_bsm">BSM</code></td>
<td>
<p>Optional expression defining the baseline surrogate measurement</p>
</td></tr>
<tr><td><code id="psdesign_+3A_weights">weights</code></td>
<td>
<p>optional expression defining weights to accommodate nonrandom
subsampling, such as case control or two phase</p>
</td></tr>
<tr><td><code id="psdesign_+3A_tau">tau</code></td>
<td>
<p>numeric, When the outcome Y is a survival time, it is possible
that the surrogate was measured at some time tau after enrollment. Use the
argument tau to specify the time when the surrogate was measured, in study
time. Not required for binary Y.</p>
</td></tr>
<tr><td><code id="psdesign_+3A_...">...</code></td>
<td>
<p>Other key-value pairs that will be included in the augmented data,
e.g. additional candidate surrogates, covariates for adjustment, variables
used for integration</p>
</td></tr>
</table>

<hr>
<h2 id='pseudo_score'>Estimate parameters from a specified model using pseudo-score</h2><span id='topic+pseudo_score'></span>

<h3>Description</h3>

<p>Estimate parameters from a specified model using pseudo-score
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudo_score(psdesign, start = NULL, epsilon = 1e-05, maxit = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pseudo_score_+3A_psdesign">psdesign</code></td>
<td>
<p>An object of class psdesign</p>
</td></tr>
<tr><td><code id="pseudo_score_+3A_start">start</code></td>
<td>
<p>Vector of starting values, if NULL, will come up with starting values</p>
</td></tr>
<tr><td><code id="pseudo_score_+3A_epsilon">epsilon</code></td>
<td>
<p>Convergence criteria</p>
</td></tr>
<tr><td><code id="pseudo_score_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
</table>

<hr>
<h2 id='risk_binary'>Risk model for binary outcome</h2><span id='topic+risk_binary'></span>

<h3>Description</h3>

<p>Risk model for binary outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>risk_binary(model = Y ~ S.1 * Z, D = 5000, risk = risk.logit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="risk_binary_+3A_model">model</code></td>
<td>
<p>Formula specifying the risk model</p>
</td></tr>
<tr><td><code id="risk_binary_+3A_d">D</code></td>
<td>
<p>number of samples for the simulated annealing integration</p>
</td></tr>
<tr><td><code id="risk_binary_+3A_risk">risk</code></td>
<td>
<p>Function for transforming a linear predictor into a probability.
E.g., risk.logit for the logistic model, risk.probit for the probit model</p>
</td></tr>
</table>

<hr>
<h2 id='risk_continuous'>Risk model for continuous outcome</h2><span id='topic+risk_continuous'></span>

<h3>Description</h3>

<p>This model assumes that the outcome Y is normally distributed conditional on
S.1 and Z, with mean determined by the model formula. It also assumes that
larger values of Y are more indicative of poor outcomes, e.g., blood
pressure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>risk_continuous(model = Y ~ S.1 * Z, D = 5000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="risk_continuous_+3A_model">model</code></td>
<td>
<p>Formula specifying the risk model for the mean</p>
</td></tr>
<tr><td><code id="risk_continuous_+3A_d">D</code></td>
<td>
<p>number of samples for the simulated annealing integration</p>
</td></tr>
</table>

<hr>
<h2 id='risk_exponential'>Exponential risk model for time to event outcome</h2><span id='topic+risk_exponential'></span>

<h3>Description</h3>

<p>Exponential risk model for time to event outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>risk_exponential(model = Y ~ S.1 * Z, D = 5000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="risk_exponential_+3A_model">model</code></td>
<td>
<p>Formula specifying the risk model. The outcome should be a <a href="survival.html#topic+Surv">Surv</a> object specifying right censoring</p>
</td></tr>
<tr><td><code id="risk_exponential_+3A_d">D</code></td>
<td>
<p>number of samples for simulated annealing</p>
</td></tr>
</table>

<hr>
<h2 id='risk_poisson'>Poisson risk model for count outcomes</h2><span id='topic+risk_poisson'></span>

<h3>Description</h3>

<p>Poisson risk model for count outcomes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>risk_poisson(model = Y ~ S.1 * Z, D = 5000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="risk_poisson_+3A_model">model</code></td>
<td>
<p>Formula specifying the risk model. The outcome should be an integer of counts. This right side of the formula may contain an <a href="stats.html#topic+offset">offset</a> term.</p>
</td></tr>
<tr><td><code id="risk_poisson_+3A_d">D</code></td>
<td>
<p>number of samples for simulated annealing</p>
</td></tr>
</table>

<hr>
<h2 id='risk_weibull'>Weibull risk model for time to event outcome</h2><span id='topic+risk_weibull'></span>

<h3>Description</h3>

<p>Weibull risk model for time to event outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>risk_weibull(model = Y ~ S.1 * Z, D = 5000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="risk_weibull_+3A_model">model</code></td>
<td>
<p>Formula specifying the risk model. The outcome should be a <a href="survival.html#topic+Surv">Surv</a> object specifying right censoring</p>
</td></tr>
<tr><td><code id="risk_weibull_+3A_d">D</code></td>
<td>
<p>number of samples for simulated annealing</p>
</td></tr>
</table>

<hr>
<h2 id='risk.logit'>Logit link function</h2><span id='topic+risk.logit'></span>

<h3>Description</h3>

<p>Logit link function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>risk.logit(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="risk.logit_+3A_x">x</code></td>
<td>
<p>A vector of linear predictors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of probabilities
</p>

<hr>
<h2 id='risk.probit'>Probit link function</h2><span id='topic+risk.probit'></span>

<h3>Description</h3>

<p>Probit link function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>risk.probit(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="risk.probit_+3A_x">x</code></td>
<td>
<p>A vector of linear predictors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of probabilities
</p>

<hr>
<h2 id='riskcalc'>Calculate risks with handlers for survival data</h2><span id='topic+riskcalc'></span>

<h3>Description</h3>

<p>Calculate risks with handlers for survival data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>riskcalc(risk.function, Y, par, t, dat0, dat1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="riskcalc_+3A_risk.function">risk.function</code></td>
<td>
<p>Function taking three arguments, a data.frame, parameters, and time. It should return a vector the same number of rows as the data frame</p>
</td></tr>
<tr><td><code id="riskcalc_+3A_y">Y</code></td>
<td>
<p>The outcome variable</p>
</td></tr>
<tr><td><code id="riskcalc_+3A_par">par</code></td>
<td>
<p>the vector of parameter values</p>
</td></tr>
<tr><td><code id="riskcalc_+3A_t">t</code></td>
<td>
<p>Time for a survival outcome, may be missing</p>
</td></tr>
<tr><td><code id="riskcalc_+3A_dat0">dat0</code></td>
<td>
<p>Data frame containing S and Z = 1</p>
</td></tr>
<tr><td><code id="riskcalc_+3A_dat1">dat1</code></td>
<td>
<p>Data frame containing S and Z = 0</p>
</td></tr>
</table>

<hr>
<h2 id='sp_locscale'>Fit the semi-parametric location-scale model</h2><span id='topic+sp_locscale'></span>

<h3>Description</h3>

<p>This estimates the location-scale model as described in Heagerty and Pepe (1999) using the Newton-Raphson method. The location and scale formulas must have the same outcome, but they may have different predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sp_locscale(formula.location, formula.scale, data, weights, tol = 1e-06,
  maxit = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sp_locscale_+3A_formula.location">formula.location</code></td>
<td>
<p>Formula specifying the model for the location</p>
</td></tr>
<tr><td><code id="sp_locscale_+3A_formula.scale">formula.scale</code></td>
<td>
<p>Formula specifying the model for the scale</p>
</td></tr>
<tr><td><code id="sp_locscale_+3A_data">data</code></td>
<td>
<p>Data used to estimate the model</p>
</td></tr>
<tr><td><code id="sp_locscale_+3A_weights">weights</code></td>
<td>
<p>Weights applied to the estimating equations</p>
</td></tr>
<tr><td><code id="sp_locscale_+3A_tol">tol</code></td>
<td>
<p>Convergence tolerance</p>
</td></tr>
<tr><td><code id="sp_locscale_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the parameter estimates, the convergence indicator, and residuals
</p>

<hr>
<h2 id='stg'>Compute the standardized total gain</h2><span id='topic+stg'></span>

<h3>Description</h3>

<p>Compute the standardized total gain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stg(R1, R0, stand = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stg_+3A_r1">R1</code></td>
<td>
<p>Risk in the treatment group</p>
</td></tr>
<tr><td><code id="stg_+3A_r0">R0</code></td>
<td>
<p>Risk in the control group</p>
</td></tr>
<tr><td><code id="stg_+3A_stand">stand</code></td>
<td>
<p>Standardize?</p>
</td></tr>
</table>

<hr>
<h2 id='summarize_bs'>Summarize bootstrap samples</h2><span id='topic+summarize_bs'></span>

<h3>Description</h3>

<p>Summarize bootstrap samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize_bs(bootdf, estdf = NULL, sig.level = 0.05,
  CI.type = "band")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarize_bs_+3A_bootdf">bootdf</code></td>
<td>
<p>Data frame containing bootstrapped estimates, with a column containing a convergence indicator</p>
</td></tr>
<tr><td><code id="summarize_bs_+3A_estdf">estdf</code></td>
<td>
<p>Data frame containing full sample estimate</p>
</td></tr>
<tr><td><code id="summarize_bs_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level to use for confidence intervals</p>
</td></tr>
<tr><td><code id="summarize_bs_+3A_ci.type">CI.type</code></td>
<td>
<p>Character string, &quot;pointwise&quot; for pointwise confidence intervals, and &quot;band&quot; for simultaneous confidence band.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.psdesign'>Summary method for psdesign objects</h2><span id='topic+summary.psdesign'></span>

<h3>Description</h3>

<p>Summary method for psdesign objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psdesign'
summary(object, digits = 3, sig.level = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.psdesign_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+psdesign">psdesign</a></p>
</td></tr>
<tr><td><code id="summary.psdesign_+3A_digits">digits</code></td>
<td>
<p>Number of significant digits to display</p>
</td></tr>
<tr><td><code id="summary.psdesign_+3A_sig.level">sig.level</code></td>
<td>
<p>Significance level to use for computing bootstrapped confidence intervals</p>
</td></tr>
<tr><td><code id="summary.psdesign_+3A_...">...</code></td>
<td>
<p>Currently unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns the printed table, along with the three estimates of vaccine efficacy. The empirical TE is 1 minus the relative risk comparing the treatment arm to the control arm. The risk is estimated as the proportion in the binary outcome case, or with the Kaplan-Meier estimate at the restricted mean survival in the time-to-event case. The marginal TE estimate is the TE estimate under the specified parametric risk model, ignoring the effect of S.1. The model based average TE is the TE estimate from the specified risk model, averaged over the distribution of S.1. The point of displaying these three is to assess the validity of the parametric model, and to assess the validity of the model estimation. Wild differences among these estimates may indicate problems with the model or convergence.
</p>

<hr>
<h2 id='TE'>Treatment efficacy contrast functions</h2><span id='topic+TE'></span>

<h3>Description</h3>

<p>Treatment efficacy contrast functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TE(R0, R1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TE_+3A_r0">R0</code></td>
<td>
<p>A vector of risks in the control arm</p>
</td></tr>
<tr><td><code id="TE_+3A_r1">R1</code></td>
<td>
<p>A vector of risks in the treatment arm</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions take the risk in the two treatment arms, and
computes a one-dimensional summary of those risks. Built-in choices are
<code>"TE"</code> for treatment efficacy = 1 - risk_1(s)/risk_0(s), <code>"RR"</code> for
relative risk = risk_0(s)/risk_1(s), <code>"logRR"</code> for log of the relative
risk, and <code>"RD"</code> for the risk difference = risk_0(s) - risk_1(s).
</p>


<h3>Value</h3>

<p>A vector the same length as R0 and R1.
</p>

<hr>
<h2 id='verify_trt'>Check that a variable is suitable for using as binary treatment indicator</h2><span id='topic+verify_trt'></span>

<h3>Description</h3>

<p>Checks for two classes and gives a warning message indicating which level is assumed to be 0/1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verify_trt(D)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="verify_trt_+3A_d">D</code></td>
<td>
<p>Vector that will be checked for 2-class labels</p>
</td></tr>
</table>

<hr>
<h2 id='wem_test'>Test for wide effect modification</h2><span id='topic+wem_test'></span>

<h3>Description</h3>

<p>This runs a multivariate Wald test on the interaction terms of the model, using the bootstrap covariance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wem_test(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wem_test_+3A_x">x</code></td>
<td>
<p>An object of class <a href="#topic+psdesign">psdesign</a> with bootstrap replicates</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
