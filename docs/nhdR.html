<!DOCTYPE html><html lang="en-US"><head><title>Help for package nhdR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nhdR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#nhdR-package'><p>R interface to the National Hydrography Dataset</p></a></li>
<li><a href='#bbox2poly'><p>Convert a bounding box to polygon</p></a></li>
<li><a href='#extract_network'><p>Return nhd plus stream network upstream of a waterbody</p></a></li>
<li><a href='#find_state'><p>find_state</p></a></li>
<li><a href='#find_vpu'><p>Find VPU</p></a></li>
<li><a href='#great_lakes'><p>Data and spatial polygons of the Great Lakes</p></a></li>
<li><a href='#gull'><p>List of simple features lake polygons and flowlines within a buffer</p>
around Gull Lake Michigan.</a></li>
<li><a href='#gull_flow'><p>Flowlines within a buffer around Gull Lake Michigan including flow information.</p></a></li>
<li><a href='#leaf_reaches'><p>Return leaf reaches from a network or query intersecting lake</p></a></li>
<li><a href='#mendota'><p>List of simple features lake polygons and flowlines within a buffer</p>
around Lake Mendota.</a></li>
<li><a href='#mendota_network'><p>Upstream flowlines connected to Lake Mendota.</p></a></li>
<li><a href='#nhd_dl_state'><p>nhd_dl_state</p></a></li>
<li><a href='#nhd_get'><p>Download and cache NHD data by state</p></a></li>
<li><a href='#nhd_info'><p>Return NHD layer metadata and field listing</p></a></li>
<li><a href='#nhd_list'><p>List available locally cached NHD layers per state</p></a></li>
<li><a href='#nhd_load'><p>Load NHD layers into current session</p></a></li>
<li><a href='#nhd_plus_get'><p>Download and cache NHDplus data by vector processing unit</p></a></li>
<li><a href='#nhd_plus_info'><p>Return NHDplus layer metadata and field listing</p></a></li>
<li><a href='#nhd_plus_list'><p>List available locally cached NHDplus layers per state</p></a></li>
<li><a href='#nhd_plus_load'><p>Load NHDplus layers into current session</p></a></li>
<li><a href='#nhd_plus_query'><p>Select NHDplus features via polygon or circular buffer of coordinate pair</p></a></li>
<li><a href='#nhd_query'><p>Select NHD features clipped by a circular buffer a coordinate pair</p></a></li>
<li><a href='#select_point_overlay'><p>Select features clipped by a point buffer around a point</p></a></li>
<li><a href='#select_poly_overlay'><p>Select features clipped by a polygon</p></a></li>
<li><a href='#sunapee'><p>List of simple features lake polygons and flowlines within a buffer</p>
around Lake Sunapee.</a></li>
<li><a href='#sunapee_network'><p>Upstream flowlines connected to Lake Sunapee.</p></a></li>
<li><a href='#terminal_reaches'><p>Return terminal reaches from collection intersecting lake</p></a></li>
<li><a href='#tip_reaches'><p>Return tip reaches from a network</p></a></li>
<li><a href='#toUTM'><p>Re-project to appropriate UTM zone</p></a></li>
<li><a href='#vpu_shp'><p>Low-res simple features data frame of the NHDPlus vector processing</p>
units</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Tools for Working with the National Hydrography Dataset</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for working with the National Hydrography Dataset, with 
    functions for querying, downloading, and networking both the NHD 
    <a href="https://www.usgs.gov/national-hydrography">https://www.usgs.gov/national-hydrography</a> 
    and NHDPlus <a href="https://www.epa.gov/waterdata/nhdplus-national-hydrography-dataset-plus">https://www.epa.gov/waterdata/nhdplus-national-hydrography-dataset-plus</a> datasets. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jsta/nhdR">https://github.com/jsta/nhdR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jsta/nhdR/issues">https://github.com/jsta/nhdR/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), maps</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Imports:</td>
<td>rappdirs, sf, httr, rvest, xml2, foreign, ggplot2, rlang,
dplyr, curl, units, stringr, memoise, purrr, digest</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, wikilake, sp, testthat (&ge; 2.1.0), covr,
crul, lwgeom, s2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>7-zip command line tool (7z)</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-12 01:31:05 UTC; 358572</td>
</tr>
<tr>
<td>Author:</td>
<td>Jemma Stachelek <a href="https://orcid.org/0000-0002-5924-2464"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jemma Stachelek &lt;jemma.stachelek@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-12 03:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='nhdR-package'>R interface to the National Hydrography Dataset</h2><span id='topic+nhdR-package'></span><span id='topic+nhdR'></span>

<h3>Description</h3>

<p>R interface to the National Hydrography Dataset
</p>


<h3>Author(s)</h3>

<p><a href="mailto:stachel2@msu.edu">stachel2@msu.edu</a>
</p>

<hr>
<h2 id='bbox2poly'>Convert a bounding box to polygon</h2><span id='topic+bbox2poly'></span>

<h3>Description</h3>

<p>Convert a bounding box to polygon
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bbox2poly(bbox)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bbox2poly_+3A_bbox">bbox</code></td>
<td>
<p>object of class bbox from sf</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An sfc object from the sf package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(sf)
wk &lt;- wikilake::lake_wiki("Gull Lake (Michigan)")

pnt &lt;- st_as_sf(wk, coords = c("Lon", "Lat"), crs = 4326)
pnt &lt;- st_transform(pnt, st_crs(vpu_shp))
qry &lt;- nhd_plus_query(wk$Lon, wk$Lat,
  dsn = c("NHDWaterbody"), buffer_dist = 0.05)
wbd &lt;- qry$sp$NHDWaterbody[which.max(st_area(qry$sp$NHDWaterbody)), ]
bbox2poly(st_bbox(wbd))

## End(Not run)
</code></pre>

<hr>
<h2 id='extract_network'>Return nhd plus stream network upstream of a waterbody</h2><span id='topic+extract_network'></span>

<h3>Description</h3>

<p>Return nhd plus stream network upstream of a waterbody
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_network(
  lon = NA,
  lat = NA,
  lines = NA,
  lines_network = TRUE,
  buffer_dist = 0.01,
  maxsteps = 3,
  approve_all_dl = FALSE,
  temporary = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_network_+3A_lon">lon</code></td>
<td>
<p>numeric decimal degree longitude</p>
</td></tr>
<tr><td><code id="extract_network_+3A_lat">lat</code></td>
<td>
<p>numeric decimal degree latitude</p>
</td></tr>
<tr><td><code id="extract_network_+3A_lines">lines</code></td>
<td>
<p>sf spatial lines object to limit extent of the network search</p>
</td></tr>
<tr><td><code id="extract_network_+3A_lines_network">lines_network</code></td>
<td>
<p>boolean treat lines as the complete network object.
If FALSE, simply start network extraction at the terminal reach of the
lines object.</p>
</td></tr>
<tr><td><code id="extract_network_+3A_buffer_dist">buffer_dist</code></td>
<td>
<p>numeric buffer around lat-lon point in dec. deg.</p>
</td></tr>
<tr><td><code id="extract_network_+3A_maxsteps">maxsteps</code></td>
<td>
<p>maximum number of stream climbing iterations</p>
</td></tr>
<tr><td><code id="extract_network_+3A_approve_all_dl">approve_all_dl</code></td>
<td>
<p>logical blanket approval to download all missing data.
Defaults to TRUE if session is non-interactive.</p>
</td></tr>
<tr><td><code id="extract_network_+3A_temporary">temporary</code></td>
<td>
<p>logical set FALSE to save data to a persistent
rappdirs location</p>
</td></tr>
<tr><td><code id="extract_network_+3A_...">...</code></td>
<td>
<p>parameters passed on to sf::st_read</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lon and lat arguments are used for querying the corresponding
lake polygon layer which is then used to climb its intersecting stream
network.
</p>


<h3>Value</h3>

<p>An sf data frame with LINESTRING geometries
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(mapview)
library(sf)

# headwater lakes have no upstream network
coords &lt;- data.frame(lat = 46.32711, lon = -89.58893)
res &lt;- extract_network(coords$lon, coords$lat, maxsteps = 9)

# fails if no lake nhdp lake found within the buffer at the query point
coords &lt;- data.frame(lat = 43.62453, lon = -85.47164)
res &lt;- extract_network(coords$lon, coords$lat, maxsteps = 9)

coords &lt;- data.frame(lat = 20.79722, lon = -156.47833)
# use a non-geographic (projected) buffer size
res &lt;- extract_network(coords$lon, coords$lat, maxsteps = 9,
  buffer_dist = units::as_units(5, "km"))

# use a projected buffer size
res &lt;- extract_network(coords$lon, coords$lat, maxsteps = 9)

# no upstream network for lakes intersecting the Great Lakes
coords &lt;- data.frame(lat = 44.6265, lon = -86.23121)
res &lt;- extract_network(coords$lon, coords$lat, maxsteps = 3)

coords &lt;- data.frame(lat = 42.96523, lon = -89.2527)
res &lt;- extract_network(coords$lon, coords$lat, maxsteps = 9)

mapview(res)

## End(Not run)
</code></pre>

<hr>
<h2 id='find_state'>find_state</h2><span id='topic+find_state'></span>

<h3>Description</h3>

<p>find_state
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_state(pnt, abb = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_state_+3A_pnt">pnt</code></td>
<td>
<p>an sf point object</p>
</td></tr>
<tr><td><code id="find_state_+3A_abb">abb</code></td>
<td>
<p>logical return a state abbreviation?</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pnt &lt;- st_as_sf(data.frame(Lon = -107.2, Lat = 39.45),
  coords = c("Lon", "Lat"), crs = 4326)

## End(Not run)
</code></pre>

<hr>
<h2 id='find_vpu'>Find VPU</h2><span id='topic+find_vpu'></span>

<h3>Description</h3>

<p>Find Vector Processing Unit from sf object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_vpu(pnt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_vpu_+3A_pnt">pnt</code></td>
<td>
<p>sf object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of vpu ids
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(sf)

# vpu centers
pnt &lt;- st_cast(st_point_on_surface(nhdR::vpu_shp), "POINT")

find_vpu(pnt[1, ])
find_vpu(pnt)

find_vpu(nhdR::gull$sp$NHDWaterbody[1, ])
find_vpu(nhdR::gull$sp$NHDWaterbody)

## End(Not run)
</code></pre>

<hr>
<h2 id='great_lakes'>Data and spatial polygons of the Great Lakes</h2><span id='topic+great_lakes'></span>

<h3>Description</h3>

<p>Data and spatial polygons of the Great Lakes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>great_lakes(spatial = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="great_lakes_+3A_spatial">spatial</code></td>
<td>
<p>logical, return Great Lakes polygons?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of North America Great Lakes with
optional geometry column
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gl &lt;- great_lakes()
## Not run: 
gl &lt;- great_lakes(spatial = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='gull'>List of simple features lake polygons and flowlines within a buffer
around Gull Lake Michigan.</h2><span id='topic+gull'></span>

<h3>Description</h3>

<p>Data from NHD Plus
</p>


<h3>Details</h3>

<p>gull
</p>

<hr>
<h2 id='gull_flow'>Flowlines within a buffer around Gull Lake Michigan including flow information.</h2><span id='topic+gull_flow'></span>

<h3>Description</h3>

<p>Data from NHD Plus
</p>


<h3>Details</h3>

<p>gull_flow
</p>

<hr>
<h2 id='leaf_reaches'>Return leaf reaches from a network or query intersecting lake</h2><span id='topic+leaf_reaches'></span>

<h3>Description</h3>

<p>A leaf reach is a stream flowline that has upstream connections but is
not in the focal set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leaf_reaches(
  lon = NA,
  lat = NA,
  network = NA,
  approve_all_dl = FALSE,
  temporary = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="leaf_reaches_+3A_lon">lon</code></td>
<td>
<p>numeric decimal degree longitude. optional. See Details section.</p>
</td></tr>
<tr><td><code id="leaf_reaches_+3A_lat">lat</code></td>
<td>
<p>numeric decimal degree latitude. optional. See Details section.</p>
</td></tr>
<tr><td><code id="leaf_reaches_+3A_network">network</code></td>
<td>
<p>sf lines collection. optional. See Details section.</p>
</td></tr>
<tr><td><code id="leaf_reaches_+3A_approve_all_dl">approve_all_dl</code></td>
<td>
<p>logical blanket approval to download all missing data.
Defaults to TRUE if session is non-interactive.</p>
</td></tr>
<tr><td><code id="leaf_reaches_+3A_temporary">temporary</code></td>
<td>
<p>logical set FALSE to save data to a persistent
rappdirs location</p>
</td></tr>
<tr><td><code id="leaf_reaches_+3A_...">...</code></td>
<td>
<p>parameters passed on to sf::st_read</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An sf data frame with LINESTRING geometries
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
coords &lt;- data.frame(lat = 20.79722, lon = -156.47833)
# nhd_plus_get(
#  nhdR::find_vpu(
#    sf::st_as_sf(coords, coords = c("lon", "lat"), crs = 4326)),
# temporary = FALSE)
leaf_reaches(coords$lon, coords$lat)

coords  &lt;- data.frame(lat = 41.42217, lon = -73.24189)
l_reach &lt;- leaf_reaches(coords$lon, coords$lat)

network_focal &lt;- nhd_plus_query(lon = coords$lon, lat = coords$lat,
  dsn = "NHDFlowline", buffer_dist = units::as_units(2, "km"))$sp$NHDFlowline
network &lt;- nhd_plus_query(lon = coords$lon, lat = coords$lat,
  dsn = "NHDFlowline", buffer_dist = units::as_units(5, "km"))$sp$NHDFlowline
l_reach &lt;- leaf_reaches(network = network_focal)

plot(network$geometry)
plot(network_focal$geometry, col = "darkgreen", add=TRUE)
plot(l_reach$geometry, col = "red", add = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='mendota'>List of simple features lake polygons and flowlines within a buffer
around Lake Mendota.</h2><span id='topic+mendota'></span>

<h3>Description</h3>

<p>Data from NHD Plus
</p>


<h3>Details</h3>

<p>mendota
</p>

<hr>
<h2 id='mendota_network'>Upstream flowlines connected to Lake Mendota.</h2><span id='topic+mendota_network'></span>

<h3>Description</h3>

<p>Data from NHD Plus
</p>


<h3>Details</h3>

<p>mendota_network
</p>

<hr>
<h2 id='nhd_dl_state'>nhd_dl_state</h2><span id='topic+nhd_dl_state'></span>

<h3>Description</h3>

<p>nhd_dl_state
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhd_dl_state(
  state,
  state_exists,
  yes_dl,
  file_ext,
  dsn = NA,
  wkt_filter = NA,
  temporary = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nhd_dl_state_+3A_state">state</code></td>
<td>
<p>state abbreviation</p>
</td></tr>
<tr><td><code id="nhd_dl_state_+3A_state_exists">state_exists</code></td>
<td>
<p>1 for file exists on disk</p>
</td></tr>
<tr><td><code id="nhd_dl_state_+3A_yes_dl">yes_dl</code></td>
<td>
<p>1 for downloading the state gdb file</p>
</td></tr>
<tr><td><code id="nhd_dl_state_+3A_file_ext">file_ext</code></td>
<td>
<p>file extension (&quot;gdb&quot;, etc)</p>
</td></tr>
<tr><td><code id="nhd_dl_state_+3A_dsn">dsn</code></td>
<td>
<p>name of gdb layer</p>
</td></tr>
<tr><td><code id="nhd_dl_state_+3A_wkt_filter">wkt_filter</code></td>
<td>
<p>a text string of coordinates see sf::st_read</p>
</td></tr>
<tr><td><code id="nhd_dl_state_+3A_temporary">temporary</code></td>
<td>
<p>logical set FALSE to save data to a persistent
rappdirs location</p>
</td></tr>
<tr><td><code id="nhd_dl_state_+3A_...">...</code></td>
<td>
<p>other arguments passed to sf::st_read</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
nhd_dl_state("RI", 1, 0, NA, "NHDWaterbody")

## End(Not run)
</code></pre>

<hr>
<h2 id='nhd_get'>Download and cache NHD data by state</h2><span id='topic+nhd_get'></span>

<h3>Description</h3>

<p>Download and cache NHD data by state
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhd_get(state = NA, force_dl = FALSE, force_unzip = FALSE, temporary = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nhd_get_+3A_state">state</code></td>
<td>
<p>character state abbreviation includes &quot;DC&quot;, &quot;PR&quot;, and &quot;VI&quot;</p>
</td></tr>
<tr><td><code id="nhd_get_+3A_force_dl">force_dl</code></td>
<td>
<p>logical force a re-download of the requested data</p>
</td></tr>
<tr><td><code id="nhd_get_+3A_force_unzip">force_unzip</code></td>
<td>
<p>logical force an unzip of downloaded data</p>
</td></tr>
<tr><td><code id="nhd_get_+3A_temporary">temporary</code></td>
<td>
<p>logical set FALSE to save data to a persistent
rappdirs location</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An invisible list of file paths to NHD data for the specified state
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
nhd_get(state = c("DC"))
nhd_get(state = c("RI", "CT"))

## End(Not run)
</code></pre>

<hr>
<h2 id='nhd_info'>Return NHD layer metadata and field listing</h2><span id='topic+nhd_info'></span>

<h3>Description</h3>

<p>Return NHD layer metadata and field listing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhd_info(state, dsn)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nhd_info_+3A_state">state</code></td>
<td>
<p>character</p>
</td></tr>
<tr><td><code id="nhd_info_+3A_dsn">dsn</code></td>
<td>
<p>character</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A column-wise summary of an sf read from the specfied layer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
nhd_info("DC", "NHDWaterbody")

## End(Not run)
</code></pre>

<hr>
<h2 id='nhd_list'>List available locally cached NHD layers per state</h2><span id='topic+nhd_list'></span>

<h3>Description</h3>

<p>List available locally cached NHD layers per state
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhd_list(state)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nhd_list_+3A_state">state</code></td>
<td>
<p>character state abbreviation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of NHD layers for the specified state
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
nhd_list(state = "DC")

## End(Not run)
</code></pre>

<hr>
<h2 id='nhd_load'>Load NHD layers into current session</h2><span id='topic+nhd_load'></span>

<h3>Description</h3>

<p>Load NHD layers into current session
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhd_load(
  state,
  dsn,
  file_ext = NA,
  approve_all_dl = FALSE,
  temporary = FALSE,
  wkt_filter = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nhd_load_+3A_state">state</code></td>
<td>
<p>character state abbreviation</p>
</td></tr>
<tr><td><code id="nhd_load_+3A_dsn">dsn</code></td>
<td>
<p>character name of a NHD layer</p>
</td></tr>
<tr><td><code id="nhd_load_+3A_file_ext">file_ext</code></td>
<td>
<p>character choice of &quot;shp&quot; for spatial data and
&quot;dbf&quot; or &quot;gpkg&quot; for non-spatial. optional</p>
</td></tr>
<tr><td><code id="nhd_load_+3A_approve_all_dl">approve_all_dl</code></td>
<td>
<p>logical blanket approval to download all missing data.
Defaults to TRUE if session is non-interactive.</p>
</td></tr>
<tr><td><code id="nhd_load_+3A_temporary">temporary</code></td>
<td>
<p>logical set FALSE to save data to a persistent
rappdirs location</p>
</td></tr>
<tr><td><code id="nhd_load_+3A_wkt_filter">wkt_filter</code></td>
<td>
<p>character. WKT spatial filter for selection.
See sf::st_read</p>
</td></tr>
<tr><td><code id="nhd_load_+3A_...">...</code></td>
<td>
<p>arguments passed to sf::st_read</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will ask the user to approve downloading missing data
unless approve_all_dl is set to TRUE.
</p>


<h3>Value</h3>

<p>Spatial simple features object or data frame depending on the dsn
type and value passed to file_ext
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dt &lt;- nhd_load(c("RI"), c("NHDWaterbody"))
dt &lt;- nhd_load(c("CT", "RI"), "NHDWaterbody")
dt &lt;- nhd_load(c("CT", "RI"), "NHDWaterbody", quiet = TRUE)
dt &lt;- nhd_load("MI", "NHDFlowline")
dt &lt;- nhd_load("RI", "NHDReachCrossReference")
dt &lt;- nhd_load("RI", "NHDWaterbody", file_ext = "dbf")
dt &lt;- nhd_load(c("RI", "DC"), "NHDWaterbody", file_ext = "gpkg")

dt &lt;- nhd_load("RI", "NHDWaterbody", wkt_filter = "POINT (-71.575 41.438)")

dt &lt;- nhd_load("RI", "NHDFlowline", pretty = FALSE, quiet = TRUE,
  query = paste0("SELECT * from ", "NHDFlowline", " LIMIT 1"))

## End(Not run)
</code></pre>

<hr>
<h2 id='nhd_plus_get'>Download and cache NHDplus data by vector processing unit</h2><span id='topic+nhd_plus_get'></span>

<h3>Description</h3>

<p>Download and cache NHDplus data by vector processing unit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhd_plus_get(
  vpu = NA,
  component = "NHDSnapshot",
  force_dl = FALSE,
  force_unzip = FALSE,
  temporary = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nhd_plus_get_+3A_vpu">vpu</code></td>
<td>
<p>numeric vector processing unit</p>
</td></tr>
<tr><td><code id="nhd_plus_get_+3A_component">component</code></td>
<td>
<p>character component name</p>
</td></tr>
<tr><td><code id="nhd_plus_get_+3A_force_dl">force_dl</code></td>
<td>
<p>logical force a re-download of the requested data</p>
</td></tr>
<tr><td><code id="nhd_plus_get_+3A_force_unzip">force_unzip</code></td>
<td>
<p>logical force an unzip of downloaded data</p>
</td></tr>
<tr><td><code id="nhd_plus_get_+3A_temporary">temporary</code></td>
<td>
<p>logical set FALSE to save data to a persistent
rappdirs location</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An invisible list of file paths to NHDplus data for the specified vpu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Spatial
nhd_plus_get(vpu = 4)
nhd_plus_get(vpu = "10L")
nhd_plus_get(vpu = 1, component = "NHDPlusAttributes")

# Non-spatial
nhd_plus_get(vpu = "National", component = "V1_To_V2_Crosswalk")
nhd_plus_get(vpu = 4, component = "EROMExtension")

## End(Not run)
</code></pre>

<hr>
<h2 id='nhd_plus_info'>Return NHDplus layer metadata and field listing</h2><span id='topic+nhd_plus_info'></span>

<h3>Description</h3>

<p>Return NHDplus layer metadata and field listing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhd_plus_info(vpu, component, dsn, file_ext = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nhd_plus_info_+3A_vpu">vpu</code></td>
<td>
<p>numeric vector processing unit</p>
</td></tr>
<tr><td><code id="nhd_plus_info_+3A_component">component</code></td>
<td>
<p>character component name</p>
</td></tr>
<tr><td><code id="nhd_plus_info_+3A_dsn">dsn</code></td>
<td>
<p>character data source name</p>
</td></tr>
<tr><td><code id="nhd_plus_info_+3A_file_ext">file_ext</code></td>
<td>
<p>character choice of &quot;shp&quot; for spatial data and
&quot;dbf&quot; for non-spatial. optional</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A column-wise summary of an sf/foreign read from the specfied layer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
nhd_plus_info(vpu = 4, component = "NHDSnapshot", dsn = "NHDWaterbody")
nhd_plus_info(vpu = 1, component = "NHDPlusAttributes", dsn = "PlusFlow")

## End(Not run)
</code></pre>

<hr>
<h2 id='nhd_plus_list'>List available locally cached NHDplus layers per state</h2><span id='topic+nhd_plus_list'></span>

<h3>Description</h3>

<p>List available locally cached NHDplus layers per state
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhd_plus_list(vpu, component = "NHDSnapshot", file_ext = NA, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nhd_plus_list_+3A_vpu">vpu</code></td>
<td>
<p>numeric vector processing unit</p>
</td></tr>
<tr><td><code id="nhd_plus_list_+3A_component">component</code></td>
<td>
<p>character component name</p>
</td></tr>
<tr><td><code id="nhd_plus_list_+3A_file_ext">file_ext</code></td>
<td>
<p>character choice of &quot;shp&quot; for spatial data and
&quot;dbf&quot; for non-spatial. optional</p>
</td></tr>
<tr><td><code id="nhd_plus_list_+3A_...">...</code></td>
<td>
<p>arguments passed to list.files. optional.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of NHD layers for the specified vpu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
nhd_plus_list(vpu = 4)
nhd_plus_list(vpu = 4, full.names = TRUE)

nhd_plus_list(vpu = 1, component = "NHDPlusAttributes")
nhd_plus_list(vpu = "National", component = "V1_To_V2_Crosswalk")

## End(Not run)
</code></pre>

<hr>
<h2 id='nhd_plus_load'>Load NHDplus layers into current session</h2><span id='topic+nhd_plus_load'></span>

<h3>Description</h3>

<p>Load NHDplus layers into current session
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhd_plus_load(
  vpu,
  component = "NHDSnapshot",
  dsn,
  file_ext = NA,
  approve_all_dl = FALSE,
  force_dl = FALSE,
  temporary = FALSE,
  pretty = FALSE,
  wkt_filter = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nhd_plus_load_+3A_vpu">vpu</code></td>
<td>
<p>numeric vector processing unit</p>
</td></tr>
<tr><td><code id="nhd_plus_load_+3A_component">component</code></td>
<td>
<p>character component name</p>
</td></tr>
<tr><td><code id="nhd_plus_load_+3A_dsn">dsn</code></td>
<td>
<p>data source name</p>
</td></tr>
<tr><td><code id="nhd_plus_load_+3A_file_ext">file_ext</code></td>
<td>
<p>character choice of &quot;shp&quot; for spatial data and
&quot;dbf&quot; for non-spatial. optional</p>
</td></tr>
<tr><td><code id="nhd_plus_load_+3A_approve_all_dl">approve_all_dl</code></td>
<td>
<p>logical blanket approval to download all missing data.
Defaults to TRUE if session is non-interactive</p>
</td></tr>
<tr><td><code id="nhd_plus_load_+3A_force_dl">force_dl</code></td>
<td>
<p>logical force a re-download of the requested data</p>
</td></tr>
<tr><td><code id="nhd_plus_load_+3A_temporary">temporary</code></td>
<td>
<p>logical set FALSE to save data to a persistent
rappdirs location</p>
</td></tr>
<tr><td><code id="nhd_plus_load_+3A_pretty">pretty</code></td>
<td>
<p>more minimal pretty printing st_read relative to &quot;quiet&quot;</p>
</td></tr>
<tr><td><code id="nhd_plus_load_+3A_wkt_filter">wkt_filter</code></td>
<td>
<p>character. WKT spatial filter for selection.
See sf::st_read</p>
</td></tr>
<tr><td><code id="nhd_plus_load_+3A_...">...</code></td>
<td>
<p>parameters passed on to sf::st_read</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will ask the user to approve downloading missing data
unless approve_all_dl is set to TRUE. Output of this function is saved in
active memory (memoized) to speed up repeated function calls.
</p>


<h3>Value</h3>

<p>spatial object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Spatial
dt &lt;- nhd_plus_load(4, "NHDSnapshot", "NHDWaterbody")
dt &lt;- nhd_plus_load(c(1, 2), "NHDSnapshot", "NHDWaterbody")
dt &lt;- nhd_plus_load(4, "NHDSnapshot", "NHDFlowline")
dt &lt;- nhd_plus_load(4, "NHDPlusCatchment", "Catchment")

# Quieter printing
dt &lt;- nhd_plus_load(4, "NHDSnapshot", "NHDWaterbody", pretty = TRUE)
# Quietest printing
dt &lt;- nhd_plus_load(4, "NHDSnapshot", "NHDWaterbody", quiet = TRUE)

# Non-spatial
dt &lt;- nhd_plus_load(1, "NHDPlusAttributes", "PlusFlow")
dt &lt;- nhd_plus_load("National", "V1_To_V2_Crosswalk",
  "NHDPlusV1Network_V2Network_Crosswalk")
gridcode      &lt;- nhd_plus_load(1, "NHDPlusCatchment", "featuregridcode")
flowline_vaa  &lt;- nhd_plus_load(1, "NHDPlusAttributes", "PlusFlowlineVAA")
eromflow      &lt;- nhd_plus_load(4, "EROMExtension", "EROM_010001")

# Character VPU
plusflow &lt;- nhd_plus_load(vpu = "10L", "NHDPlusAttributes", "PlusFlow")

# Spatial filtering via wkt_filter
dt &lt;- nhd_plus_load(4, "NHDSnapshot", "NHDWaterbody", wkt_filter = "POINT (-85.411 42.399)")

## End(Not run)
</code></pre>

<hr>
<h2 id='nhd_plus_query'>Select NHDplus features via polygon or circular buffer of coordinate pair</h2><span id='topic+nhd_plus_query'></span>

<h3>Description</h3>

<p>Select NHDplus features via polygon or circular buffer of coordinate pair
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhd_plus_query(
  lon = NA,
  lat = NA,
  poly = NA,
  dsn,
  buffer_dist = units::as_units(4.75, "km"),
  approve_all_dl = FALSE,
  temporary = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nhd_plus_query_+3A_lon">lon</code></td>
<td>
<p>numeric longitude. optional</p>
</td></tr>
<tr><td><code id="nhd_plus_query_+3A_lat">lat</code></td>
<td>
<p>numeric latitude. optional</p>
</td></tr>
<tr><td><code id="nhd_plus_query_+3A_poly">poly</code></td>
<td>
<p>sfc polygon. optional</p>
</td></tr>
<tr><td><code id="nhd_plus_query_+3A_dsn">dsn</code></td>
<td>
<p>character data source</p>
</td></tr>
<tr><td><code id="nhd_plus_query_+3A_buffer_dist">buffer_dist</code></td>
<td>
<p>numeric buffer in units of coordinate degrees</p>
</td></tr>
<tr><td><code id="nhd_plus_query_+3A_approve_all_dl">approve_all_dl</code></td>
<td>
<p>logical blanket approval to download all missing data.
Defaults to TRUE if session is non-interactive.</p>
</td></tr>
<tr><td><code id="nhd_plus_query_+3A_temporary">temporary</code></td>
<td>
<p>logical set FALSE to save data to a persistent
rappdirs location</p>
</td></tr>
<tr><td><code id="nhd_plus_query_+3A_...">...</code></td>
<td>
<p>parameters passed on to sf::st_read</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of sf spatial objects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(sf)
wk &lt;- wikilake::lake_wiki("Gull Lake (Michigan)")

pnt &lt;- st_as_sf(wk, coords = c("Lon", "Lat"), crs = 4326)
pnt &lt;- st_transform(pnt, st_crs(vpu_shp))
# nhd_plus_list(nhdR::find_vpu(pnt))

qry &lt;- nhd_plus_query(wk$Lon, wk$Lat,
  dsn = c("NHDWaterbody", "NHDFlowLine"), buffer_dist = units::as_units(4.75, "km"))

plot(qry$sp$NHDWaterbody$geometry, col = "blue")
plot(qry$sp$NHDFlowLine$geometry, col = "cyan", add = TRUE)
plot(qry$pnt, col = "red", pch = 19, add = TRUE)
axis(1)
axis(2)

library(ggplot2)
ggplot(qry$sp$NHDWaterbody) + geom_sf()

# query with a polygon
wbd &lt;- qry$sp$NHDWaterbody[which.max(st_area(qry$sp$NHDWaterbody)), ]
qry_lines &lt;- nhd_plus_query(poly = st_as_sfc(st_bbox(wbd)),
  dsn = "NHDFlowLine")
ggplot() +
  geom_sf(data = qry$sp$NHDWaterbody) +
  geom_sf(data = qry_lines$sp$NHDFlowLine, color = "red")

## End(Not run)
</code></pre>

<hr>
<h2 id='nhd_query'>Select NHD features clipped by a circular buffer a coordinate pair</h2><span id='topic+nhd_query'></span>

<h3>Description</h3>

<p>Select NHD features clipped by a circular buffer a coordinate pair
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhd_query(
  lon = NA,
  lat = NA,
  poly = NA,
  dsn,
  approve_all_dl = FALSE,
  buffer_dist = units::as_units(4.75, "km"),
  temporary = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nhd_query_+3A_lon">lon</code></td>
<td>
<p>numeric longitude</p>
</td></tr>
<tr><td><code id="nhd_query_+3A_lat">lat</code></td>
<td>
<p>numeric latitude</p>
</td></tr>
<tr><td><code id="nhd_query_+3A_poly">poly</code></td>
<td>
<p>sfc polygon. optional</p>
</td></tr>
<tr><td><code id="nhd_query_+3A_dsn">dsn</code></td>
<td>
<p>character data source</p>
</td></tr>
<tr><td><code id="nhd_query_+3A_approve_all_dl">approve_all_dl</code></td>
<td>
<p>logical blanket approval to download all missing data.
Defaults to TRUE if session is non-interactive.</p>
</td></tr>
<tr><td><code id="nhd_query_+3A_buffer_dist">buffer_dist</code></td>
<td>
<p>numeric buffer with specified units</p>
</td></tr>
<tr><td><code id="nhd_query_+3A_temporary">temporary</code></td>
<td>
<p>logical set FALSE to save data to a persistent
rappdirs location</p>
</td></tr>
<tr><td><code id="nhd_query_+3A_...">...</code></td>
<td>
<p>other arguments passed to sf::st_read</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(sf)
wk &lt;- wikilake::lake_wiki("Worden Pond")
qry &lt;- nhd_query(wk$Lon, wk$Lat, dsn = c("NHDWaterbody", "NHDFlowLine"),
  buffer_dist = units::as_units(1, "km"))
qry$sp$NHDWaterbody &lt;- dplyr::filter(qry$sp$NHDWaterbody, FType != 466)

plot(sf::st_geometry(qry$sp$NHDWaterbody), col = "blue")
plot(sf::st_geometry(qry$sp$NHDFlowLine), col = "cyan", add = TRUE)
plot(qry$pnt, col = "red", pch = 19, add = TRUE)
axis(1)
axis(2)

# query with a polygon
wbd &lt;- qry$sp$NHDWaterbody[
  order(st_area(qry$sp$NHDWaterbody), decreasing = TRUE), ][1, ]
qry_lines &lt;- nhd_query(poly = st_as_sfc(st_bbox(wbd)), dsn = "NHDFlowLine")
library(ggplot2)
ggplot() +
  geom_sf(data = qry$sp$NHDWaterbody) +
  geom_sf(data = qry_lines$sp$NHDFlowLine, color = "red")

## End(Not run)
</code></pre>

<hr>
<h2 id='select_point_overlay'>Select features clipped by a point buffer around a point</h2><span id='topic+select_point_overlay'></span>

<h3>Description</h3>

<p>Select features clipped by a point buffer around a point
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_point_overlay(pnt, sp, buffer_dist = units::as_units(4.75, "km"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select_point_overlay_+3A_pnt">pnt</code></td>
<td>
<p>geographic point of class sfc</p>
</td></tr>
<tr><td><code id="select_point_overlay_+3A_sp">sp</code></td>
<td>
<p>list of sf data frames</p>
</td></tr>
<tr><td><code id="select_point_overlay_+3A_buffer_dist">buffer_dist</code></td>
<td>
<p>numeric buffer with specified units</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of sf spatial objects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
wk &lt;- wikilake::lake_wiki("Gull Lake (Michigan)")
pnt &lt;- sf::st_sfc(sf::st_point(c(wk$Lon, wk$Lat)))
sf::st_crs(pnt) &lt;- 4326
sp &lt;- lapply(c("NHDWaterbody", "NHDFlowLine"),
  function(x) nhd_plus_load(vpu = 4, dsn = x))
names(sp) &lt;- c("NHDWaterbody", "NHDFlowLine")
qry &lt;- select_point_overlay(pnt = pnt, sp = sp)
plot(qry$NHDWaterbody$geometry, col = "blue")
plot(qry$NHDFlowLine$geometry, col = "cyan", add = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='select_poly_overlay'>Select features clipped by a polygon</h2><span id='topic+select_poly_overlay'></span>

<h3>Description</h3>

<p>Select features clipped by a polygon
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_poly_overlay(poly, sp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select_poly_overlay_+3A_poly">poly</code></td>
<td>
<p>sf *polygon object</p>
</td></tr>
<tr><td><code id="select_poly_overlay_+3A_sp">sp</code></td>
<td>
<p>list of sf data frames</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of sf spatial objects
</p>

<hr>
<h2 id='sunapee'>List of simple features lake polygons and flowlines within a buffer
around Lake Sunapee.</h2><span id='topic+sunapee'></span>

<h3>Description</h3>

<p>Data from NHD Plus
</p>


<h3>Details</h3>

<p>sunapee
</p>

<hr>
<h2 id='sunapee_network'>Upstream flowlines connected to Lake Sunapee.</h2><span id='topic+sunapee_network'></span>

<h3>Description</h3>

<p>Data from NHD Plus
</p>


<h3>Details</h3>

<p>sunapee_network
</p>

<hr>
<h2 id='terminal_reaches'>Return terminal reaches from collection intersecting lake</h2><span id='topic+terminal_reaches'></span>

<h3>Description</h3>

<p>In the case of a network query, a terminal reach is a stream flowline that
has no downstream reaches in-network. In the case of a point query, a
terminal reach is a flowline that exits the intersecting surface waterbody.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>terminal_reaches(
  lon = NA,
  lat = NA,
  buffer_dist = 0.01,
  network = NA,
  lakepoly = NA,
  lakewise = FALSE,
  lakesize_threshold = 4,
  approve_all_dl = FALSE,
  temporary = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="terminal_reaches_+3A_lon">lon</code></td>
<td>
<p>numeric decimal degree longitude. optional. See Details section.</p>
</td></tr>
<tr><td><code id="terminal_reaches_+3A_lat">lat</code></td>
<td>
<p>numeric decimal degree latitude. optional. See Details section.</p>
</td></tr>
<tr><td><code id="terminal_reaches_+3A_buffer_dist">buffer_dist</code></td>
<td>
<p>numeric buffer around lat-lon point in dec. deg.</p>
</td></tr>
<tr><td><code id="terminal_reaches_+3A_network">network</code></td>
<td>
<p>sf lines collection. optional. See Details section.</p>
</td></tr>
<tr><td><code id="terminal_reaches_+3A_lakepoly">lakepoly</code></td>
<td>
<p>sf polygon.  optional. See Details section.</p>
</td></tr>
<tr><td><code id="terminal_reaches_+3A_lakewise">lakewise</code></td>
<td>
<p>logical. If TRUE, return the terminal reaches of all lakes
in the stream network rather than a single terminal reach of the focal lake.</p>
</td></tr>
<tr><td><code id="terminal_reaches_+3A_lakesize_threshold">lakesize_threshold</code></td>
<td>
<p>numeric above which to count as a lake (ha).</p>
</td></tr>
<tr><td><code id="terminal_reaches_+3A_approve_all_dl">approve_all_dl</code></td>
<td>
<p>logical blanket approval to download all missing data.
Defaults to TRUE if session is non-interactive.</p>
</td></tr>
<tr><td><code id="terminal_reaches_+3A_temporary">temporary</code></td>
<td>
<p>logical set FALSE to save data to a persistent
rappdirs location</p>
</td></tr>
<tr><td><code id="terminal_reaches_+3A_...">...</code></td>
<td>
<p>parameters passed on to sf::st_read</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are multiple ways to execute <code><a href="#topic+terminal_reaches">terminal_reaches</a></code>:
</p>

<ul>
<li><p> Only providing lon + lat arguments - this will query the
corresponding lake polygon layer and find the terminal reach of the lake
intersecting a buffer around the specified point.
</p>
</li>
<li><p> Only providing a lake polygon - this is essentially the same as
above except there is no preliminary lake polygon query.
</p>
</li>
<li><p> Only providing a network of stream lines - this provides the most
downstream reach irrespective of lakes.
</p>
</li></ul>



<h3>Value</h3>

<p>An sf data frame with LINESTRING geometries
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(sf)
library(mapview)

coords &lt;- data.frame(lat = 46.32711, lon = -89.58893)
t_reach &lt;- terminal_reaches(coords$lon, coords$lat)

coords &lt;- data.frame(lat = 20.79722, lon = -156.47833)
# use a non-geographic (projected) buffer size
t_reach &lt;- terminal_reaches(coords$lon, coords$lat,
  buffer_dist = units::as_units(5, "km"))

coords  &lt;- data.frame(lat = 42.96628, lon = -89.25264)
t_reach &lt;- terminal_reaches(coords$lon, coords$lat)

coords  &lt;- data.frame(lat = 41.42217, lon = -73.24189)
t_reach &lt;- terminal_reaches(coords$lon, coords$lat)

mapview(st_as_sf(coords, coords = c("lon", "lat"), crs = 4326)) +
  mapview(t_reach$geometry, color = "red")

coords &lt;- data.frame(lat = 41.859080, lon = -71.575422)
network &lt;- nhd_plus_query(lon = coords$lon, lat = coords$lat,
  dsn = "NHDFlowline", buffer_dist = 0.05)$sp$NHDFlowline
t_reach      &lt;- terminal_reaches(network = network)
t_reach_lake &lt;- terminal_reaches(network = network, lakewise = TRUE,
  lakesize_threshold = 1)

mapview(network) + mapview(t_reach_lake, color = "green") +
  mapview(t_reach, color = "red")

## End(Not run)
</code></pre>

<hr>
<h2 id='tip_reaches'>Return tip reaches from a network</h2><span id='topic+tip_reaches'></span>

<h3>Description</h3>

<p>A tip reach is a stream flowline with no upstream connections.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tip_reaches(network = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tip_reaches_+3A_network">network</code></td>
<td>
<p>sf lines collection. optional. See Details section.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An sf data frame with LINESTRING geometries
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

coords  &lt;- data.frame(lat = 41.42217, lon = -73.24189)
network &lt;- nhd_plus_query(lon = coords$lon, lat = coords$lat,
  dsn = "NHDFlowline", buffer_dist = units::as_units(5, "km"))$sp$NHDFlowline
t_reaches &lt;- tip_reaches(network = network)

plot(network$geometry)
plot(t_reaches$geometry, col = "red", add = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='toUTM'>Re-project to appropriate UTM zone</h2><span id='topic+toUTM'></span>

<h3>Description</h3>

<p>Re-project to appropriate UTM zone
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toUTM(sf_object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="toUTM_+3A_sf_object">sf_object</code></td>
<td>
<p>an sf object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A transformed sf object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(gull)
gull_ &lt;- gull$sp$NHDWaterbody
st_crs(gull_)
gull_ &lt;- st_transform(gull_, 4326)
st_crs(gull_)
st_crs(toUTM(gull_[1, ]))

## End(Not run)
</code></pre>

<hr>
<h2 id='vpu_shp'>Low-res simple features data frame of the NHDPlus vector processing
units</h2><span id='topic+vpu_shp'></span>

<h3>Description</h3>

<p>vpu_shp
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
