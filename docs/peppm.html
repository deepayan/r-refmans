<!DOCTYPE html><html><head><title>Help for package peppm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {peppm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#findInt'><p>Function to identify the times' intervals</p></a></li>
<li><a href='#getGrid'><p>Computes the time grid from the auxiliary vector U.</p></a></li>
<li><a href='#gibbs'><p>Runs the Gibbs sampler</p></a></li>
<li><a href='#pehaz'><p>Hazard and cumulative hazard functions of the PE distribution</p></a></li>
<li><a href='#peppm'><p>Piecewise Exponential Product Partition Model</p></a></li>
<li><a href='#PExp'><p>Probability function, distribution function, quantile function and random generation for the Piecewise Exponential (PE) distribution.</p></a></li>
<li><a href='#telecom'><p>GTE Corporation telecommunication systems</p></a></li>
<li><a href='#timeGrid'><p>Time grid for the PE distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Piecewise Exponential Distribution with Random Time Grids</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fabio Demarqui &lt;fndemarqui@est.ufmg.br&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits the Piecewise Exponential distribution with random time grids using the clustering structure of the Product Partition Models. Details of the implemented model can be found in Demarqui et al. (2008) &lt;<a href="https://doi.org/10.1007%2Fs10985-008-9086-0">doi:10.1007/s10985-008-9086-0</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/fndemarqui/peppm">https://github.com/fndemarqui/peppm</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/fndemarqui/peppm/issues">https://github.com/fndemarqui/peppm/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.1)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-24 22:16:27 UTC; fndemarqui</td>
</tr>
<tr>
<td>Author:</td>
<td>Fabio Demarqui <a href="https://orcid.org/0000-0001-9236-1986"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-25 08:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='findInt'>Function to identify the times' intervals</h2><span id='topic+findInt'></span>

<h3>Description</h3>

<p>Function to identify the times' intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findInt(time, tgrid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findInt_+3A_time">time</code></td>
<td>
<p>vector of times.</p>
</td></tr>
<tr><td><code id="findInt_+3A_tgrid">tgrid</code></td>
<td>
<p>time grid of the PE distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>indicator of times's intervals
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(telecom)
tgrid &lt;- with(telecom, timeGrid(time, status))
tgrid
findInt(telecom$time, tgrid) 
</code></pre>

<hr>
<h2 id='getGrid'>Computes the time grid from the auxiliary vector U.</h2><span id='topic+getGrid'></span>

<h3>Description</h3>

<p>Computes the time grid from the auxiliary vector U.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getGrid(U, ftgrid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getGrid_+3A_u">U</code></td>
<td>
<p>vector of change point indicators</p>
</td></tr>
<tr><td><code id="getGrid_+3A_ftgrid">ftgrid</code></td>
<td>
<p>vector with the finest time grid (distinct observed failure times)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the time grid associated with the auxiliary vector U.
</p>

<hr>
<h2 id='gibbs'>Runs the Gibbs sampler</h2><span id='topic+gibbs'></span>

<h3>Description</h3>

<p>Runs the Gibbs sampler
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gibbs(
  U0,
  ftgrid,
  time,
  status,
  a_rates,
  b_rates,
  cohesion,
  a_beta,
  b_beta,
  npost,
  nburnin,
  nlag
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gibbs_+3A_u0">U0</code></td>
<td>
<p>vector of change point indicators</p>
</td></tr>
<tr><td><code id="gibbs_+3A_ftgrid">ftgrid</code></td>
<td>
<p>vector of indexes of distinct failure times</p>
</td></tr>
<tr><td><code id="gibbs_+3A_time">time</code></td>
<td>
<p>vector of observed failure times.</p>
</td></tr>
<tr><td><code id="gibbs_+3A_status">status</code></td>
<td>
<p>vector of failure indicators</p>
</td></tr>
<tr><td><code id="gibbs_+3A_a_rates">a_rates</code></td>
<td>
<p>shape parameter of the gamma distribution (prior for failure rates).</p>
</td></tr>
<tr><td><code id="gibbs_+3A_b_rates">b_rates</code></td>
<td>
<p>scale parameter of the gamma distribution (prior for failure rates).</p>
</td></tr>
<tr><td><code id="gibbs_+3A_cohesion">cohesion</code></td>
<td>
<p>type of prior cohesion (1 to 4).</p>
</td></tr>
<tr><td><code id="gibbs_+3A_a_beta">a_beta</code></td>
<td>
<p>shape1 parameter of the beta distribution (prior for p - cohesion 4).</p>
</td></tr>
<tr><td><code id="gibbs_+3A_b_beta">b_beta</code></td>
<td>
<p>shape2 parameter of the beta distribution (prior for p - cohesion 4).</p>
</td></tr>
<tr><td><code id="gibbs_+3A_npost">npost</code></td>
<td>
<p>desired posterior sample size</p>
</td></tr>
<tr><td><code id="gibbs_+3A_nburnin">nburnin</code></td>
<td>
<p>number of iterations to be discarded.</p>
</td></tr>
<tr><td><code id="gibbs_+3A_nlag">nlag</code></td>
<td>
<p>number of jumps to eliminate autocorrelation of the chain.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>posterior sample
</p>

<hr>
<h2 id='pehaz'>Hazard and cumulative hazard functions of the PE distribution</h2><span id='topic+pehaz'></span><span id='topic+hpexp'></span><span id='topic+Hpexp'></span>

<h3>Description</h3>

<p>Hazard and cumulative hazard functions of the PE distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hpexp(x, tgrid, rates)

Hpexp(x, tgrid, rates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pehaz_+3A_x">x</code></td>
<td>
<p>vector of time points.</p>
</td></tr>
<tr><td><code id="pehaz_+3A_tgrid">tgrid</code></td>
<td>
<p>vector of time grid knots.</p>
</td></tr>
<tr><td><code id="pehaz_+3A_rates">rates</code></td>
<td>
<p>vector of failure rates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>hpexp gives the hazard function and Hpexp gives the cumulative hazard function of the PE distribution.
</p>

<hr>
<h2 id='peppm'>Piecewise Exponential Product Partition Model</h2><span id='topic+peppm'></span>

<h3>Description</h3>

<p>Piecewise Exponential Product Partition Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>peppm(
  time,
  status,
  a_rates = 1,
  b_rates = 1,
  cohesion = 1,
  a_beta = 1,
  b_beta = 1,
  nburnin = 10000,
  npost = 20000,
  nlag = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="peppm_+3A_time">time</code></td>
<td>
<p>vector of observed failure times.</p>
</td></tr>
<tr><td><code id="peppm_+3A_status">status</code></td>
<td>
<p>vector of failure indicators</p>
</td></tr>
<tr><td><code id="peppm_+3A_a_rates">a_rates</code></td>
<td>
<p>shape parameter of the gamma distribution (prior for failure rates).</p>
</td></tr>
<tr><td><code id="peppm_+3A_b_rates">b_rates</code></td>
<td>
<p>scale parameter of the gamma distribution (prior for failure rates).</p>
</td></tr>
<tr><td><code id="peppm_+3A_cohesion">cohesion</code></td>
<td>
<p>type of prior cohesion (1 to 4).</p>
</td></tr>
<tr><td><code id="peppm_+3A_a_beta">a_beta</code></td>
<td>
<p>shape1 parameter of the beta distribution (prior for p - cohesion 4).</p>
</td></tr>
<tr><td><code id="peppm_+3A_b_beta">b_beta</code></td>
<td>
<p>shape2 parameter of the beta distribution (prior for p - cohesion 4).</p>
</td></tr>
<tr><td><code id="peppm_+3A_nburnin">nburnin</code></td>
<td>
<p>number of iterations to be discarded.</p>
</td></tr>
<tr><td><code id="peppm_+3A_npost">npost</code></td>
<td>
<p>desired posterior sample size</p>
</td></tr>
<tr><td><code id="peppm_+3A_nlag">nlag</code></td>
<td>
<p>number of jumps to eliminate autocorrelation of the chain.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Posterior sample of the number of intervals, failure rates, the auxiliary vector U, and the logarithm of the prior predictive distribution (log data factor).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Small chain used here due to time constraints. 
data(telecom)

# Prior cohesion 1:
fit1 &lt;- with(telecom, peppm(time, status, cohesion=1, nburnin = 0, nlag = 1, npost = 100))
# Prior cohesion 2:
fit2 &lt;- with(telecom, peppm(time, status, cohesion=2, nburnin = 0, nlag = 1, npost = 100))
# Prior cohesion 3:
fit3 &lt;- with(telecom, peppm(time, status, cohesion=3, nburnin = 0, nlag = 1, npost = 100))
# Prior cohesion 4:
fit4 &lt;- with(telecom, peppm(time, status, cohesion=4, nburnin = 0, nlag = 1, npost = 100))  
   
</code></pre>

<hr>
<h2 id='PExp'>Probability function, distribution function, quantile function and random generation for the Piecewise Exponential (PE) distribution.</h2><span id='topic+PExp'></span><span id='topic+dpexp'></span><span id='topic+ppexp'></span><span id='topic+qpexp'></span><span id='topic+rpexp'></span>

<h3>Description</h3>

<p>Probability function, distribution function, quantile function and random generation for the Piecewise Exponential (PE) distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpexp(x, tgrid, rates, log = FALSE)

ppexp(q, tgrid, rates, lower.tail = TRUE, log.p = FALSE)

qpexp(p, tgrid, rates, lower.tail = TRUE, log.p = FALSE)

rpexp(n, tgrid, rates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PExp_+3A_x">x</code></td>
<td>
<p>vector of time points.</p>
</td></tr>
<tr><td><code id="PExp_+3A_tgrid">tgrid</code></td>
<td>
<p>vector of time grid knots.</p>
</td></tr>
<tr><td><code id="PExp_+3A_rates">rates</code></td>
<td>
<p>vector of failure rates.</p>
</td></tr>
<tr><td><code id="PExp_+3A_log">log</code>, <code id="PExp_+3A_log.p">log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
<tr><td><code id="PExp_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="PExp_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are <code class="reqn">P[X \le x]</code>; otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td></tr>
<tr><td><code id="PExp_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="PExp_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dpexp gives the (log) probability function, ppexp gives the (log) distribution function, qpexp gives the quantile function, and rpexp generates random deviates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 10
tgrid &lt;- c(0, 1, 3, 7, Inf)
rates &lt;- c(0.5, 4, 0.8, 0.1)
x &lt;- sort(rpexp(n, tgrid=tgrid, rates=rates))
Fx &lt;- ppexp(x, tgrid, rates)
y &lt;- qpexp(Fx, tgrid, rates)
# checking:
x==y
</code></pre>

<hr>
<h2 id='telecom'>GTE Corporation telecommunication systems</h2><span id='topic+telecom'></span>

<h3>Description</h3>

<p>Failure times (in days) of 125 installed telecommunication systems installed by GTE Corporation.
</p>


<h3>Format</h3>

<p>A data frame with 125 rows and 2 variables:
</p>

<ul>
<li><p> time: vector of failure times (in days)
</p>
</li>
<li><p> status: vector of failure indicator
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Fabio N. Demarqui <a href="mailto:fndemarqui@est.ufmg.br">fndemarqui@est.ufmg.br</a>
</p>


<h3>References</h3>

<p>Piecewise Exponential Estimator for the Survival Function. J. S. Kim and F. Proschan.
IEEE TRANSACTIONS ON RELIABILITY, VOL. 40, NO. 2, 1991.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(peppm)
data(telecom)
fit1 &lt;- with(telecom, peppm(time, status, cohesion=1, nburnin=0, nlag=1, npost=100))
fit2 &lt;- with(telecom, peppm(time, status, cohesion=2, nburnin=0, nlag=1, npost=100))
fit3 &lt;- with(telecom, peppm(time, status, cohesion=3, nburnin=0, nlag=1, npost=100))
fit4 &lt;- with(telecom, peppm(time, status, cohesion=4, nburnin=0, nlag=1, npost=100))
# time grid associated with the first line of the matrix U:

</code></pre>

<hr>
<h2 id='timeGrid'>Time grid for the PE distribution</h2><span id='topic+timeGrid'></span>

<h3>Description</h3>

<p>This function make use of the observed times and failure indicators to create a time grid for the PE distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timeGrid(time, status, n.int = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="timeGrid_+3A_time">time</code></td>
<td>
<p>Vector of failure times</p>
</td></tr>
<tr><td><code id="timeGrid_+3A_status">status</code></td>
<td>
<p>Vector of failure indicators</p>
</td></tr>
<tr><td><code id="timeGrid_+3A_n.int">n.int</code></td>
<td>
<p>Optional. Number of intervals. If <code>NULL</code>, the number of intervals is
set to be equal to the number of distinct observed failure times.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the time grid needed to specify the PE distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(telecom)
tgrid1 &lt;- with(telecom, timeGrid(time, status))
tgrid1
tgrid2 &lt;- with(telecom, timeGrid(time, status, n.int = 4))
tgrid2
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
