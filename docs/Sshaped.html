<!DOCTYPE html><html lang="en"><head><title>Help for package Sshaped</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Sshaped}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Sshaped-package'>
<p>Nonparametric, Tuning-Free Estimation of S-Shaped Functions</p></a></li>
<li><a href='#cvxreg'><p>Estimation of an increasing and convex function</p></a></li>
<li><a href='#plot.sshaped'><p>Plot of a <code>sshaped</code> object</p></a></li>
<li><a href='#predict.sshaped'>
<p>Predict method for a <code>sshaped</code> fit</p></a></li>
<li><a href='#sshapedreg'><p>Estimation of an S-shaped function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric, Tuning-Free Estimation of S-Shaped Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-12</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of an S-shaped function and its corresponding inflection point via a least squares approach. A sequential mixed primal-dual based algorithm is implemented for the fast computation. Details can be found in Feng et al. (2022) &lt;<a href="https://doi.org/10.1111%2Frssb.12481">doi:10.1111/rssb.12481</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.5)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Oliver Y. Feng [aut],
  Yining Chen [aut, cre],
  Qiyang Han [aut],
  Raymond J. Carroll [aut],
  Richard J. Samworth [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yining Chen &lt;y.chen101@lse.ac.uk&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-13 10:38:00 UTC; chen</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-13 11:32:32 UTC</td>
</tr>
</table>
<hr>
<h2 id='Sshaped-package'>
Nonparametric, Tuning-Free Estimation of S-Shaped Functions</h2><span id='topic+Sshaped-package'></span><span id='topic+Sshaped'></span>

<h3>Description</h3>

<p>Estimation of an S-shaped function and its corresponding inflection point via a least squares approach. A sequential mixed primal-dual bases algorithm is implemented for the fast computation of the estimator. The same algorithm can also be used to solve other shape-restricted regression problems, such as convex regression. See Fraser and Massam (1989) and Feng et al. (2022).
</p>


<h3>Details</h3>

<p>Consider the nonparametric estimation of an S-shaped regression function. The least squares
estimator provides a very natural, tuning-free approach, but results in a non-convex optimisation problem, since the inflection point is unknown. Nevertheless, the estimator may  be regarded as a projection onto a finite union of convex cones, which allows us to propose a mixed primal-dual bases algorithm for its efficient, sequential computation. 
</p>
<p>In the current version of the package, we use this algorithm to implement the least squares regression estimator under the following shape-restrictions: S-shaped functions, i.e. increasing convex to the left of the inflection point and increasing concave to the right of the inflection point; and increasing and convex functions (as a by-product of the former). The corresponding plot and predict methods are also included. In the future, we plan to also include the estimation of additive S-shaped functions, where the covariates are multivariate for the regression.
</p>


<h3>Author(s)</h3>


<ul>
<li> <p><a href="mailto:oyf20@cam.ac.uk">Oliver Y. Feng</a>
</p>
</li>
<li> <p><a href="mailto:y.chen101@lse.ac.uk">Yining Chen</a>
</p>
</li>
<li> <p><a href="mailto:qh85@stat.rutgers.edu">Qiyang Han</a>
</p>
</li>
<li> <p><a href="mailto:carroll@stat.tamu.edu">Raymond J. Carroll</a>
</p>
</li>
<li> <p><a href="mailto:r.samworth@statslab.cam.ac.uk">Richard J. Samworth</a>
</p>
</li></ul>



<h3>References</h3>

<p>Fraser, D. A. S.  and Massam, H. (1989). A mixed primal-dual bases algorithm for regression under inequality constraints. Application to concave regression.  Scandinavian Journal of Statistics, Volume 16, Pages 65-74.
</p>
<p>Feng, O. Y., Chen, Y., Han, Q., Carroll, R. J. and Samworth, R. J. (2022). Nonparametric, tuning-free estimation of S-shaped functions. Journal of the Royal Statistical Society: Series B (Statistical Methodology), Volume 84, Issue 4, Pages 1324-1352. &lt;doi:10.1111/rssb.12481&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data
set.seed(1)
x &lt;- seq(-1,1,0.005)
y &lt;- sin(x*pi/2) + rnorm(length(x))

# Fit S-shape
output &lt;- sshapedreg(x,y)

# Plot
plot(output)

# prediction at new design points
xnew=rnorm(5)
predict(output,xnew)
</code></pre>

<hr>
<h2 id='cvxreg'>Estimation of an increasing and convex function</h2><span id='topic+cvxreg'></span>

<h3>Description</h3>

<p>This function computes the least squares increasing and convex regression estimator by a sequential mixed primal-dual bases algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvxreg(x,y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvxreg_+3A_x">x</code></td>
<td>
<p>a numeric vector that contains all the design points. NB. for the current version, we require all values to be distinct (but not necessarily in ascending order).</p>
</td></tr>
<tr><td><code id="cvxreg_+3A_y">y</code></td>
<td>
<p>a numeric vector that contains the values of the response with respect to the design points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details, see <code><a href="#topic+Sshaped">Sshaped</a></code>. 
</p>


<h3>Value</h3>

<p>An object of class <code>sshaped</code>, which contains the following fields: 
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>covariates copied from input</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>response copied from input</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>the fitted values of the regression function with respect to the design points.</p>
</td></tr>
<tr><td><code>rss</code></td>
<td>
<p>the value of the minimised residual sum of squares of the fit</p>
</td></tr>
<tr><td><code>inflection</code></td>
<td>
<p>the location of the inflection point, which equals <code>max(x)</code> here</p>
</td></tr>
<tr><td><code>shape</code></td>
<td>
<p>the shape enforced in the fit, here equals &quot;<code>convex</code>&quot;
</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<ul>
<li> <p><a href="mailto:oyf20@cam.ac.uk">Oliver Y. Feng</a>
</p>
</li>
<li> <p><a href="mailto:y.chen101@lse.ac.uk">Yining Chen</a>
</p>
</li>
<li> <p><a href="mailto:qh85@stat.rutgers.edu">Qiyang Han</a>
</p>
</li>
<li> <p><a href="mailto:carroll@stat.tamu.edu">Raymond J. Carroll</a>
</p>
</li>
<li> <p><a href="mailto:r.samworth@statslab.cam.ac.uk">Richard J. Samworth</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-seq(0,5,0.01)
y&lt;-x^2 + rnorm(length(x))
output&lt;-cvxreg(x,y)
plot(output)
xnew=rexp(5); predict(output,xnew)
</code></pre>

<hr>
<h2 id='plot.sshaped'>Plot of a <code>sshaped</code> object</h2><span id='topic+plot.sshaped'></span>

<h3>Description</h3>

<p>This function takes a fitted <code>sshaped</code> object produced 
by <code><a href="#topic+sshapedreg">sshapedreg</a></code> or  <code><a href="#topic+cvxreg">cvxreg</a></code>,  and plots the observations, the fitted function and the location of the estimated inflection point (where applicable).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sshaped'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.sshaped_+3A_x">x</code></td>
<td>
<p>A fitted <code>sshaped</code> object produced 
by <code><a href="#topic+sshapedreg">sshapedreg</a></code> or  <code><a href="#topic+cvxreg">cvxreg</a></code>.</p>
</td></tr>
<tr><td><code id="plot.sshaped_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A plot that shows the observations, the fitted function and the location of the estimated inflection point (where applicable, i.e. when <code>object$shape</code> equals &quot;<code>sshaped</code>&quot;.).
</p>


<h3>Value</h3>

<p>No return value. A plot is produced.</p>


<h3>Author(s)</h3>


<ul>
<li> <p><a href="mailto:oyf20@cam.ac.uk">Oliver Y. Feng</a>
</p>
</li>
<li> <p><a href="mailto:y.chen101@lse.ac.uk">Yining Chen</a>
</p>
</li>
<li> <p><a href="mailto:qh85@stat.rutgers.edu">Qiyang Han</a>
</p>
</li>
<li> <p><a href="mailto:carroll@stat.tamu.edu">Raymond J. Carroll</a>
</p>
</li>
<li> <p><a href="mailto:r.samworth@statslab.cam.ac.uk">Richard J. Samworth</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+sshapedreg">sshapedreg</a></code>, <code><a href="#topic+cvxreg">cvxreg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples for the functions sshapedreg and cvxreg.
</code></pre>

<hr>
<h2 id='predict.sshaped'>
Predict method for a <code>sshaped</code> fit
</h2><span id='topic+predict.sshaped'></span>

<h3>Description</h3>

<p>This function obtains predictions at new design points from a fitted <code>sshaped</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sshaped'
predict(object, xnew, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.sshaped_+3A_object">object</code></td>
<td>
<p>A fitted <code>sshaped</code> object produced by <code><a href="#topic+sshapedreg">sshapedreg</a></code> or  <code><a href="#topic+cvxreg">cvxreg</a></code>.</p>
</td></tr>
<tr><td><code id="predict.sshaped_+3A_xnew">xnew</code></td>
<td>
<p>An optional numeric <code>vector</code> specifying the location at which prediction is required. Its values can lie outside the range of the original design points. This argument can be missing, in which case predictions are made at the same values of the covariates used to compute the object.</p>
</td></tr>
<tr><td><code id="predict.sshaped_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code>predict</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing predictions at new data points.</p>


<h3>Author(s)</h3>


<ul>
<li> <p><a href="mailto:oyf20@cam.ac.uk">Oliver Y. Feng</a>
</p>
</li>
<li> <p><a href="mailto:y.chen101@lse.ac.uk">Yining Chen</a>
</p>
</li>
<li> <p><a href="mailto:qh85@stat.rutgers.edu">Qiyang Han</a>
</p>
</li>
<li> <p><a href="mailto:carroll@stat.tamu.edu">Raymond J. Carroll</a>
</p>
</li>
<li> <p><a href="mailto:r.samworth@statslab.cam.ac.uk">Richard J. Samworth</a>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+sshapedreg">sshapedreg</a></code>, <code><a href="#topic+cvxreg">cvxreg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples for the functions sshapedreg and cvxreg.
</code></pre>

<hr>
<h2 id='sshapedreg'>Estimation of an S-shaped function</h2><span id='topic+sshapedreg'></span>

<h3>Description</h3>

<p>This function computes the least squares S-shaped regression estimator and its corresponding inflection point by a sequential mixed primal-dual bases algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sshapedreg(x,y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sshapedreg_+3A_x">x</code></td>
<td>
<p>a numeric vector that contains all the design points. NB. for the current version, we require all values to be distinct (but not necessarily in ascending order).</p>
</td></tr>
<tr><td><code id="sshapedreg_+3A_y">y</code></td>
<td>
<p>a numeric vector that contains the values of the response with respect to the design points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details, see <code><a href="#topic+Sshaped">Sshaped</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>sshaped</code>, which contains the following fields: 
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>covariates copied from input</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>response copied from input</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>the fitted values of the regression function with respect to the design points.</p>
</td></tr>
<tr><td><code>rss</code></td>
<td>
<p>the value of the minimised residual sum of squares of the fit</p>
</td></tr>
<tr><td><code>inflection</code></td>
<td>
<p>the estimated location of the inflection point</p>
</td></tr>
<tr><td><code>shape</code></td>
<td>
<p>the shape enforced in the fit, here equals &quot;<code>sshaped</code>&quot;
</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<ul>
<li> <p><a href="mailto:oyf20@cam.ac.uk">Oliver Y. Feng</a>
</p>
</li>
<li> <p><a href="mailto:y.chen101@lse.ac.uk">Yining Chen</a>
</p>
</li>
<li> <p><a href="mailto:qh85@stat.rutgers.edu">Qiyang Han</a>
</p>
</li>
<li> <p><a href="mailto:carroll@stat.tamu.edu">Raymond J. Carroll</a>
</p>
</li>
<li> <p><a href="mailto:r.samworth@statslab.cam.ac.uk">Richard J. Samworth</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-seq(-1,1,0.005)
y&lt;-sin(x*pi/2) + rnorm(length(x))
output&lt;-sshapedreg(x,y)
plot(output)
xnew=rnorm(5); predict(output,xnew)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
