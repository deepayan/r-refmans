<!DOCTYPE html><html><head><title>Help for package future.tests</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {future.tests}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_test_plan'><p>Add a Future Plan to Test Against</p></a></li>
<li><a href='#along_test_plans'><p>Evaluate an Expression Across A Set of Future Plans</p></a></li>
<li><a href='#check'><p>Run All or a Subset of the Tests Across Future Plans</p></a></li>
<li><a href='#check_plan'><p>Run All Tests</p></a></li>
<li><a href='#evaluate_expr'><p>Evaluate an R Expression</p></a></li>
<li><a href='#load_tests'><p>Loads Future Tests</p></a></li>
<li><a href='#make_test'><p>Make a Test</p></a></li>
<li><a href='#register_test'><p>Register a Test</p></a></li>
<li><a href='#run_test'><p>Run a Test</p></a></li>
<li><a href='#run_tests'><p>Run All Tests</p></a></li>
<li><a href='#skip_test'><p>Skip The Current Test</p></a></li>
<li><a href='#subset_tests'><p>Identify Subset of Tests with Specified Tags and that Support Specified Argument Settings</p></a></li>
<li><a href='#test_db'><p>Manage the Test Database</p></a></li>
<li><a href='#test_plans'><p>Manage the Set of Future Plans to Test Against</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Test Suite for 'Future API' Backends</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Backends implementing the 'Future' API, as defined by the 'future' package, should use the tests provided by this package to validate that they meet the minimal requirements of the 'Future' API.  The tests can be performed easily from within R or from outside of R from the command line making it straightforward to include them in package tests and in Continuous Integration (CI) pipelines.</td>
</tr>
<tr>
<td>Imports:</td>
<td>future (&ge; 1.22.1), cli, crayon, prettyunits, sessioninfo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>commonmark, base64enc, utils, tools, data.table, ff</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>future.tests</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL (&ge; 2.1)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://future.tests.futureverse.org">https://future.tests.futureverse.org</a>,
<a href="https://github.com/HenrikBengtsson/future.tests">https://github.com/HenrikBengtsson/future.tests</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/HenrikBengtsson/future.tests/issues">https://github.com/HenrikBengtsson/future.tests/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-22 03:19:28 UTC; henrik</td>
</tr>
<tr>
<td>Author:</td>
<td>Henrik Bengtsson [aut, cre, cph],
  The R Consortium [fnd] (Project was awared an Infrastructure Steering
    Committee (ISC) grant in 2017)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Henrik Bengtsson &lt;henrikb@braju.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-22 05:30:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_test_plan'>Add a Future Plan to Test Against</h2><span id='topic+add_test_plan'></span>

<h3>Description</h3>

<p>Add a Future Plan to Test Against
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_test_plan(expr, substitute = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_test_plan_+3A_expr">expr</code></td>
<td>
<p>...</p>
</td></tr>
<tr><td><code id="add_test_plan_+3A_substitute">substitute</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(invisibly) returns current list of test plans.
</p>

<hr>
<h2 id='along_test_plans'>Evaluate an Expression Across A Set of Future Plans</h2><span id='topic+along_test_plans'></span>

<h3>Description</h3>

<p>Evaluate an Expression Across A Set of Future Plans
</p>


<h3>Usage</h3>

<pre><code class='language-R'>along_test_plans(
  expr,
  substitute = TRUE,
  envir = parent.frame(),
  local = TRUE,
  plans = test_plans()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="along_test_plans_+3A_expr">expr</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> expression.</p>
</td></tr>
<tr><td><code id="along_test_plans_+3A_substitute">substitute</code></td>
<td>
<p>...</p>
</td></tr>
<tr><td><code id="along_test_plans_+3A_envir">envir</code></td>
<td>
<p>The environment where tests are run.</p>
</td></tr>
<tr><td><code id="along_test_plans_+3A_local">local</code></td>
<td>
<p>Should tests be evaluated in a local environment or not.</p>
</td></tr>
<tr><td><code id="along_test_plans_+3A_plans">plans</code></td>
<td>
<p>A list of future plans.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results, one for each future plan tested against.
</p>

<hr>
<h2 id='check'>Run All or a Subset of the Tests Across Future Plans</h2><span id='topic+check'></span>

<h3>Description</h3>

<p>Run All or a Subset of the Tests Across Future Plans
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check(
  plan = NULL,
  tags = character(),
  timeout = NULL,
  settings = TRUE,
  session_info = FALSE,
  envir = parent.frame(),
  local = TRUE,
  debug = FALSE,
  exit_value = !interactive(),
  .args = commandArgs()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_+3A_plan">plan</code></td>
<td>
<p>(character vector) One or more future strategy plans to be
validated.</p>
</td></tr>
<tr><td><code id="check_+3A_tags">tags</code></td>
<td>
<p>(character vector; optional) Filter test by tags. If NULL, all
tests are performed.</p>
</td></tr>
<tr><td><code id="check_+3A_timeout">timeout</code></td>
<td>
<p>(numeric; optional) Maximum time (in seconds) each test may
run before a timeout error is produced.</p>
</td></tr>
<tr><td><code id="check_+3A_settings">settings</code></td>
<td>
<p>(logical) If TRUE, details on the settings are outputted
before the tests start.</p>
</td></tr>
<tr><td><code id="check_+3A_session_info">session_info</code></td>
<td>
<p>(logical) If TRUE, session information is outputted
after the tests complete.</p>
</td></tr>
<tr><td><code id="check_+3A_envir">envir</code></td>
<td>
<p>The environment where tests are run.</p>
</td></tr>
<tr><td><code id="check_+3A_local">local</code></td>
<td>
<p>Should tests be evaluated in a local environment or not.</p>
</td></tr>
<tr><td><code id="check_+3A_debug">debug</code></td>
<td>
<p>(logical) If TRUE, the raw test results are printed.</p>
</td></tr>
<tr><td><code id="check_+3A_exit_value">exit_value</code></td>
<td>
<p>(logical) If TRUE, and in a non-interactive session,
then use <code><a href="base.html#topic+quit">base::quit()</a></code> to quit <span class="rlang"><b>R</b></span> with an exit code of 0 (zero) if all
tests passed with all OKs and otherwise 1 (one) if one or more test failed.</p>
</td></tr>
<tr><td><code id="check_+3A_.args">.args</code></td>
<td>
<p>(character vector; optional) Command-line arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(list; invisible) A list of test results.
</p>


<h3>Command-line interface (CLI)</h3>

<p>This function can be called from the shell. To specify an argument, use the
format <code style="white-space: pre;">&#8288;--test-&lt;arg_name&gt;=&lt;value&gt;&#8288;</code>.  For example, <code>--test-timeout=600</code> will
set argument <code>timeout=600</code>, and <code style="white-space: pre;">&#8288;--tags=lazy,rng&#8288;</code>, or equivalently,
<code>--tags=lazy --tags=rng</code> will set argument <code>tags=c("lazy", "rng")</code>.
</p>
<p>Here are some examples on how to call this function from the command line:
</p>
<pre>
Rscript -e future.tests::check --args --test-plan=sequential
Rscript -e future.tests::check --args --test-plan=multicore,workers=2
Rscript -e future.tests::check --args --test-plan=sequential --test-plan=multicore,workers=2
Rscript -e future.tests::check --args --test-plan=future.callr::callr
Rscript -e future.tests::check --args --test-plan=future.batchtools::batchtools_local
</pre>
<p>The exit code will be 0 if all tests passed, otherwise 1. You
can use for instance <code style="white-space: pre;">&#8288;exit_code=$?&#8288;</code> to retrieve the exit code of the
most recent call.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
results &lt;- future.tests::check(plan = "sequential", tags = c("rng"))
exit_code &lt;- attr(results, "exit_code")
if (exit_code != 0) stop("One or more tests failed")

## End(Not run)

</code></pre>

<hr>
<h2 id='check_plan'>Run All Tests</h2><span id='topic+check_plan'></span>

<h3>Description</h3>

<p>Run All Tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_plan(
  tests = test_db(),
  defaults = list(),
  timeout = getOption("future.tests.timeout", 30),
  envir = parent.frame(),
  local = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_plan_+3A_tests">tests</code></td>
<td>
<p>A list of tests to subset.</p>
</td></tr>
<tr><td><code id="check_plan_+3A_defaults">defaults</code></td>
<td>
<p>(optional) Named list with default argument values.</p>
</td></tr>
<tr><td><code id="check_plan_+3A_timeout">timeout</code></td>
<td>
<p>Maximum time allowed for evaluation before a timeout error is produced.</p>
</td></tr>
<tr><td><code id="check_plan_+3A_envir">envir</code></td>
<td>
<p>The environment where tests are run.</p>
</td></tr>
<tr><td><code id="check_plan_+3A_local">local</code></td>
<td>
<p>Should tests be evaluated in a local environment or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing.
</p>

<hr>
<h2 id='evaluate_expr'>Evaluate an R Expression</h2><span id='topic+evaluate_expr'></span>

<h3>Description</h3>

<p>Evaluate an R Expression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_expr(
  expr,
  envir = parent.frame(),
  local = TRUE,
  output = c("stdout+stderr", "stdout", "none"),
  timeout = +Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_expr_+3A_expr">expr</code></td>
<td>
<p>An expression</p>
</td></tr>
<tr><td><code id="evaluate_expr_+3A_envir">envir</code></td>
<td>
<p>The environment where tests are run.</p>
</td></tr>
<tr><td><code id="evaluate_expr_+3A_local">local</code></td>
<td>
<p>Should tests be evaluated in a local environment or not.</p>
</td></tr>
<tr><td><code id="evaluate_expr_+3A_output">output</code></td>
<td>
<p>Specifies whether standard output, standard error, or both should be captured or not.</p>
</td></tr>
<tr><td><code id="evaluate_expr_+3A_timeout">timeout</code></td>
<td>
<p>Maximum time allowed for evaluation before a timeout error is produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of test expression and benchmark information.
</p>

<hr>
<h2 id='load_tests'>Loads Future Tests</h2><span id='topic+load_tests'></span>

<h3>Description</h3>

<p>Loads Future Tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_tests(
  path = ".",
  recursive = TRUE,
  pattern = "[.]R$",
  root = getOption("future.tests.root", Sys.getenv("R_FUTURE_TESTS_ROOT",
    system.file("test-db", package = "future.tests", mustWork = TRUE)))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_tests_+3A_path">path</code></td>
<td>
<p>A character string specifying a test script folder or file.</p>
</td></tr>
<tr><td><code id="load_tests_+3A_recursive">recursive</code></td>
<td>
<p>If TRUE, test-definition scripts are search recursively.</p>
</td></tr>
<tr><td><code id="load_tests_+3A_pattern">pattern</code></td>
<td>
<p>Regular expression matching filenames to include.</p>
</td></tr>
<tr><td><code id="load_tests_+3A_root">root</code></td>
<td>
<p>(internal) An alternative file directory from where
<span class="pkg">future.tests</span> tests are sourced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(invisible) the value of <code>test_db()</code>.
</p>

<hr>
<h2 id='make_test'>Make a Test</h2><span id='topic+make_test'></span>

<h3>Description</h3>

<p>Make a Test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_test(
  expr,
  title = NA_character_,
  args = list(),
  tags = NULL,
  substitute = TRUE,
  reset_workers = FALSE,
  register = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_test_+3A_expr">expr</code>, <code id="make_test_+3A_substitute">substitute</code></td>
<td>
<p>The expression to be tested and
whether it is passes as an expression already or not.</p>
</td></tr>
<tr><td><code id="make_test_+3A_title">title</code></td>
<td>
<p>(character) The title of the test.</p>
</td></tr>
<tr><td><code id="make_test_+3A_args">args</code></td>
<td>
<p>(optional) Named arguments.</p>
</td></tr>
<tr><td><code id="make_test_+3A_tags">tags</code></td>
<td>
<p>(optional) Character vector of tags.</p>
</td></tr>
<tr><td><code id="make_test_+3A_reset_workers">reset_workers</code></td>
<td>
<p>(optional) Specifies whether background workers should
futures.</p>
</td></tr>
<tr><td><code id="make_test_+3A_register">register</code></td>
<td>
<p>If TRUE, the test is registered in the test database,
otherwise not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(invisibly) A Test.
</p>

<hr>
<h2 id='register_test'>Register a Test</h2><span id='topic+register_test'></span>

<h3>Description</h3>

<p>Register a Test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>register_test(test)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="register_test_+3A_test">test</code></td>
<td>
<p>A Test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(invisibly) The Test registered.
</p>

<hr>
<h2 id='run_test'>Run a Test</h2><span id='topic+run_test'></span>

<h3>Description</h3>

<p>Run a Test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_test(
  test,
  envir = parent.frame(),
  local = TRUE,
  args = list(),
  defaults = list(),
  output = "stdout+stderr",
  timeout = getOption("future.tests.timeout", 30)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_test_+3A_test">test</code></td>
<td>
<p>A Test.</p>
</td></tr>
<tr><td><code id="run_test_+3A_envir">envir</code></td>
<td>
<p>The environment where tests are run.</p>
</td></tr>
<tr><td><code id="run_test_+3A_local">local</code></td>
<td>
<p>Should tests be evaluated in a local environment or not.</p>
</td></tr>
<tr><td><code id="run_test_+3A_args">args</code></td>
<td>
<p>Arguments used in this test.</p>
</td></tr>
<tr><td><code id="run_test_+3A_defaults">defaults</code></td>
<td>
<p>(optional) Named list with default argument values.</p>
</td></tr>
<tr><td><code id="run_test_+3A_output">output</code></td>
<td>
<p>If TRUE, standard output is captured, otherwise not.</p>
</td></tr>
<tr><td><code id="run_test_+3A_timeout">timeout</code></td>
<td>
<p>Maximum time allowed for evaluation before a timeout error is produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of test expression and benchmark information.
</p>

<hr>
<h2 id='run_tests'>Run All Tests</h2><span id='topic+run_tests'></span>

<h3>Description</h3>

<p>Run All Tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_tests(
  tests = test_db(),
  envir = parent.frame(),
  local = TRUE,
  defaults = list(),
  output = "stdout+stderr"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_tests_+3A_tests">tests</code></td>
<td>
<p>A list of tests to subset.</p>
</td></tr>
<tr><td><code id="run_tests_+3A_envir">envir</code></td>
<td>
<p>The environment where tests are run.</p>
</td></tr>
<tr><td><code id="run_tests_+3A_local">local</code></td>
<td>
<p>Should tests be evaluated in a local environment or not.</p>
</td></tr>
<tr><td><code id="run_tests_+3A_defaults">defaults</code></td>
<td>
<p>(optional) Named list with default argument values.</p>
</td></tr>
<tr><td><code id="run_tests_+3A_output">output</code></td>
<td>
<p>If TRUE, standard output is captured, otherwise not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of test results.
</p>

<hr>
<h2 id='skip_test'>Skip The Current Test</h2><span id='topic+skip_test'></span>

<h3>Description</h3>

<p>Signals a <code>TestSkipped</code> condition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skip_test(..., domain = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="skip_test_+3A_...">...</code></td>
<td>
<p>zero or more objects which can be coerced to character
(and which are pasted together with no separator) or (for
<code>message</code> only) a single condition object.</p>
</td></tr>
<tr><td><code id="skip_test_+3A_domain">domain</code></td>
<td>
<p>see <code><a href="base.html#topic+gettext">gettext</a></code>.  If <code>NA</code>, messages will
not be translated, see also the note in <code><a href="base.html#topic+stop">stop</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(invisible) A <a href="base.html#topic+conditions">base::condition</a> of class <code>TestSkipped</code>.
</p>

<hr>
<h2 id='subset_tests'>Identify Subset of Tests with Specified Tags and that Support Specified Argument Settings</h2><span id='topic+subset_tests'></span>

<h3>Description</h3>

<p>Identify Subset of Tests with Specified Tags and that Support Specified Argument Settings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_tests(tests = test_db(), tags = NULL, args = NULL, defaults = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_tests_+3A_tests">tests</code></td>
<td>
<p>A list of tests to subset.</p>
</td></tr>
<tr><td><code id="subset_tests_+3A_tags">tags</code></td>
<td>
<p>(optional) A character vector of tags that tests must have.</p>
</td></tr>
<tr><td><code id="subset_tests_+3A_args">args</code></td>
<td>
<p>Named arguments with sets of values to test against.</p>
</td></tr>
<tr><td><code id="subset_tests_+3A_defaults">defaults</code></td>
<td>
<p>(optional) Named list with default argument values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of tests that support specified arguments.
</p>

<hr>
<h2 id='test_db'>Manage the Test Database</h2><span id='topic+test_db'></span>

<h3>Description</h3>

<p>Manage the Test Database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_db(action = c("list", "append", "reset"), test = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_db_+3A_action">action</code></td>
<td>
<p>(character) What should be done.</p>
</td></tr>
<tr><td><code id="test_db_+3A_test">test</code></td>
<td>
<p>A Test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(invisibly) the internal list of Test:s.
</p>

<hr>
<h2 id='test_plans'>Manage the Set of Future Plans to Test Against</h2><span id='topic+test_plans'></span>

<h3>Description</h3>

<p>Manage the Set of Future Plans to Test Against
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_plans(action = c("list", "add", "reset"), expr = NULL, substitute = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_plans_+3A_action">action</code></td>
<td>
<p>...</p>
</td></tr>
<tr><td><code id="test_plans_+3A_expr">expr</code></td>
<td>
<p>...</p>
</td></tr>
<tr><td><code id="test_plans_+3A_substitute">substitute</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(invisibly) returns current list of test plans.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
