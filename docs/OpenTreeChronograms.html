<!DOCTYPE html><html><head><title>Help for package OpenTreeChronograms</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {OpenTreeChronograms}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.get_ott_lineage'><p>Get the lineage of a set of taxa.</p>
<code>.get_ott_lineage</code> uses <code>rotl::taxonomy_taxon_info()</code> with <code>include_lineage = TRUE</code>.</a></li>
<li><a href='#check_ott_input'><p>Check input for other functions</p></a></li>
<li><a href='#classification_paths_from_taxonomy'><p>Gets classification paths for a vector of taxa</p></a></li>
<li><a href='#clean_ott_chronogram'><p>Clean up some issues with Open Tree of Life chronograms</p>
For now it 1) checks unmapped taxa and maps them with tnrs_match.phylo, 2) roots the chronogram if unrooted</a></li>
<li><a href='#clean_taxon_info_children'><p>Identify, extract and clean taxonomic children names from a <code>taxonomy_taxon_info()</code></p>
output.</a></li>
<li><a href='#clean_tnrs'><p>Eliminates unmatched (NAs) and invalid taxa from a <code>rotl::tnrs_match_names()</code> or <code>tnrs_match()</code> output.</p>
Useful to get ott ids to retrieve an induced synthetic Open Tree of Life.
Needed because using <code>include_suppressed = FALSE</code> in <code>rotl::tnrs_match_names()</code> does not drop all invalid taxa.</a></li>
<li><a href='#date_with_pbdb'><p>Date with Paleobiology Database and paleotree.</p></a></li>
<li><a href='#extract_ott_ids'><p>Get OTT ids from a character vector containing species names and OTT ids.</p></a></li>
<li><a href='#get_fossil_range'><p>Get the ages for a taxon from PBDB</p></a></li>
<li><a href='#get_opentree_chronograms'><p>Get all chronograms from Open Tree of Life database</p></a></li>
<li><a href='#get_ott_children'><p>Use this instead of <code>rotl::tol_subtree()</code> when taxa are not in synthesis tree and</p>
you still need to get all species or an induced OpenTree subtree</a></li>
<li><a href='#get_ott_clade'><p>Get the Open Tree of Life Taxonomic identifiers (OTT ids) and name of one or</p>
several given taxonomic ranks from one or more input taxa.</a></li>
<li><a href='#get_ott_lineage'><p>Get the Open Tree of Life Taxonomic identifier (OTT id) and name of all lineages</p>
from one or more input taxa.</a></li>
<li><a href='#get_valid_children'><p>Extract valid children from given taxonomic name(s) or Open Tree of Life</p>
Taxonomic identifiers (OTT ids) from a taxonomic source.</a></li>
<li><a href='#is_good_chronogram'><p>Check if a tree is a valid chronogram.</p></a></li>
<li><a href='#is_phylo'><p>Checks if <code>phy</code> is a <code>phylo</code> object and/or a chronogram.</p></a></li>
<li><a href='#make_all_associations'><p>Find all authors and where they have deposited their trees</p></a></li>
<li><a href='#make_contributor_cache'><p>Create a cache  from Open Tree of Life</p></a></li>
<li><a href='#make_otol_associations'><p>Associate Open Tree of Life authors with studies</p></a></li>
<li><a href='#make_overlap_table'><p>Create an overlap table</p></a></li>
<li><a href='#make_treebase_associations'><p>Associate TreeBase authors with studies</p></a></li>
<li><a href='#make_treebase_cache'><p>Create a cache from TreeBase</p></a></li>
<li><a href='#map_nodes_ott'><p>Add Open Tree of Life Taxonomy to tree nodes.</p></a></li>
<li><a href='#opentree_chronograms'><p>Open Tree of Life Chronogram database in R</p></a></li>
<li><a href='#phylo_has_brlen'><p>Check if a tree has branch lengths</p></a></li>
<li><a href='#phylo_tiplabel_space_to_underscore'><p>Convert spaces to underscores in trees.</p></a></li>
<li><a href='#phylo_tiplabel_underscore_to_space'><p>Convert underscores to spaces in trees.</p></a></li>
<li><a href='#problematic_chronograms'><p>Problematic chronograms from Open Tree of Life.</p></a></li>
<li><a href='#recover_mrcaott'><p>Get an mrcaott tag from an OpenTree induced synthetic tree and get its name and ott id</p></a></li>
<li><a href='#summarize_fossil_range'><p>Summarize taxon age from PBDB to just a single min and max age</p></a></li>
<li><a href='#tnrs_match'><p>Taxon name resolution service (tnrs) applied to a vector of names by batches</p></a></li>
<li><a href='#tree_from_taxonomy'><p>Gets a taxonomic tree from a vector of taxa</p></a></li>
<li><a href='#update_all_cached'><p>Update all data files as data objects for the package</p></a></li>
<li><a href='#update_datelife_cache'><p>Create an updated OpenTree chronograms database object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Open Tree of Life Chronograms</td>
</tr>
<tr>
<td>Version:</td>
<td>2022.1.28</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Luna L. Sanchez Reyes &lt;sanchez.reyes.luna@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Chronogram database constructed from Open Tree of Life's phylogenetic store.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, geiger, knitcitations, paleotree, plyr, rotl, stringr,
taxize, treebase, usethis</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-20 08:38:00 UTC; luna</td>
</tr>
<tr>
<td>Author:</td>
<td>Brian O'Meara [aut],
  Luna L. Sanchez Reyes [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-22 07:10:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='.get_ott_lineage'>Get the lineage of a set of taxa.
<code>.get_ott_lineage</code> uses <code><a href="rotl.html#topic+taxonomy_taxon_info">rotl::taxonomy_taxon_info()</a></code> with <code>include_lineage = TRUE</code>.</h2><span id='topic+.get_ott_lineage'></span>

<h3>Description</h3>

<p>Get the lineage of a set of taxa.
<code>.get_ott_lineage</code> uses <code><a href="rotl.html#topic+taxonomy_taxon_info">rotl::taxonomy_taxon_info()</a></code> with <code>include_lineage = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_ott_lineage(input_ott_match)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_ott_lineage_+3A_input_ott_match">input_ott_match</code></td>
<td>
<p>An Output of check_ott_input function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A taxonomy_taxon_info object
</p>

<hr>
<h2 id='check_ott_input'>Check input for other functions</h2><span id='topic+check_ott_input'></span>

<h3>Description</h3>

<p><code style="white-space: pre;">&#8288;check_ott_input is currently used in functions &#8288;</code><code><a href="#topic+get_ott_clade">get_ott_clade()</a></code>,
<code><a href="#topic+get_ott_children">get_ott_children()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_ott_input(input = NULL, ott_ids = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_ott_input_+3A_input">input</code></td>
<td>
<p>Optional. A character vector of names.</p>
</td></tr>
<tr><td><code id="check_ott_input_+3A_ott_ids">ott_ids</code></td>
<td>
<p>If not NULL, it takes this argument and ignores input. A
numeric vector of ott ids obtained with <code><a href="rotl.html#topic+taxonomy_taxon_info">rotl::taxonomy_taxon_info()</a></code> or
<code><a href="rotl.html#topic+tnrs_match_names">rotl::tnrs_match_names()</a></code> or <code><a href="#topic+tnrs_match">tnrs_match()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, it uses the <code>ott_id</code> argument if it is not NULL.
</p>


<h3>Value</h3>

<p>A named numeric vector of valid Open Tree Taxonomy (OTT) ids.
</p>

<hr>
<h2 id='classification_paths_from_taxonomy'>Gets classification paths for a vector of taxa</h2><span id='topic+classification_paths_from_taxonomy'></span>

<h3>Description</h3>

<p>This uses the taxize package's wrapper of the Global Names Resolver to get taxonomic paths for the vector of taxa you pass in. Sources is a vector of source labels in order (though it works best if everything uses the same taxonomy, so we recommend doing just one source). You can see options by doing taxize::gnr_datasources(). Our default is Catalogue of Life
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classification_paths_from_taxonomy(taxa, sources = "Catalogue of Life")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classification_paths_from_taxonomy_+3A_taxa">taxa</code></td>
<td>
<p>Vector of taxon names</p>
</td></tr>
<tr><td><code id="classification_paths_from_taxonomy_+3A_sources">sources</code></td>
<td>
<p>Vector of names of preferred sources; see taxize::gnr_datasources(). Currently supports 100 taxonomic resources, see details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Taxonomies supported by taxize::gnr_datasources()
</p>

<ol>
<li><p> Catalogue of Life
</p>
</li>
<li><p> Wikispecies
</p>
</li>
<li><p> ITIS
</p>
</li>
<li><p> NCBI
</p>
</li>
<li><p> Index Fungorum
</p>
</li>
<li><p> GRIN Taxonomy for Plants
</p>
</li>
<li><p> Union 4
</p>
</li>
<li><p> The Interim Register of Marine and Nonmarine Genera
</p>
</li>
<li><p> World Register of Marine Species
</p>
</li>
<li><p> Freebase
</p>
</li>
<li><p> GBIF Backbone Taxonomy
</p>
</li>
<li><p> EOL
</p>
</li>
<li><p> Passiflora vernacular names
</p>
</li>
<li><p> Inventory of Fish Species in the Wami River Basin
</p>
</li>
<li><p> Pheasant Diversity and Conservation in the Mt. Gaoligonshan Region
</p>
</li>
<li><p> Finding Species
</p>
</li>
<li><p> Birds of Lindi Forests Plantation
</p>
</li>
<li><p> Nemertea
</p>
</li>
<li><p> Kihansi Gorge Amphibian Species Checklist
</p>
</li>
<li><p> Mushroom Observer
</p>
</li>
<li><p> TaxonConcept
</p>
</li>
<li><p> Amphibia and Reptilia of Yunnan
</p>
</li>
<li><p> Common names of Chilean Plants
</p>
</li>
<li><p> Invasive Species of Belgium
</p>
</li>
<li><p> ZooKeys
</p>
</li>
<li><p> COA Wildlife Conservation List
</p>
</li>
<li><p> AskNature
</p>
</li>
<li><p> China: Yunnan, Southern Gaoligongshan, Rapid Biological Inventories Report No. 04
</p>
</li>
<li><p> Native Orchids from Gaoligongshan Mountains, China
</p>
</li>
<li><p> Illinois Wildflowers
</p>
</li>
<li><p> Coleorrhyncha Species File
</p>
</li>
<li><p> /home/dimus/files/dwca/zoological names.zip
</p>
</li>
<li><p> Peces de la zona hidrogeográfica de la Amazonia, Colombia (Spreadsheet)
</p>
</li>
<li><p> Eastern Mediterranean Syllidae
</p>
</li>
<li><p> Gaoligong Shan Medicinal Plants Checklist
</p>
</li>
<li><p> birds_of_tanzania
</p>
</li>
<li><p> AmphibiaWeb
</p>
</li>
<li><p> tanzania_plant_sepecimens
</p>
</li>
<li><p> Papahanaumokuakea Marine National Monument
</p>
</li>
<li><p> Taiwanese IUCN species list
</p>
</li>
<li><p> BioPedia
</p>
</li>
<li><p> AnAge
</p>
</li>
<li><p> Embioptera Species File
</p>
</li>
<li><p> Global Invasive Species Database
</p>
</li>
<li><p> Sendoya S., Fernández F. AAT de hormigas (Hymenoptera: Formicidae) del Neotrópico 1.0 2004 (Spreadsheet)
</p>
</li>
<li><p> Flora of Gaoligong Mountains
</p>
</li>
<li><p> ARKive
</p>
</li>
<li><p> True Fruit Flies (Diptera, Tephritidae) of the Afrotropical Region
</p>
</li>
<li><p> 3i - Typhlocybinae Database
</p>
</li>
<li><p> CATE Sphingidae
</p>
</li>
<li><p> ZooBank
</p>
</li>
<li><p> Diatoms
</p>
</li>
<li><p> AntWeb
</p>
</li>
<li><p> Endemic species in Taiwan
</p>
</li>
<li><p> Dermaptera Species File
</p>
</li>
<li><p> Mantodea Species File
</p>
</li>
<li><p> Birds of the World: Recommended English Names
</p>
</li>
<li><p> New Zealand Animalia
</p>
</li>
<li><p> Blattodea Species File
</p>
</li>
<li><p> Plecoptera Species File
</p>
</li>
<li><p> /home/dimus/files/dwca/clemens.zip
</p>
</li>
<li><p> Coreoidea Species File
</p>
</li>
<li><p> Freshwater Animal Diversity Assessment - Normalized export
</p>
</li>
<li><p> Catalogue of Vascular Plant Species of Central and Northeastern Brazil
</p>
</li>
<li><p> Wikipedia in EOL
</p>
</li>
<li><p> Database of Vascular Plants of Canada (VASCAN)
</p>
</li>
<li><p> Phasmida Species File
</p>
</li>
<li><p> OBIS
</p>
</li>
<li><p> USDA NRCS PLANTS Database
</p>
</li>
<li><p> Catalog of Fishes
</p>
</li>
<li><p> Aphid Species File
</p>
</li>
<li><p> The National Checklist of Taiwan
</p>
</li>
<li><p> Psocodea Species File
</p>
</li>
<li><p> FishBase
</p>
</li>
<li><p> 3i - Typhlocybinae Database
</p>
</li>
<li><p> Belgian Species List
</p>
</li>
<li><p> EUNIS
</p>
</li>
<li><p> CU*STAR
</p>
</li>
<li><p> Orthoptera Species File
</p>
</li>
<li><p> Bishop Museum
</p>
</li>
<li><p> IUCN Red List of Threatened Species
</p>
</li>
<li><p> BioLib.cz
</p>
</li>
<li><p> Tropicos - Missouri Botanical Garden
</p>
</li>
<li><p> nlbif
</p>
</li>
<li><p> The International Plant Names Index
</p>
</li>
<li><p> Index to Organism Names
</p>
</li>
<li><p> uBio NameBank
</p>
</li>
<li><p> Arctos
</p>
</li>
<li><p> Checklist of Beetles (Coleoptera) of Canada and Alaska. Second Edition.
</p>
</li>
<li><p> The Paleobiology Database
</p>
</li>
<li><p> The Reptile Database
</p>
</li>
<li><p> The Mammal Species of The World
</p>
</li>
<li><p> BirdLife International
</p>
</li>
<li><p> Checklist da Flora de Portugal (Continental, Açores e Madeira)
</p>
</li>
<li><p> FishBase Cache
</p>
</li>
<li><p> Silva
</p>
</li>
<li><p> Open Tree of Life Reference Taxonomy
</p>
</li>
<li><p> iNaturalist
</p>
</li>
<li><p> The Interim Register of Marine and Nonmarine Genera
</p>
</li>
<li><p> Gymno
</p>
</li></ol>



<h3>Value</h3>

<p>A list with resolved taxa (a tibble, from taxize::gnr_resolve) and a vector of taxa not resolved
</p>

<hr>
<h2 id='clean_ott_chronogram'>Clean up some issues with Open Tree of Life chronograms
For now it 1) checks unmapped taxa and maps them with tnrs_match.phylo, 2) roots the chronogram if unrooted</h2><span id='topic+clean_ott_chronogram'></span>

<h3>Description</h3>

<p>Clean up some issues with Open Tree of Life chronograms
For now it 1) checks unmapped taxa and maps them with tnrs_match.phylo, 2) roots the chronogram if unrooted
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_ott_chronogram(phy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_ott_chronogram_+3A_phy">phy</code></td>
<td>
<p>A <code>phylo</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There is no limit to the number of names that can be queried and matched.
</p>
<p>The output will preserve all elements from original input phylo object and will add
</p>

<dl>
<dt>phy$mapped</dt><dd><p>A character vector indicating the state of mapping of phy$tip.labels:</p>
</dd>
</dl>

<dl>
<dt>original</dt><dd><p>Tnrs matching was not attempted. Original labeling is preserved.</p>
</dd>
<dt>ott</dt><dd><p>Matching was manually made by a curator in Open Tree of Life.</p>
</dd>
<dt>tnrs</dt><dd><p>Tnrs matching was attempted and successful with no approximate matching. Original label is replaced by the matched name.</p>
</dd>
<dt>approximated</dt><dd><p>Tnrs matching was attempted and successful but with approximate matching. Original labeling is preserved.</p>
</dd>
<dt>unmatched</dt><dd><p>Tnrs matching was attempted and unsuccessful. Original labeling is preserved.</p>
</dd>
</dl>

<dl>
<dt>phy$original.tip.label</dt><dd><p>A character vector preserving all original labels.</p>
</dd>
<dt>phy$ott_ids</dt><dd><p>A numeric vector with ott id numbers of matched tips. Unmatched and original tips will be NaN.</p>
</dd>
</dl>

<p>if tips are duplicated, tnrs will only be run once (avoiding increases in function running time) but the result will be applied to all duplicated tip labels
</p>


<h3>Value</h3>

<p>An object of class  data frame or phylo, with the added class match_names.
</p>
<p><code>NULL</code>
</p>
<p><code>NULL</code>
</p>

<hr>
<h2 id='clean_taxon_info_children'>Identify, extract and clean taxonomic children names from a <code>taxonomy_taxon_info()</code>
output.</h2><span id='topic+clean_taxon_info_children'></span>

<h3>Description</h3>

<p><code>clean_taxon_info_children</code> eliminates all taxa that will give
problems when trying to retrieve an induced subtree from Open Tree of Life.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_taxon_info_children(
  taxon_info,
  invalid = c("barren", "extinct", "uncultured", "major_rank_conflict",
    "incertae_sedis", "unplaced", "conflict", "environmental", "not_otu", "hidden",
    "hybrid")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_taxon_info_children_+3A_taxon_info">taxon_info</code></td>
<td>
<p>An output of <code><a href="rotl.html#topic+taxonomy_taxon_info">rotl::taxonomy_taxon_info()</a></code>.</p>
</td></tr>
<tr><td><code id="clean_taxon_info_children_+3A_invalid">invalid</code></td>
<td>
<p>A character vector of &quot;flags&quot;, i.e., characteristics that are
used by Open Tree of Life Taxonomy to detect invalid taxon names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with valid children unique OTT names, OTT ids and taxonomic ranks.
</p>

<hr>
<h2 id='clean_tnrs'>Eliminates unmatched (NAs) and invalid taxa from a <code><a href="rotl.html#topic+tnrs_match_names">rotl::tnrs_match_names()</a></code> or <code><a href="#topic+tnrs_match">tnrs_match()</a></code> output.
Useful to get ott ids to retrieve an induced synthetic Open Tree of Life.
Needed because using <code>include_suppressed = FALSE</code> in <code><a href="rotl.html#topic+tnrs_match_names">rotl::tnrs_match_names()</a></code> does not drop all invalid taxa.</h2><span id='topic+clean_tnrs'></span>

<h3>Description</h3>

<p>Eliminates unmatched (NAs) and invalid taxa from a <code><a href="rotl.html#topic+tnrs_match_names">rotl::tnrs_match_names()</a></code> or <code><a href="#topic+tnrs_match">tnrs_match()</a></code> output.
Useful to get ott ids to retrieve an induced synthetic Open Tree of Life.
Needed because using <code>include_suppressed = FALSE</code> in <code><a href="rotl.html#topic+tnrs_match_names">rotl::tnrs_match_names()</a></code> does not drop all invalid taxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_tnrs(
  tnrs,
  invalid = c("barren", "extinct", "uncultured", "major_rank_conflict", "incertae",
    "unplaced", "conflict", "environmental", "not_otu"),
  remove_nonmatches = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_tnrs_+3A_tnrs">tnrs</code></td>
<td>
<p>A <code>data.frame</code>, usually an output from <code><a href="#topic+tnrs_match">tnrs_match()</a></code> or <code><a href="rotl.html#topic+tnrs_match_names">rotl::tnrs_match_names()</a></code>, but see details.</p>
</td></tr>
<tr><td><code id="clean_tnrs_+3A_invalid">invalid</code></td>
<td>
<p>A character string with flags to be removed from final object.</p>
</td></tr>
<tr><td><code id="clean_tnrs_+3A_remove_nonmatches">remove_nonmatches</code></td>
<td>
<p>Boolean, whether to remove unsuccessfully matched names or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input can be any data frame or named list that relates taxa stored in an element named &quot;unique&quot; to a validity category stored in &quot;flags&quot;.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> or named list (depending on the input) with valid taxa only.
</p>

<hr>
<h2 id='date_with_pbdb'>Date with Paleobiology Database and paleotree.</h2><span id='topic+date_with_pbdb'></span>

<h3>Description</h3>

<p>This will take a topology, look up information about fossils for taxa on the tree, and use <code><a href="paleotree.html#topic+timePaleoPhy">paleotree::timePaleoPhy()</a></code> to compute branch lengths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>date_with_pbdb(phy, recent = FALSE, assume_recent_if_missing = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="date_with_pbdb_+3A_phy">phy</code></td>
<td>
<p>A <code>phylo</code> object.</p>
</td></tr>
<tr><td><code id="date_with_pbdb_+3A_recent">recent</code></td>
<td>
<p>If <code>TRUE</code>, forces the minimum age to be zero for any taxon</p>
</td></tr>
<tr><td><code id="date_with_pbdb_+3A_assume_recent_if_missing">assume_recent_if_missing</code></td>
<td>
<p>If <code>TRUE</code>, any taxon missing from PBDB is assumed to be recent.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dated tree.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

taxa &lt;- c(
  "Archaeopteryx", "Pinus", "Quetzalcoatlus", "Homo sapiens",
  "Tyrannosaurus rex", "Megatheriidae", "Metasequoia", "Aedes", "Panthera"
)
phy &lt;- tree_from_taxonomy(taxa, sources = "The Paleobiology Database")$phy
 # end donttest
</code></pre>

<hr>
<h2 id='extract_ott_ids'>Get OTT ids from a character vector containing species names and OTT ids.</h2><span id='topic+extract_ott_ids'></span><span id='topic+extract_ott_ids.default'></span>

<h3>Description</h3>

<p>Get OTT ids from a character vector containing species names and OTT ids.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_ott_ids(x, na.rm = TRUE)

## Default S3 method:
extract_ott_ids(x, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_ott_ids_+3A_x">x</code></td>
<td>
<p>A character vector of taxon names, or a phylo object with tip names containing OTT ids.</p>
</td></tr>
<tr><td><code id="extract_ott_ids_+3A_na.rm">na.rm</code></td>
<td>
<p>A logical value indicating whether <code>NA</code> values should be stripped from the output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class numeric containing OTT ids only.
</p>
<p><code>NULL</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>canis &lt;- rotl::tnrs_match_names("canis")
canis_taxonomy &lt;- rotl::taxonomy_subtree(canis$ott_id)
my_ott_ids &lt;- extract_ott_ids(x = canis_taxonomy$tip_label)
# Get the problematic elements from input
canis_taxonomy$tip_label[attr(my_ott_ids, "na.action")]
</code></pre>

<hr>
<h2 id='get_fossil_range'>Get the ages for a taxon from PBDB</h2><span id='topic+get_fossil_range'></span>

<h3>Description</h3>

<p>This uses the Paleobiology Database's API to gather information on the ages for all specimens of a taxon. It will also look for all descendants of the taxon. It fixes name misspellings if possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fossil_range(taxon, recent = FALSE, assume_recent_if_missing = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_fossil_range_+3A_taxon">taxon</code></td>
<td>
<p>The scientific name of the taxon you want the range of occurrences of</p>
</td></tr>
<tr><td><code id="get_fossil_range_+3A_recent">recent</code></td>
<td>
<p>If TRUE, forces the minimum age to be zero</p>
</td></tr>
<tr><td><code id="get_fossil_range_+3A_assume_recent_if_missing">assume_recent_if_missing</code></td>
<td>
<p>If TRUE, any taxon missing from pbdb is assumed to be recent</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame of max_ma and min_ma for the specimens
</p>

<hr>
<h2 id='get_opentree_chronograms'>Get all chronograms from Open Tree of Life database</h2><span id='topic+get_opentree_chronograms'></span><span id='topic+get_otol_chronograms'></span>

<h3>Description</h3>

<p>Get all chronograms from Open Tree of Life database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_opentree_chronograms(max_tree_count = "all")

get_otol_chronograms(max_tree_count = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_opentree_chronograms_+3A_max_tree_count">max_tree_count</code></td>
<td>
<p>Default to &quot;all&quot;, it gets all available chronograms. For testing purposes, a numeric value indicating the max number of trees to be cached.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 4 elements:
</p>

<dl>
<dt>authors</dt><dd><p>A list of lists of author names of the original studies that
published chronograms currently stored in the Open Tree of Life database.</p>
</dd>
<dt>curators</dt><dd><p>A list of lists of curator names that uploaded chronograms
to the Open Tree of Life database.</p>
</dd>
<dt>studies</dt><dd><p>A list of study identifiers from original studies that
published chronograms currently stored in the Open Tree of Life database.</p>
</dd>
<dt>trees</dt><dd><p>A <code>multiPhylo</code> object storing the chronograms from Open Tree of
Life database.</p>
</dd>
<dt>update</dt><dd><p>A character vector indicating the time when the database object
was last updated.</p>
</dd>
<dt>version</dt><dd><p>A character vector indicating when the chronogram database <code>opentree_chronograms</code>
object was last updated. Format is year.month.day</p>
</dd>
</dl>


<hr>
<h2 id='get_ott_children'>Use this instead of <code><a href="rotl.html#topic+tol_subtree">rotl::tol_subtree()</a></code> when taxa are not in synthesis tree and
you still need to get all species or an induced OpenTree subtree</h2><span id='topic+get_ott_children'></span>

<h3>Description</h3>

<p>Use this instead of <code><a href="rotl.html#topic+tol_subtree">rotl::tol_subtree()</a></code> when taxa are not in synthesis tree and
you still need to get all species or an induced OpenTree subtree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ott_children(input = NULL, ott_ids = NULL, ott_rank = "species", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ott_children_+3A_input">input</code></td>
<td>
<p>Optional. A character vector of names.</p>
</td></tr>
<tr><td><code id="get_ott_children_+3A_ott_ids">ott_ids</code></td>
<td>
<p>If not NULL, it takes this argument and ignores input. A
numeric vector of ott ids obtained with <code><a href="rotl.html#topic+taxonomy_taxon_info">rotl::taxonomy_taxon_info()</a></code> or
<code><a href="rotl.html#topic+tnrs_match_names">rotl::tnrs_match_names()</a></code> or <code><a href="#topic+tnrs_match">tnrs_match()</a></code>.</p>
</td></tr>
<tr><td><code id="get_ott_children_+3A_ott_rank">ott_rank</code></td>
<td>
<p>A character vector with the ranks you wanna get lineage children from.</p>
</td></tr>
<tr><td><code id="get_ott_children_+3A_...">...</code></td>
<td>
<p>Other arguments to pass to <code><a href="#topic+get_valid_children">get_valid_children()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># An example with the dog genus:

# It is currently not possible to get an OpenTree subtree of a taxon that is
#  missing from the OpenTree synthetic tree.
# The dog genus is not monophyletic in the OpenTree synthetic tree, so in
#  practice, it has no node to extract a subtree from.
# Get the Open Tree Taxonomy identifier (OTT id) for "Canis":
tnrs &lt;- tnrs_match("Canis")

## Not run: 
rotl::tol_subtree(tnrs$ott_id[1])
#&gt; Error: HTTP failure: 400
#&gt; [/v3/tree_of_life/subtree] Error: node_id was not found (broken taxon).

## End(Not run) # end dontrun


ids &lt;- tnrs$ott_id[1]
names(ids) &lt;- tnrs$unique_name
children &lt;- get_ott_children(ott_ids = ids) # or
# children &lt;- get_ott_children(input = "Canis")
str(children)
ids &lt;- children$Canis$ott_id
names(ids) &lt;- rownames(children$Canis)
tree_children &lt;- rotl::tol_induced_subtree(ott_ids = ids)
plot(tree_children, cex = 0.3)

# An example with flowering plants:

# orders &lt;- get_ott_children(input = "magnoliophyta", ott_rank = "order")
# Get the number of orders of flowering plants that we have
# sum(orders$Magnoliophyta$rank == "order")

 # end donttest
</code></pre>

<hr>
<h2 id='get_ott_clade'>Get the Open Tree of Life Taxonomic identifiers (OTT ids) and name of one or
several given taxonomic ranks from one or more input taxa.</h2><span id='topic+get_ott_clade'></span>

<h3>Description</h3>

<p>Get the Open Tree of Life Taxonomic identifiers (OTT ids) and name of one or
several given taxonomic ranks from one or more input taxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ott_clade(input = NULL, ott_ids = NULL, ott_rank = "family")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ott_clade_+3A_input">input</code></td>
<td>
<p>Optional. A character vector of names.</p>
</td></tr>
<tr><td><code id="get_ott_clade_+3A_ott_ids">ott_ids</code></td>
<td>
<p>If not NULL, it takes this argument and ignores input. A
numeric vector of ott ids obtained with <code><a href="rotl.html#topic+taxonomy_taxon_info">rotl::taxonomy_taxon_info()</a></code> or
<code><a href="rotl.html#topic+tnrs_match_names">rotl::tnrs_match_names()</a></code> or <code><a href="#topic+tnrs_match">tnrs_match()</a></code>.</p>
</td></tr>
<tr><td><code id="get_ott_clade_+3A_ott_rank">ott_rank</code></td>
<td>
<p>A character vector with the ranks you wanna get lineage children from.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of named numeric vectors with OTT ids from input and all requested ranks.
</p>

<hr>
<h2 id='get_ott_lineage'>Get the Open Tree of Life Taxonomic identifier (OTT id) and name of all lineages
from one or more input taxa.</h2><span id='topic+get_ott_lineage'></span>

<h3>Description</h3>

<p>Get the Open Tree of Life Taxonomic identifier (OTT id) and name of all lineages
from one or more input taxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ott_lineage(input = NULL, ott_ids = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ott_lineage_+3A_input">input</code></td>
<td>
<p>Optional. A character vector of names.</p>
</td></tr>
<tr><td><code id="get_ott_lineage_+3A_ott_ids">ott_ids</code></td>
<td>
<p>If not NULL, it takes this argument and ignores input. A
numeric vector of ott ids obtained with <code><a href="rotl.html#topic+taxonomy_taxon_info">rotl::taxonomy_taxon_info()</a></code> or
<code><a href="rotl.html#topic+tnrs_match_names">rotl::tnrs_match_names()</a></code> or <code><a href="#topic+tnrs_match">tnrs_match()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of named numeric vectors of ott ids from input and all the clades it belongs to.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

taxa &lt;- c("Homo", "Bacillus anthracis", "Apis", "Salvia")
# lin &lt;- get_ott_lineage(taxa)

# Look up an unknown OTT id:
get_ott_lineage(ott_id = 454749)

 # end donttest
</code></pre>

<hr>
<h2 id='get_valid_children'>Extract valid children from given taxonomic name(s) or Open Tree of Life
Taxonomic identifiers (OTT ids) from a taxonomic source.</h2><span id='topic+get_valid_children'></span>

<h3>Description</h3>

<p>Extract valid children from given taxonomic name(s) or Open Tree of Life
Taxonomic identifiers (OTT ids) from a taxonomic source.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_valid_children(input = NULL, ott_ids = NULL, taxonomic_source = "ncbi")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_valid_children_+3A_input">input</code></td>
<td>
<p>Optional. A character vector of names.</p>
</td></tr>
<tr><td><code id="get_valid_children_+3A_ott_ids">ott_ids</code></td>
<td>
<p>If not NULL, it takes this argument and ignores input. A
numeric vector of ott ids obtained with <code><a href="rotl.html#topic+taxonomy_taxon_info">rotl::taxonomy_taxon_info()</a></code> or
<code><a href="rotl.html#topic+tnrs_match_names">rotl::tnrs_match_names()</a></code> or <code><a href="#topic+tnrs_match">tnrs_match()</a></code>.</p>
</td></tr>
<tr><td><code id="get_valid_children_+3A_taxonomic_source">taxonomic_source</code></td>
<td>
<p>A character vector with the desired taxonomic sources.
Options are &quot;ncbi&quot;, &quot;gbif&quot; or &quot;irmng&quot;. Any other value will retrieve data
from all taxonomic sources. The function defaults to &quot;ncbi&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>GBIF and other taxonomies contain deprecated taxa that are not marked as such
in the Open Tree of Life Taxonomy.
We are relying mainly in the NCBI taxonomy for now.
</p>


<h3>Value</h3>

<p>A named list containing valid taxonomic children of given taxonomic name(s).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># genus Dictyophyllidites with ott id = 6003921 has only extinct children
# in cases like this the same name will be returned

tti &lt;- rotl::taxonomy_taxon_info(6003921, include_children = TRUE)
gvc &lt;- get_valid_children(ott_ids = 6003921)

# More examples:

get_valid_children(ott_ids = 769681) # Psilotopsida
get_valid_children(ott_ids = 56601) # Marchantiophyta
</code></pre>

<hr>
<h2 id='is_good_chronogram'>Check if a tree is a valid chronogram.</h2><span id='topic+is_good_chronogram'></span>

<h3>Description</h3>

<p>Check if a tree is a valid chronogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_good_chronogram(phy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_good_chronogram_+3A_phy">phy</code></td>
<td>
<p>A <code>phylo</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if it is a valid tree.
</p>

<hr>
<h2 id='is_phylo'>Checks if <code>phy</code> is a <code>phylo</code> object and/or a chronogram.</h2><span id='topic+is_phylo'></span>

<h3>Description</h3>

<p>Checks if <code>phy</code> is a <code>phylo</code> object and/or a chronogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_phylo(phy = NULL, brlen = FALSE, dated = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_phylo_+3A_phy">phy</code></td>
<td>
<p>A <code>phylo</code> object.</p>
</td></tr>
<tr><td><code id="is_phylo_+3A_brlen">brlen</code></td>
<td>
<p>Boolean. If <code>TRUE</code> it checks if <code>phylo</code> object has branch lengths.</p>
</td></tr>
<tr><td><code id="is_phylo_+3A_dated">dated</code></td>
<td>
<p>Boolean. If <code>TRUE</code> it checks if <code>phylo</code> object is ultrametric.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>

<hr>
<h2 id='make_all_associations'>Find all authors and where they have deposited their trees</h2><span id='topic+make_all_associations'></span>

<h3>Description</h3>

<p>Find all authors and where they have deposited their trees
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_all_associations(outputfile = "depositorcache.RData")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_all_associations_+3A_outputfile">outputfile</code></td>
<td>
<p>Path including file name. NULL to prevent saving.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> of &quot;person&quot; and &quot;urls&quot;.
</p>

<hr>
<h2 id='make_contributor_cache'>Create a cache  from Open Tree of Life</h2><span id='topic+make_contributor_cache'></span>

<h3>Description</h3>

<p>Create a cache  from Open Tree of Life
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_contributor_cache(outputfile = "contributorcache.RData")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_contributor_cache_+3A_outputfile">outputfile</code></td>
<td>
<p>Path including file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing author and curator results
</p>

<hr>
<h2 id='make_otol_associations'>Associate Open Tree of Life authors with studies</h2><span id='topic+make_otol_associations'></span>

<h3>Description</h3>

<p>Associate Open Tree of Life authors with studies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_otol_associations()
</code></pre>


<h3>Value</h3>

<p><code>data.frame</code> with author last name, author first and other names, and comma delimited URLs for Open Tree of Life studies
</p>

<hr>
<h2 id='make_overlap_table'>Create an overlap table</h2><span id='topic+make_overlap_table'></span>

<h3>Description</h3>

<p>Create an overlap table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_overlap_table(results_table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_overlap_table_+3A_results_table">results_table</code></td>
<td>
<p>An &quot;author.results&quot; or &quot;curator.results&quot; <code>data.frame</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with information on curators and what clades they've worked on
</p>

<hr>
<h2 id='make_treebase_associations'>Associate TreeBase authors with studies</h2><span id='topic+make_treebase_associations'></span>

<h3>Description</h3>

<p>Associate TreeBase authors with studies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_treebase_associations()
</code></pre>


<h3>Value</h3>

<p><code>data.frame</code> with author last name, author first and other names, and comma delimited URLs for TreeBase studies
</p>

<hr>
<h2 id='make_treebase_cache'>Create a cache from TreeBase</h2><span id='topic+make_treebase_cache'></span>

<h3>Description</h3>

<p>Create a cache from TreeBase
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_treebase_cache(outputfile = "treebasecache.RData")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_treebase_cache_+3A_outputfile">outputfile</code></td>
<td>
<p>Path including file name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing author and curator results
</p>

<hr>
<h2 id='map_nodes_ott'>Add Open Tree of Life Taxonomy to tree nodes.</h2><span id='topic+map_nodes_ott'></span>

<h3>Description</h3>

<p>Add Open Tree of Life Taxonomy to tree nodes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_nodes_ott(tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map_nodes_ott_+3A_tree">tree</code></td>
<td>
<p>A tree either as a newick character string or as a <code>phylo</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>phylo</code> object with &quot;nodelabels&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Load the Open Tree chronograms database cached in datelife:
utils::data(opentree_chronograms)

# Get the small chronograms (i.e., chronograms with less that ten tips) to generate a pretty plot:
small &lt;- opentree_chronograms$trees[unlist(sapply(opentree_chronograms$trees, ape::Ntip)) &lt; 10]

# Now, map the Open Tree taxonomy to the nodes of the first tree
phy &lt;- map_nodes_ott(tree = small[[1]])
# and plot it:
# plot_phylo_all(phy)
library(ape)
plot(phy)
nodelabels(phy$node.label)


## End(Not run) # end dontrun
</code></pre>

<hr>
<h2 id='opentree_chronograms'>Open Tree of Life Chronogram database in R</h2><span id='topic+opentree_chronograms'></span>

<h3>Description</h3>

<p>Now storing &gt;200 chronograms from Open Tree of Life
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opentree_chronograms
</code></pre>


<h3>Format</h3>

<p>A list of four elements, containing data from OpenTree of Life chronograms
</p>

<dl>
<dt>authors</dt><dd><p>A list of lists of author names of the original studies that
published chronograms in the Open Tree of Life database.</p>
</dd>
<dt>curators</dt><dd><p>A list of lists of curator names that uploaded chronograms
to the Open Tree of Life database.</p>
</dd>
<dt>studies</dt><dd><p>A list of study identifiers.</p>
</dd>
<dt>trees</dt><dd><p>A <code>multiPhylo</code> object storing the chronograms from Open Tree of
Life database.</p>
</dd>
<dt>update</dt><dd><p>A character vector indicating the time when the database object
was last updated.</p>
</dd>
<dt>version</dt><dd><p>A character vector indicating when the chronogram database <code>opentree_chronograms</code>
object was last updated. Format is year.month.day</p>
</dd>
</dl>



<h3>Details</h3>

<p>Generated with
<code>devtools::install_github("ropensci/rotl", ref = devtools::github_pull("137"))</code>
<code>remotes::install_github("ROpenSci/bibtex")</code>
opentree_chronograms &lt;- get_opentree_chronograms()
opentree_chronograms$update_time &lt;- Sys.time()
opentree_chronograms$version &lt;- format(Sys.time(), &quot;%Y.%m.%d&quot;)
usethis::use_data(opentree_chronograms, overwrite = T, compress=&quot;xz&quot;)
and updated with update_datelife_cache()
</p>


<h3>Source</h3>

<p><a href="http://opentreeoflife.org">http://opentreeoflife.org</a>
</p>

<hr>
<h2 id='phylo_has_brlen'>Check if a tree has branch lengths</h2><span id='topic+phylo_has_brlen'></span>

<h3>Description</h3>

<p>Check if a tree has branch lengths
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phylo_has_brlen(phy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phylo_has_brlen_+3A_phy">phy</code></td>
<td>
<p>A <code>phylo</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A TRUE or FALSE
</p>

<hr>
<h2 id='phylo_tiplabel_space_to_underscore'>Convert spaces to underscores in trees.</h2><span id='topic+phylo_tiplabel_space_to_underscore'></span>

<h3>Description</h3>

<p>Convert spaces to underscores in trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phylo_tiplabel_space_to_underscore(phy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phylo_tiplabel_space_to_underscore_+3A_phy">phy</code></td>
<td>
<p>A <code>phylo</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>phylo</code> object.
</p>

<hr>
<h2 id='phylo_tiplabel_underscore_to_space'>Convert underscores to spaces in trees.</h2><span id='topic+phylo_tiplabel_underscore_to_space'></span>

<h3>Description</h3>

<p>Convert underscores to spaces in trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phylo_tiplabel_underscore_to_space(phy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phylo_tiplabel_underscore_to_space_+3A_phy">phy</code></td>
<td>
<p>A <code>phylo</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>phylo</code> object.
</p>

<hr>
<h2 id='problematic_chronograms'>Problematic chronograms from Open Tree of Life.</h2><span id='topic+problematic_chronograms'></span>

<h3>Description</h3>

<p>Problematic chronograms from Open Tree of Life.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>problematic_chronograms
</code></pre>


<h3>Format</h3>

<p>A list of trees with unmapped taxa
</p>


<h3>Details</h3>

<p>Before we developed tools to clean and map tip labels for our cached trees
we found some trees that were stored with unmapped tip labels
we extracted them and saved them to be used for testing functions.
Generated with
problematic_chronograms &lt;- opentree_chronograms$trees[sapply(sapply(opentree_chronograms$trees, &quot;[&quot;, &quot;tip.label&quot;), function(x) any(grepl(&quot;not.mapped&quot;, x)))]
usethis::use_data(problematic_chronograms)
opentree_chronograms object from commit https://github.com/phylotastic/datelife/tree/be894448f6fc437241cd0916fab45e84ac3e09c6
</p>
<p>[&quot;, &quot;tip.label&quot;), function(x) any(grepl(&quot;not.mapped&quot;, x)))]: R:%22,%20%22tip.label%22),%20function(x)%20any(grepl(%22not.mapped%22,%20x)))
</p>


<h3>Source</h3>

<p><a href="http://opentreeoflife.org">http://opentreeoflife.org</a>
</p>

<hr>
<h2 id='recover_mrcaott'>Get an mrcaott tag from an OpenTree induced synthetic tree and get its name and ott id</h2><span id='topic+recover_mrcaott'></span>

<h3>Description</h3>

<p>Get an mrcaott tag from an OpenTree induced synthetic tree and get its name and ott id
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recover_mrcaott(tag)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recover_mrcaott_+3A_tag">tag</code></td>
<td>
<p>A character vector with the mrca tag</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector with ott id from original taxon named with the corresponding ott name
</p>

<hr>
<h2 id='summarize_fossil_range'>Summarize taxon age from PBDB to just a single min and max age</h2><span id='topic+summarize_fossil_range'></span>

<h3>Description</h3>

<p>This uses the Paleobiology Database's API to gather information on the ages for all specimens of a taxon. It will also look for all descendants of the taxon. It fixes name misspellings if possible. It is basically a wrapper for get_fossil_range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize_fossil_range(taxon, recent = FALSE, assume_recent_if_missing = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarize_fossil_range_+3A_taxon">taxon</code></td>
<td>
<p>The scientific name of the taxon you want the range of occurrences of</p>
</td></tr>
<tr><td><code id="summarize_fossil_range_+3A_recent">recent</code></td>
<td>
<p>If TRUE, forces the minimum age to be zero</p>
</td></tr>
<tr><td><code id="summarize_fossil_range_+3A_assume_recent_if_missing">assume_recent_if_missing</code></td>
<td>
<p>If TRUE, any taxon missing from pbdb is assumed to be recent</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a single row data.frame of max_ma and min_ma for the specimens, with rowname equal to taxon input
</p>

<hr>
<h2 id='tnrs_match'>Taxon name resolution service (tnrs) applied to a vector of names by batches</h2><span id='topic+tnrs_match'></span><span id='topic+tnrs_match.default'></span><span id='topic+tnrs_match.phylo'></span>

<h3>Description</h3>

<p>Taxon name resolution service (tnrs) applied to a vector of names by batches
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tnrs_match(input, reference_taxonomy, tip, ...)

## Default S3 method:
tnrs_match(input, reference_taxonomy = "otl", ...)

## S3 method for class 'phylo'
tnrs_match(input, reference_taxonomy = "otl", tip = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tnrs_match_+3A_input">input</code></td>
<td>
<p>A character vector of taxon names, or a phylo object with tip names, to be matched to taxonomy.</p>
</td></tr>
<tr><td><code id="tnrs_match_+3A_reference_taxonomy">reference_taxonomy</code></td>
<td>
<p>A character vector specifying the reference taxonomy to use for tnrs.</p>
</td></tr>
<tr><td><code id="tnrs_match_+3A_tip">tip</code></td>
<td>
<p>A vector of mode numeric or character specifying the tips to match. If left empty all tips will be matched.</p>
</td></tr>
<tr><td><code id="tnrs_match_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="rotl.html#topic+tnrs_match_names">rotl::tnrs_match_names</a></code>
</p>

<dl>
<dt><code>context_name</code></dt><dd><p>name of the taxonomic context to be searched (length-one
character vector or <code>NULL</code>). Must match (case sensitive) one of the
values returned by <code><a href="rotl.html#topic+tnrs_contexts">tnrs_contexts</a></code>. Default to &quot;All life&quot;.</p>
</dd>
<dt><code>do_approximate_matching</code></dt><dd><p>A logical indicating whether or not to
perform approximate string (a.k.a. &ldquo;fuzzy&rdquo;) matching. Using
<code>FALSE</code> will greatly improve speed. Default, however, is <code>TRUE</code>.</p>
</dd>
<dt><code>ids</code></dt><dd><p>A vector of ids to use for identifying names. These will be
assigned to each name in the names array. If ids is provided, then ids and
names must be identical in length.</p>
</dd>
<dt><code>include_suppressed</code></dt><dd><p>Ordinarily, some quasi-taxa, such as incertae
sedis buckets and other non-OTUs, are suppressed from TNRS results. If
this parameter is true, these quasi-taxa are allowed as possible TNRS
results.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>There is no limit to the number of names that can be queried and matched.
</p>
<p>The output will preserve all elements from original input phylo object and will add
</p>

<dl>
<dt>phy$mapped</dt><dd><p>A character vector indicating the state of mapping of phy$tip.labels:</p>
</dd>
</dl>

<dl>
<dt>original</dt><dd><p>Tnrs matching was not attempted. Original labeling is preserved.</p>
</dd>
<dt>ott</dt><dd><p>Matching was manually made by a curator in Open Tree of Life.</p>
</dd>
<dt>tnrs</dt><dd><p>Tnrs matching was attempted and successful with no approximate matching. Original label is replaced by the matched name.</p>
</dd>
<dt>approximated</dt><dd><p>Tnrs matching was attempted and successful but with approximate matching. Original labeling is preserved.</p>
</dd>
<dt>unmatched</dt><dd><p>Tnrs matching was attempted and unsuccessful. Original labeling is preserved.</p>
</dd>
</dl>

<dl>
<dt>phy$original.tip.label</dt><dd><p>A character vector preserving all original labels.</p>
</dd>
<dt>phy$ott_ids</dt><dd><p>A numeric vector with ott id numbers of matched tips. Unmatched and original tips will be NaN.</p>
</dd>
</dl>

<p>if tips are duplicated, tnrs will only be run once (avoiding increases in function running time) but the result will be applied to all duplicated tip labels
</p>


<h3>Value</h3>

<p>An object of class  data frame or phylo, with the added class match_names.
</p>
<p><code>NULL</code>
</p>
<p><code>NULL</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tnrs_match(input = c("Mus"))
tnrs_match(input = c("Mus", "Mus musculus"))
tnrs_match(input = c("Mus", "Echinus", "Hommo", "Mus"))
</code></pre>

<hr>
<h2 id='tree_from_taxonomy'>Gets a taxonomic tree from a vector of taxa</h2><span id='topic+tree_from_taxonomy'></span>

<h3>Description</h3>

<p>This uses the taxize package's wrapper of the Global Names Resolver to get taxonomic paths for the vector of taxa you pass in. Sources is a vector of source labels in order (though it works best if everything uses the same taxonomy, so we recommend doing just one source). You can see options by doing taxize::gnr_datasources(). Our default is Catalogue of Life. The output is a phylo object (typically with many singleton nodes if collapse_singles is FALSE: nodes with only one descendant (like &quot;Homo&quot; having &quot;Homo sapiens&quot; as its only descendant) but these singletons typically have node.labels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tree_from_taxonomy(
  taxa,
  sources = "Catalogue of Life",
  collapse_singles = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tree_from_taxonomy_+3A_taxa">taxa</code></td>
<td>
<p>Vector of taxon names</p>
</td></tr>
<tr><td><code id="tree_from_taxonomy_+3A_sources">sources</code></td>
<td>
<p>Vector of names of preferred sources; see taxize::gnr_datasources(). Currently supports 100 taxonomic resources, see details.</p>
</td></tr>
<tr><td><code id="tree_from_taxonomy_+3A_collapse_singles">collapse_singles</code></td>
<td>
<p>If true, collapses singleton nodes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing a phylo object with resolved names and a vector with unresolved names
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

taxa &lt;- c(
  "Homo sapiens", "Ursus arctos", "Pan paniscus", "Tyrannosaurus rex",
  "Ginkgo biloba", "Vulcan", "Klingon"
)
results &lt;- tree_from_taxonomy(taxa)
print(results$unresolved) # The taxa that do not match
ape::plot.phylo(results$phy) # may generate warnings due to problems with singletons
ape::plot.phylo(ape::collapse.singles(results$phy), show.node.label = TRUE)
# got rid of singles, but this also removes a lot of the node.labels
 # end donttest
</code></pre>

<hr>
<h2 id='update_all_cached'>Update all data files as data objects for the package</h2><span id='topic+update_all_cached'></span>

<h3>Description</h3>

<p>This includes opentree chronograms, contributors, treebase and curators
For speed, datelife caches chronograms and other information. Running this (within the checked out version of datelife) will refresh these. Then git commit and git push them back
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_all_cached()
</code></pre>


<h3>Value</h3>

<p>None
</p>

<hr>
<h2 id='update_datelife_cache'>Create an updated OpenTree chronograms database object</h2><span id='topic+update_datelife_cache'></span>

<h3>Description</h3>

<p>The function calls <code><a href="#topic+get_opentree_chronograms">get_opentree_chronograms()</a></code> to update the OpenTree
chronograms database cached in datelife. It has the option to write the updated
object as an .Rdata file, that will be independent of the <code>opentree_chronograms</code>
data object that you can load with <code>data("opentree_chronograms", package = "datelife")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_datelife_cache(
  write = TRUE,
  updated_name = "opentree_chronograms_updated",
  file_path = file.path(tempdir()),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_datelife_cache_+3A_write">write</code></td>
<td>
<p>Defaults to <code>TRUE</code>, it saves an .Rdata file named indicated by argument <code>name</code>,
containing available chronograms from Open Tree of Life. Saves to path indicated by argument <code>path</code>.</p>
</td></tr>
<tr><td><code id="update_datelife_cache_+3A_updated_name">updated_name</code></td>
<td>
<p>Used if <code>write = TRUE</code>. Defaults to <code>"opentree_chronograms_updated"</code>. A character
vector of length one indicating the name to assign to both the updated OpenTree chronogram
database object and the &quot;.Rdata&quot; file. For example, if <code>name = "my_database"</code>, the
function will assign the updated chronogram database to an object named <code>my_database</code>
and will write it to a file named &quot;my_database.Rdata&quot; in the path indicated
by argument <code>file_path</code>.</p>
</td></tr>
<tr><td><code id="update_datelife_cache_+3A_file_path">file_path</code></td>
<td>
<p>Used if <code>write = TRUE</code>. A character vector of length 1 indicating
the path to write the updated database &quot;.Rdata&quot; file to, excluding file name.
Defaults to temporary directory obtained with <code><a href="base.html#topic+tempfile">base::tempdir()</a></code> and formatted with
<code><a href="base.html#topic+file.path">base::file.path()</a></code>.</p>
</td></tr>
<tr><td><code id="update_datelife_cache_+3A_...">...</code></td>
<td>

<p>Arguments passed on to <code><a href="#topic+get_opentree_chronograms">get_opentree_chronograms</a></code>
</p>

<dl>
<dt><code>max_tree_count</code></dt><dd><p>Default to &quot;all&quot;, it gets all available chronograms. For testing purposes, a numeric value indicating the max number of trees to be cached.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 4 elements:
</p>

<dl>
<dt>authors</dt><dd><p>A list of lists of author names of the original studies that
published chronograms currently stored in the Open Tree of Life database.</p>
</dd>
<dt>curators</dt><dd><p>A list of lists of curator names that uploaded chronograms
to the Open Tree of Life database.</p>
</dd>
<dt>studies</dt><dd><p>A list of study identifiers from original studies that
published chronograms currently stored in the Open Tree of Life database.</p>
</dd>
<dt>trees</dt><dd><p>A <code>multiPhylo</code> object storing the chronograms from Open Tree of
Life database.</p>
</dd>
<dt>update</dt><dd><p>A character vector indicating the time when the database object
was last updated.</p>
</dd>
<dt>version</dt><dd><p>A character vector indicating when the chronogram database <code>opentree_chronograms</code>
object was last updated. Format is year.month.day</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
