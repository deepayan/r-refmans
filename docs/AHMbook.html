<!DOCTYPE html><html><head><title>Help for package AHMbook</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AHMbook}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AHMbook-package'>
<p>Functions and data for the Book &ldquo;Applied Hierarchical Modeling in Ecology&rdquo; Volumes 1 and 2</p></a></li>
<li><a href='#BerneseOberland'>
<p>Landscape data for the Bernese Oberland around Interlaken, in the Alps of central Switzerland</p></a></li>
<li><a href='#bigCrossCorr'>
<p>Cross correlations for MCMC output</p></a></li>
<li><a href='#ch2marray'>
<p>Converts capture-histories to an m-array</p></a></li>
<li><a href='#Color Ramps'>
<p>Color Ramps</p></a></li>
<li><a href='#crestedTit'>
<p>Count data from the Swiss Breeding Bird Survey MHB for crested tits from 1999 to 2015</p></a></li>
<li><a href='#crossbillAHM'>
<p>Data from the Swiss Breeding Bird Survey MHB for European Crossbill from 2001 to 2012</p></a></li>
<li><a href='#cswa'>
<p>Point count and spot-mapping data for Chestnut-sided Warbler</p></a></li>
<li><a href='#data.fn'>
<p>Simulate count data under a binomial N-mixture model</p></a></li>
<li><a href='#dragonflies'>
<p>Fictional data for dragonflies</p></a></li>
<li><a href='#duskySalamanders'>
<p>Age-classified counts of dusky salamanders from two mid-Atlantic states in the USA</p></a></li>
<li><a href='#e2dist'>
<p>Calculates the pair-wise distances between two sets of points</p></a></li>
<li><a href='#EurasianLynx'>
<p>Data for Eurasian lynx from Switzerland and Italy (only Alps).</p></a></li>
<li><a href='#Finnmark'>
<p>Data from surveys of birds in Finnmark in NE Norway</p></a></li>
<li><a href='#fitstats'>
<p>Functions to return fit statistics</p></a></li>
<li><a href='#FrenchPeregrines'>
<p>Data for observations of peregrines from the French Jura mountains</p></a></li>
<li><a href='#getLVcorrMat'>
<p>Compute results of a Joint Species Distribution Model (JSDM)</p></a></li>
<li><a href='#graphSSM'>
<p>Plot the results for a Gaussian state-space model</p></a></li>
<li><a href='#greenWoodpecker'>
<p>Count data from the Swiss Breeding Bird Survey for Green Woodpeckers from 2004 to 2017</p></a></li>
<li><a href='#HubbardBrook'>
<p>Warbler point count data from the Hubbard Brook Experimental Forest</p></a></li>
<li><a href='#image_scale'>
<p>Helper function to draw scale for image</p></a></li>
<li><a href='#issj.sim'>
<p>Simulate open distance sampling data for the Island Scrub Jays</p></a></li>
<li><a href='#map.Nmix.resi'>
<p>Mapping of residuals</p></a></li>
<li><a href='#MesoCarnivores'>
<p>Camera trap data for Bobcat, Coyote and Red Fox</p></a></li>
<li><a href='#MHB2014'>
<p>Data from the Swiss Breeding Bird Survey MHB 2014</p></a></li>
<li><a href='#modSelFP'>
<p>Model selection results from a list of 'unmarkedFitOccuFP' models</p></a></li>
<li><a href='#piFuns'>
<p>Compute multinomial cell probabilities</p></a></li>
<li><a href='#playRN'>
<p>Function to play Royle-Nichols (RN) model</p></a></li>
<li><a href='#plot_Nmix_resi'>
<p>Produce some residual plots</p></a></li>
<li><a href='#ppc.plot'>
<p>Plot results from posterior predictive check</p></a></li>
<li><a href='#sim.fn'>
<p>Simulate a Poisson point process</p></a></li>
<li><a href='#sim.ldata'>
<p>Simulation of distance sampling data.</p></a></li>
<li><a href='#sim.pdata'>
<p>Simulate non-hierarchical point transect (= point count) data</p></a></li>
<li><a href='#sim.spatialDS'>
<p>Simulates data for a basic spatial distance sampling model</p></a></li>
<li><a href='#sim.spatialHDS'>
<p>Simulates data for a hierarchical spatial distance sampling model</p></a></li>
<li><a href='#sim3Occ'>
<p>Simulate detection/nondetection data for static 3-level occupancy models</p></a></li>
<li><a href='#simCJS'>
<p>Simulate individual capture-histories under a Cormack-Jolly-Seber (CJS) survival model</p></a></li>
<li><a href='#simComm'>
<p>Simulate community occupancy or community abundance data</p></a></li>
<li><a href='#simDataDK'>
<p>Simulate data for an integrated species distribution model (SDM) of Dorazio-Koshkina</p></a></li>
<li><a href='#simDCM'>
<p>Simulate detection/nondetection data under a general dynamic community (site-occupancy) model</p></a></li>
<li><a href='#simDemoDynocc'>
<p>Simulate data under a demographic dynamic occupancy model</p></a></li>
<li><a href='#simDM'>
<p>Simulate count data under the dynamic N-mixture model of Dail-Madsen</p></a></li>
<li><a href='#simDSM'>
<p>Simulate line transect data for density surface modeling</p></a></li>
<li><a href='#simDynocc'>
<p>Simulate detection/nondetection data under a wide variety of non-spatial dynamic occupancy models</p></a></li>
<li><a href='#simDynoccSpatial'>
<p>Simulate data under a dynamic occupancy model with spatial autocorrelation</p></a></li>
<li><a href='#simDynoccSpatialData'>
<p>Simulated data from <code>simDynoccSpatial</code> for AHM2 section 9.6.1.2 (page 564)</p></a></li>
<li><a href='#simExpCorrRF'>
<p>Create a Gaussian random field with negative exponential correlation</p></a></li>
<li><a href='#simFrogDisease'>
<p>Simulate detection data for diseased frogs</p></a></li>
<li><a href='#simHDS'>
<p>Simulate data under hierarchical distance sampling protocol (line or point)</p></a></li>
<li><a href='#simHDSg'>
<p>Simulate data under HDS protocol with groups</p></a></li>
<li><a href='#simHDSopen'>
<p>Simulate open hierarchical distance sampling data</p></a></li>
<li><a href='#simHDSpoint'>
<p>Simulate data under hierarchical distance sampling point transect protocol</p></a></li>
<li><a href='#simHDStr'>
<p>Simulate HDS time-removal or double-observer data</p></a></li>
<li><a href='#simIDS'>
<p>Simulate data for an integrated distance sampling, point count and occupancy study</p></a></li>
<li><a href='#simMultMix'>
<p>Simulate the multinomial-mixture model</p></a></li>
<li><a href='#simNmix'>
<p>Simulate data for binomial and multinomial mixture models</p></a></li>
<li><a href='#simNmixSpatial'>
<p>Simulate replicated counts under a spatial, static binomial N-mixture model</p></a></li>
<li><a href='#simNpC'>
<p>Generate counts from a single population observed over T years under a binomial observation process</p></a></li>
<li><a href='#simOcc'>
<p>Simulate data for static occupancy models under wide range of conditions</p></a></li>
<li><a href='#simOccSpatial'>
<p>Simulate replicated detection/nondetection data under a spatial, static occupancy model</p></a></li>
<li><a href='#simOccttd'>
<p>Simulate time-to-detection occupancy data (single visits)</p></a></li>
<li><a href='#simPH'>
<p>Generate counts under a variant of a 'phenomenological model'</p></a></li>
<li><a href='#simpleNmix'>
<p>Simulate N-mixture data under a time-for-space substitution design</p></a></li>
<li><a href='#simPOP'>
<p>Simulate data for a demographic state-space model</p></a></li>
<li><a href='#simPPe'>
<p>Simulate a spatial point pattern in a heterogeneous landscape</p></a></li>
<li><a href='#simSpatialDSline'>
<p>Simulate data for a standardized line transect</p></a></li>
<li><a href='#simSpatialDSte'>
<p>Simulate data for replicate line transect surveys with temporary emigration</p></a></li>
<li><a href='#spline.prep'>
<p>Prepare input for BUGS model when fitting a spline for a covariate</p></a></li>
<li><a href='#spottedWoodpecker'>
<p>Data for observations of Middle Spotted Woodpecker in Switzerland</p></a></li>
<li><a href='#standardize'>
<p>Scaling and centering of vectors, matrices and arrays</p></a></li>
<li><a href='#SwissAtlasHa'>
<p>Data for 1ha quadrats from the Swiss Breeding Bird Atlas</p></a></li>
<li><a href='#SwissEagleOwls'>
<p>Territory-level, multi-state detection/nondetection data for Eagle Owls in Switzerland</p></a></li>
<li><a href='#SwissMarbledWhite'>
<p>Data for Swiss Marbled White butterflies</p></a></li>
<li><a href='#SwissSquirrels'>
<p>Data for Red Squirrels in Switzerland from the Swiss breeding bird survey MHB</p></a></li>
<li><a href='#SwissTits'>
<p>Data from the Swiss Breeding Bird Survey for 6 species of tits</p></a></li>
<li><a href='#treeSparrow'>
<p>American Tree Sparrow data from Alaska</p></a></li>
<li><a href='#ttdPeregrine'>
<p>Time-to-detection data for peregrines from the French Jura mountains</p></a></li>
<li><a href='#UKmarbledWhite'>
<p>Data for UK Marbled White butterflies</p></a></li>
<li><a href='#valid_data'>
<p>Validates simulated observational data against data-generating values.</p></a></li>
<li><a href='#wagtail'>
<p>Data for Dutch wagtails</p></a></li>
<li><a href='#waterVoles'>
<p>Data for the Mighty Water Voles of Scotland, UK.</p></a></li>
<li><a href='#wigglyLine'>
<p>Coordinates for a wiggly line transect</p></a></li>
<li><a href='#wigglyOcc'>
<p>Simulate static occupancy data</p></a></li>
<li><a href='#willowWarbler'>
<p>Constant effort site (CES) data for British Willow Warblers</p></a></li>
<li><a href='#zinit'>
<p>Starting values for survival analysis in JAGS/BUGS</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions and Data for the Book 'Applied Hierarchical Modeling
in Ecology' Vols 1 and 2</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-21</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, graphics, methods, stats, utils, plotrix, raster,
sp, fields, coda, unmarked (&ge; 0.12.2), mvtnorm, spdep</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to simulate data sets from hierarchical ecological models, including all the simulations described in the two volume publication 'Applied Hierarchical Modeling in Ecology: Analysis of distribution, abundance and species richness in R and BUGS' by Marc Kéry and Andy Royle: volume 1 (2016, ISBN: 978-0-12-801378-6) and volume 2 (2021, ISBN: 978-0-12-809585-0), <a href="https://www.mbr-pwrc.usgs.gov/pubanalysis/keryroylebook/">https://www.mbr-pwrc.usgs.gov/pubanalysis/keryroylebook/</a>. It also has all the utility functions and data sets needed to replicate the analyses shown in the books.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Copyright:</td>
<td>file COPYRIGHTS</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://sites.google.com/site/appliedhierarchicalmodeling/home">https://sites.google.com/site/appliedhierarchicalmodeling/home</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kenkellner/AHMbook/issues">https://github.com/kenkellner/AHMbook/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-21 15:38:38 UTC; ken</td>
</tr>
<tr>
<td>Author:</td>
<td>Marc Kéry [aut],
  Andy Royle [aut],
  Mike Meredith [aut],
  Ken Kellner [ctb, cre] (simIDS),
  Urs Breitenmoser [dtc] (EurasianLynx),
  Richard Chandler [ctb],
  Bob Dorazio [ctb],
  Evan Grant [dtc] (duskySalamanders),
  John-Andren Henden [dtc] (Finnmark),
  Roland Kays [dtc] (MesoCarnivores),
  David King [dtc] (cswa),
  Xavier Lambin [dtc] (waterVoles),
  Jeremy Mizel [ctb, dtc] (treeSparrow),
  Anja Molinari-Jobin [dtc] (EurasianLynx),
  René-Jean Monneret [dtc] (FrenchPeregrines),
  Arielle Parsons [dtc] (MesoCarnivores),
  René Ruffinoni [dtc] (FrenchPeregrines),
  Michael Schaub [ctb],
  Rahel Solmann [ctb],
  Nicolas Strebel [dtc],
  Chris Sutherland [ctb, dtc] (waterVoles),
  Mathias Tobler [ctb],
  Gesa von Hirschheydt [ctb] (simOccCat),
  Fridolin Zimmermann [dtc] (EurasianLynx),
  Aargau Biodiversity Monitoring Program (LANAG) [dtc],
  British Ornithological Trust [dtc] (willowWarbler, UKmarbledWhite,
    &lt;https://www.bto.org/&gt;),
  Butterfly Conservation [dtc, cph] (UKmarbledWhite,
    &lt;https://butterfly-conservation.org&gt;),
  Centre for Ecology &amp; Hydrology [dtc, cph] (UKmarbledWhite,
    &lt;https://www.ceh.ac.uk&gt;),
  Dutch Centre for Field Ornithology (Sovon) [dtc] (wagtail,
    &lt;https://www.sovon.nl&gt;),
  eMammal [dtc] (MesoCarnivores, &lt;https://emammal.si.edu/&gt;),
  Groupe Pèlerin Jura [dtc] (FrenchPeregrines),
  Hubbard Brook Ecosystem Study [dtc] (HubbardBrook,
    &lt;http://data.hubbardbrook.org/data/dataset.php?id=178&gt;),
  Joint Nature Conservation Committee (JNCC) [dtc, cph] (UKmarbledWhite,
    &lt;https://jncc.gov.uk/&gt;),
  North Carolina Museum of Natural Sciences [dtc] (mesoCarnivores),
  North Carolina State University [dtc] (mesoCarnivores),
  Progetto Lince Italia [dtc] (EurasianLynx,
    &lt;https://www.progettolinceitalia.it&gt;),
  Swiss Federal Statistical Office [dtc, cph] (BerneseOberland,
    &lt;http://www.bfs.admin.ch&gt;),
  Swiss Foundation KORA Carnivore Ecology and Wildlife Management (SCALP
    project) [dtc] (EurasianLynx, &lt;https://www.kora.ch&gt;),
  Swiss Ornithological Institute [dtc] (&lt;https://www.vogelwarte.ch&gt;),
  UK Butterfly Monitoring Scheme (UKBMS) [dtc, cph] (UKmarbledWhite,
    &lt;https://www.ceh.ac.uk/our-science/projects/uk-butterfly-monitoring-scheme&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ken Kellner &lt;contact@kenkellner.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-23 21:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='AHMbook-package'>
Functions and data for the Book &ldquo;Applied Hierarchical Modeling in Ecology&rdquo; Volumes 1 and 2
</h2><span id='topic+AHMbook-package'></span><span id='topic+AHMbook'></span>

<h3>Description</h3>

<p>Provides functions to simulate data sets from hierarchical ecological models, including all the simulations described by Marc Kéry and Andy Royle in the two-volume publication, <em>Applied Hierarchical Modeling in Ecology: analysis of distribution, abundance and species richness in R and BUGS</em>, Academic Press (Vol 1, 2016; Vol 2, 2021), plus new models developed after publication of the books.
</p>
<p>It also has all the utility functions and data sets needed to replicate the analyses shown in the books.
</p>


<h3>SIMULATION FUNCTIONS</h3>



<h4>Introduction</h4>

 
<dl>
<dt><code><a href="#topic+sim.fn">sim.fn</a></code></dt><dd><p> Simulate a homogeneous Poisson point process and illustrate the fundamental relationships between intensity, abundance and occurrence (AHM1 - section 1.1)</p>
</dd>
<dt><code><a href="#topic+data.fn">data.fn</a></code></dt><dd><p> Simulate count data that are replicated in space and in time according to the binomial N-mixture model of Royle (2004) (this is for much simpler cases than is possible with function <code>simNmix</code> in Chapter 6 below) (AHM1 - 4.3)</p>
</dd>
</dl>
  


<h4>Abundance from Counts: Binomial N-Mixture models</h4>

 
<dl>
<dt><code><a href="#topic+simNmix">simNmix</a></code></dt><dd><p> Simulate count data and individual detection histories for binomial and multinomial mixture models respectively under a wide range of conditions (AHM1 - 6.9.3)</p>
</dd>
<dt><code><a href="#topic+simpleNmix">simpleNmix</a></code></dt><dd><p> Simulate count data under a very simple version of the binomial mixture model, with time for space substitution (AHM1 - 6.12)</p>
</dd>
<dt><code><a href="#topic+playRN">playRN</a></code></dt><dd><p> Play Royle-Nichols (RN) model: generate count data under the binomial N-mixture model of Royle (2004),  then 'degrade' the data to detection/nondetection and fit the RN model using <span class="pkg">unmarked</span> and estimate site-specific abundance (AHM1 - 6.13.1)   </p>
</dd>
</dl>
  


<h4>Abundance from Hierarchical Distance Sampling</h4>

 
<dl>
<dt><code><a href="#topic+sim.ldata">sim.ldata</a></code></dt><dd><p> Simulate data under a non-hierarchical line transect distance sampling model (AHM1 - 8.2.3)</p>
</dd>
<dt><code><a href="#topic+sim.pdata">sim.pdata</a></code></dt><dd><p> Simulate data under a non-hierarchical point transect (= point count) distance sampling model (AHM1 - 8.2.5.1)</p>
</dd>
<dt><code><a href="#topic+simHDS">simHDS</a></code></dt><dd><p> Simulate data under a hierarchical distance sampling protocol (line or point) (AHM1 - 8.5.1)</p>
</dd>
<dt><code><a href="#topic+simHDSpoint">simHDSpoint</a></code></dt><dd><p> A simplified version of <code>simHDS</code> for point transects only.</p>
</dd>
<dt><code><a href="#topic+simHDSg">simHDSg</a></code></dt><dd><p> Simulate data under a hierarchical distance sampling (HDS) protocol with groups (AHM1 - 9.2.1)</p>
</dd>
<dt><code><a href="#topic+simHDStr">simHDStr</a></code></dt><dd><p> Simulate data under a time-removal/distance sampling design (AHM1 - 9.3.2)</p>
</dd>
<dt><code><a href="#topic+simHDSopen">simHDSopen</a></code></dt><dd><p> Simulate open hierarchical distance sampling data (AHM1 - 9.5.4)</p>
</dd>
<dt><code><a href="#topic+issj.sim">issj.sim</a></code></dt><dd><p> Simulate data under the open distance sampling protocol for the Island Scrub Jays (AHM1 - 9.7.1)</p>
</dd>
<dt><code><a href="#topic+sim.spatialDS">sim.spatialDS</a></code></dt><dd><p> Simulate data under a basic spatial distance sampling model  (AHM1 - 9.8.3)</p>
</dd>
<dt><code><a href="#topic+sim.spatialHDS">sim.spatialHDS</a></code></dt><dd><p> Simulate data under a spatial hierarchical distance sampling model  (AHM1 - 9.8.5)</p>
</dd>
<dt><code><a href="#topic+simIDS">simIDS</a></code></dt><dd><p> Simulate data for an integrated distance sampling, point count and occupancy study</p>
</dd>
</dl>
  


<h4>Static Occurrence using Site-Occupancy Models</h4>

 
<dl>
<dt><code><a href="#topic+simOcc">simOcc</a></code></dt><dd><p> Simulate detection/nondetection data under static occupancy models under a wide range of conditions (AHM1 - 10.5)</p>
</dd>
<dt><code><a href="#topic+simOccCat">simOccCat</a></code></dt><dd><p> As above, but allows simulation of categorical covariates</p>
</dd>
<dt><code><a href="#topic+sim3Occ">sim3Occ</a></code></dt><dd><p> Simulate detection/nondetection data under a static 3-level occupancy model (AHM1 - 10.10)</p>
</dd>
<dt><code><a href="#topic+simOccttd">simOccttd</a></code></dt><dd><p> Simulate 'timing data' under a static time-to-detection occupancy design (AHM1 - 10.12.1)</p>
</dd>
<dt><code><a href="#topic+wigglyOcc">wigglyOcc</a></code></dt><dd><p> Simulate detection/nondetection data under a static occupancy model with really wiggly covariate relationships in occupancy and detection probability (AHM1 - 10.14)</p>
</dd>
</dl>
 


<h4>Hierarchical Models for Communities</h4>

 
<dl>
<dt><code><a href="#topic+simComm">simComm</a></code></dt><dd><p> Simulate detection/nondetection or count data under a community occupancy or abundance model respectively (AHM1 - 11.2)</p>
</dd>
</dl>
 


<h4>Relative Abundance Models for Population Dynamics</h4>

 
<dl>
<dt><code><a href="#topic+simNpC">simNpC</a></code></dt><dd><p> Simulate data on abundance (N), detection probability (p) and resulting counts (C) under a counting process with imperfect detection  (AHM2 - 1.2)</p>
</dd>
<dt><code><a href="#topic+simPOP">simPOP</a></code></dt><dd><p> Simulate count data under a demographic state-space, or Dail-Madsen, model (no robust design) (AHM2 - 1.7.1)</p>
</dd>
<dt><code><a href="#topic+simPH">simPH</a></code></dt><dd><p> Simulate count data with phenological curves within a year (AHM2 - 1.8.1)</p>
</dd>
</dl>
 


<h4>Modeling Population Dynamics with Count Data</h4>

 
<dl>
<dt><code><a href="#topic+simDM0">simDM0</a></code></dt><dd><p> Simulate count data from a Dail-Madsen model under a robust design, no covariates (AHM2 - 2.5.1)</p>
</dd>
<dt><code><a href="#topic+simDM">simDM</a></code></dt><dd><p>  Simulate count data from a Dail-Madsen model under a robust design, with covariates (AHM2 - 2.5.5)</p>
</dd>
<dt><code><a href="#topic+simMultMix">simMultMix</a></code></dt><dd><p>  Simulate &ldquo;removal&rdquo; count data from a multinomial-mixture model (AHM2 - 2.7.1)</p>
</dd>
<dt><code><a href="#topic+simFrogDisease">simFrogDisease</a></code></dt><dd><p>  Simulate detection data for diseased frogs (AHM2 - 2.9.1)</p>
</dd>
</dl>
 


<h4>Hierarchical Models of Survival</h4>

 
<dl>
<dt><code><a href="#topic+simCJS">simCJS</a></code></dt><dd><p> Simulate individual capture history data under a Cormack-Jolly-Seber (CJS) survival model (AHM2 - 3.2.2)</p>
</dd>
</dl>
 


<h4>Dynamic Occupancy Models</h4>

 
<dl>
<dt><code><a href="#topic+simDynocc">simDynocc</a></code></dt><dd><p> Simulate detection/nondetection data under a dynamic occupancy model under a wide range of conditions (AHM2 - 4.4)</p>
</dd>
<dt><code><a href="#topic+simDemoDynocc">simDemoDynocc</a></code></dt><dd><p> Simulate detection/nondetection data under a demographic dynamic occupancy model (AHM2 - 4.12)</p>
</dd>
</dl>
 


<h4>Dynamic Community Models</h4>

 
<dl>
<dt><code><a href="#topic+simDCM">simDCM</a></code></dt><dd><p> Simulate detection/nondetection data under a general dynamic community model (site-occupancy variant)  (AHM2 - 5.2)</p>
</dd>
</dl>
 


<h4>Spatial Models of Distribution and Abundance</h4>

 
<dl>
<dt><code><a href="#topic+simDynoccSpatial">simDynoccSpatial</a></code></dt><dd><p> Simulate detection/nondetection data under a dynamic occupancy model with spatial covariate and spatial autocorrelation (AHM2 - 9.6.1.1). See also <code><a href="#topic+simDynoccSpatialData">simDynoccSpatialData</a></code></p>
</dd>
<dt><code><a href="#topic+simExpCorrRF">simExpCorrRF</a></code></dt><dd><p> Simulate data from a Gaussian random field with negative exponential correlation function (AHM2 - 9.2)</p>
</dd>
<dt><code><a href="#topic+simOccSpatial">simOccSpatial</a></code></dt><dd><p> Simulate detection/nondetection data under a spatial, static occupancy model for a real landscape in the Bernese Oberland (Swiss Alps) (AHM2 - 9.2)</p>
</dd>
<dt><code><a href="#topic+simNmixSpatial">simNmixSpatial</a></code></dt><dd><p> Simulate counts under a spatial, static binomial N-mixture model for a real landscape in the Bernese Oberland (Swiss Alps) (AHM2 - 9.2)</p>
</dd>
</dl>
 


<h4>Integrated Models for Multiple Types of Data</h4>

 
<dl>
<dt><code><a href="#topic+simPPe">simPPe</a></code></dt><dd><p> Simulate a spatial point pattern in a heterogeneous landscape and show aggregation to abundance and occurrence ('e' for educational version)  (AHM2 - 10.2)</p>
</dd>
<dt><code><a href="#topic+simDataDK">simDataDK</a></code></dt><dd><p> Simulate data for an integrated species distribution model (SDM) of Dorazio-Koshkina (AHM2 - 10.6.1)</p>
</dd>
</dl>
 


<h4>Spatially Explicit Distance Sampling</h4>

 
<dl>
<dt><code><a href="#topic+simSpatialDSline">simSpatialDSline</a></code></dt><dd><p> Simulate line transect distance sampling data with spatial variation in density  (AHM2 - 11.5)</p>
</dd>
<dt><code><a href="#topic+simSpatialDSte">simSpatialDSte</a></code></dt><dd><p> Simulate data for replicate line transect distance sampling surveys with spatial variation in density and temporary emigration (AHM2 - 11.8.1)</p>
</dd>
<dt><code><a href="#topic+simDSM">simDSM</a></code></dt><dd><p> Simulate line transect data for density surface modeling (AHM2 - 11.10.1)</p>
</dd>
</dl>
 


<h3>DATA SETS</h3>


<dl>
<dt><code><a href="#topic+BerneseOberland">BerneseOberland</a></code></dt><dd><p> Landscape data for the Bernese Oberland around Interlaken, Switzerland (AHM2 - 9.2)</p>
</dd>
<dt><code><a href="#topic+crestedTit">crestedTit</a></code></dt><dd><p> Crested Tit data from the Swiss Breeding Bird Survey MHB (Monitoring Häufige Brutvögel) for 1999 to 2015 (AHM2 - 1.3)</p>
</dd>
<dt><code><a href="#topic+cswa">cswa</a></code></dt><dd><p> Chestnut-sided Warbler data for point counts and spot-mapping from White Mountain National Forest (AHM2 - 2.4.3)</p>
</dd>
<dt><code><a href="#topic+crossbillAHM">crossbillAHM</a></code></dt><dd><p> Crossbill data from the Swiss Breeding Bird Survey for 2001 to 2012 (AHM2 - 4.9)</p>
</dd>
<dt><code><a href="#topic+dragonflies">dragonflies</a></code></dt><dd><p> Toy data set used in AHM1 - 3.1</p>
</dd>
<dt><code><a href="#topic+duskySalamanders">duskySalamanders</a></code></dt><dd><p> Counts of juvenile vs adult salamanders over 7 years (AHM2 - 2.9.2)</p>
</dd>
<dt><code><a href="#topic+EurasianLynx">EurasianLynx</a></code></dt><dd><p> Data for Eurasian Lynx in Italy and Switzerland (AHM2 - 7.3.2)</p>
</dd>
<dt><code><a href="#topic+Finnmark">Finnmark</a></code></dt><dd><p> Data from surveys of birds in Finnmark in NE Norway (AHM2 - 5.7)</p>
</dd>
<dt><code><a href="#topic+FrenchPeregrines">FrenchPeregrines</a></code></dt><dd><p> Detection data for peregrines in the French Jura (AHM2 - 4.11)</p>
</dd>
<dt><code><a href="#topic+greenWoodpecker">greenWoodpecker</a></code></dt><dd><p> Count data for Green Woodpeckers in Switzerland from the MHB (AHM2 - 2.2)</p>
</dd>
<dt><code><a href="#topic+HubbardBrook">HubbardBrook</a></code></dt><dd><p> Point count data for warblers from Hubbard Brook, New Hampshire (AHM2 - 8.2)</p>
</dd>
<dt><code><a href="unmarked.html#topic+jay">jay</a></code></dt><dd><p> The European Jay data set (from the MHB) is now included in <span class="pkg">unmarked</span> (AHM1 - 7.9)</p>
</dd>
<dt><code><a href="#topic+MesoCarnivores">MesoCarnivores</a></code></dt><dd><p> Camera trap data for 3 species of meso-carnivores (AHM2 - 8.2)</p>
</dd>
<dt><code><a href="#topic+MHB2014">MHB2014</a></code></dt><dd><p> Complete data from the Swiss Breeding Bird Survey MHB (Monitoring Häufige Brutvögel) for the year 2014 (AHM1 - 11.3)</p>
</dd>
<dt><code><a href="#topic+spottedWoodpecker">spottedWoodpecker</a></code></dt><dd><p> Data for Middle Spotted Woodpeckers in Switzerland (AHM2 - 4.11.2)</p>
</dd>
<dt><code><a href="#topic+SwissAtlasHa">SwissAtlasHa</a></code></dt><dd><p> A 1ha-scale subset of the count data from the Swiss Breeding Bird Atlas (AHM2 - 8.4.2)</p>
</dd>
<dt><code><a href="#topic+SwissEagleOwls">SwissEagleOwls</a></code></dt><dd><p> Territory-level, multi-state detection/nondetection data for Eagle Owls in Switzerland (AHM2 - 6.4)</p>
</dd>
<dt><code><a href="#topic+SwissMarbledWhite">SwissMarbledWhite</a></code></dt><dd><p> Data from the Biodiversity Monitoring Program (LANAG) in the Swiss Canton of Aargau for Marbled White butterfly (AHM2 - 1.8.2)</p>
</dd>
<dt><code><a href="#topic+SwissSquirrels">SwissSquirrels</a></code></dt><dd><p> Count data for Red Squirrels in Switzerland from the Swiss breeding bird survey MHB (AHM1 - 10.9)</p>
</dd>
<dt><code><a href="#topic+SwissTits">SwissTits</a></code></dt><dd><p> Data for 6 species of tits in Switzerland from from the Swiss breeding bird survey MHB  during 2004 to 2013 (AHM1 - 6.13.1)</p>
</dd>
<dt><code><a href="#topic+treeSparrow">treeSparrow</a></code></dt><dd><p> Data for Tree Sparrows in Alaska (AHM2 - 11.8.4)</p>
</dd>
<dt><code><a href="#topic+ttdPeregrine">ttdPeregrine</a></code></dt><dd><p> Time-to-detection data for Peregrines (AHM1 - 10.12.2)</p>
</dd>
<dt><code><a href="#topic+UKmarbledWhite">UKmarbledWhite</a></code></dt><dd><p> Data from the UK Butterfly Monitoring Scheme (UKBMS) for Marbled White butterfly (AHM2 - 1.8.2)</p>
</dd>
<dt><code><a href="#topic+wagtail">wagtail</a></code></dt><dd><p> Distance sampling data for Yellow Wagtails in The Netherlands (AHM1 - 9.5.3)</p>
</dd>
<dt><code><a href="#topic+waterVoles">waterVoles</a></code></dt><dd><p> Detection/nondetection data for the Mighty Water Vole of Scotland (AHM2 - 7.2.2)</p>
</dd>
<dt><code><a href="#topic+wigglyLine">wigglyLine</a></code></dt><dd><p> Coordinates for a wiggly transect line (AHM2 - 11.9)</p>
</dd>
<dt><code><a href="#topic+willowWarbler">willowWarbler</a></code></dt><dd><p> Capture-history (survival) data for Willow Warblers in Britain (AHM2 - 3.4.1)</p>
</dd>
</dl>
 

<h3>UTILITY FUNCTIONS</h3>


<dl>
<dt><code><a href="#topic+ppc.plot">ppc.plot</a></code></dt><dd><p> Plot results from posterior predictive checks in section AHM1 - 6.8, for a fitted binomial N-mixture model object with JAGS</p>
</dd>
<dt><code><a href="#topic+plot_Nmix_resi">plot_Nmix_resi</a></code></dt><dd><p> Do diagnostic plots for one binomial N-mixture model fitted with all three mixture distributions currently available in unmarked: Poisson, negative binomial and zero-inflated Poisson (AHM1 - 6.9.3)</p>
</dd>
<dt><code><a href="#topic+map.Nmix.resi">map.Nmix.resi</a></code></dt><dd><p> Produce a map of the residuals from a binomial N-mixture model (see Section AHM1 - 6.9.3)</p>
</dd>
<dt><code><a href="#topic+instRemPiFun">instRemPiFun</a></code>, <code><a href="#topic+crPiFun">crPiFun</a></code>, <code><a href="#topic+crPiFun.Mb">crPiFun.Mb</a></code>, <code><a href="#topic+MhPiFun">MhPiFun</a></code></dt><dd><p> Define the relationship between the multinomial cell probabilities and the underlying detection probability parameters (i.e., a pi function) in various designs (AHM1 - 7.8 and AHM2 - Chapter 2)</p>
</dd>
<dt><code><a href="#topic+spline.prep">spline.prep</a></code></dt><dd><p> Prepare input for BUGS model when fitting a spline for a covariate (AHM1 - 10.14)</p>
</dd>
<dt><code><a href="#topic+graphSSM">graphSSM</a></code></dt><dd><p> Plot trajectories of counts and latent abundance from a fitted Gaussian state-space model (AHM2 - 1.6.1)</p>
</dd>
<dt><code><a href="#topic+ch2marray">ch2marray</a></code></dt><dd><p> Convert capture history data to the m-array aggregation (AHM2 - 3.4.1)</p>
</dd>
<dt><code><a href="#topic+valid_data">valid_data</a></code></dt><dd><p> Partial validation of simulated data with false positives (AHM2 - 7.6.2)</p>
</dd>
<dt><code><a href="#topic+getLVcorrMat">getLVcorrMat</a></code></dt><dd><p> Compute the correlation matrix from an analysis of a latent variable occupancy or binomial N-mixture model (AHM2 - 8.4.2)</p>
</dd>
<dt><code><a href="#topic+zinit">zinit</a></code></dt><dd><p> Generate starting values for fitting survival models (introduced in AHM2 - 3.2.3).</p>
</dd>
<dt><code><a href="#topic+standardize">standardize</a></code></dt><dd><p> Standardize covariates to mean 0, SD 1.</p>
</dd>
<dt><code><a href="#topic+fitstats">fitstats</a></code>, <code><a href="#topic+fitstats2">fitstats2</a></code></dt><dd><p> Calculate fit-statistics used in parboot GOF tests throughout the book (eg, Sections AHM1 - 7.5.4, AHM1 - 7.9.3, AHM2 - 2.3.3)</p>
</dd>
<dt><code><a href="#topic+e2dist">e2dist</a></code></dt><dd><p> Compute a matrix of Euclidean distances</p>
</dd>
<dt><code><a href="#topic+image_scale">image_scale</a></code></dt><dd><p> Draw scale for image (introduced in chapter AHM1 - 9.8.3) </p>
</dd>
<dt><code><a href="#topic+bigCrossCorr">bigCrossCorr</a></code></dt><dd><p> Report cross-correlations above a given threshold </p>
</dd>
<dt><code><a href="#topic+Color_Ramps">Color_Ramps</a></code></dt><dd><p> Color ramps for use with image or raster plots </p>
</dd>
</dl>
 

<h3>Author(s)</h3>

<p>Marc Kéry, Andy Royle, Mike Meredith
</p>

<hr>
<h2 id='BerneseOberland'>
Landscape data for the Bernese Oberland around Interlaken, in the Alps of central Switzerland
</h2><span id='topic+BerneseOberland'></span>

<h3>Description</h3>

<p>Spatially-referenced data on elevation, forest cover, and water cover at a 1km-sq resolution for a 50km x 50km region in Switzerland, the Bernese Oberland. This is a small subset of the <code>Switzerland</code> data in the <span class="pkg">unmarked</span> package. See the Examples for a plot of the location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BerneseOberland)</code></pre>


<h3>Format</h3>

<p>A data frame with 2500 observations on the following 5 variables.
</p>

<dl>
<dt>x </dt><dd><p>Easting (m)</p>
</dd>
<dt>y </dt><dd><p>Northing (m)</p>
</dd>
<dt>elevation </dt><dd><p>a numeric vector (m)</p>
</dd>
<dt>forest </dt><dd><p>a numeric vector (percent cover)</p>
</dd>
<dt>water </dt><dd><p>a numeric vector (percent cover)</p>
</dd>
</dl>



<h3>Details</h3>

<p>Forest and water coverage (in percent area) was computed using the
1992-97 landcover dataset of the Swiss Federal Statistical Office
(http://www.bfs.admin.ch). Median elevation (in meters) was computed
using a median aggregation of the digital elevation model of the Swiss
Federal Statistical Office.
</p>
<p>x and y are the coordinates of the center of each 1km2 pixel.
</p>
<p>The coordinate reference system is intentionally not specified.
</p>
<p>These data can only be used for non-profit projects. Otherwise, written
permission must be obtained from the Swiss Federal Statistical Office.
</p>


<h3>Source</h3>

<p>Swiss Federal Statistical Office (http://www.bfs.admin.ch)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BerneseOberland)
str(BerneseOberland)


library(raster)
data(Switzerland, package="unmarked")
r1 &lt;- with(Switzerland, rasterFromXYZ(data.frame(x = x, y = y, z = elevation)))
mapPalette1 &lt;- colorRampPalette(c("grey", "yellow", "orange", "red"))
plot(r1, col = mapPalette1(100), axes = FALSE, box = FALSE, zlim = c(0, 4500),
  main = "Location of Bernese Oberland data set")
with(BerneseOberland, rect(min(x), min(y), max(x), max(y), lwd=2))


</code></pre>

<hr>
<h2 id='bigCrossCorr'>
Cross correlations for MCMC output
</h2><span id='topic+bigCrossCorr'></span>

<h3>Description</h3>

<p>A wrapper for <code>coda::crosscorr</code>, which calculates cross-correlations between posterior draws of parameters in Markov chain Monte Carlo output. When the output has hundreds of parameters, the matrix produced by <code>crosscorr</code> is unwieldy, and <code>bigCrossCorr</code> extracts only those greater than a given threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bigCrossCorr(x, big = 0.6, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bigCrossCorr_+3A_x">x</code></td>
<td>

<p>an <code>mcmc</code> or <code>mcmc.list</code> object.
</p>
</td></tr>
<tr><td><code id="bigCrossCorr_+3A_big">big</code></td>
<td>

<p>only values below -big or above +big will be returned
</p>
</td></tr>
<tr><td><code id="bigCrossCorr_+3A_digits">digits</code></td>
<td>

<p>the number of decimal places to return
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with 2 columns for the names of parameters and a 3rd column with the cross-correlation.
</p>


<h3>Author(s)</h3>

<p>Mike Meredith
</p>


<h3>See Also</h3>

<p><code><a href="coda.html#topic+crosscorr">crosscorr</a></code> in package <span class="pkg">coda</span>.
</p>

<hr>
<h2 id='ch2marray'>
Converts capture-histories to an m-array
</h2><span id='topic+ch2marray'></span>

<h3>Description</h3>

<p>Converts capture-histories to an m-array for use in a Cormack-Jolly-Seber (CJS) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch2marray(CH)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch2marray_+3A_ch">CH</code></td>
<td>

<p>An individuals x time matrix of capture records, 1 if captured, 0 otherwise, no missing values.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An m-array, a (years-1) x years matrix, where element [i, j] contains the number of individuals released in year i and recaptured in year j+1 (by definition no recaptures can occur in year 1). The last column contains the number of individuals released in year i and never recaptured.
</p>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle, modified from code in Kéry and Schaub (2012).
</p>


<h3>References</h3>

<p>Kéry and Schaub (2012) <em>Bayesian population analysis using WinBUGS - a hierarchical perspective</em>, Academic Press.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 3.4.1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(willowWarbler)
ch &lt;- as.matrix(willowWarbler$birds[ , 1:11]) # extract capture-histories.
dim(ch)
ch2marray(ch)
</code></pre>

<hr>
<h2 id='Color+20Ramps'>
Color Ramps
</h2><span id='topic+Color_Ramps'></span><span id='topic+rampYOR'></span><span id='topic+rampGreens'></span><span id='topic+rampGreys'></span><span id='topic+rampBYR'></span><span id='topic+rampGBr'></span>

<h3>Description</h3>

<p>These create vectors of <code>n</code> contiguous colors for use in image and raster plots. They are similar to heat.colors or terrain.colors but with extra arguments to give greater control of colors. Currently included ramps are:
</p>
<p>* sequential yellow-orange-red
</p>
<p>* sequential light to dark green
</p>
<p>* sequential light to dark gray
</p>
<p>* diverging blue-yellow-red
</p>
<p>* diverging green-brown
</p>
<p>Sequential ramps go from light to dark, diverging ramps from dark through light to dark. All these ramps are color-blind safe and based on color palettes from <a href="https://colorbrewer2.org/">https://colorbrewer2.org/</a> by Cynthia Brewer and colleagues.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rampYOR(n=5, range=1:9, bias=1, ...)
rampGreens(n=5, range=1:9, bias=1, ...)
rampGreys(n=5, range=1:9, bias=1, ...)
rampBYR(n=5, range=1:11, bias=1, ...)
rampGBr(n=5, range=1:11, bias=1, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Color+2B20Ramps_+3A_n">n</code></td>
<td>

<p>the number of colors to be in the palette.
</p>
</td></tr>
<tr><td><code id="Color+2B20Ramps_+3A_range">range</code></td>
<td>

<p>the range of colors from the underlying palette to include: each ramp is based on a palette of 9 (if sequential) or 11 (if diverging) colors; range allows the extreme colors to be excluded.
</p>
</td></tr>
<tr><td><code id="Color+2B20Ramps_+3A_bias">bias</code></td>
<td>

<p>a positive number: values &gt;1 give more widely spaced colors at the high end.
</p>
</td></tr>
<tr><td><code id="Color+2B20Ramps_+3A_...">...</code></td>
<td>

<p>additional arguments passed to <code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a vector of color values in hexadecimal format.
</p>


<h3>Author(s)</h3>

<p>Mike Meredith.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># uses the built-in volcano data set
require(grDevices) # for colours
require(graphics)
image(volcano, col=rampYOR(225), main="Sequential yellow-orange-red")
image(volcano, col=rampBYR(225), main="Divergent blue-yellow-red")
image(volcano, col=rampGBr(225), main="Divergent green-brown")
points(runif(500), runif(500), pch=16, cex=0.7) # add points
title(sub="Points are hard to see on the darkest colors", line=2)
image(volcano, col=rampGBr(225, range=2:10), main="Green-brown without darkest colors")
points(runif(500), runif(500), pch=16, cex=0.7)

# Try with a raster
require(raster)
r &lt;- raster(system.file("external/test.grd", package="raster"))
plot(r, main="Default colors") # default is rev(terrain.colors(225))
plot(r, col=rampGBr(225), main="Divergent green-brown")
plot(r, col=rampGBr(225, bias=3), main="Divergent green-brown, bias=3")
plot(r, col=rampGBr(225, bias=0.5), main="Divergent green-brown, bias=0.5")
</code></pre>

<hr>
<h2 id='crestedTit'>
Count data from the Swiss Breeding Bird Survey MHB for crested tits from 1999 to 2015
</h2><span id='topic+crestedTit'></span>

<h3>Description</h3>

<p>The Swiss breeding bird survey (&quot;Monitoring Häufige Brutvögel&quot; MHB) has monitored the populations of approximately 150 common species since 1999. The MHB sample consists of 267 1-km squares that are laid out as a grid across Switzerland. Fieldwork is conducted by about 200 skilled birdwatchers annually, most of them volunteers. Avian populations are monitored using a simplified territory mapping protocol (also called spot-mapping West of the Atlantic), where each square is surveyed up to three times during the breeding season (only twice above the tree line around 2000 m elevation). Surveys are conducted along a transect that does not change over the years and is 4-6 kms in length on average.
</p>
<p>The data frame <code>crestedTit</code> has the data for Crested Tits <em>Parus cristatus</em> from 1999 to 2015. There are some missing values: see Details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("crestedTit")</code></pre>


<h3>Format</h3>

<p><code>crestedTit</code> is a data frame with 267 rows and 131 columns:
</p>

<dl>
<dt>coordx, coordy </dt><dd><p>the x and y coordinates of the center of the quadrat; the coordinate reference system intentionally not specified.</p>
</dd>
<dt>elev </dt><dd><p>the mean elevation of the quadrat, in meters.</p>
</dd>
<dt>forest </dt><dd><p>percentage forest cover</p>
</dd>
<dt>nsurveys </dt><dd><p>the number of replicate surveys <em>planned</em> in the quadrat; above the tree-line 2, otherwise 3.</p>
</dd>
<dt>1999 to 2016 </dt><dd><p>total number of territories observed for the year.</p>
</dd>
<dt>date991 to date163 </dt><dd><p>Julian date of the survey, 1 = 1st January; the first 2 digits in the column name indicate the year and the 3rd digit the survey.</p>
</dd>
<dt>dur991 to dur163 </dt><dd><p>duration of the survey, in minutes; the first 2 digits in the column name indicate the year and the 3rd digit the survey.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Missing values in the <code>date</code> array indicate that the corresponding survey was not carried out.
</p>
<p>On 26 occasions when surveys were carried out, the duration was not recorded, resulting in additional NAs in the <code>dur</code> array.
</p>
<p>A new method for recording breeding territories was introduced in 2004, but the old protocol was in use at some sites until 2013. Surveys with the old protocol have the counts shown as NA in the <code>count</code> array.
</p>
<p>See also Chapter 6 in Kéry &amp; Royle (2016) for further description of the survey and the data it produces.
</p>


<h3>Source</h3>

<p>Swiss Ornithological Institute
</p>


<h3>References</h3>

<p>Kéry &amp; Royle (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 6.
</p>
<p>Kéry &amp; Royle (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crestedTit)
str(crestedTit)

# Prepare objects needed for section AHM2 - 1.3 and following
C &lt;- as.matrix(crestedTit[, 6:23]) # matrix of counts
year &lt;- 1999:2016
datetmp &lt;- as.matrix(crestedTit[, 24:77])  # matrix of Julian dates
datefull &lt;- array(datetmp, c(nrow(datetmp), 3, ncol(datetmp)/3))
    # site x rep x year array
durtmp &lt;- as.matrix(crestedTit[, 78:131])  # matrix of survey durations
durfull &lt;- array(durtmp, c(nrow(durtmp), 3, ncol(durtmp)/3))
    # site x rep x year array

# Get mean date and duration of survey for each site and year
mdate &lt;- apply(datefull, c(1,3), mean, na.rm=TRUE)
mdate[is.nan(mdate)] &lt;- NA  # Replace NaN with NA
mdur &lt;- apply(durfull, c(1,3), mean, na.rm=TRUE)
mdur[is.nan(mdur)] &lt;- NA

# For Sec 1.5, we need standardised covariates with missing values imputed
elev.sc &lt;- as.numeric(scale(crestedTit$elev))     # site elevation
forest.sc &lt;- as.numeric(scale(crestedTit$forest)) # site forest cover

mean.date &lt;- mean(mdate, na.rm=TRUE)         # mean survey date per site
sd.date &lt;- sd(mdate, na.rm=TRUE)
mdate.sc &lt;- (mdate - mean.date) / sd.date
mdate.sc[is.na(mdate.sc)] &lt;- 0               # mean imputation

mean.dur &lt;- mean(mdur, na.rm=TRUE)           # mean survey duration per site
sd.dur &lt;- sd(mdur, na.rm=TRUE)
mdur.sc &lt;- (mdur - mean.dur) / sd.dur
mdur.sc[is.na(mdur.sc)] &lt;- 0                 # mean imputation

# For sections 1.6 and 1.7, we remove sites with no crested tits recorded,
#   or recorded in only one year:
nzero &lt;- apply(C == 0, 1, sum, na.rm=TRUE) # number of zero years per site
sel &lt;- nzero &lt;= 1  # TRUE if site has 2 or more years of non-zero data

</code></pre>

<hr>
<h2 id='crossbillAHM'>
Data from the Swiss Breeding Bird Survey MHB for European Crossbill from 2001 to 2012
</h2><span id='topic+crossbillAHM'></span>

<h3>Description</h3>

<p>The Swiss breeding bird survey (&quot;Monitoring Häufige Brutvögel&quot; MHB) has monitored the populations of approximately 150 common species since 1999. The MHB sample consists of 267 1-km squares that are laid out as a grid across Switzerland. Fieldwork is conducted by about 200 skilled birdwatchers annually, most of them volunteers. Avian populations are monitored using a simplified territory mapping protocol (also called spot-mapping West of the Atlantic), where each square is surveyed up to three times during the breeding season (only twice above the tree line around 2000 m elevation). Surveys are conducted along a transect that does not change over the years and is 4-6 kms in length on average.
</p>
<p>The data frame <code>crossbillAHM</code> has the data for European Crossbill (<em>Loxia curvirostra</em>)  from 2001 to 2012.
</p>
<p>A variant of this data set for 1999 to 2007 only is included in package <span class="pkg">unmarked</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("crossbillAHM")</code></pre>


<h3>Format</h3>

<p><code>crossbillAHM</code> is a data frame with 267 rows and 77 columns:
</p>

<dl>
<dt>coordx, coordy </dt><dd><p>the x and y coordinates of the center of the quadrat; the coordinate reference system intentionally not specified.</p>
</dd>
<dt>elev </dt><dd><p>the mean elevation of the quadrat, m.</p>
</dd>
<dt>forest </dt><dd><p>percentage forest cover</p>
</dd>
<dt>nsurveys </dt><dd><p>the number of replicate surveys <em>planned</em> in the quadrat; above the tree-line 2, otherwise 3.</p>
</dd>
<dt>det011 to det123 </dt><dd><p>1 if the species was detected in the quadrat, 0 otherwise; NA if the corresponding survey was not carried out; the first 2 digits indicate the year and the 3rd digit the survey.</p>
</dd>
<dt>date011 to date123 </dt><dd><p>Julian date of the survey, 1 = 1st January; the first 2 digits indicate the year and the 3rd digit the survey; NA if the corresponding survey was not carried out.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swiss Ornithological Institute
</p>


<h3>References</h3>

<p>Kéry, M &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(crossbillAHM)
str(crossbillAHM)

# Extract data as site x survey x year arrays
ytmp &lt;- as.matrix(crossbillAHM[, 6:41]) # matrix of detections
y &lt;- array(ytmp, c(nrow(ytmp), 3, ncol(ytmp)/3))
datetmp &lt;- as.matrix(crossbillAHM[, 42:77])  # matrix of Julian dates
date &lt;- array(datetmp, c(nrow(datetmp), 3, ncol(datetmp)/3))

</code></pre>

<hr>
<h2 id='cswa'>
Point count and spot-mapping data for Chestnut-sided Warbler
</h2><span id='topic+cswa'></span>

<h3>Description</h3>

<p>Chestnut-sided Warblers (<em>Setophaga pensylvanica</em>) in 38 &ldquo;wildlife openings&rdquo; in the White Mountain National Forest were surveyed using point counts and spot-mapping during June and July 2004 as part of Richard Chandler's MS thesis. Counts are for birds detected by song at each point. Two of the larger openings had more than one point, giving 43 points in all. Surveys lasted 10 mins and were divided into intervals of (0–2], (2–5], and (5–10] min. Each point was surveyed 3 times, except for one point surveyed only twice. The spot-mapping data come from intensive surveys of each patch recording individual sightings and nest locations, and using counter-singing to separate adjacent territories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("cswa")</code></pre>


<h3>Format</h3>

<p><code>cwsa</code> is a list with 3 components:
</p>

<dl>
<dt><b>counts </b></dt><dd><p>a points x intervals x occasions array of counts; NAs correspond to the missing survey.</p>
</dd>
</dl>


<dl>
<dt><b>covs </b></dt><dd><p>a data frame with rows for 43 points and the following columns:
</p>

<ul>
<li><p> time1 : time of start of first survey, hr; NA for the missing survey.
</p>
</li>
<li><p> time2 : same for second survey.
</p>
</li>
<li><p> time3 : same for third survey.
</p>
</li>
<li><p> date1 : date of first survey, NA for the missing survey.
</p>
</li>
<li><p> date2 : date of second survey.
</p>
</li>
<li><p> date3 : date of third survey.
</p>
</li>
<li><p> obs1 : observer ID for first survey.
</p>
</li>
<li><p> obs2 : observer ID for second survey.
</p>
</li>
<li><p> obs3 : observer ID for third survey.
</p>
</li>
<li><p> patchArea : patch area, ha.
</p>
</li>
<li><p> plotArea : size of point count area, ha. Most were 50-m radius  but some were smaller because they overlapped adjacent forests which weren’t the focus of the study.
</p>
</li>
<li><p> woodHt : woody vegetation height, m.
</p>
</li>
<li><p> woodCov : proportion covered by woody vegetation.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>spotMaps </b></dt><dd><p>a data frame with rows for 38 patches and the following columns:
</p>

<ul>
<li><p> CSWA : estimated population of chestnut-sided warblers in each patch obtained from spot-mapping.
</p>
</li>
<li><p> parea : patch area, ha.
</p>
</li></ul>
</dd></dl>



<h3>Source</h3>

<p>David King and colleagues.
</p>


<h3>References</h3>

<p>Chandler, R.B., King, D.I., &amp; Chandler, C.C. (2009) Effects of management regime on the abundance and nest survival of shrubland birds in wildlife openings in northern New England, USA. <em>Forest Ecology and Management</em>, 258, 1669-1676.
</p>
<p>Chandler, R.B., Royle, J.A., &amp; King, D.I. (2011) Inference about density and temporary emigration in unmarked populations. <em>Ecology</em>, 92, 1429-1435.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cswa)
str(cswa)

# Replace the NAs in the covariates with the mean from other surveys:
covs &lt;- cswa$covs
covs$time1[is.na(covs$time1)] &lt;- mean(covs$time1, na.rm=TRUE)
covs$date1[is.na(covs$date1)] &lt;- mean(covs$date1, na.rm=TRUE)
# Now use covs instead of cswa$covs

</code></pre>

<hr>
<h2 id='data.fn'>
Simulate count data under a binomial N-mixture model
</h2><span id='topic+data.fn'></span>

<h3>Description</h3>

<p>Function to simulate point counts replicated at M sites during J occasions. Population closure is assumed for each site. Expected abundance may be affected by elevation (elev), forest cover (forest) and their interaction. Expected detection probability may be affected by elevation, wind speed (wind) and their interaction. Used in AHM1 to illustrate how a data set under some specific model of interest can be simulated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.fn(M = 267, J = 3, mean.lambda = 2, beta1 = -2, beta2 = 2, beta3 = 1,
   mean.detection = 0.3, alpha1 = 1, alpha2 = -3, alpha3 = 0, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.fn_+3A_m">M</code></td>
<td>

<p>Number of spatial replicates (sites)
</p>
</td></tr>
<tr><td><code id="data.fn_+3A_j">J</code></td>
<td>

<p>Number of temporal replicates (occasions)
</p>
</td></tr>
<tr><td><code id="data.fn_+3A_mean.lambda">mean.lambda</code></td>
<td>

<p>Mean abundance at value 0 of abundance covariates
</p>
</td></tr>
<tr><td><code id="data.fn_+3A_beta1">beta1</code></td>
<td>

<p>Main effect of elevation on abundance
</p>
</td></tr>
<tr><td><code id="data.fn_+3A_beta2">beta2</code></td>
<td>

<p>Main effect of forest cover on abundance
</p>
</td></tr>
<tr><td><code id="data.fn_+3A_beta3">beta3</code></td>
<td>

<p>Interaction effect on abundance of elevation and forest cover
</p>
</td></tr>
<tr><td><code id="data.fn_+3A_mean.detection">mean.detection</code></td>
<td>

<p>Mean detection prob. at value 0 of detection covariates
</p>
</td></tr>
<tr><td><code id="data.fn_+3A_alpha1">alpha1</code></td>
<td>

<p>Main effect of elevation on detection probability
</p>
</td></tr>
<tr><td><code id="data.fn_+3A_alpha2">alpha2</code></td>
<td>

<p>Main effect of wind speed on detection probability
</p>
</td></tr>
<tr><td><code id="data.fn_+3A_alpha3">alpha3</code></td>
<td>

<p>Interaction effect on detection of elevation and wind speed
</p>
</td></tr>
<tr><td><code id="data.fn_+3A_show.plot">show.plot</code></td>
<td>

<p>if TRUE, plots of the data will be displayed; set to FALSE if you are running simulations
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>elev</code></td>
<td>
<p>Scaled elevation (a vector of length M)</p>
</td></tr>
<tr><td><code>forest</code></td>
<td>
<p>Scaled forest cover (a vector of length M)</p>
</td></tr>
<tr><td><code>wind</code></td>
<td>
<p>Scaled wind speed (an M x J matrix)</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>Expected number of individuals at each site (a vector of length M)</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Realized number of individuals at each site (a vector of length M)</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Probability of detection for each survey (an M x J matrix)</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>The number of detections for each survey (an M x J matrix)</p>
</td></tr>
<tr><td><code>Ntotal</code></td>
<td>
<p>Total abundance, <code>sum(N)</code> </p>
</td></tr>
<tr><td><code>psi.true</code></td>
<td>
<p>True occupancy in sample</p>
</td></tr>
<tr><td><code>summaxC</code></td>
<td>
<p>Sum of max counts (all sites)</p>
</td></tr>
<tr><td><code>psi.obs</code></td>
<td>
<p> Observed occupancy in sample</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The colors used for points in some of the plots indicate different temporal replicates.
</p>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 4.3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a simulated data set with default arguments and look at the structure:
tmp &lt;- data.fn()
str(tmp)

str(data.fn(J = 2))              # Only 2 surveys
str(data.fn(J = 1))              # No temporal replicate
str(data.fn(M = 1, J = 100))     # No spatial replicates, but 100 counts
str(data.fn(beta3 = 1))          # With interaction elev-wind on p
str(data.fn(M = 267, J = 3, mean.lambda = 2, beta1 = -2, beta2 = 2, beta3 = 1,
  mean.detection = 1))           # No obs. process (i.e., p = 1, perfect detection)
str(data.fn(mean.lambda = 50))   # Really common species
str(data.fn(mean.lambda = 0.05)) # Really rare species
</code></pre>

<hr>
<h2 id='dragonflies'>
Fictional data for dragonflies
</h2><span id='topic+dragonflies'></span><span id='topic+pop'></span><span id='topic+sex'></span><span id='topic+wing'></span><span id='topic+body'></span><span id='topic+mites'></span><span id='topic+color'></span><span id='topic+damage'></span>

<h3>Description</h3>

<p>A toy data set with fictional data for 9 individuals of the dragonfly <em>Onychogomphus uncatus</em> from 3 populations in the Spanish Pyrenees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dragonflies)</code></pre>


<h3>Format</h3>

<p>The format is seven vectors of length 9:
</p>

<dl>
<dt>pop</dt><dd><p>a factor indicating which population the individual was drawn from.</p>
</dd>
<dt>sex</dt><dd><p>a factor indicating the sex of each individual.</p>
</dd>
<dt>wing</dt><dd><p>wingspan.</p>
</dd>
<dt>body</dt><dd><p>body length.</p>
</dd>
<dt>mites</dt><dd><p>number of mites (ectoparasites) counted on each individual.</p>
</dd>
<dt>color</dt><dd><p>proportion of body yellow as opposed to black.</p>
</dd>
<dt>damage</dt><dd><p>the number of wings (out of 4) damaged.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Fictitious data.
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 3.1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dragonflies)
lm(wing ~ pop + body)

</code></pre>

<hr>
<h2 id='duskySalamanders'>
Age-classified counts of dusky salamanders from two mid-Atlantic states in the USA
</h2><span id='topic+duskySalamanders'></span>

<h3>Description</h3>

<p>Northern dusky salamanders (<em>Desmognathus fuscus</em>) were sampled in 12 headwater streams in Maryland and the District of Columbia, USA, annually in June and July from 2005 to 2012. Most streams were sampled at two locations separated by at least 100 m along the stream reach for a total of 21 survey locations. At each location, an observer walked two 15-m transects along the stream-bed and turned cover objects, 6 cm in the water and on the bank within 2 m of the stream. Individuals &lt; 35mm snout-to-vent length were classed as juveniles, including both first-year and second-year juveniles. The data are counts of adults and juveniles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("duskySalamanders")</code></pre>


<h3>Format</h3>

<p><code>duskySalamanders</code> is four-dimensional (21 x 7 x 2 x 2) array of counts, with dimensions:
</p>

<dl>
<dt>site </dt><dd><p>a numerical site identifier.</p>
</dd>
<dt>year </dt><dd><p>the year of the survey, 2005 to 2012.</p>
</dd>
<dt>age </dt><dd><p>Juveniles or Adults.</p>
</dd>
<dt>survey </dt><dd><p>June or July.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Evan Grant and colleagues.
</p>


<h3>References</h3>

<p>Zipkin, E.F. et al (2014) Modeling structured population dynamics using data from unmarked individuals, <em>Ecology</em>, 95(1) 22-29.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 2.9.2
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(duskySalamanders)
str(duskySalamanders)
</code></pre>

<hr>
<h2 id='e2dist'>
Calculates the pair-wise distances between two sets of points
</h2><span id='topic+e2dist'></span>

<h3>Description</h3>

<p>Calculates the Euclidian distance between each of the points defined by the coordinates in 'x' and each of those in 'y'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e2dist(x, y = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e2dist_+3A_x">x</code></td>
<td>

<p>a 2-column matrix or data frame with the x and y coordinates of a set of points, or a length 2 vector with the coordinates of a single point.
</p>
</td></tr>
<tr><td><code id="e2dist_+3A_y">y</code></td>
<td>

<p>an optional 2-column matrix or data frame, or a length 2 vector, with the x and y coordinates of a second set of points; if NULL, y is taken to be the same as x.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>nrows(x)</code> x <code>nrows(y)</code> matrix with the pair-wise distances.
</p>


<h3>Author(s)</h3>

<p>Andy Royle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pts1 &lt;- expand.grid(x = 1:5, y = 6:8)
pts2 &lt;- cbind(x=runif(5, 1, 5), y=runif(5, 6, 8))
require(graphics)
plot(pts1)
points(pts2, pch=19, col='red')
e2dist(x=pts1, y=pts2)
# with a vector argument:
vec &lt;- colMeans(pts2)
e2dist(vec, pts2)
# with y = NULL:
e2dist(x=pts2)
</code></pre>

<hr>
<h2 id='EurasianLynx'>
Data for Eurasian lynx from Switzerland and Italy (only Alps).
</h2><span id='topic+EurasianLynx'></span>

<h3>Description</h3>

<p>The data are observations of Eurasian lynx (<em>Lynx lynx</em>) confirmed by experts and by the general public (and not confirmed by experts), summarized to a 10 x 10 km grid and for 3 occasions during a 'winter' (Nov-Dec, Jan-Feb, Mar-Apr). The observations are classified as 'certain' or 'uncertain', and only the latter are assumed to be contaminated with false positives (but both are subject to false-negative errors). This data set covers the Alps in Switzerland and Italy from 1994 to 2016.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("EurasianLynx")</code></pre>


<h3>Format</h3>

<p><code>EurasianLynx</code> is a data frame with 43,332 rows corresponding to observations, and 10 columns:
</p>

<dl>
<dt>type </dt><dd><p>factor: 'certain' or 'uncertain'.</p>
</dd>
<dt>site.nr </dt><dd><p>site (10 x 10 km cell) identifier.</p>
</dd>
<dt>y.1, y.2, y.3 </dt><dd><p>detection (1)/non-detection (0) for the three occasions.</p>
</dd>
<dt>Year </dt><dd><p>the year of the observation.</p>
</dd>
<dt>Cntry </dt><dd><p>the country, 'Italy' or 'Switzerland'.</p>
</dd>
<dt>xcoord </dt><dd><p>the x coordinate of the cell, km E of the origin.</p>
</dd>
<dt>ycoord </dt><dd><p>the y coordinate of the cell, km N of the origin.</p>
</dd>
<dt>forest </dt><dd><p>the percentage forest cover in the cell.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The Foundation KORA (SCALP Project) and the Progetto Lince Italia (Anja Molinari-Jobin, Urs Breitenmoser, Fridolin Zimmermann).
</p>


<h3>References</h3>

<p>Molinari-Jobin, A., Kéry, M., Marboutin, E., Molinari, P., Koren, I., Fuxjäger, C., Breitenmoser-Würsten, C., Wölfl, S., Fasel, M., Kos, I., Wölfl, M., &amp; Breitenmoser, U. (2012) Monitoring in the presence of species misidentification: the case of the Eurasian lynx in the Alps. <em>Animal Conservation</em>, 15, 266-273.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 7.3.2 and 9.6.1.3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(EurasianLynx)
lynx &lt;- EurasianLynx # Shorter name
str(lynx)

# Create additional columns needed for the analysis in 'unmarked':
lynx$occ.1 &lt;- 1
lynx$occ.2 &lt;- 2
lynx$occ.3 &lt;- 3
lynx$sYear &lt;- standardize(lynx$Year)
str(lynx)
</code></pre>

<hr>
<h2 id='Finnmark'>
Data from surveys of birds in Finnmark in NE Norway
</h2><span id='topic+Finnmark'></span>

<h3>Description</h3>

<p>A total of 37 plots were placed spanning the existing variation in extent and fragmentation of willow thickets. Each plot was visited 3-5 times in early July each year from 2005 to 2008. Birds observed within 100m during a 15 min period were recorded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Finnmark")</code></pre>


<h3>Format</h3>

<p><code>Finnmark</code> is a list with 4 elements:
</p>

<dl>
<dt><b>species </b></dt><dd><p>a data frame with a row for each species and the following columns:
</p>

<ul>
<li><p> species : the English name.
</p>
</li>
<li><p> latin : the Latin name.
</p>
</li>
<li><p> assemblage : the guild to which each species belongs.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>sites </b></dt><dd><p>a data frame with a row for each plot and the following columns:
</p>

<ul>
<li><p> region : a factor, 3 levels, Ilford, Komag, and Vestre Jakobselv.
</p>
</li>
<li><p> catchment : a factor, 11 levels.
</p>
</li>
<li><p> plot : a factor, the alphanumeric ID of each plot.
</p>
</li>
<li><p> plotnr : the ID number of each plot.
</p>
</li>
<li><p> area : the percentage of a 400 x 400m quadrat centered on the sampling point covered by tall willow thickets.
</p>
</li>
<li><p> edge : the length (m) of the edge of the willow thickets in the quadrat.
</p>
</li>
<li><p> height : the mean height of willows at 4 measuring points.
</p>
</li>
<li><p> density : a measure of thicket density at 4 measuring points.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>counts </b></dt><dd><p>a sites x replicates x years x species array of counts</p>
</dd>
<dt><b>timeOfDay </b></dt><dd><p>a sites x replicates x years array with the time of day that the survey was carried out.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data generously provided by John-André Henden.
</p>


<h3>References</h3>

<p>Henden, J.-A., Yoccoz, N.G., Ims, R.A., Langeland, K. (2013) How Spatial Variation in Areal Extent and Configuration of Labile Vegetation States Affect the Riparian Bird Community in Arctic Tundra. PLoS ONE 8(5): e63312.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Finnmark)
str(Finnmark)

# Create the objects needed for the analysis:
# Extract the numeric covariates and standardise
str(Finnmark$sites)
scov &lt;- scale(Finnmark$sites[, 5:8])
str(scov)

# Convert the 'counts' array to detection/nondetection data:
y &lt;- Finnmark$counts &gt; 0
storage.mode(y) &lt;- "integer"
str(y)

# Get the guild information for each species
guild &lt;- Finnmark$species$assemblage

# Standardise the timeOfDay and replace NAs with 0
tod &lt;- with(Finnmark, (timeOfDay - mean(timeOfDay, na.rm=TRUE))/ sd(timeOfDay, na.rm=TRUE))
tod[is.na(tod)] &lt;- 0
str(tod)

</code></pre>

<hr>
<h2 id='fitstats'>
Functions to return fit statistics
</h2><span id='topic+fitstats'></span><span id='topic+fitstats2'></span>

<h3>Description</h3>

<p><code>fitstats</code> produces sum of squared errors, Chi-squared statistic and Freeman-Tukey statistic used in parboot GOF tests throughout the book, starting with AHM1 - 7.5.4. <code>fitstats2</code> produces the above, plus corresponding statistics based on total detection frequency across replicate surveys; see AHM1 - 7.9.3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitstats(fm)

fitstats2(fm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitstats_+3A_fm">fm</code></td>
<td>

<p>A fitted model object as returned by <span class="pkg">unmarked</span>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>fitstats</code>, a named vector of length 3 with sum of squared errors (<code>SSE</code>), Chi-squared statistic (<code>Chisq</code>) and Freeman-Tukey (<code>freemanTukey</code>).
</p>
<p>For <code>fitstats2</code>, a named vector of length 6 with the same information plus corresponding statistics based on numbers(<code>SSE.n</code>), (<code>Chisq.n</code>) and (<code>freemanTukey.n</code>).
</p>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry &amp; Royle (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 7.5.4 and 7.9.3.
</p>

<hr>
<h2 id='FrenchPeregrines'>
Data for observations of peregrines from the French Jura mountains
</h2><span id='topic+FrenchPeregrines'></span>

<h3>Description</h3>

<p>The data are detection/nondetection data of the Peregrine Falcon (<em>Falco peregrinus</em>) from the wild and wonderful French Jura between 1964 and 2016 for 284 cliff sites (= territories, or sites in the context of a site-occupancy model) where a pair had been detected at least once in this period. A large proportion of sites are visited multiple times per year, but unfortunately only the aggregate results are available in each year, i.e., whether a pair was detected at least once, or never.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("FrenchPeregrines")</code></pre>


<h3>Format</h3>

<p><code>FrenchPeregrines</code> is a data frame with 284 rows and 56 columns:
</p>

<dl>
<dt>site </dt><dd><p>cliff (or site) identifier.</p>
</dd>
<dt>department </dt><dd><p>factor, the administrative area (Ain, Jura or Doubs).</p>
</dd>
<dt>height </dt><dd><p>factor, height of the cliff, low, medium, or tall.</p>
</dd>
<dt>yr1964 to yr2016 </dt><dd><p>detection histories for each year: 1 if a pair of peregrines was detected during at least one survey, 0 if no pair was detected, NA if no survey was carried out in that year.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Groupe Pèlerin Jura (René-Jean Monneret, René Ruffinoni, and colleagues)
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 4.11.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(FrenchPeregrines)
str(FrenchPeregrines)
# Extract the capture history data:
ch &lt;- as.matrix(FrenchPeregrines[, 4:56])
dim(ch)
range(ch, na.rm=TRUE)
</code></pre>

<hr>
<h2 id='getLVcorrMat'>
Compute results of a Joint Species Distribution Model (JSDM)
</h2><span id='topic+getLVcorrMat'></span><span id='topic+getEcorrMat'></span>

<h3>Description</h3>

<p>Compute pairwise residual correlation in occurrence or abundance in a Joint Species Distribution Model (JSDM) with latent variables.
</p>
<p><code>getLVcorrMat</code> computes the correlation matrix in residual occurrence or abundance in an latent-variable multi-species occupancy or N-mixture model which has been fit using MCMC (eg, in JAGS or WinBUGS). See Tobler et al. (2019) and Kéry &amp; Royle (2021) chapter 8.
</p>
<p><code>getEcorrMat</code> computes the correlation matrix for the coefficients of the observed environmental covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLVcorrMat(lv.coef, type=c("occupancy", "Nmix"), stat=mean)

getEcorrMat(beta, stat=mean)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLVcorrMat_+3A_lv.coef">lv.coef</code></td>
<td>

<p>MCMC chains for the coefficients of the latent variables, typically from the <code>sims.list</code> of a model fit; an iterations x species x latent variables array.
</p>
</td></tr>
<tr><td><code id="getLVcorrMat_+3A_beta">beta</code></td>
<td>

<p>MCMC chains for the coefficients of the environment variables (excluding the intercept), typically from the <code>sims.list</code> of a model fit; an iterations x species x environmental variables array.
</p>
</td></tr>
<tr><td><code id="getLVcorrMat_+3A_type">type</code></td>
<td>

<p>Indication of whether the model fit was for occupancy data (with a probit link) or an N-mixture model based on count data.
</p>
</td></tr>
<tr><td><code id="getLVcorrMat_+3A_stat">stat</code></td>
<td>

<p>The function used to summarize the MCMC chains for the correlations; if <code>stat = NULL</code>. the full array with the MCMC chains is returned
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The relevant correlation matrix, species x species; if <code>stat = NULL</code>, an array, iterations x species x species, with the MCMC chains.
</p>


<h3>Author(s)</h3>

<p>Mathias Tobler.
</p>


<h3>References</h3>

<p>Tobler, M. et al. (2019) Joint species distribution models with species correlations and imperfect detection. <em>Ecology</em>, 100(8), e02754.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 8.4.2 and 8.5.4.
</p>

<hr>
<h2 id='graphSSM'>
Plot the results for a Gaussian state-space model
</h2><span id='topic+graphSSM'></span>

<h3>Description</h3>

<p>Plot the observed time-series and the estimated population trajectories for a multivariate Gaussian state-space model (SSM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphSSM(ssm, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graphSSM_+3A_ssm">ssm</code></td>
<td>

<p>An object of class <code>jagsUI</code> with the results of fitting the SSM model.
</p>
</td></tr>
<tr><td><code id="graphSSM_+3A_c">C</code></td>
<td>

<p>The original count data: an individuals x year matrix of counts, no missing values.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No output, the function is called for plotting.
</p>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle, adapted for multivariate SSMs from the SSM graphing function <code>graph.ssm</code> in Chapter 5 in Kéry &amp; Schaub (2012).
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> Section 1.6
</p>
<p>Kéry, M. &amp; Schaub, M.  (2012) <em>Bayesian population analysis using WinBUGS - a hierarchical perspective</em>, Academic Press.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 1.6.
</p>

<hr>
<h2 id='greenWoodpecker'>
Count data from the Swiss Breeding Bird Survey for Green Woodpeckers from 2004 to 2017
</h2><span id='topic+greenWoodpecker'></span>

<h3>Description</h3>

<p>The Swiss breeding bird survey (&quot;Monitoring Häufige Brutvögel&quot; MHB) has monitored the populations of approximately 150 common species since 1999. The MHB sample consists of 267 1-km squares that are laid out as a grid across Switzerland. Fieldwork is conducted by about 200 skilled birdwatchers annually, most of them volunteers. Avian populations are monitored using a simplified territory mapping protocol (also called spot-mapping West of the Atlantic), where each square is surveyed up to three times during the breeding season (only twice above the tree line around 2000 m elevation). Surveys are conducted along a transect that does not change over the years and is 4-6 kms in length on average.
</p>
<p>The data frame <code>greenWoodpecker</code> has count data for Green Woodpeckers <em>Picus viridis</em> from 2004 to 2017. There are some missing values: see Details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("greenWoodpecker")</code></pre>


<h3>Format</h3>

<p><code>greenWoodpecker</code> is a data frame with 267 rows and 146 columns:
</p>

<dl>
<dt>x, y </dt><dd><p>the x and y coordinates of the center of the quadrat; the coordinate reference system intentionally not specified.</p>
</dd>
<dt>nsurveys </dt><dd><p>the number of replicate surveys <em>planned</em> in the quadrat; above the tree-line 2, otherwise 3.</p>
</dd>
<dt>elevation </dt><dd><p>the mean elevation of the quadrat, m.</p>
</dd>
<dt>forest </dt><dd><p>percentage forest cover</p>
</dd>
<dt>route.length </dt><dd><p>the length of the route</p>
</dd>
<dt>X2004.1.count to X2017.3.count </dt><dd><p>number of territories observed for each survey; 2004.1 indicates the first survey in 2004.</p>
</dd>
<dt>X2004.1.date to X2017.3.date </dt><dd><p>Julian date of the survey, 1 = a weekend near 15 April.</p>
</dd>
<dt>X2004.1.time to X2017.3.time </dt><dd><p>time spent in the quadrat during the survey, mins.</p>
</dd>
<dt>X2004.observer to X2017.observer </dt><dd><p>numerical code identifying the observer.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Missing values in the <code>count</code> and <code>date</code> columns indicate that the corresponding survey was not carried out.
</p>
<p>On 26 occasions when surveys were carried out, the time taken was not recorded, resulting in additional NAs in the <code>time</code> columns.
</p>


<h3>Source</h3>

<p>Swiss Ornithological Institute
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A.  (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 2.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(greenWoodpecker)
str(greenWoodpecker)

</code></pre>

<hr>
<h2 id='HubbardBrook'>
Warbler point count data from the Hubbard Brook Experimental Forest
</h2><span id='topic+HubbardBrook'></span>

<h3>Description</h3>

<p>Three replicated point counts of 10 min each, out to a maximum distance of 100 m, were conducted in each spring between 1999 and 2018 at a total of 373 locations in the Hubbard Brook Experimental Forest in New Hampshire. This data set contains the data for the following 13 species:
</p>

<ul>
<li><p> AMRE - American Redstart
</p>
</li>
<li><p> BAWW - Black-and-white Warbler
</p>
</li>
<li><p> BHVI - Blue headed Vireo
</p>
</li>
<li><p> BLBW - Blackburnian Warbler
</p>
</li>
<li><p> BLPW - Blackpoll Warbler
</p>
</li>
<li><p> BTBW - Black-throated Blue Warbler
</p>
</li>
<li><p> BTNW - Black-throated Green Warbler
</p>
</li>
<li><p> CAWA - Canada Warbler
</p>
</li>
<li><p> MAWA - Magnolia Warbler
</p>
</li>
<li><p> MYWA - Myrtle Warbler
</p>
</li>
<li><p> NAWA - Nashville Warbler
</p>
</li>
<li><p> OVEN - Ovenbird
</p>
</li>
<li><p> REVI - Red-eyed Vireo
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data("HubbardBrook")</code></pre>


<h3>Format</h3>

<p><code>HubbardBrook</code> is a list with 4 elements:
</p>

<dl>
<dt><b>counts </b></dt><dd><p>a sites x replicates x years x species array of counts, the number of unique individuals detected within 50m of the point count location.</p>
</dd>
<dt><b>sitecov </b></dt><dd><p>a data frame with rows for 373 sites and the following columns:
</p>

<ul>
<li><p> PlotID : a numeric site identifier.
</p>
</li>
<li><p> Longitude : the longitude of the point (WGS84); 2 sites have missing data.
</p>
</li>
<li><p> Latitude : the latitude of the point (WGS84); 2 sites have missing data.
</p>
</li>
<li><p> Elev : the elevation of the point, m.
</p>
</li>
<li><p> Aspect : aspect of the sample location (degrees).
</p>
</li>
<li><p> Slope : slope of the sample location.
</p>
</li>
<li><p> Forest : general forest cover type of sample location.
</p>
</li></ul>
</dd>
<dt><b>dates </b></dt><dd><p>a sites x replicates x years array of ordinal day of count (1 Jan = 1); NA entries occur when surveys were not carried out.</p>
</dd>
<dt><b>times </b></dt><dd><p>a sites x replicates x years array with the start time of the survey, hours after midnight.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Rodenhouse N.L. &amp; Sillett, T.S. (2019) Valleywide Bird Survey, Hubbard Brook Experimental Forest, 1999-2016 (ongoing). Environmental Data Initiative. &lt;https://doi.org/10.6073/pasta/faca2b2cf2db9d415c39b695cc7fc217&gt;. Dataset accessed 2020-01-07.</p>


<h3>References</h3>

<p>Betts, M.G., Rodenhouse, N.L., Sillett, T.S., Doran, P.J. &amp; Holmes, R.T. (2008). Dynamic occupancy models reveal within-breeding season movement up a habitat quality gradient by a migratory songbird. <em>Ecography</em> 31:592–600.
</p>
<p>Goetz, S.J., Steinberg, D., Betts, M.G., Holmes, R.T., Doran, P.J., Dubayah, R., &amp; Hofton, M. (2010). Lidar remote sensing variables predict breeding habitat of a Neotropical migrant bird. <em>Ecology</em> 91:1569–1576.
</p>
<p>Van Tatenhove, A., Filiberti, E., Sillett, T.S., Rodenhouse, N.L. &amp; Hallworth, M. T. (2019). Climate-related distribution shifts of migratory songbirds and sciurids in the White Mountain National Forest. <em>Forests</em> 10:84.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 8.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HubbardBrook)
str(HubbardBrook)
</code></pre>

<hr>
<h2 id='image_scale'>
Helper function to draw scale for image
</h2><span id='topic+image_scale'></span><span id='topic+image.scale'></span>

<h3>Description</h3>

<p>Plots a scale in the right margin of a plot, typically an image plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>image_scale(z, col, x, y = NULL, size = NULL, digits = 2, labels = c("breaks", "ranges"),
      cex.legend=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="image_scale_+3A_z">z</code></td>
<td>

<p>a vector of at least 2 numbers which define the range of values for which colors should be plotted; this should be the same as the value of <code>zlim</code> passed to <code>image</code> or, if that was not used, the values passed as <code>z</code>.
</p>
</td></tr>
<tr><td><code id="image_scale_+3A_col">col</code></td>
<td>

<p>a vector of colors, use the same as in the image
</p>
</td></tr>
<tr><td><code id="image_scale_+3A_x">x</code></td>
<td>

<p>the x coordinate of the left edge of the scale bar; or a list with components x and y, each of length 2, giving the x and y coordinates of the edges of the scale bar.
</p>
</td></tr>
<tr><td><code id="image_scale_+3A_y">y</code></td>
<td>

<p>the y coordinate of the bottom edge of the scale bar, ignored if <code>x</code> is a list
</p>
</td></tr>
<tr><td><code id="image_scale_+3A_size">size</code></td>
<td>

<p>the size of the boxes making up the scale bar, a length 2 vector with the width and height, or a scalar, in which case width = height; ignored if <code>x</code> is a list
</p>
</td></tr>
<tr><td><code id="image_scale_+3A_digits">digits</code></td>
<td>

<p>the number of decimal places to display
</p>
</td></tr>
<tr><td><code id="image_scale_+3A_labels">labels</code></td>
<td>

<p>if &quot;breaks&quot;, the dividing lines in the scale bar are labeled, if &quot;ranges&quot;, each box is labeled with its range; may be abbreviated
</p>
</td></tr>
<tr><td><code id="image_scale_+3A_cex.legend">cex.legend</code></td>
<td>

<p>the magnification to be used for axis annotation
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None, used for its plotting side effect.
</p>


<h3>Note</h3>

<p>This function appears in the book text as <code>image.scale</code>; renamed here to avoid confusion with generic <code>image</code> functions.
</p>


<h3>Author(s)</h3>

<p>Andy Royle.
</p>


<h3>References</h3>

<p>Royle, J.A., Chandler, R.B., Sollmann, R., &amp; Gardner, B. (2014) <em>Spatial capture-recapture</em>, Elsevier.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># uses the built-in volcano data set
require(grDevices) # for colours
require(graphics)
par(mar = c(3,3,3,6))  # make the right margin wide enough
image(t(volcano)[ncol(volcano):1,], col=terrain.colors(12))
image_scale(volcano, col=terrain.colors(12))
# Try placing the scale bar on the left
par(mar = c(3,8,3,1))  # make the left margin wide enough
image(t(volcano)[ncol(volcano):1,], col=terrain.colors(12))
image_scale(volcano, col=terrain.colors(12), x= -0.28, digits=0, cex.legend=1.2)
# Trial and error needed to get the x value right.
</code></pre>

<hr>
<h2 id='issj.sim'>
Simulate open distance sampling data for the Island Scrub Jays
</h2><span id='topic+issj.sim'></span>

<h3>Description</h3>

<p>Function to simulate open distance sampling data for the Island Scrub Jays, based on Sollmann et al (2015).
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>issj.sim(B, db, lam, sigma, phi, gamma, npoints, nyrs, nbsize = -1.02)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="issj.sim_+3A_b">B</code></td>
<td>

<p>Radius of the circle sampled; a site is a circle of radius B around a point.
</p>
</td></tr>
<tr><td><code id="issj.sim_+3A_db">db</code></td>
<td>

<p>Distance categories; a vector of cut points from 0 to B inclusive.
</p>
</td></tr>
<tr><td><code id="issj.sim_+3A_lam">lam</code></td>
<td>

<p>Expected abundance per site, a vector of length <code>nsites</code> or an <code>nsites x 1</code> matrix.
</p>
</td></tr>
<tr><td><code id="issj.sim_+3A_sigma">sigma</code></td>
<td>

<p>Scale parameter of the half-normal detection function at each site,  a vector of length <code>nsites</code> or an <code>nsites x 1</code> matrix.
</p>
</td></tr>
<tr><td><code id="issj.sim_+3A_phi">phi</code></td>
<td>

<p>Survival probability
</p>
</td></tr>
<tr><td><code id="issj.sim_+3A_gamma">gamma</code></td>
<td>

<p>Recruitment rate
</p>
</td></tr>
<tr><td><code id="issj.sim_+3A_npoints">npoints</code></td>
<td>

<p>Number of sites where point counts are conducted.
</p>
</td></tr>
<tr><td><code id="issj.sim_+3A_nyrs">nyrs</code></td>
<td>

<p>Number of years
</p>
</td></tr>
<tr><td><code id="issj.sim_+3A_nbsize">nbsize</code></td>
<td>

<p>Size parameter for the negative binomial distribution used to generate individual counts per site for year 1.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>NcList</code></td>
<td>
<p>A list with one element per year, with distances of all animals from the point.</p>
</td></tr>
<tr><td><code>detList</code></td>
<td>
<p>A list with one element per year, a <code>npoints x nbands</code> matrix with the number of animals detected in each distance category for each point.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>The (true) number of animals at each point for each year, a <code>nsites x nyears</code> matrix.</p>
</td></tr>
<tr><td><code>cell</code></td>
<td>
<p>The site IDs where point counts are conducted.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p><code>npoints x nyears</code> matrix of total detections</p>
</td></tr>
<tr><td><code>dclass</code></td>
<td>
<p>a vector with the distance class for each animal detected</p>
</td></tr>
<tr><td><code>site</code></td>
<td>
<p>a corresponding vector with the site for each animal detected</p>
</td></tr>
<tr><td><code>nsite</code></td>
<td>
<p>the number of sites in the study area</p>
</td></tr>
<tr><td><code>lam</code>, <code>phi</code>, <code>gamma</code>, <code>sigma</code></td>
<td>
<p>the values of the corresponding arguments</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle, based on Sollmann et al (2015)
</p>


<h3>References</h3>

<p>Sollmann, R., Gardner, B., Chandler, R.B., Royle, J.A., Sillett, T.S. (2015) An open population hierarchical distance sampling model. <em>Ecology</em> 96, 325-331.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 9.7.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A toy example with just 20 sites
set.seed(2015)
tmp &lt;- issj.sim(B = 300,
    db = c(0,50, 100, 150, 200, 250, 300),
    lam = c(3.01, 7.42, 20.51, 1.60, 0.42, 3.42, 8.24, 0.66, 0.32, 0.39, 0.46, 0.52,
      0.63, 0.36, 4.93, 0.47, 2.07, 0.42, 0.48, 0.47),
    sigma = c(110, 91, 70, 114, 135, 101, 88, 130, 133, 134, 134, 135, 131, 135, 100,
      135, 110, 135, 134, 135),
    phi = 0.6, gamma = 0.35,
    npoints = 15, nyrs = 4)
str(tmp)
# Compare the number detected with the true numbers present
with(tmp, cbind(y, N[cell, ]))
</code></pre>

<hr>
<h2 id='map.Nmix.resi'>
Mapping of residuals
</h2><span id='topic+map.Nmix.resi'></span>

<h3>Description</h3>

<p>Produces a map of the mean residuals from an N-mixture model fit by function <code>pcount</code> in <span class="pkg">unmarked</span>. Used in AHM1 - 6.9.3 to produce maps of Switzerland with the residuals for each site.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.Nmix.resi(fm, x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map.Nmix.resi_+3A_fm">fm</code></td>
<td>

<p>the fitted model object
</p>
</td></tr>
<tr><td><code id="map.Nmix.resi_+3A_x">x</code></td>
<td>

<p>x coordinates of each site
</p>
</td></tr>
<tr><td><code id="map.Nmix.resi_+3A_y">y</code></td>
<td>

<p>y coordinates of each site
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Used for its plotting side effects.
</p>


<h3>Note</h3>

<p>In previous versions, the defaults were <code>x = tits$coordx</code> and <code>y = tits$coordy</code>, but those defaults only worked if the data object <code>tits</code> was in the workspace. To run the code on page 263 of AHM1, you now need to specify the coordinates, eg, <code>map.Nmix.resi(fm5, x = tits$coordx, y = tits$coordy)</code>.
</p>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 6.9.3.
</p>

<hr>
<h2 id='MesoCarnivores'>
Camera trap data for Bobcat, Coyote and Red Fox
</h2><span id='topic+MesoCarnivores'></span>

<h3>Description</h3>

<p>Camera trap (detection/nondetection) data for Bobcat (<em>Lynx rufus</em>), Coyote (<em>Canis latrans</em>) and Red Fox (<em>Vulpes vulpes</em>) from six Mid-Atlantic states in the eastern United States analyzed by Rota et al (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MesoCarnivores")</code></pre>


<h3>Format</h3>

<p><code>MesoCarnivores</code> is a list with 4 elements:
</p>

<dl>
<dt><b>bobcat, coyote, redfox </b></dt><dd><p>1/0 detection data for the respective species: matrices with rows for 1437 sites x 3 replicates, where each replicate corresponds to 1 week of observations.</p>
</dd>
<dt><b>sitecov </b></dt><dd><p>a data frame with rows for 1437 sites and the following columns:
</p>

<ul>
<li><p> Dist_5km : the proportion of disturbed land in the surrounding 5km.
</p>
</li>
<li><p> HDens_5km : housing density in the surrounding 5km.
</p>
</li>
<li><p> Latitude : the latitude of the point, decimal degrees divided by 100.
</p>
</li>
<li><p> Longitude : the longitude, decimal degrees divided by 100.
</p>
</li>
<li><p> People_site : number of people photographed at a site divided by 1000.
</p>
</li>
<li><p> Trail : 1 if the camera was located on a trail, 0 otherwise.
</p>
</li></ul>
</dd>
</dl>



<h3>Source</h3>

<p>Data courtesy of eMammal, Roland Kays, Arielle Parsons, and their group at the North Carolina Museum of Natural Sciences and North Carolina State University.
</p>


<h3>References</h3>

<p>Rota, C.T., Ferreira, M.A.R., Kays, R.W., Forrester, T.D., Kalies, E.L., McShea, W.J., Parsons, A.W., &amp; Millspaugh, J.J. (2016) A multispecies occupancy model for two or more interacting species. <em>Methods in Ecology and Evolution</em>, 7, 1164-1173.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 8.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MesoCarnivores)
str(MesoCarnivores)
</code></pre>

<hr>
<h2 id='MHB2014'>
Data from the Swiss Breeding Bird Survey MHB 2014
</h2><span id='topic+MHB2014'></span>

<h3>Description</h3>

<p>The Swiss breeding bird survey (&quot;Monitoring Häufige Brutvögel&quot; MHB) has monitored the populations of approximately 150 common species since 1999. The MHB sample consists of 267 1-km squares that are laid out as a grid across Switzerland. Fieldwork is conducted by about 200 skilled birdwatchers annually, most of them volunteers. Avian populations are monitored using a simplified territory mapping protocol (also called spot-mapping West of the Atlantic), where each square is surveyed up to three times during the breeding season (only twice above the tree line around 2000 m elevation). Surveys are conducted along a transect that does not change over the years and is 4-6 kms in length on average.
</p>
<p>The list <code>MHB2014</code> has the full survey data for the year 2014.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MHB2014")</code></pre>


<h3>Format</h3>

<p><code>MHB2014</code> is a list with 5 elements:
</p>

<dl>
<dt><b>species </b></dt><dd><p>a data frame with rows for 158 species, including 15 species not recorded in the year 2014, and the following columns:
</p>

<ul>
<li><p> specid : a numeric species ID based on phylogeny.
</p>
</li>
<li><p> latabb : a 6-letter abbreviation of the Latin name.
</p>
</li>
<li><p> engname : the English name.
</p>
</li>
<li><p> latname : the Latin name.
</p>
</li>
<li><p> body.length : body length in cm.
</p>
</li>
<li><p> body.mass : body mass in g.
</p>
</li>
<li><p> wing.span : wing span in cm.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>sites </b></dt><dd><p>a data frame with rows for 267 1x1 km quadrat, including 1 quadrat not surveyed in 2014, and the following columns:
</p>

<ul>
<li><p> siteID : an alphanumeric site identifier.
</p>
</li>
<li><p> coordx : the x coordinate of the center of the quadrat; the coordinate reference system is intentionally not specified.
</p>
</li>
<li><p> coordy : the y coordinate of the center of the quadrat.
</p>
</li>
<li><p> elev : the mean elevation of the quadrat in m.
</p>
</li>
<li><p> rlength : the length of the route walked in the quadrat in km.
</p>
</li>
<li><p> nsurvey : the number of replicate surveys <em>planned</em> in the quadrat; above the tree-line 2, otherwise 3.
</p>
</li>
<li><p> forest : percentage forest cover.
</p>
</li>
<li><p> obs14 : identifying number of the observer.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>counts </b></dt><dd><p>a sites x replicates x species array of counts</p>
</dd>
<dt><b>date </b></dt><dd><p>a sites x replicates matrix with Julian dates of the surveys, 1 April = 1</p>
</dd>
<dt><b>dur </b></dt><dd><p>a sites x replicates matrix with the duration of each survey, mins</p>
</dd>
</dl>



<h3>Note</h3>

<p>Section 11.3 of the AHM1 book has code to read in data from a CSV file, &quot;MHB_2014.csv&quot;. This is a huge file, because the site data are repeated for all 158 species and the species data are repeated for all 267 sites. The <code>MHB2014</code> list has all the same data, but in a more compact format. See Examples for ways to generate the objects used in the book from the list.
</p>


<h3>Source</h3>

<p>Swiss Ornithological Institute
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 11.3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MHB2014)
str(MHB2014)

# Create the objects at foot of p.644:
( nsite &lt;- nrow(MHB2014$sites) )    # number of sites in Swiss MHB
nrep &lt;- 3                           # maximum number of replicate surveys per season
( nspec &lt;- nrow(MHB2014$species) )  # 158 species occur in the 2014 data
# Check the dimensions of the 'count' array:
dim(MHB2014$count) == c(nsite, nrep, nspec)

# Create the detection/nondetection matrix 'y':
y &lt;- MHB2014$count &gt; 0        # this is logical, convert to integer
storage.mode(y) &lt;- "integer"  # don't use 'as.integer', that strips out dimensions and names
str(y)

# Pull out and check the data for common chaffinch, p.645:
head(tmp &lt;- y[, , "Common Chaffinch"])
tail(tmp)

</code></pre>

<hr>
<h2 id='modSelFP'>
Model selection results from a list of 'unmarkedFitOccuFP' models
</h2><span id='topic+modSelFP'></span>

<h3>Description</h3>

<p>The <span class="pkg">unmarked</span> functions <code><a href="unmarked.html#topic+fitList">fitList</a></code> and <code><a href="unmarked.html#topic+modSel">modSel</a></code> do now work for 'unmarkedFitOccuFP' models, so this stop-gap function is deprecated. Use <code>modSel(fitList(fits=mod.list))</code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modSelFP(mod.list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modSelFP_+3A_mod.list">mod.list</code></td>
<td>

<p>A list of fitted model objects of class 'unmarkedFitOccuFP' as returned by <span class="pkg">unmarked</span>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with a row for each model in the input list and columns for number of parameters, AIC, deltaAIC, AIC weight and cumulative AIC weight.
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 7.2.2.
</p>

<hr>
<h2 id='piFuns'>
Compute multinomial cell probabilities
</h2><span id='topic+piFuns'></span><span id='topic+instRemPiFun'></span><span id='topic+crPiFun'></span><span id='topic+crPiFun.Mb'></span><span id='topic+MhPiFun'></span>

<h3>Description</h3>

<p>These functions are used internally in the multinomial-Poisson models <code>multinomPois</code> and <code>gmultmix</code> in package <span class="pkg">unmarked</span> to calculate the multinomial cell probabilities from the &quot;raw&quot; detection probabilities. See <a href="unmarked.html#topic+piFuns">piFuns</a>. These functions are customized for the examples in chapter 7 of AHM1 and only allow for 3 capture occasions.
</p>
<p>See <a href="unmarked.html#topic+makePiFuns">makePiFuns</a> for functions to construct piFuns with more occasions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>instRemPiFun(p)

crPiFun(p)

crPiFun.Mb(p)

MhPiFun(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="piFuns_+3A_p">p</code></td>
<td>

<p>a numeric matrix with rows for each site and 3 columns, see Details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>instRemPiFun</code> defines the relationship between the multinomial cell probabilities and the underlying detection probability parameters in a removal design with 3 sampling periods of unequal length, specifically 2, 3 and 5 minutes. The columns of <code>p</code> give the detection probabilities per unit time (ie, per minute) for each site and sampling period. See AHM1 Section 7.7. This is the same as the function defined in the Examples section of <a href="unmarked.html#topic+piFuns">piFuns</a> in <span class="pkg">unmarked</span>.
</p>
<p><code>crPiFun</code> defines a pi function for capture-recapture design with 3 capture occasions. The columns of <code>p</code> give the detection probabilities for the three occasions. See AHM1 Section 7.8.5. <b>NOTE</b> that this is not the same as the custom <code>crPiFun</code> defined in Section 7.9.1.
</p>
<p><code>crPiFun.Mb</code> defines a pi function for capture-recapture design with 3 capture occasions with a behavioral response. Detection probabilities do not vary with time. Column #1 of <code>p</code> gives the probability of detection for animals not previously detected; column #3 gives detection probability after the first detection; column #2 is ignored. See AHM1 Section 7.8.2.
</p>
<p><code>MhPiFun</code> defines a pi function for a model with individual detection heterogeneity, modeled as a random effect with a logit-normal distribution. Column #1 of <code>p</code> gives the mean probability of detection; <code>p[1, 2]</code> is a value in [0, 1] which controls the scale parameter for the normal distribution; other entries are ignored. See Section 7.8.3.
</p>


<h3>Value</h3>

<p>A matrix with a row for each site corresponding to the rows of <code>p</code> and...
</p>
<p>...for <code>instRemPiFun</code>, a column for each detection occasion with the multinomial probability.
</p>
<p>...for other functions, a column for each detection history; for 3 detection occasions these are 001, 010, 011, 100, 101, 110, 111.
</p>


<h3>Author(s)</h3>

<p>Richard Chandler, Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 7.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Capture probs for 5 sites, with 3 survey periods
( p &lt;- matrix(0.4, nrow=5, ncol=3) )
# Removal model
instRemPiFun(p)
# The corresponding obsToY matrix:
matrix(1, 2, 3)

# Capture-recapture model
crPiFun(p)
# The corresponding obsToY matrix:
matrix(1, 3, 7)

# Capture-recapture model with behavioural response
( pMb &lt;- cbind(rep(0.7, 5), NA, 0.3) )
crPiFun.Mb(pMb)
# The corresponding obsToY matrix:
matrix(1, 3, 7)

# Capture-recapture model with heterogeneity
pMh &lt;- cbind(rep(0.4, 5), NA, NA)
pMh[1, 2] &lt;- 0.3
pMh
MhPiFun(pMh)
# The corresponding obsToY matrix:
matrix(1, 3, 7)
</code></pre>

<hr>
<h2 id='playRN'>
Function to play Royle-Nichols (RN) model
</h2><span id='topic+playRN'></span>

<h3>Description</h3>

<p>Function generates replicated count data under the binomial N-mixture model of Royle (2004), then 'degrades' the counts to detection/nondetection and fits the Royle-Nichols (RN) model (Royle &amp; Nichols 2003) using <span class="pkg">unmarked</span> and estimates site-specific abundance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>playRN(M = 267, J = 3, mean.abundance = 1, mean.detection = 0.3,
    show.plots = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="playRN_+3A_m">M</code></td>
<td>

<p>The number of sites.
</p>
</td></tr>
<tr><td><code id="playRN_+3A_j">J</code></td>
<td>

<p>The number of visits to each site.
</p>
</td></tr>
<tr><td><code id="playRN_+3A_mean.abundance">mean.abundance</code></td>
<td>

<p>Expected abundance at each site.
</p>
</td></tr>
<tr><td><code id="playRN_+3A_mean.detection">mean.detection</code></td>
<td>

<p>Expected detection at each survey at each site.
</p>
</td></tr>
<tr><td><code id="playRN_+3A_show.plots">show.plots</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
<tr><td><code id="playRN_+3A_verbose">verbose</code></td>
<td>

<p>if FALSE, output to the console will be suppressed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>nsites</code></td>
<td>
<p>The number of sites, equal to <code>M</code> in the input</p>
</td></tr>
<tr><td><code>nvisits</code></td>
<td>
<p>The number of visits, equal to <code>J</code> in the input</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A named vector of coefficients for the linear models for expected number and detection probability</p>
</td></tr>
<tr><td><code>slope</code></td>
<td>
<p>Slope of the regression of the estimated number on the true number; 1 if the model is perfect</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Royle, J.A. &amp; Nichols, J.D. (2003) Estimating abundance from repeated presence-absence data or point counts, <em>Ecology</em>, 84, 777-790.
</p>
<p>Royle, J.A. (2004) N-mixture models for estimating population size from spatially replicated counts, <em>Biometrics</em>, 60, 108-115.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 6.13.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run a simulation with the default arguments and look at the results:
playRN()


# Execute the function using various settings
playRN(M = 100, J = 3, mean.abundance = 0.1)  # Increasing abundance
playRN(M = 100, J = 3, mean.abundance = 1)
playRN(M = 100, J = 3, mean.abundance = 5)
playRN(M = 100, J = 3, mean.detection = 0.3)  # Increasing detection
playRN(M = 100, J = 3, mean.detection = 0.5)
playRN(M = 100, J = 3, mean.detection = 0.7)
playRN(M = 100, J = 20)                       # More visits
playRN(M = 1000, J = 3)                       # More sites

</code></pre>

<hr>
<h2 id='plot_Nmix_resi'>
Produce some residual plots
</h2><span id='topic+plot_Nmix_resi'></span><span id='topic+plot.Nmix.resi'></span>

<h3>Description</h3>

<p>Function does diagnostic plots for one binomial N-mixture model fitted with all three mixture distributions currently available in package <span class="pkg">unmarked</span>: Poisson, negative binomial and zero-inflated Poisson. For each, fitted values vs. observed data and residuals vs. fitted values are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_Nmix_resi(fmP, fmNB, fmZIP)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_Nmix_resi_+3A_fmp">fmP</code></td>
<td>

<p>Fitted model object for Poisson distribution.
</p>
</td></tr>
<tr><td><code id="plot_Nmix_resi_+3A_fmnb">fmNB</code></td>
<td>

<p>Fitted model object for negative binomial distribution.
</p>
</td></tr>
<tr><td><code id="plot_Nmix_resi_+3A_fmzip">fmZIP</code></td>
<td>

<p>Fitted model object for zero-inflated Poisson distribution.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None, used for its plotting effect.
</p>


<h3>Note</h3>

<p>This function appears in the text as <code>plot.Nmix.resi</code>; renamed here to avoid confusion with generic <code>plot</code> functions.
</p>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 6.9.3.
</p>

<hr>
<h2 id='ppc.plot'>
Plot results from posterior predictive check
</h2><span id='topic+ppc.plot'></span>

<h3>Description</h3>

<p>Function plots results from posterior predictive check in AHM1 section 6.8 for a fitted model object with JAGS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppc.plot(fm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppc.plot_+3A_fm">fm</code></td>
<td>

<p>The fitted model object
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None, used for its plotting side effect.
</p>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 6.8.
</p>

<hr>
<h2 id='sim.fn'>
Simulate a Poisson point process
</h2><span id='topic+sim.fn'></span>

<h3>Description</h3>

<p>Simulates animal or plant locations in space according to a homogenous Poisson process. This process is characterized by the intensity, which is the average number of points per (very small)unit area. The resulting point pattern is then discretized to obtain abundance data and  presence/absence (or occurrence) data. The discretization of space is achieved by choosing the cell size. It is used in AHM1 Section 1.1 to help to understand the relationship between point patterns, abundance data and occurrence data (also called presence/absence or distribution data). For a similar and somewhat more sexy version of this function, see <code><a href="#topic+simPPe">simPPe</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.fn(quad.size = 10, cell.size = 1, intensity = 1, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.fn_+3A_quad.size">quad.size</code></td>
<td>

<p>The length of each side of the quadrat (in arbitrary units)
</p>
</td></tr>
<tr><td><code id="sim.fn_+3A_cell.size">cell.size</code></td>
<td>

<p>The length of each side of the cells into which the quadrat is divided. The ratio of quad.size to cell.size must be an integer.
</p>
</td></tr>
<tr><td><code id="sim.fn_+3A_intensity">intensity</code></td>
<td>

<p>The average number of points (animals or plants) per unit area.
</p>
</td></tr>
<tr><td><code id="sim.fn_+3A_show.plot">show.plot</code></td>
<td>

<p>If TRUE, the results are plotted. Set to FALSE when running simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments and the following additional elements:
</p>
<table>
<tr><td><code>exp.N</code></td>
<td>
<p>Expected population size in quadrat</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>
<p>boundaries of grid cells</p>
</td></tr>
<tr><td><code>n.cell</code></td>
<td>
<p>Number of cells in the quadrat</p>
</td></tr>
<tr><td><code>mid.pt</code></td>
<td>
<p>Cell mid-points</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p> Realized population size in quadrat</p>
</td></tr>
<tr><td><code>u1</code></td>
<td>
<p> x coordinate of each individual</p>
</td></tr>
<tr><td><code>u2</code></td>
<td>
<p> y coordinate of each individual</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>The number of individuals in each cell (a vector of length n.cell)</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Presence/absence (1/0) in each cell (a vector of length n.cell)</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>Proportion of cells occupied, ie, the species is present.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry and Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 1.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a simulated data set with default arguments and look at the structure:
tmp &lt;- sim.fn()
str(tmp)

# Effect of grain size of study on abundance and occupancy (intensity constant)
tmp &lt;- sim.fn(quad.size = 10, cell.size = 1, intensity = 0.5)
tmp &lt;- sim.fn(quad.size = 10, cell.size = 2, intensity = 0.5)
tmp &lt;- sim.fn(quad.size = 10, cell.size = 5, intensity = 0.5)
tmp &lt;- sim.fn(quad.size = 10, cell.size = 10, intensity = 0.5)

# Effect of intensity of point pattern (intensity) on abundance and occupancy
tmp &lt;- sim.fn(intensity = 0.1) # choose default quad.size = 10, cell.size = 1
tmp &lt;- sim.fn(intensity = 1)
tmp &lt;- sim.fn(intensity = 5)
tmp &lt;- sim.fn(intensity = 10)
</code></pre>

<hr>
<h2 id='sim.ldata'>
Simulation of distance sampling data.
</h2><span id='topic+sim.ldata'></span>

<h3>Description</h3>

<p>Simulates non-hierarchical line transect data under conventional distance sampling (CDS). It subjects N individuals to sampling, and then retains the value of distance from transect only for individuals that are captured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.ldata(N = 200, sigma = 30, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.ldata_+3A_n">N</code></td>
<td>

<p>number of individuals along transect with distance Uniform(-100, 100)
</p>
</td></tr>
<tr><td><code id="sim.ldata_+3A_sigma">sigma</code></td>
<td>

<p>scale parameter of half-normal detection function
</p>
</td></tr>
<tr><td><code id="sim.ldata_+3A_show.plot">show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>the number of individuals along the transect</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>scale parameter of half-normal detection function</p>
</td></tr>
<tr><td><code>xall</code></td>
<td>
<p>distance from the transect line for all N individuals</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>absolute distance from the transect line for those individuals detected</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 8.2.3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a data set with the default arguments and look at the structure of the output:
tmp &lt;- sim.ldata()
str(tmp)
</code></pre>

<hr>
<h2 id='sim.pdata'>
Simulate non-hierarchical point transect (= point count) data
</h2><span id='topic+sim.pdata'></span>

<h3>Description</h3>

<p>Function simulates coordinates of individuals on a square with a count location at the center point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.pdata(N = 1000, sigma = 1, B = 3, keep.all = FALSE, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.pdata_+3A_n">N</code></td>
<td>

<p>total population size in the square
</p>
</td></tr>
<tr><td><code id="sim.pdata_+3A_sigma">sigma</code></td>
<td>

<p>scale of half-normal detection function
</p>
</td></tr>
<tr><td><code id="sim.pdata_+3A_b">B</code></td>
<td>

<p>circle radius; the data are simulated over a square of side 2 * B, but individuals outside the circle of radius B are not detected.
</p>
</td></tr>
<tr><td><code id="sim.pdata_+3A_keep.all">keep.all</code></td>
<td>

<p>if TRUE, the data for all individuals are returned; if FALSE, only for individuals detected.
</p>
</td></tr>
<tr><td><code id="sim.pdata_+3A_show.plot">show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>total population size in the square</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>scale of half-normal detection function</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>circle radius</p>
</td></tr>
<tr><td><code>u1</code>, <code>u2</code></td>
<td>
<p>the x and y coordinates of each of the individuals</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>the distance of each individual from the center of the circle</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>a 0/1 indicator showing whether each individual is detected or not, a vector of length N</p>
</td></tr>
<tr><td><code>N.real</code></td>
<td>
<p>the realized number of individuals within the circle of radius B</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 8.2.5.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a data set with the default arguments and look at the structure of the output:
tmp &lt;- sim.pdata()
str(tmp)
</code></pre>

<hr>
<h2 id='sim.spatialDS'>
Simulates data for a basic spatial distance sampling model
</h2><span id='topic+sim.spatialDS'></span>

<h3>Description</h3>

<p>Generates data with the following steps:
</p>
<p>1. Simulate a spatially correlated habitat covariate (x) over a grid of pixels covering a square.
</p>
<p>2. Distribute the population of N individuals over the square with probability of location in a pixel related to the covariate.
</p>
<p>3. Decide which individuals are detected using a distance sampling model with an observer at the center of the square, with either a half normal or a logit detection function. (Note that all the individuals in the square can be detected.)
</p>
<p>4. If <code>keep.all = FALSE</code>, return the locations of only the individuals detected.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.spatialDS(N = 1000, beta = 1, sigma = 1, keep.all = FALSE, B = 3,
  model=c("logit", "halfnorm"), lambda = B/3, useHabitat, show.plot=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.spatialDS_+3A_n">N</code></td>
<td>

<p>total population size in the square
</p>
</td></tr>
<tr><td><code id="sim.spatialDS_+3A_beta">beta</code></td>
<td>

<p>coefficient for the effect of spatial covariate x on the distribution of individuals
</p>
</td></tr>
<tr><td><code id="sim.spatialDS_+3A_sigma">sigma</code></td>
<td>

<p>scale parameter of detection function
</p>
</td></tr>
<tr><td><code id="sim.spatialDS_+3A_keep.all">keep.all</code></td>
<td>

<p>if TRUE, the data for all individuals are returned; if FALSE, only for individuals detected.
</p>
</td></tr>
<tr><td><code id="sim.spatialDS_+3A_b">B</code></td>
<td>

<p>distance from the observer to the side of the square. This is usually set so that the probability of detection of individuals outside the square is negligable, eg, <code>B = 3*sigma</code>.
</p>
</td></tr>
<tr><td><code id="sim.spatialDS_+3A_model">model</code></td>
<td>

<p>The detection function used, can be &quot;logit&quot; or &quot;halfnorm&quot;: see Details.
</p>
</td></tr>
<tr><td><code id="sim.spatialDS_+3A_lambda">lambda</code></td>
<td>

<p>The scale parameter for the spatially autocorrelated Habitat covariate.
</p>
</td></tr>
<tr><td><code id="sim.spatialDS_+3A_usehabitat">useHabitat</code></td>
<td>

<p>If the output from a previous simulation is provided, the same Habitat covariate will be used (and <code>lambda</code> will be ignored).
</p>
</td></tr>
<tr><td><code id="sim.spatialDS_+3A_show.plot">show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &quot;logit&quot; detection function is <code>2*plogis(-d^2/(2*sigma^2))</code>, which corresponds to the detection model implemented in <code>unmarked::pcount.spHDS</code>.
</p>


<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>u1</code></td>
<td>
<p>x coordinate of each animal</p>
</td></tr>
<tr><td><code>u2</code></td>
<td>
<p>y coordinate of each animal</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>distance of each animal from the center of the circle</p>
</td></tr>
<tr><td><code>pixel.id</code></td>
<td>
<p>the pixel in which each animal is located, the row number in <code>grid</code></p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>indicator of detection of each animal, a vector of length N</p>
</td></tr>
<tr><td><code>N.real</code></td>
<td>
<p>the number of animals inside the circle of radius B</p>
</td></tr>
<tr><td><code>Habitat</code></td>
<td>
<p>Value of the spatially  correlated habitat covariate, a 900 x 1 matrix</p>
</td></tr>
<tr><td><code>grid</code></td>
<td>
<p>Coordinates of the center of each pixel, a dataframe with 900 rows and 2 columns</p>
</td></tr>
</table>
<p>If <code>keep.all = FALSE</code> (the default), only the animals detected are included in <code>u1, u2, d, pixel.id</code>.
</p>


<h3>Note</h3>

<p>Kéry &amp; Royle (2016, p.535 and discussion p.540) and earlier versions of <code>AHMbook</code> included a hazard rate detection function. This is problematic because the detection probability at distance zero is less than 1 (<code>p(0) &lt; 1</code>) and should not be used. It is replaced here with the <code>logit</code> detection function, which does have <code>p(0) = 1</code>.
</p>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 9.8.3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure:
tmp &lt;- sim.spatialDS()
str(tmp)

# Generate date with model = "logit" and analyse the data with unmarked::pcount.spatialHDS
# RNGkind(sample.kind = "Rounding") # run this for R &gt;= 3.6.0
set.seed(1234)
tmp &lt;- sim.spatialDS(model="logit")
# Plot shows a large area of good habitat west of the observer with many animals detected
str(tmp)  # 272 animals detected out of 850 inside the circle (N.real)

# Fit some models with unmarked
if(require(unmarked)) {
  # Get the count of animals detected in each pixel
  pixel.count &lt;- tabulate(tmp$pixel.id, nbins=nrow(tmp$grid))
  # Centre the Habitat covariate
  Habitat &lt;- tmp$Habitat - mean(tmp$Habitat)
  # Create a detection covariate: distance between observer and pixel center
  dist &lt;- with(tmp, sqrt((grid[,1]-B)^2 + (grid[,2]-B)^2))
  # Construct an unmarkedFrame
  umf &lt;- unmarkedFramePCount(y=cbind(pixel.count),
     siteCovs=data.frame(dist=dist, Habitat=Habitat))
  summary(umf)

  (fm0 &lt;- pcount.spHDS(~ -1 + I(dist^2) ~ 1, umf, K=20))
  (fm1 &lt;- pcount.spHDS(~ -1 + I(dist^2) ~ Habitat, umf, K=20))
  # The model with Habitat has much lower AIC
  # Get an estimate of the total population in the square (true is N = 1000)
  sum(predict(fm1, type='state')[, 1])
}
</code></pre>

<hr>
<h2 id='sim.spatialHDS'>
Simulates data for a hierarchical spatial distance sampling model
</h2><span id='topic+sim.spatialHDS'></span>

<h3>Description</h3>

<p>Generates data for distance sampling from spatially-replicated point transects, with density dependent on a spatially correlated habitat covariate. For each point count, the procedure is:
</p>
<p>1. Simulate the habitat covariate over a grid of pixels covering a square.
</p>
<p>2. Distribute the population of individuals over the square with probability of location in a pixel related to the covariate.
</p>
<p>3. Decide which individuals are detected using a distance sampling model with an observer at the center of the square, with a half normal detection function. (Note that individuals outside the circle of radius <code>B</code> can be detected.)
</p>
<p>The locations and detection status of individuals at all sites are collated and returned, except for individuals at sites when none are detected.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.spatialHDS(lam0 = 4, sigma = 1.5, B = 3, nsites = 100,
  beta1 = 1, npix = 20, show.plots = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.spatialHDS_+3A_lam0">lam0</code></td>
<td>

<p>the expected number of individuals in the square of side = 2*B if the habitat covariate had no effect (ie, <code>beta1 = 0</code>).
</p>
</td></tr>
<tr><td><code id="sim.spatialHDS_+3A_sigma">sigma</code></td>
<td>

<p>scale parameter of the half-normal detection function
</p>
</td></tr>
<tr><td><code id="sim.spatialHDS_+3A_b">B</code></td>
<td>

<p>distance from the observer to the side of the square. This is usually set so that the probability of detection of individuals outside the square is negligable, eg, <code>B = 3*sigma</code>.
</p>
</td></tr>
<tr><td><code id="sim.spatialHDS_+3A_nsites">nsites</code></td>
<td>

<p>number of sites
</p>
</td></tr>
<tr><td><code id="sim.spatialHDS_+3A_beta1">beta1</code></td>
<td>

<p>the size of the effect of the habitat covariate on the number of individuals in a pixel.
</p>
</td></tr>
<tr><td><code id="sim.spatialHDS_+3A_npix">npix</code></td>
<td>

<p>the number of pixels along each dimension of the square: the entire grid has <code>npix x npix</code> pixels.
</p>
</td></tr>
<tr><td><code id="sim.spatialHDS_+3A_show.plots">show.plots</code></td>
<td>

<p>the number of sites for which plots should be displayed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a matrix with columns for siteID, the coordinates of each individual (<code>u1, u2</code>), distance from the center of the square (<code>d</code>) and detection status, 0/1 (<code>y</code>), and rows for each individual, except that individuals at sites where no individuals were detected are NOT included, and those sites are represented by NAs</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>the radius of the circle; the data are simulated over a square of side 2*B</p>
</td></tr>
<tr><td><code>Habitat</code></td>
<td>
<p>a matrix with the values of the Habitat covariate for each pixel at each site</p>
</td></tr>
<tr><td><code>grid</code></td>
<td>
<p>a data frame with the coordinates of each pixel (same for all sites)</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>the realized number of individuals in the square at each site</p>
</td></tr>
<tr><td><code>nsites</code></td>
<td>
<p>the number sites</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 9.8.5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure:
tmp &lt;- sim.spatialHDS()
str(tmp)
</code></pre>

<hr>
<h2 id='sim3Occ'>
Simulate detection/nondetection data for static 3-level occupancy models
</h2><span id='topic+sim3Occ'></span>

<h3>Description</h3>

<p>Function generates 3-level occupancy data with possibility of site-specific random variation at every level, &quot;time effects&quot; at the middle and the lower levels and effects of one distinct covariate at each level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim3Occ(nunits = 100, nsubunits = 5, nreps = 3,
  mean.psi = 0.8, beta.Xpsi = 1, sd.logit.psi = 0,
  mean.theta = 0.6, theta.time.range = c(-1, 1), beta.Xtheta = 1, sd.logit.theta = 0,
  mean.p = 0.4, p.time.range = c(-2, 2), beta.Xp = -1, sd.logit.p = 0,
  show.plot = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim3Occ_+3A_nunits">nunits</code></td>
<td>

<p>Number of main units (large quadrats)
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_nsubunits">nsubunits</code></td>
<td>

<p>Number of subunits (nested subsamples within each main unit)
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_nreps">nreps</code></td>
<td>

<p>Number of replicate surveys in every subunit
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_mean.psi">mean.psi</code></td>
<td>

<p>Mean large-scale, unit-level occupancy probability (psi)
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_beta.xpsi">beta.Xpsi</code></td>
<td>

<p>effect on psi of covariate A (at main unit level)
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_sd.logit.psi">sd.logit.psi</code></td>
<td>

<p>SD of logit(psi), unstructured site variation in psi
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_mean.theta">mean.theta</code></td>
<td>

<p>Mean small-scale (subunit) occupancy probability (theta)
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_theta.time.range">theta.time.range</code></td>
<td>

<p>range of theta 'intercepts' for subunits
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_beta.xtheta">beta.Xtheta</code></td>
<td>

<p>effect on theta of covariate B (at subunit level)
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_sd.logit.theta">sd.logit.theta</code></td>
<td>

<p>SD of logit(theta), unstructured site variation in theta
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_mean.p">mean.p</code></td>
<td>

<p>Mean per-survey detection probability
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_p.time.range">p.time.range</code></td>
<td>

<p>range of p 'intercepts' for replicates
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_beta.xp">beta.Xp</code></td>
<td>

<p>effect on p of covariate C (unit by subunit by replicate)
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_sd.logit.p">sd.logit.p</code></td>
<td>

<p>SD of logit(p)
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_show.plot">show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
<tr><td><code id="sim3Occ_+3A_verbose">verbose</code></td>
<td>

<p>if TRUE, output will be written to the console.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>theta.time.effect</code></td>
<td>
<p>Simulated time effect on theta, a vector of length <code>nsubunits</code></p>
</td></tr>
<tr><td><code>p.time.effect</code></td>
<td>
<p>Simulated time effect on p, a vector of length <code>nreps</code></p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Detection probabiliy, a <code>nunits x nsubunits x nreps</code> array</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Occupancy indicator for main units, a <code>nunits x 1</code> array of 0/1</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>Occupancy indicator for subunits, a <code>nunits x nsubunits</code> array of 0/1</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Detection array, a <code>nunits x nsubunits x nreps</code> array of 0/1</p>
</td></tr>
<tr><td><code>sum.z</code></td>
<td>
<p>True number of occupied main units</p>
</td></tr>
<tr><td><code>obs.sum.z</code></td>
<td>
<p>Observed number of occupied main units</p>
</td></tr>
<tr><td><code>sum.z.a</code></td>
<td>
<p>Number of units with &gt;=1 occupied, surveyed subunit</p>
</td></tr>
<tr><td><code>covA</code></td>
<td>
<p>Simulated covariate A, a vector of length <code>nunits</code></p>
</td></tr>
<tr><td><code>covB</code></td>
<td>
<p>Simulated covariate B, a <code>nunits x nsubunits</code> matrix</p>
</td></tr>
<tr><td><code>covC</code></td>
<td>
<p>Simulated covariate C, a <code>nunits x nsubunits x nreps</code> array</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 10.10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure:
tmp &lt;- sim3Occ()
str(tmp)

# 'Null' model (model 1)
str(data &lt;- sim3Occ(nunits = 100, nsubunits = 5, nreps = 3, mean.psi = 0.8,
  beta.Xpsi = 0, sd.logit.psi = 0, mean.theta = 0.6, theta.time.range = c(0, 0),
  beta.Xtheta = 0, sd.logit.theta = 0, mean.p = 0.4, p.time.range = c(0,0),
  beta.Xp = 0, sd.logit.p = 0))

# No covariate effects, no random variability (model 2)
str(data &lt;- sim3Occ(nunits = 100, nsubunits = 5, nreps = 3, mean.psi = 0.8,
  beta.Xpsi = 0, sd.logit.psi = 0, mean.theta = 0.6, theta.time.range = c(-1, 1),
  beta.Xtheta = 0, sd.logit.theta = 0, mean.p = 0.4, p.time.range = c(-2,2),
  beta.Xp = 0, sd.logit.p = 0))

# All covariate effects, but no random variability (model 3)
str(data &lt;- sim3Occ(nunits = 100, nsubunits = 5, nreps = 3, mean.psi = 0.8,
  beta.Xpsi = 1, sd.logit.psi = 0, mean.theta = 0.6, theta.time.range = c(-1, 1),
  beta.Xtheta = 1, sd.logit.theta = 0, mean.p = 0.4, p.time.range = c(-2,2),
  beta.Xp = -1, sd.logit.p = 0))

# Most complex model with all effects allowed for by sim function (model 4)
str(data &lt;- sim3Occ(nunits = 100, nsubunits = 5, nreps = 3, mean.psi = 0.8,
  beta.Xpsi = 1, sd.logit.psi = 1, mean.theta = 0.6, theta.time.range = c(-1, 1),
  beta.Xtheta = 1, sd.logit.theta = 1, mean.p = 0.4, p.time.range = c(-2,2),
  beta.Xp = -1, sd.logit.p = 1))
</code></pre>

<hr>
<h2 id='simCJS'>
Simulate individual capture-histories under a Cormack-Jolly-Seber (CJS) survival model
</h2><span id='topic+simCJS'></span>

<h3>Description</h3>

<p>Function generates individual capture-histories under a CJS model with possibly time-dependent parameters. The number of values for interval-specific survival (phi) and time-specific detection (p) must be ensured to be equal to the number of occasions (n.occ) minus 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simCJS(n.occ = 6, n.marked = 20, phi = 0.7, p = 0.4, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simCJS_+3A_n.occ">n.occ</code></td>
<td>

<p>The number of occasions (eg, years).
</p>
</td></tr>
<tr><td><code id="simCJS_+3A_n.marked">n.marked</code></td>
<td>

<p>The number of individuals marked per year except for the last year; scalar, or a vector of length (n.occ-1).
</p>
</td></tr>
<tr><td><code id="simCJS_+3A_phi">phi</code></td>
<td>

<p>The apparent survival probability between years; scalar, or a vector of length (n.occ-1).
</p>
</td></tr>
<tr><td><code id="simCJS_+3A_p">p</code></td>
<td>

<p>The recapture probability for all except the first year; scalar, or a vector of length (n.occ-1).
</p>
</td></tr>
<tr><td><code id="simCJS_+3A_show.plot">show.plot</code></td>
<td>

<p>Choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments entered and the following additional elements:
</p>
<table>
<tr><td><code>z</code></td>
<td>
<p>n.ind x n.occ matrix, 1 if the individual is alive and in the study area, 0 otherwise.</p>
</td></tr>
<tr><td><code>ch</code></td>
<td>
<p>n.ind x n.occ matrix, 1 if the individual is captured, 0 otherwise.</p>
</td></tr>
<tr><td><code>f</code></td>
<td>
<p>n.ind vector, occasion the individual was first captured, and marked.</p>
</td></tr>
<tr><td><code>n.ind</code></td>
<td>
<p>scalar, total number of individuals marked.</p>
</td></tr>
<tr><td><code>n.alive</code></td>
<td>
<p>n.occ vector, number of animals alive and in the study area each year.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle, based on code written by Michael Schaub for Chapter 7 of Kéry &amp; Schaub (2012).
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Schaub, M. (2012) <em>Bayesian population analysis using WinBUGS - a hierarchical perspective</em>, Academic Press.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 3.2.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run with the default arguments and look at the structure of the output:
set.seed(123)
tmp &lt;- simCJS()
str(tmp)
colSums(tmp$ch)
</code></pre>

<hr>
<h2 id='simComm'>
Simulate community occupancy or community abundance data
</h2><span id='topic+simComm'></span>

<h3>Description</h3>

<p>Simulate detection/nondetection or count data, respectively, under a community occupancy or abundance model with random species effects for psi or lambda and p (both including effects of one covariate, 'habitat' for psi or lambda and 'wind speed' for p) (introduced in AHM1 - 11.2)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simComm(type = c("det/nondet", "counts"), nsites = 30, nreps = 3, nspecies = 100,
  mean.psi = 0.25, sig.lpsi = 1, mu.beta.lpsi = 0, sig.beta.lpsi = 0,
  mean.lambda = 2, sig.loglam = 1, mu.beta.loglam = 1, sig.beta.loglam = 1,
  mean.p = 0.25, sig.lp = 1, mu.beta.lp = 0, sig.beta.lp = 0, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simComm_+3A_type">type</code></td>
<td>

<p>choose whether you want to simulate detection/nondetection (&quot;det/nondet&quot;) data or count data (&quot;counts&quot;).
</p>
</td></tr>
<tr><td><code id="simComm_+3A_nsites">nsites</code></td>
<td>

<p>number of sites
</p>
</td></tr>
<tr><td><code id="simComm_+3A_nreps">nreps</code></td>
<td>

<p>number of replicate samples (occasions or repeated measurements)
</p>
</td></tr>
<tr><td><code id="simComm_+3A_nspecies">nspecies</code></td>
<td>

<p>total number of species in the area that is sampled by these sites (regional species pool)
</p>
</td></tr>
<tr><td><code id="simComm_+3A_mean.psi">mean.psi</code></td>
<td>

<p>community mean of occupancy probability over all species in community (probability scale); ignored if <code>type = "counts"</code>.
</p>
</td></tr>
<tr><td><code id="simComm_+3A_sig.lpsi">sig.lpsi</code></td>
<td>

<p>community standard deviation of logit(occupancy probability intercept); ignored if <code>type = "counts"</code>.
</p>
</td></tr>
<tr><td><code id="simComm_+3A_mu.beta.lpsi">mu.beta.lpsi</code></td>
<td>

<p>community mean of the effects of 'habitat' covariate on occupancy probability; ignored if <code>type = "counts"</code>.
</p>
</td></tr>
<tr><td><code id="simComm_+3A_sig.beta.lpsi">sig.beta.lpsi</code></td>
<td>

<p>community standard deviation of the effects of 'habitat' covariate on occupancy probability; ignored if <code>type = "counts"</code>.
</p>
</td></tr>
<tr><td><code id="simComm_+3A_mean.lambda">mean.lambda</code></td>
<td>

<p>community mean of expected abundance over all species in superpopulation; ignored if <code>type = "det/nondet"</code>.
</p>
</td></tr>
<tr><td><code id="simComm_+3A_sig.loglam">sig.loglam</code></td>
<td>

<p>community standard deviation of log(lambda intercept); ignored if <code>type = "det/nondet"</code>.
</p>
</td></tr>
<tr><td><code id="simComm_+3A_mu.beta.loglam">mu.beta.loglam</code></td>
<td>

<p>community mean of the effects of 'habitat' covariate on log(lambda); ignored if <code>type = "det/nondet"</code>.
</p>
</td></tr>
<tr><td><code id="simComm_+3A_sig.beta.loglam">sig.beta.loglam</code></td>
<td>

<p>community standard deviation of the effects of 'habitat' covariate on expected abundance; ignored if <code>type = "det/nondet"</code>.
</p>
</td></tr>
<tr><td><code id="simComm_+3A_mean.p">mean.p</code></td>
<td>

<p>community mean of detection probability over all species in superpopulation (probability scale)
</p>
</td></tr>
<tr><td><code id="simComm_+3A_sig.lp">sig.lp</code></td>
<td>

<p>community standard deviation of logit(detection probability intercept)
</p>
</td></tr>
<tr><td><code id="simComm_+3A_mu.beta.lp">mu.beta.lp</code></td>
<td>

<p>community mean of the effects of 'wind' covariate on detection probability
</p>
</td></tr>
<tr><td><code id="simComm_+3A_sig.beta.lp">sig.beta.lp</code></td>
<td>

<p>community standard deviation of the effects of 'wind' covariate on detection probability
</p>
</td></tr>
<tr><td><code id="simComm_+3A_show.plot">show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function simulates data from repeated sampling of a metacommunity (or spatially structured community) according to the model of Dorazio &amp; Royle (JASA, 2005) for <code>type = "det/nondet"</code> (this is the default) or under the model of Yamaura et al. (2012) for <code>type = "counts"</code>.
</p>
<p>Occupancy probability (psi) or expected abundance (lambda) can be made dependent on a continuous site covariate 'habitat', while detection probability can be made dependent an observational covariate 'wind'. Both intercept and slope of the two log-linear or logistic regressions (for occupancy or expected abundance, respectively, and for detection) are simulated as draws from a normal distribution with mean and standard deviation that can be selected using function arguments.
</p>
<p>Specifically, the data are simulated under the following linear models:
</p>
<p><b>(1) for <code>type = "det/nondet"</code> (i.e., community occupancy)</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
(occupancy (psi) and detection (p) for site i, replicate j and species k) </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>psi[i,k] &lt;- plogis(beta0[k] + beta1[k] * habitat[i]</code> </td><td style="text-align: left;"> Occupancy </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p[i,j,k] &lt;- plogis(alpha0[k] + alpha1[k] * wind[i,j]</code> </td><td style="text-align: left;"> Detection </td>
</tr>

</table>

<p><b>(2) for <code>type = "counts"</code> (i.e., community count)</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
(exp. abundance (lambda) and detection (p) for site i, rep. j and species k) </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>lambda[i,k] &lt;- exp(beta0[k] + beta1[k] * habitat[i]</code> </td><td style="text-align: left;"> E(N) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>p[i,j,k] &lt;- plogis(alpha0[k] + alpha1[k] * wind[i,j]</code> </td><td style="text-align: left;"> Detection </td>
</tr>

</table>

<p>Species-specific heterogeneity in intercepts and slopes is modeled by up to four independent normal distributions (note: no correlation between the intercepts as in Dorazio et al. (2006) or Kéry &amp; Royle (2008))
</p>
<p><b>(1) for <code>type = "det/nondet"</code> (i.e., community occupancy)</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>beta0 ~ dnorm(logit(mean.psi), sig.lpsi)</code> </td><td style="text-align: left;"> Mean and SD of normal distribution </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>beta1 ~ dnorm(mu.beta.lpsi, sig.beta.lpsi)</code> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>alpha0 ~ dnorm(logit(mean.p), sig.lp)</code> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>alpha1 ~ dnorm(mu.beta.lp, sig.beta.lp)</code> </td><td style="text-align: left;"> </td>
</tr>

</table>

<p><b>(2) for <code>type = "counts"</code> (i.e., community count)</b>
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>beta0 ~ dnorm(log(mean.lambda), sig.loglam)</code> </td><td style="text-align: left;"> Mean and SD of normal distribution </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>beta1 ~ dnorm(mu.beta.loglam, sig.beta.loglam)</code> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>alpha0 ~ dnorm(logit(mean.p), sig.lp)</code> </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>alpha1 ~ dnorm(mu.beta.lp, sig.beta.lp)</code> </td><td style="text-align: left;"> </td>
</tr>

</table>



<h3>Value</h3>

<p>A list with the arguments supplied and the following additional elements:
</p>
<p><b>(1) for <code>type = "det/nondet"</code> (i.e., community occupancy)</b>
</p>
<table>
<tr><td><code>habitat</code></td>
<td>
<p>length <code>nsites</code> vector with the habitat covariate</p>
</td></tr>
<tr><td><code>wind</code></td>
<td>
<p><code>nsites * nreps</code> matrix with the wind covariate</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p><code>psi[i, k]</code> occupancy probability for site i and species k</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p><code>p[i, j, k]</code> detection probability for site i, occasion j and species k</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p><code>z[i, k]</code> true presence/absence for site i and species k</p>
</td></tr>
<tr><td><code>z.obs</code></td>
<td>
<p><code>z.obs[i, k]</code> observed presence/absence for site i and species k</p>
</td></tr>
<tr><td><code>y.all</code></td>
<td>
<p><code>y.all[i, j, k]</code> detection/nondetection data for site i, occasion j and species k for all species</p>
</td></tr>
<tr><td><code>y.obs</code></td>
<td>
<p><code>y.obs[i, j, k]</code> detection/nondetection data for site i, occasion j and species k for observed species</p>
</td></tr>
<tr><td><code>y.sum.all</code></td>
<td>
<p>detection frequency for all species</p>
</td></tr>
<tr><td><code>y.sum.obs</code></td>
<td>
<p>detection frequency for observed species</p>
</td></tr>
<tr><td><code>Ntotal.fs</code></td>
<td>
<p>finite sample (or conditional) species richness</p>
</td></tr>
<tr><td><code>Ntotal.obs</code></td>
<td>
<p>observed species richness</p>
</td></tr>
<tr><td><code>S.true</code></td>
<td>
<p>true number of species occurring at each site</p>
</td></tr>
<tr><td><code>S.obs</code></td>
<td>
<p>observed number of species occurring at each site</p>
</td></tr>
</table>
<p><b>(2) for <code>type = "counts"</code> (i.e., community count)</b>
</p>
<table>
<tr><td><code>habitat</code></td>
<td>
<p>length <code>nsites</code> vector with the habitat covariate</p>
</td></tr>
<tr><td><code>wind</code></td>
<td>
<p><code>nsites * nreps</code> matrix with the wind covariate</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p><code>lambda[i, k]</code> expected number of individuals for site i and species k</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p><code>p[i, j, k]</code> detection probability for site i, occasion j and species k</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p><code>N[i, k]</code> true number present for site i and species k</p>
</td></tr>
<tr><td><code>y.all</code></td>
<td>
<p><code>y.all[i, j, k]</code> number observed for site i, occasion j and species k for all species</p>
</td></tr>
<tr><td><code>y.obs</code></td>
<td>
<p><code>y.obs[i, j, k]</code> number observed for site i, occasion j and species k for observed species</p>
</td></tr>
<tr><td><code>ymax.obs</code></td>
<td>
<p><code>ymax.obs[i, k]</code> maximum number observed for site i and species k</p>
</td></tr>
<tr><td><code>Ntotal.fs</code></td>
<td>
<p>finite sample (or conditional) species richness</p>
</td></tr>
<tr><td><code>Ntotal.obs</code></td>
<td>
<p>observed species richness</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle, with community occupancy model code partly based on code by Richard Chandler.
</p>


<h3>References</h3>

<p>Dorazio, R.M. &amp; Royle, J.A. (2005) Estimating size and composition of biological communities by modeling the occurrence of species. <em>J American Statistical Association</em>, 100, 389-398.
</p>
<p>Dorazio, R.M., et al (2006) Estimating species richness and accumulation by modeling species occurrence and detectability. <em>Ecology</em> 87, 842-854.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2008) Hierarchical Bayes estimation of species richness and occupancy in spatially replicated surveys. <em>Journal of Applied Ecology</em> 45, 589-598.
</p>
<p>Yamaura, Y., et al. (2012) Biodiversity of man-made open habitats in an underused country: a class of multispecies abundance models for count data. <em>Biodiversity and Conservation</em> 21, 1365-1380.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 11.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Default arguments:
str(simComm())

# Some possibly interesting settings of the function
data &lt;- simComm(nsites = 267, nspecies = 190, mean.psi = 0.25, sig.lpsi = 2,
  mean.p = 0.12, sig.lp = 2) # similar to Swiss MHB
data &lt;- simComm(mean.psi = 1)         # all species occur at every site
data &lt;- simComm(mean.p = 1)           # no measurement error (perfect detection)

# Effect of spatial sample size (nsites) on species richness in sample (Ntotal.fs)
data &lt;- simComm(nsites=50, nspecies = 200) # 1-3 are usually missed in sample
data &lt;- simComm(nsites=30, nspecies = 200) # 4-6 usually missed
data &lt;- simComm(nsites=10, nspecies = 200) # around 30 typically missed
</code></pre>

<hr>
<h2 id='simDataDK'>
Simulate data for an integrated species distribution model (SDM) of Dorazio-Koshkina
</h2><span id='topic+simDataDK'></span><span id='topic+simDataDK1'></span>

<h3>Description</h3>

<p>The function generates a population represented as a point pattern in a heterogeneous landscape and simulates data from two different sources: (1) opportunistic presence-only data, and (2) replicate counts or detection/nondetection data in randomly-placed quadrats. This is the scenario for the integrated models described by Dorazio (2014) and Koshkina et al. (2017). The former assumes counts as data source (2) while the latter assume detection/nondetection data.
</p>
<p>A Poisson point pattern (PPP) with intensity a function of a covariate X and intercept and coefficient beta is simulated on a discrete (pixel-based) approximation of a continuous landscape.
</p>
<p>This PPP is first thinned with a pixel-wise thinning probability controlled by a covariate W and coefficients alpha, and second, with a landscape-wise random drop-out process to produce a first data set of presence-only kind.
</p>
<p>A second data set is simulated by imagining replicated counts conducted in randomly-selected quadrats within the landscape. Detection of individuals is imperfect, with probability of detection controlled by the covariate W and coefficients gamma. These counts can be quantized to detection/nondetection data for use in a model as in Koshkina et al. (2017).
</p>
<p>For <code>simDataDK1</code> animals are limited to one individual per pixel; this is not the case for <code>simDataDK</code>.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDataDK(sqrt.npix = 100, alpha = c(-1,-1), beta = c(6,0.5),
  drop.out.prop.pb = 0.7, quadrat.size = 4, gamma = c(0,-1.5),
  nquadrats = 250, nsurveys = 3, show.plot = TRUE)

simDataDK1(sqrt.npix = 100, alpha = c(-1,-1), beta = c(6,0.5),
  drop.out.prop.pb = 0.7, quadrat.size = 4, gamma = c(0,-1.5),
  nquadrats = 250, nsurveys = 3, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simDataDK_+3A_sqrt.npix">sqrt.npix</code></td>
<td>

<p>number of pixels along each side of square state space (the 'landscape'); the total number of pixels is then <code>npix = sqrt.npix^2</code>. For <code>simDataDK1</code> this limits the population size to 1 per pixel.
</p>
</td></tr>
<tr><td><code id="simDataDK_+3A_alpha">alpha</code></td>
<td>

<p>coefficients for the relationship: logit(b) = alpha[1] + alpha[2] * W, where b is the sampling detection bias in the presence-only observations.
</p>
</td></tr>
<tr><td><code id="simDataDK_+3A_beta">beta</code></td>
<td>

<p>coefficients for the relationship: log(lambda) = beta[1] + beta[2] * X, where lambda is the intensity of the Poisson point process. If the values of beta result in very large numbers of animals, an error will occur. 
</p>
</td></tr>
<tr><td><code id="simDataDK_+3A_drop.out.prop.pb">drop.out.prop.pb</code></td>
<td>

<p>proportion of presence-only points at the end that are discarded.
</p>
</td></tr>
<tr><td><code id="simDataDK_+3A_quadrat.size">quadrat.size</code></td>
<td>

<p>length of the side of quadrats for conducting replicate counts in <em>pixel</em> units; note that sqrt.npix / quadrat.size must yield an integer.
</p>
</td></tr>
<tr><td><code id="simDataDK_+3A_gamma">gamma</code></td>
<td>

<p>coefficients for the relationship: logit(p) = gamma[1] + gamma[2] * W, where p is the probability of detecting an individual during the count surveys in the quadrats.
</p>
</td></tr>
<tr><td><code id="simDataDK_+3A_nquadrats">nquadrats</code></td>
<td>

<p>the number of quadrats selected for the count survey.
</p>
</td></tr>
<tr><td><code id="simDataDK_+3A_nsurveys">nsurveys</code></td>
<td>

<p>the number of replicate counts in each quadrat.
</p>
</td></tr>
<tr><td><code id="simDataDK_+3A_show.plot">show.plot</code></td>
<td>

<p>if TRUE, summary plots are displayed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>npix</code></td>
<td>
<p>the number of pixels in the landscape</p>
</td></tr>
<tr><td><code>s.area</code></td>
<td>
<p>the area of the whole landscape = 4</p>
</td></tr>
<tr><td><code>s.loc</code></td>
<td>
<p>2-column vector with the location of each pixel</p>
</td></tr>
<tr><td><code>xcov</code></td>
<td>
<p>values of the 'X' (intensity) covariate</p>
</td></tr>
<tr><td><code>wcov</code></td>
<td>
<p>values of the 'W' (detection) covariate</p>
</td></tr>
<tr><td><code>N.ipp</code></td>
<td>
<p>true number of individuals in the landscape</p>
</td></tr>
<tr><td><code>pixel.id.ipp</code></td>
<td>
<p>pixel ID for each individual in the population</p>
</td></tr>
<tr><td><code>loc.ipp</code></td>
<td>
<p>coordinates for each individual in the population</p>
</td></tr>
<tr><td><code>pTrue.ipp</code></td>
<td>
<p>probability of detection for each individual for presence-only data</p>
</td></tr>
<tr><td><code>pixel.id.det</code></td>
<td>
<p>pixel ID for each individual detected opportunistically</p>
</td></tr>
<tr><td><code>N.det</code></td>
<td>
<p>number of detections</p>
</td></tr>
<tr><td><code>loc.det</code></td>
<td>
<p>coordinates of each individual detected opportunistically</p>
</td></tr>
<tr><td><code>pcount</code></td>
<td>
<p>probability of detection during count surveys, varies by quadrat</p>
</td></tr>
<tr><td><code>fullCountData</code></td>
<td>
<p>matrix with rows for each quadrat, columns for ID, x and w coords, true N, and 3 replicate counts</p>
</td></tr>
<tr><td><code>countData</code></td>
<td>
<p>as above, but rows for quadrats sampled only</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>a Raster Stack with layers for 'X', 'W', and number in each pixel, 'n'</p>
</td></tr>
<tr><td><code>squad</code></td>
<td>
<p>a Raster Stack corresponding to the quadrats, with mean 'X' and 'W' and true abundance, 'N'</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry, Andy Royle &amp; Mike Meredith, based on the code written by Dorazio (2014) and adapted by Koshkina et al. (2017).
</p>


<h3>References</h3>

<p>Dorazio, R.M. (2014) Accounting for imperfect detection and survey bias in statistical analysis of presence-only data. <em>Global Ecology and Biogeography</em>, 23, 1472-1484.
</p>
<p>Koshkina, V., Wang, Y., Gordon, A., Dorazio, R.M., White, M., &amp; Stone, L. (2017) Integrated species distribution models: combining presence-background data and site-occupany data with imperfect detection. <em>Methods in Ecology and Evolution</em>, 8, 420-430.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run the function with default values and look at the output
str(tmp &lt;- simDataDK(), 1)  # use str(., max.level=1) to limit the amount of output.

str(tmp &lt;- simDataDK(show.plot=FALSE), 1)  # no plots

str(tmp &lt;- simDataDK(sqrt.npix = 500), 1)  # much larger landscape

str(tmp &lt;- simDataDK(alpha = c(-1,1)), 1)  # positive effect of W on bias rate parameter b

str(tmp &lt;- simDataDK(beta = c(6, 0.5)), 1) # lower density

str(tmp &lt;- simDataDK(drop.out.prop = 0), 1)# No final uniform thinning ("drop out")

str(tmp &lt;- simDataDK(beta = c(6, 1)), 1)   # steeper gradient of habitat suitability
</code></pre>

<hr>
<h2 id='simDCM'>
Simulate detection/nondetection data under a general dynamic community (site-occupancy) model
</h2><span id='topic+simDCM'></span>

<h3>Description</h3>

<p>Function to simulate detection/nondetection data under a general dynamic community (= dynamic, multi-species site-occupancy) model, including:
</p>
<p>* annual variation in the probabilities of patch persistence, colonization and detection is specified by the bounds of a uniform distribution.
</p>
<p>* species heterogeneity around the community means is specified by the SD of a normal distribution and expressed on the logit scale
</p>
<p>* one covariate is allowed per parameter (site covariate for psi1, site-year covariate for phi and gamma and site-year-rep covariate for p). Each covariate is allowed to differ among species again according to a logit-normal model of heterogeneity.
</p>
<p>* additional detection heterogeneity at the site- or the occasion level, with the possibility of a temporal trend in this heterogeneity over years. E.g., an annual trend in detection heterogeneity at the site or the occasion level is specified by the value in the first and the last year. Hence, trend.sd.site = c(0, 1) will result in a linear trend in the magnitude of site-level heterogeneity in detection from 0 in the first year to 1 in the last year, with interpolation for the years in between.
</p>
<p>* additional detection heterogeneity that among occasions according to a quadratic effect of occasion number (to model the typical 'phenological curve' of an insect species for instance).
</p>
<p>These last two types of detection heterogeneity are not (yet) allowed to be species-specific.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDCM(nspecies = 50, nsites = 100, nsurveys = 3, nyears = 10,
  mean.psi1 = 0.4, sig.lpsi1 = 1, mu.beta.lpsi1 = 0, sig.beta.lpsi1 = 0,
  range.mean.phi = c(0.8, 0.8), sig.lphi = 1, mu.beta.lphi = 0,
  sig.beta.lphi = 0, range.mean.gamma = c(0.2, 0.2), sig.lgamma = 1,
  mu.beta.lgamma = 0, sig.beta.lgamma = 0, range.mean.p = c(0.5, 0.5),
  sig.lp = 1, mu.beta.lp = 0, sig.beta.lp = 0, range.beta1.survey = c(0, 0),
  range.beta2.survey = c(0, 0), trend.sd.site = c(0, 0),
  trend.sd.survey = c(0, 0), show.plot = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simDCM_+3A_nspecies">nspecies</code></td>
<td>

<p>number of species (typically called N in AHM book)
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_nsites">nsites</code></td>
<td>

<p>number of sites (M).
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_nsurveys">nsurveys</code></td>
<td>

<p>number of replicate surveys within a year (J).
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_nyears">nyears</code></td>
<td>

<p>number of years (T).
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_mean.psi1">mean.psi1</code></td>
<td>

<p>average (across all species in the community) of the intercept of occupancy probability in first year.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_sig.lpsi1">sig.lpsi1</code></td>
<td>

<p>sd of the normal distribution from which species-specific occupancy intercepts are drawn (centered on logit(mean.psi1)), on logit scale.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_mu.beta.lpsi1">mu.beta.lpsi1</code></td>
<td>

<p>community mean of the coefficients of the covariate in probabilities of initial occupancy: the probability-scale mean of the normal distribution from which the species-specific coefficients are drawn.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_sig.beta.lpsi1">sig.beta.lpsi1</code></td>
<td>

<p>sd of the normal distribution from which species-specific slopes are drawn (centered on mu.beta.lpsi1).
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_range.mean.phi">range.mean.phi</code></td>
<td>

<p>bounds of uniform distribution from which the average (across species) annual intercept of persistence is drawn.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_sig.lphi">sig.lphi</code></td>
<td>

<p>sd of the normal distribution from which species-specific persistence intercepts are drawn (centered on logit(mean.phi), which are year-specific), on logit scale.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_mu.beta.lphi">mu.beta.lphi</code></td>
<td>

<p>community mean of the coefficients of the covariate in probabilities of persistence: the probability-scale mean of the normal distribution from which the species-specific coefficients are drawn.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_sig.beta.lphi">sig.beta.lphi</code></td>
<td>

<p>sd of the normal distribution from which species-specific persistence slopes are drawn (centered on mu.beta.lphi).
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_range.mean.gamma">range.mean.gamma</code></td>
<td>

<p>bounds of uniform distribution from which the average (across species) annual intercept of colonization is drawn.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_sig.lgamma">sig.lgamma</code></td>
<td>

<p>sd of the normal distribution from which species-specific colonization intercepts are drawn (centered on logit(mean.gamma), which are year-specific), on logit scale.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_mu.beta.lgamma">mu.beta.lgamma</code></td>
<td>

<p>community mean of the coefficients of the covariate in probabilities of colonization: the probability-scale mean of the normal distribution from which the species-specific coefficients are drawn.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_sig.beta.lgamma">sig.beta.lgamma</code></td>
<td>

<p>sd of the normal distribution from which species-specific colonization slopes are drawn (centered on mu.beta.lgamma).
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_range.mean.p">range.mean.p</code></td>
<td>

<p>bounds of uniform distribution from which the average (across species) annual intercept of p is drawn.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_sig.lp">sig.lp</code></td>
<td>

<p>sd of the normal distribution from which species-specific detection intercepts are drawn (centered on logit(mean.p), which are year-specific), on logit scale.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_mu.beta.lp">mu.beta.lp</code></td>
<td>

<p>community mean of the coefficients of the covariate in probabilities of detection: the probability-scale mean of the normal distribution from which the species-specific coefficients are drawn.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_sig.beta.lp">sig.beta.lp</code></td>
<td>

<p>sd of the normal distribution from which species-specific detection slopes are drawn (centered on mu.beta.lp).
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_range.beta1.survey">range.beta1.survey</code></td>
<td>

<p>the range of the annual variation in the linear effect of survey (i.e., of surveys 1-12 if nsurveys = 12) on the product of availability and detection.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_range.beta2.survey">range.beta2.survey</code></td>
<td>

<p>the range of the annual variation in the quadratic effect of survey (i.e., of surveys 1-12 if nsurveys = 12) on the product of availability and detection.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_trend.sd.site">trend.sd.site</code></td>
<td>

<p>sd of normal distribution to model logit-normal noise in p at the site level in the first and the last year of the simulation, with values for intermediate years interpolated linearly.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_trend.sd.survey">trend.sd.survey</code></td>
<td>

<p>sd of normal distribution to model logit-normal noise in p at the occasion level, in the first and the last year, with values for intermediate years interpolated linearly.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_show.plot">show.plot</code></td>
<td>

<p>if TRUE, plots are produced. Set this to FALSE when running simulations.
</p>
</td></tr>
<tr><td><code id="simDCM_+3A_verbose">verbose</code></td>
<td>

<p>if TRUE, output will be written to the console.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>Xpsi1</code></td>
<td>
<p>Site covariate for psi1, a nsites x 1 matrix</p>
</td></tr>
<tr><td><code>Xphi</code></td>
<td>
<p>Yearly-site covariate for phi, a nsites x nyears matrix</p>
</td></tr>
<tr><td><code>Xgamma</code></td>
<td>
<p>Yearly-site covariate for gamma, a nsites x nyears matrix</p>
</td></tr>
<tr><td><code>Xp</code></td>
<td>
<p>Observation covariate for p, a nsites x nsurveys x nyears array</p>
</td></tr>
<tr><td><code>beta0.lpsi</code></td>
<td>
<p>initial (logit-scale) occupancy intercept for each species in the community, a vector of length nspecies</p>
</td></tr>
<tr><td><code>beta1.lpsi</code></td>
<td>
<p>initial (log-scale) occupancy slope on Xpsi1 for each species in the community, a vector of length nspecies</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>occupancy probability per site, year and species, a nsites x nyears x nspecies array</p>
</td></tr>
<tr><td><code>mean.phi</code></td>
<td>
<p>mean persistence (across species) intercept for each interval, a vector of length (nyears - 1)</p>
</td></tr>
<tr><td><code>mean.gamma</code></td>
<td>
<p>mean colonization (across species) intercept for each interval, a vector of length (nyears - 1)</p>
</td></tr>
<tr><td><code>eps.lphi</code></td>
<td>
<p>additive species effects in logit(phi) intercept, a vector of length nspecies</p>
</td></tr>
<tr><td><code>eps.lgamma</code></td>
<td>
<p>additive species effects in logit(gamma) intercept, a vector of length nspecies</p>
</td></tr>
<tr><td><code>beta0.lphi</code></td>
<td>
<p>logit-scale persistence intercepts for each species in community, a nspecies x (nyears - 1) matrix</p>
</td></tr>
<tr><td><code>beta0.lgamma</code></td>
<td>
<p>logit scale colonization intercepts for each species in the community, a nspecies x (nyears - 1) matrix</p>
</td></tr>
<tr><td><code>beta1.lphi</code></td>
<td>
<p>slope of logit(phi) on Xphi for each species in the community, a vector of length nspecies</p>
</td></tr>
<tr><td><code>beta1.lgamma</code></td>
<td>
<p>slope of logit(gamma) on Xgamma for each species in the community, a vector of length nspecies</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>probability of persistence for each site, yearly interval and species, a nsites x (nyears-1) x nspecies array</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>probability of colonization for each site, yearly interval and species, a nsites x (nyears-1) x nspecies array</p>
</td></tr>
<tr><td><code>mean.p</code></td>
<td>
<p>mean detection (across species) intercept for each year, a vector of length nyears</p>
</td></tr>
<tr><td><code>eps.lp</code></td>
<td>
<p>additive species effects in logit(p) intercept, a vector of length nspecies</p>
</td></tr>
<tr><td><code>beta0.lp</code></td>
<td>
<p>species- and site-specific intercepts in the linear predictor for p, a nspecies x nyears matrix</p>
</td></tr>
<tr><td><code>beta1.lp</code></td>
<td>
<p>species specific slopes of logit(p) on Xp, a vector of length nspecies</p>
</td></tr>
<tr><td><code>beta1</code></td>
<td>
<p>linear effect of the occasion number on detection probability, a vector of length nyears</p>
</td></tr>
<tr><td><code>beta2</code></td>
<td>
<p>quadratic effect of the occasion number on detection probability, a vector of length nyears</p>
</td></tr>
<tr><td><code>sd.site</code></td>
<td>
<p>standard deviation of the zero-mean normal distribution from which additional, site-level detection heterogeneity is simulated, a vector of length nyears</p>
</td></tr>
<tr><td><code>sd.survey</code></td>
<td>
<p>standard deviation of the zero-mean normal distribution from which additional, occasion-level detection heterogeneity is simulated,, a vector of length nyears</p>
</td></tr>
<tr><td><code>eps1</code></td>
<td>
<p>additive site random effects tht generate unstructured site-level detection heterogeneity, a vector of length nsites</p>
</td></tr>
<tr><td><code>eps2</code></td>
<td>
<p>additive occasion random effects tht generate unstructured site-level detection heterogeneity, a vector of length nsurveys</p>
</td></tr>
<tr><td><code>n.occ</code></td>
<td>
<p>Number of occupied sites, a nyears x nspecies matrix</p>
</td></tr>
<tr><td><code>psi.fs</code></td>
<td>
<p>Finite-sample occupancy proportion, a nyears x nspecies matrix</p>
</td></tr>
<tr><td><code>mean.psi</code></td>
<td>
<p>Average psi over sites, a nyears x nspecies matrix</p>
</td></tr>
<tr><td><code>z.obs</code></td>
<td>
<p>Observed value of z matrix, a nsites x nyears x nspecies array</p>
</td></tr>
<tr><td><code>n.occ.obs</code></td>
<td>
<p>Observed number of occupied sites, a nyears x nspecies matrix</p>
</td></tr>
<tr><td><code>psi.obs</code></td>
<td>
<p>Observed occupancy (finite sample), a nyears x nspecies matrix</p>
</td></tr>
<tr><td><code>nyears.pres</code></td>
<td>
<p>Number of years when species present, a vector of length nspecies</p>
</td></tr>
<tr><td><code>nspecies.pres</code></td>
<td>
<p>Number of species ever present, scalar</p>
</td></tr>
<tr><td><code>nyears.det</code></td>
<td>
<p>Number of years when species detected, a vector of length nspecies</p>
</td></tr>
<tr><td><code>nspecies.det</code></td>
<td>
<p>Number of species ever detected, scalar</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>True value of z matrix (ie, presence/absence), a nsites x nyears x nspecies array</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Probability of detection, a nsites x nsurveys x nyears x nspecies array</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Observed detection history, a nsites x nsurveys x nyears x nspecies array of 0/1</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 5.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a data set with the default arguments and look at the structure of the output:
tmp &lt;- simDCM()
str(tmp)


# Default arguments, without plots
str(data &lt;- simDCM(show.plot = FALSE))
# More examples:
str(data &lt;- simDCM(nspecies = 200)) # More species (looks great)
str(data &lt;- simDCM(nspecies = 1))   # A single species (ha, works !)
str(data &lt;- simDCM(nsites = 267))   # More sites
str(data &lt;- simDCM(nsites = 1))     # A single site
str(data &lt;- simDCM(nsurveys = 10))  # More visits
str(data &lt;- simDCM(nyears = 25))    # More years
str(data &lt;- simDCM(nyears = 2))     # Just two years
try(data &lt;- simDCM(nyears = 1))     # A single year ... error

# No species heterogeneity in parameters of initial occupancy
str(data &lt;- simDCM(sig.lpsi1 = 0, sig.beta.lpsi1 = 0))
# No species heterogeneity in parameters of persistence
str(data &lt;- simDCM(sig.lphi = 0, sig.beta.lphi = 0))
# No species heterogeneity in parameters of colonisation
str(data &lt;- simDCM(sig.lgamma = 0, sig.beta.lgamma = 0))
# No species heterogeneity in parameters of detection
str(data &lt;- simDCM(sig.lp = 0, sig.beta.lp = 0))
# No annual variation in rates
str(data &lt;- simDCM(range.mean.phi = c(0.8, 0.8), range.mean.gamma = c(0.3, 0.3),
  range.mean.p = c(0.6, 0.6)))

# Function arguments that lead to much structure (no zero arguments)
str(data &lt;- simDCM(nspecies = 200, nsites = 267, nsurveys = 3, nyears = 25,
  mean.psi1 = 0.4, sig.lpsi1 = 3, mu.beta.lpsi1 = 1, sig.beta.lpsi1 = 3,
  range.mean.phi = c(0.5, 1), sig.lphi = 3, mu.beta.lphi = 1,
  sig.beta.lphi = 3, range.mean.gamma = c(0, 0.5),
  sig.lgamma = 3, mu.beta.lgamma = -1, sig.beta.lgamma = 3,
  range.mean.p = c(0.1, 0.9), sig.lp = 3, mu.beta.lp = 1, sig.beta.lp = 3,
  range.beta1.survey = c(-2, -0.5), range.beta2.survey = c(0, 2),
  trend.sd.site = c(0, 0), trend.sd.survey = c(0, 0), show.plot = TRUE))

# Not every occurring species will be detected
set.seed(1)
str(data &lt;- simDCM(nspecies = 200, nsites = 20, nsurveys = 2, nyears = 10,
  mean.psi1 = 0.1, sig.lpsi1 = 5,
  range.mean.phi = c(0.3, 0.3), sig.lphi = 5,
  range.mean.gamma = c(0.1, 0.1), sig.lgamma = 5,
  range.mean.p = c(0.1, 0.1), sig.lp = 5) )

# Pull out data from species 5
ysp5 &lt;- data$y[,,,5]

# Pull out data from year 1
yyr1 &lt;- data$y[,,1,]

</code></pre>

<hr>
<h2 id='simDemoDynocc'>
Simulate data under a demographic dynamic occupancy model
</h2><span id='topic+simDemoDynocc'></span>

<h3>Description</h3>

<p>Function to simulate detection/nondetection data under a variant of the demographic occupancy (or 'local survival') model of Roth &amp; Amrhein (2010). Data are simulated in an 'unconditional' manner, i.e., for each site from first to last year. All parameters can be made year-dependent by specification of a range within which annual values will be drawn from uniform distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDemoDynocc(nsites = 100, nyears = 10, nvisits = 5, psi1 = 0.6,
    range.phi = c(0.2, 0.9), range.r = c(0, 0.4), range.p = c(0.1, 0.9),
    show.plot=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simDemoDynocc_+3A_nsites">nsites</code></td>
<td>

<p>Number of sites.
</p>
</td></tr>
<tr><td><code id="simDemoDynocc_+3A_nyears">nyears</code></td>
<td>

<p>Number of years (or 'seasons', as they are somewhat confusingly often called in the occupancy literature).
</p>
</td></tr>
<tr><td><code id="simDemoDynocc_+3A_nvisits">nvisits</code></td>
<td>

<p>Number of replicate surveys (= occasions) within a year.
</p>
</td></tr>
<tr><td><code id="simDemoDynocc_+3A_psi1">psi1</code></td>
<td>

<p>occupancy probability in first year.
</p>
</td></tr>
<tr><td><code id="simDemoDynocc_+3A_range.phi">range.phi</code></td>
<td>

<p>bounds of uniform distribution from which annual local probability of persistence is randomly drawn.
</p>
</td></tr>
<tr><td><code id="simDemoDynocc_+3A_range.r">range.r</code></td>
<td>

<p>bounds of uniform distribution from which annual local probability of colonization is randomly drawn.
</p>
</td></tr>
<tr><td><code id="simDemoDynocc_+3A_range.p">range.p</code></td>
<td>

<p>bounds of uniform distribution from which annual probability of detection is randomly drawn.
</p>
</td></tr>
<tr><td><code id="simDemoDynocc_+3A_show.plot">show.plot</code></td>
<td>

<p>If TRUE, plots of results are displayed; set to FALSE if running simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments input and the following additional elements:
</p>
<table>
<tr><td><code>phi</code></td>
<td>
<p>persistence for each interval, a vector of length nyears - 1</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>colonization for each interval, a vector of length nyears - 1</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>detection probability for each year, a vector of length nyears</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>true occurrence state, a nsites x nyears matrix of 0/1</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the observed detection history, a nsites x nvisits x nyears array</p>
</td></tr>
<tr><td><code>f</code></td>
<td>
<p>year of first detection, a vector of length nsites</p>
</td></tr>
<tr><td><code>nocc.true</code></td>
<td>
<p>the true number of occupied sites, a vector of length nyears</p>
</td></tr>
<tr><td><code>nocc.true</code></td>
<td>
<p>the observed number of occupied sites, a vector of length nyears</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Roth, T. &amp; Amrhein, V. (2010), Estimating individual survival using territory occupancy data on unmarked animals. <em>Journal of Applied Ecology</em>, 47, 386-392.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure:
str(data &lt;- simDemoDynocc() )                # Implicit defaults
str(data &lt;- simDemoDynocc(psi1 = 1))         # All sites initially occupied
str(data &lt;- simDemoDynocc(nsites = 1000))    # Plenty more sites
str(data &lt;- simDemoDynocc(nyears = 100))     # Plenty more years
str(data &lt;- simDemoDynocc(nvisits = 20))     # Plenty more visits
str(data &lt;- simDemoDynocc(range.phi = c(0.8, 0.8))) # Constant survival
str(data &lt;- simDemoDynocc(range.phi = c(0.2,0.3), range.r = c(0,0.2))) # Decline
str(data &lt;- simDemoDynocc(range.phi = c(0.8,1), range.r = c(0.5,0.7))) # Increase
str(data &lt;- simDemoDynocc(nvisits = 1))      # Single visit
str(data &lt;- simDemoDynocc(range.p = c(1,1))) # Perfect detection
</code></pre>

<hr>
<h2 id='simDM'>
Simulate count data under the dynamic N-mixture model of Dail-Madsen
</h2><span id='topic+simDM'></span><span id='topic+simDM0'></span>

<h3>Description</h3>

<p>Simulation for multiple-visit data (from <code><a href="unmarked.html#topic+pcountOpen">pcountOpen</a></code> help file in package <span class="pkg">unmarked</span>). <code>simDM0</code> has no covariates while <code>simDM</code> allows for covariates. Both functions assume constant time intervals between primary periods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDM0(nsites = 50, nsurveys = 3, nyears = 5,
  lambda = 4, gamma = 1.5, phi = 0.8, p = 0.7, show.plots=TRUE)

simDM(nsites = 50, nsurveys = 3, nyears = 5,
  mean.lambda = 4, mean.gamma.rel = 0.5,
  mean.phi = 0.8, mean.p = 0.7,
  beta.lam = 1, beta.gamma = 1, beta.phi = -1, beta.p = -1,
  show.plots=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simDM_+3A_nsites">nsites</code></td>
<td>

<p>number of sites.
</p>
</td></tr>
<tr><td><code id="simDM_+3A_nsurveys">nsurveys</code></td>
<td>

<p>number of replicate (secondary) samples within period of closure.
</p>
</td></tr>
<tr><td><code id="simDM_+3A_nyears">nyears</code></td>
<td>

<p>number of primary samples: years, seasons etc.
</p>
</td></tr>
<tr><td><code id="simDM_+3A_lambda">lambda</code></td>
<td>

<p>Initial expected abundance.
</p>
</td></tr>
<tr><td><code id="simDM_+3A_gamma">gamma</code></td>
<td>

<p>recruitment rate.
</p>
</td></tr>
<tr><td><code id="simDM_+3A_phi">phi</code></td>
<td>

<p>apparent survival rate.
</p>
</td></tr>
<tr><td><code id="simDM_+3A_p">p</code></td>
<td>

<p>detection probability.
</p>
</td></tr>
<tr><td><code id="simDM_+3A_mean.lambda">mean.lambda</code></td>
<td>

<p>Initial expected abundance at cov.lam = 0.
</p>
</td></tr>
<tr><td><code id="simDM_+3A_mean.gamma.rel">mean.gamma.rel</code></td>
<td>

<p>recruitment rate at cov.gamma = 0.
</p>
</td></tr>
<tr><td><code id="simDM_+3A_mean.phi">mean.phi</code></td>
<td>

<p>apparent survival rate at cov.phi = 0.
</p>
</td></tr>
<tr><td><code id="simDM_+3A_mean.p">mean.p</code></td>
<td>

<p>detection probability at cov.p = 0.
</p>
</td></tr>
<tr><td><code id="simDM_+3A_beta.lam">beta.lam</code></td>
<td>

<p>the slope of parameter lambda (link transformed) on the cov.lam covariate
</p>
</td></tr>
<tr><td><code id="simDM_+3A_beta.gamma">beta.gamma</code></td>
<td>

<p>the slope of parameter gamma (link transformed) on the cov.gamma covariate
</p>
</td></tr>
<tr><td><code id="simDM_+3A_beta.phi">beta.phi</code></td>
<td>

<p>the slope of parameter phi (link transformed) on the cov.phi covariate
</p>
</td></tr>
<tr><td><code id="simDM_+3A_beta.p">beta.p</code></td>
<td>

<p>the slope of parameter p (link transformed) on the cov.p covariate
</p>
</td></tr>
<tr><td><code id="simDM_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, plots are produced. Set this to FALSE when running simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>simDM0</code>, a list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>true number of individuals, nsites x nyears</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>number of survivors, nsites x (nyears-1)</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>number of recruits, nsites x (nyears-1)</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>number detected, nsites x nyears x nsurveys</p>
</td></tr>
<tr><td><code>yy</code></td>
<td>
<p>number detected as a matrix, nsites x (nyears*nsurveys)</p>
</td></tr>
</table>
<p><code>simDM</code> has the following additional elements:
</p>
<table>
<tr><td><code>cov.lam</code></td>
<td>
<p>covariate for lambda generated from Uniform(-1, 1), nsites vector</p>
</td></tr>
<tr><td><code>cov.gamma</code></td>
<td>
<p>covariate for gamma generated from Uniform(-1, 1), nsites vector</p>
</td></tr>
<tr><td><code>cov.phi</code></td>
<td>
<p>covariate for phi generated from Uniform(-1, 1), nsites vector</p>
</td></tr>
<tr><td><code>cov.p</code></td>
<td>
<p>covariate for p generated from Uniform(-1, 1), nsites x nyears x nsurveys</p>
</td></tr>
<tr><td><code>ccov.p</code></td>
<td>
<p>cov.p formatted as a matrix, nsites x (nyears*nsurveys)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle, based in part on code written by Richard Chandler.
</p>


<h3>References</h3>

<p>Dail, D. &amp; Madsen, L. (2011) Models for estimating abundance from repeated counts of an open metapopulation. <em>Biometrics</em>, 67, 577-587.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 2.5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a data set with the default arguments and look at the structure of the output:
tmp0 &lt;- simDM0()
str(tmp0)

tmp &lt;- simDM()
str(tmp)

</code></pre>

<hr>
<h2 id='simDSM'>
Simulate line transect data for density surface modeling
</h2><span id='topic+simDSM'></span>

<h3>Description</h3>

<p>The function generates a population represented as a binomial point pattern in a heterogeneous landscape with density a function of the covariate Habitat. Data for multiple line transect surveys using a wiggly transect are then simulated, and the pixel IDs for the activity centers of detected individuals returned.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDSM(X, Ntotal = 400, sigma = 0.65, beta1 = 1.0,
    nsurveys = 2, xlim = c(-0.5, 3.5), ylim = c(-0.5, 4.5), show.plots = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simDSM_+3A_x">X</code></td>
<td>

<p>a 2-column matrix with coordinates of regularly spaced points along the transect line; see Examples.
</p>
</td></tr>
<tr><td><code id="simDSM_+3A_ntotal">Ntotal</code></td>
<td>

<p>the true total number of individuals in the study area.
</p>
</td></tr>
<tr><td><code id="simDSM_+3A_sigma">sigma</code></td>
<td>

<p>scale parameter for the half-normal detection function.
</p>
</td></tr>
<tr><td><code id="simDSM_+3A_beta1">beta1</code></td>
<td>

<p>coefficient for the relationship between the Habitat covariate and population density.
</p>
</td></tr>
<tr><td><code id="simDSM_+3A_nsurveys">nsurveys</code></td>
<td>

<p>the number of replicate surveys along the transect.
</p>
</td></tr>
<tr><td><code id="simDSM_+3A_xlim">xlim</code>, <code id="simDSM_+3A_ylim">ylim</code></td>
<td>

<p>the extent of the (rectangular) study area
</p>
</td></tr>
<tr><td><code id="simDSM_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, summary plots are displayed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>Habitat</code></td>
<td>
<p>a vector for the habitat covariate for each pixel</p>
</td></tr>
<tr><td><code>Habgrid</code></td>
<td>
<p>a 2-column matrix with the coordinates of center of each pixel</p>
</td></tr>
<tr><td><code>nPix</code></td>
<td>
<p>the number of pixels in the study area</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>true number of activity centers in each pixel</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>a 2-column matrix with the locations of ACs for all individuals in the population</p>
</td></tr>
<tr><td><code>Ucap</code></td>
<td>
<p>a 2-column matrix with the locations of ACs for individuals detected at least once</p>
</td></tr>
<tr><td><code>nind</code></td>
<td>
<p>the number of individuals detected at least once</p>
</td></tr>
<tr><td><code>pixel</code></td>
<td>
<p>a nind x nsurvey matrix with the pixel ID for the activity center or NA if the individual was not detected on the survey</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry, Andy Royle &amp; Mike Meredith
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 11.10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run the function with default values and look at the output
library(AHMbook)
data(wigglyLine)
points &lt;- sp::SpatialPoints( wigglyLine )
sLine &lt;- sp::Line(points)
regpoints &lt;- sp::spsample(sLine, 100, type = "regular")
str(simDSM(X = regpoints@coords))

# Generate the data set used in AHM2 11.10
RNGversion("3.5.3")
set.seed(2027, kind = "Mersenne-Twister")
tmp &lt;- simDSM(X = regpoints@coords) # Produces Fig 11.15 in the book
</code></pre>

<hr>
<h2 id='simDynocc'>
Simulate detection/nondetection data under a wide variety of non-spatial dynamic occupancy models
</h2><span id='topic+simDynocc'></span>

<h3>Description</h3>

<p>Function to simulate detection/nondetection data under a general dynamic site-occupancy model, including:
</p>
<p>* Annual variation in the probabilities of patch persistence, colonization and detection is specified by the bounds of a uniform distribution.
</p>
<p>* One covariate is allowed to affect each parameter: a site covariate for psi1, site-by-year covariates for phi and gamma, and an observational covariate for p. Covariates are generated internally from uniform(-2, 2) distributions.
</p>
<p>* Additional heterogeneity among sites in persistence and colonization or both.
</p>
<p>* Additional detection heterogeneity at the site-, the survey, or the site-by-survey level, with the possibility of a temporal trend in this heterogeneity over the years. E.g., an annual trend in detection heterogeneity at the site or the survey level is specified by the first and second value, which correspond to the heterogeneity in the first and the last year. Hence, trend.sd.site = c(0, 1) will result in a linear trend in the magnitude of site heterogeneity in detection from 0 in the first year to 1 in the last year.
</p>
<p>* Additional detection heterogeneity that varies over the survey (= occasion) according to a quadratic effect of occasion number (to model the typical phenology of an insect species for instance).
</p>
<p>* Simulation of data under a BACI (before-after-control-impact) design, where some event happens in a given year and <em>reduces</em> phi or gamma by a stated percentage (only reductions, no increases allowed!)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDynocc(nsites = 250, nyears = 10, nsurveys = 3, year.of.impact = NA,
  mean.psi1 = 0.4, beta.Xpsi1 = 0,
  range.phi = c(0.5, 1), sd.lphi.site = 0, impact.phi = 0, beta.Xphi = 0,
  range.gamma = c(0, 0.5), sd.lgamma.site = 0, impact.gamma = 0, beta.Xgamma = 0,
  sd.lphi.lgamma.site = 0,
  range.p = c(0.1, 0.9), beta.Xp = 0,
  range.beta1.survey = c(0, 0), range.beta2.survey = c(0, 0),
  trend.sd.site = c(0, 0), trend.sd.survey = c(0, 0),
  trend.sd.site.survey = c(0, 0), show.plots = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simDynocc_+3A_nsites">nsites</code></td>
<td>

<p>Number of sites.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_nyears">nyears</code></td>
<td>

<p>Number of years (or 'seasons').
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_nsurveys">nsurveys</code></td>
<td>

<p>Number of replicate surveys (= occasions) within a year.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_year.of.impact">year.of.impact</code></td>
<td>

<p>Year in which an impact happens that can affect phi and gamma (for BACI design), NA if no impact occurs; for the BACI design, <code>nyears</code> must be greater than 2, and year of impact cannot be the first or last year.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_mean.psi1">mean.psi1</code></td>
<td>

<p>average occupancy probability in first year.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_beta.xpsi1">beta.Xpsi1</code></td>
<td>

<p>coefficient of environmental covariate in probability of initial occupancy.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_range.phi">range.phi</code></td>
<td>

<p>bounds of uniform distribution from which annual probability of persistence is randomly drawn.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_sd.lphi.site">sd.lphi.site</code></td>
<td>
  
<p>SD of random site effect on persistence on the logit scale drawn from a normal distribution with mean zero.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_impact.phi">impact.phi</code></td>
<td>

<p>negative effect in percent on annual phi (e.g., impact.phi = 20 means a 20% reduction in phi); ignored if <code>year.of.impact = NA</code>.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_beta.xphi">beta.Xphi</code></td>
<td>

<p>coefficients of environmental covariate in probability of persistence.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_range.gamma">range.gamma</code></td>
<td>

<p>bounds of uniform distribution from which annual probability of colonization is randomly drawn.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_sd.lgamma.site">sd.lgamma.site</code></td>
<td>
  
<p>SD of random site effect on colonization on the logit scale drawn from a normal distribution with mean zero.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_impact.gamma">impact.gamma</code></td>
<td>

<p>negative effect in percent on annual gamma (e.g., impact.gamma = 20 means a 20% reduction in gamma); ignored if <code>year.of.impact = NA</code>.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_beta.xgamma">beta.Xgamma</code></td>
<td>

<p>coefficient of environmental covariate in probability of colonization.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_sd.lphi.lgamma.site">sd.lphi.lgamma.site</code></td>
<td>
  
<p>SD of random site effect on persistence AND colonization on the logit scale drawn from a normal distribution with mean zero.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_range.p">range.p</code></td>
<td>

<p>bounds of uniform distribution from which annual probability of detection is randomly drawn.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_beta.xp">beta.Xp</code></td>
<td>

<p>coefficients of environmental covariate in probability of detection.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_range.beta1.survey">range.beta1.survey</code></td>
<td>
 
<p>bounds of the uniform distribution from which the annual variation in the linear effect of the survey occasion (i.e., of survey 1-12 with <code>nsurveys = 12</code>) on detection (= product of availability and perceptibility) is randomly drawn.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_range.beta2.survey">range.beta2.survey</code></td>
<td>
 
<p>the same for the quadratic effect of survey occasion.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_trend.sd.site">trend.sd.site</code></td>
<td>

<p>initial and final values of sd of normal distribution to model logit-normal noise in p at the site level; a linear trend is assumed over time; if the two values are the same, a constant value is assumed.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_trend.sd.survey">trend.sd.survey</code></td>
<td>

<p>initial and final values of sd of normal distribution to model logit-normal noise in p <em>only</em> at the 'survey' level; if they are different, a linear trend is assumed over time.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_trend.sd.site.survey">trend.sd.site.survey</code></td>
<td>

<p>initial and final values of sd of normal distribution to model logit-normal noise in p at the site/year/survey = ‘survey’ level; if they are different, a linear trend is assumed over time.
</p>
</td></tr>
<tr><td><code id="simDynocc_+3A_show.plots">show.plots</code></td>
<td>

<p>If TRUE, plots of results are displayed; set to FALSE if running simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments input and the following additional elements:
</p>
<table>
<tr><td><code>impact</code></td>
<td>
<p>a 0/1 vector of length (nyears-1) indicating if an impact applies to the interval</p>
</td></tr>
<tr><td><code>BACI.effect.phi</code></td>
<td>
<p>reduction in persistence due to impact, a vector of length nyears - 1</p>
</td></tr>
<tr><td><code>BACI.effect.gamma</code></td>
<td>
<p>reduction in colonization due to impact, a vector of length nyears - 1</p>
</td></tr>
<tr><td><code>beta1</code></td>
<td>
<p>linear effect of occasion on the product of availability and detection, a vector of length nyears</p>
</td></tr>
<tr><td><code>beta2</code></td>
<td>
<p>quadratic effect of occasion on the product of availability and detection, a vector of length nyears</p>
</td></tr>
<tr><td><code>mean.phi</code></td>
<td>
<p>mean persistence for each interval before application of any BACI effect, a vector of length nyears - 1</p>
</td></tr>
<tr><td><code>mean.gamma</code></td>
<td>
<p>mean colonization for each interval before application of any BACI effect, a vector of length nyears - 1</p>
</td></tr>
<tr><td><code>mean.p</code></td>
<td>
<p>mean detection probability for each year, a vector of length nyears</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>annual occupancy for each site, a nsites x nyears matrix</p>
</td></tr>
<tr><td><code>mean.psi</code></td>
<td>
<p>average occupancy over sites, a vector of length nyears</p>
</td></tr>
<tr><td><code>n.occ</code></td>
<td>
<p>number of occupied sites, a vector of length nyears</p>
</td></tr>
<tr><td><code>psi.fs</code></td>
<td>
<p>finite-sample occupancy proportion, a vector of length nyears</p>
</td></tr>
<tr><td><code>psi.app</code></td>
<td>
<p>apparent occupancy over sites, a vector of length nyears</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>true occurrence state, a nsites x nyears matrix of 0/1</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>persistence, a nsites x nyears-1 matrix</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>colonization, a nsites x nyears-1 matrix</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>detection probability, a nsites x nsurveys x nyears array</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the observed detection history, a nsites x nsurveys x nyears array</p>
</td></tr>
<tr><td><code>Xpsi1</code></td>
<td>
<p>covariate affecting initial occupancy, a vector of length nsites</p>
</td></tr>
<tr><td><code>Xphi</code></td>
<td>
<p>covariate affecting persistence, a nsites x nyears matrix</p>
</td></tr>
<tr><td><code>Xgamma</code></td>
<td>
<p>covariate affecting colonization, a nsites x nyears matrix</p>
</td></tr>
<tr><td><code>Xp</code></td>
<td>
<p>covariate affecting probability of detection, a nsites x nsurveys x nyears array</p>
</td></tr>
<tr><td><code>eps.lphi.site</code></td>
<td>
<p>site random effects on persistence, a vector of length nsites</p>
</td></tr>
<tr><td><code>eps.lgamma.site</code></td>
<td>
<p>site random effects on colonization, a vector of length nsites</p>
</td></tr>
<tr><td><code>eps.lphi.lgamma.site</code></td>
<td>
<p>site random effects on persistence and colonization, a vector of length nsites</p>
</td></tr>
<tr><td><code>eps1</code></td>
<td>
<p>site random effects on detection, a vector of length nsites</p>
</td></tr>
<tr><td><code>eps2</code></td>
<td>
<p>the survey random effects on detection, a vector of length nsurveys</p>
</td></tr>
<tr><td><code>eps3</code></td>
<td>
<p>the site/survey/year random effects on detection, a nsites x nsurveys x nyears array</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure
tmp &lt;- simDynocc()
str(tmp)

# no annual variation in the parameters
str(data &lt;- simDynocc(nsites = 250, nsurveys = 3, nyears = 10, mean.psi1 = 0.6,
    range.phi = c(0.7, 0.7), range.gamma = c(0.3, 0.3), range.p = c(0.5, 0.5)))
# a fully time-dependent model (with p constant within each primary period)
str(data &lt;- simDynocc(mean.psi1 = 0.6, range.phi = c(0.5, 0.8),
   range.gamma = c(0.1, 0.5), range.p = c(0.1, 0.9)) )
# a time-constant model with four different covariates affecting the four parameters
str(data &lt;- simDynocc(mean.psi1 = 0.6, beta.Xpsi1 = 1,
  range.phi = c(0.6, 0.6), beta.Xphi = 2, range.gamma = c(0.3, 0.3),
  beta.Xgamma = 2, range.p = c(0.2, 0.2), beta.Xp = -2) )
# seasonal variation in detection probability
str(data &lt;- simDynocc(nsurveys = 12, mean.psi1 = 0.6,
  range.phi = c(0.6, 0.6), range.gamma = c(0.3, 0.3),
  range.p = c(0.5, 0.5), range.beta1.survey = c(-0.3, 0.4),
  range.beta2.survey = c(0, -0.7)) )
# now both yearly variation and effects of all covariates (including survey)
str( data &lt;- simDynocc(mean.psi1 = 0.6, beta.Xpsi1 = 1,
   range.phi = c(0.6, 1), beta.Xphi = 2, range.gamma = c(0, 0.2),
   beta.Xgamma = 2, range.p = c(0.1, 0.9), beta.Xp = -2,
   range.beta1.survey = c(-0.4, 0.5), range.beta2.survey = c(0, -0.8)) )

# To add detection heterogeneity at the site level, you can do this:
str(data &lt;- simDynocc(trend.sd.site = c(3, 3)) ) # No time trend
str(data &lt;- simDynocc(trend.sd.site = c(1, 3)) ) # With time trend

# To add detection heterogeneity at the level of the survey, you can do this:
str(data &lt;- simDynocc(trend.sd.survey = c(3, 3)) ) # No time trend
str(data &lt;- simDynocc(trend.sd.survey = c(1, 3)) ) # With time trend

# To add detection heterogeneity at the level of the individual visit, you can do this:
str(data &lt;- simDynocc(trend.sd.site.survey = c(3, 3)) ) # No trend
str(data &lt;- simDynocc(trend.sd.site.survey = c(1, 3)) ) # With trend

# To simulate data under a BACI design, where an impact happens in year 10
str(data &lt;- simDynocc(nsites = 250, nsurveys = 3, nyears = 20, year.of.impact = 10,
   impact.phi = 80, impact.gamma = 50) )

# And data where there is no detection error (i.e., with p = 1):
str( data &lt;- simDynocc(range.p = c(1, 1)) )

</code></pre>

<hr>
<h2 id='simDynoccSpatial'>
Simulate data under a dynamic occupancy model with spatial autocorrelation
</h2><span id='topic+simDynoccSpatial'></span>

<h3>Description</h3>

<p>Function to simulate detection/nondetection data under a general dynamic site-occupancy model with autocorrelation, including:
</p>
<p>* Annual variation in the probabilities of patch persistence, colonization and detection is specified by the bounds of a uniform distribution.
</p>
<p>* One covariate is allowed to affect a parameter: a site covariate for psi1, site-by-year covariates for phi and gamma, and an observational covariate for p. Covariates are generated internally from uniform(-2, 2) distributions.
</p>
<p>* Additional heterogeneity among sites in persistence and colonization or both.
</p>
<p>* Additional detection heterogeneity at the site or survey level, with the possibility of a temporal trend in this heterogeneity over the years. E.g., an annual trend in detection heterogeneity at the site or the survey level is specified by the first and second value, which correspond to the heterogeneity in the first and the last year. Hence, trend.sd.site = c(0, 1) will result in a linear trend in the magnitude of site heterogeneity in detection from 0 in the first year to 1 in the last year.
</p>
<p>* A single, spatially structured covariate for habitat suitability may affect all parameters via coefficient beta.XAC; for a biologically reasonable way, choose coefficients with the same sign for all 4 (mediated by underlying density). That spatial covariate is simulated as a Gaussian random field with negative exponential correlation function with 'range parameter' theta.XAC.
</p>
<p>* Autologistic effects (beta.Xautolog) in persistence and colonization probability can be chosen, which fits a logistic regression of these parameters on the proportion of occupied neighboring cells (in a queen's or 2nd order neighborhood) during the previous time step.
</p>
<p>* Additional detection heterogeneity can be introduced at the site- or the individual survey level, with the possibility of a temporal trend in this heterogeneity. For instance, an annual trend in detection heterogeneity at the site or the survey level is specified by the value in the first and the last year. Hence, trend.sd.site = c(0, 1) will result in a linear trend in the magnitude of site heterogeneity in detection from 0 in the first year to 1 in the last year.
</p>
<p>Previous versions used <span class="pkg">RandomFields</span>, but that is not currently available on CRAN. <span class="pkg">fields</span> is now used instead, but it cannot deal with large values of <code>side</code> and <code>theta.XAC</code>. If you have <span class="pkg">RandomFields</span> installed (perhaps by getting it from the CRAN archive), you can load a version of <code>simDynoccSpatial</code> that supports it with <code>source(system.file("RandomFieldsSupport", "simDynoccSpatial.R", package="AHMbook"))</code>.
</p>
<p>See also <code><a href="#topic+simDynoccSpatialData">simDynoccSpatialData</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simDynoccSpatial(side = 50, nyears = 10, nsurveys = 3,
      mean.psi1 = 0.4, beta.Xpsi1 = 0,
      range.phi = c(0.8, 0.8), beta.Xphi = 0,
      range.gamma = c(0.1, 0.1), beta.Xgamma = 0,
      range.p = c(0.4, 0.4), beta.Xp = 0,
      theta.XAC = 5000, beta.XAC = c(0, 0, 0, 0), beta.Xautolog = c(0, 0),
      trend.sd.site = c(0, 0), trend.sd.survey = c(0, 0),
      seed.XAC = NA, seed = NULL, show.plots = TRUE, ask.plot = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simDynoccSpatial_+3A_side">side</code></td>
<td>

<p>side length of square simulation area; the number of sites, or cells, M = side^2.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_nyears">nyears</code></td>
<td>

<p>Number of years (or 'seasons').
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_nsurveys">nsurveys</code></td>
<td>

<p>Number of replicate surveys (= occasions) within a year.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_mean.psi1">mean.psi1</code></td>
<td>

<p>average occupancy probability in first year.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_beta.xpsi1">beta.Xpsi1</code></td>
<td>

<p>coefficient of environmental covariate in probability of initial occupancy.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_range.phi">range.phi</code></td>
<td>

<p>bounds of uniform distribution from which annual probability of persistence is randomly drawn.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_beta.xphi">beta.Xphi</code></td>
<td>

<p>coefficient of environmental covariate in probability of persistence.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_range.gamma">range.gamma</code></td>
<td>

<p>bounds of uniform distribution from which annual probability of colonization is randomly drawn.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_beta.xgamma">beta.Xgamma</code></td>
<td>

<p>coefficient of environmental covariate in probability of colonization.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_range.p">range.p</code></td>
<td>

<p>bounds of uniform distribution from which probability of detection is randomly drawn.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_beta.xp">beta.Xp</code></td>
<td>

<p>coefficient of environmental covariate in probability of detection.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_theta.xac">theta.XAC</code></td>
<td>

<p>'range parameter' of a covariate with exponential spatial correlation (i.e., a Gaussian random field is used as an environmental covariate); must be &gt; 0.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_beta.xac">beta.XAC</code></td>
<td>

<p>vector of coefficients of that field for the 4 model parameters: psi1, phi, gamma, and p (in that order).
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_beta.xautolog">beta.Xautolog</code></td>
<td>

<p>vector of coefficients of autologistic covariate in the following order: persistence (phi), colonization (gamma); the autocovariate is computed at every season as the proportion of occupied cells in a queen's neighborhood around each cell.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_trend.sd.site">trend.sd.site</code></td>
<td>

<p>initial and final values of sd of normal distribution to model logit-normal noise in p at the site level; a linear trend is assumed over time; if the two values are the same, a constant value is assumed.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_trend.sd.survey">trend.sd.survey</code></td>
<td>

<p>initial and final values of sd of normal distribution to model logit-normal noise in p at the 'survey' level; if they are different, a linear trend is assumed over time.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_seed.xac">seed.XAC</code></td>
<td>

<p>the seed to be used for simulation of the spatially structured covariate for habitat suitability.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_seed">seed</code></td>
<td>

<p>the seed to be used for simulation of values apart from the spatially structured covariate for habitat suitability; using the same value for seed.XAC with different values for seed allows generation of different data sets with the same habitat suitability covariate.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, summary plots are displayed.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_ask.plot">ask.plot</code></td>
<td>

<p>If TRUE, pause between plots of results; set to FALSE if running simulations.
</p>
</td></tr>
<tr><td><code id="simDynoccSpatial_+3A_verbose">verbose</code></td>
<td>

<p>if TRUE, output will be written to the console.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments input and the following additional elements:
</p>
<table>
<tr><td><code>M</code></td>
<td>
<p>scalar, total number of pixels in the study area, side^2</p>
</td></tr>
<tr><td><code>grid</code></td>
<td>
<p>2-column matrix, x and y coordinates of each pixel</p>
</td></tr>
<tr><td><code>amatrix</code></td>
<td>
<p>M x M matrix, [i,j] = 1 if cells i and j are neighbors, 0 otherwise</p>
</td></tr>
<tr><td><code>Xpsi1</code></td>
<td>
<p>side x side matrix, value of covariate affecting initial occupancy</p>
</td></tr>
<tr><td><code>Xphi</code></td>
<td>
<p>side x side x nyears array, value of covariate affecting persistence</p>
</td></tr>
<tr><td><code>Xgamma</code></td>
<td>
<p>side x side x nyears array, value of covariate affecting colonization</p>
</td></tr>
<tr><td><code>Xp</code></td>
<td>
<p>side x side x nsurveys x nyears array, value of covariate affecting detection</p>
</td></tr>
<tr><td><code>XAC</code></td>
<td>
<p>side x side matrix, the spatially correlated covariate</p>
</td></tr>
<tr><td><code>Xauto</code></td>
<td>
<p>side x side x nyears array, the autocovariate, the proportion of neighboring cells occupied</p>
</td></tr>
<tr><td><code>Xautoobs</code></td>
<td>
<p>side x side x nyears array, the observed autocovariate, the proportion of neighboring cells where the species was detected</p>
</td></tr>
<tr><td><code>sd.site</code></td>
<td>
<p>vector nyears, year-specific values of SD of Gaussian random site effects in p</p>
</td></tr>
<tr><td><code>sd.survey</code></td>
<td>
<p>vector nyears, year-specific values of SD of Gaussian random survey effects in p</p>
</td></tr>
<tr><td><code>mean.phi</code></td>
<td>
<p>vector nyears-1, mean persistence for each interval</p>
</td></tr>
<tr><td><code>mean.gamma</code></td>
<td>
<p>vector nyears-1, mean colonization for each interval</p>
</td></tr>
<tr><td><code>mean.p</code></td>
<td>
<p>vector nyears, mean detection probability for each year</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>side x side x nyears array, probability of occupancy for each site and year</p>
</td></tr>
<tr><td><code>mean.psi</code></td>
<td>
<p>vector nyears, mean occupancy over cells for each year</p>
</td></tr>
<tr><td><code>psi.app</code></td>
<td>
<p>vector nyears, apparent occupancy, proportion of cells where species detected</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>side x side x years array, true occupancy state</p>
</td></tr>
<tr><td><code>zobs</code></td>
<td>
<p>side x side x years array, observed occupancy state</p>
</td></tr>
<tr><td><code>nocc</code></td>
<td>
<p>vector nyears, true number of occupied cells</p>
</td></tr>
<tr><td><code>nocc.obs</code></td>
<td>
<p>vector nyears, number of cells where the species was detected</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>side x side x nyears-1 array, probability of persistence in each interval between years</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>side x side x nyears-1 array, probability of colonization in each interval between years</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>side x side x nsurveys x nyears array, probability of detection</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>side x side x nsurveys x nyears array, the observed detection history</p>
</td></tr>
<tr><td><code>umf</code></td>
<td>
<p>an unmarked data frame object with the simulated data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 9.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure
try(str(simDynoccSpatial()))  # Fails if RandomFields is not available

str(simDynoccSpatial(side=50, theta.XAC=1))

</code></pre>

<hr>
<h2 id='simDynoccSpatialData'>
Simulated data from <code>simDynoccSpatial</code> for AHM2 section 9.6.1.2 (page 564)
</h2><span id='topic+simDynoccSpatialData'></span>

<h3>Description</h3>

<p>The data analyzed in Kéry &amp; Royle (2021) section 9.6.1.2 was generated using <code>simDynoccSpatial</code> with the <span class="pkg">RandomFields</span> package. That data set cannot be generated if  <span class="pkg">RandomFields</span> is not available. This provides a data set to use with the code in that section.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simDynoccSpatialData)</code></pre>


<h3>Format</h3>

<p>A list with 45 elements. See the Value section in <code><a href="#topic+simDynoccSpatial">simDynoccSpatial</a></code> for details.
</p>


<h3>Details</h3>

<p>The data set was generated on a machine with <span class="pkg">RandomFields</span> installed, using the following code:
</p>
<p><code>
  source(system.file("RandomFieldsSupport", "simDynoccSpatial.R", package="AHMbook"))
  simDynoccSpatialData &lt;- simDynoccSpatial(side = 30, nyears = 10, nsurveys = 3, mean.psi1 = 0.1,
  range.phi = c(0.5, 0.5), range.gamma = c(0.2, 0.2), range.p = c(0.4, 0.4),
  beta.Xautolog = c(1, 1), seed.XAC = 1, seed = 24, ask.plot = TRUE)</code>
</p>


<h3>Source</h3>

<p>Simulated data.
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 section 9.6.1.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simDynoccSpatialData)
dat &lt;- simDynoccSpatialData
str(dat)
</code></pre>

<hr>
<h2 id='simExpCorrRF'>
Create a Gaussian random field with negative exponential correlation
</h2><span id='topic+simExpCorrRF'></span>

<h3>Description</h3>

<p>Function creates Gaussian random field with negative exponential correlation and visualizes correlation and random field.
</p>
<p>Previous versions used <span class="pkg">RandomFields</span>, but that is not currently available on CRAN. <span class="pkg">fields</span> is now used instead, but it cannot deal with large values of <code>size</code> and <code>theta</code>. If you have <span class="pkg">RandomFields</span> installed (perhaps by getting it from the CRAN archive), you can load a version of <code>simExpCorrRF</code> that supports it with <code>source(system.file("RandomFieldsSupport", "simExpCorrRF.R", package="AHMbook"))</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simExpCorrRF(variance = 1, theta = 1, size = 50, seed = NA, show.plots = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simExpCorrRF_+3A_variance">variance</code></td>
<td>

<p>variance of field.
</p>
</td></tr>
<tr><td><code id="simExpCorrRF_+3A_theta">theta</code></td>
<td>

<p>parameter governing spatial correlation (=1/phi) (&quot;large theta means high correlation&quot;) Note that RMexp (which is used internally) is specified in terms of phi = 1/theta.
</p>
</td></tr>
<tr><td><code id="simExpCorrRF_+3A_size">size</code></td>
<td>

<p>number of pixels along each side of the square site.
</p>
</td></tr>
<tr><td><code id="simExpCorrRF_+3A_seed">seed</code></td>
<td>

<p>used to generate reproducible output.
</p>
</td></tr>
<tr><td><code id="simExpCorrRF_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, the result will be displayed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>field</code></td>
<td>
<p>the random field variable, a vector of length size^2</p>
</td></tr>
<tr><td><code>grid</code></td>
<td>
<p>the grid corresponding to field</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 9.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run the function with default values and look at the output
str(tmp &lt;- simExpCorrRF())
</code></pre>

<hr>
<h2 id='simFrogDisease'>
Simulate detection data for diseased frogs
</h2><span id='topic+simFrogDisease'></span>

<h3>Description</h3>

<p>Simulates detection data for an amphibian species affected by the fungal pathogen <em>Batrachochytrium dendrobatidis</em> (Lips et al., 2006). Surveys are carried out on  multiple occasions each year. Observers count frogs and record whether they were infected or not. Over time, individuals are subject to mortality and there may also be recruitment of new individuals into the population. Individuals transition between the two states: infected frogs may become uninfected (i.e., can shed the fungus) and vice versa. It also seems reasonable to expect that survival probability differs between the two states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simFrogDisease(nsites = 100, nyears = 3, nsurveys = 3, alpha.lam = 3,
    omega = c(0.9, 0.7), gamma = c(2,1), p = c(0.8, 0.8, 0.8),
    recovery = 0.1, infection = 0.1)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simFrogDisease_+3A_nsites">nsites</code></td>
<td>

<p>the number of sites surveyed.
</p>
</td></tr>
<tr><td><code id="simFrogDisease_+3A_nyears">nyears</code></td>
<td>

<p>the number of years of the study.
</p>
</td></tr>
<tr><td><code id="simFrogDisease_+3A_nsurveys">nsurveys</code></td>
<td>

<p>the number of surveys each year.
</p>
</td></tr>
<tr><td><code id="simFrogDisease_+3A_alpha.lam">alpha.lam</code></td>
<td>

<p>mean abundance per site in the first year.
</p>
</td></tr>
<tr><td><code id="simFrogDisease_+3A_omega">omega</code></td>
<td>

<p>vector length 2, state-specific survival, noninfected and infected.
</p>
</td></tr>
<tr><td><code id="simFrogDisease_+3A_gamma">gamma</code></td>
<td>

<p>vector length 2, state-specific recruitment, noninfected and infected.
</p>
</td></tr>
<tr><td><code id="simFrogDisease_+3A_p">p</code></td>
<td>

<p>vector length <code>nyears</code>, probability of detection of individuals.
</p>
</td></tr>
<tr><td><code id="simFrogDisease_+3A_recovery">recovery</code></td>
<td>

<p>probability of recovery for an infected frog.
</p>
</td></tr>
<tr><td><code id="simFrogDisease_+3A_infection">infection</code></td>
<td>

<p>probability of infection for a noninfected frog.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments and the following additional elements:
</p>
<table>
<tr><td><code>SN</code></td>
<td>
<p>sites x intervals, number of noninfected frogs surviving</p>
</td></tr>
<tr><td><code>SI</code></td>
<td>
<p>sites x intervals, number of infected frogs surviving</p>
</td></tr>
<tr><td><code>GN</code></td>
<td>
<p>sites x intervals, number of noninfected frogs recruited</p>
</td></tr>
<tr><td><code>GI</code></td>
<td>
<p>sites x intervals, number of infected frogs recruited</p>
</td></tr>
<tr><td><code>TrI</code></td>
<td>
<p>sites x intervals, number of infected frogs recovering</p>
</td></tr>
<tr><td><code>TrN</code></td>
<td>
<p>sites x intervals, number of noninfected frogs becoming infected</p>
</td></tr>
<tr><td><code>NN</code></td>
<td>
<p>sites x years, number of noninfected frogs at each site</p>
</td></tr>
<tr><td><code>NI</code></td>
<td>
<p>sites x years, number of infected frogs at each site</p>
</td></tr>
<tr><td><code>yN</code></td>
<td>
<p>sites x years x surveys, number of noninfected frogs detected</p>
</td></tr>
<tr><td><code>yI</code></td>
<td>
<p>sites x years x surveys, number of infected frogs detected</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry and Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 2.9.1.
</p>
<p>Lips, K.R., Brem, F., Brenes, R., Reeve, J.D., Alford, R.A., Voyles, J., et al., 2006. Emerging infectious disease and the loss of biodiversity in a Neotropical amphibian community. <em>Proc. Natl. Acad. Sci. USA</em>, 103, 3165-3170.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a simulated data set with default arguments and look at the structure:
tmp &lt;- simFrogDisease()
str(tmp)
</code></pre>

<hr>
<h2 id='simHDS'>
Simulate data under hierarchical distance sampling protocol (line or point)
</h2><span id='topic+simHDS'></span>

<h3>Description</h3>

<p>The function simulates hierarchical distance sampling (HDS) data under either a line or a point transect protocol. At each site, it works with a strip of width <code>B*2</code> (for line transects) or a circle of radius <code>B</code> inscribed in a square of side <code>B*2</code> (for point transects).
</p>
<p>The state process is simulated by first drawing a covariate value, &quot;habitat&quot;, for each site from a Normal(0, 1) distribution. This is used in a log-linear regression with arguments <code>mean.lambda</code> and <code>beta.lam</code> to calculate the expected number of animals, lambda, in each strip or square.
</p>
<p>For line transects, the distance from the line is drawn from a Uniform(0, B) distribution. For point transects, the animals are distributed randomly over the square before calculating the distance of each from the point. Observations of animals further than B from the point are discarded.
</p>
<p>A detection covariate, &quot;wind&quot;, for each site is drawn from a Uniform(-2, 2) distribution. This is used in a log-linear regression with arguments <code>mean.sigma</code> and <code>beta.sig</code> to calculate the scale parameter, sigma, of the half-normal detection function. Detections are simulated as Bernoulli trials with probability of success decreasing with distance from the line or point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simHDS(type=c("line", "point"), nsites = 100, mean.lambda = 2, beta.lam = 1,
  mean.sigma = 1, beta.sig = -0.5, B = 3, discard0 = TRUE, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simHDS_+3A_type">type</code></td>
<td>

<p>type of transect, &quot;line&quot; or &quot;point&quot;.
</p>
</td></tr>
<tr><td><code id="simHDS_+3A_nsites">nsites</code></td>
<td>

<p>Number of sites (spatial replication)
</p>
</td></tr>
<tr><td><code id="simHDS_+3A_mean.lambda">mean.lambda</code></td>
<td>

<p>the expected value of lambda when the habitat covariate = 0; the intercept of the log-linear regression for lambda is log(mean.lambda).
</p>
</td></tr>
<tr><td><code id="simHDS_+3A_beta.lam">beta.lam</code></td>
<td>

<p>the slope of the log-linear regression for lambda on a habitat covariate.
</p>
</td></tr>
<tr><td><code id="simHDS_+3A_mean.sigma">mean.sigma</code></td>
<td>

<p>the expected value of the scale parameter of the half-normal detection function when the wind speed = 0; the intercept of the log-linear regression for sigma is log(mean.sigma).
</p>
</td></tr>
<tr><td><code id="simHDS_+3A_beta.sig">beta.sig</code></td>
<td>

<p>the slope of log-linear regression of scale parameter of the half-normal detection function on wind speed
</p>
</td></tr>
<tr><td><code id="simHDS_+3A_b">B</code></td>
<td>

<p>the strip half-width or circle radius
</p>
</td></tr>
<tr><td><code id="simHDS_+3A_discard0">discard0</code></td>
<td>

<p>If TRUE, subset to sites at which individuals were captured. You may or may not want to do this depending on how the model is formulated so be careful.
</p>
</td></tr>
<tr><td><code id="simHDS_+3A_show.plot">show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments entered and the following additional elements:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>simulated distance sampling data: a matrix with a row for each individual detected and 5 columns: site ID, status (1 if captured), x and y coordinates (NA for line transects), distance from the line or point; if <code>discard0 = FALSE</code>, sites with no detections will appear in the matrix with NAs in columns 2 to 5.</p>
</td></tr>
<tr><td><code>habitat</code></td>
<td>
<p>simulated habitat covariate</p>
</td></tr>
<tr><td><code>wind</code></td>
<td>
<p>simulated detection covariate</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>simulated number of individuals at each site</p>
</td></tr>
<tr><td><code>N.true</code></td>
<td>
<p>for point counts, the simulated number of individuals within the circle sampled</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 8.5.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a data set with the default arguments and look at the structure of the output
set.seed(123)
tmp &lt;- simHDS()
str(tmp)
head(tmp$data)

tmp &lt;- simHDS("point", discard0=FALSE)
str(tmp)
head(tmp$data, 10)
</code></pre>

<hr>
<h2 id='simHDSg'>
Simulate data under HDS protocol with groups
</h2><span id='topic+simHDSg'></span>

<h3>Description</h3>

<p>Simulates hierarchical distance sampling (HDS) data for groups under either a line or a point transect protocol and using a half-normal detection function (Buckland et al. 2001).
</p>
<p>At each site, it works with a strip of width <code>B*2</code> (for line transects) or a circle of radius <code>B</code> (for point transects).
</p>
<p>The state process is simulated by first drawing a covariate value, &quot;habitat&quot;, for each site from a Normal(0, 1) distribution. This is used in a log-linear regression with arguments <code>beta0</code> and <code>beta1</code> to calculate the expected number of groups in each strip or circle. Group size is simulated by first drawing from a Poisson distribution with parameter <code>lambda.group</code> then adding 1.
</p>
<p>For line transects, the distance from the line is drawn from a Uniform(0, B) distribution. For point transects, the distance from the point is simulated from B*sqrt(Uniform(0,1)), which ensures a uniform distribution over the circle.
</p>
<p>The group size is used in a log-linear regression with arguments <code>alpha0</code> and <code>alpha1</code> to calculate the scale parameter, sigma, of the half-normal detection function. Detections are simulated as Bernoulli trials with probability of success decreasing with distance from the line or point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simHDSg(type = c("line", "point"), nsites = 100, lambda.group = 0.75,
  alpha0 = 0, alpha1 = 0.5,
  beta0 = 1, beta1 = 0.5, B = 4, discard0 = TRUE, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simHDSg_+3A_type">type</code></td>
<td>

<p>The type of distance transect, either &quot;line&quot; or &quot;point&quot;.
</p>
</td></tr>
<tr><td><code id="simHDSg_+3A_nsites">nsites</code></td>
<td>

<p>Number of sites (spatial replication)
</p>
</td></tr>
<tr><td><code id="simHDSg_+3A_lambda.group">lambda.group</code></td>
<td>

<p>Poisson mean of group size
</p>
</td></tr>
<tr><td><code id="simHDSg_+3A_alpha0">alpha0</code></td>
<td>

<p>intercept of log-linear model relating sigma of the half-normal detection function to group size
</p>
</td></tr>
<tr><td><code id="simHDSg_+3A_alpha1">alpha1</code></td>
<td>

<p>slope of log-linear model relating sigma of the half-normal detection function to group size
</p>
</td></tr>
<tr><td><code id="simHDSg_+3A_beta0">beta0</code></td>
<td>

<p>intercept of log-linear model relating the Poisson mean of the number of groups per unit area to habitat
</p>
</td></tr>
<tr><td><code id="simHDSg_+3A_beta1">beta1</code></td>
<td>

<p>slope of log-linear model relating the Poisson mean of the number of groups per unit area to habitat
</p>
</td></tr>
<tr><td><code id="simHDSg_+3A_b">B</code></td>
<td>

<p>strip half width or the radius of the circle
</p>
</td></tr>
<tr><td><code id="simHDSg_+3A_discard0">discard0</code></td>
<td>

<p>whether to discard or keep the data from sites with nobody detected
</p>
</td></tr>
<tr><td><code id="simHDSg_+3A_show.plot">show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments entered and the following additional elements:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>simulated distance sampling data: a matrix with a row for each group detected and 6 columns: site ID, status (1 if captured), x and y coordinates (NA for line transects), distance from the line or point, group size; if <code>discard0 = FALSE</code>, sites with no detections will appear in the matrix with NAs in columns 2 to 6.</p>
</td></tr>
<tr><td><code>habitat</code></td>
<td>
<p>simulated habitat covariate</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>simulated number of groups at each site</p>
</td></tr>
<tr><td><code>N.true</code></td>
<td>
<p>for point counts, the simulated number of groups within the circle sampled</p>
</td></tr>
<tr><td><code>groupsize</code></td>
<td>
<p>group size for each of the groups observed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Buckland, S.T., et al (2001) <em>Introduction to distance sampling: estimating abundance of biological populations</em>. Oxford University Press, Oxford, UK.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 9.2.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run with the default arguments and look at the structure of the output:
set.seed(123)
tmp &lt;- simHDSg()
str(tmp)
head(tmp$data)

str(simHDSg(type = "line"))     # Defaults for line transect data
str(simHDSg(type = "point"))    # Defaults for point transect data
str(simHDSg(lambda.group = 5))  # Much larger groups
str(simHDSg(lambda.group = 5, alpha1 = 0)) # No effect of groups size on p
</code></pre>

<hr>
<h2 id='simHDSopen'>
Simulate open hierarchical distance sampling data
</h2><span id='topic+simHDSopen'></span>

<h3>Description</h3>

<p>Simulates distance sampling data for multiple replicate surveys in a multi-season (or multi-year) model, incorporating habitat and detection covariates, temporary emigration, and a trend in abundance or density.
</p>
<p>At each site, it works with a strip of width <code>B*2</code> (for line transects) or a circle of radius <code>B</code> (for point transects).
</p>
<p>The state process is simulated by first drawing a covariate value, &quot;habitat&quot;, for each site from a Normal(0, 1) distribution. This is used in a log-linear regression with arguments <code>mean.lam</code>, <code>beta.lam</code> and <code>beta.trend</code> to calculate the expected number of animals, lambda, in each strip or circle for each year. Site- and year-specific abundances are drawn from a Poisson distribution with mean lambda. The number available for capture at each replicate survey is simulated as a binomial distribution with probability <code>phi</code>.
</p>
<p>For line transects, the distance from the line is drawn from a Uniform(0, B) distribution. For point transects, the distance from the point is simulated from B*sqrt(Uniform(0,1)), which ensures a uniform distribution over the circle.
</p>
<p>A detection covariate, &quot;wind&quot;, for each survey is drawn from a Uniform(-2, 2) distribution. This is used in a log-linear regression with arguments <code>mean.sig</code> and <code>beta.sig</code> to calculate the scale parameter, sigma, of the half-normal detection function. Detections are simulated as Bernoulli trials with probability of success decreasing with distance from the line or point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simHDSopen(type=c("line", "point"), nsites = 100,
  mean.lam = 2, beta.lam = 0, mean.sig = 1, beta.sig = 0,
  B = 3, discard0 = TRUE, nreps = 2, phi = 0.7, nyears = 5, beta.trend = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simHDSopen_+3A_type">type</code></td>
<td>

<p>the transect protocol, either &quot;line&quot; or &quot;point&quot; .
</p>
</td></tr>
<tr><td><code id="simHDSopen_+3A_nsites">nsites</code></td>
<td>

<p>Number of sites (spatial replication)
</p>
</td></tr>
<tr><td><code id="simHDSopen_+3A_mean.lam">mean.lam</code></td>
<td>

<p>intercept of log-linear regression of expected lambda on a habitat covariate
</p>
</td></tr>
<tr><td><code id="simHDSopen_+3A_beta.lam">beta.lam</code></td>
<td>

<p>slope of log-linear regression of expected lambda on a habitat covariate
</p>
</td></tr>
<tr><td><code id="simHDSopen_+3A_mean.sig">mean.sig</code></td>
<td>

<p>intercept of log-linear regression of scale parameter of half-normal detection function on wind speed
</p>
</td></tr>
<tr><td><code id="simHDSopen_+3A_beta.sig">beta.sig</code></td>
<td>

<p>slope of log-linear regression of scale parameter of half-normal detection function on wind speed
</p>
</td></tr>
<tr><td><code id="simHDSopen_+3A_b">B</code></td>
<td>

<p>strip half width, or maximum distance from the observer for point counts
</p>
</td></tr>
<tr><td><code id="simHDSopen_+3A_discard0">discard0</code></td>
<td>

<p>Discard sites at which no individuals were captured. You may or may not want to do this depending on how the model is formulated so be careful.
</p>
</td></tr>
<tr><td><code id="simHDSopen_+3A_nreps">nreps</code></td>
<td>

<p>the number of distance sampling surveys within a period of closure in a season (or year)
</p>
</td></tr>
<tr><td><code id="simHDSopen_+3A_phi">phi</code></td>
<td>

<p>the availability parameter
</p>
</td></tr>
<tr><td><code id="simHDSopen_+3A_nyears">nyears</code></td>
<td>

<p>the number of seasons (typically years)
</p>
</td></tr>
<tr><td><code id="simHDSopen_+3A_beta.trend">beta.trend</code></td>
<td>

<p>loglinear trend of annual population size or density
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments entered and the following additional elements:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>simulated distance sampling data: a list with a component for each year, each itself a list with a component for each replicate; this is a matrix with a row for each individual detected and 5 columns: site ID, status (1 if captured), x and y coordinates (NA for line transects), distance from the line or point; if <code>discard0 = FALSE</code>, sites with no detections will appear in the matrix with NAs in columns 2 to 5.</p>
</td></tr>
<tr><td><code>habitat</code></td>
<td>
<p>simulated habitat covariate, a vector of length <code>nsites</code></p>
</td></tr>
<tr><td><code>wind</code></td>
<td>
<p>simulated detection covariate, a <code>nsites x nreps x nyears</code> array</p>
</td></tr>
<tr><td><code>M.true</code></td>
<td>
<p>simulated number of individuals, a <code>nsites x nyears</code> matrix</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p><code>= nreps</code></p>
</td></tr>
<tr><td><code>Na</code></td>
<td>
<p>the number of individuals available for detection, a <code>nsites x nreps x nyears</code> array</p>
</td></tr>
<tr><td><code>Na.real</code></td>
<td>
<p>for point counts, the number of individuals available for detection within the circle sampled, a <code>nsites x nreps x nyears</code> array</p>
</td></tr>
</table>


<h3>Note</h3>

<p>For &quot;point&quot; the realized density is [(area of circle) /(area of  square)]*lambda
</p>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 9.5.4.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
tmp &lt;- simHDSopen() # Generate data with default parameters
str(tmp)
head(tmp$data[[1]][[1]])

tmp &lt;- simHDSopen("point")
str(tmp)
head(tmp$data[[1]][[1]])

tmp &lt;- simHDSopen(discard0=FALSE)
str(tmp)
head(tmp$data[[1]][[1]])
</code></pre>

<hr>
<h2 id='simHDSpoint'>
Simulate data under hierarchical distance sampling point transect protocol
</h2><span id='topic+simHDSpoint'></span>

<h3>Description</h3>

<p>The function simulates hierarchical distance sampling (HDS) data under a point transect protocol. At each site, it works with a circle of radius <code>B</code>.
</p>
<p>The state process is simulated by first drawing a covariate value, &quot;habitat&quot;, for each site from a Normal(0, 1) distribution. This is used in a log-linear regression with arguments <code>mean.density</code> and <code>beta.density</code> to calculate the expected density of animals per hectare. The expected number of animals in the circle is calculated from the area of the circle and the density, and numbers are drawn from a Poisson distribution for each site.
</p>
<p>Animals are assumed to be distributed randomly over the circle, and distances from the point are generated.
</p>
<p>A detection covariate, &quot;wind&quot;, for each site is drawn from a Uniform(-2, 2) distribution. This is used in a log-linear regression with arguments <code>mean.sigma</code> and <code>beta.sigma</code> to calculate the scale parameter, sigma, of the half-normal detection function. Detections are simulated as Bernoulli trials with probability of success decreasing with distance from the point.
</p>
<p>This is a simplified (and faster) version of the function simHDS with type=&quot;point&quot;, but works with densities and with measurements in hectares and meters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simHDSpoint(nsites = 1000, mean.density = 1, beta.density  = 1,
    mean.sigma = 20, beta.sigma = -5, B = 60, discard0=FALSE, show.plots=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simHDSpoint_+3A_nsites">nsites</code></td>
<td>

<p>Number of sites (spatial replication)
</p>
</td></tr>
<tr><td><code id="simHDSpoint_+3A_mean.density">mean.density</code></td>
<td>

<p>the expected value of density (animals per hectare) when the habitat covariate = 0; the intercept of the log-linear regression for density is log(mean.density).
</p>
</td></tr>
<tr><td><code id="simHDSpoint_+3A_beta.density">beta.density</code></td>
<td>

<p>the slope of the log-linear regression for density on a habitat covariate.
</p>
</td></tr>
<tr><td><code id="simHDSpoint_+3A_mean.sigma">mean.sigma</code></td>
<td>

<p>the expected value of the scale parameter of the half-normal detection function when the wind speed = 0; the intercept of the log-linear regression for sigma is log(mean.sigma).
</p>
</td></tr>
<tr><td><code id="simHDSpoint_+3A_beta.sigma">beta.sigma</code></td>
<td>

<p>the slope of log-linear regression of scale parameter of the half-normal detection function on wind speed.
</p>
</td></tr>
<tr><td><code id="simHDSpoint_+3A_b">B</code></td>
<td>

<p>the circle radius in meters.
</p>
</td></tr>
<tr><td><code id="simHDSpoint_+3A_discard0">discard0</code></td>
<td>

<p>If TRUE, subset to sites at which individuals were captured. You may or may not want to do this depending on how the model is formulated so be careful.
</p>
</td></tr>
<tr><td><code id="simHDSpoint_+3A_show.plots">show.plots</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments entered and the following additional elements:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>simulated distance sampling data: a matrix with a row for each individual detected and 2 columns: site ID and distance from the point in meters. If <code>discard0 = FALSE</code>, the default, sites with no detections will appear in the matrix with NAs in column 2.</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p>the number of individuals detected at each site</p>
</td></tr>
<tr><td><code>habitat</code></td>
<td>
<p>simulated habitat covariate</p>
</td></tr>
<tr><td><code>wind</code></td>
<td>
<p>simulated detection covariate</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>simulated number of individuals within the circle sampled</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry, Andy Royle, Mike Meredith
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 8.5.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a data set with the default arguments and look at the structure of the output
set.seed(123)
tmp &lt;- simHDSpoint()
str(tmp)
head(tmp$data, 10)
head(tmp$counts, 10)

# Without 'wind', plots clearly show effect of distance from point
tmp &lt;- simHDSpoint(beta.sigma=0)

tmp &lt;- simHDSpoint(discard0=TRUE)
str(tmp)
head(tmp$data, 10) # some sites missing, no NAs.
head(tmp$counts)
</code></pre>

<hr>
<h2 id='simHDStr'>
Simulate HDS time-removal or double-observer data
</h2><span id='topic+simHDStr'></span>

<h3>Description</h3>

<p>A general function for simulating hierarchical distance sampling (HDS) data combined with a time-removal (with 3 removal periods) or double-observer protocol, either for a line or a point transect protocol and with method = &quot;removal&quot; or method = &quot;double&quot;. Also produces plots of the output.
</p>
<p>At each site, it works with a strip of width <code>B*2</code> (for line transects) or a circle of radius <code>B</code> (for point transects).
</p>
<p>The state process is simulated by first drawing a covariate value, &quot;habitat&quot;, for each site from a Normal(0, 1) distribution. This is used in a log-linear regression with arguments <code>beta0</code> and <code>beta1</code> to calculate the expected number of groups in each strip or circle. Group size is simulated by first drawing from a Poisson distribution with parameter <code>lambda.group</code> then adding 1.
</p>
<p>For line transects, the distance from the line is drawn from a Uniform(0, B) distribution. For point transects, the distance from the point is simulated from B*sqrt(Uniform(0,1)), which ensures a uniform distribution over the circle.
</p>
<p>The group size is used in a log-linear regression with arguments <code>alpha0</code> and <code>alpha1</code> to calculate the scale parameter, sigma, of the half-normal detection function. Detections are simulated according to the selected protocol.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simHDStr(type = c("line", "point"), method=c("removal", "double"), nsites = 200,
  lambda.group = 1, alpha0 = 0, alpha1 = 0, beta0 = 1, beta1 = 0.5,
  p.avail = 0.75, K = 3, p.double = c(0.4, 0.6),
  B = 3, discard0 = FALSE, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simHDStr_+3A_type">type</code></td>
<td>

<p>The type of distance transect, either &quot;line&quot; or &quot;point&quot;.
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_method">method</code></td>
<td>

<p>Is the method time-removal (&quot;removal&quot;) or double-observer (&quot;double&quot;)?
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_nsites">nsites</code></td>
<td>

<p>Number of sites (spatial replication)
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_lambda.group">lambda.group</code></td>
<td>

<p>Poisson mean of group size
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_alpha0">alpha0</code></td>
<td>

<p>intercept of log-linear model relating sigma of half-normal detection function to group size
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_alpha1">alpha1</code></td>
<td>

<p>slope of log-linear model relating sigma of half-normal detection function to group size
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_beta0">beta0</code></td>
<td>

<p>intercept of log-linear model relating the Poisson mean of the number of groups per unit area to habitat
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_beta1">beta1</code></td>
<td>

<p>slope of log-linear model relating the Poisson mean of the number of groups per unit area to habitat
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_p.avail">p.avail</code></td>
<td>

<p>overall availability probability (phi in text)
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_k">K</code></td>
<td>

<p>number of removal periods (of equal length)
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_p.double">p.double</code></td>
<td>

<p>detection probability for first and second observer
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_b">B</code></td>
<td>

<p>strip half width or radius of the circle
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_discard0">discard0</code></td>
<td>

<p>whether to discard or keep the data from sites with nobody detected
</p>
</td></tr>
<tr><td><code id="simHDStr_+3A_show.plot">show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when running simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments and the following additional elements:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>simulated distance sampling data: a matrix with a row for each group detected and 7 columns: site ID, status (1 if captured), x and y coordinates (NA for line transects), distance from the line or point, group size, the time interval of removal or capture history; if <code>discard0 = FALSE</code>, sites with no detections will appear in the matrix with NAs in columns 2 to 7.</p>
</td></tr>
<tr><td><code>habitat</code></td>
<td>
<p>simulated habitat covariate</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>simulated number of groups at each site</p>
</td></tr>
<tr><td><code>M.true</code></td>
<td>
<p>for point counts, the simulated number of groups within the circle sampled</p>
</td></tr>
<tr><td><code>params</code></td>
<td>
<p>a vector with the input arguments</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 9.3.2 (time removal) and 9.4.1 (double observer).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run with the default arguments and look at the structure of the output:
set.seed(123)
tmp &lt;- simHDStr() # default: line, removal
str(tmp)
head(tmp$data)
tmp &lt;- simHDStr("point", method="double")
str(tmp)
head(tmp$data)
</code></pre>

<hr>
<h2 id='simIDS'>
Simulate data for an integrated distance sampling, point count and occupancy study
</h2><span id='topic+simIDS'></span>

<h3>Description</h3>

<p>Generates hierarchical distance sampling data, point count data, and occupancy (detection/nondetection) data for an integrated distance sampling (IDS) model with shared density and availability processes, but possibly different detection/perceptability processes (i.e., different detection functions).
</p>
<p>The function calls <code><a href="#topic+simHDSpoint">simHDSpoint</a></code> to generate hierarchical distance sampling (HDS) data under a point transect protocol with a half-normal detection function. Density is modeled as a log-linear regression on a &quot;habitat&quot; covariate, with coefficients <code>mean.density</code> and <code>beta.density</code>.
</p>
<p>Point count and occupancy data are also generated by calls to <code><a href="#topic+simHDSpoint">simHDSpoint</a></code>, assuming that the underlying detection process involves reduced probability of detection with distance from the observer. The distances from the observer are discarded, and only the counts (for PC data) or species detection information (for occupancy) retained.
</p>
<p>Availability is modeled according to Sólymos et al. (2013), where the probability of availability depends on the duration of the observation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simIDS(mean.density = 1, beta.density = 1, mean.phi = 0.14, beta.phi = 0,
    nsites_HDS = 1000, sigHDS = 100, maxDist_HDS = 200, nbins = 4,
    range.dur.HDS = c(5, 5),
    nsites_PC = 10000, sigPC = 70, maxDist_PC = 500, range.dur.PC = c(3, 30),
    nsites_OC = 5000, sigOC = sigPC, maxDist_OC = maxDist_PC,
    range.dur.OC = range.dur.PC,
    show.plots = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simIDS_+3A_mean.density">mean.density</code></td>
<td>

<p>the expected value of density (animals per hectare) when the habitat covariate = 0; the intercept of the log-linear regression for density is log(mean.density).
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_beta.density">beta.density</code></td>
<td>

<p>the slope of the log-linear regression for density on a habitat covariate.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_mean.phi">mean.phi</code></td>
<td>

<p>the expected value of the availability parameter.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_beta.phi">beta.phi</code></td>
<td>

<p>the slope of the log-linear regression for availability on a covariate - not yet implemented.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_nsites_hds">nsites_HDS</code></td>
<td>

<p>the number of sites (point transects) for distance sampling.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_sighds">sigHDS</code></td>
<td>

<p>the value of the scale parameter of the half-normal detection function for distance sampling.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_maxdist_hds">maxDist_HDS</code></td>
<td>

<p>the truncation distance for distance sampling (in meters); any observations beyond this distance are discarded.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_nbins">nbins</code></td>
<td>

<p>the number of distance bins for grouping distance sampling data.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_range.dur.hds">range.dur.HDS</code></td>
<td>

<p>the range of durations for distance sampling; durations for each site are simulated from a uniform distribution with this range.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_nsites_pc">nsites_PC</code></td>
<td>

<p>the number of sites for point counts; set to 0 to suppress generation of point counts.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_sigpc">sigPC</code></td>
<td>

<p>the value of the scale parameter of the half-normal detection function for point counts.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_maxdist_pc">maxDist_PC</code></td>
<td>

<p>the maximum distance from the observer for detection of animals when conducting point counts (m).
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_range.dur.pc">range.dur.PC</code></td>
<td>

<p>the range of durations for point counts; durations for each site are simulated from a uniform distribution with this range.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_nsites_oc">nsites_OC</code></td>
<td>

<p>the number of sites for occupancy surveys; set to 0 to suppress generation of occupancy data.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_sigoc">sigOC</code></td>
<td>

<p>the value of the scale parameter of the half-normal detection function for occupancy surveys.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_maxdist_oc">maxDist_OC</code></td>
<td>

<p>the maximum distance from the observer for detection of animals when conducting occupancy surveys (m).
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_range.dur.oc">range.dur.OC</code></td>
<td>

<p>the range of durations for point counts; durations for each site are simulated from a uniform distribution with this range.
</p>
</td></tr>
<tr><td><code id="simIDS_+3A_show.plots">show.plots</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments entered and the following additional elements:
</p>
<table>
<tr><td><code>dds</code></td>
<td>
<p>simulated durations for distance sampling: a vector length <code>nsites_HDS</code> with a value for each site</p>
</td></tr>
<tr><td><code>umf_hds0</code></td>
<td>
<p>an <code>unmarkedFrameDS</code> [package &quot;unmarked&quot;] with the simulated distance sampling data BEFORE allowing for availability</p>
</td></tr>
<tr><td><code>umf_hds1</code></td>
<td>
<p>an <code>unmarkedFrameDS</code> [package &quot;unmarked&quot;] with the simulated distance sampling data AFTER allowing for availability</p>
</td></tr>
<tr><td><code>dpc</code></td>
<td>
<p>simulated durations for point counts: a vector length <code>nsites_PC</code> with a value for each site</p>
</td></tr>
<tr><td><code>umf_pc0</code></td>
<td>
<p>an <code>unmarkedFramePCount</code> [package &quot;unmarked&quot;] with the simulated point count data BEFORE allowing for availability</p>
</td></tr>
<tr><td><code>umf_pc1</code></td>
<td>
<p>an <code>unmarkedFramePCount</code> [package &quot;unmarked&quot;] with the simulated point count data AFTER allowing for availability</p>
</td></tr>
<tr><td><code>doc</code></td>
<td>
<p>simulated durations for occupancy surveys: a vector length <code>nsites_OC</code> with a value for each site</p>
</td></tr>
<tr><td><code>umf_oc0</code></td>
<td>
<p>an <code>unmarkedFrameOccu</code> [package &quot;unmarked&quot;] with the simulated occupancy data BEFORE allowing for availability</p>
</td></tr>
<tr><td><code>umf_oc1</code></td>
<td>
<p>an <code>unmarkedFrameOccu</code> [package &quot;unmarked&quot;] with the simulated occupancy data AFTER allowing for availability</p>
</td></tr>
</table>


<h3>Note</h3>

<p>A function to analyze these data, <code>IDS</code>, will appear in a future version of <span class="pkg">unmarked</span>. In the meantime, a devel version can be installed with <code>remotes::install_github("kenkellner/unmarked", ref="IDS")</code>.
</p>


<h3>Author(s)</h3>

<p>Ken Kellner, Marc Kéry, Mike Meredith
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 8.5.1.
</p>
<p>Sólymos, P. et al. (2013) Calibrating indices of avian density from non-standardized survey data: making the most of a messy situation. <em>Methods in Ecology and Evolution</em> 4, 1047-1058.
</p>
<p>Kéry, M. et al. (2022) Integrated distance sampling models for simple point counts. (Submitted to <em>Ecology</em>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a data set with the default arguments and look at the structure of the output
tmp &lt;- simIDS()
str(tmp)
</code></pre>

<hr>
<h2 id='simMultMix'>
Simulate the multinomial-mixture model
</h2><span id='topic+simMultMix'></span>

<h3>Description</h3>

<p>Simulation of &quot;removal&quot; data from a multinomial-mixture model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simMultMix(nsites = 100, nsurveys = 3, nyears = 4,
  lambda = 3, theta = 0.5, p = 0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simMultMix_+3A_nsites">nsites</code></td>
<td>

<p>number of sites.
</p>
</td></tr>
<tr><td><code id="simMultMix_+3A_nsurveys">nsurveys</code></td>
<td>

<p>number of replicate (secondary) samples
</p>
</td></tr>
<tr><td><code id="simMultMix_+3A_nyears">nyears</code></td>
<td>

<p>number of primary samples: years, seasons etc.
</p>
</td></tr>
<tr><td><code id="simMultMix_+3A_lambda">lambda</code></td>
<td>

<p>expected local population size.
</p>
</td></tr>
<tr><td><code id="simMultMix_+3A_theta">theta</code></td>
<td>

<p>availability, the proportion of the population available for detection.
</p>
</td></tr>
<tr><td><code id="simMultMix_+3A_p">p</code></td>
<td>

<p>detection probability.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>M</code></td>
<td>
<p>true local population size, vector length nsites</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>true number available for detection, vector length nsites</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>number detected, nsites x nyears x nsurveys</p>
</td></tr>
<tr><td><code>y2d</code></td>
<td>
<p>number detected as a matrix, nsites x (nyears*nsurveys)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle, adapting code in documentation for <code><a href="unmarked.html#topic+gmultmix">gmultmix</a></code> by Richard Chandler.
</p>


<h3>References</h3>

<p>Chandler, R.B., Royle, J.A. &amp; King. D.I. (2011) Inference about density and temporary emigration in unmarked populations. <em>Ecology</em>, 92, 1429-1435.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 2.7.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a data set with the default arguments and look at the structure of the output:
tmp &lt;- simMultMix()
str(tmp)
</code></pre>

<hr>
<h2 id='simNmix'>
Simulate data for binomial and multinomial mixture models
</h2><span id='topic+simNmix'></span>

<h3>Description</h3>

<p>This very general function generates single-season count data under variants of the binomial N-mixture model of Royle (2004) and of the multinomial N-mixture model of Royle et al (2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simNmix(nsites = 267, nvisits = 3, mean.theta = 1, mean.lam = 2, mean.p = 0.6,
  area = FALSE, beta1.theta = 0, beta2.theta = 0, beta3.theta = 0,
  beta2.lam = 0, beta3.lam = 0, beta4.lam = 0, beta3.p = 0, beta5.p = 0,
  beta6.p = 0, beta.p.survey = 0, beta.p.N = 0, sigma.lam = 0, dispersion = 10,
  sigma.p.site = 0, sigma.p.visit = 0, sigma.p.survey = 0, sigma.p.ind = 0,
  Neg.Bin = FALSE, open.N = FALSE, show.plots = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simNmix_+3A_nsites">nsites</code></td>
<td>

<p>number of sites
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_nvisits">nvisits</code></td>
<td>

<p>number of visits per site
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_mean.theta">mean.theta</code></td>
<td>

<p>proportion of sites that can have non-zero abundance in principle: suitability model for zero-inflation
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_mean.lam">mean.lam</code></td>
<td>

<p>Expected abundance at the average value of all abundance covariates (and ignoring random site effects): abundance model
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_mean.p">mean.p</code></td>
<td>

<p>Expected detection at the average value of all detection covariates (and ignoring all random effects): detection model
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_area">area</code></td>
<td>

<p>determines area of sites (A), defaults to A=1 (i.e., all identical), but you can supply a vector of site areas of length nsites instead.
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_beta1.theta">beta1.theta</code></td>
<td>

<p>coefficient of site covariate 1 in suitability model
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_beta2.theta">beta2.theta</code></td>
<td>

<p>coefficient of site covariate 2 in suitability model
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_beta3.theta">beta3.theta</code></td>
<td>

<p>coefficient of site covariate 3 in suitability model
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_beta2.lam">beta2.lam</code></td>
<td>

<p>coefficient of site covariate 2 in abundance model
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_beta3.lam">beta3.lam</code></td>
<td>

<p>coefficient of site covariate 3 in abundance model
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_beta4.lam">beta4.lam</code></td>
<td>

<p>coefficient of site covariate 4 in abundance model
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_beta3.p">beta3.p</code></td>
<td>

<p>coefficient of site covariate 3 in detection model
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_beta5.p">beta5.p</code></td>
<td>

<p>coefficient of site covariate 5 in detection model
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_beta6.p">beta6.p</code></td>
<td>

<p>coefficient of site covariate 6 in detection model
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_beta.p.survey">beta.p.survey</code></td>
<td>

<p>coefficient of survey ('observational') covariate on p
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_beta.p.n">beta.p.N</code></td>
<td>

<p>coefficient of centered local population size (log(N+1)) in detection model (i.e., coef. for density-dependent detection prob.)
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_sigma.lam">sigma.lam</code></td>
<td>

<p>&quot;Overdispersion SD&quot; in linear predictor of abundance
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_dispersion">dispersion</code></td>
<td>

<p>'size' or extra-Poisson dispersion of Negative binomial
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_sigma.p.site">sigma.p.site</code></td>
<td>

<p>&quot;Overdispersion SD&quot; in linear predictor of detection coming from random site effects
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_sigma.p.visit">sigma.p.visit</code></td>
<td>

<p>&quot;Overdispersion SD&quot; in linear predictor of detection coming from random visit effects
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_sigma.p.survey">sigma.p.survey</code></td>
<td>

<p>&quot;Overdispersion SD&quot; in linear predictor of detection coming from random site-by-survey effects
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_sigma.p.ind">sigma.p.ind</code></td>
<td>

<p>&quot;Overdispersion SD&quot; in linear predictor of detection coming from random site-by-individual effects
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_neg.bin">Neg.Bin</code></td>
<td>

<p>if FALSE, any overdispersion in abundance is modeled by a Poisson log-normal; if TRUE, abundance overdispersion is modeled by adoption of a Negative binomial distribution for latent N
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_open.n">open.N</code></td>
<td>

<p>if TRUE, data are simulated under one specific form of an open population, where N in the first occasion is drawn from the specified mixture distribution and for all further occasions j, we have  N_ij ~ Poisson(N_i(j-1)). With open.N = TRUE, we must have sigma.p.ind = 0, show.plot = FALSE and nvisits &gt;1.
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, plots of the data will be displayed; set to FALSE if you are running simulations.
</p>
</td></tr>
<tr><td><code id="simNmix_+3A_verbose">verbose</code></td>
<td>

<p>if TRUE, output will be written to the console.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data are simulated at the level of each individual and individual-specific detection heterogeneity can be included. As a side-effect, individual-specific detection histories are generated and hence, data are also be simulated under the corresponding multinomial N-mixture model.
</p>
<p>Broadly, the function can generate data under this most general model:
</p>
<p>'Suitability' (zero-inflation) ~ cov1 + cov2 + cov3
</p>
<p>Abundance ~ offset + cov2 + cov3 + cov4 + overdispersion
</p>
<p>Detection ~ cov3 + cov5 + cov6 + survey.covariate + log(N+1) + eps.site + eps.visit + eps.survey + eps.individual
</p>
<p>Overdispersion in abundance is modeled either as a Poisson-log-normal with a normal random site effect in lambda or with a Negative binomial with mean lambda and a 'size', or dispersion, parameter. Variable site areas can be specified to affect abundance as in an offset.
</p>
<p>Abundance can be zero-inflated (this is the 'suitability' model). Note that the zero-inflation parameter is called theta here (in unmarked it is called psi). mean.phi is the probability that a site is suitable (i.e., 1 minus the expected proportion of sites with structural zero abundance.
</p>
<p>Site covariate 2 can affect both suitability and abundance, while covariate 3 may affect all three levels. Hence, the function permits to simulate the case where a single site covariate affects different levels in the process (e.g., abundance and detection) in opposing directions (as for instance in Kéry, 2008)
</p>
<p>Density-dependent detection can be modeled as a logistic-linear effect of local abundance (centered and log(x+1) transformed). Overdispersion in detection is modeled via normal random effects (the eps terms above) specific to sites, visits, surveys or individuals.
</p>
<p>Effects of covariates and random-effects factors are modeled as additive on the link scale (log for abundance and logit for suitability and detection).
</p>
<p>Data may be generated under one specific open-population model when argument 'open.N' is set to TRUE.
</p>


<h3>Value</h3>

<p>A list with the arguments input and the following additional elements:
</p>
<table>
<tr><td><code>nobs</code></td>
<td>
<p>The total number of visits</p>
</td></tr>
<tr><td><code>site.cov</code></td>
<td>
<p>An nsites x 6 matrix of values for 6 site covariates</p>
</td></tr>
<tr><td><code>survey.cov</code></td>
<td>
<p>An nsites x nvisits matrix of values for a survey covariate</p>
</td></tr>
<tr><td><code>log.lam</code></td>
<td>
<p>Linear predictor of PLN abundance model including random effects, a vector of length nsites</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>Site suitability indicator, a vector of length nsites</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of individuals at each site, a vector of length nsites</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Probability of detection, an array with dimensions sites occupied x visits x max(N)</p>
</td></tr>
<tr><td><code>DH</code></td>
<td>
<p>Detection history (1/0), an array with dimensions sites occupied x visits x max(N)</p>
</td></tr>
<tr><td><code>N.open</code></td>
<td>
<p>Number of individuals at each site for open model, a sites x visits matrix</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>Summary of DH: number of individuals detected for each site and visit</p>
</td></tr>
<tr><td><code>eta.lam</code></td>
<td>
<p>Random site effects in lambda, a vector of length nsites, zero if Neg.Bin == TRUE</p>
</td></tr>
<tr><td><code>eta.p.site</code></td>
<td>
<p>Random site effects in p, a vector of length nsites</p>
</td></tr>
<tr><td><code>eta.p.visit</code></td>
<td>
<p>Random visit effects in p, a vector of length nvisits</p>
</td></tr>
<tr><td><code>eta.p.survey</code></td>
<td>
<p>Random survey (= site-by-survey) effects in p, a nsites x nvisits matrix</p>
</td></tr>
<tr><td><code>eta.p.ind</code></td>
<td>
<p>Random individual (= site-by-ind) effects in p (NOT site-ind-visit !), a nsites x max(N) matrix</p>
</td></tr>
<tr><td><code>odcN</code></td>
<td>
<p>Naive overdispersion measure (var/mean) for true abundance (N)</p>
</td></tr>
<tr><td><code>odcC</code></td>
<td>
<p>Naive overdispersion measure (var/mean) for observed counts (C)</p>
</td></tr>
<tr><td><code>Ntotal</code></td>
<td>
<p>Total abundance summed over all sites</p>
</td></tr>
<tr><td><code>summax</code></td>
<td>
<p>The sum of maximum counts over all sites</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Royle, J.A. (2004) N-mixture models for estimating population size from spatially replicated counts. <em>Biometrics</em>, 60, 108-115.
</p>
<p>Royle, J.A., et al (2007) Hierarchical spatial models of abundance and occurrence from imperfect survey data. <em>Ecological Monographs</em>, 77, 465-481.
</p>
<p>Kéry, M. (2008) Estimating abundance from bird counts: binomial mixture models uncover complex covariate relationships, <em>Auk</em>, 125, 336-345
</p>
<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 6.5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure:
tmp &lt;- simNmix()
str(tmp)


str(data &lt;- simNmix())                  # Null data-generating model
str(data &lt;- simNmix(mean.theta = 0.60)) # ZIP with 40% structural zeroes
str(data &lt;- simNmix(sigma.lam = 1))     # Poisson-lognormal (PLN) mixture
str(data &lt;- simNmix(Neg.Bin = TRUE))    # Negative-binomial mixture
str(data &lt;- simNmix(mean.theta = 0.6, sigma.lam = 1))  # Zero-inflated PLN
str(data &lt;- simNmix(mean.theta = 0.6, Neg.Bin = TRUE)) # Zero-infl. NegBin
str(data &lt;- simNmix(mean.p = 1))        # Perfect detection (p = 1)
str(data &lt;- simNmix(mean.theta = 0.6, mean.p = 1))     # ZIP with p = 1
str(data &lt;- simNmix(sigma.lam = 1, mean.p = 1))        # PLN with p = 1

</code></pre>

<hr>
<h2 id='simNmixSpatial'>
Simulate replicated counts under a spatial, static binomial N-mixture model
</h2><span id='topic+simNmixSpatial'></span>

<h3>Description</h3>

<p>Simulates replicated counts under a spatial, static binomial N-mixture model for a semi-realistic landscape in a square of 50x50 km in the Bernese Oberland around Interlaken, Switzerland. Unit of the data simulation is a 1km2 quadrat, hence, there are 2500 units. It uses the data set <code><a href="#topic+BerneseOberland">BerneseOberland</a></code>, which has covariates for elevation and forest cover.
</p>
<p>For abundance, the function allows you to specify a quadratic effect of elevation. Then, a Gaussian spatial random field (s) with negative exponential correlation function is simulated using <code><a href="#topic+simExpCorrRF">simExpCorrRF</a></code>; you can set the variance and the range (scale) parameter theta. Basically, the larger the value of theta.RF, the bigger are the 'islands' simulated in the random field. The abundance in each quadrat (i) is built up via the following linear predictor:
</p>
<p><code>lambda[i] &lt;- exp(beta0 + beta[1] * elev[i] + beta[2] * elev[i]^2 + s[i])</code> <br />
<code>N[i] ~ Poisson(lambda[i])</code>
</p>
<p>Replicated counts are simulated as usual under a binomial observation model, and detection probability is allowed to vary by one site and one observational covariate: respectively quadrat forest cover (in the BerneseOberland data set), and wind-speed, which is invented data. Counts at each site (i) and for each occasion (j) are then produced according to the following model:
</p>
<p><code>  p[i,j] &lt;- plogis(alpha0 + alpha[1] * forest[i] + alpha[2] * wind[i,j])</code> <br />
<code>C[i,j] ~ Binomial(N[i], p[i,j]) </code>
</p>
<p>Finally, we assume that only a subset of the 2500 quadrats is surveyed. Hence, we allow you to choose the number of quadrats that are surveyed and these will then be randomly placed into the landscape. We then assume that counts will only be available for these surveyed quadrats, i.e., counts from all non-surveyed quadrats will be NA.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, call <code>RNGversion="3.5.3"</code> before the call to <code>simNmixSpatial</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simNmixSpatial(nsurveys = 3, mean.lambda = exp(2), beta = c(2, -2),
  mean.p = 0.5, alpha = c(-1, -1), sample.size = 500, variance.RF = 1, theta.RF = 10,
  seeds = c(10, 100), truncN = 6, show.plots=TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simNmixSpatial_+3A_nsurveys">nsurveys</code></td>
<td>

<p>number of surveys per quadrat.
</p>
</td></tr>
<tr><td><code id="simNmixSpatial_+3A_mean.lambda">mean.lambda</code></td>
<td>

<p>expected number of individuals at a quadrat with mean values of all covariates; <code>beta0</code> is <code>log(mean.lambda)</code>.
</p>
</td></tr>
<tr><td><code id="simNmixSpatial_+3A_beta">beta</code></td>
<td>

<p>vector of length 2, the linear and quadratic coefficients for the effect of elevation on abundance.
</p>
</td></tr>
<tr><td><code id="simNmixSpatial_+3A_mean.p">mean.p</code></td>
<td>

<p>Expected detection at the average value of all detection covariates (and ignoring all random effects): detection model
</p>
</td></tr>
<tr><td><code id="simNmixSpatial_+3A_alpha">alpha</code></td>
<td>

<p>vector of length 2, the coefficients for the effect of forest and wind on detection.
</p>
</td></tr>
<tr><td><code id="simNmixSpatial_+3A_sample.size">sample.size</code></td>
<td>

<p>the number of quadrats surveyed.
</p>
</td></tr>
<tr><td><code id="simNmixSpatial_+3A_variance.rf">variance.RF</code></td>
<td>

<p>variance of the random field.
</p>
</td></tr>
<tr><td><code id="simNmixSpatial_+3A_theta.rf">theta.RF</code></td>
<td>

<p>parameter governing spatial correlation (=1/phi); the larger the value of theta.RF, the bigger are the 'islands' simulated in the random field.
</p>
</td></tr>
<tr><td><code id="simNmixSpatial_+3A_seeds">seeds</code></td>
<td>

<p>vector of length 2; random seeds used for the random field and the selection of quadrats surveyed respectively.
</p>
</td></tr>
<tr><td><code id="simNmixSpatial_+3A_truncn">truncN</code></td>
<td>

<p>used to limit the range of values of N displayed in some plots.
</p>
</td></tr>
<tr><td><code id="simNmixSpatial_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, plots of the data will be displayed; set to FALSE if you are running simulations.
</p>
</td></tr>
<tr><td><code id="simNmixSpatial_+3A_verbose">verbose</code></td>
<td>

<p>if TRUE, output will be written to the console.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the arguments input and the following additional elements:
</p>
<table>
<tr><td><code>xcoord</code>, <code>ycoord</code></td>
<td>
<p>The x and y coordinates from the <code>BerneseOberland</code> data set.</p>
</td></tr>
<tr><td><code>elevation</code></td>
<td>
<p>The elevation covariate from the <code>BerneseOberland</code> data set.</p>
</td></tr>
<tr><td><code>forest</code></td>
<td>
<p>The forest cover covariate from the <code>BerneseOberland</code> data set.</p>
</td></tr>
<tr><td><code>elevationS</code></td>
<td>
<p>The elevation covariate standardized to mean 0, SD 1.</p>
</td></tr>
<tr><td><code>forestS</code></td>
<td>
<p>The forest cover covariate standardized to mean 0, SD 1.</p>
</td></tr>
<tr><td><code>wind</code></td>
<td>
<p>The wind covariate, generated internally.</p>
</td></tr>
<tr><td><code>field</code></td>
<td>
<p>The spatially-autocorrelated covariate, generated internally.</p>
</td></tr>
<tr><td><code>beta0</code></td>
<td>
<p>Intercept for the abundance model, equal to <code>log(mean.lambda)</code>.</p>
</td></tr>
<tr><td><code>lam</code></td>
<td>
<p>Expected abundance in each quadrat.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of individuals at each site.</p>
</td></tr>
<tr><td><code>Ntotal</code></td>
<td>
<p>Total number of individuals in the study area.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>probability of detection for each survey.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>number of individuals detected in each quadrat.</p>
</td></tr>
<tr><td><code>surveyed.sites</code></td>
<td>
<p>the IDs of the quadrats surveyed.</p>
</td></tr>
<tr><td><code>yobs</code></td>
<td>
<p>number of individuals detected in each quadrat surveyed, NA for quadrats not surveyed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 11.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure:
str(dat &lt;- simNmixSpatial())
str(dat &lt;- simNmixSpatial(show.plots=FALSE))

# More surveys
str(dat&lt;- simNmixSpatial(nsurveys = 10))

# Minimal number of surveys is 1
str(dat&lt;- simNmixSpatial(nsurveys = 1))

# Much more common species
str(dat&lt;- simNmixSpatial(mean.lambda = exp(4)))

# Only negative linear effect of elevation
str(dat&lt;- simNmixSpatial(beta = c(-2, 0)))

# No effect of elevation at all
str(dat&lt;- simNmixSpatial(beta = c(0, 0)))

# Perfect detection (p = 1)
str(dat&lt;- simNmixSpatial(mean.p = 1))

# No effect of forest cover on detection
str(dat&lt;- simNmixSpatial(alpha = c(0, -1)))

# No effect of wind speed on detection
str(dat&lt;- simNmixSpatial(alpha = c(-1, 0)))

# Sample only 100 quadrats
str(dat&lt;- simNmixSpatial(sample.size = 100))

# Sample all 2500 quadrats
str(dat&lt;- simNmixSpatial(sample.size = 2500))

# Larger variance of the multivariate Gaussian Random variable in the random field
#  (this will increase the effect of the field on abundance and counts)
str(dat&lt;- simNmixSpatial(variance.RF = 10))

# No spatial autocorrelation (Variant 1: set variance to 0)
str(dat&lt;- simNmixSpatial(variance.RF = 0))

# No spatial autocorrelation (Variant 2: set theta very close to 0,
#  but not quite 0, otherwise function breaks)
str(dat&lt;- simNmixSpatial(theta.RF = 0.0001))

# Larger value of theta.RF gives larger 'islands'
#try(str(dat&lt;- simNmixSpatial(theta.RF = 100))) # works with RandomFields

# Truncate abundance in final plots to presence/absence
str(dat&lt;- simNmixSpatial(truncN = 0.5))

# Essentially do not truncate abundance in final plots
str(dat&lt;- simNmixSpatial(truncN = 70))

</code></pre>

<hr>
<h2 id='simNpC'>
Generate counts from a single population observed over T years under a binomial observation process
</h2><span id='topic+simNpC'></span>

<h3>Description</h3>

<p>Generates counts from a single population observed over T years and which can be observed with or without imperfect detection. The goal is to focus on what happens with relative-abundance inference when temporal patterns in abundance are confounded with temporal patterns in detection probability. Hence, we can simulate a stable population or one with linear increase or decrease with specified start and end points, and around which there is Poisson noise. The observed counts are Binomial outcomes with a detection probability which can similarly be chosen to be constant or change linearly over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simNpC(T = 20, expN = c(100, 75), dp = c(0.5, 0.5), show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simNpC_+3A_t">T</code></td>
<td>

<p>The length of the time series.
</p>
</td></tr>
<tr><td><code id="simNpC_+3A_expn">expN</code></td>
<td>

<p>The expected abundance at start and end of period, linear trend.
</p>
</td></tr>
<tr><td><code id="simNpC_+3A_dp">dp</code></td>
<td>

<p>The detection probability at start and end of period, linear trend.
</p>
</td></tr>
<tr><td><code id="simNpC_+3A_show.plot">show.plot</code></td>
<td>

<p>Choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments entered and the following additional elements:
</p>
<table>
<tr><td><code>lambda</code></td>
<td>
<p>T vector, expected abundance for each year.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>T vector, detection probability (dp) for each year.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>T vector, realized abundance.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>T vector, observed counts.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 1.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run with the default arguments and look at the structure of the output:
set.seed(123)
tmp &lt;- simNpC()
str(tmp)
tmp$C


</code></pre>

<hr>
<h2 id='simOcc'>
Simulate data for static occupancy models under wide range of conditions
</h2><span id='topic+simOcc'></span><span id='topic+simOccCat'></span>

<h3>Description</h3>

<p>Functions to simulate static occupancy measurements replicated at M sites during J occasions. Population closure is assumed for each site. Expected occurrence may be affected by elevation (elev), forest cover (forest) and their interaction. Expected detection probability may be affected by elevation, wind speed (wind) and their interaction.
</p>
<p><code>simOccCat</code> allows for a categorical habitat-type covariate (HAB) to affect occurrence and another, the observer (OBS), to affect detection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simOcc(M = 267, J = 3, mean.occupancy = 0.6, beta1 = -2, beta2 = 2, beta3 = 1,
  mean.detection = 0.3, time.effects = c(-1, 1),
  alpha1 = -1, alpha2 = -3, alpha3 = 0, sd.lp = 0.5,
  b = 2, show.plots = TRUE)

simOccCat(M = 267, J = 3, mean.occupancy = 0.6, beta1 = 0, beta2 = 0, beta3 = 0,
  mean.detection = 0.3, time.effects = c(0, 0),
  alpha1 = 0, alpha2 = 0, alpha3 = 0, sd.lp = 0, b = 0,
  nHab = 5, range.HAB = 2, nObs = 10, range.OBS = 4,
  show.plots = TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simOcc_+3A_m">M</code></td>
<td>

<p>Number of spatial replicates (sites)
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_j">J</code></td>
<td>

<p>Number of temporal replicates (occasions)
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_mean.occupancy">mean.occupancy</code></td>
<td>

<p>Mean occurrence at value 0 of occurrence covariates
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_beta1">beta1</code></td>
<td>

<p>Main effect of elevation on occurrence
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_beta2">beta2</code></td>
<td>

<p>Main effect of forest cover on occurrence
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_beta3">beta3</code></td>
<td>

<p>Interaction effect on occurrence of elevation and forest cover
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_mean.detection">mean.detection</code></td>
<td>

<p>Mean detection prob. at value 0 of detection covariates
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_time.effects">time.effects</code></td>
<td>

<p>bounds (on logit scale) for uniform distribution from which time effects gamma will be drawn
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_alpha1">alpha1</code></td>
<td>

<p>Main effect of elevation on detection probability
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_alpha2">alpha2</code></td>
<td>

<p>Main effect of wind speed on detection probability
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_alpha3">alpha3</code></td>
<td>

<p>Interaction effect on detection of elevation and wind speed
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_sd.lp">sd.lp</code></td>
<td>

<p>standard deviation of random site effects (on logit scale)
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_b">b</code></td>
<td>

<p>constant value of 'behavioral response' leading to 'trap-happiness' (if b &gt; 0) or 'trap shyness' (if b &lt; 0)
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_nhab">nHab</code></td>
<td>

<p>number of categories to simulate for the site-specific categorical covariate, HAB.
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_range.hab">range.HAB</code></td>
<td>

<p>a non-negative number that controls the size of the HAB effect.
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_nobs">nObs</code></td>
<td>

<p>number of observers, the categories to simulate for the survey-specific categorical covariate, OBS.
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_range.obs">range.OBS</code></td>
<td>

<p>a non-negative number that controls the size of the OBS effect.
</p>
</td></tr>
<tr><td><code id="simOcc_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, plots of the data will be displayed; set to FALSE if you are running simulations
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the  input arguments and the following additional elements:
</p>
<table>
<tr><td><code>gamma</code></td>
<td>
<p>The time effects, a vector of length J</p>
</td></tr>
<tr><td><code>eps</code></td>
<td>
<p>Individual random effects, a vector of length M</p>
</td></tr>
<tr><td><code>elev</code></td>
<td>
<p>Elevation, a vector of length M</p>
</td></tr>
<tr><td><code>forest</code></td>
<td>
<p>Forest cover, a vector of length M</p>
</td></tr>
<tr><td><code>wind</code></td>
<td>
<p>wind speed, a M x J matrix</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>Probability of occurrence, a vector of length M</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Realized occurrence (0/1), a vector of length M</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>probability of capture, possibly with a behavioral effect, a M x J matrix</p>
</td></tr>
<tr><td><code>p0</code></td>
<td>
<p>probability of capture when not captured on previous occasion, a M x J matrix</p>
</td></tr>
<tr><td><code>p1</code></td>
<td>
<p>probability of capture when captured on previous occasion, a M x J matrix</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>simulated capture history, a M x J matrix</p>
</td></tr>
<tr><td><code>sumZ</code></td>
<td>
<p>True number of occupied sites</p>
</td></tr>
<tr><td><code>sumZ.obs</code></td>
<td>
<p>Number of sites observed to be occupied</p>
</td></tr>
<tr><td><code>psi.fs.true</code></td>
<td>
<p>True proportion of occupied sites in sample (sumZ/N)</p>
</td></tr>
<tr><td><code>psi.fs.obs</code></td>
<td>
<p>Proportion of sites observed to be occupied (sumZ.obs/N)</p>
</td></tr>
</table>
<p>In addition, <code>simOccCat</code> has
</p>
<table>
<tr><td><code>HAB</code></td>
<td>
<p>Categorical site covariate, a vector of length M</p>
</td></tr>
<tr><td><code>OBS</code></td>
<td>
<p>Categorical detection covariate, a M x J matrix</p>
</td></tr>
<tr><td><code>coefHAB</code></td>
<td>
<p>The effect of each category of HAB on occurrence</p>
</td></tr>
<tr><td><code>coefOBS</code></td>
<td>
<p>The effect of each category of OBS on detection</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry, Andy Royle, Gesa von Hirschheydt, Mike Meredith,
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 10.8.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure
tmp &lt;- simOcc()
str(tmp)

# Simplest possible occupancy model, with constant occupancy and detection
str(simOcc(mean.occ=0.6, beta1=0, beta2=0, beta3=0, mean.det=0.3, time.effects=c(0, 0),
  alpha1=0, alpha2=0, alpha3=0, sd.lp=0, b=0))
# psi = 1 (i.e., species occurs at every site)
str(simOcc(mean.occ=1))

# p = 1 (i.e., species is always detected when it occurs)
str(simOcc(mean.det=1))

# Other potentially interesting settings include these:

str(simOcc(J = 2))                 # Only 2 surveys
str(simOcc(M = 1, J = 100))        # No spatial replicates, but 100 measurements
str(simOcc(beta3 = 1))             # Including interaction elev-wind on p
str(simOcc(mean.occ = 0.96))       # A really common species
str(simOcc(mean.occ = 0.05))       # A really rare species
str(simOcc(mean.det = 0.96))       # A really easy species
str(simOcc(mean.det = 0.05))       # A really hard species
str(simOcc(mean.det = 0))          # The dreaded invisible species
str(simOcc(alpha1=-2, beta1=2))    # Opposing effects of elev on psi and p
str(simOcc(J = 10, time.effects = c(-5, 5))) # Huge time effects on p
str(simOcc(sd.lp = 10))            # Huge (random) site effects on p
str(simOcc(J = 10, b = 0))         # No behavioral response in p
str(simOcc(J = 10, b = 2))         # Trap happiness
str(simOcc(J = 10, b = -2))        # Trap shyness


# Using categorical covariates only
str(simOccCat())
# Categorical and continuous covariates
str(tmp &lt;- simOccCat(beta1 = -2, beta2 = 2, beta3 = 1,
    mean.detection = 0.3, time.effects = c(-1, 1),
    alpha1 = -1, alpha2 = -3, alpha3 = 0,
    sd.lp = 0.5, b = 2))
# Check how balanced the levels are for HAB
barplot(sort(table(tmp$HAB), decreasing=TRUE), xlab="Habitat category",
    ylab="Frequency", main="Frequency distribution of habitat categories")
</code></pre>

<hr>
<h2 id='simOccSpatial'>
Simulate replicated detection/nondetection data under a spatial, static occupancy model
</h2><span id='topic+simOccSpatial'></span>

<h3>Description</h3>

<p>Simulates replicated detection/nondetection data under a spatial, static occupancy model for a semi-realistic landscape in a square of 50x50 km in the Bernese Oberland around Interlaken, Switzerland. Unit of the data simulation is a 1km2 quadrat, hence, there are 2500 units. It uses the data set <code><a href="#topic+BerneseOberland">BerneseOberland</a></code>, which has covariates for elevation and forest cover.
</p>
<p>For occupancy, the function allows you to specify a quadratic effect of elevation. Then, a Gaussian spatial random field (s) with negative exponential correlation function is simulated using <code><a href="#topic+simExpCorrRF">simExpCorrRF</a></code>; you can set the variance and the range (scale) parameter theta. Basically, the larger the value of theta.RF, the bigger are the 'islands' simulated in the random field. The abundance in each quadrat (i) is built up via the following linear predictor:
</p>
<p><code>psi[i] &lt;- qlogis(beta0 + beta[1] * elev[i] + beta[2] * elev[i]^2 + s[i])</code> <br />
<code>z[i] ~ Bernoulli(psi[i])</code>
</p>
<p>Replicated detection/nondetection data are simulated as usual under a Bernoulli observation model, and detection probability is allowed to vary by one site and one observational covariate: respectively quadrat forest cover (in the BerneseOberland data set), and wind-speed, which is invented data. Counts at each site (i) and for each occasion (j) are then produced according to the following model:
</p>
<p><code>p[i,j] &lt;- plogis(alpha0 + alpha[1] * forest[i] + alpha[2] * wind[i,j])</code> <br />
<code>y[i,j] ~ Bernoulli(z[i] * p[i,j]) </code>
</p>
<p>Finally, we assume that only a subset of the 2500 quadrats is surveyed. Hence, we allow you to choose the number of quadrats that are surveyed and these will then be randomly placed into the landscape. We then assume that counts will only be available for these surveyed quadrats, i.e., detection/non-detection data from all non-surveyed quadrats will be replaced with NA.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, call <code>RNGversion="3.5.3"</code> before the call to <code>simOccSpatial</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simOccSpatial(nsurveys = 3, mean.psi = 0.6, beta = c(2, -2),
  mean.p = 0.4, alpha = c(-1, -1), sample.size = 500, variance.RF = 1, theta.RF = 10,
  seeds = c(10, 100), show.plots = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simOccSpatial_+3A_nsurveys">nsurveys</code></td>
<td>

<p>number of surveys per quadrat.
</p>
</td></tr>
<tr><td><code id="simOccSpatial_+3A_mean.psi">mean.psi</code></td>
<td>

<p>probability of occupancy at a quadrat with mean values of all covariates; <code>beta0</code> is <code>qlogis(mean.psi)</code>.
</p>
</td></tr>
<tr><td><code id="simOccSpatial_+3A_beta">beta</code></td>
<td>

<p>vector of length 2, the linear and quadratic coefficients for the effect of elevation on occupancy.
</p>
</td></tr>
<tr><td><code id="simOccSpatial_+3A_mean.p">mean.p</code></td>
<td>

<p>Expected detection at the average value of all detection covariates (and ignoring all random effects): detection model
</p>
</td></tr>
<tr><td><code id="simOccSpatial_+3A_alpha">alpha</code></td>
<td>

<p>vector of length 2, the coefficients for the effect of forest and wind on detection.
</p>
</td></tr>
<tr><td><code id="simOccSpatial_+3A_sample.size">sample.size</code></td>
<td>

<p>the number of quadrats surveyed.
</p>
</td></tr>
<tr><td><code id="simOccSpatial_+3A_variance.rf">variance.RF</code></td>
<td>

<p>variance of the random field.
</p>
</td></tr>
<tr><td><code id="simOccSpatial_+3A_theta.rf">theta.RF</code></td>
<td>

<p>parameter governing spatial correlation (=1/phi); the larger the value of theta.RF, the bigger are the 'islands' simulated in the random field.
</p>
</td></tr>
<tr><td><code id="simOccSpatial_+3A_seeds">seeds</code></td>
<td>

<p>vector of length 2; random seeds used for the random field and the selection of quadrats surveyed respectively.
</p>
</td></tr>
<tr><td><code id="simOccSpatial_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, plots of the data will be displayed; set to FALSE if you are running simulations.
</p>
</td></tr>
<tr><td><code id="simOccSpatial_+3A_verbose">verbose</code></td>
<td>

<p>if TRUE, output will be written to the console.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the arguments input and the following additional elements:
</p>
<table>
<tr><td><code>xcoord</code>, <code>ycoord</code></td>
<td>
<p>The x and y coordinates from the <code>BerneseOberland</code> data set.</p>
</td></tr>
<tr><td><code>elevation</code></td>
<td>
<p>The elevation covariate from the <code>BerneseOberland</code> data set.</p>
</td></tr>
<tr><td><code>forest</code></td>
<td>
<p>The forest cover covariate from the <code>BerneseOberland</code> data set.</p>
</td></tr>
<tr><td><code>elevationS</code></td>
<td>
<p>The elevation covariate standardized to mean 0, SD 1.</p>
</td></tr>
<tr><td><code>forestS</code></td>
<td>
<p>The forest cover covariate standardized to mean 0, SD 1.</p>
</td></tr>
<tr><td><code>wind</code></td>
<td>
<p>The wind covariate, generated internally.</p>
</td></tr>
<tr><td><code>field</code></td>
<td>
<p>The spatially-autocorrelated covariate, generated internally.</p>
</td></tr>
<tr><td><code>alpha0</code></td>
<td>
<p>Intercept for the detection model, equal to <code>qlogis(mean.p)</code>.</p>
</td></tr>
<tr><td><code>beta0</code></td>
<td>
<p>Intercept for the abundance model, equal to <code>qlogis(mean.psi)</code>.</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>True occupancy in each quadrat.</p>
</td></tr>
<tr><td><code>trueNocc</code></td>
<td>
<p>True number of occupied sites.</p>
</td></tr>
<tr><td><code>obsNocc</code></td>
<td>
<p>Number of sites where the species was detected.</p>
</td></tr>
<tr><td><code>true_psi_fs</code></td>
<td>
 </td></tr>
<tr><td><code>obs_psi_fs</code></td>
<td>
 </td></tr>
<tr><td><code>p</code></td>
<td>
<p>probability of detection for each survey.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>detected/non-detected data for each quadrat.</p>
</td></tr>
<tr><td><code>surveyed.sites</code></td>
<td>
<p>the IDs of the quadrats surveyed.</p>
</td></tr>
<tr><td><code>yobs</code></td>
<td>
<p>detected/non-detected data for each quadrat surveyed, NA for quadrats not surveyed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 9.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure
str(dat &lt;- simOccSpatial())
str(dat &lt;- simOccSpatial(show.plots=FALSE))

# More surveys
str(dat&lt;- simOccSpatial(nsurveys = 10))

# Minimal number of surveys is 1
str(dat&lt;- simOccSpatial(nsurveys = 1))

# A truly ubiquitous species
str(dat &lt;- simOccSpatial(mean.psi = 1))

# Only negative linear effect of elevation
str(dat &lt;- simOccSpatial(beta = c(2, 0)))

# No effect of elevation at all (see effects of spatial field now clearly)
str(dat &lt;- simOccSpatial(beta = c(0, 0)))

# Perfect detection (p = 1)
str(dat &lt;- simOccSpatial(mean.p = 1))

# No effect in detection of forest cover
str(dat &lt;- simOccSpatial(alpha = c(0, -1)))

# No effect in detection of wind speed (see neatly forest effect now)
str(dat &lt;- simOccSpatial(alpha = c(-1, 0)))

# Sample only 100 quadrats
str(dat &lt;- simOccSpatial(sample.size = 100))

# Sample all 2500 quadrats
str(dat &lt;- simOccSpatial(sample.size = 2500))

# Larger variance of the multivariate Gaussian Random variable in the random field
#  (this will increase the effect of the field on occupancy and detection)
str(dat &lt;- simOccSpatial(variance.RF = 10))

# No spatial autocorrelation (Variant 1: set variance to 0)
str(dat &lt;- simOccSpatial(variance.RF = 0))

# No spatial autocorrelation (Variant 2: set theta very close to 0,
#  but not quite 0, otherwise function breaks)
str(dat &lt;- simOccSpatial(theta.RF = 0.0001))

# Larger value of theta.RF gives larger 'islands'
#try(str(dat &lt;- simOccSpatial(theta.RF = 100)))  # Works with RandomFields

</code></pre>

<hr>
<h2 id='simOccttd'>
Simulate time-to-detection occupancy data (single visits)
</h2><span id='topic+simOccttd'></span>

<h3>Description</h3>

<p>Function simulates time-to-detection occupancy design data under the model of Garrard et al. (2008), also see Bornand et al. (2014)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simOccttd(M = 250, mean.psi = 0.4, mean.lambda = 0.3,
  beta1 = 1, alpha1 = -1, Tmax = 10, show.plot = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simOccttd_+3A_m">M</code></td>
<td>

<p>Number of sites
</p>
</td></tr>
<tr><td><code id="simOccttd_+3A_mean.psi">mean.psi</code></td>
<td>

<p>intercept of occupancy probability
</p>
</td></tr>
<tr><td><code id="simOccttd_+3A_mean.lambda">mean.lambda</code></td>
<td>

<p>intercept of Poisson rate parameter
</p>
</td></tr>
<tr><td><code id="simOccttd_+3A_beta1">beta1</code></td>
<td>

<p>slope of continuous covariate B on logit(psi)
</p>
</td></tr>
<tr><td><code id="simOccttd_+3A_alpha1">alpha1</code></td>
<td>

<p>slope of continuous covariate A on log(lambda)
</p>
</td></tr>
<tr><td><code id="simOccttd_+3A_tmax">Tmax</code></td>
<td>

<p>maximum search time (in arbitrary units, which are same as response), response will be censored at <code>Tmax</code>
</p>
</td></tr>
<tr><td><code id="simOccttd_+3A_show.plot">show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when running simulations.
</p>
</td></tr>
<tr><td><code id="simOccttd_+3A_verbose">verbose</code></td>
<td>

<p>if TRUE, output will be written to the console.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments input and the following additional elements:
</p>
<table>
<tr><td><code>covA</code></td>
<td>
<p>Simulated values of covariate A, a vector of length M</p>
</td></tr>
<tr><td><code>covB</code></td>
<td>
<p>Simulated values of covariate B, a vector of length M</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>Probability of occurrence at each site, a vector of length M</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Realized occurrence at each site, a 0/1 vector of length M</p>
</td></tr>
<tr><td><code>ttd.temp</code></td>
<td>
<p>Uncensored simulated time-to-detection at each site, a vector of length M</p>
</td></tr>
<tr><td><code>ttd</code></td>
<td>
<p>Censored simulated time-to-detection at each site, a vector of length M</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>Censoring indicator, a 0/1 vector of length M</p>
</td></tr>
<tr><td><code>sum.z</code></td>
<td>
<p>Total number of sites occupied</p>
</td></tr>
<tr><td><code>n.obs</code></td>
<td>
<p>Total number of sites where the species was observed</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Garrard, G.E., Bekessy, S.A., McCarthy, M.A., &amp; Wintle, B.A. (2008) When have we looked hard enough? A novel method for setting minimum survey effort protocols for flora surveys. <em>Austral Ecology</em>, 33, 986-998.
</p>
<p>Bornand, C.N., Kéry, M., Bueche, L., &amp; Fischer, M. (2014) Hide and seek in vegetation: time-to-detection is an efficient design for estimating detectability and occurrence. <em>Methods in Ecology and Evolution</em>, 5, 433-442.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 10.12.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure
tmp &lt;- simOccttd()
str(tmp)
</code></pre>

<hr>
<h2 id='simPH'>
Generate counts under a variant of a 'phenomenological model'
</h2><span id='topic+simPH'></span>

<h3>Description</h3>

<p>Function generates (insect) counts under a variant of a 'phenomenological model' of Dennis et al. (2016). Interannual population model is exponential population growth, with Poisson initial abundance governed by initial.lambda and annually varying growth rate (or productivity parameter) gamma. Within-year dynamics is described by a Gaussian curve with date of mean flight period mu (site- and year-specific) and length of flight period sigma (only year-specific). Counts are made subject to a detection probability (p), which varies randomly according to a uniform distribution for every single count. Counts are plotted for up to 16 populations only (but can be simulated for any number).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simPH(npop = 18, nyears = 17, nreps = 10, date.range = 1:150, initial.lambda = 300,
  gamma.parms = c(0, 0.3), mu.range = c(50, 80),  sigma.range = c(10, 20),
  p.range = c(0.4, 0.6), show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simPH_+3A_npop">npop</code></td>
<td>

<p>The number of populations.
</p>
</td></tr>
<tr><td><code id="simPH_+3A_nyears">nyears</code></td>
<td>

<p>The number of years (seasons).
</p>
</td></tr>
<tr><td><code id="simPH_+3A_nreps">nreps</code></td>
<td>

<p>The number of surveys per year.
</p>
</td></tr>
<tr><td><code id="simPH_+3A_date.range">date.range</code></td>
<td>

<p>The dates over which surveys may be conducted.
</p>
</td></tr>
<tr><td><code id="simPH_+3A_initial.lambda">initial.lambda</code></td>
<td>

<p>The Poisson mean of initial relative population size.
</p>
</td></tr>
<tr><td><code id="simPH_+3A_gamma.parms">gamma.parms</code></td>
<td>

<p>The mean and SD of lognormal interannual productivity.
</p>
</td></tr>
<tr><td><code id="simPH_+3A_mu.range">mu.range</code></td>
<td>

<p>The range of date of peak flight period (varies by site and year).
</p>
</td></tr>
<tr><td><code id="simPH_+3A_sigma.range">sigma.range</code></td>
<td>

<p>The range of sigma of Gaussian phenology curve (varies by year only).
</p>
</td></tr>
<tr><td><code id="simPH_+3A_p.range">p.range</code></td>
<td>

<p>The range of detection probabilities (varies by site, year and visit).
</p>
</td></tr>
<tr><td><code id="simPH_+3A_show.plot">show.plot</code></td>
<td>

<p>Choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments entered and the following additional elements:
</p>
<table>
<tr><td><code>gamma</code></td>
<td>
<p>(nyears-1) vector, change in abundance for each interval between years.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>site x year matrix, true relative abundance.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>site x year matrix, mean date of the flight period.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>nyears vector, half-length of flight period.</p>
</td></tr>
<tr><td><code>date</code></td>
<td>
<p>site x year x reps array, dates of the surveys.</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>site x year x reps array, phenology term.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>site x year x reps array, expected counts.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>site x year x reps array, probability of detection.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>site x year x reps array, simulated counts.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Dennis, E.B., et al (2016) Dynamic models for longitudinal butterfly data, <em>Journal of Agricultural, Biological and Environmental Statistics</em>, 21, 1-21.
</p>
<p>Kéry &amp; Royle (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 1.8.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run with the default arguments and look at the structure of the output:
set.seed(123)
tmp &lt;- simPH()
str(tmp)
summary(tmp$C)
</code></pre>

<hr>
<h2 id='simpleNmix'>
Simulate N-mixture data under a time-for-space substitution design
</h2><span id='topic+simpleNmix'></span>

<h3>Description</h3>

<p>A simple function to simulate data under binomial N-mixture model where you have a single site that is surveyed over 'nyears' primary sampling periods ('seasons', 'years'), within each of which there are 'nreps' secondary samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simpleNmix(nyears = 12, nreps = 4, beta0 = 2, beta1 = 0.1,
  alpha0 = 0.5, alpha1 = -0.1, alpha2 = 1, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simpleNmix_+3A_nyears">nyears</code></td>
<td>

<p>Number of primary sampling periods.
</p>
</td></tr>
<tr><td><code id="simpleNmix_+3A_nreps">nreps</code></td>
<td>

<p>Number of secondary samples within each primary period.
</p>
</td></tr>
<tr><td><code id="simpleNmix_+3A_beta0">beta0</code></td>
<td>

<p>the intercept of a log-linear model of expected abundance (lambda).
</p>
</td></tr>
<tr><td><code id="simpleNmix_+3A_beta1">beta1</code></td>
<td>

<p>the Time coefficient of a log-linear model for lambda.
</p>
</td></tr>
<tr><td><code id="simpleNmix_+3A_alpha0">alpha0</code></td>
<td>

<p>the intercept of a logit-linear model for detection (p).
</p>
</td></tr>
<tr><td><code id="simpleNmix_+3A_alpha1">alpha1</code></td>
<td>

<p>the Time coefficient of a logit-linear model for detection (p).
</p>
</td></tr>
<tr><td><code id="simpleNmix_+3A_alpha2">alpha2</code></td>
<td>

<p>the coefficient of a survey-specific covariate such as temperature (temp).
</p>
</td></tr>
<tr><td><code id="simpleNmix_+3A_show.plot">show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments input and the following additional elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The realized number of individuals at each primary season, a vector of length <code>nyears</code></p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>The number of individuals counted at each survey, a <code>nyears x nreps</code> matrix.</p>
</td></tr>
<tr><td><code>Time</code></td>
<td>
<p>The Time covariate, a vector of length <code>nyears</code>.</p>
</td></tr>
<tr><td><code>temp</code></td>
<td>
<p>The temperature covariate, a <code>nyears x nreps</code> matrix.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The probability of detection, a <code>nyears x nreps</code> matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 6.12.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a data set with the default arguments and look at the structure of the output
tmp &lt;- simpleNmix()
str(tmp)

</code></pre>

<hr>
<h2 id='simPOP'>
Simulate data for a demographic state-space model
</h2><span id='topic+simPOP'></span>

<h3>Description</h3>

<p>Simulate multiple time-series of counts under a pure Markov model (with exponential population model) or under an extended Markov model with exponential-plus-random-immigration population model; see Sollmann et al.(2015). Default is Markov model, setting <code>sd.rho</code> to a value greater than 0 changes to extended Markov and sets the amount of random immigration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simPOP(M = 100, T = 10, mean.lam = 3, beta.lam = 0, sd.log.lam = 0,
  mean.gamma = 1.0, beta.gamma = 0, sd.log.gamma.site = 0,
  sd.log.gamma.time = 0, sd.log.gamma.survey = 0, sd.rho = 0,
  mean.p = 0.6, beta.p = 0, sd.logit.p.site = 0, sd.logit.p.time = 0,
  sd.logit.p.survey = 0, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simPOP_+3A_m">M</code></td>
<td>

<p>The number of sites.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_t">T</code></td>
<td>

<p>The number of years.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_mean.lam">mean.lam</code></td>
<td>

<p>The mean abundance for year 1.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_beta.lam">beta.lam</code></td>
<td>

<p>The covariate coefficient for lambda.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_sd.log.lam">sd.log.lam</code></td>
<td>

<p>The over-dispersion in lambda.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_mean.gamma">mean.gamma</code></td>
<td>

<p>The mean population growth rate.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_beta.gamma">beta.gamma</code></td>
<td>

<p>The covariate coefficient for gamma.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_sd.log.gamma.site">sd.log.gamma.site</code></td>
<td>

<p>SD of random site effects for gamma.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_sd.log.gamma.time">sd.log.gamma.time</code></td>
<td>

<p>SD of random time effects for gamma.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_sd.log.gamma.survey">sd.log.gamma.survey</code></td>
<td>

<p>SD of random survey (site+time) effects for gamma.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_sd.rho">sd.rho</code></td>
<td>

<p>The random immigration term.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_mean.p">mean.p</code></td>
<td>

<p>The mean detection probability.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_beta.p">beta.p</code></td>
<td>

<p>The covariate coefficient for p.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_sd.logit.p.site">sd.logit.p.site</code></td>
<td>

<p>SD of random site effects for p on the logit scale.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_sd.logit.p.time">sd.logit.p.time</code></td>
<td>

<p>SD of random time effects for p on the logit scale.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_sd.logit.p.survey">sd.logit.p.survey</code></td>
<td>

<p>SD of random survey (site+time) effects for p on the logit scale.
</p>
</td></tr>
<tr><td><code id="simPOP_+3A_show.plot">show.plot</code></td>
<td>

<p>Choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the arguments entered and the following additional elements:
</p>
<table>
<tr><td><code>Xsite1</code></td>
<td>
<p>M vector, site covariate affecting initial abundance (lambda).</p>
</td></tr>
<tr><td><code>Xsiteyear1</code></td>
<td>
<p>M x T matrix, yearly site covariate affecting recruitment (gamma).</p>
</td></tr>
<tr><td><code>Xsiteyear2</code></td>
<td>
<p>M x T matrix, yearly site covariate affecting detection (p).</p>
</td></tr>
<tr><td><code>eps.N</code></td>
<td>
<p>M vector, site over-dispersion at t = 1.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>M vector, abundance in year 1.</p>
</td></tr>
<tr><td><code>eps.gamma.site</code></td>
<td>
<p>M vector, random site effect for gamma.</p>
</td></tr>
<tr><td><code>eps.gamma.time</code></td>
<td>
<p>T vector, random time effect for gamma.</p>
</td></tr>
<tr><td><code>eps.gamma.survey</code></td>
<td>
<p>M x T matrix, random survey effect for gamma.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>M x T matrix, population growth rate.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>(T-1) vector, immigration rate.</p>
</td></tr>
<tr><td><code>eps.p.site</code></td>
<td>
<p>M vector, random site effect for detection.</p>
</td></tr>
<tr><td><code>eps.p.time</code></td>
<td>
<p>T vector, random time effect for detection.</p>
</td></tr>
<tr><td><code>eps.p.survey</code></td>
<td>
<p>M x T matrix, random survey effect for detection.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>M x T matrix, detection probability.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>M x T matrix, true population.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>M x T matrix, simulated counts.</p>
</td></tr>
<tr><td><code>zeroNyears</code></td>
<td>
<p>scalar, sum(N == 0).</p>
</td></tr>
<tr><td><code>Nextinct</code></td>
<td>
<p>scalar, number of sites where N == 0 at time T.</p>
</td></tr>
<tr><td><code>extrate</code></td>
<td>
<p>scalar, proportion of sites where N == 0 at time T.</p>
</td></tr>
<tr><td><code>sumN</code></td>
<td>
<p>T vector, total population in each year.</p>
</td></tr>
<tr><td><code>gammaX</code></td>
<td>
<p>(T-1) vector, realized population growth rate.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Sollmann, R. et al. (2015) An open-population hierarchical distance sampling model. <em>Ecology</em>, 96, 325-331.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 1.7.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run with the default arguments and look at the structure of the output
set.seed(123)
tmp &lt;- simPOP()
str(tmp)
head(tmp$C)


</code></pre>

<hr>
<h2 id='simPPe'>
Simulate a spatial point pattern in a heterogeneous landscape
</h2><span id='topic+simPPe'></span>

<h3>Description</h3>

<p>The function simulates a spatial point pattern in a heterogeneous landscape simulated on a square landscape. The study area ('core') is simulated inside the larger landscape that includes a buffer. The size of the core is defined by the lscape.size minus twice the buffer.
</p>
<p>There is one habitat covariate X that affects the intensity of the points. X is spatially structured with negative-exponential spatial autocorrelation; the parameters of the field can be chosen to create large 'islands' of similar values or no 'islands' at all, in which case the field is spatially unstructured.
</p>
<p>The intensity of STATIC points (e.g. animal activity centers) may be inhomogeneous and affected by the coefficient beta, which is the log-linear effect of X.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>
<p>Previous versions used <span class="pkg">RandomFields</span>, but that is not currently available on CRAN. <span class="pkg">fields</span> is now used, but it cannot deal with large values of <code>lscape.size</code> and <code>theta.X</code>. If you have <span class="pkg">RandomFields</span> installed (perhaps by getting it from the CRAN archive), you can load a version of <code>simPPe</code> that supports it with <code>source(system.file("RandomFieldsSupport", "simPPe.R", package="AHMbook"))</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simPPe(lscape.size = 150, buffer.width = 25, variance.X = 1, theta.X = 10,
  M = 250, beta = 1, quads.along.side = 6, show.plots = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simPPe_+3A_lscape.size">lscape.size</code></td>
<td>

<p>size (width = height) of the square landscape, including core and buffer.
</p>
</td></tr>
<tr><td><code id="simPPe_+3A_buffer.width">buffer.width</code></td>
<td>

<p>width of buffer around core study area.
</p>
</td></tr>
<tr><td><code id="simPPe_+3A_variance.x">variance.X</code></td>
<td>

<p>variance of Gaussian random field (covariate X).
</p>
</td></tr>
<tr><td><code id="simPPe_+3A_theta.x">theta.X</code></td>
<td>

<p>scale parameter of correlation in field (must be &gt;0).
</p>
</td></tr>
<tr><td><code id="simPPe_+3A_m">M</code></td>
<td>

<p>expected number of activity centers in core area.
</p>
</td></tr>
<tr><td><code id="simPPe_+3A_beta">beta</code></td>
<td>

<p>coefficient of the habitat covariate.
</p>
</td></tr>
<tr><td><code id="simPPe_+3A_quads.along.side">quads.along.side</code></td>
<td>

<p>number of quadrats along the side of the core area; the total number of quadrats will be quads.along.side^2, thus indirectly defining the quadrat area.
</p>
</td></tr>
<tr><td><code id="simPPe_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, summary plots are displayed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>core</code></td>
<td>
<p>range of x and y coordinates in the 'core'</p>
</td></tr>
<tr><td><code>M2</code></td>
<td>
<p>number of ACs in the total landscape, including the buffer</p>
</td></tr>
<tr><td><code>grid</code></td>
<td>
<p>coordinates of the center of each pixel</p>
</td></tr>
<tr><td><code>pixel.size</code></td>
<td>
<p>length of side of each pixel</p>
</td></tr>
<tr><td><code>size.core</code></td>
<td>
<p>the width=height of the core area</p>
</td></tr>
<tr><td><code>prop.core</code></td>
<td>
<p>the proportion of the landscape inside the core</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>matrix of covariate values for each pixel</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>matrix of probabilities of an AC being inside each pixel (sums to 1)</p>
</td></tr>
<tr><td><code>pixel.id</code></td>
<td>
<p>the ID of the pixel for each AC</p>
</td></tr>
<tr><td><code>u</code></td>
<td>
<p>2-column matrix, coordinate of each AC</p>
</td></tr>
<tr><td><code>nsite</code></td>
<td>
<p>number of quadrats</p>
</td></tr>
<tr><td><code>quad.size</code></td>
<td>
<p>width = height of each quadrat</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>
<p>boundaries of the quadrats</p>
</td></tr>
<tr><td><code>mid.pt</code></td>
<td>
<p>mid-points of the quadrats</p>
</td></tr>
<tr><td><code>lambda_pp</code></td>
<td>
<p>intensity of point pattern (ACs per unit area)</p>
</td></tr>
<tr><td><code>Nac</code></td>
<td>
<p>site-specific abundance of ACs</p>
</td></tr>
<tr><td><code>zac</code></td>
<td>
<p>site-specific occurrence (0/1) of ACs</p>
</td></tr>
<tr><td><code>E_N</code></td>
<td>
<p>average realized abundance per quadrat</p>
</td></tr>
<tr><td><code>E_z</code></td>
<td>
<p>average realized occupancy per quadrat</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle.
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 10.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Nice plot (produces the really nice Fig. 10-2 in the book)
# RNGkind(sample.kind = "Rounding") # run this for R &gt;= 3.6.0
set.seed(117, kind="Mersenne-Twister")
# Fails if RandomFields is not available
#try(str(dat &lt;- simPPe(lscape.size = 200, buffer.width = 25, variance.X = 1,
#  theta.X = 70, M = 200, beta = 1, quads.along.side = 6)))

str(dat &lt;- simPPe(lscape.size = 200, buffer.width = 20, variance.X = 1,
  theta.X = 5, M = 250, beta = 1, quads.along.side = 6))
</code></pre>

<hr>
<h2 id='simSpatialDSline'>
Simulate data for a standardized line transect
</h2><span id='topic+simSpatialDSline'></span>

<h3>Description</h3>

<p>This simulates line transect distance sampling data with a spatial distribution of objects in a heterogeneous landscape where the parameter beta controls the effect of habitat. Habitat is simulated according to a Gaussian random field model defined within the function. Uses a half normal detection model (if perp = TRUE) or a Gaussian hazard model (perp = FALSE).
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simSpatialDSline(N=1000, beta = 1, sigma=0.25, alpha0 = -2, W=1/2, L = 4,
    perp=FALSE, show.plots=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simSpatialDSline_+3A_n">N</code></td>
<td>

<p>total population size in the rectangle
</p>
</td></tr>
<tr><td><code id="simSpatialDSline_+3A_beta">beta</code></td>
<td>

<p>coefficient of spatial covariate x for the density model.
</p>
</td></tr>
<tr><td><code id="simSpatialDSline_+3A_sigma">sigma</code></td>
<td>

<p>scale of half-normal detection function
</p>
</td></tr>
<tr><td><code id="simSpatialDSline_+3A_alpha0">alpha0</code></td>
<td>

<p>intercept of the hazard function.
</p>
</td></tr>
<tr><td><code id="simSpatialDSline_+3A_w">W</code></td>
<td>

<p>half-width of the rectangle, which extends W each side of the transect line.
</p>
</td></tr>
<tr><td><code id="simSpatialDSline_+3A_l">L</code></td>
<td>

<p>length of the transect.
</p>
</td></tr>
<tr><td><code id="simSpatialDSline_+3A_perp">perp</code></td>
<td>

<p>if TRUE, data are simulated for a traditional distance sampling model with perpendicular distances; if FALSE (the default) a model with 'forward distance' data, ie, the distance from the observer to the animal on first detection.
</p>
</td></tr>
<tr><td><code id="simSpatialDSline_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, summary plots are displayed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>delta</code></td>
<td>
<p>the distance between pixel centers (spatial resolution of the raster</p>
</td></tr>
<tr><td><code>grid</code></td>
<td>
<p>2-column matrix with x/y coordinates of all pixels</p>
</td></tr>
<tr><td><code>Habitat</code></td>
<td>
<p>value of habitat covariate for each pixel</p>
</td></tr>
<tr><td><code>Habraster</code></td>
<td>
<p>a Raster object with the habitat covariate</p>
</td></tr>
<tr><td><code>u1</code>, <code>u2</code></td>
<td>
<p>x and y coordinates for all the animals in the population</p>
</td></tr>
<tr><td><code>traps</code></td>
<td>
<p>2-column matrix of trap locations</p>
</td></tr>
</table>
<p>If <code>perp = TRUE</code> we have
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a 2-column matrix with x and y coordinates of each animal captured.</p>
</td></tr>
<tr><td><code>pixel</code></td>
<td>
<p>pixel ID for each animal captured.</p>
</td></tr>
</table>
<p>and if <code>perp = FALSE</code> we have
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>a matrix with rows for each animal captured and columns for trap of first capture, distance from trap to animal, and x and y coordinates of the animal.</p>
</td></tr>
<tr><td><code>pbar</code></td>
<td>
<p>probability that each animal is the population is captured at least once</p>
</td></tr>
<tr><td><code>pixel</code></td>
<td>
<p>pixel ID for each animal captured.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 11.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run the function with default values and look at the output
str(tmp &lt;- simSpatialDSline(), 1)  # use str(., max.level=1) to limit the amount of output.
</code></pre>

<hr>
<h2 id='simSpatialDSte'>
Simulate data for replicate line transect surveys with temporary emigration
</h2><span id='topic+simSpatialDSte'></span>

<h3>Description</h3>

<p>This simulates line transect distance sampling data with a spatial distribution of objects in a heterogeneous landscape where the parameter beta controls the effect of habitat. Multiple sample occasions are simulated and temporary emigration is allowed (parameter phi). Habitat is simulated according to a Gaussian random field model defined within the function. Uses a half normal detection model (if perp = TRUE) or a Gaussian hazard model (perp = FALSE).
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simSpatialDSte(nsites=28, dim=10, beta=1, lam0=2.5, nsurveys=4, sigma=3,
  phi=0.6, theta=2, show.plots=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simSpatialDSte_+3A_nsites">nsites</code></td>
<td>

<p>number of sites
</p>
</td></tr>
<tr><td><code id="simSpatialDSte_+3A_dim">dim</code></td>
<td>

<p>number of pixels along each side of the square site
</p>
</td></tr>
<tr><td><code id="simSpatialDSte_+3A_beta">beta</code></td>
<td>

<p>the effect of habitat on the number of individuals in a pixel.
</p>
</td></tr>
<tr><td><code id="simSpatialDSte_+3A_lam0">lam0</code></td>
<td>

<p>expected population size at each site
</p>
</td></tr>
<tr><td><code id="simSpatialDSte_+3A_nsurveys">nsurveys</code></td>
<td>

<p>the number of replicate surveys
</p>
</td></tr>
<tr><td><code id="simSpatialDSte_+3A_sigma">sigma</code></td>
<td>

<p>scale of half-normal detection function
</p>
</td></tr>
<tr><td><code id="simSpatialDSte_+3A_phi">phi</code></td>
<td>

<p>probability an individual is available for detection, ie, not temporarily emigrated.
</p>
</td></tr>
<tr><td><code id="simSpatialDSte_+3A_theta">theta</code></td>
<td>

<p>exponential correlation in the spatial covariate.
</p>
</td></tr>
<tr><td><code id="simSpatialDSte_+3A_show.plots">show.plots</code></td>
<td>

<p>the number of sites for which plots should be displayed; set to 0 to suppress plotting.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>npixels</code></td>
<td>
<p>the number of pixels in each site (= dim^2)</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>distance from line to edge of square (= dim/2)</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>true number of individuals at each site</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>perpendicular distance of each pixel from the line</p>
</td></tr>
<tr><td><code>Habitat</code></td>
<td>
<p>pixels x sites matrix, value of habitat covariate for each pixel</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>sites x pixels x surveys array, number of animals detected</p>
</td></tr>
<tr><td><code>Counts</code></td>
<td>
<p>sites x surveys matrix, number of animals detected (summed over pixels)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mizel et al (2018) Appendix S1, based in turn on Kéry &amp; Royle (2016).
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em>.
</p>
<p>Mizel, J.D., Schmidt, J.H., &amp; Lindberg, M.S. (2018) Accommodating temporary emigration in spatial distance sampling models. <em>Journal of Applied Ecology</em>, 55, 1456-1464.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 11.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run the function with default values and look at the output
str(tmp &lt;- simSpatialDSte())
</code></pre>

<hr>
<h2 id='spline.prep'>
Prepare input for BUGS model when fitting a spline for a covariate
</h2><span id='topic+spline.prep'></span>

<h3>Description</h3>

<p>Function chooses knots and creates design matrices for fixed and random-effects parts of a spline model for a chosen covariate. Based on code by Crainiceanu et al. (2005) and Zuur et al. (2012). Allows you to choose number of knots or else uses it by the rule given in Crainiceanu et al. (2005). Prepares fixed part of covariate as a quadratic polynomial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spline.prep(cov, nknot = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spline.prep_+3A_cov">cov</code></td>
<td>

<p>the covariate, a numeric vector
</p>
</td></tr>
<tr><td><code id="spline.prep_+3A_nknot">nknot</code></td>
<td>

<p>optional, number of knots
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>cov</code></td>
<td>
<p>The input covariate</p>
</td></tr>
<tr><td><code>knots</code></td>
<td>
<p>The values of the knots</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>The fixed-effects design matrix</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>The random-effects design matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Crainiceanu, C.M., Ruppert, D., &amp; Wand, M.P. (2005) Bayesian analysis for penalized spline regression using WinBUGS. <em>Journal of Statistical Software</em>, 14.
</p>
<p>Zuur, A.F., Saveliev, A.A., Ieno, E.N. (2012) <em>Zero-inflated Models and Generalized Linear Mixed Models with R</em>. Highlands Statistics
</p>
<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 10.14.
</p>

<hr>
<h2 id='spottedWoodpecker'>
Data for observations of Middle Spotted Woodpecker in Switzerland
</h2><span id='topic+spottedWoodpecker'></span>

<h3>Description</h3>

<p>The data set is based on checklists which volunteers submit from their bird-watching trips and which were then summarized by day and site (1 km2 quadrat) such that we have the number of surveys (= checklists) per quadrat and day, and the number among these on which a Middle-Spotted Woodpecker was recorded, during 162 days (Julian days 51–212, corresponding to 20 February–31 July). There are data from a total of 144,517 recorded surveys on 116,204 day/quadrat combinations during 26 years from 1545 1 km2 quadrats in which the species was ever recorded in Switzerland since 1985.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("spottedWoodpecker")</code></pre>


<h3>Format</h3>

<p><code>spottedWoodpecker</code> is a data frame with 116,204 rows and 7 columns:
</p>

<dl>
<dt>site </dt><dd><p>quadrat identifier.</p>
</dd>
<dt>coordx, coordy </dt><dd><p>the x and y coordinates of the center of the quadrat; the coordinate reference system intentionally not specified.</p>
</dd>
<dt>year, jdate </dt><dd><p>the year and Julian date of the observations.</p>
</dd>
<dt>y </dt><dd><p>the number of surveys during which the species was detected.</p>
</dd>
<dt>nsurveys </dt><dd><p>the number of recorded surveys in the quadrat on that day.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Database of Swiss Ornithological Institute (courtesy of Nicolas Strebel).
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 4.11.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(spottedWoodpecker)
str(spottedWoodpecker)
</code></pre>

<hr>
<h2 id='standardize'>
Scaling and centering of vectors, matrices and arrays
</h2><span id='topic+standardize'></span><span id='topic+standardize2match'></span>

<h3>Description</h3>

<p>Maps a numeric variable to a new object with the same dimensions. <code>standardize</code> is typically used to standardize a covariate to mean 0 and SD 1. <code>standardize2match</code> is used to standardize one object using the mean and SD of another; it is a wrapper for <code>standardize(x, center=mean(y), scale=sd(y))</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>standardize(x, center = TRUE, scale = TRUE)
standardize2match(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="standardize_+3A_x">x</code>, <code id="standardize_+3A_y">y</code></td>
<td>

<p>a numeric vector, matrix or multidimensional array; <code>NA</code> and <code>NaN</code> are allowed; <code>Inf</code> and <code>-Inf</code> will produce all-<code>NaN</code> output if either <code>center</code> or <code>scale</code> is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="standardize_+3A_center">center</code></td>
<td>

<p>either a logical or a numeric value of length 1.
</p>
</td></tr>
<tr><td><code id="standardize_+3A_scale">scale</code></td>
<td>

<p>either a logical or a numeric value of length 1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>standardize</code> differs from <code><a href="base.html#topic+scale">scale</a></code> by (1) accepting multidimensional arrays but not data frames; (2) <em>not</em> standardizing column-wise but using a single value to center or to scale; (3) if <code>x</code> is a vector, the output will be a vector (not a 1-column matrix). If each column in the matrix represents a different variable, use <code>scale</code> not <code>standardize</code>.
</p>
<p>Centering is performed before scaling.
</p>
<p>If <code>center</code> is numeric, that value will be subtracted from the whole object. If logical and TRUE, the mean of the object (after removing NAs) will be subtracted.
</p>
<p>If <code>scale</code> is numeric, the whole object will be divided by that value. If logical and TRUE, the standard deviation of the object (after removing NAs) will be used; this may not make sense if <code>center = FALSE</code>.
</p>


<h3>Value</h3>

<p>A numeric object of the same dimensions as <code>x</code> with the standardized values. NAs in the input will be preserved in the output.
</p>
<p>For the default arguments, the object returned will have mean approximately zero and SD 1. (The mean is not exactly zero as scaling is performed after centering.)
</p>


<h3>Author(s)</h3>

<p>Mike Meredith, after looking at the code of <code>base::scale</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate some fake elevation data
elev &lt;- runif(100, min=100, max=500)
mean(elev) ; sd(elev)
str( e &lt;- standardize(elev) )
mean(e) ; sd(e)

# Standardize so that e=0 corresponds to exactly 300m and +/- 1 to
#   a change of 100m:
e &lt;- standardize(elev, center=300, scale=100)
mean(e)
mean(elev) - 300
range(e)
range(elev) - 300

# Generate data matrix for survey duration for 3 surveys at 10 sites
dur &lt;- matrix(round(runif(30, 20, 60)), nrow=10, ncol=3)
d &lt;- standardize(dur)
mean(d) ; sd(d)

# Standardize new data to match the mean and SD of 'dur'
(new &lt;- seq(20, 60, length.out=11))
standardize2match(new, dur)

# compare with base::scale
dx &lt;- base::scale(dur)
colMeans(dx) ; apply(dx, 2, sd)
colMeans(d) ; apply(d, 2, sd)
# Don't use 'standardize' if the columns in the matrix are different variables!
</code></pre>

<hr>
<h2 id='SwissAtlasHa'>
Data for 1ha quadrats from the Swiss Breeding Bird Atlas
</h2><span id='topic+SwissAtlasHa'></span>

<h3>Description</h3>

<p>A 1ha-scale subset of the count data from the most recent Swiss Breeding Bird Atlas (Knaus et al. 2018). The data consists of replicate counts of birds from 2,318 1ha quadrats for 78 passerine species. Each quadrat is surveyed up to three times during the breeding season (only twice above the tree line).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SwissAtlasHa")</code></pre>


<h3>Format</h3>

<p><code>SwissAtlasHa</code> is a list with 3 elements:
</p>

<dl>
<dt><b>counts </b></dt><dd><p>a sites x replicates x species array of counts</p>
</dd>
<dt><b>sites </b></dt><dd><p>a data frame with rows for 2318 1ha quadrats and the following columns:
</p>

<ul>
<li><p> x : the x coordinate of the center of the quadrat; the coordinate reference system is intentionally not specified.
</p>
</li>
<li><p> y : the y coordinate of the center of the quadrat.
</p>
</li>
<li><p> elevation : the mean elevation of the quadrat, m.
</p>
</li>
<li><p> slope : the slope.
</p>
</li>
<li><p> north : the aspect, with due south = -1, due north = 1.
</p>
</li>
<li><p> forest : proportion of forest cover.
</p>
</li>
<li><p> nsurvey : the number of replicate surveys carried out in the quadrat.
</p>
</li></ul>
</dd>
<dt><b>date </b></dt><dd><p>a sites x replicates matrix with Julian dates of the surveys, 1 January = 1</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swiss Ornithological Institute
</p>


<h3>References</h3>

<p>Knaus, P., S. Antoniazza, S. Wechsler, J. Guélat, M. Kéry, N. Strebel, &amp; T. Sattler (2018) Brutvogelatlas 2013–2016. Bestandsentwicklung der Brutvögel der Schweiz und des Fürstentums Liechtensteins (Swiss Breeding Bird Atlas 2013–2016). Schweizerische Vogelwarte, Sempach.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 8.4.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SwissAtlasHa)
str(SwissAtlasHa)
# display the species names:
dimnames(SwissAtlasHa$counts)[[3]]
</code></pre>

<hr>
<h2 id='SwissEagleOwls'>
Territory-level, multi-state detection/nondetection data for Eagle Owls in Switzerland
</h2><span id='topic+SwissEagleOwls'></span>

<h3>Description</h3>

<p>Multi-state detection/nondetection data stem from more or less opportunistic surveys in a total of 274 territories of the Eurasian Eagle Owl (<em>Bubo bubo</em>), the largest owl in the world, between 2007 and 2016 (10 years). Sites are all over Switzerland and represent the complete list of sites where a territorial Eagle Owl was ever detected during this period. For site/year combinations with more than 20 observations, 20 were randomly selected for inclusion.
</p>
<p>The data set recognizes four observed states: 'nondetection', 'detection of single bird', 'detection of a pair without breeding evidence' and 'detection of a pair with confirmed breeding'; these being the classical criteria of bird atlases for possible, probable or confirmed breeding. For the analysis in the book, the last two are aggregated into a single state 'Pair'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SwissEagleOwls")</code></pre>


<h3>Format</h3>

<p><code>SwissEagleOwls</code> is a list with 2 elements:
</p>

<dl>
<dt><b>obs </b></dt><dd><p>a data frame with a row for each of the 5974 observations and the following columns:
</p>

<ul>
<li><p> site_name : a numeric site ID.
</p>
</li>
<li><p> year : the year of the observation.
</p>
</li>
<li><p> jdate : the Julian date of the observation (1 = Jan 1st).
</p>
</li>
<li><p> y : the observed state: 0 = species not detected; 1 = detection of a single bird; 2 = detection of a pair without evidence of breeding; 3 = detection of a pair with evidence of breeding.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>sites </b></dt><dd><p>a data frame with rows for 274 1x1km quadrats containing the sites, and the following columns:
</p>

<ul>
<li><p> site_name : the numeric site ID, corresponding to site_name in the obs data frame.
</p>
</li>
<li><p> region : codes for six regions of Switzerland.
</p>
</li>
<li><p> elev : the elevation of the center of the quadrat, m.
</p>
</li>
<li><p> forest : proportion of the quadrat covered by forest.
</p>
</li>
<li><p> slope : the slope of the quadrat in degrees.
</p>
</li>
<li><p> roads : total road length in the quadrat, m.
</p>
</li></ul>
</dd></dl>



<h3>Source</h3>

<p>Swiss Ornithological Institute
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 6.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("SwissEagleOwls")
str(SwissEagleOwls)
</code></pre>

<hr>
<h2 id='SwissMarbledWhite'>
Data for Swiss Marbled White butterflies
</h2><span id='topic+SwissMarbledWhite'></span>

<h3>Description</h3>

<p>Detection/nondetection data for the Marbled White butterfly (<em>Melanargia galathea</em>) collected in the canton of Aargau, Switzerland, as part of the Aargau Biodiversity Monitoring Program (LANAG). 519 study plots were each sampled once every five years from 1998 to 2010 with 11 visits each year, resulting in 1337 observed detection histories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SwissMarbledWhite")</code></pre>


<h3>Format</h3>

<p>A data frame with 1337 rows and the following columns:
</p>

<dl>
<dt>site </dt><dd><p>identification number for site</p>
</dd>
<dt>year </dt><dd><p>the year of the record</p>
</dd>
<dt>Day1, Day2, Day3, Day4, Day5, Day6, Day7, Day8, Day9, Day10, Day11 </dt><dd><p>Julian date of the survey, 1 = 1st April. NA indicates that the date of the survey was not recorded; see Examples for a way to impute dates.</p>
</dd>
<dt>y1, y2, y3, y4, y5, y6, y7, y8, y9, y10, y11 </dt><dd><p>1 if the species was recorded during the survey, 0 otherwise.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Biodiversity Monitoring Program in the canton of Aargau, Switzerland (Courtesy Isabelle Flöss, Abteilung Landschaft und Gewässer des Kanton Aargau). See Appendix C of Roth et al. (2014). 
</p>
<p><a href="https://figshare.com/articles/dataset/Appendix_C_Field_methods_and_analyses_of_the_butterfly_surveys_of_the_Aargau_Biodiversity_Monitoring_Program_/3559965/1">https://figshare.com/articles/dataset/Appendix_C_Field_methods_and_analyses_of_the_butterfly_surveys_of_the_Aargau_Biodiversity_Monitoring_Program_/3559965/1</a>
</p>


<h3>References</h3>

<p>Roth, T., Strebel, N. and Amrhein, V. (2014), Estimating unbiased phenological trends by adapting site-occupancy models. <em>Ecology</em>, 95: 2144-2154
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 4.13.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UKmarbledWhite">UKmarbledWhite</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SwissMarbledWhite)
str(SwissMarbledWhite)

# Data preparation for AHM2 section 4.13
y &lt;- as.matrix(SwissMarbledWhite[,14:24])    # Grab detection/nondetection data
DATE &lt;- as.matrix(SwissMarbledWhite[,3:13])  # Grab survey dates
for(t in 1:11) {               # Mean-impute date (but don't transform)
  DATE[is.na(DATE[,t]),t] &lt;- mean(DATE[,t], na.rm=TRUE)
}
year &lt;- SwissMarbledWhite$year
nsites &lt;- length(unique(SwissMarbledWhite$site))
nyears &lt;- length(unique(SwissMarbledWhite$year))
nsurveys &lt;- ncol(y)
nobs &lt;- nrow(y)
</code></pre>

<hr>
<h2 id='SwissSquirrels'>
Data for Red Squirrels in Switzerland from the Swiss breeding bird survey MHB
</h2><span id='topic+SwissSquirrels'></span>

<h3>Description</h3>

<p>A file with detection/nondetection data for the Red Squirrel (<em>Sciurus vulgaris</em>) in 265 1 km2 survey quadrats in Switzerland for 2007, together with covariates (data for the two remaining among the total of 267 quadrats in that monitoring program were not available). See Examples for code to load the data.
</p>


<h3>Format</h3>

<p>The file <code>SwissSquirrels.txt</code> is a tab-delimited text file with 265 rows and the following columns:
</p>

<ul>
<li><p> spec.name : the species name.
</p>
</li>
<li><p> coordx : the x coordinate of the center of the quadrat; the coordinate reference system intentionally not specified.
</p>
</li>
<li><p> coordy : the y coordinate of the center of the quadrat.
</p>
</li>
<li><p> ele : the mean elevation of the quadrat, m.
</p>
</li>
<li><p> route : the length of the route walked in the quadrat, km.
</p>
</li>
<li><p> forest : percentage forest cover.
</p>
</li>
<li><p> det071,	det072,	det073 : 1/0 detection data for 3 survey occasions in 2007.
</p>
</li>
<li><p> date071, date072, date073 : Julian date for the 3 survey occasions (1 = 1st April).
</p>
</li>
<li><p> dur071, dur072, dur073 : duration of the 3 survey occasions (mins).
</p>
</li></ul>


<h3>Source</h3>

<p>Swiss Ornithological Institute
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 10.9.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To read in the text file
fn &lt;- file.path(find.package("AHMbook"), "extdata", "SwissSquirrels.txt")
data &lt;- read.table(fn, header = TRUE)
str(data)

</code></pre>

<hr>
<h2 id='SwissTits'>
Data from the Swiss Breeding Bird Survey for 6 species of tits
</h2><span id='topic+SwissTits'></span>

<h3>Description</h3>

<p>The Swiss breeding bird survey (&quot;Monitoring Häufige Brutvögel&quot; MHB) has monitored the populations of approximately 150 common species since 1999. The MHB sample consists of 267 1-km squares that are laid out as a grid across Switzerland. Fieldwork is conducted by about 200 skilled birdwatchers annually, most of them volunteers. Avian populations are monitored using a simplified territory mapping protocol (also called spot-mapping West of the Atlantic), where each square is surveyed up to three times during the breeding season (only twice above the tree line around 2000 m elevation). Surveys are conducted along a transect that does not change over the years and is 4-6 kms in length on average.
</p>
<p>The list <code>SwissTits</code> has the data for six species of tits from 2004 to 2013. There are some missing values: see Details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SwissTits")</code></pre>


<h3>Format</h3>

<p><code>SwissTits</code> is a list with 5 elements:
</p>

<dl>
<dt><b>species </b></dt><dd><p>a data frame with a row for each species and the following columns:
</p>

<ul>
<li><p> specid : a numeric species ID based on phylogeny.
</p>
</li>
<li><p> latname : a 6-letter abbreviation of the Latin name.
</p>
</li>
<li><p> name : the English name.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>sites </b></dt><dd><p>a data frame with a row for each 1x1 km quadrat and the following columns:
</p>

<ul>
<li><p> siteID : an alphanumeric site identifier.
</p>
</li>
<li><p> coordx : the x coordinate of the center of the quadrat; the coordinate reference system intentionally not specified.
</p>
</li>
<li><p> coordy : the y coordinate of the center of the quadrat.
</p>
</li>
<li><p> AQ : an identifier for the 10km x 10km block called &quot;Atlas Quadrat&quot; within which the site falls.
</p>
</li>
<li><p> AQ.coordx : the x coordinate of the center of the AQ.
</p>
</li>
<li><p> AQ.coordy : the y coordinate of the center of the AQ.
</p>
</li>
<li><p> elev : the mean elevation of the quadrat, m.
</p>
</li>
<li><p> rlength : the length of the route walked in the quadrat, km.
</p>
</li>
<li><p> forest : percentage forest cover.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>counts </b></dt><dd><p>a sites x replicates x years x species array of counts</p>
</dd>
<dt><b>date </b></dt><dd><p>a sites x replicates x years array with Julian dates of the surveys, 1 April = 1</p>
</dd>
<dt><b>dur </b></dt><dd><p>a sites x replicates x years array with the duration of each survey, mins</p>
</dd>
</dl>



<h3>Details</h3>

<p>Missing values in the <code>date</code> array indicate that the corresponding survey was not carried out.
</p>
<p>On 26 occasions when surveys were carried out, the duration was not recorded, resulting in additional NAs in the <code>dur</code> array.
</p>
<p>A new method for recording breeding territories was introduced in 2004, but the old protocol was in use at some sites until 2013. Surveys with the old protocol have the counts shown as NA in the <code>count</code> array.
</p>


<h3>Note</h3>

<p>Sections 6.9.1 and 6.13.1 of the AHM1 book have code to read in data from a CSV file, &quot;SwissTits_mhb_2004_2013.csv&quot;. The <code>SwissTits</code> list has all the same data in a more compact format. See Examples for ways to generate the objects used in the book from the list.
</p>


<h3>Source</h3>

<p>Swiss Ornithological Institute
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 6.9.1 and 6.13.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SwissTits)
str(SwissTits)

# Section 6.9.1, foot of p.257 and top of p.258
# -------------
y0 &lt;- SwissTits$counts[, , '2013', 'Great tit']
( NA.sites &lt;- which(rowSums(is.na(y0)) == 3) ) # Unsurveyed sites
y &lt;- y0[-NA.sites, ]                 # Drop them from the count data
tits &lt;- SwissTits$sites[-NA.sites, ] # Also drop from the site covariates
str(y)
# Get date and duration data for 2013, without the NA.sites rows:
date &lt;- SwissTits$date[-NA.sites, , '2013']
dur &lt;- SwissTits$dur[-NA.sites, , '2013']

# Section 6.13.1, p.303
# --------------
# Get the count data for 2013 (all species)
y0 &lt;- SwissTits$count[, , '2013', ]
str(y0)
# We keep the sites with count data, remove those with 3 NAs
# See which sites have counts in 2013 for (say) Great tits:
keep &lt;- which(rowSums(is.na(y0[, , "Great tit"])) != 3)
length(keep)
y &lt;- y0[keep, , ]
# Get the covariate data for the 'keep' sites
elev &lt;- SwissTits$sites$ele[keep]
route &lt;- SwissTits$sites$rlength[keep]
forest &lt;- SwissTits$sites$forest[keep]
date &lt;- SwissTits$date[keep, , '2013']  # Survey date
dur &lt;- SwissTits$dur[keep, , '2013']    # Survey duration

# Degrade counts to detection/nondetection data
y3DRN &lt;- y
y3DRN[y3DRN &gt; 1] &lt;- 1
str(y3DRN)
# Final detail...
( spec.names &lt;- paste0(SwissTits$species$name, "s") )
</code></pre>

<hr>
<h2 id='treeSparrow'>
American Tree Sparrow data from Alaska
</h2><span id='topic+treeSparrow'></span>

<h3>Description</h3>

<p>Mizel et al. (2018) describe the data on American Tree Sparrows (<em>Spizella arborea</em>) that were collected in May and June 2016 at Noatak National Preserve, Alaska. The study area was a 10.8 x 9.6 km rectangle divided up into 288 plots of 600 m x 600 m, of which 150 had some coverage by a transect running through them. Routes were usually chosen to intersect the centroid of the cell and deflected by 0 or 90 degrees when required to move into an adjacent cell. In some cases, a transect was shifted to avoid terrain features. Distance measurements were truncated at 250m from the observer. Each visited plot was surveyed an average of three times (max = 5). Each plot was gridded to a 30-m resolution and spatial attributes were associated with each of these pixels. This resulted in an average of 328 pixels per plot within the buffered transect. Bird locations were assigned to the nearest pixel centroid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("treeSparrow")</code></pre>


<h3>Format</h3>

<p><code>treeSparrow</code> is a list with 3 elements:
</p>

<dl>
<dt><b>surveyData </b></dt><dd><p>a data frame with rows for 466 surveys and the following columns:
</p>

<ul>
<li><p> Site : a numeric site identifier, 1 to 150
</p>
</li>
<li><p> Visit : a numeric visit identifier, 1 to 5
</p>
</li>
<li><p> Survey : a numeric survey identifier, 1 to 466
</p>
</li>
<li><p> count : the number of tree sparrows detected.
</p>
</li>
<li><p> juldate : the Julian date of the survey, day 1 = 1 Jan.
</p>
</li>
<li><p> effort : time spent in each plot during each visit (in hours)
</p>
</li>
<li><p> reltime : number of hours since 0200 (there is no sunrise during the survey period in the Arctic)
</p>
</li>
<li><p> Noise : background noise (combination of wind, creek, and mosquito-associated noise): 0 = no noise, 1 = slight, 2 = noticeable reduction in hearing, 3 = prohibitive noise
</p>
</li>
<li><p> Observer2 : Observed ID
</p>
</li></ul>
</dd>
<dt><b>obs </b></dt><dd><p>a data frame with rows for 325 birds observed and the following columns:
</p>

<ul>
<li><p> Pixel : a numeric pixel identifier, 1 to 49250
</p>
</li>
<li><p> Site : a numeric site identifier, 1 to 150
</p>
</li>
<li><p> Visit : a numeric visit identifier, 1 to 5
</p>
</li>
<li><p> NEAR_DIST :  distance between the bird and the transect line
</p>
</li>
<li><p> SurveyID : a numeric survey identifier, 1 to 466
</p>
</li>
<li><p> ind : an index identifying the individual within the survey.
</p>
</li></ul>
</dd>
<dt><b>pixels </b></dt><dd><p>a data frame with rows for 49250 pixels and the following columns:
</p>

<ul>
<li><p> pixID : a numeric pixel identifier, 1 to 49250
</p>
</li>
<li><p> Site : a numeric site identifier, 1 to 150
</p>
</li>
<li><p> X : x-coordinate of the pixel
</p>
</li>
<li><p> Y : y-coordinate of the pixel
</p>
</li>
<li><p> NEAR_DIST : distance between the center of the pixel and the transect line
</p>
</li>
<li><p> NDVI : Normalized Difference Vegetation Index
</p>
</li>
<li><p> elev : elevation of the center of the pixel, m.
</p>
</li></ul>
</dd>
</dl>



<h3>Source</h3>

<p>Mizel et al. (2018)
</p>


<h3>References</h3>

<p>Mizel, J.D., Schmidt, J.H. and Lindberg, M.S. (2018) Accommodating temporary emigration in spatial distance sampling models. <em>Journal of Applied Ecology</em>, 55, 1456-1464.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 11.8.4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(treeSparrow)
str(treeSparrow)
</code></pre>

<hr>
<h2 id='ttdPeregrine'>
Time-to-detection data for peregrines from the French Jura mountains
</h2><span id='topic+ttdPeregrine'></span>

<h3>Description</h3>

<p>Between 7 and 9 March 2015, 38 breeding cliffs were visited up to 3 times to survey for Peregrine Falcons (<em>Falco peregrinus</em>). Observation duration varied from 3 to 95 minutes. The time to detection was recorded for each bird seen. If no birds were seen, the time was entered as NA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ttdPeregrine")</code></pre>


<h3>Format</h3>

<p>A data frame with 70 rows and the following columns:
</p>

<dl>
<dt>Date </dt><dd><p>a factor with 3 levels giving the date</p>
</dd>
<dt>DayNumber </dt><dd><p>the number of the day: 1, 2, or 3</p>
</dd>
<dt>SiteNumber </dt><dd><p>identification number of the site</p>
</dd>
<dt>Start.hour, Start.minute </dt><dd><p>the time of starting the search</p>
</dd>
<dt>End.hour, End.minute </dt><dd><p>the time of ending the search</p>
</dd>
<dt>MinOfDay </dt><dd><p>the time of the start of the search, minutes after 06:00</p>
</dd>
<dt>Tmax </dt><dd><p>the duration of the search, in minutes</p>
</dd>
<dt>ttd </dt><dd><p>the time to detection, minutes; NA if no birds were seen during the search</p>
</dd>
<dt>sex </dt><dd><p>the sex of the birds seen; NA if no birds were seen</p>
</dd>
</dl>



<h3>Source</h3>

<p>Based on the field work of one of the authors.
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 10.12.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using the built-in data set instead of the TXT file for the example in Section
#  10.12 of the book is easy, as the format is the same as the file.

?ttdPeregrine  # check the description of the data
data(ttdPeregrine)
# Instead of data &lt;- read.table("ttdPeregrine.txt", header = TRUE, sep = "\t") do:
data &lt;- ttdPeregrine

# Then continue with the rest of the analysis on p.618
</code></pre>

<hr>
<h2 id='UKmarbledWhite'>
Data for UK Marbled White butterflies
</h2><span id='topic+UKmarbledWhite'></span>

<h3>Description</h3>

<p>Data from the UK Butterfly Monitoring Scheme (UKBMS) for the Marbled White butterfly (<em>Melanargia galathea</em>), a fairly widespread species that flies in a single generation per year in the UK.
</p>
<p>Most survey sites are chosen opportunistically and represent fixed transects of variable and often unknown length, which are walked between two and 26 times per year starting in early April. Butterflies are counted within an imaginary 5m x 5m 'moving box' along the transects (i.e., according to a Pollard walk protocol).
</p>
<p>We restrict the data to sites where the marbled white was ever recorded, the years 1991–2015 and those 80 sites where counts took place in at least 20 of these 25 years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("UKmarbledWhite")</code></pre>


<h3>Format</h3>

<p>A data frame with 9651 rows and the following columns:
</p>

<dl>
<dt>C </dt><dd><p>count, the number of butterflies recorded</p>
</dd>
<dt>site </dt><dd><p>identification number for site</p>
</dd>
<dt>year </dt><dd><p>the year of the record</p>
</dd>
<dt>north </dt><dd><p>approximate northing of the site in the British National Grid, in meters</p>
</dd>
<dt>date </dt><dd><p>Julian date of the survey, 1 = 1st January</p>
</dd>
</dl>



<h3>Source</h3>

<p>UK Butterfly Monitoring Scheme (UKBMS) data © copyright and database right Butterfly Conservation, the Centre for Ecology and Hydrology, British Trust for Ornithology, and the Joint Nature Conservation Committee, 2018. The UKBMS is indebted to all volunteers who contribute data to the scheme. 
</p>
<p><a href="https://www.ceh.ac.uk/our-science/projects/uk-butterfly-monitoring-scheme">https://www.ceh.ac.uk/our-science/projects/uk-butterfly-monitoring-scheme</a>
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 1.8.2.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SwissMarbledWhite">SwissMarbledWhite</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(UKmarbledWhite)
str(UKmarbledWhite)
</code></pre>

<hr>
<h2 id='valid_data'>
Validates simulated observational data against data-generating values.</h2><span id='topic+valid_data'></span>

<h3>Description</h3>

<p>Where species identifications (from photos, recorded calls, etc) is doubtful, it is sometimes feasible for a subset of the data to be validated by experts. Chambert et al (2017) used simulations to investigate the effectiveness of such partial validation. Where a data set with false positives has been simulated and the true status is known, <code>valid_data</code> compares a subset with truth and returns the number of detections checked per site and the number checked and found to be valid. The function attempts to validate equal numbers of detections at each site (not equal proportions) subject to the actual number of detections and the total number to be validated; if the number of detections is small, all will be validated, otherwise a random sample is used; see Examples.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>valid_data(N, tp, n.valid, prop.valid=FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="valid_data_+3A_n">N</code></td>
<td>

<p>a vector with the number of detections for each site, including true positives and false positives.
</p>
</td></tr>
<tr><td><code id="valid_data_+3A_tp">tp</code></td>
<td>

<p>a vector with the number of true positive detections for each site.
</p>
</td></tr>
<tr><td><code id="valid_data_+3A_n.valid">n.valid</code></td>
<td>

<p>the number of detections to be validated (if <code>prop.valid=FALSE)</code> or the proportion of detections to be validated (if <code>prop.valid=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="valid_data_+3A_prop.valid">prop.valid</code></td>
<td>

<p>logical; determines how <code>n.valid</code> is interpreted.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>n</code></td>
<td>
<p>a vector with the number of detections checked for each site.</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>a vector with the number of detections checked and found to be valid (true positives) for each site.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mike Meredith.
</p>


<h3>References</h3>

<p>Chambert, T., Waddle, J.H., Miller, D.A.W., Walls, S.C., &amp; Nichols, J.D. (2017) A new framework for analysing automated acoustic species-detection data: occupancy estimation and optimization of recordings post-processing. <em>Methods in Ecology and Evolution</em>, 9, 560-570.

</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 7.6.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate some data for 100 sites
set.seed(42, kind="Mersenne-Twister")
z &lt;- rbinom(100, 1, 0.7)  # z[i] == 1 if species present at site 1, 0 otherwise
tp &lt;- rpois(100, 3*z)     # Number of true detections, 0 if species not present
N &lt;- tp + rpois(100, 0.5) # Add false positives

# Validate a subset of 150 detections
out &lt;- valid_data(N, tp, 150)
head(tmp &lt;- cbind(z=z, tp=tp, N=N, n=out$n, k=out$k), 10)
colSums(tmp)

# Plot the number validated vs all detections:
graphics::sunflowerplot(N, out$n, xlab="Number of detections at each site",
  ylab="Number validated")
# For sites with &lt;= 2 detections, all are validated; otherwise at least 2 are validated,
#   with a 3rd draw from randomly selected sites to bring the total to 150.
</code></pre>

<hr>
<h2 id='wagtail'>
Data for Dutch wagtails
</h2><span id='topic+wagtail'></span>

<h3>Description</h3>

<p>The Dutch Centre for Field Ornithology (Sovon) 
monitored grassland birds in Flevoland between April and mid-July 2011. 235 points were surveyed on up to 4 occasions; observations were divided into distance classes 50m wide, and the number of observations in each class recorded. These data are for the Yellow Wagtail (<em>Motacilla flava</em>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("wagtail")</code></pre>


<h3>Format</h3>

<p><code>wagtail</code> is a list with 8 elements:
</p>

<dl>
<dt>potato </dt><dd><p>for each point, the percentage of the area which are potato fields.</p>
</dd>
<dt>grass </dt><dd><p>for each point, the percentage of the area under permanent grassland.</p>
</dd>
<dt>lscale </dt><dd><p>for each point, an index of whether the landscape is open (0) or closed (100).</p>
</dd>
<dt>date </dt><dd><p>a points x occasions matrix, the Julian date of the survey.</p>
</dd>
<dt>hour </dt><dd><p>a points x occasions matrix, the hour of the survey.</p>
</dd>
<dt>breaks </dt><dd><p>the boundaries between the distance classes; birds more than 300m from the point were not included.</p>
</dd>
<dt>Y </dt><dd><p>a matrix of counts, with a row for each site; columns 1 to 6 give the counts in the distance classes for the 1st survey occasion, columns 7 to 12 for the 2nd occasion, and so on (this is the format required for <code>unmarkedFrameGDS</code>).</p>
</dd>
<dt>rep </dt><dd><p>a points x occasions character matrix with the occasion number (this is used as a categorical variable in the analysis).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Dutch Centre for Field Ornithology (SOVON) 
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 9.5.3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wagtail)
str(wagtail)
</code></pre>

<hr>
<h2 id='waterVoles'>
Data for the Mighty Water Voles of Scotland, UK.
</h2><span id='topic+waterVoles'></span>

<h3>Description</h3>

<p>Habitat patches suitable for Water Voles (<em>Arvicola amphibius</em>) were surveyed for vole latrines (fecal deposits used for territory marking), used to indicate presence. It is suspected that some of the detections recorded may be false positives. The data set covers 114 patches surveyed up to 3 times per year from 2009 to 2011.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("waterVoles")</code></pre>


<h3>Format</h3>

<p><code>waterVoles</code> is a data frame with 332 rows corresponding to surveys, and 5 columns:
</p>

<dl>
<dt>Patch </dt><dd><p>an alphanumeric site identifier.</p>
</dd>
<dt>y1, y2, y3 </dt><dd><p>detection (1)/non-detection (0).</p>
</dd>
<dt>Year </dt><dd><p>the year of the survey.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Chris Sutherland, Xavier Lambin and colleagues.
</p>


<h3>References</h3>

<p>Sutherland, C., Elston, D.A., &amp; Lambin, X. (2012) Multi-scale processes in metapopulations: effects of stage structure, rescue effect and correlated extinctions. <em>Ecology</em>, 93, 2465-2473.
</p>
<p>Sutherland, C.S., Elston, D.A., &amp; Lambin, X. (2014) A demographic, spatially explicit patch occupancy model of metapopulation dynamics and persistence. <em>Ecology</em>, 95, 3149-3160.
</p>
<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 7.2.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(waterVoles)
str(waterVoles)
</code></pre>

<hr>
<h2 id='wigglyLine'>
Coordinates for a wiggly line transect
</h2><span id='topic+wigglyLine'></span>

<h3>Description</h3>

<p>Coordinates for a wiggly line transect used as an example in Kéry &amp; Royle (2021) chapter 11.9.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("wigglyLine")</code></pre>


<h3>Format</h3>

<p><code>wigglyLine</code> is a 2-column matrix of x and y coordinates.
</p>


<h3>Source</h3>

<p>Made-up data.
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 11.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wigglyLine)
str(wigglyLine)
plot(wigglyLine, type='l')
</code></pre>

<hr>
<h2 id='wigglyOcc'>
Simulate static occupancy data
</h2><span id='topic+wigglyOcc'></span>

<h3>Description</h3>

<p>Function to generate a static occupancy data set with really wiggly covariate relationships
in occupancy and detection probability.
</p>
<p>To recreate the data sets used in the book with R 3.6.0 or later, include <code>sample.kind="Rounding"</code> in the call to <code>set.seed</code>. This should only be used for reproduction of old results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wigglyOcc(seed = 1, show.plot = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wigglyOcc_+3A_seed">seed</code></td>
<td>

<p>Seed for random number generator
</p>
</td></tr>
<tr><td><code id="wigglyOcc_+3A_show.plot">show.plot</code></td>
<td>

<p>choose whether to show plots or not. Set to FALSE when using function in simulations.
</p>
</td></tr>
<tr><td><code id="wigglyOcc_+3A_verbose">verbose</code></td>
<td>

<p>if TRUE, output will be written to the console.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>M</code></td>
<td>
<p>Number of sites</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>Number of replicate surveys</p>
</td></tr>
<tr><td><code>Xsite</code></td>
<td>
<p>Simulated site covariate, a vector of length M</p>
</td></tr>
<tr><td><code>Xsurvey</code></td>
<td>
<p>Simulated survey covariate, a M x J matrix</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>Occupancy probability, a vector of length M</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p>Realized occupancy, a 0/1 vector of length M</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Detection probability, a M x J matrix</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>detection history, a M x J matrix of 0/1</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> AHM1 - 10.14.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate data with the default arguments and look at the structure:
tmp &lt;- wigglyOcc()
str(tmp)
</code></pre>

<hr>
<h2 id='willowWarbler'>
Constant effort site (CES) data for British Willow Warblers
</h2><span id='topic+willowWarbler'></span>

<h3>Description</h3>

<p>British Willow Warblers (<em>Phylloscopus trochilus</em>) caught at a total of 193 ringing (or banding) stations in England, Wales and Scotland. The willow warbler is a small (8–10 g) migratory species that used to be extremely widespread and common throughout Britain, but whose populations have suffered severe declines since the mid-90s. We analyze data from 11 years (1986–1996) before the major population decline.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("willowWarbler")</code></pre>


<h3>Format</h3>

<p><code>willowWarbler</code> is a list with 4 elements:
</p>

<dl>
<dt><b>birds </b></dt><dd><p>a data frame with rows for 10551 birds and the following columns:
</p>

<ul>
<li><p> 1986-1996 : capture history, 1 if the bird was captured that year, 0 otherwise.
</p>
</li>
<li><p> cesID : numerical code for the Constant Effort Site where the bird was caught.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>cells </b></dt><dd><p>a data frame with rows for 9667 5x5 km cells covering the whole of Britain, and the following columns:
</p>

<ul>
<li><p> lon, lat : easting and northing of the center of the cell.
</p>
</li>
<li><p> gdd : mean growing degree days (GDD: the sum of daily mean temperatures above 5.5C).
</p>
</li>
<li><p> blockID : the ID of the 25x25 km block into which the cell falls.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>CES </b></dt><dd><p>a data frame with rows for each of the Constant Effort Sites, and the following columns:
</p>

<ul>
<li><p> cesx, cesy : approximate easting and northing of the site.
</p>
</li>
<li><p> blockID : the ID of the 25x25 km block into which the site falls.
</p>
</li>
<li><p> cellID : the ID of the 5x5 km cell into which the site falls.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>blocks </b></dt><dd><p>a data frame with rows for 495 25x25 km blocks covering the whole of Britain, and the following columns:
</p>

<ul>
<li><p> blockX, blockY : easting and northing of the center of the block.
</p>
</li></ul>
</dd></dl>



<h3>Source</h3>

<p>British Ornithological Trust (BTO)
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 3.4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(willowWarbler)
str(willowWarbler)
attach(willowWarbler)
ch &lt;- as.matrix(birds[ , 1:11]) # extract capture histories.

</code></pre>

<hr>
<h2 id='zinit'>
Starting values for survival analysis in JAGS/BUGS
</h2><span id='topic+zinit'></span>

<h3>Description</h3>

<p>Generates a matrix for use as starting values for the survival indicator in a JAGS or BUGS model for survival analysis, traditionally designated <code>z</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zinit(CH)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zinit_+3A_ch">CH</code></td>
<td>

<p>An individuals x time matrix of capture records, 1 if captured, 0 otherwise, no missing values.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An individuals x time matrix with 1 in each row after the first capture; all other elements NA, including the first capture occasion.
</p>


<h3>Author(s)</h3>

<p>Marc Kéry &amp; Andy Royle
</p>


<h3>References</h3>

<p>Kéry, M. &amp; Royle, J.A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> AHM2 - 3.2.3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a fake capture history
( ch &lt;- matrix(rbinom(30, 1, 0.5), 6, 5) )
zinit(ch)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
