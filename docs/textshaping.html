<!DOCTYPE html><html><head><title>Help for package textshaping</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {textshaping}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#textshaping-package'><p>textshaping: Bindings to the 'HarfBuzz' and 'Fribidi' Libraries for Text Shaping</p></a></li>
<li><a href='#get_font_features'><p>Get available OpenType features in a font</p></a></li>
<li><a href='#shape_text'><p>Calculate glyph positions for strings</p></a></li>
<li><a href='#text_width'><p>Calculate the width of a string, ignoring new-lines</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bindings to the 'HarfBuzz' and 'Fribidi' Libraries for Text
Shaping</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.7</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides access to the text shaping functionality in the
    'HarfBuzz' library and the bidirectional algorithm in the 'Fribidi'
    library.  'textshaping' is a low-level utility package mainly for
    graphic devices that expands upon the font tool-set provided by the
    'systemfonts' package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/r-lib/textshaping">https://github.com/r-lib/textshaping</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/r-lib/textshaping/issues">https://github.com/r-lib/textshaping/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>systemfonts (&ge; 1.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, knitr, rmarkdown</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>cpp11 (&ge; 0.2.1), systemfonts (&ge; 1.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>freetype2, harfbuzz, fribidi</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-09 09:06:16 UTC; thomas</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Lin Pedersen
    <a href="https://orcid.org/0000-0002-5147-4711"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre, aut],
  Posit, PBC [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Lin Pedersen &lt;thomas.pedersen@posit.co&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-09 14:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='textshaping-package'>textshaping: Bindings to the 'HarfBuzz' and 'Fribidi' Libraries for Text Shaping</h2><span id='topic+textshaping'></span><span id='topic+textshaping-package'></span>

<h3>Description</h3>

<p>Provides access to the text shaping functionality in the 'HarfBuzz' library and the bidirectional algorithm in the 'Fribidi' library. 'textshaping' is a low-level utility package mainly for graphic devices that expands upon the font tool-set provided by the 'systemfonts' package.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Thomas Lin Pedersen <a href="mailto:thomas.pedersen@posit.co">thomas.pedersen@posit.co</a> (<a href="https://orcid.org/0000-0002-5147-4711">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Posit, PBC [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/r-lib/textshaping">https://github.com/r-lib/textshaping</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/r-lib/textshaping/issues">https://github.com/r-lib/textshaping/issues</a>
</p>
</li></ul>


<hr>
<h2 id='get_font_features'>Get available OpenType features in a font</h2><span id='topic+get_font_features'></span>

<h3>Description</h3>

<p>This is a simply functions that returns the available OpenType feature tags
for one or more fonts. See <code><a href="systemfonts.html#topic+font_feature">font_feature()</a></code> for
more information on how to use the different feature with a font.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_font_features(
  family = "",
  italic = FALSE,
  bold = FALSE,
  path = NULL,
  index = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_font_features_+3A_family">family</code></td>
<td>
<p>The name of the font family</p>
</td></tr>
<tr><td><code id="get_font_features_+3A_italic">italic</code></td>
<td>
<p>logicals indicating the font style</p>
</td></tr>
<tr><td><code id="get_font_features_+3A_bold">bold</code></td>
<td>
<p>logicals indicating the font style</p>
</td></tr>
<tr><td><code id="get_font_features_+3A_path">path</code>, <code id="get_font_features_+3A_index">index</code></td>
<td>
<p>path an index of a font file to circumvent lookup based on
family and style</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with an element for each of the input fonts containing the
supported feature tags for that font.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Select a random font on the system
sys_fonts &lt;- systemfonts::system_fonts()
random_font &lt;- sys_fonts$family[sample(nrow(sys_fonts), 1)]

# Get the features
get_font_features(random_font)

</code></pre>

<hr>
<h2 id='shape_text'>Calculate glyph positions for strings</h2><span id='topic+shape_text'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>Do basic text shaping of strings. This function will use freetype to
calculate advances, doing kerning if possible. It will not perform any font
substitution or ligature resolving and will thus be much in line with how
the standard graphic devices does text shaping. Inputs are recycled to the
length of <code>strings</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shape_text(
  strings,
  id = NULL,
  family = "",
  italic = FALSE,
  bold = FALSE,
  size = 12,
  res = 72,
  lineheight = 1,
  align = "left",
  hjust = 0,
  vjust = 0,
  width = NA,
  tracking = 0,
  indent = 0,
  hanging = 0,
  space_before = 0,
  space_after = 0,
  path = NULL,
  index = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shape_text_+3A_strings">strings</code></td>
<td>
<p>A character vector of strings to shape</p>
</td></tr>
<tr><td><code id="shape_text_+3A_id">id</code></td>
<td>
<p>A vector grouping the strings together. If strings share an id the
shaping will continue between strings</p>
</td></tr>
<tr><td><code id="shape_text_+3A_family">family</code></td>
<td>
<p>The name of the font family</p>
</td></tr>
<tr><td><code id="shape_text_+3A_italic">italic</code></td>
<td>
<p>logicals indicating the font style</p>
</td></tr>
<tr><td><code id="shape_text_+3A_bold">bold</code></td>
<td>
<p>logicals indicating the font style</p>
</td></tr>
<tr><td><code id="shape_text_+3A_size">size</code></td>
<td>
<p>The pointsize of the font to use for size related measures</p>
</td></tr>
<tr><td><code id="shape_text_+3A_res">res</code></td>
<td>
<p>The ppi of the size related mesures</p>
</td></tr>
<tr><td><code id="shape_text_+3A_lineheight">lineheight</code></td>
<td>
<p>A multiplier for the lineheight</p>
</td></tr>
<tr><td><code id="shape_text_+3A_align">align</code></td>
<td>
<p>Within text box alignment, either <code>'left'</code>, <code>'center'</code>, or
<code>'right'</code></p>
</td></tr>
<tr><td><code id="shape_text_+3A_hjust">hjust</code>, <code id="shape_text_+3A_vjust">vjust</code></td>
<td>
<p>The justification of the textbox surrounding the text</p>
</td></tr>
<tr><td><code id="shape_text_+3A_width">width</code></td>
<td>
<p>The requested with of the string in inches. Setting this to
something other than <code>NA</code> will turn on word wrapping.</p>
</td></tr>
<tr><td><code id="shape_text_+3A_tracking">tracking</code></td>
<td>
<p>Tracking of the glyphs (space adjustment) measured in 1/1000
em.</p>
</td></tr>
<tr><td><code id="shape_text_+3A_indent">indent</code></td>
<td>
<p>The indent of the first line in a paragraph measured in inches.</p>
</td></tr>
<tr><td><code id="shape_text_+3A_hanging">hanging</code></td>
<td>
<p>The indent of the remaining lines in a paragraph measured in
inches.</p>
</td></tr>
<tr><td><code id="shape_text_+3A_space_before">space_before</code>, <code id="shape_text_+3A_space_after">space_after</code></td>
<td>
<p>The spacing above and below a paragraph,
measured in points</p>
</td></tr>
<tr><td><code id="shape_text_+3A_path">path</code>, <code id="shape_text_+3A_index">index</code></td>
<td>
<p>path an index of a font file to circumvent lookup based on
family and style</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two element: <code>shape</code> contains the position of each glyph,
relative to the origin in the enclosing textbox. <code>metrics</code> contain metrics
about the full strings.
</p>
<p><code>shape</code> is a data.frame with the following columns:
</p>

<dl>
<dt>glyph</dt><dd><p>The glyph as a character</p>
</dd>
<dt>index</dt><dd><p>The index of the glyph in the font file</p>
</dd>
<dt>metric_id</dt><dd><p>The index of the string the glyph is part of (referencing a row in the <code>metrics</code> data.frame)</p>
</dd>
<dt>string_id</dt><dd><p>The index of the string the glyph came from (referencing an element in the <code>strings</code> input)</p>
</dd>
<dt>x_offset</dt><dd><p>The x offset in pixels from the origin of the textbox</p>
</dd>
<dt>y_offset</dt><dd><p>The y offset in pixels from the origin of the textbox</p>
</dd>
<dt>x_mid</dt><dd><p>The x offset in pixels to the middle of the glyph, measured from the origin of the glyph</p>
</dd>
</dl>

<p><code>metrics</code> is a data.frame with the following columns:
</p>

<dl>
<dt>string</dt><dd><p>The text the string consist of</p>
</dd>
<dt>width</dt><dd><p>The width of the string</p>
</dd>
<dt>height</dt><dd><p>The height of the string</p>
</dd>
<dt>left_bearing</dt><dd><p>The distance from the left edge of the textbox and the leftmost glyph</p>
</dd>
<dt>right_bearing</dt><dd><p>The distance from the right edge of the textbox and the rightmost glyph</p>
</dd>
<dt>top_bearing</dt><dd><p>The distance from the top edge of the textbox and the topmost glyph</p>
</dd>
<dt>bottom_bearing</dt><dd><p>The distance from the bottom edge of the textbox and the bottommost glyph</p>
</dd>
<dt>left_border</dt><dd><p>The position of the leftmost edge of the textbox related to the origin</p>
</dd>
<dt>top_border</dt><dd><p>The position of the topmost edge of the textbox related to the origin</p>
</dd>
<dt>pen_x</dt><dd><p>The horizontal position of the next glyph after the string</p>
</dd>
<dt>pen_y</dt><dd><p>The vertical position of the next glyph after the string</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>string &lt;- "This is a long string\nLook; It spans multiple lines\nand all"

# Shape with default settings
shape_text(string)

# Mix styles within the same string
string &lt;- c(
  "This string will have\na ",
  "very large",
  " text style\nin the middle"
)

shape_text(string, id = c(1, 1, 1), size = c(12, 24, 12))

</code></pre>

<hr>
<h2 id='text_width'>Calculate the width of a string, ignoring new-lines</h2><span id='topic+text_width'></span>

<h3>Description</h3>

<p>This is a very simple alternative to <code><a href="systemfonts.html#topic+shape_string">shape_string()</a></code> that simply calculates
the width of strings without taking any newline into account. As such it is
suitable to calculate the width of words or lines that has already been
splitted by <code style="white-space: pre;">&#8288;\n&#8288;</code>. Input is recycled to the length of <code>strings</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>text_width(
  strings,
  family = "",
  italic = FALSE,
  bold = FALSE,
  size = 12,
  res = 72,
  include_bearing = TRUE,
  path = NULL,
  index = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="text_width_+3A_strings">strings</code></td>
<td>
<p>A character vector of strings</p>
</td></tr>
<tr><td><code id="text_width_+3A_family">family</code></td>
<td>
<p>The name of the font family</p>
</td></tr>
<tr><td><code id="text_width_+3A_italic">italic</code></td>
<td>
<p>logicals indicating the font style</p>
</td></tr>
<tr><td><code id="text_width_+3A_bold">bold</code></td>
<td>
<p>logicals indicating the font style</p>
</td></tr>
<tr><td><code id="text_width_+3A_size">size</code></td>
<td>
<p>The pointsize of the font to use for size related measures</p>
</td></tr>
<tr><td><code id="text_width_+3A_res">res</code></td>
<td>
<p>The ppi of the size related mesures</p>
</td></tr>
<tr><td><code id="text_width_+3A_include_bearing">include_bearing</code></td>
<td>
<p>Logical, should left and right bearing be included in
the string width?</p>
</td></tr>
<tr><td><code id="text_width_+3A_path">path</code>, <code id="text_width_+3A_index">index</code></td>
<td>
<p>path an index of a font file to circumvent lookup based on
family and style</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector giving the width of the strings in pixels. Use the
provided <code>res</code> value to convert it into absolute values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>strings &lt;- c('A short string', 'A very very looong string')
text_width(strings)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
