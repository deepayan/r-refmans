<!DOCTYPE html><html><head><title>Help for package cocorresp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cocorresp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cocorresp-package'>
<p>Co-correspondence analysis ordination methods for community ecology</p></a></li>
<li><a href='#beetles'><p>Carabid beetles and vascular plants in Dutch roadside verges</p></a></li>
<li><a href='#biplot-methods'><p>Biplots of co-correspondence analysis models</p></a></li>
<li><a href='#bryophyte'><p>Bryophytes and vascular plants in Carpathian spring meadows</p></a></li>
<li><a href='#coca'><p>Fit Co-Correspondence Analysis Ordination Models</p></a></li>
<li><a href='#cocorresp-internal'><p>Internal cocorresp Functions</p></a></li>
<li><a href='#coinertia'><p>Co-inertia analysis</p></a></li>
<li><a href='#coinertiaI'><p>Coinertia analysis with identity matrices</p></a></li>
<li><a href='#corAxis'><p>Correlation between ordination axes</p></a></li>
<li><a href='#crossval'><p>Cross-validation for predictive Co-Correspondence</p>
Analysis models</a></li>
<li><a href='#envfit.coca'>
<p>Fit an environmental vector or factor to a Co-CA ordination</p></a></li>
<li><a href='#fitCoinertia'><p>Co-inertia analysis</p></a></li>
<li><a href='#fitted.symcoca'><p>Fitted values of a Symmetric Co-Correpsondence analysis model.</p></a></li>
<li><a href='#loadings'><p>CoCA species loadings</p></a></li>
<li><a href='#mcChi'><p> Standardised chi-square residuals</p></a></li>
<li><a href='#permutest.coca'><p>Permutation test for predictive co-correspondence analysis</p>
models</a></li>
<li><a href='#plot.predcoca'><p>Biplots for predictive co-correspondence analysis</p></a></li>
<li><a href='#plot.symcoca'><p>Plots for symmetric co-correspondence analysis</p></a></li>
<li><a href='#points.coca'><p>Add points to a Co-CA plot</p></a></li>
<li><a href='#rescale'><p>Rescales CoCA species scores</p></a></li>
<li><a href='#resid.symcoca'><p>Extract Model Residuals</p></a></li>
<li><a href='#scaleChi'><p>Standardised chi-square residuals</p></a></li>
<li><a href='#scores-methods'><p>Get Species or Site Scores from an Ordination</p></a></li>
<li><a href='#screeplot.symcoca'><p>Screeplot for symmetric co-correspondence analysis</p></a></li>
<li><a href='#simpls'><p>Modified version of Sijmen de Jong's SIMPLS</p></a></li>
<li><a href='#summary-methods'><p>Summarizing Co-CA Model Fits</p></a></li>
<li><a href='#weights.symcoca'><p>Exctract CoCA model weights</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Co-Correspondence Analysis Methods</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-20</td>
</tr>
<tr>
<td>Depends:</td>
<td>vegan (&ge; 2.5-0), R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, utils, grDevices</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, pls</td>
</tr>
<tr>
<td>Author:</td>
<td>Original Matlab routines by C.J.F. ter Braak and A.P. Schaffers. R port by Gavin L. Simpson.
  Function simpls based on simpls.fit (package pls) by Ron Wehrens and Bjorn-Helge Mevik.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gavin L. Simpson &lt;ucfagls@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits predictive and symmetric co-correspondence analysis (CoCA) models to relate one data matrix to another data matrix. More specifically, CoCA maximises the weighted covariance between the weighted averaged species scores of one community and the weighted averaged species scores of another community. CoCA attempts to find patterns that are common to both communities.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gavinsimpson.github.io/cocorresp/">https://gavinsimpson.github.io/cocorresp/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gavinsimpson/cocorresp/issues">https://github.com/gavinsimpson/cocorresp/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-20 18:57:08 UTC; au690221</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-26 15:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='cocorresp-package'>
Co-correspondence analysis ordination methods for community ecology
</h2><span id='topic+cocorresp-package'></span><span id='topic+cocorresp'></span>

<h3>Description</h3>

<p>Fits predictive and symmetric co-correspondence analysis (CoCA) models
to relate one data matrix to another data matrix. More specifically,
CoCA maximises the weighted covariance between the weighted averaged
species scores of one community and the weighted averaged species
scores of another community. CoCA attempts to find patterns that are
common to both communitities.
</p>


<h3>Details</h3>

<p>The main interface function is <code><a href="#topic+coca">coca</a></code> which accepts a
formula or two community data matrices. An appropriate formula is
<code>Y ~ ., data = X</code> and the associated <code>data</code> object from
which <code>.</code> will be looked up. The <code>method</code> argument is used
to select from the two forms of CoCA: <code>method = "predictive"</code> for
predictive CoCA (the default), and <code>method = "symmetric"</code> for
symmetric CoCA.
</p>


<h3>Author(s)</h3>

<p>Original Matlab routines by C.J.F. ter Braak and A.P. Schaffers. R port
by Gavin L. Simpson. Function simpls based on <code>simpls.fit</code> (package
pls) by Ron Wehrens and Bjorn-Helge Mevik.
</p>
<p>Maintainer: Gavin L. Simpson &lt;ucfagls@gmail.com&gt;
</p>

<hr>
<h2 id='beetles'>Carabid beetles and vascular plants in Dutch roadside verges</h2><span id='topic+beetles'></span><span id='topic+plants'></span><span id='topic+verges'></span>

<h3>Description</h3>

<p>Counts of 126 beetle taxa and abundances of 173 vascular plant taxa
(expressed on the 1-9 van der Maarel scale) in 30 road-side verges in
the Netherlands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(beetles)

data(plants)

data(verges)
</code></pre>


<h3>Details</h3>

<p>This is the complete dataset of Raemakers et al (2001). ter Braak and
Schaffers (2004) only analyse a subset of 91 beetle taxa.
</p>


<h3>Source</h3>

<p>Raemakers, I.P., Schaffers, A.P., Sykora, V. and Heijerman, T. (2001)
The importance of plant communities in road verges as habitat for
insects. <em>Proceedings of the Section Experimental and Applied
Entomology if the Netherlands Entomological Society</em> <b>12</b>, 101&ndash;106.
</p>
<p>ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(beetles)
data(plants)
</code></pre>

<hr>
<h2 id='biplot-methods'>Biplots of co-correspondence analysis models</h2><span id='topic+biplot.symcoca'></span><span id='topic+biplot.predcoca'></span>

<h3>Description</h3>

<p>Produces biplots of the response and predictor from the results of a
co-correspondence analysis models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'symcoca'
biplot(x,
    which = "y1",
    choices = 1:2,
    benzecri = TRUE,
    type = NULL,
    xlim = NULL,
    ylim = NULL,
    col.species = "red",
    col.sites = "black",
    pch.species = 3,
    pch.sites = 1,
    cex = 0.7,
    main = "",
    sub = "",
    ylab, xlab,
    ann = par("ann"),
    axes = TRUE,
    ...)

## S3 method for class 'predcoca'
biplot(x,
    which = "response",
    choices = 1:2,
    type = NULL,
    xlim = NULL,
    ylim = NULL,
    col.species = "red",
    col.sites = "black",
    pch.species = 3,
    pch.sites = 1,
    cex = 0.7,
    main = "",
    sub = "",
    ylab, xlab,
    ann = par("ann"),
    axes = TRUE,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="biplot-methods_+3A_x">x</code></td>
<td>
<p> an object of class <code>"symcoca"</code>, the result of
a call to <code><a href="#topic+symcoca">symcoca</a></code>.</p>
</td></tr>
<tr><td><code id="biplot-methods_+3A_which">which</code></td>
<td>
<p>character; should the response or predictor scores be
plotted. Can be specified in several ways: <em>response</em> choices
are one from <code>c("y", "Y", "y1", "response")</code>; <em>predictor</em>
choices are one from <code>c("x", "X", "y2", "predictor")</code>.</p>
</td></tr>
<tr><td><code id="biplot-methods_+3A_choices">choices</code></td>
<td>
<p> a vector of length 2 indicating which predictive CoCA
axes to plot.</p>
</td></tr>
<tr><td><code id="biplot-methods_+3A_benzecri">benzecri</code></td>
<td>
<p> logical, should a Benzecri plot be drawn? Such plots
draw species scores, scaled by the quarter root of the respective
eigenvalues, with unscaled site scores. A Benzecri plot is the
recommended biplot for symmetric CoCA. See
<code><a href="#topic+scores.symcoca">scores.symcoca</a></code>.</p>
</td></tr> 
<tr><td><code id="biplot-methods_+3A_type">type</code></td>
<td>
<p> one of <code>"points"</code>, or <code>"text"</code>. Determines how
the site and species scores are displayed. If <code>type = "points"</code>,
scores are plotted as points. If <code>type = "text"</code>, then the row
names of the scores matrices are plotted.</p>
</td></tr>
<tr><td><code id="biplot-methods_+3A_xlim">xlim</code>, <code id="biplot-methods_+3A_ylim">ylim</code></td>
<td>
<p>limits for the x and y axes. If non supplied,
suitable limits will be determined from the data.</p>
</td></tr>
<tr><td><code id="biplot-methods_+3A_col.species">col.species</code>, <code id="biplot-methods_+3A_col.sites">col.sites</code>, <code id="biplot-methods_+3A_pch.species">pch.species</code>, <code id="biplot-methods_+3A_pch.sites">pch.sites</code></td>
<td>
<p>colours and
plotting characters used when plotting the species and sites
scores.</p>
</td></tr>
<tr><td><code id="biplot-methods_+3A_cex">cex</code></td>
<td>
<p>numeric; scaling factor when drawing points or text
labels.</p>
</td></tr>
<tr><td><code id="biplot-methods_+3A_xlab">xlab</code>, <code id="biplot-methods_+3A_ylab">ylab</code></td>
<td>
<p> labels for the x and y axes. If non supplied
suitable labels are formed from the result object.</p>
</td></tr>
<tr><td><code id="biplot-methods_+3A_main">main</code>, <code id="biplot-methods_+3A_sub">sub</code></td>
<td>
<p> the main and sub titles for the plot.</p>
</td></tr>
<tr><td><code id="biplot-methods_+3A_ann">ann</code></td>
<td>
<p> logical, if TRUE plots are annotated and not if FALSE,
currently ignored.</p>
</td></tr>
<tr><td><code id="biplot-methods_+3A_axes">axes</code></td>
<td>
<p> a logical value indicating whether axes and plot border
should be drawn on the plot.</p>
</td></tr>
<tr><td><code id="biplot-methods_+3A_...">...</code></td>
<td>
<p> other graphical parameters as in 'par' may also be passed as
arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gavin L. Simpson.</p>


<h3>References</h3>

<p>Ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coca">coca</a></code>, <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## symmetric CoCA
data(beetles)
data(plants)

## log transform the beetle data
beetles &lt;- log(beetles + 1)

## fit the model
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")

## draw a biplot of the beetle results
biplot(bp.sym)

## biplot of both - Fig 1 in ter Braak &amp; Schaffers (2004)
layout(matrix(1:2, ncol = 2))
biplot(bp.sym, which = "y1", main = "Beetles")
biplot(bp.sym, which = "y2", main = "Plants")
layout(1)

## predictive CoCA
bp.pred &lt;- coca(beetles ~ ., data = plants)

## draw a biplot of the response
biplot(bp.pred)

## recreate Fig 3 in ter Braak &amp; Schaffers (2004)
layout(matrix(1:2, ncol = 2))
biplot(bp.pred, which = "response", main = "Beetles")
biplot(bp.pred, which = "predictor", main = "Plants")
layout(1)
</code></pre>

<hr>
<h2 id='bryophyte'>Bryophytes and vascular plants in Carpathian spring meadows</h2><span id='topic+bryophyte'></span><span id='topic+vascular'></span>

<h3>Description</h3>

<p>The data consist of observations on 30 bryophyte and 123 vascular
plant species in 70 spring meadows (sites, samples). The species data
are a subset of only those species occuring in five or more meadows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bryophyte)
data(vascular)</code></pre>


<h3>Source</h3>

<p>Hajek, M., Hekera, P. and Hajkova, P. (2002) Spring fen vegetations
and water chemistry in the Western Carpathian flysch zone. <em>Folia
geobotanica</em> <b>37</b>, 205&ndash;224
</p>
<p>ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bryophyte)
data(vascular)
</code></pre>

<hr>
<h2 id='coca'>Fit Co-Correspondence Analysis Ordination Models</h2><span id='topic+coca'></span><span id='topic+coca.formula'></span><span id='topic+coca.default'></span><span id='topic+print.predcoca'></span><span id='topic+print.symcoca'></span>

<h3>Description</h3>

<p><code>coca</code> is used to fit Co-Correspondence Analysis (CoCA)
models. It can fit predictive or symmetric models to two community
data matrices containing species abundance data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coca(y, ...)

## Default S3 method:
coca(y, x, method = c("predictive", "symmetric"),
     reg.method = c("simpls", "eigen"), weights = NULL,
     n.axes = NULL, symmetric = FALSE, quiet = FALSE, ...)

## S3 method for class 'formula'
coca(formula, data, method = c("predictive", "symmetric"),
     reg.method = c("simpls", "eigen"), weights = NULL,
     n.axes = NULL, symmetric = FALSE, quiet = FALSE, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coca_+3A_y">y</code></td>
<td>
<p>a data frame containing the response community data matrix.</p>
</td></tr>
<tr><td><code id="coca_+3A_x">x</code></td>
<td>
<p>a data frame containing the predictor community data matrix.</p>
</td></tr>
<tr><td><code id="coca_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be fit. The
details of model specification are given below.</p>
</td></tr>
<tr><td><code id="coca_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
If not found in <code>data</code>, the variables are taken from
<code>environment(formula)</code>, typically the environment from which
<code>coca</code> is called.</p>
</td></tr>
<tr><td><code id="coca_+3A_method">method</code></td>
<td>
<p>a character string indicating which co-correspondence
analysis method to use. One of <code>"predictive"</code>(default), or
<code>"symmetric"</code>, can be abbreviated.</p>
</td></tr>
<tr><td><code id="coca_+3A_reg.method">reg.method</code></td>
<td>
<p>One of <code>"simpls"</code> (default) or
<code>"eigen"</code>. If <code>method</code> is <code>"predictive"</code> then
<code>reg.method</code> controls whether the co-correspondence analysis
should be fitted using the SIMPLS algorithm or via an eigen
analysis.</p>
</td></tr>
<tr><td><code id="coca_+3A_weights">weights</code></td>
<td>
<p>a vector of length <code>nrow(y)</code> of user supplied
weights for <code class="reqn">R_0</code>. If <code>weights = NULL</code> (default) then the
weights are determined from <code>y</code> (default) or <code>x</code> and <code>y</code>
(<code>symmetric = TRUE</code> only).</p>
</td></tr>
<tr><td><code id="coca_+3A_n.axes">n.axes</code></td>
<td>
<p>the number of CoCA axes to extract. If missing (default)
the <code>n.axes</code> is </p>
<p style="text-align: center;"><code class="reqn">min(ncol(y), ncol(x), nrow(y), nrow(x)) -
      1</code>
</p>
<p>.</p>
</td></tr>
<tr><td><code id="coca_+3A_symmetric">symmetric</code></td>
<td>
<p>if <code>method</code> is <code>"symmetric"</code> then
<code>symmetric</code> determines whether weights for <code class="reqn">R_0</code> are
symmetric and taken as the average of the row sums of <code>x</code> and
<code>y</code> (<code>symmetric = TRUE</code>). If <code>symmetric = FALSE</code>
(default) then the weights <code class="reqn">R_0</code> are taken as the row sums of <code>y</code>
unless user defined weights are provided via argument
<code>weights</code>. Ignored if <code>method</code> is <code>"predictive"</code>.</p>
</td></tr>
<tr><td><code id="coca_+3A_quiet">quiet</code></td>
<td>
<p>logical; suppress messages due to removal of species with
no data.</p>
</td></tr>
<tr><td><code id="coca_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to lower level methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>coca</code> is the main user-callable function.
</p>
<p>A typical model has the form <code>response ~ terms</code> where
<code>response</code> is the (numeric) response data frame and <code>terms</code>
is a series of terms which specifies a linear predictor for
<code>response</code>. A typical form for <code>terms</code> is <code>.</code>,
which is shorthand for &quot;all variables&quot; in <code>data</code>. If <code>.</code> is
used, <code>data</code> must also be provided. If specific species
(variables) are required then <code>terms</code> should take the form
<code>spp1 + spp2 + spp3</code>.
</p>
<p>The default is to fit a predictive CoCA model using SIMPLS via a
modified version of <code><a href="pls.html#topic+simpls.fit">simpls.fit</a></code> from package
<code>pls</code>. Alternatively, <code>reg.method = "eigen"</code> fits the model
using an older, slower eigen analysis version of the SIMPLS
algorithm. <code>reg.method = "eigen"</code> is about 100% slower than
<code>reg.method = "simpls"</code>.
</p>


<h3>Value</h3>

<p><code>coca</code> returns a list with <code>method</code> and <code>reg.method</code>
determining the actual components returned.
</p>
<table>
<tr><td><code>nam.dat</code></td>
<td>
<p>list with components <code>namY</code> and
<code>namX</code> containing the names of the response and the
predictor(s) respectively.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the CoCA method used, one of <code>"predictive"</code>
or <code>"symmetric"</code>.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>the species and site scores of the fitted
model.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>the site loadings of the fitted model for the response
and the predictor. (Predictive CoCA via SIMPLS only.)</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>the fitted values for the response. A list with 2
components <code>Yhat</code> (the fitted values on the original scale) and
<code>Yhat1</code> (the fitted values on the chi-square transformed
scale). (Predictive CoCA via SIMPLS only.)</p>
</td></tr>
<tr><td><code>varianceExp</code></td>
<td>
<p>list with components <code>Yblock</code> and
<code>Xblock</code> containing the variances in the response and
the predictor respectively, explained by each fitted PLS
axis. (Predictive CoCA via SIMPLS only.)</p>
</td></tr>
<tr><td><code>totalVar</code></td>
<td>
<p>list with components <code>Yblock</code> and
<code>Xblock</code> containing the total variance in the response
and the predictor respectively. (Predictive CoCA via SIMPLS only.)</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>the Eigenvalues of the analysis.</p>
</td></tr>
<tr><td><code>n.axes</code></td>
<td>
<p>the number of fitted axes</p>
</td></tr>
<tr><td><code>Ychi</code></td>
<td>
<p>a list containing the mean-centered chi-square matrices
for the response (<code>Ychi1</code>) and the predictor
(<code>Ychi2</code>). (Predictive CoCA only.)</p>
</td></tr>
<tr><td><code>R0</code></td>
<td>
<p>the (possibly user-supplied) row weights used in the analysis.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>X-Matrix (symmetric CoCA only).</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>Residuals of a symmetric model (symmetric CoCA
only).</p>
</td></tr>
<tr><td><code>inertia</code></td>
<td>
<p>list with components <code>total</code> and
<code>residual</code> containing the total and residual inertia
for the response and the predictor (symmetric CoCA only).</p>
</td></tr>
<tr><td><code>rowsum</code></td>
<td>
<p>a list with the row sums for the response
(<code>rsum1</code>) and the preditor (<code>rsum2</code>)
(symmetric CoCA only).</p>
</td></tr>
<tr><td><code>colsum</code></td>
<td>
<p>a list with the column sums for the response
(<code>csum1</code>)and the preditor (<code>csum2</code>)
(symmetric CoCA only).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Original Matlab code by C.J.F. ter Braak and A.P. Schaffers. R
port by Gavin L. Simpson. Formula method for <code>coca</code> uses a
modified version of <code><a href="vegan.html#topic+ordiParseFormula">ordiParseFormula</a></code> by Jari
Oksanen to handle formulea.
</p>


<h3>References</h3>

<p>ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crossval">crossval</a></code> for cross-validation and
<code><a href="#topic+permutest.coca">permutest.coca</a></code> for permutation test to determine the
number of PLS axes to retain in for predictive CoCA.
</p>
<p><code><a href="#topic+summary.predcoca">summary.predcoca</a></code> and <code><a href="#topic+summary.symcoca">summary.symcoca</a></code> for
summary methods.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## symmetric CoCA
data(beetles)
## log transform the bettle data
beetles &lt;- log(beetles + 1)
data(plants)
## fit the model
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")
bp.sym
summary(bp.sym)
biplot(bp.sym)                          # produces a Benzecri biplot

## extract eigenvalues of the analysis
eigenvals(bp.sym)

## correlations between beetle and plant score scores on Co-CA axes
corAxis(bp.sym)

## predictive CoCA using SIMPLS and formula interface
bp.pred &lt;- coca(beetles ~ ., data = plants)
## should retain only the useful PLS components for a parsimonious model


## Leave-one-out crossvalidation - this takes a while
crossval(beetles, plants)
## so 2 axes are sufficient
## permutation test to assess significant PLS components - takes a while
bp.perm &lt;- permutest(bp.pred, permutations = 99)
bp.perm


## agrees with the Leave-one-out cross-validation
## refit the model with only 2 PLS components
bp.pred &lt;- coca(beetles ~ ., data = plants, n.axes = 2)
bp.pred
summary(bp.pred)
biplot(bp.pred)                     # plots correct scores or loadings

## predictive CoCA using Eigen-analysis
data(bryophyte)
data(vascular)
carp.pred &lt;- coca(y = bryophyte, x = vascular, reg.method = "eigen")
carp.pred


## determine important PLS components - takes a while
crossval(bryophyte, vascular)
(carp.perm &lt;- permutest(carp.pred, permutations = 99))


## 2 components again, refit
carp.pred &lt;- coca(y = bryophyte, x = vascular,
                  reg.method = "eigen", n.axes = 2)
carp.pred
## drawn biplot
biplot(carp.pred)

</code></pre>

<hr>
<h2 id='cocorresp-internal'>Internal cocorresp Functions</h2><span id='topic+predcoca.simpls'></span><span id='topic+predcoca.eigen'></span><span id='topic+symcoca'></span>

<h3>Description</h3>

<p>Internal cocorresp functions.
</p>
<p><code>predcoca.simpls</code>, <code>predcoca.eigen</code> and <code>symcoca</code>
perform the actual fitting of Co-CA models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predcoca.eigen(y, x, R0 = NULL, n.axes = NULL, nam.dat = NULL)

predcoca.simpls(y, x, R0 = NULL, n.axes = NULL, nam.dat = NULL)

symcoca(y, x, n.axes = NULL, R0 = NULL,
        symmetric = FALSE, nam.dat = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cocorresp-internal_+3A_y">y</code></td>
<td>
<p>a data frame containing the response community data matrix.</p>
</td></tr>
<tr><td><code id="cocorresp-internal_+3A_x">x</code></td>
<td>
<p>a data frame containing the predictor community data matrix.</p>
</td></tr>
<tr><td><code id="cocorresp-internal_+3A_r0">R0</code></td>
<td>
<p>a vector of length <code>nrow(y)</code> of user supplied
weights for <code class="reqn">R_0</code>. If <code>weights = NULL</code> (default) then the
weights are determined from <code>y</code> (default) or <code>x</code> and <code>y</code>
(<code>symmetric = TRUE</code> only).</p>
</td></tr>
<tr><td><code id="cocorresp-internal_+3A_n.axes">n.axes</code></td>
<td>
<p>the number of CoCA axes to extract. If missing (default)
the <code>n.axes</code> is <code class="reqn">min(ncol(y), ncol(x), nrow(y), nrow(x)) -
      1</code>.</p>
</td></tr>
<tr><td><code id="cocorresp-internal_+3A_symmetric">symmetric</code></td>
<td>
<p>if <code>method</code> is <code>"symmetric"</code> then
<code>symmetric</code> determines whether weights for <code class="reqn">R_0</code> are
symmetric and taken as the average of the row sums of <code>x</code> and
<code>y</code> (<code>symmetric = TRUE</code>). If <code>symmetric = FALSE</code>
(default) then the weights <code class="reqn">R_0</code> are taken as the row sums of <code>y</code>
unless user defined weights are provided via argument
<code>weights</code>. Ignored if <code>method</code> is <code>"predictive"</code>.</p>
</td></tr>
<tr><td><code id="cocorresp-internal_+3A_nam.dat">nam.dat</code></td>
<td>
<p>an optional list with elements <code>namY</code> and <code>namX</code>
containing the names of <code>y</code> and <code>x</code> respectively. Used to
label printed output. If missing the names of are deduced from
<code>y</code> and <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These are not to be called by the user.
</p>
<p><code>predcoca.simpls</code>, <code>predcoca.eigen</code> and <code>symcoca</code>
perform the actual model fitting but are not meant to be called by the
user as <code>coca</code> pre-processes the input data before calling these
functions.
</p>

<hr>
<h2 id='coinertia'>Co-inertia analysis</h2><span id='topic+coinertia'></span><span id='topic+coinertia.default'></span>

<h3>Description</h3>

<p>Performs a co-inertia of the triplets <code class="reqn">(Q_1,K_1,R_0)</code> and
<code class="reqn">(Q_2,K_2,R_0)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coinertia(y, ...)

## Default S3 method:
coinertia(y, x, n.axes = NULL, weights = NULL,
          symmetric = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coinertia_+3A_y">y</code>, <code id="coinertia_+3A_x">x</code></td>
<td>
<p>matrices or data frames of the two data sets for which
axes of covariance are sought.</p>
</td></tr>
<tr><td><code id="coinertia_+3A_n.axes">n.axes</code></td>
<td>
<p>numeric; the number of coinertia axes to retain.</p>
</td></tr>
<tr><td><code id="coinertia_+3A_weights">weights</code></td>
<td>
<p>a vector of weights for the samples. If <code>NULL</code>,
weights are chosen from the row sums of <code>y</code> (<code>symmetric =
      FALSE</code>) or the average of the row sums of <code>y</code> and <code>x</code>
(<code>symmetric = TRUE</code>).</p>
</td></tr>
<tr><td><code id="coinertia_+3A_symmetric">symmetric</code></td>
<td>
<p>logical; should a symmetric set of weights be
used. See Details.</p>
</td></tr>
<tr><td><code id="coinertia_+3A_...">...</code></td>
<td>
<p> arguments passed to other functions. Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"coinertia"</code>, which is a list with the
following components:
</p>
<table>
<tr><td><code>scores</code></td>
<td>
<p>a list of ordination scores, with components
<code>species</code> and <code>sites</code>, each of which is a list with
components <code>Y</code> and <code>X</code> that refer to the scores for the
input matrices <code>y</code> and <code>x</code> respectively.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>numeric vector of row weights used in the analysis.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>numeric vector of Eigenvalues.</p>
</td></tr>
<tr><td><code>n.axes</code></td>
<td>
<p>numeric; the number of coinertia axes extracted</p>
</td></tr>
<tr><td><code>symmetric</code></td>
<td>
<p>logical; was a symmetric analysis performed?</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Gavin L. Simpson, based on original Matlab code by C.J.F. ter
Braak and A.P. Schaffers.</p>


<h3>References</h3>

<p>Ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>
<p>Doledec, S and Chessel, D. (1994) Co-inertia analysis: a method for
studying species-environment relationships. <em>Freshwater Biology</em>
<b>31</b>, 277&ndash;294
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+symcoca">symcoca</a></code> for the function that calls
<code>fitCoinertia</code> and <code><a href="#topic+coinertiaI">coinertiaI</a></code> for co-inertia analysis
using identity matrices for <code class="reqn">K_1</code>, <code class="reqn">K_2</code>, and <code class="reqn">R_0</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(beetles, plants)
coin &lt;- coinertia(beetles, plants)
coin

</code></pre>

<hr>
<h2 id='coinertiaI'>Coinertia analysis with identity matrices</h2><span id='topic+coinertiaI'></span>

<h3>Description</h3>

<p>Performs a co-inertia of the triplets <code class="reqn">(Q_1,K_1,R_0)</code> and
<code class="reqn">(Q_2,K_2,R_0)</code> with identity matrices <code class="reqn">K_1, K_2, R_0</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coinertiaI(X, Y, fast = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coinertiaI_+3A_x">X</code></td>
<td>
<p>Species matrix X.</p>
</td></tr>
<tr><td><code id="coinertiaI_+3A_y">Y</code></td>
<td>
<p>Species Matrix Y.</p>
</td></tr>
<tr><td><code id="coinertiaI_+3A_fast">fast</code></td>
<td>
<p>If <code>"TRUE"</code> only return the row scores of
<code>Y</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Argument <code>fast</code> is used to return only the row scores of
<code>Y</code> in function <code><a href="#topic+permutest.coca">permutest.coca</a></code>, which speeds the
permutation test considerably.
</p>


<h3>Value</h3>

<p>If <code>fast = TRUE</code>, a matrix of row scores for matrix
<code>Y</code> (see <code>scores</code> below). If
<code>fast = FALSE</code> a list with the following components:
</p>
<table>
<tr><td><code>weights</code></td>
<td>
<p>A list with components <code>X</code> and
<code>Y</code> containing the left and right singular vectors
respectivley of the SVD on the triplets.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>A list with components <code>X</code> and
<code>Y</code>, containing the row scores of the
<code>X</code> and <code>Y</code> species matrices. These are
the result of a matrix multiplication of <code>X</code> by the
left singular vectors and <code>Y</code> by the right singular
vectors.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>the Eigenvalues of the analysis (the square of the
singular values from the SVD.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched function call.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is not meant to be called directly by the user. If
you wish to use it study the code in
<code><a href="#topic+permutest.coca">permutest.coca</a></code> to see how it should be called.</p>


<h3>Author(s)</h3>

<p>Original Matlab code by C.J.F. ter Braak and A.P. Schaffers. R
port by Gavin L. Simpson.</p>


<h3>References</h3>

<p>Doledec, S and Chessel, D. (1994) Co-inertia analysis: a method for
studying species-environment relationships. <em>Freshwater Biology</em>
<b>31</b>, 277&ndash;294.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coinertia">coinertia</a></code></p>

<hr>
<h2 id='corAxis'>Correlation between ordination axes</h2><span id='topic+corAxis.symcoca'></span><span id='topic+corAxis'></span><span id='topic+corAxis.default'></span>

<h3>Description</h3>

<p>Calculates the Pearson product-moment correlation coefficient for the
site scores of ordination axes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
corAxis(x, ...)

## Default S3 method:
corAxis(x, ...)

## S3 method for class 'symcoca'
corAxis(x, axes = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corAxis_+3A_x">x</code></td>
<td>
<p>an ordination object. Only methods for objects of class
<code><a href="#topic+symcoca">symcoca</a></code> are currently available.</p>
</td></tr>
<tr><td><code id="corAxis_+3A_axes">axes</code></td>
<td>
<p>numeric; the number of axes to calculate the correlation
coefficients for. If <code>NULL</code>, coefficients for all axes are
returned.</p>
</td></tr>
<tr><td><code id="corAxis_+3A_...">...</code></td>
<td>
<p>arguments to be passed on to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector containing the correlation coefficients for the
requested axes.
</p>


<h3>Note</h3>

<p>The arguments for <code>cor</code> are hard coded at their
defaults, see <code><a href="stats.html#topic+cor">cor</a></code> for details. A more flexible version
is planned that will allow arguments to be passed to <code>cor</code>.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor">cor</a></code>, for the main analysis function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load some data
data(beetles)
data(plants)

## log transform the beetle data
beetles &lt;- log(beetles + 1)

## symmetric Co-CA model
beetles.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")

## correlations between axes
corAxis(beetles.sym)

</code></pre>

<hr>
<h2 id='crossval'>Cross-validation for predictive Co-Correspondence
Analysis models</h2><span id='topic+crossval'></span><span id='topic+print.crossval'></span><span id='topic+summary.crossval'></span><span id='topic+print.summary.crossval'></span>

<h3>Description</h3>

<p>Performs a leave-one-out cross-validation of a predictive
Co-Correspondence Analysis model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossval(y, x, n.axes = min(dim(x), dim(y)) - 1,
         centre = TRUE, verbose = TRUE)


## S3 method for class 'crossval'
summary(object, axes = c(1:min(6, object$n.axes)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossval_+3A_y">y</code></td>
<td>
<p>the response species matrix.</p>
</td></tr>
<tr><td><code id="crossval_+3A_x">x</code></td>
<td>
<p>the predictor species matrix.</p>
</td></tr>
<tr><td><code id="crossval_+3A_n.axes">n.axes</code></td>
<td>
<p>the number of axes to calculate the leave-one-out
cross-validation for. Default is to perform the CV for all
extractable axes.</p>
</td></tr>
<tr><td><code id="crossval_+3A_centre">centre</code></td>
<td>
<p>centre <code>y</code> and <code>x</code> during analysis? Currently
ignored as it may not be neccessary.</p>
</td></tr>
<tr><td><code id="crossval_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>, the default, print information on the
progress of the cross-validation procedure.</p>
</td></tr>
<tr><td><code id="crossval_+3A_object">object</code></td>
<td>
<p>an object of class <code>crossval</code> as returned by
<code>crossval</code>.</p>
</td></tr>
<tr><td><code id="crossval_+3A_axes">axes</code></td>
<td>
<p> the number of axes to summarise results for.</p>
</td></tr>

<tr><td><code id="crossval_+3A_...">...</code></td>
<td>
<p> further arguments to <code>print</code> - currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Performs a leave-one-out cross-validation of a predictive
Co-Correspondence Analysis model. It can be slow depending on the
number of columns in the matrices, and of course the number of sites.
</p>


<h3>Value</h3>

<p>Returns a large list with the following components:
</p>
<table>
<tr><td><code>dimx</code>, <code>dimy</code></td>
<td>
<p>the dimensions of the input matrices <code>x</code> and
<code>y</code> respectively.</p>
</td></tr>
<tr><td><code>press0</code></td>
<td>
<p>the <code class="reqn">press_0</code> statistic.</p>
</td></tr>
<tr><td><code>n.axes</code></td>
<td>
<p>the number of axes tested.</p>
</td></tr>
<tr><td><code>CVfit</code></td>
<td>
<p>the cross-validatory fit.</p>
</td></tr>
<tr><td><code>varianceExp</code></td>
<td>
<p>list with components <code>Yblock</code> and
<code>Xblock</code> containing the variances in the response and the
predictor respectively, explained by each fitted PLS
axis.</p>
</td></tr>
<tr><td><code>totalVar</code></td>
<td>
<p>list with components <code>Yblock</code> and <code>Xblock</code>
containing the total variance in the response and the predictor
respectively.</p>
</td></tr>
<tr><td><code>nam.dat</code></td>
<td>
<p>list with components <code>namY</code> and <code>namX</code>
containing the names of the response and the predictor(s)
respectively.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the R call used.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is not a bit out-of-date compared to some of the
other functions. It should have a formular interface like
<code><a href="#topic+coca">coca</a></code> or work on the results from <code><a href="#topic+coca">coca</a></code>,
although that will have to be altered to store a copy of the data? </p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson, based on Matlab code by C.J.F. ter Braak and
A.P. Schaffers.</p>


<h3>See Also</h3>

<p>The model fitting function <code><a href="#topic+coca">coca</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load the data sets
data(beetles)
data(plants)

## log transform the bettle data
beetles &lt;- log(beetles + 1)

## predictive CoCA using SIMPLS and formula interface
bp.pred &lt;- coca(beetles ~ ., data = plants)
## should retain only the useful PLS components for a
## parsimonious model

## Leave-one-out crossvalidation - this takes a while
## Not run: 
crossval(beetles, plants)

## End(Not run)
## so 2 axes are sufficient

</code></pre>

<hr>
<h2 id='envfit.coca'>
Fit an environmental vector or factor to a Co-CA ordination
</h2><span id='topic+envfit.coca'></span>

<h3>Description</h3>

<p>The function fits environmental vectors or factors to a Co-CA
ordination. The projections of points onto vectors have maximum
correlation with corresponding environmental variables, and the
factors show the averages of factor levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coca'
envfit(ord, env, which = c("response", "predictor"),
       choices = c(1, 2), scaling = FALSE, w, na.rm = FALSE,
       strata = NULL, permutations = 999, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envfit.coca_+3A_ord">ord</code></td>
<td>
<p>a Co-CA ordination object, the result of a call to
<code><a href="#topic+coca">coca</a></code>.</p>
</td></tr>
<tr><td><code id="envfit.coca_+3A_env">env</code></td>
<td>
<p>a data frame, matrix or vector of environmental/external
variable(s) to be fitted to the ordination. The variables may be
of a mixed type (factors and continuous variables) in a data frame.</p>
</td></tr>
<tr><td><code id="envfit.coca_+3A_which">which</code></td>
<td>
<p>character; which of the response or predictor ordinations
should be used during fitting of vectors and factors.</p>
</td></tr>
<tr><td><code id="envfit.coca_+3A_choices">choices</code></td>
<td>
<p>numeric; the axes to which vectors and factors are
fitted.</p>
</td></tr>
<tr><td><code id="envfit.coca_+3A_scaling">scaling</code></td>
<td>
<p>logical; should sacling be applied. See
<code><a href="#topic+scores.symcoca">scores.symcoca</a></code>.</p>
</td></tr>
<tr><td><code id="envfit.coca_+3A_w">w</code></td>
<td>
<p>weights used in fitting vectors and factors.</p>
</td></tr>
<tr><td><code id="envfit.coca_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove points with missing values in ordination scores or
environmental variables. The operation is casewise; the whole row of
data is removed if there is a missing value and <code>na.rm =
      TRUE</code>.</p>
</td></tr>
<tr><td><code id="envfit.coca_+3A_strata">strata</code></td>
<td>
<p>An integer vector or factor specifying the strata for
permutation. If supplied, observations are permuted only within the
specified strata.</p>
</td></tr>
<tr><td><code id="envfit.coca_+3A_permutations">permutations</code></td>
<td>
<p>Number of permutations for assessing significance
of vectors or factors. Set to <code>0</code> to skip permutations.</p>
</td></tr>
<tr><td><code id="envfit.coca_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="vegan.html#topic+vectorfit">vectorfit</a></code> and
<code><a href="vegan.html#topic+factorfit">factorfit</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="vegan.html#topic+envfit">envfit</a></code> for details of the method.
</p>


<h3>Value</h3>

<p>Returns an object of class <code><a href="vegan.html#topic+envfit">envfit</a></code>. 
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson. The code interfaces with and uses code from
<code><a href="vegan.html#topic+envfit">envfit</a></code> for the main computations, which was written by
Jari Oksanen.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coca">coca</a></code> for fitting models. <code><a href="vegan.html#topic+envfit">envfit</a></code> for
details of the generic function and the computations performed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## symmetric CoCA
data(beetles)
data(plants)

## log transform the bettle data
beetles &lt;- log(beetles + 1)

## fit the model
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")

## load the environmental data
data(verges)

## fit vectors for the environmental data
sol &lt;- envfit(bp.sym, verges, which = "response")
sol

## plot the response matrix and the fitted vectors
biplot(bp.sym, which = "y1")
plot(sol)
</code></pre>

<hr>
<h2 id='fitCoinertia'>Co-inertia analysis</h2><span id='topic+fitCoinertia'></span><span id='topic+print.fitCoinertia'></span><span id='topic+summary.fitCoinertia'></span><span id='topic+print.summary.fitCoinertia'></span>

<h3>Description</h3>

<p>Performs a co-inertia of the triplets <code class="reqn">(Q_1,K_1,R_0)</code> and
<code class="reqn">(Q_2,K_2,R_0)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitCoinertia(X, Dp, Y, Dq, Dn, n.axes)


## S3 method for class 'fitCoinertia'
summary(object, ...)


</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitCoinertia_+3A_x">X</code></td>
<td>
 <p><code class="reqn">Q_1</code>, matrix of expected abundances under row-column
independence in the original <code>Y</code> species matrix when
treated as a contingency table.</p>
</td></tr>
<tr><td><code id="fitCoinertia_+3A_dp">Dp</code></td>
<td>
 <p><code class="reqn">K_1</code>, species (column) weights for <code>X</code>.</p>
</td></tr>
<tr><td><code id="fitCoinertia_+3A_y">Y</code></td>
<td>
 <p><code class="reqn">Q_2</code>, matrix of expected abundances under row-column
independence in the original <code>X</code> species matrix when
treated as a contingency table.</p>
</td></tr>
<tr><td><code id="fitCoinertia_+3A_dq">Dq</code></td>
<td>
 <p><code class="reqn">K_2</code>, species (column) weights for <code>Y</code>.</p>
</td></tr>
<tr><td><code id="fitCoinertia_+3A_dn">Dn</code></td>
<td>
<p> site weights <code class="reqn">R_0</code>.</p>
</td></tr>
<tr><td><code id="fitCoinertia_+3A_n.axes">n.axes</code></td>
<td>
<p> number of axes to calculate the co-inertia analysis
for.</p>
</td></tr>
<tr><td><code id="fitCoinertia_+3A_object">object</code></td>
<td>
<p>an object of class <code>coinertia</code>.</p>
</td></tr>
<tr><td><code id="fitCoinertia_+3A_axes">axes</code></td>
<td>
<p> the number of axes to display when printing.</p>
</td></tr>

<tr><td><code id="fitCoinertia_+3A_...">...</code></td>
<td>
<p> arguments passed to other functions. Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>U1</code></td>
<td>
<p>column weights of <code>X</code>.</p>
</td></tr>
<tr><td><code>U2</code></td>
<td>
<p>column weights of <code>Y</code>.</p>
</td></tr>
<tr><td><code>X1</code></td>
<td>
<p>rowscores of <code>X</code>.</p>
</td></tr>
<tr><td><code>X2</code></td>
<td>
<p>rowscores of <code>Y</code>.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>the Eigenvalues (squares of the singular values).</p>
</td></tr>
<tr><td><code>n.axes</code></td>
<td>
<p>number of axes requested.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched function call.</p>
</td></tr>
</table>


<h3>Note</h3>

<p> This function is not yet meant to be called directly by the
user. If you wish to use it directly, see the function definition for
<code><a href="#topic+symcoca">symcoca</a></code> which demonstrates how to prepare the
relevant input matrices.
</p>
<p>Note that in this function, <code>X</code> corresponds to the input
matrix <code>y</code> and <code>Y</code> corresponds to the
input matrix <code>x</code> in <code><a href="#topic+symcoca">symcoca</a></code>.
Confusing! This will be changed in a future release but for now the
arguments follow those of the original Matlab code - perhaps a little
too closely!
</p>


<h3>Author(s)</h3>

<p> Original Matlab code by C.J.F. ter Braak and A.P. Schaffers. R
port by Gavin L. Simpson.</p>


<h3>References</h3>

<p>Ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>
<p>Doledec, S and Chessel, D. (1994) Co-inertia analysis: a method for
studying species-environment relationships. <em>Freshwater Biology</em>
<b>31</b>, 277&ndash;294
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+symcoca">symcoca</a></code> for the function that calls
<code>fitCoinertia</code> and <code><a href="#topic+coinertiaI">coinertiaI</a></code> for co-inertia analysis
using identity matrices for <code class="reqn">K_1</code>, <code class="reqn">K_2</code>, and <code class="reqn">R_0</code>
</p>

<hr>
<h2 id='fitted.symcoca'>Fitted values of a Symmetric Co-Correpsondence analysis model.</h2><span id='topic+fitted.symcoca'></span><span id='topic+print.fitted.symcoca'></span>

<h3>Description</h3>

<p>Calculates and extracts the fitted values of a Symmetric
Co-Correpsondence analysis model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'symcoca'
fitted(object, which = c("y1","y2"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.symcoca_+3A_object">object</code></td>
<td>
<p>an object of class <code>"symcoca"</code></p>
</td></tr>
<tr><td><code id="fitted.symcoca_+3A_which">which</code></td>
<td>
<p>character; should the response or predictor scores be
plotted. Can be specified in several ways: <em>response</em> choices
are one from <code>c("y", "Y", "y1", "response")</code>; <em>predictor</em>
choices are one from <code>c("x", "X", "y2", "predictor")</code>.</p>
</td></tr>
<tr><td><code id="fitted.symcoca_+3A_...">...</code></td>
<td>
<p>arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>Y</code></td>
<td>
<p>the fitted values for the &ldquo;response&rdquo; matrix.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>the fitted values for the &ldquo;predictor&rdquo; matrix.</p>
</td></tr>
<tr><td><code>nam.dat</code></td>
<td>
<p>a vector containing the names of the &ldquo;response&rdquo;
and &ldquo;predictor&rdquo; matrices respectively. Used for printing the
results.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function needs an update and to allow option to restrict
fitted values to specified axes, and the names of the returned objects
need making more obvious!
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson, based on Matlab code by C.J.F. ter Braak and
A.P. Schaffers.</p>


<h3>References</h3>

<p>Ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>


<h3>See Also</h3>

<p>The model fitting function <code><a href="#topic+coca">coca</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## symmetric CoCA
data(beetles)
data(plants)

## log transform the bettle data
beetles &lt;- log(beetles + 1)

## fit the model
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")

## fitted values
bp.fit &lt;- fitted(bp.sym)
bp.fit

## fitted values for beetles only
beetle.fit &lt;- fitted(bp.sym, which = "y1")
</code></pre>

<hr>
<h2 id='loadings'>CoCA species loadings</h2><span id='topic+loadings'></span><span id='topic+lodaings.default'></span><span id='topic+loadings.predcoca'></span><span id='topic+loadings.symcoca'></span>

<h3>Description</h3>

<p>Extract CoCA species loadings from fitted objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadings(x, ...)

## S3 method for class 'predcoca'
loadings(x, choices = c(1, 2),
         which = c("response", "predictor"), ...)

## S3 method for class 'symcoca'
loadings(x, choices = c(1, 2),
         which = c("y1", "y2"), ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadings_+3A_x">x</code></td>
<td>
<p>an object resulting from a call to <code><a href="#topic+coca">coca</a></code>.</p>
</td></tr>
<tr><td><code id="loadings_+3A_choices">choices</code></td>
<td>
<p>numeric; vector of Co-CA axes to extract loadings for.</p>
</td></tr>
<tr><td><code id="loadings_+3A_which">which</code></td>
<td>
<p>character; should the response or predictor scores be
plotted. Can be specified in several ways: <em>response</em> choices
are one from <code>c("y", "Y", "y1", "response")</code>; <em>predictor</em>
choices are one from <code>c("x", "X", "y2", "predictor")</code>.</p>
</td></tr>
<tr><td><code id="loadings_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to lower level
methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>loadings()</code> is an extractor function to access the loadings of a
fitted CoCA model.
</p>
<p>This is a generic function, replacing the
<code><a href="stats.html#topic+loadings">loadings</a></code> function, which is preserved as the
exported default S3 method. Methods are provided for both predictive
and symmetric CoCA.
</p>


<h3>Value</h3>

<p>A list of data frames or a single data frame depending on other arguments.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coca">coca</a></code> for how to fit CoCA models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## symmetric CoCA
data(beetles)
## log transform the bettle data
beetles &lt;- log(beetles + 1)
data(plants)
## fit the model
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")

## extract the loadings
lds &lt;- loadings(bp.sym)
</code></pre>

<hr>
<h2 id='mcChi'> Standardised chi-square residuals </h2><span id='topic+mcChi'></span>

<h3>Description</h3>

<p>Scales a matrix, Y, to its standardised chi-square residuals <code class="reqn">(o -
    e) / \sqrt{e}</code> (if <code class="reqn">R_0 = R</code>, where R contains the row
sums of matrix Y) so that further analysis can be unweighted
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcChi(Y, R0, eps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcChi_+3A_y">Y</code></td>
<td>
<p> a matrix for which standardised chi-square residuals are to
be calculated.</p>
</td></tr>
<tr><td><code id="mcChi_+3A_r0">R0</code></td>
<td>
<p> row weights.</p>
</td></tr>
<tr><td><code id="mcChi_+3A_eps">eps</code></td>
<td>
<p> tolerance - leave as default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements equation 8 of ter Braak and Schaffers (2004)
by firstly applying equation 7 to form matrix Q using row and column
sums of Y as weights, and, secondly, by applying equation 8 to form a
matrix of standardised chi-square residuals from Q by
pre-multiplication of Q by <code class="reqn">\sqrt{R_0}</code> and
post-multiplication of Q by <code class="reqn">\sqrt{K}</code>, where K is the
column sums of Y.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>Ychi</code></td>
<td>
<p>the matrix of standardised chi-squared residuals of Y</p>
</td></tr>
<tr><td><code>Kn</code></td>
<td>
<p>the column sums (K) of Y divided by sum(K)</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is not intended for casual use by users.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson, based on Matlab code by C.J.F. ter Braak and
A.P. Schaffers.</p>


<h3>References</h3>

<p>Ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>

<hr>
<h2 id='permutest.coca'>Permutation test for predictive co-correspondence analysis
models</h2><span id='topic+permutest.coca'></span><span id='topic+print.permutest.coca'></span><span id='topic+summary.permutest.coca'></span><span id='topic+print.summary.permutest.coca'></span>

<h3>Description</h3>

<p>A permutation test for predictive co-correspondence analysis models to
assess the significance of each CoCA ordination axes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coca'
permutest(x, R0 = NULL, permutations = 99,
               n.axes = x$n.axes, verbose = TRUE, ...)


## S3 method for class 'permutest.coca'
summary(object, ...)


</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permutest.coca_+3A_x">x</code></td>
<td>
<p> an object of class <code>"predcoca"</code>.</p>
</td></tr>
<tr><td><code id="permutest.coca_+3A_r0">R0</code></td>
<td>
<p> row weights to use in the analysis. If missing, the
default, these are determined from <code>x</code>.</p>
</td></tr>
<tr><td><code id="permutest.coca_+3A_permutations">permutations</code></td>
<td>
<p> the number of permutations to perform.</p>
</td></tr>
<tr><td><code id="permutest.coca_+3A_n.axes">n.axes</code></td>
<td>
<p> The number of axes to test. Defaults to the number of
axes stated in <code>x$n.axes</code>.</p>
</td></tr>
<tr><td><code id="permutest.coca_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>, the default, print information on the
progress of the permutation test procedure.</p>
</td></tr>
<tr><td><code id="permutest.coca_+3A_object">object</code></td>
<td>
<p> an object of class <code>"permutest.coca"</code>.</p>
</td></tr>
<tr><td><code id="permutest.coca_+3A_...">...</code></td>
<td>
<p>arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An alternative approach to cross-validation (see
<code><a href="#topic+crossval">crossval</a></code>) to select the number of axes to retain in a
predictive co-correspondence analysis is to test the statistical
significance of each ordination axis using permutation tests.
</p>
<p>The test statistic used is the <em>F</em>-ratio based on the fit of the
first axis to the response data (ter Braak and Smilauer 2002). The
second and subsequent axes are tested by treating previous axes as
co-variables.
</p>
<p>To be precise, this approach does not test the significance of SIMPLS
axes, but those of NIPALS-PLS axes (ter Braak and de Jong 1998).
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>pval</code></td>
<td>
<p>a vector of <em>P</em>-values for each ordination axis.</p>
</td></tr>
<tr><td><code>permstat</code></td>
<td>
<p>a vector of values for the test statistic for each axis.</p>
</td></tr>
<tr><td><code>total.inertia</code></td>
<td>
<p>the total inertia in the response matrix.</p>
</td></tr>
<tr><td><code>inertia</code></td>
<td>
<p>a vector containing the <em>residualised</em>
inertia. This is the total inertia in the response <em>after</em>
removing the inertia explained by all previous axes. For the first
CoCA axis this is, by definition, the total inertia in the
response.</p>
</td></tr>
<tr><td><code>fitax</code></td>
<td>
<p>a vector containing the amount of inertia in the
response matrix explained by each ordination axis.</p>
</td></tr>
<tr><td><code>pcent.fit</code></td>
<td>
<p>a vector containing the fit of each axis to the
response as a percentage of the total inertia (variance).</p>
</td></tr>
<tr><td><code>n.axes</code></td>
<td>
<p>the number of axes in the ordination.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>This function is <b>slow</b>. Beware setting argument
<code>permutations</code> higher than the default. Determine how long it
takes for the default 99 permutations to complete before going crazy
and asking for thousands of permutations - you've been warned, have a
good book to hand.
</p>


<h3>Note</h3>

<p>Argument <code>R0</code> is provided for compatibility with the original
MATLAB code. The R usage paradigm makes this argument redundant in the
current code and it may be invalid to supply different row weights
(<code class="reqn">R_0</code>) as <code>R0</code>. This argument will likely be removed in future
versions.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson, based on Matlab code by C.J.F. ter Braak and
A.P. Schaffers.</p>


<h3>References</h3>

<p>ter Braak, C.J.F. and de Jong, S. (1998) The objective function of
partial least squares regression. <em>Journal of Chemometrics</em>
<b>12</b>, 41&ndash;54.
</p>
<p>ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846.
</p>
<p>ter Braak, C.J.F. and Smilauer, P. (2002) <em>Canoco reference manual
and CanoDraw for Windows user's guide: software for canonical
community ordination. Version 4.5</em>. New York: Microcomputer Power.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coca">coca</a></code>, for the model fitting function,
<code><a href="#topic+crossval">crossval</a></code>, for a leave-one-out cross-validation
procedure, which is the preferred way to select axes in a predictive
co-correspondence analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load some data
data(beetles)
data(plants)

## log transform the bettle data
beetles &lt;- log(beetles + 1)
## predictive CoCA using SIMPLS and formula interface
bp.pred &lt;- coca(beetles ~ ., data = plants)

## should retain only the useful PLS components for a parsimonious model

## Leave-one-out crossvalidation - this takes a while
crossval(beetles, plants)
## so 2 axes are sufficient


## permutation test
## (Testing the first 2 axes &amp; only 25 perms for speed.)
bp.perm &lt;- permutest(bp.pred, permutations = 25, n.axes = 2)
bp.perm


</code></pre>

<hr>
<h2 id='plot.predcoca'>Biplots for predictive co-correspondence analysis</h2><span id='topic+plot.predcoca'></span>

<h3>Description</h3>

<p>Produces biplots of the response and predictor from the results of a
predictive co-correspondence analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predcoca'
plot(x,
    which = "response",
    choices = 1:2,
    display = c("species", "sites"),
    type,
    xlim = NULL,
    ylim = NULL,
    main = "",
    sub = "",
    ylab, xlab,
    ann = par("ann"),
    axes = TRUE,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.predcoca_+3A_x">x</code></td>
<td>
<p> an object of class <code>"predcoca"</code>, the result of
a call to <code><a href="#topic+coca">coca</a></code>.</p>
</td></tr>
<tr><td><code id="plot.predcoca_+3A_which">which</code></td>
<td>
<p>character; should the response or predictor scores be
plotted. Can be specified in several ways: <em>response</em> choices
are one from <code>c("y", "Y", "y1", "response")</code>; <em>predictor</em>
choices are one from <code>c("x", "X", "y2", "predictor")</code>.</p>
</td></tr>
<tr><td><code id="plot.predcoca_+3A_choices">choices</code></td>
<td>
<p> a vector of length 2 indicating which predictive CoCA
axes to plot.</p>
</td></tr>
<tr><td><code id="plot.predcoca_+3A_display">display</code></td>
<td>
<p> which sets of scores are drawn. See
<code><a href="#topic+scores.predcoca">scores.predcoca</a></code>.</p>
</td></tr>
<tr><td><code id="plot.predcoca_+3A_type">type</code></td>
<td>
<p> one of <code>"points"</code>, <code>"text"</code>, or
<code>"none"</code>. Determines how the site and species scores are
displayed. If <code>type = "points"</code>, scores are plotted as
points. If <code>type = "text"</code>, then the row names of the scores
matrices are plotted. If <code>type = "none"</code>, then the scores are
not plotted.</p>
</td></tr>
<tr><td><code id="plot.predcoca_+3A_xlim">xlim</code>, <code id="plot.predcoca_+3A_ylim">ylim</code></td>
<td>
<p>limits for the x and y axes. If non supplied,
suitable limits will be determined from the data.</p>
</td></tr>
<tr><td><code id="plot.predcoca_+3A_xlab">xlab</code>, <code id="plot.predcoca_+3A_ylab">ylab</code></td>
<td>
<p> labels for the x and y axes. If non supplied
suitable labels are formed from the result object.</p>
</td></tr>
<tr><td><code id="plot.predcoca_+3A_main">main</code>, <code id="plot.predcoca_+3A_sub">sub</code></td>
<td>
<p> the main and sub titles for the plot.</p>
</td></tr>
<tr><td><code id="plot.predcoca_+3A_ann">ann</code></td>
<td>
<p> logical, if TRUE plots are annotated and not if FALSE,
currently ignored.</p>
</td></tr>
<tr><td><code id="plot.predcoca_+3A_axes">axes</code></td>
<td>
<p> a logical value indicating whether both axes should be drawn
on the plot.</p>
</td></tr>
<tr><td><code id="plot.predcoca_+3A_...">...</code></td>
<td>
<p> other graphical parameters as in 'par' may also be passed as
arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gavin L. Simpson.</p>


<h3>References</h3>

<p>Ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coca">coca</a></code>, <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## predictive CoCA
data(beetles)
data(plants)

## log transform the beetle data
beetles &lt;- log(beetles + 1)

## predictive CoCA using SIMPLS and formula interface
bp.pred &lt;- coca(beetles ~ ., data = plants)

## draw the plot for the response scores
plot(bp.pred)

## plot of both
layout(matrix(1:2, ncol = 2))
plot(bp.pred, which = "response", main = "Beetles")
plot(bp.pred, which = "predictor", main = "Plants")
layout(1)
</code></pre>

<hr>
<h2 id='plot.symcoca'>Plots for symmetric co-correspondence analysis</h2><span id='topic+plot.symcoca'></span>

<h3>Description</h3>

<p>Produces plots of the response and predictor from the results of a
symmetric co-correspondence analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'symcoca'
plot(x,
    which = "response",
    choices = 1:2,
    display = c("species", "sites"),
    scaling = FALSE,
    type,
    xlim = NULL,
    ylim = NULL,
    main = "",
    sub = "",
    ylab, xlab,
    ann = par("ann"),
    axes = TRUE,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.symcoca_+3A_x">x</code></td>
<td>
<p> an object of class <code>"symcoca"</code>, the result of
a call to <code><a href="#topic+symcoca">symcoca</a></code>.</p>
</td></tr>
<tr><td><code id="plot.symcoca_+3A_which">which</code></td>
<td>
<p>character; should the response or predictor scores be
plotted.</p>
</td></tr>
<tr><td><code id="plot.symcoca_+3A_choices">choices</code></td>
<td>
<p> a vector of length 2 indicating which predictive CoCA
axes to plot.</p>
</td></tr>
<tr><td><code id="plot.symcoca_+3A_display">display</code></td>
<td>
<p> which sets of scores are drawn. See
<code><a href="#topic+scores.symcoca">scores.symcoca</a></code>.</p>
</td></tr>
<tr><td><code id="plot.symcoca_+3A_scaling">scaling</code></td>
<td>
<p> logical, whether scaling should be applied. See
<code><a href="#topic+scores.symcoca">scores.symcoca</a></code>.</p>
</td></tr>
<tr><td><code id="plot.symcoca_+3A_type">type</code></td>
<td>
<p> one of <code>"points"</code>, <code>"text"</code>, or
<code>"none"</code>. Determines how the site and species scores are
displayed. If <code>type = "points"</code>, scores are plotted as
points. If <code>type = "text"</code>, then the row names of the scores
matrices are plotted. If <code>type = "none"</code>, then the scores are
not plotted.</p>
</td></tr>
<tr><td><code id="plot.symcoca_+3A_xlim">xlim</code>, <code id="plot.symcoca_+3A_ylim">ylim</code></td>
<td>
<p>limits for the x and y axes. If non supplied,
suitable limits will be determined from the data.</p>
</td></tr>
<tr><td><code id="plot.symcoca_+3A_xlab">xlab</code>, <code id="plot.symcoca_+3A_ylab">ylab</code></td>
<td>
<p> labels for the x and y axes. If non supplied
suitable labels are formed from the result object.</p>
</td></tr>
<tr><td><code id="plot.symcoca_+3A_main">main</code>, <code id="plot.symcoca_+3A_sub">sub</code></td>
<td>
<p> the main and sub titles for the plot.</p>
</td></tr>
<tr><td><code id="plot.symcoca_+3A_ann">ann</code></td>
<td>
<p> logical, if TRUE plots are annotated and not if FALSE,
currently ignored.</p>
</td></tr>
<tr><td><code id="plot.symcoca_+3A_axes">axes</code></td>
<td>
<p> a logical value indicating whether both axes should be drawn
on the plot.</p>
</td></tr>
<tr><td><code id="plot.symcoca_+3A_...">...</code></td>
<td>
<p> other graphical parameters as in 'par' may also be passed as
arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gavin L. Simpson.</p>


<h3>References</h3>

<p>Ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coca">coca</a></code>, <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## symmetric CoCA
data(beetles)
data(plants)

## log transform the beetle data
beetles &lt;- log(beetles + 1)

## fit the model
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")

## draw a plot of the response scores
plot(bp.sym)

## plot of both
layout(matrix(1:2, ncol = 2))
plot(bp.sym, which = "response", main = "Beetles")
plot(bp.sym, which = "predictor", main = "Plants")
layout(1)
</code></pre>

<hr>
<h2 id='points.coca'>Add points to a Co-CA plot</h2><span id='topic+points.coca'></span>

<h3>Description</h3>

<p>Draws points on the current graphic device based on in
supplied <code><a href="#topic+coca">coca</a></code> model object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coca'
points(x, display = c("sites", "species"),
       which = c("response", "predictor"), choices = c(1, 2),
       scaling = FALSE, select, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="points.coca_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code><a href="#topic+coca">coca</a></code>.</p>
</td></tr>
<tr><td><code id="points.coca_+3A_display">display</code></td>
<td>
<p>character; one of the stated choices. Indicates which
scores to use to draw points.</p>
</td></tr>
<tr><td><code id="points.coca_+3A_which">which</code></td>
<td>
<p>character; one of the stated choices. Indicates which of
the response or predictor data sets is used to select scores from.</p>
</td></tr>
<tr><td><code id="points.coca_+3A_choices">choices</code></td>
<td>
<p>The Co-CA axes to draw points for.</p>
</td></tr>
<tr><td><code id="points.coca_+3A_scaling">scaling</code></td>
<td>
<p>logical; should species scores in a symmetric Co-CA be
rescaled?</p>
</td></tr>
<tr><td><code id="points.coca_+3A_select">select</code></td>
<td>
<p>Items to be displayed. This can either be a logical
vector which is <code>TRUE</code> for displayed items or a vector of
indices of displayed items.</p>
</td></tr>
<tr><td><code id="points.coca_+3A_...">...</code></td>
<td>
<p>Arguments passed to other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The visual appearance of the plotted points can be controlled by
supplying appropriate graphical parameters via the <code>...</code>
argument. See <code><a href="graphics.html#topic+par">par</a></code> for details.
</p>


<h3>Value</h3>

<p>Returns the plotted x and y coordinates as a matrix.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+plot">plot</a></code> methods; <code><a href="#topic+plot.predcoca">plot.predcoca</a></code> and
<code><a href="#topic+plot.symcoca">plot.symcoca</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## symmetric CoCA
data(beetles)
data(plants)
     
## log transform the bettle data
beetles &lt;- log(beetles + 1)
     
## fit the model
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")

## draw a plot of the response scores
plot(bp.sym, type = "none")
points(bp.sym, display = "sites", col = "blue", pch = 16)
points(bp.sym, display = "species", col = "red", pch = 3, cex = 0.8)
</code></pre>

<hr>
<h2 id='rescale'>Rescales CoCA species scores</h2><span id='topic+rescale'></span><span id='topic+rescale.default'></span><span id='topic+rescale.symcoca'></span>

<h3>Description</h3>

<p>Rescales CoCA species scores to the quarter root of the 
eigenvalues.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rescale(object, ...)

## Default S3 method:
rescale(object, ...)

## S3 method for class 'symcoca'
rescale(object, choices = NULL,
        display = c("species", "sites"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rescale_+3A_object">object</code></td>
<td>
<p>an R object. Currently only objects of class 
<code>"symcoca"</code> are supported.</p>
</td></tr>
<tr><td><code id="rescale_+3A_choices">choices</code></td>
<td>
<p>numeric; which axes to rescale and return.</p>
</td></tr>
<tr><td><code id="rescale_+3A_display">display</code></td>
<td>
<p>character; which type of scores to rescale.</p>
</td></tr>
<tr><td><code id="rescale_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to <code>rescale</code>
methods. Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently only implemented for objects of class <code>"symcoca"</code>.
</p>


<h3>Value</h3>

<p>Returns a list with one or both of the following components:
</p>
<table>
<tr><td><code>species</code></td>
<td>
<p>rescaled species scores for the response</p>
</td></tr>
<tr><td><code>sites</code></td>
<td>
<p>rescaled species scores for the preditor</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matlab original by C.J.F. ter Braak and A.P. Schaffers. 
R port by Gavin L. Simpson.</p>


<h3>See Also</h3>

<p><code><a href="#topic+symcoca">symcoca</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(bryophyte)
data(vascular)

bryo.sym &lt;- coca(bryophyte ~ ., data = vascular, method = "symmetric")

rescale(bryo.sym, axes = 1:2)

</code></pre>

<hr>
<h2 id='resid.symcoca'>Extract Model Residuals</h2><span id='topic+resid.symcoca'></span>

<h3>Description</h3>

<p>Extracts the residuals of the fitted model of a symmetric CoCA
to the response and the predictor. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'symcoca'
resid(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid.symcoca_+3A_object">object</code></td>
<td>
<p>an object of class <code>"symcoca"</code>.</p>
</td></tr>
<tr><td><code id="resid.symcoca_+3A_...">...</code></td>
<td>
<p>arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the residuals for the response and the 
predictor with the following components:
</p>
<table>
<tr><td><code>Y</code></td>
<td>
<p>residuals of the fit to the repsonse.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>residuals of the fit to the predictor.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gavin L. Simpson</p>


<h3>See Also</h3>

<p><code><a href="#topic+symcoca">symcoca</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(bryophyte)
data(vascular)
bryo.sym &lt;- coca(bryophyte ~ ., data = vascular, method = "symmetric")
eps &lt;- resid(bryo.sym)

</code></pre>

<hr>
<h2 id='scaleChi'>Standardised chi-square residuals </h2><span id='topic+scaleChi'></span>

<h3>Description</h3>

<p>Scales a matrix, Y, to is standardised chi-square residuals <code class="reqn">(o -
    e) / \sqrt{e}</code> (given <code class="reqn">K_n</code> and <code class="reqn">R_0</code>
metrics derived from an external matrix <code class="reqn">Y_0</code>) so that further
analysis can be unweighted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaleChi(Y, Kn, R0, eps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scaleChi_+3A_y">Y</code></td>
<td>
<p> a matrix for which standardised chi-square residuals are to
be calculated.</p>
</td></tr>
<tr><td><code id="scaleChi_+3A_kn">Kn</code></td>
<td>
<p> the column sums (K) of Y divided by sum(K).</p>
</td></tr>
<tr><td><code id="scaleChi_+3A_r0">R0</code></td>
<td>
<p> row weights.</p>
</td></tr>
<tr><td><code id="scaleChi_+3A_eps">eps</code></td>
<td>
<p> a tolerance.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Yr</code></td>
<td>
<p>the matrix of standardised chi-squared residuals of Y.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is not intended for casual use by users.
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson, based on Matlab code by C.J.F. ter Braak and
A.P. Schaffers.</p>


<h3>References</h3>

<p>Ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>

<hr>
<h2 id='scores-methods'>Get Species or Site Scores from an Ordination</h2><span id='topic+scores.predcoca'></span><span id='topic+scores.symcoca'></span>

<h3>Description</h3>

<p>Function to access either species or site scores for specified axes in
co-correspondence analysis ordination methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'predcoca'
scores(x, choices = c(1, 2),
       display = c("sites","species"), ...)

## S3 method for class 'symcoca'
scores(x, choices = c(1, 2),
       display = c("sites","species"), scaling = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scores-methods_+3A_x">x</code></td>
<td>
<p> an ordination result</p>
</td></tr>
<tr><td><code id="scores-methods_+3A_display">display</code></td>
<td>
<p> partial match to access scores for &ldquo;sites&rdquo;
&ldquo;species&rdquo;, &ldquo;loadings&rdquo; or &ldquo;xmatrix&rdquo;. The latter
two are only available for <code><a href="#topic+symcoca">symcoca</a></code>.</p>
</td></tr>
<tr><td><code id="scores-methods_+3A_choices">choices</code></td>
<td>
<p>numeric; the ordination axes to return.</p>
</td></tr>
<tr><td><code id="scores-methods_+3A_scaling">scaling</code></td>
<td>
<p>logical; whether scores should be rescaled
by the quarter root of the eigenvalues using
<code><a href="#topic+rescale.symcoca">rescale.symcoca</a></code>.</p>
</td></tr>
<tr><td><code id="scores-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements a <code><a href="vegan.html#topic+scores">scores</a></code> method for symmetric
co-correspondence analysis ordination results.
</p>


<h3>Value</h3>

<p>A list with one or more components containing matrices of the
requested scores:
</p>
<table>
<tr><td><code>species</code></td>
<td>
<p>A list with two components, <code>Y</code> and <code>X</code>,
containing the species scores for the response matrix <code>Y</code> and
the predictor matrix <code>X</code> respectively.</p>
</td></tr>
<tr><td><code>sites</code></td>
<td>
<p>A list with two components, <code>Y</code> and <code>X</code>,
containing the site scores for the response matrix <code>Y</code> and
the predictor matrix <code>X</code> respectively.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>A list with two components, <code>Y</code> and <code>X</code>
containing the loadings for the response and predictor matrix. For
<code><a href="#topic+symcoca">symcoca</a></code> only.</p>
</td></tr>
<tr><td><code>xmatrix</code></td>
<td>
<p>The X matrix. For <code><a href="#topic+symcoca">symcoca</a></code> only.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gavin L. Simpson, based on Matlab code by C.J.F. ter Braak and
A.P. Schaffers.</p>


<h3>References</h3>

<p>ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <b>85(3)</b>, 834&ndash;846
</p>


<h3>See Also</h3>

<p><code><a href="vegan.html#topic+scores">scores</a></code>, for further details on the method.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load some data
data(beetles)
data(plants)

## log transform the bettle data
beetles &lt;- log(beetles + 1)

## fit the model, a symmetric CoCA
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")

## extract the scores
scr &lt;- scores(bp.sym)

## predictive CoCA using SIMPLS and formula interface
bp.pred &lt;- coca(beetles ~ ., data = plants)
scr2 &lt;- scores(bp.pred)


</code></pre>

<hr>
<h2 id='screeplot.symcoca'>Screeplot for symmetric co-correspondence analysis</h2><span id='topic+screeplot.symcoca'></span>

<h3>Description</h3>

<p>Produces a screeplot of the eigenvalues of a symmetric co-correspondence analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'symcoca'
screeplot(x, type = "b",
    xlab = NULL, ylab = NULL,
    ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="screeplot.symcoca_+3A_x">x</code></td>
<td>
<p> an object of class <code>"symcoca"</code>, the result of
a call to <code><a href="#topic+symcoca">symcoca</a></code>.</p>
</td></tr>
<tr><td><code id="screeplot.symcoca_+3A_type">type</code></td>
<td>
<p> the type of points to draw; see <code><a href="graphics.html#topic+points">points</a></code>.</p>
</td></tr>
<tr><td><code id="screeplot.symcoca_+3A_xlab">xlab</code>, <code id="screeplot.symcoca_+3A_ylab">ylab</code></td>
<td>
<p> labels for the x and y axes. If none supplied
suitable labels are formed from the result object.</p>
</td></tr>
<tr><td><code id="screeplot.symcoca_+3A_...">...</code></td>
<td>
<p> other graphical parameters as in 'par' may also be passed as
arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gavin L. Simpson.</p>


<h3>See Also</h3>

<p><code><a href="#topic+coca">coca</a></code>, <code><a href="stats.html#topic+screeplot">screeplot</a></code>, <code><a href="graphics.html#topic+plot.default">plot.default</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## symmetric CoCA
data(beetles)
data(plants)

## log transform the bettle data
beetles &lt;- log(beetles + 1)

## fit the model
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")

## draw a screeplot of the eignevalues
screeplot(bp.sym)

</code></pre>

<hr>
<h2 id='simpls'>Modified version of Sijmen de Jong's SIMPLS</h2><span id='topic+simpls'></span>

<h3>Description</h3>

<p>Fits a PLSR model with the SIMPLS algorithm, modified to
allow a weighted analysis.</p>


<h3>Usage</h3>

<pre><code class='language-R'>simpls(X, Y, ncomp, stripped = FALSE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simpls_+3A_x">X</code></td>
<td>
<p>a matrix of observations.  <code>NA</code>s and <code>Inf</code>s are not
allowed.</p>
</td></tr> 
<tr><td><code id="simpls_+3A_y">Y</code></td>
<td>
<p>a vector or matrix of responses.  <code>NA</code>s and <code>Inf</code>s
are not allowed.</p>
</td></tr> 
<tr><td><code id="simpls_+3A_ncomp">ncomp</code></td>
<td>
<p>the number of components to be used in the
modelling.</p>
</td></tr>
<tr><td><code id="simpls_+3A_stripped">stripped</code></td>
<td>
<p>logical.  If <code>TRUE</code> the calculations are stripped
as much as possible for speed; this is meant for use with
cross-validation or simulations when only the coefficients are
needed.  Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="simpls_+3A_...">...</code></td>
<td>
<p>other arguments.  Currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a modified version of
<code><a href="pls.html#topic+simpls.fit">simpls.fit</a></code> from package <code>pls</code>. Four
modification have been made:
</p>

<ol>
<li><p> The input matrices <code>X</code> and <code>Y</code> are not centered,
</p>
</li>
<li><p> The scores (<code>tt</code> in the code) are not centered,
</p>
</li>
<li><p> Added code to calculate the total variance in the <code>Y</code>
matrix, <code>Ytotvar</code>, and the variance in <code>Y</code> accounted for
by each PLS axis, <code>Yvar</code> (See Value below), and
</p>
</li>
<li><p> Additional components are returned if argument <code>stripped</code>
is <code>TRUE</code>.
</p>
</li></ol>

<p>This function should not be called directly, but through
the generic function <code><a href="#topic+coca">coca</a></code>.
</p>
<p>SIMPLS is much faster than
the NIPALS algorithm, especially when the number of X variables
increases, but gives slightly different results in the case of
multivariate Y. SIMPLS truly maximises the covariance criterion.
According to de Jong, the standard PLS2 algorithms lie closer to
ordinary least-squares regression where a precise fit is sought;
SIMPLS lies closer to PCR with stable  predictions.</p>


<h3>Value</h3>

<p>A list containing the following components is returned:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>an array of regression coefficients for 1, ...,
<code>ncomp</code> components.  The dimensions of <code>coefficients</code> are
<code>c(nvar, npred, ncomp)</code> with <code>nvar</code> the number
of <code>X</code> variables and <code>npred</code> the number of variables to be
predicted in <code>Y</code>.</p>
</td></tr>
<tr><td><code>scores</code></td>
<td>
<p>a matrix of scores.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>a matrix of loadings.</p>
</td></tr>
<tr><td><code>Yscores</code></td>
<td>
<p>a matrix of Y-scores.</p>
</td></tr>
<tr><td><code>Yloadings</code></td>
<td>
<p>a matrix of Y-loadings.</p>
</td></tr>
<tr><td><code>projection</code></td>
<td>
<p>the projection matrix used to convert X to scores.</p>
</td></tr>
<tr><td><code>Xmeans</code></td>
<td>
<p>a vector of means of the X variables.</p>
</td></tr>
<tr><td><code>Ymeans</code></td>
<td>
<p>a vector of means of the Y variables.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>an array of fitted values.  The dimensions of
<code>fitted.values</code> are <code>c(nobj, npred, ncomp)</code> with
<code>nobj</code> the number samples and <code>npred</code> the number of
Y variables.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>an array of regression residuals.  It has the same
dimensions as <code>fitted.values</code>.</p>
</td></tr>
<tr><td><code>Xvar</code></td>
<td>
<p>a vector with the amount of X-variance explained by each
number of components.</p>
</td></tr>
<tr><td><code>Yvar</code></td>
<td>
<p>a vector with the amount of Y-variance explained by each
number of components.</p>
</td></tr>
<tr><td><code>Xtotvar</code></td>
<td>
<p>Total variance in <code>X</code>.</p>
</td></tr>
<tr><td><code>Ytotvar</code></td>
<td>
<p>Total variance in <code>Y</code>.</p>
</td></tr>
</table>
<p>If <code>stripped</code> is <code>TRUE</code>, only the components
<code>coefficients</code>, <code>Xmeans</code> and <code>Ymeans</code>, <code>Xvar</code> and
<code>Yvar</code>, and <code>Xtotvar</code> and <code>Ytotvar</code> are returned.
</p>


<h3>Author(s)</h3>

<p>Based on <code><a href="pls.html#topic+simpls.fit">simpls.fit</a></code> by Ron Wehrens and
Bjorn-Helge Mevik, with simple modifications by Gavin L. Simpson.</p>


<h3>References</h3>

<p>de Jong, S. (1993) SIMPLS: an alternative approach to partial least
squares regression.  <em>Chemometrics and Intelligent Laboratory Systems</em>,
<b>18</b>, 251&ndash;263.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coca">coca</a></code>
</p>

<hr>
<h2 id='summary-methods'>Summarizing Co-CA Model Fits</h2><span id='topic+summary.predcoca'></span><span id='topic+print.summary.predcoca'></span><span id='topic+summary.symcoca'></span><span id='topic+print.summary.symcoca'></span>

<h3>Description</h3>

<p><code>summary</code> methods for classes <code>"predcoca"</code> and
<code>"symcoca"</code>. These provide a summary of the main results of a
Co-Correspondence Analysis model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predcoca'
summary(object, axes = NULL, ...)

## S3 method for class 'symcoca'
summary(object, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code>"predcoca"</code> or
<code>"symcoca"</code>. Generally the result of a call to
<code><a href="#topic+coca">coca</a></code>.</p>
</td></tr>
<tr><td><code id="summary-methods_+3A_axes">axes</code></td>
<td>
<p>numeric; how many axes to summarise? The default is to
display 6 axes or all available axes, whichever is the smaller.</p>
</td></tr>
<tr><td><code id="summary-methods_+3A_...">...</code></td>
<td>
<p>arguments to be passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the some of the following components:
</p>
<table>
<tr><td><code>cocaScores</code></td>
<td>
<p>The site and/or species scores for the axes requested.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The call used to fit the model.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The eigenvalues for the axes requested. Not for
<code><a href="#topic+predcoca.simpls">predcoca.simpls</a></code>.</p>
</td></tr>
<tr><td><code>namY</code>, <code>namX</code></td>
<td>
<p>the names of the response and predictor either
supplied by the user or derived from the original call.</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>a list with two components <code>loadings1</code> and
<code>loadings2</code>, which refer to the response and the predictor
matrices respectively. (Only for predictive CoCA models.)</p>
</td></tr>
<tr><td><code>varianceExp</code></td>
<td>
<p>a list with components <code>Yblock</code> and
<code>Xblock</code> containing the amount of variance explained on each
CoCA axis in the response and the predictor respectively. (Only for
predictive CoCA models.)</p>
</td></tr>
<tr><td><code>totalVar</code></td>
<td>
<p>a list with components <code>Yblock</code> and <code>Xblock</code>
containing the total variance in the response and the predictor data
sets respectively</p>
</td></tr>
<tr><td><code>inertia</code></td>
<td>
<p>a list with components <code>total</code> and <code>residual</code>
containing the total and residual inertia (variance) in the response
and the predictor matrices of a symmetric CoCA model. (Only for
symmetric CoCA models.)</p>
</td></tr>
<tr><td><code>scaling</code></td>
<td>
<p>the scaling used/requested. (Only for symmetric CoCA models.)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gavin L. Simpson</p>


<h3>See Also</h3>

<p>The model fitting function <code><a href="#topic+coca">coca</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## symmetric CoCA
data(beetles)
data(plants)

## log transform the bettle data
beetles &lt;- log(beetles + 1)

## fit the model
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")
summary(bp.sym)

## Predictive CoCA
bp.pred &lt;- coca(beetles ~ ., data = plants)
summary(bp.pred, axes = 1:2)

</code></pre>

<hr>
<h2 id='weights.symcoca'>Exctract CoCA model weights</h2><span id='topic+weights.symcoca'></span><span id='topic+weights.predcoca'></span>

<h3>Description</h3>

<p>Extractor function to identify and select appropriate analysis weights
from Co-correspondence Analysis models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'symcoca'
weights(object, ...)

## S3 method for class 'predcoca'
weights(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weights.symcoca_+3A_object">object</code></td>
<td>
<p>an object of class <code>"symcoca"</code> or <code>"predcoca"</code>.</p>
</td></tr>
<tr><td><code id="weights.symcoca_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods. Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of common site weights is currently returned. These
correspond to <code class="reqn">R_{0}</code> in ter Braak and Schaffers (2004).
</p>


<h3>Author(s)</h3>

<p>Gavin L. Simpson</p>


<h3>References</h3>

<p>ter Braak, C.J.F and Schaffers, A.P. (2004) Co-Correspondence
Analysis: a new ordination method to relate two community
compositions. <em>Ecology</em> <strong>85(3)</strong>, 834&ndash;846. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+envfit.coca">envfit.coca</a></code> uses these weights to estimate
weighted correlations in ordination space. See <code><a href="#topic+coca">coca</a></code> for
details on creating CoCA models.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## symmetric CoCA
data(beetles)
data(plants)

## log transform the bettle data
beetles &lt;- log(beetles + 1)

## fit the model
bp.sym &lt;- coca(beetles ~ ., data = plants, method = "symmetric")

## weights == R[0]
weights(bp.sym)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
