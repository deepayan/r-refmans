<!DOCTYPE html><html><head><title>Help for package lmeresampler</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lmeresampler}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#bootstrap_pvals'><p>Calculate Bootstrap p-values for fixed effects</p></a></li>
<li><a href='#bootstrap.merMod'><p>Bootstrap Nested Linear Mixed-Effects Models</p></a></li>
<li><a href='#case_bootstrap.merMod'><p>Cases Bootstrap for Nested LMEs</p></a></li>
<li><a href='#combine_lmeresamp'><p>Combine bootstrap results</p></a></li>
<li><a href='#combine_pvals'><p>Combine p-values</p></a></li>
<li><a href='#confint.lmeresamp'><p>Calculate confidence intervals for a lmeresamp object</p></a></li>
<li><a href='#extract_parameters'><p>Extract parameters from LME models</p></a></li>
<li><a href='#jsp728'><p>Junior school project math score data.</p></a></li>
<li><a href='#lmeresampler'><p>lmeresampler: A package for bootstrapping nested linear mixed-effects models</p></a></li>
<li><a href='#parametric_bootstrap.merMod'><p>Parametric Bootstrap for Nested LMEs</p></a></li>
<li><a href='#plot.lmeresamp'><p>Plot bootstrap results</p></a></li>
<li><a href='#print.coef_tbl'><p>Print coefficients from a <code>coef_tbl</code> object</p></a></li>
<li><a href='#print.lmeresamp'><p>Print a summary of an <code>lmeresamp</code> object</p></a></li>
<li><a href='#reb_bootstrap.lmerMod'><p>REB Bootstrap for Two-Level Nested LMEs</p></a></li>
<li><a href='#resid_bootstrap.merMod'><p>Residual Bootstrap for Nested LMEs</p></a></li>
<li><a href='#summary.lmeresamp'><p>Calculate summary statistics for <code>lmeresamp</code> objects</p></a></li>
<li><a href='#wild_bootstrap.lmerMod'><p>Wild Bootstrap for LME models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bootstrap Methods for Nested Linear Mixed-Effects Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Bootstrap routines for nested linear mixed effects models fit using
    either 'lme4' or 'nlme'. The provided 'bootstrap()' function implements the
    parametric, residual, cases, random effect block (REB), and wild bootstrap 
    procedures. An overview of these procedures can be found 
    in Van der Leeden et al. (2008) &lt;<a href="https://doi.org/10.1007%2F978-0-387-73186-5_11">doi:10.1007/978-0-387-73186-5_11</a>&gt;, 
    Carpenter, Goldstein &amp; Rasbash (2003) &lt;<a href="https://doi.org/10.1111%2F1467-9876.00415">doi:10.1111/1467-9876.00415</a>&gt;,
    and Chambers &amp; Chandra (2013) &lt;<a href="https://doi.org/10.1080%2F10618600.2012.681216">doi:10.1080/10618600.2012.681216</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 0.8.0), Matrix, nlmeU, ggplot2, ggdist, HLMdiag,
purrr, forcats, stats, statmod, tidyr, magrittr, tibble</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lme4 (&ge; 1.1-7), nlme, testthat, mlmRev, knitr, rmarkdown,
doParallel, foreach</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/aloy/lmeresampler">https://github.com/aloy/lmeresampler</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/aloy/lmeresampler/issues">https://github.com/aloy/lmeresampler/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-10 19:39:29 UTC; aloy</td>
</tr>
<tr>
<td>Author:</td>
<td>Adam Loy <a href="https://orcid.org/0000-0002-5780-4611"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Spenser Steele [aut],
  Jenna Korobova [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adam Loy &lt;loyad01@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-11 10:10:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling 'rhs(lhs)'.
</p>

<hr>
<h2 id='bootstrap_pvals'>Calculate Bootstrap p-values for fixed effects</h2><span id='topic+bootstrap_pvals'></span><span id='topic+bootstrap_pvals.merMod'></span><span id='topic+bootstrap_pvals.lme'></span>

<h3>Description</h3>

<p>Perform bootstrap tests based on the t-statistic for each
fixed effect in order to calculate approximate p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap_pvals(
  model,
  type,
  B,
  resample = NULL,
  reb_type = NULL,
  hccme = NULL,
  aux.dist = NULL
)

## S3 method for class 'merMod'
bootstrap_pvals(
  model,
  type,
  B,
  resample = NULL,
  reb_type = NULL,
  hccme = NULL,
  aux.dist = NULL
)

## S3 method for class 'lme'
bootstrap_pvals(
  model,
  type,
  B,
  resample = NULL,
  reb_type = NULL,
  hccme = NULL,
  aux.dist = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap_pvals_+3A_model">model</code></td>
<td>
<p>The model object you wish to bootstrap.</p>
</td></tr>
<tr><td><code id="bootstrap_pvals_+3A_type">type</code></td>
<td>
<p>A character string indicating the type of bootstrap that is being
requested. Possible values are <code>"parametric"</code>, <code>"residual"</code>, 
<code>"case"</code>, <code>"wild"</code>, or <code>"reb"</code> 
(random effect block bootstrap).</p>
</td></tr>
<tr><td><code id="bootstrap_pvals_+3A_b">B</code></td>
<td>
<p>The number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="bootstrap_pvals_+3A_resample">resample</code></td>
<td>
<p>A logical vector specifying whether each level of the model 
should be resampled in the cases bootstrap. The levels should be specified 
from the highest level (largest cluster) of the hierarchy to the lowest 
(observation-level); for example for students within a school, specify the 
school level first, then the student level.</p>
</td></tr>
<tr><td><code id="bootstrap_pvals_+3A_reb_type">reb_type</code></td>
<td>
<p>Specification of what random effect block bootstrap version to
implement. Possible values are <code>0</code>, <code>1</code> or <code>2</code>.</p>
</td></tr>
<tr><td><code id="bootstrap_pvals_+3A_hccme">hccme</code></td>
<td>
<p>either <code>"hc2"</code> or <code>"hc3"</code>, indicating which 
heteroscedasticity consistent covariance matrix estimator to use.</p>
</td></tr>
<tr><td><code id="bootstrap_pvals_+3A_aux.dist">aux.dist</code></td>
<td>
<p>one of <code>"mammen"</code>, <code>"rademacher"</code>, <code>"norm"</code>, 
<code>"webb"</code>, or <code>"gamma"</code> indicating which auxiliary 
distribution to draw the errors from</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bootstrap test compares the fitted model specified by the user
to reduced models that eliminate a single fixed effect, the same
comparison summarized by the table of coefficients in the summary.
The bootstrap p-value is then calculated as 
$(n_extreme + 1) / (B + 1)$.
</p>


<h3>Value</h3>

<p>A tibble giving the table of coefficients from the model summary with a column
appended containing bootstrap p-values.
</p>


<h3>References</h3>

<p>Davison, A., &amp; Hinkley, D. (1997). Tests. In Bootstrap Methods and their 
Application (Cambridge Series in Statistical and Probabilistic Mathematics, pp. 136-190). 
Cambridge: Cambridge University Press. doi:10.1017/CBO9780511802843.005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# This takes a while to run
bootstrap_pvals.merMod(jsp_mod, type = "wild", B = 1000, hccme = "hc2", aux.dist = "mammen")

## End(Not run)

</code></pre>

<hr>
<h2 id='bootstrap.merMod'>Bootstrap Nested Linear Mixed-Effects Models</h2><span id='topic+bootstrap.merMod'></span><span id='topic+bootstrap.lme'></span><span id='topic+bootstrap'></span>

<h3>Description</h3>

<p>Perform various bootstrap process for nested linear mixed effects (LMEs) models including:
parametric, residual, cases, wild, and REB bootstraps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merMod'
bootstrap(
  model,
  .f = extract_parameters,
  type,
  B,
  resample,
  reb_type,
  hccme,
  aux.dist,
  orig_data = NULL,
  .refit = TRUE,
  rbootnoise = 0
)

## S3 method for class 'lme'
bootstrap(
  model,
  .f = extract_parameters,
  type,
  B,
  resample,
  reb_type,
  hccme,
  aux.dist,
  orig_data = NULL,
  .refit = TRUE,
  rbootnoise = 0
)

bootstrap(
  model,
  .f,
  type,
  B,
  resample = NULL,
  reb_type = NULL,
  hccme = NULL,
  aux.dist = NULL,
  orig_data = NULL,
  .refit = TRUE,
  rbootnoise = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap.merMod_+3A_model">model</code></td>
<td>
<p>The model object you wish to bootstrap.</p>
</td></tr>
<tr><td><code id="bootstrap.merMod_+3A_.f">.f</code></td>
<td>
<p>A function returning the statistic(s) of interest.</p>
</td></tr>
<tr><td><code id="bootstrap.merMod_+3A_type">type</code></td>
<td>
<p>A character string indicating the type of bootstrap that is being
requested. Possible values are <code>"parametric"</code>, <code>"residual"</code>, 
<code>"case"</code>, <code>"wild"</code>, or <code>"reb"</code> 
(random effect block bootstrap).</p>
</td></tr>
<tr><td><code id="bootstrap.merMod_+3A_b">B</code></td>
<td>
<p>The number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="bootstrap.merMod_+3A_resample">resample</code></td>
<td>
<p>A logical vector specifying whether each level of the model 
should be resampled in the cases bootstrap. The levels should be specified 
from the highest level (largest cluster) of the hierarchy to the lowest 
(observation-level); for example for students within a school, specify the 
school level first, then the student level.</p>
</td></tr>
<tr><td><code id="bootstrap.merMod_+3A_reb_type">reb_type</code></td>
<td>
<p>Specification of what random effect block bootstrap version to
implement. Possible values are <code>0</code>, <code>1</code> or <code>2</code>.</p>
</td></tr>
<tr><td><code id="bootstrap.merMod_+3A_hccme">hccme</code></td>
<td>
<p>either <code>"hc2"</code> or <code>"hc3"</code>, indicating which 
heteroscedasticity consistent covariance matrix estimator to use.</p>
</td></tr>
<tr><td><code id="bootstrap.merMod_+3A_aux.dist">aux.dist</code></td>
<td>
<p>one of <code>"mammen"</code>, <code>"rademacher"</code>, <code>"norm"</code>, 
<code>"webb"</code>, or <code>"gamma"</code> indicating which auxiliary 
distribution to draw the errors from</p>
</td></tr>
<tr><td><code id="bootstrap.merMod_+3A_orig_data">orig_data</code></td>
<td>
<p>the original data frame. This should be specified if variables
are transformed within the formula for <code>glmer()</code> or <code>lmer()</code>
and the case bootstrap is used.</p>
</td></tr>
<tr><td><code id="bootstrap.merMod_+3A_.refit">.refit</code></td>
<td>
<p>a logical value indicating whether the model should be refit to 
the bootstrap resample, or if the simulated bootstrap resample should be 
returned. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="bootstrap.merMod_+3A_rbootnoise">rbootnoise</code></td>
<td>
<p>a numeric value between 0-1 indicating the strength of
technical 2-level noise added in relation to the 1-level variation (in
standard deviations) during residual bootstrapping. Minuscule noise, such
as <code>rbootnoise = 0.0001</code>, can be used to avoid errors with singular
matrices when exactly the same values are replicated during the
bootstrapping, or when the model being processed fails to return any
2-level variation. Currently applicable only with <code>lme4::lmer</code>
models. The feature has been tested with 2-level random-intercept models
with predictors. Defaults to <code>0</code> (i.e. the feature is not used by
default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All of the below methods have been implemented for nested linear mixed-effects
models fit by <code>lmer</code> (i.e., an <code>lmerMod</code> object) and <code>lme</code> 
(i.e., an <code>lmerMod</code> object). Details of the bootstrap procedures can be found
in the help file for that specific function.
</p>


<h3>Value</h3>

<p>The returned value is an object of class &quot;lmeresamp&quot;. This is a list
with the following elements:
</p>

<ul>
<li> <p><code>observed</code>: the estimated values for the model parameters
</p>
</li>
<li> <p><code>model</code>: the fitted model object
</p>
</li>
<li> <p><code>.f</code>: the function call
</p>
</li>
<li> <p><code>replicates</code>: a <code class="reqn">B \times p</code> data frame of bootstrap values for each of the p model parameters,
</p>
</li>
<li> <p><code>stats</code>: a tibble containing the <code>observed</code>, <code>rep.mean</code> (bootstrap mean), 
<code>se</code> (bootstrap standard error), and <code>bias</code> values for each model parameter,
</p>
</li>
<li> <p><code>B</code>: the number of bootstrap resamples performed
</p>
</li>
<li> <p><code>data</code>: the data with which the model was fit
</p>
</li>
<li> <p><code>seed</code>: a vector of randomly generated seeds that are used by the bootstrap
</p>
</li>
<li> <p><code>type</code>: the type of bootstrap executed
</p>
</li>
<li> <p><code>call</code>: the call to <code>bootstrap()</code> that the user
</p>
</li>
<li> <p><code>message</code>: a list of length <code>B</code> giving any messages generated during refitting. An entry will be <code>NULL</code> if no message was generated.
</p>
</li>
<li> <p><code>warning</code>: a list of length <code>B</code> giving any warnings generated during refitting. An entry will be <code>NULL</code> if no message was generated.
</p>
</li>
<li> <p><code>error</code>: a list of length <code>B</code> giving any errors generated during refitting. An entry will be <code>NULL</code> if no message was generated.
</p>
</li></ul>



<h3>References</h3>

<p>Carpenter, J. R., Goldstein, H. and Rasbash, J. (2003) A novel bootstrap 
procedure for assessing the relationship between class size and achievement. 
<em>Journal of the Royal Statistical Society. Series C (Applied Statistics)</em>, 
<b>52</b>, 431&ndash;443.
</p>
<p>Chambers, R. and Chandra, H. (2013) A random effect block bootstrap for 
clustered data. <em>Journal of Computational and Graphical Statistics</em>, 
<b>22</b>, 452&ndash;470.
</p>
<p>Morris, J. S. (2002) The BLUPs are not &quot;best&quot; when it comes to bootstrapping. 
<em>Statistics and Probability Letters</em>, <b>56</b>, 425&ndash;430.
</p>
<p>Van der Leeden, R., Meijer, E. and Busing F. M. (2008) Resampling multilevel 
models. In J. de Leeuw and E. Meijer, editors, <em>Handbook of 
Multilevel Analysis</em>, pages 401&ndash;433. New York: Springer.
</p>
<p>Bates, D., Maechler, M., Bolker, W., Walker, S. (2015).
Fitting Linear Mixed-Effects Models Using lme4. <em>Journal of
Statistical Software</em>, <b>67</b>, 1&ndash;48. doi:10.18637/jss.v067.i01.
</p>
<p>Modugno, L., &amp; Giannerini, S. (2015). The Wild Bootstrap for 
Multilevel Models. <em>Communications in Statistics &ndash; Theory and Methods</em>, 
<b>44</b>(22), 4812&ndash;4825.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+parametric_bootstrap">parametric_bootstrap</a></code>, <code><a href="#topic+resid_bootstrap">resid_bootstrap</a></code>,
<code><a href="#topic+case_bootstrap">case_bootstrap</a></code>, <code><a href="#topic+reb_bootstrap">reb_bootstrap</a></code>, 
<code><a href="#topic+wild_bootstrap">wild_bootstrap</a></code> for more details on a specific bootstrap.
</p>
</li>
<li> <p><code><a href="lme4.html#topic+bootMer">bootMer</a></code> in the <span class="pkg">lme4</span> package for an 
implementation of (semi-)parametric bootstrap for mixed models.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(lme4) 
vcmodA &lt;- lmer(mathAge11 ~ mathAge8 + gender + class + (1 | school), data = jsp728)

## you can write your own function to return stats, or use something like 'fixef'
mySumm &lt;- function(.) { 
  s &lt;- getME(., "sigma")
    c(beta = getME(., "beta"), sigma = s, sig01 = unname(s * getME(., "theta"))) 
}

## running a parametric bootstrap 
set.seed(1234)
boo1 &lt;- bootstrap(model = vcmodA, .f = mySumm, type = "parametric", B = 20)

## to print results in a formatted way
print(boo1)

## Not run: 
## running a cases bootstrap - only resampling the schools
boo2 &lt;- bootstrap(model = vcmodA, .f = mySumm, type = "case", B = 100, resample = c(TRUE, FALSE))

## running a cases bootstrap - resampling the schools and students within the school
boo3 &lt;- bootstrap(model = vcmodA, .f = mySumm, type = "case", B = 100, resample = c(TRUE, TRUE))

## running a residual bootstrap
boo4 &lt;- bootstrap(model = vcmodA, .f = mySumm, type = "residual", B = 100)

## running an REB0 bootstrap
boo5 &lt;- bootstrap(model = vcmodA, .f = mySumm, type = "reb", B = 100, reb_typ = 0)

## Running the Wild bootstrap
boo6 &lt;- bootstrap(model = vcmodA, .f = mySumm, type = "wild", B= 100, 
                  hccme = "hc2", aux.dist = "mammen")

## Running a bootstrap in parallel via foreach
library(foreach)
library(doParallel)
set.seed(1234)
numCores &lt;- 2

cl &lt;- makeCluster(numCores, type = "PSOCK") # make a socket cluster
doParallel::registerDoParallel(cl)          # how the CPU knows to run in parallel

b_parallel &lt;- foreach(B = rep(250, 2), 
                       .combine = combine_lmeresamp,
                       .packages = c("lmeresampler", "lme4")) %dopar% {
                         bootstrap(vcmodA, .f = fixef, type = "parametric", B = B)
                       }
stopCluster(cl)

## Running a bootstrap in parallel via parLapply
cl &lt;- makeCluster(numCores, type = "PSOCK") # make a socket cluster
doParallel::registerDoParallel(cl)          # how the CPU knows to run in parallel

boot_mod &lt;- function(...) {
  library(lme4)
  library(lmeresampler)
  vcmodA &lt;- lmer(mathAge11 ~ mathAge8 + gender + class + (1 | school), data = jsp728)
  bootstrap(vcmodA, .f = fixef, type = "parametric", B = 250)
  
}

result &lt;- parLapply(cl, seq_len(2), boot_mod)
b_parallel2 &lt;- do.call("combine_lmeresamp", result)

stopCluster(cl)

## End(Not run)



</code></pre>

<hr>
<h2 id='case_bootstrap.merMod'>Cases Bootstrap for Nested LMEs</h2><span id='topic+case_bootstrap.merMod'></span><span id='topic+case_bootstrap.lme'></span><span id='topic+case_bootstrap'></span>

<h3>Description</h3>

<p>Generate cases bootstrap replicates of a statistic for a nested linear 
mixed-effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merMod'
case_bootstrap(model, .f, B, resample, orig_data = NULL, .refit = TRUE)

## S3 method for class 'lme'
case_bootstrap(model, .f, B, resample, orig_data = NULL, .refit = TRUE)

case_bootstrap(model, .f, B, resample, orig_data = NULL, .refit = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="case_bootstrap.merMod_+3A_model">model</code></td>
<td>
<p>The model object you wish to bootstrap.</p>
</td></tr>
<tr><td><code id="case_bootstrap.merMod_+3A_.f">.f</code></td>
<td>
<p>A function returning the statistic(s) of interest.</p>
</td></tr>
<tr><td><code id="case_bootstrap.merMod_+3A_b">B</code></td>
<td>
<p>The number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="case_bootstrap.merMod_+3A_resample">resample</code></td>
<td>
<p>A logical vector specifying whether each level of the model 
should be resampled in the cases bootstrap. The levels should be specified 
from the highest level (largest cluster) of the hierarchy to the lowest 
(observation-level); for example for students within a school, specify the 
school level first, then the student level.</p>
</td></tr>
<tr><td><code id="case_bootstrap.merMod_+3A_orig_data">orig_data</code></td>
<td>
<p>the original data frame. This should be specified if variables
are transformed within the formula for <code>glmer()</code> or <code>lmer()</code>
and the case bootstrap is used.</p>
</td></tr>
<tr><td><code id="case_bootstrap.merMod_+3A_.refit">.refit</code></td>
<td>
<p>a logical value indicating whether the model should be refit to 
the bootstrap resample, or if the simulated bootstrap resample should be 
returned. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The cases bootstrap is a fully nonparametric bootstrap that resamples the data
with respect to the clusters in order to generate bootstrap samples. Depending 
on the nature of the data, the resampling can be done only for the higher-level 
cluster(s), only at the observation-level within a cluster, or at all levels.
See Van der Leeden et al. (2008) for a nice discussion of this decision. 
</p>
<p>To resample a given level of the model, the corresponding entry in the logical 
vector specified in the <code>resample</code> parameter must be set to true. A few
examples are given below in terms of a two-level model where students are
clustered within schools:
</p>

<ul>
<li><p> To resample only the schools, set <code>resample = c(TRUE, FALSE)</code>.
</p>
</li>
<li><p> To resample only the students, set <code>resample = c(FALSE, TRUE)</code>.
</p>
</li>
<li><p> To resample both the students and the schools, set <code>resample = c(TRUE, TRUE)</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>The returned value is an object of class &quot;lmeresamp&quot;.
</p>


<h3>References</h3>

<p>Van der Leeden, R., Meijer, E. and Busing F. M. (2008) Resampling multilevel 
models. In J. de Leeuw and E. Meijer, editors, <em>Handbook of 
Multilevel Analysis</em>, pages 401&ndash;433. New York: Springer.
</p>


<h3>See Also</h3>


<ul>
<li><p> Examples are given in <code><a href="#topic+bootstrap">bootstrap</a></code>
</p>
</li>
<li> <p><code><a href="#topic+parametric_bootstrap">parametric_bootstrap</a></code>, <code><a href="#topic+resid_bootstrap">resid_bootstrap</a></code>,
<code><a href="#topic+case_bootstrap">case_bootstrap</a></code>, <code><a href="#topic+reb_bootstrap">reb_bootstrap</a></code>, 
<code><a href="#topic+wild_bootstrap">wild_bootstrap</a></code> for more details on a specific bootstrap.
</p>
</li>
<li> <p><code><a href="lme4.html#topic+bootMer">bootMer</a></code> in the <span class="pkg">lme4</span> package for an 
implementation of (semi-)parametric bootstrap for mixed models.
</p>
</li></ul>


<hr>
<h2 id='combine_lmeresamp'>Combine bootstrap results</h2><span id='topic+combine_lmeresamp'></span>

<h3>Description</h3>

<p>Combines bootstrap results from processes split for parallelization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine_lmeresamp(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combine_lmeresamp_+3A_...">...</code></td>
<td>
<p>two or more objects of class <code>lmeresamp</code>, to be combined into one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This helper function combines the different processes split for
parallelization to yield unified output and bootstrap statistics.
</p>

<hr>
<h2 id='combine_pvals'>Combine p-values</h2><span id='topic+combine_pvals'></span>

<h3>Description</h3>

<p>Combines bootstrap p-values from processes split for parallelization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine_pvals(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combine_pvals_+3A_...">...</code></td>
<td>
<p>two or more summary data frames produced by <code>bootstrap_pvals</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This helper function combines the different summary tables produced by
<code>bootstrap_pvals()</code> when run in parallel to yield unified output
and a single summary table.
</p>

<hr>
<h2 id='confint.lmeresamp'>Calculate confidence intervals for a lmeresamp object</h2><span id='topic+confint.lmeresamp'></span>

<h3>Description</h3>

<p>Calculates normal, basic, and percentile bootstrap confidence intervals 
from a <code>lmeresamp</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmeresamp'
confint(
  object,
  parm,
  level = 0.95,
  type = c("all", "norm", "basic", "perc"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.lmeresamp_+3A_object">object</code></td>
<td>
<p>The lmeresamp object for which confidence intervals should be computed.</p>
</td></tr>
<tr><td><code id="confint.lmeresamp_+3A_parm">parm</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="confint.lmeresamp_+3A_level">level</code></td>
<td>
<p>The level at which the confidence interval should be calculated.</p>
</td></tr>
<tr><td><code id="confint.lmeresamp_+3A_type">type</code></td>
<td>
<p>A character string giving the type of confidence intervals that should be calculated. 
This should be a subset of <code>c("norm", "basic", "perc")</code> (for normal, basic, and percentile
bootstrap confidence intervals, respectively), or <code>"all"</code>.</p>
</td></tr>
<tr><td><code id="confint.lmeresamp_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with columns term, estimate, lower, upper, type, and level.
</p>

<hr>
<h2 id='extract_parameters'>Extract parameters from LME models</h2><span id='topic+extract_parameters'></span>

<h3>Description</h3>

<p>A utility function that extracts the fixed effects and variance component
estimates from a fitted <code>merMod</code> or <code>lme</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_parameters(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_parameters_+3A_model">model</code></td>
<td>
<p>the fitted model object, either an <code>merMod</code> or <code>lme</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector of parameters.
</p>

<hr>
<h2 id='jsp728'>Junior school project math score data.</h2><span id='topic+jsp728'></span>

<h3>Description</h3>

<p>A dataset containing 728 students from 50 primary (elementary) schools in inner 
London that were part of the Junior School Project (JSP). The variables are
as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(jsp728)
</code></pre>


<h3>Format</h3>

<p>A data frame with 728 rows and 8 variables.
</p>

<dl>
<dt>mathAge11</dt><dd><p>score on math at age 11</p>
</dd>
<dt>mathAge8</dt><dd><p>score on math at age 8</p>
</dd>
<dt>gender</dt><dd><p>gender, a factor with 2 levels (F, M)</p>
</dd>
<dt>class</dt><dd><p>father's social class, a factor with 2 levels (manual, nonmanual)</p>
</dd>
<dt>school</dt><dd><p>school code (1-50)</p>
</dd>
<dt>normAge11</dt><dd><p>normalized score on math at age 11</p>
</dd>
<dt>normAge8</dt><dd><p>normalized score on math at age 8</p>
</dd>
<dt>schoolMathAge8</dt><dd><p>average school math score</p>
</dd>
<dt>mathAge8c</dt><dd><p>centered math score at age 8</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://www.bristol.ac.uk/cmm/team/hg/msm-3rd-ed/datasets.html">http://www.bristol.ac.uk/cmm/team/hg/msm-3rd-ed/datasets.html</a>
</p>


<h3>References</h3>

<p>Goldstein, H. (2011). Multilevel Statistical Models (4th ed.). Hoboken: Wiley
</p>

<hr>
<h2 id='lmeresampler'>lmeresampler: A package for bootstrapping nested linear mixed-effects models</h2><span id='topic+lmeresampler'></span><span id='topic+package-lmeresampler'></span>

<h3>Description</h3>

<p>The <span class="pkg">lme4</span> and <span class="pkg">nlme</span> packages have made fitting nested 
linear mixed-effects (LME) models quite easy. Using the the 
functionality of these packages we can easily use maximum 
likelihood or restricted maximum likelihood to fit a 
model and conduct inference using our parametric toolkit. 
In practice, the assumptions of our model are often violated 
to such a degree that leads to biased estimators and 
incorrect standard errors. In these situations, resampling 
methods such as the bootstrap can be used to obtain consistent 
estimators and standard errors for inference. 
<code>lmeresampler</code> provides an easy way to bootstrap nested 
linear-mixed effects models using either fit using either <span class="pkg">lme4</span> or 
<span class="pkg">nlme</span>.
</p>


<h3>Details</h3>

<p>A variety of bootstrap procedures are available: 
</p>

<ul>
<li><p> the parametric bootstrap: <code><a href="#topic+parametric_bootstrap">parametric_bootstrap</a></code>
</p>
</li>
<li><p> the residual bootstrap: <code><a href="#topic+resid_bootstrap">resid_bootstrap</a></code>
</p>
</li>
<li><p> the cases (i.e. non-parametric) bootstrap: <code><a href="#topic+case_bootstrap">case_bootstrap</a></code>
</p>
</li>
<li><p> the random effects block (REB) bootstrap: <code><a href="#topic+reb_bootstrap">reb_bootstrap</a></code>
</p>
</li>
<li><p> the Wild bootstrap: <code><a href="#topic+wild_bootstrap">wild_bootstrap</a></code>
</p>
</li></ul>

<p>In addition to the individual bootstrap functions, <code>lmeresampler</code> provides
a unified interface to bootstrapping LME models in its  <code>bootstrap</code> function.
</p>

<hr>
<h2 id='parametric_bootstrap.merMod'>Parametric Bootstrap for Nested LMEs</h2><span id='topic+parametric_bootstrap.merMod'></span><span id='topic+parametric_bootstrap.lme'></span><span id='topic+parametric_bootstrap'></span>

<h3>Description</h3>

<p>Generate parametric bootstrap replicates of a statistic for a nested linear 
mixed-effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merMod'
parametric_bootstrap(model, .f, B, .refit = TRUE)

## S3 method for class 'lme'
parametric_bootstrap(model, .f, B, .refit = TRUE)

parametric_bootstrap(model, .f, B, .refit = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parametric_bootstrap.merMod_+3A_model">model</code></td>
<td>
<p>The model object you wish to bootstrap.</p>
</td></tr>
<tr><td><code id="parametric_bootstrap.merMod_+3A_.f">.f</code></td>
<td>
<p>A function returning the statistic(s) of interest.</p>
</td></tr>
<tr><td><code id="parametric_bootstrap.merMod_+3A_b">B</code></td>
<td>
<p>The number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="parametric_bootstrap.merMod_+3A_.refit">.refit</code></td>
<td>
<p>a logical value indicating whether the model should be refit to 
the bootstrap resample, or if the simulated bootstrap resample should be 
returned. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parametric bootstrap simulates bootstrap samples from the estimated 
distribution functions. That is, error terms and random effects are simulated
from their estimated normal distributions and are combined into bootstrap
samples via the fitted model equation.
</p>


<h3>Value</h3>

<p>The returned value is an object of class &quot;lmeresamp&quot;.
</p>


<h3>References</h3>

<p>Chambers, R. and Chandra, H. (2013) A random effect block bootstrap for 
clustered data. <em>Journal of Computational and Graphical Statistics</em>, 
<b>22</b>, 452&ndash;470.
</p>
<p>Van der Leeden, R., Meijer, E. and Busing F. M. (2008) Resampling multilevel 
models. In J. de Leeuw and E. Meijer, editors, <em>Handbook of 
Multilevel Analysis</em>, pages 401&ndash;433. New York: Springer.
</p>


<h3>See Also</h3>


<ul>
<li><p> Examples are given in <code><a href="#topic+bootstrap">bootstrap</a></code>
</p>
</li>
<li> <p><code><a href="#topic+parametric_bootstrap">parametric_bootstrap</a></code>, <code><a href="#topic+resid_bootstrap">resid_bootstrap</a></code>,
<code><a href="#topic+case_bootstrap">case_bootstrap</a></code>, <code><a href="#topic+reb_bootstrap">reb_bootstrap</a></code>, 
<code><a href="#topic+wild_bootstrap">wild_bootstrap</a></code> for more details on a specific bootstrap.
</p>
</li>
<li> <p><code><a href="lme4.html#topic+bootMer">bootMer</a></code> in the <span class="pkg">lme4</span> package for an 
implementation of (semi-)parametric bootstrap for mixed models.
</p>
</li></ul>


<hr>
<h2 id='plot.lmeresamp'>Plot bootstrap results</h2><span id='topic+plot.lmeresamp'></span>

<h3>Description</h3>

<p>Generate a density plot with a half-eye plot representing the 68
percentile intervals from an <code>lmeresamp</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmeresamp'
plot(x, var, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.lmeresamp_+3A_x">x</code></td>
<td>
<p>The lmeresamp object to plot.</p>
</td></tr>
<tr><td><code id="plot.lmeresamp_+3A_var">var</code></td>
<td>
<p>The estimated parameter to plot, as a string or column number.</p>
</td></tr>
<tr><td><code id="plot.lmeresamp_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>

<hr>
<h2 id='print.coef_tbl'>Print coefficients from a <code>coef_tbl</code> object</h2><span id='topic+print.coef_tbl'></span>

<h3>Description</h3>

<p>Print table of coefficients produced by <code>bootstrap_pvals</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coef_tbl'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.coef_tbl_+3A_x">x</code></td>
<td>
<p>the coef_tbl object to print</p>
</td></tr>
<tr><td><code id="print.coef_tbl_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>

<hr>
<h2 id='print.lmeresamp'>Print a summary of an <code>lmeresamp</code> object</h2><span id='topic+print.lmeresamp'></span>

<h3>Description</h3>

<p>Print summary statistics and confidence intervals, if desired, for an <code>lmeresamp</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmeresamp'
print(x, ci = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.lmeresamp_+3A_x">x</code></td>
<td>
<p>The lmeresamp object to print.</p>
</td></tr>
<tr><td><code id="print.lmeresamp_+3A_ci">ci</code></td>
<td>
<p>A logical value specifying whether confidence intervals should be printed.</p>
</td></tr>
<tr><td><code id="print.lmeresamp_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the bootstrap statistics are stored in a vector (as opposed to a data frame or tibble), 
then summary statistics will be calculated and printed. The printed data frame will include
the name of the term (if applicable), the observed value (<code>observed</code>), the mean of the bootstrap replicated 
(<code>rep.mean</code>), the standard error (<code>se</code>), and the bootstrap bias estimate (<code>bias</code>).
In addition, the number of resamples will be printed. If any messages, warnings, or errors were
generated during the bootstrap procedure, they will be summarized below, and you should check the 
<code>message</code>, <code>warning</code>, and <code>error</code> elements of the <code>lmeresamp</code> object to
investigate further.
</p>

<hr>
<h2 id='reb_bootstrap.lmerMod'>REB Bootstrap for Two-Level Nested LMEs</h2><span id='topic+reb_bootstrap.lmerMod'></span><span id='topic+reb_bootstrap.lme'></span><span id='topic+reb_bootstrap'></span>

<h3>Description</h3>

<p>Generate random effect block (REB) bootstrap replicates of a statistic for a 
two-level nested linear mixed-effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmerMod'
reb_bootstrap(model, .f, B, reb_type, .refit = TRUE)

## S3 method for class 'lme'
reb_bootstrap(model, .f, B, reb_type, .refit = TRUE)

reb_bootstrap(model, .f, B, reb_type, .refit = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reb_bootstrap.lmerMod_+3A_model">model</code></td>
<td>
<p>The model object you wish to bootstrap.</p>
</td></tr>
<tr><td><code id="reb_bootstrap.lmerMod_+3A_.f">.f</code></td>
<td>
<p>A function returning the statistic(s) of interest.</p>
</td></tr>
<tr><td><code id="reb_bootstrap.lmerMod_+3A_b">B</code></td>
<td>
<p>The number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="reb_bootstrap.lmerMod_+3A_reb_type">reb_type</code></td>
<td>
<p>Specification of what random effect block bootstrap version to
implement. Possible values are <code>0</code>, <code>1</code> or <code>2</code>.</p>
</td></tr>
<tr><td><code id="reb_bootstrap.lmerMod_+3A_.refit">.refit</code></td>
<td>
<p>a logical value indicating whether the model should be refit to 
the bootstrap resample, or if the simulated bootstrap resample should be 
returned. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The random effects block (REB) bootstrap was outlined by Chambers and Chandra (2013)
and has been developed for two-level nested linear mixed-effects (LME) models. 
Consider a two-level LME of the form
</p>
<p style="text-align: center;"><code class="reqn">y = X \beta + Z b + \epsilon</code>
</p>

<p>The REB bootstrap algorithm (<code>type = 0</code>) is as follows:
</p>

<ol>
<li><p> Calculate the nonparametric residual quantities for the fitted model
</p>

<ul>
<li><p> marginal residuals <code class="reqn">r = y - X\beta</code>
</p>
</li>
<li><p> predicted random effects <code class="reqn">\tilde{b} = (Z^\prime Z)^{-1} Z^\prime r</code>
</p>
</li>
<li><p> error terms <code class="reqn">\tilde{e} = r - Z \tilde{b}</code>
</p>
</li></ul>

</li>
<li><p> Take a simple random sample, with replacement, of the predicted random effects, <code class="reqn">\tilde{b}</code>.
</p>
</li>
<li><p> Draw a simple random sample, with replacement, of the group (cluster) IDs.
For each sampled cluster, draw a random sample, with replacement, of size 
<code class="reqn">n_i</code> from that cluster's vector of error terms, <code class="reqn">\tilde{e}</code>.
</p>
</li>
<li><p> Generate bootstrap samples via the fitted model equation 
<code class="reqn">y = X \widehat{\beta} + Z \tilde{b} + \tilde{e}</code>
</p>
</li>
<li><p> Refit the model and extract the statistic(s) of interest.
</p>
</li>
<li><p> Repeat steps 2-5 B times.
</p>
</li></ol>

<p>Variation 1 (<code>type = 1</code>): 
The first variation of the REB bootstrap zero centers and rescales the 
residual quantities prior to resampling.
</p>
<p>Variation 2 (<code>type = 2</code>):
The second variation of the REB bootstrap scales the estimates and centers
the bootstrap distributions (i.e., adjusts for bias) after REB bootstrapping.
</p>


<h3>Value</h3>

<p>The returned value is an object of class &quot;lmeresamp&quot;.
</p>


<h3>References</h3>

<p>Chambers, R. and Chandra, H. (2013) A random effect block bootstrap for 
clustered data. <em>Journal of Computational and Graphical Statistics</em>, 
<b>22</b>, 452&ndash;470.
</p>


<h3>See Also</h3>


<ul>
<li><p> Examples are given in <code><a href="#topic+bootstrap">bootstrap</a></code>
</p>
</li>
<li> <p><code><a href="#topic+parametric_bootstrap">parametric_bootstrap</a></code>, <code><a href="#topic+resid_bootstrap">resid_bootstrap</a></code>,
<code><a href="#topic+case_bootstrap">case_bootstrap</a></code>, <code><a href="#topic+reb_bootstrap">reb_bootstrap</a></code>, 
<code><a href="#topic+wild_bootstrap">wild_bootstrap</a></code> for more details on a specific bootstrap.
</p>
</li>
<li> <p><code><a href="lme4.html#topic+bootMer">bootMer</a></code> in the <span class="pkg">lme4</span> package for an 
implementation of (semi-)parametric bootstrap for mixed models.
</p>
</li></ul>


<hr>
<h2 id='resid_bootstrap.merMod'>Residual Bootstrap for Nested LMEs</h2><span id='topic+resid_bootstrap.merMod'></span><span id='topic+resid_bootstrap.lme'></span><span id='topic+resid_bootstrap'></span>

<h3>Description</h3>

<p>Generate semi-parametric residual bootstrap replicates of a statistic for a nested 
linear mixed-effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'merMod'
resid_bootstrap(model, .f, B, .refit = TRUE, rbootnoise = 0)

## S3 method for class 'lme'
resid_bootstrap(model, .f, B, .refit = TRUE, rbootnoise)

resid_bootstrap(model, .f, B, .refit = TRUE, rbootnoise = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resid_bootstrap.merMod_+3A_model">model</code></td>
<td>
<p>The model object you wish to bootstrap.</p>
</td></tr>
<tr><td><code id="resid_bootstrap.merMod_+3A_.f">.f</code></td>
<td>
<p>A function returning the statistic(s) of interest.</p>
</td></tr>
<tr><td><code id="resid_bootstrap.merMod_+3A_b">B</code></td>
<td>
<p>The number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="resid_bootstrap.merMod_+3A_.refit">.refit</code></td>
<td>
<p>a logical value indicating whether the model should be refit to 
the bootstrap resample, or if the simulated bootstrap resample should be 
returned. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="resid_bootstrap.merMod_+3A_rbootnoise">rbootnoise</code></td>
<td>
<p>a numeric value between 0-1 indicating the strength of
technical 2-level noise added in relation to the 1-level variation (in
standard deviations) during residual bootstrapping. Minuscule noise, such
as <code>rbootnoise = 0.0001</code>, can be used to avoid errors with singular
matrices when exactly the same values are replicated during the
bootstrapping, or when the model being processed fails to return any
2-level variation. Currently applicable only with <code>lme4::lmer</code>
models. The feature has been tested with 2-level random-intercept models
with predictors. Defaults to <code>0</code> (i.e. the feature is not used by
default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The semi-parametric bootstrap algorithm implemented was outlined by  Carpenter,  
Goldstein and Rasbash (2003), and is referred to as the CGR bootstrap by some. 
The algorithm is outlined below:
</p>

<ol>
<li><p> Obtain the parameter estimates from the fitted model and calculate
the estimated error terms and EBLUPs.
</p>
</li>
<li><p> Center and rescale the error terms and EBLUPs so that the empirical variance of
these quantities is equal to estimated variance components from the model.
</p>
</li>
<li><p> Sample independently with replacement from the rescaled estimated error 
terms and rescaled EBLUPs.
</p>
</li>
<li><p> Obtain bootstrap samples by combining the samples via the fitted model equation.
</p>
</li>
<li><p> Refit the model and extract the statistic(s) of interest.
</p>
</li>
<li><p> Repeat steps 3-5 B times.
</p>
</li></ol>



<h3>Value</h3>

<p>The returned value is an object of class &quot;lmeresamp&quot;.
</p>


<h3>References</h3>

<p>Carpenter, J. R., Goldstein, H. and Rasbash, J. (2003) A novel bootstrap 
procedure for assessing the relationship between class size and achievement. 
<em>Journal of the Royal Statistical Society. Series C (Applied Statistics)</em>, 
<b>52</b>, 431&ndash;443.
</p>


<h3>See Also</h3>


<ul>
<li><p> Examples are given in <code><a href="#topic+bootstrap">bootstrap</a></code>
</p>
</li>
<li> <p><code><a href="#topic+parametric_bootstrap">parametric_bootstrap</a></code>, <code><a href="#topic+resid_bootstrap">resid_bootstrap</a></code>,
<code><a href="#topic+case_bootstrap">case_bootstrap</a></code>, <code><a href="#topic+reb_bootstrap">reb_bootstrap</a></code>, 
<code><a href="#topic+wild_bootstrap">wild_bootstrap</a></code> for more details on a specific bootstrap.
</p>
</li>
<li> <p><code><a href="lme4.html#topic+bootMer">bootMer</a></code> in the <span class="pkg">lme4</span> package for an 
implementation of (semi-)parametric bootstrap for mixed models.
</p>
</li></ul>


<hr>
<h2 id='summary.lmeresamp'>Calculate summary statistics for <code>lmeresamp</code> objects</h2><span id='topic+summary.lmeresamp'></span>

<h3>Description</h3>

<p>Calculate basic summary statistics such as the mean, standard error, and bias of the
bootstrap replicates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmeresamp'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.lmeresamp_+3A_object">object</code></td>
<td>
<p>The lmeresamp object to be summarized.</p>
</td></tr>
<tr><td><code id="summary.lmeresamp_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the bootstrap statistics are stored in a vector (as opposed to a data frame or tibble), 
then summary statistics will be calculated. The printed data frame will include
the name of the term (if applicable), the observed value (<code>observed</code>), the mean of the bootstrap replicated 
(<code>rep.mean</code>), the standard error (<code>se</code>), and the bootstrap bias estimate (<code>bias</code>).
In addition, the number of resamples will be printed. If any messages, warnings, or errors were
generated during the bootstrap procedure, they will be summarized below, and you should check the 
<code>message</code>, <code>warning</code>, and <code>error</code> elements of the <code>lmeresamp</code> object to
investigate further.
</p>

<hr>
<h2 id='wild_bootstrap.lmerMod'>Wild Bootstrap for LME models</h2><span id='topic+wild_bootstrap.lmerMod'></span><span id='topic+wild_bootstrap.lme'></span><span id='topic+wild_bootstrap'></span>

<h3>Description</h3>

<p>Generate wild bootstrap replicates of a statistic for a 
linear mixed-effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmerMod'
wild_bootstrap(
  model,
  .f,
  B,
  hccme = c("hc2", "hc3"),
  aux.dist = c("mammen", "rademacher", "norm", "webb", "gamma"),
  .refit = TRUE
)

## S3 method for class 'lme'
wild_bootstrap(
  model,
  .f,
  B,
  hccme = c("hc2", "hc3"),
  aux.dist = c("mammen", "rademacher", "norm", "webb", "gamma"),
  .refit = TRUE
)

wild_bootstrap(model, .f, B, hccme, aux.dist, .refit = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wild_bootstrap.lmerMod_+3A_model">model</code></td>
<td>
<p>The model object you wish to bootstrap.</p>
</td></tr>
<tr><td><code id="wild_bootstrap.lmerMod_+3A_.f">.f</code></td>
<td>
<p>A function returning the statistic(s) of interest.</p>
</td></tr>
<tr><td><code id="wild_bootstrap.lmerMod_+3A_b">B</code></td>
<td>
<p>The number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="wild_bootstrap.lmerMod_+3A_hccme">hccme</code></td>
<td>
<p>either <code>"hc2"</code> or <code>"hc3"</code>, indicating which 
heteroscedasticity consistent covariance matrix estimator to use.</p>
</td></tr>
<tr><td><code id="wild_bootstrap.lmerMod_+3A_aux.dist">aux.dist</code></td>
<td>
<p>one of <code>"mammen"</code>, <code>"rademacher"</code>, <code>"norm"</code>, 
<code>"webb"</code>, or <code>"gamma"</code> indicating which auxiliary 
distribution to draw the errors from</p>
</td></tr>
<tr><td><code id="wild_bootstrap.lmerMod_+3A_.refit">.refit</code></td>
<td>
<p>a logical value indicating whether the model should be refit to 
the bootstrap resample, or if the simulated bootstrap resample should be 
returned. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The wild bootstrap algorithm for LMEs implemented here was outlined by  
Modugno &amp; Giannerini (2015). The algorithm is outlined below:
</p>

<ol>
<li><p> Draw a random sample equal to the number of groups (clusters) from
an auxillary distribution with mean zero and unit variance. 
Denote these as <code class="reqn">w_1, \ldots, w_g</code>.
</p>
</li>
<li><p> Calculate the selected heteroscedasticity consistent matrix estimator for
the marginal residuals, <code class="reqn">\tilde{v}_i</code>
</p>
</li>
<li><p> Generate bootstrap responses using the fitted equation: 
<code class="reqn">y_i^* = X_i \beta + \tilde{v}_i w_j</code>
</p>
</li>
<li><p> Refit the model and extract the statistic(s) of interest.
</p>
</li>
<li><p> Repeat steps 2-4 B times.
</p>
</li></ol>



<h3>Value</h3>

<p>The returned value is an object of class &quot;lmeresamp&quot;.
</p>


<h3>References</h3>

<p>Modugno, L., &amp; Giannerini, S. (2015). The Wild Bootstrap for 
Multilevel Models. <em>Communications in Statistics &ndash; Theory and Methods</em>, 
<b>44</b>(22), 4812&ndash;4825.
</p>


<h3>See Also</h3>


<ul>
<li><p> Examples are given in <code><a href="#topic+bootstrap">bootstrap</a></code>
</p>
</li>
<li> <p><code><a href="#topic+parametric_bootstrap">parametric_bootstrap</a></code>, <code><a href="#topic+resid_bootstrap">resid_bootstrap</a></code>,
<code><a href="#topic+case_bootstrap">case_bootstrap</a></code>, <code><a href="#topic+reb_bootstrap">reb_bootstrap</a></code>, 
<code><a href="#topic+wild_bootstrap">wild_bootstrap</a></code> for more details on a specific bootstrap.
</p>
</li>
<li> <p><code><a href="lme4.html#topic+bootMer">bootMer</a></code> in the <span class="pkg">lme4</span> package for an 
implementation of (semi-)parametric bootstrap for mixed models.
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
