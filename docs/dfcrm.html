<!DOCTYPE html><html><head><title>Help for package dfcrm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dfcrm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cohere'><p>Coherence of two-stage CRM</p></a></li>
<li><a href='#crm'><p>Executing the CRM</p></a></li>
<li><a href='#crmsens'><p>Model Sensitivity in the CRM</p></a></li>
<li><a href='#crmsim'><p>CRM Simulator</p></a></li>
<li><a href='#getinit'><p>Calibrating an initial design</p></a></li>
<li><a href='#getn'><p>Sample size calculator for CRM trials</p></a></li>
<li><a href='#getprior'><p>Calibrating prior DLT rates</p></a></li>
<li><a href='#titecrm'><p>Executing the TITE-CRM</p></a></li>
<li><a href='#titesim'><p>TITE-CRM Simulator</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.2-2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2013-08-01</td>
</tr>
<tr>
<td>Title:</td>
<td>Dose-Finding by the Continual Reassessment Method</td>
</tr>
<tr>
<td>Author:</td>
<td>Ken Cheung &lt;yc632@columbia.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jimmy Duong &lt;jkd2108@columbia.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to run the CRM and
        TITE-CRM in phase I trials and calibration tools for trial
        planning purposes.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.columbia.edu/~yc632">http://www.columbia.edu/~yc632</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-01-26 16:15:23 UTC; hornik</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-01-26 16:38:38 UTC</td>
</tr>
</table>
<hr>
<h2 id='cohere'>Coherence of two-stage CRM</h2><span id='topic+cohere'></span>

<h3>Description</h3>

<p>Returns a message on the coherence status of a two-stage CRM
design.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cohere(prior, target, x0, method = "bayes", model = "empiric", 
    intcpt = 3, scale = sqrt(1.34), detail = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cohere_+3A_prior">prior</code></td>
<td>
<p>A vector of initial guesses of toxicity probabilities
associated the doses.</p>
</td></tr>
<tr><td><code id="cohere_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="cohere_+3A_x0">x0</code></td>
<td>
<p>The initial design containing a non-decreasing sequence of
dose levels.  The length of the initial design is the sample size.</p>
</td></tr>
<tr><td><code id="cohere_+3A_method">method</code></td>
<td>
<p>A character string to specify the method for parameter
estimation.  The default method &ldquo;bayes&rdquo; estimates the model
parameter by the posterior mean.  Maximum likelihood estimation is
specified by &ldquo;mle&rdquo;.</p>
</td></tr>
<tr><td><code id="cohere_+3A_model">model</code></td>
<td>
<p>A character string to specify the working model used in
the method.  The default model is &ldquo;empiric&rdquo;.  A one-parameter
logistic model is specified by &ldquo;logistic&rdquo;.</p>
</td></tr>
<tr><td><code id="cohere_+3A_intcpt">intcpt</code></td>
<td>
<p>The intercept of the working logistic model.  The
default is 3.  If <code>model</code>=&ldquo;empiric&rdquo;, this argument will be
ignored.</p>
</td></tr>
<tr><td><code id="cohere_+3A_scale">scale</code></td>
<td>
<p>Standard deviation of the normal prior of the model
parameter.  Default is sqrt(1.34).</p>
</td></tr>
<tr><td><code id="cohere_+3A_detail">detail</code></td>
<td>
<p>If TRUE, details about incoherent escalations
will be displayed.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>message</code></td>
<td>
<p>A string character giving a message regarding the
coherence status of a two-stage CRM design.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cheung, Y. K. (2005). Coherence principles in dose-finding studies.
Biometrika 92:863-873.
</p>
<p>Cheung, Y. K. (2011).  Dose Finding by the Continual Reassessment Method.  New York: Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crm">crm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior &lt;- c(0.05, 0.10, 0.20, 0.35, 0.50, 0.70)
x0 &lt;- c(rep(1,3), rep(2,3), rep(3,3), rep(4,3), rep(5,3), rep(6,9))

# The above design is coherent when target rate = 0.20
foo &lt;- cohere(prior, target=0.2, x0)
foo

# The design is incoherent if a larger target DLT rate is used.
foo2 &lt;- cohere(prior, target=0.3, x0)
</code></pre>

<hr>
<h2 id='crm'>Executing the CRM</h2><span id='topic+crm'></span><span id='topic+plot.mtd'></span><span id='topic+print.mtd'></span><span id='topic+crmh'></span><span id='topic+crmhlgt'></span><span id='topic+lcrm'></span><span id='topic+lcrmlgt'></span><span id='topic+myjitter'></span>

<h3>Description</h3>

<p><code>crm</code> is used to compute a dose for the next patient in a phase I
trial according to the CRM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crm(prior, target, tox, level, n = length(level), dosename = NULL, 
    include = 1:n, pid = 1:n, conf.level = 0.9, method = "bayes", 
    model = "empiric", intcpt = 3, scale = sqrt(1.34), model.detail = TRUE, 
    patient.detail = TRUE, var.est = TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crm_+3A_prior">prior</code></td>
<td>
<p>A vector of initial guesses of toxicity probabilities
associated the doses.</p>
</td></tr>
<tr><td><code id="crm_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="crm_+3A_tox">tox</code></td>
<td>
<p>A vector of patient outcomes; 1 indicates a toxicity, 0
otherwise.</p>
</td></tr>
<tr><td><code id="crm_+3A_level">level</code></td>
<td>
<p>A vector of dose levels assigned to patients.  The length
of <code>level</code> must be equal to that of <code>tox</code>.</p>
</td></tr>
<tr><td><code id="crm_+3A_n">n</code></td>
<td>
<p>The number of patients enrolled.</p>
</td></tr>
<tr><td><code id="crm_+3A_dosename">dosename</code></td>
<td>
<p>A vector containing the names of the regimens/doses
used.  The length of <code>dosename</code> must be equal to that of
<code>prior</code>.</p>
</td></tr>
<tr><td><code id="crm_+3A_include">include</code></td>
<td>
<p>A subset of patients included in the dose calculation.</p>
</td></tr>
<tr><td><code id="crm_+3A_pid">pid</code></td>
<td>
<p>Patient ID provided in the study.  Its length must be equal
to that of <code>level</code>.</p>
</td></tr>
<tr><td><code id="crm_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level for the probability/confidence
interval of the returned dose-toxicity curve.</p>
</td></tr>
<tr><td><code id="crm_+3A_method">method</code></td>
<td>
<p>A character string to specify the method for parameter
estimation.  The default method <code>"bayes"</code> estimates the model
parameter by the posterior mean.  Maximum likelihood estimation
is specified by <code>"mle"</code>.</p>
</td></tr>
<tr><td><code id="crm_+3A_model">model</code></td>
<td>
<p>A character string to specify the working model used in
the method.  The default model is <code>"empiric"</code>.  A one-parameter
logistic model is specified by <code>"logistic"</code>.</p>
</td></tr>
<tr><td><code id="crm_+3A_intcpt">intcpt</code></td>
<td>
<p>The intercept of the working logistic model.  The
default is 3.  If <code>model="empiric"</code>, this argument will be
ignored.</p>
</td></tr>
<tr><td><code id="crm_+3A_scale">scale</code></td>
<td>
<p>Standard deviation of the normal prior of the model
parameter.  Default is sqrt(1.34).</p>
</td></tr>
<tr><td><code id="crm_+3A_model.detail">model.detail</code></td>
<td>
<p>If FALSE, the model content of an <code>"mtd"</code> object
will not be displayed.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="crm_+3A_patient.detail">patient.detail</code></td>
<td>
<p>If FALSE, patient summary of an <code>"mtd"</code> object
will not be displayed.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="crm_+3A_var.est">var.est</code></td>
<td>
<p>If TRUE, variance of the estimate of the model parameter and
probability/confidence interval for the dose-toxicity curve will be
computed </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For maximum likelihood estimation, the variance of the estimate of
<code class="reqn">\beta</code> (<code>post.var</code>) is approximated by the posterior variance of
<code class="reqn">\beta</code> with a dispersed normal prior.
</p>
<p>The empiric model is specified as <code class="reqn">F(d, \beta) = d^{\exp(\beta)}</code>.
The logistic model is specified as logit <code class="reqn">(F(d,\beta))</code> = <code>intcpt</code>
<code class="reqn">+ \exp(\beta) \times d</code>.  For <code>method="bayes"</code>, the prior on
<code class="reqn">\beta</code> is normal with mean 0.  Exponentiation of <code class="reqn">\beta</code> ensures an
increasing dose-toxicity function.
</p>


<h3>Value</h3>

<p>An object of class <code>"mtd"</code> is returned, consisting of the summary
of dose assignments thus far and the recommendation of dose for the
next patient.
</p>
<table>
<tr><td><code>prior</code></td>
<td>
<p>Initial guesses of toxicity rates.</p>
</td></tr>
<tr><td><code>target</code></td>
<td>
<p>The target probability of toxicity at the MTD.</p>
</td></tr>
<tr><td><code>ptox</code></td>
<td>
<p>Updated estimates of toxicity rates.</p>
</td></tr>
<tr><td><code>ptoxL</code></td>
<td>
<p>Lower confidence/probability limits of toxicity rates.</p>
</td></tr>
<tr><td><code>ptoxU</code></td>
<td>
<p>Upper confidence/probability limits of toxicity rates.</p>
</td></tr>
<tr><td><code>mtd</code></td>
<td>
<p>The updated estimate of the MTD.</p>
</td></tr>
<tr><td><code>prior.var</code></td>
<td>
<p>The variance of the normal prior.</p>
</td></tr>
<tr><td><code>post.var</code></td>
<td>
<p>The posterior variance of the model parameter.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>Estimate of the model parameter.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method of estimation.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>The working model.</p>
</td></tr>
<tr><td><code>dosescaled</code></td>
<td>
<p>The scaled doses obtained via backward substitution.</p>
</td></tr>
<tr><td><code>tox</code></td>
<td>
<p>Patients' toxicity indications.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Dose levels assigned to patients.</p>
</td></tr>
</table>


<h3>References</h3>

<p>O'Quigley, J. O., Pepe, M., and Fisher, L. (1990).  Continual
reassessment method: A practical design for phase I clinical trials in
cancer.  Biometrics 46:33-48.
</p>
<p>Cheung, Y. K. (2011).  Dose Finding by the Continual Reassessment Method.  New York: Chapman &amp; Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create a simple data set
prior &lt;- c(0.05, 0.10, 0.20, 0.35, 0.50, 0.70)
target &lt;- 0.2
level &lt;- c(3, 4, 4, 3, 3, 4, 3, 2, 2, 2)
y &lt;- c(0, 0, 1, 0, 0, 1, 1, 0, 0, 0)
foo &lt;- crm(prior, target, y, level)
ptox &lt;- foo$ptox  # updated estimates of toxicity rates

</code></pre>

<hr>
<h2 id='crmsens'>Model Sensitivity in the CRM</h2><span id='topic+crmsens'></span><span id='topic+print.dxcrm'></span>

<h3>Description</h3>

<p>Evaluate the model sensitivity in the CRM by indifference intervals.</p>


<h3>Usage</h3>

<pre><code class='language-R'>crmsens(prior, target, model = "empiric", intcpt = 3, eps = 1e-06, 
    maxit = 100, detail = FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crmsens_+3A_prior">prior</code></td>
<td>
<p>A vector of initial guesses of toxicity probabilities
associated the doses.</p>
</td></tr>
<tr><td><code id="crmsens_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="crmsens_+3A_model">model</code></td>
<td>
<p>A character string to specify the working model used in
the method.  The default model is &ldquo;empiric&rdquo;.  A one-parameter
logistic model is specified by &ldquo;logistic&rdquo;.</p>
</td></tr>
<tr><td><code id="crmsens_+3A_intcpt">intcpt</code></td>
<td>
<p>The intercept of the working logistic model.  The
default is 3.  If <code>model</code>=&ldquo;empiric&rdquo;, this argument will be
ignored.</p>
</td></tr>
<tr><td><code id="crmsens_+3A_eps">eps</code></td>
<td>
<p>Error tolerance in the computation of indifference
intervals.</p>
</td></tr>
<tr><td><code id="crmsens_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations in the computation of
indifference intervals.</p>
</td></tr>
<tr><td><code id="crmsens_+3A_detail">detail</code></td>
<td>
<p>If TRUE, the details of the &ldquo;H sets&rdquo; will be
displayed.  Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>crmsens</code> returns the model sensitivity for the
model specifications given by the user.
</p>
<table>
<tr><td><code>Hset</code></td>
<td>
<p>The &ldquo;H sets&rdquo; of the model parameter.</p>
</td></tr>
<tr><td><code>iint</code></td>
<td>
<p>The indifference intervals of the dose-toxicity model
associated with the test doses.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cheung, Y. K. and Chappell, R. (2002). A simple technique to evaluate
model sensitivity in the continual reassessment method.  Biometrics
58:671-674.
</p>
<p>Cheung, Y. K. (2011).  Dose Finding by the Continual Reassessment Method.  New York: Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crm">crm</a></code>, <code><a href="#topic+getprior">getprior</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior &lt;- c(0.05, 0.10, 0.20, 0.35, 0.50, 0.70)
target &lt;- 0.2
foo &lt;- crmsens(prior, target, model="logistic", intcpt=2, detail=TRUE)
</code></pre>

<hr>
<h2 id='crmsim'>CRM Simulator</h2><span id='topic+crmsim'></span><span id='topic+onetrial'></span><span id='topic+mtrials'></span><span id='topic+plot.sim'></span><span id='topic+print.sim'></span>

<h3>Description</h3>

<p><code>crmsim</code> is used to generate simulation replicates of phase I
trial using the (group) CRM under a specified dose-toxicity
configuration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crmsim(PI, prior, target, n, x0, nsim = 1, mcohort = 1, restrict = TRUE, 
    count = TRUE, method = "bayes", model = "empiric", intcpt = 3, 
    scale = sqrt(1.34), seed = 1009) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crmsim_+3A_pi">PI</code></td>
<td>
<p>A vector of the true toxicity probabilites associated with
the doses.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_prior">prior</code></td>
<td>
<p>A vector of initial guesses of toxicity probabilities
associated with the doses.  Must be of same length as <code>PI</code>.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_n">n</code></td>
<td>
<p>Sample size of the trial.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_x0">x0</code></td>
<td>
<p>The initial design.  For one-stage TITE-CRM, it is a
single numeric value indicating the starting dose.  For two-stage
TITE-CRM, it is a non-decreasing sequence of dose levels of length
<code>n</code>.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulations.  Default is set at 1.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_mcohort">mcohort</code></td>
<td>
<p>The number of patients enrolled before the next
model-based update.  Default is set at 1, i.e., a fully sequential
update.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_restrict">restrict</code></td>
<td>
<p>If TRUE, restrictions apply during the
trials to avoid (1) skipping doses in escalation and (2) escalation
immediately after a toxic outcome (i.e., incoherent escalation).  If
FALSE, dose assignments are purely model-based.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_count">count</code></td>
<td>
<p>If TRUE, the number of the current simulation replicate
will be displayed.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_method">method</code></td>
<td>
<p>A character string to specify the method for parameter
estimation.  The default method &ldquo;bayes&rdquo; estimates the model
parameter by the posterior mean.  Maximum likelihood estimation is
specified by &ldquo;mle&rdquo;.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_model">model</code></td>
<td>
<p>A character string to specify the working model used in
the method.  The default model is &ldquo;empiric&rdquo;.  A one-parameter
logistic model is specified by &ldquo;logistic&rdquo;.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_intcpt">intcpt</code></td>
<td>
<p>The intercept of the working logistic model.  The
default is 3.  If <code>model</code>=&ldquo;empiric&rdquo;, this argument will be
ignored.</p>
</td></tr>
<tr><td><code id="crmsim_+3A_scale">scale</code></td>
<td>
<p>Standard deviation of the normal prior of the model
parameter.  Default is sqrt(1.34).</p>
</td></tr>
<tr><td><code id="crmsim_+3A_seed">seed</code></td>
<td>
<p>Seed of the random number generator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;sim&rdquo; is returned, consisting of the operating
characteristics of the design specified.  The time component of the
design is suppressed for the CRM simulator.  All &ldquo;sim&rdquo; objects
generated by <code>crmsim</code> contain at least the following components:
</p>
<table>
<tr><td><code>PI</code></td>
<td>
<p>True toxicity rates.</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>
<p>Initial guesses of toxicity rates.</p>
</td></tr>
<tr><td><code>target</code></td>
<td>
<p>The target probability of toxicity at the MTD.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code>x0</code></td>
<td>
<p>The initial design.</p>
</td></tr>
<tr><td><code>MTD</code></td>
<td>
<p>Distribution of the MTD estimates.  If <code>nsim</code>=1, this
is a single numeric value of the recommended MTD of in simulated
trial.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Average number of patients treated at the test doses.  If
<code>nsim</code>=1, this is a vector of length <code>n</code> indicating the
doses assigned to the patients in the simulated trial.</p>
</td></tr>
<tr><td><code>tox</code></td>
<td>
<p>Average number of toxicities seen at the test doses.  If
<code>nsim</code>=1, this is a vector of length <code>n</code> indicating the
toxicity outcomes of the patients in the simulated trial.</p>
</td></tr>
<tr><td><code>beta.hat</code></td>
<td>
<p>The estimates of the model parameter throughout the
simulated trial(s).  The dose assignment of the jth patient in each
trial corresponds to the jth element in each row.</p>
</td></tr>
<tr><td><code>final.est</code></td>
<td>
<p>The final estimates of the model parameter of the
simulated trials.</p>
</td></tr>
</table>


<h3>References</h3>

<p>O'Quigley, J. O., Pepe, M., and Fisher, L. (1990).  Continual
reassessment method: A practical design for phase I clinical trials in
cancer.  Biometrics 46:33-48.
</p>
<p>Cheung, Y. K. (2005). Coherence principles in dose-finding studies.
Biometrika 92:863-873.
</p>
<p>Cheung, Y. K. (2011).  Dose Finding by the Continual Reassessment Method.  New York: Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crm">crm</a></code>, <code><a href="#topic+titesim">titesim</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PI &lt;- c(0.10, 0.20, 0.40, 0.50, 0.60, 0.65)
prior &lt;- c(0.05, 0.10, 0.20, 0.35, 0.50, 0.70)
target &lt;- 0.2
x0 &lt;- c(rep(1,3), rep(2,3), rep(3,3), rep(4,3), rep(5,3), rep(6,9))

# Generate a single replicate of two-stage group CRM trial of group size 3
foo &lt;- crmsim(PI, prior, target, 24, x0, mcohort=3)
## Not run: plot(foo,ask=T)  # summarize trial graphically

# Generate 10 replicates of CRM trial with 24 subjects
foo10 &lt;- crmsim(PI, prior, target, 24, 3, nsim=10, mcohort=2)
foo10
</code></pre>

<hr>
<h2 id='getinit'>Calibrating an initial design</h2><span id='topic+getinit'></span>

<h3>Description</h3>

<p>Returns an initial design that is compatible with the specified CRM
setup when used in a two-stage design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getinit(prior, target, n, nK = round(n/3), method = "bayes", 
    model = "empiric", intcpt = 3, scale = sqrt(1.34), detail = FALSE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getinit_+3A_prior">prior</code></td>
<td>
<p>A vector of initial guesses of toxicity probabilities
associated the doses.</p>
</td></tr>
<tr><td><code id="getinit_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="getinit_+3A_n">n</code></td>
<td>
<p>The sample size of the trial.</p>
</td></tr>
<tr><td><code id="getinit_+3A_nk">nK</code></td>
<td>
<p>The minimum number of subjects required at the highest test
dose in case of no toxicity throughout the trial.</p>
</td></tr>
<tr><td><code id="getinit_+3A_method">method</code></td>
<td>
<p>A character string to specify the method for parameter
estimation.  The default method &ldquo;bayes&rdquo; estimates the model
parameter by the posterior mean.  Maximum likelihood estimation is
specified by &ldquo;mle&rdquo;.</p>
</td></tr>
<tr><td><code id="getinit_+3A_model">model</code></td>
<td>
<p>A character string to specify the working model used in
the method.  The default model is &ldquo;empiric&rdquo;.  A one-parameter
logistic model is specified by &ldquo;logistic&rdquo;.</p>
</td></tr>
<tr><td><code id="getinit_+3A_intcpt">intcpt</code></td>
<td>
<p>The intercept of the working logistic model.  The
default is 3.  If <code>model</code>=&ldquo;empiric&rdquo;, this argument will be
ignored.</p>
</td></tr>
<tr><td><code id="getinit_+3A_scale">scale</code></td>
<td>
<p>Standard deviation of the normal prior of the model
parameter.  Default is sqrt(1.34).</p>
</td></tr>
<tr><td><code id="getinit_+3A_detail">detail</code></td>
<td>
<p>If TRUE, intermediate designs will be displayed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An initial design will be incompatible to the CRM setup if the
escalation pace is too conservative, i.e. slow.  The algorithm in
<code>getinit</code> starts the search of a compatible design with an
aggressive initial design that starts a trial at the second highest
dose.  A more conservative design will be subsequently tested for
compatibility if the current design is compatible.  The sequence
returned may be viewed as a conservative compatible initial design.
</p>


<h3>Value</h3>

<p>A non-decreasing sequence of dose levels is returned.
</p>


<h3>References</h3>

<p>Cheung, Y. K. (2005). Coherence principles in dose-finding studies.
Biometrika 92:863-873.
</p>
<p>Cheung, Y. K. (2011).  Dose Finding by the Continual Reassessment Method.  New York: Chapman &amp; Hall/CRC Press.  
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cohere">cohere</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior &lt;- c(0.05, 0.10, 0.20, 0.35, 0.50, 0.70)
target &lt;- 0.2

# Seach stops because it requires at least 8 subjects at the highest dose
getinit(prior, target, 25, nK=8, method="mle", detail=TRUE)

# Search stops because an incompatible design is reached
getinit(prior, 0.3, 25, nK=8, method="mle", detail=TRUE)




</code></pre>

<hr>
<h2 id='getn'>Sample size calculator for CRM trials</h2><span id='topic+getn'></span><span id='topic+nopt'></span><span id='topic+print.crmsize'></span>

<h3>Description</h3>

<p>Sample size calculator for a one-stage Bayesian CRM (see Details for design specification).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getn(apcs, target, nlevel, psi, correction = TRUE, detail = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getn_+3A_apcs">apcs</code></td>
<td>
<p>The desired average probability of correction selection (PCS) under the logistic calibration set.</p>
</td></tr>
<tr><td><code id="getn_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="getn_+3A_nlevel">nlevel</code></td>
<td>
<p>The number of test doses.</p>
</td></tr>
<tr><td><code id="getn_+3A_psi">psi</code></td>
<td>
<p>Effect size, i.e., odds ratio of the logistic dose-toxicity curves.</p>
</td></tr>
<tr><td><code id="getn_+3A_correction">correction</code></td>
<td>
<p>Continuity correction is applied in the sample size calculation if TRUE (default).  Otherwise if FALSE.</p>
</td></tr>
<tr><td><code id="getn_+3A_detail">detail</code></td>
<td>
<p>Print only essential results for trial planning if FALSE (default).  Otherwise if TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample size calculation is based on empirical approximation for the CRM using the  power (or empiric)
dose-toxicity function, <code class="reqn">F(d, \beta) = d^{\exp(\beta)}</code>, where <code class="reqn">\beta</code> has a normal prior with
mean 0 and variance 1.34, and the starting dose is the median level.  
The &ldquo;skeleton&quot; is obtained by setting <code>halfwidth</code> at <code class="reqn">0.25 \times</code> <code>target</code>, 
and <code>nu</code> at the median level in the function <code>getprior</code>.
</p>
<p>The calculation is intended to serve as an initial sample size for the CRM calibration process
depicted in Figure 7.1 in Cheung (2011).
</p>


<h3>Value</h3>

<p>An object of class &ldquo;crmsize&quot;  is returned, consisting of the following components:
</p>
<table>
<tr><td><code>n</code></td>
<td>
<p>The calculated sample size.</p>
</td></tr>
<tr><td><code>astar</code></td>
<td>
<p>The desired average PCS.</p>
</td></tr>
<tr><td><code>target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code>nlevel</code></td>
<td>
<p>The number of test doses.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>Odds ratio.</p>
</td></tr>
<tr><td><code>bstar</code></td>
<td>
<p>An intermediate value used to calculate the sample size.  Shown only if <code>detail</code>=TRUE.</p>
</td></tr>
<tr><td><code>efficiency</code></td>
<td>
<p>Ratio of required sample sizes of the optimal benchmark and the CRM.  Shown only if <code>detail</code>=TRUE.</p>
</td></tr>
<tr><td><code>correction</code></td>
<td>
<p>Whether continuity correction is applied.  Shown only if <code>detail</code>=TRUE.</p>
</td></tr>
<tr><td><code>na</code></td>
<td>
<p>The CRM sample size before rounding up.</p>
</td></tr>
<tr><td><code>nb</code></td>
<td>
<p>The sample size lower bound before rounding up.</p>
</td></tr>
<tr><td><code>messages</code></td>
<td>
<p>String characters prompt warning messages and caveats regarding the sample size calculation.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cheung, Y. K. (2011).  Dose Finding by the Continual Reassessment Method.  New York: Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getprior">getprior</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>apcs &lt;- 0.6    
target &lt;- 0.25
nlevel &lt;- 5
psi &lt;- 1.8     

# Sample size calculation with continuity correction
obj = getn(apcs, target, nlevel, psi, correction=TRUE)
obj

N = obj$n
</code></pre>

<hr>
<h2 id='getprior'>Calibrating prior DLT rates</h2><span id='topic+getprior'></span>

<h3>Description</h3>

<p>Returns a vector of initial guesses of toxicity probabilities
associated the doses for a given model sensitivity (set of
indifference intervals).</p>


<h3>Usage</h3>

<pre><code class='language-R'>getprior(halfwidth, target, nu, nlevel, model = "empiric", intcpt = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getprior_+3A_halfwidth">halfwidth</code></td>
<td>
<p>The desired halfwidth of the indifference intervals.</p>
</td></tr>
<tr><td><code id="getprior_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="getprior_+3A_nu">nu</code></td>
<td>
<p>The prior guess of MTD.</p>
</td></tr>
<tr><td><code id="getprior_+3A_nlevel">nlevel</code></td>
<td>
<p>The number of test doses.</p>
</td></tr>
<tr><td><code id="getprior_+3A_model">model</code></td>
<td>
<p>A character string to specify the working model used in
the method.  The default model is &ldquo;empiric&rdquo;.  A one-parameter
logistic model is specified by &ldquo;logistic&rdquo;.</p>
</td></tr>
<tr><td><code id="getprior_+3A_intcpt">intcpt</code></td>
<td>
<p>The intercept of the working logistic model.  The
default is 3.  If <code>model</code>=&ldquo;empiric&rdquo;, this argument will be
ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>getprior</code> is an &ldquo;inverse&rdquo; function of <code>crmsens</code> which
gives the indifference intervals for a given set of initial guesses.
</p>


<h3>Value</h3>

<p>A vector of length <code>nlevel</code> is returned.
</p>


<h3>References</h3>

<p>Cheung, Y. K. and Chappell, R. (2002). A simple technique to evaluate
model sensitivity in the continual reassessment method.  Biometrics
58:671-674.
</p>
<p>Lee, S. M. and Cheung Y. K. (2009).  Model calibration in the continual reassessment method.  Clinical Trials 6, 227-238.
</p>
<p>Cheung, Y. K. (2011).  Dose Finding by the Continual Reassessment Method.  New York: Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crmsens">crmsens</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>target &lt;- 0.25
delta &lt;- 0.10
mtd0 &lt;- 3

# initial DLT rates with indifference intervals [0.15, 0.35].
prior &lt;- getprior(delta, target, mtd0, nlevel=6, model="logistic")
</code></pre>

<hr>
<h2 id='titecrm'>Executing the TITE-CRM</h2><span id='topic+titecrm'></span><span id='topic+crmht'></span><span id='topic+crmht2'></span><span id='topic+crmht2lgt'></span><span id='topic+crmhtlgt'></span>

<h3>Description</h3>

<p><code>titecrm</code> is used to compute a dose for the next patient in a
phase I trial according to the TITE-CRM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>titecrm(prior, target, tox, level, n = length(level), weights = NULL,
followup = NULL, entry = NULL, exit = NULL, obswin = NULL, 
scheme = "linear", conf.level = 0.9, dosename = NULL, include = 1:n, 
pid = 1:n, method = "bayes", model = "empiric", var.est = TRUE, 
scale = sqrt(1.34), intcpt = 3, model.detail = TRUE, patient.detail = TRUE, 
tite = TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="titecrm_+3A_prior">prior</code></td>
<td>
<p>A vector of initial guesses of toxicity probabilities
associated the doses.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_tox">tox</code></td>
<td>
<p>A vector of patient outcomes; 1 indicates a toxicity, 0
otherwise.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_level">level</code></td>
<td>
<p>A vector of dose levels assigned to patients.  The length
of <code>level</code> must be equal to that of <code>tox</code>.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_n">n</code></td>
<td>
<p>The number of patients enrolled.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_weights">weights</code></td>
<td>
<p>A vector of weights assigned to observations.  A
weight must be between 0 and 1.  If given, the arguments
<code>followup</code>, <code>entry</code>, <code>exit</code>, <code>obswin</code>,
and <code>scheme</code> will be ignored.
If not supplied, users must provide follow-up information via
the argument <code>followup</code> or <code>entry</code> and <code>exit</code>, as
well as the observation window <code>obswin</code>.  The length of
<code>weights</code> must be equal to that of <code>tox</code>.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_followup">followup</code></td>
<td>
<p>A vector of follow-up times of patients.  If given,
the arguments <code>entry</code> and <code>exit</code> will be ignored.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_entry">entry</code></td>
<td>
<p>A vector of entry times of the patients.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_exit">exit</code></td>
<td>
<p>A vector of exit times of the patients due to either
end of follow-up or toxicity.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_obswin">obswin</code></td>
<td>
<p>The observation window with respect to which the MTD is
defined.  If not supplied, users must provide <code>weights</code>.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_scheme">scheme</code></td>
<td>
<p>A character string to specify the method for assigning
weights.  Default is &ldquo;linear&rdquo;.  An adaptive weight function is
specified by &ldquo;adaptive&rdquo;.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level for the probability/confidence
interval of the returned dose-toxicity curve.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_dosename">dosename</code></td>
<td>
<p>A vector containing the names of the regimens/doses
used.  The length of <code>dosename</code> must be equal to that of
<code>prior</code>.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_include">include</code></td>
<td>
<p>A subset of patients included in the dose calculation.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_pid">pid</code></td>
<td>
<p>Patient ID provided in the study.  Its length must be equal
to that of <code>level</code>.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_method">method</code></td>
<td>
<p>A character string to specify the method for parameter
estimation.  The default method &ldquo;bayes&rdquo; estimates the model
parameter by the posterior mean.  Maximum likelihood estimation
is specified by &ldquo;mle&rdquo;.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_model">model</code></td>
<td>
<p>A character string to specify the working model used in
the method.  The default model is &ldquo;empiric&rdquo;.  A one-parameter
logistic model is specified by &ldquo;logistic&rdquo;.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_var.est">var.est</code></td>
<td>
<p>If TRUE, variance of the estimate of the model parameter and
probability/confidence interval for the dose-toxicity curve will be
computed.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_scale">scale</code></td>
<td>
<p>Standard deviation of the normal prior of the model
parameter.  Default is sqrt(1.34).</p>
</td></tr>
<tr><td><code id="titecrm_+3A_intcpt">intcpt</code></td>
<td>
<p>The intercept of the working logistic model.  The
default is 3.  If <code>model</code>=&ldquo;empiric&rdquo;, this argument will be
ignored.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_model.detail">model.detail</code></td>
<td>
<p>If FALSE, the model content of an &ldquo;mtd&rdquo; object
will not be displayed.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_patient.detail">patient.detail</code></td>
<td>
<p>If FALSE, patient summary of an &ldquo;mtd&rdquo; object
will not be displayed.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="titecrm_+3A_tite">tite</code></td>
<td>
<p>If FALSE, the time components in patient summary of an
&ldquo;mtd&rdquo; object will be omitted.  Default in TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The adaptive weighting scheme is given in Cheung and Chappell (2000)
given in the reference list.
</p>


<h3>Value</h3>

<p>An object of class &ldquo;mtd&rdquo; is returned, consisting of the summary
of dose assignments thus far and the recommendation of dose for the
next patient.
</p>
<table>
<tr><td><code>prior</code></td>
<td>
<p>Initial guesses of toxicity rates.</p>
</td></tr>
<tr><td><code>target</code></td>
<td>
<p>The target probability of toxicity at the MTD.</p>
</td></tr>
<tr><td><code>ptox</code></td>
<td>
<p>Updated estimates of toxicity rates.</p>
</td></tr>
<tr><td><code>ptoxL</code></td>
<td>
<p>Lower confidence/probability limits of toxicity rates.</p>
</td></tr>
<tr><td><code>ptoxU</code></td>
<td>
<p>Upper confidence/probability limits of toxicity rates.</p>
</td></tr>
<tr><td><code>mtd</code></td>
<td>
<p>The updated estimate of the MTD.</p>
</td></tr>
<tr><td><code>prior.var</code></td>
<td>
<p>The variance of the normal prior.</p>
</td></tr>
<tr><td><code>post.var</code></td>
<td>
<p>The posterior variance of the model parameter.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>Estimate of the model parameter.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method of estimation.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>The working model.</p>
</td></tr>
<tr><td><code>dosescaled</code></td>
<td>
<p>The scaled doses obtained via backward substitution.</p>
</td></tr>
<tr><td><code>tox</code></td>
<td>
<p>Patients' toxicity indications.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Dose levels assigned to patients.</p>
</td></tr>
<tr><td><code>followup</code></td>
<td>
<p>Follow-up times of patients.</p>
</td></tr>
<tr><td><code>obswin</code></td>
<td>
<p>Observation window with respect to which the MTD is defined.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>Weights assigned to patients.</p>
</td></tr>
<tr><td><code>entry</code></td>
<td>
<p>Entry times of patients.</p>
</td></tr>
<tr><td><code>exit</code></td>
<td>
<p>Exit times of patients.</p>
</td></tr>
<tr><td><code>scheme</code></td>
<td>
<p>Weighting scheme.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cheung, Y. K. and Chappell, R. (2000). Sequential designs for phase I
clinical trials with late-onset toxicities.  Biometrics 56:1177-1182.
</p>
<p>Cheung, Y. K. (2011).  Dose Finding by the Continual Reassessment Method.  New York: Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crm">crm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create a simple data set
prior &lt;- c(0.05, 0.10, 0.20, 0.35, 0.50, 0.70)
target &lt;- 0.2
level &lt;- c(3, 3, 3, 4, 4, 3, 2, 2, 2, 3)
y &lt;- c(0, 0, 1, 0, 1, 0, 0, 0, 0, 0)
u &lt;- c(178, 181, 168, 181, 24, 181, 179, 102, 42, 3)
tau &lt;- 180
foo &lt;- titecrm(prior, target, y, level, followup=u, obswin=tau)
rec &lt;- foo$mtd  # recommend a dose level for next patient

# An example with adaptive weight
foo2 &lt;- titecrm(prior, target, y, level, followup=u, obswin=tau, scheme="adaptive")
wts &lt;- foo2$weights

# The `weights' argument makes `followup' and `obswin' obsolete
foo3 &lt;- titecrm(prior, target, y, level, weights=wts, followup=u, obswin=tau)
## Not run: plot(foo3, ask=T)

## Patient time information via `entry' and `exit' arguments
# entry time (days since study begins)
entry &lt;- c(7, 29, 49, 76, 92, 133, 241, 303, 363, 402)
# exit time (days since study begins)
exit &lt;- c(185, 210, 217, 257, 116, 314, 420, 405, 405, 405)
foo4 &lt;- titecrm(prior, target, y, level, exit=exit, entry=entry, obswin=tau)
## Not run: plot(foo4, ask=T)

</code></pre>

<hr>
<h2 id='titesim'>TITE-CRM Simulator</h2><span id='topic+titesim'></span><span id='topic+onetite'></span><span id='topic+mtite'></span>

<h3>Description</h3>

<p><code>titesim</code> is used to generate simulation replicates of phase I
trial using the TITE-CRM under a specified dose-toxicity
configuration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>titesim(PI, prior, target, n, x0, nsim = 1, restrict = TRUE, obswin = 1,
tgrp = obswin, rate = 1, accrual = "fixed", surv = "uniform", scheme =
"linear", count = TRUE, method = "bayes", model = "empiric", intcpt = 3,
scale = sqrt(1.34), seed = 1009)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="titesim_+3A_pi">PI</code></td>
<td>
<p>A vector of the true toxicity probabilites associated with
the doses.</p>
</td></tr>
<tr><td><code id="titesim_+3A_prior">prior</code></td>
<td>
<p>A vector of initial guesses of toxicity probabilities
associated with the doses.  Must be of same length as <code>PI</code>.</p>
</td></tr>
<tr><td><code id="titesim_+3A_target">target</code></td>
<td>
<p>The target DLT rate.</p>
</td></tr>
<tr><td><code id="titesim_+3A_n">n</code></td>
<td>
<p>Sample size of the trial.</p>
</td></tr>
<tr><td><code id="titesim_+3A_x0">x0</code></td>
<td>
<p>The initial design.  For one-stage TITE-CRM, it is a
single numeric value indicating the starting dose.  For two-stage
TITE-CRM, it is a non-decreasing sequence of dose levels of length
<code>n</code>.</p>
</td></tr>
<tr><td><code id="titesim_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulations.  Default is set at 1.</p>
</td></tr>
<tr><td><code id="titesim_+3A_restrict">restrict</code></td>
<td>
<p>If TRUE, restrictions apply during the trials to avoid
(1) skipping doses in escalation and (2) escalation immediately
after a toxic outcome (i.e., incoherent escalation).  If FALSE, dose
assignments are purely model-based.</p>
</td></tr>
<tr><td><code id="titesim_+3A_obswin">obswin</code></td>
<td>
<p>The observation window with respect to which the MTD is
defined.</p>
</td></tr>
<tr><td><code id="titesim_+3A_tgrp">tgrp</code></td>
<td>
<p>The minimum waiting time between two dose cohorts at the
initial stage.  Default is set as <code>obswin</code>, i.e., complete
follow-up in all current patients is required before escalation to
the next dose group.  This argument is used only in two-stage TITE-CRM.</p>
</td></tr>
<tr><td><code id="titesim_+3A_rate">rate</code></td>
<td>
<p>Patient arrival rate: Expected number of arrivals per
observation window.  Example: obswin=6 and rate=3 means expecting 3
patients arrive in 6 time units.</p>
</td></tr>
<tr><td><code id="titesim_+3A_accrual">accrual</code></td>
<td>
<p>Patient accrual scheme.  Default is &ldquo;fixed&rdquo; whereby
inter-patient arrival is fixed.  Alternatively, use &ldquo;poisson&rdquo; to
simulate patient arrivals by the Poisson process.</p>
</td></tr>
<tr><td><code id="titesim_+3A_surv">surv</code></td>
<td>
<p>Distribution for time-to-toxicity.  Default is &ldquo;uniform&rdquo;
where toxicity, if occurs, occurs uniformly on the interval
[0,<code>obswin</code>].  Other survival distributions including exponential and
Weibull are to be made available.</p>
</td></tr>
<tr><td><code id="titesim_+3A_scheme">scheme</code></td>
<td>
<p>A character string to specify the method for assigning
weights.  Default is &ldquo;linear&rdquo;.  An adaptive weight is specified by
&ldquo;adaptive&rdquo;.</p>
</td></tr>
<tr><td><code id="titesim_+3A_count">count</code></td>
<td>
<p>If TRUE, the number of the current simulation replicate
will be displayed.</p>
</td></tr>
<tr><td><code id="titesim_+3A_method">method</code></td>
<td>
<p>A character string to specify the method for parameter
estimation.  The default method &ldquo;bayes&rdquo; estimates the model
parameter by the posterior mean.  Maximum likelihood estimation is
specified by &ldquo;mle&rdquo;.</p>
</td></tr>
<tr><td><code id="titesim_+3A_model">model</code></td>
<td>
<p>A character string to specify the working model used in
the method.  The default model is &ldquo;empiric&rdquo;.  A one-parameter
logistic model is specified by &ldquo;logistic&rdquo;.</p>
</td></tr>
<tr><td><code id="titesim_+3A_intcpt">intcpt</code></td>
<td>
<p>The intercept of the working logistic model.  The
default is 3.  If <code>model</code>=&ldquo;empiric&rdquo;, this argument will be
ignored.</p>
</td></tr>
<tr><td><code id="titesim_+3A_scale">scale</code></td>
<td>
<p>Standard deviation of the normal prior of the model
parameter.  Default is sqrt(1.34).</p>
</td></tr>
<tr><td><code id="titesim_+3A_seed">seed</code></td>
<td>
<p>Seed of the random number generator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &ldquo;sim&rdquo; is returned, consisting of the operating
characteristics of the design specified.
</p>
<p>For a &ldquo;sim&rdquo; object with <code>nsim</code>=1, the time component of
individual subjects in the simulated trial is available via the
values <code>arrival</code>, <code>toxicity.time</code>, and
<code>toxicity.study.time</code> which respectively contain patients'
arrival times, times-to-toxicity, and the times-to-toxicity per study time.
</p>
<p>For a &ldquo;sim&rdquo; object with <code>nsim</code>&gt;1, the time component of the
design is summarized via the value <code>Duration</code>, which is the
duration of the simulated trials, computed by adding the arrival time
of the last patient and <code>obswin</code>.
</p>
<p>All &ldquo;sim&rdquo; objects contain at least the following components:
</p>
<table>
<tr><td><code>PI</code></td>
<td>
<p>True toxicity rates.</p>
</td></tr>
<tr><td><code>prior</code></td>
<td>
<p>Initial guesses of toxicity rates.</p>
</td></tr>
<tr><td><code>target</code></td>
<td>
<p>The target probability of toxicity at the MTD.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code>x0</code></td>
<td>
<p>The initial design.</p>
</td></tr>
<tr><td><code>MTD</code></td>
<td>
<p>Distribution of the MTD estimates.  If <code>nsim</code>=1, this
is a single numeric value of the recommended MTD of in simulated
trial.</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>Average number of patients treated at the test doses.  If
<code>nsim</code>=1, this is a vector of length <code>n</code> indicating the
doses assigned to the patients in the simulated trial.</p>
</td></tr>
<tr><td><code>tox</code></td>
<td>
<p>Average number of toxicities seen at the test doses.  If
<code>nsim</code>=1, this is a vector of length <code>n</code> indicating the
toxicity outcomes of the patients in the simulated trial.</p>
</td></tr>
<tr><td><code>beta.hat</code></td>
<td>
<p>The estimates of the model parameter throughout the
simulated trial(s).  The dose assignment of the jth patient in each
trial corresponds to the jth element in each row.</p>
</td></tr>
<tr><td><code>final.est</code></td>
<td>
<p>The final estimates of the model parameter of the
simulated trials.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cheung, Y. K. and Chappell, R. (2000). Sequential designs for phase I
clinical trials with late-onset toxicities.  Biometrics 56:1177-1182.
</p>
<p>Cheung, Y. K. (2005). Coherence principles in dose-finding studies.
Biometrika 92:863-873.
</p>
<p>Cheung, Y. K. (2011).  Dose Finding by the Continual Reassessment Method.  New York: Chapman &amp; Hall/CRC Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crmsim">crmsim</a></code>, <code><a href="#topic+titecrm">titecrm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PI &lt;- c(0.10, 0.20, 0.40, 0.50, 0.60, 0.65)
prior &lt;- c(0.05, 0.10, 0.20, 0.35, 0.50, 0.70)
target &lt;- 0.2
x0 &lt;- c(rep(1,3), rep(2,3), rep(3,3), rep(4,3), rep(5,3), rep(6,9))

# Generate a single replicate of two-stage TITE-CRM trial of size 24
foo &lt;- titesim(PI, prior, target, 24, x0, obswin=6, rate=4, accrual="poisson")
## Not run: plot(foo, ask=T)  # summarize trial graphically

# Generate 10 replicates of TITE-CRM trial of size 24
foo10 &lt;- titesim(PI, prior, target, 24, 3, nsim=10, obswin=6, rate=4, accrual="poisson")

foo10
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
