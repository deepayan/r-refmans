<!DOCTYPE html><html><head><title>Help for package PHYLOGR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PHYLOGR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cancor.phylog'><p>Canonical Correlation Analysis from Simulated Data Sets</p></a></li>
<li><a href='#cor.origin'><p> Correlation Through the Origin</p></a></li>
<li><a href='#GarlandJanis.IC'><p> Independet contrasts for Garland \&amp; Janis data set</p></a></li>
<li><a href='#GarlandJanis.Original'><p> Garland \&amp; Janis's 1993 data on mammalian running speed and limb length</p></a></li>
<li><a href='#GarlandJanis.varcov'><p> Phylogenetic variance-covariance matrix for Garland \&amp; Janis (1993).</p></a></li>
<li><a href='#Helper.functions'><p> Helper functions</p></a></li>
<li><a href='#Lacertid.IC'><p>Independet contrasts for Bauwens and Diaz-Uriarte (1997) lacertid data set</p></a></li>
<li><a href='#Lacertid.Original'><p> Bauwens and Diaz-Uriarte (1997) lacertid data</p></a></li>
<li><a href='#Lacertid.varcov'><p> Variance-covariance matrix for lacertids from Bauwens and</p>
Diaz-uriarte (1997)</a></li>
<li><a href='#lm.phylog'><p>Linear Models from Simulated Data Sets</p></a></li>
<li><a href='#matrix.D'><p>Produce the Matrix D of Garland and Ives (2000) for GLS</p></a></li>
<li><a href='#phylog.gls.fit'><p>Phylogenetically-Based GLS Model Fitting</p></a></li>
<li><a href='#plot.phylog.cancor'><p> Plot a phylog.cancor object</p></a></li>
<li><a href='#plot.phylog.lm'><p> Plot a phylog.lm object</p></a></li>
<li><a href='#plot.phylog.prcomp'><p> Plot a phylog.prcomp object</p></a></li>
<li><a href='#prcomp.phylog'><p>Principal Components Analysis from Simulated Data Sets</p></a></li>
<li><a href='#print.summary.phylog'><p> Printing summaries of PHYLOGR statistical functions</p></a></li>
<li><a href='#read.inp.data'><p>Read Inp Data Files</p></a></li>
<li><a href='#read.pdi.data'><p>Read Pdi Data Files</p></a></li>
<li><a href='#read.phylip.data'><p>Read Phylip Infile Data Files</p></a></li>
<li><a href='#read.phylog.matrix'><p>Read a Phylogenetic Covariance Matrix</p></a></li>
<li><a href='#read.sim.data'><p>Read Sim Files From PDSIMUL</p></a></li>
<li><a href='#SimulExample'><p> A simulated data set</p></a></li>
<li><a href='#summary.phylog.cancor'><p> Summarize a phylog.cancor object</p></a></li>
<li><a href='#summary.phylog.lm'><p> Summarize a phylog.lm object</p></a></li>
<li><a href='#summary.phylog.prcomp'><p> Summarize a phylog.prcomp object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.11</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-04-14</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions for Phylogenetically Based Statistical Analyses</td>
</tr>
<tr>
<td>Author:</td>
<td>Ramon Diaz-Uriarte &lt;rdiaz@cnio.es&gt; and Theodore Garland, Jr
        &lt;theodore.garland@ucr.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ramon Diaz-Uriarte &lt;rdiaz02@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 1.8.1)</td>
</tr>
<tr>
<td>Description:</td>
<td>Manipulation and analysis of phylogenetically simulated
        data sets and phylogenetically based analyses using GLS.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://ligarto.org/rdiaz">http://ligarto.org/rdiaz</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-04-14 14:42:50.656 UTC; ramon</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-04-14 15:10:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='cancor.phylog'>Canonical Correlation Analysis from Simulated Data Sets</h2><span id='topic+cancor.phylog'></span>

<h3>Description</h3>

<p>Performs a canonical correlation analysis on two sets of simulated data
and returns the canonical correlations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cancor.phylog(data1, data2, max.num=0, exclude.tips=NULL,lapply.size=100,
              xcenter=TRUE, ycenter=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cancor.phylog_+3A_data1">data1</code></td>
<td>
<p>the columns from a data set returned from read.sim.data that you want to use as the first set in the canonical correlation analysis. The first column MUST be sim.counter and the second Tips.</p>
</td></tr>
<tr><td><code id="cancor.phylog_+3A_data2">data2</code></td>
<td>
<p> the columns from a data set returned from read.sim.data that you want to use as the second set in the canonical correlation analysis. The first column MUST be sim.counter and the second Tips.</p>
</td></tr>
<tr><td><code id="cancor.phylog_+3A_max.num">max.num</code></td>
<td>
<p> if different from 0, the maximum number of simulations to analyze. </p>
</td></tr>
<tr><td><code id="cancor.phylog_+3A_exclude.tips">exclude.tips</code></td>
<td>
<p> an optional vector giving the names of tips to exclude from the analyses.</p>
</td></tr>
<tr><td><code id="cancor.phylog_+3A_lapply.size">lapply.size</code></td>
<td>
<p>a tuning parameter that can affect the speed of calculations; see Details in phylog.lm.</p>
</td></tr>
<tr><td><code id="cancor.phylog_+3A_xcenter">xcenter</code></td>
<td>
<p> should the x columns be centered? defaults to yes; see cancor.</p>
</td></tr>
<tr><td><code id="cancor.phylog_+3A_ycenter">ycenter</code></td>
<td>
<p> should the y columns be centered? defaults to yes; see
cancor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> A list (of class phylog.cancor) with components
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the call to the function</p>
</td></tr>
<tr><td><code>CanonicalCorrelations</code></td>
<td>
<p>the canonical correlations.  The one with
sim.counter=0 corresponds to the original (&rdquo;real&rdquo;) data.</p>
</td></tr>
</table>


<h3>WARNING</h3>

<p>It is
necessary to be careful with the null hypothesis you are testing and
how the null data set &mdash;the simulations&mdash; are generated. For
instance, suppose you want to examine the canonical correlations
between sets x and y; you will probably want to generate x and y each
with the observed correlations within each set so that the
correlations within each set are maintained (but with no
correlations among sets). You probably do not want to generate each of
the x's as if they were independent of each other x, and ditto for y, since
that will destroy the correlations within each set; see some
discussion in Manly, 1997.</p>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

 
<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>
<p>Krzanowski, W. J. (1990) <em>Principles of multivariate analysis</em>
Oxford University Press.
</p>
<p>Manly,B. F. J. (1997) <em>Randomization, bootstraping, and Monte Carlo
methods in biology, 2nd ed.</em> Chapman &amp; Hall.
</p>
<p>Morrison, D. F. (1990) <em>Multivariate statistcal methods, 3rd ed.</em> McGraw-Hill.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.sim.data">read.sim.data</a></code>,  <code><a href="#topic+summary.phylog.cancor">summary.phylog.cancor</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SimulExample)
ex1.cancor &lt;- cancor.phylog(SimulExample[,c(1,2,3,4,5)],SimulExample[,c(1,2,6,7,8)])
ex1.cancor
summary(ex1.cancor)
plot(ex1.cancor)
</code></pre>

<hr>
<h2 id='cor.origin'> Correlation Through the Origin</h2><span id='topic+cor.origin'></span>

<h3>Description</h3>

<p>Return the correlation through the origin of two vectors. Generally
used for indepdendent contrasts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor.origin(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor.origin_+3A_x">x</code></td>
<td>
<p> A vector </p>
</td></tr>
<tr><td><code id="cor.origin_+3A_y">y</code></td>
<td>
<p> A vector (of same size as x) </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The correlation of x and y, from a model without intercept (i.e.,
forcing the line through the origin).
</p>


<h3>Note</h3>

<p> This is a very simple function, provided for convenience.  You
can obtain the p-value, if you wish, with the usual formula for the
t-statistic: <code>2*(1 - pt(sqrt(df) * abs(rho) / sqrt(1 - rho^2),
  df))</code> where rho is the correlation through the origin and df are the
appropriate degrees of freedom &mdash;generally N-1&mdash;; by using the
absolute value of the coefficient and finding 2 * the probability of
upper tail (1 - pt) this works for both positive and negative
correlation coefficients.  </p>


<h3>Author(s)</h3>

<p> R. Diaz-Uriarte and T. Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> x &lt;- rnorm(100)
 y &lt;- rnorm(100)
 rho &lt;- cor.origin(x,y)
 rho # the correlation
 2 * (1 - pt(sqrt(99) * abs(rho) / sqrt(1 - rho^2), 99))  # the p-value
 
</code></pre>

<hr>
<h2 id='GarlandJanis.IC'> Independet contrasts for Garland \&amp; Janis data set </h2><span id='topic+GarlandJanis.IC'></span>

<h3>Description</h3>

<p>Independent contrast for Garland \&amp; Janis (1993) data set; they are
based on the data in the file GarlandJanis.Original using the
phylogeny in Garland et al. (1993) &mdash; see GarlandJanis.varcov</p>


<h3>Format</h3>

<p> The data frame contains seven columns.
The first four columns are the (standardized) independent contrasts for the respective variables
&mdash;see detailed explanation in
<code><a href="#topic+GarlandJanis.Original">GarlandJanis.Original</a></code>. The rest of the columns are:
</p>

<dl>
<dt>branch.lengths</dt><dd><p>Standard Deviation of Contrast = square root of sum of corrected branch lengths.</p>
</dd> 
<dt>names.contr</dt><dd><p>the names of the contrasts, as the names of the two
nodes that form the contrast</p>
</dd>
<dt>clade.contr</dt><dd><p> A factor with levels <code>Carnivore</code>,
<code>Herbivore</code>, <code>root</code>, that indicates whether the contrast
is a contrast within the carnivore lineage, within the ungulates,
or the root contrast &mdash;between the carnivore and the ungulate clades.</p>
</dd></dl>



<h3>Source</h3>

<p>Garland, T. Jr., and Janis, C. M. (1993). Does metatarsal/femur ratio
predict maximal running speed in cursorial mammals? <em>J. zoology,
London</em>, <b>229</b>, 133&ndash;151.
</p>
<p>Garland, T. Jr., Dickerman, A. W., Janis, C. M., Jones, J. A. (1993)
Phylogenetic analysis of covariance by computer
simulation. <em>Systematic Biology</em>, <b>42</b>, 265&ndash;292.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+GarlandJanis.Original">GarlandJanis.Original</a></code>, <code><a href="#topic+GarlandJanis.varcov">GarlandJanis.varcov</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Multiple regression with independent contrasts
# excluding the polar bear - grizzly bear contrast
data(GarlandJanis.IC)
lm(running.speed ~ body.mass + hind.l.length - 1,
subset=names.contr!="Tm-Ur", data= GarlandJanis.IC)



## Not run: 
# This data set can be obtained from the original files as:

garland.janis.ic &lt;- cbind(read.table("49ms.fic")[,c(3,4)],
                          read.table("49hmt.fic")[,c(3,4)])

branch.lengths &lt;- read.table("49ms.fic")[,5]
garland.janis.ic &lt;- garland.janis.ic/branch.lengths
names(garland.janis.ic) &lt;- c("body.mass", "running.speed",
                             "hind.l.length", "mtf.ratio")
garland.janis.ic[garland.janis.ic$body.mass&lt;0,] &lt;-
        -1 * garland.janis.ic[ garland.janis.ic$body.mass&lt;0, ]
garland.janis.ic$branch.lengths &lt;- branch.lengths
garland.janis.ic$names.contr &lt;-
                       as.factor(read.table("49ms.fic")[,1])
garland.janis.ic$clade.contr &lt;-
    as.factor( c("root",rep("Carnivore",18), rep("Herbivore",29))) 

## End(Not run)


</code></pre>

<hr>
<h2 id='GarlandJanis.Original'> Garland \&amp; Janis's 1993 data on mammalian running speed and limb length </h2><span id='topic+GarlandJanis.Original'></span>

<h3>Description</h3>

<p>This data set was used by Garland \&amp; Janis in their analysis of
metatarsal/femur ration and running speed in cursorial mammals.  The
data refer to several ecomorphological characteristics for a set of 49
mammals (18 carnivores and 29 ungulates).  
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Tips</dt><dd><p> the code for each species</p>
</dd>
<dt>body.mass</dt><dd><p> log 10 of body mass in kilograms</p>
</dd>
<dt>running.speed</dt><dd><p> log 10 running or sprint speed in km/h</p>
</dd>
<dt>hind.l.length</dt><dd><p> log 10 hind limb length &mdash;sum of femur, tibia,
and metatarsal lengths&mdash;in cm</p>
</dd>
<dt>mtf.ratio</dt><dd><p>metatarsal/femur ratio</p>
</dd>
<dt>clade</dt><dd><p> a factor with levels <code>Carnivore</code> or <code>Herbivore</code></p>
</dd> 
</dl>



<h3>Source</h3>

<p>Garland, T. Jr., and Janis, C. M. (1993). Does metatarsal/femur ratio
predict maximal running speed in cursorial mammals? <em>J. Zoology,
London</em>, <b>229</b>, 133&ndash;151.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+GarlandJanis.IC">GarlandJanis.IC</a></code>, <code><a href="#topic+GarlandJanis.varcov">GarlandJanis.varcov</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## What do the data look like
head(GarlandJanis.Original)
head(GarlandJanis.varcov)

## An example of a GLS fit
fit.gls.GJ &lt;- with(GarlandJanis.Original, 
                   phylog.gls.fit(cbind(body.mass,hind.l.length),
                                  running.speed, GarlandJanis.varcov)
     )

summary(fit.gls.GJ) # summary of the gls model; same as with IC


## Not run: 
# This data set can be prepared from the original pdi files
# (in directory Examples) as:
GarlandJanis.Orig &lt;- read.pdi.data(c("49ms.pdi","49hmt.pdi"),
                   variable.names = c("body.mass", "running.speed",
                                      "hind.l.length","mtf.ratio")) 
Garland.Janis.Orig$clade &lt;- as.factor(c(rep("Carnivore",19),
				      rep("Herbivore",30)))
  
## End(Not run)




</code></pre>

<hr>
<h2 id='GarlandJanis.varcov'> Phylogenetic variance-covariance matrix for Garland \&amp; Janis (1993). </h2><span id='topic+GarlandJanis.varcov'></span>

<h3>Description</h3>

<p>Phylogenetic variance-covariance matrix for the species in Garland \&amp;
Janis (1993). Note that the phylogeny is not exactly the same as in
Garland \&amp; Janis (1993), but actually corresponds to the more recent
phylogeny in Garland et al. (1993).
</p>


<h3>Format</h3>

<p> A matrix with the phylogenetic distance between species; every
entry dij is the sum of branch segment lengths that species i and j share in common.</p>


<h3>Source</h3>

<p>Garland, T. Jr., and Janis, C. M. (1993). Does metatarsal/femur ratio
predict maximal running speed in cursorial mammals? <em>J. Zoology,
London</em>, <b>229</b>, 133&ndash;151.
</p>
<p>Garland, T. Jr., Dickerman, A. W., Janis, C. M., Jones, J. A. (1993)
Phylogenetic analysis of covariance by computer
simulation. <em>Systematic Biology</em>, <b>42</b>, 265&ndash;292.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+GarlandJanis.Original">GarlandJanis.Original</a></code>, <code><a href="#topic+GarlandJanis.IC">GarlandJanis.IC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## What do the data look like
head(GarlandJanis.Original)
head(GarlandJanis.varcov)

## An example of a GLS fit
fit.gls.GJ &lt;- with(GarlandJanis.Original, 
                   phylog.gls.fit(cbind(body.mass,hind.l.length),
                                  running.speed, GarlandJanis.varcov)
     )

summary(fit.gls.GJ) # summary of the gls model; same as with IC


## Not run: 
# This data set can be obtained from the original dsc file as:
  
    GarlandJanis.varcov &lt;- read.phylog.matrix("49ms.dsc")



## End(Not run)



</code></pre>

<hr>
<h2 id='Helper.functions'> Helper functions</h2><span id='topic+num.sim.tips'></span><span id='topic+number.of.simulations'></span><span id='topic+number.of.tips.inp'></span><span id='topic+number.of.tips.pdi'></span><span id='topic+number.of.tips.sim'></span><span id='topic+scan.inp.file'></span><span id='topic+scan.pdi.file'></span><span id='topic+scan.simulation.file'></span><span id='topic+tips.names.inp'></span><span id='topic+tips.names.pdi'></span>

<h3>Description</h3>

<p>Several helper functions used by the PHYLOGR main functions (i.e.,
these functions are called from other functions).
These are all one to three lines functions, which are used in lieu of
calls to read.table, scan, etc. They are of no immediate use for the
end user, but might be helpful for further programming.
</p>


<h3>Value</h3>

<p>Depends on the helper function; here is a summary:
</p>
<table>
<tr><td><code>num.sim.tips</code></td>
<td>
<p>number of tips and number of simulations of a simulated data set</p>
</td></tr>
<tr><td><code>number.of.simulations</code></td>
<td>
<p>the number of simulations of a simulated data set</p>
</td></tr>
<tr><td><code>number.of.tips.inp</code></td>
<td>
<p> number of tips in inp data file</p>
</td></tr>
<tr><td><code>number.of.tips.pdi</code></td>
<td>
<p>ditto for pdi</p>
</td></tr>
<tr><td><code>number.of.tips.sim</code></td>
<td>
<p> ditto for sim</p>
</td></tr>
<tr><td><code>scan.inp.file</code></td>
<td>
<p>the two columns with data from inp file</p>
</td></tr>
<tr><td><code>scan.pdi.file</code></td>
<td>
<p>ditto for pdi</p>
</td></tr>
<tr><td><code>scan.simulation.file</code></td>
<td>
<p>ditto for sim file</p>
</td></tr>
<tr><td><code>tips.names.inp</code></td>
<td>
<p>the names of tips from an inp file</p>
</td></tr>
<tr><td><code>tips.names.pdi</code></td>
<td>
<p>ditto for pdi</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

 
<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>

<hr>
<h2 id='Lacertid.IC'>Independet contrasts for Bauwens and Diaz-Uriarte (1997) lacertid data set </h2><span id='topic+Lacertid.IC'></span>

<h3>Description</h3>

<p>Independent contrast for Bauwens and Diaz-Uriarte (1997) data set; they are
based on the data in the file Lacertid.Original using the
phylogeny in Buwens and Diaz-Uriarte (1997), Tree A  &mdash; see <code><a href="#topic+Lacertid.varcov">Lacertid.varcov</a></code></p>


<h3>Format</h3>

<p> The data frame contains eight columns.
The first seven columns are the (standardized) independent contrasts for the respective variables
&mdash;see detailed explanation in  <code><a href="#topic+Lacertid.Original">Lacertid.Original</a></code>. The
final column is </p>

<dl>
<dt>contr</dt><dd><p>the names of the contrasts, as the names of the two
nodes that form the contrast</p>
</dd></dl>



<h3>Source</h3>

<p>Bauwens, D., and Diaz-Uriarte, R. (1997)
Covariation of life-history traits in lacertid lizards: a
comparative study. <em>The American Naturalist</em>, <b>149</b>, 91-11</p>


<h3>See Also</h3>

 <p><code><a href="#topic+Lacertid.varcov">Lacertid.varcov</a></code>, <code><a href="#topic+Lacertid.Original">Lacertid.Original</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Obtaining correlations through the origin;
# compare with Table 3 in Bauwens and Diaz-Uriarte (1997).

data(Lacertid.IC)
cor.lacert &lt;- matrix(nrow=7,ncol=7) 
for (i in 1:7) for (j in 1:7)
cor.lacert[i,j] &lt;- cor.origin(Lacertid.IC[[i]],Lacertid.IC[[j]])
cor.lacert




## Not run: 
# This data frame can be obtained from the fic data files as:
  
LacertidIC &lt;- cbind(read.table("ifsmi.fic")[,c(3,4)],
                    read.table("ihshw.fic")[,c(3,4)],
                    read.table("iclag.fic")[,c(3,4)],
                    read.table("icfxx.fic")[,3])
stand &lt;- read.table("ifsmi.fic")[,5]
LacertidIC &lt;- LacertidIC/stand
LacertidIC$contr &lt;- read.table("ifsmi.fic")[,1]
names(LacertidIC) &lt;- c("svl","svl.matur", "hatsvl", "hatweight",
                      "clutch.size", "age.mat","cl.freq","contr")

## End(Not run)



</code></pre>

<hr>
<h2 id='Lacertid.Original'> Bauwens and Diaz-Uriarte (1997) lacertid data </h2><span id='topic+Lacertid.Original'></span>

<h3>Description</h3>

<p>This is part of the data set used by Bauwens and Diaz-Uriarte (1997) in
their analysis of lacertid life histories.  The data include several
life history traits of 18 lacertid species.  
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>Tips</dt><dd><p> the code for each species</p>
</dd>
<dt>svl</dt><dd><p> log 10 of mean adult female Snout-to-Vent length in mm</p>
</dd>
<dt>svl.matur</dt><dd><p> log 10 of SVL when sexual maturity (females) is reached</p>
</dd>
<dt>hatsvl</dt><dd><p> log 10 of hatchling svl in mm</p>
</dd>
<dt>hatweight</dt><dd><p>log10 of hatchling mass in grams</p>
</dd>
<dt>clutch.size</dt><dd><p> log10 of clutch size</p>
</dd>
<dt>age.mat</dt><dd><p>log10 of age at maturity in months</p>
</dd>
<dt>cl.freq</dt><dd><p> log10 of clutch frequency &mdash;number of clutches per year</p>
</dd>
</dl>


<h3>Source</h3>

<p>Bauwens, D., and Diaz-Uriarte, R. (1997) Covariation of
life-history traits in lacertid lizards: a
comparative study. <em>The American Naturalist</em>, <b>149</b>, 91-11</p>


<h3>See Also</h3>

 <p><code><a href="#topic+Lacertid.varcov">Lacertid.varcov</a></code>, <code><a href="#topic+Lacertid.IC">Lacertid.IC</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># a GLS fit
data(Lacertid.varcov)
data(Lacertid.Original)
ex.gls.phylog &lt;-
phylog.gls.fit(Lacertid.Original$svl,Lacertid.Original$clutch.size,Lacertid.varcov)
ex.gls.phylog



## Not run: 
  # This data set can also be obtained from the pdi files
  # (see example in GarlandJanis.Original), or as:

LacertidSim &lt;- read.sim.data(c("ifsmi.sim","ihshw.sim","iclag.sim","icfxx.sim"),
                  pdi.files=c("ifsmi.pdi","ihshw.pdi","iclag.pdi", "icfxx.pdi"),
		  variable.names = c("svl","svl.matur","hatsvl","hatweight",
		                    "clutch.size", "age.mat","cl.freq", "xx"))

LacertidSim &lt;- LacertidSim[,-10]
LacertidOriginal &lt;- LacertidSim[LacertidSim$sim.counter==0,-1]
  
## End(Not run)



</code></pre>

<hr>
<h2 id='Lacertid.varcov'> Variance-covariance matrix for lacertids from Bauwens and
Diaz-uriarte (1997) </h2><span id='topic+Lacertid.varcov'></span>

<h3>Description</h3>

<p> Phylogenetic variance-covariance matrix for 18 species of
lacertids. It is based on Tree A of Bauwens and Diaz-Uriarte (1997).</p>


<h3>Format</h3>

<p>The <code>Lacertid.varcov</code> data frame has 18 rows and 18 columns,
corresponding to each one of the 18 lacertidspecies; the matrix is the
phylogenetic variance-covariance matrix between all 18 species; thus,
each entry dij is the the sum of branch segment lengths that species i and j share in common.
</p>


<h3>Source</h3>

<p>Bauwens, D., and Diaz-Uriarte, R. (1997) Covariation of
life-history traits in lacertid lizards: a
comparative study. <em>The American Naturalist</em>, <b>149</b>, 91-11</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SimulExample">SimulExample</a></code>, <code><a href="#topic+Lacertid.Original">Lacertid.Original</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># a GLS fit
data(Lacertid.varcov)
data(Lacertid.Original)
ex.gls.phylog &lt;-
phylog.gls.fit(Lacertid.Original$svl,Lacertid.Original$clutch.size,Lacertid.varcov)
ex.gls.phylog


## Not run: 
# This data can be obtained from the original dsc file as:
Lacertid.varcov &lt;- read.phylog.matrix("ifsmi.dsc")
  
## End(Not run)



</code></pre>

<hr>
<h2 id='lm.phylog'>Linear Models from Simulated Data Sets</h2><span id='topic+lm.phylog'></span>

<h3>Description</h3>

<p>Fit a linear model to the data from a read.sim.data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lm.phylog(formula, data, max.num=0, weights=NULL, exclude.tips=NULL,
          lapply.size=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lm.phylog_+3A_formula">formula</code></td>
<td>
<p> a formula with the same syntax as for any other linear
model in R (see help for lm: ?lm). </p>
</td></tr>
<tr><td><code id="lm.phylog_+3A_data">data</code></td>
<td>
<p>a data frame &mdash;with a particular structure&mdash; with the observations; it will often be the
name of a data frame created using read.sim.data. </p>
</td></tr>
<tr><td><code id="lm.phylog_+3A_max.num">max.num</code></td>
<td>
<p> if different from 0, maximum number of simulations to analyze</p>
</td></tr>
<tr><td><code id="lm.phylog_+3A_weights">weights</code></td>
<td>
<p> an optional vector of weights to perform weighted least squares; can be a
column from the data frame or a vector in the parent environment (of
same length as any column of data before the data is reduced, if
appropriate, with exclude.tips and max.num arguments).</p>
</td></tr>
<tr><td><code id="lm.phylog_+3A_exclude.tips">exclude.tips</code></td>
<td>
<p> an optional vector giving the names of tips to
exclude from the analyses.</p>
</td></tr>
<tr><td><code id="lm.phylog_+3A_lapply.size">lapply.size</code></td>
<td>
<p> a tuning parameter that can affect the speed of
calculations; see Details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses a loop over lapply calls (I got the idea from
Venables and Ripley (2000), &rdquo;S  programming&rdquo;). By changing the
lapply.size you can change the size of the block over which lapply is
used. Changes can make a difference in speed; for instance, in my
machine from about 1 sec per simulation for a set with 49 species to less than 0.5
sec. The default value worked well in my machine, but your mileage
will vary.
</p>


<h3>Value</h3>

<p>A list of class phylog.lm with components
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the function call.</p>
</td></tr>
<tr><td><code>Fits</code></td>
<td>
<p>a data frame with the fitted coefficients for that model; the coefficients
for the non-simulated (&rdquo;real&rdquo;) data correspond to sim.counter=0.</p>
</td></tr>
<tr><td><code>MarginalTests</code></td>
<td>
<p>a data frame with the F-tests.  The first column is the overall F-test for
the model, the rest are the marginal F-tests, respecting the
marginality principle or hierarchy of terms included.  The
coefficients for the non-simulated (&rdquo;real&rdquo;) data correspond to sim.counter=0.</p>
</td></tr>
</table>


<h3>Note</h3>

<p> The marginal F-tests returned are obtained from drop1, and thus
respect the marginality principle.  For instance,
if your model is y <code class="reqn">\sim</code>  x1 + x2*x3 you will see an F for x1 and an F
for x2:x3 but no F's for x2 or x3.  Discussion can be found,
for example, in Venables &amp; Ripley, (1999), ch. 6; see also Searle,
(1987), ch. 6, for the ANCOVA case.
</p>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>
<p>Searle, S. R. (1987) <em>Linear models for unbalanced data.</em> Wiley
</p>
<p>Venables, W. N. and Ripley, B. D. (1999) <em>Modern applied
statistics with S-Plus, 3rd ed.</em> Springer-Verlag.
</p>
<p>Venables, W. N. and Ripley, B. D. (2000) <em>S programming.</em> Springer-Verlag.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.phylog.lm">summary.phylog.lm</a></code>, <code><a href="#topic+plot.phylog.lm">plot.phylog.lm</a></code>,<code><a href="#topic+read.sim.data">read.sim.data</a></code>, <code><a href="stats.html#topic+drop1">drop1</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SimulExample)
ex1.lm &lt;- lm.phylog(y ~ x1+diet, weights=x2, max.num=20,
                    exclude.tips=c("La","Ls"), data=SimulExample)
ex1.lm
summary(ex1.lm)
par(mfrow=c(2,2))
plot(ex1.lm)


</code></pre>

<hr>
<h2 id='matrix.D'>Produce the Matrix D of Garland and Ives (2000) for GLS</h2><span id='topic+matrix.D'></span>

<h3>Description</h3>

<p>Produces the matrix D in Garland and Ives, 2000, p. 361, for further use
in GLS procedures. You will rarely need to call this function
directly. It is called by phylog.gls.fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrix.D(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrix.D_+3A_x">x</code></td>
<td>
<p> a phylogenetic variance-covariance matrix, such as a matrix returned
from a call to read.phylog.matrix. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A variance-covariance matrix.</p>


<h3>Note</h3>

<p> The file read is a dsc file generated from PDDIST under option 5
with the additional options : - in matrix form; - with header; - with
scaled values. </p>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>
<p>Garland, T. Jr. and Ives, A. R. (2000) Using the past to predict the
present: confidence intervals for regression equations in phylogenetic
comparative methods. <em>The American Naturalist</em>, 155, 346-364.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.phylog.matrix">read.phylog.matrix</a></code>, <code><a href="#topic+phylog.gls.fit">phylog.gls.fit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>#perform GLS using lm function after transforming the variables
data(Lacertid.varcov)
mD &lt;- matrix.D(Lacertid.varcov)
data(Lacertid.Original)
# obtain transformed variables
Z &lt;- mD %*% Lacertid.Original$clutch.size
U &lt;- mD %*% cbind(rep(1,18),Lacertid.Original$svl) # intercept included
lm1 &lt;- lm(Z ~ U - 1) # eliminate intercept, since already included in U matrix
summary(lm1)
</code></pre>

<hr>
<h2 id='phylog.gls.fit'>Phylogenetically-Based GLS Model Fitting </h2><span id='topic+phylog.gls.fit'></span>

<h3>Description</h3>

<p>Fits a GLS linear model, as in Garland and Ives (2000), using a
phylogenetic variance-covariance function</p>


<h3>Usage</h3>

<pre><code class='language-R'>phylog.gls.fit(x, y, cov.matrix, intercept = TRUE, exclude.tips = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phylog.gls.fit_+3A_x">x</code></td>
<td>
<p>The predictor or &rdquo;X&rdquo; variables; they must be numeric
variables. If you are using a factor, you must recode it numerically,
with the appropriate type of contrasts &mdash;see function contrasts and
Venables &amp; Ripley (1999) ch. 6</p>
</td></tr>
<tr><td><code id="phylog.gls.fit_+3A_y">y</code></td>
<td>
<p> The response</p>
</td></tr>
<tr><td><code id="phylog.gls.fit_+3A_cov.matrix">cov.matrix</code></td>
<td>
<p> The phylogenetic variance-covariance matrix, which
can be obtained from read.phylog.matrix.</p>
</td></tr>
<tr><td><code id="phylog.gls.fit_+3A_intercept">intercept</code></td>
<td>
<p> Include an intercept in the model? Defaults to TRUE </p>
</td></tr>
<tr><td><code id="phylog.gls.fit_+3A_exclude.tips">exclude.tips</code></td>
<td>
<p> The tips to be excluded from the
analyses. Defaults to NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a fitted linear model</p>


<h3>WARNING</h3>

<p>This is one possible implementation of GLS that uses
the transformation of the Y and X as explained in Garland and Ives (2000). Ideally, we
would directly call gls from the NLME package, passing it the var-cov
matrix, but there are some printing problems of the fitted object in the R implementation when we use a
fixed correation structure. The advantage
of using gls from NLME is that the function is called using the
typical syntax for linear models, and we do not need to worry about making
categorical factors into numerical variables. Once the problem with
NLME is solved I'll add functions to incorporate GLS into the analysis
of data sets.
</p>
<p>In the meantime, when using this function, you should be aware
that:
</p>
<p>1) the overall F-test reported is wrong (it is like comparing to a
model without an intercept);
</p>
<p>2) you can apply the usual plot(fitted.model) to see diagnostic plots,
or other diagnostic functions such as lm.influence,
influence.measures, etc.  But most of these will be wrong and meaningless.</p>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>
<p>Garland, T. Jr. and Ives, A. R. (2000) Using the past to predict the
present: confidence intervals for regression equations in phylogenetic
comparative methods. <em>The American Naturalist</em>, 155, 346-364.
</p>
<p>Venables, W. N. and Ripley, B. D. (1999) <em>Modern applied
statistics with S-Plus, 3rd ed.</em> Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.phylog.matrix">read.phylog.matrix</a></code>, <code><a href="#topic+matrix.D">matrix.D</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Lacertid.varcov)
data(Lacertid.Original)
ex.gls.phylog &lt;-
phylog.gls.fit(Lacertid.Original$svl,Lacertid.Original$clutch.size,Lacertid.varcov)
ex.gls.phylog
</code></pre>

<hr>
<h2 id='plot.phylog.cancor'> Plot a phylog.cancor object </h2><span id='topic+plot.phylog.cancor'></span>

<h3>Description</h3>

<p>Plots histogram of the canonical correlations for simulated data
as returned from a phylog.cancor object; with
vertical bars indicates the values from the original (&rdquo;real&rdquo;) data
(the one with sim.counter=0), and in parenthesis their
'correlation-wise' p-value (see summary.phylog.cancor).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylog.cancor'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.phylog.cancor_+3A_x">x</code></td>
<td>
<p> an object of class phylog.cancor returned from a previous call to
cancor.phylog. </p>
</td></tr>
<tr><td><code id="plot.phylog.cancor_+3A_...">...</code></td>
<td>
<p> other parameters to be passed to through to plotting
functions (currently not used). </p>
</td></tr>
</table>


<h3>WARNING</h3>

<p>These histograms are in the spirit of the 'correlation-wise'
p-values returned from summary.phylog.cancor; see Details for summary.phylog.cancor.</p>


<h3>Author(s)</h3>

<p> Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cancor.phylog">cancor.phylog</a></code>, <code><a href="#topic+summary.phylog.cancor">summary.phylog.cancor</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SimulExample)
ex1.cancor &lt;- cancor.phylog(SimulExample[,c(1,2,3,4,5)],SimulExample[,c(1,2,6,7,8)])
ex1.cancor
summary(ex1.cancor)
par(mfrow=c(1,3))
plot(ex1.cancor)
</code></pre>

<hr>
<h2 id='plot.phylog.lm'> Plot a phylog.lm object </h2><span id='topic+plot.phylog.lm'></span>

<h3>Description</h3>

<p>Plots histogram of the the fitted coefficients and F-tests for simulated data
as returned from a phylog.lm object; with
vertical bars indicates the values from the original (&rdquo;real&rdquo;) data
(the one with sim.counter=0). For F-values, the number in parenthesis
indicates the p-value (see summary.phylog.lm).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylog.lm'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.phylog.lm_+3A_x">x</code></td>
<td>
<p> an object of class phylog.lm returned from a previous call to
lm.phylog. </p>
</td></tr>
<tr><td><code id="plot.phylog.lm_+3A_...">...</code></td>
<td>
<p> other parameters to be passed to through to plotting
functions (currently not used). </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lm.phylog">lm.phylog</a></code>, <code><a href="#topic+summary.phylog.lm">summary.phylog.lm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SimulExample)
ex1.lm &lt;- lm.phylog(y ~ x1 + diet, weights=x2, max.num=20, data=SimulExample)
options(digits=5)
plot(ex1.lm)
</code></pre>

<hr>
<h2 id='plot.phylog.prcomp'> Plot a phylog.prcomp object </h2><span id='topic+plot.phylog.prcomp'></span>

<h3>Description</h3>

<p>Plots histogram of the eigenvalues for simulated data
as returned from a phylog.prcomp object; with
vertical bars indicates the values from the original (&rdquo;real&rdquo;) data
(the one with sim.counter=0).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylog.prcomp'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.phylog.prcomp_+3A_x">x</code></td>
<td>
<p> an object of class phylog.prcomp such as can be obtained
from a previous call to prcomp.phylog. </p>
</td></tr>
<tr><td><code id="plot.phylog.prcomp_+3A_...">...</code></td>
<td>
<p> other parameters to be passed to through to plotting
functions (currently not used). </p>
</td></tr>
</table>


<h3>WARNING</h3>

<p>These histograms are in the spirit of the 'naive'
p-values returned from summary.phylog.prcomp; see Details for summary.phylog.prcomp</p>


<h3>Author(s)</h3>

<p> Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+prcomp.phylog">prcomp.phylog</a></code>, <code><a href="#topic+summary.phylog.prcomp">summary.phylog.prcomp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(SimulExample)
ex1.prcomp &lt;- prcomp.phylog(SimulExample[,-11]) # 11th column is a factor
options(digits=5)
plot(ex1.prcomp)
</code></pre>

<hr>
<h2 id='prcomp.phylog'>Principal Components Analysis from Simulated Data Sets</h2><span id='topic+prcomp.phylog'></span>

<h3>Description</h3>

<p>Performs a principal component analyses on a set of simulated data and
return the eigenvalues.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylog'
prcomp(x, max.num=0, exclude.tips=NULL, lapply.size=100,
              center=TRUE, scale=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prcomp.phylog_+3A_x">x</code></td>
<td>
<p> the columns from a data set returned from read.sim.data
that you want to use in the PCA. The first column MUST be sim.counter
and the second Tips.</p>
</td></tr>
<tr><td><code id="prcomp.phylog_+3A_max.num">max.num</code></td>
<td>
<p> if different from 0, the maximum number of simulations
to analyze. </p>
</td></tr>
<tr><td><code id="prcomp.phylog_+3A_exclude.tips">exclude.tips</code></td>
<td>
<p> an optional vector giving the names of tips to
exclude from the analyses.</p>
</td></tr>
<tr><td><code id="prcomp.phylog_+3A_lapply.size">lapply.size</code></td>
<td>
<p> a tuning parameter that can affect the speed of
calculations; see Details in phylog.lm.</p>
</td></tr>
<tr><td><code id="prcomp.phylog_+3A_center">center</code></td>
<td>
<p> should the data be centered before analyses? defaults to
yes; see prcomp.</p>
</td></tr>
<tr><td><code id="prcomp.phylog_+3A_scale">scale</code></td>
<td>
<p> should the data be scaled before the analyses? defaults
to yes; see prcomp. </p>
</td></tr>
<tr><td><code id="prcomp.phylog_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> A list (of class phylog.prcomp) with components
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the call to the function</p>
</td></tr>
<tr><td><code>Eigenvalues</code></td>
<td>
<p>all the eigenvalues from the PCA.  The one with
sim.counter=0 corresponds to the original (&rdquo;real&rdquo;) data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>
<p>Krzanowski, W. J. (1990) <em>Principles of multivariate analysis</em>
Oxford University Press.
</p>
<p>Morrison, D. F. (1990) <em>Multivariate statistcal methods, 3rd ed.</em> McGraw-Hill.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.sim.data">read.sim.data</a></code>, <code><a href="#topic+summary.phylog.prcomp">summary.phylog.prcomp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SimulExample)
ex1.prcomp &lt;- prcomp.phylog(SimulExample[,-11]) # 11th col. is a factor
options(digits=5)
ex1.prcomp
summary(ex1.prcomp)
plot(ex1.prcomp)
</code></pre>

<hr>
<h2 id='print.summary.phylog'> Printing summaries of PHYLOGR statistical functions</h2><span id='topic+print.summary.phylog.lm'></span><span id='topic+print.summary.phylog.cancor'></span><span id='topic+print.summary.phylog.prcomp'></span>

<h3>Description</h3>

<p>These are specific 'methods' for print, that are used with objects of
classes summary.phylog.lm, summary.phylog.cancor, and
summary.phylog.prcomp, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.phylog.lm'
print(x, ...)
## S3 method for class 'summary.phylog.cancor'
print(x, ...)
## S3 method for class 'summary.phylog.prcomp'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.phylog_+3A_x">x</code></td>
<td>
<p>an object of the appropriate class.</p>
</td></tr>
<tr><td><code id="print.summary.phylog_+3A_...">...</code></td>
<td>
<p>further parameters to be passed (currently not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are called automagically whenever you type
'summary(object.name)' or you type the name of a summary object; these
functions simply provide nicer formated output.
</p>


<h3>Value</h3>

<p>See explanation of output in summary.phylog.lm, summary.phylog.cancor,
and summary.phylog.prcomp.
</p>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

 
<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+summary.phylog.lm">summary.phylog.lm</a></code>,
<code><a href="#topic+summary.phylog.prcomp">summary.phylog.prcomp</a></code>, <code><a href="#topic+summary.phylog.cancor">summary.phylog.cancor</a></code></p>

<hr>
<h2 id='read.inp.data'>Read Inp Data Files</h2><span id='topic+read.inp.data'></span>

<h3>Description</h3>

<p>Reads one or more inp data files, such as used by PDTREE, of
the PDAP program bundle, and
returns an R data frame. Allows to combine several inp files
and to change the name of variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.inp.data(input.inp.files, variable.names=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.inp.data_+3A_input.inp.files">input.inp.files</code></td>
<td>
<p>the name (with path if necessary), of
the inp file(s).</p>
</td></tr>
<tr><td><code id="read.inp.data_+3A_variable.names">variable.names</code></td>
<td>
<p>an optional vector with the new names for the variables. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (with class pdi.file and data frame) with first column
the names of tips and remaining columns the data columns from
the inp file(s).
</p>


<h3>Author(s)</h3>

<p> Diaz-Uriarte, R., and Garland, T., Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.pdi.data">read.pdi.data</a></code>, <code><a href="#topic+read.phylip.data">read.phylip.data</a></code>, <code><a href="#topic+read.sim.data">read.sim.data</a></code>,  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# This works under both Unix and Windows.
# First need to find out where the ''Examples'' directory is located.
path.to.example &lt;- paste(path.package(package="PHYLOGR"),"Examples/",sep="/") 



# a simple case
p49a &lt;- paste(path.to.example,"49lbr.inp",sep="")
data.49a &lt;- read.inp.data(p49a)
data.49a

# two files and rename columns
p49b &lt;- paste(path.to.example,"49hmt.inp",sep="")
data.49.2 &lt;- read.inp.data(c(p49a,p49b),variable.names=c("y","x1","x2","x3"))
data.49.2

# You could jump directly to the call to the function if you
# are willing to enter the path explicitly.
# For example in some Linux systems the following works
# read.inp.data("/usr/lib/R/library/PHYLOGR/Examples/49lbr.inp")
# In Windows, maybe do:
# read.inp.data("c:\\progra~1\\rw1001\\library\\PHYLOGR\\Examples\\49lbr.inp")


</code></pre>

<hr>
<h2 id='read.pdi.data'>Read Pdi Data Files</h2><span id='topic+read.pdi.data'></span>

<h3>Description</h3>

<p>Reads one or more pdi data files, such as used by PDTREE, of
the PDAP program bundle, and
returns an R data frame. Allows to combine several pdi files
and to change the name of variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.pdi.data(input.pdi.files, variable.names=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.pdi.data_+3A_input.pdi.files">input.pdi.files</code></td>
<td>
<p>the name(s), with path if necessary, of
the pdi file(s).</p>
</td></tr> 
<tr><td><code id="read.pdi.data_+3A_variable.names">variable.names</code></td>
<td>
<p>an optional vector with the new names for the variables. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (with class pdi.file and data frame) with first column
the names of tips and remaining columns the data columns from
the pdi file(s).
</p>


<h3>Author(s)</h3>

<p> Diaz-Uriarte, R., and Garland, T., Jr.</p>


<h3>References</h3>

<p> Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.inp.data">read.inp.data</a></code>, <code><a href="#topic+read.phylip.data">read.phylip.data</a></code>, <code><a href="#topic+read.sim.data">read.sim.data</a></code>,  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# This works under both Unix and Windows.
# First need to find out where the ''Examples'' directory is located.
path.to.example &lt;- paste(path.package(package="PHYLOGR"),"Examples/",sep="/") 



# a simple case
p49a &lt;- paste(path.to.example,"49lbr.pdi",sep="")
data.49a &lt;- read.pdi.data(p49a)
data.49a

# two files and rename columns
p49b &lt;- paste(path.to.example,"49hmt.pdi",sep="")
data.49.2 &lt;- read.pdi.data(c(p49a,p49b),variable.names=c("y","x1","x2","x3"))
data.49.2

# You could jump directly to the call to the function if you
# are willing to enter the path explicitly.
# For example in some Linux systems the following works
# read.pdi.data("/usr/lib/R/library/PHYLOGR/Examples/49lbr.pdi")
# In Windows, maybe do:
# read.pdi.data("c:\\progra~1\\rw1001\\library\\PHYLOGR\\Examples\\49lbr.pdi")

</code></pre>

<hr>
<h2 id='read.phylip.data'>Read Phylip Infile Data Files</h2><span id='topic+read.phylip.data'></span>

<h3>Description</h3>

<p>Reads one file with tip data, such as a PHYLIP infile, and
returns an R data frame. The files have to follow the PHYLIP
standard of having a first line with the number of species and traits.
There can be multiple traits, as allowed in PHYLIP. Data for a species
can extend over several lines, as for
PHYLIP's sequential data format for continuous traits. It is assumed
that all traits are cuantitative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.phylip.data(input.phylip.file, variable.names=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.phylip.data_+3A_input.phylip.file">input.phylip.file</code></td>
<td>
<p>the name, with path if necessary, of
the infile.</p>
</td></tr> 
<tr><td><code id="read.phylip.data_+3A_variable.names">variable.names</code></td>
<td>
<p>an optional vector with the new names for the variables. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame (with class phylip.file and data frame) with first column
the names of tips and remaining columns the data columns from
the phylip file.
</p>


<h3>Note</h3>

<p>The format of PHYLIP's infiles is not exactly the same as the TIP
files produced from PDTREE. First, PHYLIP's infiles can contain an
arbitrary number of traits, whereas PDTREE's TIP files only have
two. Second, PHYLIP's infiles have a first line with the number of tips
and the number of traits, separated by blanks. Third, the first field
or column of PHYLIP's infiles must be ten characters wide; if the tips
names are shorter, they must be padded with blanks (see PHYLIP's
documentation). This limitation does not apply to read.phylip.data,
but you might want to follow it if you plan to use PHYLIP.
</p>


<h3>Author(s)</h3>

<p> Diaz-Uriarte, R., and Garland, T., Jr.</p>


<h3>References</h3>

<p> Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.inp.data">read.inp.data</a></code>, <code><a href="#topic+read.pdi.data">read.pdi.data</a></code>,  <code><a href="#topic+read.sim.data">read.sim.data</a></code>,  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# This works under both Unix and Windows.
# First need to find out where the ''Examples'' directory is located.
path.to.example &lt;- paste(path.package(package="PHYLOGR"),"Examples/",sep="/") 



lacertid.data.name &lt;- paste(path.to.example,"LacertidData.PhylipInfile",sep="")
lacertid.data &lt;- read.phylip.data(lacertid.data.name,variable.names=c("svl", "svl.matur",
                                  "hatsvl", "hatweight", "clutch.size",
                                  "age.mat", "cl.freq", "xx"))
lacertid.data

# You could jump directly to the call to the function if you
# are willing to enter the path explicitly.
# For example in some Linux systems the following works
# read.phylip.data("/usr/lib/R/library/PHYLOGR/Examples/LacertidData.PhylipInfile")
# In Windows, maybe do:
# read.pdi.data("c:\\progra~1\\rw1001\\library\\PHYLOGR\\Examples\\LacertidData.PhylipInfile")

</code></pre>

<hr>
<h2 id='read.phylog.matrix'>Read a Phylogenetic Covariance Matrix</h2><span id='topic+read.phylog.matrix'></span>

<h3>Description</h3>

<p>Reads a dsc matrix file &mdash;returned from the PDDIST program&mdash; and
converts into an R matrix for subsequent use.</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.phylog.matrix(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.phylog.matrix_+3A_x">x</code></td>
<td>
<p>An ASCII data file such as the *.dsc file generated by the
PDDIST program</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a phylogenetic variance-covariance matrix that can be used in R
functions, such as for GLS models.</p>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>
<p>Garland, T. Jr. and Ives, A. R. (2000) Using the past to predict the
present: confidence intervals for regression equations in phylogenetic
comparative methods. <em>The American Naturalist</em>, 155, 346-364.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+matrix.D">matrix.D</a></code>,  <code><a href="#topic+phylog.gls.fit">phylog.gls.fit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># First need to find where the example data sets are
 path.to.example &lt;- paste(path.package(package="PHYLOGR"),"Examples/",sep="/") 



example.dsc.file &lt;- paste(path.to.example,"ifsmi.dsc",sep="") 
phylog.matrix1 &lt;- read.phylog.matrix(example.dsc.file)


# You could jump directly to the call to the function if you
# are willing to enter the path explicitly.
# For example in some Linux systems the following works
# read.phylog.matrix("/usr/lib/R/library/PHYLOGR/Examples/hb12n.dsc")
# In Windows, maybe do:
# read.phylog.matrix("c:\\progra~1\\rw1001\\library\\PHYLOGR\\Examples\\hb12n.dsc")




</code></pre>

<hr>
<h2 id='read.sim.data'>Read Sim Files From PDSIMUL</h2><span id='topic+read.sim.data'></span>

<h3>Description</h3>

<p>Reads ouput file(s) from PDSIMUL &mdash;simulation of phenotypic evolution
along a phylogeny&mdash; and converts into an R data frame.
Can add original data from  inp or pdi file(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.sim.data(sim.files, inp.files = NULL, pdi.files = NULL,
              phylip.file = NULL, variable.names = NULL,
              other.variables = NULL, max.num = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.sim.data_+3A_sim.files">sim.files</code></td>
<td>
<p> the sim file(s), with path if needed. </p>
</td></tr>
<tr><td><code id="read.sim.data_+3A_inp.files">inp.files</code></td>
<td>
<p> the inp file(s), with path if needed. Might have
already been processed by read.inp.data. If already read, enter name unquoted.</p>
</td></tr>
<tr><td><code id="read.sim.data_+3A_pdi.files">pdi.files</code></td>
<td>
<p> the pdi file(s), with path if needed. Might have
already been processed by read.pdi.data. If already read, enter name
unquoted. </p>
</td></tr>
<tr><td><code id="read.sim.data_+3A_phylip.file">phylip.file</code></td>
<td>
<p> the phylip.file, with path if needed. Might have
already been processed by read.phylip.data. If already read, enter
name unquoted. </p>
</td></tr>
<tr><td><code id="read.sim.data_+3A_variable.names">variable.names</code></td>
<td>
<p> a optional vector of variable names</p>
</td></tr>
<tr><td><code id="read.sim.data_+3A_other.variables">other.variables</code></td>
<td>
<p> an optional set of other variables that you want to add to the
data set. Can be a vector, a matrix, or a data frame. It must be the
same length as the number of tips in you sim file(s). </p>
</td></tr>
<tr><td><code id="read.sim.data_+3A_max.num">max.num</code></td>
<td>
<p> if different from 0, the number of simulations to process.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>You will almost always want to provide inp or pdi or phylip file(s) since this
is what will be used for the analyses of simulated data sets. The sim
and pdi (or inp or phylip) files should match one to one; for example, you might
have used f1.pdi to obtain f1.sim and f2.pdi to produce f2.sim. Then,
the order of files ought to be
</p>
<p>read.sim.data(c(&quot;f1.sim&quot;,&quot;f2.sim&quot;),pdi.files=c(&quot;f1.pdi&quot;,&quot;f2.pdi&quot;))
</p>
<p>or
</p>
<p>read.sim.data(c(&quot;f2.sim&quot;,&quot;f1.sim&quot;),pdi.files=c(&quot;f2.pdi&quot;,&quot;f1.pdi&quot;))
</p>
<p>but NOT
</p>
<p>read.sim.data(c(&quot;f1.sim&quot;,&quot;f2.sim&quot;),pdi.files=c(&quot;f2.pdi&quot;,&quot;f1.pdi&quot;))
</p>
<p>and NOT
</p>
<p>read.sim.data(c(&quot;f2.sim&quot;,&quot;f1.sim&quot;),pdi.files=c(&quot;f1.pdi&quot;,&quot;f2.pdi&quot;))
</p>
<p>since the last two will yield meaningless results.
</p>
<p>Remember  that the number of sim file(s) and pdi (or inp) files must match
(since that is the only way the number of columns will
match). 
</p>
<p>This does not apply to PHYLIP infiles, since a PHYLIP infile can
contain multiple columns.
</p>
<p>Inp and Pdi files can not (yet) be mixed in a single call. If you need
to, you should use read.inp.data and read.pdi.data, and change the
class of the output data frame.
</p>
<p>If you are entering inp files only, you don't need to provide the
argument name. If you are using pdi files you need to provide the
pdi.files=.
</p>


<h3>Value</h3>

<p>A data frame (of class simul.phylog and data.frame) where the first column is called sim.counter, for
simulation counter (with value 0 for the pdi, or inp, data set),
second column is called tips, and the rest are data columns (including, if given, the other.variables column).
</p>


<h3>Author(s)</h3>

<p> Ramon Diaz-Uriarte and Thodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.pdi.data">read.pdi.data</a></code>, <code><a href="#topic+read.inp.data">read.inp.data</a></code>, <code><a href="#topic+read.phylip.data">read.phylip.data</a></code>. There
are generic functions plot and summary.</p>


<h3>Examples</h3>

<pre><code class='language-R'># First we need to find where the Examples directory is.
# You could enter it directly (see read.pdi.data for an example).
 path.to.example &lt;- paste(path.package(package="PHYLOGR"),"Examples/",sep="/") 



# simple example
p49.i &lt;- paste(path.to.example,"49lbr.pdi",sep="") 
p49.s &lt;- paste(path.to.example,"49lbr.sim",sep="")
data.49.s &lt;- read.sim.data(p49.s, pdi.files=p49.i)
data.49.s

# several files, added variables, change column names,
# and limit number of cases

f491s &lt;- paste(path.to.example,"49lbr.sim",sep="")
f492s &lt;- paste(path.to.example,"49hmt.sim",sep="")
f493s &lt;- paste(path.to.example,"49ms.sim",sep="")

f491i &lt;- paste(path.to.example,"49lbr.pdi",sep="")
f492i &lt;- paste(path.to.example,"49hmt.pdi",sep="")
f493i &lt;- paste(path.to.example,"49ms.pdi",sep="")


data.hb &lt;-
      read.sim.data(c(f491s, f492s, f493s), pdi.files=c(f491i, f492i, f493i),
                    variable.names=c("x1","x2","x3","x4","x5","x6"),
                    other.variables=data.frame(
                                     mood=c(rep("good",15),
                                            rep("bad",15),
                                            rep("terrible",19)),
                                     color=c(rep("blue",20),
                                             rep("white",29))),
                     max.num=20)

data.hb
</code></pre>

<hr>
<h2 id='SimulExample'> A simulated data set </h2><span id='topic+SimulExample'></span>

<h3>Description</h3>

<p>A simulated data set; the phylogeny is based in Bauwens and Diaz-Uriarte
(1997), such as is included in the file ifsm.pdi (in the Examples
directory). But the data are all completely fictitious and have
nothing to do with lacertids (or, for that matter, with any other creatures).</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>sim.counter</dt><dd><p>the simulation counter</p>
</dd>
<dt>Tips</dt><dd><p> the name of tips; it matches those for the lacertid
examples but, again, is unrelated to those</p>
</dd>
<dt>y</dt><dd><p> one numeric variable</p>
</dd>
<dt>x1</dt><dd><p>another numeric variable</p>
</dd>
<dt>x2</dt><dd><p>ditto</p>
</dd>
<dt>x3</dt><dd><p>ditto</p>
</dd>
<dt>x4</dt><dd><p>ditto</p>
</dd>
<dt>x5</dt><dd><p>guess what? same thing</p>
</dd>
<dt>x6</dt><dd><p> again</p>
</dd>
<dt>x7</dt><dd><p> once more</p>
</dd>
<dt>diet</dt><dd><p>a factor with fictitious levels
<code>Carnivore</code> 
<code>Herbivore</code> 
<code>Ommnivore</code> 
</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bauwens, D., and Diaz-Uriarte, R. (1997) Covariation of
life-history 
traits in lacertid lizards: a
comparative study. <em>The American Naturalist</em>, <b>149</b>, 91-11</p>


<h3>Examples</h3>

<pre><code class='language-R'># a canonical correlation example
data(SimulExample)
ex1.cancor &lt;- cancor.phylog(SimulExample[,c(1,2,3,4,5)],SimulExample[,c(1,2,6,7,8)])
ex1.cancor
summary(ex1.cancor)
plot(ex1.cancor)
</code></pre>

<hr>
<h2 id='summary.phylog.cancor'> Summarize a phylog.cancor object</h2><span id='topic+summary.phylog.cancor'></span>

<h3>Description</h3>

<p>A 'method' for objects of class phylog.cancor. Shows the original
data, and provides p-values and quantiles of the canonical
correlations based on the simulated data. There is a print 'method'
for this summary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylog.cancor'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.phylog.cancor_+3A_object">object</code></td>
<td>
<p> an object of class phylog.cancor returned from a previous
call to cancor.phylog. </p>
</td></tr>
<tr><td><code id="summary.phylog.cancor_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods (currently
not used)</p>
</td></tr></table>
<p>.
</p>


<h3>Details</h3>

<p>To test the hypothesis that all population canonical correlations are
zero we use the likelihood-ratio statistic from Krzanowski (pp. 447
and ff.); this
statistic is computed for the original data set and for each of the
simulated data sets, and we obtain the p-value as  (number of simulated data sets
with LR statistic larger than original (&rdquo;real&rdquo;) data + 1) / (number of simulated
data sets + 1).  Note that a test of this same hypothesis using the
Union-Intersection approach is equivalent to the test we implement
below for the first canonical correlation.
</p>
<p>The p-values for the individual canonical correlations are calculated in two different ways. For the 'component-wise'
ones the p-value for a particular correlation is
(number of simulated data sets
with canonical correlation larger than original (&rdquo;real&rdquo;) data + 1) / (number of simulated
data sets + 1). With this approach, you can find that the p-value for,
say, the second canonical correlation is smaller than the first, which
is not sensible. It only makes sense to examine the second
canonical correlation if the first one is &rdquo;significant&rdquo;, etc. Thus,
when considering the significance of the second canonical correlation
we should account for the value of the first. In other words, there is only
support against the null hypothesis (of no singificant second
canonical correlation) if both the first and the second canonical
correlations from the observed data set are larger than most of the
simulated data sets. We can account for what happens with
the first canonical correlation by computing the p-value of the second
canonical correlation as the number of simulations in which the second
simulated canonical correlation is larger than the observed, or the
first simulated canonical correlation is larger than the observed one,
or both (so that the only cases that count agains the null are those
where both the first ans second canonical correlations are smaller
than the observed ones); these we call 'Multiple' p-values.
</p>


<h3>Value</h3>

<p> A list (of class summary.phylog,cancor) with elements
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the call to function cancor.phylog.</p>
</td></tr>
<tr><td><code>original.LR.statistic</code></td>
<td>
<p>the likelihood ratio statistic for the
test that all canonical correlations are zero</p>
</td></tr>
<tr><td><code>original.canonicalcorrelations</code></td>
<td>
<p>the canonical correlations
corresponding to the original (&rdquo;real&rdquo;) data set.</p>
</td></tr>
<tr><td><code>p.value.overall.test</code></td>
<td>
<p>the p-value for the test that all
canonical correlations are zero</p>
</td></tr>
<tr><td><code>p.value.corwise</code></td>
<td>
<p>the correlation-wise p-value &mdash;see Details</p>
</td></tr>
<tr><td><code>p.value.mult</code></td>
<td>
<p>the multiple correlations p-value; see Details</p>
</td></tr>
<tr><td><code>quant.canonicalcorrelations</code></td>
<td>
<p>the quantiles from the simulated
canonical correlations; linear interpolation is used. Note that
these quantiles are in the spirit of the  &rdquo;naive p.values&rdquo;.</p>
</td></tr>
<tr><td><code>num.simul</code></td>
<td>
<p>the number of simulations used in the analyses</p>
</td></tr>
</table>


<h3>WARNING</h3>

<p>It is
necessary to be careful with the null hypothesis you are testing and
how the null data set &mdash;the simulations&mdash; are generated. For
instance, suppose you want to examine the canonical correlations
between sets x and y; you will probably want to generate x and y each
with the observed correlations within each set so that the
correlations within each set are maintained (but with no
correlations among sets). You probably do not want to generate each of
the x's as if they were independent of each other x, and ditto for y, since
that will destroy the correlations within each set; see some
discussion in Manly, 1997.
</p>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>
<p>Krzanowski, W. J. (1990) <em>Principles of multivariate analysis</em>
Oxford University Press.
</p>
<p>Manly,B. F. J. (1997) <em>Randomization, bootstraping, and Monte Carlo
methods in biology, 2nd ed.</em> Chapman &amp; Hall.
</p>
<p>Morrison, D. F. (1990) <em>Multivariate statistcal methods, 3rd ed.</em> McGraw-Hill.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.sim.data">read.sim.data</a></code>,  <code><a href="#topic+summary.phylog.cancor">summary.phylog.cancor</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SimulExample)
ex1.cancor &lt;- cancor.phylog(SimulExample[,c(1,2,3,4,5,6)],SimulExample[,c(1,2,7,8)])
summary(ex1.cancor)

</code></pre>

<hr>
<h2 id='summary.phylog.lm'> Summarize a phylog.lm object</h2><span id='topic+summary.phylog.lm'></span>

<h3>Description</h3>

<p>A 'method' for objects of class phylog.lm. Summarizes the results of
the fitted linear models for the simulated (and original) data and
returns p-values. There is a print 'method' for this summary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylog.lm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.phylog.lm_+3A_object">object</code></td>
<td>
<p> an object of class phylog.lm returned from a previous call to
lm.phylog.</p>
</td></tr>
<tr><td><code id="summary.phylog.lm_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods
(currently not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The p-value is computed as the (number of simulated data sets
with F-value larger than original (&rdquo;real&rdquo;) data + 1) / (number of simulated
data sets + 1).
The quantiles are obtained with the function quantile, and thus linear interpolation is used.
</p>


<h3>Value</h3>

<p> A list (of class summary.phylog.lm) with components
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the call to lm.phylog</p>
</td></tr>
<tr><td><code>original.model</code></td>
<td>
<p>the model fitted to the original data.</p>
</td></tr>
<tr><td><code>original.Fvalue</code></td>
<td>
<p>the F-values from the original data.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-values for the marginal F-tests and overall F.</p>
</td></tr>
<tr><td><code>quant.F.value</code></td>
<td>
<p>the quantiles of the distribution of F-values
from the simulated data.</p>
</td></tr>
<tr><td><code>num.simul</code></td>
<td>
<p>the number of simulations used in the analyses</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lm.phylog">lm.phylog</a></code>, <code><a href="#topic+plot.phylog.lm">plot.phylog.lm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SimulExample)
ex1.lm &lt;- lm.phylog(y ~ x1 + diet, weights=x2, max.num=20, data=SimulExample)
summary(ex1.lm)
</code></pre>

<hr>
<h2 id='summary.phylog.prcomp'> Summarize a phylog.prcomp object</h2><span id='topic+summary.phylog.prcomp'></span>

<h3>Description</h3>

<p>A 'method' for objects of class phylog.prcomp. Shows the original
data, and provides p-values and quantiles of the eigenvalues
based on the simulated data. There is a print 'method'
for this summary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylog.prcomp'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.phylog.prcomp_+3A_object">object</code></td>
<td>
<p> an object of class phylog.prcomp such as one returned from a previous
call to prcomp.phylog. </p>
</td></tr>
<tr><td><code id="summary.phylog.prcomp_+3A_...">...</code></td>
<td>
<p> further arguments passed to or from other methods
(currently not used).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The p-values are calculated in two different ways. The 'component-wise' ones,
where the p-value for a particular eigenvalue is (number of simulated data sets
with eigenvalue larger than original (&rdquo;real&rdquo;) data + 1) / (number of simulated
data sets + 1). With this approach, you can find that the p-value for,
say, the second eigenvalue is smaller than the first, which
is not sensible. It only makes sense to examine the second
eigenvalue if the first one is &rdquo;significant&rdquo;, etc. Thus,
when considering the significance of the second eigenvalue
we should account for the value of the first. In other words, there is only
support against the null hypothesis (of no singificant second
component) if both the first and the second eigenvalue
from the observed data set are larger than most of the
simulated data sets. We can account for what happens with
the first eigenvalue by computing the p-value of the second
eigenvalue as the number of simulations in which the second
eigenvalue is larger than the observed, or the
first simulated eigenvalue is larger than the observed one,
or both (so that the only cases that count agains the null are those
where both the first and second simulated eigenvalues are smaller
than the observed ones). Therefore, with the second set of p-values,
the p-values are increasing.
</p>
<p>We also provide data for parallel anlysis as in Horn (1965; see also
Zwick &amp; Velicer 1986 and Lautenschlager 1989) where each eigenvalue
is compared to the average eigenvalue (for that factor) obtained from
a simulation.  These can then be used to construct scree plots showing
both the original and the simulated data.
</p>


<h3>Value</h3>

<p> A list (of class summary.phylog.prcomp) with elements
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the call to function prcomp.phylog.</p>
</td></tr>
<tr><td><code>original.eigenvalues</code></td>
<td>
<p>the eigenvalues
corresponding to the original (&rdquo;real&rdquo;) data set.</p>
</td></tr>
<tr><td><code>p.value.component</code></td>
<td>
<p>the component-wise p-value &mdash;see Details</p>
</td></tr>
<tr><td><code>p.value.multiple</code></td>
<td>
<p>the 'multiple-eigenvalue' p-value; see Details</p>
</td></tr>
<tr><td><code>quant.eigenvalue</code></td>
<td>
<p>the quantiles from the simulated
eigenvalues; linear interpolation is used. Note that
these quantiles are in the spirit of the  &rdquo;component-wise p.values&rdquo;.</p>
</td></tr>
<tr><td><code>num.simul</code></td>
<td>
<p>the number of simulations used in the analyses</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ramon Diaz-Uriarte and Theodore Garland, Jr.</p>


<h3>References</h3>

<p>Diaz-Uriarte, R., and Garland, T., Jr., in prep. PHYLOGR:
an R package for the analysis of comparative data via Monte Carlo
simulations and generalized least squares approaches.
</p>
<p>Horn, J. L. (1965) A rationale and test for the number of factors in
factor analysis. <em>Psychometrica</em>, 30, 179-185.
</p>
<p>Krzanowski, W. J. (1990) <em>Principles of multivariate analysis</em>
Oxford University Press.
</p>
<p>Lautenschlager, G. J. (1989). A comparison of alternatives to
conducting Monte Carlo analyses for determining parallel analysis
criteria. <em>Multivariate Behavioral Research</em>, 24, 365-395.
</p>
<p>Morrison, D. F. (1990) <em>Multivariate statistcal methods, 3rd ed.</em> McGraw-Hill.
</p>
<p>Zwick, W. R., and Velicer, W. F. (1986). Comparison of five rules for
determining the number of components to retain. <em>Psychological
Bulletin</em>, 99, 432-442. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+read.sim.data">read.sim.data</a></code>, <code><a href="#topic+prcomp.phylog">prcomp.phylog</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SimulExample)
ex1.prcomp &lt;- prcomp.phylog(SimulExample[,-11]) #the 11th column is a factor
summary(ex1.prcomp)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
