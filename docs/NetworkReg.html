<!DOCTYPE html><html lang="en"><head><title>Help for package NetworkReg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NetworkReg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#NetworkReg-package'>
<p>Generalized Linear Regression Models on Network-Linked Data with Statistical Inference</p></a></li>
<li><a href='#net.gen.from.P'><p>generates a network from the given connection probability</p></a></li>
<li><a href='#SP.Inf'><p>Fitting Generalized Linear Model on Network-Linked Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Linear Regression Models on Network-Linked Data with
Statistical Inference</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-10-10</td>
</tr>
<tr>
<td>Description:</td>
<td>Linear regression model and generalized linear models with nonparametric network effects on network-linked observations. The model is originally proposed by Le and Li (2022) &lt;<a href="https://doi.org/10.48550%2FarXiv.2007.00803">doi:10.48550/arXiv.2007.00803</a>&gt; and is assumed on observations that are connected by a network or similar relational data structure. A more recent work by Wang, Le and Li (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2410.01163">doi:10.48550/arXiv.2410.01163</a>&gt; further extends the framework to generalized linear models. All these models are implemented in the current package. The model does not assume that the relational data or network structure to be precisely observed; thus, the method is provably robust to a certain level of perturbation of the network structure. The package contains the estimation and inference function for the model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, randnet, RSpectra</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-18 00:31:33 UTC; User</td>
</tr>
<tr>
<td>Author:</td>
<td>Jianxiang Wang [aut, cre],
  Tianxi Li [aut],
  Can M. Le [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jianxiang Wang &lt;jw1881@scarletmail.rutgers.edu&gt;</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-01 08:00:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='NetworkReg-package'>
Generalized Linear Regression Models on Network-Linked Data with Statistical Inference
</h2><span id='topic+NetworkReg-package'></span>

<h3>Description</h3>

<p>Linear regression model with nonparametric network effects on network-linked observations. The model is proposed by Le and Li (2022) &lt;arXiv:2007.00803&gt; on observations that are connected by a network or similar relational data structure. The model does not assume that the relational data or network structure to be precisely observed; thus, the method is provably robust to a certain level of perturbation of the network structure. The package contains the estimation and inference function for the model.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> NetworkReg</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-10-10</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Jianxiang Wang, Can M. Le, and Tianxi Li.<br />
Maintainer: Jianxiang Wang &lt;jw1881@scarletmail.rutgers.edu&gt;
</p>


<h3>References</h3>

<p>Le, C. M., &amp; Li, T. (2022). Linear regression and its inference on noisy network-linked data. Journal of the Royal Statistical Society Series B: Statistical Methodology, 84(5), 1851-1885.
</p>
<p>Wang J, Le C M, Li T. Perturbation-Robust Predictive Modeling of Social Effects by Network Subspace Generalized Linear Models. arXiv preprint arXiv:2410.01163, 2024.
</p>

<hr>
<h2 id='net.gen.from.P'>generates a network from the given connection probability</h2><span id='topic+net.gen.from.P'></span>

<h3>Description</h3>

<p>Generates an adjacency matrix from a given probability matrix,
according independent Bernoulli &ndash; the so-called inhomogeneous
Erdos-Renyi model. It is used to generate new networks from a given model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>net.gen.from.P(P, mode = "undirected")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="net.gen.from.P_+3A_p">P</code></td>
<td>
<p>connection probability between nodes</p>
</td></tr>
<tr><td><code id="net.gen.from.P_+3A_mode">mode</code></td>
<td>
<p>&quot;undirected&quot; (default) if the network is undirected, so the
adjacency matrix will be symmetric with only upper diagonal entries
being generated as independent Bernoulli. Otherwise, the adjacency matrix gives independent Bernoulli everywhere.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An adjacency matrix
</p>

<hr>
<h2 id='SP.Inf'>Fitting Generalized Linear Model on Network-Linked Data</h2><span id='topic+SP.Inf'></span>

<h3>Description</h3>

<p>SP.Inf is used to the regression model on network-linked data by subspace project and produce the inference result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SP.Inf(X, Y, A, K, model = "linear", r = NULL, sigma2 = NULL, thr = NULL,
alpha.CI = 0.05, boot.thr = TRUE, boot.n = 50)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SP.Inf_+3A_x">X</code></td>
<td>
<p>the covariate matrix where each row is an observation and each column is a covariate. If an intercept is to be included in the model, the column of ones should be in the matrix.</p>
</td></tr>
<tr><td><code id="SP.Inf_+3A_y">Y</code></td>
<td>
<p>the column vector of response.</p>
</td></tr>
<tr><td><code id="SP.Inf_+3A_a">A</code></td>
<td>
<p>the network information. The most natural choice is the adjacency matrix of the network. However, if the network is assumed to be noisy and a better estimate of the structural connection strength, it can also be used. This corresponds to the Phat matrix in the original paper. A Laplacian matrix can also be used, but it should be flipped. See 'Details'.</p>
</td></tr>
<tr><td><code id="SP.Inf_+3A_k">K</code></td>
<td>
<p>the dimension of the network eigenspace for network effect.</p>
</td></tr>
<tr><td><code id="SP.Inf_+3A_model">model</code></td>
<td>
<p>the type of Generalized Linear Regression. The &quot;linear&quot; ,&quot;logistic&quot; and &quot;poisson&quot; represents linear regression, logistic regression and poisson regression. The default is linear regression.</p>
</td></tr>
<tr><td><code id="SP.Inf_+3A_r">r</code></td>
<td>
<p>the covariate-network cofounding space dimension. This is typically unknown and can be unspecified by using the default value 'NULL'. If so, the user should provide a threshold or resort to a tuning procedure by either the theoretical rule or a bootstrapping method, as described in the paper.</p>
</td></tr>
<tr><td><code id="SP.Inf_+3A_sigma2">sigma2</code></td>
<td>
<p>the variance of random noise for linear regression. Typically unknown.</p>
</td></tr>
<tr><td><code id="SP.Inf_+3A_thr">thr</code></td>
<td>
<p>threshold for r estimation. If r is unspecified, we will use the thereshold to select r. If this is also 'NULL', aa theoretical threshold or a bootsrapping method can be evoked to estimate it.</p>
</td></tr>
<tr><td><code id="SP.Inf_+3A_alpha.ci">alpha.CI</code></td>
<td>
<p>the 1-alpha.CI confidence level will be produced for the parameters.</p>
</td></tr>
<tr><td><code id="SP.Inf_+3A_boot.thr">boot.thr</code></td>
<td>
<p>logical. Only effective if both r and thr are NULLs. If FALSE, the theoretical threshold will be used to select r. Otherwise, the bootstrapping procedure will be used to find the threshold.</p>
</td></tr>
<tr><td><code id="SP.Inf_+3A_boot.n">boot.n</code></td>
<td>
<p>the number of bootstrapping samples used when boot.thr is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model fitting procedure is following the paper exactly, so please check the procedure and theory in the paper. If the Laplacian matrix L=D-A is the network quantity to use, notice that typically we treat the smallest values and their corresponding eigenvectors as network cohesive space. Therefore, one should consider flip the Laplacian matrix by using cI - L as the value for A, where c is sufficiently large to ensure PSD of cI-L.
</p>


<h3>Value</h3>

<p>A list object with
</p>
<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>estimate of beta, the covariate effects</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>individual effects</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>coefficients of confounding effects with respect to the covariates</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>confounding dimension</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>estimated random noise variance for linear regression</p>
</td></tr>
<tr><td><code>cov.hat</code></td>
<td>
<p>covariance matrix of beta</p>
</td></tr>
<tr><td><code>coef.mat</code></td>
<td>
<p>beta and the confidence intervals according to alpha.CI and the p-values of the significance test</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>fitted value of response</p>
</td></tr>
<tr><td><code>chisq.val</code></td>
<td>
<p>the value of the chi-square statistic for the significance test for network effect</p>
</td></tr>
<tr><td><code>chisq.p</code></td>
<td>
<p>the p-value of the significance test for network effect</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jianxiang Wang, Can M. Le, and Tianxi Li.
Maintainer: Jianxiang Wang &lt;jw1881@scarletmail.rutgers.edu&gt;
</p>


<h3>References</h3>

<p>Le, C. M., &amp; Li, T. (2022). Linear regression and its inference on noisy network-linked data. Journal of the Royal Statistical Society Series B: Statistical Methodology, 84(5), 1851-1885.
</p>
<p>Wang J, Le C M, Li T. Perturbation-Robust Predictive Modeling of Social Effects by Network Subspace Generalized Linear Models. arXiv preprint arXiv:2410.01163, 2024.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
library(randnet)
library(RSpectra)
### Example data generation procedure from Section 5.3 of the paper with logistic regression
n &lt;- 1000
big.model &lt;- BlockModel.Gen(lambda=n^(2/3), n=n, beta=0.2, K=4)
P &lt;- big.model$P
big.X &lt;- cbind(rnorm(n), runif(n), rexp(n))
eigen.P &lt;- eigs_sym(A=P, k=4)
X.true &lt;- big.X
X.true &lt;- scale(X.true, center=TRUE, scale=TRUE) * sqrt(n/(n-1))
beta &lt;- matrix(c(1,1,1), ncol=1)
Xbeta &lt;- X.true %*% beta
U &lt;- eigen.P$vectors[,1:4]
alpha.coef &lt;- matrix(sqrt(n) * c(1, 1, 1, 1), ncol=1)
alpha &lt;- U %*% alpha.coef
EY &lt;- (1 + exp(-Xbeta - alpha))^(-1)
## Model fitting
A &lt;- net.gen.from.P(P)
Y &lt;- rbinom(n, 1, EY)
fit &lt;- SP.Inf(X.true, Y, A, K=4, model=c("logistic"), alpha=0.05, boot.thr=FALSE)
fit$coef.mat

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
