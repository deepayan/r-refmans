<!DOCTYPE html><html><head><title>Help for package stochprofML</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stochprofML}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#analyze.sod2'>
<p>Analysis of SOD2 data in stochastic profiling model</p></a></li>
<li><a href='#analyze.toycluster'>
<p>Analysis of toyclusters in stochastic profiling model</p></a></li>
<li><a href='#calculate.ci.EXPLN'>
<p>Maximum likelihood confidence intervals for EXP-LN model</p></a></li>
<li><a href='#calculate.ci.LNLN'>
<p>Maximum likelihood confidence intervals for LN-LN model</p></a></li>
<li><a href='#calculate.ci.rLNLN'>
<p>Maximum likelihood confidence intervals for rLN-LN model</p></a></li>
<li><a href='#comb.summands'>
<p>Combinations of fixed number of summands with pre-defined sum.</p></a></li>
<li><a href='#d.sum.of.mixtures.EXPLN'>
<p>Sums of mixtures of zero, one or more lognormal random variables and one exponential random variable</p></a></li>
<li><a href='#d.sum.of.mixtures.LNLN'>
<p>Sums of mixtures of lognormal random variables</p></a></li>
<li><a href='#d.sum.of.mixtures.rLNLN'>
<p>Sums of mixtures of lognormal random variables</p></a></li>
<li><a href='#generate.toydata'>
<p>Generation and analysis of synthetic data in stochastic profiling model</p></a></li>
<li><a href='#mix.d.sum.of.mixtures.EXPLN'>
<p>Density of the sum of mixtures of zero, one or more lognormal random variables and one exponential random variable weighted by all possible summands</p></a></li>
<li><a href='#mix.d.sum.of.mixtures.LNLN'>
<p>Density of the sum of mixtures of lognormal random variables weighted by all possible summands</p></a></li>
<li><a href='#mix.d.sum.of.mixtures.rLNLN'>
<p>Density of the sum of mixtures of lognormal random variables weighted by all possible summands</p></a></li>
<li><a href='#penalty.constraint.EXPLN'>
<p>Penalization for population densities that do not fulfil certain constraints for the EXP-LN model</p></a></li>
<li><a href='#penalty.constraint.LNLN'>
<p>Penalization for population densities that do not fulfil certain constraints for the LN-LN model</p></a></li>
<li><a href='#penalty.constraint.rLNLN'>
<p>Penalization for population densities that do not fulfil certain constraints for the rLN-LN model</p></a></li>
<li><a href='#set.model.functions'>
<p>Defines some global model-dependent functions</p></a></li>
<li><a href='#sod2'>
<p>Measurements from the detoxifying enzyme, SOD2</p></a></li>
<li><a href='#stochasticProfilingData'>
<p>User prompt for generation and visualization of synthetic data in stochastic profiling model</p></a></li>
<li><a href='#stochasticProfilingML'>
<p>User prompt for maximum likelihood estimation of stochastic profiling model</p></a></li>
<li><a href='#stochprof.loop'>
<p>Maximum likelihood estimation for the parameters in the stochastic profiling model</p></a></li>
<li><a href='#stochprof.results.EXPLN'>
<p>Evaluation of results from estimation of EXP-LN model</p></a></li>
<li><a href='#stochprof.results.LNLN'>
<p>Evaluation of results from estimation of LN-LN model</p></a></li>
<li><a href='#stochprof.results.rLNLN'>
<p>Evaluation of results from estimation of rLN-LN model</p></a></li>
<li><a href='#stochprof.search.EXPLN'>
<p>Calculation of the log likelihood function of the EXP-LN model</p></a></li>
<li><a href='#stochprof.search.LNLN'>
<p>Calculation of the log likelihood function of the LN-LN model</p></a></li>
<li><a href='#stochprof.search.rLNLN'>
<p>Calculation of the log likelihood function of the rLN-LN model</p></a></li>
<li><a href='#stochprofML-package'>
<p>Stochastic Profiling using Maximum Likelihood Estimation</p></a></li>
<li><a href='#toycluster.EXPLN'>
<p>Synthetic data from the EXP-LN model</p></a></li>
<li><a href='#toycluster.LNLN'>
<p>Synthetic data from the LN-LN model</p></a></li>
<li><a href='#toycluster.rLNLN'>
<p>Synthetic data from the rLN-LN model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Stochastic Profiling using Maximum Likelihood Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.3</td>
</tr>
<tr>
<td>DateNote:</td>
<td>Previous CRAN version 2.0.2 on 2020-05-14</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, numDeriv</td>
</tr>
<tr>
<td>Description:</td>
<td>New Version of the R package originally accompanying the paper 
  "Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles" 
  by Sameer S Bajikar, Christiane Fuchs, Andreas Roller, Fabian J Theis and Kevin A Janes 
  (PNAS 2014, 111(5), E626-635 &lt;<a href="https://doi.org/10.1073%2Fpnas.1311647111">doi:10.1073/pnas.1311647111</a>&gt;). In this paper, we measure expression profiles 
  from small heterogeneous populations of cells, where each cell is assumed to be from a mixture of 
  lognormal distributions. We perform maximum likelihood estimation in order to infer the mixture ratio and 
  the parameters of these lognormal distributions from the cumulated expression measurements.
  The main difference of this new package version to the previous one is that it is now possible to use 
  different n's, i.e. a dataset where each tissue sample originates from a different number of cells.  
  We used this on pheno-seq data, see: Tirier, S.M., Park, J., Preusser, F. et al. Pheno-seq - linking visual 
  features and gene expression in 3D cell culture systems. Sci Rep 9, 12367 (2019) 
  &lt;<a href="https://doi.org/10.1038%2Fs41598-019-48771-4">doi:10.1038/s41598-019-48771-4</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-10 09:32:58 UTC; lisa.amrhein</td>
</tr>
<tr>
<td>Author:</td>
<td>Lisa Amrhein [aut, cre],
  Christiane Fuchs [aut],
  Christoph Kurz [ctb] (Author to function comb.summands.R')</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-10 10:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='analyze.sod2'>
Analysis of SOD2 data in stochastic profiling model
</h2><span id='topic+analyze.sod2'></span>

<h3>Description</h3>

<p>Estimation of the model parameters for the SOD2 dataset provided in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyze.sod2(model = "LN-LN", TY = 2, use.constraints = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyze.sod2_+3A_model">model</code></td>
<td>

<p>model for which one wishes to estimate the parameters: &quot;LN-LN&quot;, &quot;rLN-LN&quot; or &quot;EXP-LN&quot;
</p>
</td></tr>
<tr><td><code id="analyze.sod2_+3A_ty">TY</code></td>
<td>

<p>number of types of cells that is assumed in the stochastic model
</p>
</td></tr>
<tr><td><code id="analyze.sod2_+3A_use.constraints">use.constraints</code></td>
<td>

<p>if TRUE, constraints on the individual population densities are applied; see <code>penalty.constraint.LNLN</code>, <code>penalty.constraint.rLNLN</code> and <br /> <code>penalty.constraint.EXPLN</code> for details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>sod2</code> dataset contains real 10-cell samplings from the detoxifying enzyme, SOD2. This function estimates the parameters of the stochastic profiling models for this data. At the end, it graphically represents a histogram of the SOD2 data together with the estimated probability density function.
</p>


<h3>Value</h3>

<p>A list as returned by <code>stochprof.loop</code>, i.e. the following components:
</p>
<table>
<tr><td><code>mle</code></td>
<td>
<p>maximum likelihood estimate</p>
</td></tr>
<tr><td><code>neg-loglikeli</code></td>
<td>
<p>value of the negative log-likelihood function at maximum likelihood estimate</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>approximate marginal maximum likelihood confidence intervals for the maximum likelihood estimate</p>
</td></tr>
<tr><td><code>pargrid</code></td>
<td>
<p>matrix containing parameter combinations and according values of the target function</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayesian information criterion value</p>
</td></tr>
<tr><td><code>adj.bic</code></td>
<td>
<p>adjusted Bayesian information criterion value which takes into account the numbers of parameters that were estimated during the preanalysis of a gene cluster (not applicable here, hence NULL)</p>
</td></tr>
<tr><td><code>pen</code></td>
<td>
<p>penalization for densities not fulfilling required constraints. If <code>use.constraints</code> is FALSE, this has no practical meaning. If <code>use.constraints</code> is TRUE, this value is included in <code>loglikeli</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='analyze.toycluster'>
Analysis of toyclusters in stochastic profiling model
</h2><span id='topic+analyze.toycluster'></span>

<h3>Description</h3>

<p>Estimation of the model parameters for the 12-gene toyclusters provided in this package. This is done in three steps: an optional preanalysis of the single genes, an analysis of three 4-gene subclusters, and finally the analysis of the entire 12-gene cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyze.toycluster(model = "LN-LN", data.model = "LN-LN", TY = 2,
   preanalyze = T, show.plots = T, use.constraints = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyze.toycluster_+3A_model">model</code></td>
<td>

<p>model for which one wishes to estimate the parameters: &quot;LN-LN&quot;, &quot;rLN-LN&quot; or &quot;EXP-LN&quot;
</p>
</td></tr>
<tr><td><code id="analyze.toycluster_+3A_data.model">data.model</code></td>
<td>

<p>model which has generated the 12-gene dataset: &quot;LN-LN&quot;, &quot;rLN-LN&quot; or &quot;EXP-LN&quot;
</p>
</td></tr>
<tr><td><code id="analyze.toycluster_+3A_ty">TY</code></td>
<td>

<p>number of types of cells that is assumed in the stochastic model
</p>
</td></tr>
<tr><td><code id="analyze.toycluster_+3A_preanalyze">preanalyze</code></td>
<td>

<p>if TRUE, the single-gene preanalysis as described below is carried out
</p>
</td></tr>
<tr><td><code id="analyze.toycluster_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, interim results are graphically displayed. This requires the user to confirm each new plot.
</p>
</td></tr>
<tr><td><code id="analyze.toycluster_+3A_use.constraints">use.constraints</code></td>
<td>

<p>if TRUE, constraints on the individual population densities are applied; see <code>penalty.constraint.LNLN</code>, <code>penalty.constraint.rLNLN</code> and <br /> <code>penalty.constraint.EXPLN</code> for details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function carries out estimation of the model parameters for the <code>toycluster.LNLN</code>, <br />
<code>toycluster.rLNLN</code> or <code>toycluster.EXPLN</code> dataset. This contains perfectly observed measurements for 12 genes and 16 tissue samples, assuming 10-cell samplings and two different types of cells. The true underlying parameters are given on the help page for the datasets.
</p>
<p>The estimation is performed in three steps:
</p>
<p>In an optional preanalysis (carried out if preanalyze is TRUE), each gene is considered individually, i.e. for each gene the parameters are estimated (these are p, mu_1, mu_2 and sigma for LN-LN, p, mu_1, mu_2, sigma_1 and sigma_2 for rLN-LN, and p, mu, sigma and lambda for EXP-LN). This gives a rough idea about the location of the parameters at computationally low cost. This might speed up the analysis of the larger clusters. From the confidence intervals of the single-gene estimates, one can construct appropriate parameter ranges for the following step.
</p>
<p>In the main step of the estimation procedure, the 12 genes are divided into three groups of size four. This is because the stochastic profiling model for 12 genes involves 48 (LN-LN and EXP-LN) to 49 (rLN-LN) parameters, which is computationally expensive and sometimes unreliable. Simulation studies showed that datasets comprising four genes are sufficient to estimate the log-means when there is data from 16 experiments available. For each of these 4-gene clusters, 10 (LN-LN and EXP-LN) or 11 (rLN-LN) parameters are estimated. The three groups result from a hierarchical clustering of the entire dataset. The genes numbers are (7,5,2,8), (1,3,4,10) and (9,6,12,11) for the LN-LN model, (12,9,6,11), (4,10,5,3) and (1,7,8,2) for the rLN-LN model and (11,1,10,9), (3,5,8,7) and (4,2,12,6) for the EXP-LN model.
</p>
<p>In the final step, the log-means mu are fixed to the maximum likelihood estimates that resulted from the main step. Then there remain only p, sigma and possibly lambda to be estimated. These are inferred now.
</p>
<p>Throughout the whole estimation process, interim results are printed into the console and, if <br />
show.plots is TRUE, graphically displayed.
</p>


<h3>Value</h3>

<p>The final result for the chosen 12-gene cluster. That is a list as returned by <code>stochprof.loop</code>, i.e. the following components:
</p>
<table>
<tr><td><code>mle</code></td>
<td>
<p>maximum likelihood estimate</p>
</td></tr>
<tr><td><code>neg-loglikeli</code></td>
<td>
<p>value of the negative log-likelihood function at maximum likelihood estimate</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>approximate marginal maximum likelihood confidence intervals for the maximum likelihood estimate</p>
</td></tr>
<tr><td><code>pargrid</code></td>
<td>
<p>matrix containing parameter combinations and according values of the target function</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayesian information criterion value</p>
</td></tr>
<tr><td><code>adj.bic</code></td>
<td>
<p>adjusted Bayesian information criterion value which takes into account the numbers of parameters that were estimated during the preanalysis of the gene cluster</p>
</td></tr>
<tr><td><code>pen</code></td>
<td>
<p>penalization for densities not fulfilling required constraints. If <code>use.constraints</code> is FALSE, this has no practical meaning. If <code>use.constraints</code> is TRUE, this value is included in <code>loglikeli</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='calculate.ci.EXPLN'>
Maximum likelihood confidence intervals for EXP-LN model
</h2><span id='topic+calculate.ci.EXPLN'></span>

<h3>Description</h3>

<p>Calculates approximate marginal maximum likelihood confidence intervals with
significance level alpha for all parameters in the EXP-LN model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate.ci.EXPLN(alpha, parameter, prev.result, dataset, n, TY,
   fix.mu = F, fixed.mu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate.ci.EXPLN_+3A_alpha">alpha</code></td>
<td>

<p>the significance level
</p>
</td></tr>
<tr><td><code id="calculate.ci.EXPLN_+3A_parameter">parameter</code></td>
<td>

<p>the maximum likelihood estimate around which the confidence interval is centered; if this value is missing, it is determined from prev.result. This parameter has to be on the original scale, not on the logit-/log-transformed scale as used during the estimation procedure. It has to be TY*(m+1)-dimensional (or m-dimensional, if TY=1), even for fix.mu==T.
</p>
</td></tr>
<tr><td><code id="calculate.ci.EXPLN_+3A_prev.result">prev.result</code></td>
<td>

<p>a list of previous results as returned by stochprof.results. This variable is only used when 'parameter' is missing.
</p>
</td></tr>
<tr><td><code id="calculate.ci.EXPLN_+3A_dataset">dataset</code></td>
<td>

<p>a matrix which contains the cumulated expression data over all cells in a tissue sample. Columns represent different genes, rows represent different tissue samples.
</p>
</td></tr>
<tr><td><code id="calculate.ci.EXPLN_+3A_n">n</code></td>
<td>

<p>number of cells taken from each tissue sample. This can also be a vector stating how many cells are in each sample separately.
</p>
</td></tr>
<tr><td><code id="calculate.ci.EXPLN_+3A_ty">TY</code></td>
<td>

<p>the number of types of cells that is assumed in the stochastic model
</p>
</td></tr>
<tr><td><code id="calculate.ci.EXPLN_+3A_fix.mu">fix.mu</code></td>
<td>

<p>if TRUE, the log-means of the lognormal distributions are kept fixed in the estimation procedure. Otherwise, they are to be estimated.
</p>
</td></tr>
<tr><td><code id="calculate.ci.EXPLN_+3A_fixed.mu">fixed.mu</code></td>
<td>

<p>a vector containing the values to which the log-means should be fixed if <br /> fix.mu==T. The order of components is as follows:
</p>
<p>(mu_type_1_gene_1, mu_type_1_gene_2, ...,
</p>
<p>mu_type_2_gene_1, mu_type_2_gene_2, ...).
</p>
<p>The parameter needs to be specified only when fix.mu==T.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The intervals are approximate because the function uses the formula
</p>
<p>[ theta_i +/- q_(1-alpha/2) * sqrt(H_ii) ],
</p>
<p>where theta_i is the estimate of the i.th parameter, q_(1-alpha/2) is the 1-alpha/2 quantile of the standard normal distribution, H is the inverse Hessian of the negative log likelihood function evaluated at the maximum likelihood estimate; H_ii is the i.th diagonal element of H. This approximation implicitly assumes that the log likelihood function is unimodal. The confidence interval is first calculated on the transformed, unrestricted parameter space and then back-transformed to the original one.
</p>


<h3>Value</h3>

<p>Approximate marginal maximum likelihood confidence intervals for all parameter components: Each row corresponds to one parameter (in the same order as always used in the stochastic profiling model). The first column contains lower bounds, the second column upper bounds.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='calculate.ci.LNLN'>
Maximum likelihood confidence intervals for LN-LN model
</h2><span id='topic+calculate.ci.LNLN'></span>

<h3>Description</h3>

<p>Calculates approximate marginal maximum likelihood confidence intervals with
significance level alpha for all parameters in the LN-LN model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate.ci.LNLN(alpha, parameter, prev.result, dataset, n, TY,
   fix.mu = F, fixed.mu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate.ci.LNLN_+3A_alpha">alpha</code></td>
<td>

<p>the significance level
</p>
</td></tr>
<tr><td><code id="calculate.ci.LNLN_+3A_parameter">parameter</code></td>
<td>

<p>the maximum likelihood estimate around which the confidence interval is centered; if this value is missing, it is determined from prev.result. This parameter has to be on the original scale, not on the logit-/log-transformed scale as used during the estimation procedure. It has to be TY*(m+1)-dimensional, even for fix.mu==T.
</p>
</td></tr>
<tr><td><code id="calculate.ci.LNLN_+3A_prev.result">prev.result</code></td>
<td>

<p>a list of previous results as returned by stochprof.results. This variable is only used when 'parameter' is missing.
</p>
</td></tr>
<tr><td><code id="calculate.ci.LNLN_+3A_dataset">dataset</code></td>
<td>

<p>a matrix which contains the cumulated expression data over all cells in a tissue sample. Columns represent different genes, rows represent different tissue samples.
</p>
</td></tr>
<tr><td><code id="calculate.ci.LNLN_+3A_n">n</code></td>
<td>

<p>number of cells taken from each tissue sample. This can also be a vector stating how many cells are in each sample separatly.
</p>
</td></tr>
<tr><td><code id="calculate.ci.LNLN_+3A_ty">TY</code></td>
<td>

<p>the number of types of cells that is assumed in the stochastic model
</p>
</td></tr>
<tr><td><code id="calculate.ci.LNLN_+3A_fix.mu">fix.mu</code></td>
<td>

<p>if TRUE, the log-means are kept fixed in the estimation procedure. Otherwise, they are to be estimated.
</p>
</td></tr>
<tr><td><code id="calculate.ci.LNLN_+3A_fixed.mu">fixed.mu</code></td>
<td>

<p>a vector containing the values to which the log-means should be fixed if <br /> fix.mu==T. The order of components is as follows:
</p>
<p>(mu_type_1_gene_1, mu_type_1_gene_2, ...,
</p>
<p>mu_type_2_gene_1, mu_type_2_gene_2, ...).
</p>
<p>The parameter needs to be specified only when fix.mu==T.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The intervals are approximate because the function uses the formula
</p>
<p>[ theta_i +/- q_(1-alpha/2) * sqrt(H_ii) ],
</p>
<p>where theta_i is the estimate of the i.th parameter, q_(1-alpha/2) is the 1-alpha/2 quantile of the standard normal distribution, H is the inverse Hessian of the negative log likelihood function evaluated at the maximum likelihood estimate; H_ii is the i.th diagonal element of H. This approximation implicitly assumes that the log likelihood function is unimodal. The confidence interval is first calculated on the transformed, unrestricted parameter space and then back-transformed to the original one.
</p>


<h3>Value</h3>

<p>Approximate marginal maximum likelihood confidence intervals for all parameter components: Each row corresponds to one parameter (in the same order as always used in the stochastic profiling model). The first column contains lower bounds, the second column upper bounds.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='calculate.ci.rLNLN'>
Maximum likelihood confidence intervals for rLN-LN model
</h2><span id='topic+calculate.ci.rLNLN'></span>

<h3>Description</h3>

<p>Calculates approximate marginal maximum likelihood confidence intervals with
significance level alpha for all parameters in the rLN-LN model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate.ci.rLNLN(alpha, parameter, prev.result, dataset, n, TY,
   fix.mu = F, fixed.mu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate.ci.rLNLN_+3A_alpha">alpha</code></td>
<td>

<p>the significance level
</p>
</td></tr>
<tr><td><code id="calculate.ci.rLNLN_+3A_parameter">parameter</code></td>
<td>

<p>the maximum likelihood estimate around which the confidence interval is centered; if this value is missing, it is determined from prev.result. This parameter has to be on the original scale, not on the logit-/log-transformed scale as used during the estimation procedure. It has to be ((m+1)*TY-1)-dimensional, even for fix.mu==T.
</p>
</td></tr>
<tr><td><code id="calculate.ci.rLNLN_+3A_prev.result">prev.result</code></td>
<td>

<p>a list of previous results as returned by stochprof.results. This variable is only used when 'parameter' is missing.
</p>
</td></tr>
<tr><td><code id="calculate.ci.rLNLN_+3A_dataset">dataset</code></td>
<td>

<p>a matrix which contains the cumulated expression data over all cells in a tissue sample. Columns represent different genes, rows represent different tissue samples.
</p>
</td></tr>
<tr><td><code id="calculate.ci.rLNLN_+3A_n">n</code></td>
<td>

<p>number of cells taken from each tissue sample. This can also be a vector stating how many cells are in each sample separatly.
</p>
</td></tr>
<tr><td><code id="calculate.ci.rLNLN_+3A_ty">TY</code></td>
<td>

<p>the number of types of cells that is assumed in the stochastic model
</p>
</td></tr>
<tr><td><code id="calculate.ci.rLNLN_+3A_fix.mu">fix.mu</code></td>
<td>

<p>if TRUE, the log-means are kept fixed in the estimation procedure. Otherwise, they are to be estimated.
</p>
</td></tr>
<tr><td><code id="calculate.ci.rLNLN_+3A_fixed.mu">fixed.mu</code></td>
<td>

<p>a vector containing the values to which the log-means should be fixed if <br /> fix.mu==T. The order of components is as follows:
</p>
<p>(mu_type_1_gene_1, mu_type_1_gene_2, ...,
</p>
<p>mu_type_2_gene_1, mu_type_2_gene_2, ...).
</p>
<p>The parameter needs to be specified only when fix.mu==T.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The intervals are approximate because the function uses the formula
</p>
<p>[ theta_i +/- q_(1-alpha/2) * sqrt(H_ii) ],
</p>
<p>where theta_i is the estimate of the i.th parameter, q_(1-alpha/2) is the 1-alpha/2 quantile of the standard normal distribution, H is the inverse Hessian of the negative log likelihood function evaluated at the maximum likelihood estimate; H_ii is the i.th diagonal element of H. This approximation implicitly assumes that the log likelihood function is unimodal. The confidence interval is first calculated on the transformed, unrestricted parameter space and then back-transformed to the original one.
</p>


<h3>Value</h3>

<p>Approximate marginal maximum likelihood confidence intervals for all parameter components: Each row corresponds to one parameter (in the same order as always used in the stochastic profiling model). The first column contains lower bounds, the second column upper bounds.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='comb.summands'>
Combinations of fixed number of summands with pre-defined sum.
</h2><span id='topic+comb.summands'></span>

<h3>Description</h3>

<p>Returns all combinations of k numbers between 0 and n whose sum equals n.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comb.summands(n, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comb.summands_+3A_n">n</code></td>
<td>

<p>the sum of the k summands
</p>
</td></tr>
<tr><td><code id="comb.summands_+3A_k">k</code></td>
<td>

<p>the number of summands
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns all combinations of k numbers (non-negative integers) between 0 and n whose sum equals n. The order of the summands matters,
i.e. 2+3=5 and 3+2=5 would count as two different combinations.
</p>


<h3>Value</h3>

<p>A matrix with k columns. Each row contains a different combination of k non-negative integers which sum up to n.
</p>


<h3>Author(s)</h3>

<p>Christoph Kurz
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='d.sum.of.mixtures.EXPLN'>
Sums of mixtures of zero, one or more lognormal random variables and one exponential random variable
</h2><span id='topic+d.sum.of.mixtures.EXPLN'></span><span id='topic+r.sum.of.mixtures.EXPLN'></span>

<h3>Description</h3>

<p>Density and random generation of a sum of i.i.d. random variables, where each random variable is from the following mixture distribution: With probability p_i, it is of type i. For all but the largest i, it is lognormally distributed with log-mean mu_i and log-standard deviation sigma_i. Otherwise it is exponentially distributed with rate lambda.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d.sum.of.mixtures.EXPLN(y, n, p.vector, mu.vector, sigma.vector, lambda,
   logdens = T)
r.sum.of.mixtures.EXPLN(k, n, p.vector, mu.vector, sigma.vector, lambda, N.matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d.sum.of.mixtures.EXPLN_+3A_y">y</code></td>
<td>

<p>the argument at which the density is evaluated
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.EXPLN_+3A_k">k</code></td>
<td>

<p>number of i.i.d. random variables returned by this function (in the considered application: number of tissue samples)
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.EXPLN_+3A_n">n</code></td>
<td>

<p>the number of random variables entering each sum (in the considered application: number of cells per tissue sample). This can also be a vector stating how many cells are in each sample separatly.
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.EXPLN_+3A_p.vector">p.vector</code></td>
<td>

</td></tr>
<tr><td><code id="d.sum.of.mixtures.EXPLN_+3A_mu.vector">mu.vector</code></td>
<td>

<p>vector (mu1,mu2,...,mu(T-1)) containing the log-means for each lognormal type (types 1 to T-1)
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.EXPLN_+3A_sigma.vector">sigma.vector</code></td>
<td>

<p>vector (sigma1,...,sigma(T-1)) containing the log-standard deviations sigma for each lognormal type (types 1 to T-1)
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.EXPLN_+3A_lambda">lambda</code></td>
<td>

<p>the rate for the exponential type (type T)
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.EXPLN_+3A_logdens">logdens</code></td>
<td>

<p>if TRUE, the log of the density is returned
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.EXPLN_+3A_n.matrix">N.matrix</code></td>
<td>

<p>optional. Matrix, that shows the decomposition of samples to be generated. Each row stands for a future sample and the columns show the decomposition of types for the specific sample such that the row sum should be n (either a value, i.e. all the same or a vector).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lengths of mu.vector and sigma.vector have to be identical. p.vector has to have one component more. Its length automatically determines the number of different types. lambda has to be a scalar.
</p>


<h3>Value</h3>

<p>'d.sum.of.mixtures.EXPLN' gives the density, and 'r.sum.of.mixtures.EXPLN' generates random variables.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate random variables
p &lt;- c(0.25,0.75)
mu &lt;- 2
sigma &lt;- 0.3
lambda &lt;- 5
set.model.functions("EXP-LN")

r &lt;- r.sum.of.mixtures.EXPLN(10^4,10,p,mu,sigma,lambda)
hist(r,xlab="Sum of mixtures of lognormals",freq=FALSE,breaks=100,ylim=c(0,0.2))

# plot according theoretical density function
x &lt;- seq(round(min(r)),round(max(r)),(round(max(r))-round(min(r)))/500)
y &lt;- d.sum.of.mixtures.EXPLN(x,10,p,mu,sigma,lambda,logdens=FALSE)
lines(x,y,col="blue",lwd=3)
</code></pre>

<hr>
<h2 id='d.sum.of.mixtures.LNLN'>
Sums of mixtures of lognormal random variables
</h2><span id='topic+d.sum.of.mixtures.LNLN'></span><span id='topic+r.sum.of.mixtures.LNLN'></span>

<h3>Description</h3>

<p>Density and random generation of a sum of i.i.d. random variables, where each random variable is from the following mixture distribution: With probability p_i, it is of type i. In that case, it is lognormally distributed with log-mean mu_i and log-standard deviation sigma_i.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d.sum.of.mixtures.LNLN(y, n, p.vector, mu.vector, sigma.vector, logdens = T)
r.sum.of.mixtures.LNLN(k, n, p.vector, mu.vector, sigma.vector, N.matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d.sum.of.mixtures.LNLN_+3A_y">y</code></td>
<td>

<p>the argument at which the density is evaluated
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.LNLN_+3A_k">k</code></td>
<td>

<p>number of i.i.d. random variables returned by this function (in the considered application: number of tissue samples)
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.LNLN_+3A_n">n</code></td>
<td>

<p>the number of random variables entering each sum (in the considered application: number of cells per tissue sample). This can also be a vector stating how many cells are in each sample separatly.
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.LNLN_+3A_p.vector">p.vector</code></td>
<td>

<p>vector (p1,p2,..,pT) containing the probabilities for each type of cell. Its elements have to sum up to one
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.LNLN_+3A_mu.vector">mu.vector</code></td>
<td>

<p>vector (mu1,mu2,...,muT) containing the log-means for each type
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.LNLN_+3A_sigma.vector">sigma.vector</code></td>
<td>

<p>vector (sigma1,...,sigmaT) containing the log-standard deviations sigma for each type
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.LNLN_+3A_logdens">logdens</code></td>
<td>

<p>if TRUE, the log of the density is returned
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.LNLN_+3A_n.matrix">N.matrix</code></td>
<td>

<p>optional. Matrix, that shows the decomposition of samples to be generated. Each row stands for a future sample and the columns show the decomposition of types for the specific sample such that the row sum should be n (either a value, i.e. all the same or a vector).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lengths of p.vector, mu.vector and sigma.vector have to be identical. Their lengths automatically determine the number of different types.
</p>


<h3>Value</h3>

<p>'d.sum.of.mixtures.LNLN' gives the density, and 'r.sum.of.mixtures.LNLN' generates random variables.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate random variables
p &lt;- c(0.25,0.75)
mu &lt;- c(2,-1)
sigma &lt;- c(0.3,0.1)

set.model.functions("LN-LN")

r &lt;- r.sum.of.mixtures.LNLN(10^4,10,p,mu,sigma)
hist(r,xlab="Sum of mixtures of lognormals",freq=FALSE,breaks=100,ylim=c(0,0.2))

# plot according theoretical density function
x &lt;- seq(round(min(r)),round(max(r)),(round(max(r))-round(min(r)))/500)
y &lt;- d.sum.of.mixtures.LNLN(x,10,p,mu,sigma,logdens=FALSE)
lines(x,y,col="blue",lwd=3)
</code></pre>

<hr>
<h2 id='d.sum.of.mixtures.rLNLN'>
Sums of mixtures of lognormal random variables
</h2><span id='topic+d.sum.of.mixtures.rLNLN'></span><span id='topic+r.sum.of.mixtures.rLNLN'></span>

<h3>Description</h3>

<p>Density and random generation of a sum of i.i.d. random variables, where each random variable is from the following mixture distribution: With probability p_i, it is of type i. In that case, it is lognormally distributed with log-mean mu_i and log-standard deviation sigma_i.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d.sum.of.mixtures.rLNLN(y, n, p.vector, mu.vector, sigma.vector, logdens = T)
r.sum.of.mixtures.rLNLN(k, n, p.vector, mu.vector, sigma.vector, N.matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d.sum.of.mixtures.rLNLN_+3A_y">y</code></td>
<td>

<p>the argument at which the density is evaluated
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.rLNLN_+3A_k">k</code></td>
<td>

<p>number of i.i.d. random variables returned by this function (in the considered application: number of tissue samples)
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.rLNLN_+3A_n">n</code></td>
<td>

<p>the number of random variables entering each sum (in the considered application: number of cells per tissue sample). This can also be a vector stating how many cells are in each sample separatly.
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.rLNLN_+3A_p.vector">p.vector</code></td>
<td>

<p>vector (p1,p2,..,pT) containing the probabilities for each type of cell. Its elements have to sum up to one
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.rLNLN_+3A_mu.vector">mu.vector</code></td>
<td>

<p>vector (mu1,mu2,...,muT) containing the log-means for each type
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.rLNLN_+3A_sigma.vector">sigma.vector</code></td>
<td>

<p>vector (sigma1,...,sigmaT) containing the log-standard deviations sigma for each type
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.rLNLN_+3A_logdens">logdens</code></td>
<td>

<p>if TRUE, the log of the density is returned
</p>
</td></tr>
<tr><td><code id="d.sum.of.mixtures.rLNLN_+3A_n.matrix">N.matrix</code></td>
<td>

<p>optional. Matrix, that shows the decomposition of samples to be generated. Each row stands for a future sample and the columns show the decomposition of types for the specific sample such that the row sum should be n (either a value, i.e. all the same or a vector).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lengths of p.vector, mu.vector and sigma.vector have to be identical. Their lengths automatically determine the number of different types.
</p>


<h3>Value</h3>

<p>'d.sum.of.mixtures.rLNLN' gives the density, and 'r.sum.of.mixtures.rLNLN' generates random variables.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate random variables
p &lt;- c(0.25,0.75)
mu &lt;- c(2,-1)
sigma &lt;- c(0.3,0.1)

set.model.functions("rLN-LN")

r &lt;- r.sum.of.mixtures.rLNLN(10^4,10,p,mu,sigma)
hist(r,xlab="Sum of mixtures of lognormals",freq=FALSE,breaks=100,ylim=c(0,0.2))

# plot according theoretical density function
x &lt;- seq(round(min(r)),round(max(r)),(round(max(r))-round(min(r)))/500)
y &lt;- d.sum.of.mixtures.rLNLN(x,10,p,mu,sigma,logdens=FALSE)
lines(x,y,col="blue",lwd=3)
</code></pre>

<hr>
<h2 id='generate.toydata'>
Generation and analysis of synthetic data in stochastic profiling model
</h2><span id='topic+generate.toydata'></span>

<h3>Description</h3>

<p>Generation of a dataset of 500 i.i.d measurements as considered in the stochastic profiling model. Afterwards estimation of the model parameters and comparison of the estimates with the true value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate.toydata(model = "LN-LN")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate.toydata_+3A_model">model</code></td>
<td>

<p>the chosen stochastic profiling model: &quot;LN-LN&quot;, &quot;rLN-LN&quot; or &quot;EXP-LN&quot;
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function first generates a dataset of 500 i.i.d. 10-cell samplings as considered in the stochastic profiling models &quot;LN-LN&quot;, &quot;rLN-LN&quot; and &quot;EXP-LN&quot;. The employed parameters are TY=2 (i.e. two different types of cells are assumed) and p=c(0.2,0.8) for all models. Furthermore, mu=c(1.5,-1.5) and sigma=0.2 for the LN-LN model, mu=c(1.5,-1.5) and sigma=(0.2,0.6) for the rLN-LN model, and mu=1.5, sigma=0.2 and lambda=0.5 for the EXP-LN model. The generated data is displayed in a histogram together with the theoretical probability density function. At the end of the estimation procedure, the profile log-likelihood plots are shown. Finally, the true and the estimated probability density functions are compared and the estimation results are printed.
</p>


<h3>Value</h3>

<p>A list as returned by <code>stochprof.loop</code>, i.e. the following components:
</p>
<table>
<tr><td><code>mle</code></td>
<td>
<p>maximum likelihood estimate</p>
</td></tr>
<tr><td><code>neg-loglikeli</code></td>
<td>
<p>value of the negative log-likelihood function at maximum likelihood estimate</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>approximate marginal maximum likelihood confidence intervals for the maximum likelihood estimate</p>
</td></tr>
<tr><td><code>pargrid</code></td>
<td>
<p>matrix containing parameter combinations and according values of the target function</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayesian information criterion value</p>
</td></tr>
<tr><td><code>adj.bic</code></td>
<td>
<p>adjusted Bayesian information criterion value which takes into account the numbers of parameters that were estimated during the preanalysis of a gene cluster. Is only calculated if parameter <code>subgroups</code> is given, otherwise set to NULL.</p>
</td></tr>
<tr><td><code>pen</code></td>
<td>
<p>penalization for densities not fulfilling required constraints. If <code>use.constraints</code> is FALSE, this has no practical meaning. If <code>use.constraints</code> is TRUE, this value is included in <code>loglikeli</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='mix.d.sum.of.mixtures.EXPLN'>
Density of the sum of mixtures of zero, one or more lognormal random variables and one exponential random variable weighted by all possible summands
</h2><span id='topic+mix.d.sum.of.mixtures.EXPLN'></span>

<h3>Description</h3>

<p>Density of a sum of i.i.d. random variables, where each random variable is from the following mixture distribution: With probability p_i, it is of type i. For all but the largest i, it is lognormally distributed with log-mean mu_i and log-standard deviation sigma_i. Otherwise it is exponentially distributed with rate lambda. The density is somehow a &quot;mixed&quot; one, as for all values in <code>n</code> the density of the random variable is calculated and the weighted average is taken to be the density of this specific value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix.d.sum.of.mixtures.EXPLN(y, n.vector, p.vector, mu.vector, sigma.vector, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mix.d.sum.of.mixtures.EXPLN_+3A_y">y</code></td>
<td>

<p>the argument at which the density is evaluated
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.EXPLN_+3A_n.vector">n.vector</code></td>
<td>

<p>the number of random variables entering each sum (in the considered application: number of cells per tissue sample). This can also be a vector stating how many cells are in each sample separatly
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.EXPLN_+3A_p.vector">p.vector</code></td>
<td>

<p>vector (p1,p2,..,pT) containing the probabilities for each type of cell. Its elements have to sum up to one
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.EXPLN_+3A_mu.vector">mu.vector</code></td>
<td>

<p>vector (mu1,mu2,...,mu(T-1)) containing the log-means for each lognormal type (types 1 to T-1)
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.EXPLN_+3A_sigma.vector">sigma.vector</code></td>
<td>

<p>vector (sigma1,...,sigma(T-1)) containing the log-standard deviations sigma for each lognormal type (types 1 to T-1)
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.EXPLN_+3A_lambda">lambda</code></td>
<td>

<p>the rate for the exponential type (type T)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lengths of mu.vector and sigma.vector have to be identical. p.vector has to have one component more. Its length automatically determines the number of different types. lambda has to be a scalar.
</p>


<h3>Value</h3>

<p>'mix.d.sum.of.mixtures.EXPLN' gives the density of a random variable originating from one of the tissue samples in the mixed n-vector.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='mix.d.sum.of.mixtures.LNLN'>
Density of the sum of mixtures of lognormal random variables weighted by all possible summands
</h2><span id='topic+mix.d.sum.of.mixtures.LNLN'></span>

<h3>Description</h3>

<p>Density of a random variable that is the sum of i.i.d. random variables, where each random variable is from the following mixture distribution: With probability p_i, it is of type i. In that case, it is lognormally distributed with log-mean mu_i and log-standard deviation sigma_i. The density is somehow a &quot;mixed&quot; one, as for all values in <code>n</code> the density of the random variable is calculated and the weighted average is taken to be the density of this specific value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix.d.sum.of.mixtures.LNLN(y, n.vector, p.vector, mu.vector, sigma.vector)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mix.d.sum.of.mixtures.LNLN_+3A_y">y</code></td>
<td>

<p>the argument at which the density is evaluated
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.LNLN_+3A_n.vector">n.vector</code></td>
<td>

<p>the number of random variables entering each sum (in the considered application: number of cells per tissue sample). This can also be a vector stating how many cells are in each sample separatly
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.LNLN_+3A_p.vector">p.vector</code></td>
<td>

<p>vector (p1,p2,..,pT) containing the probabilities for each type of cell. Its elements have to sum up to one
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.LNLN_+3A_mu.vector">mu.vector</code></td>
<td>

<p>vector (mu1,mu2,...,muT) containing the log-means for each type
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.LNLN_+3A_sigma.vector">sigma.vector</code></td>
<td>

<p>vector (sigma1,...,sigmaT) containing the log-standard deviations sigma for each type
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lengths of p.vector, mu.vector and sigma.vector have to be identical. Their lengths automatically determine the number of different types.
</p>


<h3>Value</h3>

<p>'mix.d.sum.of.mixtures.LNLN' gives the density of a random variable originating from one of the tissue samples in the mixed n-vector.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='mix.d.sum.of.mixtures.rLNLN'>
Density of the sum of mixtures of lognormal random variables weighted by all possible summands
</h2><span id='topic+mix.d.sum.of.mixtures.rLNLN'></span>

<h3>Description</h3>

<p>Density and random generation of a sum of i.i.d. random variables, where each random variable is from the following mixture distribution: With probability p_i, it is of type i. In that case, it is lognormally distributed with log-mean mu_i and log-standard deviation sigma_i.  The density is somehow a &quot;mixed&quot; one, as for all values in <code>n</code> the density of the random variable is calculated and the weighted average is taken to be the density of this specific value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mix.d.sum.of.mixtures.rLNLN(y, n.vector, p.vector, mu.vector, sigma.vector)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mix.d.sum.of.mixtures.rLNLN_+3A_y">y</code></td>
<td>

<p>the argument at which the density is evaluated
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.rLNLN_+3A_n.vector">n.vector</code></td>
<td>

<p>the number of random variables entering each sum (in the considered application: number of cells per tissue sample). This can also be a vector stating how many cells are in each sample separatly
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.rLNLN_+3A_p.vector">p.vector</code></td>
<td>

<p>vector (p1,p2,..,pT) containing the probabilities for each type of cell. Its elements have to sum up to one
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.rLNLN_+3A_mu.vector">mu.vector</code></td>
<td>

<p>vector (mu1,mu2,...,muT) containing the log-means for each type
</p>
</td></tr>
<tr><td><code id="mix.d.sum.of.mixtures.rLNLN_+3A_sigma.vector">sigma.vector</code></td>
<td>

<p>vector (sigma1,...,sigmaT) containing the log-standard deviations sigma for each type
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lengths of p.vector, mu.vector and sigma.vector have to be identical. Their lengths automatically determine the number of different types.
</p>


<h3>Value</h3>

<p>'mix.d.sum.of.mixtures.LNLN' gives the density of a random variable originating from one of the tissue samples in the mixed n-vector.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='penalty.constraint.EXPLN'>
Penalization for population densities that do not fulfil certain constraints for the EXP-LN model
</h2><span id='topic+penalty.constraint.EXPLN'></span>

<h3>Description</h3>

<p>In order to force the individual populations to be sufficiently distinct from each other, one can perform penalized optimization. To this end, constraints on the densities are introduced (see details). If the constraints are not fulfilled, a penalization term is added to the negative log-likelihood (which is to be minimized).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penalty.constraint.EXPLN(dataset, parameter, smoothingpar = 10^5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="penalty.constraint.EXPLN_+3A_dataset">dataset</code></td>
<td>

<p>matrix which contains the cumulated expression data over all cells in a tissue sample. Columns represent different genes, rows represent different tissue samples.
</p>
</td></tr>
<tr><td><code id="penalty.constraint.EXPLN_+3A_parameter">parameter</code></td>
<td>

<p>parameter for which the penalization term is calculated. This is a vector containing p, mu, sigma and lambda.
</p>
</td></tr>
<tr><td><code id="penalty.constraint.EXPLN_+3A_smoothingpar">smoothingpar</code></td>
<td>

<p>weight with which the penalization term is multiplied.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The constraints are as follows: There are TY densities for the TY distinct populations. For each i=1,...,(TY-1), one considers the density of population i (the higher regulatory state) and the density of population i+1 (the lower regulatory state). The density of the higher regulatory state is constrained to be greater than the density of the lower regulatory state in the domain between the mode of the high state and the largest observation in the dataset.
</p>
<p>Introduction of this penalization term does not mean that the constraints will automatically be fulfilled. The parameter estimate will be a trade-off between a maximizer of the unconstrained likelihood function and a minimizer of the penalization function. The higher the parameter <code>smoothingpar</code>, the more importance is on fulfilling the constraints.
</p>


<h3>Value</h3>

<p>The population densities are compared on the above described domains. Wherever the constraint is not fulfilled, the difference between the larger and the lower density is calculated. The squares of all such differences are summed up and multiplied with <code>smoothingpar</code>. This value is returned.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='penalty.constraint.LNLN'>
Penalization for population densities that do not fulfil certain constraints for the LN-LN model
</h2><span id='topic+penalty.constraint.LNLN'></span>

<h3>Description</h3>

<p>In order to force the individual populations to be sufficiently distinct from each other, one can perform penalized optimization. To this end, constraints on the densities are introduced (see details). If the constraints are not fulfilled, a penalization term is added to the negative log-likelihood (which is to be minimized).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penalty.constraint.LNLN(dataset, parameter, smoothingpar = 10^5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="penalty.constraint.LNLN_+3A_dataset">dataset</code></td>
<td>

<p>matrix which contains the cumulated expression data over all cells in a tissue sample. Columns represent different genes, rows represent different tissue samples.
</p>
</td></tr>
<tr><td><code id="penalty.constraint.LNLN_+3A_parameter">parameter</code></td>
<td>

<p>parameter for which the penalization term is calculated. This is a vector containing p, mu and sigma.
</p>
</td></tr>
<tr><td><code id="penalty.constraint.LNLN_+3A_smoothingpar">smoothingpar</code></td>
<td>

<p>weight with which the penalization term is multiplied.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The constraints are as follows: There are TY densities for the TY distinct populations. For each i=1,...,(TY-1), one considers the density of population i (the higher regulatory state) and the density of population i+1 (the lower regulatory state). The density of the higher regulatory state is constrained to be greater than the density of the lower regulatory state in the domain between the mode of the high state and the largest observation in the dataset.
</p>
<p>Introduction of this penalization term does not mean that the constraints will automatically be fulfilled. The parameter estimate will be a trade-off between a maximizer of the unconstrained likelihood function and a minimizer of the penalization function. The higher the parameter <code>smoothingpar</code>, the more importance is on fulfilling the constraints.
</p>


<h3>Value</h3>

<p>The population densities are compared on the above described domains. Wherever the constraint is not fulfilled, the difference between the larger and the lower density is calculated. The squares of all such differences are summed up and multiplied with <code>smoothingpar</code>. This value is returned.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='penalty.constraint.rLNLN'>
Penalization for population densities that do not fulfil certain constraints for the rLN-LN model
</h2><span id='topic+penalty.constraint.rLNLN'></span>

<h3>Description</h3>

<p>In order to force the individual populations to be sufficiently distinct from each other, one can perform penalized optimization. To this end, constraints on the densities are introduced (see details). If the constraints are not fulfilled, a penalization term is added to the negative log-likelihood (which is to be minimized).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>penalty.constraint.rLNLN(dataset, parameter, smoothingpar = 10^5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="penalty.constraint.rLNLN_+3A_dataset">dataset</code></td>
<td>

<p>matrix which contains the cumulated expression data over all cells in a tissue sample. Columns represent different genes, rows represent different tissue samples.
</p>
</td></tr>
<tr><td><code id="penalty.constraint.rLNLN_+3A_parameter">parameter</code></td>
<td>

<p>parameter for which the penalization term is calculated. This is a vector containing p, mu and sigma.
</p>
</td></tr>
<tr><td><code id="penalty.constraint.rLNLN_+3A_smoothingpar">smoothingpar</code></td>
<td>

<p>weight with which the penalization term is multiplied.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The constraints are as follows: There are TY densities for the TY distinct populations. For each i=1,...,(TY-1), one considers the density of population i (the higher regulatory state) and the density of population i+1 (the lower regulatory state). The density of the higher regulatory state is constrained to be greater than the density of the lower regulatory state in the domain between the mode of the high state and the largest observation in the dataset.
</p>
<p>Introduction of this penalization term does not mean that the constraints will automatically be fulfilled. The parameter estimate will be a trade-off between a maximizer of the unconstrained likelihood function and a minimizer of the penalization function. The higher the parameter <code>smoothingpar</code>, the more importance is on fulfilling the constraints.
</p>


<h3>Value</h3>

<p>The population densities are compared on the above described domains. Wherever the constraint is not fulfilled, the difference between the larger and the lower density is calculated. The squares of all such differences are summed up and multiplied with <code>smoothingpar</code>. This value is returned.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visualfeatures and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='set.model.functions'>
Defines some global model-dependent functions
</h2><span id='topic+set.model.functions'></span>

<h3>Description</h3>

<p>Defines which model to use in the following and sets depending on this decistion some global model-dependent functions. This function is unly needed when using lower leverl functions of the package such as d.sum.of.mixtures which does not have its own model selection input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set.model.functions(model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set.model.functions_+3A_model">model</code></td>
<td>

<p>model for which one wishes to estimate the parameters: &quot;LN-LN&quot;, &quot;rLN-LN&quot; or &quot;EXP-LN&quot;
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Loads all model-specific functions and directs the general function to the model specific function, wich is the same but with the endings .LNLN, .rLNLN, and .EXPLN.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>

<hr>
<h2 id='sod2'>
Measurements from the detoxifying enzyme, SOD2
</h2><span id='topic+sod2'></span>

<h3>Description</h3>

<p>Real 10-cell samplings from the detoxifying enzyme, SOD2. The dataset contains the measurements of SOD2 expression by qPCR in 81 random samplings of 10 ECM-attached cells.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sod2)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:81] 0.603 0.873 0.204 1 3.001 ...
</p>


<h3>Source</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors)
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sod2)
hist(sod2,breaks=seq(0,7,0.5),col="grey")
</code></pre>

<hr>
<h2 id='stochasticProfilingData'>
User prompt for generation and visualization of synthetic data in stochastic profiling model
</h2><span id='topic+stochasticProfilingData'></span>

<h3>Description</h3>

<p>Generation of a dataset of i.i.d measurements as considered in the stochastic profiling model. The user is prompted to input all required settings. He or she hence does not have to delve into the structure of this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stochasticProfilingData()
</code></pre>


<h3>Details</h3>

<p>This function generates a dataset of i.i.d synthetic measurements as considered in the stochastic profiling model. The user is prompted to input all required settings, e.g. the exact model (LN-LN, rLN-LN or EXP-LN), the number of samples, the number of populations etc. The dataset is returned as a matrix and visualized in histograms together with the data generating probability density function (pdf).
</p>


<h3>Value</h3>

<p>A matrix containing the synthetic data. Columns stand for different genes, rows for samples.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='stochasticProfilingML'>
User prompt for maximum likelihood estimation of stochastic profiling model
</h2><span id='topic+stochasticProfilingML'></span>

<h3>Description</h3>

<p>Maximum likelihood estimation for the parameters in the stochastic profiling model. The user is prompted to input the data and all required settings. He or she hence does not have to delve into the structure of this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stochasticProfilingML()
</code></pre>


<h3>Details</h3>

<p>The function performs maximum likelihood estimation for the parameters in the stochastic profiling model. The user is prompted to input the data and all required settings, i.e. especially the data, but also the exact model (LN-LN, rLN-LN or EXP-LN), the number of populations, the number of cells per sample etc. The data can either be entered manually, or it can be read from a file, or the user enters the name of a variable which contains the data.
</p>


<h3>Value</h3>

<p>A list as returned by <code>stochprof.loop</code>, i.e. the following components:
</p>
<table>
<tr><td><code>mle</code></td>
<td>
<p>maximum likelihood estimate</p>
</td></tr>
<tr><td><code>neg-loglikeli</code></td>
<td>
<p>value of the negative log-likelihood function at maximum likelihood estimate</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>approximate marginal maximum likelihood confidence intervals for the maximum likelihood estimate</p>
</td></tr>
<tr><td><code>pargrid</code></td>
<td>
<p>matrix containing parameter combinations and according values of the target function</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayesian information criterion value</p>
</td></tr>
<tr><td><code>adj.bic</code></td>
<td>
<p>adjusted Bayesian information criterion value which takes into account the numbers of parameters that were estimated during the preanalysis of a gene cluster. Is only calculated if parameter <code>subgroups</code> is given, otherwise set to NULL.</p>
</td></tr>
<tr><td><code>pen</code></td>
<td>
<p>penalization for densities not fulfilling required constraints. If <code>use.constraints</code> is FALSE, this has no practical meaning. If <code>use.constraints</code> is TRUE, this value is included in <code>loglikeli</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='stochprof.loop'>
Maximum likelihood estimation for the parameters in the stochastic profiling model
</h2><span id='topic+stochprof.loop'></span>

<h3>Description</h3>

<p>Maximum likelihood estimation for the parameters in the stochastic profiling model. Because the log-likelihood function is potentially multimodal, no straightforward use of gradient-based approaches for finding globally optimal parameter combinations is possible. To tackle this challenge, this function performs a two-step estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stochprof.loop(model, dataset, n, TY, genenames = NULL, fix.mu = F,
   fixed.mu, par.range = NULL, prev.result = NULL, loops = 5,
   until.convergence = T, print.output = T, show.plots = T,
   plot.title = "", pdf.file, use.constraints = F, subgroups)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stochprof.loop_+3A_model">model</code></td>
<td>

<p>model for which one wishes to estimate the parameters: &quot;LN-LN&quot;, &quot;rLN-LN&quot; or &quot;EXP-LN&quot;
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_dataset">dataset</code></td>
<td>

<p>matrix which contains the cumulated expression data over all cells in a tissue sample. Columns represent different genes, rows represent different tissue samples.
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_n">n</code></td>
<td>

<p>number of cells taken from each tissue sample. This can also be a vector stating how many cells are in each sample seperatly.
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_ty">TY</code></td>
<td>

<p>number of types of cells that is assumed in the stochastic model
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_genenames">genenames</code></td>
<td>

<p>names of the genes in the dataset. For genenames==NULL, the genes will simply be enumerated according to the column numbers in the dataset.
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_fix.mu">fix.mu</code></td>
<td>

<p>if TRUE, the log-means of the lognormal distributions are kept fixed in the estimation procedure. Otherwise, they are to be estimated.
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_fixed.mu">fixed.mu</code></td>
<td>

<p>vector containing the values to which the log-means should be fixed if fix.mu==T. The order of components is as follows:
</p>
<p>(mu_type_1_gene_1, mu_type_1_gene_2, ...,
</p>
<p>mu_type_2_gene_1, mu_type_2_gene_2, ...).
</p>
<p>This argument needs to be specified only when fix.mu==T.
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_par.range">par.range</code></td>
<td>

<p>range from which the parameter values should be randomly drawn if there is no knowledge from previous iterations of the search algorithm available. This is a matrix with the number of rows being equal to the number of model parameters. The first column contains the lower bound, the second column the upper bound. If par.range==NULL, some rather large range is defined.
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_prev.result">prev.result</code></td>
<td>

<p>can contain results from former calls of this function
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_loops">loops</code></td>
<td>

<p>maximal number of loops carried out in the estimation procedure. Each loops involves various methods to determine the high-likelihood region.
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_until.convergence">until.convergence</code></td>
<td>

<p>if TRUE, the estimation process is terminated if there had been no improvement concerning the value of the target function between two consecutive loops. Otherwise, the estimation procedure is terminated according to the parameter &quot;loops&quot;.
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_print.output">print.output</code></td>
<td>

<p>if TRUE, interim results of the grid search and numerical optimization are printed into the console throughout the estimation procedure
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, profile log-likelihood plots are displayed at the end of the estimation procedure
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_plot.title">plot.title</code></td>
<td>

<p>title of each plot if show.plots==T
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_pdf.file">pdf.file</code></td>
<td>

<p>optional filename. If this is not missing and show.plots==T, the profile log-likelihoods will be plotted into this file.
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_use.constraints">use.constraints</code></td>
<td>

<p>if TRUE, constraints on the individual population densities are applied; see <code>penalty.constraint.LNLN</code>, <code>penalty.constraint.rLNLN</code> and <br /> <code>penalty.constraint.EXPLN</code> for details.
</p>
</td></tr>
<tr><td><code id="stochprof.loop_+3A_subgroups">subgroups</code></td>
<td>

<p>list of sets of gene numbers. This parameter should be given only when the present call of <code>stochprof.loop</code> is based on a subanalysis of the subgroups of genes with non-fixed mu. The parameter is used only for calculation of the adjusted BIC which takes into account the number of parameters that had to be estimated during the whole estimation procedure: First, for each of the subclusters, and then for the final analysis.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function carries out maximum likelihood estimation for the parameters of the stochastic profiling model. Because the log-likelihood function is potentially multimodal, no straightforward use of gradient-based approaches for finding globally optimal parameter combinations is possible. To tackle this challenge, this function performs a two-step estimation procedure: First, it computes the log-likelihood function at randomly drawn parameter combinations to identify high-likelihood regions in parameter space at computationally  low cost. Then, it uses the Nelder-Mead algorithm to identify local maxima of the likelihood function. The starting values for this algorithm are randomly drawn from the high-likelihood regions determined in the first step. To further localize the global optimum, the function again performs grid searches of the parameter space, this time around the optimum identified by the Nelder-Mead algorithm. This search creates another space to identify high-likelihood regions, which are then used to seed another Nelder-Mead optimization.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table>
<tr><td><code>mle</code></td>
<td>
<p>maximum likelihood estimate</p>
</td></tr>
<tr><td><code>neg-loglikeli</code></td>
<td>
<p>value of the negative log-likelihood function at maximum likelihood estimate</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>approximate marginal maximum likelihood confidence intervals for the maximum likelihood estimate</p>
</td></tr>
<tr><td><code>pargrid</code></td>
<td>
<p>matrix containing parameter combinations and according values of the target function</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayesian information criterion value</p>
</td></tr>
<tr><td><code>adj.bic</code></td>
<td>
<p>adjusted Bayesian information criterion value which takes into account the numbers of parameters that were estimated during the preanalysis of a gene cluster. Is only calculated if parameter <code>subgroups</code> is given, otherwise set to NULL.</p>
</td></tr>
<tr><td><code>pen</code></td>
<td>
<p>penalization for densities not fulfilling required constraints. If <code>use.constraints</code> is FALSE, this has no practical meaning. If <code>use.constraints</code> is TRUE, this value is included in <code>loglikeli</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='stochprof.results.EXPLN'>
Evaluation of results from estimation of EXP-LN model
</h2><span id='topic+stochprof.results.EXPLN'></span>

<h3>Description</h3>

<p>Evaluates the set of results that are passed to this function. That means, it removes entries where the target function is equal to infinity, it removes double entries, it removes unlikely parameter combinations (if there are too many) etc., and it sorts the data. When show.plots==T, the results are graphically displayed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stochprof.results.EXPLN(prev.result, TY, show.plots = T, plot.title = "",
   pdf.file, fix.mu = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stochprof.results.EXPLN_+3A_prev.result">prev.result</code></td>
<td>

<p>contains parameter combinations and the respective value of the target function. It is typically the output of 'stochprof.search.EXPLN'.
</p>
</td></tr>
<tr><td><code id="stochprof.results.EXPLN_+3A_ty">TY</code></td>
<td>

<p>number of types of cells assumed in the model
</p>
</td></tr>
<tr><td><code id="stochprof.results.EXPLN_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, the results are plotted. In particular, one plot is produced for each parameter, with the value of the parameter plotted against the value of the target function. This is not exactly the profile log-likelihood function because there is no conditioning on the other parameters being equal to the ML estimate. If the estimation procedure has converged, however, one can recognize the shape of the profile log-likelihood from these plots. A red bar indicates the position of the maximum likelihood estimator.
</p>
</td></tr>
<tr><td><code id="stochprof.results.EXPLN_+3A_plot.title">plot.title</code></td>
<td>

<p>title of each plot if show.plots==T
</p>
</td></tr>
<tr><td><code id="stochprof.results.EXPLN_+3A_pdf.file">pdf.file</code></td>
<td>

<p>plots will be written into this file when this argument is not missing. The file has to include the entire path.
</p>
</td></tr>
<tr><td><code id="stochprof.results.EXPLN_+3A_fix.mu">fix.mu</code></td>
<td>

<p>if TRUE, the log-mean of the lognormal distributions has been kept fixed. In that case, no plots will be produced for these parameters.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with sorted and evaluated results. The columns are exactly the same as those in 'prev.result'. The first row contains the best estimate.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='stochprof.results.LNLN'>
Evaluation of results from estimation of LN-LN model
</h2><span id='topic+stochprof.results.LNLN'></span>

<h3>Description</h3>

<p>Evaluates the set of results that are passed to this function. That means, it removes entries where the target function is equal to infinity, it removes double entries, it removes unlikely parameter combinations (if there are too many) etc., and it sorts the data. When show.plots==T, the results are graphically displayed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stochprof.results.LNLN(prev.result, TY, show.plots = T, plot.title = "",
   pdf.file, fix.mu = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stochprof.results.LNLN_+3A_prev.result">prev.result</code></td>
<td>

<p>contains parameter combinations and the respective value of the target function. It is typically the output of 'stochprof.search.LNLN'.
</p>
</td></tr>
<tr><td><code id="stochprof.results.LNLN_+3A_ty">TY</code></td>
<td>

<p>number of types of cells assumed in the model
</p>
</td></tr>
<tr><td><code id="stochprof.results.LNLN_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, the results are plotted. In particular, one plot is produced for each parameter, with the value of the parameter plotted against the value of the target function. This is not exactly the profile log-likelihood function because there is no conditioning on the other parameters being equal to the ML estimate. If the estimation procedure has converged, however, one can recognize the shape of the profile log-likelihood from these plots. A red bar indicates the position of the maximum likelihood estimator.
</p>
</td></tr>
<tr><td><code id="stochprof.results.LNLN_+3A_plot.title">plot.title</code></td>
<td>

<p>title of each plot if show.plots==T
</p>
</td></tr>
<tr><td><code id="stochprof.results.LNLN_+3A_pdf.file">pdf.file</code></td>
<td>

<p>plots will be written into this file when this argument is not missing. The file has to include the entire path.
</p>
</td></tr>
<tr><td><code id="stochprof.results.LNLN_+3A_fix.mu">fix.mu</code></td>
<td>

<p>if TRUE, the log-mean of the lognormal distributions has been kept fixed. In that case, no plots will be produced for these parameters.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with sorted and evaluated results. The columns are exactly the same as those in 'prev.result'. The first row contains the best estimate.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='stochprof.results.rLNLN'>
Evaluation of results from estimation of rLN-LN model
</h2><span id='topic+stochprof.results.rLNLN'></span>

<h3>Description</h3>

<p>Evaluates the set of results that are passed to this function. That means, it removes entries where the target function is equal to infinity, it removes double entries, it removes unlikely parameter combinations (if there are too many) etc., and it sorts the data. When show.plots==T, the results are graphically displayed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stochprof.results.rLNLN(prev.result, TY, show.plots = T, plot.title = "",
   pdf.file, fix.mu = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stochprof.results.rLNLN_+3A_prev.result">prev.result</code></td>
<td>

<p>contains parameter combinations and the respective value of the target function. It is typically the output of 'stochprof.search.rLNLN'.
</p>
</td></tr>
<tr><td><code id="stochprof.results.rLNLN_+3A_ty">TY</code></td>
<td>

<p>number of types of cells assumed in the model
</p>
</td></tr>
<tr><td><code id="stochprof.results.rLNLN_+3A_show.plots">show.plots</code></td>
<td>

<p>if TRUE, the results are plotted. In particular, one plot is produced for each parameter, with the value of the parameter plotted against the value of the target function. This is not exactly the profile log-likelihood function because there is no conditioning on the other parameters being equal to the ML estimate. If the estimation procedure has converged, however, one can recognize the shape of the profile log-likelihood from these plots. A red bar indicates the position of the maximum likelihood estimator.
</p>
</td></tr>
<tr><td><code id="stochprof.results.rLNLN_+3A_plot.title">plot.title</code></td>
<td>

<p>title of each plot if show.plots==T
</p>
</td></tr>
<tr><td><code id="stochprof.results.rLNLN_+3A_pdf.file">pdf.file</code></td>
<td>

<p>plots will be written into this file when this argument is not missing. The file has to include the entire path.
</p>
</td></tr>
<tr><td><code id="stochprof.results.rLNLN_+3A_fix.mu">fix.mu</code></td>
<td>

<p>if TRUE, the log-mean of the lognormal distributions has been kept fixed. In that case, no plots will be produced for these parameters.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with sorted and evaluated results. The columns are exactly the same as those in 'prev.result'. The first row contains the best estimate.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='stochprof.search.EXPLN'>
Calculation of the log likelihood function of the EXP-LN model
</h2><span id='topic+stochprof.search.EXPLN'></span>

<h3>Description</h3>

<p>Calculates the log likelihood function of the parameters of the EXP-LN model for a given dataset at certain parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stochprof.search.EXPLN(dataset, n, TY, method = "grid", M = 10,
   par.range = NULL, prev.result = NULL, fix.mu = F, fixed.mu,
   genenames = NULL, print.output = F, use.constraints = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stochprof.search.EXPLN_+3A_dataset">dataset</code></td>
<td>

<p>matrix which contains the cumulated expression data over all cells in a tissue sample. Columns represent genes, rows represent tissue samples.
</p>
</td></tr>
<tr><td><code id="stochprof.search.EXPLN_+3A_n">n</code></td>
<td>

<p>number of cells taken from each tissue sample. This can also be a vector stating how many cells are in each sample separatly
</p>
</td></tr>
<tr><td><code id="stochprof.search.EXPLN_+3A_ty">TY</code></td>
<td>

<p>number of types of cells that is assumed in the stochastic model
</p>
</td></tr>
<tr><td><code id="stochprof.search.EXPLN_+3A_method">method</code></td>
<td>

<p>determines whether a grid search or the Nelder-Mead algorithm should be applied:
If method==&quot;grid&quot;, the log likelihood function is simply evaluated at certain parameter values that are randomly drawn. If method==&quot;optim&quot;, a Nelder-Mead search starts at a randomly drawn set of parameter values in order to find a local maximum. The resulting locally optimal parameter is stored in the results matrix as one row.
</p>
</td></tr>
<tr><td><code id="stochprof.search.EXPLN_+3A_m">M</code></td>
<td>

<p>number of randomly drawn parameter combinations
</p>
</td></tr>
<tr><td><code id="stochprof.search.EXPLN_+3A_par.range">par.range</code></td>
<td>

<p>range from which the parameter values should be randomly drawn. This is a matrix with the number of rows being equal to the number of model parameters. The first columns contains the lower bound, the second column the upper bound. If par.range==NULL, some rather large range is defined.
</p>
</td></tr>
<tr><td><code id="stochprof.search.EXPLN_+3A_prev.result">prev.result</code></td>
<td>

<p>can contain results from former calls of this function
</p>
</td></tr>
<tr><td><code id="stochprof.search.EXPLN_+3A_fix.mu">fix.mu</code></td>
<td>

<p>if TRUE, the log-means are kept fixed in the estimation procedure. Otherwise, they are to be estimated.
</p>
</td></tr>
<tr><td><code id="stochprof.search.EXPLN_+3A_fixed.mu">fixed.mu</code></td>
<td>

<p>vector containing the values to which the log-means should be fixed if fix.mu==T. The order of components is as follows:
</p>
<p>(mu_type_1_gene_1, mu_type_1_gene_2, ...,
</p>
<p>mu_type_2_gene_1, mu_type_2_gene_2, ...).
</p>
<p>This argument needs to be specified only when fix.mu==T.
</p>
</td></tr>
<tr><td><code id="stochprof.search.EXPLN_+3A_genenames">genenames</code></td>
<td>

<p>names of the genes in the dataset. For genenames==NULL, the genes will simply be enumerated according to the column numbers in the dataset.
</p>
</td></tr>
<tr><td><code id="stochprof.search.EXPLN_+3A_print.output">print.output</code></td>
<td>

<p>if TRUE, interim results of the grid search and numerical optimization are printed into the console throughout the estimation procedure
</p>
</td></tr>
<tr><td><code id="stochprof.search.EXPLN_+3A_use.constraints">use.constraints</code></td>
<td>

<p>if TRUE, constraints on the individual population densities are applied; see <code>penalty.constraint.EXPLN</code> for details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values at which the target function is calculated are randomly drawn from some range specified by &quot;par.range&quot;. If method==&quot;grid&quot;, the target function is simply evaluated
at such a randomly drawn parameter vector. If method==&quot;optim&quot;, this randomly drawn vector is
passed to the Nelder-Mead algorithm as a starting value in order to search for a local
maximum around it.
</p>


<h3>Value</h3>

<p>A matrix with the following entries: Each row corresponds to one parameter combination. All columns but the last one contain the parameter values at which the log likelihood function has been computed. The column names are the parameter names. The last column (&quot;target&quot;) is the negative log likelihood function computed at the respective parameter vector. For numerical  reasons, this target value is set to the minimum of 10^7 and the actual value.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='stochprof.search.LNLN'>
Calculation of the log likelihood function of the LN-LN model
</h2><span id='topic+stochprof.search.LNLN'></span>

<h3>Description</h3>

<p>Calculates the log likelihood function of the parameters of the LN-LN model for a given dataset at certain parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stochprof.search.LNLN(dataset, n, TY, method = "grid", M = 10,
   par.range = NULL, prev.result = NULL, fix.mu = F, fixed.mu,
   genenames = NULL, print.output = F, use.constraints = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stochprof.search.LNLN_+3A_dataset">dataset</code></td>
<td>

<p>matrix which contains the cumulated expression data over all cells in a tissue sample. Columns represent genes, rows represent tissue samples.
</p>
</td></tr>
<tr><td><code id="stochprof.search.LNLN_+3A_n">n</code></td>
<td>

<p>number of cells taken from each tissue sample. This can also be a vector stating how many cells are in each sample separatly
</p>
</td></tr>
<tr><td><code id="stochprof.search.LNLN_+3A_ty">TY</code></td>
<td>

<p>number of types of cells that is assumed in the stochastic model
</p>
</td></tr>
<tr><td><code id="stochprof.search.LNLN_+3A_method">method</code></td>
<td>

<p>determines whether a grid search or the Nelder-Mead algorithm should be applied:
If method==&quot;grid&quot;, the log likelihood function is simply evaluated at certain parameter values that are randomly drawn. If method==&quot;optim&quot;, a Nelder-Mead search starts at a randomly drawn set of parameter values in order to find a local maximum. The resulting locally optimal parameter is stored in the results matrix as one row.
</p>
</td></tr>
<tr><td><code id="stochprof.search.LNLN_+3A_m">M</code></td>
<td>

<p>number of randomly drawn parameter combinations
</p>
</td></tr>
<tr><td><code id="stochprof.search.LNLN_+3A_par.range">par.range</code></td>
<td>

<p>range from which the parameter values should be randomly drawn. This is a matrix with the number of rows being equal to the number of model parameters. The first columns contains the lower bound, the second column the upper bound. If par.range==NULL, some rather large range is defined.
</p>
</td></tr>
<tr><td><code id="stochprof.search.LNLN_+3A_prev.result">prev.result</code></td>
<td>

<p>can contain results from former calls of this function
</p>
</td></tr>
<tr><td><code id="stochprof.search.LNLN_+3A_fix.mu">fix.mu</code></td>
<td>

<p>if TRUE, the log-means are kept fixed in the estimation procedure. Otherwise, they are to be estimated.
</p>
</td></tr>
<tr><td><code id="stochprof.search.LNLN_+3A_fixed.mu">fixed.mu</code></td>
<td>

<p>vector containing the values to which the log-means should be fixed if fix.mu==T. The order of components is as follows:
</p>
<p>(mu_type_1_gene_1, mu_type_1_gene_2, ...,
</p>
<p>mu_type_2_gene_1, mu_type_2_gene_2, ...).
</p>
<p>This argument needs to be specified only when fix.mu==T.
</p>
</td></tr>
<tr><td><code id="stochprof.search.LNLN_+3A_genenames">genenames</code></td>
<td>

<p>names of the genes in the dataset. For genenames==NULL, the genes will simply be enumerated according to the column numbers in the dataset.
</p>
</td></tr>
<tr><td><code id="stochprof.search.LNLN_+3A_print.output">print.output</code></td>
<td>

<p>if TRUE, interim results of the grid search and numerical optimization are printed into the console throughout the estimation procedure
</p>
</td></tr>
<tr><td><code id="stochprof.search.LNLN_+3A_use.constraints">use.constraints</code></td>
<td>

<p>if TRUE, constraints on the individual population densities are applied; see <code>penalty.constraint.LNLN</code> for details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values at which the target function is calculated are randomly drawn from some range specified by &quot;par.range&quot;. If method==&quot;grid&quot;, the target function is simply evaluated
at such a randomly drawn parameter vector. If method==&quot;optim&quot;, this randomly drawn vector is
passed to the Nelder-Mead algorithm as a starting value in order to search for a local
maximum around it.
</p>


<h3>Value</h3>

<p>A matrix with the following entries: Each row corresponds to one parameter combination. All columns but the last one contain the parameter values at which the log likelihood function has been computed. The column names are the parameter names. The last column (&quot;target&quot;) is the negative log likelihood function computed at the respective parameter vector. For numerical  reasons, this target value is set to the minimum of 10^7 and the actual value.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='stochprof.search.rLNLN'>
Calculation of the log likelihood function of the rLN-LN model
</h2><span id='topic+stochprof.search.rLNLN'></span>

<h3>Description</h3>

<p>Calculates the log likelihood function of the parameters of the rLN-LN model for a given dataset at certain parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stochprof.search.rLNLN(dataset, n, TY, method = "grid", M = 10,
   par.range = NULL, prev.result = NULL, fix.mu = F, fixed.mu,
   genenames = NULL, print.output = F, use.constraints = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stochprof.search.rLNLN_+3A_dataset">dataset</code></td>
<td>

<p>matrix which contains the cumulated expression data over all cells in a tissue sample. Columns represent genes, rows represent tissue samples.
</p>
</td></tr>
<tr><td><code id="stochprof.search.rLNLN_+3A_n">n</code></td>
<td>

<p>number of cells taken from each tissue sample. This can also be a vector stating how many cells are in each sample separatly
</p>
</td></tr>
<tr><td><code id="stochprof.search.rLNLN_+3A_ty">TY</code></td>
<td>

<p>number of types of cells that is assumed in the stochastic model
</p>
</td></tr>
<tr><td><code id="stochprof.search.rLNLN_+3A_method">method</code></td>
<td>

<p>determines whether a grid search or the Nelder-Mead algorithm should be applied:
If method==&quot;grid&quot;, the log likelihood function is simply evaluated at certain parameter values that are randomly drawn. If method==&quot;optim&quot;, a Nelder-Mead search starts at a randomly drawn set of parameter values in order to find a local maximum. The resulting locally optimal parameter is stored in the results matrix as one row.
</p>
</td></tr>
<tr><td><code id="stochprof.search.rLNLN_+3A_m">M</code></td>
<td>

<p>number of randomly drawn parameter combinations
</p>
</td></tr>
<tr><td><code id="stochprof.search.rLNLN_+3A_par.range">par.range</code></td>
<td>

<p>range from which the parameter values should be randomly drawn. This is a matrix with the number of rows being equal to the number of model parameters. The first columns contains the lower bound, the second column the upper bound. If par.range==NULL, some rather large range is defined.
</p>
</td></tr>
<tr><td><code id="stochprof.search.rLNLN_+3A_prev.result">prev.result</code></td>
<td>

<p>can contain results from former calls of this function
</p>
</td></tr>
<tr><td><code id="stochprof.search.rLNLN_+3A_fix.mu">fix.mu</code></td>
<td>

<p>if TRUE, the log-means are kept fixed in the estimation procedure. Otherwise, they are to be estimated.
</p>
</td></tr>
<tr><td><code id="stochprof.search.rLNLN_+3A_fixed.mu">fixed.mu</code></td>
<td>

<p>vector containing the values to which the log-means should be fixed if fix.mu==T. The order of components is as follows:
</p>
<p>(mu_type_1_gene_1, mu_type_1_gene_2, ...,
</p>
<p>mu_type_2_gene_1, mu_type_2_gene_2, ...).
</p>
<p>This argument needs to be specified only when fix.mu==T.
</p>
</td></tr>
<tr><td><code id="stochprof.search.rLNLN_+3A_genenames">genenames</code></td>
<td>

<p>names of the genes in the dataset. For genenames==NULL, the genes will simply be enumerated according to the column numbers in the dataset.
</p>
</td></tr>
<tr><td><code id="stochprof.search.rLNLN_+3A_print.output">print.output</code></td>
<td>

<p>if TRUE, interim results of the grid search and numerical optimization are printed into the console throughout the estimation procedure
</p>
</td></tr>
<tr><td><code id="stochprof.search.rLNLN_+3A_use.constraints">use.constraints</code></td>
<td>

<p>if TRUE, constraints on the individual population densities are applied; see <code>penalty.constraint.rLNLN</code> for details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values at which the target function is calculated are randomly drawn from some range specified by &quot;par.range&quot;. If method==&quot;grid&quot;, the target function is simply evaluated
at such a randomly drawn parameter vector. If method==&quot;optim&quot;, this randomly drawn vector is
passed to the Nelder-Mead algorithm as a starting value in order to search for a local
maximum around it.
</p>


<h3>Value</h3>

<p>A matrix with the following entries: Each row corresponds to one parameter combination. All columns but the last one contain the parameter values at which the log likelihood function has been computed. The column names are the parameter names. The last column (&quot;target&quot;) is the negative log likelihood function computed at the respective parameter vector. For numerical  reasons, this target value is set to the minimum of 10^7 and the actual value.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>

<hr>
<h2 id='stochprofML-package'>
Stochastic Profiling using Maximum Likelihood Estimation
</h2><span id='topic+stochprofML-package'></span><span id='topic+stochprofML'></span>

<h3>Description</h3>

<p>This package accompanies the paper &quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar, Christiane Fuchs, Andreas Roller, Fabian J Theis and Kevin A Janes (PNAS 2014, 111(5), E626-635). In that work, we measure expression profiles from small heterogeneous populations of cells. Each cell is assumed to be from a mixture of lognormal and exponential distributions (see details). We perform maximum likelihood estimation in order to infer the mixture ratio and the parameters of the lognormal/exponential distributions from the cumulated expression measurements.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> stochprofML</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-05-07</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>There are three stochastic profiling models: The lognormal-lognormal (LN-LN) model assumes that each cell is from a mixture of one or more lognormal distributions with different log-means but identical log-standard deviations. In the relaxed lognormal-lognormal (rLN-LN) model, the log-standard deviations are not necessarily identical. The exponential-lognormal (EXP-LN) model considers the mixture of zero, one or more lognormal distributions and one exponential distribution.
</p>
<p>The user can immediately start with data generation and model estimation using the two functions <code>stochasticProfilingData</code> and <code>stochasticProfilingML</code>, respectively. These functions prompt the user to input the settings/data. Typical analyses are then performed without the user having to delve into the structure of this package.
</p>
<p>When not using one the above two functions, parameters can be estimated calling <code>stochprof.loop</code>, which again utilizes three other functions: <code>stochprof.search.LNLN</code>/ <code>stochprof.search.rLNLN</code>/ <code>stochprof.search.EXPLN</code> in order to calculate and locally optimize the likelihood function; <br /> <code>stochprof.results.LNLN</code>/ <code>stochprof.results.rLNLN</code>/ <code>stochprof.results.EXPLN</code> for evaluating these results; and <code>calculate.ci.LNLN</code>/ <code>calculate.ci.rLNLN</code>/ <code>calculate.ci.EXPLN</code> for calculating confidence intervals.
</p>
<p>Two essential functions are <code>r.sum.of.mixtures.LNLN</code>/ <code>r.sum.of.mixtures.rLNLN</code>/ <br /> <code>r.sum.of.mixtures.EXPLN</code> and <code>d.sum.of.mixtures.LNLN</code>/ <code>d.sum.of.mixtures.rLNLN</code>/ <br /> <code>d.sum.of.mixtures.EXPLN</code> for the density and random number generation of the distribution assumed for all measurements in the stochastic profiling model.
</p>
<p>Version 2.0 shows one significant extension to previous versions: The number of cells <code>n</code> in the input data does no longer need to be the same over all samples.
</p>
<p>The package provides four datasets: <code>sod2</code>, containing real measurements for one gene, and <br /> <code>toycluster.LNLN</code>/ <code>toycluster.rLNLN</code>/ <code>toycluster.EXPLN</code>, containing artificial data for 12 genes generated with the three stochastic profiling models.
</p>
<p>Examples for typical analyses are given below.
</p>


<h3>Author(s)</h3>

<p>Lisa Amrhein, Christiane Fuchs
</p>
<p>Maintainer: Lisa Amrhein &lt;amrheinlisa@gmail.com&gt;
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors) &lt;doi:10.1073/pnas.1311647111&gt;
</p>
<p>&quot;Pheno-seq - linking visual features and gene expression in 3D cell culture systems&quot; by Stephan M. Tirier, Jeongbin Park, Friedrich Preusser, Lisa Amrhein, Zuguang Gu, Simon Steiger, Jan-Philipp Mallm, Teresa Krieger, Marcel Waschow, Bjoern Eismann, Marta Gut, Ivo G. Gut, Karsten Rippe, Matthias Schlesner, Fabian Theis, Christiane Fuchs, Claudia R. Ball, Hanno Glimm, Roland Eils &amp; Christian Conrad: Sci Rep 9, 12367 (2019) &lt;doi:10.1038/s41598-019-48771-4&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Generate synthetic data. The user is prompted to input all settings.
stochasticProfilingData()

# Estimate a stochastic profiling model. The user is prompted to input the data
# and other parameters.
stochasticProfilingML()

# Generate a synthetic dataset (without measurement error) for one gene
# and estimate the parameters from this data.
generate.toydata()

# Estimate the model parameters for the SOD2 dataset.
analyze.sod2()

# Estimate the model parameters for the 12-gene toycluster.
analyze.toycluster()

## End(Not run)
</code></pre>

<hr>
<h2 id='toycluster.EXPLN'>
Synthetic data from the EXP-LN model
</h2><span id='topic+toycluster.EXPLN'></span>

<h3>Description</h3>

<p>A matrix containing synthetic measurements from the stochastic profiling EXP-LN model. There is data for 12 genes (columns) and 16 tissue samples (rows). Each measurement is the sum of 10 i.i.d. random variables from a mixture of one lognormal and one exponential distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(toycluster.EXPLN)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:16, 1:12] 3.77 4.87 5.05 4.45 5.35 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:16] &quot;V1&quot; &quot;V2&quot; &quot;V3&quot; &quot;V4&quot; ...
..$ : chr [1:12] &quot;gene 1&quot; &quot;gene 2&quot; &quot;gene 3&quot; &quot;gene 4&quot; ...
</p>


<h3>Details</h3>

<p>The true underlying parameters are:
</p>
<p>TY = 2, i.e. there are two types of cells
</p>
<p>p = (0.225, 0.775), that is the probability for cell type I and II, respectively
</p>
<p>mu = (0.1223, 0.2705, 2.1457, 2.2899, 1.6791, 1.1558, 2.4035, 0.1998, 0.9648, 0.0411, 1.4798, 1.4206), that is the log-mean for cell type I for genes 1 to 12
</p>
<p>sigma = 0.225, that is the log-standard deviation for type I
</p>
<p>lambda = (5.5522, 31.5412, 21.2097, 6.1446, 49.0361, 10.9487, 29.7759, 43.8547, 35.7143, 6.5736, 24.8089, 24.7922), that is the exponential rate for cell type II for genes 1 to 12
</p>


<h3>Source</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors)
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(toycluster.EXPLN)
par(mfrow=c(3,4))
for (i in 1:ncol(toycluster.EXPLN)) {
   hist(toycluster.EXPLN[,i],xlab="synthetic data from EXP-LN model",
      main=colnames(toycluster.EXPLN)[i],col="grey")
}
par(mfrow=c(1,1))
</code></pre>

<hr>
<h2 id='toycluster.LNLN'>
Synthetic data from the LN-LN model
</h2><span id='topic+toycluster.LNLN'></span>

<h3>Description</h3>

<p>A matrix containing synthetic measurements from the stochastic profiling LN-LN model. There is data for 12 genes (columns) and 16 tissue samples (rows). Each measurement is the sum of 10 i.i.d. random variables from a mixture of lognormal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(toycluster.LNLN)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:16, 1:12] 0.789 4.698 4.643 8.734 12.458 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:16] &quot;V1&quot; &quot;V2&quot; &quot;V3&quot; &quot;V4&quot; ...
..$ : chr [1:12] &quot;gene 1&quot; &quot;gene 2&quot; &quot;gene 3&quot; &quot;gene 4&quot; ...
</p>


<h3>Details</h3>

<p>The true underlying parameters are:
</p>
<p>TY = 2, i.e. there are two types of cells
</p>
<p>p = (0.225, 0.775), that is the probability for cell type I and II, respectively
</p>
<p>mu1 = (1.8853, 2.2758, 0.4748, 0.2658, 1.5745, 2.3938, 1.7389, 2.2148, 0.2104, 2.1032, 0.0638, 1.8109), that is the log-mean for cell type I for genes 1 to 12
</p>
<p>mu2 = (-2.6637, -0.6590, -1.6308, -2.0753, -1.5786, -0.8131, -2.4872, -3.4486, -3.4865, -2.1848, -1.3868, -2.8238), that is the log-mean for cell type II for genes 1 to 12
</p>
<p>sigma = 0.225, that is the log-standard deviation for both cell types
</p>


<h3>Source</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors)
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(toycluster.LNLN)
par(mfrow=c(3,4))
for (i in 1:ncol(toycluster.LNLN)) {
   hist(toycluster.LNLN[,i],xlab="synthetic data from LN-LN model",
      main=colnames(toycluster.LNLN)[i],col="grey")
}
par(mfrow=c(1,1))
</code></pre>

<hr>
<h2 id='toycluster.rLNLN'>
Synthetic data from the rLN-LN model
</h2><span id='topic+toycluster.rLNLN'></span>

<h3>Description</h3>

<p>A matrix containing synthetic measurements from the stochastic profiling rLN-LN model. There is data for 12 genes (columns) and 16 tissue samples (rows). Each measurement is the sum of 10 i.i.d. random variables from a mixture of lognormal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(toycluster.rLNLN)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:16, 1:12] 3.46 2.34 3.98 3.42 3.43 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:16] &quot;V1&quot; &quot;V2&quot; &quot;V3&quot; &quot;V4&quot; ...
..$ : chr [1:12] &quot;gene 1&quot; &quot;gene 2&quot; &quot;gene 3&quot; &quot;gene 4&quot; ...
</p>


<h3>Details</h3>

<p>The true underlying parameters are:
</p>
<p>TY = 2, i.e. there are two types of cells
</p>
<p>p = (0.225, 0.775), that is the probability for cell type I and II, respectively
</p>
<p>mu1 = (0.1287, 1.6249, 1.0075, 0.5521, 0.1200, 1.1661, 1.4261, 1.8238, 2.4261, 1.2568, 0.9342, 1.8876), that is the log-mean for cell type I for genes 1 to 12
</p>
<p>mu2 = (-2.2181, -1.6432, -0.9966, -3.1968, -1.9852, -1.0545, -2.3596, -3.0939, -1.3195, -3.2041, -1.2185, -1.3895), that is the log-mean for cell type II for genes 1 to 12
</p>
<p>sigma = (0.225,0.625), that are the log-standard deviations for the two cell types
</p>


<h3>Source</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors)
</p>


<h3>References</h3>

<p>&quot;Parameterizing cell-to-cell regulatory heterogeneities via stochastic transcriptional profiles&quot; by Sameer S Bajikar*, Christiane Fuchs*, Andreas Roller, Fabian J Theis^ and Kevin A Janes^: PNAS 2014, 111(5), E626-635 (* joint first authors, ^ joint last authors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(toycluster.rLNLN)
par(mfrow=c(3,4))
for (i in 1:ncol(toycluster.rLNLN)) {
   hist(toycluster.rLNLN[,i],xlab="synthetic data from rLN-LN model",
      main=colnames(toycluster.rLNLN)[i],col="grey")
}
par(mfrow=c(1,1))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
