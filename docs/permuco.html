<!DOCTYPE html><html lang="en"><head><title>Help for package permuco</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {permuco}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aovperm'><p>P-values based on permutation tests for ANOVA and repeated measures ANOVA designs.</p></a></li>
<li><a href='#as.Pmat'><p>Method to convert into <code>Pmat</code> object.</p></a></li>
<li><a href='#attentionshifting_design'><p>Datatset of the design for the data attentionshifting_signal</p></a></li>
<li><a href='#attentionshifting_signal'><p>Dataset containing the event-related potential of the electrod O1 of a control experiment.</p></a></li>
<li><a href='#clusterlm'><p>Cluster-mass test for longitudinal data</p></a></li>
<li><a href='#compute_clusterdepth'><p>Cluster-depth correction</p></a></li>
<li><a href='#compute_clusterdepth_head'><p>Cluster-depth correction (from the head only)</p></a></li>
<li><a href='#compute_clustermass'><p>Clustermass test correction</p></a></li>
<li><a href='#compute_maxT'><p>The max-T correction</p></a></li>
<li><a href='#compute_minP'><p>The min-P correction</p></a></li>
<li><a href='#compute_stepdownmaxT'><p>Step-down version of the max-T correction</p></a></li>
<li><a href='#compute_tfce'><p>Threshold-Free Cluster-Enhancement correction</p></a></li>
<li><a href='#compute_troendle'><p>The Troendle's correction</p></a></li>
<li><a href='#emergencycost'><p>Dataset of cost of emergency patients.</p></a></li>
<li><a href='#get_cluster'><p>Get the ID of the cluster on a distribution matrix</p></a></li>
<li><a href='#jpah2016'><p>Dataset of a control study in psychology.</p></a></li>
<li><a href='#lmperm'><p>Permutation tests for regression parameters</p></a></li>
<li><a href='#plot.clusterlm'><p>Plot cluster or parameters.</p></a></li>
<li><a href='#plot.lmperm'><p>Plot method for class <code>"lmperm"</code>.</p></a></li>
<li><a href='#Pmat'><p>Create a set of permutations/signflips.</p></a></li>
<li><a href='#Pmat_product'><p>Multiplies a vector with a Pmat object</p></a></li>
<li><a href='#print.clusterlm'><p>Print <code>clusterlm</code> object.</p></a></li>
<li><a href='#summary.clusterlm'><p>Summarize of a <code>clusterlm</code> object.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Permutation Tests for Regression, (Repeated Measures)
ANOVA/ANCOVA and Comparison of Signals</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-08-25</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jaromil Frossard &lt;jaromil.frossard@gmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jaromilfrossard/permuco">https://github.com/jaromilfrossard/permuco</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jaromilfrossard/permuco/issues">https://github.com/jaromilfrossard/permuco/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to compute p-values based on permutation tests. Regression, ANOVA and ANCOVA, omnibus F-tests, marginal unilateral and bilateral t-tests are available. Several methods to handle nuisance variables are implemented (Kherad-Pajouh, S., &amp; Renaud, O. (2010) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2010.02.015">doi:10.1016/j.csda.2010.02.015</a>&gt; ; Kherad-Pajouh, S., &amp; Renaud, O. (2014) &lt;<a href="https://doi.org/10.1007%2Fs00362-014-0617-3">doi:10.1007/s00362-014-0617-3</a>&gt; ; Winkler, A. M., Ridgway, G. R., Webster, M. A., Smith, S. M., &amp; Nichols, T. E. (2014) &lt;<a href="https://doi.org/10.1016%2Fj.neuroimage.2014.01.060">doi:10.1016/j.neuroimage.2014.01.060</a>&gt;). An extension for the comparison of signals issued from experimental conditions (e.g. EEG/ERP signals) is provided. Several corrections for multiple testing are possible, including the cluster-mass statistic (Maris, E., &amp; Oostenveld, R. (2007) &lt;<a href="https://doi.org/10.1016%2Fj.jneumeth.2007.03.024">doi:10.1016/j.jneumeth.2007.03.024</a>&gt;) and the threshold-free cluster enhancement (Smith, S. M., &amp; Nichols, T. E. (2009) &lt;<a href="https://doi.org/10.1016%2Fj.neuroimage.2008.03.061">doi:10.1016/j.neuroimage.2008.03.061</a>&gt;). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>permute, Matrix, stats, graphics, Rcpp</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp, testthat, covr, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp, knitr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-25 16:55:19 UTC; Jaro</td>
</tr>
<tr>
<td>Author:</td>
<td>Jaromil Frossard [aut, cre],
  Olivier Renaud [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-25 19:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aovperm'>P-values based on permutation tests for ANOVA and repeated measures ANOVA designs.</h2><span id='topic+aovperm'></span>

<h3>Description</h3>

<p>Provides p-values for omnibus tests based on permutations for factorial and repeated measures ANOVA. This function produces the F statistics, parametric p-values (based, on Gaussian and sphericity assumptions) and p-values based on the permutation methods that handle nuisance variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aovperm(
  formula,
  data = NULL,
  np = 5000,
  method = NULL,
  type = "permutation",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aovperm_+3A_formula">formula</code></td>
<td>
<p>A formula object. The formula for repeated measures ANOVA should be written using the same notation as <a href="stats.html#topic+aov">aov</a> by adding
<code>+Error(id/within)</code>, where <code>id</code> is the factor that identify the subjects and <code>within</code> is the within factors.</p>
</td></tr>
<tr><td><code id="aovperm_+3A_data">data</code></td>
<td>
<p>A data frame or matrix.</p>
</td></tr>
<tr><td><code id="aovperm_+3A_np">np</code></td>
<td>
<p>The number of permutations. Default value is <code>5000</code>.</p>
</td></tr>
<tr><td><code id="aovperm_+3A_method">method</code></td>
<td>
<p>A character string indicating the method used to handle nuisance variables. Default is <code>NULL</code> and will change if to <code>"freedman_lane"</code> for the fixed effects model and <code>"Rd_kheradPajouh_renaud"</code> for the random effect models. See Details for other methods.</p>
</td></tr>
<tr><td><code id="aovperm_+3A_type">type</code></td>
<td>
<p>A character string to specify the type of transformations: &quot;permutation&quot; and &quot;signflip&quot; are available. Is overridden if P is given. See help from Pmat.</p>
</td></tr>
<tr><td><code id="aovperm_+3A_...">...</code></td>
<td>
<p>Futher arguments, see details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following methods are available for the fixed effects model defined as <code class="reqn">y = D\eta + X\beta + \epsilon</code>. If we want to test <code class="reqn">\beta = 0</code> and take into account the effects of the nuisance variables <code class="reqn">D</code>, we transform the data :
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>method</code> argument </td><td style="text-align: center;"> <code class="reqn">y*</code> </td><td style="text-align: center;"> <code class="reqn">D*</code> </td><td style="text-align: center;"> <code class="reqn">X*</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"draper_stoneman"</code> </td><td style="text-align: center;"> <code class="reqn">y</code> </td><td style="text-align: center;"> <code class="reqn">D</code> </td><td style="text-align: center;"> <code class="reqn">PX</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"freedman_lane"</code> </td><td style="text-align: center;"> <code class="reqn">(H_D+PR_D)y</code> </td><td style="text-align: center;"> <code class="reqn">D</code> </td><td style="text-align: center;"> <code class="reqn">X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"manly"</code> </td><td style="text-align: center;"> <code class="reqn">Py</code> </td><td style="text-align: center;"> <code class="reqn">D</code> </td><td style="text-align: center;"> <code class="reqn">X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"terBraak"</code> </td><td style="text-align: center;"> <code class="reqn">(H_{X,D}+PR_{X,D})y</code> </td><td style="text-align: center;"> <code class="reqn">D</code> </td><td style="text-align: center;"> <code class="reqn">X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"kennedy"</code> </td><td style="text-align: center;"> <code class="reqn">PR_D y</code> </td><td style="text-align: center;"> </td><td style="text-align: center;"> <code class="reqn">R_D X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"huh_jhun"</code> </td><td style="text-align: center;"> <code class="reqn">PV'R_Dy</code> </td><td style="text-align: center;"> </td><td style="text-align: center;"> <code class="reqn">V'R_D X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"dekker"</code> </td><td style="text-align: center;"> <code class="reqn">y</code> </td><td style="text-align: center;"> <code class="reqn">D</code> </td><td style="text-align: center;"> <code class="reqn">PR_D X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The following methods are available for the random effects model <code class="reqn">y = D\eta + X\beta + E\kappa + Z\gamma+ \epsilon</code>. If we want to test <code class="reqn">\beta = 0</code> and take into account the effect of the nuisance variable <code class="reqn">D</code> we can transform the data by permutation:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>method</code> argument </td><td style="text-align: center;"> <code class="reqn">y*</code> </td><td style="text-align: center;"> <code class="reqn">D*</code> </td><td style="text-align: center;"> <code class="reqn">X*</code> </td><td style="text-align: center;"> <code class="reqn">E*</code> </td><td style="text-align: center;"> <code class="reqn">Z*</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"Rd_kheradPajouh_renaud"</code> </td><td style="text-align: center;"> <code class="reqn">PR_D y</code> </td><td style="text-align: center;">  </td><td style="text-align: center;"> <code class="reqn">R_D X</code> </td><td style="text-align: center;"> <code class="reqn">R_D E</code> </td><td style="text-align: center;"> <code class="reqn">R_D Z</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"Rde_kheradPajouh_renaud"</code> </td><td style="text-align: center;"> <code class="reqn">PR_{D,E}y</code>  </td><td style="text-align: center;">  </td><td style="text-align: center;"> <code class="reqn">R_{D,E} X</code> </td><td style="text-align: center;">   </td><td style="text-align: center;"> <code class="reqn">R_{D,E}Z</code></td>
</tr>

</table>

<p>Other arguments could be pass in <code>...</code> :<br /> <br />
<code>P</code> : a matrix,  of class <code>matrix</code> or <code>Pmat</code>, containing the permutations (for the reproductibility of the results). The first column must be the identity permutation (not checked). <code>P</code> overwrites <code>np</code> argument. <br />
<code>rnd_rotation</code> : a random matrix of size <code class="reqn">n \times n</code> to compute the rotation used for the <code>"huh_jhun"</code> method.
<code>coding_sum</code> : a logical set to <code>TRUE</code> defining the coding of the design matrix to <code>contr.sum</code> to test the main effects. If it is set to <code>FALSE</code> the design matrix is computed with the coding defined in the dataframe. The tests of simple effets are possible with a coding of the factors of the dataframe set to <code>contr.treatment</code>.<br />
</p>


<h3>Value</h3>

<p>A <code>lmperm</code> object containing most of the objects given in an <a href="stats.html#topic+lm">lm</a> object, an ANOVA table with parametric and permutation p-values, the test statistics and the permutation distributions.
</p>


<h3>Author(s)</h3>

<p>jaromil.frossard@unige.ch
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmperm">lmperm</a></code> <code><a href="#topic+plot.lmperm">plot.lmperm</a></code>
</p>
<p>Other main function: 
<code><a href="#topic+clusterlm">clusterlm</a>()</code>,
<code><a href="#topic+lmperm">lmperm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data
data("emergencycost")

## centrering the covariate to the mean
emergencycost$LOSc &lt;- scale(emergencycost$LOS, scale = FALSE)

## ANCOVA
## Warning : np argument must be greater (recommendation: np&gt;=5000)
mod_cost_0 &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost, np = 2000)
mod_cost_0

## same analysis but with signflip
## Warning : np argument must be greater (recommendation: np&gt;=5000)
mod_cost_0s &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost, type="signflip", np = 2000)
mod_cost_0s

## Testing at 14 days
emergencycost$LOS14 &lt;- emergencycost$LOS - 14

mod_cost_14 &lt;- aovperm(cost ~ LOS14*sex*insurance, data = emergencycost, np = 2000)
mod_cost_14

## Effect of sex within the public insured
contrasts(emergencycost$insurance) &lt;- contr.treatment
contrasts(emergencycost$sex) &lt;- contr.sum
emergencycost$insurance &lt;- relevel(emergencycost$insurance, ref = "public")

mod_cost_se &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost,
                        np = 2000, coding_sum = FALSE)
mod_cost_se


## Repeated measures ANCOVA
## data
data(jpah2016)

## centrering the covariate
jpah2016$bmic &lt;- scale(jpah2016$bmi, scale = FALSE)

## Warning : np argument must be greater (recommendation: np&gt;=5000)
mod_jpah2016 &lt;- aovperm(iapa ~ bmic*condition*time+ Error(id/(time)),
                    data = jpah2016, method = "Rd_kheradPajouh_renaud")
mod_jpah2016


</code></pre>

<hr>
<h2 id='as.Pmat'>Method to convert into <code>Pmat</code> object.</h2><span id='topic+as.Pmat'></span>

<h3>Description</h3>

<p>Convert a matrix into a <code>Pmat</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.Pmat(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.Pmat_+3A_x">x</code></td>
<td>
<p>a matrix.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other pmat: 
<code><a href="#topic+Pmat_product">Pmat_product</a>()</code>,
<code><a href="#topic+Pmat">Pmat</a>()</code>
</p>

<hr>
<h2 id='attentionshifting_design'>Datatset of the design for the data attentionshifting_signal</h2><span id='topic+attentionshifting_design'></span>

<h3>Description</h3>

<p>Design of an experiment measuring the EEG brain activity of 15 participants who have been shown images of neutral and angry faces. Those faces were shown at a different visibility 16ms and 166ms and were displayed either to the left or to the right of a screen. The laterality, sex, age, and 2 measures of anxiety for each subjects are also available. The amplitude of the EEG recording are located in the dataset <a href="#topic+attentionshifting_signal">attentionshifting_signal</a>.
</p>

<ul>
<li><p> id : identifier of the subject.
</p>
</li>
<li><p> visibility : time of exposure to the image (16ms: subliminal or 166ms:supraliminal).
</p>
</li>
<li><p> emotion : type of emotion of the image (angry or neutral).
</p>
</li>
<li><p> direction : position of image one the screen (left or right).
</p>
</li>
<li><p> laterality_id : measure of laterality of the subject.
</p>
</li>
<li><p> age : age of the subject.
</p>
</li>
<li><p> sex : sex of the subject.
</p>
</li>
<li><p> STAIS_state : measure of the state of anxiety of the subject.
</p>
</li>
<li><p> STAIS_trait : measure of the personality trait of anxiety of the subject.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(attentionshifting_design)
</code></pre>


<h3>Format</h3>

<p>A data frame with 120 rows and 10 variables.
</p>


<h3>See Also</h3>

<p>Other dataset: 
<code><a href="#topic+attentionshifting_signal">attentionshifting_signal</a></code>,
<code><a href="#topic+emergencycost">emergencycost</a></code>,
<code><a href="#topic+jpah2016">jpah2016</a></code>
</p>

<hr>
<h2 id='attentionshifting_signal'>Dataset containing the event-related potential of the electrod O1 of a control experiment.</h2><span id='topic+attentionshifting_signal'></span>

<h3>Description</h3>

<p>The ERP of the electrod O1 of an experiment in attention shifting. This dataset contains the amplitude of the signals sampled at 1024 Hz. The design of the experiment is given in the dataset <a href="#topic+attentionshifting_design">attentionshifting_design</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(attentionshifting_signal)
</code></pre>


<h3>Format</h3>

<p>A data frame with 120 rows and 819 variables.
</p>


<h3>Details</h3>


<ul>
<li><p> ERP (in muV) of the electrod O1 measured from -200 to 600 timeframes before and after the onset of the stimulus.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other dataset: 
<code><a href="#topic+attentionshifting_design">attentionshifting_design</a></code>,
<code><a href="#topic+emergencycost">emergencycost</a></code>,
<code><a href="#topic+jpah2016">jpah2016</a></code>
</p>

<hr>
<h2 id='clusterlm'>Cluster-mass test for longitudinal data</h2><span id='topic+clusterlm'></span>

<h3>Description</h3>

<p>Compute the cluster-mass test for longitudinal linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterlm(
  formula,
  data = NULL,
  np = 5000,
  method = NULL,
  type = "permutation",
  test = "fisher",
  threshold = NULL,
  aggr_FUN = NULL,
  multcomp = "clustermass",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clusterlm_+3A_formula">formula</code></td>
<td>
<p>A formula object where the left part is a matrix defined in the global environment.</p>
</td></tr>
<tr><td><code id="clusterlm_+3A_data">data</code></td>
<td>
<p>A data frame for the independent variables.</p>
</td></tr>
<tr><td><code id="clusterlm_+3A_np">np</code></td>
<td>
<p>The number of permutations. Default value is <code>5000</code>.</p>
</td></tr>
<tr><td><code id="clusterlm_+3A_method">method</code></td>
<td>
<p>A character string indicating the method used to handle nuisance variables. Default is <code>NULL</code> and will switch to <code>"freedman_lane"</code> for the fixed effects model and to <code>"Rd_kheradPajouh_renaud"</code> for the repeated measures ANOVA. See <a href="#topic+lmperm">lmperm</a> or <a href="#topic+aovperm">aovperm</a> for details on the permutation methods.</p>
</td></tr>
<tr><td><code id="clusterlm_+3A_type">type</code></td>
<td>
<p>A character string to specify the type of transformations: &quot;permutation&quot; and &quot;signflip&quot; are available. Is overridden if P is given. See help from Pmat.</p>
</td></tr>
<tr><td><code id="clusterlm_+3A_test">test</code></td>
<td>
<p>A character string to specify the name of the test. Default is <code>"fisher"</code>. <code>"t"</code> is available for the fixed effects model.</p>
</td></tr>
<tr><td><code id="clusterlm_+3A_threshold">threshold</code></td>
<td>
<p>A numerical value that specify the threshold for the <code>"clustermass"</code> multiple comparisons procedure. If it is a vector each value will be associated to an effect. If it is scalar the same threshold will be used for each test. Default value is <code>NULL</code> and will compute a threshold based on the 0.95 quantile of the choosen test statistic.</p>
</td></tr>
<tr><td><code id="clusterlm_+3A_aggr_fun">aggr_FUN</code></td>
<td>
<p>A function used as mass function. It should aggregate the statistics of a cluster into one scalar. Default is the sum of squares fot t statistic and sum for F statistic.</p>
</td></tr>
<tr><td><code id="clusterlm_+3A_multcomp">multcomp</code></td>
<td>
<p>A vector of character defining the methods of multiple comparisons to compute. Default is <code>"clustermass"</code>, and the additional options are available : <code>"tfce"</code>,<code>"bonferroni"</code>, <code>"holm"</code>, <code>"troendle"</code>, <code>"minP"</code> and <code>"benjamini_hochberg"</code>.</p>
</td></tr>
<tr><td><code id="clusterlm_+3A_...">...</code></td>
<td>
<p>Futher arguments, see details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The random effects model is only available with a F statistic.<br />
</p>
<p>Other arguments could be pass in <code>...</code> :<br /> <br />
<code>P</code> : A matrix containing the permutation of class <code>matrix</code> or <code>Pmat</code>; which is used for the reproducibility of the results. The first column must be the identity. <code>P</code> overwrites <code>np</code> argument.<br /> <br />
<code>rnd_rotation</code> : A matrix of random value to compute a rotation of size <code class="reqn">n \times n</code> that will be used for the <code>"huh_jhun"</code> method. <br /> <br />
<code>p_scale = FALSE</code> : if set to <code>TRUE</code>, the several multiple comparisons procedures are compute on the <code>1 - p</code> scale, where <code>p</code> is the p-value. The threshold have to be set between 0 and 1 (eg: <code>threshold = 0.95</code>). The function <code>aggr_FUN</code> should be big when there is evidence against the null (eg: <code>aggr_FUN = function(p)sum(abs(log(1-p)))</code>. Moreover under the probability scale the cluster mass statistics is sensitive to the number permutations.<br /> <br />
<code>H</code>, <code>E</code>, <code>ndh</code> : the parameters used for the <code>"tfce"</code> method. Default values are set to <code>H = 2</code> for the height parameter, to <code>E = 0.5</code> for the extend parameter and to <code>ndh = 500</code> for the number terms to approximate the integral.<br /> <br />
<code>alpha = 0.05</code> : the type I error rate. Used for the <code>troendle</code> multiple comparisons procedure.<br /> <br />
<code>return_distribution = FALSE</code> : return the permutation distribution of the statistics. Warnings : return one high dimensional matrices (number of test times number of permutation) for each test.<br />
<code>coding_sum</code> : a logical defining the coding of the design matrix to <code>contr.sum</code>: set by default to <code>TRUE</code> for ANOVA (when the argument <code>test</code> is <code>"fisher"</code> ) to tests main effects and is set to <code>FALSE</code> when <code>test</code> is <code>"t"</code>.  If <code>coding_sum</code> is set to <code>FALSE</code> the design matrix is computed with the coding defined in the dataframe and the tests of simple effets are possible with a coding of the dataframe set to <code>contr.treatment</code>. <br />
</p>


<h3>Value</h3>

<p>A <code>clusterlm</code> object. Use the <a href="#topic+plot.clusterlm">plot.clusterlm</a> or <a href="#topic+summary.clusterlm">summary.clusterlm</a> method to see results of the tests.
</p>


<h3>Author(s)</h3>

<p>jaromil.frossard@unige.ch
</p>


<h3>References</h3>

<p>Maris, E., &amp; Oostenveld, R. (2007). Nonparametric statistical testing of EEG-and MEG-data. Journal of neuroscience methods, 164(1), 177-190.
</p>
<p>Smith, S. M., &amp; Nichols, T. E. (2009). Threshold-free cluster enhancement: addressing problems of smoothing, threshold dependence and localisation in cluster inference. Neuroimage, 44(1), 83-98.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.clusterlm">plot.clusterlm</a></code> <code><a href="#topic+summary.clusterlm">summary.clusterlm</a></code>
</p>
<p>Other main function: 
<code><a href="#topic+aovperm">aovperm</a>()</code>,
<code><a href="#topic+lmperm">lmperm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Cluster-mass for repeated measures ANOVA
## Warning : np argument must be greater (recommendation: np &gt;= 5000)
electrod_O1 &lt;- clusterlm(attentionshifting_signal ~ visibility*emotion*direction
         + Error(id/(visibility*emotion*direction)), data = attentionshifting_design,
         np = 50)

## Results
plot(electrod_O1)

## Results with labels on the x axis that represent seconds from time-locked event:
plot(electrod_O1, nbbaselinepts = 200, nbptsperunit = 1024)

## Tables of clusters
electrod_O1

## Not run: 
## Change the function of the aggregation

## Sum of squares of F statistics
electrod_O1_sum &lt;- clusterlm(attentionshifting_signal ~ visibility*emotion*direction
         + Error(id/(visibility*emotion*direction)), data = attentionshifting_design,
         aggr_FUN = function(x)sum(x^2))

## Length of the cluster
electrod_O1_length &lt;- clusterlm(attentionshifting_signal ~ visibility*emotion*direction
         + Error(id/(visibility*emotion*direction)), data = attentionshifting_design,
         aggr_FUN = function(x)length(x))


## All multiple comparisons procedures for repeated measures ANOVA
## Permutation method "Rde_kheradPajouh_renaud"
full_electrod_O1 &lt;- clusterlm(attentionshifting_signal ~ visibility*emotion*direction
          + Error(id/(visibility*emotion*direction)), data = attentionshifting_design,
          method = "Rde_kheradPajouh_renaud", multcomp = c("troendle", "tfce",
          "clustermass", "bonferroni", "holm", "benjamini_hochberg"))

## End(Not run)

</code></pre>

<hr>
<h2 id='compute_clusterdepth'>Cluster-depth correction</h2><span id='topic+compute_clusterdepth'></span>

<h3>Description</h3>

<p>Compute the clusterdepth test correction given a matrix a permuted statistical signals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_clusterdepth(distribution, threshold, alternative = "two.sided")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_clusterdepth_+3A_distribution">distribution</code></td>
<td>
<p>A matrix of permuted statistical signal. The first row indicating the observed statistics.</p>
</td></tr>
<tr><td><code id="compute_clusterdepth_+3A_threshold">threshold</code></td>
<td>
<p>A scalar that represents the threshold to create the clusters.</p>
</td></tr>
<tr><td><code id="compute_clusterdepth_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the alternative hypothesis. Default is <code>"greater"</code>. Choose between <code>"greater"</code>, <code>"less"</code> or <code>"two.sided"</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other multcomp: 
<code><a href="#topic+compute_clusterdepth_head">compute_clusterdepth_head</a>()</code>,
<code><a href="#topic+compute_clustermass">compute_clustermass</a>()</code>,
<code><a href="#topic+compute_maxT">compute_maxT</a>()</code>,
<code><a href="#topic+compute_minP">compute_minP</a>()</code>,
<code><a href="#topic+compute_stepdownmaxT">compute_stepdownmaxT</a>()</code>,
<code><a href="#topic+compute_tfce">compute_tfce</a>()</code>,
<code><a href="#topic+compute_troendle">compute_troendle</a>()</code>
</p>

<hr>
<h2 id='compute_clusterdepth_head'>Cluster-depth correction (from the head only)</h2><span id='topic+compute_clusterdepth_head'></span>

<h3>Description</h3>

<p>Compute the cluster-depth test correction (from the head) given a matrix a permuted statistical signals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_clusterdepth_head(distribution, threshold, alternative = "two.sided")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_clusterdepth_head_+3A_distribution">distribution</code></td>
<td>
<p>A matrix of permuted statistical signal. The first row indicating the observed statistics.</p>
</td></tr>
<tr><td><code id="compute_clusterdepth_head_+3A_threshold">threshold</code></td>
<td>
<p>A scalar that represents the threshold to create the clusters.</p>
</td></tr>
<tr><td><code id="compute_clusterdepth_head_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the alternative hypothesis. Default is <code>"greater"</code>. Choose between <code>"greater"</code>, <code>"less"</code> or <code>"two.sided"</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other multcomp: 
<code><a href="#topic+compute_clusterdepth">compute_clusterdepth</a>()</code>,
<code><a href="#topic+compute_clustermass">compute_clustermass</a>()</code>,
<code><a href="#topic+compute_maxT">compute_maxT</a>()</code>,
<code><a href="#topic+compute_minP">compute_minP</a>()</code>,
<code><a href="#topic+compute_stepdownmaxT">compute_stepdownmaxT</a>()</code>,
<code><a href="#topic+compute_tfce">compute_tfce</a>()</code>,
<code><a href="#topic+compute_troendle">compute_troendle</a>()</code>
</p>

<hr>
<h2 id='compute_clustermass'>Clustermass test correction</h2><span id='topic+compute_clustermass'></span>

<h3>Description</h3>

<p>Compute the clustermass test correction given a matrix a permuted statistical signals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_clustermass(distribution, threshold, aggr_FUN, alternative = "greater")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_clustermass_+3A_distribution">distribution</code></td>
<td>
<p>A matrix of permuted statistical signal. The first row indicating the observed statistics.</p>
</td></tr>
<tr><td><code id="compute_clustermass_+3A_threshold">threshold</code></td>
<td>
<p>A scalar that respresents the threshold to create the clusters.</p>
</td></tr>
<tr><td><code id="compute_clustermass_+3A_aggr_fun">aggr_FUN</code></td>
<td>
<p>A function to compute the clustermasses. See details for examples.</p>
</td></tr>
<tr><td><code id="compute_clustermass_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the alternative hypothesis. Default is <code>"greater"</code>. Choose between <code>"greater"</code>, <code>"less"</code> or <code>"two.sided"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>aggr_FUN</code> argument may take predefined function as the sum: <code>aggr_FUN = sum</code> and also user-defined function as the sum of squares: <code>aggr_FUN = function(x){sum(x^2)}</code>
</p>


<h3>See Also</h3>

<p>Other multcomp: 
<code><a href="#topic+compute_clusterdepth_head">compute_clusterdepth_head</a>()</code>,
<code><a href="#topic+compute_clusterdepth">compute_clusterdepth</a>()</code>,
<code><a href="#topic+compute_maxT">compute_maxT</a>()</code>,
<code><a href="#topic+compute_minP">compute_minP</a>()</code>,
<code><a href="#topic+compute_stepdownmaxT">compute_stepdownmaxT</a>()</code>,
<code><a href="#topic+compute_tfce">compute_tfce</a>()</code>,
<code><a href="#topic+compute_troendle">compute_troendle</a>()</code>
</p>

<hr>
<h2 id='compute_maxT'>The max-T correction</h2><span id='topic+compute_maxT'></span>

<h3>Description</h3>

<p>Compute the max-T correction given a matrix a permuted statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_maxT(distribution, alternative)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_maxT_+3A_distribution">distribution</code></td>
<td>
<p>A matrix of permuted statistical signal. The first row indicating the observed statistics.</p>
</td></tr>
<tr><td><code id="compute_maxT_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the alternative hypothesis. Default is <code>"greater"</code>. Choose between <code>"greater"</code>, <code>"less"</code> or <code>"two.sided"</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other multcomp: 
<code><a href="#topic+compute_clusterdepth_head">compute_clusterdepth_head</a>()</code>,
<code><a href="#topic+compute_clusterdepth">compute_clusterdepth</a>()</code>,
<code><a href="#topic+compute_clustermass">compute_clustermass</a>()</code>,
<code><a href="#topic+compute_minP">compute_minP</a>()</code>,
<code><a href="#topic+compute_stepdownmaxT">compute_stepdownmaxT</a>()</code>,
<code><a href="#topic+compute_tfce">compute_tfce</a>()</code>,
<code><a href="#topic+compute_troendle">compute_troendle</a>()</code>
</p>

<hr>
<h2 id='compute_minP'>The min-P correction</h2><span id='topic+compute_minP'></span>

<h3>Description</h3>

<p>Compute the min-P correction given a matrix a permuted statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_minP(distribution, alternative)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_minP_+3A_distribution">distribution</code></td>
<td>
<p>A matrix of permuted statistical signal. The first row indicating the observed statistics.</p>
</td></tr>
<tr><td><code id="compute_minP_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the alternative hypothesis. Default is <code>"greater"</code>. Choose between <code>"greater"</code>, <code>"less"</code> or <code>"two.sided"</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other multcomp: 
<code><a href="#topic+compute_clusterdepth_head">compute_clusterdepth_head</a>()</code>,
<code><a href="#topic+compute_clusterdepth">compute_clusterdepth</a>()</code>,
<code><a href="#topic+compute_clustermass">compute_clustermass</a>()</code>,
<code><a href="#topic+compute_maxT">compute_maxT</a>()</code>,
<code><a href="#topic+compute_stepdownmaxT">compute_stepdownmaxT</a>()</code>,
<code><a href="#topic+compute_tfce">compute_tfce</a>()</code>,
<code><a href="#topic+compute_troendle">compute_troendle</a>()</code>
</p>

<hr>
<h2 id='compute_stepdownmaxT'>Step-down version of the max-T correction</h2><span id='topic+compute_stepdownmaxT'></span>

<h3>Description</h3>

<p>Compute the Step-down version of the max-T given a matrix a permuted statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_stepdownmaxT(distribution, alternative)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_stepdownmaxT_+3A_distribution">distribution</code></td>
<td>
<p>A matrix of permuted statistical signal. The first row indicating the observed statistics.</p>
</td></tr>
<tr><td><code id="compute_stepdownmaxT_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the alternative hypothesis. Default is <code>"greater"</code>. Choose between <code>"greater"</code>, <code>"less"</code> or <code>"two.sided"</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other multcomp: 
<code><a href="#topic+compute_clusterdepth_head">compute_clusterdepth_head</a>()</code>,
<code><a href="#topic+compute_clusterdepth">compute_clusterdepth</a>()</code>,
<code><a href="#topic+compute_clustermass">compute_clustermass</a>()</code>,
<code><a href="#topic+compute_maxT">compute_maxT</a>()</code>,
<code><a href="#topic+compute_minP">compute_minP</a>()</code>,
<code><a href="#topic+compute_tfce">compute_tfce</a>()</code>,
<code><a href="#topic+compute_troendle">compute_troendle</a>()</code>
</p>

<hr>
<h2 id='compute_tfce'>Threshold-Free Cluster-Enhancement correction</h2><span id='topic+compute_tfce'></span>

<h3>Description</h3>

<p>Compute the TFCE correction given a matrix a permuted statistical signals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_tfce(distribution, alternative = "greater", E = 0.5, H = 1, ndh)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_tfce_+3A_distribution">distribution</code></td>
<td>
<p>A matrix of permuted statistical signal. The first row indicating the observed statistics.</p>
</td></tr>
<tr><td><code id="compute_tfce_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the alternative hypothesis. Default is <code>"greater"</code>. Choose between <code>"greater"</code>, <code>"less"</code> or <code>"two.sided"</code>.</p>
</td></tr>
<tr><td><code id="compute_tfce_+3A_e">E</code></td>
<td>
<p>A scalar that represent the extend parameter of the TFCE transformation. Default is <code>E = 0.5</code>.</p>
</td></tr>
<tr><td><code id="compute_tfce_+3A_h">H</code></td>
<td>
<p>A scalar that represent the height parameter of the TFCE transformation. Default is <code>H = 1</code>.</p>
</td></tr>
<tr><td><code id="compute_tfce_+3A_ndh">ndh</code></td>
<td>
<p>The number of terms in the approximation of the integral.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approximation of the TFCE integral starts from the minimal statistic (among the permuted statistic), not 0. Indeed, the value of the integral (from 0, to this minimal value) is the same for all time points, all permutations and does not need to be computed to get p-values.
</p>


<h3>See Also</h3>

<p>Other multcomp: 
<code><a href="#topic+compute_clusterdepth_head">compute_clusterdepth_head</a>()</code>,
<code><a href="#topic+compute_clusterdepth">compute_clusterdepth</a>()</code>,
<code><a href="#topic+compute_clustermass">compute_clustermass</a>()</code>,
<code><a href="#topic+compute_maxT">compute_maxT</a>()</code>,
<code><a href="#topic+compute_minP">compute_minP</a>()</code>,
<code><a href="#topic+compute_stepdownmaxT">compute_stepdownmaxT</a>()</code>,
<code><a href="#topic+compute_troendle">compute_troendle</a>()</code>
</p>

<hr>
<h2 id='compute_troendle'>The Troendle's correction</h2><span id='topic+compute_troendle'></span>

<h3>Description</h3>

<p>Compute the Troendle's correction given a matrix a permuted statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_troendle(distribution, alternative)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_troendle_+3A_distribution">distribution</code></td>
<td>
<p>A matrix of permuted statistical signal. The first row indicating the observed statistics.</p>
</td></tr>
<tr><td><code id="compute_troendle_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the alternative hypothesis. Default is <code>"greater"</code>. Choose between <code>"greater"</code>, <code>"less"</code> or <code>"two.sided"</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other multcomp: 
<code><a href="#topic+compute_clusterdepth_head">compute_clusterdepth_head</a>()</code>,
<code><a href="#topic+compute_clusterdepth">compute_clusterdepth</a>()</code>,
<code><a href="#topic+compute_clustermass">compute_clustermass</a>()</code>,
<code><a href="#topic+compute_maxT">compute_maxT</a>()</code>,
<code><a href="#topic+compute_minP">compute_minP</a>()</code>,
<code><a href="#topic+compute_stepdownmaxT">compute_stepdownmaxT</a>()</code>,
<code><a href="#topic+compute_tfce">compute_tfce</a>()</code>
</p>

<hr>
<h2 id='emergencycost'>Dataset of cost of emergency patients.</h2><span id='topic+emergencycost'></span>

<h3>Description</h3>

<p>Observational data from 176 emergency patients with variables :
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(emergencycost)
</code></pre>


<h3>Format</h3>

<p>A data frame with 176 rows and 5 variables.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>sex</code>.
</p>
</li>
<li> <p><code>age</code>.
</p>
</li>
<li> <p><code>insurance</code> : the type of insurance, private or semi private (<code>semi_private</code>) or public (<code>public</code>).
</p>
</li>
<li> <p><code>LOS</code> : the length of the stay in days.
</p>
</li>
<li> <p><code>cost</code> : the cost in CHF.
</p>
</li></ul>



<h3>References</h3>

<p>Heritier, S., Cantoni, E., Copt, S., &amp; Victoria-Feser, M. P. (2009). Robust methods in Biostatistics (Vol. 825). John Wiley &amp; Sons.
</p>


<h3>See Also</h3>

<p>Other dataset: 
<code><a href="#topic+attentionshifting_design">attentionshifting_design</a></code>,
<code><a href="#topic+attentionshifting_signal">attentionshifting_signal</a></code>,
<code><a href="#topic+jpah2016">jpah2016</a></code>
</p>

<hr>
<h2 id='get_cluster'>Get the ID of the cluster on a distribution matrix</h2><span id='topic+get_cluster'></span>

<h3>Description</h3>

<p>Get if of clusters given a threshold
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cluster(distribution, threshold, alternative = "two.sided", side = "all")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_cluster_+3A_distribution">distribution</code></td>
<td>
<p>a matrix of the distribution.</p>
</td></tr>
<tr><td><code id="get_cluster_+3A_threshold">threshold</code></td>
<td>
<p>a numeric indicating the threshold.</p>
</td></tr>
<tr><td><code id="get_cluster_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the alternative hypothesis. Choose between <code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>. Default is <code>"two.sided"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with integer indicating the id of the clusters
</p>

<hr>
<h2 id='jpah2016'>Dataset of a control study in psychology.</h2><span id='topic+jpah2016'></span>

<h3>Description</h3>

<p>A subset of a control experiment measuring the impulsive approach tendencies toward physical activity or sedentary behaviors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(jpah2016)
</code></pre>


<h3>Format</h3>

<p>A data frame with 38 rows and 8 variables.
</p>


<h3>Details</h3>


<ul>
<li><p> id identifier of the subject.
</p>
</li>
<li><p> bmi body mass index.
</p>
</li>
<li><p> age.
</p>
</li>
<li><p> sex.
</p>
</li>
<li><p> condition the experimental condition where the task was to approach physical activity and avoid sedentary behavior (ApSB_AvPA), approach sedentarity behavior and avoid physical activity (ApPA_AvSB), and a control condition (control).
</p>
</li>
<li><p> time pre, post.
</p>
</li>
<li><p> iapa measure of impulsive approach tendencies toward physical activity (dependant variable).
</p>
</li>
<li><p> iasb measure of impulsive approach tendencies toward sedentary behavior (dependant variable).
</p>
</li></ul>



<h3>References</h3>

<p>Cheval, B., Sarrazin, P., Pelletier, L., &amp; Friese, M. (2016). Effect of retraining approach-avoidance tendencies on an exercise task: A randomized controlled trial. Journal of Physical Activity and Health, 13(12), 1396-1403.
</p>


<h3>See Also</h3>

<p>Other dataset: 
<code><a href="#topic+attentionshifting_design">attentionshifting_design</a></code>,
<code><a href="#topic+attentionshifting_signal">attentionshifting_signal</a></code>,
<code><a href="#topic+emergencycost">emergencycost</a></code>
</p>

<hr>
<h2 id='lmperm'>Permutation tests for regression parameters</h2><span id='topic+lmperm'></span>

<h3>Description</h3>

<p>Compute permutation marginal tests for linear models. This function produces t statistics with univariate and bivariate p-values. It gives the choice between multiple methods to handle nuisance variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmperm(
  formula,
  data = NULL,
  np = 5000,
  method = NULL,
  type = "permutation",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lmperm_+3A_formula">formula</code></td>
<td>
<p>A formula object.</p>
</td></tr>
<tr><td><code id="lmperm_+3A_data">data</code></td>
<td>
<p>A data frame or matrix.</p>
</td></tr>
<tr><td><code id="lmperm_+3A_np">np</code></td>
<td>
<p>The number of permutations. Default value is <code>5000</code>.</p>
</td></tr>
<tr><td><code id="lmperm_+3A_method">method</code></td>
<td>
<p>A character string indicating the method use to handle nuisance variables. Default is <code>"freedman_lane"</code>. For the other methods, see details.</p>
</td></tr>
<tr><td><code id="lmperm_+3A_type">type</code></td>
<td>
<p>A character string to specify the type of transformations: &quot;permutation&quot; and &quot;signflip&quot; are available. Is overridden if P is given. See help from Pmat.</p>
</td></tr>
<tr><td><code id="lmperm_+3A_...">...</code></td>
<td>
<p>Futher arguments, see details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following methods are available for the fixed effects model defined as <code class="reqn">y = D\eta + X\beta + \epsilon</code>. If we want to test <code class="reqn">\beta = 0</code> and take into account the effects of the nuisance variables <code class="reqn">D</code>, we transform the data :
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>method</code> argument </td><td style="text-align: center;"> <code class="reqn">y*</code> </td><td style="text-align: center;"> <code class="reqn">D*</code> </td><td style="text-align: center;"> <code class="reqn">X*</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"draper_stoneman"</code> </td><td style="text-align: center;"> <code class="reqn">y</code> </td><td style="text-align: center;"> <code class="reqn">D</code> </td><td style="text-align: center;"> <code class="reqn">PX</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"freedman_lane"</code> </td><td style="text-align: center;"> <code class="reqn">(H_D+PR_D)y</code> </td><td style="text-align: center;"> <code class="reqn">D</code> </td><td style="text-align: center;"> <code class="reqn">X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"manly"</code> </td><td style="text-align: center;"> <code class="reqn">Py</code> </td><td style="text-align: center;"> <code class="reqn">D</code> </td><td style="text-align: center;"> <code class="reqn">X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"terBraak"</code> </td><td style="text-align: center;"> <code class="reqn">(H_{X,D}+PR_{X,D})y</code> </td><td style="text-align: center;"> <code class="reqn">D</code> </td><td style="text-align: center;"> <code class="reqn">X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"kennedy"</code> </td><td style="text-align: center;"> <code class="reqn">PR_D y</code> </td><td style="text-align: center;"> </td><td style="text-align: center;"> <code class="reqn">R_D X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"huh_jhun"</code> </td><td style="text-align: center;"> <code class="reqn">PV'R_Dy</code> </td><td style="text-align: center;"> </td><td style="text-align: center;"> <code class="reqn">V'R_D X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"dekker"</code> </td><td style="text-align: center;"> <code class="reqn">y</code> </td><td style="text-align: center;"> <code class="reqn">D</code> </td><td style="text-align: center;"> <code class="reqn">PR_D X</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Other arguments could be pass in <code>...</code> :<br /> <br />
<code>P</code> : a matrix containing the permutations of class <code>matrix</code> or <code>Pmat</code> for the reproductibility of the results. The first column must be the identity. <code>P</code> overwrites <code>np</code> argument. <br /> <br />
<code>rnd_rotation</code> : a random matrix of size <code class="reqn">n \times n</code> to compute the rotation used for the <code>"huh_jhun"</code> method.
</p>


<h3>Value</h3>

<p>A <code>lmperm</code> object. See <a href="#topic+aovperm">aovperm</a>.
</p>


<h3>Author(s)</h3>

<p>jaromil.frossard@unige.ch
</p>


<h3>References</h3>

<p>Kherad-Pajouh, S., &amp; Renaud, O. (2010). An exact permutation method for testing any effect in balanced and unbalanced fixed effect ANOVA. Computational Statistics &amp; Data Analysis, 54(7), 1881-1893.
</p>
<p>Kherad-Pajouh, S., &amp; Renaud, O. (2015). A general permutation approach for analyzing repeated measures ANOVA and mixed-model designs. Statistical Papers, 56(4), 947-967.
</p>
<p>Winkler, A. M., Ridgway, G. R., Webster, M. A., Smith, S. M., &amp; Nichols, T. E. (2014). Permutation inference for the general linear model. Neuroimage, 92, 381-397.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aovperm">aovperm</a></code> <code><a href="#topic+plot.lmperm">plot.lmperm</a></code>
</p>
<p>Other main function: 
<code><a href="#topic+aovperm">aovperm</a>()</code>,
<code><a href="#topic+clusterlm">clusterlm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data
data("emergencycost")

## Testing at 14 days
emergencycost$LOS14 &lt;- emergencycost$LOS - 14

## Univariate t test
contrasts(emergencycost$insurance) &lt;- contr.sum
contrasts(emergencycost$sex) &lt;- contr.sum

## Warning : np argument must be greater (recommendation: np&gt;=5000)
modlm_cost_14 &lt;- lmperm(cost ~ LOS14*sex*insurance, data = emergencycost, np = 2000)
modlm_cost_14
</code></pre>

<hr>
<h2 id='plot.clusterlm'>Plot cluster or parameters.</h2><span id='topic+plot.clusterlm'></span>

<h3>Description</h3>

<p>Plot method for class <code>clusterlm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clusterlm'
plot(
  x,
  effect = "all",
  type = "statistic",
  multcomp = x$multcomp[1],
  alternative = "two.sided",
  enhanced_stat = FALSE,
  nbbaselinepts = 0,
  nbptsperunit = 1,
  distinctDVs = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.clusterlm_+3A_x">x</code></td>
<td>
<p>A <code>clusterlm</code> object.</p>
</td></tr>
<tr><td><code id="plot.clusterlm_+3A_effect">effect</code></td>
<td>
<p>A vector of character naming the effects to display. Default is <code>"all"</code>.</p>
</td></tr>
<tr><td><code id="plot.clusterlm_+3A_type">type</code></td>
<td>
<p>A character string that specified the values to highlight. <code>"statistic"</code> or <code>"coef"</code> are available. Default is <code>"statistic"</code>.</p>
</td></tr>
<tr><td><code id="plot.clusterlm_+3A_multcomp">multcomp</code></td>
<td>
<p>A character string specifying the method use to correct the p-value. It should match the one computed in the object. Default is the (first) method in the call to <a href="#topic+clusterlm">clusterlm</a>. See <a href="#topic+clusterlm">clusterlm</a>.</p>
</td></tr>
<tr><td><code id="plot.clusterlm_+3A_alternative">alternative</code></td>
<td>
<p>A character string specifying the alternative hypothesis for the t-test. The available options are <code>"greater"</code>, <code>"less"</code> and <code>"two.sided"</code>. Default is <code>"two.sided"</code>.</p>
</td></tr>
<tr><td><code id="plot.clusterlm_+3A_enhanced_stat">enhanced_stat</code></td>
<td>
<p>A logical. Default is <code>FALSE</code>. If <code>TRUE</code>, the enhanced statistic will be plotted overwise it will plot the observed statistic. Change for the <code>"tfce"</code> or the <code>"clustermass"</code> multiple comparisons procedures.</p>
</td></tr>
<tr><td><code id="plot.clusterlm_+3A_nbbaselinepts">nbbaselinepts</code></td>
<td>
<p>An integer. Default is 0. If the origin of the x axis should be shifted to show the start of the time lock, provide the number of baseline time points.</p>
</td></tr>
<tr><td><code id="plot.clusterlm_+3A_nbptsperunit">nbptsperunit</code></td>
<td>
<p>An integer. Default is 1. Modify this value to change the scale of the label from the number of points to the desired unit. If points are e.g. sampled at 1024Hz, set to 1024 to scale into seconds and to 1.024 to scale into milliseconds.</p>
</td></tr>
<tr><td><code id="plot.clusterlm_+3A_distinctdvs">distinctDVs</code></td>
<td>
<p>Boolean. Should the DVs be plotted distictively, i.e. should the points be unlinked and should the name of the DVs be printed on the x axis ? Default is FALSE if the number of DV is large thant 15 or if the method is &quot;clustermass&quot; or &quot;tfce&quot;.</p>
</td></tr>
<tr><td><code id="plot.clusterlm_+3A_...">...</code></td>
<td>
<p>further argument pass to plot.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other plot: 
<code><a href="#topic+plot.lmperm">plot.lmperm</a>()</code>
</p>

<hr>
<h2 id='plot.lmperm'>Plot method for class <code>"lmperm"</code>.</h2><span id='topic+plot.lmperm'></span>

<h3>Description</h3>

<p>Show the density of statistics and the test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmperm'
plot(x, FUN = density, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.lmperm_+3A_x">x</code></td>
<td>
<p>A <code>"lmperm"</code> object.</p>
</td></tr>
<tr><td><code id="plot.lmperm_+3A_fun">FUN</code></td>
<td>
<p>A function to compute the density. Default is <a href="stats.html#topic+density">density</a>.</p>
</td></tr>
<tr><td><code id="plot.lmperm_+3A_...">...</code></td>
<td>
<p>futher arguments pass to plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Other argument can be pass to the function : <br /> <br />
<code>effect</code> : a vector of character string indicating the name of the effect to plot. <br />
</p>


<h3>See Also</h3>

<p>Other plot: 
<code><a href="#topic+plot.clusterlm">plot.clusterlm</a>()</code>
</p>

<hr>
<h2 id='Pmat'>Create a set of permutations/signflips.</h2><span id='topic+Pmat'></span>

<h3>Description</h3>

<p>Compute a permutation matrix used as argument in <a href="#topic+aovperm">aovperm</a>, <a href="#topic+lmperm">lmperm</a>, <a href="#topic+clusterlm">clusterlm</a> functions. The first column represents the identity permutation. Generally not suited for the &quot;huh_jhun&quot; method, as the dimension of this matrix does not correspond to the number of observations and may vary for different factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pmat(np = 5000, n, type = "permutation", counting = "random")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Pmat_+3A_np">np</code></td>
<td>
<p>A numeric value for the number of permutations. Default is 5000.</p>
</td></tr>
<tr><td><code id="Pmat_+3A_n">n</code></td>
<td>
<p>A numeric value for the number of observations.</p>
</td></tr>
<tr><td><code id="Pmat_+3A_type">type</code></td>
<td>
<p>A character string to specify the type of transformations: &quot;permutation&quot; and &quot;signflip&quot; are available. See details.</p>
</td></tr>
<tr><td><code id="Pmat_+3A_counting">counting</code></td>
<td>
<p>A character string to specify the selection of the transformations. &quot;all&quot; and &quot;random&quot; are available. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>couting</code> can set to :<br />
<code>"random"</code> : <code>np</code> random with replacement permutations/signflips among the <code>n!</code>/<code>2^n</code>  permutations/signflips.<br />
<code>"all"</code> : all <code>n!</code>/<code>2^n</code> possible permutations/signflips.<br />
</p>


<h3>Value</h3>

<p>A matrix n x np containing the permutations/signflips. First permutation is the identity.
</p>


<h3>See Also</h3>

<p>Other pmat: 
<code><a href="#topic+Pmat_product">Pmat_product</a>()</code>,
<code><a href="#topic+as.Pmat">as.Pmat</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## data
data("emergencycost")

## Create a set of 2000 permutations
set.seed(42)
pmat = Pmat(np = 2000, n = nrow(emergencycost))
sfmat = Pmat(np = 2000, n = nrow(emergencycost), type = "signflip")

## centrering the covariate to the mean
emergencycost$LOSc &lt;- scale(emergencycost$LOS, scale = FALSE)

## ANCOVA
mod_cost_0 &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost, np = 2000)
mod_cost_1 &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost, P = pmat)
mod_cost_2 &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost, P = pmat)
mod_cost_3 &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost, P = sfmat)
mod_cost_4 &lt;- aovperm(cost ~ LOSc*sex*insurance, data = emergencycost,type="signflip")

## Same p-values for both models 1 and 2 but different of model 0
mod_cost_0
mod_cost_1
mod_cost_2
mod_cost_3
mod_cost_4

</code></pre>

<hr>
<h2 id='Pmat_product'>Multiplies a vector with a Pmat object</h2><span id='topic+Pmat_product'></span>

<h3>Description</h3>

<p>Multiplies a vector or matrix with a Pmat object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pmat_product(x, P, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Pmat_product_+3A_x">x</code></td>
<td>
<p>A a vector or matrix</p>
</td></tr>
<tr><td><code id="Pmat_product_+3A_p">P</code></td>
<td>
<p>A Pmat object</p>
</td></tr>
<tr><td><code id="Pmat_product_+3A_type">type</code></td>
<td>
<p>A character string indicating the type of transformation. This argument need to be specified if P is not of class Pmat.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix n x np containing the permutated/signflipped vectors.
</p>


<h3>See Also</h3>

<p>Other pmat: 
<code><a href="#topic+Pmat">Pmat</a>()</code>,
<code><a href="#topic+as.Pmat">as.Pmat</a>()</code>
</p>

<hr>
<h2 id='print.clusterlm'>Print <code>clusterlm</code> object.</h2><span id='topic+print.clusterlm'></span>

<h3>Description</h3>

<p>Display the corrected p-values for each effects. Results of the <code>"clustermass"</code> procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clusterlm'
print(x, multcomp = NULL, alternative = "two.sided", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.clusterlm_+3A_x">x</code></td>
<td>
<p>A <code>clusterlm</code> object.</p>
</td></tr>
<tr><td><code id="print.clusterlm_+3A_multcomp">multcomp</code></td>
<td>
<p>A character string indicating the multiple comparison procedure to print. Default is NULL a print the first multiple comparisons procedure of the <code>clusterlm</code> object.</p>
</td></tr>
<tr><td><code id="print.clusterlm_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the alternative hypothesis. Choose between <code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>. Default is <code>"two.sided"</code>.</p>
</td></tr>
<tr><td><code id="print.clusterlm_+3A_...">...</code></td>
<td>
<p>Further arguments pass to <code>print</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other summary: 
<code><a href="#topic+summary.clusterlm">summary.clusterlm</a>()</code>
</p>

<hr>
<h2 id='summary.clusterlm'>Summarize of a <code>clusterlm</code> object.</h2><span id='topic+summary.clusterlm'></span>

<h3>Description</h3>

<p>Display the corrected p-values for each effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clusterlm'
summary(
  object,
  alternative = "two.sided",
  multcomp = NULL,
  table_type = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.clusterlm_+3A_object">object</code></td>
<td>
<p>A <code>clusterlm</code> object.</p>
</td></tr>
<tr><td><code id="summary.clusterlm_+3A_alternative">alternative</code></td>
<td>
<p>A character string indicating the alternative hypothesis. Choose between <code>"two.sided"</code>, <code>"greater"</code>, <code>"less"</code>. Default is <code>"two.sided"</code>.</p>
</td></tr>
<tr><td><code id="summary.clusterlm_+3A_multcomp">multcomp</code></td>
<td>
<p>A character string indicating the multiple comparison procedure to display.</p>
</td></tr>
<tr><td><code id="summary.clusterlm_+3A_table_type">table_type</code></td>
<td>
<p>A character string indicating the type of table to display. Choose between <code>"cluster"</code>, which aggregates test into pseudo-clusters (see details for the interpretations) or <code>"full"</code> which displays the p-values for all tests. See details for default values.</p>
</td></tr>
<tr><td><code id="summary.clusterlm_+3A_...">...</code></td>
<td>
<p>Further arguments see details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It creates the full table when the number of tests is &lt;=15 and creates a table of pseudo-clusters overwise. Note that for the <code>"troendle"</code> method is not based on clustering of the data and the table of pseudo-clusters should only be used to facilitate the reading of the results.
</p>


<h3>Value</h3>

<p>A table for each effect indicating the statistics and p-values of the clusters.
</p>


<h3>See Also</h3>

<p>Other summary: 
<code><a href="#topic+print.clusterlm">print.clusterlm</a>()</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
