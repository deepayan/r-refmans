<!DOCTYPE html><html><head><title>Help for package mpmcorrelogram</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mpmcorrelogram}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#example.data'><p>Assemblage similarity and geographic distance matrices</p></a></li>
<li><a href='#mpmcorrelogram'><p>Multivariate Partial Mantel Correlogram</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Partial Mantel Correlogram</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-4</td>
</tr>
<tr>
<td>Depends:</td>
<td>vegan</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-11-17</td>
</tr>
<tr>
<td>Author:</td>
<td>Marcelino de la Cruz</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcelino de la Cruz &lt;marcelino.delacruz@urjc.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to compute and plot multivariate (partial) Mantel correlograms.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Acknowledgements:</td>
<td>subvention 099/RN08/02.1 of the Spanish Ministerio de
Medio Ambiente, Medio Rural y Marino.</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-11-17 12:54:02 UTC; marcelino</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-11-17 13:46:54 UTC</td>
</tr>
</table>
<hr>
<h2 id='example.data'>Assemblage similarity and geographic distance matrices</h2><span id='topic+S'></span><span id='topic+D'></span><span id='topic+Zd'></span><span id='topic+example.data'></span>

<h3>Description</h3>

<p>Artificial data matrices used by Legendre and Legendre (1998) to exemplify 
the computation of multivariate Mantel correlograms. <code>S</code> is assumed to represent
a similarity matrix computed from assemblage data among 10 sampling sites within
a 1-km2 sampling area (Legendre and Legendre 1998: 737). <code>D</code> is the matrix of euclidean
distances among the sampling localities (Legendre and Legendre 1998: 718).
<code>Zd</code> is another distance matrix, assumed to represent some other multivariate difference
among sites (e.g. environmental diferences) that are more accentuated for distances
greater than 0.28 km. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(S)
  data(D)
  data(Zd)
</code></pre>


<h3>References</h3>

<p>Legendre, P. and Legendre, L. (1998) <em>Numerical Ecology</em>. 2nd English Edition. Elsevier
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(S)

data(Zd)
</code></pre>

<hr>
<h2 id='mpmcorrelogram'>Multivariate Partial Mantel Correlogram</h2><span id='topic+mpmcorrelogram'></span><span id='topic+print.mpmcorrelogram'></span><span id='topic+plot.mpmcorrelogram'></span>

<h3>Description</h3>

<p>Function <code>mpmcorrelogram</code> computes both multivariate and multivariate partial
Mantel correlograms. Multivariate Mantel correlograms were proposed by Sokal
(1986) and Oden and Sokal (1986) and popularized among ecologists by Legendre
and Legendre (1998, pp. 736-738). Multivariate partial Mantel correlograms
are described and employed by Matesanz et al. (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mpmcorrelogram(xdis, geodis, zdis = NULL, method = "pearson",
                 alfa = 0.05, nclass = NULL, breaks = NULL,
                 permutations = 999, strata, simil = FALSE,
                 plot = TRUE, print = TRUE)

  ## S3 method for class 'mpmcorrelogram'
plot(x, pch = c(15, 22), xlim = NULL, ylim = NULL,
                ylab = NULL, xlab = NULL, alfa = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mpmcorrelogram_+3A_xdis">xdis</code>, <code id="mpmcorrelogram_+3A_geodis">geodis</code>, <code id="mpmcorrelogram_+3A_zdis">zdis</code></td>
<td>

<p>Multivariate distance (or similarity) matrices or their
<a href="stats.html#topic+as.dist">as.dist</a> representation
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_method">method</code></td>
<td>

<p>Correlation method, as accepted by <a href="stats.html#topic+cor">cor</a>:
&quot;pearson&quot;, &quot;spearman&quot; or &quot;kendall&quot;. 
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_alfa">alfa</code></td>
<td>

<p>Significance level for the points drawn with black symbols in the
correlogram. By default <code>alpha</code> = 0.05.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_nclass">nclass</code></td>
<td>

<p>Number of distance classes. Deafult <code>NULL</code> causes Sturge's law
being used to determine the number of classes unless break points
are provided.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_breaks">breaks</code></td>
<td>

<p>Vector with break points of the distance classes.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_permutations">permutations</code></td>
<td>

<p>Number of permutations for the tests of significance.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_strata">strata</code></td>
<td>

<p>An integer vector or factor specifying the strata for permutation.
If supplied, observations are permuted only within the specified strata.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_simil">simil</code></td>
<td>

<p>Logical. Is the first matrix a similarity matrix? Default=<code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_plot">plot</code></td>
<td>

<p>Logical. Should the correlogram be ploted?. 
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_print">print</code></td>
<td>

<p>Logical. Should the results be printed?
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_x">x</code></td>
<td>

<p>An object of class mpmcorrelogram, i.e. resulting from function
mpmcorrelogram.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_pch">pch</code></td>
<td>

<p>Vector with two integers (or two single characters) specifying the symbols
(or characters) to plot respectively the significant
and non-significant <em>rM</em> values.  See <a href="graphics.html#topic+points">points</a> for possible
values and their interpretation.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_xlim">xlim</code></td>
<td>

<p>Vector with the limits for the x-axis.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_ylim">ylim</code></td>
<td>

<p>Vector with the limits for the y-axis.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_ylab">ylab</code></td>
<td>

<p>Label for the y-axis.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_xlab">xlab</code></td>
<td>

<p>Label for the x-axis.
</p>
</td></tr>
<tr><td><code id="mpmcorrelogram_+3A_...">...</code></td>
<td>

<p>Other parameters passed to print and plot methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>mpmcorrelogram</code> computes both Mantel correlograms and
<em>partial</em> Mantel correlograms.
A correlogram is a graph in which spatial correlation values are plotted,
on the ordinate, as a function of the geographic distance classes among
the study units along the abscissa. In a &quot;classical&quot; Mantel correlogram,
a Mantel correlation (Mantel 1967) is computed between a multivariate 
(e.g. multi-species or multi-locus) distance or similarity matrix
and a design matrix representing each of the geographic distance classes
in turn. The Mantel statistic is tested through a permutational Mantel test
performed by <span class="pkg">vegan</span>'s <a href="vegan.html#topic+mantel">mantel</a> function.
</p>
<p>In a partial Mantel correlogram, a partial correlation conditioned on a
third matrix is computed between the focal matrix and the design matrix
representing each of the geographic distance classes. In this case, 
the partial Mantel statistic is tested through a permutational test
performed by <span class="pkg">vegan</span>'s <a href="vegan.html#topic+mantel.partial">mantel.partial</a> function.
</p>
<p>A practical application of the use of the partial Mantel correlogram 
can be seen in Matesanz et al. (2011).
</p>


<h3>Value</h3>

<p>If the arguments <code>plot</code> and <code>print</code> are both <code>TRUE</code>, 
<code>mpmcorrelogram</code> by default will draw a correlogram where solid squares
indicate significant <code>rM</code> values and void squares indicate non-significant ones.
It will also print the results as a table. In any case, <code>mpmcorrelogram</code>
will return an object of <code>class mpmcorrelogram</code>, i.e. a list with the
following elements:
</p>
<table>
<tr><td><code>breaks</code></td>
<td>

<p>Vector with the break points of the distance classes considered. 
</p>
</td></tr>
<tr><td><code>rM</code></td>
<td>

<p>Vector with the computed Mantel correlations for each distance class.  
</p>
</td></tr>
<tr><td><code>signif</code></td>
<td>

<p>The value of the selected <code>alfa</code>.
</p>
</td></tr>
<tr><td><code>pvalues</code></td>
<td>

<p>Vector with the p-values computed for each distance class.
</p>
</td></tr>
<tr><td><code>pval.Bonferroni</code></td>
<td>

<p>Vector with the p-values after a progressive Bonferroni correction.
</p>
</td></tr>
<tr><td><code>clases</code></td>
<td>

<p>Alfanumeric vector with the range of each distance class.
</p>
</td></tr>
</table>


<h3>Acknowledgements</h3>

<p>This package  has been developed thaks to the subvention 099/RN08/02.1 of the Spanish Ministerio de Medio Ambiente, Medio Rural y Marino.
</p>


<h3>Note</h3>

<p>The implementation of the Mantel correlogram computation in
the function <code>mpmcorrelogram</code> (and that of Mantel correlation performed
by <span class="pkg">vegan</span>'s <a href="vegan.html#topic+mantel.partial">mantel.partial</a> and <a href="vegan.html#topic+mantel">mantel</a> 
functions) are based on the description of Legendre and Legendre (1998).
Following these approaches, positive Mantel statistics correspond to
positive autocorrelation when the focal matrix (i.e. <code>xdis</code>)
is a similarity matrix and to negative values when it is a 
distance matrix. As most of the designed tools in <span class="rlang"><b>R</b></span> for summarizing
relationships between the rows of data matrices return distance objects,
the argument <code>simil</code> in <code>mpmcorrelogram</code> is set by default to 
<code>FALSE</code>. See the examples for the use with a similarity matrix.
</p>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz Rot <a href="mailto:marcelino.delacruz@upm.es">marcelino.delacruz@upm.es</a>
</p>


<h3>References</h3>

<p>Legendre, P. and L. Legendre. 1998. <em>Numerical ecology</em>, 2nd English
edition. Elsevier Science BV, Amsterdam. 
</p>
<p>Mantel, N. 1967. The detection of disease clustering and a generalized
regression approach. <em>Cancer Res.</em> 27: 209-220. 
</p>
<p>Matesanz S., Gimeno T.E., de la Cruz M., Escudero A. and Valladares F. 2011.
Competition may explain the fine-scale spatial patterns and genetic structure
of two co-occurring plant congeners. <em>J. Ecol.</em> 99: 838-848
</p>
<p>Oden, N. L. and R. R. Sokal. 1986. Directional autocorrelation: an extension
of spatial correlograms to two dimensions. <em>Syst. Zool.</em> 35: 608-617. 
</p>
<p>Sokal, R. R. 1986. Spatial data analysis and historical processes.
29-43 in: E. Diday et al. (eds.) <em>Data analysis and informatics</em>,
IV. North-Holland, Amsterdam. 
</p>


<h3>See Also</h3>

<p><span class="pkg">vegan</span>'s <a href="vegan.html#topic+mantel.correlog">mantel.correlog</a> for another implementation of 
(non-partial) Mantel correlograms.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Example from Figure 13.12 of Legendre and Legendre (1998):

 # Get similarity matrix based on assemblage composition.
 
 data(S) 
 
 # Get euclidean distance between sites.
 
 data(D)
 
 # Compute Multivariate Mantel Correlogram
 # as in Fig. 13.12 of Legendre and Legendre
 
 ## Not run: 
 result &lt;- mpmcorrelogram(S, D, simil=TRUE)
 
## End(Not run)
 
 
 # A Multivariate Partial examle.
 # Get distance matrix of "covariate" attributes
 
 data(Zd)
 
 # Compute multivariate partial Mantel correlogram
 
 ## Not run: 
 result &lt;- mpmcorrelogram(S, D, Zd, simil=TRUE)
 
## End(Not run)
 

# Change the appearance of the plot
 
 ## Not run: 
 plot(result, pch=c(17,24))
 
## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
