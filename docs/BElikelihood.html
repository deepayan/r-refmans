<!DOCTYPE html><html><head><title>Help for package BElikelihood</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BElikelihood}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#beInternal'><p>Internal functions</p></a></li>
<li><a href='#BElikelihood-package'><p>Likelihood method for analyzing bioequivalence (BE) trial data</p></a></li>
<li><a href='#dat'><p>Data example for bioequivalence (BE) study</p></a></li>
<li><a href='#plot.proLikelihood'><p>Plot method for proLikelihood object</p></a></li>
<li><a href='#print.proLikelihood'><p>Print method for proLikelihood object</p></a></li>
<li><a href='#proLikelihood'><p>Calculate profile likelihood for bioequivalence data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Likelihood Method for Evaluating Bioequivalence</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-29</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Liping Du &lt;liping.du@vumc.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A likelihood method is implemented to present evidence for evaluating bioequivalence (BE). The functions use bioequivalence data [area under the blood concentration-time curve (AUC) and peak concentration (Cmax)] from various crossover designs commonly used in BE studies including a fully replicated, a partially replicated design, and a conventional 2x2 crossover design. They will calculate the profile likelihoods for the mean difference, total standard deviation ratio, and within subject standard deviation ratio for a test and a reference drug. A plot of a standardized profile likelihood can be generated along with the maximum likelihood estimate and likelihood intervals, which present evidence for bioequivalence. See Liping Du and Leena Choi (2015) &lt;<a href="https://doi.org/10.1002%2Fpst.1661">doi:10.1002/pst.1661</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, mvtnorm</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, nlme, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-01 00:46:33 UTC; beckca</td>
</tr>
<tr>
<td>Author:</td>
<td>Liping Du <a href="https://orcid.org/0000-0003-4926-2135"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Leena Choi <a href="https://orcid.org/0000-0002-2544-7090"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Cole Beck <a href="https://orcid.org/0000-0002-6849-6255"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-05 10:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='beInternal'>Internal functions</h2><span id='topic+beInternal'></span><span id='topic+design_matrix'></span><span id='topic+select_theta'></span><span id='topic+setup_env'></span><span id='topic+sigma_vals'></span><span id='topic+validateColumns'></span><span id='topic+varcov_matrix'></span>

<h3>Description</h3>

<p>Internal functions are not intended to be called by user.
</p>


<h3>Details</h3>

<p><code>design_matrix</code>: design matrix for given sequence
</p>
<p><code>select_theta</code>: select good starting values for theta
</p>
<p><code>setup_env</code>: create environment with required variables
</p>
<p><code>sigma_vals</code>: calculate sigma values used in varcov matrix
</p>
<p><code>validateColumns</code>: ensure accurate column specification
</p>
<p><code>varcov_matrix</code>: design varcov matrix
</p>

<hr>
<h2 id='BElikelihood-package'>Likelihood method for analyzing bioequivalence (BE) trial data</h2><span id='topic+BElikelihood'></span><span id='topic+BElikelihood-package'></span>

<h3>Description</h3>

<p>This package will calculate and plot the profile likelihoods for the mean difference and standard deviation ratios of a test drug 
to a reference drug for AUC or Cmax from various crossover designs commonly used in BE studies, such as a fully replicated crossover 
design (e.g., 2x4 two-sequence, four-period, RTRT/TRTR), a partially replicated crossover design (e.g., 2x3, two-sequence, three-period, RTR/TRT), and a two-sequence, two-period, crossover design design (2x2, RT/TR), where &quot;R&quot; stands for a reference drug and &quot;T&quot; stands for a test drug.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Liping Du <a href="mailto:liping.du@vumc.org">liping.du@vumc.org</a> (<a href="https://orcid.org/0000-0003-4926-2135">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Leena Choi <a href="mailto:naturechoi@gmail.com">naturechoi@gmail.com</a> (<a href="https://orcid.org/0000-0002-2544-7090">ORCID</a>)
</p>
</li>
<li><p> Cole Beck <a href="mailto:cole.beck@vumc.org">cole.beck@vumc.org</a> (<a href="https://orcid.org/0000-0002-6849-6255">ORCID</a>)
</p>
</li></ul>


<hr>
<h2 id='dat'>Data example for bioequivalence (BE) study</h2><span id='topic+dat'></span>

<h3>Description</h3>

<p>The dataset is a bioequivalence dataset from a fully repicated 2x4 crossover design with RTRT and TRTR as sequences. 
It is a subset of Example 4.4 in Chapter 4 of Patterson and Jones's book.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dat, package = 'BElikelihood')
</code></pre>


<h3>Format</h3>

<p>A data frame with 176 observations (from 44 subjects) on 6 variables:
</p>

<dl>
<dt>subject</dt><dd><p>subject ID</p>
</dd>
<dt>sequence</dt><dd><p>RTRT or TRTR, where T and R stand for test and reference drugs, respectively</p>
</dd>
<dt>period</dt><dd><p>1 to 4 for crossover period</p>
</dd>
<dt>formula</dt><dd><p>T or R stand for test and reference drugs, respectively</p>
</dd>
<dt>AUC</dt><dd><p>a pharmacokinetic parameter - the area under the blood/plasma concentration-time curve</p>
</dd>
<dt>CMAX</dt><dd><p>a pharmacokinetic parameter - the peak concentration</p>
</dd>
</dl>



<h3>Source</h3>

<p>Patterson S and Jones B (2023). Bioequivalence and Statistics in Clinical Pharmacology. Chapman Hall/CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dat)
</code></pre>

<hr>
<h2 id='plot.proLikelihood'>Plot method for proLikelihood object</h2><span id='topic+plot.proLikelihood'></span>

<h3>Description</h3>

<p>This function generates a plot of a standardized profile likelihood after running the proLikelihood() function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'proLikelihood'
plot(x, textx, texty = 0.9, textsize = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.proLikelihood_+3A_x">x</code></td>
<td>
<p>proLikelihood object</p>
</td></tr>
<tr><td><code id="plot.proLikelihood_+3A_textx">textx</code></td>
<td>
<p>numeric value, position (x-axis) of label for the maximum likelihood estimate and the 1/8 and 1/32 likelihood intervals.</p>
</td></tr>
<tr><td><code id="plot.proLikelihood_+3A_texty">texty</code></td>
<td>
<p>numeric value, position (y-axis) of label the maximum likelihood estimate and the 1/8 and 1/32 likelihood intervals.</p>
</td></tr>
<tr><td><code id="plot.proLikelihood_+3A_textsize">textsize</code></td>
<td>
<p>numeric value text size of the label.</p>
</td></tr>
<tr><td><code id="plot.proLikelihood_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function generates a plot of the standardized profile likelihood (the profile likelihood relative to the maximum) with
the maximum likelihood estimate and 1/8 and 1/32 likelihood intervals for the parameter of interest (mean difference, 
total standard deviation ratio or within-subject standard deviation ratio depending on the &lsquo;method&rsquo;) printed inside the plot.
</p>


<h3>Value</h3>

<p>ggplot2 object, a plot of the standardized profile likelihood with the maximum likelihood estimate and 1/8 and 1/32
likelihood intervals printed inside the plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dat)
cols &lt;- list(subject = 'subject', formula = 'formula', y = 'AUC')
p4a &lt;- averageBE(dat, colSpec = cols, xlength = 50)
p4t &lt;- totalVarianceBE(dat, colSpec = cols, xlength = 50)
p4w &lt;- withinVarianceBE(dat, colSpec = cols, xlength = 50)
plot(p4a)
plot(p4t)
plot(p4w)
# three period case
dd3 &lt;- dat[dat$period &lt; 4,]
p3a &lt;- averageBE(dd3, colSpec = cols, xlength = 50)
plot(p3a)
# two period case
dd2 &lt;- dat[dat$period &lt; 3,]
p2a &lt;- averageBE(dd2, colSpec = cols, xlength = 50)
plot(p2a)


</code></pre>

<hr>
<h2 id='print.proLikelihood'>Print method for proLikelihood object</h2><span id='topic+print.proLikelihood'></span>

<h3>Description</h3>

<p>Print &lsquo;poi&rsquo; (mean difference, total standard deviation ratio or within-subject standard deviation ratio) and &lsquo;maxLik&rsquo; (corresponding profile likelihood) elements from a proLikelihood object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'proLikelihood'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.proLikelihood_+3A_x">x</code></td>
<td>
<p>proLikelihood object</p>
</td></tr>
<tr><td><code id="print.proLikelihood_+3A_...">...</code></td>
<td>
<p>unused</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output the mean difference, total standard deviation ratio or within-subject standard deviation ratio values (depending on the &lsquo;method&rsquo;) with 
the calculated corresponding profile likelihood values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dat)
cols &lt;- list(subject = 'subject', formula = 'formula', y = 'AUC')
l &lt;- averageBE(dat, colSpec = cols, xlength = 300)
l


</code></pre>

<hr>
<h2 id='proLikelihood'>Calculate profile likelihood for bioequivalence data</h2><span id='topic+proLikelihood'></span><span id='topic+averageBE'></span><span id='topic+totalVarianceBE'></span><span id='topic+withinVarianceBE'></span>

<h3>Description</h3>

<p>This is a general function to calculate the profile likelihoods for the mean difference, total standard deviation ratio, 
and within-subject standard deviation ratio of the test drug to the reference drug from bioequivalence (BE) study data. 
Standardized profile likelihood plots with the 1/8 and 1/32 likelihood intervals can be generated using the plot method. 
The within-subject standard deviation ratio can be obtained only for a fully replicated 2x4 or a partially replicated 2x3 design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proLikelihood(
  dat,
  colSpec = list(),
  theta = NULL,
  xlow,
  xup,
  xlength = 100,
  method
)

averageBE(dat, colSpec = list(), theta = NULL, xlow, xup, xlength)

totalVarianceBE(dat, colSpec = list(), theta = NULL, xlow, xup, xlength)

withinVarianceBE(dat, colSpec = list(), theta = NULL, xlow, xup, xlength)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="proLikelihood_+3A_dat">dat</code></td>
<td>
<p>data frame contains BE data (AUC and Cmax) with missing data allowed.</p>
</td></tr>
<tr><td><code id="proLikelihood_+3A_colspec">colSpec</code></td>
<td>
<p>a named list that should specify columns in &lsquo;dat&rsquo;; &lsquo;subject&rsquo; (subject ID),
&lsquo;formula&rsquo; (must be coded as T or R, where T for test drug and R for reference drug), and &lsquo;y&rsquo; (either AUC or Cmax) are
required. &lsquo;period&rsquo; and &lsquo;seq&rsquo; may also be provided.
The &lsquo;formula&rsquo; column should identify a test or a reference drug with R and T.</p>
</td></tr>
<tr><td><code id="proLikelihood_+3A_theta">theta</code></td>
<td>
<p>An optional numeric vector contains initial values of the parameters for use in optimization.
For example, in a 2x4 fully replicated design, the vector is [mu, p2, p3, p4, S, phi,log(sbt2), log(sbr2), log(swt2), log(sbr2), rho], where  
&lsquo;mu&rsquo; is the population mean for the reference drug when there are no period or sequence effects; &lsquo;p2&rsquo; to &lsquo;p4&rsquo; are fixed 
period effects with period 1 as the reference period; &lsquo;S&rsquo; the fixed sequence effect with seq 1 as the reference sequence; &lsquo;phi&rsquo; 
is the mean difference between the two drugs; &lsquo;sbt2&rsquo; and &lsquo;sbr2&rsquo; are between-subject variances for the test and reference drugs, 
respectively; &lsquo;swt2&rsquo; and &lsquo;swr2&rsquo; are within-subject variances for the test and reference drugs, respectively; &lsquo;rho&rsquo; is 
the correlation coefficient within a subject. When &lsquo;theta&rsquo; (default is null) is not provided, the function 
will choose the starting values automatically based on a linear mixed-effects model. If users want to provide these values, for method 
&lsquo;average&rsquo; (mean difference), user may put any value for &lsquo;phi&rsquo;. Similarly, for method &lsquo;total&rsquo;, user can put any value 
for &lsquo;log(sbt2)&rsquo;, and for method &lsquo;within&rsquo;, user can put any value for &lsquo;log(swt2)&rsquo;.</p>
</td></tr>
<tr><td><code id="proLikelihood_+3A_xlow">xlow</code></td>
<td>
<p>numeric value, the lower limit of x-axis for the profile likelihood plot, at which the profile likelihood is calculated. It is 
optional and can be automatically generated using the maximum likelihood estimate (MLE) depending on the &lsquo;method&rsquo;. We strongly 
recommend users trying a better value that would better fit for purpose.</p>
</td></tr>
<tr><td><code id="proLikelihood_+3A_xup">xup</code></td>
<td>
<p>numeric value, the upper limit of x-axis for the profile likelihood plot, at which the profile likelihood is calculated. It is 
optional and can be automatically generated using the MLE depending on the &lsquo;method&rsquo;. We strongly recommend users trying 
a better value that would better fit for purpose.</p>
</td></tr>
<tr><td><code id="proLikelihood_+3A_xlength">xlength</code></td>
<td>
<p>numeric value. Defaults to 100. It is the number of grids between the lower and upper limits, which controls smoothness of 
the curve. It will take longer time to run for larger number of grids, but we strongly recommend users using a larger number than the default 
value.</p>
</td></tr>
<tr><td><code id="proLikelihood_+3A_method">method</code></td>
<td>
<p>character value. Should be one of &lsquo;average&rsquo;, &lsquo;total&rsquo;, or &lsquo;within&rsquo;. 
&lsquo;average&rsquo; will provide the profile likelihood for the mean difference between test and reference drugs. 
&lsquo;total&rsquo; will provide the profile likelihood for the total standard deviation ratio of test to reference drug. &lsquo;within&rsquo; 
will provide the profile likelihood for the within-subject standard deviation ratio of test to reference drug when appropriate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements a likelihood method for evaluating BE for pharmacokinetic parameters (AUC and Cmax) (see reference below). It accepts a dataframe collected with various crossover designs commonly used in BE studies such as 
a fully replicated crossover design (e.g., 2x4 two-sequence, four-period, RTRT/TRTR), a partially replicated crossover design 
(e.g., 2x3, two-sequence, three-period, RTR/TRT), and a two-sequence, two-period, crossover design design (2x2, RT/TR), 
where &quot;R&quot; stands for a reference drug and &quot;T&quot; stands for a test drug. 
It allows missing data (for example, a subject may miss the period 2 data) and utilizes all available data. It will 
calculate the profile likelihoods for the mean difference, total standard deviation ratio, and within-subject standard deviation ratio. 
Plots of standardized profile likelihood can be generated and provide evidence for various quantities of interest for evaluating 
BE in a unified framework.
</p>


<h3>Value</h3>

<p>A &lsquo;proLikelihood&rsquo; object, with elements &lsquo;poi&rsquo;, &lsquo;maxLik&rsquo;, &lsquo;MAX&rsquo;, &lsquo;LI&rsquo;, and &lsquo;method&rsquo;. 
&lsquo;poi&rsquo; and &lsquo;maxLik&rsquo; are the interested parameter (mean difference, total standard deviation ratio 
or within-subject standard deviation ratio) values and the corresponding profile likelihood values, respectively. &lsquo;MAX&rsquo; is the MLE 
estimate for that parameter. &lsquo;LI&rsquo; is the likelihood intervals with the 1/4.5, 1/8 and 1/32 intervals. 
&lsquo;method&rsquo; is one of &lsquo;average&rsquo;,&lsquo;total&rsquo;, and &lsquo;within&rsquo;.
</p>


<h3>References</h3>

<p>Liping Du and Leena Choi, Likelihood approach for evaluating bioequivalence of highly variable drugs, Pharmaceutical Statistics, 14(2): 82-94, 2015
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(dat)
cols &lt;- list(subject = 'subject', formula = 'formula', y = 'AUC')
p4a &lt;- proLikelihood(dat, colSpec = cols, xlength = 300, method = 'average')
p4t &lt;- proLikelihood(dat, colSpec = cols, xlength = 300, method = 'total')
p4w &lt;- proLikelihood(dat, colSpec = cols, xlength = 300, method = 'within')
# three period case
dd3 &lt;- dat[dat$period &lt; 4,]
p3a &lt;- averageBE(dd3, colSpec = cols, xlength = 300)
p3t &lt;- totalVarianceBE(dd3, colSpec = cols, xlength = 300)
p3w &lt;- withinVarianceBE(dd3, colSpec = cols, xlength = 300)
# two period case
dd2 &lt;- dat[dat$period &lt; 3,]
p2a &lt;- averageBE(dd2, colSpec = cols, xlength = 300)
p2t &lt;- totalVarianceBE(dd2, colSpec = cols, xlength = 300)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
