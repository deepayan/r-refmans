<!DOCTYPE html><html><head><title>Help for package ciuupi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ciuupi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acX_to_rho'><p>Computes the known correlation <code class="reqn">\rho</code></p>
between  <code class="reqn">\widehat{\theta}</code> and <code class="reqn">\widehat{\tau}</code> from the
<code class="reqn">p</code>-vectors
<code class="reqn">a</code> and <code class="reqn">c</code> and the
design matrix <code class="reqn">X</code></a></li>
<li><a href='#bs_ciuupi'><p>Computes the the functions <code class="reqn">b</code> and <code class="reqn">s</code></p>
that specify the CIUUPI for all possible
values of <code class="reqn">\sigma</code> and the observed response vector</a></li>
<li><a href='#bs.list.example'><p>The list that specifies the CIUUPI for the example</p></a></li>
<li><a href='#bsspline'><p>Evaluate the functions <code class="reqn">b</code> and <code class="reqn">s</code> at <code>x</code></p></a></li>
<li><a href='#ci_standard'><p>For given observed response vector <code class="reqn">y</code>, compute</p>
the standard <code class="reqn">1 - \alpha</code> confidence interval</a></li>
<li><a href='#ciuupi_observed_value'><p>For given observed response vector <code class="reqn">y</code>,</p>
compute the confidence interval that utilizes the
uncertain prior information (CIUUPI)</a></li>
<li><a href='#cpciuupi'><p>Compute the coverage probability of the CIUUPI</p></a></li>
<li><a href='#plot_b'><p>Plot the graph of the odd function <code class="reqn">b</code> used in the specification of the CIUUPI</p></a></li>
<li><a href='#plot_cp'><p>Plot the graph of the coverage probability</p>
of the CIUUPI</a></li>
<li><a href='#plot_s'><p>Plot the graph of the even function <code class="reqn">s</code> used in the specification of the CIUUPI</p></a></li>
<li><a href='#plot_squared_sel'><p>Plot the graph of the squared scaled expected length</p>
of the CIUUPI</a></li>
<li><a href='#selciuupi'><p>Compute the scaled expected length of the CIUUPI</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Confidence Intervals Utilizing Uncertain Prior Information</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul Kabaila [aut, cre],
  Rheanna Mainzer [aut],
  Ayesha Perera [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Kabaila &lt;P.Kabaila@latrobe.edu.au&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes a confidence interval for a specified linear combination of the 
    regression parameters in a linear regression model with iid normal errors
    with known variance when there is uncertain prior information that a distinct
    specified linear combination of the regression parameters takes a given 
    value.  This confidence interval, found by numerical nonlinear constrained 
    optimization, has the required minimum coverage and utilizes this uncertain 
    prior information through desirable expected length properties.
    This confidence interval has the following three practical applications. 
    Firstly, if the error variance has been accurately estimated from previous 
    data then it may be treated as being effectively known. Secondly, for 
    sufficiently large (dimension of the response vector) minus (dimension of 
    regression parameter vector), greater than or equal to 30 (say),
    if we replace the assumed known value of the error variance by its usual 
    estimator in the formula for the confidence interval then the resulting 
    interval has, to a very good approximation, the same coverage probability 
    and expected length properties as when the error variance is known. Thirdly,
    some more complicated models can be approximated by the linear regression 
    model with error variance known when certain unknown parameters are replaced 
    by estimates. This confidence interval is described in 
    Mainzer, R. and Kabaila, P. 
    (2019) &lt;<a href="https://doi.org/10.32614%2FRJ-2019-026">doi:10.32614/RJ-2019-026</a>&gt;, and is a member of the family of 
    confidence intervals proposed by Kabaila, P. and Giri, K. (2009) 
    &lt;<a href="https://doi.org/10.1016%2Fj.jspi.2009.03.018">doi:10.1016/j.jspi.2009.03.018</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>nloptr, statmod, functional, pracma, stats, graphics</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-18 06:40:21 UTC; Kabaila</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-18 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='acX_to_rho'>Computes the known correlation <code class="reqn">\rho</code>
between  <code class="reqn">\widehat{\theta}</code> and <code class="reqn">\widehat{\tau}</code> from the
<code class="reqn">p</code>-vectors
<code class="reqn">a</code> and <code class="reqn">c</code> and the
design matrix <code class="reqn">X</code></h2><span id='topic+acX_to_rho'></span>

<h3>Description</h3>

<p>Computes the known correlation <code class="reqn">\rho</code>
between  <code class="reqn">\widehat{\theta}</code>
and <code class="reqn">\widehat{\tau}</code>. This correlation is computed from the
<code class="reqn">p</code>-vectors
<code class="reqn">a</code> and <code class="reqn">c</code> and the <code class="reqn">n \times p</code>
design matrix <code class="reqn">X</code>, with linearly independent columns, using the formula
<code class="reqn">\rho=a^{\top}(X^{\top} X)^{-1} c
/(v_{\theta} \, v_{\tau})^{1/2}</code>, where
<code class="reqn">v_{\theta}
=a^{\top}(X^{\top} X)^{-1}a</code> and
<code class="reqn">v_{\tau}
=c^{\top}(X^{\top} X)^{-1}c</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acX_to_rho(a, c, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="acX_to_rho_+3A_a">a</code></td>
<td>
<p>The <code class="reqn">p</code>-vector <code class="reqn">a</code> that specifies the parameter of interest
<code class="reqn">\theta =a^{\top}\beta</code></p>
</td></tr>
<tr><td><code id="acX_to_rho_+3A_c">c</code></td>
<td>
<p>The <code class="reqn">p</code>-vector <code class="reqn">c</code> used in the specification of the parameter
<code class="reqn">\tau=c^{\top} \beta-t</code>. The uncertain prior
information is that <code class="reqn">\tau=0</code></p>
</td></tr>
<tr><td><code id="acX_to_rho_+3A_x">X</code></td>
<td>
<p>The <code class="reqn">n \times p</code> design matrix <code class="reqn">X</code>, with linearly
independent columns</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The known correlation <code class="reqn">\rho</code> between <code class="reqn">\widehat{\theta}</code>
and <code class="reqn">\widehat{\tau}</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- c(0, 2, 0, -2)
c &lt;- c(0, 0, 0, 1)
x1 &lt;- c(-1, 1, -1, 1)
x2 &lt;- c(-1, -1, 1, 1)
X &lt;- cbind(rep(1, 4), x1, x2, x1*x2)
rho &lt;- acX_to_rho(a, c, X)
print(rho)

</code></pre>

<hr>
<h2 id='bs_ciuupi'>Computes the the functions <code class="reqn">b</code> and <code class="reqn">s</code>
that specify the CIUUPI for all possible
values of <code class="reqn">\sigma</code> and the observed response vector</h2><span id='topic+bs_ciuupi'></span>

<h3>Description</h3>

<p>Chooses the positive number <code class="reqn">d</code> and the positive integer <code class="reqn">q</code>, sets
<code class="reqn">h=d/q</code>, and then computes the
<code class="reqn">(2q-1)</code>-vector
<code class="reqn">\big(b(h),...,b((q-1)h),
s(0),s(h)...,s((q-1)h)\big)</code>
that determines, via cubic spline interpolation, the functions
<code class="reqn">b</code> and <code class="reqn">s</code> which specify
the confidence interval for <code class="reqn">\theta</code>
that utilizes the uncertain prior information (CIUUPI),
for all possible values of <code class="reqn">\sigma</code> and the observed response vector.
To an excellent approximation, this confidence interval
has minimum coverage probability
<code class="reqn">1-\alpha</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bs_ciuupi(alpha, rho, natural = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bs_ciuupi_+3A_alpha">alpha</code></td>
<td>
<p>The desired minimum coverage probability
is <code class="reqn">1-\alpha</code></p>
</td></tr>
<tr><td><code id="bs_ciuupi_+3A_rho">rho</code></td>
<td>
<p>The known correlation <code class="reqn">\rho</code> between
<code class="reqn">\widehat{\theta}</code> and <code class="reqn">\widehat{\tau}</code></p>
</td></tr>
<tr><td><code id="bs_ciuupi_+3A_natural">natural</code></td>
<td>
<p>Equal to 1 (default) if the functions <code class="reqn">b</code>
and <code class="reqn">s</code> are specified by natural cubic spline interpolation
or 0 if these functions are specified by clamped cubic
spline interpolation in an interval <code class="reqn">[-d, d]</code>, where <code class="reqn">d</code>
is computed by <code>bs_ciuupi</code> using a specified
function of
<code>alpha</code> and <code>rho</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that </p>
<p style="text-align: center;"><code class="reqn">y = X \beta + \varepsilon</code>
</p>
<p> where <code class="reqn">y</code>
is a random <code class="reqn">n</code>-vector of
responses, <code class="reqn">X</code> is a known <code class="reqn">n</code> by <code class="reqn">p</code> matrix
with linearly
independent columns, <code class="reqn">\beta</code> is an unknown parameter
<code class="reqn">p</code>-vector and
<code class="reqn">\varepsilon</code> is the random error with components that are iid normally distributed
with zero mean and known variance <code class="reqn">\sigma^2</code>.
The parameter of interest is
<code class="reqn">\theta = a^{\top} \beta</code>.
Also let <code class="reqn">\tau = c^{\top}\beta -t</code>, where <code class="reqn">a</code>
and <code class="reqn">c</code> are specified linearly independent
vectors and <code class="reqn">t</code> is a specified number.
The uncertain prior information is that <code class="reqn">\tau = 0</code>.
</p>
<p>Let <code>rho</code> denote the known
correlation between the <code class="reqn">\widehat{\theta}</code> and <code class="reqn">\widehat{\tau}</code>.
We can compute <code>rho</code>
from given values of <code class="reqn">a</code>, <code class="reqn">c</code> and <code class="reqn">X</code>
using the function <code>acX_to_rho</code>.
</p>
<p>The confidence interval for <code class="reqn">\theta</code>,
with minimum coverage probability
1<code class="reqn">-</code><code>alpha</code>, that utilizes the uncertain prior
information that
<code class="reqn">\tau = </code> 0 belongs to a class of confidence
intervals indexed
by the functions <code class="reqn">b</code> and <code class="reqn">s</code>.
The function <code class="reqn">b</code> is an odd continuous function and
the function <code class="reqn">s</code> is an even
continuous function. In addition, <code class="reqn">b(x)=0</code> and
<code class="reqn">s(x)</code> is equal to the
1<code class="reqn">-</code><code>alpha</code><code class="reqn">/2</code>
quantile of the
standard normal distribution for all <code class="reqn">|x| \ge d</code>, where
<code class="reqn">d</code> is a given positive number.
Extensive numerical explorations
have been used to find a formula (in terms of
<code>alpha</code> and <code>rho</code>) for a 'goldilocks'
value of <code class="reqn">d</code> that is neither too large nor too small.
Then let <code class="reqn">q</code>=ceiling(<code class="reqn">d</code>/0.75) and <code class="reqn">h=d/q</code>.
The values of the functions <code class="reqn">b</code> and <code class="reqn">s</code> in
the interval <code class="reqn">[-d,d]</code>
are specified by the <code class="reqn">(2q-1)</code>-vector
</p>
<p><code class="reqn">\big(b(h),...,b((q-1)h), s(0),s(h)...,s((q-1)h) \big)</code>.
</p>
<p>The values of <code class="reqn">b(kh)</code> and <code class="reqn">s(kh)</code> for <code class="reqn">k=-q,...,q</code> are
deduced from this vector using the assumptions made about
the functions <code class="reqn">b</code> and <code class="reqn">s</code>.
The values of <code class="reqn">b(x)</code> and <code class="reqn">s(x)</code> for any <code class="reqn">x</code> in the interval
<code class="reqn">[-d, d]</code>
are then found using cube spline interpolation using the
values of <code class="reqn">b(kh)</code> and <code class="reqn">s(kh)</code> for <code class="reqn">k=-q,...,q</code>.
For <code>natural</code>=1 (default) this is 'natural' cubic
spline interpolation and for <code>natural</code>=0 this is
'clamped' cubic spline interpolation.
</p>
<p>The vector <code class="reqn">\big(b(h),...,b((q-1)h), s(0),s(h)...,s((q-1)h)\big)</code>
is found by numerical nonlinear constrained optimization
so that the confidence interval has minimum
coverage probability 1<code class="reqn">-</code><code>alpha</code> and utilizes
the uncertain prior information
through its desirable expected length properties.
This optimization is performed using the
<code>slsqp</code> function
in the <code>nloptr</code> package.
</p>


<h3>Value</h3>

<p>A list with the following components.
</p>
<p>alpha, rho, natural: the inputs
</p>
<p>d: a 'goldilocks' value of <code class="reqn">d</code> that is not too large
and not too small
</p>
<p>n.ints: number of equal-length consecutive
intervals whose union is <code class="reqn">[0,d]</code>,
this is the same as <code class="reqn">q</code>
</p>
<p>lambda.star: the computed value of <code class="reqn">\lambda^*</code>
</p>
<p>bsvec: the vector
<code class="reqn">\big(b(h),...,b((q-1)h), s(0),s(h)...,s((q-1)h) \big)</code> that determines
the functions <code class="reqn">b</code> and <code class="reqn">s</code> that specify the CIUUPI for all possible
values of <code class="reqn">\sigma</code> and observed response vector
</p>
<p>comp.time: the computation time in seconds
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha &lt;- 0.05
rho &lt;- - 1 / sqrt(2)
bs.list &lt;- bs_ciuupi(alpha, rho)


</code></pre>

<hr>
<h2 id='bs.list.example'>The list that specifies the CIUUPI for the example</h2><span id='topic+bs.list.example'></span>

<h3>Description</h3>

<p>In this example, the dataset described in Table 7.5 of Box et al. (1963) is used.
The design matrix X is
specified by the command
<code>X &lt;- cbind(rep(1,4), c(-1, 1, -1, 1), c(-1, -1, 1, 1), c(1, -1, -1, 1))</code>.
A description of the parameter of interest is given in Discussion 5.8, p.3426 of
Kabaila and Giri (2009).
The parameter of interest is <code class="reqn">\theta = a^{\top} \beta</code>,
where the column vector <code class="reqn">a</code> is specified by the command
<code>a &lt;- c(0, 2, 0, -2)</code>.
For this example, we have uncertain prior information that
<code class="reqn">\tau = c^{\top} \beta = 0</code>, where the column vector <code class="reqn">c</code> is specified by the command
<code>c &lt;- c(0, 0, 0, 1)</code>.
The known correlation <code class="reqn">\rho</code> between <code class="reqn">\widehat{\theta}</code> and <code class="reqn">\widehat{\tau}</code> is
computed using the command
<code>rho &lt;- acX_to_rho(a, c, X)</code>.
The desired minimum coverage probability of the CIUUPI is <code class="reqn">1 - \alpha</code>, where
<code class="reqn">\alpha = 0.05</code>, which is specified by the command
<code>alpha &lt;- 0.05</code>.
The CIUUPI is determined by <code class="reqn">\alpha</code> and <code class="reqn">\rho</code> and is found using the
command
<code>bs.list.example &lt;- bs_ciuupi(alpha, rho)</code>,
which takes about 5 minutes to run.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bs.list.example
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 8.
</p>


<h3>References</h3>

<p>Box, G.E.P., Connor, L.R., Cousins, W.R., Davies, O.L., Hinsworth, F.R., Sillitto, G.P. (1963)
The Design and Analysis
of Industrial Experiments, 2nd edition, reprinted. Oliver and Boyd, London.
</p>
<p>Kabaila, P. and Giri, K. (2009) Confidence intervals in regression utilizing
prior information.  Journal of Statistical Planning and Inference, 139,
3419 - 3429.
</p>

<hr>
<h2 id='bsspline'>Evaluate the functions <code class="reqn">b</code> and <code class="reqn">s</code> at <code>x</code></h2><span id='topic+bsspline'></span>

<h3>Description</h3>

<p>Evaluate the functions <code class="reqn">b</code> and <code class="reqn">s</code>, as specified by
<code>bsvec</code>,
<code>alpha</code>, <code>d</code>, <code>n.ints</code> and <code>natural</code>, at <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bsspline(x, bsvec, alpha, d, n.ints, natural)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bsspline_+3A_x">x</code></td>
<td>
<p>A value or vector of values at which the functions <code class="reqn">b</code>
and <code class="reqn">s</code> are to be evaluated</p>
</td></tr>
<tr><td><code id="bsspline_+3A_bsvec">bsvec</code></td>
<td>
<p>The <code class="reqn">(2q-1)</code>-vector
</p>
<p style="text-align: center;"><code class="reqn">\big(b(h),...,b((q-1)h), s(0),s(h)...,s((q-1)h) \big),</code>
</p>

<p>where <code class="reqn">q</code>=ceiling(<code class="reqn">d</code>/0.75) and <code class="reqn">h=d/q</code>.
This vector specifies the CIUUPI, for all possible values of the random
error variance and the observed response vector</p>
</td></tr>
<tr><td><code id="bsspline_+3A_alpha">alpha</code></td>
<td>
<p>The desired minimum coverage probability is <code class="reqn">1 - \alpha</code></p>
</td></tr>
<tr><td><code id="bsspline_+3A_d">d</code></td>
<td>
<p>The functions <code class="reqn">b</code> and <code class="reqn">s</code> are specified by cubic splines
on the interval <code class="reqn">[-d, d]</code></p>
</td></tr>
<tr><td><code id="bsspline_+3A_n.ints">n.ints</code></td>
<td>
<p>The number of equal-length intervals in <code class="reqn">[0, d]</code>, where
the endpoints of these intervals specify the knots,
belonging to <code class="reqn">[0, d]</code>, of the cubic spline interpolations
that specify the functions <code class="reqn">b</code> and <code class="reqn">s</code>. In the description
of <code>bsvec</code>, <code>n.ints</code> is also called <code class="reqn">q</code>.</p>
</td></tr>
<tr><td><code id="bsspline_+3A_natural">natural</code></td>
<td>
<p>Equal to 1 (default) if the <code class="reqn">b</code> and <code class="reqn">s</code> functions are obtained by
natural cubic spline interpolation or 0 if obtained by clamped cubic spline
interpolation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing <code>x</code> and the corresponding values of the
functions <code class="reqn">b</code> and <code class="reqn">s</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(0, 8, by = 1)
alpha &lt;- bs.list.example$alpha
natural &lt;- bs.list.example$natural
d &lt;- bs.list.example$d
n.ints &lt;- bs.list.example$n.ints
bsvec &lt;- bs.list.example$bsvec
bs &lt;- bsspline(x, bsvec, alpha, d, n.ints, natural)

</code></pre>

<hr>
<h2 id='ci_standard'>For given observed response vector <code class="reqn">y</code>, compute
the standard <code class="reqn">1 - \alpha</code> confidence interval</h2><span id='topic+ci_standard'></span>

<h3>Description</h3>

<p>If <code class="reqn">\sigma</code> is provided then compute the standard <code class="reqn">1 - \alpha</code>
confidence interval for <code class="reqn">\theta</code>. If <code class="reqn">\sigma</code>
is not provided
then, as long as <code class="reqn">n-p \ge 30</code>, replace <code class="reqn">\sigma</code> by its estimate
to compute an approximate <code class="reqn">1 - \alpha</code> confidence interval for <code class="reqn">\theta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ci_standard(a, X, y, alpha, sig = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ci_standard_+3A_a">a</code></td>
<td>
<p>The vector used to specify the parameter of interest
<code class="reqn">\theta = a^{\top} \beta</code></p>
</td></tr>
<tr><td><code id="ci_standard_+3A_x">X</code></td>
<td>
<p>The known <code class="reqn">n \times p</code> design matrix, with linearly
independent columns</p>
</td></tr>
<tr><td><code id="ci_standard_+3A_y">y</code></td>
<td>
<p>The <code class="reqn">n</code>-vector of observed responses</p>
</td></tr>
<tr><td><code id="ci_standard_+3A_alpha">alpha</code></td>
<td>
<p><code class="reqn">1 - \alpha</code> is the coverage
probability of the standard confidence interval</p>
</td></tr>
<tr><td><code id="ci_standard_+3A_sig">sig</code></td>
<td>
<p>Standard deviation of the random error.
If a value is not specified then, provided that <code class="reqn">n-p \ge 30</code>,
<code>sig</code> is estimated from the data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that </p>
<p style="text-align: center;"><code class="reqn">y = X \beta + \varepsilon,</code>
</p>

<p>where <code class="reqn">y</code> is a random <code class="reqn">n</code>-vector of responses, <code class="reqn">X</code>
is a known <code class="reqn">n \times p</code> matrix with linearly independent columns,
<code class="reqn">\beta</code> is an unknown parameter <code class="reqn">p</code>-vector, and
<code class="reqn">\varepsilon \sim N(0, \, \sigma^2 \, I)</code>, with <code class="reqn">\sigma^2</code> assumed known.
Suppose that the parameter of interest is <code class="reqn">\theta = a^{\top} \beta</code>.
The R function <code>ci_standard</code> computes the standard <code class="reqn">1 - \alpha</code>
confidence interval for <code class="reqn">\theta</code>.
</p>
<p>The example below is described in Discussion 5.8 on
p.3426 of Kabaila and Giri (2009). This example is obtained
by extracting a <code class="reqn">2 \times 2</code> factorial data set from the
<code class="reqn">2^3</code> factorial data set described in Table 7.5
of Box et al. (1963).
</p>


<h3>Value</h3>

<p>If <code class="reqn">\sigma</code> is provided then a data frame of the lower and upper
endpoints of the standard <code class="reqn">1 - \alpha</code> confidence interval
for <code class="reqn">\theta</code>. If <code class="reqn">\sigma</code>
is not provided then, as long as <code class="reqn">n-p \ge 30</code>, a data frame of the
lower and upper endpoints of
an approximation to this confidence interval.
</p>


<h3>References</h3>

<p>Box, G.E.P., Connor, L.R., Cousins, W.R., Davies, O.L., Hinsworth, F.R., Sillitto, G.P. (1963)
The Design and Analysis
of Industrial Experiments, 2nd edition, reprinted. Oliver and Boyd, London.
</p>
<p>Kabaila, P. and Giri, K. (2009) Confidence intervals in regression utilizing
prior information.  Journal of Statistical Planning and Inference, 139,
3419 - 3429.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y &lt;- c(87.2, 88.4, 86.7, 89.2)
x1 &lt;- c(-1, 1, -1, 1)
x2 &lt;- c(-1, -1, 1, 1)
X &lt;- cbind(rep(1, 4), x1, x2, x1*x2)
a &lt;- c(0, 2, 0, -2)
ci_standard(a, X, y, 0.05, sig = 0.8)

</code></pre>

<hr>
<h2 id='ciuupi_observed_value'>For given observed response vector <code class="reqn">y</code>,
compute the confidence interval that utilizes the
uncertain prior information (CIUUPI)</h2><span id='topic+ciuupi_observed_value'></span>

<h3>Description</h3>

<p>If <code class="reqn">\sigma</code> is provided then, for given observed response
vector <code class="reqn">y</code>,
compute the confidence interval, with minimum coverage
probability <code class="reqn">1-\alpha</code>, for the parameter
<code class="reqn">\theta =a^{\top}\beta</code> that
utilizes the uncertain prior information that the parameter
<code class="reqn">\tau=c^{\top} \beta-t</code>
(specified by the vector <code class="reqn">c</code> and the number
<code class="reqn">t</code>) takes the value 0. If <code class="reqn">\sigma</code>
is not provided
then, as long as <code class="reqn">n-p \ge 30</code>, replace <code class="reqn">\sigma</code> by its estimate
to compute an approximation to the CIUUPI for <code class="reqn">\theta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciuupi_observed_value(a, c, X, alpha, bs.list, t, y, sig = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciuupi_observed_value_+3A_a">a</code></td>
<td>
<p>The <code class="reqn">p</code>-vector <code class="reqn">a</code> that specifies the parameter of interest
<code class="reqn">\theta =a^{\top}\beta</code></p>
</td></tr>
<tr><td><code id="ciuupi_observed_value_+3A_c">c</code></td>
<td>
<p>The <code class="reqn">p</code>-vector <code class="reqn">c</code> used in the specification of the parameter
<code class="reqn">\tau=c^{\top} \beta-t</code>. The uncertain prior
information is that <code class="reqn">\tau=0</code></p>
</td></tr>
<tr><td><code id="ciuupi_observed_value_+3A_x">X</code></td>
<td>
<p>The <code class="reqn">n \times p</code> design matrix <code class="reqn">X</code>, with linearly
independent columns</p>
</td></tr>
<tr><td><code id="ciuupi_observed_value_+3A_alpha">alpha</code></td>
<td>
<p><code class="reqn">1 - \alpha</code> is the desired minimum coverage probability of the
confidence interval for <code class="reqn">\theta</code></p>
</td></tr>
<tr><td><code id="ciuupi_observed_value_+3A_bs.list">bs.list</code></td>
<td>
<p>A list that includes the following
components:
natural, d, q and the vector
bsvec (b(h),...,b((q-1)h), s(0),s(h)...,s((q-1)h)), where
h=d/q,
that specifies the CIUUPI for all possible values of the random
error variance and the observed response vector</p>
</td></tr>
<tr><td><code id="ciuupi_observed_value_+3A_t">t</code></td>
<td>
<p>The number <code class="reqn">t</code> used to specify the parameter <code class="reqn">\tau=c^{\top} \beta-t</code>.
The uncertain prior information is that <code class="reqn">\tau = 0</code></p>
</td></tr>
<tr><td><code id="ciuupi_observed_value_+3A_y">y</code></td>
<td>
<p>The <code class="reqn">n</code>-vector of observed responses</p>
</td></tr>
<tr><td><code id="ciuupi_observed_value_+3A_sig">sig</code></td>
<td>
<p>Standard deviation of the random error.
If a value is not specified then, provided that <code class="reqn">n-p \ge 30</code>,
<code>sig</code> is estimated from the data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that </p>
<p style="text-align: center;"><code class="reqn">y = X \beta + \varepsilon</code>
</p>

<p>where <code class="reqn">y</code> is a random <code class="reqn">n</code>-vector of
responses, <code class="reqn">X</code> is a known <code class="reqn">n \times p</code>
matrix with linearly
independent columns, <code class="reqn">\beta</code> is an unknown parameter
<code class="reqn">p</code>-vector and
<code class="reqn">\varepsilon</code> has components that are iid normally distributed
with zero mean and known variance.
Suppose that
<code class="reqn">\theta=</code><code>a</code><code class="reqn">^{\top}</code> <code class="reqn">\beta</code> is the
parameter of interest, where <code>a</code> is a specified
vector. Let
<code class="reqn">\tau=</code><code>c</code><code class="reqn">^{\top} \beta -</code><code>t</code>,
where <code>c</code> is a specified vector,
<code>t</code> is a specified number and
<code>a</code> and <code>c</code> are
linearly independent vectors. Also suppose that we have
uncertain prior information that <code class="reqn">\tau = 0</code>.
For given observed response
vector <code>y</code> and a design matrix <code>X</code>,
<code>ciuupi_observed_value</code> computes the
confidence interval, with minimum coverage probability
1<code class="reqn">-</code><code>alpha</code>, for <code class="reqn">\theta</code>
that utilizes the uncertain prior information that
<code class="reqn">\tau = 0</code>.
</p>
<p>The example below is described in Discussion 5.8 on
p.3426 of Kabaila and Giri (2009). This example is obtained
by extracting a <code class="reqn">2 \times 2</code> factorial data set from the
<code class="reqn">2^3</code> factorial data set described in Table 7.5
of Box et al. (1963).
</p>


<h3>Value</h3>

<p>If <code class="reqn">\sigma</code> is provided then a data frame of the lower and upper
endpoints of
the confidence interval, with minimum coverage
probability <code class="reqn">1-\alpha</code>, for the parameter
<code class="reqn">\theta</code> that utilizes the
uncertain prior information that <code class="reqn">\tau = 0</code>.
If <code class="reqn">\sigma</code>
is not provided then, as long as <code class="reqn">n-p \ge 30</code>, a data frame of the
lower and upper endpoints of
an approximation to this confidence interval.
</p>


<h3>References</h3>

<p>Box, G.E.P., Connor, L.R., Cousins, W.R., Davies, O.L., Hinsworth, F.R., Sillitto, G.P. (1963)
The Design and Analysis
of Industrial Experiments, 2nd edition, reprinted. Oliver and Boyd, London.
</p>
<p>Kabaila, P. and Giri, K. (2009) Confidence intervals in regression utilizing
prior information.  Journal of Statistical Planning and Inference, 139,
3419 - 3429.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- c(0, 2, 0, -2)
c &lt;- c(0, 0, 0, 1)
x1 &lt;- c(-1, 1, -1, 1)
x2 &lt;- c(-1, -1, 1, 1)
X &lt;- cbind(rep(1, 4), x1, x2, x1*x2)
alpha &lt;- 0.05
t &lt;- 0
y &lt;- c(87.2, 88.4, 86.7, 89.2)
sig &lt;- 0.8
ciuupi_observed_value(a, c, X, alpha, bs.list.example, t, y, sig=sig)

</code></pre>

<hr>
<h2 id='cpciuupi'>Compute the coverage probability of the CIUUPI</h2><span id='topic+cpciuupi'></span>

<h3>Description</h3>

<p>Evaluate the coverage probability of the confidence interval that
utilizes uncertain prior information (CIUUPI) at <code>gam</code>.
The input <code>bs.list</code> determines the functions <code class="reqn">b</code> and <code class="reqn">s</code>
that specify the confidence interval that utilizes the uncertain
prior information (CIUUPI), for all possible values of <code class="reqn">\sigma</code>
and observed response vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpciuupi(gam, n.nodes, bs.list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cpciuupi_+3A_gam">gam</code></td>
<td>
<p>A value of <code class="reqn">\gamma</code> or vector of values of <code class="reqn">\gamma</code> at which
the coverage probability function is evaluated</p>
</td></tr>
<tr><td><code id="cpciuupi_+3A_n.nodes">n.nodes</code></td>
<td>
<p>The number of nodes for the Gauss Legendre quadrature used for
the evaluation of the coverage probability</p>
</td></tr>
<tr><td><code id="cpciuupi_+3A_bs.list">bs.list</code></td>
<td>
<p>A list that includes the following
components.
</p>
<p><code>alpha</code>: <code class="reqn">1 - \alpha</code> is the desired minimum coverage probability of the
confidence interval
</p>
<p><code>rho</code>: The known correlation <code class="reqn">\rho</code> between
<code class="reqn">\widehat{\theta}</code> and <code class="reqn">\widehat{\tau}</code>
</p>
<p><code>natural</code>: 1 when the functions <code class="reqn">b</code> and <code class="reqn">s</code> are
specified by natural cubic spline interpolation
or 0 if these functions are specified by clamped
cubic spline interpolation
</p>
<p><code>d</code>: the functions <code class="reqn">b</code> and <code class="reqn">s</code> are specified by
cubic splines on the interval <code class="reqn">[-d, d]</code>
</p>
<p><code>n.ints</code>: number of equal-length intervals in <code class="reqn">[0, d]</code>, where
the endpoints of these intervals specify the knots,
belonging to <code class="reqn">[0, d]</code>, of the cubic spline interpolations
that specify the functions <code class="reqn">b</code> and <code class="reqn">s</code>. In the description
of <code>bsvec</code>, <code>n.ints</code> is also called <code class="reqn">q</code>.
</p>
<p><code>bsvec</code>: the <code class="reqn">(2q-1)</code>-vector
</p>
<p style="text-align: center;"><code class="reqn">\big(b(h),...,b((q-1)h), s(0),s(h)...,s((q-1)h)\big),</code>
</p>

<p>where <code class="reqn">q</code>=ceiling(<code class="reqn">d</code>/0.75) and <code class="reqn">h=d/q</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value(s) of the coverage probability of the CIUUPI at <code>gam</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gam &lt;- seq(0, 10, by = 0.2)
n.nodes &lt;- 10
cp &lt;- cpciuupi(gam, n.nodes, bs.list.example)

</code></pre>

<hr>
<h2 id='plot_b'>Plot the graph of the odd function <code class="reqn">b</code> used in the specification of the CIUUPI</h2><span id='topic+plot_b'></span>

<h3>Description</h3>

<p>The input <code>bs.list</code> determines the functions <code class="reqn">b</code> and <code class="reqn">s</code>
that specify the confidence interval that utilizes the uncertain
prior information (CIUUPI), for all possible values of <code class="reqn">\sigma</code>
and observed response vector. The R function <code>plot_b</code>
plots the graph of the odd function <code class="reqn">b</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_b(bs.list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_b_+3A_bs.list">bs.list</code></td>
<td>
<p>A list that includes the following
components.
</p>
<p><code>alpha</code>: the desired minimum coverage is <code class="reqn">1 - \alpha</code>.
</p>
<p><code>rho</code>: the known correlation
between <code class="reqn">\widehat{\theta}</code>
and <code class="reqn">\widehat{\tau}</code>. This correlation is computed from the
<code class="reqn">p</code>-vectors
<code class="reqn">a</code> and <code class="reqn">c</code> and the <code class="reqn">n \times p</code>
design matrix <code class="reqn">X</code> using the formula
<code class="reqn">\rho=a^{\top}(X^{\top}X)^{-1}c /(v_{\theta} \, v_{\tau})^{1/2}</code>, where
<code class="reqn">v_{\theta}
=a^{\top}(X^{\top}X)^{-1} a</code> and
<code class="reqn">v_{\tau}
=c^{\top}(X^{\top}X)^{-1} c</code>.
</p>
<p><code>natural</code>: 1 when the functions <code class="reqn">b</code> and <code class="reqn">s</code> are
specified by natural cubic spline interpolation
or 0 if these functions are specified by clamped
cubic spline interpolation
</p>
<p><code>d</code>: the functions <code class="reqn">b</code> and <code class="reqn">s</code> are specified by
cubic splines on the interval <code class="reqn">[-d, d]</code>
</p>
<p><code>n.ints</code>: number of equal-length intervals in <code class="reqn">[0, d]</code>, where
the endpoints of these intervals specify the knots,
belonging to <code class="reqn">[0, d]</code>, of the cubic spline interpolations
that specify the functions b and s. In the description
of <code>bsvec</code>, <code>n.ints</code> is also called <code class="reqn">q</code>.
</p>
<p><code>bsvec</code>: the <code class="reqn">(2q-1)</code>-vector
</p>
<p style="text-align: center;"><code class="reqn">\big(b(h),...,b((q-1)h), s(0),s(h)...,s((q-1)h) \big),</code>
</p>

<p>where <code class="reqn">q</code>=ceiling(<code class="reqn">d</code>/0.75) and <code class="reqn">h=d/q</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the graph of the odd function <code class="reqn">b</code> used in the
specification of the CIUUPI.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_b(bs.list.example)

</code></pre>

<hr>
<h2 id='plot_cp'>Plot the graph of the coverage probability
of the CIUUPI</h2><span id='topic+plot_cp'></span>

<h3>Description</h3>

<p>The input <code>bs.list</code> determines the functions <code class="reqn">b</code> and <code class="reqn">s</code>
that specify the confidence interval that utilizes the uncertain
prior information (CIUUPI), for all possible values of <code class="reqn">\sigma</code>
and observed response vector.
The coverage probability of the CIUUPI is an even function of
the unknown parameter
<code class="reqn">\gamma = \tau \big/ \big(\sigma \, v_{\tau}^{1/2} \big)</code>.
The R function <code>plot_cp</code> plots the graph of the coverage probability
of the CIUUPI, as a function of <code class="reqn">|\gamma|</code>.
To provide a stringent
assessment of this coverage probability, we use a fine equally-spaced grid
<code>seq(0, (d+4), by = 0.01)</code> of values of
<code class="reqn">\gamma</code> and Gauss Legendre quadrature
using 10 nodes in the relevant integrals. By contrast,
for the computation
of the CIUUPI, implemented in <code>bs_ciuupi</code>, we
require that the coverage probability of this confidence
interval is greater than or equal to <code class="reqn">1-\alpha</code>
for the equally-spaced grid <code>seq(0, (d+2), by = 0.05)</code> of values of
<code class="reqn">\gamma</code> and we use Gauss Legendre quadrature
with 5 nodes in the relevant integrals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_cp(bs.list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_cp_+3A_bs.list">bs.list</code></td>
<td>
<p>A list that includes the following
components.
</p>
<p><code>alpha</code>: the desired minimum coverage is <code class="reqn">1 - \alpha</code>.
</p>
<p><code>rho</code>: the known correlation
between <code class="reqn">\widehat{\theta}</code>
and <code class="reqn">\widehat{\tau}</code>. This correlation is computed from the
<code class="reqn">p</code>-vectors
<code class="reqn">a</code> and <code class="reqn">c</code> and the <code class="reqn">n \times p</code>
design matrix <code class="reqn">X</code> using the formula
<code class="reqn">\rho=a^{\top}(X^{\top}X)^{-1}c /(v_{\theta} \, v_{\tau})^{1/2}</code>, where
<code class="reqn">v_{\theta}
=a^{\top}(X^{\top}X)^{-1} a</code> and
<code class="reqn">v_{\tau}
=c^{\top}(X^{\top}X)^{-1} c</code>.
</p>
<p><code>natural</code>: 1 when the functions <code class="reqn">b</code> and <code class="reqn">s</code> are
specified by natural cubic spline interpolation
or 0 if these functions are specified by clamped
cubic spline interpolation
</p>
<p><code>d</code>: the functions <code class="reqn">b</code> and <code class="reqn">s</code> are specified by
cubic splines on the interval <code class="reqn">[-d, d]</code>
</p>
<p><code>n.ints</code>: number of equal-length intervals in <code class="reqn">[0, d]</code>, where
the endpoints of these intervals specify the knots,
belonging to <code class="reqn">[0, d]</code>, of the cubic spline interpolations
that specify the functions b and s. In the description
of <code>bsvec</code>, <code>n.ints</code> is also called <code class="reqn">q</code>.
</p>
<p><code>bsvec</code>: the <code class="reqn">(2q-1)</code>-vector
</p>
<p style="text-align: center;"><code class="reqn">\big(b(h),...,b((q-1)h), s(0),s(h)...,s((q-1)h) \big),</code>
</p>

<p>where <code class="reqn">q</code>=ceiling(<code class="reqn">d</code>/0.75) and <code class="reqn">h=d/q</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the graph of the coverage probability of the
CIUUPI as a function of <code class="reqn">|\gamma|</code>, where
<code class="reqn">\gamma</code> denotes the unknown parameter
<code class="reqn">\tau \big/ \big(\sigma \, v_{\tau}^{1/2} \big)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_cp(bs.list.example)

</code></pre>

<hr>
<h2 id='plot_s'>Plot the graph of the even function <code class="reqn">s</code> used in the specification of the CIUUPI</h2><span id='topic+plot_s'></span>

<h3>Description</h3>

<p>The input <code>bs.list</code> determines the functions <code class="reqn">b</code> and <code class="reqn">s</code>
that specify the confidence interval that utilizes the uncertain
prior information (CIUUPI), for all possible values of <code class="reqn">\sigma</code>
and observed response vector. The R function <code>plot_s</code>
plots the graph of the odd function <code class="reqn">s</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_s(bs.list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_s_+3A_bs.list">bs.list</code></td>
<td>
<p>A list that includes the following
components.
</p>
<p><code>alpha</code>: the desired minimum coverage is <code class="reqn">1 - \alpha</code>.
</p>
<p><code>rho</code>: the known correlation
between <code class="reqn">\widehat{\theta}</code>
and <code class="reqn">\widehat{\tau}</code>. This correlation is computed from the
<code class="reqn">p</code>-vectors
<code class="reqn">a</code> and <code class="reqn">c</code> and the <code class="reqn">n \times p</code>
design matrix <code class="reqn">X</code> using the formula
<code class="reqn">\rho=a^{\top}(X^{\top}X)^{-1}c /(v_{\theta} \, v_{\tau})^{1/2}</code>, where
<code class="reqn">v_{\theta}
=a^{\top}(X^{\top}X)^{-1} a</code> and
<code class="reqn">v_{\tau}
=c^{\top}(X^{\top}X)^{-1} c</code>.
</p>
<p><code>natural</code>: 1 when the functions <code class="reqn">b</code> and <code class="reqn">s</code> are
specified by natural cubic spline interpolation
or 0 if these functions are specified by clamped
cubic spline interpolation
</p>
<p><code>d</code>: the functions <code class="reqn">b</code> and <code class="reqn">s</code> are specified by
cubic splines on the interval <code class="reqn">[-d, d]</code>
</p>
<p><code>n.ints</code>: number of equal-length intervals in <code class="reqn">[0, d]</code>, where
the endpoints of these intervals specify the knots,
belonging to <code class="reqn">[0, d]</code>, of the cubic spline interpolations
that specify the functions b and s. In the description
of <code>bsvec</code>, <code>n.ints</code> is also called <code class="reqn">q</code>.
</p>
<p><code>bsvec</code>: the <code class="reqn">(2q-1)</code>-vector
</p>
<p style="text-align: center;"><code class="reqn">\big(b(h),...,b((q-1)h), s(0),s(h)...,s((q-1)h) \big),</code>
</p>

<p>where <code class="reqn">q</code>=ceiling(<code class="reqn">d</code>/0.75) and <code class="reqn">h=d/q</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the graph of the even function <code class="reqn">s</code> used in the
specification of the CIUUPI.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_s(bs.list.example)

</code></pre>

<hr>
<h2 id='plot_squared_sel'>Plot the graph of the squared scaled expected length
of the CIUUPI</h2><span id='topic+plot_squared_sel'></span>

<h3>Description</h3>

<p>The input <code>bs.list</code> determines the functions <code class="reqn">b</code> and <code class="reqn">s</code>
that specify the confidence interval that utilizes the uncertain
prior information (CIUUPI), for all possible values of <code class="reqn">\sigma</code>
and observed response vector.
The scaled expected length of the CIUUPI is an even function of
the unknown parameter
<code class="reqn">\gamma = \tau \big/ \big(\sigma \, v_{\tau}^{1/2} \big)</code>.
The R function <code>plot_squared_sel</code> plots the graph of the squared scaled
expected length (i.e. squared SEL)
of the CIUUPI, as a function of <code class="reqn">|\gamma|</code>.
To provide a stringent
assessment of this squared SEL, we use a grid
<code>seq(0, (d+4), by = 0.01)</code> of values of
<code class="reqn">\gamma</code> and Gauss Legendre quadrature
with 10 nodes in the relevant integrals. By contrast,
for the computation
of the CIUUPI, implemented in <code>bs_ciuupi</code>, we
use Gauss Legendre quadrature
with 5 nodes in the relevant integrals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_squared_sel(bs.list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_squared_sel_+3A_bs.list">bs.list</code></td>
<td>
<p>A list that includes the following
components.
</p>
<p><code>alpha</code>: the desired minimum coverage is <code class="reqn">1 - \alpha</code>.
</p>
<p><code>rho</code>: the known correlation
between <code class="reqn">\widehat{\theta}</code>
and <code class="reqn">\widehat{\tau}</code>. This correlation is computed from the
<code class="reqn">p</code>-vectors
<code class="reqn">a</code> and <code class="reqn">c</code> and the <code class="reqn">n \times p</code>
design matrix <code class="reqn">X</code> using the formula
<code class="reqn">\rho=a^{\top}(X^{\top}X)^{-1}c /(v_{\theta} \, v_{\tau})^{1/2}</code>, where
<code class="reqn">v_{\theta}
=a^{\top}(X^{\top}X)^{-1} a</code> and
<code class="reqn">v_{\tau}
=c^{\top}(X^{\top}X)^{-1} c</code>.
</p>
<p><code>natural</code>: 1 when the functions <code class="reqn">b</code> and <code class="reqn">s</code> are
specified by natural cubic spline interpolation
or 0 if these functions are specified by clamped
cubic spline interpolation
</p>
<p><code>d</code>: the functions <code class="reqn">b</code> and <code class="reqn">s</code> are specified by
cubic splines on the interval <code class="reqn">[-d, d]</code>
</p>
<p><code>n.ints</code>: number of equal-length intervals in <code class="reqn">[0, d]</code>, where
the endpoints of these intervals specify the knots,
belonging to <code class="reqn">[0, d]</code>, of the cubic spline interpolations
that specify the functions b and s. In the description
of <code>bsvec</code>, <code>n.ints</code> is also called <code class="reqn">q</code>.
</p>
<p><code>bsvec</code>: the <code class="reqn">(2q-1)</code>-vector
</p>
<p style="text-align: center;"><code class="reqn">\big(b(h),...,b((q-1)h), s(0),s(h)...,s((q-1)h) \big),</code>
</p>

<p>where <code class="reqn">q</code>=ceiling(<code class="reqn">d</code>/0.75) and <code class="reqn">h=d/q</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the graph of the squared scaled
expected length (i.e. squared SEL)
of the CIUUPI as a function of <code class="reqn">|\gamma|</code>, where
<code class="reqn">\gamma</code> denotes the unknown parameter
<code class="reqn">\tau \big/ \big(\sigma \, v_{\tau}^{1/2} \big)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_squared_sel(bs.list.example)

</code></pre>

<hr>
<h2 id='selciuupi'>Compute the scaled expected length of the CIUUPI</h2><span id='topic+selciuupi'></span>

<h3>Description</h3>

<p>Evaluate the scaled expected length of the confidence interval that
utilizes uncertain prior information (CIUUPI) at <code>gam</code>.
This scaled expected length is defined to be the expected length of the
CIUUPI divided
by the expected length of the standard <code class="reqn">1 - \alpha</code> confidence interval.
The input <code>bs.list</code> determines the functions <code class="reqn">b</code> and <code class="reqn">s</code>
that specify the confidence interval that utilizes the uncertain
prior information (CIUUPI), for all possible values of <code class="reqn">\sigma</code>
and observed response vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selciuupi(gam, n.nodes, bs.list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selciuupi_+3A_gam">gam</code></td>
<td>
<p>A value of <code class="reqn">\gamma</code> or vector of <code class="reqn">\gamma</code> values at which
the coverage probability function is evaluated</p>
</td></tr>
<tr><td><code id="selciuupi_+3A_n.nodes">n.nodes</code></td>
<td>
<p>The number of nodes for the Gauss Legendre quadrature used for
the evaluation of the scaled expected length</p>
</td></tr>
<tr><td><code id="selciuupi_+3A_bs.list">bs.list</code></td>
<td>
<p>A list that includes the following
components.
</p>
<p><code>alpha</code>: <code class="reqn">1 - \alpha</code> is the desired minimum coverage probability of the
confidence interval
</p>
<p><code>rho</code>: The known correlation <code class="reqn">\rho</code> between
<code class="reqn">\widehat{\theta}</code> and <code class="reqn">\widehat{\tau}</code>
</p>
<p><code>natural</code>: 1 when the functions <code class="reqn">b</code> and <code class="reqn">s</code> are
specified by natural cubic spline interpolation
or 0 if these functions are specified by clamped
cubic spline interpolation
</p>
<p><code>d</code>: the functions <code class="reqn">b</code> and <code class="reqn">s</code> are specified by
cubic splines on the interval <code class="reqn">[-d, d]</code>
</p>
<p><code>n.ints</code>: number of equal-length intervals in <code class="reqn">[0, d]</code>, where
the endpoints of these intervals specify the knots,
belonging to <code class="reqn">[0, d]</code>, of the cubic spline interpolations
that specify the functions <code class="reqn">b</code> and <code class="reqn">s</code>. In the description
of <code>bsvec</code>, <code>n.ints</code> is also called <code class="reqn">q</code>.
</p>
<p><code>bsvec</code>: the <code class="reqn">(2q-1)</code>-vector
</p>
<p style="text-align: center;"><code class="reqn">\big(b(h),...,b((q-1)h), s(0),s(h)...,s((q-1)h)\big),</code>
</p>

<p>where <code class="reqn">q</code>=ceiling(<code class="reqn">d</code>/0.75) and <code class="reqn">h=d/q</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value(s) of the scaled expected length at <code>gam</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gam &lt;- seq(0, 10, by = 0.2)
n.nodes &lt;- 10
sel &lt;- selciuupi(gam, n.nodes, bs.list.example)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
