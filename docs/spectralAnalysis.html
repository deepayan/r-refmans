<!DOCTYPE html><html lang="en"><head><title>Help for package spectralAnalysis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spectralAnalysis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addMessage'><p>add an message to list of messages for printing #</p></a></li>
<li><a href='#addPreprocessingStep'><p>function to use by preprocessing step</p></a></li>
<li><a href='#baselineCorrect'><p>generic function to perfom baseline correction</p></a></li>
<li><a href='#changeDevSettings'><p>Function to overwrite default settings</p></a></li>
<li><a href='#checkCompatible'><p>Check object compatibility</p></a></li>
<li><a href='#checkForRedundantSources'><p>Check for redunt NMF source vectors</p></a></li>
<li><a href='#checkIdenticalClass'><p>check wether all elements of of the same class</p></a></li>
<li><a href='#checkMethod'><p>check method in list of allowd method</p></a></li>
<li><a href='#checkTimeUnit'><p>check timeeUnit  and produce error if not correct unit</p></a></li>
<li><a href='#combineSpectralObjects'><p>Function to combine <code>SpectraInTime-class</code> objects containing 1 spectrum each</p></a></li>
<li><a href='#completeSourceMatrix'><p>complete source matrix</p></a></li>
<li><a href='#computeNMFResidu'><p>NMF relative residual per observation</p></a></li>
<li><a href='#convertListToS4'><p>convert an a named list to S4 object</p></a></li>
<li><a href='#convertS4ToList'><p>convert an S4 object into a list</p></a></li>
<li><a href='#e'><p>Create an <code>ElementsToSelect-class</code> from a numeric vector or multiple numeric values or vectors</p></a></li>
<li><a href='#ElementsToSelect-class'><p>Elements S4 class useful for closest elements subsetting</p></a></li>
<li><a href='#first'><p>return first element (of a vector)</p></a></li>
<li><a href='#firstSpectrum'><p>Get the first spectrum</p></a></li>
<li><a href='#flagVectorInInterval'><p>flag vector elements within interval (closed interval )</p></a></li>
<li><a href='#getClosestElements'><p>get closest element for elements looked up in a vector</p></a></li>
<li><a href='#getDefaultSumFunc'><p>function to get default summary functions</p></a></li>
<li><a href='#getDefaultTimeFormat'><p>function to get default time format in the package</p></a></li>
<li><a href='#getDimensionReduction'><p>generic function to extract <code>dimensionReduction</code>-slot</p></a></li>
<li><a href='#getElements'><p>generic function to extract <code>elements</code>-slot</p></a></li>
<li><a href='#getExperimentName'><p>generic function to extract <code>experimentName</code>-slot</p></a></li>
<li><a href='#getExtraInfo'><p>generic function to extract <code>extraInfo</code>-slot</p></a></li>
<li><a href='#getListOfSpectraExample'><p>get example list of spectra</p></a></li>
<li><a href='#getNMFInputMatrix'><p>Get spectralData as input NMF model</p></a></li>
<li><a href='#getPathProcessTimesExample'><p>example path process times</p></a></li>
<li><a href='#getPreprocessing'><p>generic function to extract <code>preprocessing</code>-slot</p></a></li>
<li><a href='#getProcessTimesExample'><p>get a minimal <code>ProcessTimes-class</code> example based on</p>
<code>getSpectraInTimeExample</code></a></li>
<li><a href='#getProcessTimesFrameExample'><p>get mimimal example <code>ProcessTimesFrame-class</code></p></a></li>
<li><a href='#getRange'><p>generic function to extract <code>range</code>-slot</p></a></li>
<li><a href='#getSpectra'><p>generic function to extract <code>spectra</code>-slot</p></a></li>
<li><a href='#getSpectraInTimeCompExample'><p>Artificial example of <code>SpectraInTimeComp-class</code></p></a></li>
<li><a href='#getSpectraInTimeExample'><p>Artificial example <code>SpectraInTime-class</code></p></a></li>
<li><a href='#getSpectralAxis'><p>generic function to extract <code>spectralAxis</code>-slot</p></a></li>
<li><a href='#getStartTime'><p>generic function to extract <code>startTime</code>-slot</p></a></li>
<li><a href='#getTimeConversionFactor'><p>transform timeUnit to convert from seconds to specified unit</p></a></li>
<li><a href='#getTimePoints'><p>generic function to extract <code>timePoints</code>-slot</p></a></li>
<li><a href='#getUnits'><p>generic function to extract <code>units</code>-slot</p></a></li>
<li><a href='#includeRedundantSources'><p>Re-introduce redundant sources in NMF-model</p></a></li>
<li><a href='#initializeNMFModel'><p>Initialize NMF model with initial spectral data</p></a></li>
<li><a href='#last'><p>return laste element( of a vector )</p></a></li>
<li><a href='#lastSpectrum'><p>Get the last spectrum</p></a></li>
<li><a href='#loadAllSPCFiles'><p>Load all or a selection of SPC files from a given directory.</p></a></li>
<li><a href='#localBaselineCorrect'><p>Local baseline correction</p></a></li>
<li><a href='#multiplicativeScatterCorrect'><p>multiplicative scatter correction on 1 function</p></a></li>
<li><a href='#nonNegativePreprocessing'><p>condition datamatrix to input in and condition properly for NMF</p></a></li>
<li><a href='#normalize'><p>generic normalization function</p></a></li>
<li><a href='#plotlyAxis'><p>help function to make plotly axis title</p></a></li>
<li><a href='#predictNNLS'><p>Based on previously obtained NMF result <code>NMFResult</code>, estimate coefficients for a new</p>
spectralData object <code>object</code> using non-negative least squares fitting. The result is
returned as as an NMF model.</a></li>
<li><a href='#preprocess'><p>generic function to preprocess an S4 object</p></a></li>
<li><a href='#preprocessSpectraInTimeWithList'><p>internal function to wrap multiple preprocessing steps</p></a></li>
<li><a href='#ProcessTimes-class'><p>S4 Class key process times</p></a></li>
<li><a href='#ProcessTimesFrame-class'><p>ProcessTimes-class</p></a></li>
<li><a href='#r'><p>create a <code>RangeToSubset-class</code> object from 2 elements or from a vector</p></a></li>
<li><a href='#RangeToSubset-class'><p>RangeToSubset-class</p></a></li>
<li><a href='#readProcessTimes'><p>read .csv file as process times</p></a></li>
<li><a href='#readSPC'><p>Read-in of a SPC file.</p></a></li>
<li><a href='#removeRedundantSources'><p>Remove redundant sources from the initial NMF model</p></a></li>
<li><a href='#runNMF'><p>Actual NMF analysis</p></a></li>
<li><a href='#saveSpectra'><p>read or save a <code>SpectraInTime-class</code> from or to a  <code>.txt</code> file</p></a></li>
<li><a href='#scaleNMFResult'><p>Apply fixed scaling to NMF model</p></a></li>
<li><a href='#scatterCorrect'><p>perform multiplicative scatter correction</p></a></li>
<li><a href='#scatterCorrectSpectra'><p>perform multiplicative scatter correction on spectralData</p></a></li>
<li><a href='#setExperimentName+26lt+3B-'><p>set the experiment name</p></a></li>
<li><a href='#setTimePointsAlt+26lt+3B-'><p>set time alternative time axis</p></a></li>
<li><a href='#smooth'><p>generic smoothing function</p></a></li>
<li><a href='#SpectraInTime-class'><p>SpectraInTime-class</p></a></li>
<li><a href='#SpectraInTimeComp-class'><p>SpectraInTimeComp-class (time resolved spectra )</p></a></li>
<li><a href='#spectralIntegration'><p>Integrate spectraInTime object</p></a></li>
<li><a href='#spectralNMF'><p>Perform Non-Negative Matrix factorization on spectral data</p></a></li>
<li><a href='#spectralNMFList'><p>Perform Non-Negative Matrix factorization on list of SPC files</p></a></li>
<li><a href='#spectralNormalization'><p>normalization function</p></a></li>
<li><a href='#spectralPLSCalibration'><p>Compute PLS model</p></a></li>
<li><a href='#spectralPlsPrediction'><p>Perform PLS prediction</p></a></li>
<li><a href='#spectralSmoothAndDifferentiate'><p>internal smoothing and differentiation function</p></a></li>
<li><a href='#subset-methods'><p>Subsetting  <code>SpectraInTime-class</code></p></a></li>
<li><a href='#subset.SpectraTime'><p>internal function for subsetting</p></a></li>
<li><a href='#SummaryByWavelengths-class'><p>S4-class for summary object SpectraInTime</p></a></li>
<li><a href='#testListOfSpectra'><p>internal function to check all elements are spectraInTime</p></a></li>
<li><a href='#timeAlign'><p>Time align first object, using info in the second object</p></a></li>
<li><a href='#timeAlign.listOfSpectra'><p>Align all spectra in a list</p></a></li>
<li><a href='#timeAlign.SpectraInTime'><p>align 1 SpectraInTime with 1 cooling information</p></a></li>
<li><a href='#trapz'><p>Integration via trapezium rule</p></a></li>
<li><a href='#upsampleNMFResult'><p>Upsample NMF result to original temporal resolution</p></a></li>
<li><a href='#wavelengthAlign'><p>Wavelength align spectral data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Pre-Process, Visualize and Analyse Spectral Data</td>
</tr>
<tr>
<td>Version:</td>
<td>4.3.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adriaan Blommaert &lt;adriaan.blommaert@openanalytics.eu&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://openanalytics.eu">https://openanalytics.eu</a></td>
</tr>
<tr>
<td>Description:</td>
<td>
    Infrared, near-infrared and Raman spectroscopic data measured during chemical reactions, provide structural fingerprints by which molecules can be identified and quantified. The application of these spectroscopic techniques as inline process analytical tools (PAT), provides the pharmaceutical and chemical industry with novel tools, allowing to monitor their chemical processes, resulting in a better process understanding through insight in reaction rates, mechanistics, stability, etc.
    Data can be read into R via the generic spc-format, which is generally supported by spectrometer vendor software. Versatile pre-processing functions are available to perform baseline correction by linking to the 'baseline' package; noise reduction via the 'signal' package; as well as time alignment, normalization, differentiation, integration and interpolation. Implementation based on the S4 object system allows storing a pre-processing pipeline as part of a spectral data object, and easily transferring it to other datasets. Interactive plotting tools are provided based on the 'plotly' package. 
    Non-negative matrix factorization (NMF) has been implemented to perform multivariate analyses on individual spectral datasets or on multiple datasets at once. NMF provides a parts-based representation of the spectral data in terms of spectral signatures of the chemical compounds and their relative proportions.
    See 'hNMF'-package for references on available methods. The functionality to read in spc-files was adapted from the 'hyperSpec' package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>baseline, BiocGenerics, data.table, ggplot2, graphics,
jsonlite, magrittr, methods, nnls, NMF, plotly, plyr, dplyr,
RColorBrewer, signal, stats, viridis, hNMF, zoo, pls</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, webshot, bookdown</td>
</tr>
<tr>
<td>Collate:</td>
<td>'internalHelpers.R' 'allGenericFunctions.R'
'objectSpectraInTime.R' 'objectProcessTimes.R'
'objectLinking.R' 'alignmentFunctions.R'
'combineSpectralObjects.R' 'dataManagementTools.R' 'defaults.R'
'objectSpectraInTimeComp.R' 'readSPC.R' 'saveSpectraInTime.R'
'spectralIntegration.R' 'spectralNMF.R' 'spectralPLS.R'
'spectralPreprocessing.R' 'spectralVisualization.R'
'subsetting.R'</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-29 09:55:11 UTC; SMathieu</td>
</tr>
<tr>
<td>Author:</td>
<td>Robin Van Oirbeek [aut],
  Adriaan Blommaert [aut, cre],
  Nicolas Sauwen [aut],
  Tor Maes [ctb],
  Jan Dijkmans [ctb],
  Jef Cuypers [ctb],
  Tatsiana Khamiakova [ctb],
  Michel Thiel [ctb],
  Claudia Beleites [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-30 08:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='addMessage'>add an message to list of messages for printing #</h2><span id='topic+addMessage'></span>

<h3>Description</h3>

<p>add an message to list of messages for printing #
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addMessage(messageList, message)
</code></pre>

<hr>
<h2 id='addPreprocessingStep'>function to use by preprocessing step</h2><span id='topic+addPreprocessingStep'></span>

<h3>Description</h3>

<p>change the spectra and add preprocessing info, check whehther the object is valid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addPreprocessingStep(object, newSpectra, preprocessingInfo)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addPreprocessingStep_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code></p>
</td></tr>
<tr><td><code id="addPreprocessingStep_+3A_newspectra">newSpectra</code></td>
<td>
<p>numeric matrix new spectral data</p>
</td></tr>
<tr><td><code id="addPreprocessingStep_+3A_preprocessinginfo">preprocessingInfo</code></td>
<td>
<p>list of preprocessing info</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>

<hr>
<h2 id='baselineCorrect'>generic function to perfom baseline correction</h2><span id='topic+baselineCorrect'></span><span id='topic+baselineCorrect+2CSpectraInTime-method'></span><span id='topic+baselineCorrect+2CSpectraInTimeComp-method'></span>

<h3>Description</h3>

<p>generic function to perfom baseline correction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>baselineCorrect(object, ...)

## S4 method for signature 'SpectraInTime'
baselineCorrect(object, method = "modpolyfit", degree = 4, ...)

## S4 method for signature 'SpectraInTimeComp'
baselineCorrect(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="baselineCorrect_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="baselineCorrect_+3A_...">...</code></td>
<td>
<p>other parameters passed to <code><a href="baseline.html#topic+baseline">baseline</a></code></p>
</td></tr>
<tr><td><code id="baselineCorrect_+3A_method">method</code></td>
<td>
<p>method of baseline correction, default value is to <code>'modpolyfit'</code>,  see <code><a href="baseline.html#topic+baseline.modpolyfit">baseline.modpolyfit</a></code></p>
</td></tr>
<tr><td><code id="baselineCorrect_+3A_degree">degree</code></td>
<td>
<p>numeric value, degree of the polynomial used only if <code>method</code> is <code>'modpolyfit'</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>


<h3>Note</h3>

<p>baseline correction in the wavelength domain by linking to the <code><a href="baseline.html#topic+baseline">baseline</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> spectralEx           &lt;-  getSpectraInTimeExample()
 timeRange            &lt;-  range( getTimePoints( spectralEx ) )
 timesToSelect        &lt;-  e(  seq( timeRange[1] , timeRange[2] , length.out = 5  )   )
 baselineDefault      &lt;-  baselineCorrect( spectralEx )
 baselineHighPolynomial  &lt;-  baselineCorrect( spectralEx, 
   method = 'modpolyfit', degree = 4 )

 # filtering with fast fourier transform, not so good on example 
 baselineLowpass         &lt;-  baselineCorrect( spectralEx , method = "lowpass" )

 # visual inspection
 
 plot( spectralEx )   
 plot( baselineDefault[ timesToSelect , ] , type = "time"  )
 plot( baselineHighPolynomial[ timesToSelect , ] , type = "time"  )
 plot( baselineLowpass[ timesToSelect , ] , type = "time"  ) 


</code></pre>

<hr>
<h2 id='changeDevSettings'>Function to overwrite default settings</h2><span id='topic+changeDevSettings'></span>

<h3>Description</h3>

<p>Changes are printed print to the console when changing default settings and adding to default settings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>changeDevSettings(defaultSettings, replaceSettings)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="changeDevSettings_+3A_defaultsettings">defaultSettings</code></td>
<td>
<p>list of settings</p>
</td></tr>
<tr><td><code id="changeDevSettings_+3A_replacesettings">replaceSettings</code></td>
<td>
<p>list of settings to overwrite defaults or add to defaults</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>

<hr>
<h2 id='checkCompatible'>Check object compatibility</h2><span id='topic+checkCompatible'></span><span id='topic+checkCompatible+2CSpectraInTime+2CProcessTimes-method'></span><span id='topic++5BProcessTimes+2CSpectraInTime-method'></span><span id='topic++5BSpectraInTime+2CProcessTimes-method'></span><span id='topic+checkCompatible+2CProcessTimes+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>Check wheter 2 objects are compatible before using them together e.g. in time aligment using a time file with matching experiment name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkCompatible(x, y, ...)

## S4 method for signature 'SpectraInTime,ProcessTimes'
checkCompatible(x, y)

## S4 method for signature 'ProcessTimes,SpectraInTime'
checkCompatible(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkCompatible_+3A_x">x</code></td>
<td>
<p>first object</p>
</td></tr>
<tr><td><code id="checkCompatible_+3A_y">y</code></td>
<td>
<p>second object</p>
</td></tr>
<tr><td><code id="checkCompatible_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no output, produces an error when object are not compatible with each other
</p>
<p><code>TRUE</code> when the aer competible, otherwise it stops and prints a list of error messages
</p>

<hr>
<h2 id='checkForRedundantSources'>Check for redunt NMF source vectors</h2><span id='topic+checkForRedundantSources'></span>

<h3>Description</h3>

<p>Check if any of the source vectors in the initialized NMF model are redundant
and should be omitted from the actual NMF analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkForRedundantSources(seed)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkForRedundantSources_+3A_seed">seed</code></td>
<td>
<p>nmfModel object containing initialization of the factor matrices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>boolean vector, indicating which source vector(s) are redundant
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>

<hr>
<h2 id='checkIdenticalClass'>check wether all elements of of the same class</h2><span id='topic+checkIdenticalClass'></span>

<h3>Description</h3>

<p>check wether all elements of of the same class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkIdenticalClass(listOfObjects, class)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkIdenticalClass_+3A_listofobjects">listOfObjects</code></td>
<td>
<p>a list of S4 objects to check</p>
</td></tr>
<tr><td><code id="checkIdenticalClass_+3A_class">class</code></td>
<td>
<p>a class to compare with</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical value <code>TRUE</code> if all objects are of the correct class
</p>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>

<hr>
<h2 id='checkMethod'>check method in list of allowd method</h2><span id='topic+checkMethod'></span>

<h3>Description</h3>

<p>check method in list of allowd method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkMethod(method, allowedMethods)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkMethod_+3A_method">method</code></td>
<td>
<p>character of method to check</p>
</td></tr>
<tr><td><code id="checkMethod_+3A_allowedmethods">allowedMethods</code></td>
<td>
<p>character vector of allowed method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing just stop if method not allowed
</p>

<hr>
<h2 id='checkTimeUnit'>check timeeUnit  and produce error if not correct unit</h2><span id='topic+checkTimeUnit'></span>

<h3>Description</h3>

<p>check timeeUnit  and produce error if not correct unit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkTimeUnit(timeUnit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkTimeUnit_+3A_timeunit">timeUnit</code></td>
<td>
<p>character vector</p>
</td></tr>
</table>

<hr>
<h2 id='combineSpectralObjects'>Function to combine <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> objects containing 1 spectrum each</h2><span id='topic+combineSpectralObjects'></span>

<h3>Description</h3>

<p>Function to combine <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> objects containing 1 spectrum each
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combineSpectralObjects(objectList, timeRange, checkNames = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combineSpectralObjects_+3A_objectlist">objectList</code></td>
<td>
<p>List of <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> objects to be combined</p>
</td></tr>
<tr><td><code id="combineSpectralObjects_+3A_timerange">timeRange</code></td>
<td>
<p>Numeric value, equal to the maximum time of the measured spectra.</p>
</td></tr>
<tr><td><code id="combineSpectralObjects_+3A_checknames">checkNames</code></td>
<td>
<p>Boolean - if <code>TRUE</code>, the experiment name of the spectral objects will be compared to see if these spectral objects belong to the same experiment</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>

<hr>
<h2 id='completeSourceMatrix'>complete source matrix</h2><span id='topic+completeSourceMatrix'></span>

<h3>Description</h3>

<p>complete source matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>completeSourceMatrix(W0, rank, method)
</code></pre>

<hr>
<h2 id='computeNMFResidu'>NMF relative residual per observation</h2><span id='topic+computeNMFResidu'></span>

<h3>Description</h3>

<p>Compute relative residual per observation of an NMF fit to a spectral data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeNMFResidu(object, NMFResult)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeNMFResidu_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code></p>
</td></tr>
<tr><td><code id="computeNMFResidu_+3A_nmfresult">NMFResult</code></td>
<td>
<p>Fitted NMF model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dataframe, containing time (observation) vector and residual vector
</p>


<h3>Author(s)</h3>

<p>nsauwen
</p>

<hr>
<h2 id='convertListToS4'>convert an a named list to S4 object</h2><span id='topic+convertListToS4'></span>

<h3>Description</h3>

<p>convert an a named list to S4 object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertListToS4(list, class)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convertListToS4_+3A_list">list</code></td>
<td>
<p>list</p>
</td></tr>
<tr><td><code id="convertListToS4_+3A_class">class</code></td>
<td>
<p>character vector indicating S4 class</p>
</td></tr>
</table>

<hr>
<h2 id='convertS4ToList'>convert an S4 object into a list</h2><span id='topic+convertS4ToList'></span>

<h3>Description</h3>

<p>convert an S4 object into a list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertS4ToList(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convertS4ToList_+3A_object">object</code></td>
<td>
<p>and S4 object</p>
</td></tr>
</table>

<hr>
<h2 id='e'>Create an <code><a href="#topic+ElementsToSelect-class">ElementsToSelect-class</a></code> from a numeric vector or multiple numeric values or vectors</h2><span id='topic+e'></span>

<h3>Description</h3>

<p>Create an <code><a href="#topic+ElementsToSelect-class">ElementsToSelect-class</a></code> from a numeric vector or multiple numeric values or vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="e_+3A_x">x</code></td>
<td>
<p>numeric  vector</p>
</td></tr>
<tr><td><code id="e_+3A_...">...</code></td>
<td>
<p>additional numeric vectors</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+ElementsToSelect-class">ElementsToSelect-class</a></code> with unique elements
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e( 1 , 5, 4.5  )
e( 1:10 , c(4 , 5 , 6 ) , 7 )
</code></pre>

<hr>
<h2 id='ElementsToSelect-class'>Elements S4 class useful for closest elements subsetting</h2><span id='topic+ElementsToSelect-class'></span>

<h3>Description</h3>

<p>Elements S4 class useful for closest elements subsetting
</p>


<h3>Slots</h3>


<dl>
<dt><code>elements</code></dt><dd><p>numeric vector of elements</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>

<hr>
<h2 id='first'>return first element (of a vector)</h2><span id='topic+first'></span>

<h3>Description</h3>

<p>return first element (of a vector)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>first(x)
</code></pre>

<hr>
<h2 id='firstSpectrum'>Get the first spectrum</h2><span id='topic+firstSpectrum'></span><span id='topic+firstSpectrum+2CSpectraInTime-method'></span><span id='topic+firstSpectrum+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Get the first spectrum
</p>


<h3>Usage</h3>

<pre><code class='language-R'>firstSpectrum(object, ...)

## S4 method for signature 'SpectraInTime'
firstSpectrum(object)

## S4 method for signature 'numeric'
firstSpectrum(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="firstSpectrum_+3A_object">object</code></td>
<td>
<p>S4 object</p>
</td></tr>
<tr><td><code id="firstSpectrum_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector containing observations first spectrum
</p>

<hr>
<h2 id='flagVectorInInterval'>flag vector elements within interval (closed interval )</h2><span id='topic+flagVectorInInterval'></span>

<h3>Description</h3>

<p>flag vector elements within interval (closed interval )
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flagVectorInInterval(vector, interval)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flagVectorInInterval_+3A_vector">vector</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="flagVectorInInterval_+3A_interval">interval</code></td>
<td>
<p>numeric vecor with 2 values</p>
</td></tr>
</table>


<h3>Note</h3>

<p>if interval is <code>NULL</code> then no selection  is performed
</p>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>

<hr>
<h2 id='getClosestElements'>get closest element for elements looked up in a vector</h2><span id='topic+getClosestElements'></span>

<h3>Description</h3>

<p>get closest element for elements looked up in a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getClosestElements(vector, elements)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getClosestElements_+3A_vector">vector</code></td>
<td>
<p>numeric vector values to match to</p>
</td></tr>
<tr><td><code id="getClosestElements_+3A_elements">elements</code></td>
<td>
<p>numeric vector</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>

<hr>
<h2 id='getDefaultSumFunc'>function to get default summary functions</h2><span id='topic+getDefaultSumFunc'></span>

<h3>Description</h3>

<p>function to get default summary functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDefaultSumFunc()
</code></pre>


<h3>Value</h3>

<p>character vector of functions
</p>

<hr>
<h2 id='getDefaultTimeFormat'>function to get default time format in the package</h2><span id='topic+getDefaultTimeFormat'></span>

<h3>Description</h3>

<p>function to get default time format in the package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDefaultTimeFormat()
</code></pre>


<h3>Value</h3>

<p>character vector specifiying a time format
</p>
<p>character string iwth default time format
</p>

<hr>
<h2 id='getDimensionReduction'>generic function to extract <code>dimensionReduction</code>-slot</h2><span id='topic+getDimensionReduction'></span>

<h3>Description</h3>

<p>generic function to extract <code>dimensionReduction</code>-slot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDimensionReduction(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDimensionReduction_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="getDimensionReduction_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dimension reduction slot of an object
</p>

<hr>
<h2 id='getElements'>generic function to extract <code>elements</code>-slot</h2><span id='topic+getElements'></span><span id='topic+getElements+2CElementsToSelect-method'></span>

<h3>Description</h3>

<p>generic function to extract <code>elements</code>-slot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getElements(object, ...)

## S4 method for signature 'ElementsToSelect'
getElements(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getElements_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="getElements_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>

<hr>
<h2 id='getExperimentName'>generic function to extract <code>experimentName</code>-slot</h2><span id='topic+getExperimentName'></span><span id='topic+getExperimentName+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>generic function to extract <code>experimentName</code>-slot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getExperimentName(object, ...)

## S4 method for signature 'SpectraInTime'
getExperimentName(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getExperimentName_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="getExperimentName_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>string containing experiment name
</p>

<hr>
<h2 id='getExtraInfo'>generic function to extract <code>extraInfo</code>-slot</h2><span id='topic+getExtraInfo'></span><span id='topic+getExtraInfo+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>generic function to extract <code>extraInfo</code>-slot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getExtraInfo(object, ...)

## S4 method for signature 'SpectraInTime'
getExtraInfo(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getExtraInfo_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="getExtraInfo_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of extraInfo
</p>

<hr>
<h2 id='getListOfSpectraExample'>get example list of spectra</h2><span id='topic+getListOfSpectraExample'></span>

<h3>Description</h3>

<p>get example list of spectra
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getListOfSpectraExample()
</code></pre>


<h3>Value</h3>

<p>list of <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>

<hr>
<h2 id='getNMFInputMatrix'>Get spectralData as input NMF model</h2><span id='topic+getNMFInputMatrix'></span>

<h3>Description</h3>

<p>Extract spectral input matrix from <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> and condition properly for NMF modeling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNMFInputMatrix(object, method = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getNMFInputMatrix_+3A_object">object</code></td>
<td>
<p>object of the 'spectralData' class, such as a raw SPC file</p>
</td></tr>
<tr><td><code id="getNMFInputMatrix_+3A_method">method</code></td>
<td>
<p>name of the NMF method to be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>spectral matrix, with wavelengths as its rows and time points as its columns
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>

<hr>
<h2 id='getPathProcessTimesExample'>example path process times</h2><span id='topic+getPathProcessTimesExample'></span>

<h3>Description</h3>

<p>example path process times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPathProcessTimesExample()
</code></pre>


<h3>Value</h3>

<p><code><a href="#topic+ProcessTimes-class">ProcessTimes-class</a></code>
</p>

<hr>
<h2 id='getPreprocessing'>generic function to extract <code>preprocessing</code>-slot</h2><span id='topic+getPreprocessing'></span><span id='topic+getPreprocessing+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>generic function to extract <code>preprocessing</code>-slot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPreprocessing(object, ...)

## S4 method for signature 'SpectraInTime'
getPreprocessing(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPreprocessing_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="getPreprocessing_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with preprocessing steps
</p>

<hr>
<h2 id='getProcessTimesExample'>get a minimal <code><a href="#topic+ProcessTimes-class">ProcessTimes-class</a></code> example based on 
<code><a href="#topic+getSpectraInTimeExample">getSpectraInTimeExample</a></code></h2><span id='topic+getProcessTimesExample'></span>

<h3>Description</h3>

<p>get a minimal <code><a href="#topic+ProcessTimes-class">ProcessTimes-class</a></code> example based on 
<code><a href="#topic+getSpectraInTimeExample">getSpectraInTimeExample</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getProcessTimesExample()
</code></pre>


<h3>Value</h3>

<p><code><a href="#topic+ProcessTimes-class">ProcessTimes-class</a></code>
</p>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>


<h3>Examples</h3>

<pre><code class='language-R'> getProcessTimesExample()
</code></pre>

<hr>
<h2 id='getProcessTimesFrameExample'>get mimimal example <code><a href="#topic+ProcessTimesFrame-class">ProcessTimesFrame-class</a></code></h2><span id='topic+getProcessTimesFrameExample'></span>

<h3>Description</h3>

<p>get mimimal example <code><a href="#topic+ProcessTimesFrame-class">ProcessTimesFrame-class</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getProcessTimesFrameExample()
</code></pre>


<h3>Value</h3>

<p><code><a href="#topic+ProcessTimes-class">ProcessTimes-class</a></code>
</p>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>

<hr>
<h2 id='getRange'>generic function to extract <code>range</code>-slot</h2><span id='topic+getRange'></span><span id='topic+getRange+2CRangeToSubset-method'></span>

<h3>Description</h3>

<p>generic function to extract <code>range</code>-slot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRange(object, ...)

## S4 method for signature 'RangeToSubset'
getRange(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getRange_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="getRange_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>

<hr>
<h2 id='getSpectra'>generic function to extract <code>spectra</code>-slot</h2><span id='topic+getSpectra'></span><span id='topic+getSpectra+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>generic function to extract <code>spectra</code>-slot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSpectra(object, ...)

## S4 method for signature 'SpectraInTime'
getSpectra(object)

## S4 method for signature 'SpectraInTime'
getSpectra(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSpectra_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="getSpectra_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix of spectra
</p>

<hr>
<h2 id='getSpectraInTimeCompExample'>Artificial example of <code><a href="#topic+SpectraInTimeComp-class">SpectraInTimeComp-class</a></code></h2><span id='topic+getSpectraInTimeCompExample'></span>

<h3>Description</h3>

<p>Example <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> with nmf result 
using random initialization with rank 2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSpectraInTimeCompExample()
</code></pre>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTimeComp-class">SpectraInTimeComp-class</a></code>
</p>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
	test &lt;-  getSpectraInTimeCompExample() 

</code></pre>

<hr>
<h2 id='getSpectraInTimeExample'>Artificial example <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code></h2><span id='topic+getSpectraInTimeExample'></span>

<h3>Description</h3>

<p>exponential conversion from 2 concentrations with gaussion curves for spectra at different wavelength per compounds
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSpectraInTimeExample(showPlots = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSpectraInTimeExample_+3A_showplots">showPlots</code></td>
<td>
<p>logical indicator to show plots</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ex1  &lt;-   getSpectraInTimeExample()
</code></pre>

<hr>
<h2 id='getSpectralAxis'>generic function to extract <code>spectralAxis</code>-slot</h2><span id='topic+getSpectralAxis'></span><span id='topic+getSpectralAxis+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>generic function to extract <code>spectralAxis</code>-slot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSpectralAxis(object, ...)

## S4 method for signature 'SpectraInTime'
getSpectralAxis(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSpectralAxis_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="getSpectralAxis_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector containing wavelengths
</p>

<hr>
<h2 id='getStartTime'>generic function to extract <code>startTime</code>-slot</h2><span id='topic+getStartTime'></span><span id='topic+getStartTime+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>generic function to extract <code>startTime</code>-slot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStartTime(object, ...)

## S4 method for signature 'SpectraInTime'
getStartTime(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getStartTime_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="getStartTime_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector with start time
</p>

<hr>
<h2 id='getTimeConversionFactor'>transform timeUnit to convert from seconds to specified unit</h2><span id='topic+getTimeConversionFactor'></span>

<h3>Description</h3>

<p>@param timeUnit character vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTimeConversionFactor(timeUnit)
</code></pre>

<hr>
<h2 id='getTimePoints'>generic function to extract <code>timePoints</code>-slot</h2><span id='topic+getTimePoints'></span><span id='topic+getTimePoints+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>generic function to extract <code>timePoints</code>-slot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTimePoints(object, ...)

## S4 method for signature 'SpectraInTime'
getTimePoints(object, timePointsAlt = FALSE, timeUnit = "seconds")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getTimePoints_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="getTimePoints_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
<tr><td><code id="getTimePoints_+3A_timepointsalt">timePointsAlt</code></td>
<td>
<p>logical indicator to get alternative (shifted) instead of recorded time points, defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="getTimePoints_+3A_timeunit">timeUnit</code></td>
<td>
<p>unit to use , choose between: <code>seconds</code> , <code>minutes</code> or <code>hours</code>, defaults equal to <code>seconds</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>numberic vector containing timepoints
</p>


<h3>Examples</h3>

<pre><code class='language-R'> spectra    &lt;-  getSpectraInTimeExample()
 getTimePoints( spectra )
 getTimePoints( spectra , timePointsAlt = TRUE  )
 getTimePoints( spectra , timeUnit = "hours"  )
</code></pre>

<hr>
<h2 id='getUnits'>generic function to extract <code>units</code>-slot</h2><span id='topic+getUnits'></span><span id='topic+getUnits+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>generic function to extract <code>units</code>-slot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getUnits(object, ...)

## S4 method for signature 'SpectraInTime'
getUnits(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getUnits_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="getUnits_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of units
</p>

<hr>
<h2 id='includeRedundantSources'>Re-introduce redundant sources in NMF-model</h2><span id='topic+includeRedundantSources'></span>

<h3>Description</h3>

<p>Re-introduce redundant source vectors and corresponding zero abundances 
into final NMF result
</p>


<h3>Usage</h3>

<pre><code class='language-R'>includeRedundantSources(NMFResult, seed_orig, redundantSources)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="includeRedundantSources_+3A_nmfresult">NMFResult</code></td>
<td>
<p>Fitted NMF model</p>
</td></tr>
<tr><td><code id="includeRedundantSources_+3A_seed_orig">seed_orig</code></td>
<td>
<p>Initial NMF model</p>
</td></tr>
<tr><td><code id="includeRedundantSources_+3A_redundantsources">redundantSources</code></td>
<td>
<p>boolean vector, obtained from <code><a href="#topic+checkForRedundantSources">checkForRedundantSources</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Final NMF model with redundant sources re-introduced
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>

<hr>
<h2 id='initializeNMFModel'>Initialize NMF model with initial spectral data</h2><span id='topic+initializeNMFModel'></span>

<h3>Description</h3>

<p>Initialize NMF model with initial spectral data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initializeNMFModel(initSpectralData, spectra, spectralAxis = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initializeNMFModel_+3A_initspectraldata">initSpectralData</code></td>
<td>
<p>this can be a list of spectralData objects, containing 
the pure component spectra. It can also be either of the NMF factor matrices with initial values</p>
</td></tr>
<tr><td><code id="initializeNMFModel_+3A_spectra">spectra</code></td>
<td>
<p>spectral matrix, with wavelengths as its rows and time points as its columns</p>
</td></tr>
<tr><td><code id="initializeNMFModel_+3A_spectralaxis">spectralAxis</code></td>
<td>
<p>vector of wavelength/spectralAxis values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object that inherents from the class <code><a href="NMF.html#topic+NMF">NMF</a></code>
</p>

<hr>
<h2 id='last'>return laste element( of a vector )</h2><span id='topic+last'></span>

<h3>Description</h3>

<p>return laste element( of a vector )
</p>


<h3>Usage</h3>

<pre><code class='language-R'>last(x)
</code></pre>

<hr>
<h2 id='lastSpectrum'>Get the last spectrum</h2><span id='topic+lastSpectrum'></span><span id='topic+lastSpectrum+2Cnumeric-method'></span><span id='topic+lastSpectrum+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>Get the last spectrum
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lastSpectrum(object, ...)

## S4 method for signature 'numeric'
lastSpectrum(object)

## S4 method for signature 'SpectraInTime'
lastSpectrum(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lastSpectrum_+3A_object">object</code></td>
<td>
<p>S4 object</p>
</td></tr>
<tr><td><code id="lastSpectrum_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector containing values last spectrum
</p>

<hr>
<h2 id='loadAllSPCFiles'>Load all or a selection of SPC files from a given directory.</h2><span id='topic+loadAllSPCFiles'></span>

<h3>Description</h3>

<p>This function automatically recognizes all the files bearing an '.spc' extension and returns a list in which each element corresponds to a different xml file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadAllSPCFiles(directoryFiles, selectedFiles = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loadAllSPCFiles_+3A_directoryfiles">directoryFiles</code></td>
<td>
<p>Character vector indicating the directory from which the files needs to be downloaded. Note that files with an other extension than '.spc' can be stored in this directory.</p>
</td></tr>
<tr><td><code id="loadAllSPCFiles_+3A_selectedfiles">selectedFiles</code></td>
<td>
<p>Character vector listing which files of the chosen directory (as expressed by the 'directoryFiles' argument) should be processed. This argument is used when one wants to process a subset of the spc files of the selected directory only. Note that one should add the complete file name to this list, including the file extension! This is an optional argument with as default value NULL, meaning that by default all files of the selected directory are considered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned of which each element contains a processed SPC file
</p>

<hr>
<h2 id='localBaselineCorrect'>Local baseline correction</h2><span id='topic+localBaselineCorrect'></span>

<h3>Description</h3>

<p>Substract a baseline either through 1 or 2 points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>localBaselineCorrect(object, baseWavelengths = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="localBaselineCorrect_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code></p>
</td></tr>
<tr><td><code id="localBaselineCorrect_+3A_basewavelengths">baseWavelengths</code></td>
<td>
<p>numeric vector of 1 or 2 wavelength use to draw a baseline trough,
defaults to <code>NULL</code> when no baseline correction is performed</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> with baseline subset
</p>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spectra              &lt;-  getSpectraInTimeExample()
spectraConstCorrect  &lt;-  localBaselineCorrect( spectra , baseWavelengths = 240  )
spectraLinCorrect    &lt;-  localBaselineCorrect( spectra , c( 250 , 330 )  ) 

plot( spectra )
plot( spectraConstCorrect )
plot( spectraLinCorrect ) 

</code></pre>

<hr>
<h2 id='multiplicativeScatterCorrect'>multiplicative scatter correction on 1 function</h2><span id='topic+multiplicativeScatterCorrect'></span>

<h3>Description</h3>

<p>multiplicative scatter correction on 1 function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiplicativeScatterCorrect(x, xRef)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiplicativeScatterCorrect_+3A_x">x</code></td>
<td>
<p>numerical vector of measurements</p>
</td></tr>
</table>


<h3>Value</h3>

<p>corrected spectrum
</p>

<hr>
<h2 id='nonNegativePreprocessing'>condition datamatrix to input in and condition properly for NMF</h2><span id='topic+nonNegativePreprocessing'></span>

<h3>Description</h3>

<p>condition datamatrix to input in and condition properly for NMF
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nonNegativePreprocessing(spectra, method = "")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nonNegativePreprocessing_+3A_spectra">spectra</code></td>
<td>
<p>matrix of spectra</p>
</td></tr>
<tr><td><code id="nonNegativePreprocessing_+3A_method">method</code></td>
<td>
<p>name of the NMF method to be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>put negative values to zero, transpose, an add small value zero row (wavelength with only zeros)
</p>


<h3>Value</h3>

<p>matrix, with wavelengths as its rows and time points as its columns
</p>

<hr>
<h2 id='normalize'>generic normalization function</h2><span id='topic+normalize'></span><span id='topic+normalize+2CSpectraInTime-method'></span><span id='topic+normalize+2CSpectraInTimeComp-method'></span>

<h3>Description</h3>

<p>generic normalization function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize(object, ...)

## S4 method for signature 'SpectraInTime'
normalize(
  object,
  method = "normalize",
  spectralRange = r(-Inf, Inf),
  spectralAxisVal = NULL,
  scaleFunction = "sd",
  meanFunction = NULL
)

## S4 method for signature 'SpectraInTimeComp'
normalize(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="normalize_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="normalize_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
<tr><td><code id="normalize_+3A_method">method</code></td>
<td>
<p>a method for normalization or peak correction , choose from:
</p>
<p>* normalize substract <code>mean</code> and divide by <code>scale</code>
* peak scale by reference <code>spectralAxisVal</code>
* integration scale by integrating over <code>spectralAxisRange</code></p>
</td></tr>
<tr><td><code id="normalize_+3A_spectralrange">spectralRange</code></td>
<td>
<p>range for integration if method = <code>integration</code> , defaults to complete range</p>
</td></tr>
<tr><td><code id="normalize_+3A_spectralaxisval">spectralAxisVal</code></td>
<td>
<p>reference spectral axis value (wavelength or other) for <code>peak</code> regresssion</p>
</td></tr>
<tr><td><code id="normalize_+3A_scalefunction">scaleFunction</code></td>
<td>
<p>scale function used when method = <code>normalize</code> defaults to <code><a href="stats.html#topic+sd">sd</a></code></p>
</td></tr>
<tr><td><code id="normalize_+3A_meanfunction">meanFunction</code></td>
<td>
<p>mean function used when method = <code>normalize</code> defaults to <code><a href="base.html#topic+mean">mean</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> spectralEx            &lt;-  getSpectraInTimeExample()
 timeRange             &lt;-  range( getTimePoints( spectralEx ))
 timesToSelect         &lt;-  e(  seq( timeRange[1] , timeRange[2] , length.out = 5  )   )
 
 plot( spectralEx )
 plot( spectralEx[ timesToSelect ,  ] , type = "time" )

 normalizePeak         &lt;-  normalize( spectralEx , method = "peak" , spectralAxisVal = 400 )
 getPreprocessing( normalizePeak )

 plot( normalizePeak[ timesToSelect ,  ] , type = "time" )
 plot( normalizePeak )

 normalizeIntegration  &lt;-  normalize( spectralEx , method = "integration" )

 plot( normalizeIntegration[ timesToSelect ,  ] , type = "time" )

 normalizedUser  &lt;-  normalize( spectralEx , method = "normalize" , mean = "median" , scale = "sd" )

 plot( normalizedUser[ timesToSelect ,  ] , type = "time" ) 

</code></pre>

<hr>
<h2 id='plotlyAxis'>help function to make plotly axis title</h2><span id='topic+plotlyAxis'></span>

<h3>Description</h3>

<p>help function to make plotly axis title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotlyAxis(title)
</code></pre>

<hr>
<h2 id='predictNNLS'>Based on previously obtained NMF result <code>NMFResult</code>, estimate coefficients for a new 
spectralData object <code>object</code> using non-negative least squares fitting. The result is 
returned as as an NMF model.</h2><span id='topic+predictNNLS'></span>

<h3>Description</h3>

<p>Based on previously obtained NMF result <code>NMFResult</code>, estimate coefficients for a new 
spectralData object <code>object</code> using non-negative least squares fitting. The result is 
returned as as an NMF model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictNNLS(object, NMFResult)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predictNNLS_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code></p>
</td></tr>
<tr><td><code id="predictNNLS_+3A_nmfresult">NMFResult</code></td>
<td>
<p>Fitted NMF model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fitted non-negative least squares result in the form of an NMF model
</p>


<h3>Author(s)</h3>

<p>nsauwen
</p>

<hr>
<h2 id='preprocess'>generic function to preprocess an S4 object</h2><span id='topic+preprocess'></span><span id='topic+preprocess+2CSpectraInTime+2Clist-method'></span><span id='topic+preprocess+2CSpectraInTime+2CSpectraInTime-method'></span><span id='topic+preprocess+2CSpectraInTimeComp+2CANY-method'></span>

<h3>Description</h3>

<p>generic function to preprocess an S4 object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocess(object, with)

## S4 method for signature 'SpectraInTime,list'
preprocess(object, with)

## S4 method for signature 'SpectraInTime,SpectraInTime'
preprocess(object, with)

## S4 method for signature 'SpectraInTimeComp,ANY'
preprocess(object, with)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="preprocess_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="preprocess_+3A_with">with</code></td>
<td>
<p>an other object containing preprocessing information: other S4 object, list or expression</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>

<hr>
<h2 id='preprocessSpectraInTimeWithList'>internal function to wrap multiple preprocessing steps</h2><span id='topic+preprocessSpectraInTimeWithList'></span>

<h3>Description</h3>

<p>internal function to wrap multiple preprocessing steps
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocessSpectraInTimeWithList(object, with)
</code></pre>

<hr>
<h2 id='ProcessTimes-class'>S4 Class key process times</h2><span id='topic+ProcessTimes-class'></span><span id='topic+ProcessTimes'></span><span id='topic+TemperatureInfo'></span><span id='topic+temperatureInfo'></span><span id='topic+temperatureinfo'></span>

<h3>Description</h3>

<p>S4 Class key process times
</p>


<h3>Slots</h3>


<dl>
<dt><code>experimentName</code></dt><dd><p>character vector with name of the experiment</p>
</dd>
<dt><code>timeHeatingAboveMin</code></dt><dd><p>time when experiment above minimum temperature</p>
</dd>
<dt><code>timeStartReaction</code></dt><dd><p>time start reaction (end of heating ramp)</p>
</dd>
<dt><code>timeEndProcess</code></dt><dd><p>time timeEndProcess  time end of the process, when cooling down starts</p>
</dd>
<dt><code>Tset</code></dt><dd><p>the maximum temperature to indicate <code>timeStartReaction</code></p>
</dd>
<dt><code>comments</code></dt><dd><p>character vector of comments when <code>NA</code> values are produced</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>

<hr>
<h2 id='ProcessTimesFrame-class'>ProcessTimes-class</h2><span id='topic+ProcessTimesFrame-class'></span>

<h3>Description</h3>

<p>S4 Class key process times in a data frame, every line is convertable to a <code><a href="#topic+ProcessTimes-class">ProcessTimes-class</a> </code>
</p>


<h3>Value</h3>

<p><code><a href="#topic+ProcessTimes-class">ProcessTimes-class</a></code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>processTimes</code></dt><dd><p>data.frame with every line process times of an experiment</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>

<hr>
<h2 id='r'>create a <code><a href="#topic+RangeToSubset-class">RangeToSubset-class</a></code> object from 2 elements or from a vector</h2><span id='topic+r'></span><span id='topic+r+2Cnumeric+2Cnumeric-method'></span><span id='topic+r+2CRangeToSubset+2Cmissing-method'></span>

<h3>Description</h3>

<p>create a <code><a href="#topic+RangeToSubset-class">RangeToSubset-class</a></code> object from 2 elements or from a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r(x, y)

## S4 method for signature 'numeric,numeric'
r(x, y)

## S4 method for signature 'RangeToSubset,missing'
r(x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="r_+3A_x">x</code></td>
<td>
<p>numeric value or vector of numeric values</p>
</td></tr>
<tr><td><code id="r_+3A_y">y</code></td>
<td>
<p>numeric value missing when x is a vector of values</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+RangeToSubset-class">RangeToSubset-class</a></code>
</p>

<hr>
<h2 id='RangeToSubset-class'>RangeToSubset-class</h2><span id='topic+RangeToSubset-class'></span><span id='topic+RangeToSubset'></span><span id='topic+rangetosubset'></span><span id='topic+Rangetosubset'></span>

<h3>Description</h3>

<p>Allows for subsetting a range of actual values instead of a range of indicators
</p>


<h3>Slots</h3>


<dl>
<dt><code>range</code></dt><dd><p>numeric vector with min and max value</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>

<hr>
<h2 id='readProcessTimes'>read .csv file as process times</h2><span id='topic+readProcessTimes'></span>

<h3>Description</h3>

<p>read .csv file as process times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readProcessTimes(path, timeFormat = "%Y-%m-%d %H:%M:%OS")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readProcessTimes_+3A_path">path</code></td>
<td>
<p>to the file containing process times information</p>
</td></tr>
<tr><td><code id="readProcessTimes_+3A_timeformat">timeFormat</code></td>
<td>
<p>character specifying time format <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+ProcessTimesFrame-class">ProcessTimesFrame-class</a></code>
</p>
<p><code><a href="#topic+ProcessTimes-class">ProcessTimes-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> readProcessTimes( getPathProcessTimesExample() , timeFormat =  "%Y-%m-%d %H:%M:%S" )
</code></pre>

<hr>
<h2 id='readSPC'>Read-in of a SPC file.</h2><span id='topic+readSPC'></span>

<h3>Description</h3>

<p>This function is an adaptation of the 'read.spc' function of the 'hyperSpec' package :
Claudia Beleites and Valter Sergo: 'hyperSpec: a package to handle
hyperspectral data sets in R, R package version 0.98-20161118.
http://hyperspec.r-forge.r-project.org.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readSPC(filename, keys.log2data = TRUE, keys.hdr2data = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readSPC_+3A_filename">filename</code></td>
<td>
<p>Character vector expressing the name of the SPC file (just the name, not the directory).</p>
</td></tr>
<tr><td><code id="readSPC_+3A_keys.log2data">keys.log2data</code></td>
<td>
<p>Logical vector indicating whether the full information (consisting of additional information on the experimental conditions) needs to be parsed from the SPC file or not (TRUE indicates that the full information should be parsed from the SPC file). The default value is FALSE.</p>
</td></tr>
<tr><td><code id="readSPC_+3A_keys.hdr2data">keys.hdr2data</code></td>
<td>
<p>a character vector of header object to add to backgroundInformation</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>

<hr>
<h2 id='removeRedundantSources'>Remove redundant sources from the initial NMF model</h2><span id='topic+removeRedundantSources'></span>

<h3>Description</h3>

<p>Remove redundant sources from the initial NMF model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeRedundantSources(seed, redundantSources)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="removeRedundantSources_+3A_seed">seed</code></td>
<td>
<p>nmfModel object containing initialization of the factor matrices</p>
</td></tr>
<tr><td><code id="removeRedundantSources_+3A_redundantsources">redundantSources</code></td>
<td>
<p>boolean vector, obtained from <code><a href="#topic+checkForRedundantSources">checkForRedundantSources</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>nmfModel object with redundant sources removed from initial factor matrices
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>

<hr>
<h2 id='runNMF'>Actual NMF analysis</h2><span id='topic+runNMF'></span>

<h3>Description</h3>

<p>Actual NMF analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runNMF(
  spectra,
  rank,
  method = "PGNMF",
  seed = NULL,
  nruns = 10,
  checkDivergence = TRUE,
  timePointsList = NULL,
  subsamplingFactor = 3,
  maxIter = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runNMF_+3A_spectra">spectra</code></td>
<td>
<p>spectral input matrix, with wavelengths as its rows and time points as its columns</p>
</td></tr>
<tr><td><code id="runNMF_+3A_rank">rank</code></td>
<td>
<p>number of NMF components to be found</p>
</td></tr>
<tr><td><code id="runNMF_+3A_method">method</code></td>
<td>
<p>name of the NMF method to be used, consult the help
of the 'nmf' function from the NMF package for the methods available by default</p>
</td></tr>
<tr><td><code id="runNMF_+3A_seed">seed</code></td>
<td>
<p>nmfModel object containing initialization of the factor matrices</p>
</td></tr>
<tr><td><code id="runNMF_+3A_nruns">nruns</code></td>
<td>
<p>number of NMF runs. It is recommended to run the NMF analyses multiple
times when random seeding is used, to avoid a suboptimal solution</p>
</td></tr>
<tr><td><code id="runNMF_+3A_checkdivergence">checkDivergence</code></td>
<td>
<p>Boolean indicating whether divergence checking should be performed, defaults to <code>TRUE</code></p>
</td></tr>
<tr><td><code id="runNMF_+3A_timepointslist">timePointsList</code></td>
<td>
<p>list of time point vectors of the individual experiments</p>
</td></tr>
<tr><td><code id="runNMF_+3A_subsamplingfactor">subsamplingFactor</code></td>
<td>
<p>subsampling factor used during NMF analysis</p>
</td></tr>
<tr><td><code id="runNMF_+3A_maxiter">maxIter</code></td>
<td>
<p>maximum number of iterations per NMF run</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Resulting NMF model (in accordance with the NMF package definition)
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>

<hr>
<h2 id='saveSpectra'>read or save a <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> from or to a  <code>.txt</code> file</h2><span id='topic+saveSpectra'></span><span id='topic+readSpectra'></span><span id='topic+save'></span><span id='topic+read'></span>

<h3>Description</h3>

<p>read or save a <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> from or to a  <code>.txt</code> file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveSpectra(object, directory, precision = 32)

readSpectra(file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="saveSpectra_+3A_object">object</code></td>
<td>
<p>object to save</p>
</td></tr>
<tr><td><code id="saveSpectra_+3A_directory">directory</code></td>
<td>
<p>directory to save object</p>
</td></tr>
<tr><td><code id="saveSpectra_+3A_precision">precision</code></td>
<td>
<p>number of significant digits controlling precission</p>
</td></tr>
<tr><td><code id="saveSpectra_+3A_file">file</code></td>
<td>
<p>to be read</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the path to which the file is saved
</p>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>


<h3>Note</h3>

<p>experiment name is used to save the experiment
</p>
<p>default time formats are assumed to convert to <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>
<p>some data precession is lost because of internal conversion to JSON format
</p>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   
 spectra         &lt;-  getSpectraInTimeExample()
 saveSpectra(  spectra , directory )
 experimentName  &lt;-  getExperimentName( spectra )
 file            &lt;-  file.path( directory , paste0( experimentName , ".txt")  )
 spectraRead     &lt;-  readSpectra( file )
 
</code></pre>

<hr>
<h2 id='scaleNMFResult'>Apply fixed scaling to NMF model</h2><span id='topic+scaleNMFResult'></span>

<h3>Description</h3>

<p>Apply fixed scaling to NMF model matrices by normalizing the basis vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaleNMFResult(NMFResult)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scaleNMFResult_+3A_nmfresult">NMFResult</code></td>
<td>
<p>Fitted NMF model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NMFResult Rescaled NMF model
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>

<hr>
<h2 id='scatterCorrect'>perform multiplicative scatter correction</h2><span id='topic+scatterCorrect'></span><span id='topic+scatterCorrect+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>perform multiplicative scatter correction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scatterCorrect(object, ...)

## S4 method for signature 'SpectraInTime'
scatterCorrect(object, referenceSpectra = NULL, referenceMethod = "mean")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scatterCorrect_+3A_object">object</code></td>
<td>
<p>a S4 class object such as <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code></p>
</td></tr>
<tr><td><code id="scatterCorrect_+3A_...">...</code></td>
<td>
<p>for internal method consistency</p>
</td></tr>
<tr><td><code id="scatterCorrect_+3A_referencespectra">referenceSpectra</code></td>
<td>
<p>the reference spectra when not derived from the current data, defaults to <code>NULL</code> when <code>referenceMethod</code> is used 
to derive the reference spectra from the data</p>
</td></tr>
<tr><td><code id="scatterCorrect_+3A_referencemethod">referenceMethod</code></td>
<td>
<p>name of the function used to derive the spectra over the data measurements, defaults to <code>"mean"</code> when the average spectra in the 
<code>object</code> is used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>multiplicative scatter correction consist of fitting regressing each spectra against the reference spectra and using the coefficients 
of this regression model to correct for multiplicative light scatter by substracting the intercept and dividing by the slope
</p>


<h3>Value</h3>

<p>new S4 object with spectra scatter corrected
</p>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 object1   &lt;-  getSpectraInTimeExample()
 object2   &lt;-  scatterCorrect( object1 )
 
   plot( object1 )
   plot( object2 )

</code></pre>

<hr>
<h2 id='scatterCorrectSpectra'>perform multiplicative scatter correction on spectralData</h2><span id='topic+scatterCorrectSpectra'></span>

<h3>Description</h3>

<p>perform multiplicative scatter correction on spectralData
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scatterCorrectSpectra(
  object,
  referenceSpectra = NULL,
  referenceMethod = "mean"
)
</code></pre>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>

<hr>
<h2 id='setExperimentName+26lt+3B-'>set the experiment name</h2><span id='topic+setExperimentName+3C-'></span><span id='topic+setExperimentName+3C-+2CSpectraInTime-method'></span><span id='topic+setTimePointsAlt+3C-+2CSpectraInTime-method'></span>

<h3>Description</h3>

<p>set the experiment name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setExperimentName(object) &lt;- value

## S4 replacement method for signature 'SpectraInTime'
setExperimentName(object) &lt;- value

## S4 replacement method for signature 'SpectraInTime'
setTimePointsAlt(object) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setExperimentName+2B26lt+2B3B-_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="setExperimentName+2B26lt+2B3B-_+3A_value">value</code></td>
<td>
<p>a vector of time points</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> with modified experiment name
</p>

<hr>
<h2 id='setTimePointsAlt+26lt+3B-'>set time alternative time axis</h2><span id='topic+setTimePointsAlt+3C-'></span>

<h3>Description</h3>

<p>set time alternative time axis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setTimePointsAlt(object) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setTimePointsAlt+2B26lt+2B3B-_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="setTimePointsAlt+2B26lt+2B3B-_+3A_value">value</code></td>
<td>
<p>a vector of time points</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> with modified timePointsAlt axis
</p>

<hr>
<h2 id='smooth'>generic smoothing function</h2><span id='topic+smooth'></span><span id='topic+smooth+2CSpectraInTime-method'></span><span id='topic+smooth+2CSpectraInTimeComp-method'></span>

<h3>Description</h3>

<p>smoothing is applied along the spectral axis, not the time axis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth(object, ...)

## S4 method for signature 'SpectraInTime'
smooth(
  object,
  method = "sg",
  order = 3,
  window = order + 7 - order%%2,
  derivative = 0,
  dim = "spectralAxis"
)

## S4 method for signature 'SpectraInTimeComp'
smooth(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smooth_+3A_object">object</code></td>
<td>
<p>a S4 class object</p>
</td></tr>
<tr><td><code id="smooth_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
<tr><td><code id="smooth_+3A_method">method</code></td>
<td>
<p>character vector smoothing method, options are 'sg' (= default, Savitsky-Golay filter) or 'mean'.</p>
</td></tr>
<tr><td><code id="smooth_+3A_order">order</code></td>
<td>
<p>numeric value,  order of the polynomial used to interpolate (only used when <code>method = 'sg'</code>), should be larger than derivative order,
defaults to 3 + derivative</p>
</td></tr>
<tr><td><code id="smooth_+3A_window">window</code></td>
<td>
<p>width of the smoothing  default value slightly higher than in the signal package, the user might consider a large value, otherwise smoothing has little effect</p>
</td></tr>
<tr><td><code id="smooth_+3A_derivative">derivative</code></td>
<td>
<p>derivative to be taken (only used when <code>method = 'sg'</code>), defaults to <code>0</code></p>
</td></tr>
<tr><td><code id="smooth_+3A_dim">dim</code></td>
<td>
<p>character string, specifying along which dimension smoothing should be applied. Options are &quot;spectralAxis&quot; (= default) or &quot;time&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>


<h3>Note</h3>

<p>equal distances between wavelenght intervals are assumed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
    spectralEx     &lt;-  getSpectraInTimeExample()
    smoothDefault   &lt;-  smooth( spectralEx )
    timeRange       &lt;-  range( getTimePoints( spectralEx ))
    timesToSelect   &lt;-  e( seq( timeRange[1] , timeRange[2] , length.out = 5  )  )
    smoothALot      &lt;-  smooth( spectralEx ,  order = 2 , window = 301  ) 
    derivative1     &lt;-  smooth( spectralEx , derivative = 1 )   
    derivative2     &lt;-  smooth( spectralEx , derivative = 2 )
    
</code></pre>

<hr>
<h2 id='SpectraInTime-class'>SpectraInTime-class</h2><span id='topic+SpectraInTime-class'></span><span id='topic+SpectraInTime'></span><span id='topic+spectraInTime'></span><span id='topic+spectraintime'></span><span id='topic+dim+2CSpectraInTime-method'></span><span id='topic+extractSummarySpecs'></span><span id='topic+summary+2CSpectraInTime-method'></span><span id='topic+show+2CSummaryByWavelengths-method'></span><span id='topic+as.data.frame+2CSpectraInTime-method'></span><span id='topic+plot+2CSpectraInTime+2Cmissing-method'></span><span id='topic+plot'></span><span id='topic+plot.list'></span>

<h3>Description</h3>

<p>Time resolved spectra for one experiment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SpectraInTime'
dim(x)

extractSummarySpecs(object, summaryFunctions = getDefaultSumFunc())

## S4 method for signature 'SpectraInTime'
summary(object, summaryFunctions = getDefaultSumFunc())

## S4 method for signature 'SummaryByWavelengths'
show(object)

## S4 method for signature 'SpectraInTime'
as.data.frame(x, timePointsAlt = FALSE, timeUnit = "seconds")

## S4 method for signature 'SpectraInTime,missing'
plot(
  x,
  y,
  type = "3D",
  timeUnit = "hours",
  timePointsAlt = FALSE,
  ylab = "Wavelength",
  colors = "D",
  nColors = 200,
  limits = NULL
)

## S3 method for class 'list'
plot(x, ..., type = "line", ncol = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpectraInTime-class_+3A_x">x</code></td>
<td>
<p>the object to be plotted</p>
</td></tr>
<tr><td><code id="SpectraInTime-class_+3A_object">object</code></td>
<td>
<p><code>SpectraInTime-class</code></p>
</td></tr>
<tr><td><code id="SpectraInTime-class_+3A_summaryfunctions">summaryFunctions</code></td>
<td>
<p>character vector of summary functions</p>
</td></tr>
<tr><td><code id="SpectraInTime-class_+3A_timepointsalt">timePointsAlt</code></td>
<td>
<p>see <code><a href="#topic+getTimePoints">getTimePoints</a></code></p>
</td></tr>
<tr><td><code id="SpectraInTime-class_+3A_timeunit">timeUnit</code></td>
<td>
<p>time unit specification in the form of a character string</p>
</td></tr>
<tr><td><code id="SpectraInTime-class_+3A_y">y</code></td>
<td>
<p>not used, for consitency with plot method</p>
</td></tr>
<tr><td><code id="SpectraInTime-class_+3A_type">type</code></td>
<td>
<p>character choice of plot type between:
* <code>"3D"</code> surface plot (default)
* <code>"spectralAxis"</code> spectral axis in legend, time on the axis
* <code>"wavelength"</code> same behaviour as with <code>type</code> is &quot;spectralAxis&quot;, kept for historical reasons
* <code>"time"</code> time in legend, spectral values on the axis
*  <code>"contour"</code> contour plot of spectra time versus spectral values</p>
</td></tr>
<tr><td><code id="SpectraInTime-class_+3A_ylab">ylab</code></td>
<td>
<p>Specification y-axis label. By default this is &quot;Wavelength&quot;, but can be different for e.g. mass spectra</p>
</td></tr>
<tr><td><code id="SpectraInTime-class_+3A_colors">colors</code></td>
<td>
<p>colorblind friendly palettes are used from the de <code><a href="viridis.html#topic+viridis_pal">viridis_pal</a></code> choice between <code>"A"</code> (magna),
<code>"B"</code> (inferno),  <code>"C"</code> (plasma) and <code>"D"</code> the default viridis color palette</p>
</td></tr>
<tr><td><code id="SpectraInTime-class_+3A_ncolors">nColors</code></td>
<td>
<p>number of colours to use, only relevant if <code>type</code> is &quot;contour&quot;, defaults to 200</p>
</td></tr>
<tr><td><code id="SpectraInTime-class_+3A_limits">limits</code></td>
<td>
<p>2-element numeric vector specifying the range of values onto which the color scale should be mapped (currently only relevant if <code>type</code> is &quot;contour&quot;)</p>
</td></tr>
<tr><td><code id="SpectraInTime-class_+3A_...">...</code></td>
<td>
<p>additional argument, for plotting a list of spectra one can use:
</p>

<ul>
<li> <p><code>times</code> numeric vector of time points to plot
</p>
</li>
<li> <p><code>timeUnit</code> time unit for <code>times</code> default to &quot;seconds&quot;
</p>
</li>
<li> <p><code>timePointsAlt</code> logical value indicating whether alternative time axis should be used, defaults to <code>FALSE</code>
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with first column wavelengths followed
</p>
<p>a <code>data.frame</code> containing spectral information in long format
</p>
<p>data.frame
</p>


<h3>Slots</h3>


<dl>
<dt><code>spectra</code></dt><dd><p>matrix of spectral measurement with as rows timePoints and columns spectral axis</p>
</dd>
<dt><code>experimentName</code></dt><dd><p>character vector with name of the experiment</p>
</dd>
<dt><code>spectralAxis</code></dt><dd><p>numeric vector of spectral values (e.g. wavelengths or mass to charge)</p>
</dd>
<dt><code>timePoints</code></dt><dd><p>of measurement in seconds</p>
</dd>
<dt><code>timePointsAlt</code></dt><dd><p>numeric vector of shifted time points in order to time align multiple spectral measurements in plots, by default equal to timePoints</p>
</dd>
<dt><code>extraInfo</code></dt><dd><p>list additional information such as probe type</p>
</dd>
<dt><code>startTime</code></dt><dd><p>start date and time POSIXct format</p>
</dd>
<dt><code>units</code></dt><dd><p>list with information on measurement units</p>
</dd>
<dt><code>preprocessing</code></dt><dd><p>list of preprocessing steps in taken in order</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>


<h3>Examples</h3>

<pre><code class='language-R'> spectralExample  &lt;-  getSpectraInTimeExample() 
 summarySpectra   &lt;-  summary( spectralExample )
 str( summarySpectra )
 summarySpectra

## convert to data.frame
spectra                 &lt;-  getSpectraInTimeExample()
spectraFlat             &lt;-  as.data.frame( spectra )


### visualization 
  
  data = getSpectraInTimeExample()
  plot( x =  data , type = "3D" , timeUnit = "hours" , timePointsAlt = FALSE )
  plot( x =  data[  , r(500, 350) ] , type = "3D" ,
      timeUnit = "hours" , timePointsAlt = TRUE , colors = "B"  )
  plot( x =  data[ e( 1 , 2 , 3) , , timeUnit = "hours" ] ,
      type = "time" , timeUnit = "hours" , timePointsAlt = FALSE ) 
  plot( x =  data[ , e( seq( 200 , 400 , 50 ) ) ] , 
     type = "spectralAxis" , timeUnit = "minutes" , timePointsAlt = TRUE , colors = "A" )

  plot( x = data , type = "contour" , nColors = 200 , 
    colors = "C" , timeUnit = "seconds", timePointsAlt = TRUE)


 ## plotting a list of spectra
    
 listOfSpectra     &lt;-  getListOfSpectraExample()
 plot( listOfSpectra , times = 1 , timeUnit = "hours" )
 plot( listOfSpectra , times = 1 , timeUnit = "hours" , timePointsAlt = TRUE  )
 plot( listOfSpectra , times = 1:3 , timeUnit = "hours" , colors = "B" ) 

 plot( listOfSpectra , timeUnit = "hours" , colors = "C" , type = "contour" )

</code></pre>

<hr>
<h2 id='SpectraInTimeComp-class'>SpectraInTimeComp-class (time resolved spectra )</h2><span id='topic+SpectraInTimeComp-class'></span><span id='topic+SpectraInTimeComp'></span><span id='topic+spectraInTimeComp'></span><span id='topic+spectraintimecomp'></span><span id='topic+getDimensionReduction+2CSpectraInTimeComp-method'></span>

<h3>Description</h3>

<p>Spectral-time data for 1 experiment with dimension reduction techique NMF and/or PCA decomposition included
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SpectraInTimeComp'
getDimensionReduction(object, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SpectraInTimeComp-class_+3A_object">object</code></td>
<td>
<p>of class SpectraInTimeComp-class</p>
</td></tr>
<tr><td><code id="SpectraInTimeComp-class_+3A_type">type</code></td>
<td>
<p>type of regression method specified, if NULL the entire slot is returned as a list</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>dimensionReduction</code></dt><dd><p>list containing dimension reduction techique, either PCA or NMF, but only one per kind.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Adriaan Blommaert
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


  #  generate example 
 exampleSpectra     &lt;-  getSpectraInTimeCompExample()

  # methods
     PCAResult      &lt;-  getDimensionReduction( exampleSpectra, type = "PCA" )
     NMFResult      &lt;-  getDimensionReduction( exampleSpectra, type = "NMF" )
     
     dimensionReductions  &lt;-  getDimensionReduction( exampleSpectra )
     str(dimensionReductions  )

  # subsetting works by reducing to \code{\link{SpectraInTime-class}}
  subsetting     &lt;-  exampleSpectra[1:3 , r(400, 450)]
  # preprocessing methods also reduce the object to \code{\link{SpectraInTime-class}}



</code></pre>

<hr>
<h2 id='spectralIntegration'>Integrate spectraInTime object</h2><span id='topic+spectralIntegration'></span>

<h3>Description</h3>

<p>The integrated value over a user-specified spectral range is calculated (trapezium rule) per time point, afterwards smoothing over time can be applied
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spectralIntegration(
  object,
  spectralRange,
  smoothingValue = 0,
  timeUnit = "seconds"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spectralIntegration_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code></p>
</td></tr>
<tr><td><code id="spectralIntegration_+3A_spectralrange">spectralRange</code></td>
<td>
<p>numeric vector of 2 elements i.e. integration limits</p>
</td></tr>
<tr><td><code id="spectralIntegration_+3A_smoothingvalue">smoothingValue</code></td>
<td>
<p>numeric value between 0 and 1, amount of <code><a href="stats.html#topic+lowess">lowess</a></code>-smoothing,
default to <code>0</code> i.e no smoothing. Note that smoothing is applied  after integration</p>
</td></tr>
<tr><td><code id="spectralIntegration_+3A_timeunit">timeUnit</code></td>
<td>
<p>character value, choose between: <code>second , minutes and hours</code>, defaults to 
<code>seconds</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>data.frame</code> with variables <code>time</code> and <code>integratedValue</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spectra                   &lt;-  getSpectraInTimeExample()
defaults                  &lt;-  spectralIntegration( spectra , c(200 , 300) , timeUnit = "hours" )
unsmoothedTrend           &lt;-  spectralIntegration( spectra , c(200 , 300) , timeUnit = "hours" )
smoothedTrend             &lt;-  spectralIntegration( spectra , c(200 , 300) ,
  smoothingValue = 0.5 , timeUnit = "hours" ) 
</code></pre>

<hr>
<h2 id='spectralNMF'>Perform Non-Negative Matrix factorization on spectral data</h2><span id='topic+spectralNMF'></span>

<h3>Description</h3>

<p>Perform Non-Negative Matrix factorization on spectral data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spectralNMF(
  object,
  rank,
  method = "PGNMF",
  initSpectralData = NULL,
  nruns = 10,
  subsamplingFactor = 1,
  checkDivergence = TRUE,
  maxIter = 1000,
  includeRefs = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spectralNMF_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code></p>
</td></tr>
<tr><td><code id="spectralNMF_+3A_rank">rank</code></td>
<td>
<p>number of NMF components to be found</p>
</td></tr>
<tr><td><code id="spectralNMF_+3A_method">method</code></td>
<td>
<p>name of the NMF method to be used. &quot;PGNMF&quot; (default), &quot;HALSacc&quot; 
and &quot;semiNMF&quot; are methods derived from the hNMF package. All methods from the NMF package are also available.</p>
</td></tr>
<tr><td><code id="spectralNMF_+3A_initspectraldata">initSpectralData</code></td>
<td>
<p>this can be a list of spectralData objects, containing 
the pure component spectra. It can also be either of the NMF factor matrices with initial values</p>
</td></tr>
<tr><td><code id="spectralNMF_+3A_nruns">nruns</code></td>
<td>
<p>number of NMF runs. It is recommended to run the NMF analyses multiple
times when random seeding is used, to avoid a suboptimal solution</p>
</td></tr>
<tr><td><code id="spectralNMF_+3A_subsamplingfactor">subsamplingFactor</code></td>
<td>
<p>subsampling factor used during NMF analysis</p>
</td></tr>
<tr><td><code id="spectralNMF_+3A_checkdivergence">checkDivergence</code></td>
<td>
<p>Boolean indicating whether divergence checking should be performed</p>
</td></tr>
<tr><td><code id="spectralNMF_+3A_maxiter">maxIter</code></td>
<td>
<p>maximum number of iterations per NMF run</p>
</td></tr>
<tr><td><code id="spectralNMF_+3A_includerefs">includeRefs</code></td>
<td>
<p>boolean, indicating whether references should be included in the input matrix for the NMF analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTimeComp-class">SpectraInTimeComp-class</a></code> which includeds a scaled NMF model (in accordance with the NMF package definition)
</p>
<p><code><a href="#topic+SpectraInTimeComp-class">SpectraInTimeComp-class</a></code>
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 spectralExample    &lt;-  getSpectraInTimeExample()
 nmfResult          &lt;-  spectralNMF( spectralExample , rank = 2 , subsamplingFactor = 5 )
  nmfObject         &lt;-  getDimensionReduction( nmfResult , type = "NMF")$NMF
  nmfTrends         &lt;-  t( NMF::coef( nmfObject ) )
  matplot( nmfTrends , type = "l" , x = getTimePoints( spectralExample , timeUnit = "hours"  ),
		 xlab = "time in hours"  )

</code></pre>

<hr>
<h2 id='spectralNMFList'>Perform Non-Negative Matrix factorization on list of SPC files</h2><span id='topic+spectralNMFList'></span>

<h3>Description</h3>

<p>Perform Non-Negative Matrix factorization on list of SPC files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spectralNMFList(
  objectList,
  rank,
  method = "PGNMF",
  initSpectralData = NULL,
  nruns = 10,
  subsamplingFactor = 3,
  checkDivergence = TRUE,
  maxIter = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spectralNMFList_+3A_objectlist">objectList</code></td>
<td>
<p>list of SPC files</p>
</td></tr>
<tr><td><code id="spectralNMFList_+3A_rank">rank</code></td>
<td>
<p>number of NMF components to be found</p>
</td></tr>
<tr><td><code id="spectralNMFList_+3A_method">method</code></td>
<td>
<p>name of the NMF method to be used, consult the help
of the 'nmf' function from the NMF package for the methods available by default</p>
</td></tr>
<tr><td><code id="spectralNMFList_+3A_initspectraldata">initSpectralData</code></td>
<td>
<p>list of SPC files containing pure component spectra</p>
</td></tr>
<tr><td><code id="spectralNMFList_+3A_nruns">nruns</code></td>
<td>
<p>number of NMF runs.</p>
</td></tr>
<tr><td><code id="spectralNMFList_+3A_subsamplingfactor">subsamplingFactor</code></td>
<td>
<p>subsampling factor used during NMF analysis</p>
</td></tr>
<tr><td><code id="spectralNMFList_+3A_checkdivergence">checkDivergence</code></td>
<td>
<p>Boolean indicating whether divergence checking should be performed</p>
</td></tr>
<tr><td><code id="spectralNMFList_+3A_maxiter">maxIter</code></td>
<td>
<p>maximum number of iterations per NMF run</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of <code><a href="#topic+SpectraInTimeComp-class">SpectraInTimeComp-class</a></code>
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

   spectralData    &lt;-  getListOfSpectraExample()
   spectraWithNmf  &lt;-  spectralNMFList( spectralData , rank = 2 )

</code></pre>

<hr>
<h2 id='spectralNormalization'>normalization function</h2><span id='topic+spectralNormalization'></span>

<h3>Description</h3>

<p>normalization function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spectralNormalization(
  object,
  method = "normalize",
  spectralRange = r(-Inf, Inf),
  spectralAxisVal = NULL,
  scaleFunction = "sd",
  meanFunction = NULL
)
</code></pre>

<hr>
<h2 id='spectralPLSCalibration'>Compute PLS model</h2><span id='topic+spectralPLSCalibration'></span>

<h3>Description</h3>

<p>Compute PLS model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spectralPLSCalibration(objectList, UPLC_DF, ncomp = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spectralPLSCalibration_+3A_objectlist">objectList</code></td>
<td>
<p>list of SPC files</p>
</td></tr>
<tr><td><code id="spectralPLSCalibration_+3A_uplc_df">UPLC_DF</code></td>
<td>
<p>dataframe with UPLC data, which should contain the following columns: experiment, time, and 1 column per compound</p>
</td></tr>
<tr><td><code id="spectralPLSCalibration_+3A_ncomp">ncomp</code></td>
<td>
<p>number of PLS components, defaults to  10</p>
</td></tr>
</table>


<h3>Value</h3>

<p>PLS model, as obtained from <code><a href="pls.html#topic+plsr">plsr</a></code>
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>

<hr>
<h2 id='spectralPlsPrediction'>Perform PLS prediction</h2><span id='topic+spectralPlsPrediction'></span>

<h3>Description</h3>

<p>Perform PLS prediction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spectralPlsPrediction(spectralObject, plsModel, nComp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spectralPlsPrediction_+3A_spectralobject">spectralObject</code></td>
<td>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code></p>
</td></tr>
<tr><td><code id="spectralPlsPrediction_+3A_plsmodel">plsModel</code></td>
<td>
<p>PLS model as obtained from <code><a href="#topic+spectralPLSCalibration">spectralPLSCalibration</a></code></p>
</td></tr>
<tr><td><code id="spectralPlsPrediction_+3A_ncomp">nComp</code></td>
<td>
<p>Number of components</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTimeComp-class">SpectraInTimeComp-class</a></code> which includes PLS model + prediction
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>

<hr>
<h2 id='spectralSmoothAndDifferentiate'>internal smoothing and differentiation function</h2><span id='topic+spectralSmoothAndDifferentiate'></span>

<h3>Description</h3>

<p>internal smoothing and differentiation function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spectralSmoothAndDifferentiate(
  object,
  method = "sg",
  order = 3,
  window = order + 7 - order%%2,
  derivative = 0,
  dim = "spectralAxis"
)
</code></pre>

<hr>
<h2 id='subset-methods'>Subsetting  <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code></h2><span id='topic+subset-methods'></span><span id='topic++5B+2CSpectraInTime-method'></span><span id='topic++5B+2CSpectraInTime+2CANY+2CANY+2CANY-method'></span><span id='topic++5B+2CSpectraInTime+2CANY+2CANY-method'></span><span id='topic++5B+2CSpectraInTime+2Cmissing+2CANY-method'></span><span id='topic++5B+2CSpectraInTime+2CANY+2Cmissing-method'></span><span id='topic++5B+2CSpectraInTime+2Cmissing+2Cmissing-method'></span><span id='topic++5B+2CSpectraInTimeComp+2CANY+2CANY-method'></span><span id='topic++5B+2CSpectraInTimeComp+2Cmissing+2CANY-method'></span><span id='topic++5B+2CSpectraInTimeComp+2CANY+2Cmissing-method'></span>

<h3>Description</h3>

<p>Subsetting  <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SpectraInTime,ANY,ANY'
x[i, j, ..., drop = ""]

## S4 method for signature 'SpectraInTime,missing,ANY'
x[i, j, ..., drop = ""]

## S4 method for signature 'SpectraInTime,ANY,missing'
x[i, j, ..., drop = ""]

## S4 method for signature 'SpectraInTime,missing,missing'
x[i, j, ..., drop = ""]

## S4 method for signature 'SpectraInTimeComp,ANY,ANY'
x[i, j, ..., drop = ""]

## S4 method for signature 'SpectraInTimeComp,missing,ANY'
x[i, j, ..., drop = ""]

## S4 method for signature 'SpectraInTimeComp,ANY,missing'
x[i, j, ..., drop = ""]
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subset-methods_+3A_x">x</code></td>
<td>
<p>object to subset</p>
</td></tr>
<tr><td><code id="subset-methods_+3A_i">i</code></td>
<td>
<p>subsetting rows ( timePoints )</p>
</td></tr>
<tr><td><code id="subset-methods_+3A_j">j</code></td>
<td>
<p>subsetting columns ( spectral axis )</p>
</td></tr>
<tr><td><code id="subset-methods_+3A_...">...</code></td>
<td>
<p>additional parameters 
</p>

<ul>
<li><p> timeUnit unit at which subsetting should be done choose between <code>seconds</code> , <code>minutes</code> or <code>hours</code> 
defaults to <code>seconds</code>
</p>
</li>
<li><p>   timePointsAlt logical indicators whater alternative timePoints should be used 
</p>
</li></ul>
</td></tr>
<tr><td><code id="subset-methods_+3A_drop">drop</code></td>
<td>
<p>for consistancy, not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ### subsetting [ time , spectral axis, options ]

 spectralEx                &lt;-  getSpectraInTimeExample()
 spectraSubset             &lt;-  spectralEx[ r( 1000 , 30000 ) , r(130 , 135 ) ]
 spectraSubsetTime         &lt;-  spectralEx[ r( 1000 , 30000 ) ,  ]
 spectraSubsetSpectralVals  &lt;-  spectralEx[  ,  r(130 , 135 ) ]
 spectraSubsetHours        &lt;-  spectralEx[ r( 1 , 3 ) , r(130 , 135 ) , timeUnit = "hours" ]
 closestSpectralVals        &lt;-  spectralEx[ , e( 150, 4, 300, 500 ) ] # remark only unique values 
 spectraSubsetLogical      &lt;-  spectralEx[ getTimePoints( spectralEx ) &gt; 300   ,
 getSpectralAxis( spectralEx ) &lt;= 500 ]
</code></pre>

<hr>
<h2 id='subset.SpectraTime'>internal function for subsetting</h2><span id='topic+subset.SpectraTime'></span>

<h3>Description</h3>

<p>internal function for subsetting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SpectraTime'
subset(x, i, j, timeUnit = "seconds", timePointsAlt = FALSE, drop = "")
</code></pre>

<hr>
<h2 id='SummaryByWavelengths-class'>S4-class for summary object SpectraInTime</h2><span id='topic+SummaryByWavelengths-class'></span><span id='topic+SummaryByWavelengths'></span><span id='topic+plot+2CSummaryByWavelengths+2CANY-method'></span><span id='topic+getSpectra+2CSummaryByWavelengths-method'></span>

<h3>Description</h3>

<p>S4-class for summary object SpectraInTime
</p>
<p>plot summary of <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'SummaryByWavelengths,ANY'
plot(x, y, colors = NULL)

## S4 method for signature 'SummaryByWavelengths'
getSpectra(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SummaryByWavelengths-class_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+SummaryByWavelengths-class">SummaryByWavelengths-class</a></code></p>
</td></tr>
<tr><td><code id="SummaryByWavelengths-class_+3A_y">y</code></td>
<td>
<p>no used, for internal consistency</p>
</td></tr>
<tr><td><code id="SummaryByWavelengths-class_+3A_colors">colors</code></td>
<td>
<p>a vector of colors used in the plot, default to <code>NULL</code>, when default colors are used</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>summary               &lt;-  summary( getSpectraInTimeExample() )
plot( summary )
</code></pre>

<hr>
<h2 id='testListOfSpectra'>internal function to check all elements are spectraInTime</h2><span id='topic+testListOfSpectra'></span>

<h3>Description</h3>

<p>internal function to check all elements are spectraInTime
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testListOfSpectra(list)
</code></pre>

<hr>
<h2 id='timeAlign'>Time align first object, using info in the second object</h2><span id='topic+timeAlign'></span><span id='topic+timeAlign+2CSpectraInTime+2CProcessTimes-method'></span><span id='topic+timeAlign+2Clist+2CProcessTimesFrame-method'></span><span id='topic+timeAlign+2Clist+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Time align first object, using info in the second object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timeAlign(x, y, ...)

## S4 method for signature 'SpectraInTime,ProcessTimes'
timeAlign(x, y, cutCooling = FALSE, cutBeforeMinTemp = FALSE)

## S4 method for signature 'list,ProcessTimesFrame'
timeAlign(x, y, cutCooling = FALSE, cutBeforeMinTemp = FALSE)

## S4 method for signature 'list,character'
timeAlign(
  x,
  y,
  cutCooling = FALSE,
  cutBeforeMinTemp = FALSE,
  timeFormat = "%Y-%m-%d %H:%M:%S"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="timeAlign_+3A_x">x</code></td>
<td>
<p>and S4 object to be aligned</p>
</td></tr>
<tr><td><code id="timeAlign_+3A_y">y</code></td>
<td>
<p>object to use time information from</p>
</td></tr>
<tr><td><code id="timeAlign_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
<tr><td><code id="timeAlign_+3A_cutcooling">cutCooling</code></td>
<td>
<p>logical indicator if <code>TRUE</code> observation after cooling starts are cut off, defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="timeAlign_+3A_cutbeforemintemp">cutBeforeMinTemp</code></td>
<td>
<p>logical indicator if <code>TRUE</code> observation before minimum temperature are cut off, defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="timeAlign_+3A_timeformat">timeFormat</code></td>
<td>
<p>character vector specifying time format <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> or list of spectra depending on input
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 spectra             &lt;-  getSpectraInTimeExample()
 listOfSpectra       &lt;-  getListOfSpectraExample()
 processTimes        &lt;-  getProcessTimesExample()
 processTimesFrame   &lt;-  getProcessTimesFrameExample()
 pathProcessTimes    &lt;-  getPathProcessTimesExample()
  
ex1  &lt;-  timeAlign( x = spectra , y = processTimes ,
 cutCooling = TRUE , cutBeforeMinTemp = TRUE )
ex2  &lt;-  timeAlign( x = listOfSpectra , y = processTimesFrame ,
 cutCooling = TRUE , cutBeforeMinTemp = TRUE )
ex3  &lt;-  timeAlign( x = listOfSpectra , y = pathProcessTimes, 
 cutCooling = TRUE , cutBeforeMinTemp = TRUE  , timeFormat =  "%Y-%m-%d %H:%M:%OS" )
</code></pre>

<hr>
<h2 id='timeAlign.listOfSpectra'>Align all spectra in a list</h2><span id='topic+timeAlign.listOfSpectra'></span>

<h3>Description</h3>

<p>Align all spectra in a list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timeAlign.listOfSpectra(
  spectralDataList,
  processTimes,
  cutCooling,
  cutBeforeMinTemp
)
</code></pre>

<hr>
<h2 id='timeAlign.SpectraInTime'>align 1 SpectraInTime with 1 cooling information</h2><span id='topic+timeAlign.SpectraInTime'></span>

<h3>Description</h3>

<p>align 1 SpectraInTime with 1 cooling information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timeAlign.SpectraInTime(x, y, cutCooling, cutBeforeMinTemp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="timeAlign.SpectraInTime_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code></p>
</td></tr>
<tr><td><code id="timeAlign.SpectraInTime_+3A_y">y</code></td>
<td>
<p><code><a href="#topic+ProcessTimes-class">ProcessTimes-class</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='trapz'>Integration via trapezium rule</h2><span id='topic+trapz'></span>

<h3>Description</h3>

<p>Originally from caTools package, included to avoid dependency on old package
with correction inverse scale, should give still possitive values (taken absolute values )
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trapz(x, y)
</code></pre>

<hr>
<h2 id='upsampleNMFResult'>Upsample NMF result to original temporal resolution</h2><span id='topic+upsampleNMFResult'></span>

<h3>Description</h3>

<p>Upsample NMF result to original temporal resolution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upsampleNMFResult(NMFResult, timePoints, subsamplingFactor, shift = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="upsampleNMFResult_+3A_nmfresult">NMFResult</code></td>
<td>
<p>Fitted NMF model</p>
</td></tr>
<tr><td><code id="upsampleNMFResult_+3A_timepoints">timePoints</code></td>
<td>
<p>Original time points</p>
</td></tr>
<tr><td><code id="upsampleNMFResult_+3A_subsamplingfactor">subsamplingFactor</code></td>
<td>
<p>Subsampling factor</p>
</td></tr>
<tr><td><code id="upsampleNMFResult_+3A_shift">shift</code></td>
<td>
<p>Integer that correctly shifts subsampling index when 
applying NMF to multiple experiments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Upsampled NMF model
</p>


<h3>Author(s)</h3>

<p>Nicolas Sauwen
</p>

<hr>
<h2 id='wavelengthAlign'>Wavelength align spectral data</h2><span id='topic+wavelengthAlign'></span><span id='topic+wavelengthAlign+2CSpectraInTime+2CSpectraInTime-method'></span><span id='topic+wavelengthAlign+2CSpectraInTime+2Clist-method'></span>

<h3>Description</h3>

<p>Align SpectraInTime objects with differing wavelength axes to a common wavelength axis 
using cubic spline interpolation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wavelengthAlign(ref, toAlign)

## S4 method for signature 'SpectraInTime,SpectraInTime'
wavelengthAlign(ref, toAlign)

## S4 method for signature 'SpectraInTime,list'
wavelengthAlign(ref, toAlign)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wavelengthAlign_+3A_ref">ref</code></td>
<td>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> object with the reference wavelength vector</p>
</td></tr>
<tr><td><code id="wavelengthAlign_+3A_toalign">toAlign</code></td>
<td>
<p><code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code> object(s) to be aligned. This can either be a single SpectraInTime object
or a list of SpectraInTime objects. In case of a list, all objects in the list should have the same wavelength axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of aligned SpectraInTime objects, including the reference object.
</p>
<p>one or a list of <code><a href="#topic+SpectraInTime-class">SpectraInTime-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  spectra             &lt;-  getSpectraInTimeExample()
  listOfSpectra       &lt;-  getListOfSpectraExample()
  
# Dummy alignment of spectrum with itself:
  ex1                 &lt;-  wavelengthAlign( ref = spectra , toAlign = spectra )
# Alignment of list of spectra with a reference spectrum:
  ex2                 &lt;-  wavelengthAlign( ref = spectra , toAlign = listOfSpectra )
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
