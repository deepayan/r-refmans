<!DOCTYPE html><html><head><title>Help for package sads</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sads}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ARN82'><p>Biomass of marine animals in colonizing experiments in Baltic Sea</p></a></li>
<li><a href='#bci'>
<p>Tree species abundance in Barro Colorado Island Plot</p></a></li>
<li><a href='#birds'>
<p>Abundances of breeding birds in Quacker Run Valley, NY</p></a></li>
<li><a href='#coefficients,fitsad-method'><p>Standard stats methods</p></a></li>
<li><a href='#coverpred-class'><p>Class <code>"coverpred"</code> for predicted values for abundance classes</p></a></li>
<li><a href='#coverpred-methods'><p> ~~ Methods for Function <code>coverpred</code> in Package <span class="pkg">sads</span> ~~</p></a></li>
<li><a href='#dbs'><p>MacArthur's Broken-stick distribution</p></a></li>
<li><a href='#dgs'><p>Geometric series distribution</p></a></li>
<li><a href='#distr'><p>Continuous or discrete distributions</p></a></li>
<li><a href='#dls'><p>Fisher's Log-series distribution</p></a></li>
<li><a href='#dmand'><p>Zipf-Mandelbrodt distribution</p></a></li>
<li><a href='#dmzsm'><p>Metacommunity zero-sum multinomial distribution</p></a></li>
<li><a href='#dpareto'><p>Pareto distribution</p></a></li>
<li><a href='#dpoig'><p>Compound Poisson-gamma distribution</p></a></li>
<li><a href='#dpoilog'><p>Poisson-lognormal distribution</p></a></li>
<li><a href='#dpoix'><p>Compound Poisson-Exponential distribution</p></a></li>
<li><a href='#dpowbend'><p>Puyeo's Power-bend discrete distribution</p></a></li>
<li><a href='#dpower'><p>Power discrete distribution</p></a></li>
<li><a href='#dtrunc'><p>Left-truncation of density, probability and quantile of distributions</p></a></li>
<li><a href='#dvolkov'><p>Neutral Biodiversity Theory distribution by Volkov <em>et al.</em></p></a></li>
<li><a href='#dzipf'><p>Zipf distribution</p></a></li>
<li><a href='#fitrad'><p>ML fitting of species rank-abundance distributions</p></a></li>
<li><a href='#fitrad-class'><p>Class <code>"fitrad"</code> for maximum likelihood fitting of species</p>
rank-abundance distributions</a></li>
<li><a href='#fitsad'><p>ML fitting of species abundance distributions</p></a></li>
<li><a href='#fitsad-class'><p>Class <code>"fitsad"</code> for maximum likelihood fitting of</p>
species abundance distributions</a></li>
<li><a href='#fitsadC'><p>ML fitting of species abundance distributions to data pooled in abundance classes</p></a></li>
<li><a href='#fitsadC-class'><p>Class <code>"fitsadC"</code> for maximum likelihood fitting of</p>
species abundance distributions from data in abundance classes</a></li>
<li><a href='#grasslands'><p>Coverages of plants species in a plot in Southern Brazilian Grasslands</p></a></li>
<li><a href='#ICtab'><p>Compute table of information criteria and auxiliary info</p></a></li>
<li><a href='#likelregions-class'><p>Class <code>"likelregions"</code> for likelihood profiles of maximum likelihood fits</p></a></li>
<li><a href='#moths'>
<p>Moths caught with light traps at Rothamsted 1933-1936</p></a></li>
<li><a href='#octav-class'><p>Class <code>"octav"</code> for frequencies in abundance octaves</p></a></li>
<li><a href='#octav-methods'><p>Frequencies of species in octaves</p></a></li>
<li><a href='#octavpred-methods'><p>Predicted frequencies of species in octaves</p></a></li>
<li><a href='#okland'>
<p>Abundances of land snail species in Norway</p></a></li>
<li><a href='#plotprofmle-methods'><p>Log-likelihood profiles at original scale</p></a></li>
<li><a href='#ppsad and pprad methods'><p>Percentile-percentile plots for species-abundance and</p>
rank-abundance models</a></li>
<li><a href='#pred.logser'><p>Predicted number of species by Fisher's Logseries</p></a></li>
<li><a href='#qqsad and qqrad methods'><p>Quantile-quantile plots for species-abundance and</p>
rank-abundance models</a></li>
<li><a href='#rad'><p>Rank-abundance data frame</p></a></li>
<li><a href='#rad-class'><p>Class <code>"rad"</code> for rank-abundance data</p></a></li>
<li><a href='#radpred-methods'><p>Predicted ranked abundance of species</p></a></li>
<li><a href='#rsad'><p>Sampling from a species abundance distribution</p></a></li>
<li><a href='#sads-package'>
<p>Maximum Likelihood Models for Species Abundance Distributions</p></a></li>
<li><a href='#summary.sads-class'><p>Summary for fitsad/fitrad calls</p></a></li>
<li><a href='#trueLL-methods'><p>True likelihood for continuous variables</p></a></li>
<li><a href='#updatesad'><p>Updating of MLE fits by profiling</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Maximum Likelihood Models for Species Abundance Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Paulo I. Prado, Murilo Dantas Miranda and Andre Chalom</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paulo I. Prado &lt;prado@ib.usp.br&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), stats, stats4, bbmle (&ge; 1.0.19)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, methods, graphics, grDevices, VGAM, poilog, GUILDS,
poweRlaw</td>
</tr>
<tr>
<td>Suggests:</td>
<td>vegan</td>
</tr>
<tr>
<td>Description:</td>
<td>Maximum likelihood tools to fit and compare models of species
    abundance distributions and of species rank-abundance distributions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/piLaboratory/sads">https://github.com/piLaboratory/sads</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/piLaboratory/sads/issues">https://github.com/piLaboratory/sads/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-16 22:38:17 UTC; paulo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-16 23:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ARN82'>Biomass of marine animals in colonizing experiments in Baltic Sea</h2><span id='topic+ARN82.eB.apr77'></span>

<h3>Description</h3>

<p>A numeric vector of biomass of species of benthonic marine invertebrates that colonized experimental containers laid in the Baltic Sea.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ARN82.eB.apr77)
</code></pre>


<h3>Format</h3>

<p>Named vector of positive numbers. Labels are a sequential numeric code for species, in the same sequence as the original table.
</p>


<h3>Details</h3>

<p>Each value is the biomass of invertebrate species sampled in 13
containers laid in the seafloor,as reported in Table I in Arntz &amp; Rumohr
(1982). After the first year of exposition, 13 containers were recovered
every two months, starting in December 1976. Data are from containers recovered in April 1977.
</p>


<h3>Source</h3>

<p>Arntz, W. E., &amp; Rumohr, H. (1982). An experimental study of macrobenthic
colonization and succession, and the importance of seasonal variation in
temperate latitudes. Journal of experimental marine biology and ecology, 64(1), 17-45.
</p>


<h3>References</h3>

<p>Hughes, R. (1986). Theories and models of species abundance. The American Naturalist, 128(6), 879-899.
</p>

<hr>
<h2 id='bci'>
Tree species abundance in Barro Colorado Island Plot
</h2><span id='topic+bci'></span>

<h3>Description</h3>

<p>Number of species of trees with diameter at breast height
&gt;= 10 mm in a 50 ha plot of tropical forest in the Barro Colorado
Island, Panama.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bci)
</code></pre>


<h3>Format</h3>

<p>A named vector of 225 integers.
</p>


<h3>Details</h3>

<p>The BCI forest dynamics research project was made possible by National
Science Foundation grants to Stephen P. Hubbell: DEB-0640386,
DEB-0425651, DEB-0346488, DEB-0129874, DEB-00753102, DEB-9909347,
DEB-9615226, DEB-9615226, DEB-9405933, DEB-9221033, DEB-9100058,
DEB-8906869, DEB-8605042, DEB-8206992, DEB-7922197, support from the
Center for Tropical Forest Science, the Smithsonian Tropical Research
Institute, the John D. and Catherine T. MacArthur Foundation, the
Mellon Foundation, the Small World Institute Fund, and numerous
private individuals, and through the hard work of over 100 people from
10 countries over the past two decades. The plot project is part the
Center for Tropical Forest Science, a global network of large-scale
demographic tree plots. 
</p>


<h3>Source</h3>

<p>Datasheet 'full matrix' of supplemental table 1 in Condit et al. (2002). 
</p>


<h3>References</h3>

<p>Condit et. al 2002. Beta-diversity in tropical forest trees. <em>Science 295</em>:666-669
</p>
<p>Hubbell, S.P., Condit, R., and Foster, R.B. 2005. Barro Colorado
Forest Census Plot Data. URL
https://ctfs.arnarb.harvard.edu/webatlas/datasets/bci.
</p>
<p>Condit, R. 1998. <em>Tropical Forest Census Plots</em>. Springer-Verlag
and R. G. Landes Company, Berlin, Germany, and Georgetown, Texas. 
</p>

<hr>
<h2 id='birds'>
Abundances of breeding birds in Quacker Run Valley, NY
</h2><span id='topic+birds'></span>

<h3>Description</h3>

<p>Number of sights of nesting birds by species in a census
in a 16,697 acres Park in New York State, ran in 1936 by A. A. Saunders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(birds)
</code></pre>


<h3>Format</h3>

<p>An unnamed vector of integers
</p>


<h3>Details</h3>

<p>This is one of the datasets that F. W. Preston used in order to show the
application of the lognormal distribution to describe the abundance of species
in a sample of a biological community.
</p>


<h3>Source</h3>

<p>Table IA of Preston (1948), which did not provide species' names.
</p>


<h3>References</h3>

<p>Preston, F. W. 1948. The Commonness, and rarity, of
species. <em>Ecology 29</em>:254-283.
</p>
<p>Saunders, A. A. 1936. Studies of breeding birds in the Allegany State
Park. New York State Museum Handbook 16. Albany, NY.
</p>

<hr>
<h2 id='coefficients+2Cfitsad-method'>Standard stats methods</h2><span id='topic+coefficients+2Cfitsad-method'></span><span id='topic+coefficients+2CfitsadC-method'></span><span id='topic+coefficients+2Cfitrad-method'></span><span id='topic+fitted.values+2Cfitsad-method'></span><span id='topic+fitted.values+2CfitsadC-method'></span><span id='topic+fitted.values+2Cfitrad-method'></span><span id='topic+fitted+2Cfitsad-method'></span><span id='topic+fitted+2CfitsadC-method'></span><span id='topic+fitted+2Cfitrad-method'></span><span id='topic+residuals+2Cfitsad-method'></span><span id='topic+residuals+2CfitsadC-method'></span><span id='topic+residuals+2Cfitrad-method'></span>

<h3>Description</h3>

<p>Provide the standard interface for fitted objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitsad'
coefficients(object, ...)

## S4 method for signature 'fitsadC'
coefficients(object, ...)

## S4 method for signature 'fitrad'
coefficients(object, ...)

## S4 method for signature 'fitsad'
fitted.values(object, ...)

## S4 method for signature 'fitsadC'
fitted.values(object, ...)

## S4 method for signature 'fitrad'
fitted.values(object, ...)

## S4 method for signature 'fitsad'
fitted(object, ...)

## S4 method for signature 'fitsadC'
fitted(object, ...)

## S4 method for signature 'fitrad'
fitted(object, ...)

## S4 method for signature 'fitsad'
residuals(object, ...)

## S4 method for signature 'fitsadC'
residuals(object, ...)

## S4 method for signature 'fitrad'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coefficients+2B2Cfitsad-method_+3A_object">object</code></td>
<td>
<p>An object from class fitsad, fitrad or fitsadC</p>
</td></tr>
<tr><td><code id="coefficients+2B2Cfitsad-method_+3A_...">...</code></td>
<td>
<p>Other arguments to be forwarded for the lower level function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These methods are provided to allow for standard manipulation of <code><a href="#topic+fitsad">fitsad</a></code>, <code><a href="#topic+fitsadC">fitsadC</a></code> 
and <code><a href="#topic+fitrad">fitrad</a></code> objects using the generic methods defined in the &quot;stats&quot; package.
Please see the original man pages for each method.
</p>
<p><code>coefficients</code> is an alias to <code><a href="stats.html#topic+coef">coef</a></code> (implemented in package &quot;bbmle&quot;).
</p>
<p><code>fitted</code> and <code>fitted.values</code> provide an alternative interface to <code><a href="#topic+radpred">radpred</a></code>;
these are also used to calcutate <code>residuals</code>.
</p>
<p>Notice that radpred is a preferred interface for most calculations, specially if there are several
ties.
</p>

<hr>
<h2 id='coverpred-class'>Class <code>"coverpred"</code> for predicted values for abundance classes</h2><span id='topic+coverpred-class'></span><span id='topic+points+2Ccoverpred-method'></span>

<h3>Description</h3>

<p> A list with values that define abundance classes and
number and densities of species in each abundance, as predicted by a
model of species abundance distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'coverpred'
points(x, y.scale = c("density", "Freq", "prob"), mid = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coverpred-class_+3A_x">x</code></td>
<td>
<p>an object of class <code>coverpred</code></p>
</td></tr>
<tr><td><code id="coverpred-class_+3A_y.scale">y.scale</code></td>
<td>
<p>&quot;density&quot; plots points in density scale, &quot;Freq&quot; plots
frequencies and &quot;prob&quot; plots relative frequencies.</p>
</td></tr>
<tr><td><code id="coverpred-class_+3A_mid">mid</code></td>
<td>
<p>logical; if <kbd>TRUE</kbd> x coordinates of abundances are set
to the mid of each class, if <kbd>FALSE</kbd> x coordinates of abundances
are the values of class upper limit.</p>
</td></tr>
<tr><td><code id="coverpred-class_+3A_...">...</code></td>
<td>
<p>further parameters to be passed to <code>lines</code>.</p>
</td></tr>
</table>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("coverpred", ...)</code>,
but most often by a call to <code><a href="#topic+coverpred">coverpred</a></code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>.Data</code>:</dt><dd><p>Object of class <code>"list"</code> with five
vectors: breaks of abundance classes, midpoints of abundance classes,
upper limit of abundance classes, predicted proportion of species in each
abundance class, predicted number of species in each abundance class.</p>
</dd></dl>



<h3>Extends</h3>

<p>Class <code>"<a href="methods.html#topic+list-class">list</a>"</code>, directly.
Class <code>"<a href="methods.html#topic+oldClass-class">oldClass</a>"</code>, by class &quot;list&quot;, distance 2.
Class <code>"<a href="methods.html#topic+vector-class">vector</a>"</code>, by class &quot;list&quot;, distance 3.
</p>


<h3>Methods</h3>


<dl>
<dt>points</dt><dd><p><code>signature(x = "coverpred")</code>: adds frequency (or
density) data contained in the object as points in a histogram. </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andre Chalom and Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a></p>


<h3>See Also</h3>

 <p><code><a href="#topic+coverpred">coverpred</a></code> to get an object of the class from a
histogran, <code><a href="#topic+fitsadC">fitsadC</a></code> for fitting species abundance
distributions to abundance data aggregated in classes.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example of fitting a sad model to cover data 
## Abundance classes: cover scale for plants
Lbrk &lt;- c(0,1,3,5,15,25,35,45,55,65,75,85,95,100)
## To fit a sad model to cover data, data sould be in histogram format
grass.h &lt;- hist(grasslands$mids, breaks = Lbrk, plot = FALSE)
## Fits a Pareto distribution to the histogram object
grass.p &lt;- fitparetoC(grass.h)
## Values (densities, frequencies, relative frenquecies) predicted by the model for each size class
grass.p.pred &lt;- coverpred(grass.p)
## Plot histogram of observed values in density scale
plot(grass.h)
## adds points for the predicted values (predicted densities)
points(grass.p.pred)
</code></pre>

<hr>
<h2 id='coverpred-methods'> ~~ Methods for Function <code>coverpred</code> in Package <span class="pkg">sads</span> ~~</h2><span id='topic+coverpred'></span><span id='topic+coverpred-methods'></span><span id='topic+coverpred+2CfitsadC+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic+coverpred+2Chistogram+2Ccharacter+2Clist+2CANY+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic+coverpred+2Cmissing+2Ccharacter+2Clist+2CANY+2Cnumeric+2CANY+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Creates an object of <code>coverpred-class</code> with the
number of species in each abundance class predicted by a species
abundance distribution.</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="coverpred-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code>fitsadC</code> or <code>histogram</code>;
fitted model of species abundances
distributions. Alternatively a histogram with number of species in
each abundance class. 
</p>
</td></tr>
<tr><td><code id="coverpred-methods_+3A_sad">sad</code></td>
<td>
<p>character; root name of sad distribution to
calculate expected percentiles. See <code><a href="#topic+fitsadC">fitsadC</a></code>
for available distributions.
</p>
</td></tr>
<tr><td><code id="coverpred-methods_+3A_coef">coef</code></td>
<td>
<p>named list of numeric values; parameter values of the
distribution given in <code>sad</code>. Parameters should be named as in the corresponding density
function, and in the same order.
</p>
</td></tr>
<tr><td><code id="coverpred-methods_+3A_trunc">trunc</code></td>
<td>
<p>non-negative integer, trunc &gt; min(x); truncation point
if fitted distribution is truncated.
</p>
</td></tr>
<tr><td><code id="coverpred-methods_+3A_breaks">breaks</code></td>
<td>
<p>real vector; breakpoints of abundance classes.
</p>
</td></tr>
<tr><td><code id="coverpred-methods_+3A_mids">mids</code></td>
<td>
<p>real vector; breakpoints of abundance classes.
</p>
</td></tr>
<tr><td><code id="coverpred-methods_+3A_s">S</code></td>
<td>
<p>integer; total number of species.
</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "fitsadC", sad = "missing",
	coef = "missing", trunc = "missing", breaks = "missing",
	mids = "missing", S = "missing")</code></dt><dd>
<p>number of species in each abundance class
predicted from a sads model fitted with function
<code>fitsadC</code>.
</p>
</dd>
<dt><code>signature(object = "histogram", sad = "character",
	coef = "list", trunc = "ANY", breaks = "missing",
	mids = "missing", S = "missing")</code></dt><dd>
<p>number of species in each abundance class
predicted from abundance distribution named by <code>sad</code> with
parameters defined in <code>coef</code>. Number of species S and
intervals of the abundance classes defined are given by
<code>histogram</code>.
</p>
</dd>
<dt><code>signature(object = "missing", sad = "character",
	coef = "list", trunc = "ANY", breaks = "numeric",
	mids = "ANY", S = "numeric")</code></dt><dd>
<p>number of species each abundance class
predicted from abundance distribution named by <code>sad</code> with
parameters defined in <code>coef</code>,  number of species S defined
in <code>S</code>. Abundance classes are defined by their breakpoints
(<code>breaks</code>) or by their midpoints (<code>mids</code>).
</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example of fitting a sad model to cover data 
## Abundance classes: cover scale for plants
Lbrk &lt;- c(0,1,3,5,15,25,35,45,55,65,75,85,95,100)
## To fit a sad model to cover data, data sould be in histogram format
grass.h &lt;- hist(grasslands$mids, breaks = Lbrk, plot = FALSE)
## Fits a Pareto distribution to the histogram object
grass.p &lt;- fitparetoC(grass.h)
## Values (densities, frequencies, relative frenquecies) predicted by the model for each size class
grass.p.pred &lt;- coverpred(grass.p)
## Plot histogram of observed values in density scale
plot(grass.h)
## adds points for the predicted values (predicted densities)
points(grass.p.pred)
## Predicted values for the same data but other parameter values
grass.p.pred2 &lt;- coverpred(grass.h, sad = "pareto", coef = list(shape = 1, scale = 0.5)) 
## Adds the new predicted values to the plot
points(grass.p.pred2, col = "red") 
</code></pre>

<hr>
<h2 id='dbs'>MacArthur's Broken-stick distribution</h2><span id='topic+dbs'></span><span id='topic+pbs'></span><span id='topic+qbs'></span><span id='topic+drbs'></span><span id='topic+prbs'></span><span id='topic+qrbs'></span><span id='topic+rrbs'></span><span id='topic+rbs'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
the Broken-stick distribution with parameters <code>N</code> and <code>S</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbs( x, N, S, log = FALSE )
pbs( q, N, S, lower.tail = TRUE, log.p = FALSE )
qbs( p, N, S, lower.tail = TRUE, log.p = FALSE )
rbs( n, N, S )
drbs( x, N, S, log = FALSE )
prbs( q, N, S, lower.tail = TRUE, log.p = FALSE )
qrbs( p, N, S, lower.tail = TRUE, log.p = FALSE )
rrbs( n, N, S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbs_+3A_x">x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, this is a vector of abundances (for
<code>dbs</code>) or abundance ranks (for <code>drbs</code>)
of species in a sample.
</p>
</td></tr>
<tr><td><code id="dbs_+3A_q">q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, a vector of abundances
(for <code>dbs</code>)
or abundance ranks (for <code>drbs</code>) of species in a sample.
</p>
</td></tr>
<tr><td><code id="dbs_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dbs_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dbs_+3A_n">N</code></td>
<td>

<p>positive integer 0 &lt; N &lt; Inf, sample size. In the context of
species abundance distributions, the sum of abundances of individuals in a sample.
</p>
</td></tr>
<tr><td><code id="dbs_+3A_s">S</code></td>
<td>

<p>positive integer 0 &lt; S &lt; Inf, number of elements in a collection.
In the context of species abundance distributions, the number of species in a sample.
</p>
</td></tr>
<tr><td><code id="dbs_+3A_log">log</code>, <code id="dbs_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
<tr><td><code id="dbs_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Broken-stick distribution was proposed as a model for
the expected abundance of elements in a collection:
</p>
<p style="text-align: center;"><code class="reqn">n(i) = \frac{N}{S} \sum_{k=i}^S 1/k</code>
</p>

<p>where n(i) is the abundance in the i-th most abundant element
(MacArthur 1960, May 1975).
Hence the probability (or expected proportion of occurrences)
in the i-th element is
</p>
<p style="text-align: center;"><code class="reqn">p(i) = \frac{n(i)}{S} = S^{-1}\sum_{k=i}^S 1/k</code>
</p>

<p><code>[dpq]rbs</code> stands for &quot;rank-abundance Broken-stick&quot; and return
probabilities and quantiles based on the expression above, for p(i).
Therefore, <code>[dpq]rbs</code> can be used as a rank-abundance model
for species' ranks in a sample or in a biological community
see <code><a href="#topic+fitrad">fitrad</a></code>.
</p>
<p>The probability density for a given abundance value in the Broken-stick model
is given by 
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{S-1}{N} \left( 1 -  \frac{x}{N} \right)^{S-2}</code>
</p>

<p>Where x is the abundance of a given element in the collection (May 1975).
<code>[dpq]bs</code> return probabilities and quantiles according to the
expression above for p(x).
Therefore, <code>[dpq]bs</code> can be used as a
species abundance model
see <code><a href="#topic+fitsad">fitsad</a></code>.
</p>


<h3>Value</h3>

<p><code>dbs</code>  gives the (log) density and  <code>pbs</code> gives the (log)
distribution function of abundances,  and <code>qbs</code> gives the
corresponding quantile function.
<code>drbs</code>  gives the (log) density and  <code>prbs</code> gives the (log)
distribution function of ranks,  and <code>qrbs</code> gives the
corresponding quantile function.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>MacArthur, R.H. 1960. On the relative abundance of species.
<em>Am Nat 94</em>:25&ndash;36.
</p>
<p>May, R.M. 1975. Patterns of Species Abundance and Diversity. In
Cody, M.L. and Diamond, J.M. (Eds) <em>Ecology and Evolution of
Communities</em>. Harvard University Press. pp 81&ndash;120.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitbs">fitbs</a></code> and <code><a href="#topic+fitrbs">fitrbs</a></code> to fit the Broken-stick distribution
as a abundance (SAD) and rank-abundance (RAD) model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:25
PDF &lt;- drbs(x=x, N=100, S=25)
CDF &lt;- prbs(q=x, N=100, S=25)
par(mfrow=c(1,2))
plot(x,CDF, ylab="Cumulative Probability", type="b",
     main="Broken-stick rank distribution, CDF")
plot(x,PDF, ylab="Probability", type="h",
     main="Broken-stick rank distribution, PDF")
par(mfrow=c(1,1))

## quantile is the inverse of CDF
all.equal( qrbs( CDF, N=100, S=25), x) # should be TRUE
</code></pre>

<hr>
<h2 id='dgs'>Geometric series distribution</h2><span id='topic+dgs'></span><span id='topic+pgs'></span><span id='topic+qgs'></span><span id='topic+rgs'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
the Geometric Series distribution, with parameter <code>k</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgs( x, k, S, log = FALSE )
pgs( q, k, S, lower.tail = TRUE, log.p = FALSE )
qgs( p, k, S, lower.tail = TRUE, log.p = FALSE )
rgs( n, k, S )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dgs_+3A_x">x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, this is a vector of abundance ranks
of species in a sample.
</p>
</td></tr>
<tr><td><code id="dgs_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dgs_+3A_k">k</code></td>
<td>

<p>positive real, 0 &lt; k &lt; 1; geometric series coefficient; the ratio between
the abundances of i-th and (i+1)-th species. 
</p>
</td></tr>
<tr><td><code id="dgs_+3A_q">q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, a vector 
of abundance ranks of species in a sample.
</p>
</td></tr>
<tr><td><code id="dgs_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dgs_+3A_s">S</code></td>
<td>

<p>positive integer 0 &lt; S &lt; Inf, number of elements in a collection.
In the context of species abundance distributions, the number of species in a sample.
</p>
</td></tr>
<tr><td><code id="dgs_+3A_log">log</code>, <code id="dgs_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
<tr><td><code id="dgs_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

  
<p>The Geometric series distribution gives the probability (or expected
proportion of occurrences) of the i-th most abundant element
in a collection:
</p>
<p style="text-align: center;"><code class="reqn">p(i) = C k (1-k)^{i-1}</code>
</p>

<p>where C is a normalization constant which makes the summation of p(i) over
S equals to one:
</p>
<p style="text-align: center;"><code class="reqn">C = \frac{1}{1 - (1-k)^S}</code>
</p>

<p>where S is the number of species in the sample.
</p>
<p>Therefore, <code>[dpq]gs</code> can be used as rank-abundance model
for species ranks in a sample or biological community
see <code><a href="#topic+fitrad-class">fitrad-class</a></code>.
</p>


<h3>Value</h3>

<p><code>dgs</code>  gives the (log) density and  <code>pgs</code> gives the (log)
distribution function of ranks,  and <code>qgs</code> gives the
corresponding quantile function.
</p>


<h3>Note</h3>

<p>The Geometric series is NOT the same as geometric distribution. In
the context of community ecology, the first can be used
as a rank-abundance model and the former as a species-abundance
model. See <code><a href="#topic+fitsad">fitsad</a></code> and <code><a href="#topic+fitrad">fitrad</a></code> and vignettes
of <span class="pkg">sads</span> package.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>Doi, H. and Mori, T. 2012. The discovery of species-abundance
distribution in an ecological community. <em>Oikos 122:</em> 179&ndash;182.
</p>
<p>May, R.M. 1975. Patterns of Species Abundance and Diversity. In
Cody, M.L. and Diamond, J.M. (Eds) <em>Ecology and Evolution of
Communities</em>. Harvard University Press. pp 81&ndash;120.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+fitgs">fitgs</a></code>, <code><a href="#topic+fitrad">fitrad</a></code> to fit the Geometric series as a
rank-abundance model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:25
PDF &lt;- dgs(x=x, k=0.1, S=25)
CDF &lt;- pgs(q=x, k=0.1, S=25)
par(mfrow=c(1,2))
plot(x,CDF, ylab="Cumulative Probability", type="b",
     main="Geometric series distribution, CDF")
plot(x,PDF, ylab="Probability, log-scale", type="h",
     main="Geometric series distribution, PDF", log="y")
par(mfrow=c(1,1))

## quantile is the inverse of CDF
all.equal(qgs(CDF, k=0.1, S=25), x)
</code></pre>

<hr>
<h2 id='distr'>Continuous or discrete distributions</h2><span id='topic+distr'></span>

<h3>Description</h3>

<p>Checks if the distribution is continuous or discrete
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distr(distribution)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distr_+3A_distribution">distribution</code></td>
<td>
<p>Character. The name of the distribution (&quot;geom&quot; for &quot;fitgeom&quot;, &quot;weibull&quot; for &quot;fitweibull&quot;, etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns whether a given distribution (used for a sad or rad model) is &quot;discrete&quot;
or &quot;continuous&quot;. The name is compared to a list of known distributions, so distributions
not used in the sads package will return &quot;NA&quot; with a warning.
</p>
<p>In the package sads up to version 0.2.3, the user was required to explicitly set 
a distr argument in some calls to <code><a href="#topic+radpred">radpred</a></code> and <code><a href="#topic+qqsad">qqsad</a></code>. Now
this is handled automatically, and attempts to set the &quot;distr&quot; argument explicitly are ignored.
</p>

<hr>
<h2 id='dls'>Fisher's Log-series distribution</h2><span id='topic+dls'></span><span id='topic+pls'></span><span id='topic+qls'></span><span id='topic+rls'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the Fisher's
log-series probability distribution with parameter <code>alpha</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dls( x, N , alpha, log=FALSE)
pls(q, N, alpha, lower.tail=TRUE, log.p=FALSE)
qls(p, N, alpha, lower.tail = TRUE, log.p = FALSE)
rls(n, N, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dls_+3A_x">x</code></td>
<td>

<p>vector of (integer, x&gt;0) quantiles. Usually a vector of abundances of species in a sample.
</p>
</td></tr>
<tr><td><code id="dls_+3A_q">q</code></td>
<td>
<p>vector of (integer, x&gt;0) quantiles. Usually a vector of
abundances of species in a sample.
</p>
</td></tr>
<tr><td><code id="dls_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dls_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dls_+3A_n">N</code></td>
<td>

<p>sample size. Usually the total number of individuals in the sample (see details).
</p>
</td></tr>
<tr><td><code id="dls_+3A_alpha">alpha</code></td>
<td>

<p>real positive; Fisher's alpha parameter (see details).
</p>
</td></tr>
<tr><td><code id="dls_+3A_log">log</code>, <code id="dls_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
<tr><td><code id="dls_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Fisher log-series is a limiting case of the Negative Binomial where
the dispersion parameter of the negative binomial tends to zero. It
was originally proposed by Fisher (1943) to relate the expected number
of species in a sample from a biological community to the sample size as:
</p>

<p>Where alpha is the single parameter of the log-series distribution,
often used as a diversity index. From this relation follows that the
expected number of species with x individuals in the sample is
</p>
<p style="text-align: center;"><code class="reqn">S(x) = \alpha \, \frac{X^x}{x}</code>
</p>

<p>Where X is a function of alpha and N, that tends to one as the sample
size N increases:
</p>
<p style="text-align: center;"><code class="reqn">X = \frac{N}{\alpha + N}</code>
</p>

<p>The density function used here is derived by Alonso et al. (2008,
supplementary material). In ecology, this density distribution gives
the probability that a species has
an abundance of x individuals in a random sample of size N of the
community. In the community, the species abundances are independent
random variables that follow a log-series distribution. Thus, a random
sample of a log-series is also a log-series distribution.
</p>
<p>Therefore, a log-series distribution is a model for species
abundances distributions (SAD) under the assumptions that (a) species
abundances in the community are independent identically distributed
log-series variables, (b) sampling is a Poisson process, (c)
sampling is done with replacement, or the fraction
sampled is small enough to approximate a sample with replacement.
</p>


<h3>Value</h3>

<p><code>dls</code> gives the (log) of the density, <code>pls</code> gives the (log)
distribution function, <code>qls</code> gives the (log) the quantile function.
</p>
<p>Invalid values for parameter <code>alpha</code> will result in return
values <code>NaN</code>, with a warning.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>Alonso, D. and Ostling, A., and Etienne, R. S. 2008 The implicit
assumption of symmetry and the species abundance
distribution. Ecology Letters, 11: 93-105.
</p>
<p>Fisher, R.A, Corbert, A.S. and Williams, C.B. (1943) The Relation
between the number of species and the number of individuals in a
random sample of an animal population. The Journal of Animal Ecology,
12(1): 42&ndash;58.
</p>
<p>Green,J. and Plotkin, J.B. 2007 A statistical theory for sampling
species abundances. Ecology Letters 10:1037&ndash;1045
</p>
<p>Pielou, E.C. 1977. Mathematical Ecology. New York: John Wiley
and Sons.
</p>


<h3>See Also</h3>

<p><code>dpois</code>, <code>dnbinom</code>, <code><a href="#topic+dpoig">dpoig</a></code>.
For maximum likelihood estimation in the context of species
abundance distributions see <code><a href="#topic+fitls">fitls</a></code>, <code>fisherfit</code> in <span class="pkg">vegan</span> package
and <code>fisher</code> in <span class="pkg">untb</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:100
PDF &lt;- dls(x=x, N=100, alpha=5)
CDF &lt;- pls(q=x, N=100, alpha=5)
par(mfrow=c(1,2))
plot(x,CDF, ylab="Cumulative Probability", type="b",
     main="Log-Series distribution, CDF")
plot(x,PDF, ylab="Probability", type="h",
     main="Log-Series distribution, PDF")
par(mfrow=c(1,1))

## Fisher log-series is a discrete PDF, hence:
all.equal(pls(10,N=1000,alpha=50), sum(dls(1:10,N=1000,alpha=50))) # should be TRUE

## qls is the inverse of pls
all.equal(qls(CDF,N=100,alpha=5), x) # should be TRUE
</code></pre>

<hr>
<h2 id='dmand'>Zipf-Mandelbrodt distribution</h2><span id='topic+dmand'></span><span id='topic+pmand'></span><span id='topic+qmand'></span><span id='topic+rmand'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
Zipf-Mandelbrodt distribution with parameters <code>N</code> <code>s</code> and <code>v</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmand( x, N, s, v, log=FALSE)
pmand( q, N, s, v, lower.tail=TRUE, log.p=FALSE)
qmand( p, N, s, v, lower.tail = TRUE, log.p = FALSE)
rmand( n, N, s, v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dmand_+3A_x">x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, this is a vector of abundance ranks of species in a sample.
</p>
</td></tr>
<tr><td><code id="dmand_+3A_q">q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, a vector of abundance ranks of species in a sample.
</p>
</td></tr>
<tr><td><code id="dmand_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dmand_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dmand_+3A_n">N</code></td>
<td>

<p>positive integer 0 &lt; N &lt; Inf, total number of elements of a collection. In the context of
species abundance distributions, usually the number of species in a sample.
</p>
</td></tr>
<tr><td><code id="dmand_+3A_s">s</code></td>
<td>

<p>positive real s &gt; 0; Zipf-Mandelbrodt exponent.
</p>
</td></tr>
<tr><td><code id="dmand_+3A_v">v</code></td>
<td>

<p>positive real or zero v &gt;= 0; Zipf-Mandelbrodt parameter.  
</p>
</td></tr>
<tr><td><code id="dmand_+3A_log">log</code>, <code id="dmand_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
<tr><td><code id="dmand_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Mandelbrodt distribution describes the probability or frequency of occurrence
of a given element from a set of <code>N</code> elements. This probability  is inversely proportional to a power <code>s</code> of the
rank of the frequency of the element in the set. The density function is
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{(x+v)^{-s}}{\sum_{i=1}^N (i+v)^{-s}}</code>
</p>

<p>Since p(x) is proportional to a power of <code>x</code>, the Zipf-Mandelbrodt distribution is a
power distribution. The Zipf distribution is a special case when
v=0. Hence, the Zipf-Mandelbrodt distribution is a generalization of the
Zipf Law, and is widely used in the [x] for the same purposes. In Ecology, it
can be used to describe the probability of the abundance rank <code>x</code> of given species in a sample or assemblage of <code>N</code>
species.
</p>


<h3>Value</h3>

<p><code>dmand</code> gives the (log) density of the density, <code>pmand</code> gives the (log)
distribution function, <code>qmand</code> gives the quantile function.
</p>
<p>Invalid values for parameters <code>v</code> or <code>s</code> will result in return
values <code>NaN</code>, with a warning.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>Johnson N.L., Kemp, A.W. and Kotz S. 2005. <em>Univariate Discrete
Distributions</em>, 3rd edition, Hoboken, New Jersey: Wiley. Section
11.2.20. 
</p>
<p>Magurran, A.E. and McGill, B.J. 2011. <em>Biological Diversity -
Frontiers in measurement and assessment</em>. Oxford: Oxford University Press.
</p>


<h3>See Also</h3>

<p><code>dmand</code> and <code>rmand</code> and related functions in <span class="pkg">mandR</span> package; <code>Zeta</code> for
zeta distribution in <span class="pkg">VGAM</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:100
PDF &lt;- dmand(x=x, N=100, s=1.5, v=2)
CDF &lt;- pmand(q=x, N=100, s=1.5, v=2)
par(mfrow=c(1,2))
plot(x,CDF, ylab="Cumulative Probability", type="b",
     main="Zipf-Mandelbrodt distribution, CDF")
plot(x,PDF, ylab="Probability", type="h",
     main="Zipf-Mandelbrodt distribution, PDF")
par(mfrow=c(1,1))

## quantile is the inverse of CDF
all.equal( qmand(p=CDF, N=100, s=1.5, v=2), x)

## Zipf distribution is a particular case of ZM when v=0
all.equal( dmand(x=x, N=100, s=1.5, v=0), dzipf(x=x, N=100, s=1.5) )

</code></pre>

<hr>
<h2 id='dmzsm'>Metacommunity zero-sum multinomial distribution</h2><span id='topic+dmzsm'></span><span id='topic+pmzsm'></span><span id='topic+qmzsm'></span><span id='topic+rmzsm'></span>

<h3>Description</h3>

<p>Density, distribution, quantile function and random generation
for Alonso &amp; McKane's mZSM distribution with parameter <code>theta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmzsm(x, J, theta, log = FALSE)
pmzsm(q, J, theta, lower.tail=TRUE, log.p=FALSE)
qmzsm(p, J, theta, lower.tail = TRUE, log.p = FALSE)
rmzsm(n, J, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dmzsm_+3A_x">x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, this is a
vector of abundance of species in a sample.
</p>
</td></tr>
<tr><td><code id="dmzsm_+3A_q">q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, a vector of abundance of species in a sample.
</p>
</td></tr>
<tr><td><code id="dmzsm_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dmzsm_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dmzsm_+3A_j">J</code></td>
<td>

<p>positive integer 0 &lt; J &lt; Inf, sample size.  In the context of
species abundance distributions, usually the number of individuals in a sample.
</p>
</td></tr>
<tr><td><code id="dmzsm_+3A_theta">theta</code></td>
<td>

<p>positive real theta &gt; 0; Hubbell's &lsquo;fundamental biodiversity number&rsquo;
</p>
</td></tr>
<tr><td><code id="dmzsm_+3A_log">log</code>, <code id="dmzsm_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
<tr><td><code id="dmzsm_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The metacommunity Zero-sum multinomial distribution
(mZSM)
describes the probabilities
of abundances (population sizes)
in a random sample of size J taken from a
collection 
of populations (the metacommunity).
The total number of individuals in the metacommunity is fixed (zero-sum assumption).
The populations in the metacommunity undergo a stochastic
birth-death-immigration process,
with equal demographic rates (neutrality or ecological
equivalence assumption, Hubbell 2001).
Alonso and McKane (2004) proposed an approximation for the density
function for a large Poisson sample (J&gt;100):
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{N(x)}{\sum_1^S N(x)}</code>
</p>

<p>where S is the number of populations in the sample, and
N(x) is the expected number of sampled populations of size x :
</p>
<p style="text-align: center;"><code class="reqn">N(x) = \frac{\theta}{x (1 - x/J)^{\theta -1}}</code>
</p>

<p>Therefore, the mZSM 
is a model for species
abundances distributions (SAD)
in a sample taken from a community under
the assumptions that (a) species
abundances in the community follows the stationary distribution
of a neutral, zero-sum stochastic process of birth, death and speciation (or migration);
(b) sampling is a Poisson process with expected
value well approximated by N(x), (c) individuals are sampled with replacement, or the
fraction of total individuals sampled is small enough to approximate a
sample with replacement.
</p>


<h3>Value</h3>

<p><code>dmzsm</code> gives the (log) density function, <code>pmzsm</code> gives the (log)
distribution function, and <code>qmzsm</code> gives the quantile function.
</p>
<p>Invalid values for parameters <code>J</code> or <code>theta</code> will result in return
values <code>NaN</code>, with a warning.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Murilo Dantas Miranda and Andre Chalom</p>


<h3>References</h3>

<p>Alonso, D. and McKane, A.J.  2004.  Sampling Hubbell's neutral
model of biodiversity. <em>Ecology Letters 7</em>:901-910.
</p>
<p>Hubbell, S.P.  2001.  <em>The Unified Neutral Theory of Biodiversity</em>.
Princeton University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitmzsm">fitmzsm</a></code> for maximum likelihood estimation;
<code>alonso.eqn12</code>
in package <span class="pkg">untb</span> which is based on the exact formulation of mZSM.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Alonso &amp; McKanne (2004) figure 2
data(moths) #Fisher's moths data
m.tab &lt;- hist(moths, breaks = 2^(0:12), plot = FALSE)
plot(m.tab$density~m.tab$mids, log="xy",
     xlab = "Abundance", ylab = "Probability density",
     ylim=c(1e-7,1))
X &lt;- 1:max(moths)
Y &lt;- dmzsm(X, J = sum(moths), theta = 39.8)
lines(Y ~ X)
</code></pre>

<hr>
<h2 id='dpareto'>Pareto distribution</h2><span id='topic+dpareto'></span><span id='topic+ppareto'></span><span id='topic+qpareto'></span><span id='topic+rpareto'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
the Pareto distribution with parameters <code>shape</code> and <code>scale</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpareto(x, shape, scale = min(x), log = FALSE)
ppareto(q, shape, scale = min(q), lower.tail = TRUE, log.p = FALSE)
qpareto(p, shape, scale = min(p), lower.tail = TRUE, log.p = FALSE)
rpareto(n, shape, scale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dpareto_+3A_x">x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, this is a vector of abundances of species in a sample.
</p>
</td></tr>
<tr><td><code id="dpareto_+3A_q">q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, a vector of
abundances of species in a sample.
</p>
</td></tr>
<tr><td><code id="dpareto_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dpareto_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dpareto_+3A_shape">shape</code></td>
<td>

<p>positive real; shape parameter, a.k.a Pareto's index or tail index.
</p>
</td></tr>
<tr><td><code id="dpareto_+3A_scale">scale</code></td>
<td>

<p>positive real, scale &gt;= min(x); scale parameter.
</p>
</td></tr>
<tr><td><code id="dpareto_+3A_log">log</code>, <code id="dpareto_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p and densities d are given as
log(p) and log(d).
</p>
</td></tr>
<tr><td><code id="dpareto_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Pareto distribution is a continuous power-law density distribution
with <code>scale</code> (a) and <code>shape</code> (b) parameters with the form:
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac{b a^b} {x^{b+1}}</code>
</p>

<p>For all x &gt;= scale, and
</p>
<p>f(x) = 0 otherwise.
</p>
<p>The shape parameter is known as Pareto's index or tail index, and
increases the decay of f(x). This distribution was originally used to
describe the allocation of wealth or income among individuals in human
societies. As a continuous counterpart of Zipf
Law, Pareto distribution describes well many other variables that follow
a power-law.
</p>
<p>In ecology the Pareto distribution can be used to describe the distribution
of abundances among species in a biological assemblage
(a.k.a. biological community) or in a sample taken from such an
assemblage. Though much less used than the lognormal to fit SADs, it can fit better the extremities
of the empirical distributions to which the lognormal applies (Johnson et al. 1995, p.608).
</p>


<h3>Value</h3>

<p><code>dpareto</code> gives the (log) density, <code>ppareto</code> gives the (log)
distribution function, <code>qpareto</code> gives the quantile function.
</p>
<p>Invalid values for parameters <code>shape</code> or <code>scale</code> will result in return
values <code>NaN</code>, with a warning.
</p>


<h3>Note</h3>

<p>These functions implement the Pareto distribution of the first kind sensu
Johnson et al. (1995, pp.574).
</p>
<p>The pdf and cdf are defined as zero for all <code>x &lt; scale</code>, but the
functions <code>[dp]pareto</code> currently return an error if <code>scale &gt; min(x)</code>, to avoid some
fitting and plotting problems.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>Johnson, N.L., Kotz, S. and Balakrishnan, N. 1995. <em>Continuous
Univariate Distributions</em>, volume 2, chapter 20.  Wiley, New York.
</p>


<h3>See Also</h3>

<p><code>Pareto</code> in packages <span class="pkg">VGAM</span> and <span class="pkg">actuar</span> for more general
and flexible implementations; <code><a href="#topic+fitpareto">fitpareto</a></code> for maximum
likelihood estimation in the context of species abundance
distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mfrow=c(1,2))
curve(dpareto(x, shape=3, scale=1), 1,8, ylab="Density",
      main="Pareto PDF")
curve(ppareto(x, shape=3, scale=1), 1,8, ylab="Probability",
      main="Pareto CDF")
par(mfrow=c(1,1))


## Quantile is the inverse function of probability:
p.123 &lt;-ppareto(1:3,shape=3,scale=0.99) 
all.equal(qpareto(p.123, shape=3, scale=0.99), 1:3) 
</code></pre>

<hr>
<h2 id='dpoig'>Compound Poisson-gamma distribution</h2><span id='topic+dpoig'></span><span id='topic+ppoig'></span><span id='topic+qpoig'></span><span id='topic+rpoig'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
for the Poisson-gamma compound probability distribution with
parameters <code>frac</code>, <code>rate</code> and <code>rate</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpoig(x, frac, rate, shape, log=FALSE)
ppoig(q, frac, rate, shape, lower.tail=TRUE, log.p=FALSE)
qpoig(p, frac, rate, shape, lower.tail=TRUE, log.p=FALSE)
rpoig(n, frac, rate, shape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dpoig_+3A_x">x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, this is a vector of abundances 
of species in a sample.
</p>
</td></tr>
<tr><td><code id="dpoig_+3A_q">q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, a vector of abundances of species in a sample.
</p>
</td></tr>
<tr><td><code id="dpoig_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dpoig_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dpoig_+3A_frac">frac</code></td>
<td>

<p>single numeric '0&lt;frac&lt;=1'; fraction of the population or community sampled (see details)
</p>
</td></tr>
<tr><td><code id="dpoig_+3A_rate">rate</code></td>
<td>

<p>vector of (non-negative) rates of the gamma distribution of the
sampled population (see details). Must be strictly positive.
</p>
</td></tr>
<tr><td><code id="dpoig_+3A_shape">shape</code></td>
<td>

<p>the shape parameter of the gamma distribution of the
sampled population (see details).  Must be positive.
</p>
</td></tr>
<tr><td><code id="dpoig_+3A_log">log</code>, <code id="dpoig_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p)
</p>
</td></tr>
<tr><td><code id="dpoig_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A compound Poisson-gamma distribution is a Poisson probability distribution
where its single parameter, the process mean rate, is frac*n, at which n
is a random variable with gamma distribution. The density function
is given by Green &amp; Plotkin (2007).
</p>
<p>In ecology, this distribution gives the probability that a species has
an abundance of x individuals in a random sample of a fraction frac of
the community. In the community the species abundances are independent
random variables that follow a gamma density function.
</p>
<p>Hence, a Poisson-gamma distribution is a model for species
abundances distributions (SAD) under the assumptions: (a) species
abundances in the community are independent identically distributed
gamma variables, (b) sampling is a Poisson process with expected
value frac*n, (c) the sampling is done with replacement, or the fraction
sampled is small enough to approximate a sample with replacement.
</p>
<p>The Poisson-gamma distribution is also known as the Negative Binomial
distribution. The function dpoig is provided to express the Negative
Binomial explicitly as a compound distribution.
The Fisher log-series (Fisher 1943) is a limiting case
where the dispersion parameter of the Negative Binomial tends to zero.
As in the case of the Poisson-exponential, the user should not fit to 
the Poisson-gamma directly, and should use instead the <code>fitls</code> function.
</p>


<h3>Value</h3>

<p>(log) density of the (zero-truncated) density
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Cristiano Strieder and Andre Chalom.</p>


<h3>References</h3>

<p>Fisher, R.A, Corbert, A.S. and Williams, C.B. (1943) The Relation
between the number of species and the number of individuals in a
random sample of an animal population. <em>The Journal of Animal
Ecology, 12</em>:42&ndash;58. 
</p>
<p>Green,J. and Plotkin, J.B. 2007 A statistical theory for sampling
species abundances. <em>Ecology Letters 10</em>:1037&ndash;1045
</p>
<p>Pielou, E.C. 1977. <em>Mathematical Ecology</em>. New York: John Wiley
and Sons.
</p>


<h3>See Also</h3>

<p>dgamma, dpois, dnbinom for related distributions, dpoix for the special case of Poisson-exponential
</p>

<hr>
<h2 id='dpoilog'>Poisson-lognormal distribution
</h2><span id='topic+dpoilog'></span><span id='topic+ppoilog'></span><span id='topic+qpoilog'></span><span id='topic+rpoilog'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
Poisson-lognormal distribution with parameters <code>mu</code> and <code>sigma</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpoilog( x, mu, sig, log=FALSE)
ppoilog( q, mu, sig, lower.tail=TRUE, log.p=FALSE)
qpoilog( p, mu, sig, lower.tail = TRUE, log.p = FALSE)
rpoilog( n, mu, sig)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dpoilog_+3A_x">x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. Usually a vector of abundances of species in a sample.
</p>
</td></tr>
<tr><td><code id="dpoilog_+3A_q">q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. Usually a vector of
abundances of species in a sample.
</p>
</td></tr>
<tr><td><code id="dpoilog_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dpoilog_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dpoilog_+3A_mu">mu</code>, <code id="dpoilog_+3A_sig">sig</code></td>
<td>

<p>parameters of the compounding lognormal distribution (see details).
</p>
</td></tr>
<tr><td><code id="dpoilog_+3A_log">log</code>, <code id="dpoilog_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
<tr><td><code id="dpoilog_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A compound Poisson-lognormal distribution is a Poisson probability distribution
where its single parameter lambda is a random variable with lognormal distribution. 
The density function is 
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{e^{x \mu + x^2 \sigma/2} (2 \pi \sigma)^{-1/2}}{x!}
  \, g(y)</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">g(y) = \int_{-\infty}^\infty  \, e^{-e^y} \frac{e^{(-y-\mu-x
	  \sigma)^2}}{2 \sigma}  \, dy</code>
</p>

<p>(Bulmer 1974 eq.5). For x = 0, 1, 2, ... .
</p>
<p>In ecology, this distribution gives the probability that a species has
an abundance of x individuals in a random sample of a fraction 'f' of the
community. In the community, the species abundances are independent
random variables that follow a lognormal density function, with
parameters (mu + ln(f), sigma) (Engen et al. 2002).
</p>
<p>Hence, a Poisson-lognormal distribution is a model for species
abundances distributions (SAD) in a sample taken from a community
under the assumptions: (a) species
abundances in the community are independent identically distributed
lognormal variables, (b) sampling is a Poisson process with expected
value E[x]= f*n where n is the abundance in the community and f the
fraction of individuals sampled, (c) individuals are sampled with replacement, or the
fraction of total individuals sampled is small enough to approximate a
sample with replacement. See Engen (1977) and Alonso et al. (2008) for critical evaluations.
</p>


<h3>Value</h3>

<p>'dpoilog' gives the (log) density of the density, 'ppoilog' gives the (log)
distribution function, 'qpoilog' gives the quantile function.
</p>


<h3>Author(s)</h3>

<p>Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Andre Chalom and Murilo Dantas Miranda
</p>


<h3>Source</h3>

<p>These functions were built from <code>dpoilog</code> function from <span class="pkg">poilog</span>
package (Vidar Grøtan and Steinar Engen).
</p>
<p><code>dpoilog</code> is just a wrapper of <code>poilog::dpoilog</code> with an additional <code>log</code> argument.
</p>
<p><code>ppoilog</code> does the cumulative sum of <code>poilog::dpoilog</code>.
</p>
<p><code>qpoilog</code> uses modified bisection method to find numerically quantiles using
<code>ppoilog</code>.
</p>
<p><code>rpoilog</code> selects random values from a poilog distribution. It is unrelated to the 
function of the same name in <span class="pkg">poilog</span>.
</p>


<h3>References</h3>

<p>Alonso, D. and Ostling, A., and Etienne, R. S. 2008 The implicit
assumption of symmetry and the species abundance
distribution. <em>Ecology Letters, 11</em>: 93-105.
</p>
<p>Bulmer,M. G. 1974. On Fitting the Poisson Lognormal Distribution to
Species-Abundance Data. <em>Biometrics, 30</em>: 101-110.
</p>
<p>Grøtan V. and Engen S. 2008. poilog: Poisson lognormal and
bivariate Poisson lognormal distribution. R package version 0.4.
</p>
<p>Engen, S. 1977. Comments on two different approaches to the analysis
of species frequency data. <em>Biometrics, 33</em>: 205-213.
</p>
<p>Engen, S., R. Lande, T. Walla &amp; P. J. DeVries. 2002. Analyzing spatial
structure of communities using the two-dimensional Poisson lognormal
species abundance model. <em>American Naturalist 160</em>: 60-73.
</p>


<h3>See Also</h3>

<p>dpois, dlnorm; dpoilog and rpoilog in <span class="pkg">poilog</span> package; <code><a href="#topic+rsad">rsad</a></code> for random
generation, <code><a href="#topic+fitpoilog">fitpoilog</a></code> for maximum likelihood estimation.
</p>

<hr>
<h2 id='dpoix'>Compound Poisson-Exponential distribution
</h2><span id='topic+dpoix'></span><span id='topic+ppoix'></span><span id='topic+qpoix'></span><span id='topic+rpoix'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation
for the Poisson-exponential compound probability distribution
with parameters <code>fraction</code> and <code>rate</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpoix(x, frac, rate, log=FALSE)
ppoix(q, frac, rate, lower.tail=TRUE, log.p=FALSE)
qpoix(p, frac, rate, lower.tail=TRUE, log.p=FALSE)
rpoix(n, frac, rate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dpoix_+3A_x">x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, this is a vector of abundances 
of species in a sample.
</p>
</td></tr>
<tr><td><code id="dpoix_+3A_q">q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, a vector of abundances of species in a sample.
</p>
</td></tr>
<tr><td><code id="dpoix_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dpoix_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dpoix_+3A_frac">frac</code></td>
<td>

<p>single numeric 0 &lt; frac &lt;= 1; fraction of the population or community sampled (see details).
</p>
</td></tr>
<tr><td><code id="dpoix_+3A_rate">rate</code></td>
<td>

<p>vector of (non-negative) rates of the exponential distribution of the
sampled population (see details).
</p>
</td></tr>
<tr><td><code id="dpoix_+3A_log">log</code>, <code id="dpoix_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p)
</p>
</td></tr>
<tr><td><code id="dpoix_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A compound Poisson-exponential distribution is a Poisson probability distribution
where its single parameter lambda, is frac*n, at which n
is a random variable with exponential distribution. Thus, the expected
value and variance are E[X] = Var[X] = frac*n . The density function is
</p>
<p>p(y) = rate*frac^y / (frac + rate)^(y+1)
</p>
<p>for x = 0, 1, 2, ... (Green &amp; Plotkin 2007) In ecology, this
distribution gives the probability that a species has
an abundance of x individuals in a random sample of a fraction <code>frac</code>
of the community. In the community the species abundances are
independent random variables that follow an exponential density
function.  
</p>
<p>Hence, a Poisson-exponential distribution is a model for species
abundances distributions (SAD) in a sample taken from a community under the assumptions: (a) species
abundances in the community are independent identically distributed
exponential variables, (b) sampling is a Poisson process with expected
value 'frac*n', (c) individuals are sampled with replacement, or the
fraction of total individuals sampled is small enough to approximate a
sample with replacement. See Engen (1977) and Alonso et al. (2008) for critic evaluations.
</p>
<p>Notice that the Poisson-exponential can be seen as a different form for the
MacArthur's Broken stick model (Baczkowski, 2000), so instead of fitting to a 
Poisson-exponential distribution directly, the user should use <code>fitbs</code>.
</p>


<h3>Value</h3>

<p>(log) density of the (zero-truncated) density.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Cristiano Strieder and Andre Chalom.</p>


<h3>References</h3>

<p>Alonso, D. and Ostling, A., and Etienne, R.S. 2008. The implicit
assumption of symmetry and the species abundance
distribution. <em>Ecology Letters, 11</em>: 93&ndash;105.
</p>
<p>Engen, S. 1977. Comments on two different approaches to the analysis
of species frequency data. <em>Biometrics, 33</em>: 205&ndash;213.
</p>
<p>Pielou, E.C. 1977. <em>Mathematical Ecology</em>. New York: John Wiley
and Sons.
</p>
<p>Green,J. and Plotkin, J.B. 2007 A statistical theory for sampling
species abundances. <em>Ecology Letters 10</em>:1037&ndash;1045 
</p>


<h3>See Also</h3>

<p>dexp, dpois for related distributions, dpoig for the general case of the Poisson-Gamma distribution
</p>

<hr>
<h2 id='dpowbend'>Puyeo's Power-bend discrete distribution
</h2><span id='topic+dpowbend'></span><span id='topic+ppowbend'></span><span id='topic+qpowbend'></span><span id='topic+rpowbend'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for discrete
version of Pueyo's power-bend distribution with parameters <code>s</code> and <code>omega</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpowbend( x, s, omega = 0.01, oM = -log(omega), log=FALSE)
ppowbend ( q, s, omega = 0.01, oM = -log(omega), lower.tail=TRUE, log.p=FALSE)
qpowbend( p, s, omega = 0.01, oM = -log(omega), lower.tail= TRUE, log.p=FALSE)
rpowbend( n, s, omega)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dpowbend_+3A_x">x</code></td>
<td>

<p>vector of (integer x&gt;0) quantiles. In the context of
species abundance distributions, this is a vector of abundances of
species in a sample. 
</p>
</td></tr>
<tr><td><code id="dpowbend_+3A_q">q</code></td>
<td>
<p>vector of (integer x&gt;0) quantiles. In the context of
species abundance distributions, a vector of
abundances of species in a sample.
</p>
</td></tr>
<tr><td><code id="dpowbend_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dpowbend_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dpowbend_+3A_s">s</code></td>
<td>

<p>positive real s &gt; 1; exponent of the power-bend distribution.
</p>
</td></tr>
<tr><td><code id="dpowbend_+3A_omega">omega</code></td>
<td>

<p>positive real greater than 0; bending parameter of the distribution. 
The current implementation only accepts omega smaller than 5.
</p>
</td></tr>
<tr><td><code id="dpowbend_+3A_om">oM</code></td>
<td>

<p>real number; alternative parametrization which is used for faster fitting on the 
<code><a href="#topic+fitpowbend">fitpowbend</a></code> function. The current implementation only accepts oM
greater than approximately -1.5. You can specify either 'omega' or 'oM', but not both.
</p>
</td></tr>
<tr><td><code id="dpowbend_+3A_log">log</code>, <code id="dpowbend_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
<tr><td><code id="dpowbend_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power-bend density is a discrete probability distribution based on the
power probability density with an added term for &ldquo;bending&rdquo;, defined for
integer x &gt; 0:
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{x^{-s} e^{- \omega x}}{Li_s (e^\omega)}</code>
</p>

<p>The bending term can be seen as a finite-size correction of the power law
(Pueyo 2006). Therefore, the power-bend can describe better samples taken from power-law distributions.
</p>
<p>The function <code class="reqn">Li_s(e^\omega)</code> is the Polylogarithm of the 
exponential of <code>omega</code> on base <code>s</code>, and represents the integration constant.
A naive implementation of the Polylogarithm function is included in the package, and
accepts values for non-integer <code>s</code> and <code>omega</code> smaller than 5, which cover the
cases of biological relevance.
</p>
<p>This distribution was proposed by S. Pueyo to describe species
abundance distributions (sads) as a generalization of the
logseries distribution. Fisher's logseries correspond to the
power-bend with parameters s=1 and
<code class="reqn">\omega = - \log(\frac{N}{N + \alpha})</code>
where N is sample size or total number of individuals and <code class="reqn">alpha</code> is the
Fisher's alpha parameter of the logseries.
</p>
<p>When fitted to sads, power-law distributions usually overestimates the abundance of common
species, and in practice power-bend corrects this problem and usually
provides a better fit to abundance distributions.
</p>


<h3>Value</h3>

<p><code>dpowbend</code> gives the (log) density of the function, <code>ppowbend</code> gives the (log)
distribution function, <code>qpowbend</code> gives the quantile function.
</p>
<p>Invalid values for parameter <code>s</code> or <code>omega</code> will result in return
values <code>NaN</code>, with a warning. Note that integer values of <code>s</code> and 
<code>omega</code> values larger than 5 are currently not supported, and will also
return <code>NaN</code>.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Andre Chalom.</p>


<h3>References</h3>

<p>Pueyo, S. (2006) <em>Diversity: Between neutrality and structure</em>,
Oikos 112: 392-405. 
</p>


<h3>See Also</h3>

<p><code>dpower</code> for the power distribution; <code><a href="#topic+dls">dls</a></code> for the
logseries distribution, which is a particular case of the power-bend,
<code><a href="#topic+fitpowbend">fitpowbend</a></code> for maximum likelihood estimation in
the context of species abundance distributions. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:20
PDF &lt;- dpowbend(x=x, s=2.1, omega=0.5)
CDF &lt;- ppowbend(q=x, s=2.1, omega=0.5)
par(mfrow=c(1,2))
plot(x,CDF, ylab="Cumulative Probability", type="b",
     main="Powerbend distribution, CDF")
plot(x,PDF, ylab="Probability", type="h",
     main="Powerbend distribution, PDF")
par(mfrow=c(1,1))

## The powbend distribution is a discrete PDF, hence:
all.equal( ppowbend(10, s=2.1, omega=0.5), sum(dpowbend(1:10, s=2.1, omega=0.5)) ) # should be TRUE

## quantile is the inverse of CDF
all.equal(qpowbend(CDF, s=2.1, omega=0.5), x)

## Equivalence between power-bend and logseries
x &lt;- 1:100
N &lt;- 1000
alpha &lt;- 5
X &lt;- N/(N+alpha)
omega &lt;- -log(X)
PDF1 &lt;- dls(x, N, alpha)
PDF2 &lt;- dpowbend(x, s=1, omega)
plot(PDF1,PDF2, log="xy")
abline(0,1, col="blue")
</code></pre>

<hr>
<h2 id='dpower'>Power discrete distribution
</h2><span id='topic+dpower'></span><span id='topic+ppower'></span><span id='topic+qpower'></span><span id='topic+rpower'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for discrete
version of power distribution with parameter <code>s</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpower( x, s, log=FALSE)
ppower( q, s, lower.tail=TRUE, log.p=FALSE)
qpower( p, s, lower.tail= TRUE, log.p=FALSE)
rpower( n, s, bissection = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dpower_+3A_x">x</code></td>
<td>

<p>vector of (integer x&gt;0) quantiles. In the context of
species abundance distributions, this is a vector of abundances of
species in a sample. 
</p>
</td></tr>
<tr><td><code id="dpower_+3A_q">q</code></td>
<td>
<p>vector of (integer x&gt;0) quantiles. In the context of
species abundance distributions, a vector of
abundances of species in a sample.
</p>
</td></tr>
<tr><td><code id="dpower_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dpower_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dpower_+3A_s">s</code></td>
<td>

<p>positive real s &gt; 1; exponent of the power distribution.
</p>
</td></tr>
<tr><td><code id="dpower_+3A_log">log</code>, <code id="dpower_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
<tr><td><code id="dpower_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
<tr><td><code id="dpower_+3A_bissection">bissection</code></td>
<td>

<p>logical; uses the bissection method to generate random numbers? If
FALSE calls <code>poweRlaw::rpldis</code>, which provides a faster, continuous
approximation for large numbers (Gilliespie 2015). 
</p>
</td></tr>
<tr><td><code id="dpower_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>poweRlaw::rpldis</code>
when <code>bissection = TRUE</code></p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The power density is a discrete probability distribution defined for
integer x &gt; 0:
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{x^{-s}}{\zeta (s)}</code>
</p>

<p>Hence p(x) is proportional to a
negative power of 'x', given by the 's' exponent. The Riemann's <code class="reqn">\zeta</code>
function is the integration constant.
</p>
<p>The power distribution can be used as a species abundance distribution (sad) model, which
describes the probability of the abundance 'x' of a given species in a
sample or assemblage of species.
</p>


<h3>Value</h3>

<p><code>dpower</code> gives the (log) density of the density, <code>ppower</code> gives the (log)
distribution function, <code>qpower</code> gives the quantile function.
</p>
<p>Invalid values for parameter <code>s</code> will result in return
values <code>NaN</code>, with a warning.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>Johnson N. L., Kemp, A. W. and Kotz S. (2005) <em>Univariate Discrete
Distributions</em>, 3rd edition, Hoboken, New Jersey: Wiley. Section
11.2.20.
</p>
<p>Colin S. Gillespie (2015) Fitting Heavy Tailed Distributions: The
poweRlaw Package. <em>Journal of Statistical Software, 64(2)</em>, 1-16. URL
http://www.jstatsoft.org/v64/i02/.
</p>


<h3>See Also</h3>

<p><code>dzeta</code> in <span class="pkg">VGAM</span> package; <span class="pkg">poweRlaw</span> package;
<code><a href="#topic+fitpower">fitpower</a></code> for maximum likelihood estimation in the context of species abundance distributions. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:20
PDF &lt;- dpower(x=x, s=2)
CDF &lt;- ppower(q=x, s=2)
par(mfrow=c(1,2))
plot(x,CDF, ylab="Cumulative Probability", type="b",
     main="Power distribution, CDF")
plot(x,PDF, ylab="Probability", type="h",
     main="Power distribution, PDF")
par(mfrow=c(1,1))

## The power distribution is a discrete PDF, hence:
all.equal( ppower(10, s=2), sum(dpower(1:10, s=2)) ) # should be TRUE

## quantile is the inverse of CDF
all.equal(qpower(CDF, s=2), x) 

</code></pre>

<hr>
<h2 id='dtrunc'>Left-truncation of density, probability and quantile of distributions</h2><span id='topic+dtrunc'></span><span id='topic+ptrunc'></span><span id='topic+qtrunc'></span><span id='topic+rtrunc'></span>

<h3>Description</h3>

<p>Returns density, probability, quantile values and random generation for
distribution functions left-truncated at a specified value.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtrunc(f, x, trunc, coef, log = FALSE)
ptrunc(f, q, trunc, coef, lower.tail=TRUE, log.p=FALSE)
qtrunc(f, p, trunc, coef, lower.tail = TRUE, log.p = FALSE)
rtrunc(f, n, trunc, coef, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dtrunc_+3A_f">f</code></td>
<td>

<p>character;
root name of the density or distribution function to be truncated
- e.g., <kbd>"lnorm"</kbd> for the lognormal distribution; <kbd>"geom"</kbd> for the geometric distribution.
</p>
</td></tr>
<tr><td><code id="dtrunc_+3A_x">x</code>, <code id="dtrunc_+3A_q">q</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="dtrunc_+3A_trunc">trunc</code></td>
<td>

<p>numeric, <code>trunc &gt; min(x)</code>. Truncation value (see details).
</p>
</td></tr>
<tr><td><code id="dtrunc_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dtrunc_+3A_n">n</code></td>
<td>

<p>number of random values to return.
</p>
</td></tr>
<tr><td><code id="dtrunc_+3A_coef">coef</code></td>
<td>

<p>numeric named list; parameters values of the density or
distribution function, named accordingly (see details). 
</p>
</td></tr>
<tr><td><code id="dtrunc_+3A_log">log</code>, <code id="dtrunc_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p). 
</p>
</td></tr>
<tr><td><code id="dtrunc_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
<tr><td><code id="dtrunc_+3A_...">...</code></td>
<td>
<p>in <code>rtrunc</code> further arguments to
be passed to <code>poweRlaw::rpldis</code> when argument argument
<code>f = "power"</code> and argument <code>bissection = FALSE</code>. The same for
<code>rpower</code> when and argument <code>bissection = FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a distribution with probability distribution function (PDF) g
and cumulative distribution function (CDF) G, a random variable
<code>x</code> with these distributions left-truncated at <code>trunc</code> has
its PDF:
</p>
<p>g'(x) = g(x)/(1 - G(trunc)) for any x &lt;= trunc and zero otherwise 
</p>
<p>and CDF:
</p>
<p>G'(x) = (G(max(x,trunc)) - G(trunc)) / (1 - G(trunc))
</p>
<p><code>dtrunc</code> and <code>ptrunc</code> calculates the left-truncated
distributions functions
g'(x) and G'(x) defined above for
a vector of values <code>x</code> from any
standard distribution function available in R.
This means the 'upper tail' of a continuous distribution
is rescaled to integrate to one.
Accordingly, for discrete distributions, the probabilities
for all <code>x</code>&gt;trunc are rescaled to sum one.
<code>qtrunc</code> is the inverse function of <code>ptrunc</code>.
</p>
<p>Left-truncated distributions can be used to
describe the species abundance distributions (SADs),
specially for continuous distributions
(e.g., truncated lognormal distribution).
</p>


<h3>Value</h3>

<p><code>dtrunc</code> gives the (log) density defined by <code>f</code> left-truncated at <code>trunc</code>.
<code>ptrunc</code> gives the (log) distribution function defined by
<code>f</code> left-truncated at <code>trunc</code>.
<code>qtrunc</code> gives the quantile of the density defined by <code>f</code> left-truncated at <code>trunc</code>.
<code>rtrunc</code> generates a sample from the density defined by <code>f</code> left-truncated at <code>trunc</code>.
</p>


<h3>Source</h3>

<p>Codes from Nadarajah and Kotz (2006),
which provide a more generic solution
for left and right truncation.
</p>


<h3>References</h3>

<p>Nadarajah, S. and Kotz, S. 2006. R Programs for Computing Truncated
Distributions. <em>Journal of Statistical Software 16</em>:Code Snippet 2.
</p>


<h3>See Also</h3>

<p>Distributions for standard distributions in R;
many functions in package <span class="pkg">sads</span> have an argument <code>trunc</code> that
allows to simulate and fit truncated
distributions
for species abundance distributions (e.g., <code><a href="#topic+fitsad">fitsad</a></code>
<code><a href="#topic+rsad">rsad</a></code>, <code><a href="#topic+radpred">radpred</a></code>, <code><a href="#topic+octavpred">octavpred</a></code>.
Package 'VGAM' has truncated versions of many standard functions;
see <code>Truncate-methods</code> in package <span class="pkg">distr</span> for  general
methods to build R objects of truncated distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A &lt;- dtrunc("lnorm", x = 1:5, trunc = 0.5,
       coef = list( meanlog=1, sdlog=1.5 ) )
## same as
B &lt;- dlnorm( 1:5 , meanlog = 1, sdlog = 1.5 ) /
  ( plnorm ( 0.5 , meanlog = 1, sdlog = 1.5, lower = FALSE))
## checking
identical( A, B )

A &lt;- ptrunc("pois", q = 1:5, trunc = 0,
       coef = list( lambda = 1.5 ) )
## same as
B &lt;- (ppois( 1:5 , lambda = 1.5 ) -
      ppois(0 , lambda = 1.5 ) ) /
  (ppois(0 , lambda = 1.5, lower = FALSE))
## checking
identical(A,B)

# Random generation
rtrunc("ls", 100, coef=list(N=1000, alpha=50), trunc=5)
</code></pre>

<hr>
<h2 id='dvolkov'>Neutral Biodiversity Theory distribution by Volkov <em>et al.</em> </h2><span id='topic+dvolkov'></span><span id='topic+pvolkov'></span><span id='topic+qvolkov'></span><span id='topic+rvolkov'></span><span id='topic+Svolkov'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation
for species abundances distribution in a neutral community with
immigration as deduced by Volkov et al. (2003).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dvolkov( x, theta, m, J, order=96, log = FALSE )
pvolkov( q, theta, m , J, lower.tail = TRUE, log.p = FALSE )
qvolkov( p, theta, m, J, lower.tail = TRUE, log.p = FALSE )
rvolkov( n, theta, m, J)
Svolkov( theta, m, J, order=96)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dvolkov_+3A_x">x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, this is a
vector of abundance of species in a sample.
</p>
</td></tr>
<tr><td><code id="dvolkov_+3A_q">q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, a vector of abundance of species in a sample.
</p>
</td></tr>
<tr><td><code id="dvolkov_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dvolkov_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dvolkov_+3A_theta">theta</code></td>
<td>

<p>positive real, theta &gt; 0; Hubbell's &lsquo;fundamental biodiversity number&rsquo;.
</p>
</td></tr>
<tr><td><code id="dvolkov_+3A_order">order</code></td>
<td>

<p>order of the approximation for the numerical integration. The default of 96
usually gives a rounding error of 1e-8 for moderate dataset; 
orders greater than 128 are probably overkill
</p>
</td></tr>
<tr><td><code id="dvolkov_+3A_m">m</code></td>
<td>

<p>positive real, 0 &lt;= m &lt;= 1; immigration rate (see details).
</p>
</td></tr>
<tr><td><code id="dvolkov_+3A_j">J</code></td>
<td>

<p>positive integer; sample size.  In the context of
species abundance distributions, usually the number of individuals in a sample.
</p>
</td></tr>
<tr><td><code id="dvolkov_+3A_log">log</code>, <code id="dvolkov_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
<tr><td><code id="dvolkov_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Volkov <em>et al</em> (2003) proposed one of the analytic solutions for the
species abundance distributions (SADs)
for The Neutral Theory of Biodiversity (Hubbell 2001).
</p>
<p>Their solution is deduced from a model of stochastic dynamics of a
set of species where the following rules apply:
(1) replacement of a dead individual by local offspring &ndash; with probability 1-m,
individuals picked at random
are replaced by the offspring of other individuals picked at random;
(2) replacement of a dead individual by an immigrant &ndash;
with probability m individuals picked at random
are replaced by immigrants taken at random from a pool
of potential colonizers (the metacommunity).
</p>
<p>Volkov et al. (2003, eq.7) provide the stationary solution for
the expected number
of species with a given abundance.
A probability density function is easily calculated by taking
these expected values for abundances 1:J and dividing them
by the total number of
species.
<code>dvolkov</code> performs the numerical integration of the 
density function by means of Gaussian quadrature, using a
library by Pavel Holoborodko (http://www.holoborodko.com/pavel/?page_id=679).
The code is based on the <code>untb::volkov</code> function (Hankin 2007).
<code>pvolkov</code> provides CDF by
cumulative sum of density values, and <code>qvolkov</code> use
a numeric interpolation with a step function (<code>approxfun</code>)
to find quantiles.
Calculations can be slow for larger datasets.
</p>
<p>A special function Svolkov is provided to estimate the expected community size from a Volkov distribution with parameters theta, m and J, but this function is deprecated. A more comprehensive function to estimate community sizes will be developed in the future.
</p>


<h3>Value</h3>

<p><code>dvolkov</code> gives the (log) density of the density, <code>pvolkov</code> gives the (log)
distribution function, <code>qvolkov</code> gives the (log) the quantile function.
</p>
<p>Invalid values for parameters <code>J</code> or <code>theta</code> will result in return
values <code>NaN</code>, with a warning.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Andre Chalom and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>Hankin, R.K.S. 2007. Introducing untb, an <span class="rlang"><b>R</b></span> Package For Simulating Ecological Drift
Under the Unified Neutral Theory of Biodiversity. <em>Journal of Statistical Software 22</em> (12). 
</p>
<p>Hubbell, S. P.  2001.  <em>The Unified Neutral Theory of Biodiversity</em>.
Princeton University Press.
</p>
<p>Volkov, I.,  Banavar, J.R., Hubbell, S.P., Maritan, A. 2003.
Neutral theory and relative species abundance in ecology.
<em>Nature 424</em>:1035&ndash;1037
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitvolkov">fitvolkov</a></code> for maximum likelihood fit,
<code><a href="#topic+dmzsm">dmzsm</a></code> for the distribution of abundances in the metacommunity,
<code>volkov</code> in package <span class="pkg">untb</span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Volkov et al 2003 fig 1
## But without Preston correction to binning method
## and only the line of expected values by Volkov's model
data( bci )
bci.oct &lt;- octav( bci, preston = FALSE )
plot( bci.oct )
CDF &lt;- pvolkov( bci.oct$upper, theta = 47.226, m = 0.1, J = sum(bci) )
bci.exp &lt;- diff( c(0,CDF) ) * length(bci)
midpoints &lt;- as.numeric( as.character( bci.oct$octave ) ) - 0.5
lines( midpoints, bci.exp, type="b" )

## the same with Preston binning using octavpred
plot(octav( bci, preston = TRUE ))
bci.exp2 &lt;- octavpred( bci, sad = "volkov",
                      coef = list(theta = 47.226, m = 0.1, J=sum(bci)), preston=TRUE)
lines( bci.exp2 )

</code></pre>

<hr>
<h2 id='dzipf'>Zipf distribution</h2><span id='topic+dzipf'></span><span id='topic+pzipf'></span><span id='topic+qzipf'></span><span id='topic+rzipf'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
Zipf distribution with parameters <code>N</code> and <code>s</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dzipf( x, N, s, log=FALSE)
pzipf( q, N, s, lower.tail=TRUE, log.p=FALSE)
qzipf( p, N, s, lower.tail = TRUE, log.p = FALSE)
rzipf( n, N, s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dzipf_+3A_x">x</code></td>
<td>

<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, this is a vector of abundance ranks of species in a sample.
</p>
</td></tr>
<tr><td><code id="dzipf_+3A_q">q</code></td>
<td>
<p>vector of (non-negative integer) quantiles. In the context of
species abundance distributions, a vector of abundance ranks of species in a sample.
</p>
</td></tr>
<tr><td><code id="dzipf_+3A_n">n</code></td>
<td>
<p>number of random values to return.</p>
</td></tr>
<tr><td><code id="dzipf_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="dzipf_+3A_n">N</code></td>
<td>

<p>positive integer 0 &lt; N &lt; Inf, total number of elements of a collection. In the context of
species abundance distributions, usually the number of species in a sample.
</p>
</td></tr>
<tr><td><code id="dzipf_+3A_s">s</code></td>
<td>

<p>positive real s &gt; 0; Zipf's exponent
</p>
</td></tr>
<tr><td><code id="dzipf_+3A_log">log</code>, <code id="dzipf_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
<tr><td><code id="dzipf_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Zipf distribution describes the probability or frequency of occurrence
of a given element from a set of <code>N</code> elements. According to Zipf's
law, this probability  is inversely proportional to a power <code>s</code> of the frequency
rank of the element in the set. The density function is
</p>
<p style="text-align: center;"><code class="reqn">p(x) = \frac{x^{-s}}{\sum_{i=1}^N i^{-s}}</code>
</p>

<p>Since p(x) is proportional to a power of <code>x</code>, the Zipf distribution is a
power distribution. The Zeta distribution is a special case at the limit
N -&gt; Inf.
</p>
<p>The Zipf distribution has a wide range of applications (Li 2011). One
of its best known applications is describing the probability
of occurrence of a given word that has a ranking <code>x</code> in a <em>corpus</em> with a total of <code>N</code>
words. It can also be used to describe the probability of the
abundance rank of a given species in a sample or assemblage of <code>N</code> species.
</p>


<h3>Value</h3>

<p><code>dzipf</code> gives the (log) density, <code>pzipf</code> gives the (log)
distribution function, <code>qzipf</code> gives the quantile function.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>Johnson N. L., Kemp, A. W. and Kotz S. (2005) <em>Univariate Discrete
Distributions</em>, 3rd edition, Hoboken, New Jersey: Wiley. Section
11.2.20. 
</p>
<p>Li, W. (2002) Zipf's Law everywhere. <em>Glottometrics</em> 5:14-21
</p>
<p>Zipf's Law. <a href="https://en.wikipedia.org/wiki/Zipf's_law">https://en.wikipedia.org/wiki/Zipf's_law</a>.
</p>


<h3>See Also</h3>

<p><code>dzipf</code> and <code>rzipf</code> and related functions in <span class="pkg">zipfR</span> package; <code>Zeta</code> for
zeta distribution in <span class="pkg">VGAM</span> package. <code><a href="#topic+fitzipf">fitzipf</a></code> to fit
Zipf distribution as a rank-abundance model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:20
PDF &lt;- dzipf(x=x, N=100, s=2)
CDF &lt;- pzipf(q=x, N=100, s=2)
par(mfrow=c(1,2))
plot(x,CDF, ylab="Cumulative Probability", type="b",
     main="Zipf distribution, CDF")
plot(x,PDF, ylab="Probability", type="h",
     main="Zipf distribution, PDF")
par(mfrow=c(1,1))

## quantile is the inverse of CDF
all.equal( qzipf(CDF, N=100, s=2), x) # should be TRUE

## Zipf distribution is discrete hence
all.equal( sum(dzipf(1:10, N=10, s=2)), pzipf(10, N=10, s=2)) # should be TRUE
</code></pre>

<hr>
<h2 id='fitrad'>ML fitting of species rank-abundance distributions</h2><span id='topic+fitrad'></span><span id='topic+fitgs'></span><span id='topic+fitmand'></span><span id='topic+fitrbs'></span><span id='topic+fitzipf'></span>

<h3>Description</h3>

<p>Fits probability distributions for abundance ranks
of species in a sample or assemblage by maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitrad(x, rad =c("gs", "mand", "rbs", "zipf"), ...)
fitgs(x, trunc, start.value, ...)
fitmand(x, trunc, start.value, ...)
fitrbs(x, trunc, ...)
fitzipf(x, N, trunc, start.value, upper = 20, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitrad_+3A_x">x</code></td>
<td>
<p>vector of (positive integer) quantiles or an object of
<code><a href="#topic+rad-class">rad-class</a></code>. 
In the context of
rads, the numerical vector contains abundances of species in a sample or ecological
assemblage according to their abundance. The <code><a href="#topic+rad-class">rad-class</a></code> object
contains ranked abundances of species in a sample or ecological
assemblage.
</p>
</td></tr>
<tr><td><code id="fitrad_+3A_rad">rad</code></td>
<td>

<p>character; root name of community rad distribution to be fitted.
<kbd>"gs"</kbd> for geometric series (not geometric distribution,
<code><a href="stats.html#topic+dgeom">dgeom</a></code>),
<kbd>"mand"</kbd> for Zipf-Mandelbrodt distribution,
<kbd>"rbs"</kbd> for MacArthur's Broken-stick distribution,
<kbd>"zipf"</kbd> for Zipf distribution.
</p>
</td></tr>
<tr><td><code id="fitrad_+3A_trunc">trunc</code></td>
<td>

<p>non-negative integer, <code>trunc &gt; min(x)</code>; truncation point to fit a
truncated distribution.
</p>
</td></tr>
<tr><td><code id="fitrad_+3A_n">N</code></td>
<td>

<p>positive integer, total number of individuals in the sample/assemblage.
</p>
</td></tr>
<tr><td><code id="fitrad_+3A_start.value">start.value</code></td>
<td>

<p>numeric named vector; starting values of free parameters to be
passed to <code>mle2</code>.
Parameters should be named as in the corresponding density
function, and in the same order.
</p>
</td></tr>











<tr><td><code id="fitrad_+3A_upper">upper</code></td>
<td>

<p>real positive; upper bound for the Brent's one-parameter optimization
method (default), for fits that use this method by default. See
details and <code>optim</code>.
</p>
</td></tr>
<tr><td><code id="fitrad_+3A_...">...</code></td>
<td>

<p>in fitrad further arguments to be passed to the specific fitting
function (most used are <code>trunc</code> and
<code>start.value</code>
). In the specific fitting functions further
arguments to be passed to <code>mle2</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All these functions fit rank-abundance distributions (RAD) to a vector of
abundances or a rank-abundance table of the <code><a href="#topic+rad-class">rad-class</a></code>.
RADs assign probabilities p(i) to each rank i, which can be interpreted as
the expected proportion of total individuals in the sample that are of
the i-th species.
</p>
<p><code>fitrad</code> is simply a wrapper that calls the specific functions to fit
the distribution chosen with the argument <code>rad</code>. Users
can interchangeably use <code>fitrad</code> or the individual functions
detailed below 
(e.g. <code>fitrad(x, sad="rbs", ...)</code> is the same as
<code>fitrbs(x, ...)</code> and so on).
</p>
<p>The distributions are fitted by the
maximum likelihood method using numerical optimization,
with <code>mle2</code>.
The resulting object is of <code>fitrad-class</code>
which can be handled with <code>mle2</code> methods
for fitted models and has also some additional
methods for RADs models (see
<code><a href="#topic+fitrad-class">fitrad-class</a></code> and examples).
By default, fitting to one-parameter distributions (<code>fitgs</code>,
<code>fitzipf</code>) uses Brent's one-dimensional method of optimization (see
<code><a href="stats.html#topic+optim">optim</a></code>).
</p>
<p><code>fitgs</code> fits Motomura's  Geometric Series (Whittaker
1965, May 1975) to abundance ranks. 
This was the first model fitted to species
abundance data (Motomura 1932, <em>apud</em> Doi and Mori 2012),
which was subsequently described as the result
of niche pre-emption at a constant rate (Numata et. al. 1953 <em>apud</em> Doi
and Mori 2012). The initial guess for parameter <kbd>k</kbd> is given by
the expression 1 - (nmin/nmax)^(1/(S-1)) (He &amp; Tang, 2008).
</p>
<p><code>fitrbs</code> fits the Broken-stick distribution
(MacArthur 1960) to abundance ranks. It is defined only by the observed number of
elements <code>S</code> in the collection and collection size <code>N</code>.
Therefore, once a sample is taken,
the Broken-stick has no free parameters.
Therefore, there is no actual fitting, but still
the <code>fitrbs</code> calls
<code>mle2</code> with
fixed parameters N and S and <code>eval.only=TRUE</code>
to return an object of <code>fitrad-class</code>
to keep compatibility with other
RAD models fitted to the same data.
Therefore the resulting objects allows most of the
operations with RAD models, such as
comparison with other models through model selection,
diagnostic plots and so on
(see <a href="#topic+fitrad-class">fitrad-class</a>).
</p>
<p><code>fitzipf</code> and <code>fitmand</code> fit the Zipf distribution and its
two-parameter generalization, the Zipf-Mandelbrodt distribution. Both
are discrete power-law distributions commonly proposed as RAD models,
though they in general provide poor fit to species abundances (Newman 2005).
</p>


<h3>Value</h3>

<p>An object of <code><a href="#topic+fitrad-class">fitrad-class</a></code> which inherits from <code>mle2-class</code>
and thus has methods for handling
results of maximum likelihood fits from <code>mle2</code>
and also specific methods to handle rank-abundance models.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Andre Chalom and Murilo Dantas Miranda</p>


<h3>Source</h3>

<p>all fitting functions builds on <code>mle2</code> and methods
from 'bbmle' package (Bolker 2012), which in turn builds on
<code>mle</code> function and associated classes and methods.
</p>


<h3>References</h3>

<p>Bolker, B. and R Development Core Team 2012. bbmle: Tools for
general maximum likelihood estimation. R package version 1.0.5.2.
http://CRAN.R-project.org/package=bbmle
</p>
<p>Doi, H. and Mori, T. 2012. The discovery of species-abundance
distribution in an ecological community. <em>Oikos 122:</em> 179&ndash;182.
</p>
<p>He, F. and Tang, D. 2008. Estimating the niche preemption parameter
of the geometric series. <em>Acta Oecologica 33:</em> 105&ndash;107.
</p>
<p>MacArthur, R.H. 1960. On the relative abundance of species.
<em>Am Nat 94</em>:25&ndash;36.
</p>
<p>May, R.M. 1975. Patterns of Species Abundance and Diversity. In
Cody, M.L. and Diamond, J.M. (Eds) <em>Ecology and Evolution of
Communities</em>. Harvard University Press. pp 81&ndash;120.
</p>
<p>Newman, M.E.J. 2005. Power laws, Pareto distributions and Zipf's law.
<em>Contemporary Physics, 46:</em> 323&ndash;351.
</p>
<p>Whittaker, R.H. 1965. Dominance and diversity in land plant
communities. <em>Science 147</em>: 250&ndash;260.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dgs">dgs</a></code>, <code><a href="#topic+dmand">dmand</a></code>, <code><a href="#topic+drbs">drbs</a></code>,
<code><a href="#topic+dzipf">dzipf</a></code>,
for corresponding density functions created for fitting RADs;
<code><a href="#topic+fitrad-class">fitrad-class</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Figure 2 of Motomura (1932)
data(okland)
plot(rad(okland))
ok.gs &lt;- fitrad(okland, "gs")
lines(radpred(ok.gs))

## Comparison with Zipf-Mandelbrodt
ok.zm &lt;- fitrad(okland, "mand")
AICctab(ok.gs, ok.zm, nobs=length(okland))
lines(radpred(ok.zm), col="red")
</code></pre>

<hr>
<h2 id='fitrad-class'>Class <code>"fitrad"</code> for maximum likelihood fitting of species
rank-abundance distributions</h2><span id='topic+fitrad-class'></span><span id='topic+plot+2Cfitrad+2CANY-method'></span><span id='topic+show+2Cfitrad-method'></span><span id='topic+pprad+2Cfitrad+2Cmissing+2Cmissing-method'></span><span id='topic+pprad+2Cfitrad+2Cmissing+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic+qqrad+2Cfitrad+2Cmissing+2Cmissing+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>This class extends <code>mle2-class</code> to encapsulate models of species
rank-abundance distributions 
(RADs) fitted by maximum likelihood.
</p>


<h3>Objects from the Class</h3>

<p>Objects created by a call to function <code><a href="#topic+fitrad">fitrad</a></code>, which fits
a probability distribution to an abundance vector.
</p>


<h3>Slots</h3>


<dl>
<dt><code>rad</code>:</dt><dd><p>Object of class <code>"character"</code>; root name of
the species abundance distribution fitted. See man page of
<code>fitrad</code> for available models.</p>
</dd>
<dt><code>distr</code>:</dt><dd><p>Deprecated since sads 0.2.4. See <code><a href="#topic+distr">distr</a></code> function</p>
</dd>
<dt><code>trunc</code>:</dt><dd><p>Object of class <code>"numeric"</code>; truncation
value used in the fitted model. 'NA' for a non-truncated
distribution.</p>
</dd>
<dt><code>rad.tab</code>:</dt><dd><p>Object of class <code>"rad"</code>; rank-abundance
table of observed abundances.</p>
</dd>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"language"</code>; The call to <code>mle2</code>.</p>
</dd>
<dt><code>call.orig</code>:</dt><dd><p>Object of class <code>"language"</code> The call to <code>mle2</code>,
saved in its original form (i.e. without data arguments
evaluated).</p>
</dd>
<dt><code>coef</code>:</dt><dd><p>Object of class <code>"numeric"</code>; Vector of estimated parameters.</p>
</dd>
<dt><code>fullcoef</code>:</dt><dd><p>Object of class <code>"numeric"</code>; Fixed and estimated parameters. </p>
</dd>
<dt><code>vcov</code>:</dt><dd><p>Object of class <code>"matrix"</code>; Approximate variance-covariance
matrix, based on the second derivative matrix at the MLE.</p>
</dd>
<dt><code>min</code>:</dt><dd><p>Object of class <code>"numeric"</code>; Minimum value of objective function =
minimum negative log-likelihood.</p>
</dd>
<dt><code>details</code>:</dt><dd><p>Object of class <code>"list"</code>; Return value from <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</dd>
<dt><code>minuslogl</code>:</dt><dd><p>Object of class <code>"function"</code>; The negative log-likelihood
function.</p>
</dd>
<dt><code>method</code>:</dt><dd><p>Object of class <code>"character"</code>; The optimization method used. </p>
</dd>
<dt><code>data</code>:</dt><dd><p>Object of class <code>"data.frame"</code>; Data with which to evaluate the negative log-likelihood function.</p>
</dd>
<dt><code>formula</code>:</dt><dd><p>Object of class <code>"character"</code>; If a formula was specified, a
character vector giving the formula and parameter specifications. </p>
</dd>
<dt><code>optimizer</code>:</dt><dd><p>Object of class <code>"character"</code>; The optimizing function used. </p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"mle2"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>octavpred</dt><dd><p><code>signature(object = "fitrad", sad = "missing",
	rad = "missing", coef = "missing", trunc = "missing", oct = "ANY", S =
	"missing", N = "missing")</code>: expected number of species per
abundance octave, see <code><a href="#topic+octav">octav</a></code> and <code><a href="#topic+octavpred">octavpred</a></code>.</p>
</dd> 
<dt>plot</dt><dd><p><code>signature(x = "fitrad", y = "ANY")</code>: diagnostic
plots of the fitted model. </p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "fitrad")</code>: Displays object.</p>
</dd>
<dt>nobs</dt><dd><p><code>signature(object = "fitrad")</code>: Displays number of
observations (number of species) in the data to which the model was fitted.</p>
</dd>
<dt>pprad</dt><dd><p><code>signature(x = "fitrad", sad = "missing", coef =
	"missing", trunc = "missing")</code>: plot of observed vs predicted
percentiles of the abundance distribution, details in
<code><a href="#topic+pprad">pprad</a></code>. </p>
</dd> 
<dt>qqrad</dt><dd><p><code>signature(x = "fitrad", sad = "missing", coef =
	"missing", trunc = "missing")</code>: plot of observed vs predicted
quantiles of the abundance distribution, details in
<code><a href="#topic+qqrad">qqrad</a>. </code> </p>
</dd>
<dt>radpred</dt><dd><p><code>signature(object = "fitrad", sad = "missing",
	rad = "missing", coef = "missing", trunc = "missing", distr =
	"missing", S = "missing", N = "missing")</code>: expected abundances
of the 1st to n-th most abundant species, see <code><a href="#topic+rad">rad</a></code> and <code><a href="#topic+radpred">radpred</a></code>. </p>
</dd>
</dl>



<h3>Note</h3>

<p>Class <code>fitrad</code> only adds four slots to class
<code>mle2</code>. The descriptions of slots inherited from <code>mle2-class</code>
replicate those in <code>mle2-class</code>. 
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda,
after Ben Bolker and  R Core Team.</p>


<h3>Source</h3>

<p>this class builds on <code>mle2-class</code> of <span class="pkg">bbmle</span> package (Bolker
2012), which in turn builds on <code>mle-class</code>. 
</p>


<h3>References</h3>

<p>Bolker, B. and R Development Core Team 2012. bbmle: Tools for
general maximum likelihood estimation. R package version 1.0.5.2.
http://CRAN.R-project.org/package=bbmle
</p>


<h3>See Also</h3>

<p><code>mle2-class</code> for all methods available from which
<code>fitrad-class</code> inherits; <code><a href="#topic+fitrad">fitrad</a></code> for details on
fitting RADs models; <code><a href="#topic+octavpred">octavpred</a></code> and
<code><a href="#topic+radpred">radpred</a></code> to get rank-abundance and
frequencies of species in octaves predicted 
from fitted models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ok.gser &lt;- fitrad(okland, "gs")
## The class has a plot method to show diagnostic plots
par(mfrow=c(2,2))
plot(ok.gser)
# The same plot, but with relative abundances
plot(ok.gser, prop = TRUE)
par(mfrow=c(1,1))
## Some useful methods inherited from mle2-class
coef(ok.gser)
confint(ok.gser)
logLik(ok.gser)
## Model selection
ok.zipf &lt;- fitrad(okland, "zipf")
AICctab(ok.gser, ok.zipf, nobs=length(moths), base=TRUE)
</code></pre>

<hr>
<h2 id='fitsad'>ML fitting of species abundance distributions</h2><span id='topic+fitsad'></span><span id='topic+fitbs'></span><span id='topic+fitexp'></span><span id='topic+fitgamma'></span><span id='topic+fitgeom'></span><span id='topic+fitlnorm'></span><span id='topic+fitls'></span><span id='topic+fitmzsm'></span><span id='topic+fitnbinom'></span><span id='topic+fitpareto'></span><span id='topic+fitpoilog'></span><span id='topic+fitpower'></span><span id='topic+fitpowbend'></span><span id='topic+fitvolkov'></span><span id='topic+fitweibull'></span>

<h3>Description</h3>

<p>Fits probability distributions for
abundances of species in a sample or assemblage by maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitsad(x, sad = c("bs","exp", "gamma","geom","lnorm","ls","mzsm","nbinom","pareto",
       "poilog","power", "powbend", "volkov","weibull"), ...)

fitbs(x, trunc, ...)

fitexp(x, trunc = NULL, start.value, ...)

fitgamma(x, trunc, start.value,  ...)

fitgeom(x, trunc = 0, start.value, ...)

fitlnorm(x, trunc, start.value,  ...)

fitls(x, trunc, start.value, upper = length(x), ...)

fitmzsm(x, trunc, start.value, upper = length(x), ...)

fitnbinom(x, trunc = 0, start.value, ...)

fitpareto(x, trunc, start.value,  upper = 20, ...)

fitpoilog(x, trunc = 0, ...)

fitpower(x, trunc, start.value, upper = 20, ...)

fitpowbend(x, trunc, start.value, ...)

fitvolkov(x, trunc, start.value, ...)

fitweibull(x, trunc, start.value,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitsad_+3A_x">x</code></td>
<td>
<p>vector of (positive integer) quantiles. In the context of
SADs, some abundance measurement (e.g., number of individuals,
biomass) of species in a sample or ecological assemblage.
</p>
</td></tr>
<tr><td><code id="fitsad_+3A_sad">sad</code></td>
<td>

<p>character; root name of community sad distribution to be fitted.
<kbd>"bs"</kbd> for broken-stick distribution,
<kbd>"exp"</kbd> for exponential distribution,
<kbd>"gamma"</kbd> for gamma distribution,
<kbd>"geom"</kbd> for geometric distributions (not geometric series rad model,
<code><a href="#topic+dgs">dgs</a></code>),
<kbd>"lnorm"</kbd> for lognormal,
<kbd>"ls"</kbd> for Fisher's log-series,
<kbd>"mzsm"</kbd> for Alonso &amp; McKane's neutral metacommunity distribution,
<kbd>"nbinom"</kbd> for negative binomial,
<kbd>"pareto"</kbd> for Pareto distribution,
<kbd>"poilog"</kbd> for Poisson-lognormal distribution,
<kbd>"power"</kbd> for power-law distribution,
<kbd>"powbend"</kbd> for Pueyo's power-bend distribution,
<kbd>"volkov"</kbd> for Volkov's et al. neutral community distribution,
<kbd>"weibull"</kbd> for Weibull distribution.
</p>
</td></tr>
<tr><td><code id="fitsad_+3A_trunc">trunc</code></td>
<td>

<p>non-negative integer, <code>trunc &gt; min(x)</code>; truncation point to fit a
truncated distribution. For &quot;poilog&quot;, &quot;geom&quot; and &quot;nbinom&quot; set
trunc=NULL to avoid zero-truncation (see details).
</p>
</td></tr>
<tr><td><code id="fitsad_+3A_start.value">start.value</code></td>
<td>

<p>named numeric vector; starting values of free parameters to be
passed to <code>mle2</code>.
Parameters should be named as in the corresponding density
function,
and in the same order.
</p>
</td></tr>
<tr><td><code id="fitsad_+3A_upper">upper</code></td>
<td>

<p>real positive; upper bound for Brent's one-parameter optimization
method (default), for fits that use this method by default. See
details and <code>optim</code>.
</p>
</td></tr>
<tr><td><code id="fitsad_+3A_...">...</code></td>
<td>

<p>in <code>fitsad</code> further arguments to be passed to the specific fitting
function (most used are <code>trunc</code>, <code>start.value</code>)
In the specific fitting functions further
arguments to be passed to <code>mle2</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

 <p><code>fitsad</code> is simply a wrapper that calls the specific
functions to fit the distribution chosen with the argument
<code>sad</code>. Users can interchangeably use <code>fitsad</code> or the
individual functions detailed below (e.g. <code>fitsad(x, sad="geom",
  ...)</code> is the same as <code>fitgeom(x, ...)</code> and so on).
</p>
<p>The distributions are fitted by the maximum likelihood method using
numerical optimization, with <code>mle2</code>.  The resulting object is of
<code>fitsad-class</code> which can be handled with <code>mle2</code> methods for
fitted models and has also some additional methods for SADs models
(see <code><a href="#topic+fitsad-class">fitsad-class</a></code> and examples).
</p>
<p>Functions <code>fitexp</code>, <code>fitgamma</code>, <code>fitlnorm</code> and
<code>fitweibull</code> fit the standard continuous distributions most used
as SADs models.  As species with null abundances in the sample are in
general unknown, the fit to continuous distributions can be improved
by truncation to some value above zero (see example). Convergence
problems can occur when fitting with truncation, and can be solved
with sensible starting values.  <code>fitgamma</code> uses Chapman's (1956)
fitting method to find starting values for the truncated gamma
distribution, and <code>fitweibull</code> uses Rinne's (2009, p. 413) method
(thanks to Mario Jose Marques-Azevedo).
</p>
<p>Functions <code>fitgeom</code>, <code>fitnbinom</code> fits geometric and negative
binomial distributions which are two discrete standard distributions
also used to fit SADs. Since species with zero individuals in the
sample are in general unknown, these functions fit by default
zero-truncated distributions.  To avoid zero-truncation set
<code>trunc=NULL</code>.  Using the geometric distribution as a SAD model is
not to be confounded for fitting the Geometric series
<code><a href="#topic+fitgs">fitgs</a></code> as a rank-abundance distribution (RAD) model.
</p>
<p>Function <code>fitls</code> implements the original numerical recipe by
Fisher (1943) to fit the log-series distribution, given a vector of
species abundances.  Alonso et al. (2008, supplementary material)
showed that this recipe gives the maximum likelihood estimate of
Fisher's alpha, the single parameter of the log-series.  Fitting is
done through numerical optimization with the <code>uniroot</code> function,
following the code of the function <code>fishers.alpha</code> of the
<span class="pkg">untb</span> package. After that, the estimated value of alpha parameter
is used as the starting value to get the Log-likelihood from the
log-series density function <code>dls</code>, using the function
<code>mle2</code>.  The total number of individuals in the sample, <code>N</code>,
is treated as a fixed parameter in this implementation, in order to
maintain coherence with similar parameters from <code>fitvolkov</code> and
<code>fitmzsm</code> (see below).  Fixed parameters in the model
specification do not contribute to the model degrees of freedom, and
are not accounted in standard error calculations.
</p>
<p>Functions <code>fitpower</code>, <code>fitpowbend</code> and <code>fitpareto</code> fit
power-law distributions with one and two-parameters, that have been
suggested as SADs models.  The implementations of power and power-bend
are for discrete distributions that do not include zeroes. The Pareto
distribution is continuous and includes all non-negative numbers.
Fisher's logseries are a special case of the power-bend, see
<code><a href="#topic+dpowbend">dpowbend</a></code> and Pueyo (2006).
</p>
<p>Function <code>fitbs</code> fits the Broken-stick distribution (MacArthur
1960). It is defined only by the observed number of elements <code>S</code>
in the collection and collection size <code>N</code>.  Thus once a sample is
taken, the Broken-stick has no free parameters.  Therefore, there is
no actual fitting, but still <code>fitbs</code> calls <code>mle2</code> with fixed
parameters <code>N</code> and <code>S</code> and <code>eval.only=TRUE</code> to return
an object of class <code>fitsad</code> to keep compatibility with other SADs
models fitted to the same data.  Therefore, the resulting objects
allows most of the operations with SAD models, such as comparison with
other models through model selection, diagnostic plots and so on (see
<code><a href="#topic+fitsad-class">fitsad-class</a></code>).
</p>
<p>Function <code>fitpoilog</code> fits the Poisson-lognormal distribution.
This is a compound distributions that describes the abundances of
species in Poisson sample of community that follows a lognormal
SAD. This is a sampling model of SAD, which is approximated by the
&lsquo;veil line&rsquo; truncation of the lognormal (Preston 1948). The
Poisson-lognormal is the analytic solution for this sampling model, as
Fisher's log-series is a analytic limit case for a Poisson-gamma
(a.k.a negative binomial) distribution. As geometric and negative
binomial distributions, the Poisson-lognormal includes zero, but the
fit is zero-truncated by default, as for <code>fitgeom</code>,
<code>fitnbinom</code>.  To avoid zero-truncation set <code>trunc=NULL</code>.
</p>
<p><code>fitmzsm</code> fits the metacommunity Zero-sum multinomial
distribution <code><a href="#topic+dmzsm">dmzsm</a></code> from the Neutral Theory of
Biodiversity (Alonso and McKane 2004). The mZSM describes the SAD of a
sample taken from a neutral metacommunity under random drift.  It has
two parameters, the number of individuals in the sample <code>J</code> and
<code>theta</code>, the &lsquo;fundamental biodiversity number&rsquo;.  Because
<code>J</code> is known from the sample size, the fit resumes to estimate a
single parameter, <code>theta</code>. By default, <code>fitmzsm</code> fits mZSM
to a vector of abundances with Brent's one-dimensional method of
optimization (see <code>optim</code>). The log-series distribution (Fisher
et al. 1943) is a limiting case of mZSM (Hubbel 2001), and
<code>theta</code> tends to Fisher's alpha as <code>J</code> increases. In
practice the two models provide very similar fits to SADs (see
example).
</p>
<p>Function <code>fitvolkov</code> fits the SAD model for a community under
neutral drift with immigration (Volkov et al. 2003).  The model is a
stationary distribution deduced from a stochastic process compatible
with the Neutral Theory of Biodiversity (Hubbell 2001). It has two
free parameters, the &lsquo;fundamental biodiversity number&rsquo;
<code>theta</code>, and the immigration rate <code>m</code> (see
<code><a href="#topic+dvolkov">dvolkov</a></code>) <code>fitvolkov</code> builds on function
<code>volkov</code> from package <span class="pkg">untb</span> to fit Volkov's <em>et al.</em>
SAD model to a vector of abundances.  The fit can be extremely slow
even for vectors of moderate size.  </p>


<h3>Value</h3>

<p>An object of <code>fitsad-class</code> which inherits from <code>mle2-class</code>
and thus has methods for handling
results of maximum likelihood fits from <code>mle2</code>
and also specific methods to handle SADs models
(see <code><a href="#topic+fitsad-class">fitsad-class</a></code>).
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Murilo Dantas Miranda and
Andre Chalom,
after Ben Bolker, R Core Team, Robin Hanking, Vidar Grøtan and Steinar Engen.</p>


<h3>Source</h3>

<p>all fitting functions builds on <code>mle2</code> and methods
from <span class="pkg">bbmle</span> package (Bolker 2012), which in turn builds on
<code>mle</code> function and associated classes and methods;
<code>fitls</code> and <code>fitvolkov</code> use codes and functions from
<span class="pkg">untb</span> package (Hankin 2007); <code>fitpoilog</code> builds on
<span class="pkg">poilog</span> package (Grøtan &amp; Engen 2008).
</p>


<h3>References</h3>

<p>Alonso, D. and McKane, A.J.  2004.  Sampling Hubbell's neutral
model of biodiversity. <em>Ecology Letters 7</em>:901&ndash;910
</p>
<p>Alonso, D. and Ostling, A., and Etienne, R.S. 2008 The implicit
assumption of symmetry and the species abundance
distribution. <em>Ecology Letters, 11</em>: 93-105.
</p>
<p>Bolker, B. and R Development Core Team 2012. bbmle: Tools for
general maximum likelihood estimation. R package version 1.0.5.2.
http://CRAN.R-project.org/package=bbmle
</p>
<p>Chapman, D. G. 1956. Estimating the parameters of a truncated gamma
distribution. <em>The Annals of Mathematical Statistics, 27(2)</em>:
498&ndash;506.
</p>
<p>Fisher, R.A, Corbert, A.S. and Williams, C.B. (1943) The Relation
between the number of species and the number of individuals in a
random sample of an animal population.
<em>The Journal of Animal Ecology, 12(1)</em>: 42&ndash;58.
</p>
<p>Grøtan, V. and Engen, S. 2008. poilog: Poisson lognormal and
bivariate Poisson lognormal distribution. R package version 0.4.
</p>
<p>Hankin, R.K.S. 2007. Introducing untb, an <span class="rlang"><b>R</b></span> Package For Simulating Ecological Drift
Under the Unified Neutral Theory of Biodiversity. <em>Journal
of Statistical Software 22</em> (12). 
</p>
<p>Hubbell, S.P.  2001.  <em>The Unified Neutral Theory of Biodiversity</em>.
Princeton University Press
</p>
<p>MacArthur, R.H. 1960. On the relative abundance of species.
<em>Am Nat 94</em>:25&ndash;36.
</p>
<p>Magurran, A.E. 1989. <em>Ecological diversity and its measurement</em>.
Princenton University Press.
</p>
<p>Preston, F.W. 1948. The commonness and rarity of species.
<em>Ecology 29</em>: 254&ndash;283.
</p>
<p>Pueyo, S. (2006) <em>Diversity: Between neutrality and structure</em>,
Oikos 112: 392-405.
</p>
<p>Rinne, H. 2009. <em>The Weibull distribution: a handbook</em>. CRC Press
</p>
<p>Volkov, I.,  Banavar, J. R., Hubbell, S. P., Maritan, A. 2003.
Neutral theory and relative species abundance in ecology.  <em>Nature 424</em>:1035&ndash;1037.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+dls">dls</a></code>, <code><a href="#topic+dmzsm">dmzsm</a></code>, <code><a href="#topic+dpareto">dpareto</a></code>,
<code><a href="#topic+dpoilog">dpoilog</a></code>, <code><a href="#topic+dpower">dpower</a></code>,<code> <a href="#topic+dvolkov">dvolkov</a></code>,
<code><a href="#topic+dpowbend">dpowbend</a></code> for corresponding density functions created for
fitting SADs; standard distributions <code>dexp</code>, <code>dgamma</code>,
<code>dgeom</code>, <code>dlnorm</code>, <code>dnbinom</code>, <code>dweibull</code>;
<code><a href="#topic+fitsad-class">fitsad-class</a></code>.  </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Magurran (1989) example 5:
## birds in an Australian forest
mag5 &lt;- c(103, 115, 13, 2, 67, 36, 51, 8, 6, 61, 10, 21,
          7, 65, 4, 49, 92, 37, 16, 6, 23, 9, 2, 6, 5, 4, 
          1, 3, 1, 9, 2)
mag5.bs &lt;- fitsad(mag5, "bs") 
summary(mag5.bs)## no estimated coefficient
coef(mag5.bs) ## fixed coefficients N and S
## Diagnostic plots
par(mfrow=c(2, 2))
plot(mag5.bs)
par(mfrow=c(1, 1))


data(moths) #Fisher's moths data
moths.mzsm &lt;- fitmzsm(moths) ## same as fitsad(moths, sad="mzsm")
## fit to log-series
moths.ls &lt;- fitsad(moths, sad="ls")
coef(moths.ls)
coef(moths.mzsm) ## Compare with theta=38.9, Alonso&amp;McKanne (2004)
## Diagnostic plots
par(mfrow=c(2, 2))
plot(moths.mzsm)
par(mfrow=c(1, 1))
## Graphical comparison
plot(rad(moths))
lines(radpred(moths.ls))
lines(radpred(moths.mzsm), col="red", lty=2)
legend("topright", c("log-series", "mZSM"), lty=1, col=c("blue","red"))
## Two more models: truncated lognormal and Poisson-lognormal
moths.ln &lt;- fitsad(moths, "lnorm", trunc=0.5)
moths.pln &lt;- fitsad(moths, "poilog")
## Model selection
AICtab(moths.ln, moths.pln, moths.ls, moths.mzsm, weights=TRUE)

## Biomass as abundance variable
data(ARN82.eB.apr77) #benthonic marine animals
AR.ln &lt;- fitsad(ARN82.eB.apr77, sad="lnorm")
AR.g &lt;- fitsad(ARN82.eB.apr77, sad="gamma")
AR.wb &lt;- fitsad(ARN82.eB.apr77, sad="weibull")
plot(octav(ARN82.eB.apr77))
lines(octavpred(AR.ln))
lines(octavpred(AR.g), col="red")
lines(octavpred(AR.wb), col="green")
legend("topright", c("lognormal", "gamma", "weibull"),lty=1, col=c("blue","red", "green"))
AICctab(AR.ln, AR.g, AR.wb, nobs=length(ARN82.eB.apr77), weights=TRUE) 
</code></pre>

<hr>
<h2 id='fitsad-class'>Class <code>"fitsad"</code> for maximum likelihood fitting of
species abundance distributions</h2><span id='topic+fitsad-class'></span><span id='topic+plot+2Cfitsad+2CANY-method'></span><span id='topic+show+2Cfitsad-method'></span><span id='topic+ppsad+2Cfitsad+2Cmissing+2Cmissing-method'></span><span id='topic+ppsad+2Cfitsad+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic+qqsad+2Cfitsad+2Cmissing+2Cmissing+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>This class extends <code>mle2-class</code> to encapsulate models of species
abundance distributions (SADs) fitted by maximum likelihood.
</p>


<h3>Objects from the Class</h3>

<p>Objects created by a call to function <code><a href="#topic+fitsad">fitsad</a></code>, which fits a
probability distribution to an abundance vector.
</p>


<h3>Slots</h3>


<dl>
<dt><code>sad</code>:</dt><dd><p>Object of class <code>"character"</code>; root name of
the species abundance distribution fitted. See man page of
<code>fitsad</code> for available models.</p>
</dd>
<dt><code>distr</code>:</dt><dd><p>Deprecated since sads 0.2.4. See <code><a href="#topic+distr">distr</a></code> function</p>
</dd>
<dt><code>trunc</code>:</dt><dd><p>Object of class <code>"numeric"</code>; truncation
value used in the fitted model. 'NA' for a non-truncated distribution.</p>
</dd>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"language"</code>; The call to <code>mle2</code>.</p>
</dd>
<dt><code>call.orig</code>:</dt><dd><p>Object of class <code>"language"</code> The call to <code>mle2</code>,
saved in its original form (i.e. without data arguments
evaluated).</p>
</dd>
<dt><code>coef</code>:</dt><dd><p>Object of class <code>"numeric"</code>; Vector of estimated parameters.</p>
</dd>
<dt><code>fullcoef</code>:</dt><dd><p>Object of class <code>"numeric"</code>; Fixed and estimated parameters. </p>
</dd>
<dt><code>vcov</code>:</dt><dd><p>Object of class <code>"matrix"</code>; Approximate variance-covariance
matrix, based on the second derivative matrix at the MLE.</p>
</dd>
<dt><code>min</code>:</dt><dd><p>Object of class <code>"numeric"</code>; Minimum value of objective function =
minimum negative log-likelihood.</p>
</dd>
<dt><code>details</code>:</dt><dd><p>Object of class <code>"list"</code>; Return value from <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</dd>
<dt><code>minuslogl</code>:</dt><dd><p>Object of class <code>"function"</code>; The negative log-likelihood
function.</p>
</dd>
<dt><code>method</code>:</dt><dd><p>Object of class <code>"character"</code>; The optimization method used. </p>
</dd>
<dt><code>data</code>:</dt><dd><p>Object of class <code>"data.frame"</code>; Data with which to evaluate the negative log-likelihood function.</p>
</dd>
<dt><code>formula</code>:</dt><dd><p>Object of class <code>"character"</code>; If a formula was specified, a
character vector giving the formula and parameter specifications. </p>
</dd>
<dt><code>optimizer</code>:</dt><dd><p>Object of class <code>"character"</code>; The optimizing function used. </p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"mle2"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>octavpred</dt><dd><p><code>signature(object = "fitsad", sad = "missing",
	rad = "missing", coef = "missing", trunc = "missing", oct = "ANY", S =
	"missing", N = "missing")</code>: expected number of species per
abundance octave, see <code><a href="#topic+octav">octav</a></code> and <code><a href="#topic+octavpred">octavpred</a></code>.</p>
</dd> 
<dt>plot</dt><dd><p><code>signature(x = "fitsad", y = "ANY")</code>: diagnostic
plots of the fitted model. </p>
</dd>
<dt>nobs</dt><dd><p><code>signature(object = "fitsad")</code>: Displays number of
observations (number of species) in the data to which the model was fitted.</p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "fitsad")</code>: Displays object.</p>
</dd>
<dt>ppsad</dt><dd><p><code>signature(x = "fitsad", sad = "missing", coef =
	"missing", trunc = "missing")</code>: plot of observed vs predicted
percentiles of the abundance distribution, details in
<code><a href="#topic+ppsad">ppsad</a></code>. </p>
</dd> 
<dt>qqsad</dt><dd><p><code>signature(x = "fitsad", sad = "missing", coef =
	"missing", trunc = "missing", distr = "missing")</code>: plot of observed vs predicted
quantiles of the abundance distribution, details in
<code><a href="#topic+qqsad">qqsad</a>. </code> </p>
</dd>
<dt>radpred</dt><dd><p><code>signature(object = "fitsad", sad = "missing",
	rad = "missing", coef = "missing", trunc = "missing", distr =
	"missing", S = "missing", N = "missing")</code>: expected abundances
of the 1st to n-th most abundant species, see <code><a href="#topic+rad">rad</a></code> and <code><a href="#topic+radpred">radpred</a></code>. </p>
</dd>
</dl>



<h3>Note</h3>

<p>Class <code>fitsad</code> only adds three slots to class
<code>mle2</code>. The descriptions of slots inherited from <code>mle2-class</code>
replicate those in <code>mle2-class</code>. 
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda,
after Ben Bolker and  R Core Team.</p>


<h3>Source</h3>

<p>this class builds on <code>mle2-class</code> of <span class="pkg">bbmle</span> package (Bolker
2012), which in turn builds on <code>mle-class</code>. 
</p>


<h3>References</h3>

<p>Bolker, B. and R Development Core Team 2012. bbmle: Tools for
general maximum likelihood estimation. R package version 1.0.5.2.
http://CRAN.R-project.org/package=bbmle
</p>


<h3>See Also</h3>

<p><code>mle2-class</code> for all methods available from which
<code>fitsad-class</code> inherits; <code><a href="#topic+fitsad">fitsad</a></code> for details on
fitting SADs models; <code><a href="#topic+octavpred">octavpred</a></code> and
<code><a href="#topic+radpred">radpred</a></code> to get rank-abundance and
frequencies of species in octaves predicted 
from fitted models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>moths.ls &lt;- fitsad(moths, "ls")
## The class has a plot method to show diagnostic plots
par(mfrow=c(2,2))
plot(moths.ls)
# the same plot, but with relative abundances
plot(moths.ls, prop = TRUE) 
par(mfrow=c(1,1))
## Some useful methods inherited from mle2-class
coef(moths.ls)
confint(moths.ls)
logLik(moths.ls)
## Model selection
moths.ln &lt;- fitsad(moths, "lnorm", trunc=0.5)
AICctab(moths.ls, moths.ln, nobs=length(moths), base=TRUE)
</code></pre>

<hr>
<h2 id='fitsadC'>ML fitting of species abundance distributions to data pooled in abundance classes</h2><span id='topic+fitsadC'></span><span id='topic+fitexpC'></span><span id='topic+fitgammaC'></span><span id='topic+fitlnormC'></span><span id='topic+fitparetoC'></span><span id='topic+fitweibullC'></span>

<h3>Description</h3>

<p>Fits probability distributions for abundances of species
aggregated in abundance classes in a sample or assemblage by maximum
likelihood.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitsadC(x, sad = c("exp","gamma","lnorm","pareto", "weibull"), ...)

fitexpC(x, trunc = NULL, start.value, ...)

fitgammaC(x, trunc, start.value,  ...)

fitlnormC(x, trunc, start.value,  ...)

fitparetoC(x, trunc, start.value,  upper = 20, ...)

fitweibullC(x, trunc, start.value,  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitsadC_+3A_x">x</code></td>
<td>
<p>object of class <code>histogram</code> with the number of species in
abundance classes, in a sample or ecological assemblage.
</p>
</td></tr>
<tr><td><code id="fitsadC_+3A_sad">sad</code></td>
<td>

<p>character; root name of community sad distribution to be fitted.
<kbd>"exp"</kbd> for exponential distribution,
<kbd>"gamma"</kbd> for gamma distribution,
<kbd>"lnorm"</kbd> for lognormal,
<kbd>"pareto"</kbd> for Pareto distribution,
<kbd>"weibull"</kbd> for Weibull distribution.
</p>
</td></tr>
<tr><td><code id="fitsadC_+3A_trunc">trunc</code></td>
<td>

<p>non-negative integer, <code>trunc &gt; min(x)</code>; truncation point to fit a
truncated distribution. 
</p>
</td></tr>
<tr><td><code id="fitsadC_+3A_start.value">start.value</code></td>
<td>

<p>named numeric vector; starting values of free parameters to be
passed to <code>mle2</code>.
Parameters should be named as in the corresponding density
function,
and in the same order.
</p>
</td></tr>
<tr><td><code id="fitsadC_+3A_upper">upper</code></td>
<td>

<p>real positive; upper bound for Brent's one-parameter optimization
method (default), for fits that use this method by default. See
details and <code>optim</code>.
</p>
</td></tr>
<tr><td><code id="fitsadC_+3A_...">...</code></td>
<td>

<p>in <code>fitsad</code> further arguments to be passed to the specific fitting
function (most used are <code>trunc</code>, <code>start.value</code>)
In the specific fitting functions further
arguments to be passed to <code>mle2</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

 <p><code>fitsadC</code> is simply a wrapper that calls the specific
functions to fit the distribution chosen with the argument
<code>sad</code>. Users can interchangeably use <code>fitsadC</code> or the
individual functions detailed below (e.g. <code>fitsad(x, sad="exp",
    ...)</code> is the same as <code>fitexpC(x, ...)</code> and so on).
</p>
<p>The distributions are fitted by the maximum likelihood method using
numerical optimization, with <code>mle2</code>.  The resulting object is of
<code>fitsadC-class</code> which can be handled with <code>mle2</code> methods for
fitted models and has also some additional methods for SADs models
(see <code><a href="#topic+fitsadC-class">fitsadC-class</a></code> and examples).
</p>
<p>For counts of species in abundances classes the likelihood function is
</p>
<p style="text-align: center;"><code class="reqn">L(\theta) = \sum^C n_i \ln P_i</code>
</p>
<p> for
i = 1, 2, 3, ... C, where C is the number of abundance classes,
<code class="reqn">n_i</code> is the number of species in abundance class i.
</p>
<p><code class="reqn">P_i</code> is the probability attributed by the distribution model
to the observation of one species in class i, which depends on the
vector <code class="reqn">\theta</code> of free parameters of the distribution model:
</p>
<p style="text-align: center;"><code class="reqn">P_i = \int_{L_i}^{U_i} F(x \mid \theta) dx</code>
</p>

<p>where F(x|theta) is the value of the probability density function for a
cover value x, under parameter values fixed at theta, and L_i and U_i
are the lower and upper limits of the cover class i.
</p>
<p>See <code><a href="#topic+fitsad">fitsad</a></code> for descriptions of each distribution model.
</p>


<h3>Value</h3>

<p>An object of <code>fitsadC-class</code> which inherits from <code>mle2-class</code>
and thus has methods for handling
results of maximum likelihood fits from <code>mle2</code>
and also specific methods to handle SADs models
(see <code><a href="#topic+fitsadC-class">fitsadC-class</a></code>).
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Murilo Dantas Miranda and
Andre Chalom, after Ben Bolker, R Core Team.</p>


<h3>Source</h3>

<p>all fitting functions builds on <code>mle2</code> and methods
from <span class="pkg">bbmle</span> package (Bolker 2012), which in turn builds on
<code>mle</code> function and associated classes and methods.
</p>


<h3>References</h3>

<p>Bolker, B. and R Development Core Team 2012. bbmle: Tools for
general maximum likelihood estimation. R package version 1.0.5.2.
http://CRAN.R-project.org/package=bbmle
</p>
<p>Chapman, D. G. 1956. Estimating the parameters of a truncated gamma
distribution. <em>The Annals of Mathematical Statistics, 27(2)</em>:
498&ndash;506.
</p>
<p>Magurran, A.E. 1989. <em>Ecological diversity and its measurement</em>.
Princenton University Press.
</p>
<p>Preston, F.W. 1948. The commonness and rarity of species.
<em>Ecology 29</em>: 254&ndash;283.
</p>
<p>Rinne, H. 2009. <em>The Weibull distribution: a handbook</em>. CRC Press
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+dpareto">dpareto</a></code>,for corresponding density functions created for
fitting SADs; standard distributions <code>dexp</code>, <code>dgamma</code>,
<code>dlnorm</code>, <code>dweibull</code>;
<code><a href="#topic+fitsadC-class">fitsadC-class</a></code>.  </p>


<h3>Examples</h3>

<pre><code class='language-R'>## An example using data from Vieira et al, see dataset "grasslands"
## Breakpoints of the abundance classes used (cover classes)
vieira.brk &lt;- c(0,1,3,5,seq(15,100, by=10),100)
##  creates an histogram object 
grass.h &lt;- hist(grasslands$mids, breaks = vieira.brk, plot = FALSE)
#Fits Pareto, lognormal and gamma distributions
grass.p &lt;- fitparetoC(grass.h)
grass.l &lt;- fitlnormC(grass.h)
grass.g &lt;- fitgammaC(grass.h)
## Predicted values by each model
grass.p.pred &lt;- coverpred(grass.p)
grass.l.pred &lt;- coverpred(grass.l)
grass.g.pred &lt;- coverpred(grass.g)
## model selection
AICctab(grass.p, grass.l, grass.g, weights =TRUE, base = TRUE)
## A histogram with the densities predicted by each model
plot(grass.h, main = "", xlab = "Abundance (cover)")
## Adds predicted densities by each model to the plot
points(grass.p.pred, col = 1)
points(grass.l.pred, col = 2)
points(grass.g.pred, col = 3)
legend("topright", legend=c("Pareto","Log-normal", "Gamma"), col = 1:3, lty=1, pch =1) 
</code></pre>

<hr>
<h2 id='fitsadC-class'>Class <code>"fitsadC"</code> for maximum likelihood fitting of
species abundance distributions from data in abundance classes</h2><span id='topic+fitsadC-class'></span><span id='topic+nobs+2CfitsadC-method'></span><span id='topic+plot+2CfitsadC+2CANY-method'></span><span id='topic+ppsad+2CfitsadC+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic+qqsad+2CfitsadC+2Cmissing+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic+show+2CfitsadC-method'></span>

<h3>Description</h3>

<p>This class extends <code>mle2-class</code> to encapsulate models of species
abundance distributions (SADs) fitted by maximum likelihood, from data
where species are classified in abundance classes (e.g, histograms or
frequency tables of number of species in classes of abundances).
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("fitsadC",
    ...)</code>, or, more commonly a call to functions <code><a href="#topic+fitexpC">fitexpC</a></code>,
<code><a href="#topic+fitgammaC">fitgammaC</a></code>, <code><a href="#topic+fitlnormC">fitlnormC</a></code>,
<code><a href="#topic+fitparetoC">fitparetoC</a></code>, <code><a href="#topic+fitweibullC">fitweibullC</a></code>, which fit a
probability distribution to a table of frequency of species
abundances.
</p>


<h3>Slots</h3>


<dl>
<dt><code>sad</code>:</dt><dd><p>Object of class <code>"character"</code>; root name of
the species abundance distribution fitted. See man page of
<code>fitsad</code> for available models.</p>
</dd>
<dt><code>trunc</code>:</dt><dd><p>Object of class <code>"numeric"</code>; truncation
value used in the fitted model. 'NA' for a non-truncated
distribution.</p>
</dd>
<dt><code>hist</code>:</dt><dd><p>Object of class <code>"histogram"</code>; a table of
frequencies of species in abundance classes, returned by the function <code>hist</code>.</p>
</dd>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"language"</code>; The call to <code>mle2</code>.</p>
</dd>
<dt><code>call.orig</code>:</dt><dd><p>Object of class <code>"language"</code> The call to <code>mle2</code>,
saved in its original form (i.e. without data arguments
evaluated).</p>
</dd>
<dt><code>coef</code>:</dt><dd><p>Object of class <code>"numeric"</code>; Vector of estimated parameters.</p>
</dd>
<dt><code>fullcoef</code>:</dt><dd><p>Object of class <code>"numeric"</code>; Fixed and estimated parameters. </p>
</dd>
<dt><code>vcov</code>:</dt><dd><p>Object of class <code>"matrix"</code>; Approximate variance-covariance
matrix, based on the second derivative matrix at the MLE.</p>
</dd>
<dt><code>min</code>:</dt><dd><p>Object of class <code>"numeric"</code>; Minimum value of objective function =
minimum negative log-likelihood.</p>
</dd>
<dt><code>details</code>:</dt><dd><p>Object of class <code>"list"</code>; Return value from <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</dd>
<dt><code>minuslogl</code>:</dt><dd><p>Object of class <code>"function"</code>; The negative log-likelihood
function.</p>
</dd>
<dt><code>method</code>:</dt><dd><p>Object of class <code>"character"</code>; The optimization method used. </p>
</dd>
<dt><code>data</code>:</dt><dd><p>Object of class <code>"data.frame"</code>; Data with which to evaluate the negative log-likelihood function.</p>
</dd>
<dt><code>formula</code>:</dt><dd><p>Object of class <code>"character"</code>; If a formula was specified, a
character vector giving the formula and parameter specifications. </p>
</dd>
<dt><code>optimizer</code>:</dt><dd><p>Object of class <code>"character"</code>; The
optimizing function used. </p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"mle2"</code>, directly.
</p>


<h3>Methods</h3>



<dl>
<dt>coverpred</dt><dd><p><code>signature(object = "fitsadC", sad =
	"missing", coef = "missing", trunc = "missing",
	breaks = "missing", mids = "missing", S = "missing")</code>:
predicted number of species in
each abundance class see <code><a href="#topic+coverpred">coverpred</a></code> </p>
</dd>


<dt>nobs</dt><dd><p><code>signature(object = "fitsadC")</code>: Displays number of
observations (number of species) in the data to which the model was fitted.</p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "fitsadC", y = "ANY")</code>: diagnostic
plots of the fitted model. </p>
</dd>
<dt>ppsad</dt><dd><p><code>signature(x = "fitsadC", sad = "missing", coef =
	"missing", trunc = "missing")</code>:
plot of observed vs predicted percentiles of the abundance
distribution, details in <code><a href="#topic+ppsad">ppsad</a></code>.  </p>
</dd>
<dt>qqsad</dt><dd><p><code>signature(x = "fitsadC", sad = "missing", coef =
	"missing", trunc = "missing", distr = "missing")</code>: plot of observed vs
predicted quantiles of the abundance distribution, details in
<code><a href="#topic+qqsad">qqsad</a>. </code> </p>
</dd>
<dt>radpred</dt><dd><p><code>signature(object = "fitsadC", sad = "missing",
	rad = "missing", coef = "missing", trunc = "missing",
	distr = "missing", S = "missing", N = "missing")</code>:
expected abundances of the 1st to n-th most abundant species, see <code><a href="#topic+rad">rad</a></code>
and <code><a href="#topic+radpred">radpred</a></code>.  </p>
</dd>

<dt>show</dt><dd><p><code>signature(object = "fitsadC")</code>: Displays object.</p>
</dd>
</dl>
 


<h3>Note</h3>

<p>Class <code>fitsadC</code> only adds three slots to class
<code>mle2</code>. The descriptions of slots inherited from <code>mle2-class</code>
replicate those in <code>mle2-class</code>. 
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>,
after Ben Bolker and  R Core Team.</p>


<h3>Source</h3>

<p>this class builds on <code>mle2-class</code> of <span class="pkg">bbmle</span> package (Bolker
2012), which in turn builds on <code>mle-class</code>. 
</p>


<h3>References</h3>

<p>Bolker, B. and R Development Core Team 2012. bbmle: Tools for
general maximum likelihood estimation. R package version 1.0.5.2.
http://CRAN.R-project.org/package=bbmle
</p>


<h3>See Also</h3>

<p><code>mle2-class</code> for all methods available from which
<code>fitsadC-class</code> inherits; <code><a href="#topic+fitsadC">fitsadC</a></code> for details on
fitting SADs models from frequency tables; <code><a href="#topic+coverpred">coverpred</a></code> to
get  frequencies of species in abundances classes predicted 
from fitted models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example of fitting a sad model to cover data 
## Abundance classes: cover scale for plants
Lbrk &lt;- c(0,1,3,5,15,25,35,45,55,65,75,85,95,100)
## To fit a sad model to cover data, data sould be in histogram format
grass.h &lt;- hist(grasslands$mids, breaks = Lbrk, plot = FALSE)
class(grass.h) ## class "histogram"
## Fits a Pareto distribution to the histogram object
grass.p &lt;- fitparetoC(grass.h)
class(grass.p)
## The class has a plot method to show diagnostic plots
par(mfrow=c(2,2))
plot(grass.p)
par(mfrow=c(1,1))
## Some methods inherited form mle2-class
summary(grass.p)
coef(grass.p)
AIC(grass.p)
</code></pre>

<hr>
<h2 id='grasslands'>Coverages of plants species in a plot in Southern Brazilian Grasslands</h2><span id='topic+grasslands'></span>

<h3>Description</h3>

<p>Coverage class of each plant species recorded in one of
the plots set in grassland in Southern Brazil ('Pampa') by Vieira &amp;
Overbeck (2020). </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(grasslands)
</code></pre>


<h3>Format</h3>

<p> A data-frame with one plant species per row, and three vectors:
</p>

<dl>
<dt>class</dt><dd><p>cover class as coded in the original data
set.</p>
</dd>
<dt>cover</dt><dd><p>interval of the cover class for each plant species. Cover
is the proportion of the area of the plot covered by all individuals
of each species</p>
</dd>
<dt>upper</dt><dd><p>Upper limit of the cover class of each
plant species</p>
</dd>
<dt>mids</dt><dd><p>Mid-point of the cover class for each plant sepcies</p>
</dd>
</dl>



<h3>Source</h3>

<p>Vieira &amp; Overbeck (2020) provide cover data for each individual species in
the whole set of eighty plots of 1 m2. The data frame <code>grasslands</code>
corresponds to data from plot 'CA8', which has the largest number of
species recorded among these plots. 
</p>


<h3>References</h3>

<p>Vieira, Mariana; Overbeck, Gerhard (2020). Small seed bank
in grasslands and tree plantations in former grassland sites in the
South Brazilian highlands
[Dataset]. Dryad. https://doi.org/10.5061/dryad.n2z34tmsw
</p>

<hr>
<h2 id='ICtab'>Compute table of information criteria and auxiliary info</h2><span id='topic+nobs'></span><span id='topic+AIC'></span><span id='topic+AICc'></span><span id='topic+AIC-methods'></span><span id='topic+AICc-methods'></span><span id='topic+nobs-methods'></span><span id='topic+AIC+2Cmle2-method'></span><span id='topic+AICc+2Cmle2-method'></span><span id='topic+nobs+2Cfitrad-method'></span><span id='topic+nobs+2Cfitsad-method'></span>

<h3>Description</h3>

<p>This functions reimplement some functionality from package bbmle
to work better with objects from the classes <code><a href="#topic+fitsad-class">fitsad-class</a></code>
and <code><a href="#topic+fitrad-class">fitrad-class</a></code>. 
</p>


<h3>Methods</h3>


<dl>
<dt>AIC</dt><dd><p><code>signature("mle2")</code>: Akaike information criterion. </p>
</dd>
<dt>AICc</dt><dd><p><code>signature("mle2")</code>: Akaike information
criterion corrected for small samples. </p>
</dd>
<dt>nobs</dt><dd><p><code>signature(object = "fitsad")</code>: Number of observations. </p>
</dd>
<dt>nobs</dt><dd><p><code>signature(object = "fitrad")</code>: Number of observations. </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Andre Chalom and Murilo Dantas Miranda,
after Ben Bolker and  R Core Team.</p>


<h3>See Also</h3>

<p><code>mle2-class</code> for all methods available from which
<code>fitsad-class</code> inherits; <code><a href="#topic+fitsad">fitsad</a></code> for details on
fitting SADs models.
</p>

<hr>
<h2 id='likelregions-class'>Class <code>"likelregions"</code> for likelihood profiles of maximum likelihood fits</h2><span id='topic+likelregions-class'></span><span id='topic+show+2Clikelregions-method'></span>

<h3>Description</h3>

<p>This class provides a list of likelihood intervals for the parameters of
a maximum likelihood fit. See the help on the function <code><a href="#topic+likelregions">likelregions</a></code> for details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1.gamma &lt;- fitgamma(moths)
x1.p &lt;- profile(x1.gamma)
likelregions(x1.p)
# Compare with...
confint(x1.p)
</code></pre>

<hr>
<h2 id='moths'>
Moths caught with light traps at Rothamsted 1933-1936
</h2><span id='topic+moths'></span>

<h3>Description</h3>

<p>Number of captured individuals of species of nocturnal
macrolepidoptera (moths) in light traps at the Rothamsted Experimental
Station, UK between 1933 and 1936. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(moths)
</code></pre>


<h3>Format</h3>

<p>A unnamed vector of 240 integers.
</p>


<h3>Details</h3>

<p>This is one of the datasets that C. B. Williams used to show the
application of Fisher's log-series to describe the abundance of species
in a random sample of a biological community.
</p>


<h3>Source</h3>

<p>Column I of table 3 of Fisher et al. (1943), which did not
provide species names.
</p>


<h3>References</h3>

<p>Fisher, R.A., Corbert, A.S. and Williams, C.B. 1943. The Relation
between the number of species and the number of individuals in a random
sample of an animal population.
<em>The Journal of Animal Ecology, 12</em>: 42&ndash;58.
</p>

<hr>
<h2 id='octav-class'>Class <code>"octav"</code> for frequencies in abundance octaves</h2><span id='topic+octav-class'></span><span id='topic+lines+2Coctav-method'></span><span id='topic+plot+2Coctav+2CANY-method'></span><span id='topic+plot+2Coctav-method'></span><span id='topic+points+2Coctav-method'></span>

<h3>Description</h3>

<p> Data frame of frequencies of entities (usually species) in classes
of logarithm of abundances at base 2 (Preston's octaves).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'octav'
lines(x, prop=FALSE, mid=TRUE, ...)
## S4 method for signature 'octav'
plot(x, prop=FALSE, x.oct=FALSE, par.axis=list(), ...)
## S4 method for signature 'octav'
points(x, prop=FALSE, mid=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="octav-class_+3A_x">x</code></td>
<td>
<p>an object of class <code>octav</code></p>
</td></tr>
<tr><td><code id="octav-class_+3A_prop">prop</code></td>
<td>
<p>logical; if <kbd>TRUE</kbd> relative frequencies are returned.</p>
</td></tr>
<tr><td><code id="octav-class_+3A_x.oct">x.oct</code></td>
<td>
<p>logical; if <kbd>TRUE</kbd> axis labels are octave numbers, if
<kbd>FALSE</kbd> upper limit of abundance class are used as labels.</p>
</td></tr>
<tr><td><code id="octav-class_+3A_mid">mid</code></td>
<td>
<p>logical; if <kbd>TRUE</kbd> x coordinates of abundances are set
to the mid of each octave, if <kbd>FALSE</kbd> x coordinates of abundances
are the values of its octave (see examples)</p>
</td></tr>
<tr><td><code id="octav-class_+3A_par.axis">par.axis</code></td>
<td>
<p>list; further graphical parameters for the plot axes.</p>
</td></tr>
<tr><td><code id="octav-class_+3A_...">...</code></td>
<td>
<p>further parameters to be passed to <code>lines</code>, <code>points</code> or <code>plot</code>
functions (except axes in <code>plot</code>, which are set by <code>par.axis</code>.</p>
</td></tr>
</table>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("octav", ...)</code>,
but most often by a call to <code><a href="#topic+octav">octav</a></code> or <code><a href="#topic+octavpred">octavpred</a>.</code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>.Data</code>:</dt><dd><p>Object of class <code>"list"</code> a data frame of
three vectors: octave number (integer), which is the upper
limit of the class in log2; upper limit of the class in arithmetic
scale (numeric); number of cases in each class (numeric). </p>
</dd>
<dt><code>names</code>:</dt><dd><p>Object of class <code>"character"</code>; names of
the three vectors of <code>.Data</code>, <code>"octave"</code>,
<code>"upper"</code>, and <code>"Freq"</code>, respectively.  </p>
</dd>
<dt><code>row.names</code>:</dt><dd><p>Object of class
<code>"data.frameRowLabels"</code>; default line names for <code>.Data</code>. </p>
</dd>
<dt><code>.S3Class</code>:</dt><dd><p>Object of class <code>"character"</code>;
indicates inheritance from S3 class <code>data.frame</code>. </p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="methods.html#topic+data.frame-class">data.frame</a>"</code>, directly.
Class <code>"<a href="methods.html#topic+list-class">list</a>"</code>, by class &quot;data.frame&quot;, distance 2.
Class <code>"<a href="methods.html#topic+oldClass-class">oldClass</a>"</code>, by class &quot;data.frame&quot;, distance 2.
Class <code>"<a href="methods.html#topic+vector-class">vector</a>"</code>, by class &quot;data.frame&quot;, distance 3.
</p>


<h3>Methods</h3>


<dl>
<dt>lines</dt><dd><p><code>signature(x = "octav")</code>: adds frequency data
contained in the object as lines in an octave plot created by <code>plot</code> method.</p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "octav", y = "ANY")</code>: creates a
histogram of frequencies of species in each octave in the object, a.k.a 'Preston plot' </p>
</dd>
<dt>points</dt><dd><p><code>signature(x = "octav")</code>: adds frequency data
contained in the object as points in a octave plot created by <code>plot</code> method. </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andre Chalom and Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a></p>


<h3>References</h3>

<p>Magurran, A.E. 1989. <em>Ecological diversity and its measurement</em>.
Princenton University Press.
</p>
<p>Preston, F.W. 1948. The commonness and rarity of species.
<em>Ecology 29</em>: 254&ndash;283.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+octav">octav</a></code> to get an object of the class from a vector
of abundances; <code><a href="#topic+octavpred">octavpred</a></code> to get an <code>octav</code> object of
predicted abundances from a theoretical distribution;
man page of <code>prestonfit</code> in package <code>vegan</code> for a detailed account of
Preston's octaves and an alternative way to get octaves and model fitting.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Creates an octav object from an abundance vector
birds.oc &lt;- octav(birds)
moths.oc &lt;- octav(moths)

## default plot
plot(birds.oc)
## Octave values instead of abundances at x-axis
plot(moths.oc, x.oct=TRUE)

## Using line and argument prop to superpose two data sets
## (Fisher's et al moth data and Preston's bird data)
## mid=FALSE plots points at each octave value and not
## in the midclass (default, useful for histograms)
plot(moths.oc, col=NULL, border=NA, prop=TRUE, x.oct=TRUE, xlab="Octave")
lines(moths.oc, prop=TRUE,  mid=FALSE)
lines(birds.oc, prop=TRUE, mid=FALSE, col="red") 

</code></pre>

<hr>
<h2 id='octav-methods'>Frequencies of species in octaves</h2><span id='topic+octav'></span><span id='topic+octav+2Cfitsad-method'></span><span id='topic+octav+2Cfitrad-method'></span><span id='topic+octav+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Creates an object of <code>octav-class</code> with number of
species in octaves of abundances from a vector
of abundances or from a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>octav(x, oct, preston=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="octav-methods_+3A_x">x</code></td>
<td>
<p>a numerical vector of abundances or an object of class
<code>fitsad</code> or <code>fitrad</code>.</p>
</td></tr>
<tr><td><code id="octav-methods_+3A_oct">oct</code></td>
<td>
<p>integer vector; the octaves to tabulate abundances. Should
include all abundance values in <code>x</code>.
</p>
</td></tr>
<tr><td><code id="octav-methods_+3A_preston">preston</code></td>
<td>
<p>logical; if 'TRUE' use Preston method to count
frequencies (see details), if 'FALSE' class intervals are open on
the left (default in <code>cut</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Preston (1948) popularized the use of histograms with
logarithmic classes to depict species abundance distributions
(Magurran 1989). Preston used classes at log base two, which he called
&lsquo;octaves&rsquo; as their end-points double from one class to the other. In
Preston original method half of the species with abundances equal to the
limits of octaves are credited to the neighboring octave. If
<code>preston=TRUE</code> this non-standard method of class closure is
applied. In general this makes the histogram more
bell-shaped, as Preston expected (see example). </p>


<h3>Value</h3>

<p>an object of class <code>octav</code>, which is a data frame with three vectors:
</p>
<table>
<tr><td><code>octav</code></td>
<td>
<p>integer; octave number, which is the upper
limit of the class in log2.</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>numeric; upper limit of the class in arithmetic
scale.</p>
</td></tr>
<tr><td><code>Freq</code></td>
<td>
<p>integer or numeric; (relative) frequencies of species in
each class.</p>
</td></tr>  
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "numeric")</code></dt><dd><p>number of species in each octave
in a vector of species abundances.
</p>
</dd>
<dt><code>signature(x = "fitsad")</code></dt><dd><p>number of species in each octave
in the original abundance vector used to fit a model with <code>fitsad</code>.
</p>
</dd>
<dt><code>signature(x = "fitrad")</code></dt><dd><p>number of species in each octave
in the original abundance vector used to fit a model with <code>fitrad</code>.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Andre Chalom and Murilo Dantas Miranda
</p>


<h3>References</h3>

<p>Magurran, A.E. 1989. <em>Ecological diversity and its measurement</em>.
Princeton University Press.
</p>
<p>Preston, F.W. 1948. The commonness and rarity of species.
<em>Ecology 29</em>: 254&ndash;283.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+octav-class">octav-class</a></code> for methods to create an octave
plot; <code><a href="#topic+octavpred">octavpred</a></code> to get an <code>octav</code> object of
predicted abundances from a theoretical distribution;  <code><a href="#topic+fitsad-class">fitsad-class</a></code> and
<code><a href="#topic+fitrad-class">fitrad-class</a></code> objects, from which you can also get an
object of class <code>octav</code>; man page of <code>prestonfit</code> in package <span class="pkg">vegan</span> for a
detailed account of Preston's octaves and an alternative way to get
octaves and fitting of species abundances distributions.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## BCI tree data
(bci.oc1 &lt;- octav(bci, preston=TRUE))
## Comparing with standard class closure
par(mfrow=c(1,2))
plot(octav(bci), main="octav(bci, preston=FALSE)")
plot(bci.oc1, main="octav(bci, preston=TRUE)")
par(mfrow=c(1,1))
</code></pre>

<hr>
<h2 id='octavpred-methods'>Predicted frequencies of species in octaves</h2><span id='topic+octavpred'></span><span id='topic+octavpred+2Cfitrad+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2CANY+2Cmissing+2Cmissing-method'></span><span id='topic+octavpred+2Cfitsad+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2CANY+2Cmissing+2Cmissing-method'></span><span id='topic+octavpred+2Cmissing+2Ccharacter+2Cmissing+2Clist+2CANY+2CANY+2Cnumeric+2Cnumeric-method'></span><span id='topic+octavpred+2Cmissing+2Cmissing+2Ccharacter+2Clist+2CANY+2CANY+2Cnumeric+2Cnumeric-method'></span><span id='topic+octavpred+2Cnumeric+2Ccharacter+2Cmissing+2Clist+2CANY+2CANY+2Cmissing+2Cmissing-method'></span><span id='topic+octavpred+2Cnumeric+2Cmissing+2Ccharacter+2Clist+2CANY+2CANY+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>Creates an object of <code>octav-class</code> with the frequencies of
species in octaves of abundances predicted by a species abundance
distribution or by a rank-abundance distribution.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="octavpred-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code>fitrad</code> or <code>fitrad</code>;
fitted model of rank-abundance or species abundances
distributions. Alternatively a numeric vector abundances of species.
</p>
</td></tr>
<tr><td><code id="octavpred-methods_+3A_sad">sad</code>, <code id="octavpred-methods_+3A_rad">rad</code></td>
<td>
<p>character; root name of sad or rad distribution to
calculate expected percentiles. See <code><a href="#topic+fitsad">fitsad</a></code> and
<code><a href="#topic+fitrad">fitrad</a></code> for available distributions.
</p>
</td></tr>
<tr><td><code id="octavpred-methods_+3A_coef">coef</code></td>
<td>
<p>named list of numeric values; parameter values of the
distribution given in <code>sad</code> or <code>rad</code>.
Parameters should be named as in the corresponding density
function, and in the same order.
</p>
</td></tr>
<tr><td><code id="octavpred-methods_+3A_trunc">trunc</code></td>
<td>
<p>non-negative integer, <code>trunc &gt; min(x)</code>; truncation point
if fitted distribution is truncated.
</p>
</td></tr>
<tr><td><code id="octavpred-methods_+3A_oct">oct</code></td>
<td>
<p>integer vector; the octaves to tabulate abundances, see <a href="#topic+octav">octav</a>.
If not provided, the <code>octavpred</code> method will generate an educated guess.
</p>
</td></tr>
<tr><td><code id="octavpred-methods_+3A_s">S</code></td>
<td>
<p>positive integer; number of species in the sample.
</p>
</td></tr>
<tr><td><code id="octavpred-methods_+3A_n">N</code></td>
<td>
<p>positive integer; number of individuals in the sample.
</p>
</td></tr>
<tr><td><code id="octavpred-methods_+3A_preston">preston</code></td>
<td>
<p>logical. Should Preston original method be used? See <a href="#topic+octav">octav</a>.
</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "fitrad", sad = "missing", rad =
	"missing", coef = "missing", trunc = "missing", oct = "ANY", S =
	"missing", N = "missing")</code></dt><dd><p>number of species in each octave
predicted from a rank-abundance model fitted with function
<code>fitrad</code>.
</p>
</dd>
<dt><code>signature(object = "fitsad", sad = "missing", rad =
	"missing", coef = "missing", trunc = "missing", oct = "ANY", S =
	"missing", N = "missing")</code></dt><dd><p> number of species in each octave
predicted from an abundance distribution model fitted with function
<code>fitsad</code>.
</p>
</dd>
<dt><code>signature(object = "missing", sad = "character", rad =
	"missing", coef = "list", trunc = "ANY", oct = "ANY", S = "numeric",
	N = "numeric")</code></dt><dd><p>number of species in each octave predicted from an
abundance distribution named by <code>sad</code> with parameters
defined in <code>coef</code>. 
</p>
</dd>
<dt><code>signature(object = "numeric", sad = "character", rad =
	"missing", coef = "list", trunc = "ANY", oct = "ANY", S = "missing",
	N = "missing")</code></dt><dd><p>same as previous method, but with <code>S</code> and
<code>N</code> taken from a vector of abundances given by <code>object</code>.
</p>
</dd>
<dt><code>signature(object = "missing", sad = "missing", rad =
	"character", coef = "list", trunc = "ANY", oct = "ANY", S =
	"numeric", N = "numeric")</code></dt><dd><p>number of species in each octave predicted from an
rank-abundance distribution named by <code>rad</code> with parameters
defined in <code>coef</code>. 
</p>
</dd>
<dt><code>signature(object = "numeric", sad = "missing", rad =
	"character", coef = "list", trunc = "ANY", oct = "ANY", S =
	"missing", N = "missing")</code></dt><dd><p>same as previous method, but with <code>S</code> and
<code>N</code> taken from a vector of abundances given by <code>object</code>.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>, Murilo Dantas Miranda and
Andre Chalom.</p>


<h3>See Also</h3>

<p><code><a href="#topic+octav">octav</a></code> and <code><a href="#topic+octav-class">octav-class</a></code> for generic
function and methods to create an octave plot and details on abundance
octaves; <code><a href="#topic+fitsad-class">fitsad-class</a></code> and 
<code><a href="#topic+fitrad-class">fitrad-class</a></code> objects, from which you can also get an
object of class <code>octav</code> with observed and predicted values;
man page of <code>prestonfit</code> in package <span class="pkg">vegan</span> for a
detailed account of Preston's octaves and an alternative way to get
octaves and fitting of species abundances distributions.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Predicted frequencies from a fitted model
## meta-community zero-sum multinomial for BCI data
bci.mzsm &lt;- fitsad(bci, "mzsm")
bci.mzsm.oc &lt;- octavpred(bci.mzsm)
## Preston plot with observed and predicted frequencies
plot(octav(bci))
lines(bci.mzsm.oc)
## Alternative model: local zero-sum multinomial
## Alonso &amp; Mckane (Ecol. Lett. 2004, table 1) give theta = 44 and m = 0.15
bci.lzsm.oc &lt;- octavpred( bci, sad = "volkov", coef =list(theta = 44, m = 0.15, J=sum(bci)) )
## Adding predicted frequencies to the plot
lines(bci.lzsm.oc, col = "red")
</code></pre>

<hr>
<h2 id='okland'>
Abundances of land snail species in Norway
</h2><span id='topic+okland'></span>

<h3>Description</h3>

<p>Number of individuals of 21 species of land snails
caught in the vegetation in Norway, 1927. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(okland)
</code></pre>


<h3>Format</h3>

<p>A unnamed vector of 21 integers.
</p>


<h3>Details</h3>

<p>This is one of the data sets that Isao Motomura used to demonstrate his
&lsquo;law of geometric series&rsquo; of the abundance of species
in a sample of a biological community. The abundance values and fitted
series are in figure 2 of Motomura (1932).
</p>


<h3>Source</h3>

<p>Second column ('A') of table 5 of Okland (1930).
</p>


<h3>References</h3>

<p>Motomura, I. 1932. On the statistical treatment of communities
(in Japanese).  <em>Zool. Mag. (Tokyo) 44</em>: 379&ndash;383.  English translation in Appendix
I in Doi, H. and Mori, T. 2012. The discovery of species-abundance
distribution in an ecological community. <em>Oikos 122</em>: 179&ndash;182.
</p>
<p>Okland, F. 1930. Quantitative Untersuchungen der Landschneckenfauna
Norwegens. I. <em>Zoomorphology 16:</em> 748&ndash;804.
</p>

<hr>
<h2 id='plotprofmle-methods'>Log-likelihood profiles at original scale</h2><span id='topic+plotprofmle'></span><span id='topic+plotprofmle+2Cprofile.mle2-method'></span><span id='topic+plotprofmle+2Cmle2-method'></span><span id='topic+likelregions'></span><span id='topic+likelregions+2Cprofile.mle2-method'></span><span id='topic+likelregions+2Cmle2-method'></span>

<h3>Description</h3>

<p>Given a likelihood profile of a model (object of the class <code>profile.mle</code>
or <code>profile.mle2</code>), the function <code>plotprofmle</code> plots the relative log-likelihood profiles and the
plausibility intervals for each one of the (or selected ones) parameters of a model.
These same plausibility regions might be returned by <code>likelregions</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotprofmle(object, nseg=20, ratio=log(8), which=NULL, ask=NULL, 
    col.line="blue", varname=NULL, ...)
likelregions(object, nseg=100, ratio=log(8), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotprofmle-methods_+3A_object">object</code></td>
<td>

<p>list of profile data; object of class <code>mle2</code> or
<code>profile.mle2</code>.
</p>
</td></tr>
<tr><td><code id="plotprofmle-methods_+3A_nseg">nseg</code></td>
<td>

<p>positive integer; number of segments used by <code>spline</code> to
interpolate the line of log-likelihood profile
</p>
</td></tr>
<tr><td><code id="plotprofmle-methods_+3A_ratio">ratio</code></td>
<td>

<p>real positive; log-likelihood ratio that defines the likelihood
interval to be shown in the plot by <code>plotprofmle</code> or returned by 
<code>likelregions</code>. Set to <code>NULL</code> to suppress intervals
from being displayed.
</p>
</td></tr>
<tr><td><code id="plotprofmle-methods_+3A_which">which</code></td>
<td>

<p>vector of positive integers; if a subset of profiles is required,
the indexes of the mle's in <code>profobj</code> to be plotted.
</p>
</td></tr>
<tr><td><code id="plotprofmle-methods_+3A_ask">ask</code></td>
<td>

<p>logical; if <code>TRUE</code>, the user is _ask_ed before each plot, see par(ask=.)
</p>
</td></tr>
<tr><td><code id="plotprofmle-methods_+3A_col.line">col.line</code></td>
<td>

<p>name; line color for the plausibility interval.
</p>
</td></tr>
<tr><td><code id="plotprofmle-methods_+3A_varname">varname</code></td>
<td>

<p>vector of names; labels for the x-axis. If NULL defaults the names of
mle's in <code>profobj</code>.  
</p>
</td></tr>
<tr><td><code id="plotprofmle-methods_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Log-likelihood profile plots are the basic diagnostic for model
fitting by maximum likelihood methods. The profiles show the minimum of the log-likelihood function
for a given value of a focal parameter, near the maximum likelihood
estimate (mle) of this parameter. Profile objects in R (classes <code>profile.mle</code> and <code>profile.mle2</code>)
return transformed values of the likelihood function, which are based
on the deviance (=minus twice log-likelihood). These
values are called 'z' and are the signed square-root of the deviance  difference from the minimum deviance. As samples get
larger, z-profiles tends to be symmetrical V-shaped, and are used to calculate
confidence intervals using an approximation to the Chi-square
distribution (see details in Bolker (2008) and in the <span class="pkg">bbmle</span> vignette
(<code>vignette('mle2',package='bbmle')</code>).
</p>
<p>In its original form (e.g. Edwards 1972), likelihood profiles do not
use z-transformed values, and can be interpreted directly, even if they are
asymmetric. At the scale of the log-likelihood function, all
values of the parameters resulting in a negative log-likelihood
less or equal to a given value k are exp(k) times as plausible as
the mle. Hence, exp(k) is a likelihood ratio, and delimits a plausibility interval (or likelihood
interval) for the mle's. 
</p>
<p>Function <code>plotprofmle</code> plots profiles of the
negative log-likelihood functions, along with the limits of
likelihood interval for a given log-likelihood <code>ratio</code>.
</p>
<p>Function <code>likelregions</code> returns the limits of the likelihood intervals for each parameter.
This might be seen as an analog function for <code>confint</code>, and will return very similar values
for corresponding ratios if the profile is symmetric and monotonic. However, if the profile is
ill-behaved, <code>likelregions</code> might return more than one interval for each parameter, whereas
<code>confint</code> will return <code>NA</code> with a warning.
</p>


<h3>Methods</h3>


<dl>
<dt>plotprofmle</dt><dd><p><code>signature(object="profile.mle2")</code>:The preferred invocation for these methods.</p>
</dd>
<dt>plotprofmle</dt><dd><p><code>signature(object="mle2")</code>:A convenience wrapper
that calls <code>profile</code> on the mle2 object and runs the former
method.</p>
</dd>
<dt>likelregions</dt><dd><p><code>signature(object="profile.mle2")</code>:The preferred invocation for these methods.</p>
</dd>
<dt>likelregions</dt><dd><p><code>signature(object="mle2")</code>:A convenience wrapper that calls <code>profile</code> on the mle2 object and runs the former method.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>João L.F. Batista, Andre Chalom,
Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>
</p>


<h3>References</h3>

<p>Bolker, B. 2008. <em>Ecological Models and Data in R</em>. Princeton:
Princeton University Press.
</p>
<p>Edwards, A.W.F. 1972. <em>Likelihood &ndash; An Account of the
Statistical Concept of Likelihood and its Application to Scientific
Inference</em>. New York: Cambridge University Press.
</p>
<p>Royall, R.M. 2000. <em>Statistical Evidence: A Likelihood Paradigm</em>. London: Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code>profile.mle.class</code>, <code>mle</code>, <code>mle-class</code> from
<span class="pkg">stats</span>; <code>profile.mle2.class</code>, <code>mle2</code>, <code>mle2-class</code>
from <span class="pkg">bbmle</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>birds.pln &lt;- fitsad(birds, "lnorm")
birds.pln.p &lt;- profile(birds.pln)
par(mfrow=c(1,2))
plotprofmle(birds.pln.p)
par(mfrow=c(1,1))
likelregions(birds.pln.p)
# Compare with the confidence intervals
confint(birds.pln.p)
</code></pre>

<hr>
<h2 id='ppsad+20and+20pprad+20methods'>Percentile-percentile plots for species-abundance and
rank-abundance models</h2><span id='topic+ppsad'></span><span id='topic+pprad'></span><span id='topic+ppsad+2Cfitsad-method'></span><span id='topic+ppsad+2Cnumeric-method'></span><span id='topic+ppsad+2Cnumeric+2Ccharacter+2Clist-method'></span><span id='topic+ppsad+2Cnumeric+2Ccharacter+2Clist+2CANY-method'></span><span id='topic+pprad+2Cfitrad-method'></span><span id='topic+pprad+2Crad-method'></span><span id='topic+pprad+2Crad+2Ccharacter+2Clist-method'></span><span id='topic+pprad+2Crad+2Ccharacter+2Clist+2CANY+2Ccharacter-method'></span><span id='topic+pprad+2Cnumeric+2Ccharacter+2Clist+2CANY+2Ccharacter-method'></span><span id='topic+pprad+2Cnumeric-method'></span><span id='topic+pprad+2Cnumeric+2Ccharacter+2Clist-method'></span>

<h3>Description</h3>

<p>Plots empirical percentiles vs corresponding theoretical values
expected by a model for species abundances (SAD) or a model for species abundance
ranks (RAD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitsad'
ppsad(x, plot=TRUE, line=TRUE, ...)
## S4 method for signature 'numeric'
ppsad(x, sad, coef, trunc=NA, plot=TRUE,
line=TRUE, ...)
## S4 method for signature 'fitrad'
pprad(x, plot=TRUE, line=TRUE, ...)
## S4 method for signature 'rad'
pprad(x, rad, coef, trunc=NA, plot=TRUE, line=TRUE, ...)
## S4 method for signature 'numeric'
pprad(x, rad, coef, trunc=NA, plot=TRUE, line=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppsad+2B20and+2B20pprad+2B20methods_+3A_x">x</code></td>
<td>
 
<p>a numeric vector of abundances of
species or a fitted sad/rad model (object of <code><a href="#topic+fitsad-class">fitsad-class</a></code>
or <code><a href="#topic+fitrad-class">fitrad-class</a></code>, respectively). For <code>pprad</code> this
argument can be also a rank-abundance table of <a href="#topic+rad-class">rad-class</a>.
</p>
</td></tr>
<tr><td><code id="ppsad+2B20and+2B20pprad+2B20methods_+3A_sad">sad</code>, <code id="ppsad+2B20and+2B20pprad+2B20methods_+3A_rad">rad</code></td>
<td>
<p>character; root name of sad or rad
distribution to calculate expected percentiles. See <code><a href="#topic+fitsad">fitsad</a></code> and
<code><a href="#topic+fitrad">fitrad</a></code> for available distributions.
</p>
</td></tr>
<tr><td><code id="ppsad+2B20and+2B20pprad+2B20methods_+3A_coef">coef</code></td>
<td>
<p>named list of numeric values; parameter values of the
distribution given in <code>sad</code> or <code>rad</code>.
Parameters should be named as in the corresponding density
function, and in the same order
</p>
</td></tr>
<tr><td><code id="ppsad+2B20and+2B20pprad+2B20methods_+3A_trunc">trunc</code></td>
<td>
<p>non-negative integer, trunc &gt; min(x); truncation point to fit a
truncated distribution.
</p>
</td></tr>
<tr><td><code id="ppsad+2B20and+2B20pprad+2B20methods_+3A_plot">plot</code></td>
<td>

<p>logical; if 'TRUE' a percentile-percentile plot is produced. If not,
only a data frame with theoretical and empirical values for percentiles of
the data is invisibly returned.
</p>
</td></tr>
<tr><td><code id="ppsad+2B20and+2B20pprad+2B20methods_+3A_line">line</code></td>
<td>

<p>logical; if 'TRUE' and <code>plot</code> is 'TRUE', the equivalence line y=x with
<code>abline(0,1)</code> is added to the plot. If not, no line is drawn.
</p>
</td></tr>
<tr><td><code id="ppsad+2B20and+2B20pprad+2B20methods_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to the <code>plot</code> function.
</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt>ppsad</dt><dd><p><code>signature(x = "fitsad", sad = "missing", coef =
	"missing", trunc = "missing", plot="ANY", line="ANY")</code>:
quantile-quantile plot for a fitted model of species abundances (a
<code><a href="#topic+fitsad-class">fitsad-class</a></code> object). Only argument <code>x</code> should be provided.
</p>
</dd>
<dt>ppsad</dt><dd><p><code>signature(x = "numeric", sad = "character", coef =
	"list", trunc = "ANY", plot="ANY", line="ANY")</code>:
quantile-quantile plot of a numeric vector of abundances (<code>x</code>) vs a species
abundance distributions defined by the following arguments.
</p>
</dd>
<dt>pprad</dt><dd><p><code>signature(x = "fitrad", rad = "missing", coef =
	"missing", trunc = "missing", plot="ANY", line="ANY")</code>:
quantile-quantile plot for a fitted model of species abundances
ranks (a <code><a href="#topic+fitrad-class">fitrad-class</a></code> object). Only argument <code>x</code> should be provided.
</p>
</dd>
<dt>pprad</dt><dd><p><code>signature(x = "rad", rad = "character", coef =
	"list", trunc = "ANY", plot="ANY", line="ANY")</code>:
quantile-quantile plot of a table of abundance ranks (<code>x</code>) vs a species
rank-abundance distribution defined by the following arguments.
</p>
</dd>    
<dt>pprad</dt><dd><p><code>signature(x = "numeric", rad = "character", coef =
	"list", trunc = "ANY", plot="ANY", line="ANY")</code>:
quantile-quantile plot of a numeric vector of abundances (<code>x</code>) vs a species
rank-abundance distribution defined by the following arguments.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>Thas, O. 2010. Comparing distributions. Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## An example with SADs
data(moths)
## fits log-series distribution to abundance data
moths.ls &lt;- fitsad(moths, "ls")
## fits lognormal distribution truncated at 0.5
moths.ln &lt;- fitsad(moths,"lnorm", trunc=0.5)
## Plots with the model object and with abundance vector 
par(mfrow=c(2,2))
ppsad(moths.ls)
ppsad(moths, sad="ls", coef=as.list(coef(moths.ls)) )
ppsad(moths.ln)
ppsad(moths, sad="lnorm", coef=as.list(coef(moths.ln)), trunc=0.5)
par(mfrow=c(1,1))

## An example with RADs
data(okland)
## Fits broken-stick RAD model
ok.bs &lt;- fitrad(okland, "rbs")
## Fits geometric series RAD model
ok.gs &lt;- fitrad(okland, "gs")
## Plots with the model object and with the abundance vector 
par( mfrow=c(2, 2) )
pprad(ok.bs)
pprad(okland, rad="rbs", coef=as.list(coef(ok.bs)))
pprad(ok.gs)
pprad(okland, rad="gs", coef=as.list(coef(ok.gs)))
par(mfrow=c(1,1))
</code></pre>

<hr>
<h2 id='pred.logser'>Predicted number of species by Fisher's Logseries</h2><span id='topic+pred.logser'></span>

<h3>Description</h3>

<p>Given a vector of species abundances, Fisher's alpha and total number of
species and individuals in a sample, returns the number of
species for each abundance value expected by the Fisher's logseries model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred.logser(x, alpha, J, S)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred.logser_+3A_x">x</code></td>
<td>

<p>Vector of (non-negative integer) abundances of species in a sample.
</p>
</td></tr>
<tr><td><code id="pred.logser_+3A_alpha">alpha</code></td>
<td>

<p>Fisher's alpha, the single parameter of log-series.
</p>
</td></tr>
<tr><td><code id="pred.logser_+3A_j">J</code></td>
<td>

<p>Total number of individuals in the sample.
</p>
</td></tr>
<tr><td><code id="pred.logser_+3A_s">S</code></td>
<td>

<p>Total number of species in the sample.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Fisher logseries is a limiting case of the Negative Binomial where
the dispersion parameter of the negative binomial tends to zero. It
was originally proposed by Fisher (1943) to relate the expected number
of species in a sample from a biological community to the sample size as:
</p>
<p>S = alpha * log(1 + J/alpha)
</p>
<p>Where alpha is the single parameter of the logseries distribution,
often used as a diversity index. From this relation follows that the
expected number of species with x individuals in the sample is
</p>
<p>S(x) = alpha*X^x/x
</p>
<p>Where X is a function of alpha and J, that tends to one as the sample
size J increases:
</p>
<p>X = J / (alpha + J)
</p>
<p>Since the logseries model is a function that relates S to J using a
single parameter (alpha), once two of
these quantities are known the remaining is determined. So the function
allows the input of any two among S, J and alpha. If the
user does not provide at least two of these values, an error message
is returned.
</p>
<p>This function returns the expected number of species with abundance x,
which is
</p>
<p>E[S(x)] = x^(-1)*alpha*X^x
</p>


<h3>Value</h3>

<p>A (vector) of expected number of species to each abundance provided by
argument <code>x</code>
</p>


<h3>Author(s)</h3>

<p>Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a>.
</p>


<h3>References</h3>

<p>Pielou, E.C. 1977. <em>Mathematical Ecology</em>. New York: John Wiley
and Sons.
</p>
<p>Fisher, R.A, Corbert, A.S. and Williams, C.B. 1943. The Relation
between the number of species and the number of individuals in a
random sample of an animal population. <em>The Journal of Animal Ecology, 12(1)</em>: 42&ndash;58.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dls">dls</a></code> for the log-series distribution;  and
<code><a href="#topic+fitls">fitls</a></code>, <code>fishers.alpha</code> in package <span class="pkg">untb</span> and <code>fisherfit</code>
in package <span class="pkg">vegan</span> for fitting the log-series to abundance data. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(moths) # Willians' moth data
pred.logser(1:5, J=sum(moths), S=length(moths)) #predicted
table(moths)[1:5] # observed 
</code></pre>

<hr>
<h2 id='qqsad+20and+20qqrad+20methods'>Quantile-quantile plots for species-abundance and
rank-abundance models</h2><span id='topic+qqsad'></span><span id='topic+qqrad'></span><span id='topic+qqsad+2Cfitsad-method'></span><span id='topic+qqsad+2Cinteger-method'></span><span id='topic+qqsad+2Cnumeric-method'></span><span id='topic+qqsad+2Cnumeric+2Ccharacter+2Clist+2CANY+2CANY-method'></span><span id='topic+qqrad+2Cfitrad-method'></span><span id='topic+qqrad+2Cfitrad+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic+qqrad+2Cinteger-method'></span><span id='topic+qqrad+2Cnumeric-method'></span><span id='topic+qqrad+2Cnumeric+2Ccharacter+2Clist+2CANY-method'></span><span id='topic+qqrad+2Cnumeric+2Ccharacter+2Clist+2CANY+2Ccharacter-method'></span><span id='topic+qqrad+2Crad-method'></span><span id='topic+qqrad+2Crad+2Ccharacter+2Clist+2CANY-method'></span><span id='topic+qqrad+2Crad+2Ccharacter+2Clist+2CANY+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Plots empirical quantiles vs corresponding theoretical values
expected by a model for species abundances (SAD) or a model for species abundance
ranks (RAD).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'fitsad'
qqsad(x, plot=TRUE, line=TRUE, ...)
## S4 method for signature 'numeric'
qqsad(x, sad, coef, trunc=NA, distr, plot=TRUE,
line=TRUE, ...)
## S4 method for signature 'fitrad'
qqrad(x, plot=TRUE, line=TRUE, ...)
## S4 method for signature 'rad'
qqrad(x, rad, coef, trunc=NA, plot=TRUE, line=TRUE, ...)
## S4 method for signature 'numeric'
qqrad(x, rad, coef, trunc=NA, plot=TRUE, line=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qqsad+2B20and+2B20qqrad+2B20methods_+3A_x">x</code></td>
<td>
 
<p>a numeric vector of abundances of
species or a fitted sad/rad model (object of <code><a href="#topic+fitsad-class">fitsad-class</a></code>
or <code><a href="#topic+fitrad-class">fitrad-class</a></code>, respectively). For <code>qqrad</code> this
argument can be also a rank-abundance table of <code><a href="#topic+rad-class">rad-class</a></code>.
</p>
</td></tr>
<tr><td><code id="qqsad+2B20and+2B20qqrad+2B20methods_+3A_sad">sad</code>, <code id="qqsad+2B20and+2B20qqrad+2B20methods_+3A_rad">rad</code></td>
<td>
<p>character; root name of sad or rad
distribution to calculate expected percentiles. See <code><a href="#topic+fitsad">fitsad</a></code> and
<code><a href="#topic+fitrad">fitrad</a></code> for available distributions.
</p>
</td></tr>
<tr><td><code id="qqsad+2B20and+2B20qqrad+2B20methods_+3A_coef">coef</code></td>
<td>
<p>named list of numeric values; parameter values of the
distribution given in <code>sad</code> or <code>rad</code>.
Parameters should be named as in the corresponding density
function, and in the same order
</p>
</td></tr>
<tr><td><code id="qqsad+2B20and+2B20qqrad+2B20methods_+3A_trunc">trunc</code></td>
<td>
<p>non-negative integer, <code>trunc &gt; min(x)</code>; truncation point to fit a
truncated distribution.
</p>
</td></tr>
<tr><td><code id="qqsad+2B20and+2B20qqrad+2B20methods_+3A_distr">distr</code></td>
<td>
<p>Deprecated since sads 0.2.4. See <code><a href="#topic+distr">distr</a></code> function</p>
</td></tr>
<tr><td><code id="qqsad+2B20and+2B20qqrad+2B20methods_+3A_plot">plot</code></td>
<td>

<p>logical; if <kbd>TRUE</kbd> a percentile-percentile plot is produced. If not,
only a data frame with theoretical and empirical values for percentiles of
the data is invisibly returned.
</p>
</td></tr>
<tr><td><code id="qqsad+2B20and+2B20qqrad+2B20methods_+3A_line">line</code></td>
<td>

<p>logical; if <kbd>TRUE</kbd> and <code>plot</code> is <kbd>TRUE</kbd>, the equivalence line y=x with
<code>abline(0,1)</code> is added to the plot. If not, no line is drawn.
</p>
</td></tr>
<tr><td><code id="qqsad+2B20and+2B20qqrad+2B20methods_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to the <code>plot</code> function.
</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt>qqsad</dt><dd><p><code>signature(x = "fitsad", sad = "missing", coef =
	"missing", trunc = "missing", distr = "missing", plot="ANY", line="ANY")</code>:
quantile-quantile plot for a fitted model of species abundances (a
<code><a href="#topic+fitsad-class">fitsad-class</a></code> object). Only argument <code>x</code> should be provided
</p>
</dd>
<dt>qqsad</dt><dd><p><code>signature(x = "numeric", sad = "character", coef =
	"list", trunc = "ANY", distr = "ANY", plot="ANY", line="ANY")</code>:
quantile-quantile plot of a numeric vector of abundances (<code>x</code>) vs a species
abundance distributions defined by the following arguments.
</p>
</dd>
<dt>qqrad</dt><dd><p><code>signature(x = "fitrad", rad = "missing", coef =
	"missing", trunc = "missing", plot="ANY", line="ANY")</code>:
quantile-quantile plot for a fitted model of species abundances
ranks (a <code><a href="#topic+fitrad-class">fitrad-class</a></code> object). Only argument <code>x</code> should be provided
</p>
</dd>
<dt>qqrad</dt><dd><p><code>signature(x = "rad", rad = "character", coef =
	"list", trunc = "ANY", plot="ANY", line="ANY")</code>:
quantile-quantile plot of a table of abundance ranks (<code>x</code>) vs a species
rank-abundance distribution defined by the following arguments.
</p>
</dd>    
<dt>qqrad</dt><dd><p><code>signature(x = "numeric", rad = "character", coef =
	"list", trunc = "ANY", plot="ANY", line="ANY")</code>:
quantile-quantile plot of a numeric vector of abundances (<code>x</code>) vs a species
rank-abundance distribution defined by the following arguments.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda.</p>


<h3>References</h3>

<p>Thas, O. 2010. Comparing distributions. Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## An example with SADs
data(moths)
## fits log-series distribution to abundance data
moths.ls &lt;- fitsad(moths, "ls")
## fits lognormal distribution truncated at 0.5
moths.ln &lt;- fitsad(moths,"lnorm", trunc=0.5)
## Plots with the model object and with abundance vector 
par(mfrow=c(2,2))
qqsad(moths.ls)
qqsad(moths, sad="ls", coef=as.list(coef(moths.ls)))
qqsad(moths.ln)
qqsad(moths, sad="lnorm", coef=as.list(coef(moths.ln)), trunc=0.5)
par(mfrow=c(1,1))

## An example with RADs
data(okland)
## Fits broken-stick RAD model
ok.bs &lt;- fitrad(okland, "rbs")
## Fits geometric series RAD model
ok.gs &lt;- fitrad(okland, "gs")
## Plots with the model object and with the abundance vector 
par( mfrow=c(2, 2) )
qqrad(ok.bs)
qqrad(okland, rad="rbs", coef=as.list(coef(ok.bs)))
qqrad(ok.gs)
qqrad(okland, rad="gs", coef=as.list(coef(ok.gs)))
par(mfrow=c(1,1))
</code></pre>

<hr>
<h2 id='rad'>Rank-abundance data frame</h2><span id='topic+rad'></span>

<h3>Description</h3>

<p>Creates a data frame with ranked abundances of <code>rad-class</code> from a vector
of abundances, histogram, or fitted model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rad(x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rad_+3A_x">x</code></td>
<td>
<p>a numerical vector of abundances or an histogram, or an object of class
<code>fitsad</code>, <code>fitrad</code> or <code>fitsadC</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of <code><a href="#topic+rad-class">rad-class</a></code>, which is a data frame with two vectors:
</p>
<table>
<tr><td><code>rank</code></td>
<td>
<p>integer; abundance rank of each species (integer), from most abundant
(rank=1) to the least abundant (rank=length(rank))</p>
</td></tr>
<tr><td><code>abund</code></td>
<td>
<p>numeric; abundance of each species</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda.
</p>


<h3>References</h3>

<p>Whittaker, R. H. 1965, Dominance and Diversity in Land Plant
Communities. <em>Science, 147</em>: 250&ndash;260.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rad-class">rad-class</a></code> for methods to create a rank-abundance
data frame; <code><a href="#topic+radpred">radpred</a></code> to get a <code>rad-class</code> object of
predicted abundances from a theoretical distribution;
<code><a href="#topic+fitsad-class">fitsad-class</a></code> , <code><a href="#topic+fitsadC-class">fitsadC-class</a></code> and
<code><a href="#topic+fitrad-class">fitrad-class</a></code> objects, from which you can also get an
object of class <code>rad</code>; <code><a href="#topic+qqrad">qqrad</a></code> for quantile-quantile
plots from a <code>rad-class</code> object, and <code><a href="#topic+pprad">pprad</a></code> for
percentile-percentile plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## rank-abundance plot
plot(rad(okland))

</code></pre>

<hr>
<h2 id='rad-class'>Class <code>"rad"</code> for rank-abundance data</h2><span id='topic+rad-class'></span><span id='topic+lines+2Crad-method'></span><span id='topic+plot+2Crad-method'></span><span id='topic+plot+2Crad+2CANY-method'></span><span id='topic+points+2Crad-method'></span>

<h3>Description</h3>

<p>Data frame of ranked abundances of species
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'rad'
lines(x, prop=FALSE, ...)
## S4 method for signature 'rad'
plot(x, prop=FALSE, ...)
## S4 method for signature 'rad'
points(x, prop=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rad-class_+3A_x">x</code></td>
<td>
<p>an object of class <code>rad</code></p>
</td></tr>
<tr><td><code id="rad-class_+3A_prop">prop</code></td>
<td>
<p>logical; if <kbd>TRUE</kbd> relative abundances are returned.</p>
</td></tr>
<tr><td><code id="rad-class_+3A_...">...</code></td>
<td>
<p>further parameters to be passed to <code>lines</code>, <code>points</code> or <code>plot</code>
functions.</p>
</td></tr>
</table>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("rad", ...)</code>, but
most often by a call to <code><a href="#topic+rad">rad</a></code> or <code><a href="#topic+radpred">radpred</a></code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>.Data</code>:</dt><dd><p>Object of class <code>"list"</code>; a data frame of
two vectors: abundance rank of each species (integer), from most abundant
(rank=1) to the least abundant (rank=length(rank)); abundance of each
species (numeric)</p>
</dd>
<dt><code>names</code>:</dt><dd><p>Object of class <code>"character"</code>; names of
the two vectors of <code>.Data</code>, <code>"rank"</code> and <code>"abund"</code>, respectively. </p>
</dd>
<dt><code>row.names</code>:</dt><dd><p>Object of class
<code>"data.frameRowLabels"</code>; default line names for <code>.Data</code>;
integer indexes from 1 to <code>nrow(.Data)</code>.</p>
</dd>
<dt><code>.S3Class</code>:</dt><dd><p>Object of class <code>"character"</code>;
indicates inheritance from S3 class <code>data.frame</code>.</p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"<a href="methods.html#topic+data.frame-class">data.frame</a>"</code>, directly.
Class <code>"<a href="methods.html#topic+list-class">list</a>"</code>, by class &quot;data.frame&quot;, distance 2.
Class <code>"<a href="methods.html#topic+oldClass-class">oldClass</a>"</code>, by class &quot;data.frame&quot;, distance 2.
Class <code>"<a href="methods.html#topic+vector-class">vector</a>"</code>, by class &quot;data.frame&quot;, distance 3.
</p>


<h3>Methods</h3>


<dl>
<dt>lines</dt><dd><p><code>signature(x = "rad")</code>: adds rank-abundance data
contained in the object as lines in rank-abundance plots created by
<code>plot</code> method.</p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "rad", y = "ANY")</code>: creates a
rank-abundance plot from data in the object.</p>
</dd>
<dt>points</dt><dd><p><code>signature(x = "rad")</code>: adds rank-abundance data
contained in the object as points in rank-abundance plots created by
<code>plot</code> method. </p>
</dd>
<dt>pprad</dt><dd><p><code>signature(x = "rad", rad = "character", coef =
    	"list")</code>: percentile-percentile plot, see <code><a href="#topic+pprad">pprad</a></code>. </p>
</dd>
<dt>qqrad</dt><dd><p><code>signature(x = "rad", rad = "character", coef =
    	"list", trunc = "ANY")</code>:  quantile-quantile plot, see
<code><a href="#topic+qqrad">qqrad</a></code>.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda
</p>


<h3>References</h3>

<p>Whittaker, R. H. 1965, Dominance and Diversity in Land Plant
Communities. <em>Science, 147</em>: 250&ndash;260. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rad">rad</a></code> to get an object of the class from a vector
of abundances or from an histogram; <code><a href="#topic+radpred">radpred</a></code> to get a
<code>rad-class</code> object of predicted abundances from a theoretical
distribution, <code><a href="#topic+qqrad">qqrad</a></code> for quantile-quantile plots from a
<code>rad-class</code> object, and <code><a href="#topic+pprad">pprad</a></code> for
percentile-percentile plots.  </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Creates a rad object from a vector of abundances
birds.rad &lt;- rad(birds)

## Rank-abundance plot
plot(birds.rad)

## Same, with non-default graphical parameters
plot(birds.rad, pch=19, xlab="Abundance rank of species")

## Adding points from another data set
points(rad(okland), pch=19)
</code></pre>

<hr>
<h2 id='radpred-methods'>Predicted ranked abundance of species</h2><span id='topic+radpred'></span><span id='topic+radpred+2Cfitrad+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic+radpred+2Cfitsad+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic+radpred+2CfitsadC+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing+2Cmissing-method'></span><span id='topic+radpred+2Cmissing+2Ccharacter+2Cmissing+2Clist+2CANY+2CANY+2Cnumeric+2Cnumeric-method'></span><span id='topic+radpred+2Cmissing+2Cmissing+2Ccharacter+2Clist+2CANY+2Cmissing+2Cnumeric+2Cnumeric-method'></span><span id='topic+radpred+2Cnumeric+2Ccharacter+2Cmissing+2Clist+2CANY+2CANY+2Cmissing+2Cmissing-method'></span><span id='topic+radpred+2Cnumeric+2Cmissing+2Ccharacter+2Clist+2CANY+2Cmissing+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>Creates an object of <code>rad-class</code> with the ranked abundances
predicted by a species abundance distribution or a rank-abundance distribution.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="radpred-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code>fitrad</code> or <code>fitsad</code>;
fitted model of rank-abundance or species abundances
distributions. Alternatively a numeric vector abundances of
species. 
</p>
</td></tr>
<tr><td><code id="radpred-methods_+3A_sad">sad</code>, <code id="radpred-methods_+3A_rad">rad</code></td>
<td>
<p>character; root name of sad or rad distribution to
calculate expected percentiles. See <code><a href="#topic+fitsad">fitsad</a></code> and
<code><a href="#topic+fitrad">fitrad</a></code> for available distributions.
</p>
</td></tr>
<tr><td><code id="radpred-methods_+3A_coef">coef</code></td>
<td>
<p>named list of numeric values; parameter values of the
distribution given in <code>sad</code> or <code>rad</code>.
Parameters should be named as in the corresponding density
function, and in the same order.
</p>
</td></tr>
<tr><td><code id="radpred-methods_+3A_trunc">trunc</code></td>
<td>
<p>non-negative integer, trunc &gt; min(x); truncation point
if fitted distribution is truncated.
</p>
</td></tr>
<tr><td><code id="radpred-methods_+3A_distr">distr</code></td>
<td>
<p>Deprecated since sads 0.2.4. See <code><a href="#topic+distr">distr</a></code> function</p>
</td></tr>
<tr><td><code id="radpred-methods_+3A_s">S</code></td>
<td>
<p>positive integer; number of species in the sample.
</p>
</td></tr>
<tr><td><code id="radpred-methods_+3A_n">N</code></td>
<td>
<p>positive integer; number of individuals in the sample.
</p>
</td></tr>
</table>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "fitrad", sad = "missing", rad =
	"missing", coef = "missing", trunc = "missing", distr = "missing", S =
	"missing", N = "missing")</code></dt><dd>
<p>ranked abundances of species
predicted from a rank-abundance model fitted with function
<code>fitrad</code>.
</p>
</dd>
<dt><code>signature(object = "fitsad", sad = "missing", rad =
	"missing", coef = "missing", trunc = "missing", distr = "missing",
	S = "missing", N = "missing")</code></dt><dd>
<p>ranked abundances of species
predicted from a abundance distribution  model fitted with function
<code>fitsad</code>.
</p>
</dd>
<dt><code>signature(object = "fitsadC", sad = "missing", rad =
	"missing", coef = "missing", trunc = "missing", distr = "missing",
	S = "missing", N = "missing")</code></dt><dd>
<p>ranked abundances of species
predicted from a abundance distribution  model fitted with function
<code>fitsadC</code>.
</p>
</dd>
<dt><code>signature(object = "missing", sad = "character", rad =
	"missing", coef = "list", trunc = "ANY", distr = "ANY", S =
	"numeric", N = "numeric")</code></dt><dd>
<p>ranked abundances of species predicted
from abundance distribution named by <code>sad</code> with parameters
defined in <code>coef</code>. 
</p>
</dd>
<dt><code>signature(object = "numeric", sad = "character", rad =
	"missing", coef = "list", trunc = "ANY", distr = "ANY", S =
	"missing", N = "missing")</code></dt><dd>
<p>same as previous method, but with
<code>S</code> and <code>N</code> taken from a vector of abundances given by
<code>object</code>.
</p>
</dd>
<dt><code>signature(object = "missing", sad = "missing", rad =
	"character", coef = "list", trunc = "ANY", distr = "missing", S =
	"numeric", N = "numeric")</code></dt><dd>
<p>ranked abundances of species predicted from a rank-abundance
distribution  named by <code>rad</code> with parameters defined in
<code>coef</code>.
</p>
</dd>
<dt><code>signature(object = "numeric", sad = "missing", rad =
	"character", coef = "list", trunc = "ANY", distr = "missing", S
	= "missing", N = "missing")</code></dt><dd>
<p>same as previous method, but with
<code>S</code> and <code>N</code> taken from a vector of abundances given by
<code>object</code>. 
</p>
</dd>
</dl>


<h3>Note</h3>

<p>The rank-abundance function is the inverse of the quantile
function of the species abundance distribution (May 1975). <code>radpred</code>
uses numeric interpolation with <code>approxfun</code> to find quantiles,
instead of the slower bisection method used in many quantile functions in
the package <span class="pkg">sads</span>. Hence results from <code>radpred</code> and from the
quantile functions may not match exactly.
</p>


<h3>Author(s)</h3>

<p>Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Murilo Dantas Miranda
</p>


<h3>References</h3>

<p>May, R.M. 1975. Patterns of Species Abundance and Diversity. In
Cody, M.L. and Diamond, J.M. (Eds) <em>Ecology and Evolution of
Communities</em>. Harvard University Press. pp 81&ndash;120.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Predicted frequencies from a fitted model
## meta-community zero-sum multinomial for BCI data
moths.mzsm &lt;- fitsad(moths, "mzsm")
moths.mzsm.r &lt;- radpred(moths.mzsm)
## Rank-abundance plot with observed and predicted frequencies
plot(rad(moths))
lines(moths.mzsm.r)
## Alternative model: local zero-sum multinomial
## Alonso &amp; Mckane (Ecol. Lett. 2004, table 1) give theta = 41 and m = 0.77
moths.lzsm.r &lt;- 
  radpred( moths, sad = "volkov",  
           coef =list(theta = 41, m = 0.77, J=sum(moths)) 
         )
## Adding predicted frequencies to the plot
lines(moths.lzsm.r, col = "red")
</code></pre>

<hr>
<h2 id='rsad'>Sampling from a species abundance distribution
</h2><span id='topic+rsad'></span>

<h3>Description</h3>

<p>A given number of realizations of a probability distribution (species
abundances in a community) is sampled with replacement by a Poisson or
Negative Binomial process, or without replacement by a hypergeometric process. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsad(S = NULL, frac, sad = c("bs","gamma","geom","lnorm","ls","mzsm","nbinom","pareto",
                             "poilog","power", "powbend", "volkov", "weibull"), 
                 coef, trunc=NaN, sampling=c("poisson", "nbinom", "hypergeometric"), 
                 k, zeroes=FALSE, ssize=1) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsad_+3A_s">S</code></td>
<td>

<p>positive integer; number of species in the community, which is the number of random deviates
generated by the probability distribution given by argument <code>sad</code>. Notice that for some
distributions, the value of <code>S</code> is deduced from the coefficients, so this value is ignored
(see details).
</p>
</td></tr>
<tr><td><code id="rsad_+3A_frac">frac</code></td>
<td>

<p>single numeric <code>0 &lt; frac &lt;= 1</code>; fraction of the community
sampled. Usually the proportion of total number of individuals or of
total area or volume sampled. Notice that assumptions of Poisson and binomial sampling
are only valid for small values of <code>frac</code> (see Details).
</p>
</td></tr>
<tr><td><code id="rsad_+3A_sad">sad</code></td>
<td>

<p>numeric; a vector of positive real numbers depicting abundances of
species in a community or sample OR
character; root name of community sad distribution - e.g., <kbd>lnorm</kbd>
for the lognormal distribution <code>rlnorm</code>; <kbd>geom</kbd> for the geometric distribution
<code>rgeom</code> or <kbd>ls</kbd> for the lognormal distribution <code><a href="base.html#topic+ls">ls</a></code>.
</p>
</td></tr>  
<tr><td><code id="rsad_+3A_coef">coef</code></td>
<td>

<p>list with named arguments to be passed to the probability function defined by the
argument <kbd>sad</kbd>.
</p>
</td></tr>
<tr><td><code id="rsad_+3A_trunc">trunc</code></td>
<td>

<p>The truncation point at which the random distribution defined in
argument <kbd>sad</kbd> should be truncated; see <code><a href="#topic+rtrunc">rtrunc</a></code>.
The default value of <code>NaN</code> means that no truncation is performed.
</p>
</td></tr>
<tr><td><code id="rsad_+3A_sampling">sampling</code></td>
<td>

<p>character; if <kbd>poisson</kbd> the sampling process is Poisson (independent sampling of
individuals with replacement); if <kbd>nbinom</kbd> negative binomial
sampling is used to simulate aggregation of individuals in sampling
units with replacement;
finally, <kbd>hypergeometric</kbd> samples a fixed number of <code>frac</code> times the number of 
individuals in the simulated community, without replacement. Partial matching is allowed.
</p>
</td></tr>
<tr><td><code id="rsad_+3A_k">k</code></td>
<td>

<p>positive; size parameter for the sampling binomial negative. This parameter is ignored for other sampling
techniques.
</p>
</td></tr>
<tr><td><code id="rsad_+3A_zeroes">zeroes</code></td>
<td>

<p>logical; should zero values be included in the returned vector?
</p>
</td></tr>
<tr><td><code id="rsad_+3A_ssize">ssize</code></td>
<td>

<p>positive integer; sample size: number of draws taken from the community.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates one or more random samples taken from a community with <code>S</code>
species. The expected species abundances in the sampled community can
(i) follow a
probability distribution given by the argument <code>sad</code> or (ii) be a
numeric vector provided by the user through this same argument.
A fraction <code>frac</code> of
the whole set of units that made up the community (usually
individuals) is sampled. Hence the expected abundance in the sample of each
species is <code>frac*n</code>, where n is the species' expected abundance in the
community.
</p>
<p>Three sampling processes can be simulated.
Sampling with replacement can be done with Poisson
(individuals are sampled independently) or negative binomial sampling
(where individuals of each species are aggregated over sampling
units). The &quot;hypergeometric&quot; sampling scheme draws <code>frac * n</code>
individuals without replacement.
</p>
<p>For Poisson and negative binomial schemes the species abundances in
the sample are statistically independent.
In general terms, these two sampling schemes takes a Poisson or negative
binomial sampling with replacement of a vector of <code>S</code> realizations of a random variable,
with the sampling intensity given by <code>frac</code>. The resulting values are
realizations of a Poisson (or a Negative Binomial) random variable where the
parameter that corresponds to the mean (=expected value of the variable) follows a probability
distribution or the numeric vector given by the argument <code>sad</code>. Because these two
sampling schemes assume replacement but the sampled community is
finite, they are valid only when the
fraction of the sampled community is small (<code>frac</code>&lt;&lt;1).
</p>
<p>The &quot;hypergeometric&quot; scheme simulates a sample of a fixed total number of
individuals from the community. Therefore, abundances of the species
in the sample are interdependent (Connoly et al. 2009).
Sampling is carried out with <code>base::sample(..., replace = FALSE)</code>.
This scheme samples without replacement a finite community and
therefore provides valid results for any value of
<code>frac</code>.
</p>
<p>For the broken-stick, logseries, MZSM and Volkov distributions, the expected value of <code>S</code>
is deduced from the coefficients provided in the argument <code>coef</code>; thus, the value of the parameter
<code>S</code> is ignored and may be left blank. The expressions for the number of species in each case are:
</p>
<p>* Broken-stick: coefficient S
* Log-series: alpha log(1 + N/alpha)
* MZSM: sum_x=1^J theta/x (1 - x/J)^(theta - 1)
* Volkov: sum of the unnormalized PDF from 1 to J, see <code><a href="#topic+dvolkov">dvolkov</a></code>
</p>


<h3>Value</h3>

<p>if <kbd>ssize=1</kbd> a vector of (zero truncated) abundances in the sample;
if <kbd>ssize&gt;1</kbd> a data frame with sample identification, species identification, and (zero truncated) abundances.
</p>


<h3>Author(s)</h3>

<p>Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Andre Chalom.
</p>


<h3>References</h3>

<p>Pielou, E.C. 1977. <em>Mathematical Ecology</em>. New York: John Wiley
and Sons.
</p>
<p>Green, J. and Plotkin, J.B. 2007 A statistical theory for sampling
species abundances. <em>Ecology Letters 10</em>:1037&ndash;1045
</p>
<p>Connolly, S.R., Dornelas, M., Bellwood, D.R. and Hughes,
T.P. 2009. Testing species abundance models: a new bootstrap approach
applied to Indo-Pacific coral reefs. <em>Ecology, 90</em>(11):
3138&ndash;3149.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dpoix">dpoix</a></code>, <code><a href="#topic+dpoig">dpoig</a></code> and <code><a href="#topic+dpoilog">dpoilog</a></code> for
examples of compound Poisson probability distributions like those
simulated by <code>rsad</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##A Poisson sample from a community with a lognormal sad
samp2 &lt;- rsad(S = 100, frac=0.1, sad="lnorm", coef=list(meanlog=5, sdlog=2))
## Preston plot
plot(octav(samp2))
## Once this is a Poisson sample of a lognormal community, the abundances
## in the sample should follow a Poisson-lognormal distribution.
## Adds line of theoretical Poisson-lognormal with
## mu=meanlog+log(frac) and sigma=sdlog)
## Predicted by the theoretical Poisson-lognormal truncated at zero
samp2.pred &lt;- octavpred(samp2, sad="poilog", coef= list(mu=5+log(0.1), sig=2), trunc=0)
## Adding the line in the Preston plot
lines(samp2.pred)
</code></pre>

<hr>
<h2 id='sads-package'>
Maximum Likelihood Models for Species Abundance Distributions
</h2><span id='topic+sads-package'></span><span id='topic+sads'></span>

<h3>Description</h3>

<p>Maximum likelihood tools to fit and compare models of species
    abundance distributions and of species rank-abundance distributions.
</p>


<h3>Details</h3>

<p>The distribution of abundances of species is one of the basic patterns of
ecological communities. The empirical distributions of abundances (SADs)
or their ranks (RADs) are traditionally
modelled through probability distributions. Hence, the maximum
likelihood method can be used to fit and compare competing models for
SADs and RADs. The <span class="pkg">sads</span> package provides functions, classes and methods to: 
</p>

<ul>
<li><p> Fit classic SAD models: log-series, lognormal, broken-stick, ... ; 
</p>
</li>
<li><p> Fit classic rank-abundance (RADs) models: geometric,
broken-stick, Zipf, Zipf-Mandelbrodt, ... ;
</p>
</li>
<li><p> Tools for quick diagnostic and comparison of models;
</p>
</li>
<li><p> Tools to simulate Poisson and Negative Binomial samples from
abundances in communities.  
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Paulo I. Prado, Murilo Dantas Miranda and Andre Chalom
</p>
<p>Maintainer: Paulo I. Prado &lt;prado@ib.usp.br&gt;
</p>


<h3>References</h3>

<p>Magurran, A.E. 2004. <em>Measuring Biological Diversity</em>. Blackwell.
</p>
<p>Magurran, A.E. and McGill, B.J. 2011. <em>Biological Diversity &ndash;
Frontiers in measurement and assessment</em>. Oxford University Press.
</p>
<p>May, R.M. 1975. Patterns of Species Abundance and Diversity. In
M. L. Cody and J. M. Diamond (Eds.), (pp. 81&ndash;120). Harvard University
Press. 
</p>
<p>Green,J. and Plotkin, J.B. 2007 A statistical theory for sampling
species abundances. <em>Ecology Letters 10</em>:1037&ndash;1045.
</p>
<p>Saether, B.E., Engen, S. and Grotan, V. 2013. Species diversity and
community similarity in fluctuating environments: parametric
approaches using species abundance distributions.
<em>Journal of Animal Ecology, 82</em>(4): 721&ndash;738.
</p>


<h3>See Also</h3>

<p>vignettes of <span class="pkg">sads</span>; <code>vegan-package</code> and <code>poilog-package</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Rank-abundance plot
plot( rad(moths) )
## Preston's plots
plot (octav(moths) )
## Fit logseries model
moths.ls &lt;-  fitsad(moths, sad = 'ls')
## Diagnostic plots
par(mfrow=c(2,2))
plot(moths.ls)
par(mfrow = c(1,1))
## Model summary
summary(moths.ls)
## Confidence interval
confint(moths.ls)
</code></pre>

<hr>
<h2 id='summary.sads-class'>Summary for fitsad/fitrad calls</h2><span id='topic+summary.sads-class'></span><span id='topic+show+2Csummary.sads-method'></span><span id='topic+summary+2Cfitsad-method'></span><span id='topic+summary+2Cfitrad-method'></span>

<h3>Description</h3>

<p>This function works almost exactly as bbmle's summary.mle2, but it includes a &quot;fixed parameters&quot; 
line for models with fixed parameters, such as <code><a href="#topic+fitls">fitls</a></code> or <code>fitvolkov</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'summary.sads'
show(object)

## S4 method for signature 'fitsad'
summary(object)

## S4 method for signature 'fitrad'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.sads-class_+3A_object">object</code></td>
<td>
<p>An object of class fitsad/fitrad is required to generate a summary.sads object.</p>
</td></tr>
</table>

<hr>
<h2 id='trueLL-methods'>True likelihood for continuous variables</h2><span id='topic+trueLL'></span><span id='topic+trueLL-methods'></span><span id='topic+trueLL+2Cfitsad+2Cmissing+2Cmissing+2Cmissing+2CANY+2CANY-method'></span><span id='topic+trueLL+2Cfitrad+2Cmissing+2Cmissing+2Cmissing+2CANY+2CANY-method'></span><span id='topic+trueLL+2Cnumeric+2Ccharacter+2Clist+2CANY+2CANY+2CANY-method'></span><span id='topic+trueLL+2Chistogram+2Ccharacter+2Clist+2CANY+2Cmissing+2Cmissing-method'></span>

<h3>Description</h3>

<p>Calculates the corrected likelihood for independent observations of a
continuous variable that follows a given (truncated) density function,
given a measurement precision.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="trueLL-methods_+3A_object">object</code></td>
<td>

<p>vector or histogram of observed values, or an object of <code><a href="#topic+fitsad-class">fitsad-class</a></code> 
or <code><a href="#topic+fitrad-class">fitrad-class</a></code>
</p>
</td></tr>
<tr><td><code id="trueLL-methods_+3A_dist">dist</code></td>
<td>

<p>character; root name of the continuous density distribution of the variable -
e.g., <kbd>lnorm</kbd> for the lognormal distribution; <kbd>gamma</kbd> for the gamma
distribution.
</p>
</td></tr>
<tr><td><code id="trueLL-methods_+3A_coef">coef</code></td>
<td>
<p>named list; values of the coefficients of the continuous
density distribution, in the same order and with the same names as in
the probability function defined by the argument <code>dist</code>.
</p>
</td></tr>
<tr><td><code id="trueLL-methods_+3A_trunc">trunc</code></td>
<td>

<p>real number <code>trunc &lt;= min(x)</code>; value from which the density distribution is
truncated. Currently only lower-tail truncation (or right-truncation)
is implemented. If this argument is omitted the whole
distribution is used (default).
</p>
</td></tr>
<tr><td><code id="trueLL-methods_+3A_dec.places">dec.places</code></td>
<td>

<p>positive integer; number of decimal places used in the measurement of
the observed values. Observed values will be rounded to this number of
decimals. This argument defines the measurement precision, see details. 
If neither <code>dec.places</code> nor <code>breaks</code> is given, this defaults to zero.
</p>
</td></tr>
<tr><td><code id="trueLL-methods_+3A_breaks">breaks</code></td>
<td>

<p>A numeric vector giving the breakpoints between count classes. Either 
<code>dec.places</code> or <code>breaks</code> can be provided, but not both.
</p>
</td></tr>
<tr><td><code id="trueLL-methods_+3A_...">...</code></td>
<td>

<p>named arguments to be passed to the probability function defined by the argument <code>dens</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The (log)likelihood function is often defined as any function
proportional to the (sum) product of (log) probability density of the
observations. In its original formulation, however, the likelihood is
proportional to the product of probabilities, not probabilities
densities (Fisher 1922, stressed by Lindsey 1999).  For continuous
variables, these probabilities are calculated through integration of
the probability density function in an interval. For observed values
of continuous variables, this interval is defined by the measurement
precision.  The likelihood function is thus any function proportional
to
</p>
<p>prod ( integral_(x-D)^(x+D) f(x) dx )
</p>
<p>where x is the observed value, f(x) the
density function and D is half the measurement precision:
</p>
<p>D = 10^(-'dec.places')/2
</p>
<p>For continuous variables aggregated in discrete classes, such as
frequency tables of histograms, the probability of a given observation
is
</p>
<p>prod ( integral_L^U f(x) dx )
</p>
<p>where L and U are the lower and upper limits of the classes, as
defined by argument <code>breaks</code>.
</p>
<p>Because products of probabilities quickly tends to
zero, probabilities are usually converted to their logs and then
summed to give the log-likelihood function.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "fitsad", dist = "missing", coef = "missing", 
			trunc = "missing", dec.places = "ANY", breaks="ANY", ...)</code></dt><dd>
<p>log-likelihood value of an abundance distribution model <code>object</code> fitted with
function <code>fitsad</code>.
</p>
</dd>
<dt><code>signature(object = "fitrad", dist = "missing", coef = "missing", 
			trunc = "missing", dec.places = "ANY", breaks="ANY", ...)</code></dt><dd>
<p>log-likelihood value of an abundance distribution model <code>object</code> fitted with
function <code>fitrad</code>.
</p>
</dd>
<dt><code>signature(x = "numeric", dist = "character", coef = "list",
	trunc = "ANY", dec.places = "ANY", breaks="ANY", ...)</code></dt><dd>
<p>log-likelihood value of a vector of abundances <code>object</code>, fitted to a
continuous distribution named by <code>dist</code> with parameters defined in <code>coef</code>.
</p>
</dd>
<dt><code>signature(object = "histogram", dist = "character", coef = "list", 
			trunc = "missing", dec.places = "ANY", breaks="ANY", ...)</code></dt><dd>
<p>log-likelihood value of the abundances given by histogram <code>object</code>, fitted to a
continuous distribution named by <code>dist</code> with parameters defined in <code>coef</code>.
</p>
</dd>
</dl>


<h3>Note</h3>

<p>WARNING: this function is extremely sensitive to the interval breaks
provided (or to the decimal.places), which may result in surprising results.
Use with great caution.
</p>


<h3>Author(s)</h3>

<p>Paulo I. Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Andre Chalom
</p>


<h3>References</h3>

<p>Fisher, R.A. 1922. On the mathematical foundations of theoretical
statistics. <em>Phil. Trans. R. Soc. Lond. A 222</em>: 309&ndash;368.
</p>
<p>Lindsey, J.K. 1999. Some statistical heresies. <em>The Statistician
48</em>(1): 1&ndash;40.
</p>


<h3>See Also</h3>

<p><code>logLik</code> in the package <span class="pkg">MASS</span> and <code>logLik-methods</code> in
package <span class="pkg">bbmle</span>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Random sample of a lognormal distribution with precision = 0.1
x &lt;- round(rlnorm(500, meanlog = 3, sdlog = 0.5), 1)
## Log-likelihood given by fitdistr
library(MASS)
logLik(fitdistr(x, "lognormal"))
## Which is the sum of log of densities
sum( dlnorm(x, meanlog=mean(log(x)), sdlog=sd(log(x)), log=TRUE) )
## Correct log-likelihood
trueLL(x, "lnorm", coef=list(meanlog=mean(log(x)), sdlog=sd(log(x))), dec.places=1)
# Alternative invocation
trueLL(fitlnorm(x))

## Data in classes
xoc &lt;- octav(x)
xc &lt;- as.numeric(as.character(xoc$octave))
xb &lt;- 2^(c(min(xc)-1, xc))
xh &lt;- hist(x, breaks=xb, plot=FALSE)
xll &lt;- trueLL(xh, dist="lnorm", coef = list(meanlog=mean(log(x)), sd=sd(log(x))))
xp &lt;- diff(plnorm(xh$breaks, mean(log(x)), sd(log(x))))
xll2 &lt;- sum( rep(log(xp), xh$counts))
all.equal(xll, xll2) # should be TRUE
</code></pre>

<hr>
<h2 id='updatesad'>Updating of MLE fits by profiling</h2><span id='topic+updatesad'></span><span id='topic+updaterad'></span>

<h3>Description</h3>

<p>These functions update a fitsad/fitrad object
by running the optimizer again starting on better fit
returned by profile. 
</p>
<p>These functions were not extensively tested, and should
be considered in beta testing phase.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updatesad(object, ...) 
updaterad(object, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updatesad_+3A_object">object</code></td>
<td>

<p>object of the class <code><a href="#topic+fitsad-class">fitsad-class</a></code> or <code><a href="#topic+fitrad-class">fitrad-class</a></code>
for which the optimization did not converge, or converged to a local minimum.
</p>
</td></tr>
<tr><td><code id="updatesad_+3A_...">...</code></td>
<td>

<p>list of additional parameters to be passed to the <code>fitsad</code> or <code>fitrad</code> fitting
procedure. May include a different optimizer, method, or upper/lower bounds for the parameters.
Refer to the <code>fitsad</code> and <code>fitrad</code> man pages for details of which parameters may be
specified.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>updatesad</code> function runs a new profile of the fitted object, and if the
profile is able to find a better fit, it runs a new optimization starting on this better fit.
If the profiling does not find a new fit, the function exits with error.
The actual processing is done by <code>updatesad</code>. <code>updaterad</code> is simply a convenience alias.
</p>


<h3>Value</h3>

<p>An object of <code><a href="#topic+fitsad-class">fitsad-class</a></code> or <code><a href="#topic+fitrad-class">fitrad-class</a></code>.
</p>


<h3>Author(s)</h3>

<p>Paulo I Prado <a href="mailto:prado@ib.usp.br">prado@ib.usp.br</a> and Andre Chalom</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitsad-class">fitsad-class</a></code>, <code><a href="#topic+fitrad-class">fitrad-class</a></code>, <code><a href="#topic+fitsadC-class">fitsadC-class</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
