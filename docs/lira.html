<!DOCTYPE html><html><head><title>Help for package lira</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lira}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#distance.LCDM'><p>Angular diameter distance in a LCDM universe</p></a></li>
<li><a href='#Hubble.LCDM'><p>Hubble parameter</p></a></li>
<li><a href='#lira'><p>LInear Regression in Astronomy</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>LInear Regression in Astronomy</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-02-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Mauro Sereno</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mauro Sereno &lt;mauro.sereno@unibo.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs Bayesian linear regression and forecasting in astronomy. The method accounts for heteroscedastic errors in both the independent and the dependent variables, intrinsic scatters (in both variables) and scatter correlation, time evolution of slopes, normalization, scatters, Malmquist and Eddington bias, upper limits and break of linearity. The posterior distribution of the regression parameters is sampled with a Gibbs method exploiting the JAGS library.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.14.0), coda, rjags</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (&gt;= 3.0.0) (see
http://mcmc-jags.sourceforge.net)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-02-05 20:51:10 UTC; maurosereno</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-02-06 14:19:28 UTC</td>
</tr>
</table>
<hr>
<h2 id='distance.LCDM'>Angular diameter distance in a LCDM universe</h2><span id='topic+distance.LCDM'></span>

<h3>Description</h3>

<p>Angular diameter distance in a LCDM (Cold Dark Matter universe with a cosmological constant) universe between an observer at 'zd' and a source at 'zs'. The distance is in units of the Hubble distance c/H0, where 'c' is the speed of light and 'H0' is the Hubble constant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance.LCDM(zo=0.0,z,Omega.M0=0.3,Omega.L0=0.7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distance.LCDM_+3A_zo">zo</code></td>
<td>
<p>redshift of the observer.</p>
</td></tr>
<tr><td><code id="distance.LCDM_+3A_z">z</code></td>
<td>
<p>redshift of the source.</p>
</td></tr>
<tr><td><code id="distance.LCDM_+3A_omega.m0">Omega.M0</code></td>
<td>
<p>present day matter density in units of the critical density.</p>
</td></tr>
<tr><td><code id="distance.LCDM_+3A_omega.l0">Omega.L0</code></td>
<td>
<p>renormalized cosmological constant in units of the critical density.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimate of the distance.
</p>


<h3>Author(s)</h3>

<p>Mauro Sereno <a href="mailto:mauro.sereno@unibo.it">mauro.sereno@unibo.it</a>
</p>


<h3>References</h3>

<p>Sereno M., Covone G., Piedipalumbo E., de Ritis R., (2001) Monthly Notices of the Royal Astronomical Society 327, 517-530.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+Hubble.LCDM">Hubble.LCDM</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Distance to a source at z=1 in a standard cosmology,
distance.LCDM(z=1.0) 
# Distance between a lens at zl=0.3 and a source at z=1 in an open cosmology,
distance.LCDM(0.3,1,Omega.M0=0.2,Omega.L0=0.7)
</code></pre>

<hr>
<h2 id='Hubble.LCDM'>Hubble parameter</h2><span id='topic+Hubble.LCDM'></span>

<h3>Description</h3>

<p>Hubble parameter in a LCDM (Cold Dark Matter universe with a cosmological constant) universe in units of the present day Hubble constant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hubble.LCDM(z,Omega.M0=0.3,Omega.L0=0.7)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hubble.LCDM_+3A_z">z</code></td>
<td>
<p>the redshift</p>
</td></tr>
<tr><td><code id="Hubble.LCDM_+3A_omega.m0">Omega.M0</code></td>
<td>
<p>present day matter density in units of the critical density in a LCDM universe.</p>
</td></tr>
<tr><td><code id="Hubble.LCDM_+3A_omega.l0">Omega.L0</code></td>
<td>
<p>renormalized cosmological constant in units of the critical density. See 'Omega.M0'.</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>The Hubble parameter in units of H0. 
</p>


<h3>Author(s)</h3>

<p>Mauro Sereno <a href="mailto:mauro.sereno@unibo.it">mauro.sereno@unibo.it</a>
</p>


<h3>References</h3>

<p>Sereno M., Covone G., Piedipalumbo E., de Ritis R., (2001) Monthly Notices of the Royal Astronomical Society 327, 517-530.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+Hubble.LCDM">Hubble.LCDM</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Hubbel parameter at redshit z=1 in a standard cosmology,
Hubble.LCDM(1) 
# Hubbel parameter at redshit z=1 in an open cosmology,
Hubble.LCDM(1,Omega.M0=0.2,Omega.L0=0.7)
</code></pre>

<hr>
<h2 id='lira'>LInear Regression in Astronomy</h2><span id='topic+lira'></span>

<h3>Description</h3>

<p>Performs Bayesian linear regression analysis and forecasting optimized for astronomy. The method accounts for heteroscedastic and correlated errors in both the independent and the dependent variables, intrinsic scatters (in both variables) and scatter correlation, time evolution of normalization, slope, scatter, Malmquist and Eddington bias, upper limits and break of linearity ('knee'). The posterior distribution of the parameters is sampled with a JAGS (Just Another Gibbs Sampler) powered Gibbs sampler.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lira(x, y,
delta.x, delta.y, covariance.xy,
y.threshold, delta.y.threshold, x.threshold, delta.x.threshold,
y.upperlimit, delta.y.upperlimit, x.upperlimit, delta.x.upperlimit,
z, z.ref=0.01, time.factor="Ez", distance=c("luminosity","angular"),
Omega.M0=0.3, Omega.L0=0.7,
alpha.YIZ="dunif", beta.YIZ="dt", gamma.YIZ="dt", delta.YIZ=0.0,
sigma.YIZ.0="prec.dgamma", gamma.sigma.YIZ.Fz=0.0, gamma.sigma.YIZ.D=0.0,
alpha.XIZ=0.0, beta.XIZ=1.0, gamma.XIZ=0.0, delta.XIZ=0.0,
sigma.XIZ.0=0.0, gamma.sigma.XIZ.Fz=0.0, gamma.sigma.XIZ.D=0.0,
rho.XYIZ.0=0.0,  gamma.rho.XYIZ.Fz=0.0, gamma.rho.XYIZ.D=0.0,
n.mixture=1, pi="ddirch",
mu.Z.0="dunif", gamma.mu.Z.Fz="dt", gamma.mu.Z.D="dt",
sigma.Z.0="prec.dgamma", gamma.sigma.Z.Fz=0.0, gamma.sigma.Z.D=0.0,
mu.Z.0.mixture="dunif", sigma.Z.0.mixture="prec.dgamma",
Z.knee="dunif", l.knee=1e-04,
beta.YIZ.knee="beta.YIZ", delta.YIZ.knee="delta.YIZ", sigma.YIZ.0.knee = "sigma.YIZ.0",
mu.Z.min.0="-n.large", gamma.mu.Z.min.Fz="dt", gamma.mu.Z.min.D="dt",
sigma.Z.min.0=0.0, gamma.sigma.Z.min.Fz=0.0, gamma.sigma.Z.min.D=0.0,
Z.max= "n.large",
n.large=1e04,
inits, n.chains=1, n.adapt=1e03, quiet=TRUE,
n.iter=1e04, thin=1,
print.summary=TRUE, print.diagnostic=TRUE,
export=FALSE, export.mcmc="", export.jags="",
X.monitored=FALSE, export.X="",
XZ.monitored=FALSE, export.XZ="",
Z.monitored=FALSE, export.Z="",
Y.monitored=FALSE, export.Y="",
YZ.monitored=FALSE, export.YZ="")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lira_+3A_x">x</code></td>
<td>
<p>the vector containing the observed values &quot;x&quot; of the independent variable.</p>
</td></tr>
<tr><td><code id="lira_+3A_y">y</code></td>
<td>
<p>the vector containing the observed values &quot;y&quot; of the dependent variable. For forecasting, set the missing data values to NA. The posterior distribution of the node will be sampled.</p>
</td></tr>
<tr><td><code id="lira_+3A_delta.x">delta.x</code></td>
<td>
<p>optional vector containing the measurement 1-sigma uncertainties in &quot;x&quot;.</p>
</td></tr>
<tr><td><code id="lira_+3A_delta.y">delta.y</code></td>
<td>
<p>optional vector containing the measurement 1-sigma uncertainties in &quot;y&quot;.</p>
</td></tr>
<tr><td><code id="lira_+3A_covariance.xy">covariance.xy</code></td>
<td>
<p>optional vector containing the measurement uncertainties covariances.</p>
</td></tr>
<tr><td><code id="lira_+3A_y.threshold">y.threshold</code></td>
<td>
<p>optional vector containing the minimum observable values of &quot;y&quot;. These threshold values are used to correct for the Malmquist bias in truncated samples. To be used if undetected objects (y&lt;y.threshold) are entirely missing from the dataset.</p>
</td></tr>
<tr><td><code id="lira_+3A_delta.y.threshold">delta.y.threshold</code></td>
<td>
<p>optional vector containing the 1-sigma uncertainties in &quot;y.threshold&quot;.</p>
</td></tr>
<tr><td><code id="lira_+3A_x.threshold">x.threshold</code></td>
<td>
<p>optional vector containing the minimum observable values of &quot;x&quot;. See &quot;y.threshold&quot;.</p>
</td></tr>
<tr><td><code id="lira_+3A_delta.x.threshold">delta.x.threshold</code></td>
<td>
<p>optional vector containing the 1-sigma uncertainties in &quot;x.threshold&quot;.</p>
</td></tr>
<tr><td><code id="lira_+3A_y.upperlimit">y.upperlimit</code></td>
<td>
<p>optional vector containing the upper limit of &quot;y&quot; for left-censored data points. To be used if the dataset contains the full sample of interest, but some objects have upper limits and others have detections. For detected objects, set the upper limit to NA or to very large values.</p>
</td></tr>
<tr><td><code id="lira_+3A_delta.y.upperlimit">delta.y.upperlimit</code></td>
<td>
<p>optional vector containing the 1-sigma uncertainties in &quot;y.upperlimit&quot;.</p>
</td></tr>
<tr><td><code id="lira_+3A_x.upperlimit">x.upperlimit</code></td>
<td>
<p>optional vector containing the upper limit of &quot;x&quot;. See &quot;y.upperlimit&quot;.</p>
</td></tr>
<tr><td><code id="lira_+3A_delta.x.upperlimit">delta.x.upperlimit</code></td>
<td>
<p>optional vector containing the 1-sigma uncertainties in &quot;x.upperlimit&quot;.</p>
</td></tr>
<tr><td><code id="lira_+3A_z">z</code></td>
<td>
<p>optional vector containing the measured redshifts.</p>
</td></tr>
<tr><td><code id="lira_+3A_z.ref">z.ref</code></td>
<td>
<p>reference redshift.</p>
</td></tr>
<tr><td><code id="lira_+3A_time.factor">time.factor</code></td>
<td>
<p>character string indicating the form of the &quot;Fz&quot; time factor. &quot;Fz&quot; is renormalized such that Fz=1 at the reference redshift z.ref. If time.factor=&quot;Ez&quot;, the evolution is proportional to the Hubble factor; if &quot;1+z&quot;, the evolution is proportional to (1+z).</p>
</td></tr>
<tr><td><code id="lira_+3A_distance">distance</code></td>
<td>
<p>character string denoting the cosmological distances to use. If distance=&quot;luminosity&quot; or &quot;angular&quot;, luminosity or angular diameter distances are considered, respectively.</p>
</td></tr>
<tr><td><code id="lira_+3A_omega.m0">Omega.M0</code></td>
<td>
<p>present day matter density in units of the critical density in a LCDM universe. This is used to compute the distances and the time factor &quot;Ez&quot;, if applicable.</p>
</td></tr>
<tr><td><code id="lira_+3A_omega.l0">Omega.L0</code></td>
<td>
<p>renormalized cosmological constant in units of the critical density. See &quot;Omega.M0&quot;.</p>
</td></tr>
<tr><td><code id="lira_+3A_alpha.yiz">alpha.YIZ</code></td>
<td>
<p>a character string or a number giving the prior on the intercept of the Y-Z regression. By default, a uniform distribution is assumed. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_beta.yiz">beta.YIZ</code></td>
<td>
<p>a character string or a number giving the prior on the slope of the Y-Z relation. By default, a Student's t-distribution is assumed. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.yiz">gamma.YIZ</code></td>
<td>
<p>a character string or a number giving the prior on slope of the time evolution of the Y-Z relation. If redshifts are provided, a default Student's t-distribution is assumed. Otherwise, the parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_delta.yiz">delta.YIZ</code></td>
<td>
<p>a character string or a number giving the prior on the slope tilt with time of the Y-Z relation. By default, this parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_sigma.yiz.0">sigma.YIZ.0</code></td>
<td>
<p>a character string or a number giving the prior on the standard deviation of the intrinsic scatter of the Y-Z relation at z.ref. By default, the precision, i.e., sigma.YIZ.0^-2, is assumed to follow a Gamma distribution. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.sigma.yiz.fz">gamma.sigma.YIZ.Fz</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with &quot;Fz&quot; of the scatter sigma.YIZ. See Details. By default, this parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.sigma.yiz.d">gamma.sigma.YIZ.D</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with the distance &quot;D&quot; of the scatter sigma.YIZ. By default, a delta prior is assumed and the parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_alpha.xiz">alpha.XIZ</code></td>
<td>
<p>a character string or a number giving the prior on the intercept of the X-Z relation. By default, this parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_beta.xiz">beta.XIZ</code></td>
<td>
<p>a character string or a number giving the prior on the slope of the X-Z relation. By default, this parameter is fixed to 1. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.xiz">gamma.XIZ</code></td>
<td>
<p>a character string or a number giving the prior on the slope of the time evolution of the X-Z relation. By default, this parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_delta.xiz">delta.XIZ</code></td>
<td>
<p>a character string or a number giving the prior on the slope tilt with time of the X-Z relation. By default, this parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_sigma.xiz.0">sigma.XIZ.0</code></td>
<td>
<p>a character string or a number giving the prior on the standard deviation of the intrinsic scatter of the X-Z relation at z.ref. By default, this parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.sigma.xiz.fz">gamma.sigma.XIZ.Fz</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with &quot;Fz&quot; of the scatter sigma.XIZ. By default, this parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.sigma.xiz.d">gamma.sigma.XIZ.D</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with the distance &quot;D&quot; of the scatter sigma.XIZ. By default, a delta prior is assumed and the parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_rho.xyiz.0">rho.XYIZ.0</code></td>
<td>
<p>a character string or a number giving the prior on the correlation between the intrinsic scatters at z.ref. By default, this parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.rho.xyiz.fz">gamma.rho.XYIZ.Fz</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with &quot;Fz&quot; of the scatter-correlation rho.XYIZ. By default, this parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.rho.xyiz.d">gamma.rho.XYIZ.D</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with the distance &quot;D&quot; of the scatter-correlation rho.XYIZ. By default, a delta prior is assumed and the parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_n.mixture">n.mixture</code></td>
<td>
<p>the number of Gaussian distributions in the mixture modelling the Z-distribution p(Z). See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_pi">pi</code></td>
<td>
<p>the prior on the probability coefficients of the mixture components. By default, a Dirichelet distribution is assumed. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_mu.z.0">mu.Z.0</code></td>
<td>
<p>a character string or a number giving the prior on the mean of the first mixture component at z.ref. By default, a uniform distribution is assumed. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.mu.z.fz">gamma.mu.Z.Fz</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with &quot;Fz&quot; of the mean mu.Z. By default, a Student's t-distribution is assumed. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.mu.z.d">gamma.mu.Z.D</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with the distance &quot;D&quot; of the mean mu.Z. By default, a Student's t-distribution is assumed. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_sigma.z.0">sigma.Z.0</code></td>
<td>
<p>a character string or a number giving the prior on the dispersion of the first mixture component at z.ref. By default, the precision follows a priori a Gamma distribution. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.sigma.z.fz">gamma.sigma.Z.Fz</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with &quot;Fz&quot; of the dispersion sigma.Z. By default, this parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.sigma.z.d">gamma.sigma.Z.D</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with the distance &quot;D&quot; of the dispersion sigma.Z. By default, a delta prior is assumed and the parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_mu.z.0.mixture">mu.Z.0.mixture</code></td>
<td>
<p>a character string or a number giving the prior on the mean of the additional mixture components at z.ref. By default, a uniform distribution is assumed. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_sigma.z.0.mixture">sigma.Z.0.mixture</code></td>
<td>
<p>a character string or a number giving the prior on the dispersion of the additional mixture components at z.ref. By default, the precisions follow a priori a Gamma distribution. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_z.knee">Z.knee</code></td>
<td>
<p>a character string or a number giving the prior on the Z value where linearity breaks down. If applicable, the default prior is the uniform distribution. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_l.knee">l.knee</code></td>
<td>
<p>a character string or a number giving the prior on the width of the transition region where linearity breaks down. By default, a delta prior is assumed. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_beta.yiz.knee">beta.YIZ.knee</code></td>
<td>
<p>a character string or a number giving the prior on the slope of the Y-Z relation before the break. If beta.YIZ.knee=&quot;beta.YIZ&quot;, no breaking occurs. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_delta.yiz.knee">delta.YIZ.knee</code></td>
<td>
<p>a character string or a number giving the prior on the time evolution of the slope of the Y-Z relation before the break. If delta.YIZ.knee=&quot;delta.YIZ&quot;, the tilt does not change before the break. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_sigma.yiz.0.knee">sigma.YIZ.0.knee</code></td>
<td>
<p>a character string or a number giving the prior on the intercept of the Y-Z relation before the break. If sigma.YIZ.0.knee=&quot;sigma.0.YIZ&quot;, the intrinsic scatter does not change before the break. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_mu.z.min.0">mu.Z.min.0</code></td>
<td>
<p>minimum value of the Z distribution at z.ref. The Gaussian distribution of the covariate is truncated below &quot;mu.Z.Min.0&quot;. If &quot;n.mixture&quot;&gt;1, &quot;mu.Z.Min.0&quot; is automatically set to -n.large. If &quot;mu.Z.Min.0&quot; is set to -n.large, the Gaussian is not truncated.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.mu.z.min.fz">gamma.mu.Z.min.Fz</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with &quot;Fz&quot; of mu.Z.min. By default, a Student's t-distribution is assumed. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.mu.z.min.d">gamma.mu.Z.min.D</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with the distance &quot;D&quot; of the mean mu.Z.min. By default, a Student's t-distribution is assumed. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_sigma.z.min.0">sigma.Z.min.0</code></td>
<td>
<p>a character string or a number giving the prior on the dispersion of the truncation &quot;mu.Z.min.0&quot; at z.ref. By default, &quot;sigma.Z.min.0&quot; is set to 0.0 and the covariate distribution is sharply truncated. If &quot;sigma.Z.min.0&quot; is left free, the truncation is modelled with a complementary error function with dispersion &quot;sigma.Z.min.0&quot;. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.sigma.z.min.fz">gamma.sigma.Z.min.Fz</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with &quot;Fz&quot; of the dispersion sigma.Z.min. By default, this parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_gamma.sigma.z.min.d">gamma.sigma.Z.min.D</code></td>
<td>
<p>a character string or a number giving the prior on the evolution with the distance &quot;D&quot; of the dispersion sigma.Z.min. By default, a delta prior is assumed and the parameter is set to 0. See Details.</p>
</td></tr>
<tr><td><code id="lira_+3A_z.max">Z.max</code></td>
<td>
<p>maximum value of the Z distribution. The Gaussian distribution of Z values is truncated for Z &gt; Z.max. If Z.max=n.large, the distribution is not truncated. If &quot;n.mixture&quot;&gt;1, Z.max is automatically set to n.large.</p>
</td></tr>
<tr><td><code id="lira_+3A_n.large">n.large</code></td>
<td>
<p>large number used to define standard prior distributions. n.large has to be much larger than max(abs(x)).</p>
</td></tr> 
<tr><td><code id="lira_+3A_inits">inits</code></td>
<td>
<p>optional specification of initial values in the form of a list or a function. See <code><a href="rjags.html#topic+jags.model">jags.model</a></code> for details.</p>
</td></tr> 
<tr><td><code id="lira_+3A_n.chains">n.chains</code></td>
<td>
<p>the number of parallel chains for the model. See <code><a href="rjags.html#topic+jags.model">jags.model</a></code> for details.</p>
</td></tr>
<tr><td><code id="lira_+3A_n.adapt">n.adapt</code></td>
<td>
<p>the number of iterations for adaptation. See <code><a href="rjags.html#topic+jags.model">jags.model</a></code> for details.</p>
</td></tr>
<tr><td><code id="lira_+3A_quiet">quiet</code></td>
<td>
<p>logical value. If TRUE then messages generated during compilation will be suppressed. See <code><a href="rjags.html#topic+jags.model">jags.model</a></code> for details.</p>
</td></tr>
<tr><td><code id="lira_+3A_n.iter">n.iter</code></td>
<td>
<p>number of iterations to monitor. See <code><a href="rjags.html#topic+coda.samples">coda.samples</a></code> for details.</p>
</td></tr>
<tr><td><code id="lira_+3A_thin">thin</code></td>
<td>
<p>thinning interval for monitors. See <code><a href="rjags.html#topic+coda.samples">coda.samples</a></code> for details.</p>
</td></tr>
<tr><td><code id="lira_+3A_print.summary">print.summary</code></td>
<td>
<p>logical value. If TRUE a summary of the chains properties is printed on the standard output.</p>
</td></tr>
<tr><td><code id="lira_+3A_print.diagnostic">print.diagnostic</code></td>
<td>
<p>logical value. If TRUE a diagnostic of the chains properties is printed on the standard output.</p>
</td></tr>
<tr><td><code id="lira_+3A_export">export</code></td>
<td>
<p>logical value. If TRUE two output files are written, one text file with the merged thinned chains and one text file with the JAGS script used to perform the regression.</p>
</td></tr>
<tr><td><code id="lira_+3A_export.mcmc">export.mcmc</code></td>
<td>
<p>character string indicating the file name where to write the chains. If &quot;&quot; and export=TRUE, a file named &quot;mcmc_all.dat&quot; is created in the working directory.</p>
</td></tr>
<tr><td><code id="lira_+3A_export.jags">export.jags</code></td>
<td>
<p>character string indicating the file name where to write the JAGS model. If &quot;&quot; and export=TRUE, a file named &quot;lira.jags&quot; is created in the working directory.</p>
</td></tr>
<tr><td><code id="lira_+3A_x.monitored">X.monitored</code></td>
<td>
<p>logical value. If TRUE the X variables are monitored.</p>
</td></tr>
<tr><td><code id="lira_+3A_export.x">export.X</code></td>
<td>
<p>character string indicating the file name where to write the chains for the X variables. If &quot;&quot;, there is no export.</p>
</td></tr>
<tr><td><code id="lira_+3A_xz.monitored">XZ.monitored</code></td>
<td>
<p>logical value. If TRUE the XZ variables are monitored.</p>
</td></tr>
<tr><td><code id="lira_+3A_export.xz">export.XZ</code></td>
<td>
<p>character string indicating the file name where to write the chains for the XZ variables. If &quot;&quot;, there is no export.</p>
</td></tr>
<tr><td><code id="lira_+3A_z.monitored">Z.monitored</code></td>
<td>
<p>logical value. If TRUE the Z variables are monitored.</p>
</td></tr>
<tr><td><code id="lira_+3A_export.z">export.Z</code></td>
<td>
<p>character string indicating the file name where to write the chains for the Z variables. If &quot;&quot;, there is no export.</p>
</td></tr>
<tr><td><code id="lira_+3A_y.monitored">Y.monitored</code></td>
<td>
<p>logical value. If TRUE the Y variables are monitored.</p>
</td></tr>
<tr><td><code id="lira_+3A_export.y">export.Y</code></td>
<td>
<p>character string indicating the file name where to write the chains for the Y variables. If &quot;&quot;, there is no export.</p>
</td></tr>
<tr><td><code id="lira_+3A_yz.monitored">YZ.monitored</code></td>
<td>
<p>logical value. If TRUE the YZ variables are monitored.</p>
</td></tr>
<tr><td><code id="lira_+3A_export.yz">export.YZ</code></td>
<td>
<p>character string indicating the file name where to write the chains for the YZ variables. If &quot;&quot;, there is no export.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The linear regression assumes:
</p>
<p>Y = alpha.YIZ + beta.YIZ*Z + gamma.YIZ*T + delta.YIZ*T*Z +-sigma.YIZ,
</p>
<p>where T=log10(Fz), alpha.YIZ is the intercept, beta.YIZ is the slope, gamma.YIZ is the time-evolution of the normalization, delta.YIZ is the time evolution of the slope, and sigma.YIZ is the time dependent dispersion of the normally-distributed intrinsic scatter. 'Fz' is the time factor. If the covariate variable &quot;Z&quot; cannot be mesured, we may consider X as a scattered proxy of Z,
</p>
<p>X = alpha.XIZ + beta.XIZ*Z + gamma.XIZ*T + delta.XIZ*T*Z +-sigma.XIZ.
</p>
<p>The input parameters x and y are the measured values of X and Y, respectively. The values delta.x and delta.x are the 1-sigma uncertainties,
</p>
<p>x = X +- delta.x,
</p>
<p>y = Y +- delta.y.
</p>
<p>The measurement error covariances is covariance.xy.
</p>
<p>The scatters sigma.YIZ and sigma.XIZ evolve with time as
</p>
<p>sigma.YIZ = sigma.YIZ.0*(Fz^gamma.sigma.YIZ.Fz)*(D^gamma.sigma.YIZ.D),
</p>
<p>sigma.XIZ = sigma.XIZ.0*(Fz^gamma.sigma.XIZ.Fz)*(D^gamma.sigma.XIZ.D),
</p>
<p>where D is the normalized cosmological distance. The scatters sigma.YIZ and sigma.XIZ may be correlated, with correlation
</p>
<p>rho.XYIZ = rho.XYIZ.0*(Fz^gamma.rho.XYIZ.Fz)*(D^gamma.rho.XYIZ.D).
</p>
<p>The intrinsic distribution of Z is modelled as a mixture of normal distributions. The mean and the dispersion of the first component evolve as
</p>
<p>mu.Z = mu.Z.0 + gamma.mu.Z.D*log10(D) + gamma.mu.Z.Fz*T,
</p>
<p>sigma.Z = sigma.Z.0*(Fz^gamma.sigma.Z.Fz)*(D^gamma.sigma.Z.D).
</p>
<p>When modeled as a single Gaussian, the distribution of the covariate can be truncated at low values with a complementary error function centered on
</p>
<p>mu.Z.min = mu.Z.min.0 + gamma.mu.Z.min.D*log10(D) + gamma.mu.Z.min.Fz*T,
</p>
<p>and with dispersion
</p>
<p>sigma.Z.min = sigma.Z.min.0*(Fz^gamma.sigma.Z.min.Fz)*(D^gamma.sigma.Z.min.D). By default, the distribution is not truncated.
</p>
<p>At the high values end, the distribution can be truncated with an hard cut at Z.max. By default, the distribution is not truncated.
</p>
<p>Breaking of the linearity is allowed too. At Z.knee, the linear relation abruptly changes to
</p>
<p>Y = alpha.YIZ.knee + beta.YIZ.knee*Z + gamma.YIZ.knee*T + delta.YIZ.knee*Z*T +-sigma.YIZ.0.knee.
</p>
<p>The transiction function is
</p>
<p>fknee= 1/(1+exp((Z-Zknee)/lknee),
</p>
<p>where lknee is the transition length.
</p>
<p>Priors on regression parameters can be expressed either as numbers or as character strings. If numbers, delta priors are adopted, the parameters are fixed to the input values, and they are fixed during the the regression. If strings, the prior distribution of the parameter is modeled after the argument. The syntax follows JAGS, see the JAGS user manual at <a href="http://sourceforge.net/projects/mcmc-jags/files/Manuals/">http://sourceforge.net/projects/mcmc-jags/files/Manuals/</a> for the complete list of distributions. The following shortcuts can be used: &quot;dt&quot; for the Student's&quot; t-distribution &quot;dt(0,1,1)&quot;, &quot;dgamma&quot; for the gamma distribution &quot;dgamma(1.0/n.large,1.0/n.large)&quot;; &quot;dunif&quot; for the uniform distribution &quot;dunif(-n.large,n.large)&quot;. The distribution &quot;prec.dgamma&quot; is only applicable to dispersions and standard deviations. It means that the precision, i.e., the inverse of the variance, follows a &quot;dgamma&quot; distribution. &quot;ddirch&quot; is the Dirichlet distribution &quot;ddirch(alpha)&quot;, with alpha=c(1,..,1).
</p>
<p>If beta.YIZ.knee=&quot;beta.YIZ&quot;, no breaking occurs. Any prior on delta.YIZ.knee or sigma.YIZ.0.knee is superseded, and the conditions delta.YIZ.knee=&quot;delta.YIZ&quot; and sigma.YIZ.knee=&quot;sigma.YIZ&quot; are assumed.
</p>
<p>If redshifts are not provided, all gamma and delta parameters are set to 0.
</p>


<h3>Value</h3>

<p>lira return a LIST
</p>
<table>
<tr><td><code>first component</code></td>
<td>
<p>A data frame containing the merged chains of all parameters.</p>
</td></tr>
<tr><td><code>second component</code></td>
<td>
<p>An mcmc.list object containing the MCMC chains of the regression parameters.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>The dependence packages do not include a copy of the JAGS library, which must be installed separately. For instructions on downloading JAGS, see <a href="http://mcmc-jags.sourceforge.net">http://mcmc-jags.sourceforge.net</a>. C++ compilers are also needed.</p>


<h3>Note</h3>

<p>The vectors x and y can contain missing values NA. The posterior distribution for the corresponding nodes, i.e. the statistical relations, is sampled. Missing values are best suited to the y vector. The samples at the NA locations in the response vector are samples from the posterior predictive distribution and can be summarized just like other model parameters. They can be used to forecast the missing data.</p>


<h3>Author(s)</h3>

<p>Mauro Sereno <a href="mailto:mauro.sereno@oabo.inaf.it">mauro.sereno@oabo.inaf.it</a>
</p>


<h3>References</h3>

<p>Sereno M., &quot;A Bayesian approach to linear regression in astronomy&quot; (2016), MNRAS 455, 2149-2162; electronic version at <a href="http://adsabs.harvard.edu/abs/2016MNRAS.455.2149S">http://adsabs.harvard.edu/abs/2016MNRAS.455.2149S</a>. 
</p>
<p>Sereno M., Ettori S., &quot;CoMaLit-V. Mass forecasting with proxies. Method and application to weak lensing calibrated samples&quot; (2017), MNRAS 468, 3322; electronic version at <a href="http://adsabs.harvard.edu/abs/2017MNRAS.468.3322S">http://adsabs.harvard.edu/abs/2017MNRAS.468.3322S</a>.
</p>
<p>Preprints at <a href="http://pico.oabo.inaf.it/~sereno/LIRA/">http://pico.oabo.inaf.it/~sereno/LIRA/</a>.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+distance.LCDM">distance.LCDM</a></code>, <code><a href="#topic+Hubble.LCDM">Hubble.LCDM</a></code>, <code><a href="rjags.html#topic+jags.model">jags.model</a></code>, <code><a href="rjags.html#topic+coda.samples">coda.samples</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## EXAMPLE 1
## sample length
n.sample &lt;- 20
# intrinsic p(Z) distribution of the independet variable
mu.Z.0 &lt;- 0.0; sigma.Z.0 &lt;- 1.0;
Z &lt;- rnorm(n.sample, mean = mu.Z.0, sd = sigma.Z.0)
# X is unscattered
X &lt;- Z
# observational uncertainties in X
delta.x.sd &lt;- 0.04
delta.x &lt;- rnorm(n.sample, sd = delta.x.sd)
x &lt;- X + delta.x
# scaling relation Y-Z
alpha.YIZ &lt;- 0.0; beta.YIZ &lt;- 1.0; sigma.YIZ.0 &lt;- 0.1;
# dependent variable
Y &lt;- alpha.YIZ + beta.YIZ*Z + rnorm(n.sample, sd = sigma.YIZ.0)
# observational uncertainties in Y
delta.y.sd &lt;- 0.05
delta.y &lt;- rnorm(n.sample, sd = delta.y.sd)
y &lt;- Y + delta.y
data.all &lt;- data.frame(x=x, y=y, delta.x=delta.x.sd, delta.y=delta.y.sd)
# regression
samples &lt;- lira(x, y, delta.x=delta.x, delta.y=delta.y, n.adapt=100, n.iter=1000)

## EXAMPLE 2
## Malmquist bias: only objects with y &gt; y.th are selected.
y.th &lt;- -0.5
# the sample is truncated
data.sel &lt;- data.all[which(data.all$y&gt;y.th),]
n.sel &lt;- nrow(data.sel)
# regression
samples.MB &lt;- lira(data.sel$x, data.sel$y, data.sel$delta.x, data.sel$delta.y, 
y.threshold = rep(y.th,n.sel), n.adapt=100, n.iter=1000, print.summary=FALSE)

## EXAMPLE 3
## Upper limits: objects with y &lt; y.th are left-censored
# censoring
data.ul &lt;- data.all
index.ul &lt;- which(data.ul$y&lt;y.th)
data.ul[index.ul,]$y &lt;- NA
data.ul[index.ul,]$delta.y &lt;- 2
# upper limits for undetected (detected) objects are set to the threshold value (NA).
y.upperlimit &lt;- rep(NA, n.sample) 
y.upperlimit[index.ul] &lt;- y.th
# the regression recovers the parameters of the scaling relation and 
# forecasts the Y-values of the censored objects.
samples.UL &lt;- lira(data.ul$x, data.ul$y, data.ul$delta.x, data.ul$delta.y, 
y.upperlimit = y.upperlimit, n.adapt=100, n.iter=1000, Y.monitored=TRUE)


## Further examples can be found at http://pico.oabo.inaf.it/~sereno/LIRA/.
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
