<!DOCTYPE html><html><head><title>Help for package lmom</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lmom}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lmom-package'><p>The lmom package</p></a></li>
<li><a href='#cdfexp'><p>Exponential distribution</p></a></li>
<li><a href='#cdfgam'><p>Gamma distribution</p></a></li>
<li><a href='#cdfgev'><p>Generalized extreme-value distribution</p></a></li>
<li><a href='#cdfglo'><p>Generalized logistic distribution</p></a></li>
<li><a href='#cdfgno'><p>Generalized normal distribution</p></a></li>
<li><a href='#cdfgpa'><p>Generalized Pareto distribution</p></a></li>
<li><a href='#cdfgum'><p>Gumbel (extreme-value type I) distribution</p></a></li>
<li><a href='#cdfkap'><p>Kappa distribution</p></a></li>
<li><a href='#cdfln3'><p>Three-parameter lognormal distribution</p></a></li>
<li><a href='#cdfnor'><p>Normal distribution</p></a></li>
<li><a href='#cdfpe3'><p>Pearson type III distribution</p></a></li>
<li><a href='#cdfwak'><p>Wakeby distribution</p></a></li>
<li><a href='#cdfwei'><p>Weibull distribution</p></a></li>
<li><a href='#evplot'><p>Extreme-value plot</p></a></li>
<li><a href='#lmr-functions'><p>L-moments of specific probability distributions</p></a></li>
<li><a href='#lmrd'><p>L-moment ratio diagram</p></a></li>
<li><a href='#lmrdpoints'><p>Add points or lines to an L-moment ratio diagram</p></a></li>
<li><a href='#lmrp'><p>L-moments of a general probability distribution</p></a></li>
<li><a href='#pel-functions'><p>Parameter estimation for specific distributions by the method of L-moments</p></a></li>
<li><a href='#pelp'><p>Parameter estimation for a general distribution by the method of L-moments</p></a></li>
<li><a href='#samlmu'><p>Sample L-moments</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-29</td>
</tr>
<tr>
<td>Title:</td>
<td>L-Moments</td>
</tr>
<tr>
<td>Author:</td>
<td>J. R. M. Hosking</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>J. R. M. Hosking &lt;jrmhosking@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions related to L-moments: computation of L-moments
  and trimmed L-moments of distributions and data samples; parameter
  estimation; L-moment ratio diagram; plot vs. quantiles of an
  extreme-value distribution.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.eclipse.org/legal/cpl-v10.html">Common Public License Version 1.0</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-29 02:58:25 UTC; J</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-29 04:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='lmom-package'>The lmom package</h2><span id='topic+L-moments'></span><span id='topic+Lmoments'></span><span id='topic+lmom'></span><span id='topic+lmoments'></span><span id='topic+lmom-package'></span><span id='topic+xsamlmu'></span><span id='topic+xsamlmu.s'></span><span id='topic+xlmrp'></span><span id='topic+xlmrq'></span><span id='topic+xpelp'></span><span id='topic+xpelq'></span><span id='topic+xzpoly'></span><span id='topic+xslp'></span>

<h3>Description</h3>

<p><span class="rlang"><b>R</b></span> functions for use with the method of <code class="reqn">L</code>-moments
</p>


<h3>Details</h3>

<p><code class="reqn">L</code>-moments are measures of the location, scale, and shape
of probability distributions or data samples.
They are based on linear combinations of order statistics.
Hosking (1990) and Hosking and Wallis (1997, chap. 2) give expositions
of the theory of <code class="reqn">L</code>-moments and <code class="reqn">L</code>-moment ratios.  Hosking and Wallis
(1997, Appendix) give, for many distributions in common use, expressions
for the <code class="reqn">L</code>-moments of the distributions and algorithms for estimating
the parameters of the distributions by equating sample and population
<code class="reqn">L</code>-moments (the &ldquo;method of <code class="reqn">L</code>-moments&rdquo;).  This package contains <span class="rlang"><b>R</b></span> functions
that should facilitate the use of <code class="reqn">L</code>-moment-based methods.
</p>
<p>For each of 13 probability distributions, the package contains
functions to evaluate the cumulative distribution function and quantile
function of the distribution, to calculate the <code class="reqn">L</code>-moments given the
parameters and to calculate the parameters given the low-order
<code class="reqn">L</code>-moments.  These functions are as follows.
</p>
<p><code>cdf...</code>
computes the cumulative distribution function of the distribution.
</p>
<p><code>qua...</code>
computes the quantile function (inverse cumulative distribution function)
of the distribution.
</p>
<p><code>lmr...</code>
calculates the <code class="reqn">L</code>-moment ratios of the distribution given its
parameters.
</p>
<p><code>pel...</code>
calculates the parameters of the distribution given its <code class="reqn">L</code>-moments.
When the <code class="reqn">L</code>-moments are the sample <code class="reqn">L</code>-moments of a set of data,
the resulting parameters are of course the
&ldquo;method of <code class="reqn">L</code>-moments&rdquo; estimates of the parameters.
</p>
<p>Here <code>...</code> is a three-letter code used to identify the distribution,
as given in the table below.
For example the cumulative distribution function of the gamma distribution
is <code>cdfgam</code>.
</p>

<table>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>exp</code> </td><td style="text-align: left;"> exponential </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>gam</code> </td><td style="text-align: left;"> gamma </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>gev</code> </td><td style="text-align: left;"> generalized extreme-value </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>glo</code> </td><td style="text-align: left;"> generalized logistic </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>gpa</code> </td><td style="text-align: left;"> generalized Pareto </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>gno</code> </td><td style="text-align: left;"> generalized normal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>gum</code> </td><td style="text-align: left;"> Gumbel (extreme-value type I) </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>kap</code> </td><td style="text-align: left;"> kappa </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>ln3</code> </td><td style="text-align: left;"> lognormal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>nor</code> </td><td style="text-align: left;"> normal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pe3</code> </td><td style="text-align: left;"> Pearson type III </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>wak</code> </td><td style="text-align: left;"> Wakeby </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>wei</code> </td><td style="text-align: left;"> Weibull </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>The following functions are also contained in the package.
</p>
<p><code><a href="#topic+samlmu">samlmu</a></code>
computes the sample <code class="reqn">L</code>-moments of a data vector.
</p>
<p><code><a href="#topic+lmrp">lmrp</a></code> and <code><a href="#topic+lmrq">lmrq</a></code>
compute the <code class="reqn">L</code>-moments of a probability distribution specified
by its cumulative distribution function (for function <code>lmrp</code>)
or its quantile function (for function <code>lmrq</code>).
The computation uses numerical integration applied to
a general expression for the <code class="reqn">L</code>-moments of a distribution.
Functions <code>lmrp</code> and <code>lmrq</code> can be used for any univariate
distribution.  They are slower and usually less accurate than the
computations carried out for specific distributions by the
<code>lmr...</code> functions.
</p>
<p><code><a href="#topic+pelp">pelp</a></code> and <code><a href="#topic+pelq">pelq</a></code>
compute the parameters of a probability distribution
as a function of the <code class="reqn">L</code>-moments.
The computation uses function <code>lmrp</code> or <code>lmrq</code> to compute
<code class="reqn">L</code>-moments and numerical optimization to find parameter values
for which the sample and population <code class="reqn">L</code>-moments are equal.
Functions <code>pelp</code> and <code>pelq</code> can be used for any univariate
distribution.  They are slower and usually less accurate than the
computations carried out for specific distributions by the
<code>pel...</code> functions.
</p>
<p><code><a href="#topic+lmrd">lmrd</a></code>
draws an <code class="reqn">L</code>-moment ratio diagram.
</p>
<p><code><a href="#topic+lmrdpoints">lmrdpoints</a></code> and <code><a href="#topic+lmrdlines">lmrdlines</a></code>
add points, or connected line segments, respectively,
to an <code class="reqn">L</code>-moment ratio diagram.
</p>
<p><code><a href="#topic+evplot">evplot</a></code>
draws an &ldquo;extreme-value plot&rdquo;, i.e. a quantile-quantile plot
in which the horizontal axis is the quantile of an
extreme-value type I (Gumbel) distribution.
</p>
<p><code><a href="#topic+evpoints">evpoints</a></code>, <code><a href="#topic+evdistp">evdistp</a></code>, and <code><a href="#topic+evdistq">evdistq</a></code>
add, respectively, a set of points, a cumulative distribution function,
and a quantile function to an extreme-value plot.
</p>


<h3>Trimmed <code class="reqn">L</code>-moments</h3>

<p>Some functions support the trimmed <code class="reqn">L</code>-moments defined by Elamir and Seheult (2003).
Trimmed <code class="reqn">L</code>-moments are based on linear combinations of order statistics
that give zero weight to the most extreme order statistics and thereby can be
defined for very heavy-tailed distributions that do not have a finite mean.
</p>
<p>Function <code><a href="#topic+samlmu">samlmu</a></code> can compute sample trimmed <code class="reqn">L</code>-moments.
Functions <code><a href="#topic+lmrp">lmrp</a></code> and <code><a href="#topic+lmrq">lmrq</a></code> can compute trimmed <code class="reqn">L</code>-moments
of probability distributions.
Functions <code><a href="#topic+pelp">pelp</a></code> and <code><a href="#topic+pelq">pelq</a></code> can calculate parameters
of a probability distribution given its trimmed <code class="reqn">L</code>-moments.
</p>
<p>The distribution-specific functions <code>lmr...</code> and <code>pel...</code> and the
functions for <code class="reqn">L</code>-moment ratio diagrams (<code>lmrd</code>, etc.) currently
do not support trimmed <code class="reqn">L</code>-moments.
</p>


<h3>Parameters of cumulative distribution functions and quantile functions</h3>

<p>The functions <code>cdf...</code> (cumulative distribution functions)
and <code>qua...</code> (quantile functions) expect the distribution
parameters to be specified as a single vector.
This differs from the standard <span class="rlang"><b>R</b></span> convention, in which
each parameter is a separate argument.
There are two reasons for this.
First, the single-vector parametrization is consistent with
the Fortran routines on which these <span class="rlang"><b>R</b></span> functions are based.
Second, the single-vector parametrization is often easier to use.
For example, consider computing the 80th and 90th percentiles
of a normal distribution fitted to a set of <code class="reqn">L</code>-moments
stored in a vector <code>lmom</code>.
In the single-vector parametrization, this is achieved by
</p>
<pre>
  quanor( c(.8,.9), pelnor(lmom) )
</pre>
<p>The separate-arguments parametrization would need a more complex
expression, such as
</p>
<pre>
  do.call( qnorm, c( list(.8,.9), pelnor(lmom) ) )
</pre>
<p>In functions (<code>lmrp</code>, <code>lmrq</code>, <code>pelp</code>, <code>pelq</code>, <code>evplot</code>,
<code>evdistp</code>, <code>evdistq</code>) that take a cumulative distribution function
or a quantile function as an argument, the cumulative distribution function
or quantile function can use either form of parametrization.
</p>


<h3>Relation to the LMOMENTS Fortran package</h3>

<p>Functions <code>cdf...</code>, <code>qua...</code>, <code>lmr...</code>, <code>pel...</code>,
and <code>samlmu</code> are analogous to Fortran routines from
the LMOMENTS package, version 3.04, available from StatLib at
<a href="http://lib.stat.cmu.edu/general/lmoments">http://lib.stat.cmu.edu/general/lmoments</a>.
Functions <code>cdfwak</code> and <code>samlmu</code>, and all the <code>lmr...</code> and <code>pel...</code>
functions, internally call Fortran code that is derived from the
LMOMENTS package.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Elamir, E. A. H., and Seheult, A. H. (2003).  Trimmed L-moments.
<em>Computational Statistics and Data Analysis</em>, <b>43</b>, 299-314.
</p>
<p>Hosking, J. R. M. (1990).
<code class="reqn">L</code>-moments: analysis and estimation of distributions
using linear combinations of order statistics.
<em>Journal of the Royal Statistical Society, Series B</em>, <b>52</b>, 105-124.
</p>
<p>Hosking, J. R. M., and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on L-moments</em>.
Cambridge University Press.
</p>

<hr>
<h2 id='cdfexp'>Exponential distribution</h2><span id='topic+cdfexp'></span><span id='topic+quaexp'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the exponential distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfexp(x, para = c(0, 1))
quaexp(f, para = c(0, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfexp_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfexp_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfexp_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\xi, \alpha</code> (location, scale).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The exponential distribution with parameters
<code class="reqn">\xi</code> (lower bound) and <code class="reqn">\alpha</code> (mean)
has distribution function
</p>
<p style="text-align: center;"><code class="reqn">F(x)=1-\exp\lbrace-(x-\xi)/\alpha\rbrace</code>
</p>

<p>for <code class="reqn">x\ge0</code>, and quantile function
</p>
<p style="text-align: center;"><code class="reqn">x(F)=\xi-\alpha\log(1-F).</code>
</p>



<h3>Value</h3>

<p><code>cdfexp</code> gives the distribution function;
<code>quaexp</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span> functions
<code>pexp</code> and <code>qexp</code>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+pexp">pexp</a></code> for the standard <span class="rlang"><b>R</b></span> version of the exponential distribution.
<code><a href="#topic+cdfgam">cdfgam</a></code> for the gamma distribution,
<code><a href="#topic+cdfgpa">cdfgpa</a></code> for the generalized Pareto distribution,
<code><a href="#topic+cdfkap">cdfkap</a></code> for the kappa distribution,
<code><a href="#topic+cdfpe3">cdfpe3</a></code> for the Pearson type III distribution,
and <code><a href="#topic+cdfwak">cdfwak</a></code> for the Wakeby distribution,
all of which generalize the exponential distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from the exponential distribution
# with lower bound 0 and mean 3.
quaexp(runif(100), c(0,3))
</code></pre>

<hr>
<h2 id='cdfgam'>Gamma distribution</h2><span id='topic+cdfgam'></span><span id='topic+quagam'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the gamma distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfgam(x, para = c(1, 1))
quagam(f, para = c(1, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfgam_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfgam_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfgam_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\alpha, \beta</code> (shape, scale).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The gamma distribution with
shape parameter <code class="reqn">\alpha</code> and
scale parameter <code class="reqn">\beta</code> has probability density function
</p>
<p style="text-align: center;"><code class="reqn">f(x)={x^{\alpha-1} \exp(-x/\beta) \over \beta^\alpha \Gamma(\alpha)}</code>
</p>

<p>for <code class="reqn">x\ge0</code>, where <code class="reqn">\Gamma(.)</code> is the gamma function.
</p>


<h3>Value</h3>

<p><code>cdfgam</code> gives the distribution function;
<code>quagam</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span> functions
<code>pgamma</code> and <code>qgamma</code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+gamma">gamma</a></code> for the gamma function.
</p>
<p><code><a href="stats.html#topic+pgamma">pgamma</a></code> for the standard <span class="rlang"><b>R</b></span> version of the gamma distribution.
</p>
<p><code><a href="#topic+cdfpe3">cdfpe3</a></code> for the Pearson type III distribution,
which generalizes the gamma distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from the gamma distribution
# with shape parameter 4 and mean 1.
quagam(runif(100), c(4,1/4))
</code></pre>

<hr>
<h2 id='cdfgev'>Generalized extreme-value distribution</h2><span id='topic+cdfgev'></span><span id='topic+quagev'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the generalized extreme-value distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfgev(x, para = c(0, 1, 0))
quagev(f, para = c(0, 1, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfgev_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfgev_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfgev_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\xi, \alpha, k</code> (location, scale, shape).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized extreme-value distribution with
location parameter <code class="reqn">\xi</code>,
scale parameter <code class="reqn">\alpha</code> and
shape parameter <code class="reqn">k</code> has distribution function
</p>
<p style="text-align: center;"><code class="reqn">F(x)=\exp\lbrace-\exp(-y)\rbrace</code>
</p>
<p> where
</p>
<p style="text-align: center;"><code class="reqn">y=-k^{-1}\log\lbrace1-k(x-\xi)/\alpha\rbrace,</code>
</p>

<p>with <code class="reqn">x</code> bounded by <code class="reqn">\xi+\alpha/k</code>
from below if <code class="reqn">k&lt;0</code> and from above if <code class="reqn">k&gt;0</code>,
and quantile function
</p>
<p style="text-align: center;"><code class="reqn">x(F)=\xi+{\alpha\over k}\lbrace1-(-\log F)^k\rbrace.</code>
</p>

<p>Extreme-value distribution types I, II and III (Gumbel, Frechet, Weibull)
correspond to shape parameter values
<code class="reqn">k=0</code>, <code class="reqn">k&lt;0</code> and <code class="reqn">k&gt;0</code> respectively.
</p>


<h3>Value</h3>

<p><code>cdfgev</code> gives the distribution function;
<code>quagev</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span>
distribution functions <code>pnorm</code>, <code>qnorm</code>, etc.
</p>
<p>Two parametrizations of the generalized extreme-value distribution are in common use.
When Jenkinson (1955) introduced the distribution
he wrote the distribution function in the form
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \exp [ - \lbrace 1 - k ( x - \xi ) / \alpha) \rbrace^{1/k}].</code>
</p>

<p>and that is the form used in <span class="rlang"><b>R</b></span> package <span class="pkg">lmom</span>.  A slight inconvenience with it is that the
skewness of the distribution is a decreasing function of the shape parameter <code class="reqn">k</code>.
Perhaps for this reason, authors of some other <span class="rlang"><b>R</b></span> packages prefer a form in which
the sign of the shape parameter <code class="reqn">k</code> is changed and the parameters are renamed:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \exp [ - \lbrace 1 + \xi ( x - \mu ) / \sigma) \rbrace^{-1/\xi}].</code>
</p>

<p>Users should be able to mix functions from packages that use either form; just be aware that
the sign of the shape parameter will need to be changed when converting from one form to the other
(and that <code class="reqn">\xi</code> is a location parameter in one form and a shape parameter in the other).
</p>


<h3>References</h3>

<p>Jenkinson, A. F. (1955). The frequency distribution of the annual maximum
(or minimum) of meteorological elements.
<em>Quarterly Journal of the Royal Meteorological Society</em>, <b>81</b>, 158-171.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdfgum">cdfgum</a></code> for the Gumbel (extreme-value type I) distribution.
</p>
<p><code><a href="#topic+cdfkap">cdfkap</a></code> for the kappa distribution,
which generalizes the generalized extreme-value distribution.
</p>
<p><code><a href="#topic+cdfwei">cdfwei</a></code> for the Weibull distribution,
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from the generalized extreme-value distribution
# with parameters xi=0, alpha=1, k=-0.5.
quagev(runif(100), c(0,1,-0.5))
</code></pre>

<hr>
<h2 id='cdfglo'>Generalized logistic distribution</h2><span id='topic+cdfglo'></span><span id='topic+quaglo'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the generalized logistic distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfglo(x, para = c(0, 1, 0))
quaglo(f, para = c(0, 1, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfglo_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfglo_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfglo_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\xi, \alpha, k</code> (location, scale, shape).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized logistic distribution with
location parameter <code class="reqn">\xi</code>,
scale parameter <code class="reqn">\alpha</code> and
shape parameter <code class="reqn">k</code> has distribution function
</p>
<p style="text-align: center;"><code class="reqn">F(x)=1/\lbrace 1+\exp(-y)\rbrace</code>
</p>
<p> where
</p>
<p style="text-align: center;"><code class="reqn">y=-k^{-1}\log\lbrace1-k(x-\xi)/\alpha\rbrace,</code>
</p>

<p>with <code class="reqn">x</code> bounded by <code class="reqn">\xi+\alpha/k</code>
from below if <code class="reqn">k&lt;0</code> and from above if <code class="reqn">k&gt;0</code>,
and quantile function
</p>
<p style="text-align: center;"><code class="reqn">x(F)=\xi+{\alpha\over k}\biggl\lbrace1-\biggl({1-F \over F}\biggr)^k\biggr\rbrace.</code>
</p>

<p>The logistic distribution is the special case <code class="reqn">k=0</code>.
</p>


<h3>Value</h3>

<p><code>cdfglo</code> gives the distribution function;
<code>quaglo</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span>
distribution functions <code>pnorm</code>, <code>qnorm</code>, etc.</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdfkap">cdfkap</a></code> for the kappa distribution,
which generalizes the generalized logistic distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from the generalized logistic distribution
# with parameters xi=0, alpha=1, k=-0.5.
quaglo(runif(100), c(0,1,-0.5))
</code></pre>

<hr>
<h2 id='cdfgno'>Generalized normal distribution</h2><span id='topic+cdfgno'></span><span id='topic+quagno'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the generalized normal distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfgno(x, para = c(0, 1, 0))
quagno(f, para = c(0, 1, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfgno_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfgno_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfgno_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\xi, \alpha, k</code> (location, scale, shape).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized normal distribution with
location parameter <code class="reqn">\xi</code>,
scale parameter <code class="reqn">\alpha</code> and
shape parameter <code class="reqn">k</code> has distribution function
</p>
<p style="text-align: center;"><code class="reqn">F(x)=\Phi(y)</code>
</p>
<p> where
</p>
<p style="text-align: center;"><code class="reqn">y=-k^{-1}\log\lbrace1-k(x-\xi)/\alpha\rbrace</code>
</p>

<p>and <code class="reqn">\Phi(y)</code> is the distribution function of the standard normal distribution,
with <code class="reqn">x</code> bounded by <code class="reqn">\xi+\alpha/k</code>
from below if <code class="reqn">k&lt;0</code> and from above if <code class="reqn">k&gt;0</code>.
</p>
<p>The generalized normal distribution contains as special cases the usual
three-parameter lognormal distribution, corresponding to <code class="reqn">k&lt;0</code>,
with a finite lower bound and positive skewness;
the normal distribution, corresponding to <code class="reqn">k=0</code>;
and the reverse lognormal distribution, corresponding to <code class="reqn">k&gt;0</code>,
with a finite upper bound and negative skewness.
The two-parameter lognormal distribution,
with a lower bound of zero and positive skewness,
is obtained when <code class="reqn">k&lt;0</code> and <code class="reqn">\xi+\alpha/k=0</code>.
</p>


<h3>Value</h3>

<p><code>cdfgno</code> gives the distribution function;
<code>quagno</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span>
distribution functions <code>pnorm</code>, <code>qnorm</code>, etc.</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdfln3">cdfln3</a></code> for the <span class="pkg">lmom</span> package's version of the three-parameter
lognormal distribution.
</p>
<p><code><a href="#topic+cdfnor">cdfnor</a></code> for the <span class="pkg">lmom</span> package's version of the normal distribution.
</p>
<p><code><a href="stats.html#topic+pnorm">pnorm</a></code> for the standard <span class="rlang"><b>R</b></span> version of the normal distribution.
</p>
<p><code><a href="stats.html#topic+plnorm">plnorm</a></code> for the standard <span class="rlang"><b>R</b></span> version of the two-parameter lognormal distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from the generalized normal distribution
# with parameters xi=0, alpha=1, k=-0.5.
quagno(runif(100), c(0,1,-0.5))

# The generalized normal distribution with parameters xi=1, alpha=1, k=-1,
# is the standard lognormal distribution.  An illustration:
fval&lt;-seq(0.1,0.9,by=0.1)
cbind(fval, lognormal=qlnorm(fval), g.normal=quagno(fval, c(1,1,-1)))
</code></pre>

<hr>
<h2 id='cdfgpa'>Generalized Pareto distribution</h2><span id='topic+cdfgpa'></span><span id='topic+quagpa'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the generalized Pareto distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfgpa(x, para = c(0, 1, 0))
quagpa(f, para = c(0, 1, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfgpa_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfgpa_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfgpa_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\xi, \alpha, k</code> (location, scale, shape).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generalized Pareto distribution with
location parameter <code class="reqn">\xi</code>,
scale parameter <code class="reqn">\alpha</code> and
shape parameter <code class="reqn">k</code> has distribution function
</p>
<p style="text-align: center;"><code class="reqn">F(x)=1-\exp(-y)</code>
</p>
<p> where
</p>
<p style="text-align: center;"><code class="reqn">y=-k^{-1}\log\lbrace1-k(x-\xi)/\alpha\rbrace,</code>
</p>

<p>with <code class="reqn">x</code> bounded by <code class="reqn">\xi+\alpha/k</code>
from below if <code class="reqn">k&lt;0</code> and from above if <code class="reqn">k&gt;0</code>,
and quantile function
</p>
<p style="text-align: center;"><code class="reqn">x(F)=\xi+{\alpha\over k}\lbrace 1-(1-F)^k\rbrace.</code>
</p>

<p>The exponential distribution is the special case <code class="reqn">k=0</code>.
The uniform distribution is the special case <code class="reqn">k=1</code>.
</p>


<h3>Value</h3>

<p><code>cdfgpa</code> gives the distribution function;
<code>quagpa</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span>
distribution functions <code>pnorm</code>, <code>qnorm</code>, etc.
</p>
<p>Two parametrizations of the generalized Pareto distribution are in common use.
When Jenkinson (1955) introduced the generalized extreme-value distribution
he wrote the distribution function in the form
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \exp [ - \lbrace 1 - k ( x - \xi ) / \alpha) \rbrace^{1/k}].</code>
</p>

<p>Hosking and Wallis (1987) wrote the distribution function of the
generalized Pareto distribution analogously as
</p>
<p style="text-align: center;"><code class="reqn">F(x) = 1 - \lbrace 1 - k ( x - \xi ) / \alpha) \rbrace^{1/k}</code>
</p>

<p>and that is the form used in <span class="rlang"><b>R</b></span> package <span class="pkg">lmom</span>.  A slight inconvenience with it is that the
skewness of the distribution is a decreasing function of the shape parameter <code class="reqn">k</code>.
Perhaps for this reason, authors of some other <span class="rlang"><b>R</b></span> packages prefer a form in which
the sign of the shape parameter <code class="reqn">k</code> is changed and the parameters are renamed:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = 1 - \lbrace 1 + \xi ( x - \mu ) / \sigma) \rbrace ^{-1/\xi}.</code>
</p>

<p>Users should be able to mix functions from packages that use either form; just be aware that
the sign of the shape parameter will need to be changed when converting from one form to the other
(and that <code class="reqn">\xi</code> is a location parameter in one form and a shape parameter in the other).
</p>


<h3>References</h3>

<p>Hosking, J. R. M., and Wallis, J. R. (1987). Parameter and quantile estimation
for the generalized Pareto distribution.
<em>Technometrics</em>, <b>29</b>, 339-349.
</p>
<p>Jenkinson, A. F. (1955). The frequency distribution of the annual maximum
(or minimum) of meteorological elements.
<em>Quarterly Journal of the Royal Meteorological Society</em>, <b>81</b>, 158-171.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdfexp">cdfexp</a></code> for the exponential distribution.
</p>
<p><code><a href="#topic+cdfkap">cdfkap</a></code> for the kappa distribution and
<code><a href="#topic+cdfwak">cdfwak</a></code> for the Wakeby distribution,
which generalize the generalized Pareto distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from the generalized Pareto distribution
# with parameters xi=0, alpha=1, k=-0.5.
quagpa(runif(100), c(0,1,-0.5))
</code></pre>

<hr>
<h2 id='cdfgum'>Gumbel (extreme-value type I) distribution</h2><span id='topic+cdfgum'></span><span id='topic+quagum'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the Gumbel distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfgum(x, para = c(0, 1))
quagum(f, para = c(0, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfgum_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfgum_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfgum_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\xi, \alpha</code> (location, scale).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Gumbel distribution with
location parameter <code class="reqn">\xi</code> and
scale parameter <code class="reqn">\alpha</code>
has distribution function
</p>
<p style="text-align: center;"><code class="reqn">F(x)=\exp[-\exp\lbrace-(x-\xi)/\alpha\rbrace]</code>
</p>

<p>and quantile function
</p>
<p style="text-align: center;"><code class="reqn">x(F)=\xi-\alpha\log(-\log F).</code>
</p>



<h3>Value</h3>

<p><code>cdfgum</code> gives the distribution function;
<code>quagum</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span>
distribution functions <code>pnorm</code>, <code>qnorm</code>, etc.</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdfgev">cdfgev</a></code> for the generalized extreme-value distribution,
which generalizes the Gumbel distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from the Gumbel distribution with parameters xi=0, alpha=3.
quagum(runif(100), c(0,3))
</code></pre>

<hr>
<h2 id='cdfkap'>Kappa distribution</h2><span id='topic+cdfkap'></span><span id='topic+quakap'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the kappa distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfkap(x, para = c(0, 1, 0, 0))
quakap(f, para = c(0, 1, 0, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfkap_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfkap_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfkap_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\xi, \alpha, k, h</code> (location, scale,
shape, shape).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The kappa distribution with
location parameter <code class="reqn">\xi</code>,
scale parameter <code class="reqn">\alpha</code> and
shape parameters <code class="reqn">k</code> and <code class="reqn">h</code>
has quantile function
</p>
<p style="text-align: center;"><code class="reqn">x(F)=\xi+{\alpha\over k}\biggl\lbrace1-\biggl({1-F^h \over h}\biggr)^k\biggr\rbrace.</code>
</p>

<p>Its special cases include the
generalized logistic (<code class="reqn">h=-1</code>),
generalized extreme-value (<code class="reqn">h=0</code>),
generalized Pareto (<code class="reqn">h=1</code>),
logistic (<code class="reqn">k=0</code>, <code class="reqn">h=-1</code>),
Gumbel (<code class="reqn">k=0</code>, <code class="reqn">h=0</code>),
exponential (<code class="reqn">k=0</code>, <code class="reqn">h=1</code>), and
uniform (<code class="reqn">k=1</code>, <code class="reqn">h=1</code>) distributions.
</p>


<h3>Value</h3>

<p><code>cdfkap</code> gives the distribution function;
<code>quakap</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span>
distribution functions <code>pnorm</code>, <code>qnorm</code>, etc.</p>


<h3>References</h3>

<p>Hosking, J. R. M. (1994). The four-parameter kappa distribution.
<em>IBM Journal of Research and Development</em>, <b>38</b>, 251-258.
</p>
<p>Hosking, J. R. M., and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on L-moments</em>,
Cambridge University Press, Appendix A.10.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdfglo">cdfglo</a></code> for the generalized logistic distribution,
<code><a href="#topic+cdfgev">cdfgev</a></code> for the generalized extreme-value distribution,
<code><a href="#topic+cdfgpa">cdfgpa</a></code> for the generalized Pareto distribution,
<code><a href="#topic+cdfgum">cdfgum</a></code> for the Gumbel distribution,
<code><a href="#topic+cdfexp">cdfexp</a></code> for the exponential distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from the kappa distribution
# with parameters xi=0, alpha=1, k=-0.5, h=0.25.
quakap(runif(100), c(0,1,-0.5,0.25))
</code></pre>

<hr>
<h2 id='cdfln3'>Three-parameter lognormal distribution</h2><span id='topic+cdfln3'></span><span id='topic+qualn3'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the three-parameter lognormal distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfln3(x, para = c(0, 0, 1))
qualn3(f, para = c(0, 0, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfln3_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfln3_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfln3_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\zeta, \mu, \sigma</code>
(lower bound, mean on log scale, standard deviation on log scale).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The three-parameter lognormal distribution with
lower bound <code class="reqn">\zeta</code>,
mean on log scale <code class="reqn">\mu</code>, and
standard deviation on log scale <code class="reqn">\sigma</code> has distribution function
</p>
<p style="text-align: center;"><code class="reqn">F(x)=\Phi(y),</code>
</p>
 <p><code class="reqn">x&gt;0</code>, where
</p>
<p style="text-align: center;"><code class="reqn">y=\lbrace\log(x - \zeta)-\mu\rbrace/\sigma</code>
</p>

<p>and <code class="reqn">\Phi(y)</code> is the distribution function of the standard
normal distribution.
</p>


<h3>Value</h3>

<p><code>cdfln3</code> gives the distribution function;
<code>qualn3</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span>
distribution functions <code>pnorm</code>, <code>qnorm</code>, etc.</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdfgno">cdfgno</a></code> for the generalized normal distribution,
a more general form of the three-parameter lognormal distribution.
</p>
<p><code><a href="stats.html#topic+qlnorm">qlnorm</a></code> for the standard <span class="rlang"><b>R</b></span> version of the
two-parameter lognormal distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from three-parameter lognormal distribution
# with parameters zeta=0, mu=1, sigma=0.5.
qualn3(runif(100), c(0,1,0.5))

## Functions for the three-parameter lognormal distribution can
## also be used with the two-parameter lognormal distribution
# Generate a random sample from a standard lognormal distribution
xx &lt;- qualn3(runif(50))
# Fit 2-parameter LN distribution
pelln3(samlmu(xx), bound=0)
# Fit 2-parameter LN distribution "in log space",
# i.e. fit normal distribution to log-transformed data
pelnor(samlmu(log(xx)))
</code></pre>

<hr>
<h2 id='cdfnor'>Normal distribution</h2><span id='topic+cdfnor'></span><span id='topic+quanor'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the normal distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfnor(x, para = c(0, 1))
quanor(f, para = c(0, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfnor_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfnor_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfnor_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\mu, \sigma</code> (location, scale).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The normal distribution with
location parameter <code class="reqn">\mu</code> and
scale parameter <code class="reqn">\sigma</code>
has probability density function
</p>
<p style="text-align: center;"><code class="reqn">f(x)={1\over \sigma\sqrt{2\pi}} \exp\lbrace-(x-\mu)^2/(2 \sigma^2)\rbrace.</code>
</p>



<h3>Value</h3>

<p><code>cdfnor</code> gives the distribution function;
<code>quanor</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span>
distribution functions <code>pnorm</code> and <code>qnorm</code>.</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+pnorm">pnorm</a></code> for the standard <span class="rlang"><b>R</b></span> version of the normal distribution.
</p>
<p><code><a href="#topic+cdfgno">cdfgno</a></code> for the generalized normal distribution,
which generalizes the normal distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from the normal distribution
# with mean 0 and standard deviation 3.
quanor(runif(100), c(0,3))
</code></pre>

<hr>
<h2 id='cdfpe3'>Pearson type III distribution</h2><span id='topic+cdfpe3'></span><span id='topic+quape3'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the Pearson type III distribution</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfpe3(x, para = c(0, 1, 0))
quape3(f, para = c(0, 1, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfpe3_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfpe3_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfpe3_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\mu, \sigma, \gamma</code>
(location, scale, shape).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Pearson type III distribution contains as special cases
the usual three-parameter gamma distribution
(a shifted version of the gamma distribution)
with a finite lower bound and positive skewness;
the normal distribution,
and the reverse three-parameter gamma distribution,
with a finite upper bound and negative skewness.
The distribution's parameters are the first three (ordinary) moment ratios:
<code class="reqn">\mu</code> (the mean, a location parameter),
<code class="reqn">\sigma</code> (the standard deviation, a scale parameter) and
<code class="reqn">\gamma</code> (the skewness, a shape parameter).
</p>
<p>If <code class="reqn">\gamma\ne0</code>, let <code class="reqn">\alpha=4/\gamma^2</code>,
<code class="reqn">\beta={\scriptstyle 1 \over \scriptstyle 2}\sigma|\gamma|</code>,
<code class="reqn">\xi=\mu-2\sigma/\gamma</code>.
The probability density function is
</p>
<p style="text-align: center;"><code class="reqn">f(x)={|x-\xi|^{\alpha-1}\exp(-|x-\xi|/\beta) \over \beta^\alpha\Gamma(\alpha)}</code>
</p>

<p>with <code class="reqn">x</code> bounded by <code class="reqn">\xi</code> from below if <code class="reqn">\gamma&gt;0</code>
and from above if <code class="reqn">\gamma&lt;0</code>.
If <code class="reqn">\gamma=0</code>, the distribution is a normal distribution
with mean <code class="reqn">\mu</code> and standard deviation <code class="reqn">\sigma</code>.
</p>
<p>The Pearson type III distribution is usually regarded as consisting of
just the case <code class="reqn">\gamma&gt;0</code> given above, and is usually
parametrized by <code class="reqn">\alpha</code>, <code class="reqn">\beta</code> and <code class="reqn">\xi</code>.
Our parametrization extends the distribution to include
the usual Pearson type III distributions,
with positive skewness and lower bound <code class="reqn">\xi</code>,
reverse Pearson type III distributions,
with negative skewness and upper bound <code class="reqn">\xi</code>,
and the Normal distribution, which is included as a special
case of the distribution rather than as the unattainable limit
<code class="reqn">\alpha\rightarrow\infty</code>.
This enables the Pearson type III distribution to be used when the skewness of
the observed data may be negative.
The parameters <code class="reqn">\mu</code>, <code class="reqn">\sigma</code> and <code class="reqn">\gamma</code>
are the conventional moments of the distribution.
</p>
<p>The gamma distribution is obtained when <code class="reqn">\gamma&gt;0</code>
and <code class="reqn">\mu=2\sigma/\gamma</code>.
The normal distribution is the special case <code class="reqn">\gamma=0</code>.
The exponential distribution is the special case <code class="reqn">\gamma=2</code>.
</p>


<h3>Value</h3>

<p><code>cdfpe3</code> gives the distribution function;
<code>quape3</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span>
distribution functions <code>pnorm</code>, <code>qnorm</code>, etc.</p>


<h3>References</h3>

<p>Hosking, J. R. M. and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on L-moments</em>,
Cambridge University Press, Appendix A.10.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdfgam">cdfgam</a></code> for the gamma distribution.
</p>
<p><code><a href="#topic+cdfnor">cdfnor</a></code> for the normal distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from the Pearson type III distribution
# with parameters mu=1, alpha=2, gamma=3.
quape3(runif(100), c(1,2,3))

# The Pearson type III distribution with parameters
# mu=12, sigma=6, gamma=1, is the gamma distribution
# with parameters alpha=4, beta=3.  An illustration:
fval&lt;-seq(0.1,0.9,by=0.1)
cbind(fval, qgamma(fval, shape=4, scale=3), quape3(fval, c(12,6,1)))
</code></pre>

<hr>
<h2 id='cdfwak'>Wakeby distribution</h2><span id='topic+cdfwak'></span><span id='topic+quawak'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the Wakeby distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfwak(x, para = c(0, 1, 0, 0, 0))
quawak(f, para = c(0, 1, 0, 0, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfwak_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfwak_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfwak_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order
<code class="reqn">\xi, \alpha, \beta, \gamma, \delta</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Wakeby distribution with
parameters <code class="reqn">\xi</code>,
<code class="reqn">\alpha</code>,
<code class="reqn">\beta</code>,
<code class="reqn">\gamma</code> and
<code class="reqn">\delta</code>
has quantile function
</p>
<p style="text-align: center;"><code class="reqn">x(F)=\xi+{\alpha\over\beta}\lbrace1-(1-F)^\beta\rbrace-{\gamma\over\delta}\lbrace1-(1-F)^{-\delta}\rbrace.</code>
</p>

<p>The parameters are restricted as in Hosking and Wallis (1997, Appendix A.11):
</p>

<ul>
<li><p> either <code class="reqn">\beta+\delta&gt;0</code> or
<code class="reqn">\beta=\gamma=\delta=0</code>;
</p>
</li>
<li><p> if <code class="reqn">\alpha=0</code> then <code class="reqn">\beta=0</code>;
</p>
</li>
<li><p> if <code class="reqn">\gamma=0</code> then <code class="reqn">\delta=0</code>;
</p>
</li>
<li> <p><code class="reqn">\gamma\ge0</code>;
</p>
</li>
<li> <p><code class="reqn">\alpha+\gamma\ge0</code>.
</p>
</li></ul>

<p>The distribution has a lower bound at <code class="reqn">\xi</code> and,
if <code class="reqn">\delta&lt;0</code>, an upper bound at
<code class="reqn">\xi+\alpha/\beta-\gamma/\delta</code>.
</p>
<p>The generalized Pareto distribution is the special case
<code class="reqn">\alpha=0</code> or <code class="reqn">\gamma=0</code>.
The exponential distribution is the special case
<code class="reqn">\beta=\gamma=\delta=0</code>.
The uniform distribution is the special case
<code class="reqn">\beta=1</code>, <code class="reqn">\gamma=\delta=0</code>.
</p>


<h3>Value</h3>

<p><code>cdfwak</code> gives the distribution function;
<code>quawak</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span>
distribution functions <code>pnorm</code>, <code>qnorm</code>, etc.</p>


<h3>References</h3>

<p>Hosking, J. R. M. and Wallis, J. R. (1997).
<em>Regional frequency analysis: an approach based on L-moments</em>,
Cambridge University Press, Appendix A.11.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdfgpa">cdfgpa</a></code> for the generalized Pareto distribution.
</p>
<p><code><a href="#topic+cdfexp">cdfexp</a></code> for the exponential distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from the Wakeby distribution
# with parameters xi=0, alpha=30, beta=20, gamma=1, delta=0.3.
quawak(runif(100), c(0,30,20,1,0.3))
</code></pre>

<hr>
<h2 id='cdfwei'>Weibull distribution</h2><span id='topic+cdfwei'></span><span id='topic+quawei'></span>

<h3>Description</h3>

<p>Distribution function and quantile function
of the Weibull distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdfwei(x, para = c(0, 1, 1))
quawei(f, para = c(0, 1, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdfwei_+3A_x">x</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="cdfwei_+3A_f">f</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="cdfwei_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution,
in the order <code class="reqn">\zeta, \beta, \delta</code>
(location, scale, shape).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Weibull distribution with
location parameter <code class="reqn">\zeta</code>,
scale parameter <code class="reqn">\beta</code> and
shape parameter <code class="reqn">\delta</code> has distribution function
</p>
<p style="text-align: center;"><code class="reqn">F(x)=1-\exp[-\lbrace(x-\zeta)/\beta\rbrace^\delta]</code>
</p>

<p>for <code class="reqn">x&gt;\zeta</code>.
</p>


<h3>Value</h3>

<p><code>cdfwei</code> gives the distribution function;
<code>quawei</code> gives the quantile function.</p>


<h3>Note</h3>

<p>The functions expect the distribution parameters in a vector,
rather than as separate arguments as in the standard <span class="rlang"><b>R</b></span>
distribution functions <code>pnorm</code>, <code>qnorm</code>, etc.</p>


<h3>See Also</h3>

<p><code><a href="#topic+cdfgev">cdfgev</a></code> for the generalized extreme-value distribution,
of which the Weibull (reflected through the origin) is a special case.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Random sample from a 2-parameter Weibull distribution
# with scale parameter 2 and shape parameter 1.5.
quawei(runif(100), c(0,2,1.5))

# Illustrate the relation between Weibull and GEV distributions.
# weifit() fits a Weibull distribution to data and returns
#   quantiles of the fitted distribution
# gevfit() fits a Weibull distribution as a "reverse GEV",
#   i.e. fits a GEV distribution to the negated data,
#   then computes negated quantiles
weifit &lt;- function(qval, x) quawei(qval, pelwei(samlmu(x)))
gevfit &lt;- function(qval, x) -quagev(1-qval, pelgev(samlmu(-x)))
# Compare on Ozone data
data(airquality)
weifit(c(0.2,0.5,0.8), airquality$Ozone)
gevfit(c(0.2,0.5,0.8), airquality$Ozone)
</code></pre>

<hr>
<h2 id='evplot'>Extreme-value plot</h2><span id='topic+evplot'></span><span id='topic+evplot.default'></span><span id='topic+evdistp'></span><span id='topic+evdistq'></span><span id='topic+evpoints'></span>

<h3>Description</h3>

<p><code>evplot</code> draws an &ldquo;extreme-value plot&rdquo;, i.e. a quantile-quantile plot
in which the horizontal axis is the quantile of an
extreme-value type I (Gumbel) distribution.
</p>
<p><code>evdistp</code> adds the cumulative distribution function of a distribution
to an extreme-value plot.
</p>
<p><code>evdistq</code> adds the quantile function of a distribution
to an extreme-value plot.
</p>
<p><code>evpoints</code> adds a set of data points to an extreme-value plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evplot(y, ...)

## Default S3 method:
evplot(y, qfunc, para, npoints = 101, plim, xlim = c(-2, 5),
       ylim, type,
       xlab = expression("Reduced variate,  " * -log(-log(italic(F)))),
       ylab = "Quantile", rp.axis = TRUE, ...)

evdistp(pfunc, para, npoints = 101, ...)
evdistq(qfunc, para, npoints = 101, ...)

evpoints(y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evplot_+3A_y">y</code></td>
<td>
<p>Numeric vector.  The data values in the vector are plotted
on the extreme-value plot.</p>
</td></tr>
<tr><td><code id="evplot_+3A_qfunc">qfunc</code></td>
<td>
<p>A quantile function.  The function is drawn as a curve
on the extreme-value plot.</p>
</td></tr>
<tr><td><code id="evplot_+3A_pfunc">pfunc</code></td>
<td>
<p>A cumulative distribution function.  The function is drawn as a curve
on the extreme-value plot.</p>
</td></tr>
<tr><td><code id="evplot_+3A_para">para</code></td>
<td>
<p>Distribution parameters for the quantile function <code>qfunc</code>
or cumulative distribution function <code>pfunc</code>.
</p>
<p>If <code>pfunc</code> or <code>qfunc</code> is the standard <span class="rlang"><b>R</b></span> form of quantile function,
<code>para</code> should be a list.
</p>
<p>If <code>pfunc</code> or <code>qfunc</code> is the <code>qua...</code> form
of quantile function used throughout the <span class="pkg">lmom</span> package,
<code>para</code> should be a numeric vector.
</p>
<p>In <code>evplot</code>, <code>para</code> is not used if <code>qfunc</code> is omitted.</p>
</td></tr>
<tr><td><code id="evplot_+3A_npoints">npoints</code></td>
<td>
<p>Number of points to use in drawing the quantile function.
The points are equally spaced along the x axis.
Not used if <code>qfunc</code> is omitted.</p>
</td></tr>
<tr><td><code id="evplot_+3A_plim">plim</code></td>
<td>
<p>X axis limits, specified as probabilities.</p>
</td></tr>
<tr><td><code id="evplot_+3A_xlim">xlim</code></td>
<td>
<p>X axis limits, specified as values of the Gumbel reduced variate
<code class="reqn">-\log(-\log F)</code>, where <code class="reqn">F</code> is the
nonexceedance probability.
Not used if <code>plim</code> is specified.</p>
</td></tr>
<tr><td><code id="evplot_+3A_ylim">ylim</code></td>
<td>
<p>Y axis limits.</p>
</td></tr>
<tr><td><code id="evplot_+3A_type">type</code></td>
<td>
<p>Plot type.  Determines how the data values in <code>y</code> are plotted.
Interpreted in the same way as argument <code>type</code> of function <code>plot</code>,
i.e. <code>"p"</code> for points, <code>"b"</code> for points connected by lines, etc.</p>
</td></tr>
<tr><td><code id="evplot_+3A_xlab">xlab</code></td>
<td>
<p>X axis label.</p>
</td></tr>
<tr><td><code id="evplot_+3A_ylab">ylab</code></td>
<td>
<p>Y axis label.</p>
</td></tr>
<tr><td><code id="evplot_+3A_rp.axis">rp.axis</code></td>
<td>
<p>Logical. Whether to draw the &ldquo;Return period&rdquo; axis,
a secondary horizontal axis.</p>
</td></tr>
<tr><td><code id="evplot_+3A_...">...</code></td>
<td>
<p>Additional arguments are passed to the plotting routine.</p>
</td></tr>
</table>


<h3>Arguments of cumulative distribution functions and quantile functions</h3>

<p><code>pfunc</code> and <code>qfunc</code> can be either the standard <span class="rlang"><b>R</b></span> form of
cumulative distribution function or quantile function
(i.e. for a distribution with <code class="reqn">r</code> parameters, the first argument is the
variate <code class="reqn">x</code> or the probability <code class="reqn">p</code> and the next <code class="reqn">r</code> arguments
are the parameters of the distribution) or the <code>cdf...</code> or
<code>qua...</code> forms used throughout the <span class="pkg">lmom</span> package
(i.e. the first argument is the variate <code class="reqn">x</code> or probability <code class="reqn">p</code>
and the second argument is a vector containing the parameter values).
</p>


<h3>Note</h3>

<p>Data points are plotted at the Gringorten plotting position,
i.e. the <code class="reqn">i</code>th smallest of <code class="reqn">n</code> data points is plotted
at the horizontal position corresponding to nonexceedance probability
<code class="reqn">(i-0.44)/(n+0.12)</code>.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Extreme-value plot of Ozone from the airquality data
data(airquality)
evplot(airquality$Ozone)

# Fit a GEV distribution and add it to the plot
evdistq(quagev, pelgev(samlmu(airquality$Ozone)))

# Not too good -- try a kappa distribution instead
evdistq(quakap, pelkap(samlmu(airquality$Ozone)), col="red")
</code></pre>

<hr>
<h2 id='lmr-functions'>L-moments of specific probability distributions</h2><span id='topic+lmr...'></span><span id='topic+lmrexp'></span><span id='topic+lmrgam'></span><span id='topic+lmrgev'></span><span id='topic+lmrglo'></span><span id='topic+lmrgno'></span><span id='topic+lmrgpa'></span><span id='topic+lmrgum'></span><span id='topic+lmrkap'></span><span id='topic+lmrln3'></span><span id='topic+lmrnor'></span><span id='topic+lmrpe3'></span><span id='topic+lmrwak'></span><span id='topic+lmrwei'></span>

<h3>Description</h3>

<p>Computes the <code class="reqn">L</code>-moments of a probability distribution
given its parameters.
The following distributions are recognized:
</p>

<table>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrexp</code> </td><td style="text-align: left;"> exponential </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrgam</code> </td><td style="text-align: left;"> gamma </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrgev</code> </td><td style="text-align: left;"> generalized extreme-value </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrglo</code> </td><td style="text-align: left;"> generalized logistic </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrgpa</code> </td><td style="text-align: left;"> generalized Pareto </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrgno</code> </td><td style="text-align: left;"> generalized normal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrgum</code> </td><td style="text-align: left;"> Gumbel (extreme-value type I) </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrkap</code> </td><td style="text-align: left;"> kappa </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrln3</code> </td><td style="text-align: left;"> three-parameter lognormal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrnor</code> </td><td style="text-align: left;"> normal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrpe3</code> </td><td style="text-align: left;"> Pearson type III </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrwak</code> </td><td style="text-align: left;"> Wakeby </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>lmrwei</code> </td><td style="text-align: left;"> Weibull </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>lmrexp(para = c(0, 1), nmom = 2)
lmrgam(para = c(1, 1), nmom = 2)
lmrgev(para = c(0, 1, 0), nmom = 3)
lmrglo(para = c(0, 1, 0), nmom = 3)
lmrgno(para = c(0, 1, 0), nmom = 3)
lmrgpa(para = c(0, 1, 0), nmom = 3)
lmrgum(para = c(0, 1), nmom = 2)
lmrkap(para = c(0, 1, 0, 0), nmom = 4)
lmrln3(para = c(0, 0, 1), nmom = 3)
lmrnor(para = c(0, 1), nmom = 2)
lmrpe3(para = c(0, 1, 0), nmom = 3)
lmrwak(para = c(0, 1, 0, 0, 0), nmom = 5)
lmrwei(para = c(0, 1, 1), nmom = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmr-functions_+3A_para">para</code></td>
<td>
<p>Numeric vector containing the parameters of the distribution.</p>
</td></tr>
<tr><td><code id="lmr-functions_+3A_nmom">nmom</code></td>
<td>
<p>The number of <code class="reqn">L</code>-moments to be calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Numerical methods and accuracy are as described in
Hosking (1996, pp. 8&ndash;9).</p>


<h3>Value</h3>

<p>Numeric vector containing the <code class="reqn">L</code>-moments.</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M. (1996).
Fortran routines for use with the method of <code class="reqn">L</code>-moments, Version 3.
Research Report RC20525, IBM Research Division, Yorktown Heights, N.Y.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmrp">lmrp</a></code> to compute <code class="reqn">L</code>-moments of a general distribution
specified by its cumulative distribution function or quantile function.
</p>
<p><code><a href="#topic+samlmu">samlmu</a></code> to compute <code class="reqn">L</code>-moments of a data sample.
</p>
<p><code><a href="#topic+pelexp">pelexp</a></code>, etc., to compute the parameters
of a distribution given its <code class="reqn">L</code>-moments.
</p>
<p>For individual distributions, see their cumulative distribution functions:
</p>

<table>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfexp">cdfexp</a></code> </td><td style="text-align: left;"> exponential </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfgam">cdfgam</a></code> </td><td style="text-align: left;"> gamma </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfgev">cdfgev</a></code> </td><td style="text-align: left;"> generalized extreme-value </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfglo">cdfglo</a></code> </td><td style="text-align: left;"> generalized logistic </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfgpa">cdfgpa</a></code> </td><td style="text-align: left;"> generalized Pareto </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfgno">cdfgno</a></code> </td><td style="text-align: left;"> generalized normal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfgum">cdfgum</a></code> </td><td style="text-align: left;"> Gumbel (extreme-value type I) </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfkap">cdfkap</a></code> </td><td style="text-align: left;"> kappa </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfln3">cdfln3</a></code> </td><td style="text-align: left;"> three-parameter lognormal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfnor">cdfnor</a></code> </td><td style="text-align: left;"> normal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfpe3">cdfpe3</a></code> </td><td style="text-align: left;"> Pearson type III </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfwak">cdfwak</a></code> </td><td style="text-align: left;"> Wakeby </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfwei">cdfwei</a></code> </td><td style="text-align: left;"> Weibull </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># Compare sample L-moments of Ozone from the airquality data
# with the L-moments of a GEV distribution fitted to the data
data(airquality)
smom &lt;- samlmu(airquality$Ozone, nmom=6)
gevpar &lt;- pelgev(smom)
pmom &lt;- lmrgev(gevpar, nmom=6)
print(smom)
print(pmom)
</code></pre>

<hr>
<h2 id='lmrd'>L-moment ratio diagram</h2><span id='topic+lmrd'></span>

<h3>Description</h3>

<p>Draws an <code class="reqn">L</code>-moment ratio diagram.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmrd(x, y, distributions = "GLO GEV GPA GNO PE3", twopar,
     xlim, ylim, pch=3, cex, col, lty, lwd=1,
     legend.lmrd = TRUE, xlegend, ylegend,
     xlab = expression(italic(L) * "-skewness"),
     ylab = expression(italic(L) * "-kurtosis"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmrd_+3A_x">x</code></td>
<td>
<p>Numeric vector of <code class="reqn">L</code>-skewness values.
</p>
<p>Alternatively, if argument <code>y</code> is omitted, <code>x</code> can be an object
that contains both <code class="reqn">L</code>-skewness and <code class="reqn">L</code>-kurtosis values.
It can be a vector with elements named
<code>"t_3"</code> and <code>"t_4"</code> (or <code>"tau_3"</code> and <code>"tau_4"</code>),
a matrix or data frame with columns named
<code>"t_3"</code> and <code>"t_4"</code> (or <code>"tau_3"</code> and <code>"tau_4"</code>),
or an object of class <code>"regdata"</code> (as defined in package <span class="pkg">lmomRFA</span>).
</p>
</td></tr>
<tr><td><code id="lmrd_+3A_y">y</code></td>
<td>
<p>Numeric vector of <code class="reqn">L</code>-kurtosis values.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_distributions">distributions</code></td>
<td>
<p>Indicates the three-parameter distributions
whose <code class="reqn">L</code>-skewness&ndash;<code class="reqn">L</code>-kurtosis relations
are to be plotted as lines on the diagram.
The following distribution identifiers are recognized, in upper or lower case:
</p>

<table>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GLO</code>    </td><td style="text-align: left;"> generalized logistic </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GEV</code>    </td><td style="text-align: left;"> generalized extreme-value </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GPA</code>    </td><td style="text-align: left;"> generalized Pareto </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GNO</code>    </td><td style="text-align: left;"> generalized normal </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>PE3</code>    </td><td style="text-align: left;"> Pearson type III </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>WAK.LB</code> </td><td style="text-align: left;"> lower bound of <code class="reqn">L</code>-kurtosis for given <code class="reqn">L</code>-skewness, </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;">               </td><td style="text-align: left;"> for the Wakeby distribution. </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>ALL.LB</code> </td><td style="text-align: left;"> lower bound of <code class="reqn">L</code>-kurtosis for given <code class="reqn">L</code>-skewness, </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;">               </td><td style="text-align: left;"> for all distributions.
      </td>
</tr>

</table>











<p>The argument should be either a character vector each of whose elements
is one of the above abbreviations or a character string
containing one or more of the abbreviations separated by blanks.
The specified <code class="reqn">L</code>-skewness&ndash;<code class="reqn">L</code>-kurtosis curves will be plotted.
</p>
<p>If no three-parameter distributions are to be plotted,
specify <code>distributions</code> to be <code>FALSE</code> or
the empty string, <code>""</code>.
</p>
</td></tr>
<tr><td><code id="lmrd_+3A_twopar">twopar</code></td>
<td>

<p>Two-parameter distributions whose (<code class="reqn">L</code>-skewness, <code class="reqn">L</code>-kurtosis) values
are to be plotted as points on the diagram.
The following distribution identifiers are recognized, in upper or lower case:
</p>

<table>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>E</code> or <code>EXP</code> </td><td style="text-align: left;"> exponential </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>G</code> or <code>GUM</code> </td><td style="text-align: left;"> Gumbel </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>L</code> or <code>LOG</code> </td><td style="text-align: left;"> logistic </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>N</code> or <code>NOR</code> </td><td style="text-align: left;"> normal </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>U</code> or <code>UNI</code> </td><td style="text-align: left;"> uniform
      </td>
</tr>

</table>

<p>The argument should be either a character vector each of whose elements
is one of the above abbreviations or a character string
containing one or more of the abbreviations separated by blanks.
<code class="reqn">L</code>-skewness&ndash;<code class="reqn">L</code>-kurtosis points for the specified distributions will be plotted
and given one-character labels.
</p>
<p>The default is to plot the two-parameter distributions that are special
cases of the three-parameter distributions specified in
argument <code>distributions</code>.  Thus for example if
<code>distributions="GPA PE3"</code>, the default for <code>twopar</code>
is <code>"EXP NOR UNI"</code>: NOR is a special case of PE3, UNI of GPA,
EXP of both GPA and PE3.
</p>
<p>If no two-parameter distributions are to be plotted,
specify <code>twopar</code> to be <code>FALSE</code> or the empty string, <code>""</code>.
</p>
</td></tr>
<tr><td><code id="lmrd_+3A_xlim">xlim</code></td>
<td>
<p>x axis limits.
Default: <code>c(0, 0.6)</code>, expanded if necessary to cover the range of the data.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_ylim">ylim</code></td>
<td>
<p>y axis limits.
Default: <code>c(0, 0.4)</code>, expanded if necessary to cover the range of the data.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_pch">pch</code></td>
<td>
<p>Plotting character to be used for the plotted
(<code class="reqn">L</code>-skewness, <code class="reqn">L</code>-kurtosis) points.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_cex">cex</code></td>
<td>
<p>Symbol size for plotted points, like graphics parameter <code>cex</code>.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_col">col</code></td>
<td>
<p>Vector specifying the colors.  If it is of length 1
and <code>x</code> is present, it will be used for the plotted points.
Otherwise it will be used for the lines on the plot.
For the default colors for the lines, see the description
of argument <code>lty</code> below.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_lty">lty</code></td>
<td>
<p>Vector specifying the line types to be used for the lines on the plot.
</p>
<p>By default, colors and line types are matched to the distributions given
in argument <code>distributions</code>, as follows:
</p>

<table>
<tr>
 <td style="text-align: right;">
      
      
      
      
      
      
      
      
      
      </td><td style="text-align: left;"> <code>GLO</code>    </td><td style="text-align: left;"> blue,  solid line </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GEV</code>    </td><td style="text-align: left;"> green, solid line </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GPA</code>    </td><td style="text-align: left;"> red,   solid line </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>GNO</code>    </td><td style="text-align: left;"> black, solid line </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>PE3</code>    </td><td style="text-align: left;"> cyan,  solid line </td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>WAK.LB</code> </td><td style="text-align: left;"> red,   dashed line</td>
</tr>
<tr>
 <td style="text-align: right;">
      </td><td style="text-align: left;"> <code>ALL.LB</code> </td><td style="text-align: left;"> black, dashed line
      </td>
</tr>

</table>

<p>The green and cyan colors are less bright than the standard
<code>"green"</code> and <code>"cyan"</code>; they are defined to be
<code>"#00C000"</code> and <code>"#00E0E0"</code>, respectively.
</p>
</td></tr>
<tr><td><code id="lmrd_+3A_lwd">lwd</code></td>
<td>
<p>Vector specifying the line widths to be used for the lines on the plot.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_legend.lmrd">legend.lmrd</code></td>
<td>
<p>Controls whether a legend,
identifying the <code class="reqn">L</code>-skewness&ndash;<code class="reqn">L</code>-kurtosis
relations of the three-parameter distributions, is plotted.
Either logical, indicating whether a legend is to be drawn,
or a list specifying arguments to the <code>legend</code> function.
Default arguments include <code>bty="n"</code>, which must be overridden
if a legend box is to be drawn; other arguments set by default are
<code>x</code>, <code>y</code>, <code>legend</code>, <code>col</code>, <code>lty</code>, and <code>lwd</code>.
</p>
<p>Not used if <code>distributions=FALSE</code>.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_xlegend">xlegend</code></td>
<td>
<p>x coordinate of the upper left corner of the legend.
Default: the minimum x value.
Not used if <code>distributions=FALSE</code> or <code>legend.lmrd=FALSE</code>.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_ylegend">ylegend</code></td>
<td>
<p>y coordinate of the upper left corner of the legend.
Default: the maximum y value.
Not used if <code>distributions=FALSE</code> or <code>legend.lmrd=FALSE</code>.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_xlab">xlab</code></td>
<td>
<p>X axis label.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_ylab">ylab</code></td>
<td>
<p>Y axis label.</p>
</td></tr>
<tr><td><code id="lmrd_+3A_...">...</code></td>
<td>
<p>Additional arguments are passed to the function <code>matplot</code>,
which draws the axis box and the lines for three-parameter distributions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>lmrd</code> calls a sequence of graphics functions:
<code>matplot</code> for the axis box and the curves for three-parameter distributions;
<code>points</code> for the points for two-parameter distributions and
<code>text</code> for their labels; <code>legend</code> for the legend; and
<code>points</code> for the <code class="reqn">(x,y)</code> data points.
</p>
<p>Note that the only graphics parameters passed to <code>points</code>
are <code>col</code> (if of length 1), <code>cex</code>, and <code>pch</code>.
If more complex features are required, such as different colors for
different points, follow <code>lmrd</code> by an additional call to <code>points</code>,
e.g. follow <code>lmrd(t3, t4)</code> by <code>points(t3, t4, col=c("red", "green"))</code>.
</p>


<h3>Value</h3>

<p>A list, returned invisibly, describing what was plotted.
Useful for customization of the legend, as in one of the examples below.
List elements:
</p>
<table>
<tr><td><code>lines</code></td>
<td>
<p>List containing elements describing the plotted distribution curves (if any).
Each element is a vector with the same length as <code>distributions</code>.
List elements <code>distributions</code>, <code>col.lines</code>, <code>lty</code>, <code>lwd</code>.</p>
</td></tr>
<tr><td><code>twopar</code></td>
<td>
<p>Character vector containing the 1-character symbols for the
two-parameter distributions that were plotted.</p>
</td></tr>
<tr><td><code>points</code></td>
<td>
<p>List containing elements describing the plot (if any) of the data points.
List elements <code>col.pts</code>, <code>pch</code>, <code>cex</code>.</p>
</td></tr>
</table>
<p>If any of the above items was not plotted, the corresponding list element is <code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>See Also</h3>

<p>For adding to an <code class="reqn">L</code>-moment ratio diagram: <code><a href="#topic+lmrdpoints">lmrdpoints</a></code>, <code><a href="#topic+lmrdlines">lmrdlines</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(airquality)
lmrd(samlmu(airquality$Ozone))

# Tweaking a few graphics parameters makes the graph look better
# (in the author's opinion)
lmrd(samlmu(airquality$Ozone), xaxs="i", yaxs="i", las=1)

# An example that illustrates the sampling variability of L-moments
#
# Generate 50 random samples of size 30 from the Gumbel distribution
# - stored in the rows of matrix mm
mm &lt;- matrix(quagum(runif(1500)), nrow=50)
#
# Compute the first four sample L-moments of each sample
# - stored in the rows of matrix aa
aa &lt;- apply(mm, 1, samlmu)
#
# Plot the L-skewness and L-kurtosis values on an L-moment ratio
# diagram that also shows (only) the population L-moment ratios
# of the Gumbel distribution
lmrd(t(aa), dist="", twopar="G", col="red")

# L-moment ratio diagram with curves for GLO, GEV, GPA, and Weibull.
# The Weibull curve is added manually. A legend is added,
# using information returned from lmrd().
#
# - Draw the diagram, with the GLO, GEV, and GPA curves
info &lt;- lmrd(distributions="GLO GEV GPA", xaxs="i", yaxs="i", las=1, legend=FALSE)
#
# - Compute L-skewness and L-kurtosis values for Weibull
sa &lt;- sapply(seq(0, 0.6, by=0.01),
    function(tau3) lmrwei(pelwei(c(0,1,tau3)), nmom=4)[3:4])
#
# - Plot the Weibull curve
lmrdlines(sa["tau_3",], sa["tau_4",], col="magenta", lwd=2)
#
# - Add a legend
legend("topleft", bty="n",
  legend = c(info$lines$distributions, "WEI"),
  col = c(info$lines$col.lines, "magenta"),
  lwd = c(info$lines$lwd, 3))
</code></pre>

<hr>
<h2 id='lmrdpoints'>Add points or lines to an L-moment ratio diagram</h2><span id='topic+lmrdpoints'></span><span id='topic+lmrdlines'></span>

<h3>Description</h3>

<p><code>lmrdpoints</code> adds points,
and <code>lmrdlines</code> adds connected line segments,
to an <code class="reqn">L</code>-moment ratio diagram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmrdpoints(x, y=NULL, type="p", ...)
lmrdlines(x, y=NULL, type="l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmrdpoints_+3A_x">x</code></td>
<td>
<p>Numeric vector of <code class="reqn">L</code>-skewness values.</p>
</td></tr>
<tr><td><code id="lmrdpoints_+3A_y">y</code></td>
<td>
<p>Numeric vector of <code class="reqn">L</code>-kurtosis values.
May be omitted: see &ldquo;Details&rdquo; below.</p>
</td></tr>
<tr><td><code id="lmrdpoints_+3A_type">type</code></td>
<td>
<p>Character indicating the type of plotting.
Can be any valid value for the <code>type</code> argument
of <code>plot.default</code>.</p>
</td></tr>
<tr><td><code id="lmrdpoints_+3A_...">...</code></td>
<td>
<p>Further arguments (graphics parameters),
passed to <code>points</code> or <code>lines</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>lmrdpoints</code> and <code>lmrdlines</code> are equivalent to
<code>points</code> and <code>lines</code> respectively,
except that if argument <code>y</code> is omitted, <code>x</code> is assumed to be
an object that contains both <code class="reqn">L</code>-skewness and <code class="reqn">L</code>-kurtosis values.
As in <code>lmrd</code>, it can be a vector with elements named
<code>"t_3"</code> and <code>"t_4"</code> (or <code>"tau_3"</code> and <code>"tau_4"</code>),
a matrix or data frame with columns named
<code>"t_3"</code> and <code>"t_4"</code> (or <code>"tau_3"</code> and <code>"tau_4"</code>),
or an object of class <code>"regdata"</code> (as defined in package <span class="pkg">lmomRFA</span>).
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+lmrd">lmrd</a></code>, <code><a href="graphics.html#topic+points">points</a></code>, <code><a href="graphics.html#topic+lines">lines</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot L-moment ratio diagram of Wind from the airquality data set
data(airquality)
lmrd(samlmu(airquality$Wind), xlim=c(-0.2, 0.2))
# Sample L-moments of each month's data
( lmom.monthly &lt;- with(airquality,
  t(sapply(5:9, function(mo) samlmu(Wind[Month==mo])))) )
# Add the monthly values to the plot
lmrdpoints(lmom.monthly, pch=19, col="blue")


# Draw an L-moment ratio diagram and add a line for the
# Weibull distribution
lmrd(xaxs="i", yaxs="i", las=1)
weimom &lt;- sapply( seq(0, 0.9, by=0.01),
  function(tau3) lmrwei(pelwei(c(0,1,tau3)), nmom=4) )
lmrdlines(t(weimom), col='darkgreen', lwd=2)

</code></pre>

<hr>
<h2 id='lmrp'>L-moments of a general probability distribution</h2><span id='topic+lmrp'></span><span id='topic+lmrq'></span>

<h3>Description</h3>

<p>Computes the <code class="reqn">L</code>-moments or trimmed <code class="reqn">L</code>-moments
of a probability distribution
given its cumulative distribution function (for function <code>lmrp</code>)
or quantile function (for function <code>lmrq</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmrp(pfunc, ..., bounds=c(-Inf,Inf), symm=FALSE, order=1:4,
     ratios=TRUE, trim=0, acc=1e-6, subdiv=100, verbose=FALSE)

lmrq(qfunc, ..., symm=FALSE, order=1:4, ratios=TRUE, trim=0,
     acc=1e-6, subdiv=100, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmrp_+3A_pfunc">pfunc</code></td>
<td>
<p>Cumulative distribution function.</p>
</td></tr>
<tr><td><code id="lmrp_+3A_qfunc">qfunc</code></td>
<td>
<p>Quantile function.</p>
</td></tr>
<tr><td><code id="lmrp_+3A_...">...</code></td>
<td>
<p>Arguments to <code>pfunc</code> or <code>qfunc</code>.</p>
</td></tr>
<tr><td><code id="lmrp_+3A_bounds">bounds</code></td>
<td>
<p>Either a vector of length 2, containing the lower
and upper bounds of the distribution, or a function that calculates
these bounds given the distribution parameters as inputs.</p>
</td></tr>
<tr><td><code id="lmrp_+3A_symm">symm</code></td>
<td>

<p>For <code>lmrq</code>, a logical value indicating whether
the distribution is symmetric about its median.
</p>
<p>For <code>lmrp</code>, either the logical value <code>FALSE</code> or <code>NA</code>
to indicate that the distribution is not symmetric,
or a numeric value to indicate that the distribution is symmetric
and that the specified value is the center of symmetry.
</p>
<p>If the distribution is symmetric, odd-order <code class="reqn">L</code>-moments
are exactly zero and the symmetry is used to slightly speed up
the computation of even-order <code class="reqn">L</code>-moments.</p>
</td></tr>
<tr><td><code id="lmrp_+3A_order">order</code></td>
<td>
<p>Orders of the <code class="reqn">L</code>-moments and <code class="reqn">L</code>-moment ratios to be computed.</p>
</td></tr>
<tr><td><code id="lmrp_+3A_ratios">ratios</code></td>
<td>
<p>Logical. If <code>FALSE</code>, <code class="reqn">L</code>-moments are computed;
if <code>TRUE</code> (the default), <code class="reqn">L</code>-moment ratios are computed.</p>
</td></tr>
<tr><td><code id="lmrp_+3A_trim">trim</code></td>
<td>
<p>Degree of trimming.
If a single value, symmetric trimming of the specified degree will be used.
If a vector of length 2, the two values
indicate the degrees of trimming at the lower and upper ends of the
&ldquo;conceptual sample&rdquo; (Elamir and Seheult, 2003) of order statistics
that is used to define the trimmed <code class="reqn">L</code>-moments.</p>
</td></tr>
<tr><td><code id="lmrp_+3A_acc">acc</code></td>
<td>
<p>Requested accuracy.  The function will try to achieve
this level of accuracy, as relative error for <code class="reqn">L</code>-moments and absolute
error for <code class="reqn">L</code>-moment ratios.</p>
</td></tr>
<tr><td><code id="lmrp_+3A_subdiv">subdiv</code></td>
<td>
<p>Maximum number of subintervals used in numerical integration.</p>
</td></tr>
<tr><td><code id="lmrp_+3A_verbose">verbose</code></td>
<td>
<p>Logical.  If <code>FALSE</code>, only the values of the <code class="reqn">L</code>-moments
and <code class="reqn">L</code>-moment ratios are returned.  If <code>TRUE</code>, more details of the
numerical integration are returned: see &ldquo;Value&rdquo; section below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computations use expressions in Hosking (2007):
eq. (7) for <code>lmrp</code>, eq. (5) for <code>lmrq</code>.
Integrals in those expressions are computed by numerical integration.
</p>


<h3>Value</h3>

<p>If <code>verbose=FALSE</code> and <code>ratios=FALSE</code>,
a numeric vector containing the <code class="reqn">L</code>-moments.
</p>
<p>If <code>verbose=FALSE</code> and <code>ratios=TRUE</code>,
a numeric vector containing the <code class="reqn">L</code>-moments (of orders 1 and 2)
and <code class="reqn">L</code>-moment ratios (of orders 3 and higher).
</p>
<p>If <code>verbose=TRUE</code>, a data frame with columns as follows:
</p>
<table>
<tr><td><code>value</code></td>
<td>
<p><code class="reqn">L</code>-moments (if <code>ratios=FALSE</code>),
or <code class="reqn">L</code>-moments and <code class="reqn">L</code>-moment ratios (if <code>ratios=TRUE</code>).</p>
</td></tr>
<tr><td><code>abs.error</code></td>
<td>
<p>Estimate of the absolute error in the computed value.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p><code>"OK"</code> or a character string giving the error message
resulting from the numerical integration.</p>
</td></tr>
</table>


<h3>Arguments of cumulative distribution functions and quantile functions</h3>

<p><code>pfunc</code> and <code>qfunc</code> can be either the standard <span class="rlang"><b>R</b></span> form of
cumulative distribution function or quantile function
(i.e. for a distribution with <code class="reqn">r</code> parameters, the first argument is the
variate <code class="reqn">x</code> or the probability <code class="reqn">p</code> and the next <code class="reqn">r</code> arguments
are the parameters of the distribution) or the <code>cdf...</code> or
<code>qua...</code> forms used throughout the <span class="pkg">lmom</span> package
(i.e. the first argument is the variate <code class="reqn">x</code> or probability <code class="reqn">p</code>
and the second argument is a vector containing the parameter values).
Even for the <span class="rlang"><b>R</b></span> form, however, starting values for the parameters
are supplied as a vector <code>start</code>.
</p>
<p>If <code>bounds</code> is a function, its arguments must match
the distribution parameter arguments of <code>pfunc</code>:
either a single vector, or a separate argument for each parameter.
</p>


<h3>Warning</h3>

<p>Arguments <code>bounds</code>, <code>symm</code>, <code>order</code>,
<code>ratios</code>, <code>trim</code>, <code>acc</code>, <code>subdiv</code>, and <code>verbose</code>
cannot be abbreviated and must be specified by their full names
(if abbreviated, the names would be matched to the arguments of
<code>pfunc</code> or <code>qfunc</code>).</p>


<h3>Note</h3>

<p>In package <span class="pkg">lmom</span> versions 1.6 and earlier, the &ldquo;Details&rdquo; section stated that
&ldquo;Integrals in those expressions are computed by numerical integration,
using the <span class="rlang"><b>R</b></span> function <code>integrate</code>&rdquo;.
As of version 2.0, numerical integration uses an internal function that directly calls
(slightly modified versions of) Fortran routines in QUADPACK (Piessens et al. 1983).
<span class="rlang"><b>R</b></span>'s own <code>integrate</code> function uses C code &ldquo;based on&rdquo; the QUADPACK routines,
but in <span class="rlang"><b>R</b></span> versions 2.12.0 through 3.0.1 did not in every case reproduce the results
that would have been obtained with the Fortran code (this is <span class="rlang"><b>R</b></span> bug PR#15219).
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Elamir, E. A. H., and Seheult, A. H. (2003).  Trimmed L-moments.
<em>Computational Statistics and Data Analysis</em>, <b>43</b>, 299-314.
</p>
<p>Hosking, J. R. M. (2007).  Some theory and practical uses of trimmed L-moments.
<em>Journal of Statistical Planning and Inference</em>, <b>137</b>, 3024-3039.
</p>
<p>Piessens, R., deDoncker-Kapenga, E., Uberhuber, C., and Kahaner, D. (1983).
<em>Quadpack: a Subroutine Package for Automatic Integration</em>.
Springer Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmrexp">lmrexp</a></code> to compute (untrimmed) <code class="reqn">L</code>-moments of specific distributions.
</p>
<p><code><a href="#topic+samlmu">samlmu</a></code> to compute (trimmed or untrimmed) <code class="reqn">L</code>-moments of a data sample.
</p>
<p><code><a href="#topic+pelp">pelp</a></code> and <code><a href="#topic+pelexp">pelexp</a></code>,
to compute the parameters of a distribution given its (trimmed or untrimmed) <code class="reqn">L</code>-moments.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generalized extreme-value (GEV) distribution
## - three ways to get its L-moments
lmrp(cdfgev, c(2,3,-0.2))
lmrq(quagev, c(2,3,-0.2))
lmrgev(c(2,3,-0.2), nmom=4)

## GEV bounds specified as a vector
lmrp(cdfgev, c(2,3,-0.2), bounds=c(-13,Inf))

## GEV bounds specified as a function -- single vector of parameters
gevbounds &lt;- function(para) {
  k &lt;- para[3]
  b &lt;- para[1]+para[2]/k
  c(ifelse(k&lt;0, b, -Inf), ifelse(k&gt;0, b, Inf))
}
lmrp(cdfgev, c(2,3,-0.2), bounds=gevbounds)

## GEV bounds specified as a function -- separate parameters
pgev &lt;- function(x, xi, alpha, k)
  pmin(1, pmax(0, exp(-((1-k*(x-xi)/alpha)^(1/k)))))
pgevbounds &lt;- function(xi,alpha,k) {
  b &lt;- xi+alpha/k
  c(ifelse(k&lt;0, b, -Inf), ifelse(k&gt;0, b, Inf))
}
lmrp(pgev, xi=2, alpha=3, k=-0.2, bounds=pgevbounds)

## Normal distribution
lmrp(pnorm)
lmrp(pnorm, symm=0)
lmrp(pnorm, mean=2, sd=3, symm=2)
# For comparison, the exact values
lmrnor(c(2,3), nmom=4)

# Many L-moment ratios of the exponential distribution
# This may warn that "the integral is probably divergent"
lmrq(qexp, order=3:20)

# ... nonetheless the computed values seem accurate:
# compare with the exact values, tau_r = 2/(r*(r-1)):
cbind(exact=2/(3:20)/(2:19), lmrq(qexp, order=3:20, verbose=TRUE))

# Of course, sometimes the integral really is divergent
## Not run: 
lmrq(function(p) (1-p)^(-1.5))

## End(Not run)

# And sometimes the integral is divergent but that's not what
# the warning says (at least on the author's system)
lmrp(pcauchy)

# Trimmed L-moments for Cauchy distribution are finite
lmrp(pcauchy, symm=0, trim=1)

# Works for discrete distributions too, but often requires
# a larger-than-default value of 'subdiv'
lmrp(ppois, lambda=5, subdiv=1000)
</code></pre>

<hr>
<h2 id='pel-functions'>Parameter estimation for specific distributions by the method of L-moments</h2><span id='topic+pel...'></span><span id='topic+pelexp'></span><span id='topic+pelgam'></span><span id='topic+pelgev'></span><span id='topic+pelglo'></span><span id='topic+pelgno'></span><span id='topic+pelgpa'></span><span id='topic+pelgum'></span><span id='topic+pelkap'></span><span id='topic+pelln3'></span><span id='topic+pelnor'></span><span id='topic+pelpe3'></span><span id='topic+pelwak'></span><span id='topic+pelwei'></span>

<h3>Description</h3>

<p>Computes the parameters of a probability distribution
as a function of the <code class="reqn">L</code>-moments.
The following distributions are recognized:
</p>

<table>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelexp</code> </td><td style="text-align: left;"> exponential </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelgam</code> </td><td style="text-align: left;"> gamma </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelgev</code> </td><td style="text-align: left;"> generalized extreme-value </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelglo</code> </td><td style="text-align: left;"> generalized logistic </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelgpa</code> </td><td style="text-align: left;"> generalized Pareto </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelgno</code> </td><td style="text-align: left;"> generalized normal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelgum</code> </td><td style="text-align: left;"> Gumbel (extreme-value type I) </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelkap</code> </td><td style="text-align: left;"> kappa </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelln3</code> </td><td style="text-align: left;"> three-parameter lognormal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelnor</code> </td><td style="text-align: left;"> normal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelpe3</code> </td><td style="text-align: left;"> Pearson type III </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelwak</code> </td><td style="text-align: left;"> Wakeby </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>pelwei</code> </td><td style="text-align: left;"> Weibull </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>pelexp(lmom)
pelgam(lmom)
pelgev(lmom)
pelglo(lmom)
pelgno(lmom)
pelgpa(lmom, bound = NULL)
pelgum(lmom)
pelkap(lmom)
pelln3(lmom, bound = NULL)
pelnor(lmom)
pelpe3(lmom)
pelwak(lmom, bound = NULL, verbose = FALSE)
pelwei(lmom, bound = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pel-functions_+3A_lmom">lmom</code></td>
<td>
<p>Numeric vector containing the <code class="reqn">L</code>-moments of the distribution
or of a data sample.</p>
</td></tr>
<tr><td><code id="pel-functions_+3A_bound">bound</code></td>
<td>
<p>Lower bound of the distribution.  If <code>NULL</code> (the default),
the lower bound will be estimated along with the other parameters.</p>
</td></tr>
<tr><td><code id="pel-functions_+3A_verbose">verbose</code></td>
<td>
<p>Logical: whether to print a message when not all
parameters of the distribution can be computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Numerical methods and accuracy are as described in
Hosking (1996, pp. 10&ndash;11).
Exception:
if <code>pelwak</code> is unable to fit a Wakeby distribution using all 5 <code class="reqn">L</code>-moments,
it instead fits a generalized Pareto distribution to the first 3 <code class="reqn">L</code>-moments.
(The corresponding routine in the LMOMENTS Fortran package
would attempt to fit a Wakeby distribution with lower bound zero.)
</p>
<p>The kappa and Wakeby distributions have 4 and 5 parameters respectively
but cannot attain all possible values of the first 4 or 5 <code class="reqn">L</code>-moments.
Function <code>pelkap</code> can fit only kappa distributions with
<code class="reqn">\tau_4 &lt;= (1 + 5 \tau_3^2) / 6</code>
(the limit is the <code class="reqn">(\tau_3, \tau_4)</code> relation satisfied by the generalized logistic distribution),
and will give an error if <code>lmom</code> does not satisfy this constraint.
Function <code>pelwak</code> can fit a Wakeby distribution only if
the <code class="reqn">(\tau_3,\tau_4)</code> values lie above a line plotted by <code>lmrd(distributions="WAK.LB")</code>,
and if <code class="reqn">\tau_5</code> satisfies additional constraints;
in other cases <code>pelwak</code> will fit a generalized Pareto distribution
(a special case of the Wakeby distribution) to the first three <code class="reqn">L</code>-moments.
</p>


<h3>Value</h3>

<p>A numeric vector containing the parameters of the distribution.</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Hosking, J. R. M. (1996).
Fortran routines for use with the method of <code class="reqn">L</code>-moments, Version 3.
Research Report RC20525, IBM Research Division, Yorktown Heights, N.Y.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pelp">pelp</a></code> for parameter estimation of a general distribution
specified by its cumulative distribution function or quantile function.
</p>
<p><code><a href="#topic+lmrexp">lmrexp</a></code>, etc., to compute the <code class="reqn">L</code>-moments
of a distribution given its parameters.
</p>
<p>For individual distributions, see their cumulative distribution functions:
</p>

<table>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfexp">cdfexp</a></code> </td><td style="text-align: left;"> exponential </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfgam">cdfgam</a></code> </td><td style="text-align: left;"> gamma </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfgev">cdfgev</a></code> </td><td style="text-align: left;"> generalized extreme-value </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfglo">cdfglo</a></code> </td><td style="text-align: left;"> generalized logistic </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfgpa">cdfgpa</a></code> </td><td style="text-align: left;"> generalized Pareto </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfgno">cdfgno</a></code> </td><td style="text-align: left;"> generalized normal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfgum">cdfgum</a></code> </td><td style="text-align: left;"> Gumbel (extreme-value type I) </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfkap">cdfkap</a></code> </td><td style="text-align: left;"> kappa </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfln3">cdfln3</a></code> </td><td style="text-align: left;"> three-parameter lognormal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfnor">cdfnor</a></code> </td><td style="text-align: left;"> normal </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfpe3">cdfpe3</a></code> </td><td style="text-align: left;"> Pearson type III </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfwak">cdfwak</a></code> </td><td style="text-align: left;"> Wakeby </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code><a href="#topic+cdfwei">cdfwei</a></code> </td><td style="text-align: left;"> Weibull </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># Sample L-moments of Ozone from the airquality data
data(airquality)
lmom &lt;- samlmu(airquality$Ozone)

# Fit a GEV distribution
pelgev(lmom)
</code></pre>

<hr>
<h2 id='pelp'>Parameter estimation for a general distribution by the method of L-moments</h2><span id='topic+pelp'></span><span id='topic+pelq'></span>

<h3>Description</h3>

<p>Computes the parameters of a probability distribution
as a function of the <code class="reqn">L</code>-moments or trimmed <code class="reqn">L</code>-moments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pelp(lmom, pfunc, start, bounds = c(-Inf, Inf),
     type = c("n", "s", "ls", "lss"),
     ratios = NULL, trim = NULL, method = "nlm", acc = 1e-5,
     subdiv = 100, ...)

pelq(lmom, qfunc, start, type = c("n", "s", "ls", "lss"),
     ratios = NULL, trim = NULL, method = "nlm", acc = 1e-5,
     subdiv = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pelp_+3A_lmom">lmom</code></td>
<td>
<p>Numeric vector containing the <code class="reqn">L</code>-moments of the distribution
or of a data sample.</p>
</td></tr>
<tr><td><code id="pelp_+3A_pfunc">pfunc</code></td>
<td>
<p>Cumulative distribution function of the distribution.</p>
</td></tr>
<tr><td><code id="pelp_+3A_qfunc">qfunc</code></td>
<td>
<p>Quantile function of the distribution.</p>
</td></tr>
<tr><td><code id="pelp_+3A_start">start</code></td>
<td>
<p>Vector of starting values for the parameters.</p>
</td></tr>
<tr><td><code id="pelp_+3A_bounds">bounds</code></td>
<td>
<p>Either a vector of length 2, containing the lower
and upper bounds of the distribution, or a function that calculates
these bounds given the distribution parameters as inputs.</p>
</td></tr>
<tr><td><code id="pelp_+3A_type">type</code></td>
<td>
<p>Type of distribution, i.e. how it is parametrized.
Must be one of the following:
</p>

<dl>
<dt><code>"ls"</code></dt><dd><p>The distribution has a location parameter and a scale parameter.</p>
</dd>
<dt><code>"lss"</code></dt><dd><p>The distribution has a location parameter and a scale parameter,
and is symmetric about its median.</p>
</dd>
<dt><code>"s"</code></dt><dd><p>The distribution has a scale parameter but not a location parameter.</p>
</dd>
<dt><code>"n"</code></dt><dd><p>The distribution has neither a location parameter
nor a scale parameter.</p>
</dd></dl>

<p>For more details, see the &ldquo;Distribution type&rdquo; section below.
</p>
</td></tr>
<tr><td><code id="pelp_+3A_ratios">ratios</code></td>
<td>
<p>Logical or <code>NULL</code>.
If <code>FALSE</code>, <code>lmom</code> should contain <code class="reqn">L</code>-moments;
if <code>TRUE</code>, <code>lmom</code> should contain <code class="reqn">L</code>-moment ratios.
If <code>NULL</code> and <code>lmom</code> has names, the contents of <code>lmom</code>
will be inferred from these names - see section
&ldquo;Inferring &lsquo;ratios&rsquo; and &lsquo;trim&rsquo;&rdquo; below.
The default value (if <code>ratios</code> is <code>NULL</code> and <code>lmom</code> has no names)
is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="pelp_+3A_trim">trim</code></td>
<td>
<p>The degree of trimming corresponding to the <code class="reqn">L</code>-moments in <code>lmom</code>.
Can be a single value or a vector length 2, as for <code>samlmu</code>.
Can also be <code>NULL</code>: in this case if <code>lmom</code> has names,
the degree of trimming will be inferred from these names - see section
&ldquo;Inferring &lsquo;ratios&rsquo; and &lsquo;trim&rsquo;&rdquo; below.
The default value (if <code>trim</code> is <code>NULL</code> and <code>lmom</code> has no names)
is <code>0</code>.</p>
</td></tr>
<tr><td><code id="pelp_+3A_method">method</code></td>
<td>
<p>Method used to estimate the shape parameters
(i.e. all parameters other than the location and scale parameters, if any).
Valid values are <code>"nlm"</code> (the default), <code>"uniroot"</code>
(which is valid only if the distribution has at most one shape parameter),
and any of the values of the <code>method</code> argument of function <code>optim</code>.
See the &ldquo;Details&rdquo; section below.
</p>
</td></tr>
<tr><td><code id="pelp_+3A_acc">acc</code></td>
<td>
<p>Requested accuracy for the estimated parameters.
This will be absolute accuracy for shape parameters,
relative accuracy for a scale parameter, and
absolute accuracy of the location parameter divided by the scale parameter
for a location parameter.</p>
</td></tr>
<tr><td><code id="pelp_+3A_subdiv">subdiv</code></td>
<td>
<p>Maximum number of subintervals used in the numerical integration
that computes <code class="reqn">L</code>-moments of the distribution.  Passed to functions
<code>lmrp</code> or <code>lmrq</code>, which perform this integration.</p>
</td></tr>
<tr><td><code id="pelp_+3A_...">...</code></td>
<td>
<p>Further arguments will be passed to the optimization function
(<code>nlm</code>, <code>uniroot</code>, or <code>optim</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For shape parameters, numerical optimization is used to
find parameter values for which the population <code class="reqn">L</code>-moments or <code class="reqn">L</code>-moment ratios
are equal to the values supplied in <code>lmom</code>.
Computation of <code class="reqn">L</code>-moments or <code class="reqn">L</code>-moment ratios
uses functions <code>lmrp</code> (for <code>pelp</code>) or <code>lmrq</code> (for <code>pelq</code>).
Numerical optimization uses <span class="rlang"><b>R</b></span> functions <code>nlm</code> (if <code>method="nlm"</code>),
<code>uniroot</code> (if <code>method="uniroot"</code>), or
<code>optim</code> with the specified method (for the other values of <code>method</code>).
Function <code>uniroot</code> uses one-dimensional root-finding,
while functions <code>nlm</code> and <code>optim</code> try to minimize
a criterion function that is the sum of squared differences between the
population <code class="reqn">L</code>-moments or <code class="reqn">L</code>-moment ratios and the values supplied in <code>lmom</code>.
Location and scale parameters are then estimated noniteratively.
In all cases, the calculation of population <code class="reqn">L</code>-moments and
<code class="reqn">L</code>-moment ratios is performed by function <code>lmrp</code> or <code>lmrq</code>
(when using <code>pelp</code> or <code>pelq</code> respectively).
</p>
<p>This approach is very crude.  Nonetheless, it is often effective in practice.
As in all numerical optimizations, success may depend on the way that
the distribution is parametrized and on the particular choice of
starting values for the parameters.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>para</code></td>
<td>
<p>Numeric vector containing the estimated parameters
of the distribution.</p>
</td></tr>
<tr><td><code>code</code></td>
<td>
<p>An integer indicating the result of the numerical optimization
used to estimate the shape parameters.  It is <code>0</code> if there
are no shape parameters.  In general, values <code>1</code> and <code>2</code>
indicate successful convergence of the iterative procedure,
a value of <code>3</code> indicates that the iteration may not have converged,
and values of <code>4</code> or more indicate that the iteration did not converge.
Specifically, <code>code</code> is:
</p>
<p>For method <code>"nlm"</code>, the <code>code</code> component
of the return value from <code>nlm</code>.
</p>
<p>For method <code>"uniroot"</code>, <code>1</code> if the estimated
precision of the shape parameter is less than or equal to <code>acc</code>,
and <code>4</code> otherwise.
</p>
<p>For the other methods, the <code>convergence</code> component
of the return value from <code>optim</code>.
</p>
</td></tr>
</table>


<h3>Further details of arguments</h3>

<p>The length of <code>lmom</code> should be (at least) the highest
order of <code class="reqn">L</code>-moment used in the estimation procedure.  For a distribution
with <code class="reqn">r</code> parameters this is
<code class="reqn">2r-2</code> if <code>type="lss"</code> and <code class="reqn">r</code> otherwise.
</p>
<p><code>pfunc</code> and <code>qfunc</code> can be either the standard <span class="rlang"><b>R</b></span> form of
cumulative distribution function or quantile function
(i.e. for a distribution with <code class="reqn">r</code> parameters, the first argument is the
variate <code class="reqn">x</code> or the probability <code class="reqn">p</code> and the next <code class="reqn">r</code> arguments
are the parameters of the distribution) or the <code>cdf...</code> or
<code>qua...</code> forms used throughout the <span class="pkg">lmom</span> package
(i.e. the first argument is the variate <code class="reqn">x</code> or probability <code class="reqn">p</code>
and the second argument is a vector containing the parameter values).
Even for the <span class="rlang"><b>R</b></span> form, however, starting values for the parameters
are supplied as a vector <code>start</code>.
</p>
<p>If <code>bounds</code> is a function, its arguments must match
the distribution parameter arguments of <code>pfunc</code>:
either a single vector, or a separate argument for each parameter.
</p>
<p>It is assumed that location and scale parameters come first in
the set of parameters of the distribution. Specifically:
if <code>type="ls"</code> or <code>type="lss"</code>, it is assumed
that the first parameter is the location parameter and
that the second parameter is the scale parameter;
if <code>type="s"</code> it is assumed
that the first parameter is the scale parameter.
</p>
<p>It is important that the length of <code>start</code> be equal to the number
of parameters of the distribution.  Starting values for
location and scale parameters should be included in <code>start</code>,
even though they are not used.
If <code>start</code> has the wrong length, it is possible that
meaningless results will be returned without any warning being issued.
</p>


<h3>Distribution type </h3>

<p>The <code>type</code> argument affects estimation as follows.
We assume that location and scale parameters are <code class="reqn">\xi</code> and <code class="reqn">\alpha</code>
respectively, and that the shape parameters (if there are any)
are collectively designated by <code class="reqn">\theta</code>.
</p>
<p>If <code>type="ls"</code>, then the <code class="reqn">L</code>-moment ratios <code class="reqn">\tau_3, \tau_4, \ldots</code>
depend only on the shape parameters. If there are any shape parameters,
they are estimated by equating the sample <code class="reqn">L</code>-moment ratios of orders
3, 4, etc., to the population <code class="reqn">L</code>-moment ratios
and solving the resulting equations for the shape parameters
(using as many equations as there are shape parameters).
The <code class="reqn">L</code>-moment <code class="reqn">\lambda_2</code> is a multiple of <code class="reqn">\alpha</code>, the multiplier
being a function only of <code class="reqn">\theta</code>.
<code class="reqn">\alpha</code> is estimated by dividing the second sample <code class="reqn">L</code>-moment
by the multiplier function evaluated at the estimated value of <code class="reqn">\theta</code>.
The <code class="reqn">L</code>-moment <code class="reqn">\lambda_1</code> is <code class="reqn">\xi</code> plus
a function of <code class="reqn">\alpha</code> and <code class="reqn">\theta</code>.
<code class="reqn">\xi</code> is estimated by subtracting from the first sample <code class="reqn">L</code>-moment
the function evaluated at the estimated values of
<code class="reqn">\alpha</code> and <code class="reqn">\theta</code>.
</p>
<p>If <code>type="lss"</code>, then
the <code class="reqn">L</code>-moment ratios of odd order, <code class="reqn">\tau_3, \tau_5, \ldots</code>, are zero and
the <code class="reqn">L</code>-moment ratios of even order, <code class="reqn">\tau_4, \tau_6, \ldots</code>,
depend only on the shape parameters. If there are any shape parameters,
they are estimated by equating the sample <code class="reqn">L</code>-moment ratios of orders
4, 6, etc., to the population <code class="reqn">L</code>-moment ratios
and solving the resulting equations for the shape parameters
(using as many equations as there are shape parameters).
Parameters <code class="reqn">\alpha</code> and <code class="reqn">\xi</code> are estimated as in case when <code>type="ls"</code>.
</p>
<p>If <code>type="s"</code>, then the <code class="reqn">L</code>-moments divided by <code class="reqn">\lambda_1</code>,
i.e. <code class="reqn">\lambda_2/\lambda_1, \lambda_3/\lambda_1, \ldots</code>,
depend only on the shape parameters. If there are any shape parameters,
they are estimated by equating the sample <code class="reqn">L</code>-moments
(divided by the first sample <code class="reqn">L</code>-moment) of orders 2, 3, etc.,
to the corresponding population <code class="reqn">L</code>-moments
(divided by the first population <code class="reqn">L</code>-moment)
and solving the resulting equations
(as many equations as there are shape parameters).
The <code class="reqn">L</code>-moment <code class="reqn">\lambda_1</code> is a multiple of <code class="reqn">\alpha</code>, the multiplier
being a function only of <code class="reqn">\theta</code>.
<code class="reqn">\alpha</code> is estimated by dividing the first sample <code class="reqn">L</code>-moment
by the multiplier function evaluated at the estimated value of <code class="reqn">\theta</code>.
</p>
<p>If <code>type="n"</code>, then all parameters are shape parameters.
They are estimated by equating the sample <code class="reqn">L</code>-moments of orders
1, 2, etc., to the population <code class="reqn">L</code>-moments
and solving the resulting equations for the parameters
(using as many equations as there are parameters).
</p>


<h3>Inferring &lsquo;ratios&rsquo; and &lsquo;trim&rsquo;</h3>

<p>If <code>ratios</code> or <code>trim</code> is <code>NULL</code>, appropriate values will be inferred
by inspecting the names of <code>lmom</code>. It is assumed that <code>lmom</code>
was generated by a call to <code>samlmu</code>, <code>lmrp</code>, or <code>lmrq</code>;
in this case its names will reflect the values of <code>ratios</code> and <code>trim</code>
used in that  call.
If in this case <code>lmom</code> has no names, default values
<code>ratios=TRUE</code> and <code>trim=0</code> will be used.
</p>
<p>This inference is made in order to reduce the need to specify the
orders of trimming repetitively.
For example, a distribution with quantile function <code>qfunc</code> can be
fitted to (1,1)-trimmed <code class="reqn">L</code>-moments of data in <code>x</code> by
</p>
<pre>
  lmom &lt;- samlmu(x, trim=1)
  fit &lt;- pelq(lmom, qfunc, start=...)
</pre>
<p>There is no need to specify <code>trim</code> both in the call to <code>samlmu</code>
and the call to <code>pelq</code>.
</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+pelexp">pelexp</a></code> for parameter estimation of specific distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Gamma distribution -- rewritten so that its first parameter
## is a scale parameter
my.pgamma &lt;- function(x, scale, shape) pgamma(x, shape=shape, scale=scale)
pelp(c(5,2), my.pgamma, start=c(1,1), bounds=c(0,Inf), type="s")
# We can also do the estimation suppressing our knowledge
# that one parameter is a shape parameter.
pelp(c(5,2), my.pgamma, start=c(1,1), bounds=c(0,Inf), type="n")
rm(my.pgamma)

## Kappa distribution -- has location, scale and 2 shape parameters
# Estimate via pelq
pel.out &lt;- pelq(c(10,5,0.3,0.15), quakap, start=c(0,1,0,0), type="ls")
pel.out
# Check that L-moments of estimated distribution agree with the
# L-moments input to pelq()
lmrkap(pel.out$para)
# Compare with the distribution-specific routine pelkap
pelkap(c(10,5,0.3,0.15))
rm(pel.out)

# Similar results -- what's the advantage of the specific routine?
system.time(pelq(c(10,5,0.3,0.15), quakap, start=c(0,1,0,0), type="ls"))
system.time(pelkap(c(10,5,0.3,0.15)))

# Caution -- pelq() will not check that estimates are reasonable
lmom &lt;- c(10,5,0.2,0.25)
pel.out &lt;- pelq(lmom, quakap, start=c(0,1,0,0), type="ls")
pel.out
lmrkap(pel.out$para) # should be close to lmom, but tau_3 and tau_4 are not
# What happened? pelkap will tell us
try(pelkap(lmom))
rm(lmom, pel.out)

## Inverse Gaussian -- don't have explicit estimators for this
## distribution, but can use numerical methods
#
# CDF of inverse gaussian distribution
pig &lt;- function(x, mu, lambda) {
  temp &lt;- suppressWarnings(sqrt(lambda/x))
  xx &lt;- pnorm(temp*(x/mu-1))+exp(2*lambda/mu+pnorm(temp*(x/mu+1),
              lower.tail=FALSE, log.p=TRUE))
  out &lt;- ifelse(x&lt;=0, 0, xx)
  out
}
# Fit to ozone data
data(airquality)
(lmom&lt;-samlmu(airquality$Ozone))
pel.out &lt;- pelp(lmom[1:2], pig, start=c(10,10), bounds=c(0,Inf))
pel.out
# First four L-moments of fitted distribution,
# for comparison with sample L-moments
lmrp(pig, pel.out$para[1], pel.out$para[2], bounds=c(0,Inf))
rm(pel.out)

## A Student t distribution with location and scale parameters
#
qstu &lt;- function(p, xi, alpha, df) xi + alpha * qt(p, df)
# Estimate parameters.  Distribution is symmetric: use type="lss"
pelq(c(3,5,0,0.2345), qstu, start=c(0,1,10), type="lss")
# Doesn't converge (at least on the author's system) --
# try a different parametrization
qstu2 &lt;- function(p, xi, alpha, shape) xi + alpha * qt(p, 1/shape)
# Now it converges
pelq(c(3,5,0,0.2345), qstu2, start=c(0,1,0.1), type="lss")
# Or try a different optimization method
pelq(c(3,5,0,0.2345), qstu, start=c(0,1,10), type="lss",
    method="uniroot", lower=2, upper=100)

## With trimmed L-moments, we can fit this distribution even when
## it does not have a finite mean ('df' less than 1)
set.seed(123456)
dat &lt;- qstu(runif(1000), xi=3, alpha=5, df=0.75)
lmom &lt;- samlmu(dat, trim=1)
lmom
# Note that pelq() infers 'trim=1' from the names of 'lmom'
pelq(lmom, qstu, start=c(0,1,10), type="lss",  method="uniroot",
  lower=0.51, upper=100)

rm(qstu, qstu2, dat, lmom)

</code></pre>

<hr>
<h2 id='samlmu'>Sample L-moments</h2><span id='topic+samlmu'></span><span id='topic+samlmu.s'></span><span id='topic+.samlmu'></span>

<h3>Description</h3>

<p>Computes the &ldquo;unbiased&rdquo; sample (trimmed) <code class="reqn">L</code>-moments
and <code class="reqn">L</code>-moment ratios of a data vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samlmu(x, nmom=4, sort.data=TRUE, ratios=sort.data, trim=0)
samlmu.s(x, nmom=4, sort.data=TRUE, ratios=sort.data, trim=0)
.samlmu(x, nmom=4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samlmu_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="samlmu_+3A_nmom">nmom</code></td>
<td>
<p>Number of <code class="reqn">L</code>-moments to be found.</p>
</td></tr>
<tr><td><code id="samlmu_+3A_sort.data">sort.data</code></td>
<td>
<p>Logical: whether the <code>x</code> vector needs to be sorted.</p>
</td></tr>
<tr><td><code id="samlmu_+3A_ratios">ratios</code></td>
<td>
<p>Logical. If <code>FALSE</code>, <code class="reqn">L</code>-moments are computed;
if <code>TRUE</code> (the default), <code class="reqn">L</code>-moment ratios are computed.</p>
</td></tr>
<tr><td><code id="samlmu_+3A_trim">trim</code></td>
<td>
<p>Degree of trimming.
If a single value, symmetric trimming of the specified degree will be used.
If a vector of length 2, the two values
indicate the degrees of trimming at the lower and upper ends of the
&ldquo;conceptual sample&rdquo; (Elamir and Seheult, 2003) of order statistics
that is used to define the trimmed <code class="reqn">L</code>-moments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>samlmu</code> and <code>samlmu.s</code> are functionally identical.
<code>samlmu</code> calls a Fortran routine internally, and is usually faster.
<code>samlmu.s</code> is written entirely in the S language; it is provided
so that users can conveniently see how the calculations are done.
</p>
<p><code>.samlmu</code> is a &ldquo;bare-bones&rdquo; version for use in programming.
It gives an error if <code>x</code> contains missing values,
computes <code class="reqn">L</code>-moment ratios and not <code class="reqn">L</code>-moments,
does not give a warning if all the elements of <code>x</code> are equal,
and returns its result in an unnamed vector.
</p>
<p>Sample <code class="reqn">L</code>-moments are defined in Hosking (1990).
Calculations use the algorithm given in Hosking (1996, p.14).
</p>
<p>Trimmed sample <code class="reqn">L</code>-moments are defined as in Hosking (2007), eq. (15)
(a small extension of Elamir and Seheult (2003), eq. (16)).
They are calculated from the untrimmed sample <code class="reqn">L</code>-moments
using the recursions of Hosking (2007), eqs. (12)-(13).
</p>


<h3>Value</h3>

<p>If <code>ratios</code> is <code>TRUE</code>, a numeric vector containing
the <code class="reqn">L</code>-moments and <code class="reqn">L</code>-moment ratios,
in the order <code class="reqn">\ell_1</code>, <code class="reqn">\ell_2</code>, <code class="reqn">t_3</code>, <code class="reqn">t_4</code>, etc.
If <code>ratios</code> is <code>FALSE</code>, a numeric vector containing the <code class="reqn">L</code>-moments
in the order <code class="reqn">\ell_1</code>, <code class="reqn">\ell_2</code>, <code class="reqn">\ell_3</code>, <code class="reqn">\ell_4</code>, etc.
</p>


<h3>Note</h3>

<p>The term &ldquo;trimmed&rdquo; is used in a different sense from
its usual meaning in robust statistics.
In particular, the first trimmed <code class="reqn">L</code>-moment is in general not equal to
any trimmed mean of the data sample.</p>


<h3>Author(s)</h3>

<p>J. R. M. Hosking <a href="mailto:jrmhosking@gmail.com">jrmhosking@gmail.com</a></p>


<h3>References</h3>

<p>Elamir, E. A. H., and Seheult, A. H. (2003).  Trimmed L-moments.
<em>Computational Statistics and Data Analysis</em>, <b>43</b>, 299-314.
</p>
<p>Hosking, J. R. M. (1990).
<code class="reqn">L</code>-moments: analysis and estimation of distributions
using linear combinations of order statistics.
<em>Journal of the Royal Statistical Society, Series B</em>, <b>52</b>, 105-124.
</p>
<p>Hosking, J. R. M. (1996).
Fortran routines for use with the method of <code class="reqn">L</code>-moments, Version 3.
Research Report RC20525, IBM Research Division, Yorktown Heights, N.Y.
</p>
<p>Hosking, J. R. M. (2007).  Some theory and practical uses of trimmed L-moments.
<em>Journal of Statistical Planning and Inference</em>, <b>137</b>, 3024-3039.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(airquality)
samlmu(airquality$Ozone, 6)

# Trimmed L-moment ratios
samlmu(airquality$Ozone, trim=1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
