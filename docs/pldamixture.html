<!DOCTYPE html><html><head><title>Help for package pldamixture</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pldamixture}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pldamixture-package'><p>Post-Linkage Data Analysis Based on Mixture Modelling</p></a></li>
<li><a href='#fit_mixture'><p>Adjustment Method</p></a></li>
<li><a href='#lifem'><p>LIFE-M Data</p></a></li>
<li><a href='#predict.fitmixture'><p>Predictions From a &quot;fitmixture&quot; Object</p></a></li>
<li><a href='#print.fitmixture'><p>Print a &quot;fitmixture&quot; Object</p></a></li>
<li><a href='#summary.fitmixture'><p>Summarize a &quot;fitmixture&quot; Object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Post-Linkage Data Analysis Based on Mixture Modelling</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, survival</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform inference in the secondary analysis setting with linked data potentially containing mismatch errors. Only the linked data file may be accessible and information about the record linkage process may be limited or unavailable. Implements the 'General Framework for Regression with Mismatched Data' developed by Slawski et al. (2023) &lt;<a href="https://doi.org/10.48550/arXiv.2306.00909">doi:10.48550/arXiv.2306.00909</a>&gt;. The framework uses a mixture model for pairs of linked records whose two components reflect distributions conditional on match status, i.e., correct match or mismatch. Inference is based on composite likelihood and the Expectation-Maximization (EM) algorithm. The package currently supports Cox Proportional Hazards Regression (right-censored data only) and Generalized Linear Regression Models (Gaussian, Gamma, Poisson, and Logistic (binary models only)). Information about the underlying record linkage process can be incorporated into the method if available (e.g., assumed overall mismatch rate, safe matches, predictors of match status, or predicted probabilities of correct matches).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Priyanjali Bukke &lt;pbukke@gmu.edu&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/bpriy/pldamixture">https://github.com/bpriy/pldamixture</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-01 19:15:06 UTC; Sono</td>
</tr>
<tr>
<td>Author:</td>
<td>Priyanjali Bukke [aut, cre],
  Zhenbang Wang [aut],
  Martin Slawski [aut] (mslawsk3@gmu.edu),
  Brady T. West [aut],
  Emanuel Ben-David [aut],
  Guoqing Diao [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-05 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='pldamixture-package'>Post-Linkage Data Analysis Based on Mixture Modelling</h2><span id='topic+pldamixture-package'></span>

<h3>Description</h3>

<p><code>pldamixture</code> implements the &quot;General Framework for Regression with
Mismatched Data&quot; developed by Slawski et al., 2023. The framework uses a
mixture model for pairs of linked records whose two components reflect
distributions conditional on match status, i.e., correct match or mismatch.
Inference is based on composite likelihood and the EM algorithm.<br /><br />
The package contains 4 functions for usage:<br /> <code>fit_mixture</code><br />
<code>print.fitmixture</code><br /> <code>summary.fitmixture</code><br /> <code>predict.fitmixture</code>
</p>


<h3>Note</h3>

<p>The references below discuss the implemented framework in more detail.<br /><br />
*Corresponding Author (mslawsk3@gmu.edu)
</p>


<h3>References</h3>

<p>Slawski, M.*, West, B. T., Bukke, P., Diao, G., Wang, Z., &amp; Ben-David, E. (2023).
A General Framework for Regression with Mismatched Data Based on Mixture Modeling.
Under Review. &lt; doi: <a href="https://doi.org/10.48550/arXiv.2306.00909">10.48550/arXiv.2306.00909</a> &gt;<br />
</p>
<p>Bukke, P., Ben-David, E., Diao, G., Slawski, M.*, &amp; West, B. T. (2023).
Cox Proportional Hazards Regression Using Linked Data: An Approach Based on Mixture Modelling.
Under Review. <br />
</p>
<p>Slawski, M.*, Diao, G., Ben-David, E. (2021). A pseudo-likelihood approach to linear
regression with partially shuffled data. Journal of Computational and Graphical
Statistics. 30(4), 991-1003 &lt; doi: <a href="https://doi.org/10.1080/10618600.2020.1870482">10.1080/10618600.2020.1870482</a> &gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># optional inputs for linear regression of age at death on year of birth,
#    using a cubic polynomial specification.
## use commonness of names as predictors of match status
## first and last names were used for linkage
mformula &lt;- ~commf + comml
## hand-linked records are considered "safe" matches
safematches &lt;- ifelse(lifem$hndlnk =="Hand-Linked At Some Level", TRUE, FALSE)
## overall mismatch rate in the data set is assumed to be ~ 0.05
mrate &lt;- 0.05

fit &lt;- fit_mixture(age_at_death ~ poly(unit_yob, 3, raw = TRUE), data = lifem,
                   family = "gaussian", mformula, safematches, mrate)
print(fit)
summary(fit)
predict(fit)
</code></pre>

<hr>
<h2 id='fit_mixture'>Adjustment Method</h2><span id='topic+fit_mixture'></span>

<h3>Description</h3>

<p>Perform regression adjusted for mismatched data. The function currently supports
Cox Proportional Hazards Regression (right-censored data only) and Generalized
Linear Regression Models (Gaussian, Gamma, Poisson, and Logistic (binary models
only)). Information about the underlying record linkage process can be
incorporated into the method if available (e.g., assumed overall mismatch rate,
safe matches, predictors of match status, or predicted probabilities of correct
matches).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_mixture(
  formula,
  data,
  family = "gaussian",
  mformula,
  safematches,
  mrate,
  control = list(initbeta = "default", initgamma = "default", fy = "default", maxiter =
    1000, tol = 1e-04, cmaxiter = 1000),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_mixture_+3A_formula">formula</code></td>
<td>
<p>a formula object for the outcome model, with the covariate(s) on
the right of &quot;~&quot; and the response on the left. In the Cox proportional hazards
setting, the response should be provided using the <code>Surv</code> function and the
covariates should be separated by + signs.</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_data">data</code></td>
<td>
<p>a data.frame with linked data used in &quot;formula&quot; and &quot;formula.m&quot; (optional)</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_family">family</code></td>
<td>
<p>the type of regression model (&quot;gaussian&quot; - default, &quot;poisson&quot;,
&quot;binomial&quot;, &quot;gamma&quot;, &quot;cox&quot;). For Generalized Linear Models, standard link functions are
used (&quot;identity&quot; for Gaussian, &quot;log&quot; for Poisson and Gamma, and &quot;logit&quot; for binomial).</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_mformula">mformula</code></td>
<td>
<p>a one-sided formula object for the mismatch indicator model, with the
covariates on the right of &quot;~&quot;. The default is an intercept-only model corresponding
to a constant mismatch rate)</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_safematches">safematches</code></td>
<td>
<p>an indicator variable for safe matches (TRUE : record can be treated as a
correct match and FALSE : record may be mismatched). The default is FALSE for all matches.</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_mrate">mrate</code></td>
<td>
<p>the assumed overall mismatch rate (a proportion between 0 and 1). If
not provided, no overall mismatch rate is assumed.</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_control">control</code></td>
<td>
<p>an optional list variable to customize the initial parameter estimates
(&quot;initbeta&quot; for the outcome model and &quot;initgamma&quot; for the mismatch indicator model),
estimated marginal density of the response (&quot;fy&quot;), maximum iterations for the
EM algorithm (&quot;maxiter&quot;), maximum iterations for the subroutine in the constrained
logistic regression function (&quot;cmaxiter&quot;), and convergence tolerance for
the termination of the EM algorithm (&quot;tol&quot;).</p>
</td></tr>
<tr><td><code id="fit_mixture_+3A_...">...</code></td>
<td>
<p>the option to directly pass &quot;control&quot; arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of results from the function called depending on the &quot;family&quot; specified.
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>the outcome model coefficient estimates</p>
</td></tr>
<tr><td><code>match.prob</code></td>
<td>
<p>the correct match probabilities for all observations</p>
</td></tr>
<tr><td><code>objective</code></td>
<td>
<p>a variable that tracks the negative log pseudo-likelihood for all iterations of the EM algorithm.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the type of (outcome) regression model</p>
</td></tr>
<tr><td><code>standard.errors</code></td>
<td>
<p>the estimated standard errors</p>
</td></tr>
<tr><td><code>m.coefficients</code></td>
<td>
<p>the correct match model coefficient estimates</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr>
<tr><td><code>wfit</code></td>
<td>
<p>an internal-use object for the predict function</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>
<p>the dispersion parameter estimate when the family is a Generalized
Linear Model</p>
</td></tr>
<tr><td><code>Lambdahat_0</code></td>
<td>
<p>the baseline cumulative hazard (using weighted Breslow estimator) when the family is &quot;cox&quot;</p>
</td></tr>
<tr><td><code>g_Lambdahat_0</code></td>
<td>
<p>the baseline cumulative hazard for the marginal density of the response variable
(using Nelson-Aalen estimator) when the family is &quot;cox&quot;</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The references below discuss the implemented framework in more detail. The standard
errors are estimated using Louis' method for the &quot;cox&quot; family (Bukke et al., 2023) and
using the sandwich formula otherwise (Slawski et al., 2023).<br /><br />
*Corresponding Author (mslawsk3@gmu.edu)
</p>


<h3>References</h3>

<p>Slawski, M.*, West, B. T., Bukke, P., Diao, G., Wang, Z., &amp; Ben-David, E. (2023).
A General Framework for Regression with Mismatched Data Based on Mixture Modeling.
Under Review. &lt; doi: <a href="https://doi.org/10.48550/arXiv.2306.00909">10.48550/arXiv.2306.00909</a> &gt;<br />
</p>
<p>Bukke, P., Ben-David, E., Diao, G., Slawski, M.*, &amp; West, B. T. (2023).
Cox Proportional Hazards Regression Using Linked Data: An Approach Based on Mixture Modelling.
Under Review. <br />
</p>
<p>Slawski, M.*, Diao, G., Ben-David, E. (2021). A pseudo-likelihood approach to linear
regression with partially shuffled data. Journal of Computational and Graphical
Statistics. 30(4), 991-1003 &lt; doi: <a href="https://doi.org/10.1080/10618600.2020.1870482">10.1080/10618600.2020.1870482</a> &gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## commonness score of first and last names used for linkage
mformula &lt;- ~commf + comml
## hand-linked records are considered "safe" matches
safematches &lt;- ifelse(lifem$hndlnk =="Hand-Linked At Some Level", TRUE, FALSE)
## overall mismatch rate in the data set is assumed to be ~ 0.05
mrate &lt;- 0.05

fit &lt;- fit_mixture(age_at_death ~ poly(unit_yob, 3, raw = TRUE), data = lifem,
                   family = "gaussian", mformula, safematches, mrate)

</code></pre>

<hr>
<h2 id='lifem'>LIFE-M Data</h2><span id='topic+lifem'></span>

<h3>Description</h3>

<p>The <code>lifem</code> data set contains a subset of data from the Life-M project (<a href="https://life-m.org/">https://life-m.org/</a>) on 3,238 individuals born between 1883
to 1906. These records were obtained from linking birth certificates and death certificates either of two
ways. A fraction of the records (2,159 records) were randomly sampled to be “hand-linked at some level” (HL).
These records are high quality and were manually linked at some point by trained research assistants.
The remaining records were “purely machine-linked” (ML) based on probabilistic record linkage without clerical
review. The Life-M team expects the mismatch rate among these records to be around 5% (Bailey et al.
2022). Of interest is the relationship between age at death and year of birth. The <code>lifem</code> demo data set consists of 2,159 hand-linked records
and 1,079 records that were randomly sampled from the purely machine-linked records (~2:1 HL-ML ratio).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lifem)
</code></pre>


<h3>Format</h3>

<p>a data frame with 3,238 rows and 6 variables
</p>


<h3>Details</h3>


<ul>
<li><p> yob: year of birth (value from 1883 and 1906)
</p>
</li>
<li><p> unit_yob: yob re-scaled to the unit interval for analysis (between 0 and 1). If X is the yob, we use the following:
(X – min(X)) / (max(X) – min(X)) = a * X + b, a = 1/(max(X) – min(X)), b = -min(X)*a
</p>
</li>
<li><p> age_at_death: age at death (in years)
</p>
</li>
<li><p> hndlnk: whether record was purely machine-linked or hand-linked at some level.
</p>
</li>
<li><p> commf: commonness score of first name (between 0 and 1). It is based on the 1940 census.
It is a ratio of the log count of the individual’s first name over the log count of the most
commonly occurring first name in the census.
</p>
</li>
<li><p> comml: commonness score of last name (between 0 and 1). It is based on the 1940 census.
It is a ratio of the log count of the individual’s last name over the log count of the most
commonly occurring last name in the census.
</p>
</li></ul>



<h3>References</h3>

<p>Bailey, Martha J., Lin, Peter Z., Mohammed, A.R. Shariq, Mohnen, Paul, Murray, Jared,
Zhang, Mengying, and Prettyman, Alexa. LIFE-M: The Longitudinal, Intergenerational
Family Electronic Micro-Database. Ann Arbor, MI: Inter-university Consortium for
Political and Social Research (distributor), 2022-12-21. &lt; doi: <a href="https://doi.org/10.3886/E155186V5">10.3886/E155186V5</a> &gt;
</p>

<hr>
<h2 id='predict.fitmixture'>Predictions From a &quot;fitmixture&quot; Object</h2><span id='topic+predict.fitmixture'></span>

<h3>Description</h3>

<p>Obtain predictions from a <code>fit_mixture()</code> object using <code>predict.coxph()</code>, <code>predict.glm()</code>, or <code>predict.lm()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitmixture'
predict(
  object,
  newdata,
  type,
  terms = NULL,
  na.action = na.pass,
  reference = "strata",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.fitmixture_+3A_object">object</code></td>
<td>
<p>the result of a call to <code>fit_mixture()</code></p>
</td></tr>
<tr><td><code id="predict.fitmixture_+3A_newdata">newdata</code></td>
<td>
<p>optional new data to obtain predictions for. The original data is used by default.</p>
</td></tr>
<tr><td><code id="predict.fitmixture_+3A_type">type</code></td>
<td>
<p>the type of prediction. For the &quot;cox&quot; family, the choices are the linear predictor (&quot;lp&quot;), the risk score exp(lp) (&quot;risk&quot;),
the expected number of events given the covariates and follow-up time (&quot;expected&quot;),
and the terms of the linear predictor (&quot;terms&quot;). The survival probability for a subject is
equal to exp(-expected). For the &quot;gaussian&quot; family, the choices are response (&quot;response&quot;) or model term (&quot;terms&quot;).
For the other glm families (&quot;poisson&quot;, &quot;binomial&quot;, &quot;gamma&quot;), the choices are predictions on the scale of the linear predictors (&quot;link&quot;),
response (&quot;response&quot;), or model term (&quot;terms&quot;).</p>
</td></tr>
<tr><td><code id="predict.fitmixture_+3A_terms">terms</code></td>
<td>
<p>the terms when type = &quot;terms&quot;. By default, all terms are included.</p>
</td></tr>
<tr><td><code id="predict.fitmixture_+3A_na.action">na.action</code></td>
<td>
<p>a function for what to do with missing values in <code>newdata</code>. The default is to predict &quot;NA&quot;.</p>
</td></tr>
<tr><td><code id="predict.fitmixture_+3A_reference">reference</code></td>
<td>
<p>when family = &quot;cox&quot;, reference for centering predictions. Available options are c(&quot;strata&quot; - default,
&quot;sample&quot;, &quot;zero&quot;). The default is &quot;strata&quot;.</p>
</td></tr>
<tr><td><code id="predict.fitmixture_+3A_...">...</code></td>
<td>
<p>for future predict arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector or matrix of predictions based on arguments specified.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## commonness score of first and last names used for linkage
mformula &lt;- ~commf + comml
## hand-linked records are considered "safe" matches
safematches &lt;- ifelse(lifem$hndlnk =="Hand-Linked At Some Level", TRUE, FALSE)
## overall mismatch rate in the data set is assumed to be ~ 0.05
mrate &lt;- 0.05
fit &lt;- fit_mixture(age_at_death ~ poly(unit_yob, 3, raw = TRUE), data = lifem,
                   family = "gaussian", mformula, safematches, mrate)

predict(fit)

</code></pre>

<hr>
<h2 id='print.fitmixture'>Print a &quot;fitmixture&quot; Object</h2><span id='topic+print.fitmixture'></span>

<h3>Description</h3>

<p>Print call and outcome model coefficients from a <code>fit_mixture()</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitmixture'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fitmixture_+3A_x">x</code></td>
<td>
<p>the result of a call to <code>fit_mixture()</code></p>
</td></tr>
<tr><td><code id="print.fitmixture_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to print</p>
</td></tr>
<tr><td><code id="print.fitmixture_+3A_...">...</code></td>
<td>
<p>for additional print arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisibly returns the <code>fit_mixture()</code> object that is provided as an argument
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## commonness score of first and last names used for linkage
mformula &lt;- ~commf + comml
## hand-linked records are considered "safe" matches
safematches &lt;- ifelse(lifem$hndlnk =="Hand-Linked At Some Level", TRUE, FALSE)
## overall mismatch rate in the data set is assumed to be ~ 0.05
mrate &lt;- 0.05
fit &lt;- fit_mixture(age_at_death ~ poly(unit_yob, 3, raw = TRUE), data = lifem,
                   family = "gaussian", mformula, safematches, mrate)

print(fit)

</code></pre>

<hr>
<h2 id='summary.fitmixture'>Summarize a &quot;fitmixture&quot; Object</h2><span id='topic+summary.fitmixture'></span>

<h3>Description</h3>

<p>Summarize results from a <code>fit_mixture()</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitmixture'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.fitmixture_+3A_object">object</code></td>
<td>
<p>the result of a call to <code>fit_mixture()</code></p>
</td></tr>
<tr><td><code id="summary.fitmixture_+3A_...">...</code></td>
<td>
<p>for additional summary arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of results from the function called depending on the &quot;family&quot; specified.
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the assumed type of (outcome) regression model</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>a matrix with the outcome model's coefficient estimates, standard errors, t or z values, and p-values</p>
</td></tr>
<tr><td><code>m.coefficients</code></td>
<td>
<p>a matrix with the correct match model's coefficient estimates and standard errors</p>
</td></tr>
<tr><td><code>avgcmr</code></td>
<td>
<p>the average correct match rate among all records</p>
</td></tr>
<tr><td><code>match.prob</code></td>
<td>
<p>the correct match probabilities for all observations</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>
<p>the dispersion parameter estimate when the family is a Generalized Linear Model</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## commonness score of first and last names used for linkage
mformula &lt;- ~commf + comml
## hand-linked records are considered "safe" matches
safematches &lt;- ifelse(lifem$hndlnk =="Hand-Linked At Some Level", TRUE, FALSE)
## overall mismatch rate in the data set is assumed to be ~ 0.05
mrate &lt;- 0.05
fit &lt;- fit_mixture(age_at_death ~ poly(unit_yob, 3, raw = TRUE), data = lifem,
                   family = "gaussian", mformula, safematches, mrate)

summary(fit)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
