<!DOCTYPE html><html><head><title>Help for package Rwofost</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rwofost}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Rwofost-package'>
<p>WOFOST Crop Growth Simulation Model</p></a></li>
<li><a href='#predict'>
<p>Spatial WOFOST model predictions</p></a></li>
<li><a href='#wofost'>
<p>WOFOST crop growth model</p></a></li>
<li><a href='#wofost_control'>
<p>WOFOST control parameters</p></a></li>
<li><a href='#wofost_crop'>
<p>WOFOST crop parameters</p></a></li>
<li><a href='#wofost_model'>
<p>WOFOST crop growth model</p></a></li>
<li><a href='#wofost_soil'>
<p>WOFOST soil parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Description:</td>
<td>An implementation of the WOFOST ("World Food Studies") crop growth model. WOFOST is a dynamic simulation model that uses daily weather data, and crop, soil and management parameters to simulate crop growth and development. See De Wit et al. (2019) &lt;<a href="https://doi.org/10.1016%2Fj.agsy.2018.06.018">doi:10.1016/j.agsy.2018.06.018</a>&gt; for a recent review of the history and use of the model.</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>WOFOST Crop Growth Simulation Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8-3</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-10-01</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>meteor, methods (&ge; 0.2-2), Rcpp (&ge; 0.12.4)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>terra, raster</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=Rwofost">https://CRAN.R-project.org/package=Rwofost</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/cropmodels/Rwofost/issues">https://github.com/cropmodels/Rwofost/issues</a></td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Robert J. Hijmans &lt;r.hijmans@gmail.com&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-01 15:58:08 UTC; rhijm</td>
</tr>
<tr>
<td>Author:</td>
<td>Robert J. Hijmans [cre, aut],
  Huang Fang [ctb],
  C.A. van Diepen [ctb],
  Allard de Wit [ctb],
  Daniel van Kraalingen [ctb],
  Tamme van der Wal [ctb],
  C. Rappoldt [ctb],
  Hendrik Boogard [ctb],
  I.G.A.M. Noy [ctb],
  Alterra, Wageningen-UR [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-01 16:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Rwofost-package'>
WOFOST Crop Growth Simulation Model
</h2><span id='topic+Rwofost-package'></span><span id='topic+Rwofost'></span>

<h3>Description</h3>

<p>This package provides an R interface to a C++ implementation of the WOFOST crop growth simulation model.
</p>
<p>This is the first release. Please consider this version unstable. It needs more work to simplify its use.  
</p>
<p>More detailed documentation is also forthcoming, but there is ample general documentation available on-line. The documentation for the FORTRAN version 7.1 is most applicable. For example, <a href="https://www.wur.nl/en/show/WOFOST-7.1-User-Manual.htm">this manual</a>.
</p>
<p>The WOFOST model that this R package uses is written in C++ and it can also be compiled and run as a stand-alone program (see the <a href="https://github.com/cropmodels/Rwofost">github repository</a>. It was derived from the original FORTRAN implementation. It passes the tests cases developed for the PCSE/python version. This suggests that you safely can use the model for &quot;standard&quot; computation of potential and water-limited production. 
</p>

<hr>
<h2 id='predict'>
Spatial WOFOST model predictions
</h2><span id='topic+predict'></span><span id='topic+predict+2CRcpp_WofostModel-method'></span>

<h3>Description</h3>

<p>Make spatial predictions with a WOFOST model. First create a model, then use the model with a SpatDataSet of weather and a SpatRaster of soil properties to make spatial predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Rcpp_WofostModel'
predict(object, weather, mstart, soilindex=NULL,
     soils=NULL, filename="", overwrite=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_+3A_object">object</code></td>
<td>
<p>WOFOST model</p>
</td></tr>
<tr><td><code id="predict_+3A_weather">weather</code></td>
<td>
<p>SpatRasterDataset with weather data. The must be six sub-datasets with daily weather data for the same days and these names: tmin, tmax, prec, srad, wind and vapr</p>
</td></tr>  
<tr><td><code id="predict_+3A_mstart">mstart</code></td>
<td>
<p>dates to start the model</p>
</td></tr>  
<tr><td><code id="predict_+3A_soilindex">soilindex</code></td>
<td>
<p>SpatRaster. postive integer with the ID for the soil type to use</p>
</td></tr>  
<tr><td><code id="predict_+3A_soils">soils</code></td>
<td>
<p>list of wofost soil types</p>
</td></tr>
<tr><td><code id="predict_+3A_filename">filename</code></td>
<td>
<p>character. Output filename. Optional</p>
</td></tr>
<tr><td><code id="predict_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. If <code>TRUE</code>, <code>filename</code> is overwritten</p>
</td></tr>
<tr><td><code id="predict_+3A_...">...</code></td>
<td>
<p>list. Options for writing files as in <code><a href="terra.html#topic+writeRaster">writeRaster</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>SpatRaster
</p>

<hr>
<h2 id='wofost'>
WOFOST crop growth model
</h2><span id='topic+wofost'></span>

<h3>Description</h3>

<p>Run the WOFOST crop growth model. Through this interface, you provide weather data, and crop, soil and control parameters to run the model once. For multiple runs it might be preferable to use <code><a href="#topic+wofost_model">wofost_model</a></code> instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wofost(crop, weather, soil, control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wofost_+3A_crop">crop</code></td>
<td>
<p>list. Crop parameters</p>
</td></tr>
<tr><td><code id="wofost_+3A_weather">weather</code></td>
<td>
<p>data.frame with weather data</p>
</td></tr>
<tr><td><code id="wofost_+3A_soil">soil</code></td>
<td>
<p>list. Soil parameters</p>
</td></tr>
<tr><td><code id="wofost_+3A_control">control</code></td>
<td>
<p>list. Model control options</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The weather data must be passed as a data.frame with the following variables and units.
</p>

<table>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <b>variable</b> </td><td style="text-align: left;"> <b>description</b> </td><td style="text-align: left;"> <b>class / unit</b> </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>date</code> </td><td style="text-align: left;"> "Date" class variable </td><td style="text-align: left;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>srad</code> </td><td style="text-align: left;"> Solar radiation  </td><td style="text-align: left;"> kJ m-2 day-1 </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>tmin</code> </td><td style="text-align: left;"> Minimum temperature </td><td style="text-align: left;"> degrees C </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>tmax</code> </td><td style="text-align: left;"> Maximum temperature </td><td style="text-align: left;"> degrees C </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>vapr</code> </td><td style="text-align: left;"> Vapor pressure </td><td style="text-align: left;"> kPa </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>wind</code> </td><td style="text-align: left;"> Wind speed </td><td style="text-align: left;"> m s-1 </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>prec</code> </td><td style="text-align: left;"> Precipitation </td><td style="text-align: left;"> mm day-1 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Note that there should not be any time gaps between the days in the data.frame 
</p>


<h3>Value</h3>

<p>matrix
</p>


<h3>References</h3>

<p>Van Diepen, C.A., J. Wolf, and H van Keulen, 1989. WOFOST: a simulation model of crop production. Soil Use and Management, 5: 16-24
</p>
<p>Van Keulen, H. and J. Wolf, 1986. Modelling of agricultural production : weather, soils and crops. <a href="http://edepot.wur.nl/168025">http://edepot.wur.nl/168025</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wofost_model">wofost_model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# weather data
f &lt;- system.file("extdata/Netherlands_Swifterbant.csv", package="meteor")
w &lt;- read.csv(f)
w$date &lt;- as.Date(w$date)
head(w)

# crop and soil parameters
crop &lt;- wofost_crop("barley")
soil &lt;- wofost_soil("ec1")

# "control" parameters
contr &lt;- wofost_control()
contr$modelstart &lt;- as.Date("1980-02-06")
contr$latitude=52.57
contr$elevation=50


# run model
d &lt;- wofost(crop, w, soil, contr)

# output
head(d)
tail(d)
plot(d[,"step"], d[, "LAI"])


## Another example
crop &lt;- wofost_crop("rapeseed_1001")
soil &lt;- wofost_soil("soil_5")
contr$modelstart &lt;- as.Date("1977-01-01")

rp &lt;- wofost(crop, w, soil, contr)
plot(rp[,"step"], rp[, "LAI"])

# yield
plot(rp[, 1], rp[,"WSO"])


## water limited
contr$water_limited &lt;- TRUE
contr$modelstart &lt;- as.Date("1985-01-01")

crop &lt;- wofost_crop("maize_1")
f &lt;- system.file("extdata/Philippines_IRRI.csv", package="meteor")
wth &lt;- read.csv(f)
wth$date &lt;- as.Date(wth$date)
contr$elevation &lt;- 21
contr$latitude &lt;- 14.18

ma &lt;- wofost(crop, wth, soil, contr)
plot(ma[,"step"], ma[, "LAI"])

</code></pre>

<hr>
<h2 id='wofost_control'>
WOFOST control parameters
</h2><span id='topic+wofost_control'></span>

<h3>Description</h3>

<p>This functions returns a list of &quot;control&quot; parameters to run the WOFOST model. Either a default list, or from a file. 
See this manual <a href="https://www.wur.nl/en/show/WOFOST-7.1-User-Manual.htm">https://www.wur.nl/en/show/WOFOST-7.1-User-Manual.htm</a> for the interpretation of the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wofost_control(filename='')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wofost_control_+3A_filename">filename</code></td>
<td>
<p>character. Filename</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+wofost">wofost</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>contr &lt;- wofost_control()
str(contr)
</code></pre>

<hr>
<h2 id='wofost_crop'>
WOFOST crop parameters
</h2><span id='topic+wofost_crop'></span>

<h3>Description</h3>

<p>This function returns a list of crop parameters for the WOFOST model.
See this manual <a href="https://www.wur.nl/en/show/WOFOST-7.1-User-Manual.htm">https://www.wur.nl/en/show/WOFOST-7.1-User-Manual.htm</a> for their interpretation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wofost_crop(name="", describe=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wofost_crop_+3A_name">name</code></td>
<td>
<p>character. Either the name of a crop that comes with the package (see examples) or a filename of a similarly formatted file</p>
</td></tr>
<tr><td><code id="wofost_crop_+3A_describe">describe</code></td>
<td>
<p>logical. If <code>TRUE</code> avaialble metadata is printed</p>
</td></tr>
</table>


<h3>Value</h3>

<p> list </p>


<h3>References</h3>

<p>van Heemst
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+wofost">wofost</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>wofost_crop('')
crop &lt;- wofost_crop('barley')
str(crop)
</code></pre>

<hr>
<h2 id='wofost_model'>
WOFOST crop growth model
</h2><span id='topic+wofost_model'></span><span id='topic+run'></span><span id='topic+crop+3C-'></span><span id='topic+soil+3C-'></span><span id='topic+control+3C-'></span><span id='topic+weather+3C-'></span><span id='topic+force+3C-'></span><span id='topic+crop+3C-+2CRcpp_WofostModel+2Clist-method'></span><span id='topic+soil+3C-+2CRcpp_WofostModel+2Clist-method'></span><span id='topic+control+3C-+2CRcpp_WofostModel+2Clist-method'></span><span id='topic+weather+3C-+2CRcpp_WofostModel+2Cdata.frame-method'></span><span id='topic+force+3C-+2CRcpp_WofostModel+2Cdata.frame-method'></span><span id='topic+run+2CRcpp_WofostModel-method'></span>

<h3>Description</h3>

<p>Create a WOFOST crop growth model object. Trhough this interface, you first create a model object and then you run it. The advantage is that you can easily change single parameters of the model and run the model again.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wofost_model(crop, weather, soil, control)
run(x, ...)
crop(x) &lt;- value
soil(x) &lt;- value
control(x) &lt;- value
weather(x) &lt;- value
force(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wofost_model_+3A_crop">crop</code></td>
<td>
<p>list. Crop parameters</p>
</td></tr>
<tr><td><code id="wofost_model_+3A_weather">weather</code></td>
<td>
<p>data.frame with weather data. See Details</p>
</td></tr>
<tr><td><code id="wofost_model_+3A_soil">soil</code></td>
<td>
<p>list. Soil parameters</p>
</td></tr>
<tr><td><code id="wofost_model_+3A_control">control</code></td>
<td>
<p>list. Model control options</p>
</td></tr>
<tr><td><code id="wofost_model_+3A_value">value</code></td>
<td>
<p>crop, weather, soil, or control data, as above; or a data.frame for &quot;force&quot;</p>
</td></tr>
<tr><td><code id="wofost_model_+3A_x">x</code></td>
<td>
<p>WOFOST model</p>
</td></tr>
<tr><td><code id="wofost_model_+3A_...">...</code></td>
<td>
<p>additiontal arguments. <code>stopError</code>(logica). If an error occurs and <code>stopError</code> is <code>TRUE</code>, and error message is given. Otherwise, a warning is given and some simulation data (up till when the error occurred) may be returned</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The weather data must be passed as a data.frame with the following variables and units.
</p>

<table>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <b>variable</b> </td><td style="text-align: left;"> <b>description</b> </td><td style="text-align: left;"> <b>class / unit</b> </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>date</code> </td><td style="text-align: left;"> "Date" class variable </td><td style="text-align: left;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>srad</code> </td><td style="text-align: left;"> Solar radiation  </td><td style="text-align: left;"> kJ m-2 day-1 </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>tmin</code> </td><td style="text-align: left;"> Minimum temperature </td><td style="text-align: left;"> degrees C </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>tmax</code> </td><td style="text-align: left;"> Maximum temperature </td><td style="text-align: left;"> degrees C </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>vapr</code> </td><td style="text-align: left;"> Vapor pressure </td><td style="text-align: left;"> kPa </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>wind</code> </td><td style="text-align: left;"> Wind speed </td><td style="text-align: left;"> m s-1 </td>
</tr>
<tr>
 <td style="text-align: left;">
	</td><td style="text-align: left;"> <code>prec</code> </td><td style="text-align: left;"> Precipitation </td><td style="text-align: left;"> mm day-1 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Note that there should not be any time gaps between the days in the data.frame 
</p>


<h3>Value</h3>

<p>WofostModel object
</p>


<h3>References</h3>

<p>Van Diepen, C.A., J. Wolf, and H van Keulen, 1989. WOFOST: a simulation model of crop production. Soil Use and Management, 5: 16-24
</p>
<p>Van Keulen, H. and J. Wolf, 1986. Modelling of agricultural production : weather, soils and crops. <a href="http://edepot.wur.nl/168025">http://edepot.wur.nl/168025</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# weather data
f &lt;- system.file("extdata/Netherlands_Swifterbant.csv", package="meteor")
w &lt;- read.csv(f)
w$date &lt;- as.Date(w$date)

crop &lt;- wofost_crop("barley")
soil &lt;- wofost_soil("ec1")
contr &lt;- wofost_control()

contr$modelstart &lt;- as.Date("1980-02-06")
contr$latitude=52.57
contr$elevation=50

# create model
m &lt;- wofost_model(crop, w, soil, contr)

# run model
x &lt;- run(m)
plot(x[,"date"], x[, "LAI"], cex=.5)

# make a change
m$control$modelstart = as.Date("1980-02-20")

# run model again
y &lt;- run(m)
lines(y[,"date"], y[, "LAI"], col="red")

# change the crop 
crop(m) &lt;- wofost_crop("potato_704") 
p &lt;- run(m)
lines(p[,"date"], p[, "LAI"], col="blue")
</code></pre>

<hr>
<h2 id='wofost_soil'>
WOFOST soil parameters
</h2><span id='topic+wofost_soil'></span>

<h3>Description</h3>

<p>This function returns a list with soil parameters for the WOFOST model.
See this manual <a href="https://www.wur.nl/en/show/WOFOST-7.1-User-Manual.htm">https://www.wur.nl/en/show/WOFOST-7.1-User-Manual.htm</a> for their interpretation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wofost_soil(name='')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wofost_soil_+3A_name">name</code></td>
<td>
<p>character. Either the name of a soil that comes with the package (see examples) or a filename of a similarly formatted file</p>
</td></tr>
</table>


<h3>Value</h3>

<p> list </p>


<h3>See Also</h3>

 <p><code><a href="#topic+wofost">wofost</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>wofost_soil('')
soil &lt;- wofost_soil('ec1')
str(soil)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
