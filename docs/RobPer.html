<!DOCTYPE html><html><head><title>Help for package RobPer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RobPer}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RobPer-package'>
<p>The RobPer-package</p></a></li>
<li><a href='#betaCvMfit'>
<p>Robust fit of a Beta distribution using CvM distance minimization</p></a></li>
<li><a href='#disturber'>
<p>Disturbing light curve data</p></a></li>
<li><a href='#FastS'>
<p>S-Regression using the Fast-S-Algorithm</p></a></li>
<li><a href='#FastTau'>
<p>Tau-Regression using the Fast-tau-Algorithm</p></a></li>
<li><a href='#lc_noise'>
<p>Noise and measurement accuracy generator for light curves</p></a></li>
<li><a href='#Mrk421'><p>Data: Light curve from Mrk 421</p></a></li>
<li><a href='#Mrk501'><p>Data: Light curve from Mrk 501</p></a></li>
<li><a href='#RobPer'>
<p>Periodogram based on (robustly) fitting a periodic function to a light curve</p></a></li>
<li><a href='#sampler'>
<p>Generator for irregularly sampled observation times</p></a></li>
<li><a href='#signalgen'>
<p>Generator for periodic signal in a light curve</p></a></li>
<li><a href='#star_groj0422.32'><p>Data: Light curve from GROJ0422+32</p></a></li>
<li><a href='#TK95'>
<p>Power law noise generator</p></a></li>
<li><a href='#TK95_uneq'>
<p>Power law noise generator for unequally sampled observation times</p></a></li>
<li><a href='#tsgen'>
<p>Artificial light curve generator</p></a></li>
<li><a href='#Xgen'>
<p>Designmatrix generator</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Periodogram and Periodicity Detection Methods</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-12</td>
</tr>
<tr>
<td>Depends:</td>
<td>robustbase, quantreg, splines, BB, rgenoud</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates periodograms based on (robustly) fitting periodic functions to light curves (irregularly observed time series, possibly with measurement accuracies, occurring in astroparticle physics). Three main functions are included: RobPer() calculates the periodogram. Outlying periodogram bars (indicating a period) can be detected with betaCvMfit(). Artificial light curves can be generated using the function tsgen(). For more details see the corresponding article: Thieler, Fried and Rathjens (2016), Journal of Statistical Software 69(9), 1-36, &lt;<a href="https://doi.org/10.18637%2Fjss.v069.i09">doi:10.18637/jss.v069.i09</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Copyright:</td>
<td>The data in star_groj0422.32 have been kindly provided by
the NASA. The data in Mrk421 and Mrk501 have been kindly
provided by the Deutsches Elektronen-Synchrotron. See the
respective documentation.</td>
</tr>
<tr>
<td>Author:</td>
<td>Anita M. Thieler [aut],
  Jonathan Rathjens [aut, cre],
  Roland Fried [aut],
  Brenton R. Clarke [ctb] (function betaCvMfit()),
  Uwe Ligges [ctb] (function TK95()),
  Matias Salibian-Barrera [ctb] (functions FastS() and FastTau()),
  Gert Willems [ctb] (function FastTau()),
  Victor Yohai [ctb] (function FastS())</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jonathan Rathjens &lt;jonathan.rathjens@tu-dortmund.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-12 17:09:05 UTC; jonat</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-12 17:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='RobPer-package'>
The RobPer-package
</h2><span id='topic+RobPer-package'></span>

<h3>Description</h3>

<p>Calculates periodograms based on (robustly) fitting periodic functions to light curves and other irregulary observed time series and detects high periodogram bars.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> RobPer</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-03-27</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3 </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Light curves occur in astroparticle physics and are irregularly sampled times series
<code class="reqn">(t_i, y_i)_{i=1,\ldots,n}</code>  or <code class="reqn">(t_i, y_i, s_i)_{i=1,\ldots,n}</code> consisting of unequally 
spaced observation times <code class="reqn">t_1, \ldots, t_n</code>, observed values
<code class="reqn">y_1, \ldots, y_n</code> and possibly measurement accuracies <code class="reqn">s_1, \ldots, s_n</code>.
The pattern of the observation times <code class="reqn">t_i</code> may be periodic with sampling period <code class="reqn">p_s</code>. 
The observed values <code class="reqn">y_i</code> may possibly contain a periodic fluctuation <code class="reqn">y_{f;i}</code> with 
fluctuation period <code class="reqn">p_f</code>.  One is interested in finding <code class="reqn">p_f</code>. The measurement 
accuracies <code class="reqn">s_i</code> give information about how precise the <code class="reqn">y_i</code> were measured. 
They can be interpreted as estimates for the standard deviations of the observed values.
For more details see Thieler et al. (2013) or Thieler, Fried and Rathjens (2016). 
</p>
<p>This package includes three main functions: <code>RobPer</code> calculates the periodogram, possibly taking into account measurement accuracies. With <code>betaCvMfit</code>, outlying periodogram bars (indicating a period) can be detected. This function bases on robustly fitting a distribution using Cram√©r-von-Mises (CvM) distance minimization (see also Clarke, McKinnon and Riley 2012).  The function <code>tsgen</code> can be used to generate artificial light curves. For more details about the implementation see Thieler, Fried and Rathjens (2016).
</p>
<p>A preliminary version of this package is used in Thieler et al. (2013). The <code>FastS</code>-function  
and the <code>FastTau</code>-function
presented here are slightly changed versions of R-Code published in Salibian-Barrera and Yohai (2006)
and Salibian-Barrera, Willems and Zamar (2008).
</p>
<p>The financial support of the DFG (SFB 876 &quot;Providing Information by Resource-Constrained Data Analysis&quot;, project C3, and GK 1032 &quot;Statistische Modellbildung&quot;) is gratefully acknowledged. We thank the ITMC at TU Dortmund University for providing computer resources on LiDO.
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler, Jonathan Rathjens and Roland Fried, with contributions from Brenton R. Clarke (see  <code><a href="#topic+betaCvMfit">betaCvMfit</a></code>),  Matias Salibian-Barrera, Gert Willems and Victor Yohai (see <code><a href="#topic+FastS">FastS</a></code> and <code><a href="#topic+FastTau">FastTau</a></code>) and Uwe Ligges (see <code><a href="#topic+TK95">TK95</a></code>).
</p>
<p>Maintainer: Jonathan Rathjens &lt;jonathan.rathjens@tu-dortmund.de&gt;
</p>


<h3>References</h3>

<p>Clarke, B. R., McKinnon, P. L. and Riley, G. (2012): A Fast Robust Method for Fitting Gamma Distributions. Statistical Papers, 53 (4), 1001-1014
</p>
<p>Salibian-Barrera, M. and Yohai, V. (2006): A Fast Algorithm for 
S-Regression Estimates. Journal of Computational and Graphical 
Statistics, 15 (2), 414-427 
</p>
<p>Salibian-Barrera, M., Willems, G. and Zamar, R. (2008): The Fast-tau Estimator for Regression. Journal of Computational and Graphical Statistics, 17 (3), 659-682
</p>
<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a disturbed light curve:
set.seed(22)
lightcurve &lt;- tsgen(ttype="sine",ytype="peak" , pf=7, redpart=0.1, s.outlier.fraction=0.1,
    interval=TRUE, npoints=200, ncycles=25, ps=20, SNR=3, alpha=0)

# Plotting the light curve (vertical bars show measurement accuracies)
plot(lightcurve[,1], lightcurve[,2], pch=16, cex=0.5, xlab="t", ylab="y", 
    main="a Light Curve")
rect(lightcurve[,1], lightcurve[,2]+lightcurve[,3], lightcurve[,1], 
    lightcurve[,2]-lightcurve[,3])

# The lightcurve has a period of 7:
plot(lightcurve[,1]%%7, lightcurve[,2], pch=16, cex=0.5, xlab="t", ylab="y",
    main="Phase Diagram of a Light Curve")
rect(lightcurve[,1]%%7, lightcurve[,2]+lightcurve[,3], lightcurve[,1]%%7, 
    lightcurve[,2]-lightcurve[,3])

# Calculate a periodogram of a light curve:
PP &lt;- RobPer(lightcurve, model="splines", regression="huber", weighting=FALSE, 
    var1=FALSE, periods=1:50)

# Searching for extremely high periodogram bars:
betavalues &lt;- betaCvMfit(PP)
crit.val &lt;- qbeta((0.95)^(1/50),shape1=betavalues[1], shape2=betavalues[2])

hist(PP, breaks=20, freq=FALSE, ylim=c(0,100), xlim=c(0,0.08), col=8, main ="")
betafun &lt;- function(x) dbeta(x, shape1=betavalues[1], shape2=betavalues[2])
curve(betafun, add=TRUE, lwd=2)
abline(v=crit.val, lwd=2)

# alternatives for fitting beta distributions:
# method of moments:
par.mom &lt;- betaCvMfit(PP, rob=FALSE, CvM=FALSE)
myf.mom &lt;- function(x) dbeta(x, shape1=par.mom[1], shape2=par.mom[2])
curve(myf.mom, add=TRUE, lwd=2, col="red")
crit.mom &lt;- qbeta((0.95)^(1/50),shape1=par.mom[1], shape2=par.mom[2])
abline(v=crit.mom, lwd=2, col="red")

# robust method of moments
par.rob &lt;- betaCvMfit(PP, rob=TRUE, CvM=FALSE)
myf.rob &lt;- function(x) dbeta(x, shape1=par.rob[1], shape2=par.rob[2])
curve(myf.rob, add=TRUE, lwd=2, col="blue")
crit.rob &lt;- qbeta((0.95)^(1/50),shape1=par.rob[1], shape2=par.rob[2])
abline(v=crit.rob, lwd=2, col="blue")

legend("topright", fill=c("black","red","blue"), 
    legend=c("CvM", "moments", "robust moments"), bg="white")
box()

# Detect fluctuation period:
plot(1:50, PP, xlab="Trial Period", ylab="Periodogram", type="l", 
    main="Periodogram fitting periodic splines using M-regression (Huber function)")
abline(h=crit.val, lwd=2)
text(c(7,14), PP[c(7,14)], c(7,14), adj=1, pos=4)
axis(1, at=7, labels=expression(p[f]==7))

# Comparison with non-robust periodogram
# (see package vignette, section 5.1 for further graphical analysis)
PP2 &lt;- RobPer(lightcurve, model="splines", regression="L2",
    weighting=FALSE, var1=FALSE, periods=1:50)
betavalues2 &lt;- betaCvMfit(PP2)
crit.val2   &lt;- qbeta((0.95)^(1/50),shape1=betavalues2[1], shape2=betavalues2[2])

plot(1:50, PP2, xlab="Trial Period", ylab="Periodogram", type="l", 
    main="Periodogram fitting periodic splines using L2-regression")
abline(h=crit.val2, lwd=2)
</code></pre>

<hr>
<h2 id='betaCvMfit'>
Robust fit of a Beta distribution using CvM distance minimization
</h2><span id='topic+betaCvMfit'></span>

<h3>Description</h3>

<p>Robustly fits a Beta distribution to <code>data</code> using Cram√©r-von-Mises (CvM) distance minimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betaCvMfit(data, CvM = TRUE, rob = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betaCvMfit_+3A_data">data</code></td>
<td>

<p>numeric vector: The sample, a Beta distribution is fitted to. 
</p>
</td></tr>
<tr><td><code id="betaCvMfit_+3A_cvm">CvM</code></td>
<td>

<p>logical: If <code>FALSE</code> the Cram√©r-von-Mises-distance is not minimized, but only moment estimates for the parameters of the Beta distribution are returned (see Details).
</p>
</td></tr>
<tr><td><code id="betaCvMfit_+3A_rob">rob</code></td>
<td>

<p>logical: If <code>TRUE</code>, mean and standard deviation are replaced by median and MAD when calculating moment estimates for the parameters of the Beta distribution (see Details). 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>betaCvMfit</code> fits a Beta distribution to <code>data</code> by minimizing the Cram√©r-von-Mises distance.
Moment estimates of the parameters of the Beta distribution, clipped to positive values, are used as 
starting values for the optimization process. They are calculated using
</p>
<p style="text-align: center;"><code class="reqn">\hat a=-\frac{\bar x \cdot (-\bar x + \bar x^2 + \hat s^2)}{\hat s^2},</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat b= \frac{\hat a - \hat a \bar x}{\bar x}.</code>
</p>
                                                                         
<p>These clipped moment estimates can be returned instead
of CvM-fitted parameters setting <code>CvM = FALSE</code>.
</p>
<p>The Cram√©r-von-Mises distance is defined as (see Clarke, McKinnon and Riley 2012)   
</p>
<p style="text-align: center;"><code class="reqn">\frac 1n \sum_{i=1}^n \left(F(u_{(i)}) - 
  \frac{i-0.5}{n}\right)^2+ \frac{1}{12n^2},</code>
</p>
<p> where 
<code class="reqn">u_{(1)},\ldots,u_{(n)}</code> is the ordered sample and <code class="reqn">F</code> the 
distribution function of Beta<code class="reqn">(a,b)</code>. 
</p>


<h3>Value</h3>

<p>numeric vector: Estimates for the Parameters <code class="reqn">a,b</code> of a Beta<code class="reqn">(a,b)</code> distribution with mean <code class="reqn">a/(a+b)</code>.
</p>


<h3>Note</h3>

<p>Adapted from R-Code from Brenton R. Clarke to fit a Gamma distribution (see Clarke, McKinnon and Riley 2012) using Cram√©r-von-Mises distance minimization. 
Used in Thieler et al. (2013). See also Thieler, Fried and Rathjens (2016).
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler, with contributions from Brenton R. Clarke.
</p>


<h3>References</h3>

<p>Clarke, B. R., McKinnon, P. L. and Riley, G. (2012): A Fast Robust Method for Fitting Gamma Distributions. Statistical Papers, 53 (4), 1001-1014
</p>
<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+RobPer-package">RobPer-package</a></code> for an example applying <code>betaCvMfit</code> to detect valid periods in a periodogram.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># data:
set.seed(12)
PP &lt;- c(rbeta(45, shape1=4, shape2=15), runif(5, min=0.8, max=1))
hist(PP, freq=FALSE, breaks=30, ylim=c(0,7), xlab="Periodogram bar")

# true parameters:
myf.true &lt;- function(x) dbeta(x, shape1=4, shape2=15)
curve(myf.true, add=TRUE, lwd=2)

# method of moments:
par.mom &lt;- betaCvMfit(PP, rob=FALSE, CvM=FALSE)
myf.mom &lt;- function(x) dbeta(x, shape1=par.mom[1], shape2=par.mom[2])
curve(myf.mom, add=TRUE, lwd=2, col="red")

# robust method of moments
par.rob &lt;- betaCvMfit(PP, rob=TRUE, CvM=FALSE)
myf.rob &lt;- function(x) dbeta(x, shape1=par.rob[1], shape2=par.rob[2])
curve(myf.rob, add=TRUE, lwd=2, col="blue")

# CvM distance minimization
par.CvM &lt;- betaCvMfit(PP, rob=TRUE, CvM=TRUE)
myf.CvM &lt;- function(x) dbeta(x, shape1=par.CvM[1], shape2=par.CvM[2])
curve(myf.CvM, add=TRUE, lwd=2, col="green")

# Searching for outliers...
abline(v=qbeta((0.95)^(1/50), shape1=par.CvM[1], shape2=par.CvM[2]), col="green")

legend("topright", fill=c("black", "green","blue", "red"),
    legend=c("true", "CvM", "robust moments", "moments"))
box()
</code></pre>

<hr>
<h2 id='disturber'>
Disturbing light curve data
</h2><span id='topic+disturber'></span>

<h3>Description</h3>

<p>Disturbes a light curve replacing measurement accuracies by outliers and/or observed values by atypical values.
See <code><a href="#topic+RobPer-package">RobPer-package</a></code> for more information about light curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disturber(tt, y, s, ps, s.outlier.fraction = 0, interval)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="disturber_+3A_tt">tt</code></td>
<td>

<p>numeric vector: Observation times <code class="reqn">t_1,\ldots,t_n</code> (see Details).
</p>
</td></tr>
<tr><td><code id="disturber_+3A_y">y</code></td>
<td>

<p>numeric vector: Observed values <code class="reqn">y_1,\ldots,y_n</code> (see Details).
</p>
</td></tr>
<tr><td><code id="disturber_+3A_s">s</code></td>
<td>

<p>numeric vector: Measurement accuracies <code class="reqn">s_1,\ldots,s_n</code> (see Details).
</p>
</td></tr>
<tr><td><code id="disturber_+3A_ps">ps</code></td>
<td>

<p>positive value: Sampling period <code class="reqn">p_s</code> indirectly defines the length of the time interval, in which observed values <code class="reqn">y_i</code> are replaced by atypical values (see Details).
</p>
</td></tr>
<tr><td><code id="disturber_+3A_s.outlier.fraction">s.outlier.fraction</code></td>
<td>

<p>numeric value in [0,1]: Defines the proportion of measurement accuracies that is replaced by outliers (see Details). A value of 0 means that no measurement accuracy is replaced by an outlier.
</p>
</td></tr>
<tr><td><code id="disturber_+3A_interval">interval</code></td>
<td>

<p>logical: If <code>TRUE</code>, the observed values belonging to a random time interval of length 3<code class="reqn">p_s</code> are replaced by atypical values (see Details). If <code>TRUE</code> and the light curve is shorter than <code class="reqn">3p_s</code>, the function will stop with an error message. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function disturbes the light curve <code class="reqn">(t_i,y_i,s_i)_{i=1,\ldots,n}</code> given. It randomly chooses a proportion of <code>s.outlier.fraction</code> measurement accuracies <code class="reqn">s_i</code> and replaces them by <code class="reqn">0.5\min(s_1,\ldots,s_n)</code>. In case of <code>interval=TRUE</code> a time interval <code class="reqn">[t_{start},t_{start}+3p_s]</code> within the intervall 
<code class="reqn">[t_1,t_n]</code> is randomly chosen and all observed values belonging to this time interval are replaced by a peak function:
</p>
<p style="text-align: center;"><code class="reqn">y_i^{changed} = 6 \ \tilde y_{0.9}\  \frac{d_{\mathcal N(t_{start}+1.5p_s, p_s^2)}(t_i) }{ d_{\mathcal N(0,p_s^2)}(0)} \quad \forall \ i \ : \ t_i\in[t_{start}, t_{start}+3p_s],</code>
</p>
 
<p>where <code class="reqn">d_{\mathcal N(a,b^2)}(x)</code> denotes the density of a normal distribution with mean <code class="reqn">a</code> and variance <code class="reqn">b^2</code> at <code class="reqn">x</code>.
</p>
<p>In case of <code>s.outlier.fraction=0</code> and <code>interval=FALSE</code>, <code>y</code> and <code>s</code> are returned unchanged.
</p>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>numeric vector: New <code class="reqn">y_i</code>-values, partly different from the old ones if <code>interval=TRUE</code> (see Details).</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>numeric vector: New <code class="reqn">s_i</code>-values, partly different from the old ones if <code>s.outlier.fraction&gt;0</code> (see Details).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>A former version of this function is used in Thieler et al. (2013). See also Thieler, Fried and Rathjens (2016).
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler
</p>


<h3>References</h3>

<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>Applied in <code><a href="#topic+tsgen">tsgen</a></code> (see there for example).
</p>

<hr>
<h2 id='FastS'>
S-Regression using the Fast-S-Algorithm
</h2><span id='topic+FastS'></span>

<h3>Description</h3>

<p>Performs S-Regression using the Fast-S-Algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FastS(x, y, Scontrol=list(int = FALSE, N = 100, kk = 2, tt = 5, b= .5,
 cc = 1.547, seed=NULL), beta_gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FastS_+3A_x">x</code></td>
<td>

<p>numeric <code class="reqn">(n\times p)</code>-matrix: Designmatrix.
</p>
</td></tr>
<tr><td><code id="FastS_+3A_y">y</code></td>
<td>

<p>numeric vector: <code class="reqn">n</code> observations.
</p>
</td></tr>
<tr><td><code id="FastS_+3A_scontrol">Scontrol</code></td>
<td>

<p>list of length seven: control parameters (see Details).
</p>
</td></tr>
<tr><td><code id="FastS_+3A_beta_gamma">beta_gamma</code></td>
<td>

<p>numeric vector: Specifies one parameter candidate of length 
<code class="reqn">p</code> (see Details). </p>
</td></tr> </table>


<h3>Details</h3>

<p> The Fast-S-Algorithm to 
efficiently perform S-Regression was published by 
Salibian-Barrera and Yohai (2006). It bases on starting with a set 
of <code>N</code> parameter candidates, locally optimizing them, but 
only with <code>kk</code> iterations, optimizing the <code>tt</code> 
best candidates to convergence and then choosing the best 
parameter candidate. The rho-function used is the biweight 
function with tuning parameter <code>cc</code>, the value <code>b</code> is 
set to the expected value of the rho-function applied to the 
residuals. The default <code>cc=1.547</code> and <code>b=.5</code> is 
chosen following Rousseeuw and Yohai (1984) to obtain an 
approximative breakdown point of 0.5. When setting <code>int</code> to <code>TRUE</code>,
this adds an intercept column to the design matrix. For more details see 
Salibian-Barrera and Yohai (2006) or Thieler, Fried and Rathjens (2016). 
</p>
<p>The R-function <code>FastS</code> used in <code>RobPer</code> is a slightly 
changed version of the R-code published in Salibian-Barrera and Yohai (2006). It was changed in order to work more efficiently, 
especially when fitting step functions, and to specify one 
parameter candidate in advance. For details see Thieler, Fried and Rathjens (2016). </p>


<h3>Value</h3>

 <table>
<tr><td><code>beta</code></td>
<td>
<p>numeric vector: Fitted parameter vector.</p>
</td></tr> 
<tr><td><code>scale</code></td>
<td>
<p>numeric: Value of the objective function</p>
</td></tr> </table>


<h3>Author(s)</h3>

<p> Matias Salibian-Barrera and Victor Yohai, modified by 
Anita M. Thieler </p>


<h3>References</h3>

 
<p>Rousseeuw, P. J. and Yohai, V. J. (1984): Robust Regression by 
Means of S-estimators. In Franke, J., H√§rdle, W. und Martin, D. 
(eds.): Robust and Nonlinear Time Series Analysis. Berlin New 
York: Springer, Lecture Notes in Statistics No. 26, 256-272 
</p>
<p>Salibian-Barrera, M. and Yohai, V. (2006): A Fast Algorithm for 
S-Regression Estimates. Journal of Computational and Graphical 
Statistics, 15 (2), 414-427 
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>Applied in <code><a href="#topic+RobPer">RobPer</a></code>. See <code><a href="#topic+FastTau">FastTau</a></code> for example.
</p>

<hr>
<h2 id='FastTau'>
Tau-Regression using the Fast-tau-Algorithm
</h2><span id='topic+FastTau'></span>

<h3>Description</h3>

<p>Performs tau-Regression using the Fast-tau-Algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FastTau(x, y, taucontrol = list(N = 500, kk = 2, tt = 5, rr = 2, approximate = 0),
 beta_gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FastTau_+3A_x">x</code></td>
<td>

<p>numeric <code class="reqn">(n\times p)</code>-matrix: Designmatrix.
</p>
</td></tr>
<tr><td><code id="FastTau_+3A_y">y</code></td>
<td>

<p>numeric vector: <code class="reqn">n</code> observations.
</p>
</td></tr>
<tr><td><code id="FastTau_+3A_taucontrol">taucontrol</code></td>
<td>

<p>list of four integer and one logical value: Control parameters (see Details).
</p>
</td></tr>
<tr><td><code id="FastTau_+3A_beta_gamma">beta_gamma</code></td>
<td>

<p>numeric vector: Specifies one parameter candidate of length <code class="reqn">p</code> (see Details).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Fast-tau-Algorithm to efficiently perform tau-Regression was published by Salibian-Barrera, Willems and Zamar (2008).
It bases on starting with a set of <code>N</code> parameter candidates,
locally optimizing them using <code>kk</code> iterations, 
then optimizing the <code>tt</code> best candidates to convergence and finally choosing the best parameter candidate. Since calculation of the objective value is computationally expensive, it is possible to approximate it with <code>rr</code> iteration steps when choosing <code>approximate=TRUE</code>. For more details see Salibian-Barrera, Willems and Zamar (2008).
</p>
<p>The R-function <code>FastTau</code> used in <code>RobPer</code> is a slightly changed version of the R-code published in Salibian-Barrera, Willems and Zamar (2008). It was changed in order to work more efficiently, especially when fitting step functions, and to specify one parameter candidate in advance. For details see Thieler, Fried and Rathjens (2016).
</p>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p>numeric vector: Fitted parameter vector.</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>numeric: Value of the objective function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matias Salibian-Barrera and Gert Willems, modified by Anita M. Thieler
</p>


<h3>References</h3>

<p>Salibian-Barrera, M., Willems, G. and Zamar, R. (2008): The Fast-tau Estimator for Regression. Journal of Computational and Graphical Statistics, 17 (3), 659-682
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>Applied in <code><a href="#topic+RobPer">RobPer</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(22)
# Generate a disturbed light curve
lightcurve &lt;- tsgen(ttype="unif",ytype="sine" , pf=7, redpart=0.1, interval=TRUE,
    npoints=100, ncycles=10, ps=7, SNR=4, alpha=0)
tt &lt;- lightcurve[,1]
y  &lt;- lightcurve[,2]
s  &lt;- rep(1,100)  # unweighted regression

plot(tt, y, type="l", main="Fitting a sine to a disturbed lightcurve")

# Fit the true model (a sine of period 7)... designmatrix:
X &lt;- Xgen(tt, n=100, s, pp=7, design="sine")
# Robust tau-fit:
beta_FastTau &lt;- FastTau(X, y)$beta
# Robust S-fit:
beta_FastS &lt;- FastS(X, y)$beta
# Least squares fit:
beta_lm &lt;- lm(y~0+X)$coeff

# Plot:
sin7_fun &lt;- function(t, beta) beta[1]+ beta[2]*sin(t*2*pi/7)+ beta[3]*cos(t*2*pi/7)
sin_FastTau &lt;- function(t) sin7_fun(t, beta_FastTau)
sin_FastS &lt;- function(t) sin7_fun(t, beta_FastS)
sin_lm &lt;- function(t) sin7_fun(t, beta_lm)
curve(sin_FastTau, col="green", add=TRUE)
curve(sin_FastS, col="blue", add=TRUE, lty=2)
curve(sin_lm, col="red", add=TRUE)

legend("topleft", fill=c("black", "red", "green", "blue"),
    legend=c("Light Curve (disturbed)", "Least Squares Fit", "FastTau Fit", "FastS Fit"))
</code></pre>

<hr>
<h2 id='lc_noise'>
Noise and measurement accuracy generator for light curves
</h2><span id='topic+lc_noise'></span>

<h3>Description</h3>

<p>Generates measurement accuracies, a white noise component depending on them and a second (possibly power law, i.e. red) noise component which does not depend on the measurement accuracies.
For more details see <code><a href="#topic+tsgen">tsgen</a></code> or Thieler, Fried and Rathjens (2016). 
See <code><a href="#topic+RobPer-package">RobPer-package</a></code> for more information about light curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lc_noise(tt, sig, SNR, redpart, alpha = 1.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lc_noise_+3A_tt">tt</code></td>
<td>

<p>numeric vector: Observation times given.
</p>
</td></tr>
<tr><td><code id="lc_noise_+3A_sig">sig</code></td>
<td>

<p>numeric vector of same length as <code>tt</code>: A given signal to which the noise will be added.
</p>
</td></tr>
<tr><td><code id="lc_noise_+3A_snr">SNR</code></td>
<td>

<p>positive number: Defines the relation between signal and noise (see <code><a href="#topic+tsgen">tsgen</a></code> for Details).
</p>
</td></tr>
<tr><td><code id="lc_noise_+3A_redpart">redpart</code></td>
<td>

<p>numeric value in [0,1]: Proportion of the power law noise in noise components (see <code><a href="#topic+tsgen">tsgen</a></code> for Details).
</p>
</td></tr>
<tr><td><code id="lc_noise_+3A_alpha">alpha</code></td>
<td>

<p>numeric value: Power law index for the power law noise component (see <code><a href="#topic+tsgen">tsgen</a></code> for Details).
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>numeric vector: Observed values: signal + noise.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>numeric vector: Measurement accuracies related to the white noise component.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>A former version of this function is used in Thieler et al. (2013).
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler and Jonathan Rathjens
</p>


<h3>References</h3>

<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>Applied in <code><a href="#topic+tsgen">tsgen</a></code> (see there for an example), applies <code><a href="#topic+TK95_uneq">TK95_uneq</a></code>.
</p>

<hr>
<h2 id='Mrk421'>Data: Light curve from Mrk 421</h2><span id='topic+Mrk421'></span>

<h3>Description</h3>

<p>Gamma ray light curve from Markarian 421.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Mrk421</code></pre>


<h3>Format</h3>

<p>A data frame of three variables, with a time series of length 655 appropriate to <code><a href="#topic+RobPer">RobPer</a></code>.</p>


<h3>Details</h3>

<p>The data in Mrk421 and Mrk501 have been collected from various original sources, combined, and published by Tluczykont et al. (2010) of the Deutsches Elektronen-Synchrotron.
</p>
<p>Their sources are data from the experiments:
</p>
<p>Whipple (Kerrick et al. 1995; Schubnell et al. 1996; Buckley et al. 1996; Maraschi et al. 1999)
</p>
<p>HEGRA (Aharonian et al. 1999a, 1999b; Krawczynski et al. 2001; Aharonian et al. 2001, 2002, 2003, 2004; Kestel 2003)
</p>
<p>CAT (Piron 2000; Piron et al. 2001)
</p>
<p>HESS (Aharonian et al. 2005, 2006)
</p>
<p>MAGIC (Albert et al. 2008; Donnarumma et al. 2009)
</p>
<p>VERITAS (Rebillot et al. 2006; Donnarumma et al. 2009)
</p>


<h3>Note</h3>

<p>See Vignette Section 5.3 for example.</p>


<h3>Source</h3>

<p>Data kindly provided by the Deutsches Elektronen-Synchrotron, Gamma Astronomy group (see Details).</p>


<h3>References</h3>

<p>Tluczykont, M., Bernardini, E., Satalecka, K., Clavero, R., Shayduk, M. and Kalekin, O. (2010): Long-term lightcurves from combined united very high energy gamma-ray data. Astronomy &amp; Astrophysics, 524, A48
</p>
<p>Their data sources:
</p>
<p>Aharonian, F., Akhperjanian, A., Barrio, J., et al. (1999a): The temporal characteristics of the TeV gamma-radiation from Mkn 501 in 1997: I. Data from the stereoscopic imaging atmospheric Cherenkov telescope system of HEGRA. Astronomy &amp; Astrophysics, 342(1), 69
</p>
<p>Aharonian, F., Akhperjanian, A., Barrio, J., et al. (1999b): The temporal characteristics of the TeV gamma-emission from Mkn 501 in 1997: II. Results from HEGRA CT1 and CT2. Astronomy &amp; Astrophysics, 349(1), 29
</p>
<p>Aharonian, F., Akhperjanian, A., Barrio, J., et al. (2001): The TeV Energy Spectrum of Markarian 501 Measured with the Stereoscopic Telescope System of HEGRA during 1998 and 1999. The Astrophysical Journal, 546(2), 898
</p>
<p>Aharonian, F., Akhperjanian, A., Beilicke, M., et al. (2002): Variations of the TeV energy spectrum at different flux levels of Mkn 421 observed with the HEGRA system of Cherenkov telescopes. Astronomy &amp; Astrophysics, 393(1), 89
</p>
<p>Aharonian, F., Akhperjanian, A., Beilicke, M., et al. (2003): TeV gamma-ray light curve and energy spectrum of Mkn 421 during its 2001 flare as measured with HEGRA CT1. Astronomy &amp; Astrophysics, 410(3), 813
</p>
<p>Aharonian, F., Akhperjanian, A., Beilicke, M., et al. (2004): The Crab Nebula and Pulsar between 500 GeV and 80 TeV: Observations with the HEGRA Stereoscopic Air Cerenkov Telescopes. The Astrophysical Journal, 614(2), 897
</p>
<p>Aharonian, F., Akhperjanian, A., Aye, K., et al. (2005): Observations of Mkn 421 in 2004 with HESS at large zenith angles. Astronomy &amp; Astrophysics, 437(1), 95
</p>
<p>Aharonian, F., Akhperjanian, A., Bazer-Bachi, A. R., et al. (2006): Observations of the Crab nebula with HESS. Astronomy &amp; Astrophysics, 457(3), 899
</p>
<p>Albert, J., Aliu, E., Anderhub, H., et al. (2008): VHE gamma-Ray Observation of the Crab Nebula and its Pulsar with the MAGIC Telescope. The Astrophysical Journal, 674(2), 1037
</p>
<p>Buckley, J. H., Akerlof, C. W., Biller, S., et al. (1996): Gamma-Ray Variability of the BL Lacertae Object Markarian 421. The Astrophysical Journal, 472, L9
</p>
<p>Donnarumma, I., Vittorini, V., Vercellone, S., et al. (2009): The June 2008 Flare of Markarian 421 from Optical to TeV Energies. The Astrophysical Journal, 691, L13
</p>
<p>Kerrick, A. D., Akerlof, C. W., Biller, S. D., et al. (1995): Outburst of TeV photons from Markarian 421. The Astrophysical Journal, 438, L59
</p>
<p>Kestel, M. (2003): TeV gamma-Flux and Spectrum of Markarian 421 in 1999/2000 with Hegra CT1 using refined Analysis Methods. Ph.D. Thesis, Technische Universit\&quot;at M\&quot;unchen
</p>
<p>Krawczynski, H., Sambruna, R., Kohnle, A., et al. (2001): Simultaneous X-Ray and TeV Gamma-Ray Observation of the TeV Blazar Markarian 421 during 2000 February and May. The Astrophysical Journal, 559(1), 187
</p>
<p>Maraschi, L., Fossati, G., Tavecchio, F., et al. (1999): Simultaneous X-Ray and TeV Observations of a Rapid Flare from Markarian 421. The Astrophysical Journal, 526, L81
</p>
<p>Piron, F. (2000): \'Etude des propri\'et\'es spectrales et de la variabilit\'e de l'\'emission Gamma sup\'erieure \'e 250 GeV des blazars observ\'es entre Octobre 1996 et F\'evrier 2000 par le t\'elescope \'e effet Tcherenkov athmosph\'erique C.A.T. Ph.D. Thesis, Universit\'e de Paris-Sud
</p>
<p>Piron, F., Djannati-Atai, A., Punch, M., et al. (2001): Temporal and spectral gamma-ray properties of Mkn 421 above 250 GeV from CAT observations between 1996 and 2000. Astronomy &amp; Astrophysics, 374(3), 895
</p>
<p>Rebillot, P. F., Badran, H. M., Blaylock, G., et al. (2006): Multiwavelength Observations of the Blazar Markarian 421 in 2002 December and 2003 January. The Astrophysical Journal, 641(2), 740
</p>
<p>Schubnell, M. S., Akerlof, C. W., Biller, S., et al. (1996): Very High Energy Gamma-Ray Emission from the Blazar Markarian 421. The Astrophysical Journal, 460, 644
</p>

<hr>
<h2 id='Mrk501'>Data: Light curve from Mrk 501</h2><span id='topic+Mrk501'></span>

<h3>Description</h3>

<p>Gamma ray light curve from Markarian 501.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Mrk501</code></pre>


<h3>Format</h3>

<p>A data frame of three variables, with a time series of length 210 appropriate to <code><a href="#topic+RobPer">RobPer</a></code>.</p>


<h3>Details</h3>

<p>The data in Mrk421 and Mrk501 have been collected from various original sources, combined, and published by Tluczykont et al. (2010) of the Deutsches Elektronen-Synchrotron.
</p>
<p>Their sources are data from the experiments:
</p>
<p>Whipple (Kerrick et al. 1995; Schubnell et al. 1996; Buckley et al. 1996; Maraschi et al. 1999)
</p>
<p>HEGRA (Aharonian et al. 1999a, 1999b; Krawczynski et al. 2001; Aharonian et al. 2001, 2002, 2003, 2004; Kestel 2003)
</p>
<p>CAT (Piron 2000; Piron et al. 2001)
</p>
<p>HESS (Aharonian et al. 2005, 2006)
</p>
<p>MAGIC (Albert et al. 2008; Donnarumma et al. 2009)
</p>
<p>VERITAS (Rebillot et al. 2006; Donnarumma et al. 2009)
</p>


<h3>Note</h3>

<p>See Vignette Section 5.3 for example.</p>


<h3>Source</h3>

<p>Data kindly provided by the Deutsches Elektronen-Synchrotron, Gamma Astronomy group (see Details).</p>


<h3>References</h3>

<p>Tluczykont, M., Bernardini, E., Satalecka, K., Clavero, R., Shayduk, M. and Kalekin, O. (2010): Long-term lightcurves from combined united very high energy gamma-ray data. Astronomy &amp; Astrophysics, 524, A48
</p>
<p>Their data sources:
</p>
<p>Aharonian, F., Akhperjanian, A., Barrio, J., et al. (1999a): The temporal characteristics of the TeV gamma-radiation from Mkn 501 in 1997: I. Data from the stereoscopic imaging atmospheric Cherenkov telescope system of HEGRA. Astronomy &amp; Astrophysics, 342(1), 69
</p>
<p>Aharonian, F., Akhperjanian, A., Barrio, J., et al. (1999b): The temporal characteristics of the TeV gamma-emission from Mkn 501 in 1997: II. Results from HEGRA CT1 and CT2. Astronomy &amp; Astrophysics, 349(1), 29
</p>
<p>Aharonian, F., Akhperjanian, A., Barrio, J., et al. (2001): The TeV Energy Spectrum of Markarian 501 Measured with the Stereoscopic Telescope System of HEGRA during 1998 and 1999. The Astrophysical Journal, 546(2), 898
</p>
<p>Aharonian, F., Akhperjanian, A., Beilicke, M., et al. (2002): Variations of the TeV energy spectrum at different flux levels of Mkn 421 observed with the HEGRA system of Cherenkov telescopes. Astronomy &amp; Astrophysics, 393(1), 89
</p>
<p>Aharonian, F., Akhperjanian, A., Beilicke, M., et al. (2003): TeV gamma-ray light curve and energy spectrum of Mkn 421 during its 2001 flare as measured with HEGRA CT1. Astronomy &amp; Astrophysics, 410(3), 813
</p>
<p>Aharonian, F., Akhperjanian, A., Beilicke, M., et al. (2004): The Crab Nebula and Pulsar between 500 GeV and 80 TeV: Observations with the HEGRA Stereoscopic Air Cerenkov Telescopes. The Astrophysical Journal, 614(2), 897
</p>
<p>Aharonian, F., Akhperjanian, A., Aye, K., et al. (2005): Observations of Mkn 421 in 2004 with HESS at large zenith angles. Astronomy &amp; Astrophysics, 437(1), 95
</p>
<p>Aharonian, F., Akhperjanian, A., Bazer-Bachi, A. R., et al. (2006): Observations of the Crab nebula with HESS. Astronomy &amp; Astrophysics, 457(3), 899
</p>
<p>Albert, J., Aliu, E., Anderhub, H., et al. (2008): VHE gamma-Ray Observation of the Crab Nebula and its Pulsar with the MAGIC Telescope. The Astrophysical Journal, 674(2), 1037
</p>
<p>Buckley, J. H., Akerlof, C. W., Biller, S., et al. (1996): Gamma-Ray Variability of the BL Lacertae Object Markarian 421. The Astrophysical Journal, 472, L9
</p>
<p>Donnarumma, I., Vittorini, V., Vercellone, S., et al. (2009): The June 2008 Flare of Markarian 421 from Optical to TeV Energies. The Astrophysical Journal, 691, L13
</p>
<p>Kerrick, A. D., Akerlof, C. W., Biller, S. D., et al. (1995): Outburst of TeV photons from Markarian 421. The Astrophysical Journal, 438, L59
</p>
<p>Kestel, M. (2003): TeV gamma-Flux and Spectrum of Markarian 421 in 1999/2000 with Hegra CT1 using refined Analysis Methods. Ph.D. Thesis, Technische Universit\&quot;at M\&quot;unchen
</p>
<p>Krawczynski, H., Sambruna, R., Kohnle, A., et al. (2001): Simultaneous X-Ray and TeV Gamma-Ray Observation of the TeV Blazar Markarian 421 during 2000 February and May. The Astrophysical Journal, 559(1), 187
</p>
<p>Maraschi, L., Fossati, G., Tavecchio, F., et al. (1999): Simultaneous X-Ray and TeV Observations of a Rapid Flare from Markarian 421. The Astrophysical Journal, 526, L81
</p>
<p>Piron, F. (2000): \'Etude des propri\'et\'es spectrales et de la variabilit\'e de l'\'emission Gamma sup\'erieure \'e 250 GeV des blazars observ\'es entre Octobre 1996 et F\'evrier 2000 par le t\'elescope \'e effet Tcherenkov athmosph\'erique C.A.T. Ph.D. Thesis, Universit\'e de Paris-Sud
</p>
<p>Piron, F., Djannati-Atai, A., Punch, M., et al. (2001): Temporal and spectral gamma-ray properties of Mkn 421 above 250 GeV from CAT observations between 1996 and 2000. Astronomy &amp; Astrophysics, 374(3), 895
</p>
<p>Rebillot, P. F., Badran, H. M., Blaylock, G., et al. (2006): Multiwavelength Observations of the Blazar Markarian 421 in 2002 December and 2003 January. The Astrophysical Journal, 641(2), 740
</p>
<p>Schubnell, M. S., Akerlof, C. W., Biller, S., et al. (1996): Very High Energy Gamma-Ray Emission from the Blazar Markarian 421. The Astrophysical Journal, 460, 644
</p>

<hr>
<h2 id='RobPer'>
Periodogram based on (robustly) fitting a periodic function to a light curve
</h2><span id='topic+RobPer'></span>

<h3>Description</h3>

<p>Calculates a periodogram by fitting a periodic function to a light curve, using a possibly robust regression technique and possibly taking into account measurement accuracies.  
See <code><a href="#topic+RobPer-package">RobPer-package</a></code> for more information about light curves. For a lot of more details see Thieler, Fried and Rathjens (2016) and Thieler et al. (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RobPer(ts, weighting, periods, regression, model, steps = 10, tol = 1e-03,
 var1 = weighting, genoudcontrol = list(pop.size = 50, max.generations = 50,
 wait.generations = 5), LTSopt =TRUE, 
 taucontrol = list(N = 100, kk = 2, tt = 5, rr = 2, approximate = FALSE),
 Scontrol=list(N = ifelse(weighting,200,50), kk = 2, tt = 5, b=.5, cc = 1.547,
 seed = NULL) )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RobPer_+3A_ts">ts</code></td>
<td>

<p>dataframe or matrix with three (or two) numeric columns containing the light curve to be analyzed: 
observation times (first column), observed values (second column), measurement accuracies (thirs column). 
If it is intended to calculate the periodogram of a time series without measurement accuracies (<code>weighting=FALSE</code>), 
the third column may be omitted.
</p>
</td></tr>
<tr><td><code id="RobPer_+3A_weighting">weighting</code></td>
<td>

<p>logical: Should measurement accuracies be taken into account performing weighted regression?
</p>
</td></tr>
<tr><td><code id="RobPer_+3A_periods">periods</code></td>
<td>

<p>vector of positive numeric values: Trial periods.
</p>
</td></tr>
<tr><td><code id="RobPer_+3A_regression">regression</code></td>
<td>

<p>character string specifying the regression method used: Possible choices are
<code>"L2"</code> (least squares regression using the R-function <code>lm</code>, package <code>stats</code>), 
<code>"L1"</code> (least absolute deviation regression, using the R-function <code>rq</code>, package <code>quantreg</code>),
<code>"LTS"</code> (least trimmed squares regression, using the R-function <code>ltsReg</code>, package <code>robustbase</code>),
<code>"huber"</code> (M-regression using the Huber function),
<code>"bisquare"</code> (M-regression using the bisquare function),
<code>"S"</code> (S-regression using adapted code from Salibian-Barrera and Yohai 2006, see <code><a href="#topic+FastS">FastS</a></code>),
<code>"tau"</code> (tau-regression using adapted code from Salibian-Barrera, Willems and Zamar 2008, see <code><a href="#topic+FastTau">FastTau</a></code>).
</p>
</td></tr>
<tr><td><code id="RobPer_+3A_model">model</code></td>
<td>

<p>character string specifying the periodic function fitted to the light curve: Possible choices are
<code>"step"</code> (periodic step function),
<code>"2step"</code> (two overlapping periodic step functions, see Details),
<code>"sine"</code>  (sine function),
<code>"fourier(2)"</code> and <code>"fourier(3)"</code> (Fourier series of second or third degree),
<code>"splines"</code> (periodic spline function with four B-splines per cycle, generated using <code>spline.des</code>, package <code>splines</code>).
</p>
</td></tr>
<tr><td><code id="RobPer_+3A_steps">steps</code></td>
<td>

<p>integer value: Number of steps per cycle for the periodic step function(s).
</p>
</td></tr>
<tr><td><code id="RobPer_+3A_tol">tol</code></td>
<td>

<p>(small) positive number: Precision for convergence criteria. Used in case of <code>regression="huber"</code> or <code>"bisquare"</code> or if <code>regression="LTS"</code> and <code>LTSopt=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="RobPer_+3A_var1">var1</code></td>
<td>

<p>logical: Should variance estimate be set to 1 in case of weighted M-regression?
</p>
</td></tr>
<tr><td><code id="RobPer_+3A_genoudcontrol">genoudcontrol</code></td>
<td>

<p>list of three integers <code>pop.size</code>, <code>max.generations</code>, <code>wait.generations</code>: Control parameters for the R-function <code>genoud</code>, package <code>rgenoud</code>, see Details and Mebane Jr. and Sekhon (2011). Used in case of <code>regression="bisquare"</code> or if <code>regression="LTS"</code> and <code>LTSopt=TRUE</code>.
</p>
</td></tr>
<tr><td><code id="RobPer_+3A_ltsopt">LTSopt</code></td>
<td>

<p>logical: In case of LTS-regression, should regression result of <code>ltsReg</code> be optimized using the R-function <code>genoud</code>, package <code>rgenoud</code>?
</p>
</td></tr>
<tr><td><code id="RobPer_+3A_taucontrol">taucontrol</code></td>
<td>

<p>list of four integer values <code>N</code>, <code>kk</code>, <code>tt</code>, <code>rr</code> and one logical <code>approximate</code>: Control parameters for the R-function <code>FastTau</code>. For more details see <code><a href="#topic+FastTau">FastTau</a></code> and Salibian-Barrera, Willems and Zamar (2008).
</p>
</td></tr>
<tr><td><code id="RobPer_+3A_scontrol">Scontrol</code></td>
<td>

<p>list of three integers <code>N</code>, <code>kk</code> and <code>tt</code>, two positive numbers <code>b</code> and <code>cc</code> and another integer <code>seed</code>: Control parameters for the R-function <code>FastS</code>. For more details see <code><a href="#topic+FastS">FastS</a></code> and Salibian-Barrera and Yohai (2006). Please notice that the further Scontrol entry <code>int</code> expected by <code>FastS</code> is automatically set to <code>FALSE</code> in order to let <code>RobPer</code> work properly.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>For each trial period, a periodic function (defined by <code>model</code>) is fitted to the light curve using regression technique <code>regression</code>. The periodogram bar is the coefficient of determination. In case of <code>model="2step"</code>, two different step functions with opposed jumping times are fitted separately and the periodogram bar is the mean of both coefficients of determination. For a lot of more details see Thieler, Fried and Rathjens (2016) and Thieler et al. (2013).
</p>


<h3>Value</h3>

<p>numeric vector: Periodogram bars related to the trial periods.
</p>


<h3>Note</h3>

<p>Performing <code>weighting = FALSE</code>, <code>regression="L2"</code>, <code>model="sine"</code> on a equidistantly sampled time series is equivalent to calculating the standard periodogram of Fourier analysis, see Example.
</p>
<p>Performing <code>regression="L2"</code>, <code>model="sine"</code> is equivalent to calculating a Generalized Lomb-Scargle periodogram (see Zechmeister and K√ºrster 2009).
</p>
<p>Performing <code>regression="L2"</code>, <code>model="step"</code> is equivalent to calculating an Epoch Folding (Leahy et al. 1983) or Anaysis of Variance (Schwarzenberg-Czerny 1989) periodogram.
</p>
<p>Performing <code>regression="L2"</code>, <code>model="2step"</code> is equivalent to calculating a Phase Dispersion Minimization periodogram (Stellingwerf 1978).
</p>
<p>A former version of this function is used in Thieler et al. (2013). For more equivalences see there. 
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler, Jonathan Rathjens and Roland Fried
</p>


<h3>References</h3>

<p>Leahy, D. A., Darbro, W., Elsner, R. F., Weisskopf, M. C., Kahn, S., Sutherland, P. G. and Grindlay, J. E. (1983): On Searches for Pulsed Emission with Application to Four Globular Cluster X-ray Sources-NGC 1851, 6441, 6624, and 6712. The Astrophysical Journal, 266 (1), 160-170
</p>
<p>Mebane Jr., W. R. and Sekhon, J. S. (2011): Genetic Optimization Using Derivatives: The rgenoud Package for R. Journal of Statistical Software, 42 (11), 1-26
</p>
<p>Salibian-Barrera, M. and Yohai, V. (2006): A Fast Algorithm for S-Regression Estimates. Journal of Computational and Graphical Statistics, 15 (2), 414-427 
</p>
<p>Salibian-Barrera, M., Willems, G. and Zamar, R. (2008): The Fast-tau Estimator for Regression. Journal of Computational and Graphical Statistics, 17 (3), 659-682
</p>
<p>Stellingwerf, R. F. (1978): Period Determination Using Phase Dispersion Minimization. The Astrophysical Journal, 224, 953-960
</p>
<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>
<p>Zechmeister, M. and K√ºrster, M. (2009): The Generalised Lomb-Scargle Periodogram. A New Formalism for the Floating-Mean and Keplerian Periodograms. Astronomy and Astrophysics, 496 (2), 577-584
</p>


<h3>See Also</h3>

<p>Applies <code><a href="#topic+FastS">FastS</a></code> and <code><a href="#topic+FastTau">FastTau</a></code>, <code><a href="#topic+Xgen">Xgen</a></code>, examples in <code><a href="#topic+RobPer-package">RobPer-package</a></code> and <code><a href="#topic+TK95_uneq">TK95_uneq</a></code>. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For more examples see RobPer-package and TK95_uneq!

# Example to show the equivalence between the periodogram from Fourier analysis
# and the Lomb-Scargle periodogram in case of equidistant sampling and equal weighting:
set.seed(7)
n &lt;- 120
# equidistant time series:
zr &lt;- tsgen(ttype="equi", ytype="const", pf=1, redpart= 0, s.outlier.fraction=0.2, 
    interval=FALSE, npoints=n, ncycles=n, ps=1, SNR=1, alpha=1.5)
# periodogram of Fourier analysis
PP_konv &lt;- spec.pgram(zr[,2], taper = 0,pad = 0, fast = FALSE, demean = TRUE,
    detrend = TRUE, plot = TRUE)
# Lomb-Scargle periodogram - Note: Due to the regression ansatz,
# RobPer is not able to compute period 2 in this case.
PP_new &lt;- RobPer(ts=zr, weighting=FALSE, periods=1/PP_konv$freq,
    regression="L2", model="sine")
plot(PP_konv$freq, PP_konv$spec, ylab="periodogram", xlab="frequency",
    main="Comparison of RobPer(...regression='LS', model='sine') and spec.pgram")
points(PP_konv$freq, PP_new*var(zr[,2])*n/2, type="l")
legend("top",lty=c(1,0), pch=c(-5,1), legend=c("RobPer*var(y)*n/2", "spec.pgram"))
# Due to different ways of computation, the scaled periodograms are not exactly
# identical, but show very similar behavior.
</code></pre>

<hr>
<h2 id='sampler'>
Generator for irregularly sampled observation times 
</h2><span id='topic+sampler'></span>

<h3>Description</h3>

<p>Generates irregularly sampled observation times with a periodic sampling pattern
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampler(ttype, npoints, ncycles, ps = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampler_+3A_ttype">ttype</code></td>
<td>

<p>character string: Specifying the sampling pattern. Possible options: <code>"equi"</code> and <code>"unif"</code> for unperiodic sampling, <code>"sine"</code> and <code>"trian"</code> for sampling with a periodic density (see Details). 
</p>
</td></tr>
<tr><td><code id="sampler_+3A_npoints">npoints</code></td>
<td>

<p>integer: Sample size <code class="reqn">n</code> (see Details).
</p>
</td></tr>
<tr><td><code id="sampler_+3A_ncycles">ncycles</code></td>
<td>

<p>integer: Number of sampling cycles <code class="reqn">n_s</code> (see Details).
</p>
</td></tr>
<tr><td><code id="sampler_+3A_ps">ps</code></td>
<td>

<p>positive numeric value: Sampling period <code class="reqn">p_s</code> (see Details).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>sampler</code> generates observation times <code class="reqn">t_1,\ldots,t_n</code> with a periodic sampling of period <code class="reqn">p_s</code>. Four distributions are possible:
In case of <code>ttype="equi"</code>, the <code class="reqn">t_i</code> are equidistantly sampled with <code class="reqn">t_i=i\frac{p_sn_s}{n}</code>.
For <code>ttype="unif"</code>, the observation times are independently drawn form a uniform distribution on <code class="reqn">[0,n_sp_s]</code>.
Both these sampling schemes are aperiodic, the sampling period <code class="reqn">p_s</code> only influences the length <code class="reqn">t_n-t_1</code> of the series of observation times.                       
</p>
<p>For <code>ttype="sine"</code> and <code>ttype="trian"</code>, observation cycles <code class="reqn">z^\star_i</code> are drawn from a uniform distribution on <code class="reqn">\{1,\ldots,n_s\}</code> and observation phases <code class="reqn">\varphi^\star_i</code> are drawn from a density 
</p>
<p style="text-align: center;"><code class="reqn">d_{sine}(x)= \sin(2\pi x)+1</code>
</p>
<p> (for <code>ttype="sine"</code>) or  
</p>
<p style="text-align: center;"><code class="reqn">d_{trian}(x)= 3x, \quad  0\leq x\leq\frac{2}{3},</code>
</p>
 
<p style="text-align: center;"><code class="reqn">d_{trian}(x)= 6-6x, \quad \frac{2}{3}&lt;x\leq 1</code>
</p>
<p> (for <code>ttype="trian"</code>).
The unsorted observation times <code class="reqn">t^\star_i</code> are then generated using 
</p>
<p style="text-align: center;"><code class="reqn">t^\star_i= \varphi^\star_i+(z^\star_i-1)p_s.</code>
</p>

<p>Separately sampling observation cycle and phase was proposed by Hall and Yin (2003). For more details see Thieler, Fried and Rathjens (2016) or Thieler et al. (2013).
</p>


<h3>Value</h3>

<p>numeric vector: Ordered observation times.
</p>


<h3>Note</h3>

<p>To sample from <code class="reqn">d_{sine}</code>, the function <code>BBsolve</code>, package <code>BB</code>, is used. 
</p>
<p>A former version of this function is used in Thieler et al. (2013).
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler and Jonathan Rathjens
</p>


<h3>References</h3>

<p>Hall, P. and Yin, J. (2003): Nonparametric Methods for Deconvolving Multiperiodic Functions. Journal of the Royal Statistical Society: Series B (Statistical Methodology), 65 (4), 869-886
</p>
<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>Applied in <code><a href="#topic+tsgen">tsgen</a></code> (see there for an example).
</p>

<hr>
<h2 id='signalgen'>
Generator for periodic signal in a light curve
</h2><span id='topic+signalgen'></span>

<h3>Description</h3>

<p>Calculates periodically varying values for given observation times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>signalgen(tt, ytype, pf = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="signalgen_+3A_tt">tt</code></td>
<td>

<p>numeric vector: Observation times <code class="reqn">t_1,\ldots,t_n</code> (see Details).
</p>
</td></tr>
<tr><td><code id="signalgen_+3A_ytype">ytype</code></td>
<td>

<p>character string: Specifying the shape of the periodic fluctuation (see Details). Possible choices are <code>"const"</code>, <code>"sine"</code>, <code>"trian"</code>,<code>"peak"</code>.
</p>
</td></tr>
<tr><td><code id="signalgen_+3A_pf">pf</code></td>
<td>

<p>positive numeric value: Fluctuation period <code class="reqn"> p_f</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The values <code class="reqn">y_{f;1},\ldots,y_{f;n}</code> with fluctuation period <code class="reqn">p_f</code> and related to observation times <code class="reqn">t_1,\ldots,t_n</code> are generated using 
</p>
<p style="text-align: center;"><code class="reqn">y_{f;i}=f\left(\frac{t_i}{p_f}\right), i=1,\ldots,n. </code>
</p>

<p>Depending on <code>ytype</code> (see above), <code class="reqn">f</code> is defined as:
</p>
<p style="text-align: center;"><code class="reqn"> f_{const}(t) = 0,</code>
</p>

<p style="text-align: center;"><code class="reqn">f_{sine}(t)= \sin\left(\frac{2\pi t}{p_f}\right),</code>
</p>

<p style="text-align: center;"><code class="reqn">f_{trian}(t)= 3\varphi_{1}(t), \quad 0\leq \varphi_{1}(t)\leq\frac{2}{3},</code>
</p>

<p style="text-align: center;"><code class="reqn">f_{trian}(t)= 6-6\varphi_{1}(t),\quad \frac{2}{3}&lt;\varphi_{1}(t)\leq 1,</code>
</p>

<p style="text-align: center;"><code class="reqn">f_{peak}(t)= 9\exp\left(-3p_f^2\left(\varphi_{1}(t)-\frac 23\right)^2\right),\quad  0\leq \varphi_{1}(t)\leq\frac{2}{3},</code>
</p>

<p style="text-align: center;"><code class="reqn">f_{peak}(t)= 9\exp\left(-12p_f^2\left(\varphi_{1}(t)-\frac 23\right)^2\right),\quad \frac{2}{3}&lt;\varphi_{1}(t)\leq 1,</code>
</p>

<p>with <code class="reqn">\varphi_1(t) = t mod1 = (t-\lfloor t/p_f \rfloor p_f)/p_f</code> = <code>(t%%1)/pf</code>. <code class="reqn">f_{const}</code> means that there is no (periodic) fluctuation, <code class="reqn">f_{sine}</code> defines a sine function, <code class="reqn">f_{trian}</code> defines a triangular shaped periodic function and <code class="reqn">f_{peak}</code> a periodically repeating peak.
</p>


<h3>Value</h3>

<p>numeric vector: Values <code class="reqn">y_{f;1},\ldots,y_{f;n}</code>.
</p>


<h3>Note</h3>

<p>This function is used in Thieler et al. (2013). See also Thieler, Fried and Rathjens (2016).</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler and Jonathan Rathjens
</p>


<h3>References</h3>

<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>Applied in <code><a href="#topic+tsgen">tsgen</a></code> (see there for an example).
</p>

<hr>
<h2 id='star_groj0422.32'>Data: Light curve from GROJ0422+32</h2><span id='topic+star_groj0422.32'></span>

<h3>Description</h3>

<p>Light curve for gamma ray emission of the source GROJ0422+32.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>star_groj0422.32</code></pre>


<h3>Format</h3>

<p>A matrix of three columns, with a time series of length 729 appropriate to <code><a href="#topic+RobPer">RobPer</a></code>.</p>


<h3>Details</h3>

<p>Data obtained by the BATSE Earth Occultation Monitoring project of the NSSTC, available from <a href="https://gammaray.nsstc.nasa.gov/batse/occultation/">https://gammaray.nsstc.nasa.gov/batse/occultation/</a>. The experiments are described in Harmon et al. (2002) and Harmon et al. (2004).</p>


<h3>Note</h3>

<p>See Vignette Section 5.2 for example.</p>


<h3>Source</h3>

<p>Data kindly provided by the National Aeronautics and Space Administration (NASA); National Space, Science, and Technology Center (NSSTC); Gamma-Ray Astrophysics Team (see Details).</p>


<h3>References</h3>

<p>Harmon, B. A., Fishman, G. J., Wilson, C. A., Paciesas, W. S., Zhang, S. N., Finger, M. H., Koshut, T. M., McCollough, M. L., Robinson, C. R. and Rubin, B. C. (2002): The Burst and Transient Source Experiment Earth Occultation Technique. The Astrophysical Journal Supplement Series, 138 (1), 149-183
</p>
<p>Harmon, B. A., Wilson, C. A., Fishman, G. J., Connaughton, V., Henze, W., Paciesas, W. S., Finger, M. H., McCollough, M. L., Sahi, M., Peterson, B., Shrader, C. R., Grindlay, J. E. and Barret, D. (2004): The Burst and Transient Source Experiment (BATSE) Earth Occultation Catalog of Low-Energy Gamma-Ray Sources. The Astrophysical Journal Supplement Series, 154 (2), 585-622
</p>

<hr>
<h2 id='TK95'>
Power law noise generator
</h2><span id='topic+TK95'></span>

<h3>Description</h3>

<p>Generates an equidistant time series of power law noise according to Timmer and K√É¬∂nig (1995).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TK95(N = 1000, alpha = 1.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TK95_+3A_n">N</code></td>
<td>

<p>integer value: Length of the generated time series.
</p>
</td></tr>
<tr><td><code id="TK95_+3A_alpha">alpha</code></td>
<td>

<p>numeric value: Exponent of the power law. White noise has exponent 0, flicker noise (pink noise) has exponent 1, brown noise has exponent 2.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector: The generated time series.
</p>


<h3>Note</h3>

<p>This function is used in Thieler et al. (2013). See also Thieler, Fried and Rathjens (2016).
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler with contributions of Uwe Ligges
</p>


<h3>References</h3>

<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>
<p>Timmer, J. and K√É¬∂nig, M. (1995) On Generating Power Law Noise. Astronomy and Astrophysics, 300, 707-710
</p>


<h3>See Also</h3>

<p>Applied in <code><a href="#topic+tsgen">tsgen</a></code> by <code><a href="#topic+TK95_uneq">TK95_uneq</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(31)
# Generate power law noise with exponent alpha=1.5:
y &lt;- TK95(N=2000, alpha=1.5)
tt &lt;- seq(along=y)

# Show time series:
plot(tt,y, type="l", main="Power Law Noise", xlab="t", ylab="y")

# Plot Fourier periodogram with log-axes:
temp &lt;- spectrum(y, plot=FALSE)
plot(log(temp$freq), log(temp$spec), main="log-log-Fourier periodogram",
    xlab="log(frequency)", ylab="log(periodogram)")

# A line with slope -alpha for comparison
abline(a=8, b=-1.5, col="red")
text(-2, 12, expression(alpha==1.5), col="red")
</code></pre>

<hr>
<h2 id='TK95_uneq'>
Power law noise generator for unequally sampled observation times
</h2><span id='topic+TK95_uneq'></span>

<h3>Description</h3>

<p>Generates power law noise using <code><a href="#topic+TK95">TK95</a></code> according to Timmer and K√É¬∂nig (1995), with modifications proposed in Uttley, McHardy and Papadakis (2002) for given irregular observation times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TK95_uneq(tt, alpha = 1.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TK95_uneq_+3A_tt">tt</code></td>
<td>

<p>numeric vector: Observation times given.
</p>
</td></tr>
<tr><td><code id="TK95_uneq_+3A_alpha">alpha</code></td>
<td>

<p>numeric value: exponent of the power law. White noise has exponent 0, flicker noise (pink noise) has exponent 1, brown noise has exponent 2.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector: Noise values related to the observation times.
</p>


<h3>Note</h3>

<p>This function is applied in Thieler et al. (2013). See also Thieler, Fried and Rathjens (2016).
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler
</p>


<h3>References</h3>

<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>
<p>Timmer, J. and K√É¬∂nig, M. (1995) On Generating Power Law Noise. Astronomy and Astrophysics, 300, 707-710
</p>
<p>Uttley, P., McHardy, I. M. and Papadakis, I. E. (2002) Measuring the Broad-Band Power Spectra of Active Galactic Nuclei with RXTE. Monthly Notices of the Royal Astronomical Society, 332 (1), 231-250
</p>


<h3>See Also</h3>

<p>Applies <code><a href="#topic+TK95">TK95</a></code>, applied in <code><a href="#topic+tsgen">tsgen</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compare with example in TK95 to see that the power law is much more clear in
# equally sampled data!
set.seed(31)
# Generate power law noise with exponent alpha=1.5:
tt &lt;- sampler(ttype="unif", ps=1, ncycles=2000, npoints=2000)
y &lt;- TK95_uneq(tt, alpha=1.5)

# Show time series:
plot(tt,y, type="l", main="Irregular Power Law Noise", xlab="t", ylab="y")

# Plot Lomb-Scargle periodogram with log-axes:
temp &lt;- RobPer(cbind(tt,y,1), weighting=FALSE, model="sine", regression="L2",
    periods=2000/seq(2, 1000, 2))
plot(log(seq(2, 1000, 2)/2000), log(temp), main="log-log-Fourier periodogram",
    xlab="log(frequency)", ylab="log(periodogram)")
title(main= "Power Law not so obvious", cex.main=0.8, line=0.5)

# A line with slope -alpha for comparison
abline(a=-10, b=-1.5, col="red")
text(-5, -1.5, expression(alpha==1.5), col="red")
</code></pre>

<hr>
<h2 id='tsgen'>
Artificial light curve generator
</h2><span id='topic+tsgen'></span>

<h3>Description</h3>

<p>This function generates light curves (special time series) with unequally sampled observation times, different periodicities both in sampling and observed values, with white and power law (red) noise in the observed values and possibly disturbed observations.
See <code><a href="#topic+RobPer-package">RobPer-package</a></code> for more information about light curves and also Thieler, Fried and Rathjens (2016) for more details in general.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsgen(ttype, ytype, pf, redpart, s.outlier.fraction = 0, interval, npoints,
 ncycles, ps, SNR, alpha = 1.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsgen_+3A_ttype">ttype</code></td>
<td>

<p>character string: Specifying the sampling pattern. Possible choices are <code>"equi"</code> for equidistant sampling without gaps (unperiodic), <code>"unif"</code> for uniform non-equidistant unperiodic sampling, <code>"sine"</code> for sampling with periodic sine density, <code>"trian"</code> for sampling with periodic triangular density, both with period <code class="reqn">p_s</code> (see Details and <code><a href="#topic+sampler">sampler</a></code>). 
</p>
</td></tr>
<tr><td><code id="tsgen_+3A_ytype">ytype</code></td>
<td>

<p>character string: Specifying the shape of the periodic fluctuation with period <code class="reqn">p_f</code>. Possible choices are <code>"const"</code> for constantly being zero (so no periodicity), <code>"sine"</code> for a sine, <code>"trian"</code> for a periodic triangular function, <code>"peak"</code> for a peak function (see Details and <code><a href="#topic+signalgen">signalgen</a></code> for more details).
</p>
</td></tr>
<tr><td><code id="tsgen_+3A_pf">pf</code></td>
<td>

<p>positive number: Period <code class="reqn">p_f</code> of the periodic fluctuation, argument of <code>signalgen</code> (see Details and <code><a href="#topic+signalgen">signalgen</a></code>).
</p>
</td></tr>
<tr><td><code id="tsgen_+3A_redpart">redpart</code></td>
<td>

<p>numeric value in [0,1]: Proportion of the power law noise in noise components (see Details). The generated measurement accuracies <code class="reqn">s_i</code> do not contain information about this noise component. 
</p>
</td></tr>
<tr><td><code id="tsgen_+3A_s.outlier.fraction">s.outlier.fraction</code></td>
<td>

<p>numeric value in [0,1]: Fraction of measurement accuracies to be replaced by outliers. A value of 0 means that no measurement accuracy is replaced by an outlier (for more details see <code><a href="#topic+disturber">disturber</a></code>). 
</p>
</td></tr>
<tr><td><code id="tsgen_+3A_interval">interval</code></td>
<td>

<p>logical: If <code>TRUE</code>, the observed values belonging to a random time interval of length 3<code class="reqn">p_s</code> are replaced by atypical values (for more details see <code><a href="#topic+disturber">disturber</a></code>).  
</p>
</td></tr>
<tr><td><code id="tsgen_+3A_npoints">npoints</code></td>
<td>

<p>integer value: Defines the sample size <code class="reqn">n</code> for the generated light curve.
</p>
</td></tr>
<tr><td><code id="tsgen_+3A_ncycles">ncycles</code></td>
<td>

<p>integer value: number <code class="reqn">n_s</code> of sampling cycles that is observed (see Details). 
</p>
</td></tr>
<tr><td><code id="tsgen_+3A_ps">ps</code></td>
<td>

<p>positive number: Sampling period <code class="reqn">p_s</code>, influencing the sampling and how the light curve is disturbed (see Details and <code><a href="#topic+disturber">disturber</a></code>).
</p>
</td></tr>
<tr><td><code id="tsgen_+3A_snr">SNR</code></td>
<td>

<p>positive number: Defines the relation between signal <code class="reqn">y_f</code> and noise <code class="reqn">y_w+y_r</code> (see Details).
</p>
</td></tr>
<tr><td><code id="tsgen_+3A_alpha">alpha</code></td>
<td>

<p>numeric value: Power law index <code class="reqn">\alpha</code> for the power law noise component <code class="reqn">y_r</code> (see Details). 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>tsgen</code> generates an artificial light curve consisting of observation times <code class="reqn">t_1,\ldots,t_n</code>, observation values <code class="reqn">y_1,\ldots,y_n</code> and measurement accuracies <code class="reqn">s_1,\ldots,s_n</code>. It calls several subfunctions (see there for details):
</p>
<p><code><a href="#topic+sampler">sampler</a></code>  is used to sample observation times <code class="reqn">t_1,\ldots,t_n</code> in the interval <code class="reqn">[0,n_s*p_s]</code> with a possibly periodic sampling of period <code class="reqn">p_s</code>.
</p>
<p><code><a href="#topic+signalgen">signalgen</a></code> generates periodically varying values <code class="reqn">y_{f;1},\ldots,y_{f;n}</code> at time points <code class="reqn">t_1,\ldots,t_n</code> with fluctuation period <code class="reqn">p_f</code>.
</p>
<p><code><a href="#topic+lc_noise">lc_noise</a></code>  samples measurement accuracies <code class="reqn">s_1,\ldots,s_n</code> 
from a Gamma(3,10)-distribution and a white noise component 
<code class="reqn">y_{w;1},\ldots,y_{w;n}</code> with from <code class="reqn">\mathcal N(0,s_i^2)</code> distributions. A second noise component <code class="reqn">y_{r;1},\ldots,y_{r;n}</code> does not depend on the <code class="reqn">s_i</code>. It is generated as red noise, i.e. following a power law with power law index <code class="reqn">\alpha</code>. For white noise choose <code class="reqn">\alpha=0</code>, for flicker noise (pink noise) <code class="reqn">\alpha=1</code>, for brown noise <code class="reqn">\alpha=2</code>. The power law noise is generated using <code><a href="#topic+TK95_uneq">TK95_uneq</a></code> and <code><a href="#topic+TK95">TK95</a></code>. The noise components are scaled so that the variance of the <code class="reqn">y_{r;i}</code> has approximately the proportion <code>redpart</code> in the overall noise variance and that <code>SNR</code> is the ratio <code class="reqn">var(y_f)/var(y_w+y_r)</code>. The observed values are set to <code class="reqn">y_i= y_{f;i}+y_{w;i}+y_{r;i} \forall i</code>.
</p>
<p><code><a href="#topic+disturber">disturber</a></code> disturbes the light curve replacing measurement accuracies 
<code class="reqn">s_i</code> by outliers (if <code>s.outlier.fraction&gt;0</code>) and observed values 
<code class="reqn">y_i</code> by atypical values (if <code>interval=TRUE</code>). 
In case of <code>s.outlier.fraction=0</code> and <code>interval=FALSE</code>, the function returns all values unchanged.
</p>


<h3>Value</h3>

<table>
<tr><td><code>tt</code></td>
<td>
<p>numeric vector: Generated observation times<code class="reqn">\ t_1,\ldots,t_n</code>.</p>
</td></tr>    
<tr><td><code>y</code></td>
<td>
<p>numeric vector: Generated observation values<code class="reqn">\ y_1,\ldots,y_n</code>.</p>
</td></tr> 
<tr><td><code>s</code></td>
<td>
<p>numeric vector: Generated measurement accuracies<code class="reqn">\ s_1,\ldots,s_n</code>.</p>
</td></tr>                                       
</table>


<h3>Note</h3>

<p>Note that the white noise components' variances are exactly <code class="reqn">s_i^2</code>, so the <code class="reqn">s_i</code> are no estimates, but true values. In this sense, the measurement accuracies of a generated light curve are more informative than for real light curves, where the measurement accuracies are estimates, see Thieler et al. (2013), where also a former version of this function is applied. 
</p>
<p>To lower the informativity of the measurement accuracies, set <code>redpart</code> to a strictly positive value, possibly with <code>alpha=0</code> if no other noise components than white ones are required.
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler and Jonathan Rathjens
</p>


<h3>References</h3>

<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>Applies <code><a href="#topic+sampler">sampler</a></code>, <code><a href="#topic+signalgen">signalgen</a></code>, <code><a href="#topic+lc_noise">lc_noise</a></code>, <code><a href="#topic+disturber">disturber</a></code>, <code><a href="#topic+TK95">TK95</a></code>, <code><a href="#topic+TK95_uneq">TK95_uneq</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a light curve:
set.seed(22)
lightcurve&lt;- tsgen(ttype="sine", ytype="peak" , pf=7, redpart=0.1, s.outlier.fraction=0, 
    interval=FALSE, npoints=200, ncycles=100, ps=5, SNR=3, alpha=0)

# Or do it step by step:
# First sampling observation times:
set.seed(22)
tt &lt;- sampler(ttype="sine", npoints=200, ncycles=100, ps=5)

# show obviously irregular observation times as grey vertical bars on a red time line:
plot(tt, tt*0, type="n", axes=FALSE, xlab="Observation Times", ylab="")
    abline(v=tt, col="grey")
axis(1, pos=0, col="red", col.axis="red")

# Sampling period is 5, look at observation times modulo 10:
hist(tt%%5, xlab="Observation time modulo 5", 
    main="Sine Distribution for the phase (tt modulo 5)", freq=FALSE)
dsin &lt;- function(tt) 0.2*(sin(2*pi*tt/5)+1)
curve(dsin, add=TRUE)

# Then generate periodic fluctuation
yf &lt;- signalgen(tt, ytype="peak", pf=7)

plot(tt, yf, xlab="Observation Times", ylab="Periodic Fluctuation")
plot(tt%%7, yf, main="Phase Diagram (time modulo 7)", 
    xlab="Observation time modulo 7",  ylab="Periodic Fluctuation")

# Add noise and scale signal to the right SNR
temp &lt;- lc_noise(tt,sig=yf, SNR=3, redpart=0.1, alpha=0)
y &lt;- temp$y
s &lt;- temp$s

# Plotting the light curve (vertical bars show measurement accuracies)
plot(tt, y, pch=16, cex=0.5, xlab="t", ylab="y", main="a Light Curve")
rect(tt, y+s, tt, y-s)

# The lightcurve has period 7:
plot(tt%%7, y, pch=16, cex=0.5, xlab="t", ylab="y", 
    main="Phase Diagram of a Light Curve")
rect(tt%%7, y+s, tt%%7, y-s)

# replace measurement accuracies by tiny outliers or include a peak
temp &lt;- disturber(tt,y,s,ps=5, s.outlier.fraction=0, interval=FALSE)

# Phase diagram (observation times modulo 10)
plot(tt%%7, temp$y, pch=16, cex=0.5, xlab="t", ylab="y", 
    main="Phase Diagram of a Light Curve")
rect(tt%%7, temp$y+temp$s, tt%%7, temp$y-temp$s)

# The result is the same:
all(cbind(tt,temp$y,temp$s)==lightcurve)
</code></pre>

<hr>
<h2 id='Xgen'>
Designmatrix generator
</h2><span id='topic+Xgen'></span>

<h3>Description</h3>

<p>This function is used to create the designmatrices needed in <code>RobPer</code> to fit periodic functions. See <code>RobPer</code> or Thieler, Fried and Rathjens (2016) for Details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Xgen(tt, n, s, pp, design, steps = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Xgen_+3A_tt">tt</code></td>
<td>

<p>real-valued vector of length <code>n</code>: Observation times. 
</p>
</td></tr>
<tr><td><code id="Xgen_+3A_n">n</code></td>
<td>

<p>integer: Sample size.
</p>
</td></tr>
<tr><td><code id="Xgen_+3A_s">s</code></td>
<td>

<p>numeric vector of length <code>n</code>: Measurement errors to perform weighted regression, else set <code>s=rep(1,n)</code>.
</p>
</td></tr>
<tr><td><code id="Xgen_+3A_pp">pp</code></td>
<td>

<p>positive number: Trial period.
</p>
</td></tr>
<tr><td><code id="Xgen_+3A_design">design</code></td>
<td>

<p>character string: Shape of the periodic function to be fitted, possible choices are <code>"step"</code>, <code>"sine"</code>, <code>"fourier(2)"</code>, <code>"fourier(3)"</code>, <code>"splines"</code> (see <code>RobPer</code> for details) and  <code>"stepB"</code>. The latter generates a step function like <code>"step"</code>, but with opposite jumping time points. This is needed for RobPer with <code>model="2step"</code> (see <code>RobPer</code>).
</p>
</td></tr>
<tr><td><code id="Xgen_+3A_steps">steps</code></td>
<td>

<p>Number of steps for the step functions 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric matrix: Designmatrix.
</p>


<h3>Note</h3>

<p>A former version of this function is used in Thieler et al. (2013).
</p>


<h3>Author(s)</h3>

<p>Anita M. Thieler and Jonathan Rathjens
</p>


<h3>References</h3>

<p>Thieler, A. M., Backes, M., Fried, R. and Rhode, W. (2013): Periodicity Detection in Irregularly Sampled Light Curves by Robust Regression and Outlier Detection. Statistical Analysis and Data Mining, 6 (1), 73-89
</p>
<p>Thieler, A. M., Fried, R. and Rathjens, J. (2016): RobPer: An R Package to Calculate Periodograms for Light Curves Based on Robust Regression. Journal of Statistical Software, 69 (9), 1-36, &lt;doi:10.18637/jss.v069.i09&gt;
</p>


<h3>See Also</h3>

<p>Applied in <code><a href="#topic+RobPer">RobPer</a></code>, see <code><a href="#topic+FastTau">FastTau</a></code> for an example.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
