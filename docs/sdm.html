<!DOCTYPE html><html lang="en"><head><title>Help for package sdm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sdm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add'><p>add a new method to the package</p></a></li>
<li><a href='#aoa'><p>Area of Applicability</p></a></li>
<li><a href='#Arith-methods'><p>Combine (merge) two sdmModels into a single object</p></a></li>
<li><a href='#as.data.frame'><p>Get a data.frame with record id values (rID)</p></a></li>
<li><a href='#background'><p>Generate background (pseudo-absence) records</p></a></li>
<li><a href='#boxplot'><p>boxplot</p></a></li>
<li><a href='#calibration'><p>Calibration</p></a></li>
<li><a href='#coords'><p>get or set spatial coordinates of species data</p></a></li>
<li><a href='#density'><p>density</p></a></li>
<li><a href='#ensemble'><p>Ensemble Forecasting of SDMs</p></a></li>
<li><a href='#evaluates'><p>evaluate for accuracy</p></a></li>
<li><a href='#Extract+20by+20index'><p>Indexing to extract records of a sdmdata object</p></a></li>
<li><a href='#featuresFrame-class'><p>featureFrame class</p></a></li>
<li><a href='#get+20models+27+20outputs'><p>Get information/modelIDs relevant to fitted models in a sdmModels object</p></a></li>
<li><a href='#getVarImp'><p>variable importance</p></a></li>
<li><a href='#gui'><p>Graphical User Interface</p></a></li>
<li><a href='#installAll'><p>install all packages that may be required by the package</p></a></li>
<li><a href='#names'><p>Names of species</p></a></li>
<li><a href='#niche'><p>Generate and plot Ecological Niche</p></a></li>
<li><a href='#nicheSimilarity'><p>Niche Similarity</p></a></li>
<li><a href='#pa'><p>Converting probability of occurrence to Presence-absence</p></a></li>
<li><a href='#pca'><p>Principle Component Analysis</p></a></li>
<li><a href='#predict'><p>sdm model prediction</p></a></li>
<li><a href='#rcurve'><p>Generate and plot response curves</p></a></li>
<li><a href='#read.sdm'><p>read/write sdm* object from/to a file</p></a></li>
<li><a href='#roc'><p>plot ROC curves</p></a></li>
<li><a href='#sdm'><p>Fit and evaluate species distribution models</p></a></li>
<li><a href='#sdmAdapt'><p>Adapting sdm* objects in the new version</p></a></li>
<li><a href='#sdmCorrelativeMethod-class'><p>sdmCorrelativeMethod class</p></a></li>
<li><a href='#sdmData'><p>creating sdm Data object</p></a></li>
<li><a href='#sdmdata-class'><p>An S4 class representing sdm dataset</p></a></li>
<li><a href='#sdmModels-classes'><p>sdmModels classes</p></a></li>
<li><a href='#sdmSetting'><p>creating sdmSetting object</p></a></li>
<li><a href='#subset'><p>Subset models in a sdmModels object</p></a></li>
<li><a href='#threshold'><p>Identifying/extracting the best threshold to convert probabilities to Presence/Absences</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Species Distribution Modelling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-55</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-11</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, R (&ge; 3.5.0), terra</td>
</tr>
<tr>
<td>Imports:</td>
<td>sp, raster</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp, shinyBS, shiny, dismo</td>
</tr>
<tr>
<td>Description:</td>
<td>An extensible framework for developing species distribution
    models using individual and community-based approaches, generate ensembles of
    models, evaluate the models, and predict species potential distributions in
    space and time. For more information, please check the following paper:
    Naimi, B., Araujo, M.B. (2016) &lt;<a href="https://doi.org/10.1111%2Fecog.01881">doi:10.1111/ecog.01881</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.biogeoinformatics.org">https://www.biogeoinformatics.org</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-11 04:47:33 UTC; naimi001</td>
</tr>
<tr>
<td>Author:</td>
<td>Babak Naimi <a href="https://orcid.org/0000-0001-5431-2729"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Miguel B. Araujo [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Babak Naimi &lt;naimi.b@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-11 06:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add'>add a new method to the package</h2><span id='topic+add'></span><span id='topic+getmethod'></span><span id='topic+getmethodNames'></span><span id='topic+add+2Clist+2Ccharacter-method'></span><span id='topic+getmethod+2Ccharacter-method'></span><span id='topic+getmethodNames+2CANY-method'></span>

<h3>Description</h3>

<p>This function is an interface to extend the package. A user can define a new method and add it to the package. When the method is successfully added, it can be used along with other existing methods. The names of available methods in the package can be seen using the <code>getmethodNames</code> function. It is not limited only to the modelling methods, but can also be used for a replication method, or those used to generate pseudo-absences (backgrounds), etc.
</p>
<p>You can get definitions for an existing method as an object using <code>getmethod</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add(x,w,echo,...)

getmethod(x,w,...)

getmethodNames(w,...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_+3A_x">x</code></td>
<td>
<p>Either a <code>list</code>, or an object generated by <code>getmethod</code> function</p>
</td></tr>
<tr><td><code id="add_+3A_w">w</code></td>
<td>
<p>specify which group of methods the new method belongs to. &quot;sdm&quot; (default) can be used for modelling method </p>
</td></tr>
<tr><td><code id="add_+3A_echo">echo</code></td>
<td>
<p>logical (default=TRUE), determines whether a message should be printed to report if the adding is successful</p>
</td></tr>
<tr><td><code id="add_+3A_...">...</code></td>
<td>
<p>additional arguments. see details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions provide flexibility to extend the package by users through adding new methods to the package. It is also possible to add several instances of an existing method which, for example, edited to use the same method with different settings at the same time. Whatever the new method is, it can also be shared and used by other users.
</p>


<h3>Value</h3>

<p>getmethod gives an object of an appropriate class depending on <code>w</code>.
</p>
<p>getmethodNames generates a list (if alt=TRUE is provided as an additional argument) containing the name of methods and all alternative names (aliases) specified for each method, or a character vector (if alt=FALSE) containing the main abbreviation names of the existing methods.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
getmethodNames('sdm')

## End(Not run)
</code></pre>

<hr>
<h2 id='aoa'>Area of Applicability</h2><span id='topic+aoa'></span><span id='topic+aoa+2CSpatRaster+2Csdmdata-method'></span><span id='topic+aoa+2CSpatRaster+2CsdmModels-method'></span>

<h3>Description</h3>

<p>aoa (Area of Applicability) measures whether the values of pixels in a SpatRaster object (x) with environmental layers used to train SDMs are within the range of variables contributed in the modelling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aoa(x,d,vi=NULL)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aoa_+3A_x">x</code></td>
<td>
<p>a <code>SpatRaster</code> object with predictors used to train SDMs</p>
</td></tr>
<tr><td><code id="aoa_+3A_d">d</code></td>
<td>
<p>a  <code>sdmdata</code> or <code>sdmModels</code> object</p>
</td></tr>
<tr><td><code id="aoa_+3A_vi">vi</code></td>
<td>
<p>optional; a numeric vector of variable importance values of the variables in <code>x</code>; vi should have the same length as the number of variables in <code>x</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output of this function is a raster with values ranging between 0 and 1 can be infered as the degree of similarity between values of the environmental variables at each pixel and training range. When the values of all variables in <code>x</code> are within the range used to train the models (training range), the output of <code>aoa</code> is 1. Less than 1 refers to degree of dissimilarity to the range (it may be the proportion of variables outside of the training range; smaller value is more dissimilar) .
</p>
<p>The <code>aoa</code> function can be used when the predict or ensemble function is used to predict or project distribution in a new area or a new time (e.g., future) where it is likely to have pixels with values outside of the training range.
By using the variable importance, higher weights are given to more important variables to assess similarity.
</p>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object 
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org">https://www.biogeoinformatics.org</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#




</code></pre>

<hr>
<h2 id='Arith-methods'>Combine (merge) two sdmModels into a single object</h2><span id='topic+Arith-methods'></span><span id='topic++2B+2CsdmModels+2CsdmModels-method'></span>

<h3>Description</h3>

<p>If two sets of models fitted in two separate sdmModels objects, they can be merged into a single sdmModels object using '+'.
</p>


<h3>Value</h3>

<p>An object of class <code>sdmModels</code>.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/pa_df.csv", package="sdm")

df &lt;- read.csv(file)

head(df) 

d &lt;- sdmData(sp ~ b15 + NDVI, train = df)

d
#----


m1 &lt;- sdm(sp ~ b15 + NDVI, data = d, methods = c('glm', 'gbm'))

m1

m2 &lt;- sdm(sp ~ b15 + NDVI, data = d, methods = c('svm'))

m2

m &lt;- m1 + m2

m


## End(Not run)

</code></pre>

<hr>
<h2 id='as.data.frame'>Get a data.frame with record id values (rID)</h2><span id='topic+as.data.frame'></span><span id='topic+as.data.frame+2Csdmdata-method'></span>

<h3>Description</h3>

<p>Converts a <code>sdmdata</code> object to a <code>data.frame</code>. By including additional arguments, it is possible to make a query on the dataset (see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'sdmdata'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.data.frame_+3A_x">x</code></td>
<td>
<p>sdmdata object</p>
</td></tr>
<tr><td><code id="as.data.frame_+3A_...">...</code></td>
<td>
<p>Additional arguments (optional, see details)</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The following additional arguments can optionally be used to get a subset of data by specifying record IDs; or make a query by specifying the name of species, and/or the name of data groups, and/or a range of time period (if time is available in data):
</p>
<p><code>ind</code>: an integer vector with record Ids;
</p>
<p><code>sp</code>: a character vector with the name of species;
</p>
<p><code>grp</code>: a character vector specifying groups of data (e.g., 'test', if independent test data is available)
</p>
<p><code>time</code>: a vector of times (an appropriate time class or a character that can be converted into a time format)
</p>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/data.sdd", package="sdm")

d &lt;- read.sdm(file)

d # a sdmdata object

df &lt;- as.data.frame(d)

head(df)

# only the records with rID == c(1,2,3):

as.data.frame(d, ind=1:3)

## End(Not run)


</code></pre>

<hr>
<h2 id='background'>Generate background (pseudo-absence) records</h2><span id='topic+background'></span><span id='topic+background+2CSpatRaster-method'></span><span id='topic+background+2CRaster-method'></span>

<h3>Description</h3>

<p>The function uses different methods to genrates background or Pseudo-absence records over an study area which is assumed to be the non-NA cells in the input Raster layer(s) in <code>x</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>background(x,n,method,bias,sp,setting)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="background_+3A_x">x</code></td>
<td>
<p>an spatRaster or RasterStack or RasterBrick object with explanatory (predictor) variables that will be used to fit SDMs</p>
</td></tr>
<tr><td><code id="background_+3A_n">n</code></td>
<td>
<p>size of background sample</p>
</td></tr>
<tr><td><code id="background_+3A_method">method</code></td>
<td>
<p>a character, specifies the method of background generation; can be either of <code>gRandom</code>,<code>eRandom</code>,<code>gDist</code>,<code>eDist</code></p>
</td></tr>
<tr><td><code id="background_+3A_bias">bias</code></td>
<td>
<p>optional, a Raster object (SpatRaster or RasterLayer) with a single layer that specifies bias map which can ONLY be used by the method <code>gRandom</code> </p>
</td></tr>
<tr><td><code id="background_+3A_sp">sp</code></td>
<td>
<p>species presence locations (either as a SpatVector/SpatialPoints or a data.frame/matrix object); this argument is needed if the method is either <code>gDist</code> or <code>eDist</code> </p>
</td></tr>
<tr><td><code id="background_+3A_setting">setting</code></td>
<td>
<p>optional, a list contains additional settings required by different methods (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following methods are available:
</p>
<p>- gRandom (random selection over geographical space): this method randomly select the non-missing pixels over the study area. Same weights are given to each pixel through the random selection of points unless the <code>bias</code> layer is introduced by a user which is a single raster layer that specifys a weighting scheme for background generation. A pixel with a greater value in the bias layer would have a higher chance to be selected as a background record. It has been shown by some studies that if the same bias in collecting the presence records (e.g., locations that are close to roads and residential areas have higher chance to be visited for recording species presence) is used to generate background records, it can improve performance of SDMs.
</p>
<p>- eRandom (random selection over environmental spece): this method tries to collect a uniform (i.e., evenly distributed) distribution of records over environmental gradiants by sampling in environmental space.
</p>
<p>- gDist (random sampling weighted by geographic distnce): This method uses a random selection of locations over geographical space but gives more weights to locations with larger distance to species presence locations.
</p>
<p>- eDist (random sampling weighted by environmental distance): This method uses a random selection of locations over geographical space but gives more weights to locations with environmental conditions that are more dissimilar to the locations where species are observed.
</p>


<h3>Value</h3>

<p>a data.frame with spatial coordinates of background locations and the values of predictor variables extracted over the locations.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  #########

# Let's read raster dataset containing predictor variables for this study area:

file &lt;- system.file("external/predictors.tif", package="sdm") # path to a raster object

r &lt;- rast(file)

r # a SpatRaster object including 2 rasters (covariates)

plot(r)
#----

file &lt;- system.file("external/po_spatial_points.shp", package="sdm") # path to a shapefile

po &lt;- vect(file) # spatial points with presence-only records


head(po) # it contains data for one species (sp4) and the dataset has only presence records!




b1 &lt;- background(r,n=20,method = 'gRandom') # you may specify the bias file (a raster object)

head(b1) # background records generated using gRandom

b2 &lt;- background(r,n=20,method = 'eRandom')

head(b2) # background records generated using eRandom

b3 &lt;- background(r,n=20,method = 'eDist',sp=po)

head(b3) # background records generated using eDist


b4 &lt;- background(r,n=20,method = 'gDist')

head(b4) # background records generated using gDist



## End(Not run)
</code></pre>

<hr>
<h2 id='boxplot'>boxplot</h2><span id='topic+boxplot'></span><span id='topic+boxplot+2CsdmEvaluate-method'></span>

<h3>Description</h3>

<p>Make a box plot of model evaluation data, i.e., the model predictions for known presence and absence points.
</p>


<h3>Details</h3>

<p>Arguments:
</p>
<p><code>x</code> Object of class sdmEvaluate
<code>names</code> Optional, the x-axis label for the group of data (e.g., 'Absence', 'Presence')
<code>...</code> Additional arguments that can be passed to <a href="graphics.html#topic+boxplot">boxplot</a>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


e &lt;- evaluates(x=c(1,1,0,1,0,0,0,1,1,1,0),
          p=c(0.69,0.04,0.05,0.95,0.04,0.65,0.09,0.61,0.75,0.84,0.15))

boxplot(e)

</code></pre>

<hr>
<h2 id='calibration'>Calibration</h2><span id='topic+calibration'></span><span id='topic+calibration+2Cvector+2Cvector-method'></span><span id='topic+calibration+2CsdmEvaluate+2Cmissing-method'></span>

<h3>Description</h3>

<p>evaluates for calibration 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibration(x,p,nbin,weight,...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calibration_+3A_x">x</code></td>
<td>
<p>a numeric vector including the observed values; or a <code>sdmEvaluate</code> object</p>
</td></tr>
<tr><td><code id="calibration_+3A_p">p</code></td>
<td>
<p>a numeric vector including the predicted values</p>
</td></tr>
<tr><td><code id="calibration_+3A_nbin">nbin</code></td>
<td>
<p>number of bins to discretize the predicted values into the specified bins (default: 10); instead, it can be the keyword of 'seek' to ask for seeking the best number </p>
</td></tr>
<tr><td><code id="calibration_+3A_weight">weight</code></td>
<td>
<p>logical, specifies whether a weight should be calculated based on the number of records at each bin. The weight will be used to summarize the calibration statistic</p>
</td></tr>
<tr><td><code id="calibration_+3A_...">...</code></td>
<td>
<p>additional arguments (not implemented yet.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output of this function can be used in the plot function to generate Calibration plot. The calibration statistic is calculated using a method developed by the authors of this package (the journal article is not published yet, but in preparation)
</p>


<h3>Value</h3>

<p>an object of class <code>.sdmCalibration</code> 
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org">https://www.biogeoinformatics.org</a>
</p>


<h3>References</h3>

<p>Naimi, B., Niamir, A., Jimenez-Valverde, A., Araujo, M.B. (In preparation) Measuring calibration capacity of statistical models: a new statistic.
</p>
<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


ca &lt;- calibration(x=c(1,1,0,1,0,0,0,1,1,1,0),
          p=c(0.69,0.04,0.05,0.95,0.04,0.65,0.09,0.61,0.75,0.84,0.15))

ca

plot(ca)


</code></pre>

<hr>
<h2 id='coords'>get or set spatial coordinates of species data</h2><span id='topic+coords'></span><span id='topic+coords+3C-'></span><span id='topic+coords+2Csdmdata-method'></span><span id='topic+coords+2CsdmModels-method'></span><span id='topic+coords+3C-+2Csdmdata-method'></span>

<h3>Description</h3>

<p>Get or set spatial coordiates of a <code>sdmdata</code> object. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'sdmdata'
coords(obj,...)

## S4 replacement method for signature 'sdmdata'
coords(object)&lt;-value

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coords_+3A_obj">obj</code></td>
<td>
<p>speciesData (either of singleSpecies, multiple Species or SpeciesDataList) object</p>
</td></tr>
<tr><td><code id="coords_+3A_object">object</code></td>
<td>
<p>same as obj</p>
</td></tr>
<tr><td><code id="coords_+3A_value">value</code></td>
<td>
<p>spatial coordinates either a matrix, or data.frame, or as character to change the names of coordinates</p>
</td></tr>
<tr><td><code id="coords_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix, or if the coordinates set, the <code>sdmdata</code> object is returned.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("external/data.sdd", package="sdm")
d &lt;- read.sdm(file)

d # a sdmdata object

coords(d)

</code></pre>

<hr>
<h2 id='density'>density</h2><span id='topic+density'></span><span id='topic+density+2CsdmEvaluate-method'></span>

<h3>Description</h3>

<p>Create a density plots of presence and absence data
</p>


<h3>Value</h3>

<p>A density plot. Presence data are in darkblue, and absence data are in red.
</p>


<h3>Methods</h3>


<p><code>density(x, ...)</code>
</p>

<table>
<tr>
 <td style="text-align: right;">  
 </td><td style="text-align: left;">  <code>x</code>  </td><td style="text-align: left;">  Object of class 'sdmEvaluate' (or a numeric vector of observed presence/absence)  </td>
</tr>
<tr>
 <td style="text-align: right;">
 
</td>
</tr>

</table>




<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


e &lt;- evaluates(x=c(1,1,0,1,0,0,0,1,1,1,0),
          p=c(0.69,0.04,0.05,0.95,0.04,0.65,0.09,0.61,0.75,0.84,0.15))


density(e)


</code></pre>

<hr>
<h2 id='ensemble'>Ensemble Forecasting of SDMs</h2><span id='topic+ensemble'></span><span id='topic+ensemble+2CsdmModels-method'></span><span id='topic+ensemble+2CsdmModels+2CRaster-method'></span><span id='topic+ensemble+2CsdmModels+2CSpatRaster-method'></span><span id='topic+ensemble+2CsdmModels+2Cdata.frame-method'></span>

<h3>Description</h3>

<p>Make a Raster object with a weighted averaging over all predictions from several fitted model in a sdmModel object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'sdmModels'
ensemble(x, newdata, filename="",setting,overwrite=FALSE,pFilename="",...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ensemble_+3A_x">x</code></td>
<td>
<p>a sdmModels object</p>
</td></tr>
<tr><td><code id="ensemble_+3A_newdata">newdata</code></td>
<td>
<p>raster object or data.frame, can be either predictors or the results of the <code>predict</code> function</p>
</td></tr>
<tr><td><code id="ensemble_+3A_filename">filename</code></td>
<td>
<p>optional character, output file name (if newdata is raster object)</p>
</td></tr>
<tr><td><code id="ensemble_+3A_setting">setting</code></td>
<td>
<p>list, contains the parameters that are used in the ensemble procedure; see details</p>
</td></tr>
<tr><td><code id="ensemble_+3A_overwrite">overwrite</code></td>
<td>
<p>logical, whether existing filename is overwritten (if exists and filename is given) </p>
</td></tr>
<tr><td><code id="ensemble_+3A_pfilename">pFilename</code></td>
<td>
<p>it is ignored if newdata is the output of <code>predict</code>, otherwise, since the ensemble first call <code>predict</code>, it specifies the filename to write the output of <code>predict (if newdata is raster) </code></p>
</td></tr>
<tr><td><code id="ensemble_+3A_...">...</code></td>
<td>
<p>additional arguments pass to the <code>writeRaster</code> function (if used)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ensemble function uses the fitted models in an <code>sdmModels</code> object to generate an ensemble/consensus of predictions by multiple individual models. Several <code>ensemble</code> methods are available and can be defined in the setting argument.
</p>
<p>A list of settings can be introduced in the <code>setting</code> argument including:
</p>
<p>- <code>method</code>: a character vector specifies which ensemble method(s) should be employed (multiple choice is possible). The details about the available methods are provided at the end of this page.
</p>
<p>- <code>stat</code>: if the - <code>method='weighted'</code> is used, it specifies which evaluation metrics can be used as weight in the weighted averaging procedure. Alternatively, one may directly introduce weights (see the next argument).
</p>
<p>- <code>weights</code>: an optional numeric vector (with a length equal to the models that are successfully fitted) to specify the weights for weighted averaging procedure (if the method='weighted' is specified).
</p>
<p>- <code>id</code>: specifies the model IDs that should be considered in the ensemble procedure. If missing, all the models that are successfully fitted are considered.
</p>
<p>- <code>expr</code>: A character or an expression specifies a condition to select models for the ensemble procedure. For example: <code>expr='auc &gt; 0.7'</code> only use models with AUC accuracy greater than 0.7. OR  <code>expr='auc &gt; 0.7 &amp; tss &gt; 0.5'</code> subsets models based on both AUC and TSS metrics.
</p>
<p>- <code>wtest</code>: specifies which test dataset (&quot;training&quot;,&quot;test.dep&quot;,&quot;test.indep&quot;) should be used to extract the statistic (stat) values as weights (if a relevant method is specified)
</p>
<p>- <code>opt</code>: if a thershold_based metric is used in  is selected in <code>stat</code> or in <code>expr</code>, <code>opt</code> specifies the threshold selection criterion. The possible value can be between 1 to 14 for <code>"sp=se", "max(se+sp)", "min(cost)", "minROCdist", "max(kappa)", "max(ppv+npv)", "ppv=npv", "max(NMI)", "max(ccr)", "prevalence", "P10", "P5", "P1", "P0"</code> criteria, respectively.
</p>
<p>- <code>power</code>: default: 1, a numeric value to which the weights are raised. Greater value than 1 affects weighting scheme (for the methods e.g., &quot;weighted&quot;) to increase the weights for the models with greater weight. For example, if weights are c(0.2,0.2,0.2,0.4), raising them to power 2 would be resulted to new weights as c(0.1428571,0.1428571, 0.1428571, 0.5714286) that causes greater contribution of the models with  greater performances to the ensemble output.
</p>
<p>&mdash;&gt; The available ensemble methods (to be specified in <code>method</code>) include:
</p>
<p>&ndash; 'unweighted': unweighted averaging/mean.
</p>
<p>&ndash; 'weighted': weighted averaging.
</p>
<p>&ndash; 'median': median.
</p>
<p>&ndash; 'pa': mean of predicted presence-absence values (predicted probabilities are first converted to presence-absence given a threshold (<code>opt</code> defines which threshold optimisation strategy should be used), then they are averaged).
</p>
<p>&ndash; 'mean-weighted': A two step averaging, that can be used when several replications are available for each modelling methods (e.g., fitted through bootstrapping or cross-validation resampling); it first takes an unweighted mean over the predicted values of multiple replications for each method (within model averaging), then a weighted mean is employed to combine the probabilities of different methods (between models averaging).
</p>
<p>&ndash; 'mean-unweighted': Same as the previous one, but an unweighted mean is also used for the second step (instead of weighted mean).
</p>
<p>&ndash; 'median-weighted': Same as the 'mean-weighted, but the median is used in the first step.
</p>
<p>&ndash; 'median-unweighted': another two-step method, median is used for the first step and unweighted mean is used for the second step.
</p>
<p>&mdash;-&gt; in addition to tne ensemble methods, some other methods are available to generate some outputs that can represent uncertainty:
</p>
<p>&ndash; 'uncertainty' or 'entropy': this method generates the uncertainty among the models' predictions that can be interpreted as model-based uncertainty or inconsistency among different models. It ranges between 0 and 1, 0 means all the models predicted the same value (either presence or absence), and 1 referes to maximum uncertainy, e.g., half of the models predicted presence (or absence) and the other half predicted the oposite value.
</p>
<p>&ndash; 'cv': Coefficient of variation of probabilities generated from multiple models
</p>
<p>&ndash; 'stdev': Standard deviation of probabilities generated from multiple models
</p>
<p>&ndash; 'ci': This generates confidence interval length (marginal error) which assigns the difference between upper and lower limits of confidence interval to each pixel (upper - lower). The default level of confidence interval is 95% (i.e., <code>alpha = 0.05</code>), unless a different <code>alpha</code> is defined in <code>setting</code>. In case two separate upper and lower rasters are needed, by using the following codes, the upper and lower limits can be calculated:
</p>
<p><code>en &lt;- ensemble(x, newdata, setting=list(method=c('mean','ci')))</code> # taking unweighted averaging and ci
</p>
<p># en[[1]] is the mean of all probabilities and en[[2]] is the ci
<code>ci.upper &lt;- en[[1]] + en[[2]] / 2</code> # adding marginal error (half of the generated ci) to mean
<code>ci.lower &lt;- en[[1]] - en[[2]] / 2</code> # subtracting marginal error from mean
</p>
<p><code>plot(ci.upper,main='Upper limit of Confidence Interval - alpha = 0.05')</code>
</p>
<p><code>plot(ci.lower,main='Lower limit of Confidence Interval - alpha = 0.05')</code>
</p>


<h3>Value</h3>

<p>- a Raster object if <code>predictors</code> is a Raster object
</p>
<p>- a numeric vector (or a data.frame) if <code>predictors</code> is a data.frame object
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>See Also</h3>

<p># </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 


file &lt;- system.file("external/species.shp", package="sdm") # get the location of the species data

species &lt;- vect(file) # read the shapefile

path &lt;- system.file("external", package="sdm") # path to the folder contains the data

lst &lt;- list.files(path=path,pattern='asc$',full.names = T) # list the name of the raster files 


# stack is a function in the raster package, to read/create a multi-layers raster dataset
preds &lt;- rast(lst) # making a raster object

d &lt;- sdmData(formula=Occurrence~., train=species, predictors=preds)

d

# fit the models (5 methods, and 10 replications using bootstrapping procedure):
m &lt;- sdm(Occurrence~.,data=d,methods=c('rf','tree','fda','mars','svm'),
          replicatin='boot',n=10)
    
# ensemble using weighted averaging based on AUC statistic:    
p1 &lt;- ensemble(m, newdata=preds, filename='ens.img',setting=list(method='weighted',stat='AUC'))
plot(p1)

# ensemble using weighted averaging based on TSS statistic
# and optimum threshold critesion 2 (i.e., Max(spe+sen)) :    
p2 &lt;- ensemble(m, newdata=preds, filename='ens2.img',setting=list(method='weighted',
                                                                  stat='TSS',opt=2))
plot(p2)


## End(Not run)


</code></pre>

<hr>
<h2 id='evaluates'>evaluate for accuracy</h2><span id='topic+evaluates'></span><span id='topic+getEvaluation'></span><span id='topic+getReplication'></span><span id='topic+evaluates+2Cvector+2Cvector-method'></span><span id='topic+evaluates+2Csdmdata+2CRasterLayer-method'></span><span id='topic+evaluates+2Csdmdata+2CSpatRaster-method'></span><span id='topic+evaluates+2CsdmModels+2CSpatRaster-method'></span><span id='topic+evaluates+2CsdmModels+2Cmissing-method'></span><span id='topic+getEvaluation+2CsdmModels-method'></span><span id='topic+getReplication+2CsdmModels-method'></span><span id='topic+show+2CsdmEvaluate-method'></span>

<h3>Description</h3>

<p>evaluates for accuracy 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluates(x,p,...)

getEvaluation(x,id,wtest,stat,opt,...)

getReplication(x,id,replication,species,run,index,test)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluates_+3A_x">x</code></td>
<td>
<p>a numeric vector or a <code>sdmdata</code> object including the observed values; a <code>sdmModels</code> object in <code>getEvaluation</code></p>
</td></tr>
<tr><td><code id="evaluates_+3A_p">p</code></td>
<td>
<p>a numeric vector or a <code>RasterLayer</code> including the predicted values</p>
</td></tr>
<tr><td><code id="evaluates_+3A_id">id</code></td>
<td>
<p>a single numeric value indicates the modelID</p>
</td></tr>
<tr><td><code id="evaluates_+3A_wtest">wtest</code></td>
<td>
<p>which test data should be used: &quot;training&quot;, &quot;test.dep&quot;, or &quot;test.indep&quot;?</p>
</td></tr>
<tr><td><code id="evaluates_+3A_stat">stat</code></td>
<td>
<p>statistics that should be extracted from the <code>sdmEvaluate</code> object</p>
</td></tr>
<tr><td><code id="evaluates_+3A_opt">opt</code></td>
<td>
<p>a numeric value indicates which threshold optimisation criteria should be considered if a threshold-based statistic is selected in stat</p>
</td></tr>
<tr><td><code id="evaluates_+3A_species">species</code></td>
<td>
<p>optional; a character vector specifies the name of species for which the replication is returned (default is NULL)</p>
</td></tr>
<tr><td><code id="evaluates_+3A_replication">replication</code></td>
<td>
<p>a character specifies the name of the replication method</p>
</td></tr>
<tr><td><code id="evaluates_+3A_run">run</code></td>
<td>
<p>a single numeric value specifies the replication ID</p>
</td></tr>
<tr><td><code id="evaluates_+3A_index">index</code></td>
<td>
<p>logical (default: FALSE); specifies whether the index or species data of drawn records should be returned</p>
</td></tr>
<tr><td><code id="evaluates_+3A_test">test</code></td>
<td>
<p>logical (default: TRUE); specifies whether the test partition should be returned or training partition</p>
</td></tr>
<tr><td><code id="evaluates_+3A_...">...</code></td>
<td>
<p>additional arguments (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Evaluates the preformance (accuracy) given the obsetved values, and the predicted values. As additional argument, the distribution of data can be specified (through <code>distribution</code>), that can be either of <code>'binomial'</code>, <code>'gaussian'</code>, <code>'laplase'</code>, or <code>'poisson'</code>. If not specified, it will be guessed by the function!
</p>
<p><code>getEvaluation</code> can be used to get the evaluation results from a fitted model (<code>sdmModels</code> object that is output of the <code>sdm</code> function). Each model in <code>sdmModels</code> has a modelID, that can be specified in <code>w</code> argument. If <code>w</code> is not specified or more than a modelID is specified, then a data.frame is generated that contains the statistics specified in <code>stat</code>. For a single model (if length <code>w</code> is 1), <code>stat</code> can be 1 (threhold_independent statistics), or 2 (threshold_based statistics) or NULL (both groups). If more than a model is specified (<code>w</code> is either NULL or has a length greater than 1), stat can be the name of statistics such as <code>'AUC', 'COR', 'Deviance', 'obs.prevalence', 'threshold', 'sensitivity', 'specificity', 'TSS','MCC', 'Kappa', 'NMI', 'phi', 'ppv', 'npv', 'ccr', 'prevalence'</code>. 
If either of the thershold_based stats are selected, <code>opt</code> can be also specified to select one of the criteria for optimising the threshold. The possible value can be between 1 to 15 for <code>"sp=se", "max(se+sp)", "min(cost)", "minROCdist", "max(kappa)", "max(ppv+npv)", "ppv=npv", "max(NMI)", "max(ccr)", "prevalence", "max(MCC)", "P10", "P5", "P1", "P0"</code> criteria, respectively. P10, P5, P1 refer to 10, 5, and 1 percentile of presence records in the evaluation dataset, respectively for which the suitability value is used as the threshold. By choosing P0, the minimum suitability value across presence records is selected as the threshold.
</p>
<p><code>getReplication</code> returns portion of records randomly selected through data partitioning using one of the replication methods (e.g., 'cv', 'boot', 'sub').
</p>


<h3>Value</h3>

<p>an object of class <code>sdmEvaluate</code> from <code>evaluates</code> function
</p>
<p>a list or data.frame from <code>getEvaluation</code> function
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>


<h3>See Also</h3>

<p># </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/model.sdm", package="sdm")

m &lt;- read.sdm(file) # a sdmModels Object (fitted using sdm function)

getModelInfo(m)

# there are 4 models in the sdmModels objects

# so let's take a look  at all the results for the model with modelID 1

# evaluation using training data (both threshod_independent and threshold_based groups):

getEvaluation(m,w=1,wtest='training') 

getEvaluation(m,w=1,wtest='training',stat=1) # stat=1 (threshold_independent)

getEvaluation(m,w=1,wtest='test.dep',stat=2) # stat=2 (threshold_based)

getEvaluation(m,w=1:3,wtest='test.dep',stat=c('AUC','TSS'),opt=2) 

getEvaluation(m,opt=1) # all models

getEvaluation(m,stat=c('TSS','Kappa','AUC'),opt=1) # all models


############

#example for evaluation:

evaluates(x=c(1,1,0,1,0,0,0,1,1,1,0),
          p=c(0.69,0.04,0.05,0.95,0.04,0.65,0.09,0.61,0.75,0.84,0.15))

##############
# Example for getReplication:


df &lt;- read.csv(file) # load a csv file

head(df)

d &lt;- sdmData(sp~b15+NDVI,train=df) # sdmdata object

d
#----
# fit SDMs using 2 methods and a subsampling replication method with 2 replications:

m &lt;- sdm(sp~b15+NDVI,data=d,methods=c('glmpoly','gbm'), replication='sub', test=30, n=2)

m


# randomly drawn species records for test data in the second replication (run) of subsampling:
getReplication(m, replication='sub',run=2) 

getReplication(m, replication='sub',run=2,test=F) # drawn record in the training partition

ind &lt;- getReplication(m, replication='sub',run=2,index=T) # index of the selected test record 

head(ind)

.df &lt;- as.data.frame(m@data) # convert sdmdata object in the model to data.frame

head(.df)

.df &lt;- .df[.df$rID %in% ind, ] # the full test dataset drawn (second replication)

pr &lt;- predict(m,.df) # predictions of all the methods for the test dataset 



pr &lt;- predict(m,.df) # predictions of all the methods for the test dataset 


head(pr) 

e &lt;- evaluates(.df$sp, pr[,1]) # evaluates for the first method using the selected test data

e@statistics

e@threshold_based



## End(Not run)
</code></pre>

<hr>
<h2 id='Extract+20by+20index'>Indexing to extract records of a sdmdata object</h2><span id='topic++5B+2Csdmdata+2Cmissing+2Cmissing-method'></span><span id='topic++5B+2Csdmdata+2CANY+2CANY-method'></span>

<h3>Description</h3>

<p>This function extracts records of a <code>sdmdata</code> object and generates a new object of the same type (if drop=FALSE; otherwise a data.frame).
In <code>sdmdata</code>, rID is the unique ID for each record.
</p>


<h3>Methods</h3>


<p><code>x[i]</code>
</p>
<p>Arguments
</p>

<table>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>x</code> </td><td style="text-align: left;"> a Raster* object </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>i</code> </td><td style="text-align: left;"> an index: record id (rID) in sdmdata object </td>
</tr>
<tr>
 <td style="text-align: right;">
</td><td style="text-align: left;"> <code>drop</code> </td><td style="text-align: left;">  If <code>TRUE</code>, a <code>data.frame</code> is returned, otherwise a <code>sdmdata</code> object is returned. </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file &lt;- system.file("external/data.sdd", package="sdm")

d &lt;- read.sdm(file)

# see the number of records:
d 
 
d2 &lt;- d[1:10]

d2
 
d3 &lt;- d[1:10,drop=TRUE]
 
d3

</code></pre>

<hr>
<h2 id='featuresFrame-class'>featureFrame class</h2><span id='topic+featuresFrame-class'></span>

<h3>Description</h3>

<p>An S4 class contains the information of features used to fit a model
</p>


<h3>Slots</h3>


<dl>
<dt><code>vars</code></dt><dd><p>A character vector containing the name of variabes from the dataset used to generate the features</p>
</dd>
<dt><code>feature.types</code></dt><dd><p>A list containing the definition of features</p>
</dd>
<dt><code>response.specific</code></dt><dd><p>NULL, or a list containing the definition of features that their definitions are according to the response variable (i.e. species)</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>

<hr>
<h2 id='get+20models+27+20outputs'>Get information/modelIDs relevant to fitted models in a sdmModels object</h2><span id='topic+getModelInfo'></span><span id='topic+getModelInfo+2CsdmModels-method'></span><span id='topic+getModelId'></span><span id='topic+getModelId+2CsdmModels-method'></span><span id='topic+getModelObject'></span><span id='topic+getModelObject+2CsdmModels-method'></span>

<h3>Description</h3>

<p>When SDMs are fitted using the <code><a href="#topic+sdm">sdm</a></code> function, a <code>sdmModels</code> object is generated containing all the information and objects created through fitting and evaluation procedures for all species and methods. To each model, a unique modelID is assigned. <code>getModelInfo</code> returns a data.frame summarising some information relevant to the fitted models including modelID, method name, whether the model is fitted successfully, whether and what replication procedure is used for data partitioning, etc.  <code>getModelInfo</code> helps to get the unique model IDs for all or certain models given the parameters that users specify. <code>getModelObject</code> returns the fitted model object for a single model (specified through <code>id</code>, or other settings).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getModelId(x,success,species,method,replication, run)

getModelInfo(x,...)

getModelObject(x,id,species,method,replication, run)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get+2B20models+2B27+2B20outputs_+3A_x">x</code></td>
<td>
<p>a <code>sdmModel</code> object</p>
</td></tr>
<tr><td><code id="get+2B20models+2B27+2B20outputs_+3A_success">success</code></td>
<td>
<p>logical; specifies whether the info/ids should be returned only for the models that are successfully fitted or not (default is TRUE)</p>
</td></tr>
<tr><td><code id="get+2B20models+2B27+2B20outputs_+3A_species">species</code></td>
<td>
<p>optional; a character vector specifies the name of species for which the info should be returned (default is NULL meaning for all species)</p>
</td></tr>
<tr><td><code id="get+2B20models+2B27+2B20outputs_+3A_method">method</code></td>
<td>
<p>optional; a character vector specifies the name of methods for which the info should be returned (default is NULL meaning for all methods)</p>
</td></tr>
<tr><td><code id="get+2B20models+2B27+2B20outputs_+3A_replication">replication</code></td>
<td>
<p>optional; a character vector specifies the name of replication method for which the info should be returned (default is NULL meaning for all species)</p>
</td></tr>
<tr><td><code id="get+2B20models+2B27+2B20outputs_+3A_run">run</code></td>
<td>
<p>optional; a numeric vector specifies for which replication runs the info should be returned (default is NULL meaning for all runs)</p>
</td></tr>
<tr><td><code id="get+2B20models+2B27+2B20outputs_+3A_id">id</code></td>
<td>
<p>a single numeric value specifying the modelID</p>
</td></tr>
<tr><td><code id="get+2B20models+2B27+2B20outputs_+3A_...">...</code></td>
<td>
<p>additional arguments. see details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>in <code>getModelInfo</code>, as additional arguments, you can use the arguments in the function <code>getModelId</code> to specify which records should be returned.
</p>


<h3>Value</h3>

<p>getModelInfo: data.frame
getModelId: a numeric vector
getModelObject: The fitted model object with a class depending on the method
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>See Also</h3>

<p># </p>


<h3>Examples</h3>

<pre><code class='language-R'>
file &lt;- system.file("external/model.sdm", package="sdm")

m &lt;- read.sdm(file)

getModelInfo(m)

# getModelId(m)

# getModelId(m,method='brt')

obj &lt;- getModelInfo(m, id=3) # obj is the fitted BRT model (through the package of gbm)

class(obj) # The class of the model object

summary(obj)

</code></pre>

<hr>
<h2 id='getVarImp'>variable importance</h2><span id='topic+getVarImp'></span><span id='topic+getVarImp+2CsdmModels-method'></span>

<h3>Description</h3>

<p>Calculates relative importance of different variables in the models using several approaches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getVarImp(x,id,wtest,setting,...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getVarImp_+3A_x">x</code></td>
<td>
<p>sdmModels object</p>
</td></tr>
<tr><td><code id="getVarImp_+3A_id">id</code></td>
<td>
<p>numeric, specify the model (modelID) for which the variable importance values are extracted; OR it can be character with &quot;ensemble&quot; specifying that the variable importance should be calculated based on the ensemble of all the model objects</p>
</td></tr>
<tr><td><code id="getVarImp_+3A_wtest">wtest</code></td>
<td>
<p>specifies which dataset ('training','test.dep','test.indep') should be used (if exist) to calculate the importance of variables </p>
</td></tr>
<tr><td><code id="getVarImp_+3A_setting">setting</code></td>
<td>
<p>an optional list with setting of ensemble function; it is only needed when id = 'ensemble'</p>
</td></tr>
<tr><td><code id="getVarImp_+3A_...">...</code></td>
<td>
<p>additional arguments as for <code>getModelId</code> function including <code>species</code>,<code>method</code>, <code>replication</code>, and <code>run</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>getVarImp</code> function returns an object including different measures of variable importance, and if be put in plot function, a barplot is generated. If the ggplot2 package is installed on your machine, the plot is generated using ggplot (unless you turn gg = FALSE), otherwise, the standard barplot is used.
</p>
<p>if <code>id = "ensemble"</code> is used in the function, the ensemble function is called to calculate the relative variable importance based on the ensemble prediction of all models. <code>setting</code> can be specified as an additional argument that will be passed to the ensemble function so check the <code><a href="#topic+ensemble">ensemble</a></code> function to see how can <code>setting</code> be specified!
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# if m is a sdmModels object (output of the sdm function) then:

getVarImp(m,id=1) # variable importance 

vi &lt;- getVarImp(m,id=1) 

vi

plot(vi,'auc')

plot(vi,'cor')
#############
# You can get Mean variable importance (and confidence interval) for multiple models:

vi &lt;- getVarImp(m,id=1:10) # specify the modelIDs of the models

vi

plot(vi,'cor')
#----
# you can use the getModelId function to find the id of the specific method, replication, etc.
# or you may put the arguments of the getModelId in the getVarImp function:

vi &lt;- getVarImp(m, method='glm') # Mean variable importance for the method glm

vi

plot(vi)
#################

##### Variable Importance based on ENSEMBLE:

# You can get variable importance based on the ensemble of multiple models:

# setting is passed to the ensemble function

vi &lt;- getVarImp(m,id="ensemble",setting=list(method='weighted',stat='auc'))

vi

plot(vi,'cor')

#----------------

# if you want the ensemble based on a subset of models, you can define
# the id within the setting list:

vi &lt;- getVarImp(m,id="ensemble",
        setting=list(method='weighted',stat='auc',id=1:10))

vi

plot(vi,'cor')


plot(vi, gg = F) # R standard plot is used instead of ggplot



## End(Not run)
</code></pre>

<hr>
<h2 id='gui'>Graphical User Interface</h2><span id='topic+gui'></span><span id='topic+gui+2CsdmModels-method'></span>

<h3>Description</h3>

<p>Provides the possibility of using functions in the package through an interactive graphical user interface (GUI). Depending on input, different GUIs are opened.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'sdmModels'
gui(x,...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gui_+3A_x">x</code></td>
<td>
<p>a sdm* object</p>
</td></tr>
<tr><td><code id="gui_+3A_...">...</code></td>
<td>
<p>not implemented yet.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When x is missing, a GUI is opened to facilitate all the steps required to create sdmData, specify the settings for the different steps, and fit sdm models.
Specifying x would be useful to interact with sdm* object. For example, if x is a <code>sdmModels</code> (that is generated by <code>sdm</code> function), a user can interactively explore the results (e.g., to see different plots of model evaluation results).
</p>


<h3>Value</h3>

<p>A HTML page in browser is opened.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/model.sdm", package="sdm")

m &lt;- read.sdm(file) # a sdmModels Object (fitted using sdm function)

m

gui(m)


## End(Not run)

</code></pre>

<hr>
<h2 id='installAll'>install all packages that may be required by the package</h2><span id='topic+installAll'></span><span id='topic+installAll+2CANY-method'></span>

<h3>Description</h3>

<p>This function facilitates to install the required packages that some functions are dependent on in the sdm package. It first checks whether the package is already installed, and if not, it installs the packages. If update=TRUE is used, the packages re-installed if they were already installed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>installAll(pkgs,update,...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="installAll_+3A_pkgs">pkgs</code></td>
<td>
<p>optional. the user provided list of packages (not required for the purpose of this function)</p>
</td></tr>
<tr><td><code id="installAll_+3A_update">update</code></td>
<td>
<p>logical (default=FALSE), specifies whether the packages re-installed if they are already installed on the machine</p>
</td></tr>
<tr><td><code id="installAll_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the <code><a href="utils.html#topic+install.packages">install.packages</a></code> function </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>


<h3>See Also</h3>

<p># </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

installAll()


## End(Not run)
</code></pre>

<hr>
<h2 id='names'>Names of species</h2><span id='topic+names'></span><span id='topic+names+3C-'></span><span id='topic+names+2Csdmdata-method'></span><span id='topic+names+3C-+2Csdmdata-method'></span>

<h3>Description</h3>

<p>Get or set the names of the species of a <code>sdmdata</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'sdmdata'
names(x)

## S4 replacement method for signature 'sdmdata'
names(x)&lt;-value

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="names_+3A_x">x</code></td>
<td>
<p>A sdm data object (<code>sdmdata</code></p>
</td></tr>
<tr><td><code id="names_+3A_value">value</code></td>
<td>
<p>character (vector)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>names</code>, a character
</p>
<p>For <code>names&lt;-</code>, the updated object.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("external/data.sdd", package="sdm")

d &lt;- read.sdm(file)

d

names(d) # returns the names of species
</code></pre>

<hr>
<h2 id='niche'>Generate and plot Ecological Niche</h2><span id='topic+niche'></span><span id='topic+niche+2CRasterStackBrick+2CRasterLayer-method'></span><span id='topic+niche+2CRasterStackBrick+2CSpatialPoints-method'></span><span id='topic+niche+2CRasterStackBrick+2Csdmdata-method'></span><span id='topic+niche+2Csdmdata+2CANY-method'></span><span id='topic+plot+2C.nicheRaster-method'></span><span id='topic+plot+2C.nicheSpatRaster-method'></span><span id='topic+niche+2CSpatRaster+2CSpatRaster-method'></span><span id='topic+niche+2CSpatRaster+2CSpatVector-method'></span><span id='topic+niche+2CSpatRaster+2Csdmdata-method'></span>

<h3>Description</h3>

<p>This function maps the species data (either presence/absence or probability of occurrence/habitat suitability) into a two-dimensional environmental space (i.e., based on two environmental variables) to characterise ecological niche based on the specified environmental variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>niche(x,h,n,.size,plot,out,...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="niche_+3A_x">x</code></td>
<td>
<p>A <code>Raster*</code> object (or sdmdata) containing environmental variables</p>
</td></tr>
<tr><td><code id="niche_+3A_h">h</code></td>
<td>
<p>A <code>RasterLayer</code>, or <code>SpatialPoints</code>, or <code>sdmdata</code> object that represents species data either in the form of habitat suitability (e.g., probability of occurrence) or presence-absence (or even presence-only) data</p>
</td></tr>
<tr><td><code id="niche_+3A_n">n</code></td>
<td>
<p>A character vector specifying the names of environmental variables (two names) that should be used to map the ecological niche; if <code>h</code> is a <code>SpatialPoints</code> or <code>sdmdata</code> object, a third name may be added specifying the species name (e.g., the name of the column in <code>SpatialPointsDataFrame</code> contains species data)</p>
</td></tr>
<tr><td><code id="niche_+3A_.size">.size</code></td>
<td>
<p>optional; a numeric value (default: 1e6) specifies the size of the maximum number of records should be used to generate the ecological niche map; would be useful when the <code>Raster*</code> object introduced in <code>x</code> is big, then a random sample with the specified .size will be drawn based on which the niche is generated</p>
</td></tr>
<tr><td><code id="niche_+3A_plot">plot</code></td>
<td>
<p>logical, specifies whether the generated niche should be plotted</p>
</td></tr>
<tr><td><code id="niche_+3A_out">out</code></td>
<td>
<p>logical, specifies whether the niche should be returned by the function; it will be <code>TRUE</code> if <code>plot</code> is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="niche_+3A_...">...</code></td>
<td>
<p>additional arguments includingthe argument <code>gg</code> (see details) and other arguments that passed to the plot function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As an additional argument, a user may specify <code>gg</code> which is logical, specifies whether the plot should be generated using the ggplot2 package (if the package is installed), otherwise, the raster package is used to generate the plot.
</p>
<p>- <code>...</code>: additional arguments for the <code>plot</code> function (e.g., xlab, ylab, main, col, ...) can be used with the function
</p>


<h3>Value</h3>

<p>an object of class <code>.nicheRaster</code> that contains some information about the environmental variable, and a RasterLayer (100x100) that represents the two-dimensional ecological niche.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

file &lt;- system.file("external/species.shp", package="sdm") # get the location of the species data

species &lt;- vect(file) # read the shapefile

path &lt;- system.file("external", package="sdm") # path to the folder contains the data

lst &lt;- list.files(path=path,pattern='asc$',full.names = T) # list the name of the raster files 


# stack is a function in the raster package, to read/create a multi-layers raster dataset
preds &lt;- rast(lst) # making a raster object

names(preds) # 4 environmental variables are used!

d &lt;- sdmData(formula=Occurrence~., train=species, predictors=preds)

d

# fit models:
m &lt;- sdm(Occurrence~.,data=d,methods=c('rf','glm','brt'))

# ensemble using weighted averaging based on AUC statistic:    
p1 &lt;- ensemble(m, newdata=preds,setting=list(method='weighted',stat='AUC'))
plot(p1, main='Habitat Suitability in Geographic Space')

# Mapping Ecological Niche using selected two variables
niche(x=preds, h=p1, c('precipitation','temperature'))

niche(x=preds, h=p1, c('vegetation','temperature'))

# in case if you do not have the habitat suitability map but species data:

niche(x=preds, h=species, c('vegetation','temperature','Occurrence'))


niche(x=preds, h=d, n=c('vegetation','temperature','Occurrence'), rnd=2) 
# rnd is the argument specifies the decimal degrees to which the values on axis rounded.




## End(Not run)
</code></pre>

<hr>
<h2 id='nicheSimilarity'>Niche Similarity</h2><span id='topic+nicheSimilarity'></span><span id='topic+nicheSimilarity+2CSpatRaster+2CSpatRaster-method'></span><span id='topic+nicheSimilarity+2C.nicheSpatRaster+2C.nicheSpatRaster-method'></span><span id='topic+nicheSimilarity+2CSpatRaster+2Cmissing-method'></span>

<h3>Description</h3>

<p>Compute multiple niche similarity (overlap) statistics between two rasters with probability of occurrence (habitat suitability) values (e.g., outputs of the predict/ensemble functions). The statistics range between 0 (no similarity) and 1 (maximum similarity; identical). The calculations can be done either in geographic space (when x and y are raster maps representing geographical distributions of species) or in environmental (niche) space (when x and y are the output of <code><a href="#topic+niche">niche</a></code> function).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nicheSimilarity(x,y,stat,w,...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nicheSimilarity_+3A_x">x</code></td>
<td>
<p>habitat suitabiliy of the first species in geographic or niche space: a single-layer <code>SpatRaster</code> object (or with two layers if y is missing) containing probability of occurrence; or a .nicheSpatRaster object (the output of the niche function) for the first species</p>
</td></tr>
<tr><td><code id="nicheSimilarity_+3A_y">y</code></td>
<td>
<p>habitat suitabiliy of the second species in geographic or niche space: a <code>SpatRaster</code> object with a single layer containing probability of occurrence, or a .nicheSpatRaster object (the output of the niche function) for the secies species</p>
</td></tr>
<tr><td><code id="nicheSimilarity_+3A_stat">stat</code></td>
<td>
<p>A character vector specifying the names of niche similarity statistics that can be one or multiple items from c(&quot;Imod&quot;,&quot;Icor&quot;,&quot;D&quot;,&quot;O&quot;,&quot;BC&quot;,&quot;R&quot;); &quot;all&quot; (or NULL) for all statistics </p>
</td></tr>
<tr><td><code id="nicheSimilarity_+3A_w">w</code></td>
<td>
<p>Optional, a numeric vector specifying the cell numbers to calculate the niche similarity statistics partially based on specified cells; it can be a single number to specify the number of splits; if not specified, all cells in the rasters are used</p>
</td></tr>
<tr><td><code id="nicheSimilarity_+3A_...">...</code></td>
<td>
<p>not implemented.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Six metrics are implemented to quantify niche overlap (similarity) between two species (or two separate populations of the same species) including:
</p>
<p>- D: Schoener's D
</p>
<p>- Imod: Modified Hellinger distance
</p>
<p>- Icor: Corrected Modified Hellinger distance
</p>
<p>- R: Horn's R
</p>
<p>- O: Pianka's O
</p>
<p>- BC: Bray-Curtis distance
</p>
<p>- COR: Spearman correlation coefficient
</p>
<p>The equations for these metrics are described in Rodder &amp; Engler (2011).
</p>
<p>The probability raster maps (geographic distributions) of the two species can be provided in <code>x</code> and <code>y</code> (so, nlyr(x) = nlyr(y) = 1 should be valid), or both rasters can be provided in <code>x</code>  when <code>y</code> is missing (then, nlyr(x) = 2 should be valid).
</p>
<p>Alternatively, the niche similarity can be calculated in environmental space given the object generated by the <code><a href="#topic+niche">niche</a></code> function for each species. Of course the niche for both species should be generated based on the same set of predictors. Given that the <code><a href="#topic+niche">niche</a></code> function generates the niche raster based on only two predictors, the niche similarity calculation may be repeated for different combinations of predictors, or all the predictor variables can be first transformed and reduced into two components (using priciple component analysis; <code><a href="#topic+pca">pca</a></code>), then the niche for each species can be generated based on the first two components (see example.)
</p>
<p>The metrics can be calculated partially for specific part of the area defined by specifying a vector of cell numbers for that area; for example, the similarity between x and y can be calculated partially only in suitable habitats by specifying which cells located in suitable habitats. It is also possible to specify a single number in w (e.g., w = 2) that divides the area into the specified number of splits based on the range of suitability. For example, if w = 2 and the range of suitability in x and y is between 0 and 1, then the similarity metrics are caclulated for two partial areas, the first is the area with suitability between 0 and 0.5, and the second area has the suitability between 0.5 to 1.
</p>


<h3>Value</h3>

<p>a numeric vector with values of niche similarity for different metrics.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>
<p>Rodder, D., &amp; Engler, J. O. (2011). Quantitative metrics of overlaps in Grinnellian niches: advances and possible drawbacks. Global Ecology and Biogeography, 20(6), 915-927.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

file &lt;- system.file("external/sp1.shp", package="sdm") # get the path to the species data

sp1 &lt;- vect(file) # read the shapefile for species 1

file &lt;- system.file("external/sp2.shp", package="sdm")

sp2 &lt;- vect(file) # read the shapefile for species 2

path &lt;- system.file("external", package="sdm") # path to the folder contains the data

lst &lt;- list.files(path=path,pattern='asc$',full.names = T) # list of predictor filenames

lst

preds &lt;- rast(lst) # making a raster object

names(preds) # 4 environmental variables are used!



d1 &lt;- sdmData(formula=Occurrence~., train=sp1, predictors=preds)

d1

d2 &lt;- sdmData(formula=Occurrence~., train=sp2, predictors=preds)

d2

# fit models for species 1
m1 &lt;- sdm(Occurrence~.,data=d1,methods=c('rf','glm','brt'),
          replication='sub',test.p=30)
m1

# fit models for species 2:
m2 &lt;- sdm(Occurrence~.,data=d2,methods=c('rf','glm','brt'),
          replication='sub',test.p=30)
m2


# ensemble using weighted averaging based on AUC statistic (species 1):    
p1 &lt;- ensemble(m1, newdata=preds,setting=list(method='weighted',stat='AUC'))
plot(p1, main='Habitat Suitability in Geographic Space (species 1)')

# ensemble for species 2:
p2 &lt;- ensemble(m2, newdata=preds,setting=list(method='weighted',stat='AUC'))
plot(p2, main='Habitat Suitability in Geographic Space (species 2)')

# maps together:
plot(c(p1,p2), main=c('species 1','species 2'))


# calculating niche similarity (all metrics) in geographic space:
nicheSimilarity(p1,p2)

nicheSimilarity(p1,p2, stat=c('Icor','Imod'))

######################################

# calculating niche similarity in environmental space:

# Mapping Ecological Niche using selected two variables
n1 &lt;- niche(x=preds, h=p1, c('precipitation','temperature'),out = T)

n2 &lt;- niche(x=preds, h=p2, c('precipitation','temperature'),out=T)

nicheSimilarity(n1,n2)

###################
#### Alternatively, predictors can be transformed to two components using PCA

pc &lt;- pca(preds)

pc


# niche for first species based on the first two components of PCA:
n1 &lt;- niche(pc@data,p1,c("Comp.1","Comp.2"),out=T)

n2 &lt;- niche(pc@data,p2,c("Comp.1","Comp.2"),out=T)


nicheSimilarity(n1,n2)


## End(Not run)
</code></pre>

<hr>
<h2 id='pa'>Converting probability of occurrence to Presence-absence</h2><span id='topic+pa'></span><span id='topic+pa+2CSpatRaster+2CsdmModels-method'></span><span id='topic+pa+2CSpatRaster+2Csdmdata-method'></span><span id='topic+pa+2CSpatRaster+2Cnumeric-method'></span>

<h3>Description</h3>

<p>For many applications, the predicted probability of occurrence (habitat suitability) should be transformed to presence-absence given a threshold which can be selected based on some criteria through model evaluation. <code>pa</code> facilitates this transformation based on either the threshold specified by a user or extracted from the models (or ensemble of the mdoels).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pa(x,y,id,opt,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pa_+3A_x">x</code></td>
<td>
<p>a SpatRaster object contains predicted probability of occurrence generated by the predict or ensemble functions</p>
</td></tr>
<tr><td><code id="pa_+3A_y">y</code></td>
<td>
<p>eithe a sdmModels (outcome of the sdm function) or a numeric vector with threshold values</p>
</td></tr>
<tr><td><code id="pa_+3A_id">id</code></td>
<td>
<p>when <code>y</code> is sdmModels, <code>id</code> can be either a numeric vector specifying the modelIDs corresponding to the layers in <code>x</code>, or a single character &quot;ensemble&quot; to tell the function that the single layer in <code>x</code> is generated from the ensemble function, so the threshold should also be obtained based on ensemble</p>
</td></tr>
<tr><td><code id="pa_+3A_opt">opt</code></td>
<td>
<p>when <code>y</code> is sdmModels, <code>opt</code> specifies the optimisation criterion based on which a threshold is identified; default is opt=2 (see <code><a href="#topic+evaluates">evaluates</a></code> for more details) </p>
</td></tr>
<tr><td><code id="pa_+3A_...">...</code></td>
<td>
<p>not implemented.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>if <code>id</code> is numeric, the number of layers in <code>x</code> (SpatRaster) should be the same as the length of <code>id</code>, but if <code>id = "ensemble"</code>, <code>nlyr(x)</code> should be 1.
</p>


<h3>Value</h3>

<p>a SpatRaster with presence-absence values
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# let's first fit a set of models and generate prediction and ensemble maps:

# get the path to the species data
file &lt;- system.file("external/sp1.shp", package="sdm") 

sp &lt;- vect(file) # read the species records

path &lt;- system.file("external", package="sdm") # path to the folder contains the data

lst &lt;- list.files(path=path,pattern='asc$',full.names = T) # list of predictor filenames

preds &lt;- rast(lst) # making a SpatRaster object (predictors)

d &lt;- sdmData(formula=Occurrence~., train=sp, predictors=preds)

d

# fit two models:
m &lt;- sdm(Occurrence~.,data=d,methods=c('glmp','brt'),replication='boot',n=1)

m 

# predictions:  
pr &lt;- predict(m, newdata=preds)

plot(pr)


# ensemble::    
en &lt;- ensemble(m, newdata=preds,setting=list(method='weighted',stat='AUC'))

plot(en)

#########################
# let's convert probabilities to Presence/absences:


# threshold is extracted for both models based on opt=2 (max[se+sp])
pr.pa &lt;- pa(pr, m, opt=2) 

plot(pr.pa)

# if only one of them was needed:

pr.pa1 &lt;- pa(pr[[1]],m, id=1,opt=2)

plot(pr.pa1)
#---------------
# if you have threshold values, you can directly use them in y:

th &lt;- getEvaluation(m,stat='threshold',opt=1) # get threshold values 

th

pr.pa &lt;- pa(pr, y=th[,2])

plot(pr.pa)
#--------------
# to convert to PA based on "ensemble":

en.pa &lt;- pa(en, m, id="ensemble", opt=2)

plot(en.pa)



## End(Not run)
</code></pre>

<hr>
<h2 id='pca'>Principle Component Analysis</h2><span id='topic+pca'></span><span id='topic+pca+2Csdmdata-method'></span><span id='topic+pca+2Cdata.frame-method'></span><span id='topic+pca+2CRasterStackBrick-method'></span><span id='topic+pca+2CSpatRaster-method'></span><span id='topic+princomp-class'></span>

<h3>Description</h3>

<p>pca performs a principal components analysis (using <code>princomp</code> function from <code>stats</code> package) on the given numeric data matrix and returns the results as an object of class princomp.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'sdmdata'
pca(x,scale,filename,...)

## S4 method for signature 'data.frame'
pca(x,scale,filename,...)

## S4 method for signature 'RasterStackBrick'
pca(x,scale,filename,...)

## S4 method for signature 'SpatRaster'
pca(x,scale,filename,...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pca_+3A_x">x</code></td>
<td>
<p>sdmdata object, or a data.frame, or a Raster (either RasterStackBrick or SpatRaster) object</p>
</td></tr>
<tr><td><code id="pca_+3A_scale">scale</code></td>
<td>
<p>logical; specifies whether the input data should be scaled (by subtracting the variable's mean, then dividing it by its standard deviation)</p>
</td></tr>
<tr><td><code id="pca_+3A_filename">filename</code></td>
<td>
<p>optional character; specifies a filename that should be either a CSV file when <code>x</code> is <code>sdmdata</code> or <code>data.frame</code>, or a Raster file when <code>x</code> is a Raster object</p>
</td></tr>
<tr><td><code id="pca_+3A_...">...</code></td>
<td>
<p>additional arguments pass to <code>princomp</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>pca analysis can be considered as a way to deal with multicollinearity problem and/or reduction of the data dimention. It returns two items in a list including data, and pca. The data contains the transoformed data into priciple components (the number of components is the same as the number of variables in the input data). You can check the pca item to see how many components (e.g., first 3) should be selected (e.g., by checking loadings). For more information on the calculation, see the <code><a href="stats.html#topic+princomp">princomp</a></code> function.
</p>


<h3>Value</h3>

<p>a list including data (a data.frame or a RasterStack depending on the type of x), and pca results (output of the princomp function)
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>filename &lt;- system.file('external/predictors.tif',package='sdm')

r &lt;- rast(filename)

p &lt;- pca(r) # p is a .pcaObject

p

plot(p@pcaObject) # or biplot(p@pcaObject)

plot(p@data)
</code></pre>

<hr>
<h2 id='predict'>sdm model prediction</h2><span id='topic+predict'></span><span id='topic+predict+2CsdmModels-method'></span><span id='topic+predict+2C.maxlikeModel-method'></span>

<h3>Description</h3>

<p>Make a Raster or matrix object (depending on input dataset) with predictions from one or several fitted models in <code>sdmModels</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'sdmModels'
predict(object, newdata, filename="", id=NULL,species=NULL
          ,method=NULL,replication=NULL,run=NULL,mean=FALSE,
          overwrite=TRUE,parallelSetting, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_+3A_object">object</code></td>
<td>
<p>sdmModels object</p>
</td></tr>
<tr><td><code id="predict_+3A_newdata">newdata</code></td>
<td>
<p>SpatRaster object, or data.frame</p>
</td></tr>
<tr><td><code id="predict_+3A_filename">filename</code></td>
<td>
<p>character, output filename, if missing, a name starts with sdm_prediction will be generated</p>
</td></tr>
<tr><td><code id="predict_+3A_id">id</code></td>
<td>
<p>numeric (optional), specifies which model(s) should be used if the object contains several models; with NULL all models are considered</p>
</td></tr>
<tr><td><code id="predict_+3A_species">species</code></td>
<td>
<p>character (optional), specifies which species should be used if the object contains models for multiple species; with NULL all species are used</p>
</td></tr>
<tr><td><code id="predict_+3A_method">method</code></td>
<td>
<p>character, names of fitted models, e.g., glm, brt, etc.</p>
</td></tr>
<tr><td><code id="predict_+3A_replication">replication</code></td>
<td>
<p>character (optional), specifies the names of replication method,if NULL, all available replications are considered</p>
</td></tr>
<tr><td><code id="predict_+3A_run">run</code></td>
<td>
<p>numeric (optional), works if replication with multiple runs are used</p>
</td></tr>
<tr><td><code id="predict_+3A_mean">mean</code></td>
<td>
<p>logical, works if replication with multiple runs are used to fit the models, and specifies whether a mean should be calculated over all predictions of a replication method (e.g., bootstrapping) for each modelling method.</p>
</td></tr>
<tr><td><code id="predict_+3A_overwrite">overwrite</code></td>
<td>
<p>logical, whether the filename should be overwriten it it does exist</p>
</td></tr>
<tr><td><code id="predict_+3A_parallelsetting">parallelSetting</code></td>
<td>
<p>default is NULL; a list contains setting items for parallel processing. The items in parallel setting include: ncore, method, type, hosts, doParallel, fork, and strategy; see details for more information.</p>
</td></tr>
<tr><td><code id="predict_+3A_...">...</code></td>
<td>
<p> additional arguments, as for <code><a href="terra.html#topic+writeRaster">writeRaster</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>predict uses the fitted models in the sdmModels object to generate the predictions given newdata. A SpatRaster object (if the newdata is Raster) or a data.frame (if newdata is data.frame) will be returned.
</p>
<p>The predictions can be generated for some of models in the <code>sdmModels</code> object by specifying <code>id</code> (modelIDs) or explicitely specifying the names of <code>species</code>, or <code>method</code>, <code>replication</code> or <code>run</code> (replications ID). 
</p>
<p>For each prediction, a name is assigned which is an abbreviation representing the names of species, method, replication method, and run (replication ID). If the output is a SpatRaster object, <code><a href="terra.html#topic+metags">metags</a></code> function can be used to get full names of raster layers.
</p>
<p>For parallel processing, a list of items can be passed to <code>parallelSetting</code>, including:
</p>
<p><code>ncore</code>: defines the number of cores (it can also be specified outside of this list
</p>
<p><code>method</code>: defines the parallelising engine. Currently, three options are available including 'parallel', 'foreach', and 'future'. default is 'parallel'
</p>
<p><code>doParallel</code>: Optional, definition to register for a backend for parallel processing (needed when method='foreach'). It should be provided as an R expression like the following example:
</p>
<p>expression(registerDoParallel(parallelSetting@cl))
</p>
<p>The above example is based on the function available in doParallel package. Other packages can also be used to provide and register backend technologies (e.g., doMC)
</p>
<p><code>cluster</code>: Optional; in case a cluster is created and available (e.g., using cl &lt;- parallel::makeCluster(2)), the cluster object can be introduced here to be used as the parallel processing engine, otherwise, it is handled by the sdm package.
</p>
<p><code>hosts</code>: Optional; To use remote machines/clusters in the parallel processing, a character vector with the addresses (names or IPs) of the accessible (on the network) remote clusters can be provided here to be registered and used in parallel processing (still under development so it may not work appropriately!)
</p>
<p><code>fork</code>: Logical, Available for non-windows operating system and specifies whether a fork solution should be used for the parallelisation. Default is TRUE for non-windows OS and FALSE for windows.
</p>
<p><code>strategy</code>: character (default='auto'), specifies the parallelisation strategy that can be either 'data' (split data across multiple parallel cores) or 'model' (predict for different models in parallel); if 'auto' is selected, it is decided by the function depending on the size of dataset and number of models.
</p>
<p>NOTE: Only use parallelSetting when you deal with a big dataset or large number of models otherwise, it make the procedure slower rather than faster if the procedure is quick without parallelising!
</p>


<h3>Value</h3>

<p>a SpatRaster object or data.frame
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>See Also</h3>

<p># </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

file &lt;- system.file("external/species.shp", package="sdm") # get the location of the species data

species &lt;- vect(file) # read the shapefile

path &lt;- system.file("external", package="sdm") # path to the folder contains the data

lst &lt;- list.files(path=path,pattern='asc$',full.names = T) # list the name of the raster files 


# stack is a function in the raster package, to read/create a multi-layers raster dataset
preds &lt;- rast(lst) # making a raster object

d &lt;- sdmData(formula=Occurrence~., train=species, predictors=preds)

d

# fit the models (5 methods, and 10 replications using bootstrapping procedure):
m &lt;- sdm(Occurrence~.,data=d,methods=c('rf','tree','fda','mars','svm'),
          replicatin='boot',n=10)
    
# predict for all the methods and replications:    
p1 &lt;- predict(m, newdata=preds, filename='preds.tif')
plot(p1)

# predict for all the methods but take the mean over all replications for each replication method:
p2 &lt;- predict(m, newdata=preds, filename='preds.img',mean=T)
plot(p2)

# for parallel processing
p3 &lt;- predict(m, newdata=preds, filename='preds.tif',parallelSetting=list(ncore=2))


## End(Not run)
</code></pre>

<hr>
<h2 id='rcurve'>Generate and plot response curves</h2><span id='topic+rcurve'></span><span id='topic+getResponseCurve'></span><span id='topic+rcurve+2CsdmModels-method'></span><span id='topic+rcurve+2C.responseCurve-method'></span><span id='topic+plot+2C.responseCurve-method'></span><span id='topic+getResponseCurve+2CsdmModels-method'></span>

<h3>Description</h3>

<p>Calculate the response of species to the range of values in each predictor variable based on the fitted models in a sdmModels object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcurve(x,n,id,mean,fun,confidence,gg,...)
     
getResponseCurve(x,id,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rcurve_+3A_x">x</code></td>
<td>
<p>A <code>sdmModels</code> object; in the function response, it can be a <code>.responseCurve</code> object which is the output of the <code>getResponse</code> function </p>
</td></tr>
<tr><td><code id="rcurve_+3A_id">id</code></td>
<td>
<p>specifies the modelIDs corresponding to the models in the sdmModels object for which the response curves should be generated</p>
</td></tr>
<tr><td><code id="rcurve_+3A_n">n</code></td>
<td>
<p>A vector with the name of variables for which the response curve should be generated</p>
</td></tr>
<tr><td><code id="rcurve_+3A_mean">mean</code></td>
<td>
<p>logical, specifies whether a mean should be calculated over responses to a variable when multiple models are specified in ids</p>
</td></tr>
<tr><td><code id="rcurve_+3A_fun">fun</code></td>
<td>
<p>character or function, (default=&quot;mean&quot;) specifies what function should be used to calculate the value of the variables over the presence locations (except the variable of interest)</p>
</td></tr>
<tr><td><code id="rcurve_+3A_confidence">confidence</code></td>
<td>
<p>logical, specifies whether a confidence interval should be added to the curve when the mean response curve is calculated based on multiple models</p>
</td></tr>
<tr><td><code id="rcurve_+3A_gg">gg</code></td>
<td>
<p>logical, specifies whether the plot should be generated using the ggplot2 package (if the package is installed)</p>
</td></tr>
<tr><td><code id="rcurve_+3A_...">...</code></td>
<td>
<p>additional arguments passed to plot function</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>getResponseCurve</code> calculates the responses for the models that are specified in <code>id</code> argument, and put the results in a <code>.responseCurve</code> object. This object can be used as an input in the <code>plot</code> function, or <code>rcurve</code> function.
</p>
<p>If you just need the response curve graphs (plots), you can put a <code>sdmModels</code> object directly in the <code>rcurve</code> function, and do not need to first use <code>getResponseCurve</code> function.
</p>
<p>In <code>getResponseCurve</code> function (or in <code>rcurve</code> when <code>x</code> is <code>sdmModels</code>), there are some additional arguments:
</p>
<p>- <code>size</code>: a numeric value; default is 100. Specifies the size of the variable sequence that is used as the x-axis in the response curve plot. Greater number results to a smoother curve.
</p>
<p>- <code>includeTest</code>: a logical value; default is FALSE; when a data object based on which a sdmModels is created containing independent test data; it specifies whether those records should be included into the response curve generation or not.
</p>
<p>- <code>...</code>: additional arguments for the <code>plot</code> function (e.g., xlab, ylab, main, col, lwd, lty)
</p>


<h3>Value</h3>

<p>an object of class <code>.responseCurve</code> or a series of graphs
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/model.sdm", package="sdm")

m &lt;- read.sdm(file) # a sdmModels Object (fitted using sdm function)



rcurve(m)

rcurve(m,id=1) # for the first model

rcurve(m, id=1:2)

rcurve(m,method = 'glm',smooth = T) # only for models fitted using glm method &amp; with smoothed curve



## End(Not run)
</code></pre>

<hr>
<h2 id='read.sdm'>read/write sdm* object from/to a file</h2><span id='topic+read.sdm'></span><span id='topic+read.sdm+2Ccharacter-method'></span><span id='topic+write.sdm'></span><span id='topic+write.sdm+2CsdmModels+2Ccharacter-method'></span><span id='topic+write.sdm+2Csdmdata+2Ccharacter-method'></span><span id='topic+write.sdm+2C.sdmCorSetting+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Read an sdm object from a file, or write it to a file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.sdm(filename,...)

write.sdm(x,filename,overwrite,...)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.sdm_+3A_filename">filename</code></td>
<td>
<p> Filename (character)</p>
</td></tr>
<tr><td><code id="read.sdm_+3A_x">x</code></td>
<td>
<p>a sdm object (e.g., sdmModels,sdmdata or sdmSetting)</p>
</td></tr>
<tr><td><code id="read.sdm_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical. If <code>TRUE</code>, &quot;filename&quot; will be overwritten if it exists (default is <code>FALSE</code>) </p>
</td></tr>
<tr><td><code id="read.sdm_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>read.sdm</code> function reads any files that has been writed by <code>write.sdm</code>.  These functions use <code><a href="base.html#topic+saveRDS">saveRDS</a></code> and <code><a href="base.html#topic+readRDS">readRDS</a></code> to write and read the sdm objects. Additional arguments <code>...</code> pass to these functions. An <code>sdmModels</code> object is saved to a file with an extension of &quot;.sdm&quot;. The file extensions for <code>sdmdata</code> and <code>sdmSetting</code> object are &quot;.sdd&quot;, and &quot;sds&quot;, respectively.
</p>


<h3>Author(s)</h3>

<p>Babak Naimi
</p>
<p><a href="mailto:naimi@r-gis.net">naimi@r-gis.net</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

file &lt;- system.file("external/data.sdd", package="sdm")

d &lt;- read.sdm(file)

d
# can be used to read sdm models (sdmModels) and sdmSettings as well.

write.sdm(d,'dataset') 
# extension is created for data, model and settings as .sdd, .sds, and .sdm respectively.

list.files(pattern='dataset')

## End(Not run)
</code></pre>

<hr>
<h2 id='roc'>plot ROC curves</h2><span id='topic+roc'></span><span id='topic+getRoc'></span><span id='topic+roc+2Cvector+2Cvector-method'></span><span id='topic+roc+2CsdmModels-method'></span><span id='topic+roc+2CsdmModels+2CANY-method'></span><span id='topic+getRoc+2Cvector+2Cvector-method'></span><span id='topic+getRoc+2CsdmModels+2CANY-method'></span>

<h3>Description</h3>

<p>Plot the Receiver Operating Characteristics (ROC) curve with AUC statistic in the legend.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roc(x,p=NULL,species=NULL,method=NULL,replication=NULL,run=NULL,
     wtest=NULL,smooth=FALSE,legend=TRUE,...)
     
getRoc(x,p,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="roc_+3A_x">x</code></td>
<td>
<p>Either <code>sdmModels</code>, or <code>sdmEvaluate</code> object; or a numeric vector including observed binary values of species occurrence</p>
</td></tr>
<tr><td><code id="roc_+3A_p">p</code></td>
<td>
<p>if x is sdmModels, p is an optional vector with model ID number(s) that should be plotted (NULL (default means all models)); if x is a numeric vector, p is a vector with the same length including the predicted values</p>
</td></tr>
<tr><td><code id="roc_+3A_species">species</code></td>
<td>
<p>the name of species should be specified (required if x is <code>sdmModels</code> containing models for several species)</p>
</td></tr>
<tr><td><code id="roc_+3A_method">method</code></td>
<td>
<p>a character vector with the name of modelling methods that one need to get the roc plot for (if NULL  [default], all methods in the object are considered); only if x is <code>sdmModels</code></p>
</td></tr>
<tr><td><code id="roc_+3A_replication">replication</code></td>
<td>
<p>a character vector with the name of replication methods (i.e., 'sub','cv','boot') that one need to get the roc plot for</p>
</td></tr>
<tr><td><code id="roc_+3A_run">run</code></td>
<td>
<p>if x is <code>sdmModels</code>, and the models are fitted through a replication procedure, run specifies which runs of the partitioning (replications) are required; if NULL, all are considered</p>
</td></tr>
<tr><td><code id="roc_+3A_wtest">wtest</code></td>
<td>
<p>evaluation for which test datasets are required, maximum 2 names from 'training', 'test.dep', 'test.indep' (i.e., evaluation for training data, dependent test dataset, and independent test dataset, respectively)</p>
</td></tr>
<tr><td><code id="roc_+3A_smooth">smooth</code></td>
<td>
<p>logical, specified whether the ROC curves should be smoothed through a spline procedure</p>
</td></tr>
<tr><td><code id="roc_+3A_legend">legend</code></td>
<td>
<p>logical, specified whether a legend including AUC statistic is required on the plot</p>
</td></tr>
<tr><td><code id="roc_+3A_...">...</code></td>
<td>
<p>additional arguments passed to plot function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>roc generates the plots of roc curves, and getRoc generate the values of ROC
</p>


<h3>Value</h3>

<p>an object of class <code>matrix</code>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/model.sdm", package="sdm")

m &lt;- read.sdm(file) # a sdmModels Object (fitted using sdm function)

roc(m)

roc(m,1) # for the first model

roc(m, 1:2)

roc(m,method = 'glm',smooth = T) # only for models fitted using glm method &amp; with smoothed curve



## End(Not run)
</code></pre>

<hr>
<h2 id='sdm'>Fit and evaluate species distribution models</h2><span id='topic+sdm'></span><span id='topic+sdm+2CANY+2Csdmdata+2Ccharacter-method'></span><span id='topic+sdm+2Csdmdata+2C.sdmCorSetting+2CANY-method'></span><span id='topic+sdm+2CANY+2Csdmdata+2C.sdmCorSetting-method'></span>

<h3>Description</h3>

<p>Fits sdm for single or multiple species using single or multiple methods specified by a user in <code>methods</code> argument, and evaluates their performance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdm(formula, data, methods,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sdm_+3A_formula">formula</code></td>
<td>
<p>Specifies the structure of the model, types of features, etc.</p>
</td></tr>
<tr><td><code id="sdm_+3A_data">data</code></td>
<td>
<p>a <code>sdmdata</code> object created using <code><a href="#topic+sdmData">sdmData</a></code> function</p>
</td></tr>
<tr><td><code id="sdm_+3A_methods">methods</code></td>
<td>
<p>Character. Specifies the methods, used to fit the models</p>
</td></tr>
<tr><td><code id="sdm_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>sdm fits multiple models and can be used to generate multiple runs (replicates) of each method through partitioning (using one or several partitioning methods including: <code>subsampling</code>, <code>cross-validation</code>, and <code>bootstrapping</code>.
</p>
<p>Each model is evaluated against training data, and if available, splitted data (through partitioning; called dependent test data as well, i.e., &quot;dep.test&quot;) and/or indipendent test data (&quot;indep.test&quot;).
</p>
<p>User should make sure that the methods are available and the required packages for them are installed before putting their names in the function, otherwise, the methods that cannot be run for any reason, are excluded by the function. It is a good practice to call <code><a href="#topic+installAll">installAll</a></code> function (just one time when the sdm is installed), that tries to install all the packages that may be needed somewhere in the <code>sdm</code> package.
</p>
<p>A new method can be adopted and added to the package by a user using <code><a href="#topic+add">add</a></code> function. It is also possible to get an instance of an existing method, override the setting and definition, and then add it with a new name (e.g., my.glm).
</p>
<p>The output would be a single object (<code>sdmModels</code>) that can be read/reproduced everywhere (e.g., on a new machine). A setting object can also be taken (exported) out of the output <code>sdmModels</code> object, that can be used to reproduce the same practice but given new conditions (i.e., new dataset, area. etc.)
</p>
<p>For speed up the model fitting, you may use parallel processing (a high-performance computing solution) by providing a list of items can be passed to <code>parallelSetting</code> argument. The items in the list includes:
</p>
<p><code>ncore</code>: defines the number of cores (it can also be specified outside of this list
</p>
<p><code>method</code>: defines the parallelising engine. Currently, three options are available including 'parallel', 'foreach', and 'future'. default is 'parallel'
</p>
<p><code>doParallel</code>: Optional, definition to register for a backend for parallel processing (needed when method='foreach'). It should be provided as an R expression like the following example:
</p>
<p>expression(registerDoParallel(parallelSetting@cl))
</p>
<p>The above example is based on the function available in doParallel package. Other packages can also be used to provide and register backend technologies (e.g., doMC)
</p>
<p><code>cluster</code>: Optional; in case a cluster is created and available (e.g., using cl &lt;- parallel::makeCluster(2)), the cluster object can be introduced here to be used as the parallel processing engine, otherwise, it is handled by the sdm package.
</p>
<p><code>hosts</code>: Optional; To use remote machines/clusters in the parallel processing, a character vector with the addresses (names or IPs) of the accessible (on the network) remote clusters can be provided here to be registered and used in parallel processing (still under development so it may not work appropriately!)
</p>
<p><code>fork</code>: Logical, Available for non-windows operating system and specifies whether a fork solution should be used for the parallelisation. Default is TRUE for non-windows OS and FALSE for windows.
</p>
<p>NOTE: Only use parallelSetting when you deal with a big dataset or large number of models otherwise, it make the procedure slower rather than faster if the procedure is quick without parallelising!
</p>


<h3>Value</h3>

<p>an object of class <code>sdmModels</code>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/pa_df.csv", package="sdm")

df &lt;- read.csv(file)

head(df) 

d &lt;- sdmData(sp~b15+NDVI,train=df)

d
#----
# Example 1: fit using 3 models, and no evaluation (evaluation based on training dataset):

m &lt;- sdm(sp~b15+NDVI,data=d,methods=c('glm','gam','gbm'))

m

# Example 3: fit using 5 models, and 
# evaluates using 10 runs of subsampling replications taking 30 percent as test:

m &lt;- sdm(sp~b15+NDVI,data=d,methods=c('glm','gam','gbm','svm','rf'),
          replication='sub',test.percent=30,n=10)

m


# Example 3: fits using 5 models, and 
# evaluates using 10 runs of both 5-folds cross-validation and bootsrapping replication methods

m &lt;- sdm(sp~.,data=d,methods=c('gbm','tree','mars','mda','fda'),
          replication=c('cv','boot'),cv.folds=5,n=10)

m

# Example 4: fit using 3 models; evaluate the models using subsampling, 
# and override the default settings for the method brt:

m &lt;- sdm(sp~b15+NDVI,data=d,methods=c('glm','gam','brt'),test.p=30,
          modelSettings=list(brt=list(n.trees=500,train.fraction=0.8)))

m


## End(Not run)

</code></pre>

<hr>
<h2 id='sdmAdapt'>Adapting sdm* objects in the new version</h2><span id='topic+sdmAdapt'></span><span id='topic+sdmAdapt+2Csdmdata-method'></span><span id='topic+sdmAdapt+2CsdmModels-method'></span>

<h3>Description</h3>

<p>The structure of the <code>sdmdata</code> and <code>sdmModels</code> classes were slightly changed in the new version of the package (&gt; 1.2-X). If an <code>sdmdata</code> or <code>sdmModels</code> object is created and saved in an old version of the package (e.g., 1.1-8), using the <code>sdmAdapt</code> function, its structure is modified and adapted to the new version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdmAdapt(x)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sdmAdapt_+3A_x">x</code></td>
<td>
<p>an object of <code>sdmdata</code> or <code>sdmModels</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object with the same class as <code>x</code> 
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>


<h3>See Also</h3>

<p># </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/model.sdm", package="sdm")

m &lt;- read.sdm(file) # an sdmModels Object (fitted using old version of sdm)

m &lt;- sdmAdapt(m)

m




## End(Not run)
</code></pre>

<hr>
<h2 id='sdmCorrelativeMethod-class'>sdmCorrelativeMethod class</h2><span id='topic+sdmCorrelativeMethod-class'></span>

<h3>Description</h3>

<p>An S4 class representing sdm dataset
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>Modelling method name</p>
</dd>
<dt><code>aliases</code></dt><dd><p>Alternative names for the method</p>
</dd>
<dt><code>dataArgument.names</code></dt><dd><p>A list keeps the name of data agruments in both fit and predict functions</p>
</dd>
<dt><code>packages</code></dt><dd><p>The required external package by the method</p>
</dd>
<dt><code>modelTypes</code></dt><dd><p>Specifies whether the model is presence-absence, presence-only, abundance, or multinomial</p>
</dd>
<dt><code>fitParams</code></dt><dd><p>a list of parameters needed by the method</p>
</dd>
<dt><code>fitSettings</code></dt><dd><p>a list of setting parameters for the method</p>
</dd>
<dt><code>settingRules</code></dt><dd><p>a function that adjust the setting parameters according to data</p>
</dd>
<dt><code>fitFunction</code></dt><dd><p>The main function use for fitting the model</p>
</dd>
<dt><code>tuneParams</code></dt><dd><p>a list of parameters to be tuned before the final fitting</p>
</dd>
<dt><code>predictParams</code></dt><dd><p>a list of parameters needed by predict function</p>
</dd>
<dt><code>predictSettings</code></dt><dd><p>a list of setting parameters for prediction</p>
</dd>
<dt><code>predictFunction</code></dt><dd><p>The main predict function</p>
</dd>
<dt><code>metadata</code></dt><dd><p>a metadata object containing the information about who creates the object, date, etc.</p>
</dd>
<dt><code>.temp.env</code></dt><dd><p>an environment object containing the functions defined by a user that is not from a package</p>
</dd>
</dl>

<hr>
<h2 id='sdmData'>creating sdm Data object</h2><span id='topic+sdmData'></span><span id='topic+sdmData+2CANY+2Cdata.frame+2Cmissing-method'></span><span id='topic+sdmData+2Cdata.frame+2Cformula+2Cmissing-method'></span><span id='topic+sdmData+2Cdata.frame+2Cmissing+2Cmissing-method'></span><span id='topic+sdmData+2CANY+2Cdata.frame+2Cmissing+2Cmissing-method'></span><span id='topic+sdmData+2CANY+2CSpatialPoints+2Cmissing-method'></span><span id='topic+sdmData+2CANY+2CSpatialPoints+2CRaster-method'></span><span id='topic+sdmData+2CANY+2CSpatVector+2CSpatRaster-method'></span><span id='topic+sdmData+2CANY+2Cdata.frame+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>Creates an <code>sdmdata</code> object that holds (single or multiple) species records  and explanatory variates. In addition, more information such as spatial coordinates, time, grouping variables, and metadata (e.g., author, date, reference, etc.) can be included.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdmData(formula,train,predictors,test,bg,filename,crs,impute,metadata,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sdmData_+3A_formula">formula</code></td>
<td>
<p>Specifies which species and explanatory variables should be taken from the input data.  Other information (e.g., spatial coordinates, grouping variables, time, etc.) can be determined as well</p>
</td></tr>
<tr><td><code id="sdmData_+3A_train">train</code></td>
<td>
<p>Training data containing species observations as a <code>data.frame</code>, or <code>SpatVector</code>, or <code>SpatialPoints</code>, or <code>SpatialPointsDataFrames</code>. It may contain predictor variables as well</p>
</td></tr>
<tr><td><code id="sdmData_+3A_test">test</code></td>
<td>
<p>Independent test data with the same structure as the train data</p>
</td></tr>
<tr><td><code id="sdmData_+3A_predictors">predictors</code></td>
<td>
<p> explanatory variables (predictors), defined as a raster object (<code>RasterStack</code> or <code>RasterBrick</code> or <code>SpatRaster</code>). Required if train data only contain species records, or background records (pseudo-absences) should be generated</p>
</td></tr>
<tr><td><code id="sdmData_+3A_bg">bg</code></td>
<td>
<p>Background data (pseudo-absence), as a data.frame. It can also be a list contains the settings to generate background data (a Raster object is required in the predictors argument)</p>
</td></tr>
<tr><td><code id="sdmData_+3A_filename">filename</code></td>
<td>
<p>filename of the sdm data object to store in the disk </p>
</td></tr>
<tr><td><code id="sdmData_+3A_crs">crs</code></td>
<td>
<p>optional, coordinate reference system</p>
</td></tr>
<tr><td><code id="sdmData_+3A_impute">impute</code></td>
<td>
<p>logical or character, specifies whether missing values for predictor variables should be imputed. It can be a character specifies imputation method. default is &quot;neighbor&quot;</p>
</td></tr>
<tr><td><code id="sdmData_+3A_metadata">metadata</code></td>
<td>
<p>Additional arguments (optional) that are used to create a metadata object. See details </p>
</td></tr>
<tr><td><code id="sdmData_+3A_...">...</code></td>
<td>
<p>Not implemented yet.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>sdmData creates a data object, for single or multiple species. It can automatically detect the variables containing species data (if a data.frame is provided in <code>train</code>), but it is recommended to use formula through which all species (in the left hand side, e.g., sp1+sp2+sp3 ~ .), and the explanatory variables (in the right hand side) can be determined. If there are additional information such as spatial coordinates, time, or some variables based on which the observation can be grouped, they can be determined in the right hand side of the formula in a flexsible way (e.g., <code>~ . + coords(x+y) + g(var)</code>; This right hand side formula, simply determines all variables (<code>.</code>) + <code>x</code> and <code>y</code> as spatial coordinates + grouping observations based on the variable <code>var</code>; for grouping, the variable (<code>var</code> in this example) should be categorical, i.e., <code>factor</code> ).
</p>
<p>Additional items can be provided as a list in the <code>metadata</code> argument including:
<code>author</code>, <code>website</code>, <code>citation</code>, <code>help</code>, <code>description</code>, <code>date</code>, and <code>license</code>
</p>


<h3>Value</h3>

<p>an object of class <code>sdmdata</code>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example 1: a data.frame containing records for a species (sp) and two predictors (b15 &amp; NDVI):

file &lt;- system.file("external/pa_df.csv", package="sdm")

df &lt;- read.csv(file)

head(df) 

d &lt;- sdmData(sp~b15+NDVI,train=df)

d

# or simply:
d &lt;- sdmData(sp~.,train=df)

d

#--------
# if formula is not specified, function tries to detect species and covariates, it works well only
# if dataset contains no additional columns but species and covariates!

d &lt;- sdmData(train=df)

d

# # only right hand side of the formula is specified (one covariate), so function detects species:
d &lt;- sdmData(~NDVI,train=df) 

d 

#----------
###########
# Example 2: a data.frame containing presence-absence records for 1 species, 4 covariates, and 
# x, y coordinates:

file &lt;- system.file("external/pa_df_with_xy.csv", package="sdm")

df &lt;- read.csv(file)

head(df) 

d &lt;- sdmData(sp~b15+NDVI+categoric1+categoric2+coords(x+y),train=df) 

d
#----
# categoric1 and categoric2 are categorical variables (factors), if not sure the data.frame has 
# them as factor, it can be specified in the formula:
d &lt;- sdmData(sp~b15+NDVI+f(categoric1)+f(categoric2)+coords(x+y),train=df) 

d
# more simple forms of the formula:
d &lt;- sdmData(sp~.+coords(x+y),train=df) 

d

d &lt;- sdmData(~.+coords(x+y),train=df)  # function detects the species

d
##############
# Example 3: a data.frame containing presence-absence records for 10 species:

file &lt;- system.file("external/multi_pa_df.csv", package="sdm")

df &lt;- read.csv(file)

head(df) 

# in the following formula, spatial coordinates columns are specified, and the rest is asked to
# be detected by the function:
d &lt;- sdmData(~.+coords(x+y),train=df)  

d

#--- or it can be customized wich species and which covariates are needed:
d &lt;- sdmData(sp1+sp2+sp3~b15+NDVI+f(categoric1) + coords(x+y),train=df) 

d # 3 species, 3 covariates, and coordinates
# just be careful that if you put "." in the right hand side, while not all species columns or 
# additional columns (e.g., coordinates, time) are specified in the formula, then it takes those
# columns as covariates which is NOT right!

#########
# Example 4: Spatial data:

file &lt;- system.file("external/pa_spatial_points.shp", package="sdm") # path to a shapefile

# use the vect function in terra to read the shapefile:

p &lt;- vect(file)

class(p) # a "SpatVector"

plot(p)

head(p) # it contains data for 3 species

# presence-absence plot for the first species (i.e., sp1)

plot(p[p$sp1 == 1,], col = 'blue', pch=16, main = 'Presence-Absence for sp1')

points(p[p$sp1 == 0,],col='red',pch=16)


# Let's read raster dataset containing predictor variables for this study area:

file &lt;- system.file("external/predictors.tif", package="sdm") # path to a raster object

r &lt;- rast(file)

r # a SpatRaster object including 2 rasters (covariates)

plot(r)

# now, we can use the species points and predictor rasters in sdmData function:

d &lt;- sdmData(sp1 + sp2 + sp3 ~ b15 + NDVI, train = p, predictors = r)

d

##################
# Example 5: presence-only records:


file &lt;- system.file("external/po_spatial_points.shp", package="sdm") # path to a shapefile

po &lt;- vect(file)


head(po) # it contains data for one species (sp4) and the dataset has only presence records!


d &lt;- sdmData(sp4 ~ b15 + NDVI, train = po, predictors = r)

d # as you see in the type, the data is Presence-Only

### we can add another argument (i.e., bg) to generate background (pseudo-absence) records:

#------ in bg, we are going to provide a list containing the setting to generate background
#------ the setting includes n (number of background records), method (the method used for 
#------ background generation; gRandom refers to random in geographic space), and remove (whether 
#------ points located in presence sites should be removed).

d &lt;- sdmData(sp4 ~ b15 + NDVI, train = po, predictors = r, bg = list(n=1000,method = 'gRandom'))

d       # as you see in the type, the data is Presence-Background

# you can alternatively, put a data.frame including background records in bg!

## End(Not run)
</code></pre>

<hr>
<h2 id='sdmdata-class'>An S4 class representing sdm dataset</h2><span id='topic+sdmdata-class'></span><span id='topic+show+2Csdmdata-method'></span>

<h3>Description</h3>

<p>An S4 class representing sdm dataset <code>sdmdata</code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>species.names</code></dt><dd><p>The names of species</p>
</dd>
<dt><code>species</code></dt><dd><p>Contains the species data</p>
</dd>
<dt><code>features.name</code></dt><dd><p>The names of predictor variables</p>
</dd>
<dt><code>features</code></dt><dd><p>A data.frame containing predictor variables</p>
</dd>
<dt><code>factors</code></dt><dd><p>The names of categorical variables (if any)</p>
</dd>
<dt><code>info</code></dt><dd><p>Other information such as coordinates, metadata, etc.</p>
</dd>
<dt><code>groups</code></dt><dd><p>A list including information on groups in the dataset</p>
</dd>
<dt><code>sdmFormula</code></dt><dd><p>An object of class sdmFormula containing the formula and its' terms defined by user</p>
</dd>
<dt><code>errorLog</code></dt><dd><p>Reports on errors in the data raised throgh data cleaning (e.g., NA, duplications, etc.)</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>

<hr>
<h2 id='sdmModels-classes'>sdmModels classes</h2><span id='topic+sdmModels-class'></span><span id='topic+sdmEvaluate-class'></span><span id='topic+sdmFormula-class'></span><span id='topic+listORcharacter-class'></span><span id='topic+characterORnull-class'></span><span id='topic+CRSorNULL-class'></span><span id='topic+formulaORnull-class'></span><span id='topic+numericORnull-class'></span><span id='topic+characterORmissing-class'></span><span id='topic+listORnull-class'></span><span id='topic+functionORnull-class'></span><span id='topic+matrixORnull-class'></span><span id='topic+data.frameORnull-class'></span><span id='topic+functionORcharacter-class'></span><span id='topic+environmentORnull-class'></span><span id='topic+expressionORnull-class'></span><span id='topic+integerORnull-class'></span><span id='topic+data.frameORmatrix-class'></span><span id='topic+.pcaObject-class'></span><span id='topic+show+2CsdmModels-method'></span>

<h3>Description</h3>

<p>An S4 class to keep all the information of fitted models as well as their evaluations.
</p>


<h3>Slots</h3>

<p>Slots for sdmModels objects:
</p>

<dl>
<dt><code>data</code></dt><dd><p>a sdmdata object</p>
</dd>
<dt><code>recordIDs</code></dt><dd><p>Contains the species data</p>
</dd>
<dt><code>setting</code></dt><dd><p>A data.frame containing predictor variables</p>
</dd>
<dt><code>run.info</code></dt><dd><p>a data.frame containing info on runs</p>
</dd>
<dt><code>replicates</code></dt><dd><p>The names of categorical variables (if any)</p>
</dd>
<dt><code>models</code></dt><dd><p>a list contains all fitted objects and relevant information (e.g., evaluation) </p>
</dd>
</dl>
<p><b> Slots for sdmEvaluate objects:</b>
</p>
<dl>
<dt><code>observed</code></dt><dd><p>a numeric vector of observed values</p>
</dd>
<dt><code>predicted</code></dt><dd><p>a numeric vector of predicted values</p>
</dd>
<dt><code>statistics</code></dt><dd><p>a list of threshold-independent statistics</p>
</dd>
<dt><code>threshold_based</code></dt><dd><p>a data.frame of threshold-based statistics</p>
</dd>
</dl>
<p><b> Slots for sdmFormula objects:</b>
</p>
<dl>
<dt><code>formula</code></dt><dd><p>input formula</p>
</dd>
<dt><code>vars</code></dt><dd><p>character, name of variables</p>
</dd>
<dt><code>model.terms</code></dt><dd><p>the formula terms used in model fitting</p>
</dd>
<dt><code>data.terms</code></dt><dd><p>the formula terms used to manipulate data</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Babak Naimi 
</p>
<p><a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>

<hr>
<h2 id='sdmSetting'>creating sdmSetting object</h2><span id='topic+sdmSetting'></span><span id='topic+sdmSetting+2CANY+2Csdmdata+2Ccharacter-method'></span><span id='topic+show+2CsdmSetting-method'></span>

<h3>Description</h3>

<p>Creates sdmSetting object that holds settings to fit and evaluate the models. It can be used to reproduce a study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sdmSetting(formula,data,methods,interaction.depth=1,n=1,replication=NULL,cv.folds=NULL,
     test.percent=NULL,bg=NULL,bg.n=NULL,var.importance=NULL,response.curve=TRUE,
     var.selection=FALSE,modelSettings=NULL,seed=NULL,parallelSetting=NULL,...)


</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sdmSetting_+3A_formula">formula</code></td>
<td>
<p>specify the structure of the model</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_data">data</code></td>
<td>
<p>sdm data object or data.frame including species and feature data</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_methods">methods</code></td>
<td>
<p>character, name of the algorithms</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_interaction.depth">interaction.depth</code></td>
<td>
<p>level of interactions between predictors</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_n">n</code></td>
<td>
<p>number of replicates (run)</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_replication">replication</code></td>
<td>
<p>replication method (e.g., 'subsampling', 'bootstrapping', 'cv')</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_cv.folds">cv.folds</code></td>
<td>
<p>number of folds if cv (cross-validation) is in the selected replication methods</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_test.percent">test.percent</code></td>
<td>
<p>test percentage if subsampling is in the selected replication methods</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_bg">bg</code></td>
<td>
<p>method to generate background</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_bg.n">bg.n</code></td>
<td>
<p>number of background records</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_var.importance">var.importance</code></td>
<td>
<p>logical, whether variable importance should be calculated</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_response.curve">response.curve</code></td>
<td>
<p>method to calculate variable importance</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_var.selection">var.selection</code></td>
<td>
<p>logical, whether variable selection should be considered</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_modelsettings">modelSettings</code></td>
<td>
<p>optional list; settings for modelling methods can be specified by users</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_seed">seed</code></td>
<td>
<p>default is NULL; either logical specify whether a seed for random number generator should be considered, or a numerical to specify the exact seed number</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_parallelsetting">parallelSetting</code></td>
<td>
<p>default is NULL; a list include setting items for parallel processing. The items in parallel setting include: ncore, method, type, hosts, doParallel, and fork; see details for more information.</p>
</td></tr>
<tr><td><code id="sdmSetting_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>using sdmSetting, the feature types, interaction.depth and all settings of the model can be defined. This function generate a sdmSetting object that can be specifically helpful for reproducibility. The object can be shared by a user that may be used for other studies.
</p>
<p>If a user aims to reproduce the same results for every time the code is running with the same data and settings, a seed number should be specified. Through the <code>seed</code> argument, a user can specify <code>NULL</code>, means a seed should not be set (if a random sampling is incorporated in the modelling procedure, for different runs the results would be different); <code>TRUE</code>, means a seed should be set (the seed number is randomly selected and used everytime the same setting is incorporated); <code>a number</code>, means the seed will be set to the number specified by the user. 
</p>
<p>For parallel processing, a list of items can be passed to <code>parallelSetting</code>, including:
</p>
<p><code>ncore</code>: defines the number of cores (it can also be specified outside of this list
</p>
<p><code>method</code>: defines the parallelising engine. Currently, three options are available including 'parallel', 'foreach', and 'future'. default is 'parallel'
</p>
<p><code>doParallel</code>: Optional, definition to register for a backend for parallel processing (needed when method='foreach'). It should be provided as an R expression like the following example:
</p>
<p>expression(registerDoParallel(parallelSetting@cl))
</p>
<p>The above example is based on the function available in doParallel package. Other packages can also be used to provide and register backend technologies (e.g., doMC)
</p>
<p><code>cluster</code>: Optional; in case a cluster is created and available (e.g., using cl &lt;- parallel::makeCluster(2)), the cluster object can be introduced here to be used as the parallel processing engine, otherwise, it is handled by the sdm package.
</p>
<p><code>hosts</code>: Optional; To use remote machines/clusters in the parallel processing, a character vector with the addresses (names or IPs) of the accessible (on the network) remote clusters can be provided here to be registered and used in parallel processing (still under development so it may not work appropriately!)
</p>
<p><code>fork</code>: Logical, Available for non-windows operating system and specifies whether a fork solution should be used for the parallelisation. Default is TRUE for non-windows OS and FALSE for windows.
</p>
<p>NOTE: Only use parallelSetting when you deal with a big dataset or large number of models otherwise, it make the procedure slower rather than faster if the procedure is quick without parallelising!
</p>


<h3>Value</h3>

<p>an object of class <code>sdmSettings</code>
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/pa_df.csv", package="sdm")

df &lt;- read.csv(file)

head(df) 

d &lt;- sdmData(sp~b15+NDVI,train=df)

# generate sdmSettings object:
s &lt;- sdmSetting(sp~., methods=c('glm','gam','brt','svm','rf'),
          replication='sub',test.percent=30,n=10,modelSettings=list(brt=list(n.trees=500)))

s



## End(Not run)
</code></pre>

<hr>
<h2 id='subset'>Subset models in a sdmModels object</h2><span id='topic+subset'></span><span id='topic+subset+2CsdmModels-method'></span><span id='topic++5B+5B+2CsdmModels+2CANY+2CANY-method'></span>

<h3>Description</h3>

<p>This function extracts a subset of models from a <code>sdmModels</code> object. In generates a new object of the same typeas the origical object. In <code>sdmModels</code>, modelID provides the unique IDs.
</p>
<p>Instead of using the <code>subset</code> function, double brackes '[[ ]]' can be used.
</p>


<h3>Details</h3>

<p>#
</p>


<h3>Value</h3>

<p>sdmModels object
</p>


<h3>Methods</h3>


<p><code>subset(x, subset, drop=TRUE, ...)</code>
</p>
<p><code>x[[i,...]]</code>
</p>
<p>Arguments:
</p>
<p><code>x</code> - sdmModels object
</p>
<p><code>i</code>- integer. Indicates the index/id of the models (modelID) should be extracted from sdmModels object
</p>
<p><code>subset</code> -  Same as <code>i</code>
</p>
<p><code>drop</code> - If <code>TRUE</code>, new modelIDs are generated, otherwise, the original modelIDs are kept in the new object.
</p>
<p><code>...</code> - additional arguments (not impplemented yet!)
</p>



<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file &lt;- system.file("external/model.sdm", package="sdm")

m &lt;- read.sdm(file)

m

getModelInfo(m)


m1 &lt;- m[[3:4]]

m1

getModelInfo(m1)

m2 &lt;- m[[3:4,drop=FALSE]]

m2

getModelInfo(m2)

#---- the following is the same as previous:

m2 &lt;- subset(m,3:4,drop=FALSE)

m2

getModelInfo(m2)

## End(Not run) 
</code></pre>

<hr>
<h2 id='threshold'>Identifying/extracting the best threshold to convert probabilities to Presence/Absences</h2><span id='topic+threshold'></span><span id='topic+getThreshold'></span><span id='topic+threshold+2CsdmModels+2Cnumeric-method'></span><span id='topic+threshold+2CsdmModels+2Ccharacter-method'></span><span id='topic+getThreshold+2CsdmModels+2Cnumeric-method'></span><span id='topic+getThreshold+2CsdmModels+2Ccharacter-method'></span>

<h3>Description</h3>

<p>To transform the values of predicted probability of occurrence (habitat suitability) to presence-absences, a threshold is needed. To identify the best threshold, several (15+) optimisation criteria are supported by the package which is calculated for each model in the sdmModels object. To extract the best threshold from each model (given its modelID specified in the <code>id</code> argument), these functions can be used. It is also possible to specify <code>id = "ensemble"</code> to identify the best threshold for the ensemble of models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threshold(x,id,opt,species,...)
getThreshold(x,id,opt,species,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="threshold_+3A_x">x</code></td>
<td>
<p>an sdmModels object (output of the sdmData function)</p>
</td></tr>
<tr><td><code id="threshold_+3A_id">id</code></td>
<td>
<p>can be either a numeric vector specifying the modelIDs corresponding to SDMs in <code>x</code>, or a single character &quot;ensemble&quot; to ask the function to find the best threshold for the ensemble of models</p>
</td></tr>
<tr><td><code id="threshold_+3A_opt">opt</code></td>
<td>
<p>specifies the optimisation criterion based on which a threshold is identified; default is opt=2 (see <code><a href="#topic+evaluates">evaluates</a></code> for more details) </p>
</td></tr>
<tr><td><code id="threshold_+3A_species">species</code></td>
<td>
<p>default=NULL; if the models for multiple species are available in <code>x</code>, <code>species</code> specifies the name of species or a single number specifies which species from the available species should be considered</p>
</td></tr>
<tr><td><code id="threshold_+3A_...">...</code></td>
<td>
<p>if <code>id = "ensemble"</code>, additional arguments are passed to the ensemble function; for example, <code>setting</code> list can be provided for the ensemble function!</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both the <code>threshold</code> and <code>getThreshold</code> functions are the same
</p>


<h3>Value</h3>

<p>a numeric value
</p>


<h3>Author(s)</h3>

<p>Babak Naimi <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://www.r-gis.net/">https://www.r-gis.net/</a>
</p>
<p><a href="https://www.biogeoinformatics.org/">https://www.biogeoinformatics.org/</a>
</p>


<h3>References</h3>

<p>Naimi, B., Araujo, M.B. (2016) sdm: a reproducible and extensible R platform for species distribution modelling, Ecography, 39:368-375, DOI: 10.1111/ecog.01881
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# let's first fit a set of models and generate prediction and ensemble maps:

# get the path to the species data
file &lt;- system.file("external/sp1.shp", package="sdm") 

sp &lt;- vect(file) # read the species records

path &lt;- system.file("external", package="sdm") # path to the folder contains the data

lst &lt;- list.files(path=path,pattern='asc$',full.names = T) # list of predictor filenames

preds &lt;- rast(lst) # making a SpatRaster object (predictors)

d &lt;- sdmData(formula=Occurrence~., train=sp, predictors=preds)

d

# fit two models:
m &lt;- sdm(Occurrence~.,data=d,methods=c('glmp','brt'),replication='boot',n=1)

m 

threshold(m,id=1,opt=1) # get threshold for the first model 

threshold(m,id=1:2,opt=1) # get thresholds for the first and second models

threshold(m,id=1:2,opt=2) # get thresholds for the first and second models

threshold(m,id="ensemble",opt=2) # get threshold based on the ensemble of models


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
