<!DOCTYPE html><html><head><title>Help for package EpiInvert</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EpiInvert}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#apply_delay'><p><code>apply_delay</code></p></a></li>
<li><a href='#EpiIndicators'><p><code>EpiIndicators</code></p></a></li>
<li><a href='#EpiIndicators_params'><p><code>EpiIndicators_params</code> function to select EpiIndicators parameters</p></a></li>
<li><a href='#EpiIndicators_plot'><p><code>EpiIndicators_plot</code></p></a></li>
<li><a href='#EpiInvert'><p><code>EpiInvert</code> estimates the reproduction number Rt and a restored</p>
incidence curve from the original daily incidence curve and the serial
interval distribution. EpiInvert also corrects the festive and weekly biases
present in the registered  daily incidence.</a></li>
<li><a href='#EpiInvert_plot'><p><code>EpiInvert_plot</code></p></a></li>
<li><a href='#EpiInvertForecast'><p><code>EpiInvertForecast</code> computes a 28-day forecast of the restored incidence</p>
curve including a 95
using the weekly seasonality, from the forecasted restored incidence curve we
also estimate a  28-day forecast of the original incidence curve.</a></li>
<li><a href='#EpiInvertForecast_plot'><p><code>EpiInvertForecast_plot</code></p></a></li>
<li><a href='#festives'><p>A dataset containing festive days in  France,</p>
Germany, UK and the USA</a></li>
<li><a href='#incidence'><p>A dataset containing daily incidence of COVID-19 for France,</p>
Germany, UK and the USA</a></li>
<li><a href='#incidence_weekly_aggregated'><p>A dataset containing weekly aggregated incidence of COVID-19 for France,</p>
Germany, UK and the USA</a></li>
<li><a href='#joint_indicators_by_date'><p><code>joint_indicators_by_date</code></p></a></li>
<li><a href='#owid'><p>A dataset with COVID-19 indicators</p></a></li>
<li><a href='#restored_incidence_database'><p>A dataset of restored daily incidence trend curves</p></a></li>
<li><a href='#select_params'><p><code>select_params</code> function to select EpiInvert parameters</p></a></li>
<li><a href='#si_distr_data'><p>A dataset containing the values of a serial interval</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.3.1</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Variational Techniques in Epidemiology</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Luis Alvarez &lt;lalvarez@ulpgc.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Using variational techniques we address some epidemiological
  problems as the incidence curve decomposition by inverting the renewal 
  equation as described in Alvarez et al. (2021) &lt;<a href="https://doi.org/10.1073%2Fpnas.2105112118">doi:10.1073/pnas.2105112118</a>&gt; 
  and Alvarez et al. (2022) &lt;<a href="https://doi.org/10.3390%2Fbiology11040540">doi:10.3390/biology11040540</a>&gt; or the estimation of 
  the functional relationship between epidemiological indicators. We also 
  propose a learning method for the short time forecast of the trend 
  incidence curve  as described in 
  Morel et al. (2022) &lt;<a href="https://doi.org/10.1101%2F2022.11.05.22281904">doi:10.1101/2022.11.05.22281904</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/lalvarezmat/EpiInvert">https://github.com/lalvarezmat/EpiInvert</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.8.3)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, ggplot2, grid, dplyr, testthat (&ge; 3.0.0), rmarkdown,
ggpubr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-10 11:11:45 UTC; lalva</td>
</tr>
<tr>
<td>Author:</td>
<td>Luis Alvarez <a href="https://orcid.org/0000-0002-6953-9587"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Jean-David Morel <a href="https://orcid.org/0000-0002-7122-9924"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Jean-Michel Morel <a href="https://orcid.org/0000-0002-6108-897X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-14 14:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='apply_delay'><code>apply_delay</code></h2><span id='topic+apply_delay'></span>

<h3>Description</h3>

<p>apply a delay vector, s(t), to an indicator, g(t)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_delay(g, s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply_delay_+3A_g">g</code></td>
<td>
<p>indicator.</p>
</td></tr>
<tr><td><code id="apply_delay_+3A_s">s</code></td>
<td>
<p>delay to apply.</p>
</td></tr>
</table>


<h3>Value</h3>

 
<p>A numeric vector with the result of apply the vector delay s to g. 

</p>

<hr>
<h2 id='EpiIndicators'><code>EpiIndicators</code></h2><span id='topic+EpiIndicators'></span>

<h3>Description</h3>

<p>EpiIndicators estimates the ratio, r(t), and shift(delay), s(t), between 2 
epidemiological indicators f(t) and g(t) following the relation 
r(t)*f(t) = g(t+s(t))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EpiIndicators(df, config = EpiIndicators_params())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EpiIndicators_+3A_df">df</code></td>
<td>
<p>a dataframe with 3 columns: the first column corresponds to the date 
of each indicator value, the second column is the value of the first indicator 
f(t) and the third column is the value of the second indicator g(t). A zero 
value is expected in the case that the real value of an indicator is not 
available. Indicators must be smooth functions. So, for instance, the raw 
registered number of cases or deaths are not adequate to run the function. 
These particular indicators should be smoothed before executing EpiIndicators(), 
for instance you can use the restored indicator values obtained  by EpiInvert()</p>
</td></tr>
<tr><td><code id="EpiIndicators_+3A_config">config</code></td>
<td>
<p>a list of the following optional parameters obtained using the 
function EpiIndicators_params(): 
s_min = -10,
</p>

<ul>
<li><p>s_min: min value allowed for the shift s(t) (default value -10)
</p>
</li>
<li><p>s_max: max value allowed for the shift s(t) (default value 25)
</p>
</li>
<li><p>wr: energy regularization parameter for the ratio  r(t) (default value 1000)
</p>
</li>
<li><p>ws: energy regularization parameter for the shift  s(t) (default value 10)
</p>
</li>
<li><p>s_init: manually fixed initial value (at time t=0) for s(t) (default value -1e6)
by default s_init is not fixed and it is automatically estimated 
</p>
</li>
<li><p>s_end: manually fixed final value (at the last time) for s(t) 
(default value -1e6) by default s_end is not fixed and it is automatically 
estimated
</p>
</li>
<li><p>r_init: manually fixed initial value (at time t=0) for r(t) (default value -1e6)
by default r_init is not fixed and it is automatically estimated 
</p>
</li>
<li><p>r_end: manually fixed final value (at the last time) for r(t) 
(default value -1e6) by default r_end is not fixed and it is automatically 
estimated
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>EpiIndicators estimates the ratio, r(t), and shift(delay), s(t) between 2 
epidemiological indicators f(t) and g(t) following the relation 
r(t)*f(t) = g(t+s(t))
a variational method is proposed to add regularity constraints to the 
estimates of r(t) and s(t).
</p>


<h3>Value</h3>


<p>A dataframe with the following columns :
</p>

<ul>
<li><p>date: the date of the indicator values. 
</p>
</li>
<li><p>f: the first indicator f(t).
</p>
</li>
<li><p>g: the second indicator g(t). 
</p>
</li>
<li><p>r: the estimated ratio r(t) 
</p>
</li>
<li><p>s: the estimated shift (delay)  s(t) 
</p>
</li>
<li><p>f.r: the result of r(t)*f(t) 
</p>
</li>
<li><p>g.s: the result of g(t+s(t))
</p>
</li></ul>




<h3>Author(s)</h3>

<p>Luis Alvarez <a href="mailto:lalvarez@ulpgc.es">lalvarez@ulpgc.es</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data of epidemiological indicators obtained from the World in data
## organization
data("owid")

## Filter the data to get France epidemiological indicators
library(dplyr)
sel &lt;- filter(owid,iso_code=="FRA")

## Generate a dataframe with the dates and the cases and deaths restored 
## using EpiInvert()
df&lt;-data.frame(sel$date,sel$new_cases_restored_EpiInvert,sel$new_deaths_restored_EpiInvert)

## Run EpiIndicators
res &lt;- EpiIndicators(df)

## Plot the results 
EpiIndicators_plot(res)

</code></pre>

<hr>
<h2 id='EpiIndicators_params'><code>EpiIndicators_params</code> function to select EpiIndicators parameters</h2><span id='topic+EpiIndicators_params'></span>

<h3>Description</h3>

<p><code>EpiIndicators_params</code> function to select EpiIndicators parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EpiIndicators_params(x = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EpiIndicators_params_+3A_x">x</code></td>
<td>
<p>a list with parameters of EpiIndicators() function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the EpiIndicators() parameters
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EpiIndicators">EpiIndicators</a></code>
</p>

<hr>
<h2 id='EpiIndicators_plot'><code>EpiIndicators_plot</code></h2><span id='topic+EpiIndicators_plot'></span>

<h3>Description</h3>

<p>EpiIndicators_plot() plots the results obtained by EpiIndicators()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EpiIndicators_plot(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EpiIndicators_plot_+3A_df">df</code></td>
<td>
<p>: a dataframe obtained as the outcome of executing EpiIndicators()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a combination of 3 plots: (A) the indicator f(t) (in green in the main
y-axis) and the indicator g(t) (in red in the secondary axis). (B) r(t)*f(t) 
(in green in the main y-axis) and g(t+s(t)) (in red in the secondary axis) and  
(C) r(t) (in green in the main y-axis) and s(t) (in red in the secondary axis)
</p>

<hr>
<h2 id='EpiInvert'><code>EpiInvert</code> estimates the reproduction number Rt and a restored 
incidence curve from the original daily incidence curve and the serial 
interval distribution. EpiInvert also corrects the festive and weekly biases 
present in the registered  daily incidence.</h2><span id='topic+EpiInvert'></span>

<h3>Description</h3>

<p><code>EpiInvert</code> estimates the reproduction number Rt and a restored 
incidence curve from the original daily incidence curve and the serial 
interval distribution. EpiInvert also corrects the festive and weekly biases 
present in the registered  daily incidence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EpiInvert(
  incid,
  last_incidence_date,
  festive_days = rep("1000-01-01", 2),
  config = EpiInvert::select_params()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EpiInvert_+3A_incid">incid</code></td>
<td>
<p>The original daily incidence curve (a numeric vector).</p>
</td></tr>
<tr><td><code id="EpiInvert_+3A_last_incidence_date">last_incidence_date</code></td>
<td>
<p>The date of the last value of the incidence curve
in the format YYYY-MM-DD. EpiInvert does not 
allow missing values. On days when a country does not report data, a zero must
be registered as the value associated with the incidence of that day.</p>
</td></tr>
<tr><td><code id="EpiInvert_+3A_festive_days">festive_days</code></td>
<td>
<p>The festive or anomalous dates in the format YYYY-MM-DD 
(a character vector). In these dates we &quot;a priori&quot; expect that the incidence
value is perturbed.</p>
</td></tr>
<tr><td><code id="EpiInvert_+3A_config">config</code></td>
<td>
<p>An object of class <code>estimate_R_config</code>, as returned by 
function <code>select_params</code>. The element of config are : 
</p>

<ul>
<li><p>si_distr: a numeric vector with the distribution of the serial 
interval (the default value is an empty vector). If this vector is empty, 
the serial interval is estimated using a parametric shifted log-normal. 
</p>
</li>
<li><p>shift_si_distr: shift of the above user provided serial interval. 
This shift can be negative, which means that secondary cases can show 
symptoms before the primary cases (the default value is 0). 
</p>
</li>
<li><p>max_time_interval: Maximum number of days used by 
EpiInvert (the default value is 150, which means that EpiInvert uses the 
last 150 days. The computational cost strongly depends on this value). 
</p>
</li>
<li><p>mean_si: mean of the parametric shifted log-normal to approximate
the serial interval (in the case the above si_distr vector is empty),
(the default value is 12.267893). 
</p>
</li>
<li><p>sd_si: standard deviation of the parametric shifted log-normal to 
approximate the serial interval (in the case the above si_distr vector is empty),
(the default value is  5.667547). 
</p>
</li>
<li><p>shift_si=: shift of the parametric shifted log-normal to approximate
the serial interval (in the case the above si_distr vector is empty),
(the default value is -5). 
</p>
</li>
<li><p>Rt_regularization_weight: regularization weight for Rt in the 
variational model used by EpiInvert (the default value is 5). 
</p>
</li>
<li><p>seasonality_regularization_weight: regularization weight for the 
weekly bias correction factors in the variational model used by EpiInvert (the default value is 5).
</p>
</li>
<li><p>incidence_weekly_aggregated: a boolean value which determines if we use weekly aggregated 
incidence. In such case  every week a single data is stored with the accumulated incidence in the last 
7 days (the default value is FALSE).
</p>
</li>
<li><p>NweeksToKeepIncidenceSum: number of weeks to keep the value of the incidence accumulation. 
The default is 2.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>EpiInvert estimates the reproduction number Rt and a 
restored incidence curve by inverting the renewal equation : 
</p>
<p style="text-align: center;"><code class="reqn">{i(t) = \sum_k i(t-k)R(t-k)\Phi(k)}</code>
</p>

<p>using a variational 
formulation. The theoretical foundations of the method can be found 
in references [1] and [2].
</p>


<h3>Value</h3>


<p>an object of class <code>estimate_EpiInvert</code>, given by a list with 
components:
</p>

<ul>
<li><p>i_original: the original daily incidence curve. In the case of weekly aggregated incidence, 
we initialize the original curve assigning each day of the week 1/7 of the weekly aggregated value.
</p>
</li>
<li><p>i_festive: the incidence after correction of the festive days bias.
</p>
</li>
<li><p>i_bias_free: the incidence after correction of the festive and 
weekly biases.
</p>
</li>
<li><p>i_restored: the restored incidence obtained using the renewal 
equation.
</p>
</li>
<li><p>Rt: the reproduction number Rt obtained by inverting the renewal 
equation.
</p>
</li>
<li><p>Rt_CI95: 95% confidence interval radius for the value of Rt taking 
into account the variation of Rt when more days are added to the estimation. 

</p>
</li>
<li><p>seasonality: the weekly bias correction factors.
</p>
</li>
<li><p>dates: a vector of dates corresponding to the incidence curve. 
</p>
</li>
<li><p>festive: boolean associated to each incidence value to check if it 
has been considered as a festive or anomalous day. 
</p>
</li>
<li><p>epsilon: normalized error curve obtained as 
(i_bias_free-i_restored)/i_restored^a.
</p>
</li>
<li><p>power_a: the power, a, which appears in the above expression of the 
normalized error. 
</p>
</li>
<li><p>si_distr: values of the distribution of the serial interval used in
the EpiInvert estimation.
</p>
</li>
<li><p>shift_si_distr: shift of the above distribution of the serial 
interval si_distr.
</p>
</li></ul>




<h3>Author(s)</h3>

<p>Luis Alvarez <a href="mailto:lalvarez@ulpgc.es">lalvarez@ulpgc.es</a>
</p>


<h3>References</h3>


<p>[1] Alvarez, L.; Colom, M.; Morel, J.D.; Morel, J.M. Computing the daily 
reproduction number of COVID-19 by inverting the renewal
equation using a variational technique. Proc. Natl. Acad. Sci. USA, 2021.
</p>
<p>[2] Alvarez, Luis, Jean-David Morel, and Jean-Michel Morel. &quot;Modeling 
COVID-19 Incidence by the Renewal Equation after Removal of Administrative 
Bias and Noise&quot; Biology 11, no. 4: 540. 2022. 
</p>
<p>[3] Ritchie, H. et al. Coronavirus Pandemic (COVID-19), OurWorldInData.org. 
Available online: 
https://ourworldindata.org/coronavirus-source-data 
(accessed on 5 May 2022).
</p>



<h3>Examples</h3>

<pre><code class='language-R'>## load data on COVID-19 daily incidence up to 2022-05-05 for France, 
## and Germany (taken from the official government data) and for UK and 
## the USA taken from reference [3]
data(incidence)

## EpiInvert execution for USA with no festive days specification
## using the incidence 70 days in the past
res &lt;- EpiInvert(incidence$USA,
"2022-05-05",
"1000-01-01",
select_params(list(max_time_interval = 70))
)

## Plot of the results
EpiInvert_plot(res)

## load data of festive days for France, Germany, UK and the USA
data(festives)

## EpiInvert execution for France with festive days specification using
## 70 days in the past 
res &lt;- EpiInvert(incidence$FRA,"2022-05-05",festives$FRA,
                 select_params(list(max_time_interval = 70)))

## Plot of the incidence between "2022-04-01" and "2022-05-01"
EpiInvert_plot(res,"incid","2022-04-01","2022-05-01")

## load data of a serial interval
data("si_distr_data")

## EpiInvert execution for Germany using the uploaded serial interval shifted
## -2 days, using the incidence 70 days in the past
res &lt;- EpiInvert(incidence$DEU,"2022-05-05",festives$DEU,
       EpiInvert::select_params(list(si_distr = si_distr_data,
       shift_si_distr=-2,max_time_interval = 70)))
       
## Plot of the serial interval used (including the shift)
EpiInvert_plot(res,"SI")     
       
## EpiInvert execution for UK changing the default values of the parametric
## serial interval (using a shifted log-normal) using 70 days in the past
res &lt;- EpiInvert(incidence$UK,"2022-05-05",festives$UK,
       EpiInvert::select_params(list(mean_si = 11,sd_si=6,shift_si=-1,max_time_interval = 70))
       )
       
## Plot of the reproduction number Rt including an empiric 95\% confidence 
## interval of the variation of Rt. To calculate Rt on each day t, EpiInvert 
## uses the past days (t'&lt;=t) and the future days (t'&gt;t) when available. 
## Therefore, the EpiInvert estimate of Rt varies when there are more days 
## available. This confidence interval reflects the expected variation of Rt 
## as a function of the number of days after t available.
EpiInvert_plot(res,"R")

</code></pre>

<hr>
<h2 id='EpiInvert_plot'><code>EpiInvert_plot</code></h2><span id='topic+EpiInvert_plot'></span>

<h3>Description</h3>

<p>EpiInvert_plot() plots the results obtained by EpiInvert
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EpiInvert_plot(
  x,
  what = "all",
  date_start = "1000-01-01",
  date_end = "3000-01-01"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EpiInvert_plot_+3A_x">x</code></td>
<td>
<p>an object of class <code>estimate_EpiInvert</code>.</p>
</td></tr>
<tr><td><code id="EpiInvert_plot_+3A_what">what</code></td>
<td>
<p>one of the following drawing options: 
</p>

<ul>
<li><p>all: a plot combining the main EpiInvert results.
</p>
</li>
<li><p>R: a plot of the reproduction number Rt estimation. 
</p>
</li>
<li><p>incid: a plot combining the obtained incidence curves. 
</p>
</li>
<li><p>SI: the serial interval used in the EpiInvert estimation. 
</p>
</li></ul>
</td></tr>
<tr><td><code id="EpiInvert_plot_+3A_date_start">date_start</code></td>
<td>
<p>the start date to plot</p>
</td></tr>
<tr><td><code id="EpiInvert_plot_+3A_date_end">date_end</code></td>
<td>
<p>the final date to plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EpiInvert">EpiInvert</a></code>
</p>

<hr>
<h2 id='EpiInvertForecast'><code>EpiInvertForecast</code> computes a 28-day forecast of the restored incidence 
curve including a 95
using the weekly seasonality, from the forecasted restored incidence curve we
also estimate a  28-day forecast of the original incidence curve.</h2><span id='topic+EpiInvertForecast'></span>

<h3>Description</h3>

<p><code>EpiInvertForecast</code> computes a 28-day forecast of the restored incidence 
curve including a 95
using the weekly seasonality, from the forecasted restored incidence curve we
also estimate a  28-day forecast of the original incidence curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EpiInvertForecast(
  EpiInvert_result,
  restored_incidence_database,
  type = "median",
  trend_sentiment = 0,
  NumberForecastAdditionalDays = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EpiInvertForecast_+3A_epiinvert_result">EpiInvert_result</code></td>
<td>
<p>output list of the EpiInvert execution including, in particular,
the restored incidence curve and the seasonality.</p>
</td></tr>
<tr><td><code id="EpiInvertForecast_+3A_restored_incidence_database">restored_incidence_database</code></td>
<td>
<p>a database including 27,418  samples of different
restored incidence curves computed by EpiInvert using real data. Each 
restored incidence curve includes the last 56 values of the sequence. That is
this database can be viewed as a matrix of size 27,418  X 56</p>
</td></tr>
<tr><td><code id="EpiInvertForecast_+3A_type">type</code></td>
<td>
<p>string with the forecast option. It can be &quot;mean&quot; or &quot;median&quot;.</p>
</td></tr>
<tr><td><code id="EpiInvertForecast_+3A_trend_sentiment">trend_sentiment</code></td>
<td>
<p>&quot;a priori&quot; knowledge about the future incidence evolution. 
== 0 means that you are neutral about the future trend 
&gt; 0  means that you expect that the future trend is higher than the expected one 
using all database curves. the value represents the percentage of database 
curves removed before computing the forecast The curves removed are the ones 
with lowest growth in the last 28 days.  
&lt; 0  means that you expect that the future trend is higher than the expected one 
using all database curves. the meaning of the value is similar to the previous 
case, but removing the curves with the highest growth in the last 28 days.</p>
</td></tr>
<tr><td><code id="EpiInvertForecast_+3A_numberforecastadditionaldays">NumberForecastAdditionalDays</code></td>
<td>
<p>The number of forecast days is 28. With this
parameter you can add extra forecast days using linear extrapolation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>EpiInvertForecast estimates a forecast of the restored incidence curve 
using a weighted average of 27,418  restored incidence curves previously 
estimated by EpiInvert and stored in the database &quot;restored_incidence_database&quot;. 
The weight, in the average computation, of each restored incidence curve 
of the database depends on the similarity between the current curve in the last
28 days and the first 28 days of the database curve. Each database curve 
contains 56 days. The first 28 days are used for comparison with the current 
curve and the last 28 days are used for forecasting.
</p>


<h3>Value</h3>


<p>a list with components:
</p>

<ul>
<li><p>dates: a vector of dates corresponding to the forecast days. 
</p>
</li>
<li><p>i_restored_forecast: a numeric vector with the forecast of the 
restored incidence curve for the next 28 days.
</p>
</li>
<li><p>i_original_forecast: a numeric vector with the forecast of the 
original incidence curve for the next 28 days.
</p>
</li>
<li><p>i_restored_forecast_CI50: radius of an empiric confidence interval,  
with percentile 50, for the restored incidence forecast following the 
number of days passed since the current day. 

</p>
</li>
<li><p>i_restored_forecast_CI75: radius of an empiric confidence interval,  
with percentile 75, for the restored incidence forecast following the 
number of days passed since the current day. 

</p>
</li>
<li><p>i_restored_forecast_CI90: radius of an empiric confidence interval,  
with percentile 90, for the restored incidence forecast following the 
number of days passed since the current day. 

</p>
</li>
<li><p>i_restored_forecast_CI95: radius of an empiric confidence interval,  
with percentile 95, for the restored incidence forecast following the 
number of days passed since the current day. 

</p>
</li></ul>




<h3>Author(s)</h3>

<p>Luis Alvarez <a href="mailto:lalvarez@ulpgc.es">lalvarez@ulpgc.es</a>
</p>


<h3>References</h3>


<p>[1] Alvarez, L.; Colom, M.; Morel, J.D.; Morel, J.M. Computing the daily 
reproduction number of COVID-19 by inverting the renewal
equation using a variational technique. Proc. Natl. Acad. Sci. USA, 2021.
</p>
<p>[2] Alvarez, Luis, Jean-David Morel, and Jean-Michel Morel. &quot;Modeling 
COVID-19 Incidence by the Renewal Equation after Removal of Administrative 
Bias and Noise&quot; Biology 11, no. 4: 540. 2022. 
</p>
<p>[3] Ritchie, H. et al. Coronavirus Pandemic (COVID-19), OurWorldInData.org. 
Available online: 
https://ourworldindata.org/coronavirus-source-data 
(accessed on 5 May 2022).
</p>
<p>[4] Alvarez, Luis, Jean-David Morel, and Jean-Michel Morel. EpiInvertForecast
Available online: 
https://ctim.ulpgc.es/covid19/EpiInvertForecastPaper.html 
</p>



<h3>Examples</h3>

<pre><code class='language-R'>## load data on COVID-19 daily incidence up to 2022-05-05 for France, 
## and Germany (taken from the official government data) and for UK and 
## the USA taken from reference [3]
data(incidence)

## load of the database of restored incidence curves. 
data("restored_incidence_database")

## EpiInvert execution for USA with no festive days specification
## using the incidence 90 days in the past
res &lt;- EpiInvert(incidence$USA,
"2022-05-05",
"1000-01-01",
select_params(list(max_time_interval = 90))
)

## EpiInvertForecast execution using the EpiInvert results obtained by USA
forecast &lt;-  EpiInvertForecast(res,restored_incidence_database)



</code></pre>

<hr>
<h2 id='EpiInvertForecast_plot'><code>EpiInvertForecast_plot</code></h2><span id='topic+EpiInvertForecast_plot'></span>

<h3>Description</h3>

<p>EpiInvertForecast_plot() plot the restored incidence forecast
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EpiInvertForecast_plot(EpiInvert_results, Forecast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EpiInvertForecast_plot_+3A_epiinvert_results">EpiInvert_results</code></td>
<td>
<p>the list returned by the EpiInvert execution</p>
</td></tr>
<tr><td><code id="EpiInvertForecast_plot_+3A_forecast">Forecast</code></td>
<td>
<p>the list returned by the EpiInvertForecast execution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot with the last 28 days of the original and restored incidence curves and a 28-day 
forecast of the same curves. It also includes a shaded area with a 95
of the restored incidence forecast estimation
</p>

<hr>
<h2 id='festives'>A dataset containing festive days in  France, 
Germany, UK and the USA</h2><span id='topic+festives'></span>

<h3>Description</h3>

<p>A dataset containing festive days in  France, 
Germany, UK and the USA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>festives
</code></pre>


<h3>Format</h3>

<p>A list with 4 variables:
</p>

<dl>
<dt>FRA</dt><dd><p>festive day of France</p>
</dd>
<dt>DEU</dt><dd><p>festive day  of Germany</p>
</dd>
<dt>UK</dt><dd><p>festive day  of UK</p>
</dd>
<dt>USA</dt><dd><p>festive day  of USA</p>
</dd>
</dl>


<hr>
<h2 id='incidence'>A dataset containing daily incidence of COVID-19 for France, 
Germany, UK and the USA</h2><span id='topic+incidence'></span>

<h3>Description</h3>

<p>A dataset containing daily incidence of COVID-19 for France, 
Germany, UK and the USA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incidence
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables:
</p>

<dl>
<dt>date</dt><dd><p>date of the incidence.</p>
</dd>
<dt>FRA</dt><dd><p>incidence of France.</p>
</dd>
<dt>DEU</dt><dd><p>incidence of Germany.</p>
</dd>
<dt>UK</dt><dd><p>incidence of UK.</p>
</dd>
<dt>USA</dt><dd><p>incidence of USA.</p>
</dd>
</dl>

<p>An updated version of this dataset can be found at 
https://www.ctim.es/covid19/incidence.csv
</p>


<h3>Source</h3>

<p><a href="https://github.com/owid/covid-19-data/tree/master/public/data">https://github.com/owid/covid-19-data/tree/master/public/data</a>
</p>
<p><a href="https://www.santepubliquefrance.fr/dossiers/coronavirus-covid-19/coronavirus-chiffres-cles-et-evolution-de-la-covid-19-en-france-et-dans-le-monde">https://www.santepubliquefrance.fr/dossiers/coronavirus-covid-19/coronavirus-chiffres-cles-et-evolution-de-la-covid-19-en-france-et-dans-le-monde</a>
</p>
<p><a href="https://experience.arcgis.com/experience/478220a4c454480e823b17327b2bf1d4/page/page_1/">https://experience.arcgis.com/experience/478220a4c454480e823b17327b2bf1d4/page/page_1/</a>
</p>

<hr>
<h2 id='incidence_weekly_aggregated'>A dataset containing weekly aggregated incidence of COVID-19 for France, 
Germany, UK and the USA</h2><span id='topic+incidence_weekly_aggregated'></span>

<h3>Description</h3>

<p>A dataset containing weekly aggregated incidence of COVID-19 for France, 
Germany, UK and the USA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>incidence_weekly_aggregated
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables:
</p>

<dl>
<dt>date</dt><dd><p>date of the weekly aggregated incidence.</p>
</dd>
<dt>FRA</dt><dd><p>weekly aggregated incidence of France.</p>
</dd>
<dt>DEU</dt><dd><p>weekly aggregated incidence of Germany.</p>
</dd>
<dt>UK</dt><dd><p>weekly aggregated incidence of UK.</p>
</dd>
<dt>USA</dt><dd><p>weekly aggregated incidence of USA.</p>
</dd>
</dl>

<p>An updated version of this dataset can be found at 
https://www.ctim.es/covid19/incidence.csv
</p>


<h3>Source</h3>

<p><a href="https://github.com/owid/covid-19-data/tree/master/public/data">https://github.com/owid/covid-19-data/tree/master/public/data</a>
</p>
<p><a href="https://www.santepubliquefrance.fr/dossiers/coronavirus-covid-19/coronavirus-chiffres-cles-et-evolution-de-la-covid-19-en-france-et-dans-le-monde">https://www.santepubliquefrance.fr/dossiers/coronavirus-covid-19/coronavirus-chiffres-cles-et-evolution-de-la-covid-19-en-france-et-dans-le-monde</a>
</p>
<p><a href="https://experience.arcgis.com/experience/478220a4c454480e823b17327b2bf1d4/page/page_1/">https://experience.arcgis.com/experience/478220a4c454480e823b17327b2bf1d4/page/page_1/</a>
</p>

<hr>
<h2 id='joint_indicators_by_date'><code>joint_indicators_by_date</code></h2><span id='topic+joint_indicators_by_date'></span>

<h3>Description</h3>

<p>generates a dataframe joining the dates and values
of 2 indicators
</p>


<h3>Usage</h3>

<pre><code class='language-R'>joint_indicators_by_date(date0, i0, date1, i1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="joint_indicators_by_date_+3A_date0">date0</code></td>
<td>
<p>the dates of the first indicator.</p>
</td></tr>
<tr><td><code id="joint_indicators_by_date_+3A_i0">i0</code></td>
<td>
<p>the values of the first indicator.</p>
</td></tr>
<tr><td><code id="joint_indicators_by_date_+3A_date1">date1</code></td>
<td>
<p>the dates of the second indicator.</p>
</td></tr>
<tr><td><code id="joint_indicators_by_date_+3A_i1">i1</code></td>
<td>
<p>the values of the second indicator.</p>
</td></tr>
</table>


<h3>Value</h3>

 
<p>A dataframe with the following columns :
</p>

<ul>
<li><p>date: all dates presented in any of the indicators. 
</p>
</li>
<li><p>f: the values of the first indicator. We assign 0
in the case the data is not available for a given day.
</p>
</li>
<li><p>g: the values of the second indicator. We assign 0
in the case the data is not available for a given day 
</p>
</li></ul>



<hr>
<h2 id='owid'>A dataset with COVID-19 indicators</h2><span id='topic+owid'></span>

<h3>Description</h3>

<p>A dataset containing COVID-19 epidemiological indicators for Canada, France, 
Germany, Italy, UK and the USA from Our World in data organization
https://github.com/owid/covid-19-data/tree/master/public/data up to 2022-11-28. 
In the case a data value is not available for a given day we assign the value 0 
to the indicator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>owid
</code></pre>


<h3>Format</h3>

<p>A dataframe with 13 variables:
</p>

<dl>
<dt>iso_code</dt><dd><p>iso code of the country</p>
</dd>
<dt>location</dt><dd><p>country name</p>
</dd>
<dt>date</dt><dd><p>date of the indicator value </p>
</dd>
<dt>new_cases</dt><dd><p>new confirmed cases</p>
</dd>
<dt>new_cases_smoothed</dt><dd><p>new confirmed cases smoothed</p>
</dd>
<dt>new_cases_restored_EpiInvert</dt><dd><p>new confirmed cases restored using EpiInvert</p>
</dd>
<dt>new_deaths</dt><dd><p>new deaths attributed to COVID-19</p>
</dd>
<dt>new_deaths_smoothed</dt><dd><p>new deaths smoothed</p>
</dd>
<dt>new_deaths_restored_EpiInvert</dt><dd><p>new deaths restored using EpiInvert</p>
</dd>
<dt>icu_patients</dt><dd><p>number of COVID-19 patients in intensive care units (ICUs) 
on a given day</p>
</dd>
<dt>hosp_patients</dt><dd><p>number of COVID-19 patients in hospital on a given day</p>
</dd>
<dt>weekly_icu_admissions</dt><dd><p>number of COVID-19 patients newly admitted to 
intensive care units (ICUs) in a given week (reporting date and the preceding 
6 days)</p>
</dd>
<dt>weekly_hosp_admissions</dt><dd><p>number of COVID-19 patients newly admitted to 
hospitals in a given week (reporting date and the preceding 6 days)</p>
</dd>
</dl>


<hr>
<h2 id='restored_incidence_database'>A dataset of restored daily incidence trend curves</h2><span id='topic+restored_incidence_database'></span>

<h3>Description</h3>

<p>A dataset including 27,418 samples of different
restored incidence curves computed by EpiInvert using real data. Each 
restored incidence curve includes the last 56 values of the sequence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>restored_incidence_database
</code></pre>


<h3>Format</h3>

<p>A 27,418 X 56 numeric matrix
</p>

<hr>
<h2 id='select_params'><code>select_params</code> function to select EpiInvert parameters</h2><span id='topic+select_params'></span>

<h3>Description</h3>

<p><code>select_params</code> function to select EpiInvert parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_params(x = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_params_+3A_x">x</code></td>
<td>
<p>a list with elements of the class  <code>estimate_R_config</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>estimate_R_config</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EpiInvert">EpiInvert</a></code>
</p>

<hr>
<h2 id='si_distr_data'>A dataset containing the values of a serial interval</h2><span id='topic+si_distr_data'></span>

<h3>Description</h3>

<p>A dataset containing the values of a serial interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>si_distr_data
</code></pre>


<h3>Format</h3>

<p>A numeric vector with 1 variable representing 
the serial interval
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
