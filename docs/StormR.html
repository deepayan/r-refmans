<!DOCTYPE html><html><head><title>Help for package StormR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {StormR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#defStormsDataset'><p>Creating a <code>stormsDataset</code> object</p></a></li>
<li><a href='#defStormsList'><p>Creating a <code>stormsList</code> object</p></a></li>
<li><a href='#eezNC'><p>EEZ of New Caledonia</p></a></li>
<li><a href='#getBuffer'><p>Getting the buffered location of interest</p></a></li>
<li><a href='#getBufferSize'><p>Getting the buffer size</p></a></li>
<li><a href='#getInObs'><p>Getting the number of the observations</p></a></li>
<li><a href='#getLOI'><p>Getting the location of interest</p></a></li>
<li><a href='#getNames'><p>Getting the names of the storms</p></a></li>
<li><a href='#getNbObs'><p>Getting the number of observations</p></a></li>
<li><a href='#getNbStorms'><p>Getting the number of <code>storm</code></p></a></li>
<li><a href='#getObs'><p>Getting observations</p></a></li>
<li><a href='#getSeasons'><p>Getting cyclonic seasons of the storms</p></a></li>
<li><a href='#getSSHS'><p>Getting maximum Saffir-Simpson hurricane wind scale category</p></a></li>
<li><a href='#getStorm'><p>Extracting a <code>storm</code></p></a></li>
<li><a href='#plotBehaviour'><p>Plotting spatial wind behaviour</p></a></li>
<li><a href='#plotStorms'><p>Plotting storm track data</p></a></li>
<li><a href='#show,storm-method'><p>Show a <code>storm</code>/<code>stormsList</code></p></a></li>
<li><a href='#spatialBehaviour'><p>Computing wind behaviour and summary statistics over given areas</p></a></li>
<li><a href='#storm-class'><p><code>storm</code>  object</p></a></li>
<li><a href='#stormsDataset-class'><p>stormsDataset</p></a></li>
<li><a href='#stormsList-class'><p><code>stormsList</code> object</p></a></li>
<li><a href='#temporalBehaviour'><p>Computing wind behaviour time series and summary statistics at given point locations</p></a></li>
<li><a href='#writeRast'><p>Exporting rasters to GeoTIFF or NetCDF files</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Analyzing the Behaviour of Wind Generated by Tropical Storms and
Cyclones</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Arsouze &lt;thomas.arsouze@cirad.fr&gt;</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://umr-amap.github.io/StormR/">https://umr-amap.github.io/StormR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/umr-amap/StormR/issues/new/choose">https://github.com/umr-amap/StormR/issues/new/choose</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Set of functions to quantify and map the
    behaviour of winds generated by tropical storms and cyclones in space
    and time. It includes functions to compute and analyze fields such as the maximum sustained wind field, power dissipation index and duration of exposure to winds above a given threshold. It also includes functions to map the trajectories as well as characteristics of the storms.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, maps, methods, ncdf4, rworldmap, sf, stringr, terra,
utils, zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, rworldxtra, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-23 14:27:27 UTC; arsouze</td>
</tr>
<tr>
<td>Author:</td>
<td>Baptiste Delaporte [aut],
  Thomas Ibanez <a href="https://orcid.org/0000-0002-3192-1721"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Gunnar Keppel <a href="https://orcid.org/0000-0001-7092-6149"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Swen Jullien <a href="https://orcid.org/0000-0002-5389-0532"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Christophe Menkes <a href="https://orcid.org/0000-0002-1457-9696"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Thomas Arsouze <a href="https://orcid.org/0000-0002-8871-6120"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-24 13:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='defStormsDataset'>Creating a <code>stormsDataset</code> object</h2><span id='topic+defStormsDataset'></span>

<h3>Description</h3>

<p>The <code>defStormsDataset()</code> function creates a <code>stormsDataset</code> object from a NetCDF file.
This is an essential first step before other <code>stormR</code> functions can be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>defStormsDataset(
  filename = system.file("extdata", "test_dataset.nc", package = "StormR"),
  fields = c(names = "name", seasons = "season", isoTime = "iso_time", lon = "usa_lon",
    lat = "usa_lat", msw = "usa_wind", basin = "basin", sshs = "usa_sshs", rmw =
    "usa_rmw", pressure = "usa_pres", poci = "usa_poci"),
  basin = NULL,
  seasons = c(1980, as.numeric(format(Sys.time(), "%Y"))),
  unitConversion = c(msw = "knt2ms", rmw = "nm2km", pressure = "mb2pa", poci = "mb2pa"),
  verbose = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="defStormsDataset_+3A_filename">filename</code></td>
<td>
<p>character. Name of the NetCDF (.nc) file. Default is the <code>test_dataset.nc</code>
file located in the <code>inst/extdata</code> repository of the directory (accessible by
<code>system.file("extdata", "test_dataset.nc", package = "StormR")</code>). This test dataset is extracted
from the IBTrACS.SP.v04r00.nc file and provides all the tropical cyclones that occurred around Vanuatu
from 2015 to 2016 and around New Caledonia from 2020 to 2021.</p>
</td></tr>
<tr><td><code id="defStormsDataset_+3A_fields">fields</code></td>
<td>
<p>named character vector. This argument allows to specify the corresponding variable names
in the input NetCDF file for each field in the output <code>stormsDataset</code>. By default, the corresponding
variable names are set up to import data from a NetCDF file from the IBTrACS database (Knapp et al., 2010).
Corresponding variable names for following fields have to (mandatory fields) or can be
(recommended or optional fields) provided:
</p>

<ul>
<li><p> &quot;<code style="white-space: pre;">&#8288;names"&#8288;</code>, names of the storms (mandatory),
</p>
</li>
<li> <p><code>"seasons"</code>, years of observations (mandatory),
</p>
</li>
<li> <p><code>"isoTime"</code>, date and time of observations (mandatory),
</p>
</li>
<li> <p><code>"lon"</code>, longitude of the observations (mandatory),
</p>
</li>
<li> <p><code>"lat"</code>, latitude of the observations (mandatory),
</p>
</li>
<li> <p><code>"msw"</code>, maximum sustained wind speed (mandatory),
</p>
</li>
<li> <p><code>"basin"</code>, name of the area where the storm originated (recommended),
</p>
</li>
<li> <p><code>"rmw"</code>, radius of maximum winds: distance between the centre of the storm and
its band of strongest winds (recommended),
</p>
</li>
<li> <p><code>"pressure"</code>, central pressure (recommended),
</p>
</li>
<li> <p><code>"poci"</code>, pressure of the last closed isobar (recommended), and
</p>
</li>
<li> <p><code>"sshs"</code>, Saffir-Simpson hurricane wind scale rating based on msw (optional).
</p>
</li></ul>
</td></tr>
<tr><td><code id="defStormsDataset_+3A_basin">basin</code></td>
<td>
<p>character. If the basin field is provided, then storm track data will
only be extracted for the named basin. By default <code>basin=NULL</code>, meaning that all storms
irrespective of the basin they originated in are extracted.
Seven basins can be used to filter the data set:
</p>

<ul>
<li> <p><code>"NA"</code>, for North Atlantic basin,
</p>
</li>
<li> <p><code>"SA"</code>, for South Atlantic basin,
</p>
</li>
<li> <p><code>"EP"</code>, for Eastern North Pacific basin,
</p>
</li>
<li> <p><code>"WP"</code>, for Western North Pacific basin,
</p>
</li>
<li> <p><code>"SP"</code>, for South Pacific basin,
</p>
</li>
<li> <p><code>"SI"</code>, for South India basin, or
</p>
</li>
<li> <p><code>"NI"</code>, for North India basin.
</p>
</li></ul>
</td></tr>
<tr><td><code id="defStormsDataset_+3A_seasons">seasons</code></td>
<td>
<p>numeric vector. Seasons of occurrence of the storms (e.g., c(2020,2022)). In the Southern Hemisphere,
the cyclone season extends across two consecutive years. Therefore, to capture the 2021 to 2022 cyclone season both
years should be specified, with cyclones assigned for the year that originated in.
By default all storms occurring since 1980 are extracted.</p>
</td></tr>
<tr><td><code id="defStormsDataset_+3A_unitconversion">unitConversion</code></td>
<td>
<p>named character vector. <code>StormR</code> functions use the metric system (international
system of units), therefore <code>msw</code> has to be provided in <code class="reqn">m.s^{-1}</code>, <code>rmw</code> in <code class="reqn">km</code>, <code>pressure</code>
and <code>poci</code> in <code class="reqn">Pa</code>. By default <code>unitConversion=c(msw = "knt2ms", rmw = "nm2km", pressure = "mb2pa", poci = "mb2pa")</code> to meet the requirements when importing a NetCDF file from the IBTrACS database.
This argument is mandatory even if no conversion is needed. If no conversion is needed then
use <code>"None"</code> in the corresponding fields. The following unit conversions are implemented:
</p>
<p>For <code>msw</code>,
</p>

<ul>
<li> <p><code>"knt2ms"</code>, to convert knot to meter per second (default setting),
</p>
</li>
<li> <p><code>"kmh2ms"</code>, to convert kilometre per hour to meter per second,
</p>
</li>
<li><p> &quot;<code style="white-space: pre;">&#8288;mph2ms"&#8288;</code>, to convert miles per hour to meter per second, or
</p>
</li>
<li> <p><code>"None"</code>, if no conversion is needed.
</p>
</li></ul>

<p>For <code>rmw</code>,
</p>

<ul>
<li> <p><code>"nm_to_ms"</code>to convert nautical miles to kilometre (default setting), or
</p>
</li>
<li> <p><code>"None"</code>if no conversion is needed.
</p>
</li></ul>

<p>For <code>pressure</code> and <code>poci</code>,
</p>

<ul>
<li><p> &quot;<code style="white-space: pre;">&#8288;mb2pa"&#8288;</code>, to convert  millibar to Pascal  (default setting),
</p>
</li>
<li> <p><code>"b2pa"</code>, to convert bar to Pascal,
</p>
</li>
<li> <p><code>"atm2pa"</code>, to convert  atmosphere to Pascal,
</p>
</li>
<li> <p><code>"psi2pa"</code>, to convert  psi to Pascal, or
</p>
</li>
<li> <p><code>"None"</code>, if no conversion is needed.
</p>
</li></ul>
</td></tr>
<tr><td><code id="defStormsDataset_+3A_verbose">verbose</code></td>
<td>
<p>numeric. Whether the function should display (<code style="white-space: pre;">&#8288;= 1&#8288;</code>)
or not (<code style="white-space: pre;">&#8288;= 0&#8288;</code>) information about the processes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>defStormsDataset()</code> function returns a <code>stormsDataset</code> object.
</p>


<h3>References</h3>

<p>Knapp, K. R., Kruk, M. C., Levinson, D. H., Diamond, H. J., &amp; Neumann, C. J. (2010).
The International Best Track Archive for Climate Stewardship (IBTrACS).
Bulletin of the American Meteorological Society, 91(3), Article 3. https://doi.org/10.1175/2009bams2755.1
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Creating a `stormsDataset` object with storms between 2010 and 2015
# in the South Pacific using the NetCDF provided with the package
SP_2015_2020 &lt;- defStormsDataset(seasons = c(2010, 2015))
str(SP_2015_2020)
</code></pre>

<hr>
<h2 id='defStormsList'>Creating a <code>stormsList</code> object</h2><span id='topic+defStormsList'></span>

<h3>Description</h3>

<p>The <code>defStormsList()</code> function extracts storm track data from a <code>stormsDataset</code>
and creates a <code>stormsList</code> object based on specified arguments relating to location of interest,
seasons, and names of the storms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>defStormsList(
  sds,
  loi,
  seasons = c(sds@seasons["min"], sds@seasons["max"]),
  names = NULL,
  maxDist = 300,
  removeTD = TRUE,
  verbose = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="defStormsList_+3A_sds">sds</code></td>
<td>
<p><code>stormsDataset</code> object.</p>
</td></tr>
<tr><td><code id="defStormsList_+3A_loi">loi</code></td>
<td>
<p>Location of interest. Can be defined using,
</p>

<ul>
<li><p> character, a country name (e.g., &quot;Vanuatu&quot;)
</p>
</li>
<li><p> character, a basin name among &quot;NA&quot;, &quot;SA&quot;, &quot;EP&quot;, &quot;WP&quot;, &quot;SP&quot;, &quot;SI&quot; and &quot;NI&quot;
</p>
</li>
<li><p> numeric vector, a point coordinate (lon, lat in decimal degrees, e.g., c(169.5, -19.2))
</p>
</li>
<li><p> sp (SpatialPolygon) or a sf (simple features) object (e.g., created from a shapefile)
</p>
</li></ul>
</td></tr>
<tr><td><code id="defStormsList_+3A_seasons">seasons</code></td>
<td>
<p>numeric vector. Seasons of occurrence of the storms (e.g., c(2020,2022)).
In the Southern Hemisphere, the cyclone season extends across two consecutive years.
Therefore, to capture the 2021 to 2022 cyclone season both years should be specified,
with cyclones assigned for the year that originated in. By default all storms from <code>sds</code> are extracted.</p>
</td></tr>
<tr><td><code id="defStormsList_+3A_names">names</code></td>
<td>
<p>character vector. Names of specific storms (in capital letters).</p>
</td></tr>
<tr><td><code id="defStormsList_+3A_maxdist">maxDist</code></td>
<td>
<p>numeric. Maximum distance between the location of interest and the
storm for which track data are extracted. Default <code>maxDist</code> is set to 300 km.</p>
</td></tr>
<tr><td><code id="defStormsList_+3A_removetd">removeTD</code></td>
<td>
<p>logical. Whether (TRUE) or not (FALSE) removing tropical depressions (<code class="reqn">msw &lt; 18
  m.s^{-1}</code>, not considered to be stormed in Saffir-Simpson hurricane wind scale) are removed.
Default value is set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="defStormsList_+3A_verbose">verbose</code></td>
<td>
<p>numeric. Type of information the function displays. Can be:
</p>

<ul>
<li> <p><code>2</code>, information about both the processes and the outputs are displayed (default value),
</p>
</li>
<li> <p><code>1</code>, only information about the processes are displayed, or
</p>
</li>
<li> <p><code>0</code>, nothing is displayed.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>The available countries for the <code>loi</code> are those provided in the
<code>rwolrdxtra</code> package. This package provide high resolution vector country
boundaries derived from Natural Earth data. More informations on the Natural Earth data
here: <a href="https://www.naturalearthdata.com/downloads/10m-cultural-vectors/">http://www.naturalearthdata.com/downloads/10m-cultural-vectors/</a>.
</p>


<h3>Value</h3>

<p>The <code>defStormsList()</code> function returns a <code>stormsList</code> object containing track data for all storms
meeting the specified criteria (e.g., name, season, location).
</p>


<h3>References</h3>

<p>Knapp, K. R., Kruk, M. C., Levinson, D. H., Diamond, H. J., &amp; Neumann, C. J. (2010).
The International Best Track Archive for Climate Stewardship (IBTrACS).
Bulletin of the American Meteorological Society, 91(3), Article 3.
<a href="doi:10.1175/2009bams2755.1">doi:10.1175/2009bams2755.1</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Creating a stormsDataset
sds &lt;- defStormsDataset()

#Getting data using country names
vanuatu.st &lt;- defStormsList(sds = sds, loi = "Vanuatu")

#Getting data using a specific point location
pt &lt;- c(169, -19)
pam.pt &lt;- defStormsList(sds = sds, loi = pt, names = "PAM")

#Getting data using country and storm names
niran.nc &lt;- defStormsList(sds = sds, loi = "New Caledonia", names = c("NIRAN"))

#Getting data using a user defined spatial polygon
poly &lt;- cbind(c(135, 290, 290, 135, 135),c(-60, -60, 0, 0, -60))
sp &lt;- sf::st_polygon(list(poly))
sp &lt;- sf::st_sfc(sp, crs = 4326)
sp &lt;- sf::st_as_sf(sp)
sts_sp &lt;- defStormsList(sds = sds, loi = sp)


</code></pre>

<hr>
<h2 id='eezNC'>EEZ of New Caledonia</h2><span id='topic+eezNC'></span>

<h3>Description</h3>

<p>Provide the geographic limits of the eez of New Caledonia
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eezNC
</code></pre>


<h3>Format</h3>



<h4><code>eezNC</code></h4>

<p>a sf object
</p>


<hr>
<h2 id='getBuffer'>Getting the buffered location of interest</h2><span id='topic+getBuffer'></span><span id='topic+getBuffer+2CstormsList-method'></span>

<h3>Description</h3>

<p>The <code>getBuffer()</code> function returns the buffered location
of interest from a <code>stormsList</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBuffer(sts)

## S4 method for signature 'stormsList'
getBuffer(sts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getBuffer_+3A_sts">sts</code></td>
<td>
<p><code>stormsList</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>sf</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Creating a stormsDataset
sds &lt;- defStormsDataset()

#Getting storm track data for all storms near New Caledonia
sts &lt;- defStormsList(sds=sds, loi = "New Caledonia")

#Getting the buffered location of interest from the sts object
buff &lt;- getBuffer(sts)

</code></pre>

<hr>
<h2 id='getBufferSize'>Getting the buffer size</h2><span id='topic+getBufferSize'></span><span id='topic+getBufferSize+2CstormsList-method'></span>

<h3>Description</h3>

<p>The <code>getBufferSize()</code> returns the buffer size used to generate
the buffered location of interest for a <code>stormsList</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBufferSize(sts)

## S4 method for signature 'stormsList'
getBufferSize(sts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getBufferSize_+3A_sts">sts</code></td>
<td>
<p><code>stormsList</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Creating a stormsDataset

sds &lt;- defStormsDataset()

#Getting storm track data for all storms near New Caledonia
sts &lt;- defStormsList(sds=sds, loi = "New Caledonia")

#Getting the buffer size from the sts object
buffsize &lt;- getBufferSize(sts)

</code></pre>

<hr>
<h2 id='getInObs'>Getting the number of the observations</h2><span id='topic+getInObs'></span><span id='topic+getInObs+2CstormsList-method'></span><span id='topic+getInObs+2Cstorm-method'></span>

<h3>Description</h3>

<p>The <code>getInObs()</code> function returns the number of the
observations in a given <code>storm</code> or <code>stormsList</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getInObs(s, ...)

## S4 method for signature 'stormsList'
getInObs(s, name, season = NULL)

## S4 method for signature 'storm'
getInObs(s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getInObs_+3A_s">s</code></td>
<td>
<p><code>storm</code> or <code>stormsList</code> object.</p>
</td></tr>
<tr><td><code id="getInObs_+3A_...">...</code></td>
<td>
<p>extra argument for <code>stormsList</code></p>
</td></tr>
<tr><td><code id="getInObs_+3A_name">name</code></td>
<td>
<p>character. Name of the storm in capital letters.</p>
</td></tr>
<tr><td><code id="getInObs_+3A_season">season</code></td>
<td>
<p>numeric. Cyclonic season of the <code>storm</code>. Required only
if several <code>storm</code> in <code>s</code> object have the same name. Default value is set
to <code>NULL</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Creating a stormsDataset

sds &lt;- defStormsDataset()

#Getting storm track data for all storms near New Caledonia
sts &lt;- defStormsList(sds=sds, loi = "New Caledonia")

#Getting the number of the observation for the tropical cyclone Niran in the sts object
getInObs(getStorm(sts, name = "NIRAN"))
getInObs(sts, name = "NIRAN")

</code></pre>

<hr>
<h2 id='getLOI'>Getting the location of interest</h2><span id='topic+getLOI'></span><span id='topic+getLOI+2CstormsList-method'></span>

<h3>Description</h3>

<p>The <code>getLOI()</code> functions returns the location of interest for the given <code>stormsList</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLOI(sts)

## S4 method for signature 'stormsList'
getLOI(sts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLOI_+3A_sts">sts</code></td>
<td>
<p><code>stormsList</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sf object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Creating a stormsDataset

sds &lt;- defStormsDataset()

#Getting storm track data for all storms near New Caledonia
sts &lt;- defStormsList(sds=sds, loi = "New Caledonia")

#Getting the location of interest for the sts object
loi &lt;- getLOI(sts)

</code></pre>

<hr>
<h2 id='getNames'>Getting the names of the storms</h2><span id='topic+getNames'></span><span id='topic+getNames+2Cstorm-method'></span><span id='topic+getNames+2CstormsList-method'></span>

<h3>Description</h3>

<p>The <code>getNames()</code> function returns the names of the storms
in a <code>storm</code> or a <code>stormsList</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNames(s)

## S4 method for signature 'storm'
getNames(s)

## S4 method for signature 'stormsList'
getNames(s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNames_+3A_s">s</code></td>
<td>
<p><code>storm</code> or <code>stormsList</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Creating a stormsDataset
sds &lt;- defStormsDataset()

#Getting storm track data for all storms near New Caledonia
sts &lt;- defStormsList(sds=sds, loi = "New Caledonia")

#Getting the names of the storms from the sts object
getNames(sts)

</code></pre>

<hr>
<h2 id='getNbObs'>Getting the number of observations</h2><span id='topic+getNbObs'></span><span id='topic+getNbObs+2Cstorm-method'></span><span id='topic+getNbObs+2CstormsList-method'></span>

<h3>Description</h3>

<p>The getNbObs() function returns the number of observations
for a storm in a <code>storm</code> or <code>stormsList</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNbObs(s, ...)

## S4 method for signature 'storm'
getNbObs(s)

## S4 method for signature 'stormsList'
getNbObs(s, name, season = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNbObs_+3A_s">s</code></td>
<td>
<p><code>storm</code> or <code>stormsList</code> object.</p>
</td></tr>
<tr><td><code id="getNbObs_+3A_...">...</code></td>
<td>
<p>extra arguments for <code>stormsList</code></p>
</td></tr>
<tr><td><code id="getNbObs_+3A_name">name</code></td>
<td>
<p>character. Name of the storm in capital letters.</p>
</td></tr>
<tr><td><code id="getNbObs_+3A_season">season</code></td>
<td>
<p>numeric. Cyclonic season of the <code>storm</code>. Required only
if several <code>storm</code> in the <code>s</code> have the same name. Default value is set to
<code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Creating a stormsDataset
sds &lt;- defStormsDataset()

#Getting storm track data for all storms near New Caledonia
sts &lt;- defStormsList(sds=sds, loi = "New Caledonia")

##Getting the number of observations for the tropical cyclone Niran in the sts object
getNbObs(getStorm(sts, name = "NIRAN"))
getNbObs(sts, name = "NIRAN")

</code></pre>

<hr>
<h2 id='getNbStorms'>Getting the number of <code>storm</code></h2><span id='topic+getNbStorms'></span><span id='topic+getNbStorms+2CstormsList-method'></span>

<h3>Description</h3>

<p>The <code>getNbStorms()</code> returns the number of <code>storm</code> objects
in the given <code>stormsList</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getNbStorms(sts)

## S4 method for signature 'stormsList'
getNbStorms(sts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getNbStorms_+3A_sts">sts</code></td>
<td>
<p><code>stormsList</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric, the number of <code>storm</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Creating a stormsDataset

sds &lt;- defStormsDataset()

#Getting storm track data for all storms near New Caledonia
sts &lt;- defStormsList(sds=sds, loi = "New Caledonia")

#Getting the number of storms in the sts object
getNbStorms(sts)

</code></pre>

<hr>
<h2 id='getObs'>Getting observations</h2><span id='topic+getObs'></span><span id='topic+getObs+2CstormsList-method'></span><span id='topic+getObs+2Cstorm-method'></span>

<h3>Description</h3>

<p>The <code>getObs()</code> function returns observed track data for a storm
in a <code>storm</code> or <code>stormsList</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getObs(s, ...)

## S4 method for signature 'stormsList'
getObs(s, name, season = NULL)

## S4 method for signature 'storm'
getObs(s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getObs_+3A_s">s</code></td>
<td>
<p><code>storm</code> or <code>stormsList</code> object</p>
</td></tr>
<tr><td><code id="getObs_+3A_...">...</code></td>
<td>
<p>extra argument for <code>stormsList</code></p>
</td></tr>
<tr><td><code id="getObs_+3A_name">name</code></td>
<td>
<p>character. Name of the storm in capital letters.</p>
</td></tr>
<tr><td><code id="getObs_+3A_season">season</code></td>
<td>
<p>numeric. Cyclonic season of the <code>storm</code>. Required only
if several <code>storm</code> in the <code>s</code> object have the same name.
Default value is set to <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Creating a stormsDataset
sds &lt;- defStormsDataset()

#Getting storm track data for all storms near New Caledonia
sts &lt;- defStormsList(sds=sds, loi = "New Caledonia")

#Getting the observed track data for the tropical
#cyclone Niran in the sts object
getObs(getStorm(sts, name = "NIRAN"))
getObs(sts, name = "NIRAN")

</code></pre>

<hr>
<h2 id='getSeasons'>Getting cyclonic seasons of the storms</h2><span id='topic+getSeasons'></span><span id='topic+getSeasons+2Cstorm-method'></span><span id='topic+getSeasons+2CstormsList-method'></span>

<h3>Description</h3>

<p>The <code>getSeasons()</code> function  returns the cyclonic season
of each storm in a <code>storm</code> or <code>stormsList</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSeasons(s)

## S4 method for signature 'storm'
getSeasons(s)

## S4 method for signature 'stormsList'
getSeasons(s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSeasons_+3A_s">s</code></td>
<td>
<p><code>storm</code> or <code>stormsList</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Creating a stormsDataset
sds &lt;- defStormsDataset()

#Getting storm track data for all storms near New Caledonia
sts &lt;- defStormsList(sds=sds, loi = "New Caledonia")

#Getting the cyclonic seasons of the storms from the sts object
getSeasons(sts)

</code></pre>

<hr>
<h2 id='getSSHS'>Getting maximum Saffir-Simpson hurricane wind scale category</h2><span id='topic+getSSHS'></span><span id='topic+getSSHS+2Cstorm-method'></span><span id='topic+getSSHS+2CstormsList-method'></span>

<h3>Description</h3>

<p>The <code>getSSHS()</code> function return the maximum Saffir-Simpson hurricane
wind scale category reached by each storm in the <code>storm</code> or <code>stormsList</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSSHS(s)

## S4 method for signature 'storm'
getSSHS(s)

## S4 method for signature 'stormsList'
getSSHS(s)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSSHS_+3A_s">s</code></td>
<td>
<p><code>storm</code> or <code>stormsList</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Creating a stormsDataset
sds &lt;- defStormsDataset()

#Getting storm track data for all storms near New Caledonia
sts &lt;- defStormsList(sds=sds, loi = "New Caledonia")

#Getting maximum Saffir-Simpson hurricane wind scale category
#reached by each storm in the sts object
getSSHS(sts)

</code></pre>

<hr>
<h2 id='getStorm'>Extracting a <code>storm</code></h2><span id='topic+getStorm'></span><span id='topic+getStorm+2CstormsList-method'></span>

<h3>Description</h3>

<p>The <code>getStorm()</code> function extracts a specific <code>storm</code> object
from a <code>stormsList</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStorm(sts, name, season = NULL)

## S4 method for signature 'stormsList'
getStorm(sts, name, season = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getStorm_+3A_sts">sts</code></td>
<td>
<p><code>stormsList</code></p>
</td></tr>
<tr><td><code id="getStorm_+3A_name">name</code></td>
<td>
<p>character. Name of the storm to extract.</p>
</td></tr>
<tr><td><code id="getStorm_+3A_season">season</code></td>
<td>
<p>numeric vector. Seasons of occurrence of the storms
(e.g., c(2020,2022)). In the Southern Hemisphere,
the cyclone season extends across two consecutive years.
Therefore, to capture the 2021 to 2022 cyclone season both
years should be specified, with cyclones assigned for the year
#'  that originated in. By default all storms occurring since
1980 are extracted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>storm</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Creating a stormsDataset

sds &lt;- defStormsDataset()

#Getting storm track data for all storms near New Caledonia
sts &lt;- defStormsList(sds=sds, loi = "New Caledonia")

#Getting `storm` for the tropical cyclone Niran
st &lt;- getStorm(sts, name = "NIRAN")

</code></pre>

<hr>
<h2 id='plotBehaviour'>Plotting spatial wind behaviour</h2><span id='topic+plotBehaviour'></span>

<h3>Description</h3>

<p>The <code>plotBehaviour()</code> function allows plotting spatial statistics generated using
the <code>spatialBehaviour()</code> function and stored in <code>SpatRaster</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBehaviour(
  sts,
  rasterProduct,
  colorPalette = NULL,
  main = NULL,
  xlim = NULL,
  ylim = NULL,
  labels = FALSE,
  by = 8,
  pos = 3,
  legends = "topleft"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotBehaviour_+3A_sts">sts</code></td>
<td>
<p><code>StormsList</code> object.</p>
</td></tr>
<tr><td><code id="plotBehaviour_+3A_rasterproduct">rasterProduct</code></td>
<td>
<p>layer name in a <code>SpatRaster</code> object. The names of the layers follow
the following terminology:
</p>

<ul>
<li><p> for &quot;MSW&quot; or &quot;PDI&quot;, the name of the storm in capital letters and the name of the
statistic separated by underscores (e.g., &quot;PAM_MSW&quot;, &quot;PAM_PDI&quot;),
</p>
</li>
<li><p> for duration of exposure, the name of the storm in capital letters, &quot;Exposure&quot;,
and the threshold value separated by underscores (e.g., &quot;PAM_Exposure_18&quot;, &quot;PAM_Exposure_33&quot;, ...).
</p>
</li>
<li><p> for wind profiles, the name of the storm in capital letters, &quot;Speed&quot; or &quot;Direction&quot;,
and the indices of the observation separated by underscores (e.g., &quot;PAM_Speed_41&quot;, &quot;PAM_Direction_41&quot;,...).
</p>
</li></ul>
</td></tr>
<tr><td><code id="plotBehaviour_+3A_colorpalette">colorPalette</code></td>
<td>
<p>character vector. The color palette used to plot the raster layer.
If <code>colorPalette=NULL</code> (default setting), the default color palette is used.</p>
</td></tr>
<tr><td><code id="plotBehaviour_+3A_main">main</code></td>
<td>
<p>character. Title of the plot. If <code>main=NULL</code> (default setting),
a default title is generated based on the name of the layer.</p>
</td></tr>
<tr><td><code id="plotBehaviour_+3A_xlim">xlim</code></td>
<td>
<p>numeric vector. The x limits of the plot.</p>
</td></tr>
<tr><td><code id="plotBehaviour_+3A_ylim">ylim</code></td>
<td>
<p>numeric vector. The y limits of the plot.</p>
</td></tr>
<tr><td><code id="plotBehaviour_+3A_labels">labels</code></td>
<td>
<p>logical. Whether (TRUE) or not (FALSE, default setting) to add labels with the name
of the storm and the indices and ISO times of the observation.</p>
</td></tr>
<tr><td><code id="plotBehaviour_+3A_by">by</code></td>
<td>
<p>numeric. If <code>labels=TRUE</code>, defines the frequency at which labels are plotted.
Default value is set to <code>8</code> which corresponds to a 24h (or 48h) time interval between the labelled observations
when observations are made every 3 (or 6) hours.</p>
</td></tr>
<tr><td><code id="plotBehaviour_+3A_pos">pos</code></td>
<td>
<p>numeric. If <code>labels=TRUE</code>, defines the position of the labels, <code>1</code> (above the observation),
<code>2</code> (on the left), <code>3</code> (below, default setting), and <code>4</code> (on the right).</p>
</td></tr>
<tr><td><code id="plotBehaviour_+3A_legends">legends</code></td>
<td>
<p>character. Indicates where to plot the legend, <code>"topright"</code>, <code>"topleft"</code> (default setting),
<code>"bottomleft"</code>, <code>"bottomright"</code>, or <code>"none"</code> (legend not plotted).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the storm track data with the raster layer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Creating a stormsDataset
sds &lt;- defStormsDataset()

# Getting storm track data for tropical cyclone Pam (2015)
pam &lt;- defStormsList(sds = sds, loi = "Vanuatu", names = "PAM")

# Plotting maximum sustained wind speed for Pam (2015) near Vanuatu
pam.msw &lt;- spatialBehaviour(pam, verbose = 0)
plotBehaviour(pam, pam.msw)

# Plotting 2D wind speed profile for Pam (2015) near Vanuatu
pam.prof &lt;- spatialBehaviour(pam, product = "Profiles", verbose = 0)
plotBehaviour(pam, pam.prof$PAM_Speed_37, labels = TRUE, pos = 4)

</code></pre>

<hr>
<h2 id='plotStorms'>Plotting storm track data</h2><span id='topic+plotStorms'></span>

<h3>Description</h3>

<p>This <code>plotStorms()</code> function allows plotting storm track data stored in a <code>StormsList</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotStorms(
  sts,
  names = NULL,
  category = NULL,
  xlim = NULL,
  ylim = NULL,
  labels = FALSE,
  by = 8,
  pos = 3,
  legends = "topleft",
  loi = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotStorms_+3A_sts">sts</code></td>
<td>
<p><code>StormsList</code> object</p>
</td></tr>
<tr><td><code id="plotStorms_+3A_names">names</code></td>
<td>
<p>character vector. Name(s) of the storm(s) in capital letters.
If <code>names = NULL</code> (default setting), all storms are plotted.</p>
</td></tr>
<tr><td><code id="plotStorms_+3A_category">category</code></td>
<td>
<p>numeric vector. Category of storms to be plotted in the Saffir-Simpson hurricane wind scale.
Can be a single category or a range of categories among:
</p>

<ul>
<li><p> -1, for tropical depression,
</p>
</li>
<li><p> 0, for tropical storms,
</p>
</li>
<li><p> 1, for category 1 tropical cyclone,
</p>
</li>
<li><p> 2, for category 2 tropical cyclone,
</p>
</li>
<li><p> 3, for category 3 tropical cyclone,
</p>
</li>
<li><p> 4, for category 4 tropical cyclone, or
</p>
</li>
<li><p> 5, for category 5 tropical cyclone.
</p>
</li></ul>

<p>If <code>category=NULL</code> (default setting), all storms are plotted.</p>
</td></tr>
<tr><td><code id="plotStorms_+3A_xlim">xlim</code></td>
<td>
<p>numeric vector. The x limits of the plot.</p>
</td></tr>
<tr><td><code id="plotStorms_+3A_ylim">ylim</code></td>
<td>
<p>numeric vector. The y limits of the plot.</p>
</td></tr>
<tr><td><code id="plotStorms_+3A_labels">labels</code></td>
<td>
<p>logical. Whether (TRUE) or not (FALSE, default setting) to add labels with the name
of the storm and the indices and ISO times of the observation.</p>
</td></tr>
<tr><td><code id="plotStorms_+3A_by">by</code></td>
<td>
<p>numeric. If <code>labels=TRUE</code>, defines the frequency at which labels are plotted.
Default value is set to <code>8</code> which corresponds to a 24h (or 48h) time interval between the labelled observations
when observations are made every 3 (or 6) hours.</p>
</td></tr>
<tr><td><code id="plotStorms_+3A_pos">pos</code></td>
<td>
<p>numeric. If <code>labels=TRUE</code>, defines the position of the labels, <code>1</code> (above the observation),
<code>2</code> (on the left), <code>3</code> (below, default setting), and <code>4</code> (on the right).</p>
</td></tr>
<tr><td><code id="plotStorms_+3A_legends">legends</code></td>
<td>
<p>character. Indicates where to plot the legend, <code>"topright"</code>, <code>"topleft"</code> (default setting),
<code>"bottomleft"</code>, <code>"bottomright"</code>, or <code>"none"</code> (legend not plotted).</p>
</td></tr>
<tr><td><code id="plotStorms_+3A_loi">loi</code></td>
<td>
<p>logical. Whether (TRUE, default setting) or not (FALSE) to plot the
extent of the buffered location of interest on the map.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the storm track data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#' #Creating a stormsDataset

dev.off()
sds &lt;- defStormsDataset()

# Getting storm track data for tropical cyclone Pam (2015)
pam &lt;- defStormsList(sds = sds, loi = "Vanuatu", names = "PAM")

# Plotting Pam over Vanuatu with labels every 24h
plotStorms(pam, labels = TRUE)

# Plotting Pam over Vanuatu with labels every 6h on the right side of the observations
plotStorms(pam, labels = TRUE, by = 2, pos = 4)

</code></pre>

<hr>
<h2 id='show+2Cstorm-method'>Show a <code>storm</code>/<code>stormsList</code></h2><span id='topic+show+2Cstorm-method'></span><span id='topic+show+2CstormsList-method'></span>

<h3>Description</h3>

<p>Display the <code>storm</code>/<code>stormsList</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'storm'
show(object)

## S4 method for signature 'stormsList'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Cstorm-method_+3A_object">object</code></td>
<td>
<p><code>storm</code>/<code>stormsList</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL, only display information about the object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sds &lt;- defStormsDataset()
sts &lt;- defStormsList(sds = sds, loi = "New Caledonia", names = c("LUCAS","NIRAN"))
## Display information about Niran in sts
getStorm(sts, name = "NIRAN")

## Display information about sts
sts

</code></pre>

<hr>
<h2 id='spatialBehaviour'>Computing wind behaviour and summary statistics over given areas</h2><span id='topic+spatialBehaviour'></span>

<h3>Description</h3>

<p>The spatialBehaviour() function allows computing wind speed and
direction for each cell of a regular grid (i.e., a raster)
for a given tropical cyclone or set of tropical cyclones.
It also allows to compute three associated summary statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatialBehaviour(
  sts,
  product = "MSW",
  windThreshold = c(18, 33, 42, 49, 58, 70),
  method = "Willoughby",
  asymmetry = "Chen",
  empiricalRMW = FALSE,
  spaceRes = "2.5min",
  tempRes = 1,
  verbose = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatialBehaviour_+3A_sts">sts</code></td>
<td>
<p><code>StormsList</code> object</p>
</td></tr>
<tr><td><code id="spatialBehaviour_+3A_product">product</code></td>
<td>
<p>character vector. Desired output statistics:
</p>

<ul>
<li> <p><code>"Profiles"</code>, for 2D wind speed and direction fields,
</p>
</li>
<li> <p><code>"MSW"</code>, for maximum sustained wind speed (default setting),
</p>
</li>
<li> <p><code>"PDI"</code>, for power dissipation index, or
</p>
</li>
<li> <p><code>"Exposure"</code>, for duration of exposure.
</p>
</li></ul>
</td></tr>
<tr><td><code id="spatialBehaviour_+3A_windthreshold">windThreshold</code></td>
<td>
<p>numeric vector. Minimal wind threshold(s) (in <code class="reqn">m.s^{-1}</code>) used to
compute the duration of exposure when <code>product="Exposure"</code>. By default the thresholds
used in the Saffir-Simpson hurricane wind scale are used (i.e., 18, 33, 42, 49, 58, 70 <code class="reqn">m.s^{-1}</code>).</p>
</td></tr>
<tr><td><code id="spatialBehaviour_+3A_method">method</code></td>
<td>
<p>character. Model used to compute wind speed and direction.
Three different models are implemented:
</p>

<ul>
<li> <p><code>"Willoughby"</code>, for the symmetrical model developed by Willoughby et al. (2006) (default setting),
</p>
</li>
<li> <p><code>"Holland"</code>, for the symmetrical model developed by Holland (1980), or
</p>
</li>
<li> <p><code>"Boose"</code>, for the asymmetrical model developed by  Boose et al. (2004).
</p>
</li></ul>
</td></tr>
<tr><td><code id="spatialBehaviour_+3A_asymmetry">asymmetry</code></td>
<td>
<p>character. If <code>method="Holland"</code> or <code>method="Willoughby"</code>,
this argument specifies the method used to add asymmetry. Can be:
</p>

<ul>
<li> <p><code>"Chen"</code>, for the model developed by Chen (1994) (default setting),
</p>
</li>
<li> <p><code>"Miyazaki"</code>, for the model developed by Miyazaki et al. (1962), or
</p>
</li>
<li> <p><code>"None"</code>, for no asymmetry.
</p>
</li></ul>
</td></tr>
<tr><td><code id="spatialBehaviour_+3A_empiricalrmw">empiricalRMW</code></td>
<td>
<p>logical. Whether (TRUE) or not (FALSE) to compute
the radius of maximum wind (<code>rmw</code>) empirically using the model developed by
Willoughby et al. (2006). If <code>empiricalRMW==FALSE</code> (default setting) then the
<code>rmw</code> provided in the <code>StormsList</code> is used.</p>
</td></tr>
<tr><td><code id="spatialBehaviour_+3A_spaceres">spaceRes</code></td>
<td>
<p>character. Spatial resolution. Can be <code>"30 sec"</code> (~1 km at the equator),
<code>"2.5 min"</code> (~4.5 km at the equator), <code>"5 min"</code> (~9 km at the equator) or <code>"10 min"</code> (~18.6 km at the equator).
Default setting is <code>"2.5 min"</code>.</p>
</td></tr>
<tr><td><code id="spatialBehaviour_+3A_tempres">tempRes</code></td>
<td>
<p>numeric. Temporal resolution. Can be <code>1</code> (for 60 min, default setting),
<code>0.75</code> (for 45min), <code>0.5</code> (for 30 min), and <code>0.25</code> (15 for min).</p>
</td></tr>
<tr><td><code id="spatialBehaviour_+3A_verbose">verbose</code></td>
<td>
<p>numeric. Whether or not the function should display
informations about the process and/or outputs. Can be:
</p>

<ul>
<li> <p><code>2</code>, information about the processes and outputs are displayed (default setting),
</p>
</li>
<li> <p><code>1</code>, information about the processes are displayed, pr
</p>
</li>
<li> <p><code>0</code>, no information displayed.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>Storm track data sets, such as those extracted from IBRTrACKS (Knapp et
al., 2010), usually provide observation at a 3- or 6-hours temporal
resolution. In the spatialBehaviour() function, linear interpolations are
used to reach the temporal resolution specified in the <code>tempRes</code> argument
(default value = 1 hour). When <code>product = "MSW"</code>, <code>product = "PDI"</code>,
or <code>product = "Exposure"</code> the <code>focal()</code> function from the <code>terra</code> R package
is used to smooth the results using moving windows.
</p>
<p>The Holland (1980) model, widely used in the literature, is based on the
'gradient wind balance in mature tropical cyclones. The wind speed distribution
is computed from the circular air pressure field, which can be derived from
the central and environmental pressure and the radius of maximum winds.
</p>
<p><code class="reqn">v_r = \sqrt{\frac{b}{\rho} \times \left(\frac{R_m}{r}\right)^b \times (p_{oci} - p_c)
  \times e^{-\left(\frac{R_m}{r}\right)^b} + \left(\frac{r \times f}{2}\right)^2} -
  \left(\frac{r \times f}{2}\right)</code>
</p>
<p>with,
</p>
<p><code class="reqn">b = \frac{\rho \times e \times v_m^2}{p_{oci} - p_c}</code>
</p>
<p><code class="reqn">f = 2 \times 7.29 \times 10^{-5} \sin(\phi)</code>
</p>
<p>where, <code class="reqn">v_r</code> is the tangential wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">b</code> is the shape parameter,
<code class="reqn">\rho</code> is the air density set to <code class="reqn">1.15 kg.m^{-3}</code>,
<code class="reqn">e</code> being the base of natural logarithms (~2.718282),
<code class="reqn">v_m</code> the maximum sustained wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">p_{oci}</code> is the pressure at outermost closed isobar of the storm (in <code class="reqn">Pa</code>),
<code class="reqn">p_c</code> is the pressure at the centre of the storm (in <code class="reqn">Pa</code>),
<code class="reqn">r</code> is the distance to the eye of the storm (in <code class="reqn">km</code>),
<code class="reqn">R_m</code> is the radius of maximum sustained wind speed (in <code class="reqn">km</code>),
<code class="reqn">f</code> is the Coriolis force (in <code class="reqn">N.kg^{-1}</code>, and
<code class="reqn">\phi</code> being the latitude).
</p>
<p>The Willoughby et al. (2006) model is an empirical model fitted to aircraft
observations. The model considers two regions: inside the eye and at external
radii, for which the wind formulations use different exponents to better match
observations. In this model, the wind speed increases as a power function of the
radius inside the eye and decays exponentially outside the eye after a smooth
polynomial transition across the eyewall.
</p>
<p><code class="reqn">\left\{\begin{aligned}
   v_r &amp;= v_m \times \left(\frac{r}{R_m}\right)^{n} \quad if \quad r &lt; R_m \\
   v_r &amp;= v_m \times \left((1-A) \times e^{-\frac{|r-R_m|}{X1}} +
   A \times e^{-\frac{|r-R_m|}{X2}}\right) \quad if \quad r \geq R_m \\
   \end{aligned}
   \right.
   </code>
</p>
<p>with,
</p>
<p><code class="reqn">n = 2.1340 + 0.0077 \times v_m - 0.4522 \times \ln(R_m) - 0.0038 \times |\phi|</code>
</p>
<p><code class="reqn">X1 = 287.6 - 1.942 \times v_m + 7.799 \times \ln(R_m) + 1.819 \times |\phi|</code>
</p>
<p><code class="reqn">A = 0.5913 + 0.0029 \times v_m - 0.1361 \times \ln(R_m) - 0.0042 \times |\phi|</code> and <code class="reqn">A\ge0</code>
</p>
<p>where, <code class="reqn">v_r</code> is the tangential wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">v_m</code> is the maximum sustained wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">r</code> is the distance to the eye of the storm (in <code class="reqn">km</code>),
<code class="reqn">R_m</code> is the radius of maximum sustained wind speed (in <code class="reqn">km</code>),
<code class="reqn">\phi</code> is the latitude of the centre of the storm,
<code class="reqn">X2 = 25</code>.
</p>
<p>Asymmetry can be added to Holland (1980) and Willoughby et al. (2006) wind fields as follows,
</p>
<p><code class="reqn">\vec{V} = \vec{V_c} + C \times \vec{V_t}</code>
</p>
<p>where, <code class="reqn">\vec{V}</code> is the combined asymmetric wind field,
<code class="reqn">\vec{V_c}</code> is symmetric wind field,
<code class="reqn">\vec{V_t}</code> is the translation speed of the storm, and
<code class="reqn">C</code> is function of <code class="reqn">r</code>, the distance to the eye of the storm (in <code class="reqn">km</code>).
</p>
<p>Two formulations of C proposed by Miyazaki et al. (1962) and Chen (1994) are implemented.
</p>
<p>Miyazaki et al. (1962)
<code class="reqn">C = e^{(-\frac{r}{500} \times \pi)}</code>
</p>
<p>Chen (1994)
<code class="reqn">C = \frac{3 \times R_m^{\frac{3}{2}} \times r^{\frac{3}{2}}}{R_m^3 +
  r^3 +R_m^{\frac{3}{2}} \times r^{\frac{3}{2}}}</code>
</p>
<p>where, <code class="reqn">R_m</code> is the radius of maximum sustained wind speed (in <code class="reqn">km</code>)
</p>
<p>The Boose et al. (2004) model, or “HURRECON” model, is a modification of the
Holland (1980) model. In addition to adding
asymmetry, this model treats of water and land differently, using different
surface friction coefficient for each.
</p>
<p><code class="reqn">v_r = F\left(v_m - S \times (1 - \sin(T)) \times \frac{v_h}{2} \right) \times
  \sqrt{\left(\frac{R_m}{r}\right)^b \times e^{1 - \left(\frac{R_m}{r}\right)^b}}</code>
</p>
<p>with,
</p>
<p><code class="reqn">b = \frac{\rho \times e \times v_m^2}{p_{oci} - p_c}</code>
</p>
<p>where, <code class="reqn">v_r</code> is the tangential wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">F</code> is a scaling parameter for friction (<code class="reqn">1.0</code> in water, <code class="reqn">0.8</code> in land),
<code class="reqn">v_m</code> is the maximum sustained wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">S</code> is a scaling parameter for asymmetry (usually set to <code class="reqn">1</code>),
<code class="reqn">T</code> is the oriented angle (clockwise/counter clockwise in Northern/Southern Hemisphere) between
the forward trajectory of the storm and a radial line from the eye of the storm to point $r$
<code class="reqn">v_h</code> is the storm velocity (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">R_m</code> is the radius of maximum sustained wind speed (in <code class="reqn">km</code>),
<code class="reqn">r</code> is the distance to the eye of the storm (in <code class="reqn">km</code>),
<code class="reqn">b</code> is the shape parameter,
<code class="reqn">\rho = 1.15</code> is the air density (in <code class="reqn">kg.m^{-3}</code>),
<code class="reqn">p_{oci}</code> is the pressure at outermost closed isobar of the storm (in <code class="reqn">Pa</code>), and
<code class="reqn">p_c</code> is the pressure at the centre of the storm (<code class="reqn">pressure</code> in <code class="reqn">Pa</code>).
</p>


<h3>Value</h3>

<p>The spatialBehaviour() function returns SpatRaster objects (in WGS84).
The number of layers in the output depends on the number of storms in the inputs,
on the desired <code>product</code>, as well as the <code>tempRes</code> argument:
</p>

<ul>
<li><p> if <code>product = "MSW"</code>, the function returns one layer for each <code>Storm</code>.
The names of the layer follow the following terminology, the name of the storm
in capital letters and “MSW” separated by underscores (e.g., &quot;PAM_MSW&quot;),
</p>
</li>
<li><p> if <code>product = "PDI"</code>, the function returns one layer for each <code>Storm</code>.
The names of the layer follow the following terminology, the name of the storm
in capital letters and “PDI” separated by underscores (e.g., &quot;PAM_PDI&quot;),
</p>
</li>
<li><p> if <code>product ="Exposure"</code>, the function returns one layer for each wind speed values
in the <code>windThreshold</code> argument and for each <code>Storm</code>. The names of the layer follow the
following terminology, the name of the storm in capital letters, &quot;Exposure&quot;, and the threshold
value separated by underscores (e.g., &quot;PAM_Exposure_18&quot;, &quot;PAM_Exposure_33&quot;, ...),
</p>
</li>
<li><p> if <code>product = "Profiles"</code> the function returns one layer for wind speed and
one layer for wind direction for each observation or interpolated observation and each <code>Storm</code>.
The names of the layer follow the following terminology, the name of the storm in capital letters,
&quot;Speed&quot; or &quot;Direction&quot;, and the indices of the observation separated by underscores
(e.g., &quot;PAM_Speed_41&quot;, &quot;PAM_Direction_41&quot;,...).
</p>
</li></ul>



<h3>References</h3>

<p>Boose, E. R., Serrano, M. I., &amp; Foster, D. R. (2004). Landscape and regional impacts of hurricanes in Puerto Rico.
Ecological Monographs, 74(2), Article 2. https://doi.org/10.1890/02-4057
</p>
<p>Chen, K.-M. (1994). A computation method for typhoon wind field. Tropic Oceanology, 13(2), 41–48.
</p>
<p>Holland, G. J. (1980). An Analytic Model of the Wind and Pressure Profiles in Hurricanes.
Monthly Weather Review, 108(8), 1212–1218. https://doi.org/10.1175/1520-0493(1980)108&lt;1212:AAMOTW&gt;2.0.CO;2
</p>
<p>Knapp, K. R., Kruk, M. C., Levinson, D. H., Diamond, H. J., &amp; Neumann, C. J. (2010).
The International Best Track Archive for Climate Stewardship (IBTrACS).
Bulletin of the American Meteorological Society, 91(3), Article 3. https://doi.org/10.1175/2009bams2755.1
</p>
<p>Miyazaki, M., Ueno, T., &amp; Unoki, S. (1962). The theoretical investigations of
typhoon surges along the Japanese coast (II). Oceanographical Magazine, 13(2), 103–117.
</p>
<p>Willoughby, H. E., Darling, R. W. R., &amp; Rahn, M. E. (2006). Parametric Representation of
the Primary Hurricane Vortex. Part II: A New Family of Sectionally Continuous Profiles.
Monthly Weather Review, 134(4), 1102–1120. https://doi.org/10.1175/MWR3106.1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Creating a stormsDataset
sds &lt;- defStormsDataset()

# Geting storm track data for tropical cyclone Pam (2015) near Vanuatu
pam &lt;- defStormsList(sds = sds, loi = "Vanuatu", names = "PAM")

# Computing maximum sustained wind speed generated by Pam (2015) near Vanuatu
# using default settings
msw.pam &lt;- spatialBehaviour(pam)

# Computing PDI generated by Pam (2015) near Vanuatu using the Holland model without asymmetry
pdi.pam &lt;- spatialBehaviour(pam, method = "Holland", product = "PDI", asymmetry = "None")

# Computing duration of exposure to Saffir-Simpson hurricane wind scale threshold values
# during Pam (2015) near Vanuatu using default settings
exp.pam &lt;- spatialBehaviour(pam, product = "Exposure")

# Computing wind speed and direction profiles  generated by Pam (2015) near Vanuatu
# using Boose model
prof.pam &lt;- spatialBehaviour(pam, product = "Profiles", method = "Boose")

</code></pre>

<hr>
<h2 id='storm-class'><code>storm</code>  object</h2><span id='topic+storm-class'></span><span id='topic+storm'></span>

<h3>Description</h3>

<p>Gather all the needed informations to model a single storm
</p>


<h3>Value</h3>

<p>A <code>storm</code> object.
</p>

<ul>
<li> <p><code>name</code>, character.
</p>
</li>
<li> <p><code>season</code>, numeric.
</p>
</li>
<li> <p><code>sshs</code>, numeric.
</p>
</li>
<li> <p><code>obs</code>, numeric.
</p>
</li>
<li> <p><code>obs.all</code>, data.frame.
</p>
</li></ul>



<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>character. Name of the storm</p>
</dd>
<dt><code>season</code></dt><dd><p>numeric. Cyclonic season in which the storm has occured</p>
</dd>
<dt><code>sshs</code></dt><dd><p>numeric. Maximum category reached in the Saffir Simpson Hurricane
Scale</p>
</dd>
<dt><code>obs</code></dt><dd><p>numeric vector. Indices of observations within the location of
interest extented with its corresponding buffer (See <code>stormsList</code> class)</p>
</dd>
<dt><code>obs.all</code></dt><dd><p>data.frame. Contains all of the observations available. An
observation is made up of several fields which are:
</p>

<ul>
<li> <p><code>iso.time</code>, Date and hours of observations (UTC)
</p>
</li>
<li> <p><code>lon</code>, Longitude coordinate (Eastern degree)
</p>
</li>
<li> <p><code>lat</code>, Latitude coordinate (Northern degree)
</p>
</li>
<li> <p><code>msw</code>, Maximum Sustained Wind (m/s)
</p>
</li>
<li> <p><code>sshs</code>, Category in the Saffir Simpson Hurricane Scale
</p>
</li></ul>

<p>The following field is not mandatory but highly recommended
</p>

<ul>
<li> <p><code>rmw</code>, Radius of Maximum Wind (km)
</p>
</li></ul>

<p>Also, the following fields are only mandatory to perform Holland and Boose
models (See <code>Details</code>)
</p>

<ul>
<li> <p><code>pres</code>, Pressure at the center (pa)
</p>
</li>
<li> <p><code>poci</code>, Pressure of the Outermost Closed Isobar (pa)
</p>
</li></ul>
</dd>
</dl>

<hr>
<h2 id='stormsDataset-class'>stormsDataset</h2><span id='topic+stormsDataset-class'></span><span id='topic+stormsDataset'></span>

<h3>Description</h3>

<p>Choose the database to use within the package's functions
</p>


<h3>Details</h3>

<p>The fields input must provide at least 6 mandatory fields (and at most 11) in
order to benefit from all the functionalities of this package:
</p>

<ul>
<li><p> A field <code>names</code>: which dimension contains the names of storms
in the netcdf database
</p>
</li>
<li><p> A field <code>seasons</code>: which dimension contains the cyclonic
seasons of storms in the netcdf database
</p>
</li>
<li><p> A field <code>isoTime</code>: which dimension contains the ISO times of
each (3 or 6 hourly) observations for all storms in the database
</p>
</li>
<li><p> A field <code>lon</code>: which dimension contains the longitude
coordinates of each observations for all storms in
the netcdf database
</p>
</li>
<li><p> A field <code>lat</code>: which dimension contains the latitude
coordinates of each observations for all storms in
the netcdf database
</p>
</li>
<li><p> A field <code>msw</code>: which dimension contains the maximum sustained
wind speed of each observations for all storms in the netcdf
database
</p>
</li></ul>

<p>The following fields are optional but highly recommended:
</p>

<ul>
<li><p> A field <code>basin</code>: which dimension contains the basin location of
storms in the netcdf database. Used to filter the storms in the netcdf
database
</p>
</li>
<li><p> A field <code>rmw</code>: which dimension contains the radius of maximum
wind speed of each observations for all storms in the netcdf
database (See spatialBehaviour, temporalBehaviour)
</p>
</li>
<li><p> A field <code>sshs</code>: which dimension contains the Saffir Simpson
Hurricane Scale index of each observations for all storms in the
netcdf database
</p>
</li></ul>

<p>Finally these following fields are optional but mandatory to perform Holland
model (See <code>spatialBehaviour</code>, <code>temporalBehaviour</code>)
</p>

<ul>
<li><p> A field <code>pressure</code>: which dimension contains the pressure
in the eye for of each observations for all storms in the netcdf
database
</p>
</li>
<li><p> A field <code>poci</code>: which dimension contains the Pressure at the
Outermost Closed Isobar for of each observations for all storms
in the nectdf database
</p>
</li></ul>

<p>Default value is set according to the most relevant dimensions of IBTrACS
databases:
<code>fields = c(basin = "basin", names = "name", seasons = "season", isoTime = "iso_time", lon = "usa_lon", lat = "usa_lat", msw = "usa_wind", rmw = "usa_rmw", pressure = "usa_pres", poci = "usa_poci", sshs = "usa_sshs")</code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>filename</code></dt><dd><p>character. Name of the database to load. Must be a netcdf file</p>
</dd>
<dt><code>fields</code></dt><dd><p>named character vector. Dictionary that provides all the name of
dimensions to extract from the netcdf database (See <code>Details</code>)</p>
</dd>
<dt><code>basin</code></dt><dd><p>character. Basin name to filter the database within its
boundaries. It must be either
</p>

<ul>
<li> <p><code>"NA"</code>: North Atlantic
</p>
</li>
<li> <p><code>"SA"</code>: South Atlantic
</p>
</li>
<li> <p><code>"EP"</code>: Eastern North Pacific
</p>
</li>
<li> <p><code>"WP"</code>: Western North Pacific
</p>
</li>
<li> <p><code>"SP"</code>: South Pacific
</p>
</li>
<li> <p><code>"SI"</code>: South India
</p>
</li>
<li> <p><code>"NI"</code>: North India
</p>
</li>
<li> <p><code>"None"</code>: No particular basin
</p>
</li></ul>
</dd>
<dt><code>seasons</code></dt><dd><p>numeric vector. Range of calendar years to filter storms. For
cyclones that formed in one year and dissipated in the following year, the
latter should be used</p>
</dd>
<dt><code>database</code></dt><dd><p>list of 6 to 10 slots depending on the fields input. Each slot
is either a 1D array of dimension (number of storms) for <code>names</code> and
<code>seasons</code> fields, or a 2D array of dimension
(Maximum number of observations:number of storms), for the remaining fields
which are <code>isoTime</code>, <code>lon</code>, <code>lat</code>, <code>msw</code>, <code>rmw</code>, <code>pressure</code>, <code>poci</code>, <code>sshs</code></p>
</dd>
</dl>

<hr>
<h2 id='stormsList-class'><code>stormsList</code> object</h2><span id='topic+stormsList-class'></span><span id='topic+stormsList'></span>

<h3>Description</h3>

<p>Gather all the needed informations to model a set of storms
</p>


<h3>Value</h3>

<p>A <code>stormsList</code> object.
</p>

<ul>
<li> <p><code>data</code>, list.
</p>
</li>
<li> <p><code>buffer</code>, numeric.
</p>
</li>
<li> <p><code>spatialLoi</code>, sf.
</p>
</li>
<li> <p><code>spatialLoiBuffer</code>, sf.
</p>
</li></ul>



<h3>Slots</h3>


<dl>
<dt><code>data</code></dt><dd><p>A list of <code>storm</code> (See <code>storm</code> class)</p>
</dd>
<dt><code>buffer</code></dt><dd><p>numeric. Buffer used to extent <code>spatialLoi</code> (km)</p>
</dd>
<dt><code>spatialLoi</code></dt><dd><p>sf object. Represents the location of interest. Projection
is EPSG:4326</p>
</dd>
<dt><code>spatialLoiBuffer</code></dt><dd><p>sf object. Buffer extension of <code>spatialLoi</code></p>
</dd>
</dl>

<hr>
<h2 id='temporalBehaviour'>Computing wind behaviour time series and summary statistics at given point locations</h2><span id='topic+temporalBehaviour'></span>

<h3>Description</h3>

<p>The <code>temporalBehaviour()</code> function allows computing wind speed and direction
for a given location or set of locations along the lifespan of a tropical cyclone.
It also allows to compute three associated summary statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temporalBehaviour(
  sts,
  points,
  product = "TS",
  windThreshold = c(18, 33, 42, 49, 58, 70),
  method = "Willoughby",
  asymmetry = "Chen",
  empiricalRMW = FALSE,
  tempRes = 1,
  verbose = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="temporalBehaviour_+3A_sts">sts</code></td>
<td>
<p><code>StormsList</code> object.</p>
</td></tr>
<tr><td><code id="temporalBehaviour_+3A_points">points</code></td>
<td>
<p>data.frame. Consisting of two columns names as &quot;x&quot; (for the longitude) and
&quot;y&quot; (for the latitude), providing the coordinates in decimal degrees of the point locations. Row names
can also be provided to named the locations.</p>
</td></tr>
<tr><td><code id="temporalBehaviour_+3A_product">product</code></td>
<td>
<p>character. Desired output statistics:
</p>

<ul>
<li> <p><code>"TS"</code>, for time series of wind speeds and directions (default setting),
</p>
</li>
<li> <p><code>"PDI"</code>, for power dissipation index, or
</p>
</li>
<li> <p><code>"Exposure"</code>, for the duration of exposure to defined wind thresholds.
</p>
</li></ul>
</td></tr>
<tr><td><code id="temporalBehaviour_+3A_windthreshold">windThreshold</code></td>
<td>
<p>numeric vector. Minimal wind threshold(s) (in <code class="reqn">m.s^{-1}</code>) used to
compute the duration of exposure when <code>product="Exposure"</code>. By default the thresholds
used in the Saffir-Simpson hurricane wind scale are used (i.e., 18, 33, 42, 49, 58, 70 <code class="reqn">m.s^{-1}</code>).</p>
</td></tr>
<tr><td><code id="temporalBehaviour_+3A_method">method</code></td>
<td>
<p>character. Model used to compute wind speed and direction.
Three different models are implemented:
</p>

<ul>
<li> <p><code>"Willoughby"</code>, for the symmetrical model developed by Willoughby et al. (2006) (default setting),
</p>
</li>
<li> <p><code>"Holland"</code>, for the symmetrical model developed by Holland (1980), or
</p>
</li>
<li> <p><code>"Boose"</code>, for the asymmetrical model developed by  Boose et al. (2004).
</p>
</li></ul>
</td></tr>
<tr><td><code id="temporalBehaviour_+3A_asymmetry">asymmetry</code></td>
<td>
<p>character. If <code>method="Holland"</code> or <code>method="Willoughby"</code>,
this argument specifies the method used to add asymmetry. Can be:
</p>

<ul>
<li> <p><code>"Chen"</code>, for the model developed by Chen (1994) (default setting),
</p>
</li>
<li> <p><code>"Miyazaki"</code>, for the model developed by Miyazaki et al. (1962), or
</p>
</li>
<li> <p><code>"None"</code>, for no asymmetry.
</p>
</li></ul>
</td></tr>
<tr><td><code id="temporalBehaviour_+3A_empiricalrmw">empiricalRMW</code></td>
<td>
<p>logical. Whether (TRUE) or not (FALSE) to compute
the radius of maximum wind (<code>rmw</code>) empirically using the model developed by
Willoughby et al. (2006). If <code>empiricalRMW==FALSE</code> (default setting) then the
<code>rmw</code> provided in the <code>StormsList</code> is used.</p>
</td></tr>
<tr><td><code id="temporalBehaviour_+3A_tempres">tempRes</code></td>
<td>
<p>numeric. Temporal resolution. Can be <code>1</code> (for 60 min, default setting),
<code>0.75</code> (for 45min), <code>0.5</code> (for 30 min), and <code>0.25</code> (15 for min).</p>
</td></tr>
<tr><td><code id="temporalBehaviour_+3A_verbose">verbose</code></td>
<td>
<p>numeric. Information displayed. Can be:
</p>

<ul>
<li> <p><code>2</code>, information about the processes and outputs are displayed (default setting),
</p>
</li>
<li> <p><code>1</code>, information about the processes are displayed, or
</p>
</li>
<li> <p><code>0</code>, no information displayed.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>Storm track data sets, such as those extracted from IBRTrACKS (Knapp et
al., 2010), usually provide observation at a 3- or 6-hours temporal
resolution. In the temporalBehaviour() function, linear interpolations are
used to reach the temporal resolution specified in the <code>tempRes</code> argument
(default value = 1 hour).
</p>
<p>The Holland (1980) model, widely used in the literature, is based on the
'gradient wind balance in mature tropical cyclones. The wind speed distribution
is computed from the circular air pressure field, which can be derived from
the central and environmental pressure and the radius of maximum winds.
</p>
<p><code class="reqn">v_r = \sqrt{\frac{b}{\rho} \times \left(\frac{R_m}{r}\right)^b \times (p_{oci} - p_c)
  \times e^{-\left(\frac{R_m}{r}\right)^b} + \left(\frac{r \times f}{2}\right)^2} -
  \left(\frac{r \times f}{2}\right)</code>
</p>
<p>with,
</p>
<p><code class="reqn">b = \frac{\rho \times e \times v_m^2}{p_{oci} - p_c}</code>
</p>
<p><code class="reqn">f = 2 \times 7.29 \times 10^{-5} \sin(\phi)</code>
</p>
<p>where, <code class="reqn">v_r</code> is the tangential wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">b</code> is the shape parameter,
<code class="reqn">\rho</code> is the air density set to <code class="reqn">1.15 kg.m^{-3}</code>,
<code class="reqn">e</code> being the base of natural logarithms (~2.718282),
<code class="reqn">v_m</code> the maximum sustained wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">p_{oci}</code> is the pressure at outermost closed isobar of the storm (in <code class="reqn">Pa</code>),
<code class="reqn">p_c</code> is the pressure at the centre of the storm (in <code class="reqn">Pa</code>),
<code class="reqn">r</code> is the distance to the eye of the storm (in <code class="reqn">km</code>),
<code class="reqn">R_m</code> is the radius of maximum sustained wind speed (in <code class="reqn">km</code>),
<code class="reqn">f</code> is the Coriolis force (in <code class="reqn">N.kg^{-1}</code>, and
<code class="reqn">\phi</code> being the latitude).
</p>
<p>The Willoughby et al. (2006) model is an empirical model fitted to aircraft
observations. The model considers two regions: inside the eye and at external
radii, for which the wind formulations use different exponents to better match
observations. In this model, the wind speed increases as a power function of the
radius inside the eye and decays exponentially outside the eye after a smooth
polynomial transition across the eyewall.
</p>
<p><code class="reqn">\left\{\begin{aligned}
   v_r &amp;= v_m \times \left(\frac{r}{R_m}\right)^{n} \quad if \quad r &lt; R_m \\
   v_r &amp;= v_m \times \left((1-A) \times e^{-\frac{|r-R_m|}{X1}} +
   A \times e^{-\frac{|r-R_m|}{X2}}\right) \quad if \quad r \geq R_m \\
   \end{aligned}
   \right.
   </code>
</p>
<p>with,
</p>
<p><code class="reqn">n = 2.1340 + 0.0077 \times v_m - 0.4522 \times \ln(R_m) - 0.0038 \times |\phi|</code>
</p>
<p><code class="reqn">X1 = 287.6 - 1.942 \times v_m + 7.799 \times \ln(R_m) + 1.819 \times |\phi|</code>
</p>
<p><code class="reqn">A = 0.5913 + 0.0029 \times v_m - 0.1361 \times \ln(R_m) - 0.0042 \times |\phi|</code> and <code class="reqn">A\ge0</code>
</p>
<p>where, <code class="reqn">v_r</code> is the tangential wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">v_m</code> is the maximum sustained wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">r</code> is the distance to the eye of the storm (in <code class="reqn">km</code>),
<code class="reqn">R_m</code> is the radius of maximum sustained wind speed (in <code class="reqn">km</code>),
<code class="reqn">\phi</code> is the latitude of the centre of the storm,
<code class="reqn">X2 = 25</code>.
</p>
<p>Asymmetry can be added to Holland (1980) and Willoughby et al. (2006) wind fields as follows,
</p>
<p><code class="reqn">\vec{V} = \vec{V_c} + C \times \vec{V_t}</code>
</p>
<p>where, <code class="reqn">\vec{V}</code> is the combined asymmetric wind field,
<code class="reqn">\vec{V_c}</code> is symmetric wind field,
<code class="reqn">\vec{V_t}</code> is the translation speed of the storm, and
<code class="reqn">C</code> is function of <code class="reqn">r</code>, the distance to the eye of the storm (in <code class="reqn">km</code>).
</p>
<p>Two formulations of C proposed by Miyazaki et al. (1962) and Chen (1994) are implemented.
</p>
<p>Miyazaki et al. (1962)
<code class="reqn">C = e^{(-\frac{r}{500} \times \pi)}</code>
</p>
<p>Chen (1994)
<code class="reqn">C = \frac{3 \times R_m^{\frac{3}{2}} \times
  r^{\frac{3}{2}}}{R_m^3 + r^3 +R_m^{\frac{3}{2}} \times r^{\frac{3}{2}}}</code>
</p>
<p>where, <code class="reqn">R_m</code> is the radius of maximum sustained wind speed (in <code class="reqn">km</code>)
</p>
<p>The Boose et al. (2004) model, or “HURRECON” model, is a modification of the
Holland (1980) model. In addition to adding
asymmetry, this model treats of water and land differently, using different
surface friction coefficient for each.
</p>
<p><code class="reqn">v_r = F\left(v_m - S \times (1 - \sin(T)) \times \frac{v_h}{2} \right)
  \times \sqrt{\left(\frac{R_m}{r}\right)^b \times e^{1 - \left(\frac{R_m}{r}\right)^b}}</code>
</p>
<p>with,
</p>
<p><code class="reqn">b = \frac{\rho \times e \times v_m^2}{p_{oci} - p_c}</code>
</p>
<p>where, <code class="reqn">v_r</code> is the tangential wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">F</code> is a scaling parameter for friction (<code class="reqn">1.0</code> in water, <code class="reqn">0.8</code> in land),
<code class="reqn">v_m</code> is the maximum sustained wind speed (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">S</code> is a scaling parameter for asymmetry (usually set to <code class="reqn">1</code>),
<code class="reqn">T</code> is the oriented angle (clockwise/counter clockwise in Northern/Southern Hemisphere) between
the forward trajectory of the storm and a radial line from the eye of the storm to point $r$
<code class="reqn">v_h</code> is the storm velocity (in <code class="reqn">m.s^{-1}</code>),
<code class="reqn">R_m</code> is the radius of maximum sustained wind speed (in <code class="reqn">km</code>),
<code class="reqn">r</code> is the distance to the eye of the storm (in <code class="reqn">km</code>),
<code class="reqn">b</code> is the shape parameter,
<code class="reqn">\rho = 1.15</code> is the air density (in <code class="reqn">kg.m^{-3}</code>),
<code class="reqn">p_{oci}</code> is the pressure at outermost closed isobar of the storm (in <code class="reqn">Pa</code>), and
<code class="reqn">p_c</code> is the pressure at the centre of the storm (<code class="reqn">pressure</code> in <code class="reqn">Pa</code>).
</p>


<h3>Value</h3>

<p>For each storm and each point location, the <code>temporalBehaviour()</code> function returns
a data.frame. The data frames are organised into named lists. Depending on the <code>product</code> argument
different data.frame are returned:
</p>

<ul>
<li><p> if <code>product == "TS"</code>, the function returns a data.frame with
one row for each observation (or interpolated observation) and
four columns for wind speed (in <code class="reqn">m.s^{-1}</code>), wind direction (in degree),
the observation number, and the ISO time of observations,
</p>
</li>
<li><p> if <code>product == "PDI"</code>, the function returns a data.frame with one row
for each point location and one column for the PDI,
</p>
</li>
<li><p> if <code>product == "Exposure"</code>, the function returns a data.frame with one
row for the duration of exposure to winds above each wind speed threshold defined
by the <code>windThreshold</code> argument and one column for each point location.
</p>
</li></ul>



<h3>References</h3>

<p>Boose, E. R., Serrano, M. I., &amp; Foster, D. R. (2004). Landscape and regional impacts of hurricanes in Puerto Rico.
Ecological Monographs, 74(2), Article 2. https://doi.org/10.1890/02-4057
</p>
<p>Chen, K.-M. (1994). A computation method for typhoon wind field. Tropic Oceanology, 13(2), 41–48.
</p>
<p>Holland, G. J. (1980). An Analytic Model of the Wind and Pressure
Profiles in Hurricanes. Monthly Weather Review, 108(8), 1212–1218.
https://doi.org/10.1175/1520-0493(1980)108&lt;1212:AAMOTW&gt;2.0.CO;2
</p>
<p>Knapp, K. R., Kruk, M. C., Levinson, D. H., Diamond, H. J., &amp; Neumann, C. J. (2010). The
International Best Track Archive for Climate Stewardship (IBTrACS).
Bulletin of the American Meteorological Society, 91(3), Article 3. https://doi.org/10.1175/2009bams2755.1
</p>
<p>Miyazaki, M., Ueno, T., &amp; Unoki, S. (1962). The theoretical investigations of typhoon surges
along the Japanese coast (II).
Oceanographical Magazine, 13(2), 103–117.
</p>
<p>Willoughby, H. E., Darling, R. W. R., &amp; Rahn, M. E. (2006). Parametric Representation of the
Primary Hurricane Vortex. Part II: A New Family of Sectionally Continuous Profiles.
Monthly Weather Review, 134(4), 1102–1120. https://doi.org/10.1175/MWR3106.1
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Creating a stormsDataset

sds &lt;- defStormsDataset()

# Geting storm track data for tropical cyclone Pam (2015) near Vanuatu
pam &lt;- defStormsList(sds = sds, loi = "Vanuatu", names = "PAM")

pts &lt;- data.frame(x = c(168.5, 168), y = c(-17.9, -16.3))
row.names(pts) &lt;- c("point_1", "point_2")

# Computing time series of wind speed and direction for Pam
# over points 1 and 2 defined above
ts.pam &lt;- temporalBehaviour(pam, points = pts)

# Computing PDI for Pam over points 1 and 2 defined above
pdi.pam &lt;- temporalBehaviour(pam, points = pts, product = "PDI")

# Computing the duration of exposure to wind speeds above the thresholds
# used by the Saffir-Simpson hurricane wind scale for Pam
# over points 1 and 2 defined above
exp.pam &lt;- temporalBehaviour(pam, points = pts, product = "Exposure")

</code></pre>

<hr>
<h2 id='writeRast'>Exporting rasters to GeoTIFF or NetCDF files</h2><span id='topic+writeRast'></span>

<h3>Description</h3>

<p>The <code>writeRast()</code> function exports rasters stored in SpatRaster objects to
GeoTIFF or NetCDF files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeRast(rast, filename = NULL, path = "./", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeRast_+3A_rast">rast</code></td>
<td>
<p><code>SpatRaster</code> object.</p>
</td></tr>
<tr><td><code id="writeRast_+3A_filename">filename</code></td>
<td>
<p>character. Output file name. Can be either a <code>".tiff"</code> file (GeoTIFF) or <code>".nc"</code> (NetCDF).
By default <code>filename=NULL</code> and the name of the file is generated based on
raster information (storms and products) with the '.tiff' extension.</p>
</td></tr>
<tr><td><code id="writeRast_+3A_path">path</code></td>
<td>
<p>character. Path to the directory where the file is exported to. By default <code style="white-space: pre;">&#8288;path=./'&#8288;</code>.</p>
</td></tr>
<tr><td><code id="writeRast_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to
<a href="https://rdrr.io/cran/terra/man/writeRaster.html"><code>terra::writeRaster</code></a>
function when saving to <code>".tiff"</code> format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Creating a stormsDataset

sds &lt;- defStormsDataset()

# Getting storm track data for tropical cyclone Pam (2015) near Vanuatu
pam &lt;- defStormsList(sds = sds, loi = "Vanuatu", names = "PAM")

# Computing maximum sustained wind speed
pam.msw &lt;- spatialBehaviour(pam)

# Exporting maximum sustained wind speed raster layer to a GeoTIFF file
writeRast(pam.msw, path = paste0(tempdir(), "/"))

# Computing power dissipation index for several storms near New Caledonia
sts.nc &lt;- defStormsList(sds = sds, loi = "New Caledonia")
pdi.nc &lt;- spatialBehaviour(sts.nc, product = "PDI")

# Exporting the power dissipation index raster layers to a NetCDF file
writeRast(pdi.nc, path = paste0(tempdir(), "/"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
