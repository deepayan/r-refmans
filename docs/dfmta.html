<!DOCTYPE html><html lang="en"><head><title>Help for package dfmta</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dfmta}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dfmta-package'>
<p>Phase I/II Adaptive Dose-Finding Design for MTA</p></a></li>
<li><a href='#mtaBin_next'><p>Optimal dose determination for MTA with binary outcomes</p></a></li>
<li><a href='#mtaBin_sim'><p>Design Simulator for MTA with binary outcomes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Phase I/II Adaptive Dose-Finding Design for MTA</td>
</tr>
<tr>
<td>Version:</td>
<td>1.7-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-30</td>
</tr>
<tr>
<td>Copyright:</td>
<td>All files in src/CppBugs are copyright Whit Armstrong. All
other files are copyright Institut de Recherches
Internationales Servier and Institut national de la sante et de
la recherche medicale.</td>
</tr>
<tr>
<td>Description:</td>
<td>Phase I/II adaptive dose-finding design for single-agent
   Molecularly Targeted Agent (MTA), according to the paper "Phase
   I/II Dose-Finding Design for Molecularly Targeted Agent: Plateau
   Determination using Adaptive Randomization", Riviere Marie-Karelle et
   al. (2016) &lt;<a href="https://doi.org/10.1177%2F0962280216631763">doi:10.1177/0962280216631763</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>RcppArmadillo (&ge; 0.7.100.3.1), BH (&ge; 1.55), RcppProgress
(&ge; 0.2.1), Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-30 15:14:03 UTC; jjourdan</td>
</tr>
<tr>
<td>Author:</td>
<td>Marie-Karelle Riviere [aut],
  Jacques-Henri Jourdan [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jacques-Henri Jourdan &lt;jacques-henri.jourdan@cnrs.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-30 15:50:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='dfmta-package'>
Phase I/II Adaptive Dose-Finding Design for MTA
</h2><span id='topic+dfmta-package'></span><span id='topic+dfmta'></span>

<h3>Description</h3>

<p>Phase I/II adaptive dose-finding design for single-agent
   Molecularly Targeted Agent (MTA), according to the paper &quot;Phase
   I/II Dose-Finding Design for Molecularly Targeted Agent: Plateau
   Determination using Adaptive Randomization&quot;, Riviere Marie-Karelle et
   al. (2016) &lt;doi:10.1177/0962280216631763&gt;.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> dfmta</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Phase I/II Adaptive Dose-Finding Design for MTA</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.7-6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-09-30</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person(given = "Marie-Karelle",
                      family = "Riviere",
                      role = "aut"),
               person(given = "Jacques-Henri",
                      family = "Jourdan",
                      role = c("aut", "cre"),
                      email = "jacques-henri.jourdan@cnrs.fr"))</td>
</tr>
<tr>
 <td style="text-align: left;">
Copyright: </td><td style="text-align: left;"> All files in src/CppBugs are copyright Whit Armstrong. All other
files are copyright Institut de Recherches Internationales Servier and
Institut national de la sante et de la recherche medicale.</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Phase I/II adaptive dose-finding design for single-agent
   Molecularly Targeted Agent (MTA), according to the paper "Phase
   I/II Dose-Finding Design for Molecularly Targeted Agent: Plateau
   Determination using Adaptive Randomization", Riviere Marie-Karelle et
   al. (2016) &lt;doi:10.1177/0962280216631763&gt;.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.4.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
LinkingTo: </td><td style="text-align: left;"> RcppArmadillo (&gt;= 0.7.100.3.1), BH (&gt;= 1.55),
RcppProgress (&gt;= 0.2.1), Rcpp</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Marie-Karelle Riviere [aut],
  Jacques-Henri Jourdan [aut, cre]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Jacques-Henri Jourdan &lt;jacques-henri.jourdan@cnrs.fr&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
dfmta-package           Phase I/II Adaptive Dose-Finding Design for MTA
mtaBin_next             Optimal dose determination for MTA with binary
                        outcomes
mtaBin_sim              Design Simulator for MTA with binary outcomes
</pre>


<h3>Author(s)</h3>

<p>Marie-Karelle Riviere [aut],
  Jacques-Henri Jourdan [aut, cre]
</p>
<p>Maintainer: Jacques-Henri Jourdan &lt;jacques-henri.jourdan@cnrs.fr&gt;
</p>


<h3>References</h3>

<p>Riviere, M-K., Yuan, Y., Jourdan, J-H., Dubois, F., and Zohar, S. Phase I/II Dose-Finding Design for Molecularly Targeted Agent: Plateau Determination using Adaptive Randomization.
</p>

<hr>
<h2 id='mtaBin_next'>Optimal dose determination for MTA with binary outcomes</h2><span id='topic+mtaBin_next'></span><span id='topic+print.mtaBin_next'></span>

<h3>Description</h3>

<p><code>mtaBin_next</code> is used to determine the next optimal dose to administer in a Phase I/II clinical trial for Molecularly Targeted Agent using the design proposed by Riviere et al. entitled &quot;Phase I/II Dose-Finding Design for Molecularly Targeted Agent: Plateau Determination using Adaptive Randomization&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtaBin_next(ngroups=1, group_cur=1, ndose, prior_tox, prior_eff, tox_max,
eff_min, cohort_start, cohort, final=FALSE, method="MTA-RA",
s_1=function(n_cur){0.2}, s_2=0.07,  group_pat, id_dose, toxicity, tite=TRUE,
efficacy, time_follow, time_eff, time_full, cycle, c_tox=0.90, c_eff=0.40,
seed = 8)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mtaBin_next_+3A_ngroups">ngroups</code></td>
<td>
<p>Number of groups for the dose-finding process leading to the recommendation of different dose levels. Several groups of efficacy (e.g. based on biomarker) sharing the same toxicity can be considered. The default value is set at 1.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_group_cur">group_cur</code></td>
<td>
<p>Group number for which the estimation and the optimal dose determination is required by the function. The default value is set at 1.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_ndose">ndose</code></td>
<td>
<p>Number of dose levels.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_prior_tox">prior_tox</code></td>
<td>
<p>A vector of initial guesses of toxicity probabilities associated with the doses. Must be of same length as <code>ndose</code>.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_prior_eff">prior_eff</code></td>
<td>
<p>A vector of initial guesses of efficacy probabilities associated with the doses for <code>group_cur</code>. Must be of same length as <code>ndose</code>.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_tox_max">tox_max</code></td>
<td>
<p>Toxicity upper bound, i.e. maximum acceptable toxicity probability.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_eff_min">eff_min</code></td>
<td>
<p>Efficacy lower bound, i.e. minimum acceptable efficacy probability.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_cohort_start">cohort_start</code></td>
<td>
<p>Cohort size for the start-up phase.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_cohort">cohort</code></td>
<td>
<p>Cohort size for the model phase.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_final">final</code></td>
<td>
<p>A boolean with value TRUE if the trial is finished and the recommended dose for further phases should be given, or FALSE (default value) if the dose determination is performed for the next cohort of patients.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_method">method</code></td>
<td>
<p>A character string to specify the method for dose allocation (&lt;=&gt; plateau determination). The default method &quot;MTA-RA&quot; use adaptive randomization on posterior probabilities for the plateau location. Method based on difference in efficacy probabilities is specified by &quot;MTA-PM&quot;.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_s_1">s_1</code></td>
<td>
<p>A function depending on the number of patients included used for adaptive randomization in plateau determination, only used if the estimation method chosen is &quot;MTA-RA&quot;. The default function is <code>function(n_cur,n){0.2}</code>.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_s_2">s_2</code></td>
<td>
<p>Cutoff value for plateau determination, only used if the estimation method chosen is &quot;MTA-PM&quot;. Can be seen as the minimal efficacy difference of practical importance. The default value is 0.07.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_group_pat">group_pat</code></td>
<td>
<p>A vector indicating the group number associated with each patient included in the trial.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_id_dose">id_dose</code></td>
<td>
<p>A vector indicating the dose levels administered to each patient included in the trial. Must be of same length as <code>group_pat</code>.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_toxicity">toxicity</code></td>
<td>
<p>A vector of observed toxicities (DLTs) for each patient included in the trial. Must be of same length as <code>group_pat</code>.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_tite">tite</code></td>
<td>
<p>A boolean indicating if the efficacy is considered as a time-to-event (default value TRUE), or if it is a binary outcome (FALSE).</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_efficacy">efficacy</code></td>
<td>
<p>A vector of observed efficacies for each patient included in the trial. Must be of same length as <code>group_pat</code>. This argument is used/required only if tite=FALSE. The observed efficacies of patients belonging to other groups than <code>group_cur</code> should also be filled (although not used) in the same order as <code>group_pat</code> (NA can be put).</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_time_follow">time_follow</code></td>
<td>
<p>A vector of follow-up times for each patient included in the trial. Must be of same length as <code>group_pat</code>. This argument is used/required only if tite=TRUE.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_time_eff">time_eff</code></td>
<td>
<p>A vector of times-to-efficacy for each patient included in the trial. If no efficacy was observed for a patient, must be filled with +Inf. Must be of same length as <code>group_pat</code>. This argument is used/required only if tite=TRUE.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_time_full">time_full</code></td>
<td>
<p>Full follow-up time window. This argument is used only if tite=TRUE.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_cycle">cycle</code></td>
<td>
<p>Minimum waiting time between two dose cohorts (usually a toxicity cycle). This argument is used only if tite=TRUE.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_c_tox">c_tox</code></td>
<td>
<p>Tocixity threshold for decision rules. The default value is set at 0.90.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_c_eff">c_eff</code></td>
<td>
<p>Efficacy threshold for decision rules. The default value is set at 0.40.</p>
</td></tr>
<tr><td><code id="mtaBin_next_+3A_seed">seed</code></td>
<td>
<p>Seed of the random number generator. Default value is set at 8.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;mtaBin_next&quot; is returned, consisting of determination of the next optimal dose level to administer and estimations. Objects generated by <code>mtaBin_next</code> contain at least the following components: 
</p>
<table role = "presentation">
<tr><td><code>prior_tox</code></td>
<td>
<p>Prior toxicities.</p>
</td></tr>
<tr><td><code>prior_eff</code></td>
<td>
<p>Prior efficacies.</p>
</td></tr>
<tr><td><code>pat_incl_group</code></td>
<td>
<p>Number of patients included.</p>
</td></tr>
<tr><td><code>n_tox_tot</code></td>
<td>
<p>Number of observed toxicities.</p>
</td></tr>
<tr><td><code>pi</code></td>
<td>
<p>Estimated toxicity probabilities (if the start-up ended).</p>
</td></tr>
<tr><td><code>ptox_inf</code></td>
<td>
<p>Estimated probabilities that the toxicity probability is inferior to <code>tox_max</code> (if the start-up ended).</p>
</td></tr>
<tr><td><code>n_eff</code></td>
<td>
<p>Number of observed efficacies.</p>
</td></tr>
<tr><td><code>resp</code></td>
<td>
<p>Estimated efficacy probabilities (if the start-up ended).</p>
</td></tr>
<tr><td><code>1-qeff_inf</code></td>
<td>
<p>Estimated probabilities that the efficacy probability is superior to <code>eff_min</code> (if the start-up ended).</p>
</td></tr>         
<tr><td><code>proba_tau</code></td>
<td>
<p>Posterior probabilities for the plateau location.</p>
</td></tr>
<tr><td><code>group_cur</code></td>
<td>
<p>Current Group for dose determination.</p>
</td></tr>
<tr><td><code>in_startup</code></td>
<td>
<p>Start-up phase is ended or not.</p>
</td></tr>
<tr><td><code>cdose</code></td>
<td>
<p>NEXT RECOMMENDED DOSE.</p>
</td></tr>
<tr><td><code>ngroups</code></td>
<td>
<p>Number of groups.</p>
</td></tr>
<tr><td><code>final</code></td>
<td>
<p>Maximim sample size reached.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Allocation method.</p>
</td></tr>
<tr><td><code>tox_max</code></td>
<td>
<p>Toxicity upper bound (if the start-up ended).</p>
</td></tr>
<tr><td><code>eff_min</code></td>
<td>
<p>Efficacy lower bound (if the start-up ended).</p>
</td></tr>
<tr><td><code>c_tox</code></td>
<td>
<p>Toxicity threshold (if the start-up ended).</p>
</td></tr>
<tr><td><code>c_eff</code></td>
<td>
<p>Efficacy threshold (if the start-up ended).</p>
</td></tr>
<tr><td><code>tite</code></td>
<td>
<p>Type of outcome for efficacy (time-to-event or binary).</p>
</td></tr>
<tr><td><code>time_full</code></td>
<td>
<p>If efficacy is a time-to-event, full follow-up time is also reminded.</p>
</td></tr>
<tr><td><code>cycle</code></td>
<td>
<p>If efficacy is a time-to-event, minimum waiting time between two dose cohorts (cycle) is also reminded.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The &quot;MTA-PM&quot; method is not implemented for non-binary efficacy, as &quot;MTA-RA&quot; is recommended for general use.</p>


<h3>Author(s)</h3>

<p>Jacques-Henri Jourdan and Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Riviere, M-K., Yuan, Y., Jourdan, J-H., Dubois, F., and Zohar, S. Phase I/II Dose-Finding Design for Molecularly Targeted Agent: Plateau Determination using Adaptive Randomization.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtaBin_sim">mtaBin_sim</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prior_tox = c(0.02, 0.06, 0.12, 0.20, 0.30, 0.40)
prior_eff = c(0.12, 0.20, 0.30, 0.40, 0.50, 0.59)
group_pat_1 = rep(1,33)
id_dose_1 = c(1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,4,4,4,5,5,5,6,6,6,3,3,3,4,4,4,3,3,3)
tox_1 = c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0)
time_follow_1 = c(rep(7,30),6.8,5,3.5)
time_eff_1 = c(rep(+Inf,8),4,+Inf,+Inf,+Inf,3,6,+Inf,+Inf,2,+Inf,+Inf,4.5,+Inf,
+Inf,3.2,+Inf,+Inf,2.4,6.1,+Inf,5.8,+Inf,+Inf,2.1,3.6)
eff_2 = c(0,0,0,0,0,0,0,0,1,0,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,1,0,0,1,1)
group_pat_3 = c(1,2,3,2,1,2,3,1,2,3,3,2,2,1,3,1,2,3,1,2,3,3,3,2,1,1,2,1,2,2)
id_dose_3 = c(1,1,1,1,1,1,1,1,2,1,2,2,2,2,2,2,3,2,2,3,3,3,3,3,1,1,2,1,2,2)
toxicity_3 = c(0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0)
efficacy_3 = c(NA,0,NA,0,NA,1,NA,NA,0,NA,NA,1,0,NA,NA,NA,0,NA,NA,1,NA,NA,NA,
0,NA,NA,0,NA,1,1)
s_1=function(n_cur){0.2*(1-n_cur/60)}


# One group, time-to-event
mta1 = mtaBin_next(ngroups=1, group_cur=1, ndose=6, prior_tox=prior_tox,
       prior_eff=prior_eff, tox_max=0.35, eff_min=0.20, cohort_start=3,
       cohort=3, method="MTA-PM", group_pat=group_pat_1, id_dose=id_dose_1,
       toxicity=tox_1, tite=TRUE, time_follow=time_follow_1,
       time_eff=time_eff_1, time_full=7, cycle=3, c_tox=0.90, c_eff=0.40)
mta1

# One group, binary
mta2 = mtaBin_next(ngroups=1, group_cur=1, ndose=6, prior_tox=prior_tox,
       prior_eff=prior_eff, tox_max=0.35, eff_min=0.20, cohort_start=3,
       cohort=3, final = TRUE, method="MTA-RA", group_pat=group_pat_1,
       id_dose=id_dose_1, toxicity=tox_1, tite=FALSE, efficacy=eff_2,
       seed = 190714)
mta2

# Three groups, binary
mta3 = mtaBin_next(ngroups=3, group_cur=2, ndose=6, prior_tox=prior_tox,
       prior_eff=prior_eff, tox_max=0.35, eff_min=0.20, cohort_start=3,
       cohort=3, final = FALSE, s_1=s_1, group_pat=group_pat_3,
       id_dose=id_dose_3, toxicity=toxicity_3, tite=FALSE, efficacy=efficacy_3)
mta3


# Dummy example, running quickly
useless = mtaBin_next(ngroups=1, group_cur=1, ndose=4,
          prior_tox=c(0.12,0.20,0.30,0.40), prior_eff=c(0.20,0.30,0.40,0.50),
          tox_max=0.35, eff_min=0.20, cohort_start=3, cohort=3,
          group_pat=rep(1,9), id_dose=c(1,1,1,2,2,2,2,2,2),
          toxicity=c(0,0,0,1,0,0,0,0,0), efficacy=c(0,0,0,0,0,1,0,1,0), tite=FALSE)
</code></pre>

<hr>
<h2 id='mtaBin_sim'>Design Simulator for MTA with binary outcomes</h2><span id='topic+mtaBin_sim'></span><span id='topic+print.mtaBin_sim'></span>

<h3>Description</h3>

<p><code>mtaBin_sim</code> is used to generate simulation replicates of Phase I/II clinical trial for Molecularly Targeted Agent using the design proposed by Riviere et al. entitled &quot;Phase I/II Dose-Finding Design for Molecularly Targeted Agent: Plateau Determination using Adaptive Randomization&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mtaBin_sim(ngroups=1, ndose, p_tox, p_eff, tox_max, eff_min, prior_tox,
prior_eff, poisson_rate=1, n, cohort_start=3, cohort=3, tite=TRUE, time_full,
method="MTA-RA", s_1=function(n_cur){0.2}, s_2=0.07, cycle, nsim, c_tox=0.90,
c_eff=0.40, seed=8, threads=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mtaBin_sim_+3A_ngroups">ngroups</code></td>
<td>
<p>Number of groups for the dose-finding process leading to the recommendation of different dose levels. Several groups of efficacy (e.g. based on biomarker) sharing the same toxicity can be considered. The default value is set at 1.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_ndose">ndose</code></td>
<td>
<p>Number of dose levels.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_p_tox">p_tox</code></td>
<td>
<p>A vector of the true toxicity probabilities associated with the doses.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_p_eff">p_eff</code></td>
<td>
<p>A vector (or matrix if several groups) of the true efficacy probabilities associated with the doses.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_tox_max">tox_max</code></td>
<td>
<p>Toxicity upper bound, i.e. maximum acceptable toxicity probability.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_eff_min">eff_min</code></td>
<td>
<p>Efficacy lower bound, i.e. minimum acceptable efficacy probability.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_prior_tox">prior_tox</code></td>
<td>
<p>A vector of initial guesses of toxicity probabilities associated with the doses. Must be of same length as <code>p_tox</code>.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_prior_eff">prior_eff</code></td>
<td>
<p>A vector (or matrix if several groups) of initial guesses of efficacy probabilities associated with the doses. Must be of same length as <code>p_eff</code>.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_poisson_rate">poisson_rate</code></td>
<td>
<p>(A Vector, if several groups, of the) Rate(s) for the Poisson process used to simulate patient arrival (for each group), i.e. expected number of arrivals per observation window. The default value is set at 1.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_n">n</code></td>
<td>
<p>Total number of patients (per groups if several) to include in the dose-finding trial.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_cohort_start">cohort_start</code></td>
<td>
<p>Cohort size for the start-up phase. The default value is set at 3.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_cohort">cohort</code></td>
<td>
<p>Cohort size for the model phase. The default value is set at 3.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_tite">tite</code></td>
<td>
<p>A boolean indicating if the efficacy is considered as a time-to-event (default value TRUE), or if it is a binary outcome (FALSE).</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_time_full">time_full</code></td>
<td>
<p>Full follow-up time window. This argument is used only if tite=TRUE.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_method">method</code></td>
<td>
<p>A character string to specify the method for dose allocation (&lt;=&gt; plateau determination). The default method &quot;MTA-RA&quot; use adaptive randomization on posterior probabilities for the plateau location. Method based on difference in efficacy probabilities is specified by &quot;MTA-PM&quot;.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_s_1">s_1</code></td>
<td>
<p>A function depending on the number of patients included used for adaptive randomization in plateau determination, only used if the estimation method chosen is &quot;MTA-RA&quot;. The default function is <code>function(n_cur){0.2}</code>.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_s_2">s_2</code></td>
<td>
<p>Cutoff for plateau determination, only used if the estimation method chosen is &quot;MTA-PM&quot;. Can be seen as the minimal efficacy difference of practical importance. The default value is 0.07.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_cycle">cycle</code></td>
<td>
<p>Minimum waiting time between two dose cohorts (usually a toxicity cycle). This argument is used only if tite=TRUE.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_c_tox">c_tox</code></td>
<td>
<p>Tocixity threshold for decision rules. The default value is set at 0.90.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_c_eff">c_eff</code></td>
<td>
<p>Efficacy threshold for decision rules. The default value is set at 0.40.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_seed">seed</code></td>
<td>
<p>Seed of the random number generator. Default value is set at 8.</p>
</td></tr>
<tr><td><code id="mtaBin_sim_+3A_threads">threads</code></td>
<td>
<p>Number of threads to use to do the computations. If 0,
it uses as many threads as available processors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;mtaBin_sim&quot; is returned, consisting of the operating characteristics of the design specified. Objects generated by <code>mtaBin_sim</code> contain at least the following components: 
</p>
<table role = "presentation">
<tr><td><code>p_tox</code></td>
<td>
<p>True toxicities.</p>
</td></tr>
<tr><td><code>p_eff</code></td>
<td>
<p>True efficacies (for each group).</p>
</td></tr>
<tr><td><code>prior_tox</code></td>
<td>
<p>Prior toxicities.</p>
</td></tr>
<tr><td><code>prior_eff</code></td>
<td>
<p>Prior efficacies (for each group).</p>
</td></tr>
<tr><td><code>rec_dose</code></td>
<td>
<p>Percentage of Selection (for each group).</p>
</td></tr>
<tr><td><code>n_pat_dose</code></td>
<td>
<p>Number of patients at each dose (for each group).</p>
</td></tr>
<tr><td><code>n_tox</code></td>
<td>
<p>Number of toxicities at each dose (for each group).</p>
</td></tr>
<tr><td><code>n_eff</code></td>
<td>
<p>Number of efficacies at each dose (for each group).</p>
</td></tr>
<tr><td><code>inconc</code></td>
<td>
<p>Percentage of inclusive trials (for each group).</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Allocation method.</p>
</td></tr>
<tr><td><code>nsim</code></td>
<td>
<p>Number of simulations.</p>
</td></tr>
<tr><td><code>n_pat_tot</code></td>
<td>
<p>Total patients accrued.</p>
</td></tr>
<tr><td><code>tox_max</code></td>
<td>
<p>Toxicity upper bound.</p>
</td></tr>
<tr><td><code>eff_min</code></td>
<td>
<p>Efficacy lower bound.</p>
</td></tr>
<tr><td><code>poisson_rate</code></td>
<td>
<p>Rate for Poisson process.</p>
</td></tr>
<tr><td><code>c_tox</code></td>
<td>
<p>Toxicity threshold.</p>
</td></tr>
<tr><td><code>c_eff</code></td>
<td>
<p>Efficacy threshold.</p>
</td></tr>
<tr><td><code>cohort_start</code></td>
<td>
<p>Cohort size start-up phase.</p>
</td></tr>
<tr><td><code>cohort</code></td>
<td>
<p>Cohort size model phase.</p>
</td></tr>
<tr><td><code>tite</code></td>
<td>
<p>Type of outcome for efficacy (time-to-event or binary).</p>
</td></tr>
<tr><td><code>time_full</code></td>
<td>
<p>If efficacy is a time-to-event, full follow-up time is also reminded.</p>
</td></tr>
<tr><td><code>cycle</code></td>
<td>
<p>If efficacy is a time-to-event, minimum waiting time between two dose cohorts (cycle) is also reminded.</p>
</td></tr>
<tr><td><code>duration</code></td>
<td>
<p>If efficacy is a time-to-event, trial mean duration is also returned.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The &quot;MTA-PM&quot; method is not implemented for non-binary efficacy, as &quot;MTA-RA&quot; is recommended for general use.</p>


<h3>Author(s)</h3>

<p>Jacques-Henri Jourdan and Marie-Karelle Riviere-Jourdan <a href="mailto:eldamjh@gmail.com">eldamjh@gmail.com</a></p>


<h3>References</h3>

<p>Riviere, M-K., Yuan, Y., Jourdan, J-H., Dubois, F., and Zohar, S. Phase I/II Dose-Finding Design for Molecularly Targeted Agent: Plateau Determination using Adaptive Randomization.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mtaBin_next">mtaBin_next</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p_tox_sc1 = c(0.005, 0.01, 0.02, 0.05, 0.10, 0.15)
p_eff_sc1_g1 = c(0.01, 0.10, 0.30, 0.50, 0.80, 0.80)
p_tox_sc2 = c(0.01, 0.05, 0.10, 0.25, 0.50, 0.70)
p_eff_sc2_g2 = matrix(c(0.40, 0.01, 0.40, 0.02, 0.40, 0.05, 0.40, 0.10, 0.40,
0.35, 0.40, 0.55), nrow=2)
prior_tox = c(0.02, 0.06, 0.12, 0.20, 0.30, 0.40)
prior_eff = c(0.12, 0.20, 0.30, 0.40, 0.50, 0.59)
prior_eff2 = rbind(prior_eff, prior_eff)
s_1=function(n_cur){0.2}
n=60


# With only one group and efficacy as time-to-event
sim1 = mtaBin_sim(ngroups=1, ndose=6, p_tox= p_tox_sc1, p_eff= p_eff_sc1_g1,
       tox_max=0.35, eff_min=0.20, prior_tox=prior_tox, prior_eff= prior_eff,
       poisson_rate=0.28, n=60, cohort_start=3, cohort=3, tite=TRUE,
       time_full=7, cycle=3, nsim=1)
sim1

# With only one group and efficacy binary
sim2 = mtaBin_sim(ngroups=1, ndose=6, p_tox= p_tox_sc1, p_eff= p_eff_sc1_g1,
       tox_max=0.35, eff_min=0.20, prior_tox=prior_tox, prior_eff= prior_eff,
       n=n, cohort_start=3, cohort=3, tite=FALSE, method="MTA-RA",
       s_1=function(n_cur){0.2*(1-n_cur/n)}, nsim=1)
sim2

# With only two groups and efficacy as time-to-event
sim3 = mtaBin_sim(ngroups=2, ndose=6, p_tox= p_tox_sc2, p_eff= p_eff_sc2_g2,
               tox_max=0.35, eff_min=0.20, prior_tox=prior_tox,
               prior_eff= prior_eff2, poisson_rate=c(0.40,0.25) , n=60,
               cohort_start=3, cohort=3, tite=TRUE, time_full=7,
               method="MTA-PM", s_2=0.07, cycle=3, nsim=1, c_tox=0.90,
               c_eff=0.40)
sim3

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
