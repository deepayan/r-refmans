<!DOCTYPE html><html lang="en-US"><head><title>Help for package rstanemax</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rstanemax}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rstanemax-package'><p>The 'rstanemax' package.</p></a></li>
<li><a href='#as_draws'><p>Convert stanemax object to a posterior draws object</p></a></li>
<li><a href='#exposure.response.sample'><p>Sample simulated data for exposure-response.</p></a></li>
<li><a href='#exposure.response.sample.binary'><p>Sample simulated data for exposure-response for binary endpoint</p></a></li>
<li><a href='#exposure.response.sample.with.cov'><p>Sample simulated data for exposure-response with covariates</p></a></li>
<li><a href='#extract_param'><p>Extract posterior draws of key parameters</p></a></li>
<li><a href='#log_lik'><p>Calculate log-likelihoods from posterior samples. Data can be either</p>
original data used for model fit or new data.</a></li>
<li><a href='#posterior_predict'><p>Outcome prediction from posterior distribution of parameters</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#stan_emax'><p>Bayesian Emax model fit with Stan</p></a></li>
<li><a href='#stan_emax_binary'><p>Bayesian Emax model fit with Stan for binary endpoint</p></a></li>
<li><a href='#stanemax-methods'><p>Methods for stanemax objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.1.9</td>
</tr>
<tr>
<td>Title:</td>
<td>Emax Model Analysis with 'Stan'</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform sigmoidal Emax model fit using 'Stan' in a formula notation, without writing 'Stan' model code.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), methods,Rcpp (&ge; 1.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rstan (&ge; 2.26.0), rstantools (&ge; 2.3.0), magrittr (&ge; 1.5),
dplyr (&ge; 0.8.0), tidyr (&ge; 1.0.0), purrr (&ge; 0.3.0), ggplot2
(&ge; 2.2.1), posterior, lifecycle</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>StanHeaders (&ge; 2.26.0), rstan (&ge; 2.26.0), BH (&ge;
1.69.0-1), Rcpp (&ge; 1.0.0), RcppEigen (&ge; 0.3.3.5.0),
RcppParallel (&ge; 5.0.2)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, spelling, tibble, withr,
tidybayes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/yoshidk6/rstanemax">https://github.com/yoshidk6/rstanemax</a>,
<a href="https://yoshidk6.github.io/rstanemax/">https://yoshidk6.github.io/rstanemax/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/yoshidk6/rstanemax/issues">https://github.com/yoshidk6/rstanemax/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-17 06:44:26 UTC; yoshidk6</td>
</tr>
<tr>
<td>Author:</td>
<td>Kenta Yoshida <a href="https://orcid.org/0000-0003-4967-3831"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Danielle Navarro <a href="https://orcid.org/0000-0001-7648-6578"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Trustees of Columbia University [cph] (src/init.cpp, tools/make_cc.R,
    R/stanmodels.R)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kenta Yoshida &lt;yoshida.kenta.6@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-17 07:30:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='rstanemax-package'>The 'rstanemax' package.</h2><span id='topic+rstanemax-package'></span><span id='topic+rstanemax'></span>

<h3>Description</h3>

<p>Perform sigmoidal Emax model fit using Stan without writing Stan model code.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Kenta Yoshida <a href="mailto:yoshida.kenta.6@gmail.com">yoshida.kenta.6@gmail.com</a> (<a href="https://orcid.org/0000-0003-4967-3831">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Danielle Navarro <a href="mailto:djnavarro@protonmail.com">djnavarro@protonmail.com</a> (<a href="https://orcid.org/0000-0001-7648-6578">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Trustees of Columbia University (src/init.cpp, tools/make_cc.R, R/stanmodels.R) [copyright holder]
</p>
</li></ul>



<h3>References</h3>

<p>Stan Development Team (2018). RStan: the R interface to Stan. R package version 2.18.2. http://mc-stan.org
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/yoshidk6/rstanemax">https://github.com/yoshidk6/rstanemax</a>
</p>
</li>
<li> <p><a href="https://yoshidk6.github.io/rstanemax/">https://yoshidk6.github.io/rstanemax/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/yoshidk6/rstanemax/issues">https://github.com/yoshidk6/rstanemax/issues</a>
</p>
</li></ul>


<hr>
<h2 id='as_draws'>Convert stanemax object to a posterior draws object</h2><span id='topic+as_draws'></span><span id='topic+as_draws_list'></span><span id='topic+as_draws_array'></span><span id='topic+as_draws_df'></span><span id='topic+as_draws_matrix'></span><span id='topic+as_draws_rvars'></span><span id='topic+as_draws.stanemax'></span><span id='topic+as_draws.stanemaxbin'></span><span id='topic+as_draws_list.stanemax'></span><span id='topic+as_draws_list.stanemaxbin'></span><span id='topic+as_draws_array.stanemax'></span><span id='topic+as_draws_array.stanemaxbin'></span><span id='topic+as_draws_df.stanemax'></span><span id='topic+as_draws_df.stanemaxbin'></span><span id='topic+as_draws_matrix.stanemax'></span><span id='topic+as_draws_matrix.stanemaxbin'></span><span id='topic+as_draws_rvars.stanemax'></span><span id='topic+as_draws_rvars.stanemaxbin'></span>

<h3>Description</h3>

<p>Convert stanemax object to a posterior draws object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_draws(x, ...)

as_draws_list(x, ...)

as_draws_array(x, ...)

as_draws_df(x, ...)

as_draws_matrix(x, ...)

as_draws_rvars(x, ...)

## S3 method for class 'stanemax'
as_draws(x, inc_warmup = FALSE, ...)

## S3 method for class 'stanemaxbin'
as_draws(x, inc_warmup = FALSE, ...)

## S3 method for class 'stanemax'
as_draws_list(x, inc_warmup = FALSE, ...)

## S3 method for class 'stanemaxbin'
as_draws_list(x, inc_warmup = FALSE, ...)

## S3 method for class 'stanemax'
as_draws_array(x, inc_warmup = FALSE, ...)

## S3 method for class 'stanemaxbin'
as_draws_array(x, inc_warmup = FALSE, ...)

## S3 method for class 'stanemax'
as_draws_df(x, inc_warmup = FALSE, ...)

## S3 method for class 'stanemaxbin'
as_draws_df(x, inc_warmup = FALSE, ...)

## S3 method for class 'stanemax'
as_draws_matrix(x, inc_warmup = FALSE, ...)

## S3 method for class 'stanemaxbin'
as_draws_matrix(x, inc_warmup = FALSE, ...)

## S3 method for class 'stanemax'
as_draws_rvars(x, inc_warmup = FALSE, ...)

## S3 method for class 'stanemaxbin'
as_draws_rvars(x, inc_warmup = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_draws_+3A_x">x</code></td>
<td>
<p>An object of class stanemax.</p>
</td></tr>
<tr><td><code id="as_draws_+3A_...">...</code></td>
<td>
<p>Arguments passed to individual methods (if applicable).'</p>
</td></tr>
<tr><td><code id="as_draws_+3A_inc_warmup">inc_warmup</code></td>
<td>
<p>Should warmup draws be included? Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A draws object of the appropriate subclass
</p>


<h3>See Also</h3>

<p><code><a href="posterior.html#topic+draws">draws</a></code>
<code><a href="posterior.html#topic+subset_draws">subset_draws</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(exposure.response.sample)
fit &lt;- stan_emax(response ~ exposure, exposure.response.sample)
posterior::as_draws_list(fit)
posterior::as_draws_array(fit)
posterior::as_draws_df(fit)
posterior::as_draws_matrix(fit)
posterior::as_draws_rvars(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='exposure.response.sample'>Sample simulated data for exposure-response.</h2><span id='topic+exposure.response.sample'></span>

<h3>Description</h3>

<p>Sample simulated data for exposure-response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exposure.response.sample
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>dose</dt><dd><p>Dose levels used for simulation of pharmacokinetics</p>
</dd>
<dt>exposure</dt><dd><p>Simulated exposure</p>
</dd>
<dt>response</dt><dd><p>Simulated pharmacodynamic response</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>exposure.response.sample
</code></pre>

<hr>
<h2 id='exposure.response.sample.binary'>Sample simulated data for exposure-response for binary endpoint</h2><span id='topic+exposure.response.sample.binary'></span>

<h3>Description</h3>

<p>Sample simulated data for exposure-response for binary endpoint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exposure.response.sample.binary
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>conc</dt><dd><p>Simulated exposure</p>
</dd>
<dt>y_logit</dt><dd><p>Simulated logit(p)</p>
</dd>
<dt>y_prob</dt><dd><p>Simulated p</p>
</dd>
<dt>y</dt><dd><p>Simulated event (1 or 0)</p>
</dd>
<dt>y_cov_logit</dt><dd><p>Simulated logit(p) for model with covariate</p>
</dd>
<dt>y_cov_prob</dt><dd><p>Simulated p for model with covariate</p>
</dd>
<dt>y_cov</dt><dd><p>Simulated event (1 or 0) for model with covariate</p>
</dd>
<dt>sex_num</dt><dd><p>1 or 0</p>
</dd>
<dt>sex</dt><dd><p>female or male</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>exposure.response.sample
</code></pre>

<hr>
<h2 id='exposure.response.sample.with.cov'>Sample simulated data for exposure-response with covariates</h2><span id='topic+exposure.response.sample.with.cov'></span>

<h3>Description</h3>

<p>Sample simulated data for exposure-response with covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exposure.response.sample.with.cov
</code></pre>


<h3>Format</h3>

<p>A data frame with columns:
</p>

<dl>
<dt>dose</dt><dd><p>Dose levels used for simulation of pharmacokinetics</p>
</dd>
<dt>conc</dt><dd><p>Simulated exposure</p>
</dd>
<dt>resp</dt><dd><p>Simulated pharmacodynamic response</p>
</dd>
<dt>cov1</dt><dd><p>Covariate 1 for e0</p>
</dd>
<dt>cov2</dt><dd><p>Covariate 2 for emax</p>
</dd>
<dt>cov3</dt><dd><p>Covariate 3 for ec50 (data type factor)</p>
</dd>
<dt>cov3num</dt><dd><p>Covariate 3 for ec50 (data type numeric)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>exposure.response.sample
</code></pre>

<hr>
<h2 id='extract_param'>Extract posterior draws of key parameters</h2><span id='topic+extract_param'></span>

<h3>Description</h3>

<p>Extract posterior draws of key parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_param(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_param_+3A_object">object</code></td>
<td>
<p>A <code>stanemax</code> class object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble containing posterior draws of key parameters.
If covariate(s) are included in the model, posterior draws for different combinations
of covariates are supplied in a long format - e.g. if there are posterior draws of 100 samples
and 4 levels of the covariates, the returned tibble will have the length of 400
</p>

<hr>
<h2 id='log_lik'>Calculate log-likelihoods from posterior samples. Data can be either
original data used for model fit or new data.</h2><span id='topic+log_lik'></span><span id='topic+log_lik.stanemax'></span><span id='topic+log_lik.stanemaxbin'></span>

<h3>Description</h3>

<p>See <a href="rstantools.html#topic+log_lik">rstantools::log_lik</a> for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_lik(object, ...)

## S3 method for class 'stanemax'
log_lik(object, newdata = NULL, ...)

## S3 method for class 'stanemaxbin'
log_lik(object, newdata = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="log_lik_+3A_object">object</code></td>
<td>
<p>A <code>stanemax</code> or <code>stanemaxbin</code> object</p>
</td></tr>
<tr><td><code id="log_lik_+3A_...">...</code></td>
<td>
<p>Currently unused arguments</p>
</td></tr>
<tr><td><code id="log_lik_+3A_newdata">newdata</code></td>
<td>
<p>New data used for prediction. If NULL, original data is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code class="reqn">S</code> by <code class="reqn">N</code> matrix of log-likelihoods, where each row
corresponds to a draw from the posterior distribution and each column corresponds to a data point.
</p>

<hr>
<h2 id='posterior_predict'>Outcome prediction from posterior distribution of parameters</h2><span id='topic+posterior_predict'></span><span id='topic+posterior_epred'></span><span id='topic+posterior_linpred'></span><span id='topic+posterior_predict.stanemax'></span><span id='topic+posterior_predict.stanemaxbin'></span><span id='topic+posterior_epred.stanemax'></span><span id='topic+posterior_epred.stanemaxbin'></span><span id='topic+posterior_linpred.stanemax'></span><span id='topic+posterior_linpred.stanemaxbin'></span><span id='topic+posterior_predict_quantile'></span>

<h3>Description</h3>

<p>Compute outcome predictions using posterior samples. Exposure data for
prediction can be either original data used for model fit or new data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_predict(object, ...)

posterior_epred(object, ...)

posterior_linpred(object, transform = FALSE, ...)

## S3 method for class 'stanemax'
posterior_predict(
  object,
  newdata = NULL,
  returnType = "matrix",
  newDataType = "raw",
  ...
)

## S3 method for class 'stanemaxbin'
posterior_predict(
  object,
  newdata = NULL,
  returnType = "matrix",
  newDataType = "raw",
  ...
)

## S3 method for class 'stanemax'
posterior_epred(object, newdata = NULL, newDataType = "raw", ...)

## S3 method for class 'stanemaxbin'
posterior_epred(object, newdata = NULL, newDataType = "raw", ...)

## S3 method for class 'stanemax'
posterior_linpred(
  object,
  transform = FALSE,
  newdata = NULL,
  newDataType = "raw",
  ...
)

## S3 method for class 'stanemaxbin'
posterior_linpred(
  object,
  transform = FALSE,
  newdata = NULL,
  newDataType = "raw",
  ...
)

posterior_predict_quantile(
  object,
  newdata = NULL,
  ci = 0.9,
  pi = 0.9,
  newDataType = c("raw", "modelframe")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="posterior_predict_+3A_object">object</code></td>
<td>
<p>A <code>stanemax</code> or <code>stanemaxbin</code> object</p>
</td></tr>
<tr><td><code id="posterior_predict_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to methods. Arguments that can be
passed via the dots include <code>ndraws</code>, for compatibility with functions in
the tidybayes package</p>
</td></tr>
<tr><td><code id="posterior_predict_+3A_transform">transform</code></td>
<td>
<p>Should the linear predictor be transformed to response
scale?</p>
</td></tr>
<tr><td><code id="posterior_predict_+3A_newdata">newdata</code></td>
<td>
<p>An optional data frame that contains columns needed for model
to run (exposure and covariates). If the model does not have any covariate,
this can be a numeric vector corresponding to the exposure metric.</p>
</td></tr>
<tr><td><code id="posterior_predict_+3A_returntype">returnType</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> An optional string
specifying the type of return object (one of &quot;matrix&quot;, &quot;dataframe&quot;, or
&quot;tibble&quot;)</p>
</td></tr>
<tr><td><code id="posterior_predict_+3A_newdatatype">newDataType</code></td>
<td>
<p>An optional string specifying the type of newdata input,
whether in the format of an original data frame (&quot;raw&quot;, the default) or a
processed model frame (&quot;modelframe&quot;). Mostly used for internal purposes and
users can usually leave at default.</p>
</td></tr>
<tr><td><code id="posterior_predict_+3A_ci">ci</code></td>
<td>
<p>Credible interval of the response without residual variability.</p>
</td></tr>
<tr><td><code id="posterior_predict_+3A_pi">pi</code></td>
<td>
<p>Prediction interval of the response with residual variability.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Run <code>vignette("emaxmodel", package = "rstanemax")</code> to see how you can
use the posterior prediction for plotting estimated Emax curve.
</p>


<h3>Value</h3>

<p>An object that contain predicted response with posterior distribution
of parameters. The default is a matrix containing predicted <code>response</code> for
<code><a href="#topic+stan_emax">stan_emax()</a></code> and <code>.epred</code> for <code><a href="#topic+stan_emax_binary">stan_emax_binary()</a></code>. Each row of the matrix
is a vector of predictions generated using a single draw of the model
parameters from the posterior distribution.
</p>
<p>If either <code>dataframe</code> or <code>tibble</code> is specified, the function returns a data
frame or tibble object in a long format - each row is a prediction
generated using a single draw of the model parameters and a corresponding
exposure.
</p>
<p>Several types of predictions are generated with this function.
</p>
<p>For continuous endpoint model (<code><a href="#topic+stan_emax">stan_emax()</a></code>),
</p>

<ul>
<li> <p><code>.linpred</code> &amp; <code>.epred</code>: prediction without considering residual
variability and is intended to provide credible interval of &quot;mean&quot;
response.
</p>
</li>
<li> <p><code>.prediction</code>: include residual variability in its calculation,
therefore the range represents prediction interval of observed response.
</p>
</li>
<li> <p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> <code>respHat</code>: replaced by <code>.linpred</code>
and <code>.epred</code>
</p>
</li>
<li> <p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> <code>response</code>: replaced by <code>.prediction</code>
</p>
</li></ul>

<p>For binary endpoint model (<code><a href="#topic+stan_emax_binary">stan_emax_binary()</a></code>),
</p>

<ul>
<li> <p><code>.linpred</code>: predicted probability on logit scale
</p>
</li>
<li> <p><code>.epred</code>: predicted probability on probability scale
</p>
</li>
<li> <p><code>.prediction</code>: predicted event (1) or non-event (0)
</p>
<p>The return object also contains exposure and parameter values used for
calculation.
</p>
</li></ul>

<p>With <code><a href="#topic+posterior_predict_quantile">posterior_predict_quantile()</a></code> function, you can obtain quantiles
of <code>respHat</code> and <code>response</code> as specified by <code>ci</code> and <code>pi</code>.
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>magrittr</dt><dd><p><code><a href="magrittr.html#topic+pipe">%&gt;%</a></code></p>
</dd>
</dl>

<hr>
<h2 id='stan_emax'>Bayesian Emax model fit with Stan</h2><span id='topic+stan_emax'></span>

<h3>Description</h3>

<p>Run sigmoidal Emax model fit with formula notation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_emax(
  formula,
  data,
  gamma.fix = 1,
  e0.fix = NULL,
  emax.fix = NULL,
  priors = NULL,
  param.cov = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_emax_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of variables for Emax model fit.</p>
</td></tr>
<tr><td><code id="stan_emax_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="stan_emax_+3A_gamma.fix">gamma.fix</code></td>
<td>
<p>a (positive) numeric or NULL to specify gamma (Hill coefficient) in the sigmoidal Emax model.
If NULL, gamma will be estimated from the data.
If numeric, gamma is fixed at the number provided.
Default = 1 (normal Emax model).</p>
</td></tr>
<tr><td><code id="stan_emax_+3A_e0.fix">e0.fix</code></td>
<td>
<p>a numeric or NULL to specify E0 in the Emax model.
If NULL, E0 will be estimated from the data.
If numeric, E0 is fixed at the number provided.
Default = NULL (estimate from the data).</p>
</td></tr>
<tr><td><code id="stan_emax_+3A_emax.fix">emax.fix</code></td>
<td>
<p>a numeric or NULL to specify Emax in the Emax model.
If NULL, Emax will be estimated from the data.
If numeric, Emax is fixed at the number provided.
Default = NULL (estimate from the data).</p>
</td></tr>
<tr><td><code id="stan_emax_+3A_priors">priors</code></td>
<td>
<p>a named list specifying priors of parameters (ec50, emax, e0, gamma, sigma).
Each list item should be length 2 numeric vector, one corresponding to mean and
another corresponding to standard deviation.
Currently only supports normal distribution for priors.</p>
</td></tr>
<tr><td><code id="stan_emax_+3A_param.cov">param.cov</code></td>
<td>
<p>a named list specifying categorical covariates on parameters (ec50, emax, e0).
Convert a column into factor if specific order of covariates are needed.</p>
</td></tr>
<tr><td><code id="stan_emax_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling</a> (e.g. iter, chains).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following structure is used for the Emax model:
</p>
<p style="text-align: center;"><code class="reqn">Response = e_0 + e_{max} \times exposure ^{\gamma} / (ec50 ^{\gamma} + exposure ^ {\gamma}) + \epsilon</code>
</p>

<p style="text-align: center;"><code class="reqn">\epsilon \sim N(0, \sigma^2)</code>
</p>



<h3>Value</h3>

<p>An object of class <code>stanemax</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(exposure.response.sample)
fit1 &lt;- stan_emax(response ~ exposure,
  data = exposure.response.sample,
  # the next line is only to make the example go fast enough
  chains = 1, iter = 500, seed = 12345
)
print(fit1)

# Set priors manually, also estimate gamma instead of the default of fix to 1
fit2 &lt;- stan_emax(response ~ exposure,
  data = exposure.response.sample, gamma.fix = NULL,
  priors = list(
    ec50 = c(100, 30), emax = c(100, 30), e0 = c(10, 5),
    gamma = c(0, 3), sigma = c(0, 30)
  ),
  # the next line is only to make the example go fast enough
  chains = 1, iter = 500, seed = 12345
)
print(fit2)

data(exposure.response.sample.with.cov)
# Specify covariates
fit3 &lt;- stan_emax(
  formula = resp ~ conc, data = exposure.response.sample.with.cov,
  param.cov = list(emax = "cov2", ec50 = "cov3", e0 = "cov1"),
  # the next line is only to make the example go fast enough
  chains = 1, iter = 500, seed = 12345
)
print(fit3)

## End(Not run)

</code></pre>

<hr>
<h2 id='stan_emax_binary'>Bayesian Emax model fit with Stan for binary endpoint</h2><span id='topic+stan_emax_binary'></span>

<h3>Description</h3>

<p>Bayesian Emax model fit with Stan for binary endpoint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_emax_binary(
  formula,
  data,
  gamma.fix = 1,
  e0.fix = NULL,
  emax.fix = NULL,
  priors = NULL,
  param.cov = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stan_emax_binary_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of variables for Emax model fit.</p>
</td></tr>
<tr><td><code id="stan_emax_binary_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="stan_emax_binary_+3A_gamma.fix">gamma.fix</code></td>
<td>
<p>a (positive) numeric or NULL to specify gamma (Hill coefficient) in the sigmoidal Emax model.
If NULL, gamma will be estimated from the data.
If numeric, gamma is fixed at the number provided.
Default = 1 (normal Emax model).</p>
</td></tr>
<tr><td><code id="stan_emax_binary_+3A_e0.fix">e0.fix</code></td>
<td>
<p>a numeric or NULL to specify E0 in the Emax model.
If NULL, E0 will be estimated from the data.
If numeric, E0 is fixed at the number provided.
Default = NULL (estimate from the data).</p>
</td></tr>
<tr><td><code id="stan_emax_binary_+3A_emax.fix">emax.fix</code></td>
<td>
<p>a numeric or NULL to specify Emax in the Emax model.
If NULL, Emax will be estimated from the data.
If numeric, Emax is fixed at the number provided.
Default = NULL (estimate from the data).</p>
</td></tr>
<tr><td><code id="stan_emax_binary_+3A_priors">priors</code></td>
<td>
<p>a named list specifying priors of parameters (ec50, emax, e0, gamma, sigma).
Each list item should be length 2 numeric vector, one corresponding to mean and
another corresponding to standard deviation.
Currently only supports normal distribution for priors.</p>
</td></tr>
<tr><td><code id="stan_emax_binary_+3A_param.cov">param.cov</code></td>
<td>
<p>a named list specifying categorical covariates on parameters (ec50, emax, e0).
Convert a column into factor if specific order of covariates are needed.</p>
</td></tr>
<tr><td><code id="stan_emax_binary_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling</a> (e.g. iter, chains).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(exposure.response.sample.binary)
fit1 &lt;- stan_emax_binary(
  y ~ conc,
  data = exposure.response.sample.binary,
  # the next line is only to make the example go fast enough
  chains = 2, iter = 500, seed = 12345
)
print(fit1)

# Specify covariates
fit2 &lt;- stan_emax_binary(
  formula = y ~ conc, data = exposure.response.sample.binary,
  param.cov = list(emax = "sex"),
  # the next line is only to make the example go fast enough
  chains = 2, iter = 500, seed = 12345
)
print(fit2)

## End(Not run)
</code></pre>

<hr>
<h2 id='stanemax-methods'>Methods for stanemax objects</h2><span id='topic+stanemax-methods'></span><span id='topic+print.stanemax'></span><span id='topic+print.stanemaxbin'></span><span id='topic+extract_stanfit'></span><span id='topic+extract_obs_mod_frame'></span><span id='topic+plot.stanemax'></span><span id='topic+plot.stanemaxbin'></span>

<h3>Description</h3>

<p>Methods for stanemax objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'stanemax'
print(x, digits_summary = 2, ...)

## S3 method for class 'stanemaxbin'
print(x, digits_summary = 2, ...)

extract_stanfit(x)

extract_obs_mod_frame(x)

## S3 method for class 'stanemax'
plot(x, show.ci = TRUE, show.pi = FALSE, ci = 0.9, pi = 0.9, ...)

## S3 method for class 'stanemaxbin'
plot(x, show.ci = TRUE, show.pi = FALSE, ci = 0.9, pi = 0.9, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stanemax-methods_+3A_x">x</code></td>
<td>
<p>An object of class <code>stanemax</code> or <code>stanemaxbin</code></p>
</td></tr>
<tr><td><code id="stanemax-methods_+3A_digits_summary">digits_summary</code></td>
<td>
<p>The number of significant digits to use when printing
the summary, defaulting to 2. Applies to the quantities other than the
effective sample size, which is always rounded to the nearest integer.</p>
</td></tr>
<tr><td><code id="stanemax-methods_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to methods.</p>
</td></tr>
<tr><td><code id="stanemax-methods_+3A_show.ci">show.ci</code></td>
<td>
<p>An logical specifying if the output figure include
credible interval of posterior prediction. Default TRUE.</p>
</td></tr>
<tr><td><code id="stanemax-methods_+3A_show.pi">show.pi</code></td>
<td>
<p>An logical specifying if the output figure include
prediction interval. Default FALSE.</p>
</td></tr>
<tr><td><code id="stanemax-methods_+3A_ci">ci</code></td>
<td>
<p>Credible interval range.</p>
</td></tr>
<tr><td><code id="stanemax-methods_+3A_pi">pi</code></td>
<td>
<p>Prediction interval range.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
