<!DOCTYPE html><html><head><title>Help for package PVAClone</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PVAClone}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fancyPVAmodel'>
<p>Print fancy model names in summaries</p></a></li>
<li><a href='#generateLatent'>
<p>Generate latent variable</p></a></li>
<li><a href='#growth-models'>
<p>Growth models</p></a></li>
<li><a href='#Internals'>
<p>Internal functions</p></a></li>
<li><a href='#model.select'>
<p>Model selection for 'pva' objects</p></a></li>
<li><a href='#paurelia'>
<p>Paramecium abundance time series</p></a></li>
<li><a href='#pva'>
<p>Population Viability Analysis</p></a></li>
<li><a href='#pva-class'><p>Class <code>"pva"</code></p></a></li>
<li><a href='#pva-methods'><p>Methods for 'pva' objects</p></a></li>
<li><a href='#PVAClone-package'>
<p>Population Viability Analysis with Data Cloning</p></a></li>
<li><a href='#pvamodel-class'><p>Class <code>"pvamodel"</code></p></a></li>
<li><a href='#redstart'>
<p>Abundance time series of American Redstart</p></a></li>
<li><a href='#songsparrow'>
<p>Abundance time series of Song Sparrow</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Population Viability Analysis with Data Cloning</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-7</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Khurram Nadeem, Peter Solymos</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter Solymos &lt;psolymos@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Likelihood based population viability analysis in the
  presence of observation error and missing data.
  The package can be used to fit, compare, predict,
  and forecast various growth model types using data cloning.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.0), dcmle (&ge; 0.3-0), dclone, stats4</td>
</tr>
<tr>
<td>Suggests:</td>
<td>parallel</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, coda</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (&gt;= 3.0.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/psolymos/PVAClone">https://github.com/psolymos/PVAClone</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/psolymos/PVAClone/issues">https://github.com/psolymos/PVAClone/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-22 23:08:42 UTC; Peter</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-23 07:53:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='fancyPVAmodel'>
Print fancy model names in summaries
</h2><span id='topic+fancyPVAmodel'></span>

<h3>Description</h3>

<p>This function prints the fancy model names in summaries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fancyPVAmodel(object, initial = "PVA object:\n", part = 1:2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fancyPVAmodel_+3A_object">object</code></td>
<td>

<p>A fitted 'pva' object.
</p>
</td></tr>
<tr><td><code id="fancyPVAmodel_+3A_initial">initial</code></td>
<td>

<p>A fancy header for the fancy output.
</p>
</td></tr>
<tr><td><code id="fancyPVAmodel_+3A_part">part</code></td>
<td>

<p>Integer, <code>1</code> = model type is printed, <code>2</code> = data info is printed
<code>1:2</code> = both are printed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character with fancy model summary.
</p>


<h3>Author(s)</h3>

<p>Khurram Nadeem and Peter Solymos
</p>

<hr>
<h2 id='generateLatent'>
Generate latent variable
</h2><span id='topic+generateLatent'></span>

<h3>Description</h3>

<p>Generate latent variable of a hierarchical PVA model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateLatent(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generateLatent_+3A_x">x</code></td>
<td>

<p>A fitted PVA model object.
</p>
</td></tr>
<tr><td><code id="generateLatent_+3A_...">...</code></td>
<td>

<p>Arguments passed to <code><a href="dclone.html#topic+jags.fit">jags.fit</a></code>,
such as <code>n.iter</code>, <code>n.chains</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It uses MLE from a fitted PVA model
to generate values for the latent variables.
</p>


<h3>Value</h3>

<p>A matrix with <code>n.iter * n.chains</code> rows and as
many columns as the length of the time series.
</p>


<h3>Author(s)</h3>

<p>Khurram Nadeem and Peter Solymos
</p>


<h3>References</h3>

<p>Ponciano, J. M. et al. 2009. Hierarchical models in ecology: 
confidence intervals, hypothesis testing, 
and model selection using data cloning. Ecology 90, 356&ndash;362.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pva">pva</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(paurelia)
m &lt;- pva(paurelia, gompertz("normal"), 5)
p &lt;- generateLatent(m, n.chains=1, n.iter=1000)
summary(p)

## End(Not run)
</code></pre>

<hr>
<h2 id='growth-models'>
Growth models
</h2><span id='topic+growthmodels'></span><span id='topic+gompertz'></span><span id='topic+ricker'></span><span id='topic+bevertonholt'></span><span id='topic+thetalogistic'></span><span id='topic+thetalogistic_D'></span>

<h3>Description</h3>

<p>Population growth model to be used in model fitting
via <code><a href="#topic+pva">pva</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gompertz(obs.error = "none", fixed)
ricker(obs.error = "none", fixed)
thetalogistic(obs.error = "none", fixed)
thetalogistic_D(obs.error = "none", fixed)
bevertonholt(obs.error = "none", fixed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="growth-models_+3A_obs.error">obs.error</code></td>
<td>

<p>Character, describing the observation error.
Can be <code>"none"</code>, <code>"poisson"</code>, or <code>"normal"</code>.
</p>
</td></tr>
<tr><td><code id="growth-models_+3A_fixed">fixed</code></td>
<td>

<p>Named numeric vector or list with fixed parameter names and values.
Can be used for providing alternative prior specifications,
see Details and Examples.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions can be called in <code><a href="#topic+pva">pva</a></code> to fit the following 
growth models to a given population time series assuming both
with and without observation error. When assuming the presence of 
observation error, either the Normal 
or the Poisson observation error model must be assumed within the 
state-space model formulation (Nadeem and Lele, 2012). The growth
models are defined as follows.
</p>
<p>Gompertz (<code>gompertz</code>):
</p>
<p style="text-align: center;"><code class="reqn">x_{t} = a + x_{t-1} + b x_{t-1} + \epsilon_{t}</code>
</p>

<p>where <code class="reqn">x_{t}</code> is log abundance at time <code class="reqn">t</code> and 
<code class="reqn">\epsilon_{t} \sim Normal(0, \sigma^2)</code>.
</p>
<p>Ricker (<code>ricker</code>):
</p>
<p style="text-align: center;"><code class="reqn">x_{t} = x_{t-1} + a + b e^{x_{t-1}} + \epsilon_{t}</code>
</p>

<p>where <code class="reqn">x_{t}</code> is log abundance at time 
<code class="reqn">t</code> and <code class="reqn">\epsilon_{t} \sim Normal(0, \sigma^2</code>.
</p>
<p>Theta-Logistic (<code>thetalogistic</code>):
</p>
<p style="text-align: center;"><code class="reqn">x_{t} = x_{t-1} + r[1-(e^{x_{t-1}}/K)^theta] + \epsilon_{t}</code>
</p>

<p>where <code class="reqn">x_{t}</code> is log abundance at time 
<code class="reqn">t</code> and <code class="reqn">\epsilon_{t} \sim Normal(0, \sigma^2</code>.
</p>
<p>Theta-Logistic with Demographic Variability
(<code>thetalogistic_D</code>):
</p>
<p style="text-align: center;"><code class="reqn">x_{t} = x_{t-1} + r[1-(e^{x_{t-1}}/K)^theta] + \epsilon_{t}</code>
</p>

<p>where <code class="reqn">x_{t}</code> is log abundance at time 
<code class="reqn">t</code> and <code class="reqn">\epsilon_{t} \sim Normal(0, \sigma^2 + sigma.d^2</code>, where <code class="reqn">sigma.d^2</code>
is the demographic variability. If <code class="reqn">sigma.d^2</code> is 
missing or fixed at zero, Theta-Logistic model is fitted instead.
</p>
<p>Generalized Beverton-Holt (<code>bevertonholt</code>):
</p>
<p style="text-align: center;"><code class="reqn">x_{t} = x_{t-1} + r- log[1+(e^{x_{t-1}}/K)^theta] + \epsilon_{t}</code>
</p>

<p>where <code class="reqn">x_{t}</code> is log abundance at time 
<code class="reqn">t</code> and <code class="reqn">\epsilon_{t} \sim Normal(0, \sigma^2</code>.
</p>
<p>Observation error models are described in the help page of 
<code><a href="#topic+pva">pva</a></code>.
</p>
<p>The argument <code>fixed</code> can be used to fit the model assuming 
<em>a priori</em> values of a subset of the parameters. For instance,
fixing theta equal to one reduces Theta-Logistic and 
Generalized Beverton-Holt models to Logistic and Beverton-Holt 
models respectively. The number of parameters that should be 
fixed at most is <code class="reqn">p-1</code>, where <code class="reqn">p</code> is the dimension of 
the full model. See examples below and in <code><a href="#topic+pva">pva</a></code> 
and <code><a href="#topic+model.select">model.select</a></code>.
</p>
<p>The <code>fixed</code> argument can be used to provide alternative
prior specification using the BUGS language.
In this case, values in <code>fixed</code> must be numeric.
Use a list when real fixed values (numeric) and priors (character)
are provided at the same time (see Examples). 
Alternative priors can be useful
for testing insensitivity to priors, which is
a diagnostic sign of data cloning convergence.
</p>


<h3>Value</h3>

<p>An S4 class of 'pvamodel' (see <code><a href="#topic+pvamodel-class">pvamodel-class</a></code>)
</p>


<h3>Author(s)</h3>

<p>Khurram Nadeem and Peter Solymos
</p>


<h3>References</h3>

<p>Nadeem, K., Lele S. R., 2012.  
Likelihood based population viability analysis in the presence of 
observation error. Oikos 121, 1656&ndash;1664.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pvamodel-class">pvamodel-class</a></code>, <code><a href="#topic+pva">pva</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gompertz()
gompertz("poisson")
ricker("normal")
ricker("normal", fixed=c(a=5, sigma=0.5))
thetalogistic("none", fixed=c(theta=1))
bevertonholt("normal", fixed=c(theta=1))

## alternative priors
ricker("normal", fixed=c(a="a ~ dnorm(2, 1)"))@model
ricker("normal", fixed=list(a="a ~ dnorm(2, 1)", sigma=0.5))@model
</code></pre>

<hr>
<h2 id='Internals'>
Internal functions
</h2><span id='topic+Internals'></span><span id='topic+internals'></span><span id='topic+PVAClone-internals'></span><span id='topic+internal-functions'></span><span id='topic+ts_index'></span>

<h3>Description</h3>

<p>Functions used internally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ts_index(x, type=c("density", "expectation"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Internals_+3A_x">x</code></td>
<td>

<p>A vector of observations, possibly with missing values.
</p>
</td></tr>
<tr><td><code id="Internals_+3A_type">type</code></td>
<td>

<p>Character, type of index to calculate.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ts_index</code> calculates positional indices of elements of a vector
that fulfill the following conditions when <code>type = "density"</code>:
(1) if there is only one observation present before the first <code>NA</code>, 
it is not selected, else, all the observations preceding to the 
first <code>NA</code> are selected;
(2) if there is only one observation present after the last <code>NA</code>, 
it is not selected, else, all the observations following the 
last <code>NA</code> are selected;
(3) if there is only one observation present between two 
consecutive <code>NA</code>s, it is not selected, else, all the 
observations falling between two consecutive <code>NA</code>s are selected.
<code>ts_index</code> calculates positional indices of elements of a vector
that immediately follow a missing (<code>NA</code>) value if 
<code>type = "expectation"</code>. The reason for this
is that these elements depend on missing data given a first order
Markov process. As a result, these need different treatment in 
calculating log densities for model selection.
</p>


<h3>Value</h3>

<p><code>ts_index</code> returns an integer vector.
</p>


<h3>Author(s)</h3>

<p>Peter Solymos and Khurram Nadeem
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## ts_index
x &lt;- 1:20
x[c(3,4, 6, 10, 13:15, 20)] &lt;- NA
ts_index(x, "density")
ts_index(x, "expectation")
</code></pre>

<hr>
<h2 id='model.select'>
Model selection for 'pva' objects
</h2><span id='topic+model.select'></span><span id='topic+pva.llr'></span><span id='topic+print.pvaModelSelect'></span>

<h3>Description</h3>

<p>Likelihood ratio calculation and model selection
for (hierarchical) 'pva' objects.
</p>
<p><code>pva.llr</code> is the workhorse behind 
<code>model.select</code>. <code>pva.llr</code> can also
be used for profile likelihood calculations
if called iteratively (no wrapper presently).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pva.llr(null, alt, pred)
model.select(null, alt, B = 10^4)
## S3 method for class 'pvaModelSelect'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.select_+3A_null">null</code></td>
<td>

<p>A fitted 'pva' object representing the
Null Hypothesis.
</p>
</td></tr>
<tr><td><code id="model.select_+3A_alt">alt</code></td>
<td>

<p>A fitted 'pva' object representing the
Alternative Hypothesis (usually broader model).
</p>
</td></tr>
<tr><td><code id="model.select_+3A_b">B</code></td>
<td>

<p>Number of replicates to be generated from
the latent variables.
</p>
</td></tr>
<tr><td><code id="model.select_+3A_pred">pred</code></td>
<td>

<p>A matrix of replicates from the latent variables,
e.g. as returned by <code><a href="#topic+generateLatent">generateLatent</a></code>.
When there are no missing values and both the model objects
for the null and alternative hypotheses are without observation error,
<code>pred</code> can be missing. 
The log observations are used when <code>pred</code> is missing, and any user 
supplied values for <code>pred</code> are used if provided.
</p>
</td></tr>
<tr><td><code id="model.select_+3A_x">x</code></td>
<td>

<p>A model selection object to be printed.
</p>
</td></tr>
<tr><td><code id="model.select_+3A_...">...</code></td>
<td>

<p>Additional argument for print method.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions implement Ponciano et. al.'s (2009) data cloning
likelihood ratio algorithm (DCLR)
to compute likelihood ratios for comparing hierarchical 
(random effect) models. In the population growth 
models context, these models are (1) with observation error 
population growth models, and/or 
(2) population growth models with missing observations. 
</p>
<p>The functions can also compute likelihood ratios 
when both of the population growth models are fixed effect models, 
e.g. without observation error Gompertz 
model Vs. without observation error Ricker model. 
See examples below and in <code><a href="#topic+pva">pva</a></code>.
</p>


<h3>Value</h3>

<p><code>pva.llr</code> returns a single numeric value, the 
log likelihood ratio of the two models (logLik0 - logLik1).
</p>
<p><code>model.select</code> returns a modified data frame
with log likelihood ratio and various information
criteria metrics (delta AIC, BIC, AICc).
</p>
<p>The print method gives fancy model names and
a human readable interpretation of the numbers.
</p>


<h3>Author(s)</h3>

<p>Khurram Nadeem and Peter Solymos
</p>


<h3>References</h3>

<p>Ponciano, J. M. et al. 2009. Hierarchical models in ecology: 
confidence intervals, hypothesis testing, 
and model selection using data cloning. Ecology 90, 356&ndash;362. 
</p>
<p>Nadeem, K., Lele S. R., 2012.  
Likelihood based population viability analysis in the presence of 
observation error. Oikos 121, 1656&ndash;1664.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pva">pva</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(redstart)
m1 &lt;- pva(redstart, gompertz("none"), 2, n.iter=1000)
m2 &lt;- pva(redstart, gompertz("poisson"), 2, n.iter=1000)
m3 &lt;- pva(redstart, gompertz("normal"), 2, n.iter=1000)
p &lt;- generateLatent(m2, n.chains=1, n.iter=10000)
pva.llr(m1, m2, p)
model.select(m1, m2)
model.select(m1, m3)
model.select(m2, m3)

m1x &lt;- pva(redstart, ricker("none"), 2, n.iter=1000)
m2x &lt;- pva(redstart, ricker("poisson"), 2, n.iter=1000)
m3x &lt;- pva(redstart, ricker("normal"), 2, n.iter=1000)

model.select(m1, m1x)
model.select(m2, m2x)
model.select(m3, m3x)

## missing data situation
data(paurelia)
m1z &lt;- pva(paurelia, ricker("none"), 2, n.iter=1000)
m2z &lt;- pva(paurelia, ricker("poisson"), 2, n.iter=1000)
m3z &lt;- pva(paurelia, ricker("normal"), 2, n.iter=1000)

#model.select(m1z, m2z) # not yet implemented
#model.select(m1z, m3z) # not yet implemented
model.select(m2z, m3z)

## Analysis of song sparrow data in Nadeem and Lele (2012)
## use about 100 clones to get MLE's repoted in the paper.
data(songsparrow)
m1z &lt;- pva(songsparrow, 
    thetalogistic_D("normal",fixed=c(sigma2.d=0.66)), 
    n.clones=5, n.adapt=3000, n.iter=1000)
m2z &lt;- pva(songsparrow, 
    thetalogistic_D("normal",fixed=c(theta=1, sigma2.d=0.66)), 
    n.clones=5, n.adapt=3000,n.iter=1000)
m3z &lt;- pva(songsparrow, 
    thetalogistic_D("none",fixed=c(sigma2.d=0.66)), 
    n.clones=5, n.adapt=3000,n.iter=1000)
m4z &lt;- pva(songsparrow, 
    thetalogistic_D("none",fixed=c(theta=1,sigma2.d=0.66)), 
    n.clones=5, n.adapt=3000,n.iter=1000)

model.select(m2z, m1z) 
model.select(m3z, m1z) 
model.select(m4z, m1z)

## profile likelihood
m &lt;- pva(redstart, gompertz("normal"), 5, n.iter=5000)
p &lt;- generateLatent(m, n.chains=1, n.iter=10000)
m1 &lt;- pva(redstart, gompertz("normal", 
    fixed=c(sigma=0.4)), 5, n.iter=5000)
## etc for many sigma values
pva.llr(m1, m, p) # calculate log LR for each
## finally, fit smoother to points and plot

## End(Not run)
</code></pre>

<hr>
<h2 id='paurelia'>
Paramecium abundance time series
</h2><span id='topic+paurelia'></span>

<h3>Description</h3>

<p><em>Paramecium aurelia</em> abundance time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(paurelia)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:20] 2 NA 17 29 39 63 185 258 267 392 ...
</p>


<h3>Details</h3>

<p><em>Paramecium aurelia</em> abundance time series with a missing value.
</p>


<h3>Source</h3>

<p>Gause (1934: Appendix I, Table 3)
</p>


<h3>References</h3>

<p>Gause, G.F. (1934). The Struggle for Existence. Williams &amp; Wilkins, Baltimore.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(paurelia)
paurelia
plot(paurelia)
</code></pre>

<hr>
<h2 id='pva'>
Population Viability Analysis
</h2><span id='topic+pva'></span><span id='topic+diagn_scale'></span>

<h3>Description</h3>

<p>Population Viability Analysis (PVA).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pva(x, model, n.clones, ...)
diagn_scale(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pva_+3A_x">x</code></td>
<td>

<p>Numeric, a time series. Values must be non-negative,
missing values are allowed (but first and last observation
must not be missing).
</p>
</td></tr>
<tr><td><code id="pva_+3A_model">model</code></td>
<td>

<p>A 'pvamodel' object returned by a function, see Examples.
</p>
</td></tr>
<tr><td><code id="pva_+3A_n.clones">n.clones</code></td>
<td>

<p>Numeric, number of clones (possibly a vector).
</p>
</td></tr>
<tr><td><code id="pva_+3A_object">object</code></td>
<td>

<p>A fitted 'pva' object returned by the <code>pva</code> function.
</p>
</td></tr>
<tr><td><code id="pva_+3A_...">...</code></td>
<td>

<p>Arguments passed to underlying fitting functions,
most notably <code>n.update</code>, <code>n.iter</code>,
<code>n.chains</code>, <code>thin</code>, <code>cl</code>.
See <code><a href="dcmle.html#topic+dcmle">dcmle</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function implements the first step in PVA, i.e. to fit a
given growth model to a population time series
data (Nadeem and Lele, 2012). The function employs
Lele et. al's (2007, 2010) data cloning (DC) algorithm for computing
the maximum likelihood estimates of model parameters along with the
corresponding standard errors. See Solymos (2010) for
an R implementation of the DC algorithm. The growth models currently
available in the package PVAClone are listed on
the <a href="#topic+growthmodels">growthmodels</a> page.
</p>
<p>These models can also be fitted assuming
the presence of observation error using the general state-space model
formulation (Nadeem and Lele, 2012). Currently the Normal and Poisson
observation error models are supported.
</p>
<p>Normal observation error model:
<code class="reqn">y_{t} \sim Normal(x_{t}, \tau^2)</code>,
where <code class="reqn">y_{t}</code> is the estimated abundance
on the log scale at time <code class="reqn">t</code>.
</p>
<p>Poisson observation error model:
<code class="reqn">O_{t} \sim Poisson(e^{x_{t}})</code>,
where <code class="reqn">O_{t}</code> is the estimated abundance at time <code class="reqn">t</code>.
</p>
<p>In addition, missing observations can be accommodated in both with or
without observation error cases.
</p>


<h3>Value</h3>

<p>An object of class 'pva', see <code><a href="#topic+pva-class">pva-class</a></code>.
</p>


<h3>Author(s)</h3>

<p>Khurram Nadeem and Peter Solymos
</p>


<h3>References</h3>

<p>Lele, S.R., B. Dennis and F. Lutscher, 2007.
Data cloning: easy maximum likelihood estimation for
complex ecological models using Bayesian Markov
chain Monte Carlo methods. Ecology Letters 10, 551&ndash;563.
</p>
<p>Lele, S. R., K. Nadeem and B. Schmuland, 2010.
Estimability and likelihood inference for generalized
linear mixed models using data cloning.
Journal of the American Statistical Association 105,
1617&ndash;1625.
</p>
<p>Nadeem, K., Lele S. R., 2012.
Likelihood based population viability analysis in the presence of
observation error. Oikos 121, 1656&ndash;1664.
</p>
<p>Solymos, P., 2010. dclone: Data Cloning in R.
The R Journal 2(2), 29&ndash;37. URL:
<a href="https://doi.org/10.32614/RJ-2010-011">doi:10.32614/RJ-2010-011</a>
</p>


<h3>See Also</h3>

<p>Model selection: <code><a href="#topic+model.select">model.select</a></code>
</p>
<p>Growth models: <a href="#topic+growthmodels">growthmodels</a>
</p>
<p>Class definitions: <code><a href="#topic+pva-class">pva-class</a></code>, <code><a href="#topic+pvamodel-class">pvamodel-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(redstart)
data(paurelia)
data(songsparrow)

## Gompertz
m1 &lt;- pva(redstart, "gompertz", c(5,10))
m2 &lt;- pva(redstart, gompertz("poisson"), c(5,10))
m3 &lt;- pva(redstart, gompertz("normal"), c(5,10))
m1na &lt;- pva(paurelia, "gompertz", c(5,10))
m2na &lt;- pva(paurelia, gompertz("poisson"), c(5,10))
m3na &lt;- pva(paurelia, gompertz("normal"), c(5,10))
m1x &lt;- pva(redstart, gompertz("normal"), 5)
m2x &lt;- pva(redstart, gompertz("normal", fixed=c(tau=0.1)), 5)

## Ricker
m1 &lt;- pva(redstart, "ricker", c(5,10))
m2 &lt;- pva(redstart, ricker("poisson"), c(5,10))
m3 &lt;- pva(redstart, ricker("normal"), c(5,10))
m1na &lt;- pva(paurelia, "ricker", c(5,10))
m2na &lt;- pva(paurelia, ricker("poisson"), c(5,10))
m3na &lt;- pva(paurelia, ricker("normal"), c(5,10))
m1x &lt;- pva(redstart, ricker("normal"), 5)
m2x &lt;- pva(redstart, ricker("normal", fixed=c(tau=0.1)), 5)

## Theta-Logistic
m1 &lt;- pva(songsparrow, "thetalogistic", c(5,10))
m2 &lt;- pva(songsparrow, thetalogistic("poisson"), c(2,5))
m3 &lt;- pva(songsparrow, thetalogistic("normal"), c(2,5))
m1x &lt;- pva(songsparrow,
    thetalogistic_D("normal", fixed=c(sigma2.d=0.66)), 5)
m2x &lt;- pva(songsparrow,
    thetalogistic_D("none", fixed=c(theta=1, sigma2.d=0.66)), 10)

m2x
summary(m2x)
coef(m2x)
vcov(m2x)
confint(m2x)
plot(m2x)
plot(diagn_scale(m2x))

## End(Not run)
</code></pre>

<hr>
<h2 id='pva-class'>Class <code>"pva"</code></h2><span id='topic+pva-class'></span>

<h3>Description</h3>

<p>Model class for fitted PVA objects.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("pva", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>observations</code>:</dt><dd><p>Object of class <code>"numeric"</code>,
vector of observations (must be non-negative but not necessarily
integer), possibly with missing values (<code>NA</code>). </p>
</dd>
<dt><code>model</code>:</dt><dd><p>Object of class <code>"pvamodel"</code>,
internal representation of the growth model and observation error
structure.</p>
</dd>
<dt><code>summary</code>:</dt><dd><p>Object of class <code>"matrix"</code>,
asymptotic Wald-type summary on the 'original'
scale of the parameters (i.e. not on the scale used
for model fitting and diagnostics).</p>
</dd>
<dt><code>dcdata</code>:</dt><dd><p>Object of class <code>"dcFit"</code>,
internal representation of the data and JAGS model.</p>
</dd>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"language"</code>,
the call.</p>
</dd>
<dt><code>coef</code>:</dt><dd><p>Object of class <code>"numeric"</code>,
point estimates of the model parameters.</p>
</dd>
<dt><code>fullcoef</code>:</dt><dd><p>Object of class <code>"numeric"</code>,
vector possibly containing fixed parameter values.</p>
</dd>
<dt><code>vcov</code>:</dt><dd><p>Object of class <code>"matrix"</code>,
variance covariance matrix of the estimates.</p>
</dd>
<dt><code>details</code>:</dt><dd><p>Object of class <code>"dcCodaMCMC"</code>,
MCMC output from data cloning.</p>
</dd>
<dt><code>nobs</code>:</dt><dd><p>Object of class <code>"integer"</code>,
number of observations (excluding missing values).</p>
</dd>
<dt><code>method</code>:</dt><dd><p>Object of class <code>"character"</code>,
optimization method (data cloning).</p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code>"dcmle"</code>, directly.
</p>


<h3>Methods</h3>


<dl>
<dt>coef</dt><dd><p><code>signature(object = "pva")</code></p>
</dd>
<dt>confint</dt><dd><p><code>signature(object = "pva")</code></p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "pva")</code></p>
</dd>
<dt>vcov</dt><dd><p><code>signature(object = "pva")</code></p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Khurram Nadeem and Peter Solymos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pva">pva</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("pva")
</code></pre>

<hr>
<h2 id='pva-methods'>Methods for 'pva' objects</h2><span id='topic+summary+2Cpva-method'></span><span id='topic+coef+2Cpva-method'></span><span id='topic+confint+2Cpva-method'></span><span id='topic+vcov+2Cpva-method'></span>

<h3>Description</h3>

<p><code>coef</code>, <code>vcov</code>, <code>confint</code>,
and <code>summary</code> methods for 'pva' objects.
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "pva")</code></dt><dd>
<p>Methods for S4 objects of class 'pva'.
</p>
</dd>
</dl>

<hr>
<h2 id='PVAClone-package'>
Population Viability Analysis with Data Cloning
</h2><span id='topic+PVAClone-package'></span><span id='topic+PVAClone'></span><span id='topic+pvaclone'></span><span id='topic+PVA'></span><span id='topic+Pva'></span>

<h3>Description</h3>

<p>Likelihood based population viability analysis in the 
presence of observation error and missing data. 
The package can be used to fit, compare, predict, 
and forecast various growth model types using data cloning.
</p>


<h3>Details</h3>

<p>The package implements data cloning based population viability analysis 
methodology developed by Nadeem and Lele (2012). This includes
model estimation, model selection
and forecasting of future population abundances for estimate 
the extinction risk of a population of interest.
</p>
<p><code><a href="#topic+pva">pva</a></code>: main function for model fitting.
</p>
<p><code><a href="#topic+model.select">model.select</a></code>: main function for model model selection.
</p>
<p>Growth models: <code><a href="#topic+gompertz">gompertz</a></code>, <code><a href="#topic+ricker">ricker</a></code>,
<code><a href="#topic+bevertonholt">bevertonholt</a></code>, 
<code><a href="#topic+thetalogistic">thetalogistic</a></code>, <code><a href="#topic+thetalogistic_D">thetalogistic_D</a></code>.
</p>


<h3>Author(s)</h3>

<p>Khurram Nadeem, Peter Solymos
</p>
<p>Maintainer: Peter Solymos &lt;psolymos@gmail.com&gt;
</p>


<h3>References</h3>

<p>Nadeem, K., Lele S. R., 2012.  
Likelihood based population viability analysis in the presence of 
observation error. Oikos 121, 1656&ndash;1664.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pva">pva</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## model selection for data with missing observations
data(songsparrow)
## model without observation error
m1 &lt;- pva(songsparrow, gompertz("none"), 2, n.iter=1000)
## model with Poisson observation error
m2 &lt;- pva(songsparrow, gompertz("poisson"), 2, n.iter=1000)
## model with Poisson observation error is strongly supported
model.select(m1, m2)

## End(Not run)
</code></pre>

<hr>
<h2 id='pvamodel-class'>Class <code>"pvamodel"</code></h2><span id='topic+pvamodel-class'></span>

<h3>Description</h3>

<p>S4 class for predefined PVA models.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("pvamodel", ...)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>growth.model</code>:</dt><dd><p>Object of class <code>"character"</code>,
name of growth model.</p>
</dd>
<dt><code>obs.error</code>:</dt><dd><p>Object of class <code>"character"</code>,
name of observation error type (<code>"none"</code>, 
<code>"poisson"</code>, <code>"normal"</code>).</p>
</dd>
<dt><code>model</code>:</dt><dd><p>Object of class <code>"dcModel"</code>,
BUGS model for estimation.</p>
</dd>
<dt><code>genmodel</code>:</dt><dd><p>Object of class <code>"dcModel"</code>,
BUGS model for prediction.</p>
</dd>
<dt><code>p</code>:</dt><dd><p>Object of class <code>"integer"</code>,
number of parameters in model (including fixed parameters!).</p>
</dd>
<dt><code>support</code>:</dt><dd><p>Object of class <code>"matrix"</code>,
range of support for parameters (true parameter scale).</p>
</dd>
<dt><code>params</code>:</dt><dd><p>Object of class <code>"character"</code>,
parameter names (diagnostic scale).</p>
</dd>
<dt><code>varnames</code>:</dt><dd><p>Object of class <code>"character"</code>,
parameter names (true parameter scale).</p>
</dd>
<dt><code>fixed</code>:</dt><dd><p>Object of class <code>"nClones"</code>,
named vector of fixed parameters.</p>
</dd>
<dt><code>fancy</code>:</dt><dd><p>Object of class <code>"character"</code>,
fancy model description.</p>
</dd>
<dt><code>transf</code>:</dt><dd><p>Object of class <code>"function"</code>,
function to transform from true parameter scale to diagnostic 
scale (takes care of fixed value which are not part of the 
MCMC output.</p>
</dd>
<dt><code>backtransf</code>:</dt><dd><p>Object of class <code>"function"</code>,
function to transform from diagnostic scale to true parameter
scale (takes care of fixed value which are not part of the 
MCMC output.</p>
</dd>
<dt><code>logdensity</code>:</dt><dd><p>Object of class <code>"function"</code>,
function to calculate log density (used in model selection).</p>
</dd>
<dt><code>neffective</code>:</dt><dd><p>Object of class <code>"function"</code>,
function to calculate effective sample size from the number 
of observations.</p>
</dd>
</dl>



<h3>Methods</h3>

<p>No methods defined with class &quot;pvamodel&quot; in the signature.
</p>


<h3>Author(s)</h3>

<p>Khurram Nadeem and Peter Solymos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pva">pva</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("pvamodel")
</code></pre>

<hr>
<h2 id='redstart'>
Abundance time series of American Redstart
</h2><span id='topic+redstart'></span>

<h3>Description</h3>

<p>Counts for American Redstart (<em>Setophaga ruticilla</em>) at a 
survey location in the North American Breeding Bird Survey 
(BBS; Robbins et al. 1986, Peterjohn 1994).
BBS record number 0214332808636 observed from 1966 to 1995.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(redstart)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:30] 18 10 9 14 17 14 5 10 9 5 ...
</p>


<h3>Details</h3>

<p>redstart abundance time series
</p>


<h3>Source</h3>

<p>Data reported in B. Dennis,
J. M. Ponciano, S. R. Lele, M. L. Taper, and D. F.
Staples (unpublished manuscript, see Lele 2006).
</p>


<h3>References</h3>

<p>Lele, S.R. 2006. Sampling variability and estimates of density 
dependence: a composite-likelihood approach.
Ecology 87, 189&ndash;202.
</p>
<p>Peterjohn, B.G. 1994. 
The North American Breeding Bird Survey. Birding 26, 386&ndash;398.
</p>
<p>Robbins, C.S., D. Bystrak, and P.H. Geissler. 1986. 
The breeding bird survey: its first
fifteen years, 1965&ndash;1979. U.S. Fish and Wildl. Serv. 
Resource Publ. 157. Washington, D.C.
196 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(redstart)
redstart
plot(redstart)
</code></pre>

<hr>
<h2 id='songsparrow'>
Abundance time series of Song Sparrow
</h2><span id='topic+songsparrow'></span>

<h3>Description</h3>

<p>Counts for Song Sparrow (<em>Melospiza melodia</em>) on
Mandarte Island, British Columbia, Canada from 1975&ndash;1998
reported in Saether et al. (2000).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(songsparrow)</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:24] 35 31 45 48 66  9 19 26 54 ...
</p>


<h3>Details</h3>

<p>Song Sparrow abundance time series.
</p>


<h3>Source</h3>

<p>Peter Arcese kindly provided the Song Sparrow population
counts data.
</p>


<h3>References</h3>

<p>Nadeem, K., Lele S. R., 2012.  
Likelihood based population viability analysis in the presence of 
observation error. Oikos 121, 1656&ndash;1664.
</p>
<p>Saether, B. et al. 2000. 
Estimating the time to extinction in an island population 
of song sparrows. Proc. R. Soc. B 267, 621&ndash;626.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(songsparrow)
songsparrow
plot(songsparrow)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
