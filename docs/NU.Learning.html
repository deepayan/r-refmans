<!DOCTYPE html><html><head><title>Help for package NU.Learning</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NU.Learning}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confirm'><p>Confirm that Clustering in Covariate X-space yields an &quot;adjusted&quot; LTD/LRC effect-size Distribution</p></a></li>
<li><a href='#ivadj'><p>Instrumental Variable LAO Fitting and Smoothing</p></a></li>
<li><a href='#KSperm'><p>Simulate a p-value for the significance of the Kolmogorov-Smirnov D-statistic from confirm().</p></a></li>
<li><a href='#lrcagg'><p>Calculate the observed Distribution of LRCs in NU.Learning</p></a></li>
<li><a href='#ltdagg'><p>Calculate the Observed Distribution of LTDs in NU.Learning</p></a></li>
<li><a href='#mlme'><p>Create a &lt;&lt;Most-Like-Me&gt;&gt; data.frame for a specified X-Confounder vector: xvec</p></a></li>
<li><a href='#mlme.stats'><p>Print Summary Statistics for One or More &quot;Most-Like-Me&quot; Histogram Pairs.</p></a></li>
<li><a href='#NU.Learning-internal'><p>Internal LocalControlStrategy functions.</p></a></li>
<li><a href='#NU.Learning-package'><p>NU.Learning: Nonparametric and Unsupervised Adjustment for Bias and Confounding</p></a></li>
<li><a href='#NUcluster'><p>Hierarchical Clustering of experimental units (such as patients) in X-covariate Space</p></a></li>
<li><a href='#NUcompare'><p>Display NU Sensitivity Graphic for help in choice of K = Number of Clusters</p></a></li>
<li><a href='#NUsetup'><p>Specify KEY parameters used in NU.Learning to &quot;design&quot; analyses of Observational Data.</p></a></li>
<li><a href='#pci15k'><p>Six-month Survival, Cardiac cost and Baseline Covariate data for 15,487 PCI patients.</p></a></li>
<li><a href='#plot.ivadj'><p>Display an Instrumental Variable (LAO) plot with Linear and smooth.spline Fits</p></a></li>
<li><a href='#plot.lrcagg'><p>Display Visualizations of an Observed LRC Distribution in NU.Learning</p></a></li>
<li><a href='#plot.ltdagg'><p>Display Visualizations of an Observed LTD Distribution in NU.Learning</p></a></li>
<li><a href='#plot.mlme'><p>Display a Pair (or Pairs) of Histograms showing LOCAL effect-sizes for Patients &quot;Most-Like-Me&quot;.</p></a></li>
<li><a href='#pmdata'><p>Particulate Matter, Mortality and Other data for 2980 US Counties</p></a></li>
<li><a href='#print.mlme'><p>Print Summary Statistics on Local effect-size Estimates for Patients &quot;Most-Like-Me&quot;.</p></a></li>
<li><a href='#radon'><p>Radon exposure and lung cancer mortality data for 2,881 US counties in 46 States.</p></a></li>
<li><a href='#reveal.data'><p>Create a data.frame for use in Prediction of a LTD/LRC effect-size Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-15</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric and Unsupervised Learning from Cross-Sectional
Observational Data</td>
</tr>
<tr>
<td>Author:</td>
<td>Bob Obenchain [aut, cre],
  Stan Young [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bob Obenchain &lt;wizbob@att.net&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), cluster, lattice</td>
</tr>
<tr>
<td>Description:</td>
<td>Especially when cross-sectional data are observational, effects of treatment selection
  bias and confounding are best revealed by using Nonparametric and Unsupervised methods to
  "Design" the analysis of the given data ...rather than the collection of "designed data".
  Specifically, the "effect-size distribution" that best quantifies a potentially causal
  relationship between a numeric y-Outcome variable and either a binary t-Treatment or
  continuous e-Exposure variable needs to consist of BLOCKS of relatively well-matched
  experimental units (e.g. patients) that have the most similar X-confounder characteristics.
  Since our NU Learning approach will form BLOCKS by "clustering" experimental units in
  confounder X-space, the implicit statistical model for learning is One-Way ANOVA. Within
  Block measures of effect-size are then either [a] LOCAL Treatment Differences (LTDs) between
  Within-Cluster y-Outcome Means ("new" minus "control") when treatment choice is
  Binary or else [b] LOCAL Rank Correlations (LRCs) when the e-Exposure variable is numeric
  with (hopefully many) more than two levels. An Instrumental Variable (IV) method is also
  provided so that Local Average y-Outcomes (LAOs) within BLOCKS may also contribute
  information for effect-size inferences when X-Covariates are assumed to influence Treatment
  choice or Exposure level but otherwise have no direct effects on y-Outcomes. Finally, a
  "Most-Like-Me" function provides histograms of effect-size distributions to aid
  Doctor-Patient (or Researcher-Society) communications about Heterogeneous Outcomes.
  Obenchain and Young (2013) &lt;<a href="https://doi.org/10.1080%2F15598608.2013.772821">doi:10.1080/15598608.2013.772821</a>&gt;; Obenchain, Young and Krstic
  (2019) &lt;<a href="https://doi.org/10.1016%2Fj.yrtph.2019.104418">doi:10.1016/j.yrtph.2019.104418</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a>, <a href="http://localcontrolstatistics.org">http://localcontrolstatistics.org</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-11 23:49:36 UTC; bobo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-30 22:52:43 UTC</td>
</tr>
</table>
<hr>
<h2 id='confirm'>Confirm that Clustering in Covariate X-space yields an &quot;adjusted&quot; LTD/LRC effect-size Distribution</h2><span id='topic+confirm'></span>

<h3>Description</h3>

<p>For a given Number of Clusters, K, confirm() compares the observed distribution of LTDs or
LRCs from relatively well-matched experimental units with the corresponding distribution from Purely
Random Clusterings of experimental units. The larger are differences between the (blue) observed
empirical CDF of effect-sizes and the (red) Purely Random CDF, the more potentially IMPORTANT are the
&quot;adjustments&quot; resulting from focussing upon clustering (matching) of experimental units in X-space.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confirm(x, reps=100, seed=12345)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confirm_+3A_x">x</code></td>
<td>
<p>An output object from ltdagg() or lrcagg() for a specified number of clusters, K.</p>
</td></tr>
<tr><td><code id="confirm_+3A_reps">reps</code></td>
<td>
<p>Number of simulation Replications, each with the same number, K, and sizes, N1,
N2, ..., NK of Purely Random clusters.</p>
</td></tr>
<tr><td><code id="confirm_+3A_seed">seed</code></td>
<td>
<p>This (arbitrary) integer argument will be passed to the R set.seed() function.
Knowing the value of this seed makes the output from confirm() reproducible.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Making calls to confirm() for ltdagg() or lrcagg() objects resulting from different choices
of K = Numbers of Clusters help the analyst decide which observed LTD or LRC effect-size
distributions are (or are not) meaningfully different from Purely Random. When the X-covariates
used in NUcluster() are truly &quot;ignorable,&quot; then [i] all X-based clusters will be Purely Random,
and [ii] both the number (K) and the sizes (N1, N2, ...,NK) of clusters formed will be meaningless
and arbitrary. Thus the NU Strategy confirm() function simulates the empirical CDF for LTDs or
LRCs resulting from purely random permutations of the Cluster ID numbers (1, 2, ...,K) assigned
by ltdagg() or lrcagg(). Each permutation yields K artificial &quot;clusters&quot; of sizes N1, N2, ..., NK.
Simulation results are accumulated for the total number of random permutations specified in the
&quot;reps=&quot; argument of confirm(). Calls to print.confirm() and plot.confirm() provide information on
comparisons of empirical CDFs for the Observed and Purely Random LTD/LRC distributions, including
calculation of an observed two-sample Kolmogorov-Smirnov D-statistic using stats::ks.test. This is
a non-standard use of ks.test() because the distributions being compared are DISCRETE; both contain
many within-cluster TIED effect-size estimates. The p-value computed by ks.test() is not reported
or saved because it is badly biased downwards due to TIED estimates. Researchers wishing to simulate
a p-value for the observed KS D-statistic that is adjusted for TIES can invoke KSperm(confirm()).
</p>


<h3>Value</h3>

<p> An output list object of class confirm:
</p>
<table>
<tr><td><code>hiclus</code></td>
<td>
<p>Hierarchical clustering object created by the designated method.</p>
</td></tr>
<tr><td><code>dframe</code></td>
<td>
<p>Name of data.frame containing X, trex &amp; Y variables.</p>
</td></tr>
<tr><td><code>trtm</code></td>
<td>
<p>Name of numerical trex variable.</p>
</td></tr>
<tr><td><code>yvar</code></td>
<td>
<p>Name of numerical Y-outcome variable.</p>
</td></tr>
<tr><td><code>reps</code></td>
<td>
<p>Number of overall Replications, each with the same numbers of requested clusters.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>Integer argument passed to set.seed(). Knowing which seed value was used in the
call to confirm() makes not only the NULL distribution of observed LTDs or LRCs reproducible
but also makes the NULL distribution of D-statistics (adjusted for ties) from a subsequent
call to KSperm() reproducible.</p>
</td></tr>
<tr><td><code>nclus</code></td>
<td>
<p>Number of clusters requested.</p>
</td></tr>
<tr><td><code>units</code></td>
<td>
<p>Number of experimental units or patients.</p>
</td></tr> 
<tr><td><code>Type</code></td>
<td>
<p>1 ==&gt; LTDs, otherwise LRCs.</p>
</td></tr>
<tr><td><code>NUmean</code></td>
<td>
<p>Weighted Local Mean across Clusters.</p>
</td></tr> 
<tr><td><code>NUstde</code></td>
<td>
<p>Weighted Std. Error across Clusters.</p>
</td></tr> 
<tr><td><code>RPmean</code></td>
<td>
<p>Weighted Random Permutation Mean across Clusters.</p>
</td></tr> 
<tr><td><code>RPstde</code></td>
<td>
<p>Weighted Random Permutation Std. Error across Clusters.</p>
</td></tr>  
<tr><td><code>KSobsD</code></td>
<td>
<p>Output from print(ks.test()).</p>
</td></tr>
<tr><td><code>NUdist</code></td>
<td>
<p>data.frame of 5 key variables for all experimental units.</p>
</td></tr>
<tr><td><code>dfconf</code></td>
<td>
<p>data.frame of lstat = LTD or LRC values of max(length) = reps*units.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (2010) The Local Control Approach using JMP. Chapter 7 of
<b>Analysis of Observational Health Care Data using SAS</b>, <em>Cary, NC:SAS Press</em>,
pages 151-192. 
</p>
<p>Obenchain RL. (2023) <b>NU.Learning_in_R.pdf</b> http://localcontrolstatistics.org 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ltdagg">ltdagg</a></code> and <code><a href="#topic+lrcagg">lrcagg</a></code>.</p>

<hr>
<h2 id='ivadj'>Instrumental Variable LAO Fitting and Smoothing</h2><span id='topic+ivadj'></span>

<h3>Description</h3>

<p>For a given number of patient clusters in baseline X-covariate space and a
specified Y-outcome variable, smooth the distribution of Local Average Outcomes (LAOs)
plotted versus Within-Cluster Propensity-like Scores: the Treatment Selection Fraction
or the Relative Exposure Level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ivadj(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ivadj_+3A_x">x</code></td>
<td>
<p>An output object from ltdagg() or lrcagg() using K Clusters in X-covariate space.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiple invocations of ivadj(ltdagg()) or ivadj(lrgagg()) using varying numbers of
clusters, K, can be made. Each invocation of ivadj() displays a linear lm() fit and a
smooth.spline() fit to the scatter of LAO estimates plotted versus their within-cluster
propensity-like score estimates.
</p>


<h3>Value</h3>

<p> An output list object of class ivadj:
</p>
<table>
<tr><td><code>hclobj</code></td>
<td>
<p>Name of clustering object output by NUcluster().</p>
</td></tr>
<tr><td><code>dframe</code></td>
<td>
<p>Name of data.frame containing X, trtm &amp; Y variables.</p>
</td></tr>
<tr><td><code>trtm</code></td>
<td>
<p>Name of the numeric treatment variable.</p>
</td></tr>
<tr><td><code>yvar</code></td>
<td>
<p>Name of the numeric outcome Y variable.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of Clusters Requested.</p>
</td></tr>
<tr><td><code>actclust</code></td>
<td>
<p>Number of Clusters actually produced.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>McClellan M, McNeil BJ, Newhouse JP. (1994) Does More Intensive Treatment of
Myocardial Infarction in the Elderly Reduce Mortality?: Analysis Using Instrumental
Variables. <em>JAMA</em> <b>272</b>: 859-866.
</p>
<p>Obenchain RL. (2010) Local Control Approach using JMP. Chapter 7 of
<b>Analysis of Observational Health Care Data using SAS</b>, <em>Cary, NC:SAS Press</em>,
pages 151-192.
</p>
<p>Obenchain RL. (2023) <b>NU.Learning_in_R.pdf</b> http://localcontrolstatistics.org 
</p>
<p>Rosenbaum PR, Rubin RB. (1983) The Central Role of the Propensity Score
in Observational Studies for Causal Effects. <em>Biometrika</em> <b>70</b>:
41-55.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ltdagg">ltdagg</a></code>, <code><a href="#topic+lrcagg">lrcagg</a></code> and <code><a href="#topic+NUcompare">NUcompare</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  # Running takes about 7 seconds...
  data(pci15k)
  xvars = c("stent", "height", "female", "diabetic", "acutemi", "ejfract", "ves1proc")
  hclobj = NUcluster(pci15k, xvars)
  NU.env = NUsetup(hclobj, pci15k, thin, surv6mo)
  surv050 = ltdagg(50, NU.env)
  iv050 = ivadj(surv050)
  iv050
  plot(iv050)
  
</code></pre>

<hr>
<h2 id='KSperm'>Simulate a p-value for the significance of the Kolmogorov-Smirnov D-statistic from confirm().</h2><span id='topic+KSperm'></span>

<h3>Description</h3>

<p>For a given confirm() output object, KSperm() simulates the NULL distribution of LTDs or
LRCs resulting from Purely Random Clusterings of experimental units within the parent data.frame.
This NULL distribution is discrete because Local Effect-Size estimates are TIED within-clusters. The
observed D-Statistic from confirm() is compared with new NULL order statistics computed by KSperm(),
again using stats::ks.test. When KSperm() is called immediately after confirm() and the seed value
used in confirm() is known, then both the simulated p-value and the additional NULL KS-D order
statistics generated by KSperm() will all be reproducible.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KSperm(x, reps=100)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="KSperm_+3A_x">x</code></td>
<td>
<p>An output object from confirm().</p>
</td></tr>
<tr><td><code id="KSperm_+3A_reps">reps</code></td>
<td>
<p>This is the number of new NULL KS-D statistics to generated. Each experimental unit is
used at most once within each full replication. No clusters will be empty, but some may be
&quot;uninformative&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The observed value of the Kolmogorov-Smirnov D-statistic from confirm() is used here, but
its &quot;p.value&quot; from ks.test() is not because it is badly biased downwards. This bias results because
the distribution of LTDs or LRCs across clusters is always discrete, due to TIED values within clusters
that typically also vary in size. Thus, KSperm() generates &quot;reps&quot; additional, independent, NULL values
of KS-D and saves their order statistics. Finally, KSperm() compares the Observed KS-D from confirm()
with its simulated NULL order statistics to estimate an appropriately &quot;adjusted&quot; p-value, pv.adj. Note
that the simulated pv.adj value estimate cannot be less than 1/(reps).
</p>


<h3>Value</h3>

<p> An output list object of class KSperm:
</p>
<table>
<tr><td><code>hiclus</code></td>
<td>
<p>Hierarchical clustering object created by the designated method.</p>
</td></tr>
<tr><td><code>dframe</code></td>
<td>
<p>Name of data.frame containing X, t &amp; Y variables.</p>
</td></tr>
<tr><td><code>trtm</code></td>
<td>
<p>Name of numerical treatment/exposure variable.</p>
</td></tr>
<tr><td><code>yvar</code></td>
<td>
<p>Name of numerical y-Outcome variable.</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>1 ==&gt; LTDs, otherwise LRCs.</p>
</td></tr>
<tr><td><code>reps</code></td>
<td>
<p>Number of overall Replications, each with the same number, K, of requested clusters.</p>
</td></tr>
<tr><td><code>nclus</code></td>
<td>
<p>Number of clusters requested.</p>
</td></tr>
<tr><td><code>units</code></td>
<td>
<p>Number of experimental units or patients.</p>
</td></tr>
<tr><td><code>obsD</code></td>
<td>
<p>Observed numerical value of KS D-statistic from confirm()</p>
</td></tr>
<tr><td><code>Dvec</code></td>
<td>
<p>Vector of order statistics for simulated NULL KS D-statistics.</p>
</td></tr>
<tr><td><code>pv.adj</code></td>
<td>
<p>Simulated p-value adjusted for TIES within discrete LTD/LRC distributions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (2010) Local Control Approach using JMP. Chapter 7 of
<b>Analysis of Observational Health Care Data using SAS</b>, <em>Cary, NC:SAS Press</em>,
pages 151-192. 
</p>
<p>Obenchain RL. (2019) <b>NU.Learning_in_R.pdf</b> http://localcontrolstatistics.org 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+confirm">confirm</a></code>, <code><a href="#topic+ltdagg">ltdagg</a></code> and <code><a href="#topic+lrcagg">lrcagg</a></code>.</p>

<hr>
<h2 id='lrcagg'>Calculate the observed Distribution of LRCs in NU.Learning</h2><span id='topic+lrcagg'></span>

<h3>Description</h3>

<p>For a given number, K, of Clusters of Experimental Units in baseline X-covariate
space, lrcagg() calculates the observed distribution of &quot;Local Rank Correlations&quot; (LRCs)
across Clusters ...where each LRC = cor(trex, Y, method = &quot;spearman&quot;) within a Cluster,
trex is a numeric measure of Exposure, and Y is a numeric measure of Outcome.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  lrcagg(K, envir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrcagg_+3A_k">K</code></td>
<td>
<p>Number of Clusters in baseline X-covariate space.</p>
</td></tr>
<tr><td><code id="lrcagg_+3A_envir">envir</code></td>
<td>
<p>R environment output by a previous call to NUsetup().</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiple calls to lrcagg(K) for varying numbers of clusters, K, are typically made
after first invoking NUcluster() to hierarchically cluster patients in X-space and then
invoking NUsetup() to specify a Y Outcome variable and a continuous, numerical treatment
Exposure: trex. lrcagg() computes an observed LRC Distribution, updates information stored
in its envir object, and outputs an object that is typically saved in the user's .GlobalEnv
to allow subsequent use by print.lrcagg(), plot.lrcagg(), confirm() or KSperm(). Uninformative
Clusters (those containing only 1 or 2 experimental units) contribute <b>NA</b>
values to the LRCtabl$LRC and LRCdist$LRC objects within the lrcagg() output list.   
</p>


<h3>Value</h3>

<p> An output list of 12 objects, of class lrcagg:
</p>
<table>
<tr><td><code>hclobj</code></td>
<td>
<p>Name of clustering dendrogram object created by NUcluster().</p>
</td></tr>
<tr><td><code>dframe</code></td>
<td>
<p>Name of data.frame containing X, trex &amp; Y variables.</p>
</td></tr>
<tr><td><code>trex</code></td>
<td>
<p>Name of numerical treatment/exposure level variable.</p>
</td></tr>
<tr><td><code>yvar</code></td>
<td>
<p>Name of outcome Y variable.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of Clusters Requested.</p>
</td></tr>
<tr><td><code>actclust</code></td>
<td>
<p>Number of Clusters delivered.</p>
</td></tr>
<tr><td><code>LRCtabl</code></td>
<td>
<p>data.frame with 5 columns and K rows for Clusters.</p>
</td></tr>
<tr><td><code>LRCtabl$c</code></td>
<td>
<p>Cluster ID Factor, &quot;1&quot;, &quot;2&quot;, ..., &quot;K&quot;.</p>
</td></tr>
<tr><td><code>LRCtabl$LRC</code></td>
<td>
<p>Numerical value of Local Treatment Difference for a Cluster.</p>
</td></tr>
<tr><td><code>LRCtabl$w</code></td>
<td>
<p>Integer value of &quot;weight&quot; = Cluster Size.</p>
</td></tr>
<tr><td><code>LRCtabl$LAO</code></td>
<td>
<p>Numerical value of within-cluster Local Average Outcome (Y-value).</p>
</td></tr> 
<tr><td><code>LRCtabl$PS</code></td>
<td>
<p>Numerical value of Local Relative Propensity for Exposure, 0.0 to 1.0.</p>
</td></tr>   
<tr><td><code>LRCdist</code></td>
<td>
<p>data.frame with 5 columns and same number of rows as the data: dframe.</p>
</td></tr>
<tr><td><code>LRCdist$c.K</code></td>
<td>
<p>Cluster ID Variable of the form: &quot;c.K&quot; </p>
</td></tr>
<tr><td><code>LRCdist$ID</code></td>
<td>
<p>Observation ID Variable for the rows of the input dframe.</p>
</td></tr>
<tr><td><code>LRCdist$y</code></td>
<td>
<p>Numerical values of Y-Outcomes for Experimental Units.</p>
</td></tr>
<tr><td><code>LRCdist$t</code></td>
<td>
<p>Numerical values of Treatment-Exposure Levels for Experimental Units.</p>
</td></tr>
<tr><td><code>LRCdist$LRC</code></td>
<td>
<p>Numerical values of the LRC for the Cluster containing each Unit.</p>
</td></tr> 
<tr><td><code>infoclus</code></td>
<td>
<p>Integer value of Number of Informative Clusters.</p>
</td></tr>
<tr><td><code>infounits</code></td>
<td>
<p>Integer value of Number of Units within Informative Clusters.</p>
</td></tr>
<tr><td><code>LRCmean</code></td>
<td>
<p>Numerical value of mean(LRCdist$LRC) = Weighted Average of
LRCtabl$LRC values.</p>
</td></tr>
<tr><td><code>LRCstde</code></td>
<td>
<p>Numerical value of sqrt(var(LRCdist$LRC)) = Weighted Standard
Deviation of LRCtabl$LRC values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (2010) The Local Control Approach using JMP. Chapter 7 of
<b>Analysis of Observational Health Care Data using SAS</b>, <em>Cary, NC:SAS Press</em>,
pages 151-192.
</p>
<p>Obenchain RL. (2019) <b>NU.Learning_in_R.pdf</b> http://localcontrolstatistics.org 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ivadj">ivadj</a></code>, <code><a href="#topic+ltdagg">ltdagg</a></code> and <code><a href="#topic+NUcompare">NUcompare</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>    data(radon)
    xvars = c("obesity", "over65", "cursmoke")
    hclobj = NUcluster(radon, xvars)
    e = NUsetup(hclobj, radon, lnradon, lcanmort)
    lrc050 = lrcagg(50, e)
    lrc050
    plot(lrc050, e)
</code></pre>

<hr>
<h2 id='ltdagg'>Calculate the Observed Distribution of LTDs in NU.Learning</h2><span id='topic+ltdagg'></span>

<h3>Description</h3>

<p>For a given number, K, of Clusters of Experimental Units in baseline X-covariate
space, ltdagg() calculates the observed distribution of &quot;Local Treatment Differences&quot; (LTDs)
of the form LTD = (( mean(Y) for units receiving trtm==1 ) - ( mean(Y) for units receiving
trtm==0 )).</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ltdagg(K, envir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ltdagg_+3A_k">K</code></td>
<td>
<p>Number of Clusters in baseline X-covariate space.</p>
</td></tr>
<tr><td><code id="ltdagg_+3A_envir">envir</code></td>
<td>
<p>R environment output by a previous call to NUsetup().</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiple calls to ltdagg(K) for varying numbers of clusters, K, are typically made
after first invoking NUcluster() to hierarchically cluster patients in X-space and then
invoking NUsetup() to specify a Y Outcome variable and a two-level, numerical treatment
variable: trtm. ltdagg() computes an observed LTD Distribution, updates information stored
in its envir object, and outputs an object that is typically saved in the user's .GlobalEnv
to allow subsequent use by print.ltdagg(), plot.ltdagg(), confirm() or KSperm(). Uninformative
Clusters (those containing either only trtm==1 units or else only trtm==0 units) contribute
<b>NA</b> values to the LTDtabl$LTD and LTDdist$LTD objects within the ltdagg() output list
object.   
</p>


<h3>Value</h3>

<p> An output list of 12 objects, of class ltdagg:
</p>
<table>
<tr><td><code>hiclus</code></td>
<td>
<p>Name of clustering object created by NUcluster().</p>
</td></tr>
<tr><td><code>dframe</code></td>
<td>
<p>Name of data.frame containing X, trtm &amp; Y variables.</p>
</td></tr>
<tr><td><code>trtm</code></td>
<td>
<p>Name of treatment factor variable.</p>
</td></tr>
<tr><td><code>yvar</code></td>
<td>
<p>Name of outcome Y variable.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of Clusters Requested.</p>
</td></tr>
<tr><td><code>actclust</code></td>
<td>
<p>Number of Clusters delivered.</p>
</td></tr>
<tr><td><code>LTDtabl</code></td>
<td>
<p>data.frame with 5 columns and K rows for Clusters.</p>
</td></tr>
<tr><td><code>LTDtabl$c</code></td>
<td>
<p>Cluster ID Factor, &quot;1&quot;, &quot;2&quot;, ..., &quot;K&quot;.</p>
</td></tr>
<tr><td><code>LTDtabl$LTD</code></td>
<td>
<p>Numerical value of Local Treatment Difference for a Cluster.</p>
</td></tr>
<tr><td><code>LTDtabl$w</code></td>
<td>
<p>Integer value of &quot;weight&quot; = Cluster Size.</p>
</td></tr>
<tr><td><code>LTDtabl$LAO</code></td>
<td>
<p>Numerical value of within-cluster Local Average Outcome (Y-value).</p>
</td></tr> 
<tr><td><code>LTDtabl$PS</code></td>
<td>
<p>Numerical value of Propensity Score = Local Fraction of Experimental
Units receiving trtm==1; 0.0 &lt;= PS &lt;= 1.0.</p>
</td></tr>   
<tr><td><code>LTDdist</code></td>
<td>
<p>data.frame with 5 columns and same number of rows as the data: dframe.</p>
</td></tr>
<tr><td><code>LTDdist$c.K</code></td>
<td>
<p>Factor values within c(&quot;1&quot;, &quot;2&quot;, ..., &quot;K&quot;).</p>
</td></tr>
<tr><td><code>LTDdist$ID</code></td>
<td>
<p>Observation ID Variable for the rows of the input dframe.</p>
</td></tr>
<tr><td><code>LTDdist$y</code></td>
<td>
<p>Numerical value of the Y-Outcome for an Experimental Unit.</p>
</td></tr>
<tr><td><code>LTDdist$t</code></td>
<td>
<p>Numerical value of trtm (0 or 1) for an Experimental Unit.</p>
</td></tr>
<tr><td><code>LTDdist$LTD</code></td>
<td>
<p>Numerical value of the LTD for the Cluster containing each Exp. Unit.</p>
</td></tr> 
<tr><td><code>infoclus</code></td>
<td>
<p>Integer value of Number of Informative Clusters.</p>
</td></tr>
<tr><td><code>infounits</code></td>
<td>
<p>Integer value of Number of Units within Informative Clusters.</p>
</td></tr>
<tr><td><code>LTDmean</code></td>
<td>
<p>Numerical value of mean(LTDdist$LTD) = Weighted Average of
LTDtabl$LTD values.</p>
</td></tr>
<tr><td><code>LTDstde</code></td>
<td>
<p>Numerical value of sqrt(var(LTDdist$LTD)) = Weighted Standard
Deviation of LTDtabl$LTD values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (2010) Local Control Approach using JMP. Chapter 7 of
<b>Analysis of Observational Health Care Data using SAS</b>, <em>Cary, NC:SAS Press</em>,
pages 151-192.  
</p>
<p>Obenchain RL. (2019) <b>NU.Learning_in_R.pdf</b> http://localcontrolstatistics.org 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ivadj">ivadj</a></code>, <code><a href="#topic+lrcagg">lrcagg</a></code> and <code><a href="#topic+NUcompare">NUcompare</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  # Running takes more than 7 seconds...
  data(pci15k)
  xvars = c("stent", "height", "female", "diabetic", "acutemi", "ejfract", "ves1proc")
  hclobj = NUcluster(pci15k, xvars)
  NUe = NUsetup(hclobj, pci15k, thin, surv6mo)
  surv050 = ltdagg(50, NUe)
  surv050
  plot(surv050, NUe)
  
</code></pre>

<hr>
<h2 id='mlme'>Create a &lt;&lt;Most-Like-Me&gt;&gt; data.frame for a specified X-Confounder vector: xvec</h2><span id='topic+mlme'></span>

<h3>Description</h3>

<p>For a Given X-confounder Vector (xvec), sort all experimental units (eUnits)
in an ltdagg() or lrcagg() output object into the strictly non-decreasing order of
their distances from this X-Vector, which defines the TARGET eUnit: &quot;Me&quot;. Plots of
mlme() objects and displays of mlme.stats() are then used to Visualize and Summarize
&quot;Mini-&quot; &lt;&lt; LOCAL effect-size Distributions &gt;&gt; for different Numbers of &quot;Nearest
Neighbor&quot; eUnits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mlme(envir, hcl, NUagg, xvec )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlme_+3A_envir">envir</code></td>
<td>
<p>Environment output by a call to the NUsetup() function.</p>
</td></tr>
<tr><td><code id="mlme_+3A_hcl">hcl</code></td>
<td>
<p>Name of a NUcluster() output object created using a cluster::diana or
stats::hclust method.</p>
</td></tr>
<tr><td><code id="mlme_+3A_nuagg">NUagg</code></td>
<td>
<p>A data.frame object output by ltdagg() or lrcagg() containing LOCAL
effect-size Estimates for eUnits within Clusters defined in X-covariate space.</p>
</td></tr>
<tr><td><code id="mlme_+3A_xvec">xvec</code></td>
<td>
<p>A suitable vector of the Numerical values for the X-Confounder variables,
used in the current CLUSTERING, that define the eUnit: &quot;Me&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For example, in demo(radon), the eUnits are 2881 US &quot;Counties&quot;, and the NUagg
object is of type lrcagg() because radon exposure is a continuous variable. But, in
demo(pci15k), the eUnits are 15487 &quot;Patients,&quot; and the NUagg object is of type
ltdagg() because treatment choice (thin) is Binary (0 = &quot;No&quot;, 1 = &quot;Yes&quot;).
</p>


<h3>Value</h3>

<p> An output list object of class mlme:
</p>
<table>
<tr><td><code>xvec</code></td>
<td>
<p>The xvec vector input to mlme().</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>Either &quot;LTD&quot; or &quot;LRC&quot;.</p>
</td></tr>
<tr><td><code>xvars</code></td>
<td>
<p>Names of the X-Confounder variables specified in NUsetup().</p>
</td></tr>
<tr><td><code>varx</code></td>
<td>
<p>The vector of Variances of the xvars variabes, used in rescaling distances.</p>
</td></tr> 
<tr><td><code>outdf</code></td>
<td>
<p>The output data.frame of sorted &quot;Nearest Neighbor&quot; candidate eUnits.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. NU.Learning-vignette. (2023) <b>NU.Learning_in_R.pdf</b>
http://localcontrolstatistics.org 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.mlme">plot.mlme</a></code>,<code><a href="#topic+print.mlme">print.mlme</a></code>,<code><a href="#topic+mlme.stats">mlme.stats</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  # Running takes about 7 seconds...
  data(pci15k)
  xvars = c("stent", "height", "female", "diabetic", "acutemi", "ejfract", "ves1proc")
  hclobj = NUcluster(pci15k, xvars)
  NU.env = NUsetup(hclobj, pci15k, thin, surv6mo)
  surv0500 = ltdagg(500, NU.env)
  xvec11870 = c( 0, 162, 1, 1, 0, 57, 1) 
  mlmeC5H = mlme(envir = NU.env, hcl = hclobj, NUagg = surv0500, xvec = xvec11870 ) 	
  plot(mlmeC5H) # using default "NN" and "breaks" settings...
  
</code></pre>

<hr>
<h2 id='mlme.stats'>Print Summary Statistics for One or More &quot;Most-Like-Me&quot; Histogram Pairs.</h2><span id='topic+mlme.stats'></span>

<h3>Description</h3>

<p>Print Summary Statistics for Local effect-size (LTD or LRC) Distributions
associated with given Numbers of &quot;Nearest-Neighbors&quot; in X-confounder Space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlme.stats(x, NN = 50, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlme.stats_+3A_x">x</code></td>
<td>
<p>An object output by mlme.data().</p>
</td></tr>
<tr><td><code id="mlme.stats_+3A_nn">NN</code></td>
<td>
<p>Number(s) of &quot;Nearest Neighbors&quot; displayed in Histogram(s). NN can be either
a single integer like NN = 40 or a combination of integers like NN = c( 50, 250,
2500 ).</p>
</td></tr>
<tr><td><code id="mlme.stats_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to print().</p>
</td></tr>
</table>


<h3>Value</h3>

<p> NULL </p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.mlme">plot.mlme</a></code>,<code><a href="#topic+print.mlme">print.mlme</a></code>,<code><a href="#topic+mlme">mlme</a></code></p>

<hr>
<h2 id='NU.Learning-internal'>Internal LocalControlStrategy functions.</h2><span id='topic+NU.Learning-internal'></span><span id='topic+plot.NUcluster'></span><span id='topic+plot.confirm'></span><span id='topic+plot.KSperm'></span><span id='topic+print.NUcluster'></span><span id='topic+print.ivadj'></span><span id='topic+print.lrcagg'></span><span id='topic+print.ltdagg'></span><span id='topic+print.confirm'></span><span id='topic+print.KSperm'></span>

<h3>Description</h3>

<p>Internal functions for the NU.Learning-package.  Plot and print
functions require the output object from a NU.Learning function as their
first argument.</p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>

<hr>
<h2 id='NU.Learning-package'>NU.Learning: Nonparametric and Unsupervised Adjustment for Bias and Confounding</h2><span id='topic+NU.Learning-package'></span>

<h3>Description</h3>

<p>NU.Learning forms Local Treatment Differences (LTDs) or Local Rank Correlations
(LRCs) within Clusters of experimental units (patients, etc.) who have been relatively well-matched
on their baseline X-confounder characteristics.  The resulting distribution of LTD/LRC effect-size
estimates can be interpreted much like a Bayesian posterior. Yet these distributions have been
formed, via Nonparametric and Unsupervised Preprocessing, in purely Objective Ways.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
  Package: </td><td style="text-align: left;"> NU.Learning</td>
</tr>
<tr>
 <td style="text-align: left;">
  Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
  Version: </td><td style="text-align: left;"> 1.5</td>
</tr>
<tr>
 <td style="text-align: left;">
  Date: </td><td style="text-align: left;"> 2023-09-15</td>
</tr>
<tr>
 <td style="text-align: left;">
  License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>UNSUPERVISED LOCAL TREATMENT DIFFERENCES or LOCAL RANK CORRELATIONS:
</p>
<p>Multiple calls to ltdagg(K) or lrcagg(K) for varying numbers of clusters, K, are typically
made after first invoking NUcluster() to hierarchically cluster patients in X-space and
invoking NUsetup() to specify a numeric y-Outcome variable and a numeric treatment choice
or exposure level measure, trex. 
</p>
<p>UNSUPERVISED INSTRUMENTAL VARIABLES = LOCAL AVERAGE y-OUTCOME EFFECTS:
</p>
<p>An OBSERVED Propensity Score (PS) is defined here to be either (i) the local (within-cluster)
fraction of experimental units (patients) receiving trex==1 (new) rather than trex==0 (control)
or else (ii) a measure of &quot;relative exposure&quot; when the numeric trex measure has (many) more
than 2 observed levels. Multiple calls to ivadj(K) for varying numbers of clusters, K, then
yield alternative scatters of Local Average Outcomes (LAOs) for Clusters when plotted against
their PS estimates and, thus, different possible linear fits or smooth.splines() yielding
potentially different inferences about across-cluster Treatment or Exposure Effects.
</p>
<p>CONFIRMATION and SENSITIVITY ANALYSES of LOCAL EFFECT-SIZE DISTRIBUTIONS:
</p>
<p>For a given value of K = Number of Clusters requested, the output object from ltdagg(K) or
lrcagg(K) can be input to confirm() to use (nonparametric) permutation theory to display 
visual evidence (empirical CDF comparisons) concerning the Question: &quot;Does x-matching Truly
Matter?&quot; The NULL hypothesis here is that the x-Covariates used in Clustering / Matching of
Experimental Units are actually IGNORABLE. Evidence against this hypothesis is provided when
the observed LOCAL Effect-Size Distribution clearly deviates from the purely RANDOM, NULL
distribution computed (to any desired precision) by randomly PERMUTING cluster ID labels
across experimental units. Furthermore, the statistical significance of differences between
the observed and random NULL distributions can be estimated using KSperm(), which simulates
the random permutation distribution of the Kolmogorov-Smirnov D-statistic when many tied
values occur in both distributions being compared. Finally, the NUcompare() function helps
users of NU.Learning decide which Number of Clusters, K, optimizes Variance-Bias trade-offs.
Larger values of K tend to yield smaller clusters with better matches and, thus, potentially
reduced BIAS. On the other hand, smaller values of K usually yield local effect-size
estimates with much lower Variability (higher Precision).
</p>
<p>&quot;Most-Like-Me&quot; HISTOGRAMS for DOCTOR-PATIENT discussions of PERSONALIZED MEDICINE:
</p>
<p>For a specified vector, xvec, of numerical values of the X-confounder variables used in the
current CLUSTERING of eUnits, display histograms of observed LTD or LRC effect-sizes for
(i) all available patients and (ii) for the specified number, NN, of &quot;Nearest-Neighbors&quot; in
X-confounder space of the TARGET eUnit ...i.e. xvec defines &quot;Me&quot;.
</p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

 
<p>McClellan M, McNeil BJ, Newhouse JP. (1994) Does More Intensive Treatment of
Myocardial Infarction in the Elderly Reduce Mortality?: Analysis Using Instrumental
Variables. <em>JAMA</em> <b>272</b>: 859-866.  
</p>
<p>Obenchain RL. (2010) The Local Control Approach using JMP. Chapter 7 of
<b>Analysis of Observational Health Care Data using SAS</b>, <em>Cary, NC:SAS Press</em>,
pages 151-192. 
</p>
<p>Obenchain RL, Young SS. (2013) Advancing Statistical Thinking in Observational Health
Care Research. <em>J. Stat. Theory and Practice</em>, <b>7</b>: 456-469,
<a href="https://doi.org/10.1080/15598608.2013.772821">doi:10.1080/15598608.2013.772821</a>.
</p>
<p>Lopiano KK, Obenchain RL, Young SS. (2014) Fair treatment comparisons in observational
research. <em>Statistical Analysis and Data Mining</em>, <b>7</b>: 376-384,
<a href="https://doi.org/10.1002/sam.11235">doi:10.1002/sam.11235</a>.
</p>
<p>Obenchain RL. NU.Learning-vignette. (2023) <b>NU.Learning_in_R.pdf</b>
http://localcontrolstatistics.org 
</p>
<p>Rosenbaum PR, Rubin RB. (1983) The Central Role of the Propensity Score
in Observational Studies for Causal Effects. <em>Biometrika</em> <b>70</b>:
41-55.
</p>
<p>Rosenbaum PR, Rubin RB. (1984) Reducing Bias in Observational Studies Using
Subclassification on a Propensity Score. <em>JASA</em> <b>79</b>: 516-524.
</p>
<p>Rubin DB. (1980) Bias reduction using Mahalanobis metric matching.
<em>Biometrics</em> <b>36</b>: 293-298.
</p>
<p>Stuart EA. (2010) Matching Methods for Causal Inference: A Review and a Look Forward.
<em>Statistical Science</em> <b>25</b>: 1-21.
</p>

<hr>
<h2 id='NUcluster'>Hierarchical Clustering of experimental units (such as patients) in X-covariate Space</h2><span id='topic+NUcluster'></span>

<h3>Description</h3>

<p>Form the full, hierarchical clustering tree (dendrogram) for all units (regardless
of Treatment/Exposure status) using Mahalonobis distances computed from specified baseline
X-covariate characteristics.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  NUcluster(dframe, xvars, method="ward.D")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NUcluster_+3A_dframe">dframe</code></td>
<td>
<p>Name of data.frame containing baseline X covariates.</p>
</td></tr>
<tr><td><code id="NUcluster_+3A_xvars">xvars</code></td>
<td>
<p>List of names of X variable(s).</p>
</td></tr>
<tr><td><code id="NUcluster_+3A_method">method</code></td>
<td>
<p>Hierarchical Clustering Method of &quot;diana&quot;, &quot;ward.D&quot;, &quot;ward.D2&quot;, &quot;complete&quot;,
&quot;average&quot;, &quot;mcquitty&quot;, &quot;median&quot; or &quot;centroid&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first step in applying NU.Learning to data is to hierarchically cluster
experimental units in baseline X-covariate space ...thereby creating &quot;Blocks&quot; of relatively
well-matched units.  NUcluster first calls stats::prcomp() to calculate Mahalanobis distances
using standardized and orthogonal Principal Coordinates. NUcluster then uses either the
divisive cluster::diana() method or one of seven agglomerative methods from stats::hclust()
to compute a dendrogram tree. The hclust function is based on Fortran code contributed to
STATLIB by F. Murtagh.
</p>


<h3>Value</h3>

<p> An output list object of class NUcluster, derived from cluster::diana or stats::hclust.
</p>
<table>
<tr><td><code>dframe</code></td>
<td>
<p>Name of data.frame containing all baseline X-covariates.</p>
</td></tr>
<tr><td><code>xvars</code></td>
<td>
<p>List of 1 or more X-variable names.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Hierarchical Clustering Method: &quot;diana&quot;, &quot;ward.D&quot;, &quot;ward.D2&quot;, &quot;complete&quot;,
&quot;average&quot;, &quot;mcquitty&quot;, &quot;median&quot; or &quot;centroid&quot;.</p>
</td></tr>
<tr><td><code>hclobj</code></td>
<td>
<p>Hierarchical clustering object created by the designated method.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Kaufman L, Rousseeuw PJ.  (1990) <b>Finding Groups in Data.  An Introduction to
Cluster Analysis</b>.  New York: John Wiley and Sons.
</p>
<p>Kereiakes DJ, Obenchain RL, Barber BL, et al. (2000) Abciximab provides
cost effective survival advantage in high volume interventional practice.
<em>Am Heart J</em> <b>140</b>: 603-610.
</p>
<p>Murtagh F. (1985) Multidimensional Clustering Algorithms. <b>COMPSTAT Lectures</b> 4.
</p>
<p>Obenchain RL. (2010) Local Control Approach using JMP. Chapter 7 of
<b>Analysis of Observational Health Care Data using SAS</b>, <em>Cary, NC:SAS Press</em>,
pages 151-192.
</p>
<p>Rubin DB. (1980) Bias reduction using Mahalanobis metric matching.
<em>Biometrics</em> <b>36</b>: 293-298.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NUsetup">NUsetup</a></code>, <code><a href="#topic+ltdagg">ltdagg</a></code> and <code><a href="#topic+lrcagg">lrcagg</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(radon)
xvars  = c("obesity", "over65", "cursmoke")
hclobj = NUcluster(radon, xvars)  # ...using default method = "ward.D"
plot(hclobj)  
</code></pre>

<hr>
<h2 id='NUcompare'>Display NU Sensitivity Graphic for help in choice of K = Number of Clusters</h2><span id='topic+NUcompare'></span>

<h3>Description</h3>

<p>This function displays Box-Whisker diagrams that compare Treatment Effect-Size
distributions for different values of K = Number of Clusters requested in X-covariate space.
After an initial call to NUsetup(), the analyst typically makes multiple calls to either
ltdagg() or lrcagg() for different values of K.  The analyst then invokes NUcompare() to
see how choice of K changes the location, spread and/or skewness of the distribution of
Treatment Effect-Size estimates across Clusters. Variance-Bias trade-offs occur as K
increases; large values of K may reduce Bias, but they definitely inflate the Variance of
LTD and LRC distributions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  NUcompare(envir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NUcompare_+3A_envir">envir</code></td>
<td>
<p>R environment output by an earlier call to NUsetup().</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The third phase of NU.Learning is called EXPLORE and uses graphical
Sensitivity Analyses to show how Treatment Effect-Size distributions change with choice
of NU parameter settings. Choice of K = Number of Clusters requested is guided, primarily,
by NUcompare() graphics. Equally important are the analyst's choices of (i) which [and how
many] of the available baseline X-covariates to &quot;adjust for&quot; and (ii) which clustering
algorithm and dissimilarity metric to use. Unfortunately, changing these latter choices
requires the analyst to essentially &quot;start over&quot; ...i.e. invoking NUcluster() with changed
arguments, followed by an invocation of NUsetup() with a different 1st argument. To change
only one's choice of y-Outcome variable and/or the Treatment/Exposure variable, a new
NUsetup() invocation is all that is needed.
</p>


<h3>Value</h3>

<p> NULL </p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (2010) Local Control Approach using JMP. Chapter 7 of
<b>Analysis of Observational Health Care Data using SAS</b>, <em>Cary, NC:SAS Press</em>,
pages 151-192.
</p>
<p>Obenchain RL. (2015) <b>NU_Confirm_Guidelines.pdf</b> http://localcontrolstatistics.org 
</p>
<p>Obenchain RL. (2023) <b>NU.Learning_in_R.pdf</b> http://localcontrolstatistics.org 
</p>
<p>Rubin DB. (1980) Bias reduction using Mahalanobis metric matching.
<em>Biometrics</em> <b>36</b>: 293-298.
</p>
<p>Tukey JW. (1977) <b>Exploratory Data Analysis</b>, <em>New York: Addison-Wesley</em>, Section 2C.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ltdagg">ltdagg</a></code>, <code><a href="#topic+ivadj">ivadj</a></code> and <code><a href="#topic+lrcagg">lrcagg</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  # Running takes more than 7 seconds...
  data(pci15k)
  xvars   = c("stent", "height", "female", "diabetic", "acutemi", "ejfract", "ves1proc")
  hclobj  = NUcluster(pci15k, xvars)
  NU.env  = NUsetup(hclobj, pci15k, thin, surv6mo)
  surv050 = ltdagg( 50, NU.env)
  surv100 = ltdagg(100, NU.env)
  surv200 = ltdagg(200, NU.env)
  NUcompare(NU.env)
  
</code></pre>

<hr>
<h2 id='NUsetup'>Specify KEY parameters used in NU.Learning to &quot;design&quot; analyses of Observational Data.
</h2><span id='topic+NUsetup'></span>

<h3>Description</h3>

<p>Invoke NUsetup() to specify the name of the Hierarchical Clustering object
output by NUcluster() and the name of the data.frame containing all desired X-covariates, the
Treatment/Exposure variable and the Y-Outcome variable. It is ESSENTIAL to save the Environment
output by NUsetup() as a named object within the user's .GlobalEnv space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NUsetup(hclobj, dframe, trex, yvar)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NUsetup_+3A_hclobj">hclobj</code></td>
<td>
<p>Name of a NUcluster() output object created using a cluster::diana or
stats::hclust method.</p>
</td></tr>
<tr><td><code id="NUsetup_+3A_dframe">dframe</code></td>
<td>
<p>Name of the data.frame containing all X-covariates, the Treatment/Exposure
variable and the Y-Outcome variable.</p>
</td></tr>
<tr><td><code id="NUsetup_+3A_trex">trex</code></td>
<td>
<p>Name of the numerical Treatment/Exposure variable.</p>
</td></tr>
<tr><td><code id="NUsetup_+3A_yvar">yvar</code></td>
<td>
<p>Name of the numerical Y-Outcome variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The environment output by NUsetup() must be saved to the user's .GlobalEnv space. It's
contents will be automatically updated by calls to other NU.Learning functions:
</p>
<table>
<tr><td><code>aggdf</code></td>
<td>
<p>data.frame with 4 columns and 1 row for each call to ltdagg() or lrcagg().</p>
</td></tr>
<tr><td><code>aggdf$Label</code></td>
<td>
<p>Factor value of &quot;LTD&quot; or &quot;LRC&quot;.</p>
</td></tr>
<tr><td><code>aggdf$Blocks</code></td>
<td>
<p>K = integer Number of Clusters requested.</p>
</td></tr>
<tr><td><code>aggdf$LTDmean or aggdf$LRCmean</code></td>
<td>
<p>numerical value of cluster mean of LTD or LRC estimates.</p>
</td></tr>
<tr><td><code>aggdf$LTDstde or aggdf$LRCstde</code></td>
<td>
<p>numerical value of the within-cluster standard deviation.</p>
</td></tr> 
<tr><td><code>boxdf</code></td>
<td>
<p>data.frame of 2 variables ...for input to boxplot() by NUcompare().</p>
</td></tr>
<tr><td><code>boxdf$NUstat</code></td>
<td>
<p>LTD or LRC estimate for a single experimental unit from ltdagg() or lrcagg().</p>
</td></tr>
<tr><td><code>boxdf$K</code></td>
<td>
<p>Number of Cluters used in forming the LTD or LRC estimate for each Experimental Unit.</p>
</td></tr>
<tr><td><code>Kmax</code></td>
<td>
<p>Maximum Number of Clusters so that Average Size will be &gt;= 12 experimental units.</p>
</td></tr>
<tr><td><code>LTDmax or LRCmax</code></td>
<td>
<p>Maximum Treatment Effect-Size estimate across Clusters.</p>
</td></tr>  
<tr><td><code>LTDmin or LRCmin</code></td>
<td>
<p>Minimum Treatment Effect-Size estimate across Clusters.</p>
</td></tr>
<tr><td><code>NumLevels</code></td>
<td>
<p>Integer number of distinct Levels of the Treatment/Exposure variable: trex.</p>
</td></tr>
<tr><td><code>pars</code></td>
<td>
<p>Character data.frame with 4 columns and 1 row.</p>
</td></tr>   
<tr><td><code>pars[1</code>, <code>1]</code></td>
<td>
<p>Name of the diana or hclust object created by NUcluster().</p>
</td></tr>  
<tr><td><code>pars[1</code>, <code>2]</code></td>
<td>
<p>Name of data.frame containing the X, Treatment/Exposure and Y variables.</p>
</td></tr>
<tr><td><code>pars[1</code>, <code>3]</code></td>
<td>
<p>Name of Treatment/Exposure variable within data.frame pars[1,2].</p>
</td></tr>
<tr><td><code>pars[1</code>, <code>4]</code></td>
<td>
<p>Name of Y-outcome variable within data.frame pars[1,2].</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (2010) Local Control Approach using JMP. Chapter 7 of
<b>Analysis of Observational Health Care Data using SAS</b>, <em>Cary, NC:SAS Press</em>,
pages 151-192. 
</p>
<p>Obenchain RL. (2023) <b>NU.Learning_in_R.pdf</b> http://localcontrolstatistics.org 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ltdagg">ltdagg</a></code>, <code><a href="#topic+ivadj">ivadj</a></code> and <code><a href="#topic+lrcagg">lrcagg</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  # Running takes about 7 seconds...
  data(pci15k)
  xvars  = c("stent", "height", "female", "diabetic", "acutemi", "ejfract", "ves1proc")
  hclobj = NUcluster(pci15k, xvars)
  NUe    = NUsetup(hclobj, pci15k, thin, surv6mo)
  ls.str(NUe)
  
</code></pre>

<hr>
<h2 id='pci15k'>Six-month Survival, Cardiac cost and Baseline Covariate data for 15,487 PCI patients.</h2><span id='topic+pci15k'></span>

<h3>Description</h3>

<p>Using observational data on 996 patients who received a Percutaneous Coronary
Intervention (PCI) at Ohio Heart Health, Lindner Center, Christ Hospital, Cincinnati
(Kereiakes et al, 2000), we generated this much larger dataset via &quot;plasmode simulation.&quot;</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pci15k)</code></pre>


<h3>Format</h3>

<p>A data frame of 11 variables on 15,487 patients; no NAs.
</p>

<dl>
<dt>patid</dt><dd><p>Patient ID number: 1 to 15487.</p>
</dd>
<dt>surv6mo</dt><dd><p>Binary PCI Survival variable: 1 =&gt; Survival for at least 6 months following
PCI, 0 =&gt; Survival for less than 6 months.</p>
</dd>
<dt>cardcost</dt><dd><p>Cardiac related costs incurred within 6 months of patient's initial PCI;
numeric value in 1998 dollars; costs were truncated by death for the 404 patients with
surv6mo == 0.</p>
</dd>
<dt>thin</dt><dd><p>Numeric treatment selection indicator: thin = 0 implies usual PCI care alone;
thin = 1 implies usual PCI care augmented by either planned or rescue treatment with a
new blood thinning agent.</p>
</dd>
<dt>stent</dt><dd><p>Coronary stent deployment; numeric, with 1 meaning YES and 0 meaning NO.</p>
</dd>
<dt>height</dt><dd><p>Height in centimeters; numeric integer from 133 to 198.</p>
</dd>
<dt>female</dt><dd><p>Female gender; numeric, with 1 meaning YES and 0 meaning NO.</p>
</dd>
<dt>diabetic</dt><dd><p>Diabetes mellitus diagnosis; numeric, with 1 meaning YES and 0 meaning NO.</p>
</dd>
<dt>acutemi</dt><dd><p>Acute myocardial infarction within the previous 7 days; numeric, with 1
meaning YES and 0 meaning NO.</p>
</dd>
<dt>ejfract</dt><dd><p>Left ejection fraction; numeric value from 17 percent to 77 percent.</p>
</dd>
<dt>ves1proc</dt><dd><p>Number of vessels involved in the patient's initial PCI procedure; numeric
integer from 0 to 5.</p>
</dd>
</dl>



<h3>References</h3>

<p>Kereiakes DJ, Obenchain RL, Barber BL, et al.  Abciximab provides cost effective survival
advantage in high volume interventional practice. <em>Am Heart J</em> 2000; <b>140</b>: 603-610.
</p>
<p>Gadbury GL, Xiang Q, Yang L, Barnes S, Page GP, Allison DB. Evaluating Statistical Methods Using
Plasmode Data Sets in the Age of Massive Public Databases: An Illustration Using False Discovery
Rates. <em>PLOS Genetics</em> 2008; <b>4</b>: 1-8, e1000098 (Open Access). 
</p>
<p>Obenchain RL. (2023) <b>NU.Learning_in_R.pdf</b> http://localcontrolstatistics.org 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    data(pci15k)
    str(pci15k)
</code></pre>

<hr>
<h2 id='plot.ivadj'>Display an Instrumental Variable (LAO) plot with Linear and smooth.spline Fits</h2><span id='topic+plot.ivadj'></span>

<h3>Description</h3>

<p>For a given number of patient clusters, K, in baseline X-covariate space and a
specified Y-outcome variable, display the distribution of Local Average Outcomes (LAOs)
plotted versus Within-Cluster Propensity-like Scores: Treatment Selection Fractions
or Relative Exposure Levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'ivadj'
plot(x, maxsiz = 0.15, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ivadj_+3A_x">x</code></td>
<td>
<p>An object output by ivadj() for K given Clusters in baseline X-covariate space.</p>
</td></tr>
<tr><td><code id="plot.ivadj_+3A_maxsiz">maxsiz</code></td>
<td>
<p>Radius of the Circle plotting symbol for the largest Cluster. Usually &lt; 0.6</p>
</td></tr>
<tr><td><code id="plot.ivadj_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to plot().</p>
</td></tr>
</table>


<h3>Value</h3>

<p> NULL </p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.ltdagg">plot.ltdagg</a></code>, <code><a href="#topic+plot.lrcagg">plot.lrcagg</a></code></p>

<hr>
<h2 id='plot.lrcagg'>Display Visualizations of an Observed LRC Distribution in NU.Learning</h2><span id='topic+plot.lrcagg'></span>

<h3>Description</h3>

<p>Display a Histogram, Box-Whisker Diagram and/or empirical Cumulative Distribution
Function depicting the Observed Local Rank Correlation (LRC) Distribution across K Clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'lrcagg'
plot(x, envir, show="all", breaks="Sturges", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.lrcagg_+3A_x">x</code></td>
<td>
<p>An object output by lrcagg() for K = Number of Clusters in baseline X-covariate space.</p>
</td></tr>
<tr><td><code id="plot.lrcagg_+3A_envir">envir</code></td>
<td>
<p>R environment output by a previous call to NUsetup().</p>
</td></tr>
<tr><td><code id="plot.lrcagg_+3A_show">show</code></td>
<td>
<p>Choice of &quot;all&quot;, &quot;seq&quot;, &quot;hist&quot;, &quot;boxp&quot;, or &quot;ecdf&quot;.</p>
</td></tr>
<tr><td><code id="plot.lrcagg_+3A_breaks">breaks</code></td>
<td>
<p>Parameter setting for hist(); May be an integer value ...like 25 or 50.</p>
</td></tr>
<tr><td><code id="plot.lrcagg_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to plot().</p>
</td></tr>
</table>


<h3>Value</h3>

<p> NULL </p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.ltdagg">plot.ltdagg</a></code></p>

<hr>
<h2 id='plot.ltdagg'>Display Visualizations of an Observed LTD Distribution in NU.Learning</h2><span id='topic+plot.ltdagg'></span>

<h3>Description</h3>

<p>Display a Histogram, Box-Whisker Diagram and/or empirical Cumulative Distribution
Function depicting the Observed Local Treatment Difference (LTD) Distribution across K Clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'ltdagg'
plot(x, envir, show="all", breaks="Sturges", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ltdagg_+3A_x">x</code></td>
<td>
<p>An object output by ltdagg() for K = Number of Clusters in baseline X-covariate space.</p>
</td></tr>
<tr><td><code id="plot.ltdagg_+3A_envir">envir</code></td>
<td>
<p>R environment output by a previous call to NUsetup().</p>
</td></tr>
<tr><td><code id="plot.ltdagg_+3A_show">show</code></td>
<td>
<p>Choice of &quot;all&quot;, &quot;seq&quot;, &quot;hist&quot;, &quot;boxp&quot;, or &quot;ecdf&quot;.</p>
</td></tr>
<tr><td><code id="plot.ltdagg_+3A_breaks">breaks</code></td>
<td>
<p>Parameter setting for hist(); May be an integer value ...like 25 or 50.</p>
</td></tr>
<tr><td><code id="plot.ltdagg_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to plot().</p>
</td></tr>
</table>


<h3>Value</h3>

<p> NULL </p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.lrcagg">plot.lrcagg</a></code></p>

<hr>
<h2 id='plot.mlme'>Display a Pair (or Pairs) of Histograms showing LOCAL effect-sizes for Patients &quot;Most-Like-Me&quot;.</h2><span id='topic+plot.mlme'></span>

<h3>Description</h3>

<p>Display Pair(s) of Histograms of Local effect-size (LTD or LRC) Distributions for a specified
Number (or combinations of Numbers) of &quot;Nearest-Neighbors in X-confounder Space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'mlme'
plot(x, NN=50, breaks=50, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mlme_+3A_x">x</code></td>
<td>
<p>An object output by mlme().</p>
</td></tr>
<tr><td><code id="plot.mlme_+3A_nn">NN</code></td>
<td>
<p>Number(s) of Nearest Neighbors displayed in Bottom Histogram(s). NN can be
a single integer like NN = 40 or a combination of integers like NN = c( 50, 250,
2500 ).</p>
</td></tr>
<tr><td><code id="plot.mlme_+3A_breaks">breaks</code></td>
<td>
<p>Integer number of breaks in the Top Histogram for the full LTD or LRC distribution.
Because the Bottom Histogram may include only a few Nearest Neighbors, it is always displayed
using breaks = &quot;Sturges&quot;.</p>
</td></tr>
<tr><td><code id="plot.mlme_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to plot().</p>
</td></tr>
</table>


<h3>Value</h3>

<p> NULL </p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlme.stats">mlme.stats</a></code>,<code><a href="#topic+print.mlme">print.mlme</a></code>,<code><a href="#topic+mlme">mlme</a></code></p>

<hr>
<h2 id='pmdata'>Particulate Matter, Mortality and Other data for 2980 US Counties</h2><span id='topic+pmdata'></span>

<h3>Description</h3>

<p>This data.frame combines 122 variables from the 5 sources referenced below. Several PM
variables appear to be predictions from EPA &ldquo;CMAQ&rdquo; models rather than values from validated
measuring instruments. NU.Learning concepts are illustrated in demo(pmdata) using Clustering of 2973
Counties and Parishes within the contiguous 48 US States and Washington, D.C.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pmdata)</code></pre>


<h3>Format</h3>

<p>This data.frame contains 122 variables for 2,980 US counties. A total of 738 &quot;NA&quot;s imply that only about
two tenths of one percent of these 363,560 values are missing.	  
</p>

<dl>
<dt>fips</dt><dd><p>Federal Information Processing Standard code; 4 or 5 digits; 2980 unique values</p>
</dd>
<dt>C50</dt><dd><p>Cluster ID Number between 1 and 50. Total of 50 unique values</p>
</dd>
<dt>LRC50</dt><dd><p>Local (Spearman) Rank Correlation between Bvoc and AACRmort within Cluster</p>
</dd>
<dt>County</dt><dd><p>County or Parish name is a Factor variable (character code)</p>
</dd>
<dt>State</dt><dd><p>State name is a 2-Character Factor code; 49 unique levels</p>
</dd>
<dt>Deaths</dt><dd><p>CDC: Total number of Deaths in the County in 2016</p>
</dd>
<dt>Population</dt><dd><p>CDC: Total population of County in 2016</p>
</dd>
<dt>CRmort</dt><dd><p>CDC: Crude Rate of Circulatory-Respiratory Mortality for the County in 2016</p>
</dd>
<dt>CrudeL95</dt><dd><p>CDC: Lower 95% confidence limit for Crude Rate of CR Mortality</p>
</dd>
<dt>CrudeU95</dt><dd><p>CDC: Upper 95% confidence limit for Crude Rate of CR Mortality</p>
</dd>
<dt>CrudeSE</dt><dd><p>CDC: Standard Error for Crude Rate of CR Mortality</p>
</dd>
<dt>AACRmort</dt><dd><p>CDC: Age Adjusted Rate of Circulatory-Respiratory Mortality in 2016</p>
</dd>
<dt>AACRL95</dt><dd><p>CDC: Lower 95% confidence limit for Age Adjusted Rate of CR Mortality</p>
</dd>
<dt>AACRU95</dt><dd><p>CDC: Upper 95% confidence limit for Age Adjusted Rate of CR Mortality</p>
</dd>
<dt>AACR_SE</dt><dd><p>CDC: Standard Error for Age Adjusted Rate of CR Mortality</p>
</dd>
<dt>TotDeathPct</dt><dd><p>CDC: Total Death Percentage - Circulatory-Respiratory Mortality in 2016</p>
</dd>
<dt>lat</dt><dd><p>EPA: County Latitude used in EPA &quot;CMAQ&quot; model calculations</p>
</dd>
<dt>long</dt><dd><p>EPA: County Longitude used in EPA &quot;CMAQ&quot; model calculations</p>
</dd>
<dt>RHpct</dt><dd><p>EPA: Relative Humidity Percentage for 2016</p>
</dd>
<dt>SFCtmpC</dt><dd><p>EPA: Surface Temperature in Degrees Centigrade for 2016</p>
</dd>
<dt>NO2</dt><dd><p>EPA: Nitrogen Dioxide level (NO2.ppbV) for 2016</p>
</dd>
<dt>O3</dt><dd><p>EPA: Ozone level (O3.ppbV) for 2016</p>
</dd>   
<dt>pmCL</dt><dd><p>EPA: Chlorine level in Particulate Matter (PM25_CL.ugm3) for 2016</p>
</dd>
<dt>pmEC</dt><dd><p>EPA: Ethylene Carbonate level in Particulate Matter (PM25_EC.ugm3) for 2016</p>
</dd>
<dt>pmNA</dt><dd><p>EPA: Sodium level in Particulate Matter (PM25_NA.ugm3) for 2016</p>
</dd>
<dt>pmMG</dt><dd><p>EPA: Magnesium level in Particulate Matter (PM25_MG.ugm3) for 2016</p>
</dd>
<dt>pmK</dt><dd><p>EPA: Potassium level in Particulate Matter (PM25_K.ugm3) for 2016</p>
</dd>
<dt>pmCA</dt><dd><p>EPA: Calcium level in Particulate Matter (PM25_CA.ugm3) for 2016</p>
</dd>
<dt>pmNH4</dt><dd><p>EPA: Ammonium level in Particulate Matter (PM25_NH4.ugm3) for 2016</p>
</dd>
<dt>pmNO3</dt><dd><p>EPA: Nitrate level in Particulate Matter (PM25_NO3.ugm3) for 2016</p>
</dd>
<dt>pmOC</dt><dd><p>EPA: Organic Compounds in pmTOT [fine particulate matter] (PM25_OC.ugm3) for 2016</p>
</dd>
<dt>pmOM</dt><dd><p>EPA: OM compounds in pmTOT (PM25_OM.ugm3) for 2016</p>
</dd>
<dt>pmOTHR</dt><dd><p>EPA: Other Compounds in pmTOT (PM25_OTHR.ugm3) for 2016</p>
</dd>
<dt>pmSO4</dt><dd><p>EPA: Sulfate Compounds in pmTOT (PM25_SO4.ugm3) for 2016</p>
</dd>
<dt>pmFE</dt><dd><p>EPA: Ferrous Compounds in pmTOT (PM25_FE.ugm3) for 2016</p>
</dd>
<dt>pmSI</dt><dd><p>EPA: Silicon Compounds in pmTOT (PM25_SI.ugm3) for 2016</p>
</dd>
<dt>pmTI</dt><dd><p>EPA: Titanium Compounds in pmTOT (PM25_TI.ugm3) for 2016</p>
</dd>
<dt>pmMN</dt><dd><p>EPA: Manganese Compounds in pmTOT (PM25_MN.ugm3) for 2016</p>
</dd>
<dt>pmAL</dt><dd><p>EPA: Aluminum Compounds in pmTOT (PM25_AL.ugm3) for 2016</p>
</dd>
<dt>pmUNSPCRS</dt><dd><p>EPA: UNSPCRS Compounds in pmTOT (PM25_UNSPCRS.ugm3) for 2016</p>
</dd>
<dt>pmPOA</dt><dd><p>EPA: Primary Organic Aerosols in pmTOT (PM25_POA.ugm3) for 2016</p>
</dd>
<dt>pmSOA</dt><dd><p>EPA: Secondary Organic Aerosols in pmTOT (PM25_SOA.ugm3) for 2016; pmSOA = Avoc+Bvoc</p>
</dd>
<dt>pmGLY</dt><dd><p>EPA: Glycemic Secondary Organic Aerosols in pmTOT (PM25_GLYSOA.ugm3) for 2016</p>
</dd>
<dt>pmOLGB</dt><dd><p>EPA: OLGB compounds in pmTOT (PM25_OLGB.ugm3) for 2016</p>
</dd>
<dt>pmISOP</dt><dd><p>EPA: ISOP compounds in pmTOT (PM25_ISOP.ugm3) for 2016</p>
</dd>
<dt>pmEPOX</dt><dd><p>EPA: EPOX compounds in pmTOT (PM25_EPOX.ugm3) for 2016</p>
</dd>
<dt>pmSQT</dt><dd><p>EPA: SQT compounds in pmTOT (PM25_SQT.ugm3) for 2016</p>
</dd>
<dt>pmMTN</dt><dd><p>EPA: MTN compounds in pmTOT (PM25_MTN.ugm3) for 2016</p>
</dd>
<dt>pmMT</dt><dd><p>EPA: MT compounds in pmTOT (PM25_MT.ugm3) for 2016</p>
</dd>
<dt>pmTOT</dt><dd><p>EPA: Total (fine) Particulate Matter (PM25_TOT.ugm3) for 2016</p>
</dd>
<dt>SFCtmpK</dt><dd><p>EPA: Surface Temperature in Degrees Kelvin for 2016</p>
</dd>
<dt>CardioRes</dt><dd><p>CDC: Cardio Respiratory Rate (rate I00J98.per100000.cdc) for 2016</p>
</dd>
<dt>POPcdc</dt><dd><p>CDC: County Population (population.cdc) for 2016</p>
</dd>
<dt>POP5yracs</dt><dd><p>CDC: 5yracs Population (population.people.5yracs) for 2016</p>
</dd>  
<dt>PREMdeath</dt><dd><p>Premature Deaths per 100K Residents ...UWPHI for 2018</p>
</dd>
<dt>POFHealth</dt><dd><p>Poor or Fair Health rate (Poor.or.fair.health) ...UWPHI for 2018</p>
</dd>
<dt>PPHdays</dt><dd><p>Poor Physical Health days (Poor.physical.health.days) ...UWPHI for 2018</p>
</dd> 		
<dt>PMHdays</dt><dd><p>Poor Mental Health days (Poor.mental.health.days) ...UWPHI for 2018</p>
</dd> 		   		
<dt>LBW</dt><dd><p>Low Birth Weight rate (Low.birthweight) ...UWPHI for 2018</p>
</dd> 	
<dt>ASmoke</dt><dd><p>Adult Smoking Percentage (Adult.smoking) ...UWPHI for 2018</p>
</dd> 	    			
<dt>AObes</dt><dd><p>Adult Obesity Percentage (Adult.obesity) ...UWPHI for 2018</p>
</dd> 	      			
<dt>FEnv</dt><dd><p>Food Environment Index (Food.environment.index) ...UWPHI for 2018</p>
</dd> 
<dt>PhysInAct</dt><dd><p>Physical Inactivity (Physical.inactivity) ...UWPHI for 2018</p>
</dd> 
<dt>ExercOPS</dt><dd><p>Access to Exercise Opportunities ...UWPHI for 2018</p>
</dd> 
<dt>ExsDrink</dt><dd><p>Excessive Drinking Rate (Excessive.drinking) ...UWPHI for 2018</p>
</dd> 
<dt>AIDrivD</dt><dd><p>Alcohol Impaired Driving Deaths ...UWPHI for 2018</p>
</dd> 
<dt>STInfect</dt><dd><p>Sexually Transmitted Infections ...UWPHI for 2018</p>
</dd> 
<dt>TBirths</dt><dd><p>Teenage Births (Teen.births) ...UWPHI for 2018</p>
</dd> 
<dt>Uninsur</dt><dd><p>Uninsured Residences (Uninsured) ...UWPHI for 2018</p>
</dd>
<dt>PCDocs</dt><dd><p>Primary Care Physicians (Primary.care.physicians) ...UWPHI for 2018</p>
</dd>
<dt>Dentists</dt><dd><p>Dentists (Dentists) ...UWPHI for 2018</p>
</dd>
<dt>PrevntHS</dt><dd><p>Preventable Hospital Stays (Preventable.hospital.stays) ...UWPHI for 2018</p>
</dd>
<dt>DiabMNT</dt><dd><p>Diabetes Monitoring (Diabetes.monitoring) ...UWPHI for 2018</p>
</dd>
<dt>MammoSC</dt><dd><p>Mammography Screening (Mammography.screening) ...UWPHI for 2018</p>
</dd>
<dt>SomCOL</dt><dd><p>Some College Education (Some.college) ...UWPHI for 2018</p>
</dd>   		
<dt>UnEMP</dt><dd><p>Unemployment Rate (Unemployment) ...UWPHI for 2018</p>
</dd>    		
<dt>ChildPOV</dt><dd><p>Children Living in Poverty (Children.in.poverty) ...UWPHI for 2018</p>
</dd> 
<dt>IncomIEQ</dt><dd><p>Income Inequality (Income.inequality) ...UWPHI for 2018</p>
</dd> 
<dt>ChildSPH</dt><dd><p>Children In Single-Parent Households ...UWPHI for 2018</p>
</dd> 
<dt>SocASOC</dt><dd><p>Social Associations (Social.associations) ...UWPHI for 2018</p>
</dd> 
<dt>VioCRM</dt><dd><p>Violent Crime Rate (Violent.crime) ...UWPHI for 2018</p>
</dd> 
<dt>InjyDths</dt><dd><p>Injury Death Rate (Injury.deaths) ...UWPHI for 2018</p>
</dd> 
<dt>AirPolpm</dt><dd><p>Air Pollution Particulate Matter ...UWPHI for 2018</p>
</dd> 
<dt>DrnkWtVi</dt><dd><p>Drinking Water Violations (Drinking.water.violations) ...UWPHI for 2018</p>
</dd> 
<dt>SevrHOUS</dt><dd><p>Severe Housing Problems (Severe.housing.problems) ...UWPHI for 2018</p>
</dd> 
<dt>DrivATW</dt><dd><p>Driving Alone to Work (Driving.alone.to.work) ...UWPHI for 2018</p>
</dd> 
<dt>LComutA</dt><dd><p>Long Commute - Driving Alone to Work ...UWPHI for 2018</p>
</dd> 
<dt>PAAM</dt><dd><p>Premature Age Adjusted Mortality ...UWPHI for 2018</p>
</dd> 
<dt>FrqPhysD</dt><dd><p>Frequent Physical Distress ...UWPHI for 2018</p>
</dd> 
<dt>FrqMentD</dt><dd><p>Frequent Mental Distress ...UWPHI for 2018</p>
</dd> 
<dt>DiabPrev</dt><dd><p>Diabetes Prevalence (Diabetes.prevalence) ...UWPHI for 2018</p>
</dd>         
<dt>FoodInSec</dt><dd><p>Food Insecurity (Food.insecurity) ...UWPHI for 2018</p>
</dd>    
<dt>LimAHFood</dt><dd><p>Limited Access to Healthy Foods ...UWPHI for 2018</p>
</dd>  
<dt>DrugOdDM</dt><dd><p>Drug Overdose Deaths Model predictions ...UWPHI for 2018</p>
</dd>  
<dt>InsufSlp</dt><dd><p>Insufficient Sleep (Insufficient.sleep) ...UWPHI for 2018</p>
</dd> 
<dt>UnInsAds</dt><dd><p>Uninsured Adults (Uninsured.adults) ...UWPHI for 2018</p>
</dd> 
<dt>UnInsCls</dt><dd><p>Uninsured Children (Uninsured.children) ...UWPHI for 2018</p>
</dd> 
<dt>HCareCost</dt><dd><p>Health Care Costs (Health.care.costs) ...UWPHI for 2018</p>
</dd> 
<dt>OthPrimCP</dt><dd><p>Other Primary Care Providers ...UWPHI for 2018</p>
</dd> 
<dt>MHHIncome</dt><dd><p>Median Household Income ...UWPHI for 2018</p>
</dd> 
<dt>ChildFRPL</dt><dd><p>Children Eligible for Free or Reduced-Price Lunch ...UWPHI for 2018</p>
</dd> 
<dt>Population</dt><dd><p>County Population (Population) ...UWPHI for 2018</p>
</dd> 
<dt>AGELess18</dt><dd><p>Residents below 18 Years of Age ...UWPHI for 2018</p>
</dd> 
<dt>A65oOVR</dt><dd><p>Residents 65 or Older (X..65.and.older) ...UWPHI for 2018</p>
</dd> 
<dt>NHispAfA</dt><dd><p>Non-Hispanic African-American Residents ...UWPHI for 2018</p>
</dd>
<dt>AmINalsN</dt><dd><p>American Indian or Alaskan Natives ...UWPHI for 2018</p>
</dd>
<dt>Asian</dt><dd><p>Asian Residents (X..Asian) ...UWPHI for 2018</p>
</dd>
<dt>NHawOPI</dt><dd><p>Native Hawaiian and Other Pacific Islanders ...UWPHI for 2018</p>
</dd>
<dt>Hispanic</dt><dd><p>Hispanic Residents (X..Hispanic) ...UWPHI for 2018</p>
</dd>
<dt>NHispWht</dt><dd><p>Non-Hispanic White Residents ...UWPHI for 2018</p>
</dd>
<dt>LoProEngl</dt><dd><p>Low Proficiency in English (not.proficient.in.English) ...UWPHI for 2018</p>
</dd>
<dt>Females</dt><dd><p>Female Residents ...UWPHI for 2018</p>
</dd>
<dt>Rural</dt><dd><p>Rural Residents ...UWPHI for 2018</p>
</dd>           
<dt>pmOA</dt><dd><p>EPA: Organic Aerosols in pmTOT (PM25_OA.ugm3) for 2016</p>
</dd>  
<dt>Avoc</dt><dd><p>EPA: Anthroprogenic [man-made] Volatile Organic Compounds in pmTOT for 2016</p>
</dd>
<dt>pmSEAspry</dt><dd><p>EPA: Sea Spray components in pmTOT (PM25_SOAAVOC.ugm3) for 2016</p>
</dd>
<dt>pmDUST</dt><dd><p>EPA: Dust components in pmTOT (PM25_DUST.ugm3) for 2016</p>
</dd>
<dt>pmNH4NO3</dt><dd><p>EPA: Ammonium Nitrate components in pmTOT (PM25_NH4NO3.ugm3) for 2016</p>
</dd>
<dt>pmSOOT</dt><dd><p>EPA: Soot components in pmTOT (PM25_SOOT.ugm3) for 2016</p>
</dd>        
<dt>isop</dt><dd><p>EPA: SOA Isoprenes (PM25_SOAISOPRENE.ugm3) for 2016</p>
</dd>         
<dt>terp</dt><dd><p>EPA: SOA Terpenes (PM25_SOATERPENE.ugm3) for 2016</p>
</dd>            
<dt>Bvoc</dt><dd><p>EPA: Biogenic (natural) Volatile Organic Compounds for 2016; Bvoc = isop + terp</p>
</dd>
</dl>



<h3>References</h3>

<p>Obenchain RL. and Young SS. (2022), EPA Particulate Matter Data - Analyses using Local Control
Strategy. (24 pages, 22 figures) https://doi.org/10.48550/arXiv.2209.05461
</p>
<p>Pye, H., Ward-Caviness, C., Murphy, B., Appel, K., and Seltzer, K. (2021). Secondary organic
aerosol association with cardiorespiratory disease mortality in the united states. Nature
Communications, 12.7215  https://doi.org/10.1038/s41467-021-27484-1
</p>
<p>Pye, H. [EPA] (2021), Data For Secondary Organic Aerosol and Cardiorespiratory Disease
Mortality. https://doi.org/10.5281/zenodo.5713903 
</p>
<p>University of Wisconsin, Population Health Institute. https://uwphi.pophealth.wisc.edu
[UWPHI] UWPHI@med.wisc.edu
</p>
<p>Young SS. and Obenchain RL. (2022), &quot;EPA particulate matter data...Analyses
using Local Control Strategy&quot;  https://doi.org/10.5061/dryad.63xsj3v58 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    data(pmdata)
    str(pmdata, list.len=122)
</code></pre>

<hr>
<h2 id='print.mlme'>Print Summary Statistics on Local effect-size Estimates for Patients &quot;Most-Like-Me&quot;.</h2><span id='topic+print.mlme'></span>

<h3>Description</h3>

<p>Display &quot;Most-Like-Me&quot; Summary Statistics for LOCAL effect-size (LTD or LRC) Distributions
of &quot;Nearest-Neighbors&quot; in X-confounder Space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'mlme'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mlme_+3A_x">x</code></td>
<td>
<p>An object output by mlme().</p>
</td></tr>
<tr><td><code id="print.mlme_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to print().</p>
</td></tr>
</table>


<h3>Value</h3>

<p> NULL </p>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlme.stats">mlme.stats</a></code>,<code><a href="#topic+plot.mlme">plot.mlme</a></code>,<code><a href="#topic+mlme">mlme</a></code></p>

<hr>
<h2 id='radon'>Radon exposure and lung cancer mortality data for 2,881 US counties in 46 States.</h2><span id='topic+radon'></span>

<h3>Description</h3>

<p>Federal EPA and state government agencies have been reporting observational
data at the US County level since about 1980. The data given here include 5 potential
X-confounder variables of the relationship between lung cancer mortality and radon
exposure; they were amassed and checked by Goran Krstic, Fraser Health Authority,
Vancouver, BC, Canada.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(radon)</code></pre>


<h3>Format</h3>

<p>A data frame of 11 variables for 2881 US counties. One Missing Value; row 778 for
Shannon County, SD, fips == 46113, has hhincome == NA.	  
</p>

<dl>
<dt>fips</dt><dd><p>County FIPS code. Codes are 4 or 5 digit integers; 2881 unique values.</p>
</dd>
<dt>state</dt><dd><p>State Factor variable (2-character codes); 46 unique levels.</p>
</dd>
<dt>county</dt><dd><p>County or Parish Factor variable (character codes); 1703 unique levels.</p>
</dd>
<dt>lcanmort</dt><dd><p>Lung Cancer Mortality rate (deaths per 100,000 person-years), 1980-2004.</p>
</dd>
<dt>radon</dt><dd><p>County Radon Exposure level in picocuries per liter (pCi/L) for some
unspecified period within 1986-1992; rounded to nearest single decimal place.</p>
</dd>
<dt>lnradon</dt><dd><p>Natural logarithm of County Radon Exposure level. Radon levels reported as
0.0 for 10 US counties are Windsorized here to ln(0.05), which is roughly -3.</p>
</dd>
<dt>obesity</dt><dd><p>Percentage of County Residents considered Obese (age adjusted), 2008.</p>
</dd>
<dt>over65</dt><dd><p>Percentage of County Residents of Age 65 and over, 2000 Census.</p>
</dd>
<dt>cursmoke</dt><dd><p>Percentage of County Residents who Currently Smoke, 1997-2003.</p>
</dd>
<dt>evrsmoke</dt><dd><p>Percentage of County Residents who Ever Smoked, 1997-2003.</p>
</dd>
<dt>hhincome</dt><dd><p>Average Median HouseHold Income in Thousands ($1,000), 1989-2004.</p>
</dd>
</dl>



<h3>References</h3>

<p>Krstic G, Obenchain RL. (2016) Radon dataset documentation and downloads.
http://localcontrolstatistics.org 
</p>
<p>Obenchain RL. (2018) <b>RADON_short.pdf</b> http://localcontrolstatistics.org  40 PPT Slides and
Commentary in Notes Pages format.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    data(radon)
    str(radon)
</code></pre>

<hr>
<h2 id='reveal.data'>Create a data.frame for use in Prediction of a LTD/LRC effect-size Distribution</h2><span id='topic+reveal.data'></span>

<h3>Description</h3>

<p>reveal.data() forms a data.frame by sorting and appending the LTD or LRC exposure
effect-size measures from ltdagg() or lrcagg() &ndash; as well as a Cluster membership-number
variable &ndash; to a copy of the data.frame specified in NUsetup(). In the fourth and final REVEAL
Phase of NU.Learning, a stretch-goal is to predict variation in LTD/LRC effect-size
distributions using the known (baseline) X-covariate characteristics of experimental units. For
example, the data.frame output by reveal.data() is suitable for input to party::ctree() as well
as to a number of other &quot;less Visual&quot; prediction methods available in <b>R</b>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reveal.data(x, clus.var="Clus", effe.var="eSiz")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reveal.data_+3A_x">x</code></td>
<td>
<p>An output object resulting from a call to ltdagg() or lrcagg().</p>
</td></tr>
<tr><td><code id="reveal.data_+3A_clus.var">clus.var</code></td>
<td>
<p>Quoted NAME for the Cluster-Number variable.</p>
</td></tr>
<tr><td><code id="reveal.data_+3A_effe.var">effe.var</code></td>
<td>
<p>Quoted NAME for the LTD/LRC effect-size variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> The desired data.frame:
</p>
<table>
<tr><td><code>outdf</code></td>
<td>
<p>A data.frame containing clus.var, effe.var plus (X, trex &amp; Y) variables.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Bob Obenchain &lt;wizbob@att.net&gt;</p>


<h3>References</h3>

<p>Obenchain RL. (2023) <b>NU.Learning_in_R.pdf</b> http://localcontrolstatistics.org 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ltdagg">ltdagg</a></code>, <code><a href="#topic+lrcagg">lrcagg</a></code>, and <code><a href="#topic+NUsetup">NUsetup</a></code>.</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
