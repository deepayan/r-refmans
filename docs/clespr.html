<!DOCTYPE html><html lang="en"><head><title>Help for package clespr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {clespr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#func.cl.ord'><p>Composite Likelihood Calculation for Spatial Ordinal Data</p></a></li>
<li><a href='#func.cl.ord.repar'><p>Reparameterized Composite Likelihood Calculation for Spatial Ordinal Data</p></a></li>
<li><a href='#func.cl.prop'><p>Composite Likelihood Calculation for Spatial Proportional Data</p></a></li>
<li><a href='#func.cle.ord'><p>Composite Likelihood Estimation for Spatial Ordinal Data</p></a></li>
<li><a href='#func.cle.prop'><p>Composite Likelihood Estimation for Spatial Proportional Data</p></a></li>
<li><a href='#func.obs.ord'><p>Latent Response Transformation for Spatial Ordinal Data</p></a></li>
<li><a href='#func.obs.prop'><p>Latent Response Transformation for Proportional Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Composite Likelihood Estimation for Spatial Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ting Fung (Ralph) Ma &lt;tingfung.ma@wisc.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Composite likelihood approach is implemented to estimating statistical models for spatial ordinal and proportional data based on Feng et al. (2014) &lt;<a href="https://doi.org/10.1002%2Fenv.2306">doi:10.1002/env.2306</a>&gt;. Parameter estimates are identified by maximizing composite log-likelihood functions using the limited memory BFGS optimization algorithm with bounding constraints, while standard errors are obtained by estimating the Godambe information matrix.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>AER (&ge; 1.2-5), pbivnorm (&ge; 0.6.0), MASS (&ge; 7.3-45), magic
(&ge; 1.5-6), survival (&ge; 2.37-5), clordr (&ge; 1.0.2), doParallel
(&ge; 1.0.11), foreach (&ge; 1.2.0), utils, stats</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-02-23 04:23:42 UTC; Ralph</td>
</tr>
<tr>
<td>Author:</td>
<td>Ting Fung (Ralph) Ma [cre, aut],
  Wenbo Wu [aut],
  Jun Zhu [aut],
  Xiaoping Feng [aut],
  Daniel Walsh [ctb],
  Robin Russell [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-02-23 19:05:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='func.cl.ord'>Composite Likelihood Calculation for Spatial Ordinal Data</h2><span id='topic+func.cl.ord'></span>

<h3>Description</h3>

<p><code>func.cl.ord</code> calculates the composite log-likelihood for spatial ordered probit models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>func.cl.ord(vec.yobs, mat.X, mat.lattice, radius, n.cat, vec.par)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="func.cl.ord_+3A_vec.yobs">vec.yobs</code></td>
<td>
<p>a vector of observed responses for all N sites.</p>
</td></tr>
<tr><td><code id="func.cl.ord_+3A_mat.x">mat.X</code></td>
<td>
<p>regression (design) matrix, including intercepts.</p>
</td></tr>
<tr><td><code id="func.cl.ord_+3A_mat.lattice">mat.lattice</code></td>
<td>
<p>a data matrix containing geographical information of sites. The <em>i</em> th row constitutes a set of geographical coordinates.</p>
</td></tr>
<tr><td><code id="func.cl.ord_+3A_radius">radius</code></td>
<td>
<p>weight radius.</p>
</td></tr>
<tr><td><code id="func.cl.ord_+3A_n.cat">n.cat</code></td>
<td>
<p>number of categories, at least 2.</p>
</td></tr>
<tr><td><code id="func.cl.ord_+3A_vec.par">vec.par</code></td>
<td>
<p>a vector of parameters consecutively as follows: a series of cutoffs (excluding -Inf, 0 and Inf) for latent responses, a vector of covariate parameters, a parameter 'sigmasq' modeling covariance matrix, 0&lt;=sigmasq&lt;=1, and a parameter 'rho' reflecting spatial correlation, abs(rho)&lt;=1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>func.cl.ord</code> returns a list: number of categories, sum of weights, composite log-likelihood, a vector of scores, and a matrix of first-order partial derivatives for <code>vec.par</code>.
</p>


<h3>References</h3>

<p>Feng, Xiaoping, Zhu, Jun, Lin, Pei-Sheng, and Steen-Adams, Michelle M. (2014) Composite likelihood Estimation for Models of Spatial Ordinal Data and Spatial Proportional Data with Zero/One values. <em>Environmetrics</em> 25(8): 571&ndash;583.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# True parameter
vec.cutoff &lt;- 2; vec.beta &lt;- c(1, 2, 1, 0, -1); sigmasq &lt;- 0.8; rho &lt;- 0.6; radius &lt;- 5
vec.par &lt;- c(vec.cutoff, vec.beta, sigmasq, rho)

# Coordinate matrix
n.cat &lt;- 3; n.lati &lt;- 30; n.long &lt;- 30
n.site &lt;- n.lati * n.long
mat.lattice &lt;- cbind(rep(1:n.lati, n.long), rep(1:n.long, each=n.lati))
mat.dist &lt;- as.matrix(dist(mat.lattice, upper=TRUE, diag=TRUE))
mat.cov &lt;- sigmasq * rho^mat.dist

set.seed(1228)
# Generate regression (design) matrix with intercept
mat.X &lt;- cbind(rep(1, n.site),scale(matrix(rnorm(n.site*(length(vec.beta)-1)),nrow=n.site)))
vec.Z &lt;- t(chol(mat.cov)) %*% rnorm(n.site) + mat.X %*% vec.beta
vec.epsilon &lt;- diag(sqrt(1-sigmasq), n.site) %*% rnorm(n.site)
vec.ylat &lt;- as.numeric(vec.Z + vec.epsilon)

# Convert to the vector of observation
vec.yobs &lt;- func.obs.ord(vec.ylat, vec.alpha=c(-Inf,0,vec.cutoff,Inf))

# Using func.cl.ord()
ls &lt;- func.cl.ord(vec.yobs, mat.X, mat.lattice, radius, n.cat, vec.par)
ls$log.lkd

</code></pre>

<hr>
<h2 id='func.cl.ord.repar'>Reparameterized Composite Likelihood Calculation for Spatial Ordinal Data</h2><span id='topic+func.cl.ord.repar'></span>

<h3>Description</h3>

<p><code>func.cl.ord</code> calculates the composite log-likelihood for reparameterized spatial ordered probit models. This function is internally called by <code>func.cle.ord</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>func.cl.ord.repar(vec.yobs, mat.X, mat.lattice, radius, n.cat, vec.repar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="func.cl.ord.repar_+3A_vec.yobs">vec.yobs</code></td>
<td>
<p>a vector of observed responses for all N sites.</p>
</td></tr>
<tr><td><code id="func.cl.ord.repar_+3A_mat.x">mat.X</code></td>
<td>
<p>regression (design) matrix, including intercepts.</p>
</td></tr>
<tr><td><code id="func.cl.ord.repar_+3A_mat.lattice">mat.lattice</code></td>
<td>
<p>a data matrix containing geographical information of sites. The <em>i</em> th row constitutes a set of geographical coordinates.</p>
</td></tr>
<tr><td><code id="func.cl.ord.repar_+3A_radius">radius</code></td>
<td>
<p>weight radius.</p>
</td></tr>
<tr><td><code id="func.cl.ord.repar_+3A_n.cat">n.cat</code></td>
<td>
<p>number of categories, at least 2.</p>
</td></tr>
<tr><td><code id="func.cl.ord.repar_+3A_vec.repar">vec.repar</code></td>
<td>
<p>a vector of parameters consecutively as follows: a reparameterized vector (tau's) for latent responses, a vector of covariate parameters, a parameter 'sigmasq' modeling covariance matrix, 0&lt;=sigmasq&lt;=1, and a parameter 'rho' reflecting spatial correlation, abs(rho)&lt;=1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>func.cl.ord</code> returns a list: number of categories, sum of weights, composite log-likelihood, a vector of scores, and a matrix of first-order partial derivatives for <code>vec.par</code>.
</p>


<h3>References</h3>

<p>Feng, Xiaoping, Zhu, Jun, Lin, Pei-Sheng, and Steen-Adams, Michelle M. (2014) Composite likelihood Estimation for Models of Spatial Ordinal Data and Spatial Proportional Data with Zero/One values. <em>Environmetrics</em> 25(8): 571&ndash;583.
</p>

<hr>
<h2 id='func.cl.prop'>Composite Likelihood Calculation for Spatial Proportional Data</h2><span id='topic+func.cl.prop'></span>

<h3>Description</h3>

<p><code>func.cl.prop</code> calculates the composite log-likelihood for spatial Tobit models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>func.cl.prop(vec.yobs, mat.X, mat.lattice, radius, vec.par)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="func.cl.prop_+3A_vec.yobs">vec.yobs</code></td>
<td>
<p>a vector of observed responses for all N sites.</p>
</td></tr>
<tr><td><code id="func.cl.prop_+3A_mat.x">mat.X</code></td>
<td>
<p>regression (design) matrix, including intercepts.</p>
</td></tr>
<tr><td><code id="func.cl.prop_+3A_mat.lattice">mat.lattice</code></td>
<td>
<p>a data matrix containing geographical information of sites. The <em>i</em> th row constitutes a set of geographical coordinates.</p>
</td></tr>
<tr><td><code id="func.cl.prop_+3A_radius">radius</code></td>
<td>
<p>weight radius.</p>
</td></tr>
<tr><td><code id="func.cl.prop_+3A_vec.par">vec.par</code></td>
<td>
<p>a vector of parameters consecutively as follows: a cutoff point for latent responses, a vector of covariate parameters, a parameter 'sigmasq' modeling covariance matrix, 0&lt;=sigmasq&lt;=1, and a parameter 'rho' reflecting spatial correlation, abs(rho)&lt;=1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>func.cl.prop</code> returns a list of sum of weights, composite log-likelihood, a vector of scores, and a matrix of first-order partial derivatives for <code>vec.par</code>.
</p>


<h3>References</h3>

<p>Feng, Xiaoping, Zhu, Jun, Lin, Pei-Sheng, and Steen-Adams, Michelle M. (2014) Composite likelihood Estimation for Models of Spatial Ordinal Data and Spatial Proportional Data with Zero/One values. <em>Environmetrics</em> 25(8): 571&ndash;583.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# True parameter
alpha &lt;- 4; vec.beta &lt;- c(1, 2, 1, 0, -1); sigmasq &lt;- 0.8; rho &lt;- 0.6; radius &lt;- 5
vec.par &lt;- c(alpha, vec.beta, sigmasq, rho)

# Coordinate matrix
n.lati &lt;- 30; n.long &lt;- 30
n.site &lt;- n.lati * n.long
mat.lattice &lt;- cbind(rep(1:n.lati, n.long), rep(1:n.long, each=n.lati))
mat.dist &lt;- as.matrix(dist(mat.lattice, upper=TRUE, diag=TRUE))
mat.cov &lt;- sigmasq * rho^mat.dist

set.seed(1228)

# Generate regression (design) matrix with intercept
mat.X &lt;- cbind(rep(1, n.site),scale(matrix(rnorm(n.site*(length(vec.beta)-1)),nrow=n.site)))
vec.Z &lt;- t(chol(mat.cov)) %*% rnorm(n.site) + mat.X %*% vec.beta
vec.epsilon &lt;- diag(sqrt(1-sigmasq), n.site) %*% rnorm(n.site)
vec.ylat &lt;- as.numeric(vec.Z + vec.epsilon)

# Convert to the vector of observation
vec.yobs &lt;- func.obs.prop(vec.ylat, alpha=alpha)

# Use func.cl.prop()
ls &lt;- func.cl.prop(vec.yobs, mat.X, mat.lattice, radius, vec.par)
ls$log.lkd
</code></pre>

<hr>
<h2 id='func.cle.ord'>Composite Likelihood Estimation for Spatial Ordinal Data</h2><span id='topic+func.cle.ord'></span>

<h3>Description</h3>

<p><code>func.cle.ord</code> performs composite likelihood estimation of parameters and their standard errors in a spatial ordered probit model by maximizing its composite log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>func.cle.ord(vec.yobs, mat.X, mat.lattice, radius, n.cat, n.sim = 100,
  parallel = TRUE, n.core = max(detectCores()/2, 1), output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="func.cle.ord_+3A_vec.yobs">vec.yobs</code></td>
<td>
<p>a vector of observed responses for all N sites.</p>
</td></tr>
<tr><td><code id="func.cle.ord_+3A_mat.x">mat.X</code></td>
<td>
<p>regression (design) matrix, including intercepts.</p>
</td></tr>
<tr><td><code id="func.cle.ord_+3A_mat.lattice">mat.lattice</code></td>
<td>
<p>a data matrix containing geographical information of sites. The ith row constitutes a set of geographical coordinates.</p>
</td></tr>
<tr><td><code id="func.cle.ord_+3A_radius">radius</code></td>
<td>
<p>weight radius.</p>
</td></tr>
<tr><td><code id="func.cle.ord_+3A_n.cat">n.cat</code></td>
<td>
<p>number of categories.</p>
</td></tr>
<tr><td><code id="func.cle.ord_+3A_n.sim">n.sim</code></td>
<td>
<p>number of simulations used for calculate the Godambe matrix (default: 100).</p>
</td></tr>
<tr><td><code id="func.cle.ord_+3A_parallel">parallel</code></td>
<td>
<p>logical flag indicates using parallel processing (default: <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="func.cle.ord_+3A_n.core">n.core</code></td>
<td>
<p>number of physical cores used for parallel processing (when <code>parallel</code> is <code>TRUE</code>, default value is <code>max(detectCores()/2,1)</code>).</p>
</td></tr>
<tr><td><code id="func.cle.ord_+3A_output">output</code></td>
<td>
<p>logical flag indicates whether printing out result (default: <code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given the design matrix, the vector of observed responses, spatial lattice data, weight radius, number of categories, and the prespecified number of simulated vectors of responses used in estimating the Godambe information, this function assumes initial values of cutoff points and <code class="reqn">\beta</code> as the estimates from the standard ordered probit regression with independent responses. After initial reparameterization, it first estimates parameters of interest by maximizing the composite log-likelihood using <code>optim</code>, then computes the reparameterized sample covariance matrix and the set of standard errors, and finally reverse the reparameterization to obtain estimates corresponding to the original parameterization.
</p>


<h3>Value</h3>

<p><code>func.cle.ord</code> returns a list containing:
</p>
<p><code>vec.par</code>: a vector of estimator for <code class="reqn">\theta</code>=(cutoff,<code class="reqn">\beta,\sigma^2,\rho)</code>;
</p>
<p><code>vec.se</code>: a vector of standard error for the estimator;
</p>
<p><code>mat.asyvar</code>: estimated asymptotic covariance matrix <code class="reqn">H^{-1}(\theta)J(\theta)H^{-1}(\theta)</code> for the estimator; and
</p>
<p><code>vec.comp</code>: a vector of computational time for parameter and standard error estimation.
</p>
<p><code>CLIC</code>: Composite likelihood information criterion proposed by Varin and Vidoni (2005), i.e. <code class="reqn">-2*logCL(\theta) + 2*trace(H^{-1}(\theta)J(\theta))</code>
</p>


<h3>References</h3>

<p>Feng, Xiaoping, Zhu, Jun, Lin, Pei-Sheng, and Steen-Adams, Michelle M. (2014) Composite likelihood Estimation for Models of Spatial Ordinal Data and Spatial Proportional Data with Zero/One values. <em>Environmetrics</em> 25(8): 571&ndash;583.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example of n.cat = 3 (Spatial ordinal regression)
# True parameter
vec.cutoff &lt;- 2; vec.beta &lt;- c(1, 2, 1, 0, -1); sigmasq &lt;- 0.8; rho &lt;- 0.6; radius &lt;- 5
vec.par &lt;- c(vec.cutoff, vec.beta, sigmasq, rho)

# Coordinate matrix
n.cat &lt;- 3; n.lati &lt;- 30; n.long &lt;- 30
n.site &lt;- n.lati * n.long
mat.lattice &lt;- cbind(rep(1:n.lati, n.long), rep(1:n.long, each=n.lati))
mat.dist &lt;- as.matrix(dist(mat.lattice, upper=TRUE, diag=TRUE))
mat.cov &lt;- sigmasq * rho^mat.dist

set.seed(1228)
# Generate regression (design) matrix with intercept
mat.X &lt;- cbind(rep(1, n.site),scale(matrix(rnorm(n.site*(length(vec.beta)-1)),nrow=n.site)))
vec.Z &lt;- t(chol(mat.cov)) %*% rnorm(n.site) + mat.X %*% vec.beta
vec.epsilon &lt;- diag(sqrt(1-sigmasq), n.site) %*% rnorm(n.site)
vec.ylat &lt;- as.numeric(vec.Z + vec.epsilon)

# Convert to the vector of observation
vec.yobs &lt;- func.obs.ord(vec.ylat, vec.alpha=c(-Inf,0,vec.cutoff,Inf))

# With parallel computing

## Not run: 
ord.example &lt;- func.cle.ord(vec.yobs, mat.X, mat.lattice, radius, n.cat,
n.sim=100, parallel = TRUE, n.core = 2)

round(ord.example$vec.par,4)
# alpha1   beta0   beta1   beta2   beta3   beta4 sigma^2     rho
# 1.8395  0.9550  1.9690  0.9565  0.0349 -1.0398  0.8200  0.5578

round(ord.example$vec.se,4)
# alpha1   beta0   beta1   beta2   beta3   beta4 sigma^2     rho
# 0.1602  0.1222  0.1463  0.0916  0.0485  0.0889  0.1935  0.1267

## End(Not run)

# Without parallel computing

## Not run: 
ord.example2 &lt;- func.cle.ord(vec.yobs, mat.X, mat.lattice, radius,
n.cat, n.sim=100, parallel = FALSE)

## End(Not run)

# Example for n.cat = 2 (i.e. Spatial probit regression)
# True parameter
vec.beta &lt;- c(1, 2, 1, 0, -1); sigmasq &lt;- 0.5; rho &lt;- 0.6; radius &lt;- 5
vec.par &lt;- c(vec.beta, sigmasq, rho)

# Coordinate matrix
n.cat &lt;- 2 ; n.lati &lt;- n.long &lt;- 40
n.site &lt;- n.lati * n.long
mat.lattice &lt;- cbind(rep(1:n.lati, n.long), rep(1:n.long, each=n.lati))
mat.dist &lt;- as.matrix(dist(mat.lattice, upper=TRUE, diag=TRUE))
mat.cov &lt;- sigmasq * rho^mat.dist

set.seed(123)
# Generate regression (design) matrix with intercept
mat.X &lt;- cbind(rep(1, n.site),scale(matrix(rnorm(n.site*(length(vec.beta)-1)),nrow=n.site)))
vec.Z &lt;- t(chol(mat.cov)) %*% rnorm(n.site) + mat.X %*% vec.beta
vec.epsilon &lt;- diag(sqrt(1-sigmasq), n.site) %*% rnorm(n.site)
vec.ylat &lt;- as.numeric(vec.Z + vec.epsilon)
# Convert to the vector of observation
vec.yobs &lt;- func.obs.ord(vec.ylat, vec.alpha=c(-Inf,0,Inf))

## Not run: 
probit.example &lt;- func.cle.ord(vec.yobs, mat.X, mat.lattice, radius, n.cat,
n.sim=100, parallel = TRUE, n.core = 4)

round(probit.example$vec.par,4)
# beta0   beta1   beta2   beta3   beta4 sigma^2     rho
# 1.0427  2.2250  1.0422  0.0156 -1.1489  0.4402  0.6636

round(probit.example$vec.se,4)
# beta0   beta1   beta2   beta3   beta4 sigma^2     rho
# 0.1198  0.1413  0.0863  0.0523  0.0935  0.1600  0.1263

## End(Not run)


</code></pre>

<hr>
<h2 id='func.cle.prop'>Composite Likelihood Estimation for Spatial Proportional Data</h2><span id='topic+func.cle.prop'></span>

<h3>Description</h3>

<p><code>func.cle.prop</code> performs composite likelihood estimation of parameters and their standard errors in a spatial Tobit model by maximizing its composite log-likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>func.cle.prop(vec.yobs, mat.X, mat.lattice, radius, n.sim = 100,
  parallel = TRUE, n.core = max(detectCores()/2, 1), output = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="func.cle.prop_+3A_vec.yobs">vec.yobs</code></td>
<td>
<p>a vector of observed responses for all N sites.</p>
</td></tr>
<tr><td><code id="func.cle.prop_+3A_mat.x">mat.X</code></td>
<td>
<p>regression (design) matrix, including intercepts.</p>
</td></tr>
<tr><td><code id="func.cle.prop_+3A_mat.lattice">mat.lattice</code></td>
<td>
<p>a data matrix containing geographical information of sites. The i-th row constitutes a set of geographical coordinates.</p>
</td></tr>
<tr><td><code id="func.cle.prop_+3A_radius">radius</code></td>
<td>
<p>weight radius.</p>
</td></tr>
<tr><td><code id="func.cle.prop_+3A_n.sim">n.sim</code></td>
<td>
<p>number of simulations used for calculate the Godambe matrix (default: 100).</p>
</td></tr>
<tr><td><code id="func.cle.prop_+3A_parallel">parallel</code></td>
<td>
<p>logical flag indicating using parallel processing (default: <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="func.cle.prop_+3A_n.core">n.core</code></td>
<td>
<p>number of physical cores used for parallel processing (when <code>parallel</code> is <code>TRUE</code>), default value is <code>max(detectCores()/2,1)</code>).</p>
</td></tr>
<tr><td><code id="func.cle.prop_+3A_output">output</code></td>
<td>
<p>logical flag indicates whether printing out result (default: <code>TRUE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given the design matrix, the vector of observed responses, spatial lattice data, weight radius, and the prespecified number of simulated vectors of responses used in estimating the Godambe information matrix, this function assumes initial values of <code class="reqn">\beta</code> as the estimates from the standard Type I Tobit model with independent responses. The initial value of <code class="reqn">\alpha</code> and the right limit of the Tobit model are equally set to 1. Since there is only one cutoff point to be estimated, reparameterization is unnecessary. The function first estimates parameters of interest by maximizing the composite log-likelihood using <code>optim(...,method = "L-BFGS-B")</code>, then computes the simulated based standard error and asymptotic covariance matrix.
</p>


<h3>Value</h3>

<p><code>func.cle.prop</code> returns a list containing:
</p>
<p><code>vec.par</code>: a vector of estimator for <code class="reqn">\theta=(\alpha,\beta,\sigma^2,\rho)</code>;
</p>
<p><code>vec.se</code>: a vector of standard error for the estimator;
</p>
<p><code>mat.asyvar</code>: estimated asymptotic covariance matrix <code class="reqn">H^{-1}(\theta)J(\theta)H^{-1}(\theta)</code> for the estimator; and
</p>
<p><code>vec.comp</code>: a vector of computational time for parameter and standard error estimation.
</p>
<p><code>CLIC</code>: Composite likelihood information criterion proposed by Varin and Vidoni (2005), i.e. <code class="reqn">-2*logCL(\theta) + 2*trace(H^{-1}(\theta)J(\theta))</code>
</p>


<h3>References</h3>

<p>Feng, Xiaoping, Zhu, Jun, Lin, Pei-Sheng, and Steen-Adams, Michelle M. (2014) Composite likelihood Estimation for Models of Spatial Ordinal Data and Spatial Proportional Data with Zero/One values. <em>Environmetrics</em> 25(8): 571&ndash;583.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># True parameter
alpha &lt;- 4; vec.beta &lt;- c(1, 2, 1, 0, -1); sigmasq &lt;- 0.8; rho &lt;- 0.6; radius &lt;- 5
vec.par &lt;- c(alpha, vec.beta, sigmasq, rho)

# Coordinate matrix
n.lati &lt;- 30; n.long &lt;- 30
n.site &lt;- n.lati * n.long
mat.lattice &lt;- cbind(rep(1:n.lati, n.long), rep(1:n.long, each=n.lati))
mat.dist &lt;- as.matrix(dist(mat.lattice, upper=TRUE, diag=TRUE))
mat.cov &lt;- sigmasq * rho^mat.dist

set.seed(1228)

# Generate regression (design) matrix with intercept
mat.X &lt;- cbind(rep(1, n.site),scale(matrix(rnorm(n.site*(length(vec.beta)-1)),nrow=n.site)))
vec.Z &lt;- t(chol(mat.cov)) %*% rnorm(n.site) + mat.X %*% vec.beta
vec.epsilon &lt;- diag(sqrt(1-sigmasq), n.site) %*% rnorm(n.site)
vec.ylat &lt;- as.numeric(vec.Z + vec.epsilon)

# Convert to the vector of observation
vec.yobs &lt;- func.obs.prop(vec.ylat, alpha=alpha)

# With parallel computing

## Not run: 
prop.example &lt;- func.cle.prop(vec.yobs, mat.X, mat.lattice, radius,
n.sim=100, parallel = TRUE, n.core = 2)

round(prop.example$vec.par,4)
# alpha   beta0   beta1   beta2   beta3   beta4 sigma^2     rho
# 3.8259  0.9921  1.9679  0.9455  0.0148 -0.9871  0.8386  0.5761

round(prop.example$vec.se ,4)
# alpha   beta0   beta1   beta2   beta3   beta4 sigma^2     rho
# 0.1902  0.1406  0.1103  0.0744  0.0385  0.0652  0.1527  0.1151

## End(Not run)

# Without parallel computing

## Not run: 
prop.example2 &lt;- func.cle.prop(vec.yobs, mat.X, mat.lattice, radius, n.sim=100, parallel = FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='func.obs.ord'>Latent Response Transformation for Spatial Ordinal Data</h2><span id='topic+func.obs.ord'></span>

<h3>Description</h3>

<p><code>func.obs.ord</code> transforms a vector of latent responses into the corresponding observed ones under the spatial Probit model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>func.obs.ord(vec.ylat, vec.alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="func.obs.ord_+3A_vec.ylat">vec.ylat</code></td>
<td>
<p>a vector of latent responses for all N sites.</p>
</td></tr>
<tr><td><code id="func.obs.ord_+3A_vec.alpha">vec.alpha</code></td>
<td>
<p>a vector of prespecified cutoff points, ascending with length at least 3, including -Inf, 0, and Inf.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>func.obs.prop</code> returns a vector of observed responses.
</p>


<h3>References</h3>

<p>Feng, Xiaoping, Zhu, Jun, Lin, Pei-Sheng, and Steen-Adams, Michelle M. (2014) Composite likelihood Estimation for Models of Spatial Ordinal Data and Spatial Proportional Data with Zero/One values. <em>Environmetrics</em> 25(8): 571&ndash;583.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# True parameter
vec.cutoff &lt;- 2; vec.beta &lt;- c(1, 2, 1, 0, -1); sigmasq &lt;- 0.8; rho &lt;- 0.6; radius &lt;- 5
vec.par &lt;- c(vec.cutoff, vec.beta, sigmasq, rho)

# Coordinate matrix
n.cat &lt;- 3; n.lati &lt;- 30; n.long &lt;- 30
n.site &lt;- n.lati * n.long
mat.lattice &lt;- cbind(rep(1:n.lati, n.long), rep(1:n.long, each=n.lati))
mat.dist &lt;- as.matrix(dist(mat.lattice, upper=TRUE, diag=TRUE))
mat.cov &lt;- sigmasq * rho^mat.dist

set.seed(1228)
# Generate regression (design) matrix with intercept
mat.X &lt;- cbind(rep(1, n.site),scale(matrix(rnorm(n.site*(length(vec.beta)-1)),nrow=n.site)))
vec.Z &lt;- t(chol(mat.cov)) %*% rnorm(n.site) + mat.X %*% vec.beta
vec.epsilon &lt;- diag(sqrt(1-sigmasq), n.site) %*% rnorm(n.site)
vec.ylat &lt;- as.numeric(vec.Z + vec.epsilon)

# Convert to the vector of observation
vec.yobs &lt;- func.obs.ord(vec.ylat, vec.alpha=c(-Inf,0,vec.cutoff,Inf))

</code></pre>

<hr>
<h2 id='func.obs.prop'>Latent Response Transformation for Proportional Data</h2><span id='topic+func.obs.prop'></span>

<h3>Description</h3>

<p><code>func.obs.prop</code> transforms a vector of latent responses into the corresponding observed ones under the spatial Tobit model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>func.obs.prop(vec.ylat, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="func.obs.prop_+3A_vec.ylat">vec.ylat</code></td>
<td>
<p>a vector of latent responses for all N sites.</p>
</td></tr>
<tr><td><code id="func.obs.prop_+3A_alpha">alpha</code></td>
<td>
<p>a cutoff point controlling the probability of latent reponse being one.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>func.obs.prop</code> returns a vector of observed responses.
</p>


<h3>References</h3>

<p>Feng, Xiaoping, Zhu, Jun, Lin, Pei-Sheng, and Steen-Adams, Michelle M. (2014) Composite likelihood Estimation for Models of Spatial Ordinal Data and Spatial Proportional Data with Zero/One values. <em>Environmetrics</em> 25(8): 571&ndash;583.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# A simple example for observation generation
a &lt;- sample(c(0,1), 50, replace=TRUE)
b &lt;- sample(runif(1000,0,10), 100, replace=TRUE)
alpha &lt;- 4
vec.yobs &lt;- func.obs.prop(vec.ylat=c(a, b), alpha=alpha)

# A complex example
# True parameter
alpha &lt;- 4; vec.beta &lt;- c(1, 2, 1, 0, -1); sigmasq &lt;- 0.8; rho &lt;- 0.6; radius &lt;- 5
vec.par &lt;- c(alpha, vec.beta, sigmasq, rho)

# Coordinate matrix
n.lati &lt;- 30; n.long &lt;- 30
n.site &lt;- n.lati * n.long
mat.lattice &lt;- cbind(rep(1:n.lati, n.long), rep(1:n.long, each=n.lati))
mat.dist &lt;- as.matrix(dist(mat.lattice, upper=TRUE, diag=TRUE))
mat.cov &lt;- sigmasq * rho^mat.dist

set.seed(1228)

# Generate regression (design) matrix with intercept
mat.X &lt;- cbind(rep(1, n.site),scale(matrix(rnorm(n.site*(length(vec.beta)-1)),nrow=n.site)))
vec.Z &lt;- t(chol(mat.cov)) %*% rnorm(n.site) + mat.X %*% vec.beta
vec.epsilon &lt;- diag(sqrt(1-sigmasq), n.site) %*% rnorm(n.site)
vec.ylat &lt;- as.numeric(vec.Z + vec.epsilon)

# Convert to the vector of observation
vec.yobs &lt;- func.obs.prop(vec.ylat, alpha=alpha)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
