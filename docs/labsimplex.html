<!DOCTYPE html><html><head><title>Help for package labsimplex</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {labsimplex}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addSimplex2Surface'><p>Adds the simplex movements to a response surface contour</p></a></li>
<li><a href='#adjustVertex'><p>Modify the coordinates of given vertexes of a simplex</p></a></li>
<li><a href='#cntr'><p>Contour plot of example response surfaces</p></a></li>
<li><a href='#exampleOptimization'><p>Performs a complete simplex optimization over a response surface</p></a></li>
<li><a href='#ExampleSurfaces'><p>Multivariate functions that define hypothetical response surfaces.</p></a></li>
<li><a href='#generateVertex'><p>Generates the new vertex of a simplex optimization</p></a></li>
<li><a href='#labsimplex'><p>Generates a simplex object</p></a></li>
<li><a href='#labsimplex-package'><p><code>labsimplex</code>: Simplex Optimization Algorithms for Laboratory and</p>
Manufacturing Processes</a></li>
<li><a href='#plot.smplx'><p>Draws a two dimentional plot of the vertexes in a simplex</p></a></li>
<li><a href='#plotSimplex3D'><p>Draws a three dimentional plot of the vertexes in a simplex</p></a></li>
<li><a href='#plotSimplexResponse'><p>Plots the response versus the vertex number of a simplex optimization.</p></a></li>
<li><a href='#print.smplx'><p>S3 method <code>print</code> for simplex objects</p></a></li>
<li><a href='#prspctv'><p>3D perspective plot of example response surfaces</p></a></li>
<li><a href='#simplexExport'><p>Exports the information contained in an object of class <code>smplx</code>.</p></a></li>
<li><a href='#simplexImport'><p>Imports the information contained in a <code>.smplx</code> file.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-18</td>
</tr>
<tr>
<td>Title:</td>
<td>Simplex Optimization Algorithms for Laboratory and Manufacturing
Processes</td>
</tr>
<tr>
<td>Author:</td>
<td>Cristhian Paredes [aut, cre],
    Jesús Ágreda [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cristhian Paredes &lt;craparedesca@unal.edu.co&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Simplex optimization algorithms as firstly proposed by Spendley
    et al. (1962) &lt;<a href="https://doi.org/10.1080%2F00401706.1962.10490033">doi:10.1080/00401706.1962.10490033</a>&gt; and later modified by 
    Nelder and Mead (1965) &lt;<a href="https://doi.org/10.1093%2Fcomjnl%2F7.4.308">doi:10.1093/comjnl/7.4.308</a>&gt; for laboratory and 
    manufacturing processes. The package also provides tools for graphical 
    representation of the simplexes and some example response surfaces that 
    are useful in illustrating the optimization process.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>scatterplot3d (&ge; 0.3-41), ggplot2</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2.9000</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, FrF2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-03 06:03:08 UTC; cris</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-03 16:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='addSimplex2Surface'>Adds the simplex movements to a response surface contour</h2><span id='topic+addSimplex2Surface'></span>

<h3>Description</h3>

<p>The function complements the contour plot produced by using
<code><a href="#topic+cntr">cntr</a></code> function. Given a contour plot and a simplex
(an object of class <code>smplx</code>) the function adds the simplex
movements to the contour plot to illustrate the optimization process
and the path that was followed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addSimplex2Surface(p, simplex)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addSimplex2Surface_+3A_p">p</code></td>
<td>
<p>contour plot produced by using <code><a href="#topic+cntr">cntr</a></code> function</p>
</td></tr>
<tr><td><code id="addSimplex2Surface_+3A_simplex">simplex</code></td>
<td>
<p>simplex object of class <code>smplx</code>. Usually produced
using <code><a href="#topic+exampleOptimization">exampleOptimization</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object with the optimization
path over the contour plot provided.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cntr">cntr</a></code> <code><a href="#topic+exampleOptimization">exampleOptimization</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simplex &lt;- exampleOptimization(surface = exampleSurfaceR2,
                               centroid = c(7, 340),
                               stepsize = c(1.2, 15))
p &lt;- cntr(surface = exampleSurfaceR2)
p &lt;- addSimplex2Surface(p = p, simplex = simplex)
print(p)
</code></pre>

<hr>
<h2 id='adjustVertex'>Modify the coordinates of given vertexes of a simplex</h2><span id='topic+adjustVertex'></span>

<h3>Description</h3>

<p>Changes the coordinates of previously generated vertexes when slight
differences were impossible to avoid at the moment of setting the experiment
variables (e.g. small differences in mass components when preparing a
mixture). This function allows the correction of the vertexes of a simplex
in order to produce movements of the simplex based on the actual
coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjustVertex(simplex, newcoords, overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjustVertex_+3A_simplex">simplex</code></td>
<td>
<p>object of class <code>smplx</code> with the simplex
information. See <code><a href="#topic+labsimplex">labsimplex</a></code></p>
</td></tr>
<tr><td><code id="adjustVertex_+3A_newcoords">newcoords</code></td>
<td>
<p>List with elements named like the vertexes to be modified.
Each element must have a vector with the actual (ordered)
coordinates used in the experiment. <code>NA</code> values may
be used to indicate unchanged coordinates</p>
</td></tr>
<tr><td><code id="adjustVertex_+3A_overwrite">overwrite</code></td>
<td>
<p>logical argument. If <code>TRUE</code>, the output simplex will
replace the one provided in the <code>simplex</code> parameter.
Default <code>overwrite = FALSE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>smplx</code> with the modified simplex information.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simplex &lt;- labsimplex(n = 3, start = c(7, 25, 0.15),
                      stepsize = c(0.2, 5, 0.02))
adjustVertex(simplex = simplex, newcoords = list(Vertex.1 = c(7.1, NA, NA),
                                                 Vertex.3 = c(6.9, NA, 0.155)),
             overwrite = TRUE)
</code></pre>

<hr>
<h2 id='cntr'>Contour plot of example response surfaces</h2><span id='topic+cntr'></span>

<h3>Description</h3>

<p>Plots a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> with the contour of the
bivariate example response surfaces included in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cntr(surface, length = 150, noise = 0, x1lim = c(278, 365), x2lim = c(0, 14))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cntr_+3A_surface">surface</code></td>
<td>
<p>example response surface to use. See
<code><a href="#topic+exampleSurfaceR2">exampleSurfaceR2</a></code> and
<code><a href="#topic+exampleSurfaceR2.2pks">exampleSurfaceR2.2pks</a></code>.</p>
</td></tr>
<tr><td><code id="cntr_+3A_length">length</code></td>
<td>
<p>number of levels to use in each explanatory variables</p>
</td></tr>
<tr><td><code id="cntr_+3A_noise">noise</code></td>
<td>
<p>absolute noise to be included in the results</p>
</td></tr>
<tr><td><code id="cntr_+3A_x1lim">x1lim</code></td>
<td>
<p>limits for the first variable (temperature in
<code><a href="#topic+exampleSurfaceR2">exampleSurfaceR2</a></code> and
<code><a href="#topic+exampleSurfaceR2.2pks">exampleSurfaceR2.2pks</a></code>)</p>
</td></tr>
<tr><td><code id="cntr_+3A_x2lim">x2lim</code></td>
<td>
<p>limits for the second variable (pH in
<code><a href="#topic+exampleSurfaceR2">exampleSurfaceR2</a></code> and
<code><a href="#topic+exampleSurfaceR2.2pks">exampleSurfaceR2.2pks</a></code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>References</h3>

<p>H. Wickham. ggplot2: Elegant Graphics for Data Analysis.
Springer-Verlag New York, 2016.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  p &lt;- cntr(surface = exampleSurfaceR2, length = 200)
  print(p)
</code></pre>

<hr>
<h2 id='exampleOptimization'>Performs a complete simplex optimization over a response surface</h2><span id='topic+exampleOptimization'></span>

<h3>Description</h3>

<p>The function uses the information in a simplex or creates a
new one by using the defined centroid and step-size to perform a simplex
optimization using the responses produced in the example response
surfaces included in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exampleOptimization(surface, simplex = NULL, centroid = c(7, 340),
  stepsize = c(0.6, 10), algor = "fixed", experiments = 17, noise = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exampleOptimization_+3A_surface">surface</code></td>
<td>
<p>example response surface to be used. See
<code><a href="#topic+exampleSurfaceR2">exampleSurfaceR2</a></code>,
<code><a href="#topic+exampleSurfaceR3">exampleSurfaceR3</a></code> and
<code><a href="#topic+exampleSurfaceR2.2pks">exampleSurfaceR2.2pks</a></code></p>
</td></tr>
<tr><td><code id="exampleOptimization_+3A_simplex">simplex</code></td>
<td>
<p>object of class <code>smplx</code> with the simplex
information. See <code><a href="#topic+labsimplex">labsimplex</a></code></p>
</td></tr>
<tr><td><code id="exampleOptimization_+3A_centroid">centroid</code></td>
<td>
<p>numeric vector of size <code>n</code> with coordinates of the
centroid</p>
</td></tr>
<tr><td><code id="exampleOptimization_+3A_stepsize">stepsize</code></td>
<td>
<p>numeric vector of size <code>n</code> with the step-sizes for
each coordinate</p>
</td></tr>
<tr><td><code id="exampleOptimization_+3A_algor">algor</code></td>
<td>
<p>algorithm to be followed in the vertex generation.
<code>'fixed'</code> for a fixed step-size simplex
or <code>'variable'</code> for a variable step-size simplex</p>
</td></tr>
<tr><td><code id="exampleOptimization_+3A_experiments">experiments</code></td>
<td>
<p>number of vertexes to evaluate</p>
</td></tr>
<tr><td><code id="exampleOptimization_+3A_noise">noise</code></td>
<td>
<p>absolute noise to be included in the results</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object with class <code>smplx</code> with the simplex optimization
data.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>

<hr>
<h2 id='ExampleSurfaces'>Multivariate functions that define hypothetical response surfaces.</h2><span id='topic+ExampleSurfaces'></span><span id='topic+exampleSurfaceR2'></span><span id='topic+exampleSurfaceR2.2pks'></span><span id='topic+exampleSurfaceR3'></span>

<h3>Description</h3>

<p>The functions in this section simulate the yield of hypothetical chemical
reactions as a function of temperature, pH, and concentration (the latter
only for <code>exampleSurfaceR3()</code>). Those functions are useful to
illustrate most concepts of the simplex optimization algorithms
implemented in the <code>labsimplex</code> package, as shown in the vignentte of
the package. This vignette can be visualized by running
<code>vignette('labsimplex')</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exampleSurfaceR2(x1, x2, noise = 0)

exampleSurfaceR2.2pks(x1, x2, noise = 0)

exampleSurfaceR3(x1, x2, x3, noise = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ExampleSurfaces_+3A_x1">x1</code></td>
<td>
<p>temperature in Kelvin. Numeric between 278 and 365.</p>
</td></tr>
<tr><td><code id="ExampleSurfaces_+3A_x2">x2</code></td>
<td>
<p>pH. Numeric between 0 and 14.</p>
</td></tr>
<tr><td><code id="ExampleSurfaces_+3A_noise">noise</code></td>
<td>
<p>absolute noise included in the response surface result.
Default to zero.</p>
</td></tr>
<tr><td><code id="ExampleSurfaces_+3A_x3">x3</code></td>
<td>
<p>concentration in arbitrary units. Numeric between 0 and 1.
Only used in <code>exampleSurfaceR3()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters <code>x1</code>, <code>x2</code>, and <code>x3</code> may be supplied as
vectors in which case all must have the same length. <br />
Boundary values are proposed consistently with real-life limitations
in aqueous media. If such boundaries are violated in the variables
input, a negative result without physical meaning is returned. This
negative value represents an <em>infinitely bad response</em> that will
force the simplex to move in another direction.
</p>


<h3>Value</h3>

<p><code>exampleSurfaceR2(x1, x2, noise = 0)</code> defines a response
surface with one maximum at pH 10 and 300 K.
</p>
<p><code>exampleSurfaceR2.2pks(x1, x2, noise = 0)</code> defines a response
surface with global and local maxima at pH 10 and 300 K and pH 4.5 and
340 K, respectively.
</p>
<p><code>exampleSurfaceR3(x1, x2, x3, noise = 0)</code> defines a response
surface with one maximum at pH 10, 300 K and a concentration of 0.5.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cntr">cntr</a></code>, <code><a href="#topic+prspctv">prspctv</a></code> and
<code><a href="#topic+exampleOptimization">exampleOptimization</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  exampleSurfaceR2(x1 = 320, x2 = 4.5)
  exampleSurfaceR2(x1 = c(310, 320), x2 = c(4.5, 5.8))
  exampleSurfaceR2(x1 = c(310, 320), x2 = c(4.5, 5.8), noise = 5)
  exampleSurfaceR2.2pks(x1 = 320, x2 = 4.5)
  exampleSurfaceR2.2pks(x1 = c(310, 320), x2 = c(4.5, 5.8))
  exampleSurfaceR2.2pks(x1 = c(310, 320), x2 = c(4.5, 5.8), noise = 5)
  exampleSurfaceR3(x1 = 320, x2 = 4.5, x3 = 0.3)
  exampleSurfaceR3(x1 = c(310, 320), x2 = c(4.5, 5.8), x3 = c(0.3, 0.5))
  exampleSurfaceR3(x1 = c(310, 320), x2 = c(4.5, 5.8), x3 = c(0.3, 0.5),
                   noise = 5)
</code></pre>

<hr>
<h2 id='generateVertex'>Generates the new vertex of a simplex optimization</h2><span id='topic+generateVertex'></span>

<h3>Description</h3>

<p>Gives the coordinates for the new vertex that must be performed
based on the responses for the vertexes on the current simplex
and considering the optimization criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generateVertex(simplex, qflv = NULL, crit = "max", algor = "fixed",
  overwrite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generateVertex_+3A_simplex">simplex</code></td>
<td>
<p>object of class <code>smplx</code> with the simplex
information. See <code><a href="#topic+labsimplex">labsimplex</a></code></p>
</td></tr>
<tr><td><code id="generateVertex_+3A_qflv">qflv</code></td>
<td>
<p>response for the vertex (or vertexes) without responses</p>
</td></tr>
<tr><td><code id="generateVertex_+3A_crit">crit</code></td>
<td>
<p>optimization criteria indicating if the goal is maximize
(<code>'max'</code>) or minimize (<code>'min'</code>) the response.
It can also be a numeric value to which the
response is supposed to approach</p>
</td></tr>
<tr><td><code id="generateVertex_+3A_algor">algor</code></td>
<td>
<p>algorithm to be followed in the vertex generation.
<code>'fixed'</code> for a fixed step-size simplex
or <code>'variable'</code> for a variable step-size simplex</p>
</td></tr>
<tr><td><code id="generateVertex_+3A_overwrite">overwrite</code></td>
<td>
<p>logical argument. If <code>TRUE</code>, the output simplex will
replace the one provided in the <code>simplex</code> parameter.
Default <code>overwrite = FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>When minimization is the criteria, the algorithm will tend to approach zero.
If negative responses are possible and the most negative value is desired,
a very large negative number must be provided in <code>crit</code> parameter.
</p>


<h3>Value</h3>

<p>An object of class <code>smplx</code> with the new simplex information
including the conditions for the new experiment to be permormed.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  simplex &lt;- labsimplex(n = 3, centroid = c(320, 7, 0.4),
                        stepsize = c(35, 2, 0.3))
  ## The experiments must be performed and the responses passed to qflv.
  ## Here we get the responses by using an example response surface
  ## included in the package:
  ##
  ## Initially, the response must be provided for all the vertexes
  response &lt;- exampleSurfaceR3(x1 = simplex$coords[, 1],
                               x2 = simplex$coords[, 2],
                               x3 = simplex$coords[, 3])
  simplex &lt;- generateVertex(simplex = simplex, qflv = response)

  ## After this, the last vertex is the only one that must be evaluated
  response &lt;- exampleSurfaceR3(x1 = simplex$coords[nrow(simplex$coords), 1],
                               x2 = simplex$coords[nrow(simplex$coords), 2],
                               x3 = simplex$coords[nrow(simplex$coords), 3])
  simplex &lt;- generateVertex(simplex = simplex, qflv = response)

  ## Alternatively the simplex object can overwrite the older one:
  generateVertex(simplex = simplex, qflv = response, overwrite = TRUE)
</code></pre>

<hr>
<h2 id='labsimplex'>Generates a simplex object</h2><span id='topic+labsimplex'></span>

<h3>Description</h3>

<p>The simplex (a list with class <code>smplx</code>) contains the coordinates
of the n+1 vertices that define a simplex in an <em>n</em>-dimensional space.
By default, the function produces a regular simplex centered at the origin.
The coordinates of the regular simplex are transformed into the real
variables space by using the information of the start or centroid and
step-size. The only non-optional parameter is <code>n</code> that relates the
simplex dimensionality. Once the simplex
is generated, the experiments under the conditions indicated for each
variable at each vertex must be carried and the response obtained.
Those responses are assigned to the <code>smplx</code> object at the moment of
generating the new vertex (see <code><a href="#topic+generateVertex">generateVertex</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>labsimplex(n, start = NULL, centroid = NULL, stepsize = NULL,
  usrdef = NULL, var.name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="labsimplex_+3A_n">n</code></td>
<td>
<p>dimensionality of the simplex (i.e. number of variables)</p>
</td></tr>
<tr><td><code id="labsimplex_+3A_start">start</code></td>
<td>
<p>numeric vector of size <code>n</code> with coordinates of the
first vertex</p>
</td></tr>
<tr><td><code id="labsimplex_+3A_centroid">centroid</code></td>
<td>
<p>numeric vector of size <code>n</code> with coordinates of the
centroid</p>
</td></tr>
<tr><td><code id="labsimplex_+3A_stepsize">stepsize</code></td>
<td>
<p>numeric vector of size <code>n</code> with the step-sizes for
each coordinate</p>
</td></tr>
<tr><td><code id="labsimplex_+3A_usrdef">usrdef</code></td>
<td>
<p><code>(n+1)xn</code> matrix containig in (n+1) rows the n
coordinates for each vertex</p>
</td></tr>
<tr><td><code id="labsimplex_+3A_var.name">var.name</code></td>
<td>
<p>vector containing the names for the variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The regular simplex coordinates are generated following the general
algorithm for the cartesian coordinates of a regular n-dimensional simplex.
This algorithm considers that all vertices must be equally distanced from
simplex centroid and all angles subtended between any two vertexes and the
centroid of a simplex are equal to <em>arccos(-1/n)</em>.<br />
If the vertexes coordinates are manually given (in <code>usr.def</code>
parameter), the function checks if the faces produced belong to different
hyperplanes. This avoids the generation of a degenerated simplex.
</p>


<h3>Value</h3>

<p>An object of class <code>smplx</code> with the information of the new
simplex.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>References</h3>

<p>Nelder, J. A., and R. Mead. 1965. “A Simplex Method for Function
Minimization.” The Computer Journal 7 (4): 308–13.
</p>
<p>Spendley, W., G. R. Hext, and F. R0. Himsworth. 1962. “Sequential
Application of Simplex Designs in Optimization and Evolutionary Operation.”
Technometrics 4 (4): 441–61.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  simplex &lt;- labsimplex(n = 3)
  simplex &lt;- labsimplex(n = 3, centroid = c(350, 7, 0.4),
                        stepsize = c(35, 2, 0.3),
                        var.name = c('temperature', 'pH', 'concentration'))
  simplex &lt;- labsimplex(n = 3, usrdef = rbind(c(390, 8, 0.2), c(330, 8, 0.2),
                                   c(330, 6, 0.6), c(330, 6, 0.1)))
  ## Not run: 
    ## User defined coordinates may define a degenerated simplex:
    simplex &lt;- labsimplex(n = 3,
                          usrdef = rbind(c(390, 8, 0.3), c(340, 8, 0.3),
                                         c(355, 8, 0.3), c(340, 5, 0.1)))
  
## End(Not run)
</code></pre>

<hr>
<h2 id='labsimplex-package'><code>labsimplex</code>: Simplex Optimization Algorithms for Laboratory and
Manufacturing Processes</h2><span id='topic+labsimplex-package'></span>

<h3>Description</h3>

<p>The <code>labsimplex</code> package implements the simplex
optimization algorithms firstly proposed by Spendley et al. (1962)
&lt;doi:10.1080/00401706.1962.10490033&gt; and later modified by Nelder
and Mead (1965) &lt;doi:10.1093/comjnl/7.4.308&gt; for laboratory and
manufacturing processes. The package also provides tools for
graphical representation of the simplexes and some example response
surfaces that are useful for illustrating the optimization process.
</p>


<h3>Details</h3>

<p>A simplex is a geometric element defined as the simpler polytope possible
in an <em>n</em>-dimensional space. If the space has <em>n</em> dimensions,
the simplexes there will have <em>n+1</em> corners called vertexes.
The simplexes in two and three-dimensional spaces are the well-known
triangle and tetrahedron, respectively.<br />
In the simplex optimization algorithms, the experimental variables are
represented by the dimensions in the abstract space. Each vertex in the
simplex represents an experiment, then the coordinates of the vertex
represent the values for the variables in that experimental setting. The
experiments must be performed and a response must be assigned to each
vertex. In the optimization process, one of the vertexes is discarded in
favor of a new one that must be evaluated. In the first simplex, the vertex
with the worst response is discarded. The second worst vertex in this
simplex is discarded in the following simplex and the procedure is repeated
until the optimum is reached or a response good enough is obtained. The
process of discarding a vertex and generating a new one is known as a
movement of the simplex.<br />
In this document, the words vertex and experiment are used
interchangeably. The same applies to dimensions and experimental
variables. <br />
</p>


<h3><code>labsimplex</code> functions</h3>

<p>This package uses list objects of class <code>'smplx'</code> to store the
simplex information, including all the coordinates of the
vertexes and their responses.<br />
The <code>labsimplex</code> functions can generate a new <code>'smplx'</code> class
object, assing responses to the vertices to generate the next one and to
visualize different spatial representations of the <em>n</em>-dimensional
simplex in 2D or 3D projections. Detailed information can be found by
typing <code>vignette('labsimplex')</code>.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>References</h3>

<p>Nelder, J. A., and R. Mead. 1965. “A Simplex Method for Function
Minimization.” The Computer Journal 7 (4): 308–13.
</p>
<p>Spendley, W., G. R. Hext, and F. R0. Himsworth. 1962. “Sequential
Application of Simplex Designs in Optimization and Evolutionary Operation.”
Technometrics 4 (4): 441–61.
</p>

<hr>
<h2 id='plot.smplx'>Draws a two dimentional plot of the vertexes in a simplex</h2><span id='topic+plot.smplx'></span>

<h3>Description</h3>

<p>The function generates a 2D plot of the vertexes in a simplex optimization
when simplex dimensionality is at least 2. When dimensionality is higher
than 2, the plot produced is a projection of the selected variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'smplx'
plot(x, sel.dim = NULL, all.ver = TRUE, all.lin = TRUE,
  expand = TRUE, exp.fac = 1.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.smplx_+3A_x">x</code></td>
<td>
<p>object of class <code>smplx</code>.</p>
</td></tr>
<tr><td><code id="plot.smplx_+3A_sel.dim">sel.dim</code></td>
<td>
<p><code>numeric</code> or <code>char</code> vector for variables to be
considered when simplex dimensionality is higher than 2.
By default, the first two are chosen. If the vector is
<code>numeric</code>, it must contain the ordinal numbers
corresponding to the desired variables. If the vector is of
class <code>char</code>, it must contain the names of such
dimensions.</p>
</td></tr>
<tr><td><code id="plot.smplx_+3A_all.ver">all.ver</code></td>
<td>
<p>logical default to <code>TRUE</code>. Should all vertexes be
plotted? If <code>FALSE</code>, the function draws only the
vertexes of the current simplex.</p>
</td></tr>
<tr><td><code id="plot.smplx_+3A_all.lin">all.lin</code></td>
<td>
<p>logical default to <code>TRUE</code>. Should all lines be drawn?
If <code>FALSE</code>, the function draws only the lines of the
last simplex.</p>
</td></tr>
<tr><td><code id="plot.smplx_+3A_expand">expand</code></td>
<td>
<p>logical default to <code>TRUE</code>. Should the plot scales be
expanded?</p>
</td></tr>
<tr><td><code id="plot.smplx_+3A_exp.fac">exp.fac</code></td>
<td>
<p>expansion factor used when <code>expand = TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.smplx_+3A_...">...</code></td>
<td>
<p>other graphical parameters used in
<code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>For 3D representations of simplexes with dimensionality higher than 2 you
can use <code><a href="#topic+plotSimplex3D">plotSimplex3D</a></code>.
</p>


<h3>Value</h3>

<p>2D plot of the simplex coordinates.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotSimplex3D">plotSimplex3D</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  plot(x = labsimplex(n = 2, centroid = c(7, 340), stepsize = c(1.2, 15)))

  ## Several options are posible when visualizing higher order simplexes
  plot(x = labsimplex(n = 3))
  plot(x = labsimplex(n = 3), sel.dim = c(2, 3))

  ## Simplex movements can be visualized after some experiments has been
  ## performed
  simplex &lt;- exampleOptimization(surface = exampleSurfaceR2,
                                 centroid = c(7, 340),
                                 stepsize = c(1.2, 15), experiments = 16)
  plot(x = simplex)
</code></pre>

<hr>
<h2 id='plotSimplex3D'>Draws a three dimentional plot of the vertexes in a simplex</h2><span id='topic+plotSimplex3D'></span>

<h3>Description</h3>

<p>The function generates a 3D plot of the vertexes in a simplex optimization
when simplex dimensionality is at least 3. When dimensionality is higher
than 3, the plot produced is a projection of the selected variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSimplex3D(simplex, sel.dim = NULL, all.ver = TRUE, all.lin = TRUE,
  main = NULL, angle = 30, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSimplex3D_+3A_simplex">simplex</code></td>
<td>
<p>object of class <code>smplx</code> with the simplex
information. See <code><a href="#topic+labsimplex">labsimplex</a></code></p>
</td></tr>
<tr><td><code id="plotSimplex3D_+3A_sel.dim">sel.dim</code></td>
<td>
<p><code>numeric</code> or <code>char</code> vector for variables to be
considered when simplex dimensionality is higher than 3.
By default, the first three are chosen. If the vector is
<code>numeric</code>, it must contain the ordinal numbers
corresponding to the desired variables. If the vector is of
class <code>char</code>, it must contain the names of such
dimensions.</p>
</td></tr>
<tr><td><code id="plotSimplex3D_+3A_all.ver">all.ver</code></td>
<td>
<p>logical default to <code>TRUE</code>. Should all vertexes be
plotted? If <code>FALSE</code>, the function draws only the
vertexes of the current simplex.</p>
</td></tr>
<tr><td><code id="plotSimplex3D_+3A_all.lin">all.lin</code></td>
<td>
<p>logical default to <code>TRUE</code>. Should all lines be drawn?
If <code>FALSE</code>, the function draws only the lines of the
last simplex.</p>
</td></tr>
<tr><td><code id="plotSimplex3D_+3A_main">main</code></td>
<td>
<p>title for the plot.</p>
</td></tr>
<tr><td><code id="plotSimplex3D_+3A_angle">angle</code></td>
<td>
<p>angle for perspective between x and y axis.</p>
</td></tr>
<tr><td><code id="plotSimplex3D_+3A_...">...</code></td>
<td>
<p>other arguments passed to
<code><a href="scatterplot3d.html#topic+scatterplot3d">scatterplot3d</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>3D plot of the simplex coordinates.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.smplx">plot.smplx</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  plotSimplex3D(simplex = labsimplex(n = 3, centroid = c(350, 11, 0.7),
                                     stepsize = c(10, 0.5, 0.1),
                                     var.name = c('temperature', 'pH',
                                                  'concentration')))

  ## Several options are posible when visualizing higher order simplexes
  plotSimplex3D(simplex = labsimplex(n = 8))
  plotSimplex3D(simplex = labsimplex(n = 8), sel.dim = c(4, 6, 8))

  ## Simplex movements can be visualized after some experiments has been
  ## performed
  simplex &lt;- exampleOptimization(surface = exampleSurfaceR3,
                                 centroid = c(350, 11, 0.7),
                                 stepsize = c(10, 0.5, 0.1),
                                 experiments = 18)
  plotSimplex3D(simplex = simplex, angle = 80)
</code></pre>

<hr>
<h2 id='plotSimplexResponse'>Plots the response versus the vertex number of a simplex optimization.</h2><span id='topic+plotSimplexResponse'></span>

<h3>Description</h3>

<p>The function generates a <code>ggplot</code> object from an object with class
<code>smplx</code>. The response is plotted against the vertex number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSimplexResponse(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSimplexResponse_+3A_x">x</code></td>
<td>
<p>object with class <code>smplx</code> containig the coordinates of
the vertices and their responses.</p>
</td></tr>
<tr><td><code id="plotSimplexResponse_+3A_...">...</code></td>
<td>
<p>other graphical parameters used in <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the simplex object being ploted was obtained using a variable size
algorithm, some experimental points could be disregarded and will be
shown with a red mark indicating that the vertex was not used in the
obtention of new vertexes.
</p>


<h3>Value</h3>

<p>Plot of response against vertex number.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  simplex &lt;- exampleOptimization(surface = exampleSurfaceR3,
                                 centroid = c(350, 11, 0.7),
                                 stepsize = c(10, 0.5, 0.1),
                                 experiments = 18, algor = 'variable')
  plotSimplexResponse(simplex)
</code></pre>

<hr>
<h2 id='print.smplx'>S3 method <code>print</code> for simplex objects</h2><span id='topic+print.smplx'></span>

<h3>Description</h3>

<p>Prints simplex information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'smplx'
print(x, extended = FALSE, conventions = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.smplx_+3A_x">x</code></td>
<td>
<p>simplex (object of class to be printed</p>
</td></tr>
<tr><td><code id="print.smplx_+3A_extended">extended</code></td>
<td>
<p>logical, if <code>TRUE</code>, the object is printed as a
list containing all hiden elements</p>
</td></tr>
<tr><td><code id="print.smplx_+3A_conventions">conventions</code></td>
<td>
<p>logical, if <code>TRUE</code> (default), the conventions
used are printed</p>
</td></tr>
<tr><td><code id="print.smplx_+3A_...">...</code></td>
<td>
<p>more parameters passed to <code><a href="base.html#topic+print">print</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>

<hr>
<h2 id='prspctv'>3D perspective plot of example response surfaces</h2><span id='topic+prspctv'></span>

<h3>Description</h3>

<p>Plots a <code><a href="graphics.html#topic+persp">persp</a></code> plot of the bivariate
example response surfaces included in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prspctv(surface, length = 45, noise = 0, x1lim = c(278, 365),
  x2lim = c(0, 14), par = NULL, theta = 22, phi = 15, shade = 0.2,
  ticktype = "detailed", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prspctv_+3A_surface">surface</code></td>
<td>
<p>example response surface to use. See
<code><a href="#topic+exampleSurfaceR2">exampleSurfaceR2</a></code> and
<code><a href="#topic+exampleSurfaceR2.2pks">exampleSurfaceR2.2pks</a></code>.</p>
</td></tr>
<tr><td><code id="prspctv_+3A_length">length</code></td>
<td>
<p>number of levels to use in each explanatory variables</p>
</td></tr>
<tr><td><code id="prspctv_+3A_noise">noise</code></td>
<td>
<p>absolute noise to be included in the results</p>
</td></tr>
<tr><td><code id="prspctv_+3A_x1lim">x1lim</code></td>
<td>
<p>limits for the first variable (temperature in
<code><a href="#topic+exampleSurfaceR2">exampleSurfaceR2</a></code> and
<code><a href="#topic+exampleSurfaceR2.2pks">exampleSurfaceR2.2pks</a></code>)</p>
</td></tr>
<tr><td><code id="prspctv_+3A_x2lim">x2lim</code></td>
<td>
<p>limits for the second variable (pH in
<code><a href="#topic+exampleSurfaceR2">exampleSurfaceR2</a></code> and
<code><a href="#topic+exampleSurfaceR2.2pks">exampleSurfaceR2.2pks</a></code>)</p>
</td></tr>
<tr><td><code id="prspctv_+3A_par">par</code></td>
<td>
<p>list with graphical parameters (<code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
<tr><td><code id="prspctv_+3A_theta">theta</code></td>
<td>
<p>angles defining the viewing direction.
<code>theta</code> gives the azimuthal direction and <code>phi</code>
the colatitude.</p>
</td></tr>
<tr><td><code id="prspctv_+3A_phi">phi</code></td>
<td>
<p>angles defining the viewing direction.
<code>theta</code> gives the azimuthal direction and <code>phi</code>
the colatitude.</p>
</td></tr>
<tr><td><code id="prspctv_+3A_shade">shade</code></td>
<td>
<p>the shade at a surface facet is computed as
<code>((1+d)/2)^shade</code>, where <code>d</code> is the dot product of
a unit vector normal to the facet and a unit vector in the
direction of a light source.  Values of <code>shade</code> close
to one yield shading similar to a point light source model
and values close to zero produce no shading.  Values in the
range 0.5 to 0.75 provide an approximation to daylight
illumination.</p>
</td></tr>
<tr><td><code id="prspctv_+3A_ticktype">ticktype</code></td>
<td>
<p>character: <code>"simple"</code> draws just an arrow
parallel to the axis to indicate direction of increase;
<code>"detailed"</code> draws normal ticks as per 2D plots.</p>
</td></tr>
<tr><td><code id="prspctv_+3A_...">...</code></td>
<td>
<p>additional <a href="graphics.html#topic+graphical+20parameters">graphical parameters</a> (see <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  prspctv(surface = exampleSurfaceR2.2pks)
  prspctv(surface = exampleSurfaceR2.2pks, theta = 35, phi = 25,
          expand = 0.75, xlab = 'Temperature (K)', ylab = 'pH',
          zlab = 'Yield (%)')
</code></pre>

<hr>
<h2 id='simplexExport'>Exports the information contained in an object of class <code>smplx</code>.</h2><span id='topic+simplexExport'></span>

<h3>Description</h3>

<p>Creates a text file with extension <code>.smplx</code> that contains the complete
information contained in a simplex (an object with class <code>smplx</code>,
see <code><a href="#topic+labsimplex">labsimplex</a></code>). This file allows the continuation of an
optimization proccess when the experiments take too long and multiple
<code>R</code> sessions are required. The file produced is also useful to share
the information of the optimization process. The exported simplex can be
later imported with <code><a href="#topic+simplexImport">simplexImport</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simplexExport(simplex, filename = NULL, direc = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simplexExport_+3A_simplex">simplex</code></td>
<td>
<p>object of class <code>smplx</code> containing the simplex to be
exported</p>
</td></tr>
<tr><td><code id="simplexExport_+3A_filename">filename</code></td>
<td>
<p>string with the name (without extention) of the file that
will be created. If not provided, the name of the simplex
object is used.</p>
</td></tr>
<tr><td><code id="simplexExport_+3A_direc">direc</code></td>
<td>
<p>directory in which the file will be saved. If not provided,
the current working directory is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Generates a <code>.smplx</code> file containing all the information
required to continue with the optimization process after the
experiments have been carried.
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simplexImport">simplexImport</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  simplex &lt;- labsimplex(n = 5)
  simplexExport(simplex = simplex)
  
</code></pre>

<hr>
<h2 id='simplexImport'>Imports the information contained in a <code>.smplx</code> file.</h2><span id='topic+simplexImport'></span>

<h3>Description</h3>

<p>The function reads and (optionally) loads into the environment the simplex
(object of class <code>smplx</code>) contained in a <code>.smplx</code> file that was
previously created using <code><a href="#topic+simplexExport">simplexExport</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simplexImport(filename, aut.load = TRUE, name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simplexImport_+3A_filename">filename</code></td>
<td>
<p>string with the name of the file (without extension) to
be imported. This file must be generated using
<code><a href="#topic+simplexExport">simplexExport</a></code>. The path must be included if
the file is not in the current working directory.</p>
</td></tr>
<tr><td><code id="simplexImport_+3A_aut.load">aut.load</code></td>
<td>
<p>logical. Should the imported simplex object be directly
loaded on the Environment? Default to TRUE.</p>
</td></tr>
<tr><td><code id="simplexImport_+3A_name">name</code></td>
<td>
<p>name for the simplex object to be created if
<code>auth.ld = FALSE</code>. When not provided, the name of the
file is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>smplx</code> class object with the complete information of the
simplex
</p>


<h3>Author(s)</h3>

<p>Cristhian Paredes, <a href="mailto:craparedesca@unal.edu.co">craparedesca@unal.edu.co</a>
</p>
<p>Jesús Ágreda, <a href="mailto:jagreda@unal.edu.co">jagreda@unal.edu.co</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simplexImport">simplexImport</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  simplexR2 &lt;- exampleOptimization(surface = exampleSurfaceR2)
  simplexExport(simplex = simplexR2)
  rm(simplexR2)
  simplexImport(filename = "simplexR2")
  
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
