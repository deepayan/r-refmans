<!DOCTYPE html><html><head><title>Help for package RiskMap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RiskMap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anopheles'><p>Anopheles mosquitoes in Southern Cameroon</p></a></li>
<li><a href='#coef.RiskMap'><p>Extract Parameter Estimates from a &quot;RiskMap&quot; Model Fit</p></a></li>
<li><a href='#create_grid'><p>Create Grid of Points Within Shapefile</p></a></li>
<li><a href='#dist_summaries'><p>Summaries of the distances</p></a></li>
<li><a href='#galicia'><p>Heavy metal biomonitoring in Galicia</p></a></li>
<li><a href='#glgpm'><p>Estimation of Generalized Linear Gaussian Process Models</p></a></li>
<li><a href='#glgpm_sim'><p>Simulation from Generalized Linear Gaussian Process Models</p></a></li>
<li><a href='#gp'><p>Gaussian Process Model Specification</p></a></li>
<li><a href='#italy_sim'><p>Simulated data-set on the Italian peninsula</p></a></li>
<li><a href='#Laplace_sampling_MCMC'><p>Laplace Sampling Markov Chain Monte Carlo (MCMC) for Generalized Linear Gaussian Process Models</p></a></li>
<li><a href='#liberia'><p>River-blindness in Liberia</p></a></li>
<li><a href='#loaloa'><p>Loa loa prevalence data from 197 village surveys</p></a></li>
<li><a href='#malkenya'><p>Malaria Transmission in the Western Kenyan Highlands</p></a></li>
<li><a href='#malnutrition'><p>Malnutrition in Ghana</p></a></li>
<li><a href='#matern_cor'><p>Matern Correlation Function</p></a></li>
<li><a href='#matern.grad.phi'><p>First Derivative with Respect to <code class="reqn">\phi</code></p></a></li>
<li><a href='#matern.hessian.phi'><p>Second Derivative with Respect to <code class="reqn">\phi</code></p></a></li>
<li><a href='#maxim.integrand'><p>Maximization of the Integrand for Generalized Linear Gaussian Process Models</p></a></li>
<li><a href='#plot_s_variogram'><p>Plotting the empirical variogram</p></a></li>
<li><a href='#plot.RiskMap_pred_target_grid'><p>Plot Method for RiskMap_pred_target_grid Objects</p></a></li>
<li><a href='#plot.RiskMap_pred_target_shp'><p>Plot Method for RiskMap_pred_target_shp Objects</p></a></li>
<li><a href='#pred_over_grid'><p>Prediction of the random effects components and covariates effects over a spatial grid using a fitted generalized linear Gaussian process model</p></a></li>
<li><a href='#pred_target_grid'><p>Predictive Target Over a Regular Spatial Grid</p></a></li>
<li><a href='#pred_target_shp'><p>Predictive Target over a Shapefile</p></a></li>
<li><a href='#print.summary.RiskMap'><p>Print Summary of RiskMap Model</p></a></li>
<li><a href='#propose_utm'><p>EPSG of the UTM Zone</p></a></li>
<li><a href='#re'><p>Random Effect Model Specification</p></a></li>
<li><a href='#s_variogram'><p>Empirical variogram</p></a></li>
<li><a href='#set_control_sim'><p>Set Control Parameters for Simulation</p></a></li>
<li><a href='#summary.RiskMap'><p>Summarize Model Fits</p></a></li>
<li><a href='#to_table'><p>Create LaTeX Table from Model Fit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Geo-Statistical Modeling of Spatially Referenced Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for geo-statistical analysis of both continuous and count data using maximum likelihood methods. The models implemented in the package use stationary Gaussian processes with Matern correlation function to carry out spatial prediction in a geographical area of interest. The underpinning theory of the methods implemented in the package are found in Diggle and Giorgi (2019, ISBN: 978-1-138-06102-7).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://claudiofronterre.github.io/RiskMap/">https://claudiofronterre.github.io/RiskMap/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>sf, stats, methods, ggplot2, Matrix, maxLik, terra, xtable</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-24 19:38:38 UTC; giorgi</td>
</tr>
<tr>
<td>Author:</td>
<td>Emanuele Giorgi <a href="https://orcid.org/0000-0003-0640-181X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Claudio Fronterre <a href="https://orcid.org/0000-0001-6723-9727"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emanuele Giorgi &lt;e.giorgi@lancaster.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-25 14:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='anopheles'>Anopheles mosquitoes in Southern Cameroon</h2><span id='topic+anopheles'></span>

<h3>Description</h3>

<p>These data contain 116 georeferenced locations on the counts of Anopheles gambiae and
Anopheles coluzzii in Southern Cameroon.
</p>

<ul>
<li><p> web_x x-coordinate of the spatial locations.
</p>
</li>
<li><p> web_y y-coordinate of the spatial locations.
</p>
</li>
<li><p> Locality: name of the place of the sampled location.
</p>
</li>
<li><p> An.coluzzii: counts of Anopheles coluzzi.
</p>
</li>
<li><p> An.gambiae: counts of Anopheles gambiae.
</p>
</li>
<li><p> Total: total counts of Anopheles coluzzi and Anopheles gambiae.
</p>
</li>
<li><p> elevation: elevation in meters of the sampled location.
</p>
</li></ul>

<p>The coordinate reference system is 3857.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(anopheles)
</code></pre>


<h3>Format</h3>

<p>A data frame with 116 rows and 7 variables
</p>


<h3>Source</h3>

<p>Tene Fossog, B., Ayala, D., Acevedo, P., Kengne, P., Ngomo Abeso Mebuy,
I., Makanga, B., et al. (2015) Habitat segregation and ecological character displacement in cryptic African malaria
mosquitoes. Evolutionary Applications, 8 (4), 326-345.
</p>

<hr>
<h2 id='coef.RiskMap'>Extract Parameter Estimates from a &quot;RiskMap&quot; Model Fit</h2><span id='topic+coef.RiskMap'></span>

<h3>Description</h3>

<p>This <code>coef</code> method for the &quot;RiskMap&quot; class extracts the
maximum likelihood estimates from model fits obtained from the <code><a href="#topic+glgpm">glgpm</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RiskMap'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.RiskMap_+3A_object">object</code></td>
<td>
<p>An object of class &quot;RiskMap&quot; obtained as a result of a call to <code><a href="#topic+glgpm">glgpm</a></code>.</p>
</td></tr>
<tr><td><code id="coef.RiskMap_+3A_...">...</code></td>
<td>
<p>other parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function processes the <code>RiskMap</code> object to extract and name the estimated parameters appropriately, transforming them if necessary.
</p>


<h3>Value</h3>

<p>A list containing the maximum likelihood estimates:
</p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>A vector of coefficient estimates.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>The estimate for the variance parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>The estimate for the spatial range parameter <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p>The estimate for the nugget effect parameter <code class="reqn">\tau^2</code>, if applicable.</p>
</td></tr>
<tr><td><code>sigma2_me</code></td>
<td>
<p>The estimate for the measurement error variance <code class="reqn">\sigma^2_{me}</code>, if applicable.</p>
</td></tr>
<tr><td><code>sigma2_re</code></td>
<td>
<p>A vector of variance estimates for the random effects, if applicable.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function handles both Gaussian and non-Gaussian families, and accounts for fixed and random effects in the model.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glgpm">glgpm</a></code>
</p>

<hr>
<h2 id='create_grid'>Create Grid of Points Within Shapefile</h2><span id='topic+create_grid'></span>

<h3>Description</h3>

<p>Generates a grid of points within a given shapefile. The grid points are created based on a specified spatial resolution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_grid(shp, spat_res, grid_crs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_grid_+3A_shp">shp</code></td>
<td>
<p>An object of class 'sf' representing the shapefile within which the grid of points will be created.</p>
</td></tr>
<tr><td><code id="create_grid_+3A_spat_res">spat_res</code></td>
<td>
<p>Numeric value specifying the spatial resolution in kilometers for the grid.</p>
</td></tr>
<tr><td><code id="create_grid_+3A_grid_crs">grid_crs</code></td>
<td>
<p>Coordinate reference system for the grid. If NULL, the CRS of 'shp' is used. The shapefile 'shp' will be transformed to this CRS if specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a grid of points within the boundaries of the provided shapefile ('shp'). The grid points are generated using the specified spatial resolution ('spat_res'). If a coordinate reference system ('grid_crs') is provided, the shapefile is transformed to this CRS before creating the grid.
</p>


<h3>Value</h3>

<p>An 'sf' object containing the generated grid points within the shapefile.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="sf.html#topic+st_make_grid">st_make_grid</a></code>, <code><a href="sf.html#topic+st_intersects">st_intersects</a></code>, <code><a href="sf.html#topic+st_transform">st_transform</a></code>, <code><a href="sf.html#topic+st_crs">st_crs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(sf)

# Example shapefile data
nc &lt;- st_read(system.file("shape/nc.shp", package="sf"))

# Create grid with 10 km spatial resolution
grid &lt;- create_grid(nc, spat_res = 10)

# Plot the grid
plot(st_geometry(nc))
plot(grid, add = TRUE, col = 'red')

</code></pre>

<hr>
<h2 id='dist_summaries'>Summaries of the distances</h2><span id='topic+dist_summaries'></span>

<h3>Description</h3>

<p>Computes the distances between the locations in the data-set and returns summary statistics of these.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist_summaries(data, convert_to_utm = TRUE, scale_to_km = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist_summaries_+3A_data">data</code></td>
<td>
<p>an object of class <code>sf</code> containing the variable for which the variogram
is to be computed and the coordinates</p>
</td></tr>
<tr><td><code id="dist_summaries_+3A_convert_to_utm">convert_to_utm</code></td>
<td>
<p>a logical value, indicating if the conversion to UTM shuold be performed (<code>convert_to_utm = TRUE</code>) or
the coordinate reference system of the data must be used without any conversion (<code>convert_to_utm = FALSE</code>).
By default <code>convert_to_utm = TRUE</code>. Note: if <code>convert_to_utm = TRUE</code> the conversion to UTM is performed using
the epsg provided by <code><a href="#topic+propose_utm">propose_utm</a></code>.</p>
</td></tr>
<tr><td><code id="dist_summaries_+3A_scale_to_km">scale_to_km</code></td>
<td>
<p>a logical value, indicating if the distances used in the variogram must be scaled
to kilometers (<code>scale_to_km = TRUE</code>) or left in meters (<code>scale_to_km = FALSE</code>).
By default <code>scale_to_km = FALSE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the following components
</p>
<p><code>min</code> the minimum distance
</p>
<p><code>max</code> the maximum distance
</p>
<p><code>mean</code> the mean distance
</p>
<p><code>median</code> the minimum distance
</p>

<hr>
<h2 id='galicia'>Heavy metal biomonitoring in Galicia</h2><span id='topic+galicia'></span>

<h3>Description</h3>

<p>This data-set relates to two studies on lead concentration
in moss samples, in micrograms per gram dry weight, collected in Galicia, norther Spain. The data are from two surveys, one conducted in July 2000.
The variables are as follows:
</p>

<ul>
<li><p> x x-coordinate of the spatial locations.
</p>
</li>
<li><p> y y-coordinate of the spatial locations.
</p>
</li>
<li><p> lead number of tested people for the presence nodules.
</p>
</li></ul>

<p>The coordinate reference system of the data is 32629.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(galicia)
</code></pre>


<h3>Format</h3>

<p>A data frame with 195 rows and 4 variables
</p>


<h3>Source</h3>

<p>Diggle, P.J., Menezes, R. and Su, T.-L. (2010).
Geostatistical analysis under preferential sampling (with Discussion).
Applied Statistics, 59, 191-232.
</p>

<hr>
<h2 id='glgpm'>Estimation of Generalized Linear Gaussian Process Models</h2><span id='topic+glgpm'></span>

<h3>Description</h3>

<p>Fits generalized linear Gaussian process models to spatial data, incorporating spatial Gaussian processes with a Matern correlation function. Supports Gaussian, binomial, and Poisson response families.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glgpm(
  formula,
  data,
  family,
  distr_offset = NULL,
  cov_offset = NULL,
  crs = NULL,
  convert_to_crs = NULL,
  scale_to_km = TRUE,
  control_mcmc = set_control_sim(),
  par0 = NULL,
  S_samples = NULL,
  return_samples = TRUE,
  messages = TRUE,
  fix_var_me = NULL,
  start_pars = list(beta = NULL, sigma2 = NULL, tau2 = NULL, phi = NULL, sigma2_me =
    NULL, sigma2_re = NULL)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glgpm_+3A_formula">formula</code></td>
<td>
<p>A formula object specifying the model to be fitted. The formula should include fixed effects, random effects (specified using <code>re()</code>), and spatial effects (specified using <code>gp()</code>).</p>
</td></tr>
<tr><td><code id="glgpm_+3A_data">data</code></td>
<td>
<p>A data frame or sf object containing the variables in the model.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_family">family</code></td>
<td>
<p>A character string specifying the distribution of the response variable. Must be one of &quot;gaussian&quot;, &quot;binomial&quot;, or &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_distr_offset">distr_offset</code></td>
<td>
<p>Optional offset for binomial or Poisson distributions. If not provided, defaults to 1 for binomial.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_cov_offset">cov_offset</code></td>
<td>
<p>Optional numeric vector for covariate offset.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_crs">crs</code></td>
<td>
<p>Optional integer specifying the Coordinate Reference System (CRS) if data is not an sf object. Defaults to 4326 (long/lat).</p>
</td></tr>
<tr><td><code id="glgpm_+3A_convert_to_crs">convert_to_crs</code></td>
<td>
<p>Optional integer specifying a CRS to convert the spatial coordinates.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_scale_to_km">scale_to_km</code></td>
<td>
<p>Logical indicating whether to scale coordinates to kilometers. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_control_mcmc">control_mcmc</code></td>
<td>
<p>Control parameters for MCMC sampling. Must be an object of class &quot;mcmc.RiskMap&quot; as returned by <code><a href="#topic+set_control_sim">set_control_sim</a></code>.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_par0">par0</code></td>
<td>
<p>Optional list of initial parameter values for the MCMC algorithm.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_s_samples">S_samples</code></td>
<td>
<p>Optional matrix of pre-specified sample paths for the spatial random effect.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_return_samples">return_samples</code></td>
<td>
<p>Logical indicating whether to return MCMC samples when fitting a Binomial or Poisson model. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_messages">messages</code></td>
<td>
<p>Logical indicating whether to print progress messages. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_fix_var_me">fix_var_me</code></td>
<td>
<p>Optional fixed value for the measurement error variance.</p>
</td></tr>
<tr><td><code id="glgpm_+3A_start_pars">start_pars</code></td>
<td>
<p>Optional list of starting values for model parameters: beta (regression coefficients), sigma2 (spatial process variance), tau2 (nugget effect variance), phi (spatial correlation scale), sigma2_me (measurement error variance), and sigma2_re (random effects variances).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generalized linear Gaussian process models extend generalized linear models (GLMs) by incorporating spatial Gaussian processes to account for spatial correlation in the data. This function fits GLGPMs using maximum likelihood methods, allowing for Gaussian, binomial, and Poisson response families.
In the case of the Binomial and Poisson families, a Monte Carlo maximum likelihood algorithm is used.
</p>
<p>The spatial Gaussian process is modeled with a Matern correlation function, which is flexible and commonly used in geostatistical modeling. The function supports both spatial covariates and unstructured random effects, providing a comprehensive framework to analyze spatially correlated data across different response distributions.
</p>
<p>Additionally, the function allows for the inclusion of unstructured random effects, specified through the <code>re()</code> term in the model formula. These random effects can capture unexplained variability at specific locations beyond the fixed and spatial covariate effects, enhancing the model's flexibility in capturing complex spatial patterns.
</p>
<p>The <code>convert_to_crs</code> argument can be used to reproject the spatial coordinates to a different CRS. The <code>scale_to_km</code> argument scales the coordinates to kilometers if set to TRUE.
</p>
<p>The <code>control_mcmc</code> argument specifies the control parameters for MCMC sampling. This argument must be an object returned by <code><a href="#topic+set_control_sim">set_control_sim</a></code>.
</p>
<p>The <code>start_pars</code> argument allows for specifying starting values for the model parameters. If not provided, default starting values are used.
</p>


<h3>Value</h3>

<p>An object of class &quot;RiskMap&quot; containing the fitted model and relevant information:
</p>
<table>
<tr><td><code>y</code></td>
<td>
<p>Response variable.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>Covariate matrix.</p>
</td></tr>
<tr><td><code>coords</code></td>
<td>
<p>Unique spatial coordinates.</p>
</td></tr>
<tr><td><code>ID_coords</code></td>
<td>
<p>Index of coordinates.</p>
</td></tr>
<tr><td><code>re</code></td>
<td>
<p>Random effects.</p>
</td></tr>
<tr><td><code>ID_re</code></td>
<td>
<p>Index of random effects.</p>
</td></tr>
<tr><td><code>fix_tau2</code></td>
<td>
<p>Fixed nugget effect variance.</p>
</td></tr>
<tr><td><code>fix_var_me</code></td>
<td>
<p>Fixed measurement error variance.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>Model formula.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>Response family.</p>
</td></tr>
<tr><td><code>crs</code></td>
<td>
<p>Coordinate Reference System.</p>
</td></tr>
<tr><td><code>scale_to_km</code></td>
<td>
<p>Indicator if coordinates are scaled to kilometers.</p>
</td></tr>
<tr><td><code>data_sf</code></td>
<td>
<p>Original data as an sf object.</p>
</td></tr>
<tr><td><code>kappa</code></td>
<td>
<p>Spatial correlation parameter.</p>
</td></tr>
<tr><td><code>units_m</code></td>
<td>
<p>Distribution offset for binomial/Poisson.</p>
</td></tr>
<tr><td><code>cov_offset</code></td>
<td>
<p>Covariate offset.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Matched call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+set_control_sim">set_control_sim</a></code>, <code><a href="#topic+summary.RiskMap">summary.RiskMap</a></code>, <code><a href="#topic+to_table">to_table</a></code>
</p>

<hr>
<h2 id='glgpm_sim'>Simulation from Generalized Linear Gaussian Process Models</h2><span id='topic+glgpm_sim'></span>

<h3>Description</h3>

<p>Simulates data from a fitted Generalized Linear Gaussian Process Model (GLGPM) or a specified model formula and data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glgpm_sim(
  n_sim,
  model_fit = NULL,
  formula = NULL,
  data = NULL,
  family = NULL,
  distr_offset = NULL,
  cov_offset = NULL,
  crs = NULL,
  convert_to_crs = NULL,
  scale_to_km = TRUE,
  control_mcmc = NULL,
  sim_pars = list(beta = NULL, sigma2 = NULL, tau2 = NULL, phi = NULL, sigma2_me = NULL,
    sigma2_re = NULL),
  messages = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glgpm_sim_+3A_n_sim">n_sim</code></td>
<td>
<p>Number of simulations to perform.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_model_fit">model_fit</code></td>
<td>
<p>Fitted GLGPM model object of class 'RiskMap'. If provided, overrides 'formula', 'data', 'family', 'crs', 'convert_to_crs', 'scale_to_km', and 'control_mcmc' arguments.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_formula">formula</code></td>
<td>
<p>Model formula indicating the variables of the model to be simulated.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_data">data</code></td>
<td>
<p>Data frame or 'sf' object containing the variables in the model formula.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_family">family</code></td>
<td>
<p>Distribution family for the response variable. Must be one of 'gaussian', 'binomial', or 'poisson'.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_distr_offset">distr_offset</code></td>
<td>
<p>Offset for the distributional part of the GLGPM. Required for 'binomial' and 'poisson' families.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_cov_offset">cov_offset</code></td>
<td>
<p>Offset for the covariate part of the GLGPM.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_crs">crs</code></td>
<td>
<p>Coordinate reference system (CRS) code for spatial data.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_convert_to_crs">convert_to_crs</code></td>
<td>
<p>CRS code to convert spatial data if different from 'crs'.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_scale_to_km">scale_to_km</code></td>
<td>
<p>Logical; if TRUE, distances between locations are computed in kilometers; if FALSE, in meters.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_control_mcmc">control_mcmc</code></td>
<td>
<p>Control parameters for MCMC simulation if applicable.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_sim_pars">sim_pars</code></td>
<td>
<p>List of simulation parameters including 'beta', 'sigma2', 'tau2', 'phi', 'sigma2_me', and 'sigma2_re'.</p>
</td></tr>
<tr><td><code id="glgpm_sim_+3A_messages">messages</code></td>
<td>
<p>Logical; if TRUE, display progress and informative messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generalized Linear Gaussian Process Models (GLGPMs) extend generalized linear models (GLMs) by incorporating spatial Gaussian processes to model spatial correlation. This function simulates data from GLGPMs using Markov Chain Monte Carlo (MCMC) methods. It supports Gaussian, binomial, and Poisson response families, utilizing a Matern correlation function to model spatial dependence.
</p>
<p>The simulation process involves generating spatially correlated random effects and simulating responses based on the fitted or specified model parameters. For 'gaussian' family, the function simulates response values by adding measurement error.
</p>
<p>Additionally, GLGPMs can incorporate unstructured random effects specified through the <code>re()</code> term in the model formula, allowing for capturing additional variability beyond fixed and spatial covariate effects.
</p>


<h3>Value</h3>

<p>A list containing simulated data, simulated spatial random effects (if applicable), and other simulation parameters.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='gp'>Gaussian Process Model Specification</h2><span id='topic+gp'></span>

<h3>Description</h3>

<p>Specifies the terms, smoothness, and nugget effect for a Gaussian Process (GP) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gp(..., kappa = 0.5, nugget = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gp_+3A_...">...</code></td>
<td>
<p>Variables representing the spatial coordinates or covariates for the GP model.</p>
</td></tr>
<tr><td><code id="gp_+3A_kappa">kappa</code></td>
<td>
<p>The smoothness parameter <code class="reqn">\kappa</code>. Default is 0.5.</p>
</td></tr>
<tr><td><code id="gp_+3A_nugget">nugget</code></td>
<td>
<p>The nugget effect, which represents the variance of the measurement error. Default is 0. A positive numeric value must be provided if not using the default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function constructs a list that includes the specified terms (spatial coordinates or covariates), the smoothness parameter <code class="reqn">\kappa</code>, and the nugget effect. This list can be used as a specification for a Gaussian Process model.
</p>


<h3>Value</h3>

<p>A list of class <code>gp.spec</code> containing the following elements:
</p>
<table>
<tr><td><code>term</code></td>
<td>
<p>A character vector of the specified terms.</p>
</td></tr>
<tr><td><code>kappa</code></td>
<td>
<p>The smoothness parameter <code class="reqn">\kappa</code>.</p>
</td></tr>
<tr><td><code>nugget</code></td>
<td>
<p>The nugget effect.</p>
</td></tr>
<tr><td><code>dim</code></td>
<td>
<p>The number of specified terms.</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>A character string representing the full call for the GP model.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The nugget effect must be a positive real number if specified.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='italy_sim'>Simulated data-set on the Italian peninsula</h2><span id='topic+italy_sim'></span>

<h3>Description</h3>

<p>This is a simulated data-set over Italy for a continuous outcome.
The data-set contains 10 repeated observations for each of the 200 geo-referenced locations.
The variables are as follows:
</p>

<ul>
<li><p> x1 ordinate of the spatial locations.
</p>
</li>
<li><p> x2 abscissa of the spatial locations.
</p>
</li>
<li><p> y simulated continuous outcome.
</p>
</li>
<li><p> region the name of the region within which a given observation falls.
</p>
</li>
<li><p> province the name of the province within which a given observation falls.
</p>
</li>
<li><p> pop_dens the population density at the location of the observation.
</p>
</li>
<li><p> ID_loc an ID identifying the location to which the observation belong.
</p>
</li></ul>

<p>The coordinate reference system of the data is 32634.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(italy_sim)
</code></pre>


<h3>Format</h3>

<p>A data frame with 2000 rows and 7 variables
</p>

<hr>
<h2 id='Laplace_sampling_MCMC'>Laplace Sampling Markov Chain Monte Carlo (MCMC) for Generalized Linear Gaussian Process Models</h2><span id='topic+Laplace_sampling_MCMC'></span>

<h3>Description</h3>

<p>Performs MCMC sampling using Laplace approximation for Generalized Linear Gaussian Process Models (GLGPMs).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Laplace_sampling_MCMC(
  y,
  units_m,
  mu,
  Sigma,
  ID_coords,
  ID_re = NULL,
  sigma2_re = NULL,
  family,
  control_mcmc,
  Sigma_pd = NULL,
  mean_pd = NULL,
  messages = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Laplace_sampling_MCMC_+3A_y">y</code></td>
<td>
<p>Response variable vector.</p>
</td></tr>
<tr><td><code id="Laplace_sampling_MCMC_+3A_units_m">units_m</code></td>
<td>
<p>Units of measurement for the response variable.</p>
</td></tr>
<tr><td><code id="Laplace_sampling_MCMC_+3A_mu">mu</code></td>
<td>
<p>Mean vector of the response variable.</p>
</td></tr>
<tr><td><code id="Laplace_sampling_MCMC_+3A_sigma">Sigma</code></td>
<td>
<p>Covariance matrix of the spatial process.</p>
</td></tr>
<tr><td><code id="Laplace_sampling_MCMC_+3A_id_coords">ID_coords</code></td>
<td>
<p>Indices mapping response to locations.</p>
</td></tr>
<tr><td><code id="Laplace_sampling_MCMC_+3A_id_re">ID_re</code></td>
<td>
<p>Indices mapping response to unstructured random effects.</p>
</td></tr>
<tr><td><code id="Laplace_sampling_MCMC_+3A_sigma2_re">sigma2_re</code></td>
<td>
<p>Variance of the unstructured random effects.</p>
</td></tr>
<tr><td><code id="Laplace_sampling_MCMC_+3A_family">family</code></td>
<td>
<p>Distribution family for the response variable. Must be one of 'gaussian', 'binomial', or 'poisson'.</p>
</td></tr>
<tr><td><code id="Laplace_sampling_MCMC_+3A_control_mcmc">control_mcmc</code></td>
<td>
<p>List with control parameters for the MCMC algorithm:
</p>

<dl>
<dt>n_sim</dt><dd><p>Number of MCMC iterations.</p>
</dd>
<dt>burnin</dt><dd><p>Number of burn-in iterations.</p>
</dd>
<dt>thin</dt><dd><p>Thinning parameter for saving samples.</p>
</dd>
<dt>h</dt><dd><p>Step size for proposal distribution. Defaults to 1.65/(n_tot^(1/6)).</p>
</dd>
<dt>c1.h, c2.h</dt><dd><p>Parameters for adaptive step size tuning.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="Laplace_sampling_MCMC_+3A_sigma_pd">Sigma_pd</code></td>
<td>
<p>Precision matrix (optional) for Laplace approximation.</p>
</td></tr>
<tr><td><code id="Laplace_sampling_MCMC_+3A_mean_pd">mean_pd</code></td>
<td>
<p>Mean vector (optional) for Laplace approximation.</p>
</td></tr>
<tr><td><code id="Laplace_sampling_MCMC_+3A_messages">messages</code></td>
<td>
<p>Logical; if TRUE, print progress messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements a Laplace sampling MCMC approach for GLGPMs. It maximizes the integrand using 'maxim.integrand' function for Laplace approximation if 'Sigma_pd' and 'mean_pd' are not provided.
</p>
<p>The MCMC procedure involves adaptive step size adjustment based on the acceptance probability ('acc_prob') and uses a Gaussian proposal distribution centered on the current mean ('mean_curr') with variance 'h'.
</p>


<h3>Value</h3>

<p>An object of class &quot;mcmc.RiskMap&quot; containing:
</p>

<dl>
<dt>samples$S</dt><dd><p>Samples of the spatial process.</p>
</dd>
<dt>samples$&lt;re_names[i]&gt;</dt><dd><p>Samples of each unstructured random effect, named according to columns of ID_re if provided.</p>
</dd>
<dt>tuning_par</dt><dd><p>Vector of step size (h) values used during MCMC iterations.</p>
</dd>
<dt>acceptance_prob</dt><dd><p>Vector of acceptance probabilities across MCMC iterations.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='liberia'>River-blindness in Liberia</h2><span id='topic+liberia'></span>

<h3>Description</h3>

<p>This data-set contains counts of reported onchocerciasis (or riverblindess)
cases from 91 villages sampled across Liberia.
The variables are as follows:
</p>

<ul>
<li><p> lat latitude of the of sampled villages.
</p>
</li>
<li><p> long longitude of the sampled villages.
</p>
</li>
<li><p> ntest number of tested people for the presence nodules.
</p>
</li>
<li><p> npos number of people that tested positive for the presence of nodules.
</p>
</li>
<li><p> elevation the elevation in meters of the sampled village.
</p>
</li>
<li><p> log_elevation the log-transformed elevation in meters of the sampled village.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(liberia)
</code></pre>


<h3>Format</h3>

<p>A data frame with 90 rows and 6 variables
</p>


<h3>Source</h3>

<p>Zouré, H. G. M., Noma, M., Tekle, Afework, H., Amazigo, U. V., Diggle, P. J., Giorgi, E., and Remme, J. H. F. (2014). The Geographic Distribution of Onchocerciasis in the 20 Participating Countries of the African Programme for Onchocerciasis Control: (2) Pre-Control Endemicity Levels and Estimated Number Infected.
Parasites &amp; Vectors, 7, 326.
</p>

<hr>
<h2 id='loaloa'>Loa loa prevalence data from 197 village surveys</h2><span id='topic+loaloa'></span>

<h3>Description</h3>

<p>This data-set relates to a study of the prevalence of Loa loa (eyeworm) in a series of surveys undertaken in 197 villages in west Africa (Cameroon and southern Nigeria).
The variables are as follows:
</p>

<ul>
<li><p> ROW row id: 1 to 197.
</p>
</li>
<li><p> VILLCODE village id. 
</p>
</li>
<li><p> LONGITUDE Longitude in degrees.
</p>
</li>
<li><p> LATITUDE Latitude in degrees.
</p>
</li>
<li><p> NO_EXAM Number of people tested.
</p>
</li>
<li><p> NO_INF Number of positive test results.
</p>
</li>
<li><p> ELEVATION Height above sea-level in metres.
</p>
</li>
<li><p> MEAN9901 Mean of all NDVI values recorded at village location, 1999-2001
</p>
</li>
<li><p> MAX9901 Maximum of all NDVI values recorded at village location, 1999-2001
</p>
</li>
<li><p> MIN9901 Minimum of all NDVI values recorded at village location, 1999-2001
</p>
</li>
<li><p> MIN9901 Minimum of all NDVI values recorded at village location, 1999-2001
</p>
</li>
<li><p> STDEV9901 standard deviation of all NDVI values recorded at village location, 1999-2001
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(loaloa)
</code></pre>


<h3>Format</h3>

<p>A data frame with 197 rows and 11 variables
</p>


<h3>References</h3>

<p>Diggle, P.J., Thomson, M.C., Christensen, O.F., Rowlingson, B., Obsomer, V., Gardon, J., Wanji, S., Takougang, I., Enyong, P., Kamgno, J., Remme, H., Boussinesq, M. and Molyneux, D.H. (2007). Spatial modelling and prediction of Loa loa risk: decision making under uncertainty. Annals of Tropical Medicine and Parasitology, 101, 499-509.
</p>

<hr>
<h2 id='malkenya'>Malaria Transmission in the Western Kenyan Highlands</h2><span id='topic+malkenya'></span>

<h3>Description</h3>

<p>The dataset contains information on 82014 individuals enrolled
in concurrent school and community cross-sectional surveys, conducted in 46
school clusters in the western Kenyan highlands. Malaria was assessed by
rapid diagnostic test (RDT).
</p>
<p>The variables are as follows:
</p>

<ul>
<li><p> Cluster: unique ID for each of the 46 school clusters.
</p>
</li>
<li><p> Long: longitude coordinate of the household location.
</p>
</li>
<li><p> Lat: latitude coordinate of the household location.
</p>
</li>
<li><p> RDT: binary variable indicating the outcome of the RDT:
1, if positive, and 0, if negative.
</p>
</li>
<li><p> Gender: factor variable indicating the gender of the sampled individual.
</p>
</li>
<li><p> Age: age in years of the sampled individual.
</p>
</li>
<li><p> NetUse: binary variable indicating whether the sampled individual
slept under a bed net the previous night: 1, if yes, 0, if no.
</p>
</li>
<li><p> MosqCntl: binary variable indicating whether the household has used some kind
of mosquito control, such as sprays and coils: 1, if yes, 0, if no.
</p>
</li>
<li><p> IRS: binary variables in indicating whether there has been indoor
residual spraying (IRS) in the house in the last 12 months: 1, if yes, 0,
if no.
</p>
</li>
<li><p> Travel:  binary variable indicating whether the sampled individual
has traveled outside the village in the last three months: 1, if yes, 0,
if no.
</p>
</li>
<li><p> SES: ordinal variable indicating the socio-economic status (SES) of
the household. The variables is an integer score from 1(=poor) to 5(=rich).
</p>
</li>
<li><p> District: factor variable indicating the village of the sampled
individual, &quot;Kisii Central&quot; or &quot;Rachuonyo&quot;.
</p>
</li>
<li><p> Survey: factor variable indicating the survey in which the
participant was enrolled, &quot;community&quot; or &quot;school&quot;.
</p>
</li>
<li><p> elevation: elevation, in meters, of the recorded household location
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(malkenya)
</code></pre>


<h3>Format</h3>

<p>A data frame with 82014 rows and 13 variables
</p>


<h3>Source</h3>

<p>Stevenson, J.C., Stresman, G.H., Gitonga, C.W., Gillig, J.,
Owaga, C., et al. (2013). Reliability of School Surveys in Estimating Geographic
Variation in Malaria Transmission in the Western Kenyan Highlands.
PLOS ONE 8(10): e77641. doi: 10.1371/journal.pone.0077641
</p>

<hr>
<h2 id='malnutrition'>Malnutrition in Ghana</h2><span id='topic+malnutrition'></span>

<h3>Description</h3>

<p>This geostatistical dataset was extracted from the Demographic and Health Survey 2014 conducted in Ghana.
</p>

<ul>
<li><p> lng Longitude of the sampling cluster.
</p>
</li>
<li><p> lat Latitude of the sampling cluster.
</p>
</li>
<li><p> age age in months of the child.
</p>
</li>
<li><p> sex sex of the child.
</p>
</li>
<li><p> HAZ height-for-age Z-score.
</p>
</li>
<li><p> WAZ weight-for-age Z-score
</p>
</li>
<li><p> urb binary indicator: urban area=1; rural area=0.
</p>
</li>
<li><p> etn ethnic group.
</p>
</li>
<li><p> edu level of education of the mother, which takes integer values from 1=&quot;Poorly educated&quot; to 3=&quot;Highly educated&quot;.
</p>
</li>
<li><p> wealth wealth score of the household, which takes integer values from 1=&quot;Poor&quot; to 3=&quot;Rich&quot;.
</p>
</li></ul>

<p>The coordinate reference system is 3857.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(malnutrition)
</code></pre>


<h3>Format</h3>

<p>A data frame with 2671 rows and 10 variables
</p>


<h3>Source</h3>

<p>Demographic and Health Survey, dhsprogram.com
</p>

<hr>
<h2 id='matern_cor'>Matern Correlation Function</h2><span id='topic+matern_cor'></span>

<h3>Description</h3>

<p>Computes the Matern correlation function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matern_cor(u, phi, kappa, return_sym_matrix = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matern_cor_+3A_u">u</code></td>
<td>
<p>A vector of distances between pairs of data locations.</p>
</td></tr>
<tr><td><code id="matern_cor_+3A_phi">phi</code></td>
<td>
<p>The scale parameter <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code id="matern_cor_+3A_kappa">kappa</code></td>
<td>
<p>The smoothness parameter <code class="reqn">\kappa</code>.</p>
</td></tr>
<tr><td><code id="matern_cor_+3A_return_sym_matrix">return_sym_matrix</code></td>
<td>
<p>A logical value indicating whether to return a symmetric correlation matrix. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Matern correlation function is defined as
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>u</code> with the values of the Matern correlation function for the given distances, if <code>return_sym_matrix=FALSE</code>. If <code>return_sym_matrix=TRUE</code>, a symmetric correlation matrix is returned.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>
<p style="text-align: center;"><code class="reqn">\rho(u; \phi; \kappa) = (2^{\kappa-1})^{-1}(u/\phi)^\kappa K_{\kappa}(u/\phi)</code>
</p>

<p>where <code class="reqn">\phi</code> and <code class="reqn">\kappa</code> are the scale and smoothness parameters, and <code class="reqn">K_{\kappa}(\cdot)</code> denotes the modified Bessel function of the third kind of order <code class="reqn">\kappa</code>. The parameters <code class="reqn">\phi</code> and <code class="reqn">\kappa</code> must be positive.
</p>

<hr>
<h2 id='matern.grad.phi'>First Derivative with Respect to <code class="reqn">\phi</code></h2><span id='topic+matern.grad.phi'></span>

<h3>Description</h3>

<p>Computes the first derivative of the Matern correlation function with respect to <code class="reqn">\phi</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matern.grad.phi(U, phi, kappa)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matern.grad.phi_+3A_u">U</code></td>
<td>
<p>A vector of distances between pairs of data locations.</p>
</td></tr>
<tr><td><code id="matern.grad.phi_+3A_phi">phi</code></td>
<td>
<p>The scale parameter <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code id="matern.grad.phi_+3A_kappa">kappa</code></td>
<td>
<p>The smoothness parameter <code class="reqn">\kappa</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the values of the first derivative of the Matern function with respect to <code class="reqn">\phi</code> for the given distances.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='matern.hessian.phi'>Second Derivative with Respect to <code class="reqn">\phi</code></h2><span id='topic+matern.hessian.phi'></span>

<h3>Description</h3>

<p>Computes the second derivative of the Matern correlation function with respect to <code class="reqn">\phi</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matern.hessian.phi(U, phi, kappa)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matern.hessian.phi_+3A_u">U</code></td>
<td>
<p>A vector of distances between pairs of data locations.</p>
</td></tr>
<tr><td><code id="matern.hessian.phi_+3A_phi">phi</code></td>
<td>
<p>The scale parameter <code class="reqn">\phi</code>.</p>
</td></tr>
<tr><td><code id="matern.hessian.phi_+3A_kappa">kappa</code></td>
<td>
<p>The smoothness parameter <code class="reqn">\kappa</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the values of the second derivative of the Matern function with respect to <code class="reqn">\phi</code> for the given distances.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='maxim.integrand'>Maximization of the Integrand for Generalized Linear Gaussian Process Models</h2><span id='topic+maxim.integrand'></span>

<h3>Description</h3>

<p>Maximizes the integrand function for Generalized Linear Gaussian Process Models (GLGPMs), which involves the evaluation of likelihood functions with spatially correlated random effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxim.integrand(
  y,
  units_m,
  mu,
  Sigma,
  ID_coords,
  ID_re = NULL,
  family,
  sigma2_re = NULL,
  hessian = FALSE,
  gradient = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxim.integrand_+3A_y">y</code></td>
<td>
<p>Response variable vector.</p>
</td></tr>
<tr><td><code id="maxim.integrand_+3A_units_m">units_m</code></td>
<td>
<p>Units of measurement for the response variable.</p>
</td></tr>
<tr><td><code id="maxim.integrand_+3A_mu">mu</code></td>
<td>
<p>Mean vector of the response variable.</p>
</td></tr>
<tr><td><code id="maxim.integrand_+3A_sigma">Sigma</code></td>
<td>
<p>Covariance matrix of the spatial process.</p>
</td></tr>
<tr><td><code id="maxim.integrand_+3A_id_coords">ID_coords</code></td>
<td>
<p>Indices mapping response to locations.</p>
</td></tr>
<tr><td><code id="maxim.integrand_+3A_id_re">ID_re</code></td>
<td>
<p>Indices mapping response to unstructured random effects.</p>
</td></tr>
<tr><td><code id="maxim.integrand_+3A_family">family</code></td>
<td>
<p>Distribution family for the response variable. Must be one of 'gaussian', 'binomial', or 'poisson'.</p>
</td></tr>
<tr><td><code id="maxim.integrand_+3A_sigma2_re">sigma2_re</code></td>
<td>
<p>Variance of the unstructured random effects.</p>
</td></tr>
<tr><td><code id="maxim.integrand_+3A_hessian">hessian</code></td>
<td>
<p>Logical; if TRUE, compute the Hessian matrix.</p>
</td></tr>
<tr><td><code id="maxim.integrand_+3A_gradient">gradient</code></td>
<td>
<p>Logical; if TRUE, compute the gradient vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function maximizes the integrand for GLGPMs using the Nelder-Mead optimization algorithm. It computes the likelihood function incorporating spatial covariance and unstructured random effects, if provided.
</p>
<p>The integrand includes terms for the spatial process (Sigma), unstructured random effects (sigma2_re), and the likelihood function (llik) based on the specified distribution family ('gaussian', 'binomial', or 'poisson').
</p>


<h3>Value</h3>

<p>A list containing the mode estimate, and optionally, the Hessian matrix and gradient vector.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='plot_s_variogram'>Plotting the empirical variogram</h2><span id='topic+plot_s_variogram'></span>

<h3>Description</h3>

<p>Plots the empirical variogram generated by <code><a href="#topic+s_variogram">s_variogram</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_s_variogram(variog_output, plot_envelope = FALSE, color = "royalblue1")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_s_variogram_+3A_variog_output">variog_output</code></td>
<td>
<p>The output generated by the function <code><a href="#topic+s_variogram">s_variogram</a></code>.</p>
</td></tr>
<tr><td><code id="plot_s_variogram_+3A_plot_envelope">plot_envelope</code></td>
<td>
<p>A logical value indicating if the envelope of spatial independence
generated using the permutation test must be displayed (<code>plot_envelope = TRUE</code>) or not
(<code>plot_envelope = FALSE</code>). By default <code>plot_envelope = FALSE</code>. Note: if <code>n_permutation = 0</code> when
running the function <code><a href="#topic+s_variogram">s_variogram</a></code>, the function will display an error message because no envelope can be generated.</p>
</td></tr>
<tr><td><code id="plot_s_variogram_+3A_color">color</code></td>
<td>
<p>If <code>plot_envelope = TRUE</code>, it sets the colour of the envelope; run <code>vignette("ggplot2-specs")</code> for more details on this argument.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the empirical variogram, which shows the spatial dependence structure of the data. If <code>plot_envelope</code> is set to <code>TRUE</code>, the plot will also include an envelope indicating the range of values under spatial independence, based on a permutation test.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code> object representing the empirical variogram plot, optionally including the envelope of spatial independence.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+s_variogram">s_variogram</a></code>
</p>

<hr>
<h2 id='plot.RiskMap_pred_target_grid'>Plot Method for RiskMap_pred_target_grid Objects</h2><span id='topic+plot.RiskMap_pred_target_grid'></span>

<h3>Description</h3>

<p>Generates a plot of the predicted values or summaries over the regular spatial grid
from an object of class 'RiskMap_pred_target_grid'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RiskMap_pred_target_grid'
plot(x, which_target = "linear_target", which_summary = "mean", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.RiskMap_pred_target_grid_+3A_x">x</code></td>
<td>
<p>An object of class 'RiskMap_pred_target_grid'.</p>
</td></tr>
<tr><td><code id="plot.RiskMap_pred_target_grid_+3A_which_target">which_target</code></td>
<td>
<p>Character string specifying which target prediction to plot.</p>
</td></tr>
<tr><td><code id="plot.RiskMap_pred_target_grid_+3A_which_summary">which_summary</code></td>
<td>
<p>Character string specifying which summary statistic to plot (e.g., &quot;mean&quot;, &quot;sd&quot;).</p>
</td></tr>
<tr><td><code id="plot.RiskMap_pred_target_grid_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the <code><a href="terra.html#topic+plot">plot</a></code> function of the <code>terra</code> package.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function requires the 'terra' package for spatial data manipulation and plotting.
It plots the values or summaries over a regular spatial grid, allowing for visual examination of spatial patterns.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code> object representing the specified prediction target or summary statistic over the spatial grid.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pred_target_grid">pred_target_grid</a></code>
</p>

<hr>
<h2 id='plot.RiskMap_pred_target_shp'>Plot Method for RiskMap_pred_target_shp Objects</h2><span id='topic+plot.RiskMap_pred_target_shp'></span>

<h3>Description</h3>

<p>Generates a plot of predictive target values or summaries over a shapefile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RiskMap_pred_target_shp'
plot(x, which_target = "linear_target", which_summary = "mean", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.RiskMap_pred_target_shp_+3A_x">x</code></td>
<td>
<p>An object of class 'RiskMap_pred_target_shp' containing computed targets,
summaries, and associated spatial data.</p>
</td></tr>
<tr><td><code id="plot.RiskMap_pred_target_shp_+3A_which_target">which_target</code></td>
<td>
<p>Character indicating the target type to plot (e.g., &quot;linear_target&quot;).</p>
</td></tr>
<tr><td><code id="plot.RiskMap_pred_target_shp_+3A_which_summary">which_summary</code></td>
<td>
<p>Character indicating the summary type to plot (e.g., &quot;mean&quot;, &quot;sd&quot;).</p>
</td></tr>
<tr><td><code id="plot.RiskMap_pred_target_shp_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to 'scale_fill_distiller' in 'ggplot2'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the predictive target values or summaries over a shapefile.
It requires the 'ggplot2' package for plotting and 'sf' objects for spatial data.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code> object showing the plot of the specified predictive target or summary.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pred_target_shp">pred_target_shp</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="ggplot2.html#topic+geom_sf">geom_sf</a></code>,
<code><a href="ggplot2.html#topic+aes">aes</a></code>, <code><a href="ggplot2.html#topic+scale_fill_distiller">scale_fill_distiller</a></code>
</p>

<hr>
<h2 id='pred_over_grid'>Prediction of the random effects components and covariates effects over a spatial grid using a fitted generalized linear Gaussian process model</h2><span id='topic+pred_over_grid'></span>

<h3>Description</h3>

<p>This function computes predictions over a spatial grid using a fitted model
obtained from the <code><a href="#topic+glgpm">glgpm</a></code> function. It provides point predictions and uncertainty
estimates for the specified locations for each component of the model separately: the spatial random effects;
the unstructured random effects (if included); and the covariates effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_over_grid(
  object,
  grid_pred,
  predictors = NULL,
  re_predictors = NULL,
  pred_cov_offset = NULL,
  control_sim = set_control_sim(),
  type = "marginal",
  messages = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred_over_grid_+3A_object">object</code></td>
<td>
<p>A RiskMap object obtained from the 'glgpm' function.</p>
</td></tr>
<tr><td><code id="pred_over_grid_+3A_grid_pred">grid_pred</code></td>
<td>
<p>An object of class 'sfc', representing the spatial grid over which predictions
are to be made. Must be in the same coordinate reference system (CRS) as the
object passed to 'object'.</p>
</td></tr>
<tr><td><code id="pred_over_grid_+3A_predictors">predictors</code></td>
<td>
<p>Optional. A data frame containing predictor variables used for prediction.</p>
</td></tr>
<tr><td><code id="pred_over_grid_+3A_re_predictors">re_predictors</code></td>
<td>
<p>Optional. A data frame containing predictors for unstructured random effects,
if applicable.</p>
</td></tr>
<tr><td><code id="pred_over_grid_+3A_pred_cov_offset">pred_cov_offset</code></td>
<td>
<p>Optional. A numeric vector specifying covariate offsets at prediction locations.</p>
</td></tr>
<tr><td><code id="pred_over_grid_+3A_control_sim">control_sim</code></td>
<td>
<p>Control parameters for MCMC sampling. Must be an object of class &quot;mcmc.RiskMap&quot; as returned by <code><a href="#topic+set_control_sim">set_control_sim</a></code>.</p>
</td></tr>
<tr><td><code id="pred_over_grid_+3A_type">type</code></td>
<td>
<p>Type of prediction. &quot;marginal&quot; for marginal predictions, &quot;joint&quot; for joint predictions.</p>
</td></tr>
<tr><td><code id="pred_over_grid_+3A_messages">messages</code></td>
<td>
<p>Logical. If TRUE, display progress messages. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'RiskMap.pred.re' containing predicted values, uncertainty estimates,
and additional information.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='pred_target_grid'>Predictive Target Over a Regular Spatial Grid</h2><span id='topic+pred_target_grid'></span>

<h3>Description</h3>

<p>Computes predictions over a regular spatial grid using outputs from the
<code><a href="#topic+pred_over_grid">pred_over_grid</a></code> function.
This function allows for incorporating covariates, offsets, and optional
unstructured random effects into the predictive target.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_target_grid(
  object,
  include_covariates = TRUE,
  include_nugget = FALSE,
  include_cov_offset = FALSE,
  include_re = FALSE,
  f_target = NULL,
  pd_summary = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred_target_grid_+3A_object">object</code></td>
<td>
<p>Output from 'pred_over_grid', a RiskMap.pred.re object.</p>
</td></tr>
<tr><td><code id="pred_target_grid_+3A_include_covariates">include_covariates</code></td>
<td>
<p>Logical. Include covariates in the predictive target.</p>
</td></tr>
<tr><td><code id="pred_target_grid_+3A_include_nugget">include_nugget</code></td>
<td>
<p>Logical. Include the nugget effect in the predictive target.</p>
</td></tr>
<tr><td><code id="pred_target_grid_+3A_include_cov_offset">include_cov_offset</code></td>
<td>
<p>Logical. Include the covariate offset in the predictive target.</p>
</td></tr>
<tr><td><code id="pred_target_grid_+3A_include_re">include_re</code></td>
<td>
<p>Logical. Include unstructured random effects in the predictive target.</p>
</td></tr>
<tr><td><code id="pred_target_grid_+3A_f_target">f_target</code></td>
<td>
<p>Optional. List of functions to apply on the linear predictor samples.</p>
</td></tr>
<tr><td><code id="pred_target_grid_+3A_pd_summary">pd_summary</code></td>
<td>
<p>Optional. List of summary functions to apply on the predicted values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'RiskMap_pred_target_grid' containing predicted values
and summaries over the regular spatial grid.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pred_over_grid">pred_over_grid</a></code>
</p>

<hr>
<h2 id='pred_target_shp'>Predictive Target over a Shapefile</h2><span id='topic+pred_target_shp'></span>

<h3>Description</h3>

<p>Computes predictions over a shapefile using outputs from the
<code><a href="#topic+pred_over_grid">pred_over_grid</a></code> function.
This function allows for incorporating covariates, offsets, and optional
unstructured random effects into the predictive target.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_target_shp(
  object,
  shp,
  shp_target = mean,
  weights = NULL,
  standardize_weights = FALSE,
  col_names = NULL,
  include_covariates = TRUE,
  include_nugget = FALSE,
  include_cov_offset = FALSE,
  include_re = FALSE,
  f_target = NULL,
  pd_summary = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred_target_shp_+3A_object">object</code></td>
<td>
<p>Output from 'pred_over_grid', a RiskMap.pred.re object.</p>
</td></tr>
<tr><td><code id="pred_target_shp_+3A_shp">shp</code></td>
<td>
<p>Spatial dataset (sf or data.frame) representing the shapefile over which predictions are computed.</p>
</td></tr>
<tr><td><code id="pred_target_shp_+3A_shp_target">shp_target</code></td>
<td>
<p>Function defining the aggregation method for shapefile targets (default is mean).</p>
</td></tr>
<tr><td><code id="pred_target_shp_+3A_weights">weights</code></td>
<td>
<p>Optional numeric vector of weights for spatial predictions.</p>
</td></tr>
<tr><td><code id="pred_target_shp_+3A_standardize_weights">standardize_weights</code></td>
<td>
<p>Logical indicating whether to standardize weights (default is FALSE).</p>
</td></tr>
<tr><td><code id="pred_target_shp_+3A_col_names">col_names</code></td>
<td>
<p>Column name or index in 'shp' containing region names.</p>
</td></tr>
<tr><td><code id="pred_target_shp_+3A_include_covariates">include_covariates</code></td>
<td>
<p>Logical indicating whether to include covariates in predictions (default is TRUE).</p>
</td></tr>
<tr><td><code id="pred_target_shp_+3A_include_nugget">include_nugget</code></td>
<td>
<p>Logical indicating whether to include the nugget effect (default is FALSE).</p>
</td></tr>
<tr><td><code id="pred_target_shp_+3A_include_cov_offset">include_cov_offset</code></td>
<td>
<p>Logical indicating whether to include covariate offset in predictions (default is FALSE).</p>
</td></tr>
<tr><td><code id="pred_target_shp_+3A_include_re">include_re</code></td>
<td>
<p>Logical indicating whether to include random effects in predictions (default is FALSE).</p>
</td></tr>
<tr><td><code id="pred_target_shp_+3A_f_target">f_target</code></td>
<td>
<p>List of target functions to apply to the linear predictor samples.</p>
</td></tr>
<tr><td><code id="pred_target_shp_+3A_pd_summary">pd_summary</code></td>
<td>
<p>List of summary functions (e.g., mean, sd) to summarize target samples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes predictive targets or summaries over a spatial shapefile
using outputs from 'pred_S'. It requires the 'terra' package for spatial data
manipulation and should be used with 'sf' or 'data.frame' objects representing
the shapefile.
</p>


<h3>Value</h3>

<p>An object of class 'RiskMap_pred_target_shp' containing computed targets,
summaries, and associated spatial data.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pred_target_grid">pred_target_grid</a></code>
</p>

<hr>
<h2 id='print.summary.RiskMap'>Print Summary of RiskMap Model</h2><span id='topic+print.summary.RiskMap'></span>

<h3>Description</h3>

<p>Provides a <code>print</code> method for the summary of &quot;RiskMap&quot; objects, detailing the model type, parameter estimates, and other relevant statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.RiskMap'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.RiskMap_+3A_x">x</code></td>
<td>
<p>An object of class &quot;summary.RiskMap&quot;.</p>
</td></tr>
<tr><td><code id="print.summary.RiskMap_+3A_...">...</code></td>
<td>
<p>other parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prints a detailed summary of a fitted &quot;RiskMap&quot; model, including:
</p>

<ul>
<li><p> The type of geostatistical model (e.g., Gaussian, Binomial, Poisson).
</p>
</li>
<li><p> Confidence intervals for parameter estimates.
</p>
</li>
<li><p> Regression coefficients with their standard errors and p-values.
</p>
</li>
<li><p> Measurement error variance, if applicable.
</p>
</li>
<li><p> Spatial process parameters, including the Matern covariance parameters.
</p>
</li>
<li><p> Variance of the nugget effect, if applicable.
</p>
</li>
<li><p> Unstructured random effects variances, if applicable.
</p>
</li>
<li><p> Log-likelihood of the model.
</p>
</li>
<li><p> Akaike Information Criterion (AIC) for Gaussian models.
</p>
</li></ul>



<h3>Value</h3>

<p>This function is used for its side effect of printing to the console. It does not return a value.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='propose_utm'>EPSG of the UTM Zone</h2><span id='topic+propose_utm'></span>

<h3>Description</h3>

<p>Suggests the EPSG code for the UTM zone where the majority of the data falls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>propose_utm(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="propose_utm_+3A_data">data</code></td>
<td>
<p>An object of class <code>sf</code> containing the coordinates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function determines the UTM zone and hemisphere where the majority of the data points are located and proposes the corresponding EPSG code.
</p>


<h3>Value</h3>

<p>An integer indicating the EPSG code of the UTM zone.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='re'>Random Effect Model Specification</h2><span id='topic+re'></span>

<h3>Description</h3>

<p>Specifies the terms for a random effect model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>re(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="re_+3A_...">...</code></td>
<td>
<p>Variables representing the random effects in the model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function constructs a list that includes the specified terms for the random effects. This list can be used as a specification for a random effect model.
</p>


<h3>Value</h3>

<p>A list of class <code>re.spec</code> containing the following elements:
</p>
<table>
<tr><td><code>term</code></td>
<td>
<p>A character vector of the specified terms.</p>
</td></tr>
<tr><td><code>dim</code></td>
<td>
<p>The number of specified terms.</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>A character string representing the full call for the random effect model.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>At least one variable must be provided as input.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='s_variogram'>Empirical variogram</h2><span id='topic+s_variogram'></span>

<h3>Description</h3>

<p>Computes the empirical variogram using &ldquo;bins&rdquo; of distance provided by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s_variogram(
  data,
  variable,
  bins = NULL,
  n_permutation = 0,
  convert_to_utm = TRUE,
  scale_to_km = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="s_variogram_+3A_data">data</code></td>
<td>
<p>an object of class <code>sf</code> containing the variable for which the variogram
is to be computed and the coordinates</p>
</td></tr>
<tr><td><code id="s_variogram_+3A_variable">variable</code></td>
<td>
<p>a character indicating the name of variable for which the variogram is to be computed.</p>
</td></tr>
<tr><td><code id="s_variogram_+3A_bins">bins</code></td>
<td>
<p>a vector indicating the 'bins' to be used to define the classes of distance used in the computation of the variogram.
By default <code>bins=NULL</code> and bins are then computed as <code>seq(0, d_max/2, length=15)</code> where <code>d_max</code> is the maximum distance observed in the data.</p>
</td></tr>
<tr><td><code id="s_variogram_+3A_n_permutation">n_permutation</code></td>
<td>
<p>a non-negative integer indicating the number of permutation used to compute the 95
level envelope under the assumption of spatial independence. By default <code>n_permutation=0</code>, and no envelope is generated.</p>
</td></tr>
<tr><td><code id="s_variogram_+3A_convert_to_utm">convert_to_utm</code></td>
<td>
<p>a logical value, indicating if the conversion to UTM shuold be performed (<code>convert_to_utm = TRUE</code>) or
the coordinate reference system of the data must be used without any conversion (<code>convert_to_utm = FALSE</code>).
By default <code>convert_to_utm = TRUE</code>. Note: if <code>convert_to_utm = TRUE</code> the conversion to UTM is performed using
the epsg provided by <code><a href="#topic+propose_utm">propose_utm</a></code>.</p>
</td></tr>
<tr><td><code id="s_variogram_+3A_scale_to_km">scale_to_km</code></td>
<td>
<p>a logical value, indicating if the distances used in the variogram must be scaled
to kilometers (<code>scale_to_km = TRUE</code>) or left in meters (<code>scale_to_km = FALSE</code>).
By default <code>scale_to_km = FALSE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class 'variogram' which is a list containing the following components
</p>
<p><code>variogram</code> a data-frame containing the following columns: <code>mid_points</code>,
the middle points of the classes of distance provided by <code>bins</code>;
<code>obs_vari</code> the values of the observed variogram; <code>obs_vari</code> the number of pairs.
If <code>n_permutation &gt; 0</code>, the data-frame also contains <code>lower_bound</code> and <code>upper_bound</code>
corresponding to the lower and upper bounds of the 95
used to assess the departure of the observed variogram from the assumption of spatial independence.
</p>
<p><code>scale_to_km</code> the value passed to <code>scale_to_km</code>
</p>
<p><code>n_permutation</code> the number of permutations
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>

<hr>
<h2 id='set_control_sim'>Set Control Parameters for Simulation</h2><span id='topic+set_control_sim'></span>

<h3>Description</h3>

<p>This function sets control parameters for running simulations, particularly for MCMC methods.
It allows users to specify the number of simulations, burn-in period, thinning interval, and various
other parameters necessary for the simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_control_sim(
  n_sim = 12000,
  burnin = 2000,
  thin = 10,
  h = NULL,
  c1.h = 0.01,
  c2.h = 1e-04,
  linear_model = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_control_sim_+3A_n_sim">n_sim</code></td>
<td>
<p>Integer. The total number of simulations to run. Default is 12000.</p>
</td></tr>
<tr><td><code id="set_control_sim_+3A_burnin">burnin</code></td>
<td>
<p>Integer. The number of initial simulations to discard (burn-in period, used for the MCMC algorithm). Default is 2000.</p>
</td></tr>
<tr><td><code id="set_control_sim_+3A_thin">thin</code></td>
<td>
<p>Integer. The interval at which simulations are recorded (thinning interval, used for the MCMC algorithm). Default is 10.</p>
</td></tr>
<tr><td><code id="set_control_sim_+3A_h">h</code></td>
<td>
<p>Numeric. An optional parameter. Must be non-negative if specified.</p>
</td></tr>
<tr><td><code id="set_control_sim_+3A_c1.h">c1.h</code></td>
<td>
<p>Numeric. A control parameter for the simulation. Must be positive. Default is 0.01.</p>
</td></tr>
<tr><td><code id="set_control_sim_+3A_c2.h">c2.h</code></td>
<td>
<p>Numeric. Another control parameter for the simulation. Must be between 0 and 1. Default is 1e-04.</p>
</td></tr>
<tr><td><code id="set_control_sim_+3A_linear_model">linear_model</code></td>
<td>
<p>Logical. If TRUE, the function sets up parameters for a linear model and
only returns <code>n_sim</code>. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function validates the input parameters and ensures they are appropriate for the simulation that is used
in the <code><a href="#topic+glgpm">glgpm</a></code> fitting function.
For non-linear models, it checks that <code>n_sim</code> is greater than <code>burnin</code>, that <code>thin</code> is positive
and a divisor of <code>(n_sim - burnin)</code>, and that <code>h</code>, <code>c1.h</code>, and <code>c2.h</code> are within their
respective valid ranges.
</p>
<p>If <code>linear_model</code> is TRUE, only <code>n_sim</code> and <code>linear_model</code> are required, and the function
returns a list containing these parameters.
</p>
<p>If <code>linear_model</code> is FALSE, the function returns a list containing <code>n_sim</code>, <code>burnin</code>, <code>thin</code>,
<code>h</code>, <code>c1.h</code>, <code>c2.h</code>, and <code>linear_model</code>.
</p>


<h3>Value</h3>

<p>A list of control parameters for the simulation with class attribute &quot;mcmc.RiskMap&quot;.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="Matrix.html#topic+Matrix">Matrix</a></code>, <code><a href="Matrix.html#topic+forceSymmetric">forceSymmetric</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example with default parameters
control_params &lt;- set_control_sim()

# Example with custom parameters
control_params &lt;- set_control_sim(n_sim = 15000, burnin = 3000, thin = 20)

</code></pre>

<hr>
<h2 id='summary.RiskMap'>Summarize Model Fits</h2><span id='topic+summary.RiskMap'></span>

<h3>Description</h3>

<p>Provides a <code>summary</code> method for the &quot;RiskMap&quot; class that computes the standard errors and p-values for likelihood-based model fits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'RiskMap'
summary(object, ..., conf_level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.RiskMap_+3A_object">object</code></td>
<td>
<p>An object of class &quot;RiskMap&quot; obtained as a result of a call to <code><a href="#topic+glgpm">glgpm</a></code>.</p>
</td></tr>
<tr><td><code id="summary.RiskMap_+3A_...">...</code></td>
<td>
<p>other parameters.</p>
</td></tr>
<tr><td><code id="summary.RiskMap_+3A_conf_level">conf_level</code></td>
<td>
<p>The confidence level for the intervals (default is 0.95).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the standard errors and p-values for the parameters of a &quot;RiskMap&quot; model, adjusting for the covariance structure if needed.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>reg_coef</code></td>
<td>
<p>A matrix with the estimates, standard errors, z-values, p-values, and confidence intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>me</code></td>
<td>
<p>A matrix with the estimates and confidence intervals for the measurement error variance, if applicable.</p>
</td></tr>
<tr><td><code>sp</code></td>
<td>
<p>A matrix with the estimates and confidence intervals for the spatial process parameters.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p>The fixed nugget variance, if applicable.</p>
</td></tr>
<tr><td><code>ranef</code></td>
<td>
<p>A matrix with the estimates and confidence intervals for the random effects variances, if applicable.</p>
</td></tr>
<tr><td><code>conf_level</code></td>
<td>
<p>The confidence level used for the intervals.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>The family of the model (e.g., &quot;gaussian&quot;).</p>
</td></tr>
<tr><td><code>kappa</code></td>
<td>
<p>The kappa parameter of the model.</p>
</td></tr>
<tr><td><code>log.lik</code></td>
<td>
<p>The log-likelihood of the model fit.</p>
</td></tr>
<tr><td><code>cov_offset_used</code></td>
<td>
<p>A logical indicating if a covariance offset was used.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>The Akaike Information Criterion (AIC) for the model, if applicable.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Handles both Gaussian and non-Gaussian families, and accounts for fixed and random effects in the model.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glgpm">glgpm</a></code>, <code><a href="#topic+coef.RiskMap">coef.RiskMap</a></code>
</p>

<hr>
<h2 id='to_table'>Create LaTeX Table from Model Fit</h2><span id='topic+to_table'></span>

<h3>Description</h3>

<p>Converts a &quot;RiskMap&quot; model fit into an <code>xtable</code> object, which can then be printed as a LaTeX or HTML table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_table(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_table_+3A_object">object</code></td>
<td>
<p>An object of class &quot;RiskMap&quot; obtained as a result of a call to <code><a href="#topic+glgpm">glgpm</a></code>.</p>
</td></tr>
<tr><td><code id="to_table_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="xtable.html#topic+xtable">xtable</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes a fitted &quot;RiskMap&quot; model and converts it into an <code>xtable</code> object. The resulting table includes:
</p>

<ul>
<li><p> Regression coefficients with their estimates, confidence intervals, and p-values.
</p>
</li>
<li><p> Spatial process parameters.
</p>
</li>
<li><p> Random effects variances.
</p>
</li>
<li><p> Measurement error variance, if applicable.
</p>
</li></ul>

<p>The <code>xtable</code> object can be customized further using additional arguments and then printed as a LaTeX or HTML table.
</p>


<h3>Value</h3>

<p>An object of class &quot;xtable&quot; which inherits the <code>data.frame</code> class and contains several additional attributes specifying the table formatting options.
</p>


<h3>Author(s)</h3>

<p>Emanuele Giorgi <a href="mailto:e.giorgi@lancaster.ac.uk">e.giorgi@lancaster.ac.uk</a>
</p>
<p>Claudio Fronterre <a href="mailto:c.fronterr@lancaster.ac.uk">c.fronterr@lancaster.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glgpm">glgpm</a></code>, <code><a href="xtable.html#topic+xtable">xtable</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
