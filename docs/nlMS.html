<!DOCTYPE html><html><head><title>Help for package nlMS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nlMS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#auxiliary functions'><p>Auxiliary functions in Model Selection (MS)</p></a></li>
<li><a href='#model_selection'><p>Model Selection (MS)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Non-Linear Model Selection</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Carme Font &lt;carme.font.moragon@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carme Font &lt;carme.font.moragon@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Package to select best model  among several linear and nonlinear models. The main function uses the gnls() function from the 'nlme' package to fit the data to nine regression models, named: "linear", "quadratic", "cubic", "logistic", "exponential", "power", "monod", "haldane", "logit".</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>nlme, stats, graphics, grDevices</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-06-20 14:01:22 UTC; cfont</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-06-21 15:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='auxiliary+20functions'>Auxiliary functions in Model Selection (MS)</h2><span id='topic+func'></span>

<h3>Description</h3>

<p>Auxiliary functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>func(mod, X, Y, name_mod, k=2, SST, N, file_name=NULL, form=NULL, make_plot=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="auxiliary+2B20functions_+3A_form">form</code></td>
<td>
<p>An object of class formula for the regression analysis.</p>
</td></tr>
<tr><td><code id="auxiliary+2B20functions_+3A_mod">mod</code></td>
<td>
<p>Output of gnls.</p>
</td></tr>
<tr><td><code id="auxiliary+2B20functions_+3A_x">X</code>, <code id="auxiliary+2B20functions_+3A_y">Y</code></td>
<td>
<p>Independent and dependent variables.</p>
</td></tr>
<tr><td><code id="auxiliary+2B20functions_+3A_name_mod">name_mod</code></td>
<td>
<p>Name of the current regressionmodel preformed.</p>
</td></tr>
<tr><td><code id="auxiliary+2B20functions_+3A_k">k</code></td>
<td>
<p>Number of parameters used in the regression analysis.</p>
</td></tr>
<tr><td><code id="auxiliary+2B20functions_+3A_sst">SST</code></td>
<td>
<p>Total Sum of Squares.</p>
</td></tr>
<tr><td><code id="auxiliary+2B20functions_+3A_n">N</code></td>
<td>
<p>X length.</p>
</td></tr>
<tr><td><code id="auxiliary+2B20functions_+3A_file_name">file_name</code></td>
<td>
<p>Name of the file where to save results.</p>
</td></tr>
<tr><td><code id="auxiliary+2B20functions_+3A_make_plot">make_plot</code></td>
<td>
<p>Boolean value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Carme Font &lt;carme.font.moragon@gmail.com&gt;</p>

<hr>
<h2 id='model_selection'>Model Selection (MS)</h2><span id='topic+model_selection'></span>

<h3>Description</h3>

<p>This function fits the input data to nine regression models. It gives AIC (Akaike Information Index) and RSE (Residual Standard Error) as goodness of fit measures. The models implemented are: &quot;linear&quot;, &quot;quadratic&quot;, &quot;cubic&quot;, &quot;logistic&quot;, &quot;exponential&quot;, &quot;power&quot;, &quot;monod&quot;, &quot;haldane&quot;, &quot;logit&quot;.
For the function gnls() from the 'nlme' package is taken for all the models.
Furthermore, the shapiro.test() function from the 'stats' package is used to test residuals normality.
The function has been though to run over several values. This is, when 'data' is composed by several dependent variables Y.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_selection(data=NULL, name_dir=NULL,
                name_results=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_selection_+3A_data">data</code></td>
<td>
<p>Matrix with at least two columns. Fisrt column is taken as the X, ie the independent variable. Next columns are recursevelly taken as the Y variable (dependent). Note: in the current version X must be positive.</p>
</td></tr>
<tr><td><code id="model_selection_+3A_name_dir">name_dir</code></td>
<td>
<p>Directory to save function results. Default is a temporary directory set by tempdir().</p>
</td></tr>
<tr><td><code id="model_selection_+3A_name_results">name_results</code></td>
<td>
<p>Name of the file for the global results. Default is &quot;nlMS_results&quot;. Note: by default, the extension of the output file is .csv. You do not need to specify it.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>There are two kinds of outputs. First one is a .csv file, that takes its name from the argument name_results, it consists of a table with the value of AIC, RSE and R.squared (only for linear models) for each tested model. As well a fourth row with the Saphiro.Wilk normality test result applied to the residuals. If you want to use AIC, then the resdiuals must follow a normal distribution.
In case input Y data consists of more than one column, the model performs several runs always taking the same variable X as independent values.</p>


<h3>Author(s)</h3>

<p>Carme Font &lt;carme.font.moragon@gmail.com&gt;</p>


<h3>References</h3>

<p>The package has been tested in
</p>
<p>Romero, F., Sabater, S., Font, C., Balcazar, J. L., Acuna, V. (2019). Desiccation events change the microbial response to gradients of wastewater effluent pollution. Water research, 151, 371-380. doi: 10.1016/j.watres.2018.12.028
</p>
<p>Acuna, V., Casellas, M., Font, C., Romero, F., Sabater, S. (2019). Nutrient attenuation dynamics in effluent dominated watercourses. Water Research. doi: 10.1016/j.watres.2019.05.093
</p>
<p>Sabater-Liesa, L., Montemurro, N., Font, C., Ginebreda, A., Gonzalez-Trujillo, J. D., Mingorance, N., ... Barcelo, D. (2019). The response patterns of stream biofilms to urban sewage change with exposure time and dilution. Science of The Total Environment, 674, 401-411. doi: 10.1016/j.scitotenv.2019.04.178
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X&lt;-rnorm(100)
X&lt;-X-min(X)+0.001
Y&lt;-rnorm(100)
model_selection(data=cbind(X, Y))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
