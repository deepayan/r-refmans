<!DOCTYPE html><html lang="en"><head><title>Help for package jointest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {jointest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#combine-methods'><p>Nonparametric combination of <code>jointest</code> objects</p></a></li>
<li><a href='#flip2sss'><p>flipscores 2-Stage Summary Statistics approach</p></a></li>
<li><a href='#join_flipscores'><p>join tests from multiverse models</p></a></li>
<li><a href='#jointest-methods'><p>Methods for <code>jointest</code> objects</p></a></li>
<li><a href='#oasis'><p>Longitudinal MRI data in nondemented and demented older adults</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-13</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Testing Through Joint Resampling-Based Tests</td>
</tr>
<tr>
<td>Description:</td>
<td>Runs resampling-based tests jointly, e.g., sign-flip score tests from Hemerik et al., (2020) &lt;<a href="https://doi.org/10.1111%2Frssb.12369">doi:10.1111/rssb.12369</a>&gt;, to allow for multivariate testing, i.e., weak and strong control of the Familywise Error Rate or True Discovery Proportion.</td>
</tr>
<tr>
<td>Imports:</td>
<td>flipscores, flip, stats, graphics, grDevices</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, logistf, rmarkdown, ggplot2, lme4</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-13 14:28:08 UTC; finos</td>
</tr>
<tr>
<td>Author:</td>
<td>Livio Finos <a href="https://orcid.org/0000-0003-3181-8078"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre,
    aut],
  Angela Andreella [aut],
  Filippo Gambarota [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Livio Finos &lt;livio.finos@unipd.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-16 16:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='combine-methods'>Nonparametric combination of <code>jointest</code> objects</h2><span id='topic+combine-methods'></span><span id='topic+combine'></span><span id='topic+combine_contrasts'></span>

<h3>Description</h3>

<p>Methods for combining <code>jointest</code> objects.
</p>
<p><code>combine</code> combines the tests derived from multiverse models.
</p>
<p><code>combine_contrasts</code> combines the tests derived from the contrasts of a factor variable to get a 
global test for the factor (i.e. categorical predictor). 
It has strong analogies with ANOVA test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine(mods, comb_funct = "maxT", by = NULL, by_list=NULL, tail = 0)

combine_contrasts(mods, comb_funct = "Mahalanobis", tail = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combine-methods_+3A_mods">mods</code></td>
<td>
<p>a <code>jointest</code> object.</p>
</td></tr>
<tr><td><code id="combine-methods_+3A_comb_funct">comb_funct</code></td>
<td>
<p>combining function to be used. 
Several functions are implemented: &quot;mean&quot;, &quot;median&quot;, &quot;Fisher&quot;, &quot;Liptak&quot;, (equal to) &quot;Stoufer&quot;, &quot;Tippet&quot;, (equal to) &quot;minp&quot;, &quot;maxT&quot;, &quot;Mahalanobis&quot;. 
Alternatively it can be a custom function that has a Tspace matrix as input. 
For <code>combine</code> the default is <code>comb_funct="maxT"</code>,
while for <code>combines_contrasts</code> the default is <code>comb_funct="Mahalanobis"</code>.</p>
</td></tr>
<tr><td><code id="combine-methods_+3A_by">by</code></td>
<td>
<p>if <code>NULL</code> (default), it combines all test statistics.
If a characters, it refers to the column's name of <code>summary_table</code> (and printed by something like <code>summary(mods)</code>). 
The elements with the same value will be combined. If <code>by</code> is a vector, the values are defined by row-wise concatenation of the values of the columns in <code>by</code>.
The argument is inactive if <code>by_list</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="combine-methods_+3A_by_list">by_list</code></td>
<td>
<p>NULL (default) or a list of vectors. For each vector of the list it combines test statistics with position given by the element of the vector. 
If the vectors in the list are characters, these refer to names(mods$Tspace).</p>
</td></tr>
<tr><td><code id="combine-methods_+3A_tail">tail</code></td>
<td>
<p>direction of the alternative hypothesis. It can be &quot;two.sided&quot; (or 0, the default), &quot;less&quot; (or -1) or &quot;greater&quot; (or +1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a <code>jointest</code>-object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#First example
library(jointest)
set.seed(123)

#Simulate data
n=20
D=data.frame(X=rnorm(n),Z1=rnorm(n),Z2=rnorm(n))
D$Y=D$Z1+D$X+rnorm(n)

# Run four glms abd combine it in a list
mod1=glm(Y~X+Z1+Z2,data=D)
mod2=glm(Y~X+poly(Z1,2)+Z2,data=D)
mod3=glm(Y~X+poly(Z1,2)+poly(Z2,2),data=D)
mod4=glm(Y~X+Z1+poly(Z2,2),data=D)
mods=list(mod1=mod1,mod2=mod2,mod3=mod3,mod4=mod4)

# Let us analyze the tests related to coefficient "X" and combine them
res=join_flipscores(mods,n_flips = 5000, seed = 1, tested_coeffs = "X")
summary(combine(res))
# Second (continued) example
# flipscores jointly on all models and all coefficients
res=join_flipscores(mods,n_flips = 2000)
summary(combine(res))
summary(combine(res, by="Model"))
summary(combine(res, by="Coeff"))
res2=combine_contrasts(res)
summary(res2)
#custom combinations:
coeffs=c("(Intercept)","X","Z1","Z2")
coeffs_ids=lapply(coeffs,grep,res2$summary_table$Coeff)
names(coeffs_ids)=coeffs
summary(combine(res2,by_list =   coeffs_ids))
</code></pre>

<hr>
<h2 id='flip2sss'>flipscores 2-Stage Summary Statistics approach</h2><span id='topic+flip2sss'></span>

<h3>Description</h3>

<p>This function fits a model based on the provided formula and data, accounting for clusters and summary statistics within the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flip2sss(formula = NULL, data = NULL, cluster = NULL, 
family = "gaussian", summstats_within=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flip2sss_+3A_formula">formula</code></td>
<td>
<p>A formula or a list of formulas. It can be a complete model as.formula or a list of formulas, one for each element produced by the function.</p>
</td></tr>
<tr><td><code id="flip2sss_+3A_data">data</code></td>
<td>
<p>The dataset to be used for fitting the model.</p>
</td></tr>
<tr><td><code id="flip2sss_+3A_cluster">cluster</code></td>
<td>
<p>A vector or a formula evaluated on the data that defines the clusters.</p>
</td></tr>
<tr><td><code id="flip2sss_+3A_family">family</code></td>
<td>
<p>as in <code>glm</code>, but given as a character. Not used if argument <code>summstats_within</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="flip2sss_+3A_summstats_within">summstats_within</code></td>
<td>
<p>A vector of summary statistics model within the data or a function with argument data.</p>
</td></tr>
<tr><td><code id="flip2sss_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the <code><a href="flipscores.html#topic+flipscores">flipscores</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>jointest</code> object, i.e., a list containing the following objects: 
</p>

<dl>
<dt>Tspace</dt><dd><p><code>data.frame</code> where rows represents the sign-flipping transformed (plus the identity one) test and columns the variables.</p>
</dd>
<dt>summary_table</dt><dd><p><code>data.frame</code> containing for each second-step covariate the estimated parameter, score, std error, test , partial correlation and p-value.</p>
</dd> 
<dt>mods</dt><dd><p>List of <code>glm</code> objects, i.e., first-step <code>glm</code> objects</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Livio Finos, Angela Andreella
</p>


<h3>See Also</h3>

<p><code><a href="#topic+combine_contrasts">combine_contrasts</a></code>, <code><a href="#topic+combine">combine</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(jointest)
set.seed(123)
# Simulate data
N=20
n=rpois(N,20)
reff=rep(rnorm(N),n)

D=data.frame(X1=rnorm(length(reff)),
             X2=rep(rnorm(N),n),
             Grp=factor(rep(rep(LETTERS[1:3],length.out=N),n)),
             Subj=rep(1:N,n))
D$Y=rbinom(n=nrow(D),prob=plogis( 2*D$X1 * (D$Grp=="B") +  2*D$X2+reff),size=1)

# model of interest formula &lt;- Y ~ Grp * X1 + X2
# clusters structure defined by cluster &lt;- factor(D$Subj)
# The 2-Stage Summary Statistics via flipscore: 
res &lt;- flip2sss(Y ~ Grp * X1 + X2, data=D, 
               cluster=D$Subj, family="binomial")
summary(res)
# This is an ANOVA-like overall test:
summary(combine(res))
# This is an ANOVA-like test:
summary(combine_contrasts(res))

# An alternative and more flexible definition of the model:
# Define the summary statistics (here we propose the glm with firth correction 
# from the logistf package)
summstats_within &lt;- 'logistf::logistf(Y ~ X1, family = binomial(link = "logit"),
control=logistf::logistf.control(maxit=100))'
# however also the classic glm function can be used:
#summstats_within &lt;- 'glm(Y ~ X1, family = binomial(link = "logit"))'

# Then, compute the 2-Stage Summary Statistics approach
# specifying the summary statistics (within cluster/subject)
res &lt;- flip2sss(Y ~ Grp * X1 + X2, data=D, cluster=D$Subj, 
                   summstats_within=summstats_within)
summary(res)

# We can also combine the tests:
# Overall:
summary(combine(res))
# This is similar to an ANOVA test:
summary(combine_contrasts(res))
</code></pre>

<hr>
<h2 id='join_flipscores'>join tests from multiverse models</h2><span id='topic+join_flipscores'></span>

<h3>Description</h3>

<p>The function allows hypothesis testing across all plausible multiverse models
ensuring strong family-wise error rate control.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>join_flipscores(mods, tested_coeffs = NULL, n_flips = 5000, 
score_type = "standardized", statistics = "t", seed=NULL, output_models =TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="join_flipscores_+3A_mods">mods</code></td>
<td>
<p>list of <code>glm</code>s or <code>flipscores</code>-object (or any other object that can be evaluated by <code>flipscores</code>)</p>
</td></tr>
<tr><td><code id="join_flipscores_+3A_tested_coeffs">tested_coeffs</code></td>
<td>
<p>list of the same length of <code>mods</code>, each element of the list being a vector of
names of tested coefficients. Alternatively, it can be a vector of names of tested coefficients, in this case, the tested coefficients are attributed to all models (when present). 
As a last option, it can be <code>NULL</code>, if so, all coefficients are tested.</p>
</td></tr>
<tr><td><code id="join_flipscores_+3A_n_flips">n_flips</code></td>
<td>
<p>number of flips, default 5000</p>
</td></tr>
<tr><td><code id="join_flipscores_+3A_score_type">score_type</code></td>
<td>
<p>any valid type for <code>flipscores</code>, <code>"standardized"</code> is the default. see <code><a href="flipscores.html#topic+flipscores">flipscores</a></code> for more datails</p>
</td></tr>
<tr><td><code id="join_flipscores_+3A_statistics">statistics</code></td>
<td>
<p>&quot;t&quot; is the only method implemented (yet). Any other value will not modify the score (a different statistic will only affect the multivariate inference, not the univariate one).</p>
</td></tr>
<tr><td><code id="join_flipscores_+3A_seed">seed</code></td>
<td>
<p><code>NULL</code> by default. Use a number if you wanto to ensure replicability of the results</p>
</td></tr>
<tr><td><code id="join_flipscores_+3A_output_models">output_models</code></td>
<td>
<p><code>TRUE</code> by default. Should the <code>flipscores</code> model returned?</p>
</td></tr>
<tr><td><code id="join_flipscores_+3A_...">...</code></td>
<td>
<p>any other further parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>jointest</code> object, i.e., a list containing the following objects: 
</p>

<dl>
<dt>Tspace</dt><dd><p><code>data.frame</code> where rows represents the sign-flipping transformed (plus the identity one) test and columns the variables.</p>
</dd>
<dt>summary_table</dt><dd><p><code>data.frame</code> containing for each model the estimated parameter(s), score(s), std error(s), test(s), partial correlation(s) and p-value(s).</p>
</dd> 
<dt>mods</dt><dd><p>List of <code>glm</code>s or <code>flipscores</code> objects.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>library(jointest)
set.seed(123)


#EXAMPLE 1: Simulate data:
n=20
D=data.frame(X=rnorm(n),Z1=rnorm(n),Z2=rnorm(n))
D$Y=D$Z1+D$X+rnorm(n)

# Run four glms abd combine it in a list
mod1=glm(Y~X+Z1+Z2,data=D)
mod2=glm(Y~X+poly(Z1,2)+Z2,data=D)
mod3=glm(Y~X+poly(Z1,2)+poly(Z2,2),data=D)
mod4=glm(Y~X+Z1+poly(Z2,2),data=D)
mods=list(mod1=mod1,mod2=mod2,mod3=mod3,mod4=mod4)

# flipscores jointly on all models
res=join_flipscores(mods,n_flips = 1000)
summary(combine(res))
summary(combine(res, by="Model"))
summary(combine_contrasts(res))

#Simulate multivariate (50) bionomial responses 
set.seed(123)
n=30
D=data.frame(X=rnorm(n),Z=rnorm(n))
Y=replicate(50,rbinom(n,1,plogis(.5*D$Z+.5*D$X)))
colnames(Y)=paste0("Y",1:50)
D=cbind(D,Y)
mods=lapply(1:50,function(i)eval(parse(text=
paste(c("glm(formula(Y",i,"~X+Z),data=D,family='binomial')"),collapse=""))))
# flipscores jointly on all models
res=join_flipscores(mods,n_flips = 1000,tested_coeffs ="X")
summary(res)
res=p.adjust(res)
summary(res)
# Compute lower bound for the true discovery proportion. See packages pARI and sumSome
# install.packages("sumSome")
# install.packages("pARI")
# library(sumSome)
# library(pARI)
# pARI returns a lower bound equals 0.24, i.e., at least 24% of the models
# have a significant effect related to X
# pARI::pARI(ix = c(1:50),pvalues = t(jointest:::.t2p(res$Tspace)),family = "simes",delta = 9)$TDP
# sumSome returns a lower bound equals 0.42, i.e., at least 42% of the models
# have a significant effect related to X
# sumSome::tdp(sumSome::sumStats(G = as.matrix(res$Tspace)))
</code></pre>

<hr>
<h2 id='jointest-methods'>Methods for <code>jointest</code> objects</h2><span id='topic+jointest-methods'></span><span id='topic+print.jointest'></span><span id='topic+summary.jointest'></span><span id='topic+p.adjust'></span><span id='topic+plot.jointest'></span>

<h3>Description</h3>

<p>Methods to extract and manipulate relevant information from
a <code>jointest</code> object.
</p>
<p><code>print</code> method for class &quot;<code>jointest</code>&quot;.
</p>
<p><code>summary</code> method for class &quot;<code>jointest</code>&quot;
</p>
<p><code>p.adjust</code> method for class &quot;<code>jointest</code>&quot;. 
Add adjusted p-values into the <code>jointest</code> object.
</p>
<p><code>plot</code> method for class &quot;<code>jointest</code>&quot;
This <code>plot</code> function visualizes p-values from multiverse models, with
different markers to indicate statistical significance levels as defined by
the <code>mark_signif</code> argument (default is 0.05). Points are plotted with 
varying shapes based on whether the p-value is below the significance threshold,
and colors are used to distinguish between different coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'jointest'
print(x, ...)

## S3 method for class 'jointest'
summary(object, ...)

p.adjust(object, method = "maxT", tail = 0, ...)

## S3 method for class 'jointest'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jointest-methods_+3A_x">x</code></td>
<td>
<p>an object of class <code>jointest</code>.</p>
</td></tr>
<tr><td><code id="jointest-methods_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed, i.e., <code>mark_signif</code> and
<code>p.values=c("raw","adjusted")</code>. See details.</p>
</td></tr>
<tr><td><code id="jointest-methods_+3A_object">object</code></td>
<td>
<p>an object of class <code>jointest</code>.</p>
</td></tr>
<tr><td><code id="jointest-methods_+3A_method">method</code></td>
<td>
<p>any method implemented in <code>flip::flip.adjust</code> or 
a custom function. In the last case it must be a function that uses a matrix 
as input and returns a vector of adjusted p-values equal to the number of columns of the inputed matrix.</p>
</td></tr>
<tr><td><code id="jointest-methods_+3A_tail">tail</code></td>
<td>
<p>argument: expresses the tail direction of the alternative hypothesis. 
It can be &quot;two.sided&quot; (or 0, the default), &quot;less&quot; (or -1) or &quot;greater&quot; (or +1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mark_signif</code> argument: numeric value representing the significance threshold 
for marking p-values. Any p-value below this threshold will be marked 
with a dot. The default is <code>0.05</code>.
<code>p.values</code> argument: a character vector specifying which p-values to display.
It can be either <code>"raw"</code> for raw p-values or <code>"adjusted"</code> for 
adjusted p-values. The default is <code>"raw"</code>.
</p>


<h3>See Also</h3>

<p><code><a href="flip.html#topic+flip.adjust">flip.adjust</a></code>
</p>

<hr>
<h2 id='oasis'>Longitudinal MRI data in nondemented and demented older adults</h2><span id='topic+oasis'></span>

<h3>Description</h3>

<p>This dataset consists of a longitudinal collection of 150 subjects aged 60 to 96. 
Each subject was scanned on two or more visits, separated by at least one year 
for a total of 373 imaging sessions. For each subject, 3 or 4 individual T1-weighted 
MRI scans obtained in single scan sessions are included.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oasis
</code></pre>


<h3>Format</h3>

<p>A data frame with 373 rows and 15 variables:
</p>

<dl>
<dt>Subject.ID</dt><dd><p>Subject identification</p>
</dd>
<dt>MRI.ID</dt><dd><p>MRI Exam Identification</p>
</dd>
<dt>Group</dt><dd><p>Class</p>
</dd>
<dt>Visit</dt><dd><p>Visit order</p>
</dd>
<dt>MR.Delay</dt><dd><p>MR Delay Time (Contrast)</p>
</dd>
<dt>Gender</dt><dd><p>Gender</p>
</dd>
<dt>Hand</dt><dd><p>All subjects are right-handed</p>
</dd>
<dt>Age</dt><dd><p>Age of the subject</p>
</dd>
<dt>EDUC</dt><dd><p>Years of Education</p>
</dd>
<dt>SES</dt><dd><p>Socioeconomic Status</p>
</dd>
<dt>MMSE</dt><dd><p>Mini Mental State Examination</p>
</dd>
<dt>CDR</dt><dd><p>Clinical Dementia Rating</p>
</dd>
<dt>eTIV</dt><dd><p>Estimated total intracranial volume</p>
</dd>
<dt>nWBV</dt><dd><p>Normalize Whole Brain Volume</p>
</dd>
<dt>ASF</dt><dd><p>Atlas Scaling Factor</p>
</dd>
</dl>



<h3>References</h3>

<p><a href="https://www.kaggle.com/datasets/jboysen/mri-and-alzheimers">https://www.kaggle.com/datasets/jboysen/mri-and-alzheimers</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
