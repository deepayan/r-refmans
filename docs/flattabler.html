<!DOCTYPE html><html><head><title>Help for package flattabler</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {flattabler}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#assign_names'><p>data frame col and row names</p></a></li>
<li><a href='#define_labels'><p>Define the quantity of rows and columns that contain labels</p></a></li>
<li><a href='#df_ex'><p>Pivot table in data frame with with thousands indicator and decimal numbers</p></a></li>
<li><a href='#df_ex_compact'><p>Pivot table in data frame with a column with data from two label fields</p></a></li>
<li><a href='#df_pivottabler'><p>Pivot table with basic and subtotal labels in the same column</p></a></li>
<li><a href='#df_set_h'><p>Set of pivot tables placed horizontally on one sheet</p></a></li>
<li><a href='#df_set_h_v'><p>Set of pivot tables on one sheet</p></a></li>
<li><a href='#df_set_v'><p>Set of pivot tables placed vertically on one sheet</p></a></li>
<li><a href='#divide'><p>Divide table</p></a></li>
<li><a href='#extract_labels'><p>Extract labels</p></a></li>
<li><a href='#fill_labels'><p>Fill in missing labels</p></a></li>
<li><a href='#fill_values'><p>Fill in missing values</p></a></li>
<li><a href='#fill_vector'><p>Fill in missing values in a vector</p></a></li>
<li><a href='#flatten_table_list'><p>Transform a <code>pivot_table</code> object list into a flat table</p></a></li>
<li><a href='#ft_ex'><p>Flat table with page from a pivot table with with thousands indicator and decimal numbers</p></a></li>
<li><a href='#ft_ex_v2'><p>Flat table without page from a pivot table with with thousands indicator and decimal numbers</p></a></li>
<li><a href='#ft_set'><p>Flat table with page from a pivot table with with thousands indicator and decimal numbers</p></a></li>
<li><a href='#get_col_values'><p>Get column values</p></a></li>
<li><a href='#get_page'><p>Get the page information of a pivot table</p></a></li>
<li><a href='#pf_ex_compact'><p>Pivot table result of transforming a data frame with a column with data from two label fields</p></a></li>
<li><a href='#pivot_table'><p><code>pivot_table</code> S3 class</p></a></li>
<li><a href='#pt_ex'><p>Pivot table with with thousands indicator and decimal numbers</p></a></li>
<li><a href='#read_excel_file'><p>Import Excel file</p></a></li>
<li><a href='#read_excel_folder'><p>Import one sheet from each Excel file in a folder</p></a></li>
<li><a href='#read_excel_sheet'><p>Import Excel file sheet</p></a></li>
<li><a href='#read_text_file'><p>Import text file</p></a></li>
<li><a href='#read_text_folder'><p>Import all text files in a folder</p></a></li>
<li><a href='#remove_agg'><p>Remove rows and columns with aggregated data</p></a></li>
<li><a href='#remove_bottom'><p>Remove bottom rows from a pivot table</p></a></li>
<li><a href='#remove_cols'><p>Remove columns from a pivot table</p></a></li>
<li><a href='#remove_empty'><p>Remove empty rows and columns from a pivot table</p></a></li>
<li><a href='#remove_k'><p>Remove thousands separator</p></a></li>
<li><a href='#remove_left'><p>Remove left columns from a pivot table</p></a></li>
<li><a href='#remove_right'><p>Remove right columns from a pivot table</p></a></li>
<li><a href='#remove_rows'><p>Remove rows from a pivot table</p></a></li>
<li><a href='#remove_top'><p>Remove top rows from a pivot table</p></a></li>
<li><a href='#replace_dec'><p>Replace decimal separator</p></a></li>
<li><a href='#set_page'><p>Set page information to a pivot table</p></a></li>
<li><a href='#spacer_columns'><p>Spacer columns</p></a></li>
<li><a href='#spacer_rows'><p>Spacer rows</p></a></li>
<li><a href='#unpivot'><p>Unpivot a pivot table</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Obtaining a Flat Table from Pivot Tables</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Transformations that allow obtaining a flat table from
    reports in text or Excel format that contain data in the form of pivot
    tables. They can be defined for a single report and applied to a set
    of reports.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://josesamos.github.io/flattabler/">https://josesamos.github.io/flattabler/</a>,
<a href="https://github.com/josesamos/flattabler">https://github.com/josesamos/flattabler</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/josesamos/flattabler/issues">https://github.com/josesamos/flattabler/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, readr, readxl, stringr, tibble</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, pander, rmarkdown, testthat, tidyr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-08 09:20:31 UTC; joses</td>
</tr>
<tr>
<td>Author:</td>
<td>Jose Samos <a href="https://orcid.org/0000-0002-4457-3439"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Universidad de Granada [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jose Samos &lt;jsamos@ugr.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-08 11:50:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='assign_names'>data frame col and row names</h2><span id='topic+assign_names'></span>

<h3>Description</h3>

<p>Assign names to the rows and columns of the data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assign_names(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="assign_names_+3A_df">df</code></td>
<td>
<p>A data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame.
</p>

<hr>
<h2 id='define_labels'>Define the quantity of rows and columns that contain labels</h2><span id='topic+define_labels'></span><span id='topic+define_labels.pivot_table'></span>

<h3>Description</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data. This function defines the quantity of rows and
columns that contain labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>define_labels(pt, n_col, n_row)

## S3 method for class 'pivot_table'
define_labels(pt, n_col, n_row)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="define_labels_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="define_labels_+3A_n_col">n_col</code></td>
<td>
<p>A number, quantity of columns containing pivot table labels.</p>
</td></tr>
<tr><td><code id="define_labels_+3A_n_row">n_row</code></td>
<td>
<p>A number, quantity of rows containing pivot table labels.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table definition functions: 
<code><a href="#topic+get_page">get_page</a>()</code>,
<code><a href="#topic+pivot_table">pivot_table</a>()</code>,
<code><a href="#topic+set_page">set_page</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pt_ex |&gt; define_labels(n_col = 2, n_row = 2)

</code></pre>

<hr>
<h2 id='df_ex'>Pivot table in data frame with with thousands indicator and decimal numbers</h2><span id='topic+df_ex'></span>

<h3>Description</h3>

<p>Pivot table in data frame with with thousands indicator and decimal numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_ex
</code></pre>


<h3>Format</h3>

<p>A data frame.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pt_ex">pt_ex</a></code>
</p>
<p>Other pivot table in data frame: 
<code><a href="#topic+df_ex_compact">df_ex_compact</a></code>,
<code><a href="#topic+df_pivottabler">df_pivottabler</a></code>
</p>

<hr>
<h2 id='df_ex_compact'>Pivot table in data frame with a column with data from two label fields</h2><span id='topic+df_ex_compact'></span>

<h3>Description</h3>

<p>Pivot table in data frame in compact table format: with a column with data
from two label fields.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_ex_compact
</code></pre>


<h3>Format</h3>

<p>A data frame.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pf_ex_compact">pf_ex_compact</a></code>
</p>
<p>Other pivot table in data frame: 
<code><a href="#topic+df_ex">df_ex</a></code>,
<code><a href="#topic+df_pivottabler">df_pivottabler</a></code>
</p>

<hr>
<h2 id='df_pivottabler'>Pivot table with basic and subtotal labels in the same column</h2><span id='topic+df_pivottabler'></span>

<h3>Description</h3>

<p>A dataset containing number of train passengers, generated with the
<code>pivottabler</code> package. It contains basic and subtotal labels in the same column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_pivottabler
</code></pre>


<h3>Format</h3>

<p>A data frame.
</p>


<h3>Source</h3>

<p><a href="https://CRAN.R-project.org/package=pivottabler">https://CRAN.R-project.org/package=pivottabler</a>
</p>


<h3>See Also</h3>

<p>Other pivot table in data frame: 
<code><a href="#topic+df_ex_compact">df_ex_compact</a></code>,
<code><a href="#topic+df_ex">df_ex</a></code>
</p>

<hr>
<h2 id='df_set_h'>Set of pivot tables placed horizontally on one sheet</h2><span id='topic+df_set_h'></span>

<h3>Description</h3>

<p>Set of pivot tables placed horizontally on one sheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_set_h
</code></pre>


<h3>Format</h3>

<p>A data frame.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+df_ex">df_ex</a></code>
</p>
<p>Other pivot table set in data frame: 
<code><a href="#topic+df_set_h_v">df_set_h_v</a></code>,
<code><a href="#topic+df_set_v">df_set_v</a></code>
</p>

<hr>
<h2 id='df_set_h_v'>Set of pivot tables on one sheet</h2><span id='topic+df_set_h_v'></span>

<h3>Description</h3>

<p>Example of a set of pivot tables located horizontally and vertically on one
sheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_set_h_v
</code></pre>


<h3>Format</h3>

<p>A data frame.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+df_ex">df_ex</a></code>
</p>
<p>Other pivot table set in data frame: 
<code><a href="#topic+df_set_h">df_set_h</a></code>,
<code><a href="#topic+df_set_v">df_set_v</a></code>
</p>

<hr>
<h2 id='df_set_v'>Set of pivot tables placed vertically on one sheet</h2><span id='topic+df_set_v'></span>

<h3>Description</h3>

<p>Set of pivot tables placed vertically on one sheet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_set_v
</code></pre>


<h3>Format</h3>

<p>A data frame.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+df_ex">df_ex</a></code>
</p>
<p>Other pivot table set in data frame: 
<code><a href="#topic+df_set_h_v">df_set_h_v</a></code>,
<code><a href="#topic+df_set_h">df_set_h</a></code>
</p>

<hr>
<h2 id='divide'>Divide table</h2><span id='topic+divide'></span><span id='topic+divide.pivot_table'></span>

<h3>Description</h3>

<p>Divides a table into tables separated by some empty row or column. Returns a
<code>pivot_table</code> object list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>divide(pt)

## S3 method for class 'pivot_table'
divide(pt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="divide_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes multiple pivot tables are placed in a text document, imported as
one text table. This operation recursively divides the initial table into
tables separated by some empty row or column. Once a division has been made,
it tries to divide each part of the result. An object is generated for each
indivisible pivot table. Returns a list of <code>pivot_table</code> objects.
</p>
<p>If individual tables have a header or footer, they should not be separated
from the table by empty rows. If they were, objects would be generated from
them that must later be removed from the list of objects in the result.
</p>
<p>The operation can be applied to tables located horizontally, vertically or in
a grid on the initial table. The only requirement to be able to divide it is
that there is some empty row or column between them.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> list.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other flat table list functions: 
<code><a href="#topic+flatten_table_list">flatten_table_list</a>()</code>,
<code><a href="#topic+get_col_values">get_col_values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pivot_table(df_set_h_v)
lpt &lt;- pt |&gt; divide()

</code></pre>

<hr>
<h2 id='extract_labels'>Extract labels</h2><span id='topic+extract_labels'></span><span id='topic+extract_labels.pivot_table'></span>

<h3>Description</h3>

<p>Extract the given set of labels from a table column in compact format to
generate a new column in the table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_labels(pt, col, labels)

## S3 method for class 'pivot_table'
extract_labels(pt, col = 1, labels = c())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_labels_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="extract_labels_+3A_col">col</code></td>
<td>
<p>A number, column from which labels are extracted.</p>
</td></tr>
<tr><td><code id="extract_labels_+3A_labels">labels</code></td>
<td>
<p>A vector of strings, set of labels to extract.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes a table column includes values of multiple label fields, this is
generally known as compact table format. Given a column number and a set of
labels, it generates a new column with the labels located at the positions
they occupied in the original column and removes them from it.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pivot_table(df_ex_compact) |&gt;
  extract_labels(col = 1, labels = c("b1", "b2", "b3", "b4", "Total general"))

</code></pre>

<hr>
<h2 id='fill_labels'>Fill in missing labels</h2><span id='topic+fill_labels'></span><span id='topic+fill_labels.pivot_table'></span>

<h3>Description</h3>

<p>Fills missing values in row and column labels for a pivot table. By default,
columns are filled down and rows are filled right.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_labels(pt, down, right)

## S3 method for class 'pivot_table'
fill_labels(pt, down = TRUE, right = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fill_labels_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="fill_labels_+3A_down">down</code></td>
<td>
<p>A boolean, fill down.</p>
</td></tr>
<tr><td><code id="fill_labels_+3A_right">right</code></td>
<td>
<p>A boolean, fill right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data. The row and column closest to the data array
are not filled (they must have data defined for each cell).
</p>
<p>To correctly carry out this operation, the number of rows and columns that
contain labels must be defined, and the table must only contain the pivot
table rows and columns.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;-
  pt_ex |&gt;
  remove_top(1) |&gt;
  define_labels(n_col = 2, n_row = 2) |&gt;
  fill_labels(down = TRUE, right = TRUE)

</code></pre>

<hr>
<h2 id='fill_values'>Fill in missing values</h2><span id='topic+fill_values'></span><span id='topic+fill_values.pivot_table'></span>

<h3>Description</h3>

<p>Fills with NA missing values in a pivot table value array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_values(pt)

## S3 method for class 'pivot_table'
fill_values(pt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fill_values_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data.
</p>
<p>To correctly carry out this operation, the number of rows and columns that
contain labels must be defined, and the table must only contain the pivot
table rows and columns.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;-
  pt_ex |&gt;
  remove_top(1) |&gt;
  define_labels(n_col = 2, n_row = 2) |&gt;
  fill_values()

</code></pre>

<hr>
<h2 id='fill_vector'>Fill in missing values in a vector</h2><span id='topic+fill_vector'></span>

<h3>Description</h3>

<p>Fills missing values in a vector with previous value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_vector(v, contrary)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fill_vector_+3A_v">v</code></td>
<td>
<p>A vector.</p>
</td></tr>
<tr><td><code id="fill_vector_+3A_contrary">contrary</code></td>
<td>
<p>A boolean, fill in contrary sense.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector.
</p>

<hr>
<h2 id='flatten_table_list'>Transform a <code>pivot_table</code> object list into a flat table</h2><span id='topic+flatten_table_list'></span>

<h3>Description</h3>

<p>Given a list of <code>pivot_table</code> objects and a transformation function that
flattens a <code>pivot_table</code> object, transforms each object using the function
and merges the results into a flat table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flatten_table_list(lpt = list(), FUN)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flatten_table_list_+3A_lpt">lpt</code></td>
<td>
<p>A list of <code>pivot_table</code> objects.</p>
</td></tr>
<tr><td><code id="flatten_table_list_+3A_fun">FUN</code></td>
<td>
<p>A function, transformation function that flattens a <code>pivot_table</code>
object (it returns a <code>tibble</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tibble</code>, a flat table implemented by a <code>tibble</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other flat table list functions: 
<code><a href="#topic+divide">divide</a>()</code>,
<code><a href="#topic+get_col_values">get_col_values</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
f &lt;- function(pt) {
 pt |&gt;
    set_page(1, 1) |&gt;
    remove_top(1) |&gt;
    define_labels(n_col = 2, n_row = 2) |&gt;
    remove_k() |&gt;
    replace_dec() |&gt;
    fill_values() |&gt;
    fill_labels() |&gt;
    remove_agg() |&gt;
    unpivot()
}

pt &lt;- pivot_table(df_set_h_v)
lpt &lt;- pt |&gt; divide()
ft &lt;- flatten_table_list(lpt, f)

</code></pre>

<hr>
<h2 id='ft_ex'>Flat table with page from a pivot table with with thousands indicator and decimal numbers</h2><span id='topic+ft_ex'></span>

<h3>Description</h3>

<p>Flat table with page from a pivot table with with thousands indicator and decimal numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ft_ex
</code></pre>


<h3>Format</h3>

<p>A <code>tibble</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+df_ex">df_ex</a></code>
</p>
<p>Other flat table: 
<code><a href="#topic+ft_ex_v2">ft_ex_v2</a></code>,
<code><a href="#topic+ft_set">ft_set</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Defined by:

ft_ex &lt;- pivot_table(df_ex) |&gt;
  set_page(1, 1) |&gt;
  remove_top(1) |&gt;
  define_labels(n_col = 2, n_row = 2) |&gt;
  remove_k() |&gt;
  replace_dec() |&gt;
  fill_values() |&gt;
  fill_labels() |&gt;
  remove_agg() |&gt;
  unpivot()

</code></pre>

<hr>
<h2 id='ft_ex_v2'>Flat table without page from a pivot table with with thousands indicator and decimal numbers</h2><span id='topic+ft_ex_v2'></span>

<h3>Description</h3>

<p>Flat table without page from a pivot table with with thousands indicator and decimal numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ft_ex_v2
</code></pre>


<h3>Format</h3>

<p>A <code>tibble</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+df_ex">df_ex</a></code>
</p>
<p>Other flat table: 
<code><a href="#topic+ft_ex">ft_ex</a></code>,
<code><a href="#topic+ft_set">ft_set</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Defined by:

ft_ex_v2 &lt;- pivot_table(df_ex) |&gt;
  set_page(1, 1) |&gt;
  remove_top(1) |&gt;
  define_labels(n_col = 2, n_row = 2) |&gt;
  remove_k() |&gt;
  replace_dec() |&gt;
  fill_values() |&gt;
  fill_labels() |&gt;
  remove_agg() |&gt;
  unpivot(include_page = FALSE,
  na_rm = FALSE)

</code></pre>

<hr>
<h2 id='ft_set'>Flat table with page from a pivot table with with thousands indicator and decimal numbers</h2><span id='topic+ft_set'></span>

<h3>Description</h3>

<p>Flat table with page from a pivot table with with thousands indicator and decimal numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ft_set
</code></pre>


<h3>Format</h3>

<p>A <code>tibble</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+df_set_h_v">df_set_h_v</a></code>
</p>
<p>Other flat table: 
<code><a href="#topic+ft_ex_v2">ft_ex_v2</a></code>,
<code><a href="#topic+ft_ex">ft_ex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Defined by:

f &lt;- function(pt) {
 pt |&gt;
    set_page(1, 1) |&gt;
    remove_top(1) |&gt;
    define_labels(n_col = 2, n_row = 2) |&gt;
    remove_k() |&gt;
    replace_dec() |&gt;
    fill_values() |&gt;
    fill_labels() |&gt;
    remove_agg() |&gt;
    unpivot()
}

pt &lt;- pivot_table(df_set_h_v)
lpt &lt;- pt |&gt; divide()
ft_set &lt;- flatten_table_list(lpt, f)

</code></pre>

<hr>
<h2 id='get_col_values'>Get column values</h2><span id='topic+get_col_values'></span>

<h3>Description</h3>

<p>Gets the values of the indicated column of each table in a list of tables,
avoiding the rows at the beginning or the end of each table that are
indicated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_col_values(lpt, col = 1, start_row = 2, rows_left = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_col_values_+3A_lpt">lpt</code></td>
<td>
<p><code>pivot_table</code> object list.</p>
</td></tr>
<tr><td><code id="get_col_values_+3A_col">col</code></td>
<td>
<p>A number, column to consider.</p>
</td></tr>
<tr><td><code id="get_col_values_+3A_start_row">start_row</code></td>
<td>
<p>A number, start row in each table.</p>
</td></tr>
<tr><td><code id="get_col_values_+3A_rows_left">rows_left</code></td>
<td>
<p>A number, rows to ignore at the end of each table.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes a column includes values of multiple label fields. To facilitate
the study of the labels included in the same column of several tables, this
function gets the values of the indicated column in a list of tables.
</p>


<h3>Value</h3>

<p>Data frame with two columns: Labels in the column, and the index of
the table in the list of tables from which they come.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other flat table list functions: 
<code><a href="#topic+divide">divide</a>()</code>,
<code><a href="#topic+flatten_table_list">flatten_table_list</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pivot_table(df_set_h_v)
lpt &lt;- pt |&gt; divide()
df &lt;- get_col_values(lpt, col = 1, start_row = 4)
labels &lt;- sort(unique(df$label))

</code></pre>

<hr>
<h2 id='get_page'>Get the page information of a pivot table</h2><span id='topic+get_page'></span><span id='topic+get_page.pivot_table'></span>

<h3>Description</h3>

<p>Get the page information associated with the pivot table represented by the
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_page(pt)

## S3 method for class 'pivot_table'
get_page(pt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_page_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each pivot table implements a report. The pivot table page represents the
context of that report. It is useful when we work with several pivot tables
with the same structure: for example, the page can allow us to differentiate
their origin, date or author. This information is often included in the file
name, sheet name, or cells attached to the pivot table.
</p>


<h3>Value</h3>

<p>A vector of strings.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table definition functions: 
<code><a href="#topic+define_labels">define_labels</a>()</code>,
<code><a href="#topic+pivot_table">pivot_table</a>()</code>,
<code><a href="#topic+set_page">set_page</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>page &lt;- pt_ex |&gt; get_page()

</code></pre>

<hr>
<h2 id='pf_ex_compact'>Pivot table result of transforming a data frame with a column with data from two label fields</h2><span id='topic+pf_ex_compact'></span>

<h3>Description</h3>

<p>Pivot table result of transforming a data frame in compact table format: with a column with data
from two label fields.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pf_ex_compact
</code></pre>


<h3>Format</h3>

<p>A<code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+df_ex_compact">df_ex_compact</a></code>
</p>
<p>Other pivot table: 
<code><a href="#topic+pt_ex">pt_ex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Defined by:

pf_ex_compact &lt;- pivot_table(df_ex_compact) |&gt;
  extract_labels(col = 1,
                 labels = c("b1", "b2", "b3", "b4", "Total general"))

</code></pre>

<hr>
<h2 id='pivot_table'><code>pivot_table</code> S3 class</h2><span id='topic+pivot_table'></span>

<h3>Description</h3>

<p>Creates a <code>pivot_table</code> object from a data frame. Additional information
associated with the pivot table can be indicated. The data frame data is
converted to character data type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pivot_table(
  df,
  page = "",
  page_row = 0,
  page_col = 0,
  n_col_labels = 0,
  n_row_labels = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pivot_table_+3A_df">df</code></td>
<td>
<p>A data frame, contains one or more pivot tables.</p>
</td></tr>
<tr><td><code id="pivot_table_+3A_page">page</code></td>
<td>
<p>A string, additional information associated with the pivot table.</p>
</td></tr>
<tr><td><code id="pivot_table_+3A_page_row">page_row</code>, <code id="pivot_table_+3A_page_col">page_col</code></td>
<td>
<p>A cell (row and column number), page information
included in the table.</p>
</td></tr>
<tr><td><code id="pivot_table_+3A_n_col_labels">n_col_labels</code></td>
<td>
<p>A number, number of columns containing pivot table labels.</p>
</td></tr>
<tr><td><code id="pivot_table_+3A_n_row_labels">n_row_labels</code></td>
<td>
<p>A number, number of rows containing pivot table labels.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+divide">divide</a></code>
</p>
<p>Other pivot table definition functions: 
<code><a href="#topic+define_labels">define_labels</a>()</code>,
<code><a href="#topic+get_page">get_page</a>()</code>,
<code><a href="#topic+set_page">set_page</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pivot_table(df_ex)

pt &lt;- pivot_table(df_ex, page = "M4")

pt &lt;- pivot_table(df_ex, page_row = 1, page_col = 1)

pt &lt;- pivot_table(df_ex, page_row = 1, page_col = 1, n_col_labels = 2, n_row_labels = 2)

</code></pre>

<hr>
<h2 id='pt_ex'>Pivot table with with thousands indicator and decimal numbers</h2><span id='topic+pt_ex'></span>

<h3>Description</h3>

<p>Pivot table with with thousands indicator and decimal numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pt_ex
</code></pre>


<h3>Format</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+df_ex">df_ex</a></code>
</p>
<p>Other pivot table: 
<code><a href="#topic+pf_ex_compact">pf_ex_compact</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Defined by:

pt_ex &lt;- pivot_table(df_ex)

</code></pre>

<hr>
<h2 id='read_excel_file'>Import Excel file</h2><span id='topic+read_excel_file'></span>

<h3>Description</h3>

<p>Reads sheets from an Excel file and creates a <code>pivot_table</code> object list, one
from each sheet. Each sheet is expected to contain a pivot table. Each line
in a sheet corresponds to a row in a table. The file and sheet names are
included as part of each object attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_excel_file(
  file,
  sheetIndexes = NULL,
  sheetNames = NULL,
  define_page = 3,
  page_sep = ":"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_excel_file_+3A_file">file</code></td>
<td>
<p>A string, name of an Excel file.</p>
</td></tr>
<tr><td><code id="read_excel_file_+3A_sheetindexes">sheetIndexes</code></td>
<td>
<p>A vector of numbers, sheet indexes in the workbook.</p>
</td></tr>
<tr><td><code id="read_excel_file_+3A_sheetnames">sheetNames</code></td>
<td>
<p>A vector of strings, sheet names.</p>
</td></tr>
<tr><td><code id="read_excel_file_+3A_define_page">define_page</code></td>
<td>
<p>A integer, 0: no page, 1: file name as page, 2: sheet name
as page, 3: file and sheet names as page, separated by the indicated separator.</p>
</td></tr>
<tr><td><code id="read_excel_file_+3A_page_sep">page_sep</code></td>
<td>
<p>A string, separator to form the page value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When multiple files or sheets are handled, the file and/or sheet names may
contain information associated with the pivot table, they could be the table
page information. In order not to lose this information, they are always
stored in each <code>pivot_table</code> object.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object list.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other import functions: 
<code><a href="#topic+read_excel_folder">read_excel_folder</a>()</code>,
<code><a href="#topic+read_excel_sheet">read_excel_sheet</a>()</code>,
<code><a href="#topic+read_text_file">read_text_file</a>()</code>,
<code><a href="#topic+read_text_folder">read_text_folder</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file &lt;- system.file("extdata", "excel/set_sheets.xlsx", package = "flattabler")
lpt &lt;- read_excel_file(file)

lpt &lt;- read_excel_file(file, sheetIndexes = 1:4)

lpt &lt;- read_excel_file(file, sheetNames = c("M1", "M2", "M3", "M4"))

</code></pre>

<hr>
<h2 id='read_excel_folder'>Import one sheet from each Excel file in a folder</h2><span id='topic+read_excel_folder'></span>

<h3>Description</h3>

<p>Reads one sheet (or all sheets) from each of the Excel files in a folder and
creates a list of <code>pivot_table</code> objects, one from each sheet. Each sheet is
expected to contain a pivot table. Each line in a file corresponds to a row
in a table. File and sheet names are included as part of each object
attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_excel_folder(
  folder,
  sheetIndex = 1,
  sheetName = NULL,
  allSheets = FALSE,
  define_page = 3,
  page_sep = ":"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_excel_folder_+3A_folder">folder</code></td>
<td>
<p>A string, folder name.</p>
</td></tr>
<tr><td><code id="read_excel_folder_+3A_sheetindex">sheetIndex</code></td>
<td>
<p>A number, sheet index in the workbook.</p>
</td></tr>
<tr><td><code id="read_excel_folder_+3A_sheetname">sheetName</code></td>
<td>
<p>A string, sheet name.</p>
</td></tr>
<tr><td><code id="read_excel_folder_+3A_allsheets">allSheets</code></td>
<td>
<p>A boolean.</p>
</td></tr>
<tr><td><code id="read_excel_folder_+3A_define_page">define_page</code></td>
<td>
<p>A integer, 0: no page, 1: file name as page, 2: sheet name
as page, 3: file and sheet names as page, separated by the indicated separator.</p>
</td></tr>
<tr><td><code id="read_excel_folder_+3A_page_sep">page_sep</code></td>
<td>
<p>A string, separator to form the page value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When multiple files or sheets are handled, the file and/or sheet names may
contain information associated with the pivot table, they could be the table
page information. In order not to lose this information, they are always
stored in each <code>pivot_table</code> object.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object list.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other import functions: 
<code><a href="#topic+read_excel_file">read_excel_file</a>()</code>,
<code><a href="#topic+read_excel_sheet">read_excel_sheet</a>()</code>,
<code><a href="#topic+read_text_file">read_text_file</a>()</code>,
<code><a href="#topic+read_text_folder">read_text_folder</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>folder &lt;- system.file("extdata", "excelfolder", package = "flattabler")
lpt &lt;- read_excel_folder(folder)

lpt &lt;- read_excel_folder(folder, allSheets = TRUE)

</code></pre>

<hr>
<h2 id='read_excel_sheet'>Import Excel file sheet</h2><span id='topic+read_excel_sheet'></span>

<h3>Description</h3>

<p>Reads an Excel file sheet and creates a <code>pivot_table</code> object. The sheet is
expected to contain one or more pivot tables. Each line in the sheet
corresponds to a row in a table. The file and sheet names can be included as
part of the object attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_excel_sheet(
  file,
  sheetIndex = 1,
  sheetName = NULL,
  define_page = 3,
  page_sep = ":"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_excel_sheet_+3A_file">file</code></td>
<td>
<p>A string, name of an Excel file.</p>
</td></tr>
<tr><td><code id="read_excel_sheet_+3A_sheetindex">sheetIndex</code></td>
<td>
<p>A number, sheet index in the workbook.</p>
</td></tr>
<tr><td><code id="read_excel_sheet_+3A_sheetname">sheetName</code></td>
<td>
<p>A string, sheet name.</p>
</td></tr>
<tr><td><code id="read_excel_sheet_+3A_define_page">define_page</code></td>
<td>
<p>A integer, 0: no page, 1: file name as page, 2: sheet name
as page, 3: file and sheet names as page, separated by the indicated separator.</p>
</td></tr>
<tr><td><code id="read_excel_sheet_+3A_page_sep">page_sep</code></td>
<td>
<p>A string, separator to form the page value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When multiple files or sheets are handled, the file and/or sheet names may
contain information associated with the pivot table, they could be the table
page information. In order not to lose this information, they can be stored
in the <code>pivot_table</code> object.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other import functions: 
<code><a href="#topic+read_excel_file">read_excel_file</a>()</code>,
<code><a href="#topic+read_excel_folder">read_excel_folder</a>()</code>,
<code><a href="#topic+read_text_file">read_text_file</a>()</code>,
<code><a href="#topic+read_text_folder">read_text_folder</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file &lt;- system.file("extdata", "excelfolder/m4.xlsx", package = "flattabler")
pt &lt;- read_excel_sheet(file)

pt &lt;- read_excel_sheet(file, sheetName = "Hoja2", define_page = 1)

</code></pre>

<hr>
<h2 id='read_text_file'>Import text file</h2><span id='topic+read_text_file'></span>

<h3>Description</h3>

<p>Reads a text file and creates a <code>pivot_table</code> object. The file is expected to
contain one or more pivot tables. Each line in the file corresponds to a row
in a table; within each row, columns are defined by a separator character.
The file name is included as part of the object attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_text_file(file, sep = ";", encoding = "UTF-8", define_page = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_text_file_+3A_file">file</code></td>
<td>
<p>A string, name of a text file.</p>
</td></tr>
<tr><td><code id="read_text_file_+3A_sep">sep</code></td>
<td>
<p>Column separator character.</p>
</td></tr>
<tr><td><code id="read_text_file_+3A_encoding">encoding</code></td>
<td>
<p>A string, encoding to be assumed for input strings.</p>
</td></tr>
<tr><td><code id="read_text_file_+3A_define_page">define_page</code></td>
<td>
<p>A boolean, include file name as <code>pivot_table</code> page definition.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When multiple files are handled, the file name may contain information
associated with the pivot table, it could be the table page information. In
order not to lose this information, it can be stored in the <code>pivot_table</code>
object.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other import functions: 
<code><a href="#topic+read_excel_file">read_excel_file</a>()</code>,
<code><a href="#topic+read_excel_folder">read_excel_folder</a>()</code>,
<code><a href="#topic+read_excel_sheet">read_excel_sheet</a>()</code>,
<code><a href="#topic+read_text_folder">read_text_folder</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file &lt;- system.file("extdata", "m4.csv", package = "flattabler")
pt &lt;- read_text_file(file)

</code></pre>

<hr>
<h2 id='read_text_folder'>Import all text files in a folder</h2><span id='topic+read_text_folder'></span>

<h3>Description</h3>

<p>Reads all text files in a folder and creates a list of <code>pivot_table</code> objects,
one from each file. Each file is expected to contain a pivot table. Each line
in a file corresponds to a row in a table; within each row, columns are
defined by a separator character. File name is included as part of each
object attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_text_folder(folder, sep = ";", encoding = "UTF-8")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_text_folder_+3A_folder">folder</code></td>
<td>
<p>A string, folder name.</p>
</td></tr>
<tr><td><code id="read_text_folder_+3A_sep">sep</code></td>
<td>
<p>Column separator character.</p>
</td></tr>
<tr><td><code id="read_text_folder_+3A_encoding">encoding</code></td>
<td>
<p>A string, encoding to be assumed for input strings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When multiple files are handled, the file name may contain information
associated with the pivot table, it could be the table page information. In
order not to lose this information, it is always stored in each <code>pivot_table</code>
object.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object list.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other import functions: 
<code><a href="#topic+read_excel_file">read_excel_file</a>()</code>,
<code><a href="#topic+read_excel_folder">read_excel_folder</a>()</code>,
<code><a href="#topic+read_excel_sheet">read_excel_sheet</a>()</code>,
<code><a href="#topic+read_text_file">read_text_file</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
folder &lt;- system.file("extdata", "csvfolder", package = "flattabler")
lpt &lt;- read_text_folder(folder)

</code></pre>

<hr>
<h2 id='remove_agg'>Remove rows and columns with aggregated data</h2><span id='topic+remove_agg'></span><span id='topic+remove_agg.pivot_table'></span>

<h3>Description</h3>

<p>Aggregated data is recognized because the label of the row or column closest
to the array of values is empty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_agg(pt)

## S3 method for class 'pivot_table'
remove_agg(pt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_agg_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data.
</p>
<p>Removes pivot table rows and columns that contain aggregated data. It only
checks the value in the row or column closest to the array of values.
</p>
<p>To correctly carry out this operation, the number of rows and columns that
contain labels must be defined, and the table must only contain the pivot
table rows and columns.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;-
  pt_ex |&gt;
  remove_top(1) |&gt;
  define_labels(n_col = 2, n_row = 2) |&gt;
  remove_agg()

</code></pre>

<hr>
<h2 id='remove_bottom'>Remove bottom rows from a pivot table</h2><span id='topic+remove_bottom'></span><span id='topic+remove_bottom.pivot_table'></span>

<h3>Description</h3>

<p>Remove bottom rows from the pivot table represented by the object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_bottom(pt, n)

## S3 method for class 'pivot_table'
remove_bottom(pt, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_bottom_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="remove_bottom_+3A_n">n</code></td>
<td>
<p>A number, number of rows to remove.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data.
</p>
<p>All rows not belonging to the pivot table must be removed. It is common to
find rows with footer information, which must be removed.
</p>
<p>This function is very useful because it is not necessary to know the number
of rows in the table.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pt_ex |&gt; remove_bottom(3)

</code></pre>

<hr>
<h2 id='remove_cols'>Remove columns from a pivot table</h2><span id='topic+remove_cols'></span><span id='topic+remove_cols.pivot_table'></span>

<h3>Description</h3>

<p>Remove the columns whose numbers are indicated from the pivot table
represented by the object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_cols(pt, c)

## S3 method for class 'pivot_table'
remove_cols(pt, c)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_cols_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="remove_cols_+3A_c">c</code></td>
<td>
<p>A vector of numbers, column numbers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data.
</p>
<p>All columns not belonging to the pivot table must be removed.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pt_ex |&gt; remove_cols(7)

pt &lt;- pt_ex |&gt; remove_cols(c(6,7))

</code></pre>

<hr>
<h2 id='remove_empty'>Remove empty rows and columns from a pivot table</h2><span id='topic+remove_empty'></span><span id='topic+remove_empty.pivot_table'></span>

<h3>Description</h3>

<p>Remove rows and columns without data from the pivot table represented by the
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_empty(pt)

## S3 method for class 'pivot_table'
remove_empty(pt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_empty_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data.
</p>
<p>All rows and columns not belonging to the pivot table must be removed,
including those without data.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
df &lt;- df_ex
df[seq(from = 1, to = 25, by = 2), ] &lt;- " "
df[, seq(from = 1, to = 7, by = 2)] &lt;- " "
pt &lt;- pivot_table(df)
pt &lt;- pt |&gt; remove_empty()

</code></pre>

<hr>
<h2 id='remove_k'>Remove thousands separator</h2><span id='topic+remove_k'></span><span id='topic+remove_k.pivot_table'></span>

<h3>Description</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data. Values, even though they are numbers, are
represented as text and sometimes include a thousands separator that can be
removed using this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_k(pt, sep)

## S3 method for class 'pivot_table'
remove_k(pt, sep = ".")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_k_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="remove_k_+3A_sep">sep</code></td>
<td>
<p>A character, thousands separator to remove.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To correctly carry out this operation, the number of rows and columns that
contain labels must be defined, and the table must only contain the pivot
table rows and columns.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;-
  pt_ex |&gt;
  remove_top(1) |&gt;
  define_labels(n_col = 2, n_row = 2) |&gt;
  remove_k()

</code></pre>

<hr>
<h2 id='remove_left'>Remove left columns from a pivot table</h2><span id='topic+remove_left'></span><span id='topic+remove_left.pivot_table'></span>

<h3>Description</h3>

<p>Remove left columns from the pivot table represented by the object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_left(pt, n)

## S3 method for class 'pivot_table'
remove_left(pt, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_left_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="remove_left_+3A_n">n</code></td>
<td>
<p>A number, number of columns to remove.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data.
</p>
<p>All columns not belonging to the pivot table must be removed.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pt_ex |&gt; remove_left(3)

</code></pre>

<hr>
<h2 id='remove_right'>Remove right columns from a pivot table</h2><span id='topic+remove_right'></span><span id='topic+remove_right.pivot_table'></span>

<h3>Description</h3>

<p>Remove right columns from the pivot table represented by the object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_right(pt, n)

## S3 method for class 'pivot_table'
remove_right(pt, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_right_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="remove_right_+3A_n">n</code></td>
<td>
<p>A number, number of columns to remove.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data.
</p>
<p>All columns not belonging to the pivot table must be removed.
</p>
<p>This function is very useful because it is not necessary to know the number
of columns in the table.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pt_ex |&gt; remove_right(3)

</code></pre>

<hr>
<h2 id='remove_rows'>Remove rows from a pivot table</h2><span id='topic+remove_rows'></span><span id='topic+remove_rows.pivot_table'></span>

<h3>Description</h3>

<p>Remove the rows whose numbers are indicated from the pivot table represented
by the object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_rows(pt, r)

## S3 method for class 'pivot_table'
remove_rows(pt, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_rows_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="remove_rows_+3A_r">r</code></td>
<td>
<p>A vector of numbers, row numbers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data.
</p>
<p>All rows not belonging to the pivot table must be removed. It is common to
find rows with header or footer information, which must be removed.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pt_ex |&gt; remove_rows(1)

pt &lt;- pt_ex |&gt; remove_rows(c(1, 8, 14, 19, 25, 26))

</code></pre>

<hr>
<h2 id='remove_top'>Remove top rows from a pivot table</h2><span id='topic+remove_top'></span><span id='topic+remove_top.pivot_table'></span>

<h3>Description</h3>

<p>Remove top rows from the pivot table represented by the object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_top(pt, n)

## S3 method for class 'pivot_table'
remove_top(pt, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_top_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="remove_top_+3A_n">n</code></td>
<td>
<p>A number, number of rows to remove.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data.
</p>
<p>All rows not belonging to the pivot table must be removed. It is common to
find rows with header information, which must be removed.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pt_ex |&gt; remove_top(3)

</code></pre>

<hr>
<h2 id='replace_dec'>Replace decimal separator</h2><span id='topic+replace_dec'></span><span id='topic+replace_dec.pivot_table'></span>

<h3>Description</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data. Values, even though they are numbers, are
represented as text and sometimes include a decimal separator different from
the one needed; it can be replaced using this function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_dec(pt, sep)

## S3 method for class 'pivot_table'
replace_dec(pt, sep = ".")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_dec_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="replace_dec_+3A_sep">sep</code></td>
<td>
<p>A character, new decimal separator to use.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To correctly carry out this operation, the number of rows and columns that
contain labels must be defined, and the table must only contain the pivot
table rows and columns.
</p>
<p>The only decimal separators considered are &quot;.&quot; and &quot;,&quot;.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+unpivot">unpivot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;-
  pt_ex |&gt;
  remove_top(1) |&gt;
  define_labels(n_col = 2, n_row = 2) |&gt;
  replace_dec()

</code></pre>

<hr>
<h2 id='set_page'>Set page information to a pivot table</h2><span id='topic+set_page'></span><span id='topic+set_page.pivot_table'></span>

<h3>Description</h3>

<p>Define the page information associated with a pivot table. Previously
existing information is replaced by new information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_page(pt, row, col, page)

## S3 method for class 'pivot_table'
set_page(pt, row = 0, col = 0, page = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_page_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="set_page_+3A_row">row</code>, <code id="set_page_+3A_col">col</code></td>
<td>
<p>A cell (row and column number), page information included in
the table.</p>
</td></tr>
<tr><td><code id="set_page_+3A_page">page</code></td>
<td>
<p>A string, page information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each pivot table implements a report. The pivot table page represents the
context of that report. It is useful when we work with several pivot tables
with the same structure: for example, the page can allow us to differentiate
their origin, date or author. This information is often included in the file
name, sheet name, or a cell attached to the pivot table.
</p>


<h3>Value</h3>

<p>A <code>pivot_table</code> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table definition functions: 
<code><a href="#topic+define_labels">define_labels</a>()</code>,
<code><a href="#topic+get_page">get_page</a>()</code>,
<code><a href="#topic+pivot_table">pivot_table</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
pt &lt;- pt_ex |&gt; set_page(1, 1)

pt &lt;- pt_ex |&gt; set_page(page = "M4")

</code></pre>

<hr>
<h2 id='spacer_columns'>Spacer columns</h2><span id='topic+spacer_columns'></span>

<h3>Description</h3>

<p>Gets the empty column numbers for a table. If there are several consecutive
empty columns, only one is considered. The first and last columns in the
table are also added to the list even if they are not empty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spacer_columns(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spacer_columns_+3A_df">df</code></td>
<td>
<p>A data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numbers.
</p>

<hr>
<h2 id='spacer_rows'>Spacer rows</h2><span id='topic+spacer_rows'></span>

<h3>Description</h3>

<p>Gets the empty row numbers for a table. If there are several consecutive
empty rows, only one is considered. The first and last rows in the table are
also added to the list even if they are not empty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spacer_rows(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spacer_rows_+3A_df">df</code></td>
<td>
<p>A data frame.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of numbers.
</p>

<hr>
<h2 id='unpivot'>Unpivot a pivot table</h2><span id='topic+unpivot'></span><span id='topic+unpivot.pivot_table'></span>

<h3>Description</h3>

<p>Transforms a pivot table into a flat table (implemented by a <code>tibble</code>). An
additional column with page information can be included. NA values can be
excluded from the array of values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unpivot(pt, include_page, na_rm, keep_col_names)

## S3 method for class 'pivot_table'
unpivot(pt, include_page = TRUE, na_rm = TRUE, keep_col_names = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unpivot_+3A_pt">pt</code></td>
<td>
<p>A <code>pivot_table</code> object.</p>
</td></tr>
<tr><td><code id="unpivot_+3A_include_page">include_page</code></td>
<td>
<p>A boolean, indicates whether a column with the page
information is included or not.</p>
</td></tr>
<tr><td><code id="unpivot_+3A_na_rm">na_rm</code></td>
<td>
<p>A boolean, indicates whether NA values from the array of values
are removed or not.</p>
</td></tr>
<tr><td><code id="unpivot_+3A_keep_col_names">keep_col_names</code></td>
<td>
<p>A boolean, if possible, keep the column names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A pivot table should only contain label rows and columns, and an array of
values, usually numeric data.
</p>
<p>To correctly carry out this operation, the number of rows and columns that
contain labels must be defined, and the table must only contain the pivot
table rows and columns.
</p>


<h3>Value</h3>

<p>A <code>tibble</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pivot_table">pivot_table</a></code>
</p>
<p>Other pivot table transformation functions: 
<code><a href="#topic+extract_labels">extract_labels</a>()</code>,
<code><a href="#topic+fill_labels">fill_labels</a>()</code>,
<code><a href="#topic+fill_values">fill_values</a>()</code>,
<code><a href="#topic+remove_agg">remove_agg</a>()</code>,
<code><a href="#topic+remove_bottom">remove_bottom</a>()</code>,
<code><a href="#topic+remove_cols">remove_cols</a>()</code>,
<code><a href="#topic+remove_empty">remove_empty</a>()</code>,
<code><a href="#topic+remove_k">remove_k</a>()</code>,
<code><a href="#topic+remove_left">remove_left</a>()</code>,
<code><a href="#topic+remove_right">remove_right</a>()</code>,
<code><a href="#topic+remove_rows">remove_rows</a>()</code>,
<code><a href="#topic+remove_top">remove_top</a>()</code>,
<code><a href="#topic+replace_dec">replace_dec</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
a_tibble &lt;-
  pt_ex |&gt;
  remove_top(1) |&gt;
  define_labels(n_col = 2, n_row = 2) |&gt;
  unpivot(include_page = FALSE)

a_tibble &lt;-
  pt_ex |&gt;
  set_page(1, 1) |&gt;
  remove_top(1) |&gt;
  define_labels(n_col = 2, n_row = 2) |&gt;
  remove_k() |&gt;
  replace_dec() |&gt;
  fill_values() |&gt;
  fill_labels() |&gt;
  remove_agg() |&gt;
  unpivot()

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
