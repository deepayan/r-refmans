<!DOCTYPE html><html lang="en-US"><head><title>Help for package amadeus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {amadeus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#apply_extent'><p>Apply extent to the processed data</p></a></li>
<li><a href='#as_mysftime'><p>Create an <code>sftime</code> object</p></a></li>
<li><a href='#calc_check_time'><p>Check time values</p></a></li>
<li><a href='#calc_message'><p>Send progress messages</p></a></li>
<li><a href='#calc_prepare_locs'><p>Prepare extraction locations</p></a></li>
<li><a href='#calc_return_locs'><p>Prepare covariates for return</p></a></li>
<li><a href='#calc_setcolumns'><p>Set column names</p></a></li>
<li><a href='#calc_time'><p>Prepare time values</p></a></li>
<li><a href='#calc_worker'><p>Perform covariate extraction</p></a></li>
<li><a href='#calculate_covariates'><p>Calculate covariates wrapper function</p></a></li>
<li><a href='#calculate_ecoregion'><p>Calculate ecoregions covariates</p></a></li>
<li><a href='#calculate_geos'><p>Calculate atmospheric composition covariates</p></a></li>
<li><a href='#calculate_gmted'><p>Calculate elevation covariates</p></a></li>
<li><a href='#calculate_gridmet'><p>Calculate gridMET covariates</p></a></li>
<li><a href='#calculate_groads'><p>Calculate roads covariates</p></a></li>
<li><a href='#calculate_hms'><p>Calculate wildfire smoke covariates</p></a></li>
<li><a href='#calculate_koppen_geiger'><p>Calculate climate classification covariates</p></a></li>
<li><a href='#calculate_lagged'><p>Calculate temporally lagged covariates</p></a></li>
<li><a href='#calculate_merra2'><p>Calculate meteorological and atmospheric covariates</p></a></li>
<li><a href='#calculate_modis'><p>Calculate MODIS product covariates in multiple CPU threads</p></a></li>
<li><a href='#calculate_modis_daily'><p>A single-date MODIS worker</p></a></li>
<li><a href='#calculate_narr'><p>Calculate meteorological covariates</p></a></li>
<li><a href='#calculate_nei'><p>Calculate road emissions covariates</p></a></li>
<li><a href='#calculate_nlcd'><p>Calculate land cover covariates</p></a></li>
<li><a href='#calculate_population'><p>Calculate population density covariates</p></a></li>
<li><a href='#calculate_temporal_dummies'><p>Calculate temporal dummy covariates</p></a></li>
<li><a href='#calculate_terraclimate'><p>Calculate TerraClimate covariates</p></a></li>
<li><a href='#calculate_tri'><p>Calculate toxic release covariates</p></a></li>
<li><a href='#check_destfile'><p>Check if destination file exists or is 0 bytes.</p></a></li>
<li><a href='#check_for_null_parameters'><p>Check parameters</p></a></li>
<li><a href='#check_geom'><p>Check that <code>geom</code> value is one of <code>FALSE</code>, <code>"sf"</code>, or <code>"terra"</code></p></a></li>
<li><a href='#check_mysf'><p>Check <code>sf</code> object</p></a></li>
<li><a href='#check_mysftime'><p>Check <code>sftime</code> object</p></a></li>
<li><a href='#check_url_status'><p>Check HTTP status</p></a></li>
<li><a href='#check_urls'><p>Implement <code>check_url_status</code></p></a></li>
<li><a href='#download_aqs'><p>Download air quality data</p></a></li>
<li><a href='#download_cropscape'><p>Download CropScape data</p></a></li>
<li><a href='#download_data'><p>Download raw data wrapper function</p></a></li>
<li><a href='#download_ecoregion'><p>Download ecoregion data</p></a></li>
<li><a href='#download_epa_certificate'><p>Check EPA certificate</p></a></li>
<li><a href='#download_geos'><p>Download atmospheric composition data</p></a></li>
<li><a href='#download_gmted'><p>Download elevation data</p></a></li>
<li><a href='#download_gridmet'><p>Download gridMET data</p></a></li>
<li><a href='#download_groads'><p>Download roads data</p></a></li>
<li><a href='#download_hash'><p>Create hash of downloaded files.</p></a></li>
<li><a href='#download_hms'><p>Download wildfire smoke data</p></a></li>
<li><a href='#download_huc'><p>Download National Hydrography Dataset (NHD) data</p></a></li>
<li><a href='#download_koppen_geiger'><p>Download climate classification data</p></a></li>
<li><a href='#download_merra2'><p>Download meteorological and atmospheric data</p></a></li>
<li><a href='#download_modis'><p>Download MODIS product files</p></a></li>
<li><a href='#download_narr'><p>Download meteorological data</p></a></li>
<li><a href='#download_nei'><p>Download road emissions data</p></a></li>
<li><a href='#download_nlcd'><p>Download land cover data</p></a></li>
<li><a href='#download_permit'><p>Check data download acknowledgement</p></a></li>
<li><a href='#download_population'><p>Download population density data</p></a></li>
<li><a href='#download_prism'><p>Download PRISM data</p></a></li>
<li><a href='#download_remove_command'><p>Remove download commands</p></a></li>
<li><a href='#download_remove_zips'><p>Remove zip files</p></a></li>
<li><a href='#download_run'><p>Run download commands</p></a></li>
<li><a href='#download_sanitize_path'><p>Sanitize directory</p></a></li>
<li><a href='#download_setup_dir'><p>Setup directory</p></a></li>
<li><a href='#download_sink'><p>Sink download commands</p></a></li>
<li><a href='#download_terraclimate'><p>Download TerraClimate data</p></a></li>
<li><a href='#download_tri'><p>Download toxic release data</p></a></li>
<li><a href='#download_unzip'><p>Unzip zip files</p></a></li>
<li><a href='#dt_as_mysftime'><p>Convert a <code>data.table</code> to an <code>sftime</code></p></a></li>
<li><a href='#extract_urls'><p>Extract download URLs</p></a></li>
<li><a href='#generate_date_sequence'><p>Generate date sequence</p></a></li>
<li><a href='#generate_time_sequence'><p>Generate time sequence</p></a></li>
<li><a href='#is_date_proper'><p>Check date format</p></a></li>
<li><a href='#narr_variable'><p>Sort NOAA NARR variables</p></a></li>
<li><a href='#process_aqs'><p>Process U.S. EPA AQS daily CSV data</p></a></li>
<li><a href='#process_blackmarble'><p>Assign VIIRS Black Marble products corner coordinates to retrieve a merged raster</p></a></li>
<li><a href='#process_blackmarble_corners'><p>Process Black Marble corners</p></a></li>
<li><a href='#process_collection'><p>Process GEOS-CF and MERRA2 collection codes</p></a></li>
<li><a href='#process_conformity'><p>Check input assumptions</p></a></li>
<li><a href='#process_covariates'><p>Process raw data wrapper function</p></a></li>
<li><a href='#process_cropscape'><p>Process CropScape data</p></a></li>
<li><a href='#process_ecoregion'><p>Process ecoregion data</p></a></li>
<li><a href='#process_flatten_sds'><p>Process MODIS layers</p></a></li>
<li><a href='#process_geos'><p>Process atmospheric composition data</p></a></li>
<li><a href='#process_gmted'><p>Process elevation data</p></a></li>
<li><a href='#process_gmted_codes'><p>Process elevation statistic and resolution codes</p></a></li>
<li><a href='#process_gridmet'><p>Process gridMET data</p></a></li>
<li><a href='#process_gridmet_codes'><p>Process gridMET variable codes</p></a></li>
<li><a href='#process_groads'><p>Process roads data</p></a></li>
<li><a href='#process_hms'><p>Process wildfire smoke data</p></a></li>
<li><a href='#process_huc'><p>Retrieve Hydrologic Unit Code (HUC) data</p></a></li>
<li><a href='#process_koppen_geiger'><p>Process climate classification data</p></a></li>
<li><a href='#process_locs_radius'><p>Process locations buffer</p></a></li>
<li><a href='#process_locs_vector'><p>Process locations as <code>SpatVector</code></p></a></li>
<li><a href='#process_merra2'><p>Process meteorological and atmospheric data</p></a></li>
<li><a href='#process_merra2_time'><p>Process MERRA2 time steps</p></a></li>
<li><a href='#process_modis_merge'><p>Process MODIS .hdf files</p></a></li>
<li><a href='#process_modis_sds'><p>Process MODIS sub-datasets</p></a></li>
<li><a href='#process_modis_swath'><p>Mosaic MODIS swaths</p></a></li>
<li><a href='#process_modis_warp'><p>Warp MODIS swath data into rectilinear grid raster</p></a></li>
<li><a href='#process_narr'><p>Process meteorological data</p></a></li>
<li><a href='#process_nei'><p>Process road emissions data</p></a></li>
<li><a href='#process_nlcd'><p>Process land cover data</p></a></li>
<li><a href='#process_population'><p>Process population density data</p></a></li>
<li><a href='#process_prism'><p>Process PRISM data</p></a></li>
<li><a href='#process_sedac_codes'><p>Process population resolution code</p></a></li>
<li><a href='#process_terraclimate'><p>Process TerraClimate data</p></a></li>
<li><a href='#process_terraclimate_codes'><p>Process terraClimate variable codes</p></a></li>
<li><a href='#process_tri'><p>Process toxic release data</p></a></li>
<li><a href='#process_variable_codes'><p>Filter gridMET and terraClimate variable names and variable codes</p></a></li>
<li><a href='#read_commands'><p>Import download commands</p></a></li>
<li><a href='#rename_time'><p>Rename <code>$time</code></p></a></li>
<li><a href='#sf_as_mysftime'><p>Convert an <code>sf</code> to an <code>sftime</code></p></a></li>
<li><a href='#sftime_as_mysftime'><p>Convert an <code>sftime</code> to a <code>mysftime</code></p></a></li>
<li><a href='#sftime_as_sf'><p>Convert an <code>sftime</code> to an <code>sf</code></p></a></li>
<li><a href='#sftime_as_spatraster'><p>Convert an <code>sftime</code> to a <code>SpatRaster</code></p></a></li>
<li><a href='#sftime_as_spatrds'><p>Convert an <code>sftime</code> to a <code>SpatRasterDataset</code></p></a></li>
<li><a href='#sftime_as_spatvector'><p>Convert an <code>sftime</code> to a <code>SpatVector</code></p></a></li>
<li><a href='#spatraster_as_sftime'><p>Convert a <code>SpatRaster</code> to an <code>sftime</code></p></a></li>
<li><a href='#spatrds_as_sftime'><p>Convert a <code>SpatRasterDataset</code> to an <code>sftime</code></p></a></li>
<li><a href='#spatvector_as_sftime'><p>Convert a <code>SpatVector</code> to an <code>sftime</code></p></a></li>
<li><a href='#sum_edc'><p>Calculate isotropic Sum of Exponentially Decaying Contributions (SEDC) covariates</p></a></li>
<li><a href='#test_download_functions'><p>Download unit tests</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Accessing and Analyzing Large-Scale Environmental Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.3</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kyle Messier &lt;kyle.messier@nih.gov&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions are designed to facilitate access to and utility with large scale, publicly available environmental data in R. The package contains functions for downloading raw data files from web URLs (download_data()), processing the raw data files into clean spatial objects (process_covariates()), and extracting values from the spatial data objects at point and polygon locations (calculate_covariates()). These functions call a series of source-specific functions which are tailored to each data sources/datasets particular URL structure, data format, and spatial/temporal resolution. The functions are tested, versioned, and open source and open access. For sum_edc() method details, see Messier, Akita, and Serre (2012) &lt;<a href="https://doi.org/10.1021%2Fes203152a">doi:10.1021/es203152a</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, sf, sftime, stats, terra, methods, data.table, httr,
rvest, exactextractr, utils, stringi, testthat (&ge; 3.0.0),
stars, tidyr, rlang, nhdplusTools, archive, collapse, Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, withr, knitr, rmarkdown, lwgeom, FNN, doRNG, devtools,
stringr, tigris, spelling</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate</td>
</tr>
<tr>
<td>Config/testhat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://niehs.github.io/amadeus/">https://niehs.github.io/amadeus/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/NIEHS/amadeus/issues">https://github.com/NIEHS/amadeus/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-16 18:06:13 UTC; manwareme</td>
</tr>
<tr>
<td>Author:</td>
<td>Mitchell Manware <a href="https://orcid.org/0009-0003-6440-6106"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ctb],
  Insang Song <a href="https://orcid.org/0000-0001-8732-3256"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    ctb],
  Eva Marques <a href="https://orcid.org/0000-0001-9817-6546"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    ctb],
  Mariana Alifa Kassien
    <a href="https://orcid.org/0000-0003-2295-406X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, ctb],
  Elizabeth Scholl <a href="https://orcid.org/0000-0003-2727-1954"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Kyle Messier <a href="https://orcid.org/0000-0001-9508-9623"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Spatiotemporal Exposures and Toxicology Group [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-16 22:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='apply_extent'>Apply extent to the processed data</h2><span id='topic+apply_extent'></span>

<h3>Description</h3>

<p>User-defined extent is used to filter the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_extent(data, extent, geom)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="apply_extent_+3A_data">data</code></td>
<td>
<p>sf/terra object.</p>
</td></tr>
<tr><td><code id="apply_extent_+3A_extent">extent</code></td>
<td>
<p>numeric(4). Extent to filter the data.
Should be ordered as c(xmin, xmax, ymin, ymax).</p>
</td></tr>
<tr><td><code id="apply_extent_+3A_geom">geom</code></td>
<td>
<p>character(1 or 2). Geometry type for if <code>data</code> is <code>data.frame</code>.
One of &quot;geometry&quot; or c(&quot;lon&quot;, &quot;lat&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sf/terra object with the extent applied.
</p>

<hr>
<h2 id='as_mysftime'>Create an <code>sftime</code> object</h2><span id='topic+as_mysftime'></span>

<h3>Description</h3>

<p>Create a <code>sftime</code> object from one of <code>data.frame</code>,
<code>data.table</code>, <code>sf</code>, <code>sftime</code>, <code>SpatRaster</code>,
<code>SpatRasterDataset</code>, <code>SpatVector</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_mysftime(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_mysftime_+3A_x">x</code></td>
<td>
<p>an object of class <code>data.frame</code>, <code>data.table</code>, <code>sf</code>, <code>sftime</code>,
<code>SpatRaster</code>, <code>SpatRasterDataset</code> or <code>SpatVector</code></p>
</td></tr>
<tr><td><code id="as_mysftime_+3A_...">...</code></td>
<td>
<p>if x is a data.frame or data.table: lonname, latname, timename and
crs arguments are required. If x is a sf or sftime, timename argument is
required. If x is a terra::SpatRaster, varname argument is required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>sftime</code> object with constrained time column name
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>


<h3>See Also</h3>

<p><a href="#topic+check_mysftime">check_mysftime</a>, <a href="#topic+sf_as_mysftime">sf_as_mysftime</a>, <a href="base.html#topic+data.frame">data.frame</a>,
<a href="data.table.html#topic+data.table">data.table::data.table</a>, <a href="terra.html#topic+rast">terra::rast</a>, <a href="terra.html#topic+sds">terra::sds</a>, <a href="terra.html#topic+vect">terra::vect</a>
</p>

<hr>
<h2 id='calc_check_time'>Check time values</h2><span id='topic+calc_check_time'></span>

<h3>Description</h3>

<p>Check the time values within calculated covariates <code>data.frame</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_check_time(covar, POSIXt = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_check_time_+3A_covar">covar</code></td>
<td>
<p>data.frame(1). Calculated covariates <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="calc_check_time_+3A_posixt">POSIXt</code></td>
<td>
<p>logical(1). Should the time values in <code>covar</code> be of class
<code>POSIXt</code>? If <code>FALSE</code>, the time values will be checked for integer class
(year and year-month).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; returns a stop error if <code>time</code> is wrong class
</p>

<hr>
<h2 id='calc_message'>Send progress messages</h2><span id='topic+calc_message'></span>

<h3>Description</h3>

<p>Send messages updating covariate extraction progress.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_message(dataset, variable, time, time_type, level)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_message_+3A_dataset">dataset</code></td>
<td>
<p>character(1). Data source.</p>
</td></tr>
<tr><td><code id="calc_message_+3A_variable">variable</code></td>
<td>
<p>placeholder</p>
</td></tr>
<tr><td><code id="calc_message_+3A_time">time</code></td>
<td>
<p>placeholder</p>
</td></tr>
<tr><td><code id="calc_message_+3A_time_type">time_type</code></td>
<td>
<p>placeholder</p>
</td></tr>
<tr><td><code id="calc_message_+3A_level">level</code></td>
<td>
<p>placeholder</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; provides progress messages to R console.
</p>

<hr>
<h2 id='calc_prepare_locs'>Prepare extraction locations</h2><span id='topic+calc_prepare_locs'></span>

<h3>Description</h3>

<p>Prepare the point locations for extracting data by transforming <code>locs</code> to
a <code>SpatVector</code>, projecting to the coordinate reference system of <code>from</code>,
and creating a <code>data.frame</code> containing <code>locs_id</code> for retaining extracted
values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_prepare_locs(from, locs, locs_id, radius, geom = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_prepare_locs_+3A_from">from</code></td>
<td>
<p>SpatRaster(1) or SpatVector(1). Output from
<code>process_\*()</code>. Passed from <code>calc_\*()</code>.</p>
</td></tr>
<tr><td><code id="calc_prepare_locs_+3A_locs">locs</code></td>
<td>
<p>data.frame. character to file path, SpatVector, or sf object.
Passed from <code>calc_\*()</code>.</p>
</td></tr>
<tr><td><code id="calc_prepare_locs_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Column within <code>locations</code> CSV file
containing identifier for each unique coordinate location.
Passed from <code>calc_\*()</code>.</p>
</td></tr>
<tr><td><code id="calc_prepare_locs_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer distance around site locations.
(Default = 0). Passed from <code>calc_\*()</code>.</p>
</td></tr>
<tr><td><code id="calc_prepare_locs_+3A_geom">geom</code></td>
<td>
<p>logical(1). Should the geometry of <code>locs</code> be returned in the
<code>data.frame</code>? Default is <code>FALSE</code>, options &quot;sf&quot; or &quot;terra&quot; will preserve
geometry, but will use <code>terra</code> for extraction.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> containing <code>SpatVector</code> and <code>data.frame</code> objects
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_locs_vector">process_locs_vector()</a></code>, <code><a href="#topic+check_for_null_parameters">check_for_null_parameters()</a></code>
</p>

<hr>
<h2 id='calc_return_locs'>Prepare covariates for return</h2><span id='topic+calc_return_locs'></span>

<h3>Description</h3>

<p>Check the time column for proper class and, if <code>geom = TRUE</code>,
transform <code>data.frame</code> into a <code>SpatVector</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_return_locs(covar, POSIXt = TRUE, geom, crs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_return_locs_+3A_covar">covar</code></td>
<td>
<p>data.frame(1). Calculated covariates <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="calc_return_locs_+3A_posixt">POSIXt</code></td>
<td>
<p>logical(1). Should the time values in <code>covar</code> be of class
<code>POSIXt</code>? If <code>FALSE</code>, the time values will be checked for integer class
(year and year-month).</p>
</td></tr>
<tr><td><code id="calc_return_locs_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;. Should <code>covar</code> be returned as a
<code>data.frame</code>? Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;.</p>
</td></tr>
<tr><td><code id="calc_return_locs_+3A_crs">crs</code></td>
<td>
<p>terra::crs(1). Coordinate reference system (inherited from
<code>from</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object (depending on <code>geom</code> paramter)
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>

<hr>
<h2 id='calc_setcolumns'>Set column names</h2><span id='topic+calc_setcolumns'></span>

<h3>Description</h3>

<p>Apply standard column names to calculated covariates consistent with
the requirements of the <code>beethoven</code> package. Column names follow fixed
format of 3 character data genre, 2 - 15 character variable code, 1 digit
temporal lag, and 5 digit buffer radius (in meters). Variable code character
range is required to retain interpretable column names across datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_setcolumns(from, lag, dataset, locs_id)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_setcolumns_+3A_from">from</code></td>
<td>
<p>data.frame(1) or SpatVector(1). Calculated covariates as
returned from <code>calc_covariates()</code> or a source specific covariate
function.</p>
</td></tr>
<tr><td><code id="calc_setcolumns_+3A_lag">lag</code></td>
<td>
<p>integer(1). Temporal lag.</p>
</td></tr>
<tr><td><code id="calc_setcolumns_+3A_dataset">dataset</code></td>
<td>
<p>character(1). Covariate parent dataset.</p>
</td></tr>
<tr><td><code id="calc_setcolumns_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Column containing identifier for each unique
coordinate location.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object (depending on <code>from</code>)
</p>


<h3>Note</h3>

<p><code>beethoven</code> utilizes point, 1km, and 10km radius buffer distance for
covariate calculation, and therefore the buffer radius column is
padded to 5 digits. If provided a buffer radius greater than 5 digits,
<code>calc_setcolumns()</code> will expand to the number of digits. (ie. buffer
radius of 100km = CCC_CCCCC_I_100000).
</p>

<hr>
<h2 id='calc_time'>Prepare time values</h2><span id='topic+calc_time'></span>

<h3>Description</h3>

<p>Prepare the time values for covariate calculation based on type of time
value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_time(time, format)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_time_+3A_time">time</code></td>
<td>
<p>Time value</p>
</td></tr>
<tr><td><code id="calc_time_+3A_format">format</code></td>
<td>
<p>Type of time to return in the <code style="white-space: pre;">&#8288;$time&#8288;</code> column. Can be
&quot;timeless&quot; (ie. Ecoregions data), &quot;date&quot; (ie. NARR data), &quot;hour&quot;
(ie. GEOS data), &quot;year&quot; (ie. SEDAC population data), or &quot;yearmonth&quot;
(ie. TerraClimate data).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>Date</code>, <code>POSIXt</code>, or <code>integer</code> object based on <code style="white-space: pre;">&#8288;format =&#8288;</code>
</p>

<hr>
<h2 id='calc_worker'>Perform covariate extraction</h2><span id='topic+calc_worker'></span>

<h3>Description</h3>

<p>Extract covariate values from <code>SpatRaster</code> object passed from
<code>process_*()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_worker(
  dataset,
  from,
  locs_vector,
  locs_df,
  fun,
  variable = 1,
  time,
  time_type = c("date", "hour", "year", "yearmonth", "timeless"),
  radius,
  level = NULL,
  max_cells = 1e+08,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_worker_+3A_dataset">dataset</code></td>
<td>
<p>character(1). Dataset name.</p>
</td></tr>
<tr><td><code id="calc_worker_+3A_from">from</code></td>
<td>
<p>SpatRaster(1). Cleaned <code>SpatRaster</code> object.</p>
</td></tr>
<tr><td><code id="calc_worker_+3A_locs_vector">locs_vector</code></td>
<td>
<p>SpatVector(1). Cleaned <code>SpatVector</code> object passed
from <code>calc_prepare_locs()</code>. Contains location point/polygon values.</p>
</td></tr>
<tr><td><code id="calc_worker_+3A_locs_df">locs_df</code></td>
<td>
<p>data.frame(1). Cleaned <code>data.frame</code> object passed from
<code>calc_prepare_locs()</code>. Contains location identifiers.</p>
</td></tr>
<tr><td><code id="calc_worker_+3A_fun">fun</code></td>
<td>
<p>character(1). Summary function. Passed to <code>terra::extract()</code>.</p>
</td></tr>
<tr><td><code id="calc_worker_+3A_variable">variable</code></td>
<td>
<p>integer. Position within the layer name containing the
variable name/code.</p>
</td></tr>
<tr><td><code id="calc_worker_+3A_time">time</code></td>
<td>
<p>integer. Position within the layer name containing the time
value(s).</p>
</td></tr>
<tr><td><code id="calc_worker_+3A_time_type">time_type</code></td>
<td>
<p>character(1). Type of time observation. One of &quot;date&quot;,
&quot;hour&quot;, &quot;year&quot;, &quot;yearmonth&quot;, &quot;timeless&quot;.</p>
</td></tr>
<tr><td><code id="calc_worker_+3A_radius">radius</code></td>
<td>
<p>integer(1). Buffer distance (m). Passed from
<code>calc_prepare_locs()</code>. Used in column naming.</p>
</td></tr>
<tr><td><code id="calc_worker_+3A_level">level</code></td>
<td>
<p>integer. Position within the layer name containing the vertical
pressure level value (if applicable). Default = <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="calc_worker_+3A_max_cells">max_cells</code></td>
<td>
<p>integer(1). Maximum number of cells to be read at once.
Higher values will expedite processing, but will increase memory usage.
Maximum possible value is <code>2^31 - 1</code>.
See <code><a href="exactextractr.html#topic+exact_extract">exactextractr::exact_extract</a></code> for details.</p>
</td></tr>
<tr><td><code id="calc_worker_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> object
</p>

<hr>
<h2 id='calculate_covariates'>Calculate covariates wrapper function</h2><span id='topic+calculate_covariates'></span>

<h3>Description</h3>

<p>The <code>calculate_covariates()</code> function extracts values at point
locations from a SpatRaster or SpatVector object returned from
<code>process_covariates()</code>. <code>calculate_covariates()</code> and the underlying
source-specific covariate functions have been designed to operate on the
processed objects. To avoid errors, <strong>do not edit the processed
SpatRaster or SpatVector objects before passing to
<code>calculate_covariates()</code></strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_covariates(
  covariate = c("modis", "koppen-geiger", "koeppen-geiger", "koppen", "koeppen", "geos",
    "dummies", "gmted", "sedac_groads", "groads", "roads", "ecoregions", "ecoregion",
    "hms", "smoke", "gmted", "narr", "geos", "sedac_population", "population", "nlcd",
    "merra", "merra2", "gridmet", "terraclimate", "tri", "nei"),
  from,
  locs,
  locs_id = "site_id",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_covariates_+3A_covariate">covariate</code></td>
<td>
<p>character(1). Covariate type.</p>
</td></tr>
<tr><td><code id="calculate_covariates_+3A_from">from</code></td>
<td>
<p>character. Single or multiple from strings.</p>
</td></tr>
<tr><td><code id="calculate_covariates_+3A_locs">locs</code></td>
<td>
<p>sf/SpatVector. Unique locations. Should include
a unique identifier field named <code>locs_id</code></p>
</td></tr>
<tr><td><code id="calculate_covariates_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Name of unique identifier.
Default is <code>"site_id"</code>.</p>
</td></tr>
<tr><td><code id="calculate_covariates_+3A_...">...</code></td>
<td>
<p>Arguments passed to each covariate calculation
function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Calculated covariates as a data.frame or SpatVector object
</p>


<h3>Note</h3>

<p><code>covariate</code> argument value is converted to lowercase.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+calculate_modis">calculate_modis</a></code>: &quot;modis&quot;, &quot;MODIS&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_koppen_geiger">calculate_koppen_geiger</a></code>: &quot;koppen-geiger&quot;, &quot;koeppen-geiger&quot;, &quot;koppen&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_ecoregion">calculate_ecoregion</a></code>: &quot;ecoregion&quot;, &quot;ecoregions&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_temporal_dummies">calculate_temporal_dummies</a></code>: &quot;dummies&quot;, &quot;Dummies&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_hms">calculate_hms</a></code>: &quot;hms&quot;, &quot;smoke&quot;, &quot;HMS&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_gmted">calculate_gmted</a></code>: &quot;gmted&quot;, &quot;GMTED&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_narr">calculate_narr</a></code>: &quot;narr&quot;, &quot;NARR&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_geos">calculate_geos</a></code>: &quot;geos&quot;, &quot;geos_cf&quot;, &quot;GEOS&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_population">calculate_population</a></code>: &quot;population&quot;, &quot;sedac_population&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_groads">calculate_groads</a></code>: &quot;roads&quot;, &quot;groads&quot;, &quot;sedac_groads&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_nlcd">calculate_nlcd</a></code>: &quot;nlcd&quot;, &quot;NLCD&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_tri">calculate_tri</a></code>: &quot;tri&quot;, &quot;TRI&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_nei">calculate_nei</a></code>: &quot;nei&quot;, &quot;NEI&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_merra2">calculate_merra2</a></code>: &quot;merra&quot;, &quot;MERRA&quot;, &quot;merra2&quot;, &quot;MERRA2&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_gridmet">calculate_gridmet</a></code>: &quot;gridMET&quot;, &quot;gridmet&quot;
</p>
</li>
<li> <p><code><a href="#topic+calculate_terraclimate">calculate_terraclimate</a></code>: &quot;terraclimate&quot;, &quot;TerraClimate&quot;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_covariates(
  covariate = "narr",
  from = narr, # derived from process_covariates() example
  locs = loc,
  locs_id = "id",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_ecoregion'>Calculate ecoregions covariates</h2><span id='topic+calculate_ecoregion'></span>

<h3>Description</h3>

<p>Extract ecoregions covariates (U.S. EPA Ecoregions Level 2/3) at point
locations. Returns a <code>data.frame</code> object containing <code>locs_id</code> and
binary (0 = point not in ecoregion; 1 = point in ecoregion) variables for
each ecoregion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_ecoregion(from = NULL, locs, locs_id = "site_id", geom = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_ecoregion_+3A_from">from</code></td>
<td>
<p>SpatVector(1). Output of <code><a href="#topic+process_ecoregion">process_ecoregion</a></code>.</p>
</td></tr>
<tr><td><code id="calculate_ecoregion_+3A_locs">locs</code></td>
<td>
<p>sf/SpatVector. Unique locs. Should include
a unique identifier field named <code>locs_id</code></p>
</td></tr>
<tr><td><code id="calculate_ecoregion_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Name of unique identifier.</p>
</td></tr>
<tr><td><code id="calculate_ecoregion_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_ecoregion_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object object with dummy variables and
attributes of:
</p>

<ul>
<li> <p><code>attr(., "ecoregion2_code")</code>: Ecoregion lv.2 code and key
</p>
</li>
<li> <p><code>attr(., "ecoregion3_code")</code>: Ecoregion lv.3 code and key
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_ecoregion">process_ecoregion</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_ecoregion(
  from = ecoregion, # derived from process_ecoregion() example
  locs = loc,
  locs_id = "id",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_geos'>Calculate atmospheric composition covariates</h2><span id='topic+calculate_geos'></span>

<h3>Description</h3>

<p>Extract atmospheric composition values at point locations. Returns a
<code>data.frame</code> object containing <code>locs_id</code>, date and hour, vertical
pressure level, and atmospheric composition variable. Atmospheric
composition variable column name reflects variable and circular buffer
radius.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_geos(
  from,
  locs,
  locs_id = NULL,
  radius = 0,
  fun = "mean",
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_geos_+3A_from">from</code></td>
<td>
<p>SpatRaster(1). Output of <code>process_geos()</code>.</p>
</td></tr>
<tr><td><code id="calculate_geos_+3A_locs">locs</code></td>
<td>
<p>data.frame, characater to file path, SpatVector, or sf object.</p>
</td></tr>
<tr><td><code id="calculate_geos_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Column within <code>locations</code> CSV file
containing identifier for each unique coordinate location.</p>
</td></tr>
<tr><td><code id="calculate_geos_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer distance around site locations.
(Default = 0).</p>
</td></tr>
<tr><td><code id="calculate_geos_+3A_fun">fun</code></td>
<td>
<p>character(1). Function used to summarize multiple raster cells
within sites location buffer (Default = <code>mean</code>).</p>
</td></tr>
<tr><td><code id="calculate_geos_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_geos_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_geos">process_geos()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_geos(
  from = geos, # derived from process_geos() example
  locs = loc,
  locs_id = "id",
  radius = 0,
  fun = "mean",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_gmted'>Calculate elevation covariates</h2><span id='topic+calculate_gmted'></span>

<h3>Description</h3>

<p>Extract elevation values at point locations. Returns a <code>data.frame</code>
object containing <code>locs_id</code>, year of release, and elevation variable.
Elevation variable column name reflects the elevation statistic, spatial
resolution of <code>from</code>, and circular buffer radius (ie. Breakline Emphasis
at 7.5 arc-second resolution with 0 meter buffer: breakline_emphasis_r75_0).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_gmted(
  from,
  locs,
  locs_id = NULL,
  radius = 0,
  fun = "mean",
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_gmted_+3A_from">from</code></td>
<td>
<p>SpatRaster(1). Output from <code>process_gmted()</code>.</p>
</td></tr>
<tr><td><code id="calculate_gmted_+3A_locs">locs</code></td>
<td>
<p>data.frame. character to file path, SpatVector, or sf object.</p>
</td></tr>
<tr><td><code id="calculate_gmted_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Column within <code>locations</code> CSV file
containing identifier for each unique coordinate location.</p>
</td></tr>
<tr><td><code id="calculate_gmted_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer distance around site locations.
(Default = 0).</p>
</td></tr>
<tr><td><code id="calculate_gmted_+3A_fun">fun</code></td>
<td>
<p>character(1). Function used to summarize multiple raster cells
within sites location buffer (Default = <code>mean</code>).</p>
</td></tr>
<tr><td><code id="calculate_gmted_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_gmted_+3A_...">...</code></td>
<td>
<p>Placeholders</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_gmted">process_gmted()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_gmted(
  from = gmted, # derived from process_gmted() example
  locs = loc,
  locs_id = "id",
  radius = 0,
  fun = "mean",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_gridmet'>Calculate gridMET covariates</h2><span id='topic+calculate_gridmet'></span>

<h3>Description</h3>

<p>Extract gridMET values at point locations. Returns a <code>data.frame</code>
object containing <code>locs_id</code> and gridMET variable. gridMET variable
column name reflects the gridMET variable and circular buffer radius.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_gridmet(
  from,
  locs,
  locs_id = NULL,
  radius = 0,
  fun = "mean",
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_gridmet_+3A_from">from</code></td>
<td>
<p>SpatRaster(1). Output from <code>process_gridmet()</code>.</p>
</td></tr>
<tr><td><code id="calculate_gridmet_+3A_locs">locs</code></td>
<td>
<p>data.frame. character to file path, SpatVector, or sf object.</p>
</td></tr>
<tr><td><code id="calculate_gridmet_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Column within <code>locations</code> CSV file
containing identifier for each unique coordinate location.</p>
</td></tr>
<tr><td><code id="calculate_gridmet_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer distance around site locations.
(Default = 0).</p>
</td></tr>
<tr><td><code id="calculate_gridmet_+3A_fun">fun</code></td>
<td>
<p>character(1). Function used to summarize multiple raster cells
within sites location buffer (Default = <code>mean</code>).</p>
</td></tr>
<tr><td><code id="calculate_gridmet_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_gridmet_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_gridmet">process_gridmet()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_gridmet(
  from = gridmet, # derived from process_gridmet() example
  locs = loc,
  locs_id = "id",
  radius = 0,
  fun = "mean",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_groads'>Calculate roads covariates</h2><span id='topic+calculate_groads'></span>

<h3>Description</h3>

<p>Prepared groads data is clipped with the buffer polygons
of <code>radius</code>. The total length of the roads are calculated.
Then the density of the roads is calculated by dividing
the total length from the area of the buffer. <code>terra::linearUnits()</code>
is used to convert the unit of length to meters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_groads(
  from = NULL,
  locs = NULL,
  locs_id = NULL,
  radius = 1000,
  fun = "sum",
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_groads_+3A_from">from</code></td>
<td>
<p>SpatVector(1). Output of <code>process_groads</code>.</p>
</td></tr>
<tr><td><code id="calculate_groads_+3A_locs">locs</code></td>
<td>
<p>data.frame, characater to file path, SpatVector, or sf object.</p>
</td></tr>
<tr><td><code id="calculate_groads_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Column within <code>locations</code> CSV file
containing identifier for each unique coordinate location.</p>
</td></tr>
<tr><td><code id="calculate_groads_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer distance around site locations.
(Default = 1000).</p>
</td></tr>
<tr><td><code id="calculate_groads_+3A_fun">fun</code></td>
<td>
<p>function(1). Function used to summarize the length of roads
within sites location buffer (Default is <code>sum</code>).</p>
</td></tr>
<tr><td><code id="calculate_groads_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_groads_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Note</h3>

<p>Unit is km / sq km. The returned <code>data.frame</code> object contains a
<code style="white-space: pre;">&#8288;$time&#8288;</code> column to represent the temporal range covered by the
dataset. For more information, see <a href="https://earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-groads-v1-1.00">https://earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-groads-v1-1.00</a>.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_groads">process_groads</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_groads(
  from = groads, # derived from process_groads() example
  locs = loc,
  locs_id = "id",
  radius = 1000,
  fun = "sum",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_hms'>Calculate wildfire smoke covariates</h2><span id='topic+calculate_hms'></span>

<h3>Description</h3>

<p>Extract wildfire smoke plume values at point locations. Returns a
<code>data.frame</code> object containing <code>locs_id</code>, date, and binary variable
for wildfire smoke plume density inherited from <code>from</code> (0 = point not
covered by wildfire smoke plume; 1 = point covered by wildfire smoke plume).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_hms(from, locs, locs_id = NULL, radius = 0, geom = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_hms_+3A_from">from</code></td>
<td>
<p>SpatVector(1). Output of <code>process_hms()</code>.</p>
</td></tr>
<tr><td><code id="calculate_hms_+3A_locs">locs</code></td>
<td>
<p>data.frame, characater to file path, SpatVector, or sf object.</p>
</td></tr>
<tr><td><code id="calculate_hms_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Column within <code>locations</code> CSV file
containing identifier for each unique coordinate location.</p>
</td></tr>
<tr><td><code id="calculate_hms_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer distance around site locations.
(Default = 0).</p>
</td></tr>
<tr><td><code id="calculate_hms_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_hms_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_hms">process_hms()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_hms(
  from = hms, # derived from process_hms() example
  locs = loc,
  locs_id = "id",
  radius = 0,
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_koppen_geiger'>Calculate climate classification covariates</h2><span id='topic+calculate_koppen_geiger'></span>

<h3>Description</h3>

<p>Extract climate classification values at point locations. Returns a
<code>data.frame</code> object containing <code>locs_id</code> and
binary (0 = point not in climate region; 1 = point in climate region)
variables for each climate classification region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_koppen_geiger(
  from = NULL,
  locs = NULL,
  locs_id = "site_id",
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_koppen_geiger_+3A_from">from</code></td>
<td>
<p>SpatVector(1). Output of <code>process_koppen_geiger()</code>.</p>
</td></tr>
<tr><td><code id="calculate_koppen_geiger_+3A_locs">locs</code></td>
<td>
<p>sf/SpatVector. Unique locs. Should include
a unique identifier field named <code>locs_id</code></p>
</td></tr>
<tr><td><code id="calculate_koppen_geiger_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Name of unique identifier.</p>
</td></tr>
<tr><td><code id="calculate_koppen_geiger_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_koppen_geiger_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Note</h3>

<p>The returned object contains a
<code style="white-space: pre;">&#8288;$description&#8288;</code> column to represent the temporal range covered by the
dataset. For more information, see
<a href="https://www.nature.com/articles/sdata2018214">https://www.nature.com/articles/sdata2018214</a>.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_koppen_geiger">process_koppen_geiger</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_koppen_geiger(
  from = kg, # derived from process_koppen_geiger() example
  locs = loc,
  locs_id = "id",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_lagged'>Calculate temporally lagged covariates</h2><span id='topic+calculate_lagged'></span>

<h3>Description</h3>

<p>The <code>calculate_lagged()</code> function calculates daily temporal lagged covariates
from the output of <code>calculate_covariates()</code> or <code>calc_*()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_lagged(from, date, lag, locs_id, time_id = "time", geom = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_lagged_+3A_from">from</code></td>
<td>
<p>data.frame(1). A <code>data.frame</code> containing calculated covariates
returned from <code>calculate_covariates()</code> or <code>calc_*()</code>.</p>
</td></tr>
<tr><td><code id="calculate_lagged_+3A_date">date</code></td>
<td>
<p>character(2). Start and end dates of desired lagged covariates.
Length of 10 each, format YYYY-MM-DD (ex. September 1, 2023 = &quot;2023-09-01&quot;).</p>
</td></tr>
<tr><td><code id="calculate_lagged_+3A_lag">lag</code></td>
<td>
<p>integer(1). Number of lag days.</p>
</td></tr>
<tr><td><code id="calculate_lagged_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Name of unique identifier.</p>
</td></tr>
<tr><td><code id="calculate_lagged_+3A_time_id">time_id</code></td>
<td>
<p>character(1). Column containing time values.</p>
</td></tr>
<tr><td><code id="calculate_lagged_+3A_geom">geom</code></td>
<td>
<p>logical(1). Should the function return a <code>SpatVector</code>?
Default is <code>FALSE</code>. The coordinate reference system of the <code>SpatVector</code> is
that of <code>from.</code> To return as a <code>SpatVector</code>, <code>from</code> must also be a <code>SpatVector</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> object
</p>


<h3>Note</h3>

<p>In order to calculate temporally lagged covariates, <code>from</code> must contain at
least the number of lag days before the desired start date. For example, if
<code style="white-space: pre;">&#8288;date = c("2024-01-01", "2024-01-31)&#8288;</code> and <code>lag = 1</code>, <code>from</code> must contain data
starting at 2023-12-31.
If <code>from</code> contains geometry features, <code>calculate_lagged</code> will return a column
with geometry features of the same name.
<code>calculate_lagged()</code> assumes that all columns other than <code>time_id</code>,
<code>locs_id</code>, and fixed columns of &quot;lat&quot; and &quot;lon&quot;, follow the genre, variable,
lag, buffer radius format adopted in <code>calc_setcolumns()</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculate_covariates">calculate_covariates()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
terracliamte_covar &lt;- calculate_terraclimate(
  from = terraclimate, # derived from process_terraclimate() example
  locs = loc,
  locs_id = "id",
  radius = 0,
  fun = "mean",
  geom = FALSE
)
calculate_lagged(
  from = terracliamte_covar,
  locs_id = "id",
  date = c("2023-01-02", "2023-01-10"),
  lag = 1,
  time_id = "time"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_merra2'>Calculate meteorological and atmospheric covariates</h2><span id='topic+calculate_merra2'></span>

<h3>Description</h3>

<p>Extract meteorological and atmospheric values at point locations. Returns a
<code>data.frame</code> object containing <code>locs_id</code>, date and hour, vertical
pressure level, and meteorological or atmospheric variable. Variable column
name reflects variable and circular buffer radius.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_merra2(
  from,
  locs,
  locs_id = NULL,
  radius = 0,
  fun = "mean",
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_merra2_+3A_from">from</code></td>
<td>
<p>SpatRaster(1). Output of <code>process_merra2()</code>.</p>
</td></tr>
<tr><td><code id="calculate_merra2_+3A_locs">locs</code></td>
<td>
<p>data.frame, characater to file path, SpatVector, or sf object.</p>
</td></tr>
<tr><td><code id="calculate_merra2_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Column within <code>locations</code> CSV file
containing identifier for each unique coordinate location.</p>
</td></tr>
<tr><td><code id="calculate_merra2_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer distance around site locations.
(Default = 0).</p>
</td></tr>
<tr><td><code id="calculate_merra2_+3A_fun">fun</code></td>
<td>
<p>character(1). Function used to summarize multiple raster cells
within sites location buffer (Default = <code>mean</code>).</p>
</td></tr>
<tr><td><code id="calculate_merra2_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_merra2_+3A_...">...</code></td>
<td>
<p>Placeholders</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calculate_geos">calculate_geos()</a></code>, <code><a href="#topic+process_merra2">process_merra2()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_merra2(
  from = merra2, # derived from process_merra2() example
  locs = loc,
  locs_id = "id",
  radius = 0,
  fun = "mean",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_modis'>Calculate MODIS product covariates in multiple CPU threads</h2><span id='topic+calculate_modis'></span>

<h3>Description</h3>

<p><code>calculate_modis</code> essentially runs <code><a href="#topic+calculate_modis_daily">calculate_modis_daily</a></code> function
in each thread (subprocess). Based on daily resolution, each day's workload
will be distributed to each thread. With <code>product</code> argument,
the files are processed by a customized function where the unique structure
and/or characteristics of the products are considered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_modis(
  from = NULL,
  locs = NULL,
  locs_id = "site_id",
  radius = c(0L, 1000L, 10000L, 50000L),
  preprocess = process_modis_merge,
  name_covariates = NULL,
  subdataset = NULL,
  fun_summary = "mean",
  package_list_add = NULL,
  export_list_add = NULL,
  max_cells = 3e+07,
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_modis_+3A_from">from</code></td>
<td>
<p>character. List of paths to MODIS/VIIRS files.</p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_locs">locs</code></td>
<td>
<p>sf/SpatVector object. Unique locs where covariates
will be calculated.</p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Site identifier. Default is <code>"site_id"</code></p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_radius">radius</code></td>
<td>
<p>numeric. Radii to calculate covariates.
Default is <code>c(0, 1000, 10000, 50000)</code>.</p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_preprocess">preprocess</code></td>
<td>
<p>function. Function to handle HDF files.</p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_name_covariates">name_covariates</code></td>
<td>
<p>character. Name header of covariates.
e.g., <code>"MOD_NDVIF_0_"</code>.
The calculated covariate names will have a form of
&quot;<code>{name_covariates}{zero-padded buffer radius in meters}</code>&quot;,
e.g., 'MOD_NDVIF_0_50000' where 50 km radius circular buffer
was used to calculate mean NDVI value.</p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_subdataset">subdataset</code></td>
<td>
<p>Indices, names, or search patterns for subdatasets.
Find detail usage of the argument in notes.</p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_fun_summary">fun_summary</code></td>
<td>
<p>character or function. Function to summarize
extracted raster values.</p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_package_list_add">package_list_add</code></td>
<td>
<p>character. A vector with package names to load
these in each thread. Note that <code>sf</code>, <code>terra</code>, <code>exactextractr</code>,
<code>doParallel</code>, <code>parallelly</code> and <code>dplyr</code> are the default packages to be
loaded.</p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_export_list_add">export_list_add</code></td>
<td>
<p>character. A vector with object names to export
to each thread. It should be minimized to spare memory.</p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_max_cells">max_cells</code></td>
<td>
<p>integer(1). Maximum number of cells to be read at once.
Higher values will expedite processing, but will increase memory usage.
Maximum possible value is <code>2^31 - 1</code>.
See <code><a href="exactextractr.html#topic+exact_extract">exactextractr::exact_extract</a></code> for details.</p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_modis_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>preprocess</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame or SpatVector with an attribute:
</p>

<ul>
<li> <p><code>attr(., "dates_dropped")</code>: Dates with insufficient tiles.
Note that the dates mean the dates with insufficient tiles,
not the dates without available tiles.
</p>
</li></ul>



<h3>Note</h3>

<p>Overall, this function and dependent routines assume that the file
system can handle concurrent access to the (network) disk by multiple
processes. File system characteristics, package versions, and hardware
settings and specification can affect the processing efficiency.
<code>locs</code> is expected to be convertible to <code>sf</code> object. <code>sf</code>, <code>SpatVector</code>, and
other class objects that could be converted to <code>sf</code> can be used.
Common arguments in <code>preprocess</code> functions such as <code>date</code> and <code>path</code> are
automatically detected and passed to the function. Please note that
<code>locs</code> here and <code>path</code> in <code>preprocess</code> functions are assumed to have a
standard naming convention of raw files from NASA.
The argument <code>subdataset</code> should be in a proper format
depending on <code>preprocess</code> function:
</p>

<ul>
<li> <p><code>process_modis_merge()</code>: Regular expression pattern.
e.g., <code>"^LST_"</code>
</p>
</li>
<li> <p><code>process_modis_swath()</code>: Subdataset names.
e.g., <code>c("Cloud_Fraction_Day", "Cloud_Fraction_Night")</code>
</p>
</li>
<li> <p><code>process_blackmarble()</code>: Subdataset number.
e.g., for VNP46A2 product, 3L.
Dates with less than 80 percent of the expected number of tiles,
which are determined by the mode of the number of tiles, are removed.
Users will be informed of the dates with insufficient tiles.
The result data.frame will have an attribute with the dates with
insufficient tiles.
</p>
</li></ul>



<h3>See Also</h3>

<p>This function leverages the calculation of single-day MODIS
covariates:
</p>

<ul>
<li> <p><code><a href="#topic+calculate_modis_daily">calculate_modis_daily()</a></code>
</p>
</li></ul>

<p>Also, for preprocessing, please refer to:
</p>

<ul>
<li> <p><code><a href="#topic+process_modis_merge">process_modis_merge()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+process_modis_swath">process_modis_swath()</a></code>
</p>
</li>
<li> <p><code><a href="#topic+process_blackmarble">process_blackmarble()</a></code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
locs &lt;- data.frame(lon = -78.8277, lat = 35.95013, id = "001")
locs &lt;- terra::vect(locs, geom = c("lon", "lat"), crs = "EPSG:4326")
calculate_modis(
  from =
    list.files("./data", pattern = "VNP46A2.", full.names = TRUE),
  locs = locs,
  locs_id = "site_id",
  radius = c(0L, 1000L),
  preprocess = process_modis_merge,
  name_covariates = "cloud_fraction_0",
  subdataset = "Cloud_Fraction",
  fun_summary = "mean"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_modis_daily'>A single-date MODIS worker</h2><span id='topic+calculate_modis_daily'></span>

<h3>Description</h3>

<p>The function operates at MODIS/VIIRS products
on a daily basis. Given that the raw hdf files are downloaded from
NASA, standard file names include a data retrieval date flag starting
with letter &quot;A&quot;. Leveraging that piece of information, the function will
select files of scope on the date of interest.
Please note that this function does not provide a function to filter
swaths or tiles, so it is strongly recommended to check and pre-filter
the file names at users' discretion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_modis_daily(
  from = NULL,
  locs = NULL,
  locs_id = "site_id",
  radius = 0L,
  date = NULL,
  name_extracted = NULL,
  fun_summary = "mean",
  max_cells = 3e+07,
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_modis_daily_+3A_from">from</code></td>
<td>
<p>SpatRaster. Preprocessed objects.</p>
</td></tr>
<tr><td><code id="calculate_modis_daily_+3A_locs">locs</code></td>
<td>
<p>SpatVector/sf/sftime object. Locations where MODIS values
are summarized.</p>
</td></tr>
<tr><td><code id="calculate_modis_daily_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Field name where unique site identifiers
are stored. Default is <code>"site_id"</code></p>
</td></tr>
<tr><td><code id="calculate_modis_daily_+3A_radius">radius</code></td>
<td>
<p>numeric. Radius to generate circular buffers.</p>
</td></tr>
<tr><td><code id="calculate_modis_daily_+3A_date">date</code></td>
<td>
<p>Date(1). date to query.</p>
</td></tr>
<tr><td><code id="calculate_modis_daily_+3A_name_extracted">name_extracted</code></td>
<td>
<p>character. Names of calculated covariates.</p>
</td></tr>
<tr><td><code id="calculate_modis_daily_+3A_fun_summary">fun_summary</code></td>
<td>
<p>function. Summary function for
multilayer rasters. Passed to <code>foo</code>. See <code><a href="exactextractr.html#topic+exact_extract">exactextractr::exact_extract</a></code>
for details.</p>
</td></tr>
<tr><td><code id="calculate_modis_daily_+3A_max_cells">max_cells</code></td>
<td>
<p>integer(1). Maximum number of cells to be read at once.
Higher values will expedite processing, but will increase memory usage.
Maximum possible value is <code>2^31 - 1</code>.</p>
</td></tr>
<tr><td><code id="calculate_modis_daily_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code>
See <code><a href="exactextractr.html#topic+exact_extract">exactextractr::exact_extract</a></code> for details.</p>
</td></tr>
<tr><td><code id="calculate_modis_daily_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>


<ul>
<li><p> Preprocessing: <code><a href="#topic+process_modis_merge">process_modis_merge()</a></code>, <code><a href="#topic+process_modis_swath">process_modis_swath()</a></code>,
<code><a href="#topic+process_blackmarble">process_blackmarble()</a></code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
locs &lt;- data.frame(lon = -78.8277, lat = 35.95013, id = "001")
calculate_modis_daily(
  from = mod06l2_warp, # dervied from process_modis() example
  locs = locs,
  locs_id = "id",
  radius = 0,
  date = "2024-01-01",
  name_extracted = "cloud_fraction_0",
  fun_summary = "mean",
  max_cells = 3e7
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_narr'>Calculate meteorological covariates</h2><span id='topic+calculate_narr'></span>

<h3>Description</h3>

<p>Extract meteorological values at point locations. Returns a <code>data.frame</code>
object containing <code>locs_id</code>, date, vertical pressure level, and
meteorological variable. Meteorological variable column name reflects
variable and circular buffer radius.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_narr(
  from,
  locs,
  locs_id = NULL,
  radius = 0,
  fun = "mean",
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_narr_+3A_from">from</code></td>
<td>
<p>SpatRaster(1). Output of <code>process_narr()</code>.</p>
</td></tr>
<tr><td><code id="calculate_narr_+3A_locs">locs</code></td>
<td>
<p>data.frame, characater to file path, SpatVector, or sf object.</p>
</td></tr>
<tr><td><code id="calculate_narr_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Column within <code>locations</code> CSV file
containing identifier for each unique coordinate location.</p>
</td></tr>
<tr><td><code id="calculate_narr_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer distance around site locations.
(Default = 0).</p>
</td></tr>
<tr><td><code id="calculate_narr_+3A_fun">fun</code></td>
<td>
<p>character(1). Function used to summarize multiple raster cells
within sites location buffer (Default = <code>mean</code>).</p>
</td></tr>
<tr><td><code id="calculate_narr_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_narr_+3A_...">...</code></td>
<td>
<p>Placeholders</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_narr">process_narr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_narr(
  from = narr, # derived from process_narr() example
  locs = loc,
  locs_id = "id",
  radius = 0,
  fun = "mean",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_nei'>Calculate road emissions covariates</h2><span id='topic+calculate_nei'></span>

<h3>Description</h3>

<p>Calculate road emissions covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_nei(from = NULL, locs = NULL, locs_id = "site_id", geom = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_nei_+3A_from">from</code></td>
<td>
<p>SpatVector(1). Output of <code>process_nei()</code>.</p>
</td></tr>
<tr><td><code id="calculate_nei_+3A_locs">locs</code></td>
<td>
<p>sf/SpatVector. Locations at NEI values are joined.</p>
</td></tr>
<tr><td><code id="calculate_nei_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Unique site identifier column name.
Unused but kept for compatibility.</p>
</td></tr>
<tr><td><code id="calculate_nei_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_nei_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Author(s)</h3>

<p>Insang Song, Ranadeep Daw
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_nei">process_nei</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_nei(
  from = nei, # derived from process_nei example
  locs = loc,
  locs_id = "id"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_nlcd'>Calculate land cover covariates</h2><span id='topic+calculate_nlcd'></span>

<h3>Description</h3>

<p>Compute ratio of land cover class in circle buffers around points. Returns
a <code>data.frame</code> object containing <code>locs_id</code>, longitude, latitude,
time (year), and computed ratio for each land cover class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_nlcd(
  from,
  locs,
  locs_id = "site_id",
  mode = c("exact", "terra"),
  radius = 1000,
  max_cells = 5e+07,
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_nlcd_+3A_from">from</code></td>
<td>
<p>SpatRaster(1). Output of <code>process_nlcd()</code>.</p>
</td></tr>
<tr><td><code id="calculate_nlcd_+3A_locs">locs</code></td>
<td>
<p>terra::SpatVector of points geometry</p>
</td></tr>
<tr><td><code id="calculate_nlcd_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Unique identifier of locations</p>
</td></tr>
<tr><td><code id="calculate_nlcd_+3A_mode">mode</code></td>
<td>
<p>character(1). One of <code>"exact"</code>
(using <code><a href="exactextractr.html#topic+exact_extract">exactextractr::exact_extract()</a></code>)
or <code>"terra"</code> (using <code><a href="terra.html#topic+freq">terra::freq()</a></code>). Ignored if <code>locs</code> are points.</p>
</td></tr>
<tr><td><code id="calculate_nlcd_+3A_radius">radius</code></td>
<td>
<p>numeric (non-negative) giving the
radius of buffer around points.</p>
</td></tr>
<tr><td><code id="calculate_nlcd_+3A_max_cells">max_cells</code></td>
<td>
<p>integer(1). Maximum number of cells to be read at once.
Higher values may expedite processing, but will increase memory usage.
Maximum possible value is <code>2^31 - 1</code>. Only valid when
<code>mode = "exact"</code>.
See <code><a href="exactextractr.html#topic+exact_extract">exactextractr::exact_extract</a></code> for details.</p>
</td></tr>
<tr><td><code id="calculate_nlcd_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_nlcd_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Note</h3>

<p>NLCD is available in U.S. only. Users should be aware of
the spatial extent of the data. The results are different depending
on <code>mode</code> argument. The <code>"terra"</code> mode is less memory intensive
but less accurate because it counts the number of cells
intersecting with the buffer. The <code>"exact"</code> may be more accurate
but uses more memory as it will account for the partial overlap
with the buffer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_nlcd">process_nlcd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_nlcd(
  from = nlcd, # derived from process_nlcd() example
  locs = loc,
  locs_id = "id",
  mode = "exact",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_population'>Calculate population density covariates</h2><span id='topic+calculate_population'></span>

<h3>Description</h3>

<p>Extract population density values at point locations. Returns a
<code>data.frame</code> object containing <code>locs_id</code>, year, and population
density variable. Population density variable column name reflects
spatial resolution of <code>from</code> and circular buffer radius.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_population(
  from,
  locs,
  locs_id = NULL,
  radius = 0,
  fun = "mean",
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_population_+3A_from">from</code></td>
<td>
<p>SpatRaster(1). Output of <code>process_population()</code>.</p>
</td></tr>
<tr><td><code id="calculate_population_+3A_locs">locs</code></td>
<td>
<p>data.frame, characater to file path, SpatVector, or sf object.</p>
</td></tr>
<tr><td><code id="calculate_population_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Column within <code>locations</code> CSV file
containing identifier for each unique coordinate location.</p>
</td></tr>
<tr><td><code id="calculate_population_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer distance around site locations.
(Default = 0).</p>
</td></tr>
<tr><td><code id="calculate_population_+3A_fun">fun</code></td>
<td>
<p>character(1). Function used to summarize multiple raster cells
within sites location buffer (Default = <code>mean</code>).</p>
</td></tr>
<tr><td><code id="calculate_population_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_population_+3A_...">...</code></td>
<td>
<p>Placeholders</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_population">process_population()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_population(
  from = pop, # derived from process_population() example
  locs = loc,
  locs_id = "id",
  radius = 0,
  fun = "mean",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_temporal_dummies'>Calculate temporal dummy covariates</h2><span id='topic+calculate_temporal_dummies'></span>

<h3>Description</h3>

<p>Calculate temporal dummy covariates at point locations. Returns a
<code>data.frame</code> object with <code>locs_id</code>, year binary variable for each
value in <code>year</code>, and month and day of week binary variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_temporal_dummies(
  locs,
  locs_id = "site_id",
  year = seq(2018L, 2022L),
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_temporal_dummies_+3A_locs">locs</code></td>
<td>
<p>data.frame with a temporal field named <code>"time"</code></p>
</td></tr>
<tr><td><code id="calculate_temporal_dummies_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Unique site identifier column name.
Default is <code>"site_id"</code>.</p>
</td></tr>
<tr><td><code id="calculate_temporal_dummies_+3A_year">year</code></td>
<td>
<p>integer. Year domain to dummify.
Default is <code>seq(2018L, 2022L)</code>.</p>
</td></tr>
<tr><td><code id="calculate_temporal_dummies_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_temporal_dummies_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_temporal_dummies(
  locs = loc,
  locs_id = "id",
  year = seq(2018L, 2022L)
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_terraclimate'>Calculate TerraClimate covariates</h2><span id='topic+calculate_terraclimate'></span>

<h3>Description</h3>

<p>Extract TerraClimate values at point locations. Returns a <code>data.frame</code>
object containing <code>locs_id</code> and TerraClimate variable. TerraClimate
variable column name reflects the TerraClimate variable and
circular buffer radius. The <code style="white-space: pre;">&#8288;$time&#8288;</code> column will contain the year and month
(&quot;YYYYMM&quot;) as TerraClimate products have monthly temporal resolution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_terraclimate(
  from = NULL,
  locs = NULL,
  locs_id = NULL,
  radius = 0,
  fun = "mean",
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_terraclimate_+3A_from">from</code></td>
<td>
<p>SpatRaster(1). Output from <code>process_terraclimate()</code>.</p>
</td></tr>
<tr><td><code id="calculate_terraclimate_+3A_locs">locs</code></td>
<td>
<p>data.frame. character to file path, SpatVector, or sf object.</p>
</td></tr>
<tr><td><code id="calculate_terraclimate_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Column within <code>locations</code> CSV file
containing identifier for each unique coordinate location.</p>
</td></tr>
<tr><td><code id="calculate_terraclimate_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer distance around site locations.
(Default = 0).</p>
</td></tr>
<tr><td><code id="calculate_terraclimate_+3A_fun">fun</code></td>
<td>
<p>character(1). Function used to summarize multiple raster cells
within sites location buffer (Default = <code>mean</code>).</p>
</td></tr>
<tr><td><code id="calculate_terraclimate_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_terraclimate_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Note</h3>

<p>TerraClimate data has monthly temporal resolution, so the <code style="white-space: pre;">&#8288;$time&#8288;</code> column
will contain the year and month in YYYYMM format (ie. January, 2018 =
201801).
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>See Also</h3>

<p><code><a href="#topic+process_terraclimate">process_terraclimate()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_terraclimate(
  from = terraclimate, # derived from process_terraclimate() example
  locs = loc,
  locs_id = "id",
  radius = 0,
  fun = "mean",
  geom = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='calculate_tri'>Calculate toxic release covariates</h2><span id='topic+calculate_tri'></span>

<h3>Description</h3>

<p>Calculate toxic release values for polygons or isotropic buffer point
locations. Returns a <code>data.frame</code> object containing <code>locs_id</code>
and variables for each chemical in <code>from</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_tri(
  from = NULL,
  locs,
  locs_id = "site_id",
  radius = c(1000L, 10000L, 50000L),
  geom = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_tri_+3A_from">from</code></td>
<td>
<p>SpatVector(1). Output of <code>process_tri()</code>.</p>
</td></tr>
<tr><td><code id="calculate_tri_+3A_locs">locs</code></td>
<td>
<p>sf/SpatVector. Locations where TRI variables are calculated.</p>
</td></tr>
<tr><td><code id="calculate_tri_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Unique site identifier column name.
Default is <code>"site_id"</code>.</p>
</td></tr>
<tr><td><code id="calculate_tri_+3A_radius">radius</code></td>
<td>
<p>Circular buffer radius.
Default is <code>c(1000, 10000, 50000)</code> (meters)</p>
</td></tr>
<tr><td><code id="calculate_tri_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
<tr><td><code id="calculate_tri_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame or SpatVector object
</p>


<h3>Note</h3>

<p>U.S. context.
</p>


<h3>Author(s)</h3>

<p>Insang Song, Mariana Kassien
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sum_edc">sum_edc</a></code>, <code><a href="#topic+process_tri">process_tri</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
loc &lt;- data.frame(id = "001", lon = -78.90, lat = 35.97)
calculate_tri(
  from = tri, # derived from process_tri() example
  locs = loc,
  locs_id = "id",
  radius = c(1e3L, 1e4L, 5e4L)
)

## End(Not run)
</code></pre>

<hr>
<h2 id='check_destfile'>Check if destination file exists or is 0 bytes.</h2><span id='topic+check_destfile'></span>

<h3>Description</h3>

<p>Check if destination file exists or is 0 bytes. If either condition is
met, the function returns <code>TRUE</code> to allow the download to proceed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_destfile(destfile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_destfile_+3A_destfile">destfile</code></td>
<td>
<p>character(1). Destination file path.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical(1)
</p>

<hr>
<h2 id='check_for_null_parameters'>Check parameters</h2><span id='topic+check_for_null_parameters'></span>

<h3>Description</h3>

<p>Check that all parameters have been assigned a value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_for_null_parameters(parameters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_for_null_parameters_+3A_parameters">parameters</code></td>
<td>
<p>parameters passed to function (called by
<code>mget(ls())</code>.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; returns a stop error if one or more function
parameters other than 'extent' are NULL
</p>

<hr>
<h2 id='check_geom'>Check that <code>geom</code> value is one of <code>FALSE</code>, <code>"sf"</code>, or <code>"terra"</code></h2><span id='topic+check_geom'></span>

<h3>Description</h3>

<p>Check that <code>geom</code> value is one of <code>FALSE</code>, <code>"sf"</code>,
or <code>"terra"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_geom(geom)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_geom_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; will stop if <code>geom</code> is not one of the three options
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>

<hr>
<h2 id='check_mysf'>Check <code>sf</code> object</h2><span id='topic+check_mysf'></span>

<h3>Description</h3>

<p>Check an <code>sf</code> object for its class, <code>$geometry</code> column, and
geometry class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_mysf(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_mysf_+3A_x">x</code></td>
<td>
<p>an <code>sf</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; returns stop error if <code>x</code> does not match class
and/or column expectations
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>

<hr>
<h2 id='check_mysftime'>Check <code>sftime</code> object</h2><span id='topic+check_mysftime'></span>

<h3>Description</h3>

<p>Check an <code>sftime</code> object for its class, <code>$time</code> column,
<code>$geometry</code> column, and geometry class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_mysftime(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_mysftime_+3A_x">x</code></td>
<td>
<p>an <code>sftime</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; returns stop error if <code>x</code> does not match class
and column expectations
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>

<hr>
<h2 id='check_url_status'>Check HTTP status</h2><span id='topic+check_url_status'></span>

<h3>Description</h3>

<p>Check if provided URL returns HTTP status 200 or 206.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_url_status(url, method = c("HEAD", "GET"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_url_status_+3A_url">url</code></td>
<td>
<p>Download URL to be checked.</p>
</td></tr>
<tr><td><code id="check_url_status_+3A_method">method</code></td>
<td>
<p>httr method to obtain URL (<code>"HEAD"</code> or <code>"GET"</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical object
</p>


<h3>Author(s)</h3>

<p>Insang Song; Mitchell Manware
</p>

<hr>
<h2 id='check_urls'>Implement <code>check_url_status</code></h2><span id='topic+check_urls'></span>

<h3>Description</h3>

<p>Apply <code>check_url_status()</code> function to a sample of download URLs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_urls(urls = urls, size = NULL, method = c("HEAD", "GET", "SKIP"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_urls_+3A_urls">urls</code></td>
<td>
<p>character vector of URLs</p>
</td></tr>
<tr><td><code id="check_urls_+3A_size">size</code></td>
<td>
<p>number of observations to be sampled from <code>urls</code></p>
</td></tr>
<tr><td><code id="check_urls_+3A_method">method</code></td>
<td>
<p>httr method to obtain URL (<code>"HEAD"</code> or <code>"GET"</code>). If set to
<code>"SKIP"</code>, the HTTP status will not be checked and returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical vector for URL status = 200
</p>

<hr>
<h2 id='download_aqs'>Download air quality data</h2><span id='topic+download_aqs'></span>

<h3>Description</h3>

<p>The <code>download_aqs()</code> function accesses and downloads Air Quality System (AQS) data from the <a href="https://aqs.epa.gov/aqsweb/airdata/download_files.html">U.S. Environmental Protection Agency's (EPA) Pre-Generated Data Files</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_aqs(
  parameter_code = 88101,
  resolution_temporal = "daily",
  year = c(2018, 2022),
  url_aqs_download = "https://aqs.epa.gov/aqsweb/airdata/",
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  unzip = TRUE,
  remove_zip = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_aqs_+3A_parameter_code">parameter_code</code></td>
<td>
<p>integer(1). length of 5.
EPA pollutant parameter code. For details, please refer to
<a href="https://aqs.epa.gov/aqsweb/documents/codetables/parameters.html">AQS parameter codes</a></p>
</td></tr>
<tr><td><code id="download_aqs_+3A_resolution_temporal">resolution_temporal</code></td>
<td>
<p>character(1).
Name of column containing POC values.
Currently, no value other than <code>"daily"</code> works.</p>
</td></tr>
<tr><td><code id="download_aqs_+3A_year">year</code></td>
<td>
<p>character(1 or 2). length of 4. Year or start/end years for downloading data.</p>
</td></tr>
<tr><td><code id="download_aqs_+3A_url_aqs_download">url_aqs_download</code></td>
<td>
<p>character(1).
URL to the AQS pre-generated datasets.</p>
</td></tr>
<tr><td><code id="download_aqs_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data. Two
sub-directories will be created for the downloaded zip files (&quot;/zip_files&quot;)
and the unzipped data files (&quot;/data_files&quot;).</p>
</td></tr>
<tr><td><code id="download_aqs_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_aqs_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_aqs_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands. Default is FALSE.</p>
</td></tr>
<tr><td><code id="download_aqs_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip zip files. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="download_aqs_+3A_remove_zip">remove_zip</code></td>
<td>
<p>logical(1). Remove zip file from directory_to_download.
Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="download_aqs_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Zip and/or data files will be downloaded and stored in
<code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mariana Kassien, Insang Song, Mitchell Manware
</p>


<h3>References</h3>

<p>U.S. Environmental Protection Agency (2023).
&ldquo;Air Quality System Data Mart [internet database].&rdquo;
<a href="https://www.epa.gov/outdoor-air-quality-data">https://www.epa.gov/outdoor-air-quality-data</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_aqs(
  parameter_code = 88101,
  resolution_temporal = "daily",
  year = 2023,
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
  unzip = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_cropscape'>Download CropScape data</h2><span id='topic+download_cropscape'></span>

<h3>Description</h3>

<p>Accesses and downloads United States Department of Agriculture
CropScape Cropland Data Layer data from
the <a href="https://www.nass.usda.gov/Research_and_Science/Cropland/Release/index.php">USDA National Agricultural Statistics Service</a> or the
<a href="https://nassgeodata.gmu.edu/CropScape/">George Mason University website</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_cropscape(
  year = seq(1997, 2023),
  source = c("USDA", "GMU"),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  unzip = TRUE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_cropscape_+3A_year">year</code></td>
<td>
<p>integer(1). Year of the data to download.</p>
</td></tr>
<tr><td><code id="download_cropscape_+3A_source">source</code></td>
<td>
<p>character(1). Data source, one of <code>c("USDA", "GMU")</code>.
</p>

<ul>
<li> <p><code>"USDA"</code> will download the national data from the USDA website (available in 2008-last year).
</p>
</li>
<li> <p><code>"GMU"</code> will download the data from the George Mason University website (available in 1997-last year).
</p>
</li></ul>
</td></tr>
<tr><td><code id="download_cropscape_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to download files.</p>
</td></tr>
<tr><td><code id="download_cropscape_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_cropscape_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_cropscape_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_cropscape_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip the downloaded compressed files.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="download_cropscape_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Yearly comma-separated value (CSV) files will be stored in
<code>directory_to_save</code>.
</p>
</li></ul>



<h3>Note</h3>

<p>JSON files should be found at STAC catalog of OpenLandMap
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_cropscape(
  year = 2020,
  source = "USDA",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
  unzip = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_data'>Download raw data wrapper function</h2><span id='topic+download_data'></span>

<h3>Description</h3>

<p>The <code>download_data()</code> function accesses and downloads atmospheric, meteorological, and environmental data from various open-access data sources.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_data(
  dataset_name = c("aqs", "ecoregion", "ecoregions", "geos", "gmted", "koppen",
    "koppengeiger", "merra2", "merra", "modis", "narr", "nlcd", "noaa", "sedac_groads",
    "sedac_population", "groads", "population", "hms", "smoke", "tri", "nei", "gridmet",
    "terraclimate", "huc", "cropscape", "cdl", "prism"),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  hash = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_data_+3A_dataset_name">dataset_name</code></td>
<td>
<p>character(1). Dataset to download.</p>
</td></tr>
<tr><td><code id="download_data_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save / unzip
(if zip files are downloaded) data.</p>
</td></tr>
<tr><td><code id="download_data_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_data_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="download_data_+3A_...">...</code></td>
<td>
<p>Arguments passed to each download function.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Data files will be downloaded and stored in respective
sub-directories within <code>directory_to_save</code>. File format and
sub-directory names depend on data source and dataset of interest.
</p>
</li></ul>



<h3>Note</h3>


<ul>
<li><p> All download function names are in <code>download_*</code> formats
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>

<p>For details of each download function per dataset,
Please refer to:
</p>

<ul>
<li> <p><code><a href="#topic+download_aqs">download_aqs</a></code>: <code>"aqs"</code>, <code>"AQS"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_ecoregion">download_ecoregion</a></code>: <code>"ecoregions"</code>, <code>"ecoregion"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_geos">download_geos</a></code>: <code>"geos"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_gmted">download_gmted</a></code>: <code>"gmted"</code>, <code>"GMTED"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_koppen_geiger">download_koppen_geiger</a></code>: <code>"koppen"</code>, <code>"koppengeiger"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_merra2">download_merra2</a></code>: &quot;merra2&quot;, <code>"merra"</code>, <code>"MERRA"</code>, <code>"MERRA2"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_narr">download_narr</a></code>: <code>"narr"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_nlcd">download_nlcd</a></code>: <code>"nlcd"</code>, <code>"NLCD"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_hms">download_hms</a></code>: <code>"noaa"</code>, <code>"smoke"</code>, <code>"hms"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_groads">download_groads</a></code>: <code>"sedac_groads"</code>, <code>"groads"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_population">download_population</a></code>: <code>"sedac_population"</code>,
<code>"population"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_modis">download_modis</a></code>: <code>"modis"</code>, <code>"MODIS"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_tri">download_tri</a></code>: <code>"tri"</code>, <code>"TRI"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_nei">download_nei</a></code>: <code>"nei"</code>, <code>"NEI"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_gridmet">download_gridmet</a></code>: <code>"gridMET"</code>, <code>"gridmet"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_terraclimate">download_terraclimate</a></code>: <code>"TerraClimate"</code>, <code>"terraclimate"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_huc">download_huc</a></code>: <code>"huc"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_cropscape">download_cropscape</a></code>: <code>"cropscape"</code>, <code>"cdl"</code>
</p>
</li>
<li> <p><code><a href="#topic+download_prism">download_prism</a></code>: <code>"prism"</code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_data(
  dataset_name = "narr",
  variables = "weasd",
  year = 2023,
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_ecoregion'>Download ecoregion data</h2><span id='topic+download_ecoregion'></span>

<h3>Description</h3>

<p>The <code>download_ecoregion()</code> function accesses and downloads United States Ecoregions data from the <a href="https://www.epa.gov/eco-research/ecoregions">U.S. Environmental Protection Agency's (EPA) Ecorgions</a>. Level 3 data, where all pieces of information in the higher levels are included, are downloaded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_ecoregion(
  epa_certificate_path = system.file("extdata/cacert_gaftp_epa.pem", package = "amadeus"),
  certificate_url =
    "http://cacerts.digicert.com/DigiCertGlobalG2TLSRSASHA2562020CA1-1.crt",
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  unzip = TRUE,
  remove_zip = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_ecoregion_+3A_epa_certificate_path">epa_certificate_path</code></td>
<td>
<p>character(1). Path to the certificate file
for EPA DataCommons. Default is
'extdata/cacert_gaftp_epa.pem' under the package installation path.</p>
</td></tr>
<tr><td><code id="download_ecoregion_+3A_certificate_url">certificate_url</code></td>
<td>
<p>character(1). URL to certificate file. See notes for
details.</p>
</td></tr>
<tr><td><code id="download_ecoregion_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data. Two
sub-directories will be created for the downloaded zip files (&quot;/zip_files&quot;)
and the unzipped data files (&quot;/data_files&quot;).</p>
</td></tr>
<tr><td><code id="download_ecoregion_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_ecoregion_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_ecoregion_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_ecoregion_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip zip files. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="download_ecoregion_+3A_remove_zip">remove_zip</code></td>
<td>
<p>logical(1). Remove zip file from
<code>directory_to_download</code>. Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="download_ecoregion_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Zip and/or data files will be downloaded and stored in
<code>directory_to_save</code>.
</p>
</li></ul>



<h3>Note</h3>

<p>For EPA Data Commons certificate errors, follow the steps below:
</p>

<ol>
<li><p> Click Lock icon in the address bar at https://gaftp.epa.gov
</p>
</li>
<li><p> Click Show Certificate
</p>
</li>
<li><p> Access Details
</p>
</li>
<li><p> Find URL with *.crt extension
Currently we bundle the pre-downloaded crt and its PEM (which is accepted
in wget command) file in ./inst/extdata. The instruction above is for
certificate updates in the future.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>References</h3>

<p>Omernik JM, Griffith GE (2014).
&ldquo;Ecoregions of the Conterminous United States: Evolution of a Hierarchical Spatial Framework.&rdquo;
<em>Environmental Management</em>, <b>54</b>(6), 1249&ndash;1266.
ISSN 0364-152X, 1432-1009, <a href="https://doi.org/10.1007/s00267-014-0364-1">doi:10.1007/s00267-014-0364-1</a>, <a href="https://link.springer.com/article/10.1007/s00267-014-0364-1">https://link.springer.com/article/10.1007/s00267-014-0364-1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_ecoregion(
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
  unzip = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_epa_certificate'>Check EPA certificate</h2><span id='topic+download_epa_certificate'></span>

<h3>Description</h3>

<p>Check EPA certificate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_epa_certificate(
  epa_certificate_path = "cacert_gaftp_epa.pem",
  certificate_url =
    "http://cacerts.digicert.com/DigiCertGlobalG2TLSRSASHA2562020CA1-1.crt"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_epa_certificate_+3A_epa_certificate_path">epa_certificate_path</code></td>
<td>
<p>character(1).
Full path of a converted certificate of EPA.
Should end with <code>.pem</code></p>
</td></tr>
<tr><td><code id="download_epa_certificate_+3A_certificate_url">certificate_url</code></td>
<td>
<p>character(1).
URL of the original certificate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A file designated in <code>epa_certificate_path</code>
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>

<hr>
<h2 id='download_geos'>Download atmospheric composition data</h2><span id='topic+download_geos'></span>

<h3>Description</h3>

<p>The <code>download_geos()</code> function accesses and downloads various
atmospheric composition collections from <a href="https://gmao.gsfc.nasa.gov/GEOS_systems/">NASA's Global Earth Observing System (GEOS) model</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_geos(
  collection = c("aqc_tavg_1hr_g1440x721_v1", "chm_tavg_1hr_g1440x721_v1",
    "met_tavg_1hr_g1440x721_x1", "xgc_tavg_1hr_g1440x721_x1",
    "chm_inst_1hr_g1440x721_p23", "met_inst_1hr_g1440x721_p23"),
  date = c("2018-01-01", "2018-01-01"),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_geos_+3A_collection">collection</code></td>
<td>
<p>character(1). GEOS-CF data collection file name.</p>
</td></tr>
<tr><td><code id="download_geos_+3A_date">date</code></td>
<td>
<p>character(1 or 2). length of 10. Date or start/end dates for downloading data.
Format &quot;YYYY-MM-DD&quot; (ex. January 1, 2018 = <code>"2018-01-01"</code>).</p>
</td></tr>
<tr><td><code id="download_geos_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data.
Sub-directories will be created within <code>directory_to_save</code> for each
GEOS-CF collection.</p>
</td></tr>
<tr><td><code id="download_geos_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_geos_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_geos_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_geos_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> netCDF (.nc4) files will be stored in a
collection-specific folder within <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mitchell Manware, Insang Song
</p>


<h3>References</h3>

<p>Keller CA, Knowland KE, Duncan BN, Liu J, Anderson DC, Das S, Lucchesi RA, Lundgren EW, Nicely JM, Nielsen E, Ott LE, Saunders E, Strode SA, Wales PA, Jacob DJ, Pawson S (2021).
&ldquo;Description of the NASA GEOS Composition Forecast Modeling System GEOS‐CF v1.0.&rdquo;
<em>Journal of Advances in Modeling Earth Systems</em>, <b>13</b>(4), e2020MS002413.
ISSN 1942-2466, 1942-2466, <a href="https://doi.org/10.1029/2020MS002413">doi:10.1029/2020MS002413</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_geos(
  collection = "aqc_tavg_1hr_g1440x721_v1",
  date = "2024-01-01",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_gmted'>Download elevation data</h2><span id='topic+download_gmted'></span>

<h3>Description</h3>

<p>The <code>download_gmted()</code> function accesses and downloads Global
Multi-resolution Terrain Elevation Data (GMTED2010) from
<a href="https://www.usgs.gov/coastal-changes-and-impacts/gmted2010">U.S. Geological Survey and National Geospatial-Intelligence Agency</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_gmted(
  statistic = c("Breakline Emphasis", "Systematic Subsample", "Median Statistic",
    "Minimum Statistic", "Mean Statistic", "Maximum Statistic",
    "Standard Deviation Statistic"),
  resolution = c("7.5 arc-seconds", "15 arc-seconds", "30 arc-seconds"),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  unzip = TRUE,
  remove_zip = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_gmted_+3A_statistic">statistic</code></td>
<td>
<p>character(1). Available statistics include <code>"Breakline Emphasis"</code>, <code>"Systematic Subsample"</code>, <code>"Median Statistic"</code>,
<code>"Minimum Statistic"</code>, <code>"Mean Statistic"</code>, <code>"Maximum Statistic"</code>, and
<code>"Standard Deviation Statistic"</code>.</p>
</td></tr>
<tr><td><code id="download_gmted_+3A_resolution">resolution</code></td>
<td>
<p>character(1). Available resolutions include <code>"7.5 arc-seconds"</code>, <code>"15 arc-seconds"</code>, and <code>"30 arc-seconds"</code>.</p>
</td></tr>
<tr><td><code id="download_gmted_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data. Two
sub-directories will be created for the downloaded zip files (&quot;/zip_files&quot;)
and the unzipped data files (&quot;/data_files&quot;).</p>
</td></tr>
<tr><td><code id="download_gmted_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_gmted_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_gmted_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands. Default is FALSE.</p>
</td></tr>
<tr><td><code id="download_gmted_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip zip files. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="download_gmted_+3A_remove_zip">remove_zip</code></td>
<td>
<p>logical(1). Remove zip file from directory_to_download.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="download_gmted_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Zip and/or data files will be downloaded and stored in
<code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mitchell Manware, Insang Song
</p>


<h3>References</h3>

<p>Danielson JJ, Gesch DB (2011).
&ldquo;Global multi-resolution terrain elevation data 2010 (GMTED2010).&rdquo;
Open-File Report 2011-1073, U.S. Geological Survey.
Series: Open-File Report, <a href="https://doi.org/10.3133/ofr20111073">https://doi.org/10.3133/ofr20111073</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_gmted(
  statistic = "Breakline Emphasis",
  resolution = "7.5 arc-seconds",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
  unzip = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_gridmet'>Download gridMET data</h2><span id='topic+download_gridmet'></span>

<h3>Description</h3>

<p>The <code>download_gridmet</code> function accesses and downloads gridded surface meteorological data from the <a href="https://www.climatologylab.org/gridmet.html">University of California Merced Climatology Lab's gridMET dataset</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_gridmet(
  variables = NULL,
  year = c(2018, 2022),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_gridmet_+3A_variables">variables</code></td>
<td>
<p>character(1). Variable(s) name(s). See <a href="https://www.climatologylab.org/wget-gridmet.html">gridMET Generate Wget File</a>
for variable names and acronym codes. (Note: variable &quot;Burning Index&quot; has code &quot;bi&quot; and variable
&quot;Energy Release Component&quot; has code &quot;erc&quot;).</p>
</td></tr>
<tr><td><code id="download_gridmet_+3A_year">year</code></td>
<td>
<p>character(1 or 2). length of 4. Year or start/end years for downloading data.</p>
</td></tr>
<tr><td><code id="download_gridmet_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory(s) to save downloaded data
files.</p>
</td></tr>
<tr><td><code id="download_gridmet_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_gridmet_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_gridmet_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_gridmet_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> netCDF (.nc) files will be stored in a variable-specific
folder within <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>References</h3>

<p>Abatzoglou JT (2013).
&ldquo;Development of gridded surface meteorological data for ecological applications and modelling.&rdquo;
<em>International journal of climatology</em>, <b>33</b>(1), 121&ndash;131.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_gridmet(
  variables = "Precipitation",
  year = 2023,
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_groads'>Download roads data</h2><span id='topic+download_groads'></span>

<h3>Description</h3>

<p>The <code>download_groads()</code> function accesses and downloads
roads data from <a href="https://earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-groads-v1-1.00">NASA's Global Roads Open Access Data Set (gROADS), v1 (1980-2010)</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_groads(
  data_region = c("Americas", "Global", "Africa", "Asia", "Europe", "Oceania East",
    "Oceania West"),
  data_format = c("Shapefile", "Geodatabase"),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  unzip = TRUE,
  remove_zip = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_groads_+3A_data_region">data_region</code></td>
<td>
<p>character(1). Data can be downloaded for <code>"Global"</code>,
<code>"Africa"</code>, <code>"Asia"</code>, <code>"Europe"</code>, <code>"Americas"</code>, <code>"Oceania East"</code>, and <code>"Oceania West"</code>.</p>
</td></tr>
<tr><td><code id="download_groads_+3A_data_format">data_format</code></td>
<td>
<p>character(1). Data can be downloaded as <code>"Shapefile"</code> or
<code>"Geodatabase"</code>. (Only <code>"Geodatabase"</code> available for <code>"Global"</code> region).</p>
</td></tr>
<tr><td><code id="download_groads_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data. Two
sub-directories will be created for the downloaded zip files (&quot;/zip_files&quot;)
and the unzipped shapefiles (&quot;/data_files&quot;).</p>
</td></tr>
<tr><td><code id="download_groads_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_groads_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_groads_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_groads_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip zip files. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="download_groads_+3A_remove_zip">remove_zip</code></td>
<td>
<p>logical(1). Remove zip files from directory_to_download.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="download_groads_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Zip and/or data files will be downloaded and stored in
respective sub-directories within <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mitchell Manware, Insang Song
</p>


<h3>References</h3>

<p>Center For International Earth Science Information Network-CIESIN-Columbia University, Information Technology Outreach Services-ITOS-University Of Georgia (2013).
&ldquo;Global Roads Open Access Data Set, Version 1 (gROADSv1).&rdquo;
<a href="https://doi.org/10.7927/H4VD6WCT">doi:10.7927/H4VD6WCT</a>, <a href="https://earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-groads-v1-1.00">https://earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-groads-v1-1.00</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_groads(
  data_region = "Americas",
  data_format = "Shapefile",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
  unzip = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_hash'>Create hash of downloaded files.</h2><span id='topic+download_hash'></span>

<h3>Description</h3>

<p>Create a combined md5sum hash based on the files in a specified directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_hash(hash = TRUE, dir = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_hash_+3A_hash">hash</code></td>
<td>
<p>logical(1). Create hash of downloaded files.</p>
</td></tr>
<tr><td><code id="download_hash_+3A_dir">dir</code></td>
<td>
<p>character(1). Directory path.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character(1) Combined 128-bit md5sum of download files.
</p>

<hr>
<h2 id='download_hms'>Download wildfire smoke data</h2><span id='topic+download_hms'></span>

<h3>Description</h3>

<p>The <code>download_hms()</code> function accesses and downloads
wildfire smoke plume coverage data from <a href="https://www.ospo.noaa.gov/products/land/hms.html#0">NOAA's Hazard Mapping System Fire and Smoke Product</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_hms(
  data_format = "Shapefile",
  date = c("2018-01-01", "2018-01-01"),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  unzip = TRUE,
  remove_zip = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_hms_+3A_data_format">data_format</code></td>
<td>
<p>character(1). &quot;Shapefile&quot; or &quot;KML&quot;.</p>
</td></tr>
<tr><td><code id="download_hms_+3A_date">date</code></td>
<td>
<p>character(1 or 2). length of 10. Date or start/end dates for downloading data.
Format &quot;YYYY-MM-DD&quot; (ex. January 1, 2018 = <code>"2018-01-01"</code>).</p>
</td></tr>
<tr><td><code id="download_hms_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data. If
<code>data_format = "Shapefile"</code>, two sub-directories will be created for the
downloaded zip files (&quot;/zip_files&quot;) and the unzipped shapefiles
(&quot;/data_files&quot;). If <code>data_format = "KML"</code>, a single sub-directory
(&quot;/data_files&quot;) will be created.</p>
</td></tr>
<tr><td><code id="download_hms_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1).
By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_hms_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_hms_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_hms_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip zip files. Default is <code>TRUE</code>. (Ignored
if <code>data_format = "KML"</code>.)</p>
</td></tr>
<tr><td><code id="download_hms_+3A_remove_zip">remove_zip</code></td>
<td>
<p>logical(1). Remove zip files from
directory_to_download. Default is <code>FALSE</code>.
(Ignored if <code>data_format = "KML"</code>.)</p>
</td></tr>
<tr><td><code id="download_hms_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Zip and/or data files will be downloaded and stored in
respective sub-directories within <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mitchell Manware, Insang Song
</p>


<h3>References</h3>

<p>(????).
&ldquo;Hazard Mapping System Fire and Smoke Product: Hazard Mapping System.&rdquo;
<a href="https://www.ospo.noaa.gov/products/land/hms.html#about">https://www.ospo.noaa.gov/products/land/hms.html#about</a>.
<a href="https://www.ospo.noaa.gov/products/land/hms.html#about">https://www.ospo.noaa.gov/products/land/hms.html#about</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_hms(
  data_format = "Shapefile",
  date = "2024-01-01",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
  unzip = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_huc'>Download National Hydrography Dataset (NHD) data</h2><span id='topic+download_huc'></span>

<h3>Description</h3>

<p>NHDPlus data provides the most comprehensive and high-resolution
hydrography data. This function downloads <strong>national</strong> dataset from
NHDPlus Version 2.1 on USGS Amazon S3 storage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_huc(
  region = c("Lower48", "Islands"),
  type = c("Seamless", "OceanCatchment"),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  unzip = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_huc_+3A_region">region</code></td>
<td>
<p>character(1). One of <code>c("Lower48", "Islands")</code>.
When <code>"Islands"</code> is selected, the data will be downloaded for Hawaii, Puerto Rico, and Virgin Islands.</p>
</td></tr>
<tr><td><code id="download_huc_+3A_type">type</code></td>
<td>
<p>character(1). One of <code>c("Seamless", "OceanCatchment")</code>.</p>
</td></tr>
<tr><td><code id="download_huc_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to download files.</p>
</td></tr>
<tr><td><code id="download_huc_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_huc_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_huc_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_huc_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip the downloaded compressed files.
Default is <code>FALSE</code>. Not working for this function since HUC data is in 7z format.</p>
</td></tr>
<tr><td><code id="download_huc_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Downloaded files will be stored in <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Note</h3>

<p>For HUC, set <code>type = "Seamless"</code>. HUC12 layer presents in the seamless
geodatabase. Users can aggregate HUC12 layer to make HUC6, HUC8, HUC10, etc.
For whom wants to download a specific region,
please visit <a href="https://www.epa.gov/waterdata/get-nhdplus-national-hydrography-dataset-plus-data#ListofAreas">Get NHDPlus Data</a>
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>References</h3>

<p>U.S. Geological Survey (2023).
&ldquo;National Hydrography Dataset (NHD) &ndash; USGS National Map Downloadable Data Collection.&rdquo;
<a href="https://www.usgs.gov/national-hydrography">https://www.usgs.gov/national-hydrography</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_huc(
  region = "Lower48",
  type = "Seamless",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
  unzip = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_koppen_geiger'>Download climate classification data</h2><span id='topic+download_koppen_geiger'></span>

<h3>Description</h3>

<p>The <code>download_koppen_geiger()</code> function accesses and downloads
climate classification data from the <em>Present and future
Köppen-Geiger climate classification maps at
1-km resolution</em>(<a href="https://www.nature.com/articles/sdata2018214">link for article</a>; <a href="https://figshare.com/articles/dataset/Present_and_future_K_ppen-Geiger_climate_classification_maps_at_1-km_resolution/6396959/2">link for data</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_koppen_geiger(
  data_resolution = c("0.0083", "0.083", "0.5"),
  time_period = c("Present", "Future"),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  unzip = TRUE,
  remove_zip = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_koppen_geiger_+3A_data_resolution">data_resolution</code></td>
<td>
<p>character(1). Available resolutions are <code>"0.0083"</code>
degrees (approx. 1 km), <code>"0.083"</code> degrees (approx. 10 km), and
<code>"0.5"</code> degrees (approx. 50 km).</p>
</td></tr>
<tr><td><code id="download_koppen_geiger_+3A_time_period">time_period</code></td>
<td>
<p>character(1). Available times are <code>"Present"</code> (1980-2016)
and <code>"Future"</code> (2071-2100). (&quot;Future&quot; classifications are based on scenario
RCP8.5).</p>
</td></tr>
<tr><td><code id="download_koppen_geiger_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data. Two
sub-directories will be created for the downloaded zip files (&quot;/zip_files&quot;)
and the unzipped shapefiles (&quot;/data_files&quot;).</p>
</td></tr>
<tr><td><code id="download_koppen_geiger_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_koppen_geiger_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_koppen_geiger_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_koppen_geiger_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip zip files. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="download_koppen_geiger_+3A_remove_zip">remove_zip</code></td>
<td>
<p>logical(1). Remove zip files from directory_to_download.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="download_koppen_geiger_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Zip and/or data files will be downloaded and stored in
respective sub-directories within <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mitchell Manware, Insang Song
</p>


<h3>References</h3>

<p>Beck HE, McVicar TR, Vergopolan N, Berg A, Lutsko NJ, Dufour A, Zeng Z, Jiang X, Van Dijk AIJM, Miralles DG (2023).
&ldquo;High-resolution (1 km) Köppen-Geiger maps for 1901–2099 based on constrained CMIP6 projections.&rdquo;
<em>Scientific Data</em>, <b>10</b>(1), 724.
ISSN 2052-4463, <a href="https://doi.org/10.1038/s41597-023-02549-6">doi:10.1038/s41597-023-02549-6</a>, <a href="https://www.nature.com/articles/s41597-023-02549-6">https://www.nature.com/articles/s41597-023-02549-6</a>.
</p>
<p>Beck HE, Zimmermann NE, McVicar TR, Vergopolan N, Berg A, Wood EF (2018).
&ldquo;Present and future Köppen-Geiger climate classification maps at 1-km resolution.&rdquo;
<em>Scientific data</em>, <b>5</b>(1), 1&ndash;12.
<a href="https://doi.org/10.1038/sdata.2018.214">doi:10.1038/sdata.2018.214</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_koppen_geiger(
  data_resolution = "0.0083",
  time_period = "Present",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
  unzip = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_merra2'>Download meteorological and atmospheric data</h2><span id='topic+download_merra2'></span>

<h3>Description</h3>

<p>The <code>download_merra2()</code> function accesses and downloads various
meteorological and atmospheric collections from <a href="https://gmao.gsfc.nasa.gov/reanalysis/MERRA-2/">NASA's Modern-Era Retrospective analysis for Research and Applications, Version 2 (MERRA-2) model</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_merra2(
  collection = c("inst1_2d_asm_Nx", "inst1_2d_int_Nx", "inst1_2d_lfo_Nx",
    "inst3_3d_asm_Np", "inst3_3d_aer_Nv", "inst3_3d_asm_Nv", "inst3_3d_chm_Nv",
    "inst3_3d_gas_Nv", "inst3_2d_gas_Nx", "inst6_3d_ana_Np", "inst6_3d_ana_Nv",
    "statD_2d_slv_Nx", "tavg1_2d_adg_Nx", "tavg1_2d_aer_Nx", "tavg1_2d_chm_Nx",
    "tavg1_2d_csp_Nx", "tavg1_2d_flx_Nx", "tavg1_2d_int_Nx", "tavg1_2d_lfo_Nx",
    "tavg1_2d_lnd_Nx", "tavg1_2d_ocn_Nx", "tavg1_2d_rad_Nx", "tavg1_2d_slv_Nx",
    "tavg3_3d_mst_Ne", "tavg3_3d_trb_Ne", "tavg3_3d_nav_Ne", "tavg3_3d_cld_Np", 
    
    "tavg3_3d_mst_Np", "tavg3_3d_rad_Np", "tavg3_3d_tdt_Np", "tavg3_3d_trb_Np",
    "tavg3_3d_udt_Np", "tavg3_3d_odt_Np", "tavg3_3d_qdt_Np", "tavg3_3d_asm_Nv",
    "tavg3_3d_cld_Nv", "tavg3_3d_mst_Nv", "tavg3_3d_rad_Nv", "tavg3_2d_glc_Nx"),
  date = c("2018-01-01", "2018-01-01"),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_merra2_+3A_collection">collection</code></td>
<td>
<p>character(1). MERRA-2 data collection file name.</p>
</td></tr>
<tr><td><code id="download_merra2_+3A_date">date</code></td>
<td>
<p>character(1 or 2). length of 10. Date or start/end dates for downloading data.
Format &quot;YYYY-MM-DD&quot; (ex. January 1, 2018 = <code>"2018-01-01"</code>).</p>
</td></tr>
<tr><td><code id="download_merra2_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data.</p>
</td></tr>
<tr><td><code id="download_merra2_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_merra2_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_merra2_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="download_merra2_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.
the text file containing download commands.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> netCDF (.nc4) files will be stored in a
collection-specific folder within <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mitchell Manware, Insang Song
</p>


<h3>References</h3>

<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 inst1_2d_  asm_  Nx: 2d,3-Hourly,Instantaneous,Single-Level,Assimilation,Single-Level Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/3Z173KIE2TPD">doi:10.5067/3Z173KIE2TPD</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2I1NXASM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2I1NXASM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 inst1_2d_  int_  Nx: 2d,1-Hourly,Instantaneous,Single-Level,Assimilation,Vertically Integrated Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/G0U6NGQ3BLE0">doi:10.5067/G0U6NGQ3BLE0</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2I1NXINT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2I1NXINT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 inst1_2d_  lfo_  Nx: 2d,1-Hourly,Instantaneous,Single-Level,Assimilation,Land Surface Forcings V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/RCMZA6TL70BG">doi:10.5067/RCMZA6TL70BG</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2I1NXLFO_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2I1NXLFO_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 inst3_3d_  asm_  Np: 3d,3-Hourly,Instantaneous,Pressure-Level,Assimilation,Assimilated Meteorological Fields V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/QBZ6MG944HW0">doi:10.5067/QBZ6MG944HW0</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2I3NPASM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2I3NPASM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 inst3_3d_  aer_  Nv: 3d,3-Hourly,Instantaneous,Model-Level,Assimilation,Aerosol Mixing Ratio V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/LTVB4GPCOTK2">doi:10.5067/LTVB4GPCOTK2</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2I3NVAER_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2I3NVAER_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 inst3_3d_  asm_  Nv: 3d,3-Hourly,Instantaneous,Model-Level,Assimilation,Assimilated Meteorological Fields V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/WWQSXQ8IVFW8">doi:10.5067/WWQSXQ8IVFW8</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2I3NVASM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2I3NVASM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 inst3_3d_  chm_  Nv: 3d,3-Hourly,Instantaneous,Model-Level,Assimilation,Carbon Monoxide and Ozone Mixing Ratio V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/HO9OVZWF3KW2">doi:10.5067/HO9OVZWF3KW2</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2I3NVCHM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2I3NVCHM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 inst3_3d_  gas_  Nv: 3d,3-Hourly,Instantaneous,Model-Level,Assimilation,Aerosol Mixing Ratio Analysis Increments V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/96BUID8HGGX5">doi:10.5067/96BUID8HGGX5</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2I3NVGAS_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2I3NVGAS_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 inst3_2d_  gas_  Nx: 2d,3-Hourly,Instantaneous,Single-Level,Assimilation,Aerosol Optical Depth Analysis V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/HNGA0EWW0R09">doi:10.5067/HNGA0EWW0R09</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2I3NXGAS_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2I3NXGAS_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 inst6_3d_  ana_  Np: 3d,6-Hourly,Instantaneous,Pressure-Level,Analysis,Analyzed Meteorological Fields V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/A7S6XP56VZWS">doi:10.5067/A7S6XP56VZWS</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2I6NPANA_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2I6NPANA_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 inst6_3d_  ana_  Nv: 3d,6-Hourly,Instantaneous,Model-Level,Analysis,Analyzed Meteorological Fields V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/IUUF4WB9FT4W">doi:10.5067/IUUF4WB9FT4W</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2I6NVANA_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2I6NVANA_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 statD_2d_  slv_  Nx: 2d,Monthly,Aggregated Statistics,Single-Level,Assimilation,Single-Level Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/KVIMOMCUO83U">doi:10.5067/KVIMOMCUO83U</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2SMNXSLV_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2SMNXSLV_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 statD_2d_  slv_  Nx: 2d,Daily,Aggregated Statistics,Single-Level,Assimilation,Single-Level Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/9SC1VNTWGWV3">doi:10.5067/9SC1VNTWGWV3</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2SDNXSLV_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2SDNXSLV_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg1_2d_  adg_  Nx: 2d,3-Hourly,Time-averaged,Single-Level,Assimilation,Aerosol Diagnostics (extended) V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/HM00OHQBHKTP">doi:10.5067/HM00OHQBHKTP</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T1NXADG_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T1NXADG_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg1_2d_  aer_  Nx: 2d,1-Hourly,Time-averaged,Single-Level,Assimilation,Aerosol Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/KLICLTZ8EM9D">doi:10.5067/KLICLTZ8EM9D</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T1NXAER_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T1NXAER_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg1_2d_  chm_  Nx: 2d,3-Hourly,Time-Averaged,Single-Level,Assimilation,Carbon Monoxide and Ozone Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/3RQ5YS674DGQ">doi:10.5067/3RQ5YS674DGQ</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T1NXCHM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T1NXCHM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg1_2d_  csp_  Nx: 2d,1-Hourly,Time-averaged,Single-Level,Assimilation,COSP Satellite Simulator V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/H0VVAD8F6MX5">doi:10.5067/H0VVAD8F6MX5</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T1NXCSP_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T1NXCSP_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg1_2d_  flx_  Nx: 2d,1-Hourly,Time-Averaged,Single-Level,Assimilation,Surface Flux Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/7MCPBJ41Y0K6">doi:10.5067/7MCPBJ41Y0K6</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T1NXFLX_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T1NXFLX_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg1_2d_  int_  Nx: 2d,1-Hourly,Time-averaged,Single-Level,Assimilation,Vertically Integrated Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/Q5GVUVUIVGO7">doi:10.5067/Q5GVUVUIVGO7</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T1NXINT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T1NXINT_5.12.4/summary</a>.
</p>
<p>Pawson S (2020).
&ldquo;MERRA-2 tavg1_2d_  lfo_  Nx: 2d,1-Hourly,Time-Averaged,Single-Level,Assimilation,Land Surface Forcings V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/L0T5GEG1NYFA">doi:10.5067/L0T5GEG1NYFA</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T1NXLFO_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T1NXLFO_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg1_2d_  lnd_  Nx: 2d,1-Hourly,Time-Averaged,Single-Level,Assimilation,Land Surface Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/RKPHT8KC1Y1T">doi:10.5067/RKPHT8KC1Y1T</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T1NXLND_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T1NXLND_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg1_2d_  ocn_  Nx: 2d,1-Hourly,Time-Averaged,Single-Level,Assimilation,Ocean Surface Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/Y67YQ1L3ZZ4R">doi:10.5067/Y67YQ1L3ZZ4R</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T1NXOCN_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T1NXOCN_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg1_2d_  rad_  Nx: 2d,1-Hourly,Time-Averaged,Single-Level,Assimilation,Radiation Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/Q9QMY5PBNV1T">doi:10.5067/Q9QMY5PBNV1T</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T1NXRAD_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T1NXRAD_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg1_2d_  slv_  Nx: 2d,1-Hourly,Time-Averaged,Single-Level,Assimilation,Single-Level Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/VJAFPLI1CSIV">doi:10.5067/VJAFPLI1CSIV</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T1NXSLV_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T1NXSLV_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  mst_  Ne: 3d,3-Hourly,Time-Averaged,Model-Level Edge,Assimilation,Moist Processes Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/JRUZ3SJ3ZJ72">doi:10.5067/JRUZ3SJ3ZJ72</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NEMST_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NEMST_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  trb_  Ne: 3d,3-Hourly,Time-Averaged,Model-Level Edge,Assimilation,Turbulence Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/4I7ZI35QRH8K">doi:10.5067/4I7ZI35QRH8K</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NETRB_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NETRB_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  nav_  Ne: 3d,3-Hourly,Time-Averaged, Vertical Coordinates V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/N5WAKNS1UYQN">doi:10.5067/N5WAKNS1UYQN</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NENAV_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NENAV_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  cld_  Np: 3d,3-Hourly,Time-Averaged,Pressure-Level,Assimilation,Cloud Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/TX10URJSKT53">doi:10.5067/TX10URJSKT53</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NPCLD_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NPCLD_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  mst_  Np: 3d,3-Hourly,Time-Averaged,Pressure-Level,Assimilation,Moist Processes Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/0TUFO90Q2PMS">doi:10.5067/0TUFO90Q2PMS</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NPMST_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NPMST_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  rad_  Np: 3d,3-Hourly,Time-Averaged,Pressure-Level,Assimilation,Radiation Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/3UGE8WQXZAOK">doi:10.5067/3UGE8WQXZAOK</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NPRAD_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NPRAD_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  tdt_  Np: 3d,3-Hourly,Time-Averaged,Pressure-Level,Assimilation,Temperature Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/9NCR9DDDOPFI">doi:10.5067/9NCR9DDDOPFI</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NPTDT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NPTDT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  trb_  Np: 3d,3-Hourly,Time-Averaged,Pressure-Level,Assimilation,Turbulence Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/ZRRJPGWL8AVL">doi:10.5067/ZRRJPGWL8AVL</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NPTRB_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NPTRB_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  udt_  Np: 3d,3-Hourly,Time-Averaged,Pressure-Level,Assimilation,Wind Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/CWV0G3PPPWFW">doi:10.5067/CWV0G3PPPWFW</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NPUDT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NPUDT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  odt_  Np: 3d,3-Hourly,Time-Averaged,Pressure-Level,Assimilation,Ozone Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/S0LYTK57786Z">doi:10.5067/S0LYTK57786Z</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NPODT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NPODT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  qdt_  Np: 3d,3-Hourly,Time-Averaged,Pressure-Level,Assimilation,Moist Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/A9KWADY78YHQ">doi:10.5067/A9KWADY78YHQ</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NPQDT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NPQDT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  asm_  Nv: 3d,3-Hourly,Time-Averaged,Model-Level,Assimilation,Assimilated Meteorological Fields V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/SUOQESM06LPK">doi:10.5067/SUOQESM06LPK</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NVASM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NVASM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  cld_  Nv: 3d,3-Hourly,Time-Averaged,Model-Level,Assimilation,Cloud Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/F9353J0FAHIH">doi:10.5067/F9353J0FAHIH</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NVCLD_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NVCLD_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  mst_  Nv: 3d,3-Hourly,Time-Averaged,Model-Level,Assimilation,Moist Processes Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/ZXTJ28TQR1TR">doi:10.5067/ZXTJ28TQR1TR</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NVMST_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NVMST_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_3d_  rad_  Nv: 3d,3-Hourly,Time-Averaged,Model-Level,Assimilation,Radiation Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/7GFQKO1T43RW">doi:10.5067/7GFQKO1T43RW</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NVRAD_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NVRAD_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavg3_2d_  glc_  Nx: 2d,3-Hourly,Time-Averaged,Single-Level,Assimilation,Land Ice Surface Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/9ETB4TT5J6US">doi:10.5067/9ETB4TT5J6US</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2T3NXGLC_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2T3NXGLC_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instM_2d_  asm_  Nx: 2d,Monthly mean,Single-Level,Assimilation,Single-Level Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/5ESKGQTZG7FO">doi:10.5067/5ESKGQTZG7FO</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IMNXASM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IMNXASM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instM_2d_  int_  Nx: 2d,Monthly mean,Instantaneous,Single-Level,Assimilation,Vertically Integrated Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/KVTU1A8BWFSJ">doi:10.5067/KVTU1A8BWFSJ</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IMNXINT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IMNXINT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instM_2d_  lfo_  Nx: 2d,Monthly mean,Instantaneous,Single-Level,Assimilation,Land Surface Forcings V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/11F99Y6TXN99">doi:10.5067/11F99Y6TXN99</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IMNXLFO_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IMNXLFO_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instM_2d_  gas_  Nx: 2d,Monthly mean,Instantaneous,Single-Level,Assimilation,Aerosol Optical Depth Analysis V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/XOGNBQEPLUC5">doi:10.5067/XOGNBQEPLUC5</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IMNXGAS_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IMNXGAS_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instM_3d_  asm_  Np: 3d,Monthly mean,Instantaneous,Pressure-Level,Assimilation,Assimilated Meteorological Fields V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/2E096JV59PK7">doi:10.5067/2E096JV59PK7</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IMNPASM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IMNPASM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instM_3d_  ana_  Np: 3d,Monthly mean,Instantaneous,Pressure-Level,Analysis,Analyzed Meteorological Fields V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/V92O8XZ30XBI">doi:10.5067/V92O8XZ30XBI</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IMNPANA_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IMNPANA_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  adg_  Nx: 2d,Monthly mean,Time-averaged,Single-Level,Assimilation,Aerosol Diagnostics (extended) V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/RZIK2TV7PP38">doi:10.5067/RZIK2TV7PP38</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXADG_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXADG_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  aer_  Nx: 2d,Monthly mean,Time-averaged,Single-Level,Assimilation,Aerosol Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/FH9A0MLJPC7N">doi:10.5067/FH9A0MLJPC7N</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXAER_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXAER_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  chm_  Nx: 2d,Monthly mean,Time-Averaged,Single-Level,Assimilation,Carbon Monoxide and Ozone Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/WMT31RKEXK8I">doi:10.5067/WMT31RKEXK8I</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXCHM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXCHM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  csp_  Nx: 2d,Monthly mean,Time-averaged,Single-Level,Assimilation,COSP Satellite Simulator V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/BZPOTGJOQKLU">doi:10.5067/BZPOTGJOQKLU</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXCSP_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXCSP_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  flx_  Nx: 2d,Monthly mean,Time-Averaged,Single-Level,Assimilation,Surface Flux Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/0JRLVL8YV2Y4">doi:10.5067/0JRLVL8YV2Y4</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXFLX_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXFLX_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  int_  Nx: 2d,Monthly mean,Time-Averaged,Single-Level,Assimilation,Vertically Integrated Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/FQPTQ4OJ22TL">doi:10.5067/FQPTQ4OJ22TL</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXINT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXINT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  lfo_  Nx: 2d,Monthly mean,Time-Averaged,Single-Level,Assimilation,Land Surface Forcings V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/5V7K6LJD44SY">doi:10.5067/5V7K6LJD44SY</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXLFO_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXLFO_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  lnd_  Nx: 2d,Monthly mean,Time-Averaged,Single-Level,Assimilation,Land Surface Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/8S35XF81C28F">doi:10.5067/8S35XF81C28F</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXLND_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXLND_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  ocn_  Nx: 2d,Monthly mean,Time-Averaged,Single-Level,Assimilation,Ocean Surface Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/4IASLIDL8EEC">doi:10.5067/4IASLIDL8EEC</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXOCN_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXOCN_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  rad_  Nx: 2d,Monthly mean,Time-Averaged,Single-Level,Assimilation,Radiation Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/OU3HJDS973O0">doi:10.5067/OU3HJDS973O0</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXRAD_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXRAD_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  slv_  Nx: 2d,Monthly mean,Time-Averaged,Single-Level,Assimilation,Single-Level Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/AP1B0BA5PD2K">doi:10.5067/AP1B0BA5PD2K</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXSLV_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXSLV_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_2d_  glc_  Nx: 2d,Monthly mean,Time-Averaged,Single-Level,Assimilation,Land Ice Surface Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/5W8Q3I9WUFGX">doi:10.5067/5W8Q3I9WUFGX</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNXGLC_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNXGLC_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_3d_  cld_  Np: 3d,Monthly mean,Time-Averaged,Pressure-Level,Assimilation,Cloud Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/J9R0LXGH48JR">doi:10.5067/J9R0LXGH48JR</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNPCLD_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNPCLD_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_3d_  mst_  Np: 3d,Monthly mean,Time-Averaged,Pressure-Level,Assimilation,Moist Processes Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/ZRZGD0DCK1CG">doi:10.5067/ZRZGD0DCK1CG</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNPMST_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNPMST_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_3d_  rad_  Np: 3d,Monthly mean,Time-Averaged,Pressure-Level,Assimilation,Radiation Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/H3YGROBVBGFJ">doi:10.5067/H3YGROBVBGFJ</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNPRAD_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNPRAD_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_3d_  tdt_  Np: 3d,Monthly mean,Time-Averaged,Pressure-Level,Assimilation,Temperature Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/VILT59HI2MOY">doi:10.5067/VILT59HI2MOY</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNPTDT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNPTDT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_3d_  trb_  Np: 3d,Monthly mean,Time-Averaged,Pressure-Level,Assimilation,Turbulence Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/2YOIQB5C3ACN">doi:10.5067/2YOIQB5C3ACN</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNPTRB_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNPTRB_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_3d_  udt_  Np: 3d,Monthly mean,Time-Averaged,Pressure-Level,Assimilation,Wind Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/YSR6IA5057XX">doi:10.5067/YSR6IA5057XX</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNPUDT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNPUDT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_3d_  odt_  Np: 3d,Monthly mean,Time-Averaged,Pressure-Level,Assimilation,Ozone Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/Z2KCWAV4GPD2">doi:10.5067/Z2KCWAV4GPD2</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNPODT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNPODT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgM_3d_  qdt_  Np: 3d,Monthly mean,Time-Averaged,Pressure-Level,Assimilation,Moist Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/2ZTU87V69ATP">doi:10.5067/2ZTU87V69ATP</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TMNPQDT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TMNPQDT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 const_2d_  asm_  Nx: 2d, constants.&rdquo;
<a href="https://doi.org/10.5067/ME5QX6Q5IGGU">doi:10.5067/ME5QX6Q5IGGU</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2C0NXASM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2C0NXASM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instU_2d_  asm_  Nx: 2d,Diurnal,Instantaneous,Single-Level,Assimilation,Single-Level Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/BOJSTZAO2L8R">doi:10.5067/BOJSTZAO2L8R</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IUNXASM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IUNXASM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instU_2d_  int_  Nx: 2d,Diurnal,Instantaneous,Single-Level,Assimilation,Vertically Integrated Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/DGAB3HFEYMLY">doi:10.5067/DGAB3HFEYMLY</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IUNXINT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IUNXINT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instU_2d_  lfo_  Nx: 2d,Diurnal,Instantaneous,Single-Level,Assimilation,Land Surface Forcings V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/FC3BVJ88Y8A2">doi:10.5067/FC3BVJ88Y8A2</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IUNXLFO_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IUNXLFO_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instU_2d_  gas_  Nx: 2d,Diurnal,Instantaneous,Single-Level,Assimilation,Aerosol Optical Depth Analysis V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/TVJ4MHBED39L">doi:10.5067/TVJ4MHBED39L</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IUNXGAS_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IUNXGAS_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instU_3d_  asm_  Np: 3d,Diurnal,Instantaneous,Pressure-Level,Assimilation,Assimilated Meteorological Fields V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/6EGRBNEBMIYS">doi:10.5067/6EGRBNEBMIYS</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IUNPASM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IUNPASM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 instU_3d_  ana_  Np: 3d,Diurnal,Instantaneous,Pressure-Level,Analysis,Analyzed Meteorological Fields V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/TRD91YO9S6E7">doi:10.5067/TRD91YO9S6E7</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2IUNPANA_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2IUNPANA_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  adg_  Nx: 2d,Diurnal,Time-averaged,Single-Level,Assimilation,Aerosol Diagnostics (extended) V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/YZJJXZTFCX6B">doi:10.5067/YZJJXZTFCX6B</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXADG_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXADG_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  aer_  Nx: 2d,Diurnal,Time-averaged,Single-Level,Assimilation,Aerosol Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/KPUMVXFEQLA1">doi:10.5067/KPUMVXFEQLA1</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXAER_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXAER_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  chm_  Nx: 2d,Diurnal,Time-Averaged,Single-Level,Assimilation,Carbon Monoxide and Ozone Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/5KFZ6GXRHZKN">doi:10.5067/5KFZ6GXRHZKN</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXCHM_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXCHM_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  csp_  Nx: 2d,Diurnal,Time-averaged,Single-Level,Assimilation,COSP Satellite Simulator V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/9PH5QU4CL9E8">doi:10.5067/9PH5QU4CL9E8</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXCSP_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXCSP_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  flx_  Nx: 2d,Diurnal,Time-Averaged,Single-Level,Assimilation,Surface Flux Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/LUHPNWAKYIO3">doi:10.5067/LUHPNWAKYIO3</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXFLX_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXFLX_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  int_  Nx: 2d,Diurnal,Time-Averaged,Single-Level,Assimilation,Vertically Integrated Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/R2MPVU4EOSWT">doi:10.5067/R2MPVU4EOSWT</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXINT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXINT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  lfo_  Nx: 2d,Diurnal,Time-Averaged,Single-Level,Assimilation,Land Surface Forcings V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/BTSNKAJND3ME">doi:10.5067/BTSNKAJND3ME</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXLFO_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXLFO_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  lnd_  Nx: 2d,Diurnal,Time-Averaged,Single-Level,Assimilation,Land Surface Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/W0J15047CF6N">doi:10.5067/W0J15047CF6N</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXLND_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXLND_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  ocn_  Nx: 2d,Diurnal,Time-Averaged,Single-Level,Assimilation,Ocean Surface Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/KLNAVGAX7J66">doi:10.5067/KLNAVGAX7J66</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXOCN_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXOCN_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  rad_  Nx: 2d,Diurnal,Time-Averaged,Single-Level,Assimilation,Radiation Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/4SDCJYK8P9QU">doi:10.5067/4SDCJYK8P9QU</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXRAD_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXRAD_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  slv_  Nx: 2d,Diurnal,Time-Averaged,Single-Level,Assimilation,Single-Level Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/AFOK0TPEVQEK">doi:10.5067/AFOK0TPEVQEK</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXSLV_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXSLV_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_2d_  glc_  Nx: 2d,Diurnal,Time-Averaged,Single-Level,Assimilation,Land Ice Surface Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/7VUPQC736SWX">doi:10.5067/7VUPQC736SWX</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNXGLC_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNXGLC_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_3d_  cld_  Np: 3d,Diurnal,Time-Averaged,Pressure-Level,Assimilation,Cloud Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/EPW7T5UO0C0N">doi:10.5067/EPW7T5UO0C0N</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNPCLD_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNPCLD_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_3d_  mst_  Np: 3d,Diurnal,Time-Averaged,Pressure-Level,Assimilation,Moist Processes Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/ZRSN0JU27DK2">doi:10.5067/ZRSN0JU27DK2</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNPMST_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNPMST_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_3d_  rad_  Np: 3d,Diurnal,Time-Averaged,Pressure-Level,Assimilation,Radiation Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/H140JMDOWB0Y">doi:10.5067/H140JMDOWB0Y</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNPRAD_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNPRAD_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_3d_  tdt_  Np: 3d,Diurnal,Time-Averaged,Pressure-Level,Assimilation,Temperature Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/QPO9E5TPZ8OF">doi:10.5067/QPO9E5TPZ8OF</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNPTDT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNPTDT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_3d_  trb_  Np: 3d,Diurnal,Time-Averaged,Pressure-Level,Assimilation,Turbulence Diagnostics V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/2A99C60CG7WC">doi:10.5067/2A99C60CG7WC</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNPTRB_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNPTRB_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_3d_  udt_  Np: 3d,Diurnal,Time-Averaged,Pressure-Level,Assimilation,Wind Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/DO715T7T5PG8">doi:10.5067/DO715T7T5PG8</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNPUDT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNPUDT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_3d_  odt_  Np: 3d,Diurnal,Time-Averaged,Pressure-Level,Assimilation,Ozone Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/M8OJ09GZP23E">doi:10.5067/M8OJ09GZP23E</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNPODT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNPODT_5.12.4/summary</a>.
</p>
<p>Global Modeling And Assimilation Office, Pawson S (2015).
&ldquo;MERRA-2 tavgU_3d_  qdt_  Np: 3d,Diurnal,Time-Averaged,Pressure-Level,Assimilation,Moist Tendencies V5.12.4.&rdquo;
<a href="https://doi.org/10.5067/S8HJXIR0BFTS">doi:10.5067/S8HJXIR0BFTS</a>, <a href="https://disc.gsfc.nasa.gov/datasets/M2TUNPQDT_5.12.4/summary">https://disc.gsfc.nasa.gov/datasets/M2TUNPQDT_5.12.4/summary</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_merra2(
  collection = "inst1_2d_int_Nx",
  date = "2024-01-01",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_modis'>Download MODIS product files</h2><span id='topic+download_modis'></span>

<h3>Description</h3>

<p>Need maintenance for the directory path change
in NASA EOSDIS. This function first retrieves the all hdf download links
on a certain day, then only selects the relevant tiles from the retrieved
links. Download is only done at the queried horizontal-vertical tile number
combinations. An exception is MOD06_L2 product, which is produced
every five minutes every day.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_modis(
  product = c("MOD09GA", "MYD09GA", "MOD09GQ", "MYD09GQ", "MOD09A1", "MYD09A1",
    "MOD09Q1", "MYD09Q1", "MOD11A1", "MYD11A1", "MOD11A2", "MYD11A2", "MOD11B1",
    "MYD11B1", "MOD13A1", "MYD13A1", "MOD13A2", "MYD13A2", "MOD13A3", "MYD13A3",
    "MOD06_L2", "MCD19A2", "VNP46A2"),
  version = "61",
  horizontal_tiles = c(7, 13),
  vertical_tiles = c(3, 6),
  mod06_links = NULL,
  nasa_earth_data_token = NULL,
  date = c("2023-09-01", "2023-09-01"),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_modis_+3A_product">product</code></td>
<td>
<p>character(1).
One of <code>c("MOD09GA", "MOD11A1", "MOD06_L2", "MCD19A2", "MOD13A2", "VNP46A2")</code></p>
</td></tr>
<tr><td><code id="download_modis_+3A_version">version</code></td>
<td>
<p>character(1). Default is <code>"61"</code>, meaning v061.</p>
</td></tr>
<tr><td><code id="download_modis_+3A_horizontal_tiles">horizontal_tiles</code></td>
<td>
<p>integer(2). Horizontal tile numbers
<code>c({start}, {end})</code>. Default is <code>c(7, 13)</code>.</p>
</td></tr>
<tr><td><code id="download_modis_+3A_vertical_tiles">vertical_tiles</code></td>
<td>
<p>integer(2). Vertical tile numbers
<code>c({start}, {end})</code>. Default is <code>c(3, 6)</code>.</p>
</td></tr>
<tr><td><code id="download_modis_+3A_mod06_links">mod06_links</code></td>
<td>
<p>character(1). CSV file path to MOD06_L2 download links
from <a href="https://ladsweb.modaps.eosdis.nasa.gov/search/order/2/MOD06_L2--61">NASA LAADS MOD06_L2</a>. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="download_modis_+3A_nasa_earth_data_token">nasa_earth_data_token</code></td>
<td>
<p>character(1).
Token for downloading data from NASA. Should be set before
trying running the function.</p>
</td></tr>
<tr><td><code id="download_modis_+3A_date">date</code></td>
<td>
<p>character(1 or 2). length of 10. Date or start/end dates for downloading data.
Format &quot;YYYY-MM-DD&quot; (ex. January 1, 2018 = <code>"2018-01-01"</code>). Note: ignored if
<code>product == "MOD06_L2"</code>.</p>
</td></tr>
<tr><td><code id="download_modis_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data.</p>
</td></tr>
<tr><td><code id="download_modis_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_modis_+3A_download">download</code></td>
<td>
<p>logical(1). Download data or only save wget commands.</p>
</td></tr>
<tr><td><code id="download_modis_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1). Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_modis_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> HDF (.hdf) files will be stored in year/day_of_year sub-directories within
<code>directory_to_save</code>.
</p>
</li></ul>



<h3>Note</h3>

<p>Both dates in <code>date</code> should be in the same year.
Directory structure looks like
input/modis/raw/{version}/{product}/{year}/{day_of_year}.
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware, Insang Song
</p>


<h3>References</h3>

<p>Lyapustin A, Wang Y (2022).
&ldquo;MODIS/Terra+Aqua Land Aerosol Optical Depth Daily L2G Global 1km SIN Grid V061.&rdquo;
<a href="https://doi.org/10.5067/MODIS/MCD19A2.061">doi:10.5067/MODIS/MCD19A2.061</a>, <a href="https://lpdaac.usgs.gov/products/mcd19a2v061/">https://lpdaac.usgs.gov/products/mcd19a2v061/</a>.
</p>
<p>MODIS Atmosphere Science Team (2017).
&ldquo;MODIS/Terra Clouds 5-Min L2 Swath 1km and 5km.&rdquo;
<a href="https://doi.org/10.5067/MODIS/MOD06_L2.061">doi:10.5067/MODIS/MOD06_L2.061</a>, <a href="https://ladsweb.modaps.eosdis.nasa.gov/missions-and-measurements/products/MOD06_L2">https://ladsweb.modaps.eosdis.nasa.gov/missions-and-measurements/products/MOD06_L2</a>.
</p>
<p>Vermote E, Wolfe R (2021).
&ldquo;MODIS/Terra Surface Reflectance Daily L2G Global 1km and 500m SIN Grid V061.&rdquo;
<a href="https://doi.org/10.5067/MODIS/MOD09GA.061">doi:10.5067/MODIS/MOD09GA.061</a>, <a href="https://lpdaac.usgs.gov/products/mod09gav061/">https://lpdaac.usgs.gov/products/mod09gav061/</a>.
</p>
<p>Wan Z, Hook S, Hulley G (2021).
&ldquo;MODIS/Terra Land Surface Temperature/Emissivity Daily L3 Global 1km SIN Grid V061.&rdquo;
<a href="https://doi.org/10.5067/MODIS/MOD11A1.061">doi:10.5067/MODIS/MOD11A1.061</a>, <a href="https://lpdaac.usgs.gov/products/mod11a1v061/">https://lpdaac.usgs.gov/products/mod11a1v061/</a>.
</p>
<p>Didan K (2021).
&ldquo;MODIS/Terra Vegetation Indices 16-Day L3 Global 1km SIN Grid V061.&rdquo;
<a href="https://doi.org/10.5067/MODIS/MOD13A2.061">doi:10.5067/MODIS/MOD13A2.061</a>, <a href="https://lpdaac.usgs.gov/products/mod13a2v061/">https://lpdaac.usgs.gov/products/mod13a2v061/</a>.
</p>
<p>Román MO, Wang Z, Sun Q, Kalb V, Miller SD, Molthan A, Schultz L, Bell J, Stokes EC, Pandey B, Seto KC, Hall D, Oda T, Wolfe RE, Lin G, Golpayegani N, Devadiga S, Davidson C, Sarkar S, Praderas C, Schmaltz J, Boller R, Stevens J, Ramos González OM, Padilla E, Alonso J, Detrés Y, Armstrong R, Miranda I, Conte Y, Marrero N, MacManus K, Esch T, Masuoka EJ (2018).
&ldquo;NASA's Black Marble nighttime lights product suite.&rdquo;
<em>Remote Sensing of Environment</em>, <b>210</b>, 113&ndash;143.
ISSN 00344257, <a href="https://doi.org/10.1016/j.rse.2018.03.017">doi:10.1016/j.rse.2018.03.017</a>, <a href="https://linkinghub.elsevier.com/retrieve/pii/S003442571830110X">https://linkinghub.elsevier.com/retrieve/pii/S003442571830110X</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## NOTE: Examples are wrapped in `/dontrun{}` to avoid sharing sensitive
##       NASA EarthData tokden information.
# example with MOD09GA product
download_modis(
  product = "MOD09GA",
  version = "61",
  horizontal_tiles = c(8, 8),
  vertical_tiles = c(4, 4),
  date = "2024-01-01",
  nasa_earth_data_token = "./pathtotoken/token.txt",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE
)
# example with MOD06_L2 product
download_modis(
  product = "MOD06_L2",
  version = "61",
  horizontal_tiles = c(8, 8),
  vertical_tiles = c(4, 4),
  date = "2024-01-01",
  mod06_links =
    system.file(
      "extdata", "nasa", "LAADS_query.2024-08-02T12_49.csv",
      package = "amadeus"
    ),
  nasa_earth_data_token = "./pathtotoken/token.txt",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE
)
# example with VNP46A2 product
download_modis(
  product = "VNP46A2",
  version = "61",
  horizontal_tiles = c(8, 8),
  vertical_tiles = c(4, 4),
  date = "2024-01-01",
  nasa_earth_data_token = "./pathtotoken/token.txt",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,MOD09GA
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_narr'>Download meteorological data</h2><span id='topic+download_narr'></span>

<h3>Description</h3>

<p>The <code>download_narr</code> function accesses and downloads daily meteorological data from <a href="https://psl.noaa.gov/data/gridded/data.narr.html">NOAA's North American Regional Reanalysis (NARR) model</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_narr(
  variables = NULL,
  year = c(2018, 2022),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_narr_+3A_variables">variables</code></td>
<td>
<p>character. Variable(s) name acronym. See <a href="https://ftp.cpc.ncep.noaa.gov/NARR/fixed/merged_land_AWIP32corrected.pdf">List of Variables in NARR Files</a>
for variable names and acronym codes.</p>
</td></tr>
<tr><td><code id="download_narr_+3A_year">year</code></td>
<td>
<p>character(1 or 2). length of 4. Year or start/end years for downloading data.</p>
</td></tr>
<tr><td><code id="download_narr_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory(s) to save downloaded data
files.</p>
</td></tr>
<tr><td><code id="download_narr_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_narr_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_narr_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_narr_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> netCDF (.nc) files will be stored in
<code>directory_to_save</code>.
</p>
</li></ul>



<h3>Note</h3>

<p>&quot;Pressure levels&quot; variables contain variable values at 29 atmospheric levels, ranging from 1000 hPa to 100 hPa. All pressure levels data will be downloaded for each variable.
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware, Insang Song
</p>


<h3>References</h3>

<p>Mesinger F, DiMego G, Kalnay E, Mitchell K, Shafran PC, Ebisuzaki W, Jović D, Woollen J, Rogers E, Berbery EH, Ek MB, Fan Y, Grumbine R, Higgins W, Li H, Lin Y, Manikin G, Parrish D, Shi W (2006).
&ldquo;North American Regional Reanalysis.&rdquo;
<em>Bulletin of the American Meteorological Society</em>, <b>87</b>(3), 343&ndash;360.
ISSN 0003-0007, 1520-0477, <a href="https://doi.org/10.1175/BAMS-87-3-343">doi:10.1175/BAMS-87-3-343</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_narr(
  variables = c("weasd", "omega"),
  year = 2023,
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_nei'>Download road emissions data</h2><span id='topic+download_nei'></span>

<h3>Description</h3>

<p>The <code>download_nei()</code> function accesses and downloads road emissions data from the <a href="https://www.epa.gov/air-emissions-inventories/national-emissions-inventory-nei">U.S Environmental Protection Agency's (EPA) National Emissions Inventory (NEI)</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_nei(
  epa_certificate_path = system.file("extdata/cacert_gaftp_epa.pem", package = "amadeus"),
  certificate_url =
    "http://cacerts.digicert.com/DigiCertGlobalG2TLSRSASHA2562020CA1-1.crt",
  year = c(2017L, 2020L),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  unzip = TRUE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_nei_+3A_epa_certificate_path">epa_certificate_path</code></td>
<td>
<p>character(1). Path to the certificate file
for EPA DataCommons. Default is
'extdata/cacert_gaftp_epa.pem' under the package installation path.</p>
</td></tr>
<tr><td><code id="download_nei_+3A_certificate_url">certificate_url</code></td>
<td>
<p>character(1). URL to certificate file. See notes for
details.</p>
</td></tr>
<tr><td><code id="download_nei_+3A_year">year</code></td>
<td>
<p>Available years of NEI data.
Default is <code>c(2017L, 2020L)</code>.</p>
</td></tr>
<tr><td><code id="download_nei_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data. Two
sub-directories will be created for the downloaded zip files (&quot;/zip_files&quot;)
and the unzipped data files (&quot;/data_files&quot;).</p>
</td></tr>
<tr><td><code id="download_nei_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_nei_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_nei_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_nei_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip the downloaded zip files.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="download_nei_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Zip and/or data files will be downloaded and stored in
respective sub-directories within <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Note</h3>

<p>For EPA Data Commons certificate errors, follow the steps below:
</p>

<ol>
<li><p> Click Lock icon in the address bar at https://gaftp.epa.gov
</p>
</li>
<li><p> Click Show Certificate
</p>
</li>
<li><p> Access Details
</p>
</li>
<li><p> Find URL with *.crt extension
Currently we bundle the pre-downloaded crt and its PEM (which is accepted
in wget command) file in ./inst/extdata. The instruction above is for
certificate updates in the future.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Ranadeep Daw, Insang Song
</p>


<h3>References</h3>

<p>United States Environmental Protection Agency (2024).
&ldquo;Air Emissions Inventories.&rdquo;
<a href="https://www.epa.gov/air-emissions-inventories">https://www.epa.gov/air-emissions-inventories</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_nei(
  year = c(2017L, 2020L),
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
  unzip = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_nlcd'>Download land cover data</h2><span id='topic+download_nlcd'></span>

<h3>Description</h3>

<p>The <code>download_nlcd()</code> function accesses and downloads
land cover data from the
<a href="https://www.mrlc.gov/data">Multi-Resolution Land Characteristics (MRLC) Consortium's National Land Cover Database (NLCD) products data base</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_nlcd(
  collection = "Coterminous United States",
  year = 2021,
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  unzip = TRUE,
  remove_zip = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_nlcd_+3A_collection">collection</code></td>
<td>
<p>character(1). <code>"Coterminous United States"</code> or <code>"Alaska"</code>.</p>
</td></tr>
<tr><td><code id="download_nlcd_+3A_year">year</code></td>
<td>
<p>integer(1). Available years for Coterminous United States
include <code>2001</code>, <code>2004</code>, <code>2006</code>, <code>2008</code>, <code>2011</code>, <code>2013</code>, <code>2016</code>,
<code>2019</code>, and <code>2021</code>.
Available years for Alaska include <code>2001</code>, <code>2011</code>, and <code>2016</code>.</p>
</td></tr>
<tr><td><code id="download_nlcd_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data. Two
sub-directories will be created for the downloaded zip files (&quot;/zip_files&quot;)
and the unzipped shapefiles (&quot;/data_files&quot;).</p>
</td></tr>
<tr><td><code id="download_nlcd_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_nlcd_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_nlcd_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_nlcd_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip zip files. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="download_nlcd_+3A_remove_zip">remove_zip</code></td>
<td>
<p>logical(1). Remove zip files from directory_to_download.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="download_nlcd_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Zip and/or data files will be downloaded and stored in
respective sub-directories within <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mitchell Manware, Insang Song
</p>


<h3>References</h3>

<p>Dewitz J (2023).
&ldquo;National Land Cover Database (NLCD) 2021 Products.&rdquo;
<a href="https://doi.org/10.5066/P9JZ7AO3">doi:10.5066/P9JZ7AO3</a>.<br/>
Dewitz J (2024).
&ldquo;National Land Cover Database (NLCD) 2019 Products (ver. 3.0, February 2024).&rdquo;
<a href="https://doi.org/10.5066/P9KZCM54">doi:10.5066/P9KZCM54</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_nlcd(
  collection = "Coterminous United States",
  year = 2021,
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
  unzip = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_permit'>Check data download acknowledgement</h2><span id='topic+download_permit'></span>

<h3>Description</h3>

<p>Return an error if the <code>acknowledgement = FALSE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_permit(acknowledgement)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_permit_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). Whether to
start downloading</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; returns a stop error if the acknowledgement is FALSE
</p>


<h3>Note</h3>

<p>The <code>acknowledgement</code> parameter is designed to help users avoid
accidentally initiating a very large data download that may take a very long
time to run or exceed machine capabilities.
</p>

<hr>
<h2 id='download_population'>Download population density data</h2><span id='topic+download_population'></span>

<h3>Description</h3>

<p>The <code>download_population()</code> function accesses and downloads
population density data from <a href="https://earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-gpwv4-apdens-wpp-2015-r11-4.11">NASA's UN WPP-Adjusted Population Density, v4.11</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_population(
  data_resolution = "60 minute",
  data_format = c("GeoTIFF", "ASCII", "netCDF"),
  year = "2020",
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  unzip = TRUE,
  remove_zip = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_population_+3A_data_resolution">data_resolution</code></td>
<td>
<p>character(1). Available resolutions are 30 second
(approx. 1 km), 2.5 minute (approx. 5 km), 15 minute (approx. 30 km),
30 minute (approx. 55 km), and 60 minute (approx. 110 km).</p>
</td></tr>
<tr><td><code id="download_population_+3A_data_format">data_format</code></td>
<td>
<p>character(1). Individual year data can be downloaded as
<code>"ASCII"</code> or <code>"GeoTIFF"</code>. &quot;all&quot; years is downloaded as <code>"netCDF"</code>.</p>
</td></tr>
<tr><td><code id="download_population_+3A_year">year</code></td>
<td>
<p>character(1). Available years are <code>2000</code>, <code>2005</code>, <code>2010</code>, <code>2015</code>, and
<code>2020</code>, or <code>"all"</code> for all years.</p>
</td></tr>
<tr><td><code id="download_population_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to save data. Two
sub-directories will be created for the downloaded zip files (&quot;/zip_files&quot;)
and the unzipped shapefiles (&quot;/data_files&quot;).</p>
</td></tr>
<tr><td><code id="download_population_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_population_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_population_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_population_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip zip files. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="download_population_+3A_remove_zip">remove_zip</code></td>
<td>
<p>logical(1). Remove zip files from directory_to_download.
Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="download_population_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Zip and/or data files will be downloaded and stored in
respective sub-directories within <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mitchell Manware, Insang Song
</p>


<h3>References</h3>

<p>Center For International Earth Science Information Network-CIESIN-Columbia University (2017).
&ldquo;Gridded Population of the World, Version 4 (GPWv4): Population Density, Revision 11.&rdquo;
<a href="https://doi.org/10.7927/H49C6VHW">doi:10.7927/H49C6VHW</a>, <a href="https://earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-gpwv4-popdens-r11-4.11">https://earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-gpwv4-popdens-r11-4.11</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_population(
  data_resolution = "30 second",
  data_format = "GeoTIFF",
  year = "2020",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE,
  unzip = FALSE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_prism'>Download PRISM data</h2><span id='topic+download_prism'></span>

<h3>Description</h3>

<p>Accesses and downloads Oregon State University's
PRISM data from the PRISM Climate Group Web Service
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_prism(
  time,
  element = c("ppt", "tmin", "tmax", "tmean", "tdmean", "vpdmin", "vpdmax", "solslope",
    "soltotal", "solclear", "soltrans"),
  data_type = c("ts", "normals_800", "normals"),
  format = c("nc", "asc", "grib2"),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_prism_+3A_time">time</code></td>
<td>
<p>character(1). Length of 2, 4, 6, or 8. Time period for
time series or normals. According to the PRISM Web Service Guide,
acceptable formats include (disclaimer: the following is a direct quote;
minimal formatting is applied):
<strong>Time Series</strong>:
</p>

<ul>
<li> <p><code>YYYYMMDD</code> for daily data (between yesterday and January 1st, 1981) – returns a single grid in a .zip file
</p>
</li>
<li> <p><code>YYYYMM</code> for monthly data (between last month and January 1981) – returns a single grid in a .zip file
</p>
</li>
<li> <p><code>YYYY</code> for annual data (between last year and 1981) - returns a single grid in a .zip file
</p>
</li>
<li> <p><code>YYYY</code> for historical data (between 1980 and 1895) - returns a single zip file containing 12 monthly grids for <code>YYYY</code> plus the annual.
</p>
</li></ul>

<p><strong>Normals</strong>:
</p>

<ul>
<li><p> Monthly normal: date is <code>MM</code> (i.e., 04 for April) or the value 14, which returns the annual normal
</p>
</li>
<li><p> Daily normal: date is <code>MMDD</code> (i.e., 0430 for April 30)
</p>
</li></ul>
</td></tr>
<tr><td><code id="download_prism_+3A_element">element</code></td>
<td>
<p>character(1). Data element.
One of <code>c("ppt", "tmin", "tmax", "tmean", "tdmean", "vpdmin", "vpdmax")</code>
For normals, <code>c("solslope", "soltotal", "solclear", "soltrans")</code> are also accepted.</p>
</td></tr>
<tr><td><code id="download_prism_+3A_data_type">data_type</code></td>
<td>
<p>character(1). Data type.
</p>

<ul>
<li> <p><code>"ts"</code>: 4km resolution time series.
</p>
</li>
<li> <p><code>"normals_800"</code>: 800m resolution normals.
</p>
</li>
<li> <p><code>"normals"</code>: 4km resolution normals.
</p>
</li></ul>
</td></tr>
<tr><td><code id="download_prism_+3A_format">format</code></td>
<td>
<p>character(1). Data format. Only applicable for <code>data_type = "ts"</code>.</p>
</td></tr>
<tr><td><code id="download_prism_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to download files.</p>
</td></tr>
<tr><td><code id="download_prism_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_prism_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_prism_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_prism_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> .bil (normals) or single grid files depending on the format
choice will be stored in <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>References</h3>

<p>Daly C, Taylor GH, Gibson WP, Parzybok TW, Johnson GL, Pasteris PA (2000).
&ldquo;HIGH-QUALITY SPATIAL CLIMATE DATA SETS FOR THE UNITED STATES AND BEYOND.&rdquo;
<em>Transactions of the ASAE</em>, <b>43</b>(6), 1957&ndash;1962.
ISSN 2151-0059, <a href="https://doi.org/10.13031/2013.3101">doi:10.13031/2013.3101</a>, <a href="http://elibrary.asabe.org/abstract.asp??JID=3&amp;AID=3101&amp;CID=t2000&amp;v=43&amp;i=6&amp;T=1">http://elibrary.asabe.org/abstract.asp??JID=3&amp;AID=3101&amp;CID=t2000&amp;v=43&amp;i=6&amp;T=1</a>.
</p>

<ul>
<li> <p><a href="https://prism.oregonstate.edu/">PRISM Climate Group</a>
</p>
</li>
<li> <p><a href="https://prism.oregonstate.edu/documents/PRISM_downloads_web_service.pdf">PRISM Web Service Guide</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_prism(
  time = "202104",
  element = "ppt",
  data_type = "ts",
  format = "nc",
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_remove_command'>Remove download commands</h2><span id='topic+download_remove_command'></span>

<h3>Description</h3>

<p>Remove or retain the .txt file storing all download commands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_remove_command(commands_txt = NULL, remove = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_remove_command_+3A_commands_txt">commands_txt</code></td>
<td>
<p>character(1). Path of download commands</p>
</td></tr>
<tr><td><code id="download_remove_command_+3A_remove">remove</code></td>
<td>
<p>logical(1). Remove (<code>TRUE</code>) or
keep (<code>FALSE</code>) commands</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; removes .txt/.bat file storing all download commands.
</p>

<hr>
<h2 id='download_remove_zips'>Remove zip files</h2><span id='topic+download_remove_zips'></span>

<h3>Description</h3>

<p>Remove downloaded &quot;.zip&quot; files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_remove_zips(remove = FALSE, download_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_remove_zips_+3A_remove">remove</code></td>
<td>
<p>logical(1). Confirm removal. Default is FALSE.</p>
</td></tr>
<tr><td><code id="download_remove_zips_+3A_download_name">download_name</code></td>
<td>
<p>character. Full zip file path</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; removes downloaded zip files after they are unzipped
</p>


<h3>Note</h3>

<p>!!! USE THE FUNCTION WITH CAUTION !!!
If <code>remove = TRUE</code>, ensure that <code>unzip = TRUE</code>. Choosing to remove
&quot;.zip&quot; files without unzipping will retain none of the downloaded data.
then it will remove all files in the second higher level directory.
</p>

<hr>
<h2 id='download_run'>Run download commands</h2><span id='topic+download_run'></span>

<h3>Description</h3>

<p>Execute or skip the commands listed in the ...wget/curl_commands.txt file
produced by one of the data download functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_run(download = FALSE, commands_txt = NULL, remove = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_run_+3A_download">download</code></td>
<td>
<p>logical(1). Execute (<code>TRUE</code>) or
skip (<code>FALSE</code>) download.</p>
</td></tr>
<tr><td><code id="download_run_+3A_commands_txt">commands_txt</code></td>
<td>
<p>character(1). Path of download commands</p>
</td></tr>
<tr><td><code id="download_run_+3A_remove">remove</code></td>
<td>
<p>logical(1). Remove (<code>TRUE</code>) or
keep (<code>FALSE</code>) command. Passed to <code>download_remove_commands</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; runs download commands with shell (Unix/Linux) or
command prompt (Windows) and removes <code>commands_txt</code> file if
<code>remove = TRUE</code>.
</p>

<hr>
<h2 id='download_sanitize_path'>Sanitize directory</h2><span id='topic+download_sanitize_path'></span>

<h3>Description</h3>

<p>Append forward slash to end of <code>directory</code> if it does not already
end with one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_sanitize_path(directory)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_sanitize_path_+3A_directory">directory</code></td>
<td>
<p>character(1). Path</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character ending with a forward slash.
</p>

<hr>
<h2 id='download_setup_dir'>Setup directory</h2><span id='topic+download_setup_dir'></span>

<h3>Description</h3>

<p>Create <code>directory</code> if it does not already exist.
</p>
<p>If directory does not exist, the directory
will be created.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_setup_dir(directory, zip = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_setup_dir_+3A_directory">directory</code></td>
<td>
<p>character(1) directory path</p>
</td></tr>
<tr><td><code id="download_setup_dir_+3A_zip">zip</code></td>
<td>
<p>logical(1). Should sub-directories be created for zip files and
data files? If <code>TRUE</code>, a vector of sub-directoy names will be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; if <code>zip = TRUE</code> a vector of directories for zip files and
data files
</p>

<hr>
<h2 id='download_sink'>Sink download commands</h2><span id='topic+download_sink'></span>

<h3>Description</h3>

<p>Open connection to <code>command_txt</code> file to store download commands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_sink(command_txt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_sink_+3A_command_txt">command_txt</code></td>
<td>
<p>character(1). file path to export commands.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; creates and opens connection to text file to store
download commands
</p>

<hr>
<h2 id='download_terraclimate'>Download TerraClimate data</h2><span id='topic+download_terraclimate'></span>

<h3>Description</h3>

<p>The <code>download_terraclimate</code> function accesses and downloads climate and water balance data from the <a href="https://www.climatologylab.org/terraclimate.html">University of California Merced Climatology Lab's TerraClimate dataset</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_terraclimate(
  variables = NULL,
  year = c(2018, 2022),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_terraclimate_+3A_variables">variables</code></td>
<td>
<p>character(1). Variable(s) name(s). See <a href="https://climate.northwestknowledge.net/TERRACLIMATE/index_directDownloads.php">TerraClimate Direct Downloads</a>
for variable names and acronym codes.</p>
</td></tr>
<tr><td><code id="download_terraclimate_+3A_year">year</code></td>
<td>
<p>character(1 or 2). length of 4. Year or start/end years for downloading data.</p>
</td></tr>
<tr><td><code id="download_terraclimate_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory(s) to save downloaded data
files.</p>
</td></tr>
<tr><td><code id="download_terraclimate_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_terraclimate_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_terraclimate_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1).
Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_terraclimate_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> netCDF (.nc) files will be stored in a variable-specific
folder within <code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mitchell Manware, Insang Song
</p>


<h3>References</h3>

<p>Abatzoglou JT, Dobrowski SZ, Parks SA, Hegewisch KC (2018).
&ldquo;TerraClimate, a high-resolution global dataset of monthly climate and climatic water balance from 1958&ndash;2015.&rdquo;
<em>Scientific data</em>, <b>5</b>(1), 1&ndash;12.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_terraclimate(
  variables = "Precipitation",
  year = 2023,
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_tri'>Download toxic release data</h2><span id='topic+download_tri'></span>

<h3>Description</h3>

<p>The <code>download_tri()</code> function accesses and downloads toxic release data from the <a href="https://www.epa.gov/toxics-release-inventory-tri-program/tri-data-action-0">U.S. Environmental Protection Agency's (EPA) Toxic Release Inventory (TRI) Program</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_tri(
  year = c(2018L, 2022L),
  directory_to_save = NULL,
  acknowledgement = FALSE,
  download = FALSE,
  remove_command = FALSE,
  hash = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_tri_+3A_year">year</code></td>
<td>
<p>character(1 or 2). length of 4. Year or start/end years for downloading data.</p>
</td></tr>
<tr><td><code id="download_tri_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>character(1). Directory to download files.</p>
</td></tr>
<tr><td><code id="download_tri_+3A_acknowledgement">acknowledgement</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the
user acknowledges that the data downloaded using this function may be very
large and use lots of machine storage and memory.</p>
</td></tr>
<tr><td><code id="download_tri_+3A_download">download</code></td>
<td>
<p>logical(1). <code>FALSE</code> will generate a *.txt file
containing all download commands. By setting <code>TRUE</code> the function
will download all of the requested data files.</p>
</td></tr>
<tr><td><code id="download_tri_+3A_remove_command">remove_command</code></td>
<td>
<p>logical(1). Remove (<code>TRUE</code>) or keep (<code>FALSE</code>)
the text file containing download commands.</p>
</td></tr>
<tr><td><code id="download_tri_+3A_hash">hash</code></td>
<td>
<p>logical(1). By setting <code>TRUE</code> the function will return
an <code>rlang::hash_file()</code> hash character corresponding to the
downloaded files. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> For <code>hash = FALSE</code>, NULL
</p>
</li>
<li><p> For <code>hash = TRUE</code>, an <code>rlang::hash_file</code> character.
</p>
</li>
<li><p> Comma-separated value (CSV) files will be stored in
<code>directory_to_save</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Mariana Kassien, Insang Song
</p>


<h3>References</h3>

<p>United States Environmental Protection Agency (2024).
&ldquo;TRI Basic Data Files: Calendar Years 1987 &ndash; Present.&rdquo;
<a href="https://www.epa.gov/toxics-release-inventory-tri-program/tri-data-action-0">https://www.epa.gov/toxics-release-inventory-tri-program/tri-data-action-0</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
download_tri(
  year = 2021L,
  directory_to_save = tempdir(),
  acknowledgement = TRUE,
  download = FALSE, # NOTE: download skipped for examples,
  remove_command = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='download_unzip'>Unzip zip files</h2><span id='topic+download_unzip'></span>

<h3>Description</h3>

<p>Unzip (inflate) downloaded &quot;.zip&quot; files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_unzip(file_name, directory_to_unzip, unzip = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_unzip_+3A_file_name">file_name</code></td>
<td>
<p>character(1). Full zip file path</p>
</td></tr>
<tr><td><code id="download_unzip_+3A_directory_to_unzip">directory_to_unzip</code></td>
<td>
<p>character(1). Directory to unzip
data</p>
</td></tr>
<tr><td><code id="download_unzip_+3A_unzip">unzip</code></td>
<td>
<p>logical(1). Unzip (<code>TRUE</code>) or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; unzips downloaded zip files
</p>

<hr>
<h2 id='dt_as_mysftime'>Convert a <code>data.table</code> to an <code>sftime</code></h2><span id='topic+dt_as_mysftime'></span>

<h3>Description</h3>

<p>Convert a <code>data.table</code> object to an <code>sftime</code>. <code>x</code> must be
a <code>data.table</code> object with &quot;lon&quot;, &quot;lat&quot;, and &quot;time&quot; columns to
describe the longitude, latitude, and time-orientation, respectively, of
<code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dt_as_mysftime(x, lonname, latname, timename, crs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dt_as_mysftime_+3A_x">x</code></td>
<td>
<p>a <code>data.table</code></p>
</td></tr>
<tr><td><code id="dt_as_mysftime_+3A_lonname">lonname</code></td>
<td>
<p>character for longitude column name</p>
</td></tr>
<tr><td><code id="dt_as_mysftime_+3A_latname">latname</code></td>
<td>
<p>character for latitude column name</p>
</td></tr>
<tr><td><code id="dt_as_mysftime_+3A_timename">timename</code></td>
<td>
<p>character for time column name</p>
</td></tr>
<tr><td><code id="dt_as_mysftime_+3A_crs">crs</code></td>
<td>
<p>coordinate reference system</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>sftime</code> object
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>

<hr>
<h2 id='extract_urls'>Extract download URLs</h2><span id='topic+extract_urls'></span>

<h3>Description</h3>

<p>Extract download URLs from multi-argument download commands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_urls(commands = commands, position = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_urls_+3A_commands">commands</code></td>
<td>
<p>character vector containing download commands</p>
</td></tr>
<tr><td><code id="extract_urls_+3A_position">position</code></td>
<td>
<p>URL position in the vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector containing download URLs
</p>

<hr>
<h2 id='generate_date_sequence'>Generate date sequence</h2><span id='topic+generate_date_sequence'></span>

<h3>Description</h3>

<p>Generate a sequence of dates from <code>date_start</code> to <code>date_end</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_date_sequence(date_start, date_end, sub_hyphen = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_date_sequence_+3A_date_start">date_start</code></td>
<td>
<p>character(1). Beginning of date sequence.</p>
</td></tr>
<tr><td><code id="generate_date_sequence_+3A_date_end">date_end</code></td>
<td>
<p>character(1). End of date sequence.</p>
</td></tr>
<tr><td><code id="generate_date_sequence_+3A_sub_hyphen">sub_hyphen</code></td>
<td>
<p>logical(1). Substitute hyphen in dates. If <code>TRUE</code>, returns
date sequence as &quot;YYYYMMDD&quot;. If <code>FALSE</code>, returns date sequence as
&quot;YYYY-MM-DD&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector
</p>

<hr>
<h2 id='generate_time_sequence'>Generate time sequence</h2><span id='topic+generate_time_sequence'></span>

<h3>Description</h3>

<p>Generate a sequence of time values based on the GEOS-CF collection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_time_sequence(collection)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_time_sequence_+3A_collection">collection</code></td>
<td>
<p>character(1). GEOS-CF data collection</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector
</p>


<h3>Note</h3>

<p>GEOS-CF hourly values are observed on the hour (ie. 0000 = 12:00:00 AM, 0100
= 01:00:00 AM) or the half hour (ie. 0030 = 12:30:00 AM, 0130 = 01:30:00 AM).
Typically, 2-dimensional collections (latitude and longitude only) utilize
half hour, and 3-dimensional collections (latitude, longitude, and time)
utilize hour.
</p>

<hr>
<h2 id='is_date_proper'>Check date format</h2><span id='topic+is_date_proper'></span>

<h3>Description</h3>

<p>Check date input strings conform to the required format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_date_proper(instr = NULL, format = "%Y-%m-%d")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_date_proper_+3A_instr">instr</code></td>
<td>
<p>character(1). String to check.</p>
</td></tr>
<tr><td><code id="is_date_proper_+3A_format">format</code></td>
<td>
<p>character(1). Matching format to be checked.
Default is <code>"%Y-%m-%d"</code>, which can detect <code style="white-space: pre;">&#8288;"%Y/%m/%d&#8288;</code>.
See <code><a href="base.html#topic+strftime">strftime</a></code> for details of formatting this string.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No returning value. It stops the function if <code>instr</code> doesn't
conform to the <code>format</code>.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>

<hr>
<h2 id='narr_variable'>Sort NOAA NARR variables</h2><span id='topic+narr_variable'></span>

<h3>Description</h3>

<p>Determine whether a NOAA NARR variable selected for download is a
monolevel or pressure level variable. Monolevel variables are derived
from https://downloads.psl.noaa.gov/Datasets/NARR/Dailies/monolevel/,
and pressure level variables are derived from
https://downloads.psl.noaa.gov//Datasets/NARR/Dailies/pressure/.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>narr_variable(variable)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="narr_variable_+3A_variable">variable</code></td>
<td>
<p>character(1). User-selected NARR variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with URL base and vector of months (blank for monolevel)
</p>

<hr>
<h2 id='process_aqs'>Process U.S. EPA AQS daily CSV data</h2><span id='topic+process_aqs'></span>

<h3>Description</h3>

<p>The <code>process_aqs()</code> function cleans and imports raw air quality
monitoring sites from pre-generated daily CSV files, returning a single
<code>SpatVector</code> or <code>sf</code> object.
<code>date</code> is used to filter the raw data read from csv files.
Filtered rows are then processed according to <code>mode</code> argument.
Some sites report multiple measurements per day with and without
<a href="https://www.epa.gov/sites/default/files/2016-10/documents/exceptional_events.pdf">exceptional events</a>
the internal procedure of this function keeps &quot;Included&quot; if there
are multiple event types per site-time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_aqs(
  path = NULL,
  date = c("2018-01-01", "2022-12-31"),
  mode = c("date-location", "available-data", "location"),
  data_field = "Arithmetic.Mean",
  return_format = c("terra", "sf", "data.table"),
  extent = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_aqs_+3A_path">path</code></td>
<td>
<p>character(1). Directory path to daily measurement data.</p>
</td></tr>
<tr><td><code id="process_aqs_+3A_date">date</code></td>
<td>
<p>character(1 or 2). Date (1) or start and end dates (2).
Should be in <code>"YYYY-MM-DD"</code> format and sorted.</p>
</td></tr>
<tr><td><code id="process_aqs_+3A_mode">mode</code></td>
<td>
<p>character(1). One of
</p>

<ul>
<li><p> &quot;date-location&quot; (all dates * all locations)
</p>
</li>
<li><p> &quot;available-data&quot; (date-location pairs with available data)
</p>
</li>
<li><p> &quot;location&quot; (unique locations).
</p>
</li></ul>
</td></tr>
<tr><td><code id="process_aqs_+3A_data_field">data_field</code></td>
<td>
<p>character(1). Data field to extract.</p>
</td></tr>
<tr><td><code id="process_aqs_+3A_return_format">return_format</code></td>
<td>
<p>character(1). <code>"terra"</code> or <code>"sf"</code> or <code>"data.table"</code>.</p>
</td></tr>
<tr><td><code id="process_aqs_+3A_extent">extent</code></td>
<td>
<p>numeric(4). Spatial extent of the resulting object.
The order should be <code>c(xmin, xmax, ymin, ymax)</code>.
The coordinate system should be WGS84 (EPSG:4326).</p>
</td></tr>
<tr><td><code id="process_aqs_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a SpatVector, sf, or data.table object depending on the <code>return_format</code>
</p>


<h3>Note</h3>

<p>Choose <code>date</code> and <code>mode</code> values with caution.
The function may return a massive data.table depending on the time range,
resulting in a long processing time or even a crash if data is too large
for your computing environment to process.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+download_aqs">download_aqs()</a></code>
</p>
</li>
<li> <p><a href="https://aqs.epa.gov/aqsweb/documents/codetables/parameters.csv">EPA, n.d., <em>AQS Parameter Codes</em></a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
aqs &lt;- process_aqs(
  path = "./data/aqs_daily_example.csv",
  date = c("2022-12-01", "2023-01-31"),
  mode = "full",
  return_format = "terra"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_blackmarble'>Assign VIIRS Black Marble products corner coordinates to retrieve a merged raster</h2><span id='topic+process_blackmarble'></span>

<h3>Description</h3>

<p>This function will return a <code>SpatRaster</code> object with
georeferenced h5 files of Black Marble product. Referencing corner coordinates
are necessary as the original h5 data do not include such information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_blackmarble(
  path = NULL,
  date = NULL,
  tile_df = process_blackmarble_corners(),
  subdataset = 3L,
  crs = "EPSG:4326",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_blackmarble_+3A_path">path</code></td>
<td>
<p>character. Full paths of h5 files.</p>
</td></tr>
<tr><td><code id="process_blackmarble_+3A_date">date</code></td>
<td>
<p>character(1). Date to query.</p>
</td></tr>
<tr><td><code id="process_blackmarble_+3A_tile_df">tile_df</code></td>
<td>
<p>data.frame. Contains four corner coordinates in fields named
<code>c("xmin", "xmax", "ymin", "ymax")</code>.
See <code><a href="#topic+process_blackmarble_corners">process_blackmarble_corners</a></code> to generate a valid object for this argument.</p>
</td></tr>
<tr><td><code id="process_blackmarble_+3A_subdataset">subdataset</code></td>
<td>
<p>integer(1). Subdataset number to process.
Default is 3L.</p>
</td></tr>
<tr><td><code id="process_blackmarble_+3A_crs">crs</code></td>
<td>
<p>character(1). terra::crs compatible CRS.
Default is <code>"EPSG:4326"</code></p>
</td></tr>
<tr><td><code id="process_blackmarble_+3A_...">...</code></td>
<td>
<p>For internal use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>References</h3>


<ul>
<li> <p><a href="https://ladsweb.modaps.eosdis.nasa.gov/api/v2/content/archives/Document%20Archive/Science%20Data%20Product%20Documentation/VIIRS_Black_Marble_UG_v1.3_Sep_2022.pdf">Wang, Z. (2022). Black Marble User Guide (Version 1.3). NASA.</a>
</p>
</li></ul>



<h3>See Also</h3>


<ul>
<li> <p><code><a href="terra.html#topic+describe">terra::describe</a></code>
</p>
</li>
<li> <p><code><a href="terra.html#topic+merge">terra::merge</a></code>
</p>
</li>
<li> <p><code><a href="#topic+process_blackmarble_corners">process_blackmarble_corners</a></code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
vnp46a2 &lt;- process_blackmarble(
  path =
    list.files("./data", pattern = "VNP46A2.", full.names = TRUE),
  date = "2024-01-01",
  tile_df =
    process_blackmarble_corners(hrange = c(8, 10), vrange = c(4, 5)),
  subdataset = 3L,
  crs = "EPSG:4326"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_blackmarble_corners'>Process Black Marble corners</h2><span id='topic+process_blackmarble_corners'></span>

<h3>Description</h3>

<p>Tile corner generator for Black Marble products.
</p>
<p>Black Marble products are in HDF5 format and are read without
georeference with typical R geospatial packages.
This function generates a <code>data.frame</code> of corner coordinates for assignment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_blackmarble_corners(hrange = c(5, 11), vrange = c(3, 6))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_blackmarble_corners_+3A_hrange">hrange</code></td>
<td>
<p>integer(2). Both should be in 0-35.</p>
</td></tr>
<tr><td><code id="process_blackmarble_corners_+3A_vrange">vrange</code></td>
<td>
<p>integer(2). Both should be in 0-17.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>data.frame</code> with xmin, xmax, ymin, and ymax fields
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>References</h3>


<ul>
<li> <p><a href="https://ladsweb.modaps.eosdis.nasa.gov/api/v2/content/archives/Document%20Archive/Science%20Data%20Product%20Documentation/VIIRS_Black_Marble_UG_v1.3_Sep_2022.pdf">Wang, Z. (2022). Black Marble User Guide (Version 1.3). NASA.</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>process_blackmarble_corners(hrange = c(1, 2), vrange = c(1, 2))
</code></pre>

<hr>
<h2 id='process_collection'>Process GEOS-CF and MERRA2 collection codes</h2><span id='topic+process_collection'></span>

<h3>Description</h3>

<p>Identify the GEOS-CF or MERRA2 collection based on the file path.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_collection(
  path,
  source,
  collection = FALSE,
  date = FALSE,
  datetime = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_collection_+3A_path">path</code></td>
<td>
<p>character(1). File path to data file.</p>
</td></tr>
<tr><td><code id="process_collection_+3A_source">source</code></td>
<td>
<p>character(1). &quot;geos&quot; for GEOS-CF or &quot;merra2&quot; for MERRA2</p>
</td></tr>
<tr><td><code id="process_collection_+3A_collection">collection</code></td>
<td>
<p>logical(1). Identifies and returns collection
name(s) based on provided file path(s).</p>
</td></tr>
<tr><td><code id="process_collection_+3A_date">date</code></td>
<td>
<p>logical(1). Identifies and returns date sequence (YYYYMMDD) based
on provided file path(s).</p>
</td></tr>
<tr><td><code id="process_collection_+3A_datetime">datetime</code></td>
<td>
<p>logical(1). Identifies and returns date time sequence
(YYYYMoMoDDHHMiMi) based on provided file path(s).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='process_conformity'>Check input assumptions</h2><span id='topic+process_conformity'></span>

<h3>Description</h3>

<p>Check if all of <code>"lon"</code>, <code>"lat"</code>, and <code>"time"</code>
(only if <code>check_time = TRUE</code>) then convert inputs into a
<code>SpatVector</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_conformity(locs = NULL, check_time = FALSE, locs_epsg = "EPSG:4326")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_conformity_+3A_locs">locs</code></td>
<td>
<p>Data. <a href="sf.html#topic+st_as_sf">sf</a>,
<a href="terra.html#topic+vect">SpatVector</a>, or <a href="base.html#topic+data.frame">data.frame</a></p>
</td></tr>
<tr><td><code id="process_conformity_+3A_check_time">check_time</code></td>
<td>
<p>logical(1). Whether <code>"time"</code> exists in column names.</p>
</td></tr>
<tr><td><code id="process_conformity_+3A_locs_epsg">locs_epsg</code></td>
<td>
<p>character(1). <code>"{authority}:{code}"</code> or
Well-Known Text format for coordinate reference system definition.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatVector</code> object
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>

<hr>
<h2 id='process_covariates'>Process raw data wrapper function</h2><span id='topic+process_covariates'></span>

<h3>Description</h3>

<p>This function processes raw data files which have
been downloaded by <code><a href="#topic+download_data">download_data</a></code>. <code>process_covariates</code> and
the underlying source-specific processing functions have been designed to
operate on the raw data files. To avoid errors, <strong>do not edit the raw
data files before passing to <code>process_covariates</code></strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_covariates(
  covariate = c("modis_swath", "modis_merge", "koppen-geiger", "blackmarble",
    "koeppen-geiger", "koppen", "koeppen", "geos", "dummies", "gmted", "hms", "smoke",
    "sedac_population", "population", "sedac_groads", "groads", "roads", "nlcd", "tri",
    "narr", "nei", "ecoregions", "ecoregion", "merra", "merra2", "gridmet",
    "terraclimate", "huc", "cropscape", "cdl", "prism"),
  path = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_covariates_+3A_covariate">covariate</code></td>
<td>
<p>character(1). Covariate type.</p>
</td></tr>
<tr><td><code id="process_covariates_+3A_path">path</code></td>
<td>
<p>character(1). Directory or file path to raw data
depending on <code>covariate</code> value.</p>
</td></tr>
<tr><td><code id="process_covariates_+3A_...">...</code></td>
<td>
<p>Arguments passed to each raw data processing function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>SpatVector</code>, <code>SpatRaster</code>, <code>sf</code>, or <code>character</code> depending on
covariate type and selections.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+process_modis_swath">process_modis_swath</a></code>: &quot;modis_swath&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_modis_merge">process_modis_merge</a></code>: &quot;modis_merge&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_blackmarble">process_blackmarble</a></code>: &quot;blackmarble&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_koppen_geiger">process_koppen_geiger</a></code>: &quot;koppen-geiger&quot;, &quot;koeppen-geiger&quot;, &quot;koppen&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_ecoregion">process_ecoregion</a></code>: &quot;ecoregion&quot;, &quot;ecoregions&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_nlcd">process_nlcd</a></code>: &quot;nlcd&quot;, &quot;NLCD&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_tri">process_tri</a></code>: &quot;tri&quot;, &quot;TRI&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_nei">process_nei</a></code>: &quot;nei&quot;, &quot;NEI&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_geos">process_geos</a></code>: &quot;geos&quot;, &quot;GEOS&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_gmted">process_gmted</a></code>: &quot;gmted&quot;, &quot;GMTED&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_aqs">process_aqs</a></code>: &quot;aqs&quot;, &quot;AQS&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_hms">process_hms</a></code>: &quot;hms&quot;, &quot;smoke&quot;, &quot;HMS&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_narr">process_narr</a></code>: &quot;narr&quot;, &quot;NARR&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_groads">process_groads</a></code>: &quot;sedac_groads&quot;, &quot;roads&quot;, &quot;groads&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_population">process_population</a></code>: &quot;sedac_population&quot;, &quot;population&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_merra2">process_merra2</a></code>: &quot;merra&quot;, &quot;merra2&quot;, &quot;MERRA2&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_gridmet">process_gridmet</a></code>: &quot;gridmet&quot;, &quot;gridMET&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_terraclimate">process_terraclimate</a></code>: &quot;terraclimate&quot;, &quot;TerraClimate&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_huc">process_huc</a></code>: &quot;huc&quot;, &quot;HUC&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_cropscape">process_cropscape</a></code>: &quot;cropscape&quot;, &quot;cdl&quot;
</p>
</li>
<li> <p><code><a href="#topic+process_prism">process_prism</a></code>: &quot;prism&quot;, &quot;PRISM&quot;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
process_covariates(
  covariate = "narr",
  date = c("2018-01-01", "2018-01-10"),
  variable = "weasd",
  path = system.file("extdata", "examples", "narr", "weasd")
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_cropscape'>Process CropScape data</h2><span id='topic+process_cropscape'></span>

<h3>Description</h3>

<p>This function imports and cleans raw CropScape data,
returning a single <code>SpatRaster</code> object.
</p>
<p>Reads CropScape file of selected <code>year</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_cropscape(path = NULL, year = 2021, extent = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_cropscape_+3A_path">path</code></td>
<td>
<p>character giving CropScape data path</p>
</td></tr>
<tr><td><code id="process_cropscape_+3A_year">year</code></td>
<td>
<p>numeric giving the year of CropScape data used</p>
</td></tr>
<tr><td><code id="process_cropscape_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_cropscape_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
cropscape &lt;- process_cropscape(
  path = "./data/cropscape_example.tif",
  year = 2020
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_ecoregion'>Process ecoregion data</h2><span id='topic+process_ecoregion'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+process_ecoregion">process_ecoregion</a></code> function imports and cleans raw ecoregion
data, returning a <code>SpatVector</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_ecoregion(path = NULL, extent = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_ecoregion_+3A_path">path</code></td>
<td>
<p>character(1). Path to Ecoregion Shapefiles</p>
</td></tr>
<tr><td><code id="process_ecoregion_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_ecoregion_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatVector</code> object
</p>


<h3>Note</h3>

<p>The function will fix Tukey's bridge in Portland, ME.
This fix will ensure that the EPA air quality monitoring sites
will be located within the ecoregion.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
ecoregion &lt;- process_ecoregion(
  path = "./data/epa_ecoregion.gpkg"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_flatten_sds'>Process MODIS layers</h2><span id='topic+process_flatten_sds'></span>

<h3>Description</h3>

<p>Aggregate layers in a sub-dataset in sinusoidal MODIS products.
</p>
<p>Some MODIS products consist of multi-layer subdatasets.
This function aggregates multiple layers into single layer <code>SpatRaster.</code>
<code>fun_agg</code> is applied at overlapping cells.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_flatten_sds(path = NULL, subdataset = NULL, fun_agg = "mean", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_flatten_sds_+3A_path">path</code></td>
<td>
<p>character(1). Full path to MODIS HDF4/HDF5 file.
Direct sub-dataset access is supported, for example,
HDF4_EOS:EOS_GRID:{filename}:{base_grid_information}:{sub-dataset}</p>
</td></tr>
<tr><td><code id="process_flatten_sds_+3A_subdataset">subdataset</code></td>
<td>
<p>character(1). Exact or regular expression filter of
sub-dataset. See <a href="#topic+process_modis_sds">process_modis_sds</a> for details.</p>
</td></tr>
<tr><td><code id="process_flatten_sds_+3A_fun_agg">fun_agg</code></td>
<td>
<p>character(1). Function name to aggregate layers.
Should be acceptable to <a href="terra.html#topic+tapp">terra::tapp</a>.</p>
</td></tr>
<tr><td><code id="process_flatten_sds_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Note</h3>

<p>HDF values are read as original without scaling.
Users should consult MODIS product documentation to apply proper
scaling factor for post-hoc adjustment. If users have no preliminary
information about MODIS sub-datasets, consider running
<code style="white-space: pre;">&#8288;terra::describe(__filename__, sds = TRUE)&#8288;</code> to navigate the full
list of sub-datasets in the input file then consult the documentation
of MODIS product.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>

<p><a href="terra.html#topic+tapp">terra::tapp</a>, <a href="terra.html#topic+rast">terra::rast</a>, <a href="terra.html#topic+describe">terra::describe</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
mod09ga_flatten &lt;- process_flatten_sds(
  path =
    list.files("./data", pattern = "MOD09GA.", full.names = TRUE)[1],
  subdataset = process_modis_sds("MOD09GA"),
  fun_agg = "mean"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_geos'>Process atmospheric composition data</h2><span id='topic+process_geos'></span>

<h3>Description</h3>

<p>The <code>process_geos()</code> function imports and cleans raw atmospheric
composition data, returning a single <code>SpatRaster</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_geos(
  date = c("2018-01-01", "2018-01-10"),
  variable = NULL,
  path = NULL,
  extent = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_geos_+3A_date">date</code></td>
<td>
<p>character(1 or 2). Date (1) or start and end dates (2).
Format YYYY-MM-DD (ex. September 1, 2023 = &quot;2023-09-01&quot;).</p>
</td></tr>
<tr><td><code id="process_geos_+3A_variable">variable</code></td>
<td>
<p>character(1). GEOS-CF variable name(s).</p>
</td></tr>
<tr><td><code id="process_geos_+3A_path">path</code></td>
<td>
<p>character(1). Directory with downloaded netCDF (.nc4) files.</p>
</td></tr>
<tr><td><code id="process_geos_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_geos_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object;
</p>


<h3>Note</h3>

<p>Layer names of the returned <code>SpatRaster</code> object contain the variable,
pressure level, date, and hour.
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
geos &lt;- process_geos(
  date = c("2024-01-01", "2024-01-10"),
  variable = "O3",
  path = "./data/aqc_tavg_1hr_g1440x721_v1"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_gmted'>Process elevation data</h2><span id='topic+process_gmted'></span>

<h3>Description</h3>

<p>The <code>process_gmted()</code> function imports and cleans raw elevation data,
returning a single <code>SpatRaster</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_gmted(variable = NULL, path = NULL, extent = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_gmted_+3A_variable">variable</code></td>
<td>
<p>vector(1). Vector containing the GMTED statistic first and
the resolution second. (Example: variable = c(&quot;Breakline Emphasis&quot;,
&quot;7.5 arc-seconds&quot;)).
</p>

<ul>
<li><p> Statistic options: &quot;Breakline Emphasis&quot;, &quot;Systematic Subsample&quot;,
&quot;Median Statistic&quot;, &quot;Minimum Statistic&quot;, &quot;Mean Statistic&quot;,
&quot;Maximum Statistic&quot;, &quot;Standard Deviation Statistic&quot;
</p>
</li>
<li><p> Resolution options: &quot;30 arc-seconds&quot;, &quot;15 arc-seconds&quot;, &quot;7.5 arc-seconds&quot;
</p>
</li></ul>
</td></tr>
<tr><td><code id="process_gmted_+3A_path">path</code></td>
<td>
<p>character(1). Directory with downloaded GMTED  &quot;*_grd&quot;
folder containing .adf files.</p>
</td></tr>
<tr><td><code id="process_gmted_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_gmted_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Note</h3>

<p><code>SpatRaster</code> layer name indicates selected variable and resolution, and year
of release (2010).
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
gmted &lt;- process_gmted(
  variable = c("Breakline Emphasis", "7.5 arc-seconds"),
  path = "./data/be75_grd"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_gmted_codes'>Process elevation statistic and resolution codes</h2><span id='topic+process_gmted_codes'></span>

<h3>Description</h3>

<p>Identify the GMTED statistic and resolution based on the file path. Convert
statistic and resolution to/from full string to/from statistic and
resolution code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_gmted_codes(
  string,
  statistic = FALSE,
  resolution = FALSE,
  invert = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_gmted_codes_+3A_string">string</code></td>
<td>
<p>character(1). File path to GMTED data file.</p>
</td></tr>
<tr><td><code id="process_gmted_codes_+3A_statistic">statistic</code></td>
<td>
<p>logical(1). Matches statistic to statistic code.</p>
</td></tr>
<tr><td><code id="process_gmted_codes_+3A_resolution">resolution</code></td>
<td>
<p>logical(1). Matches resolution to resolution code.</p>
</td></tr>
<tr><td><code id="process_gmted_codes_+3A_invert">invert</code></td>
<td>
<p>logical(1). Default = FALSE. <code>invert = TRUE</code> assumes <code>string</code>
provides statistic or resolution code, and returns full length statistic
or resolution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='process_gridmet'>Process gridMET data</h2><span id='topic+process_gridmet'></span>

<h3>Description</h3>

<p>The <code>process_gridmet()</code> function imports and cleans raw gridded surface meteorological
data, returning a single <code>SpatRaster</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_gridmet(
  date = c("2023-09-01", "2023-09-10"),
  variable = NULL,
  path = NULL,
  extent = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_gridmet_+3A_date">date</code></td>
<td>
<p>character(1 or 2). Date (1) or start and end dates (2).
Format YYYY-MM-DD (ex. September 1, 2023 = &quot;2023-09-01&quot;).</p>
</td></tr>
<tr><td><code id="process_gridmet_+3A_variable">variable</code></td>
<td>
<p>character(1). Variable name or acronym code. See <a href="https://www.climatologylab.org/wget-gridmet.html">gridMET Generate Wget File</a>
for variable names and acronym codes. (Note: variable &quot;Burning Index&quot; has code &quot;bi&quot; and variable
&quot;Energy Release Component&quot; has code &quot;erc&quot;).</p>
</td></tr>
<tr><td><code id="process_gridmet_+3A_path">path</code></td>
<td>
<p>character(1). Directory with downloaded netCDF (.nc) files.</p>
</td></tr>
<tr><td><code id="process_gridmet_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_gridmet_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Note</h3>

<p>Layer names of the returned <code>SpatRaster</code> object contain the variable acronym,
and date.
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
gridmet &lt;- process_gridmet(
  date = c("2023-01-01", "2023-01-10"),
  variable = "Precipitation",
  path = "./data/pr"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_gridmet_codes'>Process gridMET variable codes</h2><span id='topic+process_gridmet_codes'></span>

<h3>Description</h3>

<p>Convert gridMET variable names to/from variable codes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_gridmet_codes(string, invert = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_gridmet_codes_+3A_string">string</code></td>
<td>
<p>character(1). gridMET variable name or variable code.</p>
</td></tr>
<tr><td><code id="process_gridmet_codes_+3A_invert">invert</code></td>
<td>
<p>logical(1). Default = FALSE. <code>invert = TRUE</code> assumes <code>string</code>
provides variable code and returns full length variable name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='process_groads'>Process roads data</h2><span id='topic+process_groads'></span>

<h3>Description</h3>

<p>The <code>process_groads()</code> function imports and cleans raw road data,
returning a single <code>SpatVector</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_groads(path = NULL, extent = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_groads_+3A_path">path</code></td>
<td>
<p>character(1). Path to geodatabase or shapefiles.</p>
</td></tr>
<tr><td><code id="process_groads_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_groads_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatVector</code> object
</p>


<h3>Note</h3>

<p>U.S. context. The returned <code>SpatVector</code> object contains a
<code style="white-space: pre;">&#8288;$description&#8288;</code> column to represent the temporal range covered by the
dataset. For more information, see <a href="https://earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-groads-v1-1.00">https://earthdata.nasa.gov/data/catalog/sedac-ciesin-sedac-groads-v1-1.00</a>.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
groads &lt;- process_groads(
  path = "./data/groads_example.shp"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_hms'>Process wildfire smoke data</h2><span id='topic+process_hms'></span>

<h3>Description</h3>

<p>The <code>process_hms()</code> function imports and cleans raw wildfire smoke
plume coverage data, returning a single <code>SpatVector</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_hms(date = "2018-01-01", path = NULL, extent = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_hms_+3A_date">date</code></td>
<td>
<p>character(1 or 2). Date (1) or start and end dates (2).
Format YYYY-MM-DD (ex. September 1, 2023 = &quot;2023-09-01&quot;).</p>
</td></tr>
<tr><td><code id="process_hms_+3A_path">path</code></td>
<td>
<p>character(1). Directory with downloaded NOAA HMS data files.</p>
</td></tr>
<tr><td><code id="process_hms_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the output
if <code>NULL</code> (default), the entire data is returned</p>
</td></tr>
<tr><td><code id="process_hms_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatVector</code> or character object
</p>


<h3>Note</h3>

<p><code>process_hms()</code> will return a character object if there are no wildfire
smoke plumes present for the selected dates and density. The returned
character will contain the density value and the sequence of dates
for which no wildfire smoke plumes were detected (see &quot;Examples&quot;).
If multiple density polygons overlap, the function will return the
highest density value.
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hms &lt;- process_hms(
  date = c("2018-12-30", "2019-01-01"),
  path = "../tests/testdata/hms/"
)
</code></pre>

<hr>
<h2 id='process_huc'>Retrieve Hydrologic Unit Code (HUC) data</h2><span id='topic+process_huc'></span>

<h3>Description</h3>

<p>Retrieve Hydrologic Unit Code (HUC) data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_huc(
  path,
  layer_name = NULL,
  huc_level = NULL,
  huc_header = NULL,
  extent = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_huc_+3A_path">path</code></td>
<td>
<p>character. Path to the file or the directory containing HUC data.</p>
</td></tr>
<tr><td><code id="process_huc_+3A_layer_name">layer_name</code></td>
<td>
<p>character(1). Layer name in the <code>path</code></p>
</td></tr>
<tr><td><code id="process_huc_+3A_huc_level">huc_level</code></td>
<td>
<p>character(1). Field name of HUC level</p>
</td></tr>
<tr><td><code id="process_huc_+3A_huc_header">huc_header</code></td>
<td>
<p>character(1). The upper level HUC code header to extract
lower level HUCs.</p>
</td></tr>
<tr><td><code id="process_huc_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_huc_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>nhdplusTools::get_huc()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatVector</code> object
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>

<p><code><a href="nhdplusTools.html#topic+get_huc">nhdplusTools::get_huc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Examples are wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
library(terra)
getf &lt;- "WBD_National_GDB.gdb"
# check the layer name to read
terra::vector_layers(getf)
test1 &lt;- process_huc(
  getf,
  layer_name = "WBDHU8",
  huc_level = "huc8"
)
test2 &lt;- process_huc(
  getf,
  layer_name = "WBDHU8",
  huc_level = "huc8"
)
test3 &lt;- process_huc(
  "",
  layer_name = NULL,
  huc_level = NULL,
  huc_header = NULL,
  id = "030202",
  type = "huc06"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_koppen_geiger'>Process climate classification data</h2><span id='topic+process_koppen_geiger'></span>

<h3>Description</h3>

<p>The <code>process_koppen_geiger()</code> function imports and cleans raw climate
classification data, returning a single <code>SpatRaster</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_koppen_geiger(path = NULL, extent = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_koppen_geiger_+3A_path">path</code></td>
<td>
<p>character(1). Path to Koppen-Geiger
climate zone raster file</p>
</td></tr>
<tr><td><code id="process_koppen_geiger_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_koppen_geiger_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
kg &lt;- process_koppen_geiger(
  path = "./data/koppen_geiger_data.tif"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_locs_radius'>Process locations buffer</h2><span id='topic+process_locs_radius'></span>

<h3>Description</h3>

<p>Create circular buffer around locations based on user defined radius.
</p>
<p>Creates a circular buffer around points if <code>radius</code> is &gt; 0.
Returns points if <code>radius</code> is 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_locs_radius(locs, radius)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_locs_radius_+3A_locs">locs</code></td>
<td>
<p>SpatVector(1). SpatVector object with point geometry</p>
</td></tr>
<tr><td><code id="process_locs_radius_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer size (meters).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatVector</code> object
</p>

<hr>
<h2 id='process_locs_vector'>Process locations as <code>SpatVector</code></h2><span id='topic+process_locs_vector'></span>

<h3>Description</h3>

<p>Detect <code>SpatVector</code> object, or convert locations from class <code>sf</code>,
<code>data.frame</code> or <code>data.table</code> to
<code>SpatVector</code> object, project to coordinate reference system, and apply
circular buffer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_locs_vector(locs, crs, radius)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_locs_vector_+3A_locs">locs</code></td>
<td>
<p>data.frame(1). Data frame containing columns for unique
identifier, latitude, and longitude. Latitude and longitude columns <strong>must</strong>
be named &quot;lat&quot; and &quot;lon&quot;, respectively.</p>
</td></tr>
<tr><td><code id="process_locs_vector_+3A_crs">crs</code></td>
<td>
<p>Coordinate reference system (CRS) description utilizing
<code>terra::crs()</code>.</p>
</td></tr>
<tr><td><code id="process_locs_vector_+3A_radius">radius</code></td>
<td>
<p>integer(1). Circular buffer size (meters).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatVector</code> object
</p>

<hr>
<h2 id='process_merra2'>Process meteorological and atmospheric data</h2><span id='topic+process_merra2'></span>

<h3>Description</h3>

<p>The <code>process_merra2()</code> function imports and cleans raw atmospheric
composition data, returning a single <code>SpatRaster</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_merra2(
  date = c("2018-01-01", "2018-01-10"),
  variable = NULL,
  path = NULL,
  extent = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_merra2_+3A_date">date</code></td>
<td>
<p>character(1 or 2). Date (1) or start and end dates (2).
Format YYYY-MM-DD (ex. September 1, 2023 = &quot;2023-09-01&quot;).</p>
</td></tr>
<tr><td><code id="process_merra2_+3A_variable">variable</code></td>
<td>
<p>character(1). MERRA2 variable name(s).</p>
</td></tr>
<tr><td><code id="process_merra2_+3A_path">path</code></td>
<td>
<p>character(1). Directory with downloaded netCDF (.nc4) files.</p>
</td></tr>
<tr><td><code id="process_merra2_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_merra2_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object;
</p>


<h3>Note</h3>

<p>Layer names of the returned <code>SpatRaster</code> object contain the variable,
pressure level, date, and hour. Pressure level values utilized for layer
names are taken directly from raw data and are not edited to retain
pressure level information.
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
merra2 &lt;- process_merra2(
  date = c("2024-01-01", "2024-01-10"),
  variable = "CPT",
  path = "./data/inst1_2d_int_Nx"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_merra2_time'>Process MERRA2 time steps</h2><span id='topic+process_merra2_time'></span>

<h3>Description</h3>

<p>Identify the time step of data observations based on MERRA2 collection and
filter to time values in <code>from</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_merra2_time(collection, from)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_merra2_time_+3A_collection">collection</code></td>
<td>
<p>character(1). MERRA2 collection name.</p>
</td></tr>
<tr><td><code id="process_merra2_time_+3A_from">from</code></td>
<td>
<p>SpatRaster(1). Object to extract time values from.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='process_modis_merge'>Process MODIS .hdf files</h2><span id='topic+process_modis_merge'></span>

<h3>Description</h3>

<p>Get mosaicked or merged raster from multiple MODIS hdf files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_modis_merge(
  path = NULL,
  date = NULL,
  subdataset = NULL,
  fun_agg = "mean",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_modis_merge_+3A_path">path</code></td>
<td>
<p>character. Full list of hdf file paths.
preferably a recursive search result from <code><a href="base.html#topic+list.files">base::list.files</a></code>.</p>
</td></tr>
<tr><td><code id="process_modis_merge_+3A_date">date</code></td>
<td>
<p>character(1). date to query. Should be in
<code>"YYYY-MM-DD"</code> format.</p>
</td></tr>
<tr><td><code id="process_modis_merge_+3A_subdataset">subdataset</code></td>
<td>
<p>character(1). subdataset names to extract.
Should conform to regular expression. See <code><a href="base.html#topic+regex">base::regex</a></code> for details.
Default is <code>NULL</code>, which will result in errors. Users should specify
which subdatasets will be imported.</p>
</td></tr>
<tr><td><code id="process_modis_merge_+3A_fun_agg">fun_agg</code></td>
<td>
<p>Function name or custom function to aggregate overlapping
cell values. See <code>fun</code> description in <code><a href="terra.html#topic+tapp">terra::tapp</a></code> for details.</p>
</td></tr>
<tr><td><code id="process_modis_merge_+3A_...">...</code></td>
<td>
<p>For internal use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Note</h3>

<p>Curvilinear products (i.e., swaths) will not be accepted.
MODIS products downloaded by functions in <code>amadeus</code>,
<a href="https://cran.r-project.org/package=MODISTools">MODISTools</a>,
and <a href="https://github.com/rspatial/luna">luna</a> are accepted.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>

<p><code><a href="#topic+download_data">download_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
mod09ga_merge &lt;- process_modis_merge(
  path =
    list.files("./data", pattern = "MOD09GA.", full.names = TRUE),
  date = "2024-01-01",
  subdataset = "sur_refl_b01_1",
  fun_agg = "mean"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_modis_sds'>Process MODIS sub-datasets</h2><span id='topic+process_modis_sds'></span>

<h3>Description</h3>

<p>Selected MODIS sinusoidal grid product subdataset name selector.
Four presets are supported. <code>custom_sel</code> supersedes
presets of <code>product</code> values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_modis_sds(
  product = c("MOD11A1", "MOD13A2", "MOD09GA", "MCD19A2"),
  custom_sel = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_modis_sds_+3A_product">product</code></td>
<td>
<p>character(1). Product code.</p>
</td></tr>
<tr><td><code id="process_modis_sds_+3A_custom_sel">custom_sel</code></td>
<td>
<p>character(1). Custom filter.
If this value is not NULL, preset filter is
overridden.</p>
</td></tr>
<tr><td><code id="process_modis_sds_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character object that conforms to the regular
expression. Details of regular expression in R can be found in <a href="base.html#topic+regexp">regexp</a>.
</p>


<h3>Note</h3>

<p>Preset product codes and associated variables include
</p>

<ul>
<li><p> &quot;MOD11A1&quot; - Land surface temperature (LST)
</p>
</li>
<li><p> &quot;MOD13A2&quot; - Normalized Difference Vegetation Index (NDVI)
</p>
</li>
<li><p> &quot;MOD09GA&quot; - Surface reflectance, and
</p>
</li>
<li><p> &quot;MCD19A2&quot; - Aerosol optical depth (AOD).
</p>
</li></ul>

<p>For a full list of available
MODIS product codes, see the &quot;Short Name&quot; column at
<a href="https://lpdaac.usgs.gov/product_search/?collections=Combined+MODIS&amp;collections=Terra+MODIS&amp;collections=Aqua+MODIS&amp;view=list">NASA LP DAAC Search Data Catalog</a>.
When utilizing a product code from this &quot;Short Name&quot; column, <strong>do
not include</strong> the version number following the period. For example, if &quot;Short
Name&quot; = MCD12C1.006, then <code>product = "MCD12C1"</code>.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>

<p><a href="#topic+calculate_modis">calculate_modis</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>process_modis_sds(product = "MOD09GA")
</code></pre>

<hr>
<h2 id='process_modis_swath'>Mosaic MODIS swaths</h2><span id='topic+process_modis_swath'></span>

<h3>Description</h3>

<p>This function will return a <code>SpatRaster</code> object with
values of selected subdatasets. Swath data include curvilinear
grids, which require warping/rectifying the original curvilinear grids
into rectilinear grids. The function internally warps each of inputs
then mosaic the warped images into one large <code>SpatRaster</code> object.
Users need to select a subdataset to process. The full path looks like
<code>"HDF4_EOS:EOS_SWATH:{file_path}:mod06:subdataset"</code>, where file_path is
the full path to the hdf file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_modis_swath(
  path = NULL,
  date = NULL,
  subdataset = NULL,
  suffix = ":mod06:",
  resolution = 0.05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_modis_swath_+3A_path">path</code></td>
<td>
<p>character. Full paths of hdf files.</p>
</td></tr>
<tr><td><code id="process_modis_swath_+3A_date">date</code></td>
<td>
<p>character(1). Date to query.</p>
</td></tr>
<tr><td><code id="process_modis_swath_+3A_subdataset">subdataset</code></td>
<td>
<p>character. Subdatasets to process.
<strong>Unlike other preprocessing functions, this argument should specify
the exact subdataset name.</strong> For example, when using MOD06_L2 product,
one may specify <code>c("Cloud_Fraction", "Cloud_Optical_Thickness")</code>,
etc. The subdataset names can be found in <code>terra::describe()</code> output.</p>
</td></tr>
<tr><td><code id="process_modis_swath_+3A_suffix">suffix</code></td>
<td>
<p>character(1). Should be formatted <code style="white-space: pre;">&#8288;:{product}:&#8288;</code>,
e.g., <code style="white-space: pre;">&#8288;:mod06:&#8288;</code></p>
</td></tr>
<tr><td><code id="process_modis_swath_+3A_resolution">resolution</code></td>
<td>
<p>numeric(1). Resolution of output raster.
Unit is degree (decimal degree in WGS84).</p>
</td></tr>
<tr><td><code id="process_modis_swath_+3A_...">...</code></td>
<td>
<p>For internal use.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> a <code>SpatRaster</code> object (crs = <code>"EPSG:4326"</code>): if <code>path</code> is a single file with
full specification of subdataset.
</p>
</li>
<li><p> a <code>SpatRaster</code> object (crs = <code>"EPSG:4326"</code>): if <code>path</code> is a list of files. In this case, the returned object will have the maximal extent of multiple warped layers
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+process_modis_warp">process_modis_warp()</a></code>, <code><a href="stars.html#topic+read_stars">stars::read_stars()</a></code>, <code><a href="stars.html#topic+st_warp">stars::st_warp()</a></code>
</p>
</li>
<li> <p><a href="https://gdal.org/en/latest/drivers/raster/hdf4.html">GDAL HDF4 driver documentation</a>
</p>
</li>
<li> <p><code><a href="terra.html#topic+describe">terra::describe()</a></code>: to list the full subdataset list with <code>sds = TRUE</code>
</p>
</li>
<li> <p><code><a href="terra.html#topic+sprc">terra::sprc()</a></code>, <code><a href="terra.html#topic+rast">terra::rast()</a></code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
mod06l2_swath &lt;- process_modis_swath(
  path = list.files(
    "./data/mod06l2",
    full.names = TRUE,
    pattern = ".hdf"
  ),
  date = "2024-01-01",
  subdataset = "Cloud_Fraction",
  suffix = ":mod06:",
  resolution = 0.05
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_modis_warp'>Warp MODIS swath data into rectilinear grid raster</h2><span id='topic+process_modis_warp'></span>

<h3>Description</h3>

<p>Swath data is a type of MODIS data,
where curvilinear points are stored with varying resolution depending on
the relative position of the sensor axis. As this type of data
typically does not work well with planar spatial data, users
should warp or rectify this data into a rectilinear raster.
Main procedure is done with <code><a href="stars.html#topic+st_warp">stars::st_warp</a></code>, in which users are able to
customize the threshold to fill potential gaps that appear where
the target resolution is finer than the local resolution of curvilinear
grid points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_modis_warp(
  path = NULL,
  cellsize = 0.1,
  threshold = cellsize * 4,
  crs = 4326,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_modis_warp_+3A_path">path</code></td>
<td>
<p>File path of MODIS swath with exact sub-dataset specification.</p>
</td></tr>
<tr><td><code id="process_modis_warp_+3A_cellsize">cellsize</code></td>
<td>
<p>numeric(1). Cell size (spatial resolution) of
output rectilinear grid raster.</p>
</td></tr>
<tr><td><code id="process_modis_warp_+3A_threshold">threshold</code></td>
<td>
<p>numeric(1). Maximum distance to fill gaps if occur.</p>
</td></tr>
<tr><td><code id="process_modis_warp_+3A_crs">crs</code></td>
<td>
<p>integer(1)/character(1). Coordinate system definition.
Should be compatible with EPSG codes or WKT2.
See <code><a href="terra.html#topic+crs">terra::crs</a></code> and <code><a href="sf.html#topic+st_crs">sf::st_crs</a></code> / <a href="https://epsg.io/">EPSG</a></p>
</td></tr>
<tr><td><code id="process_modis_warp_+3A_...">...</code></td>
<td>
<p>For internal use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>stars</code> object
</p>


<h3>Note</h3>

<p>This function handles one file at a time.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>

<p><code><a href="terra.html#topic+rectify">terra::rectify</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
mod06l2_warp &lt;- process_modis_warp(
  path = paste0(
    "HDF4_EOS:EOS_SWATH:",
    list.files(
      "./data/mod06l2",
      full.names = TRUE,
      pattern = ".hdf"
    )[1],
    ":mod06:Cloud_Fraction"
  ),
  cellsize = 0.1,
  threshold = 0.4,
  crs = 4326
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_narr'>Process meteorological data</h2><span id='topic+process_narr'></span>

<h3>Description</h3>

<p>The <code>process_narr()</code> function imports and cleans raw meteorological
data, returning a single <code>SpatRaster</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_narr(
  date = "2023-09-01",
  variable = NULL,
  path = NULL,
  extent = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_narr_+3A_date">date</code></td>
<td>
<p>character(1 or 2). Date (1) or start and end dates (2).
Format YYYY-MM-DD (ex. September 1, 2023 = &quot;2023-09-01&quot;).</p>
</td></tr>
<tr><td><code id="process_narr_+3A_variable">variable</code></td>
<td>
<p>character(1). Variable name acronym. See <a href="https://ftp.cpc.ncep.noaa.gov/NARR/fixed/merged_land_AWIP32corrected.pdf">List of Variables in NARR Files</a>
for variable names and acronym codes.</p>
</td></tr>
<tr><td><code id="process_narr_+3A_path">path</code></td>
<td>
<p>character(1). Directory with downloaded netCDF (.nc) files.</p>
</td></tr>
<tr><td><code id="process_narr_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_narr_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Note</h3>

<p>Layer names of the returned <code>SpatRaster</code> object contain the variable acronym,
pressure level, and date.
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
process_narr(
  date = c("2018-01-01", "2018-01-10"),
  variable = "weasd",
  path = "./tests/testdata/narr/weasd"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_nei'>Process road emissions data</h2><span id='topic+process_nei'></span>

<h3>Description</h3>

<p>The <code>process_nei()</code> function imports and cleans raw road emissions data,
returning a single <code>SpatVector</code> object.
</p>
<p>NEI data comprises multiple csv files where emissions of
50+ pollutants are recorded at county level. With raw data files,
this function will join a combined table of NEI data and county
boundary, then perform a spatial join to target locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_nei(path = NULL, county = NULL, year = c(2017, 2020), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_nei_+3A_path">path</code></td>
<td>
<p>character(1). Directory with NEI csv files.</p>
</td></tr>
<tr><td><code id="process_nei_+3A_county">county</code></td>
<td>
<p><code>SpatVector</code>/<code>sf</code>. County boundaries.</p>
</td></tr>
<tr><td><code id="process_nei_+3A_year">year</code></td>
<td>
<p>integer(1) Year to use. Currently only 2017 or 2020
is accepted.</p>
</td></tr>
<tr><td><code id="process_nei_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatVector</code> object
</p>


<h3>Note</h3>

<p>Base files for <code>county</code> argument can be downloaded directly from
<a href="https://www.census.gov/geographies/mapping-files/time-series/geo/tiger-line-file.html">U.S. Census Bureau</a>
or by using <code>tigris</code> package. This function does not reproject census boundaries.
Users should be aware of the coordinate system of census boundary data for
other analyses.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
nei &lt;- process_nei(
  path = "./data",
  county = system.file("gpkg/nc.gpkg", package = "sf"),
  year = 2017
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_nlcd'>Process land cover data</h2><span id='topic+process_nlcd'></span>

<h3>Description</h3>

<p>The <code>process_nlcd()</code> function imports and cleans raw land cover data,
returning a single <code>SpatRaster</code> object.
</p>
<p>Reads NLCD file of selected <code>year</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_nlcd(path = NULL, year = 2021, extent = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_nlcd_+3A_path">path</code></td>
<td>
<p>character giving nlcd data path</p>
</td></tr>
<tr><td><code id="process_nlcd_+3A_year">year</code></td>
<td>
<p>numeric giving the year of NLCD data used</p>
</td></tr>
<tr><td><code id="process_nlcd_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_nlcd_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Author(s)</h3>

<p>Eva Marques, Insang Song
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
nlcd &lt;- process_nlcd(
  path = "./data/",
  year = 2021
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_population'>Process population density data</h2><span id='topic+process_population'></span>

<h3>Description</h3>

<p>The <code>process_secac_population()</code> function imports and cleans raw
population density data, returning a single <code>SpatRaster</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_population(path = NULL, extent = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_population_+3A_path">path</code></td>
<td>
<p>character(1). Path to GeoTIFF (.tif) or netCDF (.nc) file.</p>
</td></tr>
<tr><td><code id="process_population_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_population_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
pop &lt;- process_population(
  path = "./data/sedac_population_example.tif"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_prism'>Process PRISM data</h2><span id='topic+process_prism'></span>

<h3>Description</h3>

<p>This function imports and cleans raw PRISM data,
returning a single <code>SpatRaster</code> object.
</p>
<p>Reads time series or 30-year normal PRISM data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_prism(path = NULL, element = NULL, time = NULL, extent = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_prism_+3A_path">path</code></td>
<td>
<p>character giving PRISM data path
Both file and directory path are acceptable.</p>
</td></tr>
<tr><td><code id="process_prism_+3A_element">element</code></td>
<td>
<p>character(1). PRISM element name</p>
</td></tr>
<tr><td><code id="process_prism_+3A_time">time</code></td>
<td>
<p>character(1). PRISM time name.
Should be character in length of 2, 4, 6, or 8.
&quot;annual&quot; is acceptable.</p>
</td></tr>
<tr><td><code id="process_prism_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_prism_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object with metadata of time and element.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>See Also</h3>

<p><code><a href="terra.html#topic+rast">terra::rast</a></code>, <code><a href="terra.html#topic+metags">terra::metags</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
prism &lt;- process_prism(
  path = "./data/PRISM_ppt_stable_4kmM3_202104_nc.nc",
  element = "ppt",
  time = "202104"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_sedac_codes'>Process population resolution code</h2><span id='topic+process_sedac_codes'></span>

<h3>Description</h3>

<p>Convert full length resolution name to/from resolution code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_sedac_codes(string, invert = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_sedac_codes_+3A_string">string</code></td>
<td>
<p>character(1). Resolution name or code.</p>
</td></tr>
<tr><td><code id="process_sedac_codes_+3A_invert">invert</code></td>
<td>
<p>logical(1). Default = FALSE. <code>invert = TRUE</code> assumes <code>string</code>
provides resolution code, and returns full length resolution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='process_terraclimate'>Process TerraClimate data</h2><span id='topic+process_terraclimate'></span>

<h3>Description</h3>

<p>The <code>process_terraclimate()</code> function imports and cleans climate and water balance
data, returning a single <code>SpatRaster</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_terraclimate(
  date = c("2023-09-01", "2023-09-10"),
  variable = NULL,
  path = NULL,
  extent = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_terraclimate_+3A_date">date</code></td>
<td>
<p>character(1 or 2). Date (1) or start and end dates (2).
Format YYYY-MM-DD (ex. September 1, 2023 = &quot;2023-09-01&quot;).</p>
</td></tr>
<tr><td><code id="process_terraclimate_+3A_variable">variable</code></td>
<td>
<p>character(1). Variable name or acronym code. See <a href="https://climate.northwestknowledge.net/TERRACLIMATE/index_directDownloads.php">TerraClimate Direct Downloads</a>
for variable names and acronym codes.</p>
</td></tr>
<tr><td><code id="process_terraclimate_+3A_path">path</code></td>
<td>
<p>character(1). Directory with downloaded netCDF (.nc) files.</p>
</td></tr>
<tr><td><code id="process_terraclimate_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_terraclimate_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Note</h3>

<p>Layer names of the returned <code>SpatRaster</code> object contain the variable acronym, year,
and month.
</p>
<p>TerraClimate data has monthly temporal resolution, so the first day of each month
is used as a placeholder temporal value.
</p>


<h3>Author(s)</h3>

<p>Mitchell Manware
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
terraclimate &lt;- process_terraclimate(
  date = c("2023-01-01", "2023-01-10"),
  variable = "Precipitation",
  path = "./data/ppt"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_terraclimate_codes'>Process terraClimate variable codes</h2><span id='topic+process_terraclimate_codes'></span>

<h3>Description</h3>

<p>Convert terraClimate variable names to/from variable codes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_terraclimate_codes(string, invert = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_terraclimate_codes_+3A_string">string</code></td>
<td>
<p>character(1). terraClimate variable name or variable code.</p>
</td></tr>
<tr><td><code id="process_terraclimate_codes_+3A_invert">invert</code></td>
<td>
<p>logical(1). Default = FALSE. <code>invert = TRUE</code> assumes <code>string</code>
provides variable code and returns full length variable name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='process_tri'>Process toxic release data</h2><span id='topic+process_tri'></span>

<h3>Description</h3>

<p>This function imports and cleans raw toxic release data,
returning a single <code>SpatVector</code> (points) object for the selected <code>year</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_tri(
  path = NULL,
  year = 2018,
  variables = c(1, 13, 12, 14, 20, 34, 36, 47, 48, 49),
  extent = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_tri_+3A_path">path</code></td>
<td>
<p>character(1). Path to the directory with TRI CSV files</p>
</td></tr>
<tr><td><code id="process_tri_+3A_year">year</code></td>
<td>
<p>integer(1). Single year to select.</p>
</td></tr>
<tr><td><code id="process_tri_+3A_variables">variables</code></td>
<td>
<p>integer. Column index of TRI data.</p>
</td></tr>
<tr><td><code id="process_tri_+3A_extent">extent</code></td>
<td>
<p>numeric(4) or SpatExtent giving the extent of the raster
if <code>NULL</code> (default), the entire raster is loaded</p>
</td></tr>
<tr><td><code id="process_tri_+3A_...">...</code></td>
<td>
<p>Placeholders.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatVector</code> object (points) in <code>year</code>
<code>year</code> is stored in a field named <code>"year"</code>.
</p>


<h3>Note</h3>

<p>Visit <a href="https://www.epa.gov/toxics-release-inventory-tri-program/tri-toolbox">TRI Data and Tools</a>
to view the available years and variables.
</p>


<h3>Author(s)</h3>

<p>Insang Song, Mariana Kassien
</p>


<h3>References</h3>

<p>https://www.epa.gov/toxics-release-inventory-tri-program/tri-toolbox
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## NOTE: Example is wrapped in `\dontrun{}` as function requires a large
##       amount of data which is not included in the package.
## Not run: 
tri &lt;- process_tri(
  path = "./data",
  year = 2020,
  variables = c(1, 13, 12, 14, 20, 34, 36, 47, 48, 49)
)

## End(Not run)
</code></pre>

<hr>
<h2 id='process_variable_codes'>Filter gridMET and terraClimate variable names and variable codes</h2><span id='topic+process_variable_codes'></span>

<h3>Description</h3>

<p>Check user defined variables for gridMET and TerraClimate functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_variable_codes(variables, source = c("gridmet", "terraclimate"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_variable_codes_+3A_variables">variables</code></td>
<td>
<p>character(1). Data variables. (Passed from download_* or
process_*).</p>
</td></tr>
<tr><td><code id="process_variable_codes_+3A_source">source</code></td>
<td>
<p>character(1). Data source for selected variables (&quot;gridMET&quot; or
&quot;TerraClimate&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character
</p>

<hr>
<h2 id='read_commands'>Import download commands</h2><span id='topic+read_commands'></span>

<h3>Description</h3>

<p>Read download commands from .txt file and convert to character vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_commands(commands_path = commands_path)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_commands_+3A_commands_path">commands_path</code></td>
<td>
<p>file path with wget/curl commands</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector containing download commands
</p>

<hr>
<h2 id='rename_time'>Rename <code>$time</code></h2><span id='topic+rename_time'></span>

<h3>Description</h3>

<p>Rename the <code>$time</code> column of an <code>sftime</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rename_time(x, newname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rename_time_+3A_x">x</code></td>
<td>
<p>an <code>sftime</code> object</p>
</td></tr>
<tr><td><code id="rename_time_+3A_newname">newname</code></td>
<td>
<p>character for new time column name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>sftime</code> object
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>

<hr>
<h2 id='sf_as_mysftime'>Convert an <code>sf</code> to an <code>sftime</code></h2><span id='topic+sf_as_mysftime'></span>

<h3>Description</h3>

<p>Convert an <code>sf</code> object to an <code>sftime</code> object. <code>x</code> must
contain a time-defining column, identified in <code>timename</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sf_as_mysftime(x, timename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sf_as_mysftime_+3A_x">x</code></td>
<td>
<p>an <code>sf</code> object</p>
</td></tr>
<tr><td><code id="sf_as_mysftime_+3A_timename">timename</code></td>
<td>
<p>character: name of time column in x</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>sftime</code> object
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>

<hr>
<h2 id='sftime_as_mysftime'>Convert an <code>sftime</code> to a <code>mysftime</code></h2><span id='topic+sftime_as_mysftime'></span>

<h3>Description</h3>

<p>Convert an <code>sftime</code> object to a <code>mysftime</code> object. <code>x</code> must
contain a time-defining column, identified in <code>timename</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sftime_as_mysftime(x, timename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sftime_as_mysftime_+3A_x">x</code></td>
<td>
<p>an <code>sftime</code> object</p>
</td></tr>
<tr><td><code id="sftime_as_mysftime_+3A_timename">timename</code></td>
<td>
<p>character: name of time column in <code>x</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>sftime</code> object with specific format
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>


<h3>See Also</h3>

<p><a href="#topic+check_mysftime">check_mysftime</a>
</p>

<hr>
<h2 id='sftime_as_sf'>Convert an <code>sftime</code> to an <code>sf</code></h2><span id='topic+sftime_as_sf'></span>

<h3>Description</h3>

<p>Convert an <code>sftime</code> object to an <code>sf</code> object. <code>x</code> must
contain a time-defining column, identified in <code>timename</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sftime_as_sf(x, keeptime = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sftime_as_sf_+3A_x">x</code></td>
<td>
<p>an <code>sftime</code> object</p>
</td></tr>
<tr><td><code id="sftime_as_sf_+3A_keeptime">keeptime</code></td>
<td>
<p>boolean: TRUE if user wants to keep time column
as simple column (default = TRUE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>sf</code> object
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>

<hr>
<h2 id='sftime_as_spatraster'>Convert an <code>sftime</code> to a <code>SpatRaster</code></h2><span id='topic+sftime_as_spatraster'></span>

<h3>Description</h3>

<p>Convert an <code>sftime</code> object to a <code>SpatRaster</code> object. Returns a
<code>SpatRatser</code> with one layer for each time step in <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sftime_as_spatraster(x, varname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sftime_as_spatraster_+3A_x">x</code></td>
<td>
<p>an <code>sftime</code> object</p>
</td></tr>
<tr><td><code id="sftime_as_spatraster_+3A_varname">varname</code></td>
<td>
<p>variable to rasterize</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatRaster</code> object
</p>


<h3>Note</h3>

<p>Running <code>sftime_as_spatraster</code> can take a long time if <code>x</code> is not
spatially structured.
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>


<h3>See Also</h3>

<p><a href="terra.html#topic+rast">terra::rast</a>
</p>

<hr>
<h2 id='sftime_as_spatrds'>Convert an <code>sftime</code> to a <code>SpatRasterDataset</code></h2><span id='topic+sftime_as_spatrds'></span>

<h3>Description</h3>

<p>Convert an <code>sftime</code> object to a <code>SpatRasterDataset</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sftime_as_spatrds(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sftime_as_spatrds_+3A_x">x</code></td>
<td>
<p>an <code>sftime</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>SpatRasterDataset</code> object
</p>


<h3>Note</h3>

<p>Running <code>sftime_as_spatrds</code> can take a long time if <code>x</code> is not
spatially and temporally structured.
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>


<h3>See Also</h3>

<p><a href="terra.html#topic+sds">terra::sds</a>
</p>

<hr>
<h2 id='sftime_as_spatvector'>Convert an <code>sftime</code> to a <code>SpatVector</code></h2><span id='topic+sftime_as_spatvector'></span>

<h3>Description</h3>

<p>Convert an <code>sftime</code> object to a <code>SpatVector</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sftime_as_spatvector(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sftime_as_spatvector_+3A_x">x</code></td>
<td>
<p>an <code>sftime</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>SpatVector</code> object
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>


<h3>See Also</h3>

<p><a href="terra.html#topic+vect">terra::vect</a>
</p>

<hr>
<h2 id='spatraster_as_sftime'>Convert a <code>SpatRaster</code> to an <code>sftime</code></h2><span id='topic+spatraster_as_sftime'></span>

<h3>Description</h3>

<p>Convert a <code>SpatRaster</code> object to an <code>sftime</code> object. <code>x</code> must
contain a time-defining column, identified in <code>timename</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatraster_as_sftime(x, varname, timename = "time")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spatraster_as_sftime_+3A_x">x</code></td>
<td>
<p>a <code>SpatRaster</code> object</p>
</td></tr>
<tr><td><code id="spatraster_as_sftime_+3A_varname">varname</code></td>
<td>
<p>character for variable column name in the sftime</p>
</td></tr>
<tr><td><code id="spatraster_as_sftime_+3A_timename">timename</code></td>
<td>
<p>character for time column name in the sftime
(default: &quot;time&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>sftime</code> object
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>


<h3>See Also</h3>

<p><a href="terra.html#topic+rast">terra::rast</a>
</p>

<hr>
<h2 id='spatrds_as_sftime'>Convert a <code>SpatRasterDataset</code> to an <code>sftime</code></h2><span id='topic+spatrds_as_sftime'></span>

<h3>Description</h3>

<p>Convert a <code>SpatRasterDataset</code> object to an <code>sftime</code> object.
<code>x</code> must contain a time-defining column, identified in <code>timename</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatrds_as_sftime(x, timename = "time")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spatrds_as_sftime_+3A_x">x</code></td>
<td>
<p>a <code>SpatRasterDataset</code> object (~ list of named SpatRasters)</p>
</td></tr>
<tr><td><code id="spatrds_as_sftime_+3A_timename">timename</code></td>
<td>
<p>character for time column name in the sftime
(default: &quot;time&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>sftime</code> object
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>


<h3>See Also</h3>

<p><a href="terra.html#topic+sds">terra::sds</a>
</p>

<hr>
<h2 id='spatvector_as_sftime'>Convert a <code>SpatVector</code> to an <code>sftime</code></h2><span id='topic+spatvector_as_sftime'></span>

<h3>Description</h3>

<p>Convert a <code>SpatVector</code> object to an <code>sftime</code> object. <code>x</code> must
contain a time-defining column, identified in <code>timename</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatvector_as_sftime(x, timename = "time")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spatvector_as_sftime_+3A_x">x</code></td>
<td>
<p>a <code>SpatVector</code> object</p>
</td></tr>
<tr><td><code id="spatvector_as_sftime_+3A_timename">timename</code></td>
<td>
<p>character for time column name in x
(default: &quot;time&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>sftime</code> object
</p>


<h3>Author(s)</h3>

<p>Eva Marques
</p>


<h3>See Also</h3>

<p><a href="terra.html#topic+vect">terra::vect</a>
</p>

<hr>
<h2 id='sum_edc'>Calculate isotropic Sum of Exponentially Decaying Contributions (SEDC) covariates</h2><span id='topic+sum_edc'></span>

<h3>Description</h3>

<p>Calculate isotropic Sum of Exponentially Decaying Contributions (SEDC) covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sum_edc(
  from = NULL,
  locs = NULL,
  locs_id = NULL,
  sedc_bandwidth = NULL,
  target_fields = NULL,
  geom = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sum_edc_+3A_from">from</code></td>
<td>
<p><code>SpatVector</code>(1). Point locations which contain point-source
covariate data.</p>
</td></tr>
<tr><td><code id="sum_edc_+3A_locs">locs</code></td>
<td>
<p>sf/SpatVector(1). Locations where the sum of exponentially
decaying contributions are calculated.</p>
</td></tr>
<tr><td><code id="sum_edc_+3A_locs_id">locs_id</code></td>
<td>
<p>character(1). Name of the unique id field in <code>point_to</code>.</p>
</td></tr>
<tr><td><code id="sum_edc_+3A_sedc_bandwidth">sedc_bandwidth</code></td>
<td>
<p>numeric(1).
Distance at which the source concentration is reduced to
<code>exp(-3)</code> (approximately -95 %)</p>
</td></tr>
<tr><td><code id="sum_edc_+3A_target_fields">target_fields</code></td>
<td>
<p>character(varying). Field names in characters.</p>
</td></tr>
<tr><td><code id="sum_edc_+3A_geom">geom</code></td>
<td>
<p>FALSE/&quot;sf&quot;/&quot;terra&quot;.. Should the function return with geometry?
Default is <code>FALSE</code>, options with geometry are &quot;sf&quot; or &quot;terra&quot;. The
coordinate reference system of the <code>sf</code> or <code>SpatVector</code> is that of <code>from.</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame (tibble) or SpatVector object with input field names with
a suffix <code>"_sedc"</code> where the sums of EDC are stored.
Additional attributes are attached for the EDC information.
</p>

<ul>
<li><p> 'attr(result, &quot;sedc_bandwidth&quot;)&ldquo;: the bandwidth where
concentration reduces to approximately five percent
</p>
</li>
<li><p> 'attr(result, &quot;sedc_threshold&quot;)&ldquo;: the threshold distance
at which emission source points are excluded beyond that
</p>
</li></ul>



<h3>Note</h3>

<p>The function is originally from
<a href="https://github.com/ropensci/chopin">chopin</a>
Distance calculation is done with terra functions internally.
Thus, the function internally converts sf objects in
<code>point_*</code> arguments to terra.
The threshold should be carefully chosen by users.
</p>


<h3>Author(s)</h3>

<p>Insang Song
</p>


<h3>References</h3>

<p>Messier KP, Akita Y, Serre ML (2012).
&ldquo;Integrating Address Geocoding, Land Use Regression, and Spatiotemporal Geostatistical Estimation for Groundwater Tetrachloroethylene.&rdquo;
<em>Environmental Science &amp; Technology</em>, <b>46</b>(5), 2772&ndash;2780.
ISSN 0013-936X, <a href="https://doi.org/10.1021/es203152a">doi:10.1021/es203152a</a>.
</p>
<p>Wiesner C (????).
&ldquo;Euclidean Sum of Exponentially Decaying Contributions Tutorial.&rdquo;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(101)
ncpath &lt;- system.file("gpkg/nc.gpkg", package = "sf")
nc &lt;- terra::vect(ncpath)
nc &lt;- terra::project(nc, "EPSG:5070")
pnt_locs &lt;- terra::centroids(nc, inside = TRUE)
pnt_locs &lt;- pnt_locs[, "NAME"]
pnt_from &lt;- terra::spatSample(nc, 10L)
pnt_from$pid &lt;- seq(1, 10)
pnt_from &lt;- pnt_from[, "pid"]
pnt_from$val1 &lt;- rgamma(10L, 1, 0.05)
pnt_from$val2 &lt;- rgamma(10L, 2, 1)

vals &lt;- c("val1", "val2")
sum_edc(pnt_locs, pnt_from, "NAME", 1e4, vals)
</code></pre>

<hr>
<h2 id='test_download_functions'>Download unit tests</h2><span id='topic+test_download_functions'></span>

<h3>Description</h3>

<p>Implement directory, file, and download URL unit tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_download_functions(
  directory_to_save = directory_to_save,
  commands_path = commands_path,
  url_status = url_status
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test_download_functions_+3A_directory_to_save">directory_to_save</code></td>
<td>
<p>directory to test saving</p>
</td></tr>
<tr><td><code id="test_download_functions_+3A_commands_path">commands_path</code></td>
<td>
<p>file path with download commands</p>
</td></tr>
<tr><td><code id="test_download_functions_+3A_url_status">url_status</code></td>
<td>
<p>logical vector for URL status = 200</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL; returns stop error if one or more tests fail
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
