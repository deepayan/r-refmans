<!DOCTYPE html><html><head><title>Help for package ppgm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ppgm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addFossil'><p>addFossil</p></a></li>
<li><a href='#getBioclimVars'><p>getBioclimVars</p></a></li>
<li><a href='#getEnvelopes'><p>getEnvelopes</p></a></li>
<li><a href='#getGeoRate'><p>getGeoRate</p></a></li>
<li><a href='#getLineageClimate'><p>getLineageClimate</p></a></li>
<li><a href='#getTimeSlice'><p>getTimeSlice</p></a></li>
<li><a href='#nodeEstimate'><p>nodeEstimate</p></a></li>
<li><a href='#nodeEstimateEnvelopes'><p>nodeEstimateEnvelopes</p></a></li>
<li><a href='#occurrences'><p>Sceloporus occurrence data</p></a></li>
<li><a href='#paleoclimate'><p>Paleoclimate Data for ppgm examples</p></a></li>
<li><a href='#plotAnimatedPPGM'><p>plotAnimatedPPGM</p></a></li>
<li><a href='#plotAnimatedPPGMMultiPhylo'><p>plotAnimatedPPGMMultiPhylo</p></a></li>
<li><a href='#plotGeoRates'><p>plotGeoRates</p></a></li>
<li><a href='#plotGeoRatesCon'><p>plotGeoRatesCon</p></a></li>
<li><a href='#plotTraitGram'><p>plotTraitGram</p></a></li>
<li><a href='#plotTraitGramMultiPhylo'><p>plotTraitGramMultiPhylo</p></a></li>
<li><a href='#ppgm'><p>ppgm</p></a></li>
<li><a href='#ppgmConsensus'><p>ppgmConsensus</p></a></li>
<li><a href='#ppgmMESS'><p>ppgmMESS</p></a></li>
<li><a href='#sampletrees'><p>Sample of Sceloporus phylogenies</p></a></li>
<li><a href='#scel_fossils'><p>Sceloporus fossil data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>PaleoPhyloGeographic Modeling of Climate Niches and Species
Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Reconstruction of paleoclimate niches using phylogenetic comparative 
    methods and projection reconstructed niches onto paleoclimate maps.
    The user can specify various models of trait evolution or estimate the best fit
    model, include fossils, use one or multiple phylogenies for inference, and make
    animations of shifting suitable habitat through time. This model was first used
    in Lawing and Polly (2011), and further implemented in Lawing et al (2016) and 
    Rivera et al (2020).
    Lawing and Polly (2011) &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0028554">doi:10.1371/journal.pone.0028554</a>&gt; "Pleistocene climate,
    phylogeny and climate envelope models: An integrative approach to better 
    understand species' response to climate change"
    Lawing et al (2016) &lt;<a href="https://doi.org/10.1086%2F687202">doi:10.1086/687202</a>&gt; "Including fossils in phylogenetic 
    climate reconstructions: A deep time perspective on the climatic niche evolution
    and diversification of spiny lizards (Sceloporus)"
    Rivera et al (2020) &lt;<a href="https://doi.org/10.1111%2Fjbi.13915">doi:10.1111/jbi.13915</a>&gt; "Reconstructing historical shifts 
    in suitable habitat of Sceloporus lineages using phylogenetic niche modelling.".</td>
</tr>
<tr>
<td>Imports:</td>
<td>animation, ape, fields, geiger, methods, phangorn, phytools,
stringi</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0), R (&ge; 2.10), sp, sf</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-11 11:02:02 UTC; alexa</td>
</tr>
<tr>
<td>Author:</td>
<td>A. Michelle Lawing [aut, cph],
  Alexandra Howard [aut, cre],
  Maria-Aleja Hurtado-Materon [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexandra Howard &lt;alexandra.howard@ag.tamu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-11 12:20:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='addFossil'>addFossil</h2><span id='topic+addFossil'></span>

<h3>Description</h3>

<p>Adds a fossil as a tip to a specified phylogeny given either an age range that the fossil occurs in, a specific edge that the fossil diverged from, or both. If the specific edge placement for the fossil is unknown, then this function randomly places the fossil on any edge that is within the age range.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addFossil(tree, mintime = 0, maxtime = NA, name = "fossil", edge = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addFossil_+3A_tree">tree</code></td>
<td>
<p>An object of the class &quot;phylo&quot;</p>
</td></tr>
<tr><td><code id="addFossil_+3A_mintime">mintime</code></td>
<td>
<p>The minimum age of the fossil. If no minimum time is specified, the default value is 0.</p>
</td></tr>
<tr><td><code id="addFossil_+3A_maxtime">maxtime</code></td>
<td>
<p>The maximum age of the fossil. If no maximum time is specified, the default value is the maximum tree age.</p>
</td></tr>
<tr><td><code id="addFossil_+3A_name">name</code></td>
<td>
<p>The name of the fossil to appear as a tip.label.</p>
</td></tr>
<tr><td><code id="addFossil_+3A_edge">edge</code></td>
<td>
<p>The edge on the tree where the fossil presumably diverged. If no edge is specified, then the function randomly selects an edge within the age range of the fossil.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are several random components to this function. First, if an edge is not specified to place a fossil, then an edge is randomly selected that is within the age range of the fossil. Second, the exact placement of the node leading to the fossil is randomly selected within the age range specified. Third, the length of the edge leading to the fossil is randomly selected with constraints on the maximum length of the edge, where the maximum length of the edge cannot render the fossil younger than the minimum time of occurrence as specified in the mintime argument.
</p>


<h3>Value</h3>

<p>An object of the class &quot;phylo&quot;.
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mytree &lt;- phytools::pbtree(n=20)
newtree &lt;- addFossil(mytree, mintime = max(mytree$edge.length)/2, maxtime= max(mytree$edge.length))
plot(newtree)
</code></pre>

<hr>
<h2 id='getBioclimVars'>getBioclimVars</h2><span id='topic+getBioclimVars'></span>

<h3>Description</h3>

<p>This function retrieves the bioclimatic variables described in Nix &amp; Busby (1986) for the specified variables and the specified time period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBioclimVars(occurrences, which.biovars=c(1:19), 
use.paleoclimate=TRUE, paleoclimateUser=NULL, layerAge=c(0:20))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getBioclimVars_+3A_occurrences">occurrences</code></td>
<td>
<p>a matrix or data.frame with three columns and rows to represent individuals. The first column must be species name for extant occurrences or the age in closest Ma for fossil occurrences. Second and third column must be Longitude and Latitude.</p>
</td></tr>
<tr><td><code id="getBioclimVars_+3A_which.biovars">which.biovars</code></td>
<td>
<p>a vector of the numbers of the bioclimatic variables that should be returned. The bioclimatic variables number correspond to the table at (https://www.worldclim.org/data/bioclim.html).</p>
</td></tr>
<tr><td><code id="getBioclimVars_+3A_use.paleoclimate">use.paleoclimate</code></td>
<td>
<p>if left blank, default North America paleoclimate data is used. If FALSE, user submitted paleoclimate must be provided</p>
</td></tr>
<tr><td><code id="getBioclimVars_+3A_paleoclimateuser">paleoclimateUser</code></td>
<td>
<p>list of data frames with paleoclimates, must be dataframes with columns: GlobalID, Longitude, Latitude, bio1, bio2,...,bio19.</p>
</td></tr>
<tr><td><code id="getBioclimVars_+3A_layerage">layerAge</code></td>
<td>
<p>vector with the ages of the paleoclimate dataframes, if using user submitted paleoclimate data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The occurrences argument should contain all extant or all fossils. Columns should be in the format: Species, Longitude, Latitude for extant data.
</p>
<p>If using the provided paleoclimate data:
</p>
<p>Modern time period uses the Hijmans et al. (2005) high resolution climate interpolations.
</p>
<p>The time period 10 Ma uses the GCM by Micheels et al (2011) for the Tortonian.
</p>
<p>The time period 15 Ma uses the GCM by Krapp &amp; Jungclaus (2011) for the Middle Miocene.
</p>
<p>For the one million year intervals outside the modern and past GCMs, the climate was interpolated based on the benthic marine foram stable oxygen isotope ratio curve from Ruddiman et al 1989. The scale of these variables is at a 50 km equidistant point grain size.
</p>


<h3>Value</h3>

<p>Returns a data frame with the original occurrences input appended with columns of bioclimate variables as specified. If fossils are included, the returned bioclimate variables are from the closest 1 Ma interval of isotopically scaled climate.
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard, Maria-Aleja Hurtado-Materon
</p>


<h3>References</h3>

<p>Hijmans, R. J. et al. (2005) Very high resolution interpolated climate surfaces for global land areas
</p>
<p>Krapp, M. and Jungclaus, J. H. (2011) The Middle Miocene climate as modeled in an atmosphere-ocean-biosphere model. Climate of the Past 7(4):1169-1188
</p>
<p>Micheels, A. et al. (2011) Analysis of heat transport mechanisms from a Late Miocene model experiment with a fully-coupled atmosphere-ocean general circulation model. Palaeogeography, Palaeoclimatology, Palaeocology 304: 337-350
</p>
<p>Nix, H. and Busby, J. (1986) BIOCLIM, a bioclimatic analysis and prediction system. CSIRO annual report. CSIRO Division of Water and Land Resources, Canberra.
</p>
<p>Ruddiman, W. F. et al. (1989) Pleistocene evolution: Northern hemisphere ice sheets and North Atlantic Ocean. Paleoceanography 4: 353-412
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(occurrences)
biooccur &lt;- getBioclimVars(occurrences,which.biovars=c(3,5))
#returns data frame with bioclimate variables 3 and 5 for occurrence data
</code></pre>

<hr>
<h2 id='getEnvelopes'>getEnvelopes</h2><span id='topic+getEnvelopes'></span>

<h3>Description</h3>

<p>This function gets the bioclimate envelopes of species and nodes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEnvelopes(treedata_min, treedata_max, node_est)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getEnvelopes_+3A_treedata_min">treedata_min</code></td>
<td>
<p>tree data object with min estimate of the climate envelope for each species.</p>
</td></tr>
<tr><td><code id="getEnvelopes_+3A_treedata_max">treedata_max</code></td>
<td>
<p>tree data object with max estimate of the climate envelope for each species</p>
</td></tr>
<tr><td><code id="getEnvelopes_+3A_node_est">node_est</code></td>
<td>
<p>the estimate of all the nodes, both min and max</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function derives the minimum, and maximum of each climate variable
</p>


<h3>Value</h3>

<p>An array containing climate envelopes for each node
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard
</p>


<h3>See Also</h3>

<p><code>ppgmMESS()</code>, <code>nodeEstimate</code>, <code>geiger::treedata</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
tree &lt;- sampletrees[[25]]
biooccu &lt;- getBioclimVars(occurrences, which.biovars=1)
sp_data_min&lt;- tapply(biooccu[,4],biooccu$Species,min)
sp_data_max&lt;- tapply(biooccu[,4],biooccu$Species,max)
treedata_min &lt;- geiger::treedata(tree,sp_data_min,sort=TRUE,warnings=F)
treedata_max &lt;- geiger::treedata(tree,sp_data_max,sort=TRUE,warnings=F)
full_est &lt;- nodeEstimateEnvelopes(treedata_min,treedata_max)
node_est &lt;- full_est$est
example_getEnvelopes &lt;- getEnvelopes(treedata_min, treedata_max, node_est)
</code></pre>

<hr>
<h2 id='getGeoRate'>getGeoRate</h2><span id='topic+getGeoRate'></span>

<h3>Description</h3>

<p>This function calculates the change in suitable habitat through time in geographic space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getGeoRate(envelope, tree, which.biovars, use.paleoclimate=TRUE, 
paleoclimateUser=NULL, layerAge=c(0:20))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getGeoRate_+3A_envelope">envelope</code></td>
<td>
<p>the min and max climate envelope of each lineage for each time slice, as outputted by <code>getEnvelopes()</code></p>
</td></tr>
<tr><td><code id="getGeoRate_+3A_tree">tree</code></td>
<td>
<p>the phylogeny of all species. An object of class phylo</p>
</td></tr>
<tr><td><code id="getGeoRate_+3A_which.biovars">which.biovars</code></td>
<td>
<p>a vector of the numbers of the bioclimate variables to be included. The bioclimate variables number correspond to the table at (https://www.worldclim.org/data/bioclim.html).</p>
</td></tr>
<tr><td><code id="getGeoRate_+3A_use.paleoclimate">use.paleoclimate</code></td>
<td>
<p>if left blank, default North America paleoclimate data is used. If FALSE, user submitted paleoclimate must be provided</p>
</td></tr>
<tr><td><code id="getGeoRate_+3A_paleoclimateuser">paleoclimateUser</code></td>
<td>
<p>list of data frames with paleoclimates, must be dataframes with columns: GlobalID, Longitude, Latitude, bio1, bio2,...,bio19. (see <code>getBioclimvars()</code>).</p>
</td></tr>
<tr><td><code id="getGeoRate_+3A_layerage">layerAge</code></td>
<td>
<p>vector with the ages of the paleoclimate dataframes, if using user submitted paleoclimate data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates rate of geographic change of all lineages. Outputs both the geographic center change, and the geographic size change.
</p>


<h3>Value</h3>

<p><code>geo_center</code> change in geographic center of suitable climate envelope
</p>
<p><code>geo_size</code> change in geographic size of suitable climate envelope
</p>
<p><code>time_int</code> time intervals
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard, Maria A. Hurtado-Materon
</p>


<h3>See Also</h3>

<p><code>getEnvelopes()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
data(paleoclimate)
tree &lt;- sampletrees[[25]]
occu &lt;- getBioclimVars(occurrences, which.biovars=1)
sp_data_min&lt;- tapply(occu[,4],occu$Species,min)
sp_data_max&lt;- tapply(occu[,4],occu$Species,max)
treedata_min &lt;- geiger::treedata(tree,sp_data_min,sort=TRUE,warnings=F)
treedata_max &lt;- geiger::treedata(tree,sp_data_max,sort=TRUE,warnings=F)
full_est &lt;- nodeEstimateEnvelopes(treedata_min,treedata_max)
node_est &lt;- full_est$est
example_getEnvelopes &lt;- getEnvelopes(treedata_min, treedata_max, node_est)
example_getGeoRate &lt;- getGeoRate(example_getEnvelopes, tree, which.biovars=1)
</code></pre>

<hr>
<h2 id='getLineageClimate'>getLineageClimate</h2><span id='topic+getLineageClimate'></span>

<h3>Description</h3>

<p>This function calculates the suitable climate for each specific lineage, starting at the tips and going back through time to the root.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLineageClimate(envelope, tree, which.biovars, 
use.paleoclimate=TRUE, paleoclimateUser=NULL, layerAge=c(0:20))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLineageClimate_+3A_envelope">envelope</code></td>
<td>
<p>the min and max climate envelope of each lineage for each time slice, as outputted by <code>getEnvelopes()</code></p>
</td></tr>
<tr><td><code id="getLineageClimate_+3A_tree">tree</code></td>
<td>
<p>the phylogeny of all species. An object of class phylo</p>
</td></tr>
<tr><td><code id="getLineageClimate_+3A_which.biovars">which.biovars</code></td>
<td>
<p>a vector of the numbers of the bioclimate variables to be included. The bioclimate variables number correspond to the table at (https://www.worldclim.org/data/bioclim.html).</p>
</td></tr>
<tr><td><code id="getLineageClimate_+3A_use.paleoclimate">use.paleoclimate</code></td>
<td>
<p>if left blank, default North America paleoclimate data is used. If FALSE, user submitted paleoclimate must be provided</p>
</td></tr>
<tr><td><code id="getLineageClimate_+3A_paleoclimateuser">paleoclimateUser</code></td>
<td>
<p>list of data frames with paleoclimates, must be dataframes with columns: GlobalID, Longitude, Latitude, bio1, bio2,...,bio19. (see <code>getBioclimvars()</code>).</p>
</td></tr>
<tr><td><code id="getLineageClimate_+3A_layerage">layerAge</code></td>
<td>
<p>vector with the ages of the paleoclimate dataframes, if using user submitted paleoclimate data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates rate of geographic change of all lineages. Outputs both the geographic center change, and the geographic size change.
</p>


<h3>Value</h3>

<p><code>matchedClim</code> list of occurrences points for each lineage, for each time slice of paleoclimate data
</p>
<p><code>lineage</code> list of lineage specific nodes, as output from phangorn::Ancestors
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard, Maria A. Hurtado-Materon
</p>


<h3>See Also</h3>

<p><code>getEnvelopes()</code> <code>getGeoRate()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
data(paleoclimate)
occu &lt;- getBioclimVars(occurrences, which.biovars=1)
tree &lt;- sampletrees[[25]]
#species minimum for biovariable 1
sp_data_min&lt;- tapply(occu[,4],occu$Species,min)
#species maximum for biovariable 1
sp_data_max&lt;- tapply(occu[,4],occu$Species,max)
#convert to treedata object
treedata_min &lt;- geiger::treedata(tree,sp_data_min,sort=TRUE,warnings=F) 
treedata_max &lt;- geiger::treedata(tree,sp_data_max,sort=TRUE,warnings=F)
#estimate node values using Brownian Motion
full_est &lt;- nodeEstimateEnvelopes(treedata_min,treedata_max)
node_est &lt;- full_est$est #extract only node estimates
#calculate climate envelopes
example_getEnvelopes &lt;- getEnvelopes(treedata_min, treedata_max, node_est)
#calculate lineage specific climate
example_getLinClim &lt;- getLineageClimate(example_getEnvelopes, tree, which.biovars=1)
</code></pre>

<hr>
<h2 id='getTimeSlice'>getTimeSlice</h2><span id='topic+getTimeSlice'></span>

<h3>Description</h3>

<p>This function extracts estimated ancestral reconstructions for continuous characters any time specified along a phylogeny for all lineages present at the specified time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTimeSlice(timeSlice, tree, trait, model = "BM", plot.est = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getTimeSlice_+3A_timeslice">timeSlice</code></td>
<td>
<p>single numeric or a vector with the time (or times) to extract the estimated ancestor reconstructions.</p>
</td></tr>
<tr><td><code id="getTimeSlice_+3A_tree">tree</code></td>
<td>
<p>an object of the class &quot;phylo&quot; that should be dated</p>
</td></tr>
<tr><td><code id="getTimeSlice_+3A_trait">trait</code></td>
<td>
<p>a vector of both tip values and node estimates that correspond to tree</p>
</td></tr>
<tr><td><code id="getTimeSlice_+3A_model">model</code></td>
<td>
<p>if model = &quot;estimate&quot;, the best fit model of evolution. If the model was specified, then model is the specified model, passes to <code>geiger::fitContinuous()</code>. Model options currently supported are: &quot;BM&quot;, &quot;OU&quot;, &quot;EB&quot;, &quot;lambda&quot;, &quot;kappa&quot;, &quot;delta&quot;</p>
</td></tr>
<tr><td><code id="getTimeSlice_+3A_plot.est">plot.est</code></td>
<td>
<p>a conditional stating whether or not to plot the results</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimated reconstruction relies on an interpolation between node or between tip and node estimates of the trait. This method assumes a constant rate of evolution along the lineage where the interpolation is taking place.
</p>


<h3>Value</h3>

<p><code>edge</code> for each time specified, a vector of edges that are present during that time are returned
</p>
<p><code>est</code> for each time specified, a vector of estimates of the ancestral reconstruction along each edge
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard
</p>


<h3>See Also</h3>

<p><code>geiger::fitContinuous()</code>, <code>nodeEstimate()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
occurrences &lt;- getBioclimVars(occurrences, which.biovars=1)
sp_data_min&lt;- tapply(occurrences[,4],occurrences$Species,min)
treedata_min &lt;- geiger::treedata(sampletrees[[1]], sp_data_min)
ex_est &lt;- nodeEstimate(treedata_min, 1, model = 'BM') #runs BM model
ex_timeSlice &lt;- getTimeSlice(10,treedata_min$phy,c(treedata_min$data[,1],ex_est$est))
</code></pre>

<hr>
<h2 id='nodeEstimate'>nodeEstimate</h2><span id='topic+nodeEstimate'></span>

<h3>Description</h3>

<p>This function estimates the ancestral character states for continuous characters given a model of evolution or using the best fit model of evolution from the fitContinuous function in the geiger package. The ancestral states are estimated using GLS described in Martins and Hansen (1997).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nodeEstimate(treedata.obj, traitnum, model = "BM", bounds = list(), 
control = list(), plot.est = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nodeEstimate_+3A_treedata.obj">treedata.obj</code></td>
<td>
<p>an object of the class &quot;treedata&quot;.</p>
</td></tr>
<tr><td><code id="nodeEstimate_+3A_traitnum">traitnum</code></td>
<td>
<p>the column number of the trait within the treedata object to be reconstructed.</p>
</td></tr>
<tr><td><code id="nodeEstimate_+3A_model">model</code></td>
<td>
<p>the model of evolution to use in the ancestral state reconstruction. Options are &quot;estimate&quot;, &quot;BM&quot;, &quot;OU&quot;, &quot;EB&quot;, &quot;lambda&quot;, &quot;kappa&quot;, &quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="nodeEstimate_+3A_bounds">bounds</code></td>
<td>
<p>bounds used for the model, passes to <code>fitContinuous()</code>, uses default if none specified.</p>
</td></tr>
<tr><td><code id="nodeEstimate_+3A_control">control</code></td>
<td>
<p>setting used for optimization of the model likelihood. Passes to <code>fitContinuous()</code>.</p>
</td></tr>
<tr><td><code id="nodeEstimate_+3A_plot.est">plot.est</code></td>
<td>
<p>logical. whether or not to plot the traitgram of the estimated ancestor states.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the <code>fitContinuous()</code> details for descriptions of the models of evolution and parameter estimation. <code>nodeEstimate()</code> currently supports the following models of evolution: Brownian motion (Felsenstein, 1973), Ornstein-Uhlenbeck (Butler and King, 2004), early-burst (Harmon et al., 2010), lambda (Pagel, 1999), kappa (Pagel, 1999), and delta (Pagel, 1999).
</p>


<h3>Value</h3>

<p>an object of the class &quot;nodeEstimate&quot;.
</p>
<p><code>model</code>    if model = &quot;estimate&quot;, the best fit model of evolution. If the model was specified, then model is the specified model.
</p>
<p><code>est</code>      the ancestral node estimates of the continuous character.
</p>
<p><code>phy</code>      the phylogeny used for the estimates, which might be transformed depending on the evolutionary model.
</p>
<p><code>BM</code>       if model = &quot;BM&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;BM&quot;
</p>
<p><code>OU</code>       if model = &quot;OU&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;OU&quot;
</p>
<p><code>EB</code>       if model = &quot;EB&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;EB&quot;
</p>
<p><code>lambda</code>   if model = &quot;lambda&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;lambda&quot;
</p>
<p><code>kappa</code>    if model = &quot;kappa&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;kappa&quot;
</p>
<p><code>delta</code>    if model = &quot;delta&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;delta&quot;
</p>
<p><code>fitted</code>   if model = &quot;estimate&quot;, returned values from the best fit model of evolution.
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard
</p>


<h3>References</h3>

<p>Butler, M. A. and King, A. A. (2004) Phylogenetic comparative analysis: a modeling approach for adaptive evolution. American Naturalist, 164:683-695.
</p>
<p>Felsenstein, J. (1973) Maximum likelihood estimation of evolutionary trees from continuous characters. American Journal of Human Genetics, 25:471-492
</p>
<p>Harmon, L. J. et al. (2010) Early bursts of body size and shape evolution are rare in comparative data. Evolution, 64:2385-2396
</p>
<p>Martins, E. P. and Hansen, T. F. (1997) Phylogenies and the comparative method: a general approach to incorporating phylogenetic information into the analysis of interspecific data. American Naturalist, 149, 646–667.
</p>
<p>Pagel M. (1999) Inferring the historical patterns of biological evolution. Nature, 401:877-884
</p>


<h3>See Also</h3>

<p><code>fitContinuous()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
occurrences &lt;- getBioclimVars(occurrences, which.biovars=1)
sp_data_min&lt;- tapply(occurrences[,4],occurrences$Species,min)
ex &lt;- geiger::treedata(sampletrees[[1]], sp_data_min)
nodeEstimate(ex, 1, model = 'OU') #runs OU model
</code></pre>

<hr>
<h2 id='nodeEstimateEnvelopes'>nodeEstimateEnvelopes</h2><span id='topic+nodeEstimateEnvelopes'></span>

<h3>Description</h3>

<p>This function estimates climate envelopes at nodes with the optional placement of fossils on randomly assigned or specified edges on a tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nodeEstimateEnvelopes(treedata_min, treedata_max, fossils=FALSE, 
fossils.edges=FALSE, model="BM", bounds=list(), control=list(), 
use.paleoclimate = TRUE, paleoclimateUser = NULL, layerAge = c(0:20), 
which.biovars = which.biovars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nodeEstimateEnvelopes_+3A_treedata_min">treedata_min</code></td>
<td>
<p>tree data object with min estimate of the climate envelope – list where first object is phylogeny, and second object is array of species with climate data variables (species must match)</p>
</td></tr>
<tr><td><code id="nodeEstimateEnvelopes_+3A_treedata_max">treedata_max</code></td>
<td>
<p>tree data object with max estimate of the climate envelope</p>
</td></tr>
<tr><td><code id="nodeEstimateEnvelopes_+3A_fossils">fossils</code></td>
<td>
<p>a matrix with three columns of age, longitude, and latitude, in that order, and rows that are entries for fossil occurrences.</p>
</td></tr>
<tr><td><code id="nodeEstimateEnvelopes_+3A_fossils.edges">fossils.edges</code></td>
<td>
<p>the edge number that the fossil occurs on</p>
</td></tr>
<tr><td><code id="nodeEstimateEnvelopes_+3A_model">model</code></td>
<td>
<p>the model of evolution to use in the ancestral state reconstruction. Options are &quot;estimate&quot;, &quot;BM&quot;, &quot;OU&quot;, &quot;EB&quot;, &quot;lambda&quot;, &quot;kappa&quot;, &quot;delta&quot;.</p>
</td></tr>
<tr><td><code id="nodeEstimateEnvelopes_+3A_bounds">bounds</code></td>
<td>
<p>bounds used for the model, passes to <code>fitContinuous()</code>, uses default if none specified.</p>
</td></tr>
<tr><td><code id="nodeEstimateEnvelopes_+3A_control">control</code></td>
<td>
<p>setting used for optimization of the model likelihood. Passes to <code>fitContinuous()</code>.</p>
</td></tr>
<tr><td><code id="nodeEstimateEnvelopes_+3A_use.paleoclimate">use.paleoclimate</code></td>
<td>
<p>if left blank, default North America paleoclimate data is used. If FALSE, user submitted paleoclimate must be provided</p>
</td></tr>
<tr><td><code id="nodeEstimateEnvelopes_+3A_paleoclimateuser">paleoclimateUser</code></td>
<td>
<p>list of data frames with paleoclimates, must be dataframes with columns: GlobalID, Longitude, Latitude, bio1, bio2,...,bio19. (see <code>getBioclimvars()</code>).</p>
</td></tr>
<tr><td><code id="nodeEstimateEnvelopes_+3A_layerage">layerAge</code></td>
<td>
<p>vector with the ages of the paleoclimate dataframes, if using user submitted paleoclimate data</p>
</td></tr>
<tr><td><code id="nodeEstimateEnvelopes_+3A_which.biovars">which.biovars</code></td>
<td>
<p>A vector of the numbers of the bioclimate variables that should be returned. The bioclimate variables number correspond to the Hijmans table at (https://www.worldclim.org/data/bioclim.html).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>function adds fossils to trees according to <code>addFossil()</code>, then passes to <code>nodeEstimate()</code>.
</p>


<h3>Value</h3>

<p>an object of the class &quot;nodeEstimate&quot;.
</p>
<p><code>model</code>    if model = &quot;estimate&quot;, the best fit model of evolution. If the model was specified, then model is the specified model.
</p>
<p><code>est</code>      the ancestral node estimates of the continuous character.
</p>
<p><code>phy</code>      the phylogeny used for the estimates, which might be transformed depending on the evolutionary model.
</p>
<p><code>BM</code>       if model = &quot;BM&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;BM&quot;
</p>
<p><code>OU</code>       if model = &quot;OU&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;OU&quot;
</p>
<p><code>EB</code>       if model = &quot;EB&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;EB&quot;
</p>
<p><code>lambda</code>   if model = &quot;lambda&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;lambda&quot;
</p>
<p><code>kappa</code>    if model = &quot;kappa&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;kappa&quot;
</p>
<p><code>delta</code>    if model = &quot;delta&quot;, returned values from <code>fitContinuous()</code> where the model is &quot;delta&quot;
</p>
<p><code>fitted</code>   if model = &quot;estimate&quot;, returned values from the best fit model of evolution.
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard
</p>


<h3>See Also</h3>

<p><code>nodeEstimate</code>, <code>fitContinuous</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
sampletrees &lt;- sample(sampletrees,5)
data(occurrences)
occu &lt;- getBioclimVars(occurrences, which.biovars=c(1,2))
sp_data_min&lt;-sapply(4:5,function(x) tapply(occu[,x],occu$Species,min))
sp_data_max&lt;-sapply(4:5,function(x) tapply(occu[,x],occu$Species,max))
ex_min &lt;- geiger::treedata(sampletrees[[1]], sp_data_min, sort=TRUE)
ex_max &lt;- geiger::treedata(sampletrees[[1]], sp_data_max, sort=TRUE)
colnames(ex_min$data)&lt;- colnames(ex_max$data)&lt;-c("bio1","bio2")  #labels biovars
nodeest&lt;- nodeEstimateEnvelopes(treedata_min=ex_min,treedata_max=ex_max, 
model="BM",which.biovars=c(1,2),
bounds=list(sigsq = c(min = 0, max = 1000000)))
</code></pre>

<hr>
<h2 id='occurrences'>Sceloporus occurrence data</h2><span id='topic+occurrences'></span>

<h3>Description</h3>

<p>Occurrences for Sceloporus, as collected for Lawing et al 2016. Occurrence records from GBIF, and vetted using expert range maps from IUCN. See reference for further details
Lawing et al (2015) Including fossils in phylogenetic climate reconstructions: A deep time perspective on the climatic niche evolution and diversification of spiny lizards (Sceloporus)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>occurrences
</code></pre>


<h3>Format</h3>

<p>'occurrences'
A data frame of Sceloporus occurrence records
</p>

<dl>
<dt>Species</dt><dd><p>Species name</p>
</dd>
<dt>Longitude</dt><dd><p>Longitude of occurrence</p>
</dd>
<dt>Latitude</dt><dd><p>Latitude of occurence</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://www.journals.uchicago.edu/doi/10.1086/687202&gt;
</p>

<hr>
<h2 id='paleoclimate'>Paleoclimate Data for ppgm examples</h2><span id='topic+paleoclimate'></span>

<h3>Description</h3>

<p>North America paleoclimate data used for running ppgm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paleoclimate
</code></pre>


<h3>Format</h3>

<p>'paleoclimate'
A large list of paleoclimates for North America, each element in the list contains a data frame for one time period, from present to 20mya
</p>

<dl>
<dt>GlobalID</dt><dd><p>Global ID references for location</p>
</dd>
<dt>Longitude</dt><dd><p>Longitude of location</p>
</dd>
<dt>Latitude</dt><dd><p>Latitude of location</p>
</dd>
<dt>bio1</dt><dd><p>Value for bioclimatic variable 1: annual mean temperature</p>
</dd>
<dt>bio2</dt><dd><p>Value for bioclimatic variable 2: mean diurnal range</p>
</dd>
<dt>bio3</dt><dd><p>Value for bioclimatic variable 3: isothermality</p>
</dd>
<dt>bio4</dt><dd><p>Value for bioclimatic variable 2: temperature seasonality</p>
</dd>
<dt>bio5</dt><dd><p>Value for bioclimatic variable 2: max temp of warmest month</p>
</dd>
<dt>bio6</dt><dd><p>Value for bioclimatic variable 2: min temp of coldest month</p>
</dd>
<dt>bio7</dt><dd><p>Value for bioclimatic variable 2: temperature annual range</p>
</dd>
<dt>bio8</dt><dd><p>Value for bioclimatic variable 2: mean temp of wettest quarter</p>
</dd>
<dt>bio9</dt><dd><p>Value for bioclimatic variable 2: mean temp of driest quarter</p>
</dd>
<dt>bio10</dt><dd><p>Value for bioclimatic variable 2: mean temp of warmest quarter</p>
</dd>
<dt>bio11</dt><dd><p>Value for bioclimatic variable 2: mean temp of coldest quarter</p>
</dd>
<dt>bio12</dt><dd><p>Value for bioclimatic variable 2: annual precipitation</p>
</dd>
<dt>bio13</dt><dd><p>Value for bioclimatic variable 2: precipitation of wettest month</p>
</dd>
<dt>bio14</dt><dd><p>Value for bioclimatic variable 2: precipitation of the driest month</p>
</dd>
<dt>bio15</dt><dd><p>Value for bioclimatic variable 2: precipitation seasonality</p>
</dd>
<dt>bio16</dt><dd><p>Value for bioclimatic variable 2: precipitation of the wettest quarter</p>
</dd>
<dt>bio17</dt><dd><p>Value for bioclimatic variable 2: precipitation of the driest quarter</p>
</dd>
<dt>bio18</dt><dd><p>Value for bioclimatic variable 2: precipitation of the warmest quarter</p>
</dd>
<dt>bio19</dt><dd><p>Value for bioclimatic variable 2: precipitation of the coldest quarter</p>
</dd>
</dl>


<hr>
<h2 id='plotAnimatedPPGM'>plotAnimatedPPGM</h2><span id='topic+plotAnimatedPPGM'></span>

<h3>Description</h3>

<p>This function creates an animated gif showing the change in modelled suitable habitat through time in geographic space.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAnimatedPPGM(envelope, tree, filename="ppgm.gif", which.biovars, 
path="", use.paleoclimate=TRUE, paleoclimateUser=NULL, layerAge=c(0:20))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAnimatedPPGM_+3A_envelope">envelope</code></td>
<td>
<p>the min and max envelope of each lineage for each time slice</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGM_+3A_tree">tree</code></td>
<td>
<p>the phylogeny or multiple phylogenies that show the relationship between species</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGM_+3A_filename">filename</code></td>
<td>
<p>desired filename of output</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGM_+3A_which.biovars">which.biovars</code></td>
<td>
<p>A vector of the numbers of the bioclimate variables that should be returned. The bioclimate variables number correspond to the Hijmans table at (https://www.worldclim.org/data/bioclim.html).</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGM_+3A_path">path</code></td>
<td>
<p>path to the directory where the results should be saved</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGM_+3A_use.paleoclimate">use.paleoclimate</code></td>
<td>
<p>if left blank, default North America paleoclimate data is used. If FALSE, user submitted paleoclimate must be provided</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGM_+3A_paleoclimateuser">paleoclimateUser</code></td>
<td>
<p>list of data frames with paleoclimates, must be dataframes with columns: GlobalID, Longitude, Latitude, bio1, bio2,...,bio19. (see <code>getBioclimvars()</code>).</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGM_+3A_layerage">layerAge</code></td>
<td>
<p>vector with the ages of the paleoclimate dataframes, if using user submitted paleoclimate data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Requires ImageMagick or GraphicsMagick to be installed on the operating system. This is easy to do if you have macports. Just type sudo port install ImageMagick into terminal.
</p>


<h3>Value</h3>

<p>An animated gif of species through time
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard, Maria-Aleja Hurtado-Materon
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
tree &lt;- sampletrees[[25]]
biooccu &lt;- getBioclimVars(occurrences, which.biovars=1)
sp_data_min&lt;- tapply(biooccu[,4],biooccu$Species,min)
sp_data_max&lt;- tapply(biooccu[,4],biooccu$Species,max)
treedata_min &lt;- geiger::treedata(tree,sp_data_min,sort=TRUE,warnings=F)
treedata_max &lt;- geiger::treedata(tree,sp_data_max,sort=TRUE,warnings=F)
## Not run: full_est &lt;- nodeEstimateEnvelopes(treedata_min,treedata_max)
node_est &lt;- full_est$est
example_getEnvelopes &lt;- getEnvelopes(treedata_min, treedata_max, node_est)
animatedplot &lt;- plotAnimatedPPGM(example_getEnvelopes,tree,which.biovars=1,path=tempdir())
## End(Not run)
</code></pre>

<hr>
<h2 id='plotAnimatedPPGMMultiPhylo'>plotAnimatedPPGMMultiPhylo</h2><span id='topic+plotAnimatedPPGMMultiPhylo'></span>

<h3>Description</h3>

<p>This function creates an animated gif showing the change in modeled suitable habitat through time in geographic space. It requires ImageMagick or GraphicsMagick to be previously installed in the operating system. This is easy to do if you have macports. Just type sudo port install ImageMagick into terminal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAnimatedPPGMMultiPhylo(envelope, tree, filename="ppgm.gif", 
which.biovars, path="", use.paleoclimate=TRUE, paleoclimateUser=NULL, layerAge=c(0:20))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAnimatedPPGMMultiPhylo_+3A_envelope">envelope</code></td>
<td>
<p>the min and max envelope of each lineage for each time slice</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGMMultiPhylo_+3A_tree">tree</code></td>
<td>
<p>the phylogeny or multiple phylogenies that show the relationship between species</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGMMultiPhylo_+3A_filename">filename</code></td>
<td>
<p>filename of output</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGMMultiPhylo_+3A_which.biovars">which.biovars</code></td>
<td>
<p>A vector of the numbers of the bioclimate variables that should be returned. The bioclimate variables number correspond to the Hijmans table at (https://www.worldclim.org/data/bioclim.html).</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGMMultiPhylo_+3A_path">path</code></td>
<td>
<p>path to the directory where the results should be saved</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGMMultiPhylo_+3A_use.paleoclimate">use.paleoclimate</code></td>
<td>
<p>if left blank, default North America paleoclimate data is used. If FALSE, user submitted paleoclimate must be provided</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGMMultiPhylo_+3A_paleoclimateuser">paleoclimateUser</code></td>
<td>
<p>list of data frames with paleoclimates, must be dataframes with columns: GlobalID, Longitude, Latitude, bio1, bio2,...,bio19. (see <code>getBioclimvars()</code>).</p>
</td></tr>
<tr><td><code id="plotAnimatedPPGMMultiPhylo_+3A_layerage">layerAge</code></td>
<td>
<p>vector with the ages of the paleoclimate dataframes, if using user submitted paleoclimate data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Requires ImageMagick or GraphicsMagick to be installed on the operating system. This is easy to do if you have macports. Just type sudo port install ImageMagick into terminal.
</p>


<h3>Value</h3>

<p>An animated gif of species through time
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
sampletrees &lt;- sample(sampletrees,5)
biooccu &lt;- getBioclimVars(occurrences, which.biovars=1)
sp_data_min&lt;- tapply(biooccu[,4],biooccu$Species,min)
sp_data_max&lt;- tapply(biooccu[,4],biooccu$Species,max)
treedata_min &lt;- treedata_max &lt;- node_est &lt;- envelope &lt;- list()
## Not run: for (tr in 1:length(sampletrees)){
  treedata_min[[tr]] &lt;- geiger::treedata(sampletrees[[tr]],sp_data_min,sort=TRUE,warnings=F)
  treedata_max[[tr]] &lt;- geiger::treedata(sampletrees[[tr]],sp_data_max,sort=TRUE,warnings=F)
  full_est &lt;- nodeEstimateEnvelopes(treedata_min[[tr]],treedata_max[[tr]])
  node_est[[tr]] &lt;- full_est$est
  envelope[[tr]] &lt;- getEnvelopes(treedata_min[[tr]], treedata_max[[tr]], node_est[[tr]])
}
animatedplot &lt;- plotAnimatedPPGMMultiPhylo(envelope,sampletrees,which.biovars=1, path=tempdir())
## End(Not run)
</code></pre>

<hr>
<h2 id='plotGeoRates'>plotGeoRates</h2><span id='topic+plotGeoRates'></span>

<h3>Description</h3>

<p>plotGeoRates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotGeoRates(geo_center, geo_size, time_int, trees, path="")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotGeoRates_+3A_geo_center">geo_center</code></td>
<td>
<p>change in geographic center of suitable climate envelope, see</p>
</td></tr>
<tr><td><code id="plotGeoRates_+3A_geo_size">geo_size</code></td>
<td>
<p>change in geographic size of suitable climate envelope</p>
</td></tr>
<tr><td><code id="plotGeoRates_+3A_time_int">time_int</code></td>
<td>
<p>time intervals to plot</p>
</td></tr>
<tr><td><code id="plotGeoRates_+3A_trees">trees</code></td>
<td>
<p>distribution of phylogenies</p>
</td></tr>
<tr><td><code id="plotGeoRates_+3A_path">path</code></td>
<td>
<p>path to the directory where the results to be saved</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates plot with gray background of all pairwise comparisons of change in geo center and area through time. Blue points on top show the sequential change in geo center and expansion/contraction for all lineages
</p>


<h3>Value</h3>

<p>plots of geo rate
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard
</p>


<h3>See Also</h3>

<p><code>getGeoRates</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
sampletrees &lt;- sample(sampletrees,5)
biooccu &lt;- getBioclimVars(occurrences, which.biovars=1)
sp_data_min&lt;- tapply(biooccu[,4],biooccu$Species,min)
sp_data_max&lt;- tapply(biooccu[,4],biooccu$Species,max)
treedata_min &lt;- treedata_max &lt;- node_est &lt;- envelope &lt;- list()
geo_center&lt;-array(NA,dim=c(100,53,21,21))
geo_size&lt;-array(NA,dim=c(100,53,21,21))
for (tr in 1:length(sampletrees)){
  treedata_min[[tr]] &lt;- geiger::treedata(sampletrees[[tr]],sp_data_min,sort=TRUE,warnings=F)
  treedata_max[[tr]] &lt;- geiger::treedata(sampletrees[[tr]],sp_data_max,sort=TRUE,warnings=F)
  full_est &lt;- nodeEstimateEnvelopes(treedata_min[[tr]],treedata_max[[tr]])
  node_est[[tr]] &lt;- full_est$est
  envelope[[tr]] &lt;- getEnvelopes(treedata_min[[tr]], treedata_max[[tr]], node_est[[tr]])
  temp &lt;- getGeoRate(envelope[[tr]], sampletrees[[tr]], which.biovars=1)
  geo_center[tr,,,]&lt;-temp$geo_center
  geo_size[tr,,,]&lt;-temp$geo_size
}

## Not run: plotGeoRates(geo_center, geo_size, temp$time_int, sampletrees, path="tempdir()")

</code></pre>

<hr>
<h2 id='plotGeoRatesCon'>plotGeoRatesCon</h2><span id='topic+plotGeoRatesCon'></span>

<h3>Description</h3>

<p>plotGeoRatesCon
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotGeoRatesCon(geo_center, geo_size, time_int, trees, path="")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotGeoRatesCon_+3A_geo_center">geo_center</code></td>
<td>
<p>change in geographic center of suitable climate envelope</p>
</td></tr>
<tr><td><code id="plotGeoRatesCon_+3A_geo_size">geo_size</code></td>
<td>
<p>change in geographic size of suitable climate envelope</p>
</td></tr>
<tr><td><code id="plotGeoRatesCon_+3A_time_int">time_int</code></td>
<td>
<p>time intervals to plot</p>
</td></tr>
<tr><td><code id="plotGeoRatesCon_+3A_trees">trees</code></td>
<td>
<p>distribution of phylogenies</p>
</td></tr>
<tr><td><code id="plotGeoRatesCon_+3A_path">path</code></td>
<td>
<p>path to the directory where the results to be saved</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates plot with gray background of all pairwise comparisons of change in geo center and area through time. Blue points on top show the sequential change in geo center and expansion/contraction for all lineages
</p>


<h3>Value</h3>

<p>plots of geo rate
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard
</p>


<h3>See Also</h3>

<p><code>getGeoRates</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
tree &lt;- sampletrees[[25]]
occurrences &lt;- getBioclimVars(occurrences, which.biovars=1)
sp_data_min&lt;- tapply(occurrences[,4],occurrences$Species,min)
sp_data_max&lt;- tapply(occurrences[,4],occurrences$Species,max)
treedata_min &lt;- geiger::treedata(tree,sp_data_min,sort=TRUE,warnings=F)
treedata_max &lt;- geiger::treedata(tree,sp_data_max,sort=TRUE,warnings=F)
full_est &lt;- nodeEstimateEnvelopes(treedata_min,treedata_max)
node_est &lt;- full_est$est
example_getEnvelopes &lt;- getEnvelopes(treedata_min, treedata_max, node_est)
example_getGeoRate &lt;- getGeoRate(example_getEnvelopes, tree,which.biovars=1)

## Not run: plotGeoRatesCon(example_getGeoRate$geo_center,example_getGeoRate$geo_size,
example_getGeoRate$time_int, trees = trees[[1]], path=tempdir())
## End(Not run)
</code></pre>

<hr>
<h2 id='plotTraitGram'>plotTraitGram</h2><span id='topic+plotTraitGram'></span>

<h3>Description</h3>

<p>Combine the node estimates based on random or specified fossil placement and plot them on a phylotraitgram in a specified directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTraitGram(treedata_min, treedata_max, node_est, fossils=FALSE, 
which.biovars, path="", use.paleoclimate=TRUE, paleoclimateUser=NULL,
layerAge=c(0:20))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotTraitGram_+3A_treedata_min">treedata_min</code></td>
<td>
<p>a tree data object with the min estimate of the climate envelope</p>
</td></tr>
<tr><td><code id="plotTraitGram_+3A_treedata_max">treedata_max</code></td>
<td>
<p>a tree data object with the max estimate of the climate envelope</p>
</td></tr>
<tr><td><code id="plotTraitGram_+3A_node_est">node_est</code></td>
<td>
<p>the estimate of all the nodes, both min and max</p>
</td></tr>
<tr><td><code id="plotTraitGram_+3A_fossils">fossils</code></td>
<td>
<p>a matrix with four columns of min age, max age, longitude, and latitude, in that order, and rows that are entries for fossil occurrences.</p>
</td></tr>
<tr><td><code id="plotTraitGram_+3A_which.biovars">which.biovars</code></td>
<td>
<p>A vector of the numbers of the bioclimate variables that should be returned. The bioclimate variables number correspond to the Hijmans table at (https://www.worldclim.org/data/bioclim.html).</p>
</td></tr>
<tr><td><code id="plotTraitGram_+3A_path">path</code></td>
<td>
<p>path to the directory where the results should be saved</p>
</td></tr>
<tr><td><code id="plotTraitGram_+3A_use.paleoclimate">use.paleoclimate</code></td>
<td>
<p>if left blank, default North America paleoclimate data is used. If FALSE, user submitted paleoclimate must be provided</p>
</td></tr>
<tr><td><code id="plotTraitGram_+3A_paleoclimateuser">paleoclimateUser</code></td>
<td>
<p>list of data frames with paleoclimates, must be dataframes with columns: GlobalID, Longitude, Latitude, bio1, bio2,...,bio19. (see <code>getBioclimvars()</code>).</p>
</td></tr>
<tr><td><code id="plotTraitGram_+3A_layerage">layerAge</code></td>
<td>
<p>vector with the ages of the paleoclimate dataframes, if using user submitted paleoclimate data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a trait gram for minimum and maximum of biovariables
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard
</p>


<h3>See Also</h3>

<p>plotTraitGramMultiPhylo
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
bounds &lt;- list(sigsq = c(min = 0, max = 1000000))
ex_mytree &lt;- sampletrees[[3]] #single tree
test_con &lt;- ppgmConsensus(occurrences = occurrences, trees = ex_mytree, 
which.biovars = 1, bounds = bounds, control = list(niter = 20))
## Not run: plotTraitGram(test_con$treedata_min,test_con$treedata_max,test_con$node_est)
</code></pre>

<hr>
<h2 id='plotTraitGramMultiPhylo'>plotTraitGramMultiPhylo</h2><span id='topic+plotTraitGramMultiPhylo'></span>

<h3>Description</h3>

<p>Combine the node estimates based on random or specified fossil placement and plot them on a phylotrait gram in a specified directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTraitGramMultiPhylo(treedata_min, treedata_max, node_est, 
fossils=FALSE, use.paleoclimate=TRUE, paleoclimateUser=NULL, 
layerAge=c(0:20), which.biovars, path="")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotTraitGramMultiPhylo_+3A_treedata_min">treedata_min</code></td>
<td>
<p>tree data object with min estimate of the climate envelope</p>
</td></tr>
<tr><td><code id="plotTraitGramMultiPhylo_+3A_treedata_max">treedata_max</code></td>
<td>
<p>tree data object with max estimate of the climate envelope</p>
</td></tr>
<tr><td><code id="plotTraitGramMultiPhylo_+3A_node_est">node_est</code></td>
<td>
<p>the estimate of all the nodes, both min and max. Must be in format [[trees]][[permut]][2,species,trait]</p>
</td></tr>
<tr><td><code id="plotTraitGramMultiPhylo_+3A_fossils">fossils</code></td>
<td>
<p>a matrix with four columns of min age, max age, longitude, and latitude, in that order, and rows that are entries for fossil occurrences.</p>
</td></tr>
<tr><td><code id="plotTraitGramMultiPhylo_+3A_use.paleoclimate">use.paleoclimate</code></td>
<td>
<p>if left blank, default North America paleoclimate data is used. If FALSE, user submitted paleoclimate must be provided</p>
</td></tr>
<tr><td><code id="plotTraitGramMultiPhylo_+3A_paleoclimateuser">paleoclimateUser</code></td>
<td>
<p>list of data frames with paleoclimates, must be dataframes with columns: GlobalID, Longitude, Latitude, bio1, bio2,...,bio19. (see <code>getBioclimvars()</code>).</p>
</td></tr>
<tr><td><code id="plotTraitGramMultiPhylo_+3A_layerage">layerAge</code></td>
<td>
<p>vector with the ages of the paleoclimate dataframes, if using user submitted paleoclimate data</p>
</td></tr>
<tr><td><code id="plotTraitGramMultiPhylo_+3A_which.biovars">which.biovars</code></td>
<td>
<p>A vector of the numbers of the bioclimate variables that should be returned. The bioclimate variables number correspond to the Hijmans table at (https://www.worldclim.org/data/bioclim.html).</p>
</td></tr>
<tr><td><code id="plotTraitGramMultiPhylo_+3A_path">path</code></td>
<td>
<p>path to the directory where the results should be saved</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plots a traitgram over multiple phylogenetic trees
</p>


<h3>Value</h3>

<p>a trait gram for minimum and maximum of biovariables over a distribution of phylogenetic trees
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard
</p>


<h3>See Also</h3>

<p>plotTraitGram
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
bounds &lt;- list(sigsq = c(min = 0, max = 1000000))
sample &lt;-sample(sampletrees,5)
test_ppgm &lt;- ppgm(occurrences = occurrences,trees = sample, 
model = "BM", which.biovars = c(1), bounds = bounds, 
control = list(niter = 20))
## Not run: plotTraitGramMultiPhylo(test_ppgm$treedata_min,
test_ppgm$treedata_max,test_ppgm$node_est)
## End(Not run)
</code></pre>

<hr>
<h2 id='ppgm'>ppgm</h2><span id='topic+ppgm'></span>

<h3>Description</h3>

<p>ppgm makes a paleophylogeographic species distribution model using the bioclimate envelope method for a specified time period. Currently, models are only available for North America.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppgm(occurrences, fossils = FALSE, trees, fossils.edges = FALSE, 
model = "BM", permut = 1, only.biovars = TRUE, which.biovars = c(1:19), 
path = "", plot.TraitGram = FALSE, plot.AnimatedMaps = FALSE, 
plot.GeoRates = FALSE, bounds = list(), control = list(), 
use.paleoclimate = TRUE, paleoclimateUser = NULL, layerAge=c(0:20), 
verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppgm_+3A_occurrences">occurrences</code></td>
<td>
<p>a matrix with three columns of species name, longitude, and latitude, in that order, and rows that are entries for species occurrences. The bioclimate variables can be included for each occurrence in following columns. They must be in order 1 through 19.</p>
</td></tr>
<tr><td><code id="ppgm_+3A_fossils">fossils</code></td>
<td>
<p>a matrix with four columns of min age, max age, longitude, and latitude, in that order, and rows that are entries for fossil occurrences. The bioclimate variables can be included for each occurrence in following columns. They must be in order 1 through 19. All 19 variables must be included at this stage, variable selection is done with the argument: &quot;which.biovars&quot;.</p>
</td></tr>
<tr><td><code id="ppgm_+3A_trees">trees</code></td>
<td>
<p>phylogenies of species from first column of occurrences argument. Object of class multiphylo.</p>
</td></tr>
<tr><td><code id="ppgm_+3A_fossils.edges">fossils.edges</code></td>
<td>
<p>a vector of edges that the fossils belong to. Must be in the same order of the fossils argument. If fossils.edges is false, the the function randomly assigns the location of the fossils depending on the age (see details for more information).</p>
</td></tr>
<tr><td><code id="ppgm_+3A_model">model</code></td>
<td>
<p>the model of evolution to use to estimate ancestor nodes. Argument is passed onto to function nodeEstimate.</p>
</td></tr>
<tr><td><code id="ppgm_+3A_permut">permut</code></td>
<td>
<p>the number of times to randomly place fossils in phylogeny and estimate ancestor states.</p>
</td></tr>
<tr><td><code id="ppgm_+3A_only.biovars">only.biovars</code></td>
<td>
<p>logical. If FALSE, user must include biovariables in occurrence object.</p>
</td></tr>
<tr><td><code id="ppgm_+3A_which.biovars">which.biovars</code></td>
<td>
<p>a vector with the biovars to include in model (see www.worldclim.org for a list of biovars). If &quot;ALL&quot;, then all 19 biovars are included in analysis.</p>
</td></tr>
<tr><td><code id="ppgm_+3A_path">path</code></td>
<td>
<p>path to the directory where the results should be saved.</p>
</td></tr>
<tr><td><code id="ppgm_+3A_plot.traitgram">plot.TraitGram</code></td>
<td>
<p>logical. Whether to plot a TraitGram</p>
</td></tr>
<tr><td><code id="ppgm_+3A_plot.animatedmaps">plot.AnimatedMaps</code></td>
<td>
<p>logical. Whether to plot AnimatedMaps. Requires ImageMagick to be installed on the system.</p>
</td></tr>
<tr><td><code id="ppgm_+3A_plot.georates">plot.GeoRates</code></td>
<td>
<p>logical. Whether to plot GeoRates</p>
</td></tr>
<tr><td><code id="ppgm_+3A_bounds">bounds</code></td>
<td>
<p>parameters for the evolutionary model selected. If none are supplied the default is used</p>
</td></tr>
<tr><td><code id="ppgm_+3A_control">control</code></td>
<td>
<p>settings used for optimisation of model likelihood. Passes to <code>geiger::fitContinuous</code></p>
</td></tr>
<tr><td><code id="ppgm_+3A_use.paleoclimate">use.paleoclimate</code></td>
<td>
<p>if left blank, default North America paleoclimate data is used. If FALSE, user submitted paleoclimate must be provided</p>
</td></tr>
<tr><td><code id="ppgm_+3A_paleoclimateuser">paleoclimateUser</code></td>
<td>
<p>list of data frames with paleoclimates, must be dataframes with columns: GlobalID, Longitude, Latitude, bio1, bio2,...,bio19.</p>
</td></tr>
<tr><td><code id="ppgm_+3A_layerage">layerAge</code></td>
<td>
<p>vector with the ages of the paleoclimate dataframes, if using user submitted paleoclimate data</p>
</td></tr>
<tr><td><code id="ppgm_+3A_verbose">verbose</code></td>
<td>
<p>default true, returns all outputs. If FALSE then returns only climate envelopes and geographic data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the 19 bioclimate variables are not supplied with the occurrences or with the fossils, they will be extracted from the closest 50km point location in the modern or paleoclimate maps that are loaded in with this function. The paleoclimate maps are isotopically scaled between general circulation models (see Lawing and Polly 2011; Rodder et al. 2013) and modern climate (see Hijmans et al. 2005). The fossils paleoclimate data is extracted to the closest million year paleoclimate map. Paleoclimate maps are derived at one million year intervals for the past 20 Ma. The tree (phylogeny) should be dichotomous and the species names should match the names in the first column of the occurrences argument.
</p>


<h3>Value</h3>

<p><code>cem</code> Estimate of climate envelope for each species in present time. A data frame containing species and min mean and max of biovars specified with <code>which.biovars</code>.
</p>
<p><code>geo_move</code> data frame of RateGeoCenter and RateGeoSize
</p>
<p><code>change_geo_center</code> array of change in geographic center of suitable climate for each lineage
</p>
<p><code>change_geo_size</code> array of change in geographic size of suitable climate for each lineage
</p>
<p><code>time_int</code> matrix array of time intervals
</p>
<p><code>treedata_min</code> list of trees with minimum bioclimatic variables
</p>
<p><code>treedata_max</code> list of trees with maximum bioclimatic variables
</p>
<p><code>model_min</code> list of trees with minimum fitted model as specified in <code>model</code>
</p>
<p><code>model_max</code> list of trees with maximum fitted model as specified in <code>model</code>
</p>
<p><code>node_est</code> list of traits at each node for all trees, min and max for each species. As estimated by nodeEstimate and nodeEstimateEnvelopes
</p>
<p><code>aicmin</code> if model is estimated, table of aic values for minimum trait values for all trees
</p>
<p><code>aicmax</code> if model is estimated, table of aic values for maximum trait values for all trees
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard, Maria A. Hurtado-Materon
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
bounds &lt;- list(sigsq = c(min = 0, max = 1000000))
test_ppgm &lt;- ppgm(occurrences = occurrences,trees = sampletrees, 
model = "BM", which.biovars = c(1), bounds = bounds, 
control = list(niter = 20))
</code></pre>

<hr>
<h2 id='ppgmConsensus'>ppgmConsensus</h2><span id='topic+ppgmConsensus'></span>

<h3>Description</h3>

<p>ppgm makes a paleophylogeographic species distribution model using the bioclimate envelope method for a specified time period. consensus version
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppgmConsensus(occurrences, fossils = FALSE, trees, 
fossils.edges = FALSE, model = "BM", permut = 1, only.biovars = TRUE, 
which.biovars = c(1:19), path = "", plot.TraitGram = FALSE, 
plot.AnimatedMaps = FALSE, plot.GeoRates = FALSE, bounds = list(), 
control = list(), use.paleoclimate = TRUE, paleoclimateUser = NULL, 
layerAge = c(0:20), verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppgmConsensus_+3A_occurrences">occurrences</code></td>
<td>
<p>a matrix with three columns of species name, longitude, and latitude, in that order, and rows that are entries for species occurrences. The bioclimate variables can be included for each occurrence in following columns. They must be in order 1 through 19.</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_fossils">fossils</code></td>
<td>
<p>a matrix with four columns of min age, max age, longitude, and latitude, in that order, and rows that are entries for fossil occurrences. The bioclimate variables can be included for each occurrence in following columns. They must be in order 1 through 19. All 19 variables must be included at this stage, variable selection is done with the argument: &quot;which.biovars&quot;.</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_trees">trees</code></td>
<td>
<p>phylogeny of species from first column of occurrences argument. Object of class phylo.</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_fossils.edges">fossils.edges</code></td>
<td>
<p>a vector of edges that the fossils belong to. Must be in the same order of the fossils argument. If fossils.edges is false, the the function randomly assigns the location of the fossils depending on the age (see details for more information).</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_model">model</code></td>
<td>
<p>the model of evolution to use to estimate ancestor nodes. Argument is passed onto to function nodeEstimate.</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_permut">permut</code></td>
<td>
<p>the number of times to randomly place fossils in phylogeny and estimate ancestor states.</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_only.biovars">only.biovars</code></td>
<td>
<p>logical. If FALSE, user must include biovariables in occurrence object.</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_which.biovars">which.biovars</code></td>
<td>
<p>a vector with the biovars to include in model (see www.worldclim.org for a list of biovars). If &quot;ALL&quot;, then all 19 biovars are included in analysis.</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_path">path</code></td>
<td>
<p>path to the directory where the results should be saved.</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_plot.traitgram">plot.TraitGram</code></td>
<td>
<p>logical. Whether to plot a TraitGram</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_plot.animatedmaps">plot.AnimatedMaps</code></td>
<td>
<p>Logical. Whether to plot AnimatedMaps. Requires ImageMagick to be installed on the system.</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_plot.georates">plot.GeoRates</code></td>
<td>
<p>logical. Whether to plot GeoRates</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_bounds">bounds</code></td>
<td>
<p>parameters for the evolutionary model selected. If none are supplied the default is used</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_control">control</code></td>
<td>
<p>settings used for optimisation of model likelihood. Passes to <code>geiger::fitContinuous</code></p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_use.paleoclimate">use.paleoclimate</code></td>
<td>
<p>if left blank, default North America paleoclimate data is used. If FALSE, user submitted paleoclimate must be provided</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_paleoclimateuser">paleoclimateUser</code></td>
<td>
<p>list of data frames with paleoclimates, must be dataframes with columns: GlobalID, Longitude, Latitude, bio1, bio2,...,bio19.</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_layerage">layerAge</code></td>
<td>
<p>vector with the ages of the paleoclimate dataframes, if using user submitted paleoclimate data</p>
</td></tr>
<tr><td><code id="ppgmConsensus_+3A_verbose">verbose</code></td>
<td>
<p>default true, returns all outputs. If FALSE then returns only climate envelopes and geographic data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the 19 bioclimate variables are not supplied with the occurrences or with the fossils, they will be extracted from the closest 50km point location in the modern or paleoclimate maps that are loaded in with this function. The paleoclimate maps are isotopically scaled between general circulation models (see Lawing and Polly 2011; Rodder et al. 2013) and modern climate (see Hijmans et al. 2005). The fossils paleoclimate data is extracted to the closest million year paleoclimate map. Paleoclimate maps are derived at one million year intervals for the past 20 Ma. The tree (phylogeny) should be dichotomous and the species names should match the names in the first column of the occurrences argument.
</p>


<h3>Value</h3>

<p><code>cem</code> Estimate of climate envelope for each species in present time. A data frame containing species and min mean and max of biovars specified with <code>which.biovars</code>.
</p>
<p><code>geo_move</code> data frame of RateGeoCenter and RateGeoSize
</p>
<p><code>change_geo_center</code> array of change in geographic center of suitable climate for each lineage
</p>
<p><code>change_geo_size</code> array of change in geographic size of suitable climate for each lineage
</p>
<p><code>time_int</code> matrix array of time intervals
</p>
<p><code>treedata_min</code> list of trees with minimum bioclimatic variables
</p>
<p><code>treedata_max</code> list of trees with maximum bioclimatic variables
</p>
<p><code>node_est</code> list of traits at each node for all trees, min and max for each species. As estimated by nodeEstimate and nodeEstimateEnvelopes
</p>
<p><code>aicmin</code> if model is estimated, table of aic values for minimum trait values
</p>
<p><code>aicmax</code> if model is estimated, table of aic values for maximum trait values
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard, Maria A. Hurtado-Materon
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
data(scel_fossils)
bounds &lt;- list(sigsq = c(min = 0, max = 1000000))
ex_mytree &lt;- sampletrees[[3]] #single tree
test_fossil_con &lt;- ppgmConsensus(occurrences = occurrences, 
fossils = scel_fossils, trees = ex_mytree, fossils.edges = FALSE, model = "BM", 
permut = 5, which.biovars = 1, bounds = bounds, control = list(niter = 20))
</code></pre>

<hr>
<h2 id='ppgmMESS'>ppgmMESS</h2><span id='topic+ppgmMESS'></span>

<h3>Description</h3>

<p>This creates a MESS map for given time slices, climate envelopes, and paleoclimate models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppgmMESS(cem_min, cem_max, est, tree, fossils=NULL, timeslice, 
which.biovars, path = "", use.paleoclimate=TRUE, paleoclimateUser = NULL, 
layerAge=c(0:20), which.plot = c("all","mess","none"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppgmMESS_+3A_cem_min">cem_min</code></td>
<td>
<p>the cem min output from the ppgm function. cbind() if there are multiple variables.</p>
</td></tr>
<tr><td><code id="ppgmMESS_+3A_cem_max">cem_max</code></td>
<td>
<p>the cem max output from the ppgm function. cbind() if there are multiple variables.</p>
</td></tr>
<tr><td><code id="ppgmMESS_+3A_est">est</code></td>
<td>
<p>the node_est output from the ppgm function, in list format. [tree][1][min and max][no.of species]</p>
</td></tr>
<tr><td><code id="ppgmMESS_+3A_tree">tree</code></td>
<td>
<p>the phylogeny or multiple phylogenies that show the relationship between species</p>
</td></tr>
<tr><td><code id="ppgmMESS_+3A_fossils">fossils</code></td>
<td>
<p>a matrix with four columns of age to the closest million year integer, longitude, and latitude, in that order, and rows that are entries for fossil occurrences.</p>
</td></tr>
<tr><td><code id="ppgmMESS_+3A_timeslice">timeslice</code></td>
<td>
<p>the time in million of years ago to project MESS maps (0 to 20). can handle single timeslice or vector of times.</p>
</td></tr>
<tr><td><code id="ppgmMESS_+3A_which.biovars">which.biovars</code></td>
<td>
<p>the biovariable number(s) between 1 and 19.</p>
</td></tr>
<tr><td><code id="ppgmMESS_+3A_path">path</code></td>
<td>
<p>directory where plots should be stored</p>
</td></tr>
<tr><td><code id="ppgmMESS_+3A_use.paleoclimate">use.paleoclimate</code></td>
<td>
<p>if left blank, default North America paleoclimate data is used. If FALSE, user submitted paleoclimate must be provided</p>
</td></tr>
<tr><td><code id="ppgmMESS_+3A_paleoclimateuser">paleoclimateUser</code></td>
<td>
<p>list of data frames with paleoclimates, must be dataframes with columns: GlobalID, Longitude, Latitude, bio1, bio2,...,bio19.</p>
</td></tr>
<tr><td><code id="ppgmMESS_+3A_layerage">layerAge</code></td>
<td>
<p>vector with the ages of the paleoclimate dataframes, if using user submitted paleoclimate data</p>
</td></tr>
<tr><td><code id="ppgmMESS_+3A_which.plot">which.plot</code></td>
<td>
<p>&quot;all&quot; plots trait maps and MESS, &quot;mess&quot; plots MESS map, &quot;none&quot; does not plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plots MESS maps of climate envelope model for specific time slices. Can either plot individual biovariables, or combined.
</p>


<h3>Value</h3>

<p>list containing array of MESS scores for bioclimatic variables
</p>


<h3>Author(s)</h3>

<p>A. Michelle Lawing, Alexandra F. C. Howard, Maria-Aleja Hurtado-Materon
</p>


<h3>See Also</h3>

<p><code>ppgm()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sampletrees)
data(occurrences)
sampletrees &lt;- sample(sampletrees,5)
bounds &lt;- list(sigsq = c(min = 0, max = 1000000))
test_ppgm &lt;- ppgm(occurrences = occurrences,trees = sampletrees, 
model = "BM", which.biovars = c(1,4,15), bounds = bounds, 
control = list(niter = 20))
#extract min climate envelope for species
cem_min &lt;- cbind(test_ppgm$cem[, 1], test_ppgm$cem[, 2], test_ppgm$cem[, 3])
cem_max &lt;- cbind(test_ppgm$cem[, 7], test_ppgm$cem[, 8], test_ppgm$cem[, 9])
rownames(cem_min) &lt;- rownames(cem_max) &lt;- rownames(test_ppgm$cem)
mess &lt;- ppgmMESS(cem_min,cem_max,test_ppgm$node_est,tree=sampletrees,timeslice=10,
which.biovars=c(1,4,15), path=tempdir(), which.plot="none")
</code></pre>

<hr>
<h2 id='sampletrees'>Sample of Sceloporus phylogenies</h2><span id='topic+sampletrees'></span>

<h3>Description</h3>

<p>A sample of 100 dated phylogenies from Leache &amp; Sites (2010), trimmed for analysis by Lawing et al (2016)
Lawing et al (2016) Including fossils in phylogenetic climate reconstructions: A deep time perspective on the climatic niche evolution and diversification of spiny lizards (Sceloporus)
Leache &amp; Sites (2010) Chromosome evolution and diversification in North American Spiny Lizards (Genus Sceloporus)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampletrees
</code></pre>


<h3>Format</h3>

<p>'sampletrees'
100 trees as class multiPhylo
</p>


<h3>Source</h3>

<p>&lt;https://www.journals.uchicago.edu/doi/10.1086/687202&gt;
</p>
<p>&lt;https://karger.com/cgr/article/127/2-4/166/62387/Chromosome-Evolution-and-Diversification-in-North&gt;
</p>

<hr>
<h2 id='scel_fossils'>Sceloporus fossil data</h2><span id='topic+scel_fossils'></span>

<h3>Description</h3>

<p>Fossil occurrences for Sceloporus, as collected for Lawing et al 2016. Occurrence records from Paleobiology Database. See reference for further details
Lawing et al (2016) Including fossils in phylogenetic climate reconstructions: A deep time perspective on the climatic niche evolution and diversification of spiny lizards (Sceloporus)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scel_fossils
</code></pre>


<h3>Format</h3>

<p>'scel_fossils'
A data frame where each row is a single fossil
</p>

<dl>
<dt>MinAge</dt><dd><p>Minimum age of fossil</p>
</dd>
<dt>MaxAge</dt><dd><p>Maximum age of fossil</p>
</dd>
<dt>Longitude</dt><dd><p>Longitude of occurrence</p>
</dd>
<dt>Latitude</dt><dd><p>Latitude of occurence</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://www.journals.uchicago.edu/doi/10.1086/687202&gt;
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
