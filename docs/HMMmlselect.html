<!DOCTYPE html><html><head><title>Help for package HMMmlselect</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HMMmlselect}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#HMMmlselect-package'><p>Determine the number of states</p>
in hidden Markov models via marginal likelihood</a></li>
<li><a href='#check_para_validity'><p>check_para_validity</p></a></li>
<li><a href='#estimateNormalizingConst'><p>estimateNormalizingConst</p></a></li>
<li><a href='#find_importance_function'><p>find_importance_function</p></a></li>
<li><a href='#find_index_local_region'><p>find_index_local_region</p></a></li>
<li><a href='#HMMfit'><p>HMMfit</p></a></li>
<li><a href='#HMMfitting'><p>HMMfitting</p></a></li>
<li><a href='#HMMll'><p>HMMll</p></a></li>
<li><a href='#HMMmlestimate'><p>HMMmlestimate</p></a></li>
<li><a href='#HMMmlselect'><p>HMMmlselect</p></a></li>
<li><a href='#HMMrepsim'><p>HMMrepsim</p></a></li>
<li><a href='#HMMsim'><p>HMMsim</p></a></li>
<li><a href='#HMMsimulate'><p>HMMsimulate</p></a></li>
<li><a href='#ll_un_normalized_hmm_gm'><p>ll_un_normalized_hmm_gm</p></a></li>
<li><a href='#logmvNormdensity'><p>logmvNormdensity</p></a></li>
<li><a href='#logmvTdensity'><p>logmvTdensity</p></a></li>
<li><a href='#multivariate_mixture_density'><p>multivariate_mixture_density</p></a></li>
<li><a href='#PlotHMM'><p>PlotHMM</p></a></li>
<li><a href='#RobustBIC'><p>RobustBIC</p></a></li>
<li><a href='#sample_mixture'><p>sample_mixture</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Determine the Number of States in Hidden Markov Models via
Marginal Likelihood</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.6</td>
</tr>
<tr>
<td>Author:</td>
<td>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and S. C. Kou.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chu-Lan Michael Kao &lt;chulankao@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provide functions to make estimate the number of states for a hidden Markov 
    model (HMM) using marginal likelihood method proposed by the authors.
    See the Manual.pdf file a detail description of all functions, and a detail tutorial.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>HiddenMarkov, mclust, mvtnorm, stats, MCMCpack, Rcpp (&ge;
0.12.10)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-03 03:50:31 UTC; USER</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-03 05:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='HMMmlselect-package'>Determine the number of states
in hidden Markov models via marginal likelihood</h2><span id='topic+HMMmlselect-package'></span>

<h3>Description</h3>

<p>(See the Manual.pdf file in &quot;inst/extdata&quot;&quot; folder for a detail description of all functions, and a detail tutorial.)
</p>
<p>This packages provides function to estimate the number of states in a Hidden Markov model (HMM) using the  marginal likelihood method proposed by Chen, Fuh, Kao and Kou (2019+), which we would denoted as HMMml2017 afterward. <code>HMMmlselect</code> estimates the number of states, and <code>PlotHMM</code> plots. Other related functions are also provided.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> HMMmlselect</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-2-08</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou
</p>
<p>Maintainer: Chu-Lan Michael Kao &lt;chulankao@gmail.com&gt;
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(HMMmlselect)

# simulate a 25 observations HMM
obs = HMMsim ( n = 25 )$obs

# perform order selection and estimation
results = HMMmlselect ( y = obs, list(Kfits = c(2,3), boolUseMclust = FALSE) )

# visualize the results, see figure 1
PlotHMM ( y = obs, results )
</code></pre>

<hr>
<h2 id='check_para_validity'>check_para_validity</h2><span id='topic+check_para_validity'></span>

<h3>Description</h3>

<p>Auxiliary function that checks whether the parameter set is suitable for HMM/Gaussian mixture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_para_validity(parameters_in_matrix_form, bool_hmm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_para_validity_+3A_parameters_in_matrix_form">parameters_in_matrix_form</code></td>
<td>
<p>The parameters to be checked.</p>
</td></tr>
<tr><td><code id="check_para_validity_+3A_bool_hmm">bool_hmm</code></td>
<td>
<p>1 for HMM. 0 for Gaussian mixture.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the logical value of whether the parameter set is suitable for HMM/Gaussian mixture.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='estimateNormalizingConst'>estimateNormalizingConst</h2><span id='topic+estimateNormalizingConst'></span>

<h3>Description</h3>

<p>Auxiliary function that approximate the normalizing constant. Used when approximating marginal likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateNormalizingConst(SampDens, boolHMM, dft, RIS, IS, NsmpResmp, llUn, Mclust = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimateNormalizingConst_+3A_sampdens">SampDens</code></td>
<td>
<p>The sample and density </p>
</td></tr>
<tr><td><code id="estimateNormalizingConst_+3A_boolhmm">boolHMM</code></td>
<td>
<p>Number that controls the method.</p>
</td></tr>
<tr><td><code id="estimateNormalizingConst_+3A_dft">dft</code></td>
<td>
<p>Degree of freedom used in the t-distribution.</p>
</td></tr>
<tr><td><code id="estimateNormalizingConst_+3A_ris">RIS</code></td>
<td>
<p>RIS in the algorithm.</p>
</td></tr>
<tr><td><code id="estimateNormalizingConst_+3A_is">IS</code></td>
<td>
<p>IS in the algorithm.</p>
</td></tr>
<tr><td><code id="estimateNormalizingConst_+3A_nsmpresmp">NsmpResmp</code></td>
<td>
<p>Number of resampling used in the algorithm.</p>
</td></tr>
<tr><td><code id="estimateNormalizingConst_+3A_llun">llUn</code></td>
<td>
<p>Unnormalized log likelihood.</p>
</td></tr>
<tr><td><code id="estimateNormalizingConst_+3A_mclust">Mclust</code></td>
<td>
<p>Auxiliary variable. Set to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the approximated normalizing constant.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='find_importance_function'>find_importance_function</h2><span id='topic+find_importance_function'></span>

<h3>Description</h3>

<p>Auxiliary function that computes the importance weight used in approximate the normalizing constant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_importance_function(x, boolUseMclust)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_importance_function_+3A_x">x</code></td>
<td>
<p>The data that the importance weight is computed on.</p>
</td></tr>
<tr><td><code id="find_importance_function_+3A_boolusemclust">boolUseMclust</code></td>
<td>
<p>Auxiliary variable. Set to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the importance weight used in approximated normalizing constant.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='find_index_local_region'>find_index_local_region</h2><span id='topic+find_index_local_region'></span>

<h3>Description</h3>

<p>Auxiliary function that identify the local region for locally restricted importance sampling. Used in approximate the normalizing constant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_index_local_region(samples, EM_result, df_t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_index_local_region_+3A_samples">samples</code></td>
<td>
<p>The sample used to consruct region.</p>
</td></tr>
<tr><td><code id="find_index_local_region_+3A_em_result">EM_result</code></td>
<td>
<p>The parameters.</p>
</td></tr>
<tr><td><code id="find_index_local_region_+3A_df_t">df_t</code></td>
<td>
<p>Degree of freedom for the t-distrbution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the local region for locally restricted importance sampling.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='HMMfit'>HMMfit</h2><span id='topic+HMMfit'></span>

<h3>Description</h3>

<p>The following function performs (a) HMM fitting through the Expectation-Maximization al-
gorithm (METHOD = 1), (b) HMM fitting through the Markov chain Monte Carlo algorithm
(METHOD = 2), and (c) Gaussian mixture model fitting through the Markov chain Monte
Carlo algorithm (METHOD = 3).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HMMfit(y, K, METHOD, optionalfit = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HMMfit_+3A_y">y</code></td>
<td>
<p>The observed data.</p>
</td></tr>
<tr><td><code id="HMMfit_+3A_k">K</code></td>
<td>
<p>The specified number of states of the underlying Markov chian.</p>
</td></tr>
<tr><td><code id="HMMfit_+3A_method">METHOD</code></td>
<td>
<p>Integer value indicating the method of parameter estimation: (a) HMM fitting through the Expectation-Maximization al-
gorithm (METHOD = 1), (b) HMM fitting through the Markov chain Monte Carlo algorithm
(METHOD = 2), and (c) Gaussian mixture model fitting through the Markov chain Monte
Carlo algorithm (METHOD = 3)</p>
</td></tr>
<tr><td><code id="HMMfit_+3A_optionalfit">optionalfit</code></td>
<td>
<p>Optional variables as a list. Possible options include:</p>
</td></tr>
</table>

<ul>
<li><p>Ngibbs: Number of samples when using MCMC. Default is 5000.
</p>
</li>
<li><p>Burnin: Length of burnin period when using MCMC. Default is 5000.
</p>
</li>
<li><p>Thin: Thinning parameter when using MCMC. Default is 10.
</p>
</li>
<li><p>Nstart: Number of starting points. Default is 50.
</p>
</li>
<li><p>verbose: Logic variable indicating pritting details or not. Default is <code>FALSE</code>.
</p>
</li>
<li><p>priors: Prior when using MCMC. Default is flat.
</p>
</li></ul>



<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>This functions returns the fitting parameters of the observed data given the specified number of states.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(HMMmlselect)

# Example 1: use HMMfit to inference number of states
obs = HMMsim ( n = 200 )$obs
Nest = HMMfit( y = obs, K=3, METHOD = 1)
</code></pre>

<hr>
<h2 id='HMMfitting'>HMMfitting</h2><span id='topic+HMMfitting'></span>

<h3>Description</h3>

<p>Auxiliary function called from C++.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HMMfitting(tuningparameters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HMMfitting_+3A_tuningparameters">tuningparameters</code></td>
<td>
<p>Carried values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Auxiliary function called from C++.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='HMMll'>HMMll</h2><span id='topic+HMMll'></span>

<h3>Description</h3>

<p>Auxiliary function called from C++.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HMMll(tuningparameters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HMMll_+3A_tuningparameters">tuningparameters</code></td>
<td>
<p>Carried values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Auxiliary function called from C++.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='HMMmlestimate'>HMMmlestimate</h2><span id='topic+HMMmlestimate'></span>

<h3>Description</h3>

<p>Auxiliary function that approximates the marginal likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HMMmlestimate(y, K, optionalfit = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HMMmlestimate_+3A_y">y</code></td>
<td>
<p>The data that the marginal likelihood is computed for.</p>
</td></tr>
<tr><td><code id="HMMmlestimate_+3A_k">K</code></td>
<td>
<p>Number of states.</p>
</td></tr>
<tr><td><code id="HMMmlestimate_+3A_optionalfit">optionalfit</code></td>
<td>
<p>Optional variables.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the approximated marginal likelihood.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='HMMmlselect'>HMMmlselect</h2><span id='topic+HMMmlselect'></span>

<h3>Description</h3>

<p>This function computes the marginal likelihood of the HMM model
with the observed data and various number of states, and choose the one
with the highest marginal likelihood as the estimated number of states.
The method in Chen et al. (2017) is used, which we will denote it as
HMMml2017 afterward.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HMMmlselect(y, optionalfit = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HMMmlselect_+3A_y">y</code></td>
<td>
<p>The observed data.</p>
</td></tr>
<tr><td><code id="HMMmlselect_+3A_optionalfit">optionalfit</code></td>
<td>
<p>Optional variables as a list. Possible options include:</p>
</td></tr>
</table>

<ul>
<li><p>Kfits: Possible numbers of states. The function will compute the marginal likelihood under each of these numbers, and choose the one with the highest values as the estimated number of states. Default is {2,3,...,6}
</p>
</li>
<li><p>RIS: Logical variable indicating whether to use the reciprocal importance sampling method in HMMml2017. Default is set to be <code>FALSE</code>.
</p>
</li>
<li><p>IS: Logical variable indicating whether to use the importance sampling method in HMMml2017. Default is set to be <code>TRUE</code>.
</p>
</li>
<li><p>RunParallel: Logical variable indicating whether to run using parallelization or not. Default is <code>TRUE</code>.
</p>
</li>
<li><p>boolUseMclust: Logical variable indicating whether to use the <code>Mclust</code> package. Default is set to be <code>FALSE</code>.
</p>
</li>
<li><p>priors: Lists of hyper parameters for the prior. Default is flat prior.
</p>
</li>
<li><p>boolHMM: Compute using marginal likelihood of HMM. Default is <code>TRUE</code>. If it is set to <code>FALSE</code>, then the program will use the marignal likelihood of mixture model instead.
</p>
</li></ul>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns (1) the estimated number of hidden states using the marginal likelihood method,
(2) the marginal likelihood values corresponding to 2, 3, ... number of hidden states, and (3)
the fitted model parameters given the estimated number of hidden states.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(HMMmlselect)

# simulate a 25 observations HMM
obs = HMMsim ( n = 25 )$obs

# perform order selection and estimation
results = HMMmlselect ( y = obs, list(Kfits = c(2,3), boolUseMclust = FALSE) )

# visualize the results, see figure 1
PlotHMM ( y = obs, results )
</code></pre>

<hr>
<h2 id='HMMrepsim'>HMMrepsim</h2><span id='topic+HMMrepsim'></span>

<h3>Description</h3>

<p>Auxiliary function called from C++.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HMMrepsim(tuningparameters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HMMrepsim_+3A_tuningparameters">tuningparameters</code></td>
<td>
<p>Carried values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Auxiliary function called from C++.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='HMMsim'>HMMsim</h2><span id='topic+HMMsim'></span>

<h3>Description</h3>

<p>This function simulates HMM with the observed data being conditionally Gaussian distributed given the underlying state.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HMMsim(n, optionalsim = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HMMsim_+3A_n">n</code></td>
<td>
<p>The length of HMM to be simulated.</p>
</td></tr>
<tr><td><code id="HMMsim_+3A_optionalsim">optionalsim</code></td>
<td>
<p>Optional variables as a list. Possible options include:</p>
</td></tr>
</table>

<ul>
<li><p>Ksim: Number of states of the simulated HMM. Default is <code>3</code>.
</p>
</li>
<li><p>P: The transition matrix of the underlying Markov chain. Default is a flat K-by-K matrix.
</p>
</li>
<li><p>mu: The mean of the observed data given each underlying state. Default is {1, 2, ..., K}.
</p>
</li>
<li><p>sigma: The standard deviation of the observed data given each underlying state. Default is {0.1, 0.1, ... 0.1}.
</p>
</li>
<li><p>pi: The distribution of the initial state. Default is an uniform distribution across all possible states.
</p>
</li>
<li><p>BoolWritetoFile: Logic variable indicating whether to write the result into file or not. Default is <code>FALSE</code>.
</p>
</li>
<li><p>Filenameoutput: The output file name for the simulated HMM. Default is &quot;HMMtrace.txt&quot;.
</p>
</li></ul>



<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the sample of the simulated HMM.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(HMMmlselect)

# simulate a 25 observations HMM
obs = HMMsim ( n = 25 )$obs

# perform order selection and estimation
results = HMMmlselect ( y = obs, list(Kfits = c(2,3), boolUseMclust = FALSE) )

# visualize the results, see figure 1
PlotHMM ( y = obs, results )
</code></pre>

<hr>
<h2 id='HMMsimulate'>HMMsimulate</h2><span id='topic+HMMsimulate'></span>

<h3>Description</h3>

<p>Auxiliary function called from C++.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HMMsimulate(tuningparameters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HMMsimulate_+3A_tuningparameters">tuningparameters</code></td>
<td>
<p>Carried values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Auxiliary function called from C++.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='ll_un_normalized_hmm_gm'>ll_un_normalized_hmm_gm</h2><span id='topic+ll_un_normalized_hmm_gm'></span>

<h3>Description</h3>

<p>Auxiliary function that computes the unnormalized posterior density of HMM and Gaussian mixture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ll_un_normalized_hmm_gm(paras, yobs, bool_hmm, priors)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ll_un_normalized_hmm_gm_+3A_paras">paras</code></td>
<td>
<p>The parameter for the HMM.</p>
</td></tr>
<tr><td><code id="ll_un_normalized_hmm_gm_+3A_yobs">yobs</code></td>
<td>
<p>The observed data.</p>
</td></tr>
<tr><td><code id="ll_un_normalized_hmm_gm_+3A_bool_hmm">bool_hmm</code></td>
<td>
<p>1 if it's HMM. 0 if it's Gaussian mixture.</p>
</td></tr>
<tr><td><code id="ll_un_normalized_hmm_gm_+3A_priors">priors</code></td>
<td>
<p>Prior distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the unnormalized posterior density of HMM and Gaussian mixture.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='logmvNormdensity'>logmvNormdensity</h2><span id='topic+logmvNormdensity'></span>

<h3>Description</h3>

<p>Auxiliary function that computes log-likelihood based on multivariate t-distribution. Used when approximating marginal likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logmvNormdensity(x, mu, sqrt_inv_sigma, lgsqrt_det_sigma, d, logconstnormal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logmvNormdensity_+3A_x">x</code></td>
<td>
<p>Data to compute the log likelihood.</p>
</td></tr>
<tr><td><code id="logmvNormdensity_+3A_mu">mu</code></td>
<td>
<p>Mean of the normal distribution</p>
</td></tr>
<tr><td><code id="logmvNormdensity_+3A_sqrt_inv_sigma">sqrt_inv_sigma</code></td>
<td>
<p>Corresponds to the standard deviation of the normal distribution.</p>
</td></tr>
<tr><td><code id="logmvNormdensity_+3A_lgsqrt_det_sigma">lgsqrt_det_sigma</code></td>
<td>
<p>Corresponds to the determinant of the variance-covariance matrix.</p>
</td></tr>
<tr><td><code id="logmvNormdensity_+3A_d">d</code></td>
<td>
<p>Dimension of the normal distribution.</p>
</td></tr>
<tr><td><code id="logmvNormdensity_+3A_logconstnormal">logconstnormal</code></td>
<td>
<p>Leading constant for normal density function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the log-likelihood of the multivariate student-t distribution.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='logmvTdensity'>logmvTdensity</h2><span id='topic+logmvTdensity'></span>

<h3>Description</h3>

<p>Auxiliary function that computes log-likelihood based on multivariate t-distribution. Used when approximating marginal likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logmvTdensity(x, mu, sqrt_inv_sigma, lgsqrt_det_sigma, df, d, logconstT)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logmvTdensity_+3A_x">x</code></td>
<td>
<p>Data to compute the log likelihood.</p>
</td></tr>
<tr><td><code id="logmvTdensity_+3A_mu">mu</code></td>
<td>
<p>Mean of the t-distribution</p>
</td></tr>
<tr><td><code id="logmvTdensity_+3A_sqrt_inv_sigma">sqrt_inv_sigma</code></td>
<td>
<p>Corresponds to the standard deviation of the t-distribution.</p>
</td></tr>
<tr><td><code id="logmvTdensity_+3A_lgsqrt_det_sigma">lgsqrt_det_sigma</code></td>
<td>
<p>Corresponds to the determinant of the variance-covariance matrix.</p>
</td></tr>
<tr><td><code id="logmvTdensity_+3A_df">df</code></td>
<td>
<p>Degree of freedom of the t-distribution.</p>
</td></tr>
<tr><td><code id="logmvTdensity_+3A_d">d</code></td>
<td>
<p>Dimension of the t-distribution.</p>
</td></tr>
<tr><td><code id="logmvTdensity_+3A_logconstt">logconstT</code></td>
<td>
<p>Leading constant for t-distribution density function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the log-likelihood of the multivariate student-t distribution.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='multivariate_mixture_density'>multivariate_mixture_density</h2><span id='topic+multivariate_mixture_density'></span>

<h3>Description</h3>

<p>Auxiliary function that computes probability density of mixture normal/t-distribution. Used when approximating marginal likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multivariate_mixture_density(x, EM_result, df_t, logconstnormal, logconstT)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multivariate_mixture_density_+3A_x">x</code></td>
<td>
<p>Data to compute the log likelihood.</p>
</td></tr>
<tr><td><code id="multivariate_mixture_density_+3A_em_result">EM_result</code></td>
<td>
<p>Parameter as a dataset, including $p for probability weight, $Mu for the mean of each mixture component, and $Sigma for the standard deviation of each mixture component.</p>
</td></tr>
<tr><td><code id="multivariate_mixture_density_+3A_df_t">df_t</code></td>
<td>
<p>Degree of freedom of the t-distribution. If df_t==0, then it is treated as a normal distribution.</p>
</td></tr>
<tr><td><code id="multivariate_mixture_density_+3A_logconstnormal">logconstnormal</code></td>
<td>
<p>Leading constant for normal density function. Used when df_t==0.</p>
</td></tr>
<tr><td><code id="multivariate_mixture_density_+3A_logconstt">logconstT</code></td>
<td>
<p>Leading constant for t-distribution density function. Used when df_t&gt;0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the likelihood of the mixture normal/student-t distribution.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

<hr>
<h2 id='PlotHMM'>PlotHMM</h2><span id='topic+PlotHMM'></span>

<h3>Description</h3>

<p>This function visualizes the state inference result using <code>HMMmlselect</code>. See the Manual.pdf under
data folder for a figure example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotHMM(y, results)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PlotHMM_+3A_y">y</code></td>
<td>
<p>The observed data.</p>
</td></tr>
<tr><td><code id="PlotHMM_+3A_results">results</code></td>
<td>
<p>The resulting output of state inference using <code>HMMmlselect</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the graph with the original data and the inferenced states.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(HMMmlselect)

# simulate a 25 observations HMM
obs = HMMsim ( n = 25 )$obs

# perform order selection and estimation
results = HMMmlselect ( y = obs, list(Kfits = c(2,3), boolUseMclust = FALSE) )

# visualize the results, see figure 1
PlotHMM ( y = obs, results )
</code></pre>

<hr>
<h2 id='RobustBIC'>RobustBIC</h2><span id='topic+RobustBIC'></span>

<h3>Description</h3>

<p>This function estimates the number of states of the given HMM data using robust BIC criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RobustBIC(y, optionalbic = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RobustBIC_+3A_y">y</code></td>
<td>
<p>The observed data.</p>
</td></tr>
<tr><td><code id="RobustBIC_+3A_optionalbic">optionalbic</code></td>
<td>
<p>Optional variables as a list. Possible options include:</p>
</td></tr>
</table>

<ul>
<li><p>Kfits: Possible numbers of states. The function will compute the marginal likelihood under each of these numbers, and choose the one with the highest values as the estimated number of states. Default is {2,3,...,6}
</p>
</li>
<li><p>Nstart: The number of starting points for the robust BIC. Default is 50.
</p>
</li>
<li><p>verbose: Logic variable indicating pritting details or not. Default is <code>FALSE</code>.
</p>
</li></ul>



<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>This function returns the estimated number of hidden states through minimizing the BIC,
the BIC values of all the possible number of hidden states, and the fitted model parameters
under the estimated number of hidden states under the BIC method.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2017+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(HMMmlselect)

# Example 1: use robust BIC to determine the order of HMM
obs = HMMsim ( n = 200 )$obs
resultsBIC = RobustBIC ( y = obs )
</code></pre>

<hr>
<h2 id='sample_mixture'>sample_mixture</h2><span id='topic+sample_mixture'></span>

<h3>Description</h3>

<p>Auxiliary function that simulates mixture normal/t-distribution. Used when approximating marginal likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_mixture(N, list_paras, df_t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_mixture_+3A_n">N</code></td>
<td>
<p>The number of sample to be drawn.</p>
</td></tr>
<tr><td><code id="sample_mixture_+3A_list_paras">list_paras</code></td>
<td>
<p>Parameter as a dataset, including $p for probability weight, $Mu for the mean of each mixture component, and $Sigma for the standard deviation of each mixture component.</p>
</td></tr>
<tr><td><code id="sample_mixture_+3A_df_t">df_t</code></td>
<td>
<p>Degree of freedom of the t-distribution. If df_t==0, then it is treated as a normal distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Manual.pdf in &quot;inst/extdata&quot; folder.
</p>


<h3>Value</h3>

<p>It returns the sample of the simulated mixture normal/student-t distribution.
</p>


<h3>References</h3>

<p>Yang Chen, Cheng-Der Fuh, Chu-Lan Kao, and Samuel Kou (2019+) &quot;Determine the number of states
in hidden markov models via marginal likelihood.&quot; Submitted.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
