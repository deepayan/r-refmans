<!DOCTYPE html><html><head><title>Help for package cordillera</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cordillera}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CAClimateIndicatorsCountyMedian'><p>Climate Change Indicators of Californian Counties</p></a></li>
<li><a href='#cordillera'><p>The OPTICS Cordillera</p></a></li>
<li><a href='#cordillera-package'><p>cordillera: The OPTICS Cordillera</p></a></li>
<li><a href='#oldcordilleraplot'><p>Plot method for OPTICS Cordilleras. Deprecated.</p></a></li>
<li><a href='#plot.cordillera'><p>Plot method for OPTICS Cordilleras</p></a></li>
<li><a href='#print.cordillera'><p>Print method for the OPTICS Cordillera</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Calculation of the OPTICS Cordillera</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-01-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Rusch <a href="https://orcid.org/0000-0002-7773-2096"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Patrick Mair [ctb],
  Kurt Hornik <a href="https://orcid.org/0000-0003-4198-9911"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Rusch &lt;thomas.rusch@wu.ac.at&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for calculating the OPTICS Cordillera. The OPTICS Cordillera measures the amount of 'clusteredness' in a numeric data matrix within a distance-density based framework for a given minimum number of points comprising a cluster, as described in Rusch, Hornik, Mair (2018) &lt;<a href="https://doi.org/10.1080%2F10618600.2017.1349664">doi:10.1080/10618600.2017.1349664</a>&gt;. There is an R native version with methods for printing, summarizing, and plotting the result. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.2),</td>
</tr>
<tr>
<td>Imports:</td>
<td>dbscan</td>
</tr>
<tr>
<td>Suggests:</td>
<td>cluster, scatterplot3d, MASS, R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://r-forge.r-project.org/projects/stops/">https://r-forge.r-project.org/projects/stops/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-16 17:00:42 UTC; trusch</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-17 10:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='CAClimateIndicatorsCountyMedian'>Climate Change Indicators of Californian Counties</h2><span id='topic+CAClimateIndicatorsCountyMedian'></span>

<h3>Description</h3>

<p>A dataset containing observed and projected indicators of climate change related natural hazards for 58 Californian counties. The values are actually the medians of the predicted distribution over spatial measurement points. It is a compiled data set from three sources and that has been aggregated to the county level. The projected data were derived under two different IPCC climate change scenarios (A2, the high emission scenario and B1, the moderate emission scenario). It further contains the county value of the California social vulnerability index.
</p>


<h3>Format</h3>

<p>A data frame with 58 rows and 52 variables   
</p>

<dl>
<dt>county</dt><dd><p>The county name identifier.</p>
</dd>
<dt>vuln_CA</dt><dd><p>The vulnerability index of Cooley et al. (2012).</p>
</dd>
<dt>degFB1</dt><dd><p>County average 95th percentile daily maximum temperature in Fahrenheit from May 1 to September 30 over the historical period (1971-2000) under the climate scenario B1. These are averaged values for 4 different climate models. The source was Table 7 of Cooley et al. (2012).</p>
</dd>
<dt>heatB1_71_00</dt><dd><p>Projected average number of days where the daily maximum temperature exceeds the high-heat threshold (see above) over period 1971-2000. Projections are based on the B1 scenario and are averaged for four downscaled climate models. The source was Table 7 of Cooley et al. (2012).</p>
</dd>
<dt>heatB1_10_39</dt><dd><p>Projected average number of days where the daily maximum temperature exceeds the high-heat threshold (see above) over period 2010-2039. Projections are based on the B1 scenario and are averaged for four downscaled climate models. The source was Table 7 of Cooley et al. (2012).</p>
</dd>
<dt>heatB1_40_69</dt><dd><p>Projected average number of days where the daily maximum temperature exceeds the high-heat threshold (see above) over period 2040-2069. Projections are based on the B1 scenario and are averaged for four downscaled climate models. The source was Table 7 of Cooley et al. (2012).</p>
</dd>
<dt>heatB1_70_99</dt><dd><p>Projected average number of days where the daily maximum temperature exceeds the high-heat threshold (see above) over period 2070-2099. Projections are based on the B1 scenario and are averaged for four downscaled climate models. The source was Table 7 of Cooley et al. (2012). </p>
</dd>
<dt>degFA2</dt><dd><p>County average 95th percentile daily maximum temperature in Fahrenheit from May 1 to September 30 over the historical period (1971-2000) under the climate scenario A2. These are averaged values for 4 different climate models. The source was Table 7 of Cooley et al. (2012).</p>
</dd>
<dt>heatA2_71_00</dt><dd><p>Projected average number of days where the daily maximum temperature exceeds the high-heat threshold (see above) over period 1971-2000. Projections are based on the A2 scenario and are averaged for four downscaled climate models. The source was Table 7 of Cooley et al. (2012).</p>
</dd>
<dt>heatA2_10_39</dt><dd><p>Projected average number of days where the daily maximum temperature exceeds the high-heat threshold (see above) over period 2010-2039. Projections are based on the A2 scenario and are averaged for four downscaled climate models. The source was Table 7 of Cooley et al. (2012).</p>
</dd>
<dt>heatA2_40_69</dt><dd><p>Projected average number of days where the daily maximum temperature exceeds the high-heat threshold (see above) over period 2040-2069. Projections are based on the A2 scenario and are averaged for four downscaled climate models. The source was Table 7 of Cooley et al. (2012).</p>
</dd>
<dt>heatA2_70_99</dt><dd><p>Projected average number of days where the daily maximum temperature exceeds the high-heat threshold (see above) over period 2070-2099. Projections are based on the A2 scenario and are averaged for four downscaled climate models. The source was Table 7 of Cooley et al. (2012). </p>
</dd>
<dt>flood_2000</dt><dd><p>The percentage of a county's census block area vulnerable to unimpeded coastal flooding under baseline conditions (2000). The raw data were obtained from Heberger et al. (2009). From the census block areas we computed an area-weighted percentage for each county.</p>
</dd> 
<dt>flood_2100</dt><dd><p>The projected percentage of a county's census block area vulnerable to unimpeded coastal flooding with a 1.4-meter (55-inch) sea-level rise (projected for 2100). The raw data were obtained from Heberger et al (2009). From the census block areas we computed an area-weighted percentage for each county.</p>
</dd>
<dt>basfA2_2000</dt><dd><p>The median aggregated CCSM3 observed or projected annual baseflow for year 2000 under scenario A2 by county (past years are observed, future years are projected). The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>basfA2_2039</dt><dd><p>The median aggregated CCSM3 observed or projected annual baseflow for year 2039 under scenario A2 by county (past years are observed, future years are projected). The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>basfA2_2069</dt><dd><p>The median aggregated CCSM3 observed or projected annual baseflow for year 2069 under scenario A2 by county (past years are observed, future years are projected). The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>basfA2_2099</dt><dd><p>The median aggregated CCSM3 observed or projected annual baseflow for year 2099 under scenario A2 by county (past years are observed, future years are projected). The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>basfB1_2000</dt><dd><p>The median aggregated CCSM3 observed or projected annual baseflow for year 2000 under scenario B1 by county (past years are observed, future years are projected). The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>basfB1_2039</dt><dd><p>The median aggregated CCSM3 observed or projected annual baseflow for year 2039 under scenario B1 by county (past years are observed, future years are projected). The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>basfB1_2069</dt><dd><p>The median aggregated CCSM3 observed or projected annual baseflow for year 2069 under scenario B1 by county (past years are observed, future years are projected). The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>basfB1_2099</dt><dd><p>The median aggregated CCSM3 observed or projected annual baseflow for year 2099 under scenario B1 by county (past years are observed, future years are projected). The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>evapA2_2000</dt><dd><p>The median aggregated Community Climate System Model v.3 (CCSM3) projected annual actual evapotranspiration for year 2000 under scenarios A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>evapA2_2039</dt><dd><p>The median aggregated Community Climate System Model v.3 (CCSM3) projected annual actual evapotranspiration for year 2039 under scenarios A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>evapA2_2069</dt><dd><p>The median aggregated Community Climate System Model v.3 (CCSM3) projected annual actual evapotranspiration for year 2069 under scenarios A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>evapA2_2099</dt><dd><p>The median aggregated Community Climate System Model v.3 (CCSM3) projected annual actual evapotranspiration for year 2099 under scenarios A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>evapB1_2000</dt><dd><p>The median aggregated Community Climate System Model v.3 (CCSM3) projected annual actual evapotranspiration for year 2000 under scenarios B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>evapB1_2039</dt><dd><p>The median aggregated Community Climate System Model v.3 (CCSM3) projected annual actual evapotranspiration for year 2039 under scenarios B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>evapB1_2069</dt><dd><p>The median aggregated Community Climate System Model v.3 (CCSM3) projected annual actual evapotranspiration for year 2069 under scenarios B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>evapB1_2099</dt><dd><p>The median aggregated Community Climate System Model v.3 (CCSM3) projected annual actual evapotranspiration for year 2099 under scenarios B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>prcpA2_2000</dt><dd><p>The median aggregated CCSM3 projected annual precipitation for year 2000 under scenario A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>prcpA2_2039</dt><dd><p>The median aggregated CCSM3 projected annual precipitation for year 2000 under scenario A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>prcpA2_2069</dt><dd><p>The median aggregated CCSM3 projected annual precipitation for year 2000 under scenario A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>prcpA2_2099</dt><dd><p>The median aggregated CCSM3 projected annual precipitation for year 2000 under scenario A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>prcpB1_2000</dt><dd><p>The median aggregated CCSM3 projected annual precipitation for year 2000 under scenario B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>prcpB1_2039</dt><dd><p>The median aggregated CCSM3 projected annual precipitation for year 2000 under scenario B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>prcpB1_2069</dt><dd><p>The median aggregated CCSM3 projected annual precipitation for year 2000 under scenario B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>prcpB1_2099</dt><dd><p>The median aggregated CCSM3 projected annual precipitation for year 2000 under scenario B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>smclA2_2000</dt><dd><p>The median aggregated CCSM3 projected annual fractional moisture in the entire soil column for year 2000 under scenario A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>smclA2_2039</dt><dd><p>The median aggregated CCSM3 projected annual fractional moisture in the entire soil column for year 2039 under scenario A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>smclA2_2069</dt><dd><p>The median aggregated CCSM3 projected annual fractional moisture in the entire soil column for year 2069 under scenario A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>smclA2_2099</dt><dd><p>The median aggregated CCSM3 projected annual fractional moisture in the entire soil column for year 2099 under scenario A2 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>smclB1_2000</dt><dd><p>The median aggregated CCSM3 projected annual fractional moisture in the entire soil column for year 2000 under scenario B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>smclB1_2039</dt><dd><p>The median aggregated CCSM3 projected annual fractional moisture in the entire soil column for year 2039 under scenario B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>smclB1_2069</dt><dd><p>The median aggregated CCSM3 projected annual fractional moisture in the entire soil column for year 2069 under scenario B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>smclB1_2099</dt><dd><p>The median aggregated CCSM3 projected annual fractional moisture in the entire soil column for year 2099 under scenario B1 by county. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>fireA2_2020</dt><dd><p>The median aggregated Centre National de Recherches Meteorologiques (CNRM) projected annual wildfire risk (observing 1 or more fires in the next 30 years) for each county in year 2020 under scenarios A2. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>fireA2_2050</dt><dd><p>The median aggregated Centre National de Recherches Meteorologiques (CNRM) projected annual wildfire risk (observing 1 or more fires in the next 30 years) for each county in year 2050 under scenarios A2. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>fireA2_2085</dt><dd><p>The median aggregated Centre National de Recherches Meteorologiques (CNRM) projected annual wildfire risk (observing 1 or more fires in the next 30 years) for each county in year 2085 under scenarios A2. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>fireB1_2020</dt><dd><p>The median aggregated Centre National de Recherches Meteorologiques (CNRM) projected annual wildfire risk (observing 1 or more fires in the next 30 years) for each county in year 2020 under scenarios B1. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>fireB1_2050</dt><dd><p>The median aggregated Centre National de Recherches Meteorologiques (CNRM) projected annual wildfire risk (observing 1 or more fires in the next 30 years) for each county in year 2050 under scenarios B1. The source of the raw data was California Energy Commission (2008).</p>
</dd>
<dt>fireB1_2085</dt><dd><p>The median aggregated Centre National de Recherches Meteorologiques (CNRM) projected annual wildfire risk (observing 1 or more fires in the next 30 years) for each county in year 2085 under scenarios B1. The source of the raw data was California Energy Commission (2008).</p>
</dd>
</dl>



<h3>Details</h3>

<p>Overall there are 50 indicators of natural hazard, one indicator of social vulnerability and 1 identifier of the county which were:
</p>


<h3>Source</h3>

<p>Cooley, H., Moore, E., Heberger, M. and Allen, L. (2012) Social Vulnerability to Climate Change. California Energy Commission. Publication Number: CEC-500-2012-013 <a href="https://pacinst.org/wp-content/uploads/sites/21/2014/04/social-vulnerability-climate-change-ca.pdf">https://pacinst.org/wp-content/uploads/sites/21/2014/04/social-vulnerability-climate-change-ca.pdf</a> and Heberger, M., Cooley, C., Herrera, P., Gleick, P. and Moore, E. (2009) The impacts of sea-level rise on the Californian coast. California Energy Commission. Publication Number: CEC-500-2009-024-F <a href="https://pacinst.org/publication/the-impacts-of-sea-level-rise-on-the-california-coast/">https://pacinst.org/publication/the-impacts-of-sea-level-rise-on-the-california-coast/</a> (<a href="https://pacinst.org/reports/sea_level_rise_data/Blk_fld.zip">https://pacinst.org/reports/sea_level_rise_data/Blk_fld.zip</a> for raw data) and California Energy Comission (2008) <a href="https://cal-adapt.org/data/download/">https://cal-adapt.org/data/download/</a>
</p>

<hr>
<h2 id='cordillera'>The OPTICS Cordillera</h2><span id='topic+cordillera'></span>

<h3>Description</h3>

<p>Calculates the OPTICS Cordillera as described in Rusch et al. (2017). Based on optics in dbscan package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cordillera(
  X,
  q = 2,
  minpts = 2,
  epsilon,
  distmeth = "euclidean",
  dmax = NULL,
  rang,
  digits = 10,
  scale = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cordillera_+3A_x">X</code></td>
<td>
<p>numeric matrix or data frame representing coordinates of points, or a symmetric matrix of distance of points or an object of class <a href="stats.html#topic+dist">dist</a>. Passed to <code><a href="dbscan.html#topic+optics">optics</a></code>, see also there.</p>
</td></tr>
<tr><td><code id="cordillera_+3A_q">q</code></td>
<td>
<p>The norm used for the Cordillera. Defaults to 2.</p>
</td></tr>
<tr><td><code id="cordillera_+3A_minpts">minpts</code></td>
<td>
<p>The minimum number of points that must make up a cluster in OPTICS (corresponds to k in the paper). It is passed to <code><a href="dbscan.html#topic+optics">optics</a></code> where it is called minPts. Defaults to 2.</p>
</td></tr>
<tr><td><code id="cordillera_+3A_epsilon">epsilon</code></td>
<td>
<p>The epsilon parameter for OPTICS (called epsilon_max in the paper). Defaults to 2 times the maximum distance between any two points.</p>
</td></tr>
<tr><td><code id="cordillera_+3A_distmeth">distmeth</code></td>
<td>
<p>The distance to be computed if X is not a symmetric matrix (those from <code><a href="stats.html#topic+dist">dist</a></code> are available) or a dist object (otherwise ignored). Defaults to Euclidean distance.</p>
</td></tr>
<tr><td><code id="cordillera_+3A_dmax">dmax</code></td>
<td>
<p>The winsorization value for the highest allowed reachability. If used for comparisons this should be supplied. If no value is supplied, it is NULL (default), then dmax is taken from the data as minimum of epsilon or the largest reachability.</p>
</td></tr>
<tr><td><code id="cordillera_+3A_rang">rang</code></td>
<td>
<p>A range of values for making up dmax. If supplied it overrules the dmax parameter and rang[2]-rang[1] is returned as dmax in the object. If no value is supplied rang is taken to be (0, dmax) taken from the data. Only use this when you know what you're doing, which would mean you're me (and even then we should be cautious).</p>
</td></tr>
<tr><td><code id="cordillera_+3A_digits">digits</code></td>
<td>
<p>The precision to round the raw Cordillera and the norm factor. Defaults to 10.</p>
</td></tr>
<tr><td><code id="cordillera_+3A_scale">scale</code></td>
<td>
<p>Should X be scaled if it is an asymmetric matrix or data frame? Can take values TRUE or FALSE or a numeric value. If TRUE or 1, standardisation is to mean=0 and sd=1. If 2, no centering is applied and scaling of each column is done with the root mean square of each column. If 3, no centering is applied and scaling of all columns is done as X/max(standard deviation(allcolumns)). If 4, no centering is applied and scaling of all columns is done as X/max(rmsq(allcolumns)). If FALSE, 0 or any other numeric value, no standardisation is applied. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="cordillera_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="dbscan.html#topic+optics">optics</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements
</p>

<ul>
<li><p> $raw... The raw cordillera
</p>
</li>
<li><p> $norm... The normalization constant
</p>
</li>
<li><p> $normfac... The normalization factor (the number of times that dmax is taken)
</p>
</li>
<li><p> $dmaxe... The effective maximum distance used for maximum structure (either dmax or epsilon or rang[2]-rang[1]). 
</p>
</li>
<li><p> $normed... The normed cordillera (raw/norm)
</p>
</li>
<li><p> $optics... The optics object
</p>
</li></ul>



<h3>Warning</h3>

<p>It may happen that the (normed) cordillera cannot be calculated properly (e.g. division by zero, infinite raw cordillera, q value to high etc.). A warning will be printed and the normed Cordillera is either 0, 1 (if infinity is involved) or NA. In that case one needs to check one or more of the following: reachability values returned from optics, minpts, eps, the raw cordillera, dmax and the normalization factor normfac.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(iris)
res&lt;-princomp(iris[,1:4])
#2 dim goodness-of-clusteredness with clusters of at least 2 points
#With a matrix of points
cres2&lt;-cordillera(res$scores[,1:2])
cres2
summary(cres2)
plot(cres2)

#with a dist object 
dl0 &lt;- dist(res$scores[,1:2],"maximum") #maximum distance
cres0&lt;-cordillera(dl0)
cres0
summary(cres0)
plot(cres0)

#with any symmetric distance/dissimilarity matrix 
dl1 &lt;- cluster::daisy(res$scores[,1:2],"manhattan") 
cres1&lt;-cordillera(dl1)
cres1
summary(cres1)
plot(cres1)

#4 dim goodness-of-clusteredness with clusters of at least 20
#points for PCA
cres4&lt;-cordillera(res$scores[,1:4],minpts=20,epsilon=13,scale=3) 
#4 dim goodness-of-clusteredness with clusters of at least 20 points for original
#data
cres&lt;-cordillera(iris[,1:4],minpts=20,epsilon=13,dmax=cres4$dmaxe,scale=3)
#There is more clusteredness for the original result
summary(cres4) 
summary(cres) 
plot(cres4) #cluster structure only a bit intelligible
plot(cres) #clearly two well separated clusters

###############################################################################
# Example from Rusch et al. (2018) with original data, PCA and Sammon mapping #
###############################################################################

#data preparation
data(CAClimateIndicatorsCountyMedian)
sovisel &lt;- CAClimateIndicatorsCountyMedian[,-c(1,2,4,9)]
#normalize to [0,1]
sovisel &lt;- apply(sovisel,2,function(x) (x-min(x))/(max(x)-min(x))) 
rownames(sovisel)  &lt;- CAClimateIndicatorsCountyMedian[,1]
dis &lt;- dist(sovisel)

#hyper parameters
dmax=1.22
q=2
minpts=3

#original data directly
cdat &lt;- cordillera(sovisel,distmeth="euclidean",minpts=minpts,epsilon=10,q=q,
                   scale=0)
#equivalently
#dis2=dist(sovisel)
#cdat2 &lt;- cordillera(dis2,minpts=minpts,epsilon=10,q=q,scale=FALSE) 

#PCA in 2-dim
pca1 &lt;- princomp(sovisel)
pcas &lt;- scale(pca1$scores[,1:2])
cpca &lt;- cordillera(pcas,minpts=minpts,epsilon=10,q=q,dmax=dmax,scale=FALSE)

#Sammon mapping in 2-dim
sam &lt;- MASS::sammon(dis)
samp &lt;- scale(sam$points)
csam &lt;- cordillera(samp,epsilon=10,minpts=minpts,q=q,dmax=dmax,scale=FALSE)

#results
cdat
cpca
csam

par(mfrow=c(3,1))
plot(cdat)
plot(cpca)
plot(csam)
par(mfrow=c(1,1))

</code></pre>

<hr>
<h2 id='cordillera-package'>cordillera: The OPTICS Cordillera</h2><span id='topic+cordillera-package'></span>

<h3>Description</h3>

<p>A package for calculating the OPTICS Cordillera. The package contains various functions, methods and classes for calculating and plotting the OPTICS Cordillera and an interface to ELKI's OPTICS.
</p>


<h3>Details</h3>

<p>The stops package provides these main functions:
</p>

<ul>
<li><p> cordillera() ... OPTICS Cordillera using dbscan OPTICS implementation
</p>
</li></ul>

<p>Methods: 
For most of the objects returned by the high-level functions S3 classes and methods for standard generics were implemented, including print, summary, plot.
</p>
<p>References:
</p>

<ul>
<li><p> Rusch, T., Hornik, K., &amp; Mair, P. (2018) Assessing and quantifying clusteredness: The OPTICS Cordillera, Journal of Computational and Graphical Statistics. 27 (1), 220-233. <a href="https://doi.org/10.1080/10618600.2017.1349664">doi:10.1080/10618600.2017.1349664</a>
</p>
</li></ul>

<p>Authors: Thomas Rusch 
</p>
<p>Maintainer: Thomas Rusch
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(CAClimateIndicatorsCountyMedian)

res&lt;-princomp(CAClimateIndicatorsCountyMedian[,3:52])
res
summary(res)

library(scatterplot3d)
scatterplot3d(res$scores[,1:3])

irisrep3d&lt;-res$scores[,1:3]
irisrep2d&lt;-res$scores[,1:2]


#OPTICS in dbscan version
library(dbscan)
ores&lt;-optics(irisrep2d,minPts=15,eps=100)
plot(ores)
#OPTICS cordillera for the 2D representation
cres2d&lt;-cordillera(irisrep2d,minpts=15)
cres2d
summary(cres2d)
plot(cres2d)

#OPTICS cordillera for the 3D representation
cres3d&lt;-cordillera(irisrep3d,minpts=15)
cres3d
summary(cres3d)
plot(cres3d)

</code></pre>

<hr>
<h2 id='oldcordilleraplot'>Plot method for OPTICS Cordilleras. Deprecated.</h2><span id='topic+oldcordilleraplot'></span>

<h3>Description</h3>

<p>Plots the reachability plot and adds the cordillera to it (as a line). In this plot the cordillera is proportional to the real value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oldcordilleraplot(
  x,
  colbp = "lightgrey",
  coll = "black",
  liwd = 1.5,
  legend = FALSE,
  ylim,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oldcordilleraplot_+3A_x">x</code></td>
<td>
<p>an object of class cordillera</p>
</td></tr>
<tr><td><code id="oldcordilleraplot_+3A_colbp">colbp</code></td>
<td>
<p>color of the barplot.</p>
</td></tr>
<tr><td><code id="oldcordilleraplot_+3A_coll">coll</code></td>
<td>
<p>color of the cordillera line</p>
</td></tr>
<tr><td><code id="oldcordilleraplot_+3A_liwd">liwd</code></td>
<td>
<p>width of the cordillera line</p>
</td></tr>
<tr><td><code id="oldcordilleraplot_+3A_legend">legend</code></td>
<td>
<p>draw legend</p>
</td></tr>
<tr><td><code id="oldcordilleraplot_+3A_ylim">ylim</code></td>
<td>
<p>ylim for the barplots</p>
</td></tr>
<tr><td><code id="oldcordilleraplot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to barplot or lines</p>
</td></tr>
</table>

<hr>
<h2 id='plot.cordillera'>Plot method for OPTICS Cordilleras</h2><span id='topic+plot.cordillera'></span>

<h3>Description</h3>

<p>Plots the reachability plot and adds the cordillera to it (as a line). In this plot the cordillera is proportional to the real value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cordillera'
plot(
  x,
  colbp = "lightgrey",
  coll = "black",
  liwd = 1.5,
  legend = FALSE,
  ylim,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.cordillera_+3A_x">x</code></td>
<td>
<p>an object of class &quot;cordillera&quot;</p>
</td></tr>
<tr><td><code id="plot.cordillera_+3A_colbp">colbp</code></td>
<td>
<p>color of the barplot.</p>
</td></tr>
<tr><td><code id="plot.cordillera_+3A_coll">coll</code></td>
<td>
<p>color of the cordillera line</p>
</td></tr>
<tr><td><code id="plot.cordillera_+3A_liwd">liwd</code></td>
<td>
<p>width of the cordillera line</p>
</td></tr>
<tr><td><code id="plot.cordillera_+3A_legend">legend</code></td>
<td>
<p>draw legend</p>
</td></tr>
<tr><td><code id="plot.cordillera_+3A_ylim">ylim</code></td>
<td>
<p>ylim for the barplots</p>
</td></tr>
<tr><td><code id="plot.cordillera_+3A_...">...</code></td>
<td>
<p>additional arguments passed to barplot or lines</p>
</td></tr>
</table>

<hr>
<h2 id='print.cordillera'>Print method for the OPTICS Cordillera</h2><span id='topic+print.cordillera'></span>

<h3>Description</h3>

<p>Prints the raw and normalized OPTICS Cordillera
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cordillera'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cordillera_+3A_x">x</code></td>
<td>
<p>an object of class optics</p>
</td></tr>
<tr><td><code id="print.cordillera_+3A_...">...</code></td>
<td>
<p>additional arguments passed to print</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
