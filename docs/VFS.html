<!DOCTYPE html><html lang="en"><head><title>Help for package VFS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {VFS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#VFS-package'>
<p>Vegetated Filter Strip and Erosion Model</p></a></li>
<li><a href='#APLE'>
<p>Agricultural Phosphorus Loss Estimator</p></a></li>
<li><a href='#bufferdat'>
<p>Parameters for vegetated buffers</p></a></li>
<li><a href='#MUSLE'>
<p>Modified Universal Soil Loss Equation</p></a></li>
<li><a href='#MUSLE.K'>
<p>Estimate soil erodibility factor K.</p></a></li>
<li><a href='#MUSLE.LS'>
<p>Estimate landscape factor LS</p></a></li>
<li><a href='#peak'>
<p>Rational method to calculate peak discharge</p></a></li>
<li><a href='#print.APLE'>
<p>Printing the result of APLE</p></a></li>
<li><a href='#print.VFS'>
<p>Printing the result of VFS</p></a></li>
<li><a href='#rainfall'>
<p>Generate simulated daily rainfall</p></a></li>
<li><a href='#read.dly'>
<p>Read GHCN DLY daily weather file into a data frame</p></a></li>
<li><a href='#soildat'>
<p>Soil texture class properties</p></a></li>
<li><a href='#summary.APLE'>
<p>Summarize the result of APLE</p></a></li>
<li><a href='#summary.VFS'>
<p>Summarize the result of VFS</p></a></li>
<li><a href='#temperature'>
<p>Generate simulated mean temperature</p></a></li>
<li><a href='#USC00368449.dly'>
<p>GHCN Data for State College, PA, 1980-2009</p></a></li>
<li><a href='#VFS'>
<p>Vegetated filter strip and erosion model</p></a></li>
<li><a href='#VFSAPLE'>
<p>Link the VFS and APLE models.</p></a></li>
<li><a href='#weather'>
<p>Ten years of daily weather data</p></a></li>
<li><a href='#wth.param'>
<p>Calculate weather parameters from daily data for use in climate simulations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Vegetated Filter Strip and Erosion Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-10-01</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, e1071, nleqslv (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Empirical models for runoff, erosion, and phosphorus loss 
    across a vegetated filter strip, given slope, soils, climate, and 
    vegetation (Gall et al., 2018) &lt;<a href="https://doi.org/10.1007%2Fs00477-017-1505-x">doi:10.1007/s00477-017-1505-x</a>&gt;. 
    It also includes functions for deriving climate parameters from 
    measured daily weather data, and for simulating rainfall. Models 
    implemented include MUSLE (Williams, 1975) and APLE (Vadas et al., 
    2009 &lt;<a href="https://doi.org/10.2134%2Fjeq2008.0337">doi:10.2134/jeq2008.0337</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/sgoslee/VFS/issues">https://github.com/sgoslee/VFS/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-10-01 16:20:35 UTC; sarahg</td>
</tr>
<tr>
<td>Author:</td>
<td>Sarah Goslee [aut, cre],
  Heather Gall [aut],
  Tamie Veith [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sarah Goslee &lt;Sarah.Goslee@ars.usda.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-10-12 13:20:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='VFS-package'>
Vegetated Filter Strip and Erosion Model
</h2><span id='topic+VFS-package'></span>

<h3>Description</h3>

<p>Empirical models for runoff, erosion, and phosphorus loss 
across a vegetated filter strip, given slope, soils, climate, and 
vegetation (Gall et al., 2018) &lt;doi:10.1007/s00477-017-1505-x&gt;. 
It also includes functions for deriving climate parameters from 
measured daily weather data, and for simulating rainfall. Models 
implemented include MUSLE (Williams, 1975) and APLE (Vadas et al., 
2009 &lt;doi:10.2134/jeq2008.0337&gt;).
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> VFS</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Vegetated Filter Strip and Erosion Model</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-10-01</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person("Sarah", "Goslee", role = c("aut", "cre"),
                     email = "Sarah.Goslee@ars.usda.gov"),
              person("Heather", "Gall", role = "aut"),
			  person("Tamie", "Veith", role = "aut"))</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.4.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> stats, graphics, e1071, nleqslv (&gt;= 3.3.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> knitr, rmarkdown, testthat</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Empirical models for runoff, erosion, and phosphorus loss 
    across a vegetated filter strip, given slope, soils, climate, and 
    vegetation (Gall et al., 2018) &lt;doi:10.1007/s00477-017-1505-x&gt;. 
    It also includes functions for deriving climate parameters from 
    measured daily weather data, and for simulating rainfall. Models 
    implemented include MUSLE (Williams, 1975) and APLE (Vadas et al., 
    2009 &lt;doi:10.2134/jeq2008.0337&gt;).</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
BugReports: </td><td style="text-align: left;"> https://github.com/sgoslee/VFS/issues</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> true</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Sarah Goslee [aut, cre],
  Heather Gall [aut],
  Tamie Veith [aut]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Sarah Goslee &lt;Sarah.Goslee@ars.usda.gov&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
APLE                    Agricultural Phosphorus Loss Estimator
MUSLE                   Modified Universal Soil Loss Equation
MUSLE.K                 Estimate soil erodibility factor K.
MUSLE.LS                Estimate landscape factor LS
USC00368449.dly         GHCN Data for State College, PA, 1980-2009
VFS                     Vegetated filter strip and erosion model
VFS-package             Vegetated Filter Strip and Erosion Model
VFSAPLE                 Link the VFS and APLE models.
bufferdat               Parameters for vegetated buffers
peak                    Rational method to calculate peak discharge
print.APLE              Printing the result of APLE
print.VFS               Printing the result of VFS
rainfall                Generate simulated daily rainfall
read.dly                Read GHCN DLY daily weather file into a data
                        frame
soildat                 Soil texture class properties
summary.APLE            Summarize the result of APLE
summary.VFS             Summarize the result of VFS
temperature             Generate simulated mean temperature
weather                 Ten years of daily weather data
wth.param               Calculate weather parameters from daily data
                        for use in climate simulations
</pre>
<p>This package implements runoff, erosion, filter strip, and phosphorus loss models in R.
</p>


<h3>Author(s)</h3>

<p>NA
</p>
<p>Maintainer: NA
</p>


<h3>References</h3>

<p>Gall, H. E., Schultz, D., Veith, T. L, Goslee, S. C., Mejia, A., Harman, C. J., Raj, C. and Patterson, P. H. (2018) The effects of disproportional load contributions on quantifying vegetated filter strip sediment trapping efficiencies. <em>Stoch Environ Res Risk Assess</em> <b>32</b>(8), 2369&ndash;2380. doi: <a href="http://doi.org/10.1007/s00477-017-1505-x">10.1007/s00477-017-1505-x</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# state college GHCN data
#
# weather &lt;- read.dly(system.file("extdata", "USC00368449.dly", package = "VFS"))
data("weather") # same object

weather.param &lt;- wth.param(weather, method="markov")

rain.compare &lt;- rainfall(365*3, weather.param)
temp.compare &lt;- temperature(365*3, weather.param)

data(soildat)
data(bufferdat)

# bluegrass buffer, clay loam soil
vfs.CL &lt;- VFS(nyears = 3, thissoil = subset(soildat, Soil == "CL"), 
rain=rain.compare, temperature=temp.compare, 
thisbuffer = subset(bufferdat, Species == "bluegrass"), Duration = 2, 
FieldArea = 4000, VFSwidth = 10.7, VFSslope = 0.02, 
z = 1000, b =1.5)

print(vfs.CL)
summary(vfs.CL)

aple.CL &lt;- VFSAPLE(vfs.CL, soilP = 120, OM = 2)

print(aple.CL)
summary(aple.CL)

</code></pre>

<hr>
<h2 id='APLE'>
Agricultural Phosphorus Loss Estimator 
</h2><span id='topic+APLE'></span>

<h3>Description</h3>

<p>Agricultural loss of phosphorus based on soil phosphorus level, additions of fertilizer and manure, and erosion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>APLE(soilP, clay, OM, precip, runoff, erosion, manureP = 25,
    manureSolids = 25, manureWEP = 50, manureIn = 40,
	fertP = 10, fertIn = 40)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="APLE_+3A_soilp">soilP</code></td>
<td>

<p>soil test Mehlich 3 phosphorus (mg/kg).
</p>
</td></tr>
<tr><td><code id="APLE_+3A_clay">clay</code></td>
<td>

<p>soil clay (%).
</p>
</td></tr>
<tr><td><code id="APLE_+3A_om">OM</code></td>
<td>

<p>soil organic matter (%).
</p>
</td></tr>
<tr><td><code id="APLE_+3A_precip">precip</code></td>
<td>

<p>annual precipitation (in).
</p>
</td></tr>
<tr><td><code id="APLE_+3A_runoff">runoff</code></td>
<td>

<p>annual runoff (in)
</p>
</td></tr>
<tr><td><code id="APLE_+3A_erosion">erosion</code></td>
<td>

<p>annual erosion (ton/ac).
</p>
</td></tr>
<tr><td><code id="APLE_+3A_manurep">manureP</code></td>
<td>

<p>manure P applied (kg/ha).
</p>
</td></tr>
<tr><td><code id="APLE_+3A_manuresolids">manureSolids</code></td>
<td>

<p>manure solids (%).
</p>
</td></tr>
<tr><td><code id="APLE_+3A_manurewep">manureWEP</code></td>
<td>

<p>manure water-extractable phosphorus/TP (%).
</p>
</td></tr>
<tr><td><code id="APLE_+3A_manurein">manureIn</code></td>
<td>

<p>manure incorporated (%).
</p>
</td></tr>
<tr><td><code id="APLE_+3A_fertp">fertP</code></td>
<td>

<p>fertilizer phosphorus applied (kg/ha).
</p>
</td></tr>
<tr><td><code id="APLE_+3A_fertin">fertIn</code></td>
<td>

<p>fertilizer incorporated (%).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements the basic version of the spreadsheet-based Agricultural Phosphorus Loss Estimator model (APLE) in R, and is vectorized. This model calculates annual phosphorus loss by compartment (due to erosion, dissolved soil phosphorus, dissolved manure, dissolved fertilizer) based rainfall, soil properties, and management.
The units match those of the original spreadsheet.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>lossErosion</code></td>
<td>
<p>soil erosion phosphorus loss (kg/ha).</p>
</td></tr>
<tr><td><code>lossDissolvedSoil</code></td>
<td>
<p>soil dissolved phosphorus loss (kg/ha).</p>
</td></tr>
<tr><td><code>lossDissolvedManure</code></td>
<td>
<p>manure dissolved phosphorus loss (kg/ha).</p>
</td></tr>
<tr><td><code>lossDissolvedFertilizer</code></td>
<td>
<p>fertilizer dissolved phosphorus loss (kg/ha).</p>
</td></tr>
<tr><td><code>lossTotal</code></td>
<td>
<p>total phosphorus loss (kg/ha).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>References</h3>

<p>Vadas, P. A., Good, L. W., Moore, P. A., Jr. and Widman, N. (2009) Estimating phosphorus loss in runoff from manure and fertilizer for a phosphorus loss quantification tool. <em>J Environ Qual</em> <b>38</b>, 1645&ndash;1653. doi: <a href="http://doi.org/10.2134/jeq2008.0337">10.2134/jeq2008.0337</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VFSAPLE">VFSAPLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
APLE(soilP = 127, clay = 17, OM = 6, precip = 35, runoff = 6,
erosion = 7, manureP = 25, manureSolids = 25, manureWEP = 50,
manureIn = 40, fertP = 10, fertIn = 40)

</code></pre>

<hr>
<h2 id='bufferdat'>
Parameters for vegetated buffers
</h2><span id='topic+bufferdat'></span>

<h3>Description</h3>

<p>Contains parameters describing vegetated filter strips for use in VFS modeling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bufferdat")</code></pre>


<h3>Format</h3>

<p>A data frame with 2 observations on the following 3 variables.
</p>

<dl>
<dt><code>Species</code></dt><dd><p>Type of buffer</p>
</dd>
<dt><code>bg</code></dt><dd><p>Average stem spacing (cm)</p>
</dd>
<dt><code>n</code></dt><dd><p>Manning's roughness coefficient (s m^(-1/3))</p>
</dd>
</dl>



<h3>Details</h3>

<p>Currently contains data for a cool-season and a warm-season grass buffer.
</p>


<h3>Source</h3>

<p>Haan CT, Barfield BJ, Hayes JC (1994) Design hydrology and sedimentology for small catchments. Acad. Press, San Diego
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	

# state college GHCN data
#
# weather &lt;- read.dly(system.file("extdata", "USC00368449.dly", package = "VFS"))
data("weather") # same object

weather.param &lt;- wth.param(weather, method="markov")

rain.compare &lt;- rainfall(365*2, weather.param)
temp.compare &lt;- temperature(365*2, weather.param)

data(soildat)
data(bufferdat)

# bluegrass buffer, clay loam soil
# short simulation to cut down on time required
vfs.CL &lt;- VFS(nyears = 2, thissoil = subset(soildat, Soil == "CL"), 
rain=rain.compare, temperature=temp.compare, 
thisbuffer = subset(bufferdat, Species == "bluegrass"), Duration = 2, 
FieldArea = 4000, VFSwidth = 10.7, VFSslope = 0.02, 
z = 1000, b = 1.5)

print(vfs.CL)
summary(vfs.CL)

aple.CL &lt;- VFSAPLE(vfs.CL, soilP = 120, OM = 2)

print(aple.CL)
summary(aple.CL)

</code></pre>

<hr>
<h2 id='MUSLE'>
Modified Universal Soil Loss Equation
</h2><span id='topic+MUSLE'></span>

<h3>Description</h3>

<p>Simulation of soil erosion on a daily timestep.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MUSLE(Q, qp, A, K, LS, C = 0.085, P = 0.40, a = 11.8, b = 0.56)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUSLE_+3A_q">Q</code></td>
<td>

<p>Runoff volume (m^3/d).
</p>
</td></tr>
<tr><td><code id="MUSLE_+3A_qp">qp</code></td>
<td>

<p>Runoff peak discharge (m^3/s).
</p>
</td></tr>
<tr><td><code id="MUSLE_+3A_a">A</code></td>
<td>

<p>Field area (ha).
</p>
</td></tr>
<tr><td><code id="MUSLE_+3A_k">K</code></td>
<td>

<p>Soil erodibility factor.
</p>
</td></tr>
<tr><td><code id="MUSLE_+3A_ls">LS</code></td>
<td>

<p>Landscape factor.
</p>
</td></tr>
<tr><td><code id="MUSLE_+3A_c">C</code></td>
<td>

<p>Crop management factor. Default is for a corn field.
</p>
</td></tr>
<tr><td><code id="MUSLE_+3A_p">P</code></td>
<td>

<p>Erosion control practice factor. 
</p>
</td></tr>
<tr><td><code id="MUSLE_+3A_a">a</code></td>
<td>

<p>Location coefficient. Default value from Williams 1975.
</p>
</td></tr>
<tr><td><code id="MUSLE_+3A_b">b</code></td>
<td>

<p>Location coefficient. Default value from Williams 1975.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses the Modified Universal Soil Loss Equation to estimate daily sediment yield. If K and LS are not known, they can be estimated from soil or field properties using <code>MUSLE.K</code> and <code>MUSLE.LS</code>.
</p>
<p>If the location coefficients are known from measured sedimentation data, more accurate estimates can be made.
</p>


<h3>Value</h3>

<p>Sediment yield (t/day).
</p>


<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>References</h3>

<p>Williams, J. R. (1975) Sediment-yield prediction with universal equation using runoff energy factor. Pp. 244&ndash;251 in: <em>Present and prospective technology for predicting sediment yield and sources.</em> ARS.S-40, US Gov. Print. Office, Washington, DC. 244-252.
</p>
<p>Wischmeier, W. H. and Smith, D. D. (1978) <em>Predicting rainfall erosion losses-a guide to conservation planning.</em> U.S. Department of Agriculture, Agriculture Handbook No. 537.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUSLE.K">MUSLE.K</a></code>, <code><a href="#topic+MUSLE.LS">MUSLE.LS</a></code>, <code><a href="#topic+peak">peak</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Approximate erodibility factor from soil texture.
Kf &lt;- MUSLE.K(.3, .5, .2)

# Calculate landscape factor from field size and shape.
# 100-m field length with 2% slope
# note that MUSLE.LS takes feet
LS &lt;- MUSLE.LS(100 * 3.28, .02)

# assume 0.4 ha cornfield with known rainfall intensity
peakd &lt;- peak(intensity = 55, area = 0.4)

SedYield &lt;- MUSLE(85, qp = peakd, A = .4, K = Kf, LS = LS)

</code></pre>

<hr>
<h2 id='MUSLE.K'>
Estimate soil erodibility factor K.
</h2><span id='topic+MUSLE.K'></span>

<h3>Description</h3>

<p>Estimates MUSLE soil erodibility from a multiple regression model of soil texture. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MUSLE.K(fc, fm, ff)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUSLE.K_+3A_fc">fc</code></td>
<td>

<p>Fraction of coarse material (sand) in the soil (0-1).
</p>
</td></tr>
<tr><td><code id="MUSLE.K_+3A_fm">fm</code></td>
<td>

<p>Fraction of medium material (silt) in the soil (0-1).
</p>
</td></tr>
<tr><td><code id="MUSLE.K_+3A_ff">ff</code></td>
<td>

<p>Fraction of fine material (clay) in the soil (0-1).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If K is not available from other sources, it can be estimated from soil texture (Goslee, in review).
</p>


<h3>Value</h3>

<p>Returns the soil erodibility factor K.
</p>


<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>References</h3>

<p>Wischmeier, W. H. and Smith, D. D. (1978) <em>Predicting rainfall erosion losses-a guide to conservation planning.</em> U.S. Department of Agriculture, Agriculture Handbook No. 537.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUSLE">MUSLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Approximate erodibility factor from soil texture.
Kf &lt;- MUSLE.K(.3, .5, .2)

# Calculate landscape factor from field size and shape.
# 100-m field length with 2% slope
# note that MUSLE.LS takes feet
LS &lt;- MUSLE.LS(100 * 3.28, .02)

# assume 0.4 ha cornfield with known rainfall intensity
peakd &lt;- peak(intensity = 55, area = 0.4)

SedYield &lt;- MUSLE(85, qp = peakd, A = .4, K = Kf, LS = LS)

</code></pre>

<hr>
<h2 id='MUSLE.LS'>
Estimate landscape factor LS
</h2><span id='topic+MUSLE.LS'></span>

<h3>Description</h3>

<p>Estimates MUSLE landscape factor for a homogeneous field from the field length and slope.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MUSLE.LS(FieldLength, FieldSlope)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MUSLE.LS_+3A_fieldlength">FieldLength</code></td>
<td>

<p>Field length (ft).
</p>
</td></tr>
<tr><td><code id="MUSLE.LS_+3A_fieldslope">FieldSlope</code></td>
<td>

<p>Field slope (ft/ft).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>MUSLE landscape factor LS.
</p>


<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>References</h3>

<p>Wischmeier, W. H. and Smith, D. D. (1978) <em>Predicting rainfall erosion losses-a guide to conservation planning.</em> U.S. Department of Agriculture, Agriculture Handbook No. 537.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MUSLE">MUSLE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Approximate erodibility factor from soil texture.
Kf &lt;- MUSLE.K(.3, .5, .2)

# Calculate landscape factor from field size and shape.
# 100-m field length with 2% slope
# note that MUSLE.LS takes feet
LS &lt;- MUSLE.LS(100 * 3.28, .02)

# assume 0.4 ha cornfield with known rainfall intensity
peakd &lt;- peak(intensity = 55, area = 0.4)

SedYield &lt;- MUSLE(85, qp = peakd, A = .4, K = Kf, LS = LS)

</code></pre>

<hr>
<h2 id='peak'>
Rational method to calculate peak discharge
</h2><span id='topic+peak'></span>

<h3>Description</h3>

<p>Very simple estimate of peak discharge.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>peak(intensity, area, c = 0.25)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="peak_+3A_intensity">intensity</code></td>
<td>

<p>Precipitation intensity (mm/hr).
</p>
</td></tr>
<tr><td><code id="peak_+3A_area">area</code></td>
<td>

<p>Field area (ha).
</p>
</td></tr>
<tr><td><code id="peak_+3A_c">c</code></td>
<td>

<p>Runoff coefficient, related to slope, soil type, and land cover (0-1). Forest may be 0.05 - 0.25, while paved surfaces may be 0.95.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Peak discharge (m^3/s).
</p>


<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>References</h3>

<p>Hromadka, T. V, II and Whitley, R. J. (1994) The rational method for peak flow rate estimation. <em>Water Res Bull</em> <b>30</b>(6), 1001&ndash;1009.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
    # peak discharge from a grassy meadow
    peakd.meadow &lt;- peak(intensity = 55, area = 1, c = 0.1)

    # peak discharge from an urban area
    peakd.urban &lt;- peak(intensity = 55, area = 1, c = 0.8)

</code></pre>

<hr>
<h2 id='print.APLE'>
Printing the result of APLE
</h2><span id='topic+print.APLE'></span>

<h3>Description</h3>

<p>Print method for APLE objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'APLE'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.APLE_+3A_x">x</code></td>
<td>

<p>An APLE object produced by <code>APLE</code> or <code>VFSAPLE</code>.
</p>
</td></tr>
<tr><td><code id="print.APLE_+3A_...">...</code></td>
<td>

<p>Other arguments to print.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prints the annual mean for erosion, soil dissolved, manure dissolved, fertilizer dissolved, and total phosphorus losses.
</p>


<h3>Value</h3>

<p>Returns the APLE object x invisibly.
</p>


<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>See Also</h3>

<p><code><a href="#topic+APLE">APLE</a></code>, <code><a href="#topic+VFSAPLE">VFSAPLE</a></code>, <code><a href="#topic+summary.APLE">summary.APLE</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- APLE(soilP = 127, clay = 17, OM = 6, precip = 35, runoff = 6,
	erosion = 7, manureP = 25, manureSolids = 25, manureWEP = 50,
	manureIn = 40, fertP = 10, fertIn = 40)

print(x)
summary(x)

</code></pre>

<hr>
<h2 id='print.VFS'>
Printing the result of VFS
</h2><span id='topic+print.VFS'></span>

<h3>Description</h3>

<p>Print method for VFS objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'VFS'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.VFS_+3A_x">x</code></td>
<td>

<p>A VFS x produced by VFS().
</p>
</td></tr>
<tr><td><code id="print.VFS_+3A_...">...</code></td>
<td>

<p>Other arguments to print.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the VFS object has a modeled filter strip, the mean annual loads in and out, as well as removal efficiencies are printed. Otherwise only the erosion values from the field are printed.
</p>


<h3>Value</h3>

<p>It returns the VFS object invisibly.
</p>


<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VFS">VFS</a></code>, <code><a href="#topic+summary.VFS">summary.VFS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# state college GHCN data
#
# weather &lt;- read.dly(system.file("extdata", "USC00368449.dly", package = "VFS"))
data("weather") # same object

weather.param &lt;- wth.param(weather, method="markov")

rain.compare &lt;- rainfall(365*2, weather.param)
temp.compare &lt;- temperature(365*2, weather.param)

data(soildat)
data(bufferdat)

# bluegrass buffer, clay loam soil
# short simulation to cut down on time required
vfs.CL &lt;- VFS(nyears = 2, thissoil = subset(soildat, Soil == "CL"), 
rain=rain.compare, temperature=temp.compare, 
thisbuffer = subset(bufferdat, Species == "bluegrass"), Duration = 2, 
FieldArea = 4000, VFSwidth = 10.7, VFSslope = 0.02, 
z = 1000, b = 1.5)

print(vfs.CL)
summary(vfs.CL)

</code></pre>

<hr>
<h2 id='rainfall'>
Generate simulated daily rainfall
</h2><span id='topic+rainfall'></span>

<h3>Description</h3>

<p>Generates simulated daily rainfall based on parameters derived from daily weather data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	rainfall(ndays, thiswth, months)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rainfall_+3A_ndays">ndays</code></td>
<td>

<p>Number of days to simulate.
</p>
</td></tr>
<tr><td><code id="rainfall_+3A_thiswth">thiswth</code></td>
<td>

<p>Output of <code>wth.param</code> The choice of method in <code>wth.param()</code> determines what coefficients are provided, and thus which rainfall simulation method is used.
</p>
</td></tr>
<tr><td><code id="rainfall_+3A_months">months</code></td>
<td>

<p>If the rainfall simulation method uses monthly statistics (Markov), a vector of month numbers of <code>length(ndays)</code> may be provided. If it is missing, then January 1 is assumed to be the first day of a 365-day year.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The rainfall simulation currently offers choice of two methods: the simple Poisson model of Rodriguez-Iturbe et al. (1999), and the Markov chain model of Nicks (1974). The latter rainfall calculation is used by the APEX farm model, among others, and is based on monthly statistics.
</p>


<h3>Value</h3>

<p>A vector of daily rainfall totals.
</p>


<h3>Author(s)</h3>

<p>Heather Gall and Sarah Goslee 
</p>


<h3>References</h3>

<p>Rodriguez-Iturbe, I., Porporato, A., Ridolfi, L., Isham, V. and Coxi, D. R. (1999) Probabilistic modelling of water balance at a point: the role of climate, soil and vegetation. <em>Proc Royal Soc A</em> <b>455</b>, 269&ndash;288.
</p>
<p>Nicks, A. D. (1974) Stochastic generation of the occurrence, pattern and location of maximum amount of daily rainfall. Pp. 154&ndash;171 in: <em>Proceedings Symposium on Statistical Hydrology.</em> USDA Agricultural Research Service Miscellaneous Publication No. 1275, Washington, DC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wth.param">wth.param</a></code>,
<code><a href="#topic+temperature">temperature</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# GHCN daily weather file for State College, PA
# subset of data (2000-2009) for station USC00368449
#
data("weather") # same object


# calculate parameters for the poisson model
# using 0.3 mm as the lower limit for wet days.
weather.param.p &lt;- wth.param(weather, method = "poisson", llim = 0.3)

# simulate ten years of rainfall
rain10.p &lt;- rainfall(365*10, weather.param.p)

# increase per-event rainfall by 5 mm
weather.param.p5 &lt;- weather.param.p
weather.param.p5$params$depth &lt;- weather.param.p5$params$depth + 5
rain10.p5 &lt;- rainfall(365*10, weather.param.p5)

# calculate parameters for the Markov chain model
# using 0.3 mm as the lower limit for wet days.
weather.param.m &lt;- wth.param(weather, method = "markov", llim = 0.3)

# rainfall() selects Markov model based on input parameter types
rain10.m &lt;- rainfall(365*10, weather.param.m)

# simulate 10 years of temperature
temp10 &lt;- temperature(365*10, weather.param.p)

</code></pre>

<hr>
<h2 id='read.dly'>
Read GHCN DLY daily weather file into a data frame
</h2><span id='topic+read.dly'></span>

<h3>Description</h3>

<p>Imports daily data files from the <a href="https://www.ncdc.noaa.gov/data-access/land-based-station-data/land-based-datasets/global-historical-climatology-network-ghcn">Global Historical Climatology Network (GHCN)</a>, replaces nodata values with NA, and converts precipitation to mm and temperature to C.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.dly(filename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read.dly_+3A_filename">filename</code></td>
<td>

<p>Filename or URL of a GHCN DLY file.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All GHCN DLY files should have these five elements: PRCP (precipitation, originally tenths of a mm but mm in the function output); SNOW (snowfall, mm); SNWD (snow depth, mm), TMAX (maximum temperature, originally tenths of degree C but C in the function output), and  TMIN (minimum temperature, originally tenths of degree C but C in the function output). 
</p>
<p>Depending on the station, there may be many other recorded variables. Each variable is accompanied by a series of quality flags, which are preserved from the original file.
</p>
<p>Data are in a complex fixed-width format. Please see the <a href="https://www1.ncdc.noaa.gov/pub/data/ghcn/daily/readme.txt">GHCN readme</a> for details.
</p>


<h3>Value</h3>

<p>Returns a data frame with date as three columns, YEAR, MONTH, DAY, and each data value present in the original file along with its quality flags. Please see the <a href="https://www1.ncdc.noaa.gov/pub/data/ghcn/daily/readme.txt">GHCN readme</a> for details.
</p>
<p>Note that units for temperature and precipitation have been converted from the GHCN values.
</p>
<p>These columns will always be present in the output:
</p>

<dl>
<dt><code>YEAR</code></dt><dd><p>Year.</p>
</dd>
<dt><code>MONTH</code></dt><dd><p>Month number.</p>
</dd>
<dt><code>DAY</code></dt><dd><p>Day of month.</p>
</dd>
<dt><code>PRCP</code></dt><dd><p>Precipitation (mm).</p>
</dd>
<dt><code>TMAX</code></dt><dd><p>Maximum temperature (C).</p>
</dd>
<dt><code>TMIN</code></dt><dd><p>Minimum temperature (C).</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>References</h3>

<p><a href="https://www.ncdc.noaa.gov/data-access/land-based-station-data/land-based-datasets/global-historical-climatology-network-ghcn">GHCN</a> data comprises both current and historical weather station data world-wide. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wth.param">wth.param</a></code>, <code><a href="#topic+weather">weather</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ten years of daily weather data, 2000-2009, for State College, PA
weather &lt;- read.dly(system.file("extdata", "USC00368449.dly", package = "VFS"))

# could also use: 
# weather &lt;- read.dly("ftp://ftp.ncdc.noaa.gov/pub/data/ghcn/daily/all/USC00368449.dly")
# weather &lt;- subset(weather, YEAR &gt;= 2000 &amp; YEAR &lt;= 2009)

# daily precipitation
summary(weather$PRCP.VALUE)

# monthly average maximum temperature
aggregate(TMAX.VALUE ~ MONTH, FUN = mean, data = weather)

# generate simulation values
weather.params &lt;- wth.param(weather)
</code></pre>

<hr>
<h2 id='soildat'>
Soil texture class properties
</h2><span id='topic+soildat'></span>

<h3>Description</h3>

<p>Basic hydrologic properties for twelve soil texture classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("soildat")</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on the following 9 variables.
</p>

<dl>
<dt><code>Soil</code></dt><dd><p>Texture class abbreviation.</p>
</dd>
<dt><code>SoilName</code></dt><dd><p>Texture class name.</p>
</dd>
<dt><code>Ksat</code></dt><dd><p>Saturated hydraulic conductivity (mm d^(-1)).</p>
</dd>
<dt><code>ThetaSAT</code></dt><dd><p>Water potential at saturation.</p>
</dd>
<dt><code>ThetaFC</code></dt><dd><p>Water potential at field capacity.</p>
</dd>
<dt><code>ThetaWP</code></dt><dd><p>Water potential at wilt point.</p>
</dd>
<dt><code>ff</code></dt><dd><p>Fraction of fine (clay) particles.</p>
</dd>
<dt><code>fm</code></dt><dd><p>Fraction of medium (silt) particles.</p>
</dd>
<dt><code>fc</code></dt><dd><p>Fraction of coarse (sand) particles.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Clapp, RB, Hornberger, GM. 1978. Empirical equations for some soil hydraulic properties. Water Resour Res 14:601-604. DOI: 10.1029/WR014i004p00601.
</p>
<p>Karkanis, PG. 1983. Determining field capacity and wilting point using soil saturation by capillary rise. Can Agr Eng 25:19-21.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# state college GHCN data
#
# weather &lt;- read.dly(system.file("extdata", "USC00368449.dly", package = "VFS"))
data("weather") # same object

weather.param &lt;- wth.param(weather, method="markov")

rain.compare &lt;- rainfall(365*2, weather.param)
temp.compare &lt;- temperature(365*2, weather.param)

data(soildat)
data(bufferdat)

# bluegrass buffer, clay loam soil
# short simulation to cut down on time required
vfs.CL &lt;- VFS(nyears = 2, thissoil = subset(soildat, Soil == "CL"), 
rain=rain.compare, temperature=temp.compare, 
thisbuffer = subset(bufferdat, Species == "bluegrass"), Duration = 2, 
FieldArea = 4000, VFSwidth = 10.7, VFSslope = 0.02, 
z = 1000, b = 1.5)

print(vfs.CL)
summary(vfs.CL)

aple.CL &lt;- VFSAPLE(vfs.CL, soilP = 120, OM = 2)

print(aple.CL)
summary(aple.CL)

</code></pre>

<hr>
<h2 id='summary.APLE'>
Summarize the result of APLE
</h2><span id='topic+summary.APLE'></span>

<h3>Description</h3>

<p>Summary method for APLE objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'APLE'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.APLE_+3A_object">object</code></td>
<td>

<p>APLE object produced by <code>APLE</code>.
</p>
</td></tr>
<tr><td><code id="summary.APLE_+3A_...">...</code></td>
<td>

<p>Other arguments to summary
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates means for phosphorus loss.
</p>


<h3>Value</h3>

<p>Summary of APLE object.
</p>


<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>See Also</h3>

<p><code><a href="#topic+APLE">APLE</a></code>, <code><a href="#topic+VFSAPLE">VFSAPLE</a></code>, <code><a href="#topic+print.APLE">print.APLE</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- APLE(soilP = 127, clay = 17, OM = 6, precip = 35, runoff = 6,
	erosion = 7, manureP = 25, manureSolids = 25, manureWEP = 50,
	manureIn = 40, fertP = 10, fertIn = 40)

print(x)
summary(x)

</code></pre>

<hr>
<h2 id='summary.VFS'>
Summarize the result of VFS
</h2><span id='topic+summary.VFS'></span>

<h3>Description</h3>

<p>Summary method for VFS objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'VFS'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.VFS_+3A_object">object</code></td>
<td>

<p>A VFS object produced by VFS().
</p>
</td></tr>
<tr><td><code id="summary.VFS_+3A_...">...</code></td>
<td>

<p>Other arguments to summary
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates means and standard deviations for annual removal efficiencies. If model type is erosion-only (no vegetated filter strip simulated), then only the relevant variables describing erosion from the field are returned.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>ALR</code></td>
<td>
<p>Annual load reduction.</p>
</td></tr> 
<tr><td><code>ALRsd</code></td>
<td>
<p>SD of annual load reduction.</p>
</td></tr>
<tr><td><code>ALR1000</code></td>
<td>
<p>Load reduction across full timespan.</p>
</td></tr>
<tr><td><code>ALR1000sd</code></td>
<td>
<p>SD of load reduction across full timespan.</p>
</td></tr>
<tr><td><code>APEA</code></td>
<td>
<p>Annual per-event average reduction.</p>
</td></tr>
<tr><td><code>APEAsd</code></td>
<td>
<p>SD of annual per-event average reduction.</p>
</td></tr>
<tr><td><code>SedIn</code></td>
<td>
<p>Sediment entering the vegetated filter strip per year.</p>
</td></tr> 
<tr><td><code>SedInsd</code></td>
<td>
<p>SD of sediment entering the vegetated filter strip per year.</p>
</td></tr>
<tr><td><code>SedLoss</code></td>
<td>
<p>Sediment lost per year.</p>
</td></tr> 
<tr><td><code>SedLosssd</code></td>
<td>
<p>SD of sediment lost per year.</p>
</td></tr>
<tr><td><code>TLR</code></td>
<td>
<p>Total load reduction.</p>
</td></tr>
<tr><td><code>RunoffDays</code></td>
<td>
<p>Days per year with runoff.</p>
</td></tr>
<tr><td><code>RunoffDayssd</code></td>
<td>
<p>SD of days per year with runoff.</p>
</td></tr>
<tr><td><code>Days</code></td>
<td>
<p>Total number of days.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VFS">VFS</a></code>, <code><a href="#topic+print.VFS">print.VFS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# state college GHCN data
#
# weather &lt;- read.dly(system.file("extdata", "USC00368449.dly", package = "VFS"))
data("weather") # same object

weather.param &lt;- wth.param(weather, method="markov")

rain.compare &lt;- rainfall(365*2, weather.param)
temp.compare &lt;- temperature(365*2, weather.param)

data(soildat)
data(bufferdat)

# bluegrass buffer, clay loam soil
# short simulation to cut down on time required
vfs.CL &lt;- VFS(nyears = 2, thissoil = subset(soildat, Soil == "CL"), 
rain=rain.compare, temperature=temp.compare, 
thisbuffer = subset(bufferdat, Species == "bluegrass"), Duration = 2, 
FieldArea = 4000, VFSwidth = 10.7, VFSslope = 0.02, 
z = 1000, b = 1.5)

print(vfs.CL)
summary(vfs.CL)

</code></pre>

<hr>
<h2 id='temperature'>
Generate simulated mean temperature
</h2><span id='topic+temperature'></span>

<h3>Description</h3>

<p>Generates simulated daily temperature minimum and maximum based on parameters derived from daily weather data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	temperature(ndays, thiswth)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="temperature_+3A_ndays">ndays</code></td>
<td>

<p>number of days to simulate
</p>
</td></tr>
<tr><td><code id="temperature_+3A_thiswth">thiswth</code></td>
<td>

<p>list output of <code>wth.param</code>. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a very simple temperature simulation, using three parameters derived from daily weather data and the day of year to calculate a smooth annual temperature change derived from the first harmonic of a Fourier function.
</p>


<h3>Value</h3>

<p>Returns a vector of daily mean temperature (X).
</p>


<h3>Author(s)</h3>

<p>Heather Gall and Sarah Goslee
</p>


<h3>References</h3>

<p>Grimenes, A. and Nissen, O. (2004) Mathematical modeling of the annual temperature wave based on monthly mean temperatures, and comparisons between local climate trends at seven Norwegian stations. <em>Theor Appl Climatol</em> <b>78</b>, 229&ndash;246. doi: <a href="http://doi.org/10.1007/s00704-004-0036-9">10.1007/s00704-004-0036-9</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wth.param">wth.param</a></code>,
<code><a href="#topic+rainfall">rainfall</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A sample GHCN daily weather file for State College, PA, is included with this package.
# This file contains a subset of data (1980-2009) for station USC00368449
data("weather") 

# calculate parameters for the poisson model, using 0.3 mm as the lower limit for wet days.
weather.param.p &lt;- wth.param(weather, method = "poisson", llim = 0.3)

# simulate 10 years of temperature
temp10 &lt;- temperature(365*10, weather.param.p)

</code></pre>

<hr>
<h2 id='USC00368449.dly'>
GHCN Data for State College, PA, 1980-2009
</h2><span id='topic+USC00368449.dly'></span>

<h3>Description</h3>

<p>A ten-year sample of <a href="https://www.ncdc.noaa.gov/data-access/land-based-station-data/land-based-datasets/global-historical-climatology-network-ghcn">Global Historical Climatology Network (GHCN)</a> daily weather data for State College, PA (station USC00368449). This is in a complex fixed-width format. Please see the <a href="https://www1.ncdc.noaa.gov/pub/data/ghcn/daily/readme.txt">GHCN readme</a> for details. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>"USC00368449.dly"</code></pre>


<h3>Format</h3>

<p>A complex fixed-width ASCII file.
</p>


<h3>Source</h3>

<p><a href="https://www.ncdc.noaa.gov/data-access/land-based-station-data/land-based-datasets/global-historical-climatology-network-ghcn">GHCN</a> data comprises both current and historical weather station data world-wide. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.dly">read.dly</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A sample DLY file for State College, PA, is included with this package.
# This file contains a subset of data (1980-2009) for station USC00368449
#
weather &lt;- read.dly(system.file("extdata", "USC00368449.dly", package = "VFS"))
# identical to data("weather")
</code></pre>

<hr>
<h2 id='VFS'>
Vegetated filter strip and erosion model
</h2><span id='topic+VFS'></span>

<h3>Description</h3>

<p>Simulated erosion and runoff given climate and soil texture, with or without a vegetated filter strip in place.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VFS(nyears = 1000, thissoil, thisbuffer, rain, temperature, 
  Duration = 2, FieldArea = 4000, VFSwidth = 10.7, VFSslope = 0.02,
  FieldSlope,  z = 1000, a = 1, b = 1.5,
  carrysoilwater = TRUE, runoffcalc = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VFS_+3A_nyears">nyears</code></td>
<td>

<p>Number of years to simulate.
</p>
</td></tr>
<tr><td><code id="VFS_+3A_thissoil">thissoil</code></td>
<td>

<p>Soil properties for the site, as from soildat.
</p>
</td></tr>
<tr><td><code id="VFS_+3A_thisbuffer">thisbuffer</code></td>
<td>

<p>Vegetation properties for the buffer strip, as from bufferdat.
</p>
</td></tr>
<tr><td><code id="VFS_+3A_rain">rain</code></td>
<td>

<p>Daily rainfall (mm).
</p>
</td></tr>
<tr><td><code id="VFS_+3A_temperature">temperature</code></td>
<td>

<p>Daily mean temperature (C).
</p>
</td></tr>
<tr><td><code id="VFS_+3A_duration">Duration</code></td>
<td>

<p>Rainfall event length. Default is 2 hours.
</p>
</td></tr>
<tr><td><code id="VFS_+3A_fieldarea">FieldArea</code></td>
<td>

<p>Field area (m^2).
</p>
</td></tr>
<tr><td><code id="VFS_+3A_vfswidth">VFSwidth</code></td>
<td>

<p>Filter strip width (m).
</p>
</td></tr>
<tr><td><code id="VFS_+3A_vfsslope">VFSslope</code></td>
<td>

<p>Filter strip slope (m/m).
</p>
</td></tr>
<tr><td><code id="VFS_+3A_fieldslope">FieldSlope</code></td>
<td>

<p>Optional field slope (m/m). If missing, VFSslope will be used.
</p>
</td></tr>
<tr><td><code id="VFS_+3A_z">z</code></td>
<td>

<p>Rooting zone depth (mm). Default is 1000 mm. 
</p>
</td></tr>
<tr><td><code id="VFS_+3A_a">a</code></td>
<td>

<p>Empirical parameter that relates concentration and flow in the concentration-discharge relationship, C = aQ^b.
</p>
</td></tr>
<tr><td><code id="VFS_+3A_b">b</code></td>
<td>

<p>Empirical parameter that relates concentration and flow in the concentration-discharge relationship, C = aQ^b. May be a single value or a vector of values.
</p>
</td></tr>
<tr><td><code id="VFS_+3A_carrysoilwater">carrysoilwater</code></td>
<td>

<p>Boolean describing whether to store soil water; if FALSE, soil is always at field capacity. This option allows the effect of soil water storage to be quantified.
</p>
</td></tr>
<tr><td><code id="VFS_+3A_runoffcalc">runoffcalc</code></td>
<td>

<p>Boolean describing whether to use intensity and saturation exceedances; if FALSE, all rainfall becomes runoff. This option allows the effect of runoff calculation to be quantified.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The concentration-discharge (C-Q) model of erosion is intended to produce relative erosion values, rather than absolute values, but will produce absolute values if a and b are known.
The MUSLE field erosion model is run alongside the C-Q model. The K factor is estimated from soil texture data using <code>MUSLE.K</code>, and the LS factor from field properties using <code>MUSLE.LS</code>.
Blaney-Criddle coefficients for evapotranspiration calculations from a cornfield are hard-coded; a future update will allow for varying the type of field.
</p>


<h3>Value</h3>

<p>Returns an object of class VFS, comprising:
</p>
<table role = "presentation">
<tr><td><code>daily</code></td>
<td>
<p>Daily output of all public variables that change as a function of time. The data frame has columns:</p>
</td></tr>
</table>

<ul>
<li><p>rain: precipitation (mm).
</p>
</li>
<li><p>temperature: mean temperature (C).
</p>
</li>
<li><p>S: soil water storage, (mm).
</p>
</li>
<li><p>kt: Blaney-Criddle temperature coefficient.
</p>
</li>
<li><p>ET: evapotranspiration (mm).
</p>
</li>
<li><p>intensity: rainfall intensity (mm).
</p>
</li>
<li><p>runoff: runoff (mm).
</p>
</li>
<li><p>Q: discharge (ft^3/s).
</p>
</li>
<li><p>fd: flow depth through VFS (ft).
</p>
</li>
<li><p>R: hydraulic radius of filter strip (ft).
</p>
</li>
<li><p>Vm: Manning's velocity (ft/s).
</p>
</li>
<li><p>Re: Reynold's number.
</p>
</li>
<li><p>Va: actual shear stress (ft/s).
</p>
</li>
<li><p>Nfc: Fall number for coarse particles.
</p>
</li>
<li><p>Nfm: Fall number for medium particles.
</p>
</li>
<li><p>Nff: Fall number for fine particles.
</p>
</li>
<li><p>fdc: Trapping efficiency for coarse particles.
</p>
</li>
<li><p>fdm: Trapping efficiency for medium particles.
</p>
</li>
<li><p>fdf: Trapping efficiency for fine particles.
</p>
</li>
<li><p>Ft: Total trapping efficiency of filter strip.
</p>
</li>
<li><p>peakflow: peak flow (m^3/s).
</p>
</li></ul>

<table role = "presentation">
<tr><td><code>field</code></td>
<td>
<p>Data on the field being modeled:</p>
</td></tr>
</table>

<ul>
<li><p>clay: soil clay content (%.)
</p>
</li>
<li><p>area: field area (m^2).
</p>
</li></ul>

<table role = "presentation">
<tr><td><code>Conc</code></td>
<td>
<p>Sediment concentration (in mass/volume) as calculated by the relationship C = aQ^b; specific units depend on units conversions included in the value of a.</p>
</td></tr>
<tr><td><code>MassIn</code></td>
<td>
<p>Sediment load (mass) from the C-Q model, as calculated by multiplying concentration and runoff volume. If concentration is assumed to be in g/L, then the load is calculated in g.</p>
</td></tr>
<tr><td><code>MassOut</code></td>
<td>
<p>Sediment mass from the C-Q model that leaves the vegetated filter strip at the end of a runoff event (i.e., the mass that is not removed).</p>
</td></tr>
<tr><td><code>MassRemoved</code></td>
<td>
<p>Sediment mass from the C-Q model that remains in the vegetated filter strip at the end of a runoff event.</p>
</td></tr>
<tr><td><code>AnnualMassIn</code></td>
<td>
<p>Sum of the sediment loads from the C-Q model entering the vegetated filter strip over the course of one year.</p>
</td></tr>
<tr><td><code>AnnualMassOut</code></td>
<td>
<p>Sum of the sediment loads from the C-Q model leaving the vegetated filter strip over the course of one year.</p>
</td></tr>
<tr><td><code>AnnualRemovalEfficiency</code></td>
<td>
<p>The removal effficiency from the C-Q model of the vegetated filter strip at an annual time scale (%).</p>
</td></tr>
<tr><td><code>MassInMUSLE</code></td>
<td>
<p>Sediment mass from the MUSLE model leaving the crop field .</p>
</td></tr>
<tr><td><code>MassOutMUSLE</code></td>
<td>
<p>Sediment mass from the MUSLE model that leaves the vegetated filter strip at the end of a runoff event (t/day).</p>
</td></tr>
<tr><td><code>MassRemovedMUSLE</code></td>
<td>
<p>Sediment mass that remains in the vegetated filter strip at the end of a runoff event (t/day).</p>
</td></tr>
<tr><td><code>AnnualMassInMUSLE</code></td>
<td>
<p>Sum of the sediment loads entering the vegetated filter strip over the course of one year (t).</p>
</td></tr>
<tr><td><code>AnnualMassOutMUSLE</code></td>
<td>
<p>Sum of the sediment loads leaving the vegetated filter strip over the course of one year (t).</p>
</td></tr>
<tr><td><code>AnnualRemovalEfficiencyMUSLE</code></td>
<td>
<p>The removal effficiency of the vegetated filter strip at an annual time scale (%).</p>
</td></tr>
<tr><td><code>Ftannual</code></td>
<td>
<p>Filter strip removal efficiency.</p>
</td></tr>
<tr><td><code>Ftannualavg</code></td>
<td>
<p>The average of all per-event trapping efficiencies over the course of one year.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Heather Gall, Sarah Goslee, and Tamie Veith
</p>


<h3>References</h3>

<p>Gall, H. E., Schultz, D., Veith, T. L, Goslee, S. C., Mejia, A., Harman, C. J., Raj, C. and Patterson, P. H. (2018) The effects of disproportional load contributions on quantifying vegetated filter strip sediment trapping efficiencies. <em>Stoch Environ Res Risk Assess</em> <b>32</b>(8), 2369&ndash;2380. doi: <a href="http://doi.org/10.1007/s00477-017-1505-x">10.1007/s00477-017-1505-x</a>
</p>
<p>Haan C. T., Barfield B. J. and Hayes J. C. (1994) <em>Design hydrology and sedimentology for small catchments.</em> Acad Press, San Diego.
</p>
<p>Williams, J. R. (1975) Sediment-yield prediction with universal equation using runoff energy factor. Pp. 244&ndash;251 in: <em>Present and prospective technology for predicting sediment yield and sources.</em> ARS.S-40, US Gov. Print. Office, Washington, DC. 244-252.
</p>
<p>Wischmeier, W. H. and Smith, D. D. (1978) <em>Predicting rainfall erosion losses-a guide to conservation planning.</em> U.S. Department of Agriculture, Agriculture Handbook No. 537.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.VFS">print.VFS</a></code>, <code><a href="#topic+summary.VFS">summary.VFS</a></code>, <code><a href="#topic+wth.param">wth.param</a></code>, <code><a href="#topic+soildat">soildat</a></code>, <code><a href="#topic+bufferdat">bufferdat</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# state college GHCN data
#
# weather &lt;- read.dly(system.file("extdata", "USC00368449.dly", package = "VFS"))
data("weather") # same object

weather.param &lt;- wth.param(weather, method="markov")

rain.compare &lt;- rainfall(365*2, weather.param)
temp.compare &lt;- temperature(365*2, weather.param)

data(soildat)
data(bufferdat)

# bluegrass buffer, clay loam soil
# short simulation to cut down on time required
vfs.CL &lt;- VFS(nyears = 2, thissoil = subset(soildat, Soil == "CL"), 
rain=rain.compare, temperature=temp.compare, 
thisbuffer = subset(bufferdat, Species == "bluegrass"), Duration = 2, 
FieldArea = 4000, VFSwidth = 10.7, VFSslope = 0.02, 
z = 1000, b = 1.5)

print(vfs.CL)
summary(vfs.CL)

aple.CL &lt;- VFSAPLE(vfs.CL, soilP = 120, OM = 2)

print(aple.CL)
summary(aple.CL)

</code></pre>

<hr>
<h2 id='VFSAPLE'>
Link the VFS and APLE models.
</h2><span id='topic+VFSAPLE'></span>

<h3>Description</h3>

<p>Uses the erosion and runoff output of VFS as input to APLE. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VFSAPLE(x, soilP, OM, manureP = 25, manureSolids = 25, manureWEP = 50,
    manureIn = 40, fertP = 10, fertIn = 40)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VFSAPLE_+3A_x">x</code></td>
<td>

<p>VFS object.
</p>
</td></tr>
<tr><td><code id="VFSAPLE_+3A_soilp">soilP</code></td>
<td>

<p>soil test Mehlich 3 phosphorus (mg/kg).
</p>
</td></tr>
<tr><td><code id="VFSAPLE_+3A_om">OM</code></td>
<td>

<p>soil organic matter (%).
</p>
</td></tr>
<tr><td><code id="VFSAPLE_+3A_manurep">manureP</code></td>
<td>

<p>manure P applied (kg/ha).
</p>
</td></tr>
<tr><td><code id="VFSAPLE_+3A_manuresolids">manureSolids</code></td>
<td>

<p>manure solids (%).
</p>
</td></tr>
<tr><td><code id="VFSAPLE_+3A_manurewep">manureWEP</code></td>
<td>

<p>manure water-extractable phosphorus/TP (%).
</p>
</td></tr>
<tr><td><code id="VFSAPLE_+3A_manurein">manureIn</code></td>
<td>

<p>manure incorporated (%).
</p>
</td></tr>
<tr><td><code id="VFSAPLE_+3A_fertp">fertP</code></td>
<td>

<p>fertilizer phosphorus applied (kg/ha).
</p>
</td></tr>
<tr><td><code id="VFSAPLE_+3A_fertin">fertIn</code></td>
<td>

<p>fertilizer incorporated (%).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>VFSAPLE</code> function handles unit conversion and parameter estimation. Erosion, precipitation, runoff, and field parameters from <code>VFS</code> are passed to <code>APLE</code>. It also runs <code>APLE</code> for both pre- and post-filter strip erosion values, so the efficacy of the filter strip at phosphorus removal can be calculated.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>preVFS</code></td>
<td>
<p>APLE object for pre-filter strip erosion values.</p>
</td></tr>
<tr><td><code>postVFS</code></td>
<td>
<p>APLE object for post-filter strip erosion values.</p>
</td></tr>
<tr><td><code>pErosion</code></td>
<td>
<p>Efficacy of the filter strip at removing erosion phosphorus (%).</p>
</td></tr>
<tr><td><code>pTotal</code></td>
<td>
<p>Efficacy of the fiter strip at removing total phosphorus (%).</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>See Also</h3>

<p><code><a href="#topic+APLE">APLE</a></code>, <code><a href="#topic+VFS">VFS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># state college GHCN data
#
# weather &lt;- read.dly(system.file("extdata", "USC00368449.dly", package = "VFS"))
data("weather") # same object

weather.param &lt;- wth.param(weather, method="markov")

rain.compare &lt;- rainfall(365*2, weather.param)
temp.compare &lt;- temperature(365*2, weather.param)

data(soildat)
data(bufferdat)

# bluegrass buffer, clay loam soil
# short simulation to cut down on time required
vfs.CL &lt;- VFS(nyears = 2, thissoil = subset(soildat, Soil == "CL"), 
rain=rain.compare, temperature=temp.compare, 
thisbuffer = subset(bufferdat, Species == "bluegrass"), Duration = 2, 
FieldArea = 4000, VFSwidth = 10.7, VFSslope = 0.02, 
z = 1000, b = 1.5)

print(vfs.CL)
summary(vfs.CL)

aple.CL &lt;- VFSAPLE(vfs.CL, soilP = 120, OM = 2)

print(aple.CL)
summary(aple.CL)
</code></pre>

<hr>
<h2 id='weather'>
Ten years of daily weather data
</h2><span id='topic+weather'></span>

<h3>Description</h3>

<p>The <code>VFS</code> offers the capability of importing weather data from the GHCN, either from local files or the online repository, but this import is slow, so the result of the import is saved as an R object for those examples that need it.
</p>
<p>The original GHCN file has many more columns. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("weather")</code></pre>


<h3>Format</h3>

<p>A data frame with 3653 observations on the following 8 variables.
</p>

<dl>
<dt><code>YEAR</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>MONTH</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>DAY</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>PRCP.VALUE</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>SNOW.VALUE</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>SNWD.VALUE</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>TMAX.VALUE</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>TMIN.VALUE</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.ncdc.noaa.gov/data-access/land-based-station-data/land-based-datasets/global-historical-climatology-network-ghcn">GHCN</a> data comprises both current and historical weather station data world-wide.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wth.param">wth.param</a></code>, <code><a href="#topic+read.dly">read.dly</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# state college GHCN data
#
# created by:
# weather &lt;- read.dly(system.file("extdata", "USC00368449.dly", package = "VFS"))
data("weather") # same object: 10 years of daily weather data

weather.param &lt;- wth.param(weather, method="markov")

rain.compare &lt;- rainfall(365*3, weather.param)
temp.compare &lt;- temperature(365*3, weather.param)

</code></pre>

<hr>
<h2 id='wth.param'>
Calculate weather parameters from daily data for use in climate simulations
</h2><span id='topic+wth.param'></span>

<h3>Description</h3>

<p>The climate generation functions for rainfall and temperature require parameters calculated from GHCN daily weather data, or from any data frame with columns containing year, month, day, precipitation, and minimum and maximum temperature.
Partial years at the beginning or end of the dataset are removed. Leap days are also removed to standardize day-of-year calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wth.param(dly, llim = 0, method = "poisson", year.col = "YEAR", 
	month.col = "MONTH", day.col = "DAY", prcp.col = "PRCP.VALUE", 
	tmin.col = "TMIN.VALUE", tmax.col = "TMAX.VALUE")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wth.param_+3A_dly">dly</code></td>
<td>

<p>A data frame, such as the output of <code>read.dly()</code>, with days as rows and columns including YEAR, MONTH, DAY, PRCP.VALUE, TMIN.VALUE, TMAX.VALUE (for GHCN data), or with those columns having names specivied by arguments.
</p>
</td></tr>
<tr><td><code id="wth.param_+3A_llim">llim</code></td>
<td>

<p>The minimum daily rainfall for a wet day to be counted.
</p>
</td></tr>
<tr><td><code id="wth.param_+3A_method">method</code></td>
<td>

<p>Choice of model for which to calculate parameters, either &quot;poisson&quot; or &quot;markov&quot;.
</p>
</td></tr>
<tr><td><code id="wth.param_+3A_year.col">year.col</code></td>
<td>

<p>Name of the column containing year number.
</p>
</td></tr>
<tr><td><code id="wth.param_+3A_month.col">month.col</code></td>
<td>

<p>Name of the column containing month number.
</p>
</td></tr>
<tr><td><code id="wth.param_+3A_day.col">day.col</code></td>
<td>

<p>Name of the column containing day number.
</p>
</td></tr>
<tr><td><code id="wth.param_+3A_prcp.col">prcp.col</code></td>
<td>

<p>Name of the column containing daily precipitation.
</p>
</td></tr>
<tr><td><code id="wth.param_+3A_tmin.col">tmin.col</code></td>
<td>

<p>Name of the column containing daily minimum temperature.
</p>
</td></tr>
<tr><td><code id="wth.param_+3A_tmax.col">tmax.col</code></td>
<td>

<p>Name of the column containing daily maximum temperature.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The rainfall simulation currently offers choice of two methods: the simple Poisson model of Rodriguez-Iturbe et al. (1999), and the Markov chain model of Nicks (1974). The latter rainfall calculation is used by the APEX farm model, among others, and is based on monthly statistics.
NOTE: For reasons of time and space, the example contains only ten years of daily weather data. We suggest using thirty years for estimating parameter values.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>params</code></td>
<td>
<p>Parameters for simulating long-term point rainfall. For <code>method = "poisson"</code>, a list of parameters containing:
</p>

<ul>
<li><p>lambda: Mean rainfall inter-arrival frequency (d-1).
</p>
</li>
<li><p>depth: Mean rainfall depth (mm).
</p>
</li>
<li><p>A: Mean annual temperature (C).
</p>
</li>
<li><p>B: Temperature half-amplitude (C).
</p>
</li>
<li><p>C: Day of the year with minimum temperature (DOY).
</p>
</li>
<li><p>start: First full year of the weather data.
</p>
</li>
<li><p>end: Last full year of the weather data.
</p>
</li></ul>

<p>For <code>method = "markov"</code>, a data frame with one row per month and columns:
</p>

<ul>
<li><p>tmin: Minimum temperature.
</p>
</li>
<li><p>tminsd: Maximum temperature.
</p>
</li>
<li><p>tmax: Minimum temperature standard deviation.
</p>
</li>
<li><p>tmaxsd: Maximum temperature standard deviation.
</p>
</li>
<li><p>prcp: Monthly precipitation.
</p>
</li>
<li><p>prcpmean: Mean size of a precipitation event.
</p>
</li>
<li><p>prcpmax: Maximum size of a precipitation event.
</p>
</li>
<li><p>prcpsd: Standard deviation of precipitation event sizes.
</p>
</li>
<li><p>prcpskew: Skew of precipitation event sizes.
</p>
</li>
<li><p>prcpwet: Number of wet days (greater than <code>llim</code>).
</p>
</li>
<li><p>prcpww: Probability of a wet day following a wet day.
</p>
</li>
<li><p>prcpdw: Probability of a wet day following a dry day.
</p>
</li></ul>

</td></tr>
<tr><td><code>temperature</code></td>
<td>
<p>Parameters for simulating long-term daily temperature.</p>
</td></tr>
<tr><td><code>llim</code></td>
<td>
<p>Minimum daily rainfall for a wet day.</p>
</td></tr>
<tr><td><code>start</code></td>
<td>
<p>First full year of weather data</p>
</td></tr>
<tr><td><code>end</code></td>
<td>
<p>Last full year of weather data</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sarah Goslee
</p>


<h3>References</h3>

<p>Rodriguez-Iturbe, I., Porporato, A., Ridolfi, L., Isham, V. and Coxi, D. R. (1999) Probabilistic modelling of water balance at a point: the role of climate, soil and vegetation. <em>Proc Royal Soc A</em> <b>455</b>, 269&ndash;288.
</p>
<p>Nicks, A. D. (1974) Stochastic generation of the occurrence, pattern and location of maximum amount of daily rainfall. Pp. 154&ndash;171 in: <em>Proceedings Symposium on Statistical Hydrology.</em> USDA Agricultural Research Service Miscellaneous Publication No. 1275, Washington, DC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.dly">read.dly</a></code>,
<code><a href="#topic+rainfall">rainfall</a></code>,
<code><a href="#topic+temperature">temperature</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# GHCN daily weather file for State College, PA
# subset of data (2000-2009) for station USC00368449
#
data("weather") 

# calculate parameters for the poisson model
# using 0.3 mm as the lower limit for wet days.
weather.param.p &lt;- wth.param(weather, method = "poisson", llim = 0.3)

# simulate ten years of rainfall
rain10.p &lt;- rainfall(365*10, weather.param.p)

# increase per-event rainfall by 5 mm
weather.param.p5 &lt;- weather.param.p
weather.param.p5$params$depth &lt;- weather.param.p5$params$depth + 5
rain10.p5 &lt;- rainfall(365*10, weather.param.p5)

# calculate parameters for the Markov chain model
# using 0.3 mm as the lower limit for wet days.
weather.param.m &lt;- wth.param(weather, method = "markov", llim = 0.3)

# rainfall() selects Markov model based on input parameter types
rain10.m &lt;- rainfall(365*10, weather.param.m)

# simulate 10 years of temperature
temp10 &lt;- temperature(365*10, weather.param.p)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
