<!DOCTYPE html><html><head><title>Help for package waveband</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {waveband}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#nmr'><p>Sample nmr data set</p></a></li>
<li><a href='#plot.wb'><p>Plots output from wave.band.</p></a></li>
<li><a href='#power.sum'><p>Sums of wavelets raised to integer powers</p></a></li>
<li><a href='#print.wb'><p>Print information about a wb object.</p></a></li>
<li><a href='#summary.wb'><p>Print information about a wb object.</p></a></li>
<li><a href='#test.data'><p>Test functions for wavelet regression and thresholding</p></a></li>
<li><a href='#wave.band'><p>Posterior credible intervals for wavelet regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Computes Credible Intervals for Bayesian Wavelet Shrinkage</td>
</tr>
<tr>
<td>Version:</td>
<td>4.7.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-11</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0), wavethresh (&ge; 4.6)</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes Bayesian wavelet shrinkage credible intervals for
	nonparametric regression.
	The method uses cumulants to derive Bayesian credible intervals for
	wavelet regression estimates.
	The first four cumulants of the posterior distribution of the
	estimates are expressed in terms of the observed data and integer
	powers of the mother wavelet functions.
	These powers are closely approximated by linear combinations of
	wavelet scaling functions at an appropriate finer scale.
	Hence, a suitable modification of the discrete wavelet transform allows
	the posterior cumulants to be found efficiently for any data set.
	Johnson transformations then yield the credible intervals themselves.
	Barber, S., Nason, G.P. and Silverman, B.W. (2002)
	&lt;<a href="https://doi.org/10.1111%2F1467-9868.00332">doi:10.1111/1467-9868.00332</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-11 18:51:43 UTC; guynason</td>
</tr>
<tr>
<td>Author:</td>
<td>Stuart Barber [aut],
  Guy Nason [cre, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guy Nason &lt;g.nason@imperial.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-12 01:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='nmr'>Sample nmr data set</h2><span id='topic+nmr'></span>

<h3>Description</h3>

<p>This page will eventually be the help page for the function you wanted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nmr)</code></pre>


<h3>Format</h3>

<p>A help page
</p>

<hr>
<h2 id='plot.wb'>Plots output from wave.band. </h2><span id='topic+plot.wb'></span>

<h3>Description</h3>

<p>Plots the output from <code><a href="#topic+wave.band">wave.band</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wb'
plot(x, col=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.wb_+3A_x">x</code></td>
<td>
<p>Object of class <code>wb</code> from the function <code><a href="#topic+wave.band">wave.band</a></code>.</p>
</td></tr>
<tr><td><code id="plot.wb_+3A_col">col</code></td>
<td>
<p>Specifies whether the figure plotted is in colour or black and white.</p>
</td></tr>
<tr><td><code id="plot.wb_+3A_...">...</code></td>
<td>
<p>Any other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code><a href="#topic+wave.band">wave.band</a></code> offers a plotting option. This function will either reproduce the plot made by <code><a href="#topic+wave.band">wave.band</a></code> from that function's output, or produce a different plot which reproduces better in black and white.  
</p>


<h3>Value</h3>

<p>A plot is produced on the current graphics device 
</p>


<h3>References</h3>

<p>Barber, S., Nason, G.P. and Silverman, B.W. (2002)
Posterior probability intervals for wavelet thresholding.
<em>Journal of the Royal Statistical Society</em>, Series B,
<b>64</b>, 189-206.</p>


<h3>See Also</h3>

<p><code><a href="#topic+wave.band">wave.band</a></code>
</p>

<hr>
<h2 id='power.sum'>Sums of wavelets raised to integer powers</h2><span id='topic+power.sum'></span>

<h3>Description</h3>

<p>Computes a sum expressed in terms of mother wavelets raised to the power two, three, or four. Either the exact solution or a faster approximation can be computed. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power.sum(alphas.wd, pow = 2, verbose = TRUE, type = "approx", plotfn = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power.sum_+3A_alphas.wd">alphas.wd</code></td>
<td>
<p>A <code>wd.object</code>, the <code>D</code> component of which contains the coefficients of the powers of wavelets. The entry which would normalLy be the coefficient of the wavelet at scale j and location k is the coefficient of the same wavelet raised to the power pow.
</p>
<p>If <code>pow=2</code>, then the overall scaling function coefficient is included in the sum, otherwise the C component is ignored completely. 
</p>
<p>The <code>filter.number</code> and <code>/link{family}</code> components of <code>alphas.wd</code> are used to determine which wavelet is used.</p>
</td></tr>
<tr><td><code id="power.sum_+3A_pow">pow</code></td>
<td>
<p>The power to which the wavelets are raised; it can take values 2, 3, or 4.</p>
</td></tr>
<tr><td><code id="power.sum_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose=TRUE</code>, progress reports are printed while the sum is being evaluated.</p>
</td></tr>
<tr><td><code id="power.sum_+3A_type">type</code></td>
<td>
<p>If <code>type="approx"</code>, the approximation is computed, if <code>type="exact"</code>, the exact solution is computed, and if <code>type="both"</code> both the exact and approximate solutions are found.</p>
</td></tr>
<tr><td><code id="power.sum_+3A_plotfn">plotfn</code></td>
<td>
<p>If <code>plotfn=TRUE</code>, the solution(s) found are plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the approximate method, the powers of mother wavelets are represented by scaling functions (father wavelets) at a finer level. This is discussed in Barber, Nason, &amp; Silverman (2001). 
</p>
<p>Sums of powers of wavelets are used in the computation of posterior credible intervals for wavelet regression estimators; see the documentation for the function <code><a href="#topic+wave.band">wave.band</a></code> for more details. 
</p>


<h3>Value</h3>

<p>A vector containing the solution (either exact or approximate), or a list containing both solutions, depending on the value of &quot;type&quot;. 
</p>


<h3>SIDE EFFECTS</h3>

<p>If <code>plotfn=TRUE</code>, the solution(s) found are plotted.
</p>


<h3>References</h3>

<p>Barber, S., Nason, G.P. and Silverman, B.W. (2002)
Posterior probability intervals for wavelet thresholding.
<em>Journal of the Royal Statistical Society</em>, Series B,
<b>64</b>, 189-206.</p>


<h3>See Also</h3>

<p><code><a href="#topic+wave.band">wave.band</a></code>
</p>

<hr>
<h2 id='print.wb'>Print information about a wb object.
</h2><span id='topic+print.wb'></span>

<h3>Description</h3>

<p>Print information about a wb object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wb'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.wb_+3A_x">x</code></td>
<td>
<p>wb object to print
</p>
</td></tr>
<tr><td><code id="print.wb_+3A_...">...</code></td>
<td>
<p>Other arguments (not used)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prints information about a wb object. 
</p>


<h3>Value</h3>

<p>No specific value
</p>


<h3>Author(s)</h3>

<p>G. P. Nason
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.wb">plot.wb</a></code>, <code><a href="#topic+wave.band">wave.band</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
set.seed(1)
tmp &lt;- wave.band(rnorm(32))
print(tmp)
#Wave.band credible bands object
#Bands produced for object in data component of length:  32
#Credible intervals are in the bands component
#Wave.band Bayesian hyperparameter alpha was:  0.5
#Wave.band Bayesian hyperparameter beta was:  1
#Wave.band Wavelet filter number was:  8
#Wave.band Wavelet family was:  DaubLeAsymm
#Type of input (data or test signal): data
#Rsnr (if applicable):  3
</code></pre>

<hr>
<h2 id='summary.wb'>Print information about a wb object.
</h2><span id='topic+summary.wb'></span>

<h3>Description</h3>

<p>Summarize information about a wb object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wb'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.wb_+3A_object">object</code></td>
<td>
<p>wb object to summarize
</p>
</td></tr>
<tr><td><code id="summary.wb_+3A_...">...</code></td>
<td>
<p>Other arguments (not used)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Summarizes information about a wb object. 
</p>


<h3>Value</h3>

<p>No specific value
</p>


<h3>Author(s)</h3>

<p>G. P. Nason
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.wb">plot.wb</a></code>, <code><a href="#topic+wave.band">wave.band</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
set.seed(1)
tmp &lt;- wave.band(rnorm(32))
summary(tmp)
#Wave.band credible bands object
#Bands produced for object in data component of length:  32
#Credible intervals are in the bands component
#Wave.band Bayesian hyperparameter alpha was:  0.5
#Wave.band Bayesian hyperparameter beta was:  1
#Wave.band Wavelet filter number was:  8
#Wave.band Wavelet family was:  DaubLeAsymm
#Type of input (data or test signal): data
#Rsnr (if applicable):  3
</code></pre>

<hr>
<h2 id='test.data'>Test functions for wavelet regression and thresholding </h2><span id='topic+test.data'></span>

<h3>Description</h3>

<p>This function evaluates the &quot;blocks&quot;, &quot;bumps&quot;, &quot;heavisine&quot; and &quot;doppler&quot; test functions of Donoho &amp; Johnstone (1994b) and the piecewise polynomial test function of Nason &amp; Silverman (1994). The function also generates data sets consisting of the specified function plus uncorrelated normally distributed errors. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test.data(type = "ppoly", n = 512, signal = 1, rsnr = 7, plotfn = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test.data_+3A_type">type</code></td>
<td>
<p>Test function to be computed. Available types are &quot;ppoly&quot; (piecewise polynomial), &quot;blocks&quot;, &quot;bumps&quot;, &quot;heavi&quot; (heavisine), and &quot;doppler&quot;.</p>
</td></tr>
<tr><td><code id="test.data_+3A_n">n</code></td>
<td>
<p>Number of equally spaced data points on which the function is evaluated.</p>
</td></tr>
<tr><td><code id="test.data_+3A_signal">signal</code></td>
<td>
<p>Scaling parameter; the function will be scaled so that the standard deviation of the data points takes this value.</p>
</td></tr>
<tr><td><code id="test.data_+3A_rsnr">rsnr</code></td>
<td>
<p>Root signal-to-noise ratio. Specifies the ratio of the standard deviation of the function to the standard deviation of the simulated errors.</p>
</td></tr>
<tr><td><code id="test.data_+3A_plotfn">plotfn</code></td>
<td>
<p>If <code>plotfn=TRUE</code>, then the test function and the simulated data set are plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components: 
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The points at which the test function is evaluated.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The values taken by the test function.</p>
</td></tr>
<tr><td><code>ynoise</code></td>
<td>
<p>The simulated data set.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>The type of function generated, identical to the input parameter type .</p>
</td></tr>
<tr><td><code>rsnr</code></td>
<td>
<p>The root signal-to-noise ratio of the simulated data set, identical to the input parameter rsnr .</p>
</td></tr>
</table>


<h3>SIDE EFFECTS</h3>

<p>If <code>plotfn=TRUE</code>, the test function and data set are plotted.</p>

<hr>
<h2 id='wave.band'>Posterior credible intervals for wavelet regression </h2><span id='topic+wave.band'></span>

<h3>Description</h3>

<p>Computes posterior credible intervals for an unknown regression curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wave.band(data = 0, alpha = 0.5, beta = 1., filter.number = 8, family = 
        "DaubLeAsymm", bc = "periodic", dev = var, j0 = 3., plotfn = TRUE, 
        retvalue = TRUE, n = 128, type = "data", rsnr = 3)
</code></pre>


<h3>Arguments</h3>

<p>Either data or a value of type other than &quot;data&quot; must be supplied. 
</p>
<table>
<tr><td><code id="wave.band_+3A_data">data</code></td>
<td>
<p>If type=&quot;data&quot;, then data should be a vector of data. The length of the vector should be a power of two not greater than 1024, and not less
than 8.</p>
</td></tr>
<tr><td><code id="wave.band_+3A_type">type</code></td>
<td>
<p>Either type=&quot;data&quot;, in which case a vector of data should be supplied, or type should specify a standard test function and wave.band will generate a test data set via a call to test.data. Permissible values for type are &quot;blocks&quot;, &quot;bumps&quot;, &quot;doppler&quot;, &quot;heavi&quot;, or &quot;ppoly&quot;; see the documentation for test.data for more details.</p>
</td></tr>
<tr><td><code id="wave.band_+3A_alpha">alpha</code>, <code id="wave.band_+3A_beta">beta</code></td>
<td>
<p>Hyperparameters which determine the priors placed on the wavelet coefficients. Both alpha and beta take positive values; see Abramovich, Sapatinas, &amp; Silverman (1998) or Chipman &amp; Wolfson (1999) for more details on selecting alpha and beta.</p>
</td></tr>
<tr><td><code id="wave.band_+3A_filter.number">filter.number</code></td>
<td>
<p>A parameter relating to the smoothness of wavelet that you want to use in the decomposition.</p>
</td></tr>
<tr><td><code id="wave.band_+3A_family">family</code></td>
<td>
<p>Specifies the family of wavelets to be used. Two popular options are &quot;DaubExPhase&quot; and &quot;DaubLeAsymm&quot; but see the help for filter.select for more possibilities.</p>
</td></tr>
<tr><td><code id="wave.band_+3A_bc">bc</code></td>
<td>
<p>Specifies the boundary handling. If bc=&quot;periodic&quot; the default, then the function you decompose is assumed to be periodic on it's interval of definition. Other boundary options exist, but are currently unsupported for this function.</p>
</td></tr>
<tr><td><code id="wave.band_+3A_dev">dev</code></td>
<td>
<p>This argument supplies the function to be used to compute the spread of the absolute values coefficients. The function supplied must return a value of spread on the variance scale (i.e. not standard deviation) such as the var() function. A popular, useful and robust alternative is the madmad function.</p>
</td></tr>
<tr><td><code id="wave.band_+3A_j0">j0</code></td>
<td>
<p>The primary resolution level; used in assessing the universal threshold which is used in the empirical Bayes estimation of hyperparameters.</p>
</td></tr>
<tr><td><code id="wave.band_+3A_plotfn">plotfn</code></td>
<td>
<p>If <code>plotfn=TRUE</code>, wave.band draws the noisy data, the BayesThresh function estimate, and pointwise 99 percent credible intervals for the regression function. If the value of <code>type</code> is not &quot;data&quot;, then the true function will also be plotted.</p>
</td></tr>
<tr><td><code id="wave.band_+3A_retvalue">retvalue</code></td>
<td>
<p>If <code>retvalue=TRUE</code>, then a lengthy list of results will be returned. Note that if both <code>plotfn</code> and <code>retvalue</code> are set to <code>FALSE</code>, then <code>wave.band</code> will return no results whatsoever.</p>
</td></tr>
<tr><td><code id="wave.band_+3A_n">n</code></td>
<td>
<p>If <code>type</code> is not &quot;data&quot;, then a data vector of length <code>n</code> will be generated; note that <code>n</code> should be a power of two not greater than 1024.</p>
</td></tr>
<tr><td><code id="wave.band_+3A_rsnr">rsnr</code></td>
<td>
<p>If type is not &quot;data&quot;, then the data vector generated will have root signal-to-noise ratio as specified by <code>rsnr</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements the WaveBand method of Barber, Nason, &amp; Silverman (2001) to compute posterior credible intervals for a regression function. The credible intervals are found by approximating the posterior distribution of the estimated regression curve at each design point. A mixture prior with two components (a zero-mean normal and a point mass at zero) is placed on each wavelet coefficient and updated by the data to give the posteriors for the wavelet coefficients. This is the same prior used by Abramovich, Sapatinas, &amp; Silverman (1998) in their BayesThresh method, implemented in the function <code>BAYES.THR</code>. 
</p>
<p>The cumulants of these posteriors are computed and stored in the <code>wd.objects</code> returned by <code>wave.band</code> as <code>Kr.wd</code>. These are summed to give the posterior cumulants of the regression curve, which are used to fit a Johnson distribution (Johnson, 1949), using the algorithm of Hill, Hill, &amp; Holder (1976). Percentage points of these distributions are computed by the algorithm of Hill (1976) and give the credible intervals themselves. 
</p>
<p>Code to implement the algorithms by Hill (1976) and Hill, Hill, &amp; Holder (1976) was obtained from the StatLib archive.
</p>


<h3>Value</h3>

<p>If <code>retvalue=FALSE</code>, the value returned by <code>wave.band</code> is <code>NULL</code>. Otherwise, <code>wave.band</code> returns a list, an object of class
<code>wb</code>, with the following components: 
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>The data vector which has been analysed. </p>
</td></tr>
<tr><td><code>nts</code></td>
<td>
<p>A list containing four vectors named one, two, three, and four. Vector one contains the first cumulants of the regression function estimate, vector to the second cumulants and so on.</p>
</td></tr>
<tr><td><code>Kr.wd</code></td>
<td>
<p>A list of four wd objects. These contain the first to fourth cumulants of the wavelet coefficients, as well as recording the wavelet used in the decomposition. </p>
</td></tr>
<tr><td><code>bands</code></td>
<td>
<p>A list containing pointwise upper and lower credible limits for the regression function estimate for nominal coverage rates 80, 90, 95 and 99 percent. The widths of the credible intervals is also included. The vectors are named with &quot;l&quot;, &quot;u&quot;, and &quot;w&quot; indicating lower limits, upper limits, and intervals widths, while &quot;80&quot;, &quot;90&quot;, &quot;95&quot;, and &quot;99&quot; refer to the nominal coverage rate. </p>
</td></tr>
</table>
<p>The <code>BayesThresh</code> estimate of the regression function, using the same parameters as the WaveBand credible intervals, is also included in the <code>pointest</code> component of this list. 
</p>
<table>
<tr><td><code>param</code></td>
<td>
<p>A record of parameters in the call to <code>wave.band</code>.</p>
</td></tr>
</table>


<h3>SIDE EFFECTS</h3>

<p>If <code>plotfn=TRUE</code>, results are plotted on the current graphics device.
</p>


<h3>References</h3>

<p>Barber, S., Nason, G.P. and Silverman, B.W. (2002)
Posterior probability intervals for wavelet thresholding.
<em>Journal of the Royal Statistical Society</em>, Series B,
<b>64</b>, 189-206.</p>


<h3>See Also</h3>

<p><code>BAYES.THR</code>, <code><a href="#topic+print.wb">print.wb</a></code>, <code><a href="#topic+plot.wb">plot.wb</a></code>, <code><a href="#topic+power.sum">power.sum</a></code>, <code><a href="#topic+test.data">test.data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#library(wavethresh)
#
# First, look at the piecewise polynomial example.
#
# This plot and the plots for the smooth example below show
# the data as points, the BayesThresh estimate (thick line), 
# pointwise 99 percent credible intervals (thin lines), and
# the true function (dotted thin line).
#
ppoly.wb &lt;- wave.band(type = "ppoly", n = 1024, rsnr=4)
#
# Plotting the cumulants shows that there are significant 
# third and fourth cumulants in some places.
#
t &lt;- (1:1024)/1024
plot(t, ppoly.wb$cumulants$one, type="l", xlab="t", ylab = "one")
plot(t, ppoly.wb$cumulants$two, type="l", xlab="t", ylab = "two")
plot(t, ppoly.wb$cumulants$three, type="l", xlab="t", ylab = "three")
plot(t, ppoly.wb$cumulants$four, type="l", xlab="t", ylab = "four")
#
# Now consider how much difference the prior can make.
# Consider a smooth example, first using the default prior,
# and then using a smoother prior.
#

gs &lt;- sin(2*pi*t) + 2*(t - 0.5)^2
gs.noisy &lt;- gs + rnorm(n=1024, sd=sqrt(var(gs))/2)
gs.wb1 &lt;- wave.band(data=gs.noisy)

gs.wb2 &lt;- wave.band(data=gs.noisy, alpha=4, beta=1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
