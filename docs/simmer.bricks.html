<!DOCTYPE html><html><head><title>Help for package simmer.bricks</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {simmer.bricks}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#delayed_release'><p>Delayed Release of a Resource</p></a></li>
<li><a href='#do_parallel'><p>Perform Parallel Tasks</p></a></li>
<li><a href='#interleave'><p>Interleaved Resources</p></a></li>
<li><a href='#simmer.bricks-package'><p><span class="pkg">simmer.bricks</span>: Helper Methods for <span class="pkg">simmer</span> Trajectories</p></a></li>
<li><a href='#visit'><p>Visit a Resource</p></a></li>
<li><a href='#wait_n'><p>Wait a Number of Signals</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Helper Methods for 'simmer' Trajectories</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides wrappers for common activity patterns in 'simmer' trajectories.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://r-simmer.org">https://r-simmer.org</a>, <a href="https://github.com/r-simmer/simmer.bricks">https://github.com/r-simmer/simmer.bricks</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/r-simmer/simmer.bricks/issues">https://github.com/r-simmer/simmer.bricks/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.2), simmer (&ge; 3.7.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-15 10:16:06 UTC; iucar</td>
</tr>
<tr>
<td>Author:</td>
<td>Iñaki Ucar <a href="https://orcid.org/0000-0001-6403-5550"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cph, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Iñaki Ucar &lt;iucar@fedoraproject.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-15 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='delayed_release'>Delayed Release of a Resource</h2><span id='topic+delayed_release'></span><span id='topic+delayed_release_selected'></span>

<h3>Description</h3>

<p>This brick encapsulates a delayed release: the arrival releases the resource
and continues its way immediately, but the resource is busy for an additional
period of time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delayed_release(
  .trj,
  resource,
  task,
  amount = 1,
  preemptive = FALSE,
  mon_all = FALSE
)

delayed_release_selected(
  .trj,
  task,
  amount = 1,
  preemptive = FALSE,
  mon_all = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delayed_release_+3A_.trj">.trj</code></td>
<td>
<p>the trajectory object.</p>
</td></tr>
<tr><td><code id="delayed_release_+3A_resource">resource</code></td>
<td>
<p>the name of the resource.</p>
</td></tr>
<tr><td><code id="delayed_release_+3A_task">task</code></td>
<td>
<p>the timeout duration supplied by either passing a numeric or a
callable object (a function) which must return a numeric (negative values are
automatically coerced to positive).</p>
</td></tr>
<tr><td><code id="delayed_release_+3A_amount">amount</code></td>
<td>
<p>the amount to seize/release, accepts either a numeric or a
callable object (a function) which must return a numeric.</p>
</td></tr>
<tr><td><code id="delayed_release_+3A_preemptive">preemptive</code></td>
<td>
<p>whether arrivals in the server can be preempted or not based
on seize priorities.</p>
</td></tr>
<tr><td><code id="delayed_release_+3A_mon_all">mon_all</code></td>
<td>
<p>if <code>TRUE</code>, <code>get_mon_arrivals</code> will show one
line per clone.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the following chain of activities: <code><a href="simmer.html#topic+clone">clone</a></code>
&gt; <code><a href="simmer.html#topic+clone">synchronize</a></code> (see examples below).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## These are equivalent for a non-preemptive resource:
trajectory() %&gt;%
  delayed_release("res1", 5, 1)

trajectory() %&gt;%
  clone(
    2,
    trajectory() %&gt;%
      set_capacity("res1", -1, mod="+") %&gt;%
      release("res1", 1),
    trajectory() %&gt;%
      timeout(5) %&gt;%
      set_capacity("res1", 1, mod="+")
  ) %&gt;%
  synchronize(wait=FALSE)

## These are equivalent for a preemptive resource:
trajectory() %&gt;%
  delayed_release("res2", 5, 1, preemptive=TRUE)

trajectory() %&gt;%
  clone(
    2,
    trajectory() %&gt;%
      release("res2", 1),
    trajectory() %&gt;%
      set_prioritization(c(rep(.Machine$integer.max, 2), 0)) %&gt;%
      seize("res2", 1) %&gt;%
      timeout(5) %&gt;%
      release("res2", 1)
  ) %&gt;%
  synchronize(wait=FALSE)

</code></pre>

<hr>
<h2 id='do_parallel'>Perform Parallel Tasks</h2><span id='topic+do_parallel'></span>

<h3>Description</h3>

<p>This brick encapsulates the activity of <code>n</code> workers running parallel
sub-trajectories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_parallel(.trj, ..., .env, wait = TRUE, mon_all = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="do_parallel_+3A_.trj">.trj</code></td>
<td>
<p>the trajectory object.</p>
</td></tr>
<tr><td><code id="do_parallel_+3A_...">...</code></td>
<td>
<p>sub-trajectories or list of sub-trajectories to parallelise.</p>
</td></tr>
<tr><td><code id="do_parallel_+3A_.env">.env</code></td>
<td>
<p>the simulation environment.</p>
</td></tr>
<tr><td><code id="do_parallel_+3A_wait">wait</code></td>
<td>
<p>if <code>TRUE</code>, the arrival waits until all parallel sub-trajectories
are finished; if <code>FALSE</code>, the arrival continues as soon as the first
parallel task ends.</p>
</td></tr>
<tr><td><code id="do_parallel_+3A_mon_all">mon_all</code></td>
<td>
<p>if <code>TRUE</code>, <code>get_mon_arrivals</code> will show one
line per clone.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the following chain of activities: <code><a href="simmer.html#topic+clone">clone</a></code>
&gt; <code><a href="simmer.html#topic+clone">synchronize</a></code> (&gt; <code><a href="simmer.html#topic+send">wait</a></code>
&gt; <code><a href="simmer.html#topic+send">untrap</a></code> if <code>wait=FALSE</code>) (see examples below).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>env &lt;- simmer()
signal &lt;- function() get_name(env)

task.1 &lt;- trajectory("task 1") %&gt;%
  timeout(function() rexp(1))
task.2 &lt;- trajectory("task 2") %&gt;%
  timeout(function() rexp(1))

## These are equivalent:
trajectory() %&gt;%
  do_parallel(
    task.1,
    task.2,
    .env = env, wait = TRUE
  )

trajectory() %&gt;%
  clone(
    n = 3,
    trajectory("original") %&gt;%
      trap(signal) %&gt;%
      wait() %&gt;%
      wait() %&gt;%
      untrap(signal),
    task.1[] %&gt;%
      send(signal),
    task.2[] %&gt;%
      send(signal)) %&gt;%
  synchronize(wait = TRUE)

## These are equivalent:
trajectory() %&gt;%
  do_parallel(
    task.1,
    task.2,
    .env = env, wait = FALSE
  )

trajectory() %&gt;%
  clone(
    n = 3,
    trajectory("original") %&gt;%
      trap(signal),
    task.1[] %&gt;%
      send(signal),
    task.2[] %&gt;%
      send(signal)) %&gt;%
  synchronize(wait = FALSE) %&gt;%
  wait() %&gt;%
  untrap(signal)

</code></pre>

<hr>
<h2 id='interleave'>Interleaved Resources</h2><span id='topic+interleave'></span>

<h3>Description</h3>

<p>This brick encapsulates a chain of interleaved resources, i.e., the current
resource is not released until the next one in the chain is available. An
interesting property of such a pattern is that, if one resource is blocked for
some reason, the whole chain stops.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interleave(.trj, resources, task, amount = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interleave_+3A_.trj">.trj</code></td>
<td>
<p>the trajectory object.</p>
</td></tr>
<tr><td><code id="interleave_+3A_resources">resources</code></td>
<td>
<p>character vector of resource names.</p>
</td></tr>
<tr><td><code id="interleave_+3A_task">task</code></td>
<td>
<p>the timeout duration supplied by either passing a numeric or a
callable object (a function) which must return a numeric (negative values are
automatically coerced to positive).</p>
</td></tr>
<tr><td><code id="interleave_+3A_amount">amount</code></td>
<td>
<p>the amount to seize/release, accepts either a numeric or a
callable object (a function) which must return a numeric.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both <code>task</code> and <code>amount</code> accept a list of values/functions,
instead of a single one, that should be of the same length as <code>resources</code>,
so that each value/function is applied to the resource of the same index.
</p>
<p>The transition to the second and subsequent resources is guarded by a token,
an auxiliary resource whose capacity must be equal to the capacity + queue
size of the guarded resource, and its queue size must be infinite. For example,
if two resources are provided, <code>c("A", "B")</code>, the auxiliary resource will
be named <code>"B_token"</code>. If <code>capacity=2</code> and <code>queue_size=1</code> for B,
then <code>capacity=3</code> and <code>queue_size=Inf</code> must be the values for
B_token. But note that the user is responsible for adding such an auxiliary
resource to the simulation environment with the appropriate parameters.
</p>


<h3>Value</h3>

<p>Returns the following chain of activities: <code><a href="simmer.html#topic+seize">seize</a></code>
(1) &gt; <code><a href="simmer.html#topic+timeout">timeout</a></code> &gt; [<code><a href="simmer.html#topic+seize">seize</a></code> (token to 2)
&gt; <code><a href="simmer.html#topic+seize">release</a></code> (1) &gt; <code><a href="simmer.html#topic+seize">seize</a></code> (2) &gt;
<code><a href="simmer.html#topic+timeout">timeout</a></code> &gt; <code><a href="simmer.html#topic+seize">release</a></code> (2) &gt;
<code><a href="simmer.html#topic+seize">release</a></code> (token to 2) &gt; ... (repeat) ]
(see examples below). Thus, the total number of activities appended is
<code>length(resources) * 3 + (length(resources)-1) * 2</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## These are equivalent:
trajectory() %&gt;%
  interleave(c("A", "B"), c(2, 10), 1)

trajectory() %&gt;%
  seize("A", 1) %&gt;%
  timeout(2) %&gt;%
  seize("B_token", 1) %&gt;%
  release("A", 1) %&gt;%
  seize("B", 1) %&gt;%
  timeout(10) %&gt;%
  release("B", 1) %&gt;%
  release("B_token", 1)

</code></pre>

<hr>
<h2 id='simmer.bricks-package'><span class="pkg">simmer.bricks</span>: Helper Methods for <span class="pkg">simmer</span> Trajectories</h2><span id='topic+simmer.bricks-package'></span>

<h3>Description</h3>

<p>Provides wrappers for common activity patterns in <span class="pkg">simmer</span> trajectories.
</p>


<h3>Author(s)</h3>

<p>Iñaki Ucar
</p>


<h3>See Also</h3>

<p><span class="pkg">simmer</span>'s homepage <a href="https://r-simmer.org">https://r-simmer.org</a> and
GitHub repository <a href="https://github.com/r-simmer/simmer.bricks">https://github.com/r-simmer/simmer.bricks</a>.
</p>

<hr>
<h2 id='visit'>Visit a Resource</h2><span id='topic+visit'></span><span id='topic+visit_selected'></span>

<h3>Description</h3>

<p>These bricks encapsulate a resource visit: seize, spend some time and release.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visit(.trj, resource, task, amount = 1)

visit_selected(.trj, task, amount = 1, id = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visit_+3A_.trj">.trj</code></td>
<td>
<p>the trajectory object.</p>
</td></tr>
<tr><td><code id="visit_+3A_resource">resource</code></td>
<td>
<p>the name of the resource.</p>
</td></tr>
<tr><td><code id="visit_+3A_task">task</code></td>
<td>
<p>the timeout duration supplied by either passing a numeric or a
callable object (a function) which must return a numeric (negative values are
automatically coerced to positive).</p>
</td></tr>
<tr><td><code id="visit_+3A_amount">amount</code></td>
<td>
<p>the amount to seize/release, accepts either a numeric or a
callable object (a function) which must return a numeric.</p>
</td></tr>
<tr><td><code id="visit_+3A_id">id</code></td>
<td>
<p>selection identifier for nested usage.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the following chain of activities: <code><a href="simmer.html#topic+seize">seize</a></code>
&gt; <code><a href="simmer.html#topic+timeout">timeout</a></code> &gt; <code><a href="simmer.html#topic+seize">release</a></code>
(see examples below).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## These are equivalent:
trajectory() %&gt;%
  visit("res", 5, 1)

trajectory() %&gt;%
  seize("res", 1) %&gt;%
  timeout(5) %&gt;%
  release("res", 1)

## These are equivalent:
trajectory() %&gt;%
  visit_selected(5, 1)

trajectory() %&gt;%
  seize_selected(1) %&gt;%
  timeout(5) %&gt;%
  release_selected(1)

</code></pre>

<hr>
<h2 id='wait_n'>Wait a Number of Signals</h2><span id='topic+wait_n'></span><span id='topic+wait_until'></span>

<h3>Description</h3>

<p>These bricks encapsulate <code>n</code> stops: wait for a sequence of <code>n</code>
signals. <code>wait_until</code> also traps and untraps the required signals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wait_n(.trj, n = 1)

wait_until(.trj, signals, n = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wait_n_+3A_.trj">.trj</code></td>
<td>
<p>the trajectory object.</p>
</td></tr>
<tr><td><code id="wait_n_+3A_n">n</code></td>
<td>
<p>number of <code>wait</code> activities to chain.</p>
</td></tr>
<tr><td><code id="wait_n_+3A_signals">signals</code></td>
<td>
<p>signal or list of signals, accepts either a string, a list of
strings or a callable object (a function) which must return a string or a
list of strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>wait_n</code> returns <code>n</code> times <code><a href="simmer.html#topic+send">wait</a></code>.
<code>wait_until</code> also adds <code><a href="simmer.html#topic+send">trap</a></code> and
<code><a href="simmer.html#topic+send">untrap</a></code> at the beginning and end, respectively,
of the chain of <code>wait</code>s (see examples below).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## These are equivalent:
trajectory() %&gt;%
  wait_n(3)

trajectory() %&gt;%
  wait() %&gt;%
  wait() %&gt;%
  wait()

## These are equivalent:
trajectory() %&gt;%
  wait_until("green")

trajectory() %&gt;%
  trap("green") %&gt;%
  wait() %&gt;%
  untrap("green")

## These are equivalent:
trajectory() %&gt;%
  wait_until(c("one", "another"), 2)

trajectory() %&gt;%
  trap(c("one", "another")) %&gt;%
  wait() %&gt;%
  wait() %&gt;%
  untrap(c("one", "another"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
