<!DOCTYPE html><html><head><title>Help for package pcensmix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pcensmix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pcensmix-package'><p>Generate and fit a model to censored mixture data</p></a></li>
<li><a href='#blood'><p>Blood pressure of mine workers.</p></a></li>
<li><a href='#insulate'><p>Failure times of insulating fluid.</p></a></li>
<li><a href='#mixgen'><p>Generating Mixture Datasets</p></a></li>
<li><a href='#pcensmix-internal'><p>Internal function for pcensmix</p></a></li>
<li><a href='#pcensmixR'><p>Fitting a Normal Mixture Model to a Real Progressive Type-II Censored Mixture</p>
Data Using EM Algorithm</a></li>
<li><a href='#pcensmixSim'><p>Fitting a Normal Mixture Model to a Simulated Progressive Type-II Censored</p>
Data Using EM Algorithm</a></li>
<li><a href='#pcgen'><p>Creating a Progressively Type-II Censored Version of a Given Dataset</p></a></li>
<li><a href='#print.pcgen'><p>Print Method for pcgen Objects</p></a></li>
<li><a href='#run_pcensmix'><p>Generating Progressively Type-II Censored Mixture Data and Fitting a Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Model Fitting to Progressively Censored Mixture Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.3), stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for generating progressively Type-II censored data in
    a mixture structure and fitting models using a constrained EM algorithm. It can also
    create a progressive Type-II censored version of a given real dataset to be considered for
    model fitting. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-07-24 17:18:11 UTC; LidaFallah</td>
</tr>
<tr>
<td>Author:</td>
<td>Lida Fallah [aut, cre],
  John Hinde [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lida Fallah &lt;l.fallah22@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-07-24 19:01:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='pcensmix-package'>Generate and fit a model to censored mixture data</h2><span id='topic+pcensmix-package'></span>

<h3>Description</h3>

<p>This package provides functions to generate two-component
mixture data from various different mixture distribution, generate
progressive Type-II censored data in a mixture structure and fit a normal
mixture model using a constrained EM algorithm. In addition, it can create a
progressive Type-II censored version of a given real dataset and fit a
normal mixture model to.  Main functions are <a href="#topic+pcgen">pcgen</a>,
<a href="#topic+pcensmixSim">pcensmixSim</a> and <a href="#topic+pcensmixR">pcensmixR</a>. Example datasets are included for
illustration.
</p>


<h3>Details</h3>

<p>Package: pcensmix
</p>
<p>Type: Package
</p>
<p>Version: 1.2-1
</p>
<p>Date: 2017-07-24
</p>
<p>License: GPL (&gt;= 2)
</p>


<h3>Author(s)</h3>

<p>Lida Fallah &lt;l.fallah22@gmail.com&gt; and John Hinde
</p>
<p>Maintainer: Lida Fallah &lt;l.fallah22@gmail.com&gt;
</p>


<h3>References</h3>

<p>Aitkin, M., Francis, B., Hinde, J. and Darnell, R., (2009).
Statistical Modelling in R. Oxford: Oxford University Press.
</p>
<p>Balakrishnan, N. and Aggarwala, R., (2000). Progressive Censoring: Theory,
Methods, and Applications. Springer Science &amp; Business Media.
</p>
<p>Hathaway, R.J., (1985). A constrained formulation of maximum-likelihood
estimation for normal mixture distributions. The Annals of Statistics,
795-800.
</p>
<p>McLachlan, G. and Krishnan, T., (2007). The EM Algorithm and Extensions. John
Wiley &amp; Sons.
</p>
<p>McLachlan, G. and Peel, D., (2004). Finite Mixture Models. John Wiley &amp; Sons.
</p>

<hr>
<h2 id='blood'>Blood pressure of mine workers.</h2><span id='topic+blood'></span>

<h3>Description</h3>

<p>A dataframe containing the blood pressure of a population of mine workers in
Ghana.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blood
</code></pre>


<h3>Format</h3>

<p>A data frame with 495 rows and 3 variables
</p>

<ul>
<li><p> Systolic.BP. Systolic blood pressure </p>
</li>
<li><p> Diastolic.BP. Diastolic
blood pressure </p>
</li>
<li><p> Amplitude. Amplitude
</p>
</li></ul>


<h3>References</h3>

<p>Boehning, D., (2000). Computer-assisted Analysis of Mixtures and
Applications: Meta-analysis, Disease mapping and Others. CRC press.
</p>
<p>Gunga, H.C., Forson, K., Amegby, N. and Kirsch, K., (1991). Lebensbedingungen
und gesundheitszustand von berg-und fabrikarbeitern im tropischen regenwald
von Ghana. Arbeitsmedizin Sozialmedizin Praventivmediz in, 17-25.
</p>

<hr>
<h2 id='insulate'>Failure times of insulating fluid.</h2><span id='topic+insulate'></span>

<h3>Description</h3>

<p>A dataset containing measurements of 19 failure times (in minutes) for an
insulating fluid between two electrodes subject to a voltage of 34 KV, see
Nelson (1982).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insulate
</code></pre>


<h3>Format</h3>

<p>A vector of length 19.</p>


<h3>References</h3>

<p>Nelson, W., (1982). Applied Life Data Analysis. Wiley, New York.
</p>

<hr>
<h2 id='mixgen'>Generating Mixture Datasets</h2><span id='topic+mixgen'></span>

<h3>Description</h3>

<p>This function generates two-component mixture data from a various different
mixture distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixgen(N, dist1, dist2, control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixgen_+3A_n">N</code></td>
<td>
<p>population size.</p>
</td></tr>
<tr><td><code id="mixgen_+3A_dist1">dist1</code>, <code id="mixgen_+3A_dist2">dist2</code></td>
<td>
<p>respective distributions of the first and second mixture
components to be simulated from. For Normal, Log-normal, Weibull, Gamma,
Cauchy and Beta distributions, they must be provided as <code>'norm'</code>,
<code>'lnorm'</code>, <code>'weibull'</code>, <code>'gamma'</code>, <code>'cauchy'</code> and
<code>'beta'</code> respectively. The Exponential distribution can be included as
a Gamma distribution with scale parameter one.</p>
</td></tr>
<tr><td><code id="mixgen_+3A_control">control</code></td>
<td>
<p>a list of parameters for controlling the simulation process.
This includes parameters of the first and second mixture component
distributions and the mixture proportion <code class="reqn">\pi</code> which should be provided
in the order mentioned, i.e., parameters for the first component come
first, those of the second component come after and then the value of the
mixing proportion. All values should be provided in a list of numerics.
Note parameters for each component distribution should be added in the
order as required in their generator functions, see
<code><a href="stats.html#topic+rnorm">rnorm</a></code>, <code><a href="stats.html#topic+rlnorm">rlnorm</a></code>,
<code><a href="stats.html#topic+rweibull">rweibull</a></code>, <code><a href="stats.html#topic+rgamma">rgamma</a></code>,
<code><a href="stats.html#topic+rcauchy">rcauchy</a></code> and <code><a href="stats.html#topic+rbeta">rbeta</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It generates a two-component mixture dataset from a density function
</p>
<p style="text-align: center;"><code class="reqn">\pi f_1 + (1 - \pi) f_2,</code>
</p>
<p> where <code class="reqn">f_1</code> and <code class="reqn">f_2</code> are the first
and the second mixture component distributions respectively.
</p>


<h3>Value</h3>

<p>An object of class <code>data.frame</code> containing the following
information: </p>
<table>
<tr><td><code>z</code></td>
<td>
<p>mixture data</p>
</td></tr> <tr><td><code>label</code></td>
<td>
<p>component indicator</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Lida Fallah, John Hinde
</p>
<p>Maintainer: Lida Fallah &lt;l.fallah22@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pcgen">pcgen</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate a sample from a two component Normal-Weibull mixture distribution
## with mixing components as N(12, 2) and Weibull(15, 4), mixing proportion 0.3
## and size of N = 20.

mixture&lt;- mixgen(N = 20, dist1 = 'norm', dist2 = 'weibull', control = list(12, 2, 15, 4, 0.3))

</code></pre>

<hr>
<h2 id='pcensmix-internal'>Internal function for pcensmix</h2><span id='topic+pcensmix-internal'></span><span id='topic+.f_u'></span>

<h3>Description</h3>

<p>.f_u function is for internal usage only and is not intended to be called
by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.f_u(eps, Pdat, muhat1, muhat2, sigmahat1, sigmahat2, pi_hat, muhat1_est,
  muhat2_est, sigmahat1_est, sigmahat2_est, pi_hat_est, ll, W, Z, INERiter, N)
</code></pre>


<h3>Author(s)</h3>

<p>Lida Fallah, John Hinde
</p>
<p>Maintainer: Lida Fallah &lt;l.fallah22@gmail.com&gt;
</p>

<hr>
<h2 id='pcensmixR'>Fitting a Normal Mixture Model to a Real Progressive Type-II Censored Mixture
Data Using EM Algorithm</h2><span id='topic+pcensmixR'></span><span id='topic+pcensmixR.pcgen'></span>

<h3>Description</h3>


<p>This function uses a two-layer EM algorithm to fit a mixture model to
progressive Type-II censored mixture data by estimating the latent mixture
components and the censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcensmixR(Pdat, ...)

## S3 method for class 'pcgen'
pcensmixR(Pdat, start, iteration = 1e+05, INERiter = 20,
  warn = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcensmixR_+3A_pdat">Pdat</code></td>
<td>
<p>an object of class <code>"pcgen"</code> created by function
<code><a href="#topic+pcgen">pcgen</a></code> or a two-column matrix (or data.frame)
with first column
giving a vector of censored version of a two-component mixed normal data,
and the other one indicating the censoring status associated with them (1
if not censored, otherwise zero).</p>
</td></tr>
<tr><td><code id="pcensmixR_+3A_...">...</code></td>
<td>
<p>additinal arguments to pass by.</p>
</td></tr>
<tr><td><code id="pcensmixR_+3A_start">start</code></td>
<td>
<p>a numeric vector; used as starting values for the EM algorithm.</p>
</td></tr>
<tr><td><code id="pcensmixR_+3A_iteration">iteration</code></td>
<td>
<p>the maximum number of required iteration for the EM
algorithm until convergence&ndash; default value is 1e+05.</p>
</td></tr>
<tr><td><code id="pcensmixR_+3A_ineriter">INERiter</code></td>
<td>
<p>the maximum number of required iteration for the second EM
algorithm&ndash; default is 20.</p>
</td></tr>
<tr><td><code id="pcensmixR_+3A_warn">warn</code></td>
<td>
<p>logical. shows warning messages if <code>TRUE</code>, if there is any&ndash;
default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a two-component normal mixture model to
a given progressive Type-II censored data.
</p>
<p>It uses a two-layer EM algorithm for fitting the model. Generally speaking,
the first layer estimates the mixture component latent variables, in the E-step, by finding their conditional expected
values given the current parameter estimates and the data; and the second layer consists
of another EM algorithm to estimate the missing censored data and eventually the parameters of interest.
The layers are repeated until convergence achieved.
</p>


<h3>Value</h3>

<p><code>pcensmixR</code> gives an object of class <code>data.frame</code>
containing the following components:
</p>
<table>
<tr><td><code>muhat1</code>, <code>sigmahat1</code></td>
<td>
<p>component one parameter
estimates (<code class="reqn">\hat\mu_1</code>, <code class="reqn">\hat\sigma_1</code> )</p>
</td></tr>
<tr><td><code>muhat2</code>, <code>sigmahat2</code></td>
<td>
<p>component two parameter
estimates (<code class="reqn">\hat\mu_2</code>, <code class="reqn">\hat\sigma_2</code> )</p>
</td></tr>
<tr><td><code>pihat</code></td>
<td>
<p>estimation of mixture proportion <code class="reqn">\hat\pi</code></p>
</td></tr>
<tr><td><code>se.muhat1</code>, <code>se.sigmahat1</code></td>
<td>
<p>standard errors of
<code class="reqn">\hat\mu_1</code> and <code class="reqn">\hat\sigma_1</code></p>
</td></tr>
<tr><td><code>se.muhat2</code>, <code>se.sigmahat2</code></td>
<td>
<p>standard errors of
<code class="reqn">\hat\mu_2</code> and <code class="reqn">\hat\sigma_2</code></p>
</td></tr>
<tr><td><code>se.pihat</code></td>
<td>
<p>standard error of <code class="reqn">\hat\pi</code></p>
</td></tr>
<tr><td><code>no.fails.comp1</code>, <code>no.fails.comp2</code></td>
<td>
<p>number of failures from each mixture
component</p>
</td></tr> <tr><td><code>no.cens.comp1</code>, <code>no.cens.comp2</code></td>
<td>
<p>number of censored
observations from each mixture component</p>
</td></tr> <tr><td><code>ll</code></td>
<td>
<p>log-likelihood value</p>
</td></tr>
</table>


<h3>Note</h3>

<p>See <code><a href="#topic+pcgen">pcgen</a></code> for the definition of censored
version of data.
</p>


<h3>Author(s)</h3>

<p>Lida Fallah, John Hinde
</p>
<p>Maintainer: Lida Fallah &lt;l.fallah22@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pcgen">pcgen</a></code>, <code><a href="#topic+pcensmixSim">pcensmixSim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: fit a mixture model to 'insulate' data
set.seed(107)
Pdat&lt;- pcgen(r = 15, p = 0.6, data = insulate)
pcensmixR(Pdat, start = c(5, 3, 35, 20, 0.6))

## Not run: 
## Example 2: fit a mixture model to 'Systolic blood pressure' data
set.seed(1010)
pcensmixR(Pdat = pcgen(360, 0.35, blood$Systolic.BP),
               start = c(120, 15, 150, 20, 0.6))
## End(Not run)

</code></pre>

<hr>
<h2 id='pcensmixSim'>Fitting a Normal Mixture Model to a Simulated Progressive Type-II Censored
Data Using EM Algorithm</h2><span id='topic+pcensmixSim'></span><span id='topic+pcensmixSim.pcgen'></span>

<h3>Description</h3>


<p>This function fits a normal mixture model
to progressive Type-II censored mixture data by dealing with the two aspects of
missing data, latent mixture components and the censored data, using a maximum
likelihood estimation through a constrained two-layer EM algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcensmixSim(Pdat, ...)

## S3 method for class 'pcgen'
pcensmixSim(Pdat, r, p, param, iteration = 1e+05,
  INERiter = 20, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcensmixSim_+3A_pdat">Pdat</code></td>
<td>
<p>an object of class <code>"pcgen"</code> created by function
<code><a href="#topic+pcgen">pcgen</a></code> or a two-column matrix (or data.frame)
with first column
giving a vector of censored version of a two-component mixed normal data,
and the other one indicating the censoring status associated with them (1
if not censored, otherwise zero).</p>
</td></tr>
<tr><td><code id="pcensmixSim_+3A_...">...</code></td>
<td>
<p>additinal arguments to pass by.</p>
</td></tr>
<tr><td><code id="pcensmixSim_+3A_r">r</code></td>
<td>
<p>desired number of failures to observe.</p>
</td></tr>
<tr><td><code id="pcensmixSim_+3A_p">p</code></td>
<td>
<p>a parameter controlling the amount of censoring. The action of
censoring individuals after each failure occurs with probabilty <code>p</code>
from binomial distribution at each stage. If <code>p = 0</code>, there will be no
censoring.</p>
</td></tr>
<tr><td><code id="pcensmixSim_+3A_param">param</code></td>
<td>
<p>a numeric vector; used as starting values for the EM and
simulating a new data to replace in case of happening singularity in the
likelihood.</p>
</td></tr>
<tr><td><code id="pcensmixSim_+3A_iteration">iteration</code></td>
<td>
<p>the maximum number of required iteration for the EM
algorithm until convergence&ndash; default value is 1e+05.</p>
</td></tr>
<tr><td><code id="pcensmixSim_+3A_ineriter">INERiter</code></td>
<td>
<p>the maximum number of required iteration for the second EM
algorithm&ndash; default is 20.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a two-component normal mixture model to simulated
progressive Type-II censored data with density function </p>
<p style="text-align: center;"><code class="reqn">\pi
  (\frac{1}{\sigma_1})\,  \phi\!\! \left[\frac{(z - \mu_1)}{\sigma_1}\right]
  + (1 - \pi) (\frac{1}{\sigma_2})\,  \phi\!\! \left[\frac{(z -
  \mu_2)}{\sigma_2}\right]</code>
</p>
<p> where <code class="reqn">\phi</code>
is the standard normal density.
</p>
<p>It uses a constrained two-layer EM algorithm to deal with the two forms of
missing data: the censored survival times and the mixture component labels.
Given the EM algorithm is at a particular iteration: (i) first, in the
E-step it obtains the mixture component indicator estimates given the
current parameter estimates and the observed data. (ii) Next, for
re-estimation of the unknown parameters, a new EM algorithm is nested in
the M-step of the initial EM algorithm to deal with the estimation of the
missing censored survival times and consequently building the maximum
likelihood equations. These steps are repeated until the model converges.
</p>


<h3>Value</h3>

<p><code>pcensmixSim</code> gives an object of class <code>data.frame</code>
containing the following components: </p>
<table>
<tr><td><code>muhat1</code>, <code>sigmahat1</code></td>
<td>
<p>component one
parameter estimates (<code class="reqn">\hat\mu_1</code>,
<code class="reqn">\hat\sigma_1</code> )</p>
</td></tr> <tr><td><code>muhat2</code>, <code>sigmahat2</code></td>
<td>
<p>component two
parameter estimates (<code class="reqn">\hat\mu_2</code>,
<code class="reqn">\hat{\sigma_2}</code></p>
</td></tr> <tr><td><code>pihat</code></td>
<td>
<p>estimation of mixture
proportion <code class="reqn">\hat\pi</code></p>
</td></tr> <tr><td><code>se.muhat1</code>, <code>se.sigmahat1</code></td>
<td>
<p>standard
errors of <code class="reqn">\hat\mu_1</code> and <code class="reqn">\hat{\sigma_1}</code></p>
</td></tr>
<tr><td><code>se.muhat2</code>, <code>se.sigmahat2</code></td>
<td>
<p>standard errors of
<code class="reqn">\hat\mu_2</code> and <code class="reqn">\hat\sigma_2</code></p>
</td></tr>
<tr><td><code>se.pihat</code></td>
<td>
<p>standard error of <code class="reqn">\hat\pi</code></p>
</td></tr>
<tr><td><code>no.fails.comp1</code>, <code>no.fails.comp2</code></td>
<td>
<p>number of failures from each mixture
component</p>
</td></tr> <tr><td><code>no.cens.comp1</code>, <code>no.cens.comp2</code></td>
<td>
<p>number of censored
observations from each mixture component</p>
</td></tr> <tr><td><code>ll</code></td>
<td>
<p>log-likelihood value</p>
</td></tr>
<tr><td><code>datachange_flag</code></td>
<td>
<p><code>TRUE</code> if data has been replaced by a newly
generated one</p>
</td></tr>
</table>


<h3>Note</h3>

 <ul>
<li><p> In fitting the model, to overcome the problem of
singularity and model non-identifiability that might happen in some cases
depending on the true means and standard deviations of the components, we
use the constraint proposed by Hathaway (1985). Based on this, the
ratios of the standard deviations are considered to be greater than a
pre-fixed constant. We consider the constraints <code class="reqn">\sigma_1/\sigma_2&gt;0.1</code>
and <code class="reqn">\sigma_2/\sigma_1&gt;0.1</code> which lead to obtain a parameter space with
no singularities. In case this conditions doesn't hold, the data will be
replaced by a new simulated one and <code>datachange_flag</code> will appear as
<code>TRUE</code> in the output. </p>
</li>
<li><p> See <code><a href="#topic+pcgen">pcgen</a></code> for the
definition of censored version of data.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Lida Fallah, John Hinde
</p>
<p>Maintainer: Lida Fallah &lt;l.fallah22@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pcgen">pcgen</a></code>, <code><a href="#topic+run_pcensmix">run_pcensmix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(100)

Pdat&lt;- pcgen(r = 60, p = 0.3, data = mixgen(N = 100, dist1 = 'norm',
                 dist2 = 'norm', control = list(12, 2, 14, 5, 0.35)))
pcensmixSim(Pdat, r = 60, p = 0.3, param=c(12, 2, 14, 5, 0.35))
## End(Not run)

</code></pre>

<hr>
<h2 id='pcgen'>Creating a Progressively Type-II Censored Version of a Given Dataset</h2><span id='topic+pcgen'></span>

<h3>Description</h3>

<p>This function implements an algorithm for generating a progressive Type-II
censored version of a specified dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcgen(r, p, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcgen_+3A_r">r</code></td>
<td>
<p>desired number of failures to observe.</p>
</td></tr>
<tr><td><code id="pcgen_+3A_p">p</code></td>
<td>
<p>a parameter controlling the amount of censoring. The action of
censoring individuals after each failure occurs with probabilty <code>p</code>
from binomial distribution at each stage. If <code>p = 0</code>, no censoring
will happen.</p>
</td></tr>
<tr><td><code id="pcgen_+3A_data">data</code></td>
<td>
<p>a numeric vector of a real dataset (mixture/not mixture) or an
object of class <code>data.frame</code> generated by
<code><a href="#topic+mixgen">mixgen</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It creates a progressive Type-II censored version of a given real
dataset or a simulated dataset from <code><a href="#topic+mixgen">mixgen</a></code>. The
output of this function can be passed as an argument to
<code><a href="#topic+pcensmixR">pcensmixR</a></code> or <code><a href="#topic+pcensmixSim">pcensmixSim</a></code> for the purpose of fitting a
normal mixture model to the progressively censored dataset.
</p>


<h3>Value</h3>

<p>An object of class <code>"pcgen"</code> containing the following
information: </p>
<table>
<tr><td><code>original_data</code></td>
<td>
<p>original mixture data</p>
</td></tr>
<tr><td><code>label</code></td>
<td>
<p>component membership indicator for the original simulated
mixture data. This will not be returned if a real data has been used.</p>
</td></tr>
<tr><td><code>censored_version_of_data</code></td>
<td>
<p>progressive Type-II censored version of
data, i.e., each observation is equal to the actual observed survival time
in the event of failure and is equal to the latest observe failure time if
it is associated to an unobserved censored observation. Notice that they
are order statistics.</p>
</td></tr> <tr><td><code>component_indicator</code></td>
<td>
<p>component indicator
associated with the censored_verison_of_data. This will not be returned if
a real data has been used.</p>
</td></tr> <tr><td><code>censoring_indicator</code></td>
<td>
<p>censoring indicator
associated with the censored_verison_of_data.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>See <code><a href="#topic+print.pcgen">print.pcgen</a></code> for printing data of class
<code>"pcgen"</code>.
</p>


<h3>Author(s)</h3>

<p>Lida Fallah, John Hinde
</p>
<p>Maintainer: Lida Fallah &lt;l.fallah22@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mixgen">mixgen</a></code>, <code><a href="#topic+print.pcgen">print.pcgen</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## 1. Generate a progressive Type-II censored data from a simulated mixture data with
## allowing for censoring with controlling parameters p = 0.3 and r = 12.
set.seed(0)
mixture &lt;- mixgen(N = 20, dist1 = 'norm', dist2 = 'weibull', control = list(12, 2, 15, 4, 0.3))
Pdat0 &lt;- pcgen(r = 12, p = 0.3, data = mixture)
print(Pdat0)


## 2. Examples of generating a progresively Type-II censored data

set.seed(0)
Pdat1 &lt;- pcgen(r = 6, p = 0.3, data = insulate)
print(Pdat1)

set.seed(100)
Pdat2 &lt;- pcgen(r = 260, p = 0.35, data = blood$Systolic.BP)
print(Pdat2)


</code></pre>

<hr>
<h2 id='print.pcgen'>Print Method for pcgen Objects</h2><span id='topic+print.pcgen'></span>

<h3>Description</h3>

<p>This function prints the progressive censored data generated by the S3
class <code><a href="#topic+pcgen">pcgen</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pcgen'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.pcgen_+3A_x">x</code></td>
<td>
<p>object of class <code>pcgen</code>.</p>
</td></tr>
<tr><td><code id="print.pcgen_+3A_...">...</code></td>
<td>
<p>optional arguments to pass by.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function uses the generic function <code><a href="base.html#topic+print">print</a></code>
to print the dataset of class <code>"pcgen"</code> in a nice format.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate a two component normal mixture data,
Pdat &lt;- pcgen(r = 80, p = 0.3, data = mixgen(N = 100, dist1 = 'norm',
              dist2 = 'norm', control = list(12, 2, 14, 4, 0.3)))
# and print it.
print(Pdat)

</code></pre>

<hr>
<h2 id='run_pcensmix'>Generating Progressively Type-II Censored Mixture Data and Fitting a Model</h2><span id='topic+run_pcensmix'></span>

<h3>Description</h3>

<p>This function implements an algorithm using the
<code><a href="#topic+mixgen">mixgen</a></code>, <code><a href="#topic+pcgen">pcgen</a></code> and
<code><a href="#topic+pcensmixSim">pcensmixSim</a></code> functions to generate data and fit a model
using EM algorithm with a specified number of iterations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_pcensmix(N, r, p, param, repetition = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="run_pcensmix_+3A_n">N</code></td>
<td>
<p>population size.</p>
</td></tr>
<tr><td><code id="run_pcensmix_+3A_r">r</code></td>
<td>
<p>required number of failures to observe.</p>
</td></tr>
<tr><td><code id="run_pcensmix_+3A_p">p</code></td>
<td>
<p>a parameter controlling the amount of censoring. The action of
censoring individuals after each failure occurs with probabilty <code>p</code>
from a binomial distribution at each stage. If <code>p = 0</code>, there will be
no censoring.</p>
</td></tr>
<tr><td><code id="run_pcensmix_+3A_param">param</code></td>
<td>
<p>a numeric vector; used as starting values for the EM and
simulating a new data to replace in case of happening singularity in the
likelihood.</p>
</td></tr>
<tr><td><code id="run_pcensmix_+3A_repetition">repetition</code></td>
<td>
<p>the required number of repetition of the algorithm&ndash; default
is 100.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns the parameter estimates given by
<code><a href="#topic+pcensmixSim">pcensmixSim</a></code> with the desired number of repetitions.
In each repetition it generates a new normal mixture progressive Type-II
censored dataset from the same true parameter values and fits a model.
</p>


<h3>Author(s)</h3>

<p>Lida Fallah, John Hinde
</p>
<p>Maintainer: Lida Fallah &lt;l.fallah22@gmail.com&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pcgen">pcgen</a></code>, <code><a href="#topic+pcensmixSim">pcensmixSim</a></code>, <code><a href="#topic+mixgen">mixgen</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## Example 1: with very well separated mixture components
set.seed(3)
f1 &lt;- run_pcensmix(N = 160, r = 120, p = 0.3, param = c(10, 2, 25, 4, 0.3), repetition = 100)
colMeans(f1)

## Example 2.
set.seed(150)
f2 &lt;- run_pcensmix(N = 160, r = 130, p = 0.35, param = c(10, 2, 17, 4, 0.3), repetition = 100)
colMeans(f2)

## Example 3.
set.seed(20)
f3 &lt;- run_pcensmix(N = 160, r = 130, p = 0.3, param = c(20, 6, 22, 12, 0.6), repetition = 100)
colMeans(f3)


## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
