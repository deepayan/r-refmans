<!DOCTYPE html><html><head><title>Help for package dr4pl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dr4pl}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calculate.dr4pl'><p>dr4pl-calculate</p></a></li>
<li><a href='#coef.dr4pl'><p>Obtain coefficients of a 4PL model</p></a></li>
<li><a href='#confint.dr4pl'><p>Fit a 4 parameter logistic (4PL) model to dose-response data.</p></a></li>
<li><a href='#dr4pl'><p>Fitting 4 Parameter Logistic (4PL) models to dose-response data.</p></a></li>
<li><a href='#dr4pl-augment'><p>Augment data with dr4pl</p></a></li>
<li><a href='#dr4pl-param'><p>Constructor for dr4pl theta parameter</p></a></li>
<li><a href='#dr4plEst'><p>Private function to fit the 4PL model to dose-response data</p></a></li>
<li><a href='#drc_error_1'><p>Single High Outlier</p></a></li>
<li><a href='#drc_error_2'><p>Multiple High Outliers at Different measurements</p></a></li>
<li><a href='#drc_error_3'><p>Support Problem and Outliers at a Single Dose Level</p></a></li>
<li><a href='#drc_error_4'><p>Support Problem</p></a></li>
<li><a href='#FindHillBounds'><p>FindHillBounds</p></a></li>
<li><a href='#FindInitialParms'><p>FindInitialParms</p></a></li>
<li><a href='#FindLogisticGrids'><p>FindLogisticGrids</p></a></li>
<li><a href='#gof'><p>Perform the goodness-of-fit (gof) test for a model.</p></a></li>
<li><a href='#gof-dr4pl'><p>Perform the goodness-of-fit (gof) test for the 4PL model.</p></a></li>
<li><a href='#IC'><p>Obtain Inhibitory Concentrations (IC) of a dose-response curve</p></a></li>
<li><a href='#MeanResponse'><p>Compute an estimated mean response.</p></a></li>
<li><a href='#OutlierDetection'><p>Detect outliers by the method of Motulsky and Brown (2006).</p></a></li>
<li><a href='#plot.dr4pl'><p>Make a plot of a 4PL model curve and data</p></a></li>
<li><a href='#print.dr4pl'><p>Print the dr4pl object to screen.</p></a></li>
<li><a href='#print.summary.dr4pl'><p>Print the dr4pl object summary to screen.</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#residuals.dr4pl'><p>Compute dr4pl residuals.</p></a></li>
<li><a href='#sample_data_1'><p>sample_data_1</p></a></li>
<li><a href='#sample_data_10'><p>sample_data_10</p></a></li>
<li><a href='#sample_data_11'><p>sample_data_11</p></a></li>
<li><a href='#sample_data_12'><p>sample_data_12</p></a></li>
<li><a href='#sample_data_13'><p>sample_data_13</p></a></li>
<li><a href='#sample_data_2'><p>sample_data_2</p></a></li>
<li><a href='#sample_data_3'><p>sample_data_3</p></a></li>
<li><a href='#sample_data_4'><p>sample_data_4</p></a></li>
<li><a href='#sample_data_5'><p>sample_data_5</p></a></li>
<li><a href='#sample_data_6'><p>sample_data_6</p></a></li>
<li><a href='#sample_data_7'><p>sample_data_7</p></a></li>
<li><a href='#sample_data_8'><p>sample_data_8</p></a></li>
<li><a href='#sample_data_9'><p>sample_data_9</p></a></li>
<li><a href='#summary.dr4pl'><p>summary</p></a></li>
<li><a href='#vcov.dr4pl'><p>Obtain the variance-covariance matrix of the parameter estimators of a</p>
4PL model.</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-08-16</td>
</tr>
<tr>
<td>Title:</td>
<td>Dose Response Data Analysis using the 4 Parameter Logistic (4pl)
Model</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Models the relationship between dose levels and responses in a pharmacological experiment using the 4 Parameter Logistic model. Traditional packages on dose-response modelling such as 'drc' and 'nplr' often draw errors due to convergence failure especially when data have outliers or non-logistic shapes. This package provides robust estimation methods that are less affected by outliers and other initialization methods that work well for data lacking logistic shapes. We provide the bounds on the parameters of the 4PL model that prevent parameter estimates from diverging or converging to zero and base their justification in a statistical principle. These methods are used as remedies to convergence failure problems.  Gadagkar, S. R. and Call, G. B. (2015) &lt;<a href="https://doi.org/10.1016%2Fj.vascn.2014.08.006">doi:10.1016/j.vascn.2014.08.006</a>&gt; Ritz, C. and Baty, F. and Streibig, J. C. and Gerhard, D. (2015) &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0146021">doi:10.1371/journal.pone.0146021</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://bitbucket.org/dittmerlab/dr4pl">https://bitbucket.org/dittmerlab/dr4pl</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://bitbucket.org/dittmerlab/dr4pl/issues?status=new&amp;status=open">https://bitbucket.org/dittmerlab/dr4pl/issues?status=new&amp;status=open</a></td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, Matrix, tensor, Rdpack, generics, rlang, glue</td>
</tr>
<tr>
<td>Suggests:</td>
<td>drc, devtools, roxygen2, testthat, knitr, rmarkdown, tibble</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-08-17 13:49:51 UTC; jtlandis</td>
</tr>
<tr>
<td>Author:</td>
<td>Justin T. Landis [aut, cre],
  Alice Peng [ctb],
  Hyowon An [aut],
  Aubrey G. Bailey [aut],
  Dirk P. Dittmer [aut],
  James S. Marron [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Justin T. Landis &lt;jtlandis314@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-08-17 16:10:18 UTC</td>
</tr>
</table>
<hr>
<h2 id='calculate.dr4pl'>dr4pl-calculate</h2><span id='topic+calculate.dr4pl'></span>

<h3>Description</h3>

<p>calculate various useful statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dr4pl'
calculate(x, parm = NULL, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate.dr4pl_+3A_x">x</code></td>
<td>
<p>an object of class 'dr4pl'</p>
</td></tr>
<tr><td><code id="calculate.dr4pl_+3A_parm">parm</code></td>
<td>
<p>parameters of the dr4pl object. Usually made with [dr4pl_theta]</p>
</td></tr>
<tr><td><code id="calculate.dr4pl_+3A_level">level</code></td>
<td>
<p>confidence level to calculate. Defaults to 0.95</p>
</td></tr>
<tr><td><code id="calculate.dr4pl_+3A_...">...</code></td>
<td>
<p>extra arguments to be passed to [vcov.dr4pl]</p>
</td></tr>
</table>

<hr>
<h2 id='coef.dr4pl'>Obtain coefficients of a 4PL model</h2><span id='topic+coef.dr4pl'></span>

<h3>Description</h3>

<p>This function obtains the coefficients of a 4PL model. Estimates
of the four parameters, the upper asymptote, IC50, slope and lower asymptote,
are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dr4pl'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.dr4pl_+3A_object">object</code></td>
<td>
<p>A 'dr4pl' object</p>
</td></tr>
<tr><td><code id="coef.dr4pl_+3A_...">...</code></td>
<td>
<p>arguments passed to coef</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obj.dr4pl &lt;- dr4pl(Response ~ Dose, data = sample_data_2)  # Fit a 4PL model to data
coef(obj.dr4pl)  # Print parameter estimates

obj.dr4pl &lt;- dr4pl(Response ~ Dose, data = sample_data_3)  # Fit a 4PL model to data
coef(obj.dr4pl)  # Print parameter estimates

</code></pre>

<hr>
<h2 id='confint.dr4pl'>Fit a 4 parameter logistic (4PL) model to dose-response data.</h2><span id='topic+confint.dr4pl'></span>

<h3>Description</h3>

<p>Compute the approximate confidence intervals of the parameters of a
4PL model based on the asymptotic normality of least squares estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dr4pl'
confint(object, parm = NULL, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.dr4pl_+3A_object">object</code></td>
<td>
<p>An object of the dr4pl class</p>
</td></tr>
<tr><td><code id="confint.dr4pl_+3A_parm">parm</code></td>
<td>
<p>parameters of the dr4pl object. Usually made with [dr4pl_theta]</p>
</td></tr>
<tr><td><code id="confint.dr4pl_+3A_level">level</code></td>
<td>
<p>Confidence level</p>
</td></tr>
<tr><td><code id="confint.dr4pl_+3A_...">...</code></td>
<td>
<p>Other parameters to be passed to vcov</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the approximate confidence intervals of the
true parameters of a 4PL model based on the asymptotic normality of the least
squares estimators in nonlinear regression. The Hessian matrix is used to
obtain the second order approximation to the sum-of-squares loss function.
Please refer to Subsection 5.2.2 of Seber and Wild (1989).
</p>


<h3>Value</h3>

<p>A matrix of the confidence intervals in which each row represents a
parameter and each column represents the lower and upper bounds of the
confidence intervals of the corresponding parameters.
</p>


<h3>References</h3>

<p>Seber GAF, Wild CJ (1989).
<em>Nonlinear regression</em>,  Wiley Series in Probability and Mathematical Statistics: Probability and Mathematical Statistics.
John Wiley \&amp; Sons, Inc., New York.
ISBN 0-471-61760-1, doi: <a href="https://doi.org/10.1002/0471725315">10.1002/0471725315</a>, <a href="http://dx.doi.org.libproxy.lib.unc.edu/10.1002/0471725315">http://dx.doi.org.libproxy.lib.unc.edu/10.1002/0471725315</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obj.dr4pl &lt;- dr4pl(Response ~ Dose, data = sample_data_1)  # Fit a 4PL model to data

## Use the data 'sample_data_1' to obtain confidence intervals.
confint(obj.dr4pl)  # 95% confidence intervals
confint(obj.dr4pl, level = 0.99)  # 99% confidence intervals

theta &lt;- FindInitialParms(x = sample_data_1$Dose, y = sample_data_1$Response)

# Use the same data 'sample_data_1' but different parameter estimates to obtain
# confidence intervals.
confint(obj.dr4pl, parm = theta)

</code></pre>

<hr>
<h2 id='dr4pl'>Fitting 4 Parameter Logistic (4PL) models to dose-response data.</h2><span id='topic+dr4pl'></span><span id='topic+dr4pl.formula'></span><span id='topic+dr4pl.data.frame'></span><span id='topic+dr4pl.default'></span>

<h3>Description</h3>

<p>This function fits a 4PL model to dose-response data. Users can
obtain fitted parameter estimates as return values. Using auxiliary functions
provided by this R package, users can plot a fitted dose-response curve and
obtain confidence intervals of true parameters. In addition, the goodness-of-fit
test for model adequacy of the 4PL models can be performed when replicates are
available for each dose level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dr4pl(...)

## S3 method for class 'formula'
dr4pl(
  formula,
  data = list(),
  init.parm = dr4pl_theta(),
  trend = "auto",
  method.init = "Mead",
  method.robust = "squared",
  method.optim = "Nelder-Mead",
  use.Hessian = FALSE,
  level = 0.9999,
  failure.message = FALSE,
  upperl = NULL,
  lowerl = NULL,
  ...
)

## S3 method for class 'data.frame'
dr4pl(
  data,
  dose,
  response,
  init.parm = dr4pl_theta(),
  trend = "auto",
  method.init = "Mead",
  method.robust = "squared",
  method.optim = "Nelder-Mead",
  use.Hessian = FALSE,
  level = 0.9999,
  failure.message = FALSE,
  upperl = NULL,
  lowerl = NULL,
  ...
)

## Default S3 method:
dr4pl(
  dose,
  response,
  init.parm = dr4pl_theta(),
  trend = "auto",
  method.init = "Mead",
  method.robust = "squared",
  method.optim = "Nelder-Mead",
  use.Hessian = FALSE,
  level = 0.9999,
  failure.message = FALSE,
  upperl = NULL,
  lowerl = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dr4pl_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code>constrOptim</code>.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_formula">formula</code></td>
<td>
<p>Symbolic description of the model to be fit. Either of the
form 'response ~ dose' or as a data frame with response values in first
column and dose values in second column.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_data">data</code></td>
<td>
<p>Data frame containing variables in the model.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_init.parm">init.parm</code></td>
<td>
<p>Either a call to [dr4pl_theta], or a Vector of initial parameters
to be optimized in the model.
</p>

<ul>
<li><p> UpperLimit:  <code class="reqn">\theta[1]</code>
</p>
</li>
<li><p> IC50/EC50: <code class="reqn">\theta[2]</code>
</p>
</li>
<li><p> Slope: <code class="reqn">\theta[3]</code>
</p>
</li>
<li><p> LowerLimit: <code class="reqn">\theta[4]</code>
</p>
</li></ul>

<p>dr4pl assumes <code class="reqn">\theta[1]&gt;\theta[4]</code>. Note that when using upperl and
lowerl, the user may need to set this parameter because the estimated
parameters may not be within the feasible region.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_trend">trend</code></td>
<td>
<p>Indicator of whether a dose-response curve is a decreasing
<code class="reqn">\theta[3]&lt;0</code> or increasing curve <code class="reqn">\theta[3]&gt;0</code>. The default is &quot;auto&quot;
which indicates that the trend of the curve is automatically determined by
data. The option &quot;decreasing&quot; will impose a restriction <code class="reqn">\theta[3]&lt;=0</code>
while the option &quot;increasing&quot; will impose a restriction <code class="reqn">\theta[3]&gt;=0</code> in an
optimization process.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_method.init">method.init</code></td>
<td>
<p>Method of obtaining initial values of the parameters.
If this parameter is left unassigned, a default &quot;Mead&quot; method will be used.
Assign &quot;logistic&quot; to use the logistic method.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_method.robust">method.robust</code></td>
<td>
<p>Parameter to select loss function for the robust estimation
method to be used to fit a model. The argument NULL indicates the sum of squares
loss, &quot;absolute&quot; indicates the absolute deviation loss, &quot;Huber&quot; indicates Huber's
loss and &quot;Tukey&quot; indicates Tukey's biweight loss.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_method.optim">method.optim</code></td>
<td>
<p>Method of optimization of the loss function specified by
<code>method.robust</code>. This function argument is directly passed to the function
<code><a href="stats.html#topic+constrOptim">constrOptim</a></code> which is provided in the <span class="pkg">base</span> package of R.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_use.hessian">use.Hessian</code></td>
<td>
<p>Indicator of whether the Hessian matrix (TRUE) or the
gradient vector is used in the Hill bounds.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_level">level</code></td>
<td>
<p>Confidence level to be used in Hill bounds computation.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_failure.message">failure.message</code></td>
<td>
<p>Indicator of whether a message indicating attainment of
the Hill bounds and possible resolutions will be printed to the console (TRUE)
or hidden (FALSE).</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_upperl">upperl</code></td>
<td>
<p>Either NULL or a numeric vector of length 4 that specifies the upper limit
for the initial parameters of <code class="reqn">c(\theta[1],\theta[2],\theta[3],\theta[4])</code> during the
optimization process. By default no upperl is assumed. If the user wants to constain only
some parameter values, set desired numeric bound in the appropriate position and fill Inf
to impose no upper bounds on other values. All upperl values must be greater than
corresponding initalized parameters.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_lowerl">lowerl</code></td>
<td>
<p>Either NULL or a numeric vector of length 4 that specifies the lower limit
for the initial parameters of <code class="reqn">c(\theta[1],\theta[2],\theta[3],\theta[4])</code> during the
optimization process. By default no lowerl is assumed. If the user wants to constain only
some parameter values, set desired numeric bound in the appropriate position and fill -Inf
to impose no lower bounds on other values. All lowerl values must be greater than
corresponding initalized parameters.</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_dose">dose</code></td>
<td>
<p>Vector of dose levels</p>
</td></tr>
<tr><td><code id="dr4pl_+3A_response">response</code></td>
<td>
<p>Vector of responses</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits a 4 parameter logistic (4PL) model to dose-response
data. A formula of the model is
</p>
<p style="text-align: center;"><code class="reqn">\theta[1]+(\theta[4]-\theta[1])/(1+(z/\theta[2])^\theta[3])</code>
</p>

<p><code>method.init</code> specifies an initialization method to get initial parameter
estimates based on data. The currently supported initialization methods are
&quot;logistic&quot; and 'Mead'. For further details, see the vignette.
</p>
<p><code>method.optim</code> specifies an optimization method to be used in
&quot;constrOptim&quot; function. The currently supported optimization techniques
include &quot;Nelder-Mead&quot;, &quot;BFGS&quot;, &quot;CG&quot;, &quot;L-BFGS-B&quot;, &quot;SANN&quot; and &quot;Brent&quot;. For
further details, see the help page of <code><a href="stats.html#topic+optim">optim</a></code>.
</p>
<p><code>method.robust</code> chooses a robust estimation method among 4 methods.
The method of estimation is usually identified by the loss function of the
method. This package supports 4 types of loss functions: sum-of-squares loss,
absolute deviation loss, Huber's loss and Tukey's biweight loss. Each of
loss function is explained in detail in the vignette.
</p>


<h3>Value</h3>

<p>A 'dr4pl' object for which &quot;confint&quot;, &quot;gof&quot;, &quot;print&quot; and &quot;summary&quot;
methods are implemented. For details, see the help page of each method.
For example, type <code>?confint.dr4pl</code> to obtain the confidence intervals
of parameters of the 'dr4pl' object.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>formula</code>: General 4PL model fitting function for analysis of
dose-response relation.
</p>
</li>
<li> <p><code>data.frame</code>: Method for when formula argument is missing.
dose and response arguments are necessary
</p>
</li>
<li> <p><code>default</code>: Used in the default case, supplying a single dose and
response variable
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Hyowon An, <a href="mailto:ahwbest@gmail.com">ahwbest@gmail.com</a>
</p>
<p>Justin T. Landis, <a href="mailto:jtlandis314@gmail.com">jtlandis314@gmail.com</a>
</p>
<p>Aubrey G. Bailey, <a href="mailto:aubreybailey@gmail.com">aubreybailey@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+confint.dr4pl">confint.dr4pl</a></code>, <code><a href="#topic+gof.dr4pl">gof.dr4pl</a></code>,
<code><a href="#topic+print.dr4pl">print.dr4pl</a></code>, <code><a href="#topic+summary.dr4pl">summary.dr4pl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ##Assign method.init = "logistic" to use logistic method of estimation.
  ##default method
  a &lt;- dr4pl(dose = sample_data_1$Dose,
             response = sample_data_1$Response,
             method.init = "logistic")
  plot(a)

  ##Use default or Assign method.init = "Mead" to use Mead's method of estimation.
  # Use method.robust to select desired loss function
  # formula method
  b &lt;- dr4pl(formula = Response~Dose,
             data = sample_data_4,
             method.init = "Mead",
             method.robust = "Tukey" )
  plot(b)

  #data.frame method
  c &lt;- dr4pl(data = sample_data_10,
             dose = Dose,
             response = Response)
  plot(c)

  ##compatable with ggplot
  library(ggplot2) #load ggplot2
  c &lt;- dr4pl(Response~Dose,
             data = drc_error_2,
             method.optim = "CG",
             trend = "decreasing" )
  d &lt;- plot(c, x.breaks = c(.00135, .0135, .135, 1.35, 13.5))
  d + theme_grey()
</code></pre>

<hr>
<h2 id='dr4pl-augment'>Augment data with dr4pl</h2><span id='topic+dr4pl-augment'></span><span id='topic+augment.dr4pl'></span>

<h3>Description</h3>

<p>Augment data with dr4pl
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dr4pl'
augment(x, data = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dr4pl-augment_+3A_x">x</code></td>
<td>
<p>dr4pl object</p>
</td></tr>
<tr><td><code id="dr4pl-augment_+3A_data">data</code></td>
<td>
<p>new data to use</p>
</td></tr>
<tr><td><code id="dr4pl-augment_+3A_...">...</code></td>
<td>
<p>For future extension. Should not be used.</p>
</td></tr>
</table>

<hr>
<h2 id='dr4pl-param'>Constructor for dr4pl theta parameter</h2><span id='topic+dr4pl-param'></span><span id='topic+dr4pl_theta'></span><span id='topic+dr4pl_param'></span><span id='topic+ParmToLog'></span><span id='topic+ParmToLog.dr4pl_theta'></span><span id='topic+ParmToLog.dr4pl_log10'></span><span id='topic+LogToParm'></span><span id='topic+LogToParm.dr4pl_theta'></span><span id='topic+LogToParm.dr4pl_log10'></span>

<h3>Description</h3>

<p>As of version 2.0.0, dr4pl will
require the theta parameter to be made by this
function. This is to ensure the user is explicit
about what their parameter is, and what is being
optimized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dr4pl_theta(
  theta_1 = NA,
  theta_2 = NA,
  theta_3 = NA,
  theta_4 = NA,
  isLog10 = FALSE
)

ParmToLog(x)

## S3 method for class 'dr4pl_theta'
ParmToLog(x)

## S3 method for class 'dr4pl_log10'
ParmToLog(x)

LogToParm(x)

## S3 method for class 'dr4pl_theta'
LogToParm(x)

## S3 method for class 'dr4pl_log10'
LogToParm(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dr4pl-param_+3A_theta_1">theta_1</code></td>
<td>
<p>Numeric. The upper asymptote of the 4pl model.</p>
</td></tr>
<tr><td><code id="dr4pl-param_+3A_theta_2">theta_2</code></td>
<td>
<p>Numeric. The value where Response is half way
between the upper and lower asymptotes. This parameter
is other wise known as IC50/EC50.</p>
</td></tr>
<tr><td><code id="dr4pl-param_+3A_theta_3">theta_3</code></td>
<td>
<p>Numeric. The slope of the 4pl model. When 'theta_3&gt;0'
the curve increases, and when 'theta_3&lt;0', the curve
decreases.</p>
</td></tr>
<tr><td><code id="dr4pl-param_+3A_theta_4">theta_4</code></td>
<td>
<p>Numeric. The lower asymptote of the 4pl model.</p>
</td></tr>
<tr><td><code id="dr4pl-param_+3A_islog10">isLog10</code></td>
<td>
<p>Logical value indicating if the second parameter
is on the log10 scale. The default, FALSE, informs dr4pl that
the value passed to the 'theta_2' argument is on the linear
scale. TRUE will indicate that 'theta_2' has already been
transformed with <a href="base.html#topic+log10">log10</a>. This ensures that the
parameters are handled properly later on.</p>
</td></tr>
<tr><td><code id="dr4pl-param_+3A_x">x</code></td>
<td>
<p>a dr4pl_param object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function 'dr4pl_theta' is a constructor function for the
end user. While the default values for 'theta_1', 'theta_2',
'theta_3', 'theta_4' are 'NA', certain functions of
'dr4pl' will not allow 'NA' values. When 'dr4pl_theta' is
used with the 'init.parm' argument of [dr4pl], then
values with 'NA' will be estimated, and those specified,
will be set as the initial parameter prior to optimization.
If 'dr4pl_theta' is the object of S3 dispatch, then
no NA values are allowed. However if the object if
dispatch is a 'dr4pl' object, and 'dr4pl_theta' is passed
into the function as an additional object such as in [X], [Y],
then parameter non-NA values will be replaced in the appropriate
dr4pl parameter estimates for the purpose of said function.
</p>


<h3>Value</h3>

<p>an object of class '&quot;dr4pl_param&quot;'
</p>

<hr>
<h2 id='dr4plEst'>Private function to fit the 4PL model to dose-response data</h2><span id='topic+dr4plEst'></span>

<h3>Description</h3>

<p>Private function that actually fits the 4PL model to data. If the
Hill bounds are attained at the end of optimization processes, then an
indicator of convergence failure so that <code><a href="#topic+dr4pl.default">dr4pl.default</a></code> can
look for a remedy for convergence failure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dr4plEst(
  dose,
  response,
  init.parm,
  trend,
  method.init,
  method.optim,
  method.robust,
  use.Hessian,
  level,
  upperl,
  lowerl,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dr4plEst_+3A_dose">dose</code></td>
<td>
<p>Vector of dose levels</p>
</td></tr>
<tr><td><code id="dr4plEst_+3A_response">response</code></td>
<td>
<p>Vector of responses</p>
</td></tr>
<tr><td><code id="dr4plEst_+3A_init.parm">init.parm</code></td>
<td>
<p>Vector of initial parameters of the 4PL model supplied by a
user.</p>
</td></tr>
<tr><td><code id="dr4plEst_+3A_trend">trend</code></td>
<td>
<p>Indicator of whether a dose-response curve is a decreasing
<code class="reqn">\theta[3]&lt;0</code> or increasing curve <code class="reqn">\theta[3]&gt;0</code>. The default is &quot;auto&quot;
which indicates that the trend of the curve is automatically determined by
data. The option &quot;decreasing&quot; will impose a restriction <code class="reqn">\theta[3]&lt;=0</code>
while the option &quot;increasing&quot; will impose a restriction <code class="reqn">\theta[3]&gt;=0</code> in an
optimization process.</p>
</td></tr>
<tr><td><code id="dr4plEst_+3A_method.init">method.init</code></td>
<td>
<p>Method of obtaining initial values of the parameters.
Should be one of &quot;logistic&quot; for the logistic method or &quot;Mead&quot; for the Mead
method. The default option is the Mead method.</p>
</td></tr>
<tr><td><code id="dr4plEst_+3A_method.optim">method.optim</code></td>
<td>
<p>Method of optimization of the parameters. This argument
is directly delivered to the <code>constrOptim</code> function provided in the
&quot;base&quot; package of R.</p>
</td></tr>
<tr><td><code id="dr4plEst_+3A_method.robust">method.robust</code></td>
<td>
<p>Parameter to select loss function for the robust estimation
method to be used to fit a model. The argument NULL indicates the sum of squares
loss, &quot;absolute&quot; indicates the absolute deviation loss, &quot;Huber&quot; indicates Huber's
loss and &quot;Tukey&quot; indicates Tukey's biweight loss.</p>
</td></tr>
<tr><td><code id="dr4plEst_+3A_use.hessian">use.Hessian</code></td>
<td>
<p>Indicator of whether the Hessian matrix (TRUE) or the
gradient vector is used in the Hill bounds.</p>
</td></tr>
<tr><td><code id="dr4plEst_+3A_level">level</code></td>
<td>
<p>Confidence level to be used in Hill bounds computation.</p>
</td></tr>
<tr><td><code id="dr4plEst_+3A_upperl">upperl</code></td>
<td>
<p>upper limit to init.parm</p>
</td></tr>
<tr><td><code id="dr4plEst_+3A_lowerl">lowerl</code></td>
<td>
<p>lower limit to init.parm</p>
</td></tr>
<tr><td><code id="dr4plEst_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to <code>constrOptim</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of final parameter estimates, name of robust estimation, loss value
and so on.
</p>

<hr>
<h2 id='drc_error_1'>Single High Outlier</h2><span id='topic+drc_error_1'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These all have numerical errors in other dose-response curve-packages, but not using these methods.
This data set exemplifies the case of a single extreme outlier of one dose measurement.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = drc_error_1, method.init = "logistic", method.robust = "Tukey")
  plot(a)
</code></pre>

<hr>
<h2 id='drc_error_2'>Multiple High Outliers at Different measurements</h2><span id='topic+drc_error_2'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These all have numerical errors in other dose-response curve-packages, but not using these methods.
This data set exemplifies the case of multiple outliers as well as a small number of observations per dose measurement.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = drc_error_2, trend = "decreasing", method.optim = "CG")
  plot(a)
</code></pre>

<hr>
<h2 id='drc_error_3'>Support Problem and Outliers at a Single Dose Level</h2><span id='topic+drc_error_3'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These all have numerical errors in other dose-response curve-packages, but not using these methods.
This data set exemplifies the case of multiple outliers at a single dose measurement as well as the support problem.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = drc_error_3, method.init = "Mead", method.robust = "Huber")
  plot(a)
</code></pre>

<hr>
<h2 id='drc_error_4'>Support Problem</h2><span id='topic+drc_error_4'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These all have numerical errors in other dose-response curve-packages, but not using these methods.
This data set exemplifies the support problem.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = drc_error_4, method.init = "logistic")
  plot(a)
</code></pre>

<hr>
<h2 id='FindHillBounds'>FindHillBounds</h2><span id='topic+FindHillBounds'></span>

<h3>Description</h3>

<p>Compute the Hill bounds based on initial parameter estimates and data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FindHillBounds(x, y, theta, use.Hessian = FALSE, level = 0.9999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FindHillBounds_+3A_x">x</code></td>
<td>
<p>Vector of doses.</p>
</td></tr>
<tr><td><code id="FindHillBounds_+3A_y">y</code></td>
<td>
<p>Vector of responses.</p>
</td></tr>
<tr><td><code id="FindHillBounds_+3A_theta">theta</code></td>
<td>
<p>Parameters of a 4PL model.</p>
</td></tr>
<tr><td><code id="FindHillBounds_+3A_use.hessian">use.Hessian</code></td>
<td>
<p>Indicator of whether the Hessian matrix (TRUE) or the
gradient vector is used in confidence interval computation.</p>
</td></tr>
<tr><td><code id="FindHillBounds_+3A_level">level</code></td>
<td>
<p>Confidence level to be used in computing the Hill bounds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the Hill bounds based on initial parameter
estimates and data. It basically computes the confidence intervals of the
true parameters based on the variance-covariance matrix of a given initial
parameter estimates. The half of a hessian matrix is used as a
variance-covariance matrix. If matrix inversion of the variance-covariance matrix
is infeasible, a variation of the method in Wang et al. (2010) is used. The
parameter <code>level</code> is only for simulation.
</p>


<h3>Value</h3>

<p>Data frame whose first column represents the bounds on the IC50 parameter
in log 10 scale and second column represents the bounds on the slope parameter.
</p>


<h3>Author(s)</h3>

<p>Hyowon An, <a href="mailto:ahwbest@gmail.com">ahwbest@gmail.com</a>.
</p>


<h3>References</h3>

<p>Higham NJ (2002).
&ldquo;Computing the nearest correlation matrix&mdash;a problem from finance.&rdquo;
<em>IMA J. Numer. Anal.</em>, <b>22</b>(3), 329&ndash;343.
ISSN 0272-4979, doi: <a href="https://doi.org/10.1093/imanum/22.3.329">10.1093/imanum/22.3.329</a>, <a href="http://dx.doi.org.libproxy.lib.unc.edu/10.1093/imanum/22.3.329">http://dx.doi.org.libproxy.lib.unc.edu/10.1093/imanum/22.3.329</a>. Wang Y, Jadhav A, Southal N, Huang R, Nguyen DT (2010).
&ldquo;A grid algorithm for high throughput fitting of dose-response curve data.&rdquo;
<em>Curr Chem Genomics</em>, <b>4</b>, 57&ndash;66.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FindInitialParms">FindInitialParms</a></code>, <code><a href="#topic+FindLogisticGrids">FindLogisticGrids</a></code>.
</p>

<hr>
<h2 id='FindInitialParms'>FindInitialParms</h2><span id='topic+FindInitialParms'></span>

<h3>Description</h3>

<p>Find initial parameter estimates for a 4PL model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FindInitialParms(
  x,
  y,
  trend = "auto",
  method.init = "Mead",
  method.robust = "squared"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FindInitialParms_+3A_x">x</code></td>
<td>
<p>Vector of dose levels</p>
</td></tr>
<tr><td><code id="FindInitialParms_+3A_y">y</code></td>
<td>
<p>Vector of responses</p>
</td></tr>
<tr><td><code id="FindInitialParms_+3A_trend">trend</code></td>
<td>
<p>Indicator of whether the curve is a decreasing <code class="reqn">\theta[3]&lt;0</code>
or increasing curve <code class="reqn">\theta[3]&gt;0</code>. See <code><a href="#topic+dr4pl">dr4pl</a></code> for detailed
explanation.</p>
</td></tr>
<tr><td><code id="FindInitialParms_+3A_method.init">method.init</code></td>
<td>
<p>Method of obtaining initial values of the parameters. See
<code><a href="#topic+dr4pl">dr4pl</a></code> for detailed explanation.</p>
</td></tr>
<tr><td><code id="FindInitialParms_+3A_method.robust">method.robust</code></td>
<td>
<p>Parameter to select loss function for the robust estimation
method to be used to fit a model. See <code><a href="#topic+dr4pl">dr4pl</a></code> for detailed
explanation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Initial parameter estimates of a 4PL model in the order of the
upper asymptote, IC50, Slope and lower asymptote parameters.
</p>

<hr>
<h2 id='FindLogisticGrids'>FindLogisticGrids</h2><span id='topic+FindLogisticGrids'></span>

<h3>Description</h3>

<p>Compute the grids on the upper and lower asymptote parameters for the logistic
method based on initial parameter estimates and data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FindLogisticGrids(x, y, retheta.init, use.Hessian = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FindLogisticGrids_+3A_x">x</code></td>
<td>
<p>Vector of doses.</p>
</td></tr>
<tr><td><code id="FindLogisticGrids_+3A_y">y</code></td>
<td>
<p>Vector of responses.</p>
</td></tr>
<tr><td><code id="FindLogisticGrids_+3A_retheta.init">retheta.init</code></td>
<td>
<p>Parameters of a 4PL model among which the EC50 parameter is
in the log 10 dose scale.</p>
</td></tr>
<tr><td><code id="FindLogisticGrids_+3A_use.hessian">use.Hessian</code></td>
<td>
<p>Indicator of whether the Hessian matrix (TRUE) or the
gradient vector is used in confidence interval computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the grids on the upper and lower asymptote
parameters based on initial parameter
estimates and data. It basically computes the confidence intervals of the
true parameters based on the variance-covariance matrix of the given initial
parameter estimates. If matrix inversion of the variance-covariance matrix
is infeasible, a variation of the method in Wang et al. (2010) is used.
</p>


<h3>Value</h3>

<p>Data frame whose first column represents the grid on the upper asymptote
parameter and second column represents the grid o the lower asymptote.
</p>


<h3>Author(s)</h3>

<p>Hyowon An
</p>


<h3>References</h3>

<p>Wang Y, Jadhav A, Southal N, Huang R, Nguyen DT (2010).
&ldquo;A grid algorithm for high throughput fitting of dose-response curve data.&rdquo;
<em>Curr Chem Genomics</em>, <b>4</b>, 57&ndash;66.
</p>


<h3>See Also</h3>

<p><code>FindHillBounds</code>, <code>FindInitialParms</code>
</p>

<hr>
<h2 id='gof'>Perform the goodness-of-fit (gof) test for a model.</h2><span id='topic+gof'></span>

<h3>Description</h3>

<p>S3 method for a model object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof_+3A_object">object</code></td>
<td>
<p>A model object</p>
</td></tr>
<tr><td><code id="gof_+3A_...">...</code></td>
<td>
<p>dots for future extensions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with goodness-of-fit results
</p>

<hr>
<h2 id='gof-dr4pl'>Perform the goodness-of-fit (gof) test for the 4PL model.</h2><span id='topic+gof-dr4pl'></span><span id='topic+gof.dr4pl'></span>

<h3>Description</h3>

<p>Perform the goodness-of-fit (gof) test for the 4PL model when there
are at least two replicates for each dose level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dr4pl'
gof(object, n.signif.digit = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof-dr4pl_+3A_object">object</code></td>
<td>
<p>An object of the dr4pl class.</p>
</td></tr>
<tr><td><code id="gof-dr4pl_+3A_n.signif.digit">n.signif.digit</code></td>
<td>
<p>Number of significant digits after the decimal point to be
printed. The default value is 4, but users can change the value on their own.</p>
</td></tr>
<tr><td><code id="gof-dr4pl_+3A_...">...</code></td>
<td>
<p>dots for future extensions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Perform a goodness-of-fit (gof) test for the goodness of the 4PL models
for dose-response data. There should be at least two replicates at each dose
level. The test statistic follows the F distribution with degress of freedom
(n - 4) and (N - n) where N stands for the total number of observations and n
stands for the number of dose levels. For detailed explanation of the method,
please refer to Subsection 2.1.5 of Seber and Wild (1989).
</p>


<h3>Value</h3>

<p>A list of results in the order of a F-statistic value, p-value and a
degree of freedom.
</p>


<h3>References</h3>

<p>Seber GAF, Wild CJ (1989).
<em>Nonlinear regression</em>,  Wiley Series in Probability and Mathematical Statistics: Probability and Mathematical Statistics.
John Wiley \&amp; Sons, Inc., New York.
ISBN 0-471-61760-1, doi: <a href="https://doi.org/10.1002/0471725315">10.1002/0471725315</a>, <a href="http://dx.doi.org.libproxy.lib.unc.edu/10.1002/0471725315">http://dx.doi.org.libproxy.lib.unc.edu/10.1002/0471725315</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obj.dr4pl &lt;- dr4pl(Response ~ Dose, data = sample_data_4)  # Fit a 4PL model to data
gof(obj.dr4pl)  # Print the goodness-of-fit test results

</code></pre>

<hr>
<h2 id='IC'>Obtain Inhibitory Concentrations (IC) of a dose-response curve</h2><span id='topic+IC'></span>

<h3>Description</h3>

<p>This function obtains estimates of the IC's of a dose-response
curve. Typically the IC50 parameter is of interest, but sometimes IC10 or IC90
are important aspects of a dose-response curve. By controlling the function
argument, a user can obtain the IC's at various levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IC(object, inhib.percent)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IC_+3A_object">object</code></td>
<td>
<p>Object of the class 'dr4pl' for which the IC values are obtained</p>
</td></tr>
<tr><td><code id="IC_+3A_inhib.percent">inhib.percent</code></td>
<td>
<p>Inhibited percentages at which thc IC values are obtained</p>
</td></tr>
</table>


<h3>Value</h3>

<p>IC values at the inhibited percentages provided by the argument
<code>inhib.percent</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data.test &lt;- data.frame(x = c(0.0001, 0.001, 0.01, 0.1, 1),
                        y = c(10, 9, 5, 1, 0))
obj.dr4pl &lt;- dr4pl(y ~ x,
                   data = data.test)
IC(obj.dr4pl, inhib.percent = c(10, 90))

obj.dr4pl &lt;- dr4pl(Response ~ Dose, data = sample_data_4)  # Fit a 4PL model to data
IC(obj.dr4pl, inhib.percent = c(10, 50, 90))

</code></pre>

<hr>
<h2 id='MeanResponse'>Compute an estimated mean response.</h2><span id='topic+MeanResponse'></span><span id='topic+MeanResponse.dr4pl'></span><span id='topic+MeanResponse.numeric'></span><span id='topic+MeanResponse.dr4pl_theta'></span><span id='topic+MeanResponse.dr4pl_log10'></span>

<h3>Description</h3>

<p>Compute an estimated mean response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MeanResponse(...)

## S3 method for class 'dr4pl'
MeanResponse(dr4pl, theta = NULL, ...)

## S3 method for class 'numeric'
MeanResponse(theta, x, ...)

## S3 method for class 'dr4pl_theta'
MeanResponse(theta, x, ...)

## S3 method for class 'dr4pl_log10'
MeanResponse(theta, x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MeanResponse_+3A_...">...</code></td>
<td>
<p>arguments to be passed to S3 methods</p>
</td></tr>
<tr><td><code id="MeanResponse_+3A_dr4pl">dr4pl</code></td>
<td>
<p>dr4pl object</p>
</td></tr>
<tr><td><code id="MeanResponse_+3A_theta">theta</code></td>
<td>
<p>Parameters of the dr4pl object. Usually made with [dr4pl_theta]</p>
</td></tr>
<tr><td><code id="MeanResponse_+3A_x">x</code></td>
<td>
<p>domain values for 4PL model. Values
should always be passed to this function on the
linear space.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Predicted response values.
</p>

<hr>
<h2 id='OutlierDetection'>Detect outliers by the method of Motulsky and Brown (2006).</h2><span id='topic+OutlierDetection'></span>

<h3>Description</h3>

<p>Detect outliers by the method of Motulsky and Brown (2006).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OutlierDetection(residuals)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OutlierDetection_+3A_residuals">residuals</code></td>
<td>
<p>Vector of residuals from a robust fit.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function detects outliers from a vector of residuals obtained from
a robust fit. The method used here is the same with Motulsky and Brown (2006)
except that the median absolute deviation is used instead of the sample quantile
based estimator suggested in that paper. Based on the False Discovery Rate (FDR)
a set of multiple outliers that have lower FDR's than a threshold are reported.
</p>


<h3>Value</h3>

<p>Vector of indices of outliers in the input vector of residuals
</p>


<h3>Author(s)</h3>

<p>Hyowon An
</p>


<h3>References</h3>

<p>Motulsky HJ, Brown RE (2006).
&ldquo;Detecting outliers when fitting data with nonlinear regression - a new method based on robust nonlinear regression and the false discovery rate.&rdquo;
<em>BMC Bioinformatics</em>, <b>7</b>, 123.
</p>

<hr>
<h2 id='plot.dr4pl'>Make a plot of a 4PL model curve and data</h2><span id='topic+plot.dr4pl'></span>

<h3>Description</h3>

<p>This function displays a dose-response curve and data. As a default,
the x-axis represents dose levels in log 10 scale and the y-axis represents
responses. The black solid line represents a dose-response curve. The blue filled
circles represent data points and red triangles represent outliers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dr4pl'
plot(
  x,
  type.curve = "all",
  text.title = "Dose-response plot",
  text.x = "Dose",
  text.y = "Response",
  indices.outlier = NULL,
  breaks.x = NULL,
  breaks.y = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.dr4pl_+3A_x">x</code></td>
<td>
<p>&lsquo;dr4pl&rsquo; object whose data and mean response function will be plotted.</p>
</td></tr>
<tr><td><code id="plot.dr4pl_+3A_type.curve">type.curve</code></td>
<td>
<p>Indicator of the type of a dose-response curve. &quot;all&quot; indicates
that data and a curve will be plotted while &quot;data&quot; indicates that only data
will be plotted.</p>
</td></tr>
<tr><td><code id="plot.dr4pl_+3A_text.title">text.title</code></td>
<td>
<p>Character string for the title of a plot with a default set to
&quot;Dose response plot&quot;.</p>
</td></tr>
<tr><td><code id="plot.dr4pl_+3A_text.x">text.x</code></td>
<td>
<p>Character string for the x-axis of the plot with a default set to
&quot;Dose&quot;.</p>
</td></tr>
<tr><td><code id="plot.dr4pl_+3A_text.y">text.y</code></td>
<td>
<p>Character string for the y-axis of the plot with a default set to
&quot;Response&quot;.</p>
</td></tr>
<tr><td><code id="plot.dr4pl_+3A_indices.outlier">indices.outlier</code></td>
<td>
<p>Pass a vector indicating all indices which are outliers in
the data.</p>
</td></tr>
<tr><td><code id="plot.dr4pl_+3A_breaks.x">breaks.x</code></td>
<td>
<p>Vector of desired break points for the x-axis</p>
</td></tr>
<tr><td><code id="plot.dr4pl_+3A_breaks.y">breaks.y</code></td>
<td>
<p>Vector of desired break points for the y-axis</p>
</td></tr>
<tr><td><code id="plot.dr4pl_+3A_...">...</code></td>
<td>
<p>All arguments that can normally be passed to ggplot.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hyowon An, <a href="mailto:ahwbest@gmail.com">ahwbest@gmail.com</a>
</p>
<p>Justin T. Landis, <a href="mailto:jtlandis314@gmail.com">jtlandis314@gmail.com</a>
</p>
<p>Aubrey G. Bailey, <a href="mailto:aubreybailey@gmail.com">aubreybailey@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dr4pl.1 &lt;- dr4pl(Response ~ Dose, data = sample_data_1)

plot(dr4pl.1)

## Able to further edit plots.
library(ggplot2) #needed to change color to green
dr4pl.1 &lt;- dr4pl(Response ~ Dose,
                        data = sample_data_1,
                        text.title = "Sample Data Plot")

a &lt;- plot(dr4pl.1)
a + geom_point(color = "green", size = 5)

## Bring attention to outliers using parameter indices.outlier.
dr4pl.3 &lt;- dr4pl(Response ~ Dose,
                 data = drc_error_3,
                 method.init = "Mead",
                 method.robust = "absolute")
plot(dr4pl.3, indices.outlier = c(90, 101))

## Change the plot title default with parameter text.title.
dr4pl.1 &lt;- dr4pl::dr4pl(Response ~ Dose,
                        data = sample_data_1)
plot(dr4pl.1, text.title = "My New Dose Response plot")

##Change the labels of the x and y axis to your need
library(drc)  # Needed to load 'decontaminants' data set
data.hpc &lt;- subset(decontaminants, group %in% "hpc")
dr4pl.hpc &lt;- dr4pl(count~conc, data = data.hpc)
plot(dr4pl.hpc,
     text.title = "hpc Decontaminants Plot",
     text.x = "Concentration",
     text.y = "Count")

## End(Not run)

</code></pre>

<hr>
<h2 id='print.dr4pl'>Print the dr4pl object to screen.</h2><span id='topic+print.dr4pl'></span>

<h3>Description</h3>

<p>Print the dr4pl object to screen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dr4pl'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.dr4pl_+3A_x">x</code></td>
<td>
<p>a dr4pl object to be printed</p>
</td></tr>
<tr><td><code id="print.dr4pl_+3A_...">...</code></td>
<td>
<p>all normally printable arguments</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>ryegrass.dr4pl &lt;- dr4pl(Response ~ Dose,
                        data = sample_data_1)
print(ryegrass.dr4pl)

obj.dr4pl &lt;- dr4pl(Response ~ Dose, data = sample_data_5)
print(obj.dr4pl)
</code></pre>

<hr>
<h2 id='print.summary.dr4pl'>Print the dr4pl object summary to screen.</h2><span id='topic+print.summary.dr4pl'></span>

<h3>Description</h3>

<p>Print the dr4pl object summary to screen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.dr4pl'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.dr4pl_+3A_x">x</code></td>
<td>
<p>a dr4pl object to be summarized</p>
</td></tr>
<tr><td><code id="print.summary.dr4pl_+3A_...">...</code></td>
<td>
<p>all normally printable arguments</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(drc)  # Needed for the data set 'ryegras'
dr4pl.ryegrass &lt;- dr4pl(rootl ~ conc, data = ryegrass)
print(summary(dr4pl.ryegrass))

dr4pl.7 &lt;- dr4pl(Response ~ Dose, data = sample_data_7)
print(summary(dr4pl.7))
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+augment'></span><span id='topic+calculate'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>generics</dt><dd><p><code><a href="generics.html#topic+augment">augment</a></code>, <code><a href="generics.html#topic+calculate">calculate</a></code></p>
</dd>
</dl>

<hr>
<h2 id='residuals.dr4pl'>Compute dr4pl residuals.</h2><span id='topic+residuals.dr4pl'></span><span id='topic+residuals.dr4pl_param'></span>

<h3>Description</h3>

<p>Compute dr4pl residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dr4pl'
residuals(object, parm = NULL, ...)

## S3 method for class 'dr4pl_param'
residuals(object, dose, response, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.dr4pl_+3A_object">object</code></td>
<td>
<p>A dr4pl or dr4pl_param object.</p>
</td></tr>
<tr><td><code id="residuals.dr4pl_+3A_parm">parm</code></td>
<td>
<p>parameters of the dr4pl object. Usually made with [dr4pl_theta]</p>
</td></tr>
<tr><td><code id="residuals.dr4pl_+3A_...">...</code></td>
<td>
<p>dots for future extensions</p>
</td></tr>
<tr><td><code id="residuals.dr4pl_+3A_dose">dose</code></td>
<td>
<p>Dose values</p>
</td></tr>
<tr><td><code id="residuals.dr4pl_+3A_response">response</code></td>
<td>
<p>Response values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of residuals.
</p>

<hr>
<h2 id='sample_data_1'>sample_data_1</h2><span id='topic+sample_data_1'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_1)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_10'>sample_data_10</h2><span id='topic+sample_data_10'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_10)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_11'>sample_data_11</h2><span id='topic+sample_data_11'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_11)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_12'>sample_data_12</h2><span id='topic+sample_data_12'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_12)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_13'>sample_data_13</h2><span id='topic+sample_data_13'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_13)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_2'>sample_data_2</h2><span id='topic+sample_data_2'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_2)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_3'>sample_data_3</h2><span id='topic+sample_data_3'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_3)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_4'>sample_data_4</h2><span id='topic+sample_data_4'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_4)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_5'>sample_data_5</h2><span id='topic+sample_data_5'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_5)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_6'>sample_data_6</h2><span id='topic+sample_data_6'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_6)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_7'>sample_data_7</h2><span id='topic+sample_data_7'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_7)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_8'>sample_data_8</h2><span id='topic+sample_data_8'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_8)
  plot(a)
</code></pre>

<hr>
<h2 id='sample_data_9'>sample_data_9</h2><span id='topic+sample_data_9'></span>

<h3>Description</h3>

<p>These are a handful of experimentally derived datasets from the wet-laboratory.
These may or may not have numerical errors in other dose-response curve-packages, but definitly not using these methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  a &lt;- dr4pl(Response~Dose, data = sample_data_9)
  plot(a)
</code></pre>

<hr>
<h2 id='summary.dr4pl'>summary</h2><span id='topic+summary.dr4pl'></span>

<h3>Description</h3>

<p>Print the summary of a dr4pl object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dr4pl'
summary(object, parm = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.dr4pl_+3A_object">object</code></td>
<td>
<p>a dr4pl object to be summarized</p>
</td></tr>
<tr><td><code id="summary.dr4pl_+3A_parm">parm</code></td>
<td>
<p>parameters of the dr4pl object. Usually made with [dr4pl_theta]</p>
</td></tr>
<tr><td><code id="summary.dr4pl_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to [calculate.dr4pl]</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>obj.dr4pl &lt;- dr4pl(Response ~ Dose, data = sample_data_5)  # Fit a 4PL model to data
summary(obj.dr4pl)

obj.dr4pl &lt;- dr4pl(Response ~ Dose, data = sample_data_6)  # Fit a 4PL model to data
summary(obj.dr4pl)

</code></pre>

<hr>
<h2 id='vcov.dr4pl'>Obtain the variance-covariance matrix of the parameter estimators of a
4PL model.</h2><span id='topic+vcov.dr4pl'></span><span id='topic+vcov.dr4pl_param'></span>

<h3>Description</h3>

<p>This function obtains the variance-covariance matrix of the parameter
estimators of a 4PL model. The variance-covariance matrix returned by this
function can be used to compute the standard errors and confidence intervals
for statistical inference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dr4pl'
vcov(object, parm = NULL, use.Hessian = T, ...)

## S3 method for class 'dr4pl_param'
vcov(object, dose, response, use.Hessian = T, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.dr4pl_+3A_object">object</code></td>
<td>
<p>An object of the dr4pl class.</p>
</td></tr>
<tr><td><code id="vcov.dr4pl_+3A_parm">parm</code></td>
<td>
<p>parameters of the dr4pl object. Usually made with [dr4pl_theta].
The class of this object determines in which space the covariance is 
calculated for theta_2.</p>
</td></tr>
<tr><td><code id="vcov.dr4pl_+3A_use.hessian">use.Hessian</code></td>
<td>
<p>logical, if set to TRUE, the default, then
the Hessian matrix scaled by 1/2 is used as an approximation
to C.hat. Otherwise the First order Jacobian is used instead.</p>
</td></tr>
<tr><td><code id="vcov.dr4pl_+3A_...">...</code></td>
<td>
<p>dots for future extensions</p>
</td></tr>
<tr><td><code id="vcov.dr4pl_+3A_dose">dose</code></td>
<td>
<p>dose levels</p>
</td></tr>
<tr><td><code id="vcov.dr4pl_+3A_response">response</code></td>
<td>
<p>response values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function obtains the variance-covariance matrix of the parameter
estimators of a 4PL model. The Hessian matrix is used to obtain the second order
approximation to the sum-of-squares loss function, and then the standard errors
are computed as the square roots of the half of the Hessian matrix. Please refer
to Subsection 5.2.2 of Seber and Wild (1989).
</p>


<h3>Value</h3>

<p>The variance-covariance matrix of the parameter estimators of a 4PL
model whose columns are in the order of the upper asymptote, IC50, slope and lower
asymptote from left to right and whose rows are in the same order.
</p>
<p>a covariance matrix. If the 'parm' argument is of the class 'dr4pl_log10', then the
covariance of row/column 2 represents log10(theta_2). If theta is of 'dr4pl_theta',
then the covariance of row/column 2 represents theta_2 in linear space.
</p>


<h3>References</h3>

<p>Seber GAF, Wild CJ (1989).
<em>Nonlinear regression</em>,  Wiley Series in Probability and Mathematical Statistics: Probability and Mathematical Statistics.
John Wiley \&amp; Sons, Inc., New York.
ISBN 0-471-61760-1, doi: <a href="https://doi.org/10.1002/0471725315">10.1002/0471725315</a>, <a href="http://dx.doi.org.libproxy.lib.unc.edu/10.1002/0471725315">http://dx.doi.org.libproxy.lib.unc.edu/10.1002/0471725315</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obj.dr4pl &lt;- dr4pl(Response ~ Dose, data = sample_data_1)  # Fit a 4PL model to data
vcov(obj.dr4pl)  # Variance-covariance matrix of the parameters

obj.dr4pl &lt;- dr4pl(Response ~ Dose, data = sample_data_2)  # Fit a 4PL model to data
vcov(obj.dr4pl)  # Variance-covariance matrix of the parameters

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
