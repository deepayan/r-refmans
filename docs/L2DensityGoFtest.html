<!DOCTYPE html><html lang="en"><head><title>Help for package L2DensityGoFtest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {L2DensityGoFtest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cutoff.asymptotic'><p>Asymptoticaly normal critical value for the goodness-of-fit test statistic <code class="reqn">\hat{S}_n(h)</code> of Bagkavos, Patil and Wood (2021)</p></a></li>
<li><a href='#cutoff.bootstrap'><p>Bootstrap critical value for the goodness-of-fit test statistic <code class="reqn">\hat{S}_n(h)</code> of Bagkavos, Patil and Wood (2021)</p></a></li>
<li><a href='#cutoff.edgeworth'><p>Critical value based on Edgeworth expansion of the size function for the density goodness-of-fit test <code class="reqn">\hat{S}_n(h)</code> of Bagkavos, Patil and Wood (2021)</p></a></li>
<li><a href='#hopt.be'><p>Power-optimal bandwidth for the test statistic <code class="reqn">\hat{S}_n(h)</code></p></a></li>
<li><a href='#hopt.edgeworth'><p>Power-optimal bandwidth for the density goodness-of-fit test <code>S.n</code>.</p></a></li>
<li><a href='#kde'><p>Kernel Density Estimation</p></a></li>
<li><a href='#Kernels'><p>Kernel functions</p></a></li>
<li><a href='#NDistDens'><p>Select null distribution</p></a></li>
<li><a href='#S.n'><p>Density goodness-of-fit test statistic based on discretized L2 distance</p></a></li>
<li><a href='#S.n.Boot'><p>Goodness-of-Fit test statistic based on discretized L2 distance</p></a></li>
<li><a href='#S.nd'><p>Density goodness-of-fit test statistic based on discretized L2 distance</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Density Goodness-of-Fit Test</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Dimitrios Bagkavos [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for the implementation of a density goodness-of-fit test, based on piecewise approximation of the L2 distance.</td>
</tr>
<tr>
<td>Imports:</td>
<td>fGarch, nor1mix, boot, mvtnorm</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-27 19:00:45 UTC; Dimitris</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-27 19:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cutoff.asymptotic'>Asymptoticaly normal critical value for the goodness-of-fit test statistic <code class="reqn">\hat{S}_n(h)</code> of Bagkavos, Patil and Wood (2021)</h2><span id='topic+cutoff.asymptotic'></span>

<h3>Description</h3>

<p>Implements an asymptoticaly normal critical value for testing the goodness-of-fit of a parametrically estimated density with the test statistic <code><a href="#topic+S.n">S.n</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cutoff.asymptotic(dist,  p1, p2, sig.lev)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cutoff.asymptotic_+3A_dist">dist</code></td>
<td>
<p>The null distribution.</p>
</td></tr>
<tr><td><code id="cutoff.asymptotic_+3A_p1">p1</code></td>
<td>
<p>Parameter 1 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="cutoff.asymptotic_+3A_p2">p2</code></td>
<td>
<p>Parameter 2 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="cutoff.asymptotic_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level of the hypothesis test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the asymptotic critical value defined in Remark 1, Bagkavos, Patil and Wood (2021), equal to  <code class="reqn"> z_\alpha \sigma_{0, \theta_0} </code> where <code class="reqn">z_\alpha</code> is the <code class="reqn">1-\alpha</code> quantile of the normal distribution and
</p>
<p style="text-align: center;"><code class="reqn"> \sigma_{0, \theta_0}^2 = 2 \left (\int K^2(u)\,du \right ) \left (\int f^2_0(x; \theta_0)\,dx \right ).  </code>
</p>



<h3>Value</h3>

<p>A scalar, the estimate of the asymptotic critical value at the given significance level.
</p>


<h3>Author(s)</h3>

<p>Dimitrios Bagkavos
</p>
<p>R implementation and documentation: Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;
</p>


<h3>References</h3>

<p>Bagkavos, Patil and Wood: Nonparametric goodness-of-fit testing for a continuous multivariate parametric model, (2021), under review.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cutoff.edgeworth">cutoff.edgeworth</a>, <a href="#topic+cutoff.bootstrap">cutoff.bootstrap</a> </code>
</p>

<hr>
<h2 id='cutoff.bootstrap'>Bootstrap critical value for the goodness-of-fit test statistic <code class="reqn">\hat{S}_n(h)</code> of Bagkavos, Patil and Wood (2021)</h2><span id='topic+cutoff.bootstrap'></span>

<h3>Description</h3>

<p>Implements a bootstrap critical value for testing the goodness-of-fit of a parametrically estimated density with the test statistic <code>S.n</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cutoff.bootstrap(xin, M,  sim, dist, h.use, kfun, p1, p2, sig.lev)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cutoff.bootstrap_+3A_xin">xin</code></td>
<td>
<p> A vector of data points - the available sample.</p>
</td></tr>
<tr><td><code id="cutoff.bootstrap_+3A_m">M</code></td>
<td>
<p>Number of bootstrap replications.</p>
</td></tr>
<tr><td><code id="cutoff.bootstrap_+3A_sim">sim</code></td>
<td>
<p>A character string indicating the type of simulation required: &quot;ordinary&quot; (the default), &quot;parametric&quot;, &quot;balanced&quot;, &quot;permutation&quot;, or &quot;antithetic&quot;.</p>
</td></tr>
<tr><td><code id="cutoff.bootstrap_+3A_dist">dist</code></td>
<td>
<p>The null distribution.</p>
</td></tr>
<tr><td><code id="cutoff.bootstrap_+3A_h.use">h.use</code></td>
<td>
<p>The test statistic bandwidth, best implemented with <code><a href="#topic+hopt.be">hopt.be</a></code>.</p>
</td></tr>
<tr><td><code id="cutoff.bootstrap_+3A_kfun">kfun</code></td>
<td>
<p>The kernel to use in the density estimates used in the bandwidth expression.</p>
</td></tr>
<tr><td><code id="cutoff.bootstrap_+3A_p1">p1</code></td>
<td>
<p>Parameter 1 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="cutoff.bootstrap_+3A_p2">p2</code></td>
<td>
<p>Parameter 2 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="cutoff.bootstrap_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level of the hypothesis test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the bootstrap based finite sample critical value defined in Section 2.6, Bagkavos, Patil and Wood (2021), and calculated as follows:
</p>
<p>1.  Resample the observations <code class="reqn">\mathcal{X}=\{X_1, \dots, X_n\}</code> to obtain <code class="reqn">M</code> bootstrap samples, denoted by <code class="reqn">\mathcal{X}_m^\ast=\{ X_{1m}^\ast, \dots, X_{nm}^\ast\}</code>,  where for each <code class="reqn">m=1,\ldots , M</code>, <code class="reqn">\mathcal{X}_m^\ast</code> is sampled randomly, with replacement, from <code class="reqn">\mathcal{X}</code>.  Write <code class="reqn">\hat{\theta}=\theta(\mathcal{X})</code> for the estimator of <code class="reqn">\theta</code> based on the original sample <code class="reqn">\mathcal{X}</code> and, for each <code class="reqn">m</code>, define the bootstrap estimator of <code class="reqn">\theta</code> by <code class="reqn">\hat{\theta}_m^\ast = \theta(\mathcal{X}_m^\ast)</code>, where <code class="reqn">\theta(\cdot)</code> is the relevant functional for the parameter <code class="reqn">\theta</code>.
</p>
<p>2. For <code class="reqn">m=1, \ldots , M</code>, use <code class="reqn">\mathcal{X}_m^\ast =\{X_{1m}^\ast, \dots, X_{nm}^\ast\}</code> and <code class="reqn">\hat \theta_m^\ast</code>  from the previous step to calculate   <code class="reqn">n \Delta^{2d} h^{-d/2} \hat S_{n,m}^\ast(h\rho)</code>,<code class="reqn">m=1, \dots, M</code>.
</p>
<p>3. Calculate   <code class="reqn">\ell_\alpha^\ast</code>  as the <code class="reqn">1-\alpha</code> empirical quantile of the values <code class="reqn">n \Delta^{2d} h^{-d/2} \hat S_{n,m}^\ast(h\rho)</code>, <code class="reqn">m=1, \dots, M</code>. Then <code class="reqn">\ell_\alpha^\ast</code>   approximately   satisfies <code class="reqn">P^\ast [ n  \Delta^{2d} h^{-d/2}\hat S_{n,m}^\ast(h\rho)&gt; \ell_\alpha^\ast ]=1-\alpha</code>, where <code class="reqn">P^\ast</code> indicates the bootstrap probability measure conditional on <code class="reqn">\mathcal{X}</code>.
</p>


<h3>Value</h3>

<p>A scalar, the estimate of the bootstrap critical value at the given significance level.
</p>


<h3>Author(s)</h3>

<p>Dimitrios Bagkavos
</p>
<p>R implementation and documentation: Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;
</p>


<h3>References</h3>

<p>Bagkavos, Patil and Wood: Nonparametric goodness-of-fit testing for a continuous multivariate parametric model, (2021), under review.
</p>
<p><a href="https://amstat.tandfonline.com/doi/abs/10.1198/016214508000000968#.XnfOq-ozbCM">Gao and Gijbels, Bandwidth selection in nonparametric kernel testing, pp. 1584-1594, JASA (2008)</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cutoff.asymptotic">cutoff.asymptotic</a>, <a href="#topic+cutoff.edgeworth">cutoff.edgeworth</a> </code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(nor1mix)
library(boot)
SampleSize&lt;-80
M&lt;-1000
dist&lt;- "normixt"
kfun&lt;- Epanechnikov
p1 &lt;-MW.nm2
p2 &lt;-1
sig.lev &lt;- 0.05

sim&lt;-"ordinary"
## Not run: 
#Run the following to compare the asymptotic and bootstrap cut-off points on 4 occasions:
for(i in 15:18)
  {
    set.seed(i)
    xin&lt;-rnorMix(SampleSize, p1)
    h.use &lt;- hopt.be(xin)
    l.a.a&lt;-cutoff.asymptotic( dist,   p1, p2, sig.lev )
    l.a.b&lt;- cutoff.bootstrap(xin,  M,  sim, dist, h.use,  kfun, p1, p2, sig.lev)
    #print the result of each iteration:
    cat("Asympt. cut.off= ", l.a.a, "Boot. cut.off= ", l.a.b,  "\n")
   }

## End(Not run)
</code></pre>

<hr>
<h2 id='cutoff.edgeworth'>Critical value based on Edgeworth expansion of the size function for the density goodness-of-fit test <code class="reqn">\hat{S}_n(h)</code> of Bagkavos, Patil and Wood (2021)</h2><span id='topic+cutoff.edgeworth'></span>

<h3>Description</h3>

<p>Implements the critical value for the density goodness-of-fit test <code><a href="#topic+S.n">S.n</a></code>, approximating via an Edgeworth expansion the size function of the test statistic <code><a href="#topic+S.n">S.n</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cutoff.edgeworth(xin, dist, kfun, p1, p2, sig.lev)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cutoff.edgeworth_+3A_xin">xin</code></td>
<td>
<p> A vector of data points - the available sample.</p>
</td></tr>
<tr><td><code id="cutoff.edgeworth_+3A_dist">dist</code></td>
<td>
<p>The null distribution.</p>
</td></tr>
<tr><td><code id="cutoff.edgeworth_+3A_kfun">kfun</code></td>
<td>
<p>The kernel to use in the density estimates used in the bandwidth expression.</p>
</td></tr>
<tr><td><code id="cutoff.edgeworth_+3A_p1">p1</code></td>
<td>
<p>Parameter 1 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="cutoff.edgeworth_+3A_p2">p2</code></td>
<td>
<p>Parameter 2 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="cutoff.edgeworth_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level of the hypothesis test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the critical value for the density goodness-of-fit test <code><a href="#topic+S.n">S.n</a></code>, approximating via an Edgeworth expansion the size function of the test statistic <code><a href="#topic+S.n">S.n</a></code>, given by
</p>
<p style="text-align: center;"><code class="reqn"> l_\alpha = z_\alpha + d_0 \sqrt{h} + d_2(n \sqrt{h})^{-1} </code>
</p>

<p>where <code class="reqn">z_\alpha</code> is the <code class="reqn">1-\alpha</code> quantile of the normal distribution and
<code class="reqn">d_0 = d_1 - C_{ H_0}</code> and </p>
<p style="text-align: center;"><code class="reqn">d_j = (z_\alpha^2 - 1)c_j, j=1,2</code>
</p>
<p> with
</p>
<p style="text-align: center;"><code class="reqn">
c_1 = \frac{4K^{(3)}(0)\mu_2^3 \nu_3}{3\sigma^3}, \;  c_2 = \frac{\mu_3^2K^2(0)}{\sigma^3}, \; \mu_i =\int K^i(x)\,dx, i=1,\dots.
</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">
C_{H_0}   = 2\left (E f_0'( \theta_0) \right )^2 \Delta^{-1}, \; \nu_i   =  E \left \{f^{i}(x)\right \} = \int f^{i+1}(x)\,dx, i=1,\dots
</code>
</p>

<p>This critical value is the density function equivalent to the critical value estimate obtained in the closely relatated regression setting in Gao and Gijbels (2008) and is suitable for finite sample implementations of the test.
</p>


<h3>Value</h3>

<p>A scalar, the estimate of the critical value at the given significance level.
</p>


<h3>Author(s)</h3>

<p>Dimitrios Bagkavos
</p>
<p>R implementation and documentation: Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;
</p>


<h3>References</h3>

<p><a href="https://amstat.tandfonline.com/doi/abs/10.1198/016214508000000968#.XnfOq-ozbCM">Gao and Gijbels, Bandwidth selection in nonparametric kernel testing, pp. 1584-1594, JASA (2008)</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cutoff.asymptotic">cutoff.asymptotic</a>, <a href="#topic+cutoff.bootstrap">cutoff.bootstrap</a> </code>
</p>

<hr>
<h2 id='hopt.be'>Power-optimal bandwidth for the test statistic <code class="reqn">\hat{S}_n(h)</code></h2><span id='topic+hopt.be'></span>

<h3>Description</h3>

<p>Implements an optimal, with respect to Berry-Esseen bound, bandwidth for the density goodness-of-fit test <code class="reqn">\hat{S}_n(h)</code> of Bagkavos, Patil and Wood (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hopt.be(xin)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hopt.be_+3A_xin">xin</code></td>
<td>
<p> A vector of data points - the available sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the  Berry-Esseen bound optimal bandwidth  defined in (18), Bagkavos, Patil and Wood (2022), given by
</p>
<p style="text-align: center;"><code class="reqn"> h =   n^{-1/2} \sqrt{\frac{\hat \nu_p R_4(K)}{\rho_\ast^2 \hat \nu_4 I_0(K)} },   </code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">  \hat \nu_p = n^{-1} \sum_{j=1}^n \hat f(X_j; \hat h_a),  </code>
</p>

<p>and <code class="reqn">\hat h_a</code> is the density optimal bandwidth calculated by a reference to a prametric distribution, <code class="reqn">\rho_\star=1</code> and
</p>
<p style="text-align: center;"><code class="reqn">   R_4(K)=\int K^4(x)\,dx.</code>
</p>



<h3>Value</h3>

<p>The estimate of the Berry-Esseen optimal bandwidth.
</p>


<h3>Author(s)</h3>

<p>Dimitrios Bagkavos
</p>
<p>R implementation and documentation: Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;
</p>


<h3>References</h3>

<p>Bagkavos, Patil and Wood: Nonparametric goodness-of-fit testing for a continuous multivariate parametric model, (2021), under review.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hopt.edgeworth">hopt.edgeworth</a>  </code>
</p>

<hr>
<h2 id='hopt.edgeworth'>Power-optimal bandwidth for the density goodness-of-fit test <code><a href="#topic+S.n">S.n</a></code>.</h2><span id='topic+hopt.edgeworth'></span>

<h3>Description</h3>

<p>Implements the power-optimal bandwidth for density goodness-of-fit test <code><a href="#topic+S.n">S.n</a></code> based on optimization of the test statistic's power function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hopt.edgeworth(xin, dist, kfun, p1, p2, sig.lev)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hopt.edgeworth_+3A_xin">xin</code></td>
<td>
<p> A vector of data points - the available sample.</p>
</td></tr>
<tr><td><code id="hopt.edgeworth_+3A_dist">dist</code></td>
<td>
<p>The null distribution.</p>
</td></tr>
<tr><td><code id="hopt.edgeworth_+3A_kfun">kfun</code></td>
<td>
<p>The kernel to use in the density estimates used in the bandwidth expression.</p>
</td></tr>
<tr><td><code id="hopt.edgeworth_+3A_p1">p1</code></td>
<td>
<p>Parameter 1 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="hopt.edgeworth_+3A_p2">p2</code></td>
<td>
<p>Parameter 2 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="hopt.edgeworth_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level of the hypothesis test.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements: the power-optimal bandwidth for the test statistic <code><a href="#topic+S.n">S.n</a></code> given by
</p>
<p style="text-align: center;"><code class="reqn"> h = \left \{ \frac{\sqrt{2} K^{(3)}(0)}{3R(K)^{3/2}} \frac{\nu_2}{R(f)^{3/2}}\right \}^{-1/2} \left  \{ \frac{n \int \Delta_n^2 (x) f^2(x)\,dx}{\sigma^2 \{ 2 \nu_2 R(K)\}^{1/2}} \right \}^{-3/2}.</code>
</p>

<p>This bandwidth rule is the density function equivalent bandwidth rule obtained in the closely relatated regression setting in Gao and Gijbels (2008) and is designed to optimize the test's power subject to keeping the size contant.
</p>


<h3>Value</h3>

<p>A scalar, the estimate the power-optimal bandwidth.
</p>


<h3>Author(s)</h3>

<p>Dimitrios Bagkavos
</p>
<p>R implementation and documentation: Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;
</p>


<h3>References</h3>

<p><a href="https://amstat.tandfonline.com/doi/abs/10.1198/016214508000000968#.XnfOq-ozbCM">Gao and Gijbels, Bandwidth selection in nonparametric kernel testing, pp. 1584-1594, JASA (2008)</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hopt.be">hopt.be</a>  </code>
</p>

<hr>
<h2 id='kde'>Kernel Density Estimation</h2><span id='topic+kde'></span>

<h3>Description</h3>

<p>Implements the (classical) kernel density estimator, see (2.2a) in  Silverman (1986).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kde(xin, xout, h, kfun)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kde_+3A_xin">xin</code></td>
<td>
<p>A vector of data points.  Missing values not allowed.</p>
</td></tr>
<tr><td><code id="kde_+3A_xout">xout</code></td>
<td>
<p>A vector of grid points at which the estimate will be calculated. </p>
</td></tr>
<tr><td><code id="kde_+3A_h">h</code></td>
<td>
<p>A scalar, the bandwidth to use in the estimate, e.g. <code>bw.nrd(xin)</code></p>
</td></tr>
<tr><td><code id="kde_+3A_kfun">kfun</code></td>
<td>
<p>Kernel function to use. Supported kernels:  <code><a href="#topic+Epanechnikov">Epanechnikov</a></code>,  <code><a href="#topic+Biweight">Biweight</a></code>,  <code><a href="#topic+Gaussian">Gaussian</a></code>,  <code><a href="#topic+Rectangular">Rectangular</a></code>,  <code><a href="#topic+Triangular">Triangular</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The classical kernel density estimator is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat f(x;h) = n^{-1}\sum_{i=1}^n  K_h(x-X_{i})</code>
</p>

<p><code class="reqn">h</code> is determined by  a bandwidth selector such as Silverman's default plug-in rule.
</p>


<h3>Value</h3>

<p>A vector with the density estimates at the designated points xout.
</p>


<h3>Author(s)</h3>

<p>R implementation and documentation: Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;
</p>


<h3>References</h3>

<p>Silverman (1986), Density Estimation for Statistics and Data Analysis, Chapman and Hall, London.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-seq(-5, 5,length=100)          #design points where the estimate will be calculated
plot(x, dnorm(x),  type="l", xlab = "x", ylab="density") #plot true density function
SampleSize &lt;- 100
ti&lt;- rnorm(SampleSize)            #draw a random sample from the actual distribution

huse&lt;-bw.nrd(ti)
arg2&lt;-kde(ti, x, huse, Epanechnikov) #Calculate the estimate
lines(x, arg2, lty=2)             #draw the result on the graphics device.
</code></pre>

<hr>
<h2 id='Kernels'>Kernel functions</h2><span id='topic+Biweight'></span><span id='topic+Epanechnikov'></span><span id='topic+Triangular'></span><span id='topic+Gaussian'></span><span id='topic+Rectangular'></span><span id='topic+Epanechnikov2'></span>

<h3>Description</h3>

<p>Implements various kernel functions, including boundary, integrated and discrete kernels for use in the definition of the nonparametric estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Biweight(x, ...)
Epanechnikov(x, ...)
Triangular(x, ...)
Gaussian(x, ...)
Rectangular(x, ...)
Epanechnikov2(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Kernels_+3A_x">x</code></td>
<td>
<p> A vector of data points where the kernel will be evaluated.</p>
</td></tr>
<tr><td><code id="Kernels_+3A_...">...</code></td>
<td>
<p>Further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the Biweight, Triangular, Guassian, Rectangular and Epanechnikov (including the alternative version in Epanechnikov2) kernels.
</p>


<h3>Value</h3>

<p>The value of the kernel at <code class="reqn">x</code>
</p>


<h3>References</h3>

<p>Wand and Jones,  (1996), Kernel Smoothing, Chapman and Hall, London
</p>

<hr>
<h2 id='NDistDens'>Select null distribution</h2><span id='topic+NDistDens'></span>

<h3>Description</h3>

<p>Implements the selection of null distribution; to be used within the implementation of the test statistic S.n
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NDistDens(x, dist, p1, p2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NDistDens_+3A_x">x</code></td>
<td>
<p> A vector of data points - the available sample size.</p>
</td></tr>
<tr><td><code id="NDistDens_+3A_dist">dist</code></td>
<td>
<p>The null distribution.</p>
</td></tr>
<tr><td><code id="NDistDens_+3A_p1">p1</code></td>
<td>
<p>Argument 1 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="NDistDens_+3A_p2">p2</code></td>
<td>
<p>Argument 2 (vector or object) for the null distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the null distribution evaluation at designated points, given the parameters p1 and p2.
</p>


<h3>Value</h3>

<p>A vector containing the density values of the designated distribution
</p>


<h3>Author(s)</h3>

<p>Dimitrios Bagkavos
</p>
<p>R implementation and documentation: Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;
</p>


<h3>References</h3>

<p>Bagkavos, Patil and Wood: Nonparametric goodness-of-fit testing for a continuous multivariate parametric model, (2021), under review.
</p>

<hr>
<h2 id='S.n'>Density goodness-of-fit test statistic based on discretized L2 distance</h2><span id='topic+S.n'></span>

<h3>Description</h3>

<p>Implements the density goodness of fit test statistic <code class="reqn">\hat{S}_n(h)</code> of Bagkavos, Patil and Wood (2021), based on aggregation of local discrepancies between the fitted parametric density and a nonparametric empirical density estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>S.n(xin, h,  dist, p1, p2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="S.n_+3A_xin">xin</code></td>
<td>
<p>A vector of data points - the available sample size.</p>
</td></tr>
<tr><td><code id="S.n_+3A_h">h</code></td>
<td>
<p>The bandwidth to use, typically the output of <code>hopt.edgeworth</code>.</p>
</td></tr>
<tr><td><code id="S.n_+3A_dist">dist</code></td>
<td>
<p>The null distribution.</p>
</td></tr>
<tr><td><code id="S.n_+3A_p1">p1</code></td>
<td>
<p>Parameter 1 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="S.n_+3A_p2">p2</code></td>
<td>
<p>Parameter 2 (vector or object) for the null distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the test statistic used for testing the hypothesis
</p>
<p style="text-align: center;"><code class="reqn">H_0: f(x) = f_0(x, p1, p2) \;\; vs \;\; H_a: f(x) \neq f_0(x, p1, p2).</code>
</p>

<p>This density goodness-of-fit test is based on a discretized approximation of the L2 distance. Assuming that <code class="reqn">n</code> is the number of observations and <code class="reqn">g = (max(xin)-min(xin))/n^{-drate}</code> is the number of bins in which the range of the data is split, the test statistic is:
</p>
<p style="text-align: center;"><code class="reqn"> S_n(h) = n \Delta^2 h^{-1/2} {\sum\sum}_{i \neq j} K \{ (X_i-X_j)h^{-1}\} \{Y_i -f_0(X_i) \}\{Y_j -f_0(X_j) \} </code>
</p>

<p>where <code class="reqn">K</code> is the Epanechnikov kernel implemented in this package with the <code><a href="#topic+Epanechnikov">Epanechnikov</a></code> function. The null model <code class="reqn">f_0</code> is specified through the <code>dist</code> argument with parameters passed through the  <code>p1</code> and <code>p2</code> arguments.  The test is implemented either with bandwidth <code><a href="#topic+hopt.edgeworth">hopt.edgeworth</a></code> or with  bandwidth <code><a href="#topic+hopt.be">hopt.be</a></code> which provide the value of <code class="reqn">h</code> needed for calculation of <code class="reqn"> S_n(h)</code> and the critical value used to determine acceptance or rejection of the null hypothesis. See the example below for an application to a real world dataset.
</p>


<h3>Value</h3>

<p>A vector with the value of the test statistic as well as the Delta value used for its calculation
</p>


<h3>Author(s)</h3>

<p>R implementation and documentation: Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;
</p>


<h3>References</h3>

<p>Bagkavos, Patil and Wood: Nonparametric goodness-of-fit testing for a continuous multivariate parametric model, (2021), under review.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+S.n.Boot">S.n.Boot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(fGarch)
library(boot)
 ## Not run: data(EuStockMarkets)
DAX &lt;- as.ts(EuStockMarkets[,"DAX"])
dax &lt;-  diff(log(DAX))#[,"DAX"]

# Fit a GARCH(1,1) model to dax returns:
lll&lt;-garchFit(~ garch(1,1), data = as.ts(dax), trace = FALSE, cond.dist ="std")
# define the model innovations, to be used as input to the test statistic
xin&lt;-lll@residuals /lll@sigma.t
# exclude smallest value - only for uniform presentation of results
#(this step can be excluded):
xin = xin[xin!= min(xin)]

#inputs for the test statistic:
#kernel function to use in implementing the statistic
#and functional estimates for optimal h:
kfun&lt;-"epanechnikov"
a.sig&lt;-0.05 #define the significance level
#null hypothesis is that the innovations are normaly distributed:
Nulldist&lt;-"normal"

p1&lt;-mean(xin)
p2&lt;- sd(xin)
#Power optimal bandwidth:
h&lt;-hopt.edgeworth(xin,   Nulldist, kfun, p1, p2, a.sig )
h.be &lt;- hopt.be(xin)
# Edgeworth cutoff point:
cutoff&lt;-cutoff.edgeworth(xin,   Nulldist, kfun, p1, p2, a.sig )
# Bootstrap cutoff point:
cutoff.boot&lt;-cutoff.bootstrap(xin, 100,  "permutation", Nulldist, h.be, kfun, p1, p2, a.sig)
# Asympt. Norm. cutoff point:
cutoff.asympt&lt;-cutoff.asymptotic( Nulldist,   p1, p2, a.sig )

TestStatistic&lt;-S.n(xin, h, Nulldist, p1, p2)
TestStatistic.be&lt;-S.n(xin, h.be, Nulldist, p1, p2)

cat("L2 test statistic value with power opt. band:", TestStatistic[1],
"\nL2 test statistic value Barry-Essen bandwidth:", TestStatistic.be[1],
"\ncritical value asymptotic:", round(cutoff.asympt,3), "critical value bootstrap:",
round(cutoff.boot,3),  "critical value Edgeworth:", round(cutoff,3), "\n")
#L2 test statistic value Edgeworth: 7.257444
#L2 test statistic value Berry-Esseen bandwidth: 10.97069
# critical value Asymptotically Norm.:  1.801847
# critical value Edgeworth: 2.140446
# critical value bootstrap: 6.040048
# L2 test statistic &gt;  critical value on all occasions, hence normality is rejected
## End(Not run)
</code></pre>

<hr>
<h2 id='S.n.Boot'>Goodness-of-Fit test statistic based on discretized L2 distance</h2><span id='topic+S.n.Boot'></span>

<h3>Description</h3>

<p>Implements the bootstraped version of the density goodness-of-fit test <code class="reqn">\hat{S}_n(h)</code> defined in (6) Bagkavos, Patil and Wood (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>S.n.Boot(xin1, indices, h,  dist, kfun, p1, p2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="S.n.Boot_+3A_xin1">xin1</code></td>
<td>
<p>A vector of data points to perfrom bootstrap on.</p>
</td></tr>
<tr><td><code id="S.n.Boot_+3A_indices">indices</code></td>
<td>
<p>indices to use for the bootstrap process.</p>
</td></tr>
<tr><td><code id="S.n.Boot_+3A_h">h</code></td>
<td>
<p>The bandwidth to use, typically the output of <code>hopt.be</code>.</p>
</td></tr>
<tr><td><code id="S.n.Boot_+3A_dist">dist</code></td>
<td>
<p>The null distribution.</p>
</td></tr>
<tr><td><code id="S.n.Boot_+3A_kfun">kfun</code></td>
<td>
<p>The kernel to use in the density estimates used in the bandwidth expression.</p>
</td></tr>
<tr><td><code id="S.n.Boot_+3A_p1">p1</code></td>
<td>
<p>Argument 1 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="S.n.Boot_+3A_p2">p2</code></td>
<td>
<p>Argument 2 (vector or object) for the null distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the bootstrap version of the test statistic <code>S.n</code> for use in the  <code><a href="#topic+cutoff.bootstrap">cutoff.bootstrap</a></code> function. This function is typically not to be called directly by the user; it is rather meant to be called indirectly through the <code>cutoff.bootstrap</code> function.
</p>


<h3>Value</h3>

<p>A vector of values of the test statistic.
</p>


<h3>Author(s)</h3>

<p>R implementation and documentation: Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;
</p>


<h3>References</h3>

<p>Bagkavos, Patil and Wood: Nonparametric goodness-of-fit testing for a continuous multivariate parametric model, (2021), under review.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+S.n">S.n</a></code></p>

<hr>
<h2 id='S.nd'>Density goodness-of-fit test statistic based on discretized L2 distance</h2><span id='topic+S.nd'></span>

<h3>Description</h3>

<p>Implements the multivariate (d &gt;=2) density goodness of fit test statistic <code class="reqn">\hat{S}_n(h)</code> of Bagkavos, Patil and Wood (2021), based on aggregation of local discrepancies between the fitted parametric density and a nonparametric empirical density estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>S.nd(xin, h,  dist, p1, p2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="S.nd_+3A_xin">xin</code></td>
<td>
<p>A matrix (n x d) of data points - the available sample with n rows and d columns, each column corresponds to a different coordinate axis.</p>
</td></tr>
<tr><td><code id="S.nd_+3A_h">h</code></td>
<td>
<p>The bandwidth vector to use, typically the output of <code>hopt.be</code> in each coordinate direction.</p>
</td></tr>
<tr><td><code id="S.nd_+3A_dist">dist</code></td>
<td>
<p>The null distribution.</p>
</td></tr>
<tr><td><code id="S.nd_+3A_p1">p1</code></td>
<td>
<p>Parameter 1 (vector or object) for the null distribution.</p>
</td></tr>
<tr><td><code id="S.nd_+3A_p2">p2</code></td>
<td>
<p>Parameter 2 (vector or object) for the null distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the test statistic used for testing the hypothesis
</p>
<p style="text-align: center;"><code class="reqn">H_0: f(x) = f_0(x, p1, p2) \;\; vs \;\; H_a: f(x) \neq f_0(x, p1, p2).</code>
</p>

<p>This density goodness-of-fit test is based on a discretized approximation of the L2 distance. Assuming that <code class="reqn">n</code> is the number of observations and <code class="reqn">g = (max(xin)-min(xin))/n^{-drate}</code> is the number of bins in which the range of the data is split, the test statistic is:
</p>
<p style="text-align: center;"><code class="reqn"> S_n(h) = n \Delta^2  {\sum\sum}_{i \neq j} K \{ (X_{i1}-X_{j1})h_1^{-1}, \dots,  (X_{id}-X_{jd})h_d^{-1} \} \{Y_i -f_0(X_i) \}\{Y_j -f_0(X_j) \} </code>
</p>

<p>where <code class="reqn">K</code> is the Epanechnikov kernel implemented in this package with the <code><a href="#topic+Epanechnikov">Epanechnikov</a></code> function. The null model <code class="reqn">f_0</code> is specified through the <code>dist</code> argument with parameters passed through the  <code>p1</code> and <code>p2</code> arguments.  The test is implemented either with bandwidth <code><a href="#topic+hopt.edgeworth">hopt.edgeworth</a></code> or with  bandwidth <code><a href="#topic+hopt.be">hopt.be</a></code> which provide the value of <code class="reqn">h</code> needed for calculation of <code class="reqn"> S_n(h)</code> and the critical value used to determine acceptance or rejection of the null hypothesis.
</p>


<h3>Value</h3>

<p>A vector with the value of the test statistic as well as the Delta value used for its calculation
</p>


<h3>Author(s)</h3>

<p>R implementation and documentation: Dimitrios Bagkavos &lt;dimitrios.bagkavos@gmail.com&gt;
</p>


<h3>References</h3>

<p>Bagkavos, Patil and Wood: Nonparametric goodness-of-fit testing for a continuous multivariate parametric model, (2021), under review.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+S.n">S.n</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
sigma &lt;- matrix(c(4,2,2,3), ncol=2)

x &lt;- rmvnorm(n=100, mean=c(1,2), sigma=sigma)
h.be1 &lt;- hopt.be(x[,1])
h.be2 &lt;- hopt.be(x[,2])
h&lt;-c(h.be1, h.be2)
Nulldist&lt;-"normal"

S.nd(x, h,  Nulldist, c(1,2), sigma)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
