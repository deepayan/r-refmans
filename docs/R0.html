<!DOCTYPE html><html><head><title>Help for package R0</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {R0}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#censored.deviation'><p>Deviation between theorietical incidence and observed data.</p></a></li>
<li><a href='#check.incid'><p>Check incidence vector in the input</p></a></li>
<li><a href='#est.GT'><p>Estimate generation time distribution</p></a></li>
<li><a href='#est.R0.AR'><p>Estimate R0 from attack rate of an epidemic</p></a></li>
<li><a href='#est.R0.EG'><p>Estimate R0 from exponential growth rate of an epidemic</p></a></li>
<li><a href='#est.R0.ML'><p>Estimate R0 by Maximum Likelihood</p></a></li>
<li><a href='#est.R0.SB'><p>Estimate the time dependent R using a Bayesian method</p></a></li>
<li><a href='#est.R0.TD'><p>Estimate the Time-Dependent reproduction number</p></a></li>
<li><a href='#estimate.R'><p>Estimate reproduction number (R0 or Rt) for one incidence dataset using</p>
available methods</a></li>
<li><a href='#fit.epid'><p>Poisson log-likelihood for an observed epidemic</p></a></li>
<li><a href='#fit.epid.optim'><p>Joint estimation of R and generation time distribution for the ML method</p></a></li>
<li><a href='#generation.time'><p>Generation Time distribution</p></a></li>
<li><a href='#Germany.1918'><p>Germany 1918 dataset</p></a></li>
<li><a href='#get.scale'><p>Scaling of x-axis</p></a></li>
<li><a href='#GT.chld.hsld'><p>2009 A/H1N1 observed generation time distribution</p></a></li>
<li><a href='#H1N1.serial.interval'><p>H1N1 serial interval</p></a></li>
<li><a href='#impute.incid'><p>Impute censored cases to rebuild longer epidemic vector</p></a></li>
<li><a href='#inspect.data'><p>Audit input data for common issues</p></a></li>
<li><a href='#integrity.checks'><p>Integrity checks for input parameters</p></a></li>
<li><a href='#plot.R0.GT'><p>Plot a generation time distribution</p></a></li>
<li><a href='#plot.R0.R'><p>Plot the R0/Rt value along with confidence interval</p></a></li>
<li><a href='#plot.R0.S'><p>Plot of sensitivity analyses.</p></a></li>
<li><a href='#plot.R0.sR'><p>Plot the R0/Rt value along with confidence interval</p></a></li>
<li><a href='#plotfit'><p>S3 method for objects of class <code>R0.R</code> or <code>R0.sR</code></p></a></li>
<li><a href='#plotfit.R0.R'><p>Plot a model fit for <code>R0.R</code> objects</p></a></li>
<li><a href='#plotfit.R0.sR'><p>Plot a model fit for <code>R0.sR</code> objects</p></a></li>
<li><a href='#plotfitRAR'><p>Internal plotfit method for AR estimates</p></a></li>
<li><a href='#plotfitRSB'><p>Internal plotfit method for AR estimates</p></a></li>
<li><a href='#plotfitRxx'><p>Internal plotfit method for EG, ML and TD estimates</p></a></li>
<li><a href='#plotRAR'><p>Plot R0 for Attack Rate method</p></a></li>
<li><a href='#plotREG'><p>Plot R0 for Exponential Growth method</p></a></li>
<li><a href='#plotRML'><p>Plot R0 for Maximum Likelihood method</p></a></li>
<li><a href='#plotRSB'><p>Plot R0 for Sequential Bayesian method</p></a></li>
<li><a href='#plotRTD'><p>Plot R0 for Time-Dependent method</p></a></li>
<li><a href='#print.R0.GT'><p>Print method for objects of class <code>R0.GT</code></p></a></li>
<li><a href='#print.R0.R'><p>Print method for objects of class <code>R0.R</code></p></a></li>
<li><a href='#print.R0.sR'><p>Print method for objects of class <code>R0.sR</code></p></a></li>
<li><a href='#R.from.r'><p>Estimate reproduction number from exponential growth rate</p></a></li>
<li><a href='#sa.GT'><p>Sensitivity of R0 to varying generation time distributions</p></a></li>
<li><a href='#sa.time'><p>Sensitivity of R0 to time estimation windows</p></a></li>
<li><a href='#sensitivity.analysis'><p>Sensitivity analysis of basic reproduction ratio to begin/end dates</p></a></li>
<li><a href='#sim.epid'><p>Epidemic outbreak simulation</p></a></li>
<li><a href='#sim.epid.indiv'><p>Influenza-like illness simulation (individual-based model)</p></a></li>
<li><a href='#smooth.Rt'><p>Smooth real-time reproduction number over larger time periods</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of R0 and Real-Time Reproduction Number from
Epidemics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Pierre-Yves Boelle, Thomas Obadia</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/tobadia/R0">https://github.com/tobadia/R0</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Obadia &lt;thomas.obadia@pasteur.fr&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.13.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of reproduction numbers for disease outbreak, based on
    incidence data. The R0 package implements several documented methods. It is
    therefore possible to compare estimations according to the methods used.
    Depending on the methods requested by user, basic reproduction number
    (commonly denoted as R0) or real-time reproduction number (referred to as
    R(t)) is computed, along with a 95% Confidence Interval. Plotting outputs
    will give different graphs depending on the methods requested : basic
    reproductive number estimations will only show the epidemic curve
    (collected data) and an adjusted model, whereas real-time methods will also
    show the R(t) variations throughout the outbreak time period. Sensitivity
    analysis tools are also provided, and allow for investigating effects of
    varying Generation Time distribution or time window on estimates.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-26 09:24:47 UTC; tobadia</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-26 09:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='censored.deviation'>Deviation between theorietical incidence and observed data.</h2><span id='topic+censored.deviation'></span>

<h3>Description</h3>

<p>When first records of incidence are unavailable, tries to impute censored
cases to rebuild longer epidemic vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>censored.deviation(optim.vect, epid, R0, GT)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="censored.deviation_+3A_optim.vect">optim.vect</code></td>
<td>
<p>Vector of two elements <code style="white-space: pre;">&#8288;c(multiplicative factor, log(highest imputed data))&#8288;</code> corresponding to initial values.</p>
</td></tr>
<tr><td><code id="censored.deviation_+3A_epid">epid</code></td>
<td>
<p>Original epidemic vector, output of <code><a href="#topic+check.incid">check.incid()</a></code>.</p>
</td></tr>
<tr><td><code id="censored.deviation_+3A_r0">R0</code></td>
<td>
<p>Assumed R0 value for the original epidemic vector.</p>
</td></tr>
<tr><td><code id="censored.deviation_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution to be used for computations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by <code><a href="#topic+impute.incid">impute.incid()</a></code>.
</p>
<p>This function is not intended for stand-alone use. It computes the difference
between theoretical incidence and observed epidemics, for a given vector of
initial values. To find the find best-fitting incidence values, this same
vector must be optimized, to minimize the value returned by SCE.
</p>


<h3>Value</h3>

<p>The deviation between <code class="reqn">E(N_{t})</code> and <code class="reqn">N_{t}</code> : sum((E(Nt) - Nt)^2).
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='check.incid'>Check incidence vector in the input</h2><span id='topic+check.incid'></span>

<h3>Description</h3>

<p>Checks incid in the input. For internal use only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.incid(incid, t = NULL, date.first.obs = NULL, time.step = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check.incid_+3A_incid">incid</code></td>
<td>
<p>An object (vector, data.frame, list) storing incidence.</p>
</td></tr>
<tr><td><code id="check.incid_+3A_t">t</code></td>
<td>
<p>Optional vector of dates.</p>
</td></tr>
<tr><td><code id="check.incid_+3A_date.first.obs">date.first.obs</code></td>
<td>
<p>Optional date of first observation, if t not specified.</p>
</td></tr>
<tr><td><code id="check.incid_+3A_time.step">time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by estimation methods to format incidence input.
</p>
<p><code>check.incid()</code> handles everything related to incidence content integrity.
It is designed to generate an output which comply with estimation functions
requirements. Epidemic data can be provided as an epitools object (see below),
or as vectors (incidence, dates, or both).
</p>
<p>When dates are provided, they can be in a separate <code>t</code> vector, or computed with
the first value and a time step. In the end, the function returns a list with
components<code>epid</code> and <code>t</code> values. If you plan on using estimation functions on
their own (and not throught <code><a href="#topic+estimate.R">estimate.R()</a></code>), be aware that any incorrect input
format will result in erratic behavior and/or crash.
</p>
<p>Object incid is either a <code>list</code> or <code>data.frame</code>. Expect items/columns <code style="white-space: pre;">&#8288;$dates&#8288;</code>
and/or <code style="white-space: pre;">&#8288;$stratum3&#8288;</code>. This is expected to work with objects created by the epitools
package (tested with v0.5-6).
</p>
<p><code><a href="epitools.html#topic+epicurve">epitools::epicurve.dates()</a></code> returns (among other things) a list with $dates object.
This list gives incidence per day. Other epicurve methods return $dates along with a
<code style="white-space: pre;">&#8288;$&lt;time_period&gt;&#8288;</code> object and a <code style="white-space: pre;">&#8288;$stratum3&#8288;</code>, which contains respectively daily
incidence data agregated by the given time period, and the same data with colnames
that comply with R standard time notation.
</p>
<p>E.g.: <code><a href="epitools.html#topic+epicurve">epitools::epicurve.weeks()</a></code> returns <code style="white-space: pre;">&#8288;$dates&#8288;</code>, <code style="white-space: pre;">&#8288;$weeks&#8288;</code> and <code style="white-space: pre;">&#8288;$stratum3.&#8288;</code> <code style="white-space: pre;">&#8288;$stratum3&#8288;</code>
object is a list of dates (correct syntax), where each date is repeated to reflect
the incidence value at this time.
</p>
<p>Incidence data should not contain negative or missing values. Incidence data and
time vector should have the same length.
</p>


<h3>Value</h3>

<p>A list with components <code>incid</code> and <code>t</code>.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

## Data is taken from the paper by Nishiura for key transmission parameters of an institutional
## outbreak during 1918 influenza pandemic in Germany
data(Germany.1918)
Germany.1918

## check.incid will extract names from the vector and coerce them as dates
check.incid(Germany.1918)

## Had Germany.1918 not have names() set, output would have been with index dates
## To force such an output, we here impose t=1:126. 
## Erasing names(Germany.1918) would have produced the same
## If so, then the epid$t vector returned will be replacement values.
check.incid(Germany.1918, t=1:126)

## You can also choose not to provide a complete date vector, but to only
## indicated the first day of the observation, and the number of days between each
## observation. In this example we will assume a time step of 7 days.
check.incid(Germany.1918, date.first.obs="1918-01-01", time.step=7)

## Finally, if no names() are available for the dataset and date.first.obs is not provided,
## setting time.step to any integer value will generate a t vector starting 
## from 1 and incrementing by the time.step parameter.
</code></pre>

<hr>
<h2 id='est.GT'>Estimate generation time distribution</h2><span id='topic+est.GT'></span>

<h3>Description</h3>

<p>Find the best-fitting generation time distribution from a series of serial
interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.GT(
  infector.onset.dates = NULL,
  infectee.onset.dates = NULL,
  serial.interval = NULL,
  request.plot = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est.GT_+3A_infector.onset.dates">infector.onset.dates</code></td>
<td>
<p>Vector of dates for infector symptoms onset.</p>
</td></tr>
<tr><td><code id="est.GT_+3A_infectee.onset.dates">infectee.onset.dates</code></td>
<td>
<p>Vector of dates for infectee symptoms onset.</p>
</td></tr>
<tr><td><code id="est.GT_+3A_serial.interval">serial.interval</code></td>
<td>
<p>Vector of reported serial interval.</p>
</td></tr>
<tr><td><code id="est.GT_+3A_request.plot">request.plot</code></td>
<td>
<p>Boolean. Should data adjustment be displayed at the end?</p>
</td></tr>
<tr><td><code id="est.GT_+3A_...">...</code></td>
<td>
<p>Parameters passed to other functions (useful for hidden parameters of <code><a href="#topic+generation.time">generation.time()</a></code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generation Time (GT) distribution can be estimated by two inputs methods.
User can either provide two vectors of dates or a unique vector of reported
serial intervals. If two vectors are provided, both <code style="white-space: pre;">&#8288;*.onset.dates&#8288;</code> vectors
should have the same length. The i-th element is the onset date for individual
i. This implies that infector k (symptoms on day <code>infector.onset.dates[k]</code>)
infected infectee k (symptoms on day <code>infectee.onset.dates[k]</code>). If only
<code>serial.interval</code> is provided, each value is assumed to be the time elapsed
between each pair of infector and infectee (i.e. the difference between the
two <code style="white-space: pre;">&#8288;*.onset.dates&#8288;</code> vectors).
</p>
<p>When <code>request.plot</code> is set to <code>TRUE</code>, a graphical output provides standardized
histogram of observed data along with the best-fitting adjusted model.
</p>


<h3>Value</h3>

<p>A object of class <code>R0.GT</code> that complies with <code><a href="#topic+generation.time">generation.time()</a></code> distribution
requirements of the R0 package.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

# Data taken from traced cases of H1N1 viruses.
data(H1N1.serial.interval)
est.GT(serial.interval=H1N1.serial.interval)

## Best fitting GT distribution is a gamma distribution with mean = 3.039437 and sd = 1.676551 .
## Discretized Generation Time distribution
## mean: 3.070303 , sd: 1.676531 
## [1] 0.0000000000 0.1621208802 0.2704857362 0.2358751176 0.1561845680 0.0888997193 0.0459909903 
## 0.0222778094 0.0102848887 0.0045773285 0.0019791984 0.0008360608 0.0003464431 0.0001412594


# The same result can be achieved with two vectors of dates of onset.
# Here we use the same data, but trick the function into thinking onset dates are all "0".
data(H1N1.serial.interval)
est.GT(infector.onset.dates=rep(0,length(H1N1.serial.interval)), 
       infectee.onset.dates=H1N1.serial.interval)
</code></pre>

<hr>
<h2 id='est.R0.AR'>Estimate R0 from attack rate of an epidemic</h2><span id='topic+est.R0.AR'></span>

<h3>Description</h3>

<p>Estimate basic reproduction number R0 from Attack Rate (AR) of an epidemic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.R0.AR(
  AR = NULL,
  incid = NULL,
  pop.size = NULL,
  S0 = 1,
  checked = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est.R0.AR_+3A_ar">AR</code></td>
<td>
<p>Attack rate as a percentage from total population.</p>
</td></tr>
<tr><td><code id="est.R0.AR_+3A_incid">incid</code></td>
<td>
<p>Sum of incident cases, possibly in the form of a vector of counts.</p>
</td></tr>
<tr><td><code id="est.R0.AR_+3A_pop.size">pop.size</code></td>
<td>
<p>Population size in which the incident cases were observed.</p>
</td></tr>
<tr><td><code id="est.R0.AR_+3A_s0">S0</code></td>
<td>
<p>Initial proportion of the population considered susceptible.</p>
</td></tr>
<tr><td><code id="est.R0.AR_+3A_checked">checked</code></td>
<td>
<p>Internal flag used to check whether integrity checks were ran or not.</p>
</td></tr>
<tr><td><code id="est.R0.AR_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by <code><a href="#topic+estimate.R">estimate.R()</a></code>.
</p>
<p>In the simple SIR model, the relation between R0 and the Attack Rate is in the
form <code class="reqn">R0 = -ln((1-AR)/S0) / (AR - (1-S0))</code>. If the population size is provided,
the variance of R0 is estimated using the delta method. The hypothesis are that
of homogeneous mixing, no more transmission (epidemic ended), no change in
transmission or interventions during the epidemic. This estimate may be correct
in closed populations, and may be less valid in other cases.
</p>
<p>The correction for incomplete susceptibility is based on the SIR model equations.
</p>
<p>A 95% confidence interval is computed for the attack rate considering the total
population size (<code class="reqn">CI(AR) = AR +/- 1.96*sqrt(AR*(1-AR)/n)</code>), and so the
confidence interval for the reproduction number is computed with these extreme values.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>epid</code></td>
<td>
<p>The vector of incidence, after being correctly formated by <code><a href="#topic+check.incid">check.incid()</a></code>. Used only by <code><a href="#topic+plotfit">plotfit()</a></code></p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>The estimate of the reproduction ratio.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>The 95% confidence interval for the R estimate.</p>
</td></tr>
<tr><td><code>AR</code></td>
<td>
<p>Original attack rate.</p>
</td></tr>
<tr><td><code>begin.nb</code></td>
<td>
<p>First date of incidence record. Used only by <code><a href="#topic+plotfit">plotfit()</a></code>.</p>
</td></tr>
<tr><td><code>end.nb</code></td>
<td>
<p>Last date of incidence record. Used only by <code><a href="#topic+plotfit">plotfit()</a></code>.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Method used for the estimation.</p>
</td></tr>
<tr><td><code>method.code</code></td>
<td>
<p>Internal code used to designate method.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is the implementation of the formula by Dietz (1993).
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>References</h3>

<p>Dietz, K. &quot;The Estimation of the Basic Reproduction Number for Infectious Diseases.&quot; Statistical Methods in Medical Research 2, no. 1 (March 1, 1993): 23-41.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

## Woodall reported an attack rate of 0.31 in a population of 1732 during
## the 1957 H2N2 influenza pandemic ('Age and Asian Influenza, 1957', BMJ, 1958)

est.R0.AR(pop.size=1732, AR=0.31)
# Reproduction number estimate using Attack Rate method
# R :  1.19698[ 1.179606 , 1.215077 ]

est.R0.AR(AR=0.31)
# Reproduction number estimate using  Attack Rate  method.
# R :  1.19698

est.R0.AR(pop.size=1732, incid=31)
# Reproduction number estimate using Attack Rate method
# R :  1.009057[ 1.005873 , 1.012269 ]

est.R0.AR(pop.size=1732, incid=c(2,3,4,7,4,2,4,5))
# Reproduction number estimate using Attack Rate method
# R :  1.009057[ 1.005873 , 1.012269 ]

est.R0.AR(pop.size=1732, incid=c(2,3,0,7,4,2,0,5))
# Reproduction number estimate using Attack Rate method
# R :  1.006699[ 1.003965 , 1.009453 ]
</code></pre>

<hr>
<h2 id='est.R0.EG'>Estimate R0 from exponential growth rate of an epidemic</h2><span id='topic+est.R0.EG'></span>

<h3>Description</h3>

<p>Estimate R0 from the initial phase of an epidemic when incident cases are
presumed to follow an exponential distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.R0.EG(
  epid,
  GT,
  t = NULL,
  begin = NULL,
  end = NULL,
  date.first.obs = NULL,
  time.step = 1,
  reg.met = "poisson",
  checked = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est.R0.EG_+3A_epid">epid</code></td>
<td>
<p>Object containing epidemic curve data.</p>
</td></tr>
<tr><td><code id="est.R0.EG_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="est.R0.EG_+3A_t">t</code></td>
<td>
<p>Vector of dates at which incidence was observed.</p>
</td></tr>
<tr><td><code id="est.R0.EG_+3A_begin">begin</code></td>
<td>
<p>At what time estimation begins.</p>
</td></tr>
<tr><td><code id="est.R0.EG_+3A_end">end</code></td>
<td>
<p>Time at which to end computation.</p>
</td></tr>
<tr><td><code id="est.R0.EG_+3A_date.first.obs">date.first.obs</code></td>
<td>
<p>Optional date of first observation, if <code>t</code> not specified</p>
</td></tr>
<tr><td><code id="est.R0.EG_+3A_time.step">time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation</p>
</td></tr>
<tr><td><code id="est.R0.EG_+3A_reg.met">reg.met</code></td>
<td>
<p>Regression method used. Default is &quot;poisson&quot; (for GLM), but can be forced to &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="est.R0.EG_+3A_checked">checked</code></td>
<td>
<p>Internal flag used to check whether integrity checks were ran or not.</p>
</td></tr>
<tr><td><code id="est.R0.EG_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by <code><a href="#topic+estimate.R">estimate.R()</a></code>.
</p>
<p>Method &quot;poisson&quot; uses Poisson regression of incidence to estimate the exponential
growth rate. Method &quot;linear&quot; uses linear regression of log(incidence) against time.
</p>
<p>The 95% confidence interval is computed from the 1/M(-r) formula, using bounds
on r from the Poisson or linear regression.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>R</code></td>
<td>
<p>The estimate of the reproduction ratio.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>The 95% confidence interval for the R estimate.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>Exponential growth rate of the epidemic.</p>
</td></tr>
<tr><td><code>conf.int.r</code></td>
<td>
<p>Confidence interval of the exponential growth rate of the epidemic.</p>
</td></tr>
<tr><td><code>Rsquared</code></td>
<td>
<p>The deviance R-squared measure for the considered dates and model.</p>
</td></tr>
<tr><td><code>epid</code></td>
<td>
<p>Original epidemic data.</p>
</td></tr>
<tr><td><code>GT</code></td>
<td>
<p>Generation time distribution used in the computation.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>Name of the data used in the fit.</p>
</td></tr>
<tr><td><code>begin</code></td>
<td>
<p>Starting date for the fit.</p>
</td></tr>
<tr><td><code>begin.nb</code></td>
<td>
<p>The number of the first day used in the fit.</p>
</td></tr>
<tr><td><code>end</code></td>
<td>
<p>The end date for the fit.</p>
</td></tr>
<tr><td><code>end.nb</code></td>
<td>
<p>The number of the las day used for the fit.</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>Method used for fitting.</p>
</td></tr>
<tr><td><code>pred</code></td>
<td>
<p>Prediction on the period used for the fit.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Method for estimation.</p>
</td></tr>
<tr><td><code>method.code</code></td>
<td>
<p>Internal code used to designate method.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is the implementation of the method provided by Wallinga &amp; Lipsitch (2007).
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>References</h3>

<p>Wallinga, J., and M. Lipsitch. &quot;How Generation Intervals Shape the Relationship Between Growth Rates and Reproductive Numbers.&quot; Proceedings of the Royal Society B: Biological Sciences 274, no. 1609 (2007): 599.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

## Data is taken from the paper by Nishiura for key transmission parameters of an institutional
## outbreak during 1918 influenza pandemic in Germany)

data(Germany.1918)
mGT&lt;-generation.time("gamma", c(3, 1.5))

est.R0.EG(Germany.1918, mGT, begin=1, end=27)
## Reproduction number estimate using  Exponential Growth 
## R :  1.525895[ 1.494984 , 1.557779 ]
</code></pre>

<hr>
<h2 id='est.R0.ML'>Estimate R0 by Maximum Likelihood</h2><span id='topic+est.R0.ML'></span>

<h3>Description</h3>

<p>Estimate R0 by maximum likelihood, assuming Poisson distribution of offsprings
generated from infected individuals at each time step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.R0.ML(
  epid,
  GT,
  import = NULL,
  t = NULL,
  begin = NULL,
  end = NULL,
  date.first.obs = NULL,
  time.step = 1,
  range = c(0.01, 50),
  unknown.GT = FALSE,
  impute.incid = FALSE,
  checked = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est.R0.ML_+3A_epid">epid</code></td>
<td>
<p>Object containing epidemic curve data.</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_import">import</code></td>
<td>
<p>Vector of imported cases.</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_t">t</code></td>
<td>
<p>Vector of dates at which incidence was observed.</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_begin">begin</code></td>
<td>
<p>At what time estimation begins.</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_end">end</code></td>
<td>
<p>Time at which to end computation.</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_date.first.obs">date.first.obs</code></td>
<td>
<p>Optional date of first observation, if <code>t</code> not specified.</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_time.step">time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_range">range</code></td>
<td>
<p>Range of values over which the MLE must be explored.</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_unknown.gt">unknown.GT</code></td>
<td>
<p>Boolean value. When GT distribution is unknown, it is estimated jointly (see details).</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_impute.incid">impute.incid</code></td>
<td>
<p>Boolean value. If <code>TRUE</code>, will impute unobserved cases at the beginning of the epidemic to correct for censored data.</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_checked">checked</code></td>
<td>
<p>Internal flag used to check whether integrity checks were ran or not.</p>
</td></tr>
<tr><td><code id="est.R0.ML_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by <code><a href="#topic+estimate.R">estimate.R()</a></code>.
</p>
<p>White &amp; Pagano (2009) detail two maximum likelihood methods for estimatig the
reproduction ratio. The principle of the methods described by White &amp; all is to
compute the expected number of cases in the future, and optimise to get R using
a Poisson distribution.
</p>
<p>The first (and used by default in this package) assumes that the serial interval
distirbution is known, and subsequently the likelihood is only maximised depending
on the value of R.
</p>
<p>The second method can be used if the serial interval distribution is unknown: in
that case, the generation time is set to follow a Gamma distribution with two
parameters (size, shape), and the optimization routine finds the values of R, size
and shape that maximize the likelihood. However, the epidemic curve must be long
enough to account for a whole generation. The authors showed that this is achieved
when the cumulated amount of incident cases reaches approximately 150.
When using this method, the flag <code>unknown.GT</code> must be set to <code>TRUE</code>. GT must still
be provided with a <code>R0.GT</code>-class object, though its mean and sd will be recycled
as starting value for the optimization routine.
</p>
<p>The 95% confidence interval is achieved by profiling the likelihood.
</p>
<p>In addition to the estimation method, we implemented a framework to impute
unobserved incidence data, when the epidemic curve is found to not be available
from the start of the outbreak. The details of this method are availble in the
Supplementary Material S1 from <a href="https://doi.org/10.1186/1472-6947-12-147">doi:10.1186/1472-6947-12-147</a>Obadia et al., 2012.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>R</code></td>
<td>
<p>The estimate of the reproduction ratio.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>The 95% confidence interval for the R estimate.</p>
</td></tr>
<tr><td><code>epid</code></td>
<td>
<p>Original or augmented epidemic data, depending whether <code><a href="#topic+impute.incid">impute.incid()</a></code> is set to <code>FALSE</code> or <code>TRUE</code>.</p>
</td></tr>
<tr><td><code>epid.orig</code></td>
<td>
<p>Original epidemic data.</p>
</td></tr>
<tr><td><code>GT</code></td>
<td>
<p>Generation time distribution uised in the computation.</p>
</td></tr>
<tr><td><code>begin</code></td>
<td>
<p>Starting date for the fit.</p>
</td></tr>
<tr><td><code>begin.nb</code></td>
<td>
<p>The number of the first day used in the fit.</p>
</td></tr>
<tr><td><code>end</code></td>
<td>
<p>The end date for the fit.</p>
</td></tr>
<tr><td><code>end.nb</code></td>
<td>
<p>The number of the las day used for the fit.</p>
</td></tr>
<tr><td><code>pred</code></td>
<td>
<p>Prediction on the period used for the fit.</p>
</td></tr>
<tr><td><code>Rsquared</code></td>
<td>
<p>Correlation coefficient between predicted curve (by <code><a href="#topic+fit.epid">fit.epid()</a></code>) and observed epidemic curve.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Call used for the function.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Method used for fitting.</p>
</td></tr>
<tr><td><code>method.code</code></td>
<td>
<p>Internal code used to designate method.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is the implementation of the method provided by White &amp; Pagano (2009).
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>References</h3>

<p>White, L.F., J. Wallinga, L. Finelli, C. Reed, S. Riley, M. Lipsitch, and M. Pagano. &quot;Estimation of the Reproductive Number and the Serial Interval in Early Phase of the 2009 Influenza A/H1N1 Pandemic in the USA.&quot; Influenza and Other Respiratory Viruses 3, no. 6 (2009): 267-276.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

## Data is taken from paper by Nishiura for key transmission parameters of an institutional
## outbreak during the 1918 influenza pandemic in Germany)

data(Germany.1918)
mGT &lt;- generation.time("gamma", c(2.45, 1.38))
est.R0.ML(Germany.1918, mGT, begin=1, end=27, range=c(0.01,50))
# Reproduction number estimate using  Maximum Likelihood  method.
# R :  1.307222[ 1.236913 , 1.380156 ]

res &lt;- est.R0.ML(Germany.1918, mGT, begin=1, end=27, range=c(0.01,50))
plot(res)

## no change in R with varying range 
## (dates here are the same index as before. Just to illustrate different use)
est.R0.ML(Germany.1918, mGT, begin="1918-09-29", end="1918-10-25", range=c(0.01,100))
# Reproduction number estimate using  Maximum Likelihood  method.
# R :  1.307249[ 1.236913 , 1.380185 ]


</code></pre>

<hr>
<h2 id='est.R0.SB'>Estimate the time dependent R using a Bayesian method</h2><span id='topic+est.R0.SB'></span>

<h3>Description</h3>

<p>Estimate R by a sequential Bayesian method, using known data up to a point
in time as a Bayesian prior for the next iteration (see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.R0.SB(
  epid,
  GT,
  t = NULL,
  begin = NULL,
  end = NULL,
  date.first.obs = NULL,
  time.step = 1,
  force.prior = FALSE,
  checked = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est.R0.SB_+3A_epid">epid</code></td>
<td>
<p>Object containing epidemic curve data.</p>
</td></tr>
<tr><td><code id="est.R0.SB_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="est.R0.SB_+3A_t">t</code></td>
<td>
<p>Vector of dates at which incidence was observed.</p>
</td></tr>
<tr><td><code id="est.R0.SB_+3A_begin">begin</code></td>
<td>
<p>At what time estimation begins (unused by this method, just there for plotting purposes).</p>
</td></tr>
<tr><td><code id="est.R0.SB_+3A_end">end</code></td>
<td>
<p>At what time estimation ends (unused by this method, just there for plotting purposes).</p>
</td></tr>
<tr><td><code id="est.R0.SB_+3A_date.first.obs">date.first.obs</code></td>
<td>
<p>Optional date of first observation, if <code>t</code> not specified.</p>
</td></tr>
<tr><td><code id="est.R0.SB_+3A_time.step">time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td></tr>
<tr><td><code id="est.R0.SB_+3A_force.prior">force.prior</code></td>
<td>
<p>Set to any custom value to force the initial prior as a uniform distribution on [0 ; value].</p>
</td></tr>
<tr><td><code id="est.R0.SB_+3A_checked">checked</code></td>
<td>
<p>Internal flag used to check whether integrity checks were ran or not.</p>
</td></tr>
<tr><td><code id="est.R0.SB_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by <code><a href="#topic+estimate.R">estimate.R()</a></code>.
</p>
<p>Initial prior is an unbiased uniform distribution for R, between 0 and the maximum
of incid(t+1) - incid(t). For each subsequent iteration, a new distribution is
computed for R, using the previous output as new prior.
</p>
<p>The 95% confidence intervan is achieved by a cumulative sum of the posterior
distirbution of R and corresponds to the 2.5-th and 97.5-th percentiles.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>R</code></td>
<td>
<p>vector of R values.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>95% confidence interval for estimates.</p>
</td></tr>
<tr><td><code>proba.Rt</code></td>
<td>
<p>A list with successive distribution for R throughout the outbreak.</p>
</td></tr>
<tr><td><code>GT</code></td>
<td>
<p>Generation time distribution used in the computation.</p>
</td></tr>
<tr><td><code>epid</code></td>
<td>
<p>Original epidemic data.</p>
</td></tr>
<tr><td><code>begin</code></td>
<td>
<p>Begin date for the fit.</p>
</td></tr>
<tr><td><code>begin.nb</code></td>
<td>
<p>Index of begin date for the fit.</p>
</td></tr>
<tr><td><code>end</code></td>
<td>
<p>End date for the fit.</p>
</td></tr>
<tr><td><code>end.nb</code></td>
<td>
<p>Index of end date for the fit.</p>
</td></tr>
<tr><td><code>pred</code></td>
<td>
<p>Predictive curve based on most-likely R value.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>Name of the data used in the fit.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Complete call used to generate results.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Method for estimation.</p>
</td></tr>
<tr><td><code>method.code</code></td>
<td>
<p>Internal code used to designate method.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is the implementation of the method provided by Bettencourt &amp; Ribeiro (2008).
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>References</h3>

<p>Bettencourt, L.M.A., and R.M. Ribeiro. &quot;Real Time Bayesian Estimation of the Epidemic Potential of Emerging Infectious Diseases.&quot; PLoS One 3, no. 5 (2008): e2185.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

## Data is taken from the paper by Nishiura for key transmission parameters of an institutional
## outbreak during 1918 influenza pandemic in Germany)

data(Germany.1918)
mGT &lt;- generation.time("gamma", c(3,1.5))
SB &lt;- est.R0.SB(Germany.1918, mGT)

## Results will include "most likely R(t)" (ie. the R(t) value for which the computed probability 
## is the highest), along with 95% CI, in a data.frame object
SB
# Reproduction number estimate using  Real Time Bayesian  method.
# 0 0 2.02 0.71 1.17 1.7 1.36 1.53 1.28 1.43 ...

SB$Rt.quant
# Date R.t. CI.lower. CI.upper.
# 1  1918-09-29 0.00      0.01      1.44
# 2  1918-09-30 0.00      0.01      1.42
# 3  1918-10-01 2.02      0.97      2.88
# 4  1918-10-02 0.71      0.07      1.51
# 5  1918-10-03 1.17      0.40      1.84
# 6  1918-10-04 1.70      1.09      2.24
# 7  1918-10-05 1.36      0.84      1.83
# 8  1918-10-06 1.53      1.08      1.94
# 9  1918-10-07 1.28      0.88      1.66
# 10 1918-10-08 1.43      1.08      1.77
# ...

## "Plot" will provide the most-likely R value at each time unit, along with 95CI
plot(SB)
## "Plotfit" will show the complete distribution of R for 9 time unit throughout the outbreak
plotfit(SB)
</code></pre>

<hr>
<h2 id='est.R0.TD'>Estimate the Time-Dependent reproduction number</h2><span id='topic+est.R0.TD'></span>

<h3>Description</h3>

<p>Estimate the Time-Dependent reproduction number, <code class="reqn">R(t)</code>, as defined by
Wallinga &amp; Teunis, by exploring all possible pairs of infectors/infectees
across likely transmission trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.R0.TD(
  epid,
  GT,
  import = NULL,
  n.t0 = NULL,
  t = NULL,
  begin = NULL,
  end = NULL,
  date.first.obs = NULL,
  time.step = 1,
  q = c(0.025, 0.975),
  correct = TRUE,
  nsim = 10000,
  checked = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est.R0.TD_+3A_epid">epid</code></td>
<td>
<p>Object containing epidemic curve data.</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_import">import</code></td>
<td>
<p>Vector of imported cases.</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_n.t0">n.t0</code></td>
<td>
<p>Initial number of cases at the beginning of the outbreak.</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_t">t</code></td>
<td>
<p>Vector of dates at which incidence was observed.</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_begin">begin</code></td>
<td>
<p>At what time estimation begins (unused by this method, just there for plotting purposes).</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_end">end</code></td>
<td>
<p>At what time estimation ends (unused by this method, just there for plotting purposes).</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_date.first.obs">date.first.obs</code></td>
<td>
<p>Optional date of first observation, if <code>t</code> not specified.</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_time.step">time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_q">q</code></td>
<td>
<p>Quantiles for R(t) confidence level. By default, 2.5% and 97.5%.</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_correct">correct</code></td>
<td>
<p>Boolean. Correction for cases not yet observed (real time).</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations to be run to compute quantiles for R(t)</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_checked">checked</code></td>
<td>
<p>Internal flag used to check whether integrity checks were ran or not.</p>
</td></tr>
<tr><td><code id="est.R0.TD_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by <code><a href="#topic+estimate.R">estimate.R()</a></code>.
</p>
<p>The confidence interval is computed by multinomial simulations at each time step,
using the expected value of R.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>R</code></td>
<td>
<p>vector of R values.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>95% confidence interval for estimates.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Matrix of who infected whom.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Probability of who infected whom (values achieved by normalizing P matrix).</p>
</td></tr>
<tr><td><code>GT</code></td>
<td>
<p>Generation time distribution used in the computation.</p>
</td></tr>
<tr><td><code>epid</code></td>
<td>
<p>Original epidemic data.</p>
</td></tr>
<tr><td><code>import</code></td>
<td>
<p>Vector of imported cases.</p>
</td></tr>
<tr><td><code>pred</code></td>
<td>
<p>Theoretical epidemic data, computed with estimated values of R.</p>
</td></tr>
<tr><td><code>begin</code></td>
<td>
<p>Starting date for the fit.</p>
</td></tr>
<tr><td><code>begin.nb</code></td>
<td>
<p>The number of the first day used in the fit.</p>
</td></tr>
<tr><td><code>end</code></td>
<td>
<p>The end date for the fit.</p>
</td></tr>
<tr><td><code>end.nb</code></td>
<td>
<p>The number of the last day used for the fit.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>Name of the data used in the fit.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Call used for the function.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Method for estimation.</p>
</td></tr>
<tr><td><code>method.code</code></td>
<td>
<p>Internal code used to designate method.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is the implementation of the method provided by Wallinga &amp; Teunis (2004).
Correction for estimation in real time is implemented as in Cauchemez et al, AJE (2006).
</p>
<p>If imported cases are provided, they are counted in addition to autonomous cases.
The final plot will show overall incidence.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>References</h3>

<p>Wallinga, J., and Teunis P. &quot;Different Epidemic Curves for Severe Acute Respiratory Syndrome Reveal Similar Impacts of Control Measures.&quot; American Journal of Epidemiology 160, no. 6 (2004): 509. <br />
Cauchemez S., and Valleron AJ. &quot;Estimating in Real Time the Efficacy of Measures to Control Emerging Communicable Diseases&quot; American Journal of Epidemiology 164, no. 6 (2006): 591.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

## Data is taken from the paper by Nishiura for key transmission parameters of an institutional
## outbreak during 1918 influenza pandemic in Germany)

data(Germany.1918)
mGT &lt;- generation.time("gamma", c(3, 1.5))
TD &lt;- est.R0.TD(Germany.1918, mGT, begin=1, end=126, nsim=100)
# Warning messages:
# 1: In est.R0.TD(Germany.1918, mGT) : Simulations may take several minutes.
# 2: In est.R0.TD(Germany.1918, mGT) : Using initial incidence as initial number of cases.
TD
# Reproduction number estimate using  Time-Dependent  method.
# 2.322239 2.272013 1.998474 1.843703 2.019297 1.867488 1.644993 1.553265 1.553317 1.601317 ...

## An interesting way to look at these results is to agregate initial data by longest time unit,
## such as weekly incidence. This gives a global overview of the epidemic.
TD.weekly &lt;- smooth.Rt(TD, 7)
TD.weekly
# Reproduction number estimate using  Time-Dependant  method.
# 1.878424 1.580976 1.356918 1.131633 0.9615463 0.8118902 0.8045254 0.8395747 0.8542518 0.8258094..
plot(TD.weekly)
</code></pre>

<hr>
<h2 id='estimate.R'>Estimate reproduction number (R0 or Rt) for one incidence dataset using
available methods</h2><span id='topic+estimate.R'></span>

<h3>Description</h3>

<p>Estimate <code class="reqn">R_{0}</code> or <code class="reqn">R(t)</code> for an incidence dataset using
the methods implemented in the <code>R0</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate.R(
  epid = NULL,
  GT = NULL,
  t = NULL,
  begin = NULL,
  end = NULL,
  date.first.obs = NULL,
  time.step = 1,
  AR = NULL,
  pop.size = NULL,
  S0 = 1,
  methods = NULL,
  checked = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate.R_+3A_epid">epid</code></td>
<td>
<p>Object containing epidemic curve data.</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_t">t</code></td>
<td>
<p>Vector of dates at which incidence was observed.</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_begin">begin</code></td>
<td>
<p>Begin date for estimation. Can be an integer or a date (YYYY-mm-dd or YYYY/mm/dd).</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_end">end</code></td>
<td>
<p>End date for estimation. Can be an integer or a date (YYYY-mm-dd or YYYY/mm/dd).</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_date.first.obs">date.first.obs</code></td>
<td>
<p>Optional date of first observation, if <code>t</code> not specified.</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_time.step">time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_ar">AR</code></td>
<td>
<p>Attack rate as a percentage from total population.</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_pop.size">pop.size</code></td>
<td>
<p>Population size in which the incident cases were observed. See more details in <code><a href="#topic+est.R0.AR">est.R0.AR()</a></code> documentation.</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_s0">S0</code></td>
<td>
<p>Initial proportion of the population considered susceptible.</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_methods">methods</code></td>
<td>
<p>Vector of methods to be used for R/R0/Rt estimation. Must be provided as <code>c("method 1", "method 2", ...)</code>.</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_checked">checked</code></td>
<td>
<p>Internal flag used to check whether integrity checks were ran or not.</p>
</td></tr>
<tr><td><code id="estimate.R_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, supported methods are Exponential Growth (EG), Maximum Likelihood (ML),
Attack Rate (AR), Time-Dependant (TD), and Sequential Bayesian (SB).
The corresponding references from the literature are available below.
</p>
<p>This function acts as a front-end and will prepare relevant inputs to pass them
to internal estimation routines. In particular, all inputs will undergo
validation through <code><a href="#topic+integrity.checks">integrity.checks()</a></code> and the <code>checked</code> flag (defaulting as
<code>TRUE</code> here) will be passed to internal estimation routines.
Any warning raised by <code><a href="#topic+integrity.checks">integrity.checks()</a></code> should warrant careful thinking
and investigation.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>estimates</code></td>
<td>
<p>List containing all results from called methods.</p>
</td></tr>
<tr><td><code>epid</code></td>
<td>
<p>Epidemic curve.</p>
</td></tr>
<tr><td><code>GT</code></td>
<td>
<p>Generation Time distribution function.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>Date vector.</p>
</td></tr>
<tr><td><code>begin</code></td>
<td>
<p>Begin date for estimation.</p>
</td></tr>
<tr><td><code>end</code></td>
<td>
<p>End date for estimation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>References</h3>

<p><code><a href="#topic+est.R0.AR">est.R0.AR()</a></code> : Dietz, K. &quot;The Estimation of the Basic Reproduction Number for Infectious Diseases.&quot; Statistical Methods in Medical Research 2, no. 1 (March 1, 1993): 23-41. <br />
<code><a href="#topic+est.R0.EG">est.R0.EG()</a></code> : Wallinga, J., and M. Lipsitch. &quot;How Generation Intervals Shape the Relationship Between Growth Rates and Reproductive Numbers.&quot; Proceedings of the Royal Society B: Biological Sciences 274, no. 1609 (2007): 599. <br />
<code><a href="#topic+est.R0.ML">est.R0.ML()</a></code> : White, L.F., J. Wallinga, L. Finelli, C. Reed, S. Riley, M. Lipsitch, and M. Pagano. &quot;Estimation of the Reproductive Number and the Serial Interval in Early Phase of the 2009 Influenza A/H1N1 Pandemic in the USA.&quot; Influenza and Other Respiratory Viruses 3, no. 6 (2009): 267-276. <br />
<code><a href="#topic+est.R0.SB">est.R0.SB()</a></code> : Bettencourt, L.M.A., and R.M. Ribeiro. &quot;Real Time Bayesian Estimation of the Epidemic Potential of Emerging Infectious Diseases.&quot; PLoS One 3, no. 5 (2008): e2185. <br />
<code><a href="#topic+est.R0.TD">est.R0.TD()</a></code> : Wallinga, J., and P. Teunis. &quot;Different Epidemic Curves for Severe Acute Respiratory Syndrome Reveal Similar Impacts of Control Measures.&quot; American Journal of Epidemiology 160, no. 6 (2004): 509; Cauchemez S., and Valleron AJ. &quot;Estimating in Real Time the Efficacy of Measures to Control Emerging Communicable Diseases&quot; American Journal of Epidemiology 164, no. 6 (2006): 591.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

## Outbreak during 1918 influenza pandemic in Germany)
data(Germany.1918)
mGT &lt;- generation.time("gamma", c(3, 1.5))
estR0 &lt;- estimate.R(Germany.1918, mGT, begin=1, end=27, methods=c("EG", "ML", "TD", "AR", "SB"), 
                  pop.size=100000, nsim=100)

attributes(estR0)
## $names
## [1] "epid"      "GT"        "begin"     "end"       "estimates"
## 
## $class
## [1] "R0.sR"

## Estimates results are stored in the $estimates object
estR0
## Reproduction number estimate using  Exponential Growth  method.
## R :  1.525895[ 1.494984 , 1.557779 ]
## 
## Reproduction number estimate using  Maximum Likelihood  method.
## R :  1.383996[ 1.309545 , 1.461203 ]
## 
## Reproduction number estimate using  Attack Rate  method.
## R :  1.047392[ 1.046394 , 1.048393 ]
## 
## Reproduction number estimate using  Time-Dependent  method.
## 2.322239 2.272013 1.998474 1.843703 2.019297 1.867488 1.644993 1.553265 1.553317 1.601317 ...
## 
## Reproduction number estimate using  Sequential Bayesian  method.
## 0 0 2.22 0.66 1.2 1.84 1.43 1.63 1.34 1.52 ...


## If no date vector nor date of first observation are provided, results are the same
## except time values in $t are replaced by index
</code></pre>

<hr>
<h2 id='fit.epid'>Poisson log-likelihood for an observed epidemic</h2><span id='topic+fit.epid'></span>

<h3>Description</h3>

<p>Computes the Poisson log-likelihood of an observed epidemic, compared to the
expected incidence values for a given R and generation time distirbution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.epid(log.R, epid, GT, import, pred = FALSE, offset = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.epid_+3A_log.r">log.R</code></td>
<td>
<p>The log-reproduction ratio.</p>
</td></tr>
<tr><td><code id="fit.epid_+3A_epid">epid</code></td>
<td>
<p>An epidemic curve, in the sense of passing <code><a href="#topic+check.incid">check.incid()</a></code> validations. It must have at least an incidence vector in an <code>incid</code> component.</p>
</td></tr>
<tr><td><code id="fit.epid_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="fit.epid_+3A_import">import</code></td>
<td>
<p>Vector of imported cases</p>
</td></tr>
<tr><td><code id="fit.epid_+3A_pred">pred</code></td>
<td>
<p>Boolean. By default (<code>FALSE</code>), the function returns the corresponding log-likelihood. When set to <code>TRUE</code>, the function will return the Poisson-predicted incidence series instead.</p>
</td></tr>
<tr><td><code id="fit.epid_+3A_offset">offset</code></td>
<td>
<p>Offset value for the log-likelihood (used to calculate confidence intervals).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called from <code><a href="#topic+est.R0.ML">est.R0.ML()</a></code>.
</p>
<p>Computes and returns the Poisson log-likelihood of an observed epidemic,
conditional on a given value of R and a generation time distribution.
</p>


<h3>Value</h3>

<p>The Poisson log-likelihood of the observed epidemic passed as argument <code>epid</code>,
or the Poisson-predicted incidence series given R and GT values.
</p>


<h3>Note</h3>

<p>This function is also used in <code><a href="#topic+fit.epid.optim">fit.epid.optim()</a></code>, which is a wrapper for the
joint optimization routine to determine the best-fitting R and GT values when
the <code><a href="#topic+est.R0.ML">est.R0.ML()</a></code> method is called and asked to jointly estimate reproduction
ratios and generation time distirbution.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='fit.epid.optim'>Joint estimation of R and generation time distribution for the ML method</h2><span id='topic+fit.epid.optim'></span>

<h3>Description</h3>

<p>An objective function, wrapped around <code><a href="#topic+fit.epid">fit.epid()</a></code>, that will be passed to
<code><a href="stats.html#topic+optim">stats::optim()</a></code> to jointly estimate the best-fitting R and GT distributions
in the context of the Maximum-Likelihood method from <code><a href="#topic+est.R0.ML">est.R0.ML()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.epid.optim(par = c(1, 1, 1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.epid.optim_+3A_par">par</code></td>
<td>
<p>A vector of three numerical values to be optimized, in the order <code>c(log.R, GT$mean, GT$sd)</code>.</p>
</td></tr>
<tr><td><code id="fit.epid.optim_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called from <code><a href="#topic+est.R0.ML">est.R0.ML()</a></code>.
</p>
<p>This is a wrapper function used to pass proper arguments to <code><a href="#topic+fit.epid">fit.epid()</a></code> when
the ML method is used to estimate simultaneously R and GT. This function is
used as objective to maximize by <code><a href="stats.html#topic+optim">stats::optim()</a></code>.
</p>


<h3>Value</h3>

<p>A Poisson log-likelihood from <code><a href="#topic+fit.epid">fit.epid()</a></code>.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='generation.time'>Generation Time distribution</h2><span id='topic+generation.time'></span>

<h3>Description</h3>

<p>Create an object of class <code>GT</code> representing a discretized Generation Time
distribution, that can be subsequently passed to estimation routines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generation.time(
  type = c("empirical", "gamma", "weibull", "lognormal"),
  val = NULL,
  truncate = NULL,
  step = 1,
  first.half = TRUE,
  p0 = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generation.time_+3A_type">type</code></td>
<td>
<p>Type of distribution (can be any of <code>"empirical"</code>, <code>"gamma"</code>, <code>"weibull"</code>, or <code>"lognormal"</code>)</p>
</td></tr>
<tr><td><code id="generation.time_+3A_val">val</code></td>
<td>
<p>Vector of values used for the empirical distribution, or <code>c(mean, sd)</code> if parametric.</p>
</td></tr>
<tr><td><code id="generation.time_+3A_truncate">truncate</code></td>
<td>
<p>Maximum extent of the GT distribution.</p>
</td></tr>
<tr><td><code id="generation.time_+3A_step">step</code></td>
<td>
<p>Time step used in discretization.</p>
</td></tr>
<tr><td><code id="generation.time_+3A_first.half">first.half</code></td>
<td>
<p>Boolean. When set to <code>TRUE</code> (default), the first probability is computed on a half period.</p>
</td></tr>
<tr><td><code id="generation.time_+3A_p0">p0</code></td>
<td>
<p>Boolen. When set to <code>TRUE</code> the probability on day 0 is forced to 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>How the GT is discretized may have some impact on the shape of the distribution.
For example, the distribution may be discretized in intervals of 1 time step
starting at time 0, i.e. [0,1), [1,2), and so on. Or it may be discretized as
[0,0.5), [0.5, 1.5), ... (the default).
</p>
<p>If the GT is discretized from a given continuous distribution, the expected
duration of the Generation Time will be less than the nominal, it will be in
better agreement using the second discretization (default behavior).
</p>
<p>If p0 is set to <code>TRUE</code> (default), the generation time distribution is set to 0 for
day 0, meaning that the infectees generated by an infected individual will not
become incident on the same day.
</p>
<p>If no truncation is provided, the distribution will be truncated at 99.99%
probability.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>GT</code></td>
<td>
<p>The probabilities for each time unit, starting at time 0.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>The time at which probabilities are calculated.</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>The mean of the discretized GT.</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>The standard deviation of the discretized GT.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

# GT for children at house(from Cauchemez PNAS 2011)

GT.chld.hsld1 &lt;- generation.time("empirical", c(0,0.25,0.2,0.15,0.1,0.09,0.05,0.01))
plot(GT.chld.hsld1, col="green")
GT.chld.hsld1
# Discretized Generation Time distribution
# mean: 2.729412 , sd: 1.611636 
# [1] 0.00000000 0.29411765 0.23529412 0.17647059 0.11764706 0.10588235 0.05882353
# [8] 0.01176471

GT.chld.hsld2 &lt;- generation.time("gamma", c(2.45, 1.38))
GT.chld.hsld2
# Discretized Generation Time distribution
# mean: 2.504038 , sd: 1.372760
# [1] 0.0000000000 0.2553188589 0.3247178420 0.2199060781 0.1144367560
# [6] 0.0515687896 0.0212246257 0.0082077973 0.0030329325 0.0010825594
#[11] 0.0003760069 0.0001277537


# GT for school &amp; community
GTs1 &lt;- generation.time("empirical", c(0,0.95,0.05))
plot(GTs1, col='blue')


plot(GT.chld.hsld1, ylim=c(0,0.5), col="red")
par(new=TRUE)
plot(GT.chld.hsld2, xlim=c(0,7), ylim=c(0,0.5), col="black")
</code></pre>

<hr>
<h2 id='Germany.1918'>Germany 1918 dataset</h2><span id='topic+Germany.1918'></span>

<h3>Description</h3>

<p>This dataset is used as an example in the <code>R0</code> package to estimate reproduction
ratios using the available methods. It is the emporal distribution of Spanish
flu in Prussia, Germany, from the 1918-19 influenza epidemic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Germany.1918)
</code></pre>


<h3>Format</h3>

<p>A vector of numeric values named with date of record.
</p>


<h3>References</h3>

<p>Peiper O: Die Grippe-Epidemie in Preussen im Jahre 1918/19. Veroeffentlichungen aus dem Gebiete der Medizinalverwaltung 1920, 10:  417-479 (in German). <br />
Nishiura H. Time variations in the transmissibility of pandemic influenza in Prussia, Germany, from 1918-19. In: Theoretical Biology and Medical Modelling
</p>

<hr>
<h2 id='get.scale'>Scaling of x-axis</h2><span id='topic+get.scale'></span>

<h3>Description</h3>

<p>Internal scaling function to display proper x-axis labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.scale(scale)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.scale_+3A_scale">scale</code></td>
<td>
<p>Scale to be adjusted on x-axis. Can be <code>d</code> (day), <code>w</code> (week (default)), <code>f</code> (fornight), <code>m</code> (month).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Builds the x-axis labels corresponding to a human-friendly level (day, week...).
</p>


<h3>Value</h3>

<p>An integer corresponding to the number of days between each x-axis tickmark.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='GT.chld.hsld'>2009 A/H1N1 observed generation time distribution</h2><span id='topic+GT.chld.hsld'></span>

<h3>Description</h3>

<p>Observed generation time distribution for children in household for the 2009
A/H1N1 influenza pandemic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GT.chld.hsld)
</code></pre>


<h3>Format</h3>

<p>A vector of unnamed numeric values.
</p>


<h3>References</h3>

<p>S. Cauchemez, A. Bhattarai, T.L. Marchbanks, R.P. Fagan, S. Ostroff, N.M. Ferguson, et al., Role of Social Networks in Shaping Disease Transmission During a Community Outbreak of 2009 H1N1 Pandemic Influenza, Pnas. 108 (2011) 2825-2830.
</p>

<hr>
<h2 id='H1N1.serial.interval'>H1N1 serial interval</h2><span id='topic+H1N1.serial.interval'></span>

<h3>Description</h3>

<p>Serial interval (in its core definition, i.e. the time delay between symptom
onset between pairs of infectors and infectees), taken from traced cases of
H1N1 viruses.
</p>
<p>Vector of values that represents the time lag between symptoms onset for pairs
of infector/infectee, for a dataset of complete traced cases. Each value
accounts for a pair of infector/infectee.
This serial interval is often substitued for the generation time distribution,
as it is easier to observe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(H1N1.serial.interval)
</code></pre>


<h3>Format</h3>

<p>A vector of unnamed numeric values.
</p>


<h3>References</h3>

<p>S. Cauchemez, A. Bhattarai, T.L. Marchbanks, R.P. Fagan, S. Ostroff, N.M. Ferguson, et al., Role of Social Networks in Shaping Disease Transmission During a Community Outbreak of 2009 H1N1 Pandemic Influenza, Pnas. 108 (2011) 2825-2830.
</p>

<hr>
<h2 id='impute.incid'>Impute censored cases to rebuild longer epidemic vector</h2><span id='topic+impute.incid'></span>

<h3>Description</h3>

<p>When first records of incidence are unavailable, tries to impute censored
cases to rebuild a longer epidemic vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impute.incid(CD.optim.vect, CD.epid, CD.R0, CD.GT)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impute.incid_+3A_cd.optim.vect">CD.optim.vect</code></td>
<td>
<p>Vector of two elements (<code style="white-space: pre;">&#8288;c(multiplicative factor, log(highest imputed data))&#8288;</code>) to be optimized.</p>
</td></tr>
<tr><td><code id="impute.incid_+3A_cd.epid">CD.epid</code></td>
<td>
<p>Original epidemic vector, output of <code><a href="#topic+check.incid">check.incid()</a></code>.</p>
</td></tr>
<tr><td><code id="impute.incid_+3A_cd.r0">CD.R0</code></td>
<td>
<p>Assumed R0 value for the original epidemic vector.</p>
</td></tr>
<tr><td><code id="impute.incid_+3A_cd.gt">CD.GT</code></td>
<td>
<p>Generation time distribution to be used for computations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is not intended for stand-alone use. It optimizes the values
of vect, based upon minimization of deviation between actual epidemics data
and observed generation time. The optimized function is <code><a href="#topic+censored.deviation">censored.deviation()</a></code>,
which returns the deviation used for minimization. Stand-alone use can be
conducted, however this assumes data are all of the correct format.
</p>


<h3>Value</h3>

<p>A vector with both imputed incidence and source available data.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='inspect.data'>Audit input data for common issues</h2><span id='topic+inspect.data'></span>

<h3>Description</h3>

<p>Inspect input data and look for common mistakes.
The function does not return any object but yields warnings wupon detecting
possible inconsistencies, along with suggestions as to how to clean inputs
before running estimation routines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inspect.data(incid, GT = NULL, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inspect.data_+3A_incid">incid</code></td>
<td>
<p>An object (vector, data.frame, list) storing incidence.</p>
</td></tr>
<tr><td><code id="inspect.data_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="inspect.data_+3A_t">t</code></td>
<td>
<p>Vector of dates at which incidence was observed (optional).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+inspect.data">inspect.data()</a></code> looks for common issues that could affect estimation routines.
Such issues include too low incidence counts, leading/trailing zeros,
non-integer values...
</p>
<p>Before any checks are conducted, the data are passed to <code><a href="#topic+check.incid">check.incid()</a></code> to
try and guess the format of the data.
</p>
<p>A not-so-uncommon issue is to provide non-integer counts for incidence, for
example when working with aggregated data that represent averaged number of
cases across different communities. This however does not agree well with
parametric likelihood that assume exponential growth over the early stage of
an epidemic or Poisson distribution of cases, where non-integer values will
cause calculations to fail.
</p>
<p>Missing values may cause issues if not handled properly. By default,
<code><a href="#topic+check.incid">check.incid()</a></code> will recast missing values to zero. Leading and trailing <code>NA</code>'s
should be omitted entirely from the input. Gaps found between available data
may also cause issues if they span over a period that's longer than the total
generation time. A warning is raised to inform on these possible issues.
</p>
<p>Likewise, leading and tailing zeros would cause similar issues. Begin will
default to the first value and end to the peak one. Just in case, these will
be inspected here too. Sequence of 0s exceeding the length of the generation
time will also yield a warning.
</p>
<p>Scarce data may also cause errors when optimizing likelihood functions.
A time-series of incidence spanning for a duration shorter than that of the
generation time distribution is likely to correspond to an index case that hasn't
yet infected all its offsprings. This would biais estimates downwards and should
be taken into account when interpreting results.
</p>


<h3>Value</h3>

<p>No object is returned. Instead, warnings are thrown upon detecting inconsistences.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='integrity.checks'>Integrity checks for input parameters</h2><span id='topic+integrity.checks'></span>

<h3>Description</h3>

<p>Before any requested estimation routine is ran, <code><a href="#topic+integrity.checks">integrity.checks()</a></code> is called
to ensure the data passed as arguments meet the proper format and can be
properly interpreted by subsequent functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrity.checks(
  epid,
  GT,
  t,
  begin,
  end,
  date.first.obs,
  time.step,
  AR,
  S0,
  methods
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integrity.checks_+3A_epid">epid</code></td>
<td>
<p>Epidemic dataset, expecting incidence counts in a varity of possible formats (see <code><a href="#topic+check.incid">check.incid()</a></code>).</p>
</td></tr>
<tr><td><code id="integrity.checks_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="integrity.checks_+3A_t">t</code></td>
<td>
<p>Vector of dates at which incidence was observed.</p>
</td></tr>
<tr><td><code id="integrity.checks_+3A_begin">begin</code></td>
<td>
<p>Begin date for estimation. Can be an integer or a date (YYYY-mm-dd or YYYY/mm/dd).</p>
</td></tr>
<tr><td><code id="integrity.checks_+3A_end">end</code></td>
<td>
<p>End date for estimation. Can be an integer or a date (YYYY-mm-dd or YYYY/mm/dd).</p>
</td></tr>
<tr><td><code id="integrity.checks_+3A_date.first.obs">date.first.obs</code></td>
<td>
<p>Optional date of first observation, if <code>t</code> not specified.</p>
</td></tr>
<tr><td><code id="integrity.checks_+3A_time.step">time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td></tr>
<tr><td><code id="integrity.checks_+3A_ar">AR</code></td>
<td>
<p>Attack rate as a percentage from total population.</p>
</td></tr>
<tr><td><code id="integrity.checks_+3A_s0">S0</code></td>
<td>
<p>Initial proportion of the population considered susceptible.</p>
</td></tr>
<tr><td><code id="integrity.checks_+3A_methods">methods</code></td>
<td>
<p>Vector of methods to be used for R/R0/Rt estimation. Must be provided as <code>c("method 1", "method 2", ...)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by all implemented estimation methods.
All integrity/class checks are handled by this core function. GT must be an
object of class <code>R0.GT</code>, and epidemic curve along with time values are handled
here. If you plan on calling manually any other estimation function, make sure
data are provided with correct format.
</p>
<p>The epidemic curve <code>epid</code> may be provided as a vector. In that case, a vector
<code>t</code> may be provided with the dates of observation. If <code>t</code> is not numeric, an
attempt is made to convert to dates with <code><a href="base.html#topic+as.Date">as.Date()</a></code>. If <code>t</code> is not provided,
dates are obtained from the names of incid, and if not available, index
values are used. Finally, one can provide an epidemic curve object generated by
the epitools package (see <code><a href="#topic+check.incid">check.incid()</a></code> for more details).
</p>
<p>A quick note on <code>t</code>, <code>begin</code> and <code>end</code> : when a date vector is provided (<code>t</code>),
it will be used instead of index values to establish a date-related incidence.
If no date vector is provided, then <code>begin</code> and <code>end</code> can still be forced to
<em>numeric</em> values. It then links to the corresponding index values for incidence
data. If a date vector is provided, <code>begin</code> and <code>end</code> can either be <em>numeric</em>
values or <em>dates</em>. If numeric, they will link to the correspondig index values
for incidence, and be afterward interpreted as the associated date. If date,
they will be directly associated to incidence data.
</p>
<p>Basicly, if specified, <code>begin</code> and <code>end</code> must always have the same class.
</p>


<h3>Value</h3>

<p>A list with two components, <code>begin</code> and  <code>end</code>.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plot.R0.GT'>Plot a generation time distribution</h2><span id='topic+plot.R0.GT'></span>

<h3>Description</h3>

<p>Plots the distribution of a generation time object from <code><a href="#topic+generation.time">generation.time()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'R0.GT'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.R0.GT_+3A_x">x</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.R0.GT_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by <code><a href="base.html#topic+print">base::print()</a></code>.
</p>


<h3>Value</h3>

<p>Called for side effect. Shows a plot of the generation time distribution.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plot.R0.R'>Plot the R0/Rt value along with confidence interval</h2><span id='topic+plot.R0.R'></span>

<h3>Description</h3>

<p>Generates the graphical output for an estimated <code class="reqn">R</code> or <code class="reqn">R(t)</code>. The
graph depends on the estimation method. In general, the estimated value is
presented along with its confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'R0.R'
plot(x, xscale = "w", TD.split = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.R0.R_+3A_x">x</code></td>
<td>
<p>An estimated object, output from <code>est.R0.xx()</code> routines (class <code>R0.R</code>).</p>
</td></tr>
<tr><td><code id="plot.R0.R_+3A_xscale">xscale</code></td>
<td>
<p>Scale to be adjusted on x-axis. Can be <code>d</code> (day), <code>w</code> (week (default)), <code>f</code> (fornight), <code>m</code> (month).</p>
</td></tr>
<tr><td><code id="plot.R0.R_+3A_td.split">TD.split</code></td>
<td>
<p>Boolean. Parameter to force the display of both <code class="reqn">R(t)</code> and the epidemic curve in the same window for the TD method.</p>
</td></tr>
<tr><td><code id="plot.R0.R_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. This function is called when using <code><a href="#topic+plot.R0.sR">plot.R0.sR()</a></code>.
</p>
<p>This is a wrapper function that will call the correct plotting routine
depending on which method was used to estimate a reproduction number.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect. Draws all <code class="reqn">R_{0}</code> or /eqnR(t) values from one estimation method.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plot.R0.S'>Plot of sensitivity analyses.</h2><span id='topic+plot.R0.S'></span>

<h3>Description</h3>

<p>Generates the graphical output for an object generated through
<code><a href="#topic+sensitivity.analysis">sensitivity.analysis()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'R0.S'
plot(x, what = "heatmap", time.step = 1, skip = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.R0.S_+3A_x">x</code></td>
<td>
<p>Output of <code><a href="#topic+sensitivity.analysis">sensitivity.analysis()</a></code> (class <code>R0.S</code>)</p>
</td></tr>
<tr><td><code id="plot.R0.S_+3A_what">what</code></td>
<td>
<p>Specify the desired output. Can be <code>"heatmap"</code> (default), <code>"criterion"</code> or both.</p>
</td></tr>
<tr><td><code id="plot.R0.S_+3A_time.step">time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td></tr>
<tr><td><code id="plot.R0.S_+3A_skip">skip</code></td>
<td>
<p>Number of results to ignore (time period in days) when looking for highest Rsquared value.</p>
</td></tr>
<tr><td><code id="plot.R0.S_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by <code><a href="base.html#topic+plot">base::plot()</a></code> when applied to <code>R0.S</code> objects.
A plot will be shown and the best model fit will be returned.
</p>


<h3>Value</h3>

<p>A list with best R0 measure for each possible time period, along with corresponding begin/end dates.
</p>
<table>
<tr><td><code>max.Rsquared</code></td>
<td>
<p>The highest R-squared values.</p>
</td></tr>
<tr><td><code>best.R0.values</code></td>
<td>
<p>The corresponding <code class="reqn">R_{0}</code> values.</p>
</td></tr>
<tr><td><code>best.fit</code></td>
<td>
<p>The best model fit as defined by the highest R-squared values among all returned.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plot.R0.sR'>Plot the R0/Rt value along with confidence interval</h2><span id='topic+plot.R0.sR'></span>

<h3>Description</h3>

<p>Generates the graphical output for estimated <code class="reqn">R</code> or <code class="reqn">R(t)</code> fits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'R0.sR'
plot(x, xscale = "w", TD.split = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.R0.sR_+3A_x">x</code></td>
<td>
<p>An output of <code><a href="#topic+estimate.R">estimate.R()</a></code> (class <code>R0.sR</code>)</p>
</td></tr>
<tr><td><code id="plot.R0.sR_+3A_xscale">xscale</code></td>
<td>
<p>Scale to be adjusted on x-axis. Can be <code>d</code> (day), <code>w</code> (week (default)), <code>f</code> (fornight), <code>m</code> (month).</p>
</td></tr>
<tr><td><code id="plot.R0.sR_+3A_td.split">TD.split</code></td>
<td>
<p>Boolean. Parameter to force the display of both <code class="reqn">R(t)</code> and the epidemic curve in the same window for the TD method.</p>
</td></tr>
<tr><td><code id="plot.R0.sR_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by [base::plot())].
</p>
<p>Tweaked [base::plot()] function that draws the reproduction number values
for each method contained in the object constructed by [estimate.R()].
</p>
<p>[base::plot())]: R:base::plot())
[base::plot()]: R:base::plot()
[estimate.R()]: R:estimate.R()
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect. Draws all <code class="reqn">R_{0}</code> or /eqnR(t) values from an
output of <code><a href="#topic+estimate.R">estimate.R()</a></code>, built with one or more methods.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plotfit'>S3 method for objects of class <code>R0.R</code> or <code>R0.sR</code></h2><span id='topic+plotfit'></span>

<h3>Description</h3>

<p>This method ensures compliance with CRAN checks etc. It is used to properly
call <code><a href="#topic+plotfit.R0.R">plotfit.R0.R()</a></code> and <code><a href="#topic+plotfit.R0.sR">plotfit.R0.sR()</a></code> and build corresponding plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotfit(x, xscale = "w", SB.dist = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotfit_+3A_x">x</code></td>
<td>
<p>An output of <code><a href="#topic+estimate.R">estimate.R()</a></code> (class <code>R0.sR</code>) or <code>est.R0.xx()</code> (class <code>R0.R</code>).</p>
</td></tr>
<tr><td><code id="plotfit_+3A_xscale">xscale</code></td>
<td>
<p>Scale to be adjusted on x-axis. Can be <code>d</code> (day), <code>w</code> (week (default)), <code>f</code> (fornight), <code>m</code> (month).</p>
</td></tr>
<tr><td><code id="plotfit_+3A_sb.dist">SB.dist</code></td>
<td>
<p>Boolean. Should the R distirbution throughout the epidemic be plotted for the SB method (defaults to <code>TRUE</code>) ?</p>
</td></tr>
<tr><td><code id="plotfit_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use.
</p>
<p>This method is designed to either call <code><a href="#topic+plotfit.R0.R">plotfit.R0.R()</a></code> or <code><a href="#topic+plotfit.R0.sR">plotfit.R0.sR()</a></code>,
and complies with S3 requirements at the time of writing.
</p>
<p>It allows plotting the goodness-of-fit of an estimated model to the
original epidemic curve provided the user.
</p>
<p>Depending on the method of estimation, the graphical output will vary :
</p>

<ul>
<li><p> EG, ML and TD methods will show the original epidemic curve, along with the best-fitting prediction model,
</p>
</li>
<li><p> AR will only show the epidemic curve, since no actual model is computed,
</p>
</li>
<li><p> SB will display 9 density curves for the R distribution throughout the epidemic.
</p>
</li></ul>



<h3>Value</h3>

<p>This function does not return any data.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plotfit.R0.R'>Plot a model fit for <code>R0.R</code> objects</h2><span id='topic+plotfit.R0.R'></span>

<h3>Description</h3>

<p>Plot the fit of a single model output to epidemic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'R0.R'
plotfit(x, xscale = "w", SB.dist = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotfit.R0.R_+3A_x">x</code></td>
<td>
<p>An output of <code>est.R0.xx()</code> (class <code>R0.R</code>).</p>
</td></tr>
<tr><td><code id="plotfit.R0.R_+3A_xscale">xscale</code></td>
<td>
<p>Scale to be adjusted on x-axis. Can be <code>d</code> (day), <code>w</code> (week (default)), <code>f</code> (fornight), <code>m</code> (month).</p>
</td></tr>
<tr><td><code id="plotfit.R0.R_+3A_sb.dist">SB.dist</code></td>
<td>
<p>Boolean. Should the R distirbution throughout the epidemic be plotted for the SB method (defaults to <code>TRUE</code>) ?</p>
</td></tr>
<tr><td><code id="plotfit.R0.R_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. This function is called by the <code><a href="#topic+plotfit">plotfit()</a></code> S3 method.
Depending on the estimation method, either <code><a href="#topic+plotfitRxx">plotfitRxx()</a></code>, <code><a href="#topic+plotfitRAR">plotfitRAR()</a></code> or
<code><a href="#topic+plotfitRSB">plotfitRSB()</a></code> will be called.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect. Draws the fit of one estimation method to the data.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plotfit.R0.sR'>Plot a model fit for <code>R0.sR</code> objects</h2><span id='topic+plotfit.R0.sR'></span>

<h3>Description</h3>

<p>Plot the fit of model outputs to epidemic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'R0.sR'
plotfit(x, xscale = "w", SB.dist = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotfit.R0.sR_+3A_x">x</code></td>
<td>
<p>An output of <code><a href="#topic+estimate.R">estimate.R()</a></code> (class <code>R0.sR</code>).</p>
</td></tr>
<tr><td><code id="plotfit.R0.sR_+3A_xscale">xscale</code></td>
<td>
<p>Scale to be adjusted on x-axis. Can be <code>d</code> (day), <code>w</code> (week (default)), <code>f</code> (fornight), <code>m</code> (month).</p>
</td></tr>
<tr><td><code id="plotfit.R0.sR_+3A_sb.dist">SB.dist</code></td>
<td>
<p>Boolean. Should the R distirbution throughout the epidemic be plotted for the SB method (defaults to <code>TRUE</code>) ?</p>
</td></tr>
<tr><td><code id="plotfit.R0.sR_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. This function is called by the <code><a href="#topic+plotfit">plotfit()</a></code> S3 method.
It will sequentialy call the necesary <code><a href="#topic+plotfit">plotfit()</a></code> methods for each estimation
contained in the <code>x</code> argument.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect. Draws the fit of one or more estimation method to the
data.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plotfitRAR'>Internal plotfit method for AR estimates</h2><span id='topic+plotfitRAR'></span>

<h3>Description</h3>

<p>Plot the fit of a single model output to epidemic data when the method is AR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotfitRAR(x, xscale, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotfitRAR_+3A_x">x</code></td>
<td>
<p>An output of <code><a href="#topic+est.R0.AR">est.R0.AR()</a></code> (class <code>R0.R</code>).</p>
</td></tr>
<tr><td><code id="plotfitRAR_+3A_xscale">xscale</code></td>
<td>
<p>Scale to be adjusted on x-axis. Can be <code>d</code> (day), <code>w</code> (week (default)), <code>f</code> (fornight), <code>m</code> (month).</p>
</td></tr>
<tr><td><code id="plotfitRAR_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. This function is called by the <code><a href="#topic+plotfit.R0.R">plotfit.R0.R()</a></code>.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect. Draws the fit of one estimation method to the data.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plotfitRSB'>Internal plotfit method for AR estimates</h2><span id='topic+plotfitRSB'></span>

<h3>Description</h3>

<p>Plot the fit of a single model output to epidemic data when the method is SB.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotfitRSB(x, xscale, SB.dist, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotfitRSB_+3A_x">x</code></td>
<td>
<p>An output of <code><a href="#topic+est.R0.SB">est.R0.SB()</a></code> (class <code>R0.R</code>).</p>
</td></tr>
<tr><td><code id="plotfitRSB_+3A_xscale">xscale</code></td>
<td>
<p>Scale to be adjusted on x-axis. Can be <code>d</code> (day), <code>w</code> (week (default)), <code>f</code> (fornight), <code>m</code> (month).</p>
</td></tr>
<tr><td><code id="plotfitRSB_+3A_sb.dist">SB.dist</code></td>
<td>
<p>Boolean. Should the R distirbution throughout the epidemic be plotted for the SB method (defaults to <code>TRUE</code>) ?</p>
</td></tr>
<tr><td><code id="plotfitRSB_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. This function is called by the <code><a href="#topic+plotfit.R0.R">plotfit.R0.R()</a></code>.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect. Draws the fit of one estimation method to the data.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plotfitRxx'>Internal plotfit method for EG, ML and TD estimates</h2><span id='topic+plotfitRxx'></span>

<h3>Description</h3>

<p>Plot the fit of a single model output to epidemic data when the method is
EG, ML or TD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotfitRxx(x, xscale, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotfitRxx_+3A_x">x</code></td>
<td>
<p>An output of <code><a href="#topic+est.R0.EG">est.R0.EG()</a></code>, <code><a href="#topic+est.R0.ML">est.R0.ML()</a></code> or <code><a href="#topic+est.R0.TD">est.R0.TD()</a></code> (class <code>R0.R</code>).</p>
</td></tr>
<tr><td><code id="plotfitRxx_+3A_xscale">xscale</code></td>
<td>
<p>Scale to be adjusted on x-axis. Can be <code>d</code> (day), <code>w</code> (week (default)), <code>f</code> (fornight), <code>m</code> (month).</p>
</td></tr>
<tr><td><code id="plotfitRxx_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. This function is called by the <code><a href="#topic+plotfit.R0.R">plotfit.R0.R()</a></code>.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect. Draws the fit of one estimation method to the data.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plotRAR'>Plot R0 for Attack Rate method</h2><span id='topic+plotRAR'></span>

<h3>Description</h3>

<p>Internal plot method for AR estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRAR(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRAR_+3A_x">x</code></td>
<td>
<p>An estimated object, output from <code><a href="#topic+estimate.R">estimate.R()</a></code> with <code>method = "AR"</code>.</p>
</td></tr>
<tr><td><code id="plotRAR_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plots the R0 reproduction number along with confidence interval.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plotREG'>Plot R0 for Exponential Growth method</h2><span id='topic+plotREG'></span>

<h3>Description</h3>

<p>Internal plot method for EG estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotREG(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotREG_+3A_x">x</code></td>
<td>
<p>An estimated object, output from <code><a href="#topic+estimate.R">estimate.R()</a></code> with <code>method = "EG"</code>.</p>
</td></tr>
<tr><td><code id="plotREG_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plots the exponential growth parameter r, along with R and
corresponding confidence interval.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plotRML'>Plot R0 for Maximum Likelihood method</h2><span id='topic+plotRML'></span>

<h3>Description</h3>

<p>Internal plot method for ML estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRML(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRML_+3A_x">x</code></td>
<td>
<p>An estimated object, output from <code><a href="#topic+estimate.R">estimate.R()</a></code> with <code>method = "ML"</code>.</p>
</td></tr>
<tr><td><code id="plotRML_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plots the R0 reproduction number along with confidence interval.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plotRSB'>Plot R0 for Sequential Bayesian method</h2><span id='topic+plotRSB'></span>

<h3>Description</h3>

<p>Internal plot method for SB estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRSB(x, xscale, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRSB_+3A_x">x</code></td>
<td>
<p>An estimated object, output from <code><a href="#topic+estimate.R">estimate.R()</a></code> with <code>method = "SB"</code>.</p>
</td></tr>
<tr><td><code id="plotRSB_+3A_xscale">xscale</code></td>
<td>
<p>Scale to be adjusted on x-axis. Can be <code>d</code> (day), <code>w</code> (week (default)), <code>f</code> (fornight), <code>m</code> (month).</p>
</td></tr>
<tr><td><code id="plotRSB_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plots the bayesian estimation of <code class="reqn">R_{0}</code> along with its
credible interval.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='plotRTD'>Plot R0 for Time-Dependent method</h2><span id='topic+plotRTD'></span>

<h3>Description</h3>

<p>Internal plot method for TD estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRTD(x, xscale, TD.split, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRTD_+3A_x">x</code></td>
<td>
<p>An estimated object, output from <code><a href="#topic+estimate.R">estimate.R()</a></code> with <code>method = "TD"</code>.</p>
</td></tr>
<tr><td><code id="plotRTD_+3A_xscale">xscale</code></td>
<td>
<p>Scale to be adjusted on x-axis. Can be <code>d</code> (day), <code>w</code> (week (default)), <code>f</code> (fornight), <code>m</code> (month).</p>
</td></tr>
<tr><td><code id="plotRTD_+3A_td.split">TD.split</code></td>
<td>
<p>Boolean. Parameter to force the display of both <code class="reqn">R(t)</code> and the epidemic curve in the same window for the TD method.</p>
</td></tr>
<tr><td><code id="plotRTD_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plots the time-dependent <code class="reqn">R(t)</code> reproduction number along with
confidence band.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effect.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='print.R0.GT'>Print method for objects of class <code>R0.GT</code></h2><span id='topic+print.R0.GT'></span>

<h3>Description</h3>

<p>Prints summary statistics for a generation time distribution from
<code><a href="#topic+generation.time">generation.time()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'R0.GT'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.R0.GT_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
<tr><td><code id="print.R0.GT_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use.
</p>
<p>Displays the mean and standard deviation for generation time distributions
created with <code><a href="#topic+generation.time">generation.time()</a></code>, along with the probabilities for each
time interval.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effects.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='print.R0.R'>Print method for objects of class <code>R0.R</code></h2><span id='topic+print.R0.R'></span>

<h3>Description</h3>

<p>Prints summary statistics for an estimated reproduction ratio.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'R0.R'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.R0.R_+3A_x">x</code></td>
<td>
<p>An estimated object, output from <code>est.R0.xx()</code> routines (class <code>R0.R</code>).</p>
</td></tr>
<tr><td><code id="print.R0.R_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use.
</p>
<p>Displays the estimated reproduction ratio along with its confidence interval.
For the TD method, the time-series of <code class="reqn">R(t)</code> is printed.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effects.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='print.R0.sR'>Print method for objects of class <code>R0.sR</code></h2><span id='topic+print.R0.sR'></span>

<h3>Description</h3>

<p>Prints summary statistics from <code><a href="#topic+estimate.R">estimate.R()</a></code> outputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'R0.sR'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.R0.sR_+3A_x">x</code></td>
<td>
<p>An estimated object, output from <code><a href="#topic+estimate.R">estimate.R()</a></code> (class <code>R0.sR</code>).</p>
</td></tr>
<tr><td><code id="print.R0.sR_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use.
</p>
<p>Displays the estimated reproduction ratio of one or more estimation results
generated by <code><a href="#topic+estimate.R">estimate.R()</a></code>.
</p>


<h3>Value</h3>

<p>This function does not return any data.
Called for side effects.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='R.from.r'>Estimate reproduction number from exponential growth rate</h2><span id='topic+R.from.r'></span>

<h3>Description</h3>

<p>Calculates the basic reproduction number <code class="reqn">R_{0}</code> from the exponential
growth rate obtained by either Poisson or log-linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R.from.r(r, GT)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="R.from.r_+3A_r">r</code></td>
<td>
<p>The exponential growth rate.</p>
</td></tr>
<tr><td><code id="R.from.r_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use. Called by <code><a href="#topic+est.R0.EG">est.R0.EG()</a></code>.
</p>
<p><code class="reqn">R_{0}</code> is calculated as the inverse of the discretized Laplace transform,
making use of the discretized generation time distirbution (output from
<code><a href="#topic+generation.time">generation.time()</a></code>).
</p>


<h3>Value</h3>

<p>A numeric value for R.
</p>


<h3>Note</h3>

<p>The formula for the discretized Laplace transform is taken from
Wallinga &amp; Lipsitch (2007).
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>References</h3>

<p>Wallinga, J., and M. Lipsitch. &quot;How Generation Intervals Shape the Relationship Between Growth Rates and Reproductive Numbers.&quot; Proceedings of the Royal Society B: Biological Sciences 274, no. 1609 (2007): 599.
</p>

<hr>
<h2 id='sa.GT'>Sensitivity of R0 to varying generation time distributions</h2><span id='topic+sa.GT'></span>

<h3>Description</h3>

<p>Sensitivity analysis to estimate the variation of reproduction numbers
according to the disitrbution of generation time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sa.GT(
  incid,
  GT.type,
  GT.mean.range,
  GT.sd.range,
  begin = NULL,
  end = NULL,
  est.method,
  t = NULL,
  date.first.obs = NULL,
  time.step = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sa.GT_+3A_incid">incid</code></td>
<td>
<p>A vector of incident cases.</p>
</td></tr>
<tr><td><code id="sa.GT_+3A_gt.type">GT.type</code></td>
<td>
<p>Type of distribution for GT (see GT.R for details).</p>
</td></tr>
<tr><td><code id="sa.GT_+3A_gt.mean.range">GT.mean.range</code></td>
<td>
<p>Range of mean values used for all GT distributions throughout the simulation. Must be provided as a vector.</p>
</td></tr>
<tr><td><code id="sa.GT_+3A_gt.sd.range">GT.sd.range</code></td>
<td>
<p>Range of standard deviation values used for GT distributions. Must be provided as a vector.</p>
</td></tr>
<tr><td><code id="sa.GT_+3A_begin">begin</code></td>
<td>
<p>Vector of begin dates for the estimation of epidemic.</p>
</td></tr>
<tr><td><code id="sa.GT_+3A_end">end</code></td>
<td>
<p>Vector of end dates for estimation of the epidemic.</p>
</td></tr>
<tr><td><code id="sa.GT_+3A_est.method">est.method</code></td>
<td>
<p>Estimation method used for sensitivity analysis.</p>
</td></tr>
<tr><td><code id="sa.GT_+3A_t">t</code></td>
<td>
<p>Dates vector to be passed to estimation function.</p>
</td></tr>
<tr><td><code id="sa.GT_+3A_date.first.obs">date.first.obs</code></td>
<td>
<p>Optional date of first observation, if t not specified.</p>
</td></tr>
<tr><td><code id="sa.GT_+3A_time.step">time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td></tr>
<tr><td><code id="sa.GT_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By using different Generation Time (GT) distribution, different estimates of
the reproduction ratio can be analyzed.
</p>


<h3>Value</h3>

<p>A data.frame <code>s.a</code> with following components :
</p>
<table>
<tr><td><code>GT.type</code></td>
<td>
<p>Type of distribution for GT.</p>
</td></tr>
<tr><td><code>GT.mean</code></td>
<td>
<p>Range of means used for tested GTs.</p>
</td></tr>
<tr><td><code>GT.sd</code></td>
<td>
<p>Range of standard deviations used for tested GTs.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Computed value for Reproduction Number given GT.type, GT.mean and GT.sd.</p>
</td></tr>
<tr><td><code>CI.lowe</code></td>
<td>
<p>The lower limit of 95% CI for R.</p>
</td></tr>
<tr><td><code>CI.upper</code></td>
<td>
<p>The upper limit of 95% CI for R.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='sa.time'>Sensitivity of R0 to time estimation windows</h2><span id='topic+sa.time'></span>

<h3>Description</h3>

<p>Sensitivity analysis to estimate the variation of reproduction numbers
according to period over which the incidence is analyzed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sa.time(
  incid,
  GT,
  begin = NULL,
  end = NULL,
  est.method,
  t = NULL,
  date.first.obs = NULL,
  time.step = 1,
  res = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sa.time_+3A_incid">incid</code></td>
<td>
<p>A vector of incident cases.</p>
</td></tr>
<tr><td><code id="sa.time_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="sa.time_+3A_begin">begin</code></td>
<td>
<p>Vector of begin dates for the estimation of epidemic.</p>
</td></tr>
<tr><td><code id="sa.time_+3A_end">end</code></td>
<td>
<p>Vector of end dates for estimation of the epidemic.</p>
</td></tr>
<tr><td><code id="sa.time_+3A_est.method">est.method</code></td>
<td>
<p>Estimation method used for sensitivity analysis.</p>
</td></tr>
<tr><td><code id="sa.time_+3A_t">t</code></td>
<td>
<p>Dates vector to be passed to estimation function.</p>
</td></tr>
<tr><td><code id="sa.time_+3A_date.first.obs">date.first.obs</code></td>
<td>
<p>Optional date of first observation, if t not specified.</p>
</td></tr>
<tr><td><code id="sa.time_+3A_time.step">time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td></tr>
<tr><td><code id="sa.time_+3A_res">res</code></td>
<td>
<p>If specified, will extract most of data from a <code>R0.R</code>-class contained within the <code style="white-space: pre;">&#8288;$estimate&#8288;</code> component of a result from <code><a href="#topic+estimate.R">estimate.R()</a></code> and run sensitivity analysis with it.</p>
</td></tr>
<tr><td><code id="sa.time_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By varying different pairs of begin and end dates,different estimates of
reproduction ratio can be analyzed.
</p>
<p>'begin' and 'end' vector must have the same length for the sensitivity
analysis to run. They can be provided either as dates or numeric values,
depending on the other parameters (see <code><a href="#topic+check.incid">check.incid()</a></code>). If some begin/end
dates overlap, they are ignored, and corresponding uncomputed data are set
to <code>NA</code>.
</p>
<p>Also, note that unreliable Rsquared values are achieved for very small time
periods (begin ~ end). These values are not representative of the epidemic
outbreak behaviour.
</p>


<h3>Value</h3>

<p>A list with components :
</p>
<table>
<tr><td><code>df</code></td>
<td>
<p>data.frame object with all results from sensitivity analysis.</p>
</td></tr>
<tr><td><code>df.clean</code></td>
<td>
<p>the same object, with NA rows removed. Used only for easy export of results.</p>
</td></tr>
<tr><td><code>mat.sen</code></td>
<td>
<p>Matrix with values of R0 given begin (rows) and end (columns) dates.</p>
</td></tr>
<tr><td><code>begin</code></td>
<td>
<p>A range of begin dates in epidemic.</p>
</td></tr>
<tr><td><code>end</code></td>
<td>
<p>A range of end dates in epidemic.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='sensitivity.analysis'>Sensitivity analysis of basic reproduction ratio to begin/end dates</h2><span id='topic+sensitivity.analysis'></span>

<h3>Description</h3>

<p>Sensitivity analysis of reproduction ratio using supported estimation methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity.analysis(
  incid,
  GT = NULL,
  begin = NULL,
  end = NULL,
  est.method = NULL,
  sa.type,
  res = NULL,
  GT.type = NULL,
  GT.mean.range = NULL,
  GT.sd.range = NULL,
  t = NULL,
  date.first.obs = NULL,
  time.step = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sensitivity.analysis_+3A_incid">incid</code></td>
<td>
<p>A vector of incident cases.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_begin">begin</code></td>
<td>
<p>Vector of begin dates for the estimation of epidemic.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_end">end</code></td>
<td>
<p>Vector of end dates for estimation of the epidemic.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_est.method">est.method</code></td>
<td>
<p>Estimation method used for sensitivity analysis.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_sa.type">sa.type</code></td>
<td>
<p>String argument to choose between <code>time</code> and <code>GT</code> sensitivity analysis.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_res">res</code></td>
<td>
<p>If specified, will extract most of data from a <code>R0.R</code>-class result already generated by <code><a href="#topic+estimate.R">estimate.R()</a></code> and run sensitivity analysis on it.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_gt.type">GT.type</code></td>
<td>
<p>Type of distribution for GT (see GT.R for details).</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_gt.mean.range">GT.mean.range</code></td>
<td>
<p>Range of mean values used for all GT distributions throughout the simulation. Must be provided as a vector.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_gt.sd.range">GT.sd.range</code></td>
<td>
<p>Range of standard deviation values used for GT distributions. Must be provided as a vector.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_t">t</code></td>
<td>
<p>Dates vector to be passed to estimation function.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_date.first.obs">date.first.obs</code></td>
<td>
<p>Optional date of first observation, if t not specified.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_time.step">time.step</code></td>
<td>
<p>Optional. If date of first observation is specified, number of day between each incidence observation.</p>
</td></tr>
<tr><td><code id="sensitivity.analysis_+3A_...">...</code></td>
<td>
<p>Parameters passed to inner functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic call function to use either sa.time or sa.GT.
Argument must be chosen accordingly to <code>sa.type</code>. Please refer to <code><a href="#topic+sa.time">sa.time()</a></code>
and <code><a href="#topic+sa.GT">sa.GT()</a></code> for further details about arguments.
</p>
<p><code>begin</code> and <code>end</code> vectors must have the same length for the sensitivity
analysis to run. They can be provided either as dates or numeric values,
depending on the other parameters (see <code><a href="#topic+check.incid">check.incid()</a></code>. If some <code>begin</code> or <code>end</code>
dates overlap, they are ignored and corresponding uncomputed data are set to <code>NA</code>.
Also, note that unreliable Rsquared values are achieved for very small time
periods (begin ~ end). These values are not representative of the epidemic
outbreak behaviour.
</p>


<h3>Value</h3>

<p>A sensitivity analysis object of class <code>R0.S</code> with components depending on sensitivity analysis <code>sa.type</code>.
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

## Data is taken from the paper by Nishiura for key transmission parameters of an institutional
## outbreak during 1918 influenza pandemic in Germany)
data(Germany.1918)

## For this exemple, we use the exact same call as for the internal sensitivity analysis function

## sa.type = "GT"

## Here we will test GT with means of 1 to 5, each time with SD constant (1)
## GT and SD can be either fixed value or vectors of values
## Actual value in simulations may differ, as they are adapted according to the distribution type
tmp &lt;- sensitivity.analysis(
     sa.type     = "GT", 
     incid       = Germany.1918, 
     GT.type     = "gamma", 
     GT.mean     = seq(1,5,1), 
     GT.sd.range = 1, 
     begin       = 1, 
     end         = 27, 
     est.method  = "EG")

## Results are stored in a matrix, each line dedicated to a (mean,sd) couple
plot(
     x    = tmp[,"GT.Mean"], 
     xlab = "mean GT (days)", 
     y    = tmp[,"R"], 
     ylim = c(1.2, 2.1), 
     ylab = "R0 (95% CI)", 
     type = "p", 
     pch  = 19, 
     col  = "black", 
     main = "Sensitivity of R0 to mean GT"
)
arrows(
     x0 = as.numeric(tmp[,"GT.Mean"]), 
     y0 = as.numeric(tmp[,"CI.lower"]), 
     y1 = as.numeric(tmp[,"CI.upper"]), 
     angle = 90, 
     code = 3, 
     col = "black", 
     length = 0.05
)
## One could tweak this example to change sorting of values (per mean, or per standard deviation)
## eg: 'x=tmp[,c('GT.Mean')]' could become 'x=tmp[,c('GT.SD')]'


## sa.type="time"

mGT &lt;- generation.time("gamma", c(2.6,1))
sen &lt;- sensitivity.analysis(
     sa.type    = "time", 
     incid      = Germany.1918, 
     GT         = mGT, 
     begin      = 1:10, 
     end        = 16:25, 
     est.method = "EG"
)
# ...
# Warning message:
# If 'begin' and 'end' overlap, cases where begin &gt;= end are skipped.
# These cases often return Rsquared = 1 and are thus ignored.
## A list with different estimates of reproduction ratio, exponential growth rate and 95%CI 
## wtih different pairs of begin and end dates in form of data frame is returned.
## If method is "EG", results will include growth rate and deviance R-squared measure
## Else, if "ML" method is used, growth rate and R-squared will be set as NA

## Interesting results include the variation of R0 given specific begin/end dates.
## Such results can be plot as a colored matrix and display Rsquared=f(time period)
plot(sen, what=c("criterion","heatmap"))
## Returns complete data.frame of best R0 value for each time period 
## (allows for quick visualization)
## The "best.fit" is the time period over which the estimate is the more robust

# $best.fit
#    Time.period Begin.dates  End.dates       R Growth.rate  Rsquared CI.lower. CI.upper.
# 92          15  1970-01-08 1970-01-23 1.64098   0.1478316 0.9752564  1.574953  1.710209
</code></pre>

<hr>
<h2 id='sim.epid'>Epidemic outbreak simulation</h2><span id='topic+sim.epid'></span>

<h3>Description</h3>

<p>Generates several epidemic curves with specified distribution and reproduction
number.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.epid(
  epid.nb,
  GT,
  R0,
  epid.length,
  family,
  negbin.size = NULL,
  peak.value = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.epid_+3A_epid.nb">epid.nb</code></td>
<td>
<p>Number of epidemics to be simulated (defaults to 1)</p>
</td></tr>
<tr><td><code id="sim.epid_+3A_gt">GT</code></td>
<td>
<p>Generation time distribution from <code><a href="#topic+generation.time">generation.time()</a></code>.</p>
</td></tr>
<tr><td><code id="sim.epid_+3A_r0">R0</code></td>
<td>
<p>Basic reproduction number, in its core definition.</p>
</td></tr>
<tr><td><code id="sim.epid_+3A_epid.length">epid.length</code></td>
<td>
<p>Maximum length of the epidemic (cases infected after this length will be truncated).</p>
</td></tr>
<tr><td><code id="sim.epid_+3A_family">family</code></td>
<td>
<p>Distribution of offspring. Can be either <code>"poisson"</code> (default) or <code>"negbin"</code>.</p>
</td></tr>
<tr><td><code id="sim.epid_+3A_negbin.size">negbin.size</code></td>
<td>
<p>If family is set to &quot;negbin&quot;, sets the size parameter of the negative binomial distribution.</p>
</td></tr>
<tr><td><code id="sim.epid_+3A_peak.value">peak.value</code></td>
<td>
<p>Threashold value for incidence before epidemics begins decreasing</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is only used for simulation purposes.
The output is a matrix of n columns (number of outbreaks) by m rows (maximum
length of an outbreak).
</p>
<p>When using rnbinom with <code>mean</code> and <code>size</code> moments, the variance is given by
<code>mean + mean^2/size</code> (see <code><a href="stats.html#topic+NegBinomial">stats::rnbinom()</a></code>). One should determine the size
accordingly to the R0 value to increase the dispersion. From the previous
formula for the variance, <code class="reqn">Var(X) = k*R_{0}</code> implies that
<code class="reqn">size = R0/(k-1)</code>.
</p>


<h3>Value</h3>

<p>A matrix with epidemics stored as columns (incidence count).
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

## In this example we simulate n=100 epidemic curves, with peak value at 150 incident cases, 
## and maximum epidemic length of 30 time units.
## Only the outbreak phase is computed. When the peak value is reached, the process is stopped 
## and another epidemic is generated.
sim.epid(epid.nb=100, GT=generation.time("gamma",c(3,1.5)), R0=1.5, 
         epid.length=30, family="poisson", peak.value=150)

# Here, a 30*100 matrix is returned. Each column is a single epidemic.
</code></pre>

<hr>
<h2 id='sim.epid.indiv'>Influenza-like illness simulation (individual-based model)</h2><span id='topic+sim.epid.indiv'></span>

<h3>Description</h3>

<p>Generates several epidemic curves with an individual-based model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim.epid.indiv(beta, Tmax, n = 1, family = "poisson", negbin.size = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim.epid.indiv_+3A_beta">beta</code></td>
<td>
<p>Contact rate in the SEIR model.</p>
</td></tr>
<tr><td><code id="sim.epid.indiv_+3A_tmax">Tmax</code></td>
<td>
<p>Maximum length of the epidemic (cases infected after this length will be truncated).</p>
</td></tr>
<tr><td><code id="sim.epid.indiv_+3A_n">n</code></td>
<td>
<p>Number of epidemics to be simulated (defaults to 1)</p>
</td></tr>
<tr><td><code id="sim.epid.indiv_+3A_family">family</code></td>
<td>
<p>Distribution of offspring. Can be either <code>"poisson"</code> (default) or <code>"negbin"</code>.</p>
</td></tr>
<tr><td><code id="sim.epid.indiv_+3A_negbin.size">negbin.size</code></td>
<td>
<p>If family is set to &quot;negbin&quot;, sets the size parameter of the negative binomial distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The epidemic is simulated using a branching process, with infinite number of
susceptibles to allow for exponential growth. The model used follows the
Crump-Mode-Jagers description, with S/E/I/R description of the natural history.
</p>
<p>Latent and infectious period follow parametrized Gamma distributions typical
of influenza. An index case is first introduced, and offspring is sampled
from a negative binomial distribution, with mean <code class="reqn">beta*I</code> and variance
<code class="reqn">negbin.size*beta*I</code>, to allow for overdispersion.
</p>


<h3>Value</h3>

<p>A matrix with epidemics stored as columns (incidence count).
</p>


<h3>Note</h3>

<p>This is the exact function as used in the manuscript (Obadia et al., 2012).
</p>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>

<hr>
<h2 id='smooth.Rt'>Smooth real-time reproduction number over larger time periods</h2><span id='topic+smooth.Rt'></span>

<h3>Description</h3>

<p>Aggregate real-time estimates of <code class="reqn">R(t)</code> (from the TD or even the SB
methods) over larger time windows, while still accounting for the generation
time distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smooth.Rt(res, time.period)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smooth.Rt_+3A_res">res</code></td>
<td>
<p>An object of class <code>R0.R</code>, created by any real-time method (currently implemented: TD and SB).</p>
</td></tr>
<tr><td><code id="smooth.Rt_+3A_time.period">time.period</code></td>
<td>
<p>Time period to be used for aggregation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Regrouping Time-Dependant R(t) values, or even Real Time Bayesian most-likely
R values (according to R distributions) should take into account the
generation time. Results can be plotted exactly the same was as input
estimations, except they won't show any goodness-of-fit curve.
</p>


<h3>Value</h3>

<p>A list with components :
</p>
<table>
<tr><td><code>R</code></td>
<td>
<p>The estimate of the reproduction ratio.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>The 95% confidence interval for the R estimate.</p>
</td></tr>
<tr><td><code>GT</code></td>
<td>
<p>Generation time distribution uised in the computation.</p>
</td></tr>
<tr><td><code>epid</code></td>
<td>
<p>Original or augmented epidemic data, depending whether impute.values is set to FALSE or TRUE.</p>
</td></tr>
<tr><td><code>begin</code></td>
<td>
<p>Starting date for the fit.</p>
</td></tr>
<tr><td><code>begin.nb</code></td>
<td>
<p>The number of the first day used in the fit.</p>
</td></tr>
<tr><td><code>end</code></td>
<td>
<p>The end date for the fit.</p>
</td></tr>
<tr><td><code>end.nb</code></td>
<td>
<p>The number of the las day used for the fit.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>The name of the dataset used.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Call used for the function.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Method used for fitting.</p>
</td></tr>
<tr><td><code>method.code</code></td>
<td>
<p>Internal code used to designate method.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pierre-Yves Boelle, Thomas Obadia
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Loading package
library(R0)

## This script allows for generating a new estimation for RTB and TD methods.
## Estimations used as input are agregated by a time period provided by user.
## Results can be plotted exactly the same was as input estimations,
## except they won't show any goodness of fit curve.
data(Germany.1918)
mGT &lt;- generation.time("gamma", c(3,1.5))
TD &lt;- estimate.R(Germany.1918, mGT, begin=1, end=126, methods="TD", nsim=100)
TD
# Reproduction number estimate using  Time-Dependant  method.
# 2.322239 2.272013 1.998474 1.843703 2.019297 1.867488 1.644993 1.553265 1.553317 1.601317 ...
TD$estimates$TD$Rt.quant
#     Date      R.t. CI.lower.  CI.upper.
# 1      1 2.3222391 1.2000000  2.4000000
# 2      2 2.2720131 2.7500000  6.2500000
# 3      3 1.9984738 2.7500000  6.5000000
# 4      4 1.8437031 0.7368421  1.5789474
# 5      5 2.0192967 3.1666667  6.1666667
# 6      6 1.8674878 1.6923077  3.2307692
# 7      7 1.6449928 0.8928571  1.6428571
# 8      8 1.5532654 1.3043478  2.2608696
# 9      9 1.5533172 1.0571429  1.7428571
# 10    10 1.6013169 1.6666667  2.6666667
# ...

TD.weekly &lt;- smooth.Rt(TD$estimates$TD, 7)
TD.weekly
# Reproduction number estimate using  Time-Dependant  method.
# 1.878424 1.580976 1.356918 1.131633 0.9615463 0.8118902 0.8045254 0.8395747 0.8542518 0.8258094..

TD.weekly$Rt.quant
#    Date      R.t. CI.lower. CI.upper.
# 1     1 1.8784240 1.3571429 2.7380952
# 2     8 1.5809756 1.3311037 2.0100334
# 3    15 1.3569175 1.1700628 1.5308219
# 4    22 1.1316335 0.9961229 1.2445302
# 5    29 0.9615463 0.8365561 1.0453074
# 6    36 0.8118902 0.7132668 0.9365193
# 7    43 0.8045254 0.6596685 0.9325967
# 8    50 0.8395747 0.6776557 1.0402930
# 9    57 0.8542518 0.6490251 1.1086351
# 10   64 0.8258094 0.5836735 1.1142857
# 11   71 0.8543877 0.5224719 1.1460674
# 12   78 0.9776385 0.6228070 1.4912281
# 13   85 0.9517133 0.5304348 1.3652174
# 14   92 0.9272833 0.5045045 1.3423423
# 15   99 0.9635479 0.4875000 1.5125000
# 16  106 0.9508951 0.5000000 1.6670455
# 17  113 0.9827432 0.5281989 1.8122157
# 18  120 0.5843895 0.1103040 0.9490928
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
