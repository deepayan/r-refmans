<!DOCTYPE html><html><head><title>Help for package vardiag</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vardiag}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CookRLF.varobj'><p>Plot of Cook's Distances and Reduction Lack of Fit</p></a></li>
<li><a href='#interact.varobj'><p>Interactive Identification of Points in a Variogram Diagnostics</p>
Plot</a></li>
<li><a href='#PlotDiag.varobj'><p>Diagnostic Plots for Variograms</p></a></li>
<li><a href='#QQDecorr.varobj'><p>QQ-Plot of Decorrelated Residuals</p></a></li>
<li><a href='#QQVarcloud.varobj'><p>QQ-Plot of Variogram Cloud Entries</p></a></li>
<li><a href='#tulln'><p>Data on Chlorid concentrations in the Suedliche Tullnerfeld</p></a></li>
<li><a href='#vardiag-internal'><p>Internal vardiag functions</p></a></li>
<li><a href='#varobj'><p>Function for variogram fitting</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.2-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-07-07</td>
</tr>
<tr>
<td>Title:</td>
<td>Variogram Diagnostics</td>
</tr>
<tr>
<td>Author:</td>
<td>Ernst Glatzer &lt;ernst.glatzer@wu-wien.ac.at&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Edzer Pebesma &lt;edzer.pebesma@uni-muenster.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Interactive variogram diagnostics.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/edzer/vardiag/">https://github.com/edzer/vardiag/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-07-08 11:57:09 UTC; edzer</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-07-08 14:46:28</td>
</tr>
</table>
<hr>
<h2 id='CookRLF.varobj'>Plot of Cook's Distances and Reduction Lack of Fit</h2><span id='topic+CookRLF.varobj'></span>

<h3>Description</h3>

<p>Produces a plot of
Cook's Distances and Lack of Fit for a variogram object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>CookRLF.varobj(v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CookRLF.varobj_+3A_v">v</code></td>
<td>
<p>An object of class varobj</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A plot is created on the current graphics device with Reduction in Lack
of Fit on the horizontal axis and Cook's Distances on the vertical axis.
</p>
<p>After the plot is created, the cursor changes to a cross and points can
be identified by left mouse clicks. When there are no further points to
be identified, the identification can be ended by a right mouse click.
</p>


<h3>Author(s)</h3>

<p>Ernst  Glatzer</p>


<h3>References</h3>

<p> E. Glatzer, W.G. Mueller, 2004. Residual diagnostics for
variogram fitting. Computers and Geosciences 30, pp 859-866. </p>


<h3>See Also</h3>

<p><code><a href="#topic+PlotDiag.varobj">PlotDiag.varobj</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tulln)
CookRLF.varobj(vs50)
</code></pre>

<hr>
<h2 id='interact.varobj'>Interactive Identification of Points in a Variogram Diagnostics
Plot</h2><span id='topic+interact.varobj'></span>

<h3>Description</h3>

<p>Initiates selection of points in a Variogram Diagnostics Plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interact.varobj(v, region = NULL, g = "s", pchi = 0.05, zmv = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interact.varobj_+3A_v">v</code></td>
<td>
<p>A variogram object</p>
</td></tr>
<tr><td><code id="interact.varobj_+3A_region">region</code></td>
<td>
<p>a n by 2 matrix of vertices of a polygon,
which represents the region of interest.</p>
</td></tr>
<tr><td><code id="interact.varobj_+3A_g">g</code></td>
<td>
<p>the type of interaction with the following options:
</p>

<dl>
<dt>l</dt><dd><p>selection of a point in the leave-one-out plot.</p>
</dd>
<dt>m</dt><dd><p>selection of one or two points in the map view. After selection of one point the
selection process can be stopped by a right mouse click.</p>
</dd>
<dt>n</dt><dd><p>selection of a polygon region in the map view. This can
be done by left clicking on the vertices of the polygon and
stopping by a right mouse click.</p>
</dd>
<dt>s</dt><dd><p>selection of a point in the studentized square root
cloud.</p>
</dd>
<dt>t</dt><dd><p>selection of a polygon region in the studentized square root
cloud. This can
be done by left clicking on the vertices of the polygon and
stopping by a right mouse click.</p>
</dd>
<dt>x</dt><dd><p>selection of all points in the studentized square root
cloud outside an approximate confidence bound with significance level given by <code>pchi</code>.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="interact.varobj_+3A_pchi">pchi</code></td>
<td>
<p>the significance level of the confidence bounds, if option
<code>g="x"</code> is given.</p>
</td></tr>
<tr><td><code id="interact.varobj_+3A_zmv">zmv</code></td>
<td>
<p>the value of <code>zmv</code> determines which values will be
ploted as third dimension (via circles with radius corresponding
to the value) in the map view. The following values are possible:
</p>

<dl>
<dt>0</dt><dd><p>no third dimension,</p>
</dd>
<dt>1</dt><dd><p>values of the original observations,</p>
</dd>
<dt>2</dt><dd><p>Cook's distances,</p>
</dd>
<dt>3</dt><dd><p>reduction in lack of fit.</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Details</h3>

<p>Before the call of this function a diagnostic plot must be
created by a call to the function <code>PlotDiag.varobj</code>.
</p>
<p>If one point in the map view is selected, this point is marked
blue and the index of this observation is printed near the point.
All corresponding points in the square root cloud and the
leave-one-out plot are marked blue.
</p>
<p>If two points in the map view (or one point in the square root
cloud or in the leave-one-out plot) are selected, this pair of
points is joined by a magenta line and the corresponding point in
the square root cloud is marked magenta. One of the selected
points in the map view and all corresponding points in the square
root cloud and the leave-one-out plot are marked blue. The other
selected point in the map view and all corresponding points in the
square root cloud and the leave-one-out plot are marked red.
</p>
<p>If a region is selected in the map view, all possible pairs of
points within the region are joined by magenta lines and for each
pair the corresponding point in the square root cloud is marked
magenta.
</p>
<p>If a region in the square root cloud is selected, all points
within that region are marked magenta and all corresponding pairs
of points in the map view are joined by magenta lines.
</p>
<p>If option <code>g="x"</code> is selected, all points in the square root
cloud outside the chosen confidence bound are marked magenta and
all corresponding pairs of points in the map view are joined by
magenta lines.
</p>


<h3>Value</h3>

<p>the index of the selected pair of observations.
</p>


<h3>Author(s)</h3>

<p>Ernst  Glatzer</p>


<h3>References</h3>

<p> E. Glatzer, W.G. Mueller, 2004. Residual diagnostics for
variogram fitting. Computers and Geosciences 30, pp 859-866. </p>


<h3>See Also</h3>

<p><code><a href="#topic+PlotDiag.varobj">PlotDiag.varobj</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tulln)
PlotDiag.varobj(vs50,region=tu1)
</code></pre>

<hr>
<h2 id='PlotDiag.varobj'>Diagnostic Plots for Variograms</h2><span id='topic+PlotDiag.varobj'></span>

<h3>Description</h3>

<p> Produces diagnostic plots for a variogram object. </p>


<h3>Usage</h3>

<pre><code class='language-R'> PlotDiag.varobj(v, region = NULL, xyi = 0, zmv = 0) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PlotDiag.varobj_+3A_v">v</code></td>
<td>
<p>A variogram object</p>
</td></tr>
<tr><td><code id="PlotDiag.varobj_+3A_region">region</code></td>
<td>
<p>a n by 2 matrix of vertices of a polygon,
which represents the region of interest.</p>
</td></tr>
<tr><td><code id="PlotDiag.varobj_+3A_xyi">xyi</code></td>
<td>
<p>the index of the pair of observations, which shall be
marked in the plots.</p>
</td></tr>
<tr><td><code id="PlotDiag.varobj_+3A_zmv">zmv</code></td>
<td>
<p>the value of <code>zmv</code>= determines which values will be
plotted as third dimension (via circles with radius corresponding
to the value) in the map view. The following values are possible:
</p>

<dl>
<dt>0</dt><dd><p>no third dimension,</p>
</dd>
<dt>1</dt><dd><p>values of the original observations,</p>
</dd>
<dt>2</dt><dd><p>Cook's distances,</p>
</dd>
<dt>3</dt><dd><p>reduction in lack of fit.</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Details</h3>

<p>Four plots are created on the current graphics device.
</p>
<p>These plots are a map
view, a square root cloud with the fitted model, a leave-one-out plot and a plot of decorrelated residuals.
If the argument <code>region</code> is given, this region is plotted as a polygon in the map view. If the argument
<code>xyi</code> is given, the corresponding pair of observations is marked as a blue and a red point in the map view and
connected by a magenta line. Furthermore all the points in the square root cloud, which contain the first (second)
observation in the pair are marked blue (red). The one point that contains both observations of the selected pair
is marked magenta. The points in the leave-one-out plot are marked analogously.
</p>


<h3>Value</h3>

<p>No value is returned. The function is called for its side
effects, i.e. creating plots.
</p>


<h3>Author(s)</h3>

<p>Ernst  Glatzer</p>


<h3>References</h3>

<p> E. Glatzer, W.G. Mueller, 2004. Residual diagnostics for
variogram fitting. Computers and Geosciences 30, pp 859-866. </p>


<h3>See Also</h3>

<p><code><a href="#topic+interact.varobj">interact.varobj</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tulln)
PlotDiag.varobj(vs50,region=tu1)
PlotDiag.varobj(vs50,region=tu1,xyi=144)
</code></pre>

<hr>
<h2 id='QQDecorr.varobj'>QQ-Plot of Decorrelated Residuals</h2><span id='topic+QQDecorr.varobj'></span>

<h3>Description</h3>

<p>Produces a qq-plot
of decorrelated residuals for a variogram object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QQDecorr.varobj(v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QQDecorr.varobj_+3A_v">v</code></td>
<td>
<p>A variogram object </p>
</td></tr>
</table>


<h3>Details</h3>

<p>A plot is created on the current graphics device with
quantiles of the normal distribution on the horizontal axis and
ordered values of the decorrelated residuals on the vertical
axis.
</p>
<p>A straight red line marks the expected curve of this plot.
Additionally approximate confidence bounds for 10% significance
are given.
</p>


<h3>Author(s)</h3>

<p>Ernst  Glatzer</p>


<h3>References</h3>

<p> E. Glatzer, W.G. Mueller, 2004. Residual diagnostics for
variogram fitting. Computers and Geosciences 30, pp 859-866. </p>


<h3>See Also</h3>

<p><code><a href="#topic+PlotDiag.varobj">PlotDiag.varobj</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tulln)
QQDecorr.varobj(vs50)
</code></pre>

<hr>
<h2 id='QQVarcloud.varobj'>QQ-Plot of Variogram Cloud Entries</h2><span id='topic+QQVarcloud.varobj'></span>

<h3>Description</h3>

<p>Produces a qq-plot
of variogram cloud entries for a variogram object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QQVarcloud.varobj(v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QQVarcloud.varobj_+3A_v">v</code></td>
<td>
<p>A variogram object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A plot is created on the current graphics device with
quantiles of the chi-square distribution on the horizontal axis
and ordered values of <code class="reqn">\frac{(Z(s)-Z(s'))^2}{\gamma(s-s')}</code> on the
vertical axis.
</p>
<p>A straight red line marks the expected curve of this plot.
Additionally approximate confidence bounds for 10% significance
are given.
</p>


<h3>Author(s)</h3>

<p>Ernst  Glatzer</p>


<h3>References</h3>

<p> E. Glatzer, W.G. Mueller, 2004. Residual diagnostics for
variogram fitting. Computers and Geosciences 30, pp 859-866. </p>


<h3>See Also</h3>

<p><code><a href="#topic+PlotDiag.varobj">PlotDiag.varobj</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tulln)
QQVarcloud.varobj(vs50)
</code></pre>

<hr>
<h2 id='tulln'>Data on Chlorid concentrations in the Suedliche Tullnerfeld</h2><span id='topic+tulln'></span><span id='topic+tu1'></span><span id='topic+vs50'></span>

<h3>Description</h3>

<p>The <code>tulln</code> dataset contains a variogram object and a matrix
with the coordinates of the vertices of a polygonal region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tulln)
</code></pre>


<h3>Format</h3>

<p>This dataset consists of a variogram object and a matrix.
</p>


<h3>Details</h3>

<p>The variogram model used is a spherical model.
</p>


<h3>Source</h3>

<p>Glatzer, E and Mueller, W.G. (2002).
</p>


<h3>References</h3>

<p> E. Glatzer, W.G. Mueller, 2004. Residual diagnostics for
variogram fitting. Computers and Geosciences 30, pp 859-866. </p>

<hr>
<h2 id='vardiag-internal'>Internal vardiag functions</h2><span id='topic+estvar'></span><span id='topic+ficorr'></span><span id='topic+ftc'></span><span id='topic+ftg'></span><span id='topic+fth'></span><span id='topic+fts'></span><span id='topic+ftsOpt'></span><span id='topic+gamsph'></span><span id='topic+gamsph1'></span><span id='topic+gamsph2'></span><span id='topic+gamsph3'></span><span id='topic+hyperg'></span><span id='topic+print.varobj'></span>

<h3>Description</h3>

<p>Internal functions for package vardiag.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estvar(h0, y, iter = 50, tolerance = 2e-04, trace = 1, th0 = rbind(0, 1, 1))
ficorr(r)
ftc(th, y, h1, w1)
ftg(th, y, h1, cv1)
fth(th, y, h1, w1 = 1)
fts(th, y, h1, cv1)
gamsph(h, th = rbind(1, 1, 1))
gamsph1(h, th = rbind(1, 1, 1))
gamsph2(h, th = rbind(1, 1, 1))
gamsph3(h, th = rbind(1, 1, 1))
hyperg(r)
## S3 method for class 'varobj'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vardiag-internal_+3A_...">...</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_cv1">cv1</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_h">h</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_h0">h0</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_h1">h1</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_iter">iter</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_r">r</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_th">th</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_th0">th0</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_tolerance">tolerance</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_trace">trace</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_w1">w1</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_x">x</code></td>
<td>
</td></tr>
<tr><td><code id="vardiag-internal_+3A_y">y</code></td>
<td>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are not intended to be called by the user.
</p>


<h3>Author(s)</h3>

<p>Ernst Glatzer</p>

<hr>
<h2 id='varobj'>Function for variogram fitting</h2><span id='topic+varobj'></span>

<h3>Description</h3>

<p>This function fits a variogram model to spatial data and calculates some statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varobj(m, iter = 50, tolerance = 2e-04, trace = 1, loo = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varobj_+3A_m">m</code></td>
<td>
<p>n by 3 matrix with spatial data</p>
</td></tr>
<tr><td><code id="varobj_+3A_iter">iter</code></td>
<td>
<p>this argument is put forward to the optimization routine</p>
</td></tr>
<tr><td><code id="varobj_+3A_tolerance">tolerance</code></td>
<td>
<p>this argument is put forward to the optimization routine</p>
</td></tr>
<tr><td><code id="varobj_+3A_trace">trace</code></td>
<td>
<p>if set to values higher than 1 some debug messages are given</p>
</td></tr>
<tr><td><code id="varobj_+3A_loo">loo</code></td>
<td>
<p>if set to TRUE, leave-one-out residuals are clculated</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only spherical variogram models are fitted.
</p>


<h3>Value</h3>

<p>a variogram object
</p>


<h3>Author(s)</h3>

<p>Ernst  Glatzer</p>


<h3>References</h3>

<p> E. Glatzer, W.G. Mueller, 2004. Residual diagnostics for
variogram fitting. Computers and Geosciences 30, pp 859-866. </p>


<h3>See Also</h3>

<p><code><a href="#topic+PlotDiag.varobj">PlotDiag.varobj</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tulln)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
