<!DOCTYPE html><html><head><title>Help for package rbacon</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rbacon}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rbacon'><p>rbacon</p></a></li>
<li><a href='#A.modelled'><p>Calculate modelled 210Pb</p></a></li>
<li><a href='#accrate.age'><p>Obtain estimated accumulation rates for any age of a core.</p></a></li>
<li><a href='#accrate.age.ghost'><p>Plot a core's accumulation rates against calendar time.</p></a></li>
<li><a href='#accrate.depth'><p>Obtain estimated accumulation rates as for any depth of a core.</p></a></li>
<li><a href='#accrate.depth.ghost'><p>Plot modelled accumulation rates against the depths of a core.</p></a></li>
<li><a href='#add.dates'><p>Add dates to age-depth plots</p></a></li>
<li><a href='#agedepth'><p>Plot an age-depth model</p></a></li>
<li><a href='#agemodel.it'><p>Extract one age-model iteration</p></a></li>
<li><a href='#AgesOfEvents'><p>Event probabilities against calendar age</p></a></li>
<li><a href='#background'><p>calculate probabilities that Pb-210 data have reached background levels</p></a></li>
<li><a href='#Bacon'><p>Main age-depth modelling function</p></a></li>
<li><a href='#Bacon.Age.d'><p>Output all ages for a single depth.</p></a></li>
<li><a href='#Bacon.cleanup'><p>Remove files made to produce the current core's age-depth model.</p></a></li>
<li><a href='#Bacon.d.Age'><p>Output all depths for a single age.</p></a></li>
<li><a href='#Bacon.hist'><p>Calculate age distributions of depths.</p></a></li>
<li><a href='#bacon2clam'><p>Translate Bacon .csv files to clam .csv files.</p></a></li>
<li><a href='#Baconvergence'><p>Test to identify poorly mixed MCMC runs.</p></a></li>
<li><a href='#calib.plot'><p>Plot the dates</p></a></li>
<li><a href='#clam2bacon'><p>Translate clam .csv files to Bacon .csv files.</p></a></li>
<li><a href='#draw.pbmeasured'><p>Plot the 210Pb data</p></a></li>
<li><a href='#draw.pbmodelled'><p>Plot the 210Pb data</p></a></li>
<li><a href='#flux.age.ghost'><p>Plot flux rates for proxies.</p></a></li>
<li><a href='#proxy.ghost'><p>Proxies analysed along the depths of a core can be plotted as 'proxy-ghost' graphs against calendar time while taking into account chronological uncertainties. Here darker grey indicates more likely calendar ages for specific proxy values.</p></a></li>
<li><a href='#scissors'><p>Remove the first n iterations.</p></a></li>
<li><a href='#set.initvals'><p>Set initial values for the Bacon MCMC run.</p></a></li>
<li><a href='#squeeze'><p>Squeeze some depths of a core</p></a></li>
<li><a href='#stretch'><p>Stretch some depths of a core</p></a></li>
<li><a href='#thinner'><p>Thin iterations.</p></a></li>
<li><a href='#tofu'><p>Bacon for vegans</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Age-Depth Modelling using Bayesian Statistics</td>
</tr>
<tr>
<td>Version:</td>
<td>3.2.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Maarten Blaauw <a href="https://orcid.org/0000-0002-5680-1515"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  J. Andres Christen
    <a href="https://orcid.org/0000-0002-5795-4345"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, ctb,
    cph],
  Marco A. Aquino Lopez
    <a href="https://orcid.org/0000-0002-5076-7205"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Judith Esquivel Vazquez [ctb],
  Oscar M. Gonzalez V. [ctb],
  Ted Belding [cph],
  James Theiler [cph],
  Brian Gough [cph],
  Charles Karney [cph]</td>
</tr>
<tr>
<td>Description:</td>
<td>An approach to age-depth modelling that uses Bayesian statistics to reconstruct accumulation histories for deposits, through combining radiocarbon and other dates with prior information on accumulation rates and their variability. See Blaauw &amp; Christen (2011).</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda (&ge; 0.19-1), graphics, grDevices, Rcpp (&ge; 0.12.12),
stats, utils, data.table</td>
</tr>
<tr>
<td>Depends:</td>
<td>rintcal (&ge; 0.6.4), R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, utf8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maarten Blaauw &lt;maarten.blaauw@qub.ac.uk&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-27 17:38:00 UTC; maarten</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-28 01:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rbacon'>rbacon</h2><span id='topic+rbacon'></span><span id='topic+rbacon-package'></span>

<h3>Description</h3>

<p>Bacon produces Bayesian age-depth models from dated deposits, reconstructing Bayesian 
accumulation histories through combining radiocarbon and other dates with prior information (Blaauw and Christen, 2011).
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw &lt;maarten.blaauw@qub.ac.uk&gt; J. Andres Christen &lt;jac@cimat.mx&gt;
</p>

<hr>
<h2 id='A.modelled'>Calculate modelled 210Pb</h2><span id='topic+A.modelled'></span>

<h3>Description</h3>

<p>Calculate modelled 210Pb values of a sample slice, based on the parameters of the age-model (i.e., time passed since deposition of the bottom and top of the slice), supported and influx
</p>


<h3>Usage</h3>

<pre><code class='language-R'>A.modelled(
  d.top,
  d.bottom,
  dens,
  set = get("info"),
  phi = set$phi,
  sup = set$ps
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="A.modelled_+3A_d.top">d.top</code></td>
<td>
<p>top depth of the slice</p>
</td></tr>
<tr><td><code id="A.modelled_+3A_d.bottom">d.bottom</code></td>
<td>
<p>bottom depth of the slice</p>
</td></tr>
<tr><td><code id="A.modelled_+3A_dens">dens</code></td>
<td>
<p>Density of the slice (in g/cm3)</p>
</td></tr>
<tr><td><code id="A.modelled_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="A.modelled_+3A_phi">phi</code></td>
<td>
<p>The modelled values of the 210Pb influx</p>
</td></tr>
<tr><td><code id="A.modelled_+3A_sup">sup</code></td>
<td>
<p>The modelled values of the supported 210Pb</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of modelled values of A
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>

<hr>
<h2 id='accrate.age'>Obtain estimated accumulation rates for any age of a core.</h2><span id='topic+accrate.age'></span>

<h3>Description</h3>

<p>Obtain accumulation rates (in years per cm, so actually sedimentation times) as estimated by the MCMC iterations for any age of a core.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>accrate.age(
  age,
  set = get("info"),
  cmyr = FALSE,
  ages = c(),
  BCAD = set$BCAD,
  silent = TRUE,
  na.rm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="accrate.age_+3A_age">age</code></td>
<td>
<p>The age for which the accumulation rates need to be returned.</p>
</td></tr>
<tr><td><code id="accrate.age_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="accrate.age_+3A_cmyr">cmyr</code></td>
<td>
<p>Accumulation rates can be calculated in cm/year or year/cm. By default <code>cmyr=FALSE</code> and accumulation rates are calculated in year per cm.</p>
</td></tr>
<tr><td><code id="accrate.age_+3A_ages">ages</code></td>
<td>
<p>The ages of the age-depth model. Not provided by default, but can be provided to speed things up if the function is called repeatedly</p>
</td></tr>
<tr><td><code id="accrate.age_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="accrate.age_+3A_silent">silent</code></td>
<td>
<p>Warn when ages are outside the core's range. Default <code>silent=TRUE</code>.</p>
</td></tr>
<tr><td><code id="accrate.age_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove NA entries. These are NOT removed by default, so that always the same amount of iterations is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Considering accumulation rates is crucial for age-depth modelling, and even more so if they are subsequently
used for calculating proxy influx values, or interpreted as proxy for environmental change such as carbon accumulation. See also <code>accrate.age.ghost</code>, <code>accrate.depth</code> and <code>accrate.depth.ghost</code>.
Bacon deals explicitly with accumulation rate and its variability through defining prior distributions.
This function obtains accumulation rates (in years per cm, so actually sedimentation times) as estimated
by the MCMC iterations for any age of a core. Deals with only 1 age at a time. See also <code>accrate.depth</code>.
</p>


<h3>Value</h3>

<p>all MCMC estimates of accumulation rate of the chosen age.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  Bacon(run=FALSE, coredir=tempfile())
  agedepth(yr.res=50, d.res=50, d.by=10)
  accrate.a5000 = accrate.age(5000)
  plot(accrate.a5000, pch='.')
  hist(accrate.a5000)

## End(Not run)
</code></pre>

<hr>
<h2 id='accrate.age.ghost'>Plot a core's accumulation rates against calendar time.</h2><span id='topic+accrate.age.ghost'></span>

<h3>Description</h3>

<p>Plot a grey-scale representation of a core's estimated accumulation rates against time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>accrate.age.ghost(
  set = get("info"),
  age.lim = c(),
  age.lab = c(),
  kcal = FALSE,
  age.res = 400,
  acc.res = 200,
  cutoff = 0.001,
  dark = 1,
  rgb.scale = c(0, 0, 0),
  rgb.res = 100,
  prob = 0.95,
  plot.range = TRUE,
  range.col = grey(0.5),
  range.lty = 2,
  plot.mean = TRUE,
  mean.col = "red",
  mean.lty = 2,
  plot.median = TRUE,
  median.col = "blue",
  median.lty = 2,
  acc.lim = c(),
  acc.lab = c(),
  BCAD = set$BCAD,
  cmyr = FALSE,
  rotate.axes = FALSE,
  rev.age = FALSE,
  rev.acc = FALSE,
  xaxs = "i",
  yaxs = "i",
  bty = "l"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="accrate.age.ghost_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable info.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_age.lim">age.lim</code></td>
<td>
<p>Minimum and maximum calendar age ranges, calculated automatically by default (<code>age.lim=c()</code>).</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_age.lab">age.lab</code></td>
<td>
<p>The labels for the calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>).</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_kcal">kcal</code></td>
<td>
<p>Use kcal BP. Default is <code>kcal=FALSE</code>.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_age.res">age.res</code></td>
<td>
<p>Resolution or amount of greyscale pixels to cover the age scale of the plot. Default <code>age.res=400</code>.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_acc.res">acc.res</code></td>
<td>
<p>Resolution or amount of greyscale pixels to cover the accumulation rate scale plot. Default <code>age.res=400</code>.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_cutoff">cutoff</code></td>
<td>
<p>Point below which colours will no longer be printed. Default <code>cutoff=0.001</code>.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_dark">dark</code></td>
<td>
<p>The darkest grey value is dark=1 by default; lower values will result in lighter grey but values &gt;1 are not advised.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_rgb.scale">rgb.scale</code></td>
<td>
<p>The function to produce a coloured representation of all age-models. Needs 3 values for the intensity of red, green and blue. Defaults to grey-scales: <code>rgb.scale=c(0,0,0)</code>, but could also be, say, scales of red (<code>rgb.scale=c(1,0,0)</code>).</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_rgb.res">rgb.res</code></td>
<td>
<p>Resolution of the colour spectrum depicting the age-depth model. Default <code>rgb.res=100</code>.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_prob">prob</code></td>
<td>
<p>Probability ranges. Defaults to <code>prob=0.95</code>.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_plot.range">plot.range</code></td>
<td>
<p>If <code>plot.range=TRUE</code>, the confidence ranges (two-tailed; half of the probability at each side) are plotted.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_range.col">range.col</code></td>
<td>
<p>Colour of the confidence ranges.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_range.lty">range.lty</code></td>
<td>
<p>Line type of the confidence ranges.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_plot.mean">plot.mean</code></td>
<td>
<p>If <code>plot.mean=TRUE</code>, the means are plotted.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_mean.col">mean.col</code></td>
<td>
<p>Colour of the mean accumulation rates.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_mean.lty">mean.lty</code></td>
<td>
<p>Type of the mean lines.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_plot.median">plot.median</code></td>
<td>
<p>If <code>plot.mean=TRUE</code>, the medians are plotted.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_median.col">median.col</code></td>
<td>
<p>Colour of the median accumulation rates.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_median.lty">median.lty</code></td>
<td>
<p>Type of the median lines.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_acc.lim">acc.lim</code></td>
<td>
<p>Axis limits for the accumulation rates.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_acc.lab">acc.lab</code></td>
<td>
<p>Axis label for the accumulation rate.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_cmyr">cmyr</code></td>
<td>
<p>Accumulation rates can be calculated in cm/year or year/cm. By default <code>cmyr=FALSE</code> and accumulation rates are calculated in year per cm. Axis limits are difficult to calculate when <code>cmyr=TRUE</code>, so a manual adaptation of <code>acc.lim</code> might be a good idea.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>The default is to plot the calendar age horizontally and accumulation rates vertically. Change to <code>rotate.axes=TRUE</code> value to rotate axes.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_rev.age">rev.age</code></td>
<td>
<p>The direction of the age axis, which can be reversed using <code>rev.age=TRUE</code>.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_rev.acc">rev.acc</code></td>
<td>
<p>The direction of the accumulation rate axis, which can be reversed (<code>rev.acc=TRUE</code>.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_xaxs">xaxs</code></td>
<td>
<p>Extension of the x-axis. White space can be added to the vertical axis using <code>xaxs="r"</code>.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_yaxs">yaxs</code></td>
<td>
<p>Extension of the y-axis. White space can be added to the vertical axis using <code>yaxs="r"</code>.</p>
</td></tr>
<tr><td><code id="accrate.age.ghost_+3A_bty">bty</code></td>
<td>
<p>Type of box to be drawn around the plot (<code>"n"</code> for none, and <code>"l"</code> (default), <code>"7"</code>, <code>"c"</code>, <code>"u"</code>, or <code>"o"</code> for correspondingly shaped boxes).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculating accumulation rates against calendar age will take some time to calculate, and might show unexpected
rates around the core's maximum ages (only a few of all age-model iterations will reach such ages and they will tend to have
modelled accumulation rates for the lower depths much lower than the other iterations). Axis limits for accumulation rates
are estimated automatically, however upper limits can be very variable (and thus hard to predict) if calculated in <code>cm/yr</code>.
Therefore you might want to manually adapt the axis limits after plotting with default settings (e.g., <code>acc.lim=c(0,1)</code>). See also <code>accrate.depth.ghost</code>, <code>accrate.depth</code> and <code>accrate.age</code>.
The grey-scale reconstruction around the oldest ages of any reconstruction often indicates very low accumulation rates.
This is due to only some MCMC iterations reaching those old ages, and these iterations will have modelled very slow accumulation rates.
Currently does not deal well with hiatuses, so do not interpret accumulation rates close to depths with inferred hiatuses.
</p>


<h3>Value</h3>

<p>A greyscale plot of accumulation rate against calendar age, and (invisibly) the list of ages and their accumulation rates (ranges, medians, means).
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  Bacon(run=FALSE, coredir=tempfile())
  agedepth(age.res=20, d.res=20, d.by=10)
  layout(1)
  tmp &lt;- accrate.age.ghost(age.res=200, acc.res=100)
  head(tmp)

## End(Not run)
</code></pre>

<hr>
<h2 id='accrate.depth'>Obtain estimated accumulation rates as for any depth of a core.</h2><span id='topic+accrate.depth'></span>

<h3>Description</h3>

<p>Obtain accumulation rates (in years per cm, so actually sedimentation times) as estimated by the MCMC iterations for any depth of a core.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>accrate.depth(d, set = get("info"), cmyr = FALSE, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="accrate.depth_+3A_d">d</code></td>
<td>
<p>The depth for which accumulation rates need to be returned.</p>
</td></tr>
<tr><td><code id="accrate.depth_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="accrate.depth_+3A_cmyr">cmyr</code></td>
<td>
<p>Accumulation rates can be calculated in cm/year or year/cm. By default <code>cmyr=FALSE</code> and accumulation rates are calculated in year per cm.</p>
</td></tr>
<tr><td><code id="accrate.depth_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove NA entries. These are NOT removed by default, so that always the same amount of iterations is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>should take into account hiatuses
</p>
<p>Considering accumulation rates is crucial for age-depth modelling, and even more so if they are subsequently used for calculating proxy
influx values, or interpreted as proxy for environmental change such as carbon accumulation.
Bacon deals explicitly with accumulation rate and its variability through defining prior distributions.
This function obtains accumulation rates (in years per cm, so actually sedimentation times) as estimated by the MCMC iterations
for any depth of a core. Deals with only 1 depth at a time. See also <code>accrate.age</code>.
</p>


<h3>Value</h3>

<p>all MCMC estimates of accumulation rate of the chosen depth.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  Bacon(run=FALSE, coredir=tempfile())
  agedepth(yr.res=50, d.res=50, d.by=10)
  d20 &lt;- accrate.depth(20)
  hist(d20)
  d20 &lt;- accrate.depth(20, cmyr=TRUE) # to calculate accumulation rates in cm/yr
  mean(d20)

## End(Not run)
</code></pre>

<hr>
<h2 id='accrate.depth.ghost'>Plot modelled accumulation rates against the depths of a core.</h2><span id='topic+accrate.depth.ghost'></span>

<h3>Description</h3>

<p>Plot grey-scale representation of modelled accumulation rates over a core's depth. Each section of the core (see Bacon's option <code>"thick"</code>) will have modelled accumulation rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>accrate.depth.ghost(
  set = get("info"),
  d = set$elbows,
  d.lim = c(),
  acc.lim = c(),
  d.lab = c(),
  cmyr = FALSE,
  acc.lab = c(),
  dark = 1,
  cutoff = 0.001,
  rgb.scale = c(0, 0, 0),
  rgb.res = 100,
  prob = 0.95,
  plot.range = TRUE,
  range.col = grey(0.5),
  range.lty = 2,
  plot.mean = TRUE,
  mean.col = "red",
  mean.lty = 2,
  plot.median = TRUE,
  median.col = "blue",
  median.lty = 2,
  rotate.axes = FALSE,
  rev.d = FALSE,
  rev.acc = FALSE,
  xaxs = "r",
  yaxs = "r",
  bty = "l",
  remove.laststep = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="accrate.depth.ghost_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable info.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_d">d</code></td>
<td>
<p>The depths for which the accumulation rates are to be calculated. Default to the entire core.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_d.lim">d.lim</code></td>
<td>
<p>Axis limits for the depths.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_acc.lim">acc.lim</code></td>
<td>
<p>Axis limits for the accumulation rates.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_d.lab">d.lab</code></td>
<td>
<p>Label for the depth axis.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_cmyr">cmyr</code></td>
<td>
<p>Accumulation rates can be calculated in cm/year or year/cm. By default <code>cmyr=FALSE</code> and accumulation rates are calculated in year per cm. Axis limits are difficult to calculate when <code>cmyr=TRUE</code>, so a manual adaptation of <code>acc.lim</code> might be a good idea.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_acc.lab">acc.lab</code></td>
<td>
<p>Axis label for the accumulation rate.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_dark">dark</code></td>
<td>
<p>The darkest grey value is dark=1 by default; lower values will result in lighter grey but values &gt;1 are not advised.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_cutoff">cutoff</code></td>
<td>
<p>Point below which colours will no longer be printed. Default <code>cutoff=0.001</code>.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_rgb.scale">rgb.scale</code></td>
<td>
<p>The function to produce a coloured representation of all age-models. Needs 3 values for the intensity of red, green and blue. Defaults to grey-scales: <code>rgb.scale=c(0,0,0)</code>, but could also be, say, scales of red (<code>rgb.scale=c(1,0,0)</code>).</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_rgb.res">rgb.res</code></td>
<td>
<p>Resolution of the colour spectrum depicting the age-depth model. Default <code>rgb.res=100</code>.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_prob">prob</code></td>
<td>
<p>Probability ranges. Defaults to <code>prob=0.95</code>.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_plot.range">plot.range</code></td>
<td>
<p>If <code>plot.range=TRUE</code>, the confidence ranges (two-tailed; half of the probability at each side) are plotted.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_range.col">range.col</code></td>
<td>
<p>Colour of the confidence ranges.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_range.lty">range.lty</code></td>
<td>
<p>Line type of the confidence ranges.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_plot.mean">plot.mean</code></td>
<td>
<p>If <code>plot.mean=TRUE</code>, the means are plotted.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_mean.col">mean.col</code></td>
<td>
<p>Colour of the mean accumulation rates.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_mean.lty">mean.lty</code></td>
<td>
<p>Type of the mean lines.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_plot.median">plot.median</code></td>
<td>
<p>If <code>plot.mean=TRUE</code>, the medians are plotted.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_median.col">median.col</code></td>
<td>
<p>Colour of the median accumulation rates.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_median.lty">median.lty</code></td>
<td>
<p>Type of the median lines.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>The default is to plot the accumulation rates horizontally and the depth vertically (<code>rotate.axes=FALSE</code>). Change rotate.axes value to rotate axes.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_rev.d">rev.d</code></td>
<td>
<p>The direction of the depth axis can be reversed from the default (<code>rev.d=TRUE</code>.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_rev.acc">rev.acc</code></td>
<td>
<p>The direction of the accumulation rate axis can be reversed from the default (<code>rev.acc=TRUE</code>).</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_xaxs">xaxs</code></td>
<td>
<p>Extension of x-axis. By default, add some extra white-space at both extremes (<code>xaxs="r"</code>). See ?par for other options.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_yaxs">yaxs</code></td>
<td>
<p>Extension of y-axis. By default, add no extra white-space at both extremes (<code>yaxs="i"</code>). See ?par for other options.</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_bty">bty</code></td>
<td>
<p>Type of box to be drawn around the plot (<code>"n"</code> for none, and <code>"l"</code> (default), <code>"7"</code>, <code>"c"</code>, <code>"u"</code>, or <code>"o"</code> for correspondingly shaped boxes).</p>
</td></tr>
<tr><td><code id="accrate.depth.ghost_+3A_remove.laststep">remove.laststep</code></td>
<td>
<p>Add a white line to remove spurious lines at the extreme of the graph. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot shows the modelled accumulation rates in grey-scales, where darker grey indicates more likely accumulation rates.
Axis limits for accumulation rates are estimated automatically, however upper limits can be very variable (and thus hard to predict)
if calculated in cm/yr; therefore you might want to manually adapt the axis limits after plotting with default settings (e.g., <code>acc.lim=c(0,1)</code>). See also <code>accrate.age.ghost</code>, <code>accrate.depth</code> and <code>accrate.age</code>.
</p>


<h3>Value</h3>

<p>A grey-scale plot of accumulation rate against core depth, and (invisibly) the list of depths and their accumulation rates (ranges, medians, means).
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  Bacon(run=FALSE, coredir=tempfile())
  agedepth(yr.res=50, d.res=50, d.by=10)
  layout(1)
  tmp &lt;- accrate.depth.ghost()
  head(tmp)

## End(Not run)
</code></pre>

<hr>
<h2 id='add.dates'>Add dates to age-depth plots</h2><span id='topic+add.dates'></span>

<h3>Description</h3>

<p>Add dated depths to plots, e.g. to show dates that weren't used in the age-depth model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add.dates(
  mn,
  sdev,
  depth,
  cc = 1,
  set = get("info"),
  above = 1e-06,
  postbomb = 0,
  normal = TRUE,
  delta.R = set$delta.R,
  delta.STD = set$delta.STD,
  t.a = set$t.a,
  t.b = set$t.b,
  date.res = 100,
  height = 0.1,
  calheight = 1,
  agesteps = 1,
  cutoff = 0.005,
  col = rgb(1, 0, 0, 0.5),
  border = rgb(1, 0, 0, 0.5),
  rotate.axes = FALSE,
  mirror = TRUE,
  up = TRUE,
  BCAD = FALSE,
  pch = 4,
  cc.dir = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add.dates_+3A_mn">mn</code></td>
<td>
<p>Reported mean of the date. Can be multiple dates. Negative numbers indicate postbomb dates (if cc &gt; 0).</p>
</td></tr>
<tr><td><code id="add.dates_+3A_sdev">sdev</code></td>
<td>
<p>Reported error of the date. Can be multiple dates.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_depth">depth</code></td>
<td>
<p>Depth of the date.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_cc">cc</code></td>
<td>
<p>The calibration curve to use: <code>cc=1</code> for IntCal20 (northern hemisphere terrestrial), <code>cc=2</code> for Marine20 (marine), <code>cc=0</code> for none (dates that are already on the cal BP scale).</p>
</td></tr>
<tr><td><code id="add.dates_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_above">above</code></td>
<td>
<p>Threshold for plotting of probability values. Defaults to <code>above=1e-3</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_postbomb">postbomb</code></td>
<td>
<p>Use a postbomb curve for negative (i.e. postbomb) 14C ages. <code>0 = none, 1 = NH1, 2 = NH2, 3 = NH3, 4 = SH1-2, 5 = SH3</code></p>
</td></tr>
<tr><td><code id="add.dates_+3A_normal">normal</code></td>
<td>
<p>By default, Bacon uses the t-distribution (Christen and Perez 2009) to treat the dates. Use <code>normal=TRUE</code> to use the normal/Gaussian distribution. This will generally give higher weight to the dates.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_delta.r">delta.R</code></td>
<td>
<p>Mean of core-wide age offsets (e.g., regional marine offsets).</p>
</td></tr>
<tr><td><code id="add.dates_+3A_delta.std">delta.STD</code></td>
<td>
<p>Error of core-wide age offsets (e.g., regional marine offsets).</p>
</td></tr>
<tr><td><code id="add.dates_+3A_t.a">t.a</code></td>
<td>
<p>The dates are treated using the t distribution by default (<code>normal=FALSE</code>).
The t model has two parameters, t.a and t.b, set at 3 and 4 by default (see Christen and Perez, 2010).
If you want to assign narrower error distributions (more closely resembling the normal distribution), set t.a and t.b at for example 33 and 34 respectively (e.g., for specific dates in your .csv file).
For symmetry reasons, t.a must always be equal to t.b-1.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_t.b">t.b</code></td>
<td>
<p>The dates are treated using the t distribution by default (<code>normal=FALSE</code>).
The t-distribution has two parameters, t.a and t.b, set at 3 and 4 by default (see Christen and Perez, 2010).
If you want to assign narrower error distributions (more closely resembling the normal distribution), set t.a and t.b at for example 33 and 34 respectively (e.g., for specific dates in your .csv file).
For symmetry reasons, t.a must always be equal to t.b-1.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_date.res">date.res</code></td>
<td>
<p>Resolution of the date's distribution. Defaults to <code>date.res=100</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_height">height</code></td>
<td>
<p>The heights of the distributions of the dates. See also <code>normalise.dists</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_calheight">calheight</code></td>
<td>
<p>Multiplier for the heights of the distributions of dates on the calendar scale. Defaults to <code>calheight=1</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_agesteps">agesteps</code></td>
<td>
<p>Step size for age units of the distribution. Default <code>agesteps=1</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_cutoff">cutoff</code></td>
<td>
<p>Avoid plotting very low probabilities of date distributions (default <code>cutoff=0.005</code>).</p>
</td></tr>
<tr><td><code id="add.dates_+3A_col">col</code></td>
<td>
<p>The colour of the ranges of the date. Default is semi-transparent red: <code>col=rgb(1,0,0,.5)</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_border">border</code></td>
<td>
<p>The colours of the borders of the date. Default is semi-transparent red: <code>border=rgb(1,0,0,0.5)</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>The default of plotting age on the horizontal axis and event probability on the vertical one can be changed with <code>rotate.axes=TRUE</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_mirror">mirror</code></td>
<td>
<p>Plot the dates as 'blobs'. Set to <code>mirror=FALSE</code> to plot simple distributions.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_up">up</code></td>
<td>
<p>Directions of distributions if they are plotted non-mirrored. Default <code>up=TRUE</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_pch">pch</code></td>
<td>
<p>The shape of any marker to be added to the date. Defaults to a cross, <code>pch=4</code>. To leave empty, use <code>pch=NA</code>.</p>
</td></tr>
<tr><td><code id="add.dates_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory where the calibration curves for C14 dates <code>cc</code> are located. By default <code>cc.dir=c()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes it is useful to add additional dating information to age-depth plots, e.g., to show outliers or how dates calibrate with different estimated offsets. Calls rintcal's draw.dates function.
</p>


<h3>Value</h3>

<p>A date's distribution, added to an age-depth plot.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  Bacon(run=FALSE, coredir=tempfile())
  agedepth()
  add.dates(5000, 100, 60)

</code></pre>

<hr>
<h2 id='agedepth'>Plot an age-depth model</h2><span id='topic+agedepth'></span>

<h3>Description</h3>

<p>Plot the age-depth model of a core.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agedepth(
  set = get("info"),
  BCAD = set$BCAD,
  depth.unit = set$depth.unit,
  age.unit = "yr",
  unit = depth.unit,
  d.lab = c(),
  age.lab = c(),
  yr.lab = age.lab,
  kcal = FALSE,
  acc.lab = c(),
  d.min = c(),
  d.max = c(),
  d.by = c(),
  depths = set$depths,
  depths.file = FALSE,
  accordion = c(),
  plotatthesedepths = c(),
  age.min = c(),
  yr.min = age.min,
  age.max = c(),
  yr.max = age.max,
  hiatus.option = 1,
  dark = c(),
  prob = set$prob,
  rounded = c(),
  d.res = 400,
  age.res = 400,
  yr.res = age.res,
  date.res = 100,
  rotate.axes = FALSE,
  rev.age = FALSE,
  rev.yr = rev.age,
  rev.d = FALSE,
  maxcalc = 500,
  height = 1,
  calheight = 1,
  mirror = TRUE,
  up = TRUE,
  cutoff = 0.1,
  plot.range = TRUE,
  range.col = grey(0.5),
  range.lty = "12",
  mn.col = "red",
  mn.lty = "12",
  med.col = NA,
  med.lty = "12",
  C14.col = rgb(0, 0, 1, 0.35),
  C14.border = rgb(0, 0, 1, 0.5),
  cal.col = rgb(0, 0.5, 0.5, 0.35),
  cal.border = rgb(0, 0.5, 0.5, 0.5),
  dates.col = c(),
  pb.background = 0.5,
  pbmodelled.col = function(x) rgb(0, 0, 1, 0.5 * x),
  pbmeasured.col = "blue",
  pb.lim = c(),
  supp.col = "purple",
  plot.tail = TRUE,
  remove.tail = TRUE,
  MCMC.resample = TRUE,
  hiatus.col = grey(0.5),
  hiatus.lty = "12",
  rgb.scale = c(0, 0, 0),
  rgb.res = 100,
  slump.col = grey(0.8),
  normalise.dists = TRUE,
  same.heights = FALSE,
  cc = set$cc,
  title = set$core,
  title.location = "topleft",
  title.size = 1.5,
  plot.labels = FALSE,
  labels = c(),
  label.age = 1,
  label.size = 0.8,
  label.col = "black",
  label.offset = c(0, 0),
  label.adj = c(0.5, 0),
  label.rot = 0,
  after = set$after,
  bty = "l",
  mar.left = c(3, 3, 1, 0.5),
  mar.middle = c(3, 0, 1, 0.5),
  mar.right = c(3, 0, 1, 0.5),
  mar.main = c(3, 3, 1, 1),
  righthand = 3,
  mgp = c(1.7, 0.7, 0),
  xaxs = "r",
  yaxs = "i",
  prior.ticks = "n",
  prior.fontsize = 0.9,
  toppanel.fontsize = 0.9,
  mainpanel.tickfontsize = 1,
  mainpanel.labelfontsize = 1,
  acc.xlim = c(),
  acc.ylim = c(),
  mem.xlim = c(),
  mem.ylim = c(),
  hiatus.xlim = c(),
  hiatus.ylim = c(),
  phi.xlim = c(),
  phi.ylim = c(),
  supp.xlim = c(),
  supp.ylim = c(),
  xaxt = "s",
  yaxt = "s",
  plot.pb = TRUE,
  pb.lty = 1,
  plot.pdf = FALSE,
  dates.only = FALSE,
  model.only = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agedepth_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_depth.unit">depth.unit</code></td>
<td>
<p>Units of the depths. Defaults to the one provided in the Bacon() command, <code>depth.unit=set$depth.unit</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_age.unit">age.unit</code></td>
<td>
<p>Units of the ages. Defaults to <code>age.unit="yr"</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_unit">unit</code></td>
<td>
<p>Deprecated and replaced by <code>depth.unit</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_d.lab">d.lab</code></td>
<td>
<p>The labels for the depth axis. Default <code>d.lab="Depth (cm)"</code>. See also <code>depth.unit</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_age.lab">age.lab</code></td>
<td>
<p>The labels for the calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_yr.lab">yr.lab</code></td>
<td>
<p>Deprecated - use age.lab instead</p>
</td></tr>
<tr><td><code id="agedepth_+3A_kcal">kcal</code></td>
<td>
<p>Use kcal BP. Default is <code>kcal=FALSE</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_acc.lab">acc.lab</code></td>
<td>
<p>The labels for the accumulation rate plot (top middle). Default <code>d.lab="Acc. rate (yr/cm)"</code> (or whatever units you're using).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_d.min">d.min</code></td>
<td>
<p>Minimum depth of age-depth model (use this to extrapolate to depths higher than the top dated depth).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_d.max">d.max</code></td>
<td>
<p>Maximum depth of age-depth model (use this to extrapolate to depths below the bottom dated depth).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_d.by">d.by</code></td>
<td>
<p>Depth intervals at which ages are calculated. Default 1. Alternative depth intervals can be provided using, e.g., d.<code>d.by=0.5</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_depths">depths</code></td>
<td>
<p>By default, Bacon will calculate the ages for the depths <code>d.min</code> to <code>d.max</code> in steps of <code>d.by</code>. Alternative depths can be provided as, e.g., <code>depths=seq(0, 100, length=500)</code> or as a file, e.g., <code>depths=read.table("CoreDepths.txt"</code>. See also <code>depths.file</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_depths.file">depths.file</code></td>
<td>
<p>By default, Bacon will calculate the ages for the depths <code>d.min</code> to <code>d.max</code> in steps of <code>d.by</code>.
If <code>depths.file=TRUE</code>, Bacon will read a file containing the depths for which you require ages.
This file, containing the depths in a single column without a header, should be stored within <code>coredir</code>,
and its name should start with the core's name and end with '_depths.txt'. Then specify <code>depths.file=TRUE</code> (default <code>FALSE</code>). See also <code>depths</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_accordion">accordion</code></td>
<td>
<p>An experimental option to squeeze and stretch depths below a boundary. Needs 2 parameters: boundary depth and compression ratio, e.g., <code>accordion=c(25,20)</code>. Defaults to inactive, <code>accordion=c()</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_plotatthesedepths">plotatthesedepths</code></td>
<td>
<p>An option to plot ages at different depths (e.g., if a core has been compressed during a run). Use with extreme caution!</p>
</td></tr>
<tr><td><code id="agedepth_+3A_age.min">age.min</code></td>
<td>
<p>Minimum age of the age-depth plot.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_yr.min">yr.min</code></td>
<td>
<p>Deprecated - use age.min instead.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_age.max">age.max</code></td>
<td>
<p>Maximum age of the age-depth plot.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_yr.max">yr.max</code></td>
<td>
<p>Deprecated - use age.min instead.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_hiatus.option">hiatus.option</code></td>
<td>
<p>How to calculate accumulation rates and ages for sections with hiatuses. Either extrapolate from surrounding sections (default, <code>hiatus.option=1</code>), use a w-weighted mix between the prior and posterior values for depths below the hiatus and prior information only for above the hiatus (<code>hiatus.option=2</code>), or use the originally calculated slopes (<code>hiatus.option=0</code>).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_dark">dark</code></td>
<td>
<p>Darkness of the greyscale age-depth model. By default, the darkest grey value is calculated as 10 times the height of the lowest-precision age estimate <code>dark=c()</code>. Lower values will result in lighter grey but values &gt;1 are not allowed.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_prob">prob</code></td>
<td>
<p>Confidence interval to report (between 0 and 1, default 0.95 or 95%).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_rounded">rounded</code></td>
<td>
<p>Rounding of years. Default is to round to single years (1 digit for plum models).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_d.res">d.res</code></td>
<td>
<p>Resolution or amount of greyscale pixels to cover the depth scale of the age-model plot. Default <code>d.res=200</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_age.res">age.res</code></td>
<td>
<p>Resolution or amount of greyscale pixels to cover the age scale of the age-model plot. Default <code>yr.res=200</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_yr.res">yr.res</code></td>
<td>
<p>Deprecated - use age.res instead.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_date.res">date.res</code></td>
<td>
<p>Date distributions are plotted using <code>date.res=100</code> points by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>By default, the age-depth model is plotted with the depths on the horizontal axis and ages on the vertical axis. This can be changed with <code>rotate.axes=TRUE</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_rev.age">rev.age</code></td>
<td>
<p>The direction of the age axis, which can be reversed using <code>rev.age=TRUE</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_rev.yr">rev.yr</code></td>
<td>
<p>Deprecated - use rev.age instead.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_rev.d">rev.d</code></td>
<td>
<p>The direction of the depth axis, which can be reversed using <code>rev.d=TRUE</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_maxcalc">maxcalc</code></td>
<td>
<p>Number of depths to calculate ages for. If this is more than <code>maxcalc=500</code>, a warning will be shown that calculations will take time.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_height">height</code></td>
<td>
<p>The maximum heights of the distributions of the dates on the plot. See also <code>normalise.dists</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_calheight">calheight</code></td>
<td>
<p>Multiplier for the heights of the distributions of dates on the calendar scale. Defaults to <code>calheight=1</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mirror">mirror</code></td>
<td>
<p>Plot the dates as 'blobs'. Set to <code>mirror=FALSE</code> to plot simple distributions.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_up">up</code></td>
<td>
<p>Directions of distributions if they are plotted non-mirrored. Default <code>up=TRUE</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_cutoff">cutoff</code></td>
<td>
<p>Avoid plotting very low probabilities of date distributions (default <code>cutoff=0.1</code>).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_plot.range">plot.range</code></td>
<td>
<p>Whether or not to plot the curves showing the confidence ranges of the age-model. Defaults to (<code>plot.range=TRUE</code>).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_range.col">range.col</code></td>
<td>
<p>The colour of the curves showing the confidence ranges of the age-model. Defaults to medium grey (<code>range.col=grey(0.5)</code>).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_range.lty">range.lty</code></td>
<td>
<p>The line type of the curves showing the confidence ranges of the age-model. Defaults to <code>range.lty=12</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mn.col">mn.col</code></td>
<td>
<p>The colour of the mean age-depth model: default <code>mn.col="red"</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mn.lty">mn.lty</code></td>
<td>
<p>The line type of the mean age-depth model. Default <code>mn.lty=12</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_med.col">med.col</code></td>
<td>
<p>The colour of the median age-depth model: not drawn by default <code>med.col=NA</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_med.lty">med.lty</code></td>
<td>
<p>The line type of the median age-depth model. Default <code>med.lty=12</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_c14.col">C14.col</code></td>
<td>
<p>The colour of the calibrated ranges of the dates. Default is semi-transparent blue: <code>C14.col=rgb(0,0,1,.35)</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_c14.border">C14.border</code></td>
<td>
<p>The colours of the borders of calibrated 14C dates. Default is semi-transparent dark blue: <code>C14.border=rgb(0, 0, 1, 0.5)</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_cal.col">cal.col</code></td>
<td>
<p>The colour of the non-14C dates. Default is semi-transparent blue-green: <code>cal.col=rgb(0,.5,.5,.35)</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_cal.border">cal.border</code></td>
<td>
<p>The colour of the border of non-14C dates in the age-depth plot: default semi-transparent dark blue-green: <code>cal.border=rgb(0,.5,.5,.5)</code>. Not used by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_dates.col">dates.col</code></td>
<td>
<p>As an alternative to colouring dates based on whether they are 14C or not, sets of dates can be coloured as, e.g., <code>dates.col=colours()[2:100]</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_pb.background">pb.background</code></td>
<td>
<p>Probability at which total Pb values are considered to have reached background values, or in other words, that their modelled values are at or below supported + detection limit (Al)). Setting this at 0.5 means that any depth with a Pb measurement, where at least half of the iterations model Pb values reaching background values, is flagged as having reached background. The age-model is not extended to any Pb measurements that have reached background.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_pbmodelled.col">pbmodelled.col</code></td>
<td>
<p>Colour of the modelled 210Pb values. Defaults to shades of blue: <code>pbmodelled.col=function(x) rgb(0,0,1,x)</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_pbmeasured.col">pbmeasured.col</code></td>
<td>
<p>Colour of the measured 210Pb values (default <code>pbmeasured.col="blue"</code>). Draws rectangles of the upper and lower depths as well as the Pb values with 95 percent error ranges.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_pb.lim">pb.lim</code></td>
<td>
<p>Axis limits for the Pb-210 data. Calculated automatically by default (<code>pblim=c()</code>).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_supp.col">supp.col</code></td>
<td>
<p>Colour of supported Pb-210. Defaults to purple, because why not.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_plot.tail">plot.tail</code></td>
<td>
<p>The depth axis can extend to all Pb measurements (<code>plot.tail=TRUE</code>), or leave out the ones where background has been reached.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_remove.tail">remove.tail</code></td>
<td>
<p>Whether or not to remove the tail measurements when plotting. Sometimes automated removal might go wrong, so then this option can be used to avoid removing the tail measurements. Quite similar to plot.tail.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mcmc.resample">MCMC.resample</code></td>
<td>
<p>After the MCMC run, if there are more MCMC iterations than requested, only the last 'ssize' iterations will be retained. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_hiatus.col">hiatus.col</code></td>
<td>
<p>The colour of the depths of any hiatuses. Default <code>hiatus.col=grey(0.5)</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_hiatus.lty">hiatus.lty</code></td>
<td>
<p>The line type of the depths of any hiatuses. Default <code>hiatus.lty=12</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_rgb.scale">rgb.scale</code></td>
<td>
<p>The function to produce a coloured representation of all age-models. Needs 3 values for the intensity of red, green and blue. Defaults to grey-scales: <code>rgb.scale=c(0,0,0)</code>, but could also be, say, scales of red (<code>rgb.scale=c(1,0,0)</code>).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_rgb.res">rgb.res</code></td>
<td>
<p>Resolution of the colour spectrum depicting the age-depth model. Default <code>rgb.res=100</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_slump.col">slump.col</code></td>
<td>
<p>Colour of slumps. Defaults to <code>slump.col=grey(0.8)</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_normalise.dists">normalise.dists</code></td>
<td>
<p>By default, the distributions of more precise dates will cover less time and will thus peak higher than less precise dates. This can be avoided by specifying <code>normalise.dists=FALSE</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_same.heights">same.heights</code></td>
<td>
<p>Plot the distributions of the dates all at the same maximum height (default <code>same.height=FALSE</code>).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_cc">cc</code></td>
<td>
<p>Calibration curve for 14C dates: <code>cc=1</code> for IntCal20 (northern hemisphere terrestrial), <code>cc=2</code> for Marine20 (marine), <code>cc=3</code> for SHCal20 (southern hemisphere terrestrial). For dates that are already on the cal BP scale use <code>cc=0</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_title">title</code></td>
<td>
<p>The title of the age-depth model is plotted on the main panel. By default this is the core's name. To leave empty: <code>title=""</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_title.location">title.location</code></td>
<td>
<p>Location of the title. Default <code>title.location='topleft'</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_title.size">title.size</code></td>
<td>
<p>Size of the title font. Defaults to <code>title.size=1.5</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_plot.labels">plot.labels</code></td>
<td>
<p>Whether or not to plot labels next to the dated depths. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_labels">labels</code></td>
<td>
<p>Add labels to the dates (as given by the first column of the .csv file). <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_label.age">label.age</code></td>
<td>
<p>Position on the age axis of the date labels. By default draws them before the youngest age (1), but can also draw them after the oldest age (2), or above its mean (3).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_label.size">label.size</code></td>
<td>
<p>Size of labels.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_label.col">label.col</code></td>
<td>
<p>Colour of the labels. Defaults to the colour given to the borders of the dates.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_label.offset">label.offset</code></td>
<td>
<p>Offsets of the positions of the labels, giving the x and y offsets. Defaults to c(0,0).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_label.adj">label.adj</code></td>
<td>
<p>Justification of the labels. Follows R's adj option: A value of ‘0’ produces left-justified text, ‘0.5’ (the default) centered text and ‘1’ right-justified text.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_label.rot">label.rot</code></td>
<td>
<p>Rotation of the label. 0 by default (horizontal).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_after">after</code></td>
<td>
<p>Sets a short section above and below hiatus.depths within which to calculate ages. For internal calculations - do not change.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_bty">bty</code></td>
<td>
<p>Type of box to be drawn around plots (<code>"n"</code> for none, and <code>"l"</code> (default), <code>"7"</code>, <code>"c"</code>, <code>"u"</code>, or <code>"o"</code> for correspondingly shaped boxes).</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mar.left">mar.left</code></td>
<td>
<p>Plot margins for the topleft panel (amount of white space along edges of axes 1-4). Default <code>mar.left=c(3,3,1,1)</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mar.middle">mar.middle</code></td>
<td>
<p>Plot margins for the middle panel(s) at the top (amount of white space along edges of axes 1-4). Default <code>mar.middle=c(3,3,1,1)</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mar.right">mar.right</code></td>
<td>
<p>Plot margins for the topright panel (amount of white space along edges of axes 1-4). Default <code>mar.right=c(3,3,1,1)</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mar.main">mar.main</code></td>
<td>
<p>Plot margins for the main panel (amount of white space along edges of axes 1-4). Default <code>mar.main=c(3,3,1,1)</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_righthand">righthand</code></td>
<td>
<p>Adapt the righthand margins by a certain amount (default 2) to allow a righthand axis to be plotted (for plum)</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mgp">mgp</code></td>
<td>
<p>Axis text margins (where should titles, labels and tick marks be plotted). Defaults to <code>mgp=c(1.7, .7, .0)</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_xaxs">xaxs</code></td>
<td>
<p>Extension of x-axis. By default, add some extra white-space at both extremes (<code>xaxs="r"</code>). See ?par for other options.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_yaxs">yaxs</code></td>
<td>
<p>Extension of y-axis. By default, add no extra white-space at both extremes (<code>yaxs="i"</code>). See ?par for other options.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_prior.ticks">prior.ticks</code></td>
<td>
<p>Plot tickmarks and values on the vertical axes for the prior and posterior distributions. Defaults to no tick marks (<code>prior.ticks="n"</code>). Set to <code>prior.ticks="s"</code> to plot the tick marks. Note that these values are of little practical use, as they correspond poorly to, e.g., the mean and strength values. All that matters is that the areas of both the prior and the posterior distributions sum to 1; wider distributions tend to give lower peaks, and narrower distributions higher peaks.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_prior.fontsize">prior.fontsize</code></td>
<td>
<p>Font size of the prior, relative to R's standard size. Defaults to <code>prior.fontsize=0.9</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_toppanel.fontsize">toppanel.fontsize</code></td>
<td>
<p>Font size of the top panels, relative to R's standard size. Defaults to <code>prior.fontsize=0.9</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mainpanel.tickfontsize">mainpanel.tickfontsize</code></td>
<td>
<p>Font size of values at the tick marks in the main panel, relative to R's standard size. Defaults to <code>mainpanel.tickfontsize=1</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mainpanel.labelfontsize">mainpanel.labelfontsize</code></td>
<td>
<p>Font size of axis labels in the main panel, relative to R's standard size. Defaults to <code>mainpanel.labelsize=1</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_acc.xlim">acc.xlim</code></td>
<td>
<p>Horizontal axis limits of the accumulation rate panel. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_acc.ylim">acc.ylim</code></td>
<td>
<p>Vertical axis limits of the accumulation rate panel. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mem.xlim">mem.xlim</code></td>
<td>
<p>Horizontal axis limits of the memory panel. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_mem.ylim">mem.ylim</code></td>
<td>
<p>Vertical axis limits of the memory panel. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_hiatus.xlim">hiatus.xlim</code></td>
<td>
<p>Horizontal axis limits of the hiatus size panel. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_hiatus.ylim">hiatus.ylim</code></td>
<td>
<p>Vertical axis limits of the hiatus size panel. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_phi.xlim">phi.xlim</code></td>
<td>
<p>Horizontal axis limits of the phi panel. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_phi.ylim">phi.ylim</code></td>
<td>
<p>Vertical axis limits of the phi panel. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_supp.xlim">supp.xlim</code></td>
<td>
<p>Horizontal axis limits of the supported-Pb panel. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_supp.ylim">supp.ylim</code></td>
<td>
<p>Vertical axis limits of the supported-Pb panel. Calculated automatically by default.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_xaxt">xaxt</code></td>
<td>
<p>Whether or not to plot the x-axis. Can be used to adapt axes after a plot. See ?par for other options.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_yaxt">yaxt</code></td>
<td>
<p>Whether or not to plot the y-axis. Can be used to adapt axes after a plot. See ?par for other options.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_plot.pb">plot.pb</code></td>
<td>
<p>Plot the 210Pb data (if present). Defaults to <code>plot.pb=TRUE</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_pb.lty">pb.lty</code></td>
<td>
<p>Line type of measured Pb-210 data.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_plot.pdf">plot.pdf</code></td>
<td>
<p>Produce a pdf file of the age-depth plot.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_dates.only">dates.only</code></td>
<td>
<p>By default, the age-depth model is plotted on top of the dates. This can be avoided by supplying <code>dates.only=TRUE</code>.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_model.only">model.only</code></td>
<td>
<p>By default, panels showing the MCMC iterations and the priors and posteriors for accumulation rate and memory are plotted above the main age-depth model panel. This can be avoided by supplying <code>model.only=TRUE</code>. Note however that this removes relevant information to evaluate the age-depth model, so we do recommend to present age-models together with these upper panels.</p>
</td></tr>
<tr><td><code id="agedepth_+3A_verbose">verbose</code></td>
<td>
<p>Provide a summary of the age ranges after producing the age-depth model graph; default <code>verbose=FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After loading a previous run, or after running either the <a href="#topic+scissors">scissors</a> or <a href="#topic+thinner">thinner</a> command, plot the age-model
again using the command <code>agedepth()</code>.
</p>


<h3>Value</h3>

<p>A plot of the age-depth model, and estimated ages incl. confidence ranges for each depth.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  Bacon(ask=FALSE, coredir=tempfile())
  agedepth()

</code></pre>

<hr>
<h2 id='agemodel.it'>Extract one age-model iteration</h2><span id='topic+agemodel.it'></span>

<h3>Description</h3>

<p>For one MCMC iteration (it), extract the corresponding age-depth model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agemodel.it(it, set = get("info"), BCAD = set$BCAD)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agemodel.it_+3A_it">it</code></td>
<td>
<p>The MCMC iteration of which the age-model should be calculated.</p>
</td></tr>
<tr><td><code id="agemodel.it_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable info.</p>
</td></tr>
<tr><td><code id="agemodel.it_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A variable with two columns - depth and the age-depth model of a single iteration.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  Bacon(run=FALSE, coredir=tempfile())
  agedepth(age.res=50, d.res=50, d.by=10)
  lines(agemodel.it(5), col="red")

## End(Not run)
</code></pre>

<hr>
<h2 id='AgesOfEvents'>Event probabilities against calendar age</h2><span id='topic+AgesOfEvents'></span>

<h3>Description</h3>

<p>Plot probability curves for events in the core, expressed against calendar age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AgesOfEvents(
  window,
  move,
  set = get("info"),
  plot.steps = FALSE,
  BCAD = set$BCAD,
  age.lab = c(),
  yr.lab = age.lab,
  age.lim = c(),
  yr.lim = age.lim,
  prob.lab = "probability",
  prob.lim = c(),
  rotate.axes = FALSE,
  rev.age = TRUE,
  rev.yr = rev.age,
  yaxs = "i",
  bty = "l"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AgesOfEvents_+3A_window">window</code></td>
<td>
<p>Width of the window.</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_move">move</code></td>
<td>
<p>Step size with which the window moves.</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_plot.steps">plot.steps</code></td>
<td>
<p>Plot probability values step-wise (defaults to <code>plot.steps=FALSE</code>, which plots smooth curves instead).</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_age.lab">age.lab</code></td>
<td>
<p>The labels for the calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>).</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_yr.lab">yr.lab</code></td>
<td>
<p>Deprecated - use age.lab instead</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_age.lim">age.lim</code></td>
<td>
<p>Minimum and maximum calendar age ranges, calculated automatically by default (<code>age.lim=c()</code>).</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_yr.lim">yr.lim</code></td>
<td>
<p>Deprecated - use age.lim instead</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_prob.lab">prob.lab</code></td>
<td>
<p>Label of the probability axis (default <code>prob.lab="probability"</code>).</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_prob.lim">prob.lim</code></td>
<td>
<p>Limits of the probability axis (calculated automatically by default).</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>The default of plotting age on the horizontal axis and event probability on the vertical one can be changed with <code>rotate.axes=TRUE</code>.</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_rev.age">rev.age</code></td>
<td>
<p>The direction of the age axis, which can be reversed using <code>rev.age=TRUE</code>.</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_rev.yr">rev.yr</code></td>
<td>
<p>Deprecated - use rev.age instead</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_yaxs">yaxs</code></td>
<td>
<p>Extension of the y-axis. Defaults to the exact ranges of the probability values. White space can be added to the vertical axis using <code>yaxs="r"</code>.</p>
</td></tr>
<tr><td><code id="AgesOfEvents_+3A_bty">bty</code></td>
<td>
<p>Type of box to be drawn around plots. Draw a box around the graph (<code>"n"</code> for none, and <code>"l"</code>, <code>"7"</code>,
<code>"c"</code>, <code>"u"</code>, &quot;]&quot; or <code>"o"</code> for correspondingly shaped boxes).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Probabilities of depths with 'events' in an age-modelled core can be plotted against time, taking into account
chronological uncertainties (Blaauw et al. 2007). Such events could be for example core depths at which proxies
indicate changes toward wetter local conditions. This can be expressed as values between 0 (no event) and 1 (event at 100% probability)
for each depth.
</p>
<p>Blaauw et al. 2010 propose to estimate probabilities of events by finding specific proxy features such as increasing curves.
Probabilities are then estimated through resampling from the proxy values, where low to modest rises of proxy curves result
in low event probabilities, and clear proxy rises in high probabilities. A smooth spline can be applied to adapt the balance of short-term vs long-term events. To calculate the event probabilities,
produce a file with two columns (depth and corresponding proxy-derived probabilities, separated by white spaces).
Do not provide headers at the file's first line, and save the file with extension &quot;_events.txt&quot; within the core's Bacon folder. See Cores/MSB2K/MSB2K_events.txt (or Bacon_runs/MSB2K/MSB2K_events.txt) for an example. Events are calculated as the probability that an event took place within specific time windows - or more specifically, that the Bacon age-depth model puts depths with assigned event probabilities in that time window.
</p>
<p>does not yet deal correctly with hiatuses.
</p>


<h3>Value</h3>

<p>The resulting probabilities are plotted and saved within the core's folder (file names ending with the window width and &quot;_probs.txt&quot;).
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>References</h3>

<p>Blaauw, M., Christen, J.A., Mauquoy, D., van der Plicht, J., Bennett, K.D. (2007) Testing the timing of radiocarbon-dated events between proxy archives. _The Holocene_, *17*, 283-288.
Blaauw, M., Wohlfarth, B., Christen, J.A., Ampel, L., Veres, D., Hughen, K.A., Preusser, F., Svensson, A. (2010) Were last glacial climate events simultaneous between Greenland and France? A quantitative comparison using non-tuned chronologies. _Journal of Quaternary Science_ *25*, 387-394.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  Bacon(run=FALSE, coredir=tempfile())
  agedepth(yr.res=50)
  AgesOfEvents(100, 10)

</code></pre>

<hr>
<h2 id='background'>calculate probabilities that Pb-210 data have reached background levels</h2><span id='topic+background'></span>

<h3>Description</h3>

<p>Checks which of the Pb-210 data most likely have reached background levels and thus are below the detection limit Al (probabilities between 0 and 1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>background(set = get("info"), Al = set$Al)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="background_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="background_+3A_al">Al</code></td>
<td>
<p>The detection limit. Default <code>Al=0.1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of probabilities for each Pb-210 data point
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>

<hr>
<h2 id='Bacon'>Main age-depth modelling function</h2><span id='topic+Bacon'></span>

<h3>Description</h3>

<p>This is the main age-depth modelling function of the rbacon package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bacon(
  core = "MSB2K",
  thick = 5,
  coredir = "",
  prob = 0.95,
  d.min = NA,
  d.max = NA,
  add.bottom = TRUE,
  d.by = 1,
  seed = NA,
  depths.file = FALSE,
  depths = c(),
  depth.unit = "cm",
  age.unit = "yr",
  unit = depth.unit,
  acc.shape = 1.5,
  acc.mean = 20,
  mem.strength = 10,
  mem.mean = 0.5,
  boundary = NA,
  hiatus.depths = NA,
  hiatus.max = 10000,
  add = c(),
  after = 1e-04/thick,
  cc = 1,
  cc1 = "IntCal20",
  cc2 = "Marine20",
  cc3 = "SHCal20",
  cc4 = "ConstCal",
  cc.dir = c(),
  postbomb = 0,
  delta.R = 0,
  delta.STD = 0,
  t.a = 3,
  t.b = 4,
  normal = FALSE,
  suggest = TRUE,
  accept.suggestions = FALSE,
  reswarn = c(10, 200),
  remember = TRUE,
  ask = TRUE,
  run = TRUE,
  defaults = "defaultBacon_settings.txt",
  sep = ",",
  dec = ".",
  runname = "",
  slump = c(),
  remove = FALSE,
  BCAD = FALSE,
  ssize = 4000,
  th0 = c(),
  burnin = min(500, ssize),
  youngest.age = c(),
  oldest.age = c(),
  MinAge = c(),
  MaxAge = c(),
  cutoff = 0.01,
  plot.pdf = TRUE,
  dark = 1,
  date.res = 100,
  age.res = 200,
  yr.res = age.res,
  close.connections = TRUE,
  older.than = c(),
  younger.than = c(),
  save.elbowages = FALSE,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bacon_+3A_core">core</code></td>
<td>
<p>Name of the core, given using quotes. Defaults to one of the cores provided with rbacon, <code>core="MSB2K"</code>.
An alternative core provided with this package is RLGH3 (Jones et al., 1989).
To run your own core, produce a .csv file with the dates as outlined in the manual, add a folder with the core's name to the default directory for cores (see <code>coredir</code>), and save the .csv file there. For example, the file's location and name could be <code>Bacon_runs/MyCore/MyCore.csv</code>. Then run Bacon as follows: <code>Bacon("MyCore")</code></p>
</td></tr>
<tr><td><code id="Bacon_+3A_thick">thick</code></td>
<td>
<p>Bacon will divide the core into sections of equal thickness specified by thick (default <code>thick=5</code>).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_coredir">coredir</code></td>
<td>
<p>Folder where the core's files <code>core</code> are and/or will be located. This will be a folder with the core's name, within either the folder <code>coredir='Bacon_runs/'</code>, or the folder Cores/ if it already exists within R's working directory, or a custom-built folder. For example, use <code>coredir="."</code> to place the core's folder within the current working directory, or <code>coredir="F:"</code> if you want to put the core's folder and files on a USB drive loaded under F:.
Thinner (and thus more) sections will result in smoother age-models, but too many sections can cause &lsquo;run-away&rsquo; models.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_prob">prob</code></td>
<td>
<p>Confidence interval to report. This should lie between 0 and 1, default 0.95 (95 %).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_d.min">d.min</code></td>
<td>
<p>Minimum depth of age-depth model (use this to extrapolate to depths higher than the top dated depth).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_d.max">d.max</code></td>
<td>
<p>Maximum depth of age-depth model (use this to extrapolate to depths below the bottom dated depth).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_add.bottom">add.bottom</code></td>
<td>
<p>Add a model section at the bottom of the core, in order to ensure the bottommost date is taken into account. Default <code>add.bottom=TRUE</code>. This is a new option and can cause age-models to differ from previous version. Please re-run the model if in doubt.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_d.by">d.by</code></td>
<td>
<p>Depth intervals at which ages are calculated. Defaults to <code>d.by=1</code>. Please ensure that the value of d.by is smaller than that of 'thick', otherwise plots might turn out wrong.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_seed">seed</code></td>
<td>
<p>Seed used for C++ executions. If it is not assigned (<code>seed=NA</code>; default) then the seed is set by system.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_depths.file">depths.file</code></td>
<td>
<p>By default, Bacon will calculate the ages for the depths <code>d.min</code> to <code>d.max</code> in steps of <code>d.by</code>.
If <code>depths.file=TRUE</code>, Bacon will read a file containing the depths for which you require ages.
This file, containing the depths in a single column without a header, should be stored within <code>coredir</code>,
and its name should start with the core's name and end with &lsquo;_depths.txt&rsquo;. Then specify <code>depths.file=TRUE</code> (default <code>FALSE</code>). See also <code>depths</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_depths">depths</code></td>
<td>
<p>By default, Bacon will calculate the ages for the depths <code>d.min</code> to <code>d.max</code> in steps of <code>d.by</code>.
Alternative depths can be provided as, e.g., <code>depths=seq(0, 100, length=500)</code> or as a file, e.g., <code>depths=read.table("CoreDepths.txt"</code>. See also <code>depths.file</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_depth.unit">depth.unit</code></td>
<td>
<p>Units of the depths. Defaults to <code>depth.unit="cm"</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_age.unit">age.unit</code></td>
<td>
<p>Units of the ages. Defaults to <code>age.unit="yr"</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_unit">unit</code></td>
<td>
<p>Deprecated and replaced by <code>depth.unit</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_acc.shape">acc.shape</code></td>
<td>
<p>The prior for the accumulation rate consists of a gamma distribution with two parameters.
Its shape is set by acc.shape (default <code>acc.shape=1.5</code>; higher values result in more peaked shapes).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_acc.mean">acc.mean</code></td>
<td>
<p>The accumulation rate prior consists of a gamma distribution with two parameters. Its mean is set by acc.mean (default <code>acc.mean=20</code> yr/cm (or whatever age or depth units are chosen),
which can be changed to, e.g., 5, 10 or 50 for different kinds of deposits). Multiple values can be given in case of hiatuses or boundaries, e.g., Bacon(hiatus.depths=23, acc.mean=c(5,20))</p>
</td></tr>
<tr><td><code id="Bacon_+3A_mem.strength">mem.strength</code></td>
<td>
<p>The prior for the memory (dependence of accumulation rate between neighbouring depths) is a beta distribution, which looks much like the gamma distribution.
but its values are always between 0 (no assumed memory) and 1 (100% memory). Its default settings of <code>mem.strength=10</code>
(higher values result in more peaked shapes) allow for a large range of posterior memory values. Please note that the default memory prior has been updated from rbacon version 2.5.1 on, to repair a bug.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_mem.mean">mem.mean</code></td>
<td>
<p>The prior for the memory is a beta distribution, which looks much like the gamma distribution but
its values are always between 0 (no assumed memory) and 1 (100% memory). Its default settings of <code>mem.mean=0.5</code>
allow for a large range of posterior memory values. Please note that the default memory prior has been updated from rbacon version 2.5.1. on, to repair a bug.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_boundary">boundary</code></td>
<td>
<p>The assumed depths of any boundary, which divides sections of different accumulation rate regimes (e.g., as indicated by major change in the stratigraphy). No hiatus is assumed between these sections, and memory is reset crossing the boundary. Different accumulation priors can be set for the sections above and below the boundary, e.g., <code>acc.mean=c(5, 20)</code>. See also <code>hiatus.depths</code>, <code>mem.mean</code>, <code>acc.mean</code> and <code>acc.shape</code>. Setting many boundaries might not work, and having more than one boundary per model section (see <code>'thick'</code>) might not work either.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_hiatus.depths">hiatus.depths</code></td>
<td>
<p>The assumed depths for any hiatus should be provided as, e.g.,
<code>hiatus.depths=20</code> for one at 20cm depth, and <code>hiatus.depths=c(20,40)</code> for two hiatuses at 20 and 40 cm depth.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_hiatus.max">hiatus.max</code></td>
<td>
<p>The prior for the maximum length of the hiatus. Hiatus length is a uniform distribution, with equal probabilities between 0 and <code>hiatus.max</code> yr (or whatever other <code>age.unit</code> is chosen).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_add">add</code></td>
<td>
<p>Add a value to the maximum hiatus length if a boundary is chosen. Defaults to 100 yr (or whatever other age unit is chosen). Can be adapted if Bacon complains that the parameters are out of support.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_after">after</code></td>
<td>
<p>Sets a short section above and below hiatus.depths within which to calculate ages. For internal calculations - do not change.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_cc">cc</code></td>
<td>
<p>Calibration curve for C-14 dates: <code>cc=1</code> for IntCal20 (northern hemisphere terrestrial), <code>cc=2</code> for Marine20 (marine),
<code>cc=3</code> for SHCal20 (southern hemisphere terrestrial). For dates that are already on the cal BP scale use <code>cc=0</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_cc1">cc1</code></td>
<td>
<p>For northern hemisphere terrestrial 14C dates (IntCal20).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_cc2">cc2</code></td>
<td>
<p>For marine 14C dates (Marine20).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_cc3">cc3</code></td>
<td>
<p>For southern hemisphere 14C dates (SHCal20).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_cc4">cc4</code></td>
<td>
<p>Use an alternative curve (3 columns: cal BP, 14C age, error, separated by white spaces and saved as a plain-text file). See <code>cc.dir</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_cc.dir">cc.dir</code></td>
<td>
<p>Directory where the calibration curves for C14 dates <code>cc</code> are located. By default uses the location of the rintcal package which provides the calibration curves. If you want to use custom-made calibration curves, first set up a new folder using the function new.ccdir() in the rintcal package, e.g., <code>new.ccdir="MyCurves"</code>, then place the custom curve in that folder using <code>mix.ccurves(, cc.dir="MyCurves", save=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_postbomb">postbomb</code></td>
<td>
<p>Use a postbomb curve for negative (i.e. postbomb) 14C ages. <code>0 = none, 1 = NH1, 2 = NH2, 3 = NH3, 4 = SH1-2, 5 = SH3</code></p>
</td></tr>
<tr><td><code id="Bacon_+3A_delta.r">delta.R</code></td>
<td>
<p>Mean of core-wide age offsets (e.g., regional marine offsets).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_delta.std">delta.STD</code></td>
<td>
<p>Error of core-wide age offsets (e.g., regional marine offsets).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_t.a">t.a</code></td>
<td>
<p>The dates are treated using the t distribution (Christen and Perez 2009) by default (<code>normal=FALSE</code>).
This t-distribution has two parameters, t.a and t.b, set at 3 and 4 by default (see Christen and Perez, 2010).
If you want to assign narrower error distributions (more closely resembling the normal distribution), set t.a and t.b at for example 33 and 34 respectively (e.g., for specific dates in your .csv file).
For symmetry reasons, t.a must always be equal to t.b-1.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_t.b">t.b</code></td>
<td>
<p>The dates are treated using t distribution by default (<code>normal=FALSE</code>).
The t-distribution has two parameters, t.a and t.b, set at 3 and 4 by default (see Christen and Perez, 2009).
If you want to assign narrower error distributions (more closely resembling the normal distribution), set t.a and t.b at for example 33 and 34 respectively (e.g., for specific dates in your .csv file).
For symmetry reasons, t.a must always be equal to t.b-1.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_normal">normal</code></td>
<td>
<p>By default, Bacon uses the t-distribution to treat the dates. Use <code>normal=TRUE</code> to use the normal/Gaussian distribution. This will generally give higher weight to the dates.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_suggest">suggest</code></td>
<td>
<p>If initial analysis of the data indicates abnormally slow or fast accumulation rates, Bacon will suggest to change the prior.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_accept.suggestions">accept.suggestions</code></td>
<td>
<p>Automatically accept the suggested values. Use with care. Default <code>accept.suggestions=FALSE</code>.
Also, if the length of the core would cause too few or too many sections with the default settings, Bacon will suggest an alternative section thickness <code>thick</code>.
Accept these suggested alternative settings by typing &quot;y&quot; (or &quot;yes please&quot; if you prefer to be polite), or leave as is by typing &quot;n&quot; (or anything else, really). To get rid of these suggestions, use <code>suggest=FALSE</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_reswarn">reswarn</code></td>
<td>
<p>Bacon will warn you if the number of sections lies outside the safe range (default between 10 and 200 sections;
<code>reswarn=c(10,200)</code>). Too few sections could lead to an &lsquo;elbowy&rsquo; model while with too many sections the modelling process can get lost,
resulting in age-models far away from the dated depths.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_remember">remember</code></td>
<td>
<p>Bacon will try to remember which settings you have applied to your cores (default <code>remember=TRUE</code>). If you run into inconsistencies or other problems,
try running your core again with <code>remember=FALSE</code>, or, start cleanly by typing <code>Bacon.cleanup()</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_ask">ask</code></td>
<td>
<p>By default Bacon will ask you to confirm that you want to run the core with the provided settings. Disable this using <code>ask=FALSE</code> (e.g., for batch runs).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_run">run</code></td>
<td>
<p>In order to load an existing Bacon run instead of producing a new one, you can use <code>run=FALSE</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_defaults">defaults</code></td>
<td>
<p>Name of the file containing settings for the core. For internal use only - do not change.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_sep">sep</code></td>
<td>
<p>Separator between the fields of the plain text file containing the dating information. Default <code>sep=","</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_dec">dec</code></td>
<td>
<p>Character for decimal points. Default to <code>dec="."</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_runname">runname</code></td>
<td>
<p>Text to add to the corename for specific runs, e.g., <code>runname="MyCore_Test1"</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_slump">slump</code></td>
<td>
<p>Upper and lower depths of any sections of assumed abrupt accumulation, that require excising before age-modelling (and adding after age-modelling). Requires pairs of depths, e.g., <code>slump=c(10,15,60,67)</code> for slumps at 67-60 and 15-10 cm core depth.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_remove">remove</code></td>
<td>
<p>Whether or not to remove depths within slumps. Defaults to <code>remove=FALSE</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in cal BP (calendar or calibrated years before the present, where the present is AD 1950) by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_ssize">ssize</code></td>
<td>
<p>The amount of iterations to store at the end of the MCMC run. Default 4000; decrease for faster (but less reliable) runs or increase for cores where the MCMC mixing (panel at upper-left corner of age-model graph) appears problematic.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_th0">th0</code></td>
<td>
<p>Starting years for the MCMC iterations. These are randomly chosen by default.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_burnin">burnin</code></td>
<td>
<p>Amount of initial, likely sub-optimal MCMC iterations that will be removed.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_youngest.age">youngest.age</code></td>
<td>
<p>Minimum age limit for Bacon runs, default at current year in cal BP. To set plot limits, use <code>age.min</code> instead.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_oldest.age">oldest.age</code></td>
<td>
<p>Maximum age limit for Bacon runs, default at 1,000,000 cal BP. To set plot limits, use <code>age.max</code> instead.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_minage">MinAge</code></td>
<td>
<p>Deprecated - use youngest.age instead.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_maxage">MaxAge</code></td>
<td>
<p>Deprecated - use oldest.age instead.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_cutoff">cutoff</code></td>
<td>
<p>Avoid plotting very low probabilities of date distributions (default <code>cutoff=0.001</code>).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_plot.pdf">plot.pdf</code></td>
<td>
<p>Produce a pdf file of the age-depth plot. Defaults to <code>plot.pdf=TRUE</code> after a Bacon run.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_dark">dark</code></td>
<td>
<p>Darkness of the greyscale age-depth model. The darkest grey value is <code>dark=1</code> by default.
Lower values will result in lighter grey but values &gt;1 are not allowed.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_date.res">date.res</code></td>
<td>
<p>Date distributions are plotted using <code>date.res=100</code> segments by default.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_age.res">age.res</code></td>
<td>
<p>Resolution or amount of greyscale pixels to cover the age scale of the age-model plot. Default <code>yr.res=200</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_yr.res">yr.res</code></td>
<td>
<p>Deprecated - use age.res instead</p>
</td></tr>
<tr><td><code id="Bacon_+3A_close.connections">close.connections</code></td>
<td>
<p>Internal option to close connections after a run. Default <code>close.connections=TRUE</code>.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_older.than">older.than</code></td>
<td>
<p>an option to enable dates at the limit of C-14 dating. If there are older.than dates, they tell us that the core should be older than a certain age at that depth. For example, if the 7th and 8th dates in the core's .csv file are older-than dates, use as <code>older.than=c(7,8)</code>. The MCMC run could be problematic if the older-than ages do not fit with the other information.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_younger.than">younger.than</code></td>
<td>
<p>an option to provide younger-than ages, for example a historical pollen marker. If there are younger-than dates, they tell us that the core should be younger than a certain age at that depth. For example, if the 7th and 8th dates in the core's .csv file are younger.than dates, use as <code>younger.than=c(7,8)</code>. The MCMC run could be problematic if the younger.than ages do not fit with the other information.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_save.elbowages">save.elbowages</code></td>
<td>
<p>If you want to have a file with the MCMC-derived ages for all the age-depth model's elbows, set <code>save.elbowages=TRUE</code> and a file with the ages will be saved in the core's folder, starting with the core name, followed by its number of sections, d.min, and section thickness, and ending in &quot;_elbowages.txt&quot;.</p>
</td></tr>
<tr><td><code id="Bacon_+3A_verbose">verbose</code></td>
<td>
<p>Provide feedback on what is happening (default <code>verbose=TRUE</code>).</p>
</td></tr>
<tr><td><code id="Bacon_+3A_...">...</code></td>
<td>
<p>options for the age-depth graph. See <a href="#topic+agedepth">agedepth</a> and <a href="#topic+calib.plot">calib.plot</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bacon is an approach to age-depth modelling that uses Bayesian statistics in order to reconstruct Bayesian
accumulation histories for deposits, through combining radiocarbon and other dates with prior information ('Blaauw' and 'Christen', 2011).
</p>
<p>Bacon divides a core into many thin vertical sections (by default of <code>thick=5</code> cm thickness),
and through millions of Markov Chain Monte Carlo (MCMC) iterations estimates
the accumulation rate (in years/cm; so more correctly, sedimentation times) for each of these sections.
Combined with an estimated starting date for the first section, these accumulation rates then form the age-depth model.
The accumulation rates are constrained by prior information on the accumulation rate (<code>acc.mean, acc.shape</code>) and its
variability between neighbouring depths, or &quot;memory&quot; (<code>mem.mean, mem.strength</code>). Hiatuses can be introduced as well, also constrained by prior information (<code>hiatus.max</code>).
</p>
<p>Although Bacon works with any kind of absolute dates (e.g., OSL, tephra or other dates on a calendar scale),
it is often used to age-model 14C-dated sequences. Radiocarbon dates should be calibrated using either IntCal20
(for terrestrial northern hemisphere material; Reimer et al., 2020), Marine20 (for marine dates; Hughen et al., 2020),
SHCal20 (for southern hemisphere dates; Hogg et al., 2020) or any other calibration curve (see below), while modern 14C
dates are calibrated using one of the post-bomb calibration curves (NH1, NH2 or NH3 for the northern hemisphere,
SH1-2 or SH3 for the southern hemisphere; Hua et al., 2013). See <a href="http://calib.org/CALIBomb/">http://calib.org/CALIBomb/</a> if you are unsure which
postbomb curve you need. If Bacon finds postbomb dates (negative 14C ages) and you haven't specified a postbomb curve,
you will be prompted. Provide postbomb curves as, e.g., <code>postbomb=1</code> for the NH1 postbomb curve (2 for NH2, 3 for NH3, 4 for SH1-2, 5 for SH3).
For calendar dates, i.e. dates that are already on the calendar scale and thus should not be calibrated, set<code>cc=0</code>.
</p>
<p>Since version 3.1.0, Bacon can also handle younger-than and older-than ages, with the model aiming to either go 'above'
or 'below' such dates as requested. If the resulting combination of parameters becomes problematic (e.g., no initial
combination of parameters can be found that obeys the priors or is in chronological order), then the output will often be wrong.
If so, using the function <a href="#topic+set.initvals">set.initvals</a> could help.
</p>
<p>By default, the initial MCMC values of the Bacon age-depth model (upper ages and accumulation rate for each model section)
are estimated randomly. Since version 3.1.0, these starting values can also be provided in a file with extension _bacon.init,
placed within the core's folder. This file will need to have two rows, each for one of the two initial sets of parameters required
(the t-walk requires two starting estimates for all MCMC parameters).
If such a file is found (and correctly formatted), Bacon will use the values within this file
as starting points for the MCMC run. See function <a href="#topic+set.initvals">set.initvals</a> for more information.
</p>
<p>From version 2.5.1 on (i.e., since February 2021), the default memory prior has changed to <code>mem.mean=0.5</code>
and <code>mem.strength=10</code>. Previously used c++ code contained a bug which caused the prior information for the memory not to be
taken into account correctly. Now that this bug has been repaired, the default memory prior has been updated such that it should work
for most types of cores, and should result in similar output to previous versions of Bacon. There is no need to re-do previous runs.
However, it is considered good practice to test the impact of different settings on a site's age-depth model
(e.g., thick, acc.mean, acc.shape, mem.mean, acc.strength).
</p>


<h3>Value</h3>

<p>An age-depth model graph, its age estimates, and a summary.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>References</h3>

<p>Blaauw, M. and Christen, J.A., 2011. Flexible paleoclimate age-depth models using an autoregressive gamma process. Bayesian Anal. 6(3): 457-474.
</p>
<p>Christen, J.A., Perez E., S., 2010. A new robust statistical model for radiocarbon data. Radiocarbon 51: 1047-1059.
</p>
<p>Reimer et al., 2020. The IntCal20 Northern Hemisphere radiocarbon age calibration curve (0–55 cal kBP). Radiocarbon 62(4): 725-757. <a href="https://doi.org/10.1017/RDC.2020.41">doi:10.1017/RDC.2020.41</a>
</p>
<p>Hogg et al. 2020 SHCal20 Southern Hemisphere calibration, 0-55,000 years cal BP. Radiocarbon 62(4): 759-778. <a href="https://doi.org/10.1017/RDC.2020.59">doi:10.1017/RDC.2020.59</a>
</p>
<p>Hughen et al. 2020 Marine20-the marine radiocarbon age calibration curve (0-55,000 cal BP). Radiocarbon 62(4): 779-820.  <a href="https://doi.org/10.1017/RDC.2020.68">doi:10.1017/RDC.2020.68</a>
</p>
<p>Hua, Q., Barbetti, M., Rakowski, A.Z., 2013. Atmospheric radiocarbon for the period 1950-2010.
Radiocarbon 55(4): 2059-2072. <a href="https://doi.org/10.2458/azu_js_rc.v55i2.16177">doi:10.2458/azu_js_rc.v55i2.16177</a>
</p>
<p>Jones, V.J., Stevenson, A.C., Battarbee, R.W., 1989. Acidification of lakes in Galloway, south west Scotland
- a diatom and pollen study of the post-glacial history of the Round Loch of Glenhead.
Journal of Ecology 77: 1-23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  Bacon(ask=FALSE, coredir=tempfile())
  Bacon(cc=2, delta.R=80, delta.STD=40, coredir=tempfile())

</code></pre>

<hr>
<h2 id='Bacon.Age.d'>Output all ages for a single depth.</h2><span id='topic+Bacon.Age.d'></span>

<h3>Description</h3>

<p>Output all MCMC-derived age estimates for a given depth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bacon.Age.d(
  d,
  set = get("info"),
  its = set$output,
  BCAD = set$BCAD,
  na.rm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bacon.Age.d_+3A_d">d</code></td>
<td>
<p>The depth of which Bacon age estimates are to be returned. Has to be a single depth.</p>
</td></tr>
<tr><td><code id="Bacon.Age.d_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable info.</p>
</td></tr>
<tr><td><code id="Bacon.Age.d_+3A_its">its</code></td>
<td>
<p>The set of MCMC iterations to be used. Defaults to the entire MCMC output, <code>its=set$output</code>.</p>
</td></tr>
<tr><td><code id="Bacon.Age.d_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="Bacon.Age.d_+3A_na.rm">na.rm</code></td>
<td>
<p>Whether or not to remove NA values (ages within slumps)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Obtaining an age-depth model is often only a step towards a goal, e.g., plotting a core's
fossil series ('proxies') against calendar time. Bacon.Age.d can be used to list all MCMC-derived age estimates for a given (single) depth, for example to calculate mean ages for a depth. See also Bacon.d.Age which calculates the depths of a single age estimate.
</p>


<h3>Value</h3>

<p>Outputs all MCMC-derived ages for a given depth.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  Bacon(run=FALSE, coredir=tempfile())
  agedepth(age.res=50, d.res=50, d.by=10)
  ages.d20 = Bacon.Age.d(20)
  mean(ages.d20)

## End(Not run)
</code></pre>

<hr>
<h2 id='Bacon.cleanup'>Remove files made to produce the current core's age-depth model.</h2><span id='topic+Bacon.cleanup'></span>

<h3>Description</h3>

<p>Remove files ending in .bacon, .plum (if it exists), .out, .pdf, _ages.txt, and _settings.txt of current core.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bacon.cleanup(set = get("info"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bacon.cleanup_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If cores behave badly, you can try cleaning up previous runs and settings, by
removing files *.bacon, *.plum, *.out, *.pdf, *_ages.txt, and *_settings.txt of current core.
</p>


<h3>Value</h3>

<p>A message stating that the files and settings of this run have been deleted.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Bacon(run=FALSE, coredir=tempfile())
  Bacon.cleanup()
</code></pre>

<hr>
<h2 id='Bacon.d.Age'>Output all depths for a single age.</h2><span id='topic+Bacon.d.Age'></span>

<h3>Description</h3>

<p>Output all MCMC-derived depth estimates for a single given age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bacon.d.Age(
  age,
  set = get("info"),
  BCAD = set$BCAD,
  its = set$output,
  na.rm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bacon.d.Age_+3A_age">age</code></td>
<td>
<p>The age estimate for which depths are to be returned. Has to be a single age.</p>
</td></tr>
<tr><td><code id="Bacon.d.Age_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable info.</p>
</td></tr>
<tr><td><code id="Bacon.d.Age_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="Bacon.d.Age_+3A_its">its</code></td>
<td>
<p>The set of MCMC iterations to be used. Defaults to the entire MCMC output, <code>its=set$output</code>.</p>
</td></tr>
<tr><td><code id="Bacon.d.Age_+3A_na.rm">na.rm</code></td>
<td>
<p>Whether or not to remove NA values (ages within slumps)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Obtaining an age-depth model is often only a step towards a goal, e.g., plotting a core's
fossil series ('proxies') against calendar time. Bacon.d.Age can be used to list all MCMC-derived depths belonging to a given (single) age, for example to calculate mean depths belonging to a modelled depth. 
This function was kindly written and provided by Timon Netzel (Bonn University). See also Bacon.Age.d, which calculates the ages for a single depth.
</p>


<h3>Value</h3>

<p>Outputs all MCMC-derived depths for a given age.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  Bacon(run=FALSE, coredir=tempfile())
  agedepth(age.res=50, d.res=50, d.by=10)
  ages.d20 = Bacon.Age.d(20)
  mean(ages.d20)

## End(Not run)
</code></pre>

<hr>
<h2 id='Bacon.hist'>Calculate age distributions of depths.</h2><span id='topic+Bacon.hist'></span>

<h3>Description</h3>

<p>Calculate the distribution of age estimates of single or multiple depths.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bacon.hist(
  d,
  set = get("info"),
  BCAD = set$BCAD,
  age.lab = c(),
  age.lim = c(),
  hist.lab = "Frequency",
  calc.range = TRUE,
  hist.lim = c(),
  draw = TRUE,
  prob = set$prob,
  hist.col = grey(0.5),
  hist.border = grey(0.2),
  range.col = "blue",
  med.col = "green",
  mean.col = "red",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bacon.hist_+3A_d">d</code></td>
<td>
<p>The depth or depths for which a histogram and age ranges should be provided. If multiple depths are given, then just the age ranges, median and means (no graphs) are provided for each depth.</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable info.</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_age.lab">age.lab</code></td>
<td>
<p>The labels for the calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>).</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_age.lim">age.lim</code></td>
<td>
<p>Minimum and maximum calendar age ranges, calculated automatically by default (<code>age.lim=c()</code>).</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_hist.lab">hist.lab</code></td>
<td>
<p>The y-axis is labelled <code>ylab="Frequency"</code> by default.</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_calc.range">calc.range</code></td>
<td>
<p>Calculate ranges? Takes time so can be left out</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_hist.lim">hist.lim</code></td>
<td>
<p>Limits of the y-axis.</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_draw">draw</code></td>
<td>
<p>Draw a plot or not. Defaults to <code>draw=TRUE</code>, however no plots are made if more than one depth <code>d</code> is provided.
If <code>draw=FALSE</code>, then the age ranges, median and mean are given for each depth (as four columns).</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_prob">prob</code></td>
<td>
<p>Age ranges are given as quantiles, e.g., 2.5% and 97.5% for the default of 95% confidence limits (<code>prob=0.95</code>)).</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_hist.col">hist.col</code></td>
<td>
<p>Colour of the histogram. Default grey, <code>hist.col=grey(0.5)</code>.</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_hist.border">hist.border</code></td>
<td>
<p>Colour of the histogram's outline. Default dark grey, <code>hist.border=grey(0.2)</code>.</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_range.col">range.col</code></td>
<td>
<p>Colour of confidence ranges. Defaults to <code>range.col="blue"</code>.</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_med.col">med.col</code></td>
<td>
<p>Colour of the median. Defaults to <code>med.col="green"</code>.</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_mean.col">mean.col</code></td>
<td>
<p>Colour of the mean. Defaults to <code>mn.col="red"</code>.</p>
</td></tr>
<tr><td><code id="Bacon.hist_+3A_verbose">verbose</code></td>
<td>
<p>Provide feedback on what is happening (default <code>verbose=TRUE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Age estimates of specific depths can also be plotted.
</p>


<h3>Value</h3>

<p>A plot with the histogram and the age ranges, median and mean, or just the age ranges, medians and means if more than one depth <code>d</code> is given.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  Bacon(run=FALSE, coredir=tempfile())
  agedepth(age.res=50, d.res=50, d.by=10)
  Bacon.hist(20)
  Bacon.hist(20:30)

## End(Not run)
</code></pre>

<hr>
<h2 id='bacon2clam'>Translate Bacon .csv files to clam .csv files.</h2><span id='topic+bacon2clam'></span>

<h3>Description</h3>

<p>Reads a Bacon .csv file containing the dates, and transforms it into a clam .csv file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bacon2clam(core, bacondir = "Bacon_runs", clamdir = "clam_runs", sep = ",")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bacon2clam_+3A_core">core</code></td>
<td>
<p>The name of the core for which a Bacon .csv.file needs to be translated into a clam .csv file</p>
</td></tr>
<tr><td><code id="bacon2clam_+3A_bacondir">bacondir</code></td>
<td>
<p>The directory where the Bacon runs reside. Defaults to <code>coredir="Bacon_runs"</code>.</p>
</td></tr>
<tr><td><code id="bacon2clam_+3A_clamdir">clamdir</code></td>
<td>
<p>The directory where the clam runs reside. Defaults to <code>coredir="clam_runs"</code>.</p>
</td></tr>
<tr><td><code id="bacon2clam_+3A_sep">sep</code></td>
<td>
<p>The separator for the .csv files. Defaults to <code>sep=","</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assumes that Bacon .csv files with 4 columns indicate 14C dates. Please make sure this is correct.
</p>


<h3>Value</h3>

<p>A clam .csv file
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{

 tmpfl &lt;- tempfile()
  Bacon(run=FALSE, ask=FALSE, coredir=tmpfl)
  bacon2clam("MSB2K", bacondir=tmpfl, clamdir=tmpfl)
 
}
</code></pre>

<hr>
<h2 id='Baconvergence'>Test to identify poorly mixed MCMC runs.</h2><span id='topic+Baconvergence'></span>

<h3>Description</h3>

<p>Test how well-mixed and converged the MCMC runs are with the chosen core and settings, by running the core several times and comparing the different runs using the Gelman and Rubin Reduction factor (Brooks and Gelman, 1998).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Baconvergence(core = "MSB2K", runs = 5, suggest = FALSE, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Baconvergence_+3A_core">core</code></td>
<td>
<p>Name of the core, given using quotes. Defaults to one of the cores provided with rbacon, <code>core="MSB2K"</code>.</p>
</td></tr>
<tr><td><code id="Baconvergence_+3A_runs">runs</code></td>
<td>
<p>Amount of runs to test for mixing. Default <code>runs=5</code>.</p>
</td></tr>
<tr><td><code id="Baconvergence_+3A_suggest">suggest</code></td>
<td>
<p>If initial analysis of the data indicates abnormally slow or fast accumulation rates, Bacon will suggest to change the prior.</p>
</td></tr>
<tr><td><code id="Baconvergence_+3A_verbose">verbose</code></td>
<td>
<p>Provide feedback on what is happening (default <code>verbose=TRUE</code>).</p>
</td></tr>
<tr><td><code id="Baconvergence_+3A_...">...</code></td>
<td>
<p>additional options that can be given to the Bacon function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generally Bacon will perform millions of MCMC iterations for each age-model run, although only a fraction
of these will be stored. In most cases the remaining MCMC iterations will be well mixed (the upper left panel
of the fit of the iterations shows no strange features such as sudden systematic drops or rises).
However if the iterations seem not well mixed, or if too few remain (say less than a few hundred),
then you could check the Gelman and Rubin Reduction Factor. Too high differences (high Factors) between runs
indicate poor MCMC mixing. Robust MCMC mixing is indicated by a Gelman and Rubin Reduction factor
(Brooks and Gelman, 1998) below the 1.05 safety threshold.
</p>


<h3>Value</h3>

<p>NA
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>References</h3>

<p>Brooks, SP. and Gelman, A. (1998) General methods for monitoring
convergence of iterative simulations.
_Journal of Computational and Graphical Statistics, *7*, 434-455.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
    Baconvergence(runs=2, ssize=100, coredir=tempfile()) # a quick-and-dirty toy example
  
</code></pre>

<hr>
<h2 id='calib.plot'>Plot the dates</h2><span id='topic+calib.plot'></span>

<h3>Description</h3>

<p>Produce a plot of the dated depths and their dates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calib.plot(
  set = get("info"),
  dets = set$dets,
  accordion = c(),
  BCAD = set$BCAD,
  cc = set$cc,
  rotate.axes = FALSE,
  rev.d = FALSE,
  rev.age = FALSE,
  rev.yr = rev.age,
  age.lim = c(),
  yr.lim = age.lim,
  date.res = 100,
  d.lab = c(),
  age.lab = c(),
  yr.lab = age.lab,
  height = 1,
  calheight = 1,
  mirror = TRUE,
  up = TRUE,
  cutoff = 0.1,
  C14.col = rgb(0, 0, 1, 0.5),
  C14.border = rgb(0, 0, 1, 0.75),
  cal.col = rgb(0, 0.5, 0.5, 0.5),
  cal.border = rgb(0, 0.5, 0.5, 0.75),
  dates.col = c(),
  slump.col = grey(0.8),
  new.plot = TRUE,
  plot.dists = TRUE,
  same.heights = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calib.plot_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_dets">dets</code></td>
<td>
<p>The set of determinations to be plotted.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_accordion">accordion</code></td>
<td>
<p>If depths have to be squeezed/stretched, the parameters can be set here. Defaults to being empty, but requires 2 parameters if active, e.g., <code>accordion=c(10,20)</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_cc">cc</code></td>
<td>
<p>Calibration curve to be used (defaults to info$cc)</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>The default of plotting age on the horizontal axis and event probability on the vertical one can be changed with <code>rotate.axes=TRUE</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_rev.d">rev.d</code></td>
<td>
<p>The direction of the depth axis can be reversed from the default (<code>rev.d=TRUE</code>).</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_rev.age">rev.age</code></td>
<td>
<p>The direction of the calendar age axis can be reversed from the default (<code>rev.age=TRUE</code>)</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_rev.yr">rev.yr</code></td>
<td>
<p>Deprecated - use rev.age instead</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_age.lim">age.lim</code></td>
<td>
<p>Minimum and maximum calendar age ranges, calculated automatically by default (<code>age.lim=c()</code>).</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_yr.lim">yr.lim</code></td>
<td>
<p>Deprecated - use age.lim instead</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_date.res">date.res</code></td>
<td>
<p>Date distributions are plotted using <code>date.res=100</code> points by default.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_d.lab">d.lab</code></td>
<td>
<p>The labels for the depth axis. Default <code>d.lab="Depth (cm)"</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_age.lab">age.lab</code></td>
<td>
<p>The labels for the calendar axis (default <code>yr.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>).</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_yr.lab">yr.lab</code></td>
<td>
<p>Deprecated - use age.lab instead</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_height">height</code></td>
<td>
<p>The heights of the distributions of the dates. See also <code>normalise.dists</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_calheight">calheight</code></td>
<td>
<p>Multiplier for the heights of the distributions of dates on the calendar scale. Defaults to <code>calheight=1</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_mirror">mirror</code></td>
<td>
<p>Plot the dates as 'blobs'. Set to <code>mirror=FALSE</code> to plot simple distributions.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_up">up</code></td>
<td>
<p>Directions of distributions if they are plotted non-mirrored. Default <code>up=TRUE</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_cutoff">cutoff</code></td>
<td>
<p>Avoid plotting very low probabilities of date distributions (default <code>cutoff=0.1</code>).</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_c14.col">C14.col</code></td>
<td>
<p>Colour of the calibrated distributions of the dates. Default is semi-transparent blue: <code>rgb(0,0,1,.35)</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_c14.border">C14.border</code></td>
<td>
<p>Colours of the borders of calibrated 14C dates. Default is transparent dark blue: cal.col</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_cal.col">cal.col</code></td>
<td>
<p>Colour of the non-14C dates in the age-depth plot: default semi-transparent blue-green: <code>rgb(0,.5,.5,.35)</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_cal.border">cal.border</code></td>
<td>
<p>Colour of the of the border of non-14C dates in the age-depth plot: default semi-transparent dark blue-green: <code>rgb(0,.5,.5,.5)</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_dates.col">dates.col</code></td>
<td>
<p>As an alternative to colouring dates based on whether they are 14C or not, sets of dates can be coloured as, e.g., <code>dates.col=colours()[2:100]</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_slump.col">slump.col</code></td>
<td>
<p>Colour of slumps. Defaults to <code>slump.col=grey(0.8)</code>.</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_new.plot">new.plot</code></td>
<td>
<p>Start a new plot (<code>new.plot=TRUE</code>) or plot over an existing plot (<code>new.plot=FALSE</code>).</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_plot.dists">plot.dists</code></td>
<td>
<p>Plot the distributions of the dates (default <code>plot.dists=TRUE</code>).</p>
</td></tr>
<tr><td><code id="calib.plot_+3A_same.heights">same.heights</code></td>
<td>
<p>Plot the distributions of the dates all at the same maximum height (default <code>same.height=FALSE</code>), which instead normalises the distributions (all have an area of 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is generally called internally to produce the age-depth graph.
It can be used to produce custom-built graphs.
</p>


<h3>Value</h3>

<p>NA
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Bacon(run=FALSE, coredir=tempfile())
  calib.plot()
</code></pre>

<hr>
<h2 id='clam2bacon'>Translate clam .csv files to Bacon .csv files.</h2><span id='topic+clam2bacon'></span>

<h3>Description</h3>

<p>Reads a clam .csv file containing the dates, and transforms it into a Bacon .csv file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clam2bacon(
  core,
  clamdir = "clam_runs",
  bacondir = "Bacon_runs",
  sep = ",",
  cc = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clam2bacon_+3A_core">core</code></td>
<td>
<p>The name of the core for which a clam .csv.file needs to be translated into a Bacon .csv file</p>
</td></tr>
<tr><td><code id="clam2bacon_+3A_clamdir">clamdir</code></td>
<td>
<p>The directory where the clam runs reside. Defaults to <code>coredir="clam_runs"</code>.</p>
</td></tr>
<tr><td><code id="clam2bacon_+3A_bacondir">bacondir</code></td>
<td>
<p>The directory where the Bacon runs reside. Defaults to <code>coredir="Bacon_runs"</code>.</p>
</td></tr>
<tr><td><code id="clam2bacon_+3A_sep">sep</code></td>
<td>
<p>The separator for the .csv files. Defaults to <code>sep=","</code>.</p>
</td></tr>
<tr><td><code id="clam2bacon_+3A_cc">cc</code></td>
<td>
<p>Calibration curve for C-14 dates: <code>cc=1</code> for IntCal20 (northern hemisphere terrestrial), <code>cc=2</code> for Marine20 (marine),</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please ensure that if the clam file has offset (d.R) estimates, that errors (d.STD) are provided manually, since these values cannot be determined automatically from the clam .csv file.
</p>


<h3>Value</h3>

<p>A Bacon .csv file
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>

<hr>
<h2 id='draw.pbmeasured'>Plot the 210Pb data</h2><span id='topic+draw.pbmeasured'></span>

<h3>Description</h3>

<p>Produce a plot of the 210Pb data and their depths
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.pbmeasured(
  set = get("info"),
  rotate.axes = FALSE,
  rev.d = FALSE,
  rev.age = FALSE,
  BCAD = set$BCAD,
  pb.lim = c(),
  age.lim = c(),
  d.lim = c(),
  d.lab = c(),
  pb.lab = c(),
  pbmeasured.col = "blue",
  pbmeasured.lty = 2,
  pb.log = FALSE,
  supp.col = "purple",
  newplot = TRUE,
  on.agescale = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw.pbmeasured_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>The default of plotting age on the horizontal axis and event probability on the vertical one can be changed with <code>rotate.axes=TRUE</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_rev.d">rev.d</code></td>
<td>
<p>The direction of the depth axis can be reversed from the default (<code>rev.d=TRUE</code>).</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_rev.age">rev.age</code></td>
<td>
<p>The direction of the calendar age axis can be reversed from the default (<code>rev.age=TRUE</code>)</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in cal BP (calendar or calibrated years before the present, where the present is AD 1950) by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_pb.lim">pb.lim</code></td>
<td>
<p>Minimum and maximum of the 210Pb axis ranges, calculated automatically by default (<code>pb.lim=c()</code>).</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_age.lim">age.lim</code></td>
<td>
<p>Minimum and maximum of the age ranges to be used to plot 210Pb values. Calculated automatically by default (<code>age.lim=c()</code>).</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_d.lim">d.lim</code></td>
<td>
<p>Minimum and maximum depths to plot; calculated automatically by default (<code>d.lim=c()</code>).</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_d.lab">d.lab</code></td>
<td>
<p>The labels for the depth axis. Default <code>d.lab="Depth (cm)"</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_pb.lab">pb.lab</code></td>
<td>
<p>The label for the 210Pb axis (default <code>pb.lab="210Pb (Bq/kg)"</code> or <code>"210Pb (dpm/g)"</code>).</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_pbmeasured.col">pbmeasured.col</code></td>
<td>
<p>The label for the measured 210Pb data. <code>pbmeasured.col="blue"</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_pbmeasured.lty">pbmeasured.lty</code></td>
<td>
<p>Line type of the measured 210Pb data. Defaults to continuous lines.</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_pb.log">pb.log</code></td>
<td>
<p>Use a log scale for the 210Pb-axis (default <code>pb.log=FALSE</code>).</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_supp.col">supp.col</code></td>
<td>
<p>Colour of the supported 210Pb data. Defaults to red: <code>supp.col="red"</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_newplot">newplot</code></td>
<td>
<p>make new plot (default TRUE)</p>
</td></tr>
<tr><td><code id="draw.pbmeasured_+3A_on.agescale">on.agescale</code></td>
<td>
<p>Plot the Pb-210 on the cal BP scale. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is generally called internally to produce the age-depth graph.
It can be used to produce custom-built graphs.
</p>


<h3>Value</h3>

<p>A plot of the measured 210Pb values
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen, Marco Aquino-Lopez
</p>

<hr>
<h2 id='draw.pbmodelled'>Plot the 210Pb data</h2><span id='topic+draw.pbmodelled'></span>

<h3>Description</h3>

<p>Produce a plot of the 210Pb data and their depths
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draw.pbmodelled(
  set = get("info"),
  BCAD = set$BCAD,
  rotate.axes = FALSE,
  rev.d = FALSE,
  rev.age = FALSE,
  pb.lim = c(),
  d.lim = c(),
  d.lab = c(),
  pb.lab = c(),
  pbmodelled.col = function(x) rgb(0, 0, 1, x),
  pbmeasured.col = "blue",
  supp.col = "purple",
  plot.measured = TRUE,
  age.lim = c(),
  mgp = mgp,
  pb.lty = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draw.pbmodelled_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>The default of plotting age on the horizontal axis and event probability on the vertical one can be changed with <code>rotate.axes=TRUE</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_rev.d">rev.d</code></td>
<td>
<p>The direction of the depth axis can be reversed from the default (<code>rev.d=TRUE</code>).</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_rev.age">rev.age</code></td>
<td>
<p>The direction of the calendar age axis can be reversed from the default (<code>rev.age=TRUE</code>)</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_pb.lim">pb.lim</code></td>
<td>
<p>Minimum and maximum of the 210Pb axis ranges, calculated automatically by default (<code>pb.lim=c()</code>).</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_d.lim">d.lim</code></td>
<td>
<p>Minimum and maximum depths to plot; calculated automatically by default (<code>d.lim=c()</code>).</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_d.lab">d.lab</code></td>
<td>
<p>The labels for the depth axis. Default <code>d.lab="Depth (cm)"</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_pb.lab">pb.lab</code></td>
<td>
<p>The label for the 210Pb axis (default <code>pb.lab="210Pb (Bq/kg)"</code> or <code>"210Pb (dpm/g)"</code>).</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_pbmodelled.col">pbmodelled.col</code></td>
<td>
<p>Colour of the modelled 210Pb values. Defaults to scales of blue: <code>pbmodelled.col=function(x) rgb(0,0,1,x)</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_pbmeasured.col">pbmeasured.col</code></td>
<td>
<p>Colour of the measured 210Pb values. Defaults to blue.</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_supp.col">supp.col</code></td>
<td>
<p>Colour of the supported 210Pb data. Defaults to red: <code>supp.col="red"</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_plot.measured">plot.measured</code></td>
<td>
<p>Plot the measured 210Pb values (default <code>plot.measured=TRUE</code>).</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_age.lim">age.lim</code></td>
<td>
<p>values of the age axis. Used to calculate where to plot the pb values on the secondary axis</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_mgp">mgp</code></td>
<td>
<p>Axis text margins (where should titles, labels and tick marks be plotted). Defaults to <code>mgp=c(1.7, .7, .0)</code>.</p>
</td></tr>
<tr><td><code id="draw.pbmodelled_+3A_pb.lty">pb.lty</code></td>
<td>
<p>Line type of measured Pb-210 data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is generally called internally to produce the age-depth graph.
It can be used to produce custom-built graphs.
</p>


<h3>Value</h3>

<p>A plot of the modelled (and optionally the measured) 210Pb values
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen, Marco Aquino-Lopez
</p>

<hr>
<h2 id='flux.age.ghost'>Plot flux rates for proxies.</h2><span id='topic+flux.age.ghost'></span>

<h3>Description</h3>

<p>Plot grey-scale representation of estimated flux rates for proxies against calendar age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux.age.ghost(
  proxy = 1,
  age.lim = c(),
  yr.lim = age.lim,
  age.res = 200,
  yr.res = age.res,
  set = get("info"),
  flux = c(),
  plot.range = TRUE,
  prob = 0.8,
  range.col = grey(0.5),
  range.lty = 2,
  plot.mean = TRUE,
  mean.col = "red",
  mean.lty = 2,
  plot.median = TRUE,
  median.col = "blue",
  median.lty = 2,
  flux.lim = c(),
  flux.lab = expression("flux (g cm"^-1 * " yr"^-1 * ")"),
  upper = 0.95,
  rgb.scale = c(0, 0, 0),
  rgb.res = 100,
  dark = set$dark,
  cutoff = 0.001,
  BCAD = set$BCAD,
  age.lab = c(),
  yr.lab = age.lab,
  rotate.axes = FALSE,
  rev.flux = FALSE,
  rev.age = FALSE,
  rev.yr = rev.age
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flux.age.ghost_+3A_proxy">proxy</code></td>
<td>
<p>Which proxy to use (counting from the column number in the .csv file after the depths column).</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_age.lim">age.lim</code></td>
<td>
<p>Minimum and maximum calendar age ranges, calculated automatically by default (<code>age.lim=c()</code>).</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_yr.lim">yr.lim</code></td>
<td>
<p>Deprecated - use age.lim instead</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_age.res">age.res</code></td>
<td>
<p>Resolution or amount of greyscale pixels to cover the age scale of the plot. Default <code>age.res=200</code>.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_yr.res">yr.res</code></td>
<td>
<p>Deprecated - use age.res instead</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable info.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_flux">flux</code></td>
<td>
<p>Define a flux variable within the R session (consisting of depths and their proxy concentrations in two columns) and provide the name of this variable, e.g.:
<code>flux.age.ghost(flux=flux1)</code>. If left empty (<code>flux=c()</code>), a flux file is expected (see <code>proxy</code>).</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_plot.range">plot.range</code></td>
<td>
<p>Plot curves that indicate a probability range, at resolution of yr.res.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_prob">prob</code></td>
<td>
<p>Probability range, defaults to <code>prob=0.8</code> (10 % at each side).</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_range.col">range.col</code></td>
<td>
<p>Red seems nice.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_range.lty">range.lty</code></td>
<td>
<p>Line type of the confidence ranges.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_plot.mean">plot.mean</code></td>
<td>
<p>Plot the mean fluxes.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_mean.col">mean.col</code></td>
<td>
<p>Red seems nice.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_mean.lty">mean.lty</code></td>
<td>
<p>Line type of the means.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_plot.median">plot.median</code></td>
<td>
<p>Plot the median fluxes.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_median.col">median.col</code></td>
<td>
<p>Blue seems nice.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_median.lty">median.lty</code></td>
<td>
<p>Line type of the medians.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_flux.lim">flux.lim</code></td>
<td>
<p>Limits of the flux axes.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_flux.lab">flux.lab</code></td>
<td>
<p>Axis labels. Defaults to <code>flux.lab="flux"</code>.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_upper">upper</code></td>
<td>
<p>Maximum flux rates to plot. Defaults to the upper 99%; <code>upper=0.99</code>.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_rgb.scale">rgb.scale</code></td>
<td>
<p>The function to produce a coloured representation of all age-models. Needs 3 values for the intensity of red, green and blue. Defaults to grey-scales: <code>rgb.scale=c(0,0,0)</code>, but could also be, say, scales of red (<code>rgb.scale=c(1,0,0)</code>).</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_rgb.res">rgb.res</code></td>
<td>
<p>Resolution of the colour spectrum depicting the age-depth model. Default <code>rgb.res=100</code>.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_dark">dark</code></td>
<td>
<p>The darkest grey value is <code>dark=1</code> by default; lower values will result in lighter grey but <code>values &gt;1</code> are not allowed.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_cutoff">cutoff</code></td>
<td>
<p>Point below which colours will no longer be printed. Default <code>cutoff=0.001</code>.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_age.lab">age.lab</code></td>
<td>
<p>The labels for the calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>).</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_yr.lab">yr.lab</code></td>
<td>
<p>Deprecated - use age.lab instead</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>The default of plotting calendar year on the horizontal axis and fluxes on the vertical one can be changed with <code>rotate.axes=TRUE</code>.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_rev.flux">rev.flux</code></td>
<td>
<p>The flux axis can be reversed with <code>rev.flux=TRUE</code>.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_rev.age">rev.age</code></td>
<td>
<p>The direction of the age axis can be reversed using <code>rev.age=TRUE</code>.</p>
</td></tr>
<tr><td><code id="flux.age.ghost_+3A_rev.yr">rev.yr</code></td>
<td>
<p>Deprecated - use rev.age instead</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To plot flux rates (e.g. pollen grains/cm2/yr) as greyscales,
provide a plain text file with headers and the data in columns separated by commas, ending in '_flux.csv'
and saved in your core's folder. The first column should contain the depths, and the next columns should contain
the proxy concentration values (leaving missing values empty). Then type for example <code>flux.age.ghost(1)</code> to plot the
flux values for the first proxy in the .csv file. Instead of using a _flux.csv file, a flux variable can also be defined
within the R session (consisting of depths and their proxy concentrations in two columns). Then provide the name of this variable, e.g.: <code>flux.age.ghost(flux=flux1)</code>.
See Bacon_runs/MSB2K/MSB2K_flux.csv for an example.
</p>


<h3>Value</h3>

<p>A plot of flux rates.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  Bacon(run=FALSE, coredir=tempfile())
  agedepth(yr.res=50)
  flux.age.ghost(1)

## End(Not run)
</code></pre>

<hr>
<h2 id='proxy.ghost'>Proxies analysed along the depths of a core can be plotted as 'proxy-ghost' graphs against calendar time while taking into account chronological uncertainties. Here darker grey indicates more likely calendar ages for specific proxy values.</h2><span id='topic+proxy.ghost'></span>

<h3>Description</h3>

<p>Proxies analysed along the depths of a core can be plotted as 'proxy-ghost' graphs against calendar time while taking into account chronological uncertainties. Here darker grey indicates more likely calendar ages for specific proxy value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>proxy.ghost(
  proxy = 1,
  proxy.lab = NULL,
  proxy.res = 250,
  age.res = 200,
  yr.res = age.res,
  rgb.scale = c(0, 0, 0),
  rgb.res = 100,
  set = get("info"),
  cutoff = 0.001,
  dark = 1,
  darkest = 1,
  rotate.axes = FALSE,
  proxy.rev = FALSE,
  age.rev = FALSE,
  yr.rev = age.rev,
  plot.mean = FALSE,
  mean.col = "red",
  age.lim = NULL,
  yr.lim = age.lim,
  proxy.lim = NULL,
  sep = ",",
  xaxs = "i",
  yaxs = "i",
  xaxt = "s",
  yaxt = "s",
  bty = "l",
  BCAD = set$BCAD,
  age.lab = ifelse(BCAD, "BC/AD", "cal yr BP"),
  yr.lab = age.lab,
  verbose = TRUE,
  add = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="proxy.ghost_+3A_proxy">proxy</code></td>
<td>
<p>Which proxy to use (counting from the column number in the .csv file after the depths column).</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_proxy.lab">proxy.lab</code></td>
<td>
<p>Label of the proxy axis. Default names are taken from the csv file.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_proxy.res">proxy.res</code></td>
<td>
<p>Greyscale pixels are calculated for <code>proxy.res=250</code> proxy values by default, as a compromise between image quality and calculation speed. If the output looks very pixel-like (e.g., when choosing to plot only part of the record using proxy.lim), set this option to higher values.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_age.res">age.res</code></td>
<td>
<p>Resolution or amount of greyscale pixels to cover the age scale of the age-model plot. Default <code>age.res=250</code> as a compromise between image quality and calculation speed. If the output looks very pixel-like (e.g., when choosing to plot only part of the record using age.lim), set this option to higher values.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_yr.res">yr.res</code></td>
<td>
<p>Deprecated - use age.res instead</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_rgb.scale">rgb.scale</code></td>
<td>
<p>The function to produce a coloured representation of all age-models. Needs 3 values for the intensity of red, green and blue. Defaults to grey-scales: <code>rgb.scale=c(0,0,0)</code>, but could also be, say, scales of red (<code>rgb.scale=c(1,0,0)</code>).</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_rgb.res">rgb.res</code></td>
<td>
<p>Resolution of the colour spectrum depicting the age-depth model. Default <code>rgb.res=100</code>.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable info.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_cutoff">cutoff</code></td>
<td>
<p>Point below which colours will no longer be printed. Default <code>cutoff=0.001</code>.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_dark">dark</code></td>
<td>
<p>By default, the darkest grey value is assigned to the most likely value within the entire core (normalised to 1; <code>dark=1</code>). By setting dark to, e.g., <code>dark=.8</code>, all values of and above 0.8 will be darkest (and values below that threshold will be lighter grey the lower their probabilities).</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_darkest">darkest</code></td>
<td>
<p>Darkness of the most likely value. Is black by default (<code>darkest=1</code>); lower values will result in lighter grey.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_rotate.axes">rotate.axes</code></td>
<td>
<p>The default is to plot the calendar horizontally, however the plot can be rotated (<code>rotate.axes=TRUE</code>).</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_proxy.rev">proxy.rev</code></td>
<td>
<p>The proxy axis can be reversed if <code>proxy.rev=TRUE</code>.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_age.rev">age.rev</code></td>
<td>
<p>The calendar axis can be reversed using <code>yr.rev=TRUE</code>.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_yr.rev">yr.rev</code></td>
<td>
<p>Deprecated - use age.rev instead</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_plot.mean">plot.mean</code></td>
<td>
<p>The mean ages of the proxy values can be added using <code>plot.mean=TRUE</code>.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_mean.col">mean.col</code></td>
<td>
<p>Colour of the weighted mean ages of the proxy values.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_age.lim">age.lim</code></td>
<td>
<p>Minimum and maximum calendar age ranges, calculated automatically by default (<code>yr.lim=NULL</code>).</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_yr.lim">yr.lim</code></td>
<td>
<p>Deprecated - use age.lim instead</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_proxy.lim">proxy.lim</code></td>
<td>
<p>Ranges of the proxy axis, calculated automatically by default (<code>proxy.lim=NULL</code>).</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_sep">sep</code></td>
<td>
<p>Separator between the fields of the plain text file containing the depth and proxy data.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_xaxs">xaxs</code></td>
<td>
<p>Extension of x-axis. By default, no white-space will be added at the axis extremes (<code>xaxs="i"</code>). See ?par for other options.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_yaxs">yaxs</code></td>
<td>
<p>Extension of y-axis. By default, no white-space will be added at the axis extremes (<code>xaxs="i"</code>). See ?par for other options.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_xaxt">xaxt</code></td>
<td>
<p>The x-axis is plotted by default, but this can be switched off using <code>xaxt="n"</code>.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_yaxt">yaxt</code></td>
<td>
<p>The y-axis is plotted by default, but this can be switched off using <code>yaxt="n"</code>.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_bty">bty</code></td>
<td>
<p>Type of box to be drawn around the plot (<code>"n"</code> for none, and <code>"l"</code> (default), <code>"7"</code>, <code>"c"</code>, <code>"u"</code>, or <code>"o"</code> for correspondingly shaped boxes).</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_bcad">BCAD</code></td>
<td>
<p>The calendar scale of graphs and age output-files is in <code>cal BP</code> by default, but can be changed to BC/AD using <code>BCAD=TRUE</code>.</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_age.lab">age.lab</code></td>
<td>
<p>The labels for the calendar axis (default <code>age.lab="cal BP"</code> or <code>"BC/AD"</code> if <code>BCAD=TRUE</code>).</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_yr.lab">yr.lab</code></td>
<td>
<p>Deprecated - use age.lab instead</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_verbose">verbose</code></td>
<td>
<p>Provide feedback on what is happening (default <code>verbose=TRUE</code>).</p>
</td></tr>
<tr><td><code id="proxy.ghost_+3A_add">add</code></td>
<td>
<p>Add to an existing graph (default <code>add=FALSE</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Place a csv file with the values of proxies against depth within your core's folder. The values should be in columns separated by commas (default <code>sep=","</code>), the first column containing the depths and the first line (header) containing the proxy names.
The file name should start with the core's name and end with &quot;_proxies.csv&quot;. For an example see <code>"Bacon_coredir/MSB2K/MSB2K_proxies.csv"</code> or <code>"Cores/MSB2K/MSB2K_proxies.csv"</code>.
</p>


<h3>Value</h3>

<p>A grey-scale graph of the proxy against calendar age.
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  Bacon(ask=FALSE, coredir=tempfile())
  layout(1)
  proxy.ghost()

</code></pre>

<hr>
<h2 id='scissors'>Remove the first n iterations.</h2><span id='topic+scissors'></span>

<h3>Description</h3>

<p>Removes iterations of the MCMC time series, and then updates the output file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scissors(burnin, set = get("info"), write = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scissors_+3A_burnin">burnin</code></td>
<td>
<p>Number of iterations to remove  of the iterative time series. If this value is higher than the amount of remaining iterations,
a warning is given and the iterations are not removed. If the provided number is negative, the iterations will be removed from the end of the run, not from the start. If a range is given, this range of iterations is removed.</p>
</td></tr>
<tr><td><code id="scissors_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="scissors_+3A_write">write</code></td>
<td>
<p>Whether or not to write the changes to the output file. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bacon will perform millions of MCMC iterations for each age-model run by default, although only a fraction
of these will be stored. In most cases the remaining MCMC iterations will be well mixed (the upper left panel
of the fit of the iterations shows no undesirable features such as trends or sudden systematic drops or rises).
If the run has a visible remaining burn-in, scissors can be used to remove them.
To remove, e.g., the first 300 iterations, type <code>scissors(300)</code>. To remove the last 300 iterations, type <code>scissors(-300)</code>. To remove iterations 300 to 600, type <code>scissors(300:600)</code>.
</p>


<h3>Value</h3>

<p>NA
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  Bacon(ask=FALSE, coredir=tempfile())
  nrow(info$output)
  scissors(100)
  nrow(info$output)


</code></pre>

<hr>
<h2 id='set.initvals'>Set initial values for the Bacon MCMC run.</h2><span id='topic+set.initvals'></span>

<h3>Description</h3>

<p>Select initial values th0 and th1 for a Bacon MCMC run and write them into a file that can be read by Bacon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set.initvals(set = get("info"), core = set$core, values = c(), click = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set.initvals_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="set.initvals_+3A_core">core</code></td>
<td>
<p>The name of the core for which a bacon.init file needs to be made</p>
</td></tr>
<tr><td><code id="set.initvals_+3A_values">values</code></td>
<td>
<p>use this if you wish to provide the values (2 rows with starting age, accumulation rates for each model section, and memory parameter w).</p>
</td></tr>
<tr><td><code id="set.initvals_+3A_click">click</code></td>
<td>
<p>use this if you wish to use the cursor to manually select age-depth points from the current graphic device. This is the default option. Right click once you have selected all datapoints, or provide the number of expected datapoints as a value (e.g., <code>click=5</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, the initial MCMC values th0 and th1 of the Bacon age-depth model (upper ages and accumulation rate
for each model section) are estimated randomly. Since version 3.1.0, these starting values can
also be provided in a file with extension _bacon.init, placed
within the core's folder. This file will need to have two rows,
each for one of the two initial sets of parameters required (the
t-walk requires two starting estimates for all MCMC parameters).
If such a file is found (and correctly formatted), Bacon will use
the values within this file as starting points for the MCMC run.
</p>


<h3>Value</h3>

<p>A .bacon.init file
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>

<hr>
<h2 id='squeeze'>Squeeze some depths of a core</h2><span id='topic+squeeze'></span>

<h3>Description</h3>

<p>Squeeze or compress depths below a boundary by a certain amount. Accompanies the stretch function; see the stretch function for code on running the accordion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>squeeze(d, boundary, times)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="squeeze_+3A_d">d</code></td>
<td>
<p>The depth(s) to be squeezed</p>
</td></tr>
<tr><td><code id="squeeze_+3A_boundary">boundary</code></td>
<td>
<p>The depth below which depths should be squeezed</p>
</td></tr>
<tr><td><code id="squeeze_+3A_times">times</code></td>
<td>
<p>The factor by which the depths should be squeezed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The squeezed depth(s)
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  squeeze(40,25,20)
</code></pre>

<hr>
<h2 id='stretch'>Stretch some depths of a core</h2><span id='topic+stretch'></span>

<h3>Description</h3>

<p>Stretch squeezed depths e.g., calculate the original depths of depths that were squeezed. Accompanies the squeeze function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stretch(d, boundary, times)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stretch_+3A_d">d</code></td>
<td>
<p>The depth(s) to be stretched</p>
</td></tr>
<tr><td><code id="stretch_+3A_boundary">boundary</code></td>
<td>
<p>The depth below which depths should be stretched</p>
</td></tr>
<tr><td><code id="stretch_+3A_times">times</code></td>
<td>
<p>The factor by which the depths should be stretched</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The stretched depth(s)
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  stretch(25.75,25,20)
## Not run: 
  # To play the accordion, first squeeze an existing core.
  # Let's squeeze the depths below 10 cm core depth 20 times:
  Bacon("accordion", 1)
  dets &lt;- info$dets
  dets[,4] &lt;- squeeze(dets[,4], 10, 20)

  # make a new directory for the squeezed core, and place the dets file there:
  dir.create("Bacon_runs/squeezed")
  write.table(dets, "Bacon_runs/squeezed/squeezed.csv", row.names=FALSE, sep=",")

  # now run that squeezed core, adding a boundary (10cm) and adapting the acc.mean prior (20x):
  Bacon("squeezed", 1, boundary=10, acc.mean=c(5, 20*5))
  # finally, plot while stretching the depths onto the original scale:
  agedepth(accordion=c(10,20))

## End(Not run)
</code></pre>

<hr>
<h2 id='thinner'>Thin iterations.</h2><span id='topic+thinner'></span>

<h3>Description</h3>

<p>Randomly thin iterations by a given proportion, for example if autocorrelation is visible within the MCMC series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thinner(proportion = 0.1, set = get("info"), write = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thinner_+3A_proportion">proportion</code></td>
<td>
<p>Proportion of iterations to remove. Should be between 0 and 1. Default <code>proportion=0.1</code>.</p>
</td></tr>
<tr><td><code id="thinner_+3A_set">set</code></td>
<td>
<p>Detailed information of the current run, stored within this session's memory as variable <code>info</code>.</p>
</td></tr>
<tr><td><code id="thinner_+3A_write">write</code></td>
<td>
<p>Whether or not to write the changes to the output file. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From all iterations, a proportion is removed with to-be-removed iterations sampled randomly among all iterations.
</p>


<h3>Value</h3>

<p>NA
</p>


<h3>Author(s)</h3>

<p>Maarten Blaauw, J. Andres Christen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  Bacon(ask=FALSE, coredir=tempfile())
  nrow(info$output)
  thinner(.2)
  nrow(info$output)


</code></pre>

<hr>
<h2 id='tofu'>Bacon for vegans</h2><span id='topic+tofu'></span>

<h3>Description</h3>

<p>Bacon for vegans
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tofu(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tofu_+3A_...">...</code></td>
<td>
<p>options for the Bacon command. See <a href="#topic+Bacon">Bacon</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>A vegan wrapper for Bacon - does everything Bacon does, but without the meat.
</p>


<h3>Value</h3>

<p>A tofu age-model
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
