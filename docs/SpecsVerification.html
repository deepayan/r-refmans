<!DOCTYPE html><html lang="en"><head><title>Help for package SpecsVerification</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SpecsVerification}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AbsErr'><p>Calculate the absolute error between forecast and observation</p></a></li>
<li><a href='#Auc'><p>Calculate area under the ROC curve (AUC) for a forecast and its verifying binary observation, and estimate the variance of the AUC</p></a></li>
<li><a href='#auc_cpp'><p>Calculate AUC and its sampling standard deviation (Internal C++ implementation)</p></a></li>
<li><a href='#AucDiff'><p>Calculate difference between areas under the ROC curve (AUC) between a forecast and a reference forecast for the same observation, and estimate the variance of the AUC difference</p></a></li>
<li><a href='#aucdiff_cpp'><p>Calculate AUC difference 'AUC(fcst,obs) - AUC(fcst_ref, obs)' of two forecasts for the same observations, and the sampling standard deviation of the AUC difference (Internal C++ implementation)</p></a></li>
<li><a href='#BrierDecomp'><p>Brier Score decomposition</p></a></li>
<li><a href='#ClimEns'><p>Construct a climatological ensemble from a vector of observations.</p></a></li>
<li><a href='#Corr'><p>Calculate correlation between forecasts and observations, and assess uncertainty</p></a></li>
<li><a href='#CorrDiff'><p>Calculate correlation difference between a forecast and a reference forecast, and assess uncertainty</p></a></li>
<li><a href='#Detrend'><p>Auxiliary function for removing trends and mean from observation vector or ensemble matrix.</p></a></li>
<li><a href='#DressCrps'><p>Calculate the Continuous Ranked Probability Score (CRPS) for a mixture of Normal distributions, for example generated by ensemble dressing</p></a></li>
<li><a href='#dresscrps_cpp'><p>Dress CRPS</p></a></li>
<li><a href='#DressCrpsDiff'><p>Calculate DressCrps Difference (deprecated, use function ScoreDiff instead)</p></a></li>
<li><a href='#DressCrpss'><p>Calculate DressCrps Skill Score (deprecated, use function SkillScore instead)</p></a></li>
<li><a href='#DressEnsemble'><p>Transform an ensemble forecast to a continuous forecast distribution by kernel dressing.</p></a></li>
<li><a href='#DressIgn'><p>Calculate the Logarithmic (Ignorance) Score for a mixture of Normal distributions, for example generated by ensemble dressing</p></a></li>
<li><a href='#DressIgnDiff'><p>Calculate DressIgn Difference (deprecated, use function ScoreDiff instead)</p></a></li>
<li><a href='#EnsBrier'><p>Calculate the ensemble-adjusted Brier Score</p></a></li>
<li><a href='#EnsBrierDiff'><p>Calculate EnsBrier Difference (deprecated, use function ScoreDiff instead)</p></a></li>
<li><a href='#EnsBrierSs'><p>Calculate EnsBrier Skill Score (deprecated, use function SkillScore instead)</p></a></li>
<li><a href='#EnsCorr'><p>Correlation skill analysis for ensemble forecasts</p></a></li>
<li><a href='#EnsCrps'><p>Calculate the ensemble-adjusted Continuous Ranked Probability Score (CRPS)</p></a></li>
<li><a href='#enscrps_cpp'><p>CRPS for ensemble forecasts (C++ implementation)</p></a></li>
<li><a href='#EnsCrpsDiff'><p>Calculate EnsCrps Difference (deprecated, use function ScoreDiff instead)</p></a></li>
<li><a href='#EnsCrpss'><p>Calculate EnsCrps Skill Score (deprecated, use function SkillScore instead)</p></a></li>
<li><a href='#EnsQs'><p>Calculate the ensemble-adjusted Quadratic Score (QS) for categorical forecasts</p></a></li>
<li><a href='#EnsRps'><p>Calculate the ensemble-adjusted Ranked Probability Score (RPS) for categorical forecasts</p></a></li>
<li><a href='#EnsRpsDiff'><p>Calculate EnsRps Difference (deprecated, use function ScoreDiff instead)</p></a></li>
<li><a href='#EnsRpss'><p>Calculate EnsRps Skill Score (deprecated, use function SkillScore instead)</p></a></li>
<li><a href='#eurotempforecast'><p>Seasonal ensemble forecast of European average summer temperature</p></a></li>
<li><a href='#FairBrierDiff'><p>Calculate FairBrier Difference (deprecated, use function ScoreDiff instead)</p></a></li>
<li><a href='#FairBrierSs'><p>Calculate FairBrier Skill Score (deprecated, use function SkillScore instead)</p></a></li>
<li><a href='#FairCrpsDiff'><p>Calculate FairCrps Difference (deprecated, use function ScoreDiff instead)</p></a></li>
<li><a href='#FairCrpss'><p>Calculate FairCrps Skill Score (deprecated, use function SkillScore instead)</p></a></li>
<li><a href='#FairRpsDiff'><p>Calculate FairRps Difference (deprecated, use function ScoreDiff instead)</p></a></li>
<li><a href='#FairRpss'><p>Calculate FairRps Skill Score (deprecated, use function SkillScore instead)</p></a></li>
<li><a href='#FitAkdParameters'><p>Fit the 5 parameters used for affine kernel dressing by minimum CRPS estimation.</p></a></li>
<li><a href='#GaussCrps'><p>Calculate the Continuous Ranked Probability Score (CRPS) for forecasts issued as Normal distributions</p></a></li>
<li><a href='#GaussCrpsDiff'><p>Calculate GaussCrps Difference (deprecated, use function ScoreDiff instead)</p></a></li>
<li><a href='#GaussCrpss'><p>Calculate GaussCrps Skill Score (deprecated, use function SkillScore instead)</p></a></li>
<li><a href='#GenerateToyData'><p>Generate artificial data for ensemble verification using a signal-plus-noise model</p></a></li>
<li><a href='#GetDensity'><p>Calculate density and integrated density function of a dressed ensemble forecast at a matrix of values</p></a></li>
<li><a href='#PlotDressedEns'><p>Plot a series forecast distributions of dressed ensembles</p></a></li>
<li><a href='#PlotRankhist'><p>Plotting function for rank histograms</p></a></li>
<li><a href='#Rankhist'><p>Rank histogram for ensemble forecasts</p></a></li>
<li><a href='#ReliabilityDiagram'><p>Reliability diagram for probability forecasts</p></a></li>
<li><a href='#ScoreDiff'><p>Calculate average score difference and assess uncertainty</p></a></li>
<li><a href='#SkillScore'><p>Calculate a skill score and assess uncertainty.</p></a></li>
<li><a href='#SpecsVerification'><p>SpecsVerification - Forecast verification routines</p></a></li>
<li><a href='#SqErr'><p>Calculate the squared error between forecast and observation</p></a></li>
<li><a href='#TestRankhist'><p>Statistical tests for rank histograms</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.5-3</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-02-26</td>
</tr>
<tr>
<td>Title:</td>
<td>Forecast Verification Routines for Ensemble Forecasts of Weather
and Climate</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stefan Siegert &lt;s.siegert@exeter.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of forecast verification routines developed for the SPECS
    FP7 project. The emphasis is on comparative verification of ensemble forecasts of weather and climate.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-02-26 13:27:31 UTC; stefan</td>
</tr>
<tr>
<td>Author:</td>
<td>Stefan Siegert [aut, cre],
  Jonas Bhend [ctb],
  Igor Kroener [ctb],
  Matteo De Felice [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-02-26 15:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='AbsErr'>Calculate the absolute error between forecast and observation</h2><span id='topic+AbsErr'></span>

<h3>Description</h3>

<p>Calculate the absolute error between forecast and observation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AbsErr(fcst, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AbsErr_+3A_fcst">fcst</code></td>
<td>
<p>a N-vector representing N time instances of real-valued forecasts</p>
</td></tr>
<tr><td><code id="AbsErr_+3A_obs">obs</code></td>
<td>
<p>a N-vector representing N time instances of real-valued observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric N-vector of absolute errors |fcst - obs|
</p>


<h3>See Also</h3>

<p>SqErr, ScoreDiff, SkillScore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
mean(AbsErr(rowMeans(ens), obs))
</code></pre>

<hr>
<h2 id='Auc'>Calculate area under the ROC curve (AUC) for a forecast and its verifying binary observation, and estimate the variance of the AUC</h2><span id='topic+Auc'></span>

<h3>Description</h3>

<p>Calculate area under the ROC curve (AUC) for a forecast and its verifying binary observation, and estimate the variance of the AUC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Auc(
  fcst,
  obs,
  handle.na = c("na.fail", "only.complete.pairs"),
  use_fn = c("C++", "R")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Auc_+3A_fcst">fcst</code></td>
<td>
<p>vector of forecasts</p>
</td></tr>
<tr><td><code id="Auc_+3A_obs">obs</code></td>
<td>
<p>vector of binary observations (0 for non-occurrence, 1 for occurrence of the event)</p>
</td></tr>
<tr><td><code id="Auc_+3A_handle.na">handle.na</code></td>
<td>
<p>how should missing values in forecasts and observations be handled; possible values are 'na.fail' and 'only.complete.pairs'; default: 'na.fail'</p>
</td></tr>
<tr><td><code id="Auc_+3A_use_fn">use_fn</code></td>
<td>
<p>the function used for the calculation: 'C++' (default) for the fast C++ implementation, or 'R' for the slow (but more readable) R implementation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing AUC and its estimated sampling standard deviation
</p>


<h3>References</h3>

<p>DeLong et al (1988): Comparing the Areas under Two or More Correlated Receiver Operating Characteristic Curves: A Nonparametric Approach. Biometrics. <a href="https://www.jstor.org/stable/2531595">https://www.jstor.org/stable/2531595</a>
Sun and Xu (2014): Fast Implementation of DeLong's Algorithm for Comparing the Areas Under Correlated Receiver Operating Characteristic Curves. IEEE Sign Proc Let 21(11). doi: <a href="https://doi.org/10.1109/LSP.2014.2337313">10.1109/LSP.2014.2337313</a>
</p>


<h3>See Also</h3>

<p>AucDiff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
Auc(rowMeans(ens.bin), obs.bin)
</code></pre>

<hr>
<h2 id='auc_cpp'>Calculate AUC and its sampling standard deviation (Internal C++ implementation)</h2><span id='topic+auc_cpp'></span>

<h3>Description</h3>

<p>Calculate AUC and its sampling standard deviation (Internal C++ implementation)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auc_cpp(fcst, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="auc_cpp_+3A_fcst">fcst</code></td>
<td>
<p>numeric vector of forecasts (NAs are not allowed)</p>
</td></tr>
<tr><td><code id="auc_cpp_+3A_obs">obs</code></td>
<td>
<p>vector of binary observations (obs[t] evaluates to TRUE if event happens at instance t, to FALSE otherwise)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>AUC and its sampling standard deviation
</p>


<h3>See Also</h3>

<p>Auc AucDiff
</p>

<hr>
<h2 id='AucDiff'>Calculate difference between areas under the ROC curve (AUC) between a forecast and a reference forecast for the same observation, and estimate the variance of the AUC difference</h2><span id='topic+AucDiff'></span>

<h3>Description</h3>

<p>Calculate difference between areas under the ROC curve (AUC) between a forecast and a reference forecast for the same observation, and estimate the variance of the AUC difference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AucDiff(
  fcst,
  fcst.ref,
  obs,
  handle.na = c("na.fail", "only.complete.triplets"),
  use_fn = c("C++", "R")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AucDiff_+3A_fcst">fcst</code></td>
<td>
<p>vector of forecasts</p>
</td></tr>
<tr><td><code id="AucDiff_+3A_fcst.ref">fcst.ref</code></td>
<td>
<p>vector of reference forecasts</p>
</td></tr>
<tr><td><code id="AucDiff_+3A_obs">obs</code></td>
<td>
<p>vector of binary observations (0 for non-occurrence, 1 for occurrence of the event)</p>
</td></tr>
<tr><td><code id="AucDiff_+3A_handle.na">handle.na</code></td>
<td>
<p>how should missing values in forecasts and observations be handled; possible values are 'na.fail' and 'only.complete.triplets'; default: 'na.fail'</p>
</td></tr>
<tr><td><code id="AucDiff_+3A_use_fn">use_fn</code></td>
<td>
<p>the function used for the calculation: 'C++' (default) for the fast C++ implementation, or 'R' for the slow (but more readable) R implementation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with AUC difference, and estimated standard deviation
</p>


<h3>References</h3>

<p>DeLong et al (1988): Comparing the Areas under Two or More Correlated Receiver Operating Characteristic Curves: A Nonparametric Approach. Biometrics.  <a href="https://www.jstor.org/stable/2531595">https://www.jstor.org/stable/2531595</a>
Sun and Xu (2014): Fast Implementation of DeLong's Algorithm for Comparing the Areas Under Correlated Receiver Operating Characteristic Curves. IEEE Sign Proc Let 21(11). doi: <a href="https://doi.org/10.1109/LSP.2014.2337313">10.1109/LSP.2014.2337313</a>
</p>


<h3>See Also</h3>

<p>Auc
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
AucDiff(rowMeans(ens.bin), ens.bin[, 1], obs.bin)
</code></pre>

<hr>
<h2 id='aucdiff_cpp'>Calculate AUC difference 'AUC(fcst,obs) - AUC(fcst_ref, obs)' of two forecasts for the same observations, and the sampling standard deviation of the AUC difference (Internal C++ implementation)</h2><span id='topic+aucdiff_cpp'></span>

<h3>Description</h3>

<p>Calculate AUC difference 'AUC(fcst,obs) - AUC(fcst_ref, obs)' of two forecasts for the same observations, and the sampling standard deviation of the AUC difference (Internal C++ implementation)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aucdiff_cpp(fcst, fcst_ref, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="aucdiff_cpp_+3A_fcst">fcst</code></td>
<td>
<p>numeric vector of forecasts (NAs are not allowed)</p>
</td></tr>
<tr><td><code id="aucdiff_cpp_+3A_fcst_ref">fcst_ref</code></td>
<td>
<p>numeric vector of reference forecasts (NAs are not allowed)</p>
</td></tr>
<tr><td><code id="aucdiff_cpp_+3A_obs">obs</code></td>
<td>
<p>vector of binary observations (obs[t] evaluates to TRUE if event happens at instance t, to FALSE otherwise)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>AUC values, their sampling standard deviations, the AUC difference, and their sampling standard deviations
</p>


<h3>See Also</h3>

<p>Auc AucDiff
</p>

<hr>
<h2 id='BrierDecomp'>Brier Score decomposition</h2><span id='topic+BrierDecomp'></span><span id='topic+BrierScoreDecomposition'></span>

<h3>Description</h3>

<p>Return decomposition of the Brier Score into Reliability, Resolution and Uncertainty, and estimated standard deviations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BrierDecomp(p, y, bins = 10, bias.corrected = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BrierDecomp_+3A_p">p</code></td>
<td>
<p>vector of forecast probabilities</p>
</td></tr>
<tr><td><code id="BrierDecomp_+3A_y">y</code></td>
<td>
<p>binary observations, y[t]=1 if an event happens at time t, and y[t]=0 otherwise</p>
</td></tr>
<tr><td><code id="BrierDecomp_+3A_bins">bins</code></td>
<td>
<p>binning to estimate the calibration function (see Details), default: 10</p>
</td></tr>
<tr><td><code id="BrierDecomp_+3A_bias.corrected">bias.corrected</code></td>
<td>
<p>logical, default=FALSE, whether the standard (biased) decomposition of Murphy (1973) should be used, or the bias-corrected decomposition of Ferro (2012)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To estimate the calibration curve, the unit line is categorised into discrete bins, provided by the 'bins' argument. If 'bins' is a single number, it specifies the number of equidistant bins. If 'bins' is a vector of values between zero and one, these values are used as the bin-breaks.
</p>


<h3>Value</h3>

<p>Estimators of the three components and their estimated standard deviations are returned as a 2*3 matrix.
</p>


<h3>References</h3>

<p>Murphy (1973): A New Vector Partition of the Probability Score. J. Appl. Met. doi: <a href="https://doi.org/10.1175/1520-0450(1973)012%3C0595:ANVPOT%3E2.0.CO;2">10.1175/1520-0450(1973)012&lt;0595:ANVPOT&gt;2.0.CO;2</a>
</p>
<p>Ferro and Fricker (2012): A bias-corrected decomposition of the Brier score. QJRMS. doi: <a href="https://doi.org/10.1002/qj.1924">10.1002/qj.1924</a>
</p>
<p>Siegert (2013): Variance estimation for Brier Score decomposition. QJRMS. doi: <a href="https://doi.org/10.1002/qj.2228">10.1002/qj.2228</a>
</p>


<h3>See Also</h3>

<p>ReliabilityDiagram
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
BrierDecomp(rowMeans(ens.bin), obs.bin, bins=3, bias.corrected=TRUE)
</code></pre>

<hr>
<h2 id='ClimEns'>Construct a climatological ensemble from a vector of observations.</h2><span id='topic+ClimEns'></span>

<h3>Description</h3>

<p>Construct a climatological ensemble from a vector of observations. Optionally, the climatological ensemble observation at time t can be constructed without the observation at time t (leave-one-out).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ClimEns(obs, leave.one.out=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ClimEns_+3A_obs">obs</code></td>
<td>
<p>vector of length N. The observations.</p>
</td></tr>
<tr><td><code id="ClimEns_+3A_leave.one.out">leave.one.out</code></td>
<td>
<p>logical, default=FALSE. If TRUE, the n-th observation is removed from the n-th row of the ensemble matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix with N rows and N-1 columns (if leave.one.out==TRUE) or N columns otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
ClimEns(obs)
</code></pre>

<hr>
<h2 id='Corr'>Calculate correlation between forecasts and observations, and assess uncertainty</h2><span id='topic+Corr'></span>

<h3>Description</h3>

<p>Calculate correlation between forecasts and observations, and assess uncertainty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Corr(fcst, obs, N.eff = NA, conf.level = 0.95, handle.na = "na.fail")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Corr_+3A_fcst">fcst</code></td>
<td>
<p>vector of forecasts</p>
</td></tr>
<tr><td><code id="Corr_+3A_obs">obs</code></td>
<td>
<p>vector of observations</p>
</td></tr>
<tr><td><code id="Corr_+3A_n.eff">N.eff</code></td>
<td>
<p>user-defined effective sample size to be used in hypothesis test and for confidence bounds; if NA, the length of 'obs' is used after removing missing values; default: NA</p>
</td></tr>
<tr><td><code id="Corr_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level used the confidence interval; default = 0.95</p>
</td></tr>
<tr><td><code id="Corr_+3A_handle.na">handle.na</code></td>
<td>
<p>how should missing values in forecasts and observations be handled; possible values are 'na.fail' and 'use.pairwise.complete'; default: 'na.fail'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with correlation, one-sided p-value, and central confidence interval at the user-defined confidence level
</p>


<h3>References</h3>

<p>Von Storch, Zwiers (2001): Statistical analysis in climate research. Cambridge University Press.
</p>


<h3>See Also</h3>

<p>CorrDiff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
Corr(rowMeans(ens), obs)
</code></pre>

<hr>
<h2 id='CorrDiff'>Calculate correlation difference between a forecast and a reference forecast, and assess uncertainty</h2><span id='topic+CorrDiff'></span>

<h3>Description</h3>

<p>Calculate correlation difference between a forecast and a reference forecast, and assess uncertainty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CorrDiff(
  fcst,
  fcst.ref,
  obs,
  N.eff = NA,
  conf.level = 0.95,
  handle.na = "na.fail"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CorrDiff_+3A_fcst">fcst</code></td>
<td>
<p>vector of forecasts</p>
</td></tr>
<tr><td><code id="CorrDiff_+3A_fcst.ref">fcst.ref</code></td>
<td>
<p>vector of reference forecasts</p>
</td></tr>
<tr><td><code id="CorrDiff_+3A_obs">obs</code></td>
<td>
<p>vector of observations</p>
</td></tr>
<tr><td><code id="CorrDiff_+3A_n.eff">N.eff</code></td>
<td>
<p>user-defined effective sample size to be used in hypothesis test and for confidence bounds; if NA, the length of 'obs' is used after removing missing values; default: NA</p>
</td></tr>
<tr><td><code id="CorrDiff_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for the confidence interval; default = 0.95</p>
</td></tr>
<tr><td><code id="CorrDiff_+3A_handle.na">handle.na</code></td>
<td>
<p>how should missing values in forecasts and observations be handled; possible values are 'na.fail' and 'only.complete.triplets'; default: 'na.fail'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with correlation difference, one-sided p-value, and central confidence interval at the user-defined confidence level
</p>


<h3>References</h3>

<p>Steiger (1980): Tests for comparing elements of a correlation matrix. Psychological Bulletin. doi: <a href="https://doi.org/10.1037/0033-2909.87.2.245">10.1037/0033-2909.87.2.245</a> 
Zou (2007): Toward using confidence intervals to compare correlations. Psychological Methods. doi: <a href="https://doi.org/10.1037/1082-989X.12.4.399">10.1037/1082-989X.12.4.399</a>
</p>


<h3>See Also</h3>

<p>Corr
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
CorrDiff(rowMeans(ens), ens[, 1], obs)
</code></pre>

<hr>
<h2 id='Detrend'>Auxiliary function for removing trends and mean from observation vector or ensemble matrix.</h2><span id='topic+Detrend'></span>

<h3>Description</h3>

<p>Detrend fits a linear function to a time-series of observations or to the time-series of ensemble means of an ensemble matrix. The linear trend is removed, and if option demean is true, the total mean is removed as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Detrend(x, demean = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Detrend_+3A_x">x</code></td>
<td>
<p>A vector, matrix, or data.frame.</p>
</td></tr>
<tr><td><code id="Detrend_+3A_demean">demean</code></td>
<td>
<p>logical; if true, the total mean is removed from x</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns an object of the same dimensions as the argument 'x', but with its linear trend and (possibly) its mean removed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(eurotempforecast)
 Detrend(ens)
 Detrend(obs, demean=FALSE)
</code></pre>

<hr>
<h2 id='DressCrps'>Calculate the Continuous Ranked Probability Score (CRPS) for a mixture of Normal distributions, for example generated by ensemble dressing</h2><span id='topic+DressCrps'></span>

<h3>Description</h3>

<p>Calculate the Continuous Ranked Probability Score (CRPS) for a mixture of Normal distributions, for example generated by ensemble dressing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DressCrps(dressed.ens, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DressCrps_+3A_dressed.ens">dressed.ens</code></td>
<td>
<p>a list with elements 'ens', a N*R matrix representing N time instances of kernel centers, and 'ker.wd', a N*R matrix with corresponding kernel standard deviations. See function 'DressEnsemble'</p>
</td></tr>
<tr><td><code id="DressCrps_+3A_obs">obs</code></td>
<td>
<p>a numeric vector of length N with real-valued observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of length N with the CRPS values
</p>


<h3>References</h3>

<p>Grimit et al (2006): The continuous ranked probability score for circular variables and its application to mesoscale forecast ensemble verification. Q.J.R. Meteorol. Soc. doi: <a href="https://doi.org/10.1256/qj.05.235">10.1256/qj.05.235</a>
</p>


<h3>See Also</h3>

<p>EnsCrps, ScoreDiff, SkillScore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
dressed.ens &lt;- DressEnsemble(ens)
mean(DressCrps(dressed.ens, obs))
</code></pre>

<hr>
<h2 id='dresscrps_cpp'>Dress CRPS</h2><span id='topic+dresscrps_cpp'></span>

<h3>Description</h3>

<p>Dress CRPS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dresscrps_cpp(m, s, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dresscrps_cpp_+3A_m">m</code></td>
<td>
<p>vector of kernel means</p>
</td></tr>
<tr><td><code id="dresscrps_cpp_+3A_s">s</code></td>
<td>
<p>vector of kernel standard deviations</p>
</td></tr>
<tr><td><code id="dresscrps_cpp_+3A_y">y</code></td>
<td>
<p>observation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>crps
</p>

<hr>
<h2 id='DressCrpsDiff'>Calculate DressCrps Difference (deprecated, use function ScoreDiff instead)</h2><span id='topic+DressCrpsDiff'></span>

<h3>Description</h3>

<p>Calculate DressCrps Difference (deprecated, use function ScoreDiff instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DressCrpsDiff(dressed.ens, dressed.ens.ref, obs, probs = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DressCrpsDiff_+3A_dressed.ens">dressed.ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="DressCrpsDiff_+3A_dressed.ens.ref">dressed.ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="DressCrpsDiff_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="DressCrpsDiff_+3A_probs">probs</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean DressCrps difference
</p>


<h3>See Also</h3>

<p>ScoreDiff DressCrps DressEnsemble
</p>

<hr>
<h2 id='DressCrpss'>Calculate DressCrps Skill Score (deprecated, use function SkillScore instead)</h2><span id='topic+DressCrpss'></span>

<h3>Description</h3>

<p>Calculate DressCrps Skill Score (deprecated, use function SkillScore instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DressCrpss(dressed.ens, dressed.ens.ref, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DressCrpss_+3A_dressed.ens">dressed.ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="DressCrpss_+3A_dressed.ens.ref">dressed.ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="DressCrpss_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>DressCrps Skill Score
</p>


<h3>See Also</h3>

<p>SkillScore DressCrps DressEnsemble
</p>

<hr>
<h2 id='DressEnsemble'>Transform an ensemble forecast to a continuous forecast distribution by kernel dressing.</h2><span id='topic+DressEnsemble'></span>

<h3>Description</h3>

<p>Transform an ensemble forecast to a continuous forecast distribution by kernel dressing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DressEnsemble(ens, dressing.method = "silverman", parameters = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DressEnsemble_+3A_ens">ens</code></td>
<td>
<p>a N*R matrix representing N time instances of real-valued R-member ensemble forecasts</p>
</td></tr>
<tr><td><code id="DressEnsemble_+3A_dressing.method">dressing.method</code></td>
<td>
<p>One of &quot;silverman&quot; (default), &quot;akd&quot;, &quot;akd.fit&quot;. See Details.</p>
</td></tr>
<tr><td><code id="DressEnsemble_+3A_parameters">parameters</code></td>
<td>
<p>A list, containing the parameters for the dressing method. See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The dressing methods currently implemented and their required parameters are:
</p>

<dl>
<dt>&quot;silverman&quot; (default)</dt><dd><p>No parameters are given. At time instance &lsquo;n' each ensemble member is replaced by a Gaussian kernel with mean ens[n, k] and variance (4 / 3 / K)^0.4 * var(ens[n, ]). This method is called &quot;Silverman&rsquo;s rule of thumb&quot; and provides a simple non-parametric method for smoothing a discrete ensemble.</p>
</dd>
<dt>&quot;akd&quot;</dt><dd><p>Affine Kernel Dressing. The required parameters are list(r1, r2, a, s1, s2). The 'k'-th ensemble member at time instance 'n' is dressed with a Gaussian kernel with mean r1 + r2 * mean(ens[n,]) + a * ens[n, k] and variance (4 / 3 / K)^0.4 * (s1 + s2 * a^2 * var(ens[n,])). Negative variances are set to zero. Note that parameters = list(r1=0, r2=0, a=1, s1=0, s2=1) yields the same dressed ensemble as dressing.method=&quot;silverman&quot;.</p>
</dd>
<dt>&quot;akd.fit&quot;</dt><dd><p>Affine Kernel Dressing with fitted parameters. The required parameters is list(obs), where 'obs' is a vector of observations which are used to optimize the parameters r1, r2, a, s1, s2 by CRPS minimization. See ?FitAkdParameters for more information.</p>
</dd>
</dl>



<h3>Value</h3>

<p>The function returns a list with elements 'ens' (a N*R matrix, where ens[t,r] is the mean of the r-th kernel at time instance t) and 'ker.wd' (a N*R matrix, where ker.wd[t,r] is the standard deviation of the r-th kernel at time t)
</p>


<h3>References</h3>

<p>Silverman, B.W. (1998). Density Estimation for Statistics and Data Analysis. London: Chapman &amp; Hall/CRC. ISBN 0-412-24620-1.
Broecker J. and Smith L. (2008). From ensemble forecasts to predictive distribution functions. Tellus (2008), 60A, 663&ndash;678. doi: <a href="https://doi.org/10.1111/j.1600-0870.2008.00333.x">10.1111/j.1600-0870.2008.00333.x</a>.
</p>


<h3>See Also</h3>

<p>DressCrps, DressIgn, GetDensity, FitAkdParameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
d.silverman &lt;- DressEnsemble(ens)
d.akd &lt;- DressEnsemble(ens, dressing.method="akd", 
                       parameters=list(r1=0, r2=0, a=1, 
                                       s1=0, s2=0))
d.akd.fit &lt;- DressEnsemble(ens, dressing.method="akd.fit", 
                           parameters=list(obs=obs))
</code></pre>

<hr>
<h2 id='DressIgn'>Calculate the Logarithmic (Ignorance) Score for a mixture of Normal distributions, for example generated by ensemble dressing</h2><span id='topic+DressIgn'></span>

<h3>Description</h3>

<p>Calculate the Logarithmic (Ignorance) Score for a mixture of Normal distributions, for example generated by ensemble dressing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DressIgn(dressed.ens, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DressIgn_+3A_dressed.ens">dressed.ens</code></td>
<td>
<p>a list with elements 'ens', a N*R matrix representing N time instances of kernel centers, and 'ker.wd', a N*R matrix with corresponding kernel standard deviations. See function 'DressEnsemble'</p>
</td></tr>
<tr><td><code id="DressIgn_+3A_obs">obs</code></td>
<td>
<p>a numeric vector of length N with real-valued observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of length N with the Ignorance score values
</p>


<h3>References</h3>

<p>Roulston and Smith (2002) Evaluating Probabilistic Forecasts Using Information Theory, doi: <a href="https://doi.org/10.1175/1520-0493(2002)130%3C1653:EPFUIT%3E2.0.CO;2">10.1175/1520-0493(2002)130&lt;1653:EPFUIT&gt;2.0.CO;2</a>
</p>


<h3>See Also</h3>

<p>DressEnsemble, DressCrps
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
d.ens &lt;- DressEnsemble(ens)
DressIgn(d.ens, obs)
</code></pre>

<hr>
<h2 id='DressIgnDiff'>Calculate DressIgn Difference (deprecated, use function ScoreDiff instead)</h2><span id='topic+DressIgnDiff'></span>

<h3>Description</h3>

<p>Calculate DressIgn Difference (deprecated, use function ScoreDiff instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DressIgnDiff(dressed.ens, dressed.ens.ref, obs, probs = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DressIgnDiff_+3A_dressed.ens">dressed.ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="DressIgnDiff_+3A_dressed.ens.ref">dressed.ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="DressIgnDiff_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="DressIgnDiff_+3A_probs">probs</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean DressIgn difference
</p>


<h3>See Also</h3>

<p>ScoreDiff DressIgn
</p>

<hr>
<h2 id='EnsBrier'>Calculate the ensemble-adjusted Brier Score</h2><span id='topic+EnsBrier'></span><span id='topic+FairBrier'></span>

<h3>Description</h3>

<p>Calculate the ensemble-adjusted Brier Score
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EnsBrier(ens, obs, R.new = NA)

FairBrier(ens, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EnsBrier_+3A_ens">ens</code></td>
<td>
<p>a N*R matrix representing N time instances of R-member ensemble forecasts of binary events; ens[t,r]=1 if the r-th ensemble member at time t predicted the event, otherwise ens[t,r]=0</p>
</td></tr>
<tr><td><code id="EnsBrier_+3A_obs">obs</code></td>
<td>
<p>a numeric vector of length N with binary observations; obs[t]=1 if the event happens at time t, otherwise obs[t]=0</p>
</td></tr>
<tr><td><code id="EnsBrier_+3A_r.new">R.new</code></td>
<td>
<p>ensemble size for which the scores should be adjusted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'FairBrier(ens, obs)' returns 'EnsBrier(ens, obs, R.new=Inf)'
</p>


<h3>Value</h3>

<p>numeric vector of length N with the ensemble-adjusted Brier scores
</p>


<h3>References</h3>

<p>Ferro CAT, Richardson SR, Weigel AP (2008) On the effect of ensemble size on the discrete and continuous ranked probability scores. Meteorological Applications. doi: <a href="https://doi.org/10.1002/met.45">10.1002/met.45</a>
</p>


<h3>See Also</h3>

<p>EnsRps, EnsCrps, ScoreDiff, SkillScore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
mean(EnsBrier(ens.bin, obs.bin, R.new=Inf))
</code></pre>

<hr>
<h2 id='EnsBrierDiff'>Calculate EnsBrier Difference (deprecated, use function ScoreDiff instead)</h2><span id='topic+EnsBrierDiff'></span>

<h3>Description</h3>

<p>Calculate EnsBrier Difference (deprecated, use function ScoreDiff instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EnsBrierDiff(ens, ens.ref, obs, tau = NA, probs = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EnsBrierDiff_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="EnsBrierDiff_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="EnsBrierDiff_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="EnsBrierDiff_+3A_tau">tau</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="EnsBrierDiff_+3A_probs">probs</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean EnsBrier difference
</p>


<h3>See Also</h3>

<p>ScoreDiff EnsBrier
</p>

<hr>
<h2 id='EnsBrierSs'>Calculate EnsBrier Skill Score (deprecated, use function SkillScore instead)</h2><span id='topic+EnsBrierSs'></span>

<h3>Description</h3>

<p>Calculate EnsBrier Skill Score (deprecated, use function SkillScore instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EnsBrierSs(ens, ens.ref, obs, tau = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EnsBrierSs_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="EnsBrierSs_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="EnsBrierSs_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="EnsBrierSs_+3A_tau">tau</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>EnsBrier skill score
</p>


<h3>See Also</h3>

<p>SkillScore EnsBrier
</p>

<hr>
<h2 id='EnsCorr'>Correlation skill analysis for ensemble forecasts</h2><span id='topic+EnsCorr'></span>

<h3>Description</h3>

<p>Calculate correlation between forecasts and observations for an ensemble forecast, including an adjustment for finite ensemble sizes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EnsCorr(ens, obs, R.new = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EnsCorr_+3A_ens">ens</code></td>
<td>
<p>a N*R matrix representing N time instances of real-valued R-member ensemble forecasts</p>
</td></tr>
<tr><td><code id="EnsCorr_+3A_obs">obs</code></td>
<td>
<p>a numeric vector of length N with real-valued observations</p>
</td></tr>
<tr><td><code id="EnsCorr_+3A_r.new">R.new</code></td>
<td>
<p>positive number, can be <code>Inf</code>, ensemble size for which correlation skill should be estimated, default is NA for using the actual size R of the ensemble</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with 4 entries:
</p>

<ul>
<li> <p><code>cmy</code>: Correlation skill of the ensemble mean forecast
</p>
</li>
<li> <p><code>cmy_adj</code>: Correlation skill of the ensemble mean forecast adjusted to ensemble size R.new
</p>
</li>
<li> <p><code>cxx</code>: Average correlation between ensemble members
</p>
</li>
<li> <p><code>cxy</code>: Average correlation between individual ensemble members and observation
</p>
</li></ul>



<h3>References</h3>

<p>Von Storch, Zwiers (2001): Statistical analysis in climate research. Cambridge University Press.
</p>
<p>Murphy (1990), Assessment of the practical utility of extended range ensemble forecasts, Q. J. R. Meteorol. Soc., 116, 89-125.
</p>


<h3>See Also</h3>

<p>Corr, CorrDiff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
EnsCorr(ens, obs, R.new=Inf)
</code></pre>

<hr>
<h2 id='EnsCrps'>Calculate the ensemble-adjusted Continuous Ranked Probability Score (CRPS)</h2><span id='topic+EnsCrps'></span><span id='topic+FairCrps'></span>

<h3>Description</h3>

<p>Calculate the ensemble-adjusted Continuous Ranked Probability Score (CRPS)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EnsCrps(ens, obs, R.new = NA)

FairCrps(ens, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EnsCrps_+3A_ens">ens</code></td>
<td>
<p>a N*R matrix representing N time instances of real-valued R-member ensemble forecasts</p>
</td></tr>
<tr><td><code id="EnsCrps_+3A_obs">obs</code></td>
<td>
<p>a numeric vector of length N with real-valued observations</p>
</td></tr>
<tr><td><code id="EnsCrps_+3A_r.new">R.new</code></td>
<td>
<p>positive number, can be 'Inf', ensemble size for which the scores should be adjusted, default is NA for no adjustment</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'FairCrps(ens, obs)' returns 'EnsCrps(ens, obs, R.new=Inf)'
</p>


<h3>Value</h3>

<p>numeric vector of length N with the ensemble-adjusted CRPS values
</p>


<h3>References</h3>

<p>Ferro CAT, Richardson SR, Weigel AP (2008) On the effect of ensemble size on the discrete and continuous ranked probability scores. Meteorological Applications. doi: <a href="https://doi.org/10.1002/met.45">10.1002/met.45</a>
</p>


<h3>See Also</h3>

<p>EnsBrier, EnsRps, DressCrps, GaussCrps, ScoreDiff, SkillScore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
mean(EnsCrps(ens, obs, R.new=Inf))
</code></pre>

<hr>
<h2 id='enscrps_cpp'>CRPS for ensemble forecasts (C++ implementation)</h2><span id='topic+enscrps_cpp'></span>

<h3>Description</h3>

<p>CRPS for ensemble forecasts (C++ implementation)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enscrps_cpp(ens, obs, R_new)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="enscrps_cpp_+3A_ens">ens</code></td>
<td>
<p>Ensemble members as columns of a matrix</p>
</td></tr>
<tr><td><code id="enscrps_cpp_+3A_obs">obs</code></td>
<td>
<p>The verifying observations</p>
</td></tr>
<tr><td><code id="enscrps_cpp_+3A_r_new">R_new</code></td>
<td>
<p>Size for ensemble adjustment</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of crps values
</p>

<hr>
<h2 id='EnsCrpsDiff'>Calculate EnsCrps Difference (deprecated, use function ScoreDiff instead)</h2><span id='topic+EnsCrpsDiff'></span>

<h3>Description</h3>

<p>Calculate EnsCrps Difference (deprecated, use function ScoreDiff instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EnsCrpsDiff(ens, ens.ref, obs, probs = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EnsCrpsDiff_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="EnsCrpsDiff_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="EnsCrpsDiff_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="EnsCrpsDiff_+3A_probs">probs</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean EnsCrps difference
</p>


<h3>See Also</h3>

<p>ScoreDiff EnsCrps
</p>

<hr>
<h2 id='EnsCrpss'>Calculate EnsCrps Skill Score (deprecated, use function SkillScore instead)</h2><span id='topic+EnsCrpss'></span>

<h3>Description</h3>

<p>Calculate EnsCrps Skill Score (deprecated, use function SkillScore instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EnsCrpss(ens, ens.ref, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EnsCrpss_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="EnsCrpss_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="EnsCrpss_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>EnsCrps skill score
</p>


<h3>See Also</h3>

<p>SkillScore EnsCrps
</p>

<hr>
<h2 id='EnsQs'>Calculate the ensemble-adjusted Quadratic Score (QS) for categorical forecasts</h2><span id='topic+EnsQs'></span><span id='topic+FairQs'></span>

<h3>Description</h3>

<p>Calculate the ensemble-adjusted Quadratic Score (QS) for categorical forecasts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EnsQs(ens, obs, R.new = NA)

FairQs(ens, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EnsQs_+3A_ens">ens</code></td>
<td>
<p>a N*R matrix of integers, representing N time instances of categorical ensemble forecasts; ens[t,r] indicates the category index that the r-th ensemble member forecasts at time t</p>
</td></tr>
<tr><td><code id="EnsQs_+3A_obs">obs</code></td>
<td>
<p>a vector of length N, obs[t] is the category that occurred at time t</p>
</td></tr>
<tr><td><code id="EnsQs_+3A_r.new">R.new</code></td>
<td>
<p>ensemble size for which the scores should be adjusted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'FairQs(ens, obs)' returns 'EnsQs(ens, obs, R.new=Inf)'
</p>
<p>It is assumed that the smallest class index is 1, and the largest class index is calculated by max(c(ens,obs))
</p>


<h3>Value</h3>

<p>numeric vector of length N with the ensemble-adjusted quadratic score values
</p>


<h3>See Also</h3>

<p>EnsBrier, EnsRps, EnsCrps, ScoreDiff, SkillScore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
EnsQs(ens.cat, obs.cat, R.new=Inf)
</code></pre>

<hr>
<h2 id='EnsRps'>Calculate the ensemble-adjusted Ranked Probability Score (RPS) for categorical forecasts</h2><span id='topic+EnsRps'></span><span id='topic+FairRps'></span>

<h3>Description</h3>

<p>Calculate the ensemble-adjusted Ranked Probability Score (RPS) for categorical forecasts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EnsRps(ens, obs, R.new = NA, format = c("category", "members"))

FairRps(ens, obs, format = c("category", "members"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EnsRps_+3A_ens">ens</code></td>
<td>
<p>matrix with N rows representing N time instances of categorical ensemble forecasts as follows: If 'format = category' (the default), then ens[t,r] indicates the category that the r-th ensemble member predicts for time t. Note that categories must be positive integers. If 'format = members', then ens[t,k] is the number of ensemble members that predict category k at time t.</p>
</td></tr>
<tr><td><code id="EnsRps_+3A_obs">obs</code></td>
<td>
<p>vector of length N, or matrix with N rows, representing the N observed category as follows: If &lsquo;format = category&rsquo;, obs is a vector and obs[t] is the category observed at time t. If 'format = members', obs is a matrix where obs[t,k] = 1 (and zero otherwise) if category k was observed at time t</p>
</td></tr>
<tr><td><code id="EnsRps_+3A_r.new">R.new</code></td>
<td>
<p>ensemble size for which the scores should be adjusted, defaults to NA (no adjustment)</p>
</td></tr>
<tr><td><code id="EnsRps_+3A_format">format</code></td>
<td>
<p>string, 'category' (default) or 'members' (can be abbreviated). See descriptions of arguments 'ens' and 'obs' for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'FairRps(ens, obs)' returns 'EnsRps(ens, obs, R.new=Inf)'
</p>


<h3>Value</h3>

<p>numeric vector of length N with the ensemble-adjusted RPS values
</p>


<h3>See Also</h3>

<p>EnsBrier, EnsQs, EnsCrps
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
EnsRps(ens.cat, obs.cat, R.new=Inf)
</code></pre>

<hr>
<h2 id='EnsRpsDiff'>Calculate EnsRps Difference (deprecated, use function ScoreDiff instead)</h2><span id='topic+EnsRpsDiff'></span>

<h3>Description</h3>

<p>Calculate EnsRps Difference (deprecated, use function ScoreDiff instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EnsRpsDiff(ens, ens.ref, obs, probs = NA, format = c("category", "members"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EnsRpsDiff_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="EnsRpsDiff_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="EnsRpsDiff_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="EnsRpsDiff_+3A_probs">probs</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="EnsRpsDiff_+3A_format">format</code></td>
<td>
<p>see 'EnsRps'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean EnsRps difference
</p>


<h3>See Also</h3>

<p>ScoreDiff EnsRps
</p>

<hr>
<h2 id='EnsRpss'>Calculate EnsRps Skill Score (deprecated, use function SkillScore instead)</h2><span id='topic+EnsRpss'></span>

<h3>Description</h3>

<p>Calculate EnsRps Skill Score (deprecated, use function SkillScore instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EnsRpss(ens, ens.ref, obs, format = c("category", "members"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EnsRpss_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="EnsRpss_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="EnsRpss_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="EnsRpss_+3A_format">format</code></td>
<td>
<p>see 'EnsRps'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>EnsRps skill score
</p>


<h3>See Also</h3>

<p>SkillScore EnsRps
</p>

<hr>
<h2 id='eurotempforecast'>Seasonal ensemble forecast of European average summer temperature</h2><span id='topic+eurotempforecast'></span><span id='topic+ens'></span><span id='topic+obs'></span><span id='topic+obs.lag'></span><span id='topic+ens.bin'></span><span id='topic+obs.bin'></span><span id='topic+ens.cat'></span><span id='topic+obs.cat'></span>

<h3>Description</h3>

<p>A hindcast dataset of average European (30N,75N,12.5W,42.5E) summer (June/July/August) surface temperatures. Forecasts were initialised in May the same year. Observations and 15-member ensemble forecasts were derived from the publicly available NCEP Reanalysis (Suranjana, 2010) and the NCEP Climate Forecast System Version 2 (Suranjana, 2014), respectively. The data was downloaded through the ECOMS User Data Gateway (Santander Meteorology Group, 2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(eurotempforecast)
</code></pre>


<h3>Format</h3>

<p>Variables contained in the data set:
</p>

<ul>
<li><p> 'obs' average European summer temperature observations 
</p>
</li>
<li><p> 'ens' mean-debiased ensemble forecast data, i.e. mean(ens) == mean(obs)
</p>
</li>
<li><p> 'obs.lag' the observations lagged by one year, same length as 'obs'
</p>
</li>
<li><p> 'obs.bin' binary observations (0 or 1), obs[i] = 1 indicates that the temperature of year i exceeded the temperature of year i-1
</p>
</li>
<li><p> 'ens.bin' binary ensemble forecast (each member is either 0 or 1), ens[i, j] = 1 if the j-th ensemble member in year i exceeded the observed temperature of year i-1
</p>
</li>
<li><p> 'obs.cat' categorical observations. obs.cat[i] is either 1, 2, and 3, indicating that the temperature in year i was lower, similar, higher than temperature in year i-1. Similar is defined as within a half degree interval centered around last years temperature.
</p>
</li>
<li><p> 'ens.cat' categorical ensemble forecast. ens.cat[i, j] is either 1, 2, or 3. The categories are defined as for 'obs.cat'.
</p>
</li></ul>


<h3>References</h3>

<p>Saha, Suranjana, and Coauthors, 2010: The NCEP Climate Forecast System Reanalysis. Bull. Amer. Meteor. Soc., 91, 1015.1057. doi: <a href="https://doi.org/10.1175/2010BAMS3001.1">10.1175/2010BAMS3001.1</a>
Saha, Suranjana and Coauthors, 2014: The NCEP Climate Forecast System Version 2. J. Clim., 27, 2185&ndash;2208, doi: <a href="https://doi.org/10.1175/JCLI-D-12-00823.1">10.1175/JCLI-D-12-00823.1</a>
Santander Meteorology Group (2015). ecomsUDG.Raccess: R interface to the ECOMS User Data Gateway. R package version 4.2-0. <a href="http://meteo.unican.es/trac/wiki/udg/ecoms">http://meteo.unican.es/trac/wiki/udg/ecoms</a>
</p>

<hr>
<h2 id='FairBrierDiff'>Calculate FairBrier Difference (deprecated, use function ScoreDiff instead)</h2><span id='topic+FairBrierDiff'></span>

<h3>Description</h3>

<p>Calculate FairBrier Difference (deprecated, use function ScoreDiff instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FairBrierDiff(ens, ens.ref, obs, tau = NA, probs = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FairBrierDiff_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="FairBrierDiff_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="FairBrierDiff_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="FairBrierDiff_+3A_tau">tau</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="FairBrierDiff_+3A_probs">probs</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean FairBrier difference
</p>


<h3>See Also</h3>

<p>ScoreDiff EnsBrier
</p>

<hr>
<h2 id='FairBrierSs'>Calculate FairBrier Skill Score (deprecated, use function SkillScore instead)</h2><span id='topic+FairBrierSs'></span>

<h3>Description</h3>

<p>Calculate FairBrier Skill Score (deprecated, use function SkillScore instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FairBrierSs(ens, ens.ref, obs, tau = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FairBrierSs_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="FairBrierSs_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="FairBrierSs_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="FairBrierSs_+3A_tau">tau</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>FairBrier skill score
</p>


<h3>See Also</h3>

<p>SkillScore EnsBrier
</p>

<hr>
<h2 id='FairCrpsDiff'>Calculate FairCrps Difference (deprecated, use function ScoreDiff instead)</h2><span id='topic+FairCrpsDiff'></span>

<h3>Description</h3>

<p>Calculate FairCrps Difference (deprecated, use function ScoreDiff instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FairCrpsDiff(ens, ens.ref, obs, probs = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FairCrpsDiff_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="FairCrpsDiff_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="FairCrpsDiff_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="FairCrpsDiff_+3A_probs">probs</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean FairCrps difference
</p>


<h3>See Also</h3>

<p>ScoreDiff EnsCrps
</p>

<hr>
<h2 id='FairCrpss'>Calculate FairCrps Skill Score (deprecated, use function SkillScore instead)</h2><span id='topic+FairCrpss'></span>

<h3>Description</h3>

<p>Calculate FairCrps Skill Score (deprecated, use function SkillScore instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FairCrpss(ens, ens.ref, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FairCrpss_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="FairCrpss_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="FairCrpss_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>FairCrps skill score
</p>


<h3>See Also</h3>

<p>SkillScore EnsCrps
</p>

<hr>
<h2 id='FairRpsDiff'>Calculate FairRps Difference (deprecated, use function ScoreDiff instead)</h2><span id='topic+FairRpsDiff'></span>

<h3>Description</h3>

<p>Calculate FairRps Difference (deprecated, use function ScoreDiff instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FairRpsDiff(ens, ens.ref, obs, probs = NA, format = c("category", "members"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FairRpsDiff_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="FairRpsDiff_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="FairRpsDiff_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="FairRpsDiff_+3A_probs">probs</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="FairRpsDiff_+3A_format">format</code></td>
<td>
<p>see 'EnsRps'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean FairRps difference
</p>


<h3>See Also</h3>

<p>ScoreDiff EnsRps
</p>

<hr>
<h2 id='FairRpss'>Calculate FairRps Skill Score (deprecated, use function SkillScore instead)</h2><span id='topic+FairRpss'></span>

<h3>Description</h3>

<p>Calculate FairRps Skill Score (deprecated, use function SkillScore instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FairRpss(ens, ens.ref, obs, format = c("category", "members"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FairRpss_+3A_ens">ens</code></td>
<td>
<p>the ensemble</p>
</td></tr>
<tr><td><code id="FairRpss_+3A_ens.ref">ens.ref</code></td>
<td>
<p>the reference ensemble</p>
</td></tr>
<tr><td><code id="FairRpss_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="FairRpss_+3A_format">format</code></td>
<td>
<p>see 'EnsRps'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>FairRps skill score
</p>


<h3>See Also</h3>

<p>SkillScore EnsRps
</p>

<hr>
<h2 id='FitAkdParameters'>Fit the 5 parameters used for affine kernel dressing by minimum CRPS estimation.</h2><span id='topic+FitAkdParameters'></span>

<h3>Description</h3>

<p>Fit the 5 parameters used for affine kernel dressing by minimum CRPS estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitAkdParameters(ens, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FitAkdParameters_+3A_ens">ens</code></td>
<td>
<p>a N*R matrix. An archive of R-member ensemble forecasts for N time instances.</p>
</td></tr>
<tr><td><code id="FitAkdParameters_+3A_obs">obs</code></td>
<td>
<p>a vector of length N. The verifying observations corresponding to the N ensemble forecasts.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Affine Kernel Dressing transforms the discrete K-member forecast ensemble at time instance n, 'ens[n, ]', to a continuous distribution function for the target 'y' by the equation:
</p>
<p>p(y|ens) = 1 / K * sum dnorm(y, z.i, s) <br />
where   s = (4/3/K)^0.4 * (s1 + s2 * a^2 * var(ens)) <br />
and   z.i = r1 + r2 * mean(ens) + a * ens
</p>
<p>The parameters r1, r2, a, s1, s2 are fitted by minimizing the continuously ranked probability score (CRPS). The optimization is carried out using the R function 'optim(...)'.
</p>
<p>Since the evaluation of the CRPS is numerically expensive, the optimization can take a long time. Speed can be increased by optimizing the parameters only for a part of the forecast instances.
</p>


<h3>Value</h3>

<p>The function returns a list of 5 parameters for affine kernel dressing.
</p>


<h3>References</h3>

<p>Broecker J. and Smith L. (2008). From ensemble forecasts to predictive distribution functions. Tellus (2008), 60A, 663&ndash;678. doi: <a href="https://doi.org/10.1111/j.1600-0870.2008.00333.x">10.1111/j.1600-0870.2008.00333.x</a>.
</p>


<h3>See Also</h3>

<p>DressEnsemble, DressCrps, DressIgn, PlotDressedEns, GetDensity
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
FitAkdParameters(ens, obs)
</code></pre>

<hr>
<h2 id='GaussCrps'>Calculate the Continuous Ranked Probability Score (CRPS) for forecasts issued as Normal distributions</h2><span id='topic+GaussCrps'></span>

<h3>Description</h3>

<p>Calculate the Continuous Ranked Probability Score (CRPS) for forecasts issued as Normal distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GaussCrps(mean, sd, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GaussCrps_+3A_mean">mean</code></td>
<td>
<p>A vector of length N. The forecast means.</p>
</td></tr>
<tr><td><code id="GaussCrps_+3A_sd">sd</code></td>
<td>
<p>A vector of length N. The forecast standard deviations.</p>
</td></tr>
<tr><td><code id="GaussCrps_+3A_obs">obs</code></td>
<td>
<p>A numeric vector of length N of real-valued verifying observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of length N with the CRPS values
</p>


<h3>References</h3>

<p>Gneiting et al (2005). Calibrated Probabilistic Forecasting Using Ensemble Model Output Statistics and Minimum CRPS Estimation. Mon. Wea. Rev. doi: <a href="https://doi.org/10.1175/MWR2904.1">10.1175/MWR2904.1</a>
</p>


<h3>See Also</h3>

<p>EnsCrps, DressCrps, ScoreDiff, SkillScore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
mean &lt;- rowMeans(ens)
sd &lt;- apply(ens, 1, sd)
mean(GaussCrps(mean, sd, obs))
</code></pre>

<hr>
<h2 id='GaussCrpsDiff'>Calculate GaussCrps Difference (deprecated, use function ScoreDiff instead)</h2><span id='topic+GaussCrpsDiff'></span>

<h3>Description</h3>

<p>Calculate GaussCrps Difference (deprecated, use function ScoreDiff instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GaussCrpsDiff(mean, sd, mean.ref, sd.ref, obs, probs = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GaussCrpsDiff_+3A_mean">mean</code></td>
<td>
<p>forecast means</p>
</td></tr>
<tr><td><code id="GaussCrpsDiff_+3A_sd">sd</code></td>
<td>
<p>forecast standard deviations</p>
</td></tr>
<tr><td><code id="GaussCrpsDiff_+3A_mean.ref">mean.ref</code></td>
<td>
<p>reference forecast means</p>
</td></tr>
<tr><td><code id="GaussCrpsDiff_+3A_sd.ref">sd.ref</code></td>
<td>
<p>reference forecast standard deviations</p>
</td></tr>
<tr><td><code id="GaussCrpsDiff_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="GaussCrpsDiff_+3A_probs">probs</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mean GaussCrps difference
</p>


<h3>See Also</h3>

<p>ScoreDiff GaussCrps
</p>

<hr>
<h2 id='GaussCrpss'>Calculate GaussCrps Skill Score (deprecated, use function SkillScore instead)</h2><span id='topic+GaussCrpss'></span>

<h3>Description</h3>

<p>Calculate GaussCrps Skill Score (deprecated, use function SkillScore instead)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GaussCrpss(mean, sd, mean.ref, sd.ref, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GaussCrpss_+3A_mean">mean</code></td>
<td>
<p>forecast means</p>
</td></tr>
<tr><td><code id="GaussCrpss_+3A_sd">sd</code></td>
<td>
<p>forecast standard deviations</p>
</td></tr>
<tr><td><code id="GaussCrpss_+3A_mean.ref">mean.ref</code></td>
<td>
<p>reference forecast means</p>
</td></tr>
<tr><td><code id="GaussCrpss_+3A_sd.ref">sd.ref</code></td>
<td>
<p>reference forecast standard deviations</p>
</td></tr>
<tr><td><code id="GaussCrpss_+3A_obs">obs</code></td>
<td>
<p>the observation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>GaussCrps skill score
</p>


<h3>See Also</h3>

<p>SkillScore GaussCrps
</p>

<hr>
<h2 id='GenerateToyData'>Generate artificial data for ensemble verification using a signal-plus-noise model</h2><span id='topic+GenerateToyData'></span>

<h3>Description</h3>

<p>Generate artificial data for ensemble verification using a signal-plus-noise model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenerateToyData(
  N = 20,
  mu.y = 0,
  s.s = 7,
  s.eps = 6,
  mu.x = 0,
  beta = 0.2,
  s.eta = 8,
  K = 10,
  mu.x.ref = NA,
  beta.ref = NA,
  s.eta.ref = NA,
  K.ref = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GenerateToyData_+3A_n">N</code></td>
<td>
<p>number of forecasts and observations</p>
</td></tr>
<tr><td><code id="GenerateToyData_+3A_mu.y">mu.y</code></td>
<td>
<p>expectation value of the observations</p>
</td></tr>
<tr><td><code id="GenerateToyData_+3A_s.s">s.s</code></td>
<td>
<p>standard deviation of the predictable signal</p>
</td></tr>
<tr><td><code id="GenerateToyData_+3A_s.eps">s.eps</code></td>
<td>
<p>standard deviation of the unpredictable noise</p>
</td></tr>
<tr><td><code id="GenerateToyData_+3A_mu.x">mu.x</code></td>
<td>
<p>expectation value of the ensemble</p>
</td></tr>
<tr><td><code id="GenerateToyData_+3A_beta">beta</code></td>
<td>
<p>weighting parameter of the signal in the ensemble forecasting system</p>
</td></tr>
<tr><td><code id="GenerateToyData_+3A_s.eta">s.eta</code></td>
<td>
<p>average spread of the ensemble</p>
</td></tr>
<tr><td><code id="GenerateToyData_+3A_k">K</code></td>
<td>
<p>number of members of the ensemble</p>
</td></tr>
<tr><td><code id="GenerateToyData_+3A_mu.x.ref">mu.x.ref</code></td>
<td>
<p>expectation value of the reference ensemble</p>
</td></tr>
<tr><td><code id="GenerateToyData_+3A_beta.ref">beta.ref</code></td>
<td>
<p>weighting parameter of the signal in the reference ensemble forecasting system</p>
</td></tr>
<tr><td><code id="GenerateToyData_+3A_s.eta.ref">s.eta.ref</code></td>
<td>
<p>average spread of the reference ensemble</p>
</td></tr>
<tr><td><code id="GenerateToyData_+3A_k.ref">K.ref</code></td>
<td>
<p>number of members of the reference ensemble</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function simulates data from the latent variable model:
</p>
<p>y_t   = mu_y +     s_t    + eps_t
</p>
<p>x_t,r = mu_x + beta * s_t + eta_t,r
</p>
<p>where y_t is the observation at time t, and x_t,r is the r-th ensemble member
at time t. The latent variable s_t is to be understood as the &quot;predictable
signal&quot; that generates correlation between observations and ensemble members.
If all arguments that end in &quot;.ref&quot; are specified, a reference ensemble is
returned to also test comparative verification.
</p>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>obs</dt><dd><p>N-vector of observations</p>
</dd>
<dt>ens</dt><dd><p>N*K matrix of ensemble members</p>
</dd>
<dt>ens.ref</dt><dd><p>N*K.ref matrix of reference ensemble members</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'> l &lt;- GenerateToyData()
 with(l, EnsCrps(ens, obs))
</code></pre>

<hr>
<h2 id='GetDensity'>Calculate density and integrated density function of a dressed ensemble forecast at a matrix of values</h2><span id='topic+GetDensity'></span>

<h3>Description</h3>

<p>Calculate density and integrated density function of a dressed ensemble forecast at a matrix of values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetDensity(dressed.ens, x, integrated = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GetDensity_+3A_dressed.ens">dressed.ens</code></td>
<td>
<p>A list returned by the function 'DressEnsemble'. See '?DressEnsemble' for details.</p>
</td></tr>
<tr><td><code id="GetDensity_+3A_x">x</code></td>
<td>
<p>A matrix with either 1 row or nrow(dressed.ens[[&quot;ens&quot;]]) rows and an arbitrary number of columns, holding the arguments at which the forecast distributions are to be evaluated. See Details.</p>
</td></tr>
<tr><td><code id="GetDensity_+3A_integrated">integrated</code></td>
<td>
<p>logical, (default=FALSE): If 'integrated' is TRUE, the integrated density (i.e. the value of the cumulative distribution function) is returned, otherwise the value of the density is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you want to evaluate each forecast distribution function at the same x-values, a matrix with one row can be provided, e.g. 'x = matrix(c(-1, 0, 1), nrow=1)'
</p>
<p>If the N individual forecast distributions are to be evaluated at different x-values, a matrix with N rows must be provided, where N is the number of time instances. 
</p>
<p>To calculate the PIT values for the dressed ensemble and observations 'obs', use 'GetDensity(dressed.ens, x = matrix(obs, ncol=1), integrated=TRUE)'
</p>


<h3>Value</h3>

<p>The function returns a matrix, whose rows correspond to the individual ensemble forecasts and whose columns correspond to the values provided by the argument 'x'.
</p>


<h3>See Also</h3>

<p>DressEnsemble, DressCrps, DressIgn, PlotDressedEns, FitAkdParameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(eurotempforecast)
 dressed.ens &lt;- DressEnsemble(ens)
 # calculate each density at the same x-values
 x1 &lt;- matrix(seq(-3, 3, 0.1), nrow=1)
 dens1 &lt;- GetDensity(dressed.ens, x1)
 # get the densities that the forecast 
 # distributions assign to the observations
 x2 &lt;- matrix(obs, ncol=1)
 dens2 &lt;- GetDensity(dressed.ens, x2)
 # get the integrated densities that the forecast 
 # distributions assign to the observations (useful
 # for constructing a PIT histogram)
 pit &lt;- GetDensity(dressed.ens, x2, integrated=TRUE)
</code></pre>

<hr>
<h2 id='PlotDressedEns'>Plot a series forecast distributions of dressed ensembles</h2><span id='topic+PlotDressedEns'></span>

<h3>Description</h3>

<p>Plot a series forecast distributions of dressed ensembles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotDressedEns(
  dressed.ens,
  add = FALSE,
  obs = NULL,
  plot.ens = FALSE,
  plot.ker = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotDressedEns_+3A_dressed.ens">dressed.ens</code></td>
<td>
<p>An object of class 'dressed.ens'. See ?DressEnsemble for details.</p>
</td></tr>
<tr><td><code id="PlotDressedEns_+3A_add">add</code></td>
<td>
<p>logical, default=FALSE. If TRUE, no new plotting device is created and everything is added to an existing device.</p>
</td></tr>
<tr><td><code id="PlotDressedEns_+3A_obs">obs</code></td>
<td>
<p>A vector of length N, default=NULL. The verifying observations corresponding to the individual ensemble forecasts. If a vector of length N is provided (N = nrow(dressed.ens[[&quot;ens&quot;]]), the values are added to the plot as markers.</p>
</td></tr>
<tr><td><code id="PlotDressedEns_+3A_plot.ens">plot.ens</code></td>
<td>
<p>logical, default=FALSE. If TRUE, the centers of the individual dressing kernels are indicated by markers.</p>
</td></tr>
<tr><td><code id="PlotDressedEns_+3A_plot.ker">plot.ker</code></td>
<td>
<p>logical, default=FALSE. If TRUE, the individual dressing kernels are plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>


<h3>See Also</h3>

<p>DressEnsemble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
d.ens &lt;- DressEnsemble(ens)
PlotDressedEns(d.ens, add=FALSE, obs=obs, plot.ens=FALSE, plot.ker=TRUE)
</code></pre>

<hr>
<h2 id='PlotRankhist'>Plotting function for rank histograms</h2><span id='topic+PlotRankhist'></span>

<h3>Description</h3>

<p>Plots a rank histogram in different modes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotRankhist(rank.hist, mode = "raw")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotRankhist_+3A_rank.hist">rank.hist</code></td>
<td>
<p>A vector or rank counts.</p>
</td></tr>
<tr><td><code id="PlotRankhist_+3A_mode">mode</code></td>
<td>
<p>Either &quot;raw&quot; (default) or &quot;prob.paper&quot;. Whether to draw the raw rank histogram, or the rank histogram on probability paper. See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plotting modes currently implemented are:
</p>
<p>raw (the default): A simple bar plot of the counts provided by the 'rank.hist' argument.
</p>
<p>prob.paper: The individual counts given by 'rank.hist' are transformed to their cumulative probabilities under the binomial distribution with parameters 'N' and '1/K', where 'N=sum(rank.hist)' and 'K=length(rank.hist)'. This transformation makes possible an assessment of the observed rank counts under the hypothesis of equally likely ranks. The y-axis on the left indicates the cumulative probabilities. The intervals on the right of the plot indicate central 90, 95, and 99 percent _simultaneous_ confidence intervals. That is, if all ranks were equally likely on average, approximately 90 percent of all rank histograms would be _completely_ contained in the 90 percent interval and approximately 10 percent of all rank histograms would have _at least_ one bar that falls outside this interval.
</p>


<h3>References</h3>

<p>Anderson J.L. (1996). A Method for Producing and Evaluating Probabilistic Forecasts from Ensemble Model Integrations. J. Climate, 9, 1518&ndash;1530.
Broecker J. (2008). On reliability analysis of multi-categorical forecasts. Nonlin. Processes Geophys., 15, 661-673.
</p>


<h3>See Also</h3>

<p>Rankhist, TestRankhist
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
rank.hist &lt;- Rankhist(ens, obs)
PlotRankhist(rank.hist, mode="prob.paper")
</code></pre>

<hr>
<h2 id='Rankhist'>Rank histogram for ensemble forecasts</h2><span id='topic+Rankhist'></span>

<h3>Description</h3>

<p>Calculate the rank histogram for an archive of ensemble forecasts and their corresponding verifying observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rankhist(ens, obs, reduce.bins = 1, handle.na = "na.fail")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Rankhist_+3A_ens">ens</code></td>
<td>
<p>matrix of dimension (N,K). An archive of K-member ensemble forecasts for N time instances.</p>
</td></tr>
<tr><td><code id="Rankhist_+3A_obs">obs</code></td>
<td>
<p>vector of length N. The corresponding verifying observations.</p>
</td></tr>
<tr><td><code id="Rankhist_+3A_reduce.bins">reduce.bins</code></td>
<td>
<p>number of adjacent bins that will be merged into one bin; has to be a divisor of K+1</p>
</td></tr>
<tr><td><code id="Rankhist_+3A_handle.na">handle.na</code></td>
<td>
<p>how should missing values in ensemble and observation data be handled; possible values are 'na.fail' (fails if any data is missing) and 'use.complete' (only uses times where all ensemble members and obs are available); default: 'na.fail'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of length (K+1)/reduce.bins containing the rank counts
</p>


<h3>References</h3>

<p>Anderson J.L. (1996). A Method for Producing and Evaluating Probabilistic Forecasts from Ensemble Model Integrations. J. Climate, 9, 1518&ndash;1530. 
Hammill T.M. (2001). Interpretation of Rank Histograms for Verifying Ensemble Forecasts. Mon. Wea. Rev., 129, 550&ndash;560.
</p>


<h3>See Also</h3>

<p>PlotRankhist, TestRankhist
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
rh &lt;- Rankhist(ens, obs)
</code></pre>

<hr>
<h2 id='ReliabilityDiagram'>Reliability diagram for probability forecasts</h2><span id='topic+ReliabilityDiagram'></span>

<h3>Description</h3>

<p>Reliability diagram for probability forecasts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ReliabilityDiagram(
  probs,
  obs,
  bins = 10,
  nboot = 500,
  plot = FALSE,
  plot.refin = TRUE,
  cons.probs = 0.95,
  attributes = FALSE,
  handle.na = c("na.fail", "use.pairwise.complete")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ReliabilityDiagram_+3A_probs">probs</code></td>
<td>
<p>vector of N probability forecasts for the event obs=1</p>
</td></tr>
<tr><td><code id="ReliabilityDiagram_+3A_obs">obs</code></td>
<td>
<p>vector of N binary observations, event/no event are coded as 0/1</p>
</td></tr>
<tr><td><code id="ReliabilityDiagram_+3A_bins">bins</code></td>
<td>
<p>binning to estimate the calibration function (see Details), default: 10</p>
</td></tr>
<tr><td><code id="ReliabilityDiagram_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrap resamples to calculate the consistency bars, default: 500</p>
</td></tr>
<tr><td><code id="ReliabilityDiagram_+3A_plot">plot</code></td>
<td>
<p>logical, whether to plot the reliability diagram, default: FALSE</p>
</td></tr>
<tr><td><code id="ReliabilityDiagram_+3A_plot.refin">plot.refin</code></td>
<td>
<p>Whether to add the frequency distribution of the forecasts to the reliability diagram. default: TRUE</p>
</td></tr>
<tr><td><code id="ReliabilityDiagram_+3A_cons.probs">cons.probs</code></td>
<td>
<p>The width of the consitency intervals. default: 0.95. Set to NA for no consistency bars.</p>
</td></tr>
<tr><td><code id="ReliabilityDiagram_+3A_attributes">attributes</code></td>
<td>
<p>locical, whether attributes lines are included in the diagram. default: FALSE</p>
</td></tr>
<tr><td><code id="ReliabilityDiagram_+3A_handle.na">handle.na</code></td>
<td>
<p>how should missing values be handled; possible values are 'na.fail' and 'use.pairwise.complete'; default: 'na.fail'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To estimate the reliability curve, the unit line is categorised into discrete bins, provided by the 'bins' argument. If 'bins' is a single number, it specifies the number of equidistant bins. If 'bins' is a vector of values between zero and one, these values are used as the bin-breaks.
</p>


<h3>Value</h3>

<p>a data.frame with nrows equal to the number of bins (given by the 'bins' argument), with columns: average forecast probability per bin, conditional event frequency per bin, lower and upper limit of the consistency bar per bin, number of forecast probabilities per bin, lower and upper bin limit
</p>


<h3>References</h3>

<p>Jolliffe IT, Stephenson DB, eds. (2012): Forecast verification: A practitioner's guide in atmospheric science. John Wiley &amp; Sons, 2012. ISBN: 978-0-470-66071-3
Broecker J, Smith LA (2007): Increasing the Reliability of Reliability Diagrams. Wea. Forecasting, 22, 651&ndash;661 doi: <a href="https://doi.org/10.1175/WAF993.1">10.1175/WAF993.1</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
p &lt;- rowMeans(ens.bin)
ReliabilityDiagram(p, obs.bin, plot=TRUE)
</code></pre>

<hr>
<h2 id='ScoreDiff'>Calculate average score difference and assess uncertainty</h2><span id='topic+ScoreDiff'></span>

<h3>Description</h3>

<p>Calculate the difference (mean score of the reference forecast) minus (mean score of the forecast). Uncertainty is assessed by the Diebold-Mariano test for equality of predictive accuracy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ScoreDiff(
  scores,
  scores.ref,
  N.eff = NA,
  conf.level = 0.95,
  handle.na = "na.fail"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ScoreDiff_+3A_scores">scores</code></td>
<td>
<p>vector of verification scores</p>
</td></tr>
<tr><td><code id="ScoreDiff_+3A_scores.ref">scores.ref</code></td>
<td>
<p>vector of verification scores of the reference forecast, must be of the same length as 'scores'</p>
</td></tr>
<tr><td><code id="ScoreDiff_+3A_n.eff">N.eff</code></td>
<td>
<p>user-defined effective sample size to be used in hypothesis test and for confidence bounds; if NA, the length of 'scores' is used; default: NA</p>
</td></tr>
<tr><td><code id="ScoreDiff_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for the confidence interval; default = 0.95</p>
</td></tr>
<tr><td><code id="ScoreDiff_+3A_handle.na">handle.na</code></td>
<td>
<p>how should missing values in scores vectors be handled; possible values are 'na.fail' and 'use.pairwise.complete'; default: 'na.fail'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with mean score difference, estimated standard error of the mean, one-sided p-value of the Diebold-Mariano test, and the user-specified confidence interval
</p>


<h3>References</h3>

<p>Diebold, Mariano (1995): Comparing Predictive Accuracy. Journal of Business &amp; Economic Statistics. <a href="https://www.jstor.org/stable/1392185">https://www.jstor.org/stable/1392185</a>
</p>


<h3>See Also</h3>

<p>SkillScore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
ScoreDiff(EnsCrps(ens, obs), EnsCrps(ens[, 1:2], obs))
</code></pre>

<hr>
<h2 id='SkillScore'>Calculate a skill score and assess uncertainty.</h2><span id='topic+SkillScore'></span>

<h3>Description</h3>

<p>A skill score is defined as (mean score - mean reference score) / (perfect score - mean reference score). The skill score is zero if the mean score of the forecast equals the mean score of the reference forecast, and equals one if the mean score of the forecast equals the best possible score. Uncertainty is assessed by estimating the standard deviation of the skill score by propagation of uncertainty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SkillScore(
  scores,
  scores.ref,
  N.eff = NA,
  score.perf = 0,
  handle.na = c("na.fail", "use.pairwise.complete")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SkillScore_+3A_scores">scores</code></td>
<td>
<p>vector of verification scores</p>
</td></tr>
<tr><td><code id="SkillScore_+3A_scores.ref">scores.ref</code></td>
<td>
<p>vector of verification scores of the reference forecast, must be of the same length as 'scores'</p>
</td></tr>
<tr><td><code id="SkillScore_+3A_n.eff">N.eff</code></td>
<td>
<p>user-defined effective sample size to be used to estimate the sampling uncertainty; if NA, the length of 'scores' is used; default: NA</p>
</td></tr>
<tr><td><code id="SkillScore_+3A_score.perf">score.perf</code></td>
<td>
<p>a numeric constant, indicating the value that the score would assign to the perfect forecast</p>
</td></tr>
<tr><td><code id="SkillScore_+3A_handle.na">handle.na</code></td>
<td>
<p>how should missing values in scores vectors be handled; possible values are 'na.fail' and 'use.pairwise.complete'; default: 'na.fail'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with skill score and its estimated standard deviation
</p>


<h3>See Also</h3>

<p>ScoreDiff
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
SkillScore(EnsCrps(ens, obs), EnsCrps(ens[, 1:2], obs))
</code></pre>

<hr>
<h2 id='SpecsVerification'>SpecsVerification - Forecast verification routines</h2><span id='topic+SpecsVerification'></span>

<h3>Description</h3>

<p>SpecsVerification - Forecast verification routines
</p>


<h3>Author(s)</h3>

<p>: Stefan Siegert
</p>

<hr>
<h2 id='SqErr'>Calculate the squared error between forecast and observation</h2><span id='topic+SqErr'></span>

<h3>Description</h3>

<p>Calculate the squared error between forecast and observation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SqErr(fcst, obs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SqErr_+3A_fcst">fcst</code></td>
<td>
<p>a N-vector representing N time instances of real-valued forecasts</p>
</td></tr>
<tr><td><code id="SqErr_+3A_obs">obs</code></td>
<td>
<p>a N-vector representing N time instances of real-valued observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric N-vector of squared errors
</p>


<h3>See Also</h3>

<p>AbsErr, ScoreDiff, SkillScore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
mean(SqErr(rowMeans(ens), obs))
</code></pre>

<hr>
<h2 id='TestRankhist'>Statistical tests for rank histograms</h2><span id='topic+TestRankhist'></span>

<h3>Description</h3>

<p>Perform statistical tests related to the deviation from flatness of a rank histogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TestRankhist(rank.hist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TestRankhist_+3A_rank.hist">rank.hist</code></td>
<td>
<p>Vector of rank counts. Generated by function 'Rankhist()'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a vector of rank counts 'x', the Pearson Chi^2 statistic is calculated by
</p>
<p>sum((x - sum(x)/length(x))^2 / (sum(x)/length(x)))
</p>
<p>and has a chi^2 distribution with (length(x)-1) degrees of freedom if every rank is equally likely on average.
The Jolliffe-Primo test statistics are calculated by projecting the vector
</p>
<p>(x-sum(x)/length(x)) / sqrt(sum(x)/length(x))
</p>
<p>onto a linear, respectively squared contrast, i.e. a linear and quadratic function defined over the index set 1:length(x), who are mutually orthogonal, whose elements sum to zero, and whose squared elements sum to one. The projections independently have chi^2 distributions with 1 degree of freedom under the null hypothesis of a flat rank histogram.
</p>


<h3>Value</h3>

<p>A dataframe whose columns refer to the Pearson Chi^2 statistic, the Jolliffe-Primo test statistic for slope, and the Jolliffe-Primo test statistic for convexity. The rows refer to the actual test statistic and its p-value under the null hypothesis of a flat rank histogram.
</p>


<h3>References</h3>

<p>Pearson K. (1900): X. On the criterion that a given system of deviations from the probable in the case of a correlated system of variables is such that it can be reasonably supposed to have arisen from random sampling.  Phil. Mag. Series 5, 50(302) doi: <a href="https://doi.org/10.1080/14786440009463897">10.1080/14786440009463897</a>
</p>
<p>Jolliffe I.T., Primo C. (2008): Evaluating rank histograms using decompositions of the chi-square test statistic. Mon. Wea. Rev. 136(6) doi: <a href="https://doi.org/10.1175/2007MWR2219.1">10.1175/2007MWR2219.1</a>
</p>


<h3>See Also</h3>

<p>Rankhist, PlotRankhist
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eurotempforecast)
rh &lt;- Rankhist(ens, obs)
TestRankhist(rh)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
