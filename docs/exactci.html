<!DOCTYPE html><html><head><title>Help for package exactci</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {exactci}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#binom.exact'><p>Exact tests with matching confidence intervals for single binomial parameter</p></a></li>
<li><a href='#binomControl'><p>Tuning parameters for binom.exact function</p></a></li>
<li><a href='#exactbinomPlot'><p> Plot p-value function for one binomial response.</p></a></li>
<li><a href='#exactci-internal'>
<p>Internal functions, not to be called directly</p></a></li>
<li><a href='#exactci-package'>
<p>Exact binomial and Poisson tests with Matching Confidence Intervals</p></a></li>
<li><a href='#exactpoissonPlot'><p> Plot p-value function for single or pair of poisson responses.</p></a></li>
<li><a href='#poisson.exact'><p>Exact Poisson tests with Matching Confidence Intervals</p></a></li>
<li><a href='#powerBinom'>
<p>Exact Power and Sample Size methods for Bernoulli responses</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Exact P-Values and Matching Confidence Intervals for Simple
Discrete Parametric Cases</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael P. Fay</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael P. Fay &lt;mfay@niaid.nih.gov&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>stats, ssanv, testthat</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, BlakerCI, knitr, exact2x2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates exact tests and confidence intervals for one-sample binomial and one- or two-sample Poisson cases (see Fay (2010) &lt;<a href="https://doi.org/10.32614%2Frj-2010-008">doi:10.32614/rj-2010-008</a>&gt;). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-24 13:53:57 UTC; faym</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-24 14:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='binom.exact'>Exact tests with matching confidence intervals for single binomial parameter</h2><span id='topic+binom.exact'></span>

<h3>Description</h3>

<p>Calculates exact p-values and confidence intervals for a single binomial parmeter. 
This is different from <code><a href="stats.html#topic+binom.test">binom.test</a></code> only when alternative='two.sided', in which 
case <code>binom.exact</code> gives three choices for tests based on the 'tsmethod' option. 
The resulting p-values and confidence intervals will match.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.exact(x, n, p = 0.5, 
   alternative = c("two.sided", "less", "greater"), 
   tsmethod = c("central", "minlike", "blaker"), 
   conf.level = 0.95, 
   control=binomControl(),plot=FALSE, midp=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.exact_+3A_x">x</code></td>
<td>
<p>number of successes, or a vector of length 2 giving the
numbers of successes and failures, respectively.
</p>
</td></tr>
<tr><td><code id="binom.exact_+3A_n">n</code></td>
<td>

<p>number of trials, ignored if x has length 2.
</p>
</td></tr>
<tr><td><code id="binom.exact_+3A_p">p</code></td>
<td>

<p>hypothesized probability of success.
</p>
</td></tr>
<tr><td><code id="binom.exact_+3A_alternative">alternative</code></td>
<td>

<p>indicates the alternative hypothesis and must be one of
&quot;two.sided&quot;, &quot;greater&quot; or &quot;less&quot;.  You can
specify just the initial letter.
</p>
</td></tr>
<tr><td><code id="binom.exact_+3A_tsmethod">tsmethod</code></td>
<td>

<p>indicates the method for a two-sided alternative hypothesis
and must be one of
&quot;minlike&quot;, &quot;central&quot; or &quot;blaker&quot;.  You can
specify just the initial letter.
</p>
</td></tr>
<tr><td><code id="binom.exact_+3A_conf.level">conf.level</code></td>
<td>

<p>confidence level for the returned confidence interval.
</p>
</td></tr>
<tr><td><code id="binom.exact_+3A_control">control</code></td>
<td>

<p>list with settings to avoid problems with ties, etc, should not need to change this for normal use, 
see <code><a href="#topic+binomControl">binomControl</a></code> 
</p>
</td></tr>
<tr><td><code id="binom.exact_+3A_plot">plot</code></td>
<td>
<p>logical, do basic plot of p-value function by null hypothesis value, see <code><a href="#topic+exactbinomPlot">exactbinomPlot</a></code> for more plot options
</p>
</td></tr>
<tr><td><code id="binom.exact_+3A_midp">midp</code></td>
<td>
<p>logical, use mid-p for p-values and confidence intervals? midp Confidence intervals are not available for tsmethod='minlike' and 'blaker'</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Traditionally, hypothesis tests and confidence intervals are treated separately.
A more unified approach suggested by Hirji (2006) is to use the same p-value 
function to create confidence intervals. There is essentially only one way to 
calculate one-sided p-values and confidence intervals so these methods are the same 
in <code><a href="stats.html#topic+binom.test">binom.test</a></code> and <code>binom.exact</code>. However,  
there are three main ways that 
<code>binom.exact</code> allows for defining two-sided p-values.
</p>

<table>
<tr>
 <td style="text-align: left;">
minlike: </td><td style="text-align: left;"> sum probabilities of all likelihoods equal or less than observed </td>
</tr>
<tr>
 <td style="text-align: left;">
central: </td><td style="text-align: left;"> double minimum one-sided p-value </td>
</tr>
<tr>
 <td style="text-align: left;">
blaker: </td><td style="text-align: left;"> combine smaller observed tail probability with opposite tail not greater than observed tail </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
 
<p>The 'minlike' method is the p-value that has been used in <code><a href="stats.html#topic+binom.test">binom.test</a></code>,
and 'blaker' is described in Blaker (2000) or Hirji (2006), where it is called the 
'combined tails' method. 
Once the p-value function is defined we can invert the test to create 'matching' 
confidence intervals defined as the smallest interval that contains all parameter values for which the two-sided
hypothesis test does not reject. There are some calculation issues for the 
'minlike' and 'blaker' methods which are the same as for exact tests 
for 2x2 tables (see Fay, 2010).
</p>
<p>All of the above traditional p-values can be thought of as estimating Pr[X=xobs or X is more extreme than xobs] under the null hypothesis, where more extreme is defined differently for different methods. The mid-p-value replaces this with 0.5*Pr[X=xobs]+ Pr[X is more extreme than xobs]. The mid-p p-values are not valid. In other words, for all parameter values under the null hypothesis we are not guaranteed to bound the type I error rate. However, the usual exact methods that guarantee the type I error rate are typically conservative for most parameter values in order to bound the type I error rate for all parameter values. So if you are interested in rejecting approximately on average about 5 percent of the time for arbitrary parameter values and n values under the null hypothesis, then use midp=TRUE. If you want to ensure bounding of the type I errror rate for all n and all parameter values use midp=FALSE. (See for example, Vollset, 1993, or Hirji, 2006). 
</p>
<p>The associated midp confidence intervals have not been programmed for tsmethod='blaker' and 'minlike'. 
</p>


<h3>Value</h3>

<p>An object of class 'htest': a list with items
</p>
<table>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p> confidence interval, see attributes 'conf.level' and perhaps 'conf.limit.prec' </p>
</td></tr>
<tr><td><code>statistic</code></td>
<td>
<p> number of successes</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>number of trials</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>observed proportion of success</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>null hypothesis probability of success, 'p'</p>
</td></tr> 
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing alternative hypothesis</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a character string  describing method</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the names of the data</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The 'central' method gives the Clopper-Pearson intervals, and the 'minlike'
method gives confidence intervals proposed by Stern (1954) (see Blaker, 2000).
The 'blaker' method is guaranteed to be more powerful than the 
'central' method (see Blaker, 2000, Corollary 1), 
but both the 'blaker' method and 'minlike' method may have 
some undesireable properties. For example, there are cases where adding an 
additional  Bernoulli observation REGARDLESS OF THE RESPONSE will increase the p-value,
see Vos and Hudson (2008). The 'central' method does not have 
those undesireable properties.
</p>
<p>The Blyth-Still-Casella intervals  given in StatXact (and not by <code>binom.exact</code>) are the shortest possible 
intervals, but those intervals are not nested. This means that the Blyth-Still-Casella 
intervals are not guaranteed 
to have the 95 percent interval contain the 90 percent interval. See Blaker (2000) Theorem 2.   
</p>


<h3>Author(s)</h3>

<p>M.P. Fay
</p>


<h3>References</h3>

<p>Blaker, H. (2000) Confidence curves and improved exact confidence intervals for discrete distributions.
Canadian Journal of Statistics 28: 783-798.
</p>
<p>Fay, M. P. (2010). Confidence intervals that Match Fisher's exact and Blaker's exact tests.
Biostatistics. 11:373-374.
</p>
<p>Fay, M.P. (2010). Two-sided Exact Tests and Matching Confidence Intervals for Discrete Data. R Journal 2(1): 53-58.
</p>
<p>Hirji K. F. (2006). Exact analysis of discrete data. Chapman and Hall/CRC. New York.
</p>
<p>Stern, T (1954). Some remarks on confidence and fiducial limits.
Biometrika, 275-278.
</p>
<p>Vollset, S. E. (1993). Confidence intervals for a binomial proportion. Statistics in medicine, 12(9), 809-824.
</p>
<p>Vos, P.W. and Hudson, S. (2008). Problems with binomial two-sided tests and the associated
confidence interals. Aust. N.Z. J. Stat. 50: 81-89.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+binom.test">binom.test</a></code>, for two-sample exact binomial tests see <code><a href="exact2x2.html#topic+exact2x2">exact2x2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Notice how binom.test p-value is given by tsmethod='minlike'
## but the confidence interval is given by tsmethod='central'
## in binom.exact p-values and confidence intervals match
binom.test(10,12,p=20000/37877)
binom.exact(10,12,p=20000/37877,tsmethod="minlike")
binom.exact(10,12,p=20000/37877,tsmethod="central")
binom.exact(10,12,p=20000/37877,tsmethod="blaker")
## one-sided methods are also available
## as in binom.test

</code></pre>

<hr>
<h2 id='binomControl'>Tuning parameters for binom.exact function</h2><span id='topic+binomControl'></span>

<h3>Description</h3>

<p>This function produces a list of tuning parameters used in the calculations done by <code><a href="#topic+binom.exact">binom.exact</a></code>
and <code><a href="#topic+poisson.exact">poisson.exact</a></code>. These will not need to be changed by most ordinary users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binomControl(relErr=1+1e-07,tol=.00001,
    pRange=c(1e-10,1-1e-10),
    minn=1, maxn=10^4, 
    PRINT.STEPS=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binomControl_+3A_relerr">relErr</code></td>
<td>

<p>value very close to 1, used in calculation of two-sided p-values
</p>
</td></tr>
<tr><td><code id="binomControl_+3A_tol">tol</code></td>
<td>

<p>value very close to 0, used in calculation of two-sided confidence intervals
</p>
</td></tr>
<tr><td><code id="binomControl_+3A_prange">pRange</code></td>
<td>

<p>range close to [0,1], but excluding the endpoints, used in calculation of two-sided confidence intervals
</p>
</td></tr>
<tr><td><code id="binomControl_+3A_minn">minn</code></td>
<td>

<p>minimum n used by powerBinom. The search for the lowest n that gives power is crude and goes from minn to maxn by ones.
</p>
</td></tr>
<tr><td><code id="binomControl_+3A_maxn">maxn</code></td>
<td>

<p>maximum n used by powerBinom
</p>
</td></tr>
<tr><td><code id="binomControl_+3A_print.steps">PRINT.STEPS</code></td>
<td>

<p>logical, print steps of uniroot.integer used to find the n when type='cilength' in powerBinom?
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the code for <code>fisher.test</code>, where the term <code>relErr</code> is hard-coded into the function. The purpose 
is to avoid problems with ties. It serves the same purpose in this package and probably need not be changed.
The value <code>tol</code> indicates the tolerance for the precision of the confidence limits.
The value <code>pRange</code> is input into <code>uniroot</code> to give bounds when searching for confidence limits. For poisson 
limits <code>pRange</code> is transformed using the <code>qgamma</code> function (see code in <code>exactpoissonCI</code>).
</p>


<h3>Value</h3>

<p>A list with containing the following components:
</p>
<table>
<tr><td><code>relErr</code></td>
<td>
<p>a number larger than 1</p>
</td></tr>
<tr><td><code>tol</code></td>
<td>
<p>a number greater than 0</p>
</td></tr>
<tr><td><code>pRange</code></td>
<td>
<p>a vector with 2 elements between 0 and 1, exclusive</p>
</td></tr>
</table>

<hr>
<h2 id='exactbinomPlot'> Plot p-value function for one binomial response.
</h2><span id='topic+exactbinomPlot'></span>

<h3>Description</h3>

<p>Plots p-values as a function of different point null hypothesis values for p. 
For two-sided p-values, can plot three types of p-values: the minimum likelihood method (default for binom.test), the central 
method (i.e., twice the one-sided exact p-values), and Blaker's exact.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exactbinomPlot(x, n, p = NULL, ndiv = 1000, 
    tsmethod = "central", pRange = c(0, 1), 
    dolines = FALSE, dopoints = TRUE, doci=TRUE, 
    alternative=c("two.sided","less","greater"),
    relErr=1+10^(-7), conf.level=.95, alphaline=TRUE, 
    newplot = TRUE, midp=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exactbinomPlot_+3A_x">x</code></td>
<td>
<p>number of successes, or a vector of length 2 giving the numbers of successes and failures, respectively</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_n">n</code></td>
<td>
<p>number of trials, ignored if x has length 2</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_p">p</code></td>
<td>
<p>null values of p for plot, if NULL divides pRange into ndiv pieces</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_ndiv">ndiv</code></td>
<td>
<p>number of pieces to divide up range of x-axis</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_tsmethod">tsmethod</code></td>
<td>
<p>two-sided method for p-value calculation, either &quot;minlike&quot;,&quot;blaker&quot; or &quot;central&quot;</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_prange">pRange</code></td>
<td>
<p>range for plotting null hypothesis values of p</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_dolines">dolines</code></td>
<td>
<p>logical, add lines to a plot?</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_dopoints">dopoints</code></td>
<td>
<p>logical, add points to a plot?</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_doci">doci</code></td>
<td>
<p>logical, add lines for confidence interval?</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_alternative">alternative</code></td>
<td>
<p>type of alternative for p-values</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_relerr">relErr</code></td>
<td>
<p>number close to 1, avoids problems with ties, see <code><a href="#topic+binomControl">binomControl</a></code> </p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for use when doci=TRUE</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_alphaline">alphaline</code></td>
<td>
<p>logical, if doci=TRUE should a line be drawn at significance level</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_newplot">newplot</code></td>
<td>
<p>logical,start a new plot?</p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_midp">midp</code></td>
<td>
<p>logical, use mid-pvalues? See <code>link{binom.exact}</code> </p>
</td></tr>
<tr><td><code id="exactbinomPlot_+3A_...">...</code></td>
<td>
<p>values passed to plot, points, or lines statement</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+binom.exact">binom.exact</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## plot central two-sided p-values (double one-sided p-values)
## for 5 positive responses out of 17 tries
exactbinomPlot(5,17)
## add blakers exact p-values
## pch option acts on points, lty acts on ci lines
exactbinomPlot(5,17,tsmethod="blaker",col="blue",pch=".",lty=2,newplot=FALSE)

## can plot one-sided p-values, tsmethod is ignored
exactbinomPlot(5,17,alternative="less")

</code></pre>

<hr>
<h2 id='exactci-internal'>
Internal functions, not to be called directly
</h2><span id='topic+exactci-internal'></span><span id='topic+exactpoissonPval'></span><span id='topic+exactpoissonPvals'></span><span id='topic+exactbinomCI'></span><span id='topic+exactpoissonCI'></span><span id='topic+exactbinomPvals'></span>

<h3>Description</h3>

<p>These functions give p-values for exact binomial or poisson test. Not to be called directly, use <code><a href="#topic+binom.exact">binom.exact</a></code> or 
<code><a href="#topic+poisson.exact">poisson.exact</a></code></p>


<h3>Usage</h3>

<pre><code class='language-R'>exactbinomPvals(x, n, p, relErr = 1 + 10^(-7), tsmethod = "minlike",midp=FALSE)
exactpoissonPval(x,T=1,r=1,relErr=1+1e-07,tsmethod="central")
exactpoissonPvals(x,T=1,r=1,relErr=1+1e-07,tsmethod="central")
exactbinomCI(x, n, tsmethod="minlike",conf.level=.95,tol=.00001,
    pRange=c(1e-10,1-1e-10))
exactpoissonCI(x, tsmethod="minlike",conf.level=.95,tol=.00001,
    pRange=c(1e-10,1-1e-10))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exactci-internal_+3A_x">x</code></td>
<td>
<p>number of successes or counts, vectors not allowed</p>
</td></tr>
<tr><td><code id="exactci-internal_+3A_n">n</code></td>
<td>
<p>number at risk, vectors not allowed</p>
</td></tr>
<tr><td><code id="exactci-internal_+3A_p">p</code></td>
<td>
<p>binomial parameter for null hypothesis, may be vector</p>
</td></tr>
<tr><td><code id="exactci-internal_+3A_relerr">relErr</code></td>
<td>
<p>used in calculation to avoid ties, slightly bigger than 1</p>
</td></tr>
<tr><td><code id="exactci-internal_+3A_tsmethod">tsmethod</code></td>
<td>
<p>two-sided method, one of &quot;minlike&quot;, &quot;blaker&quot; (&quot;central&quot; only allowed for  <code>exactpoissonPval</code> or <code>exactpoissonPvals</code>) </p>
</td></tr>
<tr><td><code id="exactci-internal_+3A_t">T</code></td>
<td>
<p>number at risk or person-years at risk, vectors not allowed</p>
</td></tr>
<tr><td><code id="exactci-internal_+3A_r">r</code></td>
<td>
<p>rate parameter for null hypothesis, null is E(x*T)=r, vectors only allowed for <code>exactpoissonPvals</code></p>
</td></tr>
<tr><td><code id="exactci-internal_+3A_conf.level">conf.level</code></td>
<td>
<p>number between 0 and 1 for level of confidence interval</p>
</td></tr>
<tr><td><code id="exactci-internal_+3A_prange">pRange</code></td>
<td>
<p>range to search for confidence intervals, between 0 and 1 (even for poisson where it is transformed to a 0 to Inf-like range)</p>
</td></tr>
<tr><td><code id="exactci-internal_+3A_tol">tol</code></td>
<td>
<p>tolerance for precision of confidence interval, very small number</p>
</td></tr>
<tr><td><code id="exactci-internal_+3A_midp">midp</code></td>
<td>
<p>logical, use mid-p for p-values?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>exactbinomPvals</code> tests point null hypotheses for a single binomial observation.
The function <code>exactpoissonPvals</code> tests point null hypotheses for a single Poisson observation. To get p-values for the two-sample 
Poisson test save results from <code>exactpoissonPlot</code>. 
The functions <code>exactbinomCI</code> and <code>exactpoissonCI</code> calculate the &quot;minlike&quot; and &quot;blaker&quot; confidence intervals.
</p>


<h3>Value</h3>

<p> Returns either a confidence interval with attributes giving precision, or a pvalue (exactpoissonPval), 
or a list with pvals and parameters (r,T for poisson and p for binomial).</p>


<h3>See Also</h3>

 <p><code><a href="#topic+poisson.exact">poisson.exact</a></code> and <code><a href="#topic+binom.exact">binom.exact</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>exactbinomPvals(3,10,c(.3,.4,.5),tsmethod="minlike")
</code></pre>

<hr>
<h2 id='exactci-package'>
Exact binomial and Poisson tests with Matching Confidence Intervals
</h2><span id='topic+exactci-package'></span><span id='topic+exactci'></span>

<h3>Description</h3>

<p>Calculates exact binomial and Poisson tests giving matching confidence 
intervals. There are 3 different methods for defining the two-sided 
p-values.  
</p>


<h3>Details</h3>

<p>Although <code><a href="stats.html#topic+binom.test">binom.test</a></code> and <code><a href="stats.html#topic+poisson.test">poisson.test</a></code> give exact 
tests and confidence intervals, for two-sided tests the confidence intervals (CI) are not formed by inverting 
the tests. Thus, there may be test-CI inconsistencies whereby the test rejects 
but the confidence interval contains the null parameter. The <code>exactci</code> package eliminates many of these 
test-CI inconsistencies for  
two-sided tests, by outputing the matching confidence interval with each test.
The package uses one of three different 
methods for defining the two-sided p-value. The main functions of the package 
are <code><a href="#topic+binom.exact">binom.exact</a></code> and <code><a href="#topic+poisson.exact">poisson.exact</a></code> which follow the same format 
as  <code>binom.test</code> and <code>poisson.test</code> except have the option 'tsmethod'
to define the two-sided method for calculating the p-values, and give matching 
confidence intervals (i.e., ones that come from the inversion of the p-values). 
</p>
<p>The package also has options for mid-p values.
</p>


<h3>Author(s)</h3>

<p>Michael P. Fay
</p>
<p>Maintainer: Michael P. Fay &lt;mfay@niaid.nih.gov&gt;
</p>


<h3>References</h3>

<p>Blaker, H. (2000) Confidence curves and improved exact confidence intervals for discrete distributions.
Canadian Journal of Statistics 28: 783-798.
</p>
<p>Fay, M. P. (2010). Confidence intervals that Match Fisher's exact and Blaker's exact tests.
Biostatistics. 11:373-374.
</p>
<p>Fay, M.P. (2010). Two-sided Exact Tests and Matching Confidence Intervals for Discrete Data. R Journal 2(1): 53-58.
</p>
<p>Hirjim K. F. (2006). Exact analysis of discrete data. Chapman and Hall/CRC. New York.
</p>


<h3>See Also</h3>

<p>For comparisons of two binomial groups see <code><a href="exact2x2.html#topic+exact2x2-package">exact2x2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Note binom.test calculates p-values using priciple of minimum likelihood
## while it calculates the central confidence intervals. That is why the 
## inferences do not match in this example.
binom.test(10,12,p=20000/37877)
binom.exact(10,12,p=20000/37877,tsmethod="minlike")
binom.exact(10,12,p=20000/37877,tsmethod="central")
## We also allow the method studied in Blaker (2000)
binom.exact(10,12,p=20000/37877,tsmethod="blaker")
</code></pre>

<hr>
<h2 id='exactpoissonPlot'> Plot p-value function for single or pair of poisson responses.
</h2><span id='topic+exactpoissonPlot'></span>

<h3>Description</h3>

<p>Plots p-values as a function of different point null hypothesis values for rate. 
For two-sided p-values, can plot three types of p-values: the minimum likelihood method (default for poisson.test), the central 
method (i.e., twice the one-sided exact p-values), and Blaker's exact.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exactpoissonPlot(x,
    T=1,
    r=NULL,
    ndiv=1000,
    tsmethod="central",
    rRange=NULL,
    dolog=TRUE,
    dolines=FALSE,
    dopoints=TRUE,
    doci=TRUE, 
    alternative = c("two.sided", "less", "greater"), 
    relErr=1 + 10^(-7), 
    conf.level=.95,
    alphaline=TRUE,
    newplot=TRUE,
    midp=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exactpoissonPlot_+3A_x">x</code></td>
<td>
<p>number of events. A vector of length one or two</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_t">T</code></td>
<td>
<p>time base for event count. A vector of length one or two</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_r">r</code></td>
<td>
<p>null values of rate for plot, if NULL divides rRange into ndiv pieces</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_ndiv">ndiv</code></td>
<td>
<p>number of pieces to divide up range of x-axis</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_tsmethod">tsmethod</code></td>
<td>
<p>two-sided method for p-value calculation, either &quot;minlike&quot;,&quot;blaker&quot; or &quot;central&quot;</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_rrange">rRange</code></td>
<td>
<p>range for plotting null hypothesis values of rate, if null then uses confidence interval to determine range</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_dolog">dolog</code></td>
<td>
<p>logical, plot horizontal axis in log scale?</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_dolines">dolines</code></td>
<td>
<p>logical, add lines to a plot?</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_dopoints">dopoints</code></td>
<td>
<p>logical, add points to a plot?</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_doci">doci</code></td>
<td>
<p>logical, add lines for confidence interval?</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_alternative">alternative</code></td>
<td>
<p>type of alternative for p-values</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_relerr">relErr</code></td>
<td>
<p>number close to 1, avoids problems with ties, see <code><a href="#topic+binomControl">binomControl</a></code> </p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for use when doci=TRUE</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_alphaline">alphaline</code></td>
<td>
<p>logical, if doci=TRUE should line be drawn at significance level</p>
</td></tr> 
<tr><td><code id="exactpoissonPlot_+3A_newplot">newplot</code></td>
<td>
<p>logical,start a new plot?</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_midp">midp</code></td>
<td>
<p>logical, use mid-p for p-values? Not available for tsmethod='blaker' or 'minlike'</p>
</td></tr>
<tr><td><code id="exactpoissonPlot_+3A_...">...</code></td>
<td>
<p>values passed to plot, points, or lines statement</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Does graph or adds lines or points. Returns  (invisibly, see <code><a href="base.html#topic+invisible">invisible</a></code>) a list with elements r (null hypothesis values) and p.value (associated p-values).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.exact">binom.exact</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## single Poisson response
exactpoissonPlot(2,17877)
</code></pre>

<hr>
<h2 id='poisson.exact'>Exact Poisson tests with Matching Confidence Intervals</h2><span id='topic+poisson.exact'></span>

<h3>Description</h3>

<p>Performs an exact test of a simple null hypothesis about the
rate parameter in Poisson distribution, or for the
ratio between two rate parameters. This is different from <code><a href="stats.html#topic+poisson.test">poisson.test</a></code>
in that 3 different types of exact two-sided tests (and the matching confidence intervals)
are offered. The one-sided tests are the same as in <code><a href="stats.html#topic+poisson.test">poisson.test</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson.exact(x, T = 1, r = 1,
    alternative = c("two.sided", "less", "greater"), 
    tsmethod=c("central","minlike","blaker"),
    conf.level = 0.95, control=binomControl(), plot=FALSE,
    midp=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisson.exact_+3A_x">x</code></td>
<td>
<p>number of events. A vector of length one or two.</p>
</td></tr>
<tr><td><code id="poisson.exact_+3A_t">T</code></td>
<td>
<p>time base for event count. A vector of length one or two. </p>
</td></tr>
<tr><td><code id="poisson.exact_+3A_r">r</code></td>
<td>
<p>hypothesized rate or rate ratio</p>
</td></tr>
<tr><td><code id="poisson.exact_+3A_alternative">alternative</code></td>
<td>
<p>indicates the alternative hypothesis and must be
one of <code>"two.sided"</code>, <code>"greater"</code> or <code>"less"</code>.
You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="poisson.exact_+3A_tsmethod">tsmethod</code></td>
<td>
<p>character giving two-sided method, one of &quot;central&quot;, &quot;minlike&quot; or &quot;blaker&quot;, ignored if alternative not equal &quot;two.sided&quot;</p>
</td></tr>
<tr><td><code id="poisson.exact_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level for the returned confidence
interval.</p>
</td></tr>
<tr><td><code id="poisson.exact_+3A_control">control</code></td>
<td>
<p>list with settings to avoid problems with ties, etc, should not need to change this for normal use, 
see <code><a href="#topic+binomControl">binomControl</a></code> </p>
</td></tr>
<tr><td><code id="poisson.exact_+3A_plot">plot</code></td>
<td>
<p>logical, plot p-value function? For finer control on plot see <code><a href="#topic+exactpoissonPlot">exactpoissonPlot</a></code></p>
</td></tr>
<tr><td><code id="poisson.exact_+3A_midp">midp</code></td>
<td>
<p>logical, use mid-p p-values? Only allowed for two-sided tests if tsmethod='central' (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Confidence intervals are computed similarly to those of
<code><a href="#topic+binom.exact">binom.exact</a></code> in the one-sample case, in that there are three two-sided options depending on the 
<code>tsmethod</code>. For the one-sample case the 
default intervals use <code>tsmethod="central"</code> giving the Garwood (1936) exact central confidence intervals.  
For the two-sample case we condition on the total counts and then use binomial methods,
see Lehmann and Romano (2005) for that motivation and <code>vignette("exactci")</code> for description 
of the three different two-sided methods for calculating p-values and confidence intervals.
</p>
<p>Traditional p-values can be thought of as estimating Pr[X=xobs or X is more extreme than xobs] under the null hypothesis, where more extreme is defined differently for different methods. The mid-p-value replaces this with 0.5*Pr[X=xobs]+ Pr[X is more extreme than xobs]. The mid-p p-values are not valid. In other words, for all parameter values under the null hypothesis we are not guaranteed to bound the type I error rate. However, the usual exact methods that guarantee the type I error rate are typically conservative for most parameter values in order to bound the type I error rate for all parameter values. So if you are interested in rejecting approximately on average about 5 percent of the time for arbitrary parameter values under the null hypothesis, then use midp=TRUE. If you want to ensure bounding of the type I errror rate for all parameter values use midp=FALSE. For a comprehensive discussions of exact inferences including mid-p values see Hirji (2006). Mid-p confidence intervals are calculated by inverting the mid-p-value function. For discussion of mid-p confidence intervals for Poisson see Cohen and Yang (1994).  
</p>
<p>The mid-p p-values and confidence intervals have not been programmed for the 'blaker' and 'minlike' tsmethods.
</p>


<h3>Value</h3>

<p>A list with class <code>"htest"</code> containing the following components:
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the number of events (in the first sample if there
are two.)</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>the corresponding expected count</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>a confidence interval for the rate or rate ratio.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the estimated rate or rate ratio.</p>
</td></tr>
<tr><td><code>null.value</code></td>
<td>
<p>the rate or rate ratio under the null,
<code>r</code>.</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p>a character string describing the alternative
hypothesis.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>the character string <code>"Exact Poisson test"</code> or
<code>"Comparison of Poisson rates"</code> as appropriate.</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>a character string giving the names of the data.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The rate parameter in Poisson data is often given based on a
&ldquo;time on test&rdquo; or similar quantity (person-years, population
size). This is the role of the <code>T</code> argument.
</p>


<h3>References</h3>

<p>Cohen and Yang (1994). Mid-p Confidence intervals for the Poisson Expectation. Statistics in Medicine. 13: 2189-2203.
</p>
<p>Fay, M.P. (2010). Two-sided Exact Tests and Matching Confidence Intervals for Discrete Data. R Journal 2(1): 53-58.
</p>
<p>Garwood, F (1936). Fiducial limits for the Poisson distribution. Biometrika, 437-442.
</p>
<p>Hirji K. F. (2006). Exact analysis of discrete data. Chapman and Hall/CRC. New York.
</p>
<p>Lehmann, EL, and Romano, JP (2005). Testing Statistical Hypotheses, third edition. Springer:New York.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+poisson.test">poisson.test</a></code>,  <code><a href="#topic+exactpoissonPlot">exactpoissonPlot</a></code>, 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Suppose you have observed rates of  2 out of 17877 in group A 
### and 10 out of 20000 in group B
### poisson.test gives non-matching confidence intervals
### i.e., p-value using  'minlike' criteria but confidence interval using 'central' criteria
poisson.test(c(2,10),c(17877,20000))
### poisson.exact gives matching CI to the p-values
### defaults to 'central' two-sided method
poisson.exact(c(2,10),c(17877,20000))
### other options
poisson.exact(c(2,10),c(17877,20000),tsmethod="minlike")
poisson.exact(c(2,10),c(17877,20000),tsmethod="blaker")


## Mid-p confidence intervals do not guarantee coverage, 
## but are more likely to have on average closer nominal 
## coverage than exact ones (sometimes erroring on the 
## too liberal side). 
##
## To test the software, here is Table I of Cohen and Yang
## values are equal to the first 2 decimal places
yCY&lt;-c(0:20,20+(1:5)*2,30+(1:14)*5)
TableICohenYang&lt;-matrix(NA,length(yCY),6,dimnames=list(yCY,
    c("90pct LL","90pct UL","95pct LL","95pct UL","99pct LL","99pct UL")))

for (i in 1:length(yCY)){
    TableICohenYang[i,1:2]&lt;-poisson.exact(yCY[i],
        midp=TRUE,conf.level=.9)$conf.int
    TableICohenYang[i,3:4]&lt;-poisson.exact(yCY[i],
        midp=TRUE,conf.level=.95)$conf.int
    TableICohenYang[i,5:6]&lt;-poisson.exact(yCY[i],
        midp=TRUE,conf.level=.99)$conf.int
}
TableICohenYang&lt;-round(TableICohenYang,3)
TableICohenYang

</code></pre>

<hr>
<h2 id='powerBinom'>
Exact Power and Sample Size methods for Bernoulli responses 
</h2><span id='topic+powerBinom'></span>

<h3>Description</h3>

<p>Calculates sample sizes or power for a study of n independent Bernoulli responses (i.e., a binomial response with parameter n). There are three types of calculations. For type='standard' calculate the usual sample size or power under a given alternative. The option type='cilength' bases calculations on the expected length of the confidence intervals. For type='obs1ormore' calculate the sample size or power to observe 1 or more positive responses. All calculations use exact methods. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powerBinom(n = NULL, p0 = 0.5, p1 = NULL, 
    sig.level = 0.05, power = NULL, 
    alternative = c("two.sided", "one.sided"), strict = FALSE,
    type = c("standard","cilength","obs1ormore"), 
    cilength = NULL, conf.level = 0.95, 
    direction = c("greater","less"), 
    control = binomControl(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powerBinom_+3A_n">n</code></td>
<td>

<p>sample size
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_p0">p0</code></td>
<td>

<p>probability of success under null
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_p1">p1</code></td>
<td>

<p>probability of success under alternative
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_sig.level">sig.level</code></td>
<td>

<p>significance level of test
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_power">power</code></td>
<td>

<p>target power of test (type='standard') or probability of observing at least 1 success (type='obs1ormore')
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_alternative">alternative</code></td>
<td>

<p>one- or two-sided test
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_strict">strict</code></td>
<td>

<p>use strict interpretation in two-sided case (count rejections in opposite direction)
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_type">type</code></td>
<td>

<p>either 'standard', 'cilength', or 'obs1ormore' (see details)
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_cilength">cilength</code></td>
<td>

<p>average length of confidence interval (used when type='cilength')
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_conf.level">conf.level</code></td>
<td>

<p>confidence level (used when type='cilength')
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_direction">direction</code></td>
<td>

<p>direction of alternative, either 'greater' or 'less' (used when type='standard' and p1 is NULL) 
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_control">control</code></td>
<td>

<p>a list with arguments that control algorithms, see 
<code><a href="#topic+binomControl">binomControl</a></code>
</p>
</td></tr>
<tr><td><code id="powerBinom_+3A_...">...</code></td>
<td>

<p>further arguments passed to <code><a href="#topic+binom.exact">binom.exact</a> (see details)</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Type='standard' calculates the power to reject the null hypothesis with the parameter p0 on the boundary between the null and alternative. In other words, the null could be either of the three, H0: p=p0 (for alternative='two.sided') or H0: p&lt;=p0 or H0:p&gt;=p0 (for alternative='one.sided'). For one-sided alternatives, p1 determines the alternative (and hence determines the null). For example, p0=.5 and p1=.7 will test H0: p&lt;=0.5 vs H1: p&gt; 0.5. 
</p>
<p>Type='cilength' calculates the expected length of the confidence intervals when p=p1. If p1=NULL, then it uses p1=0.5 because this will give the largest CI lengths. For sample size calculations, the n value is found using the <code><a href="ssanv.html#topic+uniroot.integer">uniroot.integer</a></code> function searching the range from control$minn to control$maxn, finding the smallest n that has expected CI length at least as large as cilength.
</p>
<p>Type='obs1ormore' calculates sample sizes related to the probability (i.e., the power) to observe at least one success. 
</p>
<p>Here are some details of the calculation method for type='standard' and type='cilength'. We use control$pRange (which should be from a vector of length two giving an interval very close to (0,1) but excluding the ends) to save computation time. We do not need to calculate the powers or expected CI lengths for all the possible values of X from 0:n. The algorithm only uses X from the likely values, using control$pRange to determine the quantiles that dominate the power or expectation calculation. For example, if n=1000 and pRange[1]=10^-10 and p1=0.5, then there is no need to calculate the CI lengths for x=0:399, because pbinom(399,1000,.5)&lt; 10^-10.
</p>
<p>For the ... argument, you cannot pass the 'alternative' argument to <code><a href="#topic+binom.exact">binom.exact</a></code>, since it has a different form  in <code>powerBinom</code> since p1 determines which one-sided alternative will be used. 
</p>


<h3>Value</h3>

<p>a object of class <code>power.htest</code>. List with input arguments plus calculated values, together with 'note' and 'method' character vectors describing the method. 
</p>


<h3>Note</h3>

<p>Often you will get the same power with midp=FALSE (default) and midp=TRUE. This is because the rejection region may be the same for both cases. For example, for type='standard' with n=20 using the default two.sided 0.05 exact central test, regardless of whether midp=FALSE or TRUE, we reject p0=0.5 for x in (0:5 and 15:20).</p>


<h3>Author(s)</h3>

<p>Michael P. Fay
</p>


<h3>Examples</h3>

<pre><code class='language-R'># find power to reject H0: p = p0
# when p=p1 (only counting rejections in the correct direction)     
# defaults to exact central test of binom.exact      
powerBinom(n=40,p0=.4,p1=.6)
# The following calculates the sample size
# to have the average length of confidence intervals 
# be at least 0.4 (regardless of the true proportion)
powerBinom(type="cilength",cilength=.4)
# The following answers the question:
# if the true proportion is .001, how many 
# observations do you need to sample to 
# have the probability of seeing at least 1 success be
# at least .9?
powerBinom(power=.9,p1=.001,type="obs1ormore")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
