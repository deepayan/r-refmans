<!DOCTYPE html><html lang="en"><head><title>Help for package autoimage</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {autoimage}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.legend.scale.args'><p>Creates hidden information for the legend margin and legend scale</p>
to using autolegend function.</a></li>
<li><a href='#autoimage'><p>Automatic facetting of multiple projected images</p></a></li>
<li><a href='#autolayout'><p>Divide device into rows and columns</p></a></li>
<li><a href='#autolegend'><p>Add legend to projected image.</p></a></li>
<li><a href='#automar'><p>Sensible legend margins</p></a></li>
<li><a href='#autopoints'><p>Automatic facetting of multiple projected scatterplots</p></a></li>
<li><a href='#autosize'><p>Automatically select plot matrix dimensions</p></a></li>
<li><a href='#blank.plot'><p>Draw blank plot</p></a></li>
<li><a href='#canada'><p>Provincial and territorial boundaries of Canada, 2001</p></a></li>
<li><a href='#copoly'><p>Colorado state border</p></a></li>
<li><a href='#ggautoimage'><p>Display images using ggplot2</p></a></li>
<li><a href='#heat_ppoints'><p>Display colored scatterplot for projected coordinates</p></a></li>
<li><a href='#inarccap'><p>Interpolated maximum daily surface air temperatures on a regular grid.</p></a></li>
<li><a href='#legend.scale'><p>Color scale legend</p></a></li>
<li><a href='#narccap'><p>Maximum daily surface air temperatures on a grid.</p></a></li>
<li><a href='#parrows'><p>Projected arrows function</p></a></li>
<li><a href='#paxes'><p>Display axes for projected coordinates</p></a></li>
<li><a href='#pimage'><p>Display image for projected coordinates</p></a></li>
<li><a href='#plines'><p>Projected lines function</p></a></li>
<li><a href='#ppoints'><p>Projected points function</p></a></li>
<li><a href='#ppolygon'><p>Projected polygon function</p></a></li>
<li><a href='#psegments'><p>Projected segments function</p></a></li>
<li><a href='#ptext'><p>Projected text function</p></a></li>
<li><a href='#reset.par'><p>Reset par</p></a></li>
<li><a href='#rotate'><p>Rotate coordinates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiple Heat Maps for Projected Coordinates</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-03-15</td>
</tr>
<tr>
<td>Author:</td>
<td>Joshua French</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joshua French &lt;joshua.french@ucdenver.edu&gt;</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jfrench/autoimage/issues">https://github.com/jfrench/autoimage/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for displaying multiple images  or scatterplots with a color 
    scale, i.e., heat maps, possibly with projected coordinates.  The
    package relies on the base graphics system, so graphics are
    rendered rapidly.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>colorspace, fields, mapproj, ggplot2, maps, MBA</td>
</tr>
<tr>
<td>Suggests:</td>
<td>abind, testthat, spatstat.geom, gear, broom, gridExtra,
knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-16 02:39:11 UTC; joshu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-16 15:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='.legend.scale.args'>Creates hidden information for the legend margin and legend scale
to using autolegend function.</h2><span id='topic+.legend.scale.args'></span>

<h3>Description</h3>

<p>Creates hidden information for the legend margin and legend scale
to using autolegend function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.legend.scale.args(new)
</code></pre>

<hr>
<h2 id='autoimage'>Automatic facetting of multiple projected images</h2><span id='topic+autoimage'></span>

<h3>Description</h3>

<p><code>autoimage</code> plots a sequence of images (with possibly 
projected coordinates) while also automatically plotting a 
color scale matching the image colors to the values of <code>z</code>.  
Many options are available for legend customization.  The coordinates
can be irregularly spaced, on a regular grid, or on an irregular 
grid.  <code>z</code> can be a numeric vector, matrix, or array, depending
on the context.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoimage(
  x,
  y,
  z,
  legend = "horizontal",
  proj = "none",
  parameters,
  orientation,
  common.legend = TRUE,
  map = "none",
  size,
  lratio,
  outer.title,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoimage_+3A_x">x</code></td>
<td>
<p>Locations of grid points at which the values in <code>z</code>
are measured.  The values must be finite and non-missing.  These 
arguments can be either vectors or matrices depending on the type
of data to be displayed.  See Details.</p>
</td></tr>
<tr><td><code id="autoimage_+3A_y">y</code></td>
<td>
<p>Locations of grid points at which the values in <code>z</code>
are measured.  The values must be finite and non-missing.  These 
arguments can be either vectors or matrices depending on the type
of data to be displayed.  See Details.</p>
</td></tr>
<tr><td><code id="autoimage_+3A_z">z</code></td>
<td>
<p>A numeric or logical vector or matrix containing the 
values to be plotted (NAs are allowed).</p>
</td></tr>
<tr><td><code id="autoimage_+3A_legend">legend</code></td>
<td>
<p>A character string indicating where the color scale 
should be placed.  The default is <code>"horizontal"</code>.  The other
valid options are <code>"none"</code> and <code>"vertical"</code>.</p>
</td></tr>
<tr><td><code id="autoimage_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function, which is used for the
projection.</p>
</td></tr>
<tr><td><code id="autoimage_+3A_parameters">parameters</code></td>
<td>
<p>A numeric vector specifying the values of the 
<code>parameters</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>.  This may be necessary when
<code>proj != "none"</code>.</p>
</td></tr>
<tr><td><code id="autoimage_+3A_orientation">orientation</code></td>
<td>
<p>A vector <code>c(latitude,longitude,rotation)</code> 
which describes where the &quot;North Pole&quot; should be when computing 
the projection.  See <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> for more
details.</p>
</td></tr>
<tr><td><code id="autoimage_+3A_common.legend">common.legend</code></td>
<td>
<p>A logical value indicating whether a common 
legend scale should be used for all images provided in the
<code>z</code> array.  Default is <code>TRUE</code>.  If <code>FALSE</code>, a
separate legend is used for each image.</p>
</td></tr>
<tr><td><code id="autoimage_+3A_map">map</code></td>
<td>
<p>The name of the map to draw on the image. Default is 
<code>"none"</code>.  Other options include <code>"world"</code>, 
<code>"usa"</code>, <code>"state"</code>, <code>"county"</code>, <code>"france"</code>, 
<code>"nz"</code> (New Zealand), <code>"italy"</code>, <code>"lakes"</code>, and
<code>"world2"</code>, all from the <code>maps</code> package.</p>
</td></tr>
<tr><td><code id="autoimage_+3A_size">size</code></td>
<td>
<p>A vector of length two indicating the number of rows 
and columns that should be used for the series of image data in 
<code>z</code>.  Note that <code>prod(size)</code> must match the length of 
the third dimension of <code>z</code> (if it is an array), or 
<code>c(1, 1)</code> if <code>z</code> is a matrix.</p>
</td></tr>
<tr><td><code id="autoimage_+3A_lratio">lratio</code></td>
<td>
<p>A numeric value indicating the ratio of the smaller 
dimension of the legend scale to the width of the image.  Default
is 0.1 + 0.1 <code>* k</code>, where <code>k</code> is the number of image rows 
if <code>legend == "horizontal"</code> or the number of image 
columns if <code>legend == "vertical"</code>.</p>
</td></tr>
<tr><td><code id="autoimage_+3A_outer.title">outer.title</code></td>
<td>
<p>A title related to all of the images that is plotted in the outer margin of the figure.</p>
</td></tr>
<tr><td><code id="autoimage_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the <code><a href="graphics.html#topic+image">image</a></code> or 
<code><a href="fields.html#topic+poly.image">poly.image</a></code> functions.  e.g., <code>xlab</code>, <code>ylab</code>, 
<code>xlim</code>, <code>ylim</code>, <code>zlim</code>, etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function is used to project 
the <code>x</code> and <code>y</code> coordinates when <code>proj != "none"</code>.
</p>
<p>If multiple images are to be plotted (i.e., if <code>z</code> is an array), 
then the <code>main</code> argument can be a vector with length matching 
<code>dim(z)[3]</code>, and each successive element of the vector will 
be used to add a title to each successive image plotted.  
See the Examples.
</p>
<p>Additionally, if <code>common.legend = FALSE</code>, then separate limits 
for the z-axis of each image can be provided as a list.  
Specifically, if <code>dim(z)[3] == k</code>, then <code>zlim</code> should 
be a list of length <code>k</code>, and each element of the list should 
be a 2-dimensional vector providing the lower and upper limit, 
respectively, of the legend for each image.  Alternatively, if 
<code>zlim</code> is a list of length <code>k</code>, then <code>common.legend</code>
is set to <code>FALSE</code>. 
</p>
<p>The range of <code>zlim</code> is cut into <code class="reqn">n</code> partitions, 
where <code>n</code> is the length of <code>col</code>.
</p>
<p>It is generally desirable to increase <code>lratio</code> when
more images are plotted simultaneously.
</p>
<p>The multiple plots are constructed using the 
<code><a href="#topic+autolayout">autolayout</a></code> function, which 
is incompatible with the <code>mfrow</code> and <code>mfcol</code> arguments 
in the <code><a href="graphics.html#topic+par">par</a></code> function and is also 
incompatible with the <code><a href="graphics.html#topic+split.screen">split.screen</a></code> function.
</p>
<p>The <code>mtext.args</code> argument can be passed through <code>...</code> 
in order to customize the outer title.  This should be a named
list with components matching the arguments of 
<code><a href="graphics.html#topic+mtext">mtext</a></code>.
</p>
<p>Lines can be added to each image by passing the <code>lines</code> 
argument through <code>...</code>.  In that case, <code>lines</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the lines.  The appearance of the plotted lines
can be customized by passing a named list called <code>lines.args</code>
through <code>...</code>. The components of <code>lines.args</code> should match
the arguments of <code><a href="graphics.html#topic+lines">lines</a></code>.  See Examples.
</p>
<p>Points can be added to each image by passing the <code>points</code> 
argument through <code>...</code>.  In that case, <code>points</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the points.  The appearance of the plotted points
can be customized by passing a named list called <code>points.args</code>
through <code>...</code>. The components of <code>points.args</code> should match
the components of <code><a href="graphics.html#topic+points">points</a></code>.  See Examples.
</p>
<p>Text can be added to each image by passing the <code>text</code> 
argument through <code>...</code>.  In that case, <code>text</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the text, and <code>labels</code>, a component
specifying the actual text to write.  The appearance of the plotted text
can be customized by passing a named list called <code>text.args</code>
through <code>...</code>. The components of <code>text.args</code> should match
the components of <code><a href="graphics.html#topic+text">text</a></code>.  See Examples.
</p>
<p>The legend scale can be modified by passing <code>legend.axis.args</code>
through <code>...</code>.  The argument should be a named list
corresponding to the arguments of the <code><a href="graphics.html#topic+axis">axis</a></code>
function.  See Examples.
</p>
<p>The image axes can be modified by passing <code>axis.args</code>
through <code>...</code>.  The argument should be a named list
corresponding to the arguments of the <code><a href="graphics.html#topic+axis">axis</a></code>
function.  The exception to this is that arguments <code>xat</code> 
and <code>yat</code> can be specified (instead of <code>at</code>) to specify
the location of the x and y ticks.  If <code>xat</code> or <code>yat</code>
are specified, then this overrides the <code>xaxt</code> and <code>yaxt</code>
arguments, respectively.  See the <code><a href="#topic+paxes">paxes</a></code>
function to see how <code>axis.args can be used.</code>
</p>
<p>The legend margin can be customized by passing <code>legend.mar</code>
to <code>pimage</code> through <code>...</code>.  This should be a numeric
vector indicating the margins of the legend, identical to how 
<code>par("mar")</code> is specified.
</p>
<p>The various options of the labeling, axes, and legend are largely
independent.  e.g., passing <code>col.axis</code> through <code>...</code> 
will not affect the axis unless it is passed as part of the 
named list <code>axis.args</code>.  However, one can set the various
<code>par</code> options prior to plotting to simultaneously
affect the appearance of multiple aspects of the plot.  See 
Examples for <code><a href="#topic+pimage">pimage</a></code>.  After plotting, 
<code>reset.par()</code> can be used to reset 
the graphics device options to their default values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pimage">pimage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(narccap)
# restructure data for 2 images
tasmax2 &lt;- tasmax[,,1:2]

# plot irregularly gridded images with separate legends
# and usa border
autoimage(lon, lat, tasmax2, common.legend = FALSE, map = "usa")

# plot irregularly gridded images with common legend and world lines
# customize world lines
# add and customize title
autoimage(lon, lat, tasmax2, map = "world", 
          lines.args = list(col = "white", lwd = 2),
          outer.title = "Maximum Daily Surface Air Temperature (K)",
          mtext.args = list(col = "blue", cex = 2))

# plot irregularly-spaced responsed as images with separate legends
# and county borders.  Add observed data locations with custom point
# options.  Add text at locations of Denver and Colorado Springs.
data(co, package = "gear")
autoimage(co$lon, co$lat, co[,c("Al", "Ca")], common.legend = FALSE, 
          map = "county", main = c("Aluminum", "Cadmium"),
          points = list(x = co$lon, y = co$lat),
          points.args = list(pch = 20, col = "white"),
          text = list(x = c(-104.98, -104.80), y = c(39.74, 38.85), 
                      labels = c("Denver", "Colorado Springs")),
          text.args = list(col = "red"))

# customize margins and lratio for large plot
# also use projection
# specify manual lines (though in this case it is the same as using 
# map = "world")
data(worldMapEnv, package = "maps")
worldpoly &lt;- maps::map("world", plot = FALSE)
par(mar = c(1.1, 4.1, 2.1, 1.1))
autoimage(lon, lat, tasmax, lines = worldpoly, 
          proj = "bonne", parameters = 40,
          main = c("day 1", "day 2", "day 3", "day 4", "day 5"),
          ylab = "",
          axes = FALSE,
          lratio = 0.5)
</code></pre>

<hr>
<h2 id='autolayout'>Divide device into rows and columns</h2><span id='topic+autolayout'></span>

<h3>Description</h3>

<p><code>autolayout</code> divides the current device into equal-sized rows 
and equal-sized columns based on the specified arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autolayout(
  size,
  legend = "none",
  common.legend = TRUE,
  lratio = 0.2,
  outer = FALSE,
  show = TRUE,
  reverse = FALSE,
  legend.mar
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autolayout_+3A_size">size</code></td>
<td>
<p>A vector of length two indicating the number of rows 
and columns that should be used for the series of image data in 
<code>z</code>.  Note that <code>prod(size)</code> must match the length of 
the third dimension of <code>z</code> (if it is an array), or 
<code>c(1, 1)</code> if <code>z</code> is a matrix.</p>
</td></tr>
<tr><td><code id="autolayout_+3A_legend">legend</code></td>
<td>
<p>A character string indicating where the color scale 
should be placed.  The default is <code>"horizontal"</code>.  The other
valid options are <code>"none"</code> and <code>"vertical"</code>.</p>
</td></tr>
<tr><td><code id="autolayout_+3A_common.legend">common.legend</code></td>
<td>
<p>A logical value indicating whether a common 
legend scale should be used for all images provided in the
<code>z</code> array.  Default is <code>TRUE</code>.  If <code>FALSE</code>, a
separate legend is used for each image.</p>
</td></tr>
<tr><td><code id="autolayout_+3A_lratio">lratio</code></td>
<td>
<p>A numeric value indicating the ratio of the width of 
the legend scale to the width of the each image.  Default is 
<code>lratio = 0.2</code>.</p>
</td></tr>
<tr><td><code id="autolayout_+3A_outer">outer</code></td>
<td>
<p>A logical value indicating whether the room should be 
left for an outer title that is common for all plots.  Depends on
setting the <code>oma</code> argument of the
<code><a href="graphics.html#topic+par">par</a></code> function.</p>
</td></tr>
<tr><td><code id="autolayout_+3A_show">show</code></td>
<td>
<p>A logical value indicating whether the 
<code><a href="graphics.html#topic+layout.show">layout.show</a></code> function should be called
after the layout is constructed.</p>
</td></tr>
<tr><td><code id="autolayout_+3A_reverse">reverse</code></td>
<td>
<p>A logical value indicating whether the legend scale 
should be plotted before the image.  Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="autolayout_+3A_legend.mar">legend.mar</code></td>
<td>
<p>The margins for the legend.  (See the <code>mar</code> 
argument of <code><a href="graphics.html#topic+par">par</a></code>).  If not specified, then
sensible values are chosen based on the current vector 
<code>par("mar")</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The rows and columns are constructed using the 
<code><a href="graphics.html#topic+layout">layout</a></code> function, which is incompatible with
the <code>mfrow</code> and <code>mfcol</code> arguments in the 
<code><a href="graphics.html#topic+par">par</a></code> function and is also incompatible with 
the <code><a href="graphics.html#topic+split.screen">split.screen</a></code> function.
</p>
<p>Note <code><a href="graphics.html#topic+par">par</a></code> parameters are NOT RESET after 
executing the <code><a href="graphics.html#topic+layout">layout</a></code> function so the the 
user can use existing layout for plots.
</p>
<p>If <code>legend = "horizontal"</code> or <code>legend = "vertical"</code>, then
a portion of the device is dedicated to a legend.
</p>
<p>If <code>common.legend = TRUE</code>, then one legend region is created 
for the entire set of plots. If <code>common.legend = FALSE</code>, then
a separate legend region is created for each individual plot.
</p>
<p>With respective to ordering of the plotting regions: A common 
legend is plotted after all other plots, while individual legends 
are plotted after each respective plot.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+image">image</a></code>, 
<code><a href="fields.html#topic+image.plot">image.plot</a></code>, <code><a href="graphics.html#topic+axis">axis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># basic 2x2 layout
autolayout(c(2, 2))
# 3x2 layout with space for legends
autolayout(c(3, 2), legend = "h")
autolayout(c(3, 2), legend = "v")
# 3x2 layout with individuals legends
autolayout(c(3, 2), legend = "h", common.legend = FALSE)
autolayout(c(3, 2), legend = "v", common.legend = FALSE)
# if outer title is desired
autolayout(c(2, 2), outer = TRUE)
# reset oma parameters
par(oma = c(0, 0, 0, 0))
# impact of lratio when legend used
autolayout(c(2, 2), legend = "h", lratio = 0.5)
autolayout(c(2, 2), legend = "h", lratio = 0.2)
</code></pre>

<hr>
<h2 id='autolegend'>Add legend to projected image.</h2><span id='topic+autolegend'></span>

<h3>Description</h3>

<p><code>autolegend</code> adds a color scale to the current device based on
the information from the last calls to the 
<code><a href="#topic+autolayout">autolayout</a></code> and 
<code><a href="#topic+pimage">pimage</a></code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autolegend()
</code></pre>


<h3>Details</h3>

<p>Internally, <code>autolegend</code> calls the <code>.legend.scale.args</code>, 
<code>.legend.horizontal</code>, and <code>.legend.mar</code> functions to 
obtain the relevant information.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autolayout">autolayout</a></code>, 
<code><a href="#topic+pimage">pimage</a></code>, 
<code><a href="#topic+legend.scale">legend.scale</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(narccap)
autolayout(c(1, 1), legend = "h")
pimage(lon, lat, tasmax[,,1], legend = "none")
autolegend()

# common legend with distinct lines
autolayout(c(1, 2), legend = "h")
pimage(lon, lat, tasmax[,,1], legend = "none", map = "world")
pimage(lon, lat, tasmax[,,2], legend = "none", map = "usa", 
       proj = "bonne", parameters = 40)
autolegend()

# separate legends with distinct lines
autolayout(c(1, 2), legend = "v", common.legend = FALSE)
pimage(lon, lat, tasmax[,,1], legend = "none", map = "state",
       proj = "bonne", parameters = 40, axes = FALSE)
autolegend()
pimage(lon, lat, tasmax[,,2], legend = "none", map = "usa", 
       proj = "albers", parameters = c(32, 45), axes = FALSE)
autolegend()

data(worldMapEnv, package = "maps")
# extract hawaii and alaskan borders
hiak &lt;- maps::map("world", c("USA:Hawaii", "USA:Alaska"), 
                  plot = FALSE)
# extract colorado cities from us.cities
data(us.cities, package = "maps")
codf &lt;- us.cities[us.cities$country.etc == "CO", ]
# select smaller subset of colorado cities
codf &lt;- codf[c(3, 5, 7:11, 15, 18), ]
# extract capitals from us.cities
capdf &lt;- us.cities[us.cities$capital == 2,]

# setup plotting area
autolayout(c(1, 2), legend = "h", common.legend = FALSE, outer = TRUE)
# create image of NARCCAP data.
# xlim is chosen so to include alaska and hawaii
# add grey state borders
pimage(lon, lat, tasmax[,,1], legend = "none", proj = "mercator",
       map = "state", xlim = c(-180, 20), 
       lines.args = list(col = "grey"))
# add hawaii and alaskan borders
plines(hiak, proj = "mercator", col = "grey")
# add state captials to image
ppoints(capdf$lon, capdf$lat, proj = "mercator", pch = 16)
# title image
title("tasmax for North America")
# add legend for plot
autolegend()
# load colorado geochemical data
data(co, package = "gear")
# create image for colorado aluminum measurements
# use bonne projection
# customize legend colors
# add grey county borders
pimage(co$lon, co$lat, co$Al, map = "county", legend = "none",
       proj = "bonne", parameters = 39, 
       paxes.args = list(grid = FALSE),
       col = fields::tim.colors(64), 
       lines.args = list(col = "grey"))
# add colorado city points to image
ppoints(codf$lon, codf$lat, pch = 16, proj = "bonne")
# add names of colorado cities to image
ptext(codf$lon, codf$lat, labels = codf$name, proj = "bonne", pos = 4)
# title plot
title("Colorado Aluminum levels (%)")
# add legend to current image
autolegend()
# add common title for plots
mtext("Two complicated maps", col = "purple", outer = TRUE, cex = 2)

reset.par() # reset device default
</code></pre>

<hr>
<h2 id='automar'>Sensible legend margins</h2><span id='topic+automar'></span>

<h3>Description</h3>

<p><code>automar</code> determines sensible margins for 
<code><a href="#topic+legend.scale">legend.scale</a></code> based on the value currently
set for <code>par("mar")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>automar(legend = "none")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="automar_+3A_legend">legend</code></td>
<td>
<p>A character string indicating the orientation of the
<code><a href="#topic+legend.scale">legend.scale</a></code>. The default is
<code>"none"</code>.  The other valid options are <code>"horizontal"</code>
and <code>"vertical"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The margins produced by <code>automar</code> are based on the current
choice of <code>par("mar")</code>. If the user has specified a poor
choice for <code>par("mar")</code>, then <code>automar</code> might also
produce a poor choice for the legend margin.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>automar()
automar("h")
automar("v")
</code></pre>

<hr>
<h2 id='autopoints'>Automatic facetting of multiple projected scatterplots</h2><span id='topic+autopoints'></span>

<h3>Description</h3>

<p><code>autopoints</code> plots a sequence of scatterplots (with possibly 
projected coordinates) while also automatically plotting a 
color scale matching the image colors to the values of <code>z</code>.  
Many options are available for customization. See the Examples 
below or execute <code>vignette("autopoints")</code> to better
understand the possibilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autopoints(
  x,
  y,
  z,
  legend = "horizontal",
  proj = "none",
  parameters,
  orientation,
  common.legend = TRUE,
  map = "none",
  size,
  lratio,
  outer.title,
  n = 5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autopoints_+3A_x">x</code></td>
<td>
<p>Numeric vectors of coordinates at which the
values in <code>z</code> are measured.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_y">y</code></td>
<td>
<p>Numeric vectors of coordinates at which the
values in <code>z</code> are measured.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_z">z</code></td>
<td>
<p>A numeric vector containing the values to be
plotted.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_legend">legend</code></td>
<td>
<p>A character string indicating where the
color scale should be placed.  The default is
<code>"horizontal"</code>.  The other valid options are
<code>"none"</code> and <code>"vertical"</code>.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection
should be used for the included <code>x</code> and <code>y</code>
coordinates.  The default is <code>"none"</code>.  The other
valid choices correspond to the <code>"projection"</code>
argument in the <code><a href="mapproj.html#topic+mapproject">mapproject</a></code>
function, which is used for the projection.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_parameters">parameters</code></td>
<td>
<p>A numeric vector specifying the values
of the <code>parameters</code> argument in the
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>.  This may be
necessary when <code>proj != "none"</code>.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_orientation">orientation</code></td>
<td>
<p>A vector
<code>c(latitude,longitude,rotation)</code> which describes
where the &quot;North Pole&quot; should be when computing the
projection.  See <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> for
more details.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_common.legend">common.legend</code></td>
<td>
<p>A logical value indicating whether a common 
legend scale should be used for all images provided in the
<code>z</code> array.  Default is <code>TRUE</code>.  If <code>FALSE</code>, a
separate legend is used for each image.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_map">map</code></td>
<td>
<p>The name of the map to draw on the image.
Default is <code>"none"</code>.  Other options include
<code>"world"</code>, <code>"usa"</code>, <code>"state"</code>,
<code>"county"</code>, <code>"france"</code>, <code>"nz"</code> (New
Zealand), <code>"italy"</code>, <code>"lakes"</code>, and
<code>"world2"</code>, all from the <code>maps</code> package.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_size">size</code></td>
<td>
<p>A vector of length two indicating the number of rows 
and columns that should be used for the series of image data in 
<code>z</code>.  Note that <code>prod(size)</code> must match the length of 
the third dimension of <code>z</code> (if it is an array), or 
<code>c(1, 1)</code> if <code>z</code> is a matrix.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_lratio">lratio</code></td>
<td>
<p>A numeric value indicating the ratio of the
smaller dimension of the legend scale to the width of
the image.  Default is <code>lratio = 0.2</code>.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_outer.title">outer.title</code></td>
<td>
<p>A title related to all of the images that is plotted in the outer margin of the figure.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_n">n</code></td>
<td>
<p>integer giving the <em>desired</em> number of
intervals.  Non-integer values are rounded down.</p>
</td></tr>
<tr><td><code id="autopoints_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the 
<code><a href="graphics.html#topic+plot">plot</a></code>. e.g., <code>xlab</code>, <code>ylab</code>, 
<code>xlim</code>, <code>ylim</code>, <code>zlim</code>, etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>n</code> argument specifies the desired number of color
partitions, but may not be exact. This is used to create
&quot;pretty&quot; color scale tick labels using the
<code><a href="base.html#topic+pretty">pretty</a></code> function.
If <code>zlim</code> or <code>breaks</code> are provided, then the 
<code><a href="base.html#topic+pretty">pretty</a></code> function is not used to determine
the color scale tick lables, and the user may need to
manually specify <code>breaks</code> to get the color scale to
have &quot;pretty&quot; tick labels. If <code>col</code> is specified,
then <code>n</code> is set to <code>length(col)</code>, but the 
functions otherwise works the same (i.e., pretty tick
labels are not automatic if <code>zlim</code> or <code>breaks</code>
are specified.
</p>
<p>The <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function is used to project 
the <code>x</code> and <code>y</code> coordinates when <code>proj != "none"</code>.
</p>
<p>If multiple scatterplots are to be plotted (i.e., if 
<code>z</code> is a matrix with more than 1 column), then the
<code>main</code> argument can be a vector with length matching 
<code>ncol(z)</code>, and each successive element of the vector will 
be used to add a title to each successive scatterplot.  
See the Examples.
</p>
<p>Additionally, if <code>common.legend = FALSE</code>, then separate 
z limits and breaks for the z-axis of each image can be provided as a list.  
Specifically, if <code>ncol(z) == k</code>, then <code>zlim</code> should 
be a list of length <code>k</code>, and each element of the list should 
be a 2-dimensional vector providing the lower and upper limit, 
respectively, of the legend for each image. Similarly,
the <code>breaks</code> argument should be a list of length <code>k</code>,
and each element of the list should be a vector specifying
the breaks for the color scale for each plot. Note that
the length of each element of breaks should be 1 greater
then the number of colors in the color scale.
</p>
<p>The range of <code>zlim</code> is cut into <code class="reqn">n</code> partitions, 
where <code>n</code> is the length of <code>col</code>.
</p>
<p>It is generally desirable to increase <code>lratio</code> when
more images are plotted simultaneously.
</p>
<p>The multiple plots are constructed using the 
<code><a href="#topic+autolayout">autolayout</a></code> function, which 
is incompatible with the <code>mfrow</code> and <code>mfcol</code> arguments 
in the <code><a href="graphics.html#topic+par">par</a></code> function and is also 
incompatible with the <code><a href="graphics.html#topic+split.screen">split.screen</a></code> function.
</p>
<p>The <code>mtext.args</code> argument can be passed through <code>...</code> 
in order to customize the outer title.  This should be a named
list with components matching the arguments of 
<code><a href="graphics.html#topic+mtext">mtext</a></code>.
</p>
<p>Lines can be added to each image by passing the <code>lines</code> 
argument through <code>...</code>.  In that case, <code>lines</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the lines.  The appearance of the plotted lines
can be customized by passing a named list called <code>lines.args</code>
through <code>...</code>. The components of <code>lines.args</code> should match
the arguments of <code><a href="graphics.html#topic+lines">lines</a></code>.  See Examples.
</p>
<p>Points can be added to each image by passing the <code>points</code> 
argument through <code>...</code>.  In that case, <code>points</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the points.  The appearance of the plotted points
can be customized by passing a named list called <code>points.args</code>
through <code>...</code>. The components of <code>points.args</code> should match
the components of <code><a href="graphics.html#topic+points">points</a></code>.  See Examples.
</p>
<p>Text can be added to each image by passing the <code>text</code> 
argument through <code>...</code>.  In that case, <code>text</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the text, and <code>labels</code>, a component
specifying the actual text to write.  The appearance of the plotted text
can be customized by passing a named list called <code>text.args</code>
through <code>...</code>. The components of <code>text.args</code> should match
the components of <code><a href="graphics.html#topic+text">text</a></code>.  See Examples.
</p>
<p>The legend scale can be modified by passing <code>legend.axis.args</code>
through <code>...</code>.  The argument should be a named list
corresponding to the arguments of the <code><a href="graphics.html#topic+axis">axis</a></code>
function.  See Examples.
</p>
<p>The axes can be modified by passing <code>axis.args</code>
through <code>...</code>.  The argument should be a named list
corresponding to the arguments of the <code><a href="graphics.html#topic+axis">axis</a></code>
function.  The exception to this is that arguments <code>xat</code> 
and <code>yat</code> can be specified (instead of <code>at</code>) to specify
the location of the x and y ticks.  If <code>xat</code> or <code>yat</code>
are specified, then this overrides the <code>xaxt</code> and <code>yaxt</code>
arguments, respectively.  See the <code><a href="#topic+paxes">paxes</a></code>
function to see how <code>axis.args can be used.</code>
</p>
<p>The legend margin can be customized by passing <code>legend.mar</code>
to <code>autpoints</code> through <code>...</code>.  This should be a numeric
vector indicating the margins of the legend, identical to how 
<code>par("mar")</code> is specified.
</p>
<p>The various options of the labeling, axes, and legend are largely
independent.  e.g., passing <code>col.axis</code> through <code>...</code> 
will not affect the axis unless it is passed as part of the 
named list <code>axis.args</code>.  However, one can set the various
<code>par</code> options prior to plotting to simultaneously
affect the appearance of multiple aspects of the plot.  See 
Examples for <code><a href="#topic+pimage">pimage</a></code>.  After plotting, 
<code>reset.par()</code> can be used to reset 
the graphics device options to their default values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autoimage">autoimage</a></code>, <code><a href="#topic+heat_ppoints">heat_ppoints</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(co, package = "gear")
easting = co$easting
northing = co$northing
# heated scatterplot for Aluminum and Cadmium
autopoints(easting, northing, co[,c("Al", "Ca")],
           common.legend = FALSE, map = "state",
           main = c("Al", "Ca"), lratio = 0.2,
           legend.mar = c(0.3, 0.1, 0.1, 0.1))

# more complicated heat scatterplot for Aluminum and
# Cadmium used more advanced options
autopoints(co$lon, co$lat, co[,c("Al", "Ca")],
          common.legend = FALSE, 
          map = "county", main = c("Aluminum", "Cadmium"),
          proj = "bonne", parameters = 40,
          text = list(x = c(-104.98, -104.80), y = c(39.74, 38.85), 
                      labels = c("Denver", "Colorado Springs")),
          text.args = list(col = "blue"))
</code></pre>

<hr>
<h2 id='autosize'>Automatically select plot matrix dimensions</h2><span id='topic+autosize'></span>

<h3>Description</h3>

<p><code>autosize</code> automatically makes a sensible choice for the 
dimensions of a plot matrix based on <code>n</code>, the number of plots.
Only works for <code>n &lt;= 36</code>. The dimensions are chosen to be as 
close to a square as possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autosize(n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autosize_+3A_n">n</code></td>
<td>
<p>The number of plots.  Should be a positive integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length 2 with the number of rows and number of 
columns for the plot matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>autosize(3)
autosize(9)
autosize(11)
autosize(24)
</code></pre>

<hr>
<h2 id='blank.plot'>Draw blank plot</h2><span id='topic+blank.plot'></span>

<h3>Description</h3>

<p><code>blank.plot</code> draws a blank plot (no data, axis, or labels) on 
the current device.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blank.plot()
</code></pre>


<h3>Details</h3>

<p>Used by the <code>autoimage</code> function to fill remaining regions 
with white space when there are more plotting regions than images 
to plot.
</p>


<h3>See Also</h3>

<p><code>autoimage</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>blank.plot()
</code></pre>

<hr>
<h2 id='canada'>Provincial and territorial boundaries of Canada, 2001</h2><span id='topic+canada'></span>

<h3>Description</h3>

<p>An list-like object with components <code>x</code> and 
<code>y</code> specifying the provincial and territorial boundaries of 
Canada during the 2001  
census.  The coordinates are in longitude/latitude coordinates.
The data was derived from the shapefiles provided by
Statistics Canada.  The object also has a component 
<code>range</code> 
specifying the range of the data in the order
<code>c(min(x), max(x), min(y), max(y))</code>.  Lastly, the object 
has a final component, <code>names</code>, which provides the name of the region
each polygon is associated with.  The object
has class <code>map</code> for compatibility with the <code>maps</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(canada)
</code></pre>


<h3>Format</h3>

<p>Contains:
</p>

<dl>
<dt>x</dt><dd><p>Longitude coordinates for Canadian boundaries</p>
</dd>
<dt>y</dt><dd><p>Latitude coordinates for Canadian boundaries</p>
</dd>
<dt>range</dt><dd><p>Range of x- and y-values</p>
</dd>
<dt>names</dt><dd><p>Region name for each polygon</p>
</dd>
</dl>



<h3>Source</h3>

<p>Shapefile made available by Statistics Canada.  
<a href="https://www.statcan.gc.ca/eng/start">https://www.statcan.gc.ca/eng/start</a>.
</p>

<hr>
<h2 id='copoly'>Colorado state border</h2><span id='topic+copoly'></span>

<h3>Description</h3>

<p>A list-like object with components <code>x</code> and <code>y</code> specifying
the borders of the state of Colorado in longitude/latitude coordinates.  
This was derived from the <code><a href="maps.html#topic+stateMapEnv">stateMapEnv</a></code> data set 
in the <code>maps</code> package.  The object also has a component 
<code>range</code> 
specifying the range of the data in the order
<code>c(min(x), max(x), min(y), max(y))</code>.  Lastly, the object 
has a final component, <code>names</code>, which provides names for each
polygon.  In this case, the only name is <code>"colorado"</code>.  The object
has class <code>map</code> for compatibility with the <code>maps</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(copoly)
</code></pre>


<h3>Format</h3>

<p>Contains:
</p>

<dl>
<dt>x</dt><dd><p>longitude coordinates for Colorado border</p>
</dd>
<dt>y</dt><dd><p>latitude coordinates for Colorado border</p>
</dd>
<dt>range</dt><dd><p>Range of x- and y-values</p>
</dd>
<dt>names</dt><dd><p>Name of polygon</p>
</dd>
</dl>



<h3>Source</h3>

<p>The <code><a href="maps.html#topic+stateMapEnv">stateMapEnv</a></code> data set in the 
<code>maps</code> package.
</p>

<hr>
<h2 id='ggautoimage'>Display images using ggplot2</h2><span id='topic+ggautoimage'></span>

<h3>Description</h3>

<p><code>ggautoimage</code> produces a sequence of images in a manner 
similar to <code><a href="#topic+autoimage">autoimage</a></code> using the 
<code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggautoimage(
  x,
  y,
  z,
  f,
  proj = "none",
  parameters,
  orientation,
  lines,
  points,
  interp.args
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggautoimage_+3A_x">x</code></td>
<td>
<p>A numeric vector specifying the x coordinate locations.</p>
</td></tr>
<tr><td><code id="ggautoimage_+3A_y">y</code></td>
<td>
<p>A numeric vector specifying the y coordinate locations.</p>
</td></tr>
<tr><td><code id="ggautoimage_+3A_z">z</code></td>
<td>
<p>A numeric vector specifying the response for each (x,y)
location.</p>
</td></tr>
<tr><td><code id="ggautoimage_+3A_f">f</code></td>
<td>
<p>A factor variable distinguishing between different facets,
i.e., the different images to be constructed.</p>
</td></tr>
<tr><td><code id="ggautoimage_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function, which is used for the
projection.</p>
</td></tr>
<tr><td><code id="ggautoimage_+3A_parameters">parameters</code></td>
<td>
<p>A numeric vector specifying the values of the 
<code>parameters</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>.  This may be necessary when
<code>proj != "none"</code>.</p>
</td></tr>
<tr><td><code id="ggautoimage_+3A_orientation">orientation</code></td>
<td>
<p>A vector <code>c(latitude,longitude,rotation)</code> 
which describes where the &quot;North Pole&quot; should be when computing 
the projection.  See <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> for more
details.</p>
</td></tr>
<tr><td><code id="ggautoimage_+3A_lines">lines</code></td>
<td>
<p>A named list with components <code>x</code> and <code>y</code>
specifiying the locations to be connected by lines.  Distinct
lines should be separated by <code>NA</code> values.  See Details.</p>
</td></tr>
<tr><td><code id="ggautoimage_+3A_points">points</code></td>
<td>
<p>A named list with components <code>x</code> and <code>y</code>
specifiying the locations to be plot points.</p>
</td></tr>
<tr><td><code id="ggautoimage_+3A_interp.args">interp.args</code></td>
<td>
<p>A named list with component matching the 
non <code>xyz</code> arguments of the 
<code><a href="MBA.html#topic+mba.surf">mba.surf</a></code> function.  Used to customize
interpolation, when required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> and <code>y</code> do not form a regular grid, then the 
<code><a href="MBA.html#topic+mba.surf">mba.surf</a></code> function is used to
interpolate the locations onto a regular grid before constructing
the image.  This interpolation can be customized by passing
<code>interp.args</code> through <code>...</code>.  <code>interp.args</code> should
be a named list with components matching the non <code>xyz</code> 
arguments of the <code><a href="MBA.html#topic+mba.surf">mba.surf</a></code> function.
</p>
<p>When <code>proj != "none"</code>, the <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> 
function is used to project the <code>x</code> and <code>y</code> coordinates. 
In that case, <code>proj</code> must correspond to one of the choices for
the <code>projection</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function.  Necessary arguments
for <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> should be provided through
the <code>parameters</code> and <code>orientation</code> arguments. 
See Examples or <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> for more 
details.
</p>
<p>Lines can be added to each image by providing the <code>lines</code>
argument.  In that case, <code>lines</code>
should be a list with components <code>x</code> and <code>y</code> 
specifying the locations to draw the lines.  If more than
one unconnected line should be drawn, then the coordinates
should be separated by NA.  e.g., to draw a line from (1, 1) to
(2, 2) and (3, 3) to (4, 4) (with a gap between the two lines), 
you would specify lines as 
lines(x = c(1:2, NA, 3:4), y =c(1:2, NA, 3:4)).  Also, see 
Examples.
</p>
<p>Points can be added to each image by providing the <code>points</code>
argument.  In that case, <code>points</code>
should be a list with components <code>x</code> and <code>y</code> 
specifying the locations to draw the points.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+autoimage">autoimage</a></code>,
<code><a href="fields.html#topic+image.plot">image.plot</a></code>, <code><a href="graphics.html#topic+axis">axis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(narccap)
# setup image for two days of narccap data
x &lt;- rep(c(lon), 2)
y &lt;- rep(c(lat), 2)
z &lt;- c(tasmax[, , 1:2])
f &lt;- factor(rep(c("day 1", "day 2"), each = length(lon)))
# load national borders
data("worldMapEnv", package = "maps")
lines &lt;- maps::map("world", plot = FALSE)
# obtain us captial cities
data(us.cities, package = "maps")
cap &lt;- us.cities[us.cities$capital == 2, ]
# convert to list format
points &lt;- list(x = cap$lon, y = cap$lat)

## Not run: 
# basic images
ggautoimage(x, y, z, f)
# basic images with national borders and U.S. captials
ggautoimage(x, y, z, f, lines = lines, points = points)
# project coordinates with national borders and U.S. capitals
ggautoimage(x, y, z, f, lines = lines, points = points,
            proj = "bonne", parameters = 40)
# finer interpolation grid
ggautoimage(x, y, z, f, lines = lines, points = points,
            interp.args = list(no.X = 100, no.Y = 100))

## End(Not run)
</code></pre>

<hr>
<h2 id='heat_ppoints'>Display colored scatterplot for projected coordinates</h2><span id='topic+heat_ppoints'></span>

<h3>Description</h3>

<p><code>heat_ppoints</code> plots a &quot;heated&quot; scatterplot for
(potentially) projected locations. A color scale is
automatically provided with the scatterplot. The function
is similar in purpose to <code><a href="#topic+pimage">pimage</a></code>,
but the <code>z</code>-values are not interpolated. The color
scale can be changed by passing a vector of colors to
the <code>col</code> argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heat_ppoints(
  x,
  y,
  z,
  legend = "horizontal",
  proj = "none",
  parameters,
  orientation,
  lratio = 0.2,
  map = "none",
  n = 5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="heat_ppoints_+3A_x">x</code>, <code id="heat_ppoints_+3A_y">y</code></td>
<td>
<p>Numeric vectors of coordinates at which the
values in <code>z</code> are measured.</p>
</td></tr>
<tr><td><code id="heat_ppoints_+3A_z">z</code></td>
<td>
<p>A numeric vector containing the values to be
plotted.</p>
</td></tr>
<tr><td><code id="heat_ppoints_+3A_legend">legend</code></td>
<td>
<p>A character string indicating where the
color scale should be placed.  The default is
<code>"horizontal"</code>.  The other valid options are
<code>"none"</code> and <code>"vertical"</code>.</p>
</td></tr>
<tr><td><code id="heat_ppoints_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection
should be used for the included <code>x</code> and <code>y</code>
coordinates.  The default is <code>"none"</code>.  The other
valid choices correspond to the <code>"projection"</code>
argument in the <code><a href="mapproj.html#topic+mapproject">mapproject</a></code>
function, which is used for the projection.</p>
</td></tr>
<tr><td><code id="heat_ppoints_+3A_parameters">parameters</code></td>
<td>
<p>A numeric vector specifying the values
of the <code>parameters</code> argument in the
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>.  This may be
necessary when <code>proj != "none"</code>.</p>
</td></tr>
<tr><td><code id="heat_ppoints_+3A_orientation">orientation</code></td>
<td>
<p>A vector
<code>c(latitude,longitude,rotation)</code> which describes
where the &quot;North Pole&quot; should be when computing the
projection.  See <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> for
more details.</p>
</td></tr>
<tr><td><code id="heat_ppoints_+3A_lratio">lratio</code></td>
<td>
<p>A numeric value indicating the ratio of the
smaller dimension of the legend scale to the width of
the image.  Default is <code>lratio = 0.2</code>.</p>
</td></tr>
<tr><td><code id="heat_ppoints_+3A_map">map</code></td>
<td>
<p>The name of the map to draw on the image.
Default is <code>"none"</code>.  Other options include
<code>"world"</code>, <code>"usa"</code>, <code>"state"</code>,
<code>"county"</code>, <code>"france"</code>, <code>"nz"</code> (New
Zealand), <code>"italy"</code>, <code>"lakes"</code>, and
<code>"world2"</code>, all from the <code>maps</code> package.</p>
</td></tr>
<tr><td><code id="heat_ppoints_+3A_n">n</code></td>
<td>
<p>integer giving the <em>desired</em> number of
intervals.  Non-integer values are rounded down.</p>
</td></tr>
<tr><td><code id="heat_ppoints_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+plot">plot</a></code> function.  e.g.,
<code>xlab</code>, <code>ylab</code>, <code>xlim</code>, <code>ylim</code>,
<code>zlim</code>, etc.  Additionally, arguments that can be
used to further customize the plot (like adding lines
or points), as described in Details and Examples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>proj != "none"</code>, the
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function is used to
project the <code>x</code> and <code>y</code> coordinates. In that
case, <code>proj</code> must correspond to one of the choices
for the <code>projection</code> argument in the
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function.  Necessary
arguments for <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> should be
provided via the <code>parameters</code> and <code>orientation</code>
arguments. See Examples and the
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function.
</p>
<p>Valid options for <code>legend</code> are <code>"none"</code>,
<code>"horizontal"</code>, and <code>"vertical"</code>.  If
<code>legend = "none"</code>, then no color scale is provided.
If <code>legend = "horizontal"</code>, then a color scale is
included under the plot.  If <code>legend = "vertical"</code>,
then a color scale is added to the right of the plot.
</p>
<p>Lines can be added to each plot by passing the
<code>lines</code> argument through <code>...</code>.  In that case,
<code>lines</code> should be a list with components <code>x</code>
and <code>y</code> specifying the locations to draw the lines.
The appearance of the plotted lines can be customized by
passing a named list called <code>lines.args</code> through
<code>...</code>. The components of <code>lines.args</code> should
match the arguments of <code><a href="graphics.html#topic+lines">lines</a></code>.
See Examples.
</p>
<p>Points can be added to each image by passing the
<code>points</code> argument through <code>...</code>.  In that case,
<code>points</code> should be a list with components <code>x</code>
and <code>y</code> specifying the locations to draw the points.
The appearance of the plotted points can be customized by
passing a named list called <code>points.args</code> through
<code>...</code>. The components of <code>points.args</code> should
match the components of <code><a href="graphics.html#topic+points">points</a></code>.
See Examples.
</p>
<p>Text can be added to each image by passing the
<code>text</code> argument through <code>...</code>.  In that case,
<code>text</code> should be a list with components <code>x</code> and
<code>y</code> specifying the locations to draw the text, and
<code>labels</code>, a component specifying the actual text to
write.  The appearance of the plotted text can be
customized by passing a named list called
<code>text.args</code> through <code>...</code>. The components of
<code>text.args</code> should match the components of
<code><a href="graphics.html#topic+text">text</a></code>.  See Examples.
</p>
<p>The legend scale can be modified by passing
<code>legend.axis.args</code> through <code>...</code>.  The argument
should be a named list corresponding to the arguments of
the <code><a href="graphics.html#topic+axis">axis</a></code> function.  See Examples.
</p>
<p>The plot axes can be modified by passing
<code>axis.args</code> through <code>...</code>.  The argument should
be a named list corresponding to the arguments of the
<code><a href="graphics.html#topic+axis">axis</a></code> function.  The exception to
this is that arguments <code>xat</code> and <code>yat</code> can be
specified (instead of <code>at</code>) to specify the location
of the x and y ticks.  If <code>xat</code> or <code>yat</code> are
specified, then this overrides the <code>xaxt</code> and
<code>yaxt</code> arguments, respectively.  See the
<code><a href="#topic+paxes">paxes</a></code> function to see how
<code>axis.args</code> can be used.
</p>
<p>The legend margin can be customized by passing
<code>legend.mar</code> to <code>heat_ppoints</code> through <code>...</code>.
This should be a numeric vector indicating the margins of
the legend, identical to how <code>par("mar")</code> is
specified.
</p>
<p>The various options of the labeling, axes, and legend are
largely independent.  e.g., passing <code>col.axis</code>
through <code>...</code> will not affect the axis unless it is
passed as part of the named list <code>axis.args</code>.
However, one can set the various <code>par</code> options prior
to plotting to simultaneously affect the appearance of
multiple aspects of the plot.  See Examples.  After
plotting, <code>reset.par()</code> can be used to reset the
graphics device options to their default values.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+axis">axis</a></code>,
<code><a href="#topic+pimage">pimage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(co, package = "gear")
# heated scatterplot for data on an irregular grid
heat_ppoints(co$lon, co$lat, co$Al, legend = "v", map = "state")
reset.par()

# change color scale
heat_ppoints(co$lon, co$lat, co$Al, col = cm.colors(5))
reset.par()

# Use custom border, x and y limits, breaks for legend axis
data(copoly)
heat_ppoints(co$lon, co$lat, co$Al, legend = "h",
       xlab = "longitude", ylab = "latitude",
       proj = "bonne", parameters = 40,
       lines = copoly,
       lines.args = list(lwd = 2, col = "grey"),
       xlim = c(-109.1, -102),
       ylim = c(36.8, 41.1),
       breaks = seq(0, 10, len = 6))
reset.par()
</code></pre>

<hr>
<h2 id='inarccap'>Interpolated maximum daily surface air temperatures on a regular grid.</h2><span id='topic+inarccap'></span><span id='topic+ilon'></span><span id='topic+ilat'></span><span id='topic+itasmax'></span>

<h3>Description</h3>

<p>These data are the <code>narccap</code> data interpolated onto a regular 
140<code class="reqn">\times</code>115 grid using the <code>akima::interp</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(inarccap)
</code></pre>


<h3>Format</h3>

<p>Contains: </p>
 
<dl>
<dt>ilon</dt><dd><p>A vector of of longitude coordinates.</p>
</dd> 
<dt>ilat</dt><dd><p>A vector of latitude coordinates.</p>
</dd> 
<dt>itasmax</dt><dd><p>A 140<code class="reqn">\times</code>115<code class="reqn">\times</code>5 array of tasmax values.</p>
</dd> </dl>



<h3>See Also</h3>

<p><code><a href="#topic+narccap">narccap</a></code>, <code>akima::interp</code>
</p>

<hr>
<h2 id='legend.scale'>Color scale legend</h2><span id='topic+legend.scale'></span>

<h3>Description</h3>

<p><code>legend.scale</code> plots a color gradient with an associated 
quantitative scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>legend.scale(
  zlim,
  col = colorspace::sequential_hcl(n = 12, palette = "Viridis"),
  horizontal = TRUE,
  breaks,
  axis.args
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="legend.scale_+3A_zlim">zlim</code></td>
<td>
<p>A two-dimensional vector containing the minimum and 
maximum quantitative limits, respectively, for the color scale.</p>
</td></tr>
<tr><td><code id="legend.scale_+3A_col">col</code></td>
<td>
<p>A vector of colors used for the color scale. Typically, 
this is a gradient of colors. The default is the 12 colors 
generated by <code>colorspace::sequential_hcl(n = 12, palette = "Viridis")</code>.</p>
</td></tr>
<tr><td><code id="legend.scale_+3A_horizontal">horizontal</code></td>
<td>
<p>A logical value indicating whether the legend 
should extend horizontally (<code>TRUE</code>) or vertically 
(<code>FALSE</code>). The default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="legend.scale_+3A_breaks">breaks</code></td>
<td>
<p>The sequence of values defining the partition of 
<code>zlim</code>.  The length should be one more than then number of 
colors.  If not specified, then equidistant breaks are used.</p>
</td></tr>
<tr><td><code id="legend.scale_+3A_axis.args">axis.args</code></td>
<td>
<p>A list of named elements corresponding to the 
arguments of the <code><a href="graphics.html#topic+axis">axis</a></code> function.  This is 
used to modify the appearance of the scale of the legend.  See 
Examples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The length of the <code>col</code> vector indicates the number of 
partitions for the quantitative range.
</p>


<h3>References</h3>

<p>The code for this function is derived from the 
internals of the <code><a href="fields.html#topic+image.plot">image.plot</a></code> function 
written by Doug Nychka and from the <code>image.scale</code> function 
written by Marc Taylor and discussed at 
<a href="https://menugget.blogspot.com/2013/12/new-version-of-imagescale-function.html">https://menugget.blogspot.com/2013/12/new-version-of-imagescale-function.html</a>.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+image">image</a></code>, 
<code><a href="fields.html#topic+image.plot">image.plot</a></code>, <code><a href="graphics.html#topic+axis">axis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># default horizontal scale
legend.scale(c(0, 1))

# default vertical scale
legend.scale(c(0, 1), horizontal = FALSE)

# different color scheme with 24 colors
legend.scale(c(0, 1), col = cm.colors(24))

# irregular color breaks
legend.scale(c(0, 1), col = heat.colors(4), 
             breaks = c(0, 0.5, 0.75, 0.875, 1))

# irregular color breaks with modified ticks and vertical 
# orientation of labels
legend.scale(c(0, 1), col = heat.colors(4),
             breaks = c(0, 0.5, 0.75, 0.875, 1),
             axis.args = list(at = c(0, 0.5, 0.75, 0.875, 1), las = 2))

# change size of axis labels
legend.scale(c(0, 1), axis.args = list(cex.axis = 2))

# change color of axis labels and ticks
blue.axes &lt;- list(col.axis = "blue", col.ticks = "blue")
legend.scale(c(0, 1), axis.args = blue.axes)

# log base 10 values with colors labeled on original scale
options(scipen = 2)
log.axis &lt;- list(at = 0:6, labels = 10^(0:6), las = 2)
legend.scale(c(0, 6), col = heat.colors(6), axis.args = log.axis)
</code></pre>

<hr>
<h2 id='narccap'>Maximum daily surface air temperatures on a grid.</h2><span id='topic+narccap'></span><span id='topic+lon'></span><span id='topic+lat'></span><span id='topic+tasmax'></span>

<h3>Description</h3>

<p>These data are taken from the North American Regional 
Climate Change Assessment Program (NARCCAP). Specifically, the data 
provide maximum daily surface air temperature (K) (abbreviated 
tasmax) for locations in the United States, Mexico, and Canada 
for the five consecutive days of May 15, 2041 to May 19, 2041
simulated using the Canadian Regional Climate Model (Caya and
Laprise, 1999) forced by the Community Climate System Model
atmosphere-ocean general circular model (Collins et al., 2006)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(narccap)
</code></pre>


<h3>Format</h3>

<p>Contains: </p>
 <dl>
<dt>lon</dt><dd><p>A 140<code class="reqn">\times</code>115 matrix
of longitude coordinates.</p>
</dd> <dt>lat</dt><dd><p>A 140<code class="reqn">\times</code>115 matrix
of latitude coordinates.</p>
</dd> <dt>tasmax</dt><dd><p>A
140<code class="reqn">\times</code>115<code class="reqn">\times</code>5 array of tasmax values.</p>
</dd> </dl>



<h3>Source</h3>

<p>The National Center for Atmospheric Research (NCAR) through the 
North American Regional Climate Change Assessment Program (NARCCAP) 
&lt;doi:10.5065/D6RN35ST&gt;.
</p>


<h3>References</h3>

<p>Mearns, L.O., et al., 2007, updated 2012. The North
American Regional Climate Change Assessment Program dataset,
National Center for Atmospheric Research Earth System Grid data
portal, Boulder, CO. Data downloaded 2016-08-12.
&lt;doi:10.5065/D6RN35ST&gt;.
</p>
<p>Mearns, L. O., W. J. Gutowski, R. Jones, L.-Y. Leung, S.
McGinnis, A. M. B. Nunes, and Y. Qian: A regional climate change
assessment program for North America. EOS, Vol. 90, No. 36, 8
September 2009, pp. 311-312.
</p>
<p>D. Caya and R. Laprise. A semi-implicit semi-Lagrangian regional
climate model: The Canadian RCM. Monthly Weather Review,
127(3):341-362, 1999. 
</p>
<p>M. Collins, B. B. Booth, G. R. Harris, J.M. Murphy, D. M. Sexton, 
and M. J. Webb. Towards quantifying uncertainty in transient 
climate change. Climate Dynamics, 27(2-3):127-147, 2006.
</p>

<hr>
<h2 id='parrows'>Projected arrows function</h2><span id='topic+parrows'></span>

<h3>Description</h3>

<p><code>parrows</code> takes pairs of coordinates and draws arrows between 
them, possibly after projection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parrows(x0, y0, x1 = x0, y1 = y0, proj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parrows_+3A_x0">x0</code>, <code id="parrows_+3A_y0">y0</code></td>
<td>
<p>coordinates of points from which to draw.</p>
</td></tr>
<tr><td><code id="parrows_+3A_x1">x1</code>, <code id="parrows_+3A_y1">y1</code></td>
<td>
<p>coordinates of points to which to draw</p>
</td></tr>
<tr><td><code id="parrows_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function, which is used for the
projection.</p>
</td></tr>
<tr><td><code id="parrows_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the 
<code><a href="graphics.html#topic+arrows">arrows</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function is used for 
projection.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+arrows">arrows</a></code>, 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>, 
<code><a href="#topic+pimage">pimage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(narccap)
# plot image using bonne projection (w/o grid lines)
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 40, paxes.args = list(grid = FALSE))
# load some data for larger U.S. cities
data(us.cities, package = "maps")
cityxy &lt;- list(x = us.cities$long[1:5], y = us.cities$lat[1:5])
parrows(cityxy$x[1:4], cityxy$y[1:4], cityxy$x[2:5], cityxy$y[2:5], 
        proj = "bonne", col = "orange")
</code></pre>

<hr>
<h2 id='paxes'>Display axes for projected coordinates</h2><span id='topic+paxes'></span>

<h3>Description</h3>

<p><code>paxes</code> addes x and y axes to an existing plot for projected
coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paxes(proj, xlim, ylim, xaxp, yaxp, grid = TRUE, axis.args, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="paxes_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function, which is used for the
projection.</p>
</td></tr>
<tr><td><code id="paxes_+3A_xlim">xlim</code></td>
<td>
<p>A vector with the minimum and maximum value of the x
coordinates.  Taken from <code>par("usr")</code> if not provided.</p>
</td></tr>
<tr><td><code id="paxes_+3A_ylim">ylim</code></td>
<td>
<p>A vector with the minimum and maximum value of the y
coordinates.  Taken from <code>par("usr")</code> if not provided.</p>
</td></tr>
<tr><td><code id="paxes_+3A_xaxp">xaxp</code></td>
<td>
<p>A vector of the form <code>c(x1, x2, n)</code> giving the 
coordinates of the extreme tick marks and the number of intervals
between tick marks.  Overrides <code>xlim</code>.</p>
</td></tr>
<tr><td><code id="paxes_+3A_yaxp">yaxp</code></td>
<td>
<p>A vector of the form <code>c(x1, x2, n)</code> giving the 
coordinates of the extreme tick marks and the number of intervals
between tick marks.  Overrides <code>ylim</code>.</p>
</td></tr>
<tr><td><code id="paxes_+3A_grid">grid</code></td>
<td>
<p>A logical value indicating whether grid lines should be
displayed with the axes.  Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="paxes_+3A_axis.args">axis.args</code></td>
<td>
<p>A named list with components matching the
arguments of <code><a href="graphics.html#topic+axis">axis</a></code>.  See Details and 
Examples.</p>
</td></tr>
<tr><td><code id="paxes_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the <code>[graphics]{lines}</code> 
function used to plot the grid lines.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function is used for
projection.
</p>
<p><code>axis.args</code> should be a named list matching the arguments
of <code><a href="graphics.html#topic+axis">axis</a></code>.  The exception is that
<code>xat</code> and <code>yat</code> can be specified to induce
different spacing of the ticks on the x and y axes.  Thus,
the <code>at</code> argument is ignored and replaced by <code>xat</code> and
<code>yat</code>, as appropriate.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+image">image</a></code>,
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(narccap)
# plot image using mercator projection (w/o axes)
pimage(lon, lat, tasmax[,,1], proj = "mercator", axes = FALSE)
# add axes with grey grid lines, blue text, and custom spacing
paxes("mercator", xlim = range(lon), ylim = range(lat), 
      col = "grey", 
      axis.args = list(col.axis = "blue", 
                       xat = c(-160, -100, -90, -80, -20)))
</code></pre>

<hr>
<h2 id='pimage'>Display image for projected coordinates</h2><span id='topic+pimage'></span>

<h3>Description</h3>

<p><code>pimage</code> plots an image for (potentially) projected locations.
A color scale is automatically provided with the image. The 
function is essentially an extension of the 
<code><a href="graphics.html#topic+image">image</a></code> function and the <code>x</code> and 
<code>y</code> locations can be irregularly-spaced locations, sequences 
of increasing values for locations on a regular grid, or matrices 
(with dimensions matching those of <code>z</code>) for locations on an 
irregular grid.  Functionality for automatic projection is 
provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pimage(
  x,
  y,
  z,
  legend = "horizontal",
  proj = "none",
  parameters,
  orientation,
  lratio = 0.2,
  map = "none",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pimage_+3A_x">x</code>, <code id="pimage_+3A_y">y</code></td>
<td>
<p>Locations of grid points at which the values in <code>z</code>
are measured.  The values must be finite and non-missing.  These 
arguments can be either vectors or matrices depending on the type
of data to be displayed.  See Details.</p>
</td></tr>
<tr><td><code id="pimage_+3A_z">z</code></td>
<td>
<p>A numeric or logical vector or matrix containing the 
values to be plotted (NAs are allowed).</p>
</td></tr>
<tr><td><code id="pimage_+3A_legend">legend</code></td>
<td>
<p>A character string indicating where the color scale 
should be placed.  The default is <code>"horizontal"</code>.  The other
valid options are <code>"none"</code> and <code>"vertical"</code>.</p>
</td></tr>
<tr><td><code id="pimage_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function, which is used for the
projection.</p>
</td></tr>
<tr><td><code id="pimage_+3A_parameters">parameters</code></td>
<td>
<p>A numeric vector specifying the values of the 
<code>parameters</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>.  This may be necessary when
<code>proj != "none"</code>.</p>
</td></tr>
<tr><td><code id="pimage_+3A_orientation">orientation</code></td>
<td>
<p>A vector <code>c(latitude,longitude,rotation)</code> 
which describes where the &quot;North Pole&quot; should be when computing 
the projection.  See <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> for more
details.</p>
</td></tr>
<tr><td><code id="pimage_+3A_lratio">lratio</code></td>
<td>
<p>A numeric value indicating the ratio of the smaller 
dimension of the legend scale to the width of the image.  Default
is <code>lratio = 0.2</code>.</p>
</td></tr>
<tr><td><code id="pimage_+3A_map">map</code></td>
<td>
<p>The name of the map to draw on the image. Default is 
<code>"none"</code>.  Other options include <code>"world"</code>, 
<code>"usa"</code>, <code>"state"</code>, <code>"county"</code>, <code>"france"</code>, 
<code>"nz"</code> (New Zealand), <code>"italy"</code>, <code>"lakes"</code>, and
<code>"world2"</code>, all from the <code>maps</code> package.</p>
</td></tr>
<tr><td><code id="pimage_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the 
<code><a href="graphics.html#topic+image">image</a></code> or <code><a href="fields.html#topic+poly.image">poly.image</a></code>
functions.  e.g., <code>xlab</code>, <code>ylab</code>, <code>xlim</code>, 
<code>ylim</code>, <code>zlim</code>, etc.  Additionally, arguments that can 
be used to further customize the plot (like adding lines or 
points), as described in Details and Examples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code>, <code>y</code>, and <code>z</code> are numeric vectors of the same
length, then the <code><a href="MBA.html#topic+mba.surf">mba.surf</a></code> function is used to 
predict the response on a regular grid using multilevel
B-splines before constructing 
the image.  This interpolation can be customized by passing 
<code>interp.args</code> through <code>...</code>.  <code>interp.args</code> should 
be a named list with component matching the non <code>xyz</code>
arguments of the <code><a href="MBA.html#topic+mba.surf">mba.surf</a></code> function.
</p>
<p>If <code>x</code> are <code>y</code> are vectors of increasing values and 
<code>nrow(z) == length(x)</code> and <code>ncol(z) == length(y)</code>, then 
an image on a regular grid is constructed.
</p>
<p>If <code>x</code>, <code>y</code> and <code>z</code> are matrices with the same 
dimensions, then an image for irregularly gridded data is 
constructed.
</p>
<p>When <code>proj != "none"</code>, the <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> 
function is used to project the <code>x</code> and <code>y</code> coordinates. 
In that case, <code>proj</code> must correspond to one of the choices for
the <code>projection</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function.  Necessary arguments 
for <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> should be provided via the 
<code>parameters</code> and <code>orientation</code> arguments. See Examples 
and the <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function.
</p>
<p>Valid options for <code>legend</code> are <code>"none"</code>, 
<code>"horizontal"</code>, and <code>"vertical"</code>.  If <code>legend = 
"none"</code>, then no color scale is provided.  If <code>legend = 
"horizontal"</code>, then a color scale is included under the image.  If 
<code>legend = "vertical"</code>, then a color scale is added to the 
right of the image.
</p>
<p>Lines can be added to each image by passing the <code>lines</code> 
argument through <code>...</code>.  In that case, <code>lines</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the lines.  The appearance of the plotted lines
can be customized by passing a named list called <code>lines.args</code>
through <code>...</code>. The components of <code>lines.args</code> should match
the arguments of <code><a href="graphics.html#topic+lines">lines</a></code>.  See Examples.
</p>
<p>Points can be added to each image by passing the <code>points</code> 
argument through <code>...</code>.  In that case, <code>points</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the points.  The appearance of the plotted points
can be customized by passing a named list called <code>points.args</code>
through <code>...</code>. The components of <code>points.args</code> should match
the components of <code><a href="graphics.html#topic+points">points</a></code>.  See Examples.
</p>
<p>Text can be added to each image by passing the <code>text</code> 
argument through <code>...</code>.  In that case, <code>text</code> should be
a list with components <code>x</code> and <code>y</code> specifying the
locations to draw the text, and <code>labels</code>, a component
specifying the actual text to write.  The appearance of the plotted text
can be customized by passing a named list called <code>text.args</code>
through <code>...</code>. The components of <code>text.args</code> should match
the components of <code><a href="graphics.html#topic+text">text</a></code>.  See Examples.
</p>
<p>The legend scale can be modified by passing <code>legend.axis.args</code>
through <code>...</code>.  The argument should be a named list 
corresponding to the arguments of the <code><a href="graphics.html#topic+axis">axis</a></code> 
function.  See Examples.
</p>
<p>The image axes can be modified by passing <code>axis.args</code> through
<code>...</code>.  The argument should be a named list corresponding to
the arguments of the <code><a href="graphics.html#topic+axis">axis</a></code> function.  The
exception to this is that arguments <code>xat</code> and <code>yat</code> can
be specified (instead of <code>at</code>) to specify the location of the
x and y ticks.  If <code>xat</code> or <code>yat</code> are specified, then
this overrides the <code>xaxt</code> and <code>yaxt</code> arguments,
respectively.  See the <code><a href="#topic+paxes">paxes</a></code> function to
see how <code>axis.args</code> can be used.
</p>
<p>The legend margin can be customized by passing <code>legend.mar</code> to
<code>pimage</code> through <code>...</code>.  This should be a numeric vector
indicating the margins of the legend, identical to how 
<code>par("mar")</code> is specified.
</p>
<p>The various options of the labeling, axes, and legend are largely
independent.  e.g., passing <code>col.axis</code> through <code>...</code> 
will not affect the axis unless it is passed as part of the 
named list <code>axis.args</code>.  However, one can set the various
<code>par</code> options prior to plotting to simultaneously
affect the appearance of multiple aspects of the plot.  See 
Examples.  After plotting, <code>reset.par()</code> can be used to reset 
the graphics device options to their default values.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+image">image</a></code>, 
<code><a href="fields.html#topic+image.plot">image.plot</a></code>, <code><a href="graphics.html#topic+axis">axis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># image plot for data on an irregular grid
pimage(lon, lat, tasmax[,,1], legend = "h", map = "world")
# same plot but with projection and vertical legend
pimage(lon, lat, tasmax[,,1], legend = "v", map = "world", 
       proj = "bonne", parameters = 45)
# different projection
pimage(lon, lat, tasmax[,,1], proj = "albers",
       parameters = c(33, 45), map = "world")

reset.par() # reset graphics device
# image plot for non-gridded data
data(co, package = "gear")
pimage(co$longitude, co$latitude, co$Al)

# show observed locations on image,
# along with Colorado border, locations of Denver and Colorado 
# Springs
data(copoly)
copoints &lt;- list(x = co$lon, y = co$lat)
pimage(co$longitude, co$latitude, co$Al, 
       lines = copoly, 
       lines.args = list(lwd = 2, col = "grey"),
       points = copoints, 
       points.args = list(pch = 21, bg = "white"),
       text = list(x = c(-104.98, -104.80), y = c(39.74, 38.85), 
                   labels = c("Denver", "Colorado Springs")), 
       text.args = list(col = "purple"),
       xlim = c(-109.1, -102),
       ylim = c(36.8, 41.1))

# image plot for data on irregular grid
# notice the poor axis labeling
data(narccap)
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 45, map = "world")
# same plot but customize axis labeling 
# need to extend horizontally-running axis lines
# farther to the west and east
# also need the vertically-running lines
# to run further north/sount
# will need manual adjusting depending on size
# of current device 
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 45, map = "world", 
       xaxp = c(-200, 0, 10), yaxp = c(-10, 80, 9))

# the same effect can be acheived by specifying axis.args
# we also modify the color and size of the axis labels
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 45, map = "world", 
       axis.args = list(xat = seq(-200, 0, by = 20),
                        yat = seq(0, 70, by = 10),
                        col.axis = "blue", 
                        cex.axis = 0.5))

# modify colors of legend, map, line type for grid lines
# and customize axis
pimage(lon, lat, tasmax[,,1], 
       legend = "v", proj = "bonne", parameters = 45,
       map = "state",
       paxes.args = list(lty = 3),
       legend.axis.args = list(col = "blue", col.axis = "blue"),
       col = fields::tim.colors(64),
       xlab = "longitude",
       ylab = "latitude",
       main = "temperature (K)")
reset.par() # reset graphics device

# change many aspects of plot appearance using par
par(cex.axis = 0.5, cex.lab = 0.5, mgp = c(1.5, 0.5, 0),
    mar = c(2.1, 2.1, 4.1, 0.2), col.axis = "orange",
    col.main = "blue", family = "mono")
pimage(lon, lat, tasmax[,,1])
title("very customized plot")
reset.par()

</code></pre>

<hr>
<h2 id='plines'>Projected lines function</h2><span id='topic+plines'></span>

<h3>Description</h3>

<p><code>plines</code> takes coordinates and joins the corresponding points
with line segments, possibly after projection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plines(x, y = NULL, type = "l", proj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plines_+3A_x">x</code></td>
<td>
<p>coordinate vectors of points to join.</p>
</td></tr>
<tr><td><code id="plines_+3A_y">y</code></td>
<td>
<p>coordinate vectors of points to join.</p>
</td></tr>
<tr><td><code id="plines_+3A_type">type</code></td>
<td>
<p>character indicating the type of plotting; actually any of
the <code>type</code>s as in <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="plines_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function, which is used for the
projection.</p>
</td></tr>
<tr><td><code id="plines_+3A_...">...</code></td>
<td>
<p>Further graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>) may
also be supplied as arguments, particularly, line type, <code>lty</code>,
line width, <code>lwd</code>, color, <code>col</code> and for <code>type = "b"</code>,
<code>pch</code>.  Also the line characteristics <code>lend</code>, <code>ljoin</code>
and <code>lmitre</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function is used for
projection.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pimage">pimage</a></code>,
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>, <code><a href="graphics.html#topic+lines">lines</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(narccap)
# plot image using bonne projection (w/o grid lines)
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 40, paxes.args = list(grid = FALSE))
# get national boundaries
data(worldMapEnv, package = "maps")
worldpoly &lt;- maps::map("world", plot = FALSE)
# add boundaries to existing plot
plines(worldpoly, proj = "bonne")
</code></pre>

<hr>
<h2 id='ppoints'>Projected points function</h2><span id='topic+ppoints'></span>

<h3>Description</h3>

<p><code>ppoints</code> draws a sequence of points for projected 
coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppoints(x, y = NULL, type = "p", proj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ppoints_+3A_x">x</code></td>
<td>
<p>coordinate vectors of points to plot.</p>
</td></tr>
<tr><td><code id="ppoints_+3A_y">y</code></td>
<td>
<p>coordinate vectors of points to plot.</p>
</td></tr>
<tr><td><code id="ppoints_+3A_type">type</code></td>
<td>
<p>character indicating the type of plotting; actually any of
the <code>type</code>s as in <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="ppoints_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function, which is used for the
projection.</p>
</td></tr>
<tr><td><code id="ppoints_+3A_...">...</code></td>
<td>
<p>Further graphical parameters passed to the 
<code><a href="graphics.html#topic+points">points</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function is used for 
projection.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+points">points</a></code>, 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>, 
<code><a href="#topic+pimage">pimage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(narccap)
# plot image using bonne projection (w/o grid lines)
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 40, paxes.args = list(grid = FALSE))
# get U.S. cities with population of about 40k or more
data(us.cities, package = "maps")
# add cities to existing plot
ppoints(us.cities$long, us.cities$lat, proj = "bonne")
</code></pre>

<hr>
<h2 id='ppolygon'>Projected polygon function</h2><span id='topic+ppolygon'></span>

<h3>Description</h3>

<p><code>ptext</code> draws polygons using the vertices given in <code>x</code> 
and <code>y</code>, possibly with projected coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppolygon(x, y = NULL, proj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ppolygon_+3A_x">x</code></td>
<td>
<p>vectors containing the coordinates of the vertices
of the polygon.</p>
</td></tr>
<tr><td><code id="ppolygon_+3A_y">y</code></td>
<td>
<p>vectors containing the coordinates of the vertices
of the polygon.</p>
</td></tr>
<tr><td><code id="ppolygon_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function, which is used for the
projection.</p>
</td></tr>
<tr><td><code id="ppolygon_+3A_...">...</code></td>
<td>
<p>graphical parameters such as <code>xpd</code>, <code>lend</code>,
<code>ljoin</code> and <code>lmitre</code> can be given as arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function is used for 
projection.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+polygon">polygon</a></code>, 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>, 
<code><a href="#topic+pimage">pimage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(narccap)
# plot image using bonne projection (w/o grid lines)
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 40, paxes.args = list(col = "grey"))
# filled polygon for Colorado border
data(copoly)
ppolygon(copoly, proj = "bonne", col = "orange")
</code></pre>

<hr>
<h2 id='psegments'>Projected segments function</h2><span id='topic+psegments'></span>

<h3>Description</h3>

<p><code>psegments</code> takes pairs of coordinates and draws line segments
between them, possibly after projection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psegments(x0, y0, x1 = x0, y1 = y0, proj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="psegments_+3A_x0">x0</code>, <code id="psegments_+3A_y0">y0</code></td>
<td>
<p>coordinates of points from which to draw.</p>
</td></tr>
<tr><td><code id="psegments_+3A_x1">x1</code>, <code id="psegments_+3A_y1">y1</code></td>
<td>
<p>coordinates of points to which to draw</p>
</td></tr>
<tr><td><code id="psegments_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function, which is used for the
projection.</p>
</td></tr>
<tr><td><code id="psegments_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to the 
<code><a href="graphics.html#topic+segments">segments</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function is used for 
projection.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+segments">segments</a></code>, 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>, 
<code><a href="#topic+pimage">pimage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(narccap)
# plot image using bonne projection (w/o grid lines)
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 40, paxes.args = list(grid = FALSE))
# some locations for u.s. cities
# taken from data(us.cities, package = "maps")
boston &lt;- c(-71.02, 42.34)
la &lt;- c(-118.41, 34.11)
ny &lt;- c(-73.94, 40.67)
sf &lt;- c(-122.45, 37.77)
# plot segments between sf, la and ny boston
x0 &lt;- c(sf[1], ny[1])
y0 &lt;- c(sf[2], ny[2])
x1 &lt;- c(la[1], boston[1])
y1 &lt;- c(la[2], boston[2])
psegments(x0, y0, x1, y1, proj = "bonne", lwd = 3)
citycoords &lt;- rbind(sf, la, ny, boston)
cityxy &lt;- list(x = citycoords[,1], y = citycoords[,2])
citynames &lt;- c("san francisco", "los angeles", "new york", "boston") 
ptext(cityxy, labels = citynames, proj = 'bonne')
</code></pre>

<hr>
<h2 id='ptext'>Projected text function</h2><span id='topic+ptext'></span>

<h3>Description</h3>

<p><code>ptext</code> draws the character strings given in <code>labels</code> at
the provided coordinates, possibly after projection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ptext(x, y = NULL, labels, proj, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ptext_+3A_x">x</code></td>
<td>
<p>numeric vectors of coordinates where the text
<code>labels</code> should be written.  If the length of <code>x</code> and
<code>y</code> differs, the shorter one is recycled.</p>
</td></tr>
<tr><td><code id="ptext_+3A_y">y</code></td>
<td>
<p>numeric vectors of coordinates where the text
<code>labels</code> should be written.  If the length of <code>x</code> and
<code>y</code> differs, the shorter one is recycled.</p>
</td></tr>
<tr><td><code id="ptext_+3A_labels">labels</code></td>
<td>
<p>a character vector or <a href="base.html#topic+expression">expression</a> specifying
the <em>text</em> to be written.  An attempt is made to coerce other
language objects (names and calls) to expressions, and vectors and
other classed objects to character vectors by <code><a href="base.html#topic+as.character">as.character</a></code>.
If <code>labels</code> is longer than <code>x</code> and
<code>y</code>, the coordinates are recycled to the length of <code>labels</code>.</p>
</td></tr>
<tr><td><code id="ptext_+3A_proj">proj</code></td>
<td>
<p>A character string indicating what projection should be
used for the included <code>x</code> and <code>y</code> coordinates.  The 
default is <code>"none"</code>.  The other valid choices correspond to 
the <code>"projection"</code> argument in the 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function, which is used for the
projection.</p>
</td></tr>
<tr><td><code id="ptext_+3A_...">...</code></td>
<td>
<p>further <a href="graphics.html#topic+graphical+20parameters">graphical parameters</a> (from <code><a href="graphics.html#topic+par">par</a></code>),
such as <code>srt</code>, <code>family</code> and <code>xpd</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="mapproj.html#topic+mapproject">mapproject</a></code> function is used for 
projection.
</p>
<p>A non-character <code>labels</code> argument is automatically converted 
to a <code>character</code> vector using <code>link[base]{as.character}</code>.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+text">text</a></code>, 
<code><a href="mapproj.html#topic+mapproject">mapproject</a></code>,
<code><a href="#topic+pimage">pimage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(narccap)
# plot image using bonne projection (w/o grid lines)
pimage(lon, lat, tasmax[,,1], proj = "bonne",
       parameters = 40, paxes.args = list(grid = FALSE))
# get national boundaries
data(worldMapEnv, package = "maps")
worldpoly &lt;- maps::map("world", plot = FALSE)
plines(worldpoly, proj = "bonne")
# add U.S. city names to existing plot
data(us.cities, package = "maps")
citysmall &lt;- head(us.cities)
ptext(x = citysmall$lon, y = citysmall$lat, 
      labels = citysmall$name, proj = "bonne")
</code></pre>

<hr>
<h2 id='reset.par'>Reset par</h2><span id='topic+reset.par'></span>

<h3>Description</h3>

<p><code>reset.par</code> resets the arguments of
<code><a href="graphics.html#topic+par">par</a></code> to the default values when first
opening R (as of version 3.2.2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reset.par()
</code></pre>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+par">par</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par("mar") #current values of mar
par(mar = c(0, 0, 0, 0)) # change values of mar
par("mar") # changed values of mar
reset.par() # reset to defaults (not necessarilly current values)
par("mar") # should be c(5.1, 4.1, 4.1, 2.1)
</code></pre>

<hr>
<h2 id='rotate'>Rotate coordinates</h2><span id='topic+rotate'></span>

<h3>Description</h3>

<p><code>rotate</code> rotates the coordinates by angle theta around a pivot
point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rotate(coords, theta, pivot = c(0, 0))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rotate_+3A_coords">coords</code></td>
<td>
<p>A 2-column matrix with the coordinates to be rotated.</p>
</td></tr>
<tr><td><code id="rotate_+3A_theta">theta</code></td>
<td>
<p>The angle (in radians) to rotate the coordinates.</p>
</td></tr>
<tr><td><code id="rotate_+3A_pivot">pivot</code></td>
<td>
<p>The pivot point around which the coordinates are 
rotated. Default is c(0, 0), i.e., the origin.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># coordinates to rotate
coords &lt;- matrix(rnorm(20), ncol = 2)
# rotate coordinates pi/6 radians around the original
rcoords &lt;- rotate(coords, pi/6)
#compare original coordinates to rotated coordinates
par(mfrow = c(1, 2))
plot(coords)
plot(rcoords)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
