<!DOCTYPE html><html lang="en"><head><title>Help for package MplusLGM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MplusLGM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fitGBTM'><p>Fit Group-Based Trajectory Models (GBTM) for class enumeration.</p></a></li>
<li><a href='#fitGCM'><p>Fit Growth Curve Models (GCM)</p></a></li>
<li><a href='#fitLCGA'><p>Fit Latent Class Growth Analysis (LCGA) models to refine covariance structure.</p></a></li>
<li><a href='#getBest'><p>Select best-fitting model from a list of Latent Growth Models (LGM)</p></a></li>
<li><a href='#getFit'><p>Get fit indices from Latent Growth Models (LGM)</p></a></li>
<li><a href='#getPoly'><p>Refine Polynomial Order in Latent Growth Modelling (LGM)</p></a></li>
<li><a href='#getSpaghetti'><p>Plot individual trajectories of outcome - Spaghetti plot</p></a></li>
<li><a href='#LGMobject'><p>Create Mplus model objects for Latent Growth Modelling (LGM)</p></a></li>
<li><a href='#runLGM'><p>Run Latent Growth Models (LGM) and replicate the best loglikelihood value (LL)</p></a></li>
<li><a href='#symptoms'><p>Symptoms Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Automate Latent Growth Mixture Modelling in 'Mplus'</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provide a suite of functions for conducting and automating Latent Growth Modeling (LGM) in 'Mplus', including Growth Curve Model (GCM), Growth-Based Trajectory Model (GBTM) and Latent Class Growth Analysis (LCGA). 
  The package builds upon the capabilities of the 'MplusAutomation' package (Hallquist &amp; Wiley, 2018) to streamline large-scale latent variable analyses. 
  “MplusAutomation: An R Package for Facilitating Large-Scale Latent Variable Analyses in Mplus.” Structural Equation Modeling, 25(4), 621–638. &lt;<a href="https://doi.org/10.1080%2F10705511.2017.1402334">doi:10.1080/10705511.2017.1402334</a>&gt;
  The workflow implemented in this package follows the recommendations outlined in Van Der Nest et al. (2020). 
  “An Overview of Mixture Modeling for Latent Evolutions in Longitudinal Data: Modeling Approaches, Fit Statistics, and Software.” Advances in Life Course Research, 43, Article 100323. &lt;<a href="https://doi.org/10.1016%2Fj.alcr.2019.100323">doi:10.1016/j.alcr.2019.100323</a>&gt;. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0),</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>MplusAutomation, magrittr, tibble, dplyr, tidyr, tidyselect,
stringr, purrr, ggplot2, glue, parallel</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/OlivierPDS/MplusLGM">https://github.com/OlivierPDS/MplusLGM</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/OlivierPDS/MplusLGM/issues">https://github.com/OlivierPDS/MplusLGM/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-01 20:20:08 UTC; olivierpercie</td>
</tr>
<tr>
<td>Author:</td>
<td>Olivier Percie du Sert
    <a href="https://orcid.org/0000-0002-6283-2529"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph],
  Joshua Unrau [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Olivier Percie du Sert &lt;olivier.perciedusert@mail.mcgill.ca&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-03 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fitGBTM'>Fit Group-Based Trajectory Models (GBTM) for class enumeration.</h2><span id='topic+fitGBTM'></span>

<h3>Description</h3>

<p>Perform class enumeration by fitting a series of GBTM in Mplus across a predetermined range of classes,
and returning a list of fitted models for evaluation and comparison.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitGBTM(
  data,
  outvar,
  catvar = FALSE,
  idvar,
  min_k = 2L,
  max_k = 6L,
  starting_val = 500,
  polynomial = 1,
  timescores,
  timescores_indiv = FALSE,
  estimator = c("MLR", "ML", "WLSMV", "WLS"),
  transformation = c("LOGIT", "PROBIT"),
  output = c("TECH1", "TECH11", "SAMPSTAT", "STANDARDIZED"),
  plot = "PLOT3",
  save = "FSCORES",
  wd = "Results"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitGBTM_+3A_data">data</code></td>
<td>
<p>A data frame containing all variables for the trajectory analysis.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_outvar">outvar</code></td>
<td>
<p>A character vector specifying the outcome variables at different times.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_catvar">catvar</code></td>
<td>
<p>A logical value indicating whether the outcome variable is categorical. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_idvar">idvar</code></td>
<td>
<p>A character string specifying the ID variable.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_min_k">min_k</code></td>
<td>
<p>An integer specifying the minimum number of latent classes to evaluate. Default is 2.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_max_k">max_k</code></td>
<td>
<p>An integer specifying the maximum number of latent classes to evaluate. Default is 6.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_starting_val">starting_val</code></td>
<td>
<p>A numeric value specifying the number of random starting values to generate for the initial optimization stage.
Note that the number of final stage optimizations will be set as equal to half of this value.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_polynomial">polynomial</code></td>
<td>
<p>An integer specifying the order of the polynomial used to model trajectories. Supported values are:
1 (linear), 2 (quadratic), 3 (cubic). Default is 1.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_timescores">timescores</code></td>
<td>
<p>A numeric vector specifying the time scores for the model. If <code>timescores_indiv = TRUE</code>,
a character vector should be used to specify variables with individually varying times of observation.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_timescores_indiv">timescores_indiv</code></td>
<td>
<p>A logical value indicating whether to use individually varying times of observation for the outcome variable. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_estimator">estimator</code></td>
<td>
<p>A character string to specify the estimator to use in the analysis. Default is 'MLR'.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_transformation">transformation</code></td>
<td>
<p>A character string to specify the latent response variable transformation to use when the outcome variable is categorical. Default is <code>LOGIT</code>.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_output">output</code></td>
<td>
<p>A character vector specifying the requested Mplus output options for the model.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_plot">plot</code></td>
<td>
<p>A character string specifying the requested Mplus plot options for the model. Default is PLOT3.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_save">save</code></td>
<td>
<p>A character string specifying the type of results to be saved by Mplus. Default is FSCORES.</p>
</td></tr>
<tr><td><code id="fitGBTM_+3A_wd">wd</code></td>
<td>
<p>A character string specifying the directory where the results folder will be created for saving Mplus input, output, and data files.
Default is the current working directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>fitGBTM</code> function automates the process of fitting GBTM, iterating through an increasing number of class.
This function is designed for conducting class enumeration and help identifying the optimal number of latent classes.
GBTM should converge the quickest to a solution given its lower number of free parameters when compared to other LGM.
</p>
<p>The function operates as follows:
</p>

<ul>
<li><p> 1. Iterate over an increasing number of classes, ranging from <code>min_k</code> to <code>max_k</code>.
</p>
</li>
<li><p> 2. Create GBTM <code>mplusObject</code> with appropriate class specification using the <code>LGMobject</code> function.
</p>
</li>
<li><p> 3. Fit models using the <code>runLGM</code> function, ensuring convergence by increasing the number of random starting values until the best log-likelihood is replicated.
</p>
</li>
<li><p> 4. Return a list of <code>mplusObject</code> including results for the fitted GBTM models with each class structures.
</p>
</li></ul>

<p>The function automates the procedure outlined for model selection in:
Van Der Nest et al,. (2020). &quot;An overview of mixture modelling for latent evolutions in longitudinal data: Modelling approaches, fit statistics and software.&quot;
Advances in Life Course Research 43: 100323.
</p>
<p>This function builds upon the capabilities of the <code><a href="MplusAutomation.html#topic+mplusObject">mplusObject</a></code> and <code><a href="MplusAutomation.html#topic+mplusModeler">mplusModeler</a></code> functions
from the MplusAutomation package.
</p>


<h3>Value</h3>

<p>A list of <code>mplusObject</code> including the fitted GBTM models for each class specification.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LGMobject">LGMobject</a></code> for creating the mplusObject of a latent growth model.
<code><a href="#topic+runLGM">runLGM</a></code> for conducting latent growth modelling with an mplusObject.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example usage:
GBTM_models &lt;- fitGBTM(
  data = symptoms,
  outvar = paste("sx", seq(from = 0, to = 24, by = 6), sep = "_"),
  catvar = FALSE,
  idvar = "id",
  starting_val = 500,
  min_k = 2L,
  max_k = 6L,
  timescores = seq(from = 0, to = 24, by = 6),
  timescores_indiv = FALSE,
  polynomial = 1,
  output = c("TECH1", 'TECH14', "SAMPSTAT", "STANDARDIZED"),
  plot = "PLOT3",
  save = "FSCORES",
  wd = file.path("Results", "Trajectories")
)

# Accessing the model:
GBTM2 &lt;- GBTM_models[[1]] #with 2 latent classes
GBTM3 &lt;- GBTM_models[[2]] #with 3 latent classes
GBTM4 &lt;- GBTM_models[[3]] #with 4 latent classes

</code></pre>

<hr>
<h2 id='fitGCM'>Fit Growth Curve Models (GCM)</h2><span id='topic+fitGCM'></span>

<h3>Description</h3>

<p>Customize and execute GCM in Mplus, offering flexibility in model configuration and parameter estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitGCM(
  data,
  outvar,
  catvar = FALSE,
  idvar,
  starting_val = 500,
  polynomial = 1,
  timescores = timescores,
  timescores_indiv = FALSE,
  estimator = c("MLR", "ML", "WLSMV", "WLS"),
  transformation = c("LOGIT", "PROBIT"),
  output = c("TECH1", "SAMPSTAT", "STANDARDIZED"),
  plot = "PLOT3",
  save = "FSCORES",
  wd = "Results"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitGCM_+3A_data">data</code></td>
<td>
<p>A data frame containing all variables for the trajectory analysis.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_outvar">outvar</code></td>
<td>
<p>A character vector specifying the outcome variables at different times.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_catvar">catvar</code></td>
<td>
<p>A logical value indicating whether the outcome variable is categorical. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_idvar">idvar</code></td>
<td>
<p>A character string specifying the ID variable.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_starting_val">starting_val</code></td>
<td>
<p>A numeric value specifying the number of random starting values to generate for the initial optimization stage.
Note that the number of final stage optimizations will be set as equal to half of this value.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_polynomial">polynomial</code></td>
<td>
<p>An integer specifying the order of the polynomial used to model trajectories. Supported values are:
1 (linear), 2 (quadratic), 3 (cubic). Default is 1.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_timescores">timescores</code></td>
<td>
<p>A numeric vector specifying the time scores for the model. If <code>timescores_indiv = TRUE</code>,
a character vector should be used to specify variables with individually varying times of observation.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_timescores_indiv">timescores_indiv</code></td>
<td>
<p>A logical value indicating whether to use individually varying times of observation for the outcome variable. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_estimator">estimator</code></td>
<td>
<p>A character string to specify the estimator to use in the analysis. Default is 'MLR'.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_transformation">transformation</code></td>
<td>
<p>A character string to specify the latent response variable transformation to use when the outcome variable is categorical. Default is <code>LOGIT</code>.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_output">output</code></td>
<td>
<p>A character vector specifying the requested Mplus output options for the model.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_plot">plot</code></td>
<td>
<p>A character string specifying the requested Mplus plot options for the model.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_save">save</code></td>
<td>
<p>A character string specifying the type of results to be saved by Mplus.</p>
</td></tr>
<tr><td><code id="fitGCM_+3A_wd">wd</code></td>
<td>
<p>A character string specifying the directory where the results folder will be created for saving Mplus input, output, and data files.
Default is the current working directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>fitGCM</code> function automates the process of specifying, customizing and fitting GCM in Mplus.
</p>
<p>This function builds upon the capabilities of the <code><a href="MplusAutomation.html#topic+mplusObject">mplusObject</a></code> and <code><a href="MplusAutomation.html#topic+mplusModeler">mplusModeler</a></code> functions
from the MplusAutomation package.
</p>


<h3>Value</h3>

<p>A list of class <code>mplusObject</code>s including results for the fitted GCM.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LGMobject">LGMobject</a></code> for creating the mplusObject of a latent growth model.
<code><a href="#topic+runLGM">runLGM</a></code> for conducting latent growth modelling with an mplusObject.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example usage:
GCM_model &lt;- fitGCM(
  data = symptoms,
  outvar = paste("sx", seq(from = 0, to = 24, by = 6), sep = "_"),
  catvar = FALSE,
  idvar = "id",
  starting_val = 500,
  polynomial = 3,
  timescores = seq(from = 0, to = 24, by = 6),
  timescores_indiv = FALSE,
  output = c("TECH1", "SAMPSTAT", "STANDARDIZED"),
  plot = "PLOT3",
  save = "FSCORES",
  wd = file.path("Results", "Trajectories")
  )

</code></pre>

<hr>
<h2 id='fitLCGA'>Fit Latent Class Growth Analysis (LCGA) models to refine covariance structure.</h2><span id='topic+fitLCGA'></span>

<h3>Description</h3>

<p>Refine the residual variance structure by fitting a series of LCGA models
progressively allowing for the dependence of residuals on time and/or class,
and returning a list of fitted models for evaluation and comparison.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitLCGA(
  data,
  outvar,
  catvar = FALSE,
  idvar,
  k,
  starting_val = 500,
  polynomial = 1,
  timescores,
  timescores_indiv = FALSE,
  estimator = c("MLR", "ML", "WLSMV", "WLS"),
  transformation = c("LOGIT", "PROBIT"),
  output = c("TECH1", "TECH11", "SAMPSTAT", "STANDARDIZED"),
  plot = "PLOT3",
  save = "FSCORES",
  wd = "Results"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitLCGA_+3A_data">data</code></td>
<td>
<p>A data frame containing all variables for the trajectory analysis.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_outvar">outvar</code></td>
<td>
<p>A character vector specifying the outcome variables at different times.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_catvar">catvar</code></td>
<td>
<p>A logical value indicating whether the outcome variable is categorical. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_idvar">idvar</code></td>
<td>
<p>A character string specifying the ID variable.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_k">k</code></td>
<td>
<p>An integer specifying the number of latent classes for the model.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_starting_val">starting_val</code></td>
<td>
<p>A numeric value specifying the number of random starting values to generate for the initial optimization stage.
Note that the number of final stage optimizations will be set as equal to half of this value.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_polynomial">polynomial</code></td>
<td>
<p>An integer specifying the order of the polynomial used to model trajectories. Supported values are:
1 (linear), 2 (quadratic), 3 (cubic). Default is 1.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_timescores">timescores</code></td>
<td>
<p>A numeric vector specifying the time scores for the model. If <code>timescores_indiv = TRUE</code>,
a character vector should be used to specify variables with individually varying times of observation.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_timescores_indiv">timescores_indiv</code></td>
<td>
<p>A logical value indicating whether to use individually varying times of observation for the outcome variable. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_estimator">estimator</code></td>
<td>
<p>A character string to specify the estimator to use in the analysis. Default is 'MLR'.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_transformation">transformation</code></td>
<td>
<p>A character string to specify the latent response variable transformation to use when the outcome variable is categorical. Default is <code>LOGIT</code>.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_output">output</code></td>
<td>
<p>A character vector specifying the requested Mplus output options for the model.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_plot">plot</code></td>
<td>
<p>A character string specifying the requested Mplus plot options for the model.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_save">save</code></td>
<td>
<p>A character string specifying the type of results to be saved by Mplus.</p>
</td></tr>
<tr><td><code id="fitLCGA_+3A_wd">wd</code></td>
<td>
<p>A character string specifying the directory where the results folder will be created for saving Mplus input, output, and data files.
Default is the current working directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>fitLCGA</code> function automates the process of fitting LCGA models, iterating through 3 varying residual variance specifications:
</p>

<ul>
<li><p> - Relaxed residual variance across time
</p>
</li>
<li><p> - Relaxed residual variance across class
</p>
</li>
<li><p> - Relaxed residual variance across both time and class
</p>
</li></ul>

<p>This function is designed to help identify the optimal residual variance structure while examining convergence issues as model complexity increases.
</p>
<p>The function operates as follows:
</p>

<ul>
<li><p> 1. Iterate over the 3 residual variance specifications
</p>
</li>
<li><p> 2. Create LCGA <code>mplusObject</code> with appropriate residual variance specification using the <code>LGMobject</code> function.
</p>
</li>
<li><p> 3. Fit models using the <code>runLGM</code> function, ensuring convergence by increasing the number of random starting values until the best log-likelihood is replicated.
</p>
</li>
<li><p> 4. Return a list of <code>mplusObject</code> including results for the fitted LCGA models with each residual variance structures
</p>
</li></ul>

<p>The function automates the procedure outlined for model selection in:
Van Der Nest et al., (2020). &quot;An overview of mixture modelling for latent evolutions in longitudinal data: Modelling approaches, fit statistics and software.&quot;
Advances in Life Course Research 43: 100323.
</p>
<p>This function builds upon the capabilities of the <code><a href="MplusAutomation.html#topic+mplusObject">mplusObject</a></code> and <code><a href="MplusAutomation.html#topic+mplusModeler">mplusModeler</a></code> functions
from the MplusAutomation package.
</p>


<h3>Value</h3>

<p>A list of <code>mplusObject</code> including results for the fitted LCGA models.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LGMobject">LGMobject</a></code> for creating the mplusObject of a latent growth model.
<code><a href="#topic+runLGM">runLGM</a></code> for conducting latent growth modelling with an mplusObject.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example usage:
LCGA_models &lt;- fitLCGA(
 data = symptoms,
 outvar = paste('sx', seq(from = 0, to = 24, by = 6), sep = "_"),
 catvar = FALSE,
 idvar = "id",
 starting_val = 500,
 k = 3L,
 timescores = seq(from = 0, to = 24, by = 6),
 timescores_indiv = FALSE,
 polynomial = 3,
 output = c('TECH1', 'TECH14', 'SAMPSTAT', 'STANDARDIZED'),
 wd = file.path('Results', 'Trajectories')
)

# Accessing the models:
LCGA_t &lt;- LCGA_models[[1]] #with relaxed residual variance across time
LCGA_c &lt;- LCGA_models[[2]] #with relaxed residual variance across class
LCGA_tc &lt;- LCGA_models[[3]] #with relaxed residual variance across time and class

</code></pre>

<hr>
<h2 id='getBest'>Select best-fitting model from a list of Latent Growth Models (LGM)</h2><span id='topic+getBest'></span>

<h3>Description</h3>

<p>Identify and extract the best-fitting model from a list of LGM
based on a specified set of criteria applied to a summary table of the models fit indices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBest(
  lgm_object,
  ic = c("BIC", "aBIC", "AIC", "CAIC", "AICC"),
  lrt = c("none", "aLRT", "BLRT"),
  p = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getBest_+3A_lgm_object">lgm_object</code></td>
<td>
<p>A list of LGM <code>mplusObject</code> to evaluate.</p>
</td></tr>
<tr><td><code id="getBest_+3A_ic">ic</code></td>
<td>
<p>A character string specifying the information criterion (IC) to use for selecting the best-fitting model.
Supported options are Bayesian Information Criterion (BIC), sample-size-adjusted BIC (aBIC), Akaike Information Criterion (AIC),
Consistent Akaike Information Criterion (CAIC), and AIC corrected (AICC). The default is BIC.</p>
</td></tr>
<tr><td><code id="getBest_+3A_lrt">lrt</code></td>
<td>
<p>A character string specifying the likelihood ratio test (LRT) to use for selecting the best-fitting model.
Supported options are Bootstrap LRT (BLRT) and Lo-Mendel-Rubin adjusted LRT (aLRT).
Default is &quot;none&quot;, the selection of the the best-fitting model is only made based on the selected IC.</p>
</td></tr>
<tr><td><code id="getBest_+3A_p">p</code></td>
<td>
<p>A numeric value specifying the p-value threshold for statistical significance when using LRT-based selection
of the best-fitting model. Default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function select the best-fitting model based on the following criteria:
</p>

<ul>
<li><p> 1. Models with convergence errors are excluded.
</p>
</li>
<li><p> 2. The model with the lowest information criterion (IC) is selected.
</p>
</li>
<li><p> 3. If specified, the likelihood ratio test (LRT) is used to determine whether the K-class model can be reduced to K-1 classes.
</p>
</li>
<li><p> 4. The resulting model throw a warning if it meet any of the following conditions:
</p>

<ul>
<li><p> - Entropy is below 0.5.
</p>
</li>
<li><p> - Any class has an average posterior probability of assignment (APPA) below 0.7.
</p>
</li>
<li><p> - Any class represents less than 5% of the sample size.
</p>
</li></ul>

</li></ul>



<h3>Value</h3>

<p>The LGM <code>mplusObject</code> of the best-fitting model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example usage:
GBTM_best &lt;- getBest(
  lgm_object = GBTM_models,
  ic = "BIC",
  lrt = "aLRT",
  p = 0.05
)

best_fit &lt;- getFit(GBTM_best)

print(best_fit)

</code></pre>

<hr>
<h2 id='getFit'>Get fit indices from Latent Growth Models (LGM)</h2><span id='topic+getFit'></span>

<h3>Description</h3>

<p>Extract key information from Mplus LGM objects, including model summaries,
fit statistics, class details, warnings, and errors. The function accounts for non-converging
models and compiles the extracted information into a single data frame to facilitate
model evaluation and comparison.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFit(lgm_object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getFit_+3A_lgm_object">lgm_object</code></td>
<td>
<p>A single LGM <code>mplusObject</code> or a list of LGM <code>mplusObject</code> (nested lists supported).</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> - Model summaries such as the title, log-likelihood value and  number of observations, parameters and latent classes.
</p>
</li>
<li><p> - Model fit indices such as the BIC, aBIC, AIC, AICC and CAIC along with statistics from the BLRT and adjusted LMR-LRT, if requested.
</p>
</li>
<li><p> - Latent class counts and proportions.
</p>
</li>
<li><p> - Classification confidence measures such as the average posterior probabilities (APPA) and entropy.
</p>
</li>
<li><p> - Mplus warnings or errors encountered during model estimation.
</p>
</li></ul>

<p>This output facilitates side-by-side comparison of models to support model evaluation and selection.
</p>


<h3>Value</h3>

<p>A  data frame with a row for each LGM of the input list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example usage:
fit_indices &lt;- getFit(lgm_object = GCM_model)
fit_indices &lt;- getFit(lgm_object = list(GCM_model, GBTM_models, LCGA_models))

print(fit_indices)

</code></pre>

<hr>
<h2 id='getPoly'>Refine Polynomial Order in Latent Growth Modelling (LGM)</h2><span id='topic+getPoly'></span>

<h3>Description</h3>

<p>Refine the polynomial order for each class of a LGM
by iteratively removing non-significant growth factors, and running the updated models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPoly(lgm_object, wd = "Results")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPoly_+3A_lgm_object">lgm_object</code></td>
<td>
<p>A LGM <code>mplusObject</code>, typically generated with the <code>LGMobject</code> and <code>runLGM</code> functions.</p>
</td></tr>
<tr><td><code id="getPoly_+3A_wd">wd</code></td>
<td>
<p>A character string specifying the directory where the results folder will be created for saving Mplus input, output, and data files.
Default is the current working directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>getPoly</code> function refines the polynomial order of a LGM <code>mplusObject</code> through an iterative process.
In addition to ensuring the statistical significance of growth factors in each latent class,
the function ensure that the best loglikelihood value of the updated model is replicated.
</p>
<p>The function works as follows:
</p>

<ul>
<li><p> 1. Extract model information from the provided LGM <code>mplusObject</code>.
</p>
</li>
<li><p> 2. Evaluate the statistical significance of the highest-order growth factor in each class.
</p>
</li>
<li><p> 3. Remove non-significant growth factors (p-value &gt; 0.05) from the model.
</p>
</li>
<li><p> 4. Update the LGM <code>mplusObject</code> to reflect changes in the growth factor structure.
</p>
</li>
<li><p> 5. Re-run the updated <code>mplusObject</code> until log-likelihood values are successfully replicated using the <code>runLGM</code> function.
</p>
</li>
<li><p> 6. Repeat the process until the highest-order growth factor of all classes are statistically significant or reduce to intercept-only.
</p>
</li></ul>

<p>The function automates the procedure outlined for model selection in:
Van Der Nest et al,. (2020). &quot;An overview of mixture modelling for latent evolutions in longitudinal data: Modelling approaches, fit statistics and software.&quot;
Advances in Life Course Research 43: 100323.
</p>


<h3>Value</h3>

<p>A LGM <code>mplusObject</code> including the results of the updated model with the refined polynomial order.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LGMobject">LGMobject</a></code> for creating the mplusObject of a latent growth model.
<code><a href="#topic+runLGM">runLGM</a></code> for conducting latent growth modelling with a mplusObject.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example usage:
final_model &lt;- getPoly(
  lgm_object = LCGA_best,
  wd = "Results"
  )

final_fit &lt;- getFit(final_model)

 print(final_fit)

</code></pre>

<hr>
<h2 id='getSpaghetti'>Plot individual trajectories of outcome - Spaghetti plot</h2><span id='topic+getSpaghetti'></span>

<h3>Description</h3>

<p>Generate a spaghetti plot to visualize the individual trajectories of a given outcome across time..
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSpaghetti(data, outvar)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSpaghetti_+3A_data">data</code></td>
<td>
<p>A data frame containing all variables for the trajectory analysis.</p>
</td></tr>
<tr><td><code id="getSpaghetti_+3A_outvar">outvar</code></td>
<td>
<p>A character vector specifying the outcome variables at different times.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object displaying the spaghetti plot of individual trajectories.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage:
plot &lt;- getSpaghetti(
  data = symptoms,
  outvar = paste("sx", seq(from = 0, to = 24, by = 6), sep = "_"))

print(plot)
</code></pre>

<hr>
<h2 id='LGMobject'>Create Mplus model objects for Latent Growth Modelling (LGM)</h2><span id='topic+LGMobject'></span>

<h3>Description</h3>

<p>Provide flexibility for specifying Mplus LGM objects with various latent class and residual variance structures, and capturing individual differences in growth trajectories.
Support Growth Curve Models (GCM), Growth-Based Trajectory Models (GBTM) and Latent Class Growth Analysis (LCGA).
Once created, the model can be estimated using the <code>runLGM</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LGMobject(
  data,
  outvar,
  catvar = FALSE,
  idvar,
  k,
  starting_val,
  estimator = c("MLR", "ML", "WLSMV", "WLS"),
  transformation = c("LOGIT", "PROBIT"),
  lgm_type = c("gcm", "gbtm", "lcga_t", "lcga_c", "lcga_tc"),
  polynomial = 1,
  timescores,
  timescores_indiv = FALSE,
  output,
  plot,
  save
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LGMobject_+3A_data">data</code></td>
<td>
<p>A data frame containing all variables for the trajectory analysis.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_outvar">outvar</code></td>
<td>
<p>A character vector specifying the outcome variables at different times.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_catvar">catvar</code></td>
<td>
<p>A logical value indicating whether the outcome variable is categorical. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_idvar">idvar</code></td>
<td>
<p>A character string specifying the ID variable.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_k">k</code></td>
<td>
<p>An integer specifying the number of latent classes for the model.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_starting_val">starting_val</code></td>
<td>
<p>A numeric value specifying the number of random starting values to generate for the initial optimization stage.
Note that the number of final stage optimizations will be set as equal to half of this value.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_estimator">estimator</code></td>
<td>
<p>A character string to specify the estimator to use in the analysis. Default is 'MLR'.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_transformation">transformation</code></td>
<td>
<p>A character string to specify the latent response variable transformation to use when the outcome variable is categorical. Default is <code>LOGIT</code>.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_lgm_type">lgm_type</code></td>
<td>
<p>A character string specifying the residual variance structure of the growth model. Options include:
</p>

<ul>
<li><p> - &quot;gcm&quot; (relaxed residual variance across time),
</p>
</li>
<li><p> - &quot;gbtm&quot; (fixed residual variance across time and class),
</p>
</li>
<li><p> - &quot;lcga_t&quot; (relaxed residual variance across time),
</p>
</li>
<li><p> - &quot;lcga_c&quot; (relaxed residual variance across class),
</p>
</li>
<li><p> - &quot;lcga_tc&quot; (relaxed residual variance across both time and class).
</p>
</li></ul>
</td></tr>
<tr><td><code id="LGMobject_+3A_polynomial">polynomial</code></td>
<td>
<p>An integer specifying the order of the polynomial used to model trajectories. Supported values are:
1 (linear), 2 (quadratic), 3 (cubic). Default is 1.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_timescores">timescores</code></td>
<td>
<p>A numeric vector specifying the time scores for the model. If <code>timescores_indiv = TRUE</code>,
a character vector should be used to specify variables with individually varying times of observation.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_timescores_indiv">timescores_indiv</code></td>
<td>
<p>A logical value indicating whether to use individually varying times of observation for the outcome variable. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_output">output</code></td>
<td>
<p>A character vector specifying the requested Mplus output options for the model.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_plot">plot</code></td>
<td>
<p>A character string specifying the requested Mplus plot options for the model.</p>
</td></tr>
<tr><td><code id="LGMobject_+3A_save">save</code></td>
<td>
<p>A character string specifying the type of results to be saved by Mplus.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>LGMobject</code> function facilitates and automates the appropriate model specification for conducting latent growth modeling in Mplus.
It creates the relevant sections of an Mplus input file, including: TITLE, VARIABLE, ANALYSIS, MODEL, OUTPUT, PLOT, and SAVEDATA.
</p>
<p>This function builds upon the capabilities of the <code><a href="MplusAutomation.html#topic+mplusObject">mplusObject</a></code>function
from the MplusAutomation package.
</p>


<h3>Value</h3>

<p>A list of class <code>mplusObject</code> with elements specifying sections of an Mplus input file for conducting latent growth modeling.
</p>


<h3>See Also</h3>

<p><code><a href="MplusAutomation.html#topic+mplusObject">mplusObject</a></code> for creating an mplusObject.
<code><a href="#topic+runLGM">runLGM</a></code> for conducting latent growth modelling with an mplusObject.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example usage:
GBTM_object &lt;- LGMobject(
  data = symptoms,
  outvar = paste("sx", seq(from = 0, to = 24, by = 6), sep = "_"),
  idvar = "id",
  catvar = FALSE,
  k = 3L,
  starting_val = 500,
  lgm_type = "gbtm",
  polynomial = 3,
  timescores = seq(from = 0, to = 24, by = 6),
  timescores_indiv = FALSE,
  output = c("TECH1", "TECH14", "SAMPSTAT", "STANDARDIZED"),
  plot = "PLOT3",
  save = "FSCORES"
  )
</code></pre>

<hr>
<h2 id='runLGM'>Run Latent Growth Models (LGM) and replicate the best loglikelihood value (LL)</h2><span id='topic+runLGM'></span>

<h3>Description</h3>

<p>Run iterations of an LGM, doubling the number of starting values
until the best LL value has replicated at least twice, both within and between models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runLGM(lgm_object, wd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runLGM_+3A_lgm_object">lgm_object</code></td>
<td>
<p>An <code>mplusObject</code> with predefined random starting values (<code>STARTS</code>) in the ANALYSIS section.</p>
</td></tr>
<tr><td><code id="runLGM_+3A_wd">wd</code></td>
<td>
<p>A character string specifying the directory where the results folder will be created for saving the Mplus input, output, and data files.
Default is the current working directory.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>runLGM</code> function run iterations of an LGM in Mplus while gradually increasing the number of random starting values used to optimize the loglikelihood.
This approach aims to prevent estimation issues related to local maxima, which can result in selecting the inappropriate model during class enumeration.
The function works as follows:
</p>

<ul>
<li><p> 1. Estimate the model using the predefined number of random starting values.
</p>
</li>
<li><p> 2. Rerun the model with double the number of starting values.
</p>
</li>
<li><p> 3. Continue until the best LL value is successfully replicated both within the model and between 2 consecutive model run,
or the maximum number of allowed starting values is reached. By default the maximum number of allowed starting values
is set 2 times the number of initial starting values raised to the power of 5.
</p>
</li>
<li><p> 4. Return the <code>mplusObject</code> from the replicated model.
</p>
</li></ul>

<p>This function builds upon the capabilities of the <code><a href="MplusAutomation.html#topic+mplusModeler">mplusModeler</a></code> function
from the MplusAutomation package.
</p>


<h3>Value</h3>

<p>A list of class <code>mplusObject</code> including results for the replicated model, alongside with :
</p>

<ul>
<li><p> - The Mplus input and data files used for the model.
</p>
</li>
<li><p> - The output files generated by Mplus.
</p>
</li>
<li><p> - The data results files saved by Mplus.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="MplusAutomation.html#topic+mplusModeler">mplusModeler</a></code> for running, and reading an mplusObject.
<code><a href="#topic+LGMobject">LGMobject</a></code> for creating the mplusObject for a latent growth model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example usage:
GBTM_model &lt;-  runLGM(
  lgm_object = GBTM_object,
  wd = file.path("Results", "Trajectories"))

</code></pre>

<hr>
<h2 id='symptoms'>Symptoms Data</h2><span id='topic+symptoms'></span>

<h3>Description</h3>

<p>A simulated, longitudinal dataset capturing symptom severity with an arbitrary scale (total score: 0-28), over a 2-year follow-up
period for 350 individuals. The data is not normally distributed and exhibits heterogeneity, including latent (unobserved) trajectories
of symptom severity that reflect diverse progression patterns across individuals. The dataset contains no missing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>symptoms
</code></pre>


<h3>Format</h3>

<p>A dataframe with 1 row per individual, 350 observations and 10 variables.
</p>

<dl>
<dt>id</dt><dd><p>Individual identifier, numeric.</p>
</dd>
<dt>sx_0</dt><dd><p>Symptoms severity at month 0, numeric.</p>
</dd>
<dt>sx_3</dt><dd><p>Symptoms severity at month 3, numeric.</p>
</dd>
<dt>sx_6</dt><dd><p>Symptoms severity at month 6, numeric.</p>
</dd>
<dt>sx_9</dt><dd><p>Symptoms severity at month 9, numeric.</p>
</dd>
<dt>sx_12</dt><dd><p>Symptoms severity at month 12, numeric.</p>
</dd>
<dt>sx_15</dt><dd><p>Symptoms severity at month 15, numeric.</p>
</dd>
<dt>sx_18</dt><dd><p>Symptoms severity at month 18, numeric.</p>
</dd>
<dt>sx_21</dt><dd><p>Symptoms severity at month 21, numeric.</p>
</dd>
<dt>sx_24</dt><dd><p>Symptoms severity at month 24, numeric.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data simulated using <code><a href="modgo.html#topic+modgo">modgo</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
