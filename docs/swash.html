<!DOCTYPE html><html lang="en"><head><title>Help for package swash</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {swash}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#swash-package'>
<p>Implementation of the Swash-Backwash Model for the Single Epidemic Wave and additional functions in R</p></a></li>
<li><a href='#as_balanced'>
<p>Correction of Non-balanced Panel Dataset with Regional Infection Data</p></a></li>
<li><a href='#compare_countries'>
<p>Two-country Comparison of Swash-Backwash Model Parameters</p></a></li>
<li><a href='#confint-methods'><p>Methods for Function <code>confint</code></p></a></li>
<li><a href='#countries-class'><p>Class <code>"countries"</code></p></a></li>
<li><a href='#COVID19Cases_geoRegion'><p>Switzerland Daily COVID-19 cases by region</p></a></li>
<li><a href='#hist_ci'>
<p>Creating Histograms with Confidence Intervals</p></a></li>
<li><a href='#is_balanced'>
<p>Test whether Panel Dataset with Regional Infection Data is Balanced</p></a></li>
<li><a href='#Oesterreich_Faelle'><p>Austria Daily COVID-19 cases by region 2020-02-26 to 2020-05-31</p></a></li>
<li><a href='#plot_regions'>
<p>Plots of Regional Infections Over Time</p></a></li>
<li><a href='#plot_regions-methods'><p>Methods for Function <code>plot_regions</code></p></a></li>
<li><a href='#plot-methods'><p>Methods for Function <code>plot</code></p></a></li>
<li><a href='#print-methods'><p>Methods for Function <code>print</code></p></a></li>
<li><a href='#quantile_ci'>
<p>Computing Quantiles for a given Numeric Vector</p></a></li>
<li><a href='#sbm_ci-class'><p>Class <code>"sbm_ci"</code></p></a></li>
<li><a href='#sbm-class'><p>Class <code>"sbm"</code></p></a></li>
<li><a href='#show-methods'><p>Methods for Function <code>show</code></p></a></li>
<li><a href='#summary-methods'><p>Methods for Function <code>summary</code></p></a></li>
<li><a href='#swash'>
<p>Swash-Backwash Model for the Single Epidemic Wave</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Swash-Backwash Model for the Single Epidemic Wave</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-02-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Wieland <a href="https://orcid.org/0000-0001-5168-9846"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Wieland &lt;geowieland@googlemail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The Swash-Backwash Model for the Single Epidemic Wave was developed by Cliff and Haggett (2006) &lt;<a href="https://doi.org/10.1007%2Fs10109-006-0027-8">doi:10.1007/s10109-006-0027-8</a>&gt; to model the velocity of spread of infectious diseases across space. This package enables the calculation of the Swash-Backwash Model for user-supplied panel data on regional infections. The package also provides additional functions for bootstrap confidence intervals, country comparison, visualization of results, and data management.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-24 19:27:34 UTC; thoma</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-24 19:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='swash-package'>
Implementation of the Swash-Backwash Model for the Single Epidemic Wave and additional functions in R 
</h2><span id='topic+swash-package'></span>

<h3>Description</h3>

<p>Swash-Backwash Model for the single epidemic wave (Cliff and Haggett 2006) with additional functions for bootstrap confidence intervals and data management
</p>


<h3>Details</h3>

<p>The Swash-Backwash Model for the Single Epidemic Wave is the spatial equivalent of the classic epidemiological SIR (Susceptible-Infected-Recovered) model. It was developed by Cliff and Haggett (2006) to model the velocity of spread of infectious diseases across space. Current applications can be found, for example, in Smallman-Raynor et al. (2022a,b). This package enables the calculation of the Swash-Backwash Model for user-supplied panel data on regional infections. The core of this is the <code>swash()</code> function, which calculates the model and creates a model object of the <code>sbm</code> class defined in this package. This class can be used to visualize results (<code>summary()</code>, <code>plot()</code>) and calculate bootstrap confidence intervals for the model estimates (<code>confint(sbm)</code>). The package also contains additional helper functions.
</p>


<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>References</h3>

<p><em>Swash-Backwash Model:</em>
</p>
<p>Cliff AD, Haggett P (2006) A swash-backwash model of the single epidemic wave. <em>Journal of Geographical Systems</em> 8(3), 227-252. <a href="https://doi.org/10.1007/s10109-006-0027-8">doi:10.1007/s10109-006-0027-8</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, Stickler PJ (2022a) Meningococcal Meningitis and Coal Mining in Provincial England: Geographical Perspectives on a Major Epidemic, 1929–33. <em>Geographical Analysis</em> 54, 197–216. <a href="https://doi.org/10.1111/gean.12272">doi:10.1111/gean.12272</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, The COVID-19 Genomics UK (COG-UK) Consortium (2022b) Spatial growth rate of emerging SARS-CoV-2 lineages in England, September 2020–December 2021. <em>Epidemiology and Infection</em> 150, e145. <a href="https://doi.org/10.1017/S0950268822001285">doi:10.1017/S0950268822001285</a>.
</p>
<p><em>Basics of epidemiological modeling:</em>
</p>
<p>Li, MY (2018) An Introduction to Mathematical Modeling of Infectious Diseases. <a href="https://doi.org/10.1007/978-3-319-72122-4">doi:10.1007/978-3-319-72122-4</a>
</p>
<p>Nishiura H, Chowell G (2009) The effective reproduction number as a prelude to statistical estimation of time-dependent epidemic trends. In Chowell G, Hyman JM, Bettencourt LMA (eds.) Mathematical and statistical estimation approaches in epidemiology, 103–121. <a href="https://doi.org/10.1007/978-90-481-2313-1_5">doi:10.1007/978-90-481-2313-1_5</a>
</p>
<p><em>Spatio-temporal analysis and modeling of infectious diseases:</em>
</p>
<p>Bourdin S, Jeanne L, Nadou F, Noiret G (2021) Does lockdown work? A spatial analysis of the spread and concentration of Covid-19 in Italy. Regional Studies, 55, 1182–1193. <a href="https://doi.org/10.1080/00343404.2021.1887471">doi:10.1080/00343404.2021.1887471</a>
</p>
<p>Chowell G, Viboud C, Hyman JM, Simonsen L (2015) The Western Africa ebola virus disease epidemic exhibits both global exponential and local polynomial growth rates. <em>PLOS Currents Outbreaks</em>, ecurrents.outbreaks.8b55f4bad99ac5c5db3663e916803261. <a href="https://doi.org/10.1371/currents.outbreaks.8b55f4bad99ac5c5db3663e916803261">doi:10.1371/currents.outbreaks.8b55f4bad99ac5c5db3663e916803261</a>
</p>
<p>Viboud C, Bjørnstad ON, Smith DL, Simonsen L, Miller MA, Grenfell BT (2006) Synchrony, Waves, and Spatial Hierarchies in the Spread of Influenza. <em>Science</em> 312,447-451. <a href="https://doi.org/10.1126/science.1125237">doi:10.1126/science.1125237</a>
</p>
<p>Wieland T (2020) Flatten the Curve! Modeling SARS-CoV-2/COVID-19 Growth in Germany at the County Level. <em>REGION</em> 7(2), 43–83. <a href="https://doi.org/10.18335/region.v7i2.324">doi:10.18335/region.v7i2.324</a>
</p>
<p><em>Panel data:</em>
</p>
<p>Greene, WH (2012) <em>Econometric Analysis</em>. Ch. 11.
</p>
<p>Wooldridge, JM (2012) <em>Introductory Econometrics. A Modern Approach</em>. Ch. 13.
</p>
<p><em>Bootstrapping und bootstrap confidence intervals:</em>
</p>
<p>Efron B, Tibshirani RJ (1993) An Introduction to the Bootstrap.
</p>
<p>Ramachandran KM, Tsokos CP (2021) Mathematical Statistics with Applications in R (Third Edition). Ch. 13.3.1 (Bootstrap confidence intervals). <a href="https://doi.org/10.1016/B978-0-12-817815-7.00013-0">doi:10.1016/B978-0-12-817815-7.00013-0</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(COVID19Cases_geoRegion)
# Get SWISS COVID19 cases at NUTS 3 level

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[!COVID19Cases_geoRegion$geoRegion %in% c("CH", "CHFL"),]
# Exclude CH = Switzerland total and CHFL = Switzerland and Liechtenstein total

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[COVID19Cases_geoRegion$datum &lt;= "2020-05-31",]
# Extract first COVID-19 wave

CH_covidwave1 &lt;- 
  swash (
    data = COVID19Cases_geoRegion, 
    col_cases = "entries", 
    col_date = "datum", 
    col_region = "geoRegion"
    )
# Swash-Backwash Model for Swiss COVID19 cases
# Spatial aggregate: NUTS 3 (cantons)

summary(CH_covidwave1)
# Summary of Swash-Backwash Model

plot(CH_covidwave1)
# Plot of Swash-Backwash Model edges and total epidemic curve
</code></pre>

<hr>
<h2 id='as_balanced'>
Correction of Non-balanced Panel Dataset with Regional Infection Data
</h2><span id='topic+as_balanced'></span>

<h3>Description</h3>

<p>This function corrects non-balanced input panel data by replacing missing entries with a user-given constant (e.g., 0).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_balanced(
  data, 
  col_cases, 
  col_date, 
  col_region, 
  fill_missing = 0
  )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_balanced_+3A_data">data</code></td>
<td>

<p><code>data.frame</code> with regional infection data
</p>
</td></tr>
<tr><td><code id="as_balanced_+3A_col_cases">col_cases</code></td>
<td>

<p>Column containing the cases (numeric)
</p>
</td></tr>
<tr><td><code id="as_balanced_+3A_col_date">col_date</code></td>
<td>

<p>Column containing the time points (e.g., days)
</p>
</td></tr>
<tr><td><code id="as_balanced_+3A_col_region">col_region</code></td>
<td>

<p>Column containing the unique identifier of the regions (e.g., name, NUTS 3 code)
</p>
</td></tr>
<tr><td><code id="as_balanced_+3A_fill_missing">fill_missing</code></td>
<td>

<p>Constant to fill missing values (default and recommended: 0)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Swash-Backwash Model for the Single Epidemic Wave does not necessarily require balanced panel data in order for the calculations to be carried out. However, for a correct estimation it is implicitly assumed that the input data is balanced. The function corrects non-balanced panel data. It is executed automatically whithin the <code>swash()</code> function (when using the function <code>is_balanced()</code>), but can also be used separately.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>Corrected input dataset (<code>data.frame</code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>References</h3>

<p><em>Swash-Backwash Model:</em>
</p>
<p>Cliff AD, Haggett P (2006) A swash-backwash model of the single epidemic wave. <em>Journal of Geographical Systems</em> 8(3), 227-252. <a href="https://doi.org/10.1007/s10109-006-0027-8">doi:10.1007/s10109-006-0027-8</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, Stickler PJ (2022) Meningococcal Meningitis and Coal Mining in Provincial England: Geographical Perspectives on a Major Epidemic, 1929–33. <em>Geographical Analysis</em> 54, 197–216. <a href="https://doi.org/10.1111/gean.12272">doi:10.1111/gean.12272</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, The COVID-19 Genomics UK (COG-UK) Consortium (2022) Spatial growth rate of emerging SARS-CoV-2 lineages in England, September 2020–December 2021. <em>Epidemiology and Infection</em> 150, e145. <a href="https://doi.org/10.1017/S0950268822001285">doi:10.1017/S0950268822001285</a>.
</p>
<p><em>Panel data:</em>
</p>
<p>Greene, WH (2012) <em>Econometric Analysis</em>. Ch. 11.
</p>
<p>Wooldridge, JM (2012) <em>Introductory Econometrics. A Modern Approach</em>. Ch. 13.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+is_balanced">is_balanced</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(COVID19Cases_geoRegion)
# Get SWISS COVID19 cases at NUTS 3 level

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[!COVID19Cases_geoRegion$geoRegion %in% c("CH", "CHFL"),]
# Exclude CH = Switzerland total and CHFL = Switzerland and Liechtenstein total

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[COVID19Cases_geoRegion$datum &lt;= "2020-05-31",]
# Extract first COVID-19 wave

COVID19Cases_geoRegion_balanced &lt;- 
  is_balanced(
  data = COVID19Cases_geoRegion,
  col_cases = "entries",
  col_date = "datum",
  col_region = "geoRegion"
)
# Test whether "COVID19Cases_geoRegion" is balanced panel data 

COVID19Cases_geoRegion_balanced$data_balanced
# Balanced? TRUE or FALSE

if (COVID19Cases_geoRegion_balanced$data_balanced == FALSE) {
  COVID19Cases_geoRegion &lt;- 
    as_balanced(
    COVID19Cases_geoRegion,
    col_cases = "entries",
    col_date = "datum",
    col_region = "geoRegion"
  )
}
# Correction of dataset "COVID19Cases_geoRegion"
# not necessary as parameter balance of is_balanced is set TRUE by default
</code></pre>

<hr>
<h2 id='compare_countries'>
Two-country Comparison of Swash-Backwash Model Parameters
</h2><span id='topic+compare_countries'></span>

<h3>Description</h3>

<p>This function enables bootstrap estimates for the mean difference of Swash-Backwash Model parameters of two countries to be compared.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_countries(
  sbm1, 
  sbm2, 
  country_names = c("Country 1", "Country 2"), 
  indicator = "R_0A", 
  iterations = 100, 
  samples_ratio = 0.8, 
  alpha = 0.05, 
  replace = TRUE
  )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_countries_+3A_sbm1">sbm1</code></td>
<td>

<p>A <code>sbm</code> object for country 1
</p>
</td></tr>
<tr><td><code id="compare_countries_+3A_sbm2">sbm2</code></td>
<td>

<p>A <code>sbm</code> object for country 2
</p>
</td></tr>
<tr><td><code id="compare_countries_+3A_country_names">country_names</code></td>
<td>

<p><code>list</code> with user-given country names (two entries)
</p>
</td></tr>
<tr><td><code id="compare_countries_+3A_indicator">indicator</code></td>
<td>

<p><code>character</code>, indicator to be analyzed (<code>"S_A"</code>, <code>"I_A"</code>, <code>"R_A"</code>, <code>"t_LE"</code>, <code>"t_LE"</code>, or <code>"R_0A"</code> (default and recommended: <code>"R_0A"</code>))
</p>
</td></tr>
<tr><td><code id="compare_countries_+3A_iterations">iterations</code></td>
<td>

<p>Number of iterations for resampling (default: 100)
</p>
</td></tr>
<tr><td><code id="compare_countries_+3A_samples_ratio">samples_ratio</code></td>
<td>

<p>Proportion of regions included in each sample (default: 0.8)
</p>
</td></tr>
<tr><td><code id="compare_countries_+3A_alpha">alpha</code></td>
<td>

<p>Significance level <code class="reqn">\alpha</code> for the confidence intervals (default: 0.05)
</p>
</td></tr>
<tr><td><code id="compare_countries_+3A_replace">replace</code></td>
<td>

<p>Resampling with replacement (<code>TRUE</code> or <code>FALSE</code>, default: <code>TRUE</code> = bootstrap resampling)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The combination of the Swash-Backwash Model and bootstrap resampling allows the estimation of mean differences of a user-specified model parameter (e.g., spatial reproduction number <code class="reqn">R_{OA}</code>) between two countries. This makes it possible to check whether the spatial spread velocity of a communicable disease is significantly different in one country than in another country. Since the initial data in the Swash-Backwash Model should be balanced, <em>entity-based bootstrap sampling</em> is carried out in the <code>compare_countries()</code> function. This means that not, for example, 80% of all observations are included in each sample at a sample ratio equal to <code class="reqn">p</code> = 0.8, but rather all observations for 80% of the regions. For both countries, <code class="reqn">B</code> bootstrap samples (default: 100) are drawn for which the Swash-Backwash Model is calculated. Based on the distribution of indicators, confidence intervals are calculated at the user-specified significance level <code class="reqn">\alpha</code>. The <code>compare_countries()</code> function calculates the differences of the user's desired indicator between the two samples, <code class="reqn">D</code>, and also calculates <code class="reqn">\alpha</code> confidence intervals for this.
</p>


<h3>Value</h3>

<p>object of class <code>countries</code>, see <code><a href="#topic+countries-class">countries-class</a></code>
</p>


<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>References</h3>

<p><em>Swash-Backwash Model:</em>
</p>
<p>Cliff AD, Haggett P (2006) A swash-backwash model of the single epidemic wave. <em>Journal of Geographical Systems</em> 8(3), 227-252. <a href="https://doi.org/10.1007/s10109-006-0027-8">doi:10.1007/s10109-006-0027-8</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, Stickler PJ (2022) Meningococcal Meningitis and Coal Mining in Provincial England: Geographical Perspectives on a Major Epidemic, 1929–33. <em>Geographical Analysis</em> 54, 197–216. <a href="https://doi.org/10.1111/gean.12272">doi:10.1111/gean.12272</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, The COVID-19 Genomics UK (COG-UK) Consortium (2022) Spatial growth rate of emerging SARS-CoV-2 lineages in England, September 2020–December 2021. <em>Epidemiology and Infection</em> 150, e145. <a href="https://doi.org/10.1017/S0950268822001285">doi:10.1017/S0950268822001285</a>.
</p>
<p><em>Bootstrapping und bootstrap confidence intervals:</em>
</p>
<p>Efron B, Tibshirani RJ (1993) An Introduction to the Bootstrap.
</p>
<p>Ramachandran KM, Tsokos CP (2021) Mathematical Statistics with Applications in R (Third Edition). Ch. 13.3.1 (Bootstrap confidence intervals). <a href="https://doi.org/10.1016/B978-0-12-817815-7.00013-0">doi:10.1016/B978-0-12-817815-7.00013-0</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+swash">swash</a></code>, <code><a href="#topic+countries-class">countries-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(COVID19Cases_geoRegion)
# Get Swiss COVID19 cases at NUTS 3 level

data(Oesterreich_Faelle)
# Get Austrian COVID19 cases at NUTS 3 level
# (first wave, same final date as in Swiss data: 2020-05-31)

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[!COVID19Cases_geoRegion$geoRegion %in% c("CH", "CHFL"),]
# Exclude CH = Switzerland total and CHFL = Switzerland and Liechtenstein total

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[COVID19Cases_geoRegion$datum &lt;= "2020-05-31",]
# Extract first COVID-19 wave

CH_covidwave1 &lt;- 
  swash (
    data = COVID19Cases_geoRegion, 
    col_cases = "entries", 
    col_date = "datum", 
    col_region = "geoRegion"
    )
# Swash-Backwash Model for Swiss COVID19 cases
# Spatial aggregate: NUTS 3 (cantons)

AT_covidwave1 &lt;- 
  swash (
    data = Oesterreich_Faelle,
    col_cases = "Faelle",
    col_date = "Datum",
    col_region = "NUTS3"
  )
# Swash-Backwash Model for Austrian COVID19 cases
# Spatial aggregate: NUTS 3

AT_vs_CH &lt;- 
  compare_countries(
    CH_covidwave1, 
    AT_covidwave1,
    country_names = c("Switzerland", "Austria"))
# Country comparison Switzerland vs. Austria
# default config: 100 iterations, alpha = 0.05, sample ratio = 80%,
# indicator: R_0A

summary(AT_vs_CH)
# Summary of country comparison

plot(AT_vs_CH)
# Plot of country comparison
</code></pre>

<hr>
<h2 id='confint-methods'>Methods for Function <code>confint</code></h2><span id='topic+confint-methods'></span>

<h3>Description</h3>

<p>Methods for function <code>confint</code>
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "sbm", iterations = 100, samples_ratio = 0.8, alpha = 0.05, replace = TRUE)</code></dt><dd>
<p>Creates bootstrap confidence intervals for <code>sbm</code> objects. The argument <code>iterations</code> indicates the number of bootstrap samples which are drawn. Since the initial data in the Swash-Backwash Model should be balanced, <em>entity-based bootstrap sampling</em> is carried out. This means that not, for example, 80% of all observations are included in each sample at a sample ratio equal to <code class="reqn">p</code> = 0.8 (<code>samples_ratio = 0.8</code>), but rather all observations for 80% of the regions. The significance level for the confidence intervals <code class="reqn">\alpha</code> is set by the argument <code>alpha</code> (default: 0.05, which corresponds to a 95% confidence level). 
</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>References</h3>

<p><em>Swash-Backwash Model:</em>
</p>
<p>Cliff AD, Haggett P (2006) A swash-backwash model of the single epidemic wave. <em>Journal of Geographical Systems</em> 8(3), 227-252. <a href="https://doi.org/10.1007/s10109-006-0027-8">doi:10.1007/s10109-006-0027-8</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, Stickler PJ (2022) Meningococcal Meningitis and Coal Mining in Provincial England: Geographical Perspectives on a Major Epidemic, 1929–33. <em>Geographical Analysis</em> 54, 197–216. <a href="https://doi.org/10.1111/gean.12272">doi:10.1111/gean.12272</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, The COVID-19 Genomics UK (COG-UK) Consortium (2022) Spatial growth rate of emerging SARS-CoV-2 lineages in England, September 2020–December 2021. <em>Epidemiology and Infection</em> 150, e145. <a href="https://doi.org/10.1017/S0950268822001285">doi:10.1017/S0950268822001285</a>.
</p>
<p><em>Bootstrapping und bootstrap confidence intervals:</em>
</p>
<p>Efron B, Tibshirani RJ (1993) An Introduction to the Bootstrap.
</p>
<p>Ramachandran KM, Tsokos CP (2021) Mathematical Statistics with Applications in R (Third Edition). Ch. 13.3.1 (Bootstrap confidence intervals). <a href="https://doi.org/10.1016/B978-0-12-817815-7.00013-0">doi:10.1016/B978-0-12-817815-7.00013-0</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sbm_ci-class">sbm_ci-class</a></code>
</p>

<hr>
<h2 id='countries-class'>Class <code>"countries"</code></h2><span id='topic+countries-class'></span><span id='topic+plot+2Ccountries-method'></span><span id='topic+show+2Ccountries-method'></span><span id='topic+summary+2Ccountries-method'></span>

<h3>Description</h3>

<p>The class <code>"countries"</code> contains the results of a two-country comparison analysis using the Swash-Backwash Model, including two <code>"sbm_ci"</code> classes for each country. Use <code>summary(countries)</code> and <code>plot(countries)</code> for results summary and plotting, respectively.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("countries", ...)</code>.
Objects can be created by the function <code>compare_countries(sbm1, sbm2)</code>. 
</p>


<h3>Slots</h3>


<dl>
<dt><code>sbm_ci1</code>:</dt><dd><p>Object of class <code>"sbm_ci"</code> Results of <code>"confint(sbm1)"</code> for country 1 </p>
</dd>
<dt><code>sbm_ci2</code>:</dt><dd><p>Object of class <code>"sbm_ci"</code> Results of <code>"confint(sbm1)"</code> for country 2 </p>
</dd>
<dt><code>D</code>:</dt><dd><p>Object of class <code>"numeric"</code> Results: Difference <code class="reqn">D</code> between the samples with respect to the chosen indicator </p>
</dd>
<dt><code>D_ci</code>:</dt><dd><p>Object of class <code>"numeric"</code> Results: <code class="reqn">\alpha</code> confidence intervals of <code class="reqn">D</code></p>
</dd>
<dt><code>config</code>:</dt><dd><p>Object of class <code>"list"</code> Configuration details for bootstrap sampling </p>
</dd>
<dt><code>country_names</code>:</dt><dd><p>Object of class <code>"character"</code> User-stated country names </p>
</dd>
<dt><code>indicator</code>:</dt><dd><p>Object of class <code>"character"</code> User-stated indicator to be tested </p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>plot</dt><dd><p><code>signature(x = "countries")</code>: Plots the results of a two-country comparison with the Swash-Backwash Model </p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "countries")</code>: Prints an <code>countries</code> object; use <code>summary(sbm_ci)</code> for results </p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "countries")</code>: Prints a summary of a <code>countries</code> object (results of the two-country comparison) </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("countries")
</code></pre>

<hr>
<h2 id='COVID19Cases_geoRegion'>Switzerland Daily COVID-19 cases by region</h2><span id='topic+COVID19Cases_geoRegion'></span>

<h3>Description</h3>

<p>A dataset containing COVID-19 cases by region (NUTS 3 = cantons) and time periods (days) for Switzerland (Source: Federal Office of Public Health FOPH).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(COVID19Cases_geoRegion)
</code></pre>


<h3>Format</h3>

<p>A data.frame with multiple columns:
</p>

<dl>
<dt>geoRegion</dt><dd><p>(character) Region for which the data was collected.</p>
</dd>
<dt>datum</dt><dd><p>(Date) Date of record.</p>
</dd>
<dt>entries</dt><dd><p>(integer) Number of reported cases on this date.</p>
</dd>
<dt>sumTotal</dt><dd><p>(integer) Cumulative case numbers.</p>
</dd>
<dt>timeframe_14d</dt><dd><p>(logical) Indicates whether the time period covers the last 14 days.</p>
</dd>
<dt>timeframe_all</dt><dd><p>(logical) Indicates whether the time period covers all previous data.</p>
</dd>
<dt>offset_last7d</dt><dd><p>(integer) Offset of the last 7 days.</p>
</dd>
<dt>sumTotal_last7d</dt><dd><p>(integer) Cumulative case numbers of the last 7 days.</p>
</dd>
<dt>offset_last14d</dt><dd><p>(integer) Offset of the last 14 days.</p>
</dd>
<dt>sumTotal_last14d</dt><dd><p>(integer) Cumulative case numbers of the last 14 days.</p>
</dd>
<dt>offset_last28d</dt><dd><p>(integer) Offset of the last 28 days.</p>
</dd>
<dt>sumTotal_last28d</dt><dd><p>(integer) Cumulative case numbers of the last 28 days.</p>
</dd>
<dt>sum7d</dt><dd><p>(numeric) Sum of the last 7 days.</p>
</dd>
<dt>sum14d</dt><dd><p>(numeric) Sum of the last 14 days.</p>
</dd>
<dt>mean7d</dt><dd><p>(numeric) Average of the last 7 days.</p>
</dd>
<dt>mean14d</dt><dd><p>(numeric) Average of the last 14 days.</p>
</dd>
<dt>entries_diff_last_age</dt><dd><p>(integer) Difference from the last age group.</p>
</dd>
<dt>pop</dt><dd><p>(integer) Population of the region.</p>
</dd>
<dt>inz_entries</dt><dd><p>(numeric) Incidence of the entries.</p>
</dd>
<dt>inzsumTotal</dt><dd><p>(numeric) Incidence of cumulative cases.</p>
</dd>
<dt>inzmean7d</dt><dd><p>(numeric) Incidence of the 7-day average.</p>
</dd>
<dt>inzmean14d</dt><dd><p>(numeric) Incidence of the 14-day average.</p>
</dd>
<dt>inzsumTotal_last7d</dt><dd><p>(numeric) Incidence of cumulative cases in the last 7 days.</p>
</dd>
<dt>inzsumTotal_last14d</dt><dd><p>(numeric) Incidence of cumulative cases in the last 14 days.</p>
</dd>
<dt>inzsumTotal_last28d</dt><dd><p>(numeric) Incidence of cumulative cases in the last 28 days.</p>
</dd>
<dt>inzsum7d</dt><dd><p>(numeric) Incidence of the last 7 days.</p>
</dd>
<dt>inzsum14d</dt><dd><p>(numeric) Incidence of the last 14 days.</p>
</dd>
<dt>sumdelta7d</dt><dd><p>(numeric) Difference in sums of the last 7 days.</p>
</dd>
<dt>inzdelta7d</dt><dd><p>(numeric) Difference in incidence of the last 7 days.</p>
</dd>
<dt>type</dt><dd><p>(character) Type of recorded data (e.g., COVID-19 cases).</p>
</dd>
<dt>type_variant</dt><dd><p>(character) Variant of the data type.</p>
</dd>
<dt>version</dt><dd><p>(character) Version of the data collection.</p>
</dd>
<dt>datum_unit</dt><dd><p>(character) Unit of date specification (e.g., day).</p>
</dd>
<dt>entries_letzter_stand</dt><dd><p>(integer) Last known count of entries.</p>
</dd>
<dt>entries_neu_gemeldet</dt><dd><p>(integer) Newly reported entries.</p>
</dd>
<dt>entries_diff_last</dt><dd><p>(integer) Difference in last entries.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data is included as it was published in ??. Note that the reporting date equals the date of SARS-CoV-2 testing.
</p>


<h3>Source</h3>

<p>Federal Office of Public Health FOPH (2023) COVID-19 Dashboard Source Data. <a href="https://www.covid19.admin.ch/api/data/documentation">https://www.covid19.admin.ch/api/data/documentation</a> (retrieved 2023-06-28)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(COVID19Cases_geoRegion)
# Get SWISS COVID19 cases at NUTS 3 level

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[!COVID19Cases_geoRegion$geoRegion %in% c("CH", "CHFL"),]
# Exclude CH = Switzerland total and CHFL = Switzerland and Liechtenstein total

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[COVID19Cases_geoRegion$datum &lt;= "2020-05-31",]
# Extract first COVID-19 wave

COVID19Cases_geoRegion_balanced &lt;- 
  is_balanced(
  data = COVID19Cases_geoRegion,
  col_cases = "entries",
  col_date = "datum",
  col_region = "geoRegion"
)
# Test whether "COVID19Cases_geoRegion" is balanced panel data 

COVID19Cases_geoRegion_balanced$data_balanced
# Balanced? TRUE or FALSE
</code></pre>

<hr>
<h2 id='hist_ci'>
Creating Histograms with Confidence Intervals
</h2><span id='topic+hist_ci'></span>

<h3>Description</h3>

<p>Plot of a histogram of a given vector <code>x</code> and the related confidence intervals (<code>lower</code>, <code>upper</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hist_ci(
  x, 
  alpha = 0.05,
  col_bars = "grey", 
  col_ci = "red",
  ...
  )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hist_ci_+3A_x">x</code></td>
<td>

<p>A numeric vector
</p>
</td></tr>
<tr><td><code id="hist_ci_+3A_alpha">alpha</code></td>
<td>

<p>Significance level <code class="reqn">\alpha</code> for 1-<code class="reqn">\alpha</code>*100 confidence intervals
</p>
</td></tr>
<tr><td><code id="hist_ci_+3A_col_bars">col_bars</code></td>
<td>

<p>Color of bars in histogram
</p>
</td></tr>
<tr><td><code id="hist_ci_+3A_col_ci">col_ci</code></td>
<td>

<p>Color of lines for confidence interval
</p>
</td></tr>
<tr><td><code id="hist_ci_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to <code>barplot()</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Helper function for <code>plot(sbm_ci)</code>, but may be used separately.
</p>


<h3>Value</h3>

<p>Histogram plot, no returned value
</p>


<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>Examples</h3>

<pre><code class='language-R'>numeric_vector &lt;- c(1,9,5,6,3,10,20,6,9,14,3,5,8,6,11)
# any numeric vector

hist_ci(numeric_vector)
</code></pre>

<hr>
<h2 id='is_balanced'>
Test whether Panel Dataset with Regional Infection Data is Balanced
</h2><span id='topic+is_balanced'></span>

<h3>Description</h3>

<p>The function tests whether the input panel data with regional infections is balanced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_balanced(
  data, 
  col_cases, 
  col_date, 
  col_region, 
  as_balanced = TRUE, 
  fill_missing = 0
  )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_balanced_+3A_data">data</code></td>
<td>

<p><code>data.frame</code> with regional infection data
</p>
</td></tr>
<tr><td><code id="is_balanced_+3A_col_cases">col_cases</code></td>
<td>

<p>Column containing the cases (numeric)
</p>
</td></tr>
<tr><td><code id="is_balanced_+3A_col_date">col_date</code></td>
<td>

<p>Column containing the time points (e.g., days)
</p>
</td></tr>
<tr><td><code id="is_balanced_+3A_col_region">col_region</code></td>
<td>

<p>Column containing the unique identifier of the regions (e.g., name, NUTS 3 code)
</p>
</td></tr>
<tr><td><code id="is_balanced_+3A_as_balanced">as_balanced</code></td>
<td>

<p>Boolean argument which indicates whether non-balanced panel data shall be balanced (default: TRUE)
</p>
</td></tr>
<tr><td><code id="is_balanced_+3A_fill_missing">fill_missing</code></td>
<td>

<p>Constant to fill missing values (default and recommended: 0)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Swash-Backwash Model for the Single Epidemic Wave does not necessarily require balanced panel data in order for the calculations to be carried out. However, for a correct estimation it is implicitly assumed that the input data is balanced. The function tests whether the panel data is balanced. It is executed automatically whithin the <code>swash()</code> function (using automatic correction with <code>as_balanced = TRUE</code>), but can also be used separately.
</p>


<h3>Value</h3>

<p>List with two entries:
</p>
<table role = "presentation">
<tr><td><code>data_balanced</code></td>
<td>
<p>Result of test (<code>TRUE</code> or <code>FALSE</code>)</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Input dataset (<code>data.frame</code>)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>References</h3>

<p><em>Swash-Backwash Model:</em>
</p>
<p>Cliff AD, Haggett P (2006) A swash-backwash model of the single epidemic wave. <em>Journal of Geographical Systems</em> 8(3), 227-252. <a href="https://doi.org/10.1007/s10109-006-0027-8">doi:10.1007/s10109-006-0027-8</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, Stickler PJ (2022) Meningococcal Meningitis and Coal Mining in Provincial England: Geographical Perspectives on a Major Epidemic, 1929–33. <em>Geographical Analysis</em> 54, 197–216. <a href="https://doi.org/10.1111/gean.12272">doi:10.1111/gean.12272</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, The COVID-19 Genomics UK (COG-UK) Consortium (2022) Spatial growth rate of emerging SARS-CoV-2 lineages in England, September 2020–December 2021. <em>Epidemiology and Infection</em> 150, e145. <a href="https://doi.org/10.1017/S0950268822001285">doi:10.1017/S0950268822001285</a>.
</p>
<p><em>Panel data:</em>
</p>
<p>Greene, WH (2012) <em>Econometric Analysis</em>. Ch. 11.
</p>
<p>Wooldridge, JM (2012) <em>Introductory Econometrics. A Modern Approach</em>. Ch. 13.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+as_balanced">as_balanced</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(COVID19Cases_geoRegion)
# Get SWISS COVID19 cases at NUTS 3 level

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[!COVID19Cases_geoRegion$geoRegion %in% c("CH", "CHFL"),]
# Exclude CH = Switzerland total and CHFL = Switzerland and Liechtenstein total

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[COVID19Cases_geoRegion$datum &lt;= "2020-05-31",]
# Extract first COVID-19 wave

COVID19Cases_geoRegion_balanced &lt;- 
  is_balanced(
  data = COVID19Cases_geoRegion,
  col_cases = "entries",
  col_date = "datum",
  col_region = "geoRegion"
)
# Test whether "COVID19Cases_geoRegion" is balanced panel data 

COVID19Cases_geoRegion_balanced$data_balanced
# Balanced? TRUE or FALSE

if (COVID19Cases_geoRegion_balanced$data_balanced == FALSE) {
  COVID19Cases_geoRegion &lt;- 
    as_balanced(
    COVID19Cases_geoRegion,
    col_cases = "entries",
    col_date = "datum",
    col_region = "geoRegion"
  )
}
# Correction of dataset "COVID19Cases_geoRegion"
# not necessary as parameter balance of is_balanced is set TRUE by default
</code></pre>

<hr>
<h2 id='Oesterreich_Faelle'>Austria Daily COVID-19 cases by region 2020-02-26 to 2020-05-31</h2><span id='topic+Oesterreich_Faelle'></span>

<h3>Description</h3>

<p>A dataset containing COVID-19 cases by region (NUTS 3) and time periods (days) for Austria (Source: BMSGPK).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Oesterreich_Faelle)
</code></pre>


<h3>Format</h3>

<p>A data.frame with multiple columns:
</p>

<dl>
<dt>NUTS3</dt><dd><p>(character) Region for which the data was collected.</p>
</dd>
<dt>Datum</dt><dd><p>(Date) Date of record.</p>
</dd>
<dt>Faelle</dt><dd><p>(integer) Number of reported cases on this date.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The original data was originally published by BMSGPK at a smaller spatial scale level (political districts, &quot;Politische Bezirke&quot;). The data was linked to a corresponding shapefile from Statistik Austria (2022), joined to the NUTS3 level via a spatial join, and summed over the Austrian NUTS3 regions. The spatial join is based on polygon centroids of the political districts level; in cases where the centroid was outside the polygon, it was placed inside the polygon manually.
</p>


<h3>Source</h3>

<p>BMSGPK, Oesterreichisches COVID-19 Open Data Informationsportal (2022) COVID-19: Zeitliche Darstellung von Daten zu Covid19-Faellen je Bezirk. <a href="https://www.data.gv.at/katalog/dataset/4b71eb3d-7d55-4967-b80d-91a3f220b60c">https://www.data.gv.at/katalog/dataset/4b71eb3d-7d55-4967-b80d-91a3f220b60c</a> (retrieved 2022-06-23)
</p>
<p>Statistik Austria (2022) Politische Bezirke. <a href="https://www.data.gv.at/katalog/dataset/stat_gliederung-osterreichs-in-politische-bezirke131e2">https://www.data.gv.at/katalog/dataset/stat_gliederung-osterreichs-in-politische-bezirke131e2</a> (retrieved 2022-06-27)
</p>
<p>Wieland T (2022) C19dNUTS: Dataset of Regional COVID-19 Deaths per 100,000 Pop (NUTS). R package v1.0.1. <a href="https://doi.org/10.32614/CRAN.package.C19dNUTS">doi:10.32614/CRAN.package.C19dNUTS</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Oesterreich_Faelle)
# Get Austrian COVID19 cases at NUTS 3 level
# (first wave, same final date as in Swiss data: 2020-05-31)

AT_covidwave1 &lt;- 
  swash (
    data = Oesterreich_Faelle,
    col_cases = "Faelle",
    col_date = "Datum",
    col_region = "NUTS3"
  )
# Swash-Backwash Model for Austrian COVID19 cases
# Spatial aggregate: NUTS 3

summary(AT_covidwave1)
# Summary of model results
</code></pre>

<hr>
<h2 id='plot_regions'>
Plots of Regional Infections Over Time
</h2><span id='topic+plot_regions'></span>

<h3>Description</h3>

<p>Plots regional infection curves in <code class="reqn">N</code> plots for <code class="reqn">N</code> regions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_regions(
  object, 
  col = "red", 
  scale = FALSE, 
  normalize_by_col = NULL, 
  normalize_factor = 1
  )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_regions_+3A_object">object</code></td>
<td>

<p>object of class <code>sbm</code>
</p>
</td></tr>
<tr><td><code id="plot_regions_+3A_col">col</code></td>
<td>

<p>Color of line plot
</p>
</td></tr>
<tr><td><code id="plot_regions_+3A_scale">scale</code></td>
<td>

<p>Set y axis of the plots uniformly based on the maximum value across all regions? (boolean, default: <code>FALSE</code>)
</p>
</td></tr>
<tr><td><code id="plot_regions_+3A_normalize_by_col">normalize_by_col</code></td>
<td>

<p>Normalize infection numbers by stating a column in the input data frame (e.g., regional population)
</p>
</td></tr>
<tr><td><code id="plot_regions_+3A_normalize_factor">normalize_factor</code></td>
<td>

<p>Multiply density/incidence with a factor (say, 100,000 inhabitants)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots regional infection curves in <code class="reqn">N</code> plots for <code class="reqn">N</code> regions, with the number of columns equals 4 and the number of rows is calculated based the size of <code class="reqn">N</code>.
</p>


<h3>Value</h3>

<p>Plot, only no returned value
</p>


<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(COVID19Cases_geoRegion)
# Get SWISS COVID19 cases at NUTS 3 level

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[!COVID19Cases_geoRegion$geoRegion %in% c("CH", "CHFL"),]
# Exclude CH = Switzerland total and CHFL = Switzerland and Liechtenstein total

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[COVID19Cases_geoRegion$datum &lt;= "2020-05-31",]
# Extract first COVID-19 wave

CH_covidwave1 &lt;- 
  swash (
    data = COVID19Cases_geoRegion, 
    col_cases = "entries", 
    col_date = "datum", 
    col_region = "geoRegion"
    )
# Swash-Backwash Model for Swiss COVID19 cases
# Spatial aggregate: NUTS 3 (cantons)

plot_regions(CH_covidwave1)
# Plot of regional infections
</code></pre>

<hr>
<h2 id='plot_regions-methods'>Methods for Function <code>plot_regions</code></h2><span id='topic+plot_regions-methods'></span><span id='topic+plot_regions+2Csbm-method'></span>

<h3>Description</h3>

<p>Methods for function <code>plot_regions</code>
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "sbm", col = "red", scale = FALSE, normalize_by_col = NULL, normalize_factor = 1)</code></dt><dd>
<p>Plots regional infection curves in <code class="reqn">N</code> plots for <code class="reqn">N</code> regions, with the number of columns equals 4 and the number of rows is calculated based the size of <code class="reqn">N</code>. Set the color by the argument <code>col</code>. If <code>scale</code> is <code>TRUE</code>, the y axis of the plots is set uniformly based on the maximum value across all regions. If the input data contains a column to normalize the infection numbers (such as regional population), the user may use this data to normalize the infection numbers by setting <code>normalize_by_col</code>. If this density value should be multiplied by a factor (e.g. regional infections per 100,000 inhabitants), this can be set with the argument <code>normalize_by_col</code> (default: 1).
</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Thomas Wieland
</p>

<hr>
<h2 id='plot-methods'>Methods for Function <code>plot</code></h2><span id='topic+plot-methods'></span>

<h3>Description</h3>

<p>Methods for function <code>plot</code>
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "sbm")</code></dt><dd>
<p>Plots the results of the Swash-Backwash Model; two plots: edges over time, total infections per time unit
</p>
</dd>
<dt><code>signature(x = "sbm_ci")</code></dt><dd>
<p>Plots the results of bootstrap confidence intervals for the Swash-Backwash Model; one figure with six plots: <code class="reqn">S_A</code>, <code class="reqn">I_A</code>, <code class="reqn">R_A</code>, <code class="reqn">t_{FE}</code>, <code class="reqn">t_{LE}</code>, and <code class="reqn">R_{0A}</code>
</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Thomas Wieland
</p>

<hr>
<h2 id='print-methods'>Methods for Function <code>print</code></h2><span id='topic+print-methods'></span>

<h3>Description</h3>

<p>Methods for function <code>print</code>
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(x = "sbm")</code></dt><dd>
<p>Prints an <code>sbm</code> object; use <code>summary(sbm)</code> for results
</p>
</dd>
<dt><code>signature(x = "sbm_ci")</code></dt><dd>
<p>Prints an <code>sbm_ci</code> object; use <code>summary(sbm_ci)</code> for results
</p>
</dd>
</dl>

<hr>
<h2 id='quantile_ci'>
Computing Quantiles for a given Numeric Vector
</h2><span id='topic+quantile_ci'></span>

<h3>Description</h3>

<p>Computes quantiles for a given vector <code>x</code> and the related confidence intervals (<code>lower</code>, <code>upper</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantile_ci(
  x, 
  alpha = 0.05
  )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantile_ci_+3A_x">x</code></td>
<td>

<p>A numeric vector
</p>
</td></tr>
<tr><td><code id="quantile_ci_+3A_alpha">alpha</code></td>
<td>

<p>Significance level <code class="reqn">\alpha</code> for 1-<code class="reqn">\alpha</code>*100 confidence intervals
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Helper function for <code>plot(sbm_ci)</code>, but may be used separately.
</p>


<h3>Value</h3>

<p>A numeric vector with lower and upper quantile
</p>


<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>Examples</h3>

<pre><code class='language-R'>numeric_vector &lt;- c(1,9,5,6,3,10,20,6,9,14,3,5,8,6,11)
# any numeric vector

quantile_ci(numeric_vector)
</code></pre>

<hr>
<h2 id='sbm_ci-class'>Class <code>"sbm_ci"</code></h2><span id='topic+sbm_ci-class'></span><span id='topic+plot+2Csbm_ci-method'></span><span id='topic+print+2Csbm_ci-method'></span><span id='topic+show+2Csbm_ci-method'></span><span id='topic+summary+2Csbm_ci-method'></span>

<h3>Description</h3>

<p>The class <code>"sbm_ci"</code> contains the results of the Swash-Backwash Model, confidence intervals for the model estimates, and the related input data as well as additional information. Use <code>summary(sbm_ci)</code> and <code>plot(sbm_ci)</code> for results summary and plotting, respectively. 
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by the function <code>confint(sbm)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>R_0A</code>:</dt><dd><p>Object of class <code>"numeric"</code> Model result: spatial reproduction number <code class="reqn">R_{0A}</code></p>
</dd>
<dt><code>integrals</code>:</dt><dd><p>Object of class <code>"numeric"</code> Model result: integrals <code class="reqn">S_A</code>, <code class="reqn">I_A</code>, and <code class="reqn">R_A</code> </p>
</dd>
<dt><code>velocity</code>:</dt><dd><p>Object of class <code>"numeric"</code> Model result: velocity measures <code class="reqn">t_{FE}</code> and <code class="reqn">t_{LE}</code> </p>
</dd>
<dt><code>occ_regions</code>:</dt><dd><p>Object of class <code>"data.frame"</code> Model result: Occurence at regional level </p>
</dd>
<dt><code>cases_by_date</code>:</dt><dd><p>Object of class <code>"data.frame"</code> Total cases by date </p>
</dd>
<dt><code>cases_by_region</code>:</dt><dd><p>Object of class <code>"data.frame"</code> Cumulative cases by region </p>
</dd>
<dt><code>input_data</code>:</dt><dd><p>Object of class <code>"data.frame"</code> Input data </p>
</dd>
<dt><code>data_statistics</code>:</dt><dd><p>Object of class <code>"numeric"</code> Diagnostics of input data </p>
</dd>
<dt><code>col_names</code>:</dt><dd><p>Object of class <code>"character"</code> Column names in input data </p>
</dd>
<dt><code>integrals_ci</code>:</dt><dd><p>Object of class <code>"list"</code> Confidence intervals for integrals <code class="reqn">S_A</code>, <code class="reqn">I_A</code>, and <code class="reqn">R_A</code> </p>
</dd>
<dt><code>velocity_ci</code>:</dt><dd><p>Object of class <code>"list"</code> Confidence intervals for velocity measures <code class="reqn">t_{FE}</code> and <code class="reqn">t_{LE}</code> </p>
</dd>
<dt><code>R_0A_ci</code>:</dt><dd><p>Object of class <code>"numeric"</code> Confidence intervals for spatial reproduction number <code class="reqn">R_{0A}</code> </p>
</dd>
<dt><code>iterations</code>:</dt><dd><p>Object of class <code>"data.frame"</code> Results of bootstrap sampling iterations </p>
</dd>
<dt><code>ci</code>:</dt><dd><p>Object of class <code>"numeric"</code> Lower and upper confidence intervals based on user input </p>
</dd>
<dt><code>config</code>:</dt><dd><p>Object of class <code>"list"</code> Configuration details for bootstrap sampling </p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>plot</dt><dd><p><code>signature(x = "sbm_ci")</code>: Plots the results of bootstrap confidence intervals for the Swash-Backwash Model; one figure with six plots: <code class="reqn">S_A</code>, <code class="reqn">I_A</code>, <code class="reqn">R_A</code>, <code class="reqn">t_{FE}</code>, <code class="reqn">t_{LE}</code>, and <code class="reqn">R_{0A}</code> </p>
</dd>
<dt>print</dt><dd><p><code>signature(x = "sbm_ci")</code>: Prints an <code>sbm_ci</code> object; use <code>summary(sbm_ci)</code> for results </p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "sbm_ci")</code>: Prints an <code>sbm_ci</code> object; use <code>summary(sbm_ci)</code> for results </p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "sbm_ci")</code>: Prints a summary of <code>sbm_ci</code> objects (bootstrap confidence intervals for Swash-Backwash Model estimates) </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>References</h3>

<p><em>Swash-Backwash Model:</em>
</p>
<p>Cliff AD, Haggett P (2006) A swash-backwash model of the single epidemic wave. <em>Journal of Geographical Systems</em> 8(3), 227-252. <a href="https://doi.org/10.1007/s10109-006-0027-8">doi:10.1007/s10109-006-0027-8</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, Stickler PJ (2022) Meningococcal Meningitis and Coal Mining in Provincial England: Geographical Perspectives on a Major Epidemic, 1929–33. <em>Geographical Analysis</em> 54, 197–216. <a href="https://doi.org/10.1111/gean.12272">doi:10.1111/gean.12272</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, The COVID-19 Genomics UK (COG-UK) Consortium (2022) Spatial growth rate of emerging SARS-CoV-2 lineages in England, September 2020–December 2021. <em>Epidemiology and Infection</em> 150, e145. <a href="https://doi.org/10.1017/S0950268822001285">doi:10.1017/S0950268822001285</a>.
</p>
<p><em>Bootstrapping und bootstrap confidence intervals:</em>
</p>
<p>Efron B, Tibshirani RJ (1993) An Introduction to the Bootstrap.
</p>
<p>Ramachandran KM, Tsokos CP (2021) Mathematical Statistics with Applications in R (Third Edition). Ch. 13.3.1 (Bootstrap confidence intervals). <a href="https://doi.org/10.1016/B978-0-12-817815-7.00013-0">doi:10.1016/B978-0-12-817815-7.00013-0</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("sbm_ci")
</code></pre>

<hr>
<h2 id='sbm-class'>Class <code>"sbm"</code></h2><span id='topic+sbm-class'></span><span id='topic+confint+2Csbm-method'></span><span id='topic+plot+2Csbm-method'></span><span id='topic+print+2Csbm-method'></span><span id='topic+show+2Csbm-method'></span><span id='topic+summary+2Csbm-method'></span>

<h3>Description</h3>

<p>The class <code>"sbm"</code> contains the results of the Swash-Backwash Model and the related input data as well as additional information. Use <code>summary(sbm)</code> and <code>plot(sbm)</code> for results summary and plotting, respectively.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by the function <code>swash</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>R_0A</code>:</dt><dd><p>Object of class <code>"numeric"</code> Model result: spatial reproduction number <code class="reqn">R_{0A}</code></p>
</dd>
<dt><code>integrals</code>:</dt><dd><p>Object of class <code>"numeric"</code> Model result: integrals <code class="reqn">S_A</code>, <code class="reqn">I_A</code>, and <code class="reqn">R_A</code> </p>
</dd>
<dt><code>velocity</code>:</dt><dd><p>Object of class <code>"numeric"</code> Model result: velocity measures <code class="reqn">t_{FE}</code> and <code class="reqn">t_{LE}</code> </p>
</dd>
<dt><code>occ_regions</code>:</dt><dd><p>Object of class <code>"data.frame"</code> Model result: Occurence at regional level </p>
</dd>
<dt><code>SIR_regions</code>:</dt><dd><p>Object of class <code>"data.frame"</code> Model result: Susceptible, infected and recovered regions over time </p>
</dd>
<dt><code>cases_by_date</code>:</dt><dd><p>Object of class <code>"data.frame"</code> Total cases by date </p>
</dd>
<dt><code>cases_by_region</code>:</dt><dd><p>Object of class <code>"data.frame"</code> Cumulative cases by region </p>
</dd>
<dt><code>input_data</code>:</dt><dd><p>Object of class <code>"data.frame"</code> Input data </p>
</dd>
<dt><code>data_statistics</code>:</dt><dd><p>Object of class <code>"numeric"</code> Diagnostics of input data </p>
</dd>
<dt><code>col_names</code>:</dt><dd><p>Object of class <code>"character"</code> Original column names in input data </p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>confint</dt><dd><p><code>signature(object = "sbm")</code>: Creates bootstrap confidence intervals for <code>sbm</code> objects. </p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "sbm")</code>: Plots the results of the Swash-Backwash Model; two plots: edges over time, total infections per time unit </p>
</dd>
<dt>print</dt><dd><p><code>signature(x = "sbm")</code>: Prints an <code>sbm</code> object; use <code>summary(sbm)</code> for results </p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "sbm")</code>: Prints an <code>sbm</code> object; use <code>summary(sbm)</code> for results </p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "sbm")</code>: Prints a summary of <code>sbm</code> objects (results of the Swash-Backwash Model) </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>References</h3>

<p>Cliff AD, Haggett P (2006) A swash-backwash model of the single epidemic wave. <em>Journal of Geographical Systems</em> 8(3), 227-252. <a href="https://doi.org/10.1007/s10109-006-0027-8">doi:10.1007/s10109-006-0027-8</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, Stickler PJ (2022) Meningococcal Meningitis and Coal Mining in Provincial England: Geographical Perspectives on a Major Epidemic, 1929–33. <em>Geographical Analysis</em> 54, 197–216. <a href="https://doi.org/10.1111/gean.12272">doi:10.1111/gean.12272</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, The COVID-19 Genomics UK (COG-UK) Consortium (2022) Spatial growth rate of emerging SARS-CoV-2 lineages in England, September 2020–December 2021. <em>Epidemiology and Infection</em> 150, e145. <a href="https://doi.org/10.1017/S0950268822001285">doi:10.1017/S0950268822001285</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("sbm")
</code></pre>

<hr>
<h2 id='show-methods'>Methods for Function <code>show</code></h2><span id='topic+show-methods'></span>

<h3>Description</h3>

<p>Methods for function <code>show</code>
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "sbm")</code></dt><dd>
<p>Prints an <code>sbm</code> object; use <code>summary(sbm)</code> for results
</p>
</dd>
<dt><code>signature(object = "sbm_ci")</code></dt><dd>
<p>Prints an <code>sbm_ci</code> object; use <code>summary(sbm_ci)</code> for results
</p>
</dd>
</dl>

<hr>
<h2 id='summary-methods'>Methods for Function <code>summary</code></h2><span id='topic+summary-methods'></span>

<h3>Description</h3>

<p>Methods for function <code>summary</code>
</p>


<h3>Methods</h3>


<dl>
<dt><code>signature(object = "sbm")</code></dt><dd>
<p>Prints a summary of <code>sbm</code> objects (results of the Swash-Backwash Model)
</p>
</dd>
<dt><code>signature(object = "sbm_ci")</code></dt><dd>
<p>Prints a summary of <code>sbm_ci</code> objects (bootstrap confidence intervals for Swash-Backwash Model estimates)
</p>
</dd>
<dt><code>signature(object = "countries")</code></dt><dd>
<p>Prints a summary of a <code>countries</code> object built with the function <code><a href="#topic+compare_countries">compare_countries</a></code>
</p>
</dd>
</dl>

<hr>
<h2 id='swash'>
Swash-Backwash Model for the Single Epidemic Wave
</h2><span id='topic+swash'></span>

<h3>Description</h3>

<p>Analysis of regional infection/surveillance data using the Swash-Backwash Model for the single epidemic wave by Cliff and Haggett (2006)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swash(
  data, 
  col_cases, 
  col_date, 
  col_region
  )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="swash_+3A_data">data</code></td>
<td>

<p><code>data.frame</code> with regional infection data
</p>
</td></tr>
<tr><td><code id="swash_+3A_col_cases">col_cases</code></td>
<td>

<p>Column containing the cases (numeric)
</p>
</td></tr>
<tr><td><code id="swash_+3A_col_date">col_date</code></td>
<td>

<p>Column containing the time points (e.g., days)
</p>
</td></tr>
<tr><td><code id="swash_+3A_col_region">col_region</code></td>
<td>

<p>Column containing the unique identifier of the regions (e.g., name, NUTS 3 code)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function performs the analysis of the input panel data using the Swash-Backwash Model. The output is an object of class <code>"sbm"</code>. The results can be viewed using <code>summary(sbm)</code>. 
</p>


<h3>Value</h3>

<p>object of class <code><a href="#topic+sbm-class">sbm-class</a></code>
</p>


<h3>Author(s)</h3>

<p>Thomas Wieland
</p>


<h3>References</h3>

<p>Cliff AD, Haggett P (2006) A swash-backwash model of the single epidemic wave. <em>Journal of Geographical Systems</em> 8(3), 227-252. <a href="https://doi.org/10.1007/s10109-006-0027-8">doi:10.1007/s10109-006-0027-8</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, Stickler PJ (2022) Meningococcal Meningitis and Coal Mining in Provincial England: Geographical Perspectives on a Major Epidemic, 1929–33. <em>Geographical Analysis</em> 54, 197–216. <a href="https://doi.org/10.1111/gean.12272">doi:10.1111/gean.12272</a>
</p>
<p>Smallman-Raynor MR, Cliff AD, The COVID-19 Genomics UK (COG-UK) Consortium (2022) Spatial growth rate of emerging SARS-CoV-2 lineages in England, September 2020–December 2021. <em>Epidemiology and Infection</em> 150, e145. <a href="https://doi.org/10.1017/S0950268822001285">doi:10.1017/S0950268822001285</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sbm-class">sbm-class</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(COVID19Cases_geoRegion)
# Get SWISS COVID19 cases at NUTS 3 level

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[!COVID19Cases_geoRegion$geoRegion %in% c("CH", "CHFL"),]
# Exclude CH = Switzerland total and CHFL = Switzerland and Liechtenstein total

COVID19Cases_geoRegion &lt;- 
  COVID19Cases_geoRegion[COVID19Cases_geoRegion$datum &lt;= "2020-05-31",]
# Extract first COVID-19 wave

CH_covidwave1 &lt;- 
  swash (
    data = COVID19Cases_geoRegion, 
    col_cases = "entries", 
    col_date = "datum", 
    col_region = "geoRegion"
    )
# Swash-Backwash Model for Swiss COVID19 cases
# Spatial aggregate: NUTS 3 (cantons)

summary(CH_covidwave1)
# Summary of Swash-Backwash Model

plot(CH_covidwave1)
# Plot of Swash-Backwash Model edges and total epidemic curve
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
