<!DOCTYPE html><html lang="en"><head><title>Help for package Rsmlx</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rsmlx}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bootmlx'><p>Bootstrapping - case resampling</p></a></li>
<li><a href='#buildAll'><p>Automatic complete statistical model building</p></a></li>
<li><a href='#buildmlx'><p>Automatic statistical model building</p></a></li>
<li><a href='#buildVar'><p>Automatic model variance building</p></a></li>
<li><a href='#confintmlx'><p>Confidence intervals for population parameters</p></a></li>
<li><a href='#covariateSearch'><p>Covariate model building</p></a></li>
<li><a href='#getEstimatedCovarianceMatrix'><p>Get estimated covariance and correlation matrices</p></a></li>
<li><a href='#getEstimatedIndividualParameters2'><p>Get estimated individual and population parameters</p></a></li>
<li><a href='#getEstimatedPredictions'><p>Get estimated predictions</p></a></li>
<li><a href='#getEstimatedResiduals'><p>Get estimated residuals</p></a></li>
<li><a href='#getSimulatedPredictions'><p>Get simulated predictions</p></a></li>
<li><a href='#getSimulatedResiduals'><p>Get simulated residuals</p></a></li>
<li><a href='#initRsmlx'><p>Initialize Rsmlx library</p></a></li>
<li><a href='#pkbuild'><p>Automatic PK model building</p></a></li>
<li><a href='#pkpopini'><p>Compute initial population PK parameters</p></a></li>
<li><a href='#readDatamlx'><p>Read formatted data file</p></a></li>
<li><a href='#resMonolix'><p>Monolix results</p></a></li>
<li><a href='#RsmlxDemo1.project'><p>Monolix project for warfarin PK - 1</p></a></li>
<li><a href='#RsmlxDemo2.project'><p>Monolix project for warfarin PK - 2</p></a></li>
<li><a href='#setSettings'><p>Easy tuning of the settings of a Monolix project</p></a></li>
<li><a href='#testmlx'><p>Statistical tests for model assessment</p></a></li>
<li><a href='#warfarin.data'><p>warfarin PKPD data</p></a></li>
<li><a href='#whichPKmodel'><p>Find a Monolix PK model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>R Speaks 'Monolix'</td>
</tr>
<tr>
<td>Version:</td>
<td>2024.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chloe Bracis &lt;support@lixoft.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides methods for model building and model evaluation of mixed effects models using 
    'Monolix' <a href="https://monolix.lixoft.com">https://monolix.lixoft.com</a>. 'Monolix' is a software tool for nonlinear mixed effects 
    modeling that must have been installed in order to use 'Rsmlx'. 
    Among other tasks, 'Rsmlx' provides a powerful tool for automatic PK model building, performs 
    statistical tests for model assessment, bootstrap simulation and likelihood profiling for 
    computing confidence intervals. 'Rsmlx' also proposes several automatic covariate search methods for 
    mixed effects models. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://monolix.lixoft.com/rsmlx/">https://monolix.lixoft.com/rsmlx/</a></td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>'Monolix' (&lt;https://monolix.lixoft.com&gt;)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, utils, stats, MASS, ggplot2, gridExtra,
dplyr, tidyr</td>
</tr>
<tr>
<td>Collate:</td>
<td>mlxConnectors.R bootstrap.R buildmlx.R buildVar.R buildAll.R
confintmlx.R correlationModelSelection.R
covariateModelSelection.R covariateSearch.R
errorModelSelection.R llp.R newConnectors.R setSettings.R
testmlx.R zzz.R RsmlxTools.R readDatamlx.R pkbuild.R pkpopini.R
whichPKmodel.R</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>Copyright:</td>
<td>Inria</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-10 13:19:46 UTC; cbracis</td>
</tr>
<tr>
<td>Author:</td>
<td>Chloe Bracis [ctb, cre],
  Frano Mihaljevic [aut],
  Marc Lavielle [aut],
  Jonathan Chauvin [ctb],
  Cl√©mence Pinaud [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-10 13:30:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='bootmlx'>Bootstrapping - case resampling</h2><span id='topic+bootmlx'></span>

<h3>Description</h3>

<p>Generate replicates of the original data using random sampling with replacement.
Population parameters are then estimated from each replicate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootmlx(
  project,
  nboot = 100,
  dataFolder = NULL,
  parametric = FALSE,
  tasks = c(populationParameterEstimation = TRUE),
  settings = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootmlx_+3A_project">project</code></td>
<td>
<p>Monolix project</p>
</td></tr>
<tr><td><code id="bootmlx_+3A_nboot">nboot</code></td>
<td>
<p>[optional] number of bootstrap replicates (default=100)</p>
</td></tr>
<tr><td><code id="bootmlx_+3A_datafolder">dataFolder</code></td>
<td>
<p>[optional] folder where already generated datasets are stored, e.g dataFolder=&quot;./dummy_project/boot/&quot; (default: data set are generated by bootmlx)</p>
</td></tr>
<tr><td><code id="bootmlx_+3A_parametric">parametric</code></td>
<td>
<p>[optional] boolean to define if parametric bootstrap is performed (new data is drawn from the model), (default: false)</p>
</td></tr>
<tr><td><code id="bootmlx_+3A_tasks">tasks</code></td>
<td>
<p>[optional] vector of booleans defining the list of tasks to perform (default: estimation of the population parameters)
available tasks: populationParameterEstimation, conditionalDistributionSampling,
conditionalModeEstimation, standardErrorEstimation, logLikelihoodEstimation, plots</p>
</td></tr>
<tr><td><code id="bootmlx_+3A_settings">settings</code></td>
<td>
<p>[optional] a list of settings for the resampling and the results:
</p>

<ul>
<li> <p><code>N</code> the number of individuals in each bootstrap data set 
(default value is the  number of individuals in the original data set).
</p>
</li>
<li> <p><code>newResampling</code> boolean to generate the data sets again if they already exist (default=FALSE).
</p>
</li>
<li> <p><code>covStrat</code> a categorical covariate of the project. The original distribution of this covariate
is maintained in each resampled data set if covStrat is defined (default=NULL). Notice that if the categorical covariate is varying 
within the subject (in case of IOV), it will not be taken into account.
</p>
</li>
<li> <p><code>plot</code> boolean to choose if the distribution of the bootstraped esimates is displayed
(default = FALSE)
</p>
</li>
<li> <p><code>level</code> level of the bootstrap confidence intervals of the population parameters
(default = 0.90)
</p>
</li>
<li> <p><code>seed</code> a positive integer &lt; 2147483647, seed for the generation of the data sets (default = NA)
</p>
</li>
<li> <p><code>deleteData</code> delete created data set files after estimation (default = FALSE)
</p>
</li>
<li> <p><code>deleteProjects</code> delete created Monolix projects after estimation (default = FALSE)
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>Bootstrap functionality is now available directly in the lixoftConnectors package using the function
<code>runBootstrap</code>. Please migrate, as this function will be deprecated in the future.
</p>


<h3>Value</h3>

<p>a data frame with the bootstrap estimates
</p>


<h3>See Also</h3>

<p><code>getBootstrapSettings</code> settings for bootstrap with lixoftConnectors <br />
<code>runBootstrap</code> run the bootstrap with lixoftConnectors <br />
<code>getBootstrapResults</code> results for bootstrap with lixoftConnectors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# RsmlxDemo1.mlxtran is a Monolix project for modelling the PK of warfarin using a PK model 
# with parameters ka, V, Cl.

# In this example, bootmlx will generate 100 random replicates of the original data and will
# use Monolix to estimate the population parameters from each of these 100 replicates:
r1 &lt;- bootmlx(project="RsmlxDemo1.mlxtran")
  
# 5 replicates will now be generated, with 50 individuals in each replicate:
r2 &lt;- bootmlx(project="RsmlxDemo1.mlxtran",  nboot = 5, settings = list(N = 50))

# Proportions of males and females in the original dataset will be preserved   
# in each replicate:
r3 &lt;- bootmlx(project="RsmlxDemo1.mlxtran",  settings = list(covStrat = "sex"))

## End(Not run)

# See http://monolix.lixoft.com/rsmlx/bootmlx/ for detailed examples of use of bootmlx
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation


</code></pre>

<hr>
<h2 id='buildAll'>Automatic complete statistical model building</h2><span id='topic+buildAll'></span>

<h3>Description</h3>

<p>buildAll builds the complete statistical model by iteratively calling functions
buildmlx and buildVar 
</p>
<p>Penalization criterion can be either a custom penalization of the form gamma*(number of parameters),
AIC (gamma=2) or BIC (gamma=log(N)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildAll(
  project = NULL,
  final.project = NULL,
  model = "all",
  prior = NULL,
  weight = NULL,
  coef.w1 = 0.5,
  cv.min = 0.001,
  fError.min = 0.001,
  paramToUse = "all",
  covToTest = "all",
  covToTransform = "none",
  center.covariate = FALSE,
  criterion = "BICc",
  linearization = FALSE,
  ll = T,
  test = T,
  direction = NULL,
  steps = 1000,
  max.iter = 20,
  explor.iter = 2,
  seq.cov = FALSE,
  seq.corr = TRUE,
  seq.cov.iter = 0,
  p.max = 0.1,
  p.min = c(0.075, 0.05, 0.1),
  print = TRUE,
  nb.model = 1,
  fix.param1 = NULL,
  fix.param0 = NULL,
  remove = T,
  add = T,
  delta = c(30, 10, 5),
  omega.set = NULL,
  pop.set1 = NULL,
  pop.set2 = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="buildAll_+3A_project">project</code></td>
<td>
<p>a string: the initial Monolix project</p>
</td></tr>
<tr><td><code id="buildAll_+3A_final.project">final.project</code></td>
<td>
<p>a string: the final Monolix project (default adds &quot;_buildAll&quot; to the original project)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_model">model</code></td>
<td>
<p>components of the model to optimize c(&quot;residualError&quot;, &quot;covariate&quot;, &quot;correlation&quot;), (default=&quot;all&quot;)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_prior">prior</code></td>
<td>
<p>list of prior probabilities for each component of the model (default=NULL)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_weight">weight</code></td>
<td>
<p>list of penalty weights for each component of the model (default=NULL)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_coef.w1">coef.w1</code></td>
<td>
<p>multiplicative weight coefficient used for the first iteration only (default=0.5)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_cv.min">cv.min</code></td>
<td>
<p>value of the coefficient of variation below which an individual parameter is considered fixed (default=0.001)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_ferror.min">fError.min</code></td>
<td>
<p>minimum fraction of residual variance for combined error model (default = 1e-3)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_paramtouse">paramToUse</code></td>
<td>
<p>list of parameters possibly function of covariates (default=&quot;all&quot;)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_covtotest">covToTest</code></td>
<td>
<p>components of the covariate model that can be modified   (default=&quot;all&quot;)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_covtotransform">covToTransform</code></td>
<td>
<p>list of (continuous) covariates to be log-transformed (default=&quot;none&quot;)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_center.covariate">center.covariate</code></td>
<td>
<p>TRUE/FALSE center the covariates of the final model (default=FALSE)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_criterion">criterion</code></td>
<td>
<p>penalization criterion to optimize c(&quot;AIC&quot;, &quot;BIC&quot;, &quot;BICc&quot;, gamma)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_linearization">linearization</code></td>
<td>
<p>TRUE/FALSE whether the computation of the likelihood is based on a linearization of the model (default=FALSE, deprecated)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_ll">ll</code></td>
<td>
<p>TRUE/FALSE  compute the observe likelihood and the criterion to optimize at each iteration</p>
</td></tr>
<tr><td><code id="buildAll_+3A_test">test</code></td>
<td>
<p>TRUE/FALSE  perform additional statistical tests for building the model (default=TRUE)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_direction">direction</code></td>
<td>
<p>method for covariate search c(&quot;full&quot;, &quot;both&quot;, &quot;backward&quot;, &quot;forward&quot;), (default=&quot;full&quot; or &quot;both&quot;)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_steps">steps</code></td>
<td>
<p>maximum number of iteration for stepAIC (default=1000)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_max.iter">max.iter</code></td>
<td>
<p>maximum number of iterations (default=20)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_explor.iter">explor.iter</code></td>
<td>
<p>number of iterations during the exploratory phase (default=2)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_seq.cov">seq.cov</code></td>
<td>
<p>TRUE/FALSE whether the covariate model is built before the correlation model</p>
</td></tr>
<tr><td><code id="buildAll_+3A_seq.corr">seq.corr</code></td>
<td>
<p>TRUE/FALSE whether the correlation model is built iteratively (default=TRUE)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_seq.cov.iter">seq.cov.iter</code></td>
<td>
<p>number of iterations before building the correlation model (only when seq.cov=F, default=0)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_p.max">p.max</code></td>
<td>
<p>maximum p-value used for removing non significant relationships between covariates and individual parameters (default=0.1)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_p.min">p.min</code></td>
<td>
<p>minimum p-values used for testing the components of a new model (default=c(0.075, 0.05, 0.1))</p>
</td></tr>
<tr><td><code id="buildAll_+3A_print">print</code></td>
<td>
<p>TRUE/FALSE display the results (default=TRUE)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_nb.model">nb.model</code></td>
<td>
<p>number of models to display at each iteration (default=1)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_fix.param1">fix.param1</code></td>
<td>
<p>parameters with variability that cannot be removed (default=NULL)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_fix.param0">fix.param0</code></td>
<td>
<p>parameters without variability that cannot be added (default=NULL)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_remove">remove</code></td>
<td>
<p>try to remove random effects (default=T)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_add">add</code></td>
<td>
<p>try to add random effects (default=T)</p>
</td></tr>
<tr><td><code id="buildAll_+3A_delta">delta</code></td>
<td>
<p>maximum difference in criteria for testing a new model (default=c(30,10,5))</p>
</td></tr>
<tr><td><code id="buildAll_+3A_omega.set">omega.set</code></td>
<td>
<p>settings to define how a variance varies during iterations of SAEM</p>
</td></tr>
<tr><td><code id="buildAll_+3A_pop.set1">pop.set1</code></td>
<td>
<p>Monolix settings 1</p>
</td></tr>
<tr><td><code id="buildAll_+3A_pop.set2">pop.set2</code></td>
<td>
<p>Monolix settings 2</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See https://monolix.lixoft.com/rsmlx/ for more details.
</p>


<h3>Value</h3>

<p>a new Monolix project with a new statistical model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Build the complete statistical model using the default settings
r1 &lt;- buildAll(project="warfarinPK_project.mlxtran")

# Force parameter Tlag to be fixed (no variability) and parameter Cl to vary
r2 &lt;- buildAll(project="warfarinPK_project.mlxtran", fix.param0="Tlag", fix.param1="Cl")

# Estimate the log-likelihood by linearization of the model (faster)
r3 &lt;- buildAll(project="warfarinPK_project.mlxtran", linearization=T)


## End(Not run)

# See http://monolix.lixoft.com/rsmlx/buildmlx/ for detailed examples of use of buildmlx
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

</code></pre>

<hr>
<h2 id='buildmlx'>Automatic statistical model building</h2><span id='topic+buildmlx'></span>

<h3>Description</h3>

<p>Automatic statistical model building is available directly in the lixoftConnectors package using the function
<code>runModelBuilding</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildmlx(
  project = NULL,
  final.project = NULL,
  model = "all",
  prior = NULL,
  weight = NULL,
  coef.w1 = 0.5,
  paramToUse = "all",
  covToTest = "all",
  covToTransform = "none",
  center.covariate = FALSE,
  criterion = "BICc",
  linearization = FALSE,
  ll = T,
  test = T,
  direction = NULL,
  steps = 1000,
  n.full = 10,
  max.iter = 20,
  explor.iter = 2,
  fError.min = 0.001,
  seq.cov = FALSE,
  seq.cov.iter = 0,
  seq.corr = TRUE,
  p.max = 0.1,
  p.min = c(0.075, 0.05, 0.1),
  print = TRUE,
  nb.model = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="buildmlx_+3A_project">project</code></td>
<td>
<p>a string: the initial Monolix project</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_final.project">final.project</code></td>
<td>
<p>a string: the final Monolix project (default adds &quot;_built&quot; to the original project)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_model">model</code></td>
<td>
<p>components of the model to optimize c(&quot;residualError&quot;, &quot;covariate&quot;, &quot;correlation&quot;), (default=&quot;all&quot;)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_prior">prior</code></td>
<td>
<p>list of prior probabilities for each component of the model (default=NULL)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_weight">weight</code></td>
<td>
<p>list of penalty weights for each component of the model (default=NULL)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_coef.w1">coef.w1</code></td>
<td>
<p>multiplicative weight coefficient used for the first iteration only (default=0.5)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_paramtouse">paramToUse</code></td>
<td>
<p>list of parameters possibly function of covariates (default=&quot;all&quot;)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_covtotest">covToTest</code></td>
<td>
<p>components of the covariate model that can be modified   (default=&quot;all&quot;)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_covtotransform">covToTransform</code></td>
<td>
<p>list of (continuous) covariates to be log-transformed (default=&quot;none&quot;)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_center.covariate">center.covariate</code></td>
<td>
<p>TRUE/FALSE center the covariates of the final model (default=FALSE)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_criterion">criterion</code></td>
<td>
<p>penalization criterion to optimize c(&quot;AIC&quot;, &quot;BIC&quot;, &quot;BICc&quot;, gamma) (default=BICc)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_linearization">linearization</code></td>
<td>
<p>TRUE/FALSE whether the computation of the likelihood is based on a linearization of the model (default=FALSE)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_ll">ll</code></td>
<td>
<p>TRUE/FALSE  compute the observe likelihood and the criterion to optimize at each iteration</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_test">test</code></td>
<td>
<p>TRUE/FALSE  perform additional statistical tests for building the model (default=TRUE)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_direction">direction</code></td>
<td>
<p>method for covariate search c(&quot;full&quot;, &quot;both&quot;, &quot;backward&quot;, &quot;forward&quot;), (default=&quot;full&quot; or &quot;both&quot;)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_steps">steps</code></td>
<td>
<p>maximum number of iteration for stepAIC (default=1000)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_n.full">n.full</code></td>
<td>
<p>maximum number of covariates for an exhaustive comparison of all possible covariate models (default=10)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_max.iter">max.iter</code></td>
<td>
<p>maximum number of iterations (default=20)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_explor.iter">explor.iter</code></td>
<td>
<p>number of iterations during the exploratory phase (default=2)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_ferror.min">fError.min</code></td>
<td>
<p>minimum fraction of residual variance for combined error model (default = 1e-3)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_seq.cov">seq.cov</code></td>
<td>
<p>TRUE/FALSE whether the covariate model is built before the correlation model</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_seq.cov.iter">seq.cov.iter</code></td>
<td>
<p>number of iterations before building the correlation model (only when seq.cov=F, default=0)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_seq.corr">seq.corr</code></td>
<td>
<p>TRUE/FALSE whether the correlation model is built iteratively (default=TRUE)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_p.max">p.max</code></td>
<td>
<p>maximum p-value used for removing non significant relationships between covariates and individual parameters (default=0.1)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_p.min">p.min</code></td>
<td>
<p>vector of 3 minimum p-values used for testing the components of a new model (default=c(0.075, 0.05, 0.1))</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_print">print</code></td>
<td>
<p>TRUE/FALSE display the results (default=TRUE)</p>
</td></tr>
<tr><td><code id="buildmlx_+3A_nb.model">nb.model</code></td>
<td>
<p>number of models to display at each iteration (default=1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>buildmlx uses SAMBA (Stochastic Approximation for Model Building Algorithm), an iterative procedure to accelerate and optimize the process of model building by identifying 
at each step how best to improve some of the model components. This method allows to find 
the optimal statistical model which minimizes some information criterion in very few steps.
</p>
<p>Penalization criterion can be either a custom penalization of the form gamma*(number of parameters),
AIC (gamma=2) or BIC (gamma=log(N)).
</p>
<p>Several strategies can be used for building the covariate model at each iteration of the algorithm: 
<code>direction="full"</code> means that all the possible models are compared (default when the number of covariates
is less than 10). Othrwise, <code>direction</code> is the mode of stepwise search of <code>stepAIC {MASS}</code>, 
can be one of &quot;both&quot;, &quot;backward&quot;, or &quot;forward&quot;, with a default of &quot;both&quot; when there are at least 10 covariates.
See https://monolix.lixoft.com/rsmlx/ for more details.
</p>


<h3>Value</h3>

<p>a new Monolix project with a new statistical model.
</p>


<h3>See Also</h3>

<p><code>getModelBuildingSettings</code> settings for model building with lixoftConnectors <br />
<code>runModelBuilding</code> run model building with lixoftConnectors <br />
<code>getModelBuildingResults</code> results for model building with lixoftConnectors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# RsmlxDemo1.mlxtran is a Monolix project for modelling the pharmacokinetics (PK) of warfarin 
# using a PK model with parameters ka, V, Cl.

# By default, buildmlx will compute the best statistical model in term of BIC, i.e , 
# the best covariate model, the best correlation model for the three random effects and the best 
# residual error model in terms of BIC. 
# In this example, three covariates (wt, age, sex) are available with the data and will be used 
# for building the covariate model for the three PK parameters:
r1 &lt;- buildmlx(project="RsmlxDemo1.mlxtran")
  
# Here, the covariate model will be built for V and Cl only and log-transformation of all 
# continuous covariates will also be considered:
r2 &lt;- buildmlx(project="RsmlxDemo1.mlxtran", paramToUse=c("V", "Cl"), covToTransform="all") 

# Only the covariate model will be  built, using AIC instead of BIC:
r3 &lt;- buildmlx(project="RsmlxDemo1.mlxtran", model="covariate", criterion="AIC") 

## End(Not run)

# See http://monolix.lixoft.com/rsmlx/buildmlx/ for detailed examples of use of buildmlx
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

</code></pre>

<hr>
<h2 id='buildVar'>Automatic model variance building</h2><span id='topic+buildVar'></span>

<h3>Description</h3>

<p>buildVar is designed to build the best variance model for the random effects by selecting
which individual parameters vary and which ones are fixed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildVar(
  project = NULL,
  final.project = NULL,
  prior = NULL,
  weight = NULL,
  cv.min = 0.001,
  fix.param1 = NULL,
  fix.param0 = NULL,
  criterion = "BICc",
  linearization = F,
  remove = T,
  add = T,
  delta = c(30, 10, 5),
  omega.set = NULL,
  pop.set1 = NULL,
  pop.set2 = NULL,
  print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="buildVar_+3A_project">project</code></td>
<td>
<p>a string: the initial Monolix project</p>
</td></tr>
<tr><td><code id="buildVar_+3A_final.project">final.project</code></td>
<td>
<p>a string: the final Monolix project (default adds &quot;_var&quot; to the original project)</p>
</td></tr>
<tr><td><code id="buildVar_+3A_prior">prior</code></td>
<td>
<p>named vector of prior probabilities (default=NULL)</p>
</td></tr>
<tr><td><code id="buildVar_+3A_weight">weight</code></td>
<td>
<p>named vector of weights (default=NULL)</p>
</td></tr>
<tr><td><code id="buildVar_+3A_cv.min">cv.min</code></td>
<td>
<p>value of the coefficient of variation below which an individual parameter is considered fixed (default=0.001)</p>
</td></tr>
<tr><td><code id="buildVar_+3A_fix.param1">fix.param1</code></td>
<td>
<p>parameters with variability that cannot be removed (default=NULL)</p>
</td></tr>
<tr><td><code id="buildVar_+3A_fix.param0">fix.param0</code></td>
<td>
<p>parameters without variability that cannot be added (default=NULL)</p>
</td></tr>
<tr><td><code id="buildVar_+3A_criterion">criterion</code></td>
<td>
<p>penalization criterion to optimize c(&quot;AIC&quot;, &quot;BIC&quot;, &quot;BICc&quot;, gamma) (default=BICc)</p>
</td></tr>
<tr><td><code id="buildVar_+3A_linearization">linearization</code></td>
<td>
<p>TRUE/FALSE whether the computation of the likelihood is based on a linearization of the model (default=FALSE)</p>
</td></tr>
<tr><td><code id="buildVar_+3A_remove">remove</code></td>
<td>
<p>TRUE/FALSE try to remove random effects (default=TRUE)</p>
</td></tr>
<tr><td><code id="buildVar_+3A_add">add</code></td>
<td>
<p>TRUE/FALSE try to add random effects (default=TRUE)</p>
</td></tr>
<tr><td><code id="buildVar_+3A_delta">delta</code></td>
<td>
<p>maximum difference in criteria for testing a new model (default=c(30,10,5))</p>
</td></tr>
<tr><td><code id="buildVar_+3A_omega.set">omega.set</code></td>
<td>
<p>settings to define how a variance varies during iterations of SAEM</p>
</td></tr>
<tr><td><code id="buildVar_+3A_pop.set1">pop.set1</code></td>
<td>
<p>Monolix settings 1</p>
</td></tr>
<tr><td><code id="buildVar_+3A_pop.set2">pop.set2</code></td>
<td>
<p>Monolix settings 2</p>
</td></tr>
<tr><td><code id="buildVar_+3A_print">print</code></td>
<td>
<p>TRUE/FALSE display the results (default=TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Penalization criterion can be either a custom penalization of the form gamma*(number of parameters),
AIC (gamma=2) or BIC (gamma=log(N)).
</p>
<p>See https://monolix.lixoft.com/rsmlx/ for more details.
</p>


<h3>Value</h3>

<p>a new Monolix project with a new inter individual variability model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Build the variability model using the default settings
r1 &lt;- buildVar(project="warfarinPK_project.mlxtran")

# Force parameter Tlag to be fixed (no variability) and parameter Cl to vary
r2 &lt;- buildVar(project="warfarinPK_project.mlxtran", fix.param0="Tlag", fix.param1="Cl")

# Estimate the log-likelihood by linearization of the model (faster)
r3 &lt;- buildVar(project="warfarinPK_project.mlxtran", linearization=T)


## End(Not run)

# See http://monolix.lixoft.com/rsmlx/buildvar/ for detailed examples of use of buildvar
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation


</code></pre>

<hr>
<h2 id='confintmlx'>Confidence intervals for population parameters</h2><span id='topic+confintmlx'></span>

<h3>Description</h3>

<p>Compute confidence intervals for the population parameters estimated by Monolix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confintmlx(
  project,
  parameters = "all",
  method = "fim",
  level = 0.9,
  linearization = TRUE,
  nboot = 100,
  parametric = FALSE,
  settings = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confintmlx_+3A_project">project</code></td>
<td>
<p>a Monolix project</p>
</td></tr>
<tr><td><code id="confintmlx_+3A_parameters">parameters</code></td>
<td>
<p>list of parameters for which confidence intervals are computed (default=&quot;all&quot;)</p>
</td></tr>
<tr><td><code id="confintmlx_+3A_method">method</code></td>
<td>
<p>method <code>c("fim", "proflike", "bootstrap")</code> (default=&quot;fim&quot;)</p>
</td></tr>
<tr><td><code id="confintmlx_+3A_level">level</code></td>
<td>
<p>confidence level, a real number between 0 and 1 (default=0.90)</p>
</td></tr>
<tr><td><code id="confintmlx_+3A_linearization">linearization</code></td>
<td>
<p>TRUE/FALSE  whether the calculation of the standard errors (default=TRUE)
or the profile likelihood  is based on a linearization of the model (default=TRUE)</p>
</td></tr>
<tr><td><code id="confintmlx_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrat replicates (default=100, used when method=&quot;bootstrap&quot;)</p>
</td></tr>
<tr><td><code id="confintmlx_+3A_parametric">parametric</code></td>
<td>
<p>boolean to define if parametric bootstrap is performed (new data is drawn from the model), (default: FALSE)</p>
</td></tr>
<tr><td><code id="confintmlx_+3A_settings">settings</code></td>
<td>
<p>a list of settings for the profile likelihood method:
</p>

<ul>
<li> <p><code>max.iter</code> maximum number of iterations to find the solution (default=10)
</p>
</li>
<li> <p><code>tol.LL</code> absolute tolerance for -2LL  (default=0.001)
</p>
</li>
<li> <p><code>tol.param</code> relative tolerance for the parameter (default=0.01)
</p>
</li>
<li> <p><code>print</code> TRUE/FALSE display the results (default=TRUE)
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>Most functionality to compute confidence intervals (other than profile likelihood) is 
now available directly in the lixoftConnectors package. Please migrate 
the following uses of this function:
</p>

<table>
<tr>
 <td style="text-align: left;">
confintmlx method </td><td style="text-align: left;"> </td><td style="text-align: left;"> lixoftConnectors function </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"fim"</code> </td><td style="text-align: left;"> <code>linearizarion = TRUE</code> </td><td style="text-align: left;"> <code>getEstimatedConfidenceIntervals</code> (method = "linearization") </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"fim"</code> </td><td style="text-align: left;"> <code>linearizarion = FALSE</code> </td><td style="text-align: left;"> <code>getEstimatedConfidenceIntervals</code> (method = "stochasticApproximation") </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"bootstrap"</code> </td><td style="text-align: left;"> <code>parametric = TRUE</code> </td><td style="text-align: left;"> <code>runBootstrap</code> (method = "parametric") </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>"bootstrap"</code> </td><td style="text-align: left;"> <code>parametric = FALSE</code> </td><td style="text-align: left;"> <code>runBootstrap</code> (method = "nonparametric") </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>For <code>method="proflike"</code>, continue using this function.
</p>
<p>The method used for computing the confidence intervals can be either based on the 
standard errors derived from an estimation of the Fisher Information Matrix (&quot;fim&quot;),
on the profile likelihood (&quot;proflike&quot;) or on nonparametric bootstrap estimate (&quot;bootstrap&quot;).
<code>method="fim"</code> is used by default.
</p>
<p>When <code>method="fim"</code>, the FIM can be either estimated using a linearization of the model 
or a stochastic approximation. When <code>method="proflike"</code>, the observed likelihood can be 
either estimated using a linearization of the model or an importance sampling Monte Carlo 
procedure. When <code>method="bootstrap"</code>, the bootstrap estimates are obtained using the bootmlx
function
</p>


<h3>Value</h3>

<p>a list with the computed confidence intervals, the method used and the level.
</p>


<h3>See Also</h3>

<p><code>getEstimatedConfidenceIntervals</code> replaces this function for <code>method = "fim"</code> in lixoftConnectors <br />
<code>runBootstrap</code> replaces this function for <code>method = "bootstrap"</code> in lixoftConnectors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# RsmlxDemo2.mlxtran is a Monolix project for modelling the PK of warfarin using a PK model 
# with parameters ka, V, Cl.

# confintmlx will compute a 90% confidence interval for all the population parameters 
# using the population estimates obtained by Monolix and the Fisher Information Matrix 
# estimated by linearization
r1 &lt;- confintmlx(project="RsmlxDemo2.mlxtran") 

# 95% confidence intervals are now computed, using the FIM estimated by Monolix using a 
# stochastic approximation algorithm:
r2 &lt;- confintmlx(project="RsmlxDemo2.mlxtran", linearization=FALSE, level=0.95) 

# Confidence intervals are computed for ka_pop and omega_ka only, 
# using the profile likelihood method:
r &lt;- confintmlx(project    = "RsmlxDemo2.mlxtran", 
                method     = "proflike", 
                parameters = c("ka_pop","omega_ka")) 

# Confidence intervals are computed using 200 bootstrap samples:
r3 &lt;- confintmlx(project="RsmlxDemo2.mlxtran", method="bootstrap", nboot=200)

## End(Not run)

# See http://monolix.lixoft.com/rsmlx/confintmlx/ for detailed examples of use of confintmlx
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

</code></pre>

<hr>
<h2 id='covariateSearch'>Covariate model building</h2><span id='topic+covariateSearch'></span>

<h3>Description</h3>

<p>Automatic search of the best covariate model. Automatic covariate model building is available directly in the lixoftConnectors package using the function
<code>runModelBuilding</code>. Please migrate, as this function will be deprecated in the future. <br /> <br />
Two methods for covariate model building are proposed
</p>

<ul>
<li><p> SCM: stepwise covariate modeling method
In the forward selection, at each step, each of the remaining (i.e not yet included) parameter-covariate relationships are added to the model in an univariate model (one model per relationship), and run. Among all models, the model that improves some criteria (LRT, BIC or AIC) most is selected and taken forward to the next step.
During backward elimination, parameter-covariate relationships are removed in an univariate manner. 
</p>
</li>
<li><p> COSSAC: COnditional Sampling for Stepwise Approach based on Correlation tests method 
COSSAC makes use of the information contained in the base model run to choose which covariate to try first (instead of trying all covariates &quot;blindly&quot; as in SCM). 
Indeed, the correlation between the individual parameters (or random effects) and the covariates hints at possibly relevant parameter-covariate relationships. If the EBEs (empirical Bayes estimates) are used, shrinkage may bias the result. 
COSSAC instead uses samples from the a posteriori conditional distribution (available as &quot;conditional distribution&quot; task in MonolixSuite2018) to calculate the correlation between the random effects and covariates. 
A p-value can be derived using the Pearson's correlation test for continuous covariate and ANOVA for categorical covariate. The p-values are used to sort all the random effect-covariate relationships. Relationships with the lowest p-value are added first, run and confirmed using a likelihood ratio test, AIC or BIC criteria. 
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>covariateSearch(
  project,
  final.project = NULL,
  method = NULL,
  covToTest = NULL,
  covToTransform = NULL,
  paramToUse = NULL,
  testRelations = NULL,
  settings = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="covariateSearch_+3A_project">project</code></td>
<td>
<p>a Monolix project</p>
</td></tr>
<tr><td><code id="covariateSearch_+3A_final.project">final.project</code></td>
<td>
<p>[optional] string corresponding to the final Monolix project (default: 'runFinal.mlxtran' in covariate search output folder)</p>
</td></tr>
<tr><td><code id="covariateSearch_+3A_method">method</code></td>
<td>
<p>[optional] string correspondig to the method. It can be 'COSSAC' or 'SCM'. By default, COSSAC' is used.</p>
</td></tr>
<tr><td><code id="covariateSearch_+3A_covtotest">covToTest</code></td>
<td>
<p>[optional] vector of covariates to test. Cannot be used if testRelations is defined. By default, all covariates are tested.</p>
</td></tr>
<tr><td><code id="covariateSearch_+3A_covtotransform">covToTransform</code></td>
<td>
<p>[optional] vector of covariates to transform. The transformation consists in a log transform of the covariate with centering by the mean value (ex: WT is transformed into log(WT/mean) with mean the mean WT value over the individuals of the data set). Both the transformed and untransformed covariate are tested by the algorithm. By default, no covariate is transformed.
Note: 
adding a non-transformed covariate on a lognormally distributed parameter results in an exponential relationship: log(V) = log(Vpop) + beta*WT + eta &lt;=&gt; V = Vpop * exp(beta*WT) * exp(eta)
adding a log-transformed covariate on a lognormally distributed parameter results in a power law relationship: log(V) = log(Vpop) + beta*log(WT/70) + eta &lt;=&gt; V = Vpop * (WT/70)^beta * exp(eta)</p>
</td></tr>
<tr><td><code id="covariateSearch_+3A_paramtouse">paramToUse</code></td>
<td>
<p>[optional] vector of parameters which may be function of covariates. Cannot be used if testRelations is defined. By default, all parameters are tested.</p>
</td></tr>
<tr><td><code id="covariateSearch_+3A_testrelations">testRelations</code></td>
<td>
<p>[optional] list of parameter-covariate relationships to test, ex: list(V=c(&quot;WT&quot;,&quot;SEX&quot;),Cl=c(&quot;CRCL&quot;)). Cannot be used if covToTest or paramToUse is defined. By default, all parameter-covariate relationships are tested.</p>
</td></tr>
<tr><td><code id="covariateSearch_+3A_settings">settings</code></td>
<td>
<p>[optional] list of settings for the covariate search: 
</p>

<ul>
<li> <p><code>pInclusion</code>  [positive double] threshold on the LRT p-value to accept the model with the added parameter-covariate relationship during forward selection (default = .1). Only used if criteria=&quot;LRT&quot;.
</p>
</li>
<li> <p><code>pElimination</code> [positive double] threshold on the LRT p-value to accept the model without the removed parameter-covariate relationship during the backward elimination (default = .05). Only used if criteria=&quot;LRT&quot;.
</p>
</li>
<li> <p><code>criteriaThreshold</code> [positive double] the threshold on the AIC or BIC difference to accept the model with added/removed parameter-covariate relationship (default = 0). Only used if criteria=&quot;BIC&quot; or &quot;AIC.
</p>
</li>
<li> <p><code>linearization</code> [boolean] whether the computation of the likelihood is based on a linearization of the model (default = FALSE).
</p>
</li>
<li> <p><code>criteria</code> [string] criteria to optimize. It can be the &quot;BIC&quot;, &quot;AIC&quot;, or &quot;LRT&quot;  (default=&quot;LRT&quot;).
</p>
</li>
<li> <p><code>direction</code> [string] method for covariate search. It can be &quot;backward&quot;, &quot;forward&quot;, or &quot;both&quot; (default = &quot;both&quot;).
</p>
</li>
<li> <p><code>updateInit</code> [boolean] whether to update or not the initial parameters using the estimates of the parent model (default = FALSE)
</p>
</li>
<li> <p><code>saveRun</code> [boolean] whether to save or not each run (default = TRUE)
</p>
</li></ul>
</td></tr>
</table>


<h3>See Also</h3>

<p><code>getModelBuildingSettings</code> settings for model building with lixoftConnectors <br />
<code>runModelBuilding</code> run model building with lixoftConnectors <br />
<code>getModelBuildingResults</code> results for model building with lixoftConnectors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# RsmlxDemo1.mlxtran is a Monolix project for modelling the pharmacokinetics (PK) of warfarin 
# using a PK model with parameters ka, V, Cl.

# In this example, three covariates (wt, age, sex) are available with the data
# covariatesearch will compute the best covariate model, in term of BIC, 
# for the three PK parameters using the three covariates. 
r1 &lt;- covariateSearch(project="RsmlxDemo1.mlxtran")
  
# Instead of using the COSSAC method, we can use the SCM method:
r2 &lt;- covariateSearch(project="RsmlxDemo1.mlxtran", method = 'SCM')

# Here, the covariate model is built using age and wt only, for V and Cl only:
r3 &lt;- covariateSearch(project    = "RsmlxDemo1.mlxtran", 
                      paramToUse = c("V","Cl"), 
                      covToTest  = c("age","wt"))

## End(Not run)

# See http://monolix.lixoft.com/rsmlx/covariatesearch/ for detailed examples of covariatesearch
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

</code></pre>

<hr>
<h2 id='getEstimatedCovarianceMatrix'>Get estimated covariance and correlation matrices</h2><span id='topic+getEstimatedCovarianceMatrix'></span>

<h3>Description</h3>

<p>Get estimated covariance and correlation matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEstimatedCovarianceMatrix()
</code></pre>


<h3>Value</h3>

<p>a list of two matrices.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Assume that the Monolix project "warfarinPKPD.mlxtran" has been loaded
r = getEstimatedCovarianceMatrix()  # r is a list with elements "cor.matrix" and "cov.matrix"

# See http://monolix.lixoft.com/rsmlx/newconnectors/ for more detailed examples
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

## End(Not run)
</code></pre>

<hr>
<h2 id='getEstimatedIndividualParameters2'>Get estimated individual and population parameters</h2><span id='topic+getEstimatedIndividualParameters2'></span>

<h3>Description</h3>

<p>Get the individual individual parameters, the population parameters with the population covariates 
and the population parameters with the individual covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEstimatedIndividualParameters2()
</code></pre>


<h3>Value</h3>

<p>a list of data frames.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Assume that the Monolix project "warfarinPKPD.mlxtran" has been loaded
r = getEstimatedIndividualParameters2() 

# r is a list with elements "saem", "conditionalMean", "conditionalSD",   "conditionalMode",
# "popPopCov" and "popIndCov"

# See http://monolix.lixoft.com/rsmlx/newconnectors/ for more detailed examples
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

## End(Not run)
</code></pre>

<hr>
<h2 id='getEstimatedPredictions'>Get estimated predictions</h2><span id='topic+getEstimatedPredictions'></span>

<h3>Description</h3>

<p>Get the individual predictions obtained with the estimated individual parameters :
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEstimatedPredictions()
</code></pre>


<h3>Value</h3>

<p>a list of data frames (one data frame per output).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Assume that the Monolix project "warfarinPKPD.mlxtran" has been loaded
r = getEstimatedPredictions() # r is a list with elements "y1" and "y2"

# See http://monolix.lixoft.com/rsmlx/newconnectors/ for more detailed examples
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

## End(Not run)
</code></pre>

<hr>
<h2 id='getEstimatedResiduals'>Get estimated residuals</h2><span id='topic+getEstimatedResiduals'></span>

<h3>Description</h3>

<p>Get the residuals computed from the individual predictions obtained 
with the estimated individual parameters:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getEstimatedResiduals()
</code></pre>


<h3>Value</h3>

<p>a list of data frames (one data frame per output).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Assume that the Monolix project "warfarinPKPD.mlxtran" has been loaded
r = getEstimatedResiduals()  # r is a list with elements "y1" and "y2" 

# See http://monolix.lixoft.com/rsmlx/newconnectors/ for more detailed examples
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

## End(Not run)
</code></pre>

<hr>
<h2 id='getSimulatedPredictions'>Get simulated predictions</h2><span id='topic+getSimulatedPredictions'></span>

<h3>Description</h3>

<p>Get the individual predictions obtained with the simulated individual parameters :
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSimulatedPredictions()
</code></pre>


<h3>Value</h3>

<p>a list of data frames (one data frame per output).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Assume that the Monolix project "warfarinPKPD.mlxtran" has been loaded
r = getSimulatedPredictions()  # r is a list with elements "Cc" and "E" 

# See http://monolix.lixoft.com/rsmlx/newconnectors/ for more detailed examples
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

## End(Not run)
</code></pre>

<hr>
<h2 id='getSimulatedResiduals'>Get simulated residuals</h2><span id='topic+getSimulatedResiduals'></span>

<h3>Description</h3>

<p>Get the residuals computed from the individual predictions obtained 
with the simulated individual parameters:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSimulatedResiduals()
</code></pre>


<h3>Value</h3>

<p>a list of data frames (one data frame per output).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Assume that the Monolix project "warfarinPKPD.mlxtran" has been loaded
r = getSimulatedResiduals()  # r is a list with elements "y1" and "y2" 

# See http://monolix.lixoft.com/rsmlx/newconnectors/ for more detailed examples
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

## End(Not run)
</code></pre>

<hr>
<h2 id='initRsmlx'>Initialize Rsmlx library</h2><span id='topic+initRsmlx'></span>

<h3>Description</h3>

<p>Initialize Rsmlx library and lixoftConnectors. Prints information about the versions of Monolix and lixoftConnectors used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initRsmlx(path = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initRsmlx_+3A_path">path</code></td>
<td>
<p>Monolix path</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list:
</p>

<ul>
<li> <p><code>software</code>: the software that is used (should be monolix with Rsmlx)
</p>
</li>
<li> <p><code>path</code>: the path to MonolixSuite
</p>
</li>
<li> <p><code>version</code>: the version of MonolixSuite that is used
</p>
</li>
<li> <p><code>status</code>: boolean equaling TRUE if the initialization has been successful.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
initRsmlx() 
initRsmlx(path="C:/ProgramData/Lixoft/MonolixSuite2024R1")  # specifiy a specific path

## End(Not run)
</code></pre>

<hr>
<h2 id='pkbuild'>Automatic PK model building</h2><span id='topic+pkbuild'></span>

<h3>Description</h3>

<p>Fit several structural PK models and select the best one based on a Bayesian Information Criterion.
Models to compare can be defined by rate constants and/or clearances and can include or not nonlinear elimination
models.
See https://monolix.lixoft.com/rsmlx/pkbuild/ for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkbuild(
  data = NULL,
  project = NULL,
  stat = FALSE,
  param = "clearance",
  new.dir = ".",
  MM = FALSE,
  linearization = F,
  criterion = "BICc",
  level = NULL,
  settings.stat = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pkbuild_+3A_data">data</code></td>
<td>
<p>a list with fields
</p>

<ul>
<li> <p><code>dataFile</code>: path of a formatted data file
</p>
</li>
<li> <p><code>headerTypes</code>: a vector of strings
</p>
</li>
<li> <p><code>administration</code> (&quot;iv&quot;, &quot;bolus&quot;, &quot;infusion&quot;, &quot;oral&quot;, &quot;ev&quot;): route of administration 
</p>
</li></ul>
</td></tr>
<tr><td><code id="pkbuild_+3A_project">project</code></td>
<td>
<p>a Monolix project</p>
</td></tr>
<tr><td><code id="pkbuild_+3A_stat">stat</code></td>
<td>
<p>(FALSE, TRUE): the statistical model is also built (using buildmlx) (default=FALSE)</p>
</td></tr>
<tr><td><code id="pkbuild_+3A_param">param</code></td>
<td>
<p>(&quot;clearance&quot;, &quot;rate&quot;, &quot;both): parametrization  (default=&quot;clearance&quot;)</p>
</td></tr>
<tr><td><code id="pkbuild_+3A_new.dir">new.dir</code></td>
<td>
<p>name of the directory where the created files are stored 
(default is the current working directory) )</p>
</td></tr>
<tr><td><code id="pkbuild_+3A_mm">MM</code></td>
<td>
<p>(FALSE, TRUE): tested models include or not Michaelis Menten elimination models (default=FALSE)</p>
</td></tr>
<tr><td><code id="pkbuild_+3A_linearization">linearization</code></td>
<td>
<p>TRUE/FALSE whether the computation of the likelihood is based on a linearization of the model (default=FALSE)</p>
</td></tr>
<tr><td><code id="pkbuild_+3A_criterion">criterion</code></td>
<td>
<p>penalization criterion to optimize c(&quot;AIC&quot;, &quot;BIC&quot;, &quot;BICc&quot;, gamma) (default=&quot;BICc&quot;)</p>
</td></tr>
<tr><td><code id="pkbuild_+3A_level">level</code></td>
<td>
<p>an integer between 1 and 9 (used by setSettings)</p>
</td></tr>
<tr><td><code id="pkbuild_+3A_settings.stat">settings.stat</code></td>
<td>
<p>list of settings used by buildmlx (only if stat=TRUE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of results
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Build a PK model for the warfarin PK data. 
# By default, only models using clearance (and inter compartmental clearances) are used
warf.pk1 &lt;- pkbuild(data=warfarin)

# Models using elimination and transfer rate constants are used, 
# as well as nonlinear elimination models
warf.pk2 &lt;- pkbuild(data=warfarin,  new.dir="warfarin", param="rate", MM=TRUE)

# Both models using clearances and rates are used. 
# Level is set to 7 in order to get accurate results.
warf.pk3 &lt;- pkbuild(data=warfarin,  new.dir="warfarin", param="both", level=7)

## End(Not run)
</code></pre>

<hr>
<h2 id='pkpopini'>Compute initial population PK parameters</h2><span id='topic+pkpopini'></span>

<h3>Description</h3>

<p>Use the pooled PK data to derive population PK parameters for a &quot;standard&quot; PK model
(i.e. a model of the Monolix PK library). 
The structural model is automatically defined using the names of the PK parameters.
Allowed names are: 'Tlag', 'Mtt', 'Ktr', 'ka', 'Tk0', 'V', 'V1', 'V2', 'V3', 'Q', 'Q2', 'Q3', 
'Cl', 'k', 'k12', 'k21', 'k13', 'k31', 'Vm', 'Km'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkpopini(
  data = NULL,
  project = NULL,
  parameter = NULL,
  new.project = NULL,
  new.dir = NULL,
  par.ini = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pkpopini_+3A_data">data</code></td>
<td>
<p>a list with fields
</p>

<ul>
<li> <p><code>dataFile</code>: path to a formatted data file
</p>
</li>
<li> <p><code>headerTypes</code>: a vector of strings
</p>
</li></ul>
</td></tr>
<tr><td><code id="pkpopini_+3A_project">project</code></td>
<td>
<p>a Monolix project</p>
</td></tr>
<tr><td><code id="pkpopini_+3A_parameter">parameter</code></td>
<td>
<p>a vector of strings (names of the PK parameters)</p>
</td></tr>
<tr><td><code id="pkpopini_+3A_new.project">new.project</code></td>
<td>
<p>name of the new Monolix project  (a default name is created if not provided)</p>
</td></tr>
<tr><td><code id="pkpopini_+3A_new.dir">new.dir</code></td>
<td>
<p>name of the directory where the created files are stored 
(default is the current working directory) )</p>
</td></tr>
<tr><td><code id="pkpopini_+3A_par.ini">par.ini</code></td>
<td>
<p>a vector of PK parameter values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A Monolix project is then automatically created using these values as initial population parameters.
</p>
<p>See https://monolix.lixoft.com/rsmlx/pkpopini/ for more details.
</p>


<h3>Value</h3>

<p>A list of results
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Create in the working directory a Monolix project for a 1 cpt model with 
# lag time, 0 order absorption and linear elimination
warf.ini1 &lt;- pkpopini(data=warfarin, param=c("Tlag", "Tk0", "V", "Cl")) 

# Create in directory 'warfarin' a Monolix project called 'warfPK2.mlxtran' 
# for a 2 cpt model with 1st order absorption and nonlinear elimination
warf.ini3 &lt;- pkpopini(data=warfarin, param=c("ka", "V", "k12", "k21", "Vm", "Km"), 
                      new.dir="warfarin", new.project="warfPK2.mlxtran") 

## End(Not run)
</code></pre>

<hr>
<h2 id='readDatamlx'>Read formatted data file</h2><span id='topic+readDatamlx'></span>

<h3>Description</h3>

<p>Read data in a Monolix/NONMEM format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readDatamlx(
  data = NULL,
  out.data = FALSE,
  nbSSDoses = 10,
  obs.rows = FALSE,
  datafile = NULL,
  header = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readDatamlx_+3A_data">data</code></td>
<td>
<p>a list with fields
</p>

<ul>
<li> <p><code>dataFile</code>: path of a formatted data file
</p>
</li>
<li> <p><code>headerTypes</code>: a vector of strings
</p>
</li></ul>
</td></tr>
<tr><td><code id="readDatamlx_+3A_out.data">out.data</code></td>
<td>
<p>TRUE/FALSE (default=FALSE) returns the original data as a table and some information about the Monolix project</p>
</td></tr>
<tr><td><code id="readDatamlx_+3A_nbssdoses">nbSSDoses</code></td>
<td>
<p>number of additional doses to use for steady-state (default=10)</p>
</td></tr>
<tr><td><code id="readDatamlx_+3A_obs.rows">obs.rows</code></td>
<td>
<p>a list of observation indexes</p>
</td></tr>
<tr><td><code id="readDatamlx_+3A_datafile">datafile</code></td>
<td>
<p>(deprecated) a formatted data file</p>
</td></tr>
<tr><td><code id="readDatamlx_+3A_header">header</code></td>
<td>
<p>(deprecated) a vector of strings</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data frames
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# using a data file:
warfarinPK &lt;- list(dataFile = "data/warfarinPK.csv",
                   headerTypes = c("id", "time", "observation", "amount", 
                                   "contcov", "contcov", "catcov"),
                   administration = "oral")
d &lt;- readDatamlx(data=warfarinPK)


## End(Not run)
</code></pre>

<hr>
<h2 id='resMonolix'>Monolix results</h2><span id='topic+resMonolix'></span>

<h3>Description</h3>

<p>Monolix results used by the Rsmlx examples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resMonolix</code></pre>


<h3>Format</h3>

<p>A R list</p>


<h3>Source</h3>

<p>Monolix demos</p>


<h3>References</h3>

<p>Rsmlx website: http://rsmlx.webpopix.org</p>

<hr>
<h2 id='RsmlxDemo1.project'>Monolix project for warfarin PK - 1</h2><span id='topic+RsmlxDemo1.project'></span>

<h3>Description</h3>

<p>RsmlxDemo2.mlxtran is a Monolix project for modelling the pharmacokinetics (PK) of warfarin 
using a PK model with parameters ka, V, Cl. There is no covariate in the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RsmlxDemo1.project</code></pre>


<h3>Format</h3>

<p>A text file</p>


<h3>Source</h3>

<p>Monolix project</p>


<h3>References</h3>

<p>Rsmlx doumentation</p>

<hr>
<h2 id='RsmlxDemo2.project'>Monolix project for warfarin PK - 2</h2><span id='topic+RsmlxDemo2.project'></span>

<h3>Description</h3>

<p>RsmlxDemo2.mlxtran is a Monolix project for modelling the pharmacokinetics (PK) of warfarin 
using a PK model with parameters ka, V, Cl. Here, V and Cl are function of weight.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RsmlxDemo2.project</code></pre>


<h3>Format</h3>

<p>A text file</p>


<h3>Source</h3>

<p>Monolix project</p>


<h3>References</h3>

<p>Rsmlx doumentation</p>

<hr>
<h2 id='setSettings'>Easy tuning of the settings of a Monolix project</h2><span id='topic+setSettings'></span>

<h3>Description</h3>

<p>Use a single accuracy level, between 1 and 9, to automatically tune all the settings  
of a Monolix project.
When the accuray level is equal to 1, the algorithms are very fast but the results may be
not precise.  When the accuray level is equal to 9, the algorithms are slow but the results 
are accurate. Default Monolix settings are obtained with level=5.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setSettings(project = NULL, new.project = NULL, level = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setSettings_+3A_project">project</code></td>
<td>
<p>a string: a Monolix project (the loaded project if NULL)</p>
</td></tr>
<tr><td><code id="setSettings_+3A_new.project">new.project</code></td>
<td>
<p>a string: the new created Monolix project (default is the original project)</p>
</td></tr>
<tr><td><code id="setSettings_+3A_level">level</code></td>
<td>
<p>an integer between 1 and 9 (default=5)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# RsmlxDemo1.mlxtran is a Monolix project for modelling the PK of warfarin.
# All settings of the project are set so that algorithms used by Monolix converge as 
# quickly as possible possible:
setSettings(project="RsmlxDemo1.mlxtran", level=1)

# A new project will be created with settings set in order to obtain the most 
# precise results possible:
new.project= file.path(tempdir(),"RsmlxDemoNew.mlxtran")
setSettings(project="RsmlxDemo1.mlxtran", new.project=new.project, level=9)

# See http://monolix.lixoft.com/rsmlx/setSettings/ for detailed examples of use of setSettings
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

## End(Not run)
</code></pre>

<hr>
<h2 id='testmlx'>Statistical tests for model assessment</h2><span id='topic+testmlx'></span>

<h3>Description</h3>

<p>Perform several statistical tests using the results of a Monolix run to assess the statistical
components of the model in use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testmlx(
  project = NULL,
  tests = c("covariate", "randomEffect", "correlation", "residual"),
  plot = FALSE,
  adjust = "edf",
  n.sample = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="testmlx_+3A_project">project</code></td>
<td>
<p>a Monolix project</p>
</td></tr>
<tr><td><code id="testmlx_+3A_tests">tests</code></td>
<td>
<p>a vector of strings: the list of tests to perform 
among c(&quot;covariate&quot;,&quot;randomEffect&quot;,&quot;correlation&quot;,&quot;residual&quot;)</p>
</td></tr>
<tr><td><code id="testmlx_+3A_plot">plot</code></td>
<td>
<p>FALSE/TRUE  display some diagnostic plots associated to the tests (default=FALSE)</p>
</td></tr>
<tr><td><code id="testmlx_+3A_adjust">adjust</code></td>
<td>
<p>method to take into account the dependency of MCMC sample  c(&quot;edf&quot;,&quot;BH&quot;) (default=&quot;edf&quot;)</p>
</td></tr>
<tr><td><code id="testmlx_+3A_n.sample">n.sample</code></td>
<td>
<p>number of samples from the conditional distribution to be used (default = number of available samples in the project)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tests used are:  
1) F-tests (or, equivalently, correlation tests) to evaluate the effect of each covariate 
on each parameter (&quot;covariate&quot;), 
2) correlation tests to assess the correlation structure of the random effects (&quot;correlation&quot;), 
3) Shapiro-Wilk and Miao-Gel-Gastwirth tests to assess, respectively the normality and the
symmetry of the distribution of the random effects (&quot;&quot;randomEffect&quot;), 
4) Shapiro-Wilk and Miao-Gel-Gastwirth tests to assess, respectively the normality and the
symmetry of the distribution of residual errors (&quot;residual&quot;).
</p>
<p>By default, the four tests are performed.
</p>
<p>When several samples of the conditional distributions are used, two methods are proposed in order 
to take into the dependance of the samples for the Shapiro-Wilk and Miao-Gel-Gastwirth tests: 
&quot;edf&quot; computes an effective degrees of freedom, &quot;BH&quot; performs one test per replicates and adjust 
the smallest p-value using the Benjamini-Hochberg correction.
</p>


<h3>Value</h3>

<p>a list of data frames and ggplot objects if plot=TRUE
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# RsmlxDemo2.mlxtran is a Monolix project for modelling the PK of warfarin using a PK model 
# with parameters ka, V, Cl.

#testmlx will perform statistical tests for the different component of the statistical model:
r1 &lt;- testmlx(project="RsmlxDemo2.mlxtran")

#testmlx will perform statistical tests for the covariate model and the correlation model only.
r2 &lt;- testmlx(project="RsmlxDemo2.mlxtran", tests=c("covariate","correlation"))

## End(Not run)

# See http://monolix.lixoft.com/rsmlx/testmlx/ for detailed examples of use of testmlx
# Download the demo examples here: http://monolix.lixoft.com/rsmlx/installation

</code></pre>

<hr>
<h2 id='warfarin.data'>warfarin PKPD data</h2><span id='topic+warfarin.data'></span>

<h3>Description</h3>

<p>The warfarin PK and PD data for 32 patients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>warfarin.data</code></pre>


<h3>Format</h3>

<p>A csv file</p>


<h3>Source</h3>

<p>Monolix demos</p>


<h3>References</h3>

<p>O‚ÄôReilly (1968). Studies on coumarin anticoagulant drugs. Initiation of warfarin therapy without a loading dose. Circulation 1968, 38:169-177.</p>

<hr>
<h2 id='whichPKmodel'>Find a Monolix PK model</h2><span id='topic+whichPKmodel'></span>

<h3>Description</h3>

<p>Return the path of the Monolix PK model defined by a list of parameter names
See https://monolix.lixoft.com/rsmlx/whichPKmodel/ for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>whichPKmodel(parameter, mlxPath = NULL, pkPath = NULL, lib = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="whichPKmodel_+3A_parameter">parameter</code></td>
<td>
<p>a vector of PK parameter names</p>
</td></tr>
<tr><td><code id="whichPKmodel_+3A_mlxpath">mlxPath</code></td>
<td>
<p>path to Monolix install</p>
</td></tr>
<tr><td><code id="whichPKmodel_+3A_pkpath">pkPath</code></td>
<td>
<p>path to the Monolix PK library</p>
</td></tr>
<tr><td><code id="whichPKmodel_+3A_lib">lib</code></td>
<td>
<p>boolean to define if the absolute path is returned</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
whichPKmodel(parameter=c("Tlag", "Tk0", "V", "Cl"))

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
