<!DOCTYPE html><html><head><title>Help for package mlelod</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mlelod}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mlelod-package'>
<p>MLE for Normally Distributed Data Censored by Limit of Detection</p></a></li>
<li><a href='#mlelod'>
<p>Estimates the parameters of the normal distribution.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>MLE for Normally Distributed Data Censored by Limit of Detection</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-05-14</td>
</tr>
<tr>
<td>Description:</td>
<td>Values below the limit of detection (LOD) are a problem in several fields of science, and there are numerous approaches for replacing the missing data. We present a new mathematical solution for maximum likelihood estimation that allows us to estimate the true values of the mean and standard deviation for normal distributions and is significantly faster than previous implementations. The article with the details was submitted to JSS and can be currently seen on <a href="https://www2.arnes.si/~tverbo/LOD/Verbovsek_Sega_2_Manuscript.pdf">https://www2.arnes.si/~tverbo/LOD/Verbovsek_Sega_2_Manuscript.pdf</a>.</td>
</tr>
<tr>
<td>Author:</td>
<td>Gregor Sega [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gregor Sega &lt;gregor.sega@fmf.uni-lj.si&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-14 16:12:17 UTC; grego</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-15 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mlelod-package'>
MLE for Normally Distributed Data Censored by Limit of Detection
</h2><span id='topic+mlelod-package'></span>

<h3>Description</h3>

<p>Values below the limit of detection (LOD) are a problem in several fields of science, and there are numerous approaches for replacing the missing data. We present a new mathematical solution for maximum likelihood estimation that allows us to estimate the true values of the mean and standard deviation for normal distributions and is significantly faster than previous implementations. The article with the details was submitted to JSS and can be currently seen on &lt;https://www2.arnes.si/~tverbo/LOD/Verbovsek_Sega_2_Manuscript.pdf&gt;.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> mlelod</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> MLE for Normally Distributed Data Censored by Limit of Detection</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-05-14</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Values below the limit of detection (LOD) are a problem in several fields of science, and there are numerous approaches for replacing the missing data. We present a new mathematical solution for maximum likelihood estimation that allows us to estimate the true values of the mean and standard deviation for normal distributions and is significantly faster than previous implementations. The article with the details was submitted to JSS and can be currently seen on &lt;https://www2.arnes.si/~tverbo/LOD/Verbovsek_Sega_2_Manuscript.pdf&gt;.</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> 
    person("Gregor", "Sega", , "gregor.sega@fmf.uni-lj.si", role = c("aut", "cre"))</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Gregor Sega [aut, cre]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Gregor Sega &lt;gregor.sega@fmf.uni-lj.si&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
mlelod                  Estimates the parameters of the normal
                        distribution.
mlelod-package          MLE for Normally Distributed Data Censored by
                        Limit of Detection
</pre>
<p>Values below the limit of detection (LOD) are a problem in several fields of science, and there are
numerous approaches for replacing the missing data. Thic package uses a new mathematical solution for
maximum likelihood estimation that allows us to estimate the true values of the mean and standard deviation
for normal distributions and is significantly faster than previous implementations. The core function
is the function mlelod with three parameters: the size of the sample, the values of the sample and the
value of limit of detection. The function returns two estimates: for mu (expected value) and sigma
(standard deviation).
</p>


<h3>Author(s)</h3>

<p>Gregor Sega [aut, cre]
</p>
<p>Maintainer: Gregor Sega &lt;gregor.sega@fmf.uni-lj.si&gt;
</p>


<h3>References</h3>

<p>The article with the derived method is submited to Journal of Statistical Software
</p>

<hr>
<h2 id='mlelod'>
Estimates the parameters of the normal distribution.
</h2><span id='topic+mlelod'></span>

<h3>Description</h3>

<p>The function returns the two estimates for the parameters of the normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlelod(n, censoreddata, lod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlelod_+3A_n">n</code></td>
<td>

<p>n is the size of the sample
</p>
</td></tr>
<tr><td><code id="mlelod_+3A_censoreddata">censoreddata</code></td>
<td>

<p>censoreddata is the vector containing the values of the sample which are greater than lod</p>
</td></tr>
<tr><td><code id="mlelod_+3A_lod">lod</code></td>
<td>

<p>lod is the value of level of detection.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>muEst</code></td>
<td>
<p>Description of 'comp1'</p>
</td></tr>
<tr><td><code>sigmaEst</code></td>
<td>
<p>Description of 'comp2'</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gregor Sega
</p>


<h3>References</h3>

<p>The article with the derived method is submited to Journal of Statistical Software
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## The function is currently defined as
mlelod &lt;- function (n, censoreddata, lod) 
{
    k &lt;- length(censoreddata)
    s &lt;- sum(censoreddata)
    s2 &lt;- sum(censoreddata^2)
    g &lt;- function(x, n, k, s, s2, lod) {
        a &lt;- (k * (lod^2 - x^2) + s2 - 2 * lod * s)/(x * (k * 
            lod - s))
        b &lt;- s - k * (k * x^2 + lod * s - s2)/(k * lod - s) - 
            x * (n - k) * dnorm(a, 0, 1)/pnorm(a, 0, 1)
        return(b)
    }
    h &lt;- function(x) {
        return(g(x, n, k, s, s2, lod))
    }
    lsi &lt;- sqrt(s2/k - (s/k)^2)
    sigmaEst &lt;- uniroot(h, lower = lsi/4, upper = 4 * lsi, tol = 1e-06)$root
    muEst &lt;- (k * sigmaEst^2 + lod * s - s2)/(k * lod - s)
    return(list(muEst = muEst, sigmaEst = sigmaEst))
  }
##define the parameters of the normal distribution
mu &lt;- 5
sigma &lt;- 4
##define the size of the sample and the value of lod
n &lt;- 100
lod &lt;- 2
##generate normally distributed data and extract the observable values (the ones exceeding lod)
data &lt;- rnorm(n, mu, sigma)
data2 &lt;-  Filter(function(x) x&gt;lod,data)
##run the function to obtain the estimates
mlelod(n, data2, lod)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
