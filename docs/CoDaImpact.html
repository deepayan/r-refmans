<!DOCTYPE html><html lang="en"><head><title>Help for package CoDaImpact</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CoDaImpact}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CoDaImpact-package'><p>CoDaImpact: Interpreting CoDa Regression Models</p></a></li>
<li><a href='#car_market'><p>French car market data</p></a></li>
<li><a href='#check_Xdir'><p>Internal: check for valid computational direction arguments</p></a></li>
<li><a href='#check_Xvar'><p>Internal: check for valid name of Xvar</p></a></li>
<li><a href='#CoDa_path'><p>Create a linear path in the simplex by defining a direction and a step size</p></a></li>
<li><a href='#CoDa_seq'><p>A sequence connecting two points in a simplex</p></a></li>
<li><a href='#coef.lmCoDa'><p>Predictions, fitted values, residuals, and coefficients in CoDa models</p></a></li>
<li><a href='#confint.lmCoDa'><p>Confidence Intervals for CoDa Models</p></a></li>
<li><a href='#election'><p>Results of french departmental elections in 2015</p></a></li>
<li><a href='#fitted.lmCoDa'><p>Predictions, fitted values, residuals, and coefficients in CoDa models</p></a></li>
<li><a href='#Impacts'><p>Computation of elasticities in CoDa regression models</p></a></li>
<li><a href='#lmCoDa'><p>Estimating CoDa regression models</p></a></li>
<li><a href='#pct'><p>Format numbers to percentages</p>
This code copied from stats:::format.perc(), to avoid notes about the ::: operator.</a></li>
<li><a href='#predict.lmCoDa'><p>Predictions, fitted values, residuals, and coefficients in CoDa models</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#residuals.lmCoDa'><p>Predictions, fitted values, residuals, and coefficients in CoDa models</p></a></li>
<li><a href='#rice_yields'><p>Data on the rice yields in the Vietnamese provinces</p></a></li>
<li><a href='#ShareRatioElasticities'><p>Compute share ratio elasticities for CoDa models</p></a></li>
<li><a href='#ToSimplex'><p>Converting Linear Models to CoDa models</p></a></li>
<li><a href='#toulouse_retail'><p>Simulated retail data for nine shopping malls in the city of Toulouse</p></a></li>
<li><a href='#transformationSummary'><p>Summarize the transformations in a CoDa model (internal)</p></a></li>
<li><a href='#VariationScenario'><p>Scenarios for variation in CoDa regressions models</p></a></li>
<li><a href='#VariationTable'><p>Effects of infinitesimal changes in CoDa models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Interpreting CoDa Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Provides methods for interpreting CoDa (Compositional Data) regression models along the lines of "Pairwise share ratio interpretations of compositional regression models" (Dargel and Thomas-Agnan 2024) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2024.107945">doi:10.1016/j.csda.2024.107945</a>&gt;.
    The new methods include variation scenarios, elasticities, elasticity differences and share ratio elasticities.
    These tools are independent of log-ratio transformations and allow an interpretation in the original space of shares.
    'CoDaImpact' is designed to be used with the 'compositions' package and its ecosystem.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/LukeCe/CoDaImpact">https://github.com/LukeCe/CoDaImpact</a>,
<a href="https://lukece.github.io/CoDaImpact/">https://lukece.github.io/CoDaImpact/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/LukeCe/CoDaImpact/issues">https://github.com/LukeCe/CoDaImpact/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, compositions</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, sf, tinytest</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-22 11:22:01 UTC; lukece</td>
</tr>
<tr>
<td>Author:</td>
<td>Lukas Dargel <a href="https://orcid.org/0000-0002-4839-506X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Christine Thomas-Agnan
    <a href="https://orcid.org/0000-0002-6430-3110"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Rodrigue Nasr [ctb],
  Sijia Pan [ctb],
  Iban Rendo Barreiro [ctb],
  Shuyao Li [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lukas Dargel &lt;lukas.dargel@mailbox.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-23 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CoDaImpact-package'>CoDaImpact: Interpreting CoDa Regression Models</h2><span id='topic+CoDaImpact'></span><span id='topic+CoDaImpact-package'></span>

<h3>Description</h3>

<p>Provides methods for interpreting CoDa (Compositional Data) regression models along the lines of &quot;Pairwise share ratio interpretations of compositional regression models&quot; (Dargel and Thomas-Agnan 2024) <a href="https://doi.org/10.1016/j.csda.2024.107945">doi:10.1016/j.csda.2024.107945</a>. The new methods include variation scenarios, elasticities, elasticity differences and share ratio elasticities. These tools are independent of log-ratio transformations and allow an interpretation in the original space of shares. 'CoDaImpact' is designed to be used with the 'compositions' package and its ecosystem.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Lukas Dargel <a href="mailto:lukas.dargel@mailbox.org">lukas.dargel@mailbox.org</a> (<a href="https://orcid.org/0000-0002-4839-506X">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Christine Thomas-Agnan <a href="mailto:christine.thomas@tse-fr.eu">christine.thomas@tse-fr.eu</a> (<a href="https://orcid.org/0000-0002-6430-3110">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Rodrigue Nasr [contributor]
</p>
</li>
<li><p> Sijia Pan [contributor]
</p>
</li>
<li><p> Iban Rendo Barreiro [contributor]
</p>
</li>
<li><p> Shuyao Li [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/LukeCe/CoDaImpact">https://github.com/LukeCe/CoDaImpact</a>
</p>
</li>
<li> <p><a href="https://lukece.github.io/CoDaImpact/">https://lukece.github.io/CoDaImpact/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/LukeCe/CoDaImpact/issues">https://github.com/LukeCe/CoDaImpact/issues</a>
</p>
</li></ul>


<hr>
<h2 id='car_market'>French car market data</h2><span id='topic+car_market'></span>

<h3>Description</h3>

<p>This data set shows monthly data of the French car market between 2003 and 2015.
The market is divided into 5 main segments (A to E), according to the size of the vehicle chassis.
Morais et. al (2018) first used this data to compare compositional and Dirichlet models for market shares.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>car_market
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 152 rows and 10 columns.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>SEG_</code>: Corresponds to the shares of sales in each of the five market
segments A,B,C,D and E. Where A are the smallest cars and E the largest.
The segmentation is explained in <a href="https://en.wikipedia.org/wiki/Car_classification">Wikipedia</a>.
</p>
</li>
<li> <p><code>GDP</code>: GDP figures in millions at current prices
</p>
</li>
<li> <p><code>HOUSEHOLD_EXPENDITURE</code>: total household expenditure in millions at previous years prices
</p>
</li>
<li> <p><code>GAS_PRICE</code>: Corresponds to the gas price including VAT.
</p>
</li>
<li> <p><code>SCRAPPING_SUBSIDY</code>: A dummy indicating periods where the French government provided subsidies for scrapping a car.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Lukas Dargel, Christine Thomas-Agnan
</p>


<h3>Source</h3>


<ul>
<li><p> The figures for GDP and household expenditure are originally provided by the The National Institute of Statistics and Economic Studies (INSEE).
</p>
</li>
<li><p> The gas prices are from the OECD.
</p>
</li>
<li><p> The market share of each segment of come from a simulation by Renault.
</p>
</li></ul>



<h3>References</h3>

<p>Joanna Morais, Christine Thomas-Agnan &amp; Michel Simioni (2018) Using compositional and Dirichlet models for market share regression, Journal of Applied Statistics, 45:9, 1670-1689, DOI: 10.1080/02664763.2017.1389864
</p>

<hr>
<h2 id='check_Xdir'>Internal: check for valid computational direction arguments</h2><span id='topic+check_Xdir'></span>

<h3>Description</h3>

<p>Internal: check for valid computational direction arguments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_Xdir(Xdir, Xopts, normalize = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_Xdir_+3A_xdir">Xdir</code></td>
<td>
<p>a character or numeric indicating the direction</p>
</td></tr>
<tr><td><code id="check_Xdir_+3A_xopts">Xopts</code></td>
<td>
<p>a character indicating the names of the vertices</p>
</td></tr>
<tr><td><code id="check_Xdir_+3A_normalize">normalize</code></td>
<td>
<p>a logical if true Xdir is normalized to have an Aitchison norm of 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>

<hr>
<h2 id='check_Xvar'>Internal: check for valid name of Xvar</h2><span id='topic+check_Xvar'></span>

<h3>Description</h3>

<p>Users should always specify Xvar as &quot;NAME_SIMPLEX&quot;,
which means before log-ratio transformations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_Xvar(
  Xvar,
  trSry,
  return_type = c("NAME_SIMPLEX", "NAME_COORD", "pos")[1]
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_Xvar_+3A_xvar">Xvar</code></td>
<td>
<p>a character or numeric indicating the direction</p>
</td></tr>
<tr><td><code id="check_Xvar_+3A_trsry">trSry</code></td>
<td>
<p>a character indicating the names of the vertices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a single integer or character
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>

<hr>
<h2 id='CoDa_path'>Create a linear path in the simplex by defining a direction and a step size</h2><span id='topic+CoDa_path'></span>

<h3>Description</h3>

<p>Create a linear path in the simplex by defining a direction and a step size
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CoDa_path(
  comp_direc,
  comp_from,
  step_size = 0.01,
  n_steps = 100,
  add_opposite = FALSE,
  dir_from_start = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CoDa_path_+3A_comp_direc">comp_direc</code></td>
<td>
<p>A numeric vector, defining a direction in the simplex</p>
</td></tr>
<tr><td><code id="CoDa_path_+3A_comp_from">comp_from</code></td>
<td>
<p>A numeric vector, an initial point in the simplex - defaults to a balanced composition, which represents the origin in the simplex</p>
</td></tr>
<tr><td><code id="CoDa_path_+3A_step_size">step_size</code></td>
<td>
<p>A numeric, indicting the step size</p>
</td></tr>
<tr><td><code id="CoDa_path_+3A_n_steps">n_steps</code></td>
<td>
<p>A numeric, indicating the number of steps to be taking from <code>comp_from</code></p>
</td></tr>
<tr><td><code id="CoDa_path_+3A_add_opposite">add_opposite</code></td>
<td>
<p>A logical, if <code>TRUE</code> steps in the opposite direction are also computed</p>
</td></tr>
<tr><td><code id="CoDa_path_+3A_dir_from_start">dir_from_start</code></td>
<td>
<p>A logical, if <code>TRUE</code> the direction is calculated from the difference between <code>comp_from</code> and <code>comp_direc</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is very similar to <code><a href="#topic+CoDa_seq">CoDa_seq()</a></code>.
However, of drawing a line between a starting and end point it uses only a starting point and a direction.
</p>


<h3>Value</h3>

<p>A data.frame frame where each row corresponds to one compositional vector
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>


<h3>See Also</h3>

<p>CoDa_seq
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# three steps that go from the origin towards the defined direction
comp_direc &lt;- c(A =.4,B = .35, C= .25)
CoDa_path(comp_direc, n_steps = 3)


# we can draw the path that is defined by this direction
comp_direc &lt;- c(A =.4,B = .35, C= .25)
compositions::plot.acomp(CoDa_path(comp_direc,n_steps = 10))
compositions::plot.acomp(CoDa_path(comp_direc,n_steps = 100))
compositions::plot.acomp(CoDa_path(comp_direc,add_opposite = TRUE))


# using the same direction we can draw a new path that does not go through the origin
comp_direc &lt;- c(A =.4,B = .35, C= .25)
comp_from &lt;- c(.7,.2,.1)
compositions::plot.acomp(CoDa_path(comp_direc, comp_from,n_steps = 10))
compositions::plot.acomp(CoDa_path(comp_direc, comp_from,n_steps = 100))
compositions::plot.acomp(CoDa_path(comp_direc, comp_from,add_opposite = TRUE))


# the balanced composition does not define a direction by itself
comp_origin &lt;- c(A = 1/3, B = 1/3, C= 1/3) # corresponds to a zero vector in real space
try(CoDa_path(comp_origin, comp_from,add_opposite = TRUE))

# with the dir_from_start option the direction is derived
# from the simplex line connecting two compositions
path_origin &lt;- CoDa_path(
  comp_direc = comp_origin,
  comp_from = comp_from,
  add_opposite = TRUE,
  dir_from_start = TRUE,
  step_size = .1)
compositions::plot.acomp(path_origin)
compositions::plot.acomp(comp_origin, add = TRUE, col = "blue", pch = 19)
compositions::plot.acomp(comp_from, add = TRUE, col = "red", pch = 19)

</code></pre>

<hr>
<h2 id='CoDa_seq'>A sequence connecting two points in a simplex</h2><span id='topic+CoDa_seq'></span>

<h3>Description</h3>

<p>A sequence connecting two points in a simplex
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CoDa_seq(comp_from, comp_to, n_steps = 100, add_opposite = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CoDa_seq_+3A_comp_from">comp_from</code></td>
<td>
<p>A numeric vector, representing the initial compositions</p>
</td></tr>
<tr><td><code id="CoDa_seq_+3A_comp_to">comp_to</code></td>
<td>
<p>A numeric vector, representing the final compositions.</p>
</td></tr>
<tr><td><code id="CoDa_seq_+3A_n_steps">n_steps</code></td>
<td>
<p>An integer, indicating the number of steps used to go from comp_from to comp_to</p>
</td></tr>
<tr><td><code id="CoDa_seq_+3A_add_opposite">add_opposite</code></td>
<td>
<p>A logical, if <code>TRUE</code> the path in the opposite direction is added</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sequence is evenly spaced and corresponds to a straight line in the simplex geometry.
If no end point is provided the line will connect the initial point with the first summit of the simplex.
Since exact zeros are not handled by the ilr they are replaced by a small constant.
</p>


<h3>Value</h3>

<p>A data.frame frame where each row corresponds to one compositional vector
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>


<h3>See Also</h3>

<p>simplex_increment
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# path to the first summit of the simplex
start_comp &lt;- c(A =.4,B = .35, C= .25)
compositions::plot.acomp(CoDa_seq(start_comp))
compositions::plot.acomp(CoDa_seq(start_comp, add_opposite = TRUE))

# path to an edge of the simplex
end_comp &lt;- c(0,.8,.2)
compositions::plot.acomp(CoDa_seq(start_comp, end_comp))
compositions::plot.acomp(CoDa_seq(start_comp, end_comp,add_opposite = TRUE))
</code></pre>

<hr>
<h2 id='coef.lmCoDa'>Predictions, fitted values, residuals, and coefficients in CoDa models</h2><span id='topic+coef.lmCoDa'></span>

<h3>Description</h3>

<p>These functions work as in the usual lm object.
They additionally offer the possibility use the <code>space</code> argument
which transforms them into directly into clr space or in the simplex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmCoDa'
coef(object, space = NULL, split = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.lmCoDa_+3A_object">object</code></td>
<td>
<p>class &quot;lmCoDa&quot;</p>
</td></tr>
<tr><td><code id="coef.lmCoDa_+3A_space">space</code></td>
<td>
<p>a character indicating in which space the prediction should
be returned. Supported are the options <code>c("clr", "simplex")</code>.</p>
</td></tr>
<tr><td><code id="coef.lmCoDa_+3A_split">split</code></td>
<td>
<p>logical, if <code>TRUE</code> the coefficients are reported as a list instead
of a matrix, where list structure reflects the explanatory variables of the model</p>
</td></tr>
<tr><td><code id="coef.lmCoDa_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>

<hr>
<h2 id='confint.lmCoDa'>Confidence Intervals for CoDa Models</h2><span id='topic+confint.lmCoDa'></span>

<h3>Description</h3>

<p>Dargel and Thomas-Agnan (2024) show to compute variances and confidence
intervals for parameters of CoDa models in log-ratio spaces.
</p>
<p>Of particular interest are the clr parameters since they can be directly
interpreted as differences from an average elasticity.
</p>
<p>Another option is interpret the difference in clr parameters as these
coincide with the difference in elasticities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmCoDa'
confint(object, parm, level = 0.95, y_ref = NULL, obs = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.lmCoDa_+3A_object">object</code></td>
<td>
<p>class &quot;lmCoDa&quot;</p>
</td></tr>
<tr><td><code id="confint.lmCoDa_+3A_parm">parm</code></td>
<td>
<p>a character, indicating the name of one explanatory variable</p>
</td></tr>
<tr><td><code id="confint.lmCoDa_+3A_level">level</code></td>
<td>
<p>a numeric, indicating the confidence level required</p>
</td></tr>
<tr><td><code id="confint.lmCoDa_+3A_y_ref">y_ref</code></td>
<td>
<p>an optional argument that indicates the reference component of
the response variable using its name or its position. <br />
This argument is only used in the Y-compositional model.
If it is supplied confidence intervals of difference are used instead of
the direct intervals of the parameters.</p>
</td></tr>
<tr><td><code id="confint.lmCoDa_+3A_obs">obs</code></td>
<td>
<p>an optional integer that indicates one observation
when this argument is supplied the function return the observation
dependent elasticity</p>
</td></tr>
<tr><td><code id="confint.lmCoDa_+3A_...">...</code></td>
<td>
<p>passed on to confit()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since CoDa models are often multivariate this function only allows to
specify one explanatory variable at a time.
The output is also more complex than the usual one for &quot;lm&quot; classes, because
we have to indicate the component of Y and X.
With <code><a href="stats.html#topic+confint.lm">confint.lm()</a></code> it is still possible to compute the usual the confidence
intervals.
</p>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>


<h3>References</h3>


<ul>
<li><p> Dargel, Lukas and Christine Thomas-Agnan, “Pairwise share ratio interpretations of compositional regression models”, Computational Statistics &amp; Data Analysis 195 (2024), p. 107945
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## ==== Y-compositional model ====
res &lt;- lmCoDa(
  ilr(cbind(left, right, extreme_right)) ~
  ilr(cbind(Age_1839, Age_4064)) +
  ilr(cbind(Educ_BeforeHighschool, Educ_Highschool, Educ_Higher)) +
  unemp_rate,
  data = head(election, 20))

## ---- CI for scalar X
# CI for clr parameters
confint(res, "unemp_rate")
# CI for difference in clr parameters (coincides with difference in the semi elasticity)
confint(res, "unemp_rate", y_ref = 1)

## ---- CI for compositional X
# CI for clr parameters
confint(res, "cbind(Age_1839, Age_4064)")

# CI for difference in clr parameters (coincides with difference in the elasticity)
confint(res, "cbind(Age_1839, Age_4064)", y_ref = 1)


</code></pre>

<hr>
<h2 id='election'>Results of french departmental elections in 2015</h2><span id='topic+election'></span>

<h3>Description</h3>

<p>The data is used by Nguyen et. al (2020) and originally disseminated by the
French ministry (Ministère de l'Intérieur et des Outre-Mer).
Information about the population characteristics comes from the french
national statistics institute (INSEE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>election
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 95 rows and 13 columns.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>left</code>, <code>right</code>, <code>extreme_right</code>: Vote shares during the election grouped into three blocks
</p>
</li>
<li> <p><code>Age_1839</code>, <code>Age_4064</code>, <code>Age_65plus</code>: Share of the population falling into one of three age categories
</p>
</li>
<li> <p><code>Educ_BeforeHighschool</code>, <code>Educ_Highschool</code>, <code>Educ_Higher</code>: Share of the population having completed a certain level of education.
</p>
</li>
<li> <p><code>asset_owner_rate</code>: The proportion of people who own assets
</p>
</li>
<li> <p><code>income_taxpayer_rate</code>: The proportion of people who pay income tax
</p>
</li>
<li> <p><code>forgeigner_rate</code>: The proportion of foreigners
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Lukas Dargel, Christine Thomas-Agnan
</p>


<h3>Source</h3>


<ul>
<li><p> https://www.data.gouv.fr/fr/datasets/elections-departementales-2015-resultats-par-bureaux-de-vote
</p>
</li>
<li><p> https://www.insee.fr/fr/accueil
</p>
</li></ul>



<h3>References</h3>

<p>Nguyen THA, Laurent T, Thomas-Agnan C, Ruiz-Gazen A. Analyzing the impacts of socio-economic factors on French departmental elections with CoDa methods. J Appl Stat. 2020 Dec 9;49(5):1235-1251. doi: 10.1080/02664763.2020.1858274. PMID: 35707505; PMCID: PMC9041641.
</p>

<hr>
<h2 id='fitted.lmCoDa'>Predictions, fitted values, residuals, and coefficients in CoDa models</h2><span id='topic+fitted.lmCoDa'></span>

<h3>Description</h3>

<p>These functions work as in the usual lm object.
They additionally offer the possibility use the <code>space</code> argument
which transforms them into directly into clr space or in the simplex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmCoDa'
fitted(object, space = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.lmCoDa_+3A_object">object</code></td>
<td>
<p>class &quot;lmCoDa&quot;</p>
</td></tr>
<tr><td><code id="fitted.lmCoDa_+3A_space">space</code></td>
<td>
<p>a character indicating in which space the prediction should
be returned. Supported are the options <code>c("clr", "simplex")</code>.</p>
</td></tr>
<tr><td><code id="fitted.lmCoDa_+3A_...">...</code></td>
<td>
<p>passed on to <code><a href="stats.html#topic+predict.lm">predict.lm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix or vector
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>

<hr>
<h2 id='Impacts'>Computation of elasticities in CoDa regression models</h2><span id='topic+Impacts'></span>

<h3>Description</h3>

<p>This function computes elasticities and semi-elasticities for CoDa
regression model.
where we have to distinguish four cases:
</p>

<ul>
<li><p> Y and X are both compositional: this leads to an elasticity
</p>
</li>
<li><p> Y is compositional and X is scalar: this leads to a semi-elasticity
</p>
</li>
<li><p> Y is scalar and X is compositional: this leads to a semi-elasticity
</p>
</li>
<li><p> Y and X are both scalar: this case is not implemented as it leads to constant marginal effects
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Impacts(object, Xvar = NULL, obs = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Impacts_+3A_object">object</code></td>
<td>
<p>an object of class &quot;lmCoDa&quot;</p>
</td></tr>
<tr><td><code id="Impacts_+3A_xvar">Xvar</code></td>
<td>
<p>a character indicating the name of one explanatory variable</p>
</td></tr>
<tr><td><code id="Impacts_+3A_obs">obs</code></td>
<td>
<p>a numeric that refers to the indicator of one observation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mathematical foundation for elasticity computations in CoDa model come
from Morais and Thomas-Agnan (2021).
Dargel and Thomas-Agnan (2024) present further results and illustrations.
</p>


<h3>Value</h3>

<p>a matrix
</p>


<h3>Author(s)</h3>


<ul>
<li><p> Lukas Dargel
</p>
</li>
<li><p> Rodrigue Nasr
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Dargel, Lukas and Christine Thomas-Agnan, “Pairwise share ratio interpretations of compositional regression models”, Computational Statistics &amp; Data Analysis 195 (2024), p. 107945
</p>
</li>
<li><p> Morais, Joanna and Christine Thomas-Agnan. &quot;Impact of covariates in compositional models and simplicial derivatives.&quot; Austrian Journal of Statistics 50.2 (2021): 1-15.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>res &lt;- lmCoDa(YIELD ~ PRECIPITATION + ilr(TEMPERATURES), data = head(rice_yields,20))
Impacts(res, Xvar = "TEMPERATURES")

</code></pre>

<hr>
<h2 id='lmCoDa'>Estimating CoDa regression models</h2><span id='topic+lmCoDa'></span>

<h3>Description</h3>

<p>This is a thin wrapper around <code><a href="stats.html#topic+lm">lm()</a></code> followed by <code><a href="#topic+ToSimplex">ToSimplex()</a></code>, which
allows to create a lmCoDa object in one step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmCoDa(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lmCoDa_+3A_formula">formula</code></td>
<td>
<p>as in <code><a href="stats.html#topic+lm">lm()</a></code></p>
</td></tr>
<tr><td><code id="lmCoDa_+3A_data">data</code></td>
<td>
<p>as in <code><a href="stats.html#topic+lm">lm()</a></code></p>
</td></tr>
<tr><td><code id="lmCoDa_+3A_...">...</code></td>
<td>
<p>arguments passed on to <code><a href="stats.html#topic+lm">lm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;lm&quot; and &quot;lmCoDa&quot; if the formula include at least
one log-transformation
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm()</a></code>, <code><a href="#topic+ToSimplex">ToSimplex()</a></code>, <code><a href="compositions.html#topic+ilr">compositions::ilr()</a></code>, <code><a href="compositions.html#topic+alr">compositions::alr()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# XY-compositional model
res &lt;- lmCoDa(
  ilr(cbind(left, right, extreme_right)) ~
  ilr(cbind(Educ_BeforeHighschool, Educ_Highschool, Educ_Higher)),
  data =  head(election, 20))

# X-compositional model
res &lt;- lmCoDa(YIELD ~ PRECIPITATION + ilr(TEMPERATURES), data = head(rice_yields, 20))

</code></pre>

<hr>
<h2 id='pct'>Format numbers to percentages
This code copied from stats:::format.perc(), to avoid notes about the ::: operator.</h2><span id='topic+pct'></span>

<h3>Description</h3>

<p>Format numbers to percentages
This code copied from stats:::format.perc(), to avoid notes about the ::: operator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pct(probs, digits = 10)
</code></pre>

<hr>
<h2 id='predict.lmCoDa'>Predictions, fitted values, residuals, and coefficients in CoDa models</h2><span id='topic+predict.lmCoDa'></span>

<h3>Description</h3>

<p>These functions work as in the usual lm object.
They additionally offer the possibility use the <code>space</code> argument
which transforms them into directly into clr space or in the simplex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmCoDa'
predict(object, space = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.lmCoDa_+3A_object">object</code></td>
<td>
<p>class &quot;lmCoDa&quot;</p>
</td></tr>
<tr><td><code id="predict.lmCoDa_+3A_space">space</code></td>
<td>
<p>a character indicating in which space the prediction should
be returned. Supported are the options <code>c("clr", "simplex")</code>.</p>
</td></tr>
<tr><td><code id="predict.lmCoDa_+3A_...">...</code></td>
<td>
<p>passed on to <code><a href="stats.html#topic+predict.lm">predict.lm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix or vector
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+alr'></span><span id='topic+alrInv'></span><span id='topic+clr'></span><span id='topic+clrInv'></span><span id='topic+ilr'></span><span id='topic+ilrInv'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>compositions</dt><dd><p><code><a href="compositions.html#topic+alr">alr</a></code>, <code><a href="compositions.html#topic+alr">alrInv</a></code>, <code><a href="compositions.html#topic+clr">clr</a></code>, <code><a href="compositions.html#topic+clr">clrInv</a></code>, <code><a href="compositions.html#topic+ilr">ilr</a></code>, <code><a href="compositions.html#topic+ilr">ilrInv</a></code></p>
</dd>
</dl>

<hr>
<h2 id='residuals.lmCoDa'>Predictions, fitted values, residuals, and coefficients in CoDa models</h2><span id='topic+residuals.lmCoDa'></span>

<h3>Description</h3>

<p>These functions work as in the usual lm object.
They additionally offer the possibility use the <code>space</code> argument
which transforms them into directly into clr space or in the simplex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmCoDa'
residuals(object, space = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.lmCoDa_+3A_object">object</code></td>
<td>
<p>class &quot;lmCoDa&quot;</p>
</td></tr>
<tr><td><code id="residuals.lmCoDa_+3A_space">space</code></td>
<td>
<p>a character indicating in which space the prediction should
be returned. Supported are the options <code>c("clr", "simplex")</code>.</p>
</td></tr>
<tr><td><code id="residuals.lmCoDa_+3A_...">...</code></td>
<td>
<p>passed on to <code><a href="stats.html#topic+predict.lm">predict.lm()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix or vector
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>

<hr>
<h2 id='rice_yields'>Data on the rice yields in the Vietnamese provinces</h2><span id='topic+rice_yields'></span>

<h3>Description</h3>

<p>The data is presented in  Trinh et al. (2023) for studying the impact
of climate change on  rice production in Vietnam. <br />
It contains the following information:
</p>

<ul>
<li> <p><code>PROVINCE</code>: a factor for the 63 provinces of Vietnam
</p>
</li>
<li> <p><code>REGION</code>: a factor with the 6 main regions
</p>
</li>
<li> <p><code>YEAR</code>: a numeric corresponding to the year
</p>
</li>
<li> <p><code>YIELD</code>: a numeric for the rice production in tons per hectare
</p>
</li>
<li> <p><code>PRECIPITATION</code>: a numeric for the annual precipitation in liters
</p>
</li>
<li> <p><code>TEMPERATURES</code>: a compositional variable represented as a matrix <br />
whose columns correspond to the proportion of days in a year where the maximal
temperature (in Celsius degrees) falls into one of the three categories:
&quot;LOW&quot; (from -6, to 25.1), &quot;MEDIUM&quot; (from 25.1 to 35.4)  and &quot;HIGH&quot; (from 35.4 to 45).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>rice_yields
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 1890 rows and 6 columns.
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel, Christine Thomas-Agnan
</p>


<h3>References</h3>

<p>Thi-Huong Trinh, Michel Simioni, and Christine Thomas-Agnan,
“Discrete and Smooth Scalar-on-Density Compositional Regression
for Assessing the Impact of Climate Change on Rice Yield in Vietnam”,
TSE Working Paper, n. 23-1410, February 2023.
</p>

<hr>
<h2 id='ShareRatioElasticities'>Compute share ratio elasticities for CoDa models</h2><span id='topic+ShareRatioElasticities'></span>

<h3>Description</h3>

<p>In CoDa models with compositional dependent variable (Y) share ratio elasticities (SRE)
allow to interpret the influence of compositional explanatory variables (X).
The interpretation is analogous to usual elasticities:
</p>

<ul>
<li><p> When the share ratio of X increases by 1% the share ratio of Y increases by SRE%
</p>
</li>
<li><p> The main difference to usual elasticities that, since X is compositional
the change of X musts be specified in terms of a direction in the simplex.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>ShareRatioElasticities(object, Xvar, Xdir = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ShareRatioElasticities_+3A_object">object</code></td>
<td>
<p>an object of class &quot;lmCoDa&quot;</p>
</td></tr>
<tr><td><code id="ShareRatioElasticities_+3A_xvar">Xvar</code></td>
<td>
<p>a character indicating the name of the explanatory variable that changes</p>
</td></tr>
<tr><td><code id="ShareRatioElasticities_+3A_xdir">Xdir</code></td>
<td>
<p>a numeric vector, a single character, or <code>NULL</code>:
</p>

<ul>
<li><p> if numeric <code>Xdir</code> is taken as a fixed direction in the simplex
</p>
</li>
<li><p> if character <code>Xdir</code> is interpreted as one summit of the X composition and converted to the fixed direction towards this summit
</p>
</li>
<li><p> if <code>NULL</code> the share ratio elasticities are computed for variable directions corresponding the example in Dargel and Thomas-Agnan (2024 Lukas Dargel &amp; Christine Thomas-Agnan (2024) The link between multiplicative competitive interaction models and compositional data regression with a total, Journal of Applied Statistics, DOI: 10.1080/02664763.2024.2329923 )
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>More details on this interpretation can be found in Dargel and Thomas-Agnan (2024) and in the accompanying vignette.
</p>


<h3>Value</h3>

<p>a data.frame
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>


<h3>References</h3>


<ul>
<li><p> Dargel, Lukas and Christine Thomas-Agnan, “Pairwise share ratio interpretations of compositional regression models”, Computational Statistics &amp; Data Analysis 195 (2024), p. 107945
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
### XY-compositional model
res &lt;- lmCoDa(
  ilr(cbind(left, right, extreme_right)) ~
  ilr(cbind(Educ_BeforeHighschool, Educ_Highschool, Educ_Higher)),
  data =  head(election, 20))

## Focus on changes in the education composition
educ_comp &lt;- "cbind(Educ_BeforeHighschool, Educ_Highschool, Educ_Higher)"

## case 1
## changes towards the summit "Educ_Higher" as (fixed) direction
SRE1 &lt;- ShareRatioElasticities(res, Xvar = educ_comp, Xdir = "Educ_Higher")

SRE1[1,]
# Result: SRE=Inf
# cannot be interpreted because, for this direction,
# the relative change in the share ratio of X (Highschool / BeforeHighschool) is zero
SRE1[7,]
# Result: SRE=0.9
# when the ratio of X (Higher / BeforeHighschool) increases by 1%
# the ratio of Y (right / left) increases by about 0.9%

## case 2
## numeric vector as (fixed) direction
SRE2 &lt;- ShareRatioElasticities(res, Xvar = educ_comp, Xdir = exp(c(0,0,1)))
identical(SRE1,SRE2) # exp(c(0,0,1)) is the direction that points to the third summit

## case 3
## variable directions with Xdir = NULL
## In this case the direction depends components used for the share ratio of X
## In particular the component of X in the numerator grows
## by the same rate as the denominator decreases
SRE3 &lt;- ShareRatioElasticities(res, Xvar = educ_comp, Xdir = NULL)
SRE3[1,]
# Result: SRE=-2.8
# when the ratio of X (Highschool / BeforeHighschool) increases by 1%
# the ratio of Y (right / left) decreases by about -2.8%
</code></pre>

<hr>
<h2 id='ToSimplex'>Converting Linear Models to CoDa models</h2><span id='topic+ToSimplex'></span>

<h3>Description</h3>

<p>The function converts the output of a &quot;lm&quot; to the &quot;lmCoDa&quot; class, which
offers additional tools for the interpretation of a CoDa regression models.
Most of the work is done by the <code><a href="#topic+transformationSummary">transformationSummary()</a></code> function, which
has its own documentation page, but should be reserved for internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ToSimplex(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ToSimplex_+3A_object">object</code></td>
<td>
<p>an object of class &quot;lmCoDa&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class &quot;lm&quot; and &quot;lmCoDa&quot; if the formula include at least
one log-transformation
</p>


<h3>Author(s)</h3>


<ul>
<li><p> Lukas Dargel
</p>
</li>
<li><p> Rodrigue Nasr
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm()</a></code>, <code><a href="#topic+lmCoDa">lmCoDa()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# XY-compositional model
res &lt;- lm(
  ilr(cbind(left, right, extreme_right)) ~
  ilr(cbind(Educ_BeforeHighschool, Educ_Highschool, Educ_Higher)),
  data =  head(election, 20))
res &lt;- ToSimplex(res)

# X-compositional model
res &lt;- lm(YIELD ~ PRECIPITATION + ilr(TEMPERATURES), data = head(rice_yields, 20))
res &lt;- ToSimplex(res)
</code></pre>

<hr>
<h2 id='toulouse_retail'>Simulated retail data for nine shopping malls in the city of Toulouse</h2><span id='topic+toulouse_retail'></span>

<h3>Description</h3>

<p>This data set provides an example for the use of CoDa models in geomarketing applications.
The data is simulated, but realistic in the sense that the parameters used for the simulation
were estimated on a real, but confidential data set (Dargel and Thomas-Agnan 2024).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toulouse_retail
</code></pre>


<h3>Format</h3>

<p>An object of class <code>sf</code> (inherits from <code>data.table</code>, <code>data.frame</code>) with 428 rows and 6 columns.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>ID_IRIS</code>: Identifies the geographic region.
</p>
</li>
<li> <p><code>POP</code>: Population number within the region
</p>
</li>
<li> <p><code>MEDIAN_INCOME</code>: The median income in the region
</p>
</li>
<li> <p><code>dist_km</code>: Distances from the region to all nine shopping malls.
</p>
</li>
<li> <p><code>visits</code>: The share of visitors that coming from the region and going to each of the malls.
</p>
</li>
<li> <p><code>geometry</code>: The geometry (polygon) of the region
</p>
</li>
<li><p> The &quot;mall_locations&quot; and the &quot;simulation_parameters&quot; are given as additional attributes.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Lukas Dargel, Christine Thomas-Agnan
</p>


<h3>Source</h3>


<ul>
<li><p> The figures for <code>POP</code> and <code>MEDIAN_INCOME</code> come from the <a href="https://www.insee.fr/fr/information/4467366">French census data prided by INSEE</a>.
</p>
</li>
<li><p> The polygon <code>geometry</code> is <a href="https://geoservices.ign.fr/contoursiris">provided by the IGN</a>.
</p>
</li>
<li><p> The locations of the nine shopping malls around the city center are derived from online mapping services (Google Maps and OpenStreetMap).
</p>
</li>
<li><p> The distances (<code>dist_km</code>) are derived from location information.
</p>
</li>
<li><p> The number of shopping trips (<code>visits</code>) are simulated by the authors.
</p>
</li></ul>



<h3>References</h3>

<div class="sourceCode"><pre>Lukas Dargel &amp; Christine Thomas-Agnan (2024) “The link between multiplicative competitive interaction models and compositional data regression with a total”, Journal of Applied Statistics, DOI: 10.1080/02664763.2024.2329923
</pre></div>

<hr>
<h2 id='transformationSummary'>Summarize the transformations in a CoDa model (internal)</h2><span id='topic+transformationSummary'></span>

<h3>Description</h3>

<p>Extract from a CoDa model estimated by <code>lm()</code> all information related to the
log-ratio transformations of the variables and the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformationSummary(lm_res)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformationSummary_+3A_lm_res">lm_res</code></td>
<td>
<p>class &quot;lm&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The structure of the return value resembles a data.frame where most columns
are lists instead of vectors.
The rows in this data.frame correspond to the variables used for fitting
the model.
The columns store information on the log-ratio transformations and their
associated bases (K and F).
Additionally the clr parameters and the covariance matrices are retained.
</p>


<h3>Value</h3>

<p>data.frame, with list columns
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>

<hr>
<h2 id='VariationScenario'>Scenarios for variation in CoDa regressions models</h2><span id='topic+VariationScenario'></span>

<h3>Description</h3>

<p>Scenarios of this type are illustrated in Dargel and Thomas-Agnan (2024).
They allow to evaluate how the response variable (Y) in a CoDa model would evolve under a hypothetical scenario for linear changes in one explanatory variable (X).
When the changing explanatory variable is compositional the term &quot;linear&quot; is understood with respect to the geometry of the simplex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VariationScenario(
  object,
  Xvar,
  Xdir,
  obs = 1,
  inc_size = 0.1,
  n_steps = 100,
  add_opposite = TRUE,
  normalize_Xdir = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VariationScenario_+3A_object">object</code></td>
<td>
<p>an object of class &quot;lmCoDa&quot;</p>
</td></tr>
<tr><td><code id="VariationScenario_+3A_xvar">Xvar</code></td>
<td>
<p>a character indicating the name of the explanatory variable that changes</p>
</td></tr>
<tr><td><code id="VariationScenario_+3A_xdir">Xdir</code></td>
<td>
<p>either character or numeric, to indicate the direction in which Xvar should change
</p>

<ul>
<li><p> when character this should be one of the components of X, in which case the direction is the corresponding vertex of the simplex
</p>
</li>
<li><p> when numeric this argument is coerced to a unit vector in the simplex
</p>
</li>
<li><p> (when Xvar refers to a scalar variable this argument is ignored)
</p>
</li></ul>
</td></tr>
<tr><td><code id="VariationScenario_+3A_obs">obs</code></td>
<td>
<p>a numeric indicating the observation used for the scenario</p>
</td></tr>
<tr><td><code id="VariationScenario_+3A_inc_size">inc_size</code></td>
<td>
<p>a numeric indicating the distance between each point in the scenario of X</p>
</td></tr>
<tr><td><code id="VariationScenario_+3A_n_steps">n_steps</code></td>
<td>
<p>a numeric indicating the number of points in the scenario</p>
</td></tr>
<tr><td><code id="VariationScenario_+3A_add_opposite">add_opposite</code></td>
<td>
<p>a logical, if <code>TRUE</code> the scenario also includes changes in the opposite direction</p>
</td></tr>
<tr><td><code id="VariationScenario_+3A_normalize_xdir">normalize_Xdir</code></td>
<td>
<p>a logical, if <code>TRUE</code> the direction <code>Xdir</code> scaled to have an Aitchison norm of 1, allowing to interpret <code>inc_size</code> as the Aitchison distance</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The linear scenario for X is computed with <code><a href="base.html#topic+seq">seq()</a></code> in the scalar case and with <code><a href="#topic+CoDa_seq">CoDa_seq()</a></code> in the compositional case.
The corresponding changes in Y are computed with the prediction formula, where we exploit the fact that only in one variable is changing.
</p>


<h3>Value</h3>

<p>a data.frame containing the scenario of X and the corresponding predicted values of Y
</p>


<h3>Author(s)</h3>

<p>Lukas Dargel
</p>


<h3>References</h3>


<ul>
<li><p> Dargel, Lukas and Christine Thomas-Agnan, “Pairwise share ratio interpretations of compositional regression models”, Computational Statistics &amp; Data Analysis 195 (2024), p. 107945
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
# ---- model with scalar response ----
res &lt;- lmCoDa(YIELD ~ PRECIPITATION + ilr(TEMPERATURES), data = head(rice_yields,20))
VariationScenario(res, Xvar = "TEMPERATURES", Xdir = "MEDIUM", n_steps = 5)
VariationScenario(res, Xvar = "PRECIPITATION", n_steps = 5)


# ---- model with compositional response ----
res &lt;- lmCoDa(ilr(cbind(left, right, extreme_right)) ~
                ilr(cbind(Age_1839, Age_4064)) +
                ilr(cbind(Educ_BeforeHighschool, Educ_Highschool, Educ_Higher)) +
                log(unemp_rate),
              data = head(election))

VariationScenario(res, Xvar ="cbind(Age_1839,Age_4064)",Xdir = "Age_1839", n_steps = 5)
VariationScenario(res, "log(unemp_rate)", n_steps = 5)

</code></pre>

<hr>
<h2 id='VariationTable'>Effects of infinitesimal changes in CoDa models</h2><span id='topic+VariationTable'></span>

<h3>Description</h3>

<p>This function allows to evaluate how a change in an explanatory variables
impacts the response variable in a CoDa regression model.
The changes are calculated based from the approximate formal presented
in Dargel and Thomas-Agnan (2024).
Changes in the response variables are provided as data.frame and the
underlying changes in the explanatory variable are given as attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VariationTable(
  object,
  Xvar,
  Xdir,
  obs = 1,
  inc_size = 0.1,
  inc_rate = NULL,
  Ytotal = 1,
  normalize_Xdir = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VariationTable_+3A_object">object</code></td>
<td>
<p>an object of class &quot;lmCoDa&quot;</p>
</td></tr>
<tr><td><code id="VariationTable_+3A_xvar">Xvar</code></td>
<td>
<p>a character indicating the name of the explanatory variable that changes</p>
</td></tr>
<tr><td><code id="VariationTable_+3A_xdir">Xdir</code></td>
<td>
<p>either character or numeric, to indicate the direction in which Xvar should change
</p>

<ul>
<li><p> when character this should be one of the components of X, in which case the direction is the corresponding vertex of the simplex
</p>
</li>
<li><p> when numeric this argument is coerced to a unit vector in the simplex
</p>
</li>
<li><p> (when Xvar refers to a scalar variable this argument is ignored)
</p>
</li></ul>
</td></tr>
<tr><td><code id="VariationTable_+3A_obs">obs</code></td>
<td>
<p>a numeric indicating the observation used for the scenario</p>
</td></tr>
<tr><td><code id="VariationTable_+3A_inc_size">inc_size</code></td>
<td>
<p>a numeric indicating the distance between each point in the scenario of X</p>
</td></tr>
<tr><td><code id="VariationTable_+3A_inc_rate">inc_rate</code></td>
<td>
<p>a numeric that can be used as a parameterization of the step size</p>
</td></tr>
<tr><td><code id="VariationTable_+3A_ytotal">Ytotal</code></td>
<td>
<p>a numeric indicating the total of Y</p>
</td></tr>
<tr><td><code id="VariationTable_+3A_normalize_xdir">normalize_Xdir</code></td>
<td>
<p>a logical, if <code>TRUE</code> the direction <code>Xdir</code> scaled to have an Aitchison norm of 1, allowing to interpret <code>inc_size</code> as the Aitchison distance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Author(s)</h3>


<ul>
<li><p> Lukas Dargel
</p>
</li>
<li><p> Rodrigue Nasr
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Dargel, Lukas and Christine Thomas-Agnan, “Pairwise share ratio interpretations of compositional regression models”, Computational Statistics &amp; Data Analysis 195 (2024), p. 107945
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
# XY-compositional model
res &lt;- lmCoDa(
  ilr(cbind(left, right, extreme_right)) ~
  ilr(cbind(Educ_BeforeHighschool, Educ_Highschool, Educ_Higher)),
  data =  head(election, 20))

# Focus on changes in the education composition
educ_comp &lt;- "cbind(Educ_BeforeHighschool, Educ_Highschool, Educ_Higher)"

# ... changes towards a summit towards a summit (higher share of people with lower education)
VariationTable(res, educ_comp, Xdir = "Educ_BeforeHighschool")

# ... same changes using a compositional vector as direction
VariationTable(res, educ_comp, Xdir = c(.5,.25,.25))

# ... changes in a more general direction and for a different observation
VariationTable(res, educ_comp, Xdir = c(.35,.45,.10), obs = 2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
