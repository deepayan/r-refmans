<!DOCTYPE html><html><head><title>Help for package bubbleHeatmap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bubbleHeatmap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#arrangePanels'><p>Arrange Multiple bubbleHeatmap gTrees Inside a New Viewport.</p></a></li>
<li><a href='#bubbleHeatmap'><p>Generate bubbleHeatmap Plot Object</p></a></li>
<li><a href='#bubbleHeatmapList'><p>Output List of bubbleHeatmap Plots.</p></a></li>
<li><a href='#bubbleHMLegends'><p>Build Legend Trees for bubbleHeatmap Plots</p></a></li>
<li><a href='#cetp'><p>Associations of Nightingale Health Metabolomics Panel with a Cholesterol</p>
Esterase Transfer Protein Genetic Risk Score in China Kadoorie Biobank</a></li>
<li><a href='#combinePanels'><p>Combine Multiple Panels In A New gTree.</p></a></li>
<li><a href='#formatData'><p>Split Data Into Matrices and Reorder Rows and Columns.</p></a></li>
<li><a href='#getLayoutSizes'><p>Recalculate Layout Sizes for bubbleHeatmap gTree</p></a></li>
<li><a href='#matchLayoutHeights'><p>Match Viewport Layout Dimensions.</p></a></li>
<li><a href='#merge_template'><p>Merge Nightingale Figure Templates with User Data</p></a></li>
<li><a href='#metabFigure'><p>Create Nightingale Figure From Template</p></a></li>
<li><a href='#metabFigurePlot'><p>Arrange List of bubbleHeatmap Plots According to Preset Nightingale Template.</p></a></li>
<li><a href='#multiPlotInput'><p>Arrange bubbleHeatmap Arguments in Lists for Building Multiple Plots.</p></a></li>
<li><a href='#nightingaleTemplates'><p>Nightingale Health Metabolomics Plot Template Format</p></a></li>
<li><a href='#widthDetails.bubbleHeatmap'><p>Methods for determining the width/height of bubbleHeatmap plots and legends.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Produces 'bubbleHeatmap' Plots for Visualising Metabolomics Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Plotting package based on the grid system, combining elements of 
    a bubble plot and heatmap to conveniently display two numerical variables, 
    (represented by color and size) grouped by categorical variables on the x 
    and y axes. This is a useful alternative to a forest plot when the data can 
    be grouped in two dimensions, such as predictors x outcomes. It has 
    particular advantages for visualising the metabolic measures produced by 
    the 'Nightingale Health' metabolomics platform, and templates are included 
    for automatically generating figures from these datasets.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>reshape, methods</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), grid</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-15 14:37:02 UTC; ruthb</td>
</tr>
<tr>
<td>Author:</td>
<td>Ruth Boxall [aut, cre],
  Michael Holmes [ctb],
  Robin Walters [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ruth Boxall &lt;ruth.boxall@ndph.ox.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-15 14:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='arrangePanels'>Arrange Multiple bubbleHeatmap gTrees Inside a New Viewport.</h2><span id='topic+arrangePanels'></span>

<h3>Description</h3>

<p>The arrangePanels function creates a new viewport with a grid layout, and
directs the input trees to be drawn at positions within the new layout. The
new layout is filled by rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arrangePanels(
  name,
  subTrees,
  nrow,
  ncol,
  spacer = unit(0, "cm"),
  margin = unit(0, "cm"),
  just = c(0.5, 0.5)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arrangePanels_+3A_name">name</code></td>
<td>
<p>Character string naming the new viewport (will have suffix &quot;VP&quot;)</p>
</td></tr>
<tr><td><code id="arrangePanels_+3A_subtrees">subTrees</code></td>
<td>
<p>gTrees to be arranged in the new panel</p>
</td></tr>
<tr><td><code id="arrangePanels_+3A_nrow">nrow</code></td>
<td>
<p>Numeric, number of rows in the new layout</p>
</td></tr>
<tr><td><code id="arrangePanels_+3A_ncol">ncol</code></td>
<td>
<p>Numeric, number of columns in the new layout</p>
</td></tr>
<tr><td><code id="arrangePanels_+3A_spacer">spacer</code></td>
<td>
<p>Grid <code><a href="grid.html#topic+unit">unit</a></code> object specifying size of space
left between plots.</p>
</td></tr>
<tr><td><code id="arrangePanels_+3A_margin">margin</code></td>
<td>
<p>Grid <code><a href="grid.html#topic+unit">unit</a></code> object specifying size of margin
around panel.</p>
</td></tr>
<tr><td><code id="arrangePanels_+3A_just">just</code></td>
<td>
<p>Numeric or character vector specifying justification of tree
viewports within panel viewport layout cells.
See <code><a href="grid.html#topic+viewport">viewport</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing grobList (a list of modified gTrees) and vp, the new
viewport object.
</p>

<hr>
<h2 id='bubbleHeatmap'>Generate bubbleHeatmap Plot Object</h2><span id='topic+bubbleHeatmap'></span>

<h3>Description</h3>

<p>This function creates a gTree for a bubbleHeatmap plot. These plots have a
grid of &quot;bubbles&quot; with the color and size each scaled according to the values
of a different variable. They can be used as an alternative to forest plots
for visualizing estimates and errors that can be organised in a grid format,
correlograms, and any other two variable matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bubbleHeatmap(
  colorMat,
  sizeMat = colorMat,
  treeName = "Plot",
  context = gpar(cex = 0.8),
  colorSeq = c("#053061", "#2166AC", "#4393C3", "#92C5DE", "#D1E5F0", "#FDDBC7",
    "#F4A582", "#D6604D", "#B2182B", "#67001F"),
  unitBase = unit(0.5, "cm"),
  diameter = 0.8,
  colorLim = c(NA, NA),
  sizeLim = c(NA, NA),
  showTopLabels = TRUE,
  showLeftLabels = TRUE,
  leftLabelsTitle = FALSE,
  showRowBracket = FALSE,
  rowTitle = FALSE,
  showColBracket = FALSE,
  colTitle = FALSE,
  plotTitle = FALSE,
  xTitle = FALSE,
  yTitle = FALSE,
  showColorLegend = TRUE,
  showBubbleLegend = TRUE,
  colorBreaks = NULL,
  sizeBreaks = NULL,
  legendHeight = 8,
  legendTitles = c(expression("-log"[10] * "P"), "Estimate (SD)")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bubbleHeatmap_+3A_colormat">colorMat</code>, <code id="bubbleHeatmap_+3A_sizemat">sizeMat</code></td>
<td>
<p>Numeric matrices containing values to be mapped to
bubble color and size respectively. The dimensions, rownames and colnames of
these matrices must match.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_treename">treeName</code></td>
<td>
<p>Identifying character string for <code><a href="grid.html#topic+gTree">gTree</a></code>.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_context">context</code></td>
<td>
<p><code><a href="grid.html#topic+gpar">gpar</a></code> object to provide drawing context.
Will be applied to the parent viewport in the childrenvp slot of the gTree.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_colorseq">colorSeq</code></td>
<td>
<p>Character vector of colors to be used in creating color
scale.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_unitbase">unitBase</code></td>
<td>
<p><code><a href="grid.html#topic+unit">unit</a></code> object indicating the size of one
plot grid box.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_diameter">diameter</code></td>
<td>
<p>Maximum diameter of bubbles as multiple of unitBase.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_colorlim">colorLim</code>, <code id="bubbleHeatmap_+3A_sizelim">sizeLim</code></td>
<td>
<p>Numeric vectors indicating limits (min/max) outside
which the values of color/size matrices should be truncated. NOTE! These
data ranges are separate from the scale ranges, which are taken from the
min/max values of <code>colorBreaks</code> and <code>sizeBreaks</code>.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_showtoplabels">showTopLabels</code></td>
<td>
<p>Logical, should matrix column names be printed above
plot?</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_showleftlabels">showLeftLabels</code></td>
<td>
<p>Logical, should matrix row names be printed above
plot?</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_leftlabelstitle">leftLabelsTitle</code></td>
<td>
<p>Heading to print over the column of row names.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_showrowbracket">showRowBracket</code></td>
<td>
<p>Logical vector, should vertical bracket be printed to
the right of the plot (to label a row of plots in a final figure layout)?</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_rowtitle">rowTitle</code></td>
<td>
<p>Label to be printed to the right of the plot, outside row
bracket if present, to label a row of plots in a final figure layout.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_showcolbracket">showColBracket</code></td>
<td>
<p>Logical, should horizontal bracket be printed
below the plot (to label a column of plots in a final figure layout)?</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_coltitle">colTitle</code></td>
<td>
<p>Label to be printed below plot, outside col bracket if
present, to label a column of plots in a final figure layout.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_plottitle">plotTitle</code></td>
<td>
<p>Plot title string, to be centered above plot.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_xtitle">xTitle</code></td>
<td>
<p>X-axis title string, displayed left of <code>LeftLabels</code>.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_ytitle">yTitle</code></td>
<td>
<p>Y-axis title string, displayed above <code>TopLabels</code>.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_showcolorlegend">showColorLegend</code>, <code id="bubbleHeatmap_+3A_showbubblelegend">showBubbleLegend</code></td>
<td>
<p>Should plot include legends for color
scale/bubble size?</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_colorbreaks">colorBreaks</code>, <code id="bubbleHeatmap_+3A_sizebreaks">sizeBreaks</code></td>
<td>
<p>Character vectors of legend tick labels. The
min/max values will represent the range of color/size scales. If not supplied
then these will be generated using <code><a href="base.html#topic+pretty">pretty</a></code>, to a range
outside data values (after values truncated to <code>colorLim</code>\<code>sizeLim</code>
if applicable).</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_legendheight">legendHeight</code></td>
<td>
<p>Numeric, preferred height of legends in multiples of
<code>unitBase</code>. This will be supplied to  <code><a href="base.html#topic+pretty">pretty</a></code>
function. If sizeBreaks vector is supplied then this will be ignored and
legend height will be <code>length(sizeBreaks)</code>.</p>
</td></tr>
<tr><td><code id="bubbleHeatmap_+3A_legendtitles">legendTitles</code></td>
<td>
<p>Character vector of legend titles. First string should be
the size legend title, second for the color legend.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function creates a bubbleHeatmap using the <code>grid</code> graphics package.
It does not draw any output but produces a <code><a href="grid.html#topic+gTree">gTree</a></code> object
which can be drawn using the <code><a href="grid.html#topic+grid.draw">grid.draw</a></code> function. Returned
trees always include a <code><a href="grid.html#topic+viewport">viewport</a></code> object with a 7x6 layout
and a given plot element is always positioned in the same cell, to assist
with aligning elements when combining multiple plots in a single figure (see
vignette, <code><a href="#topic+matchLayoutHeights">matchLayoutHeights</a></code>, <code><a href="#topic+matchLayoutWidths">matchLayoutWidths</a></code>).
NOTE: A cairo output device with gradient support is necessary to correctly
render the color legend.
</p>


<h3>See Also</h3>

<p>Other build functions: 
<code><a href="#topic+bubbleHMLegends">bubbleHMLegends</a>()</code>,
<code><a href="#topic+bubbleHeatmapList">bubbleHeatmapList</a>()</code>,
<code><a href="#topic+multiPlotInput">multiPlotInput</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1 - Available plot features#
names &lt;- list(paste0("leftLabels", 1:6), paste0("topLabels", 1:10))
colorMat &lt;- matrix(rnorm(60), nrow = 6, ncol = 10, dimnames = names)
sizeMat &lt;- matrix(abs(rnorm(60)), nrow = 6, ncol = 10, dimnames = names)
tree &lt;- bubbleHeatmap(colorMat, sizeMat,
  treeName = "example",
  leftLabelsTitle = "leftLabelsTitle", showRowBracket = TRUE,
  rowTitle = "rowTitle", showColBracket = TRUE, colTitle = "colTitle",
  plotTitle = "plotTitle", xTitle = "xTitle", yTitle = "yTitle",
  legendTitles = c("legendTitles[1]", "legendTitles[2]")
)
grid.draw(tree)

</code></pre>

<hr>
<h2 id='bubbleHeatmapList'>Output List of bubbleHeatmap Plots.</h2><span id='topic+bubbleHeatmapList'></span>

<h3>Description</h3>

<p>Convenient wrapper for <code>bubbleHeatmap</code> and <code>bubbleHMLegend</code> for
easy output of multiple plots from lists of arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bubbleHeatmapList(inputList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bubbleHeatmapList_+3A_inputlist">inputList</code></td>
<td>
<p>A list of two lists, trees and legend. trees should contain
a list of lists of arguments for multiple calls to bubbleHeatmap and legend
should contain a list of arguments for a call to bubbleHMLegends. This
object can be generated automatically using <code><a href="#topic+multiPlotInput">multiPlotInput</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of bubbleHeatmap <code><a href="grid.html#topic+gTree">gTree</a></code> objects. Any
legends specified by the legend list will also be produced as separate trees
in the output list.
</p>


<h3>See Also</h3>

<p>Other build functions: 
<code><a href="#topic+bubbleHMLegends">bubbleHMLegends</a>()</code>,
<code><a href="#topic+bubbleHeatmap">bubbleHeatmap</a>()</code>,
<code><a href="#topic+multiPlotInput">multiPlotInput</a>()</code>
</p>

<hr>
<h2 id='bubbleHMLegends'>Build Legend Trees for bubbleHeatmap Plots</h2><span id='topic+bubbleHMLegends'></span>

<h3>Description</h3>

<p>Generate a bubble size legend and/or color legend for bubbleHeatmap plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bubbleHMLegends(
  sizeBreaks,
  colorBreaks,
  colorSeq,
  unitBase,
  diameter,
  context,
  legendHeight,
  legendTitles,
  showBubbleLegend = TRUE,
  showColorLegend = TRUE,
  name = "Legends",
  orientation = c("horizontal", "vertical")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bubbleHMLegends_+3A_colorbreaks">colorBreaks</code>, <code id="bubbleHMLegends_+3A_sizebreaks">sizeBreaks</code></td>
<td>
<p>Character vectors of legend tick labels. The
min/max values will represent the range of color/size scales. If not supplied
then these will be generated using <code><a href="base.html#topic+pretty">pretty</a></code>, to a range
outside data values (after values truncated to <code>colorLim</code>\<code>sizeLim</code>
if applicable).</p>
</td></tr>
<tr><td><code id="bubbleHMLegends_+3A_colorseq">colorSeq</code></td>
<td>
<p>Character vector of colors to be used in creating color
scale.</p>
</td></tr>
<tr><td><code id="bubbleHMLegends_+3A_unitbase">unitBase</code></td>
<td>
<p><code><a href="grid.html#topic+unit">unit</a></code> object indicating the size of one
plot grid box.</p>
</td></tr>
<tr><td><code id="bubbleHMLegends_+3A_diameter">diameter</code></td>
<td>
<p>Maximum diameter of bubbles as multiple of unitBase.</p>
</td></tr>
<tr><td><code id="bubbleHMLegends_+3A_context">context</code></td>
<td>
<p><code><a href="grid.html#topic+gpar">gpar</a></code> object to provide drawing context.
Will be applied to the parent viewport in the childrenvp slot of the gTree.</p>
</td></tr>
<tr><td><code id="bubbleHMLegends_+3A_legendheight">legendHeight</code></td>
<td>
<p>Numeric, preferred height of legends in multiples of
<code>unitBase</code>. This will be supplied to  <code><a href="base.html#topic+pretty">pretty</a></code>
function. If sizeBreaks vector is supplied then this will be ignored and
legend height will be <code>length(sizeBreaks)</code>.</p>
</td></tr>
<tr><td><code id="bubbleHMLegends_+3A_legendtitles">legendTitles</code></td>
<td>
<p>Character vector of legend titles. First string should be
the size legend title, second for the color legend.</p>
</td></tr>
<tr><td><code id="bubbleHMLegends_+3A_showcolorlegend">showColorLegend</code>, <code id="bubbleHMLegends_+3A_showbubblelegend">showBubbleLegend</code></td>
<td>
<p>Should plot include legends for color
scale/bubble size?</p>
</td></tr>
<tr><td><code id="bubbleHMLegends_+3A_name">name</code></td>
<td>
<p>character string naming the gTree containing the function output.</p>
</td></tr>
<tr><td><code id="bubbleHMLegends_+3A_orientation">orientation</code></td>
<td>
<p>one of &quot;horizontal&quot; or &quot;vertical&quot;, (default horizontal)
indicating whether legends should be arranged stacked or side by side.
Ignored if only one legend is required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="grid.html#topic+gTree">gTree</a></code> object representing the bubbleHeatmap
legends requested by the showBubbleLegend and showColorLegend parameters.
</p>


<h3>See Also</h3>

<p>Other build functions: 
<code><a href="#topic+bubbleHeatmapList">bubbleHeatmapList</a>()</code>,
<code><a href="#topic+bubbleHeatmap">bubbleHeatmap</a>()</code>,
<code><a href="#topic+multiPlotInput">multiPlotInput</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>legends &lt;- bubbleHMLegends(
  sizeBreaks = seq(0, 80, 10), colorBreaks = seq(-2, 2, 0.5), diameter = 0.8,
  context = gpar(cex = 0.8), colorSeq = c("#053061", "#2166AC", "#4393C3", "#92C5DE", "#D1E5F0",
  "#FDDBC7", "#F4A582", "#D6604D", "#B2182B", "#67001F"), unitBase = unit(0.5, "cm"),
  legendHeight = 9, legendTitles = c("Estimate", "NegLog10P"))
grid.draw(legends)
</code></pre>

<hr>
<h2 id='cetp'>Associations of Nightingale Health Metabolomics Panel with a Cholesterol
Esterase Transfer Protein Genetic Risk Score in China Kadoorie Biobank</h2><span id='topic+cetp'></span>

<h3>Description</h3>

<p>Example dataset containing association results of the 225 Nightingale
metabolomics traits with a CETP Genetic Risk Score, scaled to 10-mg/dL
higher levels of HDL-C.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cetp
</code></pre>


<h3>Format</h3>

<p>Data frame with 225 rows and 5 variables
</p>

<dl>
<dt>trait</dt><dd><p>trait identifier as used in China Kadoorie Biobank, can be
used to merge results with ntngale template datasets</p>
</dd>
<dt>estimate</dt><dd><p>association beta</p>
</dd>
<dt>stdErr</dt><dd><p>standard error of association estimate</p>
</dd>
<dt>pval</dt><dd><p>p-value of association</p>
</dd>
<dt>negLog10P</dt><dd><p>-log10(pval)</p>
</dd>
</dl>



<h3>Details</h3>

<p>The sample data included in this package represents associations between Nightingale
metabolic measures and a genetic risk score (GRS) for Cholesterol Ester Transfer
Protein (CETP) in the China Kadoorie Biobank (CKB), a prospective study of
Chinese adults from 10 distinct areas of China. The full design of the CKB
cohort and the methods and results of this study have been previously published.
</p>
<p>CETP transfers esterified cholesterol from HDL to apolipoprotein B-containing
lipoproteins in exchange for triglycerides. This process is a key component of
the atheroprotective reverse cholesterol transport pathway, which modulates the
return of excess cholesterol from peripheral cells such as macrophages to the
liver, where it can be redistributed or excreted. Reduced CETP activity results
in higher levels of HDL cholesterol (HDL-C), which has resulted in interest in
CETP as a drug target due to the inverse correlation between HDL-C and risk of
atherosclerotic disease. In this analysis, five CETP SNP variants were selected
on the basis of previously reported associations with HDL cholesterol and CETP
activity. Genotyping data for these variants and conventional lipid biochemistry
measures were available for a subset of 17,854 CKB participants selected for a
CVD case-control study. This data was used to generate a CETP GRS weighted by
HDL-C association, derived internally with 100-fold cross-validation. The
Nightingale Health metabolomics panel consisting of 225 metabolomics measures
was available for 4657 of these individuals, and association with the GRS was
assessed by linear regression with adjustment for age and sex, stratified by
geographical region. In generation of the GRS and association of metabolomics,
outcomes were standardized by rank inverse normal transformation, stratified by
region, after adjustment for age and sex.
</p>


<h3>Source</h3>

<p>Millwood IY, Bennett DA, Holmes MV et al. Association of CETP Gene
Variants With Risk for Vascular and Nonvascular Diseases Among Chinese
Adults. JAMA Cardiol. 2018 Jan 1;3(1):34-43.
</p>

<hr>
<h2 id='combinePanels'>Combine Multiple Panels In A New gTree.</h2><span id='topic+combinePanels'></span>

<h3>Description</h3>

<p>The combinePanels function creates a new gTree containing a viewport with a
grid layout, and arranges multiple panels (created with the
<code><a href="#topic+arrangePanels">arrangePanels</a></code> function) within that grid. The new layout is
filled by rows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combinePanels(
  name,
  panels,
  nrow,
  ncol,
  spacer = unit(0, "cm"),
  margin = unit(0, "cm"),
  just = c(0.5, 0.5)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combinePanels_+3A_name">name</code></td>
<td>
<p>Character string naming the new tree and viewport (viewport will
have suffix &quot;VP&quot;)</p>
</td></tr>
<tr><td><code id="combinePanels_+3A_panels">panels</code></td>
<td>
<p>Panels to be arranged in the new tree</p>
</td></tr>
<tr><td><code id="combinePanels_+3A_nrow">nrow</code></td>
<td>
<p>Numeric, number of rows in the new layout</p>
</td></tr>
<tr><td><code id="combinePanels_+3A_ncol">ncol</code></td>
<td>
<p>Numeric, number of columns in the new layout</p>
</td></tr>
<tr><td><code id="combinePanels_+3A_spacer">spacer</code></td>
<td>
<p>Grid <code><a href="grid.html#topic+unit">unit</a></code> object specifying size of space
left between panels.</p>
</td></tr>
<tr><td><code id="combinePanels_+3A_margin">margin</code></td>
<td>
<p>Grid <code><a href="grid.html#topic+unit">unit</a></code> object specifying size of margin
around tree.</p>
</td></tr>
<tr><td><code id="combinePanels_+3A_just">just</code></td>
<td>
<p>Numeric or character vector specifying justification of panel
viewports within new tree viewport layout cells.
See <code><a href="grid.html#topic+viewport">viewport</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>New <code><a href="grid.html#topic+gTree">gTree</a></code> object with children slot containing
all trees in the grobLists of input panels, and a childrenvp slot containing
all viewports in input panels arranged within a new parent viewport layout.
</p>

<hr>
<h2 id='formatData'>Split Data Into Matrices and Reorder Rows and Columns.</h2><span id='topic+formatData'></span>

<h3>Description</h3>

<p>Prepare data variables for plot building by splitting into matrices and
ordering rows and columns. Includes pre-defined settings for plotting
Nightingale metabolomics data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatData(
  data,
  rowName = "rowName",
  colName = "colName",
  plotGroup = "plotGroup",
  colorValue = "colorValue",
  sizeValue = "sizeValue",
  rowOrder = NULL,
  colOrder = NULL,
  listOrder = NULL,
  nightingale = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formatData_+3A_data">data</code></td>
<td>
<p>Dataset containing variables to be plotted on color and size
scales with additional matrix layout specification variables
(see details).</p>
</td></tr>
<tr><td><code id="formatData_+3A_rowname">rowName</code></td>
<td>
<p>String naming the variable of <code>data</code> which defines rows
of each matrix.</p>
</td></tr>
<tr><td><code id="formatData_+3A_colname">colName</code></td>
<td>
<p>String naming the variable of <code>data</code> which defines
columns of each matrix.</p>
</td></tr>
<tr><td><code id="formatData_+3A_plotgroup">plotGroup</code></td>
<td>
<p>String naming the variable of <code>data</code> which groups the
dataset into plots.</p>
</td></tr>
<tr><td><code id="formatData_+3A_colorvalue">colorValue</code></td>
<td>
<p>String naming the variable of <code>data</code> containing the
values to be plotted on the color scale.</p>
</td></tr>
<tr><td><code id="formatData_+3A_sizevalue">sizeValue</code></td>
<td>
<p>String naming the variable of <code>data</code> containing the
values to scale bubble sizes.</p>
</td></tr>
<tr><td><code id="formatData_+3A_roworder">rowOrder</code></td>
<td>
<p>List of vectors of character strings matching the values of
<code>rowName</code> for each plot. List names should match values of
<code>plotGroup</code>. Can be <code>NULL</code> (default) if no sorting required or
when using inbuilt Nightingale ordering. If used, it is not necessary for
all plots to have list entries, but each entry should include all row
names for that plot.</p>
</td></tr>
<tr><td><code id="formatData_+3A_colorder">colOrder</code></td>
<td>
<p>As <code>rowOrder</code> for columns and <code>colName</code>.</p>
</td></tr>
<tr><td><code id="formatData_+3A_listorder">listOrder</code></td>
<td>
<p>Vector of character strings matching values of
<code>plotGroup</code> variable, or <code>NULL</code> (default) if no sorting
required or when using inbuilt Nightingale ordering.</p>
</td></tr>
<tr><td><code id="formatData_+3A_nightingale">nightingale</code></td>
<td>
<p>Logical - use Nightingale style settings?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes an input dataset with one row for each plot cell
and splits it into a list of plot datasets as defined by the variable
<code>plotGroup</code>. Each plot dataset is then recast (using the
<code>cast()</code> function from the <code>reshape</code> package) into matrices defined
by the <code>colName</code> and <code>rowName</code> variables. Two matrices are produced
for each plot, containing the values of <code>colorValue</code> and
<code>sizeValue</code> respectively. To use the included Nightingale metabolomics
plot templates, the <code>rowName</code>, <code>colName</code> and <code>plotGroup</code>
variables can be merged from the options in the package datafiles
<code>ntngale225/249</code>.
</p>


<h3>Value</h3>

<p>A list of two lists of numeric matrices. The matrices in
<code>colorList</code> contain values of <code>data$colorValue</code> and those in
<code>sizeList</code> contain values of <code>data$sizeValue</code>. The matrice layouts
are defined by <code>data$rowName</code> and <code>data$colName</code> and each list has
one item for each unique value of <code>data$plotGroup</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- merge_template(cetp, "ckb_id")
formatData(data, colorValue = "estimate", sizeValue = "negLog10P",
nightingale = TRUE)
</code></pre>

<hr>
<h2 id='getLayoutSizes'>Recalculate Layout Sizes for bubbleHeatmap gTree</h2><span id='topic+getLayoutSizes'></span>

<h3>Description</h3>

<p>This function recalculates the viewport layout dimensions for a bubbleHeatmap
tree based on the sizes of the children grobs, and returns the updated tree.
This is useful for matching widths exactly to grob dimensions in an updated
drawing context, and for resetting any previous layout modifications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLayoutSizes(tree, unitBase)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLayoutSizes_+3A_tree">tree</code></td>
<td>
<p>A bubbleHeatmap <code><a href="grid.html#topic+gTree">gTree</a></code>.</p>
</td></tr>
<tr><td><code id="getLayoutSizes_+3A_unitbase">unitBase</code></td>
<td>
<p>The unitBase parameter used when the tree was created.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input bubbleHeatmap <code><a href="grid.html#topic+gTree">gTree</a></code> with viewport
dimensions matched to the size of the children grobs.
</p>

<hr>
<h2 id='matchLayoutHeights'>Match Viewport Layout Dimensions.</h2><span id='topic+matchLayoutHeights'></span><span id='topic+matchLayoutWidths'></span>

<h3>Description</h3>

<p>Align the dimensions of the viewport layouts in a list of bubbleHeatmap
gTrees. The maximum height/width of a given row/column in any input tree will
be applied that row/column for all trees in the list. This enables the plots
to be aligned in mult-plot figure layouts, for example the &quot;TopLabels&quot;
element can be given the same height in two plots that are to be positioned
side by side.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matchLayoutHeights(x, r1 = 1, r2 = 5)

matchLayoutWidths(x, c1 = 1, c2 = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matchLayoutHeights_+3A_x">x</code></td>
<td>
<p>A list of bubbleHeatmap trees</p>
</td></tr>
<tr><td><code id="matchLayoutHeights_+3A_r1">r1</code>, <code id="matchLayoutHeights_+3A_r2">r2</code></td>
<td>
<p>Numeric between 1 and 6, the first (r1) and last (r2) viewport
layout rows to be aligned.</p>
</td></tr>
<tr><td><code id="matchLayoutHeights_+3A_c1">c1</code>, <code id="matchLayoutHeights_+3A_c2">c2</code></td>
<td>
<p>Numeric between 1 and 9, the first (c1) and last (c2) viewport
layout columns to be aligned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input list of bubbleHeatmap trees modified so that the maximum
height/width of a given row/column in any input tree is applied to that
row/column for all trees in the list, for the rows/columns specified by the
r/c parameters.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>matchLayoutHeights()</code>: Align layout row heights across multiple
bubbleHeatmap trees.
</p>
</li>
<li> <p><code>matchLayoutWidths()</code>: Align layout column widths across multiple
bubbleHeatmap trees.
</p>
</li></ul>

<hr>
<h2 id='merge_template'>Merge Nightingale Figure Templates with User Data</h2><span id='topic+merge_template'></span>

<h3>Description</h3>

<p>Custom merge function to help users align their data with the template
datasets containing the variable location information for the Nightingale
figures. User datasets should contain the variables representing bubble color
and size, and a key column to merge rows with the template. The key column
should either be named &quot;ukbb_id&quot; and contain the UK Biobank Field ID for each
variable (e.g. &quot;23474&quot;) or named &quot;ckb_id&quot; and contain the China Kadoorie
Biobank variable ID, (e.g. &quot;nmr_bohbut&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_template(data, id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge_template_+3A_data">data</code></td>
<td>
<p>User dataset</p>
</td></tr>
<tr><td><code id="merge_template_+3A_id">id</code></td>
<td>
<p>Name of key column, either &quot;ukbb_id&quot; or &quot;ckb_id&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Merged dataset
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- merge_template(cetp, "ckb_id")
</code></pre>

<hr>
<h2 id='metabFigure'>Create Nightingale Figure From Template</h2><span id='topic+metabFigure'></span>

<h3>Description</h3>

<p>Produce a single <code><a href="grid.html#topic+gTree">gTree</a></code> object representing plots arranged
according to the provided Nightingale metabolomics figure template.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metabFigure(
  data,
  colorValue = "estimate",
  sizeValue = "negLog10P",
  legendHeight = 8,
  context = gpar(cex = 0.8),
  unitBase = unit(0.5, "cm"),
  colorLim = c(NA, NA),
  sizeLim = c(NA, NA)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metabFigure_+3A_data">data</code></td>
<td>
<p>Nightingale results data merged with the ntngale225 or ntngale249
template.</p>
</td></tr>
<tr><td><code id="metabFigure_+3A_colorvalue">colorValue</code></td>
<td>
<p>String naming the variable of <code>data</code> containing the
values to be plotted on the color scale.</p>
</td></tr>
<tr><td><code id="metabFigure_+3A_sizevalue">sizeValue</code></td>
<td>
<p>String naming the variable of <code>data</code> containing the
values to scale bubble sizes.</p>
</td></tr>
<tr><td><code id="metabFigure_+3A_legendheight">legendHeight</code></td>
<td>
<p>Numeric, preferred height of legends in multiples of
0.5cm. This will be supplied to pretty function.</p>
</td></tr>
<tr><td><code id="metabFigure_+3A_context">context</code></td>
<td>
<p><code><a href="grid.html#topic+gpar">gpar</a></code> object to provide drawing context.
Will be applied to the parent viewport in the childrenvp slot of the gTree.</p>
</td></tr>
<tr><td><code id="metabFigure_+3A_unitbase">unitBase</code></td>
<td>
<p><code><a href="grid.html#topic+unit">unit</a></code> object indicating the size of one
plot grid box.</p>
</td></tr>
<tr><td><code id="metabFigure_+3A_colorlim">colorLim</code>, <code id="metabFigure_+3A_sizelim">sizeLim</code></td>
<td>
<p>Numeric vectors indicating limits (min/max) outside
which the values of color/size matrices should be truncated. NOTE! These
data ranges are separate from the scale ranges, which are taken from the
min/max values of <code>colorBreaks</code> and <code>sizeBreaks</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Quick function to produce a final Nightingale figure from results data merged
with one of the supplied template datasets. This function wraps the functions
<code><a href="#topic+formatData">formatData</a></code>, <code><a href="#topic+multiPlotInput">multiPlotInput</a></code>,
<code><a href="#topic+bubbleHeatmapList">bubbleHeatmapList</a></code> and <code><a href="#topic+metabFigurePlot">metabFigurePlot</a></code> applying
default settings.
</p>


<h3>Value</h3>

<p>Produces a complete metabolomics figure consisting of 14
bubbleHeatmap blocks in a pre-set layout. Output is not drawn but returned as
a <code><a href="grid.html#topic+gTree">gTree</a></code> object which can be edited or drawn using
the <code><a href="grid.html#topic+grid.draw">grid.draw</a></code> function. NOTE: A cairo output device with
gradient support is necessary to correctly render the color legend.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myData &lt;- merge_template(cetp, "ckb_id")
metabTree &lt;- metabFigure(myData)
grid.draw(metabTree)

</code></pre>

<hr>
<h2 id='metabFigurePlot'>Arrange List of bubbleHeatmap Plots According to Preset Nightingale Template.</h2><span id='topic+metabFigurePlot'></span>

<h3>Description</h3>

<p>Produce a single <code><a href="grid.html#topic+gTree">gTree</a></code> object representing plots arranged
according to the provided Nightingale metabolomics figure template.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metabFigurePlot(treeList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metabFigurePlot_+3A_treelist">treeList</code></td>
<td>
<p>List of bubbleHeatmap trees. This function expects a treeList
of particular length, containing trees with specified names and dimensions.
The easiest way to generate this is via the <code><a href="#topic+formatData">formatData</a></code>,
<code><a href="#topic+multiPlotInput">multiPlotInput</a></code> and <code><a href="#topic+bubbleHeatmapList">bubbleHeatmapList</a></code> functions.
See vignette for full details of this workflow.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="grid.html#topic+gTree">gTree</a></code> object representing the input
bubblehHeatmaps arranged into a Nightingale metabolomics figure.
</p>

<hr>
<h2 id='multiPlotInput'>Arrange bubbleHeatmap Arguments in Lists for Building Multiple Plots.</h2><span id='topic+multiPlotInput'></span>

<h3>Description</h3>

<p>Build bubbleHeatmap arguments into a list of lists to facilitate building of
multiple plots in a single call. It is useful for creating sets of plots with
the same data scales, similar plots with minor differences in settings, or
the supplied Nightingale plot template.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiPlotInput(
  colorList,
  sizeList = colorList,
  nightingale = TRUE,
  treeNames = names(colorList),
  context = gpar(cex = 0.8),
  colorSeq = c("#053061", "#2166AC", "#4393C3", "#92C5DE", "#D1E5F0", "#FDDBC7",
    "#F4A582", "#D6604D", "#B2182B", "#67001F"),
  unitBase = unit(0.5, "cm"),
  diameter = 0.8,
  colorLim = c(NA, NA),
  sizeLim = c(NA, NA),
  showTopLabels = TRUE,
  showLeftLabels = TRUE,
  leftLabelsTitles = FALSE,
  showRowBracket = FALSE,
  rowTitles = FALSE,
  showColBracket = FALSE,
  colTitles = FALSE,
  plotTitles = FALSE,
  xTitles = FALSE,
  yTitles = FALSE,
  showColorLegend = TRUE,
  showBubbleLegend = TRUE,
  colorBreaks = NULL,
  sizeBreaks = NULL,
  legendHeight = nrow(colorList[[1]]),
  legendTitles = c(expression("-log"[10] * "P"), "Estimate (SD)")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multiPlotInput_+3A_colorlist">colorList</code>, <code id="multiPlotInput_+3A_sizelist">sizeList</code></td>
<td>
<p>List of matrices, each item representing one plot,
containing values to be plotted as the bubble color and size respectively. If
<code>sizeList</code> is not supplied then color values will also be used for size.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_nightingale">nightingale</code></td>
<td>
<p>Logical, apply Nightingale style template?</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_treenames">treeNames</code></td>
<td>
<p>Vector of names for gTrees output by bubbleHeatmap, if not
supplied then <code>names(colorList)</code> will be used.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_context">context</code></td>
<td>
<p><code><a href="grid.html#topic+gpar">gpar</a></code> object to provide drawing context.
Will be applied to the parent viewport in the childrenvp slot of gTrees
output by bubbleHeatmap.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_colorseq">colorSeq</code></td>
<td>
<p>Vector of colors to distribute over color scale gradient.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_unitbase">unitBase</code></td>
<td>
<p><code><a href="grid.html#topic+unit">unit</a></code> object indicating the size of one
plot grid square.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_diameter">diameter</code></td>
<td>
<p>Maximum diameter of bubbles as multiple of unitBase.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_colorlim">colorLim</code>, <code id="multiPlotInput_+3A_sizelim">sizeLim</code></td>
<td>
<p>Numeric vectors indicating limits (min/max) beyond
which the values of color/size matrices should be truncated.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_showtoplabels">showTopLabels</code></td>
<td>
<p>Logical vector, should matrix column names be printed
above each plot? Should have <code>length == length(colorList)</code> or
<code>length == 1</code> to use same value for all plots.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_showleftlabels">showLeftLabels</code></td>
<td>
<p>Logical vector, should matrix row names be printed
above each plot? Should have <code>length == length(colorList)</code> or
<code>length == 1</code> to use same value for all plots.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_leftlabelstitles">leftLabelsTitles</code></td>
<td>
<p>Vector of headings to go over the row names of each
plot. Character strings or FALSE for no title. A single FALSE value can also
be used if no left label titles are required.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_showrowbracket">showRowBracket</code></td>
<td>
<p>Logical vector, should vertical bracket be printed to
the right of each plot (to label a row of plots in a final figure layout)?
Should have <code>length == length(colorList)</code> or <code>length == 1</code> to use
same value for all plots.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_rowtitles">rowTitles</code></td>
<td>
<p>Vector of labels to be printed to the right of each plot,
outside row bracket if present (to label a row of plots in a final figure
layout). Character strings or FALSE for no title. A single FALSE value
can also be used if no row titles are required.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_showcolbracket">showColBracket</code></td>
<td>
<p>Logical vector, should horizontal bracket be printed
below each plot (to label a column of plots in a final figure layout)?
Should have <code>length == length(colorList)</code> or <code>length == 1</code> to use
same value for all plots.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_coltitles">colTitles</code></td>
<td>
<p>Vector of labels to be printed to the right of each plot,
outside col bracket if present (to label a column of plots in a final figure
layout). Character strings or FALSE for no title. A single FALSE value can
also be used if no column titles are required.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_plottitles">plotTitles</code></td>
<td>
<p>Vector of plot titles to be centered above each plot.
Character strings or FALSE for no title. A single FALSE value can also be
used if no plot titles are required.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_xtitles">xTitles</code></td>
<td>
<p>Vector of x axis titles to be printed left of
<code>LeftLabels</code>. Character strings or FALSE for no title. A single FALSE
value can also be used if no x axis titles are required.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_ytitles">yTitles</code></td>
<td>
<p>Vector of y axis titles to be printed above <code>TopLabels</code>.
Character strings or FALSE for no title. A single FALSE value can also be
used if no y axis titles are required.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_showcolorlegend">showColorLegend</code>, <code id="multiPlotInput_+3A_showbubblelegend">showBubbleLegend</code></td>
<td>
<p>Logicals, should a legend be produced
for color scale/bubble size? If vector with <code>length == length(colorList)</code>
then values will be input for each plot and any legends produced will be an
element of a plot tree. A single TRUE value will build the legends outside
the plots as separate trees.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_colorbreaks">colorBreaks</code>, <code id="multiPlotInput_+3A_sizebreaks">sizeBreaks</code></td>
<td>
<p>Character vectors of legend tick labels. If not
supplied then these will be generated using pretty to a range outside data
values (after values truncated to <code>colorLim</code>\<code>sizeLim</code> if
applicable).</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_legendheight">legendHeight</code></td>
<td>
<p>Numeric, preferred height of legends as multiple of
<code>unitBase</code>. This will be supplied to pretty function. If sizeBreaks is
supplied then this will be ignored and legend height will be
<code>length(sizeBreaks)</code>.</p>
</td></tr>
<tr><td><code id="multiPlotInput_+3A_legendtitles">legendTitles</code></td>
<td>
<p>Character vector of legend titles. First string should be
the size legend title, second for the color legend.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with two elements:
</p>

<dl>
<dt>trees</dt><dd><p>List of lists, arguments for <code>bubbleHeatmap</code></p>
</dd>
<dt>legend</dt><dd><p>List of arguments for <code>bubbleHMLegends</code></p>
</dd></dl>

<p>The list returned by this plot can be passed directly to
<code><a href="#topic+bubbleHeatmapList">bubbleHeatmapList</a></code> to produce a list of plot trees.
</p>


<h3>Nightingale</h3>

<p>For more information about using the Nightingale style template, see the
vignette. Requesting Nightingale style values overrides any argument for
plotTitles, xTitles, yTitles, showTopLabels, showLeftLabels,
leftLabelsTitles, showRowBracket, rowTitles, showColBracket, colTitles,
showBubbleLegend or showColorLegend.
</p>


<h3>See Also</h3>

<p>Other build functions: 
<code><a href="#topic+bubbleHMLegends">bubbleHMLegends</a>()</code>,
<code><a href="#topic+bubbleHeatmapList">bubbleHeatmapList</a>()</code>,
<code><a href="#topic+bubbleHeatmap">bubbleHeatmap</a>()</code>
</p>

<hr>
<h2 id='nightingaleTemplates'>Nightingale Health Metabolomics Plot Template Format</h2><span id='topic+nightingaleTemplates'></span><span id='topic+ntngale225'></span><span id='topic+ntngale249'></span>

<h3>Description</h3>

<p>Template datasets containing grouping and labeling variables to
information to plot 225 or 249 variable Nightingale Health metabolomics data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ntngale225

ntngale249
</code></pre>


<h3>Format</h3>

<p>Data frame with 228/249 rows and 5 variables
</p>

<dl>
<dt>trait</dt><dd><p>trait identifier as used in China Kadoorie Biobank, can be
used to merge template with results data</p>
</dd>
<dt>traitTitle</dt><dd><p>trait description to assist with merging results</p>
</dd>
<dt>rowName</dt><dd><p>row label for trait in plot matrix</p>
</dd>
<dt>colName</dt><dd><p>column label for trait in plot matrix</p>
</dd>
<dt>plotGroup</dt><dd><p>this variable splits the traits into 10 plot matrices that
make up the overall figure</p>
</dd>
</dl>

<p>An object of class <code>data.frame</code> with 249 rows and 6 columns.
</p>


<h3>Details</h3>

<p>Nightingale Health is a Finnish company which has developed a fully
automated platform for deriving over 200 quantitative metabolomics measures
from a single blood serum sample using NMR technology, at a comparable cost
to standard lipid clinical chemistry. These measures include concentration
and composition of 14 lipoprotein subclasses, apolipoproteins, fatty acids,
amino acids and glycolysis related metabolites. Over 1M samples have already
been processed, including biobank participants, population cohorts and
clinical studies, with capacity to process an additional 250K samples per
year. Over 100K profiles of UK Biobank participants have recently been
released, with data on the remaining individuals to follow. The wide
availability of standardised Nightingale datasets in global cohorts
facilitates collaborative research and is contributing to the identification
of new biomarkers across a range of diseases.
</p>

<hr>
<h2 id='widthDetails.bubbleHeatmap'>Methods for determining the width/height of bubbleHeatmap plots and legends.</h2><span id='topic+widthDetails.bubbleHeatmap'></span><span id='topic+widthDetails.bubbleLegend'></span><span id='topic+widthDetails.colorLegend'></span><span id='topic+heightDetails.bubbleHeatmap'></span><span id='topic+heightDetails.bubbleLegend'></span><span id='topic+heightDetails.colorLegend'></span>

<h3>Description</h3>

<p>Methods for determining the width/height of bubbleHeatmap plots and legends.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bubbleHeatmap'
widthDetails(x)

## S3 method for class 'bubbleLegend'
widthDetails(x)

## S3 method for class 'colorLegend'
widthDetails(x)

## S3 method for class 'bubbleHeatmap'
heightDetails(x)

## S3 method for class 'bubbleLegend'
heightDetails(x)

## S3 method for class 'colorLegend'
heightDetails(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="widthDetails.bubbleHeatmap_+3A_x">x</code></td>
<td>
<p>A bubbleHeatmap, bubbleLegend, or colorLegend object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Grid <code><a href="grid.html#topic+unit">unit</a></code> object representing object width or height.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>widthDetails(bubbleHeatmap)</code>: Get width of bubbleHeatmap
</p>
</li>
<li> <p><code>widthDetails(bubbleLegend)</code>: Get width of bubbleLegend
</p>
</li>
<li> <p><code>widthDetails(colorLegend)</code>: Get width of colorLegend
</p>
</li>
<li> <p><code>heightDetails(bubbleHeatmap)</code>: Get height of bubbleHeatmap
</p>
</li>
<li> <p><code>heightDetails(bubbleLegend)</code>: Get height of bubbleLegend
</p>
</li>
<li> <p><code>heightDetails(colorLegend)</code>: Get height of colorLegend
</p>
</li></ul>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
