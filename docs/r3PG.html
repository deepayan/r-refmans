<!DOCTYPE html><html lang="en"><head><title>Help for package r3PG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {r3PG}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#r3PG'><p>Simulating Forest Growth using the 3-PG Process-Based Vegetation Model</p></a></li>
<li><a href='#d_climate'><p>Climate input</p></a></li>
<li><a href='#d_parameters'><p>Parameters input</p></a></li>
<li><a href='#d_site'><p>Site input</p></a></li>
<li><a href='#d_sizeDist'><p>sizeDist input</p></a></li>
<li><a href='#d_species'><p>Species input</p></a></li>
<li><a href='#d_thinning'><p>Thinning input</p></a></li>
<li><a href='#get_parameters'><p>Get parameter sets</p></a></li>
<li><a href='#i_output'><p>Information about model outputs</p></a></li>
<li><a href='#i_parameters'><p>Information about parameters</p></a></li>
<li><a href='#i_parameters_lit'><p>Information about literature parameters</p></a></li>
<li><a href='#i_sizeDist'><p>Information about size distribution parameters</p></a></li>
<li><a href='#prepare_climate'><p>Subsets or replicate a climate data</p></a></li>
<li><a href='#prepare_input'><p>Check and prepare input for running 3-PG model</p></a></li>
<li><a href='#prepare_parameters'><p>Prepare parameters table</p></a></li>
<li><a href='#prepare_site'><p>Check the site data for consistency</p></a></li>
<li><a href='#prepare_sizeDist'><p>Prepare parameters table</p></a></li>
<li><a href='#prepare_species'><p>Check the species data for consistency</p></a></li>
<li><a href='#prepare_thinning'><p>Check and prepare management information.</p></a></li>
<li><a href='#run_3PG'><p>Runs a 3-PG model simulation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulating Forest Growth using the 3-PG Model</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a flexible and easy-to-use interface for the Physiological Processes Predicting Growth (3-PG) model written in Fortran. The r3PG serves as a flexible and easy-to-use interface for the 3-PGpjs (monospecific, evenaged and evergreen forests) described in Landsberg &amp; Waring (1997) &lt;<a href="https://doi.org/10.1016%2FS0378-1127%2897%2900026-1">doi:10.1016/S0378-1127(97)00026-1</a>&gt; and the 3-PGmix (deciduous, uneven-aged or mixed-species forests) described in Forrester &amp; Tang (2016) &lt;<a href="https://doi.org/10.1016%2Fj.ecolmodel.2015.07.010">doi:10.1016/j.ecolmodel.2015.07.010</a>&gt;.</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-18</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.6</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.15.1), rmarkdown (&ge; 1.3), R.rsp (&ge; 0.40.0),
testthat (&ge; 1.0.2), roxygen2, BayesianTools, sensitivity,
dplyr, ggplot2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/trotsiuk/r3PG">https://github.com/trotsiuk/r3PG</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/trotsiuk/r3PG/issues">https://github.com/trotsiuk/r3PG/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-19 08:09:36 UTC; trotsiuk</td>
</tr>
<tr>
<td>Author:</td>
<td>Volodymyr Trotsiuk
    <a href="https://orcid.org/0000-0002-8363-656X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Florian Hartig <a href="https://orcid.org/0000-0002-6255-9059"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  David Forrester [aut],
  Ramiro Silveyra Gonzalez
    <a href="https://orcid.org/0000-0002-3430-8383"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Volodymyr Trotsiuk &lt;volodymyr.trotsiuk@wsl.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-19 08:50:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='r3PG'>Simulating Forest Growth using the 3-PG Process-Based Vegetation Model</h2><span id='topic+r3PG'></span><span id='topic+r3PG-package'></span>

<h3>Description</h3>

<p>The r3PG package provides a flexible and easy-to-use interface for Fortran implementations of the 3-PGpjs (monospecific, evenaged and evergreen forests) or 3-PGmix (deciduous, uneven-aged or mixed-species forests) forest growth models. The user can flexibly switch between various options and submodules, to use the original 3-PGpjs model version for monospecific, even-aged and evergreen forests and the 3-PGmix model, which can also simulate multi-cohort stands (e.g. mixtures, uneven-aged) that contain deciduous species. The core function to run the model is <code><a href="#topic+run_3PG">run_3PG</a></code>. For more background, please consult the vignette via vignette(package = &quot;r3PG&quot;)
</p>


<h3>Value</h3>

<p>None
</p>


<h3>References</h3>

<p>Forrester, D. I., 2020. 3-PG User Manual. Swiss Federal Institute for Forest, Snow and Landscape Research WSL, Birmensdorf, Switzerland. 70 p. Available at the following web site: <a href="http://sites.google.com/site/davidforresterssite/home/projects/3PGmix/3pgmixdownload">http://sites.google.com/site/davidforresterssite/home/projects/3PGmix/3pgmixdownload</a>
</p>
<p>Forrester, D. I., &amp; Tang, X. (2016). Analysing the spatial and temporal dynamics of species interactions in mixed-species forests and the effects of stand density using the 3-PG model. Ecological Modelling, 319, 233–254. <a href="https://doi.org/10.1016/j.ecolmodel.2015.07.010">doi:10.1016/j.ecolmodel.2015.07.010</a>
</p>
<p>Landsberg, J. J., &amp; Waring, R. H., 1997. A generalised model of forest productivity using simplified concepts of radiation-use efficiency, carbon balance and partitioning. Forest Ecology and Management, 95(3), 209–228. <a href="https://doi.org/10.1016/S0378-1127%2897%2900026-1">doi:10.1016/S0378-1127(97)00026-1</a>
</p>
<p>Sands, P. J., 2010. 3PGpjs user manual. Available at the following web site: <a href="https://3pg.sites.olt.ubc.ca/files/2014/04/3PGpjs_UserManual.pdf">https://3pg.sites.olt.ubc.ca/files/2014/04/3PGpjs_UserManual.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_3PG">run_3PG</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>out &lt;- run_3PG(
  site = d_site,
  species = d_species,
  climate = d_climate,
  thinning = d_thinning,
  parameters = d_parameters,
  size_dist = d_sizeDist,
  settings = list(light_model = 2, transp_model = 2, phys_model = 2,
                  correct_bias = 1, calculate_d13c = 0),
  check_input = TRUE, df_out = TRUE) # note that default is TRUE

str(out) # List output format
</code></pre>

<hr>
<h2 id='d_climate'>Climate input</h2><span id='topic+d_climate'></span>

<h3>Description</h3>

<p>Table containing the information about monthly values for climatic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_climate
</code></pre>


<h3>Format</h3>

<p>A <code>data frame</code> with 156 rows and 7 variables:
</p>

<dl>
<dt>year</dt><dd><p>calendar year</p>
</dd>
<dt>month</dt><dd><p>month</p>
</dd>
<dt>tmp_min</dt><dd><p>monthly mean daily minimum temperature (C)</p>
</dd>
<dt>tmp_max</dt><dd><p>monthly mean daily maximum temperature (C)</p>
</dd>
<dt>tmp_ave</dt><dd><p>monthly mean daily average temperature (C). (optional)</p>
</dd>
<dt>prcp</dt><dd><p>monthly rainfall (mm month-1)</p>
</dd>
<dt>srad</dt><dd><p>monthly mean daily solar radiation (MJ m-2 d-1)</p>
</dd>
<dt>frost_days</dt><dd><p>frost days per month (d month-1)</p>
</dd>
<dt>co2</dt><dd><p>monthly mean atmospheric co2 (ppm), required if calculate_d13c=1 (optional)</p>
</dd>
<dt>d13catm</dt><dd><p>Monthly mean isotopic composition of air (‰), required if calculate_d13c=1 (optional)</p>
</dd>
</dl>


<hr>
<h2 id='d_parameters'>Parameters input</h2><span id='topic+d_parameters'></span>

<h3>Description</h3>

<p>Table containing the information about parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_parameters
</code></pre>


<h3>Format</h3>

<p>A <code>data frame</code> with 65 rows and x variables:
</p>

<dl>
<dt>parameter</dt><dd><p>name of the parameter, must be consistent in naming with <code><a href="#topic+i_parameters">i_parameters</a></code></p>
</dd>
<dt>Fagus sylvatica</dt><dd><p>parameter values for species 1</p>
</dd>
<dt>Pinus sylvestris</dt><dd><p>parameter values for species 2</p>
</dd>
</dl>


<hr>
<h2 id='d_site'>Site input</h2><span id='topic+d_site'></span>

<h3>Description</h3>

<p>Table containing the information about site conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_site
</code></pre>


<h3>Format</h3>

<p>A <code>data frame</code> with 1 rows and 8 variables:
</p>

<dl>
<dt>latitude</dt><dd><p>site latitude in the WGS84 coordinate system</p>
</dd>
<dt>altitude</dt><dd><p>site altitude, m a.s.l.</p>
</dd>
<dt>soil_class</dt><dd><p> soil class, according to table 2 user manual of 3PGpjs. 1 - Sandy; 2 - Sandy loam; 3 - Clay loam; 4 - Clay; 0 - No effect of available soil water on production</p>
</dd>
<dt>asw_i</dt><dd><p>initial available soil water (mm)</p>
</dd>
<dt>asw_max</dt><dd><p>minimum available soil water (mm)</p>
</dd>
<dt>asw_min</dt><dd><p>maximum available soil water (mm)</p>
</dd>
<dt>from</dt><dd><p>year and month indicating the start of simulation. Provided in form of year-month. E.g. &quot;2000-01&quot;</p>
</dd>
<dt>to</dt><dd><p>year and month indicating the end of simulation. Provided in form of year-month. E.g. &quot;2009-12&quot;, will include December 2009 as last simulation month</p>
</dd>
</dl>


<hr>
<h2 id='d_sizeDist'>sizeDist input</h2><span id='topic+d_sizeDist'></span>

<h3>Description</h3>

<p>Table containing the information about size distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_sizeDist
</code></pre>


<h3>Format</h3>

<p>A data frame with 47 rows and x variables:
</p>

<dl>
<dt>parameter</dt><dd><p>name of the parameter, must be consistent in naming with <code><a href="#topic+i_sizeDist">i_sizeDist</a></code></p>
</dd>
<dt>Fagus sylvatica</dt><dd><p>parameter values for species 1</p>
</dd>
<dt>Pinus sylvestris</dt><dd><p>parameter values for species 2</p>
</dd>
</dl>


<hr>
<h2 id='d_species'>Species input</h2><span id='topic+d_species'></span>

<h3>Description</h3>

<p>Table containing the information about species level data. Each row corresponds to one species/cohort.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_species
</code></pre>


<h3>Format</h3>

<p>A <code>data frame</code> with number of rows corresponding to each species/cohort and 8 variables:
</p>

<dl>
<dt>species</dt><dd><p>species or cohort id/name. It must be consistent with species names in <code><a href="#topic+d_thinning">d_thinning</a></code>, <code><a href="#topic+d_parameters">d_parameters</a></code> and <code><a href="#topic+d_sizeDist">d_sizeDist</a></code> tables.</p>
</dd>
<dt>planted</dt><dd><p>year and month indicating when the species was planted. Provided in form of year-month. E.g. &quot;2000-01&quot;</p>
</dd>
<dt>fertility</dt><dd><p>soil fertility for a given species. Range from 0 to 1</p>
</dd>
<dt>stems_n</dt><dd><p>number of trees per ha</p>
</dd>
<dt>biom_stem</dt><dd><p>stem biomass for a given species  (Mg/ha)</p>
</dd>
<dt>biom_root</dt><dd><p>root biomass for a given species  (Mg/ha)</p>
</dd>
<dt>biom_foliage</dt><dd><p>initial foliage biomass (Mg/ha). If this is a leafless period, provide the spring foliage biomass.</p>
</dd>
</dl>


<hr>
<h2 id='d_thinning'>Thinning input</h2><span id='topic+d_thinning'></span>

<h3>Description</h3>

<p>Table containing the information about thinnings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_thinning
</code></pre>


<h3>Format</h3>

<p>A <code>data frame</code> with 3 rows and 6 variables:
</p>

<dl>
<dt>species</dt><dd><p>species or cohort id/name. It must be consistent with species names in <code><a href="#topic+d_species">d_species</a></code>, <code><a href="#topic+d_parameters">d_parameters</a></code> and <code><a href="#topic+d_sizeDist">d_sizeDist</a></code> tables.</p>
</dd>
<dt>age</dt><dd><p>age when thinning is performed</p>
</dd>
<dt>stems_n</dt><dd><p>number of trees remaining after thinning</p>
</dd>
<dt>stem</dt><dd><p>type of thinning (above/below). Default is 1</p>
</dd>
<dt>root</dt><dd><p>type of thinning (above/below). Default is 1</p>
</dd>
<dt>foliage</dt><dd><p>type of thinning (above/below). Default is 1</p>
</dd>
</dl>


<hr>
<h2 id='get_parameters'>Get parameter sets</h2><span id='topic+get_parameters'></span>

<h3>Description</h3>

<p>Gets parameter sets from published studies with 3PG
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_parameters(mode = "overview", sp_names = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_parameters_+3A_mode">mode</code></td>
<td>
<p>must be one of the following: full, overview, source, comments,
parameters, sizeDist</p>
</td></tr>
<tr><td><code id="get_parameters_+3A_sp_names">sp_names</code></td>
<td>
<p>names of the species. The 'sp_names' must be either a scientific name
(Picea abies). If passing parameters or sizeDist to mode, it also possible
to use a scientific name with a integer, which is the value of parset_id, e.g.
Picea abies 37.
If unsure, consider using first the option <code>mode = overview</code> with <code>sp_names = NULL</code>.
See details below for more information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function access the parameter database stored in the package,
which is named <code><a href="#topic+i_parameters_lit">i_parameters_lit</a></code>, and also accessible without this function.
If <code>mode = overview</code>, a simplified table with
all existing parameter sets will be returned.  A extended version including information
about to the source and remarks can be obtained with <code>mode = comments</code>.
A complete description of the source is returned with <code>mode = source</code>.
The full  version of this table (species,source, comments,
parameters) will be returned if <code>mode = full</code>. Alternatively, with <code>mode = parameters</code>
and <code>mode = sizeDist</code>, it is possible to obtain parameters in the format
required by <code><a href="#topic+run_3PG">run_3PG</a></code>.
</p>
<p>Passing species names with <code>sp_names</code> will selecting from the table
the desired species. Please note that one species might have more than one
available parameter sets, unless species names contain the parset_id value.
Please also note that <code>mode = source</code> is not compatible with <code>sp_names</code>.
</p>
<p>The parameter sets were obtained from published studies. For basic information about this
dataset check in  <code><a href="#topic+i_parameters_lit">i_parameters_lit</a></code>. Relevant information about
the parameter sets and the corresponding studies is provided in the table.
For further information,  please consider checking the original publications.
</p>


<h3>Value</h3>

<p>a data frame with parameter sets for all available species, or only the
requested species, if <code>sp_names</code> is not null.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_3PG">run_3PG</a></code>, <code><a href="#topic+i_parameters_lit">i_parameters_lit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see an overview of the existing parameter sets
get_parameters(mode = 'overview')
get_parameters(mode = 'overview', sp_names = c('Eucalyptus globulus', 'Pinus sylvestris' ) )

# see existing parameter sets and comments
get_parameters(mode = 'comments')
get_parameters(mode = 'comments', sp_names = c('Eucalyptus globulus', 'Pinus sylvestris' ) )

# see parameters and source information
get_parameters(mode = 'source')

# obtain parameter sets in for some species in the format required by run_3PG
get_parameters(mode = 'parameters', sp_names = c('Fagus sylvatica', 'Picea abies'))
get_parameters(mode = 'parameters', sp_names = 'Fagus sylvatica 34' )
get_parameters(mode = 'sizeDist', sp_names = c('Fagus sylvatica 9', 'Picea abies 37'))

# see parameter sets with full information (species, source, parameters)
get_parameters(mode = 'full')
get_parameters(mode = 'full', sp_names = c('Fagus sylvatica', 'Pinus radiata' ) )


</code></pre>

<hr>
<h2 id='i_output'>Information about model outputs</h2><span id='topic+i_output'></span>

<h3>Description</h3>

<p>A dataset containing the list of output variables and their description.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>i_output
</code></pre>


<h3>Format</h3>

<p>A data frame with 150 rows and 7 variables:
</p>

<dl>
<dt>group_id</dt><dd><p>serial number of the group</p>
</dd>
<dt>variable_id</dt><dd><p>serial number of the variable</p>
</dd>
<dt>variable_group</dt><dd><p>group name to which variable belongs</p>
</dd>
<dt>variable_name</dt><dd><p>variable name as named in output</p>
</dd>
<dt>description</dt><dd><p>description of the variable</p>
</dd>
<dt>unit</dt><dd><p>unit of the variable</p>
</dd>
<dt>variable_vba</dt><dd><p>corresponding name of the variable as output from Excel version of 3-PGmix</p>
</dd>
</dl>


<hr>
<h2 id='i_parameters'>Information about parameters</h2><span id='topic+i_parameters'></span>

<h3>Description</h3>

<p>A dataset containing the parameters order and description.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>i_parameters
</code></pre>


<h3>Format</h3>

<p>A data frame with 82 rows and 3 variables:
</p>

<dl>
<dt>parameter</dt><dd><p>parameter name</p>
</dd>
<dt>description</dt><dd><p>description of the parameter</p>
</dd>
<dt>unit</dt><dd><p>unit</p>
</dd>
<dt>default</dt><dd><p>default value for E.globulus from original 3-PG</p>
</dd>
</dl>


<hr>
<h2 id='i_parameters_lit'>Information about literature parameters</h2><span id='topic+i_parameters_lit'></span>

<h3>Description</h3>

<p>A dataset containing parameter sets from published studies with 3PG
</p>


<h3>Usage</h3>

<pre><code class='language-R'>i_parameters_lit
</code></pre>


<h3>Format</h3>

<p>A data frame with 110 rows and  124 variables:
</p>

<dl>
<dt>parset_id</dt><dd><p>id of the parameter set</p>
</dd>
<dt>species</dt><dd><p>species scientific name</p>
</dd>
<dt>age</dt><dd><p>whether the parameter set was was used in even or uneven stands.</p>
</dd>
<dt>type</dt><dd><p>whether the parameter set was used in monocultures or mixed stands.</p>
</dd>
<dt>year</dt><dd><p>year of publication</p>
</dd>
<dt>region</dt><dd><p>geographical region in which the parameters were tested. NAs values are allowed.</p>
</dd>
<dt>country</dt><dd><p>country or countries in which the parameters were tested.</p>
</dd>
<dt>notes</dt><dd><p>any relevant remark about how the parameters were processed. NAs are allowed.</p>
</dd>
<dt>source</dt><dd><p>short reference to publication</p>
</dd>
<dt>source_comments</dt><dd><p>any relevant comment about the parameters present in the publication. NAs are allowed.</p>
</dd>
<dt>source_full</dt><dd><p>full reference to publication</p>
</dd>
<dt>link</dt><dd><p>a link to the publication, e.g. doi</p>
</dd>
<dt>pFS2</dt><dd><p>Foliage:stem partitioning ratio - D = 2 cm</p>
</dd>
<dt>pFS20</dt><dd><p>Foliage:stem partitioning ratio - D = 20 cm</p>
</dd>
<dt>aWS</dt><dd><p>Constant in the stem mass v. diam. relationship</p>
</dd>
<dt>nWS</dt><dd><p>Power in the stem mass v. diam. relationship</p>
</dd>
<dt>pRx</dt><dd><p>Maximum fraction of NPP to roots</p>
</dd>
<dt>pRn</dt><dd><p>Minimum fraction of NPP to roots</p>
</dd>
<dt>gammaF1</dt><dd><p>Maximum litterfall rate</p>
</dd>
<dt>gammaF0</dt><dd><p>Litterfall rate at t = 0</p>
</dd>
<dt>tgammaF</dt><dd><p>Age at which litterfall rate has median value</p>
</dd>
<dt>gammaR</dt><dd><p>Average monthly root turnover rate</p>
</dd>
<dt>leafgrow</dt><dd><p>If deciduous, leaves are produced at end of this month</p>
</dd>
<dt>leaffall</dt><dd><p>If deciduous, leaves all fall at start of this month</p>
</dd>
<dt>Tmin</dt><dd><p>Minimum temperature for growth</p>
</dd>
<dt>Topt</dt><dd><p>Optimum temperature for growth</p>
</dd>
<dt>Tmax</dt><dd><p>Maximum temperature for growth</p>
</dd>
<dt>kF</dt><dd><p>Days production lost per frost day</p>
</dd>
<dt>SWconst</dt><dd><p>Moisture ratio deficit for fq = 0.5</p>
</dd>
<dt>SWpower</dt><dd><p>Power of moisture ratio deficit</p>
</dd>
<dt>fCalpha700</dt><dd><p>Assimilation enhancement factor at 700 ppm</p>
</dd>
<dt>fCg700</dt><dd><p>Canopy conductance enhancement factor at 700 ppm</p>
</dd>
<dt>m0</dt><dd><p>Value of m when FR = 0</p>
</dd>
<dt>fN0</dt><dd><p>Value of fNutr when FR = 0</p>
</dd>
<dt>fNn</dt><dd><p>Power of (1-FR) in fNutr</p>
</dd>
<dt>MaxAge</dt><dd><p>Maximum stand age used in age modifier</p>
</dd>
<dt>nAge</dt><dd><p>Power of relative age in function for fAge</p>
</dd>
<dt>rAge</dt><dd><p>Relative age to give fAge = 0.5</p>
</dd>
<dt>gammaN1</dt><dd><p>Mortality rate for large t</p>
</dd>
<dt>gammaN0</dt><dd><p>Seedling mortality rate (t = 0)</p>
</dd>
<dt>tgammaN</dt><dd><p>Age at which mortality rate has median value</p>
</dd>
<dt>ngammaN</dt><dd><p>Shape of mortality response</p>
</dd>
<dt>wSx1000</dt><dd><p>Max. stem mass per tree - 1000 trees/hectare</p>
</dd>
<dt>thinPower</dt><dd><p>Power in self-thinning rule</p>
</dd>
<dt>mF</dt><dd><p>Fraction mean single-tree foliage biomass lost per dead tree</p>
</dd>
<dt>mR</dt><dd><p>Fraction mean single-tree root biomass lost per dead tree</p>
</dd>
<dt>mS</dt><dd><p>Fraction mean single-tree stem biomass lost per dead tree</p>
</dd>
<dt>SLA0</dt><dd><p>Specific leaf area at age 0</p>
</dd>
<dt>SLA1</dt><dd><p>Specific leaf area for mature leaves</p>
</dd>
<dt>tSLA</dt><dd><p>Age at which specific leaf area = (SLA0+SLA1)/2</p>
</dd>
<dt>k</dt><dd><p>Extinction coefficient for absorption of PAR by canopy</p>
</dd>
<dt>fullCanAge</dt><dd><p>Age at canopy closure</p>
</dd>
<dt>MaxIntcptn</dt><dd><p>Maximum proportion of rainfall evaporated from canopy</p>
</dd>
<dt>LAImaxIntcptn</dt><dd><p>LAI for maximum rainfall interception</p>
</dd>
<dt>cVPD</dt><dd><p>LAI for 50% reduction of VPD in canopy</p>
</dd>
<dt>alphaCx</dt><dd><p>Canopy quantum efficiency</p>
</dd>
<dt>Y</dt><dd><p>Ratio NPP/GPP</p>
</dd>
<dt>MinCond</dt><dd><p>Minimum canopy conductance</p>
</dd>
<dt>MaxCond</dt><dd><p>Maximum canopy conductance</p>
</dd>
<dt>LAIgcx</dt><dd><p>LAI for maximum canopy conductance</p>
</dd>
<dt>CoeffCond</dt><dd><p>Defines stomatal response to VPD</p>
</dd>
<dt>BLcond</dt><dd><p>Canopy boundary layer conductance</p>
</dd>
<dt>RGcGw</dt><dd><p>The ratio of diffusivities of CO2 and water vapour in air</p>
</dd>
<dt>D13CTissueDif</dt><dd><p>d13C difference of modelled tissue and new photosynthate</p>
</dd>
<dt>aFracDiffu</dt><dd><p>Fractionation against 13C in diffusion</p>
</dd>
<dt>bFracRubi</dt><dd><p>Enzymatic fractionation by Rubisco</p>
</dd>
<dt>fracBB0</dt><dd><p>Branch and bark fraction at age 0</p>
</dd>
<dt>fracBB1</dt><dd><p>Branch and bark fraction for mature stands</p>
</dd>
<dt>tBB</dt><dd><p>Age at which fracBB = (fracBB0+fracBB1)/2</p>
</dd>
<dt>rhoMin</dt><dd><p>Minimum basic density - for young trees</p>
</dd>
<dt>rhoMax</dt><dd><p>Maximum basic density - for older trees</p>
</dd>
<dt>tRho</dt><dd><p>Age at which rho = (rhoMin+rhoMax)/2</p>
</dd>
<dt>aH</dt><dd><p>Constant in the stem height relationship</p>
</dd>
<dt>nHB</dt><dd><p>Power of DBH in the stem height relationship</p>
</dd>
<dt>nHC</dt><dd><p>Power of competition in the stem height relationship</p>
</dd>
<dt>aV</dt><dd><p>Constant in the stem volume relationship</p>
</dd>
<dt>nVB</dt><dd><p>Power of DBH in the stem volume relationship</p>
</dd>
<dt>nVH</dt><dd><p>Power of height in the stem volume relationship</p>
</dd>
<dt>nVBH</dt><dd><p>Power of DBH^2 x height in the stem volume relationship</p>
</dd>
<dt>crownshape</dt><dd><p>Crown shape (1=cone, 2=ellipsoid, 3=half-ellipsoid, 4=rectangular)</p>
</dd>
<dt>aK</dt><dd><p>Constant in the crown diameter relationship</p>
</dd>
<dt>nKB</dt><dd><p>Power of DBH in the crown diameter relationship</p>
</dd>
<dt>nKH</dt><dd><p>Power of height in the crown diameter relationship</p>
</dd>
<dt>nKC</dt><dd><p>Power of competition in the crown diameter relationship</p>
</dd>
<dt>nKrh</dt><dd><p>Power of relative height in the crown diameter relationship</p>
</dd>
<dt>aHL</dt><dd><p>Constant in the LCL relationship</p>
</dd>
<dt>nHLB</dt><dd><p>Power of DBH in the LCL relationship</p>
</dd>
<dt>nHLL</dt><dd><p>Power of LAI in the LCL relationship</p>
</dd>
<dt>nHLC</dt><dd><p>Power of competition in the LCL relationship</p>
</dd>
<dt>nHLrh</dt><dd><p>Power of relative height in the LCL relationship</p>
</dd>
<dt>Dscale0</dt><dd><p>Constant in the relationship for Weibull scale parameter of D distribution</p>
</dd>
<dt>DscaleB</dt><dd><p>Slope of DBH in relationship for Weibull scale parameter of D distribution</p>
</dd>
<dt>Dscalerh</dt><dd><p>Slope of relative height in relationship for Weibull scale parameter of D distribution</p>
</dd>
<dt>Dscalet</dt><dd><p>Slope of age in relationship for Weibull scale parameter of D distribution</p>
</dd>
<dt>DscaleC</dt><dd><p>Slope of competition in relationship for Weibull scale parameter of D distribution</p>
</dd>
<dt>Dshape0</dt><dd><p>Constant in the relationship for Weibull shape parameter of D distribution</p>
</dd>
<dt>DshapeB</dt><dd><p>Slope of DBH in relationship for Weibull shape parameter of D distribution</p>
</dd>
<dt>Dshaperh</dt><dd><p>Slope of relative height in relationship for Weibull shape parameter of D distribution</p>
</dd>
<dt>Dshapet</dt><dd><p>Slope of age in relationship for Weibull shape parameter of D distribution</p>
</dd>
<dt>DshapeC</dt><dd><p>Slope of competition in relationship for Weibull shape parameter of D distribution</p>
</dd>
<dt>Dlocation0</dt><dd><p>Constant in the relationship for Weibull location parameter of D distribution</p>
</dd>
<dt>DlocationB</dt><dd><p>Slope of DBH in relationship for Weibull location parameter of D distribution</p>
</dd>
<dt>Dlocationrh</dt><dd><p>Slope of relative height in relationship for Weibull location parameter of D distribution</p>
</dd>
<dt>Dlocationt</dt><dd><p>Slope of age in relationship for Weibull location parameter of D distribution</p>
</dd>
<dt>DlocationC</dt><dd><p>Slope of competition in relationship for Weibull location parameter of D distribution</p>
</dd>
<dt>wsscale0</dt><dd><p>Constant in the relationship for Weibull scale parameter of ws distribution</p>
</dd>
<dt>wsscaleB</dt><dd><p>Slope of DBH in relationship for Weibull scale parameter of ws distribution</p>
</dd>
<dt>wsscalerh</dt><dd><p>Slope of relative height in relationship for Weibull scale parameter of ws distribution</p>
</dd>
<dt>wsscalet</dt><dd><p>Slope of age in relationship for Weibull scale parameter of ws distribution</p>
</dd>
<dt>wsscaleC</dt><dd><p>Slope of competition in relationship for Weibull scale parameter of ws distribution</p>
</dd>
<dt>wsshape0</dt><dd><p>Constant in the relationship for Weibull shape parameter of ws distribution</p>
</dd>
<dt>wsshapeB</dt><dd><p>Slope of DBH in relationship for Weibull shape parameter of ws distribution</p>
</dd>
<dt>wsshaperh</dt><dd><p>Slope of relative height in relationship for Weibull shape parameter of ws distribution</p>
</dd>
<dt>wsshapet</dt><dd><p>Slope of age in relationship for Weibull shape parameter of ws distribution</p>
</dd>
<dt>wsshapeC</dt><dd><p>Slope of competition in relationship for Weibull shape parameter of ws distribution</p>
</dd>
<dt>wslocation0</dt><dd><p>Constant in the relationship for Weibull location parameter of ws distribution</p>
</dd>
<dt>wslocationB</dt><dd><p>Slope of DBH in relationship for Weibull location parameter of ws distribution</p>
</dd>
<dt>wslocationrh</dt><dd><p>Slope of relative height in relationship for Weibull location parameter of ws distribution</p>
</dd>
<dt>wslocationt</dt><dd><p>Slope of age in relationship for Weibull location parameter of ws distribution</p>
</dd>
<dt>wslocationC</dt><dd><p>Slope of competition in relationship for Weibull location parameter of ws distribution</p>
</dd>
<dt>Qa</dt><dd><p>Intercept of net v. solar radiation relationship</p>
</dd>
<dt>Qb</dt><dd><p>Slope of net v. solar radiation relationship</p>
</dd>
<dt>gDM_mol</dt><dd><p>Molecular weight of dry matter</p>
</dd>
<dt>molPAR_MJ</dt><dd><p>Conversion of solar radiation to PAR</p>
</dd>
</dl>



<h3>Details</h3>

<p>Each row refers to an unique parameter set. 
The function <code><a href="#topic+get_parameters">get_parameters</a></code> eases the use to this dataset.
</p>

<hr>
<h2 id='i_sizeDist'>Information about size distribution parameters</h2><span id='topic+i_sizeDist'></span>

<h3>Description</h3>

<p>A dataset containing the parameters order and description.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>i_sizeDist
</code></pre>


<h3>Format</h3>

<p>A data frame with 30 rows and 3 variables:
</p>

<dl>
<dt>parameter</dt><dd><p>parameter name</p>
</dd>
<dt>description</dt><dd><p>description of the parameter</p>
</dd>
<dt>unit</dt><dd><p>unit</p>
</dd>
<dt>default</dt><dd><p>default value equal to 0</p>
</dd>
</dl>


<hr>
<h2 id='prepare_climate'>Subsets or replicate a climate data</h2><span id='topic+prepare_climate'></span>

<h3>Description</h3>

<p>Prepares the climate table, by either replicating the average climate for the required number of years, or by sub-setting from a longer time-series of climate data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_climate(climate, from = "2000-04", to = "2010-11")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare_climate_+3A_climate">climate</code></td>
<td>
<p>table containing the information about monthly values for climatic data. If the climate table have exactly 12 rows it will be replicated for the number of years and months specified by <code>from</code> - <code>to</code>. Otherwise, it will be subsetted to the selected time period. If this is required, <code>year</code> and <code>month</code> columns must be included in the climate table. The minimum required columns are listed below, but additionally you can include: tmp_ave, c02, d13catm. Please refer to <code><a href="#topic+d_climate">d_climate</a></code> for example.
</p>

<ul>
<li><p> year: year of observation (only required for subsetting) (numeric).
</p>
</li>
<li><p> month: months of observation (only required for subsetting) (numeric).
</p>
</li>
<li><p> tmp_min: monthly mean daily minimum temperature (C).
</p>
</li>
<li><p> tmp_max: monthly mean daily maximum temperature (C).
</p>
</li>
<li><p> tmp_ave: monthly mean daily average temperature (C) (optional).
</p>
</li>
<li><p> prcp: monthly rainfall (mm month-1).
</p>
</li>
<li><p> srad: monthly mean daily solar radiation (MJ m-2 d-1).
</p>
</li>
<li><p> frost_days: frost days per month (d month-1).
</p>
</li>
<li><p> co2: monthly mean atmospheric co2 (ppm), required if calculate_d13c=1 (optional).
</p>
</li>
<li><p> d13catm: monthly mean isotopic composition of air (‰), required if calculate_d13c=1 (optional).
</p>
</li></ul>
</td></tr>
<tr><td><code id="prepare_climate_+3A_from">from</code></td>
<td>
<p>year and month indicating the start of simulation. Provided in form of year-month. E.g. &quot;2000-01&quot;.</p>
</td></tr>
<tr><td><code id="prepare_climate_+3A_to">to</code></td>
<td>
<p>year and month indicating the end of simulation. Provided in form of year-month. E.g. &quot;2009-12&quot;, will include December 2009 as last simulation month.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prepares the climate table for <code><a href="#topic+run_3PG">run_3PG</a></code>.
</p>
<p>In case a user provides only average climate, this is replicated for the desired simulation period.
</p>
<p>In case a larger climate file is provided, the simulation period is selected from this.
</p>


<h3>Value</h3>

<p>a data.frame with number of rows corresponding to number of simulated month and 10 columns
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_3PG">run_3PG</a></code>, <code><a href="#topic+prepare_input">prepare_input</a></code>, <code><a href="#topic+prepare_parameters">prepare_parameters</a></code>, <code><a href="#topic+prepare_sizeDist">prepare_sizeDist</a></code>, <code><a href="#topic+prepare_thinning">prepare_thinning</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># sub-setting climate data
prepare_climate( climate = d_climate, from = '2003-04', to = '2010-11')

# replicating climate data
set.seed(1)
climate = data.frame( tmp_min = rnorm(12, mean = 10),
                      tmp_max = rnorm(12, mean = 20),
                      prcp = sample(c(0:200), 12),
                      srad = sample(c(1:100), 12),
                      frost_days = sample(c(0:30), 12))

prepare_climate( climate = climate, from = '2000-04', to = '2010-11')

</code></pre>

<hr>
<h2 id='prepare_input'>Check and prepare input for running 3-PG model</h2><span id='topic+prepare_input'></span>

<h3>Description</h3>

<p>Checks and prepares all input tables to be used in <code><a href="#topic+run_3PG">run_3PG</a></code>. For detailed descriptions see Forrester (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_input(site, species, climate, thinning = NULL, parameters = NULL,
  size_dist = NULL, settings = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare_input_+3A_site">site</code></td>
<td>
<p>table containing the information about site conditions.
</p>

<ul>
<li><p> latitude: site latitude in the WGS84 coordinate system.
</p>
</li>
<li><p> altitude: site altitude, m a.s.l.
</p>
</li>
<li><p> soil_class: 1 - Sandy; 2 - Sandy loam; 3 - Clay loam; 4 - Clay; 0 - No effect of asw on production.
</p>
</li>
<li><p> asw_i: initial available soil water (mm).
</p>
</li>
<li><p> asw_min: minimum available soil water (mm).
</p>
</li>
<li><p> asw_max: maximum available soil water (mm).
</p>
</li>
<li><p> from: year and month indicating the start of simulation. Provided in form of year-month. E.g. &quot;2000-01&quot;.
</p>
</li>
<li><p> to: year and month indicating the end of simulation. Provided in form of year-month. E.g. &quot;2009-12&quot;, will include December 2009 as last simulation month
</p>
</li></ul>
</td></tr>
<tr><td><code id="prepare_input_+3A_species">species</code></td>
<td>
<p>table containing the information about species level data. Each row corresponds to one species/cohort.
</p>

<ul>
<li><p> species: species or cohort id/name. It must be consistent with species names in <code>thinning</code>, <code>parameters</code> and <code>sizeDist</code> tables.
</p>
</li>
<li><p> planted: year and month indicating when species was planted. Provided in form of year-month. E.g. &quot;2000-01&quot;.
</p>
</li>
<li><p> fertility: soil fertility for a given species. Range from 0 to 1.
</p>
</li>
<li><p> stems_n: number of trees per ha.
</p>
</li>
<li><p> biom_stem: stem biomass for a given species (Mg/ha).
</p>
</li>
<li><p> biom_root: root biomass for a given species (Mg/ha).
</p>
</li>
<li><p> biom_foliage: initial foliage biomass (Mg/ha). If this is a leafless period, provide the spring foliage biomass.
</p>
</li></ul>
</td></tr>
<tr><td><code id="prepare_input_+3A_climate">climate</code></td>
<td>
<p>table containing the information about monthly values for climatic data. If the climate table has exactly 12 rows it will be replicated for the number of years and months specified by <code>from</code> - <code>to</code>. Otherwise, it will be subsetted to the selected time period. More details about preparing climate data are at <code><a href="#topic+prepare_climate">prepare_climate</a></code>.
</p>

<ul>
<li><p> year: year of observation (only required for subsetting) (optional).
</p>
</li>
<li><p> month: months of observation (only required for subsetting) (optional).
</p>
</li>
<li><p> tmp_min: monthly mean daily minimum temperature (C).
</p>
</li>
<li><p> tmp_max: monthly mean daily maximum temperature (C).
</p>
</li>
<li><p> tmp_ave: monthly mean daily average temperature (C) (optional).
</p>
</li>
<li><p> prcp: monthly rainfall (mm month-1).
</p>
</li>
<li><p> srad: monthly mean daily solar radiation (MJ m-2 d-1).
</p>
</li>
<li><p> frost_days: frost days per month (d month-1).
</p>
</li>
<li><p> vpd_day: water pressure deficit (mbar) (optional).
</p>
</li>
<li><p> co2: monthly mean atmospheric co2 (ppm), required if calculate_d13c=1 (optional)
</p>
</li>
<li><p> d13catm: monthly mean isotopic composition of air (‰), required if calculate_d13c=1 (optional)
</p>
</li></ul>
</td></tr>
<tr><td><code id="prepare_input_+3A_thinning">thinning</code></td>
<td>
<p>table containing the information about thinnings. If there is no thinning, it must be <code>NULL</code>.
</p>

<ul>
<li><p> species: species or cohort id/name. It must be consistent with species names in <code>species</code>, <code>parameters</code> and <code>sizeDist</code> tables.
</p>
</li>
<li><p> age: age when thinning is performed.
</p>
</li>
<li><p> stems_n: number of trees remaining after thinning
</p>
</li>
<li><p> foliage: type of thinning (above/below). Default is 1.
</p>
</li>
<li><p> root: type of thinning (above/below). Default is 1.
</p>
</li>
<li><p> stem: type of thinning (above/below). Default is 1.
</p>
</li></ul>
</td></tr>
<tr><td><code id="prepare_input_+3A_parameters">parameters</code></td>
<td>
<p>table containing the information about parameters to be modified. Values that are not provided are replaced by defaults.
</p>

<ul>
<li><p> parameter: name of the parameter, must be consistent in naming with <code><a href="#topic+i_parameters">i_parameters</a></code>
</p>
</li>
<li><p> species: each column must correspond to species/cohort id/name, as defined in <code>species</code> table
</p>
</li></ul>
</td></tr>
<tr><td><code id="prepare_input_+3A_size_dist">size_dist</code></td>
<td>
<p>table containing the information about size distribution to be modified. Values that are not provided are replaced by defaults.
</p>

<ul>
<li><p> parameter: name of the parameter, must be consistent in naming with <code><a href="#topic+i_sizeDist">i_sizeDist</a></code>
</p>
</li>
<li><p> species: each column must correspond to species/cohort id/name, as defined in <code>species</code> table
</p>
</li></ul>
</td></tr>
<tr><td><code id="prepare_input_+3A_settings">settings</code></td>
<td>
<p>a list with settings for the model. Values that are not provided are replaced by defaults.
</p>

<ul>
<li><p> light_model: '1' - 3-PGpjs (default); '2' - 3-PGmix
</p>
</li>
<li><p> transp_model: '1' - 3-PGpjs (default); '2' - 3-PGmix
</p>
</li>
<li><p> phys_model:  '1' - 3-PGpjs (default); '2' - 3-PGmix
</p>
</li>
<li><p> height_model: '1' - linear (default); '2' - non-linear
</p>
</li>
<li><p> correct_bias: '0' - no (default); '1' - yes
</p>
</li>
<li><p> calculate_d13c: '0' - no (default); '1' - yes
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>This function checks and prepares the input data for the <code><a href="#topic+run_3PG">run_3PG</a></code>. The output is a list with 7 tables. Each of them corresponds to the one from input.
</p>


<h3>Value</h3>

<p>a list with seven tables. Each table corresponds to one of the input tables.
</p>


<h3>References</h3>

<p>Forrester, D. I., 2020. 3-PG User Manual. Swiss Federal Institute for Forest, Snow and Landscape Research WSL, Birmensdorf, Switzerland. 70 p. Available at the following web site: <a href="http://sites.google.com/site/davidforresterssite/home/projects/3PGmix/3pgmixdownload">http://sites.google.com/site/davidforresterssite/home/projects/3PGmix/3pgmixdownload</a>
</p>
<p>Sands, P. J., 2010. 3PGpjs user manual. Available at the following web site: <a href="https://3pg.sites.olt.ubc.ca/files/2014/04/3PGpjs_UserManual.pdf">https://3pg.sites.olt.ubc.ca/files/2014/04/3PGpjs_UserManual.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_3PG">run_3PG</a></code>, <code><a href="#topic+prepare_parameters">prepare_parameters</a></code>, <code><a href="#topic+prepare_sizeDist">prepare_sizeDist</a></code>, <code><a href="#topic+prepare_thinning">prepare_thinning</a></code>, <code><a href="#topic+prepare_climate">prepare_climate</a></code>, <code><a href="#topic+prepare_site">prepare_site</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prepare_input( site = d_site, species = d_species, climate = d_climate, d_thinning)
</code></pre>

<hr>
<h2 id='prepare_parameters'>Prepare parameters table</h2><span id='topic+prepare_parameters'></span>

<h3>Description</h3>

<p>Prepares the parameters table, by either replicating the defaults or replicating defaults for each of the species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_parameters(parameters = NULL, sp_names = c("Fagus sylvatica",
  "Pinus sylvestris"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare_parameters_+3A_parameters">parameters</code></td>
<td>
<p>table containing the information about parameters to be modified. Values that are not provided are replaced by defaults.
</p>

<ul>
<li><p> parameter: name of the parameter, must be consistent in naming with <code><a href="#topic+i_parameters">i_parameters</a></code>
</p>
</li>
<li><p> species: each column must correspond to species/cohort id/name, as defined in <code>species</code> table
</p>
</li></ul>
</td></tr>
<tr><td><code id="prepare_parameters_+3A_sp_names">sp_names</code></td>
<td>
<p>names of the species / cohorts used for the simulations.The 'sp_names' must be identical to those from <code>species</code> table.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prepares the parameter table for <code><a href="#topic+run_3PG">run_3PG</a></code>
</p>


<h3>Value</h3>

<p>a data.frame with 47 rows and columns corresponding to each species.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_3PG">run_3PG</a></code>, <code><a href="#topic+prepare_input">prepare_input</a></code>, <code><a href="#topic+prepare_sizeDist">prepare_sizeDist</a></code>, <code><a href="#topic+prepare_thinning">prepare_thinning</a></code>, <code><a href="#topic+prepare_climate">prepare_climate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># replace some
prepare_parameters( parameters = d_parameters[1:4,],
  sp_names = c('Fagus sylvatica', 'Pinus sylvestris' ))

# Make default
prepare_parameters( parameters = NULL, sp_names = c('Quercus', 'Abies'))

</code></pre>

<hr>
<h2 id='prepare_site'>Check the site data for consistency</h2><span id='topic+prepare_site'></span>

<h3>Description</h3>

<p>Prepares the site table, by checking whether the input information is consistent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_site(site)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare_site_+3A_site">site</code></td>
<td>
<p>table containing the information about site data. It shall contain exactly one row.
</p>

<ul>
<li><p> latitude: site latitude in the WGS84 coordinate system.
</p>
</li>
<li><p> altitude: site altitude, m a.s.l.
</p>
</li>
<li><p> soil_class:  soil class, according to table 2 user manual of 3PGpjs. 1 - Sandy; 2 - Sandy loam; 3 - Clay loam; 4 - Clay; 0 - No effect of available soil water on production.
</p>
</li>
<li><p> asw_i: initial available soil water (mm).
</p>
</li>
<li><p> asw_max: minimum available soil water (mm).
</p>
</li>
<li><p> asw_min: maximum available soil water (mm).
</p>
</li>
<li><p> from: year and month indicating the start of simulation. Provided in form of year-month. E.g. &quot;2000-01&quot;.
</p>
</li>
<li><p> to: year and month indicating the end of simulation. Provided in form of year-month. E.g. &quot;2009-12&quot;, will include December 2009 as last simulation month.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>This function check the site table for <code><a href="#topic+run_3PG">run_3PG</a></code>.
</p>


<h3>Value</h3>

<p>a data.frame with one row
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_3PG">run_3PG</a></code>, <code><a href="#topic+prepare_input">prepare_input</a></code>, <code><a href="#topic+prepare_parameters">prepare_parameters</a></code>, <code><a href="#topic+prepare_sizeDist">prepare_sizeDist</a></code>, <code><a href="#topic+prepare_thinning">prepare_thinning</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># check site data
prepare_site( site = d_site)
</code></pre>

<hr>
<h2 id='prepare_sizeDist'>Prepare parameters table</h2><span id='topic+prepare_sizeDist'></span>

<h3>Description</h3>

<p>Prepares the parameters table, by either replicating the defaults or replicating defaults for each of the species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_sizeDist(size_dist = NULL, sp_names = c("Fagus sylvatica",
  "Pinus sylvestris"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare_sizeDist_+3A_size_dist">size_dist</code></td>
<td>
<p>table containing the information about size distribution to be modified. Values that are not provided are replaced by defaults.
</p>

<ul>
<li><p> parameter: name of the parameter, must be consistent in naming with <code><a href="#topic+i_sizeDist">i_sizeDist</a></code>.
</p>
</li>
<li><p> species: each column must correspond to species/cohort id/name, as defined in <code>species</code> table.
</p>
</li></ul>
</td></tr>
<tr><td><code id="prepare_sizeDist_+3A_sp_names">sp_names</code></td>
<td>
<p>names of the species / cohorts used for the simulations.The 'sp_names' must be identical to those from <code>species</code> table.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prepares the parameter table for <code><a href="#topic+run_3PG">run_3PG</a></code>.
</p>


<h3>Value</h3>

<p>a data.frame with 47 rows and columns corresponding to each species.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_3PG">run_3PG</a></code>, <code><a href="#topic+prepare_input">prepare_input</a></code>, <code><a href="#topic+prepare_parameters">prepare_parameters</a></code>, <code><a href="#topic+prepare_thinning">prepare_thinning</a></code>, <code><a href="#topic+prepare_climate">prepare_climate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># replace some
prepare_sizeDist( size_dist = d_sizeDist[1:4,],
  sp_names = c('Fagus sylvatica', 'Pinus sylvestris' ))

# Make default
prepare_sizeDist( size_dist = NULL, sp_names = c('Quercus', 'Abies'))

</code></pre>

<hr>
<h2 id='prepare_species'>Check the species data for consistency</h2><span id='topic+prepare_species'></span>

<h3>Description</h3>

<p>Prepares the species table, by checking whether the input information is consistent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_species(species)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare_species_+3A_species">species</code></td>
<td>
<p>table containing the information about species level data. Each row corresponds to one species/cohort.
</p>

<ul>
<li><p> species: species or cohort id/name. It must be consistent with species names in <code>thinning</code>, <code>parameters</code> and <code>sizeDist</code> tables.
</p>
</li>
<li><p> planted: year and month indicating when species was planted. Provided in form of year-month. E.g. &quot;2000-01&quot;.
</p>
</li>
<li><p> fertility: soil fertility for a given species. Range from 0 to 1.
</p>
</li>
<li><p> stems_n: number of trees per ha.
</p>
</li>
<li><p> biom_stem: stem biomass for a given species (Mg/ha).
</p>
</li>
<li><p> biom_root: root biomass for a given species (Mg/ha).
</p>
</li>
<li><p> biom_foliage: initial foliage biomass (Mg/ha). If this is a leafless period, provide the spring foliage biomass.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>This function check the species table for <code><a href="#topic+run_3PG">run_3PG</a></code>.
</p>


<h3>Value</h3>

<p>a data.frame with one row
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_3PG">run_3PG</a></code>, <code><a href="#topic+prepare_input">prepare_input</a></code>, <code><a href="#topic+prepare_parameters">prepare_parameters</a></code>, <code><a href="#topic+prepare_sizeDist">prepare_sizeDist</a></code>, <code><a href="#topic+prepare_thinning">prepare_thinning</a></code>, <code><a href="#topic+prepare_site">prepare_site</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># check species data
prepare_species( species = d_species)
</code></pre>

<hr>
<h2 id='prepare_thinning'>Check and prepare management information.</h2><span id='topic+prepare_thinning'></span>

<h3>Description</h3>

<p>Prepares the management table and checks for consistency.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_thinning(thinning = NULL, sp_names = c("Fagus sylvatica",
  "Pinus sylvestris"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare_thinning_+3A_thinning">thinning</code></td>
<td>
<p>table containing the information about thinnings. If there is no thinning, it must be <code>NULL</code>. The following columns are required:
</p>

<ul>
<li><p> species: species or cohort id/name.
</p>
</li>
<li><p> age: age at which thinning is done.
</p>
</li>
<li><p> stems_n: number of trees remaining after thinning
</p>
</li>
<li><p> stem: type of thinning (above/below). Default is 1.
</p>
</li>
<li><p> foliage: type of thinning (above/below). Default is 1.
</p>
</li>
<li><p> root: type of thinning (above/below). Default is 1.
</p>
</li></ul>
</td></tr>
<tr><td><code id="prepare_thinning_+3A_sp_names">sp_names</code></td>
<td>
<p>names of the species / cohorts used for the simulations. This is required whether 'thinning=NULL' or if not all species are indicated in the 'thinning' table. The 'sp_names' must be identical to those from <code>species</code> table.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prepares the thinning table for <code><a href="#topic+run_3PG">run_3PG</a></code>.
</p>
<p>In case there is no thinning it will return empty 3-d array.
</p>
<p>In case there will be thinning it will return 3-d array, where one dimension correspond to each species.
</p>


<h3>Value</h3>

<p>a 3-dimentional array, where third dimention correspond to each species.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+run_3PG">run_3PG</a></code>, <code><a href="#topic+prepare_input">prepare_input</a></code>, <code><a href="#topic+prepare_parameters">prepare_parameters</a></code>, <code><a href="#topic+prepare_sizeDist">prepare_sizeDist</a></code>, <code><a href="#topic+prepare_climate">prepare_climate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prepare_thinning( thinning = NULL, sp_names = c('Quercus', 'Abies'))

prepare_thinning( thinning = d_thinning, sp_names = c('Fagus sylvatica', 'Pinus sylvestris'))
</code></pre>

<hr>
<h2 id='run_3PG'>Runs a 3-PG model simulation</h2><span id='topic+run_3PG'></span>

<h3>Description</h3>

<p>Runs the 3-PGpjs (monospecific, evenaged and evergreen forests) or 3-PGmix (deciduous, uneven-aged or mixed-species forests) model. For more details on parameters and structure of input visit <code><a href="#topic+prepare_input">prepare_input</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_3PG(site, species, climate, thinning = NULL, parameters = NULL,
  size_dist = NULL, settings = NULL, check_input = TRUE, df_out = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_3PG_+3A_site">site</code></td>
<td>
<p>table as described in <code><a href="#topic+prepare_input">prepare_input</a></code> containing the information about site conditions.</p>
</td></tr>
<tr><td><code id="run_3PG_+3A_species">species</code></td>
<td>
<p>table as described in <code><a href="#topic+prepare_input">prepare_input</a></code> containing the information about species level data. Each row corresponds to one species/cohort.</p>
</td></tr>
<tr><td><code id="run_3PG_+3A_climate">climate</code></td>
<td>
<p>table as described in <code><a href="#topic+prepare_input">prepare_input</a></code> containing the information about monthly values for climatic data. See also <code><a href="#topic+prepare_climate">prepare_climate</a></code></p>
</td></tr>
<tr><td><code id="run_3PG_+3A_thinning">thinning</code></td>
<td>
<p>table as described in <code><a href="#topic+prepare_input">prepare_input</a></code> containing the information about thinnings. See also <code><a href="#topic+prepare_thinning">prepare_thinning</a></code></p>
</td></tr>
<tr><td><code id="run_3PG_+3A_parameters">parameters</code></td>
<td>
<p>table as described in <code><a href="#topic+prepare_input">prepare_input</a></code> containing the information about parameters to be modified. See also <code><a href="#topic+prepare_parameters">prepare_parameters</a></code></p>
</td></tr>
<tr><td><code id="run_3PG_+3A_size_dist">size_dist</code></td>
<td>
<p>table as described in <code><a href="#topic+prepare_input">prepare_input</a></code> containing the information about size distributions. See also <code><a href="#topic+prepare_sizeDist">prepare_sizeDist</a></code></p>
</td></tr>
<tr><td><code id="run_3PG_+3A_settings">settings</code></td>
<td>
<p>a list as described in <code><a href="#topic+prepare_input">prepare_input</a></code> with settings for the model.</p>
</td></tr>
<tr><td><code id="run_3PG_+3A_check_input">check_input</code></td>
<td>
<p><code>logical</code> if the input shall be checked for consistency. It will call <code><a href="#topic+prepare_input">prepare_input</a></code> function.</p>
</td></tr>
<tr><td><code id="run_3PG_+3A_df_out">df_out</code></td>
<td>
<p><code>logical</code> if the output shall be long data.frame (TRUE) the 4-dimensional array (FALSE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'r3PG' provides an implementation of the Physiological Processes Predicting Growth <a href="https://3pg.forestry.ubc.ca">3-PG</a> model, which simulates forest growth and productivity. The 'r3PG' serves as a flexible and easy-to-use interface for the '3-PGpjs' (monospecific, evenaged and evergreen forests) and the '3-PGmix' (deciduous, uneven-aged or mixed-species forests) model written in 'Fortran'. The package, allows for fast and easy interaction with the model, and 'Fortran' re-implementation facilitates computationally intensive sensitivity analysis and calibration. The user can flexibly switch between various options and submodules, to use the original '3-PGpjs' model version for monospecific, even-aged and evergreen forests and the '3-PGmix' model, which can also simulate multi-cohort stands (e.g. mixtures, uneven-aged) that contain deciduous species.
</p>
<p>This implementation of 3-PG includes several major variants / modifications of the model in particular the ability to switch between 3-PGpjs (the more classic model version for monospecific stands) vs. 3-PGmix (a version for mixed stands), as well as options for bias corrections and <code class="reqn">\delta^13 C</code> calculations (see parameters).
</p>


<h3>Value</h3>

<p>either a 4-dimentional array or a data.frame, depending on the parameter <code>df_out</code>. More details on the output is <code><a href="#topic+i_output">i_output</a></code>
</p>


<h3>Note</h3>

<p>The <code>run_3PG</code> also checks the quality of input data. When names, or structures are not consistent with requirements it will return an error. Turn this off to optimize for speed.
</p>


<h3>References</h3>

<p>Forrester, D. I., 2020. 3-PG User Manual. Swiss Federal Institute for Forest, Snow and Landscape Research WSL, Birmensdorf, Switzerland. 70 p. Available at the following web site: <a href="http://sites.google.com/site/davidforresterssite/home/projects/3PGmix/3pgmixdownload">http://sites.google.com/site/davidforresterssite/home/projects/3PGmix/3pgmixdownload</a>
</p>
<p>Forrester, D. I., &amp; Tang, X. (2016). Analysing the spatial and temporal dynamics of species interactions in mixed-species forests and the effects of stand density using the 3-PG model. Ecological Modelling, 319, 233–254. <a href="https://doi.org/10.1016/j.ecolmodel.2015.07.010">doi:10.1016/j.ecolmodel.2015.07.010</a>
</p>
<p>Landsberg, J. J., &amp; Waring, R. H., 1997. A generalised model of forest productivity using simplified concepts of radiation-use efficiency, carbon balance and partitioning. Forest Ecology and Management, 95(3), 209–228. <a href="https://doi.org/10.1016/S0378-1127%2897%2900026-1">doi:10.1016/S0378-1127(97)00026-1</a>
</p>
<p>Sands, P. J., 2010. 3PGpjs user manual. Available at the following web site: <a href="https://3pg.sites.olt.ubc.ca/files/2014/04/3PGpjs_UserManual.pdf">https://3pg.sites.olt.ubc.ca/files/2014/04/3PGpjs_UserManual.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+prepare_input">prepare_input</a></code>, <code><a href="#topic+prepare_parameters">prepare_parameters</a></code>, <code><a href="#topic+prepare_sizeDist">prepare_sizeDist</a></code>, <code><a href="#topic+prepare_thinning">prepare_thinning</a></code>, <code><a href="#topic+prepare_climate">prepare_climate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>out &lt;- run_3PG(
  site = d_site,
  species = d_species,
  climate = d_climate,
  thinning = d_thinning,
  parameters = d_parameters,
  size_dist = d_sizeDist,
  settings = list(light_model = 2, transp_model = 2, phys_model = 2,
                  correct_bias = 1, calculate_d13c = 0),
  check_input = TRUE, df_out = TRUE) # note that default is TRUE

str(out) # List output format
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
