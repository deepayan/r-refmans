<!DOCTYPE html><html lang="en-US"><head><title>Help for package SFM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SFM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calculate_errors'><p>calculate_errors Function</p></a></li>
<li><a href='#FanPC.SFM'><p>Apply the FanPC method to the Skew factor model</p></a></li>
<li><a href='#GulPC.SFM'><p>Apply the GulPC method to the Skew factor model</p></a></li>
<li><a href='#IPC.SFM'><p>Apply the IPC method to the Skew factor model</p></a></li>
<li><a href='#OPC.SFM'><p>Apply the OPC method to the Skew factor model</p></a></li>
<li><a href='#PC1.SFM'><p>Apply the PC method to the Laplace factor model</p></a></li>
<li><a href='#PC2.SFM'><p>Apply the PC method to the Laplace factor model</p></a></li>
<li><a href='#PPC1.SFM'><p>Apply the PPC method to the Skew factor model</p></a></li>
<li><a href='#PPC2.SFM'><p>Apply the PPC method to the Skew factor model</p></a></li>
<li><a href='#SAPC.SFM'><p>Stochastic Approximation Principal Component Analysis</p></a></li>
<li><a href='#SFM'><p>The SFM function is to generate Skew Factor Models data.</p></a></li>
<li><a href='#SOPC.SFM'><p>SOPC Estimation Function</p></a></li>
<li><a href='#SPC.SFM'><p>Apply the SPC method to the Skew factor model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Package for Analyzing Skew Factor Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Generates Skew Factor Models data and applies Sparse Online Principal Component (SOPC), Incremental Principal Component (IPC), Projected Principal Component (PPC), Perturbation Principal Component (PPC), Stochastic Approximation Principal Component (SAPC), Sparse Principal Component (SPC) and other PC methods to estimate model parameters. It includes capabilities for calculating mean squared error, relative error, and sparsity of the loading matrix.The philosophy of the package is described in Guo G. (2023) &lt;<a href="https://doi.org/10.1007%2Fs00180-022-01270-z">doi:10.1007/s00180-022-01270-z</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, SOPC, matrixcalc, sn, stats,psych</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Author:</td>
<td>Guangbao Guo [aut, cre],
  Yu Jin [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guangbao Guo &lt;ggb11111111@163.com&gt;</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), ggplot2</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-05 12:16:53 UTC; AIERXUAN</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-05 13:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='calculate_errors'>calculate_errors Function</h2><span id='topic+calculate_errors'></span>

<h3>Description</h3>

<p>This function calculates the Mean Squared Error (MSE) and relative error for factor loadings and uniqueness estimates obtained from factor analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_errors(data, A, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_errors_+3A_data">data</code></td>
<td>
<p>Matrix of SFM data.</p>
</td></tr>
<tr><td><code id="calculate_errors_+3A_a">A</code></td>
<td>
<p>Matrix of true factor loadings.</p>
</td></tr>
<tr><td><code id="calculate_errors_+3A_d">D</code></td>
<td>
<p>Matrix of true uniquenesses.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector containing:
</p>
<table role = "presentation">
<tr><td><code>MSEA</code></td>
<td>
<p>Mean Squared Error for factor loadings.</p>
</td></tr>
<tr><td><code>MSED</code></td>
<td>
<p>Mean Squared Error for uniqueness estimates.</p>
</td></tr>
<tr><td><code>LSA</code></td>
<td>
<p>Relative error for factor loadings.</p>
</td></tr>
<tr><td><code>LSD</code></td>
<td>
<p>Relative error for uniqueness estimates.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123) # For reproducibility
# Define dimensions
n &lt;- 10  # Number of samples
p &lt;- 5   # Number of factors

# Generate matrices with compatible dimensions
A &lt;- matrix(runif(p * p, -1, 1), nrow = p)  # Factor loadings matrix (p x p)
D &lt;- diag(runif(p, 1, 2))  # Uniquenesses matrix (p x p)
data &lt;- matrix(runif(n * p), nrow = n)  # Data matrix (n x p)

# Calculate errors
errors &lt;- calculate_errors(data, A, D)
print(errors)
</code></pre>

<hr>
<h2 id='FanPC.SFM'>Apply the FanPC method to the Skew factor model</h2><span id='topic+FanPC.SFM'></span>

<h3>Description</h3>

<p>This function performs Factor Analysis via Principal Component (FanPC) on a given data set. It calculates the estimated factor loading matrix (AF), specific variance matrix (DF), and the mean squared errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FanPC.SFM(data, m, A, D, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FanPC.SFM_+3A_data">data</code></td>
<td>
<p>A matrix of input data.</p>
</td></tr>
<tr><td><code id="FanPC.SFM_+3A_m">m</code></td>
<td>
<p>The number of principal components.</p>
</td></tr>
<tr><td><code id="FanPC.SFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="FanPC.SFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="FanPC.SFM_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>AF</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>DF</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for factor loadings.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(SOPC)
library(matrixcalc)
library(MASS)
library(sn)
library(psych)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
r &lt;- rsn(n*p,0,1)
epsilon=matrix(r,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- FanPC.SFM(data, m, A, D, p)
print(results)
</code></pre>

<hr>
<h2 id='GulPC.SFM'>Apply the GulPC method to the Skew factor model</h2><span id='topic+GulPC.SFM'></span>

<h3>Description</h3>

<p>This function performs General Unilateral Loading Principal Component (GulPC) analysis on a given data set. It calculates the estimated values for the first layer and second layer loadings, specific variances, and the mean squared errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GulPC.SFM(data, m, A, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GulPC.SFM_+3A_data">data</code></td>
<td>
<p>A matrix of input data.</p>
</td></tr>
<tr><td><code id="GulPC.SFM_+3A_m">m</code></td>
<td>
<p>The number of principal components.</p>
</td></tr>
<tr><td><code id="GulPC.SFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="GulPC.SFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>AU1</code></td>
<td>
<p>The first layer loading matrix.</p>
</td></tr>
<tr><td><code>AU2</code></td>
<td>
<p>The second layer loading matrix.</p>
</td></tr>
<tr><td><code>DU3</code></td>
<td>
<p>The estimated specific variance matrix.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(SOPC)
library(matrixcalc)
library(MASS)
library(psych)
library(sn)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
r &lt;- rsn(n*p,0,1)
epsilon=matrix(r,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- GulPC.SFM(data, m, A, D)
print(results)
</code></pre>

<hr>
<h2 id='IPC.SFM'>Apply the IPC method to the Skew factor model</h2><span id='topic+IPC.SFM'></span>

<h3>Description</h3>

<p>This function performs Incremental Principal Component Analysis (IPC) on the provided data. It updates the estimated factor loadings and uniquenesses as new data points are processed, calculating mean squared errors and loss metrics for comparison with true values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPC.SFM(x, m, A, D, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IPC.SFM_+3A_x">x</code></td>
<td>
<p>The data used in the IPC analysis.</p>
</td></tr>
<tr><td><code id="IPC.SFM_+3A_m">m</code></td>
<td>
<p>The number of common factors.</p>
</td></tr>
<tr><td><code id="IPC.SFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="IPC.SFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="IPC.SFM_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of metrics including:
</p>
<table role = "presentation">
<tr><td><code>Ai</code></td>
<td>
<p>Estimated factor loadings updated during the IPC analysis, a matrix of estimated factor loadings.</p>
</td></tr>
<tr><td><code>Di</code></td>
<td>
<p>Estimated uniquenesses updated during the IPC analysis, a vector of estimated uniquenesses corresponding to each variable.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error of the estimated factor loadings (Ai) compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error of the estimated uniquenesses (Di) compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for the estimated factor loadings (Ai), indicating the relative error compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for the estimated uniquenesses (Di), indicating the relative error compared to the true uniquenesses (D).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(SOPC)
library(matrixcalc)
library(MASS)
library(psych)
library(sn)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
r &lt;- rsn(n*p,0,1)
epsilon=matrix(r,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
result &lt;- IPC.SFM(data, m = m, A = A, D = D, p = p)
print(result)
</code></pre>

<hr>
<h2 id='OPC.SFM'>Apply the OPC method to the Skew factor model</h2><span id='topic+OPC.SFM'></span>

<h3>Description</h3>

<p>This function computes Online Principal Component Analysis (OPC) for the provided input data, estimating factor loadings and uniquenesses. It calculates mean squared errors and sparsity for the estimated values compared to true values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OPC.SFM(data, m = m, A, D, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OPC.SFM_+3A_data">data</code></td>
<td>
<p>A matrix of input data.</p>
</td></tr>
<tr><td><code id="OPC.SFM_+3A_m">m</code></td>
<td>
<p>The number of principal components.</p>
</td></tr>
<tr><td><code id="OPC.SFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="OPC.SFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="OPC.SFM_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>Ao</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>Do</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSEA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSED</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>The sparsity.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(SOPC)
library(matrixcalc)
library(MASS)
library(psych)
library(sn)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
r &lt;- rsn(n*p,0,1)
epsilon=matrix(r,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- OPC.SFM(data, m, A, D, p)
print(results)
</code></pre>

<hr>
<h2 id='PC1.SFM'>Apply the PC method to the Laplace factor model</h2><span id='topic+PC1.SFM'></span>

<h3>Description</h3>

<p>This function performs Principal Component Analysis (PCA) on a given data set to reduce dimensionality. It calculates the estimated values for the loadings, specific variances, and the covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PC1.SFM(data, m, A, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PC1.SFM_+3A_data">data</code></td>
<td>
<p>The total data set to be analyzed.</p>
</td></tr>
<tr><td><code id="PC1.SFM_+3A_m">m</code></td>
<td>
<p>The number of principal components to retain in the analysis.</p>
</td></tr>
<tr><td><code id="PC1.SFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="PC1.SFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>A1</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>D1</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for factor loadings.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(SOPC)
library(matrixcalc)
library(MASS)
library(psych)
library(sn)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
r &lt;- rsn(n*p,0,1)
epsilon=matrix(r,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- PC1.SFM(data, m, A, D)
print(results)
</code></pre>

<hr>
<h2 id='PC2.SFM'>Apply the PC method to the Laplace factor model</h2><span id='topic+PC2.SFM'></span>

<h3>Description</h3>

<p>This function performs Principal Component Analysis (PCA) on a given data set to reduce dimensionality. It calculates the estimated values for the loadings, specific variances, and the covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PC2.SFM(data, m, A, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PC2.SFM_+3A_data">data</code></td>
<td>
<p>The total data set to be analyzed.</p>
</td></tr>
<tr><td><code id="PC2.SFM_+3A_m">m</code></td>
<td>
<p>The number of principal components to retain in the analysis.</p>
</td></tr>
<tr><td><code id="PC2.SFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="PC2.SFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>A2</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>D2</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for factor loadings.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(SOPC)
library(matrixcalc)
library(MASS)
library(psych)
library(sn)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
r &lt;- rsn(n*p,0,1)
epsilon=matrix(r,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- PC2.SFM(data, m, A, D)
print(results)
</code></pre>

<hr>
<h2 id='PPC1.SFM'>Apply the PPC method to the Skew factor model</h2><span id='topic+PPC1.SFM'></span>

<h3>Description</h3>

<p>This function computes Perturbation Principal Component Analysis (PPC) for the provided input data, estimating factor loadings and uniquenesses. It calculates mean squared errors and loss metrics for the estimated values compared to true values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PPC1.SFM(data, m, A, D, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PPC1.SFM_+3A_data">data</code></td>
<td>
<p>A matrix of input data.</p>
</td></tr>
<tr><td><code id="PPC1.SFM_+3A_m">m</code></td>
<td>
<p>The number of principal components.</p>
</td></tr>
<tr><td><code id="PPC1.SFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="PPC1.SFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="PPC1.SFM_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>Ap</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>Dp</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for factor loadings.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(SOPC)
library(matrixcalc)
library(MASS)
library(psych)
library(sn)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
r &lt;- rsn(n*p,0,1)
epsilon=matrix(r,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- PPC1.SFM(data, m, A, D, p)
print(results)
</code></pre>

<hr>
<h2 id='PPC2.SFM'>Apply the PPC method to the Skew factor model</h2><span id='topic+PPC2.SFM'></span>

<h3>Description</h3>

<p>This function performs Projected Principal Component Analysis (PPC) on a given data set to reduce dimensionality. It calculates the estimated values for the loadings, specific variances, and the covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PPC2.SFM(data, m, A, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PPC2.SFM_+3A_data">data</code></td>
<td>
<p>The total data set to be analyzed.</p>
</td></tr>
<tr><td><code id="PPC2.SFM_+3A_m">m</code></td>
<td>
<p>The number of principal components.</p>
</td></tr>
<tr><td><code id="PPC2.SFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="PPC2.SFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>Ap2</code></td>
<td>
<p>Estimated factor loadings.</p>
</td></tr>
<tr><td><code>Dp2</code></td>
<td>
<p>Estimated uniquenesses.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error for factor loadings.</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error for uniquenesses.</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for factor loadings.</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for uniquenesses.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(SOPC)
library(matrixcalc)
library(MASS)
library(psych)
library(sn)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
r &lt;- rsn(n*p,0,1)
epsilon=matrix(r,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- PPC2.SFM(data, m, A, D)
print(results)
</code></pre>

<hr>
<h2 id='SAPC.SFM'>Stochastic Approximation Principal Component Analysis</h2><span id='topic+SAPC.SFM'></span>

<h3>Description</h3>

<p>This function calculates several metrics for the SAPC method,
including the estimated factor loadings and uniquenesses, and various
error metrics comparing the estimated matrices with the true matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SAPC.SFM(x, m, A, D, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SAPC.SFM_+3A_x">x</code></td>
<td>
<p>The data used in the SAPC analysis.</p>
</td></tr>
<tr><td><code id="SAPC.SFM_+3A_m">m</code></td>
<td>
<p>The number of common factors.</p>
</td></tr>
<tr><td><code id="SAPC.SFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="SAPC.SFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="SAPC.SFM_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of metrics including:
</p>
<table role = "presentation">
<tr><td><code>Asa</code></td>
<td>
<p>Estimated factor loadings matrix obtained from the SAPC analysis.</p>
</td></tr>
<tr><td><code>Dsa</code></td>
<td>
<p>Estimated uniquenesses vector obtained from the SAPC analysis.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error of the estimated factor loadings (Asa) compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error of the estimated uniquenesses (Dsa) compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for the estimated factor loadings (Asa), indicating the relative error compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for the estimated uniquenesses (Dsa), indicating the relative error compared to the true uniquenesses (D).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
p = 10
m = 5
n = 2000
mu = t(matrix(rep(runif(p, 0, 100), n), p, n))
mu0 = as.matrix(runif(m, 0))
sigma0 = diag(runif(m, 1))
F = matrix(MASS::mvrnorm(n, mu0, sigma0), nrow = n)
A = matrix(runif(p * m, -1, 1), nrow = p)
xi = 5
omega = 2
alpha = 5
r &lt;- sn::rsn(n * p, omega = omega, alpha = alpha) 
D0 = omega * diag(p)
D = diag(D0)
epsilon = matrix(r, nrow = n)
data = mu + F %*% t(A) + epsilon

result &lt;- SAPC.SFM(data, m = m, A = A, D = D, p = p)
print(result)
</code></pre>

<hr>
<h2 id='SFM'>The SFM function is to generate Skew Factor Models data.</h2><span id='topic+SFM'></span>

<h3>Description</h3>

<p>The function supports various distribution types for generating the data,
including: Skew-Normal Distribution, Skew-Cauchy Distribution, Skew-t Distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SFM(n, p, m, xi, omega, alpha, distribution_type)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SFM_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="SFM_+3A_p">p</code></td>
<td>
<p>Sample dimensionality.</p>
</td></tr>
<tr><td><code id="SFM_+3A_m">m</code></td>
<td>
<p>Number of factors.</p>
</td></tr>
<tr><td><code id="SFM_+3A_xi">xi</code></td>
<td>
<p>A numerical parameter used exclusively in the &quot;Skew-t&quot; distribution, representing the distribution's xi parameter.</p>
</td></tr>
<tr><td><code id="SFM_+3A_omega">omega</code></td>
<td>
<p>A numerical parameter representing the omega parameter of the distribution, which affects the degree of skewness in the distribution.</p>
</td></tr>
<tr><td><code id="SFM_+3A_alpha">alpha</code></td>
<td>
<p>A numerical parameter representing the alpha parameter of the distribution, which influences the shape of the distribution.</p>
</td></tr>
<tr><td><code id="SFM_+3A_distribution_type">distribution_type</code></td>
<td>
<p>The type of distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>A matrix of generated data.</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>A matrix representing the factor loadings.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>A diagonal matrix representing the unique variances.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
library(SOPC)
library(sn)
library(matrixcalc)
library(psych)
n &lt;- 100
p &lt;- 10
m &lt;- 5
xi &lt;- 5
omega &lt;- 2
alpha &lt;- 5
distribution_type &lt;- "Skew-Normal Distribution"
X &lt;- SFM(n, p, m, xi, omega, alpha, distribution_type)

</code></pre>

<hr>
<h2 id='SOPC.SFM'>SOPC Estimation Function</h2><span id='topic+SOPC.SFM'></span>

<h3>Description</h3>

<p>This function processes Skew Factor Model (SFM) data using the Sparse Online Principal Component (SOPC) method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SOPC.SFM(data, m, p, A, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SOPC.SFM_+3A_data">data</code></td>
<td>
<p>A numeric matrix containing the data used in the SOPC analysis.</p>
</td></tr>
<tr><td><code id="SOPC.SFM_+3A_m">m</code></td>
<td>
<p>An integer specifying the number of subsets or common factors.</p>
</td></tr>
<tr><td><code id="SOPC.SFM_+3A_p">p</code></td>
<td>
<p>An integer specifying the number of variables in the data.</p>
</td></tr>
<tr><td><code id="SOPC.SFM_+3A_a">A</code></td>
<td>
<p>A numeric matrix representing the true factor loadings.</p>
</td></tr>
<tr><td><code id="SOPC.SFM_+3A_d">D</code></td>
<td>
<p>A numeric matrix representing the true uniquenesses.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following metrics:
</p>
<table role = "presentation">
<tr><td><code>Aso</code></td>
<td>
<p>Estimated factor loadings matrix.</p>
</td></tr>
<tr><td><code>Dso</code></td>
<td>
<p>Estimated uniquenesses matrix.</p>
</td></tr>
<tr><td><code>MSEA</code></td>
<td>
<p>Mean squared error of the estimated factor loadings (Aso) compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>MSED</code></td>
<td>
<p>Mean squared error of the estimated uniquenesses (Dso) compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>LSA</code></td>
<td>
<p>Loss metric for the estimated factor loadings (Aso), indicating the relative error compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>LSD</code></td>
<td>
<p>Loss metric for the estimated uniquenesses (Dso), indicating the relative error compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>tauA</code></td>
<td>
<p>Proportion of zero factor loadings in the estimated loadings matrix (Aso), representing the sparsity.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(SOPC)
library(matrixcalc)
library(MASS)
library(psych)
library(sn)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
r &lt;- rsn(n*p,0,1)
epsilon=matrix(r,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- SOPC.SFM(data, m, p, A, D)
print(results)
</code></pre>

<hr>
<h2 id='SPC.SFM'>Apply the SPC method to the Skew factor model</h2><span id='topic+SPC.SFM'></span>

<h3>Description</h3>

<p>This function performs Sparse Principal Component Analysis (SPC) on the input data. It estimates factor loadings and uniquenesses while calculating mean squared errors and loss metrics for comparison with true values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPC.SFM(data, A, D, m, p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SPC.SFM_+3A_data">data</code></td>
<td>
<p>The data used in the SPC analysis.</p>
</td></tr>
<tr><td><code id="SPC.SFM_+3A_a">A</code></td>
<td>
<p>The true factor loadings matrix.</p>
</td></tr>
<tr><td><code id="SPC.SFM_+3A_d">D</code></td>
<td>
<p>The true uniquenesses matrix.</p>
</td></tr>
<tr><td><code id="SPC.SFM_+3A_m">m</code></td>
<td>
<p>The number of common factors.</p>
</td></tr>
<tr><td><code id="SPC.SFM_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>As</code></td>
<td>
<p>Estimated factor loadings, a matrix of estimated factor loadings from the SPC analysis.</p>
</td></tr>
<tr><td><code>Ds</code></td>
<td>
<p>Estimated uniquenesses, a vector of estimated uniquenesses corresponding to each variable.</p>
</td></tr>
<tr><td><code>MSESigmaA</code></td>
<td>
<p>Mean squared error of the estimated factor loadings (As) compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>MSESigmaD</code></td>
<td>
<p>Mean squared error of the estimated uniquenesses (Ds) compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>LSigmaA</code></td>
<td>
<p>Loss metric for the estimated factor loadings (As), indicating the relative error compared to the true loadings (A).</p>
</td></tr>
<tr><td><code>LSigmaD</code></td>
<td>
<p>Loss metric for the estimated uniquenesses (Ds), indicating the relative error compared to the true uniquenesses (D).</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Proportion of zero factor loadings in the estimated loadings matrix (As).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(SOPC)
library(matrixcalc)
library(MASS)
library(psych)
library(sn)
n=1000
p=10
m=5
mu=t(matrix(rep(runif(p,0,1000),n),p,n))
mu0=as.matrix(runif(m,0))
sigma0=diag(runif(m,1))
F=matrix(mvrnorm(n,mu0,sigma0),nrow=n)
A=matrix(runif(p*m,-1,1),nrow=p)
r &lt;- rsn(n*p,0,1)
epsilon=matrix(r,nrow=n)
D=diag(t(epsilon)%*%epsilon)
data=mu+F%*%t(A)+epsilon
results &lt;- SPC.SFM(data, A, D, m, p)
print(results)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
