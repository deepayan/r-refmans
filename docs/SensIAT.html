<!DOCTYPE html><html lang="en-US"><head><title>Help for package SensIAT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SensIAT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SensIAT-package'><p>SensIAT: Sensitivity Analysis for Irregular Assessment Times</p></a></li>
<li><a href='#Cond_mean_fn'><p>Estimate Subject Predicted Mean Outcome</p></a></li>
<li><a href='#fit_SensIAT_fulldata_model'><p>Produce fitted model for group (treatment or control)</p></a></li>
<li><a href='#pcori_conditional_means'><p>Compute Conditional Means</p></a></li>
<li><a href='#pcori_control'><p>Control Parameters for Fitting the within Group Model</p></a></li>
<li><a href='#pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix'><p>Runs an optimized implementation of the <code>compute_influence_term_2_quadv_sim_via_matrix</code></p>
function.</a></li>
<li><a href='#pcoriaccel_estimate_pmf'><p>Directly estimate the probability mass function of Y.</p></a></li>
<li><a href='#pcoriaccel_evaluate_basis'><p>Compiled version of <code>evaluate_basis()</code> function</p></a></li>
<li><a href='#pcoriaccel_integrate_simp'><p>Integrate function using adaptive Simpson quadrature.</p></a></li>
<li><a href='#pcoriaccel_NW'><p>Runs an optimized implementation of the &quot;NW&quot; function.</p></a></li>
<li><a href='#pcoriaccel_NW_basic'><p>Runs a <em>basic</em> implementation of the &quot;NW&quot; function with the &quot;K2_Biweight&quot; kernel, just as a</p>
proof-of-concept.</a></li>
<li><a href='#predict.SensIAT_fulldata_model'><p>Predict mean and variance of the outcome for a <code>SensIAT</code> within-group model</p></a></li>
<li><a href='#SensIAT_example_data'><p>SensIAT Example Data</p></a></li>
<li><a href='#SensIAT_jackknife'><p>Estimate response with jackknife resampling</p></a></li>
<li><a href='#SensIAT_sim_outcome_modeler'><p>Outcome Modeler for <code>SensIAT</code> Single Index Model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Sensitivity Analysis for Irregular Assessment Times</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Sensitivity analysis for trials with irregular and informative 
    assessment times, based on a new influence function-based, augmented 
    inverse intensity-weighted estimator.</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>assertthat, dplyr, glue, KernSmooth, MASS, methods,
orthogonalsplinebasis, pracma, purrr, Rcpp (&ge; 1.0.12), rlang,
splines, stats, survival, tibble, tidyr, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dfoptim, inline, progress, spelling, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.4.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++17</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/UofUEpiBio/SensIAT">https://github.com/UofUEpiBio/SensIAT</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/UofUEpiBio/SensIAT/issues">https://github.com/UofUEpiBio/SensIAT/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-15 23:24:00 UTC; u0092104</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew Redd <a href="https://orcid.org/0000-0002-6149-2438"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Yujing Gao [aut],
  Shu Yang [aut],
  Bonnie Smith [aut],
  Agatha Mallett [ctb, ctr],
  Daniel Scharfstein
    <a href="https://orcid.org/0000-0001-7482-9653"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [pdr, aut],
  University of Utah [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Redd &lt;andrew.redd@hsc.utah.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-17 16:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='SensIAT-package'>SensIAT: Sensitivity Analysis for Irregular Assessment Times</h2><span id='topic+SensIAT'></span><span id='topic+SensIAT-package'></span>

<h3>Description</h3>

<p>Sensitivity analysis for trials with irregular and informative assessment times, based on a new influence function-based, augmented inverse intensity-weighted estimator.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Andrew Redd <a href="mailto:andrew.redd@hsc.utah.edu">andrew.redd@hsc.utah.edu</a> (<a href="https://orcid.org/0000-0002-6149-2438">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Yujing Gao <a href="mailto:ygao39@ncsu.edu">ygao39@ncsu.edu</a>
</p>
</li>
<li><p> Shu Yang <a href="mailto:syang24@ncsu.edu">syang24@ncsu.edu</a>
</p>
</li>
<li><p> Bonnie Smith <a href="mailto:bsmit179@jhmi.edu">bsmit179@jhmi.edu</a>
</p>
</li>
<li><p> Daniel Scharfstein <a href="mailto:daniel.scharfstein@hsc.utah.edu">daniel.scharfstein@hsc.utah.edu</a> (<a href="https://orcid.org/0000-0001-7482-9653">ORCID</a>) [project director]
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Agatha Mallett <a href="mailto:agatha@geometrian.com">agatha@geometrian.com</a> [contributor, contractor]
</p>
</li>
<li><p> University of Utah [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/UofUEpiBio/SensIAT">https://github.com/UofUEpiBio/SensIAT</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/UofUEpiBio/SensIAT/issues">https://github.com/UofUEpiBio/SensIAT/issues</a>
</p>
</li></ul>


<hr>
<h2 id='Cond_mean_fn'>Estimate Subject Predicted Mean Outcome</h2><span id='topic+Cond_mean_fn'></span>

<h3>Description</h3>

<p>This function is used to get a subject's predicted mean outcome under a given
sensitivity parameter value <code>alpha</code>.
It is specific to the outcome model that we used on the
ARC data (which was negative binomial), and specific to the
tilting function alpha*Y(t), so would need to be changed if
using a different outcome model or different tilting function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cond_mean_fn(mu, theta, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Cond_mean_fn_+3A_mu">mu</code></td>
<td>
<p>mean</p>
</td></tr>
<tr><td><code id="Cond_mean_fn_+3A_theta">theta</code></td>
<td>
<p>size</p>
</td></tr>
<tr><td><code id="Cond_mean_fn_+3A_alpha">alpha</code></td>
<td>
<p>sensitivity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing
<code class="reqn">\frac{E[ Y exp(\alpha Y) ]}{E[ exp(\alpha Y)]}</code>
and <code style="white-space: pre;">&#8288;$E[ exp(\alpha Y) ]$&#8288;</code>
for Y a (truncated version of) a negative binomial having mean <code>mu</code> and
size <code>theta</code>.
</p>

<hr>
<h2 id='fit_SensIAT_fulldata_model'>Produce fitted model for group (treatment or control)</h2><span id='topic+fit_SensIAT_fulldata_model'></span><span id='topic+fit_SensIAT_within_group_model'></span>

<h3>Description</h3>

<p>Produces a fitted model that may be used to produce estimates of mean and
variance for the given group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_SensIAT_fulldata_model(data, trt, ...)

fit_SensIAT_within_group_model(
  group.data,
  outcome_modeler,
  knots,
  id.var,
  outcome.var,
  time.var,
  alpha = 0,
  intensity.covariates = ~.,
  outcome.covariates = ~. - 1,
  End = max({
     {
         time.var
     }
 }, na.rm = TRUE) + 1,
  integration.tolerance = .Machine$double.eps^(1/3),
  intensity.bandwidth = NULL,
  ...,
  influence.args = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_data">data</code></td>
<td>
<p>the full data set.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_trt">trt</code></td>
<td>
<p>an expression that determine what is treated as the treatment.
Everything not treatment is considered control.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_...">...</code></td>
<td>
<p>add parameters as needed or use this to pass forward into the
outcome_modeler.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_group.data">group.data</code></td>
<td>
<p>The data for the group that is being analyzed.
Preferably passed in as a single <code>tibble</code> that internally is
subsetted/filtered as needed.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_outcome_modeler">outcome_modeler</code></td>
<td>
<p>A separate function that may be swapped out to switch
between negative-binomial, single index model, or another we will
dream up in the future.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_knots">knots</code></td>
<td>
<p>knot locations for defining the spline basis.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_id.var">id.var</code></td>
<td>
<p>The variable that identifies the patient.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_outcome.var">outcome.var</code></td>
<td>
<p>The variable that contains the outcome.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_time.var">time.var</code></td>
<td>
<p>The variable that contains the time.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_alpha">alpha</code></td>
<td>
<p>The sensitivity parameter.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_intensity.covariates">intensity.covariates</code></td>
<td>
<p>A formula representing modifications to the intensity model.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_outcome.covariates">outcome.covariates</code></td>
<td>
<p>A formula representing modifications to the outcome model.  The default removes the intercept term.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_end">End</code></td>
<td>
<p>The end time for this data analysis, we need to set the default value as the
max value of the time</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_integration.tolerance">integration.tolerance</code></td>
<td>
<p>The tolerance for the integration.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_intensity.bandwidth">intensity.bandwidth</code></td>
<td>
<p>The bandwidth for the intensity model kernel.</p>
</td></tr>
<tr><td><code id="fit_SensIAT_fulldata_model_+3A_influence.args">influence.args</code></td>
<td>
<p>A list of additional arguments to pass to the influence function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function should be agnostic to whether it is being provided a
treatment or control group.
</p>


<h3>Value</h3>

<p>a list with class <code>SensIAT-fulldata-fitted-model</code> with two components,
<code>control</code> and <code>treatment</code>, each of which is an independently fitted
<code>SensIAT-within-group-fitted-model</code> fit with the fit_within_group_model
function.
</p>
<p>Should return everything needed to define the fit of the model.
This can then be used for producing the estimates of mean, variance,
and in turn treatment effect.  For the full data model a list with two
models one each for the treatment and control groups.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>fit_SensIAT_fulldata_model()</code>: Fit the sensitivity analysis for both treatment and control groups.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
model &lt;-
    fit_SensIAT_within_group_model(
        group.data = SensIAT_example_data,
        outcome_modeler = SensIAT_sim_outcome_modeler,
        alpha = c(-0.6, -0.3, 0, 0.3, 0.6),
        id.var = Subject_ID,
        outcome.var = Outcome,
        time.var = Time,
        End = 830,
        knots = c(60,60,60,60,260,460,460,460,460),
    )

</code></pre>

<hr>
<h2 id='pcori_conditional_means'>Compute Conditional Means</h2><span id='topic+pcori_conditional_means'></span>

<h3>Description</h3>

<p>Compute Conditional Means
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcori_conditional_means(model, alpha = 0, new.data = model.frame(model), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcori_conditional_means_+3A_model">model</code></td>
<td>
<p>An object of class <code>SensIAT::outcome-model</code></p>
</td></tr>
<tr><td><code id="pcori_conditional_means_+3A_alpha">alpha</code></td>
<td>
<p>Sensitivity parameter</p>
</td></tr>
<tr><td><code id="pcori_conditional_means_+3A_new.data">new.data</code></td>
<td>
<p>Data to compute conditional means for, defaults to the model frame for the fitted model.</p>
</td></tr>
<tr><td><code id="pcori_conditional_means_+3A_...">...</code></td>
<td>
<p>passed onto methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute the conditional expectations needed for predictions in the models.
Three additional values/expectations are computed:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;$E \big[ Y(t) \exp \{  \alpha Y(t) \}   | A(t)=1, \bar{O}(t) \big]$&#8288;</code>, returned as <code>E_y_past</code>, and
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$E \big[ \exp \{ \alpha Y(t) \} \  | A(t)=1, \bar{O}(t) \big]$&#8288;</code>, returned as <code>E_exp_alphaY</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>The <code>new.data</code> frame with additional columns <code>E_Y_past</code>, and <code>E_exp_alphaY</code> appended.
</p>

<hr>
<h2 id='pcori_control'>Control Parameters for Fitting the within Group Model</h2><span id='topic+pcori_control'></span>

<h3>Description</h3>

<p>Control Parameters for Fitting the within Group Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcori_control(
  integration.method = c("quadvcpp", "quadv", "linear", "numerical", "piecewise"),
  intensity.bandwidth = NULL,
  resolution = 1000,
  resolution.within.period = 50,
  tol = .Machine$double.eps^(1/4),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcori_control_+3A_integration.method">integration.method</code></td>
<td>
<p>Method for integration when computing the second influence term.</p>
</td></tr>
<tr><td><code id="pcori_control_+3A_intensity.bandwidth">intensity.bandwidth</code></td>
<td>
<p>The bandwidth for the intensity model.</p>
</td></tr>
<tr><td><code id="pcori_control_+3A_resolution">resolution</code></td>
<td>
<p>The number of points to use for numerical integration.</p>
</td></tr>
<tr><td><code id="pcori_control_+3A_resolution.within.period">resolution.within.period</code></td>
<td>
<p>The number of points to use for numerical integration within a period.</p>
</td></tr>
<tr><td><code id="pcori_control_+3A_tol">tol</code></td>
<td>
<p>The tolerance for numerical integration.</p>
</td></tr>
<tr><td><code id="pcori_control_+3A_...">...</code></td>
<td>
<p>Currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of control parameters.
</p>

<hr>
<h2 id='pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix'>Runs an optimized implementation of the <code>compute_influence_term_2_quadv_sim_via_matrix</code>
function.</h2><span id='topic+pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix'></span>

<h3>Description</h3>

<p>Runs an optimized implementation of the <code>compute_influence_term_2_quadv_sim_via_matrix</code>
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix(
  X,
  Y,
  times,
  individual_X,
  x_slope,
  alpha,
  beta,
  spline_basis,
  bandwidth,
  tol = 0.0001220703,
  kernel = "K2_Biweight"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix_+3A_x">X</code></td>
<td>
<p>Matrix of all covariates, transformed as necessary by model</p>
</td></tr>
<tr><td><code id="pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix_+3A_y">Y</code></td>
<td>
<p>Vector of all outcomes (same length as a column of <code>X</code>)</p>
</td></tr>
<tr><td><code id="pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix_+3A_times">times</code></td>
<td>
<p>Vector of observation times for individual</p>
</td></tr>
<tr><td><code id="pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix_+3A_individual_x">individual_X</code></td>
<td>
<p>Matrix of covariates for individual rows correspond to times prepared for
inferences for integration.</p>
</td></tr>
<tr><td><code id="pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix_+3A_x_slope">x_slope</code></td>
<td>
<p>Vector of numeric(length(beta)) indicating how</p>
</td></tr>
<tr><td><code id="pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix_+3A_alpha">alpha</code></td>
<td>
<p>Vector of sensitivity parameters</p>
</td></tr>
<tr><td><code id="pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix_+3A_beta">beta</code></td>
<td>
<p>Vector of coefficients of the outcome model</p>
</td></tr>
<tr><td><code id="pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix_+3A_spline_basis">spline_basis</code></td>
<td>
<p>Spline basis object (<code>orthogonalsplinebasis::SplineBasis</code>)</p>
</td></tr>
<tr><td><code id="pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix_+3A_bandwidth">bandwidth</code></td>
<td>
<p>Bandwidth for the kernel density estimate of the outcome model.</p>
</td></tr>
<tr><td><code id="pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix_+3A_tol">tol</code></td>
<td>
<p>Tolerance for integration</p>
</td></tr>
<tr><td><code id="pcoriaccel_compute_influence_term_2_quadv_sim_via_matrix_+3A_kernel">kernel</code></td>
<td>
<p>Kernel function to use for the kernel density estimate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>integration result
</p>

<hr>
<h2 id='pcoriaccel_estimate_pmf'>Directly estimate the probability mass function of Y.</h2><span id='topic+pcoriaccel_estimate_pmf'></span>

<h3>Description</h3>

<p>Directly estimate the probability mass function of Y.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcoriaccel_estimate_pmf(Xb, Y, xi, y_seq, h, kernel = "K2_Biweight")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcoriaccel_estimate_pmf_+3A_xb">Xb</code></td>
<td>
<p>Numeric vector of individual linear predictors from the data</p>
</td></tr>
<tr><td><code id="pcoriaccel_estimate_pmf_+3A_y">Y</code></td>
<td>
<p>Numeric vector of individual responses from the data</p>
</td></tr>
<tr><td><code id="pcoriaccel_estimate_pmf_+3A_xi">xi</code></td>
<td>
<p>value of the individuals linear predictor at the point of estimation</p>
</td></tr>
<tr><td><code id="pcoriaccel_estimate_pmf_+3A_y_seq">y_seq</code></td>
<td>
<p>Numeric vector of unique values of <code>Y</code>.</p>
</td></tr>
<tr><td><code id="pcoriaccel_estimate_pmf_+3A_h">h</code></td>
<td>
<p>bandwidth of the kernel</p>
</td></tr>
<tr><td><code id="pcoriaccel_estimate_pmf_+3A_kernel">kernel</code></td>
<td>
<p>character string specifying the kernel to use, either <code>"dnorm"</code>, <code>"K2_Biweight"</code>, or <code>"K4_Biweight"</code></p>
</td></tr>
</table>

<hr>
<h2 id='pcoriaccel_evaluate_basis'>Compiled version of <code>evaluate_basis()</code> function</h2><span id='topic+pcoriaccel_evaluate_basis'></span>

<h3>Description</h3>

<p>Compiled version of <code>evaluate_basis()</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcoriaccel_evaluate_basis(spline_basis, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcoriaccel_evaluate_basis_+3A_spline_basis">spline_basis</code></td>
<td>
<p>The spline basis, S4 class <code>orthogonalsplinebasis::SplineBasis</code></p>
</td></tr>
<tr><td><code id="pcoriaccel_evaluate_basis_+3A_x">x</code></td>
<td>
<p>The point to evaluate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of the basis functions evaluated at x.
</p>

<hr>
<h2 id='pcoriaccel_integrate_simp'>Integrate function using adaptive Simpson quadrature.</h2><span id='topic+pcoriaccel_integrate_simp'></span>

<h3>Description</h3>

<p>Integrate function using adaptive Simpson quadrature.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcoriaccel_integrate_simp(integrand, lo, hi, tol = 1.490116e-08)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcoriaccel_integrate_simp_+3A_integrand">integrand</code></td>
<td>
<p>The integrand, must take scalar argument, may return scalar, vector, or matrix.</p>
</td></tr>
<tr><td><code id="pcoriaccel_integrate_simp_+3A_lo">lo</code></td>
<td>
<p>Lower integration bound</p>
</td></tr>
<tr><td><code id="pcoriaccel_integrate_simp_+3A_hi">hi</code></td>
<td>
<p>Upper integration bound</p>
</td></tr>
<tr><td><code id="pcoriaccel_integrate_simp_+3A_tol">tol</code></td>
<td>
<p>Tolerance for integration, default <code>.Machine$double.eps^(1/2)</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>integration result, list with elements <code style="white-space: pre;">&#8288;$Q&#8288;</code> (the integral estimate), <code style="white-space: pre;">&#8288;$fcnt&#8288;</code> (the number
of function evaluations), and <code style="white-space: pre;">&#8288;$estim.prec&#8288;</code> (a (pessimistic) estimate of the precision).
</p>

<hr>
<h2 id='pcoriaccel_NW'>Runs an optimized implementation of the &quot;NW&quot; function.</h2><span id='topic+pcoriaccel_NW'></span>

<h3>Description</h3>

<p>Runs an optimized implementation of the &quot;NW&quot; function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcoriaccel_NW(Xb, Y, xb, y_seq, h, kernel = "K2_Biweight")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcoriaccel_NW_+3A_xb">Xb</code></td>
<td>
<p>a vector (expected to be about 500 elements)</p>
</td></tr>
<tr><td><code id="pcoriaccel_NW_+3A_y">Y</code></td>
<td>
<p>a vector (same size as <code>Xb</code>)</p>
</td></tr>
<tr><td><code id="pcoriaccel_NW_+3A_xb">xb</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="pcoriaccel_NW_+3A_y_seq">y_seq</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="pcoriaccel_NW_+3A_h">h</code></td>
<td>
<p>a scalar, the bandwidth of kernel</p>
</td></tr>
<tr><td><code id="pcoriaccel_NW_+3A_kernel">kernel</code></td>
<td>
<p>a string, denoting the kernel function to use, either <code>"dnorm"</code>, <code>"K2_Biweight"</code>, or <code>"K4_Biweight"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the same size as <code>xb</code> by <code>y_seq</code>.
</p>

<hr>
<h2 id='pcoriaccel_NW_basic'>Runs a <em>basic</em> implementation of the &quot;NW&quot; function with the &quot;K2_Biweight&quot; kernel, just as a
proof-of-concept.</h2><span id='topic+pcoriaccel_NW_basic'></span>

<h3>Description</h3>

<p>Runs a <em>basic</em> implementation of the &quot;NW&quot; function with the &quot;K2_Biweight&quot; kernel, just as a
proof-of-concept.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcoriaccel_NW_basic(Xb, Y, xb, y_seq, h)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcoriaccel_NW_basic_+3A_xb">Xb</code></td>
<td>
<p>a vector (expected to be about 500 elements)</p>
</td></tr>
<tr><td><code id="pcoriaccel_NW_basic_+3A_y">Y</code></td>
<td>
<p>a vector (same size as <code>Xb</code>)</p>
</td></tr>
<tr><td><code id="pcoriaccel_NW_basic_+3A_xb">xb</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="pcoriaccel_NW_basic_+3A_y_seq">y_seq</code></td>
<td>
<p>a vector</p>
</td></tr>
<tr><td><code id="pcoriaccel_NW_basic_+3A_h">h</code></td>
<td>
<p>a scalar, the bandwidth of kernel</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the same size as <code>xb</code> by <code>y_seq</code>.
</p>

<hr>
<h2 id='predict.SensIAT_fulldata_model'>Predict mean and variance of the outcome for a <code>SensIAT</code> within-group model</h2><span id='topic+predict.SensIAT_fulldata_model'></span><span id='topic+predict.SensIAT_within_group_model'></span>

<h3>Description</h3>

<p>Predict mean and variance of the outcome for a <code>SensIAT</code> within-group model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SensIAT_fulldata_model'
predict(object, time, ...)

## S3 method for class 'SensIAT_within_group_model'
predict(object, time, include.var = TRUE, ..., base = object$base)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.SensIAT_fulldata_model_+3A_object">object</code></td>
<td>
<p>SensIAT_within_group_model object</p>
</td></tr>
<tr><td><code id="predict.SensIAT_fulldata_model_+3A_time">time</code></td>
<td>
<p>Time points of interest</p>
</td></tr>
<tr><td><code id="predict.SensIAT_fulldata_model_+3A_...">...</code></td>
<td>
<p>Currently ignored.</p>
</td></tr>
<tr><td><code id="predict.SensIAT_fulldata_model_+3A_include.var">include.var</code></td>
<td>
<p>Logical. If TRUE, the variance of the outcome is also returned</p>
</td></tr>
<tr><td><code id="predict.SensIAT_fulldata_model_+3A_base">base</code></td>
<td>
<p>A <code>SplineBasis</code> object used to evaluate the basis functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If include.var is TRUE, a <code>tibble</code> with columns time, mean, and var is returned.
otherwise if include.var is FALSE, only the mean vector is returned.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>predict(SensIAT_fulldata_model)</code>: For each combination of <code>time</code> and <code>alpha</code> estimate the mean response and
variance for each group as well as estimate the mean treatment effect and
variance.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
model &lt;-
    fit_SensIAT_within_group_model(
        group.data = SensIAT_example_data,
        outcome_modeler = SensIAT_sim_outcome_modeler,
        alpha = c(-0.6, -0.3, 0, 0.3, 0.6),
        id.var = Subject_ID,
        outcome.var = Outcome,
        time.var = Time,
        End = 830,
        knots = c(60,60,60,60,260,460,460,460,460),
    )
predict(model, time = c(90, 180))

</code></pre>

<hr>
<h2 id='SensIAT_example_data'>SensIAT Example Data</h2><span id='topic+SensIAT_example_data'></span>

<h3>Description</h3>

<p>A simulated dataset for use in the SensIAT tutorial, testing and documentation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SensIAT_example_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 779 rows and 4 variables consisting of 200
simulated patients.  Each row in the data represents a visit for the patient.
The columns are:
</p>

<dl>
<dt>Subject_ID</dt><dd><p>A unique identifier for each patient.</p>
</dd>
<dt>Visit</dt><dd><p>The ordinal number of the visit for the patient.  Baseline observation is 0.</p>
</dd>
<dt>Time</dt><dd><p>The time of the visit in days, since baseline.</p>
</dd>
<dt>Outcome</dt><dd><p>The outcome of interest.</p>
</dd>
</dl>


<hr>
<h2 id='SensIAT_jackknife'>Estimate response with jackknife resampling</h2><span id='topic+SensIAT_jackknife'></span>

<h3>Description</h3>

<p>Estimate response with jackknife resampling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SensIAT_jackknife(original.object, time, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SensIAT_jackknife_+3A_original.object">original.object</code></td>
<td>
<p>A SensIAT_within_group_model object.</p>
</td></tr>
<tr><td><code id="SensIAT_jackknife_+3A_time">time</code></td>
<td>
<p>Time points for which to estimate the response.</p>
</td></tr>
<tr><td><code id="SensIAT_jackknife_+3A_...">...</code></td>
<td>
<p>currently ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tibble</code> with columns alpha, time, jackknife_mean, and jackknife_var,
where jackknife_mean is the mean of the jackknife estimates and jackknife_var
is the estimated variances of the response at the given time points for the
specified alpha values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
original.object &lt;-
fit_SensIAT_within_group_model(
    group.data = SensIAT_example_data,
    outcome_modeler = SensIAT_sim_outcome_modeler,
    alpha = c(-0.6, -0.3, 0, 0.3, 0.6),
    id.var = Subject_ID,
    outcome.var = Outcome,
    time.var = Time,
    intensity.bandwidth = 30,
    knots = c(60,60,60,60,260,460,460,460,460),
    End = 830
)
jackknife.estimates &lt;- SensIAT_jackknife(original.object, time = c(90, 180, 270, 360, 450))

## End(Not run)
</code></pre>

<hr>
<h2 id='SensIAT_sim_outcome_modeler'>Outcome Modeler for <code>SensIAT</code> Single Index Model.</h2><span id='topic+SensIAT_sim_outcome_modeler'></span>

<h3>Description</h3>

<p>Outcome Modeler for <code>SensIAT</code> Single Index Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SensIAT_sim_outcome_modeler(
  formula,
  data,
  kernel = "K2_Biweight",
  method = "nmk",
  id = ..id..,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SensIAT_sim_outcome_modeler_+3A_formula">formula</code></td>
<td>
<p>The outcome model formula</p>
</td></tr>
<tr><td><code id="SensIAT_sim_outcome_modeler_+3A_data">data</code></td>
<td>
<p>The data to fit the outcome model to.
Should only include follow-up data, i.e. time &gt; 0.</p>
</td></tr>
<tr><td><code id="SensIAT_sim_outcome_modeler_+3A_kernel">kernel</code></td>
<td>
<p>The kernel to use for the outcome model.</p>
</td></tr>
<tr><td><code id="SensIAT_sim_outcome_modeler_+3A_method">method</code></td>
<td>
<p>The optimization method to use for the outcome model, either <code>"optim"</code>, <code>"nlminb"</code>, or <code>"nmk"</code>.</p>
</td></tr>
<tr><td><code id="SensIAT_sim_outcome_modeler_+3A_id">id</code></td>
<td>
<p>The patient identifier variable for the data.</p>
</td></tr>
<tr><td><code id="SensIAT_sim_outcome_modeler_+3A_...">...</code></td>
<td>
<p>Currently ignored, included for future compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>SensIAT::Single-index-outcome-model</code> which contains the outcome model portion.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
model &lt;-
    fit_SensIAT_within_group_model(
        group.data = SensIAT_example_data,
        outcome_modeler = SensIAT_sim_outcome_modeler,
        alpha = c(-0.6, -0.3, 0, 0.3, 0.6),
        id.var = Subject_ID,
        outcome.var = Outcome,
        time.var = Time,
        End = 830,
        knots = c(60,60,60,60,260,460,460,460,460),
    )

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
