<!DOCTYPE html><html lang="en"><head><title>Help for package influence.ME</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {influence.ME}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#influence.ME-package'>
<p>Influence.ME: Tools for detecting influential data in mixed effects models</p></a></li>
<li><a href='#cooks.distance.estex'><p>Compute the Cook's distance measure of influential data on mixed effects models</p></a></li>
<li><a href='#dfbetas.estex'><p>Compute the DFBETAS measure of influential data</p></a></li>
<li><a href='#exclude.influence'><p>Exclude the influence of a grouped set of observations in mixed effects models.</p></a></li>
<li><a href='#grouping.levels'><p>Returns the levels of a grouping factor in a mixed effects regression model</p></a></li>
<li><a href='#influence.mer'><p>influence returns mixed model estimates, iteratively excluding the influence of data nested within single grouping factors.</p></a></li>
<li><a href='#pchange'><p>Compute the percentage change, as measure of influential data</p></a></li>
<li><a href='#plot.estex'><p>Dotplot visualization of measures of influence</p></a></li>
<li><a href='#school23'><p>Math test performance in 23 schools</p></a></li>
<li><a href='#se.fixef'><p>Standard errors of fixed estimates</p></a></li>
<li><a href='#sigtest'><p>Test for changes in the level of statistical significance resulting from the deletion of potentially influential observations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Detecting Influential Data in Mixed Effects Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9-9</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-06-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Rense Nieuwenhuis, Ben Pelzer, Manfred te Grotenhuis</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rense Nieuwenhuis &lt;rense.nieuwenhuis@sofi.su.se&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a collection of tools for
        detecting influential cases in generalized mixed effects
        models. It analyses models that were estimated using 'lme4'. The
        basic rationale behind identifying influential data is that
        when single units are omitted from the data, models
        based on these data should not produce substantially different
        estimates. To standardize the assessment of how influential a
        (single group of) observation(s) is, several measures of
        influence are common practice, such as Cook's Distance. 
        In addition, we provide a measure of percentage change of the fixed point 
        estimates and a simple procedure to detect changing levels of significance.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.rensenieuwenhuis.nl/r-project/influenceme/">http://www.rensenieuwenhuis.nl/r-project/influenceme/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 2.15.0), lme4(&ge; 1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix(&ge; 1.0), lattice</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-06-07 06:56:57 UTC; rensenieuwenhuis</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-06-07 07:05:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='influence.ME-package'>
Influence.ME: Tools for detecting influential data in mixed effects models
</h2><span id='topic+influence.ME-package'></span><span id='topic+influence.ME'></span>

<h3>Description</h3>

<p>influence.ME calculates measures of influence for mixed effects models estimated with lme4. The basic rationale behind measuring influential cases is that when iteratively single units are omitted from the data, models based on these data should not produce substantially different estimates. To standardize the assessment of how influential a (single group of) observation(s) is, several measures of influence are common practice. First, DFBETAS is a standardized measure of the absolute difference between the estimate with a particular case included and the estimate without that particular case. Second, Cook's distance provides an overall measurement of the change in all parameter estimates, or a selection thereof. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> influence.ME</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.9.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2013-01-15</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Calculating measures of influential data on a mixed effects regression model entails the re-estimation of this model for each set of potentially influential data separately. The influence() function does this, and returns the altered estimates resulting from each re-estimation. These altered estimates can subsequently be entered to the <code><a href="#topic+cooks.distance">cooks.distance</a></code> and <code><a href="#topic+dfbetas">dfbetas</a></code> methods, to calculate Cook's Distance and the DFBETAS (standardized difference of the beta) measures.
</p>


<h3>Author(s)</h3>

<p>Rense Nieuwenhuis, Ben Pelzer, Manfred te Grotenhuis
</p>
<p>Maintainer: Rense Nieuwenhuis &lt;r.nieuwenhuis@utwente.nl&gt;
</p>


<h3>References</h3>

<p>Belsley, D.A., Kuh, E. &amp; Welsch, R.E. (1980). <em>Regression Diagnostics. Identifying Influential Data and Source of Collinearity</em>. Wiley. 
</p>
<p>Snijders, T.A. &amp; Bosker, R.J. (1999). <em>Multilevel Analysis, an introduction to basic and advanced multilevel modeling</em>. Sage. 
</p>
<p>Van der Meer, T., Te Grotenhuis, M., &amp; Pelzer, B. (2010). <em>Influential Cases in Multilevel Modeling: A Methodological Comment</em>. American Sociological Review, 75(1), 173-178.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+influence">influence</a></code>,
<code><a href="#topic+cooks.distance.estex">cooks.distance.estex</a></code>, <code><a href="#topic+dfbetas.estex">dfbetas.estex</a></code>, 
<code><a href="#topic+pchange">pchange</a></code>, <code><a href="#topic+sigtest">sigtest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(school23)

model.a &lt;- lmer(math ~ structure + SES  + (1 | school.ID), data=school23)
alt.est.a &lt;- influence(model.a, "school.ID")
 
model.b &lt;- exclude.influence(model.a, "school.ID", "7472")
alt.est.b &lt;- influence(model.b, "school.ID")

cooks.distance(alt.est.b)

model.c &lt;- exclude.influence(model.b, "school.ID", "54344")
alt.est.c &lt;- influence(model.c, "school.ID")

cooks.distance(alt.est.c)

## End(Not run)
</code></pre>

<hr>
<h2 id='cooks.distance.estex'>Compute the Cook's distance measure of influential data on mixed effects models</h2><span id='topic+cooks.distance.estex'></span><span id='topic+cooks.distance'></span>

<h3>Description</h3>

<p>Cook's Distance is a measure indicating to what extent model parameters are influenced by (a set of) influential data on which the model is based. This function computes the Cook's distance based on the information returned by the influence() function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'estex'
cooks.distance(model, parameters=0, sort=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cooks.distance.estex_+3A_model">model</code></td>
<td>
<p>An object as returned by the influence() function, containing the altered estimates of a mixed effects regression model</p>
</td></tr>
<tr><td><code id="cooks.distance.estex_+3A_parameters">parameters</code></td>
<td>
<p>Used to define a selection of parameters. If parameters=0 (default), Cook's Distance is calculated based on all parameters in the model</p>
</td></tr>
<tr><td><code id="cooks.distance.estex_+3A_sort">sort</code></td>
<td>
<p>If <code>sort=TRUE</code> the values of Cook's Distance are ordered based on magnitude. If <code>sort=FALSE</code> (default) no sorting takes place.</p>
</td></tr>
<tr><td><code id="cooks.distance.estex_+3A_...">...</code></td>
<td>
<p>Currently not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A one-column matrix is returned containing values for the Cook's Distance based on the selected (fixed) parameters of the model. Each row shows the Cook's Distance associated with each evaluated set of influential data (data nested within each evaluated level of the grouping factor).
</p>


<h3>Author(s)</h3>

<p>Rense Nieuwenhuis, Ben Pelzer, Manfred te Grotenhuis</p>


<h3>References</h3>

<p>Nieuwenhuis, R., Te Grotenhuis, M., &amp; Pelzer, B. (2012). Influence.ME: tools for detecting influential data in mixed effects models. <em>R Journal</em>, 4(2), 38???47.
</p>
<p>Belsley, D.A., Kuh, E. &amp; Welsch, R.E. (1980). <em>Regression Diagnostics. Identifying Influential Data and Source of Collinearity</em>. Wiley. 
</p>
<p>Snijders, T.A. &amp; Bosker, R.J. (1999). <em>Multilevel Analysis, an introduction to basic and advanced multilevel modeling</em>. Sage. 
</p>
<p>Van der Meer, T., Te Grotenhuis, M., &amp; Pelzer, B. (2010). <em>Influential Cases in Multilevel Modeling: A Methodological Comment</em>. American Sociological Review, 75(1), 173-178.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+influence">influence</a></code>, <code><a href="#topic+dfbetas">dfbetas</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(school23)
model &lt;- lmer(math ~ structure + SES  + (1 | school.ID), data=school23)

alt.est &lt;- influence(model, group="school.ID")
cooks.distance(alt.est)

## End(Not run)
</code></pre>

<hr>
<h2 id='dfbetas.estex'>Compute the DFBETAS measure of influential data</h2><span id='topic+dfbetas.estex'></span><span id='topic+dfbetas'></span>

<h3>Description</h3>

<p>DFBETAS (standardized difference of the beta) is a measure that standardizes the absolute difference in parameter estimates between a (mixed effects) regression model based on a full set of data, and a model from which a (potentially influential) subset of data is removed. A value for DFBETAS is calculated for each parameter in the model separately. This function computes the DFBETAS based on the information returned by the influence() function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'estex'
dfbetas(model, parameters = 0, sort=FALSE, to.sort=NA, abs=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dfbetas.estex_+3A_model">model</code></td>
<td>
<p>An object as returned by the influence() function, containing the altered estimates of a mixed effects regression model</p>
</td></tr>
<tr><td><code id="dfbetas.estex_+3A_parameters">parameters</code></td>
<td>
<p>Used to define a selection of parameters. If parameters=0 (default), DFBETAS is calculated for all parameters in the model</p>
</td></tr>
<tr><td><code id="dfbetas.estex_+3A_sort">sort</code></td>
<td>
<p>If <code>sort=TRUE</code> the values of DFBETAS are ordered based on magnitude. If <code>sort=FALSE</code> (default) no sorting takes place.</p>
</td></tr>
<tr><td><code id="dfbetas.estex_+3A_to.sort">to.sort</code></td>
<td>
<p>Specify on which variable the DFBETAS must be sorted. If only one variable present (either in the model, or due to the selection specified in <code>parameters</code>), this parameter can be omitted. If DFBETAS is calculated for multiple variables, and sort=TRUE, specification of <code>to.sort</code> is required, or an error is returned.</p>
</td></tr>
<tr><td><code id="dfbetas.estex_+3A_abs">abs</code></td>
<td>
<p>If <code>abs=TRUE</code>, the absolute values of DFBETAS are returned, while if <code>abs=FALSE</code> (default), both positive and negative values are possible. If both <code>abs=TRUE</code> and <code>sort=TRUE</code>, the <code>abs</code> parameters precedes the <code>sort</code> parameter, and thus the absolute values of DFBETAS are sorted.</p>
</td></tr>
<tr><td><code id="dfbetas.estex_+3A_...">...</code></td>
<td>
<p>Currently not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix is returned, containing DFBETAS-values for each (selected) fixed parameter of the model, and separately for each evaluated set of influential data.
</p>


<h3>Author(s)</h3>

<p>Rense Nieuwenhuis, Ben Pelzer, Manfred te Grotenhuis</p>


<h3>References</h3>

<p>Nieuwenhuis, R., Te Grotenhuis, M., &amp; Pelzer, B. (2012). Influence.ME: tools for detecting influential data in mixed effects models. <em>R Journal</em>, 4(2), 38???47.
</p>
<p>Belsley, D.A., Kuh, E. &amp; Welsch, R.E. (1980). <em>Regression Diagnostics. Identifying Influential Data and Source of Collinearity</em>. Wiley. 
</p>
<p>Snijders, T.A. &amp; Bosker, R.J. (1999). <em>Multilevel Analysis, an introduction to basic and advanced multilevel modeling</em>. Sage. 
</p>
<p>Van der Meer, T., Te Grotenhuis, M., &amp; Pelzer, B. (2010). <em>Influential Cases in Multilevel Modeling: A Methodological Comment</em>. American Sociological Review, 75(1), 173-178.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+influence.mer">influence.mer</a></code>, <code><a href="#topic+cooks.distance.estex">cooks.distance.estex</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 data(school23)
 model &lt;- lmer(math ~ structure + SES  + (1 | school.ID), data=school23)

 alt.est &lt;- influence(model, group="school.ID")
 dfbetas(alt.est)

## End(Not run)
</code></pre>

<hr>
<h2 id='exclude.influence'>Exclude the influence of a grouped set of observations in mixed effects models.</h2><span id='topic+exclude.influence'></span>

<h3>Description</h3>

<p>Using mixed effects regression models, <code>exclude.influence</code> excludes the influence of a group of cases grouped within a single grouping factor, or a set of grouping factors. The function returns a model in which the influence a grouped set of observations has on both the variance and point-estimate of the (random) intercept.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exclude.influence(model, grouping=NULL, level=NULL, obs=NULL, gf="single", delete=TRUE) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exclude.influence_+3A_model">model</code></td>
<td>
<p>A mixed effects regression model</p>
</td></tr>
<tr><td><code id="exclude.influence_+3A_grouping">grouping</code></td>
<td>
<p>The grouping factor of which one or more groupings levels are to be 'neutralized'</p>
</td></tr>
<tr><td><code id="exclude.influence_+3A_level">level</code></td>
<td>
<p>Vector of character strings, indicating either a single level or a set of grouping levels the influence of which is to be neutralized</p>
</td></tr>
<tr><td><code id="exclude.influence_+3A_obs">obs</code></td>
<td>
<p>Specifies which individual observation(s) (rather than groups) to be deleted from the data/</p>
</td></tr>
<tr><td><code id="exclude.influence_+3A_gf">gf</code></td>
<td>
<p>Indicates from which of the model's grouping factors the influence of the specified grouping factor is to be neutralized. If <code>gf="single"</code> (default), the levels of the specified grouping factor are only neutralized from the grouping factor specified in <code>group</code>. In its present form, <code>gf="single"</code> only works on mixed models with a maximum of 2 grouping factors. If <code>gf="all"</code>, the influence from the levels of <code>group</code> is neutralized regarding all grouping factors in the model. This option only applies to models with more than a single grouping factor.</p>
</td></tr>
<tr><td><code id="exclude.influence_+3A_delete">delete</code></td>
<td>
<p>If delete=TRUE (default), the influence is excluded by simply deleting the observations nested within the higher level group. If delete=FALSE, the influence of higher level groups is excluded from the model by setting the intercept-vector for the observations nested within these groups to 0, and by adding a dummy-variable indicating these observations (Langford and Lewis, 1998). This latter option currently does not work with models that include factor variables.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To apply the basic logic of influential cases to mixed effects models one has to measure the influence of a particular higher level unit on the estimates of a higher level predictor. This means that the mixed effects model has to be adjusted to neutralize the unit's influence on that estimate, while at the same time allowing the unit's lower-level cases to help estimate the effects of the lower-level predictors in the model. This procedure is based on a modification of the intercept and the addition of a dummy variable for the cases that might be influential.
</p>
<p>The model that is returned by <code>exclude.influence</code> thus contains a modified intercept, and one or more additional dummy variables. To help identify this model as modified (which is required when in a later stage the influence of additional grouping levels is excluded), the intercept is renamed to 'intercept.alt'. The additional dummy variables, indicating the observations associated with the grouping factor levels of which the influence was neutralized, are labeled starting with 'estex.', combined with the label of the neutralized grouping level. 
</p>


<h3>Value</h3>

<p>Mixed effects regression model of class <code>'mer'</code>, with a modified random intercept and dummy variables indicating the estimates of the neutralized influence of selected grouping levels.
</p>


<h3>Note</h3>

<p>Please note that in its present form, the <code>exclude.influence</code> function only works on mixed effects regression models of class <code>mer</code> that have been estimated using the functions in the <code>lme4</code> package. 
</p>
<p>Also, it is required that the <code>mer</code> model was estimated using a factor variable to indicate group levels. When using something similar to <code>+ (1 | as.factor(variable))</code>, the function is not able of identifying the correct grouping factors, and returns an error.
</p>


<h3>Author(s)</h3>

<p>Rense Nieuwenhuis, Ben Pelzer, Manfred te Grotenhuis</p>


<h3>References</h3>

<p>Nieuwenhuis, R., Te Grotenhuis, M., &amp; Pelzer, B. (2012). Influence.ME: tools for detecting influential data in mixed effects models. <em>R Journal</em>, 4(2), 38???47.
</p>
<p>Belsley, D.A., Kuh, E. &amp; Welsch, R.E. (1980). <em>Regression Diagnostics. Identifying Influential Data and Source of Collinearity</em>. Wiley. 
</p>
<p>Langford, I. H. and Lewis, T. (1998). Outliers in multilevel data. Journal of the 
Royal Statistical Society: Series A (Statistics in Society), 161:121-160.
</p>
<p>Snijders, T.A. &amp; Bosker, R.J. (1999). <em>Multilevel Analysis, an introduction to basic and advanced multilevel modeling</em>. Sage. 
</p>
<p>Van der Meer, T., Te Grotenhuis, M., &amp; Pelzer, B. (2010). <em>Influential Cases in Multilevel Modeling: A Methodological Comment</em>. American Sociological Review, 75(1), 173-178.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+influence">influence</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
 data(school23)
 model.a &lt;- lmer(math ~ structure + SES  + (1 | school.ID), data=school23)
 summary(model.a)
 model.b &lt;- exclude.influence(model.a, grouping="school.ID", level="7472")
 summary(model.b)
 model.c &lt;- exclude.influence(model.a, grouping="school.ID", level=c("7472", "62821"))
 summary(model.c)
 model.d &lt;- exclude.influence(model.a, obs=1:10)
 summary(model.d)
 
 data(Penicillin, package="lme4")
 model.d &lt;- lmer(diameter ~ (1|plate) + (1|sample), Penicillin)
 summary(model.d)
 model.e &lt;- exclude.influence(model.d, grouping="sample", level="A", gf="all")
 summary(model.e)

## End(Not run)
</code></pre>

<hr>
<h2 id='grouping.levels'>Returns the levels of a grouping factor in a mixed effects regression model</h2><span id='topic+grouping.levels'></span>

<h3>Description</h3>

<p>Helper function returning all the levels of a grouping factor in a mixed effects regression model. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grouping.levels(model, group)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="grouping.levels_+3A_model">model</code></td>
<td>
<p>Mixed effects model of class 'mer'</p>
</td></tr>
<tr><td><code id="grouping.levels_+3A_group">group</code></td>
<td>
<p>Grouping factor of 'model' of which the levels are returned</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please note that at times different results may be obtained by using nesting.levels(), compared with deriving the levels of the grouping factor directly from the (original) data. This is because nesting.levels() only extracts the nesting levels that were de facto used in the model. Due to missing values, this may diverge from those present in the actual data.
</p>


<h3>Value</h3>

<p>Returns a character vector containing all the names / labels of levels of the grouping factor.
</p>


<h3>Author(s)</h3>

<p>Rense Nieuwenhuis, Ben Pelzer, Manfred te Grotenhuis</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Not run: 
 # Penicillin data originates from the lme4 package.
 model &lt;- lmer(diameter ~ (1|plate) + (1|sample), Penicillin)

 grouping.levels(model, "plate")
 grouping.levels(model, "sample")

## End(Not run)
</code></pre>

<hr>
<h2 id='influence.mer'>influence returns mixed model estimates, iteratively excluding the influence of data nested within single grouping factors.</h2><span id='topic+influence'></span><span id='topic+influence.mer'></span>

<h3>Description</h3>

<p>influence() is the workhorse function of the influence.ME package. Based on a priorly estimated mixed effects regression model (estimated using lme4), the influence() function iteratively modifies the mixed effects model to neutralize the effect a grouped set of data has on the parameters, and which returns returns the fixed parameters of these iteratively modified models. These are used to compute measures of influential data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>influence(model, group=NULL, select=NULL, obs=FALSE, 
	gf="single", count = FALSE, delete=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="influence.mer_+3A_model">model</code></td>
<td>
<p>Mixed effects model of class 'mer'.</p>
</td></tr>
<tr><td><code id="influence.mer_+3A_group">group</code></td>
<td>
<p>Grouping factor in model of which iteratively levels are neutralized</p>
</td></tr>
<tr><td><code id="influence.mer_+3A_select">select</code></td>
<td>
<p>Defines the selection of grouping factors that should be omitted. Defaults to 0, resulting in each level of the grouping factor being omitted iteratively. When a selection is defined, model parameters for the full model, and the altered model are returned. The selection can be a vector of multiple levels of the grouping factor.</p>
</td></tr>
<tr><td><code id="influence.mer_+3A_obs">obs</code></td>
<td>
<p>If obs=TRUE, single observations - rather than groups - are deleted from the model.</p>
</td></tr>
<tr><td><code id="influence.mer_+3A_gf">gf</code></td>
<td>
<p>Indicates from which of the model's grouping factors the influence of the specified grouping factor is to be neutralized. If <code>gf="single"</code> (default), the levels of the specified grouping factor are only neutralized regarding the grouping factor specified in <code>group</code>. In its present form, <code>gf="single"</code> only works on mixed models with a maximum of 2 grouping factors. If <code>gf="all"</code>, the influence from the levels of <code>group</code> is neutralized regarding all grouping factors in the model. This option only applies to models with more than a single grouping factor.</p>
</td></tr>
<tr><td><code id="influence.mer_+3A_count">count</code></td>
<td>
<p>If count=TRUE, the remaining number of grouping factors that still need to be omitted are printed.</p>
</td></tr>
<tr><td><code id="influence.mer_+3A_delete">delete</code></td>
<td>
<p>If delete=TRUE (default), the influence is excluded by simply deleting the observations nested within the higher level group. If delete=FALSE, the influence of higher level groups is excluded from the model by setting the intercept-vector for the observations nested within these groups to 0, and by adding a dummy-variable indicating these observations (Langford and Lewis, 1998). This latter option currently does not work with models that include factor variables.</p>
</td></tr>
<tr><td><code id="influence.mer_+3A_...">...</code></td>
<td>
<p>Optional arguments that are passed on to the lmer/glmer function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic rationale behind measuring influential cases is that when iteratively single units are omitted from the data, models based on these data should not produce substantially different estimates. To apply this logic to mixed effects models one has to measure the influence of a particular higher level unit on the estimates of a higher level predictor. This means that the mixed effects model has to be adjusted to neutralize the unit's influence on that estimate, while at the same time allowing the unit's lower-level cases to help estimate the effects of the lower-level predictors in the model. This procedure is based on a modification of the intercept and the addition of a dummy variable for the cases that might be influential.
</p>
<p>influence() is the workhorse function of this likewise called package. Based on a priorly estimated mixed effects regression model (of the 'mer' class), the influence() function iteratively modifies the mixed effects model by neutralizing the effect a grouped set of data has on the parameters, and which returns returns the fixed parameters of these iteratively modified models. 
</p>
<p>The returned object (see 'value') contains information which is required for functions computing various measures of influential data.
</p>


<h3>Value</h3>

<p>The object returned by influence() of class &quot;estex&quot; contains the estimates (excluding the influence of specific (groups of) observations) required by several other functions to calculate measures of influential data. A list containing six elements is returned:
</p>
<table role = "presentation">
<tr><td><code>or.fixed</code></td>
<td>
<p>Fixed estimates of the original model (based on the full data)</p>
</td></tr>
<tr><td><code>or.se</code></td>
<td>
<p>Standard Error of the estimates of the original model</p>
</td></tr>
<tr><td><code>or.vcov</code></td>
<td>
<p>Variance / Covariance matrix of the original model</p>
</td></tr>
<tr><td><code>alt.fixed</code></td>
<td>
<p>Matrix of the fixed parameters estimate, after iteratively subsets of data are removed. Altered estimates associated with the deletion of data nested within each grouping factor are provided.</p>
</td></tr>
<tr><td><code>alt.se</code></td>
<td>
<p>Matrix of the standard errors of the fixed parameter estimates, after iteratively subsets of data are removed. Altered estimates associated with the deletion of data nested within each grouping factor are provided.</p>
</td></tr>
<tr><td><code>alt.vcov</code></td>
<td>
<p>Variance / Covariance matrix of the altered models, after iteratively subsets of data are removed. Altered estimates associated with the deletion of data nested within each grouping factor are provided.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please note that in its present form, the <code>influence</code> function only works on mixed effects regression models that have been estimated using the functions in the <code>lme4</code> package. 
</p>
<p>Also, it is required that the <code>mer</code> model was estimated using a factor variable to indicate group levels. When using something similar to <code>+ (1 | as.factor(variable))</code>, the function is not able of identifying the correct grouping factors, and returns an error.
</p>
<p>Since influence() entails the re-estimation of the provided mixed effects model for each level of the specified grouping factor (after alteration of the data), executing this procedure can be computationally highly demanding. 
</p>


<h3>Author(s)</h3>

<p>Rense Nieuwenhuis, Ben Pelzer, Manfred te Grotenhuis</p>


<h3>References</h3>

<p>Nieuwenhuis, R., Te Grotenhuis, M., &amp; Pelzer, B. (2012). Influence.ME: tools for detecting influential data in mixed effects models. <em>R Journal</em>, 4(2), 38???47.
</p>
<p>Belsley, D.A., Kuh, E. &amp; Welsch, R.E. (1980). <em>Regression Diagnostics. Identifying Influential Data and Source of Collinearity</em>. Wiley. 
</p>
<p>Langford, I. H. and Lewis, T. (1998). Outliers in multilevel data. Journal of the 
Royal Statistical Society: Series A (Statistics in Society), 161:121-160.
</p>
<p>Snijders, T.A. &amp; Bosker, R.J. (1999). <em>Multilevel Analysis, an introduction to basic and advanced multilevel modeling</em>. Sage. 
</p>
<p>Van der Meer, T., Te Grotenhuis, M., &amp; Pelzer, B. (2010). <em>Influential Cases in Multilevel Modeling: A Methodological Comment</em>. American Sociological Review, 75(1), 173-178.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cooks.distance.estex">cooks.distance.estex</a></code>, <code><a href="#topic+dfbetas.estex">dfbetas.estex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(school23)
model.a &lt;- lmer(math ~ structure + SES  + (1 | school.ID), data=school23)
alt.est.a &lt;- influence(model=model.a, group="school.ID")
alt.est.b &lt;- influence(model=model.a, group="school.ID", select="7472")
alt.est.c &lt;- influence(model=model.a, group="school.ID", select=c("7472", "62821"))

#Note: does not work on models produced by exclude.influence()
model.b &lt;- lmer(math ~ structure + scale(SES)  + (1 | school.ID), data=school23)
alt.est.d &lt;- influence(model=model.b, group="school.ID", select=c("7472", "62821"))

data(Penicillin, package="lme4")
model.c &lt;- lmer(diameter ~ (1|plate) + (1|sample), Penicillin)
alt.est.e &lt;- influence(model=model.c, group="plate")
alt.est.f &lt;- influence(model=model.c, group="sample")
alt.est.g &lt;- influence(model=model.c, group="sample", gf="all")


## End(Not run)
</code></pre>

<hr>
<h2 id='pchange'>Compute the percentage change, as measure of influential data</h2><span id='topic+pchange'></span>

<h3>Description</h3>

<p>Computes the percentile change, as a measure of influential data. This unstandardized measure can serve to help interpret the magnitude of the influence single or combined grouping levels exert on mixed effects models. The percentage change in parameter estimates between a (mixed effects) regression model based on a full set of data, and a model from which a (potentially influential) subset of data is removed. A value of percentage change is calculated for each parameter in the model separately, based on the information returned by the influence() function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pchange(estex, parameters = 0, sort=FALSE, to.sort=NA, abs=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pchange_+3A_estex">estex</code></td>
<td>
<p>An object as returned by the influence() function, containing the altered estimates of a mixed effects regression model</p>
</td></tr>
<tr><td><code id="pchange_+3A_parameters">parameters</code></td>
<td>
<p>Used to define a selection of parameters. If parameters=0 (default), percentage change are calculated for all parameters in the model</p>
</td></tr>
<tr><td><code id="pchange_+3A_sort">sort</code></td>
<td>
<p>If <code>sort=TRUE</code> the values of percentage change are ordered based on magnitude. If <code>sort=FALSE</code> (default) no sorting takes place.</p>
</td></tr>
<tr><td><code id="pchange_+3A_to.sort">to.sort</code></td>
<td>
<p>Specify on which variable the percentage changes must be sorted. If only one variable present (either in the model, or due to the selection specified in <code>parameters</code>), this parameter can be omitted. If percentage changes are calculated for multiple variables, and sort=TRUE, specification of <code>to.sort</code> is required, or an error is returned.</p>
</td></tr>
<tr><td><code id="pchange_+3A_abs">abs</code></td>
<td>
<p>If <code>abs=TRUE</code>, the absolute values of percentage change are returned, while if <code>abs=FALSE</code> (default), both positive and negative values are possible. If both <code>abs=TRUE</code> and <code>sort=TRUE</code>, the <code>abs</code> parameters precedes the <code>sort</code> parameter, and thus the absolute values of percentage change are sorted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix is returned, containing values of percentage change for each (selected) fixed parameter estimate of the model, and separately for each evaluated set of influential data.
</p>


<h3>Author(s)</h3>

<p>Rense Nieuwenhuis, Ben Pelzer, Manfred te Grotenhuis</p>


<h3>References</h3>

<p>Belsley, D.A., Kuh, E. &amp; Welsch, R.E. (1980). <em>Regression Diagnostics. Identifying Influential Data and Source of Collinearity</em>. Wiley. 
</p>
<p>Snijders, T.A. &amp; Bosker, R.J. (1999). <em>Multilevel Analysis, an introduction to basic and advanced multilevel modeling</em>. Sage. 
</p>
<p>Van der Meer, T., Te Grotenhuis, M., &amp; Pelzer, B. (2010). <em>Influential Cases in Multilevel Modeling: A Methodological Comment</em>. American Sociological Review, 75(1), 173-178.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+influence">influence</a></code>, <code><a href="#topic+cooks.distance.estex">cooks.distance.estex</a></code>,
<code><a href="#topic+dfbetas.estex">dfbetas.estex</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 data(school23)
 model &lt;- lmer(math ~ structure + SES  + (1 | school.ID), data=school23)

 alt.est &lt;- influence(model, group="school.ID")
 pchange(alt.est)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.estex'>Dotplot visualization of measures of influence</h2><span id='topic+plot.estex'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p>This is a wrapper function to the dotplot() function in the lattice-package. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'estex'
plot(x, which="dfbetas", sort=FALSE, to.sort=NA, abs=FALSE, cutoff=0,
						parameters=seq_len(ncol(estex$alt.fixed)),
                        groups=seq_len(nrow(estex$alt.fixed)), ...)
           
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.estex_+3A_x">x</code></td>
<td>
<p>An object as returned by the influence() function, containing the altered estimates of a mixed effects regression model.</p>
</td></tr>
<tr><td><code id="plot.estex_+3A_which">which</code></td>
<td>
<p>Select which measure of influence is to be plotted. Available options are: <code>"dfbetas"</code> to visualize dfbetas, <code>"cook"</code> to plot the cook's distances, <code>"pchange"</code> to plot the percentage change, and <code>"sigtest"</code> to plot the test statistic of a parameter estimate after deletion of specific cases.</p>
</td></tr>
<tr><td><code id="plot.estex_+3A_sort">sort</code></td>
<td>
<p>If <code>sort=TRUE</code> The values of the selected measure of influence are ordered based on magnitude before visualization. If <code>sort=FALSE</code> (default) no sorting takes place.</p>
</td></tr>
<tr><td><code id="plot.estex_+3A_to.sort">to.sort</code></td>
<td>
<p>Specify on which variable the values of the selected measure of influence must be sorted. If only one variable present (either in the model, or due to the selection specified in <code>parameters</code>), this parameter can be omitted. If multiple variables are visualized, and sort=TRUE, specification of <code>to.sort</code> is required, or an error is returned.</p>
</td></tr>
<tr><td><code id="plot.estex_+3A_abs">abs</code></td>
<td>
<p>If <code>abs=TRUE</code>, the absolute values of the values of the selected measure of influence are visualized, while if <code>abs=FALSE</code> (default), both positive and negative values are possible. If both <code>abs=TRUE</code> and <code>sort=TRUE</code>, the <code>abs</code> parameters precedes the <code>sort</code> parameter, and thus the absolute values of the selected measure of influence are sorted.</p>
</td></tr>
<tr><td><code id="plot.estex_+3A_cutoff">cutoff</code></td>
<td>
<p>Values of the selected measure of influence exceeding the specified (<code>cutoff</code>) value are plotted visually different from values not exceeding the cutoff. If <code>cutoff=0</code> (default), no such differentiation is made in the way values are plotted.</p>
</td></tr>
<tr><td><code id="plot.estex_+3A_parameters">parameters</code></td>
<td>
<p>Used to define a selection of parameters. If left unspecified (default), values for the selected measure of influence are visualized for parameters in the model.</p>
</td></tr>
<tr><td><code id="plot.estex_+3A_groups">groups</code></td>
<td>
<p>Used to define a selection of nesting groups that should be visualized. If left unspecified (default), the values of the selected measure of influence for all nesting groups are shown.</p>
</td></tr>  
<tr><td><code id="plot.estex_+3A_...">...</code></td>
<td>
<p>Further arguments passed on to the dotplot() function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rense Nieuwenhuis, Ben Pelzer, Manfred te Grotenhuis</p>


<h3>See Also</h3>

<p><code><a href="#topic+influence">influence</a></code>, <code><a href="#topic+dfbetas.estex">dfbetas.estex</a></code>,
<code><a href="#topic+cooks.distance.estex">cooks.distance.estex</a></code>, <code><a href="#topic+pchange">pchange</a></code>, <code><a href="#topic+sigtest">sigtest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(school23)
model &lt;- lmer(math ~ structure + SES  + (1 | school.ID), data=school23)

alt.est &lt;- influence(model, "school.ID")
plot(alt.est, which="dfbetas")
plot(alt.est, which="cook", sort=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='school23'>Math test performance in 23 schools</h2><span id='topic+school23'></span>

<h3>Description</h3>

<p>The <code>school23</code> data contains information on students' performance on a math test, as well as several explanatory variables. These data are subset of the NELS-88 data (National Education Longitudinal Study of 1988). Both a selected number of variables and a selected number of observations are given here.
</p>


<h3>Format</h3>

<p>A data frame with 519 observations on the following 15 variables.
</p>

<dl>
<dt><code>school.ID</code></dt><dd><p>a factor with 23 levels, representing the 23 schools within which students are nested.</p>
</dd>
<dt><code>SES</code></dt><dd><p>a numeric vector, representing the socio-economic status</p>
</dd>
<dt><code>mean.SES</code></dt><dd><p>a numeric vector, representing the mean socio-economic status per school</p>
</dd>
<dt><code>homework</code></dt><dd><p>a factor representing the time spent on math homework each week, with levels <code>None</code>, <code>Less than 1 hour</code>, <code>1 hour</code>, <code>2 hours</code>, <code>3 hours</code>, <code>4-6 hours</code>, <code>7-9 hours</code>, and <code>10 or more</code></p>
</dd>
<dt><code>parented</code></dt><dd><p>a factor representing the parents' highest education level, with levels <code>Dod not finish H.S.</code>, <code>H.S. grad or GED</code>, <code>GT H.S. and LT 4yr degree</code>, <code>College graduate</code>, <code>M.A. or equivalent</code>, and <code>Ph.D., M.D., other</code></p>
</dd>
<dt><code>ratio</code></dt><dd><p>a numeric vector, representing the student-teacher ratio</p>
</dd>
<dt><code>perc.minor</code></dt><dd><p>a factor representing the percent minority in school, with levels <code>None</code>, <code>1-5</code>, <code>6-10</code>, <code>11-20</code>, <code>21-40</code>, <code>41-60</code>, <code>61-90</code>, and <code>91-100</code></p>
</dd>
<dt><code>math</code></dt><dd><p>a numeric vector, representing the number of correct answers on a mathematics test</p>
</dd>
<dt><code>sex</code></dt><dd><p>a factor with levels <code>Male</code> and <code>Female</code></p>
</dd>
<dt><code>race</code></dt><dd><p>a factor with levels <code>Asian</code>, <code>Hispanic</code>, <code>Black</code>, <code>White</code>, and <code>American Indian</code></p>
</dd>
<dt><code>school.type</code></dt><dd><p>a factor representing the school type, with levels <code>Public school</code>, <code>Catholic school</code>, <code>Private, other religious affiliation</code>, and <code>Private, no religious affiliation</code></p>
</dd>
<dt><code>structure</code></dt><dd><p>a numeric vector representing the degree to which the classroom environment is structured. High values represent higher levels of (accurate) classroom environment structure</p>
</dd>
<dt><code>school.size</code></dt><dd><p>a factor representing the total school enrollment, with levels <code>1-199 Students</code>, <code>200-399</code>, <code>400-599</code>, <code>600-799</code>, <code>800-999</code>, <code>1000-1199</code>, and <code>1200+</code></p>
</dd>
<dt><code>urban</code></dt><dd><p>a factor with levels <code>Urban</code>, <code>Suburban</code>, and <code>Rural</code></p>
</dd>
<dt><code>region</code></dt><dd><p>a factor with levels <code>Northeast</code>, <code>North Central</code>, <code>South, and</code> <code>West</code></p>
</dd>
</dl>



<h3>Details</h3>

<p>Labels for the factors were found in an appendix in Kreft \&amp; De Leeuw (1998). All labels were designated, although in some cases not all possible values are represented in the variable (i.e. <code>region</code>). This is probably due to the fact that this is only a subsample from the full NELS-88 data.
</p>
<p>Also, some of the variable names were changed.
</p>


<h3>Source</h3>

<p>These data are used in the examples given in Kreft \&amp; De Leeuw (1998). Both the examples and the data are publicly available from the internet: http://www.ats.ucla.edu/stat/examples/imm/. Data reproduced with permission from Jan de Leeuw.
</p>


<h3>References</h3>

<p>Kreft, I. and De Leeuw, J. (1998). <em>Introducing Multilevel Modeling</em>. Sage Publications.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(school23)
model &lt;- lmer(math ~ structure + (1 | school.ID), data=school23)
summary(model)

## End(Not run)
</code></pre>

<hr>
<h2 id='se.fixef'>Standard errors of fixed estimates</h2><span id='topic+se.fixef'></span>

<h3>Description</h3>

<p>Returns the standard errors of the fixed estimates in a mixed effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>se.fixef(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="se.fixef_+3A_model">model</code></td>
<td>
<p>Mixed effects regression model of class 'mer'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the standard errors of the fixed parameters of the model.
</p>


<h3>Note</h3>

<p>This is a small helper-function to the influence.ME package. For more elaborate functionality, refer to the se.fixef function in the 'car' package. 
</p>


<h3>Author(s)</h3>

<p>Rense Nieuwenhuis, Ben Pelzer, Manfred te Grotenhuis</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(school23)
model &lt;- lmer(math ~  homework + structure + (1 | school.ID), data=school23)
summary(model)
se.fixef(model)

## End(Not run)
</code></pre>

<hr>
<h2 id='sigtest'>Test for changes in the level of statistical significance resulting from the deletion of potentially influential observations</h2><span id='topic+sigtest'></span>

<h3>Description</h3>

<p>Test for changes in the level of statistical significance resulting from the deletion of potentially influential observations</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigtest(estex, test = 1.96, parameters = 0, sort = FALSE, to.sort = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sigtest_+3A_estex">estex</code></td>
<td>
<p>Object of class 'estex', as returned from the <code>influence</code> function.</p>
</td></tr>
<tr><td><code id="sigtest_+3A_test">test</code></td>
<td>
<p>Value of the test statistic against which statistical significance is to be evaluated</p>
</td></tr>
<tr><td><code id="sigtest_+3A_parameters">parameters</code></td>
<td>
<p>Vector specifying the parameter(s) of which the significance is to be evaluated. If left unspecified, all parameters of the model are evaluated</p>
</td></tr>
<tr><td><code id="sigtest_+3A_sort">sort</code></td>
<td>
<p>Specify whether the output should be sorted on the (absolute) magnitude of the test statistic after deletion of potentially influential cases</p>
</td></tr>
<tr><td><code id="sigtest_+3A_to.sort">to.sort</code></td>
<td>
<p>If <code>sort==true</code>, the variable on which to sort the output needs to be be specified</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>"sigtest"</code> function tests whether excluding the influence of a single case changes the statistical significance of any or more variables in the model. This test of significance is based on the test statistic provided by the <span class="pkg">lme4</span> package. The nature of this statistic varies between different distributional families in the generalized mixed effects models. For instance, the t-statistic is related to a normal distribution while the z-statistic is related  to binomial distributions. 
</p>
<p>For each of the cases that are evaluated, the test statistic of each variable is compared to a test-value specified by the user. For the purpose of this test, the parameter is regarded to statistically significant if the test statistic of the model exceeds the specified value. The <code>"sigtest"</code> function reports for each variable the test statistic after deletion of each evaluated case, whether or not this updated test statistic results in statistical significance based on the user-specified value, and whether or not this new statistical significance differs from the significance in the original model. So, in other words, if a parameter was statistically significant in the original model, but is not longer significant after the deletion of a specific case from the model, this is indicated by the output of the <code>"sigtest"</code> function. It is also indicated when an estimate was not significant originally, but reached statistical significance after deletion of a specific case. 
</p>


<h3>Value</h3>

<p>Returns a list. For each variable in the original model that was evaluated, this list contains a matrix showing the test statistic from the original model (column 1), the test statistic after a potentially influential case was excluded from the model (column 2) and the result (TRUE / FALSE) of the test whether statistical significance changed as a result from deletion of (potentially) influential cases.</p>


<h3>Author(s)</h3>

<p>Rense Nieuwenhuis, Manfred te Grotenhuis, Ben Pelzer</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(school23)
m23 &lt;- lmer(math ~ homework + structure 
   + (1 | school.ID), 
   data=school23)

estex.m23  &lt;- influence(m23, group="school.ID")
   
sigtest(estex.m23, test=-1.96)$structure

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
