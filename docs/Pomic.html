<!DOCTYPE html><html lang="en"><head><title>Help for package Pomic</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Pomic}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Pomic-package'>
<p>Pattern Oriented Modeling Information Criterion for ABM/IBM</p></a></li>
<li><a href='#pomdev'><p> POMDEV calculation for numerical patterns</p></a></li>
<li><a href='#pomdev.corrected'><p> POMDEV corrected calculation for numerical patterns</p></a></li>
<li><a href='#pomdev.extra'><p> POMDEV calculation for numerical patterns as well as other goodness of fit indicators</p></a></li>
<li><a href='#pomdev.ts'><p> POMDEV calculation for numerical time series patterns</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Pattern Oriented Modelling Information Criterion</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-02-09</td>
</tr>
<tr>
<td>Author:</td>
<td>Cyril Piou [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cyril Piou &lt;cyril.piou@cirad.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculations of an information criterion are proposed to check the quality of simulations results of Agent-based models (ABM/IBM) or other non-linear rule-based models. The POMDEV measure (Pattern Oriented Modelling DEViance) is based on the Kullback-Leibler divergence and likelihood theory. It basically indicates the deviance of simulation results from field observations. Once POMDEV scores and metropolis-hasting sampling on different model versions are effectuated, POMIC scores (Pattern Oriented Modelling Information Criterion) can be calculated. This method could be further developed to incorporate multiple patterns assessment. Piou C, U Berger and V Grimm (2009) &lt;<a href="https://doi.org/10.1016%2Fj.ecolmodel.2009.05.003">doi:10.1016/j.ecolmodel.2009.05.003</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-02-09 12:49:12 UTC; piou</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-02-12 17:19:17 UTC</td>
</tr>
</table>
<hr>
<h2 id='Pomic-package'>
Pattern Oriented Modeling Information Criterion for ABM/IBM
</h2><span id='topic+Pomic-package'></span><span id='topic+Pomic'></span>

<h3>Description</h3>

<p>Calculations of an information criterion are proposed to check the quality of simulations results of Agent-based models (ABM/IBM) or other non-linear rule-based models. The POMDEV measure (Pattern Oriented Modelling DEViance) is based on the Kullback-Leibler divergence and likelihood theory. It basically indicates the deviance of simulation results from field observations. Once POMDEV scores and metropolis-hasting sampling on different model versions are effectuated, POMIC scores (Pattern Oriented Modelling Information Criterion) can be calculated. This method could be further developed to incorporate multiple patterns assessment.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> Pomic</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-02-09</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The <a href="#topic+pomdev">pomdev</a> function is for distribution patterns. It is computed as in Piou et al. (2009) It corresponds to twice the sum of the log of an approximated likelihood given by the approximating function of density from the simulation results applied on the field data.
</p>
<p>The <a href="#topic+pomdev.extra">pomdev.extra</a> function is to obtain POMDEV scores as well as other goodness of fit indicators.
</p>
<p>The <a href="#topic+pomdev.corrected">pomdev.corrected</a> function is to obtain raw approximation of KL divergence.
</p>
<p>The <a href="#topic+pomdev.ts">pomdev.ts</a> function is for time series patterns. It is still under evaluation.
</p>
<p>Type <code>demo(demoPomic)</code> for a demonstration of POMIC calculation as in appendix B of Piou et al. (2009).
</p>
<p>And type <code>demo{verification}</code> for the verification of the first demonstration (as in appendix C of  Piou et al. (2009)).
</p>


<h3>Author(s)</h3>

<p>Cyril Piou
<br />
<a href="mailto:cyril.piou@cirad.fr">cyril.piou@cirad.fr</a>
</p>


<h3>References</h3>

<p>Piou 2007, Patterns and individual-based modeling of spatial competition within two main components of Neotropical mangrove ecosystems. PhD thesis, University of Bremen. <a href="http://elib.suub.uni-bremen.de/diss/docs/00010671.pdf">http://elib.suub.uni-bremen.de/diss/docs/00010671.pdf</a> 
</p>
<p>Piou, C., U. Berger, and V. Grimm. 2009. Proposing an information criterion for individual-based models developed in a pattern-oriented modelling framework. Ecological Modelling 220:1957-1967. <a href="http://dx.doi.org/10.1016/j.ecolmodel.2009.05.003">http://dx.doi.org/10.1016/j.ecolmodel.2009.05.003</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pomdev">pomdev</a></code> <code><a href="#topic+pomdev.ts">pomdev.ts</a></code> <code><a href="#topic+pomdev.extra">pomdev.extra</a></code> <code><a href="#topic+pomdev.corrected">pomdev.corrected</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>#example of field pattern distribution:        
fieldpattern&lt;-rnorm(100,10,5)
#model results:
model1runs&lt;- rnorm(100*5,10.5,6)
model2runs&lt;- rnorm(100*5,9.5,2)
#POMDEV measurements:
pomdev.extra(fieldpattern,model1runs,eps=10^-20,plotting=TRUE)
pomdev.extra(fieldpattern,model2runs,eps=10^-20,plotting=TRUE)
pomdev(fieldpattern,model2runs,eps=10^-20)
pomdev.corrected(fieldpattern,model1runs,eps=10^-20)
pomdev.corrected(fieldpattern,model2runs,eps=10^-20)

#other examples of POMDEV measures:
pomdev(x&lt;-rnorm(100),y&lt;-rnorm(100,0.1)) 
#POMDEV value for a model creating a normal distribution 
#with identical variance as the field data but a mean 0.1 
#away from the field data
par(mfrow=c(2,2))
hist(x,freq=FALSE) #plot the field data as histogram
lines(density(y))#check the simulation results distribution as line
pomdev(x&lt;-rnorm(100),y&lt;-rnorm(100,0.2)) #idem 0.2 away from the field data
hist(x,freq=FALSE); lines(density(y)) #plot
pomdev(x&lt;-rnorm(100),y&lt;-rnorm(100,1))   #idem 1 away from the field data
hist(x,freq=FALSE); lines(density(y)) #plot
pomdev(x&lt;-rnorm(100),y&lt;-rnorm(100,3))   #idem 3 away from the field data
hist(x,freq=FALSE); lines(density(y)) #plot

## Not run: demo(demoPomic)
## Not run: demo(verification)

</code></pre>

<hr>
<h2 id='pomdev'> POMDEV calculation for numerical patterns </h2><span id='topic+pomdev'></span>

<h3>Description</h3>

<p>This function calculate the POMDEV value of simulations results compared to a vector taken as a field pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pomdev(object1, object2, eps=10^-30, nrange=1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pomdev_+3A_object1">object1</code></td>
<td>
<p> Numerical, vector of the field pattern </p>
</td></tr>
<tr><td><code id="pomdev_+3A_object2">object2</code></td>
<td>
<p> Numerical, vector of simulations results </p>
</td></tr>
<tr><td><code id="pomdev_+3A_eps">eps</code></td>
<td>
<p> Numerical, value to use when the likelihood = 0 for mathematical stability </p>
</td></tr>
<tr><td><code id="pomdev_+3A_nrange">nrange</code></td>
<td>
<p> Numerical, number of interval to consider for the probability density function creation and integration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns the POMDEV value as computed in Piou et al. It corresponds to twice the sum of the log of an approximated likelihood given by the approximating function of density from the simulation results applied on the field data.
</p>


<h3>Value</h3>

<p>Return a value corresponding to the pomdev score of model results to reproduce the pattern.
</p>


<h3>Author(s)</h3>

<p> Cyril Piou 
<br />
<a href="mailto:cyril.piou@cirad.fr">cyril.piou@cirad.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pomdev.extra">pomdev.extra</a></code> <code><a href="#topic+pomdev.corrected">pomdev.corrected</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>pomdev(rnorm(100,10,5),rnorm(100*5,10.5,6),eps=10^-20)

</code></pre>

<hr>
<h2 id='pomdev.corrected'> POMDEV corrected calculation for numerical patterns </h2><span id='topic+pomdev.corrected'></span>

<h3>Description</h3>

<p>This function calculate the KL divergence of simulations results compared to a vector taken as a field pattern with identical techniques as POMDEV.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pomdev.corrected(object1, object2, eps=10^-30, nrange=1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pomdev.corrected_+3A_object1">object1</code></td>
<td>
<p> Numerical, vector of the field pattern </p>
</td></tr>
<tr><td><code id="pomdev.corrected_+3A_object2">object2</code></td>
<td>
<p> Numerical, vector of simulations results </p>
</td></tr>
<tr><td><code id="pomdev.corrected_+3A_eps">eps</code></td>
<td>
<p> Numerical, value to use when the likelihood = 0 for mathematical stability </p>
</td></tr>
<tr><td><code id="pomdev.corrected_+3A_nrange">nrange</code></td>
<td>
<p> Numerical, number of interval to consider for the probability density function creation and integration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns 1/2 the POMDEV value + correction of the constant in KL equation corresponding to the entropy of the field pattern.
Thus, this value should be close to the KL divergence using the same techniques of approximation than pomdev.
</p>


<h3>Value</h3>

<p>Return a value corresponding to the KL divergence between the model results and the pattern
</p>


<h3>Author(s)</h3>

<p> Cyril Piou 
<br />
<a href="mailto:cyril.piou@cirad.fr">cyril.piou@cirad.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pomdev.extra">pomdev.extra</a></code> <code><a href="#topic+pomdev">pomdev</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>pomdev.corrected(rnorm(100,10,5),rnorm(100*5,10.5,6),eps=10^-20)

</code></pre>

<hr>
<h2 id='pomdev.extra'> POMDEV calculation for numerical patterns as well as other goodness of fit indicators </h2><span id='topic+pomdev.extra'></span>

<h3>Description</h3>

<p>This function calculate the POMDEV value of simulations results compared to a vector taken as a field pattern and compute also other goodness of fit indicators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pomdev.extra(object1, object2, eps=10^-30, nrange=1000, 
              fullmsd=FALSE,  plotting=FALSE,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pomdev.extra_+3A_object1">object1</code></td>
<td>
<p> Numerical, vector of the field pattern </p>
</td></tr>
<tr><td><code id="pomdev.extra_+3A_object2">object2</code></td>
<td>
<p> Numerical, vector of simulations results </p>
</td></tr>
<tr><td><code id="pomdev.extra_+3A_eps">eps</code></td>
<td>
<p> Numerical, value to use when the likelihood = 0 for mathematical stability </p>
</td></tr>
<tr><td><code id="pomdev.extra_+3A_nrange">nrange</code></td>
<td>
<p> Numerical, number of interval to consider for the probability density function creation and integration</p>
</td></tr>
<tr><td><code id="pomdev.extra_+3A_fullmsd">fullmsd</code></td>
<td>
<p> Boolean, should the full cross MSD be calculated as well</p>
</td></tr>
<tr><td><code id="pomdev.extra_+3A_plotting">plotting</code></td>
<td>
<p> Boolean, should a plot illustrating the calculation be created</p>
</td></tr>
<tr><td><code id="pomdev.extra_+3A_...">...</code></td>
<td>
<p> eventual information to give to the last plot (if plotting=T)...  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The KL divergence is only calculated comparing the simulations to the field vector, as if it is the truth (different from the <span class="pkg">flexmix</span> KLdiv calculations)
</p>


<h3>Value</h3>

<p>Return a list containing:
</p>
<table role = "presentation">
<tr><td><code>field_data</code></td>
<td>
<p> the field data </p>
</td></tr>
<tr><td><code>sim_data</code></td>
<td>
<p> the simulation data</p>
</td></tr>
<tr><td><code>kernel_estimator</code></td>
<td>
<p> information about the kernel estimator used</p>
</td></tr>
<tr><td><code>result</code></td>
<td>
<p> a table of 4 or 5 rows (depending if fullmsd=TRUE or not) with:</p>
</td></tr>
<tr><td><code>-  POMDEV</code></td>
<td>
<p> pomdev score of model results to reproduce the pattern</p>
</td></tr>
<tr><td><code>-  overlap</code></td>
<td>
<p> indicates if the model results overlap the range of the field data</p>
</td></tr>
<tr><td><code>-  KLdiv</code></td>
<td>
<p> KL divergence of the model results from the field pattern</p>
</td></tr>
<tr><td><code>-  MSD</code></td>
<td>
 <p><code class="reqn">(\sum(field)/n_{field}-\sum(simulation)/n_{simulation})^2</code></p>
</td></tr>
<tr><td><code>-  CrossMSD</code></td>
<td>
<p> if fullmsd is true, calculate the mean square deviation among each pair of simulation and field data possible</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Cyril Piou 
<br />
<a href="mailto:cyril.piou@cirad.fr">cyril.piou@cirad.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pomdev">pomdev</a></code> <code><a href="#topic+pomdev.corrected">pomdev.corrected</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>pomdev.extra(rnorm(100,10,5),rnorm(100*5,10.5,6),eps=10^-20)
pomdev.extra(rnorm(100,10,5),rnorm(100*5,10.5,6),eps=10^-20,fullmsd=TRUE,plotting=TRUE)
</code></pre>

<hr>
<h2 id='pomdev.ts'> POMDEV calculation for numerical time series patterns </h2><span id='topic+pomdev.ts'></span>

<h3>Description</h3>

<p>This function calculate the POMDEV value of time series simulations results compared to a vector taken as a field pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pomdev.ts(object1, object2, eps=10^-30, nrange=1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pomdev.ts_+3A_object1">object1</code></td>
<td>
<p> Numerical, vector of the field pattern </p>
</td></tr>
<tr><td><code id="pomdev.ts_+3A_object2">object2</code></td>
<td>
<p> Numerical, matrix of simulations results with nrow = length(object1) and ncol &gt; 2</p>
</td></tr>
<tr><td><code id="pomdev.ts_+3A_eps">eps</code></td>
<td>
<p> Numerical, value to use when the likelihood = 0 for mathematical stability </p>
</td></tr>
<tr><td><code id="pomdev.ts_+3A_nrange">nrange</code></td>
<td>
<p> Numerical, number of interval to consider for the probability density function creation and integration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is still under evaluation and should give a possibility of deviance measurement for temporal patterns. It corresponds to the sum of twice the log of approximated likelihoods given by approximating function of density from simulation results for each field data point.
</p>


<h3>Value</h3>

<p>Return a value corresponding to the pomdev score of model results to reproduce the pattern.
</p>


<h3>Author(s)</h3>

<p> Cyril Piou 
<br />
<a href="mailto:cyril.piou@cirad.fr">cyril.piou@cirad.fr</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pomdev">pomdev</a></code> <code><a href="#topic+pomdev.extra">pomdev.extra</a></code> <code><a href="#topic+pomdev.corrected">pomdev.corrected</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>pomdev.ts(rnorm(100,10,5),matrix(rnorm(100*5,10.5,6),ncol=5),eps=10^-20)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
