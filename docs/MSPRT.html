<!DOCTYPE html><html><head><title>Help for package MSPRT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MSPRT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MSPRT-package'>
<p>A Modified Sequential Probability Ratio Test (MSPRT)</p></a></li>
<li><a href='#design.MSPRT'>
<p>Designing the MSPRT</p></a></li>
<li><a href='#design.MSPRT_oneProp'>
<p>Internal MSPRT function: Designing the MSPRT for one-sample proportion tests</p></a></li>
<li><a href='#design.MSPRT_oneT'>
<p>Internal MSPRT function: Designing the MSPRT for one-sample t tests</p></a></li>
<li><a href='#design.MSPRT_oneZ'>
<p>Internal MSPRT function: Designing the MSPRT for one-sample z tests</p></a></li>
<li><a href='#design.MSPRT_twoT'>
<p>Internal MSPRT function: Designing the MSPRT for two-sample t tests</p></a></li>
<li><a href='#design.MSPRT_twoZ'>
<p>Internal MSPRT function: Designing the MSPRT for two-sample z tests</p></a></li>
<li><a href='#effectiveN.oneProp'>
<p>Calculating effective maximum sample size to be used in designing the MSPRT in one-sample proportion test</p></a></li>
<li><a href='#fixed_design.alt'>
<p>Fixed-design alternative</p></a></li>
<li><a href='#implement.MSPRT'>
<p>Implementing the MSPRT</p></a></li>
<li><a href='#implement.MSPRT_oneProp'>
<p>Internal MSPRT function: Implementing the MSPRT in one-sample proportion tests</p></a></li>
<li><a href='#implement.MSPRT_oneT'>
<p>Internal MSPRT function: Implementing the MSPRT in one-sample t tests</p></a></li>
<li><a href='#implement.MSPRT_oneZ'>
<p>Internal MSPRT function: Implementing the MSPRT in one-sample z tests</p></a></li>
<li><a href='#implement.MSPRT_twoT'>
<p>Internal MSPRT function: Implementing the MSPRT in two-sample t tests</p></a></li>
<li><a href='#implement.MSPRT_twoZ'>
<p>Internal MSPRT function: Implementing the MSPRT in two-sample z tests</p></a></li>
<li><a href='#Nstar'>
<p>Sample size required to achieve higher significance</p></a></li>
<li><a href='#OCandASN.MSPRT'>
<p>Operating characteristics (OC) and Average Sample Number (ASN) of a designed MSPRT</p></a></li>
<li><a href='#OCandASN.MSPRT_oneProp'>
<p>Internal MSPRT function: OC and ASN of a designed MSPRT in one-sample proportion tests</p></a></li>
<li><a href='#OCandASN.MSPRT_oneT'>
<p>Internal MSPRT function: OC and ASN of a designed MSPRT in one-sample t tests</p></a></li>
<li><a href='#OCandASN.MSPRT_oneZ'>
<p>Internal MSPRT function: OC and ASN of a designed MSPRT in one-sample z tests</p></a></li>
<li><a href='#OCandASN.MSPRT_twoT'>
<p>Internal MSPRT function: OC and ASN of a designed MSPRT in two-sample t tests</p></a></li>
<li><a href='#OCandASN.MSPRT_twoZ'>
<p>Internal MSPRT function: OC and ASN of a designed MSPRT in two-sample z tests</p></a></li>
<li><a href='#Type2.fixed_design'>
<p>Type II error probability of fixed design tests</p></a></li>
<li><a href='#UMPBT.alt'>
<p>UMPBT alternative</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Modified Sequential Probability Ratio Test (MSPRT)</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-11-11</td>
</tr>
<tr>
<td>Author:</td>
<td>Sandipan Pramanik [aut, cre],
  Valen E. Johnson [aut],
  Anirban Bhattacharya [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sandipan Pramanik &lt;sandy.pramanik@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Given the maximum available sample size (N) for an experiment, and the target levels of Type I 
             and II error probabilities, this package designs a modified SPRT (MSPRT). For any designed MSPRT 
             the package can also obtain its operating characteristics and implement the test for a given 
             sequentially observed data. The MSPRT is defined in a manner very similar to Wald's initial proposal. 
             The proposed test has shown evidence of reducing the average sample size required to perform 
             statistical hypothesis tests at specified levels of significance and power. Currently, the package
             implements one-sample proportion tests, one and two-sample z tests, and one and two-sample 
             t tests. A brief user guidance for this package is provided below. One can also refer to the 
             supplemental information for the same.</td>
</tr>
<tr>
<td>Imports:</td>
<td>nleqslv, ggplot2, ggpubr, foreach, iterators, parallel,
doParallel, datasets, graphics, grDevices, methods, stats,
utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-13 01:08:33 UTC; sandipanpramanik</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-13 10:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='MSPRT-package'>
A Modified Sequential Probability Ratio Test (MSPRT)
</h2><span id='topic+MSPRT-package'></span><span id='topic+MSPRT'></span>

<h3>Description</h3>

<p>Given the maximum available sample size (N) for an experiment, and the target levels of Type I 
             and II error probabilities, this package designs a modified SPRT (MSPRT). For any designed MSPRT 
             the package can also obtain its operating characteristics and implement the test for a given 
             sequentially observed data. The MSPRT is defined in a manner very similar to Wald's initial proposal. 
             The proposed test has shown evidence of reducing the average sample size required to perform 
             statistical hypothesis tests at specified levels of significance and power. Currently, the package
             implements one-sample proportion tests, one and two-sample z tests, and one and two-sample 
             t tests. A brief user guidance for this package is provided below. One can also refer to the 
             supplemental information for the same.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> MSPRT</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 3.0</td>
</tr>
<tr>
 <td style="text-align: left;">
    Date: </td><td style="text-align: left;"> 11-11-2020</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> GPL&gt;=2</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Sandipan Pramanik [aut, cre],
  Valen E. Johnson [aut],
  Anirban Bhattacharya [aut]
</p>
<p>Maintainer: Sandipan Pramanik &lt;sandy.pramanik@gmail.com&gt;
</p>

<hr>
<h2 id='design.MSPRT'>
Designing the MSPRT
</h2><span id='topic+design.MSPRT'></span>

<h3>Description</h3>

<p>Given the maximum available sample size and prespecified Type I &amp; II error probabilities, this function designs/obtains the corresponding MSPRT.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>design.MSPRT(test.type, side = "right", theta0, theta1 = T, 
             Type1.target = 0.005, Type2.target = 0.2, 
             N.max, N1.max, N2.max, 
             sigma = 1, sigma1 = 1, sigma2 = 1, 
             batch.size, batch1.size, batch2.size, 
             nReplicate = 1e+06, verbose = T, seed = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="design.MSPRT_+3A_test.type">test.type</code></td>
<td>

<p>Character. Type of test. Currently, the package only allows 
</p>

<ul>
<li> <p><code>oneProp</code> for one-sample proportion tests
</p>
</li>
<li> <p><code>oneZ</code> for one-sample z tests
</p>
</li>
<li> <p><code>oneT</code> for one-sample t tests
</p>
</li>
<li> <p><code>twoZ</code> for two-sample z tests
</p>
</li>
<li> <p><code>twoT</code> for two-sample t tests.
</p>
</li></ul>

</td></tr>
<tr><td><code id="design.MSPRT_+3A_side">side</code></td>
<td>

<p>Character. Direction of the composite alternative hypothesis. <code>right</code> for <code class="reqn">H_1 : \theta &gt; \theta_0</code> (<strong>default</strong>), and <code>left</code> for <code class="reqn">H_1 : \theta &lt; \theta_0</code>.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_theta0">theta0</code></td>
<td>

<p>Numeric. Hypothesized value of effect size (<code class="reqn">\theta_0</code>) under <code class="reqn">H_0</code>. 
</p>
<p><strong>Default:</strong> 0.5 in one-sample proportion tests, and 0 for others.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_theta1">theta1</code></td>
<td>

<p>Logical, numeric or list (two components with names <code>'right'</code> and <code>'left'</code>).
</p>

<ul>
<li><p> If <code>FALSE</code>, no comparison is done under the alternative hypothesis.
</p>
</li>
<li><p> If <code>TRUE</code> (<strong>Default</strong>), comparison is done at the fixed-design alternative effect size (<code class="reqn">\theta_a</code>).
</p>
</li>
<li><p> If numeric, this can only be in case of one-sided tests (that is, <code>side = "right"</code> or <code>"left"</code>). The comparison is done at the specified numeric value of the alternative effect size.
</p>
</li>
<li><p> If list, this can only be in case of two-sided tests (that is, <code>side = "both"</code>). The list has to be of the form <code>list("right" =</code> <code class="reqn">\theta_1</code><code>, "left" =</code> <code class="reqn">\theta_2</code>). Then the comparison is done at alternative effect sizes <code class="reqn">\theta_1</code> and <code class="reqn">\theta_2</code>.
</p>
</li></ul>

<p>Note: In case of two-sided tests at a given level of significance, there are two effect sizes under <code class="reqn">H_1</code> (one on the right of <code class="reqn">H_0</code> and one on the left) that corresponds to the same Type II error probability (or power). This list provides users with the ability where he/she can replace <code class="reqn">\theta_1</code> and <code class="reqn">\theta_2</code> by any effect sizes from each side in the form of a list as mentioned above, and can get the designed MSPRT together with its operating characteristics at those effect sizes.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_type1.target">Type1.target</code></td>
<td>

<p>Numeric within [0,1]. Prespecified level of Type I error probability.
</p>
<p><strong>Default:</strong> 0.005.
</p>
<p>The MSPRT exactly maintains its Type I error probability at this value.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_type2.target">Type2.target</code></td>
<td>

<p>Numeric within [0,1]. Prespecified level of Type 2 error probability.
</p>
<p><strong>Default:</strong> 0.2.
</p>
<p>The MSPRT approximately maintains its Type II error probability at this value at the corresponding fixed-design alternative (<code class="reqn">\theta_a</code>).
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_n.max">N.max</code></td>
<td>

<p>Positive integer. Maximum available sample size in one-sample tests.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_n1.max">N1.max</code></td>
<td>

<p>Positive integer. Maximum available sample size from Group-1 in two-sample tests.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_n2.max">N2.max</code></td>
<td>

<p>Positive integer. Maximum available sample size from Group-2 in two-sample tests.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_sigma">sigma</code></td>
<td>

<p>Positive numeric. Known standard deviation in one-sample z tests. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_sigma1">sigma1</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-1 in two-sample z tests. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_sigma2">sigma2</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-2 in two-sample z tests. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_batch.size">batch.size</code></td>
<td>

<p>Integer vector. A vector denoting the number of observations that are planned to be observed at each sequential step in one-sample tests. 
</p>
<p><strong>Default:</strong>
</p>

<ul>
<li><p> Proportion and z tests: <code>rep(1, N.max)</code>.
</p>
</li>
<li><p> t tests: <code>c(2, rep(1, N.max-1))</code>.
</p>
</li></ul>

<p>Default values mean the sequential analysis is performed after observing each observation. This corresponds to a sequential MSPRT. If any batch size is more than 1 (or more than 2 in the 1st step for t test) it corresponds to a group sequential MSPRT.
</p>
<p>Note: First batch size for t tests needs to be at least 2. The length of batch.size equals to the maximum number of planned sequential analyses.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_batch1.size">batch1.size</code></td>
<td>

<p>Integer vector. A vector denoting the number of observations that are planned to be observed from Group-1 at each sequential step in two-sample tests. 
</p>
<p><strong>Default:</strong>
</p>

<ul>
<li><p> z tests: <code>rep(1, N1.max)</code>.
</p>
</li>
<li><p> t tests: <code>c(2, rep(1, N1.max-1))</code>.
</p>
</li></ul>

<p>Default values mean the sequential analysis is performed after observing each observation from Group-1.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_batch2.size">batch2.size</code></td>
<td>

<p>Integer vector. A vector denoting the number of observations that are planned to be observed from Group-2 at each sequential step in two-sample tests. 
</p>
<p><strong>Default:</strong>
</p>

<ul>
<li><p> z tests: <code>rep(1, N2.max)</code>.
</p>
</li>
<li><p> t tests: <code>c(2, rep(1, N2.max-1))</code>.
</p>
</li></ul>

<p>Default values mean the sequential analysis is performed after observing each observation from Group-2.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_nreplicate">nReplicate</code></td>
<td>

<p>Positive integer. Total number of replications to be used in Monte Carlo simulation for calculating the termination threshold and the operating characteristics of the MSPRT. 
</p>
<p><strong>Default:</strong> 1,000,000.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_verbose">verbose</code></td>
<td>

<p>Logical. If <code>TRUE</code> (<strong>default</strong>), returns messages of the current proceedings. Otherwise it doesn't.
</p>
</td></tr>
<tr><td><code id="design.MSPRT_+3A_seed">seed</code></td>
<td>

<p>Integer. Random number generating seed. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List. The list has the following named components in case of one-sided one-sample tests:
</p>
<table>
<tr><td><code>TypeI.attained</code></td>
<td>

<p>Numeric in [0,1]. Type I error probability attained by the designed MSPRT.
</p>
</td></tr>
<tr><td><code>Type2.attained</code></td>
<td>

<p>Numeric in [0,1]. Type II error probability attained by the designed MSPRT at the specified alternative effect size <code>theta1</code>. Returned only if <code>theta1</code> is <code>TRUE</code> or numeric.
</p>
</td></tr>
<tr><td><code>N</code></td>
<td>

<p>List.
</p>

<ul>
<li><p> If <code>theta1 = FALSE</code>, the list has one component named <code>H0</code>. It stores an integer vector of length <code>nReplicate</code>. This is the vector of sample size required by the MSPRT for each of <code>nReplicate</code> Monte Carlo simulations under <code class="reqn">H_0</code>.
</p>
</li>
<li><p> If <code>theta1</code> is <code>TRUE</code> or numeric, the list has two components named <code>H0</code> and <code>H1</code>. Each of these stores an integer vector of length <code>nReplicate</code>. The stored vector under <code>H0</code> is the same as in <code>theta1 = FALSE</code>. The <code>H1</code> component stored the vector of sample size required by the MSPRT for each of <code>nReplicate</code> Monte Carlo simulations under the specified alternative effect size.
</p>
</li></ul>

</td></tr>
<tr><td><code>EN</code></td>
<td>

<p>Numeric vector.
</p>

<ul>
<li><p> If <code>theta1 = FALSE</code>, the vector is of length 1. It is the number of samples required on average by the MSPRT under <code class="reqn">H_0</code>.
</p>
</li>
<li><p> If <code>theta1</code> is <code>TRUE</code> or numeric, the vector is of length 2. They are the number of samples required on average by the MSPRT under <code class="reqn">H_0</code> (first component) and the specified alternative effect size (second component), respectively.
</p>
</li></ul>

</td></tr>
<tr><td><code>UMPBT or theta.UMPBT</code></td>
<td>

<p>The UMPBT alternative. <code>UMPBT</code> in case of one-sample proportion test and <code>theta.UMPBT</code> in case of all the other tests. Their types are the same as their output from <code>UMPBT.alt</code> function.
</p>
<p>Note: Not returned in t tests as it depends on the data.
</p>
</td></tr>
<tr><td><code>theta1</code></td>
<td>

<p>Returned only if <code>theta1</code> is anything but <code>FALSE</code>. Stores the effect size under <code class="reqn">H_1</code> where the operating characteristic of the MSPRT is obtained. Of the same type as the argument <code>theta1</code>.
</p>
</td></tr>
<tr><td><code>Type2.fixed.design</code></td>
<td>

<p>Numeric in [0,1]. Type II error probability attained by the fixed design test with sample size <code>N.max</code> and Type I error probability <code>Type1.target</code> at the alternative effect size <code>theta1</code>.
</p>
</td></tr>
<tr><td><code>RejectH0.threshold</code></td>
<td>

<p>Positive numeric. Threshold for rejecting <code class="reqn">H_0</code> in the MSPRT.
</p>
</td></tr>
<tr><td><code>RejectH1.threshold</code></td>
<td>

<p>Positive numeric. Threshold for accepting <code class="reqn">H_1</code> in the MSPRT.
</p>
</td></tr>
<tr><td><code>termination.threshold</code></td>
<td>

<p>Positive numeric. Termination threshold of the MSPRT.
</p>
</td></tr>
</table>
<p>In case of one-sided two-sample tests the above components are returned with following modifications:
</p>
<table>
<tr><td><code>N:</code></td>
<td>
<p>List.
</p>

<ul>
<li><p> If <code>theta1 = FALSE</code> the list has one component named <code>H0</code>.
</p>
</li>
<li> <p><code>theta1</code> is <code>TRUE</code> or numeric, the list has two components named <code>H0</code> and <code>H1</code>.
</p>
<p>Each of the named components <code>H0</code> and <code>H1</code> contains a list with two components named <code>Group1</code> and <code>Group2</code>. Each of these contains the same vector corresponding to Group-1 and Group-2. In each of these, it contains the sample size required by the MSPRT in each of <code>nReplicate</code> Monte Carlo simulations under the respective effect size for the respective group.
</p>
</li></ul>

</td></tr>
<tr><td><code>EN</code></td>
<td>
<p>List.
</p>

<ul>
<li><p> If <code>theta1 = FALSE</code> the list has one component named <code>H0</code>.
</p>
</li>
<li><p> If <code>theta1</code> is <code>TRUE</code> or numeric, the list has two components named <code>H0</code> and <code>H1</code>.
</p>
</li></ul>

<p>Each of the named components <code>H0</code> or <code>H1</code> contains a list with two components named <code>Group1</code> and <code>Group2</code>. In each of these, it contains the sample size required on average by the MSPRT under the respective effect size for the respective group.
</p>
</td></tr>
</table>
<p>In case of two-sided tests the above components are returned with following modifications:
</p>
<table>
<tr><td><code>Type2.attained</code></td>
<td>

<p>Numeric vector of length 2 with both elements in [0,1]. The first and second component is the Type II error probability of the MSPRT at the specified alternative effect sizes <code>theta1$right</code> and <code>theta1$left</code>, respectively.
</p>
</td></tr>
<tr><td><code>N</code></td>
<td>

<p>This is the same as in one-sided tests if <code>theta1</code> is <code>FALSE</code>. If <code>theta1</code> is <code>TRUE</code> or a two-component list with names <code>right</code> and <code>left</code>, this is a list with three components with names <code>H0</code>, <code>right</code> and <code>left</code> instead of a two-component list with names <code>H0</code> and <code>H1</code>. Quantities stored under these components are the same as in one-sided tests except the quantities under <code>right</code> and <code>left</code> are the same performance of the designed MSPRT at the specified alternative effect sizes <code>theta1$right</code> and <code>theta1$left</code>, respectively.
</p>
</td></tr>
<tr><td><code>EN</code></td>
<td>

<p>Numeric vector. The same as in one-sided tests if <code>theta1</code> is <code>FALSE</code>. If <code>theta1</code> is <code>TRUE</code> or a two-component list with names <code>right</code> and <code>left</code>, this is a numeric vector of length 3, where the first, second and third components are the average required sample size under <code class="reqn">H_0</code>, and at the specified alternative effect sizes <code>theta1$right</code> and <code>theta1$left</code>, respectively.
</p>
</td></tr>
</table>
<p>Additionally, the output list also contains the provided arguments of design.MSPRT, and 
</p>
<table>
<tr><td><code>nAnalyses</code></td>
<td>

<p>Positive integer. This is the maximum number of sequential analyses that is planned. This equals to the <code>length(batch.size)</code> in one-sample tests, and to the <code>length(batch1.size)</code> and <code>length(batch2.size)</code> in two-sample tests.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>


<h3>References</h3>

<p>Pramanik S., Johnson V. E. and Bhattacharya A. (2020+). A Modified Sequential Probability Ratio Test. <a href="https://arxiv.org/pdf/1811.08478.pdf">[Arxiv]</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##### one-sample proportion test #####

## right-sided
#design.MSPRT(test.type = 'oneProp', side = 'right',
#             N.max = 20)

## left-sided
#design.MSPRT(test.type = 'oneProp', side = 'right',
#             N.max = 20)

## two-sided
#design.MSPRT(test.type = 'oneProp', side = 'both',
#             N.max = 20)


##### one-sample z test #####

## right-sided
#design.MSPRT(test.type = 'oneZ', side = 'right',
#             N.max = 20)

## left-sided
#design.MSPRT(test.type = 'oneZ', side = 'right',
#             N.max = 20)

## two-sided
#design.MSPRT(test.type = 'oneZ', side = 'both',
#              N.max = 20)


##### one-sample t test #####

## right-sided
#design.MSPRT(test.type = 'oneT', side = 'right',
#             N.max = 20)

## left-sided
#design.MSPRT(test.type = 'oneT', side = 'right',
#             N.max = 20)

## two-sided
#design.MSPRT(test.type = 'oneT', side = 'both',
#             N.max = 20)


##### two-sample z test #####

## right-sided
#design.MSPRT(test.type = 'twoZ', side = 'right',
#             N1.max = 20, N2.max = 20)

## left-sided
#design.MSPRT(test.type = 'twoZ', side = 'left',
#             N1.max = 20, N2.max = 20)

## two-sided
#design.MSPRT(test.type = 'twoZ', side = 'both',
#             N1.max = 20, N2.max = 20)


##### two-sample t test #####

## right-sided
#design.MSPRT(test.type = 'twoT', side = 'right',
#             N1.max = 20, N2.max = 20)

## left-sided
#design.MSPRT(test.type = 'twoT', side = 'left',
#             N1.max = 20, N2.max = 20)

## two-sided
#design.MSPRT(test.type = 'twoT', side = 'both',
#             N1.max = 20, N2.max = 20)
</code></pre>

<hr>
<h2 id='design.MSPRT_oneProp'>
Internal MSPRT function: Designing the MSPRT for one-sample proportion tests
</h2><span id='topic+design.MSPRT_oneProp'></span>

<h3>Description</h3>

<p><code><a href="#topic+design.MSPRT">design.MSPRT</a></code> calls this function for designing the MSPRT in one-sample proportion tests. Users please refer to <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='design.MSPRT_oneT'>
Internal MSPRT function: Designing the MSPRT for one-sample t tests
</h2><span id='topic+design.MSPRT_oneT'></span>

<h3>Description</h3>

<p><code><a href="#topic+design.MSPRT">design.MSPRT</a></code> calls this function for designing the MSPRT in one-sample t tests. Users please refer to <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='design.MSPRT_oneZ'>
Internal MSPRT function: Designing the MSPRT for one-sample z tests
</h2><span id='topic+design.MSPRT_oneZ'></span>

<h3>Description</h3>

<p><code><a href="#topic+design.MSPRT">design.MSPRT</a></code> calls this function for designing the MSPRT in one-sample z tests. Users please refer to <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='design.MSPRT_twoT'>
Internal MSPRT function: Designing the MSPRT for two-sample t tests
</h2><span id='topic+design.MSPRT_twoT'></span>

<h3>Description</h3>

<p><code><a href="#topic+design.MSPRT">design.MSPRT</a></code> calls this function for designing the MSPRT in two-sample t tests. Users please refer to <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='design.MSPRT_twoZ'>
Internal MSPRT function: Designing the MSPRT for two-sample z tests
</h2><span id='topic+design.MSPRT_twoZ'></span>

<h3>Description</h3>

<p><code><a href="#topic+design.MSPRT">design.MSPRT</a></code> calls this function for designing the MSPRT in two-sample z tests. Users please refer to <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='effectiveN.oneProp'>
Calculating effective maximum sample size to be used in designing the MSPRT in one-sample proportion test
</h2><span id='topic+effectiveN.oneProp'></span>

<h3>Description</h3>

<p>Given a maximum sample size that is planned to use, this function obtains the maximum sample size (<code class="reqn">N</code>) that is suggested to use in designing the MSPRT for one-sample proportion tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effectiveN.oneProp(N, side = "right", Type1 = 0.005, theta0 = 0.5, 
                   plot.it = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effectiveN.oneProp_+3A_n">N</code></td>
<td>

<p>Positive integer. Maximum sample that is intended to use.
</p>
</td></tr>
<tr><td><code id="effectiveN.oneProp_+3A_side">side</code></td>
<td>

<p>Character. Direction of the composite alternative hypothesis. <code>right</code> for <code class="reqn">H_1 : \theta &gt; \theta_0</code> (<strong>default</strong>), and <code>left</code> for <code class="reqn">H_1 : \theta &lt; \theta_0</code>.
</p>
</td></tr>
<tr><td><code id="effectiveN.oneProp_+3A_type1">Type1</code></td>
<td>

<p>Numeric in [0,1]. Prespecified Type I error probability. <strong>Default:</strong> 0.005.
</p>
</td></tr>
<tr><td><code id="effectiveN.oneProp_+3A_theta0">theta0</code></td>
<td>

<p>Numeric. Hypothesized value of effect size (<code class="reqn">\theta_0</code>) under <code class="reqn">H_0</code>. <strong>Default:</strong> 0.5.
</p>
</td></tr>
<tr><td><code id="effectiveN.oneProp_+3A_plot.it">plot.it</code></td>
<td>

<p>Logical. If <code>TRUE</code> (<strong>default</strong>), returns a plot. Otherwise it doesn't.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Positive integer. This is suggested to use in <code><a href="#topic+OCandASN.MSPRT">OCandASN.MSPRT</a></code> as the maximum availeble sample size (<code class="reqn">N</code>) to design the MSPRT for one-sample proportion tests.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>


<h3>References</h3>

<p>Pramanik S., Johnson V. E. and Bhattacharya A. (2020+). A Modified Sequential Probability Ratio Test. <a href="https://arxiv.org/pdf/1811.08478.pdf">[Arxiv]</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>effectiveN.oneProp(N = 30)
</code></pre>

<hr>
<h2 id='fixed_design.alt'>
Fixed-design alternative
</h2><span id='topic+fixed_design.alt'></span>

<h3>Description</h3>

<p>Given a sample size and prespecified Type I &amp; II error probabilities, this function obtains the fixed-design alternative (<code class="reqn">\theta_a</code>) for testing the point null hypothesis <code class="reqn">H_0 : \theta = \theta_0</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixed_design.alt(test.type, side = "right", theta0, 
                 N, N1, N2, Type1 = 0.005, Type2 = 0.2, 
                 sigma = 1, sigma1 = 1, sigma2 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixed_design.alt_+3A_test.type">test.type</code></td>
<td>

<p>Character. Type of test. Currently, the package only allows 
</p>

<ul>
<li> <p><code>oneProp</code> for one-sample proportion tests
</p>
</li>
<li> <p><code>oneZ</code> for one-sample z tests
</p>
</li>
<li> <p><code>oneT</code> for one-sample t tests
</p>
</li>
<li> <p><code>twoZ</code> for two-sample z tests
</p>
</li>
<li> <p><code>twoT</code> for two-sample t tests.
</p>
</li></ul>

</td></tr>
<tr><td><code id="fixed_design.alt_+3A_side">side</code></td>
<td>

<p>Character. Direction of the composite alternative hypothesis. <code>right</code> for <code class="reqn">H_1 : \theta &gt; \theta_0</code> (<strong>default</strong>), and <code>left</code> for <code class="reqn">H_1 : \theta &lt; \theta_0</code>.
</p>
</td></tr>
<tr><td><code id="fixed_design.alt_+3A_theta0">theta0</code></td>
<td>

<p>Numeric. Hypothesized value of effect size (<code class="reqn">\theta_0</code>) under <code class="reqn">H_0</code>. <strong>Default:</strong> 0.5 in one-sample proportion tests, and 0 for others.
</p>
</td></tr>
<tr><td><code id="fixed_design.alt_+3A_n">N</code></td>
<td>

<p>Positive integer. Sample size in one-sample tests.
</p>
</td></tr>
<tr><td><code id="fixed_design.alt_+3A_n1">N1</code></td>
<td>

<p>Positive integer. Sample size from Group-1 in two-sample tests.
</p>
</td></tr>
<tr><td><code id="fixed_design.alt_+3A_n2">N2</code></td>
<td>

<p>Positive integer. Sample size from Group-2 in two-sample tests.
</p>
</td></tr>
<tr><td><code id="fixed_design.alt_+3A_type1">Type1</code></td>
<td>

<p>Numeric in [0,1]. Prespecified Type I error probability. <strong>Default:</strong> 0.005.
</p>
</td></tr>
<tr><td><code id="fixed_design.alt_+3A_type2">Type2</code></td>
<td>

<p>Numeric in [0,1]. Prespecified Type II error probability. <strong>Default:</strong> 0.2.
</p>
</td></tr>
<tr><td><code id="fixed_design.alt_+3A_sigma">sigma</code></td>
<td>

<p>Positive numeric. Known standard deviation in one-sample z tests. <strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="fixed_design.alt_+3A_sigma1">sigma1</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-1 in two-sample z tests. <strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="fixed_design.alt_+3A_sigma2">sigma2</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-2 in two-sample z tests. <strong>Default:</strong> 1.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric. The fixed-design alternative effect size (<code class="reqn">\theta_a</code>).
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>


<h3>References</h3>

<p>Pramanik S., Johnson V. E. and Bhattacharya A. (2020+). A Modified Sequential Probability Ratio Test. <a href="https://arxiv.org/pdf/1811.08478.pdf">[Arxiv]</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##### one-sample proportion test #####

## right-sided
fixed_design.alt(test.type = "oneProp", N = 30)

## left-sided
fixed_design.alt(side = "left", test.type = "oneProp", N = 30)


##### one-sample z test #####

## right-sided
fixed_design.alt(test.type = "oneZ", N = 30)

## left-sided
fixed_design.alt(side = "left", test.type = "oneZ", N = 30)


##### one-sample t test #####

## right-sided
fixed_design.alt(test.type = "oneT", N = 30)

## left-sided
fixed_design.alt(side = "left", test.type = "oneT", N = 30)


##### two-sample z test #####

## right-sided
fixed_design.alt(test.type = "twoZ", N1 = 30, N2 = 30)

## left-sided
fixed_design.alt(side = "left", test.type = "twoZ", N1 = 30, N2 = 30)


##### two-sample t test #####

## right-sided
fixed_design.alt(test.type = "twoT", N1 = 30, N2 = 30)

## left-sided
fixed_design.alt(side = "left", test.type = "twoT", N1 = 30, N2 = 30)
</code></pre>

<hr>
<h2 id='implement.MSPRT'>
Implementing the MSPRT
</h2><span id='topic+implement.MSPRT'></span>

<h3>Description</h3>

<p>This function implements the MSPRT for a sequentially observed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>implement.MSPRT(obs, obs1, obs2, design.MSPRT.object, 
                termination.threshold, test.type, side = "right",
                theta0, Type1.target = 0.005, Type2.target = 0.2,
                N.max, N1.max, N2.max, 
                sigma = 1, sigma1 = 1, sigma2 = 1,
                batch.size, batch1.size, batch2.size,
                verbose = T, plot.it = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="implement.MSPRT_+3A_obs">obs</code></td>
<td>

<p>Numeric vector. The vector of data in the order they are sequentially observed for one-sample tests.
Note: Its length can't exceed the length of <code>batch.size</code>.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_obs1">obs1</code></td>
<td>

<p>Numeric vector. The vector of data in the order they are sequentially observed from Group-1 for two-sample tests.
Note: Its length can't exceed the length of <code>batch1.size</code>.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_obs2">obs2</code></td>
<td>

<p>Numeric vector. The vector of data in the order they are sequentially observed from Group-2 for two-sample tests.
Note: Its length can't exceed the length of <code>batch2.size</code>.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_design.msprt.object">design.MSPRT.object</code></td>
<td>

<p>List. The output returned from <code><a href="#topic+design.MSPRT">design.MSPRT</a></code> corresponding to the MSPRT for which the operating characteristics are desired.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_termination.threshold">termination.threshold</code></td>
<td>

<p>Positive numeric. Termination threshold of the designed MSPRT.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_test.type">test.type</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_side">side</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_theta0">theta0</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_type1.target">Type1.target</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_type2.target">Type2.target</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_n.max">N.max</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_n1.max">N1.max</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_n2.max">N2.max</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_sigma">sigma</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_sigma1">sigma1</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_sigma2">sigma2</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_batch.size">batch.size</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_batch1.size">batch1.size</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_batch2.size">batch2.size</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_verbose">verbose</code></td>
<td>

<p>Logical. If TRUE (<strong>default</strong>), returns messages of the current proceedings. Otherwise it doesn't.
</p>
</td></tr>
<tr><td><code id="implement.MSPRT_+3A_plot.it">plot.it</code></td>
<td>

<p>0, 1 or 2 (<strong>default</strong>). 
</p>

<ul>
<li><p> if <code>plot.it=0</code>, no plot is returned.
</p>
</li>
<li><p> if <code>plot.it=1</code>, only the ggplot object required to get a comparison plot is returned, but it's not plotted.
</p>
</li>
<li><p> if <code>plot.it=2</code>, a comparison plot and the corresponding ggplot object is returned.
</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>

<p>If <code>design.MSPRT.object</code> is provided, one can only additionally provide <code>nReplicate</code>, <code>nCore</code>, <code>verbose</code> and <code>seed</code> (Easier option). Otherwise, just like in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>, all the other arguments together with <code>termination.threshold</code> (obtained from <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>) needs to be provided adequately.
</p>


<h3>Value</h3>

<p>List. The list has the following named components in case of one-sided one-sample tests:
</p>
<table>
<tr><td><code>n</code></td>
<td>

<p>Positive integer. Number of samples required to reach the decision.
</p>
</td></tr>
<tr><td><code>decision</code></td>
<td>

<p>Character. The decision reached. The possibilities are <code>'accept'</code>, <code>'reject'</code> and <code>'continue'</code>. They respectively correspond to accepting <code class="reqn">H_0</code>, rejecting <code class="reqn">H_0</code> and continue sampling.
</p>
</td></tr>
<tr><td><code>RejectH0.threshold</code></td>
<td>

<p>Positive numeric. Threshold for rejecting <code class="reqn">H_0</code> in the MSPRT.
</p>
</td></tr>
<tr><td><code>RejectH1.threshold</code></td>
<td>

<p>Positive numeric. Threshold for accepting <code class="reqn">H_1</code> in the MSPRT.
</p>
</td></tr>
<tr><td><code>LR</code></td>
<td>

<p>Numeric vector. Vector of weighted likelihood ratios (proportion tests) or likelihood ratios (z tests) or Bayes factor (t tests) that are computed at each step of sequential analysis until either a decision is reached or the maximum available number of samples (<code>N.max</code> in one-sample tests, or <code>N1.max</code> and <code>N2.max</code> in two-sample tests) has been used.
</p>
</td></tr>
<tr><td><code>UMPBT alternative</code></td>
<td>

<p>This stores the UMPBT alternative(s) as
</p>

<ul>
<li> <p><code>UMPBT</code> for proportion tests. Of the same type as it is returned by <code>UMPBT.alt</code> in these tests.
</p>
</li>
<li> <p><code>theta.UMPBT</code> for z and t tests. This is a numeric in case of z tests and a numeric vector in case of t tests. For t tests the UMPBT alternative depends on the data. So the numeric vector returned in this case contains the UMPBT alternative computed at step of sequential analysis and is based on all data observed until that step.
</p>
</li></ul>

</td></tr>
</table>
<p>In case of two-sample tests, the <code>n</code> output above is replaced by <code>n1</code> and <code>n2</code>. They are positive integers and refer to the number of samples from Group-1 and 2 required to reach the decision.
</p>
<p>In case of two-sided tests at level of significance <code class="reqn">\alpha</code>, the MSPRT carries out a right and a left sided test simultaneously at level of significance <code class="reqn">\alpha/2</code>. In this case the outputs are same as above with following changes in components in the returned list:
</p>
<table>
<tr><td><code>LR</code></td>
<td>

<p>List. It has two components named <code>right</code> and <code>left</code> corresponding to the right and left sided tests of size <code class="reqn">\alpha/2</code>. Each of these components stores the vector of weighted likelihood ratios (proportion tests) or likelihood ratios (z tests) or Bayes factor (t tests) that are computed at each step of sequential analysis until either a decision is reached or the maximum available number of samples (<code>N.max</code> in one-sample tests, or <code>N1.max</code> and <code>N2.max</code> in two-sample tests) has been used for that sided test.
</p>
</td></tr>
<tr><td><code>UMPBT or theta.UMPBT</code></td>
<td>
<p>List with two components named <code>right</code> and <code>left</code> corresponding to the right and left sided tests of size <code class="reqn">\alpha/2</code>. Each of these contains the UMPBT alternative (of the same type as the output from <code>UMPBT.alt</code> for the test with respective sides.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>


<h3>References</h3>

<p>Pramanik S., Johnson V. E. and Bhattacharya A. (2020+). A Modified Sequential Probability Ratio Test. <a href="https://arxiv.org/pdf/1811.08478.pdf">[Arxiv]</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#################### one-sample proportion test ####################

#### right sided ####
### design
#design.oneprop.right = design.MSPRT(test.type = 'oneProp', side = 'right',
#                                    N.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0.5  # change effect size to experiment
#y = rbinom(20, 1, theta.gen)
#implement.oneprop.right = implement.MSPRT(obs = y, 
#                                          design.MSPRT.object = design.oneprop.right)

#### left sided ####
### design
#design.oneprop.left = design.MSPRT(test.type = 'oneProp', side = 'left',
#                                   N.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0.5  # change effect size to experiment
#y = rbinom(20, 1, theta.gen)
#implement.oneprop.left = implement.MSPRT(obs = y, 
#                                          design.MSPRT.object = design.oneprop.left)

#### both sided ####
### design
#design.oneprop.both = design.MSPRT(test.type = 'oneProp', side = 'both',
#                                   N.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0.5  # change effect size to experiment
#y = rbinom(20, 1, theta.gen)
#implement.oneprop.both = implement.MSPRT(obs = y, 
#                                         design.MSPRT.object = design.oneprop.both)


#################### one-sample z test ####################

#### right sided ####
### design
#design.onez.right = design.MSPRT(test.type = 'oneZ', side = 'right',
#                                 N.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y = rnorm(20, theta.gen, design.onez.right$sigma)
#implement.onez.right = implement.MSPRT(obs = y, 
#                                       design.MSPRT.object = design.onez.right)

#### left sided ####
### design
#design.onez.left = design.MSPRT(test.type = 'oneZ', side = 'left',
#                                N.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y = rnorm(20, theta.gen, design.onez.left$sigma)
#implement.onez.left = implement.MSPRT(obs = y, 
#                                      design.MSPRT.object = design.onez.left)

#### both sided ####
### design
#design.onez.both = design.MSPRT(test.type = 'oneZ', side = 'both',
#                                N.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y = rnorm(20, theta.gen, design.onez.both$sigma)
#implement.onez.both = implement.MSPRT(obs = y, 
#                                      design.MSPRT.object = design.onez.both)


#################### one-sample t test ####################

#### right sided ####
### design
#design.onet.right = design.MSPRT(test.type = 'oneT', side = 'right',
#                                 N.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y = rnorm(20, theta.gen, 1)
#implement.onet.right = implement.MSPRT(obs = y, 
#                                       design.MSPRT.object = design.onet.right)

#### left sided ####
### design
#design.onet.left = design.MSPRT(test.type = 'oneT', side = 'left',
#                                N.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y = rnorm(20, theta.gen, 1)
#implement.onet.left = implement.MSPRT(obs = y, 
#                                      design.MSPRT.object = design.onet.left)

#### both sided ####
### design
#design.onet.both = design.MSPRT(test.type = 'oneT', side = 'both',
#                                N.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y = rnorm(20, theta.gen, 1)
#implement.onet.both = implement.MSPRT(obs = y, 
#                                      design.MSPRT.object = design.onet.both)


#################### two-sample z test ####################

#### right sided ####
### design
#design.twoz.right = design.MSPRT(test.type = 'twoZ', side = 'right',
#                                 N1.max = 20, N2.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y1 = rnorm(20, theta.gen/2, design.twoz.right$sigma1)
#y2 = rnorm(20, -theta.gen/2, design.twoz.right$sigma2)
#implement.twoz.right = implement.MSPRT(obs1 = y1, obs2 = y2,
#                                       design.MSPRT.object = design.twoz.right)

#### left sided ####
### design
#design.twoz.left = design.MSPRT(test.type = 'twoZ', side = 'left',
#                                N1.max = 20, N2.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y1 = rnorm(20, theta.gen/2, design.twoz.left$sigma1)
#y2 = rnorm(20, -theta.gen/2, design.twoz.left$sigma2)
#implement.twoz.left = implement.MSPRT(obs1 = y1, obs2 = y2,
#                                      design.MSPRT.object = design.twoz.left)

#### both sided ####
### design
#design.twoz.both = design.MSPRT(test.type = 'twoZ', side = 'both',
#                                N1.max = 20, N2.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y1 = rnorm(20, theta.gen/2, design.twoz.both$sigma1)
#y2 = rnorm(20, -theta.gen/2, design.twoz.both$sigma2)
#implement.twoz.both = implement.MSPRT(obs1 = y1, obs2 = y2,
#                                      design.MSPRT.object = design.twoz.both)


#################### two-sample t test ####################

#### right sided ####
### design
#design.twot.right = design.MSPRT(test.type = 'twoT', side = 'right',
#                                 N1.max = 20, N2.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y1 = rnorm(20, theta.gen/2, 1)
#y2 = rnorm(20, -theta.gen/2, 1)
#implement.twot.right = implement.MSPRT(obs1 = y1, obs2 = y2,
#                                       design.MSPRT.object = design.twot.right)

#### left sided ####
### design
#design.twot.left = design.MSPRT(test.type = 'twoT', side = 'left',
#                                N1.max = 20, N2.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y1 = rnorm(20, theta.gen/2, 1)
#y2 = rnorm(20, -theta.gen/2, 1)
#implement.twot.left = implement.MSPRT(obs1 = y1, obs2 = y2,
#                                      design.MSPRT.object = design.twot.left)

#### both sided ####
### design
#design.twot.both = design.MSPRT(test.type = 'twoT', side = 'both',
#                                N1.max = 20, N2.max = 20)

### implementation
#set.seed(1)
#theta.gen = 0  # change effect size to experiment
#y1 = rnorm(20, theta.gen/2, 1)
#y2 = rnorm(20, -theta.gen/2, 1)
#implement.twot.both = implement.MSPRT(obs1 = y1, obs2 = y2,
#                                      design.MSPRT.object = design.twot.both)
</code></pre>

<hr>
<h2 id='implement.MSPRT_oneProp'>
Internal MSPRT function: Implementing the MSPRT in one-sample proportion tests
</h2><span id='topic+implement.MSPRT_oneProp'></span>

<h3>Description</h3>

<p><code><a href="#topic+implement.MSPRT">implement.MSPRT</a></code> calls this function for implementing the MSPRT in one-sample proportion tests. Users please refer to <code><a href="#topic+implement.MSPRT">implement.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='implement.MSPRT_oneT'>
Internal MSPRT function: Implementing the MSPRT in one-sample t tests
</h2><span id='topic+implement.MSPRT_oneT'></span>

<h3>Description</h3>

<p><code><a href="#topic+implement.MSPRT">implement.MSPRT</a></code> calls this function for implementing the MSPRT in one-sample t tests. Users please refer to <code><a href="#topic+implement.MSPRT">implement.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='implement.MSPRT_oneZ'>
Internal MSPRT function: Implementing the MSPRT in one-sample z tests
</h2><span id='topic+implement.MSPRT_oneZ'></span>

<h3>Description</h3>

<p><code><a href="#topic+implement.MSPRT">implement.MSPRT</a></code> calls this function for implementing the MSPRT in one-sample z tests. Users please refer to <code><a href="#topic+implement.MSPRT">implement.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='implement.MSPRT_twoT'>
Internal MSPRT function: Implementing the MSPRT in two-sample t tests
</h2><span id='topic+implement.MSPRT_twoT'></span>

<h3>Description</h3>

<p><code><a href="#topic+implement.MSPRT">implement.MSPRT</a></code> calls this function for implementing the MSPRT in two-sample t tests. Users please refer to <code><a href="#topic+implement.MSPRT">implement.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='implement.MSPRT_twoZ'>
Internal MSPRT function: Implementing the MSPRT in two-sample z tests
</h2><span id='topic+implement.MSPRT_twoZ'></span>

<h3>Description</h3>

<p><code><a href="#topic+implement.MSPRT">implement.MSPRT</a></code> calls this function for implementing the MSPRT in two-sample z tests. Users please refer to <code><a href="#topic+implement.MSPRT">implement.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='Nstar'>
Sample size required to achieve higher significance
</h2><span id='topic+Nstar'></span>

<h3>Description</h3>

<p>Given the sample size that is available at a lower level of significance, this function calculates the sample size that is required for achieving a higher level of significance so that a desired level of Type II error probability is maintained at a desired effect size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Nstar(test.type, N, N1, N2, 
      N.increment = 1, N1.increment = 1, N2.increment = 1, 
      lower.signif = 0.05, higher.signif = 0.005, theta0, 
      side = "right", Type2.target = 0.2, theta, 
      sigma = 1, sigma1 = 1, sigma2 = 1, plot.it = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Nstar_+3A_test.type">test.type</code></td>
<td>

<p>Character. Type of test. Currently, the package only allows 
</p>

<ul>
<li> <p><code>oneProp</code> for one-sample proportion tests
</p>
</li>
<li> <p><code>oneZ</code> for one-sample z tests
</p>
</li>
<li> <p><code>oneT</code> for one-sample t tests
</p>
</li>
<li> <p><code>twoZ</code> for two-sample z tests
</p>
</li>
<li> <p><code>twoT</code> for two-sample t tests.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Nstar_+3A_n">N</code></td>
<td>

<p>Positive integer. Sample size available at the lower level of significance in one-sample tests.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_n1">N1</code></td>
<td>

<p>Positive integer. Sample size available from Group-1 at the lower level of significance in two-sample tests.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_n2">N2</code></td>
<td>

<p>Positive integer. Sample size available from Group-2 at the lower level of significance in two-sample tests.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_n.increment">N.increment</code></td>
<td>

<p>Positive integer. Increment in sample size allowed while searching for the sample size that is required for achieving the higher level of significance.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_n1.increment">N1.increment</code></td>
<td>

<p>Positive integer. Increment in sample size from Group-1 allowed while searching for the sample size that is required for achieving the higher level of significance.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_n2.increment">N2.increment</code></td>
<td>

<p>Positive integer. Increment in sample size from Group-2 allowed while searching for the sample size that is required for achieving the higher level of significance.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_lower.signif">lower.signif</code></td>
<td>

<p>Numeric within [0,1]. Lower level of significance. <strong>Default</strong> 0.05.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_higher.signif">higher.signif</code></td>
<td>

<p>Numeric within [0,1]. Higher level of significance. <strong>Default:</strong> 0.005.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_theta0">theta0</code></td>
<td>

<p>Numeric. Hypothesized value of effect size (<code class="reqn">\theta_0</code>) under <code class="reqn">H_0</code>. <strong>Default:</strong> 0.5 in one-sample proportion tests, and 0 for others.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_side">side</code></td>
<td>

<p>Character. Direction of the composite alternative hypothesis. <code>right</code> for <code class="reqn">H_1 : \theta &gt; \theta_0</code> (<strong>default</strong>), and <code>left</code> for <code class="reqn">H_1 : \theta &lt; \theta_0</code>.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_type2.target">Type2.target</code></td>
<td>

<p>Numeric within [0,1]. Prespecified level of Type 2 error probability.
</p>
<p><strong>Default:</strong> 0.2.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_theta">theta</code></td>
<td>

<p>Numeric. Effect size value where <code>Type2.target</code> Type II error probability is desired at both levels of significance. <strong>Default:</strong> Fixed-design alternative (<code class="reqn">\theta_a</code>) at the lower level of significance; that is, the effect size where the fixed design test with <code class="reqn">N</code> samples and level of significance <code>lower.signif</code> has the Type II error probability <code>Type2.target</code>.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_sigma">sigma</code></td>
<td>

<p>Positive numeric. Known standard deviation in one-sample z tests. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_sigma1">sigma1</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-1 in two-sample z tests. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_sigma2">sigma2</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-2 in two-sample z tests. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="Nstar_+3A_plot.it">plot.it</code></td>
<td>

<p>Logical. If <code>TRUE</code> (<strong>default</strong>), returns a plot. Otherwise it doesn't.
</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p> One-sample tests: Numeric. The required sample size.
</p>
</li>
<li><p> Two-sample tests: Numeric vector of length 2. The first and second components store the sample sizes required respectively from Group 1 and 2 for achieving the higher level of significance.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>


<h3>References</h3>

<p>Pramanik S., Johnson V. E. and Bhattacharya A. (2020+). A Modified Sequential Probability Ratio Test. <a href="https://arxiv.org/pdf/1811.08478.pdf">[Arxiv]</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##### one-sample proportion test #####

## right-sided
Nstar(test.type = "oneProp", N = 30)

## left-sided
Nstar(test.type = "oneProp", side = "left", N = 30)


##### one-sample z test #####

## right-sided
Nstar(test.type = "oneZ", N = 30)

## left-sided
Nstar(test.type = "oneZ", side = "left", N = 30)


##### one-sample t test #####

## right-sided
Nstar(test.type = "oneT", N = 30)

## left-sided
Nstar(test.type = "oneT", side = "left", N = 30)


##### two-sample z test #####

## right-sided
Nstar(test.type = "twoZ", N1 = 30, N2 = 30)

## left-sided
Nstar(test.type = "twoZ", side = "left", N1 = 30, N2 = 30)


##### two-sample t test #####

## right-sided
Nstar(test.type = "twoT", N1 = 30, N2 = 30)

## left-sided
Nstar(test.type = "twoT", side = "left", N1 = 30, N2 = 30)
</code></pre>

<hr>
<h2 id='OCandASN.MSPRT'>
Operating characteristics (OC) and Average Sample Number (ASN) of a designed MSPRT
</h2><span id='topic+OCandASN.MSPRT'></span>

<h3>Description</h3>

<p>This function obtains the operating characteristics, that is the probability of accepting <code class="reqn">H_0</code> and the sample size required on average for reaching a decision, for a designed MSPRT at the specified effect size(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OCandASN.MSPRT(theta, design.MSPRT.object, 
               termination.threshold, test.type, side = "right", 
               theta0, Type1.target = 0.005, Type2.target = 0.2,
               N.max, N1.max, N2.max,
               sigma = 1, sigma1 = 1, sigma2 = 1, 
               batch.size, batch1.size, batch2.size, 
               nReplicate = 1e+06, nCore = max(1, detectCores() - 1),
               verbose = T, seed = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OCandASN.MSPRT_+3A_theta">theta</code></td>
<td>

<p>Numeric vector. Vector of effect size(s) where the operating characteristics of the MSPRT is desired.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_design.msprt.object">design.MSPRT.object</code></td>
<td>

<p>List. The output returned from <code><a href="#topic+design.MSPRT">design.MSPRT</a></code> corresponding to the MSPRT for which the operating characteristics are desired.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_termination.threshold">termination.threshold</code></td>
<td>

<p>Positive numeric. Termination threshold of the designed MSPRT.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_test.type">test.type</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_side">side</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_theta0">theta0</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_type1.target">Type1.target</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_type2.target">Type2.target</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_n.max">N.max</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_n1.max">N1.max</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_n2.max">N2.max</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_sigma">sigma</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_sigma1">sigma1</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_sigma2">sigma2</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_batch.size">batch.size</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_batch1.size">batch1.size</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_batch2.size">batch2.size</code></td>
<td>

<p>Same as in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>. Not required if <code>design.MSPRT.object</code> is provided.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_nreplicate">nReplicate</code></td>
<td>

<p>Positive integer. Total number of replications to be used in Monte Carlo simulation for calculating the termination threshold and the operating characteristics of the MSPRT. 
</p>
<p><strong>Default:</strong> 1,000,000.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_verbose">verbose</code></td>
<td>

<p>Logical. If <code>TRUE</code> (<strong>default</strong>), returns messages of the current proceedings. Otherwise it doesn't.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_ncore">nCore</code></td>
<td>

<p>Positive integer. Total number of cores available for computation. Can be anything <code class="reqn">\ge 1</code>. 
</p>
<p><strong>Default:</strong> <code>detectCores() - 1</code>. That is, 1 less than the total number of available cores.
</p>
</td></tr>
<tr><td><code id="OCandASN.MSPRT_+3A_seed">seed</code></td>
<td>

<p>Integer. Random number generating seed. 
</p>
<p><strong>Default:</strong> 1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>design.MSPRT.object</code> is provided, one can only additionally provide <code>nReplicate</code>, <code>nCore</code>, <code>verbose</code> and <code>seed</code> (Easier option). Otherwise, just like in <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>, all the other arguments together with <code>termination.threshold</code> (obtained from <code><a href="#topic+design.MSPRT">design.MSPRT</a></code>) needs to be provided adequately.
</p>


<h3>Value</h3>

<p>Data frame.
</p>

<ul>
<li><p> One-sample tests: The data frame has 3 columns named <code>theta</code>, <code>acceptH0.prob</code> and <code>EN</code>, and the number of rows equals to the number of effect sizes (length of <code>theta</code>) where the operating characteristics are evaluated. Each row corresponds to a particular value of theta (effect size). The columns respectively contain the value of a particular theta (effect size), and the probability of accepting the $H_0$ and the average sample size required by the MSPRT for reaching a decision thereat.
</p>
</li>
<li><p> Two-sample tests: The data frame has 4 columns named <code>theta</code>, <code>acceptH0.prob</code>, <code>EN1</code> and <code>EN2</code>, and the number of rows equals to the number of effect sizes (length of <code>theta</code>) where the operating characteristics are evaluated. Each row corresponds to a particular value of theta (effect size). The columns respectively contain the value of a particular theta (effect size), and the probability of accepting the <code class="reqn">H_0</code> at that effect size, and the average sample size from Group-1 &amp; 2 that is required by the MSPRT for reaching a decision thereat.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>


<h3>References</h3>

<p>Pramanik S., Johnson V. E. and Bhattacharya A. (2020+). A Modified Sequential Probability Ratio Test. <a href="https://arxiv.org/pdf/1811.08478.pdf">[Arxiv]</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#################### one-sample proportion test ####################

#### right sided ####
### design
#design.oneprop.right &lt;- design.MSPRT(test.type = 'oneProp', side = 'right',
#                                     N.max = 20)

### OC and ASN
#OC.oneprop.right &lt;- OCandASN.MSPRT(theta = seq(design.oneprop.right$theta0, 1,
#                                               length.out = 3),
#                                   design.MSPRT.object = design.oneprop.right)

#### left sided ####
### design
#design.oneprop.left = design.MSPRT(test.type = 'oneProp', side = 'left',
#                                   N.max = 20)

### OC and ASN
#OC.oneprop.left = OCandASN.MSPRT(theta = seq(0, design.oneprop.right$theta0,
#                                             length.out = 3),
#                                 design.MSPRT.object = design.oneprop.left)

#### both sided ####
### design
#design.oneprop.both = design.MSPRT(test.type = 'oneProp', side = 'both',
#                                   N.max = 20)

### OC and ASN
#OC.oneprop.both = OCandASN.MSPRT(theta = seq(0, 1, length.out = 3),
#                                 design.MSPRT.object = design.oneprop.both)


#################### one-sample z test ####################

#### right sided ####
### design
#design.onez.right = design.MSPRT(test.type = 'oneZ', side = 'right',
#                                 N.max = 20)

### OC and ASN
#OC.onez.right = OCandASN.MSPRT(theta = seq(design.onez.right$theta0,
#                                           design.onez.right$theta0 + 3*design.onez.right$sigma,
#                                           length.out = 3),
#                               design.MSPRT.object = design.onez.right)

#### left sided ####
### design
#design.onez.left = design.MSPRT(test.type = 'oneZ', side = 'left',
#                                N.max = 20)

### OC and ASN
#OC.onez.left = OCandASN.MSPRT(theta = seq(design.onez.left$theta0 - 3*design.onez.left$sigma,
#                                          design.onez.left$theta0,
#                                          length.out = 3),
#                              design.MSPRT.object = design.onez.left)

#### both sided ####
### design
#design.onez.both = design.MSPRT(test.type = 'oneZ', side = 'both',
#                                N.max = 20)

### OC and ASN
#OC.onez.both = OCandASN.MSPRT(theta = seq(design.onez.both$theta0 - 3*design.onez.both$sigma,
#                                          design.onez.both$theta0 + 3*design.onez.both$sigma,
#                                          length.out = 3),
#                              design.MSPRT.object = design.onez.both)


#################### one-sample t test ####################

#### right sided ####
### design
#design.onet.right = design.MSPRT(test.type = 'oneT', side = 'right',
#                                 N.max = 20)

### OC and ASN
#OC.onet.right = OCandASN.MSPRT(theta = seq(design.onet.right$theta0, 1,
#                                           length.out = 3),
#                               design.MSPRT.object = design.onet.right)

#### left sided ####
### design
#design.onet.left = design.MSPRT(test.type = 'oneT', side = 'left',
#                                N.max = 20)

### OC and ASN
#OC.onet.left = OCandASN.MSPRT(theta = seq(-1, design.onet.left$theta0,
#                                          length.out = 3),
#                              design.MSPRT.object = design.onet.left)

#### both sided ####
### design
#design.onet.both = design.MSPRT(test.type = 'oneT', side = 'both',
#                                N.max = 20)

### OC and ASN
#OC.onet.both = OCandASN.MSPRT(theta = seq(-1, 1, length.out = 3),
#                              design.MSPRT.object = design.onet.both)


#################### two-sample z test ####################

#### right sided ####
### design
#design.twoz.right = design.MSPRT(test.type = 'twoZ', side = 'right',
#                                 N1.max = 20, N2.max = 20)

### OC and ASN
#OC.twoz.right = OCandASN.MSPRT(theta = seq(design.twoz.right$theta0, 
#                                           design.twoz.right$theta0 + 2,
#                                           length.out = 3),
#                               design.MSPRT.object = design.twoz.right)

#### left sided ####
### design
#design.twoz.left = design.MSPRT(test.type = 'twoZ', side = 'left',
#                                N1.max = 20, N2.max = 20)

### OC and ASN
#OC.twoz.left = OCandASN.MSPRT(theta = seq(design.twoz.left$theta0 - 2,
#                                          design.twoz.left$theta0,
#                                          length.out = 3),
#                              design.MSPRT.object = design.twoz.left)

#### both sided ####
### design
#design.twoz.both = design.MSPRT(test.type = 'twoZ', side = 'both',
#                                N1.max = 20, N2.max = 20)

### OC and ASN
#OC.twoz.both = OCandASN.MSPRT(theta = seq(design.twoz.both$theta0 - 2,
#                                          design.twoz.both$theta0 + 2,
#                                          length.out = 3),
#                             design.MSPRT.object = design.twoz.both)


#################### two-sample t test ####################

#### right sided ####
### design
#design.twot.right = design.MSPRT(test.type = 'twoT', side = 'right',
#                                 N1.max = 20, N2.max = 20)

### OC and ASN
#OC.twot.right = OCandASN.MSPRT(theta = seq(design.twot.right$theta0, 
#                                           design.twot.right$theta0 + 2,
#                                           length.out = 3),
#                               design.MSPRT.object = design.twot.right)

#### left sided ####
### design
#design.twot.left = design.MSPRT(test.type = 'twoT', side = 'left',
#                                N1.max = 20, N2.max = 20)

### OC and ASN
#OC.twot.left = OCandASN.MSPRT(theta = seq(design.twot.left$theta0 - 2,
#                                          design.twot.left$theta0,
#                                          length.out = 3),
#                              design.MSPRT.object = design.twot.left)

#### both sided ####
### design
#design.twot.both = design.MSPRT(test.type = 'twoT', side = 'both',
#                                N1.max = 20, N2.max = 20)

### OC and ASN
#OC.twot.both = OCandASN.MSPRT(theta = seq(design.twot.both$theta0 - 2,
#                                          design.twot.both$theta0 + 2,
#                                          length.out = 3),
#                              design.MSPRT.object = design.twot.both)
</code></pre>

<hr>
<h2 id='OCandASN.MSPRT_oneProp'>
Internal MSPRT function: OC and ASN of a designed MSPRT in one-sample proportion tests
</h2><span id='topic+OCandASN.MSPRT_oneProp'></span>

<h3>Description</h3>

<p><code><a href="#topic+OCandASN.MSPRT">OCandASN.MSPRT</a></code> calls this function for obtaining the OC and ASN of a designed MSPRT for one-sample proportion tests. Users please refer to <code><a href="#topic+OCandASN.MSPRT">OCandASN.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='OCandASN.MSPRT_oneT'>
Internal MSPRT function: OC and ASN of a designed MSPRT in one-sample t tests
</h2><span id='topic+OCandASN.MSPRT_oneT'></span>

<h3>Description</h3>

<p><code><a href="#topic+OCandASN.MSPRT">OCandASN.MSPRT</a></code> calls this function for obtaining the OC and ASN of a designed MSPRT for one-sample t tests. Users please refer to <code><a href="#topic+OCandASN.MSPRT">OCandASN.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='OCandASN.MSPRT_oneZ'>
Internal MSPRT function: OC and ASN of a designed MSPRT in one-sample z tests
</h2><span id='topic+OCandASN.MSPRT_oneZ'></span>

<h3>Description</h3>

<p><code><a href="#topic+OCandASN.MSPRT">OCandASN.MSPRT</a></code> calls this function for obtaining the OC and ASN of a designed MSPRT for one-sample z tests. Users please refer to <code><a href="#topic+OCandASN.MSPRT">OCandASN.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='OCandASN.MSPRT_twoT'>
Internal MSPRT function: OC and ASN of a designed MSPRT in two-sample t tests
</h2><span id='topic+OCandASN.MSPRT_twoT'></span>

<h3>Description</h3>

<p><code><a href="#topic+OCandASN.MSPRT">OCandASN.MSPRT</a></code> calls this function for obtaining the OC and ASN of a designed MSPRT for two-sample t tests. Users please refer to <code><a href="#topic+OCandASN.MSPRT">OCandASN.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='OCandASN.MSPRT_twoZ'>
Internal MSPRT function: OC and ASN of a designed MSPRT in two-sample z tests
</h2><span id='topic+OCandASN.MSPRT_twoZ'></span>

<h3>Description</h3>

<p><code><a href="#topic+OCandASN.MSPRT">OCandASN.MSPRT</a></code> calls this function for obtaining the OC and ASN of a designed MSPRT for two-sample z tests. Users please refer to <code><a href="#topic+OCandASN.MSPRT">OCandASN.MSPRT</a></code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>

<hr>
<h2 id='Type2.fixed_design'>
Type II error probability of fixed design tests
</h2><span id='topic+Type2.fixed_design'></span>

<h3>Description</h3>

<p>Obtains the Type II error probability of fixed-design tests for testing the point null hypothesis <code class="reqn">H_0 : \theta = \theta_0</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Type2.fixed_design(theta, test.type, side = "right", theta0, 
                   N, N1, N2, Type1 = 0.005, 
                   sigma = 1, sigma1 = 1, sigma2 = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Type2.fixed_design_+3A_theta">theta</code></td>
<td>

<p>Numeric. Effect size where the Type II error probability is desired.
</p>
</td></tr>
<tr><td><code id="Type2.fixed_design_+3A_test.type">test.type</code></td>
<td>

<p>Character. Type of test. Currently, the package only allows 
</p>

<ul>
<li> <p><code>oneProp</code> for one-sample proportion tests
</p>
</li>
<li> <p><code>oneZ</code> for one-sample z tests
</p>
</li>
<li> <p><code>oneT</code> for one-sample t tests
</p>
</li>
<li> <p><code>twoZ</code> for two-sample z tests
</p>
</li>
<li> <p><code>twoT</code> for two-sample t tests.
</p>
</li></ul>

</td></tr>
<tr><td><code id="Type2.fixed_design_+3A_side">side</code></td>
<td>

<p>Character. Direction of the composite alternative hypothesis. <code>right</code> for <code class="reqn">H_1 : \theta &gt; \theta_0</code> (<strong>default</strong>), and <code>left</code> for <code class="reqn">H_1 : \theta &lt; \theta_0</code>.
</p>
</td></tr>
<tr><td><code id="Type2.fixed_design_+3A_theta0">theta0</code></td>
<td>

<p>Numeric. Hypothesized value of effect size (<code class="reqn">\theta_0</code>) under <code class="reqn">H_0</code>. <strong>Default:</strong> 0.5 in one-sample proportion tests, and 0 for others.
</p>
</td></tr>
<tr><td><code id="Type2.fixed_design_+3A_n">N</code></td>
<td>

<p>Positive integer. Sample size in one-sample tests.
</p>
</td></tr>
<tr><td><code id="Type2.fixed_design_+3A_n1">N1</code></td>
<td>

<p>Positive integer. Sample size from Group-1 in two-sample tests.
</p>
</td></tr>
<tr><td><code id="Type2.fixed_design_+3A_n2">N2</code></td>
<td>

<p>Positive integer. Sample size from Group-2 in two-sample tests.
</p>
</td></tr>
<tr><td><code id="Type2.fixed_design_+3A_type1">Type1</code></td>
<td>

<p>Numeric in [0,1]. Prespecified Type I error probability. <strong>Default:</strong> 0.005.
</p>
</td></tr>
<tr><td><code id="Type2.fixed_design_+3A_sigma">sigma</code></td>
<td>

<p>Positive numeric. Known standard deviation in one-sample <code class="reqn">z</code> tests. <strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="Type2.fixed_design_+3A_sigma1">sigma1</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-1 in two-sample <code class="reqn">z</code> tests. <strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="Type2.fixed_design_+3A_sigma2">sigma2</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-2 in two-sample <code class="reqn">z</code> tests. <strong>Default:</strong> 1.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric in [0,1]. The Type II error probability of the fixed-design test at the specified effect size value <code>theta</code>.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>


<h3>References</h3>

<p>Pramanik S., Johnson V. E. and Bhattacharya A. (2020+). A Modified Sequential Probability Ratio Test. <a href="https://arxiv.org/pdf/1811.08478.pdf">[Arxiv]</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##### one-sample proportion test #####

## right-sided
Type2.fixed_design(theta = seq(0, 1, length.out = 10), 
                   test.type = "oneProp", N = 30)

## left-sided
Type2.fixed_design(theta = seq(0, 1, length.out = 10), side = "left", 
                   test.type = "oneProp", N = 30)


##### one-sample z test #####

## right-sided
Type2.fixed_design(theta = seq(0, 1, length.out = 10), 
                   test.type = "oneZ", N = 30)

## left-sided
Type2.fixed_design(theta = seq(-1, 0, length.out = 10), side = "left", 
                   test.type = "oneZ", N = 30)


##### one-sample t test #####

## right-sided
Type2.fixed_design(theta = seq(0, 1, length.out = 10), 
                   test.type = "oneT", N = 30)

## left-sided
Type2.fixed_design(theta = seq(-1, 0, length.out = 10), side = "left", 
                   test.type = "oneT", N = 30)


##### two-sample z test #####

## right-sided
Type2.fixed_design(theta = seq(0, 1, length.out = 10), 
                   test.type = "twoZ", N1 = 30, N2 = 30)

## left-sided
Type2.fixed_design(theta = seq(-1, 0, length.out = 10), side = "left",
                   test.type = "twoZ", N1 = 30, N2 = 30)


##### two-sample t test #####

## right-sided
Type2.fixed_design(theta = seq(0, 1, length.out = 10), 
                   test.type = "twoT", N1 = 30, N2 = 30)

## left-sided
Type2.fixed_design(theta = seq(-1, 0, length.out = 10), side = "left", 
                   test.type = "twoT", N1 = 30, N2 = 30)
</code></pre>

<hr>
<h2 id='UMPBT.alt'>
UMPBT alternative
</h2><span id='topic+UMPBT.alt'></span>

<h3>Description</h3>

<p>Given a sample size and prespecified Type I &amp; II error probabilities, this function obtains the objective alternative in the Uniformly Most Powerful Bayesian Test (UMPBT).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UMPBT.alt(test.type, side = "right", theta0, 
          N, N1, N2, Type1 = 0.005, 
          sigma = 1, sigma1 = 1, sigma2 = 1, 
          obs, sd.obs, obs1, obs2, pooled.sd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UMPBT.alt_+3A_test.type">test.type</code></td>
<td>

<p>Character. Type of test. Currently, the package only allows 
</p>

<ul>
<li> <p><code>oneProp</code> for one-sample proportion tests
</p>
</li>
<li> <p><code>oneZ</code> for one-sample z tests
</p>
</li>
<li> <p><code>oneT</code> for one-sample t tests
</p>
</li>
<li> <p><code>twoZ</code> for two-sample z tests
</p>
</li>
<li> <p><code>twoT</code> for two-sample t tests.
</p>
</li></ul>

</td></tr>
<tr><td><code id="UMPBT.alt_+3A_side">side</code></td>
<td>

<p>Character. Direction of the composite alternative hypothesis. <code>right</code> for <code class="reqn">H_1 : \theta &gt; \theta_0</code> (<strong>default</strong>), and <code>left</code> for <code class="reqn">H_1 : \theta &lt; \theta_0</code>.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_theta0">theta0</code></td>
<td>

<p>Numeric. Hypothesized value of effect size (<code class="reqn">\theta_0</code>) under <code class="reqn">H_0</code>. <strong>Default:</strong> 0.5 in one-sample proportion tests, and 0 for others.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_n">N</code></td>
<td>

<p>Positive integer. Sample size in one-sample tests.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_n1">N1</code></td>
<td>

<p>Positive integer. Sample size from Group-1 in two-sample tests.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_n2">N2</code></td>
<td>

<p>Positive integer. Sample size from Group-2 in two-sample tests.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_type1">Type1</code></td>
<td>

<p>Numeric in [0,1]. Prespecified Type I error probability. <strong>Default:</strong> 0.005.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_sigma">sigma</code></td>
<td>

<p>Positive numeric. Known standard deviation in one-sample z tests. <strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_sigma1">sigma1</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-1 in two-sample z tests. <strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_sigma2">sigma2</code></td>
<td>

<p>Positive numeric. Known standard deviation for Group-2 in two-sample z tests. <strong>Default:</strong> 1.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_obs">obs</code></td>
<td>

<p>Numeric vector. The vector of observations based on which the UMPBT alternative in one-sample t test is determined. Either <code>obs</code> or <code>sd.obs</code> is required.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_sd.obs">sd.obs</code></td>
<td>

<p>Positive numeric. The standard deviation (with divisor n-1) of observations based on which the UMPBT alternative in one-sample t test is determined. Either <code>obs</code> or <code>sd.obs</code> is required.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_obs1">obs1</code></td>
<td>

<p>Numeric vector. The vector of observations from Group-1 based on which the UMPBT alternative in two-sample t test is determined. Either both <code>obs1</code> and <code>obs2</code>, or <code>pooled.sd</code> is required.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_obs2">obs2</code></td>
<td>

<p>Numeric vector. The vector of observations from Group-2 based on which the UMPBT alternative in two-sample t test is determined. Either both <code>obs1</code> and <code>obs2</code>, or <code>pooled.sd</code> is required.
</p>
</td></tr>
<tr><td><code id="UMPBT.alt_+3A_pooled.sd">pooled.sd</code></td>
<td>

<p>Positive numeric. The pooled standard deviation of observations from Group-1 and 2 based on which the UMPBT alternative in two-sample t test is determined. Either both <code>obs1</code> and <code>obs2</code>, or <code>pooled.sd</code> is required.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with two named components <code>theta</code> and <code>mix.prob</code> in one-sample proportion test. In this case, the UMPBT alternative is a mixture distribution of two points. <code>theta</code> contains the two points (effect sizes) and <code>mix.prob</code> contains their respective mixing probabilities.
</p>
<p>Numeric in case of all the other tests. It is the UMPBT alternative effect size.
</p>


<h3>Author(s)</h3>

<p>Sandipan Pramanik, Valen E. Johnson and Anirban Bhattacharya
</p>


<h3>References</h3>

<p>Johnson, V. E. (2013a). Revised standards for statistical evidence.Proceed-ings of the National Academy of Sciences, 110(48):19313-19317. <a href="https://www.stat.tamu.edu/~vjohnson/files/PNAS2013.pdf">[Article]</a>
</p>
<p>Johnson, V. E. (2013b). Uniformly most powerful Bayesian tests.TheAnnals of Statistics, 41(4):1716-1741. <a href="https://projecteuclid.org/euclid.aos/1378386237#info">[Article]</a>
</p>
<p>Pramanik S., Johnson V. E. and Bhattacharya A. (2020+). A Modified Sequential Probability Ratio Test. <a href="https://arxiv.org/pdf/1811.08478.pdf">[Arxiv]</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##### one-sample proportion test #####

## right-sided
UMPBT.alt(test.type = "oneProp", N = 30)

## left-sided
UMPBT.alt(side = "left", test.type = "oneProp", N = 30)


##### one-sample z test #####

## right-sided
UMPBT.alt(test.type = "oneZ", N = 30)

## left-sided
UMPBT.alt(side = "left", test.type = "oneZ", N = 30)


##### one-sample t test #####

## observed data

set.seed(1)
x = rnorm(n = 30, mean = 0, sd = 1.5)
	
## right-sided
UMPBT.alt(test.type = "oneT", N = 30, obs = x)

## left-sided
UMPBT.alt(side = "left", test.type = "oneT", N = 30, obs = x)


##### two-sample z test #####

## right-sided
UMPBT.alt(test.type = "twoZ", N1 = 30, N2 = 30)

## left-sided
UMPBT.alt(side = "left", test.type = "twoZ", N1 = 30, N2 = 30)


##### two-sample t test #####

## observed data

set.seed(1)
x1 = rnorm(n = 30, mean = 0, sd = 1.5)
x2 = rnorm(n = 30, mean = 0, sd = 1.5)

## right-sided
UMPBT.alt(test.type = "twoT", N1 = 30, N2 = 30, 
          obs1 = x1, obs2 = x2)

## left-sided
UMPBT.alt(side = "left", test.type = "twoT", N1 = 30, N2 = 30, 
          obs1 = x1, obs2 = x2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
