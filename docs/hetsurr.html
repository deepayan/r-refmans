<!DOCTYPE html><html lang="en"><head><title>Help for package hetsurr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hetsurr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#delta.s.estimate.w'>
<p>Estimates residual treatment effect when W is discrete.</p></a></li>
<li><a href='#example.data'>
<p>Example data</p></a></li>
<li><a href='#hetsurr.fun'>
<p>Assess and test for heterogeneity in the utility of a surrogate</p></a></li>
<li><a href='#hetsurr.plot'>
<p>Constructs plots of the treatment effect, residual treatment effect, and proportion explained as a function of the continuous baseline covariate</p></a></li>
<li><a href='#kf'>
<p>Kernel function</p></a></li>
<li><a href='#mu0wy'>
<p>Estimates mu0(w)=E(Y0|W0=w)</p></a></li>
<li><a href='#mu10'>
<p>Estimates mu10(w)</p></a></li>
<li><a href='#mu1swy'>
<p>Estimates mu1(s, w)=E(Y1|S1=s, W1=w)</p></a></li>
<li><a href='#mu1wy'>
<p>Estimates mu1(w)=E(Y1|W1=w)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Assessing Heterogeneity in the Utility of a Surrogate Marker</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-11-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Layla Parast</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Layla Parast &lt;parast@austin.utexas.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a function to assess and test for heterogeneity in the utility of a surrogate marker with respect to a baseline covariate. The main function can be used for either a continuous or discrete baseline covariate. More details will be available in the future in: Parast, L., Cai, T., Tian L (2021). "Testing for Heterogeneity in the Utility of a Surrogate Marker." Biometrics, In press.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, Rsurrogate, graphics</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-10 14:41:40 UTC; parast</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-10 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='delta.s.estimate.w'>
Estimates residual treatment effect when W is discrete.
</h2><span id='topic+delta.s.estimate.w'></span>

<h3>Description</h3>

<p>Estimates residual treatment effect when W is discrete.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta.s.estimate.w(sone, szero, yone, yzero, wone, wzero, w.all, weight.perturb = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="delta.s.estimate.w_+3A_sone">sone</code></td>
<td>

<p>sone
</p>
</td></tr>
<tr><td><code id="delta.s.estimate.w_+3A_szero">szero</code></td>
<td>

<p>szero
</p>
</td></tr>
<tr><td><code id="delta.s.estimate.w_+3A_yone">yone</code></td>
<td>

<p>yone
</p>
</td></tr>
<tr><td><code id="delta.s.estimate.w_+3A_yzero">yzero</code></td>
<td>

<p>yzero
</p>
</td></tr>
<tr><td><code id="delta.s.estimate.w_+3A_wone">wone</code></td>
<td>

<p>wone
</p>
</td></tr>
<tr><td><code id="delta.s.estimate.w_+3A_wzero">wzero</code></td>
<td>

<p>wzero
</p>
</td></tr>
<tr><td><code id="delta.s.estimate.w_+3A_w.all">w.all</code></td>
<td>

<p>w.all
</p>
</td></tr>
<tr><td><code id="delta.s.estimate.w_+3A_weight.perturb">weight.perturb</code></td>
<td>

<p>perturbation weights
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of length equal to the length of w.all with the estimated residual treatment effect for each w value</p>

<hr>
<h2 id='example.data'>
Example data
</h2><span id='topic+example.data'></span>

<h3>Description</h3>

<p>Example data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("example.data")</code></pre>


<h3>Format</h3>

<p>A list with 6 elements representing 2000 observations from a treatment group and 1500 observations from a control group:
</p>

<dl>
<dt><code>y1</code></dt><dd><p>the primary outcome in the treatment group</p>
</dd>
<dt><code>y0</code></dt><dd><p>the primary outcome in the control group</p>
</dd>
<dt><code>s1</code></dt><dd><p>the surrogate marker in the treatment group</p>
</dd>
<dt><code>s0</code></dt><dd><p>the surrogate marker in the control group</p>
</dd>
<dt><code>w1</code></dt><dd><p>the baseline covariate of interest in the treatment group</p>
</dd>
<dt><code>w0</code></dt><dd><p>the baseline covariate of interest in the control group</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(example.data)
names(example.data)
</code></pre>

<hr>
<h2 id='hetsurr.fun'>
Assess and test for heterogeneity in the utility of a surrogate
</h2><span id='topic+hetsurr.fun'></span>

<h3>Description</h3>

<p>This function assesses and tests for heterogeneity in the utility of a surrogate with respect to a continuous or discrete baseline covariate. The method is nonparametric and focuses on estimation of the proportion of the treatment effect that is explained by the surrogate marker. Inference information is provided including a confidence band for the proportion and results from formal testing for heterogeneity. When the baseline covariate is continuous, two tests are performed - an omnibus test and a trend test; when the baseline covariate is discrete, only one test is performed - an omnibus test. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hetsurr.fun(y1, y0, s1, s0, w1, w0, wf.grd = NULL, h0 = NULL, h1 = NULL, h2 = NULL, 
h3 = NULL, h4 = NULL, var.want = FALSE, type = "cont", test.want = FALSE, c.adj = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hetsurr.fun_+3A_y1">y1</code></td>
<td>

<p>the primary outcome in the treatment group
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_y0">y0</code></td>
<td>

<p>the primary outcome in the control group
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_s1">s1</code></td>
<td>

<p>the surrogate marker in the treatment group
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_s0">s0</code></td>
<td>

<p>the surrogate marker in the control group
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_w1">w1</code></td>
<td>

<p>the baseline covariate of interest in the treatment group
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_w0">w0</code></td>
<td>

<p>the baseline covariate of interest in the control group
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_wf.grd">wf.grd</code></td>
<td>

<p>the grid of the baseline covariate where estimates are wanted; if this is not specified, this will bet set equal to 50 equally spaced points between the 10th and 90th percentile of the union of w1 and w0 values (if continuous) or the set of unique categories (if discrete)
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_h0">h0</code></td>
<td>

<p>bandwidth; if not specific, this is set to a value of appropriate order
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_h1">h1</code></td>
<td>

<p>bandwidth; if not specific, this is set to a value of appropriate order
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_h2">h2</code></td>
<td>

<p>bandwidth; if not specific, this is set to a value of appropriate order
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_h3">h3</code></td>
<td>

<p>bandwidth; if not specific, this is set to a value of appropriate order
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_h4">h4</code></td>
<td>

<p>bandwidth; if not specific, this is set to a value of appropriate order
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_var.want">var.want</code></td>
<td>

<p>TRUE or FALSE; indicates whether variance estimate are wanted, default is FALSE
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_type">type</code></td>
<td>

<p>&quot;cont&quot; or &quot;discrete&quot;; indicates the form of the baseline covariate w, default is &quot;cont&quot;
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_test.want">test.want</code></td>
<td>

<p>TRUE or FALSE; indicates whether testing results are wanted, default is FALSE
</p>
</td></tr>
<tr><td><code id="hetsurr.fun_+3A_c.adj">c.adj</code></td>
<td>

<p>a multiplicative adjustment for the bandwidth; default is 1
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the treatment effect, Delta, the residual treatment effect, Delta_S, and the proportion of treatment effect explained R_S, as a function of the baseline covariate (if continuous) or stratified by category (if discrete). The estimation approach is nonparametric. Variance estimates can be requested including a confidence band for R_S. Results from formal testing for heterogeneity can also be requested. When the baseline covariate is continuous, two tests are performed - an omnibus test and a trend test; when the baseline covariate is discrete, only one test is performed - an omnibus test.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>w.values</code></td>
<td>
<p>values of the baseline covariate at which estimates are provided</p>
</td></tr> 
<tr><td><code>delta.w</code></td>
<td>
<p>estimated treatment effect, Delta, at each w value</p>
</td></tr> 
<tr><td><code>delta.w.s</code></td>
<td>
<p>estimated residual treatment effect, Delta_S, at each w value</p>
</td></tr> 
<tr><td><code>R.w.s</code></td>
<td>
<p>estimated proportion of treatment effect explained, R_S, at each w value</p>
</td></tr> 
<tr><td><code>se.delta.w</code></td>
<td>
<p>estimated standard error of Delta</p>
</td></tr> 
<tr><td><code>se.delta.w.s</code></td>
<td>
<p>estimated standard error of Delta.S</p>
</td></tr> 
<tr><td><code>se.R.w.s</code></td>
<td>
<p>estimated standard error of R.S</p>
</td></tr> 
<tr><td><code>conf.delta.w.lower</code></td>
<td>
<p>lower bound of the confidence intervals for Delta</p>
</td></tr> 
<tr><td><code>conf.delta.w.upper</code></td>
<td>
<p>upper bound of the confidence intervals for Delta</p>
</td></tr> 
<tr><td><code>conf.delta.w.s.lower</code></td>
<td>
<p>lower bound of the confidence intervals for Delta.S</p>
</td></tr> 
<tr><td><code>conf.delta.w.s.upper</code></td>
<td>
<p>upper bound of the confidence intervals for Delta.S</p>
</td></tr> 
<tr><td><code>conf.R.w.s.lower</code></td>
<td>
<p>lower bound of the confidence intervals for R.S</p>
</td></tr> 
<tr><td><code>conf.R.w.s.upper</code></td>
<td>
<p>upper bound of the confidence intervals for R.S</p>
</td></tr> 
<tr><td><code>band.R.w.s.lower</code></td>
<td>
<p>lower bound of the confidence band for R.S</p>
</td></tr> 
<tr><td><code>band.R.w.s.upper</code></td>
<td>
<p>upper bound of the confidence band for R.S</p>
</td></tr> 
<tr><td><code>omnibus.test.statistic</code></td>
<td>
<p>test statistic from omnibus test; for a continuous baseline covariate only </p>
</td></tr> 
<tr><td><code>omnibus.p.value</code></td>
<td>
<p>p-value from omnibus test, testing for evidence of heterogeneity; for a continuous baseline covariate only</p>
</td></tr> 
<tr><td><code>trend.test.statistic</code></td>
<td>
<p>test statistic from the trend test; for a continuous baseline covariate only</p>
</td></tr> 
<tr><td><code>trend.p.value</code></td>
<td>
<p>p-value from trend test, testing for evidence of heterogeneity; for a continuous baseline covariate only</p>
</td></tr> 
<tr><td><code>test.statistic</code></td>
<td>
<p>p-value from the test testing for evidence of heterogeneity; for a discrete baseline covariate only</p>
</td></tr> 
<tr><td><code>p.value</code></td>
<td>
<p>p-value from the test testing for evidence of heterogeneity; for a discrete baseline covariate only</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, L., Cai, T., Tian L (2021). Testing for Heterogeneity in the Utility of a Surrogate Marker. Biometrics, In press. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(example.data)
	names(example.data)
	#computationally intensive
	
	het.ob = hetsurr.fun(y1=example.data$y1, y0=example.data$y0, s1=example.data$s1, 
	s0=example.data$s0, w1=example.data$w1, w0=example.data$w0, wf.grd = seq(0.25, 1.75, 
	length=50), var.want =FALSE, type = "cont")
	het.ob = hetsurr.fun(y1=example.data$y1, y0=example.data$y0, s1=example.data$s1, 
	s0=example.data$s0, w1=example.data$w1, w0=example.data$w0, wf.grd = seq(0.25, 1.75, 
	length=50), var.want =TRUE,  test.want = TRUE, type = "cont")
	
	#reducing dimension of example data to provide a computationally faster example
	het.ob = hetsurr.fun(y1=example.data$y1[1:500], y0=example.data$y0[1:500],
	s1=example.data$s1[1:500], s0=example.data$s0[1:500], w1=example.data$w1[1:500],
	w0=example.data$w0[1:500], wf.grd = seq(0.25, 1.75, length=5), var.want =FALSE, 
	type = "cont")

</code></pre>

<hr>
<h2 id='hetsurr.plot'>
Constructs plots of the treatment effect, residual treatment effect, and proportion explained as a function of the continuous baseline covariate
</h2><span id='topic+hetsurr.plot'></span>

<h3>Description</h3>

<p>Constructs plots of the treatment effect, residual treatment effect, and proportion explained as a function of the continuous baseline covariate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hetsurr.plot(hetsurr.results, xlab.name = "Baseline Covariate", placement = "bottomleft")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hetsurr.plot_+3A_hetsurr.results">hetsurr.results</code></td>
<td>

<p>This is a list produced by the hetsurr.fun function. 
</p>
</td></tr>
<tr><td><code id="hetsurr.plot_+3A_xlab.name">xlab.name</code></td>
<td>

<p>This is the label for the x-axis; default is &quot;Baseline Covariate&quot;.
</p>
</td></tr>
<tr><td><code id="hetsurr.plot_+3A_placement">placement</code></td>
<td>

<p>This is the placement for the legend; default is &quot;bottomleft&quot;.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a plot with 3 panels. 
</p>


<h3>Author(s)</h3>

<p>Layla Parast
</p>


<h3>References</h3>

<p>Parast, L., Cai, T., Tian L (2021). Testing for Heterogeneity in the Utility of a Surrogate Marker. Biometrics, In press.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(example.data)
	names(example.data)
	#computationally intensive
	
	het.ob = hetsurr.fun(y1=example.data$y1, y0=example.data$y0, s1=example.data$s1, 
	s0=example.data$s0, w1=example.data$w1, w0=example.data$w0, wf.grd = seq(0.25, 1.75, 
	length=50), var.want =TRUE,  test.want = TRUE, type = "cont")
	hetsurr.plot(het.ob)
	
	#reducing dimension of example data to provide a computationally faster example
	het.ob = hetsurr.fun(y1=example.data$y1[1:300], y0=example.data$y0[1:300],
	s1=example.data$s1[1:300], s0=example.data$s0[1:300], w1=example.data$w1[1:300],
	w0=example.data$w0[1:300], wf.grd = seq(0.25, 1.75, length=5), var.want =TRUE,
	test.want = TRUE, type = "cont")
	hetsurr.plot(het.ob)

</code></pre>

<hr>
<h2 id='kf'>
Kernel function
</h2><span id='topic+kf'></span>

<h3>Description</h3>

<p>Kernel function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kf(x, h)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kf_+3A_x">x</code></td>
<td>

<p>x
</p>
</td></tr>
<tr><td><code id="kf_+3A_h">h</code></td>
<td>

<p>bandwidth
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns value for the kernel at the given x</p>

<hr>
<h2 id='mu0wy'>
Estimates mu0(w)=E(Y0|W0=w)
</h2><span id='topic+mu0wy'></span>

<h3>Description</h3>

<p>Estimates mu0(w)=E(Y0|W0=w)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mu0wy(w, hyw0,y0,w0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu0wy_+3A_w">w</code></td>
<td>

<p>w
</p>
</td></tr>
<tr><td><code id="mu0wy_+3A_hyw0">hyw0</code></td>
<td>

<p>bandwidth
</p>
</td></tr>
<tr><td><code id="mu0wy_+3A_y0">y0</code></td>
<td>

<p>y0
</p>
</td></tr>
<tr><td><code id="mu0wy_+3A_w0">w0</code></td>
<td>

<p>w0
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns mu0(w) estimate for given w</p>

<hr>
<h2 id='mu10'>
Estimates mu10(w) 
</h2><span id='topic+mu10'></span>

<h3>Description</h3>

<p>Estimates mu10(w) which is the integral of mu1(s, w) with respect to dF0(s|w)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mu10(s1,w1,y1,w0,s0,w, hy2w1, hy2s1, hsw1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu10_+3A_s1">s1</code></td>
<td>

<p>s1
</p>
</td></tr>
<tr><td><code id="mu10_+3A_w1">w1</code></td>
<td>

<p>w1
</p>
</td></tr>
<tr><td><code id="mu10_+3A_y1">y1</code></td>
<td>

<p>y1
</p>
</td></tr>
<tr><td><code id="mu10_+3A_w0">w0</code></td>
<td>

<p>w0
</p>
</td></tr>
<tr><td><code id="mu10_+3A_s0">s0</code></td>
<td>

<p>s0
</p>
</td></tr>
<tr><td><code id="mu10_+3A_w">w</code></td>
<td>

<p>w
</p>
</td></tr>
<tr><td><code id="mu10_+3A_hy2w1">hy2w1</code></td>
<td>

<p>bandwidth
</p>
</td></tr>
<tr><td><code id="mu10_+3A_hy2s1">hy2s1</code></td>
<td>

<p>bandwidth
</p>
</td></tr>
<tr><td><code id="mu10_+3A_hsw1">hsw1</code></td>
<td>

<p>bandwidth
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns mu10(w) estimate for given w</p>

<hr>
<h2 id='mu1swy'>
Estimates mu1(s, w)=E(Y1|S1=s, W1=w)
</h2><span id='topic+mu1swy'></span>

<h3>Description</h3>

<p>Estimates mu1(s, w)=E(Y1|S1=s, W1=w)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mu1swy(s1,w1,y1,s, w, hy2w1, hy2s1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu1swy_+3A_s1">s1</code></td>
<td>

<p>s1
</p>
</td></tr>
<tr><td><code id="mu1swy_+3A_w1">w1</code></td>
<td>

<p>w1
</p>
</td></tr>
<tr><td><code id="mu1swy_+3A_y1">y1</code></td>
<td>

<p>y1
</p>
</td></tr>
<tr><td><code id="mu1swy_+3A_s">s</code></td>
<td>

<p>s
</p>
</td></tr>
<tr><td><code id="mu1swy_+3A_w">w</code></td>
<td>

<p>w
</p>
</td></tr>
<tr><td><code id="mu1swy_+3A_hy2w1">hy2w1</code></td>
<td>

<p>bandwidth
</p>
</td></tr>
<tr><td><code id="mu1swy_+3A_hy2s1">hy2s1</code></td>
<td>

<p>bandwidth
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns mu1(s,w) estimate for given s and w</p>

<hr>
<h2 id='mu1wy'>
Estimates mu1(w)=E(Y1|W1=w)
</h2><span id='topic+mu1wy'></span>

<h3>Description</h3>

<p>Estimates mu1(w)=E(Y1|W1=w)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mu1wy(w, hyw1,y1,w1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mu1wy_+3A_w">w</code></td>
<td>

<p>w
</p>
</td></tr>
<tr><td><code id="mu1wy_+3A_hyw1">hyw1</code></td>
<td>

<p>bandwidth
</p>
</td></tr>
<tr><td><code id="mu1wy_+3A_y1">y1</code></td>
<td>

<p>y1
</p>
</td></tr>
<tr><td><code id="mu1wy_+3A_w1">w1</code></td>
<td>

<p>w1
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns mu1(w) estimate for given w</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
