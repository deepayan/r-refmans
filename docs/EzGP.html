<!DOCTYPE html><html lang="en"><head><title>Help for package EzGP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EzGP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cov_m'><p>The Function for Constructing the Covariance Matrix in <code>EzGP</code> Package</p></a></li>
<li><a href='#EEzGP_fit'><p>The Fitting Function of <code>EEzGP</code> Model</p></a></li>
<li><a href='#EEzGP_predict'><p>The Prediction Function of <code>EEzGP</code> Model</p></a></li>
<li><a href='#EzGP_data'><p>Dataset for the example in function 'EzGP_fit'</p></a></li>
<li><a href='#EzGP_fit'><p>The Fitting Function of <code>EzGP</code> Model</p></a></li>
<li><a href='#EzGP_predict'><p>The Prediction Function of <code>EzGP</code> Model</p></a></li>
<li><a href='#LEzGP_data'><p>Dataset for the example in function 'LEzGP_fit'</p></a></li>
<li><a href='#LEzGP_fit'><p>The Fitting Function of <code>LEzGP</code> Model</p></a></li>
<li><a href='#LLF_gradients'><p>The Log-likelihood Function and The Analytical Gradients in <code>EzGP</code> Package</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Easy-to-Interpret Gaussian Process Models for Computer
Experiments</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit model for datasets with easy-to-interpret Gaussian process modeling, predict responses for new inputs.
    The input variables of the datasets can be quantitative, qualitative/categorical or mixed.
    The output variable of the datasets is a scalar (quantitative).
    The optimization of the likelihood function can be chosen by the users (see the documentation of EzGP_fit()).
    The modeling method is published in "EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors" 
    by Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (2022) &lt;<a href="https://doi.org/10.1137%2F19M1288462">doi:10.1137/19M1288462</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0), stats (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods (&ge; 4.2.0), nloptr (&ge; 2.0.3)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-05 20:20:10 UTC; 93421</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiayi Li [cre, aut],
  Qian Xiao [aut],
  Abhyuday Mandal [aut],
  C. Devon Lin [aut],
  Xinwei Deng [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jiayi Li &lt;jiayili0123@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-06 18:40:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='cov_m'>The Function for Constructing the Covariance Matrix in <code>EzGP</code> Package</h2><span id='topic+cov_m'></span>

<h3>Description</h3>

<p>Builds the covariance matrix for the given dataset according to different models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_m(X, p, q, m, n, parv, tau = 0, models = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cov_m_+3A_x">X</code></td>
<td>
<p>Matrix or data frame containing the inputs of training data. Each row represents the input setting of a data point and the columns are values of quantitative variables and qualitative variables.</p>
</td></tr>
<tr><td><code id="cov_m_+3A_p">p</code></td>
<td>
<p>Number of quantitative factors in the given dataset <code>X</code>.</p>
</td></tr>
<tr><td><code id="cov_m_+3A_q">q</code></td>
<td>
<p>Number of qualitative factors in the given dataset <code>X</code>.</p>
</td></tr>
<tr><td><code id="cov_m_+3A_m">m</code></td>
<td>
<p>A vector containing numbers of levels in qualitative factors.</p>
</td></tr>
<tr><td><code id="cov_m_+3A_n">n</code></td>
<td>
<p>Number of training data points</p>
</td></tr>
<tr><td><code id="cov_m_+3A_parv">parv</code></td>
<td>
<p>Parameters in the EzGP/EEzGP model</p>
</td></tr>
<tr><td><code id="cov_m_+3A_tau">tau</code></td>
<td>
<p>Nugget if needed. The default nugget is 0, otherwise it has to be a non-negative real value.</p>
</td></tr>
<tr><td><code id="cov_m_+3A_models">models</code></td>
<td>
<p>Model indicator that indicates which model the covariance matrix is built for. 0 for EzGP model, 1 for EEzGP model. The default setting is 0.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+EzGP_fit">EzGP_fit</a></code>, <code><a href="#topic+EzGP_predict">EzGP_predict</a></code>, <code><a href="#topic+EEzGP_fit">EEzGP_fit</a></code>, <code><a href="#topic+EEzGP_predict">EEzGP_predict</a></code>, <code><a href="#topic+LEzGP_fit">LEzGP_fit</a></code>, and <code><a href="#topic+LLF_gradients">LLF_gradients</a></code> will call this function.
</p>


<h3>Value</h3>

<p>The covariance matrix for the given dataset.
</p>


<h3>Note</h3>

<p>This function is used inside other functions in this package and is <strong>NOT</strong> exported once the EzGP package is loaded.
</p>


<h3>References</h3>


<ol>
<li><p> &quot;EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors&quot;, Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (<a href="https://doi.org/10.1137/19M1288462">doi:10.1137/19M1288462</a>)
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+EzGP_fit">EzGP_fit</a></code> to see how an EzGP model can be fitted to a training dataset.<br />
<code><a href="#topic+EzGP_predict">EzGP_predict</a></code> to use the fitted EzGP model for prediction.<br />
<code><a href="#topic+EEzGP_fit">EEzGP_fit</a></code> to see how an EEzGP model can be fitted to a training dataset.<br />
<code><a href="#topic+EEzGP_predict">EEzGP_predict</a></code> to use the fitted EEzGP model for prediction.<br />
<code><a href="#topic+LEzGP_fit">LEzGP_fit</a></code> to see how a LEzGP model can be fitted to a training dataset.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see the examples in the documentation of the function EzGP_fit.
</code></pre>

<hr>
<h2 id='EEzGP_fit'>The Fitting Function of <code>EEzGP</code> Model</h2><span id='topic+EEzGP_fit'></span>

<h3>Description</h3>

<p>Fits an Efficient Easy-to-Interpret Gaussian process (EEzGP) model to a dataset as described in <code>reference 1</code>.
The input variables are mixed (with both quantitative and qualitative inputs).
The output variable is quantitative and scalar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EEzGP_fit(
  X,
  Y,
  p,
  q,
  m,
  tau = 0,
  lb = "T",
  ub = "T",
  x0 = "T",
  xtol_rel = 1e-05,
  maxeval = 100,
  algorithm = "NLOPT_LD_LBFGS"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EEzGP_fit_+3A_x">X</code></td>
<td>
<p>Matrix or data frame containing the inputs of training data. Each row represents the input setting of a data point and the columns are values of quantitative variables and qualitative variables.</p>
</td></tr>
<tr><td><code id="EEzGP_fit_+3A_y">Y</code></td>
<td>
<p>Vector containing the outputs of training data points.</p>
</td></tr>
<tr><td><code id="EEzGP_fit_+3A_p">p</code></td>
<td>
<p>Number of quantitative factors in the given dataset <code>X</code>.</p>
</td></tr>
<tr><td><code id="EEzGP_fit_+3A_q">q</code></td>
<td>
<p>Number of qualitative factors in the given dataset <code>X</code>.</p>
</td></tr>
<tr><td><code id="EEzGP_fit_+3A_m">m</code></td>
<td>
<p>A vector containing numbers of levels in qualitative factors.</p>
</td></tr>
<tr><td><code id="EEzGP_fit_+3A_tau">tau</code></td>
<td>
<p>Nugget if needed. The default nugget is 0, otherwise it has to be a non-negative real value.</p>
</td></tr>
<tr><td><code id="EEzGP_fit_+3A_lb">lb</code></td>
<td>
<p>Vector with lower bounds of the parameter estimation. &quot;T&quot; for applying the default setting of lb (a vector of length number of parameters whose elements are all 0.1), otherwise one must provide a vector with the length being the number of parameters.</p>
</td></tr>
<tr><td><code id="EEzGP_fit_+3A_ub">ub</code></td>
<td>
<p>Vector with upper bounds of the parameter estimation. &quot;T&quot; for applying the default setting of ub (a vector of length number of parameters whose first <code>q+1</code> elements are 100 and the rest <code>number of parameters - q - 1</code> elements are 10), otherwise one must provide a vector with length of the number of parameters.</p>
</td></tr>
<tr><td><code id="EEzGP_fit_+3A_x0">x0</code></td>
<td>
<p>Vector with starting values for the optimization. &quot;T&quot; for applying the default setting of x0 (a vector made by <code>(lb + ub)/2</code>), otherwise one must provide a vector with the length being the number of parameters.</p>
</td></tr>
<tr><td><code id="EEzGP_fit_+3A_xtol_rel">xtol_rel</code></td>
<td>
<p>Stopping criterion for relative change reached.</p>
</td></tr>
<tr><td><code id="EEzGP_fit_+3A_maxeval">maxeval</code></td>
<td>
<p>Termination condition by specifying a maximum number of function.</p>
</td></tr>
<tr><td><code id="EEzGP_fit_+3A_algorithm">algorithm</code></td>
<td>
<p>Optimization algorithm. See <a href="https://nlopt.readthedocs.io/en/latest/NLopt_Algorithms/">NLopt Algorithms</a> for more availiable algorithms.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A model of class &quot;EzGP model&quot; list of the following items:
</p>

<ul>
<li><p><code>param</code> A list containing the estimated parameters
</p>
</li>
<li><p><code>data</code> A list containing the fitted dataset and the information for fitting
</p>
</li></ul>



<h3>References</h3>


<ol>
<li><p> &quot;EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors&quot;, Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (<a href="https://doi.org/10.1137/19M1288462">doi:10.1137/19M1288462</a>)
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+EEzGP_predict">EEzGP_predict</a></code> to use the fitted EEzGP model for prediction.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example with 3 quantitative and 3 qualitative variables (dataset included in the package):
#     Fit an EEzGP model (with default settings), and then perform the prediction.
p = 3
q = 3
m=c(3,3,3)
tau = 0
X = EzGP_data[1:25, 1:(p+q)]
Y = EzGP_data[1:25, p+q+1]
X_new = EzGP_data[26:30, 1:(p+q)]
# EEzGP Model and Prediction
model &lt;- EEzGP_fit(X, Y, p, q, m)
pred &lt;- EEzGP_predict(X_new, model, MSE_on = 1)
result &lt;- LLF_gradients(X, Y, p, q, m, model$param, tau = 0, models = 1)
# Results showing
model
pred
result
</code></pre>

<hr>
<h2 id='EEzGP_predict'>The Prediction Function of <code>EEzGP</code> Model</h2><span id='topic+EEzGP_predict'></span>

<h3>Description</h3>

<p>Predicts the output of the EEzGP model fitted by <code><a href="#topic+EEzGP_fit">EEzGP_fit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EEzGP_predict(X_new, model, MSE_on = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EEzGP_predict_+3A_x_new">X_new</code></td>
<td>
<p>Matrix or vector containing the input(s) where the predictions are to be made. Each row is an input vector.</p>
</td></tr>
<tr><td><code id="EEzGP_predict_+3A_model">model</code></td>
<td>
<p>The EEzGP model fitted by <code><a href="#topic+EEzGP_fit">EEzGP_fit</a></code>.</p>
</td></tr>
<tr><td><code id="EEzGP_predict_+3A_mse_on">MSE_on</code></td>
<td>
<p>A scalar indicating whether the uncertainty (i.e., mean squared error <code>MSE</code>) is calculated. Set to a non-zero value to calculate <code>MSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A prediction list containing the following components:
</p>

<ul>
<li><p><code>Y_hat</code> A vector containing the prediction values
</p>
</li>
<li><p><code>MSE</code> A vector containing the prediction uncertainty (i.e., the covariance or covariance matrix for the output(s) at prediction location(s)) 
</p>
</li></ul>



<h3>References</h3>


<ol>
<li><p> &quot;EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors&quot;, Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (<a href="https://doi.org/10.1137/19M1288462">doi:10.1137/19M1288462</a>)
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+EEzGP_fit">EEzGP_fit</a></code> to fit EEzGP model for the datasets.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This function is used in a similar way as the use of EzGP_predict.
# See the examples in the documentation of the function EEzGP_fit.
</code></pre>

<hr>
<h2 id='EzGP_data'>Dataset for the example in function 'EzGP_fit'</h2><span id='topic+EzGP_data'></span>

<h3>Description</h3>

<p>Data are sampled from the modified math function based on Example 4.1 in the paper listed in <code>references</code>.
There are 3 quantitative factors and 3 qualitative factors each having 3 levels.
In this dataset, there are 1296 data points. For the simplicity of illustration, we take the first 81 rows as training data points, and the last 1215 rows as testing data points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(EzGP_data)
</code></pre>


<h3>Format</h3>

<p>A named list containing training data and testing data:
</p>

<dl>
<dt>&quot;x1&quot;</dt><dd><p>1st quantitative factor</p>
</dd>
<dt>&quot;x2&quot;</dt><dd><p>2nd quantitative factor</p>
</dd>
<dt>&quot;x3&quot;</dt><dd><p>3rd quantitative factor</p>
</dd>
<dt>&quot;z1&quot;</dt><dd><p>1st qualitative factor, which has 3 levels</p>
</dd>
<dt>&quot;z2&quot;</dt><dd><p>2nd qualitative factor, which has 3 levels</p>
</dd>
<dt>&quot;z3&quot;</dt><dd><p>3rd qualitative factor, which has 3 levels</p>
</dd>
<dt>&quot;y&quot;</dt><dd><p>Response vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>The dataset can be generated with the code at the end of this description file.
</p>


<h3>References</h3>


<ol>
<li><p> &quot;EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors&quot;, Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (<a href="https://doi.org/10.1137/19M1288462">doi:10.1137/19M1288462</a>)
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(EzGP_data)
#Number of quantitative factors
p = 3
#Number of qualitative factors
q = 3
#Vector containing numbers of levels in qualitative factors
m=c(3,3,3)
# Nugget
tau = 0

X = EzGP_data[1:81, 1:(p+q)]
Y = EzGP_data[1:81, p+q+1]
X_new = EzGP_data[82:1296, 1:(p+q)]
</code></pre>

<hr>
<h2 id='EzGP_fit'>The Fitting Function of <code>EzGP</code> Model</h2><span id='topic+EzGP_fit'></span>

<h3>Description</h3>

<p>Fits an Easy-to-Interpret Gaussian process (EzGP) model to a dataset as described in <code>reference 1</code>.
The input variables are mixed (with both quantitative and qualitative inputs)
The output variable is quantitative and scalar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EzGP_fit(
  X,
  Y,
  p,
  q,
  m,
  tau = 0,
  lb = "T",
  ub = "T",
  x0 = "T",
  xtol_rel = 1e-05,
  maxeval = 100,
  algorithm = "NLOPT_LD_LBFGS"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EzGP_fit_+3A_x">X</code></td>
<td>
<p>Matrix or data frame containing the inputs of training data. Each row represents the input setting of a data point and the columns are values of quantitative variables and qualitative variables.</p>
</td></tr>
<tr><td><code id="EzGP_fit_+3A_y">Y</code></td>
<td>
<p>Vector containing the outputs of training data points.</p>
</td></tr>
<tr><td><code id="EzGP_fit_+3A_p">p</code></td>
<td>
<p>Number of quantitative factors in the given dataset <code>X</code>.</p>
</td></tr>
<tr><td><code id="EzGP_fit_+3A_q">q</code></td>
<td>
<p>Number of qualitative factors in the given dataset <code>X</code>.</p>
</td></tr>
<tr><td><code id="EzGP_fit_+3A_m">m</code></td>
<td>
<p>A vector containing numbers of levels in the qualitative factors.</p>
</td></tr>
<tr><td><code id="EzGP_fit_+3A_tau">tau</code></td>
<td>
<p>Nugget if needed. The default nugget is 0, otherwise it has to be a non-negative real value.</p>
</td></tr>
<tr><td><code id="EzGP_fit_+3A_lb">lb</code></td>
<td>
<p>Vector with lower bounds of the parameter estimation. &quot;T&quot; for applying the default setting of lb (a vector of length number of parameters whose elements are all 0.1), otherwise one must provide a vector with length of the number of parameters.</p>
</td></tr>
<tr><td><code id="EzGP_fit_+3A_ub">ub</code></td>
<td>
<p>Vector with upper bounds of the parameter estimation. &quot;T&quot; for applying the default setting of ub (a vector of length number of parameters whose first <code>q+1</code> elements are 100 and the rest <code>number of parameters - q - 1</code> elements are 10), otherwise one must provide a vector with the length being the number of parameters.</p>
</td></tr>
<tr><td><code id="EzGP_fit_+3A_x0">x0</code></td>
<td>
<p>Vector with starting values for the optimization. &quot;T&quot; for applying the default setting of x0 (a vector made by <code>(lb + ub)/2</code>), otherwise one must provide a vector with the length being the number of parameters.</p>
</td></tr>
<tr><td><code id="EzGP_fit_+3A_xtol_rel">xtol_rel</code></td>
<td>
<p>Stopping criterion for relative change reached.</p>
</td></tr>
<tr><td><code id="EzGP_fit_+3A_maxeval">maxeval</code></td>
<td>
<p>Termination condition by specifying a maximum number of function.</p>
</td></tr>
<tr><td><code id="EzGP_fit_+3A_algorithm">algorithm</code></td>
<td>
<p>Optimization algorithm. See <a href="https://nlopt.readthedocs.io/en/latest/NLopt_Algorithms/">NLopt Algorithms</a> for more availiable algorithms.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A model of class &quot;EzGP model&quot; list of the following items:
</p>

<ul>
<li><p><code>param</code> A list containing the estimated parameters
</p>
</li>
<li><p><code>data</code> A list containing the dataset and the information for fitting
</p>
</li></ul>



<h3>References</h3>


<ol>
<li><p> &quot;EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors&quot;, Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (<a href="https://doi.org/10.1137/19M1288462">doi:10.1137/19M1288462</a>)
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+EzGP_predict">EzGP_predict</a></code> to use the fitted EzGP model for prediction.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example with 3 quantitative and 3 qualitative variables (dataset included in the package):
#     Fit an EzGP model (with default settings), and then perform the prediction.
#     This example may run for a while.
p = 3
q = 3
m=c(3,3,3)
tau = 0
X = EzGP_data[1:15, 1:(p+q)]
Y = EzGP_data[1:15, p+q+1]
X_new = EzGP_data[16:20, 1:(p+q)]
# EzGP Model and Prediction
model &lt;- EzGP_fit(X, Y, p, q, m)
pred &lt;- EzGP_predict(X_new, model, MSE_on = 1)
result &lt;- LLF_gradients(X, Y, p, q, m, model$param)
# Results showing
model
pred
result
</code></pre>

<hr>
<h2 id='EzGP_predict'>The Prediction Function of <code>EzGP</code> Model</h2><span id='topic+EzGP_predict'></span>

<h3>Description</h3>

<p>Predicts the output of the EzGP model fitted by <code><a href="#topic+EzGP_fit">EzGP_fit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EzGP_predict(X_new, model, MSE_on = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EzGP_predict_+3A_x_new">X_new</code></td>
<td>
<p>Matrix or vector containing the input(s) where the predictions are to be made. Each row is an input vector.</p>
</td></tr>
<tr><td><code id="EzGP_predict_+3A_model">model</code></td>
<td>
<p>The EzGP model fitted by <code><a href="#topic+EzGP_fit">EzGP_fit</a></code>.</p>
</td></tr>
<tr><td><code id="EzGP_predict_+3A_mse_on">MSE_on</code></td>
<td>
<p>A scalar indicating whether the uncertainty (i.e., mean squared error <code>MSE</code>) is calculated. Set to a non-zero value to calculate <code>MSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A prediction list containing the following components:
</p>

<ul>
<li><p><code>Y_hat</code> A vector containing the prediction values
</p>
</li>
<li><p><code>MSE</code> A vector containing the prediction uncertainty (i.e., the covariance or covariance matrix for the output(s) at prediction location(s)) 
</p>
</li></ul>



<h3>References</h3>


<ol>
<li><p> &quot;EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors&quot;, Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (<a href="https://doi.org/10.1137/19M1288462">doi:10.1137/19M1288462</a>)
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+EzGP_fit">EzGP_fit</a></code> to fit EzGP model for the datasets.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see the examples in the documentation of the function EzGP_fit.
</code></pre>

<hr>
<h2 id='LEzGP_data'>Dataset for the example in function 'LEzGP_fit'</h2><span id='topic+LEzGP_data'></span>

<h3>Description</h3>

<p>Data are sampled from the modified math function based on Example 4.2 and Example 4.3 in the paper listed in <code>references</code>.
There are 9 quantitative factors and 9 qualitative factors each having 3 levels.
In this dataset, there are 8250 data points. For the simplicity of illustration, we take the first 8150 rows as training data points, and the last 100 rows as testing data points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LEzGP_data)
</code></pre>


<h3>Format</h3>

<p>A named list containing training data and testing data:
</p>

<dl>
<dt>&quot;x1-x9&quot;</dt><dd><p>1st quantitative factor to the 9th quantitative factor </p>
</dd>
<dt>&quot;z1-z9&quot;</dt><dd><p>1st qualitative factor to the 9th qualitative factor, which all have 3 levels</p>
</dd>
<dt>&quot;ry&quot;</dt><dd><p>Response vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>The dataset can be generated with the code at the end of this description file.
</p>


<h3>References</h3>


<ol>
<li><p> &quot;EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors&quot;, Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (<a href="https://doi.org/10.1137/19M1288462">doi:10.1137/19M1288462</a>)
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>data(LEzGP_data)
#Number of quantitative factors
p = 9
#Number of qualitative factors
q = 9
#Vector containing numbers of levels in qualitative factors
m=rep(3,9)
# Nugget
tau = 0

X = LEzGP_data[1:8150, 1:(p+q)]
Y = LEzGP_data[1:8150, p+q+1]
X_new = LEzGP_data[8151:8250, 1:(p+q)]
</code></pre>

<hr>
<h2 id='LEzGP_fit'>The Fitting Function of <code>LEzGP</code> Model</h2><span id='topic+LEzGP_fit'></span>

<h3>Description</h3>

<p>Fits a Localized Easy-to-Interpret Gaussian process (LEzGP) model to a dataset as described in <code>reference 1</code>.
The input variables are mixed (with both quantitative and qualitative inputs)
The output variable is quantitative and scalar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LEzGP_fit(
  X,
  Y,
  p,
  q,
  m,
  tar_z,
  ns,
  models = 1,
  tau = 0,
  lb = "T",
  ub = "T",
  x0 = "T",
  xtol_rel = 1e-05,
  maxeval = 100,
  algorithm = "NLOPT_LD_LBFGS"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LEzGP_fit_+3A_x">X</code></td>
<td>
<p>Matrix or data frame containing the inputs of training data. Each row represents the input setting of a data point and the columns are values of quantitative variables and qualitative variables.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_y">Y</code></td>
<td>
<p>Vector containing the outputs of training data points.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_p">p</code></td>
<td>
<p>Number of quantitative factors in the given dataset <code>X</code>.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_q">q</code></td>
<td>
<p>Number of qualitative factors in the given dataset <code>X</code>.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_m">m</code></td>
<td>
<p>A vector containing numbers of levels in qualitative factors.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_tar_z">tar_z</code></td>
<td>
<p>A vector containing the qualitative part of the chosen target input (described in <code>reference 1</code>).</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_ns">ns</code></td>
<td>
<p>The chosen tuning parameter (described in <code>reference 1</code>)</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_models">models</code></td>
<td>
<p>The model for fitting the selected proper subset of the dataset <code>X</code>. 0 for EzGP model, 1 for EEzGP model.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_tau">tau</code></td>
<td>
<p>Nugget if needed. The default nugget is 0, otherwise it has to be a non-negative real value.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_lb">lb</code></td>
<td>
<p>Vector with lower bounds of the parameter estimation. &quot;T&quot; for applying the default setting of lb (a vector of length number of parameters whose elements are all 0.1), otherwise one must provide a vector with the length being the number of parameters.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_ub">ub</code></td>
<td>
<p>Vector with upper bounds of the parameter estimation. &quot;T&quot; for applying the default setting of ub (a vector of length number of parameters whose first <code>q+1</code> elements are 100 and the rest <code>number of parameters - q - 1</code> elements are 10), otherwise one must provide a vector with length of the number of parameters.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_x0">x0</code></td>
<td>
<p>Vector with starting values for the optimization. &quot;T&quot; for applying the default setting of x0 (a vector made by <code>(lb + ub)/2</code>), otherwise one must provide a vector with length being the number of parameters.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_xtol_rel">xtol_rel</code></td>
<td>
<p>Stopping criterion for relative change reached.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_maxeval">maxeval</code></td>
<td>
<p>Termination condition by specifying a maximum number of function.</p>
</td></tr>
<tr><td><code id="LEzGP_fit_+3A_algorithm">algorithm</code></td>
<td>
<p>Optimization algorithm. See <a href="https://nlopt.readthedocs.io/en/latest/NLopt_Algorithms/">NLopt Algorithms</a> for more availiable algorithms.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A model of class &quot;LEzGP model&quot; list of the following items:
</p>

<ul>
<li><p><code>param</code> A list containing the estimated parameters
</p>
</li>
<li><p><code>data</code> A list containing the fitted dataset and the information for fitting
</p>
</li></ul>



<h3>References</h3>


<ol>
<li><p> &quot;EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors&quot;, Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (<a href="https://doi.org/10.1137/19M1288462">doi:10.1137/19M1288462</a>)
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+EzGP_predict">EzGP_predict</a></code> to use the fitted EzGP model for prediction if your LEzGP model is fitted based on the EzGP model.<br />
<code><a href="#topic+EEzGP_predict">EEzGP_predict</a></code> to use the fitted EEzGP model for prediction if your LEzGP model is fitted based on the EEzGP model.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example with 9 quantitative and 9 qualitative variables (dataset included in the package):
#     Fit a LEzGP model based on the EEzGP/EzGP model(with default settings), and then
#     perform the prediction.
p = 9
q = 9
m=rep(3,9)
tau = 0
X = LEzGP_data[1:60, 1:(p+q)]
Y = LEzGP_data[1:60, p+q+1]
X_new = LEzGP_data[61:70, 1:(p+q)]
tar_z = X_new[1, (p+1):(p+q)]
ns = 7
# LEzGP Model Based on EEzGP Model
model &lt;- LEzGP_fit(X, Y, p, q, m, tar_z, ns)
y_hat &lt;- EEzGP_predict(X_new, model)
# Results showing
model
y_hat
</code></pre>

<hr>
<h2 id='LLF_gradients'>The Log-likelihood Function and The Analytical Gradients in <code>EzGP</code> Package</h2><span id='topic+LLF_gradients'></span>

<h3>Description</h3>

<p>Calculates the log-likelihood function value and the analytical gradients as described in <code>reference 1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LLF_gradients(X, Y, p, q, m, parv, tau = 0, models = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LLF_gradients_+3A_x">X</code></td>
<td>
<p>Matrix or data frame containing the inputs of training data. Each row represents the input setting of a data point and the columns are values of quantitative variables and qualitative variables.</p>
</td></tr>
<tr><td><code id="LLF_gradients_+3A_y">Y</code></td>
<td>
<p>Vector containing the outputs of training data points.</p>
</td></tr>
<tr><td><code id="LLF_gradients_+3A_p">p</code></td>
<td>
<p>Number of quantitative factors in the given dataset <code>X</code>.</p>
</td></tr>
<tr><td><code id="LLF_gradients_+3A_q">q</code></td>
<td>
<p>Number of qualitative factors in the given dataset <code>X</code>.</p>
</td></tr>
<tr><td><code id="LLF_gradients_+3A_m">m</code></td>
<td>
<p>A vector containing numbers of levels in qualitative factors.</p>
</td></tr>
<tr><td><code id="LLF_gradients_+3A_parv">parv</code></td>
<td>
<p>Parameters in the EzGP/EEzGP model.</p>
</td></tr>
<tr><td><code id="LLF_gradients_+3A_tau">tau</code></td>
<td>
<p>Nugget if needed. The default nugget is 0, otherwise it has to be a non-negative real value.</p>
</td></tr>
<tr><td><code id="LLF_gradients_+3A_models">models</code></td>
<td>
<p>Model indicator that indicates which model the likelihoods and analytical gradients are applied to. 0 for EzGP model, 1 for EEzGP model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following items:
</p>

<ul>
<li><p><code>objective</code> The log-likelihood function value.
</p>
</li>
<li><p><code>gradient</code> The analytical gradients.
</p>
</li></ul>



<h3>References</h3>


<ol>
<li><p> &quot;EzGP: Easy-to-Interpret Gaussian Process Models for Computer Experiments with Both Quantitative and Qualitative Factors&quot;, Qian Xiao, Abhyuday Mandal, C. Devon Lin, and Xinwei Deng (<a href="https://doi.org/10.1137/19M1288462">doi:10.1137/19M1288462</a>)
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+EzGP_fit">EzGP_fit</a></code> to see how an EzGP model can be fitted to a training dataset.<br />
<code><a href="#topic+EzGP_predict">EzGP_predict</a></code> to use the fitted EzGP model for prediction.<br />
<code><a href="#topic+EEzGP_fit">EEzGP_fit</a></code> to see how an EEzGP model can be fitted to a training dataset.<br />
<code><a href="#topic+EEzGP_predict">EEzGP_predict</a></code> to use the fitted EEzGP model for prediction.<br />
<code><a href="#topic+LEzGP_fit">LEzGP_fit</a></code> to see how a LEzGP model can be fitted to a training dataset.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see the examples in the documentation of the function EzGP_fit.
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
