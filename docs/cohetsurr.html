<!DOCTYPE html><html lang="en"><head><title>Help for package cohetsurr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cohetsurr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boot.var'>
<p>Performs bootstrap estimation procedures for the variance of the proportion of treatment effect explained, the omnibus test, and identifying a region above a treshold</p></a></li>
<li><a href='#complex.heterogeneity'>
<p>Estimates the proportion of treatment effect explained by the surrogate marker as a function of multiple baseline covariates.</p></a></li>
<li><a href='#exampledata'>
<p>Example data</p></a></li>
<li><a href='#parametric.est'>
<p>Estimates the proportion of treatment effect explained as a function of multiple baseline covariates, W, using a parametric model</p></a></li>
<li><a href='#two.step.est'>
<p>Estimates the proportion of treatment effect explained as a function of multiple baseline covariates, W, using a two step, semiparametric model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Assessing Complex Heterogeneity in Surrogacy</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-03-05</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions to assess and test for complex heterogeneity in the utility of a surrogate marker with respect to multiple baseline covariates, using both a parametric model and a semiparametric two-step model. More details are available in: Knowlton, R., Tian, L., &amp; Parast, L. (2025). "A General Framework to Assess Complex Heterogeneity in the Strength of a Surrogate Marker," Statistics in Medicine, 44(5), e70001 &lt;<a href="https://doi.org/10.1002%2Fsim.70001">doi:10.1002/sim.70001</a>&gt;. A tutorial for this package can be found at <a href="https://laylaparast.com/home/cohetsurr.html">https://laylaparast.com/home/cohetsurr.html</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, matrixStats, mvtnorm</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-05 18:29:28 UTC; parastlm</td>
</tr>
<tr>
<td>Author:</td>
<td>Rebecca Knowlton [aut],
  Layla Parast [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Layla Parast &lt;parast@austin.utexas.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-06 00:00:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='boot.var'>
Performs bootstrap estimation procedures for the variance of the proportion of treatment effect explained, the omnibus test, and identifying a region above a treshold
</h2><span id='topic+boot.var'></span>

<h3>Description</h3>

<p>Performs bootstrap estimation procedures for the variance of the proportion of treatment effect explained, the omnibus test, and identifying a region above a treshold
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot.var(data.control, data.treat, W.grid.expand, type, test = FALSE, 
data.all = NULL, num.cov = NULL, results.for.test = NULL, threshold = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="boot.var_+3A_data.control">data.control</code></td>
<td>

<p>dataframe containing data from the control group, specifically the outcome Y, the surrogate S, and the baseline covariates W
</p>
</td></tr>
<tr><td><code id="boot.var_+3A_data.treat">data.treat</code></td>
<td>

<p>dataframe containing data from the treamtent group, specifically the outcome Y, the surrogate S, and the baseline covariates W
</p>
</td></tr>
<tr><td><code id="boot.var_+3A_w.grid.expand">W.grid.expand</code></td>
<td>

<p>expanded version of the W grid of baseline covariates, where each row is a specific combination of the covariates for which the estimates should be provided
</p>
</td></tr>
<tr><td><code id="boot.var_+3A_type">type</code></td>
<td>

<p>options are &quot;model&quot;, &quot;two step&quot;, or &quot;both&quot;; specifies the estimation method that should be used for the proportion of treatment effect explained
</p>
</td></tr>
<tr><td><code id="boot.var_+3A_test">test</code></td>
<td>

<p>TRUE or FALSE, if test for heterogeneity is wanted
</p>
</td></tr>
<tr><td><code id="boot.var_+3A_data.all">data.all</code></td>
<td>

<p>dataframe containing data from the control and treamtent groups, specifically the outcome Y, the surrogate S, and the baseline covariates W
</p>
</td></tr>
<tr><td><code id="boot.var_+3A_num.cov">num.cov</code></td>
<td>

<p>number of baseline covariates in the matrix W
</p>
</td></tr>
<tr><td><code id="boot.var_+3A_results.for.test">results.for.test</code></td>
<td>

<p>the grid of estimates for the proportion of treatment effect explained obtained prior to bootstrapping, needed for the omnibus test
</p>
</td></tr>
<tr><td><code id="boot.var_+3A_threshold">threshold</code></td>
<td>

<p>threshold to flag regions where the estimated proportion of the treatment effect explained is at least that high
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned:
</p>
<table role = "presentation">
<tr><td><code>return.grid</code></td>
<td>
<p>grid of variance estimates for the overall treatment effect, the residual treatment effect, and the proportion of treatment effect explained as a function of the baseline covariates, W. If requested by user, includes regions flagged above the threshold.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>p-value(s) from the F test and the two step omnibus test for heterogeneity, depending on type argument</p>
</td></tr>
</table>

<hr>
<h2 id='complex.heterogeneity'>
Estimates the proportion of treatment effect explained by the surrogate marker as a function of multiple baseline covariates.
</h2><span id='topic+complex.heterogeneity'></span>

<h3>Description</h3>

<p>Assesses complex heterogeneity in the utility of a surrogate marker by estimating the proportion of treatment effect explained by the surrogate marker as a function of multiple baseline covariates. Optionally, tests for evidence of heterogeneity overall and flags regions where the proportion of treatment effect explained is above a given threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>complex.heterogeneity(y, s, a, W.mat, type = "model", variance = FALSE, 
test = FALSE, W.grid = NULL, grid.size = 4, threshold = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="complex.heterogeneity_+3A_y">y</code></td>
<td>

<p>y, the outcome
</p>
</td></tr>
<tr><td><code id="complex.heterogeneity_+3A_s">s</code></td>
<td>

<p>s, the surrogate marker
</p>
</td></tr>
<tr><td><code id="complex.heterogeneity_+3A_a">a</code></td>
<td>

<p>a, the treatment assignment with 1 indicating the treatment group and 0 indicating the control group
</p>
</td></tr>
<tr><td><code id="complex.heterogeneity_+3A_w.mat">W.mat</code></td>
<td>

<p>matrix of baseline covariate observations, where the first column is W1, second columns is W2, and so on.
</p>
</td></tr>
<tr><td><code id="complex.heterogeneity_+3A_type">type</code></td>
<td>

<p>options are &quot;model&quot;, &quot;two step&quot;, or &quot;both&quot;; specifies the estimation method that should be used for the proportion of treatment effect explained
</p>
</td></tr>
<tr><td><code id="complex.heterogeneity_+3A_variance">variance</code></td>
<td>

<p>TRUE or FALSE, if variance/standard error estimates are wanted
</p>
</td></tr>
<tr><td><code id="complex.heterogeneity_+3A_test">test</code></td>
<td>

<p>TRUE or FALSE, if test for heterogeneity is wanted
</p>
</td></tr>
<tr><td><code id="complex.heterogeneity_+3A_w.grid">W.grid</code></td>
<td>

<p>grid for the baseline covariates W where estimation will be provided
</p>
</td></tr>
<tr><td><code id="complex.heterogeneity_+3A_grid.size">grid.size</code></td>
<td>

<p>number of measures for each baseline covariate to include in the estimation grid, if one is not provided by the user directly
</p>
</td></tr>
<tr><td><code id="complex.heterogeneity_+3A_threshold">threshold</code></td>
<td>

<p>threshold to flag regions where the estimated proportion of the treatment effect explained is at least that high
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned:
</p>
<table role = "presentation">
<tr><td><code>return.grid</code></td>
<td>
<p>grid of estimates for the overall treatment effect, the residual treatment effect, and the proportion of treatment effect explained as a function of the baseline covariates, W. Includes variance estimates and regions flagged above the threshold, if specified by the user.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>p-value(s) from the F test and the two step omnibus test for heterogeneity, depending on type argument</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rebecca Knowlton
</p>


<h3>References</h3>

<p>Knowlton, R., Tian, L., &amp; Parast, L. (2025). A General Framework to Assess Complex Heterogeneity in the Strength of a Surrogate Marker. Statistics in Medicine, 44(5), e70001
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(exampledata)
  names(exampledata)
  complex.heterogeneity(y = exampledata$y,
                        s = exampledata$s,
                        a = exampledata$a,
                        W.mat = matrix(cbind(exampledata$w1, exampledata$w2), ncol = 2),
                        type = "model",
                        W.grid = matrix(cbind(exampledata$w1.grid, exampledata$w2.grid),ncol=2))
  #computationally intensive
  
    complex.heterogeneity(y = exampledata$y,
                          s = exampledata$s,
                          a = exampledata$a,
                          W.mat = matrix(cbind(exampledata$w1, 
                          exampledata$w2), ncol = 2),
                          type = "both",
                          variance = TRUE,
                          test = TRUE,
                          W.grid = matrix(cbind(exampledata$w1.grid, 
                          exampledata$w2.grid), ncol = 2),
                          threshold = 0.75)
  
</code></pre>

<hr>
<h2 id='exampledata'>
Example data
</h2><span id='topic+exampledata'></span>

<h3>Description</h3>

<p>Example data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("exampledata")</code></pre>


<h3>Format</h3>

<p>A list with 7 elements representing 1000 observations from a treatment group and 1000 observations from a control group, and a grid of baseline covariate values at which to calculate estimates:
</p>

<dl>
<dt><code>y</code></dt><dd><p>the outcome</p>
</dd>
<dt><code>s</code></dt><dd><p>the surrogate marker</p>
</dd>
<dt><code>a</code></dt><dd><p>the treatment assignment, where 1 indicates treatment and 0 indicates control</p>
</dd>
<dt><code>w1</code></dt><dd><p>the first baseline covariate of interest</p>
</dd>
<dt><code>w2</code></dt><dd><p>the second baseline covariate of interest</p>
</dd>
<dt><code>w1.grid</code></dt><dd><p>the grid of first baseline covariate values to provide estimates for</p>
</dd>
<dt><code>w2.grid</code></dt><dd><p>the grid of second baseline covariate values to provide estimates for</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(exampledata)
names(exampledata)
</code></pre>

<hr>
<h2 id='parametric.est'>
Estimates the proportion of treatment effect explained as a function of multiple baseline covariates, W, using a parametric model
</h2><span id='topic+parametric.est'></span>

<h3>Description</h3>

<p>Estimates the proportion of treatment effect explained as a function of multiple baseline covariates, W, using a parametric model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parametric.est(data.control, data.treat, W.grid.expand)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parametric.est_+3A_data.control">data.control</code></td>
<td>

<p>dataframe containing data from the control group, specifically the outcome Y, the surrogate S, and the baseline covariates W
</p>
</td></tr>
<tr><td><code id="parametric.est_+3A_data.treat">data.treat</code></td>
<td>

<p>dataframe containing data from the treamtent group, specifically the outcome Y, the surrogate S, and the baseline covariates W
</p>
</td></tr>
<tr><td><code id="parametric.est_+3A_w.grid.expand">W.grid.expand</code></td>
<td>

<p>expanded version of the W grid of baseline covariates, where each row is a specific combination of the covariates for which the estimates should be provided
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>grid of estimates of the proportion of treatment effect explained, the overall treatment effect, and the residual treatment effect for the given baseline covariate combinations
</p>

<hr>
<h2 id='two.step.est'>
Estimates the proportion of treatment effect explained as a function of multiple baseline covariates, W, using a two step, semiparametric model
</h2><span id='topic+two.step.est'></span>

<h3>Description</h3>

<p>Estimates the proportion of treatment effect explained as a function of multiple baseline covariates, W, using a two step, semiparametric model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>two.step.est(data.control, data.treat, W.grid.expand.function)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="two.step.est_+3A_data.control">data.control</code></td>
<td>

<p>dataframe containing data from the control group, specifically the outcome Y, the surrogate S, and the baseline covariates W
</p>
</td></tr>
<tr><td><code id="two.step.est_+3A_data.treat">data.treat</code></td>
<td>

<p>dataframe containing data from the treamtent group, specifically the outcome Y, the surrogate S, and the baseline covariates W
</p>
</td></tr>
<tr><td><code id="two.step.est_+3A_w.grid.expand.function">W.grid.expand.function</code></td>
<td>

<p>expanded version of the W grid of baseline covariates, where each row is a specific combination of the covariates for which the estimates should be provided
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>grid of estimates of the proportion of treatment effect explained, the overall treatment effect, and the residual treatment effect for the given baseline covariate combinations
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
