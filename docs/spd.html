<!DOCTYPE html><html lang="en"><head><title>Help for package spd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#spd-package'><p>The Semi-Parametric Distribution (spd) package</p></a></li>
<li><a href='#GPDFIT-class'><p>Class: Generalized Pareto Distribution</p></a></li>
<li><a href='#GPDTAILS-class'><p>Class: GPDTAILS</p></a></li>
<li><a href='#plot-methods'><p>Method: Plotting (S4) for implemented S4 classes</p></a></li>
<li><a href='#SPD-class'><p>Class: Semi-Parametric Distribution</p></a></li>
<li><a href='#spd-methods'><p>Method: Semi-Parametric Distribution</p></a></li>
<li><a href='#spdfit-methods'><p>Method: Fitting the Semi-Parametric Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Semi Parametric Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-07-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexios Ghalanos &lt;alexios@4dscape.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexios Ghalanos &lt;alexios@4dscape.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The Semi Parametric Piecewise Distribution blends the Generalized Pareto Distribution for the tails with a kernel based interior.</td>
</tr>
<tr>
<td>Collate:</td>
<td>misc-spd.R classes-spd.R methods-GPD.R methods-spdFit.R
methods-spdDistribution.R methods-spdPlots.R</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods</td>
</tr>
<tr>
<td>Imports:</td>
<td>KernSmooth, stats, graphics, utils</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.unstarched.net">http://www.unstarched.net</a>, <a href="https://bitbucket.org/alexiosg">https://bitbucket.org/alexiosg</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-07-02 23:32:01 UTC; alexios</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-07-03 05:44:57</td>
</tr>
</table>
<hr>
<h2 id='spd-package'>The Semi-Parametric Distribution (spd) package</h2><span id='topic+spd-package'></span><span id='topic+spd'></span>

<h3>Description</h3>

<p>The Semi-Parametric Distribution is a piecewise distribution 
constructed by parametrically modelling the tails of the distribution
using an appropriate distribution (e.g. generalized pareto) and the interior by 
kernel methods. The package implements fit, distribution, density,
quantile and random number generation. Currently, only the generalized pareto 
distribution is implemented for modelling the tails, but the package can easily 
be extended.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> spd</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0-0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2013-12-15</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> methods</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The main functionality of the package is contained in the <code><a href="#topic+SPD-class">SPD</a></code> 
class, created by calling <code><a href="#topic+spdfit">spdfit</a></code>. Methods for density 
<code><a href="#topic+dspd">dspd</a></code>, distribution <code><a href="#topic+pspd">pspd</a></code>, quantile <code><a href="#topic+qspd">qspd</a></code> 
and random number generation <code><a href="#topic+rspd">rspd</a></code> exist and take 2 main arguments, 
the input value and the fitted object.<br />
The spd package uses the <code>"bkde"</code> function from the package KernSmooth for 
the kernel interior fit, while for the tail fit borrows from the fExtremes 
package and implements a locally modified copy of the gpd functionality and 
methods.
</p>


<h3>Author(s)</h3>

<p>Alec Stephenson for the functions from R\'s <code>"evd-package"</code>,<br />
Alec Stephenson for the functions from R\'s <code>"evir-package"</code>,<br />
Alexander McNeil for the EVIS functions underlying the <code>"evir-package"</code>,<br />
Diethelm Wuertz for the functions from R\'s <code>"fExtremes-package"</code>,<br />
M.P.Wand and M.C.Jones for the functions from R\'s <code>"KernSmooth-package"</code>,<br />
Alexios Ghalanos for this package.</p>


<h3>References</h3>

<p>Carmona, R. and J. Morrisson (2001). Heavy Tails and Copulas with Evanesce, 
ORFE Tech. Report, Princeton University<br />
Carmona, R. (2001). Statistical Analysis of Financial Data, with an 
implementation in Splus<br />
Embrechts, P., Klueppelberg, C., Mikosch, T. (1997); <em>Modelling Extremal 
Events</em>, Springer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MASS)
x&lt;-SP500/100
fit&lt;-spdfit(x)
show(fit)

## End(Not run)</code></pre>

<hr>
<h2 id='GPDFIT-class'>Class: Generalized Pareto Distribution</h2><span id='topic+GPDFIT-class'></span><span id='topic+GPDFIT'></span><span id='topic+show+2CGPDFIT-method'></span>

<h3>Description</h3>

<p> Locally implemented and slightly modified class for the generalized 
pareto distribution (gpd) fit, borrowed from package <code>fExtremes</code>. Created 
on modelling the tails of the data by <code><a href="#topic+spdfit">spdfit</a></code></p>


<h3>Objects from the Class</h3>

<p>Objects of this class cannot be created by user as the methods are not exported.
</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code>:</dt><dd><p>Object of class <code>"call"</code> </p>
</dd>
<dt><code>method</code>:</dt><dd><p>Object of class <code>"character"</code> </p>
</dd>
<dt><code>parameter</code>:</dt><dd><p>Object of class <code>"list"</code> </p>
</dd>
<dt><code>data</code>:</dt><dd><p>Object of class <code>"list"</code> </p>
</dd>
<dt><code>fit</code>:</dt><dd><p>Object of class <code>"list"</code> </p>
</dd>
<dt><code>residuals</code>:</dt><dd><p>Object of class <code>"numeric"</code> </p>
</dd>
<dt><code>title</code>:</dt><dd><p>Object of class <code>"character"</code> </p>
</dd>
<dt><code>description</code>:</dt><dd><p>Object of class <code>"character"</code> </p>
</dd>
</dl>



<h3>Note</h3>

<p> S3 plot method exists which provides for visual inspection of the fit 
and is called by the higher level S3 plot method of the <code><a href="#topic+SPD-class">SPD</a></code> 
class</p>


<h3>Author(s)</h3>

<p>Alec Stephenson for the functions from R\'s <code>"evd-package"</code>, 
Alec Stephenson for the functions from R\'s <code>"evir-package"</code>, 
Alexander McNeil for the EVIS functions underlying the <code>"evir-package"</code>, 
Diethelm Wuertz for the functions from R\'s <code>"fExtremes-package"</code>,
M.P.Wand and M.C.Jones for the functions from R\'s <code>"KernSmooth-package"</code>,
Alexios Ghalanos for this package.</p>


<h3>References</h3>

<p>Carmona, R. and J. Morrisson (2001). Heavy Tails and Copulas with Evanesce, 
ORFE Tech. Report, Princeton University<br />
Carmona, R. (2001). Statistical Analysis of Financial Data, with an 
implementation in Splus<br />
Embrechts, P., Klueppelberg, C., Mikosch, T. (1997); <em>Modelling Extremal 
Events</em>, Springer
</p>

<hr>
<h2 id='GPDTAILS-class'>Class: GPDTAILS</h2><span id='topic+GPDTAILS-class'></span><span id='topic+GPDTAILS'></span>

<h3>Description</h3>

<p>Class: SPD with Generalized Pareto Distribution (GPD) Tails </p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calling <code><a href="#topic+spdfit">spdfit</a></code>. The main implemented 
class of the spd package holding the details of the fitted object with gpd tails.</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code>:</dt><dd><p>...</p>
</dd>
<dt><code>method</code>:</dt><dd><p>the gpd fitting method</p>
</dd>
<dt><code>kernel</code>:</dt><dd><p>the kernel type</p>
</dd>
<dt><code>data</code>:</dt><dd><p>the original dataset</p>
</dd>
<dt><code>threshold</code>:</dt><dd><p>the upper and lower thresholds fitted</p>
</dd>
<dt><code>ptails</code>:</dt><dd><p>the upper and lower cutoff points.</p>
</dd>
<dt><code>fit</code>:</dt><dd><p>the upper and lower gpd fit and the interior kernel fit objects.</p>
</dd>
<dt><code>title</code>:</dt><dd><p>optional title of project</p>
</dd>
<dt><code>description</code>:</dt><dd><p>optional description</p>
</dd>
</dl>



<h3>Extends</h3>

<p>Class <code><a href="#topic+SPD-class">SPD</a></code>, directly.
</p>


<h3>Author(s)</h3>

<p> Alexios Ghalanos </p>


<h3>References</h3>

<p>Carmona, R. and J. Morrisson (2001). Heavy Tails and Copulas with 
Evanesce, ORFE Tech. Report, Princeton University<br />
Carmona, R. (2001). Statistical Analysis of Financial Data, with an 
implementation in Splus</p>

<hr>
<h2 id='plot-methods'>Method: Plotting (S4) for implemented S4 classes</h2><span id='topic+plot-methods'></span><span id='topic+plot'></span><span id='topic+plot+2CANY+2CANY-method'></span><span id='topic+plot+2CGPDFIT+2Cmissing-method'></span><span id='topic+plot+2CGPDTAILS+2Cmissing-method'></span>

<h3>Description</h3>

<p>Locally implemented and modified methods for plotting the fit of the 
<code><a href="#topic+GPDFIT-class">GPDFIT</a></code> object (taken from package <code>fExtremes</code>), and 
the overall fit of the <code><a href="#topic+GPDTAILS-class">GPDTAILS</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot(x,y,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot-methods_+3A_x">x</code></td>
<td>
<p> An object of class <code><a href="#topic+GPDFIT-class">GPDFIT</a></code> or <code><a href="#topic+GPDTAILS-class">GPDTAILS</a></code>.</p>
</td></tr>
<tr><td><code id="plot-methods_+3A_y">y</code></td>
<td>
<p> missing </p>
</td></tr>
<tr><td><code id="plot-methods_+3A_...">...</code></td>
<td>

<p>[which] - <br />
Valid arguments are &ldquo;ask&rdquo; for interactive plotting, &ldquo;all&rdquo; to 
plot all or a number from 1 to 6 indicating the desired charts to plot.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MASS)
x&lt;-SP500/100
fit&lt;-spdfit(x)
plot(fit,which=1)
# this in fact exctracts the GPDFIT object (from GPDTAILS) for which plot 
# methods exist.
plot(fit,which=3)

## End(Not run)</code></pre>

<hr>
<h2 id='SPD-class'>Class: Semi-Parametric Distribution </h2><span id='topic+SPD-class'></span><span id='topic+SPD'></span><span id='topic+show+2CSPD-method'></span>

<h3>Description</h3>

<p> Virtual Class for holding the tail fit and kernel interior objects. </p>


<h3>Methods</h3>


<dl>
<dt>dspd</dt><dd><p><code>signature(x = "numeric", fit = "SPD", linear = "logical")</code>: 
density function</p>
</dd>
<dt>pspd</dt><dd><p><code>signature(q = "numeric", fit = "SPD", linear = "logical")</code>: 
distribution function</p>
</dd>
<dt>qspd</dt><dd><p><code>signature(p = "numeric", fit = "SPD", linear = "logical")</code>: 
quantile function </p>
</dd>
<dt>rspd</dt><dd><p><code>signature(n = "numeric", fit = "SPD", linear = "logical")</code>: 
random number generation function</p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "SPD")</code>: show method </p>
</dd>
</dl>



<h3>Objects from the Class</h3>

<p>A virtual Class: No objects may be created from it.</p>


<h3>Author(s)</h3>

<p> Alexios Ghalanos </p>


<h3>References</h3>

<p>Carmona, R. and J. Morrisson (2001). Heavy Tails and Copulas with 
Evanesce, ORFE Tech. Report, Princeton University<br />
Carmona, R. (2001). Statistical Analysis of Financial Data, with an 
implementation in Splus</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("SPD")
</code></pre>

<hr>
<h2 id='spd-methods'>Method: Semi-Parametric Distribution</h2><span id='topic+pspd'></span><span id='topic+dspd'></span><span id='topic+qspd'></span><span id='topic+rspd'></span><span id='topic+dspd-methods'></span><span id='topic+pspd-methods'></span><span id='topic+qspd-methods'></span><span id='topic+rspd-methods'></span><span id='topic+rspd+2CANY+2CANY+2CANY-method'></span><span id='topic+rspd+2Cvector+2CSPD+2Clogical-method'></span><span id='topic+rspd+2Cvector+2CSPD+2Cmissing-method'></span><span id='topic+dspd+2CANY+2CANY+2CANY-method'></span><span id='topic+dspd+2Cvector+2CSPD+2Clogical-method'></span><span id='topic+dspd+2Cvector+2CSPD+2Cmissing-method'></span><span id='topic+pspd+2CANY+2CANY+2CANY-method'></span><span id='topic+pspd+2Cvector+2CSPD+2Clogical-method'></span><span id='topic+pspd+2Cvector+2CSPD+2Cmissing-method'></span><span id='topic+qspd+2CANY+2CANY+2CANY-method'></span><span id='topic+qspd+2Cvector+2CSPD+2Clogical-method'></span><span id='topic+qspd+2Cvector+2CSPD+2Cmissing-method'></span>

<h3>Description</h3>

<p>Density, Distribution, Quantile and Random Number Generation methods for the 
Semi-Parametric Distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dspd(x, fit, linear)
pspd(q, fit, linear)
qspd(p, fit, linear)
rspd(n, fit, linear)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spd-methods_+3A_n">n</code></td>
<td>

<p>[rspd] - <br />
the number of random deviates to be generated from fitted distribution.
</p>
</td></tr> 
<tr><td><code id="spd-methods_+3A_p">p</code></td>
<td>

<p>a vector of probability levels, the desired probability for the 
quantile estimate (e.g. 0.99 for the 99th percentile).
</p>
</td></tr> 
<tr><td><code id="spd-methods_+3A_x">x</code>, <code id="spd-methods_+3A_q">q</code></td>
<td>

<p>[pspd,dspd] - <br />
a numeric vector of quantiles.
</p>
</td></tr>
<tr><td><code id="spd-methods_+3A_fit">fit</code></td>
<td>

<p>[all] - <br />
the object of class SPDFIT created by calling the spdfit function.
</p>
</td></tr>
<tr><td><code id="spd-methods_+3A_linear">linear</code></td>
<td>

<p>[all] - <br />
logical, if TRUE interior smoothing function uses linear interpolation 
rather than constant.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>All values are numeric vectors: <br />
<code>d*</code> returns the density (pdf), <br />
<code>p*</code> returns the probability (cdf), <br />
<code>q*</code> returns the quantiles (inverse cdf), and <br />
<code>r*</code> generates random deviates.
</p>


<h3>Note</h3>

<p>The density is computed using the generalized pareto distribution in the tails, 
while for the middle, the density is computed by using a smooth gradient approach. 
Interpolation is used to splice together the ends with the middle portion,
providing for an approximate piecewise constant density function. As such, 
caution should be used when interpreting results obtained by use of this function.
</p>


<h3>Author(s)</h3>

<p>Alec Stephenson for the functions from R\'s <code>evd</code> package, <br />
Alec Stephenson for the functions from R\'s <code>evir</code> package, <br />
Alexander McNeil for the EVIS functions underlying the <code>evir</code> package, <br />
Diethelm Wuetrz for the <code>fExtremes</code> Implementation of the gpd, <br />
Alexios Ghalanos for the SPD Implementation, <br />
</p>


<h3>References</h3>

<p>Embrechts, P., Klueppelberg, C., Mikosch, T. (1997); <em>Modelling Extremal 
Events</em>, Springer.<br />
Carmona, R. (2004);<em>Statistical Anlaysis of Financial Data in Splus</em>, 
Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MASS)
x = SP500/100
fit=spdfit(x, upper=0.9, lower=0.1)
## rspd  -
   par(mfrow = c(2, 2), cex = 0.7)
   r = rspd(n = 1000, fit)
   hist(r, n = 100, probability = TRUE, xlab = "r", 
   col = "steelblue", border = "white",main = "Density")
   box()
## dspd -
   # Plot empirical density and compare with true density:
   r = rspd(n = 1000, fit)
   hist(r, n = 100, probability = TRUE, xlab = "r", 
   col = "steelblue", border = "white",main = "Density")
   box()
   x = seq(-0.3, 0.3, length.out = 1000)
   lines(x, dspd(x, fit), col = "darkorange",lwd=2)
   
## pspd -
   # Plot df and compare with true df:
   plot(sort(r), (1:length(r)/length(r)), 
   ylim = c(0, 1), pch = 19, 
   cex = 0.5, ylab = "p", xlab = "q", main = "CDF")
   grid()
   q = seq(-0.3, 0.3, length.out = 1000)
   lines(q, pspd(q, fit), col = "darkorange",lwd=2)

## End(Not run)</code></pre>

<hr>
<h2 id='spdfit-methods'>Method: Fitting the Semi-Parametric Distribution</h2><span id='topic+spdfit-methods'></span><span id='topic+spdfit+2CANY-method'></span><span id='topic+spdfit'></span>

<h3>Description</h3>

<p>The semi-parametric distribution fitting method.</p>


<h3>Usage</h3>

<pre><code class='language-R'>spdfit(data, upper = 0.9, lower = 0.1, tailfit="GPD", type = c("mle", "pwm"), 
kernelfit = c("normal", "box", "epanech", "biweight", "triweight"), 
information = c("observed", "expected"), title = NULL, description = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spdfit-methods_+3A_data">data</code></td>
<td>
<p>An object coercible to a <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="spdfit-methods_+3A_upper">upper</code></td>
<td>
<p>Upper tail cutoff for fitting the generalized pareto or other distribution.</p>
</td></tr>
<tr><td><code id="spdfit-methods_+3A_lower">lower</code></td>
<td>
<p>Lower tail cutoff for fitting the generalized pareto or other distribution.</p>
</td></tr>
<tr><td><code id="spdfit-methods_+3A_tailfit">tailfit</code></td>
<td>
<p>Distribution to Use for fitting the tails.</p>
</td></tr>
<tr><td><code id="spdfit-methods_+3A_type">type</code></td>
<td>
<p>A character string selecting the desired estimation method, either &quot;mle&quot; for the maximum likelihood method or
&quot;pwm&quot; for the probability weighted moment method. By default, the first will be selected.</p>
</td></tr>
<tr><td><code id="spdfit-methods_+3A_kernelfit">kernelfit</code></td>
<td>
<p>Type of kernel to fit to the interior of the distribution.</p>
</td></tr>
<tr><td><code id="spdfit-methods_+3A_information">information</code></td>
<td>
<p>Whether tail distribution standard errors should be calculated with &quot;observed&quot; or &quot;expected&quot; information. 
This only applies to the maximum likelihood method; for the probability-weighted moments method &quot;expected&quot; information 
is used if possible.</p>
</td></tr>
<tr><td><code id="spdfit-methods_+3A_title">title</code></td>
<td>
<p>A character string which allows for a project title. </p>
</td></tr>
<tr><td><code id="spdfit-methods_+3A_description">description</code></td>
<td>
<p>A character string which allows for a brief description. </p>
</td></tr>
<tr><td><code id="spdfit-methods_+3A_...">...</code></td>
<td>
<p>Control parameters and plot parameters optionally passed to the optimization and/or plot function. 
Parameters for the optimization function are passed to components of the control argument of optim.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code><a href="#topic+SPD-class">SPD</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(MASS)
x&lt;-SP500/100
fit&lt;-spdfit(x)
show(fit)
#plot(fit,which="all")

## End(Not run)</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
