<!DOCTYPE html><html><head><title>Help for package DySS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DySS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calculate_ATS'><p>Calculate ATS</p></a></li>
<li><a href='#calculate_signal_times'><p>Calculate Signal Times</p></a></li>
<li><a href='#data_example_long_1d'><p>A simulated dataset with univariate data</p></a></li>
<li><a href='#data_example_long_md'><p>A simulated dataset with multivariate longitudinal data</p></a></li>
<li><a href='#data_example_long_surv'><p>A simulated dataset with longitudinal and survival data</p></a></li>
<li><a href='#data_stroke'><p>A real data example on stroke</p></a></li>
<li><a href='#estimate_pattern_long_1d'><p>Estimate the Regular Longitudinal Pattern of Univariate Data</p></a></li>
<li><a href='#estimate_pattern_long_md'><p>Estimate the Regular Longitudinal Pattern of Multivariate Data</p></a></li>
<li><a href='#estimate_pattern_long_surv'><p>Estimate the Pattern of Longitudinal and Survival Data</p></a></li>
<li><a href='#evaluate_control_chart_one_group'><p>Evaluate Control Charts (in a single dataset)</p></a></li>
<li><a href='#evaluate_control_chart_two_groups'><p>Evaluate Control Charts</p></a></li>
<li><a href='#monitor_long_1d'><p>Monitor Univariate Longitudinal Data</p></a></li>
<li><a href='#monitor_long_md'><p>Monitor Multivariate Longitudinal Data</p></a></li>
<li><a href='#monitor_long_surv'><p>Monitor Longitudinal Data for Survival Outcomes</p></a></li>
<li><a href='#plot_evaluation'><p>Evaluate and Visualize Control Charts by ROC curves</p></a></li>
<li><a href='#plot_PMROC'><p>Evaluate and Visualize Control Charts by PM-ROC curves</p></a></li>
<li><a href='#search_CL'><p>Search Control Limit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Dynamic Screening Systems</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-07-04</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lu You &lt;Lu.You@epi.usf.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>In practice, we will encounter problems where the longitudinal performance of processes needs to be monitored over time. 
  Dynamic screening systems (DySS) are methods that aim to identify and give signals to processes with poor performance as early as possible. 
  This package is designed to implement dynamic screening systems and the related methods.
  References:
  Qiu, P. and Xiang, D. (2014) &lt;<a href="https://doi.org/10.1080%2F00401706.2013.822423">doi:10.1080/00401706.2013.822423</a>&gt;;
  Qiu, P. and Xiang, D. (2015) &lt;<a href="https://doi.org/10.1002%2Fsim.6477">doi:10.1002/sim.6477</a>&gt;;
  Li, J. and Qiu, P. (2016) &lt;<a href="https://doi.org/10.1080%2F0740817X.2016.1146423">doi:10.1080/0740817X.2016.1146423</a>&gt;;
  Li, J. and Qiu, P. (2017) &lt;<a href="https://doi.org/10.1002%2Fqre.2160">doi:10.1002/qre.2160</a>&gt;;
  You, L. and Qiu, P. (2019) &lt;<a href="https://doi.org/10.1080%2F00949655.2018.1552273">doi:10.1080/00949655.2018.1552273</a>&gt;;
  Qiu, P., Xia, Z., and You, L. (2020) &lt;<a href="https://doi.org/10.1080%2F00401706.2019.1604434">doi:10.1080/00401706.2019.1604434</a>&gt;;
  You, L., Qiu, A., Huang, B., and Qiu, P. (2020) &lt;<a href="https://doi.org/10.1002%2Fbimj.201900127">doi:10.1002/bimj.201900127</a>&gt;;
  You, L. and Qiu, P. (2021) &lt;<a href="https://doi.org/10.1080%2F00224065.2020.1767006">doi:10.1080/00224065.2020.1767006</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.0), utils, stats, graphics, ggplot2, gridExtra</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-15 23:39:41 UTC; luyou</td>
</tr>
<tr>
<td>Author:</td>
<td>Lu You [aut, cre],
  Peihua Qiu [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-16 09:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='calculate_ATS'>Calculate ATS</h2><span id='topic+calculate_ATS'></span>

<h3>Description</h3>

<p>The function <code>calculate_ATS</code> calculates the average time to signals (ATS) given 
a control chart matrix and a specified control limit (CL). ATS is defined as the average time from
the start of process monitoring to signal times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_ATS(
  chart_matrix,
  time_matrix,
  nobs,
  starttime,
  endtime,
  design_interval,
  n_time_units,
  time_unit,
  CL,
  no_signal_action = "omit"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_ATS_+3A_chart_matrix">chart_matrix</code></td>
<td>
<p>charting statistic values arranged as a numeric matrix. <br />
<code>chart_matrix[i,j]</code> is the jth charting statistic of the ith subject.</p>
</td></tr>
<tr><td><code id="calculate_ATS_+3A_time_matrix">time_matrix</code></td>
<td>
<p>observation times arranged as a numeric matrix. <br />
<code>time_matrix[i,j]</code> is the jth observation time of the ith subject,
corresponding to the time the charting statistic <code>chart_matrix[i,j]</code> is computed.</p>
</td></tr>
<tr><td><code id="calculate_ATS_+3A_nobs">nobs</code></td>
<td>
<p>number of observations arranged as an integer vector. <br />
<code>nobs[i]</code> is the number of observations for the ith subject.</p>
</td></tr>
<tr><td><code id="calculate_ATS_+3A_starttime">starttime</code></td>
<td>
<p>a numeric vector that gives the start times. <br />
<code>starttime[i]</code> is the time that the ith subject starts to be monitored.</p>
</td></tr>
<tr><td><code id="calculate_ATS_+3A_endtime">endtime</code></td>
<td>
<p>a numeric vector that gives the end times. <br />
<code>endtime[i]</code> is the time that the ith subject is lost to be monitored.</p>
</td></tr>
<tr><td><code id="calculate_ATS_+3A_design_interval">design_interval</code></td>
<td>
<p>a numeric vector of length two that 
gives the left- and right- limits of the design interval. 
By default, <code>design_interval=range(time_matrix,na.rm=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="calculate_ATS_+3A_n_time_units">n_time_units</code></td>
<td>
<p>an integer value that gives the number of basic time units
in the design time interval. <br />
The design interval will be discretized to <br />
<code>seq(design_interval[1],design_interval[2],length.out=n_time_units)</code></p>
</td></tr>
<tr><td><code id="calculate_ATS_+3A_time_unit">time_unit</code></td>
<td>
<p>an optional numeric value of basic time unit. Only used when <code>n_time_units</code> is missing. <br />
The design interval will be discretized to <br />
<code>seq(design_interval[1],design_interval[2],by=time_unit)</code></p>
</td></tr>
<tr><td><code id="calculate_ATS_+3A_cl">CL</code></td>
<td>
<p>a numeric value specifying the control limit. <br />
<code>CL</code> is the control limit, signals will be given if charting statistics are greater than the control limit.</p>
</td></tr>
<tr><td><code id="calculate_ATS_+3A_no_signal_action">no_signal_action</code></td>
<td>
<p>a character specifying the method to use when a signal is not given to a process.
If <code>no_signal_action="omit"</code> take averages by omitting the processes with no signals, namely, average only the processes with signals. <br />
If <code>no_signal_action="maxtime"</code> impute the signal times by the maximum time, which is the right limit of design time interval. <br />
If <code>no_signal_action="endtime"</code> impute the signal times by the end times.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate ATS
</p>


<h3>Value</h3>

<p>a numeric value, the ATS given the charting statistics and the control limit.
</p>


<h3>References</h3>

<p>Qiu, P. and Xiang, D. (2014). Univariate dynamic screening system: an approach for identifying individuals with irregular longitudinal behavior. Technometrics, 56:248-260. <br />
Qiu, P., Xia, Z., and You, L. (2020). Process monitoring roc curve for evaluating dynamic screening methods. Technometrics, 62(2).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("data_example_long_1d")

result_pattern&lt;-estimate_pattern_long_1d(
  data_matrix=data_example_long_1d$data_matrix_IC,
  time_matrix=data_example_long_1d$time_matrix_IC,
  nobs=data_example_long_1d$nobs_IC,
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  estimation_method="meanvar",
  smoothing_method="local linear",
  bw_mean=0.1,
  bw_var=0.1)

result_monitoring&lt;-monitor_long_1d(
  data_matrix_new=data_example_long_1d$data_matrix_OC,
  time_matrix_new=data_example_long_1d$time_matrix_OC,
  nobs_new=data_example_long_1d$nobs_OC,
  pattern=result_pattern,
  side="upward",
  chart="CUSUM",
  method="standard",
  parameter=0.5)

result_ATS&lt;-calculate_ATS(
  chart_matrix=result_monitoring$chart,
  time_matrix=data_example_long_1d$time_matrix_OC,
  nobs=data_example_long_1d$nobs_OC,
  starttime=rep(0,nrow(data_example_long_1d$time_matrix_OC)),
  endtime=rep(1,nrow(data_example_long_1d$time_matrix_OC)),
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  CL=2.0)
  
</code></pre>

<hr>
<h2 id='calculate_signal_times'>Calculate Signal Times</h2><span id='topic+calculate_signal_times'></span>

<h3>Description</h3>

<p>The function <code>calculate_signal_times</code> calculates the time to signals given 
a control chart matrix and a specified control limit (CL).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_signal_times(
  chart_matrix,
  time_matrix,
  nobs,
  starttime,
  endtime,
  design_interval,
  n_time_units,
  time_unit,
  CL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_signal_times_+3A_chart_matrix">chart_matrix</code></td>
<td>
<p>a matrix of charting statistic values. <br />
<code>chart_matrix[i,j]</code> is the jth charting statistic of the ith subject.</p>
</td></tr>
<tr><td><code id="calculate_signal_times_+3A_time_matrix">time_matrix</code></td>
<td>
<p>a matrix of observation times. <br />
<code>time_matrix[i,j]</code> is the jth observation time of the ith subject,
corresponding to the time the charting statistic <code>chart_matrix[i,j]</code> is computed.</p>
</td></tr>
<tr><td><code id="calculate_signal_times_+3A_nobs">nobs</code></td>
<td>
<p>number of observations arranged as an integer vector. <br />
<code>nobs[i]</code> is the number of observations for the ith subject.</p>
</td></tr>
<tr><td><code id="calculate_signal_times_+3A_starttime">starttime</code></td>
<td>
<p>a vector of times from the start of monitoring. <br />
<code>starttime[i]</code> is the time that the ith subject starts to be monitored.</p>
</td></tr>
<tr><td><code id="calculate_signal_times_+3A_endtime">endtime</code></td>
<td>
<p>a vector of times from the start of monitoring. <br />
<code>endtime[i]</code> is the time that the ith subject is lost to be monitored.</p>
</td></tr>
<tr><td><code id="calculate_signal_times_+3A_design_interval">design_interval</code></td>
<td>
<p>a numeric vector of length two that 
gives the left- and right- limits of the design interval. 
By default, <code>design_interval=range(time_matrix,na.rm=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="calculate_signal_times_+3A_n_time_units">n_time_units</code></td>
<td>
<p>an integer value that gives the number of basic time units
in the design time interval. <br />
The design interval will be discretized to <br />
<code>seq(design_interval[1],design_interval[2],length.out=n_time_units)</code></p>
</td></tr>
<tr><td><code id="calculate_signal_times_+3A_time_unit">time_unit</code></td>
<td>
<p>an optional numeric value of basic time unit. Only used when <code>n_time_units</code> is missing.<br />
The design interval will be discretized to <br />
<code>seq(design_interval[1],design_interval[2],by=time_unit)</code></p>
</td></tr>
<tr><td><code id="calculate_signal_times_+3A_cl">CL</code></td>
<td>
<p>a numeric value specifying the control limit. <br />
<code>CL</code> is the control limit, signals will be given if charting statistics are greater than the control limit.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate Signal Times
</p>


<h3>Value</h3>

<p>A list of two vectors: <br />
</p>
<table>
<tr><td><code>$signal_times</code></td>
<td>
<p>times to signals, a numeric vector.</p>
</td></tr>
<tr><td><code>$signals</code></td>
<td>
<p>whether the subject received signals, a logical vector.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Qiu, P. and Xiang, D. (2014). Univariate dynamic screening system: an approach for identifying individuals with irregular longitudinal behavior. Technometrics, 56:248-260. <br />
Qiu, P., Xia, Z., and You, L. (2020). Process monitoring roc curve for evaluating dynamic screening methods. Technometrics, 62(2).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("data_example_long_1d")

result_pattern&lt;-estimate_pattern_long_1d(
  data_matrix=data_example_long_1d$data_matrix_IC,
  time_matrix=data_example_long_1d$time_matrix_IC,
  nobs=data_example_long_1d$nobs_IC,
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  estimation_method="meanvar",
  smoothing_method="local linear",
  bw_mean=0.1,
  bw_var=0.1)

result_monitoring&lt;-monitor_long_1d(
  data_matrix_new=data_example_long_1d$data_matrix_OC,
  time_matrix_new=data_example_long_1d$time_matrix_OC,
  nobs_new=data_example_long_1d$nobs_OC,
  pattern=result_pattern,
  side="upward",
  chart="CUSUM",
  method="standard",
  parameter=0.5)
result_signal_times&lt;-calculate_signal_times(
  chart_matrix=result_monitoring$chart,
  time_matrix=data_example_long_1d$time_matrix_OC,
  nobs=data_example_long_1d$nobs_OC,
  starttime=rep(0,nrow(data_example_long_1d$time_matrix_OC)),
  endtime=rep(1,nrow(data_example_long_1d$time_matrix_OC)),
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  CL=2.0)
</code></pre>

<hr>
<h2 id='data_example_long_1d'>A simulated dataset with univariate data</h2><span id='topic+data_example_long_1d'></span>

<h3>Description</h3>

<p>A simulated univariate longitudinal dataset for demonstration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_example_long_1d)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 9.
</p>


<h3>Details</h3>

<p>Data Example: Univariate Longitudinal Data
</p>


<h3>Value</h3>

<p>A list of the following components
</p>
<table>
<tr><td><code>$data_matrix_IC</code></td>
<td>
<p>The data matrix for IC data.</p>
</td></tr>
<tr><td><code>$time_matrix_IC</code></td>
<td>
<p>The time matrix for IC data.</p>
</td></tr>
<tr><td><code>$nobs_IC</code></td>
<td>
<p>Number of observations for each IC process.</p>
</td></tr>
<tr><td><code>$data_matrix_OC</code></td>
<td>
<p>The data matrix for OC data.</p>
</td></tr>
<tr><td><code>$time_matrix_OC</code></td>
<td>
<p>The time matrix for OC data.</p>
</td></tr>
<tr><td><code>$nobs_OC</code></td>
<td>
<p>Number of observations for each OC process.</p>
</td></tr>
<tr><td><code>$design_interval</code></td>
<td>
<p>The design interval.</p>
</td></tr>
<tr><td><code>$n_time_units</code></td>
<td>
<p>Number of time units in the design interval.</p>
</td></tr>
<tr><td><code>$time_unit</code></td>
<td>
<p>The time unit.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_example_long_1d)
</code></pre>

<hr>
<h2 id='data_example_long_md'>A simulated dataset with multivariate longitudinal data</h2><span id='topic+data_example_long_md'></span>

<h3>Description</h3>

<p>A simulated univariate longitudinal dataset for demonstration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_example_long_md)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 9.
</p>


<h3>Details</h3>

<p>Data Example: Multivariate Longitudinal Data
</p>


<h3>Value</h3>

<p>A list of the following components
</p>
<table>
<tr><td><code>$data_array_IC</code></td>
<td>
<p>The data array for IC data.</p>
</td></tr>
<tr><td><code>$time_matrix_IC</code></td>
<td>
<p>The time matrix for IC data.</p>
</td></tr>
<tr><td><code>$nobs_IC</code></td>
<td>
<p>Number of observations for each IC process.</p>
</td></tr>
<tr><td><code>$data_array_OC</code></td>
<td>
<p>The data array for OC data.</p>
</td></tr>
<tr><td><code>$time_matrix_OC</code></td>
<td>
<p>The time matrix for OC data.</p>
</td></tr>
<tr><td><code>$nobs_OC</code></td>
<td>
<p>Number of observations for each OC process.</p>
</td></tr>
<tr><td><code>$design_interval</code></td>
<td>
<p>The design interval.</p>
</td></tr>
<tr><td><code>$n_time_units</code></td>
<td>
<p>Number of time units in the design interval.</p>
</td></tr>
<tr><td><code>$time_unit</code></td>
<td>
<p>The time unit.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_example_long_md)
</code></pre>

<hr>
<h2 id='data_example_long_surv'>A simulated dataset with longitudinal and survival data</h2><span id='topic+data_example_long_surv'></span>

<h3>Description</h3>

<p>A simulated univariate longitudinal dataset for demonstration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_example_long_surv)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 15.
</p>


<h3>Details</h3>

<p>Data Example: Longitudinal and Survival Data
</p>


<h3>Value</h3>

<p>A list of the following components
</p>
<table>
<tr><td><code>$data_array_IC</code></td>
<td>
<p>The data array for IC data.</p>
</td></tr>
<tr><td><code>$time_matrix_IC</code></td>
<td>
<p>The time matrix for IC data.</p>
</td></tr>
<tr><td><code>$nobs_IC</code></td>
<td>
<p>Number of observations for each IC process.</p>
</td></tr>
<tr><td><code>$starttime_IC</code></td>
<td>
<p>Start time of monitoring for IC processes.</p>
</td></tr>
<tr><td><code>$survtime_IC</code></td>
<td>
<p>End time of monitoring for IC processes.</p>
</td></tr>
<tr><td><code>$survevent_IC</code></td>
<td>
<p>Survival events of IC processes.</p>
</td></tr>
<tr><td><code>$data_array_OC</code></td>
<td>
<p>The data array for OC data.</p>
</td></tr>
<tr><td><code>$time_matrix_OC</code></td>
<td>
<p>The time matrix for OC data.</p>
</td></tr>
<tr><td><code>$nobs_OC</code></td>
<td>
<p>Number of observations for each OC process.</p>
</td></tr>
<tr><td><code>$starttime_OC</code></td>
<td>
<p>Start time of monitoring for OC processes.</p>
</td></tr>
<tr><td><code>$survtime_OC</code></td>
<td>
<p>End time of monitoring for OC processes.</p>
</td></tr>
<tr><td><code>$survevent_OC</code></td>
<td>
<p>Survival events of OC processes.</p>
</td></tr>
<tr><td><code>$design_interval</code></td>
<td>
<p>The design interval.</p>
</td></tr>
<tr><td><code>$n_time_units</code></td>
<td>
<p>Number of time units in the design interval.</p>
</td></tr>
<tr><td><code>$time_unit</code></td>
<td>
<p>The time unit.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_example_long_surv)
</code></pre>

<hr>
<h2 id='data_stroke'>A real data example on stroke</h2><span id='topic+data_stroke'></span>

<h3>Description</h3>

<p>In this dataset, there are 27 subjects with stroke and 1028 subjects without stroke. 
Three risk factors, systolic blood pressures, diastolic blood pressures, cholesterol levels, 
are collected over time at different ages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data_stroke)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 8.
</p>


<h3>Details</h3>

<p>Real Data Example: Stroke Data
</p>


<h3>Value</h3>

<p>A list of the following components
</p>
<table>
<tr><td><code>$systolic_ctrl</code></td>
<td>
<p>A matrix of systolic blood pressures for controls. The [i,j] element is the jth observation of the ith control.</p>
</td></tr>
<tr><td><code>$diastolic_ctrl</code></td>
<td>
<p>A matrix of diastolic blood pressures for controls. The [i,j] element is the jth observation of the ith control.</p>
</td></tr>
<tr><td><code>$cholesterol_ctrl</code></td>
<td>
<p>A matrix of cholesterol levels for controls. The [i,j] element is the jth observation of the ith control.</p>
</td></tr>
<tr><td><code>$age_ctrl</code></td>
<td>
<p>A matrix of the age of observations for controls. The [i,j] element is the age of jth observation for the ith control.</p>
</td></tr>
<tr><td><code>$systolic_case</code></td>
<td>
<p>A matrix of systolic blood pressures for cases. The [i,j] element is the jth observation of the ith case.</p>
</td></tr>
<tr><td><code>$diastolic_case</code></td>
<td>
<p>A matrix of diastolic blood pressures for cases. The [i,j] element is the jth observation of the ith case.</p>
</td></tr>
<tr><td><code>$cholesterol_case</code></td>
<td>
<p>A matrix of cholesterol levels for cases. The [i,j] element is the jth observation of the ith case.</p>
</td></tr>
<tr><td><code>$age_case</code></td>
<td>
<p>A matrix of the age of observations for cases. The [i,j] element is the age of jth observation for the ith case.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(data_stroke)
</code></pre>

<hr>
<h2 id='estimate_pattern_long_1d'>Estimate the Regular Longitudinal Pattern of Univariate Data</h2><span id='topic+estimate_pattern_long_1d'></span>

<h3>Description</h3>

<p>Function <code>estimate_pattern_long_1d</code> estimate the regular longitudinal pattern 
of a univariate variable from a dataset of n subjects. This is usually the first step of dynamic screening.
The pattern can be described by mean, variance, covariance, and distribution depending on the estimation method. 
When the estimated pattern is used for monitoring new subjects, the collected data from new subjects are 
compared to the estimated pattern for monitoring abnormality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_pattern_long_1d(
  data_matrix,
  time_matrix,
  nobs,
  design_interval,
  n_time_units,
  time_unit,
  estimation_method,
  smoothing_method = "local linear",
  bw_mean,
  bw_var,
  bw_cov,
  bw_t,
  bw_y
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_pattern_long_1d_+3A_data_matrix">data_matrix</code></td>
<td>
<p>observed data arranged in a numeric matrix format. <br />
<code>data_matrix[i,j]</code> is the jth observation of the kth dimension of the ith subject.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_time_matrix">time_matrix</code></td>
<td>
<p>observation times arranged in a numeric matrix format. <br />
<code>time_matrix[i,j]</code> is the jth observation time of the ith subject. <br />
<code>data_matrix[i,j]</code> is observed at <code>time_matrix[i,j]</code>.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_nobs">nobs</code></td>
<td>
<p>number of observations arranged as an integer vector. <br />
<code>nobs[i]</code> is the number of observations for the ith subject.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_design_interval">design_interval</code></td>
<td>
<p>a numeric vector of length two that 
gives the left- and right- limits of the design interval. 
By default, <code>design_interval=range(time_matrix,na.rm=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_n_time_units">n_time_units</code></td>
<td>
<p>an integer value that gives the number of basic time units
in the design time interval. <br />
The design interval will be discretized to <br />
<code>seq(design_interval[1],design_interval[2],length.out=n_time_units)</code></p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_time_unit">time_unit</code></td>
<td>
<p>an optional numeric value of basic time unit. Only used when <code>n_time_units</code> is missing.<br />
The design interval will be discretized to <br />
<code>seq(design_interval[1],design_interval[2],by=time_unit)</code></p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_estimation_method">estimation_method</code></td>
<td>
<p>a character specifying the estimation method. <br />
If <code>estimation_method="meanvar"</code>, the function will estimate 
the mean and variance functions using local smoothing
(c.f., Qiu and Xiang, 2014). 
Parameters <code>bw_mean</code> and <code>bw_var</code> are required. <br />
If <code>estimation_method="meanvarcov"</code>, the function will estimate 
the mean, variance and covariance functions using local smoothing 
(c.f., Li and Qiu, 2016). 
Parameters <code>bw_mean</code>, <code>bw_var</code> and <code>bw_cov</code> are required. <br />
If <code>estimation_method="meanvarcovmean"</code>, the function will estimate
the mean, variance and covariance functions (c.f., Li and Qiu, 2016).
In the last step, the mean function will be updated using the
covariance function. 
Parameters <code>bw_mean</code>, <code>bw_var</code> and <code>bw_cov</code> are required. <br />
If <code>estimation_method="distribution"</code>, the function will estimate the 
distribution function (c.f., You and Qiu, 2020).
Parameters <code>bw_t</code> and <code>bw_y</code> are required. <br />
If <code>estimation_method="distributionvarcov"</code>, the function will estimate the 
distribution function and the covariance function of standardized values
(c.f., You and Qiu 2020).
Parameters <code>bw_cov</code>, <code>bw_t</code> and <code>bw_y</code> are required.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_smoothing_method">smoothing_method</code></td>
<td>
<p>a character value specifying the smoothing method. <br />
If <code>smoothing_method="local constant"</code>, apply local constant approximation. <br />
If <code>smoothing_method="local linear"</code>, apply local linear approximation.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_bw_mean">bw_mean</code></td>
<td>
<p>a numeric value. <br />
The bandwidth parameter for estimating mean function.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_bw_var">bw_var</code></td>
<td>
<p>a numeric value. <br />
The bandwidth parameter for estimating variance function.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_bw_cov">bw_cov</code></td>
<td>
<p>a numeric value. <br />
The bandwidth parameter for estimating covariance function.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_bw_t">bw_t</code></td>
<td>
<p>a numeric value. <br />
The bandwidth parameter in time axis for estimating distribution function.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_1d_+3A_bw_y">bw_y</code></td>
<td>
<p>a numeric value. <br />
The bandwidth parameter in y-axis for estimating distribution function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimate the Regular Longitudinal Pattern of Univariate Data
</p>


<h3>Value</h3>

<p>a list that stores the estimated longitudinal pattern and model parameters. <br />
If <code>estimation_method="meanvar"</code>, returns a list of class <code>pattern_long_1d_meanvar</code> <br />
If <code>estimation_method="meanvarcov"</code> or <code>"meanvarcovmean"</code>, returns a list of class <code>pattern_long_1d_meanvarcov</code> <br />
If <code>estimation_method="distribution"</code>, returns a list of class <code>pattern_long_1d_distribution</code> <br />
If <code>estimation_method="distributionvarcov"</code>, returns a list of class <code>pattern_long_1d_distributionvarcov</code> <br />
</p>
<table>
<tr><td><code>$grid</code></td>
<td>
<p>Discretized design interval.</p>
</td></tr>
<tr><td><code>$mean_est</code></td>
<td>
<p>Estimated mean function.</p>
</td></tr>
<tr><td><code>$var_est</code></td>
<td>
<p>Estimated variance function.</p>
</td></tr>
<tr><td><code>$cov_est</code></td>
<td>
<p>Estimated covariance function.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Qiu, P. and Xiang, D. (2014). Univariate dynamic screening system: an approach for identifying individuals with irregular longitudinal behavior. Technometrics, 56:248-260. <br />
Li, J. and Qiu, P. (2016). Nonparametric dynamic screening system for monitoring correlated longitudinal data. IIE Transactions, 48(8):772-786. <br />
You, L. and Qiu, P. (2019). Fast computing for dynamic screening systems when analyzing correlated data. Journal of Statistical Computation and Simulation, 89(3):379-394. <br />
You, L., Qiu, A., Huang, B., and Qiu, P. (2020). Early detection of severe juvenile idiopathic arthritis by sequential monitoring of patients' health-related quality of life scores. Biometrical Journal, 62(5). <br />
You, L. and Qiu, P. (2021). A robust dynamic screening system by estimation of the longitudinal data distribution. Journal of Quality Technology, 53(4).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("data_example_long_1d")

result_pattern&lt;-estimate_pattern_long_1d(
  data_matrix=data_example_long_1d$data_matrix_IC,
  time_matrix=data_example_long_1d$time_matrix_IC,
  nobs=data_example_long_1d$nobs_IC,
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  estimation_method="meanvar",
  smoothing_method="local linear",
  bw_mean=0.1,
  bw_var=0.1)
</code></pre>

<hr>
<h2 id='estimate_pattern_long_md'>Estimate the Regular Longitudinal Pattern of Multivariate Data</h2><span id='topic+estimate_pattern_long_md'></span>

<h3>Description</h3>

<p>Function <code>estimate_pattern_long_md</code> estimate the regular longitudinal pattern 
of multivariate processes from a dataset of n subjects. This is usually the first step of dynamic screening.
The pattern can be described by mean, variance, covariance, and distribution depending on the estimation method. 
When the estimated pattern is used for monitoring new subjects, the collected data from new subjects are 
compared to the estimated pattern for monitoring abnormality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_pattern_long_md(
  data_array,
  time_matrix,
  nobs,
  design_interval,
  n_time_units,
  time_unit,
  estimation_method,
  bw_mean,
  bw_var,
  bw_cov
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_pattern_long_md_+3A_data_array">data_array</code></td>
<td>
<p>observed data arranged in a 3d array format. <br />
<code>data_array[i,j,k]</code> is the jth observation of the kth dimension of the ith subject.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_md_+3A_time_matrix">time_matrix</code></td>
<td>
<p>observation times arranged in a numeric matrix format. <br />
<code>time_matrix[i,j]</code> is the jth observation time of the ith subject. <br />
<code>data_array[i,j,]</code> is observed at <code>time_matrix[i,j]</code>.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_md_+3A_nobs">nobs</code></td>
<td>
<p>number of observations arranged as an integer vector. <br />
<code>nobs[i]</code> is the number of observations for the ith subject.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_md_+3A_design_interval">design_interval</code></td>
<td>
<p>a numeric vector of length two that 
gives the left- and right- limits of the design interval. 
By default, <code>design_interval=range(time_matrix,na.rm=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_md_+3A_n_time_units">n_time_units</code></td>
<td>
<p>an integer value that gives the number of basic time units
in the design time interval. <br />
The design interval will be discretized to <br />
<code>seq(design_interval[1],design_interval[2],length.out=n_time_units)</code></p>
</td></tr>
<tr><td><code id="estimate_pattern_long_md_+3A_time_unit">time_unit</code></td>
<td>
<p>an optional numeric value of basic time unit. Only used when <code>n_time_units</code> is missing.<br />
The design interval will be discretized to <br />
<code>seq(design_interval[1],design_interval[2],by=time_unit)</code></p>
</td></tr>
<tr><td><code id="estimate_pattern_long_md_+3A_estimation_method">estimation_method</code></td>
<td>
<p>a string. <br />
If <code>estimation_method="meanvar"</code>, the function will estimate the 
mean function (<code class="reqn">\mathrm{E}[\mathbf{y}(t)]</code>), and 
variance function (<code class="reqn">\mathrm{Var}(\mathbf{y}(t))</code>). 
Parameters <code>bw_mean_int</code> and <code>bw_var_int</code> are needed. <br />
If <code>estimation_method="meanvarcov"</code>, the function will estimate the 
mean function (<code class="reqn">\mathrm{E}[\mathbf{y}(t)]</code>), 
variance function (<code class="reqn">\mathrm{Var}(\mathbf{y}(t))</code>), and 
covariance function (<code class="reqn">\mathrm{Cov}(\mathbf{y}(s),\mathbf{y}(t))</code>). 
Parameters <code>bw_mean_int</code>, <code>bw_var_int</code> and <code>bw_cov_int</code>.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_md_+3A_bw_mean">bw_mean</code></td>
<td>
<p>a numeric value. <br />
The bandwidth parameter for estimating mean function.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_md_+3A_bw_var">bw_var</code></td>
<td>
<p>a numeric value. <br />
The bandwidth parameter for estimating variance function.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_md_+3A_bw_cov">bw_cov</code></td>
<td>
<p>a numeric value. <br />
The bandwidth parameter for estimating covariance function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimate the Regular Longitudinal Pattern of Multivariate Data
</p>


<h3>Value</h3>

<p>an object that stores the estimated longitudinal pattern and model parameters. <br />
If <code>estimation_method="meanvar"</code>, returns an object of class <code>pattern_long_md_meanvar</code>. <br />
If <code>estimation_method="meanvarcov"</code>, returns an object of class <code>pattern_long_md_meanvarcov</code>. <br />
</p>
<table>
<tr><td><code>$grid</code></td>
<td>
<p>Discretized design interval.</p>
</td></tr>
<tr><td><code>$mean_est</code></td>
<td>
<p>Estimated mean function.</p>
</td></tr>
<tr><td><code>$var_est</code></td>
<td>
<p>Estimated variance function.</p>
</td></tr>
<tr><td><code>$cov_est</code></td>
<td>
<p>Estimated covariance function.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Qiu, P. and Xiang, D. (2015). Surveillance of cardiovascular diseases using a multivariate dynamic screening system. Statistics in Medicine, 34:2204-2221. <br />
Li, J. and Qiu, P. (2017). Construction of an efficient multivariate dynamic screening system. Quality and Reliability Engineering International, 33(8):1969-1981. <br />
You, L., Qiu, A., Huang, B., and Qiu, P. (2020). Early detection of severe juvenile idiopathic arthritis by sequential monitoring of patients' health-related quality of life scores. Biometrical Journal, 62(5).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("data_example_long_md")

result_pattern&lt;-estimate_pattern_long_md(
  data_array=data_example_long_md$data_array_IC,
  time_matrix=data_example_long_md$time_matrix_IC,
  nobs=data_example_long_md$nobs_IC,
  design_interval=data_example_long_md$design_interval,
  n_time_units=data_example_long_md$n_time_units,
  estimation_method="meanvar",
  bw_mean=0.1,
  bw_var=0.1)
</code></pre>

<hr>
<h2 id='estimate_pattern_long_surv'>Estimate the Pattern of Longitudinal and Survival Data</h2><span id='topic+estimate_pattern_long_surv'></span>

<h3>Description</h3>

<p>Function <code>estimate_pattern_long_surv</code> estimate the pattern of longitudinal and survival 
data from a dataset of n subjects. This is usually the first step of dynamic screening.
The risk of a subject to event is quantified by a linear combination of longitudinal data by a Cox model.
The risk pattern can be described by mean and variance depending on the estimation method. 
When the estimated pattern is used for monitoring new subjects, the collected data from new subjects are 
compared to the estimated pattern for monitoring abnormality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_pattern_long_surv(
  data_array,
  time_matrix,
  nobs,
  starttime,
  survtime,
  survevent,
  design_interval,
  n_time_units,
  time_unit,
  estimation_method = "risk",
  smoothing_method = "local linear",
  bw_beta,
  bw_mean,
  bw_var
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_pattern_long_surv_+3A_data_array">data_array</code></td>
<td>
<p>observed data arranged in a 3d array format. <br />
<code>data_array[i,j,k]</code> is the jth observation of the kth dimension of the ith subject.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_time_matrix">time_matrix</code></td>
<td>
<p>observation times arranged in a numeric matrix format. <br />
<code>time_matrix[i,j]</code> is the jth observation time of the ith subject. <br />
<code>data_array[i,j,]</code> is observed at <code>time_matrix[i,j]</code>.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_nobs">nobs</code></td>
<td>
<p>number of observations arranged as an integer vector. <br />
<code>nobs[i]</code> is the number of observations for the ith subject.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_starttime">starttime</code></td>
<td>
<p>a vector of entry times <br />
<code>starttime[i]</code> is the entry time of the ith subject.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_survtime">survtime</code></td>
<td>
<p>a vector of survival times <br />
<code>survtime[i]</code> is the survival time of the ith subject.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_survevent">survevent</code></td>
<td>
<p>a logical vector of survival events <br />
If <code>survevents[i]==TRUE</code>, then a survival event is observed at <code>survtime[i]</code>. <br />
If <code>survevents[i]==FALSE</code>, then no survival event is observed at <code>survtime[i]</code>.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_design_interval">design_interval</code></td>
<td>
<p>a numeric vector of length two that 
gives the left- and right- limits of the design interval. 
By default, <code>design_interval=range(time_matrix,na.rm=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_n_time_units">n_time_units</code></td>
<td>
<p>an integer value that gives the number of basic time units
in the design time interval. <br />
The design interval will be discretized to <code>seq(design_interval[1],design_interval[2],length.out=n_time_units)</code></p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_time_unit">time_unit</code></td>
<td>
<p>an optional numeric value of basic time unit. Only used when <code>n_time_units</code> is missing.<br />
The design interval will be discretized to <code>seq(design_interval[1],design_interval[2],by=time_unit)</code></p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_estimation_method">estimation_method</code></td>
<td>
<p>a string. <br />
If <code>estimation_method="risk"</code>, apply the risk monitoring method (c.f., You and Qiu 2020). <br />
(Currently only the method &quot;risk&quot; is available.)</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_smoothing_method">smoothing_method</code></td>
<td>
<p>a string. <br />
If <code>smoothing_method="local constant"</code>, apply local constant smoothing <br />
If <code>smoothing_method="local linear"</code>, apply local linear smoothing <br /></p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_bw_beta">bw_beta</code></td>
<td>
<p>an integer value. <br />
The bandwidth parameter for estimating the regression coefficients beta in the Cox model.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_bw_mean">bw_mean</code></td>
<td>
<p>an integer value. <br />
The bandwidth parameter for estimating mean function.</p>
</td></tr>
<tr><td><code id="estimate_pattern_long_surv_+3A_bw_var">bw_var</code></td>
<td>
<p>an integer value. <br />
The bandwidth parameter for estimating variance function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimate the Pattern of Longitudinal and Survival Data
</p>


<h3>Value</h3>

<p>an object that stores the estimated longitudinal pattern and model parameters. <br />
If <code>estimation_method="risk"</code>, returns an object of class <code>pattern_long_surv_risk</code>. <br />
</p>
<table>
<tr><td><code>$grid</code></td>
<td>
<p>discretized design interval.</p>
</td></tr>
<tr><td><code>$beta_est</code></td>
<td>
<p>Estimated regression coefficients.</p>
</td></tr>
<tr><td><code>$mean_risk_est</code></td>
<td>
<p>Estimated mean function.</p>
</td></tr>
<tr><td><code>$var_risk_est</code></td>
<td>
<p>Estimated variance function.</p>
</td></tr>
</table>


<h3>References</h3>

<p>You, L. and Qiu, P. (2020). An effective method for online disease risk monitoring. Technometrics, 62(2):249-264.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("data_example_long_surv")

result_pattern&lt;-estimate_pattern_long_surv(
  data_array=data_example_long_surv$data_array_IC,
  time_matrix=data_example_long_surv$time_matrix_IC,
  nobs=data_example_long_surv$nobs_IC,
  starttime=data_example_long_surv$starttime_IC,
  survtime=data_example_long_surv$survtime_IC,
  survevent=data_example_long_surv$survevent_IC,
  design_interval=data_example_long_surv$design_interval,
  n_time_units=data_example_long_surv$n_time_units,
  estimation_method="risk",
  smoothing_method="local linear",
  bw_beta=0.05,
  bw_mean=0.1,
  bw_var=0.1)
</code></pre>

<hr>
<h2 id='evaluate_control_chart_one_group'>Evaluate Control Charts (in a single dataset)</h2><span id='topic+evaluate_control_chart_one_group'></span>

<h3>Description</h3>

<p>The function <code>evaluate_control_chart_one_group</code> evaluates a control chart when
the in-control (IC) and out-of-control (OC) charting statistics are supplied together in one matrix <code>chart_matrix</code>.
The logical vector <code>status</code> indicates if the ith subject is IC or OC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_control_chart_one_group(
  chart_matrix,
  time_matrix,
  nobs,
  starttime,
  endtime,
  status,
  design_interval,
  n_time_units,
  time_unit,
  no_signal_action = "omit"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_control_chart_one_group_+3A_chart_matrix">chart_matrix</code></td>
<td>
<p>charting statistics arranged as a numeric matrix. <br />
<code>chart_matrix[i,j]</code> is the jth charting statistic of the ith subject.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_one_group_+3A_time_matrix">time_matrix</code></td>
<td>
<p>observation times arranged as a numeric matrix. <br />
<code>time_matrix[i,j]</code> is the jth observation time of the ith subject. <br />
<code>chart_matrix[i,j]</code> is the charting statistic of the ith subject at <code>time_matrix[i,j]</code>.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_one_group_+3A_nobs">nobs</code></td>
<td>
<p>number of observations arranged as an integer vector. <br />
<code>nobs[i]</code> is the number of observations for the ith subject.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_one_group_+3A_starttime">starttime</code></td>
<td>
<p>a numeric vector.
<code>starttime[i]</code> is the time when monitoring starts for ith subject.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_one_group_+3A_endtime">endtime</code></td>
<td>
<p>a numeric vector, times when monitoring end.
<code>endtime[i]</code> is the time when monitoring ends for ith subject.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_one_group_+3A_status">status</code></td>
<td>
<p>a logical vector.
<code>status[i]=FALSE</code> if the ith subject is IC, while <code>status[i]=TRUE</code> indicates the the ith subject is OC.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_one_group_+3A_design_interval">design_interval</code></td>
<td>
<p>a numeric vector of length two that 
gives the left- and right- limits of the design interval. 
By default, <code>design_interval=range(time_matrix,na.rm=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_one_group_+3A_n_time_units">n_time_units</code></td>
<td>
<p>an integer value that gives the number of basic time units
in the design time interval. <br />
The design interval will be discretized to <code>seq(design_interval[1],design_interval[2],length.out=n_time_units)</code></p>
</td></tr>
<tr><td><code id="evaluate_control_chart_one_group_+3A_time_unit">time_unit</code></td>
<td>
<p>an optional numeric value of basic time unit. Only used when <code>n_time_units</code> is missing.<br />
The design interval will be discretized to <code>seq(design_interval[1],design_interval[2],by=time_unit)</code></p>
</td></tr>
<tr><td><code id="evaluate_control_chart_one_group_+3A_no_signal_action">no_signal_action</code></td>
<td>
<p>a character value specifying how to set signal times when processes with no signals.<br />
If <code>no_signal_action=="omit"</code>, the signal time is set to be missing.<br />
If <code>no_signal_action=="maxtime"</code>, the signal time is set to be the time from start time to the end of the design interval.<br />
If <code>no_signal_action=="endtime"</code>, the signal time is set to be the time from start time to the end time.<br /></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Evaluate Control Charts
</p>


<h3>Value</h3>

<p>an list that stores the evaluation measures. <br />
</p>
<table>
<tr><td><code>$thres</code></td>
<td>
<p>A numeric vector. Threshold values for control limits.</p>
</td></tr>
<tr><td><code>$FPR</code></td>
<td>
<p>A numeric vector. False positive rates.</p>
</td></tr>
<tr><td><code>$TPR</code></td>
<td>
<p>A numeric vector. True positive rates.</p>
</td></tr>
<tr><td><code>$ATS0</code></td>
<td>
<p>A numeric vector. In-control ATS.</p>
</td></tr>
<tr><td><code>$ATS1</code></td>
<td>
<p>A numeric vector. Out-of-control ATS.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Qiu, P. and Xiang, D. (2014). Univariate dynamic screening system: an approach for identifying individuals with irregular longitudinal behavior. Technometrics, 56:248-260. <br />
Qiu, P., Xia, Z., and You, L. (2020). Process monitoring ROC curve for evaluating dynamic screening methods. Technometrics, 62(2).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result_pattern&lt;-estimate_pattern_long_surv(
  data_array=data_example_long_surv$data_array_IC,
  time_matrix=data_example_long_surv$time_matrix_IC,
  nobs=data_example_long_surv$nobs_IC,
  starttime=data_example_long_surv$starttime_IC,
  survtime=data_example_long_surv$survtime_IC,
  survevent=data_example_long_surv$survevent_IC,
  design_interval=data_example_long_surv$design_interval,
  n_time_units=data_example_long_surv$n_time_units,
  estimation_method="risk",
  smoothing_method="local linear",
  bw_beta=0.05,
  bw_mean=0.1,
  bw_var=0.1)

result_monitoring&lt;-monitor_long_surv(
  data_array_new=data_example_long_surv$data_array_IC,
  time_matrix_new=data_example_long_surv$time_matrix_IC,
  nobs_new=data_example_long_surv$nobs_IC,
  pattern=result_pattern,
  method="risk",
  parameter=0.5)

output_evaluate&lt;-evaluate_control_chart_one_group(
  chart_matrix=result_monitoring$chart[1:200,],
  time_matrix=data_example_long_surv$time_matrix_IC[1:200,],
  nobs=data_example_long_surv$nobs_IC[1:200],
  starttime=rep(0,200),
  endtime=rep(1,200),
  status=data_example_long_surv$survevent_IC[1:200],
  design_interval=data_example_long_surv$design_interval,
  n_time_units=data_example_long_surv$n_time_units,
  no_signal_action="maxtime")

</code></pre>

<hr>
<h2 id='evaluate_control_chart_two_groups'>Evaluate Control Charts</h2><span id='topic+evaluate_control_chart_two_groups'></span>

<h3>Description</h3>

<p>The function <code>evaluate_control_chart_two_groups</code> evaluates control charts when
the in-control (IC) and out-of-control (OC) charting statistics are supplied separately in two matrices 
<code>chart_matrix_IC</code> and <code>chart_matrix_OC</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate_control_chart_two_groups(
  chart_matrix_IC,
  time_matrix_IC,
  nobs_IC,
  starttime_IC,
  endtime_IC,
  chart_matrix_OC,
  time_matrix_OC,
  nobs_OC,
  starttime_OC,
  endtime_OC,
  design_interval,
  n_time_units,
  time_unit,
  no_signal_action = "omit"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluate_control_chart_two_groups_+3A_chart_matrix_ic">chart_matrix_IC</code>, <code id="evaluate_control_chart_two_groups_+3A_chart_matrix_oc">chart_matrix_OC</code></td>
<td>
<p>charting statistics arranged as a numeric matrix. <br />
<code>chart_matrix_IC[i,j]</code> is the jth charting statistic of the ith IC subject. <br />
<code>chart_matrix_OC[i,j]</code> is the jth charting statistic of the ith OC subject.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_two_groups_+3A_time_matrix_ic">time_matrix_IC</code>, <code id="evaluate_control_chart_two_groups_+3A_time_matrix_oc">time_matrix_OC</code></td>
<td>
<p>observation times arranged as a numeric matrix. <br />
<code>time_matrix_IC[i,j]</code> is the jth observation time of the ith IC subject. <br />
<code>time_matrix_OC[i,j]</code> is the jth observation time of the ith OC subject. <br />
<code>chart_matrix_IC[i,j]</code> is the charting statistic of the ith IC subject at <code>time_matrix[i,j]</code>. <br />
<code>chart_matrix_OC[i,j]</code> is the charting statistic of the ith OC subject at <code>time_matrix[i,j]</code>.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_two_groups_+3A_nobs_ic">nobs_IC</code>, <code id="evaluate_control_chart_two_groups_+3A_nobs_oc">nobs_OC</code></td>
<td>
<p>number of observations arranged as an integer vector. <br />
<code>nobs_IC[i]</code> is the number of observations for the ith subject. <br />
<code>nobs_OC[i]</code> is the number of observations for the ith subject.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_two_groups_+3A_starttime_ic">starttime_IC</code>, <code id="evaluate_control_chart_two_groups_+3A_starttime_oc">starttime_OC</code></td>
<td>
<p>a numeric vector that gives the start times. <br />
<code>starttime_IC[i]</code> is the time that the ith IC subject starts to be monitored. <br />
<code>starttime_OC[i]</code> is the time that the ith OC subject starts to be monitored.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_two_groups_+3A_endtime_ic">endtime_IC</code>, <code id="evaluate_control_chart_two_groups_+3A_endtime_oc">endtime_OC</code></td>
<td>
<p>a numeric vector that gives the end times. <br />
<code>endtime_IC[i]</code> is the time that the ith IC subject is lost to be monitored. <br />
<code>endtime_OC[i]</code> is the time that the ith OC subject is lost to be monitored.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_two_groups_+3A_design_interval">design_interval</code></td>
<td>
<p>a numeric vector of length two that 
gives the left- and right- limits of the design interval. 
By default, <code>design_interval=range(time_matrix,na.rm=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="evaluate_control_chart_two_groups_+3A_n_time_units">n_time_units</code></td>
<td>
<p>an integer value that gives the number of basic time units
in the design time interval. <br />
The design interval will be discretized to <code>seq(design_interval[1],design_interval[2],length.out=n_time_units)</code></p>
</td></tr>
<tr><td><code id="evaluate_control_chart_two_groups_+3A_time_unit">time_unit</code></td>
<td>
<p>an optional numeric value of basic time unit. Only used when <code>n_time_units</code> is missing.<br />
The design interval will be discretized to <code>seq(design_interval[1],design_interval[2],by=time_unit)</code></p>
</td></tr>
<tr><td><code id="evaluate_control_chart_two_groups_+3A_no_signal_action">no_signal_action</code></td>
<td>
<p>a character value specifying how to set signal times when processes with no signals.<br />
If <code>no_signal_action=="omit"</code>, the signal time is set to be missing.<br />
If <code>no_signal_action=="maxtime"</code>, the signal time is set to be the time from start time to the end of the design interval.<br />
If <code>no_signal_action=="endtime"</code>, the signal time is set to be the time from start time to the end time.<br /></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Evaluate Control Charts
</p>


<h3>Value</h3>

<p>an list that stores the evaluation measures. <br />
</p>
<table>
<tr><td><code>$thres</code></td>
<td>
<p>A numeric vector. Threshold values for control limits.</p>
</td></tr>
<tr><td><code>$FPR</code></td>
<td>
<p>A numeric vector. False positive rates.</p>
</td></tr>
<tr><td><code>$TPR</code></td>
<td>
<p>A numeric vector. True positive rates.</p>
</td></tr>
<tr><td><code>$ATS0</code></td>
<td>
<p>A numeric vector. In-control ATS.</p>
</td></tr>
<tr><td><code>$ATS1</code></td>
<td>
<p>A numeric vector. Out-of-control ATS.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Qiu, P. and Xiang, D. (2014). Univariate dynamic screening system: an approach for identifying individuals with irregular longitudinal behavior. Technometrics, 56:248-260. <br />
Qiu, P., Xia, Z., and You, L. (2020). Process monitoring ROC curve for evaluating dynamic screening methods. Technometrics, 62(2).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pattern&lt;-estimate_pattern_long_1d(
  data_matrix=data_example_long_1d$data_matrix_IC,
  time_matrix=data_example_long_1d$time_matrix_IC,
  nobs=data_example_long_1d$nobs_IC,
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  estimation_method="meanvar",
  smoothing_method="local linear",
  bw_mean=0.1,
  bw_var=0.1)

chart_IC_output&lt;-monitor_long_1d(
  data_example_long_1d$data_matrix_IC,
  data_example_long_1d$time_matrix_IC,
  data_example_long_1d$nobs_IC,
  pattern=pattern,side="upward",chart="CUSUM",
  method="standard",parameter=0.2)

chart_OC_output&lt;-monitor_long_1d(
  data_example_long_1d$data_matrix_OC,
  data_example_long_1d$time_matrix_OC,
  data_example_long_1d$nobs_OC,
  pattern=pattern,side="upward",chart="CUSUM",
  method="standard",parameter=0.2)

output_evaluate&lt;-evaluate_control_chart_two_groups(
  chart_matrix_IC=chart_IC_output$chart[1:50,],
  time_matrix_IC=data_example_long_1d$time_matrix_IC[1:50,],
  nobs_IC=data_example_long_1d$nobs_IC[1:50],
  starttime_IC=rep(0,50),
  endtime_IC=rep(1,50),
  chart_matrix_OC=chart_OC_output$chart[1:50,],
  time_matrix_OC=data_example_long_1d$time_matrix_OC[1:50,],
  nobs_OC=data_example_long_1d$nobs_OC[1:50],
  starttime_OC=rep(0,50),
  endtime_OC=rep(1,50),
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  no_signal_action="maxtime")

</code></pre>

<hr>
<h2 id='monitor_long_1d'>Monitor Univariate Longitudinal Data</h2><span id='topic+monitor_long_1d'></span>

<h3>Description</h3>

<p>Monitor Univariate Longitudinal Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_long_1d(
  data_matrix_new,
  time_matrix_new,
  nobs_new,
  pattern,
  side = "upward",
  chart = "CUSUM",
  method = "standard",
  parameter = 0.5,
  CL = Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_long_1d_+3A_data_matrix_new">data_matrix_new</code></td>
<td>
<p>observed data arranged in a numeric matrix format. <br />
<code>data_matrix_new[i,j]</code> is the jth observation of the ith subject.</p>
</td></tr>
<tr><td><code id="monitor_long_1d_+3A_time_matrix_new">time_matrix_new</code></td>
<td>
<p>observation times arranged in a numeric matrix format. <br />
<code>time_matrix_new[i,j]</code> is the jth observation time of the ith subject. <br />
<code>data_matrix_new[i,j]</code> is observed at <code>time_matrix_new[i,j]</code>.</p>
</td></tr>
<tr><td><code id="monitor_long_1d_+3A_nobs_new">nobs_new</code></td>
<td>
<p>number of observations arranged as an integer vector. <br />
<code>nobs_new[i]</code> is the number of observations for the ith subject.</p>
</td></tr>
<tr><td><code id="monitor_long_1d_+3A_pattern">pattern</code></td>
<td>
<p>the estimated regular longitudinal pattern</p>
</td></tr>
<tr><td><code id="monitor_long_1d_+3A_side">side</code></td>
<td>
<p>a character value specifying the sideness/direction of process monitoring<br />
If <code>side="upward"</code>apply control charts that aim to detect upward shifts. <br />
If <code>side="downward"</code>apply control charts that aim to detect downward shifts. <br />
If <code>side="both"</code>apply control charts that aim to detect shifts in both sides</p>
</td></tr>
<tr><td><code id="monitor_long_1d_+3A_chart">chart</code></td>
<td>
<p>a string specifying the control charts to use.
If <code>chart="CUSUM"</code>apply CUSUM charts. <br />
If <code>chart="EWMA"</code>apply EWMA charts.</p>
</td></tr>
<tr><td><code id="monitor_long_1d_+3A_method">method</code></td>
<td>
<p>a string <br />
If <code>method="standard"</code>, standardize observations by mean and variance (cf., Qiu and Xiang, 2014).<br />
If <code>method="decorrelation"</code>, standardize and decorrelate observations by mean and covariance (cf., Li and Qiu, 2016).<br />
If <code>method="sprint"</code>, standardize and decorrelate observations within sprint length by mean and covariance (cf., You and Qiu 2018).<br />
If <code>method="distribution and standard"</code>, standardize observations by distribution (cf., You and Qiu, 2020).<br />
If <code>method="distribution and decorrelation"</code>, standardize observations by distribution and covariance (cf., You and Qiu, 2020).<br />
If <code>method="distribution and sprint"</code>,standardize and decorrelate observations within sprint length by distribution and covariance (cf., You and Qiu, 2020).<br />
<code>method="nonparametric and standard"</code> currently not supported.<br />
<code>method="nonparametric and decorrelation"</code> currently not supported</p>
</td></tr>
<tr><td><code id="monitor_long_1d_+3A_parameter">parameter</code></td>
<td>
<p>a numeric value <br />
If <code>chart="CUSUM"</code>, <code>parameter</code> is the allowance constant in the control chart.<br />
If <code>chart="EWMA"</code>, <code>parameter</code> is the weighting in the control chart.</p>
</td></tr>
<tr><td><code id="monitor_long_1d_+3A_cl">CL</code></td>
<td>
<p>a numeric value speficying the control limit. <br />
A signal will be given if charting statistics are larger than the control limit. 
(Note: in this package, signs of charting statistics may be reversed such that 
larger values of charting statistics indicate worse performance of processes.)
After the signal is given, the algorithm stops calculating the charting statistics for the remaining observation times.
The default value of control limit is infinity, which means we will calculate the charting statistics for all observation times.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list that stores the result.<br />
</p>
<table>
<tr><td><code>$chart</code></td>
<td>
<p>a numeric matrix, <code>$chart[i,j]</code> is the jth charting statistic of the ith subject.</p>
</td></tr>
<tr><td><code>$standardized_values</code></td>
<td>
<p>a numeric matrix, <code>$standardized_values[i,j]</code> is the standardized value of the jth observation of the ith subject.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Qiu, P. and Xiang, D. (2014). Univariate dynamic screening system: an approach for identifying individuals with irregular longitudinal behavior. Technometrics, 56:248-260. <br />
Li, J. and Qiu, P. (2016). Nonparametric dynamic screening system for monitoring correlated longitudinal data. IIE Transactions, 48(8):772-786. <br />
You, L. and Qiu, P. (2019). Fast computing for dynamic screening systems when analyzing correlated data. Journal of Statistical Computation and Simulation, 89(3):379-394. <br />
You, L., Qiu, A., Huang, B., and Qiu, P. (2020). Early detection of severe juvenile idiopathic arthritis by sequential monitoring of patients' health-related quality of life scores. Biometrical Journal, 62(5). <br />
You, L. and Qiu, P. (2021). A robust dynamic screening system by estimation of the longitudinal data distribution. Journal of Quality Technology, 53(4).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("data_example_long_1d")

result_pattern&lt;-estimate_pattern_long_1d(
  data_matrix=data_example_long_1d$data_matrix_IC,
  time_matrix=data_example_long_1d$time_matrix_IC,
  nobs=data_example_long_1d$nobs_IC,
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  estimation_method="meanvar",
  smoothing_method="local linear",
  bw_mean=0.1,
  bw_var=0.1)

result_monitoring&lt;-monitor_long_1d(
  data_matrix_new=data_example_long_1d$data_matrix_OC,
  time_matrix_new=data_example_long_1d$time_matrix_OC,
  nobs_new=data_example_long_1d$nobs_OC,
  pattern=result_pattern,
  side="upward",
  chart="CUSUM",
  method="standard",
  parameter=0.5)
</code></pre>

<hr>
<h2 id='monitor_long_md'>Monitor Multivariate Longitudinal Data</h2><span id='topic+monitor_long_md'></span>

<h3>Description</h3>

<p>Monitor Multivariate Longitudinal Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_long_md(
  data_array_new,
  time_matrix_new,
  nobs_new,
  pattern,
  side = "both",
  method = "multivariate EWMA",
  parameter = 0.5,
  CL = Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_long_md_+3A_data_array_new">data_array_new</code></td>
<td>
<p>an array of longitudinal observations. <br />
<code>data_array_new[i,j,k]</code> is the jth observation of the kth dimension of the ith subject.</p>
</td></tr>
<tr><td><code id="monitor_long_md_+3A_time_matrix_new">time_matrix_new</code></td>
<td>
<p>a matrix of observation times. <br />
<code>time_matrix_new[i,j]</code> is the jth observation time of the ith subject. <br />
<code>data_array_new[i,j,]</code> is observed at <code>time_matrix[i,j]</code>.</p>
</td></tr>
<tr><td><code id="monitor_long_md_+3A_nobs_new">nobs_new</code></td>
<td>
<p>an integer vector for number of observations. <br />
<code>nobs_new[i]</code> is the number of observations for the ith subject.</p>
</td></tr>
<tr><td><code id="monitor_long_md_+3A_pattern">pattern</code></td>
<td>
<p>the estimated regular longitudinal pattern</p>
</td></tr>
<tr><td><code id="monitor_long_md_+3A_side">side</code></td>
<td>
<p>a string <br />
If <code>side="upward"</code>, control charts aim to detect upward shifts. <br />
If <code>side="downward"</code>, control charts aim to detect downward shifts. <br />
If <code>side="both"</code>, control charts aim to detect shifts in both sides.</p>
</td></tr>
<tr><td><code id="monitor_long_md_+3A_method">method</code></td>
<td>
<p>a string <br />
If <code>method="simultaneous CUSUM"</code>, 
apply simultaneous CUSUM charts. (See SIMUL in You et al, 2020.) <br />
If <code>method="simultaneous EWMA"</code>,
apply simultaneous EWMA charts. (See SIMUL in You et al, 2020.) <br />
If <code>method="multivariate CUSUM"</code>,
apply multivariate CUSUM charts. <br />
If <code>method="multivariate EWMA"</code>,
apply multivariate EWMA charts. (See Qiu and Xiang, 2015 or QX-1S/QS-2S in You et al, 2020.) <br />
If <code>method="decorrelation CUSUM"</code>,
apply decorrelation CUSUM charts. (See Li and Qiu, 2017 or LQ-1S/LQ-2S in You et al, 2020) <br />
If <code>method="decorrelation EWMA"</code>,
apply decorrelation EWMA charts. (See Li and Qiu, 2017 or LQ-1S/LQ-2S in You et al, 2020) <br />
If <code>method="nonparametric CUSUM"</code> <br />
If <code>method="nonparametric EWMA"</code> <br /></p>
</td></tr>
<tr><td><code id="monitor_long_md_+3A_parameter">parameter</code></td>
<td>
<p>a numeric value. <br />
<code>parameter</code> is the allowance constant if <code>method</code> is a CUSUM chart. <br />
<code>parameter</code> is the weighting parameter if <code>method</code> is an EWMA chart.</p>
</td></tr>
<tr><td><code id="monitor_long_md_+3A_cl">CL</code></td>
<td>
<p>a numeric value <br />
<code>CL</code> is the control limit. 
A signal will be given if charting statistics are larger than the control limit. 
(Note: in this package, signs of charting statistics may be reversed such that 
larger values of charting statistics indicate worse performance of processes.)
After the signal is given, the algorithm stops calculating the charting statistics for the remaining observation times.
The default value of control limit is infinity, which means we will calculate the charting statistics for all observation times.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list that stores the result.<br />
</p>
<table>
<tr><td><code>$chart</code></td>
<td>
<p>a numeric matrix, <code>$chart[i,j]</code> is the jth charting statistic of the ith subject calculated at time <code>time_matrix_new[i,j]</code>.</p>
</td></tr></table>
<p><br />
</p>
<table>
<tr><td><code>$SSijk</code></td>
<td>
<p>a numeric array, the multivariate statistics used in the calculation of control charts.
<code>$SSijk[i,j,]</code> is the jth multivariate statistic for the ith subject.</p>
</td></tr>
<tr><td><code>$standardized_values</code></td>
<td>
<p>a numeric array.
<code>$standardized_values[i,j,]</code> is the jth standardized vector for the ith subject.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Qiu, P. and Xiang, D. (2015). Surveillance of cardiovascular diseases using a multivariate dynamic screening system. Statistics in Medicine, 34:2204-2221. <br />
Li, J. and Qiu, P. (2017). Construction of an efficient multivariate dynamic screening system. Quality and Reliability Engineering International, 33(8):1969-1981. <br />
You, L., Qiu, A., Huang, B., and Qiu, P. (2020). Early detection of severe juvenile idiopathic arthritis by sequential monitoring of patients' health-related quality of life scores. Biometrical Journal, 62(5).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("data_example_long_md")

result_pattern&lt;-estimate_pattern_long_md(
  data_array=data_example_long_md$data_array_IC,
  time_matrix=data_example_long_md$time_matrix_IC,
  nobs=data_example_long_md$nobs_IC,
  design_interval=data_example_long_md$design_interval,
  n_time_units=data_example_long_md$n_time_units,
  estimation_method="meanvar",
  bw_mean=0.1,
  bw_var=0.1)

result_monitoring&lt;-monitor_long_md(
data_array_new=data_example_long_md$data_array_OC,
time_matrix_new=data_example_long_md$time_matrix_OC,
nobs_new=data_example_long_md$nobs_OC,
pattern=result_pattern,
side="both",
method="multivariate EWMA",
parameter=0.5)

result_ATS&lt;-calculate_ATS(
  chart_matrix=result_monitoring$chart_matrix,
  time_matrix=data_example_long_md$time_matrix_OC,
  nobs=data_example_long_md$nobs_OC,
  starttime=rep(0,nrow(data_example_long_md$time_matrix_OC)),
  endtime=rep(1,nrow(data_example_long_md$time_matrix_OC)),
  design_interval=data_example_long_md$design_interval,
  n_time_units=data_example_long_md$n_time_units,
  CL=16.0)
</code></pre>

<hr>
<h2 id='monitor_long_surv'>Monitor Longitudinal Data for Survival Outcomes</h2><span id='topic+monitor_long_surv'></span>

<h3>Description</h3>

<p>Monitor Longitudinal Data for Survival Outcomes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor_long_surv(
  data_array_new,
  time_matrix_new,
  nobs_new,
  pattern,
  method,
  parameter = 0.5,
  CL = Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_long_surv_+3A_data_array_new">data_array_new</code></td>
<td>
<p>observed data arranged in a numeric array format. <br />
<code>data_array_new[i,j,k]</code> is the jth observation of the kth dimension of the ith subject.</p>
</td></tr>
<tr><td><code id="monitor_long_surv_+3A_time_matrix_new">time_matrix_new</code></td>
<td>
<p>observation times arranged in a numeric matrix format. <br />
<code>time_matrix_new[i,j]</code> is the jth observation time of the ith subject. <br />
<code>data_array_new[i,j,]</code> is observed at <code>time_matrix[i,j]</code>.</p>
</td></tr>
<tr><td><code id="monitor_long_surv_+3A_nobs_new">nobs_new</code></td>
<td>
<p>number of observations arranged as an integer vector. <br />
<code>nobs_new[i]</code> is the number of observations for the ith subject.</p>
</td></tr>
<tr><td><code id="monitor_long_surv_+3A_pattern">pattern</code></td>
<td>
<p>the estimated longitudinal and survival pattern from <code>estimate_pattern_long_surv</code>.</p>
</td></tr>
<tr><td><code id="monitor_long_surv_+3A_method">method</code></td>
<td>
<p>a character value specifying the smoothing method<br />
If <code>method="risk"</code>, apply the risk monitoring method by You and Qiu (2020).</p>
</td></tr>
<tr><td><code id="monitor_long_surv_+3A_parameter">parameter</code></td>
<td>
<p>a numeric value. <br />
The weighting parameter in the modified EWMA charts.</p>
</td></tr>
<tr><td><code id="monitor_long_surv_+3A_cl">CL</code></td>
<td>
<p>a numeric value specifying the control limit</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list that stores the result.<br />
</p>
<table>
<tr><td><code>$chart</code></td>
<td>
<p>charting statistics arranged in a matrix.</p>
</td></tr>
<tr><td><code>$standardized_values</code></td>
<td>
<p>standardized values arranged in a matrix.</p>
</td></tr>
</table>


<h3>References</h3>

<p>You, L. and Qiu, P. (2020). An effective method for online disease risk monitoring. Technometrics, 62(2):249-264.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("data_example_long_surv")

result_pattern&lt;-estimate_pattern_long_surv(
  data_array=data_example_long_surv$data_array_IC,
  time_matrix=data_example_long_surv$time_matrix_IC,
  nobs=data_example_long_surv$nobs_IC,
  starttime=data_example_long_surv$starttime_IC,
  survtime=data_example_long_surv$survtime_IC,
  survevent=data_example_long_surv$survevent_IC,
  design_interval=data_example_long_surv$design_interval,
  n_time_units=data_example_long_surv$n_time_units,
  estimation_method="risk",
  smoothing_method="local linear",
  bw_beta=0.05,
  bw_mean=0.1,
  bw_var=0.1)

result_monitoring&lt;-monitor_long_surv(
  data_array_new=data_example_long_surv$data_array_OC,
  time_matrix_new=data_example_long_surv$time_matrix_OC,
  nobs_new=data_example_long_surv$nobs_OC,
  pattern=result_pattern,
  method="risk",
  parameter=0.5)
</code></pre>

<hr>
<h2 id='plot_evaluation'>Evaluate and Visualize Control Charts by ROC curves</h2><span id='topic+plot_evaluation'></span>

<h3>Description</h3>

<p>Evaluate and Visualize Control Charts by ROC curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_evaluation(evaluate_control_chart)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_evaluation_+3A_evaluate_control_chart">evaluate_control_chart</code></td>
<td>
<p>an object of class evaluate_control_chart. <br />
<code>evaluate_control_chart</code> is an output from 
<code>evaluate_control_chart_one_group</code> or 
<code>evaluate_control_chart_two</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for drawing two ROC plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result_pattern&lt;-estimate_pattern_long_surv(
  data_array=data_example_long_surv$data_array_IC,
  time_matrix=data_example_long_surv$time_matrix_IC,
  nobs=data_example_long_surv$nobs_IC,
  starttime=data_example_long_surv$starttime_IC,
  survtime=data_example_long_surv$survtime_IC,
  survevent=data_example_long_surv$survevent_IC,
  design_interval=data_example_long_surv$design_interval,
  n_time_units=data_example_long_surv$n_time_units,
  estimation_method="risk",
  smoothing_method="local linear",
  bw_beta=0.05,
  bw_mean=0.1,
  bw_var=0.1)

result_monitoring&lt;-monitor_long_surv(
  data_array_new=data_example_long_surv$data_array_IC,
  time_matrix_new=data_example_long_surv$time_matrix_IC,
  nobs_new=data_example_long_surv$nobs_IC,
  pattern=result_pattern,
  method="risk",
  parameter=0.5)

output_evaluate&lt;-evaluate_control_chart_one_group(
  chart_matrix=result_monitoring$chart,
  time_matrix=data_example_long_surv$time_matrix_IC,
  nobs=data_example_long_surv$nobs_IC,
  starttime=rep(0,nrow(data_example_long_surv$time_matrix_IC)),
  endtime=rep(1,nrow(data_example_long_surv$time_matrix_IC)),
  status=data_example_long_surv$survevent_IC,
  design_interval=data_example_long_surv$design_interval,
  n_time_units=data_example_long_surv$n_time_units,
  no_signal_action="maxtime")

plot_evaluation(output_evaluate)
plot_PMROC(output_evaluate)

</code></pre>

<hr>
<h2 id='plot_PMROC'>Evaluate and Visualize Control Charts by PM-ROC curves</h2><span id='topic+plot_PMROC'></span>

<h3>Description</h3>

<p>Evaluate and Visualize Control Charts by PM-ROC curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_PMROC(evaluate_control_chart)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_PMROC_+3A_evaluate_control_chart">evaluate_control_chart</code></td>
<td>
<p>an object of class evaluate_control_chart. <br />
<code>evaluate_control_chart</code> is an output from 
<code>evaluate_control_chart_one_group</code> or 
<code>evaluate_control_chart_two_group</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for drawing one PM-ROC plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pattern&lt;-estimate_pattern_long_1d(
  data_matrix=data_example_long_1d$data_matrix_IC,
  time_matrix=data_example_long_1d$time_matrix_IC,
  nobs=data_example_long_1d$nobs_IC,
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  estimation_method="meanvar",
  smoothing_method="local linear",
  bw_mean=0.1,
  bw_var=0.1)

chart_IC_output&lt;-monitor_long_1d(
  data_example_long_1d$data_matrix_IC,
  data_example_long_1d$time_matrix_IC,
  data_example_long_1d$nobs_IC,
  pattern=pattern,side="upward",chart="CUSUM",
  method="standard",parameter=0.2)

chart_OC_output&lt;-monitor_long_1d(
  data_example_long_1d$data_matrix_OC,
  data_example_long_1d$time_matrix_OC,
  data_example_long_1d$nobs_OC,
  pattern=pattern,side="upward",chart="CUSUM",
  method="standard",parameter=0.2)

output_evaluate&lt;-evaluate_control_chart_two_groups(
  chart_matrix_IC=chart_IC_output$chart[1:50,],
  time_matrix_IC=data_example_long_1d$time_matrix_IC[1:50,],
  nobs_IC=data_example_long_1d$nobs_IC[1:50],
  starttime_IC=rep(0,50),
  endtime_IC=rep(1,50),
  chart_matrix_OC=chart_OC_output$chart[1:50,],
  time_matrix_OC=data_example_long_1d$time_matrix_OC[1:50,],
  nobs_OC=data_example_long_1d$nobs_OC[1:50],
  starttime_OC=rep(0,50),
  endtime_OC=rep(1,50),
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  no_signal_action="maxtime")

plot_evaluation(output_evaluate)
plot_PMROC(output_evaluate)

</code></pre>

<hr>
<h2 id='search_CL'>Search Control Limit</h2><span id='topic+search_CL'></span>

<h3>Description</h3>

<p>Given a chart matrix, the function <code>search_CL</code> searches the control limit (CL)
so that the specified average time to signals (ATS) can be attained.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>search_CL(
  chart_matrix,
  time_matrix,
  nobs,
  starttime,
  endtime,
  design_interval,
  n_time_units,
  time_unit,
  ATS_nominal,
  CL_lower,
  CL_step,
  CL_upper,
  no_signal_action = "omit",
  ATS_tol,
  CL_tol
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="search_CL_+3A_chart_matrix">chart_matrix</code></td>
<td>
<p>charting statistics arranged as a numeric matrix. <br />
<code>chart_matrix[i,j]</code> is the jth charting statistic of the ith subject.</p>
</td></tr>
<tr><td><code id="search_CL_+3A_time_matrix">time_matrix</code></td>
<td>
<p>observation times arranged as a numeric matrix. <br />
<code>time_matrix[i,j]</code> is the jth observation time of the ith subject,
corresponding to the time the charting statistic <code>chart_matrix[i,j]</code> is computed.</p>
</td></tr>
<tr><td><code id="search_CL_+3A_nobs">nobs</code></td>
<td>
<p>number of observations arranged as an integer vector. <br />
<code>nobs[i]</code> is the number of observations for the ith subject.</p>
</td></tr>
<tr><td><code id="search_CL_+3A_starttime">starttime</code></td>
<td>
<p>a vector of times from the start of monitoring. <br />
<code>starttime[i]</code> is the time that the ith subject starts to be monitored.</p>
</td></tr>
<tr><td><code id="search_CL_+3A_endtime">endtime</code></td>
<td>
<p>a vector of times from the start of monitoring. <br />
<code>endtime[i]</code> is the time that the ith subject is lost to be monitored.</p>
</td></tr>
<tr><td><code id="search_CL_+3A_design_interval">design_interval</code></td>
<td>
<p>a numeric vector of length two that 
gives the left- and right- limits of the design interval. 
By default, <code>design_interval=range(time_matrix,na.rm=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="search_CL_+3A_n_time_units">n_time_units</code></td>
<td>
<p>an integer value that gives the number of basic time units
in the design time interval. <br />
The design interval will be discretized to <br />
<code>seq(design_interval[1],design_interval[2],length.out=n_time_units)</code></p>
</td></tr>
<tr><td><code id="search_CL_+3A_time_unit">time_unit</code></td>
<td>
<p>an optional numeric value of basic time unit. Only used when <code>n_time_units</code> is missing.<br />
The design interval will be discretized to <br />
<code>seq(design_interval[1],design_interval[2],by=time_unit)</code></p>
</td></tr>
<tr><td><code id="search_CL_+3A_ats_nominal">ATS_nominal</code></td>
<td>
<p>a numeric value. <br />
<code>ATS_nominal</code> is the nominal (or say targeted) ATS that is intended to achieve.</p>
</td></tr>
<tr><td><code id="search_CL_+3A_cl_lower">CL_lower</code>, <code id="search_CL_+3A_cl_step">CL_step</code>, <code id="search_CL_+3A_cl_upper">CL_upper</code></td>
<td>
<p>three numeric values. <br />
The control limit will be searched within the interval [<code>CL_lower</code>,<code>CL_upper</code>]. <br />
When applying grid search, the algorithm will use a step size of <code>CL_step</code>. <br />
(Namely, the algorithm will start with <code>CL_lower</code>, 
and search through the sequences <code>CL_lower</code>, <code>CL_lower+CL_step</code>, <code>CL_lower+2*CL_step</code>, ... until <code>CL_upper</code>.)</p>
</td></tr>
<tr><td><code id="search_CL_+3A_no_signal_action">no_signal_action</code></td>
<td>
<p>a character specifying the method to use when a signal is not given to a process.
If <code>no_signal_action="omit"</code> take averages by omitting the processes with no signals, namely, average only the processes with signals. <br />
If <code>no_signal_action="maxtime"</code> impute the signal times by the maximum time, which is the right limit of design time interval. <br />
If <code>no_signal_action="endtime"</code> impute the signal times by the end times.</p>
</td></tr>
<tr><td><code id="search_CL_+3A_ats_tol">ATS_tol</code></td>
<td>
<p>a numeric value. <br />
Error tolerance for ATS.</p>
</td></tr>
<tr><td><code id="search_CL_+3A_cl_tol">CL_tol</code></td>
<td>
<p>a numeric value. <br />
Error tolerance for control limit.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Search Control Limit
</p>


<h3>Value</h3>

<p>a numeric value, the control limit that gives the desired ATS.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
result_pattern&lt;-estimate_pattern_long_1d(
  data_matrix=data_example_long_1d$data_matrix_IC,
  time_matrix=data_example_long_1d$time_matrix_IC,
  nobs=data_example_long_1d$nobs_IC,
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  estimation_method="meanvar",
  smoothing_method="local linear",
  bw_mean=0.1,
  bw_var=0.1)

result_monitoring&lt;-monitor_long_1d(
  data_matrix_new=data_example_long_1d$data_matrix_IC,
  time_matrix_new=data_example_long_1d$time_matrix_IC,
  nobs_new=data_example_long_1d$nobs_IC,
  pattern=result_pattern,
  side="upward",
  chart="CUSUM",
  method="standard",
  parameter=0.5)

CL&lt;-search_CL(
  chart_matrix=result_monitoring$chart,
  time_matrix=data_example_long_1d$time_matrix_IC,
  nobs=data_example_long_1d$nobs_IC,
  starttime=rep(0,nrow(data_example_long_1d$time_matrix_IC)),
  endtime=rep(1,nrow(data_example_long_1d$time_matrix_IC)),
  design_interval=data_example_long_1d$design_interval,
  n_time_units=data_example_long_1d$n_time_units,
  ATS_nominal=200,CL_lower=0,CL_upper=5)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
