<!DOCTYPE html><html><head><title>Help for package mstR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mstR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eapEst'><p>EAP ability estimation (dichotomous and polytomous IRT models)</p></a></li>
<li><a href='#eapSem'><p>Standard error of EAP ability estimation (dichotomous and polytomous IRT models)</p></a></li>
<li><a href='#genDichoMatrix'><p>Item bank generation (dichotomous models)</p></a></li>
<li><a href='#genPattern'><p>Random generation of item response patterns under dichotomous and polytomous IRT models</p></a></li>
<li><a href='#genPolyMatrix'><p>Item bank generation (polytomous models)</p></a></li>
<li><a href='#Ii'><p>Item information functions, first and second derivatives (dichotomous and polytomous models)</p></a></li>
<li><a href='#integrate.mstR'><p>Numerical integration by linear interpolation (for mstR internal use)</p></a></li>
<li><a href='#Ji'><p>Function <code class="reqn">J(\theta)</code> for weighted likelihood estimation (dichotomous and polytomous IRT models)</p></a></li>
<li><a href='#MKL'><p>Module Kullback-Leibler (MKL) and posterior module Kullback-Leibler (MKLP)</p></a></li>
<li><a href='#MWMI'><p>Maximum likelihood weighted module information (MLWMI) and maximum posterior weighted module information (MPWMI)</p></a></li>
<li><a href='#nextModule'><p>Selection of the next module in MST</p></a></li>
<li><a href='#Pi'><p>Item response probabilities, first, second and third derivatives (dichotomous and polytomous models)</p></a></li>
<li><a href='#randomMST'><p>Random generation of multistage tests (dichotomous and polytomous models)</p></a></li>
<li><a href='#semTheta'><p>Standard error of ability estimation (dichotomous and polytomous models)</p></a></li>
<li><a href='#startModule'><p>Selection of the first module in MST</p></a></li>
<li><a href='#testListMST'><p>Testing the format of the MST input lists</p></a></li>
<li><a href='#thetaEst'><p>Ability estimation (dichotomous and polytomous models)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Procedures to Generate Patterns under Multistage Testing</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-03-29</td>
</tr>
<tr>
<td>Author:</td>
<td>David Magis (U Liege, Belgium), Duanli Yan (ETS, USA), Alina von Davier (ACTNext, USA)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Magis &lt;david.magis@uliege.be&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.8.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Generation of response patterns under dichotomous and polytomous computerized multistage testing (MST) framework. It holds various item response theory (IRT) and score-based methods to select the next module and estimate ability levels (Magis, Yan and von Davier (2017, ISBN:978-3-319-69218-0)). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-29 17:04:42 UTC; David</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-30 08:47:32</td>
</tr>
</table>
<hr>
<h2 id='eapEst'>EAP ability estimation (dichotomous and polytomous IRT models)</h2><span id='topic+eapEst'></span>

<h3>Description</h3>

<p>This command returns the EAP (expected a posteriori) ability estimate for a given response pattern and a given matrix of item parameters, either under the 4PL model or any suitable polytomous IRT model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eapEst(it, x, model = NULL, D = 1, priorDist = "norm", priorPar = c(0, 1), 
 	lower = -4, upper = 4, nqp = 33)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eapEst_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapEst_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses.</p>
</td></tr>
<tr><td><code id="eapEst_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapEst_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
<tr><td><code id="eapEst_+3A_priordist">priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>.</p>
</td></tr>
<tr><td><code id="eapEst_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>). Ignored if <code>priorDist="Jeffreys"</code>.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapEst_+3A_lower">lower</code></td>
<td>
<p>numeric: the lower bound for numercal integration (default is -4).</p>
</td></tr>
<tr><td><code id="eapEst_+3A_upper">upper</code></td>
<td>
<p>numeric: the upper bound for numercal integration (default is 4).</p>
</td></tr>
<tr><td><code id="eapEst_+3A_nqp">nqp</code></td>
<td>
<p>numeric: the number of quadrature points (default is 33).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The EAP (expected a posteriori) ability estimator (Bock and Mislevy, 1982) is obtained by computing the average of the posterior distribution of ability, the latter being set as the prior distribution times the likelihood function. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Three prior distributions are available: the normal distribution, the uniform distribution and Jeffreys' prior distribution (Jeffreys, 1939, 1946).
The prior distribution is specified by the argument <code>priorPar</code>, with values <code>"norm"</code>, <code>"unif"</code> and <code>"Jeffreys"</code>, respectively. 
</p>
<p>The argument <code>priorPar</code> determines either the prior mean and standard deviation of the normal prior distribution (if 
<code>priorDist="norm"</code>), or the range for defining the prior uniform distribution (if <code>priorDist="unif"</code>). This argument is ignored if <code>priorDist="Jeffreys"</code>.
</p>
<p>The required integrals are approximated by numerical adaptive quadrature. This is achieved by using the <code><a href="#topic+integrate.mstR">integrate.mstR</a></code> function. Arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> define respectively the lower and upper bounds for numerical integration, and the number 
of quadrature points. By default, the numerical integration runs with 33 quadrature points on the range [-4; 4], that is, a sequence of values from -4 to 4 by steps of 0.25.
</p>


<h3>Value</h3>

<p>The estimated EAP ability level.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. <em>Applied Psychological Measurement, 6</em>, 431-444. doi: 10.1177/014662168200600405
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R 
Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>, <code><a href="#topic+integrate.mstR">integrate.mstR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Generation of an item bank under 3PL with 100 items 
 m.3PL &lt;- genDichoMatrix(100, model = "3PL")
 m.3PL &lt;- as.matrix(m.3PL)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.3PL)

 # EAP estimation, standard normal prior distribution
 eapEst(m.3PL, x)

 # EAP estimation, uniform prior distribution upon range [-2,2]
 eapEst(m.3PL, x, priorDist = "unif", priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 eapEst(m.3PL, x, priorDist = "Jeffreys")

 # Changing the integration settings
 eapEst(m.3PL, x, nqp = 100)

## Not run: 

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.GRM, model = "GRM")

 # EAP estimation, standard normal prior distribution
 eapEst(m.GRM, x, model = "GRM")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 eapEst(m.GRM, x, model = "GRM", priorDist = "unif", priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 eapEst(m.GRM, x, model = "GRM", priorDist = "Jeffreys")


 # Generation of a item bank under PCM with 20 items and at most 3 categories
 m.PCM &lt;- genPolyMatrix(20, 3, "PCM")
 m.PCM &lt;- as.matrix(m.PCM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.PCM, model = "PCM")

 # EAP estimation, standard normal prior distribution
 eapEst(m.PCM, x, model = "PCM")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 eapEst(m.PCM, x, model = "PCM", priorDist = "unif", priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 eapEst(m.PCM, x, model = "PCM", priorDist = "Jeffreys")
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='eapSem'>Standard error of EAP ability estimation (dichotomous and polytomous IRT models)</h2><span id='topic+eapSem'></span>

<h3>Description</h3>

<p>This command returns the estimated standard error of the ability estimate, for a given response pattern and a given matrix of item parameters, either under the 4PL model or any suitable polytomous IRT model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eapSem(thEst, it, x, model = NULL, D = 1, priorDist = "norm", 
 	priorPar = c(0, 1), lower = -4, upper = 4, nqp = 33)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eapSem_+3A_thest">thEst</code></td>
<td>
<p>numeric: the EAP ability estimate.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
<tr><td><code id="eapSem_+3A_priordist">priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>). Ignored if <code>priorDist="Jeffreys"</code>.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="eapSem_+3A_lower">lower</code></td>
<td>
<p>numeric: the lower bound for numercal integration (default is -4).</p>
</td></tr>
<tr><td><code id="eapSem_+3A_upper">upper</code></td>
<td>
<p>numeric: the upper bound for numercal integration (default is 4).</p>
</td></tr>
<tr><td><code id="eapSem_+3A_nqp">nqp</code></td>
<td>
<p>numeric: the number of quadrature points (default is 33).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This command computes the standard error of the EAP (expected a posteriori) ability estimator (Bock and Mislevy, 1982).
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Three prior distributions are available: the normal distribution, the uniform distribution and Jeffreys' prior distribution (Jeffreys, 1939, 1946).
The prior distribution is specified by the argument <code>priorPar</code>, with values <code>"norm"</code>, <code>"unif"</code> and <code>"Jeffreys"</code>, respectively. 
</p>
<p>The argument <code>priorPar</code> determines either the prior mean and standard deviation of the normal prior distribution (if 
<code>priorDist="norm"</code>), or the range for defining the prior uniform distribution (if <code>priorDist="unif"</code>). This argument is ignored if <code>priorDist="Jeffreys"</code>.
</p>
<p>The required integrals are approximated by numerical adaptive quadrature. This is achieved by using the <code><a href="#topic+integrate.mstR">integrate.mstR</a></code> function. Arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> define respectively the lower and upper bounds for numerical integration, and the number
of quadrature points. By default, the numerical integration runs with 33 quadrature points on the range [-4; 4], that is, a sequence of values from -4 to 4 by steps of 0.25.
</p>
<p>Note that in the current version, the EAP ability estimate must be specified through the <code>thEst</code> argument.
</p>


<h3>Value</h3>

<p>The estimated standard error of the EAP ability level.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. <em>Applied Psychological Measurement, 6</em>, 431-444. doi: 10.1177/014662168200600405
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## Dichotomous models ##

 # Generation of an item bank under 3PL with 100 items 
 m.3PL &lt;- genDichoMatrix(100, model = "3PL")
 m.3PL &lt;- as.matrix(m.3PL)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.3PL)

 # EAP estimation, standard normal prior distribution
 th &lt;- eapEst(m.3PL, x)
 c(th, eapSem(th, m.3PL, x))

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- eapEst(m.3PL, x, priorDist = "unif", priorPar = c(-2, 2))
 c(th, eapSem(th, m.3PL, x, priorDist = "unif", priorPar=c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- eapEst(m.3PL, x, priorDist = "Jeffreys")
 c(th, eapSem(th, m.3PL, x, priorDist = "Jeffreys"))


## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.GRM, model = "GRM")

 # EAP estimation, standard normal prior distribution
 th &lt;- eapEst(m.GRM, x, model = "GRM")
 c(th, eapSem(th, m.GRM, x, model = "GRM"))

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- eapEst(m.GRM, x, model = "GRM", priorDist = "unif", priorPar = c(-2, 2))
 c(th, eapSem(th, m.GRM, x, model = "GRM", priorDist = "unif", priorPar = c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- eapEst(m.GRM, x, model = "GRM", priorDist = "Jeffreys")
 c(th, eapSem(th, m.GRM, x, model = "GRM", priorDist = "Jeffreys"))


 # Generation of a item bank under PCM with 20 items and at most 3 categories
 m.PCM &lt;- genPolyMatrix(20, 3, "PCM")
 m.PCM &lt;- as.matrix(m.PCM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.PCM, model = "PCM")

 # EAP estimation, standard normal prior distribution
 th &lt;- eapEst(m.PCM, x, model = "PCM")
 c(th, eapSem(th, m.PCM, x, model = "PCM"))

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- eapEst(m.PCM, x, model = "PCM", priorDist = "unif", priorPar = c(-2, 2))
 c(th, eapSem(th, m.PCM, x, model = "PCM", priorDist = "unif", priorPar = c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- eapEst(m.PCM, x, model = "PCM", priorDist = "Jeffreys")
 c(th, eapSem(th, m.PCM, x, model = "PCM", priorDist = "Jeffreys"))

## End(Not run)
 </code></pre>

<hr>
<h2 id='genDichoMatrix'>Item bank generation (dichotomous models)</h2><span id='topic+genDichoMatrix'></span>

<h3>Description</h3>

<p>This command generates an item bank from prespecified parent distributions for use with dichotomous IRT models. Subgroups of items can also be specified for content balancing purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genDichoMatrix(items = 100, model = "4PL", aPrior = c("norm", 1, 0.2), 
  bPrior = c("norm", 0, 1), cPrior = c("unif", 0, 0.25), 
  dPrior = c("unif", 0.75, 1), seed = 1)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genDichoMatrix_+3A_items">items</code></td>
<td>
<p>integer: the number of items to include in the generated item bank.</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_model">model</code></td>
<td>
<p>character: the name of the logistic IRT model, with possible values <code>"1PL"</code>, <code>"2PL"</code>, <code>"3PL"</code> or <code>"4PL"</code> (default).</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_aprior">aPrior</code></td>
<td>
<p>vector of three components, specifying the prior distribution and item parameters for generating the item discrimination levels. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_bprior">bPrior</code></td>
<td>
<p>vector of three components, specifying the prior distribution and item parameters for generating the item difficulty levels. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_cprior">cPrior</code></td>
<td>
<p>vector of three components, specifying the prior distribution and item parameters for generating the item lower asymptote levels. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_dprior">dPrior</code></td>
<td>
<p>vector of three components, specifying the prior distribution and item parameters for generating the item upper asymptote levels. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genDichoMatrix_+3A_seed">seed</code></td>
<td>
<p>numeric: the random seed number for the generation of item parameters (default is 1). See <code><a href="base.html#topic+set.seed">set.seed</a></code> for further details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function permits to generate an item bank under dichotomous IRT models that is compatible for use in MST simulations.
</p>
<p>The number of items to be included in the bank is specified by the <code>items</code> argument. Corresponding item parameters are drawn from distributions to be specified by arguments <code>aPrior</code>, <code>bPrior</code>, <code>cPrior</code> and <code>dPrior</code> for respective parameters <code class="reqn">a_i</code>, <code class="reqn">b_i</code>, <code class="reqn">c_i</code> and <code class="reqn">d_i</code> (Barton and Lord, 1981). Each of these arguments is of length 3, the first component containing the name of the distribution and the last two components coding the distribution parameters. 
</p>
<p>Possible distributions are:
</p>

<ul>
<li><p>the <em>normal distribution</em> <code class="reqn">N(\mu, \sigma^2)</code>, available for parameters <code class="reqn">a_i</code> and <code class="reqn">b_i</code>. It is specified by <code>"norm"</code> as first argument while the latter two arguments contain the values of <code class="reqn">\mu</code> and <code class="reqn">\sigma</code> respectively.
</p>
</li>
<li><p>the <em>log-normal distribution</em> <code class="reqn">\log N(\mu, \sigma^2)</code>, available for parameter <code class="reqn">a_i</code> only. It is specified by <code>"lnorm"</code> as first argument while the latter two arguments contain the values of <code class="reqn">\mu</code> and <code class="reqn">\sigma</code> respectively.
</p>
</li>
<li><p>the <em>uniform distribution</em> <code class="reqn">U([a,b])</code>, available for all parameters. It is specified by <code>"unif"</code> as first argument while the latter two arguments contain the values of <code class="reqn">a</code> and <code class="reqn">b</code> respectively. Note that taking <code class="reqn">a</code> and <code class="reqn">b</code> equal to a common value, say <code class="reqn">t</code>, makes all parameters to be equal to <code class="reqn">t</code>.
</p>
</li>
<li><p>the <em>Beta distribution</em> <code class="reqn">Beta(\alpha, \beta)</code>, available for parameters <code class="reqn">c_i</code> and <code class="reqn">d_i</code>. It is specified by <code>"beta"</code> as first argument while the latter two arguments contain the values of <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> respectively.
</p>
</li></ul>

<p>Inattention parameters <code class="reqn">d_i</code> are fixed to 1 if <code>model</code> is not <code>"4PL"</code>; pseudo-guessing parameters <code class="reqn">c_i</code> are fixed to zero if <code>model</code> is either <code>"1PL"</code> or <code>"2PL"</code>; and discrimination parameters <code class="reqn">a_i</code> are
fixed to 1 if <code>model="1PL"</code>. The random generation of item parameters can be controlled by the <code>seed</code> argument.
</p>
<p>The random generation of item parameters si being controled by the <code>seed</code> argument.
</p>
<p>The output is a data frame with four arguments, with names <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> for respectively the discrimination <code class="reqn">a_i</code>, the difficulty <code class="reqn">b_i</code>, the lower asymptote <code class="reqn">c_i</code> and the upper asymptote <code class="reqn">d_i</code> parameters. </p>


<h3>Value</h3>

<p>A data frame with four arguments:
</p>
<table>
<tr><td><code>a</code></td>
<td>
<p>the generated item discrimination parameters.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>the generated item difficulty parameters.</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>the generated item lower asymptote parameters.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>the generated item upper asymptote parameters.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R 
Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Item bank generation with 500 items
 genDichoMatrix(items = 500)

 # Item bank generation with 100 items, 2PL model and log-normal distribution with 
 # parameters (0, 0.1225) for discriminations
 genDichoMatrix(items = 100, model = "2PL", aPrior = c("lnorm", 0, 0.1225))

 # A completely identical method as for previous example
 genDichoMatrix(items = 100, aPrior = c("lnorm", 0, 0.1225), 
  cPrior = c("unif", 0, 0), dPrior = c("unif", 1, 1))
 </code></pre>

<hr>
<h2 id='genPattern'>Random generation of item response patterns under dichotomous and polytomous IRT models</h2><span id='topic+genPattern'></span>

<h3>Description</h3>

<p>This command generates item responses patterns for a given matrix of item parameters of any specified dichotomous or polytomous IRT model and a given ability value. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genPattern(th, it, model = NULL, D = 1, seed = NULL)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genPattern_+3A_th">th</code></td>
<td>
<p>numeric: the ability value.</p>
</td></tr>
<tr><td><code id="genPattern_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genPattern_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genPattern_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="genPattern_+3A_seed">seed</code></td>
<td>
<p>either the random seed value or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function permits to randomly generate item responses for a given ability level, specified by the argument <code>thr</code>, and for a given matrix of item parameters, specified by the argument <code>it</code>. Both dichotomous and polytomous IRT models can be considered and item responses are generated accordingly.
</p>
<p>For dichotomous models, item responses are generated from Bernoulli draws, , using the <code><a href="stats.html#topic+rbinom">rbinom</a></code> function. For polytomous models they are generated from darws from a multinomial distribution, using the <code><a href="stats.html#topic+rmultinom">rmultinom</a></code> function. In both cases, success probabilities are obtained from the <code><a href="#topic+Pi">Pi</a></code> function.
</p>
<p>Note that for polytomous models, item responses are coded as 0 (for the first response category), 1 (for the second category), ..., until <code class="reqn">g_j</code> (for the last category), in agreement with the notations used in the help files of, e.g., the <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The random pattern generation can be fixed by setting <code>seed</code> to some numeric value. By default, <code>seed</code> is <code>NULL</code> and the random seed is not fixed.
</p>


<h3>Value</h3>

<p>A vector with the item responses in the order of appearance of the items in the <code>it</code> matrix.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University.
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R 
Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rbinom">rbinom</a></code> and <code><a href="stats.html#topic+rmultinom">rmultinom</a></code> for random draws; <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>, <code><a href="#topic+Pi">Pi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##
 
 # Generation of an item bank under 3PL with 100 items 
 m.3PL &lt;- genDichoMatrix(100, model = "3PL")
 m.3PL &lt;- as.matrix(m.3PL)
 
 # Generation of a response pattern for ability level 0
 genPattern(th = 0, m.3PL)

 # Generation of a single response for the first item only
 genPattern(th = 0, m.3PL[1,])

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Generation of a response pattern for ability level 0
 genPattern(0, m.GRM, model = "GRM")

 # Generation of a single response for the first item only
 genPattern(0, m.GRM[1,], model = "GRM")

 # Generation of a item bank under PCM with 20 items and at most 3 categories
 m.PCM &lt;- genPolyMatrix(20, 3, "PCM")
 m.PCM &lt;- as.matrix(m.PCM)

 # Generation of a response pattern for ability level 0
 genPattern(0, m.PCM, model = "PCM")

 # Generation of a single response for the first item only
 genPattern(0, m.PCM[1,], model = "PCM")
 </code></pre>

<hr>
<h2 id='genPolyMatrix'>Item bank generation (polytomous models)</h2><span id='topic+genPolyMatrix'></span>

<h3>Description</h3>

<p>This command generates an item bank from prespecified parent distributions for use with polytomous IRT models. Subgroups of items can also be specified for content balancing purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genPolyMatrix(items = 100, nrCat = 3, model = "GRM", seed = 1, same.nrCat = FALSE)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genPolyMatrix_+3A_items">items</code></td>
<td>
<p>integer: the number of items to generate (default is 100).</p>
</td></tr>
<tr><td><code id="genPolyMatrix_+3A_nrcat">nrCat</code></td>
<td>
<p>integer: the (maximum) number of response categories to generate (default is 3).</p>
</td></tr>
<tr><td><code id="genPolyMatrix_+3A_model">model</code></td>
<td>
<p>character: the type of polytomous IRT model. Possible values are <code>"GRM"</code> (default), <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="genPolyMatrix_+3A_seed">seed</code></td>
<td>
<p>numeric: the random seed for item parameter generation (default is 1).</p>
</td></tr>
<tr><td><code id="genPolyMatrix_+3A_same.nrcat">same.nrCat</code></td>
<td>
<p>logical: should all items have the same number of response categories? (default is <code>FALSE</code>. Ignored if <code>model</code> is either <code>"MGRM"</code> or <code>"RSM"</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>genPolyMatrix</code> permits to quickly generate a polytomous item bank in suitable format for further use in e.g. computing item response propbabilities with the <code><a href="#topic+Pi">Pi</a></code>. 
</p>
<p>The six polytomous IRT models that are supported are: 
</p>

<ol>
<li><p>the <em>Graded Response Model</em> (GRM; Samejima, 1969);
</p>
</li>
<li><p>the <em>Modified Graded Response Model</em> (MGRM; Muraki, 1990);
</p>
</li>
<li><p>the <em>Partial Credit Model</em> (PCM; Masters, 1982);
</p>
</li>
<li><p>the <em>Generalized Partial Credit Model</em> (GPCM; Muraki, 1992);
</p>
</li>
<li><p>the <em>Rating Scale Model</em> (RSM; Andrich, 1978);
</p>
</li>
<li><p>the <em>Nominal Response Model</em> (NRM; Bock, 1972).
</p>
</li></ol>

<p>Each model is specified through the <code>model</code> argument, with its accronym surrounded by double quotes (i.e. <code>"GRM"</code> for GRM, <code>"PCM"</code> for PCM, etc.). The default value is <code>"GRM"</code>.
</p>
<p>For any item <code class="reqn">j</code>, set <code class="reqn">(0, ..., g_j)</code> as the <code class="reqn">g_j+1</code> possible response categories. The maximum number of response categories can differ across items under the GRM, PCM, GPCM and NRM, but they are obviously equal across items under the MGRM and RSM. In the latter, set <code class="reqn">g</code> as the (same) number of response categories for all items. It is possible however to require all items to have the same number of response categories, by fixing the <code>same.nrCat</code> argument to <code>TRUE</code>.
</p>
<p>In case of GRM, PCM, GPCM or NRM with <code>same.nrCat</code> being <code>FALSE</code>, the number of response categories <code class="reqn">g_j+1</code> per item is drawn from a Poisson distribution with parameter <code>nrCat</code>, and this number is restricted to the interval [2; <code>nrCat</code>]. This ensure at least two response categories and at most <code>nrCat</code> categories. In all other cases, each <code class="reqn">g_j+1</code> is trivially fixed to <code class="reqn">g+1 = </code> <code>nrCat</code>.
</p>
<p>Denote further <code class="reqn">P_{jk}(\theta)</code> as the probability of answering response category <code class="reqn">k \in \{0, ..., g_j\}</code> of item <code class="reqn">j</code>. For GRM and MGRM, response probabilities <code class="reqn">P_{jk}(\theta)</code> are defined through cumulative probabilities, while for PCM, GPCM, RSM and NRM they are directly computed.
</p>
<p>For GRM and MGRM, set <code class="reqn">P_{jk}^*(\theta)</code> as the (cumulative) probability of asnwering response category <code class="reqn">k</code> or &quot;above&quot;, that is <code class="reqn">P_{jk}^*(\theta) = Pr(X_j \geq k | \theta)</code> where <code class="reqn">X_j</code> is the item response. It follows obviously that for any <code class="reqn">\theta</code>, <code class="reqn">P_{j0}^*(\theta) = 1</code> and <code class="reqn">P_{jk}^*(\theta) = 0</code> when <code class="reqn">k&gt;g_j</code>. Furthermore, response category probabilities are found back by the relationship <code class="reqn">P_{jk}(\theta)= P_{jk}^*(\theta)-P_{j,k+1}^*(\theta)</code>. Then, the GRM is defined by (Samejima, 1969)
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}^*(\theta)=\frac{\exp\,[\alpha_j\,(\theta-\beta_{jk})]}{1+\exp\,[\alpha_j\,(\theta-\beta_{jk})]}</code>
</p>
 
<p>and the MGRM by (Muraki, 1990)
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}^*(\theta)=\frac{\exp\,[\alpha_j\,(\theta-b_j+c_k)]}{1+\exp\,[\alpha_j\,(\theta-b_j+c_k)]}.</code>
</p>

<p>The PCM, GPCM, RSM and NRM are defined as &quot;divide-by-total&quot; models (Embretson and Reise, 2000). The PCM has following response category probability (Masters, 1982):
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}(\theta)=\frac{\exp\,\sum_{t=0}^k (\theta-\delta_{jt})}{\sum_{r=0}^{g_j}\,\exp\, \sum_{t=0}^r (\theta-\delta_{jt})}\quad \mbox{with} \quad  \sum_{t=0}^0 (\theta-\delta_{jt})=0.</code>
</p>

<p>The GPCM has following response category probability (Muraki, 1992):
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}(\theta)=\frac{\exp\,\sum_{t=0}^k \alpha_j\,(\theta-\delta_{jt})}{\sum_{r=0}^{g_j}\,\exp\, \sum_{t=0}^r \alpha_j\,(\theta-\delta_{jt})}\quad \mbox{with} \quad  \sum_{t=0}^0 \alpha_j\,(\theta-\delta_{jt})=0.</code>
</p>

<p>The RSM has following response category probability (Andrich, 1978):
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}(\theta)=\frac{\exp\,\sum_{t=0}^k [\theta-(\lambda_j+\delta_t)]}{\sum_{r=0}^{g_j}\,\exp\, \sum_{t=0}^r [\theta-(\lambda_j+\delta_t)]}\quad \mbox{with} \quad  \sum_{t=0}^0 [\theta-(\lambda_j+\delta_t)]=0.</code>
</p>

<p>Finally, the NRM has following response category probability (Bock, 1972):
</p>
<p style="text-align: center;"><code class="reqn">P_{jk}(\theta)=\frac{\exp (\alpha_{jk}\,\theta+c_{jk})}{\sum_{r=0}^{g_j} \exp (\alpha_{jr}\,\theta+c_{jr})}\quad \mbox{with} \quad  \alpha_{j0}\,\theta+c_{j0}=0.</code>
</p>

<p>The following parent distributions are considered to generate the different item parameters. The <code class="reqn">\alpha_j</code> parameters of GRM, MGRM and GPCM, as well as the <code class="reqn">\alpha_{jk}</code> parameters of the NRM, are drawn from a log-normal distribution with mean 0 and standard deviation 0.1225. All other parameters are drawn from a standard normal distribution. Moreover, the <code class="reqn">\beta_{jk}</code> parameters of the GRM and the <code class="reqn">c_k</code> parameters of the MGRM are sorted respectively in increasing and decreasing order of <code class="reqn">k</code>, to ensure decreasing trend in the cumulative <code class="reqn">P_{jk}^*(\theta)</code> probabilities.
</p>
<p>The output is a matrix with one row per item and as many columns as required to hold all item parameters. In case of missing response categories, the corresponding parameters are replaced by <code>NA</code> values. Column names refer to the corresponding model parameters. See <b>Details</b> for further explanations and <b>Examples</b> for illustrative examples.
</p>


<h3>Value</h3>

<p>A matrix with <code>items</code> rows and as many columns as required for the considered IRT model: 
</p>

<ul>
<li><p><code class="reqn">\max_j \,g_j+1</code> columns, holding parameters <code class="reqn">(\alpha_j, \beta_{j1}, ..., \beta_{j,g_j})</code> if <code>model</code> is <code>"GRM"</code>;
</p>
</li>
<li><p><code class="reqn">g+2</code> columns, holding parameters <code class="reqn">(\alpha_j, b_j, c_1, ..., c_g)</code> if <code>model</code> is <code>"MGRM"</code>;
</p>
</li>
<li><p><code class="reqn">\max_j \,g_j</code> columns, holding parameters <code class="reqn">(\delta_{j1}, ..., \delta_{j,g_j})</code>  if <code>model</code> is <code>"PCM"</code>;
</p>
</li>
<li><p><code class="reqn">\max_j \,g_j+1</code> columns, holding parameters <code class="reqn">(\alpha_j, \delta_{j1}, ..., \delta_{j,g_j})</code> if <code>model</code> is <code>"GPCM"</code>;
</p>
</li>
<li><p><code class="reqn">g+1</code> columns, holding parameters <code class="reqn">(\lambda_j, \delta_1, ..., \delta_g)</code> if <code>model</code> is <code>"RSM"</code>;
</p>
</li>
<li><p><code class="reqn">2\,\max_j\, g_j</code> columns, holding parameters <code class="reqn">(\alpha_{j1}, c_{j1}, \alpha_{j2}, c_{j2}, ..., \alpha_{j,g_j}, c_{j, g_j})</code> if <code>model</code> is <code>"NRM"</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Andrich, D. (1978). A rating formulation for ordered response categories. <em>Psychometrika, 43</em>, 561-573. doi: 10.1007/BF02293814
</p>
<p>Bock, R. D. (1972). Estimating item parameters and latent ability when responses are scored in two or more nominal categories. <em>Psychometrika, 37</em>, 29-51. doi: 10.1007/BF02291411
</p>
<p>Embretson, S. E., and Reise, S. P. (2000). <em>Item response theory for psychologists</em>. Mahwah, NJ: Lawrence Erlbaum Associates.
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>
<p>Masters, G. N. (1982). A Rasch model for partial credit scoring. <em>Psychometrika, 47</em>, 149-174. doi: 10.1007/BF02296272
</p>
<p>Muraki, E. (1990). Fitting a polytomous item response model to Likert-type data. <em>Applied Psychological Measurement, 14</em>, 59-71. doi: 10.1177/014662169001400106
</p>
<p>Muraki, E. (1992). A generalized partial credit model: Application of an EM algorithm. <em>Applied Psychological Measurement, 16</em>, 19-176. doi: 10.1177/014662169201600206
</p>
<p>Samejima, F. (1969). <em>Estimation of latent ability using a response pattern of graded scores</em>. Psychometrika Monograph (vol. 17).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Pi">Pi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# All generated item banks have 10 items and at most four response categories

 # GRM 
 genPolyMatrix(10, 4, model = "GRM")

 # GRM with same number of response categories
 genPolyMatrix(10, 4, model = "GRM", same.nrCat = TRUE)

 # MGRM 
 genPolyMatrix(10, 4, model = "MGRM")

 # MGRM with same number of response categories
 genPolyMatrix(10, 4, model = "MGRM", same.nrCat = TRUE) # same result

 # PCM 
 genPolyMatrix(10, 4, model = "PCM")

 # PCM with same number of response categories
 genPolyMatrix(10, 4, model = "PCM", same.nrCat = TRUE) 

 # GPCM 
 genPolyMatrix(10, 4, model = "GPCM")

 # GPCM with same number of response categories
 genPolyMatrix(10, 4, model = "GPCM", same.nrCat = TRUE) 

 # RSM 
 genPolyMatrix(10, 4, model = "RSM")

 # RSM with same number of response categories
 genPolyMatrix(10, 4, model = "RSM", same.nrCat = TRUE) # same result

 # NRM 
 genPolyMatrix(10, 4, model = "NRM")

 # NRM with same number of response categories
 genPolyMatrix(10, 4, model = "NRM", same.nrCat = TRUE)  
 </code></pre>

<hr>
<h2 id='Ii'>Item information functions, first and second derivatives (dichotomous and polytomous models)</h2><span id='topic+Ii'></span>

<h3>Description</h3>

<p>This command returns the Fisher information functions for a given ability value and a given matrix of item parameters under either the 4PL model or any suitable polytomous model. Numerical values of the first and second derivatives of the item information functions are also returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ii(th, it, model = NULL, D = 1)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ii_+3A_th">th</code></td>
<td>
<p>numeric: the ability value.</p>
</td></tr>
<tr><td><code id="Ii_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Ii_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Ii_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The first and second derivatives are computed algebraically, either from the four-parameter logistic (4PL) model
(Barton and Lord, 1981) or from the corresponding polytomous model. These derivatives are necessary for both the estimation of ability and the computation of related standard errors. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>


<h3>Value</h3>

<p>A list with three arguments:
</p>
<table>
<tr><td><code>Ii</code></td>
<td>
<p>the vector with item informations (one value per item).</p>
</td></tr>
<tr><td><code>dIi</code></td>
<td>
<p>the vector with first derivatives of the item information functions (one value per item).</p>
</td></tr>
<tr><td><code>d2Ii</code></td>
<td>
<p>the vector with second derivatives of the item information functions (one value per item).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University.
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R 
Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Pi">Pi</a></code>, <code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##
 
 # Generation of an item bank under 3PL with 100 items 
 m.3PL &lt;- genDichoMatrix(100, model = "3PL")
 m.3PL &lt;- as.matrix(m.3PL)
 
 # Item information functions and derivatives
 # (various th and D values)
 Ii(th = 0, m.3PL)
 Ii(th = 0, m.3PL, D = 1.702)
 Ii(th = 1, m.3PL)

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Computation of item information and derivatives for ability level 0
 Ii(0, m.GRM, model = "GRM")

 # Generation of a item bank under PCM with 20 items and at most 3 categories
 m.PCM &lt;- genPolyMatrix(20, 3, "PCM")
 m.PCM &lt;- as.matrix(m.PCM)

 # Computation of item information and derivatives for ability level 1
 Ii(1, m.PCM, model = "PCM")
 </code></pre>

<hr>
<h2 id='integrate.mstR'>Numerical integration by linear interpolation (for mstR internal use)</h2><span id='topic+integrate.mstR'></span>

<h3>Description</h3>

<p>This command computes the integral of function <em>f(x)</em> by providing values of <em>x</em> and <em>f(x)</em>, similarly to the <code>integrate.xy</code> function of the R package <code>sfsmisc</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate.mstR(x, y)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integrate.mstR_+3A_x">x</code></td>
<td>
<p>numeric: a vector of <em>x</em> values for numerical integration.</p>
</td></tr>
<tr><td><code id="integrate.mstR_+3A_y">y</code></td>
<td>
<p>numeric: a vector of numerical values corresponding to <em>f(x)</em> values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function was written to compute &quot;cheap&quot; numerical integration by providing sequences of <em>x</em> values and corresponding computed values <em>f(x)</em>. It works similarly as the <code>integrate.xy</code> function when <code>use.spline=FALSE</code> is required. It was developed internally to eventually remove dependency of <code>mstR</code> package to package <code>sfsmisc</code>.
</p>


<h3>Value</h3>

<p>The approximated integral.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Maechler, M. et al. (2012). <em>sfsmisc: Utilities from Seminar fuer Statistik ETH Zurich</em>. R package version 1.0-23.
http://CRAN.R-project.org/package=sfsmisc
</p>


<h3>See Also</h3>

<p>The <code>integrate.xy</code> function in package <code>sfsmisc</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  x &lt;- seq(from = -4, to = 4, length = 33)
 y &lt;- exp(x)
 integrate.mstR(x, y) # 54.86381

## Not run: 

 # Comparison with integrate.xy
 require(sfsmisc)
 integrate.xy(x, y, use.spline = FALSE) # 54.86381
 integrate.xy(x, y) # 54.58058
 
## End(Not run)
</code></pre>

<hr>
<h2 id='Ji'>Function <code class="reqn">J(\theta)</code> for weighted likelihood estimation (dichotomous and polytomous IRT models)</h2><span id='topic+Ji'></span>

<h3>Description</h3>

<p>This command returns the <code class="reqn">J(\theta)</code> function that is necessary to obtain the weighted likelihood estimation of ability with dichotomous and polytomous IRT models, as well as its asymptotic standard error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ji(th, it, model = NULL, D = 1)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Ji_+3A_th">th</code></td>
<td>
<p>numeric: the ability value.</p>
</td></tr>
<tr><td><code id="Ji_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Ji_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Ji_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The <code class="reqn">J(\theta)</code> fucntion is defined by (Samejima, 1998):
</p>
<p style="text-align: center;"><code class="reqn">J(\theta)=\sum_{j=1}^n \,\sum_{k=0}^{g_j} \frac{P_{jk}'(\theta)\,P_{jk}''(\theta)}{P_{jk}(\theta)}</code>
</p>

<p>where <code class="reqn">n</code> is the number of items; <code class="reqn">g_j</code> the number of response categories for item <em>j</em> (<code class="reqn">j=1, ..., n</code>); <code class="reqn">P_{jk}(\theta)</code> the response category probabilities and <code class="reqn">P_{jk}'(\theta)</code> and <code class="reqn">P_{jk}''(\theta)</code> the first and second derivatives with respect to <code class="reqn">\theta</code>. In case of dichotomous IRT models, this reduces to (Warm, 1989):
</p>
<p style="text-align: center;"><code class="reqn">J(\theta)=\sum_{j=1}^n \frac{P_j'(\theta)\,P_j''(\theta)}{P_j(\theta)\,Q_j(\theta)}</code>
</p>

<p>with <code class="reqn">Q_j(\theta)=1-P_j(\theta)</code>.
</p>
<p>This function is useful to compute the weighted likelihood estimates of ability with dichotomous and polytomous IRT models as well as their related asymptotic standard errors. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>


<h3>Value</h3>

<p>A list with two arguments:
</p>
<table>
<tr><td><code>Ji</code></td>
<td>
<p>the vector with <code class="reqn">J(\theta)</code> values (one value per item).</p>
</td></tr>
<tr><td><code>dJi</code></td>
<td>
<p>the vector with first derivatives of the <code class="reqn">J(\theta)</code> values (one value per item).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>
<p>Samejima, F. (1998, April). <em>Expansion of Warm's weighted likelihood estimator of ability for the three-parameter logistic model to generate discrete responses.</em> PPaper presented at the annual meeting of the National Council on Measurement in Education, San Diego, CA.
</p>
<p>Warm, T.A. (1989). Weighted likelihood estimation of ability in item response models. <em>Psychometrika, 54</em>, 427-450. doi: 10.1007/BF02294627
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+semTheta">semTheta</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##
 
 # Generation of an item bank under 3PL with 100 items 
 m.3PL &lt;- genDichoMatrix(100, model = "3PL")
 m.3PL &lt;- as.matrix(m.3PL)
 
 # Various J functions and derivatives
 # (various th and D values)
 Ji(th = 0, m.3PL)
 Ji(th = 0, m.3PL, D = 1.702)
 Ji(th = 1, m.3PL)

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Computation of J function and derivatives for ability level 0
 Ji(0, m.GRM, model = "GRM")

 # Generation of a item bank under PCM with 20 items and at most 3 categories
 m.PCM &lt;- genPolyMatrix(20, 3, "PCM")
 m.PCM &lt;- as.matrix(m.PCM)

 # Computation of J function and derivatives for ability level 1
 Ji(1, m.PCM, model = "PCM")
 </code></pre>

<hr>
<h2 id='MKL'>Module Kullback-Leibler (MKL) and posterior module Kullback-Leibler (MKLP)</h2><span id='topic+MKL'></span>

<h3>Description</h3>

<p>This command returns the value of the Kullback-Leibler (MKL) or the posterior Kullback-Leibler (MKLP) weighted likelihood for a given target module and an item bank (both under dichotomous and polytomous IRT models).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MKL(itemBank, modules, target.mod, theta = NULL, it.given, x, model = NULL, 
    lower = -4, upper = 4, nqp = 33, type = "MKL", priorDist = "norm", 
    priorPar = c(0, 1), D = 1)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MKL_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MKL_+3A_modules">modules</code></td>
<td>
<p>a binary matrix that specifies the item membership to th emodules. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MKL_+3A_target.mod">target.mod</code></td>
<td>
<p>numeric: the module (referred to as its column number in the <code>modules</code> matrix) for which the information must be computed.</p>
</td></tr>
<tr><td><code id="MKL_+3A_theta">theta</code></td>
<td>
<p>either the provisional ability level or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MKL_+3A_it.given">it.given</code></td>
<td>
<p>numeric: a vector of item indicators for all previously administered items.</p>
</td></tr>
<tr><td><code id="MKL_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses, coded as 0 or 1 only (for dichotomous items) or from 0 to the number of response categories minus one (for polytomous items). The length of <code>x</code> must be equal to the length of <code>it.given</code>.</p>
</td></tr>
<tr><td><code id="MKL_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MKL_+3A_lower">lower</code></td>
<td>
<p>numeric: the lower bound for numerical integration (default is -4).</p>
</td></tr>
<tr><td><code id="MKL_+3A_upper">upper</code></td>
<td>
<p>numeric: the upper bound for numerical integration (default is 4).</p>
</td></tr>
<tr><td><code id="MKL_+3A_nqp">nqp</code></td>
<td>
<p>numeric: the number of quadrature points (default is 33).</p>
</td></tr>
<tr><td><code id="MKL_+3A_type">type</code></td>
<td>
<p>character: the type of Kullback-Leibler information to be computed. Possible values are <code>"MKL"</code> (default) and <code>"MKLP"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MKL_+3A_priordist">priorDist</code></td>
<td>
<p>character: the prior ability distribution. Possible values are <code>"norm"</code> (default) for the normal distribution, and <code>"unif"</code> for the uniform distribution. Ignored if <code>type</code> is not <code>"MPWI"</code>.</p>
</td></tr>
<tr><td><code id="MKL_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: a vector of two components with the prior parameters. If <code>priorDist</code> is <code>"norm"</code>, then <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then <code>priorPar</code> contains the bounds of the uniform distribution. The default values are 0 and 1 respectively. Ignored if <code>type</code> is not <code>"MPWI"</code>.</p>
</td></tr>
<tr><td><code id="MKL_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function extends the KL and the KLP methods to select the next item in CAT, to the MST framework. This command serves as a subroutine for the <code><a href="#topic+nextModule">nextModule</a></code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>itemBank</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>FROM HERE
</p>
<p>Under polytomous IRT models, let <em>k</em> be the number of administered items, and set <code class="reqn">x_1, ..., x_k</code> as the provisional response pattern (where each response <code class="reqn">x_l</code> takes values in <code class="reqn">\{0, 1, ..., g_l\}</code>). Set <code class="reqn">\hat{\theta}_k</code> as the provisional ability estimate (with the first <em>k</em> responses). Set <code class="reqn">M</code> as the number of items in the target module of interest (not yet administered). Set also <code class="reqn">L(\theta | x_1, ..., x_k) </code> as the likelihood function of the first <code class="reqn">k</code> items and evaluated at <code class="reqn">\theta</code>. Set finally <code class="reqn">P_{jt}(\theta)</code> as the probability of answering response category <em>t</em> to item <em>j</em> of the target module (<code class="reqn">j = 1, ..., M</code>) for a given ability level <code class="reqn">\theta</code>. Then, module Kullack-Leibler (MKL) information is defined as
</p>
<p style="text-align: center;"><code class="reqn">MKL(\theta || \hat{\theta}_k) = \sum_{j=1}^{M} \sum_{t=0}^{g_j} \,P_{jt}(\hat{\theta}_k) \,\log \left( \frac{P_{jt}(\hat{\theta}_k)}{P_{jt}(\theta)}\right).</code>
</p>

<p>In case of dichotomous IRT models, all <code class="reqn">g_l</code> values reduce to 1, so that item responses <code class="reqn">x_l</code> equal either 0 or 1. Set simply <code class="reqn">P_j(\theta)</code> as the probability of answering item <em>j</em> correctly (<code class="reqn">j = 1, ..., M</code>) for a given ability level <code class="reqn">\theta</code>. Then, MKL information reduces to
</p>
<p style="text-align: center;"><code class="reqn">MKL(\theta || \hat{\theta}) = \sum_{j=1}^{M} \left\{P_j(\hat{\theta}) \,\log \left( \frac{P_j(\hat{\theta}_k)}{P_j(\theta)}\right) + [1-P_j(\hat{\theta}_k)] \,\log \left( \frac{1-P_j(\hat{\theta}_k)}{1-P_j(\theta)}\right) \right\}.</code>
</p>

<p>The quantity that is returned by this <code>MKL</code> function is either: the likelihood function weighted by module Kullback-Leibler information (the MKL value):
</p>
<p style="text-align: center;"><code class="reqn">MKL(\hat{\theta}_k) = \int MKL(\theta || \hat{\theta}_k) \, L(\theta | x_1, ..., x_k) \,d\theta</code>
</p>

<p>or the posterior function weighted by module Kullback-Leibler information (the MKLP value):
</p>
<p style="text-align: center;"><code class="reqn">MKLP(\hat{\theta}) = \int MKL(\theta || \hat{\theta}_k) \, \pi(\theta) \,L(\theta | x_1, ..., x_k) \,d\theta</code>
</p>

<p>where <code class="reqn">\pi(\theta)</code> is the prior distribution of the ability level.
</p>
<p>These integrals are approximated by the <code><a href="#topic+integrate.mstR">integrate.mstR</a></code> function. The range of integration is set up 
by the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code>, giving respectively the lower bound, the upper bound and the number of quadrature points. The default range goes from -4 to 4 with length 33 (that is, by steps of 0.25).
</p>
<p>The argument <code>type</code> defines the type of information to be computed. The default value, <code>"MKL"</code>, computes the MKL value, while the MKLP value is obtained with <code>type="MKLP"</code>. For the latter, the <code>priorDist</code> and <code>priorPar</code> arguments fix the prior ability distribution. 
The normal distribution is set up by <code>priorDist="norm"</code> and then, <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then the uniform distribution is considered, and <code>priorPar</code> fixes the lower and upper bounds of that 
uniform distribution. By default, the standard normal prior distribution is assumed. This argument is ignored whenever <code>method</code> is not <code>"MKLP"</code>.
</p>
<p>The provisional response pattern and the related administered items are provided by the vectors <code>x</code> and <code>it.given</code> respectively. The target module (for which the maximum information is computed) is given by its column number in the <code>modules</code> matrix, through the <code>target.mod</code> argument. 
</p>
<p>The provisioal (ad-interim) ability level can be provided through the <code>theta</code> argument. If not provided or set to <code>NULL</code> (default value), it is then internally computed as the ML estimate of ability for the given response pattern <code>x</code> and the previously administered items <code>it.given</code>.
</p>


<h3>Value</h3>

<p>The required KL (or KLP) weighted module likelihood for the target module.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ii">Ii</a></code>, <code><a href="#topic+nextModule">nextModule</a></code>, <code><a href="#topic+integrate.mstR">integrate.mstR</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Generation of an item bank under 2PL, made of 7 successive modules that target
 # different average ability levels and with different lengths
 # (the first generated item parameters hold two modules of 8 items each)
 it &lt;- rbind(genDichoMatrix(16, model = "2PL"),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", -1, 1)),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", 1, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", -2, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 0, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 2, 1)))
 it &lt;- as.matrix(it)

 # Creation of the 'module' matrix to list item membership in each module
 modules &lt;- matrix(0, 55, 7)
 modules[1:8, 1] &lt;- modules[9:16, 2] &lt;- modules[17:22, 3] &lt;- 1
 modules[23:28, 4] &lt;- modules[29:37, 5] &lt;- modules[38:46, 6] &lt;- 1
 modules[47:55, 7] &lt;- 1

 # Creation of the response pattern for module 1 and true ability level 0
 x &lt;- genPattern(th = 0, it = it[1:8,], seed = 1)

 # MKL for module 3
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x)

 # Same with pre-estimation of ability by ML (same result)
 th &lt;- thetaEst(it[1:8,], x, method = "ML") 
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x, theta = th)

 # Same with pre-estimation of ability by EAP (different result)
 th &lt;- thetaEst(it[1:8,], x, method = "EAP") 
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x, theta = th)

 # MKLP for module 3
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x, type = "MKLP")

 # MKL for for module 3, different integration range
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x, lower = -2, upper = 2, nqp = 20)

 # MKLP for module 3, uniform prior distribution on the range [-2,2]
 MKL(it, modules, target.mod = 3, it.given = 1:8, x = x, type = "MKLP", 
     priorDist = "unif", priorPar = c(-2, 2))


## Polytomous models ##

 # Same structure as above but parameters are now generated from PCM with at most
 # 4 categories
 it.pol &lt;- genPolyMatrix(55, model = "PCM", nrCat = 4)
 it.pol &lt;- as.matrix(it)

 # Creation of the response pattern for module 1 and true ability level 0
 x &lt;- genPattern(th = 0, it = it.pol[1:8,], seed = 1)

# MKL for module 3
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, model = "PCM")

 # Same with pre-estimation of ability by ML (same result)
 th &lt;- thetaEst(it.pol[1:8,], x, method = "ML", model = "PCM") 
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, theta = th, 
     model = "PCM")

 # Same with pre-estimation of ability by EAP (different result)
 th &lt;- thetaEst(it.pol[1:8,], x, method = "EAP", model = "PCM") 
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, theta = th, 
     model = "PCM")

 # MKLP for module 3
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, type = "MKLP", 
     model = "PCM")

 # MKL for for module 3, different integration range
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, lower = -2, 
     upper = 2, nqp = 20, model = "PCM")

 # MKLP for module 3, uniform prior distribution on the range [-2,2]
 MKL(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, type = "MKLP", 
     priorDist = "unif", priorPar = c(-2, 2), model = "PCM")
 </code></pre>

<hr>
<h2 id='MWMI'>Maximum likelihood weighted module information (MLWMI) and maximum posterior weighted module information (MPWMI)</h2><span id='topic+MWMI'></span>

<h3>Description</h3>

<p>This command returns the value of the likelihood (MLWMI) or the posterior (MPWMI) weighted module information for a given module and an item bank (both under dichotomous and polytomous IRT models).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MWMI(itemBank, modules, target.mod, it.given, x, model = NULL, lower = -4, 
    upper = 4, nqp = 33, type = "MLWMI", priorDist = "norm", priorPar = c(0, 1), 
    D = 1)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MWMI_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MWMI_+3A_modules">modules</code></td>
<td>
<p>a binary matrix that specifies the item membership to th emodules. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MWMI_+3A_target.mod">target.mod</code></td>
<td>
<p>numeric: the module (referred to as its column number in the <code>modules</code> matrix) for which the information must be computed.</p>
</td></tr>
<tr><td><code id="MWMI_+3A_it.given">it.given</code></td>
<td>
<p>numeric: a vector of item indicators for all previously administered items.</p>
</td></tr>
<tr><td><code id="MWMI_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses, coded as 0 or 1 only (for dichotomous items) or from 0 to the number of response categories minus one (for polytomous items). The length of <code>x</code> must be equal to the length of <code>it.given</code>.</p>
</td></tr>
<tr><td><code id="MWMI_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MWMI_+3A_lower">lower</code></td>
<td>
<p>numeric: the lower bound for numerical integration (default is -4).</p>
</td></tr>
<tr><td><code id="MWMI_+3A_upper">upper</code></td>
<td>
<p>numeric: the upper bound for numerical integration (default is 4).</p>
</td></tr>
<tr><td><code id="MWMI_+3A_nqp">nqp</code></td>
<td>
<p>numeric: the number of quadrature points (default is 33).</p>
</td></tr>
<tr><td><code id="MWMI_+3A_type">type</code></td>
<td>
<p>character: the type of information to be computed. Possible values are <code>"MLWMI"</code> (default) and <code>"MPWMI"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="MWMI_+3A_priordist">priorDist</code></td>
<td>
<p>character: the prior ability distribution. Possible values are <code>"norm"</code> (default) for the normal distribution, and <code>"unif"</code> for the uniform distribution. Ignored if <code>type</code> is not <code>"MPWI"</code>.</p>
</td></tr>
<tr><td><code id="MWMI_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: a vector of two components with the prior parameters. If <code>priorDist</code> is <code>"norm"</code>, then <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then <code>priorPar</code> contains the bounds of the uniform distribution. The default values are 0 and 1 respectively. Ignored if <code>type</code> is not <code>"MPWI"</code>.</p>
</td></tr>
<tr><td><code id="MWMI_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function extends the MLWI and the MPWI methods to select the next item in CAT, to the MST framework. This command serves as a subroutine for the <code><a href="#topic+nextModule">nextModule</a></code> function.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>itemBank</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Under polytomous IRT models, let <em>k</em> be the number of administered items, and set <code class="reqn">x_1, ..., x_k</code> as the provisional response pattern (where each response <code class="reqn">x_l</code> takes values in <code class="reqn">\{0, 1, ..., g_l\}</code>). Set also
<code class="reqn">I(\theta)</code> as the information function of the module of interest (specified through <code>target.mod</code>), made by the sum of all item informations functions from this module, and evaluated at <code class="reqn">\theta</code>. Set finally <code class="reqn">L(\theta | x_1, ..., x_k)</code> as the likelihood function evaluated at <code class="reqn">\theta</code>, given the provisional response pattern. Then, the LWMI for the module is given by
</p>
<p style="text-align: center;"><code class="reqn">LWMI = \int I(\theta) L(\theta | x_1, ..., x_k) d\theta</code>
</p>
<p> and the PWMI by  
</p>
<p style="text-align: center;"><code class="reqn">PWMI = \int I(\theta) \pi(\theta) L(\theta | x_1, ..., x_k) d\theta</code>
</p>
 
<p>where <code class="reqn">\pi(\theta)</code> is the prior distribution of the ability level. 
</p>
<p>In case of dichotomous IRT models, all <code class="reqn">g_l</code> values reduce to 1, so that item responses <code class="reqn">x_l</code> equal either 0 or 1. But except from this difference, the previous definitions of LWI and PWI remain valid.
</p>
<p>These integrals are approximated by the <code><a href="#topic+integrate.mstR">integrate.mstR</a></code> function. The range of integration is set up 
by the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code>, giving respectively the lower bound, the upper bound and the number of quadrature points. The default range goes from -4 to 4 with length 33 (that is, by steps of 0.25).
</p>
<p>The argument <code>type</code> defines the type of information to be computed. The default value, <code>"MLWMI"</code>, computes the MLWMI value, while the MPWMI value is obtained with <code>type="MPWMI"</code>. For the latter, the <code>priorDist</code> and <code>priorPar</code> arguments fix the prior ability distribution. 
The normal distribution is set up by <code>priorDist="norm"</code> and then, <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then the uniform distribution is considered, and <code>priorPar</code> fixes the lower and upper bounds of that 
uniform distribution. By default, the standard normal prior distribution is assumed. This argument is ignored whenever <code>method</code> is not <code>"MPWMI"</code>.
</p>
<p>The provisional response pattern and the related administered items are provided by the vectors <code>x</code> and <code>it.given</code> respectively. The target module (for which the maximum information is computed) is given by its column number in the <code>modules</code> matrix, through the <code>target.mod</code> argument. 
</p>


<h3>Value</h3>

<p>The required (likelihood or posterior) weighted module information for the selected module.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ii">Ii</a></code>, <code><a href="#topic+nextModule">nextModule</a></code>, <code><a href="#topic+integrate.mstR">integrate.mstR</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Generation of an item bank under 2PL, made of 7 successive modules that target
 # different average ability levels and with different lengths
 # (the first generated item parameters hold two modules of 8 items each)
 it &lt;- rbind(genDichoMatrix(16, model = "2PL"),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", -1, 1)),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", 1, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", -2, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 0, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 2, 1)))
 it &lt;- as.matrix(it)

 # Creation of the 'module' matrix to list item membership in each module
 modules &lt;- matrix(0, 55, 7)
 modules[1:8, 1] &lt;- modules[9:16, 2] &lt;- modules[17:22, 3] &lt;- 1
 modules[23:28, 4] &lt;- modules[29:37, 5] &lt;- modules[38:46, 6] &lt;- 1
 modules[47:55, 7] &lt;- 1

 # Creation of the response pattern for module 1 and true ability level 0
 x &lt;- genPattern(th = 0, it = it[1:8,], seed = 1)

 # MLWMI for module 3
 MWMI(it, modules, target.mod = 3, it.given = 1:8, x = x)

 # MPWMI for module 3
 MWMI(it, modules, target.mod = 3, it.given = 1:8, x = x, type = "MPWMI")

 # MLWMI for for module 3, different integration range
 MWMI(it, modules, target.mod = 3, it.given = 1:8, x = x, lower = -2, upper = 2, nqp = 20)

 # MPWI for module 3, uniform prior distribution on the range [-2,2]
 MWMI(it, modules, target.mod = 3, it.given = 1:8, x = x, type = "MPWMI", 
     priorDist = "unif", priorPar = c(-2, 2))


## Polytomous models ##

 # Same structure as above but parameters are now generated from PCM with at most
 # 4 categories
 it.pol &lt;- genPolyMatrix(55, model = "PCM", nrCat = 4)
 it.pol &lt;- as.matrix(it)

 # Creation of the response pattern for module 1 and true ability level 0
 x &lt;- genPattern(th = 0, it = it.pol[1:8,], seed = 1)

# MLWMI for module 3
 MWMI(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, model = "PCM")

 # MPWMI for module 3
 MWMI(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, type = "MPWMI", 
     model = "PCM")

 # MLWMI for for module 3, different integration range
 MWMI(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, lower = -2, 
     upper = 2, nqp = 20, model = "PCM")

 # MPWI for module 3, uniform prior distribution on the range [-2,2]
 MWMI(it.pol, modules, target.mod = 3, it.given = 1:8, x = x, type = "MPWMI", 
     priorDist = "unif", priorPar = c(-2, 2), model = "PCM")
 </code></pre>

<hr>
<h2 id='nextModule'>Selection of the next module in MST</h2><span id='topic+nextModule'></span>

<h3>Description</h3>

<p>This command selects the next module to be administered in the multistage test, either bases on IRT scoring or on test score and by either providing thresholds or optimally selecting the next module. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nextModule(itemBank, modules, transMatrix, model = NULL, current.module,
   out, x = NULL, cutoff = NULL, theta = 0, criterion = "MFI",
   priorDist = "norm", priorPar = c(0, 1), D = 1, range = c(-4, 4), 
   parInt = c(-4, 4, 33), randomesque = 1, random.seed = NULL)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nextModule_+3A_itembank">itemBank</code></td>
<td>
<p>a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_modules">modules</code></td>
<td>
<p>a binary matrix that specifies the item membership to the modules. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_transmatrix">transMatrix</code></td>
<td>
<p>a binary squared matrix representing the structure of the MST and the transitions between the moduels and the stages. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_current.module">current.module</code></td>
<td>
<p>integer: the module number (defined as the corresponding column number in the <code>modules</code> matrix) that indicates the last administered module.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_out">out</code></td>
<td>
<p>numeric: the vector of item indicators (defined as the row numbers in the <code>itemBank</code> matrix) of previously administered items.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_x">x</code></td>
<td>
<p>either a numeric vector of responses to previously administered items or <code>NULL</code> (default). Ignored if <code>criterion</code> is either <code>MFI</code> or <code>random</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_cutoff">cutoff</code></td>
<td>
<p>either a suitable matrix of cut-off values or <code>NULL</code> (default). See <code>Details</code>.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_theta">theta</code></td>
<td>
<p>numeric: the current ability level for selecting the next module (default is 0). It can also hold the current test score made of the sum of responses to all administered items (when <code>cutoff</code> is provided). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_criterion">criterion</code></td>
<td>
<p>character: the method for next item selection. Possible values are <code>"MFI"</code> (default), <code>"MLWMI"</code>, <code>"MPWMI"</code>, <code>"MKL"</code>, <code>"MKLP"</code> and <code>"random"</code>. Ignored if <code>cutoff</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr> 
<tr><td><code id="nextModule_+3A_priordist">priorDist</code></td>
<td>
<p>character: the prior ability distribution. Possible values are <code>"norm"</code> (default) for the normal distribution, and <code>"unif"</code> for the uniform distribution. Ignored if <code>criterion</code> is neither <code>"MPWMI"</code> nor <code>"KLP"</code>, or if <code>cutoff</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: a vector of two components with the prior parameters. If <code>priorDist</code> is <code>"norm"</code>, then <code>priorPar</code> contains the mean and the standard deviation of the normal distribution. If <code>priorDist</code> is <code>"unif"</code>, then <code>priorPar</code> contains the bounds of the uniform distribution. The default values are 0 and 1 respectively. Ignored if <code>criterion</code> is neither <code>"MPWI"</code> nor <code>"KLP"</code>, or if <code>cutoff</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952).</p>
</td></tr>
<tr><td><code id="nextModule_+3A_range">range</code></td>
<td>
<p>numeric: vector of two components specifying the range wherein the ability estimate must be looked for (default is <code>c(-4,4)</code>).</p>
</td></tr>
<tr><td><code id="nextModule_+3A_parint">parInt</code></td>
<td>
<p>numeric: a vector of three numeric values, specifying respectively the lower bound, the upper bound and the number of quadrature points for numerical integration (default is <code>c(-4,4,33)</code>). Ignored if <code>method</code> is neither <code>"MLWMI"</code>, <code>"MPWMI"</code>, <code>"KL"</code>, nor <code>"KLP"</code>, or if <code>cutoff</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_randomesque">randomesque</code></td>
<td>
<p>numeric: a probability value to select the optimal module. Default is one so optimal module is always chosen. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nextModule_+3A_random.seed">random.seed</code></td>
<td>
<p>either <code>NULL</code> (default) or a numeric value to fix the random seed of randomesque selection of the module. Ignored if <code>randomesque</code> is equal to one.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function permits to select the next module of the MST. It works with both dichotomous and polytomous item banks.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The <code>modules</code> argument must be a binary 0/1 matrix with as many rows as the item bank <code>itemBank</code> and as many columns as the number of modules. Values of 1 indicate to which module(s) the items belong to, i.e. a value of 1 on row <em>i</em> and column <em>j</em> means that the <em>i</em>-th item belongs to the <em>j</em>-th module.
</p>
<p>The <code>transMatrix</code> argument must be a binary 0/1 square matrix with as many rows (and columns) as the number of modules. All values of 1 indicate the possible transitions from one module to another, i.e. a value of 1 on row <em>i</em> and column <em>j</em> means that the MST can move from <em>i</em>-th module to <em>j</em>-th module.
</p>
<p>The two main approaches to select the next module are based on cut-off scores (to be provided) or by optimal module selection.
</p>
<p>Optimal module selection is performed by providing an appropriate value to the <code>criterion</code> argument. Possible methods are: 
</p>

<ol>
<li><p><code>"MFI"</code> for maximum Fisher information(default);
</p>
</li>
<li><p><code>"MLWMI"</code> for maximum likelihood weighted module information;
</p>
</li>
<li><p><code>"MPWMI"</code> for maximum posterior weighted module information;
</p>
</li>
<li><p><code>"MKL"</code> for module Kullabck-Leibler selection;
</p>
</li>
<li><p><code>"MKLP"</code> for module posterior Kullabck-Leibler selection;
</p>
</li>
<li><p><code>"random"</code> for random selection.
</p>
</li></ol>

<p>See <code><a href="#topic+MWMI">MWMI</a></code> and <code><a href="#topic+MKL">MKL</a></code> for further details.
</p>
<p>In case of selection by predefined cut-off scores, the <code>cutoff</code> argument must be supplied by a matrix with as many rows as the number of thresholds between pairs of modules, and with three columns. Each row of the <code>cutoff</code> matrix holds first the two module indicators (i.e., their column number in the <code>modules</code> matrix) and then the threshold. For instance, the row <code>c(3, 4, 1)</code> indicates that the selection threshold between modules 3 and 4 is 1. Thus, if the next module must be chosen between modules 3 and 4, the module 3 is selected if the score is <em>strictly smaller</em> than 1, and module 4 is chosen if the score is gretar than or equal to 1.
</p>
<p>This allows the selection among multiple modules within a stage as follows. Let modules 5 to 7 be the allowed moduels for selection, and set -1 and 1 as thresholds to distinguish between modules 5 and 6 and modules 6 and 7. By this way, module 5 is chosen if the score is strictly smaller than -1, module 7 if the score is larger than (or equal to) 1, and module 6 otherwise. This design is simply modeled through the <code>cutoff</code> matrix by including the rows <code>c(5, 6, -1)</code> nd <code>c(6, 7, 1)</code>. Note that the order of the rows in the <code>cutoff</code> matrix is irrelevant. Moreover, integer cut-off scores (when <code>theta</code> is the test score) or numeric values (when <code>theta</code> is an ability estimate) are allowed in the <code>cutoff</code> matrix.
</p>
<p>By default <code>cutoff</code> is <code>NULL</code> and optimal module selection is performed). 
</p>
<p>Whatever the method for next module selection (by optimal criterion or via cut-off scores), the <code>randomesque</code> argument allows for selecting a module that is not the optimal one. This argument takes a probability value (i.e., between zero and one) that sets the probability that the optimal module is eventually selected. All other elligible modules from the stage will be randomly chosen with a probability equal to (1-<code>randomesque</code>)/<code class="reqn">K-1</code> where <code class="reqn">K</code> is he number of elligible modules in the stage (including the optimal one). This allows for module overexposure control. The <code>random.seed</code> argument permits ot fix the seed for random selection. 
</p>


<h3>Value</h3>

<p>A list with six arguments:
</p>
<table>
<tr><td><code>module</code></td>
<td>
<p>the selected module (identified by its column number in the <code>modules</code> argument.</p>
</td></tr>
<tr><td><code>items</code></td>
<td>
<p>the items that belong to the selected module (identified by their number in the item bank).</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>the matrix of item parameters of the selected items (one row per item).</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>either the provisional ability level or score when <code>cutoff</code> is not <code>NULL</code>; or <code>NA</code> when random selection is performed.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>the value of the <code>criterion</code> argument.</p>
</td></tr>
<tr><td><code>best.module</code></td>
<td>
<p>logical value indicating whether the optimal module was eventually returned or not.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error.</em> 
Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>, <code><a href="#topic+MWMI">MWMI</a></code>, <code><a href="#topic+MKL">MKL</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Generation of an item bank under 2PL, made of 7 successive modules that target
 # different average ability levels and with different lengths
 # (the first generated item parameters hold two modules of 8 items each)
 it &lt;- rbind(genDichoMatrix(16, model = "2PL"),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", -1, 1)),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", 1, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", -2, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 0, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 2, 1)))
 it &lt;- as.matrix(it)

 # Creation of the 'modules' matrix to list item membership in each module
 modules &lt;- matrix(0, 55, 7)
 modules[1:8, 1] &lt;- modules[9:16, 2] &lt;- modules[17:22, 3] &lt;- 1
 modules[23:28, 4] &lt;- modules[29:37, 5] &lt;- modules[38:46, 6] &lt;- 1
 modules[47:55, 7] &lt;- 1

 # Creation of the transition matrix to define a 1-2-3 MST
trans &lt;- matrix(0, 7, 7)
trans[1, 3:4] &lt;- trans[2, 3:4] &lt;- trans[3, 5:7] &lt;- trans[4, 5:7] &lt;- 1

 # Module 1 previously administered, provisional ability 0, MFI criterion
 nextModule(it, modules, trans, current.module = 1, out = 1:8)

 # Generation of item responses for module 1
 x &lt;- genPattern(0, it[1:8,])

 # MLWMI criterion 
 nextModule(it, modules, trans, current.module = 1, out = 1:8, x = x, criterion = "MLWMI")

 # MPWMI criterion
 nextModule(it, modules, trans, current.module = 1, out = 1:8, x = x, criterion = "MPWMI")

 # MKL criterion
 nextModule(it, modules, trans, current.module = 1, out = 1:8, x = x, criterion = "MKL")

 # MKLP criterion
 nextModule(it, modules, trans, current.module = 1, out = 1:8, x = x, criterion = "MKLP")

 # Creation of cut-off scores for ability levels: cut score 0 between modules 3 and 4
 # and cut scores -1 and 1 between modules 5, 6 and 7
 cut &lt;- rbind(c(3, 4, 0), c(5, 6, -1), c(6, 7, 1))

 # Selection by cut-off score, module 1 previously administered, current ability level 0 
 # (=&gt; module 4 is chosen)
 nextModule(it, modules, trans, current.module = 1, out = 1:8, cutoff = cut, theta = 0)

 # Same with current ability level -0.5 (=&gt; module 3 is chosen)
 nextModule(it, modules, trans, current.module = 1, out = 1:8, cutoff = cut, theta = -0.5)

 # Modules 1 and 3 previously administered, current ability level 0 (=&gt; module 6 is chosen)
 nextModule(it, modules, trans, current.module = 3, out = c(1:8, 17:22), cutoff = cut,  
           theta = 0)

 # Same with current ability level 2 (=&gt; module 7 is chosen)
 nextModule(it, modules, trans, current.module = 3, out = c(1:8, 17:22), cutoff = cut, 
           theta = 2)

 # Ranomesque probability 0.5 and random.seed value 2 (=&gt; module 6 is chosen)
 nextModule(it, modules, trans, current.module = 3, out = c(1:8, 17:22), cutoff = cut, 
           theta = 2, randomesque = 0.5, random.seed = 2)

 # Creation of cut-off scores for test scores: cut score 4 between modules 3 and 4
 # and cut scores 5 and 9 between modules 5, 6 and 7
 cut.score &lt;- rbind(c(3, 4, 4), c(5, 6, 5), c(6, 7, 9))

 # Module 1 previously administered, current test score 1 (=&gt; module 3 is chosen)
 nextModule(it, modules, trans, current.module = 1, out = 1:8, cutoff = cut.score, 
           theta = 1)

 # Modules 1 and 3 previously administered, current tes score 6 (=&gt; module 6 is chosen)
 nextModule(it, modules, trans, current.module = 3, out = c(1:8, 17:22), cutoff = cut.score, 
           theta = 6)


## Polytomous models ##

 # Same structure as above but parameters are now generated from PCM with at most
 # 4 categories
 it.pol &lt;- genPolyMatrix(55, model = "PCM", nrCat = 4)
 it.pol &lt;- as.matrix(it)

 # Module 1 previously administered, provisional ability 0, MFI criterion
 nextModule(it.pol, modules, trans, model = "PCM", current.module = 1, out = 1:8)

 # MLWMI criterion 
 nextModule(it.pol, modules, trans, model = "PCM", current.module = 1, out = 1:8, x = x, 
           criterion = "MLWMI")

# MKL criterion 
 nextModule(it.pol, modules, trans, model = "PCM", current.module = 1, out = 1:8, x = x, 
           criterion = "MKL")

# MKLP criterion 
 nextModule(it.pol, modules, trans, model = "PCM", current.module = 1, out = 1:8, x = x, 
           criterion = "MKLP")

# Selection by cut-off score, module 1 previously administered, current ability level 0 
 # (=&gt; module 4 is chosen)
 nextModule(it.pol, modules, trans, model = "PCM", current.module = 1, out = 1:8, 
           cutoff = cut, theta = 0)
  </code></pre>

<hr>
<h2 id='Pi'>Item response probabilities, first, second and third derivatives (dichotomous and polytomous models)</h2><span id='topic+Pi'></span>

<h3>Description</h3>

<p>This command returns the item response probabilities for a given ability value and a given matrix of item parameters under either the 4PL model or any suitable polytomous model. Numerical values of the first, second and third derivatives of the response probabilities are also returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pi(th, it, model = NULL, D = 1)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pi_+3A_th">th</code></td>
<td>
<p>numeric: the ability value.</p>
</td></tr>
<tr><td><code id="Pi_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Pi_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="Pi_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Whatever the IRT model, the response probabilities and first, second, and third derivatives are computed algebraically. These derivatives are necessary for both the estimation of ability and the computation of related standard errors. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model (Samejima, 1969), <code>"MGRM"</code> for Modified Graded Response Model (Muraki, 1990), <code>"PCM"</code> for Partical Credit Model (Masters, 1982), <code>"GPCM"</code> for Generalized Partial Credit Model (Muraki, 1992), <code>"RSM"</code> for Rating Scale Model (Andrich, 1978) and <code>"NRM"</code> for Nominal Response Model (Bock, 1972). The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The output list contains the response probabilities and the respective derivatives. In case of dichotomous models, only a vector of such values is returned, with one value per item. In case of polytomous models, matrices are returned instead, with one row per item and one column per response category. In case of unequal numbers of response categories (which may happen under GRM, PCM, GPCM and NRM), values for empty response categories are returned as <code>NA</code> values.
</p>


<h3>Value</h3>

<p>Under dichotomous IRT models, a list with four arguments:
</p>
<table>
<tr><td><code>Pi</code></td>
<td>
<p>the vector with response probabilities (one value per item).</p>
</td></tr>
<tr><td><code>dPi</code></td>
<td>
<p>the vector with first derivatives of the response probabilities (one value per item).</p>
</td></tr>
<tr><td><code>d2Pi</code></td>
<td>
<p>the vector with second derivatives of the response probabilities (one value per item).</p>
</td></tr>
<tr><td><code>d3Pi</code></td>
<td>
<p>the vector with third derivatives of the response probabilities (one value per item).</p>
</td></tr>
</table>
<p>Under polytomous IRT models, the aforementioned vectors are replaced by matrices with one row per item (labeled as <code>Item1</code>, <code>Item2</code> etc.) and one row per response category. 
</p>


<h3>Note</h3>

<p>For dichotomous IRT models, response probabilites exactly equal to zero are returned as <code>1e-10</code> values, as well as probabilities exactly equal to one which are returned as <code>1-1e-10</code> values. This is to permit the computation of ability estimates (with the <code><a href="#topic+thetaEst">thetaEst</a></code> function) in such extreme cases.
</p>
<p>Many thanks to Pan Tong (University of Texas MD Anderson Cancer Center, USA) who noticed this problem.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Andrich, D. (1978). A rating formulation for ordered response categories. <em>Psychometrika, 43</em>, 561-573. doi: 10.1007/BF02293814
</p>
<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Bock, R. D. (1972). Estimating item parameters and latent ability when responses are scored in two or more nominal categories. <em>Psychometrika, 37</em>, 29-51. doi: 10.1007/BF02291411
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>
<p>Masters, G. N. (1982). A Rasch model for partial credit scoring. <em>Psychometrika, 47</em>, 149-174. doi: 10.1007/BF02296272
</p>
<p>Muraki, E. (1990). Fitting a polytomous item response model to Likert-type data. <em>Applied Psychological Measurement, 14</em>, 59-71. doi: 10.1177/014662169001400106
</p>
<p>Muraki, E. (1992). A generalized partial credit model: Application of an EM algorithm. <em>Applied Psychological Measurement, 16</em>, 19-176. doi: 10.1177/014662169201600206
</p>
<p>Samejima, F. (1969). <em>Estimation of latent ability using a response pattern of graded scores</em>. Psychometrika Monograph (vol. 17).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Ii">Ii</a></code>, <code><a href="#topic+thetaEst">thetaEst</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Dichotomous models ##

 # Generation of an item bank under 3PL with 100 items 
 m.3PL &lt;- genDichoMatrix(100, model = "3PL")
 m.3PL &lt;- as.matrix(m.3PL)
 
 # Response probabilities and derivatives (various th and D values)
 Pi(th = 0, m.3PL)
 Pi(th = 0, m.3PL, D = 1.702)
 Pi(th = 1, m.3PL)

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Computation of probabilities and derivatives for ability level 0
 Pi(0, m.GRM, model = "GRM")

 # Generation of a item bank under PCM with 20 items and at most 3 categories
 m.PCM &lt;- genPolyMatrix(20, 3, "PCM")
 m.PCM &lt;- as.matrix(m.PCM)

 # Computation of probabilities and derivatives for ability level 1
 Pi(1, m.PCM, model = "PCM")
 </code></pre>

<hr>
<h2 id='randomMST'>Random generation of multistage tests (dichotomous and polytomous models)</h2><span id='topic+randomMST'></span><span id='topic+print.mst'></span><span id='topic+plot.mst'></span>

<h3>Description</h3>

<p>This command generates a response pattern to a multistage test, for a given item bank (with either dichotomous or polytomous models), an MST structure for modules and stages, a true ability level, and several lists of MST parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomMST(trueTheta, itemBank, modules, transMatrix, model = NULL, 
  responses = NULL, genSeed = NULL, start = list(fixModule = NULL, seed = NULL, 
  theta = 0, D = 1), test = list(method = "BM", priorDist = "norm", 
  priorPar = c(0, 1), range = c(-4, 4), D = 1, parInt = c(-4, 4, 33), 
  moduleSelect = "MFI", constantPatt = NULL, cutoff = NULL, randomesque = 1,
  random.seed = NULL, score.range = "all"), final = list(method = "BM", 
  priorDist = "norm", priorPar = c(0, 1), range = c(-4, 4), D = 1, 
  parInt = c(-4, 4, 33), alpha = 0.05), allTheta = FALSE, save.output = FALSE, 
  output = c("path", "name", "csv"))
## S3 method for class 'mst'
print(x, ...)
## S3 method for class 'mst'
plot(x, show.path = TRUE, border.col = "red", arrow.col = "red",
  module.names = NULL, save.plot = FALSE, save.options = c("path", "name", "pdf"),...)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randomMST_+3A_truetheta">trueTheta</code></td>
<td>
<p>numeric: the value of the true ability level.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_itembank">itemBank</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_modules">modules</code></td>
<td>
<p>a binary matrix that specifies the item membership to the modules. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_transmatrix">transMatrix</code></td>
<td>
<p>a binary squared matrix representing the structure of the MST and the transitions between the moduels and the stages. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_responses">responses</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of pre-specified item responses with as many components as the rows of <code>itemBank</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_genseed">genSeed</code></td>
<td>
<p>either a numeric value to fix the random generation of responses pattern or <code>NULL</code> (default). Ignored if <code>responses</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_start">start</code></td>
<td>
<p>a list with the options for starting the multistage test. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_test">test</code></td>
<td>
<p>a list with the options for provisional ability estimation and next module selection. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_final">final</code></td>
<td>
<p>a list with the options for final ability estimation or scoring. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_alltheta">allTheta</code></td>
<td>
<p>logical: should all provisional ability estimates and standard errors be computed and returned (even within each module)? Default is <code>FALSE</code>, meaning that provisional ability estimates and standard errors are computed only at the end of each module administration.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_save.output">save.output</code></td>
<td>
<p>logical: should the output be saved in an external text file? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="randomMST_+3A_output">output</code></td>
<td>
<p>character: a vector of three components. The first component is either the file path to save the output of <code>"path"</code> (default), the second component is the name of the output file, and the third component is the file type, either <code>"txt"</code> or <code>"csv"</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_x">x</code></td>
<td>
<p>either an object of class &quot;mst&quot;, typically an output of <code>randomMST</code> function, or a transition matrix (for <code>plot.mst()</code> function only).</p>
</td></tr>
<tr><td><code id="randomMST_+3A_show.path">show.path</code></td>
<td>
<p>logical: should the selected path (i.e. set of successive modules) be highlighted in the plot (default is TRUE)?</p>
</td></tr>
<tr><td><code id="randomMST_+3A_border.col">border.col</code></td>
<td>
<p>character: the color for the rectangle border of the path (i.e. selected modules). Default is <code>"red"</code>. Ignored if <code>show.path</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_arrow.col">arrow.col</code></td>
<td>
<p>character: the color for the connecting arrows in the path (i.e. between selected modules). Default is <code>"red"</code>. Ignored if <code>show.path</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_module.names">module.names</code></td>
<td>
<p>either <code>NULL</code> (default) or a vector of character names for the modules. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_save.plot">save.plot</code></td>
<td>
<p>logical: should the plot be saved in an external figure? (default is <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="randomMST_+3A_save.options">save.options</code></td>
<td>
<p>character: a vector of three components. The first component is either the file path or <code>"path"</code> (default), the second component is the name of the output file or ,<code>"name"</code> (default), and the third component is the file extension, either <code>"pdf"</code> (default) or <code>"jpeg"</code>. Ignored if <code>save.plot</code> is <code>FALSE</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="randomMST_+3A_...">...</code></td>
<td>
<p>other generic arguments to be passed to <code>print</code> and <code>plot</code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>randomMST</code> function generates a multistage test using an item bank specified by arguments <code>itemBank</code> and <code>model</code>, an MST structure provided by arguments <code>modules</code> and <code>transMatrix</code>, and for a given true ability level specified by argument <code>trueTheta</code>. 
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>itemBank</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model (Barton and Lord, 1981). See <code><a href="#topic+genDichoMatrix">genDichoMatrix</a></code> for further information.
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>itemBank</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The <code>modules</code> argument must be a binary 0/1 matrix with as many rows as the item bank <code>itemBank</code> and as many columns as the number of modules. Values of 1 indicate to which module(s) the items belong to, i.e. a value of 1 on row <em>i</em> and column <em>j</em> means that the <em>i</em>-th item belongs to the <em>j</em>-th module.
</p>
<p>The <code>transMatrix</code> argument must be a binary 0/1 square matrix with as many rows (and columns) as the number of modules. All values of 1 indicate the possible transitions from one module to another, i.e. a value of 1 on row <em>i</em> and column <em>j</em> means that the MST can move from <em>i</em>-th module to <em>j</em>-th module.
</p>
<p>By default all item responses will be randomly drawn from parent distribution set by the item bank parameters of the <code>itemBank</code> matrix (using the <code><a href="#topic+genPattern">genPattern</a></code> function for instance). Moreover, the random generation of the item responses can be fixed (for e.g., replication purposes) by assigning some numeric value to the <code>genSeed</code> argument. By default this argument is equal to <code>NULL</code> so the random seed is not fixed (and two successive runs of <code>randomMST</code> will usually lead to different response patterns).
</p>
<p>It is possible, however, to provide a full response pattern of previously recorded responses to each item of the item bank, for instance for post-hoc simulations. This is done by providing to the <code>responses</code> argument a vector of binary entries (without missing values). By default <code>responses</code> is set to <code>NULL</code> and item responses will be drawn from the item bank parameters.
</p>
<p>The test specification is made by means of three lists of options: one list for the selection of the starting module, 
one list with the options for provisional ability estimation and next module selection, and one list with the options for final ability estimation. These lists are specified respectively by the arguments <code>start</code>, <code>test</code> and <code>final</code>. 
</p>
<p>The <code>start</code> list can contain one or several of the following arguments:
</p>

<ul>
<li><p><code>fixModule</code>: either an integer value, setting the module to be administered as first stage (as its row number in te <code>transMatrix</code> argument for instance), or <code>NULL</code> (default) to let the function select the module.
</p>
</li>
<li><p><code>seed</code>: either a numeric value to fix the random seed for module selection, <code>NA</code> to randomly select the module withour fixing the random seed, or <code>NULL</code> (default) to make random module selection without fixing the random seed. Ignored if <code>fixModule</code> is not <code>NULL</code>.
</p>
</li>
<li><p><code>theta</code>: the initial ability value, used to select the most informative module at this ability level (default is 0). Ignored if either <code>fixModule</code> or <code>seed</code> is not <code>NULL</code>. See <code>startModule</code> for further details.
</p>
</li>
<li><p><code>D</code>: numeric, the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code> and if <code>startSelect</code> is not <code>"MFI"</code>. 
</p>
</li></ul>

<p>These arguments are passed to the function <code>startModule</code> to select the first module of the multistage test.
</p>
<p>The <code>test</code> list can contain one or several of the following arguments:
</p>

<ul>
<li><p><code>method</code>: a character string to specify the method for ability estimation or scoring. Possible values are: <code>"BM"</code> (default) for Bayesian modal estimation (Birnbaum, 1969), <code>"ML"</code> for maximum likelihood estimation (Lord, 1980), <code>"EAP"</code> for expected a posteriori (EAP) estimation (Bock and Mislevy, 1982), and <code>"WL"</code> for weighted likelihood estimation (Warm, 1989). The <code>method</code> argument can also take the value <code>"score"</code>, meaning that module selection is based on the test score from the previously administered modules. The latter works only if <code>cutoff</code> argument is supplied appropriately, otherwise this leads to an error message.
</p>
</li>
<li><p><code>priorDist</code>: a character string which sets the prior distribution. Possible values are: <code>"norm"</code> (default) for normal distribution, <code>"unif"</code> for uniform distribution, and <code>"Jeffreys"</code> for Jeffreys' noninformative prior distribution (Jeffreys, 1939, 1946). ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>.
</p>
</li>
<li><p><code>priorPar</code>: a vector of two numeric components, which sets the parameters of the prior distribution. If (<code>method="BM"</code> or <code>method=="EAP"</code>) and <code>priorDist="norm"</code>, the components of <code>priorPar</code> are respectively the mean and the standard deviation of the prior normal density. If (<code>method="BM"</code> or <code>method="EAP"</code>) and <code>priorDist="unif"</code>, the components of <code>priorPar</code> are respectively the lower and upper bound of the prior uniform density. Ignored in all other cases. By default, <code>priorPar</code> takes the parameters of the prior standard normal distribution (i.e., <code>priorPar=c(0,1)</code>). In addition, <code>priorPar</code> also provides the prior parameters for the comoutation of MLWI and MPWI values for next item selection (see <code><a href="#topic+nextModule">nextModule</a></code> for further details).
</p>
</li>
<li><p><code>range</code>: the maximal range of ability levels, set as a vector of two numeric components. The ability estimate will always lie to this interval (set by default to [-4, 4]). Ignored if <code>method=="EAP"</code>.
</p>
</li>
<li><p><code>D</code>: the value of the metric constant. Default is <code>D=1</code> for logistic metric. Setting <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.
</p>
</li>
<li><p><code>parInt</code>: a numeric vector of three components, holding respectively the values of the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> of the <code><a href="#topic+eapEst">eapEst</a></code>, <code><a href="#topic+eapSem">eapSem</a></code> and <code>MWI</code> commands. It specifies the range of quadrature points for numerical integration, and is used for computing the EAP estimate, its standard error, and the MLWI and MPWI values for next item selection. Default vector is (-4, 4, 33), thus setting the range from -4 to 4 by steps of 0.25. Ignored if <code>method</code> is not <code>"EAP"</code> and if <code>itemSelect</code> is neither <code>"MLMWI"</code> nor <code>"MPMWI"</code>.
</p>
</li>
<li><p><code>moduleSelect</code>: the rule for next module selecion, with possible values:
</p>

<ol>
<li><p><code>"MFI"</code> (default) for maximum Fisher information criterion;
</p>
</li>
<li><p><code>"MLMWI"</code> for maximum likelihood weighted (module) information criterion;
</p>
</li>
<li><p><code>"MPMWI"</code> for posterior weighted (module) information criterion;
</p>
</li>
<li><p><code>"MKL"</code> for (module) Kullback-Leibler information methods;
</p>
</li>
<li><p><code>"MKLP"</code> for posterior (module) Kullback-Leibler information methods;
</p>
</li>
<li><p><code>"random"</code> for random selection.
</p>
</li></ol>

<p>This argument is ignored if <code>cutoff</code> is supplied appropriately. See <code>nextModule</code> for further details.
</p>
</li>
<li><p><code>constantPatt</code>: the method to estimate ability in case of constant pattern (i.e. only correct or only incorrect responses). Can be either <code>NULL</code> (default), <code>"BM"</code>, <code>"EAP"</code>, <code>"WL"</code>, <code>"fixed4"</code> (for fixed stepsize adjustment with step 0.4), <code>"fixed7"</code> (for fixed stepsize adjustment with step 0.7), or <code>"var"</code> (for variable stepsize adjustment). This is currently implemented only for dichotomous IRT models and is sgnored if <code>method</code> is <code>"score"</code>. See <code><a href="#topic+thetaEst">thetaEst</a></code> for further details.
</p>
</li>
<li><p><code>cutoff</code>: either <code>NULL</code> (default) or a suitable matrix of thresholds to select the next module. Thresholds can reflect module selection based on ability estimation (and then <code>method</code> should hold one of the ability estimation methods) or on provisional test score (and then <code>method</code> must be set to <code>"score"</code>. See <code><a href="#topic+nextModule">nextModule</a></code> for further details about suitable definition of the <code>cutoff</code> matrix (and the examples below).
</p>
</li>
<li><p><code>randomesque</code>: a probability value to select the optimal module. Default is one, so the optimal module is always chosen. With a value smaler than one, other elligible modules can be selected.
</p>
</li>
<li><p><code>random.seed</code>: either <code>NULL</code> (default) or a numeric value to fix the random seed of randomesque selection of the module. Ignored if <code>randomesque</code> is equal to one.
</p>
</li>
<li><p><code>score.range</code>: a character value that specifies on which set of modules the provisional test score should be computed. Possible values are <code>"all"</code> (default) to compute the score with all previously administered modules, or <code>"last"</code> to compute the score only with the last module. Ignored if <code>method</code> is not <code>"score"</code>.
</p>
</li></ul>

<p>These arguments are passed to the functions <code><a href="#topic+thetaEst">thetaEst</a></code> and <code><a href="#topic+semTheta">semTheta</a></code> to estimate the ability level and the standard error of this estimate. In addition, some arguments are passed to <code><a href="#topic+nextModule">nextModule</a></code> to select the next module appropriately.
</p>
<p>Finally, the <code>final</code> list can contain the arguments <code>method</code>, <code>priorDist</code>, <code>priorPar</code>, <code>range</code>, <code>D</code> and <code>parInt</code> of the <code>test</code> list (with possiblly different values), as well as the additional <code>alpha</code> argument. The latter specifies the <code class="reqn">\alpha</code> level of the final confidence interval of ability, which is computed as
</p>
<p style="text-align: center;"><code class="reqn">[\hat{\theta}-z_{1-\alpha/2} \; se(\hat{\theta}) ; \hat{\theta}+z_{1-\alpha/2} \; se(\hat{\theta})]</code>
</p>

<p>where <code class="reqn">\hat{\theta}</code> and <code class="reqn">se(\hat{\theta})</code> are respectively the ability estimate and its standard error. 
</p>
<p>If some arguments of these lists are missing, they are automatically set to their default value. 
</p>
<p>Usually the ability estimates and related standard errors are computed right after the full administration of each module (that is, if current module has <em>k</em> items, the <em>(k-1)</em> ability levels and standard errors from the first administered <em>(k-1)</em> are not computed). This can however be avoided by fixing the argument <code>allTheta</code> to <code>TRUE</code> (by default it is <code>FALSE</code>). In this case, all provisional ability estimates (or test scores) and standard errors (or <code>NA</code>'s) are computed and returned. 
</p>
<p>The output of <code>randomMST</code>, as displayed by the <code>print.mst</code> function, can be stored in a text file provided that <code>save.output</code> is set to <code>TRUE</code> (the default value <code>FALSE</code> does not execute the storage). In this case, the <code>(output</code> argument mus hold three character values: the path to where the output file must be stored, the name of
the output file, and the type of output file. If the path is not provided (i.e. left to its default value <code>"path"</code>), it will be saved in the default working directory. The default name is <code>"name"</code>, and the default type is <code>"csv"</code>. Any other value yields a text file. See the <b>Examples</b> section for an illustration. 
</p>
<p>The function <code>plot.mst</code> represents the whole MST structure with as many rectangles as there are available modules, arrows connecting all the modules according to the <code>transMatrix</code> structure. Each stage is displayed as one horizontal layout with stage 1 on the top and final stage at the bottom of the figure. The selected path (i.e. set of modules) is displayed on the plot when <code>show.path</code> is <code>TRUE</code> (which is the default value). Modules from the path and arrows between them are then highlighted in red (by default), and these colors can be modified by settong <code>border.col</code> and <code>arrow.col</code> arguments with appropriate color names. By default, modules are labelled as &ldquo;module 1&quot;, &ldquo;module 2&quot; etc., the numbering starting from left module to right module and from stage 1 to last stage. These labels can be modified by providing a vector of character names to argument <code>module.names</code>. This vector must have as many components as the total number of modules and being ordered identically as described above.
</p>
<p>Note that the MST structure can be graphically displayed by only providing (as <code>x</code> argument) the transition matrix of the MST. In this case, <code>show.path</code> argument is ignored. This is useful to represent the MST structure set by the transition matrix without running an MST simulation.
</p>
<p>Finally, the plot can be saved in an external file, either as PDF or JPEG format. First, the argument <code>save.plot</code> must be set to <code>TRUE</code> (default is <code>FALSE</code>). Then, the file path for figure storage, the name of the figure and its format are specified through the argument <code>save.options</code>, all as character strings. See the <code>Examples</code> section for further information and a practical example.
</p>


<h3>Value</h3>

<p>The function <code>randomMST</code> returns a list of class &quot;mst&quot; with the following arguments:
</p>
<table>
<tr><td><code>trueTheta</code></td>
<td>
<p>the value of the <code>trueTheta</code> argument.</p>
</td></tr>
<tr><td><code>selected.modules</code></td>
<td>
<p>a vector with the modules (identified by their position in the transition matrix) that were selected for the MST.</p>
</td></tr>
<tr><td><code>items.per.module</code></td>
<td>
<p>a vector with the number of items per selected module (in the same order as in <code>selected.modules</code>).</p>
</td></tr>
<tr><td><code>transMatrix</code></td>
<td>
<p>the value of the <code>transMatrix</code> argument.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the value of the <code>model</code> argument.</p>
</td></tr>
<tr><td><code>testItems</code></td>
<td>
<p>a vector with the items that were administered during the test.</p>
</td></tr>
<tr><td><code>itemPar</code></td>
<td>
<p>a matrix with the parameters of the items administered during the test.</p>
</td></tr>
<tr><td><code>pattern</code></td>
<td>
<p>the generated (or selected) response pattern (as vector of 0 and 1 entries for dichotomous items or positive integer values for polytomous items).</p>
</td></tr>
<tr><td><code>thetaProv</code></td>
<td>
<p>a vector with the provisional ability estimates (or test scores if <code>test$method</code> is  <code>"score"</code>).</p>
</td></tr>
<tr><td><code>seProv</code></td>
<td>
<p>a vector with the standard errors of the provisional ability estimates (or vector of <code>NA</code>'s if <code>test$method</code> is  <code>"score"</code>).</p>
</td></tr>
<tr><td><code>thFinal</code></td>
<td>
<p>the final ability estimate (or test score if <code>test$method</code> is  <code>"score"</code>).</p>
</td></tr>
<tr><td><code>seFinal</code></td>
<td>
<p>the standard error of the final ability estimate (or <code>NA</code> if <code>test$method</code> is  <code>"score"</code>).</p>
</td></tr>
<tr><td><code>ciFinal</code></td>
<td>
<p>the confidence interval of the final ability estimate (or <code>c(NA, NA)</code> if <code>test$method</code> is  <code>"score"</code>).</p>
</td></tr>
<tr><td><code>genSeed</code></td>
<td>
<p>the value of the <code>genSeed</code> argument.</p>
</td></tr>
<tr><td><code>startFixModule</code></td>
<td>
<p>the value of the <code>start$fixModule</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>startSeed</code></td>
<td>
<p>the value of the <code>start$seed</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>startTheta</code></td>
<td>
<p>the value of the <code>start$theta</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>startD</code></td>
<td>
<p>the value of the <code>start$D</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>startThStart</code></td>
<td>
<p>the starting ability value used for selecting the first module of the test.</p>
</td></tr>
<tr><td><code>startSelect</code></td>
<td>
<p>the value of the <code>start$startSelect</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provMethod</code></td>
<td>
<p>the value of the <code>test$method</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provDist</code></td>
<td>
<p>the value of the <code>test$priorDist</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provPar</code></td>
<td>
<p>the value of the <code>test$priorPar</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provRange</code></td>
<td>
<p>the value of the <code>test$range</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>provD</code></td>
<td>
<p>the value of the <code>test$D</code> argument (or its default value if missing)or <code>NA</code> if <code>model</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>moduleSelect</code></td>
<td>
<p>the value of the <code>test$moduleSelect</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>constantPattern</code></td>
<td>
<p>the value of the <code>test$constantPatt</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>
<p>the value of the <code>test$cutoff</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>randomesque</code></td>
<td>
<p>the value of the <code>test$randomesque</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>random.seed</code></td>
<td>
<p>the value of the <code>test$random.seed</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>score.range</code></td>
<td>
<p>the value of the <code>test$score.range</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>best.module</code></td>
<td>
<p>a vector of boolean values indicating whether the optimal modules were selected or not.</p>
</td></tr>
<tr><td><code>finalMethod</code></td>
<td>
<p>the value of the <code>final$method</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalDist</code></td>
<td>
<p>the value of the <code>final$priorDist</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalPar</code></td>
<td>
<p>the value of the <code>final$priorPar</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalRange</code></td>
<td>
<p>the value of the <code>final$range</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>finalD</code></td>
<td>
<p>the value of the <code>final$D</code> argument (or its default value if missing), or <code>NA</code> if <code>model</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>finalAlpha</code></td>
<td>
<p>the value of the <code>final$alpha</code> argument (or its default value if missing).</p>
</td></tr>
<tr><td><code>save.output</code></td>
<td>
<p>the value of the <code>save.output</code> argument.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>the value of the <code>output</code> argument.</p>
</td></tr>
<tr><td><code>assigned.responses</code></td>
<td>
<p>a logical value, being <code>TRUE</code> if <code>responses</code> was provided or <code>FALSE</code> <code>responses</code> was set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code>allTheta</code></td>
<td>
<p>either a table with all ad-interim ability estimates (even within module, in the CAT spirit) if <code>allTheta</code> is set to <code>TRUE</code>, or <code>NULL</code> if <code>allTheta</code> is set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code>assigned.responses</code></td>
<td>
<p>the value of the <code>responses</code> argument (or its default value if missing).</p>
</td></tr>
</table>
<p>The function <code>print.mst</code> returns similar (but differently organized) results. 
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>
<p>Duanli Yan <br />
Educational Testing Service, Princeton, USA <br />
<a href="mailto:dyan@ets.org">dyan@ets.org</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Birnbaum, A. (1969). Statistical theory for logistic mental test models with a prior distribution of ability.
<em>Journal of Mathematical Psychology, 6</em>, 258-276. doi: 10.1016/0022-2496(69)90005-4
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. 
<em>Applied Psychological Measurement, 6</em>, 431-444. doi: 10.1177/014662168200600405
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Lord, F. M. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum.
</p>
<p>Warm, T.A. (1989). Weighted likelihood estimation of ability in item response models. <em>Psychometrika, 54</em>, 427-450. doi: 10.1007/BF02294627
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+semTheta">semTheta</a></code>, <code><a href="#topic+eapEst">eapEst</a></code>,
<code><a href="#topic+eapSem">eapSem</a></code>, <code><a href="#topic+genPattern">genPattern</a></code>, <code><a href="#topic+genDichoMatrix">genDichoMatrix</a></code> , <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> ,
</p>
<p><code><a href="#topic+nextModule">nextModule</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

  # Generation of an item bank under 2PL, made of 7 successive modules that target
 # different average ability levels and with different lengths
 # (the first generated item parameters hold two modules of 8 items each)
 it &lt;- rbind(genDichoMatrix(16, model = "2PL"),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", -1, 1)),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", 1, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", -2, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 0, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 2, 1)))
 it &lt;- as.matrix(it)

 # Creation of the 'modules' matrix to list item membership in each module
 modules &lt;- matrix(0, 55, 7)
 modules[1:8, 1] &lt;- modules[9:16, 2] &lt;- modules[17:22, 3] &lt;- 1
 modules[23:28, 4] &lt;- modules[29:37, 5] &lt;- modules[38:46, 6] &lt;- 1
 modules[47:55, 7] &lt;- 1

 # Creation of the transition matrix to define a 1-2-3 MST
 trans &lt;- matrix(0, 7, 7)
 trans[1, 3:4] &lt;- trans[2, 3:4] &lt;- trans[3, 5:7] &lt;- trans[4, 5:7] &lt;- 1

 # Creation of the start list: selection by MFI with ability level 0
 start &lt;- list(theta = 0)

 # Creation of the test list: module selection by MFI, ability estimation by WL,
 # stepsize .4 adjustment for constant pattern
 test &lt;- list(method = "WL", moduleSelect = "MFI", constantPatt = "fixed4")

 # Creation of the final list: ability estimation by ML
 final &lt;- list(method = "ML")

 # Random MST generation for true ability level 1 and all ad-interim ability estimates
 res &lt;- randomMST(trueTheta = 1, itemBank = it, modules = modules, transMatrix = trans,
                   start = start, test = test, final = final, allTheta = TRUE) 

 # Module selection by cut-scores for ability estimates
 # Creation of cut-off scores for ability levels: cut score 0 between modules 3 and 4
 # and cut scores -1 and 1 between modules 5, 6 and 7
 # randomesque selection with probability .8
 cut &lt;- rbind(c(3, 4, 0), c(5, 6, -1), c(6, 7, 1))
 test &lt;- list(method = "WL", constantPatt = "fixed4", cutoff = cut, randomesque = 0.8)
 res &lt;- randomMST(trueTheta = 1, itemBank = it, modules = modules, transMatrix = trans,
                   start = start, test = test, final = final, allTheta = TRUE) 

 # Module selection by cut-scores for test scores
 # Creation of cut-off scores for test scores: cut score 4 between modules 3 and 4
 # and cut scores 5 and 9 between modules 5, 6 and 7
 cut.score &lt;- rbind(c(3, 4, 4), c(5, 6, 5), c(6, 7, 9))
 test &lt;- list(method = "score", cutoff = cut.score)
 final &lt;- list(method = "score")
 res &lt;- randomMST(trueTheta = 1, itemBank = it, modules = modules, transMatrix = trans,
                   start = start, test = test, final = final, allTheta = TRUE) 

 # Modification of cut-scores of stage 3 to use only the last module from stage 2 (6 items):
 # cut scores 2 and 4 between modules 5, 6 and 7
 cut.score2 &lt;- rbind(c(3, 4, 4), c(5, 6, 2), c(6, 7, 4))
 test &lt;- list(method = "score", cutoff = cut.score2, score.range = "last")
 final &lt;- list(method = "score")
 res &lt;- randomMST(trueTheta = 1, itemBank = it, modules = modules, transMatrix = trans,
                   start = start, test = test, final = final, allTheta = TRUE) 

 ## Plot options
 plot(trans)
 plot(res)
 plot(res, show.path = FALSE)
 plot(res, border.col = "blue")
 plot(res, arrow.col = "green")
</code></pre>

<hr>
<h2 id='semTheta'>Standard error of ability estimation (dichotomous and polytomous models)</h2><span id='topic+semTheta'></span>

<h3>Description</h3>

<p>This command returns the estimated standard error of the ability estimate, for a given response pattern and a given matrix of item parameters, either under the 4PL model or any suitable polytomous IRT model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>semTheta(thEst, it, x = NULL, model = NULL, D = 1, method = "BM", 
  	priorDist = "norm", priorPar = c(0, 1), parInt = c(-4, 4, 33),
 	 constantPatt = NULL)
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="semTheta_+3A_thest">thEst</code></td>
<td>
<p>numeric: the ability estimate.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses (default is <code>NULL</code>). Ignored if <code>method</code> is not <code>"EAP"</code>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952).</p>
</td></tr> 
<tr><td><code id="semTheta_+3A_method">method</code></td>
<td>
<p>character: the ability estimator. Possible values are <code>"BM"</code> (default), <code>"ML"</code>, <code>"WL"</code> and <code>"EAP"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_priordist">priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>.
Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>) of the prior ability distribution. Ignored if <code>method</code> is neither <code>"BM"</code>
nor <code>"EAP"</code>, or if <code>priorDist="Jeffreys"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_parint">parInt</code></td>
<td>
<p>numeric: vector of three components, holding respectively the values of the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> of the
<code><a href="#topic+eapEst">eapEst</a></code> command. Default vector is (-4, 4, 33). Ignored if <code>method</code> is not <code>"EAP"</code>.</p>
</td></tr>
<tr><td><code id="semTheta_+3A_constantpatt">constantPatt</code></td>
<td>
<p>character: the method to estimate ability in case of constant pattern (i.e. only correct or only incorrect responses). Can be eitehr <code>NULL</code> (default), <code>"BM"</code>, <code>"EAP"</code>, <code>"WL"</code>, <code>"fixed4"</code>, <code>"fixed7"</code> or <code>"var"</code>. <em>Currently only implemented for dichotomous IRT models</em>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Four ability estimators are available: the maximum likelihood (ML) estimator (Lord, 1980), the Bayes modal (BM) estimator (Birnbaum, 1969), the expected a posteriori (EAP) estimator (Bock and Mislevy, 1982)and the weighted likelihood (WL) estimator (Warm, 1989). The selected estimator is specified by the <code>method</code> argument, with values <code>"ML"</code>, <code>"BM"</code>, <code>"EAP"</code> and <code>"WL"</code> respectively.
</p>
<p>For the BM and EAP estimators, three prior distributions are available: the normal distribution, the uniform distribution and the Jeffreys' prior distribution (Jeffreys, 1939, 1946). The prior distribution is specified by the argument <code>priorPar</code>, with values <code>"norm"</code>, <code>"unif"</code> and <code>"Jeffreys"</code>, respectively. The <code>priorPar</code> argument is ignored if <code>method="ML"</code> or <code>method="WL"</code>.
</p>
<p>The argument <code>priorPar</code> determines either: the prior mean and standard deviation of the normal prior distribution (if 
<code>priorDist="norm"</code>), or the range for defining the prior uniform distribution (if <code>priorDist="unif"</code>). This argument
is ignored if <code>priorDist="Jeffreys"</code>.
</p>
<p>The <code>eapPar</code> argument sets the range and the number of quadrature points for numerical integration in the EAP process. By default, it takes the vector value (-4, 4, 33), that is, 33 quadrature points on the range [-4; 4] (or, by steps of 0.25). See <code><a href="#topic+eapEst">eapEst</a></code> for further details. 
</p>
<p>Note that in the current version, the ability estimate must be specified through the <code>thEst</code> argument. Moreover, the response pattern must be specified through the <code>x</code> argument to compute the standard error of the EAP estimate. For the other estimation methods, this is not  necessary, and <code>x</code> is set to <code>NULL</code> by default for this purpose.
</p>
<p>Note also that if specific stepsize adjustment was required for constant patterns with the <code>constantPatt</code> argument (that is, if it takes value <code>"fixed4"</code>, <code>"fixed7"</code> or <code>"var"</code>) then an infinite value <code>Inf</code> is being returned. 
</p>


<h3>Value</h3>

<p>The estimated standard error of the ability level.
</p>


<h3>Note</h3>

<p>Currently the standard error of the WL estimator is computed with the same formula as that of the ML estimator (up to the plug-in of the WL estimate instead of the ML estimate). Version of <code>catR</code> prior to 3.0 holds a different formula mentioned in Magis and raiche (2012), but it appeared that this formula can lead to negative values of the square of the standard error. So the usual suggestion by Warm (1989) of using the same asymptotic formulas for ML and WL is currently in application until a corrected formula can be provided.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>.
Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Birnbaum, A. (1969). Statistical theory for logistic mental test models with a prior distribution of ability. <em>Journal of Mathematical Psychology, 6</em>, 258-276. doi: 10.1016/0022-2496(69)90005-4
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. <em>Applied Psychological Measurement, 6</em>, 431-444. doi: 10.1177/014662168200600405
</p>
<p>Dodd, B. G., De Ayala, R. J., and Koch, W. R. (1995) . Computerized adaptive testing with polytomous items. <em>Applied Psychological Measurement, 19</em>, 5-22. doi: 10.1177/014662169501900103
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error</em>. 
Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Lord, F.M. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum.
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>
<p>Warm, T.A. (1989). Weighted likelihood estimation of ability in item response models. <em>Psychometrika, 54</em>, 427-450. doi: 10.1007/BF02294627
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eapSem">eapSem</a></code>, <code><a href="#topic+thetaEst">thetaEst</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Generation of an item bank under 3PL with 100 items 
 m.3PL &lt;- genDichoMatrix(100, model = "3PL")
 m.3PL &lt;- as.matrix(m.3PL)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.3PL)

 # ML estimation
 th &lt;- thetaEst(m.3PL, x, method = "ML")
 c(th, semTheta(th, m.3PL, method = "ML"))

 # BM estimation, standard normal prior distribution
 th &lt;- thetaEst(m.3PL, x)
 c(th, semTheta(th, m.3PL))

 # BM estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(m.3PL, x, method = "BM", priorDist = "unif",
                priorPar = c(-2, 2))
 c(th, semTheta(th, m.3PL, method = "BM", priorDist = "unif",
		    priorPar = c(-2, 2)))

 # BM estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(m.3PL, x, method = "BM", priorDist = "Jeffreys")
 c(th, semTheta(th, m.3PL, method = "BM", priorDist = "Jeffreys"))

 # EAP estimation, standard normal prior distribution
 th &lt;- thetaEst(m.3PL, x, method = "EAP")
 c(th, semTheta(th, m.3PL, x, method = "EAP"))

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(m.3PL, x, method = "EAP", priorDist = "unif",
                priorPar = c(-2, 2))
 c(th, semTheta(th, m.3PL, x, method = "EAP", priorDist = "unif",
		    priorPar = c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(m.3PL, x, method = "EAP", priorDist = "Jeffreys")
 c(th, semTheta(th, m.3PL, x, method = "EAP", priorDist = "Jeffreys"))

 # WL estimation
 th &lt;- thetaEst(m.3PL, x, method = "WL")
 c(th, semTheta(th, m.3PL, method = "WL"))

 # 'fixed4' adjustment for constant pattern
 th &lt;- thetaEst(m.3PL, rep(0, nrow(m.3PL)), constantPatt = "fixed4")
 c(th, semTheta(th, m.3PL, constantPatt = "fixed4"))

## Not run: 

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.GRM, model = "GRM")

# ML estimation
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "ML")
 c(th, semTheta(th, m.GRM, model = "GRM", method = "ML"))

 # BM estimation, standard normal prior distribution
 th &lt;- thetaEst(m.GRM, x, model = "GRM")
 c(th, semTheta(th, m.GRM, model = "GRM"))

 # BM estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "BM", priorDist = "unif", 
    priorPar = c(-2, 2))
 c(th, semTheta(th, m.GRM, model = "GRM", method = "BM", priorDist = "unif", 
  priorPar = c(-2, 2)))

 # BM estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "BM", priorDist = "Jeffreys")
 c(th, semTheta(th, m.GRM, model = "GRM", method = "BM", priorDist = "Jeffreys"))

 # EAP estimation, standard normal prior distribution
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "EAP")
 c(th, semTheta(th, m.GRM, x, model = "GRM", method = "EAP") )

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "EAP", priorDist = "unif", 
    priorPar = c(-2, 2))
 c(th, semTheta(th, m.GRM, x, model = "GRM", method = "EAP", priorDist = "unif", 
  priorPar = c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "EAP", priorDist = "Jeffreys")
 c(th, semTheta(th, m.GRM, x, model = "GRM", method = "EAP", priorDist = "Jeffreys"))

 # WL estimation
 th &lt;- thetaEst(m.GRM, x, model = "GRM", method = "WL")
 c(th, semTheta(th, m.GRM, model = "GRM", method = "WL"))


 # Generation of an item bank under PCM with 20 items and 4 categories
 m.PCM &lt;- genPolyMatrix(20, 4, "PCM", same.nrCat = TRUE)
 m.PCM &lt;- as.matrix(m.PCM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.PCM, model = "PCM")

# ML estimation
 th &lt;- thetaEst(m.PCM, x, model = "PCM", method = "ML")
 c(th, semTheta(th, m.PCM, model = "PCM", method = "ML"))

 # BM estimation, standard normal prior distribution
 th &lt;- thetaEst(m.PCM, x, model = "PCM")
 c(th, semTheta(th, m.PCM, model = "PCM"))

 # BM estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(m.PCM, x, model = "PCM", method = "BM", priorDist = "unif", 
    priorPar = c(-2, 2))
 c(th, semTheta(th, m.PCM, model = "PCM", method = "BM", priorDist = "unif", 
  priorPar = c(-2, 2)))

 # BM estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(m.PCM, x, model = "PCM", method = "BM", priorDist = "Jeffreys")
 c(th, semTheta(th, m.PCM, model = "PCM", method = "BM", priorDist = "Jeffreys"))

 # EAP estimation, standard normal prior distribution
 th &lt;- thetaEst(m.PCM, x, model = "PCM", method = "EAP")
 c(th, semTheta(th, m.PCM, x, model = "PCM", method = "EAP"))

 # EAP estimation, uniform prior distribution upon range [-2,2]
 th &lt;- thetaEst(m.PCM, x, model = "PCM", method = "EAP", priorDist = "unif", 
    priorPar = c(-2, 2))
 c(th, semTheta(th, m.PCM, x, model = "PCM", method = "EAP", priorDist = "unif", 
  priorPar = c(-2, 2)))

 # EAP estimation, Jeffreys' prior distribution  
 th &lt;- thetaEst(m.PCM, x, model = "PCM", method = "EAP", priorDist = "Jeffreys")
 c(th, semTheta(th, m.PCM, x, model = "PCM", method = "EAP", priorDist = "Jeffreys"))

 # WL estimation
 th &lt;- thetaEst(m.PCM, x, model = "PCM", method = "WL")
 c(th, semTheta(th, m.PCM, model = "PCM", method = "WL"))
 
## End(Not run)
 </code></pre>

<hr>
<h2 id='startModule'>Selection of the first module in MST</h2><span id='topic+startModule'></span>

<h3>Description</h3>

<p>This command selects the first module of the multistage test, either randomly or on the basis of the module information function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startModule(itemBank, modules, transMatrix, model = NULL, fixModule = NULL, 
  seed = NULL, theta = 0, D = 1) 
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="startModule_+3A_itembank">itemBank</code></td>
<td>
<p>a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startModule_+3A_modules">modules</code></td>
<td>
<p>a binary matrix that specifies the item membership to th emodules. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startModule_+3A_transmatrix">transMatrix</code></td>
<td>
<p>a binary squared matrix representing the structure of the MST and the transitions between the moduels and the stages. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startModule_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startModule_+3A_fixmodule">fixModule</code></td>
<td>
<p>either a an integer value or <code>NULL</code> (default). See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startModule_+3A_seed">seed</code></td>
<td>
<p>either a numeric value, <code>NA</code> or <code>NULL</code> (default). Ignored if <code>fixModule</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startModule_+3A_theta">theta</code></td>
<td>
<p>numeric: the initial ability level for selecting the first module (default is 0). Ignored if either <code>fixModule</code> or <code>seed</code> is not <code>NULL</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="startModule_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This function permits to select the first module of the MST. It works with both dichotomous and polytomous item banks.
</p>
<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>The <code>modules</code> argument must be a binary 0/1 matrix with as many rows as the item bank <code>itemBank</code> and as many columns as the number of modules. Values of 1 indicate to which module(s) the items belong to, i.e. a value of 1 on row <em>i</em> and column <em>j</em> means that the <em>i</em>-th item belongs to the <em>j</em>-th module.
</p>
<p>The <code>transMatrix</code> argument must be a binary 0/1 square matrix with as many rows (and columns) as the number of modules. All values of 1 indicate the possible transitions from one module to another, i.e. a value of 1 on row <em>i</em> and column <em>j</em> means that the MST can move from <em>i</em>-th module to <em>j</em>-th module.
</p>
<p>The first module of the MST can be selected by one of the following methods.
</p>

<ol>
<li><p>By specifying the module to be administered. The argument <code>fixModule</code> then holds the module number as listed in the <code>modules</code> or <code>transMatrix</code>. Setting <code>fixModule</code> to <code>NULL</code> (default value) disables this method.
</p>
</li>
<li><p>By selecting it randomly into the <code>modules</code> matrix. The argument <code>seed</code> permits to fix the random selection by       specifying the random seed number. Setting <code>seed</code> to <code>NA</code> disables the random seed (though items are still picked up randomly in the bank); in other words, successive runs of <code>startModule</code> with <code>seed=NA</code> may lead to different module selection. Setting <code>seed</code> to <code>NULL</code> (default value) disables this selection method.
</p>
</li>
<li><p>By selecting the module according to an initial ability value. In this case, the selected module is such that the information fucntion (computed with the items of the module) is maximal for the given initial ability value.
</p>
</li></ol>

<p>The third method above will be used if and only if both <code>fixModule</code> and <code>seed</code> arguments are fixed to <code>NULL</code>.
Otherwise, one of the first two methods will be used.
</p>


<h3>Value</h3>

<p>A list with four arguments:
</p>
<table>
<tr><td><code>module</code></td>
<td>
<p>the selected module (identified by its column number in the <code>modules</code> argument.</p>
</td></tr>
<tr><td><code>items</code></td>
<td>
<p>the items that belong to the selected module (identified by their number in the item bank).</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>the matrix of item parameters of the selected items (one row per item).</p>
</td></tr>
<tr><td><code>thStart</code></td>
<td>
<p>the starting ability level used for selecting the module or <code>NA</code> (if not applicable).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error.</em> 
Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Generation of an item bank under 2PL, made of 7 successive modules that target
 # different average ability levels and with different lengths
 # (the first generated item parameters hold two modules of 8 items each)
 it &lt;- rbind(genDichoMatrix(16, model = "2PL"),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", -1, 1)),
             genDichoMatrix(6, model = "2PL", bPrior = c("norm", 1, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", -2, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 0, 1)),
             genDichoMatrix(9, model = "2PL", bPrior = c("norm", 2, 1)))
 it &lt;- as.matrix(it)

 # Creation of the 'module' matrix to list item membership in each module
 modules &lt;- matrix(0, 55, 7)
 modules[1:8, 1] &lt;- modules[9:16, 2] &lt;- modules[17:22, 3] &lt;- 1
 modules[23:28, 4] &lt;- modules[29:37, 5] &lt;- modules[38:46, 6] &lt;- 1
 modules[47:55, 7] &lt;- 1

 # Creation of the transition matrix to define a 1-2-3 MST
trans &lt;- matrix(0, 7, 7)
trans[1, 3:4] &lt;- trans[2, 3:4] &lt;- trans[3, 5:6] &lt;- trans[4, 6:7] &lt;- 1

 # Selection of module 2 as starting module
 startModule(it, modules, trans, fixModule = 2)
 
## Not run: 

 # Selection of module 3 (not from stage 1 =&gt; mistake)
 startModule(it, modules, trans, fixModule = 3)

## End(Not run)

 # Random selection of starting module 
 startModule(it, modules, trans, seed = 1)

 # Selection by maximizing information at ability level 0
 startModule(it, modules, trans, theta = 0)


## Polytomous models ##

 # Same structure as above but parameters are now generated from PCM with at most
 # 4 categories
 it &lt;- genPolyMatrix(55, model = "PCM", nrCat = 4)
 it &lt;- as.matrix(it)

 # Selection of module 2 as starting module
 startModule(it, modules, trans, fixModule = 2, model = "PCM")
 
## Not run: 

 # Selection of module 3 (not from stage 1 =&gt; mistake)
 startModule(it, modules, trans, fixModule = 3, model = "PCM")

## End(Not run)

 # Random selection of starting module 
 startModule(it, modules, trans, seed = 1, model = "PCM")

 # Selection by maximizing information at ability level 0
 startModule(it, modules, trans, theta = 0, model = "PCM")
 </code></pre>

<hr>
<h2 id='testListMST'>Testing the format of the MST input lists</h2><span id='topic+testListMST'></span>

<h3>Description</h3>

<p>This command tests whether format of the input lists for the random generation of multistage tests is convenient, and returns a warning message otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testListMST(list, type = "start")
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testListMST_+3A_list">list</code></td>
<td>
<p>a list of arguments to be tested. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="testListMST_+3A_type">type</code></td>
<td>
<p>character: the type of list for checking. Possible values are <code>"start"</code> (default), <code>"test"</code>
and <code>"final"</code>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>testListMST</code> function checks whether the list provided in the <code>list</code> argument is accurate for the selected <code>type</code>. It mainly serves as an initial check for the <code><a href="#topic+randomMST">randomMST</a></code> function. 
</p>
<p>The three types of lists are: <code>"start"</code> with the parameters for selecting the first module; <code>"test"</code> with
the options of the multistage test (i.e. method for next module selection, provisional ability estimator and related information); and <code>"final"</code> with the options for final ability estimation. 
See the help file of <code><a href="#topic+randomMST">randomMST</a></code> for further details about the different lists, their allowed arguments and their contents.
</p>
<p>The function returns an <code>"ok"</code> message if the arguments of <code>list</code> match the requirement of the corresponding <code>type</code>. Otherwise, a message is returned with information about list - type mismatch. This will be the case
if:
</p>

<ul>
<li><p><code>list</code> is not a list, or has no argument names,
</p>
</li>
<li><p><code>list</code> has too many arguments for the <code>type</code> specified,
</p>
</li>
<li><p>at least one of the argument names is incorrect,
</p>
</li>
<li><p>the content of at least one argument is not adequate (e.g. character instead of numeric).
</p>
</li></ul>

<p>Each mismatch yields a different output message to help in debugging the problem.
</p>


<h3>Value</h3>

<p>A list with two arguments:
</p>
<table>
<tr><td><code>test</code></td>
<td>
<p>a logical value indicating whether the format of the list is accurate (<code>TRUE</code>) or not (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p>either a message to indicate the type of misspecification, or <code>"ok"</code> if the format is accurate.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Magis, D. and Barrada, J. R. (2017). Computerized Adaptive Testing with R: Recent Updates of the Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>Code Snippets</em>, <em>76(1)</em>, 1-19. doi: <a href="http://doi.org/10.18637/jss.v076.c01">10.18637/jss.v076.c01</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+randomMST">randomMST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # Creation and test of a 'start' list
 start &lt;- list(theta = 0)
 testListMST(start, type = "start")

 # Creation and test of a 'test' list
 test &lt;- list(method = "WL", moduleSelect = "MFI", constantPatt = "fixed4")
 testListMST(test, type = "test")

 # Creation and test of a 'final' list (with mistake)
 final &lt;- list(method = "MAP")
 testListMST(final, type = "final")

# Creation of cut-off scores for ability levels: cut score 0 between modules 3 and 4
 # and cut scores -1 and 1 between modules 5, 6 and 7
 cut &lt;- matrix(NA, 7, 2)
 cut[3,] &lt;- c(-Inf, 0)
 cut[4,] &lt;- c(0, Inf)
 cut[5,] &lt;- c(-Inf, -1)
 cut[6,] &lt;- c(-1, 1)
 cut[7,] &lt;- c(1, Inf)
 test &lt;- list(method = "WL", constantPatt = "fixed4", cutoff = cut)
 testListMST(test, "test")
 </code></pre>

<hr>
<h2 id='thetaEst'>Ability estimation (dichotomous and polytomous models)</h2><span id='topic+thetaEst'></span>

<h3>Description</h3>

<p>This command returns the ability estimate for a given response pattern and a given matrix of item parameters, either under the 4PL model or any suitable polytomous IRT model. Available estimators are maximum likelihood, Bayes modal (MAP), expected a posteriori (EAP) and weighted likelihood. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thetaEst(it, x, model = NULL, D = 1, method = "BM", priorDist = "norm", 
 	priorPar = c(0, 1), range = c(-4, 4), parInt = c(-4, 4, 33),
 	constantPatt = NULL, current.th = 0, bRange = c(-2, 2))
 </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thetaEst_+3A_it">it</code></td>
<td>
<p>numeric: a suitable matrix of item parameters. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_x">x</code></td>
<td>
<p>numeric: a vector of item responses.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_model">model</code></td>
<td>
<p>either <code>NULL</code> (default) for dichotomous models, or any suitable acronym for polytomous models. Possible values are <code>"GRM"</code>, <code>"MGRM"</code>, <code>"PCM"</code>, <code>"GPCM"</code>, <code>"RSM"</code> and <code>"NRM"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_d">D</code></td>
<td>
<p>numeric: the metric constant. Default is <code>D=1</code> (for logistic metric); <code>D=1.702</code> yields approximately the normal metric (Haley, 1952). Ignored if <code>model</code> is not <code>NULL</code>.</p>
</td></tr> 
<tr><td><code id="thetaEst_+3A_method">method</code></td>
<td>
<p>character: the ability estimator. Possible values are <code>"BM"</code> (default), <code>"ML"</code>, <code>"WL"</code> and <code>"EAP"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_priordist">priorDist</code></td>
<td>
<p>character: specifies the prior distribution. Possible values are <code>"norm"</code> (default), <code>"unif"</code> and <code>"Jeffreys"</code>. Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_priorpar">priorPar</code></td>
<td>
<p>numeric: vector of two components specifying the prior parameters (default is <code>c(0,1)</code>) of the prior ability distribution. Ignored if <code>method</code> is neither <code>"BM"</code> nor <code>"EAP"</code>, or if <code>priorDist="Jeffreys"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_range">range</code></td>
<td>
<p>numeric: vector of two components specifying the range wherein the ability estimate must be looked for (default is <code>c(-4,4)</code>). Ignored if <code>method=="EAP"</code>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_parint">parInt</code></td>
<td>
<p>numeric: vector of three components, holding respectively the values of the arguments <code>lower</code>, <code>upper</code> and <code>nqp</code> of the <code><a href="#topic+eapEst">eapEst</a></code> command. Default vector is (-4, 4, 33). Ignored if <code>method</code> is not <code>"EAP"</code>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_constantpatt">constantPatt</code></td>
<td>
<p>character: the method to estimate ability in case of constant pattern (i.e. only correct or only incorrect responses). Can be either <code>NULL</code> (default), <code>"BM"</code>, <code>"EAP"</code>, <code>"WL"</code>, <code>"fixed4"</code>, <code>"fixed7"</code> or <code>"var"</code>. <em>Currently only implemented for dichotomous IRT models</em>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_current.th">current.th</code></td>
<td>
<p>numeric: the current ability estimate (default is zero). Required for ability estimation in presence of constant pattern. Ignored if <code>constantPatt</code> is neither <code>"fixed4"</code>, <code>"fixed7"</code> nor <code>"var"</code>. See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="thetaEst_+3A_brange">bRange</code></td>
<td>
<p>numeric: vector of two componentns with the range of difficulty parameters in the parent item bank (default is <code>c(-2,2)</code>). <em>Currently only implemented for dichotomous IRT models</em>. See <b>Details</b>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Dichotomous IRT models are considered whenever <code>model</code> is set to <code>NULL</code> (default value). In this case, <code>it</code> must be a matrix with one row per item and four columns, with the values of the discrimination, the difficulty, the pseudo-guessing and the inattention parameters (in this order). These are the parameters of the four-parameter logistic (4PL) model
(Barton and Lord, 1981). 
</p>
<p>Polytomous IRT models are specified by their respective acronym: <code>"GRM"</code> for Graded Response Model, <code>"MGRM"</code> for Modified Graded Response Model, <code>"PCM"</code> for Partical Credit Model, <code>"GPCM"</code> for Generalized Partial Credit Model, <code>"RSM"</code> for Rating Scale Model and <code>"NRM"</code> for Nominal Response Model. The <code>it</code> still holds one row per item, end the number of columns and their content depends on the model. See <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code> for further information and illustrative examples of suitable polytomous item banks.
</p>
<p>Four ability estimators are available: the maximum likelihood (ML) estimator (Lord, 1980), the Bayes modal (BM) estimator (Birnbaum, 1969), the expected a posteriori (EAP) estimator (Bock and Mislevy, 1982) and the weighted likelihood (WL) estimator (Warm, 1989). The selected estimator is specified by the <code>method</code> argument, with values <code>"ML"</code>, <code>"BM"</code>, <code>"EAP"</code> and <code>"WL"</code> respectively.
</p>
<p>For the BM and EAP estimators, three prior distributions are available: the normal distribution, the uniform distribution and Jeffreys' prior distribution (Jeffreys, 1939, 1946). The prior distribution is specified by the argument <code>priorPar</code>, with values <code>"norm"</code>, <code>"unif"</code> and <code>"Jeffreys"</code>, respectively. The <code>priorPar</code> argument is ignored if <code>method="ML"</code> or <code>method="WL"</code>.
</p>
<p>The argument <code>priorPar</code> determines either the prior mean and standard deviation of the normal prior distribution (if 
<code>priorDist="norm"</code>), or the range for defining the prior uniform distribution (if <code>priorDist="unif"</code>). This argument
is ignored if <code>priorDist="Jeffreys"</code>.
</p>
<p>The <code>parInt</code> argument sets the range and the number of quadrature points for numerical integration in the EAP process. By default, it takes the vector value (-4, 4, 33), that is, 33 quadrature points on the range [-4; 4] (or, by steps of 0.25). See <code><a href="#topic+eapEst">eapEst</a></code> for further details. 
</p>
<p>The <code>range</code> argument permits to limit the interval of investigation for the ML, BM and WL ability estimates (in particular, to avoid infinite ability estimates). The default <code>range</code> is [-4, 4].
</p>
<p>Specific ability estimation methods are available in presence of constant patterns (that is with only correct or only incorrect responses) under dichotomous IRT models. These methods are specified by the argument <code>constantPatt</code>. By default it is set to <code>NULL</code> and hence ability is estimated with the specified <code>method</code> (even in presence of constant pattern). Six methods are currently available for constant patterns: <code>"BM"</code>, <code>"EAP"</code> and <code>"WL"</code> that call for Bayes modal, expected a posteriori and weighted likelihood estimation respectively; <code>"fixed4"</code> and <code>"fixed7"</code> that perform fixed stepsize adjustment (i.e. increase or decrease of constant magnitude) with step 0.4 and 0.7 respectively; and <code>"var"</code> for variable stepsize adjustment. Note that in case odf stepsize adjustment, the range of difficultyu parameters must be provided through the <code>bRange</code> argument, as vector of two components (default value being <code>c(-2,2)</code>). See Dodd, De Ayala, and Koch (1995) for further details.
</p>


<h3>Value</h3>

<p>The estimated ability level.
</p>


<h3>Note</h3>

<p>It has been shown that in some cases the weighted likelihood estimator and the Bayes modal estimator with Jeffreys prior return exactly the same ability estimates. This is the case under the 2PL model, and subsequently the 1PL model (Warm, 1989) as well as under all polytomous models currently available (Magis, 2015). Nevertheless, both estimators remain available since (a) Jeffreys prior can also be considered with the EAP estimator, and (b) the 3PL and 4PL models are also available.
</p>


<h3>Author(s)</h3>

<p>David Magis <br />
Department of Psychology, University of Liege, Belgium <br />
<a href="mailto:david.magis@uliege.be">david.magis@uliege.be</a>
</p>


<h3>References</h3>

<p>Barton, M.A., and Lord, F.M. (1981). <em>An upper asymptote for the three-parameter logistic item-response model</em>. Research Bulletin 81-20. Princeton, NJ: Educational Testing Service.
</p>
<p>Birnbaum, A. (1969). Statistical theory for logistic mental test models with a prior distribution of ability. <em>Journal of Mathematical Psychology, 6</em>, 258-276. doi: 10.1016/0022-2496(69)90005-4
</p>
<p>Bock, R. D., and Mislevy, R. J. (1982). Adaptive EAP estimation of ability in a microcomputer environment. <em>Applied Psychological Measurement, 6</em>, 431-444. doi: 10.1177/014662168200600405
</p>
<p>Dodd, B. G., De Ayala, R. J., and Koch, W. R. (1995) . Computerized adaptive testing with polytomous items. <em>Applied Psychological Measurement, 19</em>, 5-22. doi: 10.1177/014662169501900103
</p>
<p>Haley, D.C. (1952). <em>Estimation of the dosage mortality relationship when the dose is subject to error.</em> 
Technical report no 15. Palo Alto, CA: Applied Mathematics and Statistics Laboratory, Stanford University. 
</p>
<p>Jeffreys, H. (1939). <em>Theory of probability</em>. Oxford, UK: Oxford University Press.
</p>
<p>Jeffreys, H. (1946). An invariant form for the prior probability in estimation problems. <em>Proceedings of the Royal
Society of London. Series A, Mathematical and Physical Sciences, 186</em>, 453-461.
</p>
<p>Lord, F.M. (1980). <em>Applications of item response theory to practical testing problems</em>. Hillsdale, NJ: Lawrence Erlbaum.
</p>
<p>Magis, D. (2015). A note on weighted likelihood and Jeffreys modal estimation of proficiency levels in polytomous item response models. <em>Psychometrika, 80</em>, 200-204. doi: 10.1007/S11336-013-9378-5
</p>
<p>Magis, D., and Raiche, G. (2012). Random Generation of Response Patterns under Computerized Adaptive Testing with the R 
Package <em>catR</em>. <em>Journal of Statistical Software</em>, <em>48 (8)</em>, 1-31. URL <a href="http://www.jstatsoft.org/v48/i08/">http://www.jstatsoft.org/v48/i08/</a>
</p>
<p>Warm, T.A. (1989). Weighted likelihood estimation of ability in item response models. <em>Psychometrika, 54</em>, 427-450. doi: 10.1007/BF02294627
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eapEst">eapEst</a></code>, <code><a href="#topic+semTheta">semTheta</a></code>, <code><a href="#topic+genPolyMatrix">genPolyMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Dichotomous models ##

 # Generation of an item bank under 3PL with 100 items 
 m.3PL &lt;- genDichoMatrix(100, model = "3PL")
 m.3PL &lt;- as.matrix(m.3PL)


 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.3PL)

 # ML estimation
 thetaEst(m.3PL, x, method = "ML")

 # BM estimation, standard normal prior distribution
 thetaEst(m.3PL, x)

 # BM estimation, uniform prior distribution upon range [-2,2]
 thetaEst(m.3PL, x, method = "BM", priorDist = "unif", priorPar = c(-2, 2))

 # BM estimation, Jeffreys' prior distribution  
 thetaEst(m.3PL, x, method = "BM", priorDist = "Jeffreys")

 # EAP estimation, standard normal prior distribution
 thetaEst(m.3PL, x, method = "EAP")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 thetaEst(m.3PL, x, method = "EAP", priorDist = "unif", priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 thetaEst(m.3PL, x, method = "EAP", priorDist = "Jeffreys")

 # WL estimation
 thetaEst(m.3PL, x, method = "WL")

 # Creation of two constant patterns and estimation with WL, 
 # 'fixed4', 'fixed7' and 'var' stepsize adjustments
 x0 &lt;- rep(0,nrow(m.3PL))
 x1 &lt;- x0 + 1
 thetaEst(m.3PL, x0, constantPatt = "WL") # equivalent to thetaEst(m.3PL, x0, method = "WL")
 thetaEst(m.3PL, x1, constantPatt = "WL") # equivalent to thetaEst(m.3PL, x1, method = "WL")
 thetaEst(m.3PL, x0, constantPatt = "fixed4") 
 thetaEst(m.3PL, x1, constantPatt = "fixed4") 
 thetaEst(m.3PL, x0, constantPatt = "fixed7") 
 thetaEst(m.3PL, x1, constantPatt = "fixed7") 
 thetaEst(m.3PL, x0, constantPatt = "var") 
 thetaEst(m.3PL, x1, constantPatt = "var") 

## Not run: 

## Polytomous models ##

 # Generation of an item bank under GRM with 100 items and at most 4 categories
 m.GRM &lt;- genPolyMatrix(100, 4, "GRM")
 m.GRM &lt;- as.matrix(m.GRM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.GRM, model = "GRM")

 # ML estimation
 thetaEst(m.GRM, x, model = "GRM", method = "ML")

 # BM estimation, standard normal prior distribution
 thetaEst(m.GRM, x, model = "GRM")

 # BM estimation, uniform prior distribution upon range [-2,2]
 thetaEst(m.GRM, x, model = "GRM", method = "BM", priorDist = "unif", 
          priorPar = c(-2, 2))

 # BM estimation, Jeffreys' prior distribution  
 thetaEst(m.GRM, x, model = "GRM", method = "BM", priorDist = "Jeffreys")

 # EAP estimation, standard normal prior distribution
 thetaEst(m.GRM, x, model = "GRM", method = "EAP")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 thetaEst(m.GRM, x, model = "GRM", method = "EAP", priorDist = "unif", 
          priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 thetaEst(m.GRM, x, model = "GRM", method = "EAP", priorDist = "Jeffreys")

 # WL estimation
 thetaEst(m.GRM, x, model = "GRM", method = "WL")


 # Generation of an item bank under PCM with 20 items and 4 categories
 m.PCM &lt;- genPolyMatrix(20, 4, "PCM", same.nrCat = TRUE)
 m.PCM &lt;- as.matrix(m.PCM)

 # Creation of a response pattern (true ability level 0)
 set.seed(1)
 x &lt;- genPattern(0, m.PCM, model = "PCM")

 # ML estimation
 thetaEst(m.PCM, x, model = "PCM", method = "ML")

 # BM estimation, standard normal prior distribution
 thetaEst(m.PCM, x, model = "PCM")

 # BM estimation, uniform prior distribution upon range [-2,2]
 thetaEst(m.PCM, x, model = "PCM", method = "BM", priorDist = "unif", 
          priorPar = c(-2, 2))

 # BM estimation, Jeffreys' prior distribution  
 thetaEst(m.PCM, x, model = "PCM", method = "BM", priorDist = "Jeffreys")

 # EAP estimation, standard normal prior distribution
 thetaEst(m.PCM, x, model = "PCM", method = "EAP")

 # EAP estimation, uniform prior distribution upon range [-2,2]
 thetaEst(m.PCM, x, model = "PCM", method = "EAP", priorDist = "unif", 
          priorPar = c(-2, 2))

 # EAP estimation, Jeffreys' prior distribution  
 thetaEst(m.PCM, x, model = "PCM", method = "EAP", priorDist = "Jeffreys")

 # WL estimation
 thetaEst(m.PCM, x, model = "PCM", method = "WL")
 
## End(Not run)
 </code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
