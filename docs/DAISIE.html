<!DOCTYPE html><html><head><title>Help for package DAISIE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DAISIE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_column_to_dataframe'><p>Add a column to a data frame</p></a></li>
<li><a href='#archipelago_data'><p>Physical data on 41 archipelagos</p></a></li>
<li><a href='#archipelagos41'><p>DAISIE datalist object including bird phylogenetic data and</p>
physical data for 41 archipelagos</a></li>
<li><a href='#are_rates'><p>Determines if object rates are rates</p></a></li>
<li><a href='#Bats_GreaterAntilles'><p>Colonization and branching times of Noctilionoid bats from the Greater Antilles.</p></a></li>
<li><a href='#Biwa_datalist'><p>Colonization and branching times of 68 fish clades.</p></a></li>
<li><a href='#calc_Abeta'><p>Calculates the area at a point in time from a beta function</p></a></li>
<li><a href='#calc_next_timeval'><p>Calculates when the next timestep will be.</p></a></li>
<li><a href='#calc_next_timeval_shift'><p>Calculates when the next timestep will be, and if a shift has occured.</p></a></li>
<li><a href='#calc_peak'><p>Calculates the peak of ontogeny curve (beta function)</p></a></li>
<li><a href='#countspecies'><p>Count the number of species</p></a></li>
<li><a href='#create_area_pars'><p>Create named list of area parameters</p></a></li>
<li><a href='#create_CS_version'><p>Creates the list object for CS_version argument in DAISIE_ML_CS</p></a></li>
<li><a href='#create_full_CS_stt'><p>Unsampled CS full STT</p></a></li>
<li><a href='#create_hyper_pars'><p>Create list of hyperparameters</p></a></li>
<li><a href='#create_pars'><p>Create vector of model parameters</p></a></li>
<li><a href='#create_trait_pars'><p>Create named list of trait state parameters</p></a></li>
<li><a href='#create_trait_pars_2K'><p>Create named list of trait state parameters</p></a></li>
<li><a href='#cum_rho'><p>Cumulative Gamma distribution parameterised with mean and standard deviation</p></a></li>
<li><a href='#DAISIE_abm_factor'><p>Sets or retrieves the factor to calculate the step-size used by the odeint::adams_bashforth[_moulton] solvers.</p></a></li>
<li><a href='#DAISIE_convertprobdist'><p>Converts the joint distribution of endemics and non-endemics under the</p>
DAISIE model to list format</a></li>
<li><a href='#DAISIE_count_species'><p>Count number of species in DAISIE datalist or simulated data.</p></a></li>
<li><a href='#DAISIE_create_island'><p>Converts simulation output into island output</p></a></li>
<li><a href='#DAISIE_CS_max_steps'><p>CS iteration control</p></a></li>
<li><a href='#DAISIE_dataprep'><p>Prepare colonisation and branching time data to run in DAISIE.</p></a></li>
<li><a href='#DAISIE_ExpEIN'><p>The expected number of endemics and non-endemics under the DAISIE model</p></a></li>
<li><a href='#DAISIE_extract_stt_median'><p>Extract the STT median from the output of DAISIE_sim functions</p></a></li>
<li><a href='#DAISIE_format_CS'><p>Wrapper function around for the DAISIE_format_CS_full_stt and</p>
DAISIE_format_CS_sampled_stt</a></li>
<li><a href='#DAISIE_format_CS_full_stt'><p>Formats clade-specific simulation output into standard</p>
DAISIE list output with complete STT table</a></li>
<li><a href='#DAISIE_format_CS_sampled_stt'><p>Formats clade-specific simulation output into standard</p>
DAISIE list output</a></li>
<li><a href='#DAISIE_format_GW'><p>Formats guild-wide simulation output into standard DAISIE</p>
list output</a></li>
<li><a href='#DAISIE_format_IW_full_stt'><p>Formats clade-specific simulation output into standard</p>
DAISIE list output with complete STT table</a></li>
<li><a href='#DAISIE_format_IW_sampled_stt'><p>Formats island-wide simulation output into standard</p>
DAISIE list output</a></li>
<li><a href='#DAISIE_IC'><p>Calculates information criterion from DAISIE ML estimates?</p></a></li>
<li><a href='#DAISIE_IW_num_threads'><p>IW concurrency control</p></a></li>
<li><a href='#DAISIE_loglik_CS'><p>Computes the loglikelihood of the DAISIE model with clade-specific</p>
diversity-dependence given data and a set of model parameters</a></li>
<li><a href='#DAISIE_loglik_integrand'><p>Integrand to be integrated to calculate the log likelihood for the relaxed</p>
rate model.</a></li>
<li><a href='#DAISIE_loglik_integrate'><p>Integrates the loglikelihood of a single clade across a parameter weighted</p>
by a given distribution</a></li>
<li><a href='#DAISIE_loglik_IW'><p>Computes the loglikelihood of the DAISIE model with island-wide</p>
diversity-dependence given data and a set of model parameters</a></li>
<li><a href='#DAISIE_make_archipelago'><p>Does some things</p></a></li>
<li><a href='#DAISIE_make_global'><p>Does something</p></a></li>
<li><a href='#DAISIE_margprobdist'><p>The marginal distribution of endemics and non-endemics under the DAISIE</p>
model</a></li>
<li><a href='#DAISIE_ML'><p>Maximization of the loglikelihood under the DAISIE model with clade-specific</p>
diversity-dependence</a></li>
<li><a href='#DAISIE_ML_IW'><p>Maximization of the loglikelihood under the DAISIE model with island-wide</p>
diversity-dependence</a></li>
<li><a href='#DAISIE_ML1'><p>Computes MLE for single type species under a clade specific scenario</p></a></li>
<li><a href='#DAISIE_ML2'><p>Computes MLE for multiple islands under a clade specific scenario</p></a></li>
<li><a href='#DAISIE_ML4'><p>Computes MLE for single type species under a clade specific scenario where</p>
one parameter may vary over the clades governed by a specific distribution</a></li>
<li><a href='#DAISIE_MW_ML'><p>Maximization of the loglikelihood under the DAISIE model with clade-specific</p>
diversity-dependence and explicit dependencies on island area and isolation
as hypothesized by MacArthur &amp; Wilson</a></li>
<li><a href='#DAISIE_numcol'><p>The expectation and marginal distribution of the number of colonizations</p>
(lineages) under the DAISIE model</a></li>
<li><a href='#daisie_odeint_cs'><p>Driver for the boost::odeint solver for the CS model</p></a></li>
<li><a href='#daisie_odeint_iw'><p>Driver for the boost::odeint solver for the IW model</p></a></li>
<li><a href='#DAISIE_ONEcolonist'><p>Convert intermediate output to final simulation output</p></a></li>
<li><a href='#DAISIE_plot_age_diversity'><p>Plot clade age against clade diversity.</p></a></li>
<li><a href='#DAISIE_plot_area'><p>Plots island area function through time</p></a></li>
<li><a href='#DAISIE_plot_cladogenesis'><p>Plot cladogenesis rate through time</p></a></li>
<li><a href='#DAISIE_plot_extinction'><p>Plots extinction rate function through time</p></a></li>
<li><a href='#DAISIE_plot_immigration'><p>Plot immigration rate through time</p></a></li>
<li><a href='#DAISIE_plot_input'><p>DAISIE tree plot</p></a></li>
<li><a href='#DAISIE_plot_island'><p>Plot colonisation and branching time of species found on an island dataset.</p></a></li>
<li><a href='#DAISIE_plot_pc_rates'><p>Plot per capita STT and per-capita rate change thourgh simulation</p></a></li>
<li><a href='#DAISIE_plot_sims'><p>Plot island species-through-time (STT) plots</p></a></li>
<li><a href='#DAISIE_plot_stt'><p>Create the Species-Through-Time plot. This is used to visualize</p>
the output of DAISIE_sim functions</a></li>
<li><a href='#DAISIE_probdist'><p>The joint distribution of endemics and non-endemics under the DAISIE model</p></a></li>
<li><a href='#DAISIE_sample_event_cr'><p>Samples what event to happen next</p></a></li>
<li><a href='#DAISIE_sample_event_time_dep'><p>Samples what event to happen next</p></a></li>
<li><a href='#DAISIE_sample_event_trait_dep'><p>Samples what event to happen next</p></a></li>
<li><a href='#DAISIE_sim'><p>Simulate (non-)oceanic islands with given parameters under</p>
time-constant rates</a></li>
<li><a href='#DAISIE_sim_core_cr'><p>Internal function of the DAISIE simulation</p></a></li>
<li><a href='#DAISIE_sim_core_cr_shift'><p>Internal function of the DAISIE simulation</p></a></li>
<li><a href='#DAISIE_sim_core_time_dep'><p>Internal function of the DAISIE simulation</p></a></li>
<li><a href='#DAISIE_sim_core_trait_dep'><p>Internal function of the DAISIE simulation</p></a></li>
<li><a href='#DAISIE_sim_cr_cs'><p>Simulates island replicates with an clade-specific (CS) diversity-dependent</p>
constant-rate process</a></li>
<li><a href='#DAISIE_sim_cr_gw'><p>Simulates island replicates with an guild-wide (GW) diversity-dependent</p>
process</a></li>
<li><a href='#DAISIE_sim_cr_iw'><p>Simulates island replicates with an island-wide (IW) diversity-dependent</p>
constant-rate process</a></li>
<li><a href='#DAISIE_sim_cr_shift'><p>Simulate (non-)oceanic islands with given parameters under a</p>
rate-shift regime</a></li>
<li><a href='#DAISIE_sim_min_type2'><p>Internal function of the DAISIE simulation</p></a></li>
<li><a href='#DAISIE_sim_MW'><p>Simulate multiple islands based on hyperparameters that describe relationships</p>
between area, isolation and local parameters</a></li>
<li><a href='#DAISIE_sim_relaxed_rate'><p>Simulate (non-)oceanic islands with given parameters under a</p>
relaxed-rate model</a></li>
<li><a href='#DAISIE_sim_time_dep'><p>Simulate (non-)oceanic islands with given parameters under a</p>
time-dependent regime</a></li>
<li><a href='#DAISIE_sim_time_dep_cs'><p>Simulates island replicates with an clade-specific (CS) diversity-dependent</p>
time-dependent process</a></li>
<li><a href='#DAISIE_sim_time_dep_gw'><p>Simulates island replicates with an guild-wide (GW) diversity-dependent</p>
time-dependent process</a></li>
<li><a href='#DAISIE_sim_time_dep_iw'><p>Simulates island replicates with an island-wide (IW) diversity-dependent</p>
time-dependent process</a></li>
<li><a href='#DAISIE_sim_trait_dep'><p>Simulate islands with given trait-dependent parameters.</p></a></li>
<li><a href='#DAISIE_sim_trait_dep_2K'><p>Simulate islands with given trait-dependent parameters.</p></a></li>
<li><a href='#DAISIE_sim_update_state_cr'><p>Updates state of island given sampled event for a constant rate case.</p></a></li>
<li><a href='#DAISIE_sim_update_state_time_dep'><p>Updates state of island given sampled event</p></a></li>
<li><a href='#DAISIE_sim_update_state_trait_dep'><p>Updates state of island given sampled event with two trait states.</p></a></li>
<li><a href='#DAISIE_SR_loglik_CS'><p>Computes the loglikelihood of the DAISIE model with clade-specific</p>
diversity-dependence given data and a set of model parameters that may shift
at some time</a></li>
<li><a href='#DAISIE_SR_ML'><p>Maximization of the loglikelihood under the DAISIE model with clade-specific</p>
diversity-dependence</a></li>
<li><a href='#DAISIE_SR_sim_core'><p>DEPRECATED - Algorithm component of DAISIE_SR_sim.</p></a></li>
<li><a href='#DAISIE-package'><p>DAISIE: Dynamical Assembly of Islands by Speciation, Immigration and Extinction</p></a></li>
<li><a href='#default_params_doc'><p>Default parameter documentation</p></a></li>
<li><a href='#frogs_datalist'><p>Colonization and branching times of 5 Eleutherodactylus clades from Hispaniola island.</p></a></li>
<li><a href='#frogs_datatable'><p>Colonization and branching times of 5 Eleutherodactylus (frogs) clades from</p>
the island of Hispaniola.</a></li>
<li><a href='#Galapagos_datalist'><p>Colonization and branching times of 8 terrestrial avifaunal clades in list</p>
format, accepted by DAISIE_ML and DAISIE_loglik_all</a></li>
<li><a href='#Galapagos_datalist_2types'><p>Colonization and branching times of 8 terrestrial avifaunal clades in list</p>
format, accepted by DAISIE_ML and DAISIE_loglik_all</a></li>
<li><a href='#Galapagos_datatable'><p>Colonization and branching times of 8 terrestrial avifaunal Galápagos clades in table</p>
format.</a></li>
<li><a href='#get_ana_rate'><p>Calculate anagenesis rate</p></a></li>
<li><a href='#get_clado_rate'><p>Calculate cladogenesis rate</p></a></li>
<li><a href='#get_ext_rate'><p>Calculate extinction rate</p></a></li>
<li><a href='#get_immig_rate'><p>Calculate immigration rate</p></a></li>
<li><a href='#get_trans_rate'><p>Calculate transition rate</p></a></li>
<li><a href='#integral_peak'><p>Computes integral of a very peaked function, modified from the</p>
SADISA package</a></li>
<li><a href='#island_area'><p>Function to describe changes in area through time.</p></a></li>
<li><a href='#island_area_vector'><p>Computes island_area, but takes vector as argument (needed by )</p></a></li>
<li><a href='#islands_10reps_RAW'><p>1000 islands in RAW format simulated with the ML parameters of the CR model</p>
for the Galapagos data.</a></li>
<li><a href='#islands_1type_1000reps'><p>1000 islands in DAISIE format simulated with the ML parameters of the CR</p>
model for the Galapagos data</a></li>
<li><a href='#islands_2types_1000reps'><p>1000 islands in DAISIE format simulated with the ML parameters of the</p>
CR_lamc_mu_K model for the Galapagos data (2 types of species)</a></li>
<li><a href='#Macaronesia_datalist'><p>Colonization and branching times of terrestrial avifaunal clades from</p>
Azores, Canary Islands, Cape Verde and Madeira in list format, accepted by
DAISIE_ML and DAISIE_loglik_all</a></li>
<li><a href='#NewZealand_birds_datalist'><p>Colonization and branching times of New Zealand birds.</p></a></li>
<li><a href='#remove_empty_elements'><p>Remove superfluous lines in empty simulations</p></a></li>
<li><a href='#rho'><p>Gamma distribution density parameterised with mean and standard deviation</p></a></li>
<li><a href='#sample_relaxed_rate'><p>Samples from distribution when parameter is relaxed</p></a></li>
<li><a href='#stac_table'><p>Explanatory table on meaning and use of <code>stac</code> settings</p></a></li>
<li><a href='#transform_gamma_pars'><p>Transforms mean and standard deviation to shape and scale gamma parameters</p></a></li>
<li><a href='#update_max_rates'><p>Calculates the maximum rates for a Gillespie simulation</p></a></li>
<li><a href='#update_rates'><p>Calculates algorithm rates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Dynamical Assembly of Islands by Speciation, Immigration and
Extinction</td>
</tr>
<tr>
<td>Version:</td>
<td>4.4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-20</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>deSolve, graphics, stats, utils, DDD (&ge; 5.0), subplex,
Matrix, tensor, pracma, testit, foreach, doParallel, magrittr,
parallel, Rcpp (&ge; 1.0.10)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen, BH (&ge; 1.81.0-1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, testthat (&ge; 2.1.0), knitr, rmarkdown, gridExtra,
dplyr, ggplot2, ggtree (&ge; 3.0.0), tidytree, tidyr, purrr, ape,
phytools, tibble</td>
</tr>
<tr>
<td>Enhances:</td>
<td>doMC</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a> | file LICENSE</td>
</tr>
<tr>
<td>Copyright:</td>
<td>See the file COPYRIGHTS for various DAISIE copyright details</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulates and computes the (maximum) likelihood of a dynamical 
    model of island biota assembly through speciation, immigration and
    extinction. See Valente et al. (2015) &lt;<a href="https://doi.org/10.1111%2Fele.12461">doi:10.1111/ele.12461</a>&gt;.</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++17</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/rsetienne/DAISIE">https://github.com/rsetienne/DAISIE</a>,
<a href="https://rsetienne.github.io/DAISIE/">https://rsetienne.github.io/DAISIE/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/rsetienne/DAISIE/issues">https://github.com/rsetienne/DAISIE/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-21 13:57:04 UTC; rampa</td>
</tr>
<tr>
<td>Author:</td>
<td>Rampal S. Etienne <a href="https://orcid.org/0000-0003-2142-7612"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Luis Valente <a href="https://orcid.org/0000-0003-4247-8785"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Albert B. Phillimore
    <a href="https://orcid.org/0000-0002-6553-1553"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Bart Haegeman <a href="https://orcid.org/0000-0003-2325-4727"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Joshua W. Lambert <a href="https://orcid.org/0000-0001-5218-3046"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Pedro Santos Neves
    <a href="https://orcid.org/0000-0003-2561-4677"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Shu Xie <a href="https://orcid.org/0000-0001-9594-946X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Richèl J.C. Bilderbeek
    <a href="https://orcid.org/0000-0003-1107-7049"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Hanno Hildenbrandt
    <a href="https://orcid.org/0000-0002-6784-1037"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Torsten Hauffe <a href="https://orcid.org/0000-0001-5711-9457"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Giovanni Laudanno <a href="https://orcid.org/0000-0002-2952-3345"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Nadiah Kristensen <a href="https://orcid.org/0000-0002-9720-4581"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Raphael Scherrer <a href="https://orcid.org/0000-0002-1447-7630"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rampal S. Etienne &lt;r.s.etienne@rug.nl&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-21 23:10:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_column_to_dataframe'>Add a column to a data frame</h2><span id='topic+add_column_to_dataframe'></span>

<h3>Description</h3>

<p>Add a column to a data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_column_to_dataframe(df, position, column_to_insert)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_column_to_dataframe_+3A_df">df</code></td>
<td>
<p>data frame to add the column to</p>
</td></tr>
<tr><td><code id="add_column_to_dataframe_+3A_position">position</code></td>
<td>
<p>location in data frame where to insert the column.
Position can also be a name of a column</p>
</td></tr>
<tr><td><code id="add_column_to_dataframe_+3A_column_to_insert">column_to_insert</code></td>
<td>
<p>the elements of the column to insert. If
the column has a name, this name will be copied into the data frame.
Id is does not have a name, it will get the name &quot;nc&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the column inserted
</p>

<hr>
<h2 id='archipelago_data'>Physical data on 41 archipelagos</h2><span id='topic+archipelago_data'></span>

<h3>Description</h3>

<p>A dataframe with in subsequent columns the name of the archipelago (Archipelago)
the area of the archipelago (Area), the age (Age) and the distance from the mainland (Distance)
</p>


<h3>Format</h3>

<p>A dataframe containing information on archipelago name, area, age and distance from the mainland
</p>


<h3>Source</h3>

<p>Valente L, Phillimore AB, Melo M, Warren BH, Clegg SM, Havenstein K,
Tiedemann R, Illera JC, Thébaud C, Aschenbach T, Etienne RS. A simple dynamic model
explains island bird diversity worldwide (2020) Nature, 579, 92-96 <br />
</p>

<hr>
<h2 id='archipelagos41'>DAISIE datalist object including bird phylogenetic data and
physical data for 41 archipelagos</h2><span id='topic+archipelagos41'></span>

<h3>Description</h3>

<p>A datalist with 41 items representing the 41 archipelagos.
Each archipelago can be called separately using archipelagos41[[x]] with x being a
number between 1 and 41. Using archipelagos41[[x]][[1]] will show just the
top part of the archipelago item where the archipelago name and physical features
are displayed. The structure of each of the archipelagos is the same as regular DAISIE
datalist generated using DAISIE_dataprep.
</p>


<h3>Format</h3>

<p>A datalist containing data on the 41 archipelagos studied in Valente et
al 2020 (Main Dataset D1). Contains colonisation and branching times for bird species
in each of the archipelagos. It also contains information on archipelago name, area,
age and distance from the nearest mainland.
</p>


<h3>Source</h3>

<p>Valente L, Phillimore AB, Melo M, Warren BH, Clegg SM, Havenstein K,
Tiedemann R, Illera JC, Thébaud C, Aschenbach T, Etienne RS. A simple dynamic model
explains island bird diversity worldwide (2020) Nature, 579, 92-96 <br />
</p>

<hr>
<h2 id='are_rates'>Determines if object rates are rates</h2><span id='topic+are_rates'></span>

<h3>Description</h3>

<p>Determines if object rates are rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>are_rates(rates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="are_rates_+3A_rates">rates</code></td>
<td>
<p>named list of numeric rates as returned by
<code><a href="#topic+update_rates">update_rates</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if object rates is a list of rates
</p>

<hr>
<h2 id='Bats_GreaterAntilles'>Colonization and branching times of Noctilionoid bats from the Greater Antilles.</h2><span id='topic+Bats_GreaterAntilles'></span>

<h3>Description</h3>

<p>A list containing the colonization and branching times of the noctilionoid
bats of the Greater Antilles. Main dataset used in
Valente, Etienne and Dávalos (2017) Nature Ecology and Evolution. Island age 20 Myr and
mainland pool size of 100 species.<br />
The first element of the list has two
components: <br /> <br />
<code>$island_age</code> - the island age <br />
<code>$not_present</code> - the number of mainland lineages that are not present
on the island <br /> <br />
The following elements of the list each contain
information on a single colonist lineage on the island and has 5
components:<br /> <br />
<code>$colonist_name</code> - the name of the species or clade
that colonized the island <br />
<code>$branching_times</code> - island age followed by stem age of the population/species
in the case of Non-endemic, Non-endemic_MaxAge species and Endemic species with no close
relatives on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade including the stem age of the clade.<br />
<code>$stac</code> - the status of the colonist <br /> <br />
* Non_endemic_MaxAge: 1 <br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_endemic: 4 <br />
* Endemic_MaxAge: 5 or 6 <br /> <br />
<code>$missing_species</code> - number of island species
that were not sampled for particular clade (only applicable for endemic
clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or
type 2. In this dataset all are equal to 1. <br />
</p>


<h3>Format</h3>

<p>A list with 17 elements, the first of which contains 2 elements and
the following 16 containing 5 components.
</p>


<h3>Source</h3>

<p>Valente L, Etienne RS, Dávalos (2017) Recent extinctions disturb path to
equilibrium diversity in Caribbean bats. Nature Ecology and Evolution, 1, 26.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a></code>, <code><a href="#topic+DAISIE_ML">DAISIE_ML</a></code>, <code><a href="#topic+DAISIE_SR_ML">DAISIE_SR_ML</a></code>
</p>

<hr>
<h2 id='Biwa_datalist'>Colonization and branching times of 68 fish clades.</h2><span id='topic+Biwa_datalist'></span>

<h3>Description</h3>

<p>A list containing the colonization and branching times of the fishes of
Lake Biwa (Japan). Main dataset used in Hauffe et al (2020). This list can be generated
using the DAISIE_dataprep function,
which converts a user-specified data table into a data object, but the
object can of course also be entered directly. It is an R list object with
the following elements.<br /> <br />
The first element of the list has two
components: <br /> <br />
<code>$island_age</code> - the island age <br />
<code>$not_present</code> - the number of mainland lineages that are not present
on the island <br /> <br />
The following elements of the list each contains
information on a single colonist lineage on the island and has 5
components:<br /> <br />
<code>$colonist_name</code> - the name of the species or clade
that colonized the island <br />
<code>$branching_times</code> - island age followed by stem age of the population/species
in the case of Non-endemic, Non-endemic_MaxAge species and Endemic species with no close
relatives on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade including the stem age of the clade.<br />
<code>$stac</code> - the status of the colonist <br /> <br />
* Non_endemic_MaxAge: 1 <br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_endemic: 4 <br />
* Endemic_MaxAge: 5 or 6 <br /> <br />
<code>$missing_species</code> - number of island species
that were not sampled for particular clade (only applicable for endemic
clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or
type 2. In this dataset all are equal to 1. <br />
</p>


<h3>Format</h3>

<p>A list with 69 elements, the first of which contains 2 elements and
the following 68 containing 5 components.
</p>


<h3>Source</h3>

<p>Hauffe, T., D. Delicado, R.S. Etienne and L. Valente. Lake expansion
elevates equilibrium diversity via increasing colonisation. (2020) Journal of Biogeography <br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a></code>, <code><a href="#topic+DAISIE_ML">DAISIE_ML</a></code>, <code><a href="#topic+DAISIE_SR_ML">DAISIE_SR_ML</a></code>
</p>

<hr>
<h2 id='calc_Abeta'>Calculates the area at a point in time from a beta function</h2><span id='topic+calc_Abeta'></span>

<h3>Description</h3>

<p>Calculates the area at a point in time from a beta function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_Abeta(proptime, proptime_max, peak, Amax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_Abeta_+3A_proptime">proptime</code></td>
<td>
<p>A numeric from 0 to 1. The proportion of time that has
elapsed in the simulation, in relation to the total island age (NB: not
the simulation time, but island age).</p>
</td></tr>
<tr><td><code id="calc_Abeta_+3A_proptime_max">proptime_max</code></td>
<td>
<p>A numeric from 0 to 1. The same as
<code>proportional_peak_t</code>. Indicates, in proportion to the total island
age when the ontogeny peak should occur (i.e. 0.5 means a peak halfway in
time).</p>
</td></tr>
<tr><td><code id="calc_Abeta_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="calc_Abeta_+3A_amax">Amax</code></td>
<td>
<p>A numeric value for maximum island area during the simulation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric
</p>


<h3>Author(s)</h3>

<p>Joshua Lambert, Pedro Neves, Shu Xie
</p>

<hr>
<h2 id='calc_next_timeval'>Calculates when the next timestep will be.</h2><span id='topic+calc_next_timeval'></span>

<h3>Description</h3>

<p>Calculates when the next timestep will be.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_next_timeval(max_rates, timeval)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_next_timeval_+3A_max_rates">max_rates</code></td>
<td>
<p>named list of max rates as returned by
<code><a href="#topic+update_rates">update_rates</a></code>.</p>
</td></tr>
<tr><td><code id="calc_next_timeval_+3A_timeval">timeval</code></td>
<td>
<p>current time of simulation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named list with numeric vector containing the time of the next
timestep and the change in time.
</p>


<h3>Author(s)</h3>

<p>Joshua Lambert, Pedro Neves, Shu Xie
</p>

<hr>
<h2 id='calc_next_timeval_shift'>Calculates when the next timestep will be, and if a shift has occured.</h2><span id='topic+calc_next_timeval_shift'></span>

<h3>Description</h3>

<p>Calculates when the next timestep will be, and if a shift has occured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_next_timeval_shift(max_rates, timeval, dynamic_shift_times)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_next_timeval_shift_+3A_max_rates">max_rates</code></td>
<td>
<p>named list of max rates as returned by
<code><a href="#topic+update_rates">update_rates</a></code>.</p>
</td></tr>
<tr><td><code id="calc_next_timeval_shift_+3A_timeval">timeval</code></td>
<td>
<p>current time of simulation</p>
</td></tr>
<tr><td><code id="calc_next_timeval_shift_+3A_dynamic_shift_times">dynamic_shift_times</code></td>
<td>
<p>numeric vector of times of rate shifts.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named list with numeric vector containing the time of the next
timestep and the change in time.
</p>


<h3>Author(s)</h3>

<p>Joshua Lambert, Pedro Neves, Shu Xie
</p>

<hr>
<h2 id='calc_peak'>Calculates the peak of ontogeny curve (beta function)</h2><span id='topic+calc_peak'></span>

<h3>Description</h3>

<p>Calculates the peak of ontogeny curve (beta function)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_peak(total_time, area_pars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_peak_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="calc_peak_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric
</p>

<hr>
<h2 id='countspecies'>Count the number of species</h2><span id='topic+countspecies'></span>

<h3>Description</h3>

<p>Count the number of species
</p>


<h3>Usage</h3>

<pre><code class='language-R'>countspecies(datalistelement)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="countspecies_+3A_datalistelement">datalistelement</code></td>
<td>
<p>something</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value
</p>

<hr>
<h2 id='create_area_pars'>Create named list of area parameters</h2><span id='topic+create_area_pars'></span>

<h3>Description</h3>

<p>Create named list of area parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_area_pars(
  max_area,
  current_area,
  proportional_peak_t,
  total_island_age,
  sea_level_amplitude,
  sea_level_frequency,
  island_gradient_angle
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_area_pars_+3A_max_area">max_area</code></td>
<td>
<p>Numeric defining maximum area.</p>
</td></tr>
<tr><td><code id="create_area_pars_+3A_current_area">current_area</code></td>
<td>
<p>A numeric with the current island area at present (i.e.,
at the end of the simulation).</p>
</td></tr>
<tr><td><code id="create_area_pars_+3A_proportional_peak_t">proportional_peak_t</code></td>
<td>
<p>Numeric value from 0 to 1 indicating
where in the island's history the peak area is achieved.</p>
</td></tr>
<tr><td><code id="create_area_pars_+3A_total_island_age">total_island_age</code></td>
<td>
<p>Numeric defining total island age.</p>
</td></tr>
<tr><td><code id="create_area_pars_+3A_sea_level_amplitude">sea_level_amplitude</code></td>
<td>
<p>Numeric defining amplitude of area fluctuation
from sea level.</p>
</td></tr>
<tr><td><code id="create_area_pars_+3A_sea_level_frequency">sea_level_frequency</code></td>
<td>
<p>Numeric defining frequency of sine wave of
area change from sea level.</p>
</td></tr>
<tr><td><code id="create_area_pars_+3A_island_gradient_angle">island_gradient_angle</code></td>
<td>
<p>Numeric defining the angle in degrees
specifying the slope of the island.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of numerical values containing area and sea level parameters
for island ontogeny simulation
</p>


<h3>Author(s)</h3>

<p>Richel J.C Bilderbeek, Joshua Lambert, Pedro Neves
</p>


<h3>Examples</h3>

<pre><code class='language-R'>area_pars &lt;- create_area_pars(
  max_area = 10,
  current_area = 1,
  proportional_peak_t = 0.5,
  total_island_age = 5,
  sea_level_amplitude = 5,
  sea_level_frequency = 10,
  island_gradient_angle = 0


)
</code></pre>

<hr>
<h2 id='create_CS_version'>Creates the list object for CS_version argument in DAISIE_ML_CS</h2><span id='topic+create_CS_version'></span>

<h3>Description</h3>

<p>Creates the list object for CS_version argument in DAISIE_ML_CS
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_CS_version(
  model = 1,
  relaxed_par = NULL,
  par_sd = 0,
  par_upper_bound = Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_CS_version_+3A_model">model</code></td>
<td>
<p>the CS model to run, options are <code>1</code> for single rate
DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
model</p>
</td></tr>
<tr><td><code id="create_CS_version_+3A_relaxed_par">relaxed_par</code></td>
<td>
<p>the parameter to relax (integrate over). Options are
<code>"cladogenesis"</code>, <code>"extinction"</code>, <code>"carrying_capacity"</code>,
<code>"immigration"</code>, or <code>"anagenesis"</code></p>
</td></tr>
<tr><td><code id="create_CS_version_+3A_par_sd">par_sd</code></td>
<td>
<p>standard deviation of the parameter to relax</p>
</td></tr>
<tr><td><code id="create_CS_version_+3A_par_upper_bound">par_upper_bound</code></td>
<td>
<p>upper bound of the parameter to relax</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of four elements
</p>

<ul>
<li><p>model: the CS model to run, options are <code>1</code> for single rate
DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
model
</p>
</li>
<li><p>relaxed_par: the parameter to relax (integrate over).
</p>
</li>
<li><p>par_sd: the standard deviation of the parameter to relax
</p>
</li>
<li><p>par_upperbound: upper bound of the parameter to relax.
</p>
</li></ul>


<hr>
<h2 id='create_full_CS_stt'>Unsampled CS full STT</h2><span id='topic+create_full_CS_stt'></span>

<h3>Description</h3>

<p>Unsampled CS full STT
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_full_CS_stt(stt_list, stac_vec, total_time, trait_pars = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_full_CS_stt_+3A_stt_list">stt_list</code></td>
<td>
<p>List of full stt tables as
returned by DAISIE_sim_core functions</p>
</td></tr>
<tr><td><code id="create_full_CS_stt_+3A_stac_vec">stac_vec</code></td>
<td>
<p>Vector with status of species on island.</p>
</td></tr>
<tr><td><code id="create_full_CS_stt_+3A_total_time">total_time</code></td>
<td>
<p>Numeric double with total time of simulation.</p>
</td></tr>
<tr><td><code id="create_full_CS_stt_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>1 complete, unsampled STT table from all clades in an island of a
CS model as generated by DAISIE_sim_core functions.
</p>


<h3>Author(s)</h3>

<p>Pedro Neves, Joshua Lambert, Shu Xie, Giovanni Laudanno
</p>

<hr>
<h2 id='create_hyper_pars'>Create list of hyperparameters</h2><span id='topic+create_hyper_pars'></span>

<h3>Description</h3>

<p>Create list of hyperparameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_hyper_pars(d, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_hyper_pars_+3A_d">d</code></td>
<td>
<p>Numeric defining the scaling parameter for exponent for
calculating cladogenesis rate.</p>
</td></tr>
<tr><td><code id="create_hyper_pars_+3A_x">x</code></td>
<td>
<p>Numeric defining the exponent for calculating extinction rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list with hyperparameters
</p>


<h3>Author(s)</h3>

<p>Pedro Neves, Joshua Lambert
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hyper_pars &lt;- create_hyper_pars(d = 0.027, x = 0.15)
</code></pre>

<hr>
<h2 id='create_pars'>Create vector of model parameters</h2><span id='topic+create_pars'></span>

<h3>Description</h3>

<p>Create vector of model parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_pars(clado_rate, ext_rate, carr_cap, immig_rate, ana_rate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_pars_+3A_clado_rate">clado_rate</code></td>
<td>
<p>Numeric rate of cladogenesis</p>
</td></tr>
<tr><td><code id="create_pars_+3A_ext_rate">ext_rate</code></td>
<td>
<p>Numeric rate of extinction</p>
</td></tr>
<tr><td><code id="create_pars_+3A_carr_cap">carr_cap</code></td>
<td>
<p>Numeric carrying capacity</p>
</td></tr>
<tr><td><code id="create_pars_+3A_immig_rate">immig_rate</code></td>
<td>
<p>Numeric rate of immigration</p>
</td></tr>
<tr><td><code id="create_pars_+3A_ana_rate">ana_rate</code></td>
<td>
<p>Numeric rate of anagenesis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with 5 elements
</p>


<h3>Examples</h3>

<pre><code class='language-R'>create_pars(clado_rate = 1,
            ext_rate = 1,
            carr_cap = 10,
            immig_rate = 0.1,
            ana_rate = 1)
</code></pre>

<hr>
<h2 id='create_trait_pars'>Create named list of trait state parameters</h2><span id='topic+create_trait_pars'></span>

<h3>Description</h3>

<p>Create named list of trait state parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_trait_pars(
  trans_rate,
  immig_rate2,
  ext_rate2,
  ana_rate2,
  clado_rate2,
  trans_rate2,
  M2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_trait_pars_+3A_trans_rate">trans_rate</code></td>
<td>
<p>A numeric with the per capita transition rate with state1</p>
</td></tr>
<tr><td><code id="create_trait_pars_+3A_immig_rate2">immig_rate2</code></td>
<td>
<p>A numeric with the per capita immigration rate with state2</p>
</td></tr>
<tr><td><code id="create_trait_pars_+3A_ext_rate2">ext_rate2</code></td>
<td>
<p>A numeric with the per capita extinction rate with state2</p>
</td></tr>
<tr><td><code id="create_trait_pars_+3A_ana_rate2">ana_rate2</code></td>
<td>
<p>A numeric with the per capita anagenesis rate with state2</p>
</td></tr>
<tr><td><code id="create_trait_pars_+3A_clado_rate2">clado_rate2</code></td>
<td>
<p>A numeric with the per capita cladogenesis rate with state2</p>
</td></tr>
<tr><td><code id="create_trait_pars_+3A_trans_rate2">trans_rate2</code></td>
<td>
<p>A numeric with the per capita transition rate with state2</p>
</td></tr>
<tr><td><code id="create_trait_pars_+3A_m2">M2</code></td>
<td>
<p>A numeric with the number of species with trait state 2 on mainland</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of numerical values containing trait state parameters
</p>


<h3>Examples</h3>

<pre><code class='language-R'>trait_pars &lt;- create_trait_pars(
   trans_rate = 0.5,
   immig_rate2 = 0.1,
   ext_rate2 = 0.2,
   ana_rate2 = 0.3,
   clado_rate2 = 0.4,
   trans_rate2 = 0.5,
   M2 = 1000
 )
</code></pre>

<hr>
<h2 id='create_trait_pars_2K'>Create named list of trait state parameters</h2><span id='topic+create_trait_pars_2K'></span>

<h3>Description</h3>

<p>Create named list of trait state parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_trait_pars_2K(
  trans_rate,
  immig_rate2,
  ext_rate2,
  ana_rate2,
  clado_rate2,
  trans_rate2,
  M2,
  K2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_trait_pars_2K_+3A_trans_rate">trans_rate</code></td>
<td>
<p>A numeric with the per capita transition rate with state1</p>
</td></tr>
<tr><td><code id="create_trait_pars_2K_+3A_immig_rate2">immig_rate2</code></td>
<td>
<p>A numeric with the per capita immigration rate with state2</p>
</td></tr>
<tr><td><code id="create_trait_pars_2K_+3A_ext_rate2">ext_rate2</code></td>
<td>
<p>A numeric with the per capita extinction rate with state2</p>
</td></tr>
<tr><td><code id="create_trait_pars_2K_+3A_ana_rate2">ana_rate2</code></td>
<td>
<p>A numeric with the per capita anagenesis rate with state2</p>
</td></tr>
<tr><td><code id="create_trait_pars_2K_+3A_clado_rate2">clado_rate2</code></td>
<td>
<p>A numeric with the per capita cladogenesis rate with state2</p>
</td></tr>
<tr><td><code id="create_trait_pars_2K_+3A_trans_rate2">trans_rate2</code></td>
<td>
<p>A numeric with the per capita transition rate with state2</p>
</td></tr>
<tr><td><code id="create_trait_pars_2K_+3A_m2">M2</code></td>
<td>
<p>A numeric with the number of species with trait state 2 on mainland</p>
</td></tr>
<tr><td><code id="create_trait_pars_2K_+3A_k2">K2</code></td>
<td>
<p>A numeric with the carrying capacity for state 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of numerical values containing trait state parameters
</p>

<hr>
<h2 id='cum_rho'>Cumulative Gamma distribution parameterised with mean and standard deviation</h2><span id='topic+cum_rho'></span>

<h3>Description</h3>

<p>Cumulative Gamma distribution parameterised with mean and standard deviation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cum_rho(par_upper_bound, DAISIE_dist_pars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cum_rho_+3A_daisie_dist_pars">DAISIE_dist_pars</code></td>
<td>
<p>A numeric vector of two elements, first is the mean
and second the standard deviation of the distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric
</p>

<hr>
<h2 id='DAISIE_abm_factor'>Sets or retrieves the factor to calculate the step-size used by the odeint::adams_bashforth[_moulton] solvers.</h2><span id='topic+DAISIE_abm_factor'></span>

<h3>Description</h3>

<p>Sets or retrieves the factor to calculate the step-size used by the odeint::adams_bashforth[_moulton] solvers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_abm_factor(factor)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_abm_factor_+3A_factor">factor</code></td>
<td>
<p>sets step-size to <code>factor * (t1 - t0)</code>. <br /></p>
</td></tr>
</table>


<h3>Value</h3>

<p>current factor
</p>

<hr>
<h2 id='DAISIE_convertprobdist'>Converts the joint distribution of endemics and non-endemics under the
DAISIE model to list format</h2><span id='topic+DAISIE_convertprobdist'></span>

<h3>Description</h3>

<p>This function converts the joint distribution of the number of endemics and
non-endemics from the matrix format of DAISIE_probdist to a list format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_convertprobdist(pb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_convertprobdist_+3A_pb">pb</code></td>
<td>
<p>Probability distribution in matrix format as output by
<code><a href="#topic+DAISIE_probdist">DAISIE_probdist</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of length nrow(pb) containing matrices of square dimensions
of size sqrt(ncol - 1) containing the joint probabilities with endemics in
the rows and non-endemics in the columns. The last element of the list is a
vector a times at which the joint probability distribution is evaluated.
</p>


<h3>Author(s)</h3>

<p>Rampal S. Etienne
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Compute the probability distribution at t = 4 and t = 8, for a mainland pool
# size of 250 potential colonists and a vector of 5 parameters (cladogenesis, extinction,
# clade-level carrying capacity, immigration, anagenesis) starting from an empty
# island; store in list format

pb &lt;- DAISIE_probdist(
   pars1 = c(0.3,0.35,Inf,0.75,0.012),
   pars2 = c(100,250),
   tvec = c(4,8),
   initEI = c(0,0),
   initprobs = NULL
   )
prob_dists &lt;- DAISIE_convertprobdist(pb)

</code></pre>

<hr>
<h2 id='DAISIE_count_species'>Count number of species in DAISIE datalist or simulated data.</h2><span id='topic+DAISIE_count_species'></span>

<h3>Description</h3>

<p>Calculates various island diversity metrics from island datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_count_species(islands, sort_clade_sizes = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_count_species_+3A_islands">islands</code></td>
<td>
<p>Island datalist or simulated data in DAISIE datalist format.
Can be a single island (empirical data) generated with DAISIE_dataprep or
DAISIEprep. Can also be simulated data generated with DAISIE_sim function.</p>
</td></tr>
<tr><td><code id="DAISIE_count_species_+3A_sort_clade_sizes">sort_clade_sizes</code></td>
<td>
<p>Default sort_clade_sizes = T outputs clade sizes
sorted in ascending order of number of species. sort_clade_sizes=F outputs
clade sizes in the same order as they appear in the input datalist.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a list containing the following items:
</p>
<table>
<tr><td><code>clade_sizes_sorted</code></td>
<td>
<p> List showing the total number of species in each
island clade (including missing species). Each item [[i]] on the list
gives the sizes of all clades for a single island. If option
sort_clade_sizes = T,
the clade sizes for are
sorted by increasing number of species. If option sort_clade_sizes = F
the clade sizes are given in the same order as in the input datalist.</p>
</td></tr>
<tr><td><code>size_largest_clade</code></td>
<td>
<p> The total number of species in the largest
island clade
for each island.</p>
</td></tr>
<tr><td><code>mean_clade_size</code></td>
<td>
<p> Mean clade size (average of all island clades)</p>
</td></tr>
<tr><td><code>number_colonisations</code></td>
<td>
<p> The total number of colonisations (clades) on
each island.</p>
</td></tr>
<tr><td><code>total_number_species</code></td>
<td>
<p> The total number of species on each island. These
are the extant species at present, including missing species; in case of
simulations, this is the number of species present on the island at the
end of the
simulation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis Valente
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a></code>,
<code><a href="#topic+DAISIE_plot_island">DAISIE_plot_island</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Run function with clade sizes in the order they appear in the input data
data("NewZealand_birds_datalist")
species_count &lt;- DAISIE_count_species(NewZealand_birds_datalist)

# Run function with clade sizes in ascending order
species_count_sorted &lt;- DAISIE_count_species(
  NewZealand_birds_datalist,
  sort_clade_sizes = TRUE
)
</code></pre>

<hr>
<h2 id='DAISIE_create_island'>Converts simulation output into island output</h2><span id='topic+DAISIE_create_island'></span>

<h3>Description</h3>

<p>Converts simulation output into island output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_create_island(
  stt_table,
  total_time,
  island_spec,
  mainland_n,
  trait_pars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_create_island_+3A_stt_table">stt_table</code></td>
<td>
<p>Matrix with number of species at each time step.</p>
</td></tr>
<tr><td><code id="DAISIE_create_island_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_create_island_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
<tr><td><code id="DAISIE_create_island_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="DAISIE_create_island_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the island information, composed stt table,
branching times of extant species, status of species on
the island and number of missing species.
</p>

<hr>
<h2 id='DAISIE_CS_max_steps'>CS iteration control</h2><span id='topic+DAISIE_CS_max_steps'></span>

<h3>Description</h3>

<p>Sets or retrieves the max. number of iterations used by the odeint solver.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_CS_max_steps(max_steps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_CS_max_steps_+3A_max_steps">max_steps</code></td>
<td>
<p><code>max_steps</code>: sets max. iterations to <code>max_steps</code>. <br /></p>
</td></tr>
</table>


<h3>Value</h3>

<p>current max. iterations
</p>

<hr>
<h2 id='DAISIE_dataprep'>Prepare colonisation and branching time data to run in DAISIE.</h2><span id='topic+DAISIE_dataprep'></span>

<h3>Description</h3>

<p>This function produces a data object that can be run in DAISIE likelihood
computation/optimization functions. The function converts a user-specified
table to a DAISIE-compatible format. See Galapagos_datatable.Rdata for a
template of an input table.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_dataprep(
  datatable,
  island_age,
  M,
  number_clade_types = 1,
  list_type2_clades = NA,
  prop_type2_pool = "proportional",
  epss = 1e-05,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_dataprep_+3A_datatable">datatable</code></td>
<td>
<p>Data frame (table) with user-specified data. See file
Galapagos_datatable.Rdata for a template of an input table. Each row on the
table represents and independent colonisation event. Table has the following
four columns. <br /> <br /> <code>$Clade_name</code> - name of independent colonization
event <br /> <code>$Status</code> - One of the following categories: <br /> *
&quot;Non_endemic&quot;: applies to non-endemic species when an approximate colonisation time is known <br /> *
&quot;Non_endemic_MaxAge&quot;: applies to non-endemic species for cases where
colonisation time is unknown <br /> * &quot;Endemic&quot;: applies to endemic species or endemic
clades when an approximate colonisation time is known <br /> * &quot;Endemic_MaxAge&quot;: applies to endemic
species or endemic clades for cases where the colonisation time is unknown, or when
the user wants to specify an upper bound for colonisation.
This could for example apply to endemic species that have recently gone extinct because
of anthropogenic causes, and which are not included
in the phylogeny (&quot;NA&quot; should be given in the branching times column). It
could also apply to insular radiations with long stem branches, for which the
time of the first cladogenetic event is known, but the precise time of colonisation
is not. <br /> * &quot;Endemic_MaxAge_MinAge&quot;: same as Endemic_MaxAge but also includes a minimum
age for colonisation. <br /> * &quot;Non_endemic_MaxAge_MinAge&quot;: same as Non_endemic_MaxAge but
also includes a minimum age for colonisation.#' <br /> * &quot;Endemic&amp;Non_Endemic&quot;: when endemic
clade is present and its mainland ancestor has re-colonized <br /> <code>$Missing_species</code>
- Number of island species that were not sampled for particular clade (only applicable for
&quot;Endemic&quot; clades). If NA is given in branching times column, this should
be equal to the number of species in the clade minus 1 <br /> <code>$Branching_times</code>
- Stem age of the population/species in the case of &quot;Non_endemic&quot;, &quot;Non_endemic_MaxAge&quot;
and &quot;Endemic&quot; species with no extant close relatives on the island. Set &quot;NA&quot; if
colonisation time unknown and no upper bound is known.
For &quot;Endemic&quot; cladogenetic species these should be branching times of the
radiation, including the stem age of the radiation (colonisation time estimate).<br /></p>
</td></tr>
<tr><td><code id="DAISIE_dataprep_+3A_island_age">island_age</code></td>
<td>
<p>Age of island in appropriate units</p>
</td></tr>
<tr><td><code id="DAISIE_dataprep_+3A_m">M</code></td>
<td>
<p>The size of the mainland pool, i.e the number of species that can
potentially colonize the island</p>
</td></tr>
<tr><td><code id="DAISIE_dataprep_+3A_number_clade_types">number_clade_types</code></td>
<td>
<p>Number of clade types. Default: number_clade_types
= 1 all species are considered to belong to same macroevolutionary process.
If number_clade_types = 2, there are two types of clades with distinct
macroevolutionary processes.</p>
</td></tr>
<tr><td><code id="DAISIE_dataprep_+3A_list_type2_clades">list_type2_clades</code></td>
<td>
<p>If number_clade_types = 2, list_type2_clades
specifies the names of the clades that have a distinct macroevolutionary
process. The names must match those in the $Clade_name column of the source
data table (e.g. list_type2_clades = &quot;Finches&quot;).  If number_clade_types = 1,
then list_type2_clades = NA should be specified (default)</p>
</td></tr>
<tr><td><code id="DAISIE_dataprep_+3A_prop_type2_pool">prop_type2_pool</code></td>
<td>
<p>Specifies the fraction of potential mainland
colonists that have a distinct macroevolutionary process. Applies only if
number_clade_types = 2.  Default &quot;proportional&quot; sets the fraction to be
proportional to the number of clades of distinct macroevolutionary process
that have colonised the island. Alternatively, the user can specify a value
between 0 and 1 (e.g. if mainland pool size is 1000 and prop_type2_pool =
0.02 then number of type2 species is 20).</p>
</td></tr>
<tr><td><code id="DAISIE_dataprep_+3A_epss">epss</code></td>
<td>
<p>Default= 1E-5 should be appropriate in most cases. This value is
used to set the maximum age of colonisation of &quot;Non_endemic_MaxAge&quot; and
&quot;Endemic_MaxAge&quot; species to an age that is slightly younger than the island
for cases when the age provided for that species is older than the island.
The new maximum age is then used as an upper bound to integrate over all
possible colonisation times.</p>
</td></tr>
<tr><td><code id="DAISIE_dataprep_+3A_verbose">verbose</code></td>
<td>
<p>Boolean. States if intermediate results should be printed to
console. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output is an R list containing the data formatted to be run on other
DAISIE functions.
</p>


<h3>Value</h3>

<table>
<tr><td><code>datalist</code></td>
<td>
<p> R list object containing data:<br /> The first element
of the list has two or three components: <br /> <code>$island_age</code> - the island
age <br /> Then, depending on whether a distinction between species types is
made, we have:<br /> <code>$not_present</code> - the number of mainland lineages that
are not present on the island <br /> or:<br /> <code>$not_present_type1</code> - the
number of mainland lineages of type 1 that are not present on the island <br />
<code>$not_present_type2</code> - the number of mainland lineages of type 2 that
are not present on the island <br /> The following elements of the list each
contains information on a single colonist lineage on the island and has 5
components:<br /> <code>$colonist_name</code> - the name of the species or clade that
colonized the island <br /> <code>$branching_times</code> - island age and stem age
of the population/species in the case of &quot;Non-endemic&quot;, &quot;Non-endemic_MaxAge&quot;
and &quot;Endemic&quot; anagenetic species. For &quot;Endemic&quot; cladogenetic species these
are island age and branching times of the radiation including the stem age
of the radiation.<br /> <code>$stac</code> - the status of the colonist <br /> *
Non_endemic_MaxAge: 1 <br /> * Endemic: 2 <br /> * Endemic&amp;Non_Endemic: 3 <br /> *
Non_endemic: 4 <br /> * Endemic_MaxAge: 5 (if only colonisation time was given)
<br /> * Endemic_MaxAge: 6 (if colonisation time and cladogenesis times were given)
<br /><code>$missing_species</code> - number of island species that were not sampled
for particular clade (only applicable for endemic clades) <br /> <code>$type_1or2</code>
- whether the colonist belongs to type 1 or type 2 <br /> </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luis M Valente
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>



### Create Galapagos data object where all taxa have the same macroevolutionary process

utils::data(Galapagos_datatable, package = "DAISIE")
DAISIE_dataprep(
   datatable = Galapagos_datatable,
   island_age = 4,
   M = 1000
   )

### Create Galapagos data object with a distinct macroevolutionary processes
# for the Darwin's finches. One process applies to type 1 species (all species
# except for Darwin's finches) and the other applies only to type 2 species
# (Darwin's finches). Set fraction of potential colonists of type 2 to be
# proportional to the number of type2 clades present on the island.

utils::data(Galapagos_datatable, package = "DAISIE")
DAISIE_dataprep(
   datatable = Galapagos_datatable,
   island_age = 4,
   M = 1000,
   number_clade_types = 2,
   list_type2_clades = "Finches"
   )

### Create Galapagos data object with a distinct macroevolutionary processes
# for the Darwin's finches. One process applies to type 1 species (all species
# except for Darwin's finches) and the other applies only to type 2 species
# (Darwin's finches). Set fraction of potential colonists of type 2 to be 0.163.

utils::data(Galapagos_datatable, package = "DAISIE")
DAISIE_dataprep(
   datatable = Galapagos_datatable,
   island_age = 4,
   M = 1000,
   number_clade_types = 2,
   list_type2_clades = "Finches",
   prop_type2_pool = 0.163
   )

</code></pre>

<hr>
<h2 id='DAISIE_ExpEIN'>The expected number of endemics and non-endemics under the DAISIE model</h2><span id='topic+DAISIE_ExpEIN'></span>

<h3>Description</h3>

<p>This function calculates the expected number of endemics, non-endemics and
the sum of these for a given set of parameter values, a given mainland
species pool size and a given time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_ExpEIN(t, pars, M, initEI = c(0, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_ExpEIN_+3A_t">t</code></td>
<td>
<p>The time at which the expectations need to be computed.</p>
</td></tr>
<tr><td><code id="DAISIE_ExpEIN_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_ExpEIN_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_ExpEIN_+3A_initei">initEI</code></td>
<td>
<p>The initial values for the number of endemics and
non-endemics. In <code><a href="#topic+DAISIE_probdist">DAISIE_probdist</a>()</code> or
<code><a href="#topic+DAISIE_margprobdist">DAISIE_margprobdist</a>()</code> either this or initprobs must be NULL. In
<code><a href="#topic+DAISIE_numcol">DAISIE_numcol</a>()</code> when it is NULL, it is assumed that the island
is empty.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out</code></td>
<td>
<p>The output is a list with three elements: <br /> <br />
<code>ExpE</code> The number of endemic species <br /> <code>ExpI</code> The number of
non-endemic species <br /> <code>ExpN</code> The sum of the number of endemics and
non-endemics </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rampal S. Etienne
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Compute the expected values at t = 4, for a mainland pool size of 1000 potential
# colonists and a vector of 5 parameters (cladogenesis, extinction, clade-level carrying
# capacity, immigration, anagenesis)

DAISIE_ExpEIN(
   t = 4,
   pars = c(0.5,0.1,Inf,0.01,0.4),
   M = 1000
   )

</code></pre>

<hr>
<h2 id='DAISIE_extract_stt_median'>Extract the STT median from the output of DAISIE_sim functions</h2><span id='topic+DAISIE_extract_stt_median'></span>

<h3>Description</h3>

<p>Extract the STT median from the output of DAISIE_sim functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_extract_stt_median(island_replicates, trait_pars = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_extract_stt_median_+3A_island_replicates">island_replicates</code></td>
<td>
<p>List output from
<code><a href="#topic+DAISIE_sim_core_cr">DAISIE_sim_core_cr</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_time_dep">DAISIE_sim_core_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_cr_shift">DAISIE_sim_core_cr_shift</a>()</code> or
<code><a href="#topic+DAISIE_sim_min_type2">DAISIE_sim_min_type2</a>()</code> functions. Minimally, this must be a
list that has as many elements as replicates. Each element must be a list
with the elements <code>island_age</code>, <code>not_present</code> and <code>stt_all</code>.
<code>stt_all</code> must be a data frame with the column names <code>Time</code>,
<code>nI</code>, <code>nA</code>, <code>nC</code> and <code>present</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_extract_stt_median_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix (?)
</p>

<hr>
<h2 id='DAISIE_format_CS'>Wrapper function around for the DAISIE_format_CS_full_stt and
DAISIE_format_CS_sampled_stt</h2><span id='topic+DAISIE_format_CS'></span>

<h3>Description</h3>

<p>Wrapper function around for the DAISIE_format_CS_full_stt and
DAISIE_format_CS_sampled_stt
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_format_CS(
  island_replicates,
  time,
  M,
  sample_freq = 25,
  verbose = TRUE,
  trait_pars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_format_CS_+3A_island_replicates">island_replicates</code></td>
<td>
<p>List output from
<code><a href="#topic+DAISIE_sim_core_cr">DAISIE_sim_core_cr</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_time_dep">DAISIE_sim_core_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_cr_shift">DAISIE_sim_core_cr_shift</a>()</code> or
<code><a href="#topic+DAISIE_sim_min_type2">DAISIE_sim_min_type2</a>()</code> functions. Minimally, this must be a
list that has as many elements as replicates. Each element must be a list
with the elements <code>island_age</code>, <code>not_present</code> and <code>stt_all</code>.
<code>stt_all</code> must be a data frame with the column names <code>Time</code>,
<code>nI</code>, <code>nA</code>, <code>nC</code> and <code>present</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>List with CS DAISIE simulation output
</p>

<hr>
<h2 id='DAISIE_format_CS_full_stt'>Formats clade-specific simulation output into standard
DAISIE list output with complete STT table</h2><span id='topic+DAISIE_format_CS_full_stt'></span>

<h3>Description</h3>

<p>Formats clade-specific simulation output into standard
DAISIE list output with complete STT table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_format_CS_full_stt(
  island_replicates,
  time,
  M,
  verbose = TRUE,
  trait_pars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_format_CS_full_stt_+3A_island_replicates">island_replicates</code></td>
<td>
<p>List output from
<code><a href="#topic+DAISIE_sim_core_cr">DAISIE_sim_core_cr</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_time_dep">DAISIE_sim_core_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_cr_shift">DAISIE_sim_core_cr_shift</a>()</code> or
<code><a href="#topic+DAISIE_sim_min_type2">DAISIE_sim_min_type2</a>()</code> functions. Minimally, this must be a
list that has as many elements as replicates. Each element must be a list
with the elements <code>island_age</code>, <code>not_present</code> and <code>stt_all</code>.
<code>stt_all</code> must be a data frame with the column names <code>Time</code>,
<code>nI</code>, <code>nA</code>, <code>nC</code> and <code>present</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_full_stt_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_full_stt_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_full_stt_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_full_stt_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>List with CS DAISIE simulation output
</p>

<hr>
<h2 id='DAISIE_format_CS_sampled_stt'>Formats clade-specific simulation output into standard
DAISIE list output</h2><span id='topic+DAISIE_format_CS_sampled_stt'></span>

<h3>Description</h3>

<p>Formats clade-specific simulation output into standard
DAISIE list output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_format_CS_sampled_stt(
  island_replicates,
  time,
  M,
  sample_freq,
  verbose = TRUE,
  trait_pars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_format_CS_sampled_stt_+3A_island_replicates">island_replicates</code></td>
<td>
<p>List output from
<code><a href="#topic+DAISIE_sim_core_cr">DAISIE_sim_core_cr</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_time_dep">DAISIE_sim_core_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_cr_shift">DAISIE_sim_core_cr_shift</a>()</code> or
<code><a href="#topic+DAISIE_sim_min_type2">DAISIE_sim_min_type2</a>()</code> functions. Minimally, this must be a
list that has as many elements as replicates. Each element must be a list
with the elements <code>island_age</code>, <code>not_present</code> and <code>stt_all</code>.
<code>stt_all</code> must be a data frame with the column names <code>Time</code>,
<code>nI</code>, <code>nA</code>, <code>nC</code> and <code>present</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_sampled_stt_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_sampled_stt_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_sampled_stt_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_sampled_stt_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_format_CS_sampled_stt_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>List with CS DAISIE simulation output
</p>

<hr>
<h2 id='DAISIE_format_GW'>Formats guild-wide simulation output into standard DAISIE
list output</h2><span id='topic+DAISIE_format_GW'></span>

<h3>Description</h3>

<p>Formats guild-wide simulation output into standard DAISIE
list output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_format_GW(
  island_replicates,
  time,
  M,
  sample_freq,
  num_guilds,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_format_GW_+3A_island_replicates">island_replicates</code></td>
<td>
<p>List output from
<code><a href="#topic+DAISIE_sim_core_cr">DAISIE_sim_core_cr</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_time_dep">DAISIE_sim_core_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_cr_shift">DAISIE_sim_core_cr_shift</a>()</code> or
<code><a href="#topic+DAISIE_sim_min_type2">DAISIE_sim_min_type2</a>()</code> functions. Minimally, this must be a
list that has as many elements as replicates. Each element must be a list
with the elements <code>island_age</code>, <code>not_present</code> and <code>stt_all</code>.
<code>stt_all</code> must be a data frame with the column names <code>Time</code>,
<code>nI</code>, <code>nA</code>, <code>nC</code> and <code>present</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_format_GW_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_format_GW_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_format_GW_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_format_GW_+3A_num_guilds">num_guilds</code></td>
<td>
<p>The number of guilds on the mainland. The number of
mainland species is divided by the number of guilds when
<code>divdepmodel = "GW"</code></p>
</td></tr>
<tr><td><code id="DAISIE_format_GW_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with GW DAISIE simulation output
</p>

<hr>
<h2 id='DAISIE_format_IW_full_stt'>Formats clade-specific simulation output into standard
DAISIE list output with complete STT table</h2><span id='topic+DAISIE_format_IW_full_stt'></span>

<h3>Description</h3>

<p>Formats clade-specific simulation output into standard
DAISIE list output with complete STT table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_format_IW_full_stt(island_replicates, total_time, M, verbose)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_format_IW_full_stt_+3A_island_replicates">island_replicates</code></td>
<td>
<p>List output from
<code><a href="#topic+DAISIE_sim_core_cr">DAISIE_sim_core_cr</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_time_dep">DAISIE_sim_core_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_cr_shift">DAISIE_sim_core_cr_shift</a>()</code> or
<code><a href="#topic+DAISIE_sim_min_type2">DAISIE_sim_min_type2</a>()</code> functions. Minimally, this must be a
list that has as many elements as replicates. Each element must be a list
with the elements <code>island_age</code>, <code>not_present</code> and <code>stt_all</code>.
<code>stt_all</code> must be a data frame with the column names <code>Time</code>,
<code>nI</code>, <code>nA</code>, <code>nC</code> and <code>present</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_format_IW_full_stt_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_format_IW_full_stt_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_format_IW_full_stt_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with IW DAISIE simulation output
</p>

<hr>
<h2 id='DAISIE_format_IW_sampled_stt'>Formats island-wide simulation output into standard
DAISIE list output</h2><span id='topic+DAISIE_format_IW_sampled_stt'></span>

<h3>Description</h3>

<p>Formats island-wide simulation output into standard
DAISIE list output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_format_IW_sampled_stt(
  island_replicates,
  total_time,
  M,
  sample_freq,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_format_IW_sampled_stt_+3A_island_replicates">island_replicates</code></td>
<td>
<p>List output from
<code><a href="#topic+DAISIE_sim_core_cr">DAISIE_sim_core_cr</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_time_dep">DAISIE_sim_core_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_cr_shift">DAISIE_sim_core_cr_shift</a>()</code> or
<code><a href="#topic+DAISIE_sim_min_type2">DAISIE_sim_min_type2</a>()</code> functions. Minimally, this must be a
list that has as many elements as replicates. Each element must be a list
with the elements <code>island_age</code>, <code>not_present</code> and <code>stt_all</code>.
<code>stt_all</code> must be a data frame with the column names <code>Time</code>,
<code>nI</code>, <code>nA</code>, <code>nC</code> and <code>present</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_format_IW_sampled_stt_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_format_IW_sampled_stt_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_format_IW_sampled_stt_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_format_IW_sampled_stt_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with IW DAISIE simulation output
</p>

<hr>
<h2 id='DAISIE_IC'>Calculates information criterion from DAISIE ML estimates?</h2><span id='topic+DAISIE_IC'></span>

<h3>Description</h3>

<p>Calculates information criterion from DAISIE ML estimates?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_IC(
  datalist,
  initparsopt,
  idparsopt,
  parsfix,
  idparsfix,
  endmc = 1000,
  res = 100,
  cond = 0,
  ddmodel = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_IC_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object,
but the object can of course also be entered directly.
It is an R list object with the following elements.<br /> The first element
of the list has two or three components: <br /> <br /> <code>$island_age</code> - the
island age <br /> Then, depending on whether a distinction between types is
made, we have:<br /> <code>$not_present</code> - the number of mainland lineages
that are not present on the island <br /> or:<br /> <code>$not_present_type1</code> -
the number of mainland lineages of type 1 that are not present on the
island <br /> <code>$not_present_type2</code> - the number of mainland lineages of
type 2 that are not present on the island <br /> <br /> The remaining elements of
the list each contains information on a single colonist lineage on the
island and has 5 components:<br /> <br /> <code>$colonist_name</code> - the name of the
species or clade that colonized the island <br /> <code>$branching_times</code> -
island age followed by stem age of the population/species in the case of
Non-endemic, Non-endemic_MaxAge species and Endemic species with no close relatives
on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade
including the stem age of the clade<br /> <code>$stac</code> - the
status of the colonist <br /> <br /> * Non_endemic_MaxAge: 1 <br /> * Endemic: 2
<br /> * Endemic&amp;Non_Endemic: 3 <br /> * Non_Endemic: 4 <br />
* Endemic_Singleton_MaxAge: 5 <br /> * Endemic_Clade_MaxAge: 6
<br /> * Endemic&amp;Non_Endemic_Clade_MaxAge: 7 <br />
<br /> <code>$missing_species</code> - number of island species that were not
sampled for particular clade (only applicable for endemic clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or type 2 <br /></p>
</td></tr>
<tr><td><code id="DAISIE_IC_+3A_initparsopt">initparsopt</code></td>
<td>
<p>The initial values of the parameters that must be
optimized, they are all positive.</p>
</td></tr>
<tr><td><code id="DAISIE_IC_+3A_idparsopt">idparsopt</code></td>
<td>
<p>The ids of the parameters that must be optimized. The ids
are defined as follows: <br /> <br /> id = 1 corresponds to lambda^c
(cladogenesis rate) <br /> id = 2 corresponds to mu (extinction rate) <br />
id = 3 corresponds to K (clade-level carrying capacity) <br /> id = 4
corresponds to gamma (immigration rate) <br /> id = 5 corresponds to lambda^a
(anagenesis rate) <br /> id = 6 corresponds to lambda^c (cladogenesis rate)
for an optional subset of the species <br /> id = 7 corresponds to mu
(extinction rate) for an optional subset of the species<br /> id = 8
corresponds to K (clade-level carrying capacity) for an optional subset of
the species<br /> id = 9 corresponds to gamma (immigration rate) for an
optional subset of the species<br /> id = 10 corresponds to lambda^a
(anagenesis rate) for an optional subset of the species<br /> id = 11
corresponds to p_f (fraction of mainland species that belongs to the second
subset of species.</p>
</td></tr>
<tr><td><code id="DAISIE_IC_+3A_parsfix">parsfix</code></td>
<td>
<p>The values of the parameters that should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_IC_+3A_idparsfix">idparsfix</code></td>
<td>
<p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if lambda^c and K should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_IC_+3A_endmc">endmc</code></td>
<td>
<p>Numeric for how many simulations should run.</p>
</td></tr>
<tr><td><code id="DAISIE_IC_+3A_res">res</code></td>
<td>
<p>Sets the maximum number of species for which a probability must
be computed, must be larger than the size of the largest clade.</p>
</td></tr>
<tr><td><code id="DAISIE_IC_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_IC_+3A_ddmodel">ddmodel</code></td>
<td>
<p>Sets the model of diversity-dependence: <br /> <br /> ddmodel = 0 :
no diversity dependence <br /> ddmodel = 1 : linear dependence in speciation
rate <br /> ddmodel = 11: linear dependence in speciation rate and in
immigration rate <br /> ddmodel = 2 : exponential dependence in speciation
rate<br /> ddmodel = 21: exponential dependence in speciation rate and in
immigration rate<br /></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of two numerics with WIC and AICb
</p>

<hr>
<h2 id='DAISIE_IW_num_threads'>IW concurrency control</h2><span id='topic+DAISIE_IW_num_threads'></span>

<h3>Description</h3>

<p>Sets or retrieves the number of threads used by the odeint solver.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_IW_num_threads(num_threads)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_IW_num_threads_+3A_num_threads">num_threads</code></td>
<td>
<p><code>num_threads &lt; 0 or omitted</code>: retrieves number of threads. <br />
<code>num_threads = 0</code>: sets the number of threads to the number of available cores. <br />
<code>num_threads = 1</code>: single-threaded execution. <br />
<code>num_threads &gt; 1</code>: sets the number of threads to <code>num_threads</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>number of threads
</p>


<h3>Note</h3>

<p>The maximum number of threads is limited to the value of the C++
standard library function <code>std::thread::hardware_concurrency()</code>.
This is also the default number of threads upon library load.
Multithreading incurs some overhead. Therefore, single-threaded execution
might be faster for small systems.
</p>

<hr>
<h2 id='DAISIE_loglik_CS'>Computes the loglikelihood of the DAISIE model with clade-specific
diversity-dependence given data and a set of model parameters</h2><span id='topic+DAISIE_loglik_CS'></span><span id='topic+DAISIE_loglik_all'></span>

<h3>Description</h3>

<p>Computes the loglikelihood of the DAISIE model with clade-specific
diversity-dependence given colonization and branching times for lineages on
an island, and a set of model parameters. The output is a loglikelihood value
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_loglik_CS(
  pars1,
  pars2,
  datalist,
  methode = "lsodes",
  CS_version = 1,
  abstolint = 1e-16,
  reltolint = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_loglik_CS_+3A_pars1">pars1</code></td>
<td>
<p>Contains the model parameters: <br /> <br />
<code>pars1[1]</code> corresponds to lambda^c (cladogenesis rate) <br />
<code>pars1[2]</code> corresponds to mu (extinction rate) <br />
<code>pars1[3]</code> corresponds to K (clade-level carrying capacity) <br />
<code>pars1[4]</code> corresponds to gamma (immigration rate) <br />
<code>pars1[5]</code> corresponds to lambda^a (anagenesis rate) <br />
<code>pars1[6]</code> corresponds to lambda^c (cladogenesis rate) for an optional
subset of the species <br />
<code>pars1[7]</code> corresponds to mu (extinction rate) for an optional subset of the species<br />
<code>pars1[8]</code> corresponds to K (clade-level carrying capacity) for an optional subset of the
species<br />
<code>pars1[9]</code> corresponds to gamma (immigration rate) for an optional subset of the species<br />
<code>pars1[10]</code> corresponds to lambda^a (anagenesis rate) for an optional subset of the species<br />
<code>pars1[11]</code> corresponds to p_f (fraction of mainland species that belongs to the second
subset of species<br />
The elements 6:10 and 11 are optional, that is, pars1
should either contain 5, 10 or 11 elements. If 10, then the fraction of
potential colonists of type 2 is computed from the data. If 11, then
pars1[11] is used, overruling any information in the data.</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_CS_+3A_pars2">pars2</code></td>
<td>
<p>Contains the model settings <br /> <br />
<code>pars2[1]</code> corresponds to lx = length of ODE variable x <br />
<code>pars2[2]</code> corresponds to ddmodel = diversity-dependent model, model of diversity-dependence, which can be one
of<br /> <br />
ddmodel = 0 : no diversity dependence <br />
ddmodel = 1 : linear dependence in speciation rate <br />
ddmodel = 11: linear dependence in speciation rate and in immigration rate <br />
ddmodel = 2 : exponential dependence in speciation rate<br />
ddmodel = 21: exponential dependence in speciation rate and in immigration rate<br /><br />
<code>pars2[3]</code> corresponds to cond = setting of conditioning<br /> <br />
cond = 0 : conditioning on island age <br />
cond = 1 : conditioning on island age and non-extinction of the island biota <br /> <br />
cond &gt; 1 : conditioning on island age and having at least cond colonizations on the island <br /> <br />
<code>pars2[4]</code> sets whether parameters and likelihood should be printed (1) or not (0)</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_CS_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object, but
the object can of course also be entered directly. It is an R list object
with the following elements.<br /> The first element of the list has two or
three components:
<br /> <br /> <code>$island_age</code> - the island age <br />
Then, depending on whether a distinction between types is made, we have:<br />
<code>$not_present</code> - the number of mainland lineages that are not present
on the island <br />
or:<br />
<code>$not_present_type1</code> - the number of mainland lineages of type 1 that are not present on the island <br />
<code>$not_present_type2</code> - the number of mainland lineages of type 2 that
are not present on the island <br /> <br />
The remaining elements of the list
each contains information on a single colonist lineage on the island and has
5 components:<br /> <br />
<code>$colonist_name</code> - the name of the species or
clade that colonized the island <br />
<code>$branching_times</code> - island age and
stem age of the population/species in the case of Non-endemic,
Non-endemic_MaxAge and Endemic anagenetic species. For cladogenetic species
these should be island age and branching times of the radiation including
the stem age of the radiation.<br />
<code>$stac</code> - the status of the colonist <br /> <br />
* Non_endemic_MaxAge: 1 <br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_Endemic: 4 <br />
* Endemic_Singleton_MaxAge: 5 <br />
* Endemic_Clade_MaxAge: 6 <br />
* Endemic&amp;Non_Endemic_Clade_MaxAge: 7 <br /> <br />
* Non_endemic_MaxAge_MinAge: 8 <br />
* Endemic_Singleton_MaxAge_MinAge: 9 <br />
<code>$missing_species</code> - number of island species that were not sampled for
particular clade (only applicable for endemic clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or type 2 <br /></p>
</td></tr>
<tr><td><code id="DAISIE_loglik_CS_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. See package deSolve for details.
Default is &quot;lsodes&quot;</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_CS_+3A_cs_version">CS_version</code></td>
<td>
<p>a numeric or list. Default is 1 for the standard DAISIE
model, for a relaxed-rate model a list with the following elements:
</p>

<ul>
<li><p>model: the CS model to run, options are <code>1</code> for single rate
DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
model.
</p>
</li>
<li><p>relaxed_par: the parameter to relax (integrate over). Options are
<code>"cladogenesis"</code>, <code>"extinction"</code>, <code>"carrying_capacity"</code>,
<code>"immigration"</code>, or <code>"anagenesis"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_loglik_CS_+3A_abstolint">abstolint</code></td>
<td>
<p>Absolute tolerance of the integration</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_CS_+3A_reltolint">reltolint</code></td>
<td>
<p>Relative tolerance of the integration</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The loglikelihood
</p>


<h3>Author(s)</h3>

<p>Rampal S. Etienne &amp; Bart Haegeman
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_ML">DAISIE_ML</a></code>, <code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a></code>,
<code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a></code>,
<code><a href="#topic+DAISIE_sim_cr_shift">DAISIE_sim_cr_shift</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
utils::data(Galapagos_datalist_2types)
pars1 = c(0.195442017,0.087959583,Inf,0.002247364,0.873605049,
          3755.202241,8.909285094,14.99999923,0.002247364,0.873605049,0.163)
pars2 = c(100,11,0,1)
DAISIE_loglik_all(pars1,pars2,Galapagos_datalist_2types)

</code></pre>

<hr>
<h2 id='DAISIE_loglik_integrand'>Integrand to be integrated to calculate the log likelihood for the relaxed
rate model.</h2><span id='topic+DAISIE_loglik_integrand'></span>

<h3>Description</h3>

<p>Integrand to be integrated to calculate the log likelihood for the relaxed
rate model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_loglik_integrand(
  DAISIE_par,
  pars1,
  pars2,
  brts,
  stac,
  missnumspec,
  methode,
  abstolint,
  reltolint,
  verbose,
  pick,
  par_mean,
  par_sd
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_loglik_integrand_+3A_daisie_par">DAISIE_par</code></td>
<td>
<p>A numeric parameter to evaluate the integral of the
function.</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrand_+3A_pars1">pars1</code></td>
<td>
<p>Vector of model parameters: <br /> <br /> <code>pars1[1]</code> corresponds
to lambda^c (cladogenesis rate) <br /> <code>pars1[2]</code> corresponds to mu
(extinction rate) <br /> <code>pars1[3]</code> corresponds to K (clade-level
carrying capacity) <br /> <code>pars1[4]</code> corresponds to gamma
(immigration rate) <br /> <code>pars1[5]</code> corresponds to lambda^a
(anagenesis rate).</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrand_+3A_pars2">pars2</code></td>
<td>
<p>Vector of settings: <br /> <br /> <code>pars2[1]</code> corresponds to res,
the maximum number of endemics or non-endemics for which the ODE system is
solved; this must be much larger than the actual number for which the
probability needs to be calculated.) <br /> <code>pars2[2]</code> corresponds to M,
size of the mainland pool, i.e the number of species that can potentially
colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrand_+3A_brts">brts</code></td>
<td>
<p>Numeric vector of branching times</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrand_+3A_stac">stac</code></td>
<td>
<p>Numeric of Endemicity status</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrand_+3A_missnumspec">missnumspec</code></td>
<td>
<p>Numeric of missing species</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrand_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. Supported Boost <code>ODEINT</code>
solvers (steppers) are:
<code>"odeint::runge_kutta_cash_karp54"</code>
<code>"odeint::runge_kutta_fehlberg78"</code>
<code>"odeint::runge_kutta_dopri5"</code>
<code>"odeint::bulirsch_stoer"</code>
without <code>odeint::</code>-prefix, <code><a href="deSolve.html#topic+deSolve">deSolve</a>{ode}</code> method is
assumed. The default method overall is
<code>"lsodes"</code> for <code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a>()</code>
and <code>"ode45"</code> from <code><a href="deSolve.html#topic+ode">ode</a>()</code> for
<code><a href="#topic+DAISIE_ML_IW">DAISIE_ML_IW</a>()</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrand_+3A_abstolint">abstolint</code></td>
<td>
<p>Numeric absolute tolerance of the integration</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrand_+3A_reltolint">reltolint</code></td>
<td>
<p>Numeric relative tolerance of the integration</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrand_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrand_+3A_pick">pick</code></td>
<td>
<p>Numeric determining which parameter is selected for the
relaxed-rate model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric
</p>

<hr>
<h2 id='DAISIE_loglik_integrate'>Integrates the loglikelihood of a single clade across a parameter weighted
by a given distribution</h2><span id='topic+DAISIE_loglik_integrate'></span>

<h3>Description</h3>

<p>Integrates the loglikelihood of a single clade across a parameter weighted
by a given distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_loglik_integrate(
  pars1,
  pars2,
  brts,
  stac,
  missnumspec,
  CS_version,
  methode,
  abstolint,
  reltolint,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_loglik_integrate_+3A_pars1">pars1</code></td>
<td>
<p>Vector of model parameters: <br /> <br /> <code>pars1[1]</code> corresponds
to lambda^c (cladogenesis rate) <br /> <code>pars1[2]</code> corresponds to mu
(extinction rate) <br /> <code>pars1[3]</code> corresponds to K (clade-level
carrying capacity) <br /> <code>pars1[4]</code> corresponds to gamma
(immigration rate) <br /> <code>pars1[5]</code> corresponds to lambda^a
(anagenesis rate).</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrate_+3A_pars2">pars2</code></td>
<td>
<p>Vector of settings: <br /> <br /> <code>pars2[1]</code> corresponds to res,
the maximum number of endemics or non-endemics for which the ODE system is
solved; this must be much larger than the actual number for which the
probability needs to be calculated.) <br /> <code>pars2[2]</code> corresponds to M,
size of the mainland pool, i.e the number of species that can potentially
colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrate_+3A_brts">brts</code></td>
<td>
<p>Numeric vector of branching times</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrate_+3A_stac">stac</code></td>
<td>
<p>Numeric of Endemicity status</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrate_+3A_missnumspec">missnumspec</code></td>
<td>
<p>Numeric of missing species</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrate_+3A_cs_version">CS_version</code></td>
<td>
<p>a numeric or list. Default is 1 for the standard DAISIE
model, for a relaxed-rate model a list with the following elements:
</p>

<ul>
<li><p>model: the CS model to run, options are <code>1</code> for single rate
DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
model.
</p>
</li>
<li><p>relaxed_par: the parameter to relax (integrate over). Options are
<code>"cladogenesis"</code>, <code>"extinction"</code>, <code>"carrying_capacity"</code>,
<code>"immigration"</code>, or <code>"anagenesis"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrate_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. Supported Boost <code>ODEINT</code>
solvers (steppers) are:
<code>"odeint::runge_kutta_cash_karp54"</code>
<code>"odeint::runge_kutta_fehlberg78"</code>
<code>"odeint::runge_kutta_dopri5"</code>
<code>"odeint::bulirsch_stoer"</code>
without <code>odeint::</code>-prefix, <code><a href="deSolve.html#topic+deSolve">deSolve</a>{ode}</code> method is
assumed. The default method overall is
<code>"lsodes"</code> for <code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a>()</code>
and <code>"ode45"</code> from <code><a href="deSolve.html#topic+ode">ode</a>()</code> for
<code><a href="#topic+DAISIE_ML_IW">DAISIE_ML_IW</a>()</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrate_+3A_abstolint">abstolint</code></td>
<td>
<p>Numeric absolute tolerance of the integration</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrate_+3A_reltolint">reltolint</code></td>
<td>
<p>Numeric relative tolerance of the integration</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_integrate_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A loglikelihood value
</p>

<hr>
<h2 id='DAISIE_loglik_IW'>Computes the loglikelihood of the DAISIE model with island-wide
diversity-dependence given data and a set of model parameters</h2><span id='topic+DAISIE_loglik_IW'></span>

<h3>Description</h3>

<p>Computes the loglikelihood of the DAISIE model given colonization and
branching times for lineages on an island, and a set of model parameters for
the DAISIE model with island-wide diversity-dependence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_loglik_IW(
  pars1,
  pars2,
  datalist,
  methode = "lsodes",
  abstolint = 1e-12,
  reltolint = 1e-10,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_loglik_IW_+3A_pars1">pars1</code></td>
<td>
<p>Contains the model parameters: <br /> <br />
<code>pars1[1]</code> corresponds to lambda^c (cladogenesis rate) <br />
<code>pars1[2]</code> corresponds to mu (extinction rate) <br />
<code>pars1[3]</code> corresponds to K (clade-level carrying capacity) <br />
<code>pars1[4]</code> corresponds to gamma (immigration rate) <br />
<code>pars1[5]</code> corresponds to lambda^a (anagenesis rate) <br />
<code>pars1[6]</code> is optional; it may contain M, the total number of species
on the mainland <br /> <br /></p>
</td></tr>
<tr><td><code id="DAISIE_loglik_IW_+3A_pars2">pars2</code></td>
<td>
<p>Contains the model settings <br /> <br />
<code>pars2[1]</code> corresponds to lx = length of ODE variable x <br />
<code>pars2[2]</code> corresponds to ddmodel = diversity-dependent model, model of diversity-dependence, which can be one
of<br /> <br />
ddmodel = 0 : no diversity dependence <br />
ddmodel = 1 : linear dependence in speciation rate <br />
ddmodel = 11: linear dependence in speciation rate and in immigration rate <br />
ddmodel = 2 : exponential dependence in speciation rate<br />
ddmodel = 21: exponential dependence in speciation rate and in immigration rate<br />
Only ddmodel = 11 is currently implemented <br /> <br />
<code>pars2[3]</code> corresponds to cond = setting of conditioning<br /> <br />
cond = 0 : conditioning on island age <br />
cond = 1 : conditioning on island age and non-extinction of the island biota <br /> <br />
<code>pars2[4]</code> Specifies whether intermediate output should be provided,
because computation may take long. Default is 0, no output. A value of 1
means the parameters and loglikelihood are printed. A value of 2 means also
intermediate progress during loglikelihood computation is shown.</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_IW_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object, but
the object can of course also be entered directly. It is an R list object
with the following elements.<br />
The first element of the list has two or
three components: <br /> <br />
<code>$island_age</code> - the island age <br />
Then, depending on whether a distinction between types is made, we have:<br />
<code>$not_present</code> - the number of mainland lineages that are not present
on the island <br /> The remaining elements of the list each contains
information on a single colonist lineage on the island and has 5
components:<br /> <br />
<code>$colonist_name</code> - the name of the species or clade
that colonized the island <br />
<code>$branching_times</code> - island age and stem
age of the population/species in the case of Non-endemic, Non-endemic_MaxAge
and Endemic anagenetic species. For cladogenetic species these should be
island age and branching times of the radiation including the stem age of
the radiation.<br />
<code>$stac</code> - the status of the colonist <br /> <br />
* Non_endemic_MaxAge: 1 <br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_endemic: 4 <br />
* Endemic_MaxAge: 5 <br /> <br />
<code>$missing_species</code> -
number of island species that were not sampled for particular clade (only
applicable for endemic clades) <br /></p>
</td></tr>
<tr><td><code id="DAISIE_loglik_IW_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. Supported Boost <code>ODEINT</code>
solvers (steppers) are:
<code>'odeint::runge_kutta_cash_karp54'</code>
<code>'odeint::runge_kutta_fehlberg78'</code> [default]
<code>'odeint::runge_kutta_dopri5'</code>
<code>'odeint::bulirsch_stoer'</code>
<code>'odeint::adams_bashforth_[1|2|3|4|5|6|7|8]}
\code{'odeint::adams_bashforth_moulton_[1|2|3|4|5|6|7|8]</code>
without <code>odeint::</code>-prefix, <code><a href="deSolve.html#topic+ode">ode</a></code> method is
assumed.</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_IW_+3A_abstolint">abstolint</code></td>
<td>
<p>Absolute tolerance of the integration</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_IW_+3A_reltolint">reltolint</code></td>
<td>
<p>Relative tolerance of the integration</p>
</td></tr>
<tr><td><code id="DAISIE_loglik_IW_+3A_verbose">verbose</code></td>
<td>
<p>Logical controling if progress is printed to console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output is a loglikelihood value
</p>


<h3>Value</h3>

<p>The loglikelihood
</p>


<h3>Author(s)</h3>

<p>Rampal S. Etienne &amp; Bart Haegeman
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_ML_IW">DAISIE_ML_IW</a></code>, <code><a href="#topic+DAISIE_loglik_CS">DAISIE_loglik_CS</a></code>,
<code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a></code>
</p>

<hr>
<h2 id='DAISIE_make_archipelago'>Does some things</h2><span id='topic+DAISIE_make_archipelago'></span>

<h3>Description</h3>

<p>Does some things
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_make_archipelago(archipelago, M, phylo_data, archipelago_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_make_archipelago_+3A_archipelago">archipelago</code></td>
<td>
<p>something</p>
</td></tr>
<tr><td><code id="DAISIE_make_archipelago_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_make_archipelago_+3A_phylo_data">phylo_data</code></td>
<td>
<p>something</p>
</td></tr>
<tr><td><code id="DAISIE_make_archipelago_+3A_archipelago_data">archipelago_data</code></td>
<td>
<p>something</p>
</td></tr>
</table>


<h3>Value</h3>

<p>something
</p>

<hr>
<h2 id='DAISIE_make_global'>Does something</h2><span id='topic+DAISIE_make_global'></span>

<h3>Description</h3>

<p>Does something
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_make_global(archipelago_list, M, phylo_data, archipelago_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_make_global_+3A_archipelago_list">archipelago_list</code></td>
<td>
<p>something</p>
</td></tr>
<tr><td><code id="DAISIE_make_global_+3A_m">M</code></td>
<td>
<p>something</p>
</td></tr>
<tr><td><code id="DAISIE_make_global_+3A_phylo_data">phylo_data</code></td>
<td>
<p>something</p>
</td></tr>
<tr><td><code id="DAISIE_make_global_+3A_archipelago_data">archipelago_data</code></td>
<td>
<p>something</p>
</td></tr>
</table>


<h3>Value</h3>

<p>something
</p>

<hr>
<h2 id='DAISIE_margprobdist'>The marginal distribution of endemics and non-endemics under the DAISIE
model</h2><span id='topic+DAISIE_margprobdist'></span>

<h3>Description</h3>

<p>This function calculates the marginal distribution of the number of endemics
and non-endemics and their sum for a given set of parameter values, a given
mainland species pool size and a given set of times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_margprobdist(
  pars1,
  pars2,
  tvec,
  initEI = c(0, 0),
  initprobs = NULL,
  pb = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_margprobdist_+3A_pars1">pars1</code></td>
<td>
<p>Vector of model parameters: <br /> <br /> <code>pars1[1]</code> corresponds
to lambda^c (cladogenesis rate) <br /> <code>pars1[2]</code> corresponds to mu
(extinction rate) <br /> <code>pars1[3]</code> corresponds to K (clade-level
carrying capacity) <br /> <code>pars1[4]</code> corresponds to gamma
(immigration rate) <br /> <code>pars1[5]</code> corresponds to lambda^a
(anagenesis rate).</p>
</td></tr>
<tr><td><code id="DAISIE_margprobdist_+3A_pars2">pars2</code></td>
<td>
<p>Vector of settings: <br /> <br /> <code>pars2[1]</code> corresponds to res,
the maximum number of endemics or non-endemics for which the ODE system is
solved; this must be much larger than the actual number for which the
probability needs to be calculated.) <br /> <code>pars2[2]</code> corresponds to M,
size of the mainland pool, i.e the number of species that can potentially
colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_margprobdist_+3A_tvec">tvec</code></td>
<td>
<p>The times at which the probabilities need to be computed.</p>
</td></tr>
<tr><td><code id="DAISIE_margprobdist_+3A_initei">initEI</code></td>
<td>
<p>The initial values for the number of endemics and
non-endemics. In <code><a href="#topic+DAISIE_probdist">DAISIE_probdist</a>()</code> or
<code><a href="#topic+DAISIE_margprobdist">DAISIE_margprobdist</a>()</code> either this or initprobs must be NULL. In
<code><a href="#topic+DAISIE_numcol">DAISIE_numcol</a>()</code> when it is NULL, it is assumed that the island
is empty.</p>
</td></tr>
<tr><td><code id="DAISIE_margprobdist_+3A_initprobs">initprobs</code></td>
<td>
<p>The initial probability distribution for the number of
endemics and non-endemics; either this or initEI must be NULL.</p>
</td></tr>
<tr><td><code id="DAISIE_margprobdist_+3A_pb">pb</code></td>
<td>
<p>Probability distribution in matrix format as output by
<code><a href="#topic+DAISIE_probdist">DAISIE_probdist</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out</code></td>
<td>
<p>A list of three vectors: <br /> <br /> <code>pE</code> The
probability distribution of the number of endemic species <br /> <code>pI</code> The
probability distribution of the number of non-endemic species <br /> <code>pN</code>
The probability distribution of the sum of the number of endemics and
non-endemics </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rampal S. Etienne
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Compute the marginal probability distributions at t = 4 and t = 8, for a mainland
# pool size of 250 potential colonists and a vector of 5 parameters (cladogenesis,
# extinction, clade-level carrying capacity, immigration, anagenesis) starting from
# an empty island

marg_prob_dists &lt;- DAISIE_margprobdist(
   pars1 = c(0.3,0.35,Inf,0.75,0.012),
   pars2 = c(100,250),
   tvec = c(4,8),
   initEI = c(5,1),
   initprobs = NULL
   )

</code></pre>

<hr>
<h2 id='DAISIE_ML'>Maximization of the loglikelihood under the DAISIE model with clade-specific
diversity-dependence</h2><span id='topic+DAISIE_ML'></span><span id='topic+DAISIE_ML_CS'></span>

<h3>Description</h3>

<p>This function computes the maximum likelihood estimates of the parameters of
the DAISIE model with clade-specific diversity-dependence for data from
lineages colonizing an island. It also outputs the corresponding
loglikelihood that can be used in model comparisons.
The result of sort(c(idparsopt, idparsfix, idparsnoshift)) should be
identical to c(1:10). If not, an error is reported that the input is
incoherent. The same happens when the length of initparsopt is different
from the length of idparsopt, and the length of parsfix is different from
the length of idparsfix.<br /> Including the 11th parameter (p_f) in either
idparsopt or idparsfix (and therefore initparsopt or parsfix) is optional.
If this parameter is not specified, then the information in the data is
used, otherwise the information in the data is overruled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_ML_CS(
  datalist,
  datatype = "single",
  initparsopt,
  idparsopt,
  parsfix,
  idparsfix,
  idparsnoshift = 6:10,
  idparsmat = NULL,
  res = 100,
  ddmodel = 0,
  cond = 0,
  island_ontogeny = NA,
  eqmodel = 0,
  x_E = 0.95,
  x_I = 0.98,
  tol = c(1e-04, 1e-05, 1e-07),
  maxiter = 1000 * round((1.25)^length(idparsopt)),
  methode = "lsodes",
  optimmethod = "subplex",
  CS_version = 1,
  verbose = 0,
  tolint = c(1e-16, 1e-10),
  jitter = 0,
  num_cycles = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_ML_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object,
but the object can of course also be entered directly.
It is an R list object with the following elements.<br /> The first element
of the list has two or three components: <br /> <br /> <code>$island_age</code> - the
island age <br /> Then, depending on whether a distinction between types is
made, we have:<br /> <code>$not_present</code> - the number of mainland lineages
that are not present on the island <br /> or:<br /> <code>$not_present_type1</code> -
the number of mainland lineages of type 1 that are not present on the
island <br /> <code>$not_present_type2</code> - the number of mainland lineages of
type 2 that are not present on the island <br /> <br /> The remaining elements of
the list each contains information on a single colonist lineage on the
island and has 5 components:<br /> <br /> <code>$colonist_name</code> - the name of the
species or clade that colonized the island <br /> <code>$branching_times</code> -
island age followed by stem age of the population/species in the case of
Non-endemic, Non-endemic_MaxAge species and Endemic species with no close relatives
on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade
including the stem age of the clade<br /> <code>$stac</code> - the
status of the colonist <br /> <br /> * Non_endemic_MaxAge: 1 <br /> * Endemic: 2
<br /> * Endemic&amp;Non_Endemic: 3 <br /> * Non_Endemic: 4 <br />
* Endemic_Singleton_MaxAge: 5 <br /> * Endemic_Clade_MaxAge: 6
<br /> * Endemic&amp;Non_Endemic_Clade_MaxAge: 7 <br />
<br /> <code>$missing_species</code> - number of island species that were not
sampled for particular clade (only applicable for endemic clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or type 2 <br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_datatype">datatype</code></td>
<td>
<p>Sets the type of data: 'single' for a single island or
archipelago treated as one, and 'multiple' for multiple archipelagoes
potentially sharing the same parameters.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_initparsopt">initparsopt</code></td>
<td>
<p>The initial values of the parameters that must be
optimized, they are all positive.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_idparsopt">idparsopt</code></td>
<td>
<p>The ids of the parameters that must be optimized. The ids
are defined as follows: <br /> <br /> id = 1 corresponds to lambda^c
(cladogenesis rate) <br /> id = 2 corresponds to mu (extinction rate) <br />
id = 3 corresponds to K (clade-level carrying capacity) <br /> id = 4
corresponds to gamma (immigration rate) <br /> id = 5 corresponds to lambda^a
(anagenesis rate) <br /> id = 6 corresponds to lambda^c (cladogenesis rate)
for an optional subset of the species <br /> id = 7 corresponds to mu
(extinction rate) for an optional subset of the species<br /> id = 8
corresponds to K (clade-level carrying capacity) for an optional subset of
the species<br /> id = 9 corresponds to gamma (immigration rate) for an
optional subset of the species<br /> id = 10 corresponds to lambda^a
(anagenesis rate) for an optional subset of the species<br /> id = 11
corresponds to p_f (fraction of mainland species that belongs to the second
subset of species.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_parsfix">parsfix</code></td>
<td>
<p>The values of the parameters that should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_idparsfix">idparsfix</code></td>
<td>
<p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if lambda^c and K should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_idparsnoshift">idparsnoshift</code></td>
<td>
<p>For datatype = 'single' only: The ids of the parameters
that should not be different between two groups of species; This can only
apply to ids 6:10, e.g. idparsnoshift = c(6,7) means that lambda^c and mu
have the same values for both groups.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_idparsmat">idparsmat</code></td>
<td>
<p>For datatype = 'multiple' only: Matrix containing the ids
of the parameters, linking them to initparsopt and parsfix. Per island
system we use the following order: <br /> <br /> * lac = (initial) cladogenesis
rate <br /> * mu = extinction rate <br /> * K = maximum number of species possible
in the clade <br /> * gam = (initial) immigration rate <br /> * laa = (initial)
anagenesis rate <br /> Example:
<code>idparsmat = rbind(c(1, 2, 3, 4, 5), c(1, 2, 3, 6, 7))</code> has different
rates of immigration and anagenesis for the two islands.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_res">res</code></td>
<td>
<p>Sets the maximum number of species for which a probability must
be computed, must be larger than the size of the largest clade.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_ddmodel">ddmodel</code></td>
<td>
<p>Sets the model of diversity-dependence: <br /> <br /> ddmodel = 0 :
no diversity dependence <br /> ddmodel = 1 : linear dependence in speciation
rate <br /> ddmodel = 11: linear dependence in speciation rate and in
immigration rate <br /> ddmodel = 2 : exponential dependence in speciation
rate<br /> ddmodel = 21: exponential dependence in speciation rate and in
immigration rate<br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_eqmodel">eqmodel</code></td>
<td>
<p>Sets the equilibrium constraint that can be used during the
likelihood optimization. Only available for datatype = 'single'.<br /><br />
eqmodel = 0 : no equilibrium is assumed <br /> eqmodel = 13 : near-equilibrium
is assumed on endemics using deterministic equation for endemics and
immigrants. Endemics must be within x_E of the equilibrium value<br /> eqmodel
= 15 : near-equilibrium is assumed on endemics and immigrants using
deterministic equation for endemics and immigrants. Endemics must be within
x_E of the equilibrium value, while non-endemics must be within x_I of the
equilibrium value.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_x_e">x_E</code></td>
<td>
<p>Sets the fraction of the equlibrium endemic diversity above which
the endemics are assumed to be in equilibrium; only active for eqmodel = 13
or 15.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_x_i">x_I</code></td>
<td>
<p>Sets the fraction of the equlibrium non-endemic diversity above
which the system is assumed to be in equilibrium; only active for eqmodel =
15.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_tol">tol</code></td>
<td>
<p>Sets the tolerances in the optimization. Consists of: <br /> reltolx
= relative tolerance of parameter values in optimization <br /> reltolf =
relative tolerance of function value in optimization <br /> abstolx = absolute
tolerance of parameter values in optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_maxiter">maxiter</code></td>
<td>
<p>Sets the maximum number of iterations in the optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. Supported Boost <code>ODEINT</code>
solvers (steppers) are:
<code>"odeint::runge_kutta_cash_karp54"</code>
<code>"odeint::runge_kutta_fehlberg78"</code>
<code>"odeint::runge_kutta_dopri5"</code>
<code>"odeint::bulirsch_stoer"</code>
without <code>odeint::</code>-prefix, <code><a href="deSolve.html#topic+deSolve">deSolve</a>{ode}</code> method is
assumed. The default method overall is
<code>"lsodes"</code> for <code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a>()</code>
and <code>"ode45"</code> from <code><a href="deSolve.html#topic+ode">ode</a>()</code> for
<code><a href="#topic+DAISIE_ML_IW">DAISIE_ML_IW</a>()</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_optimmethod">optimmethod</code></td>
<td>
<p>Method used in likelihood optimization. Default is
'subplex' (see '<a href="subplex.html#topic+subplex">subplex</a>()' for full details).
Alternative is <code>"simplex"</code> which was the method in previous versions.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_cs_version">CS_version</code></td>
<td>
<p>a numeric or list. Default is 1 for the standard DAISIE
model, for a relaxed-rate model a list with the following elements:
</p>

<ul>
<li><p>model: the CS model to run, options are <code>1</code> for single rate
DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
model.
</p>
</li>
<li><p>relaxed_par: the parameter to relax (integrate over). Options are
<code>"cladogenesis"</code>, <code>"extinction"</code>, <code>"carrying_capacity"</code>,
<code>"immigration"</code>, or <code>"anagenesis"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_tolint">tolint</code></td>
<td>
<p>Vector of two elements containing the absolute and relative
tolerance of the integration.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_jitter">jitter</code></td>
<td>
<p>Numeric for <code><a href="DDD.html#topic+optimizer">optimizer</a>()</code>. Jitters the
parameters being optimized by the specified amount which should be very
small, e.g. 1e-5. Jitter when <code>link{subplex}{subplex}()</code> produces
incorrect output due to parameter transformation.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_+3A_num_cycles">num_cycles</code></td>
<td>
<p>The number of cycles the optimizer will go through.
Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a dataframe containing estimated parameters and
maximum loglikelihood.
</p>
<table>
<tr><td><code>lambda_c</code></td>
<td>
<p> gives the maximum likelihood
estimate of lambda^c, the rate of cladogenesis</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p> gives the maximum
likelihood estimate of mu, the extinction rate</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p> gives the maximum
likelihood estimate of K, the carrying-capacity</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p> gives the maximum likelihood estimate of gamma, the immigration rate </p>
</td></tr>
<tr><td><code>lambda_a</code></td>
<td>
<p> gives the maximum likelihood estimate of lambda^a, the rate
of anagenesis</p>
</td></tr>
<tr><td><code>lambda_c2</code></td>
<td>
<p> gives the maximum likelihood estimate of lambda^c2,
the rate of cladogenesis for the optional second group of species</p>
</td></tr>
<tr><td><code>mu2</code></td>
<td>
<p> gives the maximum likelihood estimate of mu2, the extinction rate for
the optional second group of species</p>
</td></tr>
<tr><td><code>K2</code></td>
<td>
<p> gives the maximum likelihood estimate of K2, the carrying-capacity
for the optional second group of species</p>
</td></tr>
<tr><td><code>gamma2</code></td>
<td>
<p> gives the maximum likelihood estimate of gamma2, the immigration rate for the optional second
group of species</p>
</td></tr>
<tr><td><code>lambda_a2</code></td>
<td>
<p> gives the maximum likelihood estimate of
lambda^a2, the rate of anagenesis for the optional second group of species</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> gives the maximum loglikelihood</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p> gives the number of estimated parameters, i.e. degrees of feedom</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p> gives a
message on convergence of optimization; conv = 0 means convergence</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rampal S. Etienne
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852. &lt;doi:10.1111/ele.12461&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_loglik_all">DAISIE_loglik_all</a></code>,
<code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a></code>,
<code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a></code>,
<code><a href="#topic+DAISIE_sim_cr_shift">DAISIE_sim_cr_shift</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cat("
### When all species have the same rates, and we want to optimize all 5 parameters,
# we use:

utils::data(Galapagos_datalist)
DAISIE_ML(
   datalist = Galapagos_datalist,
   initparsopt = c(2.5,2.7,20,0.009,1.01),
   ddmodel = 11,
   idparsopt = 1:5,
   parsfix = NULL,
   idparsfix = NULL
)

### When all species have the same rates, and we want to optimize all parameters
# except K (which we set equal to Inf), we use:

utils::data(Galapagos_datalist)
DAISIE_ML(
   datalist = Galapagos_datalist,
   initparsopt = c(2.5,2.7,0.009,1.01),
   idparsopt = c(1,2,4,5),
   parsfix = Inf,
   idparsfix = 3
   )

### When all species have the same rates except that the finches have a different
# rate of cladogenesis, and we want to optimize all parameters except K (which we
# set equal to Inf), fixing the proportion of finch-type species at 0.163, we use:

utils::data(Galapagos_datalist_2types)
DAISIE_ML(
   datalist = Galapagos_datalist_2types,
   initparsopt = c(0.38,0.55,0.004,1.1,2.28),
   idparsopt = c(1,2,4,5,6),
   parsfix = c(Inf,Inf,0.163),
   idparsfix = c(3,8,11),
   idparsnoshift = c(7,9,10)
   )

### When all species have the same rates except that the finches have a different
# rate of cladogenesis, extinction and a different K, and we want to optimize all
# parameters, fixing the proportion of finch-type species at 0.163, we use:

utils::data(Galapagos_datalist_2types)
DAISIE_ML(
   datalist = Galapagos_datalist_2types,
   ddmodel = 11,
   initparsopt = c(0.19,0.09,0.002,0.87,20,8.9,15),
   idparsopt = c(1,2,4,5,6,7,8),
   parsfix = c(Inf,0.163),
   idparsfix = c(3,11),
   idparsnoshift = c(9,10)
   )


### When all species have the same rates except that the finches have a different
# rate of extinction, and we want to optimize all parameters except K (which we
# set equal to Inf), and we also# want to estimate the fraction of finch species
# in the mainland pool. we use:

utils::data(Galapagos_datalist_2types)
DAISIE_ML(
   datalist = Galapagos_datalist_2types,
   initparsopt = c(2.48,2.7,0.009,1.01,2.25,0.163),
   idparsopt = c(1,2,4,5,7,11),
   parsfix = c(Inf,Inf),
   idparsfix = c(3,8),
   idparsnoshift = c(6,9,10)
   )

### When we have two islands with the same rates except for immigration and anagenesis rate,
# and we want to optimize all parameters, we use:

utils::data(Galapagos_datalist)
DAISIE_ML(
   datalist = list(Galapagos_datalist,Galapagos_datalist),
   datatype = 'multiple',
   initparsopt = c(2.5,2.7,20,0.009,1.01,0.009,1.01),
   idparsmat = rbind(1:5,c(1:3,6,7)),
   idparsopt = 1:7,
   parsfix = NULL,
   idparsfix = NULL
)

### When we consider the four Macaronesia archipelagoes and set all parameters the same
# except for rates of cladogenesis, extinction and immigration for Canary Islands,
# rate of cladogenesis is fixed to 0 for the other archipelagoes,
# diversity-dependence is assumed to be absent
# and we want to optimize all parameters, we use:

utils::data(Macaronesia_datalist)
DAISIE_ML(
   datalist = Macaronesia_datalist,
   datatype = 'multiple',
   initparsopt = c(1.053151832,0.052148979,0.512939011,0.133766934,0.152763179),
   idparsmat = rbind(1:5,c(6,2,3,7,5),1:5,1:5),
   idparsopt = c(2,4,5,6,7),
   parsfix = c(0,Inf),
   idparsfix = c(1,3)
)

")

</code></pre>

<hr>
<h2 id='DAISIE_ML_IW'>Maximization of the loglikelihood under the DAISIE model with island-wide
diversity-dependence</h2><span id='topic+DAISIE_ML_IW'></span>

<h3>Description</h3>

<p>This function computes the maximum likelihood estimates of the parameters of
the DAISIE model with island-wide diversity-dependence for data from
lineages colonizing an island. It also outputs the corresponding
loglikelihood that can be used in model comparisons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_ML_IW(
  datalist,
  initparsopt,
  idparsopt,
  parsfix,
  idparsfix,
  res = 100,
  ddmodel = 11,
  cond = 0,
  tol = c(1e-04, 1e-05, 1e-07),
  maxiter = 1000 * round((1.25)^length(idparsopt)),
  methode = "ode45",
  optimmethod = "subplex",
  verbose = 0,
  tolint = c(1e-16, 1e-14),
  jitter = 0,
  num_cycles = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_ML_IW_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object,
but the object can of course also be entered directly.
It is an R list object with the following elements.<br /> The first element
of the list has two or three components: <br /> <br /> <code>$island_age</code> - the
island age <br /> Then, depending on whether a distinction between types is
made, we have:<br /> <code>$not_present</code> - the number of mainland lineages
that are not present on the island <br /> or:<br /> <code>$not_present_type1</code> -
the number of mainland lineages of type 1 that are not present on the
island <br /> <code>$not_present_type2</code> - the number of mainland lineages of
type 2 that are not present on the island <br /> <br /> The remaining elements of
the list each contains information on a single colonist lineage on the
island and has 5 components:<br /> <br /> <code>$colonist_name</code> - the name of the
species or clade that colonized the island <br /> <code>$branching_times</code> -
island age followed by stem age of the population/species in the case of
Non-endemic, Non-endemic_MaxAge species and Endemic species with no close relatives
on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade
including the stem age of the clade<br /> <code>$stac</code> - the
status of the colonist <br /> <br /> * Non_endemic_MaxAge: 1 <br /> * Endemic: 2
<br /> * Endemic&amp;Non_Endemic: 3 <br /> * Non_Endemic: 4 <br />
* Endemic_Singleton_MaxAge: 5 <br /> * Endemic_Clade_MaxAge: 6
<br /> * Endemic&amp;Non_Endemic_Clade_MaxAge: 7 <br />
<br /> <code>$missing_species</code> - number of island species that were not
sampled for particular clade (only applicable for endemic clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or type 2 <br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_initparsopt">initparsopt</code></td>
<td>
<p>The initial values of the parameters that must be
optimized, they are all positive.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_idparsopt">idparsopt</code></td>
<td>
<p>The ids of the parameters that must be optimized. The ids
are defined as follows: <br /> <br /> id = 1 corresponds to lambda^c
(cladogenesis rate) <br /> id = 2 corresponds to mu (extinction rate) <br />
id = 3 corresponds to K (clade-level carrying capacity) <br /> id = 4
corresponds to gamma (immigration rate) <br /> id = 5 corresponds to lambda^a
(anagenesis rate) <br /> id = 6 corresponds to lambda^c (cladogenesis rate)
for an optional subset of the species <br /> id = 7 corresponds to mu
(extinction rate) for an optional subset of the species<br /> id = 8
corresponds to K (clade-level carrying capacity) for an optional subset of
the species<br /> id = 9 corresponds to gamma (immigration rate) for an
optional subset of the species<br /> id = 10 corresponds to lambda^a
(anagenesis rate) for an optional subset of the species<br /> id = 11
corresponds to p_f (fraction of mainland species that belongs to the second
subset of species.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_parsfix">parsfix</code></td>
<td>
<p>The values of the parameters that should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_idparsfix">idparsfix</code></td>
<td>
<p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if lambda^c and K should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_res">res</code></td>
<td>
<p>Sets the maximum number of species for which a probability must
be computed, must be larger than the size of the largest clade.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_ddmodel">ddmodel</code></td>
<td>
<p>Sets the model of diversity-dependence: <br /> <br /> ddmodel = 0 :
no diversity dependence <br /> ddmodel = 1 : linear dependence in speciation
rate <br /> ddmodel = 11: linear dependence in speciation rate and in
immigration rate <br /> ddmodel = 2 : exponential dependence in speciation
rate<br /> ddmodel = 21: exponential dependence in speciation rate and in
immigration rate<br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_tol">tol</code></td>
<td>
<p>Sets the tolerances in the optimization. Consists of: <br /> reltolx
= relative tolerance of parameter values in optimization <br /> reltolf =
relative tolerance of function value in optimization <br /> abstolx = absolute
tolerance of parameter values in optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_maxiter">maxiter</code></td>
<td>
<p>Sets the maximum number of iterations in the optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. Supported Boost <code>ODEINT</code>
solvers (steppers) are:
<code>"odeint::runge_kutta_cash_karp54"</code>
<code>"odeint::runge_kutta_fehlberg78"</code>
<code>"odeint::runge_kutta_dopri5"</code>
<code>"odeint::bulirsch_stoer"</code>
without <code>odeint::</code>-prefix, <code><a href="deSolve.html#topic+deSolve">deSolve</a>{ode}</code> method is
assumed. The default method overall is
<code>"lsodes"</code> for <code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a>()</code>
and <code>"ode45"</code> from <code><a href="deSolve.html#topic+ode">ode</a>()</code> for
<code><a href="#topic+DAISIE_ML_IW">DAISIE_ML_IW</a>()</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_optimmethod">optimmethod</code></td>
<td>
<p>Method used in likelihood optimization. Default is
'subplex' (see '<a href="subplex.html#topic+subplex">subplex</a>()' for full details).
Alternative is <code>"simplex"</code> which was the method in previous versions.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_tolint">tolint</code></td>
<td>
<p>Vector of two elements containing the absolute and relative
tolerance of the integration.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_jitter">jitter</code></td>
<td>
<p>Numeric for <code><a href="DDD.html#topic+optimizer">optimizer</a>()</code>. Jitters the
parameters being optimized by the specified amount which should be very
small, e.g. 1e-5. Jitter when <code>link{subplex}{subplex}()</code> produces
incorrect output due to parameter transformation.</p>
</td></tr>
<tr><td><code id="DAISIE_ML_IW_+3A_num_cycles">num_cycles</code></td>
<td>
<p>The number of cycles the optimizer will go through.
Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The result of sort(c(idparsopt, idparsfix)) should be identical to c(1:5).
If not, an error is reported that the input is incoherent. The same happens
when the length of initparsopt is different from the length of idparsopt,
and the length of parsfix is different from the length of idparsfix.<br />
</p>


<h3>Value</h3>

<p>The output is a dataframe containing estimated parameters and
maximum loglikelihood.  </p>
<table>
<tr><td><code>lambda_c</code></td>
<td>
<p> gives the maximum likelihood
estimate of lambda^c, the rate of cladogenesis</p>
</td></tr> <tr><td><code>mu</code></td>
<td>
<p> gives the maximum
likelihood estimate of mu, the extinction rate</p>
</td></tr> <tr><td><code>K</code></td>
<td>
<p> gives the maximum
likelihood estimate of K, the carrying-capacity</p>
</td></tr> <tr><td><code>gamma</code></td>
<td>
<p> gives the
maximum likelihood estimate of gamma, the immigration rate </p>
</td></tr>
<tr><td><code>lambda_a</code></td>
<td>
<p> gives the maximum likelihood estimate of lambda^a, the rate
of anagenesis</p>
</td></tr> <tr><td><code>loglik</code></td>
<td>
<p> gives the maximum loglikelihood</p>
</td></tr> <tr><td><code>df</code></td>
<td>

<p>gives the number of estimated parameters, i.e. degrees of feedom</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p> gives a message on convergence of optimization; conv = 0 means
convergence</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rampal S. Etienne
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852. &lt;DOI:10.1111/ele.12461&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_loglik_IW">DAISIE_loglik_IW</a></code>, <code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code>
<code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a></code>
</p>

<hr>
<h2 id='DAISIE_ML1'>Computes MLE for single type species under a clade specific scenario</h2><span id='topic+DAISIE_ML1'></span>

<h3>Description</h3>

<p>Computes MLE for single type species under a clade specific scenario
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_ML1(
  datalist,
  initparsopt,
  idparsopt,
  parsfix,
  idparsfix,
  idparsnoshift = 6:10,
  res = 100,
  ddmodel = 0,
  cond = 0,
  eqmodel = 0,
  x_E = 0.95,
  x_I = 0.98,
  tol = c(1e-04, 1e-05, 1e-07),
  maxiter = 1000 * round((1.25)^length(idparsopt)),
  methode = "lsodes",
  optimmethod = "subplex",
  CS_version = 1,
  verbose = 0,
  tolint = c(1e-16, 1e-10),
  island_ontogeny = NA,
  jitter = 0,
  num_cycles = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_ML1_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object,
but the object can of course also be entered directly.
It is an R list object with the following elements.<br /> The first element
of the list has two or three components: <br /> <br /> <code>$island_age</code> - the
island age <br /> Then, depending on whether a distinction between types is
made, we have:<br /> <code>$not_present</code> - the number of mainland lineages
that are not present on the island <br /> or:<br /> <code>$not_present_type1</code> -
the number of mainland lineages of type 1 that are not present on the
island <br /> <code>$not_present_type2</code> - the number of mainland lineages of
type 2 that are not present on the island <br /> <br /> The remaining elements of
the list each contains information on a single colonist lineage on the
island and has 5 components:<br /> <br /> <code>$colonist_name</code> - the name of the
species or clade that colonized the island <br /> <code>$branching_times</code> -
island age followed by stem age of the population/species in the case of
Non-endemic, Non-endemic_MaxAge species and Endemic species with no close relatives
on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade
including the stem age of the clade<br /> <code>$stac</code> - the
status of the colonist <br /> <br /> * Non_endemic_MaxAge: 1 <br /> * Endemic: 2
<br /> * Endemic&amp;Non_Endemic: 3 <br /> * Non_Endemic: 4 <br />
* Endemic_Singleton_MaxAge: 5 <br /> * Endemic_Clade_MaxAge: 6
<br /> * Endemic&amp;Non_Endemic_Clade_MaxAge: 7 <br />
<br /> <code>$missing_species</code> - number of island species that were not
sampled for particular clade (only applicable for endemic clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or type 2 <br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_initparsopt">initparsopt</code></td>
<td>
<p>The initial values of the parameters that must be
optimized, they are all positive.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_idparsopt">idparsopt</code></td>
<td>
<p>The ids of the parameters that must be optimized. The ids
are defined as follows: <br /> <br /> id = 1 corresponds to lambda^c
(cladogenesis rate) <br /> id = 2 corresponds to mu (extinction rate) <br />
id = 3 corresponds to K (clade-level carrying capacity) <br /> id = 4
corresponds to gamma (immigration rate) <br /> id = 5 corresponds to lambda^a
(anagenesis rate) <br /> id = 6 corresponds to lambda^c (cladogenesis rate)
for an optional subset of the species <br /> id = 7 corresponds to mu
(extinction rate) for an optional subset of the species<br /> id = 8
corresponds to K (clade-level carrying capacity) for an optional subset of
the species<br /> id = 9 corresponds to gamma (immigration rate) for an
optional subset of the species<br /> id = 10 corresponds to lambda^a
(anagenesis rate) for an optional subset of the species<br /> id = 11
corresponds to p_f (fraction of mainland species that belongs to the second
subset of species.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_parsfix">parsfix</code></td>
<td>
<p>The values of the parameters that should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_idparsfix">idparsfix</code></td>
<td>
<p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if lambda^c and K should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_idparsnoshift">idparsnoshift</code></td>
<td>
<p>For datatype = 'single' only: The ids of the parameters
that should not be different between two groups of species; This can only
apply to ids 6:10, e.g. idparsnoshift = c(6,7) means that lambda^c and mu
have the same values for both groups.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_res">res</code></td>
<td>
<p>Sets the maximum number of species for which a probability must
be computed, must be larger than the size of the largest clade.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_ddmodel">ddmodel</code></td>
<td>
<p>Sets the model of diversity-dependence: <br /> <br /> ddmodel = 0 :
no diversity dependence <br /> ddmodel = 1 : linear dependence in speciation
rate <br /> ddmodel = 11: linear dependence in speciation rate and in
immigration rate <br /> ddmodel = 2 : exponential dependence in speciation
rate<br /> ddmodel = 21: exponential dependence in speciation rate and in
immigration rate<br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_eqmodel">eqmodel</code></td>
<td>
<p>Sets the equilibrium constraint that can be used during the
likelihood optimization. Only available for datatype = 'single'.<br /><br />
eqmodel = 0 : no equilibrium is assumed <br /> eqmodel = 13 : near-equilibrium
is assumed on endemics using deterministic equation for endemics and
immigrants. Endemics must be within x_E of the equilibrium value<br /> eqmodel
= 15 : near-equilibrium is assumed on endemics and immigrants using
deterministic equation for endemics and immigrants. Endemics must be within
x_E of the equilibrium value, while non-endemics must be within x_I of the
equilibrium value.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_x_e">x_E</code></td>
<td>
<p>Sets the fraction of the equlibrium endemic diversity above which
the endemics are assumed to be in equilibrium; only active for eqmodel = 13
or 15.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_x_i">x_I</code></td>
<td>
<p>Sets the fraction of the equlibrium non-endemic diversity above
which the system is assumed to be in equilibrium; only active for eqmodel =
15.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_tol">tol</code></td>
<td>
<p>Sets the tolerances in the optimization. Consists of: <br /> reltolx
= relative tolerance of parameter values in optimization <br /> reltolf =
relative tolerance of function value in optimization <br /> abstolx = absolute
tolerance of parameter values in optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_maxiter">maxiter</code></td>
<td>
<p>Sets the maximum number of iterations in the optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. Supported Boost <code>ODEINT</code>
solvers (steppers) are:
<code>"odeint::runge_kutta_cash_karp54"</code>
<code>"odeint::runge_kutta_fehlberg78"</code>
<code>"odeint::runge_kutta_dopri5"</code>
<code>"odeint::bulirsch_stoer"</code>
without <code>odeint::</code>-prefix, <code><a href="deSolve.html#topic+deSolve">deSolve</a>{ode}</code> method is
assumed. The default method overall is
<code>"lsodes"</code> for <code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a>()</code>
and <code>"ode45"</code> from <code><a href="deSolve.html#topic+ode">ode</a>()</code> for
<code><a href="#topic+DAISIE_ML_IW">DAISIE_ML_IW</a>()</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_optimmethod">optimmethod</code></td>
<td>
<p>Method used in likelihood optimization. Default is
'subplex' (see '<a href="subplex.html#topic+subplex">subplex</a>()' for full details).
Alternative is <code>"simplex"</code> which was the method in previous versions.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_cs_version">CS_version</code></td>
<td>
<p>a numeric or list. Default is 1 for the standard DAISIE
model, for a relaxed-rate model a list with the following elements:
</p>

<ul>
<li><p>model: the CS model to run, options are <code>1</code> for single rate
DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
model.
</p>
</li>
<li><p>relaxed_par: the parameter to relax (integrate over). Options are
<code>"cladogenesis"</code>, <code>"extinction"</code>, <code>"carrying_capacity"</code>,
<code>"immigration"</code>, or <code>"anagenesis"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_tolint">tolint</code></td>
<td>
<p>Vector of two elements containing the absolute and relative
tolerance of the integration.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_jitter">jitter</code></td>
<td>
<p>Numeric for <code><a href="DDD.html#topic+optimizer">optimizer</a>()</code>. Jitters the
parameters being optimized by the specified amount which should be very
small, e.g. 1e-5. Jitter when <code>link{subplex}{subplex}()</code> produces
incorrect output due to parameter transformation.</p>
</td></tr>
<tr><td><code id="DAISIE_ML1_+3A_num_cycles">num_cycles</code></td>
<td>
<p>The number of cycles the optimizer will go through.
Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a dataframe containing estimated parameters and
maximum loglikelihood.  </p>
<table>
<tr><td><code>lambda_c</code></td>
<td>
<p> gives the maximum likelihood
estimate of lambda^c, the rate of cladogenesis</p>
</td></tr> <tr><td><code>mu</code></td>
<td>
<p> gives the maximum
likelihood estimate of mu, the extinction rate</p>
</td></tr> <tr><td><code>K</code></td>
<td>
<p> gives the maximum
likelihood estimate of K, the carrying-capacity</p>
</td></tr> <tr><td><code>gamma</code></td>
<td>
<p> gives the
maximum likelihood estimate of gamma, the immigration rate </p>
</td></tr>
<tr><td><code>lambda_a</code></td>
<td>
<p> gives the maximum likelihood estimate of lambda^a, the rate
of anagenesis</p>
</td></tr> <tr><td><code>loglik</code></td>
<td>
<p> gives the maximum loglikelihood</p>
</td></tr> <tr><td><code>df</code></td>
<td>

<p>gives the number
of estimated parameters, i.e. degrees of feedom</p>
</td></tr> <tr><td><code>conv</code></td>
<td>
<p> gives a
message on convergence of optimization; conv = 0 means convergence</p>
</td></tr>
</table>

<hr>
<h2 id='DAISIE_ML2'>Computes MLE for multiple islands under a clade specific scenario</h2><span id='topic+DAISIE_ML2'></span>

<h3>Description</h3>

<p>Computes MLE for multiple islands under a clade specific scenario
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_ML2(
  datalist,
  initparsopt,
  idparsopt,
  parsfix,
  idparsfix,
  idparsmat,
  res = 100,
  ddmodel = 0,
  cond = 0,
  island_ontogeny = NA,
  tol = c(1e-04, 1e-05, 1e-07),
  maxiter = 1000 * round((1.25)^length(idparsopt)),
  methode = "lsodes",
  optimmethod = "subplex",
  verbose = 0,
  tolint = c(1e-16, 1e-10),
  jitter = 0,
  num_cycles = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_ML2_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object,
but the object can of course also be entered directly.
It is an R list object with the following elements.<br /> The first element
of the list has two or three components: <br /> <br /> <code>$island_age</code> - the
island age <br /> Then, depending on whether a distinction between types is
made, we have:<br /> <code>$not_present</code> - the number of mainland lineages
that are not present on the island <br /> or:<br /> <code>$not_present_type1</code> -
the number of mainland lineages of type 1 that are not present on the
island <br /> <code>$not_present_type2</code> - the number of mainland lineages of
type 2 that are not present on the island <br /> <br /> The remaining elements of
the list each contains information on a single colonist lineage on the
island and has 5 components:<br /> <br /> <code>$colonist_name</code> - the name of the
species or clade that colonized the island <br /> <code>$branching_times</code> -
island age followed by stem age of the population/species in the case of
Non-endemic, Non-endemic_MaxAge species and Endemic species with no close relatives
on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade
including the stem age of the clade<br /> <code>$stac</code> - the
status of the colonist <br /> <br /> * Non_endemic_MaxAge: 1 <br /> * Endemic: 2
<br /> * Endemic&amp;Non_Endemic: 3 <br /> * Non_Endemic: 4 <br />
* Endemic_Singleton_MaxAge: 5 <br /> * Endemic_Clade_MaxAge: 6
<br /> * Endemic&amp;Non_Endemic_Clade_MaxAge: 7 <br />
<br /> <code>$missing_species</code> - number of island species that were not
sampled for particular clade (only applicable for endemic clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or type 2 <br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_initparsopt">initparsopt</code></td>
<td>
<p>The initial values of the parameters that must be
optimized, they are all positive.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_idparsopt">idparsopt</code></td>
<td>
<p>The ids of the parameters that must be optimized. The ids
are defined as follows: <br /> <br /> id = 1 corresponds to lambda^c
(cladogenesis rate) <br /> id = 2 corresponds to mu (extinction rate) <br />
id = 3 corresponds to K (clade-level carrying capacity) <br /> id = 4
corresponds to gamma (immigration rate) <br /> id = 5 corresponds to lambda^a
(anagenesis rate) <br /> id = 6 corresponds to lambda^c (cladogenesis rate)
for an optional subset of the species <br /> id = 7 corresponds to mu
(extinction rate) for an optional subset of the species<br /> id = 8
corresponds to K (clade-level carrying capacity) for an optional subset of
the species<br /> id = 9 corresponds to gamma (immigration rate) for an
optional subset of the species<br /> id = 10 corresponds to lambda^a
(anagenesis rate) for an optional subset of the species<br /> id = 11
corresponds to p_f (fraction of mainland species that belongs to the second
subset of species.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_parsfix">parsfix</code></td>
<td>
<p>The values of the parameters that should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_idparsfix">idparsfix</code></td>
<td>
<p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if lambda^c and K should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_idparsmat">idparsmat</code></td>
<td>
<p>For datatype = 'multiple' only: Matrix containing the ids
of the parameters, linking them to initparsopt and parsfix. Per island
system we use the following order: <br /> <br /> * lac = (initial) cladogenesis
rate <br /> * mu = extinction rate <br /> * K = maximum number of species possible
in the clade <br /> * gam = (initial) immigration rate <br /> * laa = (initial)
anagenesis rate <br /> Example:
<code>idparsmat = rbind(c(1, 2, 3, 4, 5), c(1, 2, 3, 6, 7))</code> has different
rates of immigration and anagenesis for the two islands.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_res">res</code></td>
<td>
<p>Sets the maximum number of species for which a probability must
be computed, must be larger than the size of the largest clade.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_ddmodel">ddmodel</code></td>
<td>
<p>Sets the model of diversity-dependence: <br /> <br /> ddmodel = 0 :
no diversity dependence <br /> ddmodel = 1 : linear dependence in speciation
rate <br /> ddmodel = 11: linear dependence in speciation rate and in
immigration rate <br /> ddmodel = 2 : exponential dependence in speciation
rate<br /> ddmodel = 21: exponential dependence in speciation rate and in
immigration rate<br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_tol">tol</code></td>
<td>
<p>Sets the tolerances in the optimization. Consists of: <br /> reltolx
= relative tolerance of parameter values in optimization <br /> reltolf =
relative tolerance of function value in optimization <br /> abstolx = absolute
tolerance of parameter values in optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_maxiter">maxiter</code></td>
<td>
<p>Sets the maximum number of iterations in the optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. Supported Boost <code>ODEINT</code>
solvers (steppers) are:
<code>"odeint::runge_kutta_cash_karp54"</code>
<code>"odeint::runge_kutta_fehlberg78"</code>
<code>"odeint::runge_kutta_dopri5"</code>
<code>"odeint::bulirsch_stoer"</code>
without <code>odeint::</code>-prefix, <code><a href="deSolve.html#topic+deSolve">deSolve</a>{ode}</code> method is
assumed. The default method overall is
<code>"lsodes"</code> for <code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a>()</code>
and <code>"ode45"</code> from <code><a href="deSolve.html#topic+ode">ode</a>()</code> for
<code><a href="#topic+DAISIE_ML_IW">DAISIE_ML_IW</a>()</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_optimmethod">optimmethod</code></td>
<td>
<p>Method used in likelihood optimization. Default is
'subplex' (see '<a href="subplex.html#topic+subplex">subplex</a>()' for full details).
Alternative is <code>"simplex"</code> which was the method in previous versions.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_tolint">tolint</code></td>
<td>
<p>Vector of two elements containing the absolute and relative
tolerance of the integration.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_jitter">jitter</code></td>
<td>
<p>Numeric for <code><a href="DDD.html#topic+optimizer">optimizer</a>()</code>. Jitters the
parameters being optimized by the specified amount which should be very
small, e.g. 1e-5. Jitter when <code>link{subplex}{subplex}()</code> produces
incorrect output due to parameter transformation.</p>
</td></tr>
<tr><td><code id="DAISIE_ML2_+3A_num_cycles">num_cycles</code></td>
<td>
<p>The number of cycles the optimizer will go through.
Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a dataframe containing estimated parameters and
maximum loglikelihood.  </p>
<table>
<tr><td><code>lambda_c</code></td>
<td>
<p> gives the maximum likelihood
estimate of lambda^c, the rate of cladogenesis</p>
</td></tr> <tr><td><code>mu</code></td>
<td>
<p> gives the maximum
likelihood estimate of mu, the extinction rate</p>
</td></tr> <tr><td><code>K</code></td>
<td>
<p> gives the maximum
likelihood estimate of K, the carrying-capacity</p>
</td></tr> <tr><td><code>gamma</code></td>
<td>
<p> gives the
maximum likelihood estimate of gamma, the immigration rate </p>
</td></tr>
<tr><td><code>lambda_a</code></td>
<td>
<p> gives the maximum likelihood estimate of lambda^a, the rate
of anagenesis</p>
</td></tr> <tr><td><code>lambda_c2</code></td>
<td>
<p> gives the maximum likelihood estimate of
lambda^c2, the rate of cladogenesis for the second group of
species</p>
</td></tr> <tr><td><code>mu2</code></td>
<td>
<p> gives the maximum likelihood estimate of mu2, the
extinction rate for the second group of species</p>
</td></tr> <tr><td><code>K2</code></td>
<td>
<p> gives
the maximum likelihood estimate of K2, the carrying-capacity for the
second group of species</p>
</td></tr> <tr><td><code>gamma2</code></td>
<td>
<p> gives the maximum
likelihood estimate of gamma2, the immigration rate for the second
group of species</p>
</td></tr> <tr><td><code>lambda_a2</code></td>
<td>
<p> gives the maximum likelihood estimate of
lambda^a2, the rate of anagenesis for the second group of species</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> gives the maximum loglikelihood</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p> gives the number
of estimated parameters, i.e. degrees of feedom</p>
</td></tr> <tr><td><code>conv</code></td>
<td>
<p> gives a
message on convergence of optimization; conv = 0 means convergence</p>
</td></tr>
</table>

<hr>
<h2 id='DAISIE_ML4'>Computes MLE for single type species under a clade specific scenario where
one parameter may vary over the clades governed by a specific distribution</h2><span id='topic+DAISIE_ML4'></span>

<h3>Description</h3>

<p>Computes MLE for single type species under a clade specific scenario where
one parameter may vary over the clades governed by a specific distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_ML4(
  datalist,
  initparsopt,
  idparsopt,
  parsfix,
  idparsfix,
  res = 100,
  ddmodel = 0,
  cond = 0,
  tol = c(1e-04, 1e-05, 1e-07),
  maxiter = 1000 * round((1.25)^length(idparsopt)),
  methode = "lsodes",
  optimmethod = "subplex",
  CS_version = create_CS_version(model = 2, relaxed_par = "cladogenesis", par_sd = 0,
    par_upper_bound = Inf),
  verbose = 0,
  tolint = c(1e-16, 1e-10),
  island_ontogeny = NA,
  jitter = 0,
  num_cycles = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_ML4_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object,
but the object can of course also be entered directly.
It is an R list object with the following elements.<br /> The first element
of the list has two or three components: <br /> <br /> <code>$island_age</code> - the
island age <br /> Then, depending on whether a distinction between types is
made, we have:<br /> <code>$not_present</code> - the number of mainland lineages
that are not present on the island <br /> or:<br /> <code>$not_present_type1</code> -
the number of mainland lineages of type 1 that are not present on the
island <br /> <code>$not_present_type2</code> - the number of mainland lineages of
type 2 that are not present on the island <br /> <br /> The remaining elements of
the list each contains information on a single colonist lineage on the
island and has 5 components:<br /> <br /> <code>$colonist_name</code> - the name of the
species or clade that colonized the island <br /> <code>$branching_times</code> -
island age followed by stem age of the population/species in the case of
Non-endemic, Non-endemic_MaxAge species and Endemic species with no close relatives
on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade
including the stem age of the clade<br /> <code>$stac</code> - the
status of the colonist <br /> <br /> * Non_endemic_MaxAge: 1 <br /> * Endemic: 2
<br /> * Endemic&amp;Non_Endemic: 3 <br /> * Non_Endemic: 4 <br />
* Endemic_Singleton_MaxAge: 5 <br /> * Endemic_Clade_MaxAge: 6
<br /> * Endemic&amp;Non_Endemic_Clade_MaxAge: 7 <br />
<br /> <code>$missing_species</code> - number of island species that were not
sampled for particular clade (only applicable for endemic clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or type 2 <br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_initparsopt">initparsopt</code></td>
<td>
<p>The initial values of the parameters that must be
optimized, they are all positive.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_idparsopt">idparsopt</code></td>
<td>
<p>The ids of the parameters that must be optimized. The ids
are defined as follows: <br /> <br /> id = 1 corresponds to lambda^c
(cladogenesis rate) <br /> id = 2 corresponds to mu (extinction rate) <br />
id = 3 corresponds to K (clade-level carrying capacity) <br /> id = 4
corresponds to gamma (immigration rate) <br /> id = 5 corresponds to lambda^a
(anagenesis rate) <br /> id = 6 corresponds to lambda^c (cladogenesis rate)
for an optional subset of the species <br /> id = 7 corresponds to mu
(extinction rate) for an optional subset of the species<br /> id = 8
corresponds to K (clade-level carrying capacity) for an optional subset of
the species<br /> id = 9 corresponds to gamma (immigration rate) for an
optional subset of the species<br /> id = 10 corresponds to lambda^a
(anagenesis rate) for an optional subset of the species<br /> id = 11
corresponds to p_f (fraction of mainland species that belongs to the second
subset of species.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_parsfix">parsfix</code></td>
<td>
<p>The values of the parameters that should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_idparsfix">idparsfix</code></td>
<td>
<p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if lambda^c and K should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_res">res</code></td>
<td>
<p>Sets the maximum number of species for which a probability must
be computed, must be larger than the size of the largest clade.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_ddmodel">ddmodel</code></td>
<td>
<p>Sets the model of diversity-dependence: <br /> <br /> ddmodel = 0 :
no diversity dependence <br /> ddmodel = 1 : linear dependence in speciation
rate <br /> ddmodel = 11: linear dependence in speciation rate and in
immigration rate <br /> ddmodel = 2 : exponential dependence in speciation
rate<br /> ddmodel = 21: exponential dependence in speciation rate and in
immigration rate<br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_tol">tol</code></td>
<td>
<p>Sets the tolerances in the optimization. Consists of: <br /> reltolx
= relative tolerance of parameter values in optimization <br /> reltolf =
relative tolerance of function value in optimization <br /> abstolx = absolute
tolerance of parameter values in optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_maxiter">maxiter</code></td>
<td>
<p>Sets the maximum number of iterations in the optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. Supported Boost <code>ODEINT</code>
solvers (steppers) are:
<code>"odeint::runge_kutta_cash_karp54"</code>
<code>"odeint::runge_kutta_fehlberg78"</code>
<code>"odeint::runge_kutta_dopri5"</code>
<code>"odeint::bulirsch_stoer"</code>
without <code>odeint::</code>-prefix, <code><a href="deSolve.html#topic+deSolve">deSolve</a>{ode}</code> method is
assumed. The default method overall is
<code>"lsodes"</code> for <code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a>()</code>
and <code>"ode45"</code> from <code><a href="deSolve.html#topic+ode">ode</a>()</code> for
<code><a href="#topic+DAISIE_ML_IW">DAISIE_ML_IW</a>()</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_optimmethod">optimmethod</code></td>
<td>
<p>Method used in likelihood optimization. Default is
'subplex' (see '<a href="subplex.html#topic+subplex">subplex</a>()' for full details).
Alternative is <code>"simplex"</code> which was the method in previous versions.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_cs_version">CS_version</code></td>
<td>
<p>a numeric or list. Default is 1 for the standard DAISIE
model, for a relaxed-rate model a list with the following elements:
</p>

<ul>
<li><p>model: the CS model to run, options are <code>1</code> for single rate
DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
model.
</p>
</li>
<li><p>relaxed_par: the parameter to relax (integrate over). Options are
<code>"cladogenesis"</code>, <code>"extinction"</code>, <code>"carrying_capacity"</code>,
<code>"immigration"</code>, or <code>"anagenesis"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_tolint">tolint</code></td>
<td>
<p>Vector of two elements containing the absolute and relative
tolerance of the integration.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_jitter">jitter</code></td>
<td>
<p>Numeric for <code><a href="DDD.html#topic+optimizer">optimizer</a>()</code>. Jitters the
parameters being optimized by the specified amount which should be very
small, e.g. 1e-5. Jitter when <code>link{subplex}{subplex}()</code> produces
incorrect output due to parameter transformation.</p>
</td></tr>
<tr><td><code id="DAISIE_ML4_+3A_num_cycles">num_cycles</code></td>
<td>
<p>The number of cycles the optimizer will go through.
Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a dataframe containing estimated parameters and
maximum loglikelihood.
</p>
<table>
<tr><td><code>lambda_c</code></td>
<td>
<p> gives the maximum likelihood
estimate of lambda^c, the rate of cladogenesis</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p> gives the maximum
likelihood estimate of mu, the extinction rate</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p> gives the maximum
likelihood estimate of K, the carrying-capacity</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p> gives the
maximum likelihood estimate of gamma, the immigration rate </p>
</td></tr>
<tr><td><code>lambda_a</code></td>
<td>
<p> gives the maximum likelihood estimate of lambda^a, the rate
of anagenesis</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>gives the maximum likelihood estimate of the standard
deviation for the parameter which is allowed to vary</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> gives the maximum loglikelihood</p>
</td></tr>
<tr><td><code>df</code></td>
<td>

<p>gives the number
of estimated parameters, i.e. degrees of freedom</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p> gives a
message on convergence of optimization; conv = 0 means convergence</p>
</td></tr>
</table>

<hr>
<h2 id='DAISIE_MW_ML'>Maximization of the loglikelihood under the DAISIE model with clade-specific
diversity-dependence and explicit dependencies on island area and isolation
as hypothesized by MacArthur &amp; Wilson</h2><span id='topic+DAISIE_MW_ML'></span>

<h3>Description</h3>

<p>This function computes the maximum likelihood estimates of the parameters of
the relationships between parameters of the DAISIE model (with clade-specific
diversity-dependence) and island area and distance of the island to the
mainland for data from lineages colonizing several
islands/archipelagos. It also outputs the corresponding loglikelihood that
can be used in model comparisons.
</p>
<p>A note on the sigmoidal functions used in distance_dep: For anagenesis and
cladogenesis, the functional relationship is k * (d/d0)^x/(1 + (d/d0)^x);
for colonization the relationship is: k - k * (d/d0)^x/(1 + (d/d0)^x). The
d0 parameter is the 11th parameter entered. In 'sigmoidal_col_ana',
the 11th parameter is the d0 for colonization and the 12th is the d0 for
anagenesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_MW_ML(
  datalist,
  initparsopt,
  idparsopt,
  parsfix,
  idparsfix,
  res = 100,
  ddmodel = 11,
  cond = 0,
  island_ontogeny = NA,
  tol = c(1e-04, 1e-05, 1e-07),
  maxiter = 1000 * round((1.25)^length(idparsopt)),
  methode = "lsodes",
  optimmethod = "subplex",
  CS_version = 1,
  verbose = 0,
  tolint = c(1e-16, 1e-10),
  distance_type = "continent",
  distance_dep = "power",
  parallel = "local",
  cpus = 3,
  num_cycles = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_MW_ML_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times of species for several islands or archipelagos, as well as the area,
isolation and age of each of the islands/archipelagos. See data(archipelagos41) for
an example.</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_initparsopt">initparsopt</code></td>
<td>
<p>The initial values of the parameters that must be
optimized; they are all positive</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_idparsopt">idparsopt</code></td>
<td>
<p>The ids of the parameters that must be optimized. The ids
are defined as follows (see Valente et al 2020 Supplementary Tables 1 and 2
a better explanation of the models and parameters): <br /> <br />
id = 1 corresponds to lambda^c0 (cladogenesis rate for unit area) <br />
id = 2 corresponds to y (exponent of area for cladogenesis rate) <br />
id = 3 corresponds to mu0 (extinction rate for unit area) <br />
id = 4 corresponds to x (exponent of 1/area for extinction rate) <br />
id = 5 corresponds to K0 (clade-level carrying capacity for unit area) <br />
id = 6 corresponds to z (exponent of area for clade-level carrying capacity) <br />
id = 7 corresponds to gamma0 (immigration rate for unit distance) <br />
id = 8 corresponds to alpha (exponent of 1/distance for immigration rate) <br /> id = 9 corresponds to lambda^a0 (anagenesis rate for
unit distance) <br />
id = 10 corresponds to beta (exponent of 1/distance for anagenesis rate) <br />
id = 11 corresponds to d0 in models M15 to M19, and models with
distance_dep = 'sigmoidal_col', 'sigmoidal_ana' or 'sigmoidal_clado';
or d0 for colonisation (when specifying distance_dep = 'sigmoidal_col_ana'<br />
id = 12 corresponds to d0 for anagenesis when specifying
distance_dep = 'sigmoidal_col_ana' <br /></p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_parsfix">parsfix</code></td>
<td>
<p>The values of the parameters that should not be optimized</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_idparsfix">idparsfix</code></td>
<td>
<p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if lambda^c and K should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_res">res</code></td>
<td>
<p>Sets the maximum number of species for which a probability must
be computed, must be larger than the size of the largest clade</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_ddmodel">ddmodel</code></td>
<td>
<p>Sets the model of diversity-dependence: <br /> <br /> ddmodel = 0 :
no diversity dependence <br />
ddmodel = 1 : linear dependence in speciation rate <br />
ddmodel = 11: linear dependence in speciation rate and in immigration rate <br />
ddmodel = 2 : exponential dependence in speciation rate<br />
ddmodel = 21: exponential dependence in speciation rate and in immigration rate<br /></p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br />
cond = 1 : conditioning on island age and non-extinction of the island
biota <br /></p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>type of island ontonogeny. If NA, then constant ontogeny is assumed</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_tol">tol</code></td>
<td>
<p>Sets the tolerances in the optimization. Consists of: <br />
reltolx = relative tolerance of parameter values in optimization <br />
reltolf = relative tolerance of function value in optimization <br />
abstolx = absolute tolerance of parameter values in optimization</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_maxiter">maxiter</code></td>
<td>
<p>Sets the maximum number of iterations in the optimization</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. See package deSolve for details.
Default is &quot;lsodes&quot;</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_optimmethod">optimmethod</code></td>
<td>
<p>Method used in likelihood optimization. Default is
&quot;subplex&quot; (see subplex package). Alternative is 'simplex' which was the
method in previous versions.</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_cs_version">CS_version</code></td>
<td>
<p>a numeric or list. Default is 1 for the standard DAISIE
model, for a relaxed-rate model a list with the following elements:
</p>

<ul>
<li><p>model: the CS model to run, options are <code>1</code> for single rate
DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
model.
</p>
</li>
<li><p>relaxed_par: the parameter to relax (integrate over). Options are
<code>"cladogenesis"</code>, <code>"extinction"</code>, <code>"carrying_capacity"</code>,
<code>"immigration"</code>, or <code>"anagenesis"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_verbose">verbose</code></td>
<td>
<p>sets whether parameters and likelihood should be printed (1)
or not (0)</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_tolint">tolint</code></td>
<td>
<p>Vector of two elements containing the absolute and relative
tolerance of the integration</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_distance_type">distance_type</code></td>
<td>
<p>Use 'continent' if the distance to the continent should
be used, use 'nearest_big' if the distance to the nearest big landmass
should be used, and use 'biologically_realistic' if the distance should take
into account some biologically realism, e.g. an average of the previous two
if both are thought to contribute.</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_distance_dep">distance_dep</code></td>
<td>
<p>Sets what type of distance dependence should be used.
Default is a power law, denoted as 'power' (models M1-14 in Valente et al 2020).
Alternatives are additive or interactive contributions of distance and area
to the rate of cladogenesis (&quot;area_additive_clado&quot;; &quot;area_interactive_clado&quot;,
&quot;area_interactive_clado1&quot; and &quot;area_interactive_clado2&quot;). Other alternatives are
exponential relationship denoted by 'exp'; or sigmoids, either
'sigmoidal_col' for a sigmoid in the colonization, 'sigmoidal_ana' for sigmoidal anagenesis,
'sigmoidal_clado' for sigmoidal cladogenesis, and 'sigmoidal_col_ana' for
sigmoids in both colonization and anagenesis. <br />
A key for the different options of distance_dep that should be specified to run the
models from Valente et al 2020 (Supplementary Data Table 1 and 2) is given below: <br />
* M1 to M14 - 'power' <br />
* M15 -'area_additive_clado' <br />
* M16 and M19 -'area_interactive_clado' <br />
* M17 -'area_interactive_clado1' <br />
* M18 - 'area_interactive_clado2' <br />
* M20 and M24 - sigmoidal_col' <br />
* M21, M25 and M28 - sigmoidal_ana' <br />
* M22 and M26 - 'sigmoidal_clado'<br />
* M23 and M27 - 'sigmoidal_col_ana' <br /></p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_parallel">parallel</code></td>
<td>
<p>Sets whether parallel computation should be used. Use 'no'
if no parallel computing should be used, 'cluster' for parallel computing on
a unix/linux cluster, and 'local' for parallel computation on a local
machine.</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_cpus">cpus</code></td>
<td>
<p>Number of cpus used in parallel computing. Default is 3. Will
not have an effect if parallel = 'no'.</p>
</td></tr>
<tr><td><code id="DAISIE_MW_ML_+3A_num_cycles">num_cycles</code></td>
<td>
<p>The number of cycles the optimizer will go through.
Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a dataframe containing estimated parameters and
maximum loglikelihood.
</p>
<table>
<tr><td><code>lambda_c0</code></td>
<td>
<p> gives the maximum likelihood estimate of lambda^c,
the rate of cladogenesis for unit area</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p> gives the maximum likelihood estimate of y,
the exponent of area for the rate of cladogenesis</p>
</td></tr>
<tr><td><code>mu0</code></td>
<td>
<p> gives the maximum likelihood estimate of mu0,
the extinction rate</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p> gives the maximum likelihood estimate of
x, the exponent of 1/area for the extinction rate</p>
</td></tr>
<tr><td><code>K0</code></td>
<td>
<p> gives the maximum likelihood estimate of K0,
the carrying-capacity for unit area</p>
</td></tr>
<tr><td><code>z</code></td>
<td>
<p> gives the maximum likelihood estimate of z, the exponent of area
for the carrying capacity</p>
</td></tr>
<tr><td><code>gamma0</code></td>
<td>
<p> gives the maximum likelihood
estimate of gamma0, the immigration rate for unit distance</p>
</td></tr> <tr><td><code>y</code></td>
<td>
<p> gives
the maximum likelihood estimate of alpha, the exponent of 1/distance for the
rate of colonization</p>
</td></tr>
<tr><td><code>lambda_a0</code></td>
<td>
<p> gives the maximum likelihood
estimate of lambda^a0, the rate of anagenesis for unit distance</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p> gives the maximum likelihood estimate of beta, the exponent of
1/distance for the rate of anagenesis</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> gives the maximum loglikelihood</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p> gives the number of estimated parameters, i.e. degrees of feedom</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p> gives a message on convergence of optimization;
conv = 0 means convergence</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rampal S. Etienne &amp; Luis Valente
</p>


<h3>References</h3>

<p>Valente L, Phillimore AB, Melo M, Warren BH, Clegg SM, Havenstein K,
Tiedemann R, Illera JC, Thébaud C, Aschenbach T, Etienne RS. A simple dynamic model
explains island bird diversity worldwide (2020) Nature, 579, 92-96
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cat("
### Fit the M19 model as in Valente et al 2020, using the ML
parameters as starting values (see Supplementary Tables 1 and 2).

utils::data(archipelagos41)

DAISIE_MW_ML(
datalist= archipelagos41,
initparsopt =
c(0.040073803,	1.945656546,	0.150429656,
67.25643672,	0.293635061,	0.059096872,	0.382688527,
0.026510781),
idparsopt = c(1,3,4,7,8,9,10,11),
parsfix = c(0,Inf,0) ,
idparsfix = c(2,5,6),
res = 100,
ddmodel = 0,
methode = 'lsodes',
cpus = 4,
parallel = 'local',
optimmethod = 'subplex',
tol = c(1E-4, 1E-5, 1E-7),
distance_type = 'continent',
distance_dep = 'area_interactive_clado'
)
")
</code></pre>

<hr>
<h2 id='DAISIE_numcol'>The expectation and marginal distribution of the number of colonizations
(lineages) under the DAISIE model</h2><span id='topic+DAISIE_numcol'></span>

<h3>Description</h3>

<p>This function calculates expectation and marginal distribution of the number
of colonizations (lineages) for a given set of parameter values, a given
mainland species pool size and a given set of times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_numcol(pars1, pars2, tvec, initEI = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_numcol_+3A_pars1">pars1</code></td>
<td>
<p>Vector of model parameters: <br /> <br /> <code>pars1[1]</code> corresponds
to lambda^c (cladogenesis rate) <br /> <code>pars1[2]</code> corresponds to mu
(extinction rate) <br /> <code>pars1[3]</code> corresponds to K (clade-level
carrying capacity) <br /> <code>pars1[4]</code> corresponds to gamma
(immigration rate) <br /> <code>pars1[5]</code> corresponds to lambda^a
(anagenesis rate).</p>
</td></tr>
<tr><td><code id="DAISIE_numcol_+3A_pars2">pars2</code></td>
<td>
<p>Vector of settings: <br /> <br /> <code>pars2[1]</code> corresponds to res,
the maximum number of endemics or non-endemics for which the ODE system is
solved; this must be much larger than the actual number for which the
probability needs to be calculated.) <br /> <code>pars2[2]</code> corresponds to M,
size of the mainland pool, i.e the number of species that can potentially
colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_numcol_+3A_tvec">tvec</code></td>
<td>
<p>The times at which the probabilities need to be computed.</p>
</td></tr>
<tr><td><code id="DAISIE_numcol_+3A_initei">initEI</code></td>
<td>
<p>The initial values for the number of endemics and
non-endemics. In <code><a href="#topic+DAISIE_probdist">DAISIE_probdist</a>()</code> or
<code><a href="#topic+DAISIE_margprobdist">DAISIE_margprobdist</a>()</code> either this or initprobs must be NULL. In
<code><a href="#topic+DAISIE_numcol">DAISIE_numcol</a>()</code> when it is NULL, it is assumed that the island
is empty.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>out</code></td>
<td>
<p>A list of three vectors: <br /> <br /> <code>expC</code> The
expectation of the number of colonizations/lineages at the given times <br />
<code>pC</code> The probability distribution of the number of colonizations
(lineages) at the given times<br /> </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rampal S. Etienne
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Compute the marginal probability distributions at t = 4 and t = 8, for a mainland
# pool size of 250 potential colonists and a vector of 5 parameters (cladogenesis,
# extinction, clade-level carrying capacity, immigration, anagenesis) starting from
# an empty island

numcol &lt;- DAISIE_numcol(
   pars1 = c(0.3,0.35,Inf,0.75,0.012),
   pars2 = c(100,250),
   tvec = c(4,8),
   initEI = list(c(0,1),c(0,2),c(3,1))
   )

</code></pre>

<hr>
<h2 id='daisie_odeint_cs'>Driver for the boost::odeint solver for the CS model</h2><span id='topic+daisie_odeint_cs'></span>

<h3>Description</h3>

<p>Driver for the boost::odeint solver for the CS model
</p>


<h3>Value</h3>

<p>Object of type 'state_type', which itself is
'vector_t'&lt;double&gt;, with the result of the
integration depending on the runmod chosen.
</p>

<hr>
<h2 id='daisie_odeint_iw'>Driver for the boost::odeint solver for the IW model</h2><span id='topic+daisie_odeint_iw'></span>

<h3>Description</h3>

<p>Driver for the boost::odeint solver for the IW model
</p>

<hr>
<h2 id='DAISIE_ONEcolonist'>Convert intermediate output to final simulation output</h2><span id='topic+DAISIE_ONEcolonist'></span>

<h3>Description</h3>

<p>Convert intermediate output to final simulation output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_ONEcolonist(time, island_spec, stt_table)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_ONEcolonist_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_ONEcolonist_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
<tr><td><code id="DAISIE_ONEcolonist_+3A_stt_table">stt_table</code></td>
<td>
<p>Matrix with number of species at each time step.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with these elements:
</p>

<ul>
<li><p>[1]: <code>stt_table</code>, the same stt_table as put in.
</p>
</li>
<li><p>[2]: <code>branching_times</code>, a sorted numeric vector, as required
by the ML estimation functions. The first element always refers to
the island age. Subsequent elements refer to colonisation, speciation and
recolonisation times. The most recent recolonisation time, if any is
always omitted to approximate simulation results to the mathematical
formulation of the likelihood functions used for MLE.
</p>
</li>
<li><p>[3]: <code>stac</code>, status of colonist. In this function it can be
returned as either 2, 4 or 3. If <code>stac</code> is 2, then there is only one
independent colonisation present on the island and the extant species are
endemic. If stac is 4, then only a singleton endemic is present at the
present. If stac is 3, then recolonisation occurred, and more than one
colonising lineage.
</p>
</li>
<li><p>[4]: <code>missing_species</code>, a numeric value with the number of
missing species, that is, species not sampled in the phylogeny but
present on the island. As this code only runs for simulation models,
here <code>missing_species</code> is always set to 0.
</p>
</li>
<li><p>[5]:
<code>all_colonisations</code>, on recolonising lineages only. It is comprised of
<code>$event_times</code> and <code>$species_type</code>:
</p>

<dl>
<dt><code>$event_times</code></dt><dd><p>ordered numeric vectors containing all
events for each extant recolonising lineage. This includes all
colonisation and branching times. Each vector pertains to one
colonising lineage.</p>
</dd>
<dt><code>$species_type</code></dt><dd><p>a string. Can be <code>"A"</code>, <code>"C"</code> or
<code>"I"</code> depending on whether the extant clade is of anagenetic,
cladogenetic or immigrant origin, respectively.</p>
</dd>
</dl>


</li></ul>


<hr>
<h2 id='DAISIE_plot_age_diversity'>Plot clade age against clade diversity.</h2><span id='topic+DAISIE_plot_age_diversity'></span>

<h3>Description</h3>

<p>Plots clade age against clade diversity for all clades for which
colonisation time is known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_plot_age_diversity(
  island,
  title = "Clade age vs clade diversity",
  island_age = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_plot_age_diversity_+3A_island">island</code></td>
<td>
<p>Island data object. Can be in DAISIE list format (see
Galapagos_datalist and DAISIE_data_prep for examples) or in table format
(see Galapagos_datatable for an example).</p>
</td></tr>
<tr><td><code id="DAISIE_plot_age_diversity_+3A_title">title</code></td>
<td>
<p>Title of the plot</p>
</td></tr>
<tr><td><code id="DAISIE_plot_age_diversity_+3A_island_age">island_age</code></td>
<td>
<p>Age of island in appropriate units. In
<code><a href="#topic+DAISIE_plot_age_diversity">DAISIE_plot_age_diversity</a>()</code> and
<code><a href="#topic+DAISIE_plot_island">DAISIE_plot_island</a>()</code> if island input is in table format,
the age of the island must be specified. If island input is in DAISIE list
format, this option will override the island age specified in the island
list.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>R plot showing for each clade in the island object the time of colonisation
and the diversity of the clade. Only clades for which colonisation time is
known are plotted. Blue - endemic; black - non-endemic. C = number of
independent colonisations on island, N = number of species on the island
</p>


<h3>Value</h3>

<p>R plot.
</p>


<h3>Author(s)</h3>

<p>Luis Valente
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a></code>,
<code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a></code>,
<code><a href="#topic+DAISIE_sim_cr_shift">DAISIE_sim_cr_shift</a></code>,
<code><a href="#topic+DAISIE_plot_island">DAISIE_plot_island</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

### Plot Galapagos age-diversity for Galapagos dataset
utils::data(Galapagos_datalist)
DAISIE_plot_age_diversity(Galapagos_datalist)


</code></pre>

<hr>
<h2 id='DAISIE_plot_area'>Plots island area function through time</h2><span id='topic+DAISIE_plot_area'></span>

<h3>Description</h3>

<p>Plots island area function through time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_plot_area(
  total_time,
  area_pars,
  peak,
  island_ontogeny = "beta",
  resolution,
  sea_level = "const"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_plot_area_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_area_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_plot_area_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_area_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_area_+3A_resolution">resolution</code></td>
<td>
<p>numeric indicating resolution of plot. Should be &lt; 0.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_area_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot with the area size through time
</p>


<h3>See Also</h3>

<p>Other rate calculations: 
<code><a href="#topic+get_ana_rate">get_ana_rate</a>()</code>,
<code><a href="#topic+get_ext_rate">get_ext_rate</a>()</code>,
<code><a href="#topic+get_immig_rate">get_immig_rate</a>()</code>,
<code><a href="#topic+island_area_vector">island_area_vector</a>()</code>,
<code><a href="#topic+island_area">island_area</a>()</code>,
<code><a href="#topic+update_max_rates">update_max_rates</a>()</code>,
<code><a href="#topic+update_rates">update_rates</a>()</code>
</p>

<hr>
<h2 id='DAISIE_plot_cladogenesis'>Plot cladogenesis rate through time</h2><span id='topic+DAISIE_plot_cladogenesis'></span>

<h3>Description</h3>

<p>Plot cladogenesis rate through time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_plot_cladogenesis(
  total_time,
  K,
  area_pars,
  peak,
  lac,
  island_ontogeny = "beta",
  sea_level = "const",
  hyper_pars = NULL,
  removed_timepoints,
  resolution
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_plot_cladogenesis_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_cladogenesis_+3A_k">K</code></td>
<td>
<p>A numeric with carrying capacity.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_cladogenesis_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_plot_cladogenesis_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_cladogenesis_+3A_lac">lac</code></td>
<td>
<p>A numeric with the per capita cladogenesis rate.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_cladogenesis_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_cladogenesis_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_cladogenesis_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_plot_cladogenesis_+3A_removed_timepoints">removed_timepoints</code></td>
<td>
<p>Positive integer with number of first datapoints
to be removed from rate plots (to prevent Inf)</p>
</td></tr>
<tr><td><code id="DAISIE_plot_cladogenesis_+3A_resolution">resolution</code></td>
<td>
<p>numeric indicating resolution of plot. Should be &lt; 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot with per capita cladogenesis rate through time and dataframe with immigration
at corresponding time
</p>


<h3>Author(s)</h3>

<p>Pedro Neves
</p>

<hr>
<h2 id='DAISIE_plot_extinction'>Plots extinction rate function through time</h2><span id='topic+DAISIE_plot_extinction'></span>

<h3>Description</h3>

<p>Plots extinction rate function through time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_plot_extinction(
  total_time,
  area_pars,
  peak,
  mu,
  hyper_pars,
  island_ontogeny = "beta",
  sea_level = "const",
  removed_timepoints,
  resolution,
  extcutoff = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_plot_extinction_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_extinction_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_plot_extinction_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_extinction_+3A_mu">mu</code></td>
<td>
<p>A numeric with the per capita extinction rate.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_extinction_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_plot_extinction_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_extinction_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_extinction_+3A_removed_timepoints">removed_timepoints</code></td>
<td>
<p>Positive integer with number of first datapoints
to be removed from rate plots (to prevent Inf)</p>
</td></tr>
<tr><td><code id="DAISIE_plot_extinction_+3A_resolution">resolution</code></td>
<td>
<p>numeric indicating resolution of plot. Should be &lt; 0.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_extinction_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>per capita extinction rate through time plot and dataframe with extinction
at corresponding time
</p>


<h3>Author(s)</h3>

<p>Pedro Neves
</p>

<hr>
<h2 id='DAISIE_plot_immigration'>Plot immigration rate through time</h2><span id='topic+DAISIE_plot_immigration'></span>

<h3>Description</h3>

<p>Plot immigration rate through time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_plot_immigration(
  total_time,
  K,
  area_pars,
  gam,
  peak,
  mainland_n,
  hyper_pars = NULL,
  island_ontogeny = "beta",
  sea_level = "const",
  removed_timepoints,
  resolution
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_plot_immigration_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_immigration_+3A_k">K</code></td>
<td>
<p>A numeric with carrying capacity.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_immigration_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_plot_immigration_+3A_gam">gam</code></td>
<td>
<p>A numeric with the per capita immigration rate.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_immigration_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_immigration_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_immigration_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_plot_immigration_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_immigration_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_immigration_+3A_removed_timepoints">removed_timepoints</code></td>
<td>
<p>Positive integer with number of first datapoints
to be removed from rate plots (to prevent Inf)</p>
</td></tr>
<tr><td><code id="DAISIE_plot_immigration_+3A_resolution">resolution</code></td>
<td>
<p>numeric indicating resolution of plot. Should be &lt; 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot with per capita immigration rate through time and dataframe with immigration
at corresponding time
</p>


<h3>Author(s)</h3>

<p>Pedro Neves
</p>

<hr>
<h2 id='DAISIE_plot_input'>DAISIE tree plot</h2><span id='topic+DAISIE_plot_input'></span>

<h3>Description</h3>

<p>Shows the phylogenies of the multiple clades present on the island
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_plot_input(
  trees,
  age = NULL,
  tcols = NULL,
  metadata = NULL,
  mapping = NULL,
  xlen = 0.001,
  pargs = NULL,
  bckgd = "white"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_plot_input_+3A_trees">trees</code></td>
<td>
<p>A list of trees, in phylo format, named after their respective clades</p>
</td></tr>
<tr><td><code id="DAISIE_plot_input_+3A_age">age</code></td>
<td>
<p>The age of the island, on the same scale as the branch lengths of the trees. If unspecified, the depth of the deepest stem across trees.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_input_+3A_tcols">tcols</code></td>
<td>
<p>A vector of colonization times, with one value per clade. Order must be the same as in 'trees'. If unspecified, all clades are assigned the age of the island as colonization time.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_input_+3A_metadata">metadata</code></td>
<td>
<p>Optional data frame with clade-level metadata. One column must be named &quot;clade&quot;.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_input_+3A_mapping">mapping</code></td>
<td>
<p>Optional aesthetic mapping to apply to the trees, as returned by the 'ggplot2::aes' function. Mapped variables can be anything in the columns of the 'data' node-wise data frame associated to the 'ggtree' plot being created (e.g. node, label, clade, mrca) or anything in the columns of the clade-wise 'metadata', if provided (in this case the aesthetics is mapped to all nodes within each clade).</p>
</td></tr>
<tr><td><code id="DAISIE_plot_input_+3A_xlen">xlen</code></td>
<td>
<p>Length of the extra tips grafted to each tree at the island age. These are a hack for scaling the plot. Keep this value small.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_input_+3A_pargs">pargs</code></td>
<td>
<p>Optional arguments to be passed to 'geom_point' when plotting points at colonization events (e.g. size, shape...).</p>
</td></tr>
<tr><td><code id="DAISIE_plot_input_+3A_bckgd">bckgd</code></td>
<td>
<p>Optional background color of the figure. This is because we use rectangles as a hack to hide tree branches prior to island colonization. Default to white background.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'ggtree' plot, which is also a 'ggplot' object. The output is fully customizable, as any 'ggplot' object.
</p>


<h3>Author(s)</h3>

<p>Raphael Scherrer (github.com/rscherrer)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 # check whether package tibble has been installed
 if (!requireNamespace('tibble', quietly = TRUE)) {
    cat("Package tibble needed for this function to work. Please install it.")
 } else {
 set.seed(42)

 # Random trees
 t1 &lt;- ape::rtree(10)
 t1$tip.label &lt;- gsub("t", "t1.", t1$tip.label)
 t2 &lt;- ape::rtree(3)
 t2$tip.label &lt;- gsub("t", "t2.", t2$tip.label)
 t3 &lt;- ape::rtree(2)
 trees &lt;- list(t1, t2, t3)
 names(trees) &lt;- c("A", "B", "C")

 # Toy colonization events for each clade
 tcols &lt;- c(4.5, 5, 4.6)

 # Toy metadata
 metadata &lt;- tibble::tibble(
   clade = names(trees),
   endemic = TRUE,  # whether each clade is endemic
   uncertain = FALSE  # whether colonization time is known for sure
 )
 metadata$endemic[3] &lt;- FALSE
 metadata$uncertain[2] &lt;- TRUE

 # Island age
 age &lt;- 5

 # Make a plot
 p &lt;- DAISIE_plot_input(
   trees,
   age,
   tcols,
   metadata,
   mapping = ggplot2::aes(color = endemic, linetype = uncertain),
   pargs = list(size = 3)
 )
p
}

</code></pre>

<hr>
<h2 id='DAISIE_plot_island'>Plot colonisation and branching time of species found on an island dataset.</h2><span id='topic+DAISIE_plot_island'></span>

<h3>Description</h3>

<p>Produces an image with the times of colonisation, branching times, clade
name and clade status for all clades found in a given dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_plot_island(island, island_age = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_plot_island_+3A_island">island</code></td>
<td>
<p>Island data object. Can be in DAISIE list format (see
Galapagos_datalist and DAISIE_data_prep for examples) or in table format
(see Galapagos_datatable for an example).</p>
</td></tr>
<tr><td><code id="DAISIE_plot_island_+3A_island_age">island_age</code></td>
<td>
<p>Age of island in appropriate units. In
<code><a href="#topic+DAISIE_plot_age_diversity">DAISIE_plot_age_diversity</a>()</code> and
<code><a href="#topic+DAISIE_plot_island">DAISIE_plot_island</a>()</code> if island input is in table format,
the age of the island must be specified. If island input is in DAISIE list
format, this option will override the island age specified in the island
list.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>R plot showing for each clade in the island object: time of colonisation,
branching times, species status (endemic or non-endemic), total number of
species in clade (n), number of species not sampled (m).
</p>


<h3>Value</h3>

<p>R plot.
</p>


<h3>Author(s)</h3>

<p>Luis Valente
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a></code>,
<code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a></code>,
<code><a href="#topic+DAISIE_sim_cr_shift">DAISIE_sim_cr_shift</a></code>,
<code><a href="#topic+DAISIE_plot_age_diversity">DAISIE_plot_age_diversity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

### Plot Galapagos islands dataset from data table (specify island age)

utils::data(Galapagos_datatable)
DAISIE_plot_island(Galapagos_datatable, island_age=4)

### Plot Galapagos islands dataset from datalist (no need to specify
## island age)
utils::data(Galapagos_datalist)
DAISIE_plot_island(Galapagos_datalist)

</code></pre>

<hr>
<h2 id='DAISIE_plot_pc_rates'>Plot per capita STT and per-capita rate change thourgh simulation</h2><span id='topic+DAISIE_plot_pc_rates'></span>

<h3>Description</h3>

<p>Plot per capita STT and per-capita rate change thourgh simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_plot_pc_rates(
  total_time,
  pars,
  island_ontogeny,
  sea_level = "const",
  area_pars,
  peak,
  hyper_pars,
  mainland_n = 1000,
  resolution = 0.001,
  simulation_outputs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_plot_pc_rates_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_pc_rates_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_pc_rates_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_pc_rates_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_pc_rates_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_plot_pc_rates_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_pc_rates_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_plot_pc_rates_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_pc_rates_+3A_resolution">resolution</code></td>
<td>
<p>numeric indicating resolution of plot. Should be &lt; 0.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_pc_rates_+3A_simulation_outputs">simulation_outputs</code></td>
<td>
<p>A list with matrices and vectors of simulation
produced by DAISIE_sim functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A composite plot containing the STT plot, and variation in area,
extinction rate, cladogenesis rate and immigration rate
</p>


<h3>Author(s)</h3>

<p>Pedro Neves
</p>

<hr>
<h2 id='DAISIE_plot_sims'>Plot island species-through-time (STT) plots</h2><span id='topic+DAISIE_plot_sims'></span>

<h3>Description</h3>

<p>Produces STT plots. If only one type of species is present in
the simulated islands, STT is plotted for all species. If two types are
present, three plots are produced: STT for all, STT for type 1 and STT
for type 2.
</p>
<p>R plots with number of total, endemic and non-endemic STTs for different
types of species for the entire time span the islands were simulated.
2.5-97.5th percentiles are plotted in light grey, 25-75th percentiles
plotted in dark grey.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_plot_sims(
  island_replicates,
  plot_plus_one = TRUE,
  type = "all_species",
  sample_freq = 25,
  trait_pars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_plot_sims_+3A_island_replicates">island_replicates</code></td>
<td>
<p>List output from
<code><a href="#topic+DAISIE_sim_core_cr">DAISIE_sim_core_cr</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_time_dep">DAISIE_sim_core_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_cr_shift">DAISIE_sim_core_cr_shift</a>()</code> or
<code><a href="#topic+DAISIE_sim_min_type2">DAISIE_sim_min_type2</a>()</code> functions. Minimally, this must be a
list that has as many elements as replicates. Each element must be a list
with the elements <code>island_age</code>, <code>not_present</code> and <code>stt_all</code>.
<code>stt_all</code> must be a data frame with the column names <code>Time</code>,
<code>nI</code>, <code>nA</code>, <code>nC</code> and <code>present</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_sims_+3A_plot_plus_one">plot_plus_one</code></td>
<td>
<p>Boolean to indicate to plot all values plus one.
Set to <code>TRUE</code> for default behavior. Set to <code>FALSE</code> to plot all
values without adding one. Only works when there is one type of species.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_sims_+3A_type">type</code></td>
<td>
<p>String to indicate if stt of all species or all possible stt
should be plotted. Default is <code>"all_species"</code>, <code>"type1_species"</code>
or <code>"type2_species"</code> should be plotted.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_sims_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_sims_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>R plot.
</p>


<h3>Author(s)</h3>

<p>Luis Valente
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a></code>,
<code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a></code>,
<code><a href="#topic+DAISIE_sim_cr_shift">DAISIE_sim_cr_shift</a></code>, <code><a href="#topic+DAISIE_format_CS">DAISIE_format_CS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

### Plot islands with single process (only one type of species)
utils::data(islands_1type_1000reps)
DAISIE_plot_sims(
  island_replicates = islands_1type_1000reps
  )


### Plot island with type 1 and type 2
utils::data(islands_2types_1000reps)
DAISIE_plot_sims(
  island_replicates = islands_2types_1000reps
  )



</code></pre>

<hr>
<h2 id='DAISIE_plot_stt'>Create the Species-Through-Time plot. This is used to visualize
the output of DAISIE_sim functions</h2><span id='topic+DAISIE_plot_stt'></span>

<h3>Description</h3>

<p>Create the Species-Through-Time plot. This is used to visualize
the output of DAISIE_sim functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_plot_stt(
  plot_plus_one = TRUE,
  time,
  plot_lists = plot_lists,
  type = type
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_plot_stt_+3A_plot_plus_one">plot_plus_one</code></td>
<td>
<p>Boolean to indicate to plot all values plus one.
Set to <code>TRUE</code> for default behavior. Set to <code>FALSE</code> to plot all
values without adding one. Only works when there is one type of species.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_stt_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_stt_+3A_plot_lists">plot_lists</code></td>
<td>
<p>List of lists containing average and quantile species
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_plot_stt_+3A_type">type</code></td>
<td>
<p>String to indicate if stt of all species or all possible stt
should be plotted. Default is <code>"all_species"</code>, <code>"type1_species"</code>
or <code>"type2_species"</code> should be plotted.</p>
</td></tr>
</table>

<hr>
<h2 id='DAISIE_probdist'>The joint distribution of endemics and non-endemics under the DAISIE model</h2><span id='topic+DAISIE_probdist'></span>

<h3>Description</h3>

<p>This function calculates the joint distribution of the number of endemics
and non-endemics for a given set of parameter values, a given mainland
species pool size and a given set of times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_probdist(pars1, pars2, tvec, initEI = c(0, 0), initprobs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_probdist_+3A_pars1">pars1</code></td>
<td>
<p>Vector of model parameters: <br /> <br /> <code>pars1[1]</code> corresponds
to lambda^c (cladogenesis rate) <br /> <code>pars1[2]</code> corresponds to mu
(extinction rate) <br /> <code>pars1[3]</code> corresponds to K (clade-level
carrying capacity) <br /> <code>pars1[4]</code> corresponds to gamma
(immigration rate) <br /> <code>pars1[5]</code> corresponds to lambda^a
(anagenesis rate).</p>
</td></tr>
<tr><td><code id="DAISIE_probdist_+3A_pars2">pars2</code></td>
<td>
<p>Vector of settings: <br /> <br /> <code>pars2[1]</code> corresponds to res,
the maximum number of endemics or non-endemics for which the ODE system is
solved; this must be much larger than the actual number for which the
probability needs to be calculated.) <br /> <code>pars2[2]</code> corresponds to M,
size of the mainland pool, i.e the number of species that can potentially
colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_probdist_+3A_tvec">tvec</code></td>
<td>
<p>The times at which the probabilities need to be computed.</p>
</td></tr>
<tr><td><code id="DAISIE_probdist_+3A_initei">initEI</code></td>
<td>
<p>The initial values for the number of endemics and
non-endemics. In <code><a href="#topic+DAISIE_probdist">DAISIE_probdist</a>()</code> or
<code><a href="#topic+DAISIE_margprobdist">DAISIE_margprobdist</a>()</code> either this or initprobs must be NULL. In
<code><a href="#topic+DAISIE_numcol">DAISIE_numcol</a>()</code> when it is NULL, it is assumed that the island
is empty.</p>
</td></tr>
<tr><td><code id="DAISIE_probdist_+3A_initprobs">initprobs</code></td>
<td>
<p>The initial probability distribution for the number of
endemics and non-endemics; either this or initEI must be NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To obtain a matrix of probabilities with endemics in rows and non-endemics
in columns for a certain time, one can run DAISIE_convertprobdist
</p>


<h3>Value</h3>

<p>A matrix of dimensions 1 + length(tvec) and pars[2]^2 + 1] where the
first column contains the times at which the probabilities are evaluated and
the other columns contain the joint probabilities.
</p>


<h3>Author(s)</h3>

<p>Rampal S. Etienne
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Compute the probability distribution at t = 4 and t = 8, for a mainland pool
# size of 250 potential colonists and a vector of 5 parameters (cladogenesis,
# extinction, clade-level carrying capacity, immigration, anagenesis) starting
# from an empty island

prob_dists &lt;- DAISIE_probdist(
   pars1 = c(0.3,0.35,Inf,0.75,0.012),
   pars2 = c(100,250),
   tvec = c(4,8),
   initEI = c(0,0),
   initprobs = NULL
   )

</code></pre>

<hr>
<h2 id='DAISIE_sample_event_cr'>Samples what event to happen next</h2><span id='topic+DAISIE_sample_event_cr'></span>

<h3>Description</h3>

<p>Samples what event to happen next
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sample_event_cr(rates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sample_event_cr_+3A_rates">rates</code></td>
<td>
<p>named list of numeric rates as returned by
<code><a href="#topic+update_rates">update_rates</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric indicating what event will happen, or a supposed event that
would happen in some timesteps of the ontogeny algorithm.
</p>

<ul>
<li><p>[1]: immigration event
</p>
</li>
<li><p>[2]: extinction event
</p>
</li>
<li><p>[3]: cladogenesis event
</p>
</li>
<li><p>[4]: anagenesis event
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pedro Neves
</p>

<hr>
<h2 id='DAISIE_sample_event_time_dep'>Samples what event to happen next</h2><span id='topic+DAISIE_sample_event_time_dep'></span>

<h3>Description</h3>

<p>Samples what event to happen next
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sample_event_time_dep(max_rates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sample_event_time_dep_+3A_max_rates">max_rates</code></td>
<td>
<p>named list of numeric max rates as returned by
<code><a href="#topic+update_max_rates">update_max_rates</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric indicating what event will happen, or a supposed event that
would happen in some timesteps of the ontogeny algorithm.
</p>

<ul>
<li><p>[1]: immigration event
</p>
</li>
<li><p>[2]: extinction event
</p>
</li>
<li><p>[3]: cladogenesis event
</p>
</li>
<li><p>[4]: anagenesis event
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Pedro Neves
</p>

<hr>
<h2 id='DAISIE_sample_event_trait_dep'>Samples what event to happen next</h2><span id='topic+DAISIE_sample_event_trait_dep'></span>

<h3>Description</h3>

<p>Samples what event to happen next
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sample_event_trait_dep(rates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sample_event_trait_dep_+3A_rates">rates</code></td>
<td>
<p>named list of numeric rates as returned by
<code><a href="#topic+update_rates">update_rates</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric indicating what event will happen, or a supposed event that
would happen in some timesteps of the ontogeny algorithm.
</p>

<ul>
<li><p>[1]: immigration event with trait1
</p>
</li>
<li><p>[2]: extinction event with trait1
</p>
</li>
<li><p>[3]: cladogenesis event with trait1
</p>
</li>
<li><p>[4]: anagenesis event with trait1
</p>
</li>
<li><p>[5]: transition event with trait1
</p>
</li>
<li><p>[6]: immigration event with trait2
</p>
</li>
<li><p>[7]: extinction event with trait2
</p>
</li>
<li><p>[8]: cladogenesis event with trait2
</p>
</li>
<li><p>[9]: anagenesis event with trait2
</p>
</li>
<li><p>[10]: transition event with trait2
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Shu Xie
</p>

<hr>
<h2 id='DAISIE_sim'>Simulate (non-)oceanic islands with given parameters under
time-constant rates</h2><span id='topic+DAISIE_sim'></span><span id='topic+DAISIE_sim_cr'></span>

<h3>Description</h3>

<p>This function simulates islands with given cladogenesis,
extinction, Kprime, immigration and anagenesis parameters, all of which
modelled as time-constant parameters. If a single
parameter set is provided (5 parameters) it simulates islands where all
species have the same macro-evolutionary process. If two paramater sets
(10 parameters) are provided, it simulates islands where two different
macro-evolutionary processes operate, one applying to type 1 species and
other to type 2 species. Further, it allows for the simulation of
non-oceanic islands, generating islands for which the starting condition
includes potential endemic and non-endemic species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_cr(
  time,
  M,
  pars,
  replicates,
  divdepmodel = "CS",
  nonoceanic_pars = c(0, 0),
  num_guilds = NULL,
  prop_type2_pool = NA,
  replicates_apply_type2 = TRUE,
  sample_freq = 25,
  plot_sims = TRUE,
  hyper_pars = create_hyper_pars(d = 0, x = 0),
  area_pars = create_area_pars(max_area = 1, current_area = 1, proportional_peak_t = 0,
    total_island_age = 0, sea_level_amplitude = 0, sea_level_frequency = 0,
    island_gradient_angle = 0),
  cond = 0,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_divdepmodel">divdepmodel</code></td>
<td>
<p>Option divdepmodel = 'CS' runs a model with clade-specific
carrying capacity, where diversity-dependence operates only within single
clades, i.e. only among species originating from the same mainland
colonist. Option divdepmodel = 'IW' runs a model with island-wide
carrying capacity, where diversity-dependence operates within and among
clades. Option divdepmodel = 'GW' runs a model with diversity-dependence
operates within a guild.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_num_guilds">num_guilds</code></td>
<td>
<p>The number of guilds on the mainland. The number of
mainland species is divided by the number of guilds when
<code>divdepmodel = "GW"</code></p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_prop_type2_pool">prop_type2_pool</code></td>
<td>
<p>Fraction of mainland species that belongs to the
second subset of species (type 2). Applies only when two types of species
are simulated (length(pars) = 10). For <code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a>()</code>
applies only if number_clade_types = 2.  In <code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a>()</code>
the default <code>"proportional"</code> sets the fraction to be proportional to
the number of clades of distinct macroevolutionary process that have
colonised the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_replicates_apply_type2">replicates_apply_type2</code></td>
<td>
<p>Applies only when two types of species are
being simulated. Default replicates_apply_type2 = TRUE runs simulations
until the number of islands where a type 2 species has colonised is equal
to the specified number of replicates. This is recommended if
<code>prop_type2_pool</code> is small or if the rate of immigration of type two
species (<code>pars[9]</code>) is low, meaning that more replicates are needed to
achieved an adequate sample size of islands with type 2 species. Setting
<code>replicates_apply_type2 = FALSE</code> simulates islands up to the
specified number of replicates regardless of whether type 2 species have
colonised or not.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_plot_sims">plot_sims</code></td>
<td>
<p><code>Default = TRUE</code> plots species-through-time (STT)
plots. It detects how many types of species are present. If only one type
of species is present, STT is plotted for all species. If two types are
present, three plots are produced: STT for all, STT for type 1 and STT for
type 2.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_+3A_...">...</code></td>
<td>
<p>Any arguments to pass on to plotting functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replciate. The first element of each replicate is composed of island
information containing:
</p>

<ul>
<li><p><code>$island_age</code>: A numeric with the island age.
</p>
</li>
<li><p><code>$not_present</code>: the number of mainland lineages that are not
present on the island. It is only present if only 1 type of species is
simulated. Becomes <code>$not_present_type1</code>: the number of mainland
lineages of type 1 that are not present on the island and
<code>$not_present_type2</code>: the number of mainland lineages of type 2
that are not present on the island, if two types are simulated.
</p>
</li>
<li><p><code>$stt_all</code>: STT table for all species on the island
(nI - number of non-endemic species; nA - number of anagenetic species,
nC - number of cladogenetic species, present - number of independent
colonisations present)
</p>
</li>
<li><p><code>$stt_stt_type1</code>: STT table for type 1 species on the island -
only if 2 types of species were simulated (nI - number of non-endemic
species; nA - number of anagenetic species, nC - number of cladogenetic
species, present - number of independent colonisations present).
</p>
</li>
<li><p><code>$stt_stt_type2</code>: STT table for type 2 species on the island
- only if 2 types of species were simulated (nI - number of non-endemic
species; nA - number of anagenetic species, nC - number of cladogenetic
species, present - number of independent colonisations present ).
</p>
</li>
<li><p><code>$brts_table</code>: Only for simulations under <code>"IW"</code>. Table
containing information on order of events in the data, for use in maximum
likelihood optimization.).
</p>
</li></ul>

<p>The subsequent elements of the list pertaining to each replcate contain
information on a single colonist lineage on the island and have 4 components:
</p>

<ul>
<li><p><code>$branching_times</code>: island age and stem age of the
population/species in the case of Non-endemic, Non-endemic_MaxAge and
Endemic anagenetic species.
</p>
<p>For cladogenetic species these should
be island age and branching times of the radiation including the
stem age of the radiation.
</p>
</li>
<li><p><code>$stac</code>: An integer ranging from 1 to 4
indicating the status of the colonist:
</p>

<ol>
<li><p> Non_endemic_MaxAge
</p>
</li>
<li><p> Endemic
</p>
</li>
<li><p> Endemic&amp;Non_Endemic
</p>
</li>
<li><p> Non_endemic_MaxAge
</p>
</li></ol>

</li>
<li><p><code>$missing_species</code>: number of island species that were
not sampled for particular clade (only applicable for endemic clades)
</p>
</li>
<li><p><code>$type_1or2</code>: whether the colonist belongs to type 1 or type 2
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Luis Valente, Albert Phillimore, Joshua Lambert, Shu Xie, Pedro
Neves, Richèl J. C. Bilderbeek, Rampal Etienne
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_plot_sims">DAISIE_plot_sims</a>()</code> for plotting STT of simulation
outputs.
</p>
<p>Other simulation models: 
<code><a href="#topic+DAISIE_sim_cr_shift">DAISIE_sim_cr_shift</a>()</code>,
<code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>,
<code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulate 2 islands for 1 million years, where all species have equal
## rates. Pool size 100.

clado_rate &lt;- 0.5
ext_rate &lt;- 0.2
carr_cap &lt;- Inf
immig_rate &lt;- 0.05
ana_rate &lt;- 1
sim_pars &lt;- c(clado_rate, ext_rate, carr_cap, immig_rate, ana_rate)
set.seed(1)
island_replicates &lt;- DAISIE_sim_cr(
  time = 1,
  M = 100,
  pars = sim_pars,
  replicates = 2,
  plot_sims = FALSE,
  verbose = FALSE
)

## Simulate 2 islands for 1 million years with two types of species (type1
## and type 2). Pool size 100
## Fraction of type 2 species in source pool is 0.15. Function will
## simulate until number of islands where type 2 species has colonised is
## equal to number specified in replicates.

clado_rate &lt;- 0.5
ext_rate &lt;- 0.2
carr_cap &lt;- Inf
immig_rate &lt;- 0.005
ana_rate &lt;- 1
sim_pars_type1 &lt;- c(clado_rate, ext_rate, carr_cap, immig_rate, ana_rate)
sim_pars_type2 &lt;- sim_pars_type1 * 2
set.seed(1)
island_replicates_2types &lt;- DAISIE_sim_cr(
  time = 1,
  M = 100,
  pars = c(sim_pars_type1, sim_pars_type2),
  replicates = 2,
  prop_type2_pool = 0.15,
  plot_sims = FALSE,
  verbose = FALSE
)
## Simulate two non-oceanic island for 1 million years.
## Pool size 500. Island area as a proportion
## of mainland is 0.1, proportion of native species is 0.9.
clado_rate &lt;- 0.5
ext_rate &lt;- 0.2
carr_cap &lt;- Inf
immig_rate &lt;- 0.005
ana_rate &lt;- 1
sim_pars &lt;- c(clado_rate, ext_rate, carr_cap, immig_rate, ana_rate)
set.seed(1)
island_replicates &lt;- DAISIE_sim_cr(
  time = 1,
  M = 500,
  pars = sim_pars,
  replicates = 2,
  nonoceanic_pars = c(0.1, 0.9),
  plot_sims = FALSE,
  verbose = FALSE
)

## Simulate 2 islands for 1 million years with a shift in immigration rate
## at 0.195 Ma, and plot the species-through-time plot. Pool size 296.

pars_before_shift &lt;- c(0.079, 0.973, Inf, 0.136, 0.413)
pars_after_shift &lt;- c(0.079, 0.973, Inf, 0.652, 0.413)
tshift &lt;- 0.195
set.seed(1)
island_shift_replicates &lt;- DAISIE_sim_cr_shift(
  time = 1,
  M = 296,
  pars = c(pars_before_shift, pars_after_shift),
  replicates = 2,
  shift_times = tshift,
  plot_sims = FALSE,
  verbose = FALSE
)
</code></pre>

<hr>
<h2 id='DAISIE_sim_core_cr'>Internal function of the DAISIE simulation</h2><span id='topic+DAISIE_sim_core_cr'></span>

<h3>Description</h3>

<p>Internal function of the DAISIE simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_core_cr(
  time,
  mainland_n,
  pars,
  nonoceanic_pars,
  hyper_pars,
  area_pars
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_core_cr_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_cr_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_cr_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_cr_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_core_cr_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_core_cr_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='DAISIE_sim_core_cr_shift'>Internal function of the DAISIE simulation</h2><span id='topic+DAISIE_sim_core_cr_shift'></span>

<h3>Description</h3>

<p>Internal function of the DAISIE simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_core_cr_shift(
  time,
  mainland_n,
  pars,
  nonoceanic_pars = c(0, 0),
  hyper_pars = NULL,
  area_pars = NULL,
  shift_times
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_core_cr_shift_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_cr_shift_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_cr_shift_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_cr_shift_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_core_cr_shift_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_core_cr_shift_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_core_cr_shift_+3A_shift_times">shift_times</code></td>
<td>
<p>a numeric vector specifying when the rate shifts occur
before the present.</p>
</td></tr>
</table>

<hr>
<h2 id='DAISIE_sim_core_time_dep'>Internal function of the DAISIE simulation</h2><span id='topic+DAISIE_sim_core_time_dep'></span>

<h3>Description</h3>

<p>Internal function of the DAISIE simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_core_time_dep(
  time,
  mainland_n,
  pars,
  nonoceanic_pars,
  island_ontogeny = 0,
  sea_level = 0,
  hyper_pars,
  area_pars,
  peak,
  Amax,
  Amin,
  extcutoff = 1000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_amax">Amax</code></td>
<td>
<p>A numeric value for maximum island area during the simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_amin">Amin</code></td>
<td>
<p>A numeric value for minimum island area during the simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_time_dep_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
</table>

<hr>
<h2 id='DAISIE_sim_core_trait_dep'>Internal function of the DAISIE simulation</h2><span id='topic+DAISIE_sim_core_trait_dep'></span>

<h3>Description</h3>

<p>Internal function of the DAISIE simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_core_trait_dep(
  time,
  mainland_n,
  pars,
  island_ontogeny = 0,
  sea_level = 0,
  hyper_pars,
  area_pars,
  extcutoff = 1000,
  trait_pars = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_core_trait_dep_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_trait_dep_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_trait_dep_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_trait_dep_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_trait_dep_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_trait_dep_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_core_trait_dep_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_core_trait_dep_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_core_trait_dep_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='DAISIE_sim_cr_cs'>Simulates island replicates with an clade-specific (CS) diversity-dependent
constant-rate process</h2><span id='topic+DAISIE_sim_cr_cs'></span>

<h3>Description</h3>

<p>Simulates island replicates with an clade-specific (CS) diversity-dependent
constant-rate process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_cr_cs(
  total_time,
  M,
  pars,
  replicates,
  nonoceanic_pars,
  prop_type2_pool,
  replicates_apply_type2,
  sample_freq,
  hyper_pars,
  area_pars,
  cond,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_prop_type2_pool">prop_type2_pool</code></td>
<td>
<p>Fraction of mainland species that belongs to the
second subset of species (type 2). Applies only when two types of species
are simulated (length(pars) = 10). For <code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a>()</code>
applies only if number_clade_types = 2.  In <code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a>()</code>
the default <code>"proportional"</code> sets the fraction to be proportional to
the number of clades of distinct macroevolutionary process that have
colonised the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_replicates_apply_type2">replicates_apply_type2</code></td>
<td>
<p>Applies only when two types of species are
being simulated. Default replicates_apply_type2 = TRUE runs simulations
until the number of islands where a type 2 species has colonised is equal
to the specified number of replicates. This is recommended if
<code>prop_type2_pool</code> is small or if the rate of immigration of type two
species (<code>pars[9]</code>) is low, meaning that more replicates are needed to
achieved an adequate sample size of islands with type 2 species. Setting
<code>replicates_apply_type2 = FALSE</code> simulates islands up to the
specified number of replicates regardless of whether type 2 species have
colonised or not.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_cs_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replicate. See return for 'DAISIE_sim_cr()' for details.
</p>

<hr>
<h2 id='DAISIE_sim_cr_gw'>Simulates island replicates with an guild-wide (GW) diversity-dependent
process</h2><span id='topic+DAISIE_sim_cr_gw'></span>

<h3>Description</h3>

<p>Simulates island replicates with an guild-wide (GW) diversity-dependent
process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_cr_gw(
  total_time,
  M,
  pars,
  replicates,
  nonoceanic_pars,
  num_guilds,
  sample_freq,
  hyper_pars,
  area_pars,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_cr_gw_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_gw_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_gw_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_gw_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_gw_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_gw_+3A_num_guilds">num_guilds</code></td>
<td>
<p>The number of guilds on the mainland. The number of
mainland species is divided by the number of guilds when
<code>divdepmodel = "GW"</code></p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_gw_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_gw_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_gw_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_gw_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replciate. See return for 'DAISIE_sim_cr()' for details.
</p>

<hr>
<h2 id='DAISIE_sim_cr_iw'>Simulates island replicates with an island-wide (IW) diversity-dependent
constant-rate process</h2><span id='topic+DAISIE_sim_cr_iw'></span>

<h3>Description</h3>

<p>Simulates island replicates with an island-wide (IW) diversity-dependent
constant-rate process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_cr_iw(
  total_time,
  M,
  pars,
  replicates,
  nonoceanic_pars,
  sample_freq,
  hyper_pars,
  area_pars,
  cond,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_cr_iw_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_iw_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_iw_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_iw_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_iw_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_iw_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_iw_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_iw_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_iw_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_iw_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replicate. See return for 'DAISIE_sim_cr()' for details.
</p>

<hr>
<h2 id='DAISIE_sim_cr_shift'>Simulate (non-)oceanic islands with given parameters under a
rate-shift regime</h2><span id='topic+DAISIE_sim_cr_shift'></span>

<h3>Description</h3>

<p>This function simulates islands with given cladogenesis,
extinction, Kprime, immigration and anagenesis parameters, all of which
modelled as time-constant parameters, which can be switched to a different
diversification regime (i.e., different set of parameters) at one or more
set times before the present. Further, it allows for the simulation of
non-oceanic islands, generating islands for which the starting condition
includes potential endemic and non-endemic species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_cr_shift(
  time,
  M,
  pars,
  replicates,
  shift_times,
  divdepmodel = "CS",
  nonoceanic_pars = c(0, 0),
  num_guilds = NULL,
  sample_freq = 25,
  plot_sims = TRUE,
  hyper_pars = create_hyper_pars(d = 0, x = 0),
  area_pars = DAISIE::create_area_pars(max_area = 1, current_area = 1,
    proportional_peak_t = 0, total_island_age = 0, sea_level_amplitude = 0,
    sea_level_frequency = 0, island_gradient_angle = 0),
  cond = 0,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_shift_times">shift_times</code></td>
<td>
<p>a numeric vector specifying when the rate shifts occur
before the present.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_divdepmodel">divdepmodel</code></td>
<td>
<p>Option divdepmodel = 'CS' runs a model with clade-specific
carrying capacity, where diversity-dependence operates only within single
clades, i.e. only among species originating from the same mainland
colonist. Option divdepmodel = 'IW' runs a model with island-wide
carrying capacity, where diversity-dependence operates within and among
clades. Option divdepmodel = 'GW' runs a model with diversity-dependence
operates within a guild.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_num_guilds">num_guilds</code></td>
<td>
<p>The number of guilds on the mainland. The number of
mainland species is divided by the number of guilds when
<code>divdepmodel = "GW"</code></p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_plot_sims">plot_sims</code></td>
<td>
<p><code>Default = TRUE</code> plots species-through-time (STT)
plots. It detects how many types of species are present. If only one type
of species is present, STT is plotted for all species. If two types are
present, three plots are produced: STT for all, STT for type 1 and STT for
type 2.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_cr_shift_+3A_...">...</code></td>
<td>
<p>Any arguments to pass on to plotting functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replciate. The first element of each replicate is composed of island
information containing:
</p>

<ul>
<li><p><code>$island_age</code>: A numeric with the island age.
</p>
</li>
<li><p><code>$not_present</code>: A numeric with the number of mainland lineages
that are not present on the island.
</p>
</li>
<li><p><code>$stt_all</code>: STT table for all species on the island
(nI - number of non-endemic species; nA - number of anagenetic species,
nC - number of cladogenetic species, present - number of independent
colonisations present)
</p>
</li>
<li><p><code>$brts_table</code>: Only for simulations under <code>"IW"</code>. Table
containing information on order of events in the data, for use in maximum
likelihood optimization.).
</p>
</li></ul>

<p>The subsequent elements of the list pertaining to each replcate contain
information on a single colonist lineage on the island and have 4 components:
</p>

<ul>
<li><p><code>$branching_times</code>: island age and stem age of the
population/species in the case of Non-endemic, Non-endemic_MaxAge and
Endemic anagenetic species. For cladogenetic species these should
be island age and branching times of the radiation including the
stem age of the radiation.
</p>
</li>
<li><p><code>$stac</code>: An integer ranging from 1 to 4
indicating the status of the colonist:
</p>

<ol>
<li><p> Non_endemic_MaxAge
</p>
</li>
<li><p> Endemic
</p>
</li>
<li><p> Endemic&amp;Non_Endemic
</p>
</li>
<li><p> Non_endemic_MaxAge
</p>
</li></ol>

</li>
<li><p><code>$missing_species</code>: number of island species that were
not sampled for particular clade (only applicable for endemic clades)
</p>
</li>
<li><p><code>$type_1or2</code>: whether the colonist belongs to type 1 or type 2
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Luis Valente, Albert Phillimore, Torsten Hauffe
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>
<p>Hauffe, T., D. Delicado, R.S. Etienne and L. Valente (2020).
Lake expansion elevates equilibrium diversity via increasing colonization.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_plot_sims">DAISIE_plot_sims</a>()</code> for plotting STT of simulation
outputs.
</p>
<p>Other simulation models: 
<code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>,
<code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_sim">DAISIE_sim</a>()</code>
</p>

<hr>
<h2 id='DAISIE_sim_min_type2'>Internal function of the DAISIE simulation</h2><span id='topic+DAISIE_sim_min_type2'></span>

<h3>Description</h3>

<p>Internal function of the DAISIE simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_min_type2(
  time,
  M,
  pars,
  replicates,
  prop_type2_pool,
  area_pars,
  hyper_pars,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_min_type2_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_min_type2_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_min_type2_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_min_type2_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_min_type2_+3A_prop_type2_pool">prop_type2_pool</code></td>
<td>
<p>Fraction of mainland species that belongs to the
second subset of species (type 2). Applies only when two types of species
are simulated (length(pars) = 10). For <code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a>()</code>
applies only if number_clade_types = 2.  In <code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a>()</code>
the default <code>"proportional"</code> sets the fraction to be proportional to
the number of clades of distinct macroevolutionary process that have
colonised the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_min_type2_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_min_type2_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_min_type2_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
</table>

<hr>
<h2 id='DAISIE_sim_MW'>Simulate multiple islands based on hyperparameters that describe relationships
between area, isolation and local parameters</h2><span id='topic+DAISIE_sim_MW'></span>

<h3>Description</h3>

<p>This function simulates islands of given age, area and isolation.
A list of islands/archipelagos with this information is provided as a data frame
object (in the example,
the archipelago_data from Valente et al 2020 Nature).
For each island, local parameters are first calculated based on hyperparameters describing
the dependency of rates on island area and isolation. Simulations are then run for each island,
from island birth until the given island age based on the
local parameters for each island (using the DAISIE_sim function).
</p>
<p>Returns R list object that contains the simulated islands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_MW(
  archipelago_data,
  M,
  pars,
  replicates,
  divdepmodel = "CS",
  distance_dep = "power",
  cladogenesis_dep = "NULL",
  sigmoidal_par = "NULL"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_MW_+3A_archipelago_data">archipelago_data</code></td>
<td>
<p>Object (data.frame) containing a table with columns with
the following names:
Archipelago: names of the archipelagos or islands to be simulated;
Area - the area of the archipelago/island;
Age: Age of the oldest island in the archipelago, or age of the island if single island.
Distance - distance to the mainland (or other applicable isolation metric).
As an example, the dataset from Valente et al 2020 for 41 archipelagos is provided in data(archipelago_data).</p>
</td></tr>
<tr><td><code id="DAISIE_sim_MW_+3A_m">M</code></td>
<td>
<p>The size of the mainland pool, i.e the number of species that can
potentially colonize the island(s).</p>
</td></tr>
<tr><td><code id="DAISIE_sim_MW_+3A_pars">pars</code></td>
<td>
<p>Contains the model hyperparameters:
<br /> <br /> <code>pars[1]</code> corresponds to lambda^c0 (initial cladogenesis rate)
<br /> <code>pars[2]</code> corresponds to y (dependency of cladogenesis on area)
0 - no dependency, positive value - cladogenesis increases with area,
negative value - cladogenesis decreases with area
<br /> <code>pars[3]</code> corresponds to mu_0 (initial extinction rate)
<br /> <code>pars[4]</code> corresponds to x (dependency of extinction on area)
0 - no dependency, positive value - extinction increases with area,
negative value - extinction decreases with area.
<br /> <code>pars[5]</code> corresponds to K_0  (initial
carrying capacity). Set K=Inf for non-diversity dependence.
<br /> <code>pars[6]</code> corresponds to z
(dependency of K on area). 0 - no dependency, positive value - K increases with area,
negative value - K decreases with area.
<br /> <code>pars[7]</code> corresponds to gamma_0 (initial immigration rate)
<br /> <code>pars[8]</code> corresponds to alpha (dependency of immigration on island isolation).
0 - no dependency, positive value - immigration increases with distance,
negative value - immigration decreases with distance
<br /> <code>pars[9]</code> corresponds to lambda^a_0 (initial anagenesis rate)
<br /> <code>pars[10]</code> corresponds to beta (dependency of anagenesis on island isolation).
0 - no dependency,positive value - anagenesis increases with distance, negative value
- anagenesis decreases with distance.
<br /> <code>pars[11]</code> corresponds to d0, parameter that describes
interactive/additive effect of isolation and area on cladogenesis (power models);
or that describes the shape of the sigmoidal relationship between
isolation and a parameter (sigmoidal models).</p>
</td></tr>
<tr><td><code id="DAISIE_sim_MW_+3A_replicates">replicates</code></td>
<td>
<p>Number of island replicates to be simulated per island in
the table archipelago_data. If there are 5 islands in archipelago_data, and number of
replicates is set to 10, 50 islands will be simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_MW_+3A_divdepmodel">divdepmodel</code></td>
<td>
<p>Option divdepmodel = 'CS' runs model with clade-specific
carrying capacity, where diversity-dependence operates only within single
clades, i.e. only among species originating from the same mainland
colonist.<br /> Option divdepmodel = 'IW' runs model with island-wide carrying
capacity, where diversity-dependence operates within and among clades.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_MW_+3A_distance_dep">distance_dep</code></td>
<td>
<p>Shape of dependency of parameter with distance. Can be of type <br /> 'power'
or type <br /> 'sigmoidal'.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_MW_+3A_cladogenesis_dep">cladogenesis_dep</code></td>
<td>
<p>When distance_dep = 'power' is specified, cladogenesis_dep specifies
the type of effect of area and isolation on cladogenesis. The possible options are:
<br /> 'NULL' (no additive or interactive effect of area on isolation,
same as models M1-M14 in Valente et al 2020)
<br /> 'additive' (additive effect of area and isolation on cladogenesis,
same as model M15 in Valente et al 2020)
<br /> 'interactive' (interactive effect of area and isolation on cladogenesis,
same as models M16 and M19 in Valente et al 2020)
<br /> 'interactive1' (interactive effect of area and isolation on cladogenesis,
same as model M17 in Valente et al 2020)
<br /> 'interactive2' (interactive effect of area and isolation on cladogenesis,
same as model M18 in Valente et al 2020)</p>
</td></tr>
<tr><td><code id="DAISIE_sim_MW_+3A_sigmoidal_par">sigmoidal_par</code></td>
<td>
<p>When distance_dep = 'sigmoidal', sigmoidal_par specifies
to which parameter the sigmoidal relationship with distance is applied.
Options: <br /> 'cladogenesis'<br /> 'anagenesis' <br /> 'colonisation'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For each island listed in the rows of archipelago_data, a given number of islands
is simulated depending on the number of replicates specified. The simulations for
each island in archipelago_data are an element of the list, which can be called using [[x]].
Individual replicates for an island can be called with [[x]][[x]]
For example if the object is called global_sims, the 1st replicate for the first island
can be called using global_sims[[1]][[1]].
The 3rd replicate of the 4th island is called with global_sims[[4]][[3]]
Each of the island replicates is a list in itself. The first (e.g.
global_sims[[x]][[x]][[1]]) element of that list has the following
components: <br /> <code>$island_age</code> - the island or archipelago age <code>$not_present</code>
- the number of mainland lineages that are not present on the island <br />
<code>$stt_all</code> - STT table for all species on the archipelago/island (nI - number of
non-endemic species; nA - number of anagenetic species, nC - number of
cladogenetic species, present - number of independent colonisations present)
<br /> <code>$area</code> Area of the island or archipelago <br /> <code>$distance</code> Distance to the mainland
<br /> <code>$name</code> Name of the island or archipelago <br />
</p>
<p>The subsequent elements of the list each contain information on a single
colonist lineage on the island and has 4 components:<br />
<code>$branching_times</code> - island age and stem age of the population/species
in the case of Non-endemic, Non-endemic_MaxAge and Endemic with no close extant
relatives on the islands
species. For cladogenetic species these should be island age and branching
times of the radiation including the stem age of the radiation.<br />
<code>$stac</code> - the status of the colonist <br /> *
Endemic: 2 <br /> * Endemic&amp;Non_Endemic: 3 <br /> * Non_endemic: 4 <br />
<code>$missing_species</code> - number of island species that were not sampled for
particular clade (only applicable for endemic clades) <br />
</p>


<h3>Author(s)</h3>

<p>Luis Valente, Albert Phillimore, Rampal Etienne
</p>


<h3>References</h3>

<p>Valente, LM, Phillimore AB, Melo M, Warren B, Clegg S, Havenstein K,
Tiedemann R, Illera JC, Thebaud C, Aschenbach T and  Etienne RS (2020).
A simple dynamic model explain island bird diversity worldwide. Nature, 579, 92-96.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a>()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulate 10 replicates for the each of the 41 archipelagos in the archipelago_data table,
##based on the hyperparameters of the M19 model (preferred model in Valente et al 2020)
## and the age, area and isolation values given in the archipelago_data table.
## Mainland pool size of 1000, clade-specific carrying capacity. The M19 model is a
## power model with an interactive effect of area and isolation on cladogenesis.
##
## data(archipelago_data)
## result &lt;- DAISIE_sim_MW(
## archipelago_data = archipelago_data,
## M = 1000,
## pars = c(0.040073803,	0,	1.945656546,	0.150429656,	Inf,	0,	67.25643672,
## 0.293635061,	0.059096872,	0.382688527,	0.026510781),
## replicates = 10,
## distance_dep = 'power',
## cladogenesis_dep = 'interactive',
## sigmoidal_par = 'NULL',
## divdepmodel = 'CS')
</code></pre>

<hr>
<h2 id='DAISIE_sim_relaxed_rate'>Simulate (non-)oceanic islands with given parameters under a
relaxed-rate model</h2><span id='topic+DAISIE_sim_relaxed_rate'></span>

<h3>Description</h3>

<p>This function simulates islands with given cladogenesis,
extinction, Kprime, immigration and anagenesis parameters, all of which
can be modelled as time-constant parameters with variation between clades in
one or multiple parameters. Further, it allows for the simulation of
non-oceanic islands, generating islands for which the starting condition
includes potential endemic and non-endemic species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_relaxed_rate(
  time,
  M,
  pars,
  replicates,
  relaxed_par,
  nonoceanic_pars = c(0, 0),
  sample_freq = 25,
  plot_sims = TRUE,
  hyper_pars = create_hyper_pars(d = 0, x = 0),
  area_pars = create_area_pars(max_area = 1, current_area = 1, proportional_peak_t = 0,
    total_island_age = 0, sea_level_amplitude = 0, sea_level_frequency = 0,
    island_gradient_angle = 0),
  cond = 0,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_relaxed_par">relaxed_par</code></td>
<td>
<p>A string determining which parameter is relaxed in a
relaxed rate model.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_plot_sims">plot_sims</code></td>
<td>
<p><code>Default = TRUE</code> plots species-through-time (STT)
plots. It detects how many types of species are present. If only one type
of species is present, STT is plotted for all species. If two types are
present, three plots are produced: STT for all, STT for type 1 and STT for
type 2.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_relaxed_rate_+3A_...">...</code></td>
<td>
<p>Any arguments to pass on to plotting functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replciate. The first element of each replicate is composed of island
information containing:
</p>

<ul>
<li><p><code>$island_age</code>: A numeric with the island age.
</p>
</li>
<li><p><code>$not_present</code>: the number of mainland lineages that are not
present on the island. It is only present if only 1 type of species is
simulated. Becomes <code>$not_present_type1</code>: the number of mainland
lineages of type 1 that are not present on the island and
<code>$not_present_type2</code>: the number of mainland lineages of type 2
that are not present on the island, if two types are simulated.
</p>
</li>
<li><p><code>$stt_all</code>: STT table for all species on the island
(nI - number of non-endemic species; nA - number of anagenetic species,
nC - number of cladogenetic species, present - number of independent
colonisations present)
</p>
</li>
<li><p><code>$stt_stt_type1</code>: STT table for type 1 species on the island -
only if 2 types of species were simulated (nI - number of non-endemic
species; nA - number of anagenetic species, nC - number of cladogenetic
species, present - number of independent colonisations present).
</p>
</li>
<li><p><code>$stt_stt_type2</code>: STT table for type 2 species on the island
- only if 2 types of species were simulated (nI - number of non-endemic
species; nA - number of anagenetic species, nC - number of cladogenetic
species, present - number of independent colonisations present ).
</p>
</li>
<li><p><code>$brts_table</code>: Only for simulations under <code>"IW"</code>. Table
containing information on order of events in the data, for use in maximum
likelihood optimization.).
</p>
</li></ul>

<p>The subsequent elements of the list pertaining to each replcate contain
information on a single colonist lineage on the island and have 4 components:
</p>

<ul>
<li><p><code>$branching_times</code>: island age and stem age of the
population/species in the case of Non-endemic, Non-endemic_MaxAge and
Endemic anagenetic species.
</p>
<p>For cladogenetic species these should
be island age and branching times of the radiation including the
stem age of the radiation.
</p>
</li>
<li><p><code>$stac</code>: An integer ranging from 1 to 4
indicating the status of the colonist:
</p>

<ol>
<li><p> Non_endemic_MaxAge
</p>
</li>
<li><p> Endemic
</p>
</li>
<li><p> Endemic&amp;Non_Endemic
</p>
</li>
<li><p> Non_endemic_MaxAge
</p>
</li></ol>

</li>
<li><p><code>$missing_species</code>: number of island species that were
not sampled for particular clade (only applicable for endemic clades)
</p>
</li>
<li><p><code>$type_1or2</code>: whether the colonist belongs to type 1 or type 2
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Luis Valente, Albert Phillimore, Joshua Lambert, Shu Xie, Pedro
Neves, Richèl J. C. Bilderbeek, Rampal Etienne
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_plot_sims">DAISIE_plot_sims</a>()</code> for plotting STT of simulation
outputs.
</p>
<p>Other simulation models: 
<code><a href="#topic+DAISIE_sim_cr_shift">DAISIE_sim_cr_shift</a>()</code>,
<code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_sim">DAISIE_sim</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulate an island for 1 million years, with a relaxed the rate of
## cladogenesis between clades. Pool size 500.

clado_rate &lt;- 0.5
ext_rate &lt;- 0.2
carr_cap &lt;- Inf
immig_rate &lt;- 0.005
ana_rate &lt;- 1
par_sd &lt;- 1
sim_pars &lt;- c(clado_rate, ext_rate, carr_cap, immig_rate, ana_rate, par_sd)
set.seed(1)
island_replicates &lt;- DAISIE_sim_relaxed_rate(
  time = 1,
  M = 500,
  pars = sim_pars,
  replicates = 2,
  relaxed_par = "cladogenesis",
  plot_sims = FALSE,
  verbose = FALSE
)

</code></pre>

<hr>
<h2 id='DAISIE_sim_time_dep'>Simulate (non-)oceanic islands with given parameters under a
time-dependent regime</h2><span id='topic+DAISIE_sim_time_dep'></span>

<h3>Description</h3>

<p>This function simulates islands with given cladogenesis,
extinction, Kprime, immigration and anagenesis parameters, all of which
modelled as time-dependent parameters.
</p>
<p>Time dependency aims to capture the
effect of area changes islands undego from their emergence until subsidence.
Thus, oceanic, volcanic island ontogeny scenarios can be modelled (by a
beta function), as well as the effect of sea level fluctuations (modelled
through a sine function). See paramter entry <code>area_pars</code> for details.
Both island ontogeny and sea level fluctuations are allowed to operate
simultaneuosly.
</p>
<p>This function also allows for the simulation of
non-oceanic islands, generating islands for which the starting condition
includes potential endemic and non-endemic species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_time_dep(
  time,
  M,
  pars,
  replicates,
  area_pars,
  hyper_pars,
  divdepmodel = "CS",
  nonoceanic_pars = c(0, 0),
  num_guilds = NULL,
  sample_freq = 25,
  plot_sims = TRUE,
  island_ontogeny = "const",
  sea_level = "const",
  extcutoff = 1000,
  cond = 0,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_time_dep_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_divdepmodel">divdepmodel</code></td>
<td>
<p>Option divdepmodel = 'CS' runs a model with clade-specific
carrying capacity, where diversity-dependence operates only within single
clades, i.e. only among species originating from the same mainland
colonist. Option divdepmodel = 'IW' runs a model with island-wide
carrying capacity, where diversity-dependence operates within and among
clades. Option divdepmodel = 'GW' runs a model with diversity-dependence
operates within a guild.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_num_guilds">num_guilds</code></td>
<td>
<p>The number of guilds on the mainland. The number of
mainland species is divided by the number of guilds when
<code>divdepmodel = "GW"</code></p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_plot_sims">plot_sims</code></td>
<td>
<p><code>Default = TRUE</code> plots species-through-time (STT)
plots. It detects how many types of species are present. If only one type
of species is present, STT is plotted for all species. If two types are
present, three plots are produced: STT for all, STT for type 1 and STT for
type 2.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_+3A_...">...</code></td>
<td>
<p>Any arguments to pass on to plotting functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replciate. The first element of each replicate is composed of island
information containing:
</p>

<ul>
<li><p><code>$island_age</code>: A numeric with the island age.
</p>
</li>
<li><p><code>$not_present</code>: A numeric with the number of mainland lineages
that are not present on the island.
</p>
</li>
<li><p><code>$stt_all</code>: STT table for all species on the island
(nI - number of non-endemic species; nA - number of anagenetic species,
nC - number of cladogenetic species, present - number of independent
colonisations present)
</p>
</li>
<li><p><code>$brts_table</code>: Only for simulations under <code>"IW"</code>. Table
containing information on order of events in the data, for use in maximum
likelihood optimization.).
</p>
</li></ul>

<p>The subsequent elements of the list pertaining to each replcate contain
information on a single colonist lineage on the island and have 4 components:
</p>

<ul>
<li><p><code>$branching_times</code>: island age and stem age of the
population/species in the case of Non-endemic, Non-endemic_MaxAge and
Endemic anagenetic species. For cladogenetic species these should
be island age and branching times of the radiation including the
stem age of the radiation.
</p>
</li>
<li><p><code>$stac</code>: An integer ranging from 1 to 4
indicating the status of the colonist:
</p>

<ol>
<li><p> Non_endemic_MaxAge
</p>
</li>
<li><p> Endemic
</p>
</li>
<li><p> Endemic&amp;Non_Endemic
</p>
</li>
<li><p> Non_endemic_MaxAge
</p>
</li></ol>

</li>
<li><p><code>$missing_species</code>: number of island species that were
not sampled for particular clade (only applicable for endemic clades)
</p>
</li>
<li><p><code>$type_1or2</code>: whether the colonist belongs to type 1 or type 2
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Luis Valente and Albert Phillimore
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>
<p>Valente, L.M., Etienne, R.S. and Phillimore, A.B. (2014). The effects of
island ontogeny on species diversity and phylogeny.
Proceedings of the Royal Society B: Biological Sciences 281(1784),
p.20133227.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_plot_sims">DAISIE_plot_sims</a>()</code> for plotting STT of simulation
outputs.
</p>
<p>Other simulation models: 
<code><a href="#topic+DAISIE_sim_cr_shift">DAISIE_sim_cr_shift</a>()</code>,
<code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>,
<code><a href="#topic+DAISIE_sim">DAISIE_sim</a>()</code>
</p>

<hr>
<h2 id='DAISIE_sim_time_dep_cs'>Simulates island replicates with an clade-specific (CS) diversity-dependent
time-dependent process</h2><span id='topic+DAISIE_sim_time_dep_cs'></span>

<h3>Description</h3>

<p>Simulates island replicates with an clade-specific (CS) diversity-dependent
time-dependent process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_time_dep_cs(
  total_time,
  M,
  pars,
  replicates,
  area_pars,
  hyper_pars,
  nonoceanic_pars,
  sample_freq,
  island_ontogeny,
  sea_level,
  peak,
  Amax,
  Amin,
  extcutoff,
  cond,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_amax">Amax</code></td>
<td>
<p>A numeric value for maximum island area during the simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_amin">Amin</code></td>
<td>
<p>A numeric value for minimum island area during the simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_cs_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replicate. See return for 'DAISIE_sim_time_dep()' for details.
</p>

<hr>
<h2 id='DAISIE_sim_time_dep_gw'>Simulates island replicates with an guild-wide (GW) diversity-dependent
time-dependent process</h2><span id='topic+DAISIE_sim_time_dep_gw'></span>

<h3>Description</h3>

<p>Simulates island replicates with an guild-wide (GW) diversity-dependent
time-dependent process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_time_dep_gw(
  total_time,
  M,
  pars,
  replicates,
  area_pars,
  hyper_pars,
  nonoceanic_pars,
  num_guilds,
  sample_freq,
  island_ontogeny,
  sea_level,
  peak,
  Amax,
  Amin,
  extcutoff,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_num_guilds">num_guilds</code></td>
<td>
<p>The number of guilds on the mainland. The number of
mainland species is divided by the number of guilds when
<code>divdepmodel = "GW"</code></p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_amax">Amax</code></td>
<td>
<p>A numeric value for maximum island area during the simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_amin">Amin</code></td>
<td>
<p>A numeric value for minimum island area during the simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_gw_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replicate. See return for 'DAISIE_sim_time_dep()' for details.
</p>

<hr>
<h2 id='DAISIE_sim_time_dep_iw'>Simulates island replicates with an island-wide (IW) diversity-dependent
time-dependent process</h2><span id='topic+DAISIE_sim_time_dep_iw'></span>

<h3>Description</h3>

<p>Simulates island replicates with an island-wide (IW) diversity-dependent
time-dependent process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_time_dep_iw(
  total_time,
  M,
  pars,
  replicates,
  area_pars,
  hyper_pars,
  nonoceanic_pars,
  sample_freq,
  island_ontogeny,
  sea_level,
  peak,
  Amax,
  Amin,
  extcutoff,
  cond,
  verbose
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_amax">Amax</code></td>
<td>
<p>A numeric value for maximum island area during the simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_amin">Amin</code></td>
<td>
<p>A numeric value for minimum island area during the simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_sim_time_dep_iw_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replicate. See return for 'DAISIE_sim_time_dep()' for details.
</p>

<hr>
<h2 id='DAISIE_sim_trait_dep'>Simulate islands with given trait-dependent parameters.</h2><span id='topic+DAISIE_sim_trait_dep'></span>

<h3>Description</h3>

<p>This function simulates islands with given cladogenesis,
extinction, K, immigration and anagenesis parameters for binary states.
</p>
<p>Returns R list object that contains the simulated islands
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_trait_dep(
  time,
  M,
  pars,
  replicates,
  divdepmodel = "CS",
  sample_freq = 25,
  plot_sims = TRUE,
  island_ontogeny = "const",
  sea_level = "const",
  hyper_pars = create_hyper_pars(d = 0, x = 0),
  area_pars = DAISIE::create_area_pars(max_area = 1, current_area = 1,
    proportional_peak_t = 0, total_island_age = 0, sea_level_amplitude = 0,
    sea_level_frequency = 0, island_gradient_angle = 0),
  extcutoff = 1000,
  cond = 0,
  verbose = TRUE,
  trait_pars = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_divdepmodel">divdepmodel</code></td>
<td>
<p>Option divdepmodel = 'CS' runs a model with clade-specific
carrying capacity, where diversity-dependence operates only within single
clades, i.e. only among species originating from the same mainland
colonist. Option divdepmodel = 'IW' runs a model with island-wide
carrying capacity, where diversity-dependence operates within and among
clades. Option divdepmodel = 'GW' runs a model with diversity-dependence
operates within a guild.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_plot_sims">plot_sims</code></td>
<td>
<p><code>Default = TRUE</code> plots species-through-time (STT)
plots. It detects how many types of species are present. If only one type
of species is present, STT is plotted for all species. If two types are
present, three plots are produced: STT for all, STT for type 1 and STT for
type 2.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_+3A_...">...</code></td>
<td>
<p>Any arguments to pass on to plotting functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replciate. The first element of each replicate is composed of island
information containing:
</p>

<ul>
<li><p><code>$island_age</code>: A numeric with the island age.
</p>
</li>
<li><p><code>$not_present</code>: A numeric with the number of mainland lineages
that are not present on the island.
</p>
</li>
<li><p><code>$stt_all</code>: STT table for all species on the island
(nI - number of non-endemic species; nA - number of anagenetic species,
nC - number of cladogenetic species, present - number of independent
colonisations present)
</p>
</li>
<li><p><code>$brts_table</code>: Only for simulations under <code>"IW"</code>. Table
containing information on order of events in the data, for use in maximum
likelihood optimization.).
</p>
</li></ul>

<p>The subsequent elements of the list pertaining to each replcate contain
information on a single colonist lineage on the island and have 4 components:
</p>

<ul>
<li><p><code>$branching_times</code>: island age and stem age of the
population/species in the case of Non-endemic, Non-endemic_MaxAge and
Endemic anagenetic species. For cladogenetic species these should
be island age and branching times of the radiation including the
stem age of the radiation.
</p>
</li>
<li><p><code>$stac</code>: An integer ranging from 1 to 4
indicating the status of the colonist:
</p>
</li>
<li><p><code>$missing_species</code>: number of island species that were
not sampled for particular clade (only applicable for endemic clades)
</p>
</li>
<li><p><code>$type_1or2</code>: whether the colonist belongs to type 1 or type 2
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Luis Valente and Albert Phillimore
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
Hauffe, T., D. Delicado, R.S. Etienne and L. Valente (submitted).
Lake expansion increases equilibrium diversity via the target effect of
island biogeography.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_format_CS">DAISIE_format_CS</a></code> <code><a href="#topic+DAISIE_plot_sims">DAISIE_plot_sims</a></code>
</p>

<hr>
<h2 id='DAISIE_sim_trait_dep_2K'>Simulate islands with given trait-dependent parameters.</h2><span id='topic+DAISIE_sim_trait_dep_2K'></span>

<h3>Description</h3>

<p>This function simulates islands with given cladogenesis,
extinction, K, immigration and anagenesis parameters. In this version,
rates and K are both trait-dependent.
</p>
<p>Returns R list object that contains the simulated islands
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_trait_dep_2K(
  time,
  M,
  pars,
  replicates,
  divdepmodel = "CS",
  sample_freq = 25,
  plot_sims = TRUE,
  island_ontogeny = "const",
  sea_level = "const",
  hyper_pars = create_hyper_pars(d = 0, x = 0),
  area_pars = DAISIE::create_area_pars(max_area = 1, current_area = 1,
    proportional_peak_t = 0, total_island_age = 0, sea_level_amplitude = 0,
    sea_level_frequency = 0, island_gradient_angle = 0),
  extcutoff = 1000,
  cond = 0,
  verbose = TRUE,
  trait_pars = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_divdepmodel">divdepmodel</code></td>
<td>
<p>Option divdepmodel = 'CS' runs a model with clade-specific
carrying capacity, where diversity-dependence operates only within single
clades, i.e. only among species originating from the same mainland
colonist. Option divdepmodel = 'IW' runs a model with island-wide
carrying capacity, where diversity-dependence operates within and among
clades. Option divdepmodel = 'GW' runs a model with diversity-dependence
operates within a guild.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_plot_sims">plot_sims</code></td>
<td>
<p><code>Default = TRUE</code> plots species-through-time (STT)
plots. It detects how many types of species are present. If only one type
of species is present, STT is plotted for all species. If two types are
present, three plots are produced: STT for all, STT for type 1 and STT for
type 2.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_sim_trait_dep_2K_+3A_...">...</code></td>
<td>
<p>Any arguments to pass on to plotting functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list. The highest level of the least corresponds to each individual
replciate. The first element of each replicate is composed of island
information containing:
</p>

<ul>
<li><p><code>$island_age</code>: A numeric with the island age.
</p>
</li>
<li><p><code>$not_present</code>: A numeric with the number of mainland lineages
that are not present on the island.
</p>
</li>
<li><p><code>$stt_all</code>: STT table for all species on the island
(nI - number of non-endemic species; nA - number of anagenetic species,
nC - number of cladogenetic species, present - number of independent
colonisations present)
</p>
</li>
<li><p><code>$brts_table</code>: Only for simulations under <code>"IW"</code>. Table
containing information on order of events in the data, for use in maximum
likelihood optimization.).
</p>
</li></ul>

<p>The subsequent elements of the list pertaining to each replcate contain
information on a single colonist lineage on the island and have 4 components:
</p>

<ul>
<li><p><code>$branching_times</code>: island age and stem age of the
population/species in the case of Non-endemic, Non-endemic_MaxAge and
Endemic anagenetic species. For cladogenetic species these should
be island age and branching times of the radiation including the
stem age of the radiation.
</p>
</li>
<li><p><code>$stac</code>: An integer ranging from 1 to 4
indicating the status of the colonist:
</p>
</li>
<li><p><code>$missing_species</code>: number of island species that were
not sampled for particular clade (only applicable for endemic clades)
</p>
</li>
<li><p><code>$type_1or2</code>: whether the colonist belongs to type 1 or type 2
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Luis Valente and Albert Phillimore
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
Hauffe, T., D. Delicado, R.S. Etienne and L. Valente (submitted).
Lake expansion increases equilibrium diversity via the target effect of
island biogeography.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_format_CS">DAISIE_format_CS</a></code> <code><a href="#topic+DAISIE_plot_sims">DAISIE_plot_sims</a></code>
</p>

<hr>
<h2 id='DAISIE_sim_update_state_cr'>Updates state of island given sampled event for a constant rate case.</h2><span id='topic+DAISIE_sim_update_state_cr'></span>

<h3>Description</h3>

<p>Makes the event happen by updating island species matrix and species IDs.
What event happens is determined by the sampling in the algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_update_state_cr(
  timeval,
  total_time,
  possible_event,
  maxspecID,
  mainland_spec,
  island_spec,
  stt_table
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_update_state_cr_+3A_timeval">timeval</code></td>
<td>
<p>Numeric defining current time of simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_cr_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_cr_+3A_possible_event">possible_event</code></td>
<td>
<p>Numeric defining what event will happen.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_cr_+3A_maxspecid">maxspecID</code></td>
<td>
<p>Current species IDs.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_cr_+3A_mainland_spec">mainland_spec</code></td>
<td>
<p>Number of mainland species.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_cr_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_cr_+3A_stt_table">stt_table</code></td>
<td>
<p>Matrix with number of species at each time step.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The updated state of the system, which is a list with the
<code>island_spec</code> matrix, an integer <code>maxspecID</code> with the most recent
ID of species and the <code>stt_table</code>, a matrix with the current species
through time table.
</p>


<h3>See Also</h3>

<p><a href="#topic+DAISIE_sim_core_cr">DAISIE_sim_core_cr</a>,
<a href="#topic+DAISIE_sim_update_state_cr">DAISIE_sim_update_state_cr</a>
</p>

<hr>
<h2 id='DAISIE_sim_update_state_time_dep'>Updates state of island given sampled event</h2><span id='topic+DAISIE_sim_update_state_time_dep'></span>

<h3>Description</h3>

<p>Makes the event happen by updating island species matrix and species IDs.
What event happens is determined by the sampling in the algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_update_state_time_dep(
  timeval,
  total_time,
  possible_event,
  maxspecID,
  mainland_spec,
  island_spec,
  stt_table,
  rates,
  max_rates
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_update_state_time_dep_+3A_timeval">timeval</code></td>
<td>
<p>Numeric defining current time of simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_time_dep_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_time_dep_+3A_possible_event">possible_event</code></td>
<td>
<p>Numeric defining what event will happen.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_time_dep_+3A_maxspecid">maxspecID</code></td>
<td>
<p>Current species IDs.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_time_dep_+3A_mainland_spec">mainland_spec</code></td>
<td>
<p>Number of mainland species.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_time_dep_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_time_dep_+3A_stt_table">stt_table</code></td>
<td>
<p>Matrix with number of species at each time step.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_time_dep_+3A_rates">rates</code></td>
<td>
<p>named list of numeric rates as returned by
<code><a href="#topic+update_rates">update_rates</a>()</code>.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_time_dep_+3A_max_rates">max_rates</code></td>
<td>
<p>named list of numeric max rates as returned by
<code><a href="#topic+update_max_rates">update_max_rates</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The updated state of the system, which is a list with the
<code>island_spec</code> matrix, an integer <code>maxspecID</code> with the most recent
ID of species and the <code>stt_table</code>, a matrix with the current species
through time table.
</p>


<h3>See Also</h3>

<p><a href="#topic+DAISIE_sim_core_time_dep">DAISIE_sim_core_time_dep</a>
</p>

<hr>
<h2 id='DAISIE_sim_update_state_trait_dep'>Updates state of island given sampled event with two trait states.</h2><span id='topic+DAISIE_sim_update_state_trait_dep'></span>

<h3>Description</h3>

<p>Makes the event happen by updating island species matrix and species IDs.
What event happens is determined by the sampling in the algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_sim_update_state_trait_dep(
  timeval,
  total_time,
  possible_event,
  maxspecID,
  mainland_spec,
  island_spec,
  stt_table,
  trait_pars
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_sim_update_state_trait_dep_+3A_timeval">timeval</code></td>
<td>
<p>Numeric defining current time of simulation.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_trait_dep_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_trait_dep_+3A_possible_event">possible_event</code></td>
<td>
<p>Numeric defining what event will happen.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_trait_dep_+3A_maxspecid">maxspecID</code></td>
<td>
<p>Current species IDs.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_trait_dep_+3A_mainland_spec">mainland_spec</code></td>
<td>
<p>Number of mainland species.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_trait_dep_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_trait_dep_+3A_stt_table">stt_table</code></td>
<td>
<p>Matrix with number of species at each time step.</p>
</td></tr>
<tr><td><code id="DAISIE_sim_update_state_trait_dep_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>The updated state of the system, which is a list with the
<code>island_spec</code> matrix, an integer <code>maxspecID</code> with the most recent
ID of species and the <code>stt_table</code>, a matrix with the current species
through time table.
</p>


<h3>See Also</h3>

<p><a href="#topic+DAISIE_sim_core_trait_dep">DAISIE_sim_core_trait_dep</a>
</p>

<hr>
<h2 id='DAISIE_SR_loglik_CS'>Computes the loglikelihood of the DAISIE model with clade-specific
diversity-dependence given data and a set of model parameters that may shift
at some time</h2><span id='topic+DAISIE_SR_loglik_CS'></span><span id='topic+DAISIE_SR_loglik_all'></span>

<h3>Description</h3>

<p>Computes the loglikelihood of the DAISIE model with clade-specific
diversity-dependence given colonization and branching times for lineages on
an island, and a set of model parameters that may shift at some time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_SR_loglik_CS(
  pars1,
  pars2,
  datalist,
  methode = "lsodes",
  CS_version = 1,
  abstolint = 1e-16,
  reltolint = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_SR_loglik_CS_+3A_pars1">pars1</code></td>
<td>
<p>Contains the model parameters: <br /> <br />
<code>pars1[1]</code>
corresponds to lambda^c (cladogenesis rate) <br />
<code>pars1[2]</code> corresponds
to mu (extinction rate) <br />
<code>pars1[3]</code> corresponds to K (clade-level
carrying capacity) <br />
<code>pars1[4]</code> corresponds to gamma (immigration
rate) <br />
<code>pars1[5]</code> corresponds to lambda^a (anagenesis rate) <br />
<code>pars1[6]</code> corresponds to lambda^c (cladogenesis rate) after the shift
<br />
<code>pars1[7]</code> corresponds to mu (extinction rate) after the shift <br />
<code>pars1[8]</code> corresponds to K (clade-level carrying capacity) after the
shift <br />
<code>pars1[9]</code> corresponds to gamma (immigration rate) after the
shift <br />
<code>pars1[10]</code> corresponds to lambda^a (anagenesis rate) after
the shift <br />
<code>pars1[11]</code> corresponds to the time of shift <br /></p>
</td></tr>
<tr><td><code id="DAISIE_SR_loglik_CS_+3A_pars2">pars2</code></td>
<td>
<p>Contains the model settings <br /> <br />
<code>pars2[1]</code> corresponds
to lx = length of ODE variable x <br />
<code>pars2[2]</code> corresponds to ddmodel = diversity-dependent model,
model of diversity-dependence, which can be one of<br /> <br />
ddmodel = 0 : no diversity dependence <br />
ddmodel = 1 : linear dependence in speciation rate <br />
ddmodel = 11: linear dependence in speciation rate and in immigration rate <br />
ddmodel = 2 : exponential dependence in speciation rate<br />
ddmodel = 21: exponential dependence in speciation rate and in immigration rate<br /> <br />
<code>pars2[3]</code> corresponds
to cond = setting of conditioning<br /> <br />
cond = 0 : conditioning on island age <br />
cond = 1 : conditioning on island age and non-extinction of the
island biota <br />
cond &gt; 1 : conditioning on island age and having at least cond colonizations on the island <br /> <br />
<code>pars2[4]</code> sets whether parameters and likelihood should be printed (1) or not (0)</p>
</td></tr>
<tr><td><code id="DAISIE_SR_loglik_CS_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object, but
the object can of course also be entered directly. It is an R list object
with the following elements.<br />
The first element of the list has two or three components: <br /> <br />
<code>$island_age</code> - the island age <br />
Then, depending on whether a distinction between types is made, we have:<br />
<code>$not_present</code> - the number of mainland lineages that are not present
on the island <br />
The remaining elements of the list each contains
information on a single colonist lineage on the island and has 5
components:<br /> <br />
<code>$colonist_name</code> - the name of the species or clade
that colonized the island <br />
<code>$branching_times</code> - island age and stem
age of the population/species in the case of Non-endemic, Non-endemic_MaxAge
and Endemic anagenetic species. For cladogenetic species these should be
island age and branching times of the radiation including the stem age of
the radiation.<br />
<code>$stac</code> - the status of the colonist <br /> <br />
- Non_endemic_MaxAge: 1 <br /> * Endemic: 2 <br />
- Endemic&amp;Non_Endemic: 3 <br />
- Non_endemic: 4 <br />
- Endemic_MaxAge: 5 <br /> <br />
<code>$missing_species</code> -
number of island species that were not sampled for particular clade (only
applicable for endemic clades) <br /></p>
</td></tr>
<tr><td><code id="DAISIE_SR_loglik_CS_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. See package deSolve for details.
Default is &quot;lsodes&quot;</p>
</td></tr>
<tr><td><code id="DAISIE_SR_loglik_CS_+3A_cs_version">CS_version</code></td>
<td>
<p>a numeric or list. Default is 1 for the standard DAISIE
model, for a relaxed-rate model a list with the following elements:
</p>

<ul>
<li><p>model: the CS model to run, options are <code>1</code> for single rate
DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
model.
</p>
</li>
<li><p>relaxed_par: the parameter to relax (integrate over). Options are
<code>"cladogenesis"</code>, <code>"extinction"</code>, <code>"carrying_capacity"</code>,
<code>"immigration"</code>, or <code>"anagenesis"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_SR_loglik_CS_+3A_abstolint">abstolint</code></td>
<td>
<p>Absolute tolerance of the integration</p>
</td></tr>
<tr><td><code id="DAISIE_SR_loglik_CS_+3A_reltolint">reltolint</code></td>
<td>
<p>Relative tolerance of the integration</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output is a loglikelihood value
</p>


<h3>Value</h3>

<p>The loglikelihood
</p>


<h3>Author(s)</h3>

<p>Rampal S. Etienne &amp; Bart Haegeman
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_ML">DAISIE_ML</a></code>, <code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
utils::data(Galapagos_datalist_2types)
pars1 = c(0.195442017,0.087959583,Inf,0.002247364,0.873605049,
          3755.202241,8.909285094,14.99999923,0.002247364,0.873605049,0.163)
pars2 = c(100,11,0,1)
DAISIE_loglik_all(pars1,pars2,Galapagos_datalist_2types)

</code></pre>

<hr>
<h2 id='DAISIE_SR_ML'>Maximization of the loglikelihood under the DAISIE model with clade-specific
diversity-dependence</h2><span id='topic+DAISIE_SR_ML'></span><span id='topic+DAISIE_SR_ML_CS'></span>

<h3>Description</h3>

<p>This function computes the maximum likelihood estimates of the parameters of
the DAISIE model with clade-specific diversity-dependence and a shift in
parameters for data from lineages colonizing an island. It also outputs the
corresponding loglikelihood that can be used in model comparisons.
</p>
<p>The result of sort(c(idparsopt, idparsfix, idparsnoshift)) should be
identical to c(1:10). If not, an error is reported that the input is
incoherent. The same happens when the length of initparsopt is different
from the length of idparsopt, and the length of parsfix is different from
the length of idparsfix.<br /> Including the 11th parameter (p_f) in either
idparsopt or idparsfix (and therefore initparsopt or parsfix) is optional.
If this parameter is not specified, then the information in the data is
used, otherwise the information in the data is overruled.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_SR_ML_CS(
  datalist,
  initparsopt,
  idparsopt,
  parsfix,
  idparsfix,
  idparsnoshift = 6:10,
  res = 100,
  ddmodel = 0,
  cond = 0,
  island_ontogeny = NA,
  tol = c(1e-04, 1e-05, 1e-07),
  maxiter = 1000 * round((1.25)^length(idparsopt)),
  methode = "lsodes",
  optimmethod = "subplex",
  CS_version = 1,
  verbose = 0,
  tolint = c(1e-16, 1e-10),
  jitter = 0,
  num_cycles = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_SR_ML_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object, but
the object can of course also be entered directly. It is an R list object
with the following elements.<br /> The first element of the list has two three
components: <br /> <br /> <code>$island_age</code> - the island age <br /> Then, depending
on whether a distinction between types is made, we have:<br />
<code>$not_present</code> - the number of mainland lineages that are not present
on the island <br /> <br /> The remaining elements of the list each contains
information on a single colonist lineage on the island and has 5
components:<br /> <br /> <code>$colonist_name</code> - the name of the species or clade
that colonized the island <br /> <code>$branching_times</code> - island age and stem
age of the population/species in the case of Non-endemic, Non-endemic_MaxAge
and Endemic anagenetic species. For cladogenetic species these should be
island age and branching times of the radiation including the stem age of
the radiation.<br /> <code>$stac</code> - the status of the colonist <br /> <br /> *
Non_endemic_MaxAge: 1 <br /> * Endemic: 2 <br /> * Endemic&amp;Non_Endemic: 3 <br /> *
Non_endemic: 4 <br /> * Endemic_MaxAge: 5 <br /> <br /> <code>$missing_species</code> -
number of island species that were not sampled for particular clade (only
applicable for endemic clades) <br /></p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_initparsopt">initparsopt</code></td>
<td>
<p>The initial values of the parameters that must be
optimized</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_idparsopt">idparsopt</code></td>
<td>
<p>The ids of the parameters that must be optimized. The ids
are defined as follows: <br /> <br /> id = 1 corresponds to lambda^c (cladogenesis
rate) <br /> id = 2 corresponds to mu (extinction rate) <br /> id = 3 corresponds
to K (clade-level carrying capacity) <br /> id = 4 corresponds to gamma
(immigration rate) <br /> id = 5 corresponds to lambda^a (anagenesis rate) <br />
id = 6 corresponds to lambda^c (cladogenesis rate) after the shift <br /> id =
7 corresponds to mu (extinction rate) after the shift<br /> id = 8 corresponds
to K (clade-level carrying capacity) after the shift<br /> id = 9 corresponds
to gamma (immigration rate) after the shift<br /> id = 10 corresponds to
lambda^a (anagenesis rate) after the shift<br /> id = 11 corresponds to the
time of shift</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_parsfix">parsfix</code></td>
<td>
<p>The values of the parameters that should not be optimized</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_idparsfix">idparsfix</code></td>
<td>
<p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if lambda^c and K should not be optimized.</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_idparsnoshift">idparsnoshift</code></td>
<td>
<p>The ids of the parameters that should not be different
before and after the shift.</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_res">res</code></td>
<td>
<p>Sets the maximum number of species for which a probability must
be computed, must be larger than the size of the largest clade</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_ddmodel">ddmodel</code></td>
<td>
<p>Sets the model of diversity-dependence: <br /> <br /> ddmodel = 0 :
no diversity dependence <br /> ddmodel = 1 : linear dependence in speciation
rate <br /> ddmodel = 11: linear dependence in speciation rate and in
immigration rate <br /> ddmodel = 2 : exponential dependence in speciation
rate<br /> ddmodel = 21: exponential dependence in speciation rate and in
immigration rate.<br /></p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br /></p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>type of island ontonogeny. If NA, then constant
ontogeny is assumed.</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_tol">tol</code></td>
<td>
<p>Sets the tolerances in the optimization. Consists of: <br /> reltolx
= relative tolerance of parameter values in optimization <br /> reltolf =
relative tolerance of function value in optimization <br /> abstolx = absolute
tolerance of parameter values in optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_maxiter">maxiter</code></td>
<td>
<p>Sets the maximum number of iterations in the optimization.</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. See package deSolve for details.
Default is &quot;lsodes&quot;</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_optimmethod">optimmethod</code></td>
<td>
<p>Method used in likelihood optimization. Default is
&quot;subplex&quot; (see subplex package). Alternative is 'simplex' which was the
method in previous versions.</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_cs_version">CS_version</code></td>
<td>
<p>a numeric or list. Default is 1 for the standard DAISIE
model, for a relaxed-rate model a list with the following elements:
</p>

<ul>
<li><p>model: the CS model to run, options are <code>1</code> for single rate
DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
model.
</p>
</li>
<li><p>relaxed_par: the parameter to relax (integrate over). Options are
<code>"cladogenesis"</code>, <code>"extinction"</code>, <code>"carrying_capacity"</code>,
<code>"immigration"</code>, or <code>"anagenesis"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_verbose">verbose</code></td>
<td>
<p>sets whether parameters and likelihood should be printed (1)
or not (0).</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_tolint">tolint</code></td>
<td>
<p>Vector of two elements containing the absolute and relative
tolerance of the integration.</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_jitter">jitter</code></td>
<td>
<p>Numeric for <code><a href="DDD.html#topic+optimizer">optimizer</a>()</code>. Jitters the
parameters being optimized by the specified amount which should be very
small, e.g. 1e-5. Jitter when <code>link[subplex]{subplex}()</code> produces
incorrect output due to parameter transformation.</p>
</td></tr>
<tr><td><code id="DAISIE_SR_ML_+3A_num_cycles">num_cycles</code></td>
<td>
<p>The number of cycles the optimizer will go through.
Default is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a dataframe containing estimated parameters and
maximum loglikelihood.  </p>
<table>
<tr><td><code>lambda_c</code></td>
<td>
<p> gives the maximum likelihood
estimate of lambda^c, the rate of cladogenesis</p>
</td></tr> <tr><td><code>mu</code></td>
<td>
<p> gives the maximum
likelihood estimate of mu, the extinction rate</p>
</td></tr> <tr><td><code>K</code></td>
<td>
<p> gives the maximum
likelihood estimate of K, the carrying-capacity</p>
</td></tr> <tr><td><code>gamma</code></td>
<td>
<p> gives the
maximum likelihood estimate of gamma, the immigration rate </p>
</td></tr>
<tr><td><code>lambda_a</code></td>
<td>
<p> gives the maximum likelihood estimate of lambda^a, the rate
of anagenesis</p>
</td></tr> <tr><td><code>lambda_c2</code></td>
<td>
<p> gives the maximum likelihood estimate of
lambda^c2, the rate of cladogenesis for the optional second group of
species</p>
</td></tr> <tr><td><code>mu2</code></td>
<td>
<p> gives the maximum likelihood estimate of mu2, the
extinction rate for the optional second group of species</p>
</td></tr> <tr><td><code>K2</code></td>
<td>
<p> gives
the maximum likelihood estimate of K2, the carrying-capacity for the
optional second group of species</p>
</td></tr> <tr><td><code>gamma2</code></td>
<td>
<p> gives the maximum
likelihood estimate of gamma2, the immigration rate for the optional second
group of species</p>
</td></tr> <tr><td><code>lambda_a2</code></td>
<td>
<p> gives the maximum likelihood estimate of
lambda^a2, the rate of anagenesis for the optional second group of species</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p> gives the maximum loglikelihood</p>
</td></tr> <tr><td><code>df</code></td>
<td>
<p> gives the number
of estimated parameters, i.e. degrees of feedom</p>
</td></tr> <tr><td><code>conv</code></td>
<td>
<p> gives a
message on convergence of optimization; conv = 0 means convergence</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Rampal S. Etienne
</p>


<h3>References</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015).
Equilibrium and non-equilibrium dynamics simultaneously operate in the
Galapagos islands. Ecology Letters 18: 844-852. &lt;DOI:10.1111/ele.12461&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_loglik_all">DAISIE_loglik_all</a>()</code>,
<code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## In all following DAISIE_ML calls very high tolerances and low system size
## are used  for fast computation for this example. Use default or better
## tol, tolint an res values in actual analyses.
##################
### When all species have the same rates, and we want to optimize all 5
### parameters, we use:
utils::data(Galapagos_datalist)
DAISIE_ML(
   datalist = Galapagos_datalist,
   initparsopt = c(2.5,2.7,20,0.009,1.01),
   ddmodel = 11,
   idparsopt = 1:5,
   parsfix = NULL,
   idparsfix = NULL,
   tol = c(0.1, 0.02, 0.01),
   tolint = c(1e-4, 1e-2),
   res = 50
)

### When all species have the same rates, and we want to optimize all parameters
# except K (which we set equal to Inf), we use:

utils::data(Galapagos_datalist)
DAISIE_ML(
   datalist = Galapagos_datalist,
   initparsopt = c(2.5,2.7,0.009,1.01),
   idparsopt = c(1,2,4,5),
   parsfix = Inf,
   idparsfix = 3,
   tol = c(0.1, 0.02, 0.01),
   tolint = c(1e-4, 1e-2),
   res = 50
   )

### When all species have the same rates except that the finches have a different
# rate of cladogenesis, and we want to optimize all parameters except K (which we
# set equal to Inf), fixing the proportion of finch-type species at 0.163, we use:

utils::data(Galapagos_datalist_2types)
DAISIE_ML(
   datalist = Galapagos_datalist_2types,
   initparsopt = c(0.38,0.55,0.004,1.1,2.28),
   idparsopt = c(1,2,4,5,6),
   parsfix = c(Inf,Inf,0.163),
   idparsfix = c(3,8,11),
   idparsnoshift = c(7,9,10),
   tol = c(0.1, 0.02, 0.01),
   tolint = c(1e-4, 1e-2),
   res = 50
   )

### When all species have the same rates except that the finches have a different
# rate of cladogenesis, extinction and a different K, and we want to optimize all
# parameters, fixing the proportion of finch-type species at 0.163, we use:

utils::data(Galapagos_datalist_2types)
DAISIE_ML(
   datalist = Galapagos_datalist_2types,
   ddmodel = 11,
   initparsopt = c(0.19,0.09,0.002,0.87,20,8.9,15),
   idparsopt = c(1,2,4,5,6,7,8),
   parsfix = c(Inf,0.163),
   idparsfix = c(3,11),
   idparsnoshift = c(9,10),
   tol = c(0.1, 0.02, 0.01),
   tolint = c(1e-4, 1e-2),
   res = 50
   )


### When all species have the same rates except that the finches have a different
# rate of extinction, and we want to optimize all parameters except K (which we
# set equal to Inf), and we also# want to estimate the fraction of finch species
# in the mainland pool. we use:

utils::data(Galapagos_datalist_2types)
DAISIE_ML(
   datalist = Galapagos_datalist_2types,
   initparsopt = c(2.48,2.7,0.009,1.01,2.25,0.163),
   idparsopt = c(1,2,4,5,7,11),
   parsfix = c(Inf,Inf),
   idparsfix = c(3,8),
   idparsnoshift = c(6,9,10),
   tol = c(0.1, 0.02, 0.01),
   tolint = c(1e-4, 1e-2),
   res = 50
   )

### When we have two islands with the same rates except for immigration and anagenesis rate,
# and we want to optimize all parameters, we use:

utils::data(Galapagos_datalist)
DAISIE_ML(
   datalist = list(Galapagos_datalist,Galapagos_datalist),
   datatype = 'multiple',
   initparsopt = c(2.5,2.7,20,0.009,1.01,0.009,1.01),
   idparsmat = rbind(1:5,c(1:3,6,7)),
   idparsopt = 1:7,
   parsfix = NULL,
   idparsfix = NULL,
   tol = c(0.1, 0.02, 0.01),
   tolint = c(1e-4, 1e-2),
   res = 50
)

### When we consider the four Macaronesia archipelagoes and set all parameters the same
# except for rates of cladogenesis, extinction and immigration for Canary Islands,
# rate of cladogenesis is fixed to 0 for the other archipelagoes,
# diversity-dependence is assumed to be absent
# and we want to optimize all parameters, we use:

utils::data(Macaronesia_datalist)
DAISIE_ML(
   datalist = Macaronesia_datalist,
   datatype = 'multiple',
   initparsopt = c(1.053151832,0.052148979,0.512939011,0.133766934,0.152763179),
   idparsmat = rbind(1:5,c(6,2,3,7,5),1:5,1:5),
   idparsopt = c(2,4,5,6,7),
   parsfix = c(0,Inf),
   idparsfix = c(1,3),
   tol = c(0.1, 0.02, 0.01),
   tolint = c(1e-4, 1e-2),
   res = 50
)


</code></pre>

<hr>
<h2 id='DAISIE_SR_sim_core'>DEPRECATED - Algorithm component of DAISIE_SR_sim.</h2><span id='topic+DAISIE_SR_sim_core'></span>

<h3>Description</h3>

<p>#' @details This function's use has been deprecated in favour
of <code><a href="#topic+DAISIE_sim_cr_shift">DAISIE_sim_cr_shift</a>()</code>. Please use that
function instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAISIE_SR_sim_core(time, mainland_n, pars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DAISIE_SR_sim_core_+3A_time">time</code></td>
<td>
<p>Length of the simulation in time units. For example, if an
island is know to be 4 million years old, setting time = 4 will simulate
entire life span of the island; setting time = 2 will stop the simulation at
the mid-life of the island.</p>
</td></tr>
<tr><td><code id="DAISIE_SR_sim_core_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="DAISIE_SR_sim_core_+3A_pars">pars</code></td>
<td>
<p>Contains the model parameters: <br /> <br /> <code>pars[1]</code>
corresponds to lambda^c (cladogenesis rate) before the shift <br /> <code>pars[2]</code> corresponds
to mu (extinction rate) before the shift <br /> <code>pars[3]</code> corresponds to K (clade-level
carrying capacity) before the shift. Set K=Inf for non-diversity dependence.<br />
<code>pars[4]</code> corresponds to gamma (immigration rate) before the shift <br /> <code>pars[5]</code>
corresponds to lambda^a (anagenesis rate) before the shift <br /> <code>pars[6]</code> corresponds to
lambda^c (cladogenesis rate) after the shift <br /> <code>pars[7]</code>
corresponds to mu (extinction rate) after the shift <br /> <code>pars[8]</code>
corresponds to K (clade-level carrying capacity) after the shift.  Set
K=Inf for non-diversity dependence. <br /> <code>pars[9]</code> corresponds to gamma
(immigration rate)  after the shift <br /> <code>pars[10]</code> corresponds to
lambda^a (anagenesis rate) after the shift <br /> <code>pars[11]</code> corresponds to
the time of shift. This is defined as time before the end of the simulation. For example,
setting time = 4 and pars[11] = 1.5 will simulate with pars[1:5] from 4 to 1.5 and
with pars[6:10] from 1.5 to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with DAISIE simulation.
</p>


<h3>Author(s)</h3>

<p>Luis Valente, Albert Phillimore, and Torsten Hauffe
</p>


<h3>References</h3>

<p>Hauffe, T., D. Delicado, R.S. Etienne and L. Valente (2020).
Lake expansion increases equilibrium diversity via the target effect of
island biogeography
</p>

<hr>
<h2 id='DAISIE-package'>DAISIE: Dynamical Assembly of Islands by Speciation, Immigration and Extinction</h2><span id='topic+DAISIE'></span><span id='topic+DAISIE-package'></span>

<h3>Description</h3>

<p>DAISIE is an island biogeography model that assumes island biota
assembly is governed by immigration, extinction and speciation through cladogenesis
and anagenesis. This likelihood-based statistical package can simulate islands and
estimate parameters of the DAISIE model based on phylogenetic/phylogeographic data.
Cladogenesis and immigration rates can be dependent on diversity.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Rampal S. Etienne <a href="mailto:r.s.etienne@rug.nl">r.s.etienne@rug.nl</a> (<a href="https://orcid.org/0000-0003-2142-7612">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Luis Valente <a href="mailto:luis.valente@naturalis.nl">luis.valente@naturalis.nl</a> (<a href="https://orcid.org/0000-0003-4247-8785">ORCID</a>)
</p>
</li>
<li><p> Albert B. Phillimore (<a href="https://orcid.org/0000-0002-6553-1553">ORCID</a>)
</p>
</li>
<li><p> Bart Haegeman (<a href="https://orcid.org/0000-0003-2325-4727">ORCID</a>)
</p>
</li>
<li><p> Joshua W. Lambert <a href="mailto:j.w.l.lambert@rug.nl">j.w.l.lambert@rug.nl</a> (<a href="https://orcid.org/0000-0001-5218-3046">ORCID</a>)
</p>
</li>
<li><p> Pedro Santos Neves <a href="mailto:p.m.santos.neves@rug.nl">p.m.santos.neves@rug.nl</a> (<a href="https://orcid.org/0000-0003-2561-4677">ORCID</a>)
</p>
</li>
<li><p> Shu Xie <a href="mailto:s.xie@rug.nl">s.xie@rug.nl</a> (<a href="https://orcid.org/0000-0001-9594-946X">ORCID</a>)
</p>
</li>
<li><p> Richèl J.C. Bilderbeek <a href="mailto:richel@richelbilderbeek.nl">richel@richelbilderbeek.nl</a> (<a href="https://orcid.org/0000-0003-1107-7049">ORCID</a>)
</p>
</li>
<li><p> Hanno Hildenbrandt <a href="mailto:h.hildenbrandt@rug.nl">h.hildenbrandt@rug.nl</a> (<a href="https://orcid.org/0000-0002-6784-1037">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Torsten Hauffe <a href="mailto:torsten.hauffe@gmail.com">torsten.hauffe@gmail.com</a> (<a href="https://orcid.org/0000-0001-5711-9457">ORCID</a>) [contributor]
</p>
</li>
<li><p> Giovanni Laudanno <a href="mailto:glaudanno@gmail.com">glaudanno@gmail.com</a> (<a href="https://orcid.org/0000-0002-2952-3345">ORCID</a>) [contributor]
</p>
</li>
<li><p> Nadiah Kristensen <a href="mailto:nadiah@nadiah.org">nadiah@nadiah.org</a> (<a href="https://orcid.org/0000-0002-9720-4581">ORCID</a>) [contributor]
</p>
</li>
<li><p> Raphael Scherrer <a href="mailto:r.scherrer@rug.nl">r.scherrer@rug.nl</a> (<a href="https://orcid.org/0000-0002-1447-7630">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Valente, L. M., Etienne, R. S., &amp; Phillimore, A. B. (2014). The effects of island ontogeny on species diversity and phylogeny. Proceedings of the Royal Society of London. Series B, Biological Sciences 281, 20133227. <a href="https://doi.org/10.1098/rspb.2013.3227">doi:10.1098/rspb.2013.3227</a>. <br />
</p>
</li>
<li><p> Valente, L., A.B. Phillimore &amp; R.S. Etienne (2015). Equilibrium and non-equilibrium dynamics simultaneously operate in the Galapagos islands. Ecology Letters 18: 844-852, <a href="https://doi.org/10.1111/ele.12461">doi:10.1111/ele.12461</a>. <br />
</p>
</li>
<li><p> Valente, L., R.S. Etienne &amp; L. Davalos (2017). Recent extinctions disturb path to equilibrium diversity in Caribbean bats. Nature Ecology and Evolution 1: 0026. <a href="https://doi.org/10.1038/s41559-016-0026">doi:10.1038/s41559-016-0026</a>.<br />
</p>
</li>
<li><p> Valente, L., Illera, J. C., Havenstein, K., Pallien, T., Etienne, R. S., &amp; Tiedemann, R. (2017). Equilibrium Bird Species Diversity in Atlantic Islands. Current Biology 27: 1660-1666. <a href="https://doi.org/10.1016/j.cub.2017.04.053">doi:10.1016/j.cub.2017.04.053</a>.<br />
</p>
</li>
<li><p> Valente, L., Phillimore, A. B., &amp; Etienne, R. (2018). Using molecular phylogenies in island biogeography: It's about time. Ecography 41: 1684-1686. <a href="https://doi.org/10.1111/ecog.03503">doi:10.1111/ecog.03503</a>.<br />
</p>
</li>
<li><p> Valente, L., Etienne, R. S., &amp; Garcia-R, J. C. (2019). Deep macroevolutionary impact of humans on New Zealand's unique avifauna. Current Biology 29: 2563-2569. <a href="https://doi.org/10.1016/j.cub.2019.06.058">doi:10.1016/j.cub.2019.06.058</a>.<br />
</p>
</li>
<li><p> Valente, L., Phillimore, A. B., Melo, M., Warren, B. H., Clegg, S. M., Havenstein, K., &amp; Etienne, R. S. (2020). A simple dynamic model explains the diversity of island birds worldwide. Nature 579: 92-96. <a href="https://doi.org/10.1038/s41586-020-2022-5">doi:10.1038/s41586-020-2022-5</a>.<br />
</p>
</li>
<li><p> Hauffe, T., Delicado, D., Etienne, R.S., &amp; Valente, L. (2020). Lake expansion elevates equilibrium diversity via increasing colonization. Journal of Biogeography 47: 1849–1860. <a href="https://doi.org/10.1111/jbi.13914">doi:10.1111/jbi.13914</a>.<br />
</p>
</li>
<li><p> Valente, L., Kristensen, N., Phillimore, A. B., &amp; Etienne, R. S. (2021). Report of programming bugs in the DAISIE R package: consequences and correction. EcoEvoRxiv. <a href="https://doi.org/10.32942/osf.io/w5ntf">doi:10.32942/osf.io/w5ntf</a>.<br />
</p>
</li>
<li><p> Santos Neves, P., Lambert, J. W., Valente, L., &amp; Etienne, R. S. (2022). The robustness of a simple dynamic model of island biodiversity to geological and sea-level change. Journal of Biogeography 49: 2091-2104. <a href="https://doi.org/10.1111/jbi.14519">doi:10.1111/jbi.14519</a>.<br />
</p>
</li>
<li><p> Lambert, J. W., Santos Neves, P., Bilderbeek, R. L. C., Valente, L., Etienne, R. S. (2022). The effect of mainland dynamics on data and parameter estimates in island biogeography. bioRxiv. <a href="https://doi.org/10.1101/2022.01.13.476210">doi:10.1101/2022.01.13.476210</a>.<br />
</p>
</li>
<li><p> Xie, S., Valente, L., Etienne, R. S. (2023). Can we ignore trait-dependent colonization and diversification in island biogeography? Evolution. <a href="https://doi.org/10.1093/evolut/qpad006">doi:10.1093/evolut/qpad006</a>.<br />
</p>
</li>
<li><p> Michielsen, N. M., Goodman, S. M., Soarimalala, V., van der Geer, A. A. E., Dávalos, L. M., Saville, G. I., Upham, N., Valente, L. (2023). The macroevolutionary impact of recent and imminent mammal extinctions on Madagascar. Nature Communications 14 (14).<a href="https://doi.org/10.1038/s41467-022-35215-3">doi:10.1038/s41467-022-35215-3</a>.<br />
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/rsetienne/DAISIE">https://github.com/rsetienne/DAISIE</a>
</p>
</li>
<li> <p><a href="https://rsetienne.github.io/DAISIE/">https://rsetienne.github.io/DAISIE/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/rsetienne/DAISIE/issues">https://github.com/rsetienne/DAISIE/issues</a>
</p>
</li></ul>


<hr>
<h2 id='default_params_doc'>Default parameter documentation</h2><span id='topic+default_params_doc'></span>

<h3>Description</h3>

<p>Default parameter documentation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_params_doc(
  time,
  M,
  pars,
  replicates,
  divdepmodel,
  nonoceanic_pars,
  num_guilds,
  prop_type2_pool,
  replicates_apply_type2,
  sample_freq,
  plot_sims,
  verbose,
  area_pars,
  hyper_pars,
  island_ontogeny,
  sea_level,
  extcutoff,
  shift_times,
  mainland_n,
  island_replicates,
  island_spec,
  stt_table,
  rates,
  max_rates,
  timeval,
  total_time,
  possible_event,
  maxspecID,
  mainland_spec,
  max_area,
  proportional_peak_t,
  total_island_age,
  sea_level_amplitude,
  sea_level_frequency,
  island_gradient_angle,
  d,
  x,
  simulation_outputs,
  plot_plus_one,
  type,
  plot_lists,
  ...,
  datalist,
  datatype,
  initparsopt,
  idparsopt,
  idparsfix,
  parsfix,
  idparsnoshift,
  idparsmat,
  res,
  ddmodel,
  cond,
  eqmodel,
  x_E,
  x_I,
  tol,
  maxiter,
  methode,
  optimmethod,
  CS_version,
  tolint,
  datatable,
  island_age,
  number_clade_types,
  list_type2_clades,
  epss,
  t,
  initEI,
  data_table,
  endmc,
  archipelago,
  phylo_data,
  archipelago_data,
  gam,
  laa,
  lac,
  mu,
  K,
  num_spec,
  num_immigrants,
  global_min_area_time,
  global_max_area_time,
  distance_type,
  distance_dep,
  parallel,
  cpus,
  pars1,
  pars2,
  tvec,
  initprobs,
  pb,
  island,
  title,
  plot_lists_simulations,
  plot_lists_simulations_MLE,
  kind_of_plot,
  resolution,
  resol,
  removed_timepoints,
  A,
  Amin,
  Amax,
  peak,
  proptime,
  proptime_max,
  current_area,
  jitter,
  num_cycles,
  trait_pars,
  relaxed_par,
  relaxed_rate_pars,
  brts,
  stac,
  missnumspec,
  DAISIE_par,
  DAISIE_dist_pars,
  abstolint,
  reltolint,
  pick,
  mean,
  sd,
  clado_rate,
  ext_rate,
  carr_cap,
  immig_rate,
  ana_rate,
  islands,
  sort_clade_sizes
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="default_params_doc_+3A_time">time</code></td>
<td>
<p>Numeric defining the length of the simulation in time units.
For example, if an island is known to be 4 million years old, setting
time = 4 will simulate the entire life span of the island; setting time = 2
will stop the simulation at the mid-life of the island.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_m">M</code></td>
<td>
<p>Numeric defining the size of mainland pool, i.e. the number of
species that can potentially colonize the island.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_pars">pars</code></td>
<td>
<p>A numeric vector containing the model parameters:
</p>

<ul>
<li><p><code>pars[1]</code>: lambda^c (cladogenesis rate)
</p>
</li>
<li><p><code>pars[2]</code>: mu (extinction rate)
</p>
</li>
<li><p><code>pars[3]</code>: K (carrying capacity), set K=Inf for diversity
independence.
</p>
</li>
<li><p><code>pars[4]</code>: gamma (immigration rate)
</p>
</li>
<li><p><code>pars[5]</code>: lambda^a (anagenesis rate)
</p>
</li>
<li><p><code>pars[6]</code>: lambda^c (cladogenesis rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[7]</code>: mu (extinction rate) for either type 2 species or rate
set 2 in rate shift model
</p>
</li>
<li><p><code>pars[8]</code>: K (carrying capacity) for either type 2 species or rate
set 2 in rate shift model, set K=Inf for diversity independence.
</p>
</li>
<li><p><code>pars[9]</code>: gamma (immigration rate) for either type 2 species
or rate set 2 in rate shift model
</p>
</li>
<li><p><code>pars[10]</code>: lambda^a (anagenesis rate) for either type 2
species or rate set 2 in rate shift model
</p>
</li></ul>

<p>Elements 6:10 are required only when type 2 species are included
or in the rate shift model. For <code><a href="#topic+DAISIE_sim_relaxed_rate">DAISIE_sim_relaxed_rate</a>()</code>
<code>pars[6]</code> is the standard deviation of the gamma distribution for the
relaxed parameter and the parameter chosen by the <code>relaxed_par</code>
argument is the mean of the gamma distribution for the relaxed parameter.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_replicates">replicates</code></td>
<td>
<p>Integer specifying number of island replicates to be
simulated.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_divdepmodel">divdepmodel</code></td>
<td>
<p>Option divdepmodel = 'CS' runs a model with clade-specific
carrying capacity, where diversity-dependence operates only within single
clades, i.e. only among species originating from the same mainland
colonist. Option divdepmodel = 'IW' runs a model with island-wide
carrying capacity, where diversity-dependence operates within and among
clades. Option divdepmodel = 'GW' runs a model with diversity-dependence
operates within a guild.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_nonoceanic_pars">nonoceanic_pars</code></td>
<td>
<p>A vector of length two with:
</p>

<ul>
<li><p>[1]: the probability of sampling a species from the mainland
</p>
</li>
<li><p>[2]: the probability of the species sampled from the mainland
being nonendemic
</p>
</li></ul>
</td></tr>
<tr><td><code id="default_params_doc_+3A_num_guilds">num_guilds</code></td>
<td>
<p>The number of guilds on the mainland. The number of
mainland species is divided by the number of guilds when
<code>divdepmodel = "GW"</code></p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_prop_type2_pool">prop_type2_pool</code></td>
<td>
<p>Fraction of mainland species that belongs to the
second subset of species (type 2). Applies only when two types of species
are simulated (length(pars) = 10). For <code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a>()</code>
applies only if number_clade_types = 2.  In <code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a>()</code>
the default <code>"proportional"</code> sets the fraction to be proportional to
the number of clades of distinct macroevolutionary process that have
colonised the island.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_replicates_apply_type2">replicates_apply_type2</code></td>
<td>
<p>Applies only when two types of species are
being simulated. Default replicates_apply_type2 = TRUE runs simulations
until the number of islands where a type 2 species has colonised is equal
to the specified number of replicates. This is recommended if
<code>prop_type2_pool</code> is small or if the rate of immigration of type two
species (<code>pars[9]</code>) is low, meaning that more replicates are needed to
achieved an adequate sample size of islands with type 2 species. Setting
<code>replicates_apply_type2 = FALSE</code> simulates islands up to the
specified number of replicates regardless of whether type 2 species have
colonised or not.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sample_freq">sample_freq</code></td>
<td>
<p>Numeric specifing the number of units times should be
divided by for plotting purposes. Larger values will lead to plots with
higher resolution, but will also run slower.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_plot_sims">plot_sims</code></td>
<td>
<p><code>Default = TRUE</code> plots species-through-time (STT)
plots. It detects how many types of species are present. If only one type
of species is present, STT is plotted for all species. If two types are
present, three plots are produced: STT for all, STT for type 1 and STT for
type 2.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_verbose">verbose</code></td>
<td>
<p>A numeric vector of length 1, which in simulations and
'DAISIEdataprep()' can be '1' or '0', where '1' gives intermediate output
should be printed.
For ML functions a numeric determining if intermediate output should be
printed. The default: '0' does not print, '1' prints the initial
likelihood and the settings that were selected (which parameters are
to be optimised, fixed or shifted), '2' prints the same as '1 and also the
intermediate output of the parameters and loglikelihood, while '3' the
same as '2' and prints intermediate progress during likelihood computation.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="default_params_doc_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="default_params_doc_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_shift_times">shift_times</code></td>
<td>
<p>a numeric vector specifying when the rate shifts occur
before the present.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_island_replicates">island_replicates</code></td>
<td>
<p>List output from
<code><a href="#topic+DAISIE_sim_core_cr">DAISIE_sim_core_cr</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_time_dep">DAISIE_sim_core_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_sim_core_cr_shift">DAISIE_sim_core_cr_shift</a>()</code> or
<code><a href="#topic+DAISIE_sim_min_type2">DAISIE_sim_min_type2</a>()</code> functions. Minimally, this must be a
list that has as many elements as replicates. Each element must be a list
with the elements <code>island_age</code>, <code>not_present</code> and <code>stt_all</code>.
<code>stt_all</code> must be a data frame with the column names <code>Time</code>,
<code>nI</code>, <code>nA</code>, <code>nC</code> and <code>present</code>.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_stt_table">stt_table</code></td>
<td>
<p>Matrix with number of species at each time step.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_rates">rates</code></td>
<td>
<p>named list of numeric rates as returned by
<code><a href="#topic+update_rates">update_rates</a>()</code>.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_max_rates">max_rates</code></td>
<td>
<p>named list of numeric max rates as returned by
<code><a href="#topic+update_max_rates">update_max_rates</a>()</code>.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_timeval">timeval</code></td>
<td>
<p>Numeric defining current time of simulation.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_possible_event">possible_event</code></td>
<td>
<p>Numeric defining what event will happen.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_maxspecid">maxspecID</code></td>
<td>
<p>Current species IDs.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_mainland_spec">mainland_spec</code></td>
<td>
<p>Number of mainland species.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_max_area">max_area</code></td>
<td>
<p>Numeric defining maximum area.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_proportional_peak_t">proportional_peak_t</code></td>
<td>
<p>Numeric value from 0 to 1 indicating
where in the island's history the peak area is achieved.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_total_island_age">total_island_age</code></td>
<td>
<p>Numeric defining total island age.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sea_level_amplitude">sea_level_amplitude</code></td>
<td>
<p>Numeric defining amplitude of area fluctuation
from sea level.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sea_level_frequency">sea_level_frequency</code></td>
<td>
<p>Numeric defining frequency of sine wave of
area change from sea level.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_island_gradient_angle">island_gradient_angle</code></td>
<td>
<p>Numeric defining the angle in degrees
specifying the slope of the island.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_d">d</code></td>
<td>
<p>Numeric defining the scaling parameter for exponent for
calculating cladogenesis rate.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_x">x</code></td>
<td>
<p>Numeric defining the exponent for calculating extinction rate.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_simulation_outputs">simulation_outputs</code></td>
<td>
<p>A list with matrices and vectors of simulation
produced by DAISIE_sim functions.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_plot_plus_one">plot_plus_one</code></td>
<td>
<p>Boolean to indicate to plot all values plus one.
Set to <code>TRUE</code> for default behavior. Set to <code>FALSE</code> to plot all
values without adding one. Only works when there is one type of species.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_type">type</code></td>
<td>
<p>String to indicate if stt of all species or all possible stt
should be plotted. Default is <code>"all_species"</code>, <code>"type1_species"</code>
or <code>"type2_species"</code> should be plotted.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_plot_lists">plot_lists</code></td>
<td>
<p>List of lists containing average and quantile species
through time.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_...">...</code></td>
<td>
<p>Any arguments to pass on to plotting functions.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_datalist">datalist</code></td>
<td>
<p>Data object containing information on colonisation and
branching times. This object can be generated using the DAISIE_dataprep
function, which converts a user-specified data table into a data object,
but the object can of course also be entered directly.
It is an R list object with the following elements.<br /> The first element
of the list has two or three components: <br /> <br /> <code>$island_age</code> - the
island age <br /> Then, depending on whether a distinction between types is
made, we have:<br /> <code>$not_present</code> - the number of mainland lineages
that are not present on the island <br /> or:<br /> <code>$not_present_type1</code> -
the number of mainland lineages of type 1 that are not present on the
island <br /> <code>$not_present_type2</code> - the number of mainland lineages of
type 2 that are not present on the island <br /> <br /> The remaining elements of
the list each contains information on a single colonist lineage on the
island and has 5 components:<br /> <br /> <code>$colonist_name</code> - the name of the
species or clade that colonized the island <br /> <code>$branching_times</code> -
island age followed by stem age of the population/species in the case of
Non-endemic, Non-endemic_MaxAge species and Endemic species with no close relatives
on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade
including the stem age of the clade<br /> <code>$stac</code> - the
status of the colonist <br /> <br /> * Non_endemic_MaxAge: 1 <br /> * Endemic: 2
<br /> * Endemic&amp;Non_Endemic: 3 <br /> * Non_Endemic: 4 <br />
* Endemic_Singleton_MaxAge: 5 <br /> * Endemic_Clade_MaxAge: 6
<br /> * Endemic&amp;Non_Endemic_Clade_MaxAge: 7 <br />
<br /> <code>$missing_species</code> - number of island species that were not
sampled for particular clade (only applicable for endemic clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or type 2 <br /></p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_datatype">datatype</code></td>
<td>
<p>Sets the type of data: 'single' for a single island or
archipelago treated as one, and 'multiple' for multiple archipelagoes
potentially sharing the same parameters.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_initparsopt">initparsopt</code></td>
<td>
<p>The initial values of the parameters that must be
optimized, they are all positive.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_idparsopt">idparsopt</code></td>
<td>
<p>The ids of the parameters that must be optimized. The ids
are defined as follows: <br /> <br /> id = 1 corresponds to lambda^c
(cladogenesis rate) <br /> id = 2 corresponds to mu (extinction rate) <br />
id = 3 corresponds to K (clade-level carrying capacity) <br /> id = 4
corresponds to gamma (immigration rate) <br /> id = 5 corresponds to lambda^a
(anagenesis rate) <br /> id = 6 corresponds to lambda^c (cladogenesis rate)
for an optional subset of the species <br /> id = 7 corresponds to mu
(extinction rate) for an optional subset of the species<br /> id = 8
corresponds to K (clade-level carrying capacity) for an optional subset of
the species<br /> id = 9 corresponds to gamma (immigration rate) for an
optional subset of the species<br /> id = 10 corresponds to lambda^a
(anagenesis rate) for an optional subset of the species<br /> id = 11
corresponds to p_f (fraction of mainland species that belongs to the second
subset of species.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_idparsfix">idparsfix</code></td>
<td>
<p>The ids of the parameters that should not be optimized,
e.g. c(1,3) if lambda^c and K should not be optimized.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_parsfix">parsfix</code></td>
<td>
<p>The values of the parameters that should not be optimized.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_idparsnoshift">idparsnoshift</code></td>
<td>
<p>For datatype = 'single' only: The ids of the parameters
that should not be different between two groups of species; This can only
apply to ids 6:10, e.g. idparsnoshift = c(6,7) means that lambda^c and mu
have the same values for both groups.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_idparsmat">idparsmat</code></td>
<td>
<p>For datatype = 'multiple' only: Matrix containing the ids
of the parameters, linking them to initparsopt and parsfix. Per island
system we use the following order: <br /> <br /> * lac = (initial) cladogenesis
rate <br /> * mu = extinction rate <br /> * K = maximum number of species possible
in the clade <br /> * gam = (initial) immigration rate <br /> * laa = (initial)
anagenesis rate <br /> Example:
<code>idparsmat = rbind(c(1, 2, 3, 4, 5), c(1, 2, 3, 6, 7))</code> has different
rates of immigration and anagenesis for the two islands.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_res">res</code></td>
<td>
<p>Sets the maximum number of species for which a probability must
be computed, must be larger than the size of the largest clade.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_ddmodel">ddmodel</code></td>
<td>
<p>Sets the model of diversity-dependence: <br /> <br /> ddmodel = 0 :
no diversity dependence <br /> ddmodel = 1 : linear dependence in speciation
rate <br /> ddmodel = 11: linear dependence in speciation rate and in
immigration rate <br /> ddmodel = 2 : exponential dependence in speciation
rate<br /> ddmodel = 21: exponential dependence in speciation rate and in
immigration rate<br /></p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_cond">cond</code></td>
<td>
<p>cond = 0 : conditioning on island age <br /> cond = 1 :
conditioning on island age and non-extinction of the island biota <br />.
cond &gt; 1 : conditioning on island age and having at least cond colonizations
on the island. This last option is not yet available for the IW model <br /></p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_eqmodel">eqmodel</code></td>
<td>
<p>Sets the equilibrium constraint that can be used during the
likelihood optimization. Only available for datatype = 'single'.<br /><br />
eqmodel = 0 : no equilibrium is assumed <br /> eqmodel = 13 : near-equilibrium
is assumed on endemics using deterministic equation for endemics and
immigrants. Endemics must be within x_E of the equilibrium value<br /> eqmodel
= 15 : near-equilibrium is assumed on endemics and immigrants using
deterministic equation for endemics and immigrants. Endemics must be within
x_E of the equilibrium value, while non-endemics must be within x_I of the
equilibrium value.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_x_e">x_E</code></td>
<td>
<p>Sets the fraction of the equlibrium endemic diversity above which
the endemics are assumed to be in equilibrium; only active for eqmodel = 13
or 15.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_x_i">x_I</code></td>
<td>
<p>Sets the fraction of the equlibrium non-endemic diversity above
which the system is assumed to be in equilibrium; only active for eqmodel =
15.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_tol">tol</code></td>
<td>
<p>Sets the tolerances in the optimization. Consists of: <br /> reltolx
= relative tolerance of parameter values in optimization <br /> reltolf =
relative tolerance of function value in optimization <br /> abstolx = absolute
tolerance of parameter values in optimization.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_maxiter">maxiter</code></td>
<td>
<p>Sets the maximum number of iterations in the optimization.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_methode">methode</code></td>
<td>
<p>Method of the ODE-solver. Supported Boost <code>ODEINT</code>
solvers (steppers) are:
<code>"odeint::runge_kutta_cash_karp54"</code>
<code>"odeint::runge_kutta_fehlberg78"</code>
<code>"odeint::runge_kutta_dopri5"</code>
<code>"odeint::bulirsch_stoer"</code>
without <code>odeint::</code>-prefix, <code><a href="deSolve.html#topic+deSolve">deSolve</a>{ode}</code> method is
assumed. The default method overall is
<code>"lsodes"</code> for <code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a>()</code>
and <code>"ode45"</code> from <code><a href="deSolve.html#topic+ode">ode</a>()</code> for
<code><a href="#topic+DAISIE_ML_IW">DAISIE_ML_IW</a>()</code>.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_optimmethod">optimmethod</code></td>
<td>
<p>Method used in likelihood optimization. Default is
'subplex' (see '<a href="subplex.html#topic+subplex">subplex</a>()' for full details).
Alternative is <code>"simplex"</code> which was the method in previous versions.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_cs_version">CS_version</code></td>
<td>
<p>a numeric or list. Default is 1 for the standard DAISIE
model, for a relaxed-rate model a list with the following elements:
</p>

<ul>
<li><p>model: the CS model to run, options are <code>1</code> for single rate
DAISIE model, <code>2</code> for multi-rate DAISIE, or <code>0</code> for IW test
model.
</p>
</li>
<li><p>relaxed_par: the parameter to relax (integrate over). Options are
<code>"cladogenesis"</code>, <code>"extinction"</code>, <code>"carrying_capacity"</code>,
<code>"immigration"</code>, or <code>"anagenesis"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="default_params_doc_+3A_tolint">tolint</code></td>
<td>
<p>Vector of two elements containing the absolute and relative
tolerance of the integration.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_datatable">datatable</code></td>
<td>
<p>Data frame (table) with user-specified data. See file
<code>Galapagos_datatable</code> for a template of an input table. Each row on the
table represents and independent colonisation event. Table has the
following four columns. <br /> <br /> <code>$Clade_name</code> - name of independent
colonization event <br /> <code>$Status</code> - One of the following categories:
<br /> * &quot;Non_endemic&quot;: applies to non-endemic species for cases where both
island and non-island populations of the species have been sampled) <br /> *
&quot;Non_endemic_MaxAge&quot;: applies to non-endemic species for cases where island
individuals of the species have not been sampled and only the age of the
species is available) <br /> * &quot;Endemic&quot;: applies to endemic species and is
applicable for both cladogenetic and anagenetic species <br /> *
&quot;Endemic_MaxAge&quot;: applies to endemic species for cases where island
individuals of the species have not been sampled and only the age of the
species is available. This could apply to endemic species that have
recently gone extinct because of antropogenic causes that are (evidently)
not modelled, and for which no DNA data is available.<br /> *
&quot;Endemic&amp;Non_Endemic&quot;: when endemic clade is present and its mainland
ancestor has re-colonized <br /> <code>$Missing_species</code> - Number of island
species that were not sampled for particular clade (only applicable for
&quot;Endemic&quot; clades) <br /> <code>$Branching_times</code> - Stem age of the
population/species in the case of &quot;Non-endemic&quot;, &quot;Non-endemic_MaxAge&quot; and
&quot;Endemic&quot; anagenetic species. For &quot;Endemic&quot; cladogenetic species these
should be branching times of the radiation including the stem age of the
radiation.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_island_age">island_age</code></td>
<td>
<p>Age of island in appropriate units. In
<code><a href="#topic+DAISIE_plot_age_diversity">DAISIE_plot_age_diversity</a>()</code> and
<code><a href="#topic+DAISIE_plot_island">DAISIE_plot_island</a>()</code> if island input is in table format,
the age of the island must be specified. If island input is in DAISIE list
format, this option will override the island age specified in the island
list.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_number_clade_types">number_clade_types</code></td>
<td>
<p>Number of clade types. Default: number_clade_types
= 1 all species are considered to belong to same macroevolutionary process.
If number_clade_types = 2, there are two types of clades with distinct
macroevolutionary processes.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_list_type2_clades">list_type2_clades</code></td>
<td>
<p>If <code>number_clade_types = 2</code>, list_type2_clades
specifies the names of the clades that have a distinct macroevolutionary
process. The names must match those in the $Clade_name column of the source
data table (e.g. <code>list_type2_clades = "Finches"</code>).  If
<code>number_clade_types = 1</code>, then list_type2_clades = NA should be
specified (default).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_epss">epss</code></td>
<td>
<p>Default= 1E-5 should be appropriate in most cases. This value
is used to set the maximum age of colonisation of &quot;Non_endemic_MaxAge&quot; and
&quot;Endemic_MaxAge&quot; species to an age that is slightly younger than the island
for cases when the age provided for that species is older than the island.
The new maximum age is then used as an upper bound to integrate over all.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_t">t</code></td>
<td>
<p>The time at which the expectations need to be computed.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_initei">initEI</code></td>
<td>
<p>The initial values for the number of endemics and
non-endemics. In <code><a href="#topic+DAISIE_probdist">DAISIE_probdist</a>()</code> or
<code><a href="#topic+DAISIE_margprobdist">DAISIE_margprobdist</a>()</code> either this or initprobs must be NULL. In
<code><a href="#topic+DAISIE_numcol">DAISIE_numcol</a>()</code> when it is NULL, it is assumed that the island
is empty.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_data_table">data_table</code></td>
<td>
<p>data table</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_endmc">endmc</code></td>
<td>
<p>Numeric for how many simulations should run.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_archipelago">archipelago</code></td>
<td>
<p>something</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_phylo_data">phylo_data</code></td>
<td>
<p>something</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_archipelago_data">archipelago_data</code></td>
<td>
<p>something</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_gam">gam</code></td>
<td>
<p>A numeric with the per capita immigration rate.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_laa">laa</code></td>
<td>
<p>A numeric with the per capita anagenesis rate.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_lac">lac</code></td>
<td>
<p>A numeric with the per capita cladogenesis rate.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_mu">mu</code></td>
<td>
<p>A numeric with the per capita extinction rate.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_k">K</code></td>
<td>
<p>A numeric with carrying capacity.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_num_spec">num_spec</code></td>
<td>
<p>A numeric with the current number of species.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_num_immigrants">num_immigrants</code></td>
<td>
<p>A numeric with the current number of non-endemic
species (a.k.a non-endemic species).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_global_min_area_time">global_min_area_time</code></td>
<td>
<p>stub</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_global_max_area_time">global_max_area_time</code></td>
<td>
<p>stub</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_distance_type">distance_type</code></td>
<td>
<p>Use 'continent' if the distance to the continent should
be used, use 'nearest_big' if the distance to the nearest big landmass
should be used, and use 'biologically_realistic' if the distance should
take into account some biologically realism, e.g. an average of the
previous two if both are thought to contribute.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_distance_dep">distance_dep</code></td>
<td>
<p>Sets what type of distance dependence should be used.
Default is a power law, denoted as 'power'. Alternatives are an exponantial
relationship denoted by 'exp' or sigmoids, either 'sigmoidal_col' for a
sigmoid in the colonization, 'sigmoidal_ana' for sigmoidal anagenesis,
'sigmoidal_clado' for sigmoidal cladogenesis, and 'sigmoidal_col_ana' for
signoids in both colonization and anagenesis.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_parallel">parallel</code></td>
<td>
<p>Sets whether parallel computation should be used. Use 'no'
if no parallel computing should be used, 'cluster' for parallel computing
on a unix/linux cluster, and 'local' for parallel computation on a local
machine.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_cpus">cpus</code></td>
<td>
<p>Number of cpus used in parallel computing. Default is 3. Will
not have an effect if parallel = 'no'.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_pars1">pars1</code></td>
<td>
<p>Vector of model parameters: <br /> <br /> <code>pars1[1]</code> corresponds
to lambda^c (cladogenesis rate) <br /> <code>pars1[2]</code> corresponds to mu
(extinction rate) <br /> <code>pars1[3]</code> corresponds to K (clade-level
carrying capacity) <br /> <code>pars1[4]</code> corresponds to gamma
(immigration rate) <br /> <code>pars1[5]</code> corresponds to lambda^a
(anagenesis rate).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_pars2">pars2</code></td>
<td>
<p>Vector of settings: <br /> <br /> <code>pars2[1]</code> corresponds to res,
the maximum number of endemics or non-endemics for which the ODE system is
solved; this must be much larger than the actual number for which the
probability needs to be calculated.) <br /> <code>pars2[2]</code> corresponds to M,
size of the mainland pool, i.e the number of species that can potentially
colonize the island.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_tvec">tvec</code></td>
<td>
<p>The times at which the probabilities need to be computed.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_initprobs">initprobs</code></td>
<td>
<p>The initial probability distribution for the number of
endemics and non-endemics; either this or initEI must be NULL.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_pb">pb</code></td>
<td>
<p>Probability distribution in matrix format as output by
<code><a href="#topic+DAISIE_probdist">DAISIE_probdist</a>()</code>.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_island">island</code></td>
<td>
<p>Island data object. Can be in DAISIE list format (see
Galapagos_datalist and DAISIE_data_prep for examples) or in table format
(see Galapagos_datatable for an example).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_title">title</code></td>
<td>
<p>Title of the plot</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_plot_lists_simulations">plot_lists_simulations</code></td>
<td>
<p>List with simulation output after parsing by
<code>DAISIE_prepare_data_plotting</code>.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_plot_lists_simulations_mle">plot_lists_simulations_MLE</code></td>
<td>
<p>List with simulation output after parsing
by <code>DAISIE_prepare_data_plotting</code>, but obtained by simulating MLE
output.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_kind_of_plot">kind_of_plot</code></td>
<td>
<p>Character vector stating how STT plot resulting from MLE
based simulations should be plotted. Default is <code>"line"</code> for multiple
individual lines. Can also be <code>"shade"</code> for the 5% quantile.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_resolution">resolution</code></td>
<td>
<p>numeric indicating resolution of plot. Should be &lt; 0.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_resol">resol</code></td>
<td>
<p>numeric for resolution of summary stats calculation. Should be
&gt; 1.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_removed_timepoints">removed_timepoints</code></td>
<td>
<p>Positive integer with number of first datapoints
to be removed from rate plots (to prevent Inf)</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_a">A</code></td>
<td>
<p>A numeric value for island area at a given point in time.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_amin">Amin</code></td>
<td>
<p>A numeric value for minimum island area during the simulation.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_amax">Amax</code></td>
<td>
<p>A numeric value for maximum island area during the simulation.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_proptime">proptime</code></td>
<td>
<p>A numeric from 0 to 1. The proportion of time that has
elapsed in the simulation, in relation to the total island age (NB: not
the simulation time, but island age).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_proptime_max">proptime_max</code></td>
<td>
<p>A numeric from 0 to 1. The same as
<code>proportional_peak_t</code>. Indicates, in proportion to the total island
age when the ontogeny peak should occur (i.e. 0.5 means a peak halfway in
time).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_current_area">current_area</code></td>
<td>
<p>A numeric with the current island area at present (i.e.,
at the end of the simulation).</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_jitter">jitter</code></td>
<td>
<p>Numeric for <code><a href="DDD.html#topic+optimizer">optimizer</a>()</code>. Jitters the
parameters being optimized by the specified amount which should be very
small, e.g. 1e-5. Jitter when <code>link{subplex}{subplex}()</code> produces
incorrect output due to parameter transformation.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_num_cycles">num_cycles</code></td>
<td>
<p>The number of cycles the optimizer will go through.
Default is 1.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
<tr><td><code id="default_params_doc_+3A_relaxed_par">relaxed_par</code></td>
<td>
<p>A string determining which parameter is relaxed in a
relaxed rate model.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_relaxed_rate_pars">relaxed_rate_pars</code></td>
<td>
<p>A list of two numbers, element one is the
distribution mean, element two is the distribution standard deviation (sd).
Currently the distribution is the gamma distribution. The list can be created
with <code>create_relaxed_rate_pars()</code>.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_brts">brts</code></td>
<td>
<p>Numeric vector of branching times</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_stac">stac</code></td>
<td>
<p>Numeric of Endemicity status</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_missnumspec">missnumspec</code></td>
<td>
<p>Numeric of missing species</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_daisie_par">DAISIE_par</code></td>
<td>
<p>A numeric parameter to evaluate the integral of the
function.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_daisie_dist_pars">DAISIE_dist_pars</code></td>
<td>
<p>A numeric vector of two elements, first is the mean
and second the standard deviation of the distribution.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_abstolint">abstolint</code></td>
<td>
<p>Numeric absolute tolerance of the integration</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_reltolint">reltolint</code></td>
<td>
<p>Numeric relative tolerance of the integration</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_pick">pick</code></td>
<td>
<p>Numeric determining which parameter is selected for the
relaxed-rate model</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_mean">mean</code></td>
<td>
<p>Numeric mean of the distribution</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sd">sd</code></td>
<td>
<p>Numeric standard deviation of the distribution</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_clado_rate">clado_rate</code></td>
<td>
<p>Numeric rate of cladogenesis</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_ext_rate">ext_rate</code></td>
<td>
<p>Numeric rate of extinction</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_carr_cap">carr_cap</code></td>
<td>
<p>Numeric carrying capacity</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_immig_rate">immig_rate</code></td>
<td>
<p>Numeric rate of immigration</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_ana_rate">ana_rate</code></td>
<td>
<p>Numeric rate of anagenesis</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_islands">islands</code></td>
<td>
<p>Island datalist or simulated data in DAISIE datalist format.
Can be a single island (empirical data) generated with DAISIE_dataprep or
DAISIEprep. Can also be simulated data generated with DAISIE_sim function.</p>
</td></tr>
<tr><td><code id="default_params_doc_+3A_sort_clade_sizes">sort_clade_sizes</code></td>
<td>
<p>Default sort_clade_sizes = T outputs clade sizes
sorted in ascending order of number of species. sort_clade_sizes=F outputs
clade sizes in the same order as they appear in the input datalist.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Note</h3>

<p>This is an internal function, so it should be marked with
<code>@noRd</code>. This is not done, as this will disallow all
functions to find the documentation parameters
</p>

<hr>
<h2 id='frogs_datalist'>Colonization and branching times of 5 Eleutherodactylus clades from Hispaniola island.</h2><span id='topic+frogs_datalist'></span>

<h3>Description</h3>

<p>A list containing the colonization and branching times of the Eleutherodactylus frogs of
Hispaniola. Main dataset used in Etienne et al. This list can be generated
using the DAISIE_dataprep function, which converts a user-specified data table into a data object,
but the
object can of course also be entered directly. It is an R list object with
the following elements.<br /> <br />
The first element of the list has two
components: <br /> <br />
<code>$island_age</code> - the island age <br />
<code>$not_present</code> - the number of mainland lineages that are not present
on the island <br /> <br />
The following elements of the list each contains
information on a single colonist lineage on the island and has 5
components:<br /> <br />
<code>$colonist_name</code> - the name of the species or clade
that colonized the island <br />
<code>$branching_times</code> - island age followed by stem age of the population/species
in the case of Non-endemic, Non-endemic_MaxAge species and Endemic species with no close
relatives on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade including the stem age of the clade.<br />
<code>$stac</code> - the status of the colonist <br /> <br />
* Non_endemic_MaxAge: 1 <br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_endemic: 4 <br />
* Endemic_MaxAge: 5 or 6 <br /> <br />
<code>$missing_species</code> - number of island species
that were not sampled for particular clade (only applicable for endemic
clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or
type 2. In this dataset all are equal to 1. <br />
</p>


<h3>Format</h3>

<p>A list with 6 elements, the first of which contains 2 elements and
the following 5 elements containing 5 components.
</p>


<h3>Source</h3>

<p>Etienne RS, Haegeman B, Dugo-Cota A, Vila C, Gonzalez-Voyer A &amp; Valente L. The
limits to ecological limits to diversification.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a></code>, <code><a href="#topic+DAISIE_ML">DAISIE_ML</a></code>, <code><a href="#topic+DAISIE_SR_ML">DAISIE_SR_ML</a></code>
</p>

<hr>
<h2 id='frogs_datatable'>Colonization and branching times of 5 Eleutherodactylus (frogs) clades from
the island of Hispaniola.</h2><span id='topic+frogs_datatable'></span>

<h3>Description</h3>

<p>A table containing the colonization and branching times of the Eleutherodacytlus
frogs of the island of Hispaniola (Greater Antilles). Each row on the table represents and independent
colonisation event. The table has four columns. <br /> <br />
<code>$Clade_name</code> -
name of independent colonization event <br />
<code>$Status</code> - One of the
following categories: <br />
* Non_endemic: for non-endemic island species when an approximate time of colonisation is known <br />
* Non_endemic_MaxAge: for non-endemic island species when colonisation time is unknown <br />
* Endemic: for endemic species when an approximate colonisation time is known <br />
* &quot;Endemic_MaxAge&quot;: applies to endemic species or endemic clades for cases where the
colonisation time is unknown, or when
the user wants to specify an upper bound for colonisation.
This could for example apply to endemic species that have recently gone extinct because
of anthropogenic causes, and which are not included
in the phylogeny (&quot;NA&quot; should be given in the branching times column). It
could also apply to insular radiations with long stem branches, for which the
time of the first cladogenetic event is known, but the precise time of colonisation
is not.<br />
* Endemic&amp;Non_Endemic: when endemic clade and mainland ancestor has
re-colonized <br />
</p>


<h3>Format</h3>

<p>A table with 5 rows and 4 columns.
</p>


<h3>Source</h3>

<p>Etienne RS, Haegeman B, Dugo-Cota A, Vila C, Gonzalez-Voyer A &amp; Valente L. The
limits to ecological limits to diversification.<br />
</p>

<hr>
<h2 id='Galapagos_datalist'>Colonization and branching times of 8 terrestrial avifaunal clades in list
format, accepted by DAISIE_ML and DAISIE_loglik_all</h2><span id='topic+Galapagos_datalist'></span>

<h3>Description</h3>

<p>A list containing the colonization and branching times of the terrestrial
avifauna in the Galapagos where no distinction is made between types of
colonists. This list can be generated using the DAISIE_dataprep function,
which converts a user-specified data table into a data object, but the
object can of course also be entered directly. It is an R list object with
the following elements.<br /> <br />
The first element of the list has two
components: <br /> <br />
<code>$island_age</code> - the island age <br />
<code>$not_present</code> - the number of mainland lineages that are not present
on the island <br /> <br />
The following 8 elements of the list each contains
information on a single colonist lineage on the island and has 5
components:<br /> <br />
<code>$colonist_name</code> - the name of the species or clade
that colonized the island <br />
<code>$branching_times</code> - island age followed by stem age of the population/species
in the case of Non-endemic, Non-endemic_MaxAge species and Endemic species with no close
relatives on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island cladeincluding the stem age of the clade.<br />
<code>$stac</code> - the status of the colonist <br /> <br />
* Non_endemic_MaxAge: 1 <br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_endemic: 4 <br /> <br />
<code>$missing_species</code> - number of island species
that were not sampled for particular clade (only applicable for endemic
clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or
type 2. In this dataset all are equal to 1. <br />
</p>


<h3>Format</h3>

<p>A list with 9 elements the first of which contains 2 elements and
the following 8 containing 5 components.
</p>


<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a></code>, <code><a href="#topic+DAISIE_ML">DAISIE_ML</a></code>
</p>

<hr>
<h2 id='Galapagos_datalist_2types'>Colonization and branching times of 8 terrestrial avifaunal clades in list
format, accepted by DAISIE_ML and DAISIE_loglik_all</h2><span id='topic+Galapagos_datalist_2types'></span>

<h3>Description</h3>

<p>A list containing the colonization and branching times of the terrestrial
avifauna in the Galapagos. This list can be generated using the
DAISIE_dataprep function, which converts a user-specified data table into a
data object, but the object can of course also be entered directly. It is an
R list object with the following elements.<br /> <br />
The first element of the
list has three components: <br /> <br />
<code>$island_age</code> - the island age <br />
<code>$not_present_type1</code> - the number of mainland lineages of type 1 that
are not present on the island <br />
<code>$not_present_type2</code> - the number of
mainland lineages of type 2 that are not present on the island <br /> <br /> The
following 8 elements of the list each contains information on a single
colonist lineage on the island and has 5 components:<br /> <br />
<code>$colonist_name</code> - the name of the species or clade that colonized the
island <br />
<code>$branching_times</code> - island age followed by stem age of the population/species
in the case of Non-endemic, Non-endemic_MaxAge species and Endemic species with no close relatives
on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island cladeincluding the stem age of the clade.<br />
<code>$stac</code> - the status of the colonist <br /> <br />
* Non_endemic_MaxAge: 1 <br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_endemic: 4 <br /> <br />
<code>$missing_species</code> - number of island species
that were not sampled for particular clade (only applicable for endemic
clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or
type 2. In this dataset only the finches are type 2 <br />
</p>


<h3>Format</h3>

<p>A list with 9 elements the first of which contains 3 elements and
the following 8 containing 5 components.
</p>


<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a></code>, <code><a href="#topic+DAISIE_ML">DAISIE_ML</a></code>
</p>

<hr>
<h2 id='Galapagos_datatable'>Colonization and branching times of 8 terrestrial avifaunal Galápagos clades in table
format.</h2><span id='topic+Galapagos_datatable'></span>

<h3>Description</h3>

<p>A table containing the colonization and branching times of the terrestrial
avifauna in the Galápagos. Each row on the table represents and independent
colonisation event. The table has four columns. <br /> <br />
<code>$Clade_name</code> -
name of independent colonization event <br />
<code>$Status</code> - One of the
following categories: <br />
* Non_endemic: for non-endemic island species when an approximate time of colonisation is known <br />
* Non_endemic_MaxAge: for non-endemic island species when colonisation time is unknown <br />
* Endemic: for endemic species when an approximate colonisation time is known <br />
* &quot;Endemic_MaxAge&quot;: applies to endemic species or endemic clades for cases where the
colonisation time is unknown, or when
the user wants to specify an upper bound for colonisation.
This could for example apply to endemic species that have recently gone extinct because
of anthropogenic causes, and which are not included
in the phylogeny (&quot;NA&quot; should be given in the branching times column). It
could also apply to insular radiations with long stem branches, for which the
time of the first cladogenetic event is known, but the precise time of colonisation
is not.<br />
* Endemic&amp;Non_Endemic: when endemic clade and mainland ancestor has
re-colonized <br />
</p>
<p><code>$Missing_species</code> - Number of island species that
were not sampled for particular clade (only applicable for endemic clades)<br />
<code>$Branching_times</code> - Stem age of the population/species in the case of &quot;Non_endemic&quot;,
&quot;Non_endemic_MaxAge&quot; and &quot;Endemic&quot; species with no extant close relatives on the island.
Set &quot;NA&quot; if colonisation time unknown and no upper bound is known.
For &quot;Endemic&quot; cladogenetic species these should be branching times of the
radiation, including the stem age of the radiation (colonisation time estimate).<br />
</p>


<h3>Format</h3>

<p>A table with 8 rows and 4 columns.
</p>


<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a></code>, <code><a href="#topic+DAISIE_ML">DAISIE_ML</a></code>
</p>

<hr>
<h2 id='get_ana_rate'>Calculate anagenesis rate</h2><span id='topic+get_ana_rate'></span>

<h3>Description</h3>

<p>Internal function.
Calculates the anagenesis rate given the current number of
immigrant species and the per capita rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ana_rate(laa, num_immigrants, island_spec = NULL, trait_pars = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ana_rate_+3A_laa">laa</code></td>
<td>
<p>A numeric with the per capita anagenesis rate.</p>
</td></tr>
<tr><td><code id="get_ana_rate_+3A_num_immigrants">num_immigrants</code></td>
<td>
<p>A numeric with the current number of non-endemic
species (a.k.a non-endemic species).</p>
</td></tr>
<tr><td><code id="get_ana_rate_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
<tr><td><code id="get_ana_rate_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pedro Neves, Joshua Lambert, Shu Xie
</p>


<h3>See Also</h3>

<p>Other rate calculations: 
<code><a href="#topic+DAISIE_plot_area">DAISIE_plot_area</a>()</code>,
<code><a href="#topic+get_ext_rate">get_ext_rate</a>()</code>,
<code><a href="#topic+get_immig_rate">get_immig_rate</a>()</code>,
<code><a href="#topic+island_area_vector">island_area_vector</a>()</code>,
<code><a href="#topic+island_area">island_area</a>()</code>,
<code><a href="#topic+update_max_rates">update_max_rates</a>()</code>,
<code><a href="#topic+update_rates">update_rates</a>()</code>
</p>

<hr>
<h2 id='get_clado_rate'>Calculate cladogenesis rate</h2><span id='topic+get_clado_rate'></span>

<h3>Description</h3>

<p>Internal function.
Calculates the cladogenesis rate given the current number of
species in the system, the carrying capacity and the per capita cladogenesis
rate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_clado_rate(
  lac,
  hyper_pars,
  num_spec,
  K,
  A,
  trait_pars = NULL,
  island_spec = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_clado_rate_+3A_lac">lac</code></td>
<td>
<p>A numeric with the per capita cladogenesis rate.</p>
</td></tr>
<tr><td><code id="get_clado_rate_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_clado_rate_+3A_num_spec">num_spec</code></td>
<td>
<p>A numeric with the current number of species.</p>
</td></tr>
<tr><td><code id="get_clado_rate_+3A_k">K</code></td>
<td>
<p>A numeric with carrying capacity.</p>
</td></tr>
<tr><td><code id="get_clado_rate_+3A_a">A</code></td>
<td>
<p>A numeric value for island area at a given point in time.</p>
</td></tr>
<tr><td><code id="get_clado_rate_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_clado_rate_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pedro Neves, Joshua Lambert, Shu Xie
</p>

<hr>
<h2 id='get_ext_rate'>Calculate extinction rate</h2><span id='topic+get_ext_rate'></span>

<h3>Description</h3>

<p>Calculate extinction rate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ext_rate(
  mu,
  hyper_pars,
  extcutoff = 1000,
  num_spec,
  A = 1,
  trait_pars = NULL,
  island_spec = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ext_rate_+3A_mu">mu</code></td>
<td>
<p>A numeric with the per capita extinction rate.</p>
</td></tr>
<tr><td><code id="get_ext_rate_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_ext_rate_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
<tr><td><code id="get_ext_rate_+3A_num_spec">num_spec</code></td>
<td>
<p>A numeric with the current number of species.</p>
</td></tr>
<tr><td><code id="get_ext_rate_+3A_a">A</code></td>
<td>
<p>A numeric value for island area at a given point in time.</p>
</td></tr>
<tr><td><code id="get_ext_rate_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_ext_rate_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric, with the extinction rate given the base extinction rate,
if present, the hyperparemeter <code>x</code>, A(t) if time-dependent and traits
if running a traint model.
</p>


<h3>Author(s)</h3>

<p>Pedro Neves, Joshua Lambert, Shu Xie
</p>


<h3>References</h3>

<p>Valente, Luis M., Rampal S. Etienne, and Albert B. Phillimore.
&quot;The effects of island ontogeny on species diversity and phylogeny.&quot;
Proceedings of the Royal Society of London B: Biological Sciences 281.1784
(2014): 20133227.
</p>


<h3>See Also</h3>

<p>Other rate calculations: 
<code><a href="#topic+DAISIE_plot_area">DAISIE_plot_area</a>()</code>,
<code><a href="#topic+get_ana_rate">get_ana_rate</a>()</code>,
<code><a href="#topic+get_immig_rate">get_immig_rate</a>()</code>,
<code><a href="#topic+island_area_vector">island_area_vector</a>()</code>,
<code><a href="#topic+island_area">island_area</a>()</code>,
<code><a href="#topic+update_max_rates">update_max_rates</a>()</code>,
<code><a href="#topic+update_rates">update_rates</a>()</code>
</p>

<hr>
<h2 id='get_immig_rate'>Calculate immigration rate</h2><span id='topic+get_immig_rate'></span>

<h3>Description</h3>

<p>Internal function.
Calculates the immigration rate given the current number of
species in the system, the carrying capacity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_immig_rate(
  gam,
  A = 1,
  num_spec,
  K,
  mainland_n,
  trait_pars = NULL,
  island_spec = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_immig_rate_+3A_gam">gam</code></td>
<td>
<p>A numeric with the per capita immigration rate.</p>
</td></tr>
<tr><td><code id="get_immig_rate_+3A_a">A</code></td>
<td>
<p>A numeric value for island area at a given point in time.</p>
</td></tr>
<tr><td><code id="get_immig_rate_+3A_num_spec">num_spec</code></td>
<td>
<p>A numeric with the current number of species.</p>
</td></tr>
<tr><td><code id="get_immig_rate_+3A_k">K</code></td>
<td>
<p>A numeric with carrying capacity.</p>
</td></tr>
<tr><td><code id="get_immig_rate_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="get_immig_rate_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_immig_rate_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pedro Neves, Joshua Lambert
</p>


<h3>References</h3>

<p>Valente, Luis M., Rampal S. Etienne, and Albert B. Phillimore.
&quot;The effects of island ontogeny on species diversity and phylogeny.&quot;
Proceedings of the Royal Society of London B: Biological Sciences 281.1784 (2014): 20133227.
</p>


<h3>See Also</h3>

<p>Other rate calculations: 
<code><a href="#topic+DAISIE_plot_area">DAISIE_plot_area</a>()</code>,
<code><a href="#topic+get_ana_rate">get_ana_rate</a>()</code>,
<code><a href="#topic+get_ext_rate">get_ext_rate</a>()</code>,
<code><a href="#topic+island_area_vector">island_area_vector</a>()</code>,
<code><a href="#topic+island_area">island_area</a>()</code>,
<code><a href="#topic+update_max_rates">update_max_rates</a>()</code>,
<code><a href="#topic+update_rates">update_rates</a>()</code>
</p>

<hr>
<h2 id='get_trans_rate'>Calculate transition rate</h2><span id='topic+get_trans_rate'></span>

<h3>Description</h3>

<p>Internal function.
Calculates the transition rate given the current number of
immigrant species and the per capita rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_trans_rate(trait_pars, island_spec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_trans_rate_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on mainland
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_trans_rate_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
</table>

<hr>
<h2 id='integral_peak'>Computes integral of a very peaked function, modified from the
SADISA package</h2><span id='topic+integral_peak'></span>

<h3>Description</h3>

<p>computes the logarithm of the integral of exp(logfun) from 0
to Inf under the following assumptions:
</p>

<ul>
<li><p>&quot;exp(logfun)&quot; has a single, sharply peaked maximum
</p>
</li>
<li><p>&quot;exp(logfun)&quot; is increasing to the left of the peak and
decreasing to the right of the peak
</p>
</li>
<li><p>&quot;exp(logfun)&quot; can be zero or positive at zero
</p>
</li>
<li><p>&quot;exp(logfun)&quot; tends to zero at infinity
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>integral_peak(
  logfun,
  xx = seq(-20, 20, 2),
  xcutoff = 2,
  ymaxthreshold = 1e-12,
  pars1,
  pars2,
  brts,
  stac,
  missnumspec,
  methode,
  abstolint,
  reltolint,
  verbose,
  pick,
  par_mean,
  par_sd,
  par_upper_bound
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integral_peak_+3A_logfun">logfun</code></td>
<td>
<p>the logarithm of the function to integrate</p>
</td></tr>
<tr><td><code id="integral_peak_+3A_xx">xx</code></td>
<td>
<p>the initial set of points on which to evaluate the function</p>
</td></tr>
<tr><td><code id="integral_peak_+3A_xcutoff">xcutoff</code></td>
<td>
<p>when the maximum has been found among the xx, this parameter
sets the width of the interval to find the maximum in</p>
</td></tr>
<tr><td><code id="integral_peak_+3A_ymaxthreshold">ymaxthreshold</code></td>
<td>
<p>sets the deviation allowed in finding the maximum
among the xx</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the result of the integration
</p>


<h3>References</h3>

<p>Haegeman, B. &amp; R.S. Etienne (2017). A general sampling formula
for community structure data. Methods in Ecology &amp; Evolution 8: 1506-1519.
https://doi.org/10.1111/2041-210X.12807
</p>

<hr>
<h2 id='island_area'>Function to describe changes in area through time.</h2><span id='topic+island_area'></span>

<h3>Description</h3>

<p>Function to describe changes in area through time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>island_area(timeval, total_time, area_pars, peak, island_ontogeny, sea_level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="island_area_+3A_timeval">timeval</code></td>
<td>
<p>Numeric defining current time of simulation.</p>
</td></tr>
<tr><td><code id="island_area_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="island_area_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="island_area_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="island_area_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="island_area_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pedro Neves, Joshua Lambert
</p>


<h3>References</h3>

<p>Valente, Luis M., Rampal S. Etienne, and Albert B. Phillimore.
&quot;The effects of island ontogeny on species diversity and phylogeny.&quot;
Proceedings of the Royal Society of London B: Biological
Sciences 281.1784 (2014): 20133227.
</p>


<h3>See Also</h3>

<p>Other rate calculations: 
<code><a href="#topic+DAISIE_plot_area">DAISIE_plot_area</a>()</code>,
<code><a href="#topic+get_ana_rate">get_ana_rate</a>()</code>,
<code><a href="#topic+get_ext_rate">get_ext_rate</a>()</code>,
<code><a href="#topic+get_immig_rate">get_immig_rate</a>()</code>,
<code><a href="#topic+island_area_vector">island_area_vector</a>()</code>,
<code><a href="#topic+update_max_rates">update_max_rates</a>()</code>,
<code><a href="#topic+update_rates">update_rates</a>()</code>
</p>

<hr>
<h2 id='island_area_vector'>Computes island_area, but takes vector as argument (needed by )</h2><span id='topic+island_area_vector'></span>

<h3>Description</h3>

<p>Computes island_area, but takes vector as argument (needed by )
</p>


<h3>Usage</h3>

<pre><code class='language-R'>island_area_vector(
  timeval,
  area_pars,
  island_ontogeny,
  sea_level,
  total_time,
  peak
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="island_area_vector_+3A_timeval">timeval</code></td>
<td>
<p>current time of simulation</p>
</td></tr>
<tr><td><code id="island_area_vector_+3A_area_pars">area_pars</code></td>
<td>
<p>A vector similar to list produced by create_area_pars
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[3]: total island age
</p>
</li></ul>
</td></tr>
<tr><td><code id="island_area_vector_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>a string describing the type of island ontogeny. Can be <code>NULL</code>,
<code>"beta"</code> for a beta function describing area through time.</p>
</td></tr>
<tr><td><code id="island_area_vector_+3A_sea_level">sea_level</code></td>
<td>
<p>a numeric describing the type of sea level.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pedro Neves
</p>


<h3>References</h3>

<p>Valente, Luis M., Rampal S. Etienne, and Albert B. Phillimore.
&quot;The effects of island ontogeny on species diversity and phylogeny.&quot;
Proceedings of the Royal Society of London B: Biological Sciences 281.1784 (2014): 20133227.
</p>


<h3>See Also</h3>

<p>Other rate calculations: 
<code><a href="#topic+DAISIE_plot_area">DAISIE_plot_area</a>()</code>,
<code><a href="#topic+get_ana_rate">get_ana_rate</a>()</code>,
<code><a href="#topic+get_ext_rate">get_ext_rate</a>()</code>,
<code><a href="#topic+get_immig_rate">get_immig_rate</a>()</code>,
<code><a href="#topic+island_area">island_area</a>()</code>,
<code><a href="#topic+update_max_rates">update_max_rates</a>()</code>,
<code><a href="#topic+update_rates">update_rates</a>()</code>
</p>

<hr>
<h2 id='islands_10reps_RAW'>1000 islands in RAW format simulated with the ML parameters of the CR model
for the Galapagos data.</h2><span id='topic+islands_10reps_RAW'></span>

<h3>Description</h3>

<p>Each simulated dataset is an element of the list, which can be called using
e.g. islands_10reps_RAW[[1]] Each of the island replicates is a list in
itself. The first (e.g. islands_10reps_RAW[[x]][[1]]) element of that list
has the following components: <br /> The following elements of the RAW list
each contain information on a single colonist lineage on the island and has
5 components:<br />
<code>$branching_times</code> - island age and stem age of the
population/species in the case of Non-endemic, Non-endemic_MaxAge and
Endemic anagenetic species. For cladogenetic species these should be island
age and branching times of the radiation including the stem age of the
radiation.<br />
<code>$stac</code> - the status of the colonist <br />
* Not_present: 0 <br />
* Non_endemic_MaxAge: 1 <br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_endemic: 4 <br />
<code>$stt_table</code> - Species-through-time table for
the descendants of the mainland species (nI - number of non-endemic species;
nA - number of anagenetic species, nC - number of cladogenetic species)<br />
<code>$missing_species</code> - number of island species that were not sampled for
particular clade (only applicable for endemic clades) <br />
</p>


<h3>Format</h3>

<p>A list with 10 items.
</p>


<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a>()</code>, <code><a href="#topic+DAISIE_plot_sims">DAISIE_plot_sims</a></code>
</p>

<hr>
<h2 id='islands_1type_1000reps'>1000 islands in DAISIE format simulated with the ML parameters of the CR
model for the Galapagos data</h2><span id='topic+islands_1type_1000reps'></span>

<h3>Description</h3>

<p>Each simulated dataset is an element of the list, which can be called using
e.g. islands_1type_1000reps[[1]] Each of the island replicates is a list in
itself. The first (e.g. islands_1type_1000reps[[x]][[1]]) element of that
list has the following components: <br />
<code>$island_age</code> - the island age<br />
<code>$not_present</code> - the number of mainland lineages that are not
present on the island <br />
<code>$stt_all</code> - STT table for all species on the
island (nI - number of non-endemic species; nA - number of anagenetic
species, nC - number of cladogenetic species, present - number of
independent colonisations present )<br />
The subsequent elements of the list each contain information on a single
colonist lineage on the island and has 3 components:<br />
<code>$branching_times</code> - island age and stem age of the population/species
in the case of Non-endemic, Non-endemic_MaxAge and Endemic anagenetic
species. For cladogenetic species these should be island age and branching
times of the radiation including the stem age of the radiation.<br />
<code>$stac</code> - the status of the colonist <br />
* Non_endemic_MaxAge: 1 <br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_endemic: 4 <br />
<code>$missing_species</code> - number of island species that were not sampled for
particular clade (only applicable for endemic clades) <br />
</p>


<h3>Format</h3>

<p>A list with 1000 items.
</p>


<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a>()</code>, <code><a href="#topic+DAISIE_plot_sims">DAISIE_plot_sims</a></code>
</p>

<hr>
<h2 id='islands_2types_1000reps'>1000 islands in DAISIE format simulated with the ML parameters of the
CR_lamc_mu_K model for the Galapagos data (2 types of species)</h2><span id='topic+islands_2types_1000reps'></span>

<h3>Description</h3>

<p>Each simulated dataset is an element of the list, which can be called using
e.g. islands_2types_1000reps[[1]] Each of the island replicates is a list in
itself. The first (e.g. islands_2types_1000reps[[x]][[1]]) element of that
list has the following components: <br />
<code>$island_age</code> - the island age<br />
<code>$not_present_type1</code> - the number of mainland lineages of type 1
that are not present on the island <br />
<code>$not_present_type2</code> - the
number of mainland lineages of type 2 that are not present on the island <br />
<code>$stt_all</code> - STT table for all species on the island (nI - number of
non-endemic species; nA - number of anagenetic species, nC - number of
cladogenetic species, present - number of independent colonisations present
)<br />
<code>$stt_stt_type1</code> - STT table for type 1 species on the island (nI
- number of non-endemic species; nA - number of anagenetic species, nC -
number of cladogenetic species, present - number of independent
colonisations present )<br />
<code>$stt_stt_type2</code> - STT table for type 2
species on the island (nI - number of non-endemic species; nA - number of
anagenetic species, nC - number of cladogenetic species, present - number of
independent colonisations present )<br />
The subsequent elements of the list each contain information on a single
colonist lineage on the island and has 4 components:<br />
<code>$branching_times</code> - island age and stem age of the population/species
in the case of Non-endemic, Non-endemic_MaxAge and Endemic anagenetic
species. For cladogenetic species these should be island age and branching
times of the radiation including the stem age of the radiation.<br />
<code>$stac</code> - the status of the colonist <br />
* Non_endemic_MaxAge: 1 <br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_endemic: 4 <br />
<code>$missing_species</code> - number of island species that were not sampled for
particular clade (only applicable for endemic clades) <br />
<code>$type_1or2</code> - whether the colonist belongs to type 1 or type 2 <br />
</p>


<h3>Format</h3>

<p>A list with 1000 items.
</p>


<h3>Source</h3>

<p>Valente, L.M., A.B. Phillimore and R.S. Etienne (2015). Equilibrium
and non-equilibrium dynamics simultaneously operate in the Galapagos
islands. Ecology Letters 18: 844-852.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_sim_cr">DAISIE_sim_cr</a>()</code>, <code><a href="#topic+DAISIE_plot_sims">DAISIE_plot_sims</a></code>
</p>

<hr>
<h2 id='Macaronesia_datalist'>Colonization and branching times of terrestrial avifaunal clades from
Azores, Canary Islands, Cape Verde and Madeira in list format, accepted by
DAISIE_ML and DAISIE_loglik_all</h2><span id='topic+Macaronesia_datalist'></span>

<h3>Description</h3>

<p>A list containing the colonization and branching times of the terrestrial
avifauna in 4 archipelagos: Azores, Canary Islands, Cape Verde and Madeira.
It is an R list object with the 4 main elements corresponding to each of the
archipelagos (e.g. Macaronesia_datalist[[1]] calls the Azores data). Each of
the four elements is then made of several elemants:<br /> <br />
The first element of the list for an archipelago has two components: <br /> <br />
<code>$island_age</code> - the island age <br />
<code>$not_present</code> - the number of
mainland lineages that are not present on the island <br /> <br />
The following elements of the list each contains information on a single colonist lineage
on the island and has 5 components:<br /> <br />
<code>$colonist_name</code> - the name
of the species or clade that colonized the island <br />
<code>$branching_times</code> - island age followed by stem age of the population/species
in the case of Non-endemic, Non-endemic_MaxAge species and Endemic species with no close
relatives on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade including the stem age of the clade. <br /> <br />
* Non_endemic_MaxAge: 1<br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_endemic: 4 <br /> <br />
* Endemic_MaxAge: 5 <br /> <br />
<code>$missing_species</code> - number of island species that were not sampled for
particular clade (only applicable for endemic clades) <br />
<code>$type1or2</code> -
whether the colonist belongs to type 1 or type 2. In this dataset all are
equal to 1. <br />
</p>


<h3>Format</h3>

<p>A list with 4 main elements for each archipelago. Each element has
several sub-elements.
</p>


<h3>Source</h3>

<p>Valente L., Illera J.C, Havenstein K., Pallien T., Etienne R.S., Tiedemann
R. Equilibrium bird species diversity in Atlantic islands. 2017 Current Biology, 27, 1660-1666.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a></code>, <code><a href="#topic+DAISIE_ML">DAISIE_ML</a></code>
</p>

<hr>
<h2 id='NewZealand_birds_datalist'>Colonization and branching times of New Zealand birds.</h2><span id='topic+NewZealand_birds_datalist'></span>

<h3>Description</h3>

<p>A list containing the colonization and branching times of the birds of
New Zealand. Main dataset used in
Valente, Etienne, Garcia-R (2019) Current Biology. Island age 52 Myr and mainland
pool size of 1000 species. <br />
The first element of the list has two
components: <br /> <br />
<code>$island_age</code> - the island age <br />
<code>$not_present</code> - the number of mainland lineages that are not present
on the island <br /> <br />
The following elements of the list each contain
information on a single colonist lineage on the island and has 5
components:<br /> <br />
<code>$colonist_name</code> - the name of the species or clade
that colonized the island <br />
<code>$branching_times</code> - island age followed by stem age of the population/species
in the case of Non-endemic, Non-endemic_MaxAge species and Endemic species with no close
relatives on the island. For endemic clades with more than one species on the island
(cladogenetic clades/ radiations) these should be island age followed by the
branching times of the island clade including the stem age of the clade.<br />
<code>$stac</code> - the status of the colonist <br /> <br />
* Non_endemic_MaxAge: 1 <br />
* Endemic: 2 <br />
* Endemic&amp;Non_Endemic: 3 <br />
* Non_endemic: 4 <br />
* Endemic_MaxAge: 5 or 6 <br /> <br />
<code>$missing_species</code> - number of island species
that were not sampled for particular clade (only applicable for endemic
clades) <br />
<code>$type1or2</code> - whether the colonist belongs to type 1 or
type 2. In this dataset all are equal to 1. <br />
</p>


<h3>Format</h3>

<p>A list with 40 elements, the first of which contains 2 elements and
the following 39 containing 5 components.
</p>


<h3>Source</h3>

<p>Valente L, Etienne RS, Garcia-R JC (2019) Deep Macroevolutionary Impact of
Humans on New Zealand’s
Unique Avifauna. Current Biology, 29, 2563–2569.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a></code>, <code><a href="#topic+DAISIE_ML">DAISIE_ML</a></code>, <code><a href="#topic+DAISIE_SR_ML">DAISIE_SR_ML</a></code>
</p>

<hr>
<h2 id='remove_empty_elements'>Remove superfluous lines in empty simulations</h2><span id='topic+remove_empty_elements'></span>

<h3>Description</h3>

<p>Remove superfluous lines in empty simulations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_empty_elements(sims)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_empty_elements_+3A_sims">sims</code></td>
<td>
<p>List with output of DAISIE_sim</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Output of DAISIE_sim without empty elements
</p>

<hr>
<h2 id='rho'>Gamma distribution density parameterised with mean and standard deviation</h2><span id='topic+rho'></span>

<h3>Description</h3>

<p>Gamma distribution density parameterised with mean and standard deviation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rho(DAISIE_par, DAISIE_dist_pars)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rho_+3A_daisie_par">DAISIE_par</code></td>
<td>
<p>A numeric parameter to evaluate the integral of the
function.</p>
</td></tr>
<tr><td><code id="rho_+3A_daisie_dist_pars">DAISIE_dist_pars</code></td>
<td>
<p>A numeric vector of two elements, first is the mean
and second the standard deviation of the distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric
</p>

<hr>
<h2 id='sample_relaxed_rate'>Samples from distribution when parameter is relaxed</h2><span id='topic+sample_relaxed_rate'></span>

<h3>Description</h3>

<p>Samples from distribution when parameter is relaxed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_relaxed_rate(pars, relaxed_par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_relaxed_rate_+3A_pars">pars</code></td>
<td>
<p>A vector of 5 elements with the model parameters</p>
</td></tr>
<tr><td><code id="sample_relaxed_rate_+3A_relaxed_par">relaxed_par</code></td>
<td>
<p>A string determining which parameter is relaxed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of parameters.
</p>

<hr>
<h2 id='stac_table'>Explanatory table on meaning and use of <code>stac</code> settings</h2><span id='topic+stac_table'></span>

<h3>Description</h3>

<p>A table containing the information regarding the meaning
of the <code>stac</code> codes utilised by DAISIE's ML functions. It is used to
render the &quot;DAISIE <code>stac</code> values&quot; vignette. <br /> <br />
<code>stac</code> stands for &quot;status of the clade&quot; formed by the immigrant. It is
an important part of DAISIE objects that informs the likelihood functions
about the endemicity status and type of data available for each insular
clade. Each colonisation event that has extant species on the island needs to
have a <code>stac</code> value specified. This also has implications in what is
included in the DAISIE object <code>"branching_times"</code> vector, which also
described in this table.
The table is composed of the following columns:
</p>

<ul>
<li><p>$stac: A numeric with each stac code from 1 until 9.
</p>
</li>
<li><p>$Input for DAISIE_dataprep table &quot;Clade_Name&quot;: A character
with the possibilities for input in <a href="#topic+DAISIE_dataprep">DAISIE_dataprep</a>()
of each clade, which are then translated to a numeric <code>stac</code> code as
in <code>$stac</code>.
</p>
</li>
<li><p>$Type of species or clade&quot;: A character
with the plain English explanation of the different possible kinds of
island lineages that can be considered by DAISIE.
</p>
</li>
<li><p>$Input for DAISIE_dataprep table &quot;Branching_times&quot;: A
character with the plain English explanation of what the branching times
vector in the DAISIE object should contain.
</p>
</li>
<li><p>$Colonisation times: A character with the plain English
explanation of what the colonisation time in the branching times vector
of the DAISIE object (first element of the vector) means.
</p>
</li></ul>



<h3>Format</h3>

<p>A table with 9 rows and 5 columns.
</p>

<hr>
<h2 id='transform_gamma_pars'>Transforms mean and standard deviation to shape and scale gamma parameters</h2><span id='topic+transform_gamma_pars'></span>

<h3>Description</h3>

<p>Transforms mean and standard deviation to shape and scale gamma parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transform_gamma_pars(par_mean, par_sd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transform_gamma_pars_+3A_par_mean">par_mean</code></td>
<td>
<p>mean of the relaxed parameter</p>
</td></tr>
<tr><td><code id="transform_gamma_pars_+3A_par_sd">par_sd</code></td>
<td>
<p>standard deviation of the relaxed parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list to shape and scale parameters
</p>

<hr>
<h2 id='update_max_rates'>Calculates the maximum rates for a Gillespie simulation</h2><span id='topic+update_max_rates'></span>

<h3>Description</h3>

<p>Internal function that updates the all the max rates at time t.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_max_rates(
  gam,
  laa,
  lac,
  mu,
  hyper_pars = NULL,
  extcutoff,
  K,
  num_spec,
  num_immigrants,
  mainland_n,
  Amin,
  Amax
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_max_rates_+3A_gam">gam</code></td>
<td>
<p>A numeric with the per capita immigration rate.</p>
</td></tr>
<tr><td><code id="update_max_rates_+3A_laa">laa</code></td>
<td>
<p>A numeric with the per capita anagenesis rate.</p>
</td></tr>
<tr><td><code id="update_max_rates_+3A_lac">lac</code></td>
<td>
<p>A numeric with the per capita cladogenesis rate.</p>
</td></tr>
<tr><td><code id="update_max_rates_+3A_mu">mu</code></td>
<td>
<p>A numeric with the per capita extinction rate.</p>
</td></tr>
<tr><td><code id="update_max_rates_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="update_max_rates_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
<tr><td><code id="update_max_rates_+3A_k">K</code></td>
<td>
<p>A numeric with carrying capacity.</p>
</td></tr>
<tr><td><code id="update_max_rates_+3A_num_spec">num_spec</code></td>
<td>
<p>A numeric with the current number of species.</p>
</td></tr>
<tr><td><code id="update_max_rates_+3A_num_immigrants">num_immigrants</code></td>
<td>
<p>A numeric with the current number of non-endemic
species (a.k.a non-endemic species).</p>
</td></tr>
<tr><td><code id="update_max_rates_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="update_max_rates_+3A_amin">Amin</code></td>
<td>
<p>A numeric value for minimum island area during the simulation.</p>
</td></tr>
<tr><td><code id="update_max_rates_+3A_amax">Amax</code></td>
<td>
<p>A numeric value for maximum island area during the simulation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named list with the updated effective rates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+update_rates">update_rates</a>()</code>
</p>
<p>Other rate calculations: 
<code><a href="#topic+DAISIE_plot_area">DAISIE_plot_area</a>()</code>,
<code><a href="#topic+get_ana_rate">get_ana_rate</a>()</code>,
<code><a href="#topic+get_ext_rate">get_ext_rate</a>()</code>,
<code><a href="#topic+get_immig_rate">get_immig_rate</a>()</code>,
<code><a href="#topic+island_area_vector">island_area_vector</a>()</code>,
<code><a href="#topic+island_area">island_area</a>()</code>,
<code><a href="#topic+update_rates">update_rates</a>()</code>
</p>

<hr>
<h2 id='update_rates'>Calculates algorithm rates</h2><span id='topic+update_rates'></span>

<h3>Description</h3>

<p>Internal function that updates the all the rates and
max extinction horizon at time t.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_rates(
  timeval,
  total_time,
  gam,
  laa,
  lac,
  mu,
  hyper_pars = hyper_pars,
  area_pars = NULL,
  peak = NULL,
  island_ontogeny = NULL,
  sea_level = NULL,
  extcutoff,
  K,
  num_spec,
  num_immigrants,
  mainland_n,
  trait_pars = NULL,
  island_spec = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_rates_+3A_timeval">timeval</code></td>
<td>
<p>Numeric defining current time of simulation.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_total_time">total_time</code></td>
<td>
<p>Numeric defining the length of the simulation in time
units.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_gam">gam</code></td>
<td>
<p>A numeric with the per capita immigration rate.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_laa">laa</code></td>
<td>
<p>A numeric with the per capita anagenesis rate.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_lac">lac</code></td>
<td>
<p>A numeric with the per capita cladogenesis rate.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_mu">mu</code></td>
<td>
<p>A numeric with the per capita extinction rate.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_hyper_pars">hyper_pars</code></td>
<td>
<p>A named list of numeric hyperparameters for the rate
calculations as returned by <code><a href="#topic+create_hyper_pars">create_hyper_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: is d the scaling parameter for exponent for calculating
cladogenesis rate
</p>
</li>
<li><p>[2]: is x the exponent for calculating extinction rate
</p>
</li></ul>
</td></tr>
<tr><td><code id="update_rates_+3A_area_pars">area_pars</code></td>
<td>
<p>A named list containing area and sea level parameters as
created by <code><a href="#topic+create_area_pars">create_area_pars</a>()</code>:
</p>

<ul>
<li><p>[1]: maximum area
</p>
</li>
<li><p>[2]: current area
</p>
</li>
<li><p>[3]: value from 0 to 1 indicating where in the island's history the
peak area is achieved
</p>
</li>
<li><p>[4]: total island age
</p>
</li>
<li><p>[5]: amplitude of area fluctuation from sea level
</p>
</li>
<li><p>[6]: frequency of sine wave of area change from sea level
</p>
</li>
<li><p>[7]: angle of the slope of the island
</p>
</li></ul>
</td></tr>
<tr><td><code id="update_rates_+3A_peak">peak</code></td>
<td>
<p>A numeric value specifying the peakiness (or shaprness) of the
ontogeny curve. Higher values imply peakier ontogeny. This value is
internally calculated by <code><a href="#topic+calc_peak">calc_peak</a>()</code> given the area at the
present and the <code>area_pars</code>.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_island_ontogeny">island_ontogeny</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code>,
<code><a href="#topic+DAISIE_ML_CS">DAISIE_ML_CS</a></code> and plotting a string describing the type of
island ontogeny. Can be <code>"const"</code>, <code>"beta"</code> for a beta function
describing area through time. <br /> In all other functions a
numeric describing the type of island ontogeny. Can be <code>0</code> for
constant, <code>1</code> for a beta function describing area through time. In ML
functions <code>island_ontogeny = NA</code> assumes constant ontogeny. Time
dependent estimation is not yet available as development is still ongoing.
Will return an error if called in that case.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_sea_level">sea_level</code></td>
<td>
<p>In <code><a href="#topic+DAISIE_sim_time_dep">DAISIE_sim_time_dep</a>()</code> and plotting a
string describing the type of sea level. Can be <code>"const"</code> or
<code>"sine"</code> for a sine function describing area through time.
<br /> In all other functions a numeric describing the type of sea level. Can
be <code>0</code> for constant, <code>1</code> for a sine function describing area
through time.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_extcutoff">extcutoff</code></td>
<td>
<p>A numeric with the cutoff for the the maximum extinction
rate preventing it from being too large and slowing down simulation.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_k">K</code></td>
<td>
<p>A numeric with carrying capacity.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_num_spec">num_spec</code></td>
<td>
<p>A numeric with the current number of species.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_num_immigrants">num_immigrants</code></td>
<td>
<p>A numeric with the current number of non-endemic
species (a.k.a non-endemic species).</p>
</td></tr>
<tr><td><code id="update_rates_+3A_mainland_n">mainland_n</code></td>
<td>
<p>A numeric stating the number of mainland species, that
is the number of species that can potentially colonize the island.
If using a clade-specific diversity dependence, this value is set to 1.
If using an island-wide diversity dependence, this value is set to the
number of mainland species.</p>
</td></tr>
<tr><td><code id="update_rates_+3A_trait_pars">trait_pars</code></td>
<td>
<p>A named list containing diversification rates considering
two trait states created by <code><a href="#topic+create_trait_pars">create_trait_pars</a></code>:
</p>

<ul>
<li><p>[1]:A numeric with the per capita transition rate with state1
</p>
</li>
<li><p>[2]:A numeric with the per capita immigration rate with state2
</p>
</li>
<li><p>[3]:A numeric with the per capita extinction rate with state2
</p>
</li>
<li><p>[4]:A numeric with the per capita anagenesis rate with state2
</p>
</li>
<li><p>[5]:A numeric with the per capita cladogenesis rate with state2
</p>
</li>
<li><p>[6]:A numeric with the per capita transition rate with state2
</p>
</li>
<li><p>[7]:A numeric with the number of species with trait state 2 on
mainland
</p>
</li></ul>
</td></tr>
<tr><td><code id="update_rates_+3A_island_spec">island_spec</code></td>
<td>
<p>Matrix with current state of simulation containing number
of species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named list with the updated effective rates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+update_max_rates">update_max_rates</a>()</code>
</p>
<p>Other rate calculations: 
<code><a href="#topic+DAISIE_plot_area">DAISIE_plot_area</a>()</code>,
<code><a href="#topic+get_ana_rate">get_ana_rate</a>()</code>,
<code><a href="#topic+get_ext_rate">get_ext_rate</a>()</code>,
<code><a href="#topic+get_immig_rate">get_immig_rate</a>()</code>,
<code><a href="#topic+island_area_vector">island_area_vector</a>()</code>,
<code><a href="#topic+island_area">island_area</a>()</code>,
<code><a href="#topic+update_max_rates">update_max_rates</a>()</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
