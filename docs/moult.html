<!DOCTYPE html><html><head><title>Help for package moult</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {moult}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#moult-package'><p>Methods for Estimating Start and Duration of Moult in Birds</p></a></li>
<li><a href='#confint.moult'><p>Conficence Intervals for Moult Parameters</p></a></li>
<li><a href='#date2days'><p>Convert date to day count</p></a></li>
<li><a href='#dfbeta.moult'><p>Influence Statistics for Moult Parameters</p></a></li>
<li><a href='#moult'><p>Models to analyse data of moult in birds</p></a></li>
<li><a href='#ms2pfmg'><p>Convert moult scores to proportion of feather mass grown</p></a></li>
<li><a href='#predict.moult'><p>Predict method for moult models</p></a></li>
<li><a href='#sanderlings'><p>Sanderling Moult Data</p></a></li>
<li><a href='#weavers'><p>Weaver Moult Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.3.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-08-29</td>
</tr>
<tr>
<td>Title:</td>
<td>Models for Analysing Moult in Birds</td>
</tr>
<tr>
<td>Author:</td>
<td>Birgit Erni &lt;birgit.erni@uct.ac.za&gt;. Based on models 
	developed by Underhill and Zucchini (1988, 1990).</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Birgit Erni &lt;birgit.erni@uct.ac.za&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>Formula, Matrix</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to estimate start and duration of moult from moult 
             data, based on models developed in Underhill 
             and Zucchini (1988, 1990). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-29 13:35:45 UTC; birgit</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-30 09:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='moult-package'>Methods for Estimating Start and Duration of Moult in Birds</h2><span id='topic+moult-package'></span>

<h3>Description</h3>

<p>Functions for estimating the duration and mean start date
for avian moult data, based on maximum likelihood.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> moult</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.0.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2016-05-03</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Birgit Erni</p>


<h3>References</h3>

<p>Erni, B., Bonnevie, B. T., Oschadleus, H.-D., Altwegg,
R. and Underhill, L. G. (2013) moult: An R package to analyze
moult in birds. Journal of Statistical Software, <b>52</b>(8), 1&ndash;23.
<a href="https://doi.org/10.18637/jss.v052.i08">doi:10.18637/jss.v052.i08</a>
</p>
<p>Underhill, L. G. and Zucchini, W. (1988) A model for avian
primary moult. Ibis <b>130</b>, 358&ndash;372.
</p>
<p>Underhill, L. G. and Zucchini, W. and Summers, R. W. (1990) A model
for avian primary moult-data types based on migration strategies and
an example using the Redshank <em>Tringa totanus</em>. Ibis <b>132</b>,
118&ndash;123.</p>

<hr>
<h2 id='confint.moult'>Conficence Intervals for Moult Parameters</h2><span id='topic+confint.moult'></span>

<h3>Description</h3>

<p>Calculate normal theory and bootstrap percentile intervals for moult parameters. Also returns bootstrap covariance matrix and standard error estimates for parameters. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'moult'
confint(object, parm, level = 0.95, ..., B = 1000, add.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.moult_+3A_object">object</code></td>
<td>
<p>model output returned by call to moult.</p>
</td></tr>
<tr><td><code id="confint.moult_+3A_parm">parm</code></td>
<td>
<p>currently ignored (should be a vector of numbers or names, specifying for which parameters to calculate confidence intervals).</p>
</td></tr>
<tr><td><code id="confint.moult_+3A_level">level</code></td>
<td>
<p>confidence level.</p>
</td></tr>
<tr><td><code id="confint.moult_+3A_...">...</code></td>
<td>
<p>additional arguments for plot.</p>
</td></tr>
<tr><td><code id="confint.moult_+3A_b">B</code></td>
<td>
<p>integer: number of bootstrap samples to take.</p>
</td></tr>
<tr><td><code id="confint.moult_+3A_add.plot">add.plot</code></td>
<td>
<p>logical: should scatterplot of bootstrapped parameters be added?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>End date is calculated as <em>mean start date + duration</em>. Half-date is calculated as <em>mean start date + 0.5 * duration</em>.
</p>


<h3>Value</h3>

<p>Returns a list with elements:
</p>
<table>
<tr><td><code>bootstrap.distribution</code></td>
<td>
<p><code class="reqn">B \times p</code> matrix of bootstrapped parameters.</p>
</td></tr>
<tr><td><code>bootstrap.percentile.ci</code></td>
<td>
<p>Table of bootstrap percentile intervals for all parameters. In addition, confidence intervals for half-date and end date (see details) are given.</p>
</td></tr>
<tr><td><code>bootstrap.vcov</code></td>
<td>
<p>Bootstrap estimates for variances and covariances between all parameters.</p>
</td></tr>
<tr><td><code>bootstrap.SE</code></td>
<td>
<p>Bootstrap estimates of parameter standard errors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Birgit Erni <a href="mailto:birgit.erni@uct.ac.za">birgit.erni@uct.ac.za</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sanderlings)
m2 &lt;- moult(MIndex ~ Day, data = sanderlings)
## Not run: confint(m2, B = 100) # increase B for better precision
</code></pre>

<hr>
<h2 id='date2days'>Convert date to day count</h2><span id='topic+date2days'></span>

<h3>Description</h3>

<p>Convert date mm/dd/yyyy to days since the 1st of
startmonth, starting with days = 1 for the 1st day of startmonth.</p>


<h3>Usage</h3>

<pre><code class='language-R'>date2days(date, dateformat, startmonth)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="date2days_+3A_date">date</code></td>
<td>
<p>date character string with format as specified in dateformat</p>
</td></tr>
<tr><td><code id="date2days_+3A_dateformat">dateformat</code></td>
<td>
<p>string specifying format of date, e.g. &quot;mm/dd/yyyy&quot;,
&quot;yyyy-dd-mm&quot;, &quot;dd&ndash;mm&quot; etc.</p>
</td></tr>
<tr><td><code id="date2days_+3A_startmonth">startmonth</code></td>
<td>
<p>integer between 1 and 12 indicating month from which
to start counting.</p>
</td></tr></table>


<h3>Value</h3>

<p>Returns an integer = number of days since 1st of startmonth,
starting with 1 = 1st of startmonth. </p>


<h3>Author(s)</h3>

<p>Bo T. Bonnevie</p>


<h3>Examples</h3>

<pre><code class='language-R'>date2days("01/01/2010", "dd/mm/yyyy", 1)
date2days("01-01-2010", "dd-mm-yyyy", 2)
date2days("2008/06/01", "yyyy/mm/dd", 8)    # year has no effect
</code></pre>

<hr>
<h2 id='dfbeta.moult'>Influence Statistics for Moult Parameters</h2><span id='topic+dfbeta.moult'></span>

<h3>Description</h3>

<p>Calculates dfbeta (change in coefficients) and dfbetas (scaled by standard error) for moult parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'moult'
dfbeta(model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dfbeta.moult_+3A_model">model</code></td>
<td>
<p>a model object returned by <code><a href="#topic+moult">moult</a></code>.</p>
</td></tr>
<tr><td><code id="dfbeta.moult_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both dfbeta (absolute change in coefficients) and dfbetas (change in coefficients scaled by standard error of coefficient) are returned. 
</p>
<p style="text-align: center;"><code class="reqn">dfbetas_i = \frac{\hat{b} - \hat{b}_i}{SE(\hat{b}_i}),</code>
</p>

<p>where the <code class="reqn">\hat{b}_i</code> estimate is obtained with observation <code class="reqn">i</code> removed. 
</p>
<p>In the optional plot of dfbetas, cutoff lines at <code class="reqn">\pm 2 / \sqrt{n}</code> are added. These are the limits used in linear regression models, but there is no reason that the same limits are valid for moult models. Therefore these cutoff lines can only be used as very rough guidelines.
</p>


<h3>Value</h3>

<table>
<tr><td><code>dfbeta</code></td>
<td>
<p><code class="reqn">n \times p</code> matrix with absolute change in coefficients when observation <code class="reqn">i</code> is deleted. </p>
</td></tr>
<tr><td><code>dfbetas</code></td>
<td>
<p><code class="reqn">n \times p</code> matrix with scaled change in coefficients when observation <code class="reqn">i</code> is deleted.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Birgit Erni <a href="mailto:birgit.erni@uct.ac.za">birgit.erni@uct.ac.za</a></p>


<h3>References</h3>

<p>Fox, J.D. (2020). <em>Regression Diagnostics: an Introduction.</em> 2nd edition. SAGE Publications.</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+dfbeta.lm">dfbeta.lm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sanderlings)
m2 &lt;- moult(MIndex ~ Day, data = sanderlings) 
## Not run: dfbeta(m2)
</code></pre>

<hr>
<h2 id='moult'>Models to analyse data of moult in birds</h2><span id='topic+moult'></span><span id='topic+print.moult'></span><span id='topic+summary.moult'></span><span id='topic+logLik.moult'></span><span id='topic+moult_alternative'></span>

<h3>Description</h3>

<p>Estimate duration and mean start date of moult from 
moult score data by maximum likelihood.  Covariates 
to model duration and start of moult are possible. </p>


<h3>Usage</h3>

<pre><code class='language-R'>moult(formula, data, start = NULL, type = 2, method = "BFGS", fixed = NULL, 
             fixed.val = NULL, prec = 0.02)
            
moult_alternative(formula, data, start = NULL, type = 2, method = "BFGS", 
                  fixed = NULL, fixed.val = NULL, prec = 0.02)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moult_+3A_formula">formula</code></td>
<td>
<p>symbolic description of the model, see details.</p>
</td></tr>
<tr><td><code id="moult_+3A_start">start</code></td>
<td>
<p>starting values for parameters.</p>
</td></tr>
<tr><td><code id="moult_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model. 
If not found in data, the variables are taken from the environment
from which <code>moult</code> was called.</p>
</td></tr>
<tr><td><code id="moult_+3A_type">type</code></td>
<td>
<p>integer (one of 1,2,3,4,5) referring to type of moult data
and consequently model to be fitted (see details).</p>
</td></tr>
<tr><td><code id="moult_+3A_method">method</code></td>
<td>
<p>optimisation algorithm, passed to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="moult_+3A_fixed">fixed</code></td>
<td>
<p>logical vector specifying which parameter values to fix during optimization.</p>
</td></tr>
<tr><td><code id="moult_+3A_fixed.val">fixed.val</code></td>
<td>
<p>numeric vector with values for the fixed parameters.</p>
</td></tr>
<tr><td><code id="moult_+3A_prec">prec</code></td>
<td>
<p>numeric, measurement precision of moult index (proportion of feather mass grown), 
default = 0.02.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>formula</code> is specified in 5 parts: 
</p>
<p><code>moult.index ~ days | x1 + x2 | y1 + y2 | z1 + z2</code>
</p>
<p>where <code>moult.index</code> is a numerical vector with values between 0
and 1, <code>days</code> is a vector with corresponding day numbers on which
moult indeces were observed.  The next three parts contain explanatory
variables for modelling duration, mean start date and standard
deviation in start date, respectively.  If no explanatory variables are
wanted for duration, say, this can be specified by leaving a blank
between the first and second vertical lines, or equivalently,
inserting a 1 between the vertical lines (which means all durations
will be assumed equal).  Similarly for mean start date and standard
deviation. The minimum formula must contain <code>moult.index ~ days</code>,
which will assume the same duration, mean start date and standard
deviation for all individuals.   
</p>
<p><code>type</code> refers to the type of moult data available (see Underhill and
Zucchini (1998) and Underhill, Zucchini and Summers (1990)). 
</p>

<dl>
<dt>type = 1</dt><dd><p>sample is representative of entire population (not yet
moulting, in moult, and birds which have completed moult).  For type 1
data, any value between 0 and 1 (&gt; 0 and &lt; 1) can be used as the moult
index for birds in active moult.  The value used does not matter, only
the fact that they are in moult.</p>
</dd>
<dt>type = 2</dt><dd><p>(default) sample is representative of entire population
(not yet moulting, in moult, and birds which have completed
moult).  Moult scores are required.</p>
</dd>
<dt>type = 3</dt><dd><p>sample is representative only of birds in
moult. Individuals with moult scores 0 or 1 are ignored.</p>
</dd> 
<dt>type = 4</dt><dd><p>sample is representative only of birds in moult and those
that have completed moult.  Individuals with moult scores 0 are ignored.</p>
</dd> 
<dt>type = 5</dt><dd><p>sample is representative only of birds that have not
started moult or that are in moult.  Individuals with moult scores 1
are ignored.</p>
</dd>
</dl>

<p>To <em>fix parameters</em> <code>fixed</code> will be a logical vector, e.g. <code>fixed = c(F, F, T), 
fixed.val = 3.5</code> will fix the standard deviation in start date to exp(3.5) and only estimate 
the remaining two parameters. 
</p>
<p><code>moult</code> uses the <span class="rlang"><b>R</b></span> function <code><a href="stats.html#topic+optim">optim</a></code> to minimise the negative log-likelihood. 
</p>
<p>Note: The standard deviation parameters are estimated on the log-scale. Thus
the corresponding elements in the covariance matrix are also on the
log-scale. Starting values for the standard deviation should also be supplied on 
the log-scale. Standard errors for the standard deviation parameters are on
the scale of the standard deviation (in days), estimated using the delta
method.
</p>
<p><code>moult_alternative</code> offers a different parameterization (still in testing!): 
the <em>duration of moult</em> parameter is as before, but instead of start of moult, 
the parameter estimated is the <em>halfway date</em>, i.e. the date at which 50% of 
individuals have completed 50% of moult. The standard deviation parameter now is 
for the standard deviation between indiviudals in reaching 50% of moult. Start and 
end of moult can be derived as halfway date - 0.5 x duration, + 0.5 x duration, 
respectively. This alternative parameterization attempts to reduce the problem of 
strong negative correlation between the previous parameters start of moult and 
duration, and gives a more robust estimate for timing of moult (Les Underhill, 
pers. comm., Jackson 2018).
</p>


<h3>Value</h3>

<table>
<tr><td><code>coefficients</code></td>
<td>
<p>parameter estimates split up into duration, mean
start date and standard deviation of start date.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>log-likelihood at parameter estimates.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>variance covariance matrix for paramter estimates (duration, mean start date, SD(start date)).</p>
</td></tr>
<tr><td><code>standard.errors</code></td>
<td>
<p>vector of standard errors for parameter
estimates, obtained from diagonal elements of vcov, see details (duration, mean start date, SD(start date)).</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type of data assumed, see details.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>vector of residuals: observed - fitted moult index.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>a vector of fitted values (moult scores).</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>residual degrees of freedom for fitted model.</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>duration formula, mean formula, full formula.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>model matrix with covariates.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>observed response (moult index) values.</p>
</td></tr>
<tr><td><code>Day</code></td>
<td>
<p>observed observation days.</p>
</td></tr>
<tr><td><code>mean.formula</code></td>
<td>
<p>model formula for mean start date.</p>
</td></tr>
<tr><td><code>duration.formula</code></td>
<td>
<p>model formula for duration of moult.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>model formula for mean start and duration of moult.</p>
</td></tr>
<tr><td><code>sd.formula</code></td>
<td>
<p>grouping variable used to estimate standard
deviations in mean start dates, different for each group.</p>
</td></tr>
<tr><td><code>optim</code></td>
<td>
<p>object returned by call to <code><a href="stats.html#topic+optim">optim</a></code>, which minimises
negative log-likelihood.</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>logical value indicating whether algorithm has
converged or not.</p>
</td></tr>
<tr><td><code>convergence.value</code></td>
<td>
<p>value for convergence returned by optim,
see <code>optim</code> for details.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Birgit Erni <a href="mailto:birgit.erni@uct.ac.za">birgit.erni@uct.ac.za</a></p>


<h3>References</h3>

<p>Erni, B., Bonnevie, B. T., Oschadleus, H.-D., Altwegg,
R. and Underhill, L. G. (2013) moult: An R package to analyze
moult in birds. <em>Journal of Statistical Software</em>, <b>52</b>(8), 1&ndash;23.
<a href="https://doi.org/10.18637/jss.v052.i08">doi:10.18637/jss.v052.i08</a>
</p>
<p>Jackson, C. 2018. <em>The moult and migration strategies of Lesser Sand Plover, 
Greater Sand Plover and Terek Sandpiper.</em> PhD Thesis, University of Cape Town, 
South Africa. 
</p>
<p>Underhill, L. G. and Zucchini, W. (1988) A model for avian
primary moult. <em>Ibis</em> <b>130</b>, 358&ndash;372.
</p>
<p>Underhill, L. G. and Zucchini, W. and Summers, R. W. (1990) A model
for avian primary moult-data types based on migration strategies and
an example using the Redshank <em>Tringa totanus</em>. <em>Ibis</em> <b>132</b>,
118&ndash;123. </p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.moult">predict.moult</a></code>, <code><a href="#topic+ms2pfmg">ms2pfmg</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(sanderlings)

m2 &lt;- moult(MIndex ~ Day, data = sanderlings) 
summary(m2)
</code></pre>

<hr>
<h2 id='ms2pfmg'>Convert moult scores to proportion of feather mass grown</h2><span id='topic+ms2pfmg'></span>

<h3>Description</h3>

<p>Convert moult scores obtained for single feathers into 
overall proportion of feather mass grown.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ms2pfmg(ms, fm, split = "")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ms2pfmg_+3A_ms">ms</code></td>
<td>
<p>vector of moult scores.  Each moult score should be a character string of one individual's feather moult scores, each between 0 and 5, e.g. &quot;555444000&quot; if nine primaries are of interest. Half steps are allowed, in which case the separator between individual scores can be specified in <code>split</code>, e.g. &quot;5 5 5 4.5 4 3.5 0.5 0 0&quot;, in which case <code>split = " "</code>.</p>
</td></tr> 
<tr><td><code id="ms2pfmg_+3A_fm">fm</code></td>
<td>
<p>vector of relative feather mass, corresponding to each
feather in ms.</p>
</td></tr>
<tr><td><code id="ms2pfmg_+3A_split">split</code></td>
<td>
<p>character used to separate individual feather moult scores. Default is no space / separator between scores.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ms</code> will usually be a vector of 9 or 10 primary feather scores,
but single feathers can be given, in which case <code>fm</code>
is ignored.  The method used here assumes that a moult score of 1 for 
any feather corresponds to 1/8th of the feather grown, 2 
corresponds to 3/8th = 0.375, etc..  The proportion of feather mass 
grown is then a weighted sum over all feathers, with weights 
equal to the relative weight (compared to the total weight) of each 
feather (Underhill and Zucchini 1988).</p>


<h3>Value</h3>

<p><code>ms2pfmg</code> returns a vector (same length as <code>ms</code>) of values between 0 and 1: proportion of total feather mass grown.</p>


<h3>Author(s)</h3>

<p>Bo T. Bonnevie, Birgit Erni</p>


<h3>References</h3>

<p>Underhill, L. G. and Zucchini, W. (1988) A model for avian primary 
moult. Ibis <b>130</b>, 358&ndash;372.</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.moult">predict.moult</a></code>, <code><a href="#topic+moult">moult</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## relative primary feather mass of the 10 primary feathers 
## (as proportion of total feather mass) for Sanderlings
fm.sand &lt;- c(0.0385, 0.0458, 0.0544, 0.0680, 0.0827, 0.1019,
             0.1199, 0.1417, 0.1604, 0.1867)   

ms2pfmg(3, 0.2)              # single feather
ms2pfmg(3, 1)
ms2pfmg("5555500000", fm.sand)

## all feathers weighted equally
ms2pfmg("54321", c(1,1,1,1,1))

## with half scores
ms2pfmg("5 4.5 3 2.5 1", c(1,1,1,1,1), split = " ")

## moult scores for more than 1 bird 
ms2pfmg(c("5,4.5,3,2.5,1", "5,3.5,3,2.5,2.5"), c(1,1,1,1,1), split = ",")
</code></pre>

<hr>
<h2 id='predict.moult'>Predict method for moult models</h2><span id='topic+predict.moult'></span><span id='topic+coef.moult'></span>

<h3>Description</h3>

<p>Predict either the proportion of birds in a certain moult 
stage (as defined in intervals) on a specified day, the average 
moult score on a specified day, or start and/or duration of moult 
for given covariate patterns</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'moult'
predict(object, newdata, predict.type = "prob", intervals = 0.1, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.moult_+3A_object">object</code></td>
<td>
<p>moult model objects</p>
</td></tr>
<tr><td><code id="predict.moult_+3A_newdata">newdata</code></td>
<td>
<p>optional dataframe with explanatory variables for which to 
make predictions.  The first column must contain the days 
(as used when fitting) for which to make predictions. </p>
</td></tr>
<tr><td><code id="predict.moult_+3A_predict.type">predict.type</code></td>
<td>
<p>specifies form of predictions, see details.</p>
</td></tr>
<tr><td><code id="predict.moult_+3A_intervals">intervals</code></td>
<td>
<p>length of moult categories for
which probabilities/proportions should be calculated.  The default (= 0.1) 
will calculate the probability that a bird will fall in this moult category
on the specified day for each of the following categories: 0, (0, 0.1), 
[0.1, 0.2), [0.2, 0.3), ..., [0.9, 1.0), 1.</p>
</td></tr>
<tr><td><code id="predict.moult_+3A_...">...</code></td>
<td>
<p>other arguments passed to the predict method</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>predict.type</code> has the following options: 
</p>

<dl>
<dt>&quot;response&quot;</dt><dd><p>the average moult index (proportion of
feather mass grown) for each of the days specified.</p>
</dd>
<dt>&quot;prob&quot;</dt><dd><p>default, the proportion of birds in
each of the moult categories as defined by intervals
is predicted. </p>
</dd>
<dt>&quot;duration&quot;</dt><dd><p>predicts the duration of moult
for the covariate combinations defined in <code>newdata</code>,
with standard errors. If <code>newdata</code> is not supplied, returns duration of baseline covariate set.</p>
</dd>
<dt>&quot;start&quot;</dt><dd><p>predicts the mean start date of moult
for the covariate combinations defined in <code>newdata</code>,
with standard errors. If <code>newdata</code> is not supplied, returns mean start date of baseline covariate set. </p>
</dd>
<dt>&quot;both&quot;</dt><dd><p>predicts both mean start date of moult and 
duration of moult for the covariate combinations defined in 
<code>newdata</code>, with standard errors. Also, covariance of duration and start date estimates is given.</p>
</dd>
</dl>



<h3>Value</h3>

<p>If <code>newdata</code> is missing, the expected moult scores at the observed days are returned. 
</p>
<p>If <code>predict.type = "response"</code>, the expected moult scores at the specified days are returned.
</p>
<p>If <code>predict.type = "prob"</code> a matrix of predicted probabilities for being in each of the moult categories defined by intervals.
</p>
<p>If <code>predict.type</code> equals &quot;start&quot; or &quot;duration&quot; or &quot;both&quot;, the corresponding estimates (with standard errors) for each of the covariate patterns are returned.
</p>


<h3>Author(s)</h3>

<p><a href="mailto:birgit.erni@uct.ac.za">birgit.erni@uct.ac.za</a></p>


<h3>References</h3>

<p>Erni, B., Bonnevie, B. T., Oschadleus, H.-D., Altwegg,
R. and Underhill, L. G. (2013) moult: An R package to analyze
moult in birds. Journal of Statistical Software, <b>52</b>(8), 1&ndash;23.
<a href="https://www.jstatsoft.org/v52/i08/">https://www.jstatsoft.org/v52/i08/</a>
</p>
<p>Underhill, L. G. and Zucchini, W. (1988) A model for avian primary 
moult. <em>Ibis</em> <b>130</b>, 358&ndash;372.
</p>
<p>Underhill, L. G. and Zucchini, W. and Summers, R. W. (1990) A
model for avian primary moult-data types based on migration
strategies and an example using the Redshank <em>Tringa
totanus</em>. <em>Ibis</em> <b>132</b>, 118&ndash;123. </p>


<h3>See Also</h3>

<p><code><a href="#topic+moult">moult</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(weavers)

## convert moult scores to PFMG (proportion feather mass grown)
mscores &lt;- substr(weavers$Moult, 1, 9)
feather.mass &lt;- c(10.4, 10.8, 11.5, 12.8, 14.4, 15.6, 16.3, 15.7, 15.7)
weavers$pfmg &lt;- ms2pfmg(mscores, feather.mass)

## day of year starting 1 August
weavers$day &lt;- date2days(weavers$RDate, dateformat = "yyyy-mm-dd", startmonth = 8)
weavers$ssex &lt;- ifelse(weavers$Sex == 1 | weavers$Sex == 3, "male",
  ifelse(weavers$Sex == 2 | weavers$Sex == 4, "female", NA))
  
mmf &lt;- moult(pfmg ~ day | ssex | ssex, data = weavers, type = 3)
summary(mmf)

## predict duration and start of moult (then both) for males and females
ssex &lt;- c("male", "female")
day &lt;- 150

(p1 &lt;- predict.moult(mmf, newdata = data.frame(day, ssex), predict.type = "duration"))
(p2 &lt;- predict.moult(mmf, newdata = data.frame(day, ssex), predict.type = "start"))
(p3 &lt;- predict.moult(mmf, newdata = data.frame(day, ssex), predict.type = "both"))

</code></pre>

<hr>
<h2 id='sanderlings'>Sanderling Moult Data
</h2><span id='topic+sanderlings'></span>

<h3>Description</h3>

<p>This data set gives moult indices for 164 Sanderlings trapped on 11 days.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sanderlings)</code></pre>


<h3>Format</h3>

<p>A data frame with 164 observations on the following 2 variables.
</p>

<dl>
<dt><code>Day</code></dt><dd><p>a numeric vector of day bird was measured, 1 = 1 July</p>
</dd>
<dt><code>MIndex</code></dt><dd><p>a numeric vector of moult indices, 0 = bird has not started moult, 1 = bird has completed moult </p>
</dd>
</dl>



<h3>Details</h3>

<p>This data set gives moult indices for 164 Sanderlings trapped on 11 days in the southwestern Cape, South Africa, between October 1978 and April 1979. Day 1 = 1 July). Moult indices are a transformation of moult scores so that moult index increases linearly with time. See Underhill and Zucchini (1988) for details.
</p>


<h3>Source</h3>

<p>Underhill and Zucchini (1998)</p>


<h3>References</h3>

<p>Underhill, L. G. and Zucchini, W. (1988) A model for avian
primary moult. Ibis <b>130</b>, 358&ndash;372.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sanderlings)

## fit model of type 1 to data
m1 &lt;- moult(MIndex ~ Day, data = sanderlings, type = 1)               
summary(m1)

## model of type 2 (default)
m2 &lt;- moult(MIndex ~ Day, data = sanderlings)                     
summary(m2)

## model of type 3
m3 &lt;- moult(MIndex ~ Day, data = sanderlings, type = 3)              
summary(m3)

## find intercept and slope of mean moult trajectory line
uza &lt;- - coef(m2, "mean") / coef(m2, "duration")    
uzb &lt;- 1 / coef(m2, "duration")

## extract how many birds observed on each of the days
nn &lt;- as.numeric(table(sanderlings$Day))        
## extract days of observations
day &lt;- unique(sanderlings$Day)                                            

## probabilities of moult stages
## Table 6 in Underhill and Zucchini 1988
p1 &lt;- predict(m2, newdata = data.frame(day))       
p1$M * nn

## Table 7 in Underhill and Zucchini 1988
days2 &lt;- seq(70, 310, by = 10)
p2 &lt;- predict(m2, newdata = data.frame(days2))
p2$M * 100                                  

p3 &lt;- predict(m3, newdata = data.frame(day))      
p3

## Comparison with regression models
MInd &lt;- sanderlings$MIndex[sanderlings$MIndex &gt; 0 &amp;
                           sanderlings$MIndex &lt; 1]
MTime &lt;- sanderlings$Day[sanderlings$MIndex &gt; 0 &amp;
                         sanderlings$MIndex &lt; 1]

lm1 &lt;- lm(MTime ~ MInd)                           
lm1.int &lt;- coef(lm1)[1]
lm1.slope &lt;- coef(lm1)[2]

lm2 &lt;- lm(MInd ~ MTime)

## regression of Index on Time
plot(MTime, MInd, pch = 19, cex=0.7)

## regression of Time on Index: gives better estimates 
## for mean start day and duration of moult	    
abline(lm2, col = "blue", lwd = 2) 
abline(-lm1.int / lm1.slope, 1 / lm1.slope, col = "orange", lwd = 2) 
abline(uza, uzb, col = "red", lty = 2, lwd = 2)
</code></pre>

<hr>
<h2 id='weavers'>Weaver Moult Data</h2><span id='topic+weavers'></span>

<h3>Description</h3>

<p>Weaver moult data from the Western Cape, South Africa</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(weavers)</code></pre>


<h3>Format</h3>

<p>A data frame with 7543 observations on the following 4 variables.
</p>

<dl>
<dt><code>RDate</code></dt><dd><p>a character vector with dates on which
individuals were caught, format: yyyy-mm-dd.</p>
</dd>
<dt><code>Sex</code></dt><dd><p>a numeric vector, 0 = unknown, 1 = male, 2 =
female, 3 = possibly male, 4 = possibly female.</p>
</dd>
<dt><code>Year</code></dt><dd><p>year in which individual was caught.</p>
</dd>
<dt><code>Moult</code></dt><dd><p>a character vector with moult scores for 
individual primary feathers, either nine or ten, starting with
innermost primary feather.  0: old feather, 5: new feather, 1 to 4,
feathers at various stages of growth in between.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Oschadleus, D. (2005). Patterns of primary moult in weavers. PhD Thesis. University of Cape Town.
</p>
<p>SAFRING, URL: <a href="https://safring.birdmap.africa/">https://safring.birdmap.africa/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(weavers)

mscores &lt;- substr(weavers$Moult, 1, 9)

## convert moult scores to proportion of feather mass grown
feather.mass &lt;- c(10.4, 10.8, 11.5, 12.8, 14.4, 15.6, 16.3, 15.7, 15.7)
weavers$pfmg &lt;- ms2pfmg(mscores, feather.mass)

## days since 1 August
weavers$day &lt;- date2days(weavers$RDate, dateformat = "yyyy-mm-dd", startmonth = 8)
ssex &lt;- ifelse(weavers$Sex == 1 | weavers$Sex == 3, "male", 
  ifelse(weavers$Sex == 2 | weavers$Sex == 4, "female", NA))
weavers$ssex &lt;- as.factor(ssex)

## moult model with duration and mean start date depending on sex
mmf &lt;- moult(pfmg ~ day | ssex | ssex, data = weavers, type = 3)
summary(mmf)

## predict duration and start of moult (then both) for males and females
ssex &lt;- c("male", "female") 
day &lt;- 150
(p1 &lt;- predict.moult(mmf, newdata = data.frame(day, ssex), predict.type = "duration"))
(p2 &lt;- predict.moult(mmf, newdata = data.frame(day, ssex), predict.type = "start"))
(p3 &lt;- predict.moult(mmf, newdata = data.frame(day, ssex), predict.type = "both"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
