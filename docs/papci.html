<!DOCTYPE html><html><head><title>Help for package papci</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {papci}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#agreement'><p>agreement</p></a></li>
<li><a href='#papciUI'><p>papciUI</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Prevalence Adjusted PPV Confidence Interval</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-09-13</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cui Guo &lt;cuguo@foundationmedicine.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Positive predictive value (PPV) defined as the conditional probability of clinical trial assay (CTA) being positive given Companion diagnostic device (CDx) being positive is a key performance parameter for evaluating the clinical validity utility of a companion diagnostic test in clinical bridging studies. When bridging study patients are enrolled based on CTA assay results, Binomial-based confidence intervals (CI) may are not appropriate for PPV CI estimation. Bootstrap CIs which are not restricted by the Binomial assumption may be used for PPV CI estimation only when PPV is not 100%. Bootstrap CI is not valid when PPV is 100% and becomes a single value of [1, 1]. We proposed a risk ratio-based method for constructing CI for PPV. By simulation we illustrated that the coverage probability of the proposed CI is close to the nominal value even when PPV is high and negative percent agreement (NPA) is close to 100%. There is a lack of R package for PPV CI calculation. we developed a publicly available R package along with this shiny app to implement the proposed approach and some other existing methods.</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, tidyverse, binom, PropCIs, ratesci, Hmisc, shiny,
shinythemes, readxl, DT, stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-13 15:58:21 UTC; cuguo</td>
</tr>
<tr>
<td>Author:</td>
<td>Cui Guo [aut, cre, ctb],
  Kate (Yueyi) Li [aut, ctb],
  Lei Yang [aut, ctb],
  Chang Xu [aut, ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-14 07:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='agreement'>agreement
</h2><span id='topic+agreement'></span>

<h3>Description</h3>

<p>This function is used to evaluate the agreements of two clinical tests with binary outcomes. It provides four statistical metrics, including positive percent agreement (PPA), negative percent agreement (NPA), positive predictive value (PPV), negative predictive value (NPV) and their corresponding confidence intervals (CIs) in different methods.
Some methods available in this package provide non-binomial-based CIs, which are more appropriate for CIs estimations of PPV and NPV when samples are not randomly selected from IU population or PPV=100%.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agreement(x, y, m, n, tb, baseline, comparator, prev, conf.level,
alternative, methods_pa, methods_pv, times, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agreement_+3A_x">x</code></td>
<td>
<p>Number of positive calls by both baseline and comparator tests. x is a non-negative integer.</p>
</td></tr>
<tr><td><code id="agreement_+3A_y">y</code></td>
<td>
<p>Number of observations called negative at baseline but positive by comparator test. y is a non-negative integer.</p>
</td></tr>
<tr><td><code id="agreement_+3A_m">m</code></td>
<td>
<p>Number of positive calls at baseline. m is a non-negative integer.</p>
</td></tr>
<tr><td><code id="agreement_+3A_n">n</code></td>
<td>
<p>Number of negative calls at baseline. n is a non-negative integer.</p>
</td></tr>
<tr><td><code id="agreement_+3A_tb">tb</code></td>
<td>
<p>A 2-by-2 contingency table between baseline and comparator testing results. Baseline at column.</p>
</td></tr>
<tr><td><code id="agreement_+3A_baseline">baseline</code></td>
<td>
<p>A vector of baseline testing results. 1 for call, 0 for non-call. The two vectors, <code>baseline</code> and <code>comparator</code>, are paired non-missing results and their length should be the same; ignored otherwise.</p>
</td></tr>
<tr><td><code id="agreement_+3A_comparator">comparator</code></td>
<td>
<p>A vector of comparator testing results. 1 for call, 0 for non-call. Same requirements as for <code>baseline</code>.</p>
</td></tr>
<tr><td><code id="agreement_+3A_prev">prev</code></td>
<td>
<p>Disease prevalence based on baseline test in IU population. prev=Pr(baseline negative)</p>
</td></tr>
<tr><td><code id="agreement_+3A_conf.level">conf.level</code></td>
<td>
<p>The level of confidence to be used in the confidence interval.</p>
</td></tr>
<tr><td><code id="agreement_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis, must be one of &quot;two.sided&quot; (default), &quot;greater&quot; or &quot;less&quot;. </p>
</td></tr>
<tr><td><code id="agreement_+3A_methods_pa">methods_pa</code></td>
<td>
<p>Which method to use to construct the CIs for PPA and NPA. Any combination of <code>c("exact", "ac", "asymptotic", "wilson", "prop.test", "bayes", "logit", "cloglog", "probit")</code> is allowed. Default is <code>"all"</code>.</p>
</td></tr>
<tr><td><code id="agreement_+3A_methods_pv">methods_pv</code></td>
<td>
<p>Which method to use to construct the interval for PPV and NPV. Any combination of <code>c("Koopman","Katz","Neother","Gart_Nam","Bootstrap","Plug-In")</code> is allowed. Default is <code>"all"</code>.</p>
</td></tr>
<tr><td><code id="agreement_+3A_times">times</code></td>
<td>
<p>Times of bootstraps if <code>"Bootstrap"</code> method is specified to construct the interval for PPV. Default is <code>"1000"</code>.</p>
</td></tr>
<tr><td><code id="agreement_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="binom.html#topic+binom.confint">binom.confint</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The definitions of PPA, NPA, PPV and NPA in this package are
</p>

<ul>
<li> <p><code class="reqn">PPA= Pr(comparator+|baseline+)</code>, <code class="reqn">NPA= Pr(comparator-|baseline-)</code>
</p>
</li>
<li> <p><code class="reqn">PPV= Pr(baseline+|comparator+)</code>, <code class="reqn">NPV= Pr(baseline-|comparator-)</code>
</p>
</li></ul>

<p>The point estimations are <code class="reqn">x/m</code> for PPA and and <code class="reqn">(n-y)/n</code> for NPA. By ignoring enrollment biases, PPV and NPV are estimated as <code class="reqn">x/(x+y)</code> and <code class="reqn">(n-y)/(m+n-x-y)</code>, respectively. When samples are not enrolled randomly or selected based on baseline results, PPV and NPV are obtained by the Bayes theorem and not binomially distributed. They are defined as
</p>
<p style="text-align: center;"><code class="reqn">PPV = prev*PPA / [ prev*PPA + (1-prev)*(1-NPA) ]</code>
</p>

<p style="text-align: center;"><code class="reqn">NPV = (1-prev)*NPA / [ (1-prev)*NPA + prev*(1-PPA) ]</code>
</p>

<p>Nine methods are allowed for constructing the confidence interval(s) for PPA and NPA referring to <code><a href="binom.html#topic+binom.confint">binom.confint</a></code>. Six methods are allowed for constructing the confidence interval(s) for PPV based on the risk-ratio <code class="reqn">R1=(1-NPA)/PPA</code>.
</p>

<ul>
<li><p>Koopman (1984) - derived the <code class="reqn">(1-\alpha)</code>100% CI for <code class="reqn">R1</code> by using Chi-squared method.
</p>
</li>
<li><p>Katz et al.(1978) - derived the <code class="reqn">(1-\alpha)</code>100% CI for <code class="reqn">R1</code> by assuming that the <code class="reqn">log(R1)</code> is approximately normally distributed.

</p>
</li>
<li><p>Noether (1957) - developed the <code class="reqn">(1-\alpha)</code>100% CI for <code class="reqn">R1</code> using an explicit solution.
</p>
</li>
<li><p>Gart and Nam (1988) - improved Koopman's method by correcting the asymptotic skewness.
</p>
</li>
<li><p>Bootstrap - derived the risk ratio CI using Bootstrap method from multiple random samples.
</p>
</li>
<li><p>Plug-In - derived the 95% CI for PPA and NPA as (PPA_l,PPA_u) and (NPA_l,NPA_u). Applied all four combinations (i.e., (PPA_l, NPA_l); (PPA_l, NPA_u); (PPA_u, NPA_l); (PPA_u, NPA_u)) into above PPV formulas by Bayes theorem, and the minimum and maximum values are determined as the lower and upper bound of 95% CIs of PPV.
</p>
</li></ul>

<p>Given the CIs for the risk-ratio <code class="reqn">R1</code>, denoted as [<code class="reqn">R1_l</code>, <code class="reqn">R1_u</code>], the CIs for PPV can be directly contained by
</p>
<p style="text-align: center;"><code class="reqn"> [p/(p + (1-p)*R1_u),  p/(p + (1-p)*R1_l)]</code>
</p>

<p>CIs of NPV can be derived in the same way.
</p>


<h3>Value</h3>

<p>A <code>list</code> of <code>data.frame</code> containing the estimated agreements (ppa, npa, ppv, npv) and the lower and upper bounds of the confidence interval for all the methods in <code>methods_pa</code> or <code>methods_pv</code>.
</p>


<h3>Author(s)</h3>

<p>Lei Yang, Cui Guo, Kate Li, Chang Xu (cuguo@foundationmedicine.com) </p>


<h3>References</h3>

<p>1. Gart John J and Nam Jun-mo (1988). Approximate interval estimation of the ratio of binomial parameters: a review and corrections for skewness, <em>Biometrics</em>, 323-338.
</p>
<p>2. Katz DJSM, Baptista J, Azen SP and Pike MC (1978). Obtaining confidence intervals for the risk ratio in cohort studies, <em>Biometrics</em>, 469-474.
</p>
<p>3. Koopman PAR (1984). Confidence intervals for the ratio of two binomial proportions, <em>Biometrics</em>, 513-517.
</p>
<p>4. Noether Gottfried E (1957). Two confidence intervals for the ratio of two probabilities and some measures of effectiveness, <em>Journal of the American Statistical Association</em>, <b>52</b>: 36-45.
</p>


<h3>See Also</h3>

<p><code><a href="binom.html#topic+binom.confint">binom.confint</a></code> for different methods to obtain a confidence interval on the binomial probability like PPA and NPA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>agreement(x = 90, y = 10, m = 100, n = 80, prev = 0.3, times=1000)
agreement(x = 84, y = 0, m = 84, n = 97, prev = 0.096, times=1000)
</code></pre>

<hr>
<h2 id='papciUI'>papciUI
</h2><span id='topic+papciUI'></span>

<h3>Description</h3>

<p>This function will automatically launch the PA interactive user interface in a web browser.
The user interface can also be accessed by https://kate-yueyi-li.shinyapps.io/shiny . Neither R nor any packages are required in this online version.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>papciUI()
</code></pre>


<h3>Details</h3>

<p>The definitions of PPA, NPA, PPV and NPA in this package are
</p>

<ul>
<li> <p><code class="reqn">PPA= Pr(comparator+|baseline+)</code>, <code class="reqn">NPA= Pr(comparator-|baseline-)</code>
</p>
</li>
<li> <p><code class="reqn">PPV= Pr(baseline+|comparator+)</code>, <code class="reqn">NPV= Pr(baseline-|comparator-)</code>
</p>
</li></ul>

<p>The point estimations are <code class="reqn">x/m</code> for PPA and and <code class="reqn">(n-y)/n</code> for NPA. By ignoring enrollment biases, PPV and NPV are estimated as <code class="reqn">x/(x+y)</code> and <code class="reqn">(n-y)/(m+n-x-y)</code>, respectively. When samples are not enrolled randomly or selected based on baseline results, PPV and NPV are obtained by the Bayes theorem and not binomially distributed. They are defined as
</p>
<p style="text-align: center;"><code class="reqn">PPV = prev*PPA / [ prev*PPA + (1-prev)*(1-NPA) ]</code>
</p>

<p style="text-align: center;"><code class="reqn">NPV = (1-prev)*NPA / [ (1-prev)*NPA + prev*(1-PPA) ]</code>
</p>

<p>Nine methods are allowed for constructing the confidence interval(s) for PPA and NPA referring to <code><a href="binom.html#topic+binom.confint">binom.confint</a></code>. Six methods are allowed for constructing the confidence interval(s) for PPV based on the risk-ratio <code class="reqn">R1=(1-NPA)/PPA</code>.
</p>

<ul>
<li><p>Koopman (1984) - derived the <code class="reqn">(1-\alpha)</code>100% CI for <code class="reqn">R1</code> by using Chi-squared method.
</p>
</li>
<li><p>Katz et al.(1978) - derived the <code class="reqn">(1-\alpha)</code>100% CI for <code class="reqn">R1</code> by assuming that the <code class="reqn">log(R1)</code> is approximately normally distributed.

</p>
</li>
<li><p>Noether (1957) - developed the <code class="reqn">(1-\alpha)</code>100% CI for <code class="reqn">R1</code> using an explicit solution.
</p>
</li>
<li><p>Gart and Nam (1988) - improved Koopman's method by correcting the asymptotic skewness.
</p>
</li>
<li><p>Bootstrap - derived the risk ratio CI using Bootstrap method from multiple random samples.
</p>
</li>
<li><p>Plug-In - derived the 95% CI for PPA and NPA as (PPA_l,PPA_u) and (NPA_l,NPA_u). Applied all four combinations (i.e., (PPA_l, NPA_l); (PPA_l, NPA_u); (PPA_u, NPA_l); (PPA_u, NPA_u)) into above PPV formulas by Bayes theorem, and the minimum and maximum values are determined as the lower and upper bound of 95% CIs of PPV.
</p>
</li></ul>

<p>Given the CIs for the risk-ratio <code class="reqn">R1</code>, denoted as [<code class="reqn">R1_l</code>, <code class="reqn">R1_u</code>], the CIs for PPV can be directly contained by
</p>
<p style="text-align: center;"><code class="reqn"> [p/(p + (1-p)*R1_u),  p/(p + (1-p)*R1_l)]</code>
</p>

<p>CIs of NPV can be derived in the same way.
</p>


<h3>Value</h3>

<p>A <code>list</code> of <code>data.frame</code> containing the estimated agreements (ppa, npa, ppv, npv) and the lower and upper bounds of the confidence interval for all the methods in <code>methods_pa</code> or <code>methods_pv</code>.
</p>


<h3>Author(s)</h3>

<p>Lei Yang, Cui Guo, Kate Li, Chang Xu (cuguo@foundationmedicine.com) </p>


<h3>References</h3>

<p>1. Gart John J and Nam Jun-mo (1988). Approximate interval estimation of the ratio of binomial parameters: a review and corrections for skewness, <em>Biometrics</em>, 323-338.
</p>
<p>2. Katz DJSM, Baptista J, Azen SP and Pike MC (1978). Obtaining confidence intervals for the risk ratio in cohort studies, <em>Biometrics</em>, 469-474.
</p>
<p>3. Koopman PAR (1984). Confidence intervals for the ratio of two binomial proportions, <em>Biometrics</em>, 513-517.
</p>
<p>4. Noether Gottfried E (1957). Two confidence intervals for the ratio of two probabilities and some measures of effectiveness, <em>Journal of the American Statistical Association</em>, <b>52</b>: 36-45.
</p>


<h3>See Also</h3>

<p><code><a href="binom.html#topic+binom.confint">binom.confint</a></code> for different methods to obtain a confidence interval on the binomial probability like PPA and NPA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>agreement(x = 90, y = 10, m = 100, n = 80, prev = 0.3)
agreement(x = 84, y = 0, m = 84, n = 97, prev = 0.096)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
