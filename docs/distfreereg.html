<!DOCTYPE html><html lang="en"><head><title>Help for package distfreereg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {distfreereg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#distfreereg-package'>
<p>Distribution-Free Goodness-of-Fit Testing for Regression</p></a></li>
<li><a href='#coef.distfreereg'>
<p>Extract Estimated Parameters from <code>distfreereg</code> Objects</p></a></li>
<li><a href='#compare'>
<p>Compare the simulated statistic distribution with the observed statistic distribution used in distribution-free parametric regression testing</p></a></li>
<li><a href='#confint.distfreereg'>
<p>Calculate Confidence Intervals with a <code>distfreereg</code> Object</p></a></li>
<li><a href='#distfreereg'>
<p>Distribution-Free Parametric Regression Testing</p></a></li>
<li><a href='#fitted.distfreereg'>
<p>Extract Fitted Values from <code>distfreereg</code> Objects</p></a></li>
<li><a href='#formula.distfreereg'>
<p>Extract Formulas from <code>distfreereg</code> Objects</p></a></li>
<li><a href='#ks.test.compare'>
<p>Formally Compare Observed and Simulated Statistics</p></a></li>
<li><a href='#plot.compare'>
<p>Summary and Diagnostic Plots for <code>compare</code> Objects</p></a></li>
<li><a href='#plot.distfreereg'>
<p>Summary and Diagnostic Plots for <code>distfreereg</code> Objects</p></a></li>
<li><a href='#predict.distfreereg'>
<p>Generate Predicted Values from <code>distfreereg</code> Objects</p></a></li>
<li><a href='#print.distfreereg'>
<p>Printing <code>distfreereg</code> Objects</p></a></li>
<li><a href='#rejection'>
<p>Compute Rejection Rates of a Distribution-Free Test</p></a></li>
<li><a href='#residuals.distfreereg'>
<p>Extract Residuals from <code>distfreereg</code> Objects</p></a></li>
<li><a href='#update.distfreereg'>
<p>Update <code>distfreereg</code> Objects</p></a></li>
<li><a href='#vcov.distfreereg'>
<p>Calculate Covariance Matrices from <code>distfreereg</code> Objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Distribution-Free Goodness-of-Fit Testing for Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>clue, methods, numDeriv</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, Matrix, mvtnorm, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-11-12</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jesse Miller &lt;mill9116@umn.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements distribution-free goodness-of-fit regression testing for
  the mean structure of parametric models introduced in Khmaladze (2021)
  &lt;<a href="https://doi.org/10.1007%2Fs10463-021-00786-3">doi:10.1007/s10463-021-00786-3</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-14 22:40:13 UTC; Jesse</td>
</tr>
<tr>
<td>Author:</td>
<td>Jesse Miller [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-18 23:50:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='distfreereg-package'>
Distribution-Free Goodness-of-Fit Testing for Regression
</h2><span id='topic+distfreereg-package'></span>

<h3>Description</h3>

<p>Implements distribution-free goodness-of-fit regression testing for
  the mean structure of parametric models introduced in Khmaladze (2021)
  &lt;doi:10.1007/s10463-021-00786-3&gt;.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> distfreereg</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Distribution-Free Goodness-of-Fit Testing for Regression</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 4.4)</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> clue, methods, numDeriv</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> knitr, Matrix, mvtnorm, rmarkdown</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-11-12</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> person(given = "Jesse",
                    family = "Miller",
                    role = c("aut", "cre"),
                    email = "mill9116@umn.edu")</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Jesse Miller &lt;mill9116@umn.edu&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Implements distribution-free goodness-of-fit regression testing for
  the mean structure of parametric models introduced in Khmaladze (2021)
  &lt;doi:10.1007/s10463-021-00786-3&gt;.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Jesse Miller [aut, cre]</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
coef.distfreereg        Extract Estimated Parameters from 'distfreereg'
                        Objects
compare                 Compare the simulated statistic distribution
                        with the observed statistic distribution used
                        in distribution-free parametric regression
                        testing
confint.distfreereg     Calculate Confidence Intervals with a
                        'distfreereg' Object
distfreereg             Distribution-Free Parametric Regression Testing
distfreereg-package     Distribution-Free Goodness-of-Fit Testing for
                        Regression
fitted.distfreereg      Extract Fitted Values from 'distfreereg'
                        Objects
formula.distfreereg     Extract Formulas from 'distfreereg' Objects
ks.test.compare         Formally Compare Observed and Simulated
                        Statistics
plot.compare            Summary and Diagnostic Plots for 'compare'
                        Objects
plot.distfreereg        Summary and Diagnostic Plots for 'distfreereg'
                        Objects
predict.distfreereg     Generate Predicted Values from 'distfreereg'
                        Objects
print.distfreereg       Printing 'distfreereg' Objects
rejection               Compute Rejection Rates of a Distribution-Free
                        Test
residuals.distfreereg   Extract Residuals from 'distfreereg' Objects
update.distfreereg      Update 'distfreereg' Objects
vcov.distfreereg        Calculate Covariance Matrices from
                        'distfreereg' Objects
</pre>

<p>Further information is available in the following vignettes:<br /><br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>v1_introduction</code> </td><td style="text-align: left;"> An Introduction to the `distfreereg` Package (source)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>v2_compare</code> </td><td style="text-align: left;"> Comparing Distributions with the `distfreereg` Package (source)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>v3_plotting</code> </td><td style="text-align: left;"> Plotting with the `distfreereg` Package (source)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>v4_parameter-estimation</code> </td><td style="text-align: left;"> Parameter Estimation (source)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>v5_advanced-options</code> </td><td style="text-align: left;"> Advanced Options for `distfreereg` Package (source)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Jesse Miller [aut, cre]
</p>
<p>Maintainer: Jesse Miller &lt;mill9116@umn.edu&gt;
</p>

<hr>
<h2 id='coef.distfreereg'>
Extract Estimated Parameters from <code>distfreereg</code> Objects
</h2><span id='topic+coef.distfreereg'></span>

<h3>Description</h3>

<p>This is a <code><a href="stats.html#topic+coef">coef</a></code> method for objects of class <code>distfreereg</code>. It extracts the estimated parameters from a model in a <code>distfreereg</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'distfreereg'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.distfreereg_+3A_object">object</code></td>
<td>

<p>Object of class <code>distfreereg</code>.
</p>
</td></tr>
<tr><td><code id="coef.distfreereg_+3A_...">...</code></td>
<td>

<p>Additional parameters passed to or from other methods. Currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of estimated model parameters.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>, <code><a href="#topic+vcov.distfreereg">vcov.distfreereg</a></code>, <code><a href="#topic+confint.distfreereg">confint.distfreereg</a></code>
</p>

<hr>
<h2 id='compare'>
Compare the simulated statistic distribution with the observed statistic distribution used in distribution-free parametric regression testing
</h2><span id='topic+compare'></span>

<h3>Description</h3>

<p>Simulate response data repeatedly with <code>true_mean</code> as the mean and <code>true_covariance</code> as the covariance structure, each time running <code><a href="#topic+distfreereg">distfreereg</a></code> on the simulated data. The observed statistics and p-values are saved, as are the simulated statistics from the first replication.
</p>
<p>See the <a href="../doc/v2_compare.html">Comparing Distributions with the <code>distfreereg</code> Package</a> vignette for an introduction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	compare(true_mean, true_method = NULL, true_method_args = NULL, true_covariance,
	true_X = NULL, true_data = NULL, theta, n = NULL, reps = 1e3, prog = reps/10,
	err_dist_fun = rmvnorm, err_dist_args = NULL, keep = NULL, manual = NULL,
	update_args = NULL, global_override = NULL, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compare_+3A_true_mean">true_mean</code></td>
<td>

<p>Object specifying the mean structure of the true model. It is used to generate the true values of <code>Y</code> that are passed internally to <code><a href="#topic+distfreereg">distfreereg</a></code>.
</p>
</td></tr>
<tr><td><code id="compare_+3A_true_method">true_method</code></td>
<td>

<p>Character vector of length one; specifies the method to use to create a model. Valid options are &quot;<code>lm</code>&quot; and &quot;<code>nls</code>&quot;.
</p>
</td></tr>
<tr><td><code id="compare_+3A_true_method_args">true_method_args</code></td>
<td>

<p>Optional list; values are passed to the function specified by <code>true_method</code>.
</p>
</td></tr>
<tr><td><code id="compare_+3A_true_covariance">true_covariance</code></td>
<td>

<p>Named list; specifies the covariance structures of the true error distribution in the format described in the documentation for the <code>covariance</code> argument of <code><a href="#topic+distfreereg">distfreereg</a></code>.
</p>
</td></tr>
<tr><td><code id="compare_+3A_true_x">true_X</code>, <code id="compare_+3A_true_data">true_data</code></td>
<td>

<p>Optional numeric matrix or data frame, respectively; specifies the covariate values for the true model. <code>true_X</code> is used when the model is specified by a function that has an <code>X</code> or <code>x</code> argument, and the <code>data</code> argument is used with formulas or other objects with a formula method.
</p>
</td></tr>
<tr><td><code id="compare_+3A_theta">theta</code></td>
<td>

<p>Numeric vector; used as the (true) parameter values for the model with mean function <code>true_mean</code>.
</p>
</td></tr>
<tr><td><code id="compare_+3A_n">n</code></td>
<td>

<p>Optional integer; indicates how long each simulated data vector should be. Required only when no covariate values are specified for either the true or test mean. Silently converted to integer if numeric.
</p>
</td></tr>
<tr><td><code id="compare_+3A_reps">reps</code></td>
<td>

<p>Integer; specifies number of replications. Silently converted to integer if numeric.
</p>
</td></tr>
<tr><td><code id="compare_+3A_prog">prog</code></td>
<td>

<p>Integer or <code>Inf</code>; if finite, a progress message is given when the current repetition is a multiple of <code>prog</code>. Default value is <code>reps/10</code>, unless <code>reps</code> is less than 10, in which case the default is changed to <code>1</code>. If <code>Inf</code>, no prgress messages are given. Silently converted to integer if finite numeric.
</p>
</td></tr>
<tr><td><code id="compare_+3A_err_dist_fun">err_dist_fun</code></td>
<td>

<p>Function; specifies the function to be used to simulate errors. See details.
</p>
</td></tr>
<tr><td><code id="compare_+3A_err_dist_args">err_dist_args</code></td>
<td>

<p>Optional list; specifies additional named arguments to pass to <code>err_dist_fun</code>.
</p>
</td></tr>
<tr><td><code id="compare_+3A_keep">keep</code></td>
<td>

<p>A vector of integers, or the character string &quot;<code>all</code>&quot;. If not <code>NULL</code>, then the output of each replication's call to <code><a href="#topic+distfreereg">distfreereg</a></code> is included in the output if its repetition number is included in <code>keep</code>. Using <code>keep = "all"</code> is equivalent to <code>keep = 1:reps</code>.
</p>
</td></tr>
<tr><td><code id="compare_+3A_manual">manual</code></td>
<td>

<p>Optional function; applied to the <code>distfreereg</code> object created in each iteration, whose output is saved in the list <code>manual</code> in the output.
</p>
</td></tr>
<tr><td><code id="compare_+3A_update_args">update_args</code></td>
<td>

<p>Optional named list; specifies arguments to pass to <code><a href="#topic+update.distfreereg">update.distfreereg</a></code>.
</p>
</td></tr>
<tr><td><code id="compare_+3A_global_override">global_override</code></td>
<td>

<p>Optional named list; specifies arguments to pass to the <code>override</code> argument of <code><a href="#topic+distfreereg">distfreereg</a></code> on each call to that function.
</p>
</td></tr>
<tr><td><code id="compare_+3A_...">...</code></td>
<td>

<p>Additional arguments passed to <code><a href="#topic+distfreereg">distfreereg</a></code>. See details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function allows the user to explore the asymptotic behavior of the distributions involved in the test conducted by <code><a href="#topic+distfreereg">distfreereg</a></code>. If the sample size is sufficiently large, and assuming that the true covariance matrix of the errors is known, then the observed and simulated statistics have nearly the same distribution. How large the sample size must be depends on the details of the situation. This function can be used to determine how large the sample size must be to obtain approximately equal distributions, and to estimate the power of the test against a specific alternative.
</p>
<p>The user specifies a particular true model, comprising a mean function <code>true_mean</code> and an error generating function <code>err_dist_fun</code>, to generate the data. The user also specifies a test model, comprising a mean function <code>test_mean</code> and a covariance structure specified by <code>covariance</code>, to pass to <code><a href="#topic+distfreereg">distfreereg</a></code> to test. For each repetition, <code>compare</code> simulates data using <code>true_mean</code> as the mean function and <code>err_dist_fun</code> to generate the errors. The covariance matrix of the errors is specified using <code>true_covariance</code>. (See below for more details.) This simulated data is passed as <code>Y</code> (or as part of <code>data</code>) to <code><a href="#topic+distfreereg">distfreereg</a></code>.
</p>
<p>The <code>true_covariance</code> argument specifies the covariance structure that is available to <code>err_dist_fun</code> for generating errors. The needs of <code>err_dist_fun</code> can vary (for example, the default function uses <code>SqrtSigma</code> to generate multivariate normal errors), so any one of the matrices <code>Sigma</code>, <code>SqrtSigma</code>, <code>P</code>, and <code>Q</code> (defined in the documentation of <code><a href="#topic+distfreereg">distfreereg</a></code>) can be specified. Any matrix needed by <code>err_dist_fun</code> is calculated automatically if not supplied.
</p>
<p>The value of <code>err_dist_fun</code> must be a function whose output is a numeric matrix with <code>n</code> rows and <code>reps</code> columns. Each column is used as the vector of errors in one repetition. The error function's arguments can include the special values <code>n</code>, <code>reps</code>, <code>Sigma</code>, <code>SqrtSigma</code>, <code>P</code>, and <code>Q</code>. These arguments are automatically assigned their corresponding values from the values passed to <code>compare</code>. For example, the default value <code>rmvnorm</code> uses <code>SqrtSigma</code> to generate multivariate normal values with mean 0 and covariance <code>Sigma</code>.
</p>
<p>The argument <code>keep</code> is useful for diagnosing problems, but caution should be used lest a very large object be created. It is often sufficient to save the <code>distfreereg</code> objects from only the first few replications.
</p>
<p>For more specialized needs, the <code>manual</code> argument allows the calculation and saving of objects during each repetition. For example, using <code>manual = function(x) residuals(x)</code> will save the (raw) residuals from each repetition.
</p>
<p>The first repetition creates a <code>distfreereg</code> object. During each subsequent repetition, this object is passed to <code><a href="#topic+update.distfreereg">update.distfreereg</a></code> to create a new object. The <code>update_args</code> argument can be used to modify this call.
</p>
<p>If necessary, <code>global_override</code> can be used to pass an <code>override</code> argument to <code><a href="#topic+distfreereg">distfreereg</a></code> in each repetition. For example, using <code>gobal_override = list(theta_hat = theta)</code> forces the estimated parameter vector used in the test in each call to be the true parameter vector <code>theta</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>compare</code> with the following components:
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>Y_mean</code></td>
<td>
<p>The vector of mean values for the simulated responses.</p>
</td></tr>
<tr><td><code>errors</code></td>
<td>
<p>The matrix whose columns contain the errors used for the corresponding repetitions.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>Supplied vector of parameter values.</p>
</td></tr>
<tr><td><code>true_mean</code></td>
<td>
<p>Supplied object specifying the true mean function.</p>
</td></tr>
<tr><td><code>true_covariance</code></td>
<td>
<p>List containing element(s) that specify the true covariance structure.</p>
</td></tr>
<tr><td><code>true_X</code></td>
<td>
<p>Supplied matrix of true covariate values.</p>
</td></tr>
<tr><td><code>true_data</code></td>
<td>
<p>Supplied data frame of true covariate values.</p>
</td></tr>
<tr><td><code>test_mean</code></td>
<td>
<p>Supplied object specifying the mean function being tested.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>List containing element(s) that specify the test covariance structure.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>Supplied matrix of test covariate values.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>Supplied data frame of test covariate values.</p>
</td></tr>
<tr><td><code>observed_stats</code></td>
<td>
<p>The observed statistics collected in each repetition.</p>
</td></tr>
<tr><td><code>mcsim_stats</code></td>
<td>
<p>The simulated statistics from the first repetition. (They are the same for each repetition, because <code>compare</code> uses <code><a href="#topic+update.distfreereg">update.distfreereg</a></code>.)</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>The p-values for the observed statistics.</p>
</td></tr>
<tr><td><code>dfrs</code></td>
<td>
<p>A list containing the outputs of <code><a href="#topic+distfreereg">distfreereg</a></code> for repetitions specified in <code>keep</code>. Included when <code>keep</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>manual</code></td>
<td>
<p>A list containing the results of the function specified by the argument <code>manual</code>. Included when <code>manual</code> argument is not <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Some of the processing of the elements of <code>true_covariance</code> is analogous to the processing of <code>covariance</code> by <code><a href="#topic+distfreereg">distfreereg</a></code>. Any values of <code>solve_tol</code> and <code>symmetric</code> specified in <code><a href="#topic+distfreereg">distfreereg</a></code>'s <code>control</code> argument are used by <code>compare</code> to similar effect in processing <code>true_covariance</code>.
</p>
<p>The presence of <code>call</code> in the value allows a <code>compare</code> object to be passed to <code><a href="stats.html#topic+update">update</a></code>.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>, <code><a href="#topic+rejection">rejection</a></code>, <code><a href="#topic+plot.compare">plot.compare</a></code>, <code><a href="#topic+ks.test.compare">ks.test.compare</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20240201)
n &lt;- 100
func &lt;- function(X, theta) theta[1] + theta[2]*X
Sig &lt;- rWishart(1, df = n, Sigma = diag(n))[,,1]
theta &lt;- c(2,5)
X &lt;- matrix(rexp(n, rate = 1))
# In practice, 'reps' should be much larger
cdfr &lt;- compare(true_mean = func, true_X = X, true_covariance = list(Sigma = Sig),
                test_mean = func, X = X, covariance = list(Sigma = Sig),
                reps = 10, prog = Inf, theta = theta, theta_init = rep(1, length(theta)))

cdfr$p
</code></pre>

<hr>
<h2 id='confint.distfreereg'>
Calculate Confidence Intervals with a <code>distfreereg</code> Object
</h2><span id='topic+confint.distfreereg'></span>

<h3>Description</h3>

<p>This is a <code><a href="stats.html#topic+confint">confint</a></code> method for objects of class <code>distfreereg</code>. It calculates confidence intervals for the estimated parameters of a model in a <code>distfreereg</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'distfreereg'
confint(object, parm, level = 0.95, ..., digits = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint.distfreereg_+3A_object">object</code></td>
<td>

<p>Object of class <code>distfreereg</code>.
</p>
</td></tr>
<tr><td><code id="confint.distfreereg_+3A_parm">parm</code></td>
<td>

<p>Numeric or character vector; specifies which parameters are to be given confidence intervals. If missing, all parameters are considered.
</p>
</td></tr>
<tr><td><code id="confint.distfreereg_+3A_level">level</code></td>
<td>

<p>Numeric vector of length one; specifies the confidence level.
</p>
</td></tr>
<tr><td><code id="confint.distfreereg_+3A_...">...</code></td>
<td>

<p>Additional parameters passed to other methods. Currently ignored.
</p>
</td></tr>
<tr><td><code id="confint.distfreereg_+3A_digits">digits</code></td>
<td>

<p>Numeric vector of length one; used to format percentage labels. Silently converted to an integer.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a slight reworking of <code><a href="stats.html#topic+confint.default">confint.default</a></code>. The primary difference is that when <code>object$test_mean</code> is a function, the return value from <code><a href="#topic+vcov.distfreereg">vcov.distfreereg</a></code> is included in the output, since its calculation can be computationally expensive and this prevents users from needing to call <code><a href="stats.html#topic+vcov">vcov</a></code> separately for its output.
</p>


<h3>Value</h3>

<p>If <code>object$test_mean</code> is not a function, then the output is a named numeric matrix each row of which gives the endpoints of the requested confidence interval of its corresponding parameter. If <code>object$test_mean</code> is a function, then the output is a named list with the previously defined matrix as its first element and the output of <code>vcov(object)</code> as its second.
</p>


<h3>Note</h3>

<p>If <code>object</code> was created by calling <code><a href="#topic+distfreereg.default">distfreereg.default</a></code> directly, there is no estimated parameter vector, and therefore <code>confint.distfreereg</code> does not apply.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>, <code><a href="#topic+vcov.distfreereg">vcov.distfreereg</a></code>
</p>

<hr>
<h2 id='distfreereg'>
Distribution-Free Parametric Regression Testing
</h2><span id='topic+distfreereg'></span><span id='topic+distfreereg.default'></span><span id='topic+distfreereg.formula'></span><span id='topic+distfreereg.function'></span><span id='topic+distfreereg.lm'></span><span id='topic+distfreereg.nls'></span>

<h3>Description</h3>

<p>Conduct distribution-free parametric regression testing using the process introduced in <cite>Khmaladze (2021)</cite>. A parametric model for the conditional mean (specified by <code>test_mean</code>) is checked against the data by fitting the model, transforming the resulting residuals, and then calculating a statistic on the empirical partial sum process of the transformed residuals. The statistic's null distribution can be simulated in a straight-forward way, thereby producing a p-value.
</p>
<p>Using <code class="reqn">f</code> to denote the mean function being tested, the specific test has the following null and alternative hypotheses:
</p>
<p style="text-align: center;"><code class="reqn">H_0\colon\ \exists\theta\in\Theta\subseteq\mathbb R^p \mathrel{\bigl|} \textrm{E}(Y| X)=f(X;\theta)
  \quad\hbox{against}\quad
  H_1\colon\ \forall\theta\in\Theta\subseteq\mathbb R^p \mathrel{\bigl|} \textrm{E}(Y| X)\neq f(X;\theta).</code>
</p>

<p>See the <a href="../doc/v1_introduction.html">An Introduction to the <code>distfreereg</code> Package</a> vignette for an introduction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	distfreereg(test_mean, ordering = "simplex", group = FALSE,
	stat = c("KS", "CvM"), B = 1e4, control = NULL, override = NULL, verbose = TRUE,
	...)

	## Default S3 method:
distfreereg(test_mean = NULL, ordering = "simplex", group = FALSE,
	stat = c("KS", "CvM"), B = 1e4, control = NULL, override = NULL, verbose = TRUE,
	..., Y, X = NULL, covariance, J, fitted_values)

	## S3 method for class 'formula'
distfreereg(test_mean, ordering = "simplex", group = FALSE,
	stat = c("KS", "CvM"), B = 1e4, control = NULL, override = NULL, verbose = TRUE,
	..., data, covariance = NULL, method = "lm", theta_init = NULL)

	## S3 method for class 'function'
distfreereg(test_mean, ordering = "simplex", group = FALSE,
	stat = c("KS", "CvM"), B = 1e4, control = NULL, override = NULL, verbose = TRUE,
	..., Y, X = NULL, covariance, theta_init)

	## S3 method for class 'lm'
distfreereg(test_mean, ordering = "simplex", group = FALSE,
	stat = c("KS", "CvM"), B = 1e4, control = NULL, override = NULL, verbose = TRUE,
	...)

	## S3 method for class 'nls'
distfreereg(test_mean, ordering = "simplex", group = FALSE,
	stat = c("KS", "CvM"), B = 1e4, control = NULL, override = NULL, verbose = TRUE,
	...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="distfreereg_+3A_test_mean">test_mean</code></td>
<td>

<p>A specification of the mean function to be tested. Methods exist for objects of classes <code>function</code>, <code>formula</code>, <code>lm</code>, and <code>nls</code>. See details.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_covariance">covariance</code></td>
<td>

<p>Named list; specifies the covariance structure of the model's error distribution. Valid element names are &quot;<code>Sigma</code>&quot;, &quot;<code>SqrtSigma</code>&quot;, &quot;<code>P</code>&quot;, and &quot;<code>Q</code>&quot;, corresponding to the covariance matrix, the square root of the covariance matrix, the precision matrix, and the square root of the precision matrix, respectively. Each element must be one of the following:
</p>

<ul>
<li><p> a numeric matrix.
</p>
</li>
<li><p> a numeric vector whose length is the sample size.
</p>
</li>
<li><p> a numeric vector of length 1.
</p>
</li></ul>

<p>See details.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_ordering">ordering</code></td>
<td>

<p>A character string or a list; specifies how to order the residuals to form the empirical partial sum process. Valid character strings are:
</p>

<ul>
<li><p> &quot;<code>asis</code>&quot;: leaves the order unchanged (that is, in the order in which the observations appear in the supplied data).
</p>
</li>
<li><p> &quot;<code>natural</code>&quot;: orders residuals using column-wise ordering of the covariates.
</p>
</li>
<li><p> &quot;<code>optimal</code>&quot;: orders the residuals by ordering the observations using optimal transport on the covariates. The solution is estimated using the Hungarian method as implemented by <code><a href="clue.html#topic+solve_LSAP">solve_LSAP</a></code>. This option can be very slow for large sets of covariates.
</p>
</li>
<li><p> &quot;<code>simplex</code>&quot;: (the default) orders residuals in order of increasing row sums of the covariates after each column has been scaled to the interval <code class="reqn">[0,1]</code>.
</p>
</li></ul>

<p>If <code>ordering</code> is a list, then its elements specify columns of <code>X</code> or <code>data</code> to use to determine the order. The elements can be column names or numbers, but not a mix of the two.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_group">group</code></td>
<td>

<p>Logical; if <code>TRUE</code>, then columns specified by <code>ordering</code> are used to group observations (by summation) before forming the partial sum process. Can be <code>TRUE</code> only when <code>ordering</code> is &quot;<code>natural</code>&quot; or a list of column specifications.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_j">J</code></td>
<td>

<p>Numeric matrix; specifies the Jacobian of the function evaluated at the covariates and the estimated parameters.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_fitted_values">fitted_values</code></td>
<td>

<p>Numeric vector; specifies the model's fitted values.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_stat">stat</code></td>
<td>

<p>Character vector; specifies the names of the functions used to calculate the desired statistics. By default, a Kolmogorov&ndash;Smirnov statistic and a Cramer&ndash;von Mises-like statistic are calculated:
</p>
<p style="text-align: center;"><code class="reqn">\hbox{KS} = \max_{i}|a_i|\qquad\hbox{and}\qquad\hbox{CvM} = {1\over n}\sum_{i=1}^na_i^2</code>
</p>
<p> where <code class="reqn">a_i</code> is term <code class="reqn">i</code> in the empirical partial sum process and <code class="reqn">n</code> is the sample size.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_b">B</code></td>
<td>

<p>Numeric vector of length one; specifies the Monte Carlo sample size used when simulating statistics. Silently converted to integer.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_control">control</code></td>
<td>

<p>Optional named list of elements that control the details of the algorithm's computations. The following elements are accepted for all methods:
</p>

<ul>
<li> <p><code>symmetric</code>:	Optional named list or <code>FALSE</code>; if a named list, its elements are passed as arguments to <code><a href="base.html#topic+isSymmetric">isSymmetric</a></code> when testing elements of <code>covariance</code> for symmetry. If <code>FALSE</code>, then this test is skipped.
</p>
</li>
<li> <p><code>matsqrt_tol</code>: Numeric; specifies the threshold for considering an eigenvalue &quot;too negative&quot; when calculating the square root of a matrix. Must be non-positive. The default value is <code>-.Machine$double.eps^0.25</code>.
</p>
</li>
<li> <p><code>solve_tol</code>: Numeric; passed as <code>tol</code> argument to <code><a href="base.html#topic+solve">solve</a></code>, used in particular to invert <code>Sigma</code>. The default value is <code>.Machine$double.eps</code>.
</p>
</li>
<li> <p><code>qr_tol</code>: Numeric; passed as <code>tol</code> argument to <code><a href="base.html#topic+qr">qr</a></code>. The default value is <code>sqrt(.Machine$double.eps)</code>. This value might need to be decreased when the dimensions of the Jacobian are sufficiently large.
</p>
</li>
<li> <p><code>orth_tol</code>: Numeric; passed as <code>tolerance</code> argument to <code><a href="base.html#topic+all.equal">all.equal</a></code> when testing whether or not <code class="reqn">r^Tr</code> is the identity matrix. The default value is <code>sqrt(.Machine$double.eps)</code>.
</p>
</li>
<li> <p><code>trans_tol</code>: Numeric; passed as <code>tolerance</code> argument to <code><a href="base.html#topic+all.equal">all.equal</a></code> to internal transformation function when determining whether the normalizing scalar is non-zero. The default value is <code>sqrt(.Machine$double.eps)</code>.
</p>
</li></ul>

<p>The following named elements, all but the first of which control the process of calculating the generalized least squares estimation of the parameter vector, are accepted for the <code>function</code> method:
</p>

<ul>
<li> <p><code>jacobian_args</code>: Optional list; specifies arguments to pass to <code><a href="numDeriv.html#topic+jacobian">jacobian</a></code>.
</p>
</li>
<li> <p><code>optimization_fun</code>: Optional function; specifies the function used to estimate the parameters. If not specified, <code><a href="stats.html#topic+optim">optim</a></code> is used with <code>method = "BFGS"</code>.
</p>
</li>
<li> <p><code>fun_to_optimize_arg</code>: Optional character string, required when <code>optimization_fun</code> is specified; specifies the name of the argument of <code>optimization_fun</code> that is assigned the function to optimize. For example, <code><a href="stats.html#topic+optim">optim</a></code> uses &quot;<code>fn</code>&quot;.
</p>
</li>
<li> <p><code>theta_init_arg</code>: Optional character string, required when <code>optimization_fun</code> is specified; specifies the name of the argument of <code>optimization_fun</code> that is assigned the initial parameter values for optimization. For example, <code><a href="stats.html#topic+optim">optim</a></code> uses &quot;<code>par</code>&quot;.
</p>
</li>
<li> <p><code>theta_hat_name</code>: Optional character string, required when <code>optimization_fun</code> is specified; specifies the name of the element of the output of <code>optimization_fun</code> that contains the estimated parameters. For example, <code><a href="stats.html#topic+optim">optim</a></code> uses &quot;<code>par</code>&quot; (the same character string that specifies the argument containing the initial values). See Warnings.
</p>
</li>
<li> <p><code>optimization_args</code>: Optional list; specifies additional arguments to pass to <code>optimization_fun</code>.
</p>
</li></ul>

<p>Finally, the following element is available for the <code>formula</code> method:
</p>

<ul>
<li> <p><code>method_args</code>: Optional list of argument values to be passed to <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+nls">nls</a></code>, according to the value of the <code>method</code> argument.
</p>
</li></ul>

</td></tr>
<tr><td><code id="distfreereg_+3A_override">override</code></td>
<td>

<p>Optional named list of arguments that override internally calculated values. Used primarily by <code><a href="#topic+update.distfreereg">update.distfreereg</a></code>, but can be accessed directly. The following named elements are accepted:
</p>

<ul>
<li> <p><code>J</code>: Numeric matrix. Overrides the calculation of <code>J</code> by non-default methods.
</p>
</li>
<li> <p><code>fitted_values</code>: Numeric vector of fitted values.
</p>
</li>
<li> <p><code>res_order</code>: Integer vector specifying the permutation (analogous to the output of <code><a href="base.html#topic+order">order</a></code>) that orders the residuals for the computation of the partial sums. Overrides <code>ordering</code>.
</p>
</li>
<li> <p><code>theta_hat</code>: Numeric vector. Used as the estimated parameter vector when <code>test_mean</code> has class <code>function</code>, overriding internal computation that would have used <code>optimization_fun</code>.
</p>
</li>
<li> <p><code>r</code>: Numeric matrix. Overrides the construction of the transformation anchors.
</p>
</li>
<li> <p><code>mcsim_stats</code>: List. Overrides the creation of the list of simulated statistics.
</p>
</li></ul>

</td></tr>
<tr><td><code id="distfreereg_+3A_verbose">verbose</code></td>
<td>

<p>Logical; if <code>TRUE</code>, progress messages are printed. Default value is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_...">...</code></td>
<td>

<p>Additional arguments to pass to various methods; should be empty except in a call to the generic function.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_y">Y</code></td>
<td>

<p>Numeric vector of observations. A matrix value is silently converted to a vector.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_x">X</code></td>
<td>

<p>Optional numeric matrix of covariates. A vector value is converted to a single-column matrix with a warning.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_method">method</code></td>
<td>

<p>Character vector; specifies the function to use for fitting the model when <code>test_mean</code> is a formula. Possible values are &quot;<code>lm</code>&quot; and &quot;<code>nls</code>&quot;, specifying <code><a href="stats.html#topic+lm">lm</a></code> and <code><a href="stats.html#topic+nls">nls</a></code>, respectively.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_theta_init">theta_init</code></td>
<td>

<p>Numeric vector; specifies the starting parameter values passed to the optimizing function to be used to estimate the parameter vector. Must be <code>NULL</code> when <code>method</code> is &quot;<code>lm</code>&quot;. Optional for <code>formula</code> method when <code>method</code> is &quot;<code>nls</code>&quot;, but must be a <strong>named</strong> vector if present in this case.
</p>
</td></tr>
<tr><td><code id="distfreereg_+3A_data">data</code></td>
<td>

<p>Optional data frame of covariate values; required for <code>formula</code> method, must be absent otherwise.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements distribution-free parametric regression testing. The model is specified by a mean structure and a covariance structure.
</p>
<p>The mean structure is specified by the argument <code>test_mean</code>. This can be a function, formula, <code>lm</code> object, <code>nls</code> object, or <code>NULL</code>.
</p>
<p>If <code>test_mean</code> is a function, then it must have one or two arguments: either <code>theta</code> only, or <code>theta</code> and either <code>X</code> (uppercase) or <code>x</code> (lowercase). An uppercase <code>X</code> is interpreted in the function definition as a matrix, while a lowercase <code>x</code> is interpreted as a vector. (See examples and <a href="../doc/v5_advanced-options.html">this vignette</a>.) The primary reason to use a lowercase <code>x</code> is to allow for a function definition using an <code>R</code> function that is not vectorized. In general, an uppercase <code>X</code> should be preferred for speed.
</p>
<p>If <code>test_mean</code> is an <code>lm</code> or <code>nls</code> object, then the covariance structure is obtained from the supplied model.
</p>
<p>If <code>test_mean</code> is a formula, then it must be a formula that can be passed to <code><a href="stats.html#topic+lm">lm</a></code> or <code><a href="stats.html#topic+nls">nls</a></code>, and the <code>data</code> argument must be specified. The appropriate model will be created, and then sent back to <code>distfreereg()</code> for method dispatch.
</p>
<p>The <code>function</code> method estimates parameter values, and then uses those to evaluate the Jacobian of the mean function and to calculate fitted values. It then calls the default method, which does not use <code>test_mean</code>. The default method also allows the user to implement the algorithm even when the mean structure is not specified in <code>R</code>. (This is useful if a particularly complicated function is defined in another language and cannot easily be copied into <code>R</code>.) It requires specifying the vector of fitted values and the Jacobian matrix of the mean function evaluated at the estimated parameter values.
</p>
<p>The covariance structure for <code class="reqn">Y|X</code> must be specified using the <code>covariance</code> argument for the <code>function</code> and default methods. It is optional for the <code>formula</code> method; when present in that case, it must specify a diagonal matrix which is converted internally into a vector of weights. For the <code>lm</code> and <code>nls</code> methods, the covariance is determined using the supplied object.
</p>
<p>Any element of <code>covariance</code> can be a numeric matrix, or a numeric vector. If it is a vector, its length must be either 1 or the sample size. This option is mathematically equivalent to setting a covariance list element to a diagonal matrix with the specified value(s) along the diagonal. Using vectors, when possible, is more efficient than using the corresponding matrix.
</p>
<p>Internally, <code>distfreereg()</code> only needs <code>Q</code>, so some efficiency can be gained by supplying that directly when available. When <code>Q</code> is not specified, it is calculated using whichever element is specified. When more than one of the other elements are specified, <code>Q</code> is calculated using the least expensive path, with no warning given if the specified elements are incompatible. (For example, if both <code>Sigma</code> and <code>SqrtSigma</code> elements are supplied to <code>covariance</code>, then <code>Q</code> is calculated using <code>SqrtSigma</code> with no attempt to verify that <code>SqrtSigma</code> is the matrix square root of<code>Sigma</code>.)
</p>
<p>The <code>override</code> argument is used primarily by <code><a href="#topic+update.distfreereg">update.distfreereg</a></code> to avoid unnecessary and potentially computationally expensive recomputation. This <code><a href="stats.html#topic+update">update</a></code> method imports appropriate values automatically from a previously created object of class <code>distfreereg</code>, and therefore validation is not always done. Use manually with caution.
</p>


<h3>Value</h3>

<p>An object of class <code>distfreereg</code> with the following components:
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>The matched call.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>A list containing <code>data</code>, if present, and <code>Y</code> and <code>X</code>.</p>
</td></tr>
<tr><td><code>test_mean</code></td>
<td>
<p>The value supplied to the argument <code>test_mean</code>.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>The model built when using the <code>formula</code> method; only present when using that method.</p>
</td></tr>
<tr><td><code>covariance</code></td>
<td>
<p>The list of covariance matrices, containing at least <code>Q</code>.</p>
</td></tr>
<tr><td><code>theta_hat</code></td>
<td>
<p>The estimated parameter vector.</p>
</td></tr>
<tr><td><code>optimization_output</code></td>
<td>
<p>The output of <code>optimization_fun</code> or <code><a href="stats.html#topic+nls">nls</a></code> from calculating <code>theta_hat</code>.</p>
</td></tr>
<tr><td><code>fitted_values</code></td>
<td>
<p>The vector of fitted values, <code class="reqn">f\bigl(X,\hat\theta\bigr)</code>.</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>The Jacobian matrix.</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>The mu matrix.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>The matrix of transformation anchor vectors.</p>
</td></tr>
<tr><td><code>r_tilde</code></td>
<td>
<p>The matrix of modified transformation anchor vectors.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>A named list of three vectors containing raw, sphered, and transformed residuals.</p>
</td></tr>
<tr><td><code>res_order</code></td>
<td>
<p>A numeric vector indicating the ordering of the residuals used to form the empirical partial sum process, in a format analogous to the output	of <code><a href="base.html#topic+order">order</a></code>.</p>
</td></tr>
<tr><td><code>epsp</code></td>
<td>
<p>The empirical partial sum process formed by calculating the scaled
partial sums of the transformed residuals ordered according to <code>res_order</code>.</p>
</td></tr>
<tr><td><code>observed_stat</code></td>
<td>
<p>A named list of the observed statistic(s) corresponding to the transformed residuals.</p>
</td></tr>
<tr><td><code>mcsim_stats</code></td>
<td>
<p>A named list, each element of which contains the values of a simulated statistic.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>A named list with two elements: <code>value</code>, which contains the p-values for each observed statistic, and <code>mcse</code>, which contains the Monte Carlo standard errors for the p-values.</p>
</td></tr>
</table>


<h3>Warnings</h3>

<p>Consistency between <code>test_mean</code> and <code>theta_init</code> is verified only
indirectly. Uninformative errors can occur when, for example, <code>theta_init</code>
does not have the correct length. The two most common error messages that arise
in this case are &quot;<code>f_out cannot have NA values</code>&quot;, indicating that
<code>theta_init</code> is too short, and &quot;<code>Unable to invert square root of J^tJ</code>&quot;,
indicating that <code>theta_init</code> is too long. (Both of these errors might occur
for other reasons, as well.) To be safe, always define <code>test_mean</code> to use
every element of <code>theta</code>.
</p>
<p>No verification of consistency is done when multiple elements of <code>coviariance</code> are specified. For example, if <code>P</code> and <code>Sigma</code> are both specified, then the code will use only one of these, and will not verify that <code>P</code> is the inverse of <code>Sigma</code>.
</p>
<p>When using the <code>control</code> argument element <code>optimization_fun</code> to
specify an optimization function other than <code><a href="stats.html#topic+optim">optim</a></code>, the
verification that <code>theta_hat_name</code> actually matches the name of an element
of the optimization function's output is done only after the optimization has
been done. If this optimization will likely take a long time, it is important to
verify the value of <code>theta_hat_name</code> before running <code>distfreereg()</code>.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>References</h3>

<p>Khmaladze, Estate V. <em>Distribution-free testing in linear and parametric regression</em>, 2021-03, Annals of the Institute of Statistical Mathematics, Vol. 73, No. 6, p. 1063&ndash;1087. <a href="https://doi.org/10.1007/s10463-021-00786-3">doi:10.1007/s10463-021-00786-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coef.distfreereg">coef.distfreereg</a></code>, <code><a href="#topic+confint.distfreereg">confint.distfreereg</a></code>, <code><a href="#topic+fitted.distfreereg">fitted.distfreereg</a></code>, <code><a href="#topic+formula.distfreereg">formula.distfreereg</a></code>, <code><a href="#topic+plot.distfreereg">plot.distfreereg</a></code>, <code><a href="#topic+predict.distfreereg">predict.distfreereg</a></code>, <code><a href="#topic+print.distfreereg">print.distfreereg</a></code>, <code><a href="#topic+residuals.distfreereg">residuals.distfreereg</a></code>, <code><a href="#topic+update.distfreereg">update.distfreereg</a></code>, <code><a href="#topic+vcov.distfreereg">vcov.distfreereg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20240218)
n &lt;- 1e2
func &lt;- function(X, theta) X[,1]^theta[1] + theta[2]*X[,2]
Sig &lt;- runif(n, min = 1, max = 3)
theta &lt;- c(2,5)
X &lt;- matrix(runif(2*n, min = 1, max = 5), nrow = n)
Y &lt;- X[,1]^theta[1] + theta[2]*X[,2] + rnorm(n, sd = sqrt(Sig))
(dfr &lt;- distfreereg(Y = Y, X = X, test_mean = func,
                    covariance = list(Sigma = Sig),
                    theta_init = c(1,1)))

func_lower &lt;- function(x, theta) x[1]^theta[1] + theta[2]*x[2]
(dfr_lower &lt;- distfreereg(Y = Y, X = X, test_mean = func_lower,
                          covariance = list(Sigma = Sig),
                          theta_init = c(1,1)))

identical(dfr$observed_stats, dfr_lower$observed_stats)
</code></pre>

<hr>
<h2 id='fitted.distfreereg'>
Extract Fitted Values from <code>distfreereg</code> Objects
</h2><span id='topic+fitted.distfreereg'></span>

<h3>Description</h3>

<p>This is a <code><a href="stats.html#topic+fitted">fitted</a></code> method for objects of class <code>distfreereg</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'distfreereg'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.distfreereg_+3A_object">object</code></td>
<td>

<p>Object of class <code>distfreereg</code>.
</p>
</td></tr>
<tr><td><code id="fitted.distfreereg_+3A_...">...</code></td>
<td>

<p>Additional parameters passed to or from other methods. Currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of fitted values.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>
</p>

<hr>
<h2 id='formula.distfreereg'>
Extract Formulas from <code>distfreereg</code> Objects
</h2><span id='topic+formula.distfreereg'></span>

<h3>Description</h3>

<p>This is a <code><a href="stats.html#topic+formula">formula</a></code> method for objects of class <code>distfreereg</code>. It extracts the formula from a model in a <code>distfreereg</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'distfreereg'
formula(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formula.distfreereg_+3A_x">x</code></td>
<td>

<p>Object of class <code>distfreereg</code>.
</p>
</td></tr>
<tr><td><code id="formula.distfreereg_+3A_...">...</code></td>
<td>

<p>Additional parameters passed to or from other methods. Currently ignored.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formula extracted from <code>x$test_mean</code>, or <code>NULL</code> if such a formula cannot be extracted.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>
</p>

<hr>
<h2 id='ks.test.compare'>
Formally Compare Observed and Simulated Statistics
</h2><span id='topic+ks.test.compare'></span>

<h3>Description</h3>

<p>This is a <code><a href="stats.html#topic+ks.test">ks.test</a></code> method for objects of class <code>compare</code>. It performs a two-sample Kolmogorov&ndash;Smirnov test to compare the observed and simulated statistics in an object of class <code>compare</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'compare'
ks.test(x, ..., stat = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ks.test.compare_+3A_x">x</code></td>
<td>

<p>Object of class <code>compare</code>.
</p>
</td></tr>
<tr><td><code id="ks.test.compare_+3A_...">...</code></td>
<td>

<p>Additional parameters passed to <code>ks.test</code>.
</p>
</td></tr>
<tr><td><code id="ks.test.compare_+3A_stat">stat</code></td>
<td>

<p>Character string specifying the statistic on which to run the test.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>stat</code> is <code>NULL</code>, the default value is the first statistic appearing in the <code>observed_stats</code> element of <code>object</code>.
</p>


<h3>Value</h3>

<p>A list of the form specified in <code><a href="stats.html#topic+ks.test">ks.test</a></code>.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compare">compare</a></code>, <code><a href="#topic+distfreereg">distfreereg</a></code>, <code><a href="stats.html#topic+ks.test">ks.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># In practice, set "reps" larger than 200.
set.seed(20240201)
n &lt;- 100
func &lt;- function(X, theta) theta[1] + theta[2]*X
Sig &lt;- rWishart(1, df = n, Sigma = diag(n))[,,1]
theta &lt;- c(2,5)
X &lt;- matrix(rexp(n, rate = 1))
cdfr &lt;- compare(true_mean = func, true_X = X, true_covariance = list(Sigma = Sig),
                test_mean = func, X = X, covariance = list(Sigma = Sig), reps = 200,
                prog = Inf, theta = theta, theta_init = rep(1, length(theta)))

ks.test(cdfr)
ks.test(cdfr, stat = "CvM")
</code></pre>

<hr>
<h2 id='plot.compare'>
Summary and Diagnostic Plots for <code>compare</code> Objects
</h2><span id='topic+plot.compare'></span>

<h3>Description</h3>

<p>This is a <code><a href="base.html#topic+plot">plot</a></code> method for objects of class <code>compare</code>. It automates the creation of four summary and diagnostic plots for <code>compare</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'compare'
plot(x, y, ..., which = "cdf", stat = NULL, hlines = NULL, curve_args = NULL,
	confband_args = FALSE, density_args = NULL, poly = NULL, legend = NULL,
	qqline = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.compare_+3A_x">x</code></td>
<td>

<p>Object of class <code>compare</code>.
</p>
</td></tr>
<tr><td><code id="plot.compare_+3A_y">y</code></td>
<td>

<p>Optional object of class <code>compare</code>.
</p>
</td></tr>
<tr><td><code id="plot.compare_+3A_...">...</code></td>
<td>

<p>Additional parameters passed to a plotting function depending on the
value of <code>which</code>: to <code><a href="base.html#topic+plot">plot</a></code> for &quot;<code>cdf</code>&quot; and
&quot;<code>dens</code>&quot;; to <code><a href="stats.html#topic+qqplot">qqplot</a></code> for &quot;<code>qq</code>&quot; and &quot;<code>qqp</code>&quot;.
</p>
</td></tr>
<tr><td><code id="plot.compare_+3A_which">which</code></td>
<td>

<p>Character string. Acceptable values are &quot;<code>cdf</code>&quot;, &quot;<code>dens</code>&quot;, &quot;<code>qq</code>&quot;, and &quot;<code>qqp</code>&quot;:
</p>

<ul>
<li><p> &quot;<code>cdf</code>&quot; produces a plot of the estimated cumulative distribution
functions of the two vectors of statistics being compared.
</p>
</li>
<li><p> &quot;<code>dens</code>&quot; produces a plot of the estimated density functions of
the two vectors of statistics being compared.
</p>
</li>
<li><p> &quot;<code>qq</code>&quot; produces a quantile&ndash;quantile plot comparing the two
vectors of statistics.
</p>
</li>
<li><p> &quot;<code>qqp</code>&quot; produces a quantile&ndash;quantile plot comparing the p-values
with uniform quantiles. (This is not available when <code>y</code> is present.)
</p>
</li></ul>

</td></tr>
<tr><td><code id="plot.compare_+3A_stat">stat</code></td>
<td>

<p>Character string, specifies the statistic to plot.
</p>
</td></tr>
<tr><td><code id="plot.compare_+3A_hlines">hlines</code></td>
<td>

<p>An optional list of arguments to pass to <code><a href="graphics.html#topic+abline">abline</a></code>, used to create the horizontal dashed lines when <code>which</code> is &quot;<code>cdf</code>&quot;. Setting equal to <code>FALSE</code> prevents the call, and no lines are drawn.
</p>
</td></tr>
<tr><td><code id="plot.compare_+3A_curve_args">curve_args</code></td>
<td>

<p>An optional list used to pass arguments to <code><a href="graphics.html#topic+lines">lines</a></code> (not <code><a href="graphics.html#topic+curve">curve</a></code>!), used to create the curves when <code>which</code> is &quot;<code>cdf</code>&quot; or &quot;<code>dens</code>&quot;. It can have two special named arguments, <code>obs</code> and <code>mcsim</code>, whose values must be lists. Those lists contain arguments passed to the calls to <code><a href="graphics.html#topic+lines">lines</a></code> for plotting the curves for the observed and simulated statistics, respectively. Any other elements are passed to both calls.
</p>
</td></tr>
<tr><td><code id="plot.compare_+3A_confband_args">confband_args</code></td>
<td>

<p>An optional list of values that control the calculation and plotting of confidence bands when <code>which</code> is &quot;<code>cdf</code>&quot; or &quot;<code>dens</code>&quot;. Any of the following named elements are allowed.
</p>

<ul>
<li> <p><code>w</code>: Numeric; the sequence of points on which to evaluate the confidence band. By default, the sequence is <code>seq(from = min(x) + buffer, to = max(x) - buffer, length.out = m)</code>, where <code>x</code> is the vector of values of the statistic in question, and <code>buffer</code> is explained below.
</p>
</li>
<li> <p><code>m</code>: Integer; the length of <code>w</code>, used only when <code>w</code> is <code>NULL</code>. The default value is 100.
</p>
</li>
<li> <p><code>batch_len</code>: Integer; the batch length for the algorithm. The default value is 50.
</p>
</li>
<li> <p><code>N</code>: Integer; the number of multivariate <code class="reqn">t</code> samples to use in the simulation.
</p>
</li>
<li> <p><code>conf.level</code>: Numeric; the desired confidence level.
</p>
</li>
<li> <p><code>buffer</code>: Numeric; the proportion of either side of the range of data to ignore when defining <code>w</code>, used only when <code>w</code> is <code>NULL</code>.
</p>
</li>
<li> <p><code>curve_args</code>: An optional list of arguments passed to <code><a href="graphics.html#topic+lines">lines</a></code> (again, not <code><a href="graphics.html#topic+curve">curve</a></code>!), used to create the boundaries of the confidence band. It can have two special named arguments, <code>obs</code> and <code>mcsim</code>, which function in the same way as the corresponding elements of the <code>curve_args</code> argument described above.
</p>
</li>
<li> <p><code>polygon_args</code>: An optional list of arguments passed to <code><a href="graphics.html#topic+polygon">polygon</a></code>, used to shade the confidence region. Setting equal to <code>FALSE</code> prevents the call, and no shading is done.
</p>
</li>
<li> <p><code>shade_col</code>: This provides a shortcut to the <code>col</code> argument of <code><a href="graphics.html#topic+polygon">polygon</a></code> to change the color of the shaded region.
</p>
</li></ul>

<p>Setting equal to <code>FALSE</code> prevents calculation and plotting of the band.
</p>
</td></tr>
<tr><td><code id="plot.compare_+3A_density_args">density_args</code></td>
<td>

<p>An optional list of arguments passed to <code><a href="stats.html#topic+density">density</a></code> when <code>which</code> is &quot;<code>dens</code>&quot;, which calculates the points used to plot the density curves. The list can have two special named elements, <code>obs</code> and <code>mcsim</code>, which function in the same way as the corresponding elements of the <code>curve_args</code> argument described above.
</p>
</td></tr>
<tr><td><code id="plot.compare_+3A_poly">poly</code></td>
<td>

<p>An optional list of arguments passed to <code><a href="graphics.html#topic+polygon">polygon</a></code> when <code>which</code> is &quot;<code>dens</code>&quot;, which shades the area under the density curves. The list can have two special named elements, <code>obs</code> and <code>mcsim</code>, which modify the shadings for their respective curves, analogous to their behavior in the <code>curve_args</code> argument. When <code>poly</code> is equal to <code>FALSE</code>, no call is made, and therefore no shading is done.
</p>
</td></tr>
<tr><td><code id="plot.compare_+3A_legend">legend</code></td>
<td>

<p>An optional list of arguments passed to <code><a href="graphics.html#topic+legend">legend</a></code> when <code>which</code> is &quot;<code>cdf</code>&quot; or &quot;<code>dens</code>&quot;. When equal to <code>FALSE</code>, no call is made, and therefore no legend is created.
</p>
</td></tr>
<tr><td><code id="plot.compare_+3A_qqline">qqline</code></td>
<td>

<p>An optional list of arguments passed to <code><a href="graphics.html#topic+abline">abline</a></code> when <code>which</code> is &quot;<code>qq</code>&quot; or &quot;<code>qqp</code>&quot;. By default, this plots the line <code class="reqn">y=x</code>. When equal to <code>FALSE</code>, no call is made, and therefore no line is plotted.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces a plot of a type specified by <code>which</code>. The values
plotted depend on whether or not <code>y</code> is present and the value of
<code>which</code>. When <code>y</code> is present, the plots compare the observed
statistics in <code>x</code> and the observed statistics in <code>y</code>. When <code>y</code>
is missing, the plots compare the observed and simulated statistics in
<code>x</code>. (The exception is when <code>which</code> is &quot;<code>qqp</code>&quot;, which is only
available when <code>y</code> is missing.)
</p>
<p>When <code>which</code> is &quot;<code>cdf</code>&quot; or &quot;<code>dens</code>&quot;, the plotting region and
associated labels, tick marks, etc., are created by an initial call to
<code><a href="base.html#topic+plot">plot</a></code>. The curves themselves are drawn with <code><a href="graphics.html#topic+lines">lines</a></code>.
The arguments specified in <code>...</code> are passed to the initial call to
<code><a href="base.html#topic+plot">plot</a></code>.
</p>


<h3>Value</h3>

<p>The values used to create the curves (or points, in the case of a Q&ndash;Q plot) are returned invisibly. The details depend on the value of <code>which</code>:
</p>

<ul>
<li> <p><code>cdf</code>: A list with two or four elements, all lists. The first two sub-lists contain the <code class="reqn">x</code>- and <code class="reqn">y</code>-values cdf curves. If confidence bands are plotted, then two additional elements are included with output from the confidence band calculations, including elements <code>w</code>, <code>cb_lower</code>, and <code>cb_upper</code>, which contain, respectively, the <code class="reqn">x</code>-coordinates for both the upper and lower bounds of the band, the <code class="reqn">y</code>-coordinates for the lower band, and the <code class="reqn">y</code>-coordinates for the upper band.
</p>
</li>
<li> <p><code>dens</code>: A list with two or four elements, all lists. The first two sub-lists contain <code class="reqn">x</code>- and <code class="reqn">y</code>-values for the density curves. If confidence bands are plotted, then two additional sub-lists are supplied, with contents identical to what is described for &quot;<code>cdf</code>&quot;.
</p>
</li>
<li> <p><code>qq</code>, <code>qqp</code>: The output of <code><a href="stats.html#topic+qqplot">qqplot</a></code>.
</p>
</li></ul>

<p>For &quot;<code>cdf</code>&quot; and &quot;<code>dens</code>&quot;, the names of the elements of the returned list depend on whether or not a value for the argument <code>y</code> was supplied.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>References</h3>

<p>Flegal, James M. et al. <strong>Simultaneous confidence bands for (Markov chain) Monte Carlo simulations</strong>, forthcoming.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>, <code><a href="#topic+compare">compare</a></code>
</p>

<hr>
<h2 id='plot.distfreereg'>
Summary and Diagnostic Plots for <code>distfreereg</code> Objects
</h2><span id='topic+plot.distfreereg'></span>

<h3>Description</h3>

<p>This is a <code><a href="base.html#topic+plot">plot</a></code> method for objects of class <code>distfreereg</code>. It automates the creation of three summary and diagnostic plots for <code>distfreereg</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'distfreereg'
plot(x, which = "dens", stat = NULL, density_args = NULL, polygon_args = NULL,
	confband_args = NULL, abline_args = NULL, shade_col = rgb(1,0,0,0.5),
	text_args = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.distfreereg_+3A_x">x</code></td>
<td>

<p>Object of class <code>distfreereg</code>.
</p>
</td></tr>
<tr><td><code id="plot.distfreereg_+3A_which">which</code></td>
<td>

<p>Character string. Acceptable values are &quot;<code>dens</code>&quot;, &quot;<code>residuals</code>&quot;, and &quot;<code>epsp</code>&quot;:
</p>

<ul>
<li><p> &quot;<code>dens</code>&quot; produces a plot of the estimated density curve of the
specified statistic.
</p>
</li>
<li><p> &quot;<code>residuals</code>&quot; produces a plot of the transformed residuals in the
order specified by <code>x$res_order</code>.
</p>
</li>
<li><p> &quot;<code>epsp</code>&quot; produces a plot of the empirical partial sum process of
the (ordered) transformed residuals.
</p>
</li></ul>

</td></tr>
<tr><td><code id="plot.distfreereg_+3A_stat">stat</code></td>
<td>

<p>Character vector of length one specifying the name of the statistic to plot
when <code>which</code> is &quot;<code>dens</code>&quot;. By default, the first statistic in
<code>x$observed_stats</code> is used.
</p>
</td></tr>
<tr><td><code id="plot.distfreereg_+3A_density_args">density_args</code></td>
<td>

<p>An optional list of arguments to pass to <code><a href="stats.html#topic+density">density</a></code>.
</p>
</td></tr>
<tr><td><code id="plot.distfreereg_+3A_polygon_args">polygon_args</code></td>
<td>

<p>An optional list of arguments to pass to <code><a href="graphics.html#topic+polygon">polygon</a></code>, used to shade under the density curve to the right of the value of the observed statistic. Setting equal to <code>FALSE</code> prevents the call, and no shading is done.
</p>
</td></tr>
<tr><td><code id="plot.distfreereg_+3A_confband_args">confband_args</code></td>
<td>

<p>An optional list of values that control the calculation and plotting of confidence bands. Any of the following named elements are allowed.
</p>

<ul>
<li> <p><code>w</code>: Numeric; the sequence of points on which to evaluate the confidence band. By default, the sequence is <code>seq(from = min(x) + buffer, to = max(x) - buffer, length.out = m</code>, where <code>x</code> is the vector of values of the statistic in question, and <code>buffer</code> is explained below.
</p>
</li>
<li> <p><code>m</code>: Integer; the length of <code>w</code>, used only when <code>w</code> is <code>NULL</code>. The default value is 100.
</p>
</li>
<li> <p><code>batch_len</code>: Integer; the batch length for the algorithm. The default value is 50.
</p>
</li>
<li> <p><code>N</code>: Integer; the number of multivariate <code class="reqn">t</code> samples to use in the simulation.
</p>
</li>
<li> <p><code>conf.level</code>: Numeric; the desired confidence level.
</p>
</li>
<li> <p><code>buffer</code>: Numeric; the proportion of either side of the range of data to ignore when defining <code>w</code>, used only when <code>w</code> is <code>NULL</code>.
</p>
</li>
<li> <p><code>curve_args</code>: An optional list of arguments passed to <code><a href="graphics.html#topic+lines">lines</a></code> (not <code><a href="graphics.html#topic+curve">curve</a></code>!), used to create the boundaries of the confidence band.
</p>
</li>
<li> <p><code>polygon_args</code>: An optional list of arguments passed to <code><a href="graphics.html#topic+polygon">polygon</a></code>, used to shade the confidence region. Setting equal to <code>FALSE</code> prevents the call, and no shading is done.
</p>
</li>
<li> <p><code>shade_col</code>: This provides a shortcut to the <code>col</code> argument of <code><a href="graphics.html#topic+polygon">polygon</a></code> to change the color of the shaded region.
</p>
</li></ul>

<p>Setting equal to <code>FALSE</code> prevents calculation and plotting of the confidence band.
</p>
</td></tr>
<tr><td><code id="plot.distfreereg_+3A_abline_args">abline_args</code></td>
<td>

<p>An optional list of arguments to pass to <code><a href="graphics.html#topic+abline">abline</a></code>, used to draw a vertical line at the value of the observed statistic. Setting equal to <code>FALSE</code> prevents the call, and no line is drawn.
</p>
</td></tr>
<tr><td><code id="plot.distfreereg_+3A_shade_col">shade_col</code></td>
<td>

<p>Character string or other value specifying the color to use to shade the upper tail of the distribution. Default value is red with 50% transparency. This is a convenience argument, and the same functionality is available by defining a <code>col</code> element in the <code>polygon_args</code> argument.
</p>
</td></tr>
<tr><td><code id="plot.distfreereg_+3A_text_args">text_args</code></td>
<td>

<p>An optional list of arguments to pass to <code><a href="graphics.html#topic+text">text</a></code>, used to label the vertical line with the p-value of the observed statistic. Setting equal to <code>FALSE</code> prevents the call, and no text is printed.
</p>
</td></tr>
<tr><td><code id="plot.distfreereg_+3A_...">...</code></td>
<td>

<p>Additional arguments to pass to <code><a href="base.html#topic+plot">plot</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces one of three specified plots, depending on the value of <code>which</code>.
</p>
<p>When <code>which</code> is &quot;<code>dens</code>&quot;, a plot of the estimated density of the simulated statistics is produced, including a vertical line at the value of the observed test statistic with the p-value displayed.
</p>
<p>The default placement of the p-value text is on the left side of the line indicating the statistic value. Specifically, the default values of <code>x</code> and <code>y</code> passed to <code><a href="graphics.html#topic+text">text</a></code> are the statistic value itself and the midpoint between zero and the maximum value of the density curve. The default value passed to <code>adj</code> is <code>c(1,0.5)</code>, meaning that the text is aligned to the left of the value <code class="reqn">(x,y)</code> and centered vertically on it. (The default value for the text itself, which can be modified via the <code>label</code> argument of <code><a href="graphics.html#topic+text">text</a></code>, includes a space on the left and the right for padding so the text does not overlap the vertical line itself.) To align the text so it appears on the right side (for example, to avoid overlapping the density curve), use <code>text_args = list(adj = c(0,0.5))</code>. See documentation for <code><a href="graphics.html#topic+text">text</a></code> for details on this and other arguments.
</p>
<p>When <code>which</code> is &quot;<code>residuals</code>&quot;, a time-series-like plot is produced showing transformed residuals in the order given by <code>x$res_order</code>. In the case that the null hypothesis is rejected, this plot can help determine where (in terms of the linearly ordered covariates) a discrepancy between the model and the data occurs.
</p>
<p>When <code>which</code> is &quot;<code>epsp</code>&quot;, a plot of the empirical partial sum process is produced; that is, the <code class="reqn">y</code>-values are
</p>
<p style="text-align: center;"><code class="reqn">y_j = {1\over\sqrt{n}}\sum_{i=1}^j\hat e_i</code>
</p>
<p> where <code class="reqn">\hat e_i</code> is the <code class="reqn">i</code>th transformed residual in the order given by <code>x$res_order</code>. Similar to the case when <code>which</code> is &quot;<code>residuals</code>&quot;, this plot can help determine where (in terms of the linearly ordered covariates) a discrepancy between the model and the data occurs.
</p>


<h3>Value</h3>

<p>When <code>which</code> is &quot;<code>dens</code>&quot;, the values used to create the density plot are returned invisibly in a list with two named elements, <code>x</code> and <code>y</code>. If the confidence band is plotted, then it is included as an element named <code>confband</code>.
</p>
<p>For other values of <code>which</code>, nothing is returned.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>References</h3>

<p>Flegal, James M. et al. <strong>Simultaneous confidence bands for (Markov chain) Monte Carlo simulations</strong>, forthcoming.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>
</p>

<hr>
<h2 id='predict.distfreereg'>
Generate Predicted Values from <code>distfreereg</code> Objects
</h2><span id='topic+predict.distfreereg'></span>

<h3>Description</h3>

<p>This is a <code><a href="stats.html#topic+predict">predict</a></code> method for objects of class <code>distfreereg</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'distfreereg'
predict(object, ..., newdata)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.distfreereg_+3A_object">object</code></td>
<td>

<p>Object of class <code>distfreereg</code>.
</p>
</td></tr>
<tr><td><code id="predict.distfreereg_+3A_...">...</code></td>
<td>

<p>Additional parameters affecting the predictions produced. Currently ignored.
</p>
</td></tr>
<tr><td><code id="predict.distfreereg_+3A_newdata">newdata</code></td>
<td>

<p>Optional matrix or data frame of new covariate values. If missing, the fitted values are returned.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>object$test_mean</code> is of class &quot;<code>lm</code>&quot; or &quot;<code>nls</code>&quot;, <code>object$test_mean</code> is sent to <code><a href="stats.html#topic+predict">predict</a></code> for method dispatch. When <code>object$test_mean</code> is of class &quot;<code>formula</code>&quot;, <code>object$model</code> is sent to <code><a href="stats.html#topic+predict">predict</a></code>.
</p>


<h3>Value</h3>

<p>Numeric vector of predicted values.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>
</p>

<hr>
<h2 id='print.distfreereg'>
Printing <code>distfreereg</code> Objects
</h2><span id='topic+print.distfreereg'></span>

<h3>Description</h3>

<p>This is a <code><a href="base.html#topic+print">print</a></code> method for objects of class <code>distfreereg</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'distfreereg'
print(x, ..., digits = 3, col_sep = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.distfreereg_+3A_x">x</code></td>
<td>

<p>Object of class <code>distfreereg</code>.
</p>
</td></tr>
<tr><td><code id="print.distfreereg_+3A_...">...</code></td>
<td>

<p>Additional parameters, currently ignored.
</p>
</td></tr>
<tr><td><code id="print.distfreereg_+3A_digits">digits</code></td>
<td>

<p>Integer; passed to <code><a href="base.html#topic+signif">signif</a></code> to determine the number of significant digits to display.
</p>
</td></tr>
<tr><td><code id="print.distfreereg_+3A_col_sep">col_sep</code></td>
<td>

<p>Integer; specifies the padding (in units of spaces) between columns in the printed table of statistics.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function prints a useful summary of the <code>distfreereg</code> object.
</p>


<h3>Value</h3>

<p>No return value (<code>NULL</code>).
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>
</p>

<hr>
<h2 id='rejection'>
Compute Rejection Rates of a Distribution-Free Test
</h2><span id='topic+rejection'></span>

<h3>Description</h3>

<p>Compute the rejection rates of the tests simulated in a <code>compare</code> object. Specifically, this function estimates the rejection rates of the tests conducted with specified statistics of the hypothesis that the mean function is <code>test_mean</code> when the true mean function is <code>true_mean</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	rejection(object, alpha = 0.05, stat = names(object[["observed_stats"]]), ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rejection_+3A_object">object</code></td>
<td>

<p>Object of class <code>compare</code>.
</p>
</td></tr>
<tr><td><code id="rejection_+3A_alpha">alpha</code></td>
<td>

<p>Numeric vector; specifies the <code class="reqn">\alpha</code>-levels to use. Passed as <code>probs</code> argument to <code><a href="stats.html#topic+quantile">quantile</a></code>.
</p>
</td></tr>
<tr><td><code id="rejection_+3A_stat">stat</code></td>
<td>

<p>Character vector; specifies the names of the statistics to use. The default value computes the rejection rate associated with every statistic in <code>object</code>.
</p>
</td></tr>
<tr><td><code id="rejection_+3A_...">...</code></td>
<td>

<p>Additional arguments to pass to <code><a href="stats.html#topic+quantile">quantile</a></code> to estimate the <code class="reqn">1-\alpha</code> quantiles of the distribution of simulated statistics.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing estimated rejection rates and associated Monte Carlo standard errors, with one row for each combination of <code>stat</code> and <code>alpha</code> elements.
</p>


<h3>Warning</h3>

<p>The reported Monte Carlo standard error does not account for the uncertainty of the estimation of the <code class="reqn">1-\alpha</code> quantiles of the distribution of simulated statistics. The number of Monte Carlo simulations should be large enough to make this estimate sufficiently accurate that it can be considered known for practical purposes. The standard errors of estimated quantiles can be calculated using the <span class="pkg">mcmcse</span> package.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>, <code><a href="#topic+compare">compare</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># In practice, set "reps" larger than 200.
set.seed(20240201)
n &lt;- 100
func &lt;- function(X, theta) theta[1] + theta[2]*X
Sig &lt;- rWishart(1, df = n, Sigma = diag(n))[,,1]
theta &lt;- c(2,5)
X &lt;- matrix(rexp(n, rate = 1))
cdfr &lt;- compare(true_mean = func, true_X = X, true_covariance = list(Sigma = Sig),
                test_mean = func, X = X, covariance = list(Sigma = Sig), reps = 200,
                prog = Inf, theta = theta, theta_init = rep(1, length(theta)))

rejection(cdfr)
rejection(cdfr, stat = "CvM")
rejection(cdfr, alpha = c(0.1, 0.2))
</code></pre>

<hr>
<h2 id='residuals.distfreereg'>
Extract Residuals from <code>distfreereg</code> Objects
</h2><span id='topic+residuals.distfreereg'></span>

<h3>Description</h3>

<p>This is a <code><a href="stats.html#topic+residuals">residuals</a></code> method for objects of class <code>distfreereg</code>. It can extract any of the three available types of residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'distfreereg'
residuals(object, ..., type = "raw")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.distfreereg_+3A_object">object</code></td>
<td>

<p>Object of class <code>distfreereg</code>.
</p>
</td></tr>
<tr><td><code id="residuals.distfreereg_+3A_...">...</code></td>
<td>

<p>Additional parameters passed to or from other methods. Currently ignored.
</p>
</td></tr>
<tr><td><code id="residuals.distfreereg_+3A_type">type</code></td>
<td>

<p>Character string specifying the type of residuals to return. Must be one of
&quot;<code>raw</code>&quot;, &quot;<code>sphered</code>&quot;, and &quot;<code>transformed</code>&quot;.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of residuals.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>
</p>

<hr>
<h2 id='update.distfreereg'>
Update <code>distfreereg</code> Objects
</h2><span id='topic+update.distfreereg'></span>

<h3>Description</h3>

<p>This is an <code><a href="stats.html#topic+update">update</a></code> method for objects of class <code>distfreereg</code>. The method takes advantage of the <code>override</code> argument of <code><a href="#topic+distfreereg">distfreereg</a></code> to prevent unnecessary recalculation of potentially computationally expensive objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'distfreereg'
update(object, ..., smart = TRUE, envir = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update.distfreereg_+3A_object">object</code></td>
<td>

<p>Object of class <code>distfreereg</code>.
</p>
</td></tr>
<tr><td><code id="update.distfreereg_+3A_...">...</code></td>
<td>

<p>Additional named parameters to pass to <code><a href="#topic+distfreereg">distfreereg</a></code>.
</p>
</td></tr>
<tr><td><code id="update.distfreereg_+3A_smart">smart</code></td>
<td>

<p>Logical. If <code>TRUE</code>, then saved values from <code>object</code> are passed to <code><a href="#topic+distfreereg">distfreereg</a></code> using the <code>override</code> argument, when they need not themselves be updated. See details.
</p>
</td></tr>
<tr><td><code id="update.distfreereg_+3A_envir">envir</code></td>
<td>

<p>Environment passed to <code><a href="base.html#topic+eval">eval</a></code> when evaluating modified call.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function updates an object of class <code>distfreereg</code>. By default, it does so &quot;intelligently&quot; in the sense that it does not unnecessarily recompute elements that are already saved in <code>object</code>. For example, if a new value for <code>covariance</code> is not included in <code>...</code>, then the value of <code>covariance</code> saved in <code>object</code> is automatically passed to the new call, preventing recalculating <code>Q</code>. If a new value of <code>covariance</code> is specified, then all objects dependent on that (e.g., <code class="reqn">\hat\theta</code>) are recomputed.
</p>
<p>In particular, the simulated samples depend on the data and function only through the number of observations, the covariates (if any), and the dimension of the parameter space of the function. If none of these change, then the updated object reuses the simulated samples from the supplied <code>object</code>.
</p>
<p>The price we pay for this efficiency is a potentially &quot;large&quot; value of <code>call</code> in the updated object.
</p>


<h3>Value</h3>

<p>An updated object of class <code>distfreereg</code>.
</p>


<h3>Note</h3>

<p>The default behavior of <code><a href="stats.html#topic+update">update</a></code> is to create an updated call and then evaluate that call. This means, among other things, that a call to <code><a href="stats.html#topic+update">update</a></code> made after one of the arguments in the original call is modified will use the modified version of that argument. This is not always true for <code>update.distfreereg</code>. Values for the override arguments are drawn from the <code>distfreereg</code> object itself, not from any objects used as values for the original call to <code><a href="#topic+distfreereg">distfreereg</a></code>.
</p>
<p>In general, an object created by <code>update.distfreereg</code> will therefore not be <code><a href="base.html#topic+identical">identical</a></code> to the object created by <code><a href="#topic+distfreereg">distfreereg</a></code> using corresponding arguments, because the <code>call</code> values will differ.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20240218)
n &lt;- 1e2
func &lt;- function(X, theta) X[,1]^theta[1] + theta[2]*X[,2]
Sig &lt;- runif(n, min = 1, max = 3)
theta &lt;- c(2,5)
X &lt;- matrix(runif(2*n, min = 1, max = 5), nrow = n)
Y &lt;- X[,1]^theta[1] + theta[2]*X[,2] + rnorm(n, sd = sqrt(Sig))
dfr_1 &lt;- distfreereg(Y = Y, X = X, test_mean = func,
                     covariance = list(Sigma = Sig),
                     theta_init = c(1,1))

func_updated &lt;- function(X, theta) X[,1]^theta[1] + theta[2]*X[,2]^2
dfr_2 &lt;- update(dfr_1, test_mean = func_updated)

# The following are identical, since the Monte Carlo simulation did not need to
# be rerun for dfr_2, and was therefore copied from dfr_1.
identical(dfr_1$mcsim_stats, dfr_2$mcsim_stats)
</code></pre>

<hr>
<h2 id='vcov.distfreereg'>
Calculate Covariance Matrices from <code>distfreereg</code> Objects
</h2><span id='topic+vcov.distfreereg'></span>

<h3>Description</h3>

<p>This is a <code><a href="stats.html#topic+vcov">vcov</a></code> method for objects of class <code>distfreereg</code>. It calculates an estimated covariance matrix of the estimated parameters in a model from a <code>distfreereg</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'distfreereg'
vcov(object, ..., jacobian_args, hessian_args)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.distfreereg_+3A_object">object</code></td>
<td>

<p>Object of class <code>distfreereg</code>.
</p>
</td></tr>
<tr><td><code id="vcov.distfreereg_+3A_...">...</code></td>
<td>

<p>Additional parameters passed to other methods when <code>test_mean</code> element of <code>object</code> is not of class <code>function</code>.
</p>
</td></tr>
<tr><td><code id="vcov.distfreereg_+3A_jacobian_args">jacobian_args</code>, <code id="vcov.distfreereg_+3A_hessian_args">hessian_args</code></td>
<td>

<p>Lists of additional arguments to pass to <code><a href="numDeriv.html#topic+jacobian">jacobian</a></code> and <code><a href="numDeriv.html#topic+hessian">hessian</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the <code>test_mean</code> element of <code>object</code> is of class <code>function</code>, the covariance matrix is estimated using the method described in section 5.3 of <cite>Van der Vaart (1998)</cite>. Otherwise, <code>test_mean</code> is of a class that has its own method for <code><a href="stats.html#topic+vcov">vcov</a></code>, which is used to calculate the output.
</p>


<h3>Value</h3>

<p>Named numeric matrix equal to the estimated covariance matrix of the parameter estimates from <code>object</code>.
</p>


<h3>Warning</h3>

<p>This calculation can be computationally intensive when the sample size is large and <code>object$test_mean</code> is a function.
</p>


<h3>Note</h3>

<p>If <code>object</code> was created by calling <code><a href="#topic+distfreereg.default">distfreereg.default</a></code> directly, there is no estimated parameter vector, and therefore <code>vcov.distfreereg</code> does not apply.
</p>


<h3>Author(s)</h3>

<p>Jesse Miller
</p>


<h3>References</h3>

<p>Vaart, A. W. <strong>Asymptotic statistics</strong>, 2007, <em>Cambridge series on statistical and probabilistic mathematics</em>, Cambridge University Press.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+distfreereg">distfreereg</a></code>, <code><a href="#topic+confint.distfreereg">confint.distfreereg</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
