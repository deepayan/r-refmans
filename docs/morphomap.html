<!DOCTYPE html><html><head><title>Help for package morphomap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {morphomap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Ex_mpShapeList'><p>example dataset</p></a></li>
<li><a href='#HomFem38023'><p>example dataset</p></a></li>
<li><a href='#morphomap-package'><p>2D and 3D cortical thickness maps and cross sectional geometry</p></a></li>
<li><a href='#morphomap2Dmap'><p>morphomap2Dmap</p></a></li>
<li><a href='#morphomap3Dmap'><p>morphomap3Dmap</p></a></li>
<li><a href='#morphomapAlignment'><p>morphomapAlignment</p></a></li>
<li><a href='#morphomapArea'><p>morphomapArea</p></a></li>
<li><a href='#morphomapArray2matrix'><p>morphomapArray2matrix</p></a></li>
<li><a href='#morphomapCentroid'><p>morphomapCentroid</p></a></li>
<li><a href='#morphomapCheck'><p>morphomapCheck</p></a></li>
<li><a href='#morphomapCircle'><p>morphomapCircle</p></a></li>
<li><a href='#morphomapCore'><p>morphomapCore</p></a></li>
<li><a href='#morphomapCSG'><p>morphomapCSG</p></a></li>
<li><a href='#morphomapDF'><p>morphomapDF</p></a></li>
<li><a href='#morphomapExport'><p>morphomapExport</p></a></li>
<li><a href='#morphomapFlip'><p>morphomapFlip</p></a></li>
<li><a href='#morphomapImport'><p>morphomapImport</p></a></li>
<li><a href='#morphomapMatrix2array'><p>morphomapMatrix2array</p></a></li>
<li><a href='#morphomapMirror'><p>morphomapMirror</p></a></li>
<li><a href='#morphomapMoment'><p>morphomapMoment</p></a></li>
<li><a href='#morphomapPCA'><p>morphomapPCA</p></a></li>
<li><a href='#morphomapPic'><p>morphomapPic</p></a></li>
<li><a href='#morphomapPlotShape'><p>morphomapPlotShape</p></a></li>
<li><a href='#morphomapReadMorphologika'><p>morphomapReadMorphologika</p></a></li>
<li><a href='#morphomapRectangle'><p>morphomapRectangle</p></a></li>
<li><a href='#morphomapRegradius'><p>morphomapRegradius</p></a></li>
<li><a href='#morphomapSegm'><p>morphomapSegm</p></a></li>
<li><a href='#morphomapShape'><p>morphomapShape</p></a></li>
<li><a href='#morphomapSort'><p>morphomapSort</p></a></li>
<li><a href='#morphomapThickness'><p>morphomapThickness</p></a></li>
<li><a href='#morphomapTranslate'><p>morphomapTranslate</p></a></li>
<li><a href='#morphomapTri2sects'><p>morphomapTri2sects</p></a></li>
<li><a href='#morphomapTriangulate'><p>morphomapTriangulate</p></a></li>
<li><a href='#morphomapVariations'><p>morphomapVariations</p></a></li>
<li><a href='#morphomapWriteMorphologika'><p>morphomapWriteMorphologika</p></a></li>
<li><a href='#morphomapZmoment'><p>morphomapZmoment</p></a></li>
<li><a href='#PanFem27713'><p>example dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Morphometric Maps, Bone Landmarking and Cross Sectional Geometry</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Extract cross sections from long bone meshes at specified intervals along the diaphysis. Calculate two and three-dimensional morphometric maps, cross-sectional geometric parameters, and semilandmarks on the periosteal and endosteal contours of each cross section. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Arothron (&ge; 1.0), lattice (&ge; 0.2), mgcv (&ge; 1.8), Rvcg (&ge;
0.18), Morpho (&ge; 2.0), oce (&ge; 1.1), sp (&ge; 1.3), geometry (&ge;
0.4.0), rgl (&ge; 0.1), colorRamps (&ge; 2.3), DescTools (&ge; 0.99),
grDevices (&ge; 3.5), graphics (&ge; 3.5)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-09 17:35:50 UTC; anton</td>
</tr>
<tr>
<td>Author:</td>
<td>Antonio Profico [aut, cre],
  Luca Bondioli [aut],
  Pasquale Raia [aut],
  Julien Claude [ctb],
  Paul O'Higgins [aut],
  Damiano Marchi [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Antonio Profico &lt;antonio.profico@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-09 18:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Ex_mpShapeList'>example dataset</h2><span id='topic+Ex_mpShapeList'></span>

<h3>Description</h3>

<p>morphomapShape objects from 5 femora
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Ex_mpShapeList)
</code></pre>


<h3>Author(s)</h3>

<p>Antonio Profico
</p>

<hr>
<h2 id='HomFem38023'>example dataset</h2><span id='topic+HomFem38023'></span>

<h3>Description</h3>

<p>3D mesh of a human femur bone
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HomFem38023)
</code></pre>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>

<hr>
<h2 id='morphomap-package'>2D and 3D cortical thickness maps and cross sectional geometry</h2><span id='topic+morphomap-package'></span><span id='topic+morphomap'></span>

<h3>Description</h3>

<p>Tool to process long bone meshes (shape data, morphometric maps and cross-sectional geometry)
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>

<hr>
<h2 id='morphomap2Dmap'>morphomap2Dmap</h2><span id='topic+morphomap2Dmap'></span>

<h3>Description</h3>

<p>Create a 2D cortical thickness map
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomap2Dmap(
  morphomap.shape,
  rem.out = FALSE,
  fac.out = 0.5,
  smooth = FALSE,
  scale = TRUE,
  smooth.iter = 5,
  gamMap = FALSE,
  nrow = 90,
  ncol = 100,
  gdl = 250,
  method = "equiangular",
  unwrap = "A",
  plot = TRUE,
  pal = blue2green2red(101),
  aspect = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomap2Dmap_+3A_morphomap.shape">morphomap.shape</code></td>
<td>
<p>list: output from morphomapShape function</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_rem.out">rem.out</code></td>
<td>
<p>logical: if TRUE the outlier will be removed</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_fac.out">fac.out</code></td>
<td>
<p>numeric: parameter to set the threshold in outliers detection</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_smooth">smooth</code></td>
<td>
<p>logical: if TRUE a smooth filter is applied</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_scale">scale</code></td>
<td>
<p>logical: if TRUE the thichkness matrix is scaled from 0 to 1</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_smooth.iter">smooth.iter</code></td>
<td>
<p>numeric: number of smoothing iterations</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_gammap">gamMap</code></td>
<td>
<p>logical: if TRUE gam smoothing is applied</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_nrow">nrow</code></td>
<td>
<p>numeric: number of rows for gam smoothing</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_ncol">ncol</code></td>
<td>
<p>numeric: number of columns for gam smoothing</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_gdl">gdl</code></td>
<td>
<p>numeric: number of degree of freedom for gam smoothing</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_method">method</code></td>
<td>
<p>character: if set on &quot;equiangular&quot; the cortical thickness is meant as the distance of the segment intersecting the external and internal outline starting from the centroid of the section. If set on &quot;closest&quot; the cortical thickness is calculated at each point as the closest distance between external and internal outlines</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_unwrap">unwrap</code></td>
<td>
<p>character: starting qaudrant to unwrap the diaphysis (&quot;A&quot;=anterior, &quot;L&quot;=lateral, &quot;P&quot;=posterior, &quot;M&quot;=mesial)</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_plot">plot</code></td>
<td>
<p>logical: if TRUE the 2D morphometric map is plotted</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_pal">pal</code></td>
<td>
<p>character vector: colors to be used in the map production</p>
</td></tr>
<tr><td><code id="morphomap2Dmap_+3A_aspect">aspect</code></td>
<td>
<p>numeric: axis ratio for 2D morphometric map</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe dataframe for colormap production
</p>
<p>2Dmap thickness color map
</p>
<p>gamoutput output from GAM
</p>
<p>data input used to build the GAM map
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()){
library(colorRamps)
#morphomap on a human femur bone
data(HomFem38023)
meshes&lt;-morphomapSegm(HomFem38023, param1=4)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-380.23
rawSections&lt;-morphomapCore(out.sur=perMesh,
inn.sur=endMesh,num.sect=61,mech.len = mech_length, start = 0.2,end=0.8)
shapeSections&lt;-morphomapShape(rawSections,24,sects_vector=NULL,cent.out="CCA",
delta=0.1, side="left")

#built 2D morphometric map without GAM smoothing
bone2Dmap&lt;-morphomap2Dmap(morphomap.shape=shapeSections,
                          plot = TRUE, rem.out = TRUE,fac.out = 1.0, pal = blue2green2red(101),
                          aspect=2)
#built 2D morphometric map with GAM smoothing
bone2Dmap&lt;-morphomap2Dmap(morphomap.shape=shapeSections,gam=TRUE,
                          plot = TRUE, rem.out = TRUE,fac.out = 1.0, pal = blue2green2red(101),
                          aspect=2)

#morphomap on a chimpanzee femur bone
data(PanFem27713)
meshes&lt;-morphomapSegm(PanFem27713, param1=3)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-277.13
rawSections&lt;-morphomapCore(out.sur=perMesh,
                           inn.sur=endMesh,num.sect=61,mech.len = mech_length, start = 0.2,end=0.8)
shapeSections&lt;-morphomapShape(rawSections,24,sects_vector=NULL,cent.out="CCA",
delta=0.1, side="left")
#built 2D morphometric map without GAM smoothing
bone2Dmap&lt;-morphomap2Dmap(morphomap.shape=shapeSections,plot = TRUE, 
rem.out = TRUE,fac.out = 1.0,pal = blue2green2red(101),aspect=2)
#built 2D morphometric map with GAM smoothing
bone2Dmap&lt;-morphomap2Dmap(morphomap.shape=shapeSections,gam=TRUE,
                          plot = TRUE, rem.out = TRUE,fac.out = 1.0,pal = blue2green2red(101),
                          aspect=2)
}
</code></pre>

<hr>
<h2 id='morphomap3Dmap'>morphomap3Dmap</h2><span id='topic+morphomap3Dmap'></span>

<h3>Description</h3>

<p>Plot a 3D thickness map in four different anatomical views
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomap3Dmap(
  morphomap.shape,
  out.sur,
  method = "equiangular",
  scale = TRUE,
  rem.out = FALSE,
  fac.out = 0.5,
  smooth = FALSE,
  smooth.iter = 5,
  k = 5,
  plot = TRUE,
  pal = blue2green2red(101)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomap3Dmap_+3A_morphomap.shape">morphomap.shape</code></td>
<td>
<p>list: output from morphomapShape function</p>
</td></tr>
<tr><td><code id="morphomap3Dmap_+3A_out.sur">out.sur</code></td>
<td>
<p>3D mesh: 3D mesh of the long bone</p>
</td></tr>
<tr><td><code id="morphomap3Dmap_+3A_method">method</code></td>
<td>
<p>character: if set on &quot;equiangular&quot; the cortical thickness is meant as the distance of the segment intersecting the external and internal outline starting from the centroid of the section. If set on &quot;closest&quot; the cortical thickness is calculated at each point as the closest distance between external and internal outlines</p>
</td></tr>
<tr><td><code id="morphomap3Dmap_+3A_scale">scale</code></td>
<td>
<p>logical: if TRUE the cortical thickness matrix will be scaled from 0 to 1</p>
</td></tr>
<tr><td><code id="morphomap3Dmap_+3A_rem.out">rem.out</code></td>
<td>
<p>logical: if TRUE outliers are identified and removed from thickness matrix</p>
</td></tr>
<tr><td><code id="morphomap3Dmap_+3A_fac.out">fac.out</code></td>
<td>
<p>numeric: parameter to set the threshold in outliers detection</p>
</td></tr>
<tr><td><code id="morphomap3Dmap_+3A_smooth">smooth</code></td>
<td>
<p>logical: if TRUE the smoothing filter is applied on the thickness matrix</p>
</td></tr>
<tr><td><code id="morphomap3Dmap_+3A_smooth.iter">smooth.iter</code></td>
<td>
<p>numeric: number of smoothing iterations</p>
</td></tr>
<tr><td><code id="morphomap3Dmap_+3A_k">k</code></td>
<td>
<p>integer: neighbourhood of kd-tree to search the nearest semilandmarks to each vertex</p>
</td></tr>
<tr><td><code id="morphomap3Dmap_+3A_plot">plot</code></td>
<td>
<p>logical: if TRUE the 3D map is plotted</p>
</td></tr>
<tr><td><code id="morphomap3Dmap_+3A_pal">pal</code></td>
<td>
<p>character vector: colors to be used in the map production</p>
</td></tr>
</table>


<h3>Value</h3>

<p>cols color associated at each vertex of 3D mesh
</p>
<p>thickmat thickness matrix after smoothing and outliers removal
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
#morphomap on a human femur bone
data(HomFem38023)
meshes&lt;-morphomapSegm(HomFem38023, param1=4)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-380.23
rawSections&lt;-morphomapCore(out.sur=perMesh,
inn.sur=endMesh,num.sect=61,
mech.len = mech_length,param1 = 0.5,
radius.fact = 2.5,npovs = 100,clean_int_out = TRUE,
num.points = 500, start = 0.2,end=0.8)
shapeSections&lt;-morphomapShape(rawSections,24,sects_vector=NULL,cent.out="CCA",
delta=0.1, side="left")

#built 3D morphometric map 
bone3Dmap&lt;-morphomap3Dmap(shapeSections, out.sur=perMesh,
                          plot = TRUE,rem.out=TRUE,
                          fac.out=1.5,smooth=TRUE,
                          smooth.iter=5)
#or
require(rgl)
rgl::open3d()
rgl::shade3d(perMesh,col=bone3Dmap$cols,specular="black")

#morphomap on a chimpanzee femur bone
data(PanFem27713)
meshes&lt;-morphomapSegm(PanFem27713, param1=3)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-277.13
rawSections&lt;-morphomapCore(out.sur=perMesh,
                           inn.sur=endMesh,num.sect=61,mech.len = mech_length, 
                           start = 0.2,end=0.8)
shapeSections&lt;-morphomapShape(rawSections,24,sects_vector=NULL,cent.out="CCA",
delta=0.1, side="left")
#built 3D morphometric map 
bone3Dmap&lt;-morphomap3Dmap(shapeSections, out.sur=perMesh,
                          plot = TRUE,rem.out=TRUE,
                          fac.out=1.5,smooth=TRUE,
                          smooth.iter=5)
#or
require(rgl)
rgl::open3d()
rgl::shade3d(perMesh,col=bone3Dmap$cols,specular="black")
}
</code></pre>

<hr>
<h2 id='morphomapAlignment'>morphomapAlignment</h2><span id='topic+morphomapAlignment'></span>

<h3>Description</h3>

<p>Align a femur bone following the protocol proposed by Ruff (2002)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapAlignment(
  mesh,
  set,
  side = c("left", "right"),
  param1 = 4,
  iter1 = 2000,
  iter2 = 2000,
  iter3 = 2000,
  from1 = 180,
  to1 = 360,
  from2 = -5,
  to2 = 5,
  from3 = -5,
  to3 = 5,
  tol = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapAlignment_+3A_mesh">mesh</code></td>
<td>
<p>3D mesh: femur long bone mesh</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_set">set</code></td>
<td>
<p>matrix: 7 landmarks acquired on the mesh (see details)</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_side">side</code></td>
<td>
<p>character: specify if the femur bone is &quot;left&quot; or &quot;right&quot; side</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_param1">param1</code></td>
<td>
<p>numeric: parameter for spherical flipping (usually ranged between 3 and 4)</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_iter1">iter1</code></td>
<td>
<p>numeric: number of iterations first alignment</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_iter2">iter2</code></td>
<td>
<p>numeric: number of iterations second alignment</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_iter3">iter3</code></td>
<td>
<p>numeric: number of iterations third alignment</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_from1">from1</code></td>
<td>
<p>numeric: inferior range of the allowed rotation in the first alignment</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_to1">to1</code></td>
<td>
<p>numeric: superior range of the allowed rotation in the first alignment</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_from2">from2</code></td>
<td>
<p>numeric: inferior range of the allowed rotation in the second alignment</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_to2">to2</code></td>
<td>
<p>numeric: superior range of the allowed rotation in the second alignment</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_from3">from3</code></td>
<td>
<p>numeric: inferior range of the allowed rotation in the third alignment</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_to3">to3</code></td>
<td>
<p>numeric: superior range of the allowed rotation in the third alignment</p>
</td></tr>
<tr><td><code id="morphomapAlignment_+3A_tol">tol</code></td>
<td>
<p>numeric: maximum allowed error in the alignment expressed in mm</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function 'morphomapAlignment' is designed to align a femur bone. I did not tested on other long bones. 
The function requires 7 anatomical landmarks samples as follow: 1-the point at the center of the diaphysis in posterior view after the less trochanter, 
2- the most posterior point on the lateral epicondyle, 3-the most posterior point on the medial epicondyle, 4- the most inferior point on the intercondilar fossa,
5- neck of the femur, 6- the most inferior point on the medial epicondyle and 7-the most inferior point on the lateral epicondyle. 
If the function in a short time does not complete the alignement, please stop the R session, check your landmark configuration or try to increase the value of the argument 'tol'.
</p>


<h3>Value</h3>

<p>sur: mesh of the aligned femur bone
</p>
<p>coo: coordinates of the landmark used in the alignment (plus two added automatically)
</p>
<p>mech_length: mechanical length of the aligned femur bone
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>

<hr>
<h2 id='morphomapArea'>morphomapArea</h2><span id='topic+morphomapArea'></span>

<h3>Description</h3>

<p>Shoelace formula to calculate the area of a closed outline
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapArea(p, delta = 0.1, method = "shoelace")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapArea_+3A_p">p</code></td>
<td>
<p>matrix: kx2 matrix</p>
</td></tr>
<tr><td><code id="morphomapArea_+3A_delta">delta</code></td>
<td>
<p>numeric: picture elements of adjustable side length</p>
</td></tr>
<tr><td><code id="morphomapArea_+3A_method">method</code></td>
<td>
<p>character: the user can choice to calculate the area applying the &quot;shoelace&quot; formula or discretizing the cross sections in dA areas (method = &quot;delta&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ar numeric: area
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extsec&lt;-morphomapCircle(10,100)
#shoelace method
area&lt;-morphomapArea(extsec, method="shoelace")
#delta method
area&lt;-morphomapArea(extsec, method="delta",delta=0.01)
</code></pre>

<hr>
<h2 id='morphomapArray2matrix'>morphomapArray2matrix</h2><span id='topic+morphomapArray2matrix'></span>

<h3>Description</h3>

<p>Convert an array into a matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapArray2matrix(array)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapArray2matrix_+3A_array">array</code></td>
<td>
<p>an array</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mat a matrix
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>

<hr>
<h2 id='morphomapCentroid'>morphomapCentroid</h2><span id='topic+morphomapCentroid'></span>

<h3>Description</h3>

<p>Calculate the barycenter of the cortical area
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapCentroid(cp, mp, delta = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapCentroid_+3A_cp">cp</code></td>
<td>
<p>matrix: coordinates of the external outline of the section</p>
</td></tr>
<tr><td><code id="morphomapCentroid_+3A_mp">mp</code></td>
<td>
<p>matrix: coordinates of the internal outline of the section</p>
</td></tr>
<tr><td><code id="morphomapCentroid_+3A_delta">delta</code></td>
<td>
<p>numeric: picture elements of adjustable side length</p>
</td></tr>
</table>


<h3>Value</h3>

<p>centroid numeric vector: coordinates of the cortical area
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extsec&lt;-morphomapCircle(10,100)
intsec&lt;-morphomapCircle(8,100)
plot(extsec,asp=1,type="l")
points(intsec,col=2,type="l")
cent&lt;-morphomapCentroid(extsec,intsec,delta = 0.1)  
points(cent[1],cent[2],pch=19,col=3)
</code></pre>

<hr>
<h2 id='morphomapCheck'>morphomapCheck</h2><span id='topic+morphomapCheck'></span>

<h3>Description</h3>

<p>Plot the long bone mesh to check the orientation of the long bone
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapCheck(mesh, col = "white")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapCheck_+3A_mesh">mesh</code></td>
<td>
<p>3D mesh: long bone 3D model</p>
</td></tr>
<tr><td><code id="morphomapCheck_+3A_col">col</code></td>
<td>
<p>character: color mesh</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(morphomap)
data(HomFem38023)
morphomapCheck(HomFem38023)

</code></pre>

<hr>
<h2 id='morphomapCircle'>morphomapCircle</h2><span id='topic+morphomapCircle'></span>

<h3>Description</h3>

<p>Define a circular outline
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapCircle(r = 1, n = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapCircle_+3A_r">r</code></td>
<td>
<p>numeric: radius of the outline</p>
</td></tr>
<tr><td><code id="morphomapCircle_+3A_n">n</code></td>
<td>
<p>numeric: number of points along the outline</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mat matrix with coordinates
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extsec&lt;-morphomapCircle(10,100)
intsec&lt;-morphomapCircle(8,100)
plot(extsec,asp=1,type="l")
points(intsec,type="l",col=2)
</code></pre>

<hr>
<h2 id='morphomapCore'>morphomapCore</h2><span id='topic+morphomapCore'></span>

<h3>Description</h3>

<p>Tool to build 3D and 2D cross sections
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapCore(
  out.sur = out.sur,
  inn.sur = inn.sur,
  num.sect = 61,
  mech.len,
  clean_int_out = TRUE,
  param1 = 0.5,
  radius.fact = 2.5,
  npovs = 100,
  num.points = 500,
  start = 0.2,
  end = 0.8,
  print.progress = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapCore_+3A_out.sur">out.sur</code></td>
<td>
<p>object of class mesh3d</p>
</td></tr>
<tr><td><code id="morphomapCore_+3A_inn.sur">inn.sur</code></td>
<td>
<p>object of class mesh3d</p>
</td></tr>
<tr><td><code id="morphomapCore_+3A_num.sect">num.sect</code></td>
<td>
<p>number of sections</p>
</td></tr>
<tr><td><code id="morphomapCore_+3A_mech.len">mech.len</code></td>
<td>
<p>mechanical length of the long bone</p>
</td></tr>
<tr><td><code id="morphomapCore_+3A_clean_int_out">clean_int_out</code></td>
<td>
<p>logical if TRUE the inner section will be cleaned by using spherical flipping</p>
</td></tr>
<tr><td><code id="morphomapCore_+3A_param1">param1</code></td>
<td>
<p>numeric parameter for spherical flipping operator (how much the section will be deformed)</p>
</td></tr>
<tr><td><code id="morphomapCore_+3A_radius.fact">radius.fact</code></td>
<td>
<p>numeric parameter for spherical flipping operator (distance from the center of the outline at which the povs are defined)</p>
</td></tr>
<tr><td><code id="morphomapCore_+3A_npovs">npovs</code></td>
<td>
<p>numeric: number of points of view defined around the section</p>
</td></tr>
<tr><td><code id="morphomapCore_+3A_num.points">num.points</code></td>
<td>
<p>number of equiengular points to be defined on each section</p>
</td></tr>
<tr><td><code id="morphomapCore_+3A_start">start</code></td>
<td>
<p>percentage of the mechanical length from which the first section is defined</p>
</td></tr>
<tr><td><code id="morphomapCore_+3A_end">end</code></td>
<td>
<p>percentage of the mechanical length from which the last section is defined</p>
</td></tr>
<tr><td><code id="morphomapCore_+3A_print.progress">print.progress</code></td>
<td>
<p>logical: if TRUE a progress bar is printed to the screen</p>
</td></tr>
</table>


<h3>Value</h3>

<p>3D_out num.pointsx3xnum.sect array of the external outlines
</p>
<p>3D_inn num.pointsx3xnum.sect array of the internal outlines
</p>
<p>2D_out num.pointsx2xnum.sect array of the external outlines
</p>
<p>2D_inn num.pointsx2xnum.sect array of the internal outlines
</p>
<p>mech_length mechanical length of the long bone
</p>
<p>start percentage of the mechanical length from which the first section is defined
</p>
<p>end percentage of the mechanical length from which the last section is defined
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
#raw section on a human femur bone
data(HomFem38023)
meshes&lt;-morphomapSegm(HomFem38023, param1=4)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-380.23
rawSections&lt;-morphomapCore(out.sur=perMesh,
                           inn.sur=endMesh,num.sect=61,mech.len = mech_length,
                           start = 0.2,end=0.8)
#2D plot of the first section
plot(rawSections$`2D_out`[,,1],col="grey",asp=1,xlab="x",ylab="y",type="l")
points(rawSections$`2D_inn`[,,1],col="red",type="l")
#3D plot of the first section
require(rgl)
rgl::open3d()
rgl::plot3d(rawSections$`3D_out`[,,1],aspect=FALSE,col="grey",
type="l",lwd=5,xlab="x",ylab="y",zlab="z")
rgl::plot3d(rawSections$`3D_inn`[,,1],aspect=FALSE,col="red",
type="l",lwd=5,add=TRUE)

#raw section on a chimpanzee femur bone
data(PanFem27713)
meshes&lt;-morphomapSegm(PanFem27713, param1=3)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-277.13
rawSections&lt;-morphomapCore(out.sur=perMesh,
                           inn.sur=endMesh,num.sect=61,mech.len = mech_length,
                           start = 0.2,end=0.8)
#2D plot of the first section
plot(rawSections$`2D_out`[,,1],col="grey",asp=1,xlab="x",ylab="y",type="l")
points(rawSections$`2D_inn`[,,1],col="red",type="l")
#3D plot of the first section
require(rgl)
rgl::open3d()
rgl::plot3d(rawSections$`3D_out`[,,1],aspect=FALSE,col="grey",
type="l",lwd=5,xlab="x",ylab="y",zlab="z")
rgl::plot3d(rawSections$`3D_inn`[,,1],aspect=FALSE,col="red",
type="l",lwd=5,add=TRUE)
}
</code></pre>

<hr>
<h2 id='morphomapCSG'>morphomapCSG</h2><span id='topic+morphomapCSG'></span>

<h3>Description</h3>

<p>Tool for Cross-sectional geometry
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapCSG(
  cp,
  mp,
  translate = FALSE,
  center = c("I", "E", "CCA"),
  delta = 0.1,
  Cx = NULL,
  Cy = NULL,
  I_xy = TRUE,
  I_minmax = TRUE,
  Zxy = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapCSG_+3A_cp">cp</code></td>
<td>
<p>matrix: coordinates of the external outline</p>
</td></tr>
<tr><td><code id="morphomapCSG_+3A_mp">mp</code></td>
<td>
<p>matrix: coordinates of the internal outline</p>
</td></tr>
<tr><td><code id="morphomapCSG_+3A_translate">translate</code></td>
<td>
<p>logical: if TRUE the section will be centered</p>
</td></tr>
<tr><td><code id="morphomapCSG_+3A_center">center</code></td>
<td>
<p>how to define the center of each section. The method allowed are &quot;CCA&quot; (center of cortical area), &quot;E&quot; (barycenter of the external outline) and &quot;I&quot; (barycenter of the internal outline)</p>
</td></tr>
<tr><td><code id="morphomapCSG_+3A_delta">delta</code></td>
<td>
<p>numeric: picture elements of adjustable side length</p>
</td></tr>
<tr><td><code id="morphomapCSG_+3A_cx">Cx</code></td>
<td>
<p>numeric: new x center coordinate</p>
</td></tr>
<tr><td><code id="morphomapCSG_+3A_cy">Cy</code></td>
<td>
<p>numeric: new y center coordinate</p>
</td></tr>
<tr><td><code id="morphomapCSG_+3A_i_xy">I_xy</code></td>
<td>
<p>logical: if TRUE the product of inertia around the x and y axis is calculated</p>
</td></tr>
<tr><td><code id="morphomapCSG_+3A_i_minmax">I_minmax</code></td>
<td>
<p>logical: if TRUE the Imin and Imax will be calculated</p>
</td></tr>
<tr><td><code id="morphomapCSG_+3A_zxy">Zxy</code></td>
<td>
<p>logical: if TRUE the polar moment of inertia will be calculated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cx x coordinate of the centered section
</p>
<p>Cy y coordinate of the centered section
</p>
<p>T_area total area
</p>
<p>M_area medullar area
</p>
<p>CA cortical area
</p>
<p>Ext_perim external perimeter
</p>
<p>Med_perim medullar perimiter
</p>
<p>Mean_thick mean thickness of the section
</p>
<p>Sd_thick thickness standard deviation
</p>
<p>Min_thick minimum thickness
</p>
<p>Max_thick maximum thickness
</p>
<p>Ix numeric: moment of inertia around the x axis
</p>
<p>Iy numeric: moment of inertia around the y axis
</p>
<p>Zx numeric: moment of inertia around the x axis
</p>
<p>Zy numeric: moment of inertia around the y axis
</p>
<p>Zpol numeric: polar moment of inertia
</p>
<p>dx new centered coordinates of the internal outline
</p>
<p>dy new centered coordinates of the internal outline
</p>
<p>Imin numeric: minimum moment of inertia
</p>
<p>Imax numeric: maximum moment of inertia
</p>
<p>J numeric: polar moment of inertia
</p>
<p>Zmax numeric: the maximum polar section
</p>
<p>Zmin numeric: the minimum polar section
</p>
<p>theta numeric: theta angle
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#calculation of csg parameter on a human femur cross section
data(HomFem38023)
meshes&lt;-morphomapSegm(HomFem38023, param1=4)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-380.23
rawSections&lt;-morphomapCore(out.sur=perMesh,
                           inn.sur=endMesh,num.sect=61,mech.len = mech_length, 
                           start = 0.2,end=0.8)
shapeSections&lt;-morphomapShape(rawSections,250,sects_vector=NULL,cent.out="CCA",
delta=0.1, side="left")
csgSect31&lt;-morphomapCSG(cp = shapeSections$`2D_out`[,,31],
                        mp=shapeSections$`2D_inn`[,,31],
                        translate = FALSE,center="CCA")

#Cross sectional geometry along the entire femur bone
results&lt;-matrix(NA,ncol=24,nrow=61)
rownames(results)&lt;-paste("section",c(1:61))
colnames(results)&lt;-c("Cx","Cy","T_area","M_area","CA",
                     "Ext_perim","Med_perim","Mean_thick","Sd_thick" ,
                     "Min_thick","Max_thick","Ix","Iy","Zx" ,"Zy","Zpol" ,
                     "dx","dy","Imin","Imax","J","Zmax","Zmin","theta")

for(i in 1:61){
  results[i,]&lt;-unlist(morphomapCSG(cp = shapeSections$`2D_out`[,,i],
                                     mp=shapeSections$`2D_inn`[,,i],
                                   translate = FALSE,center="CCA",delta = 0.5))
}

plot(c(1:61),results[,24],type="b",main="Theta",cex=1,
     xlab="section",ylab="radians")


#calculation of csg parameter on a chimpanzee femur cross section
data(PanFem27713)
meshes&lt;-morphomapSegm(PanFem27713, param1=3)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-277.13
rawSections&lt;-morphomapCore(out.sur=perMesh,
                           inn.sur=endMesh,num.sect=61,mech.len = mech_length, 
                           start = 0.2,end=0.8)
shapeSections&lt;-morphomapShape(rawSections,250,sects_vector=NULL,cent.out="CCA",
delta=0.1, side="left")
csgSect31&lt;-morphomapCSG(cp = shapeSections$`2D_out`[,,31],
                        mp=shapeSections$`2D_inn`[,,31],
                        translate = FALSE,center="CCA")

#Cross sectional geometry along the entire femur bone
results&lt;-matrix(NA,ncol=24,nrow=61)
rownames(results)&lt;-paste("section",c(1:61))
colnames(results)&lt;-c("Cx","Cy","T_area","M_area","CA",
                     "Ext_perim","Med_perim","Mean_thick","Sd_thick" ,
                     "Min_thick","Max_thick","Ix","Iy","Zx" ,"Zy","Zpol" ,
                     "dx","dy","Imin","Imax","J","Zmax","Zmin","theta")

for(i in 1:61){
  results[i,]&lt;-unlist(morphomapCSG(cp = shapeSections$`2D_out`[,,i],
                                   mp=shapeSections$`2D_inn`[,,i],
                                   translate = FALSE,center="CCA",delta = 0.5))
  }

plot(c(1:61),results[,24],type="b",main="Theta",cex=1,
     xlab="section",ylab="radians")

</code></pre>

<hr>
<h2 id='morphomapDF'>morphomapDF</h2><span id='topic+morphomapDF'></span>

<h3>Description</h3>

<p>Tool to build a data.frame suitable for morphometric maps
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapDF(
  morphomap.thickness,
  rem.out = TRUE,
  fac.out = 0.5,
  smooth = TRUE,
  scale = TRUE,
  smooth.iter = 5,
  method = "equiangular",
  unwrap = "A"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapDF_+3A_morphomap.thickness">morphomap.thickness</code></td>
<td>
<p>list: morphomap.Thickness object</p>
</td></tr>
<tr><td><code id="morphomapDF_+3A_rem.out">rem.out</code></td>
<td>
<p>logical: if TRUE the outlier will be removed</p>
</td></tr>
<tr><td><code id="morphomapDF_+3A_fac.out">fac.out</code></td>
<td>
<p>numeric: parameter to set the threshold in outliers detection</p>
</td></tr>
<tr><td><code id="morphomapDF_+3A_smooth">smooth</code></td>
<td>
<p>logical: if TRUE the smooth algorithm is applied</p>
</td></tr>
<tr><td><code id="morphomapDF_+3A_scale">scale</code></td>
<td>
<p>logical: if TRUE the thichkness matrix is scaled from 0 to 1</p>
</td></tr>
<tr><td><code id="morphomapDF_+3A_smooth.iter">smooth.iter</code></td>
<td>
<p>numeric: number of smoothing iterations</p>
</td></tr>
<tr><td><code id="morphomapDF_+3A_method">method</code></td>
<td>
<p>character: if set on &quot;equiangular&quot; the cortical thickness is meant as the distance of the segment intersecting the external and internal outline starting from the centroid of the section. If set on &quot;closest&quot; the cortical thickness is calculated at each point as the closest distance between external and internal outlines</p>
</td></tr>
<tr><td><code id="morphomapDF_+3A_unwrap">unwrap</code></td>
<td>
<p>character: starting qaudrant to unwrap the diaphysis (&quot;A&quot;=anterior, &quot;L&quot;=lateral, &quot;P&quot;=posterior, &quot;M&quot;=mesial)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>XYZ data.frame for morphometric map
</p>
<p>labels character vector for x labels in the morphometric map
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(lattice)
library(colorRamps)
data(HomFem38023)
meshes&lt;-morphomapSegm(HomFem38023, param1=4)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-380.23
rawSections&lt;-morphomapCore(out.sur=perMesh,
                           inn.sur=endMesh,num.sect=61,mech.len = mech_length, 
                           start = 0.2,end=0.8)
shapeSections&lt;-morphomapShape(rawSections,21,sects_vector=NULL,cent.out="CCA",delta=0.1)
femthick&lt;-morphomapThickness(shapeSections)
dataDF&lt;-morphomapDF(femthick)$XYZ
contourplot(dataDF[, 3] ~ dataDF[, 1] + dataDF[, 2],
            col.regions=blue2green2red(101),region=TRUE,
            colorkey=list(at=seq(0,1,length.out = 100)),
            scales = list(x = list(at = seq(0,100,length.out = 5), c("A","M","P","L","A"), 
            alternating = 1)),asp=1.5,cuts=20,xlab="femur margin",ylab="biomechanical length")


</code></pre>

<hr>
<h2 id='morphomapExport'>morphomapExport</h2><span id='topic+morphomapExport'></span>

<h3>Description</h3>

<p>Export the output from ToothAlignement
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapExport(mpShapeObject, id, file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapExport_+3A_mpshapeobject">mpShapeObject</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapExport_+3A_id">id</code></td>
<td>
<p>character: label name</p>
</td></tr>
<tr><td><code id="morphomapExport_+3A_file">file</code></td>
<td>
<p>character: name the output file</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Antonio Profico
</p>

<hr>
<h2 id='morphomapFlip'>morphomapFlip</h2><span id='topic+morphomapFlip'></span>

<h3>Description</h3>

<p>Spherical flipping operator for bi-dimensional configuration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapFlip(mat, param1 = 0.8, param2 = 10, radius.fact = 1.5, npovs = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapFlip_+3A_mat">mat</code></td>
<td>
<p>numeric matrix: coordinates of the bi-dimensional configuration</p>
</td></tr>
<tr><td><code id="morphomapFlip_+3A_param1">param1</code></td>
<td>
<p>numeric: first parameter for spherical flipping</p>
</td></tr>
<tr><td><code id="morphomapFlip_+3A_param2">param2</code></td>
<td>
<p>numeric: second parameter for spherical flipping</p>
</td></tr>
<tr><td><code id="morphomapFlip_+3A_radius.fact">radius.fact</code></td>
<td>
<p>mechanical length of the long bone</p>
</td></tr>
<tr><td><code id="morphomapFlip_+3A_npovs">npovs</code></td>
<td>
<p>number of evenly spaced points to be defined on each section</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mat matrix after spherical flipping
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#create a section
extsec&lt;-morphomapCircle(10,1000)
intsec&lt;-morphomapCircle(8,1000)
#simulate noise 
noiseX&lt;-rnorm(1000,mean = 0,sd = 0.2)
noiseY&lt;-rnorm(1000,mean = 0,sd = 0.2)
noise&lt;-cbind(noiseX,noiseY)
noisect&lt;-intsec+noise
#spherical flipping
flipsect&lt;-morphomapFlip(noisect,param1 = 2,radius.fact = 2)
sortsect&lt;-morphomapSort(flipsect)
#original section
plot(extsec,asp=1,type="l",xlim=c(-15,15),ylim=c(-15,15))
points(intsec,asp=1,type="l",xlim=c(-15,15),ylim=c(-15,15))
#noise
points(noisect,col=2)
#new section after spherical flipping
points(sortsect,type="l",col=3,asp=1,lwd=2)
</code></pre>

<hr>
<h2 id='morphomapImport'>morphomapImport</h2><span id='topic+morphomapImport'></span>

<h3>Description</h3>

<p>Import a morphomapShape object exported with morphomapExport
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapImport(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapImport_+3A_file">file</code></td>
<td>
<p>character: name of input file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>3D_out num.pointsx3xnum.sect array in which the external outlines are stored
</p>
<p>3D_inn num.pointsx3xnum.sect array in which the internal outlines are stored
</p>
<p>2D_out num.pointsx2xnum.sect array in which the external outlines are stored
</p>
<p>2D_inn num.pointsx2xnum.sect array in which the interal outlines are stored
</p>
<p>ALPM_inn array with the coordinates of ALPM coordinates on the external outline
</p>
<p>ALPM_out array with the coordinates of ALPM coordinates on the internal outline
</p>
<p>mech_length mechanical length of the long bone
</p>
<p>start percentage of the mechanical length from which the first section is defined
</p>
<p>end percentage of the mechanical length from which the last section is defined
</p>


<h3>Author(s)</h3>

<p>Antonio Profico
</p>

<hr>
<h2 id='morphomapMatrix2array'>morphomapMatrix2array</h2><span id='topic+morphomapMatrix2array'></span>

<h3>Description</h3>

<p>Convert a matrix into an array
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapMatrix2array(matrix, nsects)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapMatrix2array_+3A_matrix">matrix</code></td>
<td>
<p>an array</p>
</td></tr>
<tr><td><code id="morphomapMatrix2array_+3A_nsects">nsects</code></td>
<td>
<p>number of cross sections</p>
</td></tr>
</table>


<h3>Value</h3>

<p>array an array
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>

<hr>
<h2 id='morphomapMirror'>morphomapMirror</h2><span id='topic+morphomapMirror'></span>

<h3>Description</h3>

<p>Mirror a long bone mesh along the yz plane
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapMirror(mesh)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapMirror_+3A_mesh">mesh</code></td>
<td>
<p>object of class mesh3d</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mesh: object of class mesh3d
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
#a left human femur bone
require(rgl)
data(HomFem38023)
lfem&lt;-HomFem38023
rfem&lt;-morphomapMirror(lfem)
rgl::open3d()
rgl::wire3d(lfem,col="green")
rgl::ire3d(rfem,col="red")
}
</code></pre>

<hr>
<h2 id='morphomapMoment'>morphomapMoment</h2><span id='topic+morphomapMoment'></span>

<h3>Description</h3>

<p>Calculate the moment of inertia around the x and y axes and the product of inertia
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapMoment(cp, mp, delta = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapMoment_+3A_cp">cp</code></td>
<td>
<p>matrix: coordinates of the external outline</p>
</td></tr>
<tr><td><code id="morphomapMoment_+3A_mp">mp</code></td>
<td>
<p>matrix: coordinates of the internal outline</p>
</td></tr>
<tr><td><code id="morphomapMoment_+3A_delta">delta</code></td>
<td>
<p>numeric: picture elements of adjustable side length</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Ix numeric: moment of inertia around the x axis
</p>
<p>Iy numeric: moment of inertia around the y axis
</p>
<p>Ixy numeric: product of inertia around the x and y axis
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#create a section
extsec&lt;-morphomapCircle(10,1000)
intsec&lt;-morphomapCircle(8,1000)
InMs&lt;-morphomapMoment(extsec,intsec,delta=0.1)
</code></pre>

<hr>
<h2 id='morphomapPCA'>morphomapPCA</h2><span id='topic+morphomapPCA'></span>

<h3>Description</h3>

<p>Calculate maps of cortical thickness and perform a Principal Component Analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapPCA(
  mpShapeList,
  gamMap = TRUE,
  nrow = 61,
  ncol = 24,
  rem.out = TRUE,
  scaleThick = FALSE,
  fac.out = 1.5,
  method = "equiangular",
  scalePCA = TRUE,
  unwrap = "A"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapPCA_+3A_mpshapelist">mpShapeList</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapPCA_+3A_gammap">gamMap</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapPCA_+3A_nrow">nrow</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapPCA_+3A_ncol">ncol</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapPCA_+3A_rem.out">rem.out</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapPCA_+3A_scalethick">scaleThick</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapPCA_+3A_fac.out">fac.out</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapPCA_+3A_method">method</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapPCA_+3A_scalepca">scalePCA</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapPCA_+3A_unwrap">unwrap</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
</table>


<h3>Value</h3>

<p>PCscores PC scores
</p>
<p>PCs loadings
</p>
<p>Variance Table of the explained Variance by the PCs
</p>
<p>meanMap mean morphometric map
</p>
<p>CorMaps morphometric maps
</p>


<h3>Author(s)</h3>

<p>Antonio Profico
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Ex_mpShapeList)
PCA&lt;-morphomapPCA(Ex_mpShapeList)
plot(PCA$PCscores)
barplot(PCA$Variance[,2])

</code></pre>

<hr>
<h2 id='morphomapPic'>morphomapPic</h2><span id='topic+morphomapPic'></span>

<h3>Description</h3>

<p>Save the sections defined via morphomapShape or morphomapCore
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapPic(
  morphomap.core,
  morphomap.shape,
  vector = NULL,
  full = TRUE,
  width = 1500,
  height = 1500,
  pointsize = 12,
  res = 300,
  colthk = "red",
  collbs = "blue",
  dirpath = tempdir()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapPic_+3A_morphomap.core">morphomap.core</code></td>
<td>
<p>list: morphomap.core object</p>
</td></tr>
<tr><td><code id="morphomapPic_+3A_morphomap.shape">morphomap.shape</code></td>
<td>
<p>list: morphomap.shape object</p>
</td></tr>
<tr><td><code id="morphomapPic_+3A_vector">vector</code></td>
<td>
<p>numeric: define which sections will be saved</p>
</td></tr>
<tr><td><code id="morphomapPic_+3A_full">full</code></td>
<td>
<p>logical: if TRUE the thickness at ALPM is reported</p>
</td></tr>
<tr><td><code id="morphomapPic_+3A_width">width</code></td>
<td>
<p>numeric: width of the picture</p>
</td></tr>
<tr><td><code id="morphomapPic_+3A_height">height</code></td>
<td>
<p>numeric: height of the picture</p>
</td></tr>
<tr><td><code id="morphomapPic_+3A_pointsize">pointsize</code></td>
<td>
<p>numeric: pointsize of plotted text</p>
</td></tr>
<tr><td><code id="morphomapPic_+3A_res">res</code></td>
<td>
<p>numeric: the nominal resolution in ppi which will be recorded</p>
</td></tr>
<tr><td><code id="morphomapPic_+3A_colthk">colthk</code></td>
<td>
<p>specify the color for the numbers</p>
</td></tr>
<tr><td><code id="morphomapPic_+3A_collbs">collbs</code></td>
<td>
<p>specify the color for the labels</p>
</td></tr>
<tr><td><code id="morphomapPic_+3A_dirpath">dirpath</code></td>
<td>
<p>character: path of the directory where the pictures will be saved</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#export picture from a human femur bone
data(HomFem38023)
meshes&lt;-morphomapSegm(HomFem38023, param1=4)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-380.23
rawSections&lt;-morphomapCore(out.sur=perMesh,
                           inn.sur=endMesh,num.sect=11,mech.len = mech_length, 
                           start = 0.2,end=0.8)
shapeSections&lt;-morphomapShape(rawSections,250,sects_vector=NULL,cent.out="CCA",
delta=0.5, side="left")
morphomapPic(rawSections,shapeSections,full=TRUE,dirpath=tempdir(),
            width=2500,height=2500)

#export picture from a chimpanzee femur bone
data(PanFem27713)
meshes&lt;-morphomapSegm(PanFem27713, param1=3)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-277.13
rawSections&lt;-morphomapCore(out.sur=perMesh,
                           inn.sur=endMesh,num.sect=11,mech.len = mech_length, 
                           start = 0.2,end=0.8)
shapeSections&lt;-morphomapShape(rawSections,250,sects_vector=NULL,cent.out="CCA",delta=0.5,
 side="left")
morphomapPic(rawSections,shapeSections,full=TRUE,dirpath=tempdir(),
             width=2500,height=2500)

</code></pre>

<hr>
<h2 id='morphomapPlotShape'>morphomapPlotShape</h2><span id='topic+morphomapPlotShape'></span>

<h3>Description</h3>

<p>Visualize 2D and 3D cross sections
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapPlotShape(
  Shape,
  dims = 3,
  col1 = "red",
  col2 = "green",
  colc = "orange",
  colr = "violet",
  coll1 = "darkred",
  coll2 = "darkgreen",
  size = 1.5,
  lwd = 0.7,
  colmesh1 = "red",
  colmesh2 = "green",
  alpha = 0.3,
  tri = TRUE,
  outlines = TRUE,
  points = TRUE,
  lines = FALSE,
  centroid = FALSE,
  cent.out = "CCA",
  delta = 0.1,
  vecs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapPlotShape_+3A_shape">Shape</code></td>
<td>
<p>list: output from morphomapShape function</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_dims">dims</code></td>
<td>
<p>numeric:  2 = bi-dimensional cross sections, 3 = three-dimensional cross sections</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_col1">col1</code></td>
<td>
<p>color of the external outline</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_col2">col2</code></td>
<td>
<p>color of the internal outline</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_colc">colc</code></td>
<td>
<p>color of the centroid of the cross section</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_colr">colr</code></td>
<td>
<p>color of the radii</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_coll1">coll1</code></td>
<td>
<p>color of the lines on the enternal outline</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_coll2">coll2</code></td>
<td>
<p>color of the lines on the internal outline</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_size">size</code></td>
<td>
<p>numeric: points and spheres size</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_lwd">lwd</code></td>
<td>
<p>numeric: line width in pixels</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_colmesh1">colmesh1</code></td>
<td>
<p>color of the periosteal mesh</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_colmesh2">colmesh2</code></td>
<td>
<p>color of the endosteal mesh</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_alpha">alpha</code></td>
<td>
<p>numeric: alpha value between 0(fully transparent) and 1 (opaque)</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_tri">tri</code></td>
<td>
<p>logical: if TRUE the semilandmarks configuration is triangulated</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_outlines">outlines</code></td>
<td>
<p>logical: if TRUE the 2D and 3D outlines are plotted</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_points">points</code></td>
<td>
<p>logical: if TRUE points (2D) and spheres (3D) are plotted</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_lines">lines</code></td>
<td>
<p>logical: if TRUE 2D and 3D lines are plotted</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_centroid">centroid</code></td>
<td>
<p>logical: if TRUE 2D and 3D centroids are plotted</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_cent.out">cent.out</code></td>
<td>
<p>how to define the center of each section. The method allowed are &quot;CCA&quot; (center of cortical area), &quot;E&quot; (barycenter of the external outline) and &quot;I&quot; (barycenter of the internal outline)</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_delta">delta</code></td>
<td>
<p>pixel size used to calculate the CCA</p>
</td></tr>
<tr><td><code id="morphomapPlotShape_+3A_vecs">vecs</code></td>
<td>
<p>numeric: which sections will be plotted. If dims is set on 2 only the first element of the vector vecs is considered</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
#morphomap on a human femur bone
data(HomFem38023)
meshes&lt;-morphomapSegm(HomFem38023)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-380.23
rawSections&lt;-morphomapCore(out.sur=perMesh,
inn.sur=endMesh,num.sect=61,mech.len = mech_length, start = 0.2,end=0.8)
shapeSections&lt;-morphomapShape(rawSections,21,sects_vector=NULL,cent.out="CCA",
delta=0.1, side="left")
#Plot the object morphomapShape in three dimensions
morphomapPlotShape(shapeSections,dims=3, size=0.5)
#Plot a 2D cross-section 
morphomapPlotShape(shapeSections,dims=2,lines=TRUE,vecs=31)
}
</code></pre>

<hr>
<h2 id='morphomapReadMorphologika'>morphomapReadMorphologika</h2><span id='topic+morphomapReadMorphologika'></span>

<h3>Description</h3>

<p>Import an array stored in a morphologika file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapReadMorphologika(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapReadMorphologika_+3A_file">file</code></td>
<td>
<p>path of the file to be read</p>
</td></tr>
</table>


<h3>Value</h3>

<p>out list containing an array, labels, groups and variables
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>

<hr>
<h2 id='morphomapRectangle'>morphomapRectangle</h2><span id='topic+morphomapRectangle'></span>

<h3>Description</h3>

<p>Define a rectangular outline
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapRectangle(l = 1, h = 1, n = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapRectangle_+3A_l">l</code></td>
<td>
<p>numeric: length of the rectangle</p>
</td></tr>
<tr><td><code id="morphomapRectangle_+3A_h">h</code></td>
<td>
<p>numeric: height of the rectangle</p>
</td></tr>
<tr><td><code id="morphomapRectangle_+3A_n">n</code></td>
<td>
<p>numeric: number of points along the outline</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mat matrix with coordinates
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extsec&lt;-morphomapRectangle(10,6,100)
intsec&lt;-morphomapRectangle(8,4,100)
plot(extsec,asp=1,type="l")
points(intsec,type="l",col=2)
</code></pre>

<hr>
<h2 id='morphomapRegradius'>morphomapRegradius</h2><span id='topic+morphomapRegradius'></span>

<h3>Description</h3>

<p>Wrapper of the function regularradius written by Julien Claude (Morphometrics with R)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapRegradius(mat, center, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapRegradius_+3A_mat">mat</code></td>
<td>
<p>a kx2 matrix</p>
</td></tr>
<tr><td><code id="morphomapRegradius_+3A_center">center</code></td>
<td>
<p>coordinates of the center from which the calculation of regular radius started</p>
</td></tr>
<tr><td><code id="morphomapRegradius_+3A_n">n</code></td>
<td>
<p>number of points</p>
</td></tr>
</table>


<h3>Value</h3>

<p>V2 position of landmarks equi angular spaced
</p>


<h3>Author(s)</h3>

<p>Julien Claude, Antonio Profico
</p>


<h3>References</h3>

<p>Claude, J. (2008). Morphometrics with R. Springer Science &amp; Business Media.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extsec&lt;-morphomapCircle(10,1000)
sel&lt;-morphomapRegradius(extsec,center = c(0,0),n=11)
selcoo&lt;-extsec[sel,]
plot(extsec,type="l",asp=1)
points(selcoo,col="red",pch=19)
</code></pre>

<hr>
<h2 id='morphomapSegm'>morphomapSegm</h2><span id='topic+morphomapSegm'></span>

<h3>Description</h3>

<p>Separate a mesh from its visible and not visible components by using CA-LSE method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapSegm(mesh, views = 30, param1 = 4, num.cores = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapSegm_+3A_mesh">mesh</code></td>
<td>
<p>object of class mesh3d</p>
</td></tr>
<tr><td><code id="morphomapSegm_+3A_views">views</code></td>
<td>
<p>numeric: number of points of view</p>
</td></tr>
<tr><td><code id="morphomapSegm_+3A_param1">param1</code></td>
<td>
<p>numeric: first parameter for spherical flipping (usually ranged between 3 and 4)</p>
</td></tr>
<tr><td><code id="morphomapSegm_+3A_num.cores">num.cores</code></td>
<td>
<p>numeric: number of cores</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The result could be affected by the value set in the <code>param1</code> argument. Before running <code>morphomapCore</code> please the periosteal and endosteal surfaces.
</p>


<h3>Value</h3>

<p>external mesh3d of the visible facets from the points of view
</p>
<p>internal mesh3d of the not visible facets from the points of view
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>References</h3>

<p>Profico A., Schlager S., Valoriani V., Buzi C., Melchionna M., Veneziano A.,
Raia P., Moggi-Cecchi J. and Manzi G., 2018. Reproducing the internal and external anatomy of fossil bones: Two new automatic digital tools.
American Journal of Physical Anthropology 166(4): 979-986.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
#automatic separation of external and medullar femur components
require(rgl)
data(HomFem38023)
meshes&lt;-morphomapSegm(HomFem38023,param1=4)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
rgl::open3d()
rgl::wire3d(perMesh,col="grey")
rgl::wire3d(endMesh,col="red")
}
</code></pre>

<hr>
<h2 id='morphomapShape'>morphomapShape</h2><span id='topic+morphomapShape'></span>

<h3>Description</h3>

<p>Tool for the extraction of equiangular landmarks on the entire diaphysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapShape(
  morphomap.core,
  num.land,
  sects_vector,
  cent.out = "CCA",
  delta = 0.1,
  side = "left"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapShape_+3A_morphomap.core">morphomap.core</code></td>
<td>
<p>list: morphomap.core object</p>
</td></tr>
<tr><td><code id="morphomapShape_+3A_num.land">num.land</code></td>
<td>
<p>numeric: number of landmarks defining each section</p>
</td></tr>
<tr><td><code id="morphomapShape_+3A_sects_vector">sects_vector</code></td>
<td>
<p>numeric: number of sections</p>
</td></tr>
<tr><td><code id="morphomapShape_+3A_cent.out">cent.out</code></td>
<td>
<p>how to define the center of each section. The method allowed are &quot;CCA&quot; (center of cortical area), &quot;E&quot; (barycenter of the external outline) and &quot;I&quot; (barycenter of the internal outline)</p>
</td></tr>
<tr><td><code id="morphomapShape_+3A_delta">delta</code></td>
<td>
<p>pixel size used to calculate the CCA</p>
</td></tr>
<tr><td><code id="morphomapShape_+3A_side">side</code></td>
<td>
<p>character: specify if the long bone is &quot;left&quot; or &quot;right&quot; side</p>
</td></tr>
</table>


<h3>Value</h3>

<p>3D_out num.pointsx3xnum.sect array in which the external outlines are stored
</p>
<p>3D_inn num.pointsx3xnum.sect array in which the internal outlines are stored
</p>
<p>2D_out num.pointsx2xnum.sect array in which the external outlines are stored
</p>
<p>2D_inn num.pointsx2xnum.sect array in which the interal outlines are stored
</p>
<p>ALPM_inn array with the coordinates of ALPM coordinates on the external outline
</p>
<p>ALPM_out array with the coordinates of ALPM coordinates on the internal outline
</p>
<p>mech_length mechanical length of the long bone
</p>
<p>start percentage of the mechanical length from which the first section is defined
</p>
<p>end percentage of the mechanical length from which the last section is defined
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(morphomap)
data(HomFem38023)
meshes&lt;-morphomapSegm(HomFem38023, param1=4)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-380.23
rawSections&lt;-morphomapCore(out.sur=perMesh, inn.sur=endMesh, num.sect=61 ,
mech.len = mech_length, start = 0.2,end=0.8,num.points = 500)
# Shape coordinates defining as center the barycenter of the cortical area
shapeSections_CCA&lt;-morphomapShape(rawSections,21,sects_vector=NULL, cent.out="CCA",
delta=0.1,side="left")
# First the first cross section (2D)
morphomapPlotShape(shapeSections_CCA,dims=2,cent.out="CCA",vecs=1)
# First the first cross section (3D)
morphomapPlotShape(shapeSections_CCA,dims=3,size=0.5,lwd=2,cent.out="I",vecs=1)
# The entire diaphysis (3D)
morphomapPlotShape(shapeSections_CCA,dims=3,size=0.5,lwd=2,cent.out="I",vecs=NULL)
# Shape coordinates defining as center the barycenter of the external perimeter
shapeSections_E&lt;-morphomapShape(rawSections, 21, sects_vector=NULL, cent.out="E", 
delta=0.1, side="left")
# First the first cross section (2D)
morphomapPlotShape(shapeSections_E,dims=2,cent.out="E",vecs=1)
# First the first cross section (3D)
morphomapPlotShape(shapeSections_E,dims=3,size=0.5,lwd=2,cent.out="I",vecs=1)
# The entire diaphysis (3D)
morphomapPlotShape(shapeSections_E,dims=3,size=0.5,lwd=2,cent.out="I",vecs=NULL)

# Shape coordinates defining as center the barycenter of the internal perimeter 
shapeSections_I&lt;-morphomapShape(rawSections, 21, sects_vector=NULL, cent.out="I", 
delta=0.1, side="left")
# First the first cross section (2D)
morphomapPlotShape(shapeSections_I,dims=2,lines=TRUE,cent.out="I",vecs=1)
# First the first cross section (3D)
morphomapPlotShape(shapeSections_I,dims=3,lines=TRUE,centroid=TRUE, size=0.5,
lwd=2,cent.out="I",vecs=1)
# The entire diaphysis (3D)
morphomapPlotShape(shapeSections_I,dims=3,size=0.5,lwd=2,cent.out="I",vecs=NULL)

</code></pre>

<hr>
<h2 id='morphomapSort'>morphomapSort</h2><span id='topic+morphomapSort'></span>

<h3>Description</h3>

<p>Sort a series of points stored as a 2D matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapSort(mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapSort_+3A_mat">mat</code></td>
<td>
<p>numeric matrix: a kx2 matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mat sorted kx2 matrix
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rand&lt;-sample(100)
extsec&lt;-morphomapCircle(10,100)[rand,]
plot(extsec,type="l",asp=1)
sorted&lt;-morphomapSort(extsec)
plot(sorted,type="l",asp=1)
</code></pre>

<hr>
<h2 id='morphomapThickness'>morphomapThickness</h2><span id='topic+morphomapThickness'></span>

<h3>Description</h3>

<p>Tool for the extraction of equiangular landmarks on the entire diaphysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapThickness(morphomap.shape)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapThickness_+3A_morphomap.shape">morphomap.shape</code></td>
<td>
<p>list: morphomap.shape object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sect_thickness cortical thickness at each pair of landmarks on the external and internal outlines
</p>
<p>ALPM_thickness cortical thickness at ALPM quadrants
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#morphomap on a human femur bone
data(HomFem38023)
meshes&lt;-morphomapSegm(HomFem38023, param1=4)
perMesh&lt;-meshes$external
endMesh&lt;-meshes$internal
mech_length&lt;-380.23
rawSections&lt;-morphomapCore(out.sur=perMesh,
                           inn.sur=endMesh,num.sect=61,mech.len = mech_length, 
                           start = 0.2,end=0.8)
shapeSections&lt;-morphomapShape(rawSections,21,sects_vector=NULL,cent.out="CCA",delta=0.1)
femthick&lt;-morphomapThickness(shapeSections)
plot(femthick$ALPM_thickness[1,,],type="l",
     main="LAMP thickness",xlab="section",ylab="thickness")
points(femthick$ALPM_thickness[2,,],type="l",col=2)
points(femthick$ALPM_thickness[3,,],type="l",col=3)
points(femthick$ALPM_thickness[4,,],type="l",col=4)

</code></pre>

<hr>
<h2 id='morphomapTranslate'>morphomapTranslate</h2><span id='topic+morphomapTranslate'></span>

<h3>Description</h3>

<p>Translate a section to a new center defined by the user
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapTranslate(corA, medA, Cx, Cy)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapTranslate_+3A_cora">corA</code></td>
<td>
<p>matrix: coordinates of the external outline</p>
</td></tr>
<tr><td><code id="morphomapTranslate_+3A_meda">medA</code></td>
<td>
<p>matrix: coordinates of the internal outline</p>
</td></tr>
<tr><td><code id="morphomapTranslate_+3A_cx">Cx</code></td>
<td>
<p>numeric: new x center coordinate</p>
</td></tr>
<tr><td><code id="morphomapTranslate_+3A_cy">Cy</code></td>
<td>
<p>numeric: new y center coordinate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>cortical new centered coordinates of the external outline
</p>
<p>medullar new centered coordinates of the internal outline
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extsec&lt;-morphomapCircle(10,1000)
intsec&lt;-morphomapCircle(8,1000)
plot(extsec,asp=1,type="l",xlim=c(-11,11),ylim=c(-11,11))
points(intsec,type="l")
traSect&lt;-morphomapTranslate(extsec,intsec,1,1)
points(traSect$cortical,type="l",col="red")
points(traSect$medullar,type="l",col="red")
</code></pre>

<hr>
<h2 id='morphomapTri2sects'>morphomapTri2sects</h2><span id='topic+morphomapTri2sects'></span>

<h3>Description</h3>

<p>Triangulate the external and internal outlines of a 3D cross section
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapTri2sects(cp, mp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapTri2sects_+3A_cp">cp</code></td>
<td>
<p>matrix: coordinates of the external outline of the section</p>
</td></tr>
<tr><td><code id="morphomapTri2sects_+3A_mp">mp</code></td>
<td>
<p>matrix: coordinates of the internal outline of the section</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix coordinates of the triangulated mesh
</p>
<p>tri triangulations of the triangulated mesh
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>

<hr>
<h2 id='morphomapTriangulate'>morphomapTriangulate</h2><span id='topic+morphomapTriangulate'></span>

<h3>Description</h3>

<p>Build a mesh starting from the coordinates of the diaphysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapTriangulate(set, n, close = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapTriangulate_+3A_set">set</code></td>
<td>
<p>matrix: coordinates of the cross sections to be triangulated</p>
</td></tr>
<tr><td><code id="morphomapTriangulate_+3A_n">n</code></td>
<td>
<p>numeric: number of cross sections</p>
</td></tr>
<tr><td><code id="morphomapTriangulate_+3A_close">close</code></td>
<td>
<p>logical: if TRUE the two surfaces are closed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mesh a mesh of the triangulated semilandark configuration
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>

<hr>
<h2 id='morphomapVariations'>morphomapVariations</h2><span id='topic+morphomapVariations'></span>

<h3>Description</h3>

<p>Calculate cortical map variation from PCA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapVariations(PCA, scores, PC, pal = blue2green2red(101), asp = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapVariations_+3A_pca">PCA</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapVariations_+3A_scores">scores</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapVariations_+3A_pc">PC</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapVariations_+3A_pal">pal</code></td>
<td>
<p>list: list containing morphomapShape objects</p>
</td></tr>
<tr><td><code id="morphomapVariations_+3A_asp">asp</code></td>
<td>
<p>numeric: aspect ratio of the morphometric map</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mapvar: matrix containing values of cortical thickness
</p>


<h3>Author(s)</h3>

<p>Antonio Profico
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Ex_mpShapeList)
PCA&lt;-morphomapPCA(Ex_mpShapeList)
plot(PCA$PCscores)
barplot(PCA$Variance[,2])
morphomapVariations(PCA,min(PCA$PCscores[,1]),PCA$PCs[,1])
morphomapVariations(PCA,max(PCA$PCscores[,1]),PCA$PCs[,1])

</code></pre>

<hr>
<h2 id='morphomapWriteMorphologika'>morphomapWriteMorphologika</h2><span id='topic+morphomapWriteMorphologika'></span>

<h3>Description</h3>

<p>Export an array in the morphologika format file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapWriteMorphologika(array, groups = NULL, variables = NULL, file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapWriteMorphologika_+3A_array">array</code></td>
<td>
<p>an array</p>
</td></tr>
<tr><td><code id="morphomapWriteMorphologika_+3A_groups">groups</code></td>
<td>
<p>a vector containing a classifier</p>
</td></tr>
<tr><td><code id="morphomapWriteMorphologika_+3A_variables">variables</code></td>
<td>
<p>list containing further classifiers</p>
</td></tr>
<tr><td><code id="morphomapWriteMorphologika_+3A_file">file</code></td>
<td>
<p>path of the file to be saved</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>

<hr>
<h2 id='morphomapZmoment'>morphomapZmoment</h2><span id='topic+morphomapZmoment'></span>

<h3>Description</h3>

<p>Calculate the polar moment of inertia around the x and y axes and the polar section module
</p>


<h3>Usage</h3>

<pre><code class='language-R'>morphomapZmoment(cp, mp, Cx = 0, Cy = 0, delta = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="morphomapZmoment_+3A_cp">cp</code></td>
<td>
<p>matrix: coordinates of the external outline of the section</p>
</td></tr>
<tr><td><code id="morphomapZmoment_+3A_mp">mp</code></td>
<td>
<p>matrix: coordinates of the internal outline of the section</p>
</td></tr>
<tr><td><code id="morphomapZmoment_+3A_cx">Cx</code></td>
<td>
<p>numeric: x coordinate of the section center</p>
</td></tr>
<tr><td><code id="morphomapZmoment_+3A_cy">Cy</code></td>
<td>
<p>numeric: y coordinate of the section center</p>
</td></tr>
<tr><td><code id="morphomapZmoment_+3A_delta">delta</code></td>
<td>
<p>numeric: picture elements of adjustable side length</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Zx numeric: moment of inertia around the x axis
</p>
<p>Zy numeric: moment of inertia around the y axis
</p>
<p>dx numeric: maximum chord length from y axis
</p>
<p>dy numeric: maximum chord length from x axis
</p>
<p>Zpol numeric: polar moment of inertia
</p>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extsec&lt;-morphomapCircle(10,1000)
intsec&lt;-morphomapCircle(8,1000)
ZMs&lt;-morphomapZmoment(extsec,intsec,delta=0.1)
</code></pre>

<hr>
<h2 id='PanFem27713'>example dataset</h2><span id='topic+PanFem27713'></span>

<h3>Description</h3>

<p>3D mesh of a chimpanzee femur bone
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PanFem27713)
</code></pre>


<h3>Author(s)</h3>

<p>Antonio Profico, Luca Bondioli, Pasquale Raia, Paul O'Higgins, Damiano Marchi
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
