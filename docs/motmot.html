<!DOCTYPE html><html lang="en"><head><title>Help for package motmot</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {motmot}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#motmot-package'><p>Models Of Trait Macroevolution On Trees</p></a></li>
<li><a href='#addFossilToPhy'><p>add a fossil to an interior branch of a time-scaled phylogeny</p></a></li>
<li><a href='#allopatric.data'><p>Finch allopatric data</p></a></li>
<li><a href='#anolis.data'><p>Anolis phenotype data</p></a></li>
<li><a href='#anolis.tree'><p>Anolis phylogeny</p></a></li>
<li><a href='#as.rateData'><p>Conversion among data and phylogeny objects</p></a></li>
<li><a href='#as.rateMatrix'><p>Conversion among data and phylogeny objects</p></a></li>
<li><a href='#blomberg.k'><p>Blomberg's K</p>
Estimate Blomberg's K (Blomberg et al. 2003)</a></li>
<li><a href='#calcCutOff'><p>Calculate multiple-test cut-off</p></a></li>
<li><a href='#chr.disp.lrt'><p>Character displacement likelihood ratio test</p></a></li>
<li><a href='#chr.disp.param'><p>Simulate character displacement data wrapper</p></a></li>
<li><a href='#chr.disp.sim'><p>Simulate character displacement data</p></a></li>
<li><a href='#contemporaryPhy'><p>prune tree and data to lineages present in a time bin in the past</p></a></li>
<li><a href='#dropTipPartial'><p>Drop tips from a phylogenetic tree while preserving deleted nodes</p></a></li>
<li><a href='#fairProportions'><p>Calculate fair proportions phylogenetic diversity metric</p></a></li>
<li><a href='#finch.data'><p>Finch phenotype data</p></a></li>
<li><a href='#finch.tree'><p>Finch tree</p></a></li>
<li><a href='#likRatePhylo'><p>Log-likelihood rate estimation for traits and phylogenies</p></a></li>
<li><a href='#likTraitPhylo'><p>Log-likelihood estimation for traits and phylogenies</p></a></li>
<li><a href='#mammals'><p>Mammal data</p></a></li>
<li><a href='#mcmc.plot'><p>plot the output from transformPhylo.MCMC</p></a></li>
<li><a href='#ML.RatePhylo'><p>Maximum likelihood rate estimation for traits and phylogenies</p></a></li>
<li><a href='#node.descendents'><p>Identify nodes and tips descended from a node</p></a></li>
<li><a href='#nodeTimes'><p>Get times for nodes and tips</p></a></li>
<li><a href='#optim.likRatePhylo'><p>Maximum likelihood rate estimation for traits and phylogenies</p></a></li>
<li><a href='#phyloCovar'><p>Calculation of Brownian (co)variance using independent contrasts.</p></a></li>
<li><a href='#phyloMean'><p>Calculation of phylogenetically corrected mean.</p></a></li>
<li><a href='#phyloVar'><p>Calculation of Brownian variance.</p></a></li>
<li><a href='#pic.pgls'><p>Fast PLGS estimation based on contrasts</p></a></li>
<li><a href='#plot.timeSlice.ML'><p>Identify shifts in the rate of trait diversification through time</p></a></li>
<li><a href='#plot.traitMedusa.model'><p>Tree plotting for rates</p></a></li>
<li><a href='#RatePhylo.allCI'><p>Confidence intervals for rate parameters</p></a></li>
<li><a href='#sampleShid'><p>Sample hidden speciation events along branches of a tree</p></a></li>
<li><a href='#sortTraitData'><p>Sort data and remove missing entries for tree and trait data</p></a></li>
<li><a href='#summary.traitMedusa'><p>Identify shifts in the rate of trait diversification</p></a></li>
<li><a href='#traitData.plot'><p>plot a univariate continuous trait data on a phylogeny</p></a></li>
<li><a href='#transformPhylo'><p>Phylogenetic tree transformations</p></a></li>
<li><a href='#transformPhylo.ll'><p>Log-likelhood for models of trait evolution.</p></a></li>
<li><a href='#transformPhylo.MCMC'><p>Bayesian MCMC for models of trait evolution</p></a></li>
<li><a href='#transformPhylo.ML'><p>Maximum likelihood for models of trait evoluion</p></a></li>
<li><a href='#transformPhylo.sim'><p>Phylogenetic tree transformations</p></a></li>
<li><a href='#transformRateMatrix'><p>Conversion among data and phylogeny objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Models of Trait Macroevolution on Trees</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.0), ape (&ge; 3.0-7)</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-11-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark Puttick [aut, cre, cph], Gavin Thomas [aut, cph], Rob Freckleton [aut, cph], Magnus Clarke [ctb], Travis Ingram [ctb], David Orme [ctb], Emmanuel Paradis [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mark Puttick &lt;marknputtick@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for fitting models of trait evolution
        on phylogenies for continuous traits. The majority of functions
        described in Thomas and Freckleton (2012) &lt;<a href="https://doi.org/10.1111%2Fj.2041-210X.2011.00132.x">doi:10.1111/j.2041-210X.2011.00132.x</a>&gt; 	and include functions that allow for tests of variation in the rates of trait evolution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://puttickbiology.wordpress.com/motmot/">https://puttickbiology.wordpress.com/motmot/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.1</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, formatR</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, coda, ks, mvtnorm, caper, methods</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-11-25 13:58:02 UTC; markputtick</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-11-25 17:10:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='motmot-package'>Models Of Trait Macroevolution On Trees</h2><span id='topic+motmot-package'></span><span id='topic+motmot'></span>

<h3>Description</h3>

<p>Functions for fitting models of trait evolution on phylogenies for continuous traits. The majority of functions described in Thomas and Freckleton (2012) and include functions that allow for tests of variation in the rates of trait evolution.
</p>


<h3>Author(s)</h3>

<p>Mark Puttick &lt;marknputtick@gmail.com&gt;.
</p>
<p>Gavin Thomas.
</p>
<p>Travis Ingram.
</p>
<p>Magnus Clarke.
</p>
<p>Rob Freckleton.
</p>
<p>David Orme.
</p>
<p>Emmanuel Paradis.
</p>


<h3>References</h3>

<p>Thomas GH, &amp; Freckleton R. 2012. Body size diversification in Anolis: novel environments and island effects. MOTMOT: models of trait macroevolution on trees 3, 145-151.
</p>

<hr>
<h2 id='addFossilToPhy'>add a fossil to an interior branch of a time-scaled phylogeny</h2><span id='topic+addFossilToPhy'></span>

<h3>Description</h3>

<p>the function takes a time-scaled phylogeny and adds a fossil at a branch in the past
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addFossilToPhy(
  phy,
  inGroup,
  fossil,
  fossilAge,
  minLength = 0.1,
  maxLength = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addFossilToPhy_+3A_phy">phy</code></td>
<td>
<p>Input phylogeny an object of class <code>phylo</code> (see <span class="pkg">ape</span>)</p>
</td></tr>
<tr><td><code id="addFossilToPhy_+3A_ingroup">inGroup</code></td>
<td>
<p>vector of tip labels defined as the ingroup - the fossil(s) will be placed on the stem branch leading to the 'inGroups' most recent common ancestor</p>
</td></tr>
<tr><td><code id="addFossilToPhy_+3A_fossil">fossil</code></td>
<td>
<p>tip labels for the new fossil</p>
</td></tr>
<tr><td><code id="addFossilToPhy_+3A_fossilage">fossilAge</code></td>
<td>
<p>age of the fossil</p>
</td></tr>
<tr><td><code id="addFossilToPhy_+3A_minlength">minLength</code></td>
<td>
<p>minimum length leading to the fossil</p>
</td></tr>
<tr><td><code id="addFossilToPhy_+3A_maxlength">maxLength</code></td>
<td>
<p>maximum length leading to the fossil. If <code>NULL</code> (default) then the maximum bound is half the length of the branch leading to the crown node</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the the time-scaled phylogeny with the fossil attached
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>References</h3>

<p>Puttick, M. N., Kriwet, J., Wen, W., Hu, S., Thomas, G. H., &amp; Benton, M. J. (2017). Body length of bony fishes was not a selective factor during the biggest mass extinction of all time. Palaeontology, 60, 727-741.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
plot(anolis.tree)
nodelabels(214, 214)
# add fossil to node 214
in.groups &lt;- node.descendents(x=214, phy=anolis.tree, tip.labels=TRUE)[[2]]
fossilPhy &lt;- addFossilToPhy(anolis.tree, in.groups, fossil="fakeFossil", fossilAge=60)
plot(fossilPhy)
</code></pre>

<hr>
<h2 id='allopatric.data'>Finch allopatric data</h2><span id='topic+allopatric.data'></span>

<h3>Description</h3>

<p>Finch data from Clarke et al. 2017
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(finches)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>.</p>


<h3>References</h3>

<p>Clarke M, Thomas GH, Freckleton RP. 2017. Trait evolution in adaptive radiations: modelling and measuring interspecific competition on phylogenies. The American Naturalist. 189, 121-137.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(finches)
head(allopatric.data)
</code></pre>

<hr>
<h2 id='anolis.data'>Anolis phenotype data</h2><span id='topic+anolis.data'></span>

<h3>Description</h3>

<p>Data on anolis phenotype data from Thomas et al. 2009
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(anolis.data)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>.</p>


<h3>References</h3>

<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.data)
head(anolis.data)
</code></pre>

<hr>
<h2 id='anolis.tree'>Anolis phylogeny</h2><span id='topic+anolis.tree'></span>

<h3>Description</h3>

<p>Data on anolis phylogeny from Thomas et al. 2009
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(anolis.tree)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"phylo"</code>.</p>


<h3>References</h3>

<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
anolis.tree
</code></pre>

<hr>
<h2 id='as.rateData'>Conversion among data and phylogeny objects</h2><span id='topic+as.rateData'></span>

<h3>Description</h3>

<p>Function to generate a &quot;rateData&quot; object containing the discrete explanatory variable, continuous response variable and set of variance co-variance matrices. It loads the trait data and removes species with missing data from the data and vcv matrix. 
<code>as.rateData</code> requires either a set of matrices in rateMatrix format created using <code>as.rateMatrix</code> or, if no rateMatrix object is input then it requires a phylogeny in &quot;phylo&quot; format. If  a &quot;phylo&quot; object is used  <code>as.rateData</code> will call <code>as.rateMatrix</code> internally.
<code>as.rateMatrix</code> calls the &quot;ape&quot; function <code>vcv.phylo</code> multiple times and this can be slow for large phylogenies. It will often be more efficient to use <code>as.rateMatrix</code> first to create a &quot;rateMatrix&quot; object to pass to <code>as.rateData</code>, particularly if there are many response traits of interest to be fitted to the same phylogeny and set of reconstructed ancestral states.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.rateData(
  y,
  x,
  rateMatrix = NULL,
  phy = NULL,
  data,
  meserr.col = NULL,
  meserr.propn = NULL,
  log.y = FALSE,
  report_prune = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.rateData_+3A_y">y</code></td>
<td>
<p>The response variable - typically a continuous trait. Specified as a column name or index</p>
</td></tr>
<tr><td><code id="as.rateData_+3A_x">x</code></td>
<td>
<p>The explanatory (discrete) variable used to define the hypothesised rate categories. Specified as a column name or index.</p>
</td></tr>
<tr><td><code id="as.rateData_+3A_ratematrix">rateMatrix</code></td>
<td>
<p>A &quot;rateMatrix&quot; object or NULL</p>
</td></tr>
<tr><td><code id="as.rateData_+3A_phy">phy</code></td>
<td>
<p>An object of class &quot;phylo&quot; (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="as.rateData_+3A_data">data</code></td>
<td>
<p>A data frame containing (minimally) the x and y variables as columns with species names as rownames.</p>
</td></tr>
<tr><td><code id="as.rateData_+3A_meserr.col">meserr.col</code></td>
<td>
<p>Column name or index containing measurement error for species means.</p>
</td></tr>
<tr><td><code id="as.rateData_+3A_meserr.propn">meserr.propn</code></td>
<td>
<p>Single value specifying the proportional measurement to be applied across all species.</p>
</td></tr>
<tr><td><code id="as.rateData_+3A_log.y">log.y</code></td>
<td>
<p>Logical, natural log transform response variable.</p>
</td></tr>
<tr><td><code id="as.rateData_+3A_report_prune">report_prune</code></td>
<td>
<p>Logical. Prints a list of dropped species if TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>rateData An object of class &quot;rateData&quot; which is a list containing the response (y) and explanatory (x) variable along with a list of variance-covaraince matrices.
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas
</p>


<h3>References</h3>

<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Read in phylogeny and data from Thomas et al. (2009)
data(anolis.tree)
data(anolis.data)

## Convert data to class rateData with a rateMatrix object as input
anolis.rateMatrix &lt;- as.rateMatrix(phy=anolis.tree, x="geo_ecomorph", data=anolis.data)

anolis.rateData &lt;- as.rateData(y="Female_SVL", x="geo_ecomorph", 
rateMatrix = anolis.rateMatrix, phy=NULL, data=anolis.data, log.y=TRUE)  

## Convert data to class rateData with a phylo object as input 
anolis.rateData &lt;- as.rateData(y="Female_SVL", x="geo_ecomorph", 
rateMatrix = NULL, phy=anolis.tree, data=anolis.data, log.y=TRUE)
</code></pre>

<hr>
<h2 id='as.rateMatrix'>Conversion among data and phylogeny objects</h2><span id='topic+as.rateMatrix'></span>

<h3>Description</h3>

<p>Function to generate a <code>rateMatrix</code> object containing a set of variance covariance matrices. 
Note that <code>as.rateMatrix</code> calls the CAIC function <code>vcv.array</code> multiple times and this can be slow for large phylogenies (though faster than using the <span class="pkg">ape</span> equivalent <code>vcv.phylo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.rateMatrix(phy, x, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.rateMatrix_+3A_phy">phy</code></td>
<td>
<p>An object of class &quot;phylo&quot; (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="as.rateMatrix_+3A_x">x</code></td>
<td>
<p>The explanatory (discrete) variable used to define the hypothesised rate categories. Can be specified as a column number or column name</p>
</td></tr>
<tr><td><code id="as.rateMatrix_+3A_data">data</code></td>
<td>
<p>The explanatory (discrete) variable used to define the hypothesised rate categories. Can be specified as a column number or column name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>rateMatrix An object of class &quot;rateMatrix&quot; - a list of matrices describing the expected variances and covariances of between species. Each matrix refers to the variances and covariances for a given state of x (see Thomas et al. 2006).
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas
</p>


<h3>References</h3>

<p>Thomas GH, Freckleton RP, &amp; Szekely T. 2006. Comparative analyses of the influence of developmental mode on phenotypic diversification rates in shorebirds. Proceedings of the Royal Society B 273, 1619-1624.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Read in phylogeny and data from Thomas et al. (2009)
data(anolis.tree)
data(anolis.data)

## Convert data to class rateMatrix
anolis.rateMatrix &lt;- as.rateMatrix(phy=anolis.tree, x="geo_ecomorph", data=anolis.data)
</code></pre>

<hr>
<h2 id='blomberg.k'>Blomberg's K
Estimate Blomberg's K (Blomberg et al. 2003)</h2><span id='topic+blomberg.k'></span>

<h3>Description</h3>

<p>Blomberg's K
Estimate Blomberg's K (Blomberg et al. 2003)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blomberg.k(phy, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="blomberg.k_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="blomberg.k_+3A_y">y</code></td>
<td>
<p>A matrix of trait values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimate of the K statistic
</p>


<h3>References</h3>

<p>Blomberg SP, Garland T, &amp; Ives AR. 2003. Testing for phylogenetic signal in comparative data: behavioral traits are more labile. Evolution 57, 717-745.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>, the Picante package
</p>

<hr>
<h2 id='calcCutOff'>Calculate multiple-test cut-off</h2><span id='topic+calcCutOff'></span>

<h3>Description</h3>

<p>Calculate the log-likelihood, AIC, or AICc cut-off necessary for type-one error to reach acceptable levels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcCutOff(
  phy,
  n = 1000,
  mc.cores = 1,
  model,
  measure = "AICc",
  alpha.error = 0.05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calcCutOff_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="calcCutOff_+3A_n">n</code></td>
<td>
<p>Number of simulations</p>
</td></tr>
<tr><td><code id="calcCutOff_+3A_mc.cores">mc.cores</code></td>
<td>
<p>Number of cores for parallel processing for linux-type systems (not applicable to Windows)</p>
</td></tr>
<tr><td><code id="calcCutOff_+3A_model">model</code></td>
<td>
<p>Evolutionary model, typically &quot;tm1&quot;, &quot;tm2&quot;, or &quot;timeSlice&quot;, which is used to test the empirical data</p>
</td></tr>
<tr><td><code id="calcCutOff_+3A_measure">measure</code></td>
<td>
<p>Measure used to summarise the model. One of &quot;lnL&quot; (log-likelihood), &quot;AIC&quot;, or &quot;AICc&quot;</p>
</td></tr>
<tr><td><code id="calcCutOff_+3A_alpha.error">alpha.error</code></td>
<td>
<p>Target for the desired type-one error rate for the model (default 0.05)</p>
</td></tr>
<tr><td><code id="calcCutOff_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code> which should be identical to the model applied to empirical data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The cut-off requred to produce an type-one error rate equal to quantile.cut.off (default = 0.05) when data are simulated under Brownian motion, and these data are analysed under the appropriate model.
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>, <code><a href="#topic+transformPhylo.ll">transformPhylo.ll</a></code>, <code><a href="#topic+transformPhylo">transformPhylo</a></code>, <code><a href="#topic+transformPhylo.MCMC">transformPhylo.MCMC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
set.seed(393)
# calculated necessary AICc cut-off to reduce type-one error to 5% 
# for a timeSlice model with a split at 30Ma (only 5 simulations used,
# it's recommend to use 1000 for analyses)
calcCutOff(anolis.tree, n=5, model="timeSlice", splitTime=30)
</code></pre>

<hr>
<h2 id='chr.disp.lrt'>Character displacement likelihood ratio test</h2><span id='topic+chr.disp.lrt'></span>

<h3>Description</h3>

<p>Conducts a likelihood ratio test between empirical data (phylogeny and trait data), and simumlations from the function chr.disp.sim using an approximate Bayesian computation (ABC) approach (Clarke et al. 2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chr.disp.lrt(emp.tree, emp.data, param.out, posteriorSize = 500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chr.disp.lrt_+3A_emp.tree">emp.tree</code></td>
<td>
<p>An empirical phylogeny - a object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="chr.disp.lrt_+3A_emp.data">emp.data</code></td>
<td>
<p>Continuous trait data matrix</p>
</td></tr>
<tr><td><code id="chr.disp.lrt_+3A_param.out">param.out</code></td>
<td>
<p>simulated data from the function <code>chr.disp.sim</code></p>
</td></tr>
<tr><td><code id="chr.disp.lrt_+3A_posteriorsize">posteriorSize</code></td>
<td>
<p>The number of samples to use in the likelihood-ratio test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing element of 'estimates' with the estimates of sigma and a, with the Brownian motion (a = 0) summarised in column one and the character displacement (a &gt; 0) in column two. 'likelihood' contains the likelihood of the Brownian motion model and the character displacement model, and the likelihood ratio test estimate. If used, there is an estimate of Blomberg's K for the empirical and simulated data.
</p>


<h3>Author(s)</h3>

<p>Magnus Clarke and Mark Puttick
</p>


<h3>References</h3>

<p>Clarke M, Thomas GH, Freckleton RP. 2017. Trait evolution in adaptive radiations: modelling and measuring interspecific competition on phylogenies. The American Naturalist. 189, 121-137.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+chr.disp.sim">chr.disp.sim</a></code>, <code><a href="#topic+chr.disp.param">chr.disp.param</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## import finch data form Clarke et al. (2017)
data(finches)
## simulate small amount of data 
## (example only - many more datasets are required for accuracy)
param.simulation &lt;- chr.disp.param(finch.tree, n.sim = 100, n.steps=100,
max.sigma = 8, max.a = 8, ntraits=1, 
allopatry=as.matrix(allopatric.data), mc.cores = 1)
chr.disp.lrt(finch.tree, finch.data, param.simulation, 50)
</code></pre>

<hr>
<h2 id='chr.disp.param'>Simulate character displacement data wrapper</h2><span id='topic+chr.disp.param'></span>

<h3>Description</h3>

<p>Simulates phylogenetic trait data under a character displacement model (Clarke et al. 2017) in which traits interact inter-specifically, with competition between sympatric lineages driving trait values apart
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chr.disp.param(
  phy,
  n.sim = 100,
  n.steps = 1000,
  max.sigma = 8,
  max.a = 8,
  est.blomberg.k = FALSE,
  ntraits = 1,
  sympatry = NA,
  allopatry = NA,
  trait.lim = NA,
  mc.cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chr.disp.param_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="chr.disp.param_+3A_n.sim">n.sim</code></td>
<td>
<p>Number of replications to simulate data</p>
</td></tr>
<tr><td><code id="chr.disp.param_+3A_n.steps">n.steps</code></td>
<td>
<p>Number of time steps the for the simulation (default = 1000 time steps).</p>
</td></tr>
<tr><td><code id="chr.disp.param_+3A_max.sigma">max.sigma</code></td>
<td>
<p>The maximum value of Brownian variance in the simulation sampled from a U(0, max.sigma) distribution for each iteration</p>
</td></tr>
<tr><td><code id="chr.disp.param_+3A_max.a">max.a</code></td>
<td>
<p>The maximum value of the strength of competition between inter-specific lineages sampled from a U(0, max.a) distribution for each iteration</p>
</td></tr>
<tr><td><code id="chr.disp.param_+3A_est.blomberg.k">est.blomberg.k</code></td>
<td>
<p>Logical. If TRUE, Blomberg's K is simultaneously estimated</p>
</td></tr>
<tr><td><code id="chr.disp.param_+3A_ntraits">ntraits</code></td>
<td>
<p>Number of traits to be simulated</p>
</td></tr>
<tr><td><code id="chr.disp.param_+3A_sympatry">sympatry</code></td>
<td>
<p>an optional matrix giving the time that each pair of species starts to interact</p>
</td></tr>
<tr><td><code id="chr.disp.param_+3A_allopatry">allopatry</code></td>
<td>
<p>an optional matrix giving the times when species stop interacting</p>
</td></tr>
<tr><td><code id="chr.disp.param_+3A_trait.lim">trait.lim</code></td>
<td>
<p>an optional parameter that puts limits on the available trait-space, preventing trait values with magnitude greater than the value of lim</p>
</td></tr>
<tr><td><code id="chr.disp.param_+3A_mc.cores">mc.cores</code></td>
<td>
<p>Numeric. The number of parallel cores to be used in simulations. Only applicable on Linux and Mac systems</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the simulated data 'simulated.param': a matrix with each row represented an iteration, the sigma (Brownian variance) used in the iteration, the 'a' value used in each iteration, the mean and standard deviation between neighbouring trait values. The 'input.arguments' from the model, the 'input.phy' from the model, and the input 'sympatry' and 'allopatry' matrices.
</p>


<h3>Author(s)</h3>

<p>Magnus Clarke and Mark Puttick
</p>


<h3>References</h3>

<p>Clarke M, Thomas GH, &amp; Freckleton RP. 2017. Trait evolution in adaptive radiations: modeling and measuring interspecific competition on phylogenies. The American Naturalist 189, 121-137.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+chr.disp.sim">chr.disp.sim</a></code>, <code><a href="#topic+chr.disp.lrt">chr.disp.lrt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## import finch data form Clarke et al. (2017)
data(finches)
## simulate small amount of data 
## (example only - many more datasets are required for accuracy)
param.simulation &lt;- chr.disp.param(finch.tree, n.sim = 3, n.steps=100,  
max.sigma = 8, max.a = 8, ntraits=1, 
allopatry=as.matrix(allopatric.data), mc.cores = 1)
</code></pre>

<hr>
<h2 id='chr.disp.sim'>Simulate character displacement data</h2><span id='topic+chr.disp.sim'></span>

<h3>Description</h3>

<p>Simulates data under a Brownian motion or character displacement model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chr.disp.sim(
  phy,
  n.steps = 1000,
  sigma = 1,
  a = 0,
  ntraits = 1,
  sympatry = NA,
  allopatry = NA,
  trait.lim = NA
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chr.disp.sim_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="chr.disp.sim_+3A_n.steps">n.steps</code></td>
<td>
<p>Number of time steps the for the simulation (default = 1000 time steps).</p>
</td></tr>
<tr><td><code id="chr.disp.sim_+3A_sigma">sigma</code></td>
<td>
<p>The value of Brownian variance in the simulation</p>
</td></tr>
<tr><td><code id="chr.disp.sim_+3A_a">a</code></td>
<td>
<p>The strength of competition between inter-specific lineages</p>
</td></tr>
<tr><td><code id="chr.disp.sim_+3A_ntraits">ntraits</code></td>
<td>
<p>Number of traits to be simulated</p>
</td></tr>
<tr><td><code id="chr.disp.sim_+3A_sympatry">sympatry</code></td>
<td>
<p>an optional matrix giving the time that each pair of species starts to interact</p>
</td></tr>
<tr><td><code id="chr.disp.sim_+3A_allopatry">allopatry</code></td>
<td>
<p>an optional matrix giving the times when species stop interacting</p>
</td></tr>
<tr><td><code id="chr.disp.sim_+3A_trait.lim">trait.lim</code></td>
<td>
<p>an optional parameter that puts limits on the available trait-space, preventing trait values with magnitude greater than the value of lim</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the the simulated data (tval) showing the sigma, a, mean gap and gap standard deviation. Additionally, if used, the user input sympatry (symp) and/or allopatry (allo) matrices
</p>


<h3>Author(s)</h3>

<p>Magnus Clarke and Mark Puttick
</p>


<h3>References</h3>

<p>Clarke M, Thomas GH, Freckleton RP. 2017. Trait evolution in adaptive radiations: modelling and measuring interspecific competition on phylogenies. The American Naturalist. 189, 121-137.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+chr.disp.param">chr.disp.param</a></code>, <code><a href="#topic+chr.disp.lrt">chr.disp.lrt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## import finch data form Clarke et al. (2017)
data(finches)
emp.tree &lt;- finch.tree
emp.data &lt;- finch.data
## simulate small amount of data 
## (example only - many more datasets are required for accuracy)
sim.data &lt;- chr.disp.sim(emp.tree, n.steps=100,
sigma=1, a=2, ntraits=1, sympatry=NA, allopatry=NA, trait.lim=NA)
</code></pre>

<hr>
<h2 id='contemporaryPhy'>prune tree and data to lineages present in a time bin in the past</h2><span id='topic+contemporaryPhy'></span>

<h3>Description</h3>

<p>the function takes a full tree and returns a pruned phylogeny with only tips and lineages found within a time bin preserved. If trait data are supplied the function will return tip states based either on the original tips found in the bin, or tip states inferred from ancestral states
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contemporaryPhy(
  phy,
  maxBin,
  minBin,
  reScale = 0,
  allTraits,
  closest.min = TRUE,
  traits.from.tip = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contemporaryPhy_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="contemporaryPhy_+3A_maxbin">maxBin</code></td>
<td>
<p>the start age (older time in myr from present) of the time bin in which lineages are preserved</p>
</td></tr>
<tr><td><code id="contemporaryPhy_+3A_minbin">minBin</code></td>
<td>
<p>the final age (younger time in myr from present) of the time bin in which lineages are preserved</p>
</td></tr>
<tr><td><code id="contemporaryPhy_+3A_rescale">reScale</code></td>
<td>
<p>if the most recent tip is not from the present, the age needed to add so the phylogeny is in 'real time'</p>
</td></tr>
<tr><td><code id="contemporaryPhy_+3A_alltraits">allTraits</code></td>
<td>
<p>a vector of trait data corresponding to the phy$edge object. The trait data represent tip and internal node data for the phylogeny</p>
</td></tr>
<tr><td><code id="contemporaryPhy_+3A_closest.min">closest.min</code></td>
<td>
<p>Logical. Should new tip values for lineages that span the bin be taken from the node nearest the <code>minBin</code> age (<code>closest.min=TRUE</code>, default) or the <code>maxBin</code> age <code>closest.min=FALSE</code></p>
</td></tr>
<tr><td><code id="contemporaryPhy_+3A_traits.from.tip">traits.from.tip</code></td>
<td>
<p>Logical. Should tip values for pendant edges in the bin be taken from the original tip value or the reconstructed node value (if it is closer than the tip value)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the pruned phylogeny. The object <code>descendants</code> refers to the lineages the branch in the time bin gave rise to before it was pruned. If traits are included a vector of trait values representing species at the tips.
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>References</h3>

<p>Puttick, M. N., Kriwet, J., Wen, W., Hu, S., Thomas, G. H., &amp; Benton, M. J. (2017). Body length of bony fishes was not a selective factor during the biggest mass extinction of all time. Palaeontology, 60, 727-741.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## prune a random tree to taxa present between 4 and 2 units before present
# generate tree
set.seed(20)
tree &lt;- rtree(20)
# generate traits
traits &lt;- rnorm(20)
# plot tree and timeframe
plot(tree)
max.age &lt;- nodeTimes(tree)[1,1]
abline(v=max.age - c(4, 2))
# prune tree to timeframe
cont.tree &lt;- contemporaryPhy(phy=tree, maxBin=4, minBin=2, allTraits=traits)
plot(cont.tree$phy)
</code></pre>

<hr>
<h2 id='dropTipPartial'>Drop tips from a phylogenetic tree while preserving deleted nodes</h2><span id='topic+dropTipPartial'></span>

<h3>Description</h3>

<p>Wrapper for the <code>ape</code> function <code>drop.tip</code> that preserves the number of nodes affecting each branch. For use with the <code>psi</code> and <code>multipsi</code> models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dropTipPartial(phy, tip)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dropTipPartial_+3A_phy">phy</code></td>
<td>
<p>Phylogenetic tree in <code>phylo</code> format</p>
</td></tr>
<tr><td><code id="dropTipPartial_+3A_tip">tip</code></td>
<td>
<p>A vector of mode numeric or character specifying the tips to delete, to be passed to <code>drop.tip</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Phylogenetic tree in <code>phylo</code> format, with an added element <code>Shid</code>, a vector of numbers of observed but &quot;missing&quot; speciation events per branch, in the same order as the branches in the <code>phylo</code> object
</p>


<h3>Author(s)</h3>

<p>Travis Ingram
</p>


<h3>References</h3>

<p>Ingram, T. 2011. Speciation along a depth gradient in a marine adaptive radiation. Proc. R. Soc. B 278: 613-618.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Read in phylogeny and data from Thomas et al. (2009)
data(anolis.tree)
data(anolis.data)
## identify tips to drop
tips.to.go &lt;- anolis.tree$tip.label[1:30]
dropTipPartial(phy=anolis.tree, tip=tips.to.go)
</code></pre>

<hr>
<h2 id='fairProportions'>Calculate fair proportions phylogenetic diversity metric</h2><span id='topic+fairProportions'></span>

<h3>Description</h3>

<p>Calculate fair proportions phylogenetic diversity metric
Note that <code>as.rateMatrix</code> calls the CAIC function <code>vcv.array</code> multiple times and this can be slow for large phylogenies (though faster than using the &quot;ape&quot; equivalent <code>vcv.phylo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fairProportions(phy, nodeCount = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fairProportions_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="fairProportions_+3A_nodecount">nodeCount</code></td>
<td>
<p>Logical - should root to tip node counts be returned (default is <code>FALSE</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix of fair proportion for all tips in phylogeny and node counts if selected.
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas
</p>


<h3>References</h3>

<p>Redding, D.W. and Mooers, A.O. (2006). Incorporating evolutionary measures into conservation prioritisation. Conservation Biology, 20, 1670-1678.
</p>
<p>Isaac, N.J.B., Turvey, S.T., Collen, B., Waterman, C. and Baillie, J.E.M. (2007). Mammals on the EDGE: conservation priorities based on threat and phylogeny. PLoS ONE, 2, e296.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)

fp &lt;- fairProportions(anolis.tree)
fpNodes &lt;- fairProportions(anolis.tree, nodeCount=TRUE)
</code></pre>

<hr>
<h2 id='finch.data'>Finch phenotype data</h2><span id='topic+finch.data'></span>

<h3>Description</h3>

<p>Finch data from Clarke et al. 2017
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(finches)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"data.frame"</code>.</p>


<h3>References</h3>

<p>Clarke M, Thomas GH, Freckleton RP. 2017. Trait evolution in adaptive radiations: modelling and measuring interspecific competition on phylogenies. The American Naturalist. 189, 121-137.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(finches)
head(finch.data)
</code></pre>

<hr>
<h2 id='finch.tree'>Finch tree</h2><span id='topic+finch.tree'></span>

<h3>Description</h3>

<p>Finch data from Clarke et al. 2017
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(finches)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"phylo"</code></p>


<h3>References</h3>

<p>Clarke M, Thomas GH, Freckleton RP. 2017. Trait evolution in adaptive radiations: modelling and measuring interspecific competition on phylogenies. The American Naturalist. 189, 121-137.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(finches)
head(finch.tree)
</code></pre>

<hr>
<h2 id='likRatePhylo'>Log-likelihood rate estimation for traits and phylogenies</h2><span id='topic+likRatePhylo'></span>

<h3>Description</h3>

<p>This function calculates the log-likelihood, phylogenetic mean, and Brownian variance for a trait and a phylogeny transformed according to variation in relative rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likRatePhylo(
  rateData,
  rate = NULL,
  common.mean = FALSE,
  lambda.est = TRUE,
  lambda = 1,
  meserr = FALSE,
  sigmaScale = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="likRatePhylo_+3A_ratedata">rateData</code></td>
<td>
<p>an object of class <code>rateData</code></p>
</td></tr>
<tr><td><code id="likRatePhylo_+3A_rate">rate</code></td>
<td>
<p>a vector of relative rate parameters. The length of the vector is equal to the number of rates being estimated. If <code>rate=NULL</code> then rates are equal.</p>
</td></tr>
<tr><td><code id="likRatePhylo_+3A_common.mean">common.mean</code></td>
<td>
<p>a logical specififying whether each rate category should have its own mean (<code>common.mean=FALSE</code>) or all categories should have the same mean (<code>common.mean=FALSE</code>). See Thomas et al. (2009) for a discussion on the impact of assumptions about mean on rate estimates.#'</p>
</td></tr>
<tr><td><code id="likRatePhylo_+3A_lambda.est">lambda.est</code></td>
<td>
<p>Logical. Fit Pagel's lambda.</p>
</td></tr>
<tr><td><code id="likRatePhylo_+3A_lambda">lambda</code></td>
<td>
<p>Logical. Numeric value for lambda from 0-1.</p>
</td></tr>
<tr><td><code id="likRatePhylo_+3A_meserr">meserr</code></td>
<td>
<p>Logical. Logical. Include measurement error.</p>
</td></tr>
<tr><td><code id="likRatePhylo_+3A_sigmascale">sigmaScale</code></td>
<td>
<p>Logical. Scalar for measurement error relative to tree.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ll log-likelihood of the model
</p>
<p>mu phylogenetically corrected mean(s)
</p>
<p>s2 Brownian variance
</p>


<h3>Note</h3>

<p>The means are output as treatment contrasts.
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Rob Freckleton
</p>


<h3>References</h3>

<p>Thomas GH, Freckleton RP, &amp; Szekely T. 2006. Comparative analyses of the influence of developmental mode on phenotypic diversification rates in shorebirds. Proceedings of the Royal Society B 273, 1619-1624.
</p>
<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
data(anolis.data)

## Convert data to class rateData with a rateMatrix object as input
anolis.rateMatrix &lt;- as.rateMatrix(phy=anolis.tree, x="geo_ecomorph", data=anolis.data)

anolis.rateData &lt;- as.rateData(y="Female_SVL", x="geo_ecomorph", 
rateMatrix = anolis.rateMatrix, phy=NULL, data=anolis.data, log.y=TRUE)

## Calculate phylogenetic mean, variance, log likelihood for a model where the first 

# mean only
phyloMean(rateData=anolis.rateData, rate = c(1,2,0.1,1), common.mean = FALSE)

# variance only
phyloVar(rateData=anolis.rateData, rate = c(1,2,0.1,1), common.mean = FALSE) 

# mean, variance and log-likelihood
likRatePhylo(rateData=anolis.rateData, rate = c(1,2,0.1,1), common.mean = FALSE) 
</code></pre>

<hr>
<h2 id='likTraitPhylo'>Log-likelihood estimation for traits and phylogenies</h2><span id='topic+likTraitPhylo'></span>

<h3>Description</h3>

<p>This function calculates the log-likelihood and Brownian (co)variance for a trait(s) and a phylogeny using phylogenetically independent contrasts
Note that <code>as.rateMatrix</code> calls the CAIC function <code>vcv.array</code> multiple times and this can be slow for large phylogenies (though faster than using the &quot;ape&quot; equivalent <code>vcv.phylo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likTraitPhylo(y, phy, covPIC = TRUE, brCov = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="likTraitPhylo_+3A_y">y</code></td>
<td>
<p>A matrix of trait data. Rownames must be included and match the taxon names in the phylogeny. Can accept single traits (calculates variance) or multiple traits (calculates variance-covariance matrix).</p>
</td></tr>
<tr><td><code id="likTraitPhylo_+3A_phy">phy</code></td>
<td>
<p>An object of class &quot;phylo&quot; (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="likTraitPhylo_+3A_covpic">covPIC</code></td>
<td>
<p>Logical - allow for covariance between multivariate traits (<code>TRUE</code>), or assume not covariance (<code>FALSE</code>). Only applicable to multivariate traits</p>
</td></tr>
<tr><td><code id="likTraitPhylo_+3A_brcov">brCov</code></td>
<td>
<p>If <code>NULL</code> (the default), Brownian covariance is analytically estimated. If a user-supplied numerical value is suppied the likelihood is calculate given this value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>phylo</code> object must be rooted and fully dichotomous
</p>


<h3>Value</h3>

<p>brownianVariance Brownian variance (or covariance for multiple traits) given the data and phylogeny
</p>
<p>logLikelihood The log-likelihood of the model and data
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Rob Freckleton
</p>


<h3>References</h3>

<p>Felsenstein J. 1973. Maximum-likelihood estimation of evolutionary trees from continuous characters. Am. J. Hum. Genet. 25, 471-492.
</p>
<p>Felsenstein J. 1985. Phylogenies and the comparative method. American Naturalist 125, 1-15.
</p>
<p>Freckleton RP &amp; Jetz W. 2009. Space versus phylogeny: disentangling phylogenetic and spatial signals in comparative data. Proc. Roy. Soc. B 276, 21-30.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
data(anolis.data)
## calculate Brownian variance log-likelihood of female SVL
female.svl &lt;- matrix(anolis.data[,"Female_SVL"], 
dimnames=list(rownames(anolis.data)))
input.data &lt;- sortTraitData(phy=anolis.tree, y=female.svl, log.trait=TRUE)
likTraitPhylo(phy = input.data$phy, y=input.data$trait)
</code></pre>

<hr>
<h2 id='mammals'>Mammal data</h2><span id='topic+mammals'></span>

<h3>Description</h3>

<p>Mammal data from Slater 2013
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mammals)
</code></pre>


<h3>Format</h3>

<p>An list containing mass and errors of mammal body mass and mammal phylogeny of class <code>"phylo"</code></p>


<h3>References</h3>

<p>Phylogenetic evidence for a shift in the mode of mammalian body size evolution at the Cretaceous-Palaeogene boundary. Methods in Ecology and Evolution. 4: 734-744.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mammals)
</code></pre>

<hr>
<h2 id='mcmc.plot'>plot the output from transformPhylo.MCMC</h2><span id='topic+mcmc.plot'></span>

<h3>Description</h3>

<p>Plots a histogram of the estimated parameter and a trace of the results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc.plot(
  mcmc.input,
  y.limit = NULL,
  x.limit = NULL,
  label.text = NULL,
  cex.axis = 1,
  cex.labels = 0.7,
  col.hist = "green4",
  col.trace = "navy"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcmc.plot_+3A_mcmc.input">mcmc.input</code></td>
<td>
<p>an object of class &quot;mcmc.motmot&quot; output from <code><a href="#topic+transformPhylo.MCMC">transformPhylo.MCMC</a></code></p>
</td></tr>
<tr><td><code id="mcmc.plot_+3A_y.limit">y.limit</code></td>
<td>
<p>the limits for the y axes for the plots</p>
</td></tr>
<tr><td><code id="mcmc.plot_+3A_x.limit">x.limit</code></td>
<td>
<p>the limits for the x axes for the plots</p>
</td></tr>
<tr><td><code id="mcmc.plot_+3A_label.text">label.text</code></td>
<td>
<p>the labels for the two plots defaults to '(a)' etc., for the histogram and '(b)' etc., for the trace plot</p>
</td></tr>
<tr><td><code id="mcmc.plot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>character expansion for the plot axis labels</p>
</td></tr>
<tr><td><code id="mcmc.plot_+3A_cex.labels">cex.labels</code></td>
<td>
<p>character expansion for the plot axis names</p>
</td></tr>
<tr><td><code id="mcmc.plot_+3A_col.hist">col.hist</code></td>
<td>
<p>colour for the histogram bars</p>
</td></tr>
<tr><td><code id="mcmc.plot_+3A_col.trace">col.trace</code></td>
<td>
<p>colour for the trace plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two plots showing the histogram of the estimated parameter value and a trace of the MCMC estimation
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(motmot)
data(anolis.tree)
data(anolis.data)
attach(anolis.data)
male.length &lt;- matrix(Male_SVL, dimnames=list(rownames(anolis.data)))
sortedData &lt;- sortTraitData(anolis.tree, male.length)
phy &lt;- sortedData$phy
male.length &lt;- sortedData$trait
phy.clade &lt;- extract.clade(phy, 182)
male.length.clade &lt;- as.matrix(male.length[match(phy.clade$tip.label, rownames(male.length)),])
## not run
# please note, this model will be need to run for longer to achieve convergence
# lambda.mcmc &lt;- transformPhylo.MCMC(y=male.length.clade, phy=phy.clade, 
# model="lambda", mcmc.iteration=100, burn.in=0.1)
# mcmc.plot(lambda.mcmc)
</code></pre>

<hr>
<h2 id='ML.RatePhylo'>Maximum likelihood rate estimation for traits and phylogenies</h2><span id='topic+ML.RatePhylo'></span>

<h3>Description</h3>

<p>Full function for maximum likelihood estimation of rate parameters and comparison to a single rate model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ML.RatePhylo(
  rateData,
  rate = NULL,
  fixed = NULL,
  pretty = TRUE,
  rateMIN = 0.001,
  rateMAX = 50,
  common.mean = FALSE,
  lambda.est = TRUE,
  est.CI = FALSE,
  meserr = FALSE,
  file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ML.RatePhylo_+3A_ratedata">rateData</code></td>
<td>
<p>an object of class <code>rateData</code></p>
</td></tr>
<tr><td><code id="ML.RatePhylo_+3A_rate">rate</code></td>
<td>
<p>a vector of relative rate parameters. The length of the vector is equal to the number of rates being estimated. If <code>rate=NULL</code> then rates are equal.</p>
</td></tr>
<tr><td><code id="ML.RatePhylo_+3A_fixed">fixed</code></td>
<td>
<p>A vector stating whether each parameter should be allowed to vary (either <code>FALSE</code> which results in a start value of 1, or a numeric start value) or should be fixed (<code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="ML.RatePhylo_+3A_pretty">pretty</code></td>
<td>
<p>Display the output nicely (<code>pretty=TRUE</code>) or as a list (<code>pretty=FALSE</code>)</p>
</td></tr>
<tr><td><code id="ML.RatePhylo_+3A_ratemin">rateMIN</code></td>
<td>
<p>Minimum value for the rate parameters.</p>
</td></tr>
<tr><td><code id="ML.RatePhylo_+3A_ratemax">rateMAX</code></td>
<td>
<p>Maximum value for the rate parameters</p>
</td></tr>
<tr><td><code id="ML.RatePhylo_+3A_common.mean">common.mean</code></td>
<td>
<p>a logical specififying whether each rate category should have its own mean (<code>common.mean=FALSE</code>) or all categories should have the same mean (<code>common.mean=TRUE</code>). See Thomas et al. (2009) for a discussion on the impact of assumptions about mean on rate estimates.</p>
</td></tr>
<tr><td><code id="ML.RatePhylo_+3A_lambda.est">lambda.est</code></td>
<td>
<p>Logical. Estimate Pagel's lambda.</p>
</td></tr>
<tr><td><code id="ML.RatePhylo_+3A_est.ci">est.CI</code></td>
<td>
<p>Logical. Estimate approximate confidence intervals for rate parameters.</p>
</td></tr>
<tr><td><code id="ML.RatePhylo_+3A_meserr">meserr</code></td>
<td>
<p>Logical. Incorporate measurement error.</p>
</td></tr>
<tr><td><code id="ML.RatePhylo_+3A_file">file</code></td>
<td>
<p>File string for output. Only used if <code>pretty=TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>pretty=FALSE</code>, returns a list containing:
</p>

<ul>
<li> <p>MLRate Maximum likelihood estimates of the rate parameters
</p>
</li>
<li> <p>Lambda  Maximum likelihood estimate of lambda
</p>
</li>
<li> <p>LCI Approximate lower confidence intervals for rate
</p>
</li>
<li> <p>UCI Approximate upper confidence intervals for rate parameters
</p>
</li>
<li> <p>means Means for each category
</p>
</li>
<li> <p>nParam Number of parameters in the model (how many means and rate categories)
</p>
</li>
<li> <p>Max.lik Maximum (log) likeihood
</p>
</li>
<li> <p>AIC for maximum likelihood model
</p>
</li>
<li> <p>AICc for maximum likelihood model
</p>
</li>
<li> <p>LambdaSingle Maximum likelihood estimate of lambda for the single rate model
</p>
</li>
<li> <p>Lik1  Likelihood of the equivalent single rate model
</p>
</li>
<li> <p>Likelihood ratio statistic of &quot;Max.lik&quot; vs &quot;Lik1&quot;
</p>
</li>
<li> <p>P  P values for the LR statistic
</p>
</li>
<li> <p>df Degrees of freedom for the LR statistic
</p>
</li>
<li> <p>AIC.rate1 AIC for single rate model
</p>
</li>
<li> <p>AICc.rate1 AICc for single rate model
</p>
</li></ul>

<p>If <code>pretty=TRUE</code>, prints a nice version of the list to screen. If <code>file</code> is specified the pretty output will be sent to file, not the console.
</p>


<h3>Note</h3>

<p>Unlike phyloMean and likRatePhylo (that use treatment contrasts), the means reported here are the actual values
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Rob Freckleton
</p>


<h3>References</h3>

<p>Thomas GH, Freckleton RP, &amp; Szekely T. 2006. Comparative analyses of the influence of developmental mode on phenotypic diversification rates in shorebirds. Proceedings of the Royal Society B 273, 1619-1624.
</p>
<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Read in phylogeny and data from Thomas et al. (2009)
data(anolis.tree)
data(anolis.data)
## Convert data to class rateData with a rateMatrix object as input
anolis.rateMatrix &lt;- as.rateMatrix(phy=anolis.tree, x="geo_ecomorph",
data=anolis.data)
anolis.rateData &lt;- as.rateData(y="Female_SVL", x="geo_ecomorph", 
rateMatrix = anolis.rateMatrix, phy=NULL, data=anolis.data, log.y=TRUE)
# A model with a different rate in one of the four groups. The 'fixed' command is used to determine
# whether a particular rate is to be constrained or not. Use '1' to fix a group and 'FALSE' to show
# that the parameter is not fixed and should be estimated. The values should be entered in the same 
# order as the ranking of the groups. That is, group 0 (small islands) takes position one in the 
# fixed vector, group 1 (large island trunk crown and trunk ground) takes position 2 and so on. 
# The default is to allow each group to take a different mean. 
ML.RatePhylo(anolis.rateData, fixed=c(1, FALSE, FALSE, FALSE), pretty=TRUE, lambda.est = FALSE)
</code></pre>

<hr>
<h2 id='node.descendents'>Identify nodes and tips descended from a node</h2><span id='topic+node.descendents'></span>

<h3>Description</h3>

<p>Obtains a vector of the tips and nodes subtending from a node in a phylogeny.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>node.descendents(x, phy, tip.labels = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="node.descendents_+3A_x">x</code></td>
<td>
<p>A positive integer</p>
</td></tr>
<tr><td><code id="node.descendents_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="node.descendents_+3A_tip.labels">tip.labels</code></td>
<td>
<p>Logical - output tip.labels?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is stolen from the clade.members function in the CAIC package but returns both node and tip id's.
</p>


<h3>Value</h3>

<p>Returns a vector of node and tip ids descended from the tip(s) &quot;x&quot;. If tip.labels=TRUE then returns a list of node ids and tip labels.
</p>


<h3>Note</h3>

<p><code>as.rateMatrix</code> calls the CAIC function <code>vcv.array</code> multiple times and this can be slow for large phylogenies (though faster than using the <span class="pkg">ape</span> equivalent <code>vcv.phylo</code>).
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, David Orme
</p>

<hr>
<h2 id='nodeTimes'>Get times for nodes and tips</h2><span id='topic+nodeTimes'></span>

<h3>Description</h3>

<p>Produces branching and tip times for ultrametric and non-ultrametric trees
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nodeTimes(phy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nodeTimes_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix corresponging the phy &quot;edge&quot; matrix showning internal and external node times
</p>


<h3>Note</h3>

<p><code>nodeTimes</code> is essentially a re-written version of the <span class="pkg">ape</span> <code>branching.times</code>.
</p>


<h3>Author(s)</h3>

<p>Mark Puttick, Emmanuel Paradis
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Read in phylogeny from Thomas et al. (2009)
data(anolis.tree)
anolis.node.times &lt;- nodeTimes(phy=anolis.tree)
</code></pre>

<hr>
<h2 id='optim.likRatePhylo'>Maximum likelihood rate estimation for traits and phylogenies</h2><span id='topic+optim.likRatePhylo'></span>

<h3>Description</h3>

<p>Function for the maximum likelihood estimation of rate parameters on a trait and phylogeny.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optim.likRatePhylo(
  rateData,
  rate = NULL,
  fixed = NULL,
  rateMIN = 0.001,
  rateMAX = 50,
  common.mean = FALSE,
  lambda.est = TRUE,
  meserr = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="optim.likRatePhylo_+3A_ratedata">rateData</code></td>
<td>
<p>an object of class <code>rateData</code></p>
</td></tr>
<tr><td><code id="optim.likRatePhylo_+3A_rate">rate</code></td>
<td>
<p>a vector of relative rate parameters. The length of the vector is equal to the number of rates being estimated. If <code>rate=NULL</code> then rates are equal.</p>
</td></tr>
<tr><td><code id="optim.likRatePhylo_+3A_fixed">fixed</code></td>
<td>
<p>A vector stating whether each parameter should be allowed to vary (either <code>FALSE</code> which results in a start value of 1, or a numeric start value) or should be fixed (<code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="optim.likRatePhylo_+3A_ratemin">rateMIN</code></td>
<td>
<p>Minimum value for the rate parameters</p>
</td></tr>
<tr><td><code id="optim.likRatePhylo_+3A_ratemax">rateMAX</code></td>
<td>
<p>Maximum value for the rate parameters</p>
</td></tr>
<tr><td><code id="optim.likRatePhylo_+3A_common.mean">common.mean</code></td>
<td>
<p>a logical specififying whether each rate category should have its own mean (<code>common.mean=FALSE</code>) or all categories should have the same mean (<code>common.mean=FALSE</code>). See Thomas et al. (2009) for a discussion on the impact of assumptions about mean on rate estimates.</p>
</td></tr>
<tr><td><code id="optim.likRatePhylo_+3A_lambda.est">lambda.est</code></td>
<td>
<p>Logical. Fit Pagel's lambda.</p>
</td></tr>
<tr><td><code id="optim.likRatePhylo_+3A_meserr">meserr</code></td>
<td>
<p>Logical. Include measurement error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>MLRate Maximum likelihood estimates of the rate parameters
</p>
<p>Max.lik  Maximum (log) likeihood
</p>
<p>AIC AIC for maximum likelihood model
</p>
<p>AICc  AICc for maximum likelihood model
</p>
<p>convergence convergence value from <code>optim</code>
</p>
<p>n.parameters Number of parameters in the model (how many means and rate categories)
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas
</p>


<h3>References</h3>

<p>Thomas GH, Freckleton RP, &amp; Szekely T. 2006. Comparative analyses of the influence of developmental mode on phenotypic diversification rates in shorebirds. Proceedings of the Royal Society B 273, 1619-1624.
</p>
<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
data(anolis.data)

## Convert data to class rateData with a rateMatrix object as input
anolis.rateMatrix &lt;- as.rateMatrix(phy=anolis.tree, x="geo_ecomorph", data=anolis.data)

anolis.rateData &lt;- as.rateData(y="Female_SVL", x="geo_ecomorph", 
rateMatrix = anolis.rateMatrix, phy=NULL, data=anolis.data, log.y=TRUE)

# A model with a different rate in each of the four groups. The 'fixed' command is used to determine
# whether a particular rate is to be constrained or not. Use '1' to fix a group and 'FALSE' to show
# that the parameter is not fixed and should be estimated. The values should be entered in the same 
# order as the ranking of the groups. That is, group 0 (small islands) takes position one in the 
# fixed vector, group 1 (large island trunk crown and trunk ground) takes position 2 and so on. 
# The default is to allow each group to take a different mean. 

optim.likRatePhylo(anolis.rateData, rate=c(1,1,1,1), common.mean=TRUE, lambda.est=FALSE)
</code></pre>

<hr>
<h2 id='phyloCovar'>Calculation of Brownian (co)variance using independent contrasts.</h2><span id='topic+phyloCovar'></span>

<h3>Description</h3>

<p>Calculates the Brownian variance (single trait) or variance-covariance matrix (mutliple traits) using phylogenetically independent contrasts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phyloCovar(x, phy, estimator = "unbiased")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phyloCovar_+3A_x">x</code></td>
<td>
<p>A continuous trait</p>
</td></tr>
<tr><td><code id="phyloCovar_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="phyloCovar_+3A_estimator">estimator</code></td>
<td>
<p>Should Brownian variance (or covariance) be based on the unbiased (&quot;unbiased&quot; - default) or maximum likelihood (&quot;ML&quot;) estimator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>brownianVariance Brownian variance (or covariance for multiple traits) given the data and phylogeny
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Rob Freckleton
</p>


<h3>References</h3>

<p>Felsenstein J. 1973. Maximum-likelihood estimation of evolutionary trees from continuous characters. Am. J. Hum. Genet. 25, 471-492.
</p>
<p>Felsenstein J. 1985. Phylogenies and the comparative method. American Naturalist 125, 1-15.
</p>
<p>Freckleton RP &amp; Jetz W. 2009. Space versus phylogeny: disentangling phylogenetic and spatial signals in comparative data. Proc. Roy. Soc. B 276, 21-30.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
data(anolis.data)
## calculate Brownian variance of female SVL
female.svl &lt;- matrix(anolis.data[,"Female_SVL"], 
dimnames=list(rownames(anolis.data)))
input.data &lt;- sortTraitData(phy=anolis.tree, y=female.svl, log.trait=TRUE)
phyloCovar(x=input.data$trait, phy = input.data$phy)
</code></pre>

<hr>
<h2 id='phyloMean'>Calculation of phylogenetically corrected mean.</h2><span id='topic+phyloMean'></span>

<h3>Description</h3>

<p>This function calculates the phylogenetic mean of the data given the tree and model of evolution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phyloMean(
  rateData,
  rate = NULL,
  common.mean = FALSE,
  lambda.est = TRUE,
  lambda = 1,
  meserr = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phyloMean_+3A_ratedata">rateData</code></td>
<td>
<p>an object of class <code>rateData</code></p>
</td></tr>
<tr><td><code id="phyloMean_+3A_rate">rate</code></td>
<td>
<p>a vector of relative rate parameters. The length of the vector is equal to the number of rates being estimated. If <code>rate=NULL</code> then rates are equal.</p>
</td></tr>
<tr><td><code id="phyloMean_+3A_common.mean">common.mean</code></td>
<td>
<p>a logical specififying whether each rate category should have its own mean (<code>common.mean=FALSE</code>) or all categories should have the same mean (<code>common.mean=FALSE</code>). See Thomas et al. (2009) for a discussion on the impact of assumptions about mean on rate estimates.</p>
</td></tr>
<tr><td><code id="phyloMean_+3A_lambda.est">lambda.est</code></td>
<td>
<p>Logical. Fit Pagel's lambda.</p>
</td></tr>
<tr><td><code id="phyloMean_+3A_lambda">lambda</code></td>
<td>
<p>Numeric value for lambda from 0-1.</p>
</td></tr>
<tr><td><code id="phyloMean_+3A_meserr">meserr</code></td>
<td>
<p>Logical. Include measurement error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mu phylogenetically corrected mean
</p>


<h3>Note</h3>

<p>The means are output as treatment contrasts.
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Rob Freckleton
</p>


<h3>References</h3>

<p>Thomas GH, Freckleton RP, &amp; Szekely T. 2006. Comparative analyses of the influence of developmental mode on phenotypic diversification rates in shorebirds. Proceedings of the Royal Society B 273, 1619-1624.
</p>
<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Read in phylogeny and data from Thomas et al. (2009)
data(anolis.tree)
data(anolis.data)

## Convert data to class rateData with a rateMatrix object as input
anolis.rateMatrix &lt;- as.rateMatrix(phy=anolis.tree, x="geo_ecomorph", data=anolis.data)

anolis.rateData &lt;- as.rateData(y="Female_SVL", x="geo_ecomorph", 
rateMatrix = anolis.rateMatrix, phy=NULL, data=anolis.data, log.y=TRUE)

# A model with a different rate in each of the four groups. The 'fixed' command is used to determine
# whether a particular rate is to be constrained or not. Use '1' to fix a group and 'FALSE' to show
# that the parameter is not fixed and should be estimated. The values should be entered in the same 
# order as the ranking of the groups. That is, group 0 (small islands) takes position one in the 
# fixed vector, group 1 (large island trunk crown and trunk ground) takes position 2 and so on. 
# The default is to allow each group to take a different mean. 

phyloMean(anolis.rateData, rate=c(1,1,1,1), common.mean=FALSE)
# common mean for all groups
phyloMean(anolis.rateData, rate=c(1,1,1,1), common.mean=TRUE)
</code></pre>

<hr>
<h2 id='phyloVar'>Calculation of Brownian variance.</h2><span id='topic+phyloVar'></span>

<h3>Description</h3>

<p>This function calculates the phylogenetic variance (Brownian variance, or rate) of the data given the tree and model of evolution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phyloVar(
  rateData,
  rate = NULL,
  common.mean = FALSE,
  lambda.est = TRUE,
  lambda = 1,
  meserr = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phyloVar_+3A_ratedata">rateData</code></td>
<td>
<p>an object of class <code>rateData</code></p>
</td></tr>
<tr><td><code id="phyloVar_+3A_rate">rate</code></td>
<td>
<p>a vector of relative rate parameters. The length of the vector is equal to the number of rates being estimated. If <code>rate=NULL</code> then rates are equal.</p>
</td></tr>
<tr><td><code id="phyloVar_+3A_common.mean">common.mean</code></td>
<td>
<p>a logical specififying whether each rate category should have its own mean (<code>common.mean=FALSE</code>) or all categories should have the same mean (<code>common.mean=FALSE</code>). See Thomas et al. (2009) for a discussion on the impact of assumptions about mean on rate estimates.</p>
</td></tr>
<tr><td><code id="phyloVar_+3A_lambda.est">lambda.est</code></td>
<td>
<p>Logical. Fit Pagel's lambda.</p>
</td></tr>
<tr><td><code id="phyloVar_+3A_lambda">lambda</code></td>
<td>
<p>Numeric value for lambda from 0-1.</p>
</td></tr>
<tr><td><code id="phyloVar_+3A_meserr">meserr</code></td>
<td>
<p>Logical. Include measurement error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>phylo.var  phylogenetic variance (Brownian variance)
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Rob Freckleton
</p>


<h3>References</h3>

<p>Thomas GH, Freckleton RP, &amp; Szekely T. 2006. Comparative analyses of the influence of developmental mode on phenotypic diversification rates in shorebirds. Proceedings of the Royal Society B 273, 1619-1624.
@references Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## Read in phylogeny and data from Thomas et al. (2009)
data(anolis.tree)
data(anolis.data)

## Convert data to class rateData with a rateMatrix object as input
anolis.rateMatrix &lt;- as.rateMatrix(phy=anolis.tree, x="geo_ecomorph", data=anolis.data)

anolis.rateData &lt;- as.rateData(y="Female_SVL", x="geo_ecomorph", 
rateMatrix = anolis.rateMatrix, phy=NULL, data=anolis.data, log.y=TRUE)

# A model with a different rate in each of the four groups. The 'fixed' command is used to determine
# whether a particular rate is to be constrained or not. Use '1' to fix a group and 'FALSE' to show
# that the parameter is not fixed and should be estimated. The values should be entered in the same 
# order as the ranking of the groups. That is, group 0 (small islands) takes position one in the 
# fixed vector, group 1 (large island trunk crown and trunk ground) takes position 2 and so on. 
# The default is to allow each group to take a different mean. 

phyloVar(anolis.rateData, rate=c(1,2,1,1), common.mean=FALSE)
# common mean for all groups
phyloVar(anolis.rateData, rate=c(1,2,1,1), common.mean=TRUE)
</code></pre>

<hr>
<h2 id='pic.pgls'>Fast PLGS estimation based on contrasts</h2><span id='topic+pic.pgls'></span>

<h3>Description</h3>

<p>Estimates regression parameters for a phylogenetic generalised least-squares analysis using the fast constrasts method (Felsenstein 1973; 1985; Freckleton 2012). This implementation is applicable for continuous traits only and not factors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pic.pgls(
  formula,
  phy,
  y,
  lambda = "ML",
  return.intercept.stat = FALSE,
  meserr = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pic.pgls_+3A_formula">formula</code></td>
<td>
<p>A model formula with continuous variables only</p>
</td></tr>
<tr><td><code id="pic.pgls_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="pic.pgls_+3A_y">y</code></td>
<td>
<p>A matrix of trait values with rownames corresponding to the phy tip labels, and column names corresponding to the formula variable names</p>
</td></tr>
<tr><td><code id="pic.pgls_+3A_lambda">lambda</code></td>
<td>
<p>Default is &quot;ML&quot; meaning the phylogenetic signal of the response variable will be estimated using restricted Maximum likelihood. If a numeric value between 0-1 is provided this will be used in the calculation of regression coefficients</p>
</td></tr>
<tr><td><code id="pic.pgls_+3A_return.intercept.stat">return.intercept.stat</code></td>
<td>
<p>Logical. If <code>TRUE</code> the standard errors, t value, and p value of the estimated Intercept is provided for comparison with output from <code><a href="caper.html#topic+pgls">pgls</a></code> from <span class="pkg">caper</span> etc.,. Default is <code>FALSE</code> as this slows the function as it involves constructing and calculating the inverse of the phy variance-covariance matrix, and based on contrasts the design matrix column of ones would have zero contrasts.</p>
</td></tr>
<tr><td><code id="pic.pgls_+3A_meserr">meserr</code></td>
<td>
<p>A vector (or matrix) of measurement error for each tip. This is only applicable to univariate analyses.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the model, model summary, intercept, estimate of Lambda, model log-Likelihood, model AIC
</p>


<h3>Author(s)</h3>

<p>Mark N Puttick and Rob Freckleton
</p>


<h3>See Also</h3>

<p><code><a href="caper.html#topic+pgls">pgls</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data and phylogeny
data(anolis.tree)
anolis.tree$node.label &lt;- NULL
lm.data &lt;- transformPhylo.sim(phy=anolis.tree, n=2, model="bm")
dat &lt;- data.frame(x = lm.data[,1], y = lm.data[,2],
names = anolis.tree$tip, row.names = anolis.tree$tip)
picModel &lt;- pic.pgls(formula=y ~  x,
phy=anolis.tree, y = dat, lambda=1,
return.intercept.stat=FALSE)
</code></pre>

<hr>
<h2 id='plot.timeSlice.ML'>Identify shifts in the rate of trait diversification through time</h2><span id='topic+plot.timeSlice.ML'></span>

<h3>Description</h3>

<p>Summarises phenotypic rate variation on phylogenies through
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'timeSlice.ML'
plot(
  x,
  ...,
  cutoff = 4,
  AICc = TRUE,
  lowerBound = 1e-08,
  upperBound = 1000,
  phylo.plot = TRUE,
  colour.ramp = c("blue", "red"),
  cex.plot = 1,
  model.average = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.timeSlice.ML_+3A_x">x</code></td>
<td>
<p>Output of a timeSlice analysis in <code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code></p>
</td></tr>
<tr><td><code id="plot.timeSlice.ML_+3A_...">...</code></td>
<td>
<p>Other functions to pass to <code><a href="ape.html#topic+plot.phylo">plot.phylo</a></code></p>
</td></tr>
<tr><td><code id="plot.timeSlice.ML_+3A_cutoff">cutoff</code></td>
<td>
<p>Value for differences in AIC scores when comparing models. More complex models with an AIC score more than this number of units lower than simpler models are retained (as per runMedusa in the geiger package).</p>
</td></tr>
<tr><td><code id="plot.timeSlice.ML_+3A_aicc">AICc</code></td>
<td>
<p>If <code>TRUE</code>, AICc is used instead of AIC.</p>
</td></tr>
<tr><td><code id="plot.timeSlice.ML_+3A_lowerbound">lowerBound</code></td>
<td>
<p>Minimum value for parameter estimates.</p>
</td></tr>
<tr><td><code id="plot.timeSlice.ML_+3A_upperbound">upperBound</code></td>
<td>
<p>Maximum value for parameter estimates.</p>
</td></tr>
<tr><td><code id="plot.timeSlice.ML_+3A_phylo.plot">phylo.plot</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the phylogeny is plotted</p>
</td></tr>
<tr><td><code id="plot.timeSlice.ML_+3A_colour.ramp">colour.ramp</code></td>
<td>
<p>The colours signifying different rates from low (first colour) to high (second colour)</p>
</td></tr>
<tr><td><code id="plot.timeSlice.ML_+3A_cex.plot">cex.plot</code></td>
<td>
<p>Character expansion for the plot of rates through time</p>
</td></tr>
<tr><td><code id="plot.timeSlice.ML_+3A_model.average">model.average</code></td>
<td>
<p>Logical only applicable to &quot;timeSlice&quot; models. Will return the model averaged timeSlice for models in which multiple shifts were considered (i.e, when splitTime is NULL). If TRUE, the function returns a plot showing the relative weights of each shift time and the model-averaged rates through time that are weighted by their relative weights. If TRUE, plot.phylo is ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions summarises the output of a &quot;timeSlice&quot; model in <code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code> (see below). The best overall model is chosen based on AIC (or AICc if AICc=TRUE). The cut-off point for improvement in AIC score between successively more complex models can be defined using cutoff. The default cutoff is 4 but this is somewhat arbitrary and a &quot;good&quot; cut-off may well vary between data sets so it may well be worth exploring different cutoffs.
</p>


<h3>Value</h3>

<p>ModelFit Summary of the best optimal rate shift model or the model average of each split time (if model averaging was used).
</p>
<p>Rates Summary of the rate parameters from the best rate shift model or the model averaged rates through time.
</p>
<p>optimalTree A phylo object with branch lengths scaled relative to rate and a plot of estimated rates through time with their associated CIs.
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>References</h3>

<p>To Add
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
data(anolis.data)
attach(anolis.data)
male.length &lt;- matrix(Male_SVL, dimnames=list(rownames(anolis.data)))
sortedData &lt;- sortTraitData(anolis.tree, male.length)
phy &lt;- sortedData$phy
male.length &lt;- sortedData$trait
phy.clade &lt;- extract.clade(phy, 182)
male.length.clade &lt;- as.matrix(male.length[match(phy.clade$tip.label, 
rownames(male.length)),])
timeSlice.10.ml &lt;- transformPhylo.ML(y=male.length.clade, phy=phy.clade, model="timeSlice", 
splitTime=c(10))
outputSummary &lt;- plot(timeSlice.10.ml, cutoff=0.001, cex=0.5, 
colour.ramp=c("blue", "red"))
</code></pre>

<hr>
<h2 id='plot.traitMedusa.model'>Tree plotting for rates</h2><span id='topic+plot.traitMedusa.model'></span>

<h3>Description</h3>

<p>Plots trees with colours based on rates of trait evolution. Also provides simple coloured plotting for trait values using the <code><a href="ape.html#topic+ace">ace</a></code> function in the <span class="pkg">ape</span> library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'traitMedusa.model'
plot(x, y = NULL, ..., reconType = "rates", palette = "hotspot.colors")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.traitMedusa.model_+3A_x">x</code></td>
<td>
<p>Output from <code><a href="#topic+summary.traitMedusa">summary.traitMedusa</a></code>.</p>
</td></tr>
<tr><td><code id="plot.traitMedusa.model_+3A_y">y</code></td>
<td>
<p>A matrix of trait values.</p>
</td></tr>
<tr><td><code id="plot.traitMedusa.model_+3A_...">...</code></td>
<td>
<p>Other functions to pass to <code><a href="ape.html#topic+plot.phylo">plot.phylo</a></code></p>
</td></tr>
<tr><td><code id="plot.traitMedusa.model_+3A_recontype">reconType</code></td>
<td>
<p>Colour branches according to rate shifts (&quot;rates&quot; - requires traitMedusaObject) or ancestral state reconstruction (&quot;picReconstruction&quot;  - requires x).</p>
</td></tr>
<tr><td><code id="plot.traitMedusa.model_+3A_palette">palette</code></td>
<td>
<p>Defines the colour scheme with four options: hotspot.colors (red to blue), heat.colors (yellow to red), cool.colors (blues), combi.colors (yellows to reds and blues)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame of colours used in plot along with rate (or ancestral state) range for each colour.
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Mark Puttick
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>, <code><a href="#topic+summary.traitMedusa">summary.traitMedusa</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data and phylogeny
data(anolis.tree)
data(anolis.data)

# female SVL data
female.svl &lt;- matrix(anolis.data[,"Female_SVL"], 
dimnames=list(rownames(anolis.data)))
input.data &lt;- sortTraitData(phy=anolis.tree, y=female.svl, log.trait=TRUE)

# arbitarily reduce data size for speed in this example
phy.clade &lt;- extract.clade(input.data[[1]], 182)
male.length.clade &lt;- as.matrix(input.data[[2]][match(input.data[[1]]$tip.label, 
rownames(input.data[[2]])),])
# Identify rate shifts and print and plot results with up to one rate shifts 
# and minimum clade size of 10.
anolisSVL_MEDUSA &lt;- transformPhylo.ML(male.length.clade, phy=phy.clade, 
model="tm1",minCladeSize=10, nSplits=1)
anolisSVL_MEDUSA_out &lt;- summary(anolisSVL_MEDUSA, cutoff=1, AICc=FALSE)
colours &lt;- plot(x = anolisSVL_MEDUSA_out,
reconType = "rates", type = "fan", cex=0.6, edge.width=3)
</code></pre>

<hr>
<h2 id='RatePhylo.allCI'>Confidence intervals for rate parameters</h2><span id='topic+RatePhylo.allCI'></span>

<h3>Description</h3>

<p>Calculates approximate confidence intervals for all rate parameters. CIs are esimated for one rate parameters while fixing others at a given value (usually the maximum likelihood estimate).
</p>
<p>These are reliable (given the asympotic assumptions of the chi-square distribution) if only two groups are being compared but should be regarded only as a rough approximation for =&gt;3 different rate categories. If the rates are correlated the CIs may be underestimated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RatePhylo.allCI(
  rateData,
  MLrate = NULL,
  fixed = NULL,
  rateMIN = 0.001,
  rateMAX = 50,
  common.mean = FALSE,
  lambda.est = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RatePhylo.allCI_+3A_ratedata">rateData</code></td>
<td>
<p>an object of class <code>rateData</code></p>
</td></tr>
<tr><td><code id="RatePhylo.allCI_+3A_mlrate">MLrate</code></td>
<td>
<p>a vector of relative rate parameters. The length of the vector is equal to the number of rates being estimated. If <code>rate=NULL</code> then rates are equal. Normally these will be the maximum likelihood rate estimates.</p>
</td></tr>
<tr><td><code id="RatePhylo.allCI_+3A_fixed">fixed</code></td>
<td>
<p>A vector stating whether each parameter should be allowed to vary (either <code>FALSE</code> which results in a start value of 1, or a numeric start value) or should be fixed (<code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="RatePhylo.allCI_+3A_ratemin">rateMIN</code></td>
<td>
<p>Minimum value for the rate parameters</p>
</td></tr>
<tr><td><code id="RatePhylo.allCI_+3A_ratemax">rateMAX</code></td>
<td>
<p>Maximum value for the rate parameters</p>
</td></tr>
<tr><td><code id="RatePhylo.allCI_+3A_common.mean">common.mean</code></td>
<td>
<p>a logical specififying whether each rate category should have its own mean (<code>common.mean=FALSE</code>) or all categories should have the same mean (<code>common.mean=FALSE</code>). See Thomas et al. (2009) for a discussion on the impact of assumptions about mean on rate estimates.</p>
</td></tr>
<tr><td><code id="RatePhylo.allCI_+3A_lambda.est">lambda.est</code></td>
<td>
<p>Logical. Estimate Pagel's lambda.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>rateLci Lower confidence interval for rate estimate
</p>
<p>rateUci Upper confidence interval for rate estimate
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Rob Freckleton
</p>


<h3>References</h3>

<p>Thomas GH, Freckleton RP, &amp; Szekely T. 2006. Comparative analyses of the influence of developmental mode on phenotypic diversification rates in shorebirds. Proceedings of the Royal Society B 273, 1619-1624.
</p>
<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.data)
data(anolis.tree)
## Convert data to class rateData with a rateMatrix object as input
anolis.rateMatrix &lt;- as.rateMatrix(phy=anolis.tree, x="geo_ecomorph", data=anolis.data)

anolis.rateData &lt;- as.rateData(y="Female_SVL", x="geo_ecomorph", 
rateMatrix = anolis.rateMatrix, phy=NULL, data=anolis.data, log.y=TRUE)

# A model with a different rate in each of the four groups. The 'fixed' command is used to determine
# whether a particular rate is to be constrained or not. Use '1' to fix a group and 'FALSE' to show 
# that the parameter is not fixed and should be estimated. The values should be entered in the same
# order as the ranking of the groups. That is, group 0 (small islands) takes position one in the 
# fixed vector, group 1 (large island trunk crown and trunk ground) takes position 2 and so on. The 
# default is to allow each group to take a different mean. 

anole.ML &lt;- optim.likRatePhylo(rateData=anolis.rateData, rate=NULL,
fixed=c(FALSE,FALSE,FALSE, FALSE),
common.mean=FALSE, lambda.est=FALSE)

# Confidence intervals for the first two parameters

RatePhylo.allCI(rateData=anolis.rateData, MLrate = anole.ML$MLRate, 
fixed=c(FALSE, TRUE, TRUE, TRUE), rateMIN = 0.001, rateMAX = 50, 
common.mean = FALSE)
</code></pre>

<hr>
<h2 id='sampleShid'>Sample hidden speciation events along branches of a tree</h2><span id='topic+sampleShid'></span>

<h3>Description</h3>

<p>Uses estimated speciation and extinction rates to sample the number of speciation events 'hidden' by subsequent extinction on each branch of a tree following Bokma (2008). For use with the <code>psi</code> and <code>multipsi</code> models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleShid(phy, la = NULL, mu = NULL, useMean = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sampleShid_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>)</p>
</td></tr>
<tr><td><code id="sampleShid_+3A_la">la</code></td>
<td>
<p>Estimate of the rate of speciation &quot;lambda&quot;</p>
</td></tr>
<tr><td><code id="sampleShid_+3A_mu">mu</code></td>
<td>
<p>Estimate of the rate of extinction &quot;mu&quot;</p>
</td></tr>
<tr><td><code id="sampleShid_+3A_usemean">useMean</code></td>
<td>
<p>A logical indicating whether to output the average or expected number of hidden speciation events per branch, which may be non-integer (if <code>TRUE</code>), or to sample an integer number on each branch from a Poisson distribution (if <code>FALSE</code>, the default)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The expected number of hidden speciation events are calculated for each branch given its start and end times, and estimates of lambda and mu which are assumed to be constant across the tree. To properly account for uncertainty in the effect of extinction on the number of nodes affecting each branch of a tree, it may be appropriate to repeat model-fitting on many realizations of <code>Sobs</code> on the tree of interest (similar to evaluating phylogenetic uncertainty)
</p>


<h3>Value</h3>

<p>Phylogenetic tree in <code>phylo</code> format, with an added element <code>Sobs</code>, a vector of numbers of hidden speciation events per branch, in the same order as the branches in the <code>phylo</code> object
</p>


<h3>Author(s)</h3>

<p>Travis Ingram
</p>


<h3>References</h3>

<p>Bokma, F. 2008. Detection of &quot;punctuated equilibrium&quot; by Bayesian estimation of speciation and extinction rates, ancestral character states, and rates of anagenetic and cladogenetic evolution on a molecular phylogeny. Evolution 62: 2718-2726.
</p>
<p>Ingram, T. 2011. Speciation along a depth gradient in a marine adaptive radiation. Proc. R. Soc. B 278: 613-618.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>
</p>

<hr>
<h2 id='sortTraitData'>Sort data and remove missing entries for tree and trait data</h2><span id='topic+sortTraitData'></span>

<h3>Description</h3>

<p>Plots a phylogeny with lines representing the value of a continuous trait
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sortTraitData(
  phy,
  y,
  data.name = NULL,
  log.trait = TRUE,
  pass.ultrametric = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sortTraitData_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> or <code>multiPhylo</code>  (see <span class="pkg">ape</span>)</p>
</td></tr>
<tr><td><code id="sortTraitData_+3A_y">y</code></td>
<td>
<p>A matrix of trait values with taxon names as rownames. Missing values should be NA</p>
</td></tr>
<tr><td><code id="sortTraitData_+3A_data.name">data.name</code></td>
<td>
<p>If null the first column of y is assummed as the trait, otherwise if y is a matrix with more than one column either the name of the column or the number of the column must be supplied by data.name</p>
</td></tr>
<tr><td><code id="sortTraitData_+3A_log.trait">log.trait</code></td>
<td>
<p>Logical. If <code>TRUE</code>, data are log-transformed</p>
</td></tr>
<tr><td><code id="sortTraitData_+3A_pass.ultrametric">pass.ultrametric</code></td>
<td>
<p>Although trees that are believed to be ultrametric to pass the function <code>is.ultrametric</code> in <span class="pkg">ape</span></p>
</td></tr>
</table>


<h3>Value</h3>

<p>phy Tree with missing data pruned
</p>
<p>trait Rearranged data with missing species removed
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
data(anolis.data)
attach(anolis.data)
male.length &lt;- matrix(Male_SVL, dimnames=list(rownames(anolis.data)))
any(is.na(male.length[,1]))
data.sorted &lt;- sortTraitData(anolis.tree, male.length)
phy &lt;- data.sorted[[1]]
male.length &lt;- data.sorted[[2]]
</code></pre>

<hr>
<h2 id='summary.traitMedusa'>Identify shifts in the rate of trait diversification</h2><span id='topic+summary.traitMedusa'></span>

<h3>Description</h3>

<p>Summarises phenotypic rate variation on phylogenies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'traitMedusa'
summary(
  object,
  ...,
  cutoff = 4,
  AICc = TRUE,
  lowerBound = 1e-08,
  upperBound = 200,
  print.warnings = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.traitMedusa_+3A_object">object</code></td>
<td>
<p>Output of a traitMedusa analysis in <code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>.</p>
</td></tr>
<tr><td><code id="summary.traitMedusa_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="base.html#topic+summary">summary</a></code>.</p>
</td></tr>
<tr><td><code id="summary.traitMedusa_+3A_cutoff">cutoff</code></td>
<td>
<p>Cutoff value for differences in AIC scores when comparing models. More complex models with an AIC score more than this number of units lower than simpler models are retained (as per runMedusa in the <span class="pkg">geiger</span>).</p>
</td></tr>
<tr><td><code id="summary.traitMedusa_+3A_aicc">AICc</code></td>
<td>
<p>If true, AICc is used instead of AIC.</p>
</td></tr>
<tr><td><code id="summary.traitMedusa_+3A_lowerbound">lowerBound</code></td>
<td>
<p>Minimum value for parameter estimates.</p>
</td></tr>
<tr><td><code id="summary.traitMedusa_+3A_upperbound">upperBound</code></td>
<td>
<p>Maximum value for parameter estimates.</p>
</td></tr>
<tr><td><code id="summary.traitMedusa_+3A_print.warnings">print.warnings</code></td>
<td>
<p>Logical. If TRUE, warnings are issued if confidence intervals fall outside upper or lower bounds.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions summarises the output of a &quot;medusa&quot; model in transformPhylo.ML (see below). The best overall model is chosen based on AIC (or AICc if AICc=TRUE). The cut-off point for improvement in AIC score between successively more complex models can be defined using cutoff. The default cutoff is 4 but this is somewhat arbitrary and a &quot;good&quot; cut-off may well vary between data sets so it may well be worth exploring different cutoffs.
</p>


<h3>Value</h3>

<p>ModelFit Summary of the best optimal rate shift model.
</p>
<p>Rates Summary of the rate parameters from the best rate shift model.
</p>
<p>optimalTree A phylo object with branch lengths scaled relative to rate.
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas
</p>


<h3>References</h3>

<p>Alfaro ME, Santini F, Brock CD, Alamillo H, Dornburg A, Carnevale G, Rabosky D &amp; Harmon LJ. 2009. Nine exceptional radiations plus high turnover explain species diversity in jawed vertebrates. PNAS 106, 13410-13414.
</p>
<p>O'Meara BC, Ane C, Sanderson MJ &amp; Wainwright PC. 2006. Testing for different rates of continuous trait evolution using likelihood. Evolution 60, 922-933
</p>
<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
data(anolis.data)
attach(anolis.data)
male.length &lt;- matrix(Male_SVL, dimnames=list(rownames(anolis.data)))
sortedData &lt;- sortTraitData(anolis.tree, male.length)
phy &lt;- sortedData$phy
male.length &lt;- sortedData$trait
phy.clade &lt;- extract.clade(phy, 182)
male.length.clade &lt;- as.matrix(male.length[match(phy.clade$tip.label, rownames(male.length)),])
tm1 &lt;- transformPhylo.ML(male.length.clade, phy=phy.clade, model="tm1", minCladeSize=10, nSplits=1)
tm1_out &lt;- summary(tm1, cutoff=1)
</code></pre>

<hr>
<h2 id='traitData.plot'>plot a univariate continuous trait data on a phylogeny</h2><span id='topic+traitData.plot'></span>

<h3>Description</h3>

<p>Plots a phylogeny with lines representing the value of a continuous trait
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traitData.plot(
  y,
  phy,
  col.label = "red",
  col.tree = "black",
  col.hist = "navy",
  cex.plot = 0.7,
  cex.tips = 0.7,
  show.tips = FALSE,
  include.hist = FALSE,
  n.split = 5,
  lwd.traits = 1,
  show.axis = TRUE,
  axis.text = NULL,
  transform.axis.label = NULL,
  at = NULL,
  labels = NULL,
  axis.text.line = 1,
  offset.bars = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="traitData.plot_+3A_y">y</code></td>
<td>
<p>A matrix of trait values with taxon names as rownames.</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_col.label">col.label</code></td>
<td>
<p>colour labels for the traits at the tips and in the histogram</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_col.tree">col.tree</code></td>
<td>
<p>colour for the edge labels on the tree</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_col.hist">col.hist</code></td>
<td>
<p>colour of the histogram</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_cex.plot">cex.plot</code></td>
<td>
<p>Numeric. The size of labels for the histogram axis labels</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_cex.tips">cex.tips</code></td>
<td>
<p>Numeric. The size of the phylogeny tip labels</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_show.tips">show.tips</code></td>
<td>
<p>Logical. If FALSE (default), no tip labels are shown. If TRUE, tip labels are shown</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_include.hist">include.hist</code></td>
<td>
<p>Logical. Include a histrogram alongside the plot of the tree?</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_n.split">n.split</code></td>
<td>
<p>Numeric. The number of splits for the axis labels and shading for the trait values</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_lwd.traits">lwd.traits</code></td>
<td>
<p>Line widths of traits shown on the plot</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_show.axis">show.axis</code></td>
<td>
<p>Logical. If TRUE, shows the axis of trait values on the plot.</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_axis.text">axis.text</code></td>
<td>
<p>text shown above the trait label axis. If NULL (default), nothing is displayed</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_transform.axis.label">transform.axis.label</code></td>
<td>
<p>If the data are provided as logarithms the labels for trait axis can be transformed to their original values by calculating the exponential function of the natural (transform.axis.label=&quot;exp&quot;) or base 10 logarithm. The default (NULL) leaves the labels un-transformed.</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_at">at</code></td>
<td>
<p>Axis tick point locations for if show.axis is TRUE.</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_labels">labels</code></td>
<td>
<p>Axis labels locations for if show.axis is TRUE.</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_axis.text.line">axis.text.line</code></td>
<td>
<p>The location of the label for the trait axis beside the plot.</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_offset.bars">offset.bars</code></td>
<td>
<p>The distance of trait plot lines from the phylogeny.</p>
</td></tr>
<tr><td><code id="traitData.plot_+3A_...">...</code></td>
<td>
<p>further arguments passed to the axis function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with the trait values shown at the tips, and a histrogram of the trait values
</p>


<h3>Author(s)</h3>

<p>Mark Puttick
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
data(anolis.data)
attach(anolis.data)
male.length &lt;- matrix(Male_SVL, dimnames=list(rownames(anolis.data)))
sortedData &lt;- sortTraitData(anolis.tree, male.length)
phy &lt;- sortedData$phy
male.length &lt;- sortedData$trait
traitData.plot(y=male.length, phy)
</code></pre>

<hr>
<h2 id='transformPhylo'>Phylogenetic tree transformations</h2><span id='topic+transformPhylo'></span>

<h3>Description</h3>

<p>Transforms the branch lengths of a phylo object according to a model of trait evolution (see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformPhylo(
  phy,
  model = NULL,
  y = NULL,
  meserr = NULL,
  kappa = NULL,
  lambda = NULL,
  delta = NULL,
  alpha = NULL,
  psi = NULL,
  lambda.sp = NULL,
  nodeIDs = NULL,
  rateType = NULL,
  branchRates = NULL,
  cladeRates = NULL,
  splitTime = NULL,
  timeRates = NULL,
  acdcRate = NULL,
  branchLabels = NULL,
  cophenetic.dist = NULL,
  vcv.matrix = NULL,
  mode.order = NULL,
  mode.param = NULL,
  rate.var = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformPhylo_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_model">model</code></td>
<td>
<p>The model of trait evolution (see details).</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_y">y</code></td>
<td>
<p>A matrix of trait values.</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_meserr">meserr</code></td>
<td>
<p>A vector (or matrix) of measurement error for each tip. This is only applicable to univariate analyses. Largely untested - please use cautiously</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_kappa">kappa</code></td>
<td>
<p>Value of kappa transform.</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_lambda">lambda</code></td>
<td>
<p>Value of lambda transform.</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_delta">delta</code></td>
<td>
<p>Value of delta transform.</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_alpha">alpha</code></td>
<td>
<p>Value of alpha (OU) transform.</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_psi">psi</code></td>
<td>
<p>Value of psi transform.</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_lambda.sp">lambda.sp</code></td>
<td>
<p>Estimate of speciation (lambda) for the psi models</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_nodeids">nodeIDs</code></td>
<td>
<p>Integer - ancestral nodes of clades.</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_ratetype">rateType</code></td>
<td>
<p>If model=&quot;clade&quot;, a vector specifying if rate shift occurs in a clade (&quot;clade&quot;) or on the single branch leading to a clade (&quot;branch&quot;).</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_branchrates">branchRates</code></td>
<td>
<p>Numeric vector specifying relative rates for individual branches</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_claderates">cladeRates</code></td>
<td>
<p>Numeric vector specifying telative rates for clades or logical to indicate scalar is included in the 'modeslice' model (the scalar is included in the mode.param argument with the 'modeslice' model).</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_splittime">splitTime</code></td>
<td>
<p>A split time (measured from the present, or most recent species) at which a shift in the rate occurs for the &quot;timeSlice&quot; model</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_timerates">timeRates</code></td>
<td>
<p>The rates (from ancient to recent) for the timeSlice model</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_acdcrate">acdcRate</code></td>
<td>
<p>Value of ACDC transform.</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_branchlabels">branchLabels</code></td>
<td>
<p>A vector of length equal to the number of internal branches, signifying the which &quot;multiPsi&quot; class it belongs to</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_cophenetic.dist">cophenetic.dist</code></td>
<td>
<p>a cophenetic distance matrix showing the absolute distance between taxa - only applicable for OU models run on non-ultrmetric trees. If null will be calculated internally, but supplying the data can speed up run time</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_vcv.matrix">vcv.matrix</code></td>
<td>
<p>a variance-covariance matrix - only applicable for OU models run on non-ultrmetric trees. If null will be calculated internally, but supplying the data can speed up run time</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_mode.order">mode.order</code></td>
<td>
<p>The order of modes for the 'modeslice' model. Any combination of 'BM', 'OU', 'acdc', and 'kappa'</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_mode.param">mode.param</code></td>
<td>
<p>Parameters for the modes of evoluton in the 'modeslice' model</p>
</td></tr>
<tr><td><code id="transformPhylo_+3A_rate.var">rate.var</code></td>
<td>
<p>Allows rate variation in BM modes in the 'modeslice' model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Transforms the branch lengths of a phylo object according to one of the following models:
</p>

<ul>
<li> <p>model=&quot;bm&quot;- Brownian motion (constant rates random walk)
</p>
</li>
<li> <p>model=&quot;kappa&quot; - fits Pagel's kappa by raising all branch lengths to the power kappa. As kappa approaches zero, trait change becomes focused at branching events. For complete phylogenies, if kappa approaches zero this infers speciational trait change. 
</p>
</li>
<li> <p>model=&quot;lambda&quot; - fits Pagel's lambda to estimate phylogenetic signal by multiplying all internal branches of the tree by lambda, leaving tip branches as their original length (root to tip distances are unchanged);
</p>
</li>
<li> <p>model=&quot;delta&quot; - fits Pagel's delta by raising all node depths to the power delta. If delta &lt;1, trait evolution is concentrated early in the tree whereas if delta &gt;1 trait evolution is concentrated towards the tips. Values of delta above one can be difficult to fit reliably.
</p>
</li>
<li> <p>model=&quot;free&quot; - fits Mooer's et al's (1999) free model where each branch has its own rate of trait evolution. This can be a useful exploratory analysis but it is slow due to the number of parameters, particularly for large trees.
</p>
</li>
<li> <p>model=&quot;clade&quot; - fits a model where particular clades are a priori hypothesised to have different rates of trait evolution (see O'Meara et al. 2006; Thomas et al. 2006, 2009). Clades are specified using nodeIDs and are defined as the mrca node. Unique rates for each clade are specified using cladeRates. rateType specifies whether the rate shift occurs in the stem clade or on the single branch leading to the clade.
</p>
</li>
<li> <p>model=&quot;OU&quot; - fits an Ornstein-Uhlenbeck model - a random walk with a central tendency proportional to alpha. High values of alpha can be interpreted as evidence of evolutionary constraints, stabilising selection or weak phylogenetic signal.
</p>
</li>
<li> <p>model=&quot;psi&quot; - fits a model to assess to the relative contributions of speciation and gradual evolution to a trait's evolutionary rate (Ingram 2010). Note that 'original nodes' from the full phylogeny can be included as an element on the phylogeny (e.g., phy$orig.node) as well as estimates of 'hidden' speciation (e.g., phy$hidden.speciation) if estimates of extinction (mu) are &gt; 0.
</p>
</li>
<li> <p>model=&quot;multiPsi&quot; fits a model to assess to the relative contributions of speciation and gradual evolution to a trait's evolutionary rate but allows seperate values of psi fitted to seperate branches (Ingram 2010; Ingram et al. 2016). Note that 'original nodes' from the full phylogeny can be included as an element on the phylogeny (e.g., phy$orig.node) as well as estimates of 'hidden' speciation (e.g., phy$hidden.speciation) if estimates of extinction (mu) are &gt; 0.
</p>
</li>
<li> <p>model=&quot;ACDC&quot; fits a model to in which rates can exponentially increased or decrease through time (Blomberg et al. 2003). If the upper bound is &lt; 0, the model is equivalent to the 'Early Burst' model of Harmon et al. 2010. If a nodeIDs is supplied, the model will fit a ACDC model nested within a clade, with a BM fit to the rest of the tree.
</p>
</li>
<li> <p>model=&quot;timeSlice&quot; A model in which all branch rates change at time(s) in the past.
</p>
</li>
<li> <p>model=&quot;modeSlice&quot; A model in which all branch modes change at a time or times set a priori by the user.
</p>
</li></ul>



<h3>Value</h3>

<p>phy  A phylo object with branch lengths scaled according to the given model and parameters
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Mark Puttick
</p>


<h3>References</h3>

<p>Ingram T. 2011. Speciation along a depth gradient in a marine adaptive radiation. Proc. Roy. Soc. B. 278, 613-618.
</p>
<p>Ingram T,  Harrison AD, Mahler L, Castaneda MdR, Glor RE, Herrel A, Stuart YE, and Losos JB. Comparative tests of the role of dewlap size in Anolis lizard speciation. Proc. Roy. Soc. B. 283, 20162199.
</p>
<p>Mooers AO, Vamosi S, &amp; Schluter D. 1999. Using phylogenies to test macroevolutionary models of trait evolution: sexual selection and speciation in Cranes (Gruinae). American Naturalist 154, 249-259.
</p>
<p>O'Meara BC, Ane C, Sanderson MJ &amp; Wainwright PC. 2006. Testing for different rates of continuous trait evolution using likelihood. Evolution 60, 922-933
</p>
<p>Pagel M. 1997. Inferring evolutionary processes from phylogenies. Zoologica Scripta 26, 331-348.
</p>
<p>Pagel M. 1999 Inferring the historical patterns of biological evolution. Nature 401, 877-884.
</p>
<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>, <code><a href="#topic+transformPhylo.ll">transformPhylo.ll</a></code>, <code><a href="#topic+transformPhylo.MCMC">transformPhylo.MCMC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
anolis.treeDelta &lt;- transformPhylo(phy=anolis.tree, model="delta", delta=0.5)
</code></pre>

<hr>
<h2 id='transformPhylo.ll'>Log-likelhood for models of trait evolution.</h2><span id='topic+transformPhylo.ll'></span>

<h3>Description</h3>

<p>Fits likelihood models for various models of continuous character evolution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformPhylo.ll(
  y = NULL,
  phy,
  model = NULL,
  meserr = NULL,
  kappa = NULL,
  lambda = NULL,
  delta = NULL,
  alpha = NULL,
  psi = NULL,
  lambda.sp = NULL,
  nodeIDs = NULL,
  rateType = NULL,
  branchRates = NULL,
  cladeRates = NULL,
  timeRates = NULL,
  splitTime = NULL,
  branchLabels = NULL,
  acdcRate = NULL,
  covPIC = TRUE,
  cophenetic.dist = NULL,
  vcv.matrix = NULL,
  mode.order = NULL,
  mode.param = NULL,
  rate.var = NULL,
  mu = NULL,
  sigma.sq = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformPhylo.ll_+3A_y">y</code></td>
<td>
<p>A matrix of trait values.</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_model">model</code></td>
<td>
<p>The model of trait evolution (see details).</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_meserr">meserr</code></td>
<td>
<p>A vector (or matrix) of measurement error for each tip. This is only applicable to univariate analyses.</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_kappa">kappa</code></td>
<td>
<p>Value of kappa transform.</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_lambda">lambda</code></td>
<td>
<p>Value of lambda transform.</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_delta">delta</code></td>
<td>
<p>Value of delta transform.</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_alpha">alpha</code></td>
<td>
<p>Value of alpha (OU) transform.</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_psi">psi</code></td>
<td>
<p>Value of psi transform.</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_lambda.sp">lambda.sp</code></td>
<td>
<p>Speciation rate estimate for the tree.</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_nodeids">nodeIDs</code></td>
<td>
<p>Integer - ancestral nodes of clades.</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_ratetype">rateType</code></td>
<td>
<p>If model=&quot;clade&quot;, a vector specifying if rate shift occurs in a clade (&quot;clade&quot;) or on the single branch leading to a clade (&quot;branch&quot;).</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_branchrates">branchRates</code></td>
<td>
<p>Numeric vector specifying relative rates for individual branches</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_claderates">cladeRates</code></td>
<td>
<p>Numeric vector specifying relative rates for clades or logical to indicate scalar is included in the 'modeslice' model (the scalar value is included in the mode.param argument with the 'modeslice' model).</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_timerates">timeRates</code></td>
<td>
<p>The rates (from ancient to recent) for the timeSlice model</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_splittime">splitTime</code></td>
<td>
<p>A split time (measured from the present, or most recent species) at which a shift in the rate occurs for the &quot;timeSlice&quot; model</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_branchlabels">branchLabels</code></td>
<td>
<p>Branches on which different psi parameters are estimated in the &quot;multipsi&quot; model.</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_acdcrate">acdcRate</code></td>
<td>
<p>Value of ACDC transform</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_covpic">covPIC</code></td>
<td>
<p>Logical. For multivariate analyses, allow for co-variance between traits rates (TRUE) or no covariance in trait rates (FALSE). If FALSE, only the trait variances not co-variances are used.</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_cophenetic.dist">cophenetic.dist</code></td>
<td>
<p>a cophenetic distance matrix showing the absolute distance between taxa - only applicable for OU models run on non-ultrmetric trees. If null will be calculated internally, but supplying the data can speed up run time</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_vcv.matrix">vcv.matrix</code></td>
<td>
<p>a variance-covariance matrix - only applicable for OU models run on non-ultrmetric trees. If null will be calculated internally, but supplying the data can speed up run time</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_mode.order">mode.order</code></td>
<td>
<p>The order of modes for the 'modeslice' model. Any combination of 'BM', 'OU', 'acdc', and 'kappa'</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_mode.param">mode.param</code></td>
<td>
<p>Parameters for the modes of evoluton in the 'modeslice' model</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_rate.var">rate.var</code></td>
<td>
<p>Allows rate variation in BM modes in the 'modeslice' model</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_mu">mu</code></td>
<td>
<p>Phylogenetic mean estimate, Mainly for internal use when using the variance-covariance method to calculate likelihood for non-ultrametric trees with the OU model</p>
</td></tr>
<tr><td><code id="transformPhylo.ll_+3A_sigma.sq">sigma.sq</code></td>
<td>
<p>Brownian variance estimate, mainly for internal use when using the variance-covariance method to calculate likelihood for non-ultrametric trees with the OU model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits likelihood models (see below) for continuous character evolution where the parameter values are set a priori. The function returns the log-likihood and the Brownian variance (or variance covariance matrix).
</p>

<ul>
<li> <p>model=&quot;bm&quot; Brownian motion (constant rates random walk).
</p>
</li>
<li> <p>model=&quot;kappa&quot; fits Pagel's kappa by raising all branch lengths to the power kappa. As kappa approaches zero, trait change becomes focused at branching events. For complete phylogenies, if kappa approaches zero this infers speciational trait change. Default bounds from ~0 - 1.
</p>
</li>
<li> <p>model=&quot;lambda&quot; fits Pagel's lambda to estimate phylogenetic signal by multiplying all internal branches of the tree by lambda, leaving tip branches as their original length (root to tip distances are unchanged). Default bounds from ~0 - 1.
</p>
</li>
<li> <p>model=&quot;delta&quot; fits Pagel's delta by raising all node depths to the power delta. If delta &lt;1, trait evolution is concentrated early in the tree whereas if delta &gt;1 trait evolution is concentrated towards the tips. Values of delta above one can be difficult to fit reliably. If a nodeIDs is supplied, the model will fit a delta model nested within a clade, with a BM fit to the rest of the tree. Default bounds from ~0 - 5.
</p>
</li>
<li> <p>model=&quot;OU&quot; fits an Ornstein-Uhlenbeck model - a random walk with a central tendency proportional to alpha. High values of alpha can be interpreted as evidence of evolutionary constraints, stabilising selection or weak phylogenetic signal. It is often difficult to distinguish among these possibilities. If a nodeIDs is supplied, the model will fit a OU model nested within a clade, with a BM fit to the rest of the tree. For OU models, alternative optimisation are performed with different starting values (1e-8, 0.01, 0.1, 1, 5). Default bounds from ~0 - 10.
</p>
</li>
<li> <p>model=&quot;ACDC&quot; fits a model to in which rates can exponentially increased or decrease through time (Blomberg et al. 2003). If the upper bound is &lt; 0, the model is equivalent to the 'Early Burst' model of Harmon et al. 2010. If a nodeIDs is supplied, the model will fit a ACDC model nested within a clade, with a BM fit to the rest of the tree. Default rate parameter bounds from ln(1e-10) ~ ln(20) divided by the root age. Note this process starts on the stem branch leading to the MRCA of the common node, unlike the other methods that start at the common node.
</p>
</li>
<li> <p>model=&quot;trend&quot; fits a model in which the expectated mean change through time is non-zero, signifying a directional evolution to a larger or smaller trait value. This model is only appliacble to non-ultrametric trees.
</p>
</li>
<li> <p>model=&quot;psi&quot; fits a model to assess to the relative contributions of speciation and gradual evolution to a trait's evolutionary rate (Ingram 2010). Note that the algorithm will automatically estimate speciation and extinction estimates, and will incorporate estimates of 'hidden' speciation if death estimates are greater than 0. 
</p>
</li>
<li> <p>model=&quot;multipsi&quot; fits a model to assess to the relative contributions of speciation and gradual evolution to a trait's evolutionary rate but allows seperate values of psi fitted to seperate branches (Ingram 2010; Ingram et al. 2016). Note that the algorithm will automatically estimate speciation and extinction estimates, and will incorporate estimates of 'hidden' speciation if death estimates are greater than 0.
</p>
</li>
<li> <p>model=&quot;free&quot; fits Mooers et al's free model where each branch has its own rate of trait evolution. This can be a useful exploratory analysis but it is slow due to the number of parameters, particularly for large trees. Default rate parameter bounds from ~0 - 200.
</p>
</li>
<li> <p>model=&quot;clade&quot; fits a model where particular clades are a priori hypothesised to have different rates of trait evolution (see O'Meara et al. 2006; Thomas et al. 2006, 2009). Clades are specified using nodeIDs and are defined as the mrca node. Default rate parameter bounds from ~0 - 200.
</p>
</li>
<li> <p>model=&quot;tm1&quot; fits &quot;clade&quot; models without any a priori assertion of the location of phenotypic diversification rate shifts. It uses the same AIC approach as the runMedusa function in the geiger package (runMedusa tests for shifts in the rate of lineage diversification). The algorithm first fits a constant-rate Brownian model to the data, it then works iteratively through the phylogeny fitting a two-rate model at each node in turn. Each two-rate model is compared to the constant rate model and the best two-rate model is retained. Keeping the location of this rate shift intact, it then repeats the procedure for a three-rate model and so on. The maximum number of rate shifts can be specified a priori using nSplits. Limits can be applied to the size (species richness) of clades on which to infer new rate shifts using minCladeSize. This can be useful to enable large trees to be handled but should be used cautiously since specifiying a large minimum clade size may result in biologically interesting nested rate shifts being missed. Equally, very small clade sizes may provide poor estimates of rate that may not be informative. Limits on the search can also be placed using restrictNode. This requires a list where each element of the list is a vector of tip names that define monophyletic groups. Rate shifts will not be searched for within any of the defined groups. Default rate parameter bounds from ~0 - 1000.
</p>
</li>
<li> <p>model=&quot;tm2&quot; this model is similar to &quot;tm1&quot;, however, at each node it assesses the fit of two models. The first model is exactly as per &quot;tm1&quot;. The second model infers a rate shift on the single branch descending directly from a node but not on any of the descending branches thereafter. Only the best fitting single-branch or whole clade model is retained for the next iteration. If a single-branch shift is favoured, this infers either that there was a rapid shift in trait value along the stem leading to the crown group, or that the members of the clade have undergone parallel shifts. In either case, this can be considered as a change in mean, though separating a single early shift from a clade-parallel shift is not possible with this method. 
</p>
</li>
<li> <p>model=&quot;timeSlice&quot; A model in which all branch rates change at a time or times set a priori by the user. If  Default rate parameter bounds from ~0 - 1000. If splitTime=NULL, all 1 Ma (as defined by test Age) intervals from the root of the tree - 10 and the youngest tip + 10 will be included in the search. The +/- 10 Ma age can be modified using the argument boundaryAge. At each stage the best fitting model will be stored, and the search will continue until n shifts, with n shifts defined by nSplits. If a single value or vector is used for splitTime, only these ages are included in the search.
</p>
</li>
<li> <p>model=&quot;modeslice&quot; A model in which all branch modes change at a time or times set a priori by the user.
</p>
</li></ul>



<h3>Value</h3>

<p>brownianVariance Brownian variance (or covariance for multiple traits) given the data and phylogeny
</p>
<p>logLikelihood The log-likelihood of the model and data
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Mark Puttick
</p>


<h3>References</h3>

<p>Felsenstein J. 1973. Maximum-likelihood estimation of evolutionary trees from continuous characters. Am. J. Hum. Genet. 25, 471-492.
Felsenstein J. 1985. Phylogenies and the comparative method. American Naturalist 125, 1-15.
Freckleton RP &amp; Jetz W. 2009. Space versus phylogeny: disentangling phylogenetic and spatial signals in comparative data. Proc. Roy. Soc. B 276, 21-30.
</p>
<p>Ingram T. 2011. Speciation along a depth gradient in a marine adaptive radiation. Proc. Roy. Soc. B. 278, 613-618.
</p>
<p>Ingram T,  Harrison AD, Mahler L, Castaneda MdR, Glor RE, Herrel A, Stuart YE, and Losos JB. 2016. Comparative tests of the role of dewlap size in Anolis lizard speciation. Proc. Roy. Soc. B. 283, 20162199. #' Mooers AO, Vamosi S, &amp; Schluter D. 1999. Using phylogenies to test macroevolutionary models of trait evolution: sexual selection and speciation in Cranes (Gruinae). American Naturalist 154, 249-259.
O'Meara BC, Ane C, Sanderson MJ &amp; Wainwright PC. 2006. Testing for different rates of continuous trait evolution using likelihood. Evolution 60, 922-933
Pagel M. 1997. Inferring evolutionary processes from phylogenies. Zoologica Scripta 26, 331-348.
Pagel M. 1999 Inferring the historical patterns of biological evolution. Nature 401, 877-884.
Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>,<code><a href="#topic+transformPhylo.MCMC">transformPhylo.MCMC</a></code>, <code><a href="#topic+transformPhylo.sim">transformPhylo.sim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data and phylogeny
data(anolis.tree)
data(anolis.data)

# anolis.data is not matrix and contains missing data so put together matrix of
# relevant traits (here female and male snout vent lengths) and remove species 
# with missing data from the matrix and phylogeny
sorted.traits &lt;- sortTraitData(anolis.tree, anolis.data,
c("Female_SVL", "Male_SVL"), log.trait=TRUE, pass.ultrametric=TRUE)

tree &lt;- sorted.traits$phy
traits &lt;- sorted.traits$trait

# log likelihood of kappa = 0.1 or 1
transformPhylo.ll(traits, phy=tree, model="kappa", kappa=0.1)
transformPhylo.ll(traits, phy=tree, model="kappa", kappa=1)

# log likelihood of lambda = 0.01 or 1
transformPhylo.ll(traits, phy=tree, model="lambda", lambda=0.01)
transformPhylo.ll(traits, phy=tree, model="lambda", lambda=1)

# log likelihood of delta = 1.5 or 1
transformPhylo.ll(traits, phy=tree, model="delta", delta=1.5)
transformPhylo.ll(traits, phy=tree, model="delta", delta=1)

# log likelihood of alpha = 0.001 or 2
transformPhylo.ll(traits, phy=tree, model="OU", alpha=0.001)
transformPhylo.ll(traits, phy=tree, model="OU", alpha=2)

</code></pre>

<hr>
<h2 id='transformPhylo.MCMC'>Bayesian MCMC for models of trait evolution</h2><span id='topic+transformPhylo.MCMC'></span>

<h3>Description</h3>

<p>Fits Bayesian models for various models of continuous character evolution using a Metropolis-Hastings Markov Chain Monte Carlo (MCMC) approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformPhylo.MCMC(
  y,
  phy,
  model,
  mcmc.iteration = 1000,
  burn.in = 0.1,
  hiddenSpeciation = FALSE,
  full.phy = NULL,
  lowerBound = NULL,
  upperBound = NULL,
  useMean = FALSE,
  random.start = TRUE,
  meserr = NULL,
  covPIC = TRUE,
  lambdaEst = FALSE,
  nodeIDs = NULL,
  branchLabels = NULL,
  acdcScalar = FALSE,
  sample.every = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformPhylo.MCMC_+3A_y">y</code></td>
<td>
<p>A matrix of trait values.</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_model">model</code></td>
<td>
<p>The model of trait evolution (see details).</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_mcmc.iteration">mcmc.iteration</code></td>
<td>
<p>Integer - the number of generations for which to run the MCMC chain</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_burn.in">burn.in</code></td>
<td>
<p>The proportion of the chain (as given by mcmc.iteration) which to discard as 'burn-in'</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_hiddenspeciation">hiddenSpeciation</code></td>
<td>
<p>Logical. If TRUE the psi model will include nodes that are on the 'full.phy' but not the tree pruned of trait data</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_full.phy">full.phy</code></td>
<td>
<p>The full phylogeny containing the species that do not contain trait data so are not included in 'phy'</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_lowerbound">lowerBound</code></td>
<td>
<p>Minimum value for parameter estimates</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_upperbound">upperBound</code></td>
<td>
<p>Maximum value for parameter estimates</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_usemean">useMean</code></td>
<td>
<p>Logical. Use the branch-based estimates of extinction of mean (TRUE, default) for the &quot;psi&quot; and &quot;multispi&quot; models only applicable if &quot;hiddenSpeciation&quot; = TRUE</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_random.start">random.start</code></td>
<td>
<p>Use a random starting value for the MCMC run (TRUE), or use the environment set.seed() value</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_meserr">meserr</code></td>
<td>
<p>A vector (or matrix) of measurement error for each tip. This is only applicable to univariate analyses</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_covpic">covPIC</code></td>
<td>
<p>Logical. For multivariate analyses, allow for co-variance between traits rates (TRUE) or no covariance in trait rates (FALSE). If FALSE, only the trait variances not co-variances are used.</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_lambdaest">lambdaEst</code></td>
<td>
<p>Logical.  Estimate lambda alongside parameter estimates to reduce data noise. Only applicable for models &quot;kappa&quot;, &quot;delta&quot;, &quot;OU&quot;, &quot;psi&quot;, &quot;multispi&quot;, and &quot;ACDC&quot;. Default=FALSE.</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_nodeids">nodeIDs</code></td>
<td>
<p>Integer - ancestral nodes of clades applicable to rate heterogenous and nested models of evolution (see details)</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_branchlabels">branchLabels</code></td>
<td>
<p>Branches on which different psi parameters are estimated in the &quot;multipsi&quot; model</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_acdcscalar">acdcScalar</code></td>
<td>
<p>Logical.  For nested EB rate model, simultaneously estimated a rate scalar alongside EB model. Default=FALSE.</p>
</td></tr>
<tr><td><code id="transformPhylo.MCMC_+3A_sample.every">sample.every</code></td>
<td>
<p>Number specifying the every nth that is sampled in the MCMC chain (default = 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method estimates posterior probabilities using a Metropolis-Hastings MCMC approach that places a prior bounded uniform distribution on all parameters with an independence sampler. These prior distributions can be altered by changing the upperBound and lowerBound arguments. The MCMC model will estimate the posterior probability for the following models:
</p>

<ul>
<li> <p>model=&quot;kappa&quot; fits Pagel's kappa by raising all branch lengths to the power kappa. As kappa approaches zero, trait change becomes focused at branching events. For complete phylogenies, if kappa approaches zero this infers speciational trait change. Default bounds from ~0 - 1.
</p>
</li>
<li> <p>model=&quot;lambda&quot; fits Pagel's lambda to estimate phylogenetic signal by multiplying all internal branches of the tree by lambda, leaving tip branches as their original length (root to tip distances are unchanged). Default bounds from ~0 - 1.
</p>
</li>
<li> <p>model=&quot;delta&quot; fits Pagel's delta by raising all node depths to the power delta. If delta &lt;1, trait evolution is concentrated early in the tree whereas if delta &gt;1 trait evolution is concentrated towards the tips. Values of delta above one can be difficult to fit reliably. Default bounds from ~0 - 5.
</p>
</li>
<li> <p>model=&quot;OU&quot; fits an Ornstein-Uhlenbeck model - a random walk with a central tendency proportional to alpha. High values of alpha can be interpreted as evidence of evolutionary constraints, stabilising selection or weak phylogenetic signal. It is often difficult to distinguish among these possibilities. Default bounds from ~0 - 10.
</p>
</li>
<li> <p>model=&quot;psi&quot; fits a acceleration-deacceleration model to assess to the relative contributions of speciation and gradual evolution to a trait's evolutionary rate (Ingram 2010).
</p>
</li>
<li> <p>model=&quot;ACDC&quot; fits a model to in which rates can exponentially increased or decrease through time (Blomberg et al. 2003). If the upper bound is &lt; 0, the model is equivalent to the 'Early Burst' model of Harmon et al. 2010. Default rate parameter bounds from ln(1e-10) ~ ln(20) divided by the root age.
</p>
</li></ul>



<h3>Value</h3>

<p>median The median estimate of the posterior for the parameter
</p>
<p>95.HPD The 95 percent Highest Posterior Density for the parameter
</p>
<p>ESS Effective Sample Size for the posterior
</p>
<p>acceptance.rate The ratio for which new proposals were accepted during the MCMC chain
</p>
<p>mcmc.chain Full MCMC chain containing all iterations (including burn-in)
</p>


<h3>Author(s)</h3>

<p>Mark Puttick, Gavin Thomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>, <code><a href="#topic+transformPhylo.ll">transformPhylo.ll</a></code>, <code><a href="#topic+transformPhylo">transformPhylo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
data(anolis.data)
attach(anolis.data)
male.length &lt;- matrix(Male_SVL, dimnames=list(rownames(anolis.data)))
sortedData &lt;- sortTraitData(anolis.tree, male.length)
phy &lt;- sortedData$phy
male.length &lt;- sortedData$trait
phy.clade &lt;- extract.clade(phy, 182)
male.length.clade &lt;- as.matrix(male.length[match(phy.clade$tip.label, rownames(male.length)),])
## please note, this model will be need to run for longer to achieve convergence
lambda.mcmc &lt;- transformPhylo.MCMC(y=male.length.clade, phy=phy.clade, 
model="lambda", mcmc.iteration=100, burn.in=0.1)
</code></pre>

<hr>
<h2 id='transformPhylo.ML'>Maximum likelihood for models of trait evoluion</h2><span id='topic+transformPhylo.ML'></span>

<h3>Description</h3>

<p>Fits likelihood models for various models of continuous character evolution. Model fitting is based on maximum-likelihood evaluation using phylogenetically independent contrasts. This is exactly equivalent to, but substantially faster than, GLS approaches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformPhylo.ML(
  y,
  phy,
  model = NULL,
  modelCIs = TRUE,
  nodeIDs = NULL,
  rateType = NULL,
  minCladeSize = 1,
  nSplits = 2,
  splitTime = NULL,
  boundaryAge = 10,
  testAge = 1,
  restrictNode = NULL,
  lambdaEst = FALSE,
  acdcScalar = FALSE,
  branchLabels = NULL,
  hiddenSpeciation = FALSE,
  full.phy = NULL,
  useMean = FALSE,
  profilePlot = FALSE,
  lowerBound = NULL,
  upperBound = NULL,
  covPIC = TRUE,
  n.cores = 1,
  tol = NULL,
  meserr = NULL,
  controlList = c(fnscale = -1, maxit = 100, factr = 1e-07, pgtol = 0, type = 2, lmm =
    5),
  returnPhy = FALSE,
  print.warnings = FALSE,
  mode.order = NULL,
  rate.var = FALSE,
  testShiftTimes = NULL,
  saveAll = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformPhylo.ML_+3A_y">y</code></td>
<td>
<p>A matrix of trait values.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_model">model</code></td>
<td>
<p>The model of trait evolution (see details).</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_modelcis">modelCIs</code></td>
<td>
<p>Logical - estimate confidence intervals for parameter estimates.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_nodeids">nodeIDs</code></td>
<td>
<p>Integer - ancestral nodes of clades applicable to rate heterogenous and nested models of evolution (see details)</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_ratetype">rateType</code></td>
<td>
<p>If model=&quot;clade&quot;, a vector specifying if rate shift occurs in a clade (&quot;clade&quot;) or on the single branch leading to a clade (&quot;branch&quot;).</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_mincladesize">minCladeSize</code></td>
<td>
<p>Integer - minimum clade size for inferred rate shift (where model=&quot;medusa&quot;).</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_nsplits">nSplits</code></td>
<td>
<p>Integer - number of rate shifts to apply for model=&quot;medusa&quot; and &quot;timeSlice&quot;.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_splittime">splitTime</code></td>
<td>
<p>A split time (measured from the present, or most recent species) at which a shift in the rate occurs for the &quot;timeSlice&quot; model. If splitTime=NULL, then all ages between 1 million year intervals from the root age - 10 Ma to the present + 10 Ma will be included in the search. The best model will be retained in each search, and will be used as a fixed age in the next search. The model will calculate the likelihood for the number of shifts defined by 'nSplits'.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_boundaryage">boundaryAge</code></td>
<td>
<p>Only applicable if splitTime=NULL, the age distance from the tips and and youngest tip for which to search for rate shifts. For example, if boundaryAge=10, only ages between the root age - 10 and the latest tip + 10 will be included in the search. If one value is given this will be used for upper and lower ages, but if a vector with two ages is provided the first is used for the upper age boundary and the second for the lower age boundary. Set to zero to allow testing of all ages.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_testage">testAge</code></td>
<td>
<p>If splitTime=NULL, the interval between ages to be tested. For example, if testAge=1, all 1 Ma ages between the ages defined by 'boundaryAge' will be tested. If you would like to sequentially test specific shift times only, please use the argument &quot;specificShiftTimes&quot;.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_restrictnode">restrictNode</code></td>
<td>
<p>List defining monophyletic groups within which no further rate shifts are searched.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_lambdaest">lambdaEst</code></td>
<td>
<p>Logical.Estimate lambda alongside parameter estimates to reduce data noise. Only applicable for models &quot;kappa&quot;, &quot;delta&quot;, &quot;OU&quot;, &quot;psi&quot;, &quot;multispi&quot;, and &quot;ACDC&quot;. Default=FALSE.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_acdcscalar">acdcScalar</code></td>
<td>
<p>Logical.For nested EB rate model, simultaneously estimated a rate scalar alongside EB model. Default=FALSE. Only applicable to 'nested mode' and 'modeSlice' models.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_branchlabels">branchLabels</code></td>
<td>
<p>Branches on which different psi parameters are estimated in the &quot;multipsi&quot; model</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_hiddenspeciation">hiddenSpeciation</code></td>
<td>
<p>Logical. If TRUE the psi model will include nodes that are on the 'full.phy' but not the tree pruned of trait data</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_full.phy">full.phy</code></td>
<td>
<p>The full phylogeny containing the species that do not contain trait data so are not included in 'phy'</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_usemean">useMean</code></td>
<td>
<p>Logical. Use the branch-based estimates of extinction of mean (TRUE, default) for the &quot;psi&quot; and &quot;multispi&quot; models. Only applicable if &quot;hiddenSpeciation&quot;=TRUE. If FALSE, this will generate a single realisation of the numbers of hidden speciation events on each branch</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_profileplot">profilePlot</code></td>
<td>
<p>Logical. For the single parameter models &quot;kappa&quot;, &quot;lambda&quot;, &quot;delta&quot;, &quot;OU&quot;, &quot;psi&quot;, &quot;multipsi&quot;, and &quot;ACDC&quot;, plot the profile of the likelihood.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_lowerbound">lowerBound</code></td>
<td>
<p>Minimum value for parameter estimates</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_upperbound">upperBound</code></td>
<td>
<p>Maximum value for parameter estimates</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_covpic">covPIC</code></td>
<td>
<p>Logical. For multivariate analyses, allow for co-variance between traits rates (TRUE) or no covariance in trait rates (FALSE). If FALSE, only the trait variances not co-variances are used.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_n.cores">n.cores</code></td>
<td>
<p>Integer. Set number of computing cores when running model=&quot;traitMedusa&quot; (tm1 and tm2 models)</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_tol">tol</code></td>
<td>
<p>Tolerance (minimum branch length) to exclude branches from trait MEDUSA search. Primarily intended to prevent inference of rate shifts at randomly resolved polytomies.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_meserr">meserr</code></td>
<td>
<p>A vector (or matrix) of measurement error for each tip. This is only applicable to univariate analyses.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_controllist">controlList</code></td>
<td>
<p>List. Specify fine-tune parameters for the optim likelihood search</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_returnphy">returnPhy</code></td>
<td>
<p>Logical. In TRUE the phylogeny with branch lengths transformed by the ML model parameters is returned</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_print.warnings">print.warnings</code></td>
<td>
<p>Logical. If TRUE, warnings are issued if confidence intervals fall outside upper or lower bounds</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_mode.order">mode.order</code></td>
<td>
<p>The order of modes for the 'modeslice' model. Any combination of 'BM', 'OU', 'acdc', and 'kappa'</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_rate.var">rate.var</code></td>
<td>
<p>Allows rate variation in BM modes in the 'modeslice model'</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_testshifttimes">testShiftTimes</code></td>
<td>
<p>A vector of times to be used in the search for split times. For use in the timeSlice model when splitTime=NULL. This allows users to specify ages that are test suquentially, rather than all shifts optimised simultaneously as is done when ages are provided in the argument 'splitTime'.</p>
</td></tr>
<tr><td><code id="transformPhylo.ML_+3A_saveall">saveAll</code></td>
<td>
<p>Logical. If TRUE, saves all the outputs from traitMedusa search in timeSlice (i.e, the log-likelihood and rate estimates for all considered shifts, not just the best fitting shift model). This can be used for model averaging with the function <code><a href="#topic+plot.timeSlice.ML">plot.timeSlice.ML</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds the maximum likelihood parameter values for continuous character evolution. For &quot;kappa&quot;, &quot;delta&quot;, &quot;OU&quot;, &quot;multipsi&quot;, and &quot;ACDC&quot; it is possible to fit a 'nested' model of evolution in which the ancestral rate of BM switches to a different node, as specified by nodeIDs or branchLabels for multipsi. The function returns the maximum-likelihood parameter estimates for the following models.
</p>

<ul>
<li> <p>model=&quot;bm&quot; Brownian motion (constant rates random walk).
</p>
</li>
<li> <p>model=&quot;kappa&quot; fits Pagel's kappa by raising all branch lengths to the power kappa. As kappa approaches zero, trait change becomes focused at branching events. For complete phylogenies, if kappa approaches zero this infers speciational trait change. Default bounds from ~0 - 1.
</p>
</li>
<li> <p>model=&quot;lambda&quot; fits Pagel's lambda to estimate phylogenetic signal by multiplying all internal branches of the tree by lambda, leaving tip branches as their original length (root to tip distances are unchanged). Default bounds from ~0 - 1.
</p>
</li>
<li> <p>model=&quot;delta&quot; fits Pagel's delta by raising all node depths to the power delta. If delta &lt;1, trait evolution is concentrated early in the tree whereas if delta &gt;1 trait evolution is concentrated towards the tips. Values of delta above one can be difficult to fit reliably. If a nodeIDs is supplied, the model will fit a delta model nested within a clade, with a BM fit to the rest of the tree. Default bounds from ~0 - 5.
</p>
</li>
<li> <p>model=&quot;OU&quot; fits an Ornstein-Uhlenbeck model - a random walk with a central tendency proportional to alpha. High values of alpha can be interpreted as evidence of evolutionary constraints, stabilising selection or weak phylogenetic signal. It is often difficult to distinguish among these possibilities. If a nodeIDs is supplied, the model will fit a OU model nested within a clade, with a BM fit to the rest of the tree. For OU models, alternative optimisation are performed with different starting values (1e-8, 0.01, 0.1, 1, 5). Default bounds from ~0 - 10.
</p>
</li>
<li> <p>model=&quot;ACDC&quot; fits a model to in which rates can exponentially increased or decrease through time (Blomberg et al. 2003). If the upper bound is &lt; 0, the model is equivalent to the 'Early Burst' model of Harmon et al. 2010. If a nodeIDs is supplied, the model will fit a ACDC model nested within a clade, with a BM fit to the rest of the tree. Default rate parameter bounds from ln(1e-10) ~ ln(20) divided by the root age. Note this process starts on the stem branch leading to the MRCA of the common node, unlike the other methods that start at the common node.
</p>
</li>
<li> <p>model=&quot;trend&quot; fits a model in which the expectated mean change through time is non-zero, signifying a directional evolution to a larger or smaller trait value. This model is only appliacble to non-ultrametric trees.
</p>
</li>
<li> <p>model=&quot;psi&quot; fits a model to assess to the relative contributions of speciation and gradual evolution to a trait's evolutionary rate (Ingram 2010). Note that the algorithm will automatically estimate speciation and extinction estimates, and will incorporate estimates of 'hidden' speciation if death estimates are greater than 0. 
</p>
</li>
<li> <p>model=&quot;multipsi&quot; fits a model to assess to the relative contributions of speciation and gradual evolution to a trait's evolutionary rate but allows seperate values of psi fitted to seperate branches (Ingram 2010; Ingram et al. 2016). Note that the algorithm will automatically estimate speciation and extinction estimates, and will incorporate estimates of 'hidden' speciation if death estimates are greater than 0.
</p>
</li>
<li> <p>model=&quot;free&quot; fits Mooers et al's free model where each branch has its own rate of trait evolution. This can be a useful exploratory analysis but it is slow due to the number of parameters, particularly for large trees. Default rate parameter bounds from ~0 - 200.
</p>
</li>
<li> <p>model=&quot;clade&quot; fits a model where particular clades are a priori hypothesised to have different rates of trait evolution (see O'Meara et al. 2006; Thomas et al. 2006, 2009). Clades are specified using nodeIDs and are defined as the mrca node. Default rate parameter bounds from ~0 - 200.
</p>
</li>
<li> <p>model=&quot;tm1&quot; fits &quot;clade&quot; models without any a priori assertion of the location of phenotypic diversification rate shifts. It uses the same AIC approach as the runMedusa function in the geiger package (runMedusa tests for shifts in the rate of lineage diversification). The algorithm first fits a constant-rate Brownian model to the data, it then works iteratively through the phylogeny fitting a two-rate model at each node in turn. Each two-rate model is compared to the constant rate model and the best two-rate model is retained. Keeping the location of this rate shift intact, it then repeats the procedure for a three-rate model and so on. The maximum number of rate shifts can be specified a priori using nSplits. Limits can be applied to the size (species richness) of clades on which to infer new rate shifts using minCladeSize. This can be useful to enable large trees to be handled but should be used cautiously since specifiying a large minimum clade size may result in biologically interesting nested rate shifts being missed. Equally, very small clade sizes may provide poor estimates of rate that may not be informative. Limits on the search can also be placed using restrictNode. This requires a list where each element of the list is a vector of tip names that define monophyletic groups. Rate shifts will not be searched for within any of the defined groups. Default rate parameter bounds from ~0 - 1000.
</p>
</li>
<li> <p>model=&quot;tm2&quot; this model is similar to &quot;tm1&quot;, however, at each node it assesses the fit of two models. The first model is exactly as per &quot;tm1&quot;. The second model infers a rate shift on the single branch descending directly from a node but not on any of the descending branches thereafter. Only the best fitting single-branch or whole clade model is retained for the next iteration. If a single-branch shift is favoured, this infers either that there was a rapid shift in trait value along the stem leading to the crown group, or that the members of the clade have undergone parallel shifts. In either case, this can be considered as a change in mean, though separating a single early shift from a clade-parallel shift is not possible with this method. 
</p>
</li>
<li> <p>model=&quot;timeSlice&quot; A model in which all branch rates change at a time or times set a priori by the user. IfDefault rate parameter bounds from ~0 - 1000. If splitTime=NULL, all 1 Ma (as defined by test Age) intervals from the root of the tree - 10 and the youngest tip + 10 will be included in the search. The +/- 10 Ma age can be modified using the argument boundaryAge. At each stage the best fitting model will be stored, and the search will continue until n shifts, with n shifts defined by nSplits. If a single value or vector is used for splitTime, only these ages are included in the search.
</p>
</li>
<li> <p>model=&quot;modeslice&quot; A model in which all branch modes change at a time or times set a priori by the user.
</p>
</li></ul>



<h3>Value</h3>

<p>Returns the maximum log-likelihood and parameter estimates (with 95 percent confidence intervals if specified). If model=&quot;bm&quot; instead returns the Brownian (co)variance and log-likelihood. Also returned are the root estimate, the AIC, and AICc.
</p>
<p>traitMedusaObject A list in which the first element contains a matrix summarising the parameter estimates and node ids, log-likelihoods, number of parameters (k), AIC and AICc for the best one-rate model, two-rate model, three rate model and so on. The second element is a sub-list where the first element contains all two-rate models, the second element contains all three-rate models and so on. This can be summarised using traitMedusaSummary. The third element is the input trait data. The fourth element is the input phylogeny.
</p>


<h3>Note</h3>

<p>Confidence intervals are based on the assumption of an asymptotic Chi-square distribution. For multi-parameter models (e.g. rate shift models with more than two rates) the confidence intervals are approximate and are calculated for each parameter in turn while holding all other parameters at their maximum likelihood value.
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Mark Puttick
</p>


<h3>References</h3>

<p>Alfaro ME, Santini F, Brock CD, Alamillo H, Dornburg A, Carnevale G, Rabosky D &amp; Harmon LJ. 2009. Nine exceptional radiations plus high turnover explain species diversity in jawed vertebrates. PNAS 106, 13410-13414.
</p>
<p>Blomberg SP, Garland T &amp; Ives AR 2003. Testing for phylogenetic signal in comparative data: behavioral traits are more labile. Evolution 57, 717-745.
</p>
<p>Felsenstein J. 1973. Maximum-likelihood estimation of evolutionary trees from continuous characters. Am. J. Hum. Genet. 25, 471-492.
</p>
<p>Felsenstein J. 1985. Phylogenies and the comparative method. American Naturalist 125, 1-15.
</p>
<p>Freckleton RP &amp; Jetz W. 2009. Space versus phylogeny: disentangling phylogenetic and spatial signals in comparative data. Proc. Roy. Soc. B 276, 21-30.
</p>
<p>Harmon LJ et al. 2010. Early bursts of body size and shape evolution are rare in comparative data. Evolution 57, 717-745.
</p>
<p>Ingram T. 2011. Speciation along a depth gradient in a marine adaptive radiation. Proc. Roy. Soc. B. 278, 613-618.
</p>
<p>Ingram T,Harrison AD, Mahler L, Castaneda MdR, Glor RE, Herrel A, Stuart YE, and Losos JB. 2016. Comparative tests of the role of dewlap size in Anolis lizard speciation. Proc. Roy. Soc. B. 283, 20162199.
</p>
<p>Mooers AO, Vamosi S, &amp; Schluter D. 1999. Using phylogenies to test macroevolutionary models of trait evolution: sexual selection and speciation in Cranes (Gruinae). American Naturalist 154, 249-259.
</p>
<p>O'Meara BC, Ane C, Sanderson MJ &amp; Wainwright PC. 2006. Testing for different rates of continuous trait evolution using likelihood. Evolution 60, 922-933
</p>
<p>Pagel M. 1997. Inferring evolutionary processes from phylogenies. Zoologica Scripta 26, 331-348.
</p>
<p>Pagel M. 1999 Inferring the historical patterns of biological evolution. Nature 401, 877-884.
</p>
<p>Pagel M. 1999 Inferring the historical patterns of biological evolution. Nature 401, 877-884.
</p>
<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.MCMC">transformPhylo.MCMC</a></code>, <code><a href="#topic+transformPhylo">transformPhylo</a></code>, <code><a href="#topic+transformPhylo.ll">transformPhylo.ll</a></code>, <code><a href="#topic+blomberg.k">blomberg.k</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Data and phylogeny
data(anolis.tree)
data(anolis.data)
sortedData &lt;- sortTraitData(anolis.tree, anolis.data,
data.name="Male_SVL", log.trait=TRUE, pass.ultrametric=TRUE)
phy &lt;- sortedData$phy
male.length &lt;- sortedData$trait
phy.clade &lt;- extract.clade(phy, 182)
male.length.clade &lt;- as.matrix(male.length[match(phy.clade$tip.label, rownames(male.length)),])

# Brownian motion model
transformPhylo.ML(male.length.clade , phy=phy.clade, model="bm")

# Delta
transformPhylo.ML(male.length.clade , phy=phy.clade, model="delta", upperBound=2)

# The upper confidence interval for kappa is outside the bounds so try increasing
# the upper bound

transformPhylo.ML(male.length.clade , phy=phy.clade, model="delta", upperBound=5)

# Test for different rates in different clades - here with 2 hypothesised
# unusual rates compared to the background

# This fits the non-censored model of O'Meara et al. (2006)
phy.clade$node.label[which(phy.clade$node.label == "3")] &lt;- 2
transformPhylo.ML(male.length.clade, phy=phy.clade, model="clade", nodeIDs=c(49, 54))

# Identify rate shifts and print and plot results with upto three rate shifts
# and minimum clade size of 20.
anolisSVL_MEDUSA &lt;- transformPhylo.ML(male.length.clade, phy=phy.clade, model="tm1",
minCladeSize=10, nSplits=2)
</code></pre>

<hr>
<h2 id='transformPhylo.sim'>Phylogenetic tree transformations</h2><span id='topic+transformPhylo.sim'></span>

<h3>Description</h3>

<p>Simulates trait data on a tree using a specified model of evolution (see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformPhylo.sim(
  phy,
  n = 1,
  x = NULL,
  model = NULL,
  returnNodes = FALSE,
  kappa = NULL,
  lambda = NULL,
  delta = NULL,
  alpha = NULL,
  psi = NULL,
  acdcRate = NULL,
  lambda.sp = NULL,
  trend = NULL,
  trend.anc.state = 0,
  nodeIDs = NULL,
  rateType = NULL,
  cladeRates = NULL,
  branchRates = NULL,
  rate = NULL,
  group.means = NULL,
  splitTime = NULL,
  timeRates = NULL,
  branchLabels = NULL,
  rate.var = NULL,
  mode.order = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformPhylo.sim_+3A_phy">phy</code></td>
<td>
<p>An object of class <code>phylo</code> (see <span class="pkg">ape</span>).</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_n">n</code></td>
<td>
<p>Number of simulations</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_x">x</code></td>
<td>
<p>Vector, matrix or data.frame (with taxon names as names or rownames) of categories for each species. Only applicable if model=&quot;mixedRate&quot;</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_model">model</code></td>
<td>
<p>The model of trait evolution (see details).</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_returnnodes">returnNodes</code></td>
<td>
<p>Logical. If TRUE, alongside the tip values all node values are returned corresponding to APE's edge.matrix for the tree.</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_kappa">kappa</code></td>
<td>
<p>Value of kappa transform.</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_lambda">lambda</code></td>
<td>
<p>Value of lambda transform.</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_delta">delta</code></td>
<td>
<p>Value of delta transform.</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_alpha">alpha</code></td>
<td>
<p>Value of alpha (OU) transform.</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_psi">psi</code></td>
<td>
<p>Value of psi transform.  Note that 'original nodes' from the full phylogeny can be included as an element on the phylogeny (e.g., phy$orig.node) as well as estimates of 'hidden' speciation (e.g., phy$hidden.speciation) if estimates of extinction (mu) are &gt; 0.</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_acdcrate">acdcRate</code></td>
<td>
<p>Value of ACDC transform.</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_lambda.sp">lambda.sp</code></td>
<td>
<p>Estimate of speciation (lambda) for the psi models</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_trend">trend</code></td>
<td>
<p>value of the expectation mean change through time</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_trend.anc.state">trend.anc.state</code></td>
<td>
<p>the expected ancestal state for the trend model (default is 0)</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_nodeids">nodeIDs</code></td>
<td>
<p>Integer - ancestral nodes of clades.</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_ratetype">rateType</code></td>
<td>
<p>If model=&quot;clade&quot;, a vector specifying if rate shift occurs in a clade (&quot;clade&quot;) or on the single branch leading to a clade (&quot;branch&quot;).</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_claderates">cladeRates</code></td>
<td>
<p>Numeric vector specifying telative rates for clades or logical to indicate scalar is included in the 'modeslice' model (the scalar is included in the mode.param argument with the 'modeslice' model).</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_branchrates">branchRates</code></td>
<td>
<p>Numeric vector specifying relative rates for individual branches</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_rate">rate</code></td>
<td>
<p>a vector of relative rate parameters. The length of the vector is equal to the number of rates being estimated.</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_group.means">group.means</code></td>
<td>
<p>a vector of the relative difference in means between rate categories, expressed as a scalar applied to the expected standard deviation (see Ricklefs 2006)</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_splittime">splitTime</code></td>
<td>
<p>A split time (measured from the present, or most recent species) at which a shift in the rate occurs for the &quot;timeSlice&quot; model</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_timerates">timeRates</code></td>
<td>
<p>The rates (from ancient to recent) for the timeSlice model</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_branchlabels">branchLabels</code></td>
<td>
<p>Branches on which different psi parameters are estimated in the &quot;multipsi&quot; model.</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_rate.var">rate.var</code></td>
<td>
<p>Allows rate variation in BM modes in the 'modeslice' model</p>
</td></tr>
<tr><td><code id="transformPhylo.sim_+3A_mode.order">mode.order</code></td>
<td>
<p>The order of modes for the 'modeslice' model. Any combination of 'BM', 'OU', 'acdc', and 'kappa'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix of simulated dated with taxon names as rownames (number of columns=n).
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas, Mark Puttick
</p>


<h3>References</h3>

<p>Ricklefs RE. 2006. Time, species, and the generation of trait variation in clades. Systematic Biology 55, 151-159.
</p>
<p>Ricklefs RE. 2006. Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030
</p>


<h3>See Also</h3>

<p><code><a href="#topic+transformPhylo.ML">transformPhylo.ML</a></code>, <code><a href="#topic+transformPhylo.ll">transformPhylo.ll</a></code>, <code><a href="#topic+transformPhylo">transformPhylo</a></code>, <code><a href="#topic+transformPhylo.MCMC">transformPhylo.MCMC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anolis.tree)
data(anolis.data)

# Simulate 10 sets of data with kappa=0.1 using the anolis tree
sim.dat1 &lt;- transformPhylo.sim(phy=anolis.tree, n=10, model="kappa", kappa=0.1)

# Simulate 10 sets of data where rates and means differ between to the categories defined by "x"
x &lt;- anolis.data$geo_ecomorph
names(x) &lt;-  rownames(anolis.data)
sim.dat2 &lt;- transformPhylo.sim(phy=anolis.tree, n=10, x=x, model="mixedRate", rate=c(1,1,2,4),
group.means=c(0,5,0,0))
</code></pre>

<hr>
<h2 id='transformRateMatrix'>Conversion among data and phylogeny objects</h2><span id='topic+transformRateMatrix'></span>

<h3>Description</h3>

<p>Transforms the expected variance and covariances among species according to hypotheses of rate variation between lineages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformRateMatrix(rateData, rate = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transformRateMatrix_+3A_ratedata">rateData</code></td>
<td>
<p>an object of class <code>rateData</code></p>
</td></tr>
<tr><td><code id="transformRateMatrix_+3A_rate">rate</code></td>
<td>
<p>a vector of relative rate parameters. The length of the vector is equal to the number of rates being estimated. If <code>rate=NULL</code> then rates are equal.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>retMat Rate-transformed variance covariance matrix
</p>


<h3>Author(s)</h3>

<p>Gavin Thomas
</p>


<h3>References</h3>

<p>Thomas GH, Freckleton RP, &amp; Szekely T. 2006. Comparative analyses of the influence of developmental mode on phenotypic diversification rates in shorebirds. Proceedings of the Royal Society B 273, 1619-1624.
</p>
<p>Thomas GH, Meiri S, &amp; Phillimore AB. 2009. Body size diversification in Anolis: novel environments and island effects. Evolution 63, 2017-2030.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(anolis.tree)
 data(anolis.data)
 ## Convert data to class rateData with a rateMatrix object as input
 anolis.rateMatrix &lt;- as.rateMatrix(phy=anolis.tree, x="geo_ecomorph", data=anolis.data)
 anolis.rateData &lt;- as.rateData(y="Female_SVL", x="geo_ecomorph", 
 rateMatrix = anolis.rateMatrix, phy=NULL, data=anolis.data, log.y=TRUE)
 
 # Tranform the expected variance covariance matrix so that the rates in the first and last 
 # categories are equal (both 1) whereas the rate in the second category is twice as fast (2) and 
 # the rate in the third category is ten times slower.
 
 trans.anolis.rateData &lt;- transformRateMatrix(rateData=anolis.rateData, rate = c(1,2,0.1,1))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
