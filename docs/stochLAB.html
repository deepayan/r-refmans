<!DOCTYPE html><html><head><title>Help for package stochLAB</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stochLAB}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#band_crm'><p>Collision risk model, for a single species and one turbine scenario</p></a></li>
<li><a href='#band_spreadsheet_dt'><p>Parameter values and outputs from Band's Collision Risk spreadsheet</p>
(&quot;Final_Report_SOSS02_BandSpreadSheetWorkedExampl1.xlsm&quot;)</a></li>
<li><a href='#band_spreadsheet_dt_2'><p>Parameter values and outputs from Band's Collision Risk spreadsheet, example</p>
nr. 2</a></li>
<li><a href='#bird_pars_wide_example'><p>Example of bird parameters stored in wide format</p></a></li>
<li><a href='#chord_prof_5MW'><p>Rotor blade chord profile</p></a></li>
<li><a href='#crm_opt1'><p>Number of collisions under model option 1</p></a></li>
<li><a href='#crm_opt2'><p>Number of collisions under model option 2</p></a></li>
<li><a href='#crm_opt3'><p>Number of collisions under model Option 3</p></a></li>
<li><a href='#crm_opt4'><p>Number of collisions under model Option 4</p></a></li>
<li><a href='#Day_Length'><p>Total day and night hours per month</p></a></li>
<li><a href='#dens_tnorm_wide_example'><p>Example of Truncated Normal parameters for monthly estimates of bird density</p></a></li>
<li><a href='#format_months'><p>Format any month name to three letter code</p></a></li>
<li><a href='#generate_rotor_grids'><p>Geometric attributes at equidistant points within the rotor's unit circle</p></a></li>
<li><a href='#generic_fhd_bootstraps'><p>Bootstrap samples of generic FHDs of 25 seabird species</p></a></li>
<li><a href='#get_avg_prob_collision'><p>Average single transit collision risk with no avoidance</p></a></li>
<li><a href='#get_collisions_basic'><p>Get expected collisions based on the basic model</p></a></li>
<li><a href='#get_collisions_extended'><p>Number of collisions based on the extended model</p></a></li>
<li><a href='#get_fhd_rotor'><p>Returns the proportion of birds at height bands along the rotor</p></a></li>
<li><a href='#get_flux_factor'><p>Flux factor</p></a></li>
<li><a href='#get_lac_factor'><p>Large array correction factor</p></a></li>
<li><a href='#get_mig_flux_factor'><p>Migration Flux factor</p></a></li>
<li><a href='#get_pcoll_grid'><p>Grid of probabilities of single transit collision at points in rotor circle</p></a></li>
<li><a href='#get_phi_grid'><p>Grid with angles between points <code class="reqn">(x, y)</code> and the rotor's vertical axis</p></a></li>
<li><a href='#get_prop_crh_fhd'><p>Calculate the total proportion of bird flights at collision risk based</p>
on a flight height distribution</a></li>
<li><a href='#get_risk_y'><p>Single transit collision risk along the chord of the rotor at height band</p>
<code class="reqn">y</code></a></li>
<li><a href='#get_x_grid'><p>Grid of horizontal distances from points in the rotor circle to its vertical</p>
axis</a></li>
<li><a href='#get_y_grid'><p>Grid of vertical distances from points in the rotor circle to its horizontal</p>
axis</a></li>
<li><a href='#Johnston_Flight_heights_SOSS'><p>Summarized flight height profiles from Johnston et al (2014)</p></a></li>
<li><a href='#mig_stoch_crm'><p>Stochastic migration collision risk model</p></a></li>
<li><a href='#rbeta_dmp'><p>Customised sampling functions for the Beta distributions</p></a></li>
<li><a href='#rotor_grids_test'><p>Sample rotor grids for generated_rotor_grids unit test</p></a></li>
<li><a href='#rtnorm_dmp'><p>Customised sampling of Truncated Normal distribution</p></a></li>
<li><a href='#sample_parameters'><p>Parameter sampling whiz</p></a></li>
<li><a href='#sample_qtls'><p>Generate random draws based on empirical c.d.f.</p></a></li>
<li><a href='#sample_turbine_mCRM'><p>Sampling function for a single turbine in the mCRM</p></a></li>
<li><a href='#sampler_hd'><p>Customised sampling function wrapper</p></a></li>
<li><a href='#seq_months'><p>Generate sequence of months</p></a></li>
<li><a href='#stoch_crm'><p>Stochastic collision risk model for a single species and one wind farm scenario</p></a></li>
<li><a href='#stochLAB'><p>stochLAB: Stochastic Collision Risk Model</p></a></li>
<li><a href='#turb_pars_wide_example'><p>Example of turbine and windfarm parameters stored in wide format</p></a></li>
<li><a href='#validate_inputs'><p>Input validator</p></a></li>
<li><a href='#wndspd_rtn_ptch_example'><p>Example of data with relationship between wind speed, rotation speed and</p>
blade pitch</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stochastic Collision Risk Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Collision Risk Models for avian fauna (seabird and migratory birds) at
    offshore wind farms. The base deterministic model is derived from 
    Band (2012) <a href="https://tethys.pnnl.gov/publications/using-collision-risk-model-assess-bird-collision-risks-offshore-wind-farms">https://tethys.pnnl.gov/publications/using-collision-risk-model-assess-bird-collision-risks-offshore-wind-farms</a>. 
    This was further expanded on by Masden (2015) &lt;<a href="https://doi.org/10.7489%2F1659-1">doi:10.7489/1659-1</a>&gt; and code 
    used here is heavily derived from this work with input from Dr A. Cook at the 
    British Trust for Ornithology. These collision risk models are useful for 
    marine ornithologists who are working in the offshore wind industry, particularly 
    in UK waters. However, many of the species included in the stochastic collision 
    risk models can also be found in the North Atlantic in the 
    United States and Canada, and could be applied there. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, dplyr, glue, logr, magrittr, msm, pracma, purrr, rlang,
stats, tibble, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, spelling, testthat (&ge; 3.0.0), covr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>bzip2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/HiDef-Aerial-Surveying/stochLAB">https://github.com/HiDef-Aerial-Surveying/stochLAB</a>,
<a href="https://hidef-aerial-surveying.github.io/stochLAB/">https://hidef-aerial-surveying.github.io/stochLAB/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/HiDef-Aerial-Surveying/stochLAB/issues">https://github.com/HiDef-Aerial-Surveying/stochLAB/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-21 19:18:54 UTC; humph</td>
</tr>
<tr>
<td>Author:</td>
<td>Grant Humphries <a href="https://orcid.org/0000-0001-5783-9892"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Bruno Caneco [aut],
  Aonghais Cook [aut],
  Elizabeth Masden [aut],
  Marine Scotland [fnd, cph],
  HiDef [cph],
  DMPstats [cph],
  Kelly Street [rev] (@kstreet13)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Grant Humphries &lt;grwhumphries@blackbawks.net&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-22 08:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code style="white-space: pre;">&#8288;magrittr::[\%&gt;\%][magrittr::pipe]&#8288;</code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='band_crm'>Collision risk model, for a single species and one turbine scenario</h2><span id='topic+band_crm'></span>

<h3>Description</h3>

<p>Core function of the Collision Risk Model (CRM). Calculates the expected
number of in-flight collisions per month of a seabird species on a given
offshore windfarm, for a choice of model options.
</p>
<p>Calculations are equivalent to those performed on the original CRM
<a href="https://www.bto.org/sites/default/files/u28/downloads/Projects/Final_Report_SOSS02_Band2Tool.xlsm">spreadsheet</a>,
as per <a href="https://www.bto.org/sites/default/files/u28/downloads/Projects/Final_Report_SOSS02_Band1ModelGuidance.pdf">Band (2012)</a>,
providing backward compatibility with the original outputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>band_crm(
  model_options = c("1", "2", "3", "4"),
  flight_speed,
  body_lt,
  wing_span,
  flight_type,
  avoid_rt_basic = NULL,
  avoid_rt_ext = NULL,
  noct_activity,
  prop_crh_surv = NULL,
  dens_month,
  prop_upwind,
  site_fhd = NULL,
  gen_fhd = NULL,
  rotor_speed,
  rotor_radius,
  blade_width,
  blade_pitch,
  n_blades,
  hub_height,
  chord_prof = chord_prof_5MW,
  n_turbines,
  turb_oper_month,
  wf_width,
  wf_latitude,
  tidal_offset,
  lrg_arr_corr = TRUE,
  xinc = 0.05,
  yinc = 0.05,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="band_crm_+3A_model_options">model_options</code></td>
<td>
<p>Character vector, the model options for calculating collision
risk (see <strong>Details</strong> section below).</p>
</td></tr>
<tr><td><code id="band_crm_+3A_flight_speed">flight_speed</code></td>
<td>
<p>Numeric value. The bird flying speed (<code class="reqn">v</code>), in
metres/sec.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_body_lt">body_lt</code></td>
<td>
<p>Numeric value. The length of the bird (<code class="reqn">L</code>), in metres.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_wing_span">wing_span</code></td>
<td>
<p>Numeric value. The wingspan of the bird (<code class="reqn">W</code>), in
metres.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_flight_type">flight_type</code></td>
<td>
<p>A character string, either 'flapping' or 'gliding',
indicating the species' characteristic flight type.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_avoid_rt_basic">avoid_rt_basic</code>, <code id="band_crm_+3A_avoid_rt_ext">avoid_rt_ext</code></td>
<td>
<p>Numeric values. The avoidance rate for,
respectively, the basic model (i.e. required for model Options 1 and 2) and
the extended model (i.e. required for Options 3 and 4). Avoidance rate
expresses the probability that a bird flying on a collision course with a
turbine will take evading action to avoid collision.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_noct_activity">noct_activity</code></td>
<td>
<p>A numeric value. The nocturnal flight activity level,
expressed as a proportion of daytime activity levels (<code class="reqn">f_night</code>).</p>
</td></tr>
<tr><td><code id="band_crm_+3A_prop_crh_surv">prop_crh_surv</code></td>
<td>
<p>The proportion of flights at collision risk height derived
from site survey (<code class="reqn">Q_2R</code>). Only required for model Option 1.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_dens_month">dens_month</code></td>
<td>
<p>Data frame, containing estimates of daytime in-flight
bird densities per month within the windfarm footprint, in birds/km^2. It
must contain the following named columns:
</p>

<ul>
<li> <p><code>month</code>, the month names.
</p>
</li>
<li><p><code>dens</code>, the number of birds in flight at any height per
square kilometre in each month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="band_crm_+3A_prop_upwind">prop_upwind</code></td>
<td>
<p>Numeric value between 0-1 giving the proportion of
flights upwind - defaults to 0.5.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_gen_fhd">gen_fhd</code>, <code id="band_crm_+3A_site_fhd">site_fhd</code></td>
<td>
<p>Data frame objects, with flight height distributions
(fhd) of the species - the relative frequency distribution of bird flights
at 1-metre height intervals from sea surface.
Specifically:
</p>

<ul>
<li><p><code>gen_fhd</code>, Data frame with the species' generic fhd derived
from combining wider survey data. Only required for model Options 2 and 3
</p>
</li>
<li><p><code>site_fhd</code>, Data frame with the species' site-specific fhd
derived from local survey data. Only required for model Option 4
</p>
</li></ul>

<p>Data frames must contain the following named columns:
</p>

<ul>
<li><p><code>height</code>, integers representing height bands from sea surface,
in metres. Function expects 0 as the first value, representing the 0-1m
band.
</p>
</li>
<li><p><code>prop</code>, the proportion of flights at each height band.
</p>
</li></ul>
</td></tr>
<tr><td><code id="band_crm_+3A_rotor_speed">rotor_speed</code></td>
<td>
<p>Numeric value. The operational rotation speed, in
revolutions/min.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_rotor_radius">rotor_radius</code></td>
<td>
<p>Numeric value. The radius of the rotor (<code class="reqn">R</code>), in
metres.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_blade_width">blade_width</code></td>
<td>
<p>Numeric value, giving the maximum blade width, in metres.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_blade_pitch">blade_pitch</code></td>
<td>
<p>Numeric value. The average blade pitch angle, the angle
between the blade surface and the rotor plane (<code class="reqn">\gamma</code>), in radians.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_n_blades">n_blades</code></td>
<td>
<p>An integer, the number of blades in rotor (<code class="reqn">b</code>).</p>
</td></tr>
<tr><td><code id="band_crm_+3A_hub_height">hub_height</code></td>
<td>
<p>A numeric value, the height of the rotor hub (<code class="reqn">H</code>), given by the
sum of rotor radius and minimum blade clearance above the highest
astronomical tide (HAT), in metres.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_chord_prof">chord_prof</code></td>
<td>
<p>A data frame with the chord taper profile of the rotor
blade. Function expects two named columns:
</p>

<ul>
<li><p><code>pp_radius</code>, equidistant intervals of radius at bird passage point,
as a proportion of <code>rotor_radius</code>, within the range <code class="reqn">[0, 1]</code>.
</p>
</li>
<li><p><code>chord</code>, the chord width at <code>pp_radius</code>, as a proportion
of <code>blade_width</code>.
</p>
</li></ul>

<p>Defaults to a generic profile for a typical modern 5MW turbine. See
<code><a href="#topic+chord_prof_5MW">chord_prof_5MW()</a></code> for details.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_n_turbines">n_turbines</code></td>
<td>
<p>Integer, the number of turbines on the wind farm
(<code class="reqn">T</code>).</p>
</td></tr>
<tr><td><code id="band_crm_+3A_turb_oper_month">turb_oper_month</code></td>
<td>
<p>Data frame, holding the proportion of time during
which turbines are operational per month. The following named column are
expected:
</p>

<ul>
<li><p><code>month</code>, the month names.
</p>
</li>
<li><p><code>prop_oper</code>, the proportion of time operating, per month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="band_crm_+3A_wf_width">wf_width</code></td>
<td>
<p>Numeric value, the approximate longitudinal width of the
wind farm, in kilometres (<code class="reqn">w</code>).</p>
</td></tr>
<tr><td><code id="band_crm_+3A_wf_latitude">wf_latitude</code></td>
<td>
<p>A decimal value. The latitude of the centroid of the
windfarm, in degrees.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_tidal_offset">tidal_offset</code></td>
<td>
<p>A numeric value, the tidal offset, the difference between
HAT and mean sea level, in metres.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_lrg_arr_corr">lrg_arr_corr</code></td>
<td>
<p>Boolean value. If TRUE, the large array correction will
be applied. This is a correction factor to account for the decay in
bird density at later rows in wind farms with a large array of turbines.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_yinc">yinc</code>, <code id="band_crm_+3A_xinc">xinc</code></td>
<td>
<p>numeric values, the increments along the y-axis and x-axis
for numerical integration across segments of the rotor circle. Chosen
values express proportion of rotor radius. By default these are set to
0.05, i.e. integration will be performed at a resolution of one twentieth
of the rotor radius.</p>
</td></tr>
<tr><td><code id="band_crm_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass on when function is called in
<code>stoch_crm()</code>, namely <code>rotor_grids</code> and <code>wf_daynight_hrs_month</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Collision risk can be calculated under 4 options, specified by <code>model_options</code>:
</p>

<ul>
<li> <p><strong>Option 1</strong> - Basic model with proportion at
collision risk height derived from site survey (<code>prop_crh_surv</code>).
</p>
</li>
<li> <p><strong>Option 2</strong> - Basic model with proportion
at collision risk height derived from a generic flight height distribution
(<code>gen_fhd</code>).
</p>
</li>
<li> <p><strong>Option 3</strong> - Extended model using a
generic flight height distribution (<code>gen_fhd</code>).
</p>
</li>
<li> <p><strong>Option 4</strong> - Extended model using a
site-specific flight height distribution (<code>site_fhd</code>).
</p>
</li></ul>

<p>Where,
</p>

<ul>
<li><p> Basic model - assumes a uniform distribution of bird flights at
collision risk height (i.e. above the minimum and below the maximum height
of the rotor blade).
</p>
</li>
<li><p> Extended model - takes into account the distribution of bird flight
heights at collision risk height.
</p>
</li></ul>



<h3>Value</h3>

<p>Returns the expected number of bird collisions per month, for each of
the chosen CRM Options. Returned months are those shared between
<code>dens_month</code> and <code>turb_oper_month</code>. Output format is specific to how
the function is called:
</p>

<ul>
<li><p> data frame object, if called as a stand-alone function.
</p>
</li>
<li><p> list object, if called inside <code>stoch_crm()</code>.
</p>
</li></ul>



<h3>Validation and pre-processing of inputs</h3>

<p><code>band_crm()</code> requirements and behaviour are dependent on how it is called:
</p>

<dl>
<dt>As a stand-alone function</dt><dd>

<ul>
<li><p> All arguments are expected to be specified as describe above
</p>
</li>
<li><p> Input validation and pre-processing are carried out.
</p>
</li></ul>

</dd>
<dt>Inside <code>stoch_crm()</code></dt><dd>

<ul>
<li><p> Assumes inputs have already been pre-processed and validated, and
thence it skips those steps.
</p>
</li>
<li><p>  Additional arguments <code>rotor_grids</code> and
<code>wf_daynight_hrs_month</code> need to be passed to the function. Under the
stochastic context, these quantities can be calculated ahead of the
simulation loop to maximize performance. </p>
</li>
<li><p> Furthermore,
<code>gen_fhd</code>, <code>site_fhd</code>, <code>dens_month</code> and
<code>turb_oper_month</code> can be provided as numeric vectors
</p>
</li></ul>
</dd>
</dl>



<h3>Code revision and optimization</h3>

<p>Core code performing Band calculations in <a href="https://www.gov.scot/publications/scottish-marine-freshwater-science-vol-6-14-developing-avian-collision/">Masden (2015)</a> implementation
was substantially re-factored, re-structured and streamlined to conform with
conventional R packages requirements.
</p>
<p>Furthermore, previous code underpinning key calculations for the extended
model was replaced by an alternative approach, resulting in significant gains
in computational speed over Masden's approach. This
optimization is particularly beneficial under a stochastic context, when Band
calculations are called repeatedly, potentially thousands of times. See
<code><a href="#topic+generate_rotor_grids">generate_rotor_grids()</a></code> for further details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ------------------------------------------------------
# Run with arbitrary parameter values, for illustration
# ------------------------------------------------------

# Setting a dataframe of parameters to draw from
params &lt;- data.frame(
  flight_speed = 13.1,         # Flight speed in m/s
  body_lt = 0.85,              # Body length in m
  wing_span = 1.01,            # Wing span in m
  flight_type = "flapping",    # flapping or gliding flight
  avoid_rt_basic = 0.989,      # avoidance rate for option 1 and 2
  avoid_rt_ext = 0.981,        # extended avoidance rate for option 3 and 4
  noct_activity = 0.5,         # proportion of day birds are inactive
  prop_crh_surv = 0.13,        # proportion of birds at collision risk height (option 1 only)
  prop_upwind = 0.5,           # proportion of flights that are upwind
  rotor_speed = 15,            # rotor speed in m/s
  rotor_radius = 120,          # radius of turbine in m
  blade_width = 5,             # width of turbine blades at thickest point in m
  blade_pitch = 15,            # mean radius pitch in Radians
  n_blades = 3,                # total number of blades per turbine
  hub_height = 150,            # height of hub in m above HAT
  n_turbines = 100,            # number of turbines in the wind farm
  wf_width = 52,               # width across longest section of wind farm
  wf_latitude = 56,            # latitude of centroid of wind farm
  tidal_offset = 2.5,          # mean tidal offset from HAT of the wind farm
  lrg_arr_corr = TRUE          # apply a large array correction?
)

# Monthly bird densities
b_dens &lt;- data.frame(
  month = month.abb,
  dens = runif(12, 0.8, 1.5)
)

# flight height distribution from Johnston et al
gen_fhd_dat &lt;- Johnston_Flight_heights_SOSS %&gt;%
  dplyr::filter(variable=="Gannet.est") %&gt;%
  dplyr::select(height,prop)


# monthly operational time of the wind farm
turb_oper &lt;- data.frame(
  month = month.abb,
  prop_oper = runif(12,0.5,0.8)
)


band_crm(
  model_options = c(1,2,3),
  flight_speed = params$flight_speed,
  body_lt = params$body_lt,
  wing_span = params$wing_span,
  flight_type = params$flight_type,
  avoid_rt_basic = params$avoid_rt_basic,
  avoid_rt_ext = params$avoid_rt_ext,
  noct_activity = params$noct_activity,
  prop_crh_surv = params$prop_crh_surv,
  dens_month = b_dens,
  prop_upwind = params$prop_upwind,
  gen_fhd = gen_fhd_dat,
  site_fhd = NULL,  # Option 4 only
  rotor_speed = params$rotor_speed,
  rotor_radius = params$rotor_radius,
  blade_width = params$blade_width,
  blade_pitch = params$blade_pitch,
  n_blades = params$n_blades,
  hub_height = params$hub_height,
  chord_prof = chord_prof_5MW,
  n_turbines = params$n_turbines,
  turb_oper_month = turb_oper,
  wf_width = params$wf_width,
  wf_latitude = params$wf_latitude,
  tidal_offset = params$tidal_offset,
  lrg_arr_corr = params$lrg_arr_corr
  )
</code></pre>

<hr>
<h2 id='band_spreadsheet_dt'>Parameter values and outputs from Band's Collision Risk spreadsheet
(&quot;Final_Report_SOSS02_BandSpreadSheetWorkedExampl1.xlsm&quot;)</h2><span id='topic+band_spreadsheet_dt'></span>

<h3>Description</h3>

<p>A list object comprising parameter values and outputs from Band's worked example
for testing the consistency of package functions with the original model and
its implementation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>band_spreadsheet_dt
</code></pre>


<h3>Format</h3>

<p>A list object containing:
</p>

<dl>
<dt>flight_speed</dt><dd><p>Bird flight speed, in m/s</p>
</dd>
<dt>rotor_radius</dt><dd><p>rotor radius, in meters</p>
</dd>
</dl>
<p>...

</p>

<hr>
<h2 id='band_spreadsheet_dt_2'>Parameter values and outputs from Band's Collision Risk spreadsheet, example
nr. 2</h2><span id='topic+band_spreadsheet_dt_2'></span>

<h3>Description</h3>

<p>A list object comprising parameter values and outputs from Band's worked example
for testing the consistency of package functions with the original model and
its implementation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>band_spreadsheet_dt_2
</code></pre>


<h3>Format</h3>

<p>A list object containing:
</p>

<dl>
<dt>flight_speed</dt><dd><p>Bird flight speed, in m/s</p>
</dd>
<dt>rotor_radius</dt><dd><p>rotor radius, in meters</p>
</dd>
</dl>
<p>...

</p>

<hr>
<h2 id='bird_pars_wide_example'>Example of bird parameters stored in wide format</h2><span id='topic+bird_pars_wide_example'></span>

<h3>Description</h3>

<p>A data frame of (fake) data on biological parameters of three seabird
species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bird_pars_wide_example
</code></pre>


<h3>Format</h3>

<p>A 3 x 16 data frame, with the biological parameters (columns) for
each of the 3 species (rows). Columns include:
</p>

<dl>
<dt>Species</dt><dd><p>Species name</p>
</dd>
<dt>AvoidanceBasic</dt><dd><p>Mean of basic avoidance rate</p>
</dd>
<dt>AvoidanceBasicSD</dt><dd><p>SD of basic avoidance rate</p>
</dd>
<dt>AvoidanceExtended</dt><dd><p>Mean of extended avoidance rate</p>
</dd>
<dt>AvoidanceExtendedSD</dt><dd><p>SD of extended avoidance rate</p>
</dd>
<dt>Body_Length</dt><dd><p>Mean body length</p>
</dd>
<dt>Body_LengthSD</dt><dd><p>SD of body length</p>
</dd>
</dl>
<p>...

</p>


<h3>Details</h3>

<p>Intended to illustrate the application of <code>stoch_scrm()</code> to a multiple
scenario setting, where parameter data is available from tables in wide format.
</p>

<hr>
<h2 id='chord_prof_5MW'>Rotor blade chord profile</h2><span id='topic+chord_prof_5MW'></span>

<h3>Description</h3>

<p>A data.frame giving the blade's chord width profile, i.e. the chord width
along the length of the blade, provided as a proportion of its maximum width.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chord_prof_5MW
</code></pre>


<h3>Format</h3>

<p>A dataframe
</p>

<dl>
<dt>pp_radius</dt><dd><p>radius at bird passage point, as a proportion of rotor radius (R)</p>
</dd>
<dt>chord</dt><dd><p>chord width at pp_radius, as a proportion of the maximum chord width</p>
</dd>
</dl>
<p>...

</p>


<h3>Details</h3>

<p>This is a generic profile for a typical modern 5MW turbine used for offshore generation.
Due to commercial sensitivities by blade manufacturers, some of this detailed
information may not be readily available for each make/model of blade and
hence generic information may have to be used.
</p>


<h3>Note</h3>

<p><code>"chord_prof_5MW"</code> is numerically identical to <code>"coverC"</code>.
<code>"coverC"</code> should become deprecated in future versions of the code
</p>

<hr>
<h2 id='crm_opt1'>Number of collisions under model option 1</h2><span id='topic+crm_opt1'></span>

<h3>Description</h3>

<p>Wrapper function to run CRM calculations under option 1:
</p>

<ul>
<li><p> Basic model, i.e. flights across collision risk height are
uniformly distributed.
</p>
</li>
<li><p> Proportion at collision risk height derived from site survey.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>crm_opt1(
  flux_factor,
  prop_crh_surv,
  avg_prob_coll,
  mth_prop_oper,
  avoidance_rate,
  lac_factor
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crm_opt1_+3A_flux_factor">flux_factor</code></td>
<td>
<p>a vector containing the flux factor for each month</p>
</td></tr>
<tr><td><code id="crm_opt1_+3A_prop_crh_surv">prop_crh_surv</code></td>
<td>
<p>The proportion of flights at collision risk height derived
from site survey (<code class="reqn">Q_2R</code>). Only required for model Option 1.</p>
</td></tr>
<tr><td><code id="crm_opt1_+3A_avg_prob_coll">avg_prob_coll</code></td>
<td>
<p>A numeric value, the average probability of collision for a single bird
transit through a rotor, assuming no avoidance action (<code class="reqn">p_{average}</code>).</p>
</td></tr>
<tr><td><code id="crm_opt1_+3A_mth_prop_oper">mth_prop_oper</code></td>
<td>
<p>A numeric vector, the proportion of time during which
turbines are operational per month.</p>
</td></tr>
<tr><td><code id="crm_opt1_+3A_avoidance_rate">avoidance_rate</code></td>
<td>
<p>A numeric value within the interval <code class="reqn">[0, 1]</code>. The
avoidance rate, expressing the probability that a bird flying on a
collision course with a turbine will take evading action to avoid collision.</p>
</td></tr>
<tr><td><code id="crm_opt1_+3A_lac_factor">lac_factor</code></td>
<td>
<p>A numerical value, the large array correction factor.
Defaults to 1, meaning large array correction is not applicable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector, the expected number of collisions per month based
on model option 1
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_flux_factor">get_flux_factor()</a></code> for calculating the flux factor
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 flux_fct &lt;- get_flux_factor(
      n_turbines = 100,
      rotor_radius = 120,
      flight_speed = 13.1,
      bird_dens = c(1.19,0.85,1.05,1.45,1.41,1.45,1.12,1.45,0.93,0.902,1.06,1.23),
      daynight_hrs = Day_Length(52),
      noct_activity = 0.5
      )

turb_oper &lt;- data.frame(
   month = month.abb,
   prop_oper = runif(12,0.5,0.8)
   )
turb_oper_month &lt;- turb_oper$prop_oper

crm_opt1(
 flux_factor = flux_fct,
 prop_crh_surv = 0.13,
 avg_prob_coll = 0.1494609,
 mth_prop_oper = turb_oper_month,
 avoidance_rate = 0.989,
 lac_factor = 0.9998287)

</code></pre>

<hr>
<h2 id='crm_opt2'>Number of collisions under model option 2</h2><span id='topic+crm_opt2'></span>

<h3>Description</h3>

<p>Wrapper function to run CRM calculations under option 2, i.e.:
</p>

<ul>
<li><p> Basic model, i.e. flights across collision risk height are uniformly
distributed
</p>
</li>
<li><p> Proportion at collision risk height derived from a flight height
distribution (<code class="reqn">Q'_2R</code>)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>crm_opt2(
  d_y,
  flux_factor,
  avg_prob_coll,
  mth_prop_oper,
  avoidance_rate,
  lac_factor
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crm_opt2_+3A_d_y">d_y</code></td>
<td>
<p>a vector with the proportion of bird flights at height bands
within the rotor disc</p>
</td></tr>
<tr><td><code id="crm_opt2_+3A_flux_factor">flux_factor</code></td>
<td>
<p>a vector containing the flux factor for each month</p>
</td></tr>
<tr><td><code id="crm_opt2_+3A_avg_prob_coll">avg_prob_coll</code></td>
<td>
<p>A numeric value, the average probability of collision for a single bird
transit through a rotor, assuming no avoidance action (<code class="reqn">p_{average}</code>).</p>
</td></tr>
<tr><td><code id="crm_opt2_+3A_mth_prop_oper">mth_prop_oper</code></td>
<td>
<p>A numeric vector, the proportion of time during which
turbines are operational per month.</p>
</td></tr>
<tr><td><code id="crm_opt2_+3A_avoidance_rate">avoidance_rate</code></td>
<td>
<p>A numeric value within the interval <code class="reqn">[0, 1]</code>. The
avoidance rate, expressing the probability that a bird flying on a
collision course with a turbine will take evading action to avoid collision.</p>
</td></tr>
<tr><td><code id="crm_opt2_+3A_lac_factor">lac_factor</code></td>
<td>
<p>A numerical value, the large array correction factor.
Defaults to 1, meaning large array correction is not applicable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector, the expected number of collisions per month based
on model Option 2.
</p>


<h3>See Also</h3>

<p><code>get_fhd_rotor()</code>, <code>get_flux_factor()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
avg_collision_risk &lt;-
 get_avg_prob_collision(
   flight_speed = 13.1,
   body_lt = 0.85,
   wing_span = 1.01,
   prop_upwind = 0.5,
   flap_glide = 1,
   rotor_speed = 15,
   rotor_radius = 120,
   blade_width = 5,
   blade_pitch = 15,
   n_blades = 3,
   chord_prof = chord_prof_5MW
 )


 gen_fhd_dat &lt;- Johnston_Flight_heights_SOSS %&gt;%
      dplyr::filter(variable=="Gannet.est") %&gt;%
      dplyr::select(height,prop)

 gen_fhd &lt;- gen_fhd_dat$prop

 gen_fhd_at_rotor &lt;-
    get_fhd_rotor(
      hub_height = 150,
      fhd = gen_fhd,
      rotor_radius = 120,
      tidal_offset = 2.5,
      yinc = 0.05)


 flux_fct &lt;- get_flux_factor(
      n_turbines = 100,
      rotor_radius = 120,
      flight_speed = 13.1,
      bird_dens = c(1.19,0.85,1.05,1.45,1.41,1.45,1.12,1.45,0.93,0.902,1.06,1.23),
      daynight_hrs = Day_Length(52),
      noct_activity = 0.5
      )

turb_oper &lt;- data.frame(
   month = month.abb,
   prop_oper = runif(12,0.5,0.8)
   )
turb_oper_month &lt;- turb_oper$prop_oper

crm_opt2(
    flux_factor = flux_fct,
    d_y = gen_fhd_at_rotor,
    avg_prob_coll = avg_collision_risk,
    mth_prop_oper = turb_oper_month,
    avoidance_rate = 0.989,
   lac_factor = 0.9998299)

</code></pre>

<hr>
<h2 id='crm_opt3'>Number of collisions under model Option 3</h2><span id='topic+crm_opt3'></span>

<h3>Description</h3>

<p>Wrapper function to run CRM calculations under option 3, i.e.:
</p>

<ul>
<li><p> Using the extended model, which takes into account the distribution
of bird flight heights at risk height (above the minimum and below the
maximum height of the rotor blade)
</p>
</li>
<li><p> Using generic flight height distribution data
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>crm_opt3(
  rotor_grids,
  d_y_gen,
  rotor_radius,
  blade_width,
  rotor_speed,
  blade_pitch,
  flight_type,
  wing_span,
  flight_speed,
  body_lt,
  n_blades,
  prop_upwind,
  avoidance_rate,
  flux_factor,
  mth_prop_oper,
  lac_factor
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crm_opt3_+3A_rotor_grids">rotor_grids</code></td>
<td>
<p>A list object containing geometric attributes of the rotor
at equidistant points within its unit circle. This object should be
built via the function <code>generate_rotor_grids()</code>.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_d_y_gen">d_y_gen</code></td>
<td>
<p>a vector with the proportion of birds at height bands within
the rotor disc, from a generic flight height distribution</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_rotor_radius">rotor_radius</code></td>
<td>
<p>Numeric value. The radius of the rotor (<code class="reqn">R</code>), in
metres.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_blade_width">blade_width</code></td>
<td>
<p>Numeric value, giving the maximum blade width, in metres.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_rotor_speed">rotor_speed</code></td>
<td>
<p>Numeric value. The operational rotation speed, in
revolutions/min.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_blade_pitch">blade_pitch</code></td>
<td>
<p>Numeric value. The average blade pitch angle, the angle
between the blade surface and the rotor plane (<code class="reqn">\gamma</code>), in radians.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_flight_type">flight_type</code></td>
<td>
<p>A character string, either 'flapping' or 'gliding',
indicating the species' characteristic flight type.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_wing_span">wing_span</code></td>
<td>
<p>Numeric value. The wingspan of the bird (<code class="reqn">W</code>), in
metres.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_flight_speed">flight_speed</code></td>
<td>
<p>Numeric value. The bird flying speed (<code class="reqn">v</code>), in
metres/sec.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_body_lt">body_lt</code></td>
<td>
<p>Numeric value. The length of the bird (<code class="reqn">L</code>), in metres.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_n_blades">n_blades</code></td>
<td>
<p>An integer, the number of blades in rotor (<code class="reqn">b</code>).</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_prop_upwind">prop_upwind</code></td>
<td>
<p>Numeric value between 0-1 giving the proportion of
flights upwind - defaults to 0.5.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_avoidance_rate">avoidance_rate</code></td>
<td>
<p>a numeric value within the interval <code class="reqn">[0, 1]</code>. The
avoidance rate, expressing the probability that a bird flying on a
collision course with a turbine will take evading action to avoid
collision.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_flux_factor">flux_factor</code></td>
<td>
<p>a vector containing the flux factor for each month</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_mth_prop_oper">mth_prop_oper</code></td>
<td>
<p>A numeric vector, the proportion of time during which
turbines are operational per month.</p>
</td></tr>
<tr><td><code id="crm_opt3_+3A_lac_factor">lac_factor</code></td>
<td>
<p>A numerical value, the large array correction factor.
Defaults to 1, meaning large array correction is not applicable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector, the expected number of collisions per month based
on model option 3
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 rotor_grids &lt;- generate_rotor_grids(yinc = 0.05, xinc = 0.05, chord_prof_5MW)

 gen_fhd_dat &lt;- Johnston_Flight_heights_SOSS %&gt;%
      dplyr::filter(variable=="Gannet.est") %&gt;%
      dplyr::select(height,prop)

 gen_fhd &lt;- gen_fhd_dat$prop

 gen_fhd_at_rotor &lt;-
    get_fhd_rotor(
      hub_height = 150,
      fhd = gen_fhd,
      rotor_radius = 120,
      tidal_offset = 2.5,
      yinc = 0.05)


 flux_fct &lt;- get_flux_factor(
      n_turbines = 100,
      rotor_radius = 120,
      flight_speed = 13.1,
      bird_dens = c(1.19,0.85,1.05,1.45,1.41,1.45,1.12,1.45,0.93,0.902,1.06,1.23),
      daynight_hrs = Day_Length(52),
      noct_activity = 0.5
      )

turb_oper &lt;- data.frame(
   month = month.abb,
   prop_oper = runif(12,0.5,0.8)
   )
turb_oper_month &lt;- turb_oper$prop_oper

crm_opt3(
  rotor_grids = rotor_grids,
  d_y_gen = gen_fhd_at_rotor,
  rotor_radius = 120,
  blade_width = 5,
  rotor_speed = 15,
  blade_pitch = 15,
  flight_type = "flapping",
  wing_span = 1.01,
  flight_speed = 13.1,
  body_lt = 0.85,
  n_blades = 3,
  prop_upwind = 0.5,
  avoidance_rate = 0.981,
  flux_factor = flux_fct,
  mth_prop_oper = turb_oper_month,
  lac_factor = 0.9998299
  )

</code></pre>

<hr>
<h2 id='crm_opt4'>Number of collisions under model Option 4</h2><span id='topic+crm_opt4'></span>

<h3>Description</h3>

<p>Wrapper function to run the CRM calculations under option 4, i.e.:
</p>

<ul>
<li><p> Using the extended model, which takes into account the distribution
of bird flight heights at risk height (above the minimum and below the
maximum height of the rotor blade)
</p>
</li>
<li><p> Using site-specific flight height distribution of the species
obtained from site survey data
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>crm_opt4(
  rotor_grids,
  d_y_surv,
  rotor_radius,
  blade_width,
  rotor_speed,
  blade_pitch,
  flight_type,
  wing_span,
  flight_speed,
  body_lt,
  n_blades,
  prop_upwind,
  avoidance_rate,
  flux_factor,
  mth_prop_oper,
  lac_factor
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crm_opt4_+3A_rotor_grids">rotor_grids</code></td>
<td>
<p>A list object containing geometric attributes of the rotor
at equidistant points within its unit circle. This object should be
built via the function <code>generate_rotor_grids()</code>.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_d_y_surv">d_y_surv</code></td>
<td>
<p>a vector with the proportion of birds at height bands within
the rotor disc, from a site-specific flight height distribution</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_rotor_radius">rotor_radius</code></td>
<td>
<p>Numeric value. The radius of the rotor (<code class="reqn">R</code>), in
metres.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_blade_width">blade_width</code></td>
<td>
<p>Numeric value, giving the maximum blade width, in metres.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_rotor_speed">rotor_speed</code></td>
<td>
<p>Numeric value. The operational rotation speed, in
revolutions/min.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_blade_pitch">blade_pitch</code></td>
<td>
<p>Numeric value. The average blade pitch angle, the angle
between the blade surface and the rotor plane (<code class="reqn">\gamma</code>), in radians.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_flight_type">flight_type</code></td>
<td>
<p>A character string, either 'flapping' or 'gliding',
indicating the species' characteristic flight type.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_wing_span">wing_span</code></td>
<td>
<p>Numeric value. The wingspan of the bird (<code class="reqn">W</code>), in
metres.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_flight_speed">flight_speed</code></td>
<td>
<p>Numeric value. The bird flying speed (<code class="reqn">v</code>), in
metres/sec.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_body_lt">body_lt</code></td>
<td>
<p>Numeric value. The length of the bird (<code class="reqn">L</code>), in metres.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_n_blades">n_blades</code></td>
<td>
<p>An integer, the number of blades in rotor (<code class="reqn">b</code>).</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_prop_upwind">prop_upwind</code></td>
<td>
<p>Numeric value between 0-1 giving the proportion of
flights upwind - defaults to 0.5.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_avoidance_rate">avoidance_rate</code></td>
<td>
<p>a numeric value within the interval <code class="reqn">[0, 1]</code>. The
avoidance rate, expressing the probability that a bird flying on a
collision course with a turbine will take evading action to avoid
collision.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_flux_factor">flux_factor</code></td>
<td>
<p>a vector containing the flux factor for each month</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_mth_prop_oper">mth_prop_oper</code></td>
<td>
<p>A numeric vector, the proportion of time during which
turbines are operational per month.</p>
</td></tr>
<tr><td><code id="crm_opt4_+3A_lac_factor">lac_factor</code></td>
<td>
<p>A numerical value, the large array correction factor.
Defaults to 1, meaning large array correction is not applicable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector, the expected number of collisions per month based
on model option 4
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 rotor_grids &lt;- generate_rotor_grids(yinc = 0.05, xinc = 0.05, chord_prof_5MW)

 site_fhd_dat &lt;- Johnston_Flight_heights_SOSS %&gt;%
      dplyr::filter(variable=="Gannet.est") %&gt;%
      dplyr::select(height,prop)

 site_fhd &lt;- site_fhd_dat$prop

 surv_fhd_at_rotor &lt;-
    get_fhd_rotor(
      hub_height = 150,
      fhd = site_fhd,
      rotor_radius = 120,
      tidal_offset = 2.5,
      yinc = 0.05)


 flux_fct &lt;- get_flux_factor(
      n_turbines = 100,
      rotor_radius = 120,
      flight_speed = 13.1,
      bird_dens = c(1.19,0.85,1.05,1.45,1.41,1.45,1.12,1.45,0.93,0.902,1.06,1.23),
      daynight_hrs = Day_Length(52),
      noct_activity = 0.5
      )

turb_oper &lt;- data.frame(
   month = month.abb,
   prop_oper = runif(12,0.5,0.8)
   )
turb_oper_month &lt;- turb_oper$prop_oper

crm_opt4(
  rotor_grids = rotor_grids,
  d_y_surv = surv_fhd_at_rotor,
  rotor_radius = 120,
  blade_width = 5,
  rotor_speed = 15,
  blade_pitch = 15,
  flight_type = "flapping",
  wing_span = 1.01,
  flight_speed = 13.1,
  body_lt = 0.85,
  n_blades = 3,
  prop_upwind = 0.5,
  avoidance_rate = 0.981,
  flux_factor = flux_fct,
  mth_prop_oper = turb_oper_month,
  lac_factor = 0.9998299
  )

</code></pre>

<hr>
<h2 id='Day_Length'>Total day and night hours per month</h2><span id='topic+Day_Length'></span>

<h3>Description</h3>

<p>Taken from Forsythe et al.(1995) A model comparison for daylength as a
function of latitude and day of year.  Ecological Modelling. 80: 87 - 95
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Day_Length(wf_latitude)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Day_Length_+3A_wf_latitude">wf_latitude</code></td>
<td>
<p>A decimal value. The latitude of the centroid of the
windfarm, in degrees.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame with total number of daylight hours and night hours in each
month at the specified latitude.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    x &lt;- Day_Length(54.6)

</code></pre>

<hr>
<h2 id='dens_tnorm_wide_example'>Example of Truncated Normal parameters for monthly estimates of bird density</h2><span id='topic+dens_tnorm_wide_example'></span>

<h3>Description</h3>

<p>A data frame of (fake) monthly bird density parameters for three seabird
species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dens_tnorm_wide_example
</code></pre>


<h3>Format</h3>

<p>A 3 x 25 data frame, with the monthly density parameters (columns) for
each of the 3 species (rows). Columns include:
</p>

<dl>
<dt>Species</dt><dd><p>Species name</p>
</dd>
<dt>Jan</dt><dd><p>January mean density</p>
</dd>
<dt>JanSD</dt><dd><p>SD of density in January</p>
</dd>
<dt>Feb</dt><dd><p>February mean density</p>
</dd>
<dt>FebSD</dt><dd><p>SD of density in February</p>
</dd>
</dl>
<p>...

</p>


<h3>Details</h3>

<p>Intended to illustrate the application of <code>stoch_scrm()</code> to a multiple
scenario setting, where parameter data is available from tables in wide
format.
</p>

<hr>
<h2 id='format_months'>Format any month name to three letter code</h2><span id='topic+format_months'></span>

<h3>Description</h3>

<p>Format any month name to three letter code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_months(months)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_months_+3A_months">months</code></td>
<td>
<p>character string or vector. The name of the month</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string. The three letter name of the month
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  format_months("January")
</code></pre>

<hr>
<h2 id='generate_rotor_grids'>Geometric attributes at equidistant points within the rotor's unit circle</h2><span id='topic+generate_rotor_grids'></span>

<h3>Description</h3>

<p>Generates a list of grids containing geometric attributes of the
rotor disk at equidistant locations, taking the center of the rotor as
the reference point and overlaying the left-half of the rotor disk. The
size of grid cells are determined by <code>xinc</code> and <code>yinc</code>, and their
values map properties of the rotor at the cell's location.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_rotor_grids(yinc = 0.05, xinc = 0.05, chord_prof)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate_rotor_grids_+3A_yinc">yinc</code>, <code id="generate_rotor_grids_+3A_xinc">xinc</code></td>
<td>
<p>numeric values, the grid increments along the y-axis and
x-axis (i.e. grid cell dimensions)</p>
</td></tr>
<tr><td><code id="generate_rotor_grids_+3A_chord_prof">chord_prof</code></td>
<td>
<p>A data frame with the chord taper profile of the rotor
blade. Function expects two named columns:
</p>

<ul>
<li><p><code>pp_radius</code>, equidistant intervals of radius at bird passage point,
as a proportion of <code>rotor_radius</code>, within the range <code class="reqn">[0, 1]</code>.
</p>
</li>
<li><p><code>chord</code>, the chord width at <code>pp_radius</code>, as a proportion
of <code>blade_width</code>.
</p>
</li></ul>

<p>Defaults to a generic profile for a typical modern 5MW turbine. See
<code><a href="#topic+chord_prof_5MW">chord_prof_5MW()</a></code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These grids are required for an alternative approach to the
calculation of probability of collision under the extended model (i.e.
non-uniform flight distribution at risk height).
</p>
<p>Functions <code>xrisksum2</code>, <code>pcollxy</code> and <code>pcoll</code> used in Masden
&amp; Cook implementation (<code>PCollFunctions.r</code> script) were based on Visual
Basic computations available in the original Band worksheet. This Visual
Basic code was devised under a deterministic context, i.e. for one single
set of collision calculations for one given species and turbine scenario.
However, in a stochastic context, where potentially thousands of collision
calculations are performed per species and turbine scenario, it became
clear that <code>xrisksum2</code> and associated functions were highly
inefficient for the task at hand.
</p>
<p>The alternative approach streamlines computations by calculating (relative)
rotor geometric attributes outside the stochastic sampling loop, which
remain constant over iterations. These elements, calculated via
<code>generate_rotor_grids</code>, are then applied to sampled parameters
via vectorized operations. The number of calculations per iteration are
thence substantially reduced, leading to significant gains in computational
speed over Masden's implementation for a 1000 iterations
run.
</p>


<h3>Value</h3>

<p>A list with the following elements, taking the center of the rotor as
the origin in the rotor's plane:
</p>

<ul>
<li><p><code>x_grid</code>, a 2D array of horizontal distances from the rotor's
horizontal axis, as proportion of rotor radius, at each grid point
</p>
</li>
<li><p><code>y_grid</code>, a 2D array of vertical distances from the rotor's
vertical axis, as proportion of rotor radius, at each grid point
</p>
</li>
<li><p><code>r_grid</code>, a 2D array of radial distances from rotor center,
as proportion of rotor radius, at each grid point
</p>
</li>
<li><p><code>phi_grid</code>, a 2D array of angles, relative to vertical, at
each grid point
</p>
</li>
<li><p><code>chord_grid</code>, a 2D array of blade chord width at each grid
point
</p>
</li></ul>

<p>All elements are representative of the left-half of the rotor circle
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_x_grid">get_x_grid()</a></code>, <code><a href="#topic+get_y_grid">get_y_grid()</a></code>,
<code><a href="#topic+get_phi_grid">get_phi_grid()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rotor_grids &lt;- generate_rotor_grids(yinc = 0.05, xinc = 0.05, chord_prof_5MW)

</code></pre>

<hr>
<h2 id='generic_fhd_bootstraps'>Bootstrap samples of generic FHDs of 25 seabird species</h2><span id='topic+generic_fhd_bootstraps'></span>

<h3>Description</h3>

<p>A list object comprising bootstrap samples of the generic flight height
distribution (FHD) of 25 seabird species. FHD is expressed as the proportion
of bird flights at 1 metre height intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generic_fhd_bootstraps
</code></pre>


<h3>Format</h3>

<p>A list object with 25 elements, one for each species, containing a data
frame with 500 bootstrap samples of the distribution of bird flights with height.
Each nested data frame contains:
</p>

<dl>
<dt>height</dt><dd><p>Height above sea level, in metres. First element represents the
0-1 meters height band, and height interval is 1 metre.</p>
</dd>
<dt>bootId_1</dt><dd><p>First bootstrap sample of the proportion of birds flights
within each height interval</p>
</dd>
</dl>
<p>...
</p>
<dl>
<dt>bootId_200</dt><dd><p>200th bootstrap sample of the proportion of birds flights
within each height interval</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/1365-2664.12191">https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/1365-2664.12191</a>
</p>

<hr>
<h2 id='get_avg_prob_collision'>Average single transit collision risk with no avoidance</h2><span id='topic+get_avg_prob_collision'></span>

<h3>Description</h3>

<p>Calculate the average probability of collision for a single bird transit at
any point across the rotor, assuming no avoidance action. Required for the
Basic model calculations, where flights at collision risk height are
assumed to be uniformly distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_avg_prob_collision(
  flight_speed,
  body_lt,
  wing_span,
  prop_upwind = 0.5,
  flap_glide,
  rotor_speed,
  rotor_radius,
  blade_width,
  blade_pitch,
  n_blades,
  chord_prof = chord_prof_5MW
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_avg_prob_collision_+3A_flight_speed">flight_speed</code></td>
<td>
<p>Numeric value. The bird flying speed (<code class="reqn">v</code>), in
metres/sec.</p>
</td></tr>
<tr><td><code id="get_avg_prob_collision_+3A_body_lt">body_lt</code></td>
<td>
<p>Numeric value. The length of the bird (<code class="reqn">L</code>), in metres.</p>
</td></tr>
<tr><td><code id="get_avg_prob_collision_+3A_wing_span">wing_span</code></td>
<td>
<p>Numeric value. The wingspan of the bird (<code class="reqn">W</code>), in
metres.</p>
</td></tr>
<tr><td><code id="get_avg_prob_collision_+3A_prop_upwind">prop_upwind</code></td>
<td>
<p>Numeric value between 0-1 giving the proportion of
flights upwind - defaults to 0.5.</p>
</td></tr>
<tr><td><code id="get_avg_prob_collision_+3A_flap_glide">flap_glide</code></td>
<td>
<p>Numeric value representing the correction for flapping or
gliding birds (<code class="reqn">F</code>).</p>
</td></tr>
<tr><td><code id="get_avg_prob_collision_+3A_rotor_speed">rotor_speed</code></td>
<td>
<p>Numeric value. The operational rotation speed, in
revolutions/min.</p>
</td></tr>
<tr><td><code id="get_avg_prob_collision_+3A_rotor_radius">rotor_radius</code></td>
<td>
<p>Numeric value. The radius of the rotor (<code class="reqn">R</code>), in
metres.</p>
</td></tr>
<tr><td><code id="get_avg_prob_collision_+3A_blade_width">blade_width</code></td>
<td>
<p>Numeric value, giving the maximum blade width, in metres.</p>
</td></tr>
<tr><td><code id="get_avg_prob_collision_+3A_blade_pitch">blade_pitch</code></td>
<td>
<p>Numeric value. The average blade pitch angle, the angle
between the blade surface and the rotor plane (<code class="reqn">\gamma</code>), in radians.</p>
</td></tr>
<tr><td><code id="get_avg_prob_collision_+3A_n_blades">n_blades</code></td>
<td>
<p>An integer, the number of blades in rotor (<code class="reqn">b</code>).</p>
</td></tr>
<tr><td><code id="get_avg_prob_collision_+3A_chord_prof">chord_prof</code></td>
<td>
<p>A data frame with the chord taper profile of the rotor
blade. Function expects two named columns:
</p>

<ul>
<li><p><code>pp_radius</code>, equidistant intervals of radius at bird passage point,
as a proportion of <code>rotor_radius</code>, within the range <code class="reqn">[0, 1]</code>.
</p>
</li>
<li><p><code>chord</code>, the chord width at <code>pp_radius</code>, as a proportion
of <code>blade_width</code>.
</p>
</li></ul>

<p>Defaults to a generic profile for a typical modern 5MW turbine. See
<code><a href="#topic+chord_prof_5MW">chord_prof_5MW()</a></code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Methodology and assumptions underpinning <code>get_avg_prob_collision</code>
are described in &quot;Stage C&quot; of
<a href="https://www.bto.org/sites/default/files/u28/downloads/Projects/Final_Report_SOSS02_Band1ModelGuidance.pdf">Band (2012)</a>.
</p>


<h3>Value</h3>

<p>A numeric value. The average collision probability (risk) for a bird
flying through any point of the rotor circle area.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>       get_avg_prob_collision(
           flight_speed = 13.1,
           body_lt = 0.85,
           wing_span = 1.01,
           prop_upwind = 0.5,
           flap_glide = 1,
           rotor_speed = 15,
           rotor_radius = 120,
           blade_width = 5,
           blade_pitch = 15,
           n_blades = 3,
           chord_prof = chord_prof_5MW
           )

</code></pre>

<hr>
<h2 id='get_collisions_basic'>Get expected collisions based on the basic model</h2><span id='topic+get_collisions_basic'></span>

<h3>Description</h3>

<p>Provides the number of collisions expected to occur by month. The basic model
assumes a uniform distribution of bird flights at risk height (i.e. between
min and max rotor height).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_collisions_basic(
  n_transits,
  avg_prob_coll,
  mth_prop_oper,
  avoidance_rate,
  lac_factor = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_collisions_basic_+3A_n_transits">n_transits</code></td>
<td>
<p>A numeric vector, the estimated number of bird flights crossing
the rotors of the wind farm at each time period.</p>
</td></tr>
<tr><td><code id="get_collisions_basic_+3A_avg_prob_coll">avg_prob_coll</code></td>
<td>
<p>A numeric value, the average probability of collision for a single bird
transit through a rotor, assuming no avoidance action (<code class="reqn">p_{average}</code>).</p>
</td></tr>
<tr><td><code id="get_collisions_basic_+3A_mth_prop_oper">mth_prop_oper</code></td>
<td>
<p>A numeric vector, the proportion of time during which
turbines are operational per month.</p>
</td></tr>
<tr><td><code id="get_collisions_basic_+3A_avoidance_rate">avoidance_rate</code></td>
<td>
<p>A numeric value within the interval <code class="reqn">[0, 1]</code>. The
avoidance rate, expressing the probability that a bird flying on a
collision course with a turbine will take evading action to avoid collision.</p>
</td></tr>
<tr><td><code id="get_collisions_basic_+3A_lac_factor">lac_factor</code></td>
<td>
<p>A numerical value, the large array correction factor.
Defaults to 1, meaning large array correction is not applicable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector. The expected number of collisions at each time
periods
</p>


<h3>Examples</h3>

<pre><code class='language-R'>turb_oper &lt;- data.frame(
 month = month.abb,
 prop_oper = runif(12,0.5,0.8)
 )
 mth_oper_month &lt;- turb_oper$prop_oper

 flux_factor &lt;- get_flux_factor(
   n_turbines = 100,
   rotor_radius = 120,
   flight_speed = 13.1,
   bird_dens = c(1.19,0.85,1.05,1.45,1.41,1.45,1.12,1.45,0.93,0.902,1.06,1.23),
   daynight_hrs = Day_Length(52),
   noct_activity = 0.5
 )

 prop_crh_surv &lt;- 0.13

 n_transits_opt1 &lt;- flux_factor * prop_crh_surv

 get_collisions_basic(
   n_transits = n_transits_opt1,
   avg_prob_coll = 0.1494609,
   mth_prop_oper = mth_oper_month,
   avoidance_rate = 0.989,
   lac_factor = 0.9998287
 )

</code></pre>

<hr>
<h2 id='get_collisions_extended'>Number of collisions based on the extended model</h2><span id='topic+get_collisions_extended'></span>

<h3>Description</h3>

<p>Calculates the expected number of collisions under the extended model, i.e.
taking into account the distribution of bird flight heights at risk height
(above the minimum and below the  maximum height of the rotor blade)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_collisions_extended(
  rotor_grids,
  d_y,
  rotor_radius,
  blade_width,
  rotor_speed,
  blade_pitch,
  flight_type,
  wing_span,
  flight_speed,
  body_lt,
  n_blades,
  prop_upwind,
  avoidance_rate,
  flux_factor,
  mth_prop_oper,
  lac_factor
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_collisions_extended_+3A_rotor_grids">rotor_grids</code></td>
<td>
<p>A list object containing geometric attributes of the rotor
at equidistant points within its unit circle. This object should be
built via the function <code>generate_rotor_grids()</code>.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_d_y">d_y</code></td>
<td>
<p>a vector with the proportion of birds at height bands within the
rotor disc</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_rotor_radius">rotor_radius</code></td>
<td>
<p>Numeric value. The radius of the rotor (<code class="reqn">R</code>), in
metres.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_blade_width">blade_width</code></td>
<td>
<p>Numeric value, giving the maximum blade width, in metres.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_rotor_speed">rotor_speed</code></td>
<td>
<p>Numeric value. The operational rotation speed, in
revolutions/min.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_blade_pitch">blade_pitch</code></td>
<td>
<p>Numeric value. The average blade pitch angle, the angle
between the blade surface and the rotor plane (<code class="reqn">\gamma</code>), in radians.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_flight_type">flight_type</code></td>
<td>
<p>A character string, either 'flapping' or 'gliding',
indicating the species' characteristic flight type.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_wing_span">wing_span</code></td>
<td>
<p>Numeric value. The wingspan of the bird (<code class="reqn">W</code>), in
metres.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_flight_speed">flight_speed</code></td>
<td>
<p>Numeric value. The bird flying speed (<code class="reqn">v</code>), in
metres/sec.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_body_lt">body_lt</code></td>
<td>
<p>Numeric value. The length of the bird (<code class="reqn">L</code>), in metres.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_n_blades">n_blades</code></td>
<td>
<p>An integer, the number of blades in rotor (<code class="reqn">b</code>).</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_prop_upwind">prop_upwind</code></td>
<td>
<p>Numeric value between 0-1 giving the proportion of
flights upwind - defaults to 0.5.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_avoidance_rate">avoidance_rate</code></td>
<td>
<p>a numeric value within the interval <code class="reqn">[0, 1]</code>. The
avoidance rate, expressing the probability that a bird flying on a
collision course with a turbine will take evading action to avoid
collision.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_flux_factor">flux_factor</code></td>
<td>
<p>a vector containing the flux factor for each month</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_mth_prop_oper">mth_prop_oper</code></td>
<td>
<p>A numeric vector, the proportion of time during which
turbines are operational per month.</p>
</td></tr>
<tr><td><code id="get_collisions_extended_+3A_lac_factor">lac_factor</code></td>
<td>
<p>A numerical value, the large array correction factor.
Defaults to 1, meaning large array correction is not applicable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with the expected number of collisions per month based
on the extended model
</p>


<h3>Note</h3>

<p>The original Masden code for extendend model (Option 3) included the
calculation of the &quot;Flux Integral&quot; and &quot;Average collision risk for single
rotor transit&quot;. These quantities are not required for the calculation of
collisions under the extended model, nor are used anywhere else in the package.
Therefore, those calculations were dropped from the current implementation to
keep computations to a minimum required.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate_rotor_grids">generate_rotor_grids()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 rotor_grids &lt;- generate_rotor_grids(yinc = 0.05, xinc = 0.05, chord_prof_5MW)

 gen_fhd_dat &lt;- Johnston_Flight_heights_SOSS %&gt;%
      dplyr::filter(variable=="Gannet.est") %&gt;%
      dplyr::select(height,prop)

 gen_fhd &lt;- gen_fhd_dat$prop

 gen_fhd_at_rotor &lt;-
    get_fhd_rotor(
      hub_height = 150,
      fhd = gen_fhd,
      rotor_radius = 120,
      tidal_offset = 2.5,
      yinc = 0.05)


 flux_fct &lt;- get_flux_factor(
      n_turbines = 100,
      rotor_radius = 120,
      flight_speed = 13.1,
      bird_dens = c(1.19,0.85,1.05,1.45,1.41,1.45,1.12,1.45,0.93,0.902,1.06,1.23),
      daynight_hrs = Day_Length(52),
      noct_activity = 0.5
      )

turb_oper &lt;- data.frame(
   month = month.abb,
   prop_oper = runif(12,0.5,0.8)
   )
turb_oper_month &lt;- turb_oper$prop_oper

get_collisions_extended(
  rotor_grids = rotor_grids,
  d_y = gen_fhd_at_rotor, # ... with generic FHD = Option 3, with site FHD = Option 4
  rotor_radius = 120,
  blade_width = 5,
  rotor_speed = 15,
  blade_pitch = 15,
  flight_type = "flapping",
  wing_span = 1.01,
  flight_speed = 13.1,
  body_lt = 0.85,
  n_blades = 3,
  prop_upwind = 0.5,
  avoidance_rate = 0.981,
  flux_factor = flux_fct,
  mth_prop_oper = turb_oper_month,
  lac_factor = 0.9998299
  )

</code></pre>

<hr>
<h2 id='get_fhd_rotor'>Returns the proportion of birds at height bands along the rotor</h2><span id='topic+get_fhd_rotor'></span>

<h3>Description</h3>

<p>Derive the expected proportion of bird flights at equidistant
height bands between the lowest and highest points of the rotor. In other
words, returns the flight height distribution at collision risk
(<code class="reqn">d(y)</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fhd_rotor(hub_height, fhd, rotor_radius, tidal_offset, yinc = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_fhd_rotor_+3A_hub_height">hub_height</code></td>
<td>
<p>A numeric value, the height of the rotor hub (<code class="reqn">H</code>), given by the
sum of rotor radius and minimum blade clearance above the highest
astronomical tide (HAT), in metres.</p>
</td></tr>
<tr><td><code id="get_fhd_rotor_+3A_fhd">fhd</code></td>
<td>
<p>A numeric vector, the proportion of bird flights per-1 metre
height bands from sea surface, starting from 0-1 metre band.</p>
</td></tr>
<tr><td><code id="get_fhd_rotor_+3A_rotor_radius">rotor_radius</code></td>
<td>
<p>A numeric value, the radius of the rotor (<code class="reqn">R</code>), in
metres.</p>
</td></tr>
<tr><td><code id="get_fhd_rotor_+3A_tidal_offset">tidal_offset</code></td>
<td>
<p>A numeric value, the tidal offset, the difference between
HAT and mean sea level, in metres.</p>
</td></tr>
<tr><td><code id="get_fhd_rotor_+3A_yinc">yinc</code></td>
<td>
<p>A numeric value, the increment for height bands between the
lowest and highest points of the rotor, expressed as a proportion of rotor
radius (defaults is 0.05).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector, the flight height distribution at collision risk,
i.e. between minimum and maximum rotor height.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 gen_fhd_dat &lt;- Johnston_Flight_heights_SOSS %&gt;%
       dplyr::filter(variable=="Gannet.est") %&gt;%
       dplyr::select(height,prop)
 if(is.data.frame(gen_fhd_dat)) gen_fhd &lt;- gen_fhd_dat$prop

 get_fhd_rotor(
   hub_height = 150,
   fhd = gen_fhd,
   rotor_radius = 120,
   tidal_offset = 2.5,
   yinc = 0.05)

</code></pre>

<hr>
<h2 id='get_flux_factor'>Flux factor</h2><span id='topic+get_flux_factor'></span>

<h3>Description</h3>

<p>Returns the flux factor, expressing the total number of bird flights through
the rotors of the wind farm per month if all flights occurred within the
rotor's circle area of all turbines, i.e. before the proportion at risk
height and avoidance level are taken into account.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_flux_factor(
  n_turbines,
  rotor_radius,
  flight_speed,
  bird_dens,
  daynight_hrs,
  noct_activity
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_flux_factor_+3A_n_turbines">n_turbines</code></td>
<td>
<p>An integer, the number of turbines on the wind farm (<code class="reqn">T</code>).</p>
</td></tr>
<tr><td><code id="get_flux_factor_+3A_rotor_radius">rotor_radius</code></td>
<td>
<p>A numeric value, the radius of the rotor (<code class="reqn">R</code>), in metres.</p>
</td></tr>
<tr><td><code id="get_flux_factor_+3A_flight_speed">flight_speed</code></td>
<td>
<p>A numeric value, the bird flight speed (<code class="reqn">v</code>), in metres/sec.</p>
</td></tr>
<tr><td><code id="get_flux_factor_+3A_bird_dens">bird_dens</code></td>
<td>
<p>A numeric vector with daytime in-flight bird densities (<code class="reqn">D_A</code>), for
each month, in birds/km^2.</p>
</td></tr>
<tr><td><code id="get_flux_factor_+3A_daynight_hrs">daynight_hrs</code></td>
<td>
<p>A data frame with the total number of daylight
hours and night hours at the wind farm site's location, in each month.
It must contain, at least, the following columns:
</p>

<ul>
<li> <p><code>Month</code>, name of the month.
</p>
</li>
<li> <p><code>Day</code>, daylight duration, in decimal hours.
</p>
</li>
<li> <p><code>Night</code>, night time duration, in decimal hour
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_flux_factor_+3A_noct_activity">noct_activity</code></td>
<td>
<p>A numeric value. The nocturnal flight activity level,
expressed as a proportion of daytime activity levels (<code class="reqn">f_night</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The flux factor is used for other model calculations.
Methodology and assumptions underpinning
<code>get_flux_factor</code> are described in &quot;Stage B&quot; of
<a href="https://www.bto.org/sites/default/files/u28/downloads/Projects/Final_Report_SOSS02_Band1ModelGuidance.pdf">Band (2012)</a>
</p>


<h3>Value</h3>

<p>The number of bird flights potentially transiting through rotors at
each time period (assuming no avoidance), if all flights occur within the
rotor's circular area.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  get_flux_factor(
      n_turbines = 100,
      rotor_radius = 120,
      flight_speed = 13.1,
      bird_dens = c(1.19,0.85,1.05,1.45,1.41,1.45,1.12,1.45,0.93,0.902,1.06,1.23),
      daynight_hrs = Day_Length(52),
      noct_activity = 0.5
      )
</code></pre>

<hr>
<h2 id='get_lac_factor'>Large array correction factor</h2><span id='topic+get_lac_factor'></span>

<h3>Description</h3>

<p>A correction factor for large windfarms with a large array of turbines, to
take into account the depletion of bird density in later rows of the site.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_lac_factor(
  n_turbines,
  rotor_radius,
  avoidance_rate,
  avg_prob_coll,
  avg_prop_operational,
  wf_width
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_lac_factor_+3A_n_turbines">n_turbines</code></td>
<td>
<p>Integer, the number of turbines on the wind farm
(<code class="reqn">T</code>).</p>
</td></tr>
<tr><td><code id="get_lac_factor_+3A_rotor_radius">rotor_radius</code></td>
<td>
<p>Numeric value, the radius of the rotor (<code class="reqn">R</code>), in
metres.</p>
</td></tr>
<tr><td><code id="get_lac_factor_+3A_avoidance_rate">avoidance_rate</code></td>
<td>
<p>Numeric value within the interval <code class="reqn">[0, 1]</code>. The species
avoidance rate, expressing the probability that a bird flying on a
collision course with a turbine will take evading action to avoid
collision. (<code class="reqn">A</code>).</p>
</td></tr>
<tr><td><code id="get_lac_factor_+3A_avg_prob_coll">avg_prob_coll</code></td>
<td>
<p>Numeric value, the average probability of collision
for a single bird transit through a rotor, assuming no avoidance action
(<code class="reqn">p_average</code>).</p>
</td></tr>
<tr><td><code id="get_lac_factor_+3A_avg_prop_operational">avg_prop_operational</code></td>
<td>
<p>Numeric value, the average proportion of time
turbines are operational through the year.</p>
</td></tr>
<tr><td><code id="get_lac_factor_+3A_wf_width">wf_width</code></td>
<td>
<p>Numeric value, the approximate longitudinal width of the
wind farm, in kilometres (<code class="reqn">w</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The large array correction factor to be applied
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  get_lac_factor(
     n_turbines = 100,
     rotor_radius = 120,
     avoidance_rate = 0.989,
     avg_prob_coll = 0.1494609,
     avg_prop_operational = 0.6388292,
     wf_width = 52
     )

</code></pre>

<hr>
<h2 id='get_mig_flux_factor'>Migration Flux factor</h2><span id='topic+get_mig_flux_factor'></span>

<h3>Description</h3>

<p>Returns the migratory flux factor, expressing the total number of
bird flights through the rotors of the wind farm per month, if all flights
occur within the rotor's circle area of all turbines, and assuming birds take no
avoiding action.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mig_flux_factor(n_turbines, rotor_radius, wf_width, popn_est)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mig_flux_factor_+3A_n_turbines">n_turbines</code></td>
<td>
<p>An integer. The number of turbines on the wind farm (<code class="reqn">T</code>).</p>
</td></tr>
<tr><td><code id="get_mig_flux_factor_+3A_rotor_radius">rotor_radius</code></td>
<td>
<p>An integer. The radius of the rotor (<code class="reqn">R</code>), in metres</p>
</td></tr>
<tr><td><code id="get_mig_flux_factor_+3A_wf_width">wf_width</code></td>
<td>
<p>An integer. The width (in km) of the</p>
</td></tr>
<tr><td><code id="get_mig_flux_factor_+3A_popn_est">popn_est</code></td>
<td>
<p>An integer. The population estimate from the spatial line sampling technique</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The flux factor is used for other model calculations.
Methodology and assumptions underpinning
<code>get_mig_flux_factor</code> are described in &quot;Stage B&quot; of
<a href="https://www.bto.org/sites/default/files/u28/downloads/Projects/Final_Report_SOSS02_Band1ModelGuidance.pdf">Band (2012)</a>
</p>


<h3>Value</h3>

<p>The number of bird flights potentially transiting through rotors
at each time period (assuming no avoidance), if all flights occur within the
rotor's circular area
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_mig_flux_factor(
     n_turbines = 100,
     rotor_radius = 120,
     wf_width = 51,
     popn_est = 10000
)
</code></pre>

<hr>
<h2 id='get_pcoll_grid'>Grid of probabilities of single transit collision at points in rotor circle</h2><span id='topic+get_pcoll_grid'></span>

<h3>Description</h3>

<p>Calculates single transit collision risk at grid points (X, Y) inside the
left-half of the rotor circle, for a given flight direction (upwind or
downwind), and assuming no avoidance action. The origin of the (X, Y)
coordinates is the rotor center
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_pcoll_grid(
  rotor_grids,
  direction,
  rotor_radius,
  blade_width,
  rotor_speed,
  blade_pitch,
  flight_type,
  n_blades,
  flight_speed,
  wing_span,
  body_lt
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_pcoll_grid_+3A_rotor_grids">rotor_grids</code></td>
<td>
<p>A list object containing geometric attributes of the rotor
at equidistant points within its unit circle. This object should be
built via the function <code>generate_rotor_grids()</code>.</p>
</td></tr>
<tr><td><code id="get_pcoll_grid_+3A_direction">direction</code></td>
<td>
<p>an integer, indicating the flight direction: 1 for upwind;
-1 for downwind.</p>
</td></tr>
<tr><td><code id="get_pcoll_grid_+3A_rotor_radius">rotor_radius</code></td>
<td>
<p>Numeric value. The radius of the rotor (<code class="reqn">R</code>), in
metres.</p>
</td></tr>
<tr><td><code id="get_pcoll_grid_+3A_blade_width">blade_width</code></td>
<td>
<p>Numeric value, giving the maximum blade width, in metres.</p>
</td></tr>
<tr><td><code id="get_pcoll_grid_+3A_rotor_speed">rotor_speed</code></td>
<td>
<p>Numeric value. The operational rotation speed, in
revolutions/min.</p>
</td></tr>
<tr><td><code id="get_pcoll_grid_+3A_blade_pitch">blade_pitch</code></td>
<td>
<p>Numeric value. The average blade pitch angle, the angle
between the blade surface and the rotor plane (<code class="reqn">\gamma</code>), in radians.</p>
</td></tr>
<tr><td><code id="get_pcoll_grid_+3A_flight_type">flight_type</code></td>
<td>
<p>A character string, either 'flapping' or 'gliding',
indicating the species' characteristic flight type.</p>
</td></tr>
<tr><td><code id="get_pcoll_grid_+3A_n_blades">n_blades</code></td>
<td>
<p>An integer, the number of blades in rotor (<code class="reqn">b</code>).</p>
</td></tr>
<tr><td><code id="get_pcoll_grid_+3A_flight_speed">flight_speed</code></td>
<td>
<p>Numeric value. The bird flying speed (<code class="reqn">v</code>), in
metres/sec.</p>
</td></tr>
<tr><td><code id="get_pcoll_grid_+3A_wing_span">wing_span</code></td>
<td>
<p>Numeric value. The wingspan of the bird (<code class="reqn">W</code>), in
metres.</p>
</td></tr>
<tr><td><code id="get_pcoll_grid_+3A_body_lt">body_lt</code></td>
<td>
<p>Numeric value. The length of the bird (<code class="reqn">L</code>), in metres.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Methodology and assumptions underpinning <code>get_pcoll_grid</code> are
described in section &quot;Extended Approach Taking Account Of Flight Heights&quot; of
<a href="https://www.bto.org/sites/default/files/u28/downloads/Projects/Final_Report_SOSS02_Band1ModelGuidance.pdf">Band (2012)</a>. Note that collision risk calculations are based on equation (3)
in &quot;Stage C&quot; section, but using (X, Y) coordinates to reference transit
points instead of the equivalent (r, phi) coordinates.
</p>


<h3>Value</h3>

<p>a matrix. The probability of collisions at different flight height bands
</p>


<h3>See Also</h3>

<p><a href="#topic+generate_rotor_grids">generate_rotor_grids</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  rotor_grids &lt;- generate_rotor_grids(yinc = 0.05, xinc = 0.05, chord_prof_5MW)

  get_pcoll_grid(
    rotor_grids = rotor_grids,
    direction = 1,
    rotor_radius = 120,
    blade_width = 5,
    rotor_speed = 15,
    blade_pitch = 15,
    flight_type = "flapping",
    n_blades = 3,
    flight_speed = 13.1,
    wing_span = 1.01,
    body_lt = 0.85)

</code></pre>

<hr>
<h2 id='get_phi_grid'>Grid with angles between points <code class="reqn">(x, y)</code> and the rotor's vertical axis</h2><span id='topic+get_phi_grid'></span>

<h3>Description</h3>

<p>Given grids of vertical and horizontal distances from rotor axes
at points <code class="reqn">(x, y)</code> inside the rotor circle, <code>get_phi_grid</code>
calculates the associated radial angles, relative to the rotor vertical axis.
</p>
<p>Returned grid represents the left-half of the rotor's circle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_phi_grid(x_grid, y_grid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_phi_grid_+3A_x_grid">x_grid</code></td>
<td>
<p>A 2D array, with horizontal distances <code class="reqn">x</code> from the rotor's
vertical axis, expressed as the proportion of rotor radius, for the
left-half of the rotor circle area.</p>
</td></tr>
<tr><td><code id="get_phi_grid_+3A_y_grid">y_grid</code></td>
<td>
<p>A 2D array, with vertical distances (<code class="reqn">y</code> from the rotor's
horizontal axis, expressed as the proportion of rotor radius, for the
left-half of the rotor circle area.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 2D array, giving a grid of angles (in radians) between points
<code class="reqn">(x, y)</code> inside the rotor circle and the rotor center, for the
left-half of the rotor circle area.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_x_grid">get_x_grid()</a></code>, <code><a href="#topic+get_y_grid">get_y_grid()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> x_grid &lt;- get_x_grid(yinc=0.05, xinc=0.05)
 y_grid &lt;- get_y_grid(x_grid,yinc=0.05)
 get_phi_grid(x_grid,y_grid)
</code></pre>

<hr>
<h2 id='get_prop_crh_fhd'>Calculate the total proportion of bird flights at collision risk based
on a flight height distribution</h2><span id='topic+get_prop_crh_fhd'></span>

<h3>Description</h3>

<p>Calculate the expected proportion of bird flights at collision risk
height (i.e. at rotor height, between bottom and top of the rotor) based on the
bird's flight height distribution  (<code class="reqn">Q'_{2R}</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_prop_crh_fhd(d_y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_prop_crh_fhd_+3A_d_y">d_y</code></td>
<td>
<p>Numeric vector with the proportion of birds at height bands across the rotor
disc</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The total proportion of birds at collision risk height derived from a flight
height distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'> gen_fhd_dat &lt;- Johnston_Flight_heights_SOSS %&gt;%
      dplyr::filter(variable=="Gannet.est") %&gt;%
      dplyr::select(height,prop)

 gen_fhd &lt;- gen_fhd_dat$prop

 d_y &lt;-
    get_fhd_rotor(
      hub_height = 150,
      fhd = gen_fhd,
      rotor_radius = 120,
      tidal_offset = 2.5,
      yinc = 0.05)

 prop_chr_fhd &lt;- get_prop_crh_fhd(d_y)

</code></pre>

<hr>
<h2 id='get_risk_y'>Single transit collision risk along the chord of the rotor at height band
<code class="reqn">y</code></h2><span id='topic+get_risk_y'></span>

<h3>Description</h3>

<p>Calculates the single transit collision risk/probability along the horizontal
chord of the rotor at height <code class="reqn">y</code> via numerical integration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_risk_y(x_at_y, pcoll_doty)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_risk_y_+3A_x_at_y">x_at_y</code></td>
<td>
<p>a vector, sequence of horizontal distances from rotor's
vertical axis to points <code class="reqn">x</code> along half of the rotor circle, expressed
as the proportion of rotor radius, at height band <code class="reqn">y</code></p>
</td></tr>
<tr><td><code id="get_risk_y_+3A_pcoll_doty">pcoll_doty</code></td>
<td>
<p>a vector, the single transit collision risk at horizontal
distances <code class="reqn">x</code>, at height band <code class="reqn">y</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value, the single transit collision risk along the whole
horizontal chord of the rotor circle at height band <code class="reqn">y</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_x_grid">get_x_grid()</a></code>, <code><a href="#topic+get_pcoll_grid">get_pcoll_grid()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  rotor_grids &lt;- generate_rotor_grids(yinc = 0.05, xinc = 0.05, chord_prof_5MW)

  y_lt &lt;- dim(rotor_grids$r_grid)[1]

  pcollxy_grid_up &lt;- get_pcoll_grid(
    rotor_grids = rotor_grids,
    direction = 1,
    rotor_radius = 120,
    blade_width = 5,
    rotor_speed = 15,
    blade_pitch = 15,
    flight_type = "flapping",
    n_blades = 3,
    flight_speed = 13.1,
    wing_span = 1.01,
    body_lt = 0.85)

    risk_up &lt;- rep(NA, y_lt)
    for(i in 1:y_lt){
      risk_up[i] &lt;- get_risk_y(rotor_grids$x_grid[i, ], pcollxy_grid_up[i, ])
    }
</code></pre>

<hr>
<h2 id='get_x_grid'>Grid of horizontal distances from points in the rotor circle to its vertical
axis</h2><span id='topic+get_x_grid'></span>

<h3>Description</h3>

<p>Taking the center of the rotor circle as the origin,
<code>get_x_grid</code> generates a grid containing horizontal distances <code class="reqn">x</code>
(by <code>xinc</code> increments) from the y-axis up to the outer edge of the
rotor circle, at equidistant height bands <code class="reqn">y</code> (by <code>yinc</code>
increments) between minimum and maximum rotor height.
</p>
<p>Distances are expressed as proportion of rotor radius (i.e. <code class="reqn">x</code> is
dimensionless).
</p>
<p>Returned grid represents the left-half of the rotor's circle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_x_grid(xinc = 0.05, yinc = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_x_grid_+3A_xinc">xinc</code>, <code id="get_x_grid_+3A_yinc">yinc</code></td>
<td>
<p>numeric values, the grid increments along the y-axis and
x-axis (i.e. grid cell dimensions)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 2D array giving a grid of horizontal distances <code class="reqn">x</code> from rotor's
vertical axis, expressed as the proportion of rotor radius (i.e. <code class="reqn">[0,
  1]</code>), for the left-half of the rotor circle area.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_x_grid(xinc=0.05,yinc=0.05)

</code></pre>

<hr>
<h2 id='get_y_grid'>Grid of vertical distances from points in the rotor circle to its horizontal
axis</h2><span id='topic+get_y_grid'></span>

<h3>Description</h3>

<p>Taking the center of the rotor circle as the origin,
<code>get_y_grid</code> generates a grid of vertical distances <code class="reqn">y</code> (by
<code>yinc</code> increments) from the x-axis to the outer edge of the rotor
circle, across width intervals <code class="reqn">x</code> (by <code>xinc</code> increments) between
the center and maximum rotor width.
</p>
<p>Returned grid represents the left-half of the rotor's circle.
</p>
<p>Distances are expressed as proportion of rotor radius (i.e. <code class="reqn">y</code> is
dimensionless).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_y_grid(x_grid, yinc = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_y_grid_+3A_x_grid">x_grid</code></td>
<td>
<p>A 2D array, with horizontal distances from the rotor's vertical axis,
expressed as the proportion of rotor radius, for the left-half of the
rotor circle area.</p>
</td></tr>
<tr><td><code id="get_y_grid_+3A_yinc">yinc</code></td>
<td>
<p>a numeric value, the grid increment along the y-axis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>2D array giving a grid of vertical distances <code class="reqn">y</code> from the rotor's
horizontal axis, expressed as the proportion of rotor radius, for
the left-half of the rotor circle area. Negative values represent distances
from the bottom half of the rotor circle.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> x_grid &lt;- get_x_grid(yinc=0.05, xinc=0.05)
 get_y_grid(x_grid,yinc=0.05)

</code></pre>

<hr>
<h2 id='Johnston_Flight_heights_SOSS'>Summarized flight height profiles from Johnston et al (2014)</h2><span id='topic+Johnston_Flight_heights_SOSS'></span>

<h3>Description</h3>

<p>A dataframe containing flight height profiles for all species in Johnston
et al. (2014). Values are expressed as the proportion
of birds in 1 metre height intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Johnston_Flight_heights_SOSS
</code></pre>


<h3>Format</h3>

<p>A data frame object with 3 columns containing the maximum likelihood,
the median, and Upper/Lower confidence limits of flight height distributions.
Flight height bands go from 1 - 300m ASL.
</p>

<dl>
<dt>height</dt><dd><p>Height above sea level, in metres. First element represents the
0-1 meters height band, and height interval is 1 metre.</p>
</dd>
<dt>variable</dt><dd><p>The species name and variable from Johnston et al 2014 estimates.
E.G., ArcticSkua.est is the maximum likelihood estimate from  those models.
.est = maximum likelihood, .lcl and .ucl are the lower and upper 95% CLs, and
.med is the median estimate.</p>
</dd>
<dt>prop</dt><dd><p>The proportion of birds within the 1m flight height bands.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.bto.org/our-science/wetland-and-marine/soss/projects">https://www.bto.org/our-science/wetland-and-marine/soss/projects</a>
</p>

<hr>
<h2 id='mig_stoch_crm'>Stochastic migration collision risk model</h2><span id='topic+mig_stoch_crm'></span>

<h3>Description</h3>

<p>Run migration stochastic collision risk model for a single species and one turbine scenario
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mig_stoch_crm(
  wing_span_pars,
  flt_speed_pars,
  body_lt_pars,
  prop_crh_pars,
  avoid_bsc_pars,
  n_turbines,
  n_blades = 3,
  rtn_speed_pars,
  bld_pitch_pars,
  rtr_radius_pars,
  bld_width_pars,
  wf_width,
  wf_latitude,
  flight_type,
  prop_upwind = 0.5,
  popn_estim_pars,
  season_specs,
  chord_profile = chord_prof_5MW,
  trb_wind_avbl,
  trb_downtime_pars,
  n_iter = 10,
  LargeArrayCorrection = TRUE,
  log_file = NULL,
  seed = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mig_stoch_crm_+3A_wing_span_pars">wing_span_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the species wingspan, in metres. Assumed
to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_flt_speed_pars">flt_speed_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the species flying speed, in metres/sec.
Assumed to follow a Truncated Normal with lower bound at 0 (<em>tnorm-lw0</em>).</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_body_lt_pars">body_lt_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>, the
mean and standard deviation of the species body length, in metres. Assumed
to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_prop_crh_pars">prop_crh_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>.
The mean and standard deviation of the proportion of flights at
collision risk height.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_avoid_bsc_pars">avoid_bsc_pars</code></td>
<td>
<p>Single row data frame with columns
<code>mean</code> and <code>sd</code>, the mean and standard deviation of the species avoidance
rate to be used. Avoidance rate expresses the probability that a bird
flying on a collision course with a turbine will take evading action
to avoid collision, and it is assumed to follow a Beta distribution.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_n_turbines">n_turbines</code></td>
<td>
<p>An integer. The number of turbines expected to be installed</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_n_blades">n_blades</code></td>
<td>
<p>An integer. The number of blades per turbine (defaults to 3)</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_rtn_speed_pars">rtn_speed_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the rotation speed.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_bld_pitch_pars">bld_pitch_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the blade pitch angle,
i.e. the angle between the blade surface and the rotor plane,
in degrees. Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_rtr_radius_pars">rtr_radius_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the radius of the rotor, in metres.
Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_bld_width_pars">bld_width_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the maximum blade width, in metres.
Assumed to be <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_wf_width">wf_width</code></td>
<td>
<p>Numeric value, the approximate longitudinal width of the
wind farm, in kilometres (<code class="reqn">w</code>).</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_wf_latitude">wf_latitude</code></td>
<td>
<p>A decimal value. The latitude of the centroid of the
windfarm, in degrees.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_flight_type">flight_type</code></td>
<td>
<p>A character. Either &quot;flying&quot; or &quot;gliding&quot; representing
the type of flight most commonly used by the species</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_prop_upwind">prop_upwind</code></td>
<td>
<p>Numeric value between 0-1 giving the proportion of
flights upwind - defaults to 0.5.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_popn_estim_pars">popn_estim_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>.
The population estimate of the species expected to fly through the wind farm
area.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_season_specs">season_specs</code></td>
<td>
<p>A data frame
defining the seasons for aggregating over collision estimates. It must
comprise the following columns:
</p>

<ul>
<li> <p><code>season_id</code>, (unique) season identifier,
</p>
</li>
<li> <p><code>start_month</code>, name of the season's first month,
</p>
</li>
<li> <p><code>end_month</code>, name of the season's last month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_chord_profile">chord_profile</code></td>
<td>
<p>A data frame with the chord taper profile of the rotor
blade. It must contain the columns:
</p>

<ul>
<li> <p><code>pp_radius</code>, equidistant intervals of radius at bird passage point,
as a proportion of <code>rotor_radius</code>, within the range <code class="reqn">[0, 1]</code>.
</p>
</li>
<li> <p><code>chord</code>, the chord width at <code>pp_radius</code>, as a proportion of <code>blade_width</code>.
Defaults to a generic profile for a typical modern 5MW turbine. See
<code><a href="#topic+chord_prof_5MW">chord_prof_5MW()</a></code> for details.
</p>
</li></ul>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_trb_wind_avbl">trb_wind_avbl</code></td>
<td>
<p>A data frame with the monthly estimates of operational
wind availability. It must contain the columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>pctg</code>, the percentage of time wind conditions allow for turbine operation
per month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_trb_downtime_pars">trb_downtime_pars</code></td>
<td>
<p>A data frame with monthly estimates of maintenance
downtime, assumed to follow a <em>tnorm-lw0</em> distribution. It
must contain the following columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>mean</code>, numeric, the mean percentage of time in each month when turbines
are not operating due to maintenance,
</p>
</li>
<li> <p><code>sd</code>, the standard deviation of monthly maintenance downtime.
</p>
</li></ul>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_n_iter">n_iter</code></td>
<td>
<p>An integer &gt; 0. The number of iterations for the model simulation.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_largearraycorrection">LargeArrayCorrection</code></td>
<td>
<p>A boolean. Should the large array correction be calculated</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_log_file">log_file</code></td>
<td>
<p>Path to log file to store session info and main model run
options. If set to NULL (default value), log file is not created.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_seed">seed</code></td>
<td>
<p>Integer, the random seed for <a href="base.html#topic+Random">random number generation</a>, for analysis reproducibility.</p>
</td></tr>
<tr><td><code id="mig_stoch_crm_+3A_verbose">verbose</code></td>
<td>
<p>boolean. TRUE for a verbose output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is an adaption of code from Masden(2015) used for estimating
the collision risk of seabirds in offshore windfarm sites and is a further
adaptation from Band(2012). It is a further adaptation of the stoch_crm function.
</p>
<p>The collision risk model evaluates risk for each defined migratory period where
flux rate is simply the number of birds travelling through the windfarm.
</p>
<p>Changes in relation to previous top-line function <code>stoch_crm</code>
</p>

<ul>
<li><p> function will run only option 1 for migratory species
</p>
</li></ul>



<h3>Value</h3>

<p>Estimates of number of collisions per migratory season for the n
number of iterations specified
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ------------------------------------------------------
# Run with arbitrary parameter values, for illustration
# ------------------------------------------------------
season_specs &lt;- data.frame(
  season_id = c("PrBMigration", "PoBMigration","OMigration"),
  start_month = c("Mar", "May", "Oct"), end_month = c("Apr", "Sep", "Feb")
)

# wind availability
windavb &lt;- data.frame(
  month = month.abb,
  pctg = runif(12, 85, 98)
)
head(windavb)

# maintenance downtime
dwntm &lt;- data.frame(
  month = month.abb,
  mean = runif(12, 6, 10),
  sd = rep(2, 12))
head(dwntm)


mig_stoch_crm(
  # Wing span in m,
  wing_span_pars = data.frame(mean = 1.08, sd = 0.04),
  # Flight speed in m/s
  flt_speed_pars = data.frame(mean = 7.26, sd = 1.5),
  # Body length in m,
  body_lt_pars = data.frame(mean = 0.39, sd = 0.005),
  # Proportion of birds at CRH
  prop_crh_pars = data.frame(mean = 0.06, sd = 0.009),
  # avoidance rate
  avoid_bsc_pars = data.frame(mean = 0.99, sd = 0.001),
  n_turbines = 150,
  n_blades = 3,
  # rotation speed in m/s of turbine blades
  rtn_speed_pars = data.frame(mean = 13.1, sd = 4),
  # pitch in degrees of turbine blades
  bld_pitch_pars = data.frame(mean = 3, sd = 0.3),
  # sd = 0, rotor radius is fixed
  rtr_radius_pars = data.frame(mean = 80, sd = 0),
  # sd = 0, blade width is fixed
  bld_width_pars = data.frame(mean = 8, sd = 0),
  wf_width = 100,
  wf_latitude = 54.1,
  prop_upwind = 0.5,
  flight_type = "flapping",
  # population flying through windfarm,
  popn_estim_pars = data.frame(mean = 21584, sd = 2023),
  season_specs = season_specs,
  chord_profile = chord_prof_5MW,
  trb_wind_avbl = windavb,
  trb_downtime_pars = dwntm,
  n_iter = 1000,
  LargeArrayCorrection = TRUE,
  log_file = NULL,
  seed = 1234,
  verbose = TRUE)
</code></pre>

<hr>
<h2 id='rbeta_dmp'>Customised sampling functions for the Beta distributions</h2><span id='topic+rbeta_dmp'></span>

<h3>Description</h3>

<p>generate random samples from a beta distribution, parameterized as mean and sd, and returning NAs if conditions are not met
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbeta_dmp(n, p, sd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rbeta_dmp_+3A_n">n</code></td>
<td>
<p>An integer value. The number of samples to generate</p>
</td></tr>
<tr><td><code id="rbeta_dmp_+3A_p">p</code></td>
<td>
<p>A decimal value. The value used to calculate parameters for the beta distribution</p>
</td></tr>
<tr><td><code id="rbeta_dmp_+3A_sd">sd</code></td>
<td>
<p>A decimal value. The standard deviation of the beta distribution to simulate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of samples values from the beta distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    rbeta_dmp(n=100,p=0.9,sd=0.01)
</code></pre>

<hr>
<h2 id='rotor_grids_test'>Sample rotor grids for generated_rotor_grids unit test</h2><span id='topic+rotor_grids_test'></span>

<h3>Description</h3>

<p>Sample rotor grids for generated_rotor_grids unit test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rotor_grids_test
</code></pre>


<h3>Format</h3>

<p>list of data frames
</p>

<hr>
<h2 id='rtnorm_dmp'>Customised sampling of Truncated Normal distribution</h2><span id='topic+rtnorm_dmp'></span>

<h3>Description</h3>

<p>Wrapper of the msm::rtnorm() function, improving on outputs management and
user feedback on edge cases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rtnorm_dmp(n, mean = 0, sd = 1, lower = -Inf, upper = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rtnorm_dmp_+3A_n">n</code></td>
<td>
<p>An integer value. The number of samples to generate</p>
</td></tr>
<tr><td><code id="rtnorm_dmp_+3A_mean">mean</code></td>
<td>
<p>A decimal value. The mean for the truncated normal distribution</p>
</td></tr>
<tr><td><code id="rtnorm_dmp_+3A_sd">sd</code></td>
<td>
<p>A decimal value. The standard deviation of the distribution to simulate</p>
</td></tr>
<tr><td><code id="rtnorm_dmp_+3A_lower">lower</code></td>
<td>
<p>A decimal value. The lower limit for the distribution</p>
</td></tr>
<tr><td><code id="rtnorm_dmp_+3A_upper">upper</code></td>
<td>
<p>A decimal value. The upper limit for the distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of samples values from the truncated normal distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rtnorm_dmp(n=10,mean=0.4,sd=0.2)


</code></pre>

<hr>
<h2 id='sample_parameters'>Parameter sampling whiz</h2><span id='topic+sample_parameters'></span>

<h3>Description</h3>

<p>Generates the random samples of all the stochastic CRM parameters. For internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_parameters(
  model_options,
  mod_mths,
  n_iter = 10,
  flt_speed_pars,
  body_lt_pars,
  wing_span_pars,
  avoid_bsc_pars,
  avoid_ext_pars,
  noct_act_pars,
  prop_crh_pars,
  bird_dens_opt = "tnorm",
  bird_dens_dt,
  gen_fhd_boots = NULL,
  site_fhd_boots = NULL,
  rtr_radius_pars,
  air_gap_pars,
  bld_width_pars,
  rtn_pitch_opt = "probDist",
  bld_pitch_pars,
  rtn_speed_pars,
  windspd_pars,
  rtn_pitch_windspd_dt,
  trb_wind_avbl,
  trb_downtime_pars,
  lrg_arr_corr
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_parameters_+3A_model_options">model_options</code></td>
<td>
<p>Character vector, the model options for calculating collision
risk (see <strong>Details</strong> section below).</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_mod_mths">mod_mths</code></td>
<td>
<p>character vector, the names of months under modelling</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_n_iter">n_iter</code></td>
<td>
<p>An integer. The number of iterations for the model simulation.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_flt_speed_pars">flt_speed_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the species flying speed, in metres/sec.
Assumed to follow a Truncated Normal with lower bound at 0 (<em>tnorm-lw0</em>).</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_body_lt_pars">body_lt_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>, the
mean and standard deviation of the species body length, in metres. Assumed
to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_wing_span_pars">wing_span_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the species wingspan, in metres. Assumed
to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_avoid_bsc_pars">avoid_bsc_pars</code>, <code id="sample_parameters_+3A_avoid_ext_pars">avoid_ext_pars</code></td>
<td>
<p>Single row data frames with columns
<code>mean</code> and <code>sd</code>, the mean and standard deviation of the species avoidance
rate to be used in the basic model (Options 1 and 2) and extended model
(Options 3 and 4) calculations (see <strong>Details</strong> section). Avoidance rate
expresses the probability that a bird flying on a collision course with a
turbine will take evading action to avoid collision, and it is assumed to
follow a Beta distribution.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_noct_act_pars">noct_act_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
The mean and standard deviation of the species nocturnal flight activity
level, expressed as a proportion of daytime activity levels, and assumed to
be Beta distributed.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_prop_crh_pars">prop_crh_pars</code></td>
<td>
<p>Required only for model Option 1, a single row data
frame with columns <code>mean</code> and <code>sd</code>. The mean and standard deviation of the
proportion of flights at collision risk height derived from site survey,
assumed to be Beta distributed.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_bird_dens_opt">bird_dens_opt</code></td>
<td>
<p>Option for specifying the random sampling mechanism for bird
densities:
</p>

<ul>
<li> <p><code>"tnorm"</code>: Sampling of density estimates from a <em>tnorm-lw0</em> distribution
(default value),
</p>
</li>
<li> <p><code>"resample"</code>: Re-sample draws of bird density estimates (e.g. bootstrap
samples),
</p>
</li>
<li> <p><code>"qtiles"</code>: Sampling from a set of quantile estimates of bird densities.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sample_parameters_+3A_bird_dens_dt">bird_dens_dt</code></td>
<td>
<p>A data frame with monthly estimates of bird density
within the windfarm footprint, expressed as the number of daytime in-flight
birds/km^2 per month. Data frame format requirements:
</p>

<ul>
<li><p> If <code>bird_dens_opt = "tnorm"</code>, <code>bird_dens_dt</code> must contain the following
columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>mean</code>, the mean number of birds in flight at any height per square
kilometre in each month,
</p>
</li>
<li> <p><code>sd</code>, idem, for standard deviation.
</p>
</li></ul>

</li>
<li><p> If <code>bird_dens_opt = "resample"</code>, <code>bird_dens_dt</code> columns must be named as
months (i.e. <code>Jan</code>, <code>Feb</code>, ...), each containing random samples of monthly
density estimates.
</p>
</li>
<li><p> If <code>bird_dens_opt = "qtiles"</code>, <code>bird_dens_dt</code> must comply with:
</p>

<ul>
<li><p> First column named as <code>p</code>, giving reference probabilities,
</p>
</li>
<li><p> Remaining columns named as months (i.e. <code>Jan</code>, <code>Feb</code>, ...), each
giving the quantile estimates of bird density in a given month, for the
reference probabilities in column <code>p</code>.
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="sample_parameters_+3A_gen_fhd_boots">gen_fhd_boots</code></td>
<td>
<p>Required only for model Options 2 and 3, a data frame
with bootstrap samples of flight height distributions (FHD) of the species
derived from general (country/regional level) data. FHD provides relative
frequency distribution of bird flights at 1-+
-metre height bands, starting
from sea surface. The first column must be named as <code>height</code>,
expressing the lower bound of the height band (thus it's first element must
be 0). Each remaining column should provide a bootstrap sample of the
proportion of bird flights at each height band, with no column naming
requirements.
</p>
<p><strong>NOTE:</strong> <a href="#topic+generic_fhd_bootstraps">generic_fhd_bootstraps</a> is a list object with generic FHD
bootstrap estimates for 25 seabird species from Johnson et al
(2014) <a href="https://doi.org/10.1111/1365-2664.12191">doi:10.1111/1365-2664.12191</a>
(see usage in Example Section below).</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_site_fhd_boots">site_fhd_boots</code></td>
<td>
<p>Required only for model Option 4, a data frame similar
to <code>gen_fhd_boots</code>, but for FHD estimates derived from site-specific
data.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_rtr_radius_pars">rtr_radius_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the radius of the rotor, in metres.
Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_air_gap_pars">air_gap_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>, the
mean and standard deviation of the tip clearance gap, in metres, i.e. the
distance between the minimum rotor tip height and the highest astronomical
tide (HAT). Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_bld_width_pars">bld_width_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the maximum blade width, in metres.
Assumed to be <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_rtn_pitch_opt">rtn_pitch_opt</code></td>
<td>
<p>a character string, the option for specifying
the sampling mechanism for rotation speed and blade pitch:
</p>

<ul>
<li> <p><code>"probDist"</code>: sample rotation speed and blade pitch values from a
<em>tnorm-lw0</em> distribution (default value).
</p>
</li>
<li> <p><code>"windSpeedReltn"</code>: generate rotation speed and blade pitch values as a
function of wind speed intensity.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sample_parameters_+3A_bld_pitch_pars">bld_pitch_pars</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "probDist"</code>, a single
row data frame with columns <code>mean</code> and <code>sd</code>, the mean and standard
deviation of the blade pitch angle, i.e. the angle between the blade
surface and the rotor plane, in degrees. Assumed to follow a
<em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_rtn_speed_pars">rtn_speed_pars</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "probDist"</code>, a
single row data frame with columns <code>mean</code> and <code>sd</code>, the mean and standard
deviation of the operational rotation speed, in revolutions per minute.
Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_windspd_pars">windspd_pars</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "windSpeedReltn"</code>,
a single row data frame with columns <code>mean</code> and <code>sd</code>, the mean and the
standard deviation of wind speed at the windfarm site, in metres/sec.
Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="sample_parameters_+3A_rtn_pitch_windspd_dt">rtn_pitch_windspd_dt</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "windSpeedReltn"</code>,
a data frame giving the relationship between wind speed, rotation speed
and blade pitch values. It must contain the columns:
</p>

<ul>
<li> <p><code>wind_speed</code>, wind speed in m/s,
</p>
</li>
<li> <p><code>rtn_speed</code>, rotation speed in rpm,
</p>
</li>
<li> <p><code>bld_pitch</code>, blade pitch values in degrees.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sample_parameters_+3A_trb_wind_avbl">trb_wind_avbl</code></td>
<td>
<p>A data frame with the monthly estimates of operational
wind availability. It must contain the columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>pctg</code>, the percentage of time wind conditions allow for turbine operation
per month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sample_parameters_+3A_trb_downtime_pars">trb_downtime_pars</code></td>
<td>
<p>A data frame with monthly estimates of maintenance
downtime, assumed to follow a <em>tnorm-lw0</em> distribution. It
must contain the following columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>mean</code>, numeric, the mean percentage of time in each month when turbines
are not operating due to maintenance,
</p>
</li>
<li> <p><code>sd</code>, the standard deviation of monthly maintenance downtime.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sample_parameters_+3A_lrg_arr_corr">lrg_arr_corr</code></td>
<td>
<p>Boolean value. If TRUE, the large array correction will
be applied. This is a correction factor to account for the decay in
bird density at later rows in wind farms with a large array of turbines.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Collision risk can be calculated under 4 options, specified by <code>model_options</code>:
</p>

<ul>
<li> <p><strong>Option 1</strong> - Basic model with proportion at
collision risk height derived from site survey (<code>prop_crh_surv</code>).
</p>
</li>
<li> <p><strong>Option 2</strong> - Basic model with proportion
at collision risk height derived from a generic flight height distribution
(<code>gen_fhd</code>).
</p>
</li>
<li> <p><strong>Option 3</strong> - Extended model using a
generic flight height distribution (<code>gen_fhd</code>).
</p>
</li>
<li> <p><strong>Option 4</strong> - Extended model using a
site-specific flight height distribution (<code>site_fhd</code>).
</p>
</li></ul>

<p>Where,
</p>

<ul>
<li><p> Basic model - assumes a uniform distribution of bird flights at
collision risk height (i.e. above the minimum and below the maximum height
of the rotor blade).
</p>
</li>
<li><p> Extended model - takes into account the distribution of bird flight
heights at collision risk height.
</p>
</li></ul>



<h3>Value</h3>

<p>A list object with each element comprising sampled values of given CRM parameter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  bird_dens_dt &lt;- data.frame(
    month = month.abb,
    mean = runif(12, 0.8, 1.5),
    sd = runif(12, 0.2, 0.3)
  )

 # wind availability
  trb_wind_avbl &lt;- data.frame(
    month = month.abb,
    pctg = runif(12, 85, 98)
  )

  # maintenance downtime
  trb_downtime_pars &lt;- data.frame(
    month = month.abb,
    mean = runif(12, 6, 10),
    sd = rep(2, 12))

  # Wind speed relationships
  wind_rtn_ptch &lt;- data.frame(
    wind_speed = seq_len(30),
    rtn_speed = 10/(30:1),
    bld_pitch = c(rep(90, 4), rep(0, 8), 5:22)
    )


  bird_dens_opt &lt;- "tnorm"
  ### extract and standardize month format from monthly data sets
  b_dens_mth &lt;- switch (bird_dens_opt,
                        tnorm = bird_dens_dt$month,
                        resample = names(bird_dens_dt),
                        qtiles = names(bird_dens_dt)[names(bird_dens_dt) != "p"]
  ) %&gt;% format_months()
  dwntm_mth &lt;- format_months(trb_downtime_pars$month)
  windav_mth &lt;- format_months(trb_wind_avbl$month)
  ### Set months to model: only those in common amongst monthly data sets
  mod_mths &lt;- Reduce(intersect, list(b_dens_mth, dwntm_mth, windav_mth))
  ### Order chronologically
  mod_mths &lt;- mod_mths[order(match(mod_mths, month.abb))]

  param_draws &lt;- sample_parameters(
    model_options = c(1,2,3),
    n_iter = 10,
    mod_mths = mod_mths,
    flt_speed_pars = data.frame(mean=7.26,sd=1.5),
    body_lt_pars = data.frame(mean=0.39,sd=0.005),
    wing_span_pars = data.frame(mean=1.08,sd=0.04),
    avoid_bsc_pars = data.frame(mean=0.99,sd=0.001),
    avoid_ext_pars = data.frame(mean=0.96,sd=0.002),
    noct_act_pars = data.frame(mean=0.033,sd=0.005),
    prop_crh_pars = data.frame(mean=0.06,sd=0.009),
    bird_dens_opt = "tnorm",
    bird_dens_dt = bird_dens_dt,
    gen_fhd_boots = generic_fhd_bootstraps[[1]],
    site_fhd_boots = NULL,
    rtr_radius_pars = data.frame(mean=80,sd=0),
    air_gap_pars = data.frame(mean=36,sd=0),
    bld_width_pars = data.frame(mean=8,sd=0),
    rtn_pitch_opt = "windSpeedReltn",
    bld_pitch_pars = NULL,
    rtn_speed_pars = NULL,
    windspd_pars = data.frame(mean=7.74,sd=3),
    rtn_pitch_windspd_dt = wind_rtn_ptch,
    trb_wind_avbl = trb_wind_avbl,
    trb_downtime_pars = trb_downtime_pars,
    lrg_arr_corr = TRUE
    )

</code></pre>

<hr>
<h2 id='sample_qtls'>Generate random draws based on empirical c.d.f.</h2><span id='topic+sample_qtls'></span>

<h3>Description</h3>

<p>Generate random draws from a set of quantiles, based on the empirical
cumulative density function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_qtls(n, probs, qtls)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_qtls_+3A_n">n</code></td>
<td>
<p>integer, the number of draws to generate</p>
</td></tr>
<tr><td><code id="sample_qtls_+3A_probs">probs</code></td>
<td>
<p>numeric vector, the probabilities</p>
</td></tr>
<tr><td><code id="sample_qtls_+3A_qtls">qtls</code></td>
<td>
<p>numeric vector, the quantiles for the probabilities
specified in <code>probs</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the Inverse Transform Sampling technique, by sampling
random probabilities from a uniform distribution and interpolate (cubic)
the count samples from the percentiles provided by the user (taken as the
empirical cumulative density function)
</p>


<h3>Value</h3>

<p>a numeric vector, with random draws of the approximated distribution
underpinning the provided quantiles
</p>


<h3>Examples</h3>

<pre><code class='language-R'> sample_qtls(10,c(0.1,0.2,0.3),qtls=c(0.05,0.1,0.95))
</code></pre>

<hr>
<h2 id='sample_turbine_mCRM'>Sampling function for a single turbine in the mCRM</h2><span id='topic+sample_turbine_mCRM'></span>

<h3>Description</h3>

<p>Samples and aggregates appropriate data for a single wind turbine
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_turbine_mCRM(
  rtn_speed_pars,
  bld_pitch_pars,
  rtr_radius_pars,
  bld_width_pars,
  season_specs,
  n_iter = 10,
  trb_wind_avbl,
  trb_downtime_pars
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_turbine_mCRM_+3A_rtn_speed_pars">rtn_speed_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the rotation speed.</p>
</td></tr>
<tr><td><code id="sample_turbine_mCRM_+3A_bld_pitch_pars">bld_pitch_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the blade pitch angle,
i.e. the angle between the blade surface and the rotor plane,
in degrees. Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="sample_turbine_mCRM_+3A_rtr_radius_pars">rtr_radius_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the radius of the rotor, in metres.
Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="sample_turbine_mCRM_+3A_bld_width_pars">bld_width_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the maximum blade width, in metres.
Assumed to be <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="sample_turbine_mCRM_+3A_season_specs">season_specs</code></td>
<td>
<p>A data frame
defining the seasons for aggregating over collision estimates. It must
comprise the following columns:
</p>

<ul>
<li> <p><code>season_id</code>, (unique) season identifier,
</p>
</li>
<li> <p><code>start_month</code>, name of the season's first month,
</p>
</li>
<li> <p><code>end_month</code>, name of the season's last month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sample_turbine_mCRM_+3A_n_iter">n_iter</code></td>
<td>
<p>An integer value. The number of samples to generate</p>
</td></tr>
<tr><td><code id="sample_turbine_mCRM_+3A_trb_wind_avbl">trb_wind_avbl</code></td>
<td>
<p>A data frame with the monthly estimates of operational
wind availability. It must contain the columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>pctg</code>, the percentage of time wind conditions allow for turbine operation
per month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sample_turbine_mCRM_+3A_trb_downtime_pars">trb_downtime_pars</code></td>
<td>
<p>A data frame with monthly estimates of maintenance
downtime, assumed to follow a <em>tnorm-lw0</em> distribution. It
must contain the following columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>mean</code>, numeric, the mean percentage of time in each month when turbines
are not operating due to maintenance,
</p>
</li>
<li> <p><code>sd</code>, the standard deviation of monthly maintenance downtime.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of all the information sampled for the turbine with nrow = n_iter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>season_specs &lt;- data.frame(
  season_id = c("PrBMigration", "PoBMigration","OMigration"),
  start_month = c("Mar", "May", "Oct"), end_month = c("Apr", "Sep", "Feb")
  )

  windavb &lt;- data.frame(
    month = month.abb,
    pctg = runif(12, 85, 98)
  )

  dwntm &lt;- data.frame(
    month = month.abb,
    mean = runif(12, 6, 10),
    sd = rep(2, 12))

  sample_turbine_mCRM(rtn_speed_pars = data.frame(mean = 13.1, sd = 4),
                      bld_pitch_pars = data.frame(mean = 3, sd = 0.3),
                      rtr_radius_pars = data.frame(mean = 80, sd = 0),
                      bld_width_pars = data.frame(mean = 8, sd = 0),
                      season_specs = season_specs,
                      n_iter = 10,
                      trb_wind_avbl = windavb,
                      trb_downtime_pars = dwntm)
</code></pre>

<hr>
<h2 id='sampler_hd'>Customised sampling function wrapper</h2><span id='topic+sampler_hd'></span>

<h3>Description</h3>

<p>Samples a dataset based on inputs for either the rtnorm, rbeta or 'rnorm' distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampler_hd(
  dat,
  mode = "rtnorm",
  n = NULL,
  mean = NULL,
  sd = NULL,
  lower = 0,
  upper = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampler_hd_+3A_dat">dat</code></td>
<td>
<p>= A decimal value. The SD value to test (from the UI) - if not available in the UI, then do not create a distribution</p>
</td></tr>
<tr><td><code id="sampler_hd_+3A_mode">mode</code></td>
<td>
<p>= A string.  Either 'rtnorm', 'rbeta' or 'rnorm' to determine which distribution to generate</p>
</td></tr>
<tr><td><code id="sampler_hd_+3A_n">n</code></td>
<td>
<p>An integer value. The number of samples to generate</p>
</td></tr>
<tr><td><code id="sampler_hd_+3A_mean">mean</code></td>
<td>
<p>A decimal value. The mean for the truncated normal distribution</p>
</td></tr>
<tr><td><code id="sampler_hd_+3A_sd">sd</code></td>
<td>
<p>A decimal value. The standard deviation of the distribution to simulate</p>
</td></tr>
<tr><td><code id="sampler_hd_+3A_lower">lower</code></td>
<td>
<p>A decimal value. The lower limit for the distribution</p>
</td></tr>
<tr><td><code id="sampler_hd_+3A_upper">upper</code></td>
<td>
<p>A decimal value. The upper limit for the distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of samples values from the distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  sampler_hd(dat=0.1,
       mode='rtnorm',
       n=100,
       mean=9,
       sd=0.1)

</code></pre>

<hr>
<h2 id='seq_months'>Generate sequence of months</h2><span id='topic+seq_months'></span>

<h3>Description</h3>

<p>Generate sequence of months
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seq_months(start_month, end_month)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seq_months_+3A_start_month">start_month</code></td>
<td>
<p>character string, the three-letter name of the starting month.</p>
</td></tr>
<tr><td><code id="seq_months_+3A_end_month">end_month</code></td>
<td>
<p>character string, the three-letter name of the finishing month.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector. The list of months that falls in between two months
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   seq_months("Jan", "Apr")
</code></pre>

<hr>
<h2 id='stoch_crm'>Stochastic collision risk model for a single species and one wind farm scenario</h2><span id='topic+stoch_crm'></span>

<h3>Description</h3>

<p>Runs a Stochastic Collision Risk Model (SCRM) for estimating the number of
in-flight collisions with offshore windfarm turbines, for given species and
windfarm scenario. Core calculations follow the work developed by <a href="https://data.marine.gov.scot/dataset/developing-avian-collision-risk-model-incorporate-variability-and-uncertainty">Masden (2015)</a>.
See <strong>Background and Updates</strong> section below for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stoch_crm(
  model_options = c("1", "2", "3", "4"),
  n_iter = 1000,
  flt_speed_pars,
  body_lt_pars,
  wing_span_pars,
  avoid_bsc_pars = NULL,
  avoid_ext_pars = NULL,
  noct_act_pars,
  prop_crh_pars = NULL,
  bird_dens_opt = c("tnorm", "resample", "qtiles"),
  bird_dens_dt,
  flight_type,
  prop_upwind,
  gen_fhd_boots = NULL,
  site_fhd_boots = NULL,
  n_blades,
  air_gap_pars,
  rtr_radius_pars,
  bld_width_pars,
  bld_chord_prf = chord_prof_5MW,
  rtn_pitch_opt = c("probDist", "windSpeedReltn"),
  bld_pitch_pars = NULL,
  rtn_speed_pars = NULL,
  windspd_pars = NULL,
  rtn_pitch_windspd_dt = NULL,
  trb_wind_avbl,
  trb_downtime_pars,
  wf_n_trbs,
  wf_width,
  wf_latitude,
  tidal_offset,
  lrg_arr_corr = TRUE,
  xinc = 0.05,
  yinc = 0.05,
  out_format = c("draws", "summaries"),
  out_sampled_pars = FALSE,
  out_period = c("months", "seasons", "annum"),
  season_specs = NULL,
  verbose = TRUE,
  log_file = NULL,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stoch_crm_+3A_model_options">model_options</code></td>
<td>
<p>Character vector, the model options for calculating collision
risk (see <strong>Details</strong> section below).</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_n_iter">n_iter</code></td>
<td>
<p>An integer. The number of iterations for the model simulation.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_flt_speed_pars">flt_speed_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the species flying speed, in metres/sec.
Assumed to follow a Truncated Normal with lower bound at 0 (<em>tnorm-lw0</em>).</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_body_lt_pars">body_lt_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>, the
mean and standard deviation of the species body length, in metres. Assumed
to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_wing_span_pars">wing_span_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the species wingspan, in metres. Assumed
to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_avoid_bsc_pars">avoid_bsc_pars</code>, <code id="stoch_crm_+3A_avoid_ext_pars">avoid_ext_pars</code></td>
<td>
<p>Single row data frames with columns
<code>mean</code> and <code>sd</code>, the mean and standard deviation of the species avoidance
rate to be used in the basic model (Options 1 and 2) and extended model
(Options 3 and 4) calculations (see <strong>Details</strong> section). Avoidance rate
expresses the probability that a bird flying on a collision course with a
turbine will take evading action to avoid collision, and it is assumed to
follow a Beta distribution.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_noct_act_pars">noct_act_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
The mean and standard deviation of the species nocturnal flight activity
level, expressed as a proportion of daytime activity levels, and assumed to
be Beta distributed.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_prop_crh_pars">prop_crh_pars</code></td>
<td>
<p>Required only for model Option 1, a single row data
frame with columns <code>mean</code> and <code>sd</code>. The mean and standard deviation of the
proportion of flights at collision risk height derived from site survey,
assumed to be Beta distributed.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_bird_dens_opt">bird_dens_opt</code></td>
<td>
<p>Option for specifying the random sampling mechanism for bird
densities:
</p>

<ul>
<li> <p><code>"tnorm"</code>: Sampling of density estimates from a <em>tnorm-lw0</em> distribution
(default value),
</p>
</li>
<li> <p><code>"resample"</code>: Re-sample draws of bird density estimates (e.g. bootstrap
samples),
</p>
</li>
<li> <p><code>"qtiles"</code>: Sampling from a set of quantile estimates of bird densities.
</p>
</li></ul>
</td></tr>
<tr><td><code id="stoch_crm_+3A_bird_dens_dt">bird_dens_dt</code></td>
<td>
<p>A data frame with monthly estimates of bird density
within the windfarm footprint, expressed as the number of daytime in-flight
birds/km^2 per month. Data frame format requirements:
</p>

<ul>
<li><p> If <code>bird_dens_opt = "tnorm"</code>, <code>bird_dens_dt</code> must contain the following
columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>mean</code>, the mean number of birds in flight at any height per square
kilometre in each month,
</p>
</li>
<li> <p><code>sd</code>, idem, for standard deviation.
</p>
</li></ul>

</li>
<li><p> If <code>bird_dens_opt = "resample"</code>, <code>bird_dens_dt</code> columns must be named as
months (i.e. <code>Jan</code>, <code>Feb</code>, ...), each containing random samples of monthly
density estimates.
</p>
</li>
<li><p> If <code>bird_dens_opt = "qtiles"</code>, <code>bird_dens_dt</code> must comply with:
</p>

<ul>
<li><p> First column named as <code>p</code>, giving reference probabilities,
</p>
</li>
<li><p> Remaining columns named as months (i.e. <code>Jan</code>, <code>Feb</code>, ...), each
giving the quantile estimates of bird density in a given month, for the
reference probabilities in column <code>p</code>.
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="stoch_crm_+3A_flight_type">flight_type</code></td>
<td>
<p>A character string, either 'flapping' or 'gliding',
indicating the species' characteristic flight type.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_prop_upwind">prop_upwind</code></td>
<td>
<p>Numeric value between 0-1 giving the proportion of
flights upwind - defaults to 0.5.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_gen_fhd_boots">gen_fhd_boots</code></td>
<td>
<p>Required only for model Options 2 and 3, a data frame
with bootstrap samples of flight height distributions (FHD) of the species
derived from general (country/regional level) data. FHD provides relative
frequency distribution of bird flights at 1-+
-metre height bands, starting
from sea surface. The first column must be named as <code>height</code>,
expressing the lower bound of the height band (thus it's first element must
be 0). Each remaining column should provide a bootstrap sample of the
proportion of bird flights at each height band, with no column naming
requirements.
</p>
<p><strong>NOTE:</strong> <a href="#topic+generic_fhd_bootstraps">generic_fhd_bootstraps</a> is a list object with generic FHD
bootstrap estimates for 25 seabird species from Johnson et al
(2014) <a href="https://doi.org/10.1111/1365-2664.12191">doi:10.1111/1365-2664.12191</a>
(see usage in Example Section below).</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_site_fhd_boots">site_fhd_boots</code></td>
<td>
<p>Required only for model Option 4, a data frame similar
to <code>gen_fhd_boots</code>, but for FHD estimates derived from site-specific
data.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_n_blades">n_blades</code></td>
<td>
<p>An integer, the number of blades in rotor (<code class="reqn">b</code>).</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_air_gap_pars">air_gap_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>, the
mean and standard deviation of the tip clearance gap, in metres, i.e. the
distance between the minimum rotor tip height and the highest astronomical
tide (HAT). Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_rtr_radius_pars">rtr_radius_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the radius of the rotor, in metres.
Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_bld_width_pars">bld_width_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the maximum blade width, in metres.
Assumed to be <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_bld_chord_prf">bld_chord_prf</code></td>
<td>
<p>A data frame with the chord taper profile of the rotor
blade. It must contain the columns:
</p>

<ul>
<li> <p><code>pp_radius</code>, equidistant intervals of radius at bird passage point,
as a proportion of <code>rotor_radius</code>, within the range <code class="reqn">[0, 1]</code>.
</p>
</li>
<li> <p><code>chord</code>, the chord width at <code>pp_radius</code>, as a proportion of <code>blade_width</code>.
</p>
</li></ul>

<p>Defaults to a generic profile for a typical modern 5MW turbine. See
<code><a href="#topic+chord_prof_5MW">chord_prof_5MW()</a></code> for details.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_rtn_pitch_opt">rtn_pitch_opt</code></td>
<td>
<p>a character string, the option for specifying
the sampling mechanism for rotation speed and blade pitch:
</p>

<ul>
<li> <p><code>"probDist"</code>: sample rotation speed and blade pitch values from a
<em>tnorm-lw0</em> distribution (default value).
</p>
</li>
<li> <p><code>"windSpeedReltn"</code>: generate rotation speed and blade pitch values as a
function of wind speed intensity.
</p>
</li></ul>
</td></tr>
<tr><td><code id="stoch_crm_+3A_bld_pitch_pars">bld_pitch_pars</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "probDist"</code>, a single
row data frame with columns <code>mean</code> and <code>sd</code>, the mean and standard
deviation of the blade pitch angle, i.e. the angle between the blade
surface and the rotor plane, in degrees. Assumed to follow a
<em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_rtn_speed_pars">rtn_speed_pars</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "probDist"</code>, a
single row data frame with columns <code>mean</code> and <code>sd</code>, the mean and standard
deviation of the operational rotation speed, in revolutions per minute.
Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_windspd_pars">windspd_pars</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "windSpeedReltn"</code>,
a single row data frame with columns <code>mean</code> and <code>sd</code>, the mean and the
standard deviation of wind speed at the windfarm site, in metres/sec.
Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_rtn_pitch_windspd_dt">rtn_pitch_windspd_dt</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "windSpeedReltn"</code>,
a data frame giving the relationship between wind speed, rotation speed
and blade pitch values. It must contain the columns:
</p>

<ul>
<li> <p><code>wind_speed</code>, wind speed in m/s,
</p>
</li>
<li> <p><code>rtn_speed</code>, rotation speed in rpm,
</p>
</li>
<li> <p><code>bld_pitch</code>, blade pitch values in degrees.
</p>
</li></ul>
</td></tr>
<tr><td><code id="stoch_crm_+3A_trb_wind_avbl">trb_wind_avbl</code></td>
<td>
<p>A data frame with the monthly estimates of operational
wind availability. It must contain the columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>pctg</code>, the percentage of time wind conditions allow for turbine operation
per month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="stoch_crm_+3A_trb_downtime_pars">trb_downtime_pars</code></td>
<td>
<p>A data frame with monthly estimates of maintenance
downtime, assumed to follow a <em>tnorm-lw0</em> distribution. It
must contain the following columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>mean</code>, numeric, the mean percentage of time in each month when turbines
are not operating due to maintenance,
</p>
</li>
<li> <p><code>sd</code>, the standard deviation of monthly maintenance downtime.
</p>
</li></ul>
</td></tr>
<tr><td><code id="stoch_crm_+3A_wf_n_trbs">wf_n_trbs</code></td>
<td>
<p>Integer, the number of turbines on the windfarm.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_wf_width">wf_width</code></td>
<td>
<p>Numeric value, the approximate longitudinal width of the
wind farm, in kilometres (<code class="reqn">w</code>).</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_wf_latitude">wf_latitude</code></td>
<td>
<p>A decimal value. The latitude of the centroid of the
windfarm, in degrees.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_tidal_offset">tidal_offset</code></td>
<td>
<p>A numeric value, the tidal offset, the difference between
HAT and mean sea level, in metres.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_lrg_arr_corr">lrg_arr_corr</code></td>
<td>
<p>Boolean value. If TRUE, the large array correction will
be applied. This is a correction factor to account for the decay in
bird density at later rows in wind farms with a large array of turbines.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_yinc">yinc</code>, <code id="stoch_crm_+3A_xinc">xinc</code></td>
<td>
<p>numeric values, the increments along the y-axis and x-axis
for numerical integration across segments of the rotor circle. Chosen
values express proportion of rotor radius. By default these are set to
0.05, i.e. integration will be performed at a resolution of one twentieth
of the rotor radius.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_out_format">out_format</code></td>
<td>
<p>Output format specification. Possible values are:
</p>

<ul>
<li> <p><code>"draws"</code>: returns stochastic draws of collisions estimates (default value),
</p>
</li>
<li> <p><code>"summaries"</code>: returns summary statistics of collisions estimates.
</p>
</li></ul>
</td></tr>
<tr><td><code id="stoch_crm_+3A_out_sampled_pars">out_sampled_pars</code></td>
<td>
<p>Logical, whether to output summary statistics of values
sampled for each stochastic model parameter.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_out_period">out_period</code></td>
<td>
<p>Controls level of temporal aggregation of collision
outputs. Possible values are:
</p>

<ul>
<li> <p><code>"months"</code>: monthly collisions (default value),
</p>
</li>
<li> <p><code>"seasons"</code>: collisions per user-defined season,
</p>
</li>
<li> <p><code>"annum"</code>: total collisions over 12 months.
</p>
</li></ul>
</td></tr>
<tr><td><code id="stoch_crm_+3A_season_specs">season_specs</code></td>
<td>
<p>Only required if <code>out_period = "seasons"</code>, a data frame
defining the seasons for aggregating over collision estimates. It must
comprise the following columns:
</p>

<ul>
<li> <p><code>season_id</code>, (unique) season identifier,
</p>
</li>
<li> <p><code>start_month</code>, name of the season's first month,
</p>
</li>
<li> <p><code>end_month</code>, name of the season's last month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="stoch_crm_+3A_verbose">verbose</code></td>
<td>
<p>Logical, print model run progress on the console?</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_log_file">log_file</code></td>
<td>
<p>Path to log file to store session info and main model run
options. If set to NULL (default value), log file is not created.</p>
</td></tr>
<tr><td><code id="stoch_crm_+3A_seed">seed</code></td>
<td>
<p>Integer, the random seed for <a href="base.html#topic+Random">random number generation</a>, for analysis reproducibility.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Collision risk can be calculated under 4 options, specified by <code>model_options</code>:
</p>

<ul>
<li> <p><strong>Option 1</strong> - Basic model with proportion at
collision risk height derived from site survey (<code>prop_crh_surv</code>).
</p>
</li>
<li> <p><strong>Option 2</strong> - Basic model with proportion
at collision risk height derived from a generic flight height distribution
(<code>gen_fhd</code>).
</p>
</li>
<li> <p><strong>Option 3</strong> - Extended model using a
generic flight height distribution (<code>gen_fhd</code>).
</p>
</li>
<li> <p><strong>Option 4</strong> - Extended model using a
site-specific flight height distribution (<code>site_fhd</code>).
</p>
</li></ul>

<p>Where,
</p>

<ul>
<li><p> Basic model - assumes a uniform distribution of bird flights at
collision risk height (i.e. above the minimum and below the maximum height
of the rotor blade).
</p>
</li>
<li><p> Extended model - takes into account the distribution of bird flight
heights at collision risk height.
</p>
</li></ul>



<h3>Value</h3>

<p>If <code>out_sampled_pars = FALSE</code>, returns a list with estimates of number of
collisions per chosen time periods, with elements containing the outputs for
each CRM Option.
</p>
<p>If <code>out_sampled_pars = TRUE</code>, returns a list object with two top-level
elements:
</p>

<ul>
<li> <p><code>collisions</code>, a list comprising collision estimates for each CRM Option,
</p>
</li>
<li> <p><code>sampled_pars</code>, a list with summary statistics of values sampled for
stochastic model parameters.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># ------------------------------------------------------
# Run with arbitrary parameter values, for illustration
# ------------------------------------------------------

# ------------------------------------------------------
# Setting some of the required inputs upfront
b_dens &lt;- data.frame(
  month = month.abb,
  mean = runif(12, 0.8, 1.5),
  sd = runif(12, 0.2, 0.3)
)
head(b_dens)

# Generic FHD bootstraps from Johnson et al (2014)
fhd_boots &lt;- generic_fhd_bootstraps[[1]]
head(fhd_boots)

# wind speed vs rotation speed vs blade pitch
wind_rtn_ptch &lt;- data.frame(
  wind_speed = seq_len(30),
  rtn_speed = 10/(30:1),
  bld_pitch = c(rep(90, 4), rep(0, 8), 5:22)
)
head(wind_rtn_ptch)

# wind availability
windavb &lt;- data.frame(
  month = month.abb,
  pctg = runif(12, 85, 98)
)
head(windavb)

# maintenance downtime
dwntm &lt;- data.frame(
  month = month.abb,
  mean = runif(12, 6, 10),
  sd = rep(2, 12))
head(dwntm)

# seasons specification
seas_dt &lt;- data.frame(
  season_id = c("a", "b", "c"),
  start_month = c("Jan", "May", "Oct"), end_month = c("Apr", "Sep", "Dec")
  )
head(seas_dt)

# ----------------------------------------------------------
# Run stochastic CRM, treating rotor radius, air gap and
# blade width as fixed parameters (i.e. not stochastic)

stoch_crm(
  model_options = c(1, 2, 3),
  n_iter = 1000,
  flt_speed_pars = data.frame(mean = 7.26, sd = 1.5),
  body_lt_pars = data.frame(mean = 0.39, sd = 0.005),
  wing_span_pars = data.frame(mean = 1.08, sd = 0.04),
  avoid_bsc_pars = data.frame(mean = 0.99, sd = 0.001),
  avoid_ext_pars = data.frame(mean = 0.96, sd = 0.002),
  noct_act_pars = data.frame(mean = 0.033, sd = 0.005),
  prop_crh_pars = data.frame(mean = 0.06, sd = 0.009),
  bird_dens_opt = "tnorm",
  bird_dens_dt = b_dens,
  flight_type = "flapping",
  prop_upwind = 0.5,
  gen_fhd_boots = fhd_boots,
  n_blades = 3,
  rtr_radius_pars = data.frame(mean = 80, sd = 0), # sd = 0, rotor radius is fixed
  air_gap_pars = data.frame(mean = 36, sd = 0),    # sd = 0, air gap is fixed
  bld_width_pars = data.frame(mean = 8, sd = 0),   # sd = 0, blade width is fixed
  rtn_pitch_opt = "windSpeedReltn",
  windspd_pars = data.frame(mean = 7.74, sd = 3),
  rtn_pitch_windspd_dt = wind_rtn_ptch,
  trb_wind_avbl = windavb,
  trb_downtime_pars = dwntm,
  wf_n_trbs = 200,
  wf_width = 15,
  wf_latitude = 56.9,
  tidal_offset = 2.5,
  lrg_arr_corr = TRUE,
  verbose = TRUE,
  seed = 1234,
  out_format = "summaries",
  out_sampled_pars = TRUE,
  out_period = "seasons",
  season_specs = seas_dt,
  log_file = NULL
)
</code></pre>

<hr>
<h2 id='stochLAB'>stochLAB: Stochastic Collision Risk Model</h2><span id='topic+stochLAB'></span>

<h3>Description</h3>

<p>stochLAB is a tool to run stochastic (and deterministic) Collision Risk
Models (CRM) for seabirds on offshore wind farms.
</p>
<p>The main functions of stochLAB are:
</p>

<ul>
<li> <p><code><a href="#topic+stoch_crm">stoch_crm()</a></code>: Stochastic Collision Risk Model,
</p>
</li>
<li> <p><code><a href="#topic+band_crm">band_crm()</a></code>: Deterministic Collision Risk Model,
</p>
</li>
<li> <p><code><a href="#topic+mig_stoch_crm">mig_stoch_crm()</a></code>: Stochastic Migration Collision risk Model
</p>
</li></ul>



<h3>Overview</h3>

<p>The <code>{stochLAB}</code> package is an adaptation of the <a href="https://data.marine.gov.scot/dataset/developing-avian-collision-risk-model-incorporate-variability-and-uncertainty-r-code-0">R code</a>
developed by <a href="https://data.marine.gov.scot/dataset/developing-avian-collision-risk-model-incorporate-variability-and-uncertainty">Masden (2015)</a>
to incorporate variability and uncertainty in the avian collision risk model
originally developed by <a href="https://www.bto.org/sites/default/files/u28/downloads/Projects/Final_Report_SOSS02_Band1ModelGuidance.pdf">Band (2012)</a>.
</p>
<p>Code developed under <code>{stochLAB}</code> substantially re-factored and re-structured
Masden's (heavily script-based) implementation into a user-friendly,
streamlined, well documented and easily distributed tool. Furthermore, this
package lays down the code infrastructure for easier incorporation of new
functionality, e.g. extra parameter sampling features, model expansions,
etc.
</p>
<p>Previous code underpinning key calculations for the extended model has been
replaced by an alternative approach, resulting in significant gains in
computational speed over Masden's code. This optimization
is particularly beneficial under a stochastic context, when Band calculations
are computed repeatedly. See <code><a href="#topic+generate_rotor_grids">generate_rotor_grids()</a></code> for further details.
</p>


<h3>Function <code>stoch_crm()</code></h3>

<p><code>stoch_crm()</code> is essentially a replacement function for script <em>BandModel.r</em>
in Masden's approach. Main changes in terms of user interface include:
</p>

<ul>
<li><p> Collision model runs for one single scenario (i.e. one species for one
turbine scenario) at each <code>stoch_crm()</code> call. Apart from gains in development
code structure, this unit-based approach was considered to offer greater end
user flexibility for setting up and managing multiple scenarios (including
parallel computation).
</p>
</li>
<li><p> Input parameters now entered explicitly into feature-specific arguments,
instead of bundled together into wide-column tables. This improves code
readability and reduces the quantity of hard-coded parameter names,
therefore making referencing errors less likely.
</p>
</li>
<li><p> Outputs no longer saved automatically to external files.
</p>
</li></ul>



<h4>Seasonal Outputs</h4>

<p><code>stoch_crm()</code> now provides an option for user-defined seasonal outputs, allowing
for country/region specific seasonal definitions.
</p>
<p>Currently implemented CRM calculations produce collision estimates on a
monthly basis to reflect changing bird abundance within the windfarm area.
Seasonal estimates are obtained by aggregating monthly estimates over each
season definition, with uncertainty in collision estimates being suitably
propagated to seasonal outputs.
</p>



<h4>Sampling distributions</h4>

<p>Masden's implementation used Normal and Truncated Normal distributions to
generate random parameter values. However, the Normal distribution is
unbounded, and so there was the risk of randomly drawing inappropriate values in
some cases.
</p>
<p><code>stoch_crm()</code> extends the use of bounded probability distributions to all model
parameters. Strictly positive features (e.g. bird densities, body length,
turbine downtime, etc.) are sampled from Truncated Normal distributions, while
features constrained between 0 and 1 (e.g. nocturnal activity, proportion
of flights at collision risk height, etc) are assumed to follow Beta
distributions.
</p>
<p>In addition, new functionality has been incorporated to allow the use of bird
density resamples (e.g. bootstrap samples) or quantile estimates from density
estimation models in the simulations.
</p>



<h3>Function <code>band_crm()</code></h3>

<p><code>band_crm()</code> performs the core CRM calculations required to estimate the
number of collisions, as per <a href="https://www.bto.org/sites/default/files/u28/downloads/Projects/Final_Report_SOSS02_Band1ModelGuidance.pdf">Band (2012)</a>.
While being the computing workhorse of the <code>stoch_crm()</code> function, it can
also be used alone, providing backward compatibility with the original Band
spreadsheet outputs.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/HiDef-Aerial-Surveying/stochLAB">https://github.com/HiDef-Aerial-Surveying/stochLAB</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/HiDef-Aerial-Surveying/stochLAB/issues">https://github.com/HiDef-Aerial-Surveying/stochLAB/issues</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># ------------------------------------------------------
# Run with arbitrary parameter values, for illustration
# ------------------------------------------------------

# Setting a dataframe of parameters to draw from
params &lt;- data.frame(
  flight_speed = 13.1,         # Flight speed in m/s
  body_lt = 0.85,              # Body length in m
  wing_span = 1.01,            # Wing span in m
  flight_type = "flapping",    # flapping or gliding flight
  avoid_rt_basic = 0.989,      # avoidance rate for option 1 and 2
  avoid_rt_ext = 0.981,        # extended avoidance rate for option 3 and 4
  noct_activity = 0.5,         # proportion of day birds are inactive
  prop_crh_surv = 0.13,        # proportion of birds at collision risk height (option 1 only)
  prop_upwind = 0.5,           # proportion of flights that are upwind
  rotor_speed = 15,            # rotor speed in m/s
  rotor_radius = 120,          # radius of turbine in m
  blade_width = 5,             # width of turbine blades at thickest point in m
  blade_pitch = 15,            # mean radius pitch in Radians
  n_blades = 3,                # total number of blades per turbine
  hub_height = 150,            # height of hub in m above HAT
  n_turbines = 100,            # number of turbines in the wind farm
  wf_width = 52,               # width across longest section of wind farm
  wf_latitude = 56,            # latitude of centroid of wind farm
  tidal_offset = 2.5,          # mean tidal offset from HAT of the wind farm
  lrg_arr_corr = TRUE          # apply a large array correction?
)

# Monthly bird densities
b_dens &lt;- data.frame(
  month = month.abb,
  dens = runif(12, 0.8, 1.5)
)

# flight height distribution from Johnston et al
gen_fhd_dat &lt;- Johnston_Flight_heights_SOSS %&gt;%
  dplyr::filter(variable=="Gannet.est") %&gt;%
  dplyr::select(height,prop)


# monthly operational time of the wind farm
turb_oper &lt;- data.frame(
  month = month.abb,
  prop_oper = runif(12,0.5,0.8)
)


band_crm(
  model_options = c(1,2,3),
  flight_speed = params$flight_speed,
  body_lt = params$body_lt,
  wing_span = params$wing_span,
  flight_type = params$flight_type,
  avoid_rt_basic = params$avoid_rt_basic,
  avoid_rt_ext = params$avoid_rt_ext,
  noct_activity = params$noct_activity,
  prop_crh_surv = params$prop_crh_surv,
  dens_month = b_dens,
  prop_upwind = params$prop_upwind,
  gen_fhd = gen_fhd_dat,
  site_fhd = NULL,  # Option 4 only
  rotor_speed = params$rotor_speed,
  rotor_radius = params$rotor_radius,
  blade_width = params$blade_width,
  blade_pitch = params$blade_pitch,
  n_blades = params$n_blades,
  hub_height = params$hub_height,
  chord_prof = chord_prof_5MW,
  n_turbines = params$n_turbines,
  turb_oper_month = turb_oper,
  wf_width = params$wf_width,
  wf_latitude = params$wf_latitude,
  tidal_offset = params$tidal_offset,
  lrg_arr_corr = params$lrg_arr_corr
  )
</code></pre>

<hr>
<h2 id='turb_pars_wide_example'>Example of turbine and windfarm parameters stored in wide format</h2><span id='topic+turb_pars_wide_example'></span>

<h3>Description</h3>

<p>A data frame of (fake) data on turbine and wind farm features for 3 scenarios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>turb_pars_wide_example
</code></pre>


<h3>Format</h3>

<p>A 3 x 51 data frame, with the turbine and windfarm parameters (columns) for
each of the 3 development scenarios (rows). Columns include:
</p>

<dl>
<dt>TurbineModel </dt><dd><p>The turbine/windfarm scenario ID</p>
</dd>
<dt>Blades</dt><dd><p>Nr of blades</p>
</dd>
<dt>RotorRadius</dt><dd><p>Mean of rotor radius</p>
</dd>
<dt>RotorRadiusSD</dt><dd><p>SD of rotor radius</p>
</dd>
<dt>HubHeightAdd</dt><dd><p>Mean of air gap, the distance between sea surface and lowest tip height.</p>
</dd>
<dt>HubHeightAddSD</dt><dd><p>SD of air gap, as explained above.</p>
</dd>
</dl>
<p>...

</p>


<h3>Details</h3>

<p>Intended to illustrate the application of <code>stoch_scrm()</code> to a multiple
scenario setting, where parameter data is available from tables in wide format.
</p>

<hr>
<h2 id='validate_inputs'>Input validator</h2><span id='topic+validate_inputs'></span>

<h3>Description</h3>

<p>Input validator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_inputs(
  model_options,
  n_iter = NULL,
  flt_speed_pars = NULL,
  flight_speed = NULL,
  body_lt_pars = NULL,
  body_lt = NULL,
  wing_span_pars = NULL,
  wing_span = NULL,
  avoid_bsc_pars = NULL,
  avoid_rt_basic = NULL,
  avoid_ext_pars = NULL,
  avoid_rt_ext = NULL,
  noct_act_pars = NULL,
  noct_activity = NULL,
  prop_crh_pars = NULL,
  bird_dens_opt = NULL,
  bird_dens_dt = NULL,
  chord_prof = NULL,
  dens_month = NULL,
  turb_oper_month = NULL,
  flight_type = NULL,
  prop_upwind = NULL,
  gen_fhd_boots = NULL,
  site_fhd_boots = NULL,
  n_blades = NULL,
  air_gap_pars = NULL,
  rtr_radius_pars = NULL,
  rotor_radius = NULL,
  blade_width = NULL,
  blade_pitch = NULL,
  hub_height = NULL,
  bld_width_pars = NULL,
  rtn_pitch_opt = NULL,
  bld_pitch_pars = NULL,
  rtn_speed_pars = NULL,
  rotor_speed = NULL,
  n_turbines = NULL,
  windspd_pars = NULL,
  rtn_pitch_windspd_dt = NULL,
  trb_wind_avbl = NULL,
  trb_downtime_pars = NULL,
  wf_n_trbs = NULL,
  wf_width = NULL,
  wf_latitude = NULL,
  tidal_offset = NULL,
  gen_fhd = NULL,
  site_fhd = NULL,
  lrg_arr_corr = NULL,
  xinc = NULL,
  yinc = NULL,
  seed = NULL,
  verbose = NULL,
  out_format = NULL,
  out_sampled_pars = NULL,
  out_period = NULL,
  season_specs = NULL,
  popn_estim_pars = NULL,
  fn = "scrm"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_inputs_+3A_model_options">model_options</code></td>
<td>
<p>Character vector, the model options for calculating collision
risk (see <strong>Details</strong> section below).</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_n_iter">n_iter</code></td>
<td>
<p>An integer. The number of iterations for the model simulation.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_flt_speed_pars">flt_speed_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the species flying speed, in metres/sec.
Assumed to follow a Truncated Normal with lower bound at 0 (<em>tnorm-lw0</em>).</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_flight_speed">flight_speed</code></td>
<td>
<p>Numeric value. The bird flying speed (<code class="reqn">v</code>), in
metres/sec.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_body_lt_pars">body_lt_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>, the
mean and standard deviation of the species body length, in metres. Assumed
to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_body_lt">body_lt</code></td>
<td>
<p>Numeric value. The length of the bird (<code class="reqn">L</code>), in metres.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_wing_span_pars">wing_span_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the species wingspan, in metres. Assumed
to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_wing_span">wing_span</code></td>
<td>
<p>Numeric value. The wingspan of the bird (<code class="reqn">W</code>), in
metres.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_avoid_bsc_pars">avoid_bsc_pars</code>, <code id="validate_inputs_+3A_avoid_ext_pars">avoid_ext_pars</code></td>
<td>
<p>Single row data frames with columns
<code>mean</code> and <code>sd</code>, the mean and standard deviation of the species avoidance
rate to be used in the basic model (Options 1 and 2) and extended model
(Options 3 and 4) calculations (see <strong>Details</strong> section). Avoidance rate
expresses the probability that a bird flying on a collision course with a
turbine will take evading action to avoid collision, and it is assumed to
follow a Beta distribution.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_avoid_rt_basic">avoid_rt_basic</code>, <code id="validate_inputs_+3A_avoid_rt_ext">avoid_rt_ext</code></td>
<td>
<p>Numeric values. The avoidance rate for,
respectively, the basic model (i.e. required for model Options 1 and 2) and
the extended model (i.e. required for Options 3 and 4). Avoidance rate
expresses the probability that a bird flying on a collision course with a
turbine will take evading action to avoid collision.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_noct_act_pars">noct_act_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
The mean and standard deviation of the species nocturnal flight activity
level, expressed as a proportion of daytime activity levels, and assumed to
be Beta distributed.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_noct_activity">noct_activity</code></td>
<td>
<p>A numeric value. The nocturnal flight activity level,
expressed as a proportion of daytime activity levels (<code class="reqn">f_night</code>).</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_prop_crh_pars">prop_crh_pars</code></td>
<td>
<p>Required only for model Option 1, a single row data
frame with columns <code>mean</code> and <code>sd</code>. The mean and standard deviation of the
proportion of flights at collision risk height derived from site survey,
assumed to be Beta distributed.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_bird_dens_opt">bird_dens_opt</code></td>
<td>
<p>Option for specifying the random sampling mechanism for bird
densities:
</p>

<ul>
<li> <p><code>"tnorm"</code>: Sampling of density estimates from a <em>tnorm-lw0</em> distribution
(default value),
</p>
</li>
<li> <p><code>"resample"</code>: Re-sample draws of bird density estimates (e.g. bootstrap
samples),
</p>
</li>
<li> <p><code>"qtiles"</code>: Sampling from a set of quantile estimates of bird densities.
</p>
</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_bird_dens_dt">bird_dens_dt</code></td>
<td>
<p>A data frame with monthly estimates of bird density
within the windfarm footprint, expressed as the number of daytime in-flight
birds/km^2 per month. Data frame format requirements:
</p>

<ul>
<li><p> If <code>bird_dens_opt = "tnorm"</code>, <code>bird_dens_dt</code> must contain the following
columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>mean</code>, the mean number of birds in flight at any height per square
kilometre in each month,
</p>
</li>
<li> <p><code>sd</code>, idem, for standard deviation.
</p>
</li></ul>

</li>
<li><p> If <code>bird_dens_opt = "resample"</code>, <code>bird_dens_dt</code> columns must be named as
months (i.e. <code>Jan</code>, <code>Feb</code>, ...), each containing random samples of monthly
density estimates.
</p>
</li>
<li><p> If <code>bird_dens_opt = "qtiles"</code>, <code>bird_dens_dt</code> must comply with:
</p>

<ul>
<li><p> First column named as <code>p</code>, giving reference probabilities,
</p>
</li>
<li><p> Remaining columns named as months (i.e. <code>Jan</code>, <code>Feb</code>, ...), each
giving the quantile estimates of bird density in a given month, for the
reference probabilities in column <code>p</code>.
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_chord_prof">chord_prof</code></td>
<td>
<p>A data frame with the chord taper profile of the rotor
blade. Function expects two named columns:
</p>

<ul>
<li><p><code>pp_radius</code>, equidistant intervals of radius at bird passage point,
as a proportion of <code>rotor_radius</code>, within the range <code class="reqn">[0, 1]</code>.
</p>
</li>
<li><p><code>chord</code>, the chord width at <code>pp_radius</code>, as a proportion
of <code>blade_width</code>.
</p>
</li></ul>

<p>Defaults to a generic profile for a typical modern 5MW turbine. See
<code><a href="#topic+chord_prof_5MW">chord_prof_5MW()</a></code> for details.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_dens_month">dens_month</code></td>
<td>
<p>Data frame, containing estimates of daytime in-flight
bird densities per month within the windfarm footprint, in birds/km^2. It
must contain the following named columns:
</p>

<ul>
<li> <p><code>month</code>, the month names.
</p>
</li>
<li><p><code>dens</code>, the number of birds in flight at any height per
square kilometre in each month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_turb_oper_month">turb_oper_month</code></td>
<td>
<p>Data frame, holding the proportion of time during
which turbines are operational per month. The following named column are
expected:
</p>

<ul>
<li><p><code>month</code>, the month names.
</p>
</li>
<li><p><code>prop_oper</code>, the proportion of time operating, per month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_flight_type">flight_type</code></td>
<td>
<p>A character string, either 'flapping' or 'gliding',
indicating the species' characteristic flight type.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_prop_upwind">prop_upwind</code></td>
<td>
<p>Numeric value between 0-1 giving the proportion of
flights upwind - defaults to 0.5.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_gen_fhd_boots">gen_fhd_boots</code></td>
<td>
<p>Required only for model Options 2 and 3, a data frame
with bootstrap samples of flight height distributions (FHD) of the species
derived from general (country/regional level) data. FHD provides relative
frequency distribution of bird flights at 1-+
-metre height bands, starting
from sea surface. The first column must be named as <code>height</code>,
expressing the lower bound of the height band (thus it's first element must
be 0). Each remaining column should provide a bootstrap sample of the
proportion of bird flights at each height band, with no column naming
requirements.
</p>
<p><strong>NOTE:</strong> <a href="#topic+generic_fhd_bootstraps">generic_fhd_bootstraps</a> is a list object with generic FHD
bootstrap estimates for 25 seabird species from Johnson et al
(2014) <a href="https://doi.org/10.1111/1365-2664.12191">doi:10.1111/1365-2664.12191</a>
(see usage in Example Section below).</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_site_fhd_boots">site_fhd_boots</code></td>
<td>
<p>Required only for model Option 4, a data frame similar
to <code>gen_fhd_boots</code>, but for FHD estimates derived from site-specific
data.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_n_blades">n_blades</code></td>
<td>
<p>An integer, the number of blades in rotor (<code class="reqn">b</code>).</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_air_gap_pars">air_gap_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>, the
mean and standard deviation of the tip clearance gap, in metres, i.e. the
distance between the minimum rotor tip height and the highest astronomical
tide (HAT). Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_rtr_radius_pars">rtr_radius_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the radius of the rotor, in metres.
Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_rotor_radius">rotor_radius</code></td>
<td>
<p>Numeric value. The radius of the rotor (<code class="reqn">R</code>), in
metres.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_blade_width">blade_width</code></td>
<td>
<p>Numeric value, giving the maximum blade width, in metres.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_blade_pitch">blade_pitch</code></td>
<td>
<p>Numeric value. The average blade pitch angle, the angle
between the blade surface and the rotor plane (<code class="reqn">\gamma</code>), in radians.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_hub_height">hub_height</code></td>
<td>
<p>A numeric value, the height of the rotor hub (<code class="reqn">H</code>), given by the
sum of rotor radius and minimum blade clearance above the highest
astronomical tide (HAT), in metres.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_bld_width_pars">bld_width_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>,
the mean and standard deviation of the maximum blade width, in metres.
Assumed to be <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_rtn_pitch_opt">rtn_pitch_opt</code></td>
<td>
<p>a character string, the option for specifying
the sampling mechanism for rotation speed and blade pitch:
</p>

<ul>
<li> <p><code>"probDist"</code>: sample rotation speed and blade pitch values from a
<em>tnorm-lw0</em> distribution (default value).
</p>
</li>
<li> <p><code>"windSpeedReltn"</code>: generate rotation speed and blade pitch values as a
function of wind speed intensity.
</p>
</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_bld_pitch_pars">bld_pitch_pars</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "probDist"</code>, a single
row data frame with columns <code>mean</code> and <code>sd</code>, the mean and standard
deviation of the blade pitch angle, i.e. the angle between the blade
surface and the rotor plane, in degrees. Assumed to follow a
<em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_rtn_speed_pars">rtn_speed_pars</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "probDist"</code>, a
single row data frame with columns <code>mean</code> and <code>sd</code>, the mean and standard
deviation of the operational rotation speed, in revolutions per minute.
Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_rotor_speed">rotor_speed</code></td>
<td>
<p>Numeric value. The operational rotation speed, in
revolutions/min.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_n_turbines">n_turbines</code></td>
<td>
<p>Integer, the number of turbines on the wind farm
(<code class="reqn">T</code>).</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_windspd_pars">windspd_pars</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "windSpeedReltn"</code>,
a single row data frame with columns <code>mean</code> and <code>sd</code>, the mean and the
standard deviation of wind speed at the windfarm site, in metres/sec.
Assumed to follow a <em>tnorm-lw0</em> distribution.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_rtn_pitch_windspd_dt">rtn_pitch_windspd_dt</code></td>
<td>
<p>Only required if <code>rtn_pitch_opt = "windSpeedReltn"</code>,
a data frame giving the relationship between wind speed, rotation speed
and blade pitch values. It must contain the columns:
</p>

<ul>
<li> <p><code>wind_speed</code>, wind speed in m/s,
</p>
</li>
<li> <p><code>rtn_speed</code>, rotation speed in rpm,
</p>
</li>
<li> <p><code>bld_pitch</code>, blade pitch values in degrees.
</p>
</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_trb_wind_avbl">trb_wind_avbl</code></td>
<td>
<p>A data frame with the monthly estimates of operational
wind availability. It must contain the columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>pctg</code>, the percentage of time wind conditions allow for turbine operation
per month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_trb_downtime_pars">trb_downtime_pars</code></td>
<td>
<p>A data frame with monthly estimates of maintenance
downtime, assumed to follow a <em>tnorm-lw0</em> distribution. It
must contain the following columns:
</p>

<ul>
<li> <p><code>month</code>, (unique) month names,
</p>
</li>
<li> <p><code>mean</code>, numeric, the mean percentage of time in each month when turbines
are not operating due to maintenance,
</p>
</li>
<li> <p><code>sd</code>, the standard deviation of monthly maintenance downtime.
</p>
</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_wf_n_trbs">wf_n_trbs</code></td>
<td>
<p>Integer, the number of turbines on the windfarm.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_wf_width">wf_width</code></td>
<td>
<p>Numeric value, the approximate longitudinal width of the
wind farm, in kilometres (<code class="reqn">w</code>).</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_wf_latitude">wf_latitude</code></td>
<td>
<p>A decimal value. The latitude of the centroid of the
windfarm, in degrees.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_tidal_offset">tidal_offset</code></td>
<td>
<p>A numeric value, the tidal offset, the difference between
HAT and mean sea level, in metres.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_gen_fhd">gen_fhd</code>, <code id="validate_inputs_+3A_site_fhd">site_fhd</code></td>
<td>
<p>Data frame objects, with flight height distributions
(fhd) of the species - the relative frequency distribution of bird flights
at 1-metre height intervals from sea surface.
Specifically:
</p>

<ul>
<li><p><code>gen_fhd</code>, Data frame with the species' generic fhd derived
from combining wider survey data. Only required for model Options 2 and 3
</p>
</li>
<li><p><code>site_fhd</code>, Data frame with the species' site-specific fhd
derived from local survey data. Only required for model Option 4
</p>
</li></ul>

<p>Data frames must contain the following named columns:
</p>

<ul>
<li><p><code>height</code>, integers representing height bands from sea surface,
in metres. Function expects 0 as the first value, representing the 0-1m
band.
</p>
</li>
<li><p><code>prop</code>, the proportion of flights at each height band.
</p>
</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_lrg_arr_corr">lrg_arr_corr</code></td>
<td>
<p>Boolean value. If TRUE, the large array correction will
be applied. This is a correction factor to account for the decay in
bird density at later rows in wind farms with a large array of turbines.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_yinc">yinc</code>, <code id="validate_inputs_+3A_xinc">xinc</code></td>
<td>
<p>numeric values, the increments along the y-axis and x-axis
for numerical integration across segments of the rotor circle. Chosen
values express proportion of rotor radius. By default these are set to
0.05, i.e. integration will be performed at a resolution of one twentieth
of the rotor radius.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_seed">seed</code></td>
<td>
<p>Integer, the random seed for <a href="base.html#topic+Random">random number generation</a>, for analysis reproducibility.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_verbose">verbose</code></td>
<td>
<p>Logical, print model run progress on the console?</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_out_format">out_format</code></td>
<td>
<p>Output format specification. Possible values are:
</p>

<ul>
<li> <p><code>"draws"</code>: returns stochastic draws of collisions estimates (default value),
</p>
</li>
<li> <p><code>"summaries"</code>: returns summary statistics of collisions estimates.
</p>
</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_out_sampled_pars">out_sampled_pars</code></td>
<td>
<p>Logical, whether to output summary statistics of values
sampled for each stochastic model parameter.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_out_period">out_period</code></td>
<td>
<p>Controls level of temporal aggregation of collision
outputs. Possible values are:
</p>

<ul>
<li> <p><code>"months"</code>: monthly collisions (default value),
</p>
</li>
<li> <p><code>"seasons"</code>: collisions per user-defined season,
</p>
</li>
<li> <p><code>"annum"</code>: total collisions over 12 months.
</p>
</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_season_specs">season_specs</code></td>
<td>
<p>Only required if <code>out_period = "seasons"</code>, a data frame
defining the seasons for aggregating over collision estimates. It must
comprise the following columns:
</p>

<ul>
<li> <p><code>season_id</code>, (unique) season identifier,
</p>
</li>
<li> <p><code>start_month</code>, name of the season's first month,
</p>
</li>
<li> <p><code>end_month</code>, name of the season's last month.
</p>
</li></ul>
</td></tr>
<tr><td><code id="validate_inputs_+3A_popn_estim_pars">popn_estim_pars</code></td>
<td>
<p>A single row data frame with columns <code>mean</code> and <code>sd</code>.
The population estimate of the species expected to fly through the wind farm
area.</p>
</td></tr>
<tr><td><code id="validate_inputs_+3A_fn">fn</code></td>
<td>
<p>a character string specifying the parent function whose inputs are being checked:
</p>

<ul>
<li> <p><code>"scrm"</code>: checks <code><a href="#topic+stoch_crm">stoch_crm()</a></code> inputs
</p>
</li>
<li> <p><code>"crm"</code>: checks <code><a href="#topic+band_crm">band_crm()</a></code> inputs
</p>
</li>
<li> <p><code>"mcrm"</code>: checks <code><a href="#topic+mig_stoch_crm">mig_stoch_crm()</a></code> inputs
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing returned from this function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  validate_inputs(model_options=c(1),
               avoid_bsc_pars=data.frame(mean=0.99,sd=0.001),
               prop_crh_pars=data.frame(mean=0.01,sd=0.01),
               air_gap_pars = data.frame(mean=21,sd=0),
               rtr_radius_pars = data.frame(mean=100,sd=0),
               bld_pitch_pars = data.frame(mean=15,sd=0),
               rtn_pitch_opt = "probDist",
               rtn_speed_pars = data.frame(mean=14,sd=5),
               out_period = "months",
               lrg_arr_corr = TRUE,
               fn="scrm")
</code></pre>

<hr>
<h2 id='wndspd_rtn_ptch_example'>Example of data with relationship between wind speed, rotation speed and
blade pitch</h2><span id='topic+wndspd_rtn_ptch_example'></span>

<h3>Description</h3>

<p>Intended to illustrate the application of <code>stoch_scrm()</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wndspd_rtn_ptch_example
</code></pre>


<h3>Format</h3>

<p>A 30 x 3 data frame with columns:
</p>

<dl>
<dt>wind_speed</dt><dd><p>Wind speed in metres per second.</p>
</dd>
<dt>rtn_speed</dt><dd><p>Blade rotation speed, in revolutions per minute</p>
</dd>
<dt>bld_pitch</dt><dd><p>Blade pitch, in degrees</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
