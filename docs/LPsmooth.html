<!DOCTYPE html><html><head><title>Help for package LPsmooth</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LPsmooth}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CDplot'>
<p>CD-plot and Deviance test</p></a></li>
<li><a href='#d_hat'>
<p>Comparison density estimate</p></a></li>
<li><a href='#dmixnegbinom'>
<p>Probability mass function of a mixture of negative binomials</p>
</p></a></li>
<li><a href='#dmixtruncnorm'>
<p>Probability density function of a mixture of truncated normals</p></a></li>
<li><a href='#find_h_cont'>
<p>Finding optimal  instrumental density.</p></a></li>
<li><a href='#find_h_disc'>
<p>Finding optimal instrumental mass function.</p></a></li>
<li><a href='#rmixnegbinom'>
<p>Random numbers generator for negative binomial mixtures</p>
</p></a></li>
<li><a href='#rmixtruncnorm'>
<p>Random numbers generator for truncated normal mixtures</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>LP Smoothed Inference and Graphics</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiangyu Zhang &lt;zhan6004@umn.edu&gt;, Sara Algeri &lt;salgeri@umn.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiangyu Zhang &lt;zhan6004@umn.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Classical tests of goodness-of-fit aim to validate the conformity of a postulated model to the data under study. In their standard formulation, however, they do not allow exploring how the hypothesized model deviates from the truth nor do they provide any insight into how the rejected model could be improved to better fit the data. To overcome these shortcomings, we establish a comprehensive framework for goodness-of-fit which naturally integrates modeling, estimation, inference and graphics. In this package, the deviance tests and comparison density plots are performed to conduct the LP smoothed inference, where the letter L denotes nonparametric methods based on quantiles and P stands for polynomials. Simulations methods are used to perform variance estimation, inference and post-selection adjustments. Algeri S. and Zhang X. (2020) &lt;<a href="https://arxiv.org/abs/2005.13011">arXiv:2005.13011</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>LPGraph,LPBkg,truncnorm,nloptr,Hmisc,orthopolynom,polynom</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>True</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-23 16:14:06 UTC; zxysmacbook</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-24 11:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='CDplot'>
CD-plot and Deviance test
</h2><span id='topic+CDplot'></span>

<h3>Description</h3>

<p>Constructs the CD-plot and computes the deviance test for exhaustive goodness-of-fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CDplot(data,m=4,g,par0=NULL,range=NULL,lattice=NULL,selection=TRUE,criterion="BIC",
        B=1000,samplerG=NULL,h=NULL,samplerH=NULL,R=500,ylim=c(0,2),CD.plot=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CDplot_+3A_data">data</code></td>
<td>

<p>A data vector. See details.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_m">m</code></td>
<td>

<p>If <code>selection = FALSE</code>, it corresponds to the desired size of the polynomial basis to be used.
If <code>selection = TRUE</code>, it is the size of the polynomial basis from which the terms to include in the model are selected.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_g">g</code></td>
<td>

<p>Function corresponding to the parametric start. See details.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_par0">par0</code></td>
<td>

<p>A vector of starting values for the parameters of <code>g</code> when the latter is not fully known. See details.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_range">range</code></td>
<td>

<p>Interval corresponding to the support of the continuous data distribution.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_lattice">lattice</code></td>
<td>

<p>Support of the discrete data distribution.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_selection">selection</code></td>
<td>

<p>A logical argument indicating if model selection should be performed. See details.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_criterion">criterion</code></td>
<td>

<p>If <code>selection=TRUE</code>, the selection criterion to be. The two possibilities are <code>"AIC"</code> or <code>"BIC"</code>. See details.</p>
</td></tr>
<tr><td><code id="CDplot_+3A_b">B</code></td>
<td>

<p>A positive integer corresponding to the number of bootstrap replicates.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_samplerg">samplerG</code></td>
<td>

<p>A function corresponding to the random sampler for the parametric start <code>g</code>. See details.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_h">h</code></td>
<td>

<p>Instrumental probability function. If <code>samplerG</code> is not <code>NULL</code>, the argument <code>h</code> will not be used.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_samplerh">samplerH</code></td>
<td>

<p>A function corresponding to the random sampler for the  instrumental probability function <code>h</code>. If <code>samplerG</code> is not <code>NULL</code>, the argument <code>samplerH</code> will not be used.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_r">R</code></td>
<td>

<p>A positive integer corresponding to the size of the grid of equidistant points at which the comparison densities are evaluated. The default is <code>R = 500</code>, a larger value may be needed when the smoothness of the comparison densities decrease.
</p>
</td></tr>
<tr><td><code id="CDplot_+3A_ylim">ylim</code></td>
<td>

<p>If <code>check.plot=TRUE</code>, the range of the y-axis of the respective comparison density plot. The default is <code>c(0, 2)</code>.</p>
</td></tr>
<tr><td><code id="CDplot_+3A_cd.plot">CD.plot</code></td>
<td>

<p>A logical argument indicating if the comparison density plot should be displayed or not. The default is <code>TRUE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>data</code> collects the data for which we want to test if its distribution corresponds to the one of the postulated model specified in the argument <code>g</code>.
If the parametric start is fully known, it must be specified in a way that it takes <code>x</code> as the only argument. If the parametric start is not fully known, it must be specified in a way that it takes arguments <code>x</code> and <code>par</code>, with <code>par</code> corresponding to the vector of unknown parameters. The latter are estimated numerically via maximum likelihood estimation and <code>par0</code> specifies the initial values of the parameters to be used in the optimization.
The value <code>m</code> determines the smoothness of the estimated comparison density, with smaller values of <code>m</code> leading to smoother estimates.
If <code>selection=TRUE</code>, the largest coefficient estimates are selected according to either the AIC or BIC criterion as described in Algeri and Zhang, 2020 (see also Ledwina, 1994 and Mukhopadhyay, 2017). The resulting estimator is the one in Gajek's formulation with orthonormal basis corresponding to LP score functions (see Algeri and Zhang, 2020 and Gajek, 1986).
</p>


<h3>Value</h3>

<table>
<tr><td><code>Deviance</code></td>
<td>
<p>Value of the deviance test statistic.</p>
</td></tr>
<tr><td><code>p_value</code></td>
<td>
<p>P-value of the deviance test.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Algeri and Xiangyu Zhang
</p>


<h3>References</h3>

<p>Algeri S. and Zhang X. (2020). Exhaustive goodness-of-fit via smoothed inference and graphics. arXiv:2005.13011.
</p>
<p>Gajek, L. (1986). On improving density estimators which are not bona fide functions. The Annals of sStatistics, 14(4):1612&ndash;1618.
</p>
<p>Ledwina, T. (1994). Data-driven version of neymany's smooth test of fit. Journal of the American Statistical Association, 89(427):1000&ndash;1005.
</p>
<p>Mukhopadhyay, S. (2017). Large-scale mode identification and data-driven sciences. Electronic Journal of Statistics 11 (2017), no. 1, 215&ndash;240.</p>


<h3>See Also</h3>

<p><code><a href="#topic+d_hat">d_hat</a></code>, <code><a href="#topic+find_h_disc">find_h_disc</a></code>, <code><a href="#topic+find_h_cont">find_h_cont</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-rbinom(50,size=20,prob=0.5)
g&lt;-function(x)dpois(x,10)/(ppois(20,10)-ppois(0,10))
samplerG&lt;-function(n){xx&lt;-rpois(n*3,10)
                      xxx&lt;-sample(xx[xx&lt;=20],n)
                      return(xxx)}
CDplot(data,m=4,g,par0=NULL,range=NULL,lattice=seq(0,20),
       selection=FALSE,criterion="BIC",B=10,samplerG,R=300,ylim=c(0,2))
</code></pre>

<hr>
<h2 id='d_hat'>
Comparison density estimate
</h2><span id='topic+d_hat'></span>

<h3>Description</h3>

<p>Estimates the comparison density for continuous and discrete data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>d_hat(data,m=4,g,range=NULL,lattice=NULL,selection=TRUE,criterion="BIC")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="d_hat_+3A_data">data</code></td>
<td>
<p>A data vector. See details.
</p>
</td></tr>
<tr><td><code id="d_hat_+3A_m">m</code></td>
<td>
<p>If <code>selection = FALSE</code>, it corresponds to the desired size of the polynomial basis to be used.
If <code>selection = TRUE</code>, it is the size of the polynomial basis from which the terms to include in the model are selected.
</p>
</td></tr>
<tr><td><code id="d_hat_+3A_g">g</code></td>
<td>

<p>Function corresponding to the parametric start. See details.
</p>
</td></tr>
<tr><td><code id="d_hat_+3A_range">range</code></td>
<td>
<p>Interval corresponding to the support of the continuous data distribution.
</p>
</td></tr>
<tr><td><code id="d_hat_+3A_lattice">lattice</code></td>
<td>

<p>Support of the discrete data distribution.
</p>
</td></tr>
<tr><td><code id="d_hat_+3A_selection">selection</code></td>
<td>

<p>A logical argument indicating if model selection  should be performed. See details.
</p>
</td></tr>
<tr><td><code id="d_hat_+3A_criterion">criterion</code></td>
<td>

<p>If <code>selection=TRUE</code>, the selection criterion to be used. The two possibilities are <code>"AIC"</code> or <code>"BIC"</code>. See details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>data</code> collects the data for which we want to test if its distribution corresponds to the one of the postulated model specified in the argument <code>g</code>. The parametric start is assumed to be fully specified and takes <code>x</code> as the only argument.
The value <code>m</code> determines the smoothness of the estimated comparison density, with smaller values of <code>m</code> leading to smoother estimates.
If <code>selection=TRUE</code>, the largest coefficient estimates are selected according to either the AIC or BIC criterion as described in Algeri and Zhang, 2020 (see also Ledwina, 1994 and Mukhopadhyay, 2017). The resulting estimator is the one in Gajek's formulation with orthonormal basis corresponding to LP score functions (see Algeri and Zhang, 2020 and Gajek, 1986).
</p>


<h3>Value</h3>

<table>
<tr><td><code>LPj</code></td>
<td>
<p>Estimates of the coefficients.</p>
</td></tr>
<tr><td><code>du</code></td>
<td>
<p>Function corresponding to the estimated comparison density in the u domain corresponding to the probability integral transformation.</p>
</td></tr>
<tr><td><code>dx</code></td>
<td>
<p>Function corresponding to the estimated comparison density in the x domain.</p>
</td></tr>
<tr><td><code>f</code></td>
<td>
<p>Function corresponding to the estimated probability function of the data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Algeri and Xiangyu Zhang
</p>


<h3>References</h3>

<p>Algeri S. and Zhang X. (2020). Exhaustive goodness-of-fit via smoothed inference and graphics. arXiv:2005.13011.
</p>
<p>Gajek, L. (1986). On improving density estimators which are not bona fide functions. The Annals of sStatistics, 14(4):1612&ndash;1618.
</p>
<p>Ledwina, T. (1994). Data-driven version of neymany's smooth test of fit. Journal of the American Statistical Association, 89(427):1000&ndash;1005.
</p>
<p>Mukhopadhyay, S. (2017). Large-scale mode identification and data-driven sciences. Electronic Journal of Statistics 11 (2017), no. 1, 215&ndash;240.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CDplot">CDplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("LPBkg")
#Example discrete
data&lt;-rbinom(1000,size=20,prob=0.5)
g&lt;-function(x)dpois(x,10)/(ppois(20,10)-ppois(0,10))
ddhat&lt;-d_hat(data,m=4,g, range=NULL,lattice=seq(0,20), selection=TRUE,criterion="BIC")
xx&lt;-seq(0,20)
ddhat$dx(xx)
ddhat$LPj

#Example continuous
data&lt;-rnorm(1000,0,1)
g&lt;-function(x)dt(x,10)
ddhat&lt;-d_hat(data,m=4,g, range=c(-100,100), selection=TRUE,criterion="AIC")
uu&lt;-seq(0,1,length=10)
ddhat$du(uu)
ddhat$LPj
</code></pre>

<hr>
<h2 id='dmixnegbinom'>
Probability mass function of a mixture of negative binomials
</h2><span id='topic+dmixnegbinom'></span>

<h3>Description</h3>

<p>Computes the probability mass function of a mixture of the negative binomials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmixnegbinom(x, pis, size, probs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dmixnegbinom_+3A_x">x</code></td>
<td>

<p>A scalar or vector of non-negative integer values.
</p>
</td></tr>
<tr><td><code id="dmixnegbinom_+3A_pis">pis</code></td>
<td>

<p>A vector collecting the mixture weights. See details.
</p>
</td></tr>
<tr><td><code id="dmixnegbinom_+3A_size">size</code></td>
<td>

<p>A postive value corresponding to the target for number of successful trials.
</p>
</td></tr>
<tr><td><code id="dmixnegbinom_+3A_probs">probs</code></td>
<td>

<p>A vector collecting the probabilities of success for each mixture component.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>pis</code> is a vector with length equal the number of components in the mixture. The vector <code>pis</code> must sum up to one, e.g. <code>c(0.7, 0.2, 0.1)</code>.
All the negative binomials contributing to the mixture are assumed to have the same <code>size</code>.
</p>


<h3>Value</h3>

<p>Value of the probability mass function of the mixture of negative binomials evaluated at <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Xiangyu Zhang and Sara Algeri
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmixtruncnorm">rmixtruncnorm</a></code>, <code><a href="#topic+dmixtruncnorm">dmixtruncnorm</a></code>, <code><a href="#topic+rmixnegbinom">rmixnegbinom</a></code>, <code><a href="#topic+find_h_disc">find_h_disc</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
xx&lt;-seq(0,30,length=31)
dmixnegbinom(xx,pis=c(0.4,0.6),size=25,probs=c(0.6,0.7))

</code></pre>

<hr>
<h2 id='dmixtruncnorm'>
Probability density function of a mixture of truncated normals</h2><span id='topic+dmixtruncnorm'></span>

<h3>Description</h3>

<p>Computes the probability density function of a mixture of truncated normals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmixtruncnorm(x, pis, means, sds, range)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dmixtruncnorm_+3A_x">x</code></td>
<td>

<p>A scalar or vector of real values.
</p>
</td></tr>
<tr><td><code id="dmixtruncnorm_+3A_pis">pis</code></td>
<td>

<p>A vector collecting the mixture weights. See details.
</p>
</td></tr>
<tr><td><code id="dmixtruncnorm_+3A_means">means</code></td>
<td>

<p>A vector collecting the means of the mixture components.
</p>
</td></tr>
<tr><td><code id="dmixtruncnorm_+3A_sds">sds</code></td>
<td>

<p>A vector collecting the standard deviations of the mixture components.
</p>
</td></tr>
<tr><td><code id="dmixtruncnorm_+3A_range">range</code></td>
<td>

<p>Interval corresponding to the support of each of truncated normal contributing to the mixture. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>pis</code> is a vector with its length equal the number of components in the mixture. The vector <code>pis</code> must sum up to one, e.g. <code>c(0.7, 0.2, 0.1)</code>.
The argument <code>range</code> is an interval corresponding to the support of each truncated normal contributing to the mixture. In other words, all the truncated normals contributing to the mixture are assumed to have the same range.
</p>


<h3>Value</h3>

<p>Value of the probability density function of the mixture of normals evaluated at <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>Sara Algeri and Xiangyu Zhang
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmixtruncnorm">rmixtruncnorm</a></code>, <code><a href="#topic+dmixnegbinom">dmixnegbinom</a></code>, <code><a href="#topic+rmixnegbinom">rmixnegbinom</a></code>, <code><a href="#topic+find_h_cont">find_h_cont</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>xx&lt;-seq(0,30,length=10)
dmixtruncnorm(xx,pis=c(0.3,0.6,0.1),means=c(3,6,25),sds=c(3,4,10),range=c(0,30))

</code></pre>

<hr>
<h2 id='find_h_cont'>
Finding optimal  instrumental density.
</h2><span id='topic+find_h_cont'></span>

<h3>Description</h3>

<p>Finds the optimal instrumental density <code>h</code> to be used in the bidirectional acceptance sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_h_cont(data,g,dhat,range=NULL,M_0=NULL,par0=NULL,lbs,ubs,check.plot=TRUE,
            ylim.f=c(0,2),ylim.d=c(0,2),global=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_h_cont_+3A_data">data</code></td>
<td>

<p>A data vector.
</p>
</td></tr>
<tr><td><code id="find_h_cont_+3A_g">g</code></td>
<td>

<p>Function corresponding to the parametric start or postulated model. See details.
</p>
</td></tr>
<tr><td><code id="find_h_cont_+3A_dhat">dhat</code></td>
<td>

<p>Function corresponding to the estimated comparison density in the <code>x</code> domain. See details.
</p>
</td></tr>
<tr><td><code id="find_h_cont_+3A_range">range</code></td>
<td>

<p>Interval corresponding to the support of the continuous data distribution.
</p>
</td></tr>
<tr><td><code id="find_h_cont_+3A_m_0">M_0</code></td>
<td>

<p>Starting point for optimization. See details.
</p>
</td></tr>
<tr><td><code id="find_h_cont_+3A_par0">par0</code></td>
<td>

<p>A vector of starting values of the parameters to be estimated. See details.
</p>
</td></tr>
<tr><td><code id="find_h_cont_+3A_lbs">lbs</code></td>
<td>

<p>A vector of the lower bounds of the parameters to be estimated.
</p>
</td></tr>
<tr><td><code id="find_h_cont_+3A_ubs">ubs</code></td>
<td>

<p>A vector of the upper bounds of the parameters to be estimated.
</p>
</td></tr>
<tr><td><code id="find_h_cont_+3A_check.plot">check.plot</code></td>
<td>

<p>A logical argument indicating if the plot comparing the densities involved should be displayed or not. The default is TRUE.
</p>
</td></tr>
<tr><td><code id="find_h_cont_+3A_ylim.f">ylim.f</code></td>
<td>

<p>If check.plot=TRUE, the range of the y-axis of the plot for the probability density functions.
</p>
</td></tr>
<tr><td><code id="find_h_cont_+3A_ylim.d">ylim.d</code></td>
<td>

<p>If check.plot=TRUE, the range of the y-axis of the plot for the comparison densities.
</p>
</td></tr>
<tr><td><code id="find_h_cont_+3A_global">global</code></td>
<td>

<p>A logical argument indicating if a global optimization is needed to find the instrumental probability function <code>h</code>. See details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parametric start specified in <code>g</code> is assumed to be fully specified and takes <code>x</code> as the only argument. The argument <code>dhat</code> is the estimated comparison density in the <code>x</code> domain. We usually get the argument <code>dhat</code> by means of the function <code>d_hat</code> within our package.
The value <code>M_0</code> and the vector <code>par0</code> are used for the optimization process for finding the optimal instrumental density h. Usually, we choose <code>M_0</code> to be the central point of the range. For example, if the range is from <code>0</code> to <code>30</code>, we choose <code>15</code> as starting point. The choice of <code>M_0</code> is not expected to affect substantially the accuracy of the solution. The vector <code>par0</code> collects initial values for the parameters which characterize the instrumental density. For instance, if <code>h</code> is a mixuture of <code>p</code> truncated normals, the first <code>p-1</code> elements of <code>pis</code> correspond to the starting values
for the first <code>p-1</code> mixture weights. The following <code>p</code> elements are the initial values for the means of the <code>p</code> truncated normals contributing to the mixture. Finally, the last <code>p</code> elements of <code>par0</code> correspond to the starting values for the  standard deviations of the <code>p</code> truncated normals contributing to the mixture.
The argument <code>global</code>   controls whether to use a global optimization or not. A local method allows to reduce the optimization time but the solution is particularly sensible to the choice of <code>par0</code>. Conversely, setting <code>global=TRUE</code> leads to more accurate result.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Mstar</code></td>
<td>
<p>The reciprocal of the acceptance rate.</p>
</td></tr>
<tr><td><code>pis</code></td>
<td>
<p>The optimal set of mixture weights.</p>
</td></tr>
<tr><td><code>means</code></td>
<td>
<p>The optimal mean vector.</p>
</td></tr>
<tr><td><code>sds</code></td>
<td>
<p>The optimal set of standard deviations.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>Function corresponding to the optimal instrumental density.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sara Algeri and Xiangyu Zhang
</p>


<h3>References</h3>

<p>Algeri S. and Zhang X. (2020). Exhaustive goodness-of-fit via smoothed inference and graphics. arXiv:2005.13011.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+d_hat">d_hat</a></code>, <code><a href="#topic+find_h_disc">find_h_disc</a></code>, <code><a href="#topic+rmixtruncnorm">rmixtruncnorm</a></code>, <code><a href="#topic+dmixtruncnorm">dmixtruncnorm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library("truncnorm")
library("LPBkg")
L=0
U=30
range=c(L,U)
set.seed(12395)
meant=-15
sdt=15
n=300
data&lt;-rtruncnorm(n,a=L,b=U,mean=meant,sd=sdt)
poly2_num&lt;-function(x){4.576-0.317*x+0.00567*x^2}
poly2_den&lt;-integrate(poly2_num,lower=L,upper=U)$value
g&lt;-function(x){poly2_num(x)/poly2_den}
ddhat&lt;-d_hat(data,m=2,g, range=c(L,U), selection=FALSE)$dx
lb=c(0,-20,0,0,0)
ub=c(1,10,rep(30,3))
par0=c(0.3,-17,1,10,15)
range=c(L,U)
find_h_cont(data,g,ddhat,range,M_0=10,par0,lb,ub,ylim.f=c(0,0.25),ylim.d=c(-1,2))
</code></pre>

<hr>
<h2 id='find_h_disc'>
Finding optimal instrumental mass function.
</h2><span id='topic+find_h_disc'></span>

<h3>Description</h3>

<p>Finds the optimal probability mass function <code>h</code> to be used in the bidirectional acceptance sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_h_disc(data,g,dhat,lattice=NULL,M_0=NULL,size,par0=NULL,check.plot=TRUE,
       ylim.f=c(0,2),ylim.d=c(0,2),global=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_h_disc_+3A_data">data</code></td>
<td>

<p>A data vector.
</p>
</td></tr>
<tr><td><code id="find_h_disc_+3A_g">g</code></td>
<td>

<p>Function corresponding to the parametric start or postulated model. See details.
</p>
</td></tr>
<tr><td><code id="find_h_disc_+3A_dhat">dhat</code></td>
<td>

<p>Function corresponding to the estimated comparison density in the <code>x</code> domain. See details.
</p>
</td></tr>
<tr><td><code id="find_h_disc_+3A_lattice">lattice</code></td>
<td>

<p>Support of the discrete data distribution.
</p>
</td></tr>
<tr><td><code id="find_h_disc_+3A_size">size</code></td>
<td>

<p>A postive value corresponding to the target for number of successful trials.
</p>
</td></tr>
<tr><td><code id="find_h_disc_+3A_m_0">M_0</code></td>
<td>

<p>Starting point for optimization. See details.
</p>
</td></tr>
<tr><td><code id="find_h_disc_+3A_par0">par0</code></td>
<td>

<p>A vector of starting values of the parameters to be estimated. See details.
</p>
</td></tr>
<tr><td><code id="find_h_disc_+3A_check.plot">check.plot</code></td>
<td>

<p>A logical argument indicating if the plot comparing the densities involved should be displayed or not. The default is TRUE.
</p>
</td></tr>
<tr><td><code id="find_h_disc_+3A_ylim.f">ylim.f</code></td>
<td>

<p>If check.plot=TRUE, the range of the y-axis of the plot for the probability density functions.
</p>
</td></tr>
<tr><td><code id="find_h_disc_+3A_ylim.d">ylim.d</code></td>
<td>

<p>If check.plot=TRUE, the range of the y-axis of the plot for the comparison densities.
</p>
</td></tr>
<tr><td><code id="find_h_disc_+3A_global">global</code></td>
<td>

<p>A logical argument indicating if a global optimization is needed to find the instrumental probability function <code>h</code>. See details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parametric start specified in <code>g</code> is assumed to be fully specified and takes <code>x</code> as only argument. The argument <code>dhat</code> is the estimated comparison density in the <code>x</code> domain. We usually get the argument <code>dhat</code> by means of the function <code>d_hat</code> within our package.
The value <code>M_0</code> and the vector <code>par0</code> are used for the optimization process for finding the optimal instrumental density h. Usually, we could choose the <code>M_0</code> to be the central point of the <code>lattice</code>. For example, if the range is from <code>0</code> to <code>30</code>, we could choose <code>15</code> as the starting point. The choice of <code>M_0</code> is not expected to affect substantially the accuracy of the solution. The vector <code>par0</code> collects initial values for the parameters which characterize the instrumental probability mass function. For instance, if <code>h</code> is a mixuture of <code>p</code> negative binomials, the first <code>p-1</code> elements of <code>pis</code> correspond to the starting values
for the first <code>p-1</code> mixture weights. The following <code>p</code> elements are the initial values for the probablities of success of the <code>p</code> negative binomials contributing to the mixture. The argument <code>global</code>   controls whether to use a global optimization or not. A local method allows to reduce the optimization time but the solution is particularly sensible to the choice of <code>par0</code>. Conversely, setting <code>global=TRUE</code> leads to more accurate result.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Mstar</code></td>
<td>
<p>The reciprocal of the acceptance rate.</p>
</td></tr>
<tr><td><code>pis</code></td>
<td>
<p>The optimal set of mixture weights.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>The optimal set of probabilities of success.</p>
</td></tr>
<tr><td><code>h</code></td>
<td>
<p>Function corresponding to the optimal instrumental probability mass function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Xiangyu Zhang and Sara Algeri
</p>


<h3>References</h3>

<p>Algeri S. and Zhang X. (2020). Smoothed inference and graphics via LP modeling, arXiv:2005.13011.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+d_hat">d_hat</a></code>, <code><a href="#topic+find_h_cont">find_h_cont</a></code>, <code><a href="#topic+rmixtruncnorm">rmixtruncnorm</a></code>, <code><a href="#topic+dmixtruncnorm">dmixtruncnorm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>lattice=seq(0,20,length=21)
n=200
data&lt;-rbinom(n,size=20,prob=0.5)
g&lt;-function(x)dpois(x,10)/(ppois(20,10)-ppois(0,10))
ddhat&lt;-d_hat(data,m=1,g=g,lattice=lattice,selection=TRUE)$dx
find_h_disc(data=data,g=g,dhat=ddhat,lattice,M_0=10,size=15,par0=c(0.3,0.5,0.6),
            check.plot=TRUE,ylim.f=c(0,0.4),ylim.d=c(-3,2.5),global=FALSE)

</code></pre>

<hr>
<h2 id='rmixnegbinom'>
Random numbers generator for negative binomial mixtures
</h2><span id='topic+rmixnegbinom'></span>

<h3>Description</h3>

<p>Generates random samples from a mixture of negative binomials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmixnegbinom(n, pis, size, probs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmixnegbinom_+3A_n">n</code></td>
<td>

<p>Size of the random sample.
</p>
</td></tr>
<tr><td><code id="rmixnegbinom_+3A_pis">pis</code></td>
<td>

<p>A vector collecting the mixture weights. See details.
</p>
</td></tr>
<tr><td><code id="rmixnegbinom_+3A_size">size</code></td>
<td>

<p>A postive value corresponding to the target for number of successful trials. See details.
</p>
</td></tr>
<tr><td><code id="rmixnegbinom_+3A_probs">probs</code></td>
<td>

<p>A vector collecting the probabilities of success for every mixture component.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>pis</code> is a vector with  length equal the number of components in the mixture. The vector <code>pis</code> must sum up to one, e.g. <code>c(0.7, 0.2, 0.1)</code>.
All the negative binomials contributing to the mixture are assumed to have the same <code>size</code>.
</p>


<h3>Value</h3>

<p>A vector collecting the random sample of size <code>n</code> from the mixture of negative binomials specified.
</p>


<h3>Author(s)</h3>

<p>Xiangyu Zhang and Sara Algeri
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rmixtruncnorm">rmixtruncnorm</a></code>, <code><a href="#topic+dmixtruncnorm">dmixtruncnorm</a></code>, <code><a href="#topic+dmixnegbinom">dmixnegbinom</a></code>, <code><a href="#topic+find_h_disc">find_h_disc</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>rmixnegbinom(n=100,pis=c(0.3,0.6,0.1),size=2,probs=c(0.3,0.4,0.2))

</code></pre>

<hr>
<h2 id='rmixtruncnorm'>
Random numbers generator for truncated normal mixtures
</h2><span id='topic+rmixtruncnorm'></span>

<h3>Description</h3>

<p>Generates random samples from a mixture of truncated normals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmixtruncnorm(n, pis, means, sds, range)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmixtruncnorm_+3A_n">n</code></td>
<td>

<p>Size of the random sample.</p>
</td></tr>
<tr><td><code id="rmixtruncnorm_+3A_pis">pis</code></td>
<td>

<p>A vector collecting the mixture weights. See details.</p>
</td></tr>
<tr><td><code id="rmixtruncnorm_+3A_means">means</code></td>
<td>

<p>A vector collecting the means of the mixture components.
</p>
</td></tr>
<tr><td><code id="rmixtruncnorm_+3A_sds">sds</code></td>
<td>

<p>A vector collecting the standard deviations of the mixture components.
</p>
</td></tr>
<tr><td><code id="rmixtruncnorm_+3A_range">range</code></td>
<td>

<p>Interval corresponding to the support of each of  truncated normal contributing to the mixture. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>pis</code> is a vector with its length equal the number of components in the mixture. The vector <code>pis</code> must sum up to one, e.g. <code>c(0.7, 0.2, 0.1)</code>.
The argument <code>range</code> is an interval corresponding to the support of each  truncated normal contributing to the mixture.
</p>


<h3>Value</h3>

<p>A vector collecting the random sample of size <code>n</code> from the mixture of truncated specified.
</p>


<h3>Author(s)</h3>

<p>Sara Algeri and Xiangyu Zhang
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dmixtruncnorm">dmixtruncnorm</a></code>,<code><a href="#topic+dmixnegbinom">dmixnegbinom</a></code>, <code><a href="#topic+rmixnegbinom">rmixnegbinom</a></code>, <code><a href="#topic+find_h_cont">find_h_cont</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rmixtruncnorm(n=10,pis=c(0.5,0.5),means=c(3,6),sds=c(3,4),range=c(0,30))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
