<!DOCTYPE html><html lang="en"><head><title>Help for package ClimClass</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ClimClass}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ClimClass'><p>Classification of climate according to Koeppen - Geiger, of aridity indices, of continentality indices, of water balance after Thornthwaite, of viticultural bioclimatic indices. Drawing climographs: Thornthwaite, Peguy, Bagnouls-Gaussen.</p></a></li>
<li><a href='#arid'><p>Aridity indices</p></a></li>
<li><a href='#arid_ind_tables'><p>Aridity index</p></a></li>
<li><a href='#as.datcli'><p>as.datcli</p></a></li>
<li><a href='#bagn_gau'><p>Bagnouls - Gaussen graphs</p></a></li>
<li><a href='#clima_81_10'><p>Climatic normals of precipitation and temperatures</p></a></li>
<li><a href='#climate'><p>Climate normals</p></a></li>
<li><a href='#coeff_rad'><p>Radiative energy coefficients</p></a></li>
<li><a href='#contin'><p>Continentality indices</p></a></li>
<li><a href='#continental_ind_tables'><p>Continentality/oceanicity indices</p></a></li>
<li><a href='#coord_elev'><p>Geographical position for each meteorological station</p></a></li>
<li><a href='#ExAtRa'><p>Extra-Atmospheric Radiation</p></a></li>
<li><a href='#koeppen_geiger'><p>Koeppen - Geiger's climate classification</p></a></li>
<li><a href='#lista_cli'><p>Dataset of meteorological measures</p></a></li>
<li><a href='#oiv_ind'><p>OIV bioclimatic indices for viticulture</p></a></li>
<li><a href='#P'><p>Precipitation</p></a></li>
<li><a href='#peguy'><p>Peguy Climograph</p></a></li>
<li><a href='#plot.thornthwaite'><p>Thornthwaite - Mather's quantile plot</p></a></li>
<li><a href='#quantiles'><p>Monthly quantiles of the meteorological variables</p></a></li>
<li><a href='#RDI'><p>Riou's drought index</p></a></li>
<li><a href='#thornt_lst'><p>Input for the Thornthwaite function</p></a></li>
<li><a href='#thornthwaite'><p>Thornthwaite and Mather's water balance</p></a></li>
<li><a href='#Tm'><p>Mean daily temperature</p></a></li>
<li><a href='#Tn'><p>Minimum daily temperature</p></a></li>
<li><a href='#Trent_climate'><p>Data set of Trentino climate</p></a></li>
<li><a href='#Tx'><p>Maximum daily temperature</p></a></li>
<li><a href='#W_balance'><p>Water balance</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Climate Classification According to Several Indices</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-08-07</td>
</tr>
<tr>
<td>Description:</td>
<td>Classification of climate according to Koeppen - Geiger, of aridity
    indices, of continentality indices, of water balance after Thornthwaite, of
    viticultural bioclimatic indices. Drawing climographs: Thornthwaite, Peguy,
    Bagnouls-Gaussen.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 2.10.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>geosphere, ggplot2, reshape2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>stringr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-08-04 13:19:54 UTC; fabio</td>
</tr>
<tr>
<td>Author:</td>
<td>Emanuele Eccel [aut, cre],
  Emanuele Cordano [aut],
  Giambattista Toller [aut],
  Fondazione Edmund Mach [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emanuele Eccel &lt;emanuele.eccel@fmach.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-08-04 21:43:32</td>
</tr>
</table>
<hr>
<h2 id='ClimClass'>Classification of climate according to Koeppen - Geiger, of aridity indices, of continentality indices, of water balance after Thornthwaite, of viticultural bioclimatic indices. Drawing climographs: Thornthwaite, Peguy, Bagnouls-Gaussen.</h2><span id='topic+ClimClass'></span><span id='topic+ClimClass-package'></span>

<h3>Description</h3>

<p>Classification of climate according to Koeppen - Geiger, of aridity indices, of continentality indices, of water balance after Thornthwaite, of viticultural bioclimatic indices. Drawing climographs: Thornthwaite, Peguy, Bagnouls-Gaussen.
</p>


<h3>ClimClass functions</h3>

<p>The package collects several criteria for climate classification. The most general is Koeppen - Geiger's classification, as described in Trewartha (1980), implemented in function <code><a href="#topic+koeppen_geiger">koeppen_geiger</a></code>. 
Almost all sub-classes have been considered, with the only exception of those whose 
attribution is based on qualitative assessment of climatic features. 
</p>
<p>A classic graphical visualization of temperature and precipitation, according to 
Bagnouls and Gaussen (1953), is provided by function <code><a href="#topic+bagn_gau">bagn_gau</a></code>. A 
similar, but more sophisticated representation of the same variable, is that of 
Walter - Lieth (Lieth et al., CD). This function is implemented in 
library <code>climatol</code> (http://www.climatol.eu/).
</p>
<p>Function <code><a href="#topic+arid">arid</a></code> calculates a set of six annual aridity indices (Emberger, 1955; 
Lang, R., 1920; Rivas - Martinez, (website); and UNEP, 1997; De Martonne, 1925; Thornthwaite
, 1948). For the latter two also a monthly index is calculated.
</p>
<p>A set of five continentality indices is proposed by function <code><a href="#topic+contin">contin</a></code> 
(Gorczynski, L., 1920; Conrad, 1946; Gams, 1932; Rivas - Martinez, web page; 
Amann, 1929).
</p>
<p>Thornthwaite's method for the assessment of soil water balance (Thornthwaite, 1948; 
Thornthwaite and Mather, 1955; Thornthwaite and Mather, 1957) makes use of monthly 
series to calculate the main quantities in water balance: evapotranspiration, 
soil water deficit, soil water surplus. From these series, quantiles are calculated 
for every month, to infer climatic features concerning soil water. 
</p>
<p>Function <code><a href="#topic+thornthwaite">thornthwaite</a></code> provides such analysis, and function <code><a href="base.html#topic+plot">plot</a></code> 
manages the plot of the quantiles of the relevant quantities.
</p>
<p>The assessment of potential evapotranspiration by Thornthwaite and Mather's algorithm 
requires the estimation of extra-atmospheric radiation, which is calculated by 
function <code><a href="#topic+ExAtRa">ExAtRa</a></code>, based on the algorithm of Allen et al., 2005.
</p>
<p>Function <code><a href="#topic+as.datcli">as.datcli</a></code> tranforms a data frame as in example dataset 
<code><a href="#topic+Trent_climate">Trent_climate</a></code> into a data frame format like <code>datcli</code> in 
<code>climatol</code> package. It can be used to plot Walter - Lieth's climographs 
(see examples documentation).
</p>
<p>Function <code><a href="#topic+oiv_ind">oiv_ind</a></code> calculates several bioclimatic indices for 
viticulture proposed by the International Organization of Viticuture, OIV 
(Resolution OIV-VITI 423-2012), plus one index (Branas). One index of OIV's 
list, Riou's drought index, needing daily series, is calculated by another 
function, <code><a href="#topic+RDI">RDI</a></code>.
</p>
<p>The data set included in the library is formed by monthly and daily time 
series of temperature and precipitation from Trentino, Italy 
(courtesy of Autonomous Province of Trento - Meteotrentino, and of 
Fondazione Edmund Mach, San Michele all'Adige). Climatic normals are 
calculated, too (output of function <code><a href="#topic+climate">climate</a></code>). The output 
of function <code><a href="#topic+thornthwaite">thornthwaite</a></code> is present in the data set 
<code><a href="#topic+Trent_climate">Trent_climate</a></code>, as input for function <code><a href="base.html#topic+plot">plot</a></code>. 
</p>
<p>Reference tables for aridity and continentality indices are provided as 
lists, to rank the classifications on standard scales 
(<code><a href="#topic+arid_ind_tables">arid_ind_tables</a></code> and <code><a href="#topic+continental_ind_tables">continental_ind_tables</a></code>, 
respectively).
</p>
<p>See a first application in Eccel et al., 2015 and an application more 
focused on viticultural indices in Eccel et al., 2016.
</p>


<h3>References</h3>

<p>Allen, R.G., Walter, I.A., Elliott, R.L., Howell, T.A., 
Itenfisu, D., Jensen, M.E., and Snyder, R.L. (eds.), 2005: ASCE 
Standardized Reference Evapotranspiration Equation. 216 pp.
</p>
<p>Amann, J., 1929: L'hygrothermie du climat, facteur 
determinant la repartition des especes atlantiques. Revue Bryol., 56:126-133.
</p>
<p>Amerine, M.A., and Winkler, A.J., 1944: Composition and 
quality of musts and wines of California grapes. Hilgardia. 15(6): 493-673.
xerothermique. Docum. pour les Cartes des Prod. Veget. Serie: Generalite, 
1 (1953), pp. 1-49.
</p>
<p>Conrad, V. 1946: Usual formulas of continentality and their 
limits of validity. Transactions, American Geophysical Union, Volume 
27, Issue 5, p. 663-664
</p>
<p>De Martonne E., 1925: Traite de Geographie Physique: 3 tomes, Paris.
</p>
<p>Eccel, E., Cordano, E., Zottele, F., Toller, GB., 2015: ClimClass and 
ClimClassMap: two R- packages for climatic and agro-bioclimatic indices. 
An application to Trentino. XVIII National Congress of Agrometeorology, 
9-11 June 2015, San Michele all'Adige
all\'Adige, Book of Extended Abstract (available from Autors).
</p>
<p>Eccel, E.,  Zollo, A.L.,  Mercogliano, P., Zorer, R., 2016: Simulations 
of quantitative shift in bio-climatic indices in the viticultural areas of Trentino 
(Italian Alps) by an open source R package. 
Computers and Electronics in Agriculture 127 (2016) 92-100.
</p>
<p>Emberger, L., 1955: Une classification biogeographique des climats. 
Receuil des travaux des laboratoires de botanique, geologie et zoologie de la 
faculte des sciences de l'universite de Montpellier (Serie Botanique), Fascicule 7, 3-43.
</p>
<p>Eynard, I. e Dal Masso, G., 1990: Viticoltura moderna. Manuale pratico. 
Hoepli Milano. 778 pp.
</p>
<p>Fregoni, C., et  Pezzutto, S., 2000: Principes et premieres approches 
de l'indice bioclimatique de qualite Fregoni, Progr.Agric.Vitic. 117: 390-396.
</p>
<p>Gams, H., 1932: Die klimatische Begrenzung von Pflanzenarealen und die 
Verteilung der hygrischen Kontinentalitaet in den Alpen. Zeitschr. Ges. Erdkunde, Berlin.
</p>
<p>Gladstones, J.S., 2004: Climate and Australian Viticulture. In 'Viticulture. 
Volume 1-Resources'. (Eds Dry PR, Coombe BG) pp. 90-118.
</p>
<p>Huglin, M.P., 1978: Nouveau mode d'evaluation des possibilites heliothermiques 
d'un milieu viticole. Comptes Rendus de l'Academie de l'Agriculture de France. 64: 1117-1126.
</p>
<p>Gorczynski, L., 1920: Sur le calcul du degre de continentalisme et son application
dans la climatologie. Geografiska Annaler 2, 324-331
</p>
<p>Hargreaves, G.H., and Samani, Z.A., 1985: Reference crop evapotranspiratin 
from temperature. Applied Engineering in Agriculture, 1(2):96-99
</p>
<p>Lang, R., 1920: Verwitterung und Bodenbildung als Einfuehrung in die Bodenkunde. 
Schweizerbart Science Publishers, Stuttgart
</p>
<p>Lebourgeoise, F., 2010: Cours de bioclimatologie a l'usage des forestiers. 
Departement SIAFEE, UFR Forets, Arbres et Milieux Naturels. ENGREF, Nancy Cedex.
</p>
<p>Lieth, H., Berlekamp, J., Fuest, S., and Riediger, S.: Walter-Lieth: Climate 
Diagram World Atlas, CD-Series I of Climate and Biosphere, 1st edit.
</p>
<p>Michalet, R., and Souchier, B., 1991: Une approche synthetique biopedoclimatique 
des montagnes mediterraneennes: l'exemple du Maroc septemptrional. 
Thesis, Univ. J. Fourier, Grenoble, 273 pp
</p>
<p>Rivas-Martinez: <a href="http://www.globalbioclimatics.org/">http://www.globalbioclimatics.org/</a>
</p>
<p>Thornthwaite, C. W., 1948: An Approach toward a Rational Classification of Climate. 
Geographical Review, Vol. 38, No. 1(Jan.):55-94.
</p>
<p>Thornthwaite, C. W., and Mather, J.R., 1955: The water balance.  Publications in 
Climatology, Volume 8(1), Laboratory of Climatology
</p>
<p>Thornthwaite, C. W., and Mather, J.R., 1957: Instructions and tables for 
computing potential evapotranspiration and the water balance.  Publications in climatology, 
Volume 10(3), Laboratory of Climatology.
</p>
<p>Tonietto, J., and Carbonneau, A., 2004: A multicriteria climatic classification 
system for grape-growing regions worldwide. Agricultural and Forest Meteorology. 124(1/2): 
81-97.
</p>
<p>Trewartha, G.T. and Lyle, H.H., 1980: An Introduction to Climate. MacGraw - Hill, 
5th Ed. Appendix: Koeppen's Classification of Climates.
</p>
<p>UNEP (United Nations Environment Programme), 1997: World atlas of desertification 
2ED. UNEP, London
</p>

<hr>
<h2 id='arid'>Aridity indices</h2><span id='topic+arid'></span>

<h3>Description</h3>

<p>Calculates aridity according to several indices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arid(clim_norm, coeff_rad = NULL, coeff_Hargr = rep(0.75, 12),
  monthly = FALSE, indices = 1:6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arid_+3A_clim_norm">clim_norm</code></td>
<td>
<p>climatic normals</p>
</td></tr>
<tr><td><code id="arid_+3A_coeff_rad">coeff_rad</code></td>
<td>
<p>mean monthly solar radiation; used only for Thornthwaite's annual index Im. Default is <code>NULL</code></p>
</td></tr>
<tr><td><code id="arid_+3A_coeff_hargr">coeff_Hargr</code></td>
<td>
<p>(vector of monthly) correction coefficient(s) for Hargreaves' equation</p>
</td></tr>
<tr><td><code id="arid_+3A_monthly">monthly</code></td>
<td>
<p>logic. Sets calculation to the monthly mode if <code>TRUE</code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="arid_+3A_indices">indices</code></td>
<td>
<p>set of aridity indices to be listed. Default is all indices (1 to 6 for annual, 1 to 2 for monthly).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>clim_norm</code> is a monthly data frame of climate normals, with column names: &quot;P&quot;, &quot;Tn&quot;, &quot;Tx&quot;, &quot;Tm&quot; (precipitation, minimum, maximum and mean temperature, respectively). It can be the output of function <code><a href="#topic+climate">climate</a></code>.
</p>
<p>Monthly potential evapotranspiration (PE) is calculated via the Hargreaves' formula (Hargreaves and Samani, 1985):
</p>
<p>PE = (0.0023*(clim_norm$Tx - clim_norm$Tn)^(0.5)*(clim_norm$Tm+17.8)*coeff_rad)* lmv * coeff_Hargr
</p>
<p>where Tn, Tx, Tm are min, max, and mean temperatures, respectively, and lmv is the number of days in any month.
</p>
<p><code>coeff_rad</code> and <code>coeff_Hargr</code> are needed only by Thornthwaite's annual index <code>Im</code> and UNEP's <code>Ai</code> index, whose PE term is calculated via Hargreaves' equation.
</p>
<p><code>coeff_rad</code> corresponds to the mean monthly extra-atmospheric radiation (see function <code><a href="#topic+ExAtRa">ExAtRa</a></code>). 
</p>
<p><code>coeff_Hargr</code> is either a single value or a vector of 12 coefficients to adjust Hargreaves' estimation of potential evapotranspiration (implemented in <code>Im</code> and <code>Ai</code> indices). From calibration in 6 stations from the same network of <code><a href="#topic+Trent_climate">Trent_climate</a></code>, its average value is 0.75.
</p>
<p>When <code>monthly</code> is <code>TRUE</code>, a data frame with monthly detail is generated for one station, instead of a synthetic single-line data frame.
</p>
<p><code>indices</code>' values are the following:
</p>
<p>1 De Martonne - Ia (annual or monthly). De Martonne, 1925.
</p>
<p>2 Thornthwaite - Im (annual or monthly). Thornthwaite, 1948.
</p>
<p>3 Emberger - Q (annual only). Emberger, 1955.
</p>
<p>4 Lang - R (annual only) - only for positive mean annual temperature. Lang, R., 1920.
</p>
<p>5 Rivas-Martinez - Io (annual only). Rivas - Martinez, website http://www.globalbioclimatics.org/
</p>
<p>6 UNEP - Ai (annual only). UNEP, 1997.
</p>
<p>A reference for the aridity degree for any index is given in the list object <code>arid_ind_tables</code> (see <code><a href="#topic+Trent_climate">Trent_climate</a></code>.
</p>


<h3>Value</h3>

<p>Either a single-line data frame (when <code>monthly = FALSE</code>) with the desired aridity index(es), or a data frame (<code>monthly = TRUE</code>), with monthly values of the desired index(es).
</p>


<h3>Author(s)</h3>

<p>Emanuele Eccel
</p>


<h3>References</h3>

<p>De Martonne E., 1925: Traite de Geographie Physique: 3 tomes, Paris.
</p>
<p>Emberger, L., 1955. Une classification biogeographique des climats. Receuil des travaux des laboratoires de botanique, geologie et zoologie de la faculte des sciences de l'universite de Montpellier (Serie Botanique), Fascicule 7, 3-43.
</p>
<p>Hargreaves, G.H., and Samani, Z.A., 1985. Reference crop evapotranspiratin from temperature. Applied Engineering in Agriculture, 1(2):96-99
</p>
<p>Lang, R., 1920. Verwitterung und Bodenbildung als Einfuehrung in die Bodenkunde. Schweizerbart Science Publishers, Stuttgart
</p>
<p>Rivas-Martinez -  http://www.globalbioclimatics.org/
</p>
<p>Thornthwaite, C. W., 1948: An Approach toward a Rational Classification of Climate. Geographical Review, Vol. 38, No. 1(Jan.):55-94.
</p>
<p>UNEP (United Nations Environment Programme), 1997. World atlas of desertification 2ED. UNEP, London.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+climate">climate</a></code>, <code><a href="#topic+ExAtRa">ExAtRa</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Trent_climate)
# clima_81_10 is a list of data frames having climatic means of temperature and precipitation 
# as required by the aridity indices algorithms, each one referring to one station. 
# It can be the output of function climate.
# coeff_rad is a monthly vector of average daily extra-atmospheric solar radiation, 
# calculated e.g. by function ExAtRa.

</code></pre>

<hr>
<h2 id='arid_ind_tables'>Aridity index</h2><span id='topic+arid_ind_tables'></span>

<h3>Description</h3>

<p>Used for reference in aridity indices assessment (see function <code><a href="#topic+arid">arid</a></code> and 
references for data sources).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>List formed by six data frames.</p>

<hr>
<h2 id='as.datcli'>as.datcli</h2><span id='topic+as.datcli'></span>

<h3>Description</h3>

<p>Tranforms a data frame (see example dataset) into a data frame format like  '<code>datcli</code>' in '<code>climatol</code>' package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.datcli(df, station, MonthField = "month", PrecField = "P",
  MinTempField = "Tn", MaxTempField = "Tx", MeanTempField = "Tm",
  AbsMinTempField = "AbsTn", AbsMinTempOffset = 4,
  StationField = "station")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.datcli_+3A_df">df</code></td>
<td>
<p>data frame or list</p>
</td></tr>
<tr><td><code id="as.datcli_+3A_station">station</code></td>
<td>
<p>name</p>
</td></tr>
<tr><td><code id="as.datcli_+3A_monthfield">MonthField</code></td>
<td>
<p>character string for month field in <code>df</code>. Default is <code>"month"</code>.</p>
</td></tr>
<tr><td><code id="as.datcli_+3A_precfield">PrecField</code></td>
<td>
<p>character string for Mean Precipitation field in <code>df</code>. Default is <code>"P"</code>.</p>
</td></tr>
<tr><td><code id="as.datcli_+3A_mintempfield">MinTempField</code></td>
<td>
<p>character string  for Mean Daily Minimum Temperature field in <code>df</code>. Default is <code>"Tn"</code>.</p>
</td></tr>
<tr><td><code id="as.datcli_+3A_maxtempfield">MaxTempField</code></td>
<td>
<p>character string  for Mean Daily Maximum Temperature field in <code>df</code>. Default is <code>"Tx"</code>.</p>
</td></tr>
<tr><td><code id="as.datcli_+3A_meantempfield">MeanTempField</code></td>
<td>
<p>character string for Mean Daily Maximum Temperature field in <code>df</code>. Default is <code>"Tm"</code>.</p>
</td></tr>
<tr><td><code id="as.datcli_+3A_absmintempfield">AbsMinTempField</code></td>
<td>
<p>character string for Absolute Monthly Minimum Temperature field in <code>df</code>. Default is <code>"AbsTn"</code>.</p>
</td></tr>
<tr><td><code id="as.datcli_+3A_absmintempoffset">AbsMinTempOffset</code></td>
<td>
<p>estimated offset between Average Min Temperature and  Absolute Min Temperature.</p>
</td></tr>
<tr><td><code id="as.datcli_+3A_stationfield">StationField</code></td>
<td>
<p>character string for Station  field in <code>df</code>. Default is <code>"station"</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emanuele Cordano
</p>


<h3>See Also</h3>

<p><a href="www.climatol.eu">www.climatol.eu</a>, <a href="http://www.zoolex.org/walter.html">http://www.zoolex.org/walter.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Not Run!! 
# Install 'climatol' from 'http://www.climatol.eu/' first
### Then load the package, uncomment and run the following line
# library(climatol)
	library(stringr)
 data(Trent_climate)

 TrentinoClimateDf &lt;- do.call(rbind,clima_81_10)
 names &lt;- rownames(TrentinoClimateDf)
 TrentinoClimateDf$station &lt;- 
 unlist(lapply(X=str_split(names,pattern="[.]"),FUN=function(x) {x[1]}))
 

 station &lt;- "T0129"
datcli &lt;- as.datcli(TrentinoClimateDf,station=station)

### Not Run!! 
# Install 'climatol' from 'http://www.climatol.eu/' first
### Then load the package, uncomment and run the following line
# diagwl(datcli,est=station,alt=100,per="Period",mlab="en") ## plots a Walter-Lieth's climograph

</code></pre>

<hr>
<h2 id='bagn_gau'>Bagnouls - Gaussen graphs</h2><span id='topic+bagn_gau'></span>

<h3>Description</h3>

<p>Plots Bagnouls - Gaussen climatic charts of precipitation and temperature. Conventionally, in this chart the scale of precipitation has a double extension with respect to the scale of temperature (Bagnouls and Gaussen, 1953).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bagn_gau(clim_norm_sta, save_dir = NULL, format = NULL, main_title = NULL,
  st_name = NULL, trace_grid = TRUE, tick_step = 20, bar_width = 30,
  bar_col = "grey", trace_0.line = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bagn_gau_+3A_clim_norm_sta">clim_norm_sta</code></td>
<td>
<p>data frame with climatic normals</p>
</td></tr>
<tr><td><code id="bagn_gau_+3A_save_dir">save_dir</code></td>
<td>
<p>name of destination directory for graphs (if any).</p>
</td></tr>
<tr><td><code id="bagn_gau_+3A_format">format</code></td>
<td>
<p>graphical format of graphs; default is NULL.</p>
</td></tr>
<tr><td><code id="bagn_gau_+3A_main_title">main_title</code></td>
<td>
<p>main title for all charts; e.g., it may include references to station id. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="bagn_gau_+3A_st_name">st_name</code></td>
<td>
<p>name to be included into graphs titles. Only for file output. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="bagn_gau_+3A_trace_grid">trace_grid</code></td>
<td>
<p>logic. If <code>TRUE</code> (default) adds a grid.</p>
</td></tr>
<tr><td><code id="bagn_gau_+3A_tick_step">tick_step</code></td>
<td>
<p>step for Y axis (precipitation). Default is 20 (mm)</p>
</td></tr>
<tr><td><code id="bagn_gau_+3A_bar_width">bar_width</code></td>
<td>
<p>width of bars in the chart. Default is 30.</p>
</td></tr>
<tr><td><code id="bagn_gau_+3A_bar_col">bar_col</code></td>
<td>
<p>color of bars. Default is &quot;grey&quot;.</p>
</td></tr>
<tr><td><code id="bagn_gau_+3A_trace_0.line">trace_0.line</code></td>
<td>
<p>logic. If <code>TRUE</code> (default), a line at P = 0 and T = 0 is traced.</p>
</td></tr>
<tr><td><code id="bagn_gau_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods, such as graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>clim_norm_sta</code> can be e.g. one element of the output of function <code><a href="#topic+climate">climate</a></code>. See <code>examples</code>.
</p>
<p>If <code>format</code> is NULL (default), graphs are sent to the console. Otherwise, a file is produced and saved. <code>format</code> is used only if the graphs are to be sent to files. Values allowed are: &quot;png&quot;, &quot;jpeg&quot;, &quot;tiff&quot;, &quot;bmp&quot;.
</p>
<p>If one or more data are missing, the chart is not processed.
</p>
<p>Most graphic parameters for functions <code><a href="base.html#topic+plot">plot</a></code>, <code><a href="graphics.html#topic+axis">axis</a></code>, and <code><a href="graphics.html#topic+mtext">mtext</a></code> are accepted.
</p>


<h3>Value</h3>

<p>Bagnouls - Gaussen's charts of precipitation and temperature.
</p>


<h3>Note</h3>

<p>A conflict is generated if parameters already used by the function are passed (e.g. <code>col</code> - use <code>col.main</code>, <code>col.axis</code>, ..., instead).
</p>


<h3>Author(s)</h3>

<p>Emanuele Eccel
</p>


<h3>References</h3>

<p>Bagnouls, F., and Gaussen, H., 1953: Saison seche et indice xerothermique. Docum. pour les Cartes des Prod. Veget. Serie: Generalite, 1 (1953), pp. 1-49
</p>


<h3>See Also</h3>

<p><code><a href="#topic+climate">climate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Trent_climate)
# clima_81_10 can be generated from monthly time series by function "climate".
par(ask=TRUE)
for(sta in 1:length(clima_81_10)) {
  bagn_gau(clim_norm_sta= clima_81_10 [[sta]], 
   main_title=paste(names(clima_81_10[sta]), "  1981-2010")
	, bar_width=40)
}


</code></pre>

<hr>
<h2 id='clima_81_10'>Climatic normals of precipitation and temperatures</h2><span id='topic+clima_81_10'></span>

<h3>Description</h3>

<p>Climatic normals of precipitation and temperature (minimum, maximum, and mean) for the 
climatic period 1981 - 2010. It has been calculated by function <code><a href="#topic+climate">climate</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>A list (one table for each station) of 28 monthly climatic normals</p>

<hr>
<h2 id='climate'>Climate normals</h2><span id='topic+climate'></span>

<h3>Description</h3>

<p>Creates climate mean monthly values from a monthly series of temperature and precipitation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climate(series, first.yr = NULL, last.yr = NULL, max.perc.missing)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="climate_+3A_series">series</code></td>
<td>
<p>the monthly series of temperature and precipitation.</p>
</td></tr>
<tr><td><code id="climate_+3A_first.yr">first.yr</code></td>
<td>
<p>first year of the period over which climatology is calculated</p>
</td></tr>
<tr><td><code id="climate_+3A_last.yr">last.yr</code></td>
<td>
<p>last year of the period over which climatology is calculated</p>
</td></tr>
<tr><td><code id="climate_+3A_max.perc.missing">max.perc.missing</code></td>
<td>
<p>maximum acceptable percentage of missing data in the averaging period from <code>first.yr</code> to <code>last.yr</code> (0-99).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>series</code> is a data frame with years, months, temperature (and precipitation) values. Names in series columns must include: year, month, Tn and Tx (minimum and maximum temperatures, respectively) or, as an alternative, Tm (mean temperatures).
</p>
<p>If <code>first.yr</code> or  <code>last.yr</code> are NULL (default), the lowest and highest values in series are taken as the period.
</p>


<h3>Value</h3>

<p>A data frame with climatic monthly values of: precipitation, minimum and maximum temperatures (if existing in series), mean temperature (either averaged from existing values in series, or calculated by the function as (Tn + Tx)/2), absolute minimum monthly temperature.
</p>


<h3>Author(s)</h3>

<p>Emanuele Eccel
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Trent_climate)

# clima_81_10 is a list of data frames of the type series, 
# each one referring to one station 
# having climatic means of temperature and precipitation 

clima_81_10&lt;-lapply(lista_cli, FUN=climate, first.yr=1981, last.yr=2010, max.perc.missing=15)

</code></pre>

<hr>
<h2 id='coeff_rad'>Radiative energy coefficients</h2><span id='topic+coeff_rad'></span>

<h3>Description</h3>

<p>&quot;Radiative energy coefficients&quot; for Hargreaves' equation, corresponding to the 
daily extra-atmospheric solar radiation energy. It is the output of function 
<code><a href="#topic+ExAtRa">ExAtRa</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>An array of 12 numerics</p>

<hr>
<h2 id='contin'>Continentality indices</h2><span id='topic+contin'></span>

<h3>Description</h3>

<p>Calculates climate continentality / oceanicity according to several indices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contin(clim_norm, latitude = NULL, elevation = NULL,
  Michalet_correction = FALSE, indices = 1:5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contin_+3A_clim_norm">clim_norm</code></td>
<td>
<p>climatic normals</p>
</td></tr>
<tr><td><code id="contin_+3A_latitude">latitude</code></td>
<td>
<p>station latitude in degrees. Used in Gorczynski's and Conrad's classifications (indices 1 and 2). Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="contin_+3A_elevation">elevation</code></td>
<td>
<p>station elevation in m. Used in Gams' classification (index 3). Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="contin_+3A_michalet_correction">Michalet_correction</code></td>
<td>
<p>logic: if <code>TRUE</code>, Michalet's correction is applied to index 3 (Gams). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="contin_+3A_indices">indices</code></td>
<td>
<p>set of aridity indices to be listed. Default is all indices (1 to 5).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>clim_norm is a monthly data frame of climate normals, with column names: &quot;P&quot;, &quot;Tn&quot;, &quot;Tx&quot;, &quot;Tm&quot; (precipitation, minimum, maximum and mean temperature, respectively). It can be the output of function <code><a href="#topic+climate">climate</a></code>.
</p>
<p><code>indices</code>' values are the following:
</p>
<p>1: Gorczynski - K.G. (Gorczynski, L., 1920).
</p>
<p>2: Conrad - K.C. (Conrad, 1946).
</p>
<p>3: Gams - alpha. (Gams, H., 1932). For Michalet's correction: Michalet and Souchier, 1991.
</p>
<p>4: Rivas-Martinez - Ic. (Rivas - Martinez, web page).
</p>
<p>5: Amann - H. (Amann, 1929)
</p>
<p>A reference for the continentality / oceanicity degree is given in the list object <code>continental_ind_tables</code> of data set <code><a href="#topic+Trent_climate">Trent_climate</a></code>.
</p>
<p>If Michalet's correction is applied to Gams' hygric continentality index, the value of precipitation is proportionally diminished for elevations below 900 m a.s.l. See also Lebourgeoise, 2010.
</p>


<h3>Value</h3>

<p>A single-line data frame with the desired continentality index(es).
</p>


<h3>Author(s)</h3>

<p>Emanuele Eccel
</p>


<h3>References</h3>

<p>Amann, J., 1929: L'hygrothermie du climat, facteur determinant la repartition des especes atlantiques. Revue Bryol., 56:126-133.
</p>
<p>Conrad, V., 1946: Usual formulas of continentality and their limits of validity. Transactions, American Geophysical Union, Volume 27, Issue 5, p. 663-664.
</p>
<p>Gams, H., 1932: Die klimatische Begrenzung von Pflanzenarealen und die Verteilung der hygrischen Kontinentalitaet in den Alpen. Zeitschr. Ges. Erdkunde, Berlin.
</p>
<p>Gorczynski, L., 1920: Sur le calcul du degre de continentalisme et son application dans la climatologie. Geografiska Annaler 2, 324-331.
</p>
<p>Lebourgeoise, F., 2010: Cours de bioclimatologie a l'usage des forestiers. Departement SIAFEE, UFR Forets, Arbres et Milieux Naturels. ENGREF, Nancy Cedex.
</p>
<p>Michalet, R., and Souchier, B., 1991: Une approche synthetique biopedoclimatique del montagnes mediterraneennes: l'exemple du Maroc septemptrional. Thesis, Univ. J. Fourier, Grenoble, 273 pp.
</p>
<p>Rivas-Martinez: http://www.globalbioclimatics.org/.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+climate">climate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Trent_climate)


# clima_81_10 is a list of data frames having climatic means of temperature and precipitation as 
# required by the aridity indices algorithms, each one referring to one station. 
# It can be the output of function climate.

# creates a data frame with all the continentality indices for all stations in clima_81_10

latit&lt;-coord_elev$North
elev&lt;-coord_elev$Elevation

contin_I&lt;-NULL
for(i in 1:length(clima_81_10)) {
  contin_I[[i]]&lt;-contin(clima_81_10[[i]], 
   latitude=latit[i], 
   elevation=elev[i], 
   Michalet_correction=TRUE)
}
names(contin_I)&lt;-names(clima_81_10)

</code></pre>

<hr>
<h2 id='continental_ind_tables'>Continentality/oceanicity indices</h2><span id='topic+continental_ind_tables'></span>

<h3>Description</h3>

<p>Used for reference in continentality/oceanicity indices assessment (see function 
<code><a href="#topic+contin">contin</a></code> and references for data sources).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>List of 4 data frames</p>

<hr>
<h2 id='coord_elev'>Geographical position for each meteorological station</h2><span id='topic+coord_elev'></span>

<h3>Description</h3>

<p>Coordinates and elevation for each station in the data set. Coordinates are geographical 
and elevation is measured in meters above mean sea level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>Data frame of 40 observations of 4 variables</p>

<hr>
<h2 id='ExAtRa'>Extra-Atmospheric Radiation</h2><span id='topic+ExAtRa'></span>

<h3>Description</h3>

<p>Calculates Extra-Atmospheric Radiation. Called by function <code><a href="#topic+arid">arid</a></code> for Thornthwaite's index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExAtRa(DOY, latitude, Gsc = 0.082, unit = "mm", T = 12)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ExAtRa_+3A_doy">DOY</code></td>
<td>
<p>day of the year.</p>
</td></tr>
<tr><td><code id="ExAtRa_+3A_latitude">latitude</code></td>
<td>
<p>latitude in degrees (negative for S emishpere).</p>
</td></tr>
<tr><td><code id="ExAtRa_+3A_gsc">Gsc</code></td>
<td>
<p>solar constant in MJ m-2 min-1 (default: 0.0820).</p>
</td></tr>
<tr><td><code id="ExAtRa_+3A_unit">unit</code></td>
<td>
<p>unit for solar radiation. Accepted values are &quot;mm&quot; and &quot;MJ&quot;.</p>
</td></tr>
<tr><td><code id="ExAtRa_+3A_t">T</code></td>
<td>
<p>temperature in degrees C. Default is 12.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>unit</code> = &quot;mm&quot;, the calculated value represents the water height evaporated by solar radiation, calculated by the latent heat for vaporization. Otherwise (<code>unit</code> = &quot;MJ&quot;) output is the solar radiation energy in MJ.
Temperature <code>T</code> is used only for the assessment of latent heat of vaporization, when <code>unit</code> = &quot;mm&quot;.
</p>


<h3>Value</h3>

<p>The daily extra-atmospheric solar radiation energy, espressed either in MJ or in mm of evaporated water.
</p>


<h3>Author(s)</h3>

<p>Emanuele Eccel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+arid">arid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Trent_climate)
# creates a vector with middle days for every month in a year
quinci   &lt;- paste(15,"/",1:12,"/",2014,sep="")
posixlt  &lt;- strptime(quinci, format="%d/%m/%Y")
yDay     &lt;- posixlt$yday+1  # field yday starts from 0
latitude&lt;-46  

# generates 12 values, one for each month
coeff_rad&lt;- ExAtRa(DOY=yDay,latitude=latitude, unit="mm")

</code></pre>

<hr>
<h2 id='koeppen_geiger'>Koeppen - Geiger's climate classification</h2><span id='topic+koeppen_geiger'></span>

<h3>Description</h3>

<p>General climate classification after Koeppen - Geiger.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>koeppen_geiger(clim_norm, A_B_C_special_sub.classes = FALSE,
  clim.resume_verbose = TRUE, class.nr = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="koeppen_geiger_+3A_clim_norm">clim_norm</code></td>
<td>
<p>average values (climate normals) for the desired period.</p>
</td></tr>
<tr><td><code id="koeppen_geiger_+3A_a_b_c_special_sub.classes">A_B_C_special_sub.classes</code></td>
<td>
<p>logical. Sets if calculations have to consider sub-classes based on rain features in climate types A, B, and C  (see details). Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="koeppen_geiger_+3A_clim.resume_verbose">clim.resume_verbose</code></td>
<td>
<p>logical. If <code>TRUE</code> (default) a resume of the climatic indices used for the Koeppen - Geiger classification is added to the output.</p>
</td></tr>
<tr><td><code id="koeppen_geiger_+3A_class.nr">class.nr</code></td>
<td>
<p>logical. If <code>FALSE</code> (default) class is expressed by letters, otherwise by numbers (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>clim_norm</code> is a monthly data frame of climate normals, with column names: &quot;P&quot;, &quot;Tn&quot;, &quot;Tx&quot;, &quot;Tm&quot; (precipitation, minimum, maximum and mean temperature, respectively). It can be the output of function <code><a href="#topic+climate">climate</a></code>.
</p>
<p>Koeppen - Geiger's classification is based on Trewartha and Lyle, 1980. The function also holds for Southern emisphere, except for the &quot;Gange&quot; sub-type (&quot;Ag&quot; and &quot;Cg&quot;). Type &quot;H&quot; (highland climate) and sub-types &quot;Bn&quot; and &quot;Cn&quot; (where n stands for Nebel) are never attributed, being based on a qualitative description in the quoted reference.
</p>
<p>Sub-type &quot;w&quot; (wet-and-dry) or &quot;m&quot; (monsoon) in climate &quot;A&quot; is set according to the definition after Encyclopaedia Britannica (<a href="http://www.britannica.com/EBchecked/topic/322068/Koppen-climate-classification">http://www.britannica.com/EBchecked/topic/322068/Koppen-climate-classification</a>): if P in the 4 driest months is less than 1/5 of the wettest months and if both the 4 driest and wettest months are split over non-contiguous seasons (either 2 months per season or 1 and 3 months per season), then sub-type is &quot;&quot;.
</p>
<p>For climate &quot;A&quot;, the letter &quot;m&quot; is attributed to the first sub-type.
</p>
<p>Climates &quot;Cx&quot; have P[May + June] &gt;= 1.3 P [Aug. + Sept.] in N emisphere, and P[Nov. + Dec.] &gt;= 1.3 P[Febr. + March] in S emisphere.
</p>
<p><code>A_B_C_special_sub.classes</code>, if <code>TRUE</code>, adds a letter to the second sub-type of climates: &quot;i&quot; or &quot;g&quot; (climate A), &quot;w&quot; or &quot;s&quot; (climate B), and  &quot;i&quot;, &quot;g&quot;, or &quot;x&quot; (climate C).
</p>
<p>The returned data frame contains the following fields:
</p>
<p><code>T_w.m</code> = temperature of the warmest month (degrees C)
</p>
<p><code>T_c.m</code> = temperature of the coldest month (degrees C)
</p>
<p><code>T_avg</code> = average temperature (degrees C)
</p>
<p><code>P_tot</code> = total precipitation depth (mm)
</p>
<p><code>P_wint</code> = precipitation depth in the 6 coldest (winter) months (mm)
</p>
<p><code>P_summ</code> = precipitation depth in the 6 warmest (summer) months (mm)
</p>
<p><code>P_d.m</code> = precipitation depth in the driest month (mm)
</p>
<p><code>P_d.m.summ</code> = precipitation depth in the driest month of &quot;summer&quot; half of the year (mm)
</p>
<p><code>P_d.m.wint</code> = precipitation depth in the driest month of &quot;winter&quot; half of the year (mm)
</p>
<p><code>P_w.m</code> = precipitation depth in the wettest month (mm)
</p>
<p><code>P_w.m.summ</code> = precipitation depth in the driest month of &quot;summer&quot; half of the year (mm)
</p>
<p><code>P_w.m.wint</code> = precipitation depth in the wettest month of &quot;winter&quot; half of the year (mm)
</p>
<p><code>T_4th_w.m</code> = temperature of the 4th warmest month (degrees C)
</p>
<p><code>class</code> = climatic class. If <code>class.nr</code>=<code>FALSE</code> (default), it results from the merging of &quot;climate&quot; (A to E) and sub-type(s). 
If <code>class.nr</code>=<code>TRUE</code> the class comes from the sum of the numeric equivalent of &quot;type&quot; (A,..E) + &quot;first sub type&quot; (only first letter),
according to the following scheme:
</p>
<p>A  B  C  D  E
</p>
<p>10 20 30 40 50  
</p>
<p>f  W  s  s  T &ndash;&gt;  1
</p>
<p>w  S  w  w  F &ndash;&gt;  2
</p>
<p>m     f  f    &ndash;&gt;  3
</p>
<p>(e.g: Af = 11, Cw = 32, EF = 52)
</p>


<h3>Value</h3>

<p>A one-line data frame reporting a resume of climatic features useful for the classification (if  <code>clim.resume_verbose</code> is <code>TRUE</code>), and one last field (1 type - or &quot;climate&quot; - plus 1 or 2 sub-types) reporting Koeppen - Geiger's climate classification. See details.
</p>


<h3>Author(s)</h3>

<p>Emanuele Eccel
</p>


<h3>References</h3>

<p>Trewartha, G.T. and Lyle, H.H., 1980: An Introduction to Climate. MacGraw - Hill, 5th Ed. Appendix: Koeppen's Classification of Climates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+climate">climate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Trent_climate)
# clima_81_10 is a list of data frames having climatic means of temperature and precipitation as 
# required by Koeppen - Geiger classification, each one referring to one station. 
# It can be the output of function climate.
class_clim_l&lt;-lapply(clima_81_10, FUN=koeppen_geiger, A_B_C_special_sub.classes=TRUE)

</code></pre>

<hr>
<h2 id='lista_cli'>Dataset of meteorological measures</h2><span id='topic+lista_cli'></span>

<h3>Description</h3>

<p>A list of 28 data frames (one for each station of the meteorological network), with 
monthly time series of precipitation and temperature (minimum and maximum).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>List of 28 elements, each is a data frame of 5 variables and 636 observations</p>

<hr>
<h2 id='oiv_ind'>OIV bioclimatic indices for viticulture</h2><span id='topic+oiv_ind'></span>

<h3>Description</h3>

<p>Calculation of OIV bio-climatic indices for viticulture (ref.: http://www.oiv.int/oiv/info/enresolution2012?lang=en).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oiv_ind(daily_Tn = NULL, daily_Tx = NULL, daily_Tm = NULL,
  daily_P = NULL, first.yr = NULL, last.yr = NULL, subs_missing = TRUE,
  coeff_HI = 1.04, quant_Tn_rest = 0.5, quant_Tn_veg = 0.5,
  quant_Tx_veg = 0.5, indices = 1:10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="oiv_ind_+3A_daily_tn">daily_Tn</code></td>
<td>
<p>series of daily minimum temperature (data frame). Must include the following columns (and names): &quot;year&quot;, &quot;month&quot;, &quot;day&quot; and one or more station id(s), each column one Tn series.</p>
</td></tr>
<tr><td><code id="oiv_ind_+3A_daily_tx">daily_Tx</code></td>
<td>
<p>series of daily maximum temperature (data frame). Must include the following columns (and names): &quot;year&quot;, &quot;month&quot;, &quot;day&quot; and one or more station id(s), each column one Tx series.</p>
</td></tr>
<tr><td><code id="oiv_ind_+3A_daily_tm">daily_Tm</code></td>
<td>
<p>series of daily mean temperature (data frame). Must include the following columns (and names): &quot;year&quot;, &quot;month&quot;, &quot;day&quot; and one or more station id(s), each column one Tm series.</p>
</td></tr>
<tr><td><code id="oiv_ind_+3A_daily_p">daily_P</code></td>
<td>
<p>series of daily precipitation (data frame). Must include the following columns (and names): &quot;year&quot;, &quot;month&quot;, &quot;day&quot; and one or more station id(s), each column one P series.</p>
</td></tr>
<tr><td><code id="oiv_ind_+3A_first.yr">first.yr</code></td>
<td>
<p>first year of the period over which indices are calculated</p>
</td></tr>
<tr><td><code id="oiv_ind_+3A_last.yr">last.yr</code></td>
<td>
<p>last year of the period over which indices are calculated</p>
</td></tr>
<tr><td><code id="oiv_ind_+3A_subs_missing">subs_missing</code></td>
<td>
<p>logical: if <code>TRUE</code> (default), missing values in input series are replaced by corresponding average values for each day in the series.</p>
</td></tr>
<tr><td><code id="oiv_ind_+3A_coeff_hi">coeff_HI</code></td>
<td>
<p>Huglin's daylength correction, as long as the number of stations, or a single coeffient; in this case it is recycled on all stations. See details.</p>
</td></tr>
<tr><td><code id="oiv_ind_+3A_quant_tn_rest">quant_Tn_rest</code></td>
<td>
<p>quantile (0..1) for the choice of the position of the representative year in the series, referred to the minimum temperature during &quot;rest&quot; period. Default is 0.5 (median)</p>
</td></tr>
<tr><td><code id="oiv_ind_+3A_quant_tn_veg">quant_Tn_veg</code></td>
<td>
<p>quantile (0..1) for the choice of the position of the representative year in the series, referred to the minimum temperature during the &quot;vegetative&quot; period. Default is 0.5 (median)</p>
</td></tr>
<tr><td><code id="oiv_ind_+3A_quant_tx_veg">quant_Tx_veg</code></td>
<td>
<p>quantile (0..1) for the choice of the position of the representative year in the series, referred to the maximum temperature during the &quot;vegetative&quot; period. Default is 0.5 (median)</p>
</td></tr>
<tr><td><code id="oiv_ind_+3A_indices">indices</code></td>
<td>
<p>set of OIV indices to be listed. Default is all indices (1 to 10). See details for numbered list of indices.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>General info about OIV indices can be sought at http://www.oiv.int/oiv/info/enresolution2012?lang=en.
In general, if <code>first.yr</code> or <code>last.yr</code> are NULL (default), the lowest and highest values in series are taken as begin and end of calculation period.
A coherence check is done on input of start / end years.
</p>
<p>If any input is missing, corresponding indices are not be calculated. If <code>daily_Tm</code> is missing and both <code>daily_Tn</code> and  <code>daily_Tx</code> are passed to the function,
<code>daily_Tm</code> is calculated as the mean of  <code>daily_Tn</code> and  <code>daily_Tx</code>.
</p>
<p>OIV indices are the following:
</p>
<p><code>Tm_veg</code>: 1 - mean temperature during vegetation period. The latter is April - October (N emisphere) or October - April (S emisphere). The case (N or S) is automatically recognised by temperature data.
</p>
<p><code>WI</code>: 2 - Winkler index (degree days with a 10 C base, summation over vegetative period), see note on <code>Tm_veg</code>. Ref: Amerine and Winkler, 1944.
</p>
<p><code>BEDD</code>: 3 - biologically active degree days. Degree days with a lower threhold of 10 C and an upper threshold at 19 C. Ref: Gladstone, 2004.
</p>
<p><code>HI</code>: 4 - heliothermic Huglin index. A degree day summation of the average between  mean and maximum temperature above 10 C, corrected by a coefficient of daylength duration.
The coefficient is given by the author in a table according to latitude. If one value is given, it is used for all stations. Default is 1.04 (lat. 44-46). Ref.: Huglin, P., 1978
</p>
<p><code>CNI</code>: 5 - cool night index. Mean of September (N emisphere) or March (S emisphere) minimum temperatures. Ref.: Tonietto and Carbonneau, 2004.
</p>
<p><code>FSI</code>: 6 - Fregoni's simplified index. Given by the product between the summation of thermal range (Tx - Tn) and the number of days with Tm &gt; 10 C, for 30 days before ripening.
The period before ripening is taken as September (N emisphere) or March (S emisphere). Ref.: Fregoni et Pezzutto, 2000.
</p>
<p><code>BI</code>: 7 - Branas' hydrothermic index. The only index not included in OIV list, used for fungine infection proneness. 
It is given by the product of precipitation (mm) by the mean temperature (C) during the period April - October (N emisphere) or October - April (S emisphere). Ref: Eynard and Dal Masso, 1990.
</p>
<p><code>Tn_rest</code>: 8 - minimum temperature during rest period. Useful for assessing winter severity. The rest period is November - March (N emisphere) or May - September (S emisphere). 
The case (N or S) is automatically recognised by temperature data.
</p>
<p><code>Tn_veg</code>: 9 - minimum temperature during vegetative period. Useful for assessing spring frosts. See note on <code>Tm_veg</code> for periods.
</p>
<p><code>Tx_veg</code>: 10 - maximum temperature during vegetative period. Useful for assessing summer hot spells. See note on <code>Tm_veg</code> for periods.
</p>
<p><code>quant_Tn_rest</code>, <code>quant_Tn_veg</code>, <code>quant_Tx_veg</code> define the statistical rank of the year to be chosen as representative for assessing <code>Tn_rest</code>,
<code>Tn_veg</code>, and <code>Tx_veg</code>, respectfully. 0.5 (default) is the median year, 0 is the minimum (lowest temperature), 1 is the maximum (highest temperature).
</p>
<p>The only missing index among those selected by OIV is Riou's Drought Index, which is calculated by function <code>RDI</code> on monthly series.
</p>


<h3>Value</h3>

<p>A table (one line per station) reporting OIV bioclimatic indices. The Branas' index is added.
</p>


<h3>Author(s)</h3>

<p>Emanuele Eccel
</p>


<h3>References</h3>

<p>Amerine, M.A., and Winkler, A.J., 1944. Composition and quality of musts and wines of California grapes. Hilgardia. 15(6): 493-673.
</p>
<p>Eccel, E.,  Zollo, A.L.,  Mercogliano, P., Zorer, R., 2016: Simulations of quantitative shift in bio-climatic indices in the viticultural areas of Trentino (Italian Alps) by an open source R package. Computers and Electronics in Agriculture 127 (2016) 92-100.
</p>
<p>Eynard, I. e Dal Masso, G., 1990: Viticoltura moderna. Manuale pratico. Hoepli Milano. 778 pp.
</p>
<p>Fregoni, C., et  Pezzutto, S., 2000 : Principes et premieres approches de l'indice bioclimatique de qualite Fregoni, Progr.Agric.Vitic. 117: 390-396.
</p>
<p>Gladstones, J.S., 2004: Climate and Australian Viticulture. In 'Viticulture. Volume 1-Resources'. (Eds Dry PR, Coombe BG) pp. 90-118.
</p>
<p>Huglin, M.P., 1978: Nouveau mode d'evaluation des possibilites heliothermiques d'un milieu viticole. Comptes Rendus de l'Academie de l'Agriculture de France. 64: 1117-1126.
</p>
<p>Tonietto, J., and Carbonneau, A., 2004. A multicriteria climatic classification system for grape-growing regions worldwide. Agricultural and Forest Meteorology. 124(1/2): 81-97.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+RDI">RDI</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Trent_climate)
oiv_ind(daily_Tn=Tn,daily_Tx=Tx, daily_P=P, first.yr=1981, last.yr=2010, subs_missing=FALSE)

</code></pre>

<hr>
<h2 id='P'>Precipitation</h2><span id='topic+P'></span>

<h3>Description</h3>

<p>The daily data frame of precipitation for a number of stations. It is used in function  
<code><a href="#topic+oiv_ind">oiv_ind</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>Data frame: 19358 obervations of 39 variables (stations)</p>

<hr>
<h2 id='peguy'>Peguy Climograph</h2><span id='topic+peguy'></span>

<h3>Description</h3>

<p>Representation of Peguy Climograph from monthly weather data (Mean Temperature, Precipitation)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>peguy(data = NULL, TemperatureTriangleCoords = c(0, 23.4, 15),
  PrecipitationTriangleCoords = c(0, 40, 200), ylab = "Precipitation[mm]",
  xlab = "Mean Temperature [degC]", lambda.label = 1.75,
  climate.label = c("Temperate", "Cool", "Arid", "Hot"), xyField = c("Tn",
  "P"), pointsField = "month", StationsField = "station",
  color.scale = "monthly", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="peguy_+3A_data">data</code></td>
<td>
<p>input dataset with climatological monthly weather data</p>
</td></tr>
<tr><td><code id="peguy_+3A_temperaturetrianglecoords">TemperatureTriangleCoords</code></td>
<td>
<p>Temperature coordinates for triangle vertices in the Peguy Climograph. Default coordinates are expressed in Celsius Degrees.</p>
</td></tr>
<tr><td><code id="peguy_+3A_precipitationtrianglecoords">PrecipitationTriangleCoords</code></td>
<td>
<p>Precipitation coordinates for triangle vertices in the Peguy Climograph. Default coordinates are expressed in millimeters.</p>
</td></tr>
<tr><td><code id="peguy_+3A_xlab">xlab</code>, <code id="peguy_+3A_ylab">ylab</code></td>
<td>
<p>xy axis labels</p>
</td></tr>
<tr><td><code id="peguy_+3A_lambda.label">lambda.label</code></td>
<td>
<p>numeric value used to locate climate attribute labels</p>
</td></tr>
<tr><td><code id="peguy_+3A_climate.label">climate.label</code></td>
<td>
<p>string vector containing  climate attributes. Default is <code>c("Temperate", "Cold", "Arid", "Hot")</code>. Alternatively it can be translated into any other languange.</p>
</td></tr>
<tr><td><code id="peguy_+3A_xyfield">xyField</code></td>
<td>
<p>column names of <code>data</code> for the x and y variables used in the Peguy Climate Diagram.</p>
</td></tr>
<tr><td><code id="peguy_+3A_pointsfield">pointsField</code></td>
<td>
<p>column name of <code>data</code> containing the fields to be represented with different point colors. Default is <code>"month"</code>.</p>
</td></tr>
<tr><td><code id="peguy_+3A_stationsfield">StationsField</code></td>
<td>
<p>column name of <code>data</code> containing the fields  with station ID names. Default is <code>"station"</code>.</p>
</td></tr>
<tr><td><code id="peguy_+3A_color.scale">color.scale</code></td>
<td>
<p>character scale indicating a use of a specific color scale. Default is <code>"monthly"</code>.</p>
</td></tr>
<tr><td><code id="peguy_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emanuele Cordano
</p>


<h3>References</h3>

<p>Peguy, C.P. (1970) Precis de climatologie, ed. Masson, Paris.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(stringr)
data(Trent_climate)


TrentinoClimateDf &lt;- do.call(rbind,clima_81_10)
names &lt;- rownames(TrentinoClimateDf)
TrentinoClimateDf$station &lt;- unlist(lapply(X=str_split(names,pattern="[.]"),FUN=function(x) {x[1]}))
 


data &lt;- TrentinoClimateDf[TrentinoClimateDf$station %in% unique(TrentinoClimateDf$station)[1:3],]
p &lt;- peguy(data=data)


</code></pre>

<hr>
<h2 id='plot.thornthwaite'>Thornthwaite - Mather's quantile plot</h2><span id='topic+plot.thornthwaite'></span>

<h3>Description</h3>

<p>'plot' method implementation for 12-month quantile climate charts from output of function <code><a href="#topic+thornthwaite">thornthwaite</a></code> (Thornthwaite and Mather's water balance).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'thornthwaite'
plot(x, save_dir = NULL, format = NULL,
  variables = c("Precipitation", "Et0", "Storage", "Prec. - Evap.", "Deficit",
  "Surplus"), title = TRUE, trace_grid = TRUE, st_name = NULL,
  u_y_scale_magn = 0.2, l_y_scale_magn = 0, leg_pos = "topleft", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.thornthwaite_+3A_x">x</code></td>
<td>
<p>a list of quantile data frames of water balance variables to be plotted, as output of function <code><a href="#topic+thornthwaite">thornthwaite</a></code>.</p>
</td></tr>
<tr><td><code id="plot.thornthwaite_+3A_save_dir">save_dir</code></td>
<td>
<p>name of destination directory for graphs (if any). Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.thornthwaite_+3A_format">format</code></td>
<td>
<p>graphic format of graphs; default is NULL (charts are sent to console).</p>
</td></tr>
<tr><td><code id="plot.thornthwaite_+3A_variables">variables</code></td>
<td>
<p>character vector of variables to be plotted.</p>
</td></tr>
<tr><td><code id="plot.thornthwaite_+3A_title">title</code></td>
<td>
<p>logic. If <code>TRUE</code> inserts titles in charts.</p>
</td></tr>
<tr><td><code id="plot.thornthwaite_+3A_trace_grid">trace_grid</code></td>
<td>
<p>logic. If <code>TRUE</code> (default) adds a grid.</p>
</td></tr>
<tr><td><code id="plot.thornthwaite_+3A_st_name">st_name</code></td>
<td>
<p>name to be included into graphs titles. If NULL (default), no title is written.</p>
</td></tr>
<tr><td><code id="plot.thornthwaite_+3A_u_y_scale_magn">u_y_scale_magn</code></td>
<td>
<p>magnification of range above upper limit, to set upper y-scale limit; default is 0.</p>
</td></tr>
<tr><td><code id="plot.thornthwaite_+3A_l_y_scale_magn">l_y_scale_magn</code></td>
<td>
<p>magnification of range below lower limit, to set lower y-scale limit; default is 0.1.</p>
</td></tr>
<tr><td><code id="plot.thornthwaite_+3A_leg_pos">leg_pos</code></td>
<td>
<p>legend position. Default is &quot;topleft&quot;. If NULL, no legend is added.</p>
</td></tr>
<tr><td><code id="plot.thornthwaite_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods, such as graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Default for plot variables is all those calculated by function thornthwaite: &quot;Precipitation&quot;, &quot;Et0&quot;, &quot;Storage&quot;, &quot;Prec. - Evap.&quot;, &quot;Deficit&quot;, &quot;Surplus&quot;. See function <code><a href="#topic+thornthwaite">thornthwaite</a></code> for details on variables.
</p>
<p>If <code>format</code> is NULL (default), graphs are sent to the console. Otherwise, a file is produced and saved to the <code>save_dir</code> directory. Values allowed are: &quot;png&quot;, &quot;jpeg&quot;, &quot;tiff&quot;, &quot;bmp&quot;.
</p>
<p><code>l_y_scale_magn</code> and <code>u_y_scale_magn</code> are the magnification coefficients (lower and upper, respectively), for y scale. If rng is the range between maximum and minimum values in all sets of series within a plot, the lower limit for y scale will be (rng * <code>l_y_scale_magn</code>) below the lower value, and the upper limit will be (rng * <code>u_y_scale_magn</code>) above the upper value of series.
</p>
<p>Allowed values for <code>leg_pos</code> are the same of <code>x</code> in function <code><a href="graphics.html#topic+legend">legend</a></code>.
</p>
<p>Most graphic parameters for functions <code><a href="base.html#topic+plot">plot</a></code> and <code><a href="graphics.html#topic+legend">legend</a></code> are accepted.
</p>


<h3>Value</h3>

<p>Charts of quantiles for water balance variables (12-month climatic values). They can be sent to the console or saved as graphic files.
</p>


<h3>Note</h3>

<p>A conflict is generated if parameters already used by the function are passed (e.g. x for <code><a href="graphics.html#topic+legend">legend</a></code>: use <code>leg_pos</code> instead).
</p>


<h3>Author(s)</h3>

<p>Emanuele Eccel
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thornthwaite">thornthwaite</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Trent_climate)


# quantiles is the list ("thornthwaite" S3 object)of quantile tables generated 
# by function thornthwaite; 
# it is the second element of the output list, 
# which can be split into two separate lists (see function thornthwaite)
sta &lt;- 1     # 1st station in the list of quantile tables
q_list=quantiles[[sta]]
class(q_list) &lt;- "thornthwaite" ## q_list is coerced to a "thornthwaite" S3 object
plot(q_list, 
st_name=names(quantiles)[sta], variables=c("Precipitation",  "Et0"), 
leg_pos = "topleft", col=c(1:6,1), pch=c(1:6,16),  
lty=1, horiz=TRUE,  y.intersp=0.1)

</code></pre>

<hr>
<h2 id='quantiles'>Monthly quantiles of the meteorological variables</h2><span id='topic+quantiles'></span>

<h3>Description</h3>

<p>The second list (<code>quantiles</code>) in <code>thornt_lst</code> organized according to stations. 
See Examples in function <code><a href="#topic+thornthwaite">thornthwaite</a></code> for its construction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>Data frame of 28 observations of 4 variables</p>

<hr>
<h2 id='RDI'>Riou's drought index</h2><span id='topic+RDI'></span>

<h3>Description</h3>

<p>Calculation of Riou's drought index described in OIV bio-climatic indices for viticulture (see references)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RDI(series, clim_norm = NULL, first.yr = NULL, last.yr = NULL,
  TAW = 200, coeff_rad, coeff_Hargr = rep(0.75, 12), quant = c(0, 0.1,
  0.5))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RDI_+3A_series">series</code></td>
<td>
<p>series of mean monthly weather values</p>
</td></tr>
<tr><td><code id="RDI_+3A_clim_norm">clim_norm</code></td>
<td>
<p>the reference climatic values for each month, used for gap filling. Default is <code>NULL</code> (no replacement of missing values)</p>
</td></tr>
<tr><td><code id="RDI_+3A_first.yr">first.yr</code></td>
<td>
<p>of the period over which water balance is calculated. Default is  <code>NULL</code> (calculations start with the first year of the series)</p>
</td></tr>
<tr><td><code id="RDI_+3A_last.yr">last.yr</code></td>
<td>
<p>of the period over which water balance is calculated. Default is  <code>NULL</code> (calculations start with the last year of the series)</p>
</td></tr>
<tr><td><code id="RDI_+3A_taw">TAW</code></td>
<td>
<p>total available water content of soil</p>
</td></tr>
<tr><td><code id="RDI_+3A_coeff_rad">coeff_rad</code></td>
<td>
<p>vector of solar radiation coefficients (12 values) for calculation of potential evapotranspiration</p>
</td></tr>
<tr><td><code id="RDI_+3A_coeff_hargr">coeff_Hargr</code></td>
<td>
<p>(vector of monthly) correction coefficient(s) for Hargreaves' equation</p>
</td></tr>
<tr><td><code id="RDI_+3A_quant">quant</code></td>
<td>
<p>vector of quantiles for the statistical ranking of the year representative for balance (0..1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For full description of algorithm see OIV standards at http://www.oiv.int/oiv/info/enresolution2012?lang=en and the references:  Riou, 1994; Tonietto, 1999.
Evapotranspiration is calculated by Hargreaves' equation (see <code><a href="#topic+arid">arid</a></code>).
</p>
<p><code>series</code> is a data frame of the monthly series (means) of: cumulated precipitation (mm), minimum temperature, maximum temperature, mean temperature (optional) 
- all in deg. C. Includes the following columns (and names): &quot;year&quot;, &quot;month&quot;, &quot;P&quot;, &quot;Tn&quot;, &quot;Tx&quot;, &quot;Tm&quot; (optional), for precipitation, minimum, maximum and 
mean temperature, respectively. If <code>Tm</code> is missing it is calculated as (Tn + Tx)/2. Format is the same of <code>lista_cli</code>.
</p>
<p><code>clim_norm</code> is a monthly data frame of 12 climate normals, with the same column names of <code>series</code>, except &quot;year&quot;.
It can be the output of function <code><a href="#topic+climate">climate</a></code>. If <code>clim_norm</code> is not  <code>NULL</code>, any missing value in 
the monthly series is substituted by the corresponding climatic value in <code>clim_norm</code>.
</p>
<p>A default value of 200 mm for <code>TAW</code> is suggested by the authors of the index. It can be changed according to the known
pedological features of soil.
</p>
<p><code>coeff_rad</code> corresponds to the mean monthly extra-atmospheric radiation (see function <code><a href="#topic+ExAtRa">ExAtRa</a></code>). It is required in Hargreaves' equation.
</p>
<p><code>coeff_Hargr</code> is either a single value or a vector of 12 coefficients to adjust Hargreaves' estimation of potential evapotranspiration. 
From calibration in 6 stations from the same network of <code>Trent_climate</code>, its average value is 0.75.
</p>
<p><code>quant_vector</code> a vector of minimum one element. 0 yields minimum absolute case, 0.5 the median. Values range from 0 to 1 (inappropropriate if &gt; 0.5).
</p>
<p>The algorithm described in OIV assesses water balance at the last month of the ripenining period, early autumn. However, in
humid or sub-humid climates the driest period for soil generally falls in summer. For this reason, the output table reports 
both cases (&quot;harvest&quot; time value and monthly minimum over the season, &quot;WB_harv&quot; and &quot;WB_min&quot;, respectfully). Harvest time is 
conventionally September (N emisphere) or March (S emisphere).
</p>


<h3>Value</h3>

<p>A two-column table reporting Riou's drought indices for each quantile chosen (one line each, minimum is 1). Both &quot;harvest time&quot; and minimum values
are calculated (see details).
</p>


<h3>Author(s)</h3>

<p>Emanuele Eccel
</p>


<h3>References</h3>

<p>Riou, C. 1994. Le determinisme climatique de la maturation du raisin: application au zonage de la teneur en sucre dans la Communaute Europeenne (E. Commission, ed.).
Office des Publications Officielles des Communautes Europeennes, Luxembourg, 322p.
</p>
<p>Tonietto, J. 1999. Les Macroclimats Viticoles Mondiaux et l'Influence du Mesoclimat sur la Typicite de la Syrah et du Muscat de Hambourg dans le Sud de la France 
Methodologie de Caracterisation. These de doctorat, Ecole Nationale Superieure Agronomique de Montpellier, Montpellier (France), 216p.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oiv_ind">oiv_ind</a></code>,  <code><a href="#topic+arid">arid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Trent_climate)
RDI(lista_cli[[1]], clim_norm=clima_81_10[[1]], first.yr=1981, last.yr=2010, coeff_rad=coeff_rad)

</code></pre>

<hr>
<h2 id='thornt_lst'>Input for the Thornthwaite function</h2><span id='topic+thornt_lst'></span>

<h3>Description</h3>

<p>For every station, the first element (a list, <code>Thornth._W._bal</code>) reports the monthly 
series of water balance quantities for the station, each in one data frame (see function 
<code><a href="#topic+thornthwaite">thornthwaite</a></code> for details). The second list (<code>quantiles</code>) reports the 
monthly quantiles for the same quantities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>S3 object: a &quot;hyperlist&quot; (list of lists of lists), one list of lists for each station</p>

<hr>
<h2 id='thornthwaite'>Thornthwaite and Mather's water balance</h2><span id='topic+thornthwaite'></span>

<h3>Description</h3>

<p>Calculates Thornthwaite and Mather's water balance from monthly series of precipitation and temperature. Aimed at a classification of a site's climate according to its water balance features.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thornthwaite(series, latitude, clim_norm = NULL, first.yr = NULL,
  last.yr = NULL, quant = c(0, 0.1, 0.25, 0.5, 0.75, 0.9, 1),
  snow.init = 20, Tsnow = -1, TAW = 100, fr.sn.acc = 0.95,
  snow_melt_coeff = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thornthwaite_+3A_series">series</code></td>
<td>
<p>the monthly series of temperature and precipitation.</p>
</td></tr>
<tr><td><code id="thornthwaite_+3A_latitude">latitude</code></td>
<td>
<p>latitude of the station in degrees.</p>
</td></tr>
<tr><td><code id="thornthwaite_+3A_clim_norm">clim_norm</code></td>
<td>
<p>climatic normals.</p>
</td></tr>
<tr><td><code id="thornthwaite_+3A_first.yr">first.yr</code></td>
<td>
<p>first year of the period over which water balance is calculated. Default is <code>NULL</code> (calculations start with the first year of the series).</p>
</td></tr>
<tr><td><code id="thornthwaite_+3A_last.yr">last.yr</code></td>
<td>
<p>last year of the period over which water balance is calculated. Default is <code>NULL</code> (calculations stop with the last year of the series).</p>
</td></tr>
<tr><td><code id="thornthwaite_+3A_quant">quant</code></td>
<td>
<p>vector of quantiles for which water balance has to be assessed. Default is: min, 10th, 25th 50th, 75th, 90th, max.</p>
</td></tr>
<tr><td><code id="thornthwaite_+3A_snow.init">snow.init</code></td>
<td>
<p>initial water equivalent for snowpack (mm). Default is 20.</p>
</td></tr>
<tr><td><code id="thornthwaite_+3A_tsnow">Tsnow</code></td>
<td>
<p>maximum temperature (monthly mean) for precipitation to be treated as snowfall. Default is -1 degree C.</p>
</td></tr>
<tr><td><code id="thornthwaite_+3A_taw">TAW</code></td>
<td>
<p>maximum (field capacity) for soil water retention, and initial soil water content (mm). Default is 100.</p>
</td></tr>
<tr><td><code id="thornthwaite_+3A_fr.sn.acc">fr.sn.acc</code></td>
<td>
<p>fraction of snow that contributes to snowpack (0-1). 1 - fr.sn.acc is treated as liquid monthly precipitation Default is 0.95.</p>
</td></tr>
<tr><td><code id="thornthwaite_+3A_snow_melt_coeff">snow_melt_coeff</code></td>
<td>
<p>monthly coefficient(s) for snowmelt. Default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm for the calculation of water balance is adapted from Thornthwaite, 1948; Thornthwaite and Mather, 1955; Thornthwaite and Mather, 1957.
</p>
<p><code>series</code> is a data frame with years, months, temperature and precipitation values. Names in series columns must include: year, month, Tn and Tx (minimum and maximum temperatures, respectively) or, as an alternative, Tm (mean temperatures), and P (mandatory).
</p>
<p><code>clim_norm</code> is a monthly data frame of climate normals, with column names: &quot;P&quot;, &quot;Tn&quot;, &quot;Tx&quot;, &quot;Tm&quot; (precipitation, minimum, maximum and mean temperature, respectively). It can be the output of function <code><a href="#topic+climate">climate</a></code>. If <code>clim_norm</code> is not NULL, any missing value in the monthly series is substituted by the corresponding climatic value in <code>clim_norm</code>.
</p>
<p>At any winter season, the maximum monthly snowpack height is attained in the last month before &quot;spring&quot; conditions (<code>Tm</code> &gt;= <code>Tsnow</code>), even if a month with Tm &lt; Tsnow may occur later.
</p>
<p><code>snow_melt_coeff</code> is (are) the coefficient(s) for snow melt fraction(s) at any month where the condition for melting exists. If <code>snow_melt_coeff</code> = 1 (default), all the melting occurs in the first month when <code>Tm &gt;= Tsnow</code>; if it is a vector, melting is spread over more than one month. If the sum of coefficients is less than 1, the residual melting occurs in one further month.
</p>
<p>The output function is a list of two lists of data frames (balance and quantile). In both lists, data frame (and names) are the following (all variables in mm):
</p>
<p><code>Precipitation</code> (repeats input values);
</p>
<p><code>Et0</code> (potential evapotranspiration);
</p>
<p><code>Storage</code> (water stored in soil);
</p>
<p><code>Prec. - Evap.</code> (difference between precipitation and potential evapotranspiration);
</p>
<p><code>Deficit</code> (difference between potential and real evapotranspiration, due to water unavailability in soil);
</p>
<p><code>Surplus</code> (water surplus in soil, routed to runoff).
</p>
<p>Please, refer to the quoted references for details.
</p>
<p>This function requires the function <code>daylength</code> (libr. <code>geosphere</code>).
</p>


<h3>Value</h3>

<p>A <code>thornthwaite</code> S3 object, consisting on a list of two lists. The first (name: W_balance) is a list of data frames containing the monthly series of all indices, the second (name: quantiles) the relevant quantiles. See details for meanings of single variables.
</p>


<h3>Author(s)</h3>

<p>Giambattista Toller and Emanuele Eccel
</p>


<h3>References</h3>

<p>Thornthwaite, C. W., 1948: An Approach toward a Rational Classification of Climate. Geographical Review, Vol. 38, No. 1(Jan.):55-94.
</p>
<p>Thornthwaite, C. W., and Mather, J.R., 1955: The water balance.  Publications in Climatology, Volume 8(1), Laboratory of Climatology
</p>
<p>Thornthwaite, C. W., and Mather, J.R., 1957: Instructions and tables for computing potential evapotranspiration and the water balance.  Publications in climatology, Volume 10(3), Laboratory of Climatology
</p>


<h3>See Also</h3>

<p><code><a href="#topic+climate">climate</a></code>, <code><a href="#topic+ExAtRa">ExAtRa</a></code>, <code><a href="#topic+plot.thornthwaite">plot.thornthwaite</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Trent_climate)


# lista_cli is a list of data frames of the type "series", 
# each one referring to one station - see function "climate".
# clima_81_10 is a list of data frames having climatic means 
# of temperature and precipitation, each one referring to one station. 
# It can be the output of function "climate".
library(geosphere) # required for function daylength
thornt_lst&lt;-NULL
lista_cli &lt;- lista_cli[1:3] ## lista_cli is reduced to diminish elapsed time of execution!
for(k in 1 : length(lista_cli[1:3])) {
  thornt_lst[[k]]&lt;-thornthwaite(series=lista_cli[[k]], 
  clim_norm=clima_81_10[[k]],
  latitude = 46, first.yr=1981, 
  last.yr=2010, snow_melt_coeff=c(0.5,0.5 )  )
}
names(thornt_lst)&lt;-names(lista_cli)
  
# splits list into two lists
W_balance&lt;-NULL; quantiles&lt;-NULL
for(k in 1 : length(lista_cli))
{
  W_balance[[k]]&lt;-thornt_lst[[k]]$W_balance
  quantiles[[k]]&lt;-thornt_lst[[k]]$quantiles
 }
 names(W_balance)&lt;-names(thornt_lst); names(quantiles)&lt;-names(thornt_lst)
 
</code></pre>

<hr>
<h2 id='Tm'>Mean daily temperature</h2><span id='topic+Tm'></span>

<h3>Description</h3>

<p>The daily data frame of mean daily temperature for a number of stations, used in function 
<code><a href="#topic+oiv_ind">oiv_ind</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>Data frame: 19358 obervations of 15 variables (stations)</p>

<hr>
<h2 id='Tn'>Minimum daily temperature</h2><span id='topic+Tn'></span>

<h3>Description</h3>

<p>The daily data frame of minimum daily temperature for a number of stations, used in function 
<code><a href="#topic+oiv_ind">oiv_ind</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>Data frame: 19358 obervations of 15 variables (stations)</p>

<hr>
<h2 id='Trent_climate'>Data set of Trentino climate</h2><span id='topic+Trent_climate'></span>

<h3>Description</h3>

<p>A group of datasets used consistently throughout the ClimClass manual and examples. 
It is used as reference definition of the climate for the Trentino region, Italy. 
It includes monthly series of temperature and precipitation, and reference tables for 
the definition of aridity and continentality/oceanicity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Details</h3>

<p>Series like &quot;Txxxx&quot; were supplied by the Autonomous Province of Trento - Meteotrentino (I). 
Series like &quot;FEMxx&quot; were supplied by Fondazione Edmund Mach, San Michele all'Adige (I).
</p>

<hr>
<h2 id='Tx'>Maximum daily temperature</h2><span id='topic+Tx'></span>

<h3>Description</h3>

<p>The daily data frame of maximum daily temperature for a number of stations, used in function 
<code><a href="#topic+oiv_ind">oiv_ind</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>Data frame: 19358 obervations of 15 variables (stations)</p>

<hr>
<h2 id='W_balance'>Water balance</h2><span id='topic+W_balance'></span>

<h3>Description</h3>

<p>Is the first list (<code>W_balance</code>) in <code>thornt_lst</code> organized according to stations. 
See Examples in function <code><a href="#topic+thornthwaite">thornthwaite</a></code> for its construction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trent_climate)
</code></pre>


<h3>Format</h3>

<p>List of 28 elements, each is a data frame of 5 variables and 636 observations</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
