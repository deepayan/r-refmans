<!DOCTYPE html><html><head><title>Help for package snvecR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {snvecR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#snvecR-package'><p>snvecR: Calculate Earth’s Obliquity and Precession in the Past</p></a></li>
<li><a href='#full_ZB18a'><p>Full Astronomical Solution ZB18a for the past 100 Myr</p></a></li>
<li><a href='#get_solution'><p>Get an Astronomical Solution</p></a></li>
<li><a href='#prepare_solution'><p>Prepare Astronomical Solution</p></a></li>
<li><a href='#snvec'><p>Calculate Earth’s Obliquity and Precession in the Past</p></a></li>
<li><a href='#ZB17'><p>Astronomical Solutions ZB17 for the past 100 Myr</p></a></li>
<li><a href='#ZB18a_100'><p>Astronomical Solution ZB18a for the Past 100 Myr</p></a></li>
<li><a href='#ZB18a_300'><p>Astronomical Solution ZB18a for the Past 300 Myr</p></a></li>
<li><a href='#ZB20'><p>Astronomical Solutions ZB20 for the past 300 Myr</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Calculate Earth’s Obliquity and Precession in the Past</td>
</tr>
<tr>
<td>Version:</td>
<td>3.9.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Easily calculate precession and obliquity from an orbital solution (defaults to ZB18a from Zeebe and Lourens (2019) &lt;<a href="https://doi.org/10.1126%2Fscience.aax0612">doi:10.1126/science.aax0612</a>&gt;) and assumed or reconstructed values for tidal dissipation (Td) and dynamical ellipticity (Ed). This is a translation and adaptation of the 'C'-code in the supplementary material to Zeebe and Lourens (2022) &lt;<a href="https://doi.org/10.1029%2F2021PA004349">doi:10.1029/2021PA004349</a>&gt;, with further details on the methodology described in Zeebe (2022) &lt;<a href="https://doi.org/10.3847%2F1538-3881%2Fac80f8">doi:10.3847/1538-3881/ac80f8</a>&gt;. The name of the 'C'-routine is 'snvec', which refers to the key units of computation: spin vector s and orbit normal vector n.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>astrochron, ggplot2, tidyr, testthat, roxygen2, knitr, withr,
curl, rmarkdown</td>
</tr>
<tr>
<td>Imports:</td>
<td>deSolve, cli (&ge; 3.4.0), stats, dplyr, tibble, purrr, readr,
tidyselect, rlang (&ge; 0.4.11), glue, tools, backports (&ge;
1.1.6)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://japhir.github.io/snvecR/">https://japhir.github.io/snvecR/</a>, <a href="https://github.com/japhir/snvecR">https://github.com/japhir/snvecR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/japhir/snvecR/issues">https://github.com/japhir/snvecR/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-29 01:56:04 UTC; japhir</td>
</tr>
<tr>
<td>Author:</td>
<td>Ilja Kocken <a href="https://orcid.org/0000-0003-2196-8718"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, trl, cph],
  Richard Zeebe <a href="https://orcid.org/0000-0003-0806-8387"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ilja Kocken &lt;ikocken@hawaii.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-29 23:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='snvecR-package'>snvecR: Calculate Earth’s Obliquity and Precession in the Past</h2><span id='topic+snvecR'></span><span id='topic+snvecR-package'></span>

<h3>Description</h3>

<p>Easily calculate precession and obliquity from an orbital solution (defaults to ZB18a from Zeebe and Lourens (2019) <a href="https://doi.org/10.1126/science.aax0612">doi:10.1126/science.aax0612</a>) and assumed or reconstructed values for tidal dissipation (Td) and dynamical ellipticity (Ed). This is a translation and adaptation of the 'C'-code in the supplementary material to Zeebe and Lourens (2022) <a href="https://doi.org/10.1029/2021PA004349">doi:10.1029/2021PA004349</a>, with further details on the methodology described in Zeebe (2022) <a href="https://doi.org/10.3847/1538-3881/ac80f8">doi:10.3847/1538-3881/ac80f8</a>. The name of the 'C'-routine is 'snvec', which refers to the key units of computation: spin vector s and orbit normal vector n.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Ilja Kocken <a href="mailto:ikocken@hawaii.edu">ikocken@hawaii.edu</a> (<a href="https://orcid.org/0000-0003-2196-8718">ORCID</a>) [translator, copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Richard Zeebe <a href="mailto:zeebe@soest.hawaii.edu">zeebe@soest.hawaii.edu</a> (<a href="https://orcid.org/0000-0003-0806-8387">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://japhir.github.io/snvecR/">https://japhir.github.io/snvecR/</a>
</p>
</li>
<li> <p><a href="https://github.com/japhir/snvecR">https://github.com/japhir/snvecR</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/japhir/snvecR/issues">https://github.com/japhir/snvecR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='full_ZB18a'>Full Astronomical Solution ZB18a for the past 100 Myr</h2><span id='topic+full_ZB18a'></span><span id='topic+full-ZB18a'></span>

<h3>Description</h3>

<p>The HNBody output of Zeebe &amp; Lourens (2019) after some pre-processing using
<code><a href="#topic+prepare_solution">prepare_solution()</a></code>. The wikipedia page on <a href="https://en.wikipedia.org/wiki/Orbital_elements">Orbital elements</a> describes what the
components relate to in order to uniquely specify an orbital plane. The
function asks to download the files to the user's cache directory so that
they can be accessed more quickly in the future.
</p>


<h3>Format</h3>



<h4><code>get_solution("full-ZB18a")</code></h4>

<p>A data frame with 250,001 rows and 20 columns:
</p>

<dl>
<dt>t</dt><dd><p>Time <code class="reqn">t</code> (days).</p>
</dd>
<dt>time</dt><dd><p>Time in thousands of years (kyr).</p>
</dd>
<dt>aa</dt><dd><p>Semimajor axis <code class="reqn">a</code> in astronomical units (au).</p>
</dd>
<dt>ee</dt><dd><p>Eccentricity <code class="reqn">e</code> (unitless).</p>
</dd>
<dt>inc</dt><dd><p>Inclination <code class="reqn">I</code> (degrees).</p>
</dd>
<dt>lph</dt><dd><p>Longitude of perihelion <code class="reqn">\varpi</code> (degrees).</p>
</dd>
<dt>lan</dt><dd><p>Longitude of the ascending node <code class="reqn">\Omega</code> (degrees).</p>
</dd>
<dt>arp</dt><dd><p>Argument of perihelion <code class="reqn">\omega</code> (degrees).</p>
</dd>
<dt>mna</dt><dd><p>Mean anomaly <code class="reqn">M</code> (degrees).</p>
</dd>
</dl>
<p>The following columns were computed from the above input with <code><a href="#topic+prepare_solution">prepare_solution()</a></code>:
</p>
<dl>
<dt>lphu</dt><dd><p>Unwrapped longitude of perihelion <code class="reqn">\varpi</code> (degrees without
jumps).</p>
</dd>
<dt>lanu</dt><dd><p>Unwrapped longitude of the ascending node <code class="reqn">\Omega</code>
(degrees without jumps).</p>
</dd>
<dt>hh</dt><dd><p>Variable: <code class="reqn">e\sin(\varpi)</code>.</p>
</dd>
<dt>kk</dt><dd><p>Variable: <code class="reqn">e\cos(\varpi)</code>.</p>
</dd>
<dt>pp</dt><dd><p>Variable: <code class="reqn">2\sin(0.5I)\sin(\Omega)</code>.</p>
</dd>
<dt>qq</dt><dd><p>Variable: <code class="reqn">2\sin(0.5I)\cos(\Omega)</code>.</p>
</dd>
<dt>cc</dt><dd><p>Helper: <code class="reqn">\cos(I)</code>.</p>
</dd>
<dt>dd</dt><dd><p>Helper: <code class="reqn">\cos(I)/2</code>.</p>
</dd>
<dt>nnx, nny, nnz</dt><dd><p>The <code class="reqn">x</code>, <code class="reqn">y</code>, and <code class="reqn">z</code>-components of the
Eart's orbit unit normal vector <code class="reqn">\vec{n}</code>, normal to Earth's
instantaneous orbital plane.</p>
</dd>
</dl>




<h3>Source</h3>

<p>All astronomical solutions by Zeebe can be found on
<a href="http://www.soest.hawaii.edu/oceanography/faculty/zeebe_files/Astro.html">http://www.soest.hawaii.edu/oceanography/faculty/zeebe_files/Astro.html</a>.
</p>
<p>They can be loaded into R quickly, using <code><a href="#topic+get_solution">get_solution()</a></code>.
</p>


<h3>References</h3>

<p>Zeebe, R. E., &amp; Lourens, L. J. (2019). Solar System chaos and the
Paleocene–Eocene boundary age constrained by geology and astronomy.
<em>Science</em>, 365(6456), 926–929. <a href="https://doi.org/10.1126/science.aax0612">doi:10.1126/science.aax0612</a>.
</p>
<p>Zeebe, R. E. and Lourens, L. J. (2022). A deep-time dating tool for
paleo-applications utilizing obliquity and precession cycles: The role of
dynamical ellipticity and tidal dissipation. <em>Paleoceanography and
Paleoclimatology</em>. <a href="https://doi.org/10.1029/2021PA004349">doi:10.1029/2021PA004349</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+prepare_solution">prepare_solution()</a></code>
</p>

<hr>
<h2 id='get_solution'>Get an Astronomical Solution</h2><span id='topic+get_solution'></span>

<h3>Description</h3>

<p>Download supported astronomical solutions from the web and store it in the
user's cache directory. The next use of the function will load the data from
the cache rather than downloading it again. This also provides a wrapper for
<code><a href="astrochron.html#topic+getLaskar">astrochron::getLaskar()</a></code> if one of their supported solutions is specified,
but converts the output to a <a href="tibble.html#topic+tibble-package">tibble</a>. Note that we
do not cache these solutions locally, however.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_solution(
  astronomical_solution = "full-ZB18a",
  quiet = FALSE,
  force = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_solution_+3A_astronomical_solution">astronomical_solution</code></td>
<td>
<p>Character vector with the name of the desired
solution. Defaults to <code>"full-ZB18a"</code>.</p>
</td></tr>
<tr><td><code id="get_solution_+3A_quiet">quiet</code></td>
<td>
<p>Be quiet?
</p>

<ul>
<li><p> If <code>TRUE</code>, hide info messages.
</p>
</li>
<li><p> If <code>FALSE</code> (the default) print info messages and timing.
</p>
</li></ul>
</td></tr>
<tr><td><code id="get_solution_+3A_force">force</code></td>
<td>
<p>Force re-downloading the results, even if the solution is saved
to the cache.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="tibble.html#topic+tibble-package">tibble</a> with the astronomical solution
(and some preprocessed new columns).
</p>


<h3>References</h3>

<p>Zeebe, R. E., &amp; Lourens, L. J. (2019). Solar System chaos and the
Paleocene–Eocene boundary age constrained by geology and astronomy.
<em>Science</em>, 365(6456), 926–929. <a href="https://doi.org/10.1126/science.aax0612">doi:10.1126/science.aax0612</a>.
</p>
<p>Zeebe, R. E. and Lourens, L. J. (2022). A deep-time dating tool for
paleo-applications utilizing obliquity and precession cycles: The role of
dynamical ellipticity and tidal dissipation. <em>Paleoceanography and
Paleoclimatology</em>. <a href="https://doi.org/10.1029/2021PA004349">doi:10.1029/2021PA004349</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+full_ZB18a">full_ZB18a</a>, <a href="#topic+ZB17">ZB17</a>, <a href="#topic+ZB18a">ZB18a</a>, <a href="#topic+ZB20">ZB20</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

get_solution("full-ZB18a")
get_solution("ZB20a")
get_solution("La11")

</code></pre>

<hr>
<h2 id='prepare_solution'>Prepare Astronomical Solution</h2><span id='topic+prepare_solution'></span>

<h3>Description</h3>

<p>Calculates helper columns from an astronomical solution input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_solution(data, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepare_solution_+3A_data">data</code></td>
<td>
<p>A data frame with the following columns:
</p>

<ul>
<li> <p><code>t</code> Time <code class="reqn">t</code> (days).
</p>
</li>
<li> <p><code>ee</code> Eccentricity <code class="reqn">e</code> (unitless).
</p>
</li>
<li> <p><code>lph</code> Longitude of perihelion <code class="reqn">\varpi</code> (degrees).
</p>
</li>
<li> <p><code>lan</code> Longitude of the ascending node <code class="reqn">\Omega</code> (degrees).
</p>
</li>
<li> <p><code>inc</code> Inclination <code class="reqn">I</code> (degrees).
</p>
</li></ul>

<p>The easiest way to get this is with <code><a href="#topic+get_solution">get_solution()</a></code>.</p>
</td></tr>
<tr><td><code id="prepare_solution_+3A_quiet">quiet</code></td>
<td>
<p>Be quiet?
</p>

<ul>
<li><p> If <code>TRUE</code>, hide info messages.
</p>
</li>
<li><p> If <code>FALSE</code> (the default) print info messages and timing.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>New columns include:
</p>

<ul>
<li> <p><code>lphu</code> Unwrapped longitude of perihelion <code class="reqn">\varpi</code> (degrees without
jumps).
</p>
</li>
<li> <p><code>lanu</code> Unwrapped longitude of the ascending node <code class="reqn">\Omega</code> (degrees
without jumps).
</p>
</li>
<li> <p><code>hh</code> Variable: <code class="reqn">e\sin(\varpi)</code>.
</p>
</li>
<li> <p><code>kk</code> Variable: <code class="reqn">e\cos(\varpi)</code>.
</p>
</li>
<li> <p><code>pp</code> Variable: <code class="reqn">2\sin(0.5I)\sin(\Omega)</code>.
</p>
</li>
<li> <p><code>qq</code> Variable: <code class="reqn">2\sin(0.5I)\cos(\Omega)</code>.
</p>
</li>
<li> <p><code>cc</code> Helper: <code class="reqn">\cos(I)</code>.
</p>
</li>
<li> <p><code>dd</code> Helper: <code class="reqn">\cos(I)/2</code>.
</p>
</li>
<li> <p><code>nnx</code>, <code>nny</code>, <code>nnz</code> The <code class="reqn">x</code>, <code class="reqn">y</code>, and <code class="reqn">z</code>-components of the
Earth's orbit unit normal vector <code class="reqn">\vec{n}</code>, normal to Earth's
instantaneous orbital plane.
</p>
</li></ul>



<h3>Value</h3>

<p>A <a href="tibble.html#topic+tibble-package">tibble</a> with the new columns added.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_solution">get_solution()</a></code>
</p>

<hr>
<h2 id='snvec'>Calculate Earth’s Obliquity and Precession in the Past</h2><span id='topic+snvec'></span>

<h3>Description</h3>

<p><code>snvec()</code> computes climatic precession and obliquity (or tilt) from an
astronomical solution (AS) input and input values for dynamical ellipticity
(<code class="reqn">E_{d}</code>) and tidal dissipation (<code class="reqn">T_{d}</code>). It solves a set
of ordinary differential equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>snvec(
  tend = -1000,
  ed = 1,
  td = 0,
  astronomical_solution = "full-ZB18a",
  os_ref_frame = "HCI",
  os_omt = NULL,
  os_inct = NULL,
  tres = -0.4,
  atol = 1e-05,
  rtol = 0,
  solver = "vode",
  quiet = FALSE,
  output = "nice"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="snvec_+3A_tend">tend</code></td>
<td>
<p>Final timestep in thousands of years (kyr).
Defaults to <code>-1000</code> kyr.</p>
</td></tr>
<tr><td><code id="snvec_+3A_ed">ed</code></td>
<td>
<p>Dynamical ellipticity <code class="reqn">E_{d}</code>, normalized to modern.
Defaults to <code>1.0</code>.</p>
</td></tr>
<tr><td><code id="snvec_+3A_td">td</code></td>
<td>
<p>Tidal dissipation <code class="reqn">T_{d}</code>, normalized to modern. Defaults
to <code>0.0</code>.</p>
</td></tr>
<tr><td><code id="snvec_+3A_astronomical_solution">astronomical_solution</code></td>
<td>
<p>Character vector with the name of the desired
solution. Defaults to <code>"full-ZB18a"</code>.</p>
</td></tr>
<tr><td><code id="snvec_+3A_os_ref_frame">os_ref_frame</code></td>
<td>
<p>Character vector with the reference frame of the astronomical
solution. Either <code>"HCI"</code> for heliocentric inertial reference frame or
<code>"J2000"</code> for ecliptic J2000 reference frame. Defaults to <code>"HCI"</code> for
<code>HNBody</code> output.</p>
</td></tr>
<tr><td><code id="snvec_+3A_os_omt">os_omt</code></td>
<td>
<p>Longitude of ascending node of the solar equator relative to ECLIPJ2000.</p>
</td></tr>
<tr><td><code id="snvec_+3A_os_inct">os_inct</code></td>
<td>
<p>Inclination of the solar equator relative to ECLIPJ2000.</p>
</td></tr>
<tr><td><code id="snvec_+3A_tres">tres</code></td>
<td>
<p>Output timestep resolution in thousands of years (kyr). Defaults
to <code>-0.4</code>. To determine the sign, think of from <code>0</code> to <code>tend</code> by timestep
<code>tres</code>.</p>
</td></tr>
<tr><td><code id="snvec_+3A_atol">atol</code></td>
<td>
<p>Numerical absolute tolerance passed to <code><a href="deSolve.html#topic+ode">deSolve::ode()</a></code>'s
<code>atol</code>. Defaults to <code>1e-5</code>.</p>
</td></tr>
<tr><td><code id="snvec_+3A_rtol">rtol</code></td>
<td>
<p>Numerical relative tolerance passed to <code><a href="deSolve.html#topic+ode">deSolve::ode()</a></code>'s
<code>rtol</code>. Defaults to <code>0</code>.</p>
</td></tr>
<tr><td><code id="snvec_+3A_solver">solver</code></td>
<td>
<p>Character vector specifying the method passed to
<code><a href="deSolve.html#topic+ode">deSolve::ode()</a></code>'s <code>method</code>. Defaults to <code>"vode"</code> for stiff problems with
a variable timestep.</p>
</td></tr>
<tr><td><code id="snvec_+3A_quiet">quiet</code></td>
<td>
<p>Be quiet?
</p>

<ul>
<li><p> If <code>TRUE</code>, hide info messages.
</p>
</li>
<li><p> If <code>FALSE</code> (the default) print info messages and timing.
</p>
</li></ul>
</td></tr>
<tr><td><code id="snvec_+3A_output">output</code></td>
<td>
<p>Character vector with name of desired output. One of:
</p>

<ul>
<li> <p><code>"nice"</code> (the default) A <a href="tibble.html#topic+tibble-package">tibble</a> with the
columns <code>time</code>, <code>eei</code>, <code>epl</code>, <code>phi</code>, <code>cp</code>.
</p>
</li>
<li> <p><code>"full"</code> A <a href="tibble.html#topic+tibble-package">tibble</a> with all the computed and
interpolated columns.
</p>
</li>
<li> <p><code>"ode"</code> A matrix with the output of the ODE solver.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a re-implementation of the C-code in the supplementary
information of Zeebe &amp; Lourens (2022). The terms are explained in detail
in Zeebe (2022).
</p>


<h3>Value</h3>

<p><code>snvec()</code> returns different output depending on the <code>outputs</code> argument.
</p>
<p>If <code>output = "nice"</code> (the default), returns a
<a href="tibble.html#topic+tibble-package">tibble</a> with the following columns:
</p>

<ul>
<li> <p><code>time</code> Time in thousands of years (kyr).
</p>
</li>
<li> <p><code>epl</code> Calculated Obliquity <code class="reqn">\epsilon</code> (radians).
</p>
</li>
<li> <p><code>phi</code> Calculated Precession <code class="reqn">\phi</code> (radians) from ECLIPJ2000.
</p>
</li>
<li> <p><code>cp</code> Calculated Climatic precession (-) as <code class="reqn">e\sin\bar{\omega}</code>.
</p>
</li></ul>

<p>where <code class="reqn">\bar{\omega}</code> is the longitude of perihelion relative to the moving equinox.
</p>
<p>If <code>output = "all"</code> (for developers), additional columns are included,
typically interpolated to output timescale.
</p>

<ul>
<li> <p><code>sx</code>, <code>sy</code>, <code>sz</code> The <code class="reqn">x</code>, <code class="reqn">y</code>, and <code class="reqn">z</code>-components of Earth's
spin axis unit vector <code class="reqn">\vec{s}</code> in the heliocentric inertial
reference frame.
</p>
</li></ul>

<p>See the source code for descriptions of all the intermediate computational
steps.
</p>
<p>If <code>output = "ode"</code>, it will return the raw output of the ODE solver, which
is an object of class <code>deSolve</code> and <code>matrix</code>, with columns <code>time</code>, <code>sx</code>,
<code>sy</code>, and <code>sz</code>. This can be useful for i.e. <code><a href="deSolve.html#topic+diagnostics">deSolve::diagnostics()</a></code>.
</p>


<h3>Reference Frames of Astronomical Solutions</h3>

<p>NASA provides their asteroid and planet positions in the ecliptic J2000
reference frame, while long-term astronomical solution integrations are
often performed in the heliocentric inertial reference frame (HCI) or in the
inertial reference frame. This is to align the reference frame with the spin
vector of the Sun, making J2 corrections intuitive to implement.
</p>
<p>Obliquity is typically given in the ecliptic reference frame, so snvec
converts all outputs to J2000 if the <code>os_ref_frame</code> is equal to <code>"HCI"</code> and
does no transformations if it is already in <code>"J2000"</code>.
</p>
<p>For this, it uses <code class="reqn">\Omega_{\odot} = 75.5940</code> and
<code class="reqn">i_{\odot} = 7.155</code> as in Zeebe (2017). You can overwrite
these defaults with <code>os_omt</code> and <code>os_inct</code> if desired.
</p>


<h3>ODE Solver</h3>

<p>Note that the different ODE solver algorithm we use (Soetaert et al.,
2010) means that the R routine returns an evenly-spaced time grid, whereas
the C-routine has a variable time-step.
This means we need to explicitly set the stepsize <code>tres</code>.
</p>


<h3>References</h3>

<p>Zeebe, R.E. (2017). Numerical Solutions for the Orbital Motion of the Solar
System over the Past 100 Myr: Limits and New Results. <em>The Astronomical
Journal</em>, 154(5), <a href="https://doi.org/10.3847/1538-3881/aa8cce">doi:10.3847/1538-3881/aa8cce</a>.
</p>
<p>Zeebe, R. E., &amp; Lourens, L. J. (2019). Solar System chaos and the
Paleocene–Eocene boundary age constrained by geology and astronomy.
<em>Science</em>, 365(6456), 926–929. <a href="https://doi.org/10.1126/science.aax0612">doi:10.1126/science.aax0612</a>.
</p>
<p>Zeebe, R. E., &amp; Lourens, L. J. (2022). A deep-time dating tool for
paleo-applications utilizing obliquity and precession cycles: The role of
dynamical ellipticity and tidal dissipation. <em>Paleoceanography and
Paleoclimatology</em>, e2021PA004349. <a href="https://doi.org/10.1029/2021PA004349">doi:10.1029/2021PA004349</a>.
</p>
<p>Zeebe, R. E. (2022). Reduced Variations in Earth’s and Mars’ Orbital
Inclination and Earth’s Obliquity from 58 to 48 Myr ago due to Solar
System Chaos. <em>The Astronomical Journal</em>, 164(3),
<a href="https://doi.org/10.3847/1538-3881/ac80f8">doi:10.3847/1538-3881/ac80f8</a>.
</p>
<p>Wikipedia page on Orbital Elements:
<a href="https://en.wikipedia.org/wiki/Orbital_elements">https://en.wikipedia.org/wiki/Orbital_elements</a>
</p>
<p>Karline Soetaert, Thomas Petzoldt, R. Woodrow Setzer (2010). Solving
Differential Equations in R: Package deSolve. Journal of Statistical
Software, 33(9), 1–25. <a href="https://doi.org/10.18637/jss.v033.i09">doi:10.18637/jss.v033.i09</a>.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="deSolve.html#topic+ode">deSolve::ode()</a></code> from Soetaert et al., (2010) for the ODE solver that we
use.
</p>
</li>
<li> <p><code><a href="#topic+get_solution">get_solution()</a></code> Get astronomical solutions.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

# default call
snvec(tend = -1e3, ed = 1, td = 0, tres = -0.4)

</code></pre>

<hr>
<h2 id='ZB17'>Astronomical Solutions ZB17 for the past 100 Myr</h2><span id='topic+ZB17'></span><span id='topic+ZB17a'></span><span id='topic+ZB17b'></span><span id='topic+ZB17c'></span><span id='topic+ZB17d'></span><span id='topic+ZB17e'></span><span id='topic+ZB17f'></span><span id='topic+ZB17h'></span><span id='topic+ZB17i'></span><span id='topic+ZB17j'></span><span id='topic+ZB17k'></span><span id='topic+ZB17p'></span>

<h3>Description</h3>

<p>Astronomical Solutions ZB17 for the past 100 Myr
</p>


<h3>Format</h3>



<h4><code>get_solution("ZB17x")</code></h4>

<p>A data frame with 62,501 rows and 3 columns:
</p>

<dl>
<dt>time</dt><dd><p>Time in thousands of years (kyr).</p>
</dd>
<dt>ecc</dt><dd><p>Eccentricity <code class="reqn">e</code> (unitless).</p>
</dd>
<dt>inc</dt><dd><p>Inclination <code class="reqn">I</code> (degrees).</p>
</dd>
</dl>




<h3>Source</h3>

<p>All astronomical solutions by Zeebe can be found on
<a href="http://www.soest.hawaii.edu/oceanography/faculty/zeebe_files/Astro.html">http://www.soest.hawaii.edu/oceanography/faculty/zeebe_files/Astro.html</a>.
</p>
<p>They can be loaded into R quickly, using <code><a href="#topic+get_solution">get_solution()</a></code>.
</p>


<h3>References</h3>

<p>Zeebe, R. E. (2017). Numerical Solutions for the orbital motion of the Solar
System over the Past 100 Myr: Limits and new results. <em>The Astronomical
Journal</em>. <a href="https://doi.org/10.3847/1538-3881/aa8cce">doi:10.3847/1538-3881/aa8cce</a>
</p>

<hr>
<h2 id='ZB18a_100'>Astronomical Solution ZB18a for the Past 100 Myr</h2><span id='topic+ZB18a_100'></span><span id='topic++22ZB18a-100+22'></span>

<h3>Description</h3>

<p>Astronomical Solution ZB18a for the Past 100 Myr
</p>


<h3>Format</h3>



<h4><code>get_solution("ZB18a-100")</code></h4>

<p>A data frame with 62,501 rows and 3 columns:
</p>

<dl>
<dt>time</dt><dd><p>Time in thousands of years (kyr).</p>
</dd>
<dt>ecc</dt><dd><p>Eccentricity <code class="reqn">e</code> (unitless).</p>
</dd>
<dt>inc</dt><dd><p>Inclination <code class="reqn">I</code> (degrees).</p>
</dd>
</dl>




<h3>Source</h3>

<p>All astronomical solutions by Zeebe can be found on
<a href="http://www.soest.hawaii.edu/oceanography/faculty/zeebe_files/Astro.html">http://www.soest.hawaii.edu/oceanography/faculty/zeebe_files/Astro.html</a>.
</p>
<p>They can be loaded into R quickly, using <code><a href="#topic+get_solution">get_solution()</a></code>.
</p>


<h3>References</h3>

<p>Zeebe, R. E., &amp; Lourens, L. J. (2019). Solar System chaos and the
Paleocene–Eocene boundary age constrained by geology and astronomy.
<em>Science</em>, 365(6456), 926–929. <a href="https://doi.org/10.1126/science.aax0612">doi:10.1126/science.aax0612</a>.'
</p>

<hr>
<h2 id='ZB18a_300'>Astronomical Solution ZB18a for the Past 300 Myr</h2><span id='topic+ZB18a_300'></span><span id='topic+ZB18a'></span><span id='topic++22ZB18a-300+22'></span>

<h3>Description</h3>

<p>Astronomical Solution ZB18a for the Past 300 Myr
</p>


<h3>Format</h3>



<h4><code>get_solution("ZB18a-300")</code></h4>

<p>A data frame with 187,501 rows and 3 columns:
</p>

<dl>
<dt>time</dt><dd><p>Time in thousands of years (kyr).</p>
</dd>
<dt>ecc</dt><dd><p>Eccentricity <code class="reqn">e</code> (unitless).</p>
</dd>
<dt>inc</dt><dd><p>Inclination <code class="reqn">I</code> (degrees).</p>
</dd>
</dl>




<h3>Source</h3>

<p>All astronomical solutions by Zeebe can be found on
<a href="http://www.soest.hawaii.edu/oceanography/faculty/zeebe_files/Astro.html">http://www.soest.hawaii.edu/oceanography/faculty/zeebe_files/Astro.html</a>.
</p>
<p>They can be loaded into R quickly, using <code><a href="#topic+get_solution">get_solution()</a></code>.
</p>


<h3>References</h3>

<p>Zeebe, R. E., &amp; Lourens, L. J. (2019). Solar System chaos and the
Paleocene–Eocene boundary age constrained by geology and astronomy.
<em>Science</em>, 365(6456), 926–929. <a href="https://doi.org/10.1126/science.aax0612">doi:10.1126/science.aax0612</a>.'
</p>
<p>Zeebe, R. E. and Lourens, L. J. (2022). Geologically constrained
astronomical solutions for the Cenozoic era. <em>Earth and Planetary Science
Letters</em>. <a href="https://doi.org/10.1016/j.epsl.2022.117595">doi:10.1016/j.epsl.2022.117595</a>
</p>

<hr>
<h2 id='ZB20'>Astronomical Solutions ZB20 for the past 300 Myr</h2><span id='topic+ZB20'></span><span id='topic+ZB20a'></span><span id='topic+ZB20b'></span><span id='topic+ZB20c'></span><span id='topic+ZB20d'></span>

<h3>Description</h3>

<p>Astronomical Solutions ZB20 for the past 300 Myr
</p>


<h3>Format</h3>



<h4><code>get_solution("ZB20x")</code></h4>

<p>A data frame with 187,501 rows and 3 columns:
</p>

<dl>
<dt>time</dt><dd><p>Time in thousands of years (kyr).</p>
</dd>
<dt>ee</dt><dd><p>Eccentricity <code class="reqn">e</code> (unitless).</p>
</dd>
<dt>inc</dt><dd><p>Inclination <code class="reqn">I</code> (degrees).</p>
</dd>
</dl>




<h3>Source</h3>

<p>All astronomical solutions by Zeebe can be found on
<a href="http://www.soest.hawaii.edu/oceanography/faculty/zeebe_files/Astro.html">http://www.soest.hawaii.edu/oceanography/faculty/zeebe_files/Astro.html</a>.
</p>
<p>They can be loaded into R quickly, using <code><a href="#topic+get_solution">get_solution()</a></code>.
</p>


<h3>References</h3>

<p>Zeebe, R. E. and Lourens, L. J. (2022). Geologically constrained
astronomical solutions for the Cenozoic era. <em>Earth and Planetary Science
Letters</em>. <a href="https://doi.org/10.1016/j.epsl.2022.117595">doi:10.1016/j.epsl.2022.117595</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
