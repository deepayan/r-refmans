<!DOCTYPE html><html><head><title>Help for package Rnest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rnest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#achim'><p>A list of seven correlation matrices.</p></a></li>
<li><a href='#briggs_maccallum2003'><p>A list of three correlation matrice.</p></a></li>
<li><a href='#caron2016'><p>A list of six correlation matrice composed of nine variables with three factors.</p></a></li>
<li><a href='#cormat'><p>A list containing 120 correlation matrices</p></a></li>
<li><a href='#cormat.l'><p>A list containing 120 lists of correlation matrices and their underlying characteristics</p></a></li>
<li><a href='#ex_2factors'><p>A correlation matrix composed of 2 factors.</p></a></li>
<li><a href='#ex_3factors_doub_unique'><p>A correlation matrix composed of two factors, a double factor and a unique variable.</p></a></li>
<li><a href='#ex_4factors_corr'><p>A correlation matrix composed of 4 correlated factors.</p></a></li>
<li><a href='#genr8'><p>Simplify the the generation from a Multivariate Normal Distributions</p></a></li>
<li><a href='#loadings'><p>Print Loadings in NEST</p></a></li>
<li><a href='#meek_bouchard'><p>A correlation matrix given by Meek-Bouchard.</p></a></li>
<li><a href='#nest'><p>Nest Eigenvalue Sufficiency Test (NEST)</p></a></li>
<li><a href='#pa'><p>Parallel analysis</p></a></li>
<li><a href='#plot.nest'><p>Print results of NEST</p></a></li>
<li><a href='#print.nest'><p>Print results of NEST</p></a></li>
<li><a href='#summary.nest'><p>Summary results of NEST</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Next Eigenvalue Sufficiency Test</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Determine the number of dimensions to retain in exploratory factor analysis. The main function, nest(), returns the solution and the plot(nest()) returns a plot.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>crayon (&ge; 1.4.0), ggplot2 (&ge; 3.3.0), scales (&ge; 1.0.0),
EFA.MRFA (&ge; 1.1.2), fungible (&ge; 2.3), MASS (&ge; 7.3-58.1)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-17 17:21:15 UTC; pocar</td>
</tr>
<tr>
<td>Author:</td>
<td>P.-O. Caron <a href="https://orcid.org/0000-0001-6346-5583"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>P.-O. Caron &lt;pocaron19@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-21 13:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='achim'>A list of seven correlation matrices.</h2><span id='topic+achim'></span>

<h3>Description</h3>

<p>A a list of seven correlation matrices. Given by Achim, A (personal communication).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>achim
</code></pre>


<h3>Format</h3>

<p>A 12 by 12 correlation matrix
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>

<hr>
<h2 id='briggs_maccallum2003'>A list of three correlation matrice.</h2><span id='topic+briggs_maccallum2003'></span>

<h3>Description</h3>

<p>See Briggs, N. E., &amp; MacCallum, R. C. (2003). Recovery of weak common factors by Maximum likelihood and ordinary least squares estimation. <em>Multivariate Nehavioral Research</em>, <em>38</em>(1), 25â€“56. <a href="https://doi.org/10.1207/S15327906MBR3801_2">doi:10.1207/S15327906MBR3801_2</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>briggs_maccallum2003
</code></pre>


<h3>Format</h3>

<p>A a list of three correlation matrices found in Briggs &amp; MacCullum (2003).
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>

<hr>
<h2 id='caron2016'>A list of six correlation matrice composed of nine variables with three factors.</h2><span id='topic+caron2016'></span>

<h3>Description</h3>

<p>See Caron, P.-O. (2016). A Monte Carlo examination of the broken-stick distribution to identify components to retain in principal component analysis. <em>Journal of Statistical Computation and Simulation</em>, <em>86</em>(12), 2405-2410. <a href="https://doi.org/10.1080/00949655.2015.1112390">doi:10.1080/00949655.2015.1112390</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caron2016
</code></pre>


<h3>Format</h3>

<p>A list of six 9 x 9 correlation matrices found in Caron (2016).
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>

<hr>
<h2 id='cormat'>A list containing 120 correlation matrices</h2><span id='topic+cormat'></span>

<h3>Description</h3>

<p>A list containing 120 <code class="reqn">24 \times 24</code> correlation matrices 
(R) built to represent different factor structures.
Details are found in the 'cormat.l' data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cormat
</code></pre>


<h3>Format</h3>

<p>A a list of 120 correlation matrices
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>

<hr>
<h2 id='cormat.l'>A list containing 120 lists of correlation matrices and their underlying characteristics</h2><span id='topic+cormat.l'></span>

<h3>Description</h3>

<p>A list containing 120 lists of <code class="reqn">24 \times 24</code> correlation matrices 
(R) built to represent different factor structures.
Different levels of loadings (delta, .4, .5, .6, .7, .8), 
correlation between factors (corrfact, .0, .1, .2 .3), and.
number of factors (nfactors, 1:8) are used. The list contained 
matrice (R), and their underlying characteristics (delta, corrfact, 
and nfactors).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cormat.l
</code></pre>


<h3>Format</h3>

<p>A list containing 120 matrices
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>

<hr>
<h2 id='ex_2factors'>A correlation matrix composed of 2 factors.</h2><span id='topic+ex_2factors'></span>

<h3>Description</h3>

<p>A correlation matrix composed of 10 items based on 2 factors with 5 variables
each and loadings equals to .80.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ex_2factors
</code></pre>


<h3>Format</h3>

<p>A 10 by 10 correlation matrix
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>

<hr>
<h2 id='ex_3factors_doub_unique'>A correlation matrix composed of two factors, a double factor and a unique variable.</h2><span id='topic+ex_3factors_doub_unique'></span>

<h3>Description</h3>

<p>A correlation matrix composed of 10 items based on two main factors among which there is
two cross-loadings. There is also a double factors and an unique variable.
Given by Achim, A. (personal communication).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ex_3factors_doub_unique
</code></pre>


<h3>Format</h3>

<p>A 10 by 10 correlation matrix
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>

<hr>
<h2 id='ex_4factors_corr'>A correlation matrix composed of 4 correlated factors.</h2><span id='topic+ex_4factors_corr'></span>

<h3>Description</h3>

<p>A correlation matrix composed of 12 items based on 4 factors with 3 variables
each. Loadings equals to .9, .9, and .3. Factors 1 and 2, and factors 3 and 4 are 
correlated at .7. Given by Achim, A (personal communication).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ex_4factors_corr
</code></pre>


<h3>Format</h3>

<p>A 12 by 12 correlation matrix
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>

<hr>
<h2 id='genr8'>Simplify the the generation from a Multivariate Normal Distributions</h2><span id='topic+genr8'></span>

<h3>Description</h3>

<p>Speeds up the use of MASS::mvrnorm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genr8(n = 1, R = diag(10), mean = rep(0, ncol(R)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genr8_+3A_n">n</code></td>
<td>
<p>the number of samples required.</p>
</td></tr>
<tr><td><code id="genr8_+3A_r">R</code></td>
<td>
<p>a positive-definite symmetric matrix specifying the covariance matrix of the variables.</p>
</td></tr>
<tr><td><code id="genr8_+3A_mean">mean</code></td>
<td>
<p>an optinal vector giving the means of the variables. Default is 0.</p>
</td></tr>
<tr><td><code id="genr8_+3A_...">...</code></td>
<td>
<p>Arguments for <code>MASS::mvrnorm()</code>, such as <code>tol</code>, <code>empirical</code>, and <code>EISPACK</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of size n by ncol(R).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(19)
R &lt;- caron2016$mat1
mydata &lt;- genr8(n = nrow(R)+1, R = R, empirical = TRUE)
round(mydata, 2)
round(cov(mydata), 2)
</code></pre>

<hr>
<h2 id='loadings'>Print Loadings in NEST</h2><span id='topic+loadings'></span>

<h3>Description</h3>

<p>Print Loadings in NEST
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadings(x, nfactors = x$nfactors, method = x$method, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadings_+3A_x">x</code></td>
<td>
<p>An object of class &quot;nest&quot;.</p>
</td></tr>
<tr><td><code id="loadings_+3A_nfactors">nfactors</code></td>
<td>
<p>The number of factors to retains.</p>
</td></tr>
<tr><td><code id="loadings_+3A_method">method</code></td>
<td>
<p>A method used to compute loadings and uniquenesses.</p>
</td></tr>
<tr><td><code id="loadings_+3A_...">...</code></td>
<td>
<p>Further arguments to methods in &quot;nest&quot; or the <code>stats::loadings</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code class="reqn">p \times k</code> matrix containing loadings where <code class="reqn">p</code> is the number of variables and <code class="reqn">k</code> is the number of factors (<code>nfactors</code>).
</p>


<h3>Note</h3>

<p>See <code>stats::loadings</code> for the original documentation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- nest(ex_2factors, n = 100)
loadings(results)
</code></pre>

<hr>
<h2 id='meek_bouchard'>A correlation matrix given by Meek-Bouchard.</h2><span id='topic+meek_bouchard'></span>

<h3>Description</h3>

<p>An empirical correlation matrix composed of 44 items given by Meek-Bouchard, C. (personal communication).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meek_bouchard
</code></pre>


<h3>Format</h3>

<p>A 44 by 44 correlation matrix
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>

<hr>
<h2 id='nest'>Nest Eigenvalue Sufficiency Test (NEST)</h2><span id='topic+nest'></span>

<h3>Description</h3>

<p><code>nest</code> is used to identify the number of factors to retain in exploratory factor analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nest(
  data,
  n = NULL,
  nrep = 1000,
  alpha = 0.05,
  max.fact = ncol(data),
  method = "ml",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nest_+3A_data">data</code></td>
<td>
<p>A data frame, a numeric matrix, covariance matrix or correlation matrix from which to determine the number of factors.</p>
</td></tr>
<tr><td><code id="nest_+3A_n">n</code></td>
<td>
<p>The number of cases (subjects, participants, or units) if a covariance matrix is supplied in <code>data</code>.</p>
</td></tr>
<tr><td><code id="nest_+3A_nrep">nrep</code></td>
<td>
<p>The number of replications to simulate. Default is 1000.</p>
</td></tr>
<tr><td><code id="nest_+3A_alpha">alpha</code></td>
<td>
<p>A vector of type I error rates or <code>(1-alpha)*100%</code> confidence intervals. Default is .05.</p>
</td></tr>
<tr><td><code id="nest_+3A_max.fact">max.fact</code></td>
<td>
<p>An optional maximum number of factor to extract. Default is <code>max.fact = ncol(data)</code>.</p>
</td></tr>
<tr><td><code id="nest_+3A_method">method</code></td>
<td>
<p>A method used to compute loadings and uniquenesses. Four methods are implemented in <code>Rnest</code> : maximum likelihood <code>method = "ml"</code> (default), regularized common factor analysis <code>method = "rcfa"</code>, minimum rank factor analysis <code>method = "mrfa"</code>, and principal axis factoring <code>method = "paf"</code>. See details for custom methods.</p>
</td></tr>
<tr><td><code id="nest_+3A_...">...</code></td>
<td>
<p>Arguments for <code>method</code> that can be supplied. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Next Eigenvalues Sufficiency Test (NEST) is an extension of parallel analysis by adding a sequential hypothesis testing procedure for every <code class="reqn">k = 1, ..., p</code> factor until the hypothesis is not rejected. 
</p>
<p>At <code class="reqn">k = 1</code>, NEST and parallel analysis are identical. Both use an Identity matrix as the correlation matrix. Once the first hypothesis is rejected, NEST uses a correlation matrix based on the loadings and uniquenesses of the <code class="reqn">k^{th}</code> factorial structure. NEST then resamples the eigenvalues of this new correlation matrix. NEST stops when the $k_1^2$ eigenvalues is within the confidence interval.  
</p>
<p>There is two <code>method</code> already implemented in <code>nest</code> to extract loadings and uniquenesses: maximum likelihood (<code>"ml"</code>; default), principal axis factoring (<code>"paf"</code>), and minimum rank factor analysis (<code>"mrfa"</code>). The functions use as arguments: <code>covmat</code>, <code>n</code>, <code>factors</code>, and <code>...</code> (supplementary arguments passed by <code>nest</code>). They return <code>loadings</code> and <code>uniquenesses</code>. Any other user-defined functions can be used as long as it is programmed likewise.
</p>


<h3>Value</h3>

<p><code>nest</code> returns an object of class <code>nest</code>. The functions <code>summary</code> and <code>plot</code> are used to obtain and show a summary of the results.
</p>
<p>An object of class <code>nest</code> is a list containing the following components:
</p>

<ul>
<li> <p><code>nfactors</code> - The number of factors to retains (one by <code>alpha</code>).
</p>
</li>
<li> <p><code>cor</code> - The supplied correlation matrix.
</p>
</li>
<li> <p><code>n</code> - The number of cases (subjects, participants, or units).
</p>
</li>
<li> <p><code>values</code> - The eigenvalues of the supplied correlation matrix.
</p>
</li>
<li> <p><code>alpha</code> - The type I error rate.
</p>
</li>
<li> <p><code>method</code> - The method used to compute loadings and uniquenesses.
</p>
</li>
<li> <p><code>nrep</code> - The number of replications used.
</p>
</li>
<li> <p><code>prob</code> - Probabilities of each factor.
</p>
</li>
<li> <p><code>Eig</code> - A list of simulated eigenvalues.
</p>
</li></ul>



<h3>Generic function</h3>

<p><code>plot.nest</code> Scree plot of the eigenvalues and the simulated confidence intervals for <code>alpha</code>.
</p>
<p><code>loadings</code> Extract loadings. It does not overwrite <code>stat::loadings</code>.
</p>


<h3>Author(s)</h3>

<p>P.-O. Caron
</p>


<h3>References</h3>

<p>Achim, A. (2017). Testing the number of required dimensions in exploratory factor analysis. <em>The Quantitative Methods for Psychology</em>, <em>13</em>(1), 64-74. <a href="https://doi.org/10.20982/tqmp.13.1.p064">doi:10.20982/tqmp.13.1.p064</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nest(ex_2factors, n = 100)
nest(mtcars)
</code></pre>

<hr>
<h2 id='pa'>Parallel analysis</h2><span id='topic+pa'></span>

<h3>Description</h3>

<p>Parallel analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pa(
  data = NULL,
  n = NULL,
  p = NULL,
  nrep = 1000,
  alpha = 0.05,
  crit = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pa_+3A_data">data</code></td>
<td>
<p>data.frame.</p>
</td></tr>
<tr><td><code id="pa_+3A_n">n</code></td>
<td>
<p>number of subjects.</p>
</td></tr>
<tr><td><code id="pa_+3A_p">p</code></td>
<td>
<p>number of variables.</p>
</td></tr>
<tr><td><code id="pa_+3A_nrep">nrep</code></td>
<td>
<p>number of replications.</p>
</td></tr>
<tr><td><code id="pa_+3A_alpha">alpha</code></td>
<td>
<p>type I error rate.</p>
</td></tr>
<tr><td><code id="pa_+3A_crit">crit</code></td>
<td>
<p>Critical values to compare the eigenvalues.</p>
</td></tr>
<tr><td><code id="pa_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nfactors (if data is supplied) and sampled eigenvalues
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pa(ex_2factors, n = 42)
E &lt;- pa(n = 10, p = 2, nrep = 5)
</code></pre>

<hr>
<h2 id='plot.nest'>Print results of NEST</h2><span id='topic+plot.nest'></span>

<h3>Description</h3>

<p>Scree plot of the eigenvalues and the <code>(1-alpha)*100%</code> confidence intervals derived from the resampled eigenvalues supplied to <code>nest</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nest'
plot(x, pa = FALSE, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.nest_+3A_x">x</code></td>
<td>
<p>An object of class &quot;nest&quot;.</p>
</td></tr>
<tr><td><code id="plot.nest_+3A_pa">pa</code></td>
<td>
<p>Show results of Parallel Analysis.</p>
</td></tr>
<tr><td><code id="plot.nest_+3A_y">y</code></td>
<td>
<p>Further arguments for other methods, ignored for &quot;nest&quot;.</p>
</td></tr>
<tr><td><code id="plot.nest_+3A_...">...</code></td>
<td>
<p>Further arguments for other methods, ignored for &quot;nest&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot output.
</p>


<h3>Note</h3>

<p>This function is more interesting with many <code>alpha</code> values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- nest(ex_2factors, n = 100, alpha = c(.01, .05, .01))
plot(results)
# Return the data used to produce the plot
df &lt;- plot(results)$data
</code></pre>

<hr>
<h2 id='print.nest'>Print results of NEST</h2><span id='topic+print.nest'></span>

<h3>Description</h3>

<p>Print the number of factors to retain according to confidence levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.nest_+3A_x">x</code></td>
<td>
<p>An object of class &quot;nest&quot;.</p>
</td></tr>
<tr><td><code id="print.nest_+3A_...">...</code></td>
<td>
<p>Further arguments for other methods, ignored for &quot;nest&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- nest(ex_2factors, n = 100)
print(results)
</code></pre>

<hr>
<h2 id='summary.nest'>Summary results of NEST</h2><span id='topic+summary.nest'></span>

<h3>Description</h3>

<p>summary method for class &quot;nest&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nest'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.nest_+3A_object">object</code></td>
<td>
<p>An object of class &quot;nest&quot;.</p>
</td></tr>
<tr><td><code id="summary.nest_+3A_...">...</code></td>
<td>
<p>Further arguments for other methods, ignored for &quot;nest&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- nest(ex_2factors, n = 100)
summary(results)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
