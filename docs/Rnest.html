<!DOCTYPE html><html lang="en"><head><title>Help for package Rnest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rnest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#achim'><p>A list of seven correlation matrices.</p></a></li>
<li><a href='#achim24'><p>A correlation matrix composed of six factors.</p></a></li>
<li><a href='#BartlettSphericity'><p>Bartlett Sphericity Test</p></a></li>
<li><a href='#briggs_maccallum2003'><p>A list of three correlation matrices.</p></a></li>
<li><a href='#caron2016'><p>A list of six correlation matrices composed of nine variables with three factors and different levels of correlations between factors.</p></a></li>
<li><a href='#caron2019'><p>A list of 15 correlation matrices composed of nine variables with three factors and different levels of correlations between factors.</p></a></li>
<li><a href='#cormat'><p>A list containing 120 correlation matrices.</p></a></li>
<li><a href='#cormat.l'><p>A list containing 120 lists of correlation matrices and their underlying characteristics.</p></a></li>
<li><a href='#cov_nest'><p>Compute covariance or correlation matrix with treatments for clusters and missing values</p></a></li>
<li><a href='#covFIML'><p>Full Information Maximum Likelihood (FIML) correlation or covariance matrix</p></a></li>
<li><a href='#EKC'><p>Empirical Kaiser Criterion (EKC)</p></a></li>
<li><a href='#ex_2factors'><p>A correlation matrix composed of 2 factors.</p></a></li>
<li><a href='#ex_3factors_doub_unique'><p>A correlation matrix composed of two factors, a doublet factor and a unique variable.</p></a></li>
<li><a href='#ex_4factors_corr'><p>A correlation matrix composed of 4 correlated factors.</p></a></li>
<li><a href='#ex_mqr'><p>A correlation matrix from chapter 19 Explorer of Méthodes quantitatives avec R (MQR).</p></a></li>
<li><a href='#genr8'><p>Simplify the the generation from a multivariate normal distributions.</p></a></li>
<li><a href='#Ledermann'><p>Ledermann bound.</p></a></li>
<li><a href='#loadings'><p>Print Loadings in NEST</p></a></li>
<li><a href='#MAP'><p>Minimum average partial correlation (MAP)</p></a></li>
<li><a href='#meek_bouchard'><p>A correlation matrix from Meek-Bouchard.</p></a></li>
<li><a href='#nest'><p>Next Eigenvalue Sufficiency Test (NEST)</p></a></li>
<li><a href='#pa'><p>Parallel analysis</p></a></li>
<li><a href='#plot.nest'><p>Plot results of Next Eigenvalues Sufficiency Test (NEST)</p></a></li>
<li><a href='#print.nest'><p>Print results of NEST</p></a></li>
<li><a href='#remove_unique'><p>Remove unique variables</p></a></li>
<li><a href='#shem'><p>Split-Half Eigenvector Matching (SHEM)</p></a></li>
<li><a href='#summary.nest'><p>Summary results of NEST</p></a></li>
<li><a href='#tabachnick_fidell2019'><p>A covariance matrix composed of 11 variables.</p></a></li>
<li><a href='#unique_variable'><p>Probability of unique variables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Next Eigenvalue Sufficiency Test</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Determine the number of dimensions to retain in exploratory factor analysis. The main function, nest(), returns the solution and the plot(nest()) returns a plot.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>crayon (&ge; 1.4.0), ggplot2 (&ge; 3.3.0), scales (&ge; 1.0.0),
EFA.MRFA (&ge; 1.1.2), fungible (&ge; 2.3), MASS (&ge; 7.3-58.1),
lavaan (&ge; 0.6), mvtnorm (&ge; 1.1)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-24 20:17:17 UTC; pocar</td>
</tr>
<tr>
<td>Author:</td>
<td>P.-O. Caron <a href="https://orcid.org/0000-0001-6346-5583"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>P.-O. Caron &lt;pocaron19@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-24 20:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='achim'>A list of seven correlation matrices.</h2><span id='topic+achim'></span>

<h3>Description</h3>

<p>A list of seven correlation matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>achim
</code></pre>


<h3>Format</h3>

<p>A list of correlation matrices.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Achim, A. (personal communication).
</p>

<hr>
<h2 id='achim24'>A correlation matrix composed of six factors.</h2><span id='topic+achim24'></span>

<h3>Description</h3>

<p>A correlation matrix composed of 18 items based on six factors. Four have more than 
three variables, three variables have crossloadings (items 6, 7 and 13), two are 
doublets factors (items 13-14, 15-16), and there is two unique variables (17 and 18).
Loadings range between .40 and .80.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>achim24
</code></pre>


<h3>Format</h3>

<p>A 18 by 18 correlation matrix.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Achim, A. (2024, April 4). <em>Signal cancellation factor analysis</em>. PsyArXiv, 1–13. <a href="https://doi.org/10.31234/osf.io/h7qwg">doi:10.31234/osf.io/h7qwg</a>
</p>

<hr>
<h2 id='BartlettSphericity'>Bartlett Sphericity Test</h2><span id='topic+BartlettSphericity'></span>

<h3>Description</h3>

<p><code>BartlettSphericity</code> tests if variables are orthogonal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BartlettSphericity(R, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BartlettSphericity_+3A_r">R</code></td>
<td>
<p>the correlation matrix.</p>
</td></tr>
<tr><td><code id="BartlettSphericity_+3A_n">n</code></td>
<td>
<p>the sample size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code class="reqn">\chi^2</code> test of the correlation matrix <code>R</code> with sample size <code>n</code>.
</p>


<h3>Author(s)</h3>

<p>André Achim (Matlab)
</p>
<p>P.-O. Caron (R)
</p>


<h3>References</h3>

<p>Bartlett, M. S. (1937). Properties of sufficiency and statistical tests. <em>Proceedings of the Royal Statistical Society, Series A</em>, <em>160</em>, 268–282
</p>


<h3>Examples</h3>

<pre><code class='language-R'>BartlettSphericity(ex_4factors_corr, 42)
</code></pre>

<hr>
<h2 id='briggs_maccallum2003'>A list of three correlation matrices.</h2><span id='topic+briggs_maccallum2003'></span>

<h3>Description</h3>

<p>A list of three correlation matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>briggs_maccallum2003
</code></pre>


<h3>Format</h3>

<p>A a list of three correlation matrices.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Briggs, N. E., &amp; MacCallum, R. C. (2003). Recovery of weak common factors by Maximum likelihood and ordinary least squares estimation. <em>Multivariate Nehavioral Research</em>, <em>38</em>(1), 25–56. <a href="https://doi.org/10.1207/S15327906MBR3801_2">doi:10.1207/S15327906MBR3801_2</a>
</p>

<hr>
<h2 id='caron2016'>A list of six correlation matrices composed of nine variables with three factors and different levels of correlations between factors.</h2><span id='topic+caron2016'></span>

<h3>Description</h3>

<p>A list of six correlation matrices composed of nine variables with three factors and different levels of correlations between factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caron2016
</code></pre>


<h3>Format</h3>

<p>A list of six 9 x 9 correlation matrices.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Caron, P.-O. (2016). A Monte Carlo examination of the broken-stick distribution to identify components to retain in principal component analysis. <em>Journal of Statistical Computation and Simulation</em>, <em>86</em>(12), 2405-2410. <a href="https://doi.org/10.1080/00949655.2015.1112390">doi:10.1080/00949655.2015.1112390</a>
</p>

<hr>
<h2 id='caron2019'>A list of 15 correlation matrices composed of nine variables with three factors and different levels of correlations between factors.</h2><span id='topic+caron2019'></span>

<h3>Description</h3>

<p>A list of 15 correlation matrices composed of nine variables with three factors and different levels of correlations between factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caron2019
</code></pre>


<h3>Format</h3>

<p>A list of 15 9 x 9 correlation matrices.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Caron, P.-O. (2019). Minimum average partial correlation and parallel analysis : The influence of oblique structures. <em>Communications in Statistics - Simulation and Computation</em>, <em>48</em>(7), 2110-2117. <a href="https://doi.org/10.1080/03610918.2018.1433843">doi:10.1080/03610918.2018.1433843</a>
</p>

<hr>
<h2 id='cormat'>A list containing 120 correlation matrices.</h2><span id='topic+cormat'></span>

<h3>Description</h3>

<p>A list containing 120 <code class="reqn">24 \times 24</code> correlation matrices 
(R) built to represent different factor structures.
Details are found in the 'cormat.l' data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cormat
</code></pre>


<h3>Format</h3>

<p>A a list of 120 correlation matrices.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Caron, P.-O. (2025). A comparison of the Next Eigenvalue Sufficiency Test to other stopping rules for the number of factors in factor analysis. <em>Educational and Psychological Measurement</em>. <a href="https://doi.org/10.1177/00131644241308528">doi:10.1177/00131644241308528</a>
</p>

<hr>
<h2 id='cormat.l'>A list containing 120 lists of correlation matrices and their underlying characteristics.</h2><span id='topic+cormat.l'></span>

<h3>Description</h3>

<p>A list containing 120 lists of <code class="reqn">24 \times 24</code> correlation matrices 
(R) built to represent different factor structures.
Different levels of loadings (delta, .4, .5, .6, .7, .8), 
correlation between factors (corrfact, .0, .1, .2 .3), and.
number of factors (nfactors, 1:8) are used. The list contained 
matrice (R), and their underlying characteristics (delta, corrfact, 
and nfactors).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cormat.l
</code></pre>


<h3>Format</h3>

<p>A list containing 120 matrices.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>See Caron, P.-O. (2025). A comparison of the Next Eigenvalue Sufficiency Test to other stopping rules for the number of factors in factor analysis. <em>Educational and Psychological Measurement</em>. <a href="https://doi.org/10.1177/00131644241308528">doi:10.1177/00131644241308528</a>
</p>

<hr>
<h2 id='cov_nest'>Compute covariance or correlation matrix with treatments for clusters and missing values</h2><span id='topic+cov_nest'></span><span id='topic+cor_nest'></span>

<h3>Description</h3>

<p>Compute covariance or correlation matrix with treatments for clusters and missing values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor_nest(.data, ..., cluster = NULL, missing = "fiml", pvalue = FALSE)

cov_nest(.data, ..., cluster = NULL, missing = "fiml", pvalue = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cov_nest_+3A_.data">.data</code></td>
<td>
<p>a data frame, a numeric matrix.</p>
</td></tr>
<tr><td><code id="cov_nest_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
<tr><td><code id="cov_nest_+3A_cluster">cluster</code></td>
<td>
<p>a variable name defining the clusters in a two-level dataset in the data frame.</p>
</td></tr>
<tr><td><code id="cov_nest_+3A_missing">missing</code></td>
<td>
<p>treatment to deal with missing values. Options are <code>"listwise"</code> or <code>"pairwise"</code>. Default if <code>"fiml"</code>.</p>
</td></tr>
<tr><td><code id="cov_nest_+3A_pvalue">pvalue</code></td>
<td>
<p>an argument to indicate if <code class="reqn">p</code>-values are required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class &quot;covnest&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cov_nest(airquality)
</code></pre>

<hr>
<h2 id='covFIML'>Full Information Maximum Likelihood (FIML) correlation or covariance matrix</h2><span id='topic+covFIML'></span><span id='topic+corFIML'></span>

<h3>Description</h3>

<p>Full Information Maximum Likelihood (FIML) correlation or covariance matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covFIML(data, tol = 1e-6, maxiter = 1000, pvalue = FALSE)

corFIML(data, tol = 1e-6, maxiter = 1000, pvalue = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="covFIML_+3A_data">data</code></td>
<td>
<p>a data frame of rdata matrix.</p>
</td></tr>
<tr><td><code id="covFIML_+3A_tol">tol</code></td>
<td>
<p>tolerance.</p>
</td></tr>
<tr><td><code id="covFIML_+3A_maxiter">maxiter</code></td>
<td>
<p>maximum number of iterations.</p>
</td></tr>
<tr><td><code id="covFIML_+3A_pvalue">pvalue</code></td>
<td>
<p>an argument to indicate if <code class="reqn">p</code>-values are required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the means, th correlation or covariance matrix, and optionnaly the degree of freedom and the p-values.
</p>


<h3>Note</h3>

<p>A not so efficient function. See <code>?cor_nest</code> instead.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>covFIML(airquality)
</code></pre>

<hr>
<h2 id='EKC'>Empirical Kaiser Criterion (EKC)</h2><span id='topic+EKC'></span><span id='topic+ekc'></span>

<h3>Description</h3>

<p>Empirical Kaiser Criterion (EKC)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EKC(.data = NULL, n = NULL, nv = NULL, lowest.eig = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EKC_+3A_.data">.data</code></td>
<td>
<p>a data frame, a numeric matrix, covariance matrix or correlation matrix from which to determine the number of factors.</p>
</td></tr>
<tr><td><code id="EKC_+3A_n">n</code></td>
<td>
<p>the number of cases (subjects, participants, or units) if a covariance matrix is supplied in <code>.data</code>.</p>
</td></tr>
<tr><td><code id="EKC_+3A_nv">nv</code></td>
<td>
<p>the number of variables if the critical values are required.</p>
</td></tr>
<tr><td><code id="EKC_+3A_lowest.eig">lowest.eig</code></td>
<td>
<p>minimal eigenvalues to retain. Default is Kaiser's suggestion of 1.</p>
</td></tr>
<tr><td><code id="EKC_+3A_...">...</code></td>
<td>
<p>further argument for <code>cor_nest()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The number of factors to retain or the crititical eigenvalues.
</p>


<h3>References</h3>

<p>Braeken, J., &amp; van Assen, M. A. L. M. (2017). An empirical Kaiser criterion. <em>Psychological Methods</em>, <em>22</em>(3), 450–466. <a href="https://doi.org/10.1037/met0000074">doi:10.1037/met0000074</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>EKC(ex_4factors_corr, n = 42)
</code></pre>

<hr>
<h2 id='ex_2factors'>A correlation matrix composed of 2 factors.</h2><span id='topic+ex_2factors'></span>

<h3>Description</h3>

<p>A correlation matrix composed of 10 items based on 2 factors with 5 variables
each and loadings equals to .80.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ex_2factors
</code></pre>


<h3>Format</h3>

<p>A 10 by 10 correlation matrix.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Caron, P.-O. (2025). <em>Rnest: An R package for the Next Eigenvalue Sufficiency Test</em>. <a href="https://github.com/quantmeth/Rnest">https://github.com/quantmeth/Rnest</a>
</p>

<hr>
<h2 id='ex_3factors_doub_unique'>A correlation matrix composed of two factors, a doublet factor and a unique variable.</h2><span id='topic+ex_3factors_doub_unique'></span>

<h3>Description</h3>

<p>A correlation matrix composed of 10 items based on two main factors among which there is
two cross-loadings. There is also a doublet factors and an unique variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ex_3factors_doub_unique
</code></pre>


<h3>Format</h3>

<p>A 10 by 10 correlation matrix.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Achim, A. (personal communication).
</p>

<hr>
<h2 id='ex_4factors_corr'>A correlation matrix composed of 4 correlated factors.</h2><span id='topic+ex_4factors_corr'></span>

<h3>Description</h3>

<p>A correlation matrix composed of 12 items based on 4 factors with 3 variables
each. Loadings equals to .9, .9, and .3. Factors 1 and 2, and factors 3 and 4 are 
correlated at .7.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ex_4factors_corr
</code></pre>


<h3>Format</h3>

<p>A 12 by 12 correlation matrix.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Achim, A (personal communication).
</p>

<hr>
<h2 id='ex_mqr'>A correlation matrix from chapter 19 Explorer of Méthodes quantitatives avec R (MQR).</h2><span id='topic+ex_mqr'></span>

<h3>Description</h3>

<p>A population correlation matrix composed of 6 items from a two factor stucture. Factor 1 is based on items 1 to 3 and 6, and Factor 2 is based on items 4 to 6.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ex_mqr
</code></pre>


<h3>Format</h3>

<p>A 6 by 6 correlation matrix.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Caron, P.-O. (2024). <em>Méthodes quantitatives avec R</em>. <a href="https://mqr.teluq.ca">https://mqr.teluq.ca</a>
</p>

<hr>
<h2 id='genr8'>Simplify the the generation from a multivariate normal distributions.</h2><span id='topic+genr8'></span>

<h3>Description</h3>

<p>Speed up the use of <code>MASS::mvrnorm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genr8(n = 1, R = diag(10), mean = rep(0, ncol(R)), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="genr8_+3A_n">n</code></td>
<td>
<p>the number of samples required.</p>
</td></tr>
<tr><td><code id="genr8_+3A_r">R</code></td>
<td>
<p>a positive-definite symmetric matrix specifying the covariance matrix of the variables.</p>
</td></tr>
<tr><td><code id="genr8_+3A_mean">mean</code></td>
<td>
<p>an optinal vector giving the means of the variables. Default is 0.</p>
</td></tr>
<tr><td><code id="genr8_+3A_...">...</code></td>
<td>
<p>arguments for <code>MASS::mvrnorm()</code>, such as <code>tol</code>, <code>empirical</code>, and <code>EISPACK</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of size <code>n</code> by <code>ncol(R)</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(19)
R &lt;- caron2016$mat1
mydata &lt;- genr8(n = nrow(R)+1, R = R, empirical = TRUE)
round(mydata, 2)
round(cov(mydata), 2)
</code></pre>

<hr>
<h2 id='Ledermann'>Ledermann bound.</h2><span id='topic+Ledermann'></span>

<h3>Description</h3>

<p>Returns the maximum number of latent factors in a factor analysis model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ledermann(p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Ledermann_+3A_p">p</code></td>
<td>
<p>The number of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Ledermann bound.
</p>


<h3>Author(s)</h3>

<p>André Achim (Matlab)
</p>
<p>P.-O. Caron (R)
</p>


<h3>References</h3>

<p>Ledermann, W. (1937). On the rank of reduced correlation matrices in multiple factor analysis. <em>Psychometrika</em>, 2, 85–93.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Ledermann(ncol(ex_4factors_corr))
</code></pre>

<hr>
<h2 id='loadings'>Print Loadings in NEST</h2><span id='topic+loadings'></span>

<h3>Description</h3>

<p>Print Loadings in NEST
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadings(x, nfactors = x$nfactors, method = x$method, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loadings_+3A_x">x</code></td>
<td>
<p>an object of class &quot;nest&quot;.</p>
</td></tr>
<tr><td><code id="loadings_+3A_nfactors">nfactors</code></td>
<td>
<p>the number of factors to retains.</p>
</td></tr>
<tr><td><code id="loadings_+3A_method">method</code></td>
<td>
<p>a method used to compute loadings and uniquenesses.</p>
</td></tr>
<tr><td><code id="loadings_+3A_...">...</code></td>
<td>
<p>further arguments to methods in &quot;nest&quot; or the <code>stats::loadings</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code class="reqn">p \times k</code> matrix containing loadings where <code class="reqn">p</code> is the number of variables and <code class="reqn">k</code> is the number of factors (<code>nfactors</code>).
</p>


<h3>Note</h3>

<p>See <code>stats::loadings</code> for the original documentation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- nest(ex_2factors, n = 100)
loadings(results)
</code></pre>

<hr>
<h2 id='MAP'>Minimum average partial correlation (MAP)</h2><span id='topic+MAP'></span><span id='topic+map'></span>

<h3>Description</h3>

<p>Minimum average partial correlation (MAP)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAP(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MAP_+3A_.data">.data</code></td>
<td>
<p>a data frame, a numeric matrix, covariance matrix or correlation matrix from which to determine the number of factors.</p>
</td></tr>
<tr><td><code id="MAP_+3A_...">...</code></td>
<td>
<p>further argument for <code>cor_nest()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The number of factors to retain.
</p>


<h3>References</h3>

<p>Velicer, W. F. (1976). Determining the number of components from the matrix of partial correlations. <em>Psychometrika</em>, <em>41</em>(3), 321-327. <a href="https://doi.org/10.1007/BF02293557">doi:10.1007/BF02293557</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>D &lt;- genr8(n = 42, R = ex_4factors_corr)
MAP(D)
</code></pre>

<hr>
<h2 id='meek_bouchard'>A correlation matrix from Meek-Bouchard.</h2><span id='topic+meek_bouchard'></span>

<h3>Description</h3>

<p>A sample correlation matrix composed of 44 items.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meek_bouchard
</code></pre>


<h3>Format</h3>

<p>A 44 by 44 correlation matrix.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Meek-Bouchard, C. (personal communication).
</p>

<hr>
<h2 id='nest'>Next Eigenvalue Sufficiency Test (NEST)</h2><span id='topic+nest'></span><span id='topic+NEST'></span>

<h3>Description</h3>

<p><code>nest</code> is used to identify the number of factors to retain in exploratory factor analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nest(
  .data,
  ...,
  n = NULL,
  nreps = 1000,
  alpha = 0.05,
  max.fact = TRUE,
  method = "ml",
  na.action = "fiml"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nest_+3A_.data">.data</code></td>
<td>
<p>a data frame, a numeric matrix, covariance matrix or correlation matrix from which to determine the number of factors.</p>
</td></tr>
<tr><td><code id="nest_+3A_...">...</code></td>
<td>
<p>arguments for <code>method</code> that can be supplied. See details.</p>
</td></tr>
<tr><td><code id="nest_+3A_n">n</code></td>
<td>
<p>the number of cases (subjects, participants, or units) if a covariance matrix is supplied in <code>.data</code>.</p>
</td></tr>
<tr><td><code id="nest_+3A_nreps">nreps</code></td>
<td>
<p>the number of replications to simulate. Default is 1000.</p>
</td></tr>
<tr><td><code id="nest_+3A_alpha">alpha</code></td>
<td>
<p>a vector of type I error rates or <code>(1-alpha)*100%</code> confidence intervals. Default is .05.</p>
</td></tr>
<tr><td><code id="nest_+3A_max.fact">max.fact</code></td>
<td>
<p>an optional maximum number of factor to extract. Default is <code>TRUE</code>, so maximum number possible.</p>
</td></tr>
<tr><td><code id="nest_+3A_method">method</code></td>
<td>
<p>a method used to compute loadings and uniquenesses. Four methods are implemented in <code>Rnest</code> : maximum likelihood <code>method = "ml"</code> (default), regularized common factor analysis <code>method = "rcfa"</code>, minimum rank factor analysis <code>method = "mrfa"</code>, and principal axis factoring <code>method = "paf"</code>. See details for custom methods.</p>
</td></tr>
<tr><td><code id="nest_+3A_na.action">na.action</code></td>
<td>
<p>how should missing data be removed. <code>"na.omit"</code> removes complete rows with at least one single missing data. <code>"fiml"</code> uses full information maximum likelihood to compute the correlation matrix. Other options are <code>"everything"</code>, <code>"all.obs"</code>, <code>"complete.obs"</code>, <code>"na.or.complete"</code>, or <code>"pairwise.complete.obs"</code>. Default is <code>"fiml"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Next Eigenvalues Sufficiency Test (NEST) is an extension of parallel analysis by adding a sequential hypothesis testing procedure for every <code class="reqn">k = 1, ..., p</code> factor until the hypothesis is not rejected. 
</p>
<p>At <code class="reqn">k = 1</code>, NEST and parallel analysis are identical. Both use an Identity matrix as the correlation matrix. Once the first hypothesis is rejected, NEST uses a correlation matrix based on the loadings and uniquenesses of the <code class="reqn">k^{th}</code> factorial structure. NEST then resamples the eigenvalues of this new correlation matrix. NEST stops when the <code class="reqn">k^{th}</code> eigenvalues is within the confidence interval.  
</p>
<p>There is four <code>method</code> already implemented in <code>nest</code> to extract loadings and uniquenesses: maximum likelihood (<code>"ml"</code>; default), principal axis factoring (<code>"paf"</code>), regularized common factor analysis <code>method = "rcfa"</code>, and minimum rank factor analysis (<code>"mrfa"</code>). The functions use as arguments: <code>covmat</code>, <code>n</code>, <code>factors</code>, and <code>...</code> (supplementary arguments passed by <code>nest</code>). They return <code>loadings</code> and <code>uniquenesses</code>. Any other user-defined functions can be used as long as it is programmed likewise.
</p>


<h3>Value</h3>

<p><code>nest()</code> returns an object of class <code>nest</code>. The functions <code>summary</code> and <code>plot</code> are used to obtain and show a summary of the results.
</p>
<p>An object of class <code>nest</code> is a list containing the following components:
</p>

<ul>
<li> <p><code>nfactors</code> - The number of factors to retains (one by <code>alpha</code>).
</p>
</li>
<li> <p><code>cor</code> - The supplied correlation matrix.
</p>
</li>
<li> <p><code>n</code> - The number of cases (subjects, participants, or units).
</p>
</li>
<li> <p><code>values</code> - The eigenvalues of the supplied correlation matrix.
</p>
</li>
<li> <p><code>alpha</code> - The type I error rate.
</p>
</li>
<li> <p><code>method</code> - The method used to compute loadings and uniquenesses.
</p>
</li>
<li> <p><code>nreps</code> - The number of replications used.
</p>
</li>
<li> <p><code>prob</code> - Probabilities of each factor.
</p>
</li>
<li> <p><code>Eig</code> - A list of simulated eigenvalues.
</p>
</li></ul>



<h3>Generic function</h3>

<p><code>plot.nest</code> Scree plot of the eigenvalues and the simulated confidence intervals for <code>alpha</code>.
</p>
<p><code>loadings</code> Extract loadings. It does not overwrite <code>stat::loadings</code>.
</p>
<p><code>summary.nest</code> Summary statistics for the number of factors.
</p>


<h3>Author(s)</h3>

<p>P.-O. Caron
</p>


<h3>References</h3>

<p>Achim, A. (2017). Testing the number of required dimensions in exploratory factor analysis. <em>The Quantitative Methods for Psychology</em>, <em>13</em>(1), 64-74. <a href="https://doi.org/10.20982/tqmp.13.1.p064">doi:10.20982/tqmp.13.1.p064</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nest(ex_2factors, n = 100)
nest(mtcars)
</code></pre>

<hr>
<h2 id='pa'>Parallel analysis</h2><span id='topic+pa'></span><span id='topic+PA'></span>

<h3>Description</h3>

<p>Parallel analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pa(
  data = NULL,
  n = NULL,
  nv = NULL,
  nreps = 1000,
  alpha = 0.05,
  crit = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pa_+3A_data">data</code></td>
<td>
<p>a data.frame.</p>
</td></tr>
<tr><td><code id="pa_+3A_n">n</code></td>
<td>
<p>the number of subjects.</p>
</td></tr>
<tr><td><code id="pa_+3A_nv">nv</code></td>
<td>
<p>the number of variables.</p>
</td></tr>
<tr><td><code id="pa_+3A_nreps">nreps</code></td>
<td>
<p>the number of replications.</p>
</td></tr>
<tr><td><code id="pa_+3A_alpha">alpha</code></td>
<td>
<p>type I error rate.</p>
</td></tr>
<tr><td><code id="pa_+3A_crit">crit</code></td>
<td>
<p>critical values to compare the eigenvalues.</p>
</td></tr>
<tr><td><code id="pa_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nfactors (if data is supplied) and sampled eigenvalues
</p>


<h3>References</h3>

<p>Horn, J. L. (1965). A rationale and test for the number of factors in factor analysis. <em>Psychometrika</em>, <em>30</em>(2), 179–185. <a href="https://doi.org/10.1007/BF02289447">doi:10.1007/BF02289447</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pa(ex_2factors, n = 42)
pa(n = 10, nv = 2, nreps = 100)
</code></pre>

<hr>
<h2 id='plot.nest'>Plot results of Next Eigenvalues Sufficiency Test (NEST)</h2><span id='topic+plot.nest'></span>

<h3>Description</h3>

<p>Scree plot of the eigenvalues and the <code>(1-alpha)*100%</code> confidence intervals derived from the resampled eigenvalues supplied to <code>nest</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nest'
plot(x, pa = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.nest_+3A_x">x</code></td>
<td>
<p>an object of class &quot;nest&quot;.</p>
</td></tr>
<tr><td><code id="plot.nest_+3A_pa">pa</code></td>
<td>
<p>show results of Parallel Analysis.</p>
</td></tr>
<tr><td><code id="plot.nest_+3A_...">...</code></td>
<td>
<p>further arguments for other methods, ignored for &quot;nest&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot output.
</p>


<h3>Note</h3>

<p>This function is more interesting with many <code>alpha</code> values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- nest(ex_2factors, n = 100, alpha = c(.01, .05, .01))
plot(results)
# Return the data used to produce the plot
df &lt;- plot(results)$data
</code></pre>

<hr>
<h2 id='print.nest'>Print results of NEST</h2><span id='topic+print.nest'></span>

<h3>Description</h3>

<p>Print the number of factors to retain according to confidence levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.nest_+3A_x">x</code></td>
<td>
<p>an object of class &quot;nest&quot;.</p>
</td></tr>
<tr><td><code id="print.nest_+3A_...">...</code></td>
<td>
<p>further arguments for other methods, ignored for &quot;nest&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- nest(ex_2factors, n = 100)
print(results)
</code></pre>

<hr>
<h2 id='remove_unique'>Remove unique variables</h2><span id='topic+remove_unique'></span>

<h3>Description</h3>

<p>Remove unique variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_unique(.data, ..., alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="remove_unique_+3A_.data">.data</code></td>
<td>
<p>a data frame, a numeric matrix, covariance matrix or correlation matrix from which to determine the number of factors.</p>
</td></tr>
<tr><td><code id="remove_unique_+3A_...">...</code></td>
<td>
<p>further arguments for <code>unique_variable()</code> and <code>cor_nest()</code>.</p>
</td></tr>
<tr><td><code id="remove_unique_+3A_alpha">alpha</code></td>
<td>
<p>type I error rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the unique variables and a data frame containing their probabilities and the <code>.data</code> with the unique variable removed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>remove_unique(ex_3factors_doub_unique, n = 420)
</code></pre>

<hr>
<h2 id='shem'>Split-Half Eigenvector Matching (SHEM)</h2><span id='topic+shem'></span>

<h3>Description</h3>

<p><code>shem</code> estimates the number of principal components via Split-Half Eigenvector Matching (SHEM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shem(data, nIts = 30)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shem_+3A_data">data</code></td>
<td>
<p>a data frame, a numeric matrix, covariance matrix or correlation matrix from which to determine the number of factors.</p>
</td></tr>
<tr><td><code id="shem_+3A_nits">nIts</code></td>
<td>
<p>number of iterations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>shem</code> returns a list containing the number of components, <code>nfactors</code>, whether the additional step in case of zero true latent components was carried, <code>zeroComponents</code>, the <code>eigenvalues</code> and the <code>eigenvectors</code> of the solution.
</p>


<h3>References</h3>

<p>Galdwin, T. E. (2023) Estimating the number of principal components via Split-Half Eigenvector Matching (SHEM). <em>MethodsX</em>, <em>11</em>, 102286. <a href="https://doi.org/10.1016/j.mex.2023.102286">doi:10.1016/j.mex.2023.102286</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>jd &lt;- genr8(n = 404, R = ex_4factors_corr)
shem(jd)
</code></pre>

<hr>
<h2 id='summary.nest'>Summary results of NEST</h2><span id='topic+summary.nest'></span>

<h3>Description</h3>

<p>summary method for class &quot;nest&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nest'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.nest_+3A_object">object</code></td>
<td>
<p>an object of class &quot;nest&quot;.</p>
</td></tr>
<tr><td><code id="summary.nest_+3A_...">...</code></td>
<td>
<p>further arguments for other methods, ignored for &quot;nest&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No returned value, called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- nest(ex_2factors, n = 100)
summary(results)
</code></pre>

<hr>
<h2 id='tabachnick_fidell2019'>A covariance matrix composed of 11 variables.</h2><span id='topic+tabachnick_fidell2019'></span>

<h3>Description</h3>

<p>A sample covariance matrix composed of 11 items based on two factors according to Tabachnick and Fidell (2019, see, 576-578).
The first five variables are related to &quot;Verbak IQ&quot;, the next five are related to &quot;Performance IQ&quot;.
The last variable <code>CODING</code> is unique. Loadings range between .39 and .76.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tabachnick_fidell2019
</code></pre>


<h3>Format</h3>

<p>A 11 by 11 covariance matrix.
</p>


<h3>Source</h3>

<p><a href="https://github.com/quantmeth">https://github.com/quantmeth</a>
</p>


<h3>References</h3>

<p>Tabachnick, B. G., &amp; Fidell, L. S. (2019). <em>Using multivariate statistics</em>. Allyn and Bacon. p. 576-577.
</p>

<hr>
<h2 id='unique_variable'>Probability of unique variables</h2><span id='topic+unique_variable'></span>

<h3>Description</h3>

<p>Probability of unique variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unique_variable(.data, n = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unique_variable_+3A_.data">.data</code></td>
<td>
<p>a data frame, a numeric matrix, covariance matrix or correlation matrix from which to determine the number of factors.</p>
</td></tr>
<tr><td><code id="unique_variable_+3A_n">n</code></td>
<td>
<p>the number of cases (subjects, participants, or units) if a covariance matrix is supplied in <code>.data</code>.</p>
</td></tr>
<tr><td><code id="unique_variable_+3A_...">...</code></td>
<td>
<p>further arguments for <code>cov_nest()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the F-values and probabilities of the variable to be an unique variable.
</p>


<h3>Author(s)</h3>

<p>P.-O. Caron (R)
André Achim (Matlab)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exData &lt;- genr8(n = 420, R = ex_3factors_doub_unique)
unique_variable(exData)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
