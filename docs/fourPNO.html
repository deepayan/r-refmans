<!DOCTYPE html><html><head><title>Help for package fourPNO</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fourPNO}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fourPNO-package'><p>fourPNO: Bayesian 4 Parameter Item Response Model</p></a></li>
<li><a href='#Gibbs_2PNO'><p>Gibbs Implementation of 2PNO</p></a></li>
<li><a href='#Gibbs_4PNO'><p>Gibbs Implementation of 4PNO</p></a></li>
<li><a href='#min2LL_4pno'><p>Compute 4PNO Deviance</p></a></li>
<li><a href='#rmvnorm'><p>Generate Random Multivariate Normal Distribution</p></a></li>
<li><a href='#Total_Tabulate'><p>Calculate Tabulated Total Scores</p></a></li>
<li><a href='#Y_4pno_simulate'><p>Simulate from 4PNO Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian 4 Parameter Item Response Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate Barton &amp; Lord's (1981) &lt;<a href="https://doi.org/10.1002%2Fj.2333-8504.1981.tb01255.x">doi:10.1002/j.2333-8504.1981.tb01255.x</a>&gt; 
    four parameter IRT model with lower and upper asymptotes using Bayesian
    formulation described by Culpepper (2016) &lt;<a href="https://doi.org/10.1007%2Fs11336-015-9477-6">doi:10.1007/s11336-015-9477-6</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/tmsalab/fourPNO">https://github.com/tmsalab/fourPNO</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tmsalab/fourPNO/issues">https://github.com/tmsalab/fourPNO/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo (&ge; 0.9.200)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-09-23 22:19:50 UTC; jjb</td>
</tr>
<tr>
<td>Author:</td>
<td>Steven Andrew Culpepper
    <a href="https://orcid.org/0000-0003-4226-6176"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Steven Andrew Culpepper &lt;sculpepp@illinois.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-09-24 04:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fourPNO-package'>fourPNO: Bayesian 4 Parameter Item Response Model</h2><span id='topic+fourPNO'></span><span id='topic+fourPNO-package'></span>

<h3>Description</h3>

<p>Estimate Barton &amp; Lord's (1981) &lt;doi:10.1002/j.2333-8504.1981.tb01255.x&gt; 
four parameter IRT model with lower and upper asymptotes using Bayesian
formulation described by Culpepper (2016) &lt;doi:10.1007/s11336-015-9477-6&gt;.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Steven Andrew Culpepper <a href="mailto:sculpepp@illinois.edu">sculpepp@illinois.edu</a> (0000-0003-4226-6176) [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/tmsalab/fourPNO">https://github.com/tmsalab/fourPNO</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/tmsalab/fourPNO/issues">https://github.com/tmsalab/fourPNO/issues</a>
</p>
</li></ul>


<hr>
<h2 id='Gibbs_2PNO'>Gibbs Implementation of 2PNO</h2><span id='topic+Gibbs_2PNO'></span>

<h3>Description</h3>

<p>Implement Gibbs 2PNO Sampler
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gibbs_2PNO(Y, mu_xi, Sigma_xi_inv, mu_theta, Sigma_theta_inv, burnin,
  chain_length = 10000L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Gibbs_2PNO_+3A_y">Y</code></td>
<td>
<p>A N by J <code>matrix</code> of item responses.</p>
</td></tr>
<tr><td><code id="Gibbs_2PNO_+3A_mu_xi">mu_xi</code></td>
<td>
<p>A two dimensional <code>vector</code> of prior item parameter
means.</p>
</td></tr>
<tr><td><code id="Gibbs_2PNO_+3A_sigma_xi_inv">Sigma_xi_inv</code></td>
<td>
<p>A two dimensional identity <code>matrix</code> of prior item
parameter VC matrix.</p>
</td></tr>
<tr><td><code id="Gibbs_2PNO_+3A_mu_theta">mu_theta</code></td>
<td>
<p>The prior mean for theta.</p>
</td></tr>
<tr><td><code id="Gibbs_2PNO_+3A_sigma_theta_inv">Sigma_theta_inv</code></td>
<td>
<p>The prior inverse variance for theta.</p>
</td></tr>
<tr><td><code id="Gibbs_2PNO_+3A_burnin">burnin</code></td>
<td>
<p>The number of MCMC samples to discard.</p>
</td></tr>
<tr><td><code id="Gibbs_2PNO_+3A_chain_length">chain_length</code></td>
<td>
<p>The number of MCMC samples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Samples from posterior.
</p>


<h3>Author(s)</h3>

<p>Steven Andrew Culpepper
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate small 2PNO dataset to demonstrate function
J = 5
N = 100

# Population item parameters
as_t = rnorm(J,mean=2,sd=.5)
bs_t = rnorm(J,mean=0,sd=.5)

# Sampling gs and ss with truncation
gs_t = rbeta(J,1,8)
ps_g = pbeta(1-gs_t,1,8)
ss_t = qbeta(runif(J)*ps_g,1,8)
theta_t = rnorm(N)
Y_t = Y_4pno_simulate(N,J,as=as_t,bs=bs_t,gs=gs_t,ss=ss_t,theta=theta_t)

# Setting prior parameters
mu_theta = 0
Sigma_theta_inv = 1
mu_xi = c(0,0)
alpha_c = alpha_s = beta_c = beta_s = 1
Sigma_xi_inv = solve(2*matrix(c(1,0,0,1), 2, 2))
burnin = 1000

# Execute Gibbs sampler. This should take about 15.5 minutes
out_t = Gibbs_4PNO(Y_t,mu_xi,Sigma_xi_inv,mu_theta,Sigma_theta_inv,
                    alpha_c,beta_c,alpha_s, beta_s,burnin,
                    rep(1,J),rep(1,J),gwg_reps=5,chain_length=burnin*2)

# Summarizing posterior distribution
OUT = cbind(
    apply(out_t$AS[, -c(1:burnin)], 1, mean),
    apply(out_t$BS[, -c(1:burnin)], 1, mean),
    apply(out_t$GS[, -c(1:burnin)], 1, mean),
    apply(out_t$SS[, -c(1:burnin)], 1, mean),
    apply(out_t$AS[, -c(1:burnin)], 1, sd),
    apply(out_t$BS[, -c(1:burnin)], 1, sd),
    apply(out_t$GS[, -c(1:burnin)], 1, sd),
    apply(out_t$SS[, -c(1:burnin)], 1, sd)
)
OUT = cbind(1:J, OUT)
colnames(OUT) = c('Item','as','bs','gs','ss','as_sd','bs_sd',
                  'gs_sd','ss_sd')
print(OUT, digits = 3)
</code></pre>

<hr>
<h2 id='Gibbs_4PNO'>Gibbs Implementation of 4PNO</h2><span id='topic+Gibbs_4PNO'></span>

<h3>Description</h3>

<p>Internal function to -2LL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gibbs_4PNO(Y, mu_xi, Sigma_xi_inv, mu_theta, Sigma_theta_inv, alpha_c,
  beta_c, alpha_s, beta_s, burnin, cTF, sTF, gwg_reps,
  chain_length = 10000L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Gibbs_4PNO_+3A_y">Y</code></td>
<td>
<p>A N by J <code>matrix</code> of item responses.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_mu_xi">mu_xi</code></td>
<td>
<p>A two dimensional <code>vector</code> of prior item parameter
means.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_sigma_xi_inv">Sigma_xi_inv</code></td>
<td>
<p>A two dimensional identity <code>matrix</code> of prior item
parameter VC matrix.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_mu_theta">mu_theta</code></td>
<td>
<p>The prior mean for theta.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_sigma_theta_inv">Sigma_theta_inv</code></td>
<td>
<p>The prior inverse variance for theta.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_alpha_c">alpha_c</code></td>
<td>
<p>The lower asymptote prior 'a' parameter.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_beta_c">beta_c</code></td>
<td>
<p>The lower asymptote prior 'b' parameter.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_alpha_s">alpha_s</code></td>
<td>
<p>The upper asymptote prior 'a' parameter.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_beta_s">beta_s</code></td>
<td>
<p>The upper asymptote prior 'b' parameter.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_burnin">burnin</code></td>
<td>
<p>The number of MCMC samples to discard.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_ctf">cTF</code></td>
<td>
<p>A J dimensional <code>vector</code> indicating which
lower asymptotes to estimate.
0 = exclude lower asymptote and
1 = include lower asymptote.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_stf">sTF</code></td>
<td>
<p>A J dimensional <code>vector</code> indicating which
upper asymptotes to estimate.
0 = exclude upper asymptote and
1 = include upper asymptote.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_gwg_reps">gwg_reps</code></td>
<td>
<p>The number of Gibbs within Gibbs MCMC samples for
marginal distribution of gamma. Values between
5 to 10 are adequate.</p>
</td></tr>
<tr><td><code id="Gibbs_4PNO_+3A_chain_length">chain_length</code></td>
<td>
<p>The number of MCMC samples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Samples from posterior.
</p>


<h3>Author(s)</h3>

<p>Steven Andrew Culpepper
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate small 4PNO dataset to demonstrate function
J = 5
N = 100

# Population item parameters
as_t = rnorm(J,mean=2,sd=.5)
bs_t = rnorm(J,mean=0,sd=.5)

# Sampling gs and ss with truncation
gs_t = rbeta(J,1,8)
ps_g = pbeta(1-gs_t,1,8)
ss_t = qbeta(runif(J)*ps_g,1,8)
theta_t &lt;- rnorm(N)
Y_t = Y_4pno_simulate(N,J,as=as_t,bs=bs_t,gs=gs_t,ss=ss_t,theta=theta_t)

# Setting prior parameters
mu_theta=0
Sigma_theta_inv=1
mu_xi = c(0,0)
alpha_c=alpha_s=beta_c=beta_s=1
Sigma_xi_inv = solve(2*matrix(c(1,0,0,1),2,2))
burnin = 1000

# Execute Gibbs sampler
out_t = Gibbs_4PNO(Y_t,mu_xi,Sigma_xi_inv,mu_theta,
                   Sigma_theta_inv,alpha_c,beta_c,alpha_s,
                   beta_s,burnin,rep(1,J),rep(1,J),
                   gwg_reps=5,chain_length=burnin*2)

# Summarizing posterior distribution
OUT = cbind(apply(out_t$AS[,-c(1:burnin)],1,mean),
            apply(out_t$BS[,-c(1:burnin)],1,mean),
            apply(out_t$GS[,-c(1:burnin)],1,mean),
            apply(out_t$SS[,-c(1:burnin)],1,mean),
            apply(out_t$AS[,-c(1:burnin)],1,sd),
            apply(out_t$BS[,-c(1:burnin)],1,sd),
            apply(out_t$GS[,-c(1:burnin)],1,sd),
            apply(out_t$SS[,-c(1:burnin)],1,sd) )

OUT = cbind(1:J,OUT)
colnames(OUT) = c('Item', 'as', 'bs', 'gs', 'ss', 'as_sd', 'bs_sd',
                  'gs_sd', 'ss_sd')
print(OUT, digits = 3)
</code></pre>

<hr>
<h2 id='min2LL_4pno'>Compute 4PNO Deviance</h2><span id='topic+min2LL_4pno'></span>

<h3>Description</h3>

<p>Internal function to -2LL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>min2LL_4pno(N, J, Y, as, bs, gs, ss, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="min2LL_4pno_+3A_n">N</code></td>
<td>
<p>An <code>int</code>, which gives the number of observations.  (&gt; 0)</p>
</td></tr>
<tr><td><code id="min2LL_4pno_+3A_j">J</code></td>
<td>
<p>An <code>int</code>, which gives the number of items.  (&gt; 0)</p>
</td></tr>
<tr><td><code id="min2LL_4pno_+3A_y">Y</code></td>
<td>
<p>A N by J <code>matrix</code> of item responses.</p>
</td></tr>
<tr><td><code id="min2LL_4pno_+3A_as">as</code></td>
<td>
<p>A <code>vector</code> of item discrimination parameters.</p>
</td></tr>
<tr><td><code id="min2LL_4pno_+3A_bs">bs</code></td>
<td>
<p>A <code>vector</code> of item threshold parameters.</p>
</td></tr>
<tr><td><code id="min2LL_4pno_+3A_gs">gs</code></td>
<td>
<p>A <code>vector</code> of item lower asymptote parameters.</p>
</td></tr>
<tr><td><code id="min2LL_4pno_+3A_ss">ss</code></td>
<td>
<p>A <code>vector</code> of item upper asymptote parameters.</p>
</td></tr>
<tr><td><code id="min2LL_4pno_+3A_theta">theta</code></td>
<td>
<p>A <code>vector</code> of prior thetas.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>-2LL.
</p>


<h3>Author(s)</h3>

<p>Steven Andrew Culpepper
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Gibbs_4PNO">Gibbs_4PNO()</a></code>
</p>

<hr>
<h2 id='rmvnorm'>Generate Random Multivariate Normal Distribution</h2><span id='topic+rmvnorm'></span>

<h3>Description</h3>

<p>Creates a random Multivariate Normal when given number of
obs, mean, and sigma.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmvnorm(n, mu, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmvnorm_+3A_n">n</code></td>
<td>
<p>An <code>int</code>, which gives the number of observations.  (&gt; 0)</p>
</td></tr>
<tr><td><code id="rmvnorm_+3A_mu">mu</code></td>
<td>
<p>A <code>vector</code> length m that represents the means of
the normals.</p>
</td></tr>
<tr><td><code id="rmvnorm_+3A_sigma">sigma</code></td>
<td>
<p>A <code>matrix</code> with dimensions m x m that provides the
covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> that is a Multivariate Normal distribution
</p>


<h3>Author(s)</h3>

<p>James J Balamuta
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Call with the following data:
rmvnorm(2, c(0,0), diag(2))
</code></pre>

<hr>
<h2 id='Total_Tabulate'>Calculate Tabulated Total Scores</h2><span id='topic+Total_Tabulate'></span>

<h3>Description</h3>

<p>Internal function to -2LL
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Total_Tabulate(N, J, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Total_Tabulate_+3A_n">N</code></td>
<td>
<p>An <code>int</code>, which gives the number of observations. (&gt; 0)</p>
</td></tr>
<tr><td><code id="Total_Tabulate_+3A_j">J</code></td>
<td>
<p>An <code>int</code>, which gives the number of items. (&gt; 0)</p>
</td></tr>
<tr><td><code id="Total_Tabulate_+3A_y">Y</code></td>
<td>
<p>A N by J <code>matrix</code> of item responses.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of tabulated total scores.
</p>


<h3>Author(s)</h3>

<p>Steven Andrew Culpepper
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Gibbs_4PNO">Gibbs_4PNO()</a></code>
</p>

<hr>
<h2 id='Y_4pno_simulate'>Simulate from 4PNO Model</h2><span id='topic+Y_4pno_simulate'></span>

<h3>Description</h3>

<p>Generate item responses under the 4PNO
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Y_4pno_simulate(N, J, as, bs, gs, ss, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Y_4pno_simulate_+3A_n">N</code></td>
<td>
<p>An <code>int</code>, which gives the number of observations. (&gt; 0)</p>
</td></tr>
<tr><td><code id="Y_4pno_simulate_+3A_j">J</code></td>
<td>
<p>An <code>int</code>, which gives the number of items. (&gt; 0)</p>
</td></tr>
<tr><td><code id="Y_4pno_simulate_+3A_as">as</code></td>
<td>
<p>A <code>vector</code> of item discrimination parameters.</p>
</td></tr>
<tr><td><code id="Y_4pno_simulate_+3A_bs">bs</code></td>
<td>
<p>A <code>vector</code> of item threshold parameters.</p>
</td></tr>
<tr><td><code id="Y_4pno_simulate_+3A_gs">gs</code></td>
<td>
<p>A <code>vector</code> of item lower asymptote parameters.</p>
</td></tr>
<tr><td><code id="Y_4pno_simulate_+3A_ss">ss</code></td>
<td>
<p>A <code>vector</code> of item upper asymptote parameters.</p>
</td></tr>
<tr><td><code id="Y_4pno_simulate_+3A_theta">theta</code></td>
<td>
<p>A <code>vector</code> of prior thetas.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A N by J <code>matrix</code> of dichotomous item responses.
</p>


<h3>Author(s)</h3>

<p>Steven Andrew Culpepper
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Gibbs_4PNO">Gibbs_4PNO()</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
