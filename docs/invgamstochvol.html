<!DOCTYPE html><html><head><title>Help for package invgamstochvol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {invgamstochvol}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DrawK0'><p>Obtains a random draw from the exact posterior of the inverse volatilities.</p></a></li>
<li><a href='#extra'><p>Package to compute the log likelihood for an inverse gamma stochastic volatility model and to draw from the exact posterior of the inverse volatilities.</p></a></li>
<li><a href='#lik_clo'><p>Compute the log likelihood for an inverse gamma stochastic volatility model</p></a></li>
<li><a href='#ourgeo'><p>Computes the 2F1 Hypergeometric Function</p></a></li>
<li><a href='#US_Inf_Data'><p>Data to use in the invgamstochvol package</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Obtains the Log Likelihood for an Inverse Gamma Stochastic
Volatility Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Blessings Majoni &lt;bmayjay@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes the log likelihood for an inverse gamma stochastic volatility model using a closed form expression of the likelihood. The details of the computation of this closed form expression are given in Gonzalez and Majoni (2023) <a href="http://rcea.org/RePEc/pdf/wp23-11.pdf">http://rcea.org/RePEc/pdf/wp23-11.pdf</a> .  
    The closed form expression is obtained for a stationary inverse gamma stochastic volatility model by marginalising out the volatility. This allows the user to obtain the maximum likelihood estimator for this non linear non Gaussian state space model. In addition, the user can obtain the estimates of the smoothed volatility using the exact smoothing distributions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.10)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, spelling</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-18 06:56:39 UTC; bmayj</td>
</tr>
<tr>
<td>Author:</td>
<td>Leon Gonzalez [aut, cph],
  Blessings Majoni <a href="https://orcid.org/0009-0006-1793-1241"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-18 08:32:42 UTC</td>
</tr>
</table>
<hr>
<h2 id='DrawK0'>Obtains a random draw from the exact posterior of the inverse volatilities.</h2><span id='topic+DrawK0'></span>

<h3>Description</h3>

<p>Obtains a draw from the posterior distribution of the inverse volatilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DrawK0(AllSt, allctil, alogfac, alogfac2, alfac, n, rho, b2, nproc2=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DrawK0_+3A_allst">AllSt</code></td>
<td>
<p>Some constants obtained from the evaluation of the log likelihood using the function lik_clo</p>
</td></tr>
<tr><td><code id="DrawK0_+3A_allctil">allctil</code></td>
<td>
<p>Some constants obtained from the evaluation of the log likelihood using the function lik_clo</p>
</td></tr>
<tr><td><code id="DrawK0_+3A_alogfac">alogfac</code></td>
<td>
<p>Some constants obtained from the evaluation of the log likelihood using the function lik_clo</p>
</td></tr>
<tr><td><code id="DrawK0_+3A_alogfac2">alogfac2</code></td>
<td>
<p>Some constants obtained from the evaluation of the log likelihood using the function lik_clo</p>
</td></tr>
<tr><td><code id="DrawK0_+3A_alfac">alfac</code></td>
<td>
<p>Some constants obtained from the evaluation of the log likelihood using the function lik_clo</p>
</td></tr>
<tr><td><code id="DrawK0_+3A_n">n</code></td>
<td>
<p>Degrees of freedom.</p>
</td></tr>
<tr><td><code id="DrawK0_+3A_rho">rho</code></td>
<td>
<p>The parameter for the persistence of volatility.</p>
</td></tr>
<tr><td><code id="DrawK0_+3A_b2">b2</code></td>
<td>
<p>Level of volatility.</p>
</td></tr>
<tr><td><code id="DrawK0_+3A_nproc2">nproc2</code></td>
<td>
<p>The number of processors allocated to the calculations. The default value is set at 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with a random draw from the posterior of the inverse volatilities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##example using US inflation Data
data("US_Inf_Data")
 Ydep &lt;- as.matrix(US_Inf_Data)
 littlerho=0.95
r0=1
rho=diag(r0)*littlerho
p=4
n=4.1
T=nrow(Ydep)
Xdep &lt;- Ydep[p:(T-1),]
if (p&gt;1){
for(lagi in 2:p){
 Xdep &lt;- cbind(Xdep, Ydep[(p-lagi+1):(T-lagi),])
 }
}
T=nrow(Ydep)
Ydep &lt;- as.matrix(Ydep[(p+1):T,])
 T=nrow(Ydep)
unos &lt;- rep(1,T)
Xdep &lt;- cbind(unos, Xdep)

##obtain residuals
 bOLS &lt;- solve(t(Xdep) %*% Xdep) %*% t(Xdep) %*% Ydep
 Res= Ydep- Xdep %*% bOLS
 Res=Res[1:T,1]
 b2=solve(t(Res) %*% Res/T)*(1-rho %*% rho)/(n-2)
 Res=as.matrix(Res,ncol=1)
  
##obtain log likelihood
   LL1=lik_clo(Res,b2,n,rho)
   
##obtain smoothed estimates of volatility. First, save the constants from LL1
 deg=200
 niter=200
 AllSt=matrix(unlist(LL1[3]), ncol=1)
 allctil=matrix(unlist(LL1[4]),nrow=T, ncol=(deg+1))
 donde=(niter&gt;deg)*niter+(deg&gt;=niter)*deg 
 alogfac=matrix(unlist(LL1[5]),nrow=(deg+1),ncol=(donde+1))
 alogfac2=matrix(unlist(LL1[6]), ncol=1)
 alfac=matrix(unlist(LL1[7]), ncol=1)
        
 milaK=0
 repli=5
  keep0=matrix(0,nrow=repli, ncol=1)
        for (jj in 1:repli)
       {
          laK=DrawK0(AllSt,allctil,alogfac, alogfac2, alfac, n, rho, b2, nproc2=2)
          
           milaK=milaK+1/laK*(1/repli)
          keep0[jj]=mean(1/laK)/b2
        }
        ccc=1/b2
        fefo=(milaK[1:T])*ccc
        
##moving average of squared residuals
        mRes=matrix(0,nrow=T,ncol=1)
           Res2=Res*Res
         bandi=5
       for (iter in 1:T)
        {  low=(iter-bandi)*(iter&gt;bandi)+1*(iter&lt;=bandi)
          up=(iter+bandi)*(iter&lt;=(T-bandi))+T*(iter&gt;(T-bandi))
          mRes[iter]=mean(Res2[low:up])
        }
        
##plot the results
       plot(fefo,type="l", col = "red", xlab="Time",ylab="Volatility Means")
          lines(mRes, type="l", col = "blue")
          legend("topright", legend = c("Stochastic Volatility", "Squared Residuals"),
                 col = c("red", "blue"), lty = 1, cex = 0.8)
</code></pre>

<hr>
<h2 id='extra'>Package to compute the log likelihood for an inverse gamma stochastic volatility model and to draw from the exact posterior of the inverse volatilities.</h2><span id='topic+extra'></span>

<h3>Description</h3>

<p>This package computes the log likelihood for an inverse gamma stochastic volatility model using a closed form expression of the likelihood.
</p>

<hr>
<h2 id='lik_clo'>Compute the log likelihood for an inverse gamma stochastic volatility model</h2><span id='topic+lik_clo'></span>

<h3>Description</h3>

<p>Computes the log likelihood for an inverse gamma stochastic volatility model using a closed form expression of the likelihood. The details of the computation of this closed form expression are given in Leon-Gonzalez, R., &amp; Majoni, B. (2023). Exact Likelihood for Inverse Gamma Stochastic Volatility Models (No. 23-11). Computations in 'MAC OS' are single-threaded if 'OpenMP' is not installed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lik_clo( Res,  b2,  n, rho,  NIT=200,  niter=200,  nproc=2,  nproc2=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lik_clo_+3A_res">Res</code></td>
<td>
<p>Matrix of OLS residuals. Usually resulting from a call to priorvar.</p>
</td></tr>
<tr><td><code id="lik_clo_+3A_b2">b2</code></td>
<td>
<p>Level of volatility.</p>
</td></tr>
<tr><td><code id="lik_clo_+3A_n">n</code></td>
<td>
<p>Degrees of freedom.</p>
</td></tr>
<tr><td><code id="lik_clo_+3A_rho">rho</code></td>
<td>
<p>The parameter for the persistence of volatility.</p>
</td></tr>
<tr><td><code id="lik_clo_+3A_nit">NIT</code></td>
<td>
<p>The degree of approximation to truncate the log likelihood sum. The default value is set at 200.</p>
</td></tr>
<tr><td><code id="lik_clo_+3A_niter">niter</code></td>
<td>
<p>The degree of approximation to truncate the hypergeometric sum. The default value is set at 200.</p>
</td></tr>
<tr><td><code id="lik_clo_+3A_nproc">nproc</code></td>
<td>
<p>The number of processors allocated to evaluating the hypergeometric function. The default value is set at 2.</p>
</td></tr>
<tr><td><code id="lik_clo_+3A_nproc2">nproc2</code></td>
<td>
<p>The number of processors allocated to computing the log likelihood. The default value is set at 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The closed form expression is obtained for the log likelihood of a stationary inverse gamma stochastic volatility model by marginalising out the volatilities. This allows the user to obtain the maximum likelihood estimator for this non linear non Gaussian state space model. When combined with <code>DrawK0</code>, the function can in addition obtain the estimates of the smoothed volatilities using the exact smoothing distributions.
</p>


<h3>Value</h3>

<p>A list of 7 items. List item number 1, is the sum of the log likelihood, while the rest are constants that are useful to obtain the smoothed estimates of the volatility.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##simulate data
n=150
dat&lt;-data.frame(Ydep=runif(n,0.3,1.4))
Ydep &lt;- as.matrix(dat, -1,ncol=ncol(dat))
littlerho=0.95
r0=1
rho=diag(r0)*littlerho
p=4
n=4.1
T=nrow(Ydep)
Xdep &lt;- Ydep[p:(T-1),]
if (p&gt;1){
for(lagi in 2:p){
  Xdep &lt;- cbind(Xdep, Ydep[(p-lagi+1):(T-lagi),])
}
}
T=nrow(Ydep)
 Ydep &lt;- as.matrix(Ydep[(p+1):T,])
 T=nrow(Ydep)
unos &lt;- rep(1,T)
Xdep &lt;- cbind(unos, Xdep)
##obtain residuals
bOLS &lt;- solve(t(Xdep) %*% Xdep) %*% t(Xdep) %*% Ydep
Res= Ydep- Xdep %*% bOLS
 Res=Res[1:T,1]
 b2=solve(t(Res) %*% Res/T)*(1-rho %*% rho)/(n-2)
 Res=as.matrix(Res,ncol=1)
 
##obtain log likelihood
LL1=lik_clo(Res,b2,n,rho)
LL1[1]
</code></pre>

<hr>
<h2 id='ourgeo'>Computes the 2F1 Hypergeometric Function</h2><span id='topic+ourgeo'></span>

<h3>Description</h3>

<p>Computes the 2F1 Hypergeometric Function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ourgeo(a1,a2,b1,zstar,niter=500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ourgeo_+3A_a1">a1</code></td>
<td>
<p>Parameter (Real)</p>
</td></tr>
<tr><td><code id="ourgeo_+3A_a2">a2</code></td>
<td>
<p>Parameter (Real)</p>
</td></tr>
<tr><td><code id="ourgeo_+3A_b1">b1</code></td>
<td>
<p>Parameter (Real)</p>
</td></tr>
<tr><td><code id="ourgeo_+3A_zstar">zstar</code></td>
<td>
<p>Primary real argument</p>
</td></tr>
<tr><td><code id="ourgeo_+3A_niter">niter</code></td>
<td>
<p>The degree of approximation to truncate the hypergeometric sum. The default value is set at 500</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the value of the hypergeometric function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##usage of ourgeo to evaluate a 2F1 hypergeometric function
ourgeo(1.5,1.9,1.2,0.7)
</code></pre>

<hr>
<h2 id='US_Inf_Data'>Data to use in the invgamstochvol package</h2><span id='topic+US_Inf_Data'></span>

<h3>Description</h3>

<p>Contains the inflation data for the US for the period 1960Q1 to 2022Q3
</p>


<h3>Usage</h3>

<pre><code class='language-R'>US_Inf_Data
</code></pre>


<h3>Format</h3>

<p>A data frame with 1 variable and 247 observations.
</p>

<dl>
<dt>V1</dt><dd><p>Inflation variable</p>
</dd>
</dl>



<h3>Source</h3>

<p>Federal Reserve Bank of St Louis Fred database as the Consumer Price Index (CPI) data to serve as example data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(US_Inf_Data) #lazy loading
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
