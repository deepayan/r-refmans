<!DOCTYPE html><html lang="en"><head><title>Help for package bayescopulareg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bayescopulareg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bayescopulareg-package'><p>bayescopulareg: Bayesian Copula Regression</p></a></li>
<li><a href='#bayescopulaglm'><p>Sample from Bayesian copula GLM</p></a></li>
<li><a href='#predict.bayescopulaglm'><p>Predictive posterior sample from copula GLM</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Copula Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-11-30</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ethan Alt &lt;ethanalt@live.unc.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for Bayesian copula generalized linear models (GLMs). 
             The sampling scheme is based on Pitt, Chan, and Kohn (2006) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2F93.3.537">doi:10.1093/biomet/93.3.537</a>&gt;. 
             Regression parameters (including coefficients and dispersion parameters) are
             estimated via the adaptive random walk Metropolis approach developed by
             Haario, Saksman, and Tamminen (1999) &lt;<a href="https://doi.org/10.1007%2Fs001800050022">doi:10.1007/s001800050022</a>&gt;.
             The prior for the correlation matrix is based on Hoff (2007) &lt;<a href="https://doi.org/10.1214%2F07-AOAS107">doi:10.1214/07-AOAS107</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.3), stats</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppDist, mvtnorm</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ethan-alt/bayescopulareg">https://github.com/ethan-alt/bayescopulareg</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ethan-alt/bayescopulareg/issues">https://github.com/ethan-alt/bayescopulareg/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-30 16:32:50 UTC; ethanalt</td>
</tr>
<tr>
<td>Author:</td>
<td>Ethan Alt [aut, cre],
  Yash Bhosale [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-30 17:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='bayescopulareg-package'>bayescopulareg: Bayesian Copula Regression</h2><span id='topic+bayescopulareg'></span><span id='topic+bayescopulareg-package'></span>

<h3>Description</h3>

<p>Tools for Bayesian copula generalized linear models (GLMs). 
The sampling scheme is based on Pitt, Chan, and Kohn (2006) &lt;doi:10.1093/biomet/93.3.537&gt;. 
Regression parameters (including coefficients and dispersion parameters) are
estimated via the adaptive random walk Metropolis approach developed by
Haario, Saksman, and Tamminen (1999) &lt;doi:10.1007/s001800050022&gt;.
The prior for the correlation matrix is based on Hoff (2007) &lt;doi:10.1214/07-AOAS107&gt;.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Ethan Alt <a href="mailto:ethanalt@live.unc.edu">ethanalt@live.unc.edu</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Yash Bhosale <a href="mailto:bhosaley5@gmail.com">bhosaley5@gmail.com</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ethan-alt/bayescopulareg">https://github.com/ethan-alt/bayescopulareg</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ethan-alt/bayescopulareg/issues">https://github.com/ethan-alt/bayescopulareg/issues</a>
</p>
</li></ul>


<hr>
<h2 id='bayescopulaglm'>Sample from Bayesian copula GLM</h2><span id='topic+bayescopulaglm'></span>

<h3>Description</h3>

<p>Sample from a GLM via Bayesian copula regression model.
Uses random-walk Metropolis to update regression coefficients and dispersion parameters.
Assumes Inverse Wishart prior on augmented data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayescopulaglm(
  formula.list,
  family.list,
  data,
  histdata = NULL,
  b0 = NULL,
  c0 = NULL,
  alpha0 = NULL,
  gamma0 = NULL,
  Gamma0 = NULL,
  S0beta = NULL,
  sigma0logphi = NULL,
  v0 = NULL,
  V0 = NULL,
  beta0 = NULL,
  phi0 = NULL,
  M = 10000,
  burnin = 2000,
  thin = 1,
  adaptive = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bayescopulaglm_+3A_formula.list">formula.list</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional list of formulas giving how the endpoints are related to the covariates</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_family.list">family.list</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional list of families giving how each endpoint is distributed. See <code>help(family)</code></p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_data">data</code></td>
<td>
<p>A <code>data frame</code> containing all response variables and covariates. Variables must be named.</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_histdata">histdata</code></td>
<td>
<p><em>Optional</em> historical data set for power prior on <code class="reqn">\beta, \phi</code></p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_b0">b0</code></td>
<td>
<p><em>Optional</em> power prior hyperparameter. Ignored if <code>is.null(histdata)</code>. Must be a number between <code class="reqn">(0, 1]</code> if <code>histdata</code> is not <code>NULL</code></p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_c0">c0</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional vector for <code class="reqn">\beta \mid \phi</code> prior covariance. If <code>NULL</code>, sets <code class="reqn">c_0 = 10000</code> for each endpoint</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_alpha0">alpha0</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional vector giving the shape hyperparameter for each dispersion parameter on the prior on <code class="reqn">\phi</code>. If <code>NULL</code> sets <code class="reqn">\alpha_0 = .01</code> for each dispersion parameter</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_gamma0">gamma0</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional vector giving the rate hyperparameter for each dispersion parameter on the prior on <code class="reqn">\phi</code>. If <code>NULL</code> sets <code class="reqn">\alpha_0 = .01</code> for each dispersion parameter</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_gamma0">Gamma0</code></td>
<td>
<p>Initial value for correlation matrix. If <code>NULL</code> defaults to the correlation matrix from the responses.</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_s0beta">S0beta</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional <code>list</code> for the covariance matrix for random walk metropolis on beta. Each matrix must have the same dimension as the corresponding regression coefficient. If <code>NULL</code>, uses <code>solve(crossprod(X))</code></p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_sigma0logphi">sigma0logphi</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional <code>vector</code> giving the standard deviation on <code class="reqn">\log(\phi)</code> for random walk metropolis. If <code>NULL</code> defaults to <code>0.1</code></p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_v0">v0</code></td>
<td>
<p>An integer scalar giving degrees of freedom for Inverse Wishart prior. If <code>NULL</code> defaults to J + 2</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_v0">V0</code></td>
<td>
<p>An integer giving inverse scale parameter for Inverse Wishart prior. If <code>NULL</code> defaults to <code>diag(.001, J)</code></p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_beta0">beta0</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional <code>list</code> giving starting values for random walk Metropolis on the regression coefficients. If <code>NULL</code>, defaults to the GLM MLE</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_phi0">phi0</code></td>
<td>
<p>A <code class="reqn">J</code>-dimensional <code>vector</code> giving initial values for dispersion parameters. If <code>NULL</code>. Dispersion parameters will always return 1 for binomial and Poisson models</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_m">M</code></td>
<td>
<p>Number of desired posterior samples after burn-in and thinning</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_burnin">burnin</code></td>
<td>
<p>burn-in parameter</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_thin">thin</code></td>
<td>
<p>post burn-in thinning parameter</p>
</td></tr>
<tr><td><code id="bayescopulaglm_+3A_adaptive">adaptive</code></td>
<td>
<p>logical indicating whether to use adaptive random walk MCMC to estimate parameters. This takes longer, but generally has a better acceptance rate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list. 
<code>["betasample"]</code> gives a <code class="reqn">J</code>-dimensional list of sampled coefficients as matrices. 
<code>["phisample"]</code> gives a <code class="reqn">M \times J</code> matrix of sampled dispersion parameters. 
<code>["Gammasample"]</code> gives a <code class="reqn">J \times J \times M</code> array of sampled correlation matrices. 
<code>["betaaccept"]</code> gives a <code class="reqn">M \times J</code> matrix where each row indicates whether the proposal for the regression coefficient was accepted.
<code>["phiaccept"]</code> gives a <code class="reqn">M \times J</code> matrix where each row indicates whether the proposal for the dispersion parameter was accepted
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
n &lt;- 100
M &lt;- 100

x &lt;- runif(n, 1, 2)
y1 &lt;- 0.25 * x + rnorm(100)
y2 &lt;- rpois(n, exp(0.25 * x))

formula.list &lt;- list(y1 ~ 0 + x, y2 ~ 0 + x)
family.list &lt;- list(gaussian(), poisson())
data = data.frame(y1, y2, x)

## Perform copula regression sampling with default
## (noninformative) priors
sample &lt;- bayescopulaglm(
  formula.list, family.list, data, M = M, burnin = 0, adaptive = F
)
## Regression coefficients
summary(do.call(cbind, sample$betasample))

## Dispersion parameters
summary(sample$phisample)

## Posterior mean correlation matrix
apply(sample$Gammasample, c(1,2), mean)

## Fraction of accepted betas
colMeans(sample$betaaccept)

## Fraction of accepted dispersion parameters
colMeans(sample$phiaccept)
</code></pre>

<hr>
<h2 id='predict.bayescopulaglm'>Predictive posterior sample from copula GLM</h2><span id='topic+predict.bayescopulaglm'></span>

<h3>Description</h3>

<p>Sample from the predictive posterior density of a copula generalized linear model regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bayescopulaglm'
predict(object, newdata, nsims = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.bayescopulaglm_+3A_object">object</code></td>
<td>
<p>Result from calling <code>bayescopulaglm</code></p>
</td></tr>
<tr><td><code id="predict.bayescopulaglm_+3A_newdata">newdata</code></td>
<td>
<p><code>data.frame</code> of new data</p>
</td></tr>
<tr><td><code id="predict.bayescopulaglm_+3A_nsims">nsims</code></td>
<td>
<p>number of posterior draws to take. The default and minimum is 1. The maximum is the number of simulations in <code>object</code></p>
</td></tr>
<tr><td><code id="predict.bayescopulaglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>array</code> of dimension <code>c(n, J, nsims)</code> of predicted values, where <code>J</code> is the number of endpoints
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
n &lt;- 100
M &lt;- 1000

x &lt;- runif(n, 1, 2)
y1 &lt;- 0.25 * x + rnorm(100)
y2 &lt;- rpois(n, exp(0.25 * x))

formula.list &lt;- list(y1 ~ 0 + x, y2 ~ 0 + x)
family.list &lt;- list(gaussian(), poisson())
data = data.frame(y1, y2, x)

## Perform copula regression sampling with default
## (noninformative) priors
sample &lt;- bayescopulaglm(
  formula.list, family.list, data, M = M
)
predict(sample, newdata = data)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
