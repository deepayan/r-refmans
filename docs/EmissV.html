<!DOCTYPE html><html lang="en"><head><title>Help for package EmissV</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EmissV}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EmissV-package'><p>EmissV: Tools for Create Emissions for Air Quality Models</p></a></li>
<li><a href='#areaSource'><p>Distribution of emissions by area</p></a></li>
<li><a href='#emission'><p>Emissions in the format for atmospheric models</p></a></li>
<li><a href='#emissionFactor'><p>Tool to set-up emission factors</p></a></li>
<li><a href='#gridInfo'><p>Read grid information from a NetCDF file</p></a></li>
<li><a href='#lineSource'><p>Distribution of emissions by lines</p></a></li>
<li><a href='#perfil'><p>Temporal profile for emissions</p></a></li>
<li><a href='#plumeRise'><p>Calculate plume rise height.</p></a></li>
<li><a href='#pointSource'><p>Emissions from point sources</p></a></li>
<li><a href='#rasterSource'><p>Distribution of emissions by a georeferenced image</p></a></li>
<li><a href='#read'><p>Read NetCDF data from global inventories</p></a></li>
<li><a href='#speciation'><p>Speciation of emissions in different compounds</p></a></li>
<li><a href='#species'><p>Species mapping tables</p></a></li>
<li><a href='#totalEmission'><p>Calculate total emissions</p></a></li>
<li><a href='#vehicles'><p>Tool to set-up vehicle data table</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Tools for Create Emissions for Air Quality Models</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-24</td>
</tr>
<tr>
<td>Version:</td>
<td>0.665.9.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Schuch &lt;underschuch@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Processing tools to create emissions for use in numerical air 
  quality models. Emissions can be calculated both using emission factors 
  and activity data (Schuch et al 2018) &lt;<a href="https://doi.org/10.21105%2Fjoss.00662">doi:10.21105/joss.00662</a>&gt; or using 
  pollutant inventories (Schuch et al., 2018) &lt;<a href="https://doi.org/10.30564%2Fjasr.v1i1.347">doi:10.30564/jasr.v1i1.347</a>&gt;. 
  Functions to process individual point emissions, line emissions and 
  area emissions of pollutants are available as well as methods to 
  incorporate alternative data for Spatial distribution of emissions 
  such as satellite images (Gavidia-Calderon et. al, 2018) 
  &lt;<a href="https://doi.org/10.1016%2Fj.atmosenv.2018.09.026">doi:10.1016/j.atmosenv.2018.09.026</a>&gt; or openstreetmap data 
  (Andrade et al, 2015) &lt;<a href="https://doi.org/10.3389%2Ffenvs.2015.00009">doi:10.3389/fenvs.2015.00009</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ncdf4, units(&ge; 0.5-1), raster, sf, methods, data.table</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0), covr, lwgeom</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://atmoschem.github.io/EmissV/">https://atmoschem.github.io/EmissV/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/atmoschem/EmissV/issues">https://github.com/atmoschem/EmissV/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-24 21:03:17 UTC; under</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Schuch <a href="https://orcid.org/0000-0001-5977-4519"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Sergio Ibarra-Espinosa
    <a href="https://orcid.org/0000-0002-3162-1905"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-24 21:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='EmissV-package'>EmissV: Tools for Create Emissions for Air Quality Models</h2><span id='topic+EmissV'></span><span id='topic+EmissV-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Processing tools to create emissions for use in numerical air quality models. Emissions can be calculated both using emission factors and activity data (Schuch et al 2018) <a href="https://doi.org/10.21105/joss.00662">doi:10.21105/joss.00662</a> or using pollutant inventories (Schuch et al., 2018) <a href="https://doi.org/10.30564/jasr.v1i1.347">doi:10.30564/jasr.v1i1.347</a>. Functions to process individual point emissions, line emissions and area emissions of pollutants are available as well as methods to incorporate alternative data for Spatial distribution of emissions such as satellite images (Gavidia-Calderon et. al, 2018) <a href="https://doi.org/10.1016/j.atmosenv.2018.09.026">doi:10.1016/j.atmosenv.2018.09.026</a> or openstreetmap data (Andrade et al, 2015) <a href="https://doi.org/10.3389/fenvs.2015.00009">doi:10.3389/fenvs.2015.00009</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Daniel Schuch <a href="mailto:underschuch@gmail.com">underschuch@gmail.com</a> (<a href="https://orcid.org/0000-0001-5977-4519">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Sergio Ibarra-Espinosa <a href="mailto:sergio.ibarra@usp.br">sergio.ibarra@usp.br</a> (<a href="https://orcid.org/0000-0002-3162-1905">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://atmoschem.github.io/EmissV/">https://atmoschem.github.io/EmissV/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/atmoschem/EmissV/issues">https://github.com/atmoschem/EmissV/issues</a>
</p>
</li></ul>


<hr>
<h2 id='areaSource'>Distribution of emissions by area</h2><span id='topic+areaSource'></span>

<h3>Description</h3>

<p>Calculate the spatial distribution by a raster masked by shape/model grid information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>areaSource(s, r, grid = NA, name = "", as_frac = FALSE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="areaSource_+3A_s">s</code></td>
<td>
<p>input shape object</p>
</td></tr>
<tr><td><code id="areaSource_+3A_r">r</code></td>
<td>
<p>input raster object</p>
</td></tr>
<tr><td><code id="areaSource_+3A_grid">grid</code></td>
<td>
<p>grid with the output format</p>
</td></tr>
<tr><td><code id="areaSource_+3A_name">name</code></td>
<td>
<p>area name</p>
</td></tr>
<tr><td><code id="areaSource_+3A_as_frac">as_frac</code></td>
<td>
<p>return a fraction instead of the raster value</p>
</td></tr>
<tr><td><code id="areaSource_+3A_verbose">verbose</code></td>
<td>
<p>display additional data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>About the DMSP and example data <a href="https://en.wikipedia.org/wiki/Defense_Meteorological_Satellite_Program">https://en.wikipedia.org/wiki/Defense_Meteorological_Satellite_Program</a>
</p>


<h3>Value</h3>

<p>a raster object containing the spatial distribution of emissions
</p>


<h3>Source</h3>

<p>Data avaliable <a href="https://www.nesdis.noaa.gov/current-satellite-missions/currently-flying/defense-meteorological-satellite-program">https://www.nesdis.noaa.gov/current-satellite-missions/currently-flying/defense-meteorological-satellite-program</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>shape  &lt;- raster::shapefile(paste(system.file("extdata", package = "EmissV"),
                            "/BR.shp",sep=""),verbose = FALSE)
shape  &lt;- shape[22,1] # subset for Sao Paulo - BR
raster &lt;- raster::raster(paste(system.file("extdata", package = "EmissV"),
                         "/dmsp.tiff",sep=""))
grid   &lt;- gridInfo(paste(system.file("extdata", package = "EmissV"),"/wrfinput_d02",sep=""))
SP     &lt;- areaSource(shape,raster,grid,name = "SPMA")

raster::plot(SP,ylab="Lat",xlab="Lon",
             main ="Spatial Distribution by Lights for Sao Paulo - Brazil")


</code></pre>

<hr>
<h2 id='emission'>Emissions in the format for atmospheric models</h2><span id='topic+emission'></span>

<h3>Description</h3>

<p>Combine area sources and total emissions to model output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emission(
  inventory = NULL,
  grid,
  mm = 1,
  aerosol = FALSE,
  check = TRUE,
  total,
  pol,
  area,
  plot = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="emission_+3A_inventory">inventory</code></td>
<td>
<p>a inventory raster from read</p>
</td></tr>
<tr><td><code id="emission_+3A_grid">grid</code></td>
<td>
<p>grid information</p>
</td></tr>
<tr><td><code id="emission_+3A_mm">mm</code></td>
<td>
<p>pollutant molar mass</p>
</td></tr>
<tr><td><code id="emission_+3A_aerosol">aerosol</code></td>
<td>
<p>TRUE for aerosols and FALSE (defoult) for gazes</p>
</td></tr>
<tr><td><code id="emission_+3A_check">check</code></td>
<td>
<p>TRUE (defoult) to check negative and NA values and replace it for zero</p>
</td></tr>
<tr><td><code id="emission_+3A_total">total</code></td>
<td>
<p>list of total emission</p>
</td></tr>
<tr><td><code id="emission_+3A_pol">pol</code></td>
<td>
<p>pollutant name</p>
</td></tr>
<tr><td><code id="emission_+3A_area">area</code></td>
<td>
<p>list of area sources or matrix with a spatial distribution</p>
</td></tr>
<tr><td><code id="emission_+3A_plot">plot</code></td>
<td>
<p>TRUE for plot the final emissions</p>
</td></tr>
<tr><td><code id="emission_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Format</h3>

<p>matrix of emission
</p>


<h3>Value</h3>

<p>a vector of emissions in MOL / mk2 h for gases and ug / m2 s for aerosols.
</p>


<h3>Note</h3>

<p>if Inventory is provided, the firsts tree arguments are not be used by the function.
</p>
<p>Is a good practice use the set_units(fe,your_unity), where fe is your emission factory and your_unity is usually g/km on your emission factory
</p>
<p>the list of area must be in the same order as defined in vehicles and total emission.
</p>
<p>just WRF-Chem is suported by now
</p>


<h3>See Also</h3>

<p><code><a href="#topic+totalEmission">totalEmission</a></code> and <code><a href="#topic+areaSource">areaSource</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fleet  &lt;- vehicles(example = TRUE)

EmissionFactors &lt;- emissionFactor(example = TRUE)

TOTAL  &lt;- totalEmission(fleet,EmissionFactors,pol = c("CO"),verbose = TRUE)

grid   &lt;- gridInfo(paste0(system.file("extdata", package = "EmissV"),"/wrfinput_d01"))
shape  &lt;- raster::shapefile(paste0(system.file("extdata", package = "EmissV"),"/BR.shp"))
raster &lt;- raster::raster(paste0(system.file("extdata", package = "EmissV"),"/dmsp.tiff"))

SP     &lt;- areaSource(shape[22,1],raster,grid,name = "SP")
RJ     &lt;- areaSource(shape[17,1],raster,grid,name = "RJ")

e_CO   &lt;- emission(total = TOTAL,
                   pol = "CO",
                   area = list(SP = SP, RJ = RJ),
                   grid = grid,
                   mm = 28)

</code></pre>

<hr>
<h2 id='emissionFactor'>Tool to set-up emission factors</h2><span id='topic+emissionFactor'></span>

<h3>Description</h3>

<p>Return a data frame for emission for multiple pollutants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emissionFactor(
  ef,
  poluttant = names(ef),
  vnames = NA,
  unit = "g/km",
  example = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="emissionFactor_+3A_ef">ef</code></td>
<td>
<p>list with emission factors</p>
</td></tr>
<tr><td><code id="emissionFactor_+3A_poluttant">poluttant</code></td>
<td>
<p>poluttant names</p>
</td></tr>
<tr><td><code id="emissionFactor_+3A_vnames">vnames</code></td>
<td>
<p>name of each vehicle categoy (optional)</p>
</td></tr>
<tr><td><code id="emissionFactor_+3A_unit">unit</code></td>
<td>
<p>tring with unit from unit package, for default is &quot;g/km&quot;</p>
</td></tr>
<tr><td><code id="emissionFactor_+3A_example">example</code></td>
<td>
<p>TRUE to diaplay a simple example</p>
</td></tr>
<tr><td><code id="emissionFactor_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a emission factor data frame
</p>
<p>a emission factor data.frame for totalEmission function
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaSource">areaSource</a></code> and  <code><a href="#topic+totalEmission">totalEmission</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>EF &lt;- emissionFactor(example = TRUE)

# or the code for the same result
EF &lt;- emissionFactor(ef = list(CO = c(1.75,10.04,0.39,0.45,0.77,1.48,1.61,0.75),
                               PM = c(0.0013,0.0,0.0010,0.0612,0.1052,0.1693,0.0,0.0)),
                     vnames = c("Light Duty Vehicles Gasohol","Light Duty Vehicles Ethanol",
                                "Light Duty Vehicles Flex","Diesel Trucks","Diesel Urban Busses",
                                "Diesel Intercity Busses","Gasohol Motorcycles",
                                "Flex Motorcycles"))

</code></pre>

<hr>
<h2 id='gridInfo'>Read grid information from a NetCDF file</h2><span id='topic+gridInfo'></span>

<h3>Description</h3>

<p>Return a list containing information of a regular grid / domain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gridInfo(
  file = file.choose(),
  z = FALSE,
  missing_time = "1984-03-10",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gridInfo_+3A_file">file</code></td>
<td>
<p>file name/path to a wrfinput, wrfchemi or geog_em file</p>
</td></tr>
<tr><td><code id="gridInfo_+3A_z">z</code></td>
<td>
<p>TRUE for read wrfinput vertical coordinades</p>
</td></tr>
<tr><td><code id="gridInfo_+3A_missing_time">missing_time</code></td>
<td>
<p>time if the variable Times is missing</p>
</td></tr>
<tr><td><code id="gridInfo_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with grid information from air quality model
</p>


<h3>Note</h3>

<p>just WRF-Chem is suported by now
</p>


<h3>Examples</h3>

<pre><code class='language-R'>grid_d1 &lt;- gridInfo(paste(system.file("extdata", package = "EmissV"),
                                      "/wrfinput_d01",sep=""))
grid_d2 &lt;- gridInfo(paste(system.file("extdata", package = "EmissV"),
                                      "/wrfinput_d02",sep=""))
grid_d3 &lt;- gridInfo(paste(system.file("extdata", package = "EmissV"),
                                      "/wrfinput_d03",sep=""))
names(grid_d1)
# for plot the shapes
shape   &lt;- raster::shapefile(paste0(system.file("extdata", package = "EmissV"),
                                                "/BR.shp"))
raster::plot(shape,xlim = c(-55,-40),ylim = c(-30,-15), main="3 nested domains")
axis(1); axis(2); box(); grid()
lines(grid_d1$boundary, col = "red")
text(grid_d1$xlim[2],grid_d1$Ylim[1],"d1",pos=4, offset = 0.5)
lines(grid_d2$boundary, col = "red")
text(grid_d2$xlim[2],grid_d2$Ylim[1],"d2",pos=4, offset = 0.5)
lines(grid_d3$boundary, col = "red")
text(grid_d3$xlim[1],grid_d3$Ylim[2],"d3",pos=2, offset = 0.0)

</code></pre>

<hr>
<h2 id='lineSource'>Distribution of emissions by lines</h2><span id='topic+lineSource'></span>

<h3>Description</h3>

<p>Create a emission distribution from 'sp' or 'sf' spatial lines data.frame or
spatial lines.
</p>
<p>There 3 modes available to create the emission grid:
- using gridInfo function output (defoult)
- using the patch to &quot;wrfinput&quot; (output from real.exe) file or &quot;geo&quot; for (output from geog.exe)
- &quot;sf&quot; (and &quot;sp&quot;) uses a grid in SpatialPolygons format
</p>
<p>The variable is the column of the data.frame with contains the variable to be used as emissions,
by defoult the idstribution taken into acount the lench distribution of lines into each grid cell
and the output is normalized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lineSource(
  s,
  grid,
  as_raster = FALSE,
  type = "info",
  gcol = 100,
  grow = 100,
  variable = "length",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lineSource_+3A_s">s</code></td>
<td>
<p>SpatialLinesDataFrame of SpatialLines object</p>
</td></tr>
<tr><td><code id="lineSource_+3A_grid">grid</code></td>
<td>
<p>grid object with the grid information or filename</p>
</td></tr>
<tr><td><code id="lineSource_+3A_as_raster">as_raster</code></td>
<td>
<p>output format, TRUE for raster, FALSE for matrix</p>
</td></tr>
<tr><td><code id="lineSource_+3A_type">type</code></td>
<td>
<p>&quot;info&quot; (default), &quot;wrfinput&quot;, &quot;geo&quot;, &quot;sp&quot; or &quot;sf&quot; for grid type</p>
</td></tr>
<tr><td><code id="lineSource_+3A_gcol">gcol</code></td>
<td>
<p>grid points for a &quot;sp&quot; or &quot;sf&quot; type</p>
</td></tr>
<tr><td><code id="lineSource_+3A_grow">grow</code></td>
<td>
<p>grid points for a &quot;sp&quot; or &quot;sf&quot; type</p>
</td></tr>
<tr><td><code id="lineSource_+3A_variable">variable</code></td>
<td>
<p>variable to use, default is line length</p>
</td></tr>
<tr><td><code id="lineSource_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a raster object containing the spatial distribution of emissions
</p>


<h3>Source</h3>

<p>OpenstreetMap data avaliable <a href="https://www.openstreetmap.org/">https://www.openstreetmap.org/</a> and <a href="https://download.geofabrik.de/">https://download.geofabrik.de/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gridInfo">gridInfo</a></code> and <code><a href="#topic+rasterSource">rasterSource</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# loading a shapefile with osm data for sao paulo metropolitan area
roads &lt;- sf::st_read(paste0(system.file("extdata",package="EmissV"),"/streets.shp"))
d3    &lt;- gridInfo(paste0(system.file("extdata", package = "EmissV"),"/wrfinput_d03"))

# calculating only for 2 streets
roadLength &lt;- lineSource(roads[1:2,],d3,as_raster=TRUE)

# to generate a quick plot
raster::plot(roadLength,ylab="Lat", xlab="Lon",main="Length of roads")
# lines(road_lines)



</code></pre>

<hr>
<h2 id='perfil'>Temporal profile for emissions</h2><span id='topic+perfil'></span>

<h3>Description</h3>

<p>Set of hourly profiles that represents the mean activity for each hour (local time) of the week.
</p>

<dl>
<dt>LDV</dt><dd><p>Light Duty vehicles</p>
</dd>
<dt>HDV</dt><dd><p>Heavy Duty vehicles</p>
</dd>
<dt>PC_JUNE_2012</dt><dd><p>passenger cars counted in June 2012</p>
</dd>
<dt>PC_JUNE_2013</dt><dd><p>passenger cars counted in June 2013</p>
</dd>
<dt>PC_JUNE_2014</dt><dd><p>passenger cars counted in June 2014</p>
</dd>
<dt>LCV_JUNE_2012</dt><dd><p>light comercial vehicles counted in June 2012</p>
</dd>
<dt>LCV_JUNE_2013</dt><dd><p>light comercial vehicles counted in June 2013</p>
</dd>
<dt>LCV_JUNE_2014</dt><dd><p>light comercial vehicles counted in June 2014</p>
</dd>
<dt>MC_JUNE_2012</dt><dd><p>motorcycles counted in June 2012</p>
</dd>
<dt>MC_JUNE_2013</dt><dd><p>motorcycles counted in June 2013</p>
</dd>
<dt>MC_JUNE_2014</dt><dd><p>motorcycles counted in June 2014</p>
</dd>
<dt>HGV_JUNE_2012</dt><dd><p>Heavy good vehicles counted in June 2012</p>
</dd>
<dt>HGV_JUNE_2013</dt><dd><p>Heavy good vehicles counted in June 2013</p>
</dd>
<dt>HGV_JUNE_2014</dt><dd><p>Heavy good vehicles counted in June 2014</p>
</dd>
<dt>PC_JANUARY_2012</dt><dd><p>passenger cars counted in january 2012</p>
</dd>
<dt>PC_JANUARY_2013</dt><dd><p>passenger cars counted in january 2013</p>
</dd>
<dt>PC_JANUARY_2014</dt><dd><p>passenger cars counted in january 2014</p>
</dd>
<dt>LCV_JANUARY_2012</dt><dd><p>light comercial vehicles counted in january 2012</p>
</dd>
<dt>LCV_JANUARY_2013</dt><dd><p>light comercial vehicles counted in january 2013</p>
</dd>
<dt>LCV_JANUARY_2014</dt><dd><p>light comercial vehicles counted in january 2014</p>
</dd>
<dt>MC_JANUARY_2012</dt><dd><p>Motorcycles counted in january 2012</p>
</dd>
<dt>MC_JANUARY_2014</dt><dd><p>Motorcycles counted in january 2014</p>
</dd>
<dt>HGV_JANUARY_2012</dt><dd><p>Heavy good vehicles counted in january 2012</p>
</dd>
<dt>HGV_JANUARY_2013</dt><dd><p>Heavy good vehicles counted in january 2013</p>
</dd>
<dt>HGV_JANUARY_2014</dt><dd><p>Heavy good vehicles counted in january 2014</p>
</dd>
<dt>POW</dt><dd><p>Power generation emission profile</p>
</dd>
<dt>IND</dt><dd><p>Industrial emission profile</p>
</dd>
<dt>RES</dt><dd><p>Residencial emission profile</p>
</dd>
<dt>TRA</dt><dd><p>Transport emission profile</p>
</dd>
<dt>AGR</dt><dd><p>Agriculture emission profile</p>
</dd>
<dt>SHP</dt><dd><p>Emission profile for ships</p>
</dd>
<dt>SLV</dt><dd><p>Solvent use emission constant profile</p>
</dd>
<dt>WBD</dt><dd><p>Waste burning emisssion constant profile</p>
</dd>
<dt>PC_nov_2018</dt><dd><p>passenger cars at Janio Quadros on November 2018</p>
</dd>
<dt>HGV_nov_2018</dt><dd><p>heavy good vehicles at Janio Quadros on November 2018</p>
</dd>
<dt>TOTAL_nov_2018</dt><dd><p>total vehicle at Janio Quadros on November 2018</p>
</dd>
<dt>PC_out_2018</dt><dd><p>passenger cars at Anhanguera-Castello Branco on October 2018</p>
</dd>
<dt>MC_out_2018</dt><dd><p>Motorcycles cars at Anhanguera-Castello Branco on October 2018</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>data(perfil)
</code></pre>


<h3>Format</h3>

<p>A list of data frames with activity by hour and weekday.
</p>


<h3>Details</h3>

<p>- Profiles 1 to 2 are from traffic count at São Paulo city from Perez Martínez et al (2014).
</p>
<p>- Profiles 3 to 25 comes from traffic counted of toll stations located in São Paulo city,
for summer and winters of 2012, 2013 and 2014.
</p>
<p>- Profiles 26 to 33 are for different sectors from Oliver et al (2003).
</p>
<p>- Profiles 34 to 36 are for volumetric mechanized traffic count at Janio Quadros tunnel on November 2018.
</p>
<p>- Profiles 37 to 38 are for volumetric mechanized traffic count at Anhanguera-Castello Branco on October 2018.
</p>


<h3>Note</h3>

<p>The profile is normalized by days (but is balanced for a complete week) it means
diary_emission x profile = hourly_emission.
</p>


<h3>References</h3>

<p>Pérez-Martínez, P. J., Miranda, R. M., Nogueira, T., Guardani, M. L., Fornaro, A., Ynoue, R., &amp;
Andrade, M. F. (2014). Emission factors of air pollutants from vehicles measured inside road
tunnels in São Paulo: case study comparison. International Journal of Environmental Science
and Technology, 11(8), 2155-2168.
</p>
<p>Olivier, J., J. Peters, C. Granier, G. Pétron, J.F. Müller, and S. Wallens,
Present and future surface emissions of atmospheric compounds, POET Report #2,
EU project EVK2-1999-00011, 2003.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load the data
data(perfil)

# function to simple view
plot.perfil &lt;- function(per = perfil$LDV, text="", color = "#0000FFBB"){
  plot(per[,1],ty = "l", ylim = range(per),axe = FALSE,
       xlab = "hour",ylab = "Intensity",main = text,col=color)
  for(i in 2:7){
    lines(per[,i],col = color)
  }
  for(i in 1:7){
    points(per[,i],col = "black", pch = 20)
  }
  axis(1,at=0.5+c(0,6,12,18,24),labels = c("00:00","06:00","12:00","18:00","00:00"))
  axis(2)
  box()
}

# view all profiles in perfil data
for(i in 1:length(names(perfil))){
  cat(paste("profile",i,names(perfil)[i],"\n"))
  plot.perfil(perfil[[i]],names(perfil)[i])
}


</code></pre>

<hr>
<h2 id='plumeRise'>Calculate plume rise height.</h2><span id='topic+plumeRise'></span>

<h3>Description</h3>

<p>Calculate the maximum height of rise based on Brigs (1975), the height is calculated using different formulations depending on stability and wind conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plumeRise(df, imax = 10, ermax = 1/100, Hmax = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plumeRise_+3A_df">df</code></td>
<td>
<p>data.frame with micrometeorological and emission data</p>
</td></tr>
<tr><td><code id="plumeRise_+3A_imax">imax</code></td>
<td>
<p>maximum number of iteractions</p>
</td></tr>
<tr><td><code id="plumeRise_+3A_ermax">ermax</code></td>
<td>
<p>maximum error</p>
</td></tr>
<tr><td><code id="plumeRise_+3A_hmax">Hmax</code></td>
<td>
<p>use weil limit for plume rise, see details</p>
</td></tr>
<tr><td><code id="plumeRise_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Format</h3>

<p>data.frame with the input, rise (m) and effective higt (m)
</p>


<h3>Details</h3>

<p>The input data.frame must contains the folloging colluns:
</p>
<p>- z: height of the emission (m)
</p>
<p>- r: source raius (m)
</p>
<p>- Ve: emission velocity (m/s)
</p>
<p>- Te: emission temperature (K)
</p>
<p>- ws: wind speed (m/s)
</p>
<p>- Temp: ambient temperature (K)
</p>
<p>- h: height of the Atmospheric Boundary Layer-ABL (m)
</p>
<p>- L: Monin-Obuhkov Lench (m)
</p>
<p>- dtdz: lapse ration of potential temperature, used only for stable ABL (K/m)
</p>
<p>- Ustar: atriction velocity, used only for neutral ABL (m/s)
</p>
<p>- Wstar: scale of convectie velocity, used only for convective ABL (m/s)
</p>
<p>Addcitionaly some combination of ws, Wstar and Ustar can produce inacurate results, Weil (1979) propose a geometric limit of 0.62 * (h - Hs) for the rise value.
</p>


<h3>Value</h3>

<p>a data.frame with effective height of emissions for pointSource function
</p>


<h3>References</h3>

<p>The plume rise formulas are from Brigs (1975):&quot;Brigs, G. A. Plume rise predictions, Lectures on Air Pollution and Environmental Impact Analyses. Amer. Meteor. Soc. p. 59-111, 1975.&quot; and Arya 1999: &quot;Arya, S.P., 1999, Air Pollution Meteorology and Dispersion, Oxford University Press, New York, 310 p.&quot;
</p>
<p>The limits are from Weil (1979): &quot;WEIL, J.C. Assessmet of plume rise and dispersion models using LIDAR data, PPSP-MP-24. Prepared by Environmental Center, Martin Marietta Corporation, for Maryland Department of Natural Resources. 1979.&quot;
</p>
<p>The example is data from a chimney of the Candiota thermoelectric powerplant from Arabage et al (2006) &quot;Arabage, M. C.; Degrazia, G. A.; Moraes O. L. Simulação euleriana da dispersão local da pluma de poluente atmosférico de Candiota-RS. Revista Brasileira de Meteorologia, v.21, n.2, p. 153-160, 2006.&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>candiota &lt;- matrix(c(150,1,20,420,3.11,273.15 + 3.16,200,-34.86,3.11,0.33,
                     150,1,20,420,3.81,273.15 + 4.69,300,-34.83,3.81,0.40,
                     150,1,20,420,3.23,273.15 + 5.53,400,-24.43,3.23,0.48,
                     150,1,20,420,3.47,273.15 + 6.41,500,-15.15,3.48,0.52,
                     150,1,20,420,3.37,273.15 + 6.35,600, -8.85,3.37,2.30,
                     150,1,20,420,3.69,273.15 + 5.93,800,-10.08,3.69,2.80,
                     150,1,20,420,3.59,273.15 + 6.08,800, -7.23,3.49,1.57,
                     150,1,20,420,4.14,273.15 + 6.53,900,-28.12,4.14,0.97),
                     ncol = 10, byrow = TRUE)
candiota &lt;- data.frame(candiota)
names(candiota) &lt;- c("z","r","Ve","Te","ws","Temp","h","L","Ustar","Wstar")
row.names(candiota) &lt;- c("08:00","09:00",paste(10:15,":00",sep=""))
candiota &lt;- plumeRise(candiota,Hmax = TRUE)
print(candiota)

</code></pre>

<hr>
<h2 id='pointSource'>Emissions from point sources</h2><span id='topic+pointSource'></span>

<h3>Description</h3>

<p>Transform a set of points into a grinded output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointSource(emissions, grid, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pointSource_+3A_emissions">emissions</code></td>
<td>
<p>list of points</p>
</td></tr>
<tr><td><code id="pointSource_+3A_grid">grid</code></td>
<td>
<p>grid object with the grid information</p>
</td></tr>
<tr><td><code id="pointSource_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a raster
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gridInfo">gridInfo</a></code> and <code><a href="#topic+rasterSource">rasterSource</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d1 &lt;- gridInfo(paste(system.file("extdata", package = "EmissV"),"/wrfinput_d01",sep=""))

p = data.frame(lat      = c(-22,-22,-23.5),
               lon      = c(-46,-48,-47  ),
               z        = c(0  ,  0,  0  ),
               emission = c(666,444,111  ) )

p_emissions &lt;- pointSource(emissions = p, grid = d1)

raster::plot(p_emissions,ylab="Lat", xlab="Lon",
             main = "3 point sources for domain d1")


</code></pre>

<hr>
<h2 id='rasterSource'>Distribution of emissions by a georeferenced image</h2><span id='topic+rasterSource'></span>

<h3>Description</h3>

<p>Calculate the spatial distribution by a raster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rasterSource(r, grid, nlevels = "all", conservative = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rasterSource_+3A_r">r</code></td>
<td>
<p>input raster object</p>
</td></tr>
<tr><td><code id="rasterSource_+3A_grid">grid</code></td>
<td>
<p>grid object with the grid information</p>
</td></tr>
<tr><td><code id="rasterSource_+3A_nlevels">nlevels</code></td>
<td>
<p>number of vertical levels off the emission array</p>
</td></tr>
<tr><td><code id="rasterSource_+3A_conservative">conservative</code></td>
<td>
<p>TRUE (default) to conserve total mass, FALSE to conserve flux</p>
</td></tr>
<tr><td><code id="rasterSource_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Details</h3>

<p>About the DMSP and example data <a href="https://en.wikipedia.org/wiki/Defense_Meteorological_Satellite_Program">https://en.wikipedia.org/wiki/Defense_Meteorological_Satellite_Program</a>
</p>


<h3>Value</h3>

<p>Returns a matrix
</p>


<h3>Source</h3>

<p>Exemple data is a low resolution cutting from image of persistent lights of the Defense Meteorological Satellite Program (DMSP) <a href="https://pt.wikipedia.org/wiki/Defense_Meteorological_Satellite_Program">https://pt.wikipedia.org/wiki/Defense_Meteorological_Satellite_Program</a>
</p>
<p>Data avaliable <a href="https://www.nesdis.noaa.gov/current-satellite-missions/currently-flying/defense-meteorological-satellite-program">https://www.nesdis.noaa.gov/current-satellite-missions/currently-flying/defense-meteorological-satellite-program</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gridInfo">gridInfo</a></code> and <code><a href="#topic+lineSource">lineSource</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>grid  &lt;- gridInfo(paste(system.file("extdata", package = "EmissV"),"/wrfinput_d01",sep=""))
x     &lt;- raster::raster(paste(system.file("extdata", package = "EmissV"),"/dmsp.tiff",sep=""))
test  &lt;- rasterSource(x, grid)
image(test, axe = FALSE, main = "Spatial distribution by Persistent Nocturnal Lights from DMSP")

</code></pre>

<hr>
<h2 id='read'>Read NetCDF data from global inventories</h2><span id='topic+read'></span>

<h3>Description</h3>

<p>Read data from global inventories. Several files can be read to produce one
emission output and/or can be splitted into several species
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read(
  file = file.choose(),
  version = NA,
  coef = rep(1, length(file)),
  spec = NULL,
  year = 1,
  month = 1,
  hour = 1,
  categories,
  reproject = TRUE,
  as_raster = TRUE,
  skip_missing = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_+3A_file">file</code></td>
<td>
<p>file name or names (variables are summed)</p>
</td></tr>
<tr><td><code id="read_+3A_version">version</code></td>
<td>
<p>Character; One of  of the following:
</p>

<table>
<tr>
 <td style="text-align: left;">
  <strong>argument</strong></td><td style="text-align: left;"> <strong>tested</strong></td><td style="text-align: left;"> <strong>region</strong></td><td style="text-align: left;"> <strong>resolution</strong></td><td style="text-align: left;"> <strong>projection</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
  EDGAR</td><td style="text-align: left;"> 4.32 and 5.0 </td><td style="text-align: left;"> Global </td><td style="text-align: left;"> 0.1 x 0.1 ° </td><td style="text-align: left;">  longlat</td>
</tr>
<tr>
 <td style="text-align: left;">
  EDGAR_HTAPv2</td><td style="text-align: left;"> 2.2 </td><td style="text-align: left;"> Global </td><td style="text-align: left;"> 0.1 x 0.1 °  </td><td style="text-align: left;">  longlat</td>
</tr>
<tr>
 <td style="text-align: left;">
  EDGARv8m</td><td style="text-align: left;"> 8.1 monthly</td><td style="text-align: left;"> Global </td><td style="text-align: left;"> 0.1 x 0.1 °  </td><td style="text-align: left;">  longlat</td>
</tr>
<tr>
 <td style="text-align: left;">
  EDGARv8</td><td style="text-align: left;"> 8.1 </td><td style="text-align: left;"> Global </td><td style="text-align: left;"> 0.1 x 0.1 °  </td><td style="text-align: left;">  longlat</td>
</tr>
<tr>
 <td style="text-align: left;">
  GAINS</td><td style="text-align: left;"> v5a </td><td style="text-align: left;"> Global </td><td style="text-align: left;"> 0.5 x 0.5 ° </td><td style="text-align: left;">  longlat</td>
</tr>
<tr>
 <td style="text-align: left;">
  RCP</td><td style="text-align: left;"> RCP3PD Glb </td><td style="text-align: left;"> Global </td><td style="text-align: left;"> 0.5 x 0.5 °  </td><td style="text-align: left;">  longlat</td>
</tr>
<tr>
 <td style="text-align: left;">
  MACCITY</td><td style="text-align: left;"> 2010 </td><td style="text-align: left;"> Global </td><td style="text-align: left;"> 0.5 x 0.5 °  </td><td style="text-align: left;">  longlat</td>
</tr>
<tr>
 <td style="text-align: left;">
  FFDAS</td><td style="text-align: left;"> 2.2 </td><td style="text-align: left;"> Global </td><td style="text-align: left;"> 0.1 x 0.1 ° </td><td style="text-align: left;">  longlat</td>
</tr>
<tr>
 <td style="text-align: left;">
  ODIAC</td><td style="text-align: left;"> 2020 </td><td style="text-align: left;"> Global </td><td style="text-align: left;"> 1 x 1 ° </td><td style="text-align: left;">  longlat</td>
</tr>
<tr>
 <td style="text-align: left;">
  VULCAN-y</td><td style="text-align: left;"> 3.0 </td><td style="text-align: left;"> US </td><td style="text-align: left;"> 1 x 1 km </td><td style="text-align: left;">  lcc</td>
</tr>
<tr>
 <td style="text-align: left;">
  VULCAN-h</td><td style="text-align: left;"> 3.0 </td><td style="text-align: left;"> US </td><td style="text-align: left;"> 1 x 1 km </td><td style="text-align: left;">  lcc</td>
</tr>
<tr>
 <td style="text-align: left;">
  ACES</td><td style="text-align: left;"> 2020 </td><td style="text-align: left;"> NE US </td><td style="text-align: left;"> 1 x 1 km </td><td style="text-align: left;">  lcc</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="read_+3A_coef">coef</code></td>
<td>
<p>coefficients to merge different sources (file) into one emission</p>
</td></tr>
<tr><td><code id="read_+3A_spec">spec</code></td>
<td>
<p>numeric speciation vector to split emission into different species</p>
</td></tr>
<tr><td><code id="read_+3A_year">year</code></td>
<td>
<p>scenario index (only for GAINS and VULCAN-y)</p>
</td></tr>
<tr><td><code id="read_+3A_month">month</code></td>
<td>
<p>the desired month of the inventory (MACCITY and ODIAC)</p>
</td></tr>
<tr><td><code id="read_+3A_hour">hour</code></td>
<td>
<p>hour of the emission (only for ACES and VULCAN-h)</p>
</td></tr>
<tr><td><code id="read_+3A_categories">categories</code></td>
<td>
<p>considered categories (for MACCITY/GAINS variable names), empty for use all</p>
</td></tr>
<tr><td><code id="read_+3A_reproject">reproject</code></td>
<td>
<p>to project the output to &quot;+proj=longlat&quot; needed for emission function (only for VULCAN and ACES)</p>
</td></tr>
<tr><td><code id="read_+3A_as_raster">as_raster</code></td>
<td>
<p>return a raster (default) or matrix (with units)</p>
</td></tr>
<tr><td><code id="read_+3A_skip_missing">skip_missing</code></td>
<td>
<p>return a zero emission and a warning for missing files/variables</p>
</td></tr>
<tr><td><code id="read_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix or raster
</p>


<h3>Note</h3>

<p>for EDGAR (all versions), GAINS, RCP and MACCTITY, please use flux (kg m-2 s-1) NetCDF file.
</p>


<h3>Source</h3>

<p>Read abbout EDGAR at http://edgar.jrc.ec.europa.eu and MACCITY at
http://accent.aero.jussieu.fr/MACC_metadata.php
</p>
<p>More info for EDGARv8.1 https://edgar.jrc.ec.europa.eu/dataset_ap81 for short live species and https://edgar.jrc.ec.europa.eu/dataset_ghg80 for GHG
</p>


<h3>References</h3>

<p>Janssens-Maenhout, G., Dentener, F., Van Aardenne, J., Monni, S., Pagliari, V., Orlandini,
L., ... &amp; Wankmüller, R. (2012). EDGAR-HTAP: a harmonized gridded air pollution emission dataset
based on national inventories. European Commission Joint Research Centre Institute for
Environment and Sustainability. JRC 68434 UR 25229 EUR 25229, ISBN 978-92-79-23123-0.
</p>
<p>Lamarque, J.-F., Bond, T. C., Eyring, V., Granier, C., Heil, A., Klimont, Z., Lee, D., Liousse,
C., Mieville, A., Owen, B., Schultz, M. G., Shindell, D., Smith, S. J., Stehfest, E.,
Van Aardenne, J., Cooper, O. R., Kainuma, M., Mahowald, N., McConnell, J. R., Naik, V.,
Riahi, K., and van Vuuren, D. P.: Historical (1850-2000) gridded anthropogenic and biomass
burning emissions of reactive gases and aerosols: methodology and application,
Atmos. Chem. Phys., 10, 7017-7039, doi:10.5194/acp-10-7017-2010, 2010.
</p>
<p>Z Klimont, S. J. Smith and J Cofala The last decade of global anthropogenic sulfur dioxide:
2000–2011 emissions Environmental Research Letters 8, 014003, 2013
</p>
<p>Gurney, Kevin R., Jianming Liang, Risa Patarasuk, Yang Song, Jianhua Huang, and
Geoffrey Roest (2019) The Vulcan Version 3.0 High-Resolution Fossil Fuel CO2 Emissions
for the United States. Nature Scientific Data.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rasterSource">rasterSource</a></code> and <code><a href="#topic+gridInfo">gridInfo</a></code>
</p>
<p><code><a href="#topic+species">species</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
folder &lt;- file.path(tempdir(), "EDGARv8.1")
dir.create(folder)

url     &lt;- "https://jeodpp.jrc.ec.europa.eu/ftp/jrc-opendata/EDGAR/datasets"
dataset &lt;- "v81_FT2022_AP_new/NOx/TOTALS/flx_nc"
file    &lt;- "v8.1_FT2022_AP_NOx_2022_TOTALS_flx_nc.zip"

download.file(paste0(url,"/",dataset,"/",file), paste0(folder,"/",file))

unzip(paste0(folder,"/",file),exdir = folder)

nox  &lt;- read(file    = dir(path=folder, pattern="flx\\.nc", full.names=TRUE),
             version = "EDGARv8",
             spec    = c(E_NO  = 0.9 ,   # 90% of NOx is NO
                         E_NO2 = 0.1 ))  # 10% of NOx is NO2
# creating a color scale
cor &lt;- colorRampPalette(colors = c(c("#031057", "#0522FC",
                                     "#7E0AFA", "#EF0AFF",
                                     "#FFA530", "#FFF957")))
raster::plot(nox$E_NO, xlab="Latitude", ylab="Longitude",
             col = cor(12),zlim = c(-6.5e-7,1.4e-5),
             main="TOTAL NO emissions from EDGARv8.1 (in g / m2 s)")

d1  &lt;- gridInfo(paste(system.file("extdata", package = "EmissV"),"/wrfinput_d01",sep=""))
NO  &lt;- emission(grid = d1, inventory = nox$E_NO, pol = "NO", mm = 30.01,plot = TRUE)

</code></pre>

<hr>
<h2 id='speciation'>Speciation of emissions in different compounds</h2><span id='topic+speciation'></span>

<h3>Description</h3>

<p>Distribute the total mass of estimated emissions into model species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>speciation(total, spec = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="speciation_+3A_total">total</code></td>
<td>
<p>emissions from totalEmissions</p>
</td></tr>
<tr><td><code id="speciation_+3A_spec">spec</code></td>
<td>
<p>numeric speciation vector of species</p>
</td></tr>
<tr><td><code id="speciation_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list with the daily total emission by interest area (cityes, states, countries, etc).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+species">species</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>veic &lt;- vehicles(example = TRUE)
EmissionFactors &lt;- emissionFactor(example = TRUE)
TOTAL &lt;- totalEmission(veic,EmissionFactors,pol = "PM")
pm_iag &lt;- c(E_PM25I = 0.0509200,
            E_PM25J = 0.1527600,
            E_ECI   = 0.1196620,
            E_ECJ   = 0.0076380,
            E_ORGI  = 0.0534660,
            E_ORGJ  = 0.2279340,
            E_SO4I  = 0.0063784,
            E_SO4J  = 0.0405216,
            E_NO3J  = 0.0024656,
            E_NO3I  = 0.0082544,
            E_PM10  = 0.3300000)
PM &lt;- speciation(TOTAL,pm_iag)
</code></pre>

<hr>
<h2 id='species'>Species mapping tables</h2><span id='topic+species'></span>

<h3>Description</h3>

<p>Set of tables for speciation:
</p>

<dl>
<dt>voc_radm2_mic</dt><dd><p>Volatile organic compounds for RADM2</p>
</dd>
<dt>voc_cbmz_mic</dt><dd><p>Volatile organic compounds for CBMZ</p>
</dd>
<dt>voc_moz_mic</dt><dd><p>Volatile organic compounds for MOZART</p>
</dd>
<dt>voc_saprc99_mic</dt><dd><p>volatile organic compounds for SAPRC99</p>
</dd>
<dt>veicularvoc_radm2_iag</dt><dd><p>Vehicular volatile organic compounds for RADM2 (MOL)</p>
</dd>
<dt>veicularvoc_cbmz_iag</dt><dd><p>Vehicular volatile organic compounds for CBMZ (MOL)</p>
</dd>
<dt>veicularvoc_moz_iag</dt><dd><p>Vehicular volatile organic compounds for MOZART (MOL)</p>
</dd>
<dt>veicularvoc_saprc99_iag</dt><dd><p>Vehicular volatile organic compounds for SAPRC99 (MOL)</p>
</dd>
<dt>pm_madesorgan_iag</dt><dd><p>Particulate matter for made/sorgan</p>
</dd>
<dt>pm25_madesorgan_iag</dt><dd><p>Fine particulate matter for made/sorgan</p>
</dd>
<dt>nox_iag</dt><dd><p>Nox split Perez Martínez et al (2014)</p>
</dd>
<dt>nox_bcom</dt><dd><p>Nox split usin Ntziachristos and Zamaras (2016)</p>
</dd>
<dt>voc_radm2_edgar432</dt><dd><p>Volatile organic compounds species from EDGAR 4.3.2 for RADM2 (MOL)</p>
</dd>
<dt>voc_moz_edgar432</dt><dd><p>Volatile organic compounds species from EDGAR 4.3.2 for MOZART (MOL)</p>
</dd>
</dl>

<p>- Volatile organic compounds species map from 1 to 4 are from Li et al (2014) taken into account
several sources of pollutants.
</p>
<p>- Volatile organic compounds from vehicular activity species map 5 to 8 is a by fuel and emission
process from USP-IAG tunel experiments (Rafee et al., 2017) emited by the process of exhaust
(through the exhaust pipe), liquid (carter and evaporative) and vapor (fuel transfer operations).
</p>
<p>- Particulate matter speciesmap for made/sorgan emissions 9 and 10.
</p>
<p>- Nox split using Perez Martínez et al (2014) data (11).
</p>
<p>- Nox split using mean of Ntziachristos and Zamaras (2016) data (12).
</p>
<p>- Volatile organic compounds species map 13 and 14 are the corespondence from EDGAR 4.3.2 VOC
specialization to RADM2 and MOZART.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(species)
</code></pre>


<h3>Format</h3>

<p>List of numeric vectors with the 'names()' of the species and the values of each species.
</p>


<h3>Details</h3>

<p>iag-voc: After estimating all the emissions of NMHC, it was used the speciation
presented in (RAFEE et al., 2017). This speciation is based on tunnel measurements
in São Paulo, depends on the type of fuel (E25, E100 and B5) and provides the
mass of each chemical compound as mol/g. This speciation splits the NMHC
from evaporative, liquid and exhaust emissions of E25, E100 and B5, into minimum
compounds required for the Carbon Bond Mechanism (CBMZ) (ZAVERI; PETERS, 1999). Atmospheric
simulations using the same pollutants in Brazil have resulted in good agreement with
observations (ANDRADE et al., 2015).
</p>
<p>iag-pm: data tunnel experiments at São Paulo in Perez Martínez et al (2014)
</p>
<p>iag-nox: common NOx split for São Paulo Metropolitan area.
</p>
<p>bcom-nox: mean of Ntziachristos and Zamaras (2016) data.
</p>
<p>mic: from Li et al (2014).
</p>
<p>edgar: Edgar 4.3.2 emissions Crippa et al. (2018).
</p>


<h3>Note</h3>

<p>The units are mass ratio (mass/mass) or MOL (MOL), this last case do not change the
default 'mm' into 'emission()' function.
</p>


<h3>References</h3>

<p>Li, M., Zhang, Q., Streets, D. G., He, K. B., Cheng, Y. F., Emmons, L. K., ... &amp; Su, H. (2014).
Mapping Asian anthropogenic emissions of non-methane volatile organic compounds to multiple
chemical mechanisms. Atmos. Chem. Phys, 14(11), 5617-5638.
</p>
<p>Huang, G., Brook, R., Crippa, M., Janssens-Maenhout, G., Schieberle, C., Dore, C., ... &amp;
Friedrich, R. (2017). Speciation of anthropogenic emissions of non-methane volatile organic
compounds: a global gridded data set for 1970–2012. Atmospheric Chemistry and Physics, 17(12),
7683.
</p>
<p>Abou Rafee, S. A., Martins, L. D., Kawashima, A. B., Almeida, D. S., Morais, M. V. B.,
Souza, R. V. A., Oliveira, M. B. L., Souza, R. A. F., Medeiros, A. S. S., Urbina, V.,
Freitas, E. D., Martin, S. T., and Martins, J. A.: Contributions of mobile, stationary and
biogenic sources to air pollution in the Amazon rainforest: a numerical study with the
WRF-Chem model, Atmos. Chem. Phys., 17, 7977-7995, https://doi.org/10.5194/acp-17-7977-2017,
2017.
</p>
<p>Martins, L. D., Andrade, M. F. D., Freitas, E., Pretto, A., Gatti, L. V., Junior, O. M.
A., et al. (2006). Emission factors for gas-powered vehicles traveling through
road tunnels in Sao Paulo, Brazil. Environ. Sci. Technol. 40, 6722–6729. doi: 10.1021/es052441u
</p>
<p>Pérez-Martínez, P. J., Miranda, R. M., Nogueira, T., Guardani, M. L., Fornaro, A., Ynoue, R., &amp;
Andrade, M. F. (2014). Emission factors of air pollutants from vehicles measured inside road
tunnels in São Paulo: case study comparison. International Journal of Environmental Science
and Technology, 11(8), 2155-2168.
</p>
<p>ANDRADE, M. d. F. et al. Air quality forecasting system for southeastern brazil. Frontiers in
Environmental Science, Frontiers, v. 3, p. 1–12, 2015.
</p>
<p>Crippa, M., Guizzardi, D., Muntean, M., Schaaf, E., Dentener, F., Aardenne, J. A. V., ... &amp;
Janssens-Maenhout, G. (2018). Gridded emissions of air pollutants for the period 1970–2012
within EDGAR v4.3.2. Earth System Science Data, 10(4), 1987-2013.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+speciation">speciation</a></code> and <code><a href="#topic+read">read</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load the mapping tables
data(species)
# names of eath mapping tables
for(i in 1:length(names(species)))
    cat(paste0("specie map ",i," ",names(species)[i],"\n"))
# names of species contained in the (first) mapping table
names(species[[1]])
# The first mapping table / species and values
species[1]
</code></pre>

<hr>
<h2 id='totalEmission'>Calculate total emissions</h2><span id='topic+totalEmission'></span>

<h3>Description</h3>

<p>Caculate the total emission with:
</p>
<p>Emission(pollutant) = sum( Vehicles(n) * Km_day_use(n) * Emission_Factor(n,pollutant) )
</p>
<p>where n is the type of the veicle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>totalEmission(v, ef, pol, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="totalEmission_+3A_v">v</code></td>
<td>
<p>dataframe with the vehicle data</p>
</td></tr>
<tr><td><code id="totalEmission_+3A_ef">ef</code></td>
<td>
<p>emission factor</p>
</td></tr>
<tr><td><code id="totalEmission_+3A_pol">pol</code></td>
<td>
<p>pollutant name in ef</p>
</td></tr>
<tr><td><code id="totalEmission_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list with the daily total emission by interest area (cityes, states, countries, etc).
</p>


<h3>Note</h3>

<p>the units (set_units(&quot;value&quot;,unit) where the recomended unit is g/d) must be used to make the ef data.frame
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rasterSource">rasterSource</a></code>, <code><a href="#topic+lineSource">lineSource</a></code> and <code><a href="#topic+emission">emission</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>veic &lt;- vehicles(example = TRUE)

EmissionFactors &lt;- emissionFactor(example = TRUE)

TOTAL &lt;- totalEmission(veic,EmissionFactors,pol = c("CO","PM"))
</code></pre>

<hr>
<h2 id='vehicles'>Tool to set-up vehicle data table</h2><span id='topic+vehicles'></span>

<h3>Description</h3>

<p>Return a data frame with 4 columns (vehicle category, type, fuel and avarage kilometers driven) and an aditional column with the number of vehicles for each interest area (cityes, states, countries, etc).
</p>
<p>Average daily kilometres driven are defined by vehicle type:
</p>
<p>- LDV (Light duty Vehicles) 41 km / day
</p>
<p>- TRUCKS (Trucks) 110 km / day
</p>
<p>- BUS (Busses) 165 km / day
</p>
<p>- MOTO (motorcycles and other vehicles) 140 km / day
</p>
<p>The number of vehicles are defined by the distribution of vehicles by vehicle classs and the total number of vehicles by area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vehicles(
  total_v,
  area_name = names(total_v),
  distribution,
  type,
  category = NA,
  fuel = NA,
  vnames = NA,
  example = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vehicles_+3A_total_v">total_v</code></td>
<td>
<p>total of vehicles by area (area length)</p>
</td></tr>
<tr><td><code id="vehicles_+3A_area_name">area_name</code></td>
<td>
<p>area names (area length)</p>
</td></tr>
<tr><td><code id="vehicles_+3A_distribution">distribution</code></td>
<td>
<p>distribution of vehicles by vehicle class</p>
</td></tr>
<tr><td><code id="vehicles_+3A_type">type</code></td>
<td>
<p>type of vehicle by vehicle class (distribution length)</p>
</td></tr>
<tr><td><code id="vehicles_+3A_category">category</code></td>
<td>
<p>category name (distribution length / NA)</p>
</td></tr>
<tr><td><code id="vehicles_+3A_fuel">fuel</code></td>
<td>
<p>fuel type by vehicle class (distribution length / NA)</p>
</td></tr>
<tr><td><code id="vehicles_+3A_vnames">vnames</code></td>
<td>
<p>name of each vehicle class (distribution length / NA)</p>
</td></tr>
<tr><td><code id="vehicles_+3A_example">example</code></td>
<td>
<p>a simple example</p>
</td></tr>
<tr><td><code id="vehicles_+3A_verbose">verbose</code></td>
<td>
<p>display additional information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a fleet distribution data.frame for totalEmission function
</p>


<h3>Note</h3>

<p>total_v and area_name must have the same length.
</p>
<p>distribution, type, category (if used), fuel (if used) and vnames (if used) must have the same length.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaSource">areaSource</a></code> and  <code><a href="#topic+totalEmission">totalEmission</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fleet &lt;- vehicles(example = TRUE)

# or the code bellow for the same result
# DETRAN 2016 data for total number of vehicles for 5 Brazilian states (Sao Paulo,
# Rio de Janeiro, Minas Gerais, Parana and Santa Catarina)
# vahicle distribution of Sao Paulo

fleet &lt;- vehicles(total_v = c(27332101, 6377484, 10277988, 7140439, 4772160),
                  area_name = c("SP", "RJ", "MG", "PR", "SC"),
                  distribution = c( 0.4253, 0.0320, 0.3602, 0.0260,
                                   0.0290, 0.0008, 0.1181, 0.0086),
                  category =  c("LDV_E25","LDV_E100","LDV_F","TRUCKS_B5",
                                "CBUS_B5","MBUS_B5","MOTO_E25","MOTO_F"),
                  type = c("LDV", "LDV", "LDV","TRUCKS",
                          "BUS","BUS","MOTO", "MOTO"),
                  fuel = c("E25", "E100", "FLEX","B5",
                           "B5","B5","E25", "FLEX"),
                  vnames = c("Light duty Vehicles Gasohol","Light Duty Vehicles Ethanol",
                             "Light Duty Vehicles Flex","Diesel trucks","Diesel urban busses",
                             "Diesel intercity busses","Gasohol motorcycles",
                             "Flex motorcycles"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
