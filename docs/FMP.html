<!DOCTYPE html><html><head><title>Help for package FMP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FMP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eap'><p>Compute eap trait estimates for FMP and FUP models</p></a></li>
<li><a href='#erf'><p>Utility fnc to compute the components for an empirical response function</p></a></li>
<li><a href='#FMP'><p>Estimate the coefficients of a filtered monotonic polynomial IRT model</p></a></li>
<li><a href='#FMPMonotonicityCheck'><p>Utility function for checking FMP monotonicity</p></a></li>
<li><a href='#FUP'><p>Estimate the coefficients of a filtered unconstrained polynomial IRT model</p></a></li>
<li><a href='#gen4PMData'><p>Generate item response data for 1, 2, 3, or 4-parameter IRT models</p></a></li>
<li><a href='#genFMPData'><p>Generate item response data for a filtered monotonic polynomial IRT model</p></a></li>
<li><a href='#irf'><p>Plot item response functions for polynomial IRT models.</p></a></li>
<li><a href='#restScore'><p>Plot an ERF using rest scores</p></a></li>
<li><a href='#svdNorm'><p>Compute theta surrogates via normalized SVD scores</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-02-08</td>
</tr>
<tr>
<td>Title:</td>
<td>Filtered Monotonic Polynomial IRT Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Niels G. Waller &lt;nwaller@umn.edu&gt; </td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Niels G. Waller &lt;nwaller@umn.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates Filtered Monotonic Polynomial IRT Models as described by Liang and Browne (2015) &lt;<a href="https://doi.org/10.3102%2F1076998614556816">doi:10.3102/1076998614556816</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-02-09 02:34:38 UTC; nielswaller</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-02-09 15:38:39</td>
</tr>
</table>
<hr>
<h2 id='eap'>Compute eap trait estimates for FMP and FUP models</h2><span id='topic+eap'></span>

<h3>Description</h3>

<p>Compute eap trait estimates for items fit by filtered 
monotonic polynomial IRT models.</p>


<h3>Usage</h3>

<pre><code class='language-R'> eap(data, bParams, NQuad = 21, priorVar = 2, mintheta = -4, maxtheta = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eap_+3A_data">data</code></td>
<td>
<p>N(subjects)-by-p(items) matrix of 0/1 item response data.</p>
</td></tr>
<tr><td><code id="eap_+3A_bparams">bParams</code></td>
<td>
<p>A p-by-9 matrix of FMP or FUP item parameters and model designations. Columns 1 - 8 hold the (possibly zero valued) polynomial coefficients; column 9 holds the value of <code>k</code>.</p>
</td></tr>
<tr><td><code id="eap_+3A_nquad">NQuad</code></td>
<td>
<p>Number of quadrature points used to calculate the eap estimates.</p>
</td></tr>
<tr><td><code id="eap_+3A_priorvar">priorVar</code></td>
<td>
<p>Variance of the normal prior for the eap estimates. The prior mean equals 0.</p>
</td></tr>
<tr><td><code id="eap_+3A_mintheta">mintheta</code>, <code id="eap_+3A_maxtheta">maxtheta</code></td>
<td>
<p>NQuad quadrature points will be evenly spaced between <code>mintheta</code> and <code>maxtheta</code></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>eap trait estimates.</code></td>
<td>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Niels Waller</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## this example demonstrates how to calculate 
## eap trait estimates for a scale composed of items 
## that have been fit to FMP models of different 
## degree 

NSubjects &lt;- 2000

## Assume that 
## items 1 - 5 fit a k=0 model,
## items 6 - 10 fit a k=1 model, and 
## items 11 - 15 fit a k=2 model.


 itmParameters &lt;- matrix(c(
  #  b0    b1     b2    b3    b4  b5, b6, b7,  k
  -1.05, 1.63,  0.00, 0.00, 0.00,  0,     0,  0,   0, #1
  -1.97, 1.75,  0.00, 0.00, 0.00,  0,     0,  0,   0, #2
  -1.77, 1.82,  0.00, 0.00, 0.00,  0,     0,  0,   0, #3
  -4.76, 2.67,  0.00, 0.00, 0.00,  0,     0,  0,   0, #4
  -2.15, 1.93,  0.00, 0.00, 0.00,  0,     0,  0,   0, #5
  -1.25, 1.17, -0.25, 0.12, 0.00,  0,     0,  0,   1, #6
   1.65, 0.01,  0.02, 0.03, 0.00,  0,     0,  0,   1, #7
  -2.99, 1.64,  0.17, 0.03, 0.00,  0,     0,  0,   1, #8
  -3.22, 2.40, -0.12, 0.10, 0.00,  0,     0,  0,   1, #9
  -0.75, 1.09, -0.39, 0.31, 0.00,  0,     0,  0,   1, #10
  -1.21, 9.07,  1.20,-0.01,-0.01,  0.01,  0,  0,   2, #11
  -1.92, 1.55, -0.17, 0.50,-0.01,  0.01,  0,  0,   2, #12
  -1.76, 1.29, -0.13, 1.60,-0.01,  0.01,  0,  0,   2, #13
  -2.32, 1.40,  0.55, 0.05,-0.01,  0.01,  0,  0,   2, #14
  -1.24, 2.48, -0.65, 0.60,-0.01,  0.01,  0,  0,   2),#15
  15, 9, byrow=TRUE)
 
# generate data using the above item parameters
ex1.data&lt;-genFMPData(NSubj = NSubjects, bParams = itmParameters, 
                    seed = 345)$data


## calculate eap estimates for mixed models
thetaEAP&lt;-eap(data = ex1.data, bParams = itmParameters, 
                   NQuad = 25, priorVar = 2, 
                   mintheta = -4, maxtheta = 4)

## compare eap estimates with initial theta surrogates

if(FALSE){     #set to TRUE to see plot

  thetaInit &lt;- svdNorm(ex1.data)
  plot(thetaInit,thetaEAP, xlim = c(-3.5,3.5), 
                         ylim = c(-3.5,3.5),
                         xlab = "Initial theta surrogates",
                         ylab = "EAP trait estimates (Mixed models)")
}                         
</code></pre>

<hr>
<h2 id='erf'>Utility fnc to compute the components for an empirical response function</h2><span id='topic+erf'></span>

<h3>Description</h3>

<p>Utility function to compute empirical response functions.</p>


<h3>Usage</h3>

<pre><code class='language-R'> erf(theta, data, whichItem, min = -3, max = 3, Ncuts = 12)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="erf_+3A_theta">theta</code></td>
<td>
<p>Vector of estimated latent trait scores.</p>
</td></tr>
<tr><td><code id="erf_+3A_data">data</code></td>
<td>
<p>A matrix of binary item responses.</p>
</td></tr>
<tr><td><code id="erf_+3A_whichitem">whichItem</code></td>
<td>
<p>Data for an erf will be generated for whichItem.</p>
</td></tr>
<tr><td><code id="erf_+3A_min">min</code></td>
<td>
<p>Default = -3. Minimum value of theta.</p>
</td></tr>
<tr><td><code id="erf_+3A_max">max</code></td>
<td>
<p>Default = 3. Maximum value of theta.</p>
</td></tr>
<tr><td><code id="erf_+3A_ncuts">Ncuts</code></td>
<td>
<p>Number of score groups for erf.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>probs</code></td>
<td>
<p>A vector (of length Ncuts) of bin response probabilities for the empirical response function.</p>
</td></tr>
<tr><td><code>centers</code></td>
<td>
<p>A vector of bin centers. </p>
</td></tr>
<tr><td><code>Ni</code></td>
<td>
<p>Bin sample sizes.</p>
</td></tr> 
<tr><td><code>se.p</code></td>
<td>
<p>Standard errors of the estimated bin response probabilities.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niels Waller</p>


<h3>Examples</h3>

<pre><code class='language-R'>NSubj &lt;- 2000

#generate sample k=1 FMP  data
b &lt;- matrix(c(
    #b0    b1     b2    b3      b4   b5 b6 b7  k
  1.675, 1.974, -0.068, 0.053,  0,  0,  0,  0, 1,
  1.550, 1.805, -0.230, 0.032,  0,  0,  0,  0, 1,
  1.282, 1.063, -0.103, 0.003,  0,  0,  0,  0, 1,
  0.704, 1.376, -0.107, 0.040,  0,  0,  0,  0, 1,
  1.417, 1.413,  0.021, 0.000,  0,  0,  0,  0, 1,
 -0.008, 1.349, -0.195, 0.144,  0,  0,  0,  0, 1,
  0.512, 1.538, -0.089, 0.082,  0,  0,  0,  0, 1,
  0.122, 0.601, -0.082, 0.119,  0,  0,  0,  0, 1,
  1.801, 1.211,  0.015, 0.000,  0,  0,  0,  0, 1,
 -0.207, 1.191,  0.066, 0.033,  0,  0,  0,  0, 1,
 -0.215, 1.291, -0.087, 0.029,  0,  0,  0,  0, 1,
  0.259, 0.875,  0.177, 0.072,  0,  0,  0,  0, 1,
 -0.423, 0.942,  0.064, 0.094,  0,  0,  0,  0, 1,
  0.113, 0.795,  0.124, 0.110,  0,  0,  0,  0, 1,
  1.030, 1.525,  0.200, 0.076,  0,  0,  0,  0, 1,
  0.140, 1.209,  0.082, 0.148,  0,  0,  0,  0, 1,
  0.429, 1.480, -0.008, 0.061,  0,  0,  0,  0, 1,
  0.089, 0.785, -0.065, 0.018,  0,  0,  0,  0, 1,
 -0.516, 1.013,  0.016, 0.023,  0,  0,  0,  0, 1,
  0.143, 1.315, -0.011, 0.136,  0,  0,  0,  0, 1,
  0.347, 0.733, -0.121, 0.041,  0,  0,  0,  0, 1,
 -0.074, 0.869,  0.013, 0.026,  0,  0,  0,  0, 1,
  0.630, 1.484, -0.001, 0.000,  0,  0,  0,  0, 1), 
  nrow=23, ncol=9, byrow=TRUE)  
 
theta &lt;- rnorm(NSubj)  
data&lt;-genFMPData(NSubj = NSubj, bParam = b, theta = theta, seed = 345)$data

erfItem1 &lt;- erf(theta, data, whichItem = 1, min = -3, max = 3, Ncuts = 12)

plot( erfItem1$centers, erfItem1$probs, type="b", 
      main="Empirical Response Function",
      xlab = expression(theta),
      ylab="Probability",
      cex.lab=1.5)
</code></pre>

<hr>
<h2 id='FMP'>Estimate the coefficients of a filtered monotonic polynomial IRT model</h2><span id='topic+FMP'></span>

<h3>Description</h3>

<p>Estimate the coefficients of a filtered monotonic polynomial IRT model.</p>


<h3>Usage</h3>

<pre><code class='language-R'> FMP(data, thetaInit, item, startvals, k, eps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FMP_+3A_data">data</code></td>
<td>
<p>N(subjects)-by-p(items) matrix of 0/1 item response data.</p>
</td></tr>
<tr><td><code id="FMP_+3A_thetainit">thetaInit</code></td>
<td>
<p>Initial theta (<code class="reqn">\theta</code>) surrogates (e.g., calculated by <a href="#topic+svdNorm">svdNorm</a>).</p>
</td></tr>
<tr><td><code id="FMP_+3A_item">item</code></td>
<td>
<p>Item number for coefficient estimation.</p>
</td></tr>
<tr><td><code id="FMP_+3A_startvals">startvals</code></td>
<td>
<p>Start values for function minimization. Start values are in the gamma metric (see Liang &amp; Browne, 2015)</p>
</td></tr> 
<tr><td><code id="FMP_+3A_k">k</code></td>
<td>
<p>Order of monotonic polynomial = 2k+1 (see Liang &amp; Browne, 2015). k can equal 0, 1, 2, or 3.</p>
</td></tr>
<tr><td><code id="FMP_+3A_eps">eps</code></td>
<td>
<p>Step size for gradient approximation, default = 1e-6. If a convergence failure occurs during function optimization reducing the value of eps will often produce a converged solution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As described by Liang and Browne (2015), the filtered polynomial model (FMP) is a quasi-parametric 
IRT model in which the IRF is a composition of a logistic function and a polynomial function, <code class="reqn">m(\theta)</code>, of degree 2k + 1. 
When k = 0, <code class="reqn">m(\theta) = b_0 + b_1 \theta</code> 
(the slope intercept form of the 2PL). When k = 1, 2k + 1 equals 3 resulting in 
<code class="reqn">m(\theta) = b_0 + b_1 \theta + b_2 \theta^2 + b_3 \theta^3</code>. Acceptable values of k = 0,1,2,3. According to 
Liang and Browne, the &quot;FMP IRF may be used to approximate any IRF with a continuous derivative arbitrarily 
closely by increasing the number of parameters in the monotonic polynomial&quot; (2015, p. 2) The FMP model assumes that the
IRF is monotonically increasing, bounded by 0 and 1, and everywhere differentiable with respect to theta (the latent trait).
</p>


<h3>Value</h3>

<table>
<tr><td><code>b</code></td>
<td>
<p>Vector of polynomial coefficients.</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Polynomial coefficients in gamma metric (see Liang &amp; Browne, 2015).</p>
</td></tr>
<tr><td><code>FHAT</code></td>
<td>
<p>Function value at convergence.</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p>Number of function evaluations during minimization (see optim documentation for further details).</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Pseudo scaled Akaike Information Criterion (AIC). Candidate models that produce the smallest AIC suggest the optimal number of parameters given the sample size. Scaling is accomplished by dividing the non-scaled AIC by sample size.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Pseudo scaled Bayesian Information Criterion (BIC). Candidate models that produce the smallest BIC suggest the optimal number of parameters given the sample size. Scaling is accomplished by dividing the non-scaled BIC by sample size.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>Convergence = 0 indicates that the optimization algorithm converged; convergence=1 indicates that the optimization failed to converge.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niels Waller</p>


<h3>References</h3>

<p>Liang, L. &amp; Browne, M. W. (2015). A quasi-parametric method for fitting flexible item response functions.
<em>Journal of Educational and Behavioral Statistics, 40</em>, 5&ndash;34.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## In this example we will generate 2000 item response vectors 
## for a k = 1 order filtered polynomial model and then recover 
## the estimated item parameters with the FMP function.  

k &lt;- 1  # order of polynomial

NSubjects &lt;- 2000


## generate a sample of 2000 item response vectors 
## for a k = 1 FMP model using the following
## coefficients
b &lt;- matrix(c(
   #b0     b1      b2     b3   b4  b5  b6  b7  k
  1.675, 1.974, -0.068, 0.053,  0,  0,  0,  0, 1,
  1.550, 1.805, -0.230, 0.032,  0,  0,  0,  0, 1,
  1.282, 1.063, -0.103, 0.003,  0,  0,  0,  0, 1,
  0.704, 1.376, -0.107, 0.040,  0,  0,  0,  0, 1,
  1.417, 1.413,  0.021, 0.000,  0,  0,  0,  0, 1,
 -0.008, 1.349, -0.195, 0.144,  0,  0,  0,  0, 1,
  0.512, 1.538, -0.089, 0.082,  0,  0,  0,  0, 1,
  0.122, 0.601, -0.082, 0.119,  0,  0,  0,  0, 1,
  1.801, 1.211,  0.015, 0.000,  0,  0,  0,  0, 1,
 -0.207, 1.191,  0.066, 0.033,  0,  0,  0,  0, 1,
 -0.215, 1.291, -0.087, 0.029,  0,  0,  0,  0, 1,
  0.259, 0.875,  0.177, 0.072,  0,  0,  0,  0, 1,
 -0.423, 0.942,  0.064, 0.094,  0,  0,  0,  0, 1,
  0.113, 0.795,  0.124, 0.110,  0,  0,  0,  0, 1,
  1.030, 1.525,  0.200, 0.076,  0,  0,  0,  0, 1,
  0.140, 1.209,  0.082, 0.148,  0,  0,  0,  0, 1,
  0.429, 1.480, -0.008, 0.061,  0,  0,  0,  0, 1,
  0.089, 0.785, -0.065, 0.018,  0,  0,  0,  0, 1,
 -0.516, 1.013,  0.016, 0.023,  0,  0,  0,  0, 1,
  0.143, 1.315, -0.011, 0.136,  0,  0,  0,  0, 1,
  0.347, 0.733, -0.121, 0.041,  0,  0,  0,  0, 1,
 -0.074, 0.869,  0.013, 0.026,  0,  0,  0,  0, 1,
  0.630, 1.484, -0.001, 0.000,  0,  0,  0,  0, 1), 
  nrow=23, ncol=9, byrow=TRUE)  
  
ex1.data&lt;-genFMPData(NSubj = NSubjects, bParams = b, seed = 345)$data

## number of items in the data matrix
NItems &lt;- ncol(ex1.data)

# compute (initial) surrogate theta values from 
# the normed left singular vector of the centered 
# data matrix
thetaInit &lt;- svdNorm(ex1.data)


## earlier we defined k = 1
  if(k == 0) {
            startVals &lt;- c(1.5, 1.5)
            bmat &lt;- matrix(0, NItems, 6)
            colnames(bmat) &lt;- c(paste("b", 0:1, sep = ""),"FHAT", "AIC", "BIC", "convergence") 
  }
  if(k == 1) {
           startVals &lt;- c(1.5, 1.5, .10, .10)
           bmat &lt;- matrix(0, NItems, 8)
           colnames(bmat) &lt;- c(paste("b", 0:3, sep = ""),"FHAT", "AIC", "BIC", "convergence") 
  }
  if(k == 2) {
           startVals &lt;- c(1.5, 1.5, .10, .10, .10, .10)
           bmat &lt;- matrix(0, NItems, 10)
           colnames(bmat) &lt;- c(paste("b", 0:5, sep = ""),"FHAT", "AIC", "BIC", "convergence") 
  }
  if(k == 3) {
           startVals &lt;- c(1.5, 1.5, .10, .10, .10, .10, .10, .10)
           bmat &lt;- matrix(0, NItems, 12)
           colnames(bmat) &lt;- c(paste("b", 0:7, sep = ""),"FHAT", "AIC", "BIC", "convergence") 
  }         
  
# estimate item parameters and fit statistics  
  for(i in 1:NItems){
    out &lt;- FMP(data = ex1.data, thetaInit, item = i, startvals = startVals, k = k)
    Nb &lt;- length(out$b)
    bmat[i,1:Nb] &lt;- out$b
    bmat[i,Nb+1] &lt;- out$FHAT
    bmat[i,Nb+2] &lt;- out$AIC
    bmat[i,Nb+3] &lt;- out$BIC
    bmat[i,Nb+4] &lt;- out$convergence
  }

# print output 
print(bmat)

## End(Not run)
</code></pre>

<hr>
<h2 id='FMPMonotonicityCheck'>Utility function for checking FMP monotonicity</h2><span id='topic+FMPMonotonicityCheck'></span>

<h3>Description</h3>

<p>Utility function for checking whether candidate FMP coefficients yield a monotonically increasing polynomial.</p>


<h3>Usage</h3>

<pre><code class='language-R'> FMPMonotonicityCheck(b, lower = -20, upper = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FMPMonotonicityCheck_+3A_b">b</code></td>
<td>
<p>A vector of 8 polynomial coefficients (<code class="reqn">b</code>) for <code class="reqn">m(\theta)=b_0 + 
 b_1 \theta + b_2 \theta^2 + b_3 \theta^3 + b_4 \theta^4 + 
 b_5 \theta^5 + b_6 \theta^6 + b_7 \theta^7</code>.</p>
</td></tr>
<tr><td><code id="FMPMonotonicityCheck_+3A_lower">lower</code>, <code id="FMPMonotonicityCheck_+3A_upper">upper</code></td>
<td>
<p>Theta bounds for monotonicity check.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>minDeriv</code></td>
<td>
<p>Minimum value of the derivative for the polynomial.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niels Waller</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## A set of candidate coefficients for an FMP model.
## These coefficients fail the test and thus
## should not be used with genFMPdata to generate
## item response data that are consistent with an 
## FMP model.
 b &lt;- c(1.21, 1.87, -1.02, 0.18, 0.18, 0, 0, 0)
 FMPMonotonicityCheck(b)
</code></pre>

<hr>
<h2 id='FUP'>Estimate the coefficients of a filtered unconstrained polynomial IRT model</h2><span id='topic+FUP'></span>

<h3>Description</h3>

<p>Estimate the coefficients of a filtered unconstrained polynomial IRT model.</p>


<h3>Usage</h3>

<pre><code class='language-R'> FUP(data, thetaInit, item, startvals, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FUP_+3A_data">data</code></td>
<td>
<p>N(subjects)-by-p(items) matrix of 0/1 item response data.</p>
</td></tr>
<tr><td><code id="FUP_+3A_thetainit">thetaInit</code></td>
<td>
<p>Initial theta surrogates (e.g., calculated by <a href="#topic+svdNorm">svdNorm</a>).</p>
</td></tr>
<tr><td><code id="FUP_+3A_item">item</code></td>
<td>
<p>item number for coefficient estimation.</p>
</td></tr>
<tr><td><code id="FUP_+3A_startvals">startvals</code></td>
<td>
<p>start values for function minimization.</p>
</td></tr> 
<tr><td><code id="FUP_+3A_k">k</code></td>
<td>
<p>order of monotonic polynomial = 2k+1 (see Liang &amp; Browne, 2015).</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>b</code></td>
<td>
<p>Vector of polynomial coefficients.</p>
</td></tr>
<tr><td><code>FHAT</code></td>
<td>
<p>Function value at convergence.</p>
</td></tr>
<tr><td><code>counts</code></td>
<td>
<p>Number of function evaluations during minimization (see optim documentation for further details).</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Pseudo scaled Akaike Information Criterion (AIC). Candidate models that produce the smallest AIC suggest the optimal number of parameters given the sample size. Scaling is accomplished by dividing the non-scaled AIC by sample size.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Pseudo scaled Bayesian Information Criterion (BIC). Candidate models that produce the smallest BIC suggest the optimal number of parameters given the sample size. Scaling is accomplished by dividing the non-scaled BIC by sample size.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>Convergence = 0 indicates that the optimization algorithm converged; convergence=1 indicates that the optimization failed to converge.
</p>
<p>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niels Waller</p>


<h3>References</h3>

<p>Liang, L. &amp; Browne, M. W. (2015). A quasi-parametric method for fitting flexible item response functions.
<em>Journal of Educational and Behavioral Statistics, 40</em>, 5&ndash;34.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
NSubjects &lt;- 2000


## generate sample k=1 FMP data
b &lt;- matrix(c(
    #b0    b1     b2    b3      b4   b5 b6 b7  k
  1.675, 1.974, -0.068, 0.053,  0,  0,  0,  0, 1,
  1.550, 1.805, -0.230, 0.032,  0,  0,  0,  0, 1,
  1.282, 1.063, -0.103, 0.003,  0,  0,  0,  0, 1,
  0.704, 1.376, -0.107, 0.040,  0,  0,  0,  0, 1,
  1.417, 1.413,  0.021, 0.000,  0,  0,  0,  0, 1,
 -0.008, 1.349, -0.195, 0.144,  0,  0,  0,  0, 1,
  0.512, 1.538, -0.089, 0.082,  0,  0,  0,  0, 1,
  0.122, 0.601, -0.082, 0.119,  0,  0,  0,  0, 1,
  1.801, 1.211,  0.015, 0.000,  0,  0,  0,  0, 1,
 -0.207, 1.191,  0.066, 0.033,  0,  0,  0,  0, 1,
 -0.215, 1.291, -0.087, 0.029,  0,  0,  0,  0, 1,
  0.259, 0.875,  0.177, 0.072,  0,  0,  0,  0, 1,
 -0.423, 0.942,  0.064, 0.094,  0,  0,  0,  0, 1,
  0.113, 0.795,  0.124, 0.110,  0,  0,  0,  0, 1,
  1.030, 1.525,  0.200, 0.076,  0,  0,  0,  0, 1,
  0.140, 1.209,  0.082, 0.148,  0,  0,  0,  0, 1,
  0.429, 1.480, -0.008, 0.061,  0,  0,  0,  0, 1,
  0.089, 0.785, -0.065, 0.018,  0,  0,  0,  0, 1,
 -0.516, 1.013,  0.016, 0.023,  0,  0,  0,  0, 1,
  0.143, 1.315, -0.011, 0.136,  0,  0,  0,  0, 1,
  0.347, 0.733, -0.121, 0.041,  0,  0,  0,  0, 1,
 -0.074, 0.869,  0.013, 0.026,  0,  0,  0,  0, 1,
  0.630, 1.484, -0.001, 0.000,  0,  0,  0,  0, 1), 
  nrow=23, ncol=9, byrow=TRUE)  
 
# generate data using the above item parameters 
ex1.data&lt;-genFMPData(NSubj = NSubjects, bParams = b, seed = 345)$data

NItems &lt;- ncol(ex1.data)

# compute (initial) surrogate theta values from 
# the normed left singular vector of the centered 
# data matrix
thetaInit &lt;- svdNorm(ex1.data)

# Choose model
k &lt;- 1  # order of polynomial = 2k+1

# Initialize matrices to hold output
if(k == 0) {
  startVals &lt;- c(1.5, 1.5)
  bmat &lt;- matrix(0,NItems,6)
  colnames(bmat) &lt;- c(paste("b", 0:1, sep = ""),"FHAT", "AIC", "BIC", "convergence") 
}

if(k == 1) {
  startVals &lt;- c(1.5, 1.5, .10, .10)
  bmat &lt;- matrix(0,NItems,8)
  colnames(bmat) &lt;- c(paste("b", 0:3, sep = ""),"FHAT", "AIC", "BIC", "convergence") 
}

if(k == 2) {
  startVals &lt;- c(1.5, 1.5, .10, .10, .10, .10)
  bmat &lt;- matrix(0,NItems,10)
  colnames(bmat) &lt;- c(paste("b", 0:5, sep = ""),"FHAT", "AIC", "BIC", "convergence") 
}

if(k == 3) {
  startVals &lt;- c(1.5, 1.5, .10, .10, .10, .10, .10, .10)
  bmat &lt;- matrix(0,NItems,12)
  colnames(bmat) &lt;- c(paste("b", 0:7, sep = ""),"FHAT", "AIC", "BIC", "convergence") 
}   


# estimate item parameters and fit statistics
for(i in 1:NItems){
  out&lt;-FUP(data = ex1.data,thetaInit = thetaInit, item = i, startvals = startVals, k = k)
  Nb &lt;- length(out$b)
  bmat[i,1:Nb] &lt;- out$b
  bmat[i,Nb+1] &lt;- out$FHAT
  bmat[i,Nb+2] &lt;- out$AIC
  bmat[i,Nb+3] &lt;- out$BIC
  bmat[i,Nb+4] &lt;- out$convergence
}

# print results
print(bmat)

## End(Not run)
</code></pre>

<hr>
<h2 id='gen4PMData'>Generate item response data for 1, 2, 3, or 4-parameter IRT models</h2><span id='topic+gen4PMData'></span>

<h3>Description</h3>

<p>Generate item response data for or 1, 2, 3 or 4-parameter IRT Models.</p>


<h3>Usage</h3>

<pre><code class='language-R'> gen4PMData(NSubj, abcdParams, D = 1.702,  seed = NULL, 
                   theta = NULL, thetaMN = 0, thetaVar = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen4PMData_+3A_nsubj">NSubj</code></td>
<td>
<p>the desired number of subject response vectors.</p>
</td></tr>
<tr><td><code id="gen4PMData_+3A_abcdparams">abcdParams</code></td>
<td>
<p>a p(items)-by-4 matrix of IRT item parameters: a = discrimination, b = difficulty, c = lower asymptote, and d = upper asymptote.</p>
</td></tr>
<tr><td><code id="gen4PMData_+3A_d">D</code></td>
<td>
<p>Scaling constant to place the IRF on the normal ogive or logistic metric. Default = 1.702 (normal ogive metric)</p>
</td></tr>       
<tr><td><code id="gen4PMData_+3A_seed">seed</code></td>
<td>
<p>Optional seed for the random number generator.</p>
</td></tr>
<tr><td><code id="gen4PMData_+3A_theta">theta</code></td>
<td>
<p>Optional vector of latent trait scores. If theta = NULL (the default value) then gen4PMData will simulate
theta from a normal distribution.</p>
</td></tr>
<tr><td><code id="gen4PMData_+3A_thetamn">thetaMN</code></td>
<td>
<p>Mean of simulated theta distribution. Default = 0.</p>
</td></tr>
<tr><td><code id="gen4PMData_+3A_thetavar">thetaVar</code></td>
<td>
<p>Variance of simulated theta distribution. Default = 1</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>data</code></td>
<td>
<p>N(subject)-by-p(items) matrix of item response data.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>Latent trait scores.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>Value of the random number seed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niels Waller</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Generate simulated 4PM data for 2,000 subjects
# 4PM Item parameters from MMPI-A CYN scale

Params&lt;-matrix(c(1.41, -0.79, .01, .98, #1  
                 1.19, -0.81, .02, .96, #2 
                 0.79, -1.11, .05, .94, #3
                 0.94, -0.53, .02, .93, #4
                 0.90, -1.02, .04, .95, #5
                 1.00, -0.21, .02, .84, #6
                 1.05, -0.27, .02, .97, #7
                 0.90, -0.75, .04, .73, #8  
                 0.80, -1.42, .06, .98, #9
                 0.71,  0.13, .05, .94, #10
                 1.01, -0.14, .02, .81, #11
                 0.63,  0.18, .18, .97, #12
                 0.68,  0.18, .02, .87, #13
                 0.60, -0.14, .09, .96, #14
                 0.85, -0.71, .04, .99, #15
                 0.83, -0.07, .05, .97, #16
                 0.86, -0.36, .03, .95, #17
                 0.66, -0.64, .04, .77, #18
                 0.60,  0.52, .04, .94, #19
                 0.90, -0.06, .02, .96, #20
                 0.62, -0.47, .05, .86, #21
                 0.57,  0.13, .06, .93, #22
                 0.77, -0.43, .04, .97),23,4, byrow=TRUE) 

 data &lt;- gen4PMData(NSubj=2000, abcdParams = Params, D = 1.702,  
                    seed = 123, thetaMN = 0, thetaVar = 1)$data
 
 cat("\nClassical item difficulties for simulated data")                   
 print( round( apply(data,2,mean),2) )
</code></pre>

<hr>
<h2 id='genFMPData'>Generate item response data for a filtered monotonic polynomial IRT model</h2><span id='topic+genFMPData'></span>

<h3>Description</h3>

<p>Generate item response data for the filtered polynomial IRT model.</p>


<h3>Usage</h3>

<pre><code class='language-R'> genFMPData(NSubj, bParams, theta = NULL, thetaMN = 0, thetaVar = 1, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genFMPData_+3A_nsubj">NSubj</code></td>
<td>
<p>the desired number of subject response vectors.</p>
</td></tr>
<tr><td><code id="genFMPData_+3A_bparams">bParams</code></td>
<td>
<p>a p(items)-by-9 matrix of polynomial coefficients and model designations. Columns 1 - 8 hold the polynomial coefficients; column 9 holds the value of <code>k</code>.</p>
</td></tr>
<tr><td><code id="genFMPData_+3A_theta">theta</code></td>
<td>
<p>A user-supplied vector of latent trait scores. Default theta = NULL.</p>
</td></tr>
<tr><td><code id="genFMPData_+3A_thetamn">thetaMN</code></td>
<td>
<p>If theta = NULL genFMPdata will simulate random normal deviates from a 
population with mean thetaMN and variance thetaVar.</p>
</td></tr>
<tr><td><code id="genFMPData_+3A_thetavar">thetaVar</code></td>
<td>
<p>If theta = NULL genFMPData will simulate random normal deviates from a 
population with mean thetaMN and variance thetaVar.</p>
</td></tr>
<tr><td><code id="genFMPData_+3A_seed">seed</code></td>
<td>
<p>initial seed for the random number generator.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>theta</code></td>
<td>
<p>theta values used for data generation</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>N(subject)-by-p(items) matrix of item response data.</p>
</td></tr>
<tr><td><code>seed</code></td>
<td>
<p>Value of the random number seed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niels Waller</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# The following code illustrates data generation for 
# an FMP of order 3 (i.e., 2k+1)

# data will be generated for 2000 examinees
NSubjects &lt;- 2000


## Example item paramters, k=1 FMP 
b &lt;- matrix(c(
    #b0    b1     b2    b3      b4   b5 b6 b7  k
  1.675, 1.974, -0.068, 0.053,  0,  0,  0,  0, 1,
  1.550, 1.805, -0.230, 0.032,  0,  0,  0,  0, 1,
  1.282, 1.063, -0.103, 0.003,  0,  0,  0,  0, 1,
  0.704, 1.376, -0.107, 0.040,  0,  0,  0,  0, 1,
  1.417, 1.413,  0.021, 0.000,  0,  0,  0,  0, 1,
 -0.008, 1.349, -0.195, 0.144,  0,  0,  0,  0, 1,
  0.512, 1.538, -0.089, 0.082,  0,  0,  0,  0, 1,
  0.122, 0.601, -0.082, 0.119,  0,  0,  0,  0, 1,
  1.801, 1.211,  0.015, 0.000,  0,  0,  0,  0, 1,
 -0.207, 1.191,  0.066, 0.033,  0,  0,  0,  0, 1,
 -0.215, 1.291, -0.087, 0.029,  0,  0,  0,  0, 1,
  0.259, 0.875,  0.177, 0.072,  0,  0,  0,  0, 1,
 -0.423, 0.942,  0.064, 0.094,  0,  0,  0,  0, 1,
  0.113, 0.795,  0.124, 0.110,  0,  0,  0,  0, 1,
  1.030, 1.525,  0.200, 0.076,  0,  0,  0,  0, 1,
  0.140, 1.209,  0.082, 0.148,  0,  0,  0,  0, 1,
  0.429, 1.480, -0.008, 0.061,  0,  0,  0,  0, 1,
  0.089, 0.785, -0.065, 0.018,  0,  0,  0,  0, 1,
 -0.516, 1.013,  0.016, 0.023,  0,  0,  0,  0, 1,
  0.143, 1.315, -0.011, 0.136,  0,  0,  0,  0, 1,
  0.347, 0.733, -0.121, 0.041,  0,  0,  0,  0, 1,
 -0.074, 0.869,  0.013, 0.026,  0,  0,  0,  0, 1,
  0.630, 1.484, -0.001, 0.000,  0,  0,  0,  0, 1), 
  nrow=23, ncol=9, byrow=TRUE)  

# generate data using the above item paramters
data&lt;-genFMPData(NSubj = NSubjects, bParams=b, seed=345)$data
</code></pre>

<hr>
<h2 id='irf'>Plot item response functions for polynomial IRT models.</h2><span id='topic+irf'></span>

<h3>Description</h3>

<p>Plot model-implied (and possibly empirical) item response function for polynomial IRT models.</p>


<h3>Usage</h3>

<pre><code class='language-R'> irf(data, bParams, item, plotERF = TRUE, thetaEAP = NULL, 
                 minCut = -3, maxCut = 3, NCuts = 9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="irf_+3A_data">data</code></td>
<td>
<p>N(subjects)-by-p(items) matrix of 0/1 item response data.</p>
</td></tr>
<tr><td><code id="irf_+3A_bparams">bParams</code></td>
<td>
<p>p(items)-by-9 matrix.  The first 8 columns of the matrix should contain the FMP or FUP polynomial 
coefficients for the p items.  The 9th column contains the value of k for each item (where the item specific 
order of the polynomial is 2k+1).</p>
</td></tr>
<tr><td><code id="irf_+3A_item">item</code></td>
<td>
<p>The IRF for <code>item</code> will be plotted.</p>
</td></tr>
<tr><td><code id="irf_+3A_ploterf">plotERF</code></td>
<td>
<p>A logical that determines whether to plot discrete values of the empirical response function.</p>
</td></tr>
<tr><td><code id="irf_+3A_thetaeap">thetaEAP</code></td>
<td>
<p>If <code>plotERF=TRUE</code>, the user must supply previously calculated eap trait estimates to <code>thetaEAP</code>.</p>
</td></tr>
<tr><td><code id="irf_+3A_mincut">minCut</code>, <code id="irf_+3A_maxcut">maxCut</code></td>
<td>
<p>If <code>plotERF=TRUE</code>, the program will (attempt to) plot <code>NCuts</code> points of the 
empirical response function between trait values of <code>minCut</code> and <code>maxCut</code> Default minCut = -3. Default maxCut = 3.</p>
</td></tr>
<tr><td><code id="irf_+3A_ncuts">NCuts</code></td>
<td>
<p>Desired number of bins for the empirical response function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niels Waller</p>


<h3>Examples</h3>

<pre><code class='language-R'>NSubjects &lt;- 2000
NItems &lt;- 15

itmParameters &lt;- matrix(c(
 #  b0    b1     b2    b3    b4  b5,    b6,  b7,  k
 -1.05, 1.63,  0.00, 0.00, 0.00,  0,     0,  0,   0, #1
 -1.97, 1.75,  0.00, 0.00, 0.00,  0,     0,  0,   0, #2
 -1.77, 1.82,  0.00, 0.00, 0.00,  0,     0,  0,   0, #3
 -4.76, 2.67,  0.00, 0.00, 0.00,  0,     0,  0,   0, #4
 -2.15, 1.93,  0.00, 0.00, 0.00,  0,     0,  0,   0, #5
 -1.25, 1.17, -0.25, 0.12, 0.00,  0,     0,  0,   1, #6
  1.65, 0.01,  0.02, 0.03, 0.00,  0,     0,  0,   1, #7
 -2.99, 1.64,  0.17, 0.03, 0.00,  0,     0,  0,   1, #8
 -3.22, 2.40, -0.12, 0.10, 0.00,  0,     0,  0,   1, #9
 -0.75, 1.09, -0.39, 0.31, 0.00,  0,     0,  0,   1, #10
 -1.21, 9.07,  1.20,-0.01,-0.01,  0.01,  0,  0,   2, #11
 -1.92, 1.55, -0.17, 0.50,-0.01,  0.01,  0,  0,   2, #12
 -1.76, 1.29, -0.13, 1.60,-0.01,  0.01,  0,  0,   2, #13
 -2.32, 1.40,  0.55, 0.05,-0.01,  0.01,  0,  0,   2, #14
 -1.24, 2.48, -0.65, 0.60,-0.01,  0.01,  0,  0,   2),#15
 15, 9, byrow=TRUE)
 
  
ex1.data&lt;-genFMPData(NSubj = NSubjects, bParams = itmParameters, 
                     seed = 345)$data

## compute initial theta surrogates
thetaInit &lt;- svdNorm(ex1.data)

## For convenience we assume that the item parameter
## estimates equal their population values.  In practice,
## item parameters would be estimated at this step. 
itmEstimates &lt;- itmParameters

## calculate eap estimates for mixed models
thetaEAP &lt;- eap(data = ex1.data, bParams = itmEstimates, NQuad = 21, 
                priorVar = 2, 
                mintheta = -4, maxtheta = 4)

## plot irf and erf for item 1
irf(data = ex1.data, bParams = itmEstimates, 
    item = 1, 
    plotERF = TRUE, 
    thetaEAP)

## plot irf and erf for item 12
irf(data = ex1.data, bParams = itmEstimates, 
    item = 12, 
    plotERF = TRUE, 
    thetaEAP)  

</code></pre>

<hr>
<h2 id='restScore'>Plot an ERF using rest scores</h2><span id='topic+restScore'></span>

<h3>Description</h3>

<p>Plot an empirical response function using rest scores.</p>


<h3>Usage</h3>

<pre><code class='language-R'> restScore(data, item, NCuts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="restScore_+3A_data">data</code></td>
<td>
<p>N(subjects)-by-p(items) matrix of 0/1 item response data.</p>
</td></tr>
<tr><td><code id="restScore_+3A_item">item</code></td>
<td>
<p>Generate a rest score plot for item <code>item</code>.</p>
</td></tr>
<tr><td><code id="restScore_+3A_ncuts">NCuts</code></td>
<td>
<p>Divide the rest scores into <code>NCuts</code> bins of equal width.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A restscore plot with 95% confidence interval bars for the conditional probability estimates.
</p>
<table>
<tr><td><code>item</code></td>
<td>
<p>The item number.</p>
</td></tr>
<tr><td><code>bins</code></td>
<td>
<p>A vector of bin limits and bin sample sizes.</p>
</td></tr>
<tr><td><code>binProb</code></td>
<td>
<p>A vector of bin conditional probabilities.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niels Waller</p>


<h3>Examples</h3>

<pre><code class='language-R'>NSubj &lt;- 2000

#generate sample k=1 FMP  data
b &lt;- matrix(c(
    #b0    b1     b2    b3      b4   b5 b6 b7  k
  1.675, 1.974, -0.068, 0.053,  0,  0,  0,  0, 1,
  1.550, 1.805, -0.230, 0.032,  0,  0,  0,  0, 1,
  1.282, 1.063, -0.103, 0.003,  0,  0,  0,  0, 1,
  0.704, 1.376, -0.107, 0.040,  0,  0,  0,  0, 1,
  1.417, 1.413,  0.021, 0.000,  0,  0,  0,  0, 1,
 -0.008, 1.349, -0.195, 0.144,  0,  0,  0,  0, 1,
  0.512, 1.538, -0.089, 0.082,  0,  0,  0,  0, 1,
  0.122, 0.601, -0.082, 0.119,  0,  0,  0,  0, 1,
  1.801, 1.211,  0.015, 0.000,  0,  0,  0,  0, 1,
 -0.207, 1.191,  0.066, 0.033,  0,  0,  0,  0, 1,
 -0.215, 1.291, -0.087, 0.029,  0,  0,  0,  0, 1,
  0.259, 0.875,  0.177, 0.072,  0,  0,  0,  0, 1,
 -0.423, 0.942,  0.064, 0.094,  0,  0,  0,  0, 1,
  0.113, 0.795,  0.124, 0.110,  0,  0,  0,  0, 1,
  1.030, 1.525,  0.200, 0.076,  0,  0,  0,  0, 1,
  0.140, 1.209,  0.082, 0.148,  0,  0,  0,  0, 1,
  0.429, 1.480, -0.008, 0.061,  0,  0,  0,  0, 1,
  0.089, 0.785, -0.065, 0.018,  0,  0,  0,  0, 1,
 -0.516, 1.013,  0.016, 0.023,  0,  0,  0,  0, 1,
  0.143, 1.315, -0.011, 0.136,  0,  0,  0,  0, 1,
  0.347, 0.733, -0.121, 0.041,  0,  0,  0,  0, 1,
 -0.074, 0.869,  0.013, 0.026,  0,  0,  0,  0, 1,
  0.630, 1.484, -0.001, 0.000,  0,  0,  0,  0, 1), 
  nrow=23, ncol=9, byrow=TRUE)  
  
data&lt;-genFMPData(NSubj = NSubj, bParam = b, seed = 345)$data

## generate a rest score plot for item 12.
## the grey horizontal lines in the plot
## respresent pseudo asymptotes that
## are significantly different from the 
## (0,1) boundaries
restScore(data, item = 12, NCuts = 9)
</code></pre>

<hr>
<h2 id='svdNorm'>Compute theta surrogates via normalized SVD scores</h2><span id='topic+svdNorm'></span>

<h3>Description</h3>

<p>Compute theta surrogates by calculating the normalized left singular vector of a (mean-centered) data matrix.</p>


<h3>Usage</h3>

<pre><code class='language-R'> svdNorm(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="svdNorm_+3A_data">data</code></td>
<td>
<p>N(subjects)-by-p(items) matrix of 0/1 item response data.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>the normalized left singular vector of the mean centered data matrix.</code></td>
<td>
<p><code>svdNorm</code> will center the data automatically.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Niels Waller</p>


<h3>Examples</h3>

<pre><code class='language-R'>NSubj &lt;- 2000

## example item parameters for sample data: k=1 FMP 
b &lt;- matrix(c(
    #b0    b1     b2    b3      b4   b5 b6 b7  k
  1.675, 1.974, -0.068, 0.053,  0,  0,  0,  0, 1,
  1.550, 1.805, -0.230, 0.032,  0,  0,  0,  0, 1,
  1.282, 1.063, -0.103, 0.003,  0,  0,  0,  0, 1,
  0.704, 1.376, -0.107, 0.040,  0,  0,  0,  0, 1,
  1.417, 1.413,  0.021, 0.000,  0,  0,  0,  0, 1,
 -0.008, 1.349, -0.195, 0.144,  0,  0,  0,  0, 1,
  0.512, 1.538, -0.089, 0.082,  0,  0,  0,  0, 1,
  0.122, 0.601, -0.082, 0.119,  0,  0,  0,  0, 1,
  1.801, 1.211,  0.015, 0.000,  0,  0,  0,  0, 1,
 -0.207, 1.191,  0.066, 0.033,  0,  0,  0,  0, 1,
 -0.215, 1.291, -0.087, 0.029,  0,  0,  0,  0, 1,
  0.259, 0.875,  0.177, 0.072,  0,  0,  0,  0, 1,
 -0.423, 0.942,  0.064, 0.094,  0,  0,  0,  0, 1,
  0.113, 0.795,  0.124, 0.110,  0,  0,  0,  0, 1,
  1.030, 1.525,  0.200, 0.076,  0,  0,  0,  0, 1,
  0.140, 1.209,  0.082, 0.148,  0,  0,  0,  0, 1,
  0.429, 1.480, -0.008, 0.061,  0,  0,  0,  0, 1,
  0.089, 0.785, -0.065, 0.018,  0,  0,  0,  0, 1,
 -0.516, 1.013,  0.016, 0.023,  0,  0,  0,  0, 1,
  0.143, 1.315, -0.011, 0.136,  0,  0,  0,  0, 1,
  0.347, 0.733, -0.121, 0.041,  0,  0,  0,  0, 1,
 -0.074, 0.869,  0.013, 0.026,  0,  0,  0,  0, 1,
  0.630, 1.484, -0.001, 0.000,  0,  0,  0,  0, 1), 
  nrow=23, ncol=9, byrow=TRUE)  
 
# generate data using the above item paramters
data&lt;-genFMPData(NSubj=NSubj, bParam=b, seed=345)$data

# compute (initial) surrogate theta values from 
# the normed left singular vector of the centered 
# data matrix
thetaInit&lt;-svdNorm(data)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
