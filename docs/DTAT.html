<!DOCTYPE html><html><head><title>Help for package DTAT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DTAT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as_d3_data,DE-method'><p>Convert a DE object to JSON</p></a></li>
<li><a href='#DE-class'><p>An S4 class for simulating dose-titration study designs</p></a></li>
<li><a href='#de.bioRxiv.240846'><p>Simulated &lsquo;3+3/PC&rsquo; dose-titration study from bioRxiv paper no. 240846</p></a></li>
<li><a href='#dose.survfit'><p>Calculate a dose-survival curve from a dose titration study, adding a</p>
confidence band</a></li>
<li><a href='#dose.survival'><p>Extract interval-censored dose tolerance data from a dose titration study</p></a></li>
<li><a href='#ds.curve'><p>Extract the dose-survival curve, with its upper and lower confidence band</p>
limits</a></li>
<li><a href='#DTAT-package'><p>Dose Titration Algorithm Tuning: a Framework for Dose Individualization</p>
in Drug Development</a></li>
<li><a href='#dtat1000'><p>Precomputed neutrophil-guided chemotherapy dose titration for 1000 simulated</p>
subjects.</a></li>
<li><a href='#newton.raphson'><p>A dose titration algorithm (DTA) 'factory' based on the Newton-Raphson</p>
heuristic</a></li>
<li><a href='#Onoue.Friberg'><p>POMP PK/PD model for docetaxel, combining Onoue et al (2016) with Friberg et</p>
al (2002)</a></li>
<li><a href='#plot,DE,missing-method'><p>Plot a DE object as an interactive htmlwidget</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#runDTATapp'><p>Run Shiny apps included in package DTAT</p></a></li>
<li><a href='#scaled'><p>Power-law scaling for doses</p></a></li>
<li><a href='#seq.function'><p>A seq method supporting custom-scaled plot axes.</p></a></li>
<li><a href='#sim'><p>Environment for simulation global variables.</p></a></li>
<li><a href='#titrate'><p>Perform neutrophil-guided dose titration of a chemotherapy drug.</p></a></li>
<li><a href='#titration'><p>Simulate a &lsquo;3+3/PC&rsquo; dose-titration trial</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Dose Titration Algorithm Tuning</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-29</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David C. Norris &lt;david@precisionmethods.guru&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), survival</td>
</tr>
<tr>
<td>Imports:</td>
<td>km.ci, pomp, Hmisc, data.table, dplyr, r2d3, shiny, jsonlite,
methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, lattice, latticeExtra, widgetframe, tidyr,
RColorBrewer, invgamma, zipfR, rms</td>
</tr>
<tr>
<td>Description:</td>
<td>Dose Titration Algorithm Tuning (DTAT) is a methodologic framework
             allowing dose individualization to be conceived as a continuous
             learning process that begins in early-phase clinical trials and
             continues throughout drug development, on into clinical practice.
             This package includes code that researchers may use to reproduce
             or extend key results of the DTAT research programme, plus tools
             for trialists to design and simulate a '3+3/PC' dose-finding study.
             Please see Norris (2017a) &lt;<a href="https://doi.org/10.12688%2Ff1000research.10624.3">doi:10.12688/f1000research.10624.3</a>&gt; and
             Norris (2017c) &lt;<a href="https://doi.org/10.1101%2F240846">doi:10.1101/240846</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://precisionmethods.guru/">https://precisionmethods.guru/</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>David C. Norris [aut, cre]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-29 19:09:10 UTC; david</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-29 19:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as_d3_data+2CDE-method'>Convert a DE object to JSON</h2><span id='topic+as_d3_data+2CDE-method'></span>

<h3>Description</h3>

<p>Convert a DE object to JSON
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'DE'
as_d3_data(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_d3_data+2B2CDE-method_+3A_x">x</code></td>
<td>
<p>An object of class <code>DE</code></p>
</td></tr>
<tr><td><code id="as_d3_data+2B2CDE-method_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
</table>

<hr>
<h2 id='DE-class'>An S4 class for simulating dose-titration study designs</h2><span id='topic+DE-class'></span>

<h3>Description</h3>

<p>An S4 class for simulating dose-titration study designs
</p>


<h3>Slots</h3>


<dl>
<dt><code>doses</code></dt><dd><p>A numeric vector of prospectively-determined discrete doses to
trial.</p>
</dd>
<dt><code>units</code></dt><dd><p>A string indicating dose units, e.g. <code>"mg/kg"</code>.</p>
</dd>
<dt><code>MTDi</code></dt><dd><p>A numeric vector of optimal doses for simulated study
participants. Optionally a call to an <code style="white-space: pre;">&#8288;r&lt;distribution&gt;(...)&#8288;</code> function which
may be parsed to calculate the <code>mtd_quantiles</code> slot.</p>
</dd>
<dt><code>mtd_quantiles</code></dt><dd><p>A numeric vector of quantiles of the distribution from
which the MTDi slot was simulated. Intended mainly to support visualization
of this distribution, e.g. as an transparent overlay on the dose-survival
plot. NULL in case <code>MTDi</code> is provided verbatim.</p>
</dd>
<dt><code>fractol</code></dt><dd><p>A numeric vector of probabilities for the simulated MTDi slot.
Intended mainly to support visualization, e.g. plotting of 'MTD pointers'
on the interactive dose-survival plot.</p>
</dd>
<dt><code>data</code></dt><dd><p>A data.frame with columns:
</p>

<ul>
<li> <p><code>id</code> Participant identifier
</p>
</li>
<li> <p><code>period</code> DLT assessment period, numbered consecutively from 1
</p>
</li>
<li> <p><code>dose</code> Dose level, numbered consecutively starting from 1
</p>
</li>
<li> <p><code>dlt</code> A logical indicator: did this this participant experience
a DLT during this period?
</p>
</li></ul>
</dd>
<dt><code>stop_esc</code></dt><dd><p>integer Period in which &lsquo;stop rule&rsquo; was triggered</p>
</dd>
<dt><code>ds_conf_level</code></dt><dd><p>numeric Confidence level for confidence band around
Kaplan-Meier estimate of the dose-survival curve.</p>
</dd>
<dt><code>dose_drop_threshold</code></dt><dd><p>numeric Threshold for triggering the &lsquo;bypass rule&rsquo;.</p>
</dd>
<dt><code>stop_esc_under</code></dt><dd><p>numeric Threshold for triggering the &lsquo;stop rule&rsquo;.</p>
</dd>
<dt><code>undo_esc_under</code></dt><dd><p>numeric Threshold for triggering the &lsquo;rollback rule&rsquo;.</p>
</dd>
</dl>

<hr>
<h2 id='de.bioRxiv.240846'>Simulated &lsquo;3+3/PC&rsquo; dose-titration study from bioRxiv paper no. 240846</h2><span id='topic+de.bioRxiv.240846'></span>

<h3>Description</h3>

<p>This is a length-10 list of data frames, summarizing the simulated trial
from this paper, at the end of periods 1, 2, ..., 10. This structure reflects
an awkward S3 implementation that package DTAT v0.3 reimplemented using S4.
This data set is retained to support regression tests.
</p>


<h3>Format</h3>

<p>A length-10 list of data frames, each with the following columns:
</p>

<dl>
<dt>id</dt><dd><p>Participant identifier</p>
</dd>
<dt>period</dt><dd><p>DLT assessment period, numbered consecutively from 1</p>
</dd>
<dt>dose</dt><dd><p>Dose level, numbered consecutively starting from 1</p>
</dd>
<dt>dlt</dt><dd><p>A logical indicator: did this this participant experience
a DLT during this period?</p>
</dd>
</dl>



<h3>Details</h3>

<p>A <code>stop.esc</code> attribute is attached to data frames in this list,
indicating when escalation stopped during the simulated trial.
</p>


<h3>References</h3>

<p>Norris DC. Precautionary Coherence Unravels Dose Escalation
Designs. <em>bioRxiv</em>. December 2017:240846. <a href="https://doi.org/10.1101/240846">doi:10.1101/240846</a>.
<a href="https://www.biorxiv.org/content/10.1101/240846v1">https://www.biorxiv.org/content/10.1101/240846v1</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(de.bioRxiv.240846)
# Demonstrate that the new S4 3+3/PC implementation reproduces the
# simulated trial from the paper:
set.seed(2017)
CV &lt;- 0.7; mean_mtd &lt;- 1.0
shape &lt;- CV^-2; scale &lt;- mean_mtd/shape
trial &lt;- new("DE", doses=0.25 * 1.4^(0:6),
             MTDi=rgamma(24, shape=shape, scale=scale),
             units="mg")
trial &lt;- titration(trial, periods=10)
stopifnot(all(trial@data == de.bioRxiv.240846[[10]]))
stopifnot(trial@stop_esc == attr(de.bioRxiv.240846[[10]],'stop.esc'))

</code></pre>

<hr>
<h2 id='dose.survfit'>Calculate a dose-survival curve from a dose titration study, adding a
confidence band</h2><span id='topic+dose.survfit'></span>

<h3>Description</h3>

<p>The 'dose-survival curve' is nothing other than an empirical cumulative
distribution for MTDi in the sampled population. The term 'survival' is
suggested in part by our application of the Kaplan-Meier estimator to
interval-censored toxicity information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dose.survfit(de, method = "rothman", avoid.degeneracy = TRUE, conf.level = 0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dose.survfit_+3A_de">de</code></td>
<td>
<p>A dose titration experiment like the <code>data</code> slot of class
<code><a href="#topic+DE-class">DE</a></code></p>
</td></tr>
<tr><td><code id="dose.survfit_+3A_method">method</code></td>
<td>
<p>The method to be used by <code><a href="km.ci.html#topic+km.ci">km.ci</a></code> when
calculating CI</p>
</td></tr>
<tr><td><code id="dose.survfit_+3A_avoid.degeneracy">avoid.degeneracy</code></td>
<td>
<p>When TRUE, this parameter directs the function to
introduce artificial events into the dose titration experiment, to avoid
degeneracies at the lower and upper ends of the dose-survival curve.</p>
</td></tr>
<tr><td><code id="dose.survfit_+3A_conf.level">conf.level</code></td>
<td>
<p>Confidence level for KM confidence band.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>TODO: Describe details of degeneracy avoidance, once these have stabilized.
</p>


<h3>Value</h3>

<p>An object of class <code>survfit</code>.
</p>


<h3>Author(s)</h3>

<p>David C. Norris
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dose.survival">dose.survival</a></code>, <code><a href="km.ci.html#topic+km.ci">km.ci</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CV &lt;- 0.7; mean_mtd &lt;- 1.0
shape &lt;- CV^-2; scale &lt;- mean_mtd/shape
trial &lt;- new("DE", doses=0.25 * 1.4^(0:6),
             MTDi=rgamma(24, shape=shape, scale=scale),
             units="mg")
trial &lt;- titration(trial, periods=10)
sf &lt;- dose.survfit(trial@data)
summary(sf)

</code></pre>

<hr>
<h2 id='dose.survival'>Extract interval-censored dose tolerance data from a dose titration study</h2><span id='topic+dose.survival'></span>

<h3>Description</h3>

<p>Constructs a <code><a href="survival.html#topic+Surv">Surv</a></code> object from a dose-escalation
experiment, using interval-censoring constructs of <code>type='interval2'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dose.survival(de)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dose.survival_+3A_de">de</code></td>
<td>
<p>A data frame describing a dose-titration study</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>Surv</code> object of type='interval2'
</p>


<h3>Author(s)</h3>

<p>David C. Norris
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dose.survfit">dose.survfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CV &lt;- 0.7; mean_mtd &lt;- 1.0
shape &lt;- CV^-2; scale &lt;- mean_mtd/shape
trial &lt;- new("DE", doses=0.25 * 1.4^(0:6),
             MTDi=rgamma(24, shape=shape, scale=scale),
             units="mg")
trial &lt;- titration(trial, periods=10)
dose.survival(trial@data)

</code></pre>

<hr>
<h2 id='ds.curve'>Extract the dose-survival curve, with its upper and lower confidence band
limits</h2><span id='topic+ds.curve'></span>

<h3>Description</h3>

<p>This utility function simply makes the results of <code>dose.survfit</code>
available in the convenient form of a list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ds.curve(de, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ds.curve_+3A_de">de</code></td>
<td>
<p>A data frame describing a dose-titration study.</p>
</td></tr>
<tr><td><code id="ds.curve_+3A_...">...</code></td>
<td>
<p>Passed through to function <code>dose.survfit</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components <code>surv</code>, <code>upper</code> and <code>lower</code>,
each containing a vector that can be indexed by dose level.
</p>


<h3>Author(s)</h3>

<p>David C. Norris
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dose.survfit">dose.survfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CV &lt;- 0.7; mean_mtd &lt;- 1.0
shape &lt;- CV^-2; scale &lt;- mean_mtd/shape
trial &lt;- new("DE", doses=0.25 * 1.4^(0:6),
             MTDi=rgamma(24, shape=shape, scale=scale),
             units="mg")
trial &lt;- titration(trial, periods=10)
ds.curve(trial@data)

</code></pre>

<hr>
<h2 id='DTAT-package'>Dose Titration Algorithm Tuning: a Framework for Dose Individualization
in Drug Development</h2><span id='topic+DTAT-package'></span><span id='topic+DTAT'></span>

<h3>Description</h3>

<p>Dose Titration Algorithm Tuning (DTAT) is a methodologic framework
allowing dose individualization to be conceived as a continuous learning process
that begins in early-phase clinical trials and continues throughout drug development,
on into clinical practice.
This package includes code that researchers may use to reproduce or extend key results
of the DTAT research programme, plus tools for trialists to design and simulate a
'3+3/PC' dose-finding study. Please see Norris (2017a) <a href="https://doi.org/10.12688/f1000research.10624.3">doi:10.12688/f1000research.10624.3</a>
and Norris (2017c) <a href="https://doi.org/10.1101/240846">doi:10.1101/240846</a>.
</p>


<h3>Author(s)</h3>

<p>David C. Norris
</p>


<h3>References</h3>


<ol>
<li><p> Norris DC. Dose Titration Algorithm Tuning (DTAT) should supersede
&lsquo;the&rsquo; Maximum Tolerated Dose (MTD) in oncology dose-finding trials.
<em>F1000Research</em>. 2017;6:112. <a href="https://doi.org/10.12688/f1000research.10624.3">doi:10.12688/f1000research.10624.3</a>.
<a href="https://f1000research.com/articles/6-112/v3">https://f1000research.com/articles/6-112/v3</a>
</p>
</li>
<li><p> Norris DC. Costing &lsquo;the&rsquo; MTD. <em>bioRxiv</em>. August 2017:150821.
<a href="https://doi.org/10.1101/150821">doi:10.1101/150821</a>.
<a href="https://www.biorxiv.org/content/10.1101/150821v3">https://www.biorxiv.org/content/10.1101/150821v3</a>
</p>
</li>
<li><p> Norris DC. Precautionary Coherence Unravels Dose Escalation Designs.
<em>bioRxiv</em>. December 2017:240846. <a href="https://doi.org/10.1101/240846">doi:10.1101/240846</a>.
<a href="https://www.biorxiv.org/content/10.1101/240846v1">https://www.biorxiv.org/content/10.1101/240846v1</a>
</p>
</li>
<li><p> Norris DC. One-size-fits-all dosing in oncology wastes money, innovation
and lives. <em>Drug Discov Today</em>. 2018;23(1):4-6.
<a href="https://doi.org/10.1016/j.drudis.2017.11.008">doi:10.1016/j.drudis.2017.11.008</a>.
<a href="https://www.sciencedirect.com/science/article/pii/S1359644617303586">https://www.sciencedirect.com/science/article/pii/S1359644617303586</a>
</p>
</li>
<li><p> Norris DC. Costing &lsquo;the&rsquo; MTD ... in 2-D. <em>bioRxiv</em>. July 2018:370817.
<a href="https://doi.org/10.1101/370817">doi:10.1101/370817</a>.
<a href="https://www.biorxiv.org/content/10.1101/370817v1">https://www.biorxiv.org/content/10.1101/370817v1</a>
</p>
</li></ol>


<hr>
<h2 id='dtat1000'>Precomputed neutrophil-guided chemotherapy dose titration for 1000 simulated
subjects.</h2><span id='topic+dtat1000'></span>

<h3>Description</h3>

<p>This dataset is provided to support fast reproduction of a forthcoming
pharmacoeconomic paper that includes examination of the empirical
distribution of MTDi in N=1000 simulated subjects.
</p>


<h3>Format</h3>

<p>A data frame showing end-of-cycle state of neutrophil-guided dose
titration for 1000 simulated subjects, across 10 cycles of chemotherapy.
</p>

<dl>
<dt>cycle</dt><dd><p>Cycle number 1..10</p>
</dd>
<dt>id</dt><dd><p>Subject identifiers; an ordered factor with levels
<code>id1</code> &lt; ... &lt; <code>id1000</code></p>
</dd>
<dt>Cc</dt><dd><p>Central-compartment drug concentration</p>
</dd>
<dt>Cp</dt><dd><p>Peripheral-compartment drug concentration</p>
</dd>
<dt>Prol</dt><dd><p>Progenitor cells in proliferating compartment of
Friberg et al. (2002) model</p>
</dd>
<dt>Tx.1</dt><dd><p>Transit compartment 1</p>
</dd>
<dt>Tx.2</dt><dd><p>Transit compartment 1</p>
</dd>
<dt>Tx.3</dt><dd><p>Transit compartment 1</p>
</dd>
<dt>Circ</dt><dd><p>Concentration (cells/mm^3) of circulating neutrophils</p>
</dd>
<dt>dose</dt><dd><p>Dose of 1-hour infusion administered this cycle</p>
</dd>
<dt>CircMin</dt><dd><p>Neutrophil nadir (cells/mm^3)</p>
</dd>
<dt>tNadir</dt><dd><p>Time (days) of neutrophil nadir</p>
</dd>
<dt>scaled.dose</dt><dd><p>Fourth root of dose</p>
</dd>
<dt>time</dt><dd><p>Time (weeks) of dose administration</p>
</dd>
</dl>



<h3>Details</h3>

<p>Running the examples interactively, you can verify the reproducibility of
this dataset. (That demo is included in a <code>donttest</code> block to spare the
CRAN servers.)
</p>


<h3>References</h3>


<ol>
<li><p> Norris DC. Dose Titration Algorithm Tuning (DTAT) should
supersede &lsquo;the&rsquo; Maximum Tolerated Dose (MTD) in oncology dose-finding
trials. <em>F1000Research</em>. 2017;6:112. <a href="https://doi.org/10.12688/f1000research.10624.3">doi:10.12688/f1000research.10624.3</a>.
<a href="https://f1000research.com/articles/6-112/v3">https://f1000research.com/articles/6-112/v3</a>
</p>
</li>
<li><p> Norris DC. Costing &lsquo;the&rsquo; MTD. <em>bioRxiv</em>. August 2017:150821.
<a href="https://doi.org/10.1101/150821">doi:10.1101/150821</a>.
<a href="https://www.biorxiv.org/content/10.1101/150821v3">https://www.biorxiv.org/content/10.1101/150821v3</a>
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>
data(dtat1000)
# 1. Extract the N final doses, assuming convergence by the tenth course
MTD_i &lt;- with(dtat1000, dose[time==27])
MTD_i &lt;- MTD_i[MTD_i &lt; 5000] # Exclude few outliers
# 2. Do a kernel density plot
library(Hmisc)
library(latticeExtra)
hist &lt;- histogram(~MTD_i, breaks=c(0,100,200,300,400,600,900,1500,2500,4000,5000)
                  , xlab=expression(MTD[i]))
approx &lt;- data.frame(mtd_i=seq(0, 5000, 10))
approx &lt;- upData(approx,
                 gamma = dgamma(mtd_i, shape=1.75, scale=200))
dist &lt;- xyplot(gamma ~ mtd_i, data=approx, type='l', col='black', lwd=2)
library(grid)
hist + dist
grid.text(expression(MTD[i] %~%
                     paste("Gamma(", alpha==1.75, ", ", beta==1/200,")"))
         , x=unit(0.5,"npc")
         , y=unit(0.75,"npc")
         )
## A very long repro, which a user of this package may well wish to verify
## by running the examples interactively, although it takes many minutes
## to compute.  (Enclosed in a dontest block to avoid overburdening CRAN.)

# Demonstrate close reproduction of original titration (the titration takes many minutes!)
set.seed(2016)
library(pomp)
Onoue.Friberg(N=1000)
# This titration may take an hour to run ...
chemo &lt;- titrate(doserange = c(50, 3000),
                 dta=newton.raphson(dose1 = 100,
                                    omega = 0.75,
                                    slope1 = -2.0,
                                    slopeU = -0.2)
)

dtat1k &lt;- upData(chemo$course
                , time = 3*(cycle-1)
                , labels = c(time="Time")
                , units = c(time="weeks")
                , print = FALSE)

c10dose1k &lt;- subset(dtat1k, cycle==10)$scaled.dose
c10dose1000 &lt;- subset(dtat1000, cycle==10)$scaled.dose
stopifnot(0.999 &lt; cor(c10dose1k, c10dose1000))


</code></pre>

<hr>
<h2 id='newton.raphson'>A dose titration algorithm (DTA) 'factory' based on the Newton-Raphson
heuristic</h2><span id='topic+newton.raphson'></span>

<h3>Description</h3>

<p>This higher-order ('factory') function produces a simple dose titration
algorithm for neutrophil-guided chemotherapy dosing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newton.raphson(dose1, omega, slope1, slopeU)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="newton.raphson_+3A_dose1">dose1</code></td>
<td>
<p>The starting dose for titration</p>
</td></tr>
<tr><td><code id="newton.raphson_+3A_omega">omega</code></td>
<td>
<p>A relaxation parameter used to moderate dose increments</p>
</td></tr>
<tr><td><code id="newton.raphson_+3A_slope1">slope1</code></td>
<td>
<p>Dose-response slope assumed prior to 2nd measured neutrophil
nadir</p>
</td></tr>
<tr><td><code id="newton.raphson_+3A_slopeu">slopeU</code></td>
<td>
<p>Upper bound imposed on slope estimates</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function manifests the core concept of Dose Titration Algorithm Tuning
by delivering an objectively realized 'DTA'. It therefore enables a variety
of DTAs to be implemented and compared.
</p>


<h3>Value</h3>

<p>A dose titration function that advises dose for next cycle of
chemotherapy.
</p>


<h3>Author(s)</h3>

<p>David C. Norris
</p>


<h3>See Also</h3>

<p><code><a href="#topic+titrate">titrate</a></code>
</p>

<hr>
<h2 id='Onoue.Friberg'>POMP PK/PD model for docetaxel, combining Onoue et al (2016) with Friberg et
al (2002)</h2><span id='topic+Onoue.Friberg'></span>

<h3>Description</h3>

<p>This function produces a POMP model combining docetaxel pharmacokinetics
(PK) drawn from Table 2 of Onoue et al (2016) with myelosuppression dynamics
drawn from Friberg et al (2002). This model enables simulation of
neutrophil-guided dose titration of docetaxel, as done in Norris (2017).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Onoue.Friberg(
  N,
  cycle.length.days = 21,
  data = data.frame(time = c(seq(0, 1.95, 0.05), seq(2, cycle.length.days * 24, 1)), y =
    NA),
  delta.t = 0.1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Onoue.Friberg_+3A_n">N</code></td>
<td>
<p>Size of simulated population.</p>
</td></tr>
<tr><td><code id="Onoue.Friberg_+3A_cycle.length.days">cycle.length.days</code></td>
<td>
<p>Duration (in days) of chemotherapy cycle to be
simulated.</p>
</td></tr>
<tr><td><code id="Onoue.Friberg_+3A_data">data</code></td>
<td>
<p>Passed through as the <code>data</code> argument of the <code>pomp</code>
constructor.</p>
</td></tr>
<tr><td><code id="Onoue.Friberg_+3A_delta.t">delta.t</code></td>
<td>
<p>Time-step (in hours) of pomp's <code>euler</code> plug-in.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value is returned; rather, the function sets global variables
in package environment <code>DTAT::sim</code>.
</p>


<h3>Author(s)</h3>

<p>David C. Norris
</p>


<h3>References</h3>


<ol>
<li><p> Onoue H, Yano I, Tanaka A, Itohara K, Hanai A, Ishiguro H, et al.
Significant effect of age on docetaxel pharmacokinetics in Japanese
female breast cancer patients by using the population modeling approach.
<em>Eur J Clin Pharmacol</em>. 2016 Jun;72(6):703-10.
doi:10.1007/s00228-016-2031-3.
</p>
</li>
<li><p> Friberg LE, Henningsson A, Maas H, Nguyen L, Karlsson MO. Model of
chemotherapy-induced myelosuppression with parameter consistency across
drugs. <em>J Clin Oncol</em>. 2002 Dec 15;20(24):4713-21.
doi:10.1200/JCO.2002.02.140.
</p>
</li>
<li><p> Norris DC. Dose Titration Algorithm Tuning (DTAT) should supersede
&lsquo;the&rsquo; Maximum Tolerated Dose (MTD) in oncology dose-finding trials.
<em>F1000Research</em>. 2017;6:112. doi:10.12688/f1000research.10624.3.
<a href="https://f1000research.com/articles/6-112/v3">https://f1000research.com/articles/6-112/v3</a>
</p>
</li></ol>



<h3>See Also</h3>

<p><code>pomp</code>, <code><a href="#topic+sim">sim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Reproduce the sim$pkpd model and sim$pop population from reference #3:
library(pomp)
Onoue.Friberg(N=25)
sim$pop # NB: this differs from pop of original paper...

# Whereas the present version of Onoue.Friberg() draws simulated populations
# using pomp::rprior(), to reproduce the original F1000Research paper [3] we
# re-draw sim$pop as originally &amp; prosaically done (see https://osf.io/vwnqz/):
set.seed(2016)
N &lt;- 25
dtx.mm &lt;- 0.808 # molar mass (mg/µM) of docetaxel
sim$pop$Circ0 &lt;- rlnorm(N, meanlog=log(5050), sdlog=0.42) # units=cells/mm^3
sim$pop$MTT &lt;- rlnorm(N, meanlog=log(89.3), sdlog=0.16)  # mean transit time
sim$pop$gamma &lt;- rlnorm(N, meanlog=log(0.163), sdlog=0.039) # feedback factor
sim$pop$Emax &lt;- rlnorm(N, meanlog=log(83.9), sdlog=0.33)
sim$pop$EC50 &lt;- rlnorm(N, meanlog=log(7.17*dtx.mm), sdlog=0.50)
# PK params from 2-compartment docetaxel model of Onoue et al (2016)
sim$pop$CL &lt;- rlnorm(N, meanlog=log(32.6), sdlog=0.295)
sim$pop$Q  &lt;- rlnorm(N, meanlog=log(5.34), sdlog=0.551)
sim$pop$Vc &lt;- rlnorm(N, meanlog=log(5.77), sdlog=0.1) # Onoue gives no CV% for V1
sim$pop$Vp &lt;- rlnorm(N, meanlog=log(11.0), sdlog=0.598) # Called 'V2' in Onoue
sim$pop$kTR=4/sim$pop$MTT

# Now we run the sim$pkpd model, separately for each of N simultated individuals:
allout &lt;- data.frame() # accumulator for N individual ODE solutions
for (id in 1:sim$N) {
  out &lt;- trajectory(sim$pkpd,
                    params=c(sim$pop[sim$pop$id==id, -which(names(sim$pop) %in% c('id','MTT'))]
                             , sigma=0.05, dose=100, duration=1),
                    format="data.frame")
  # drop 'traj' and shift 'time' to first column
  out &lt;- out[,c('time',setdiff(colnames(out),c('time','traj')))]
  out$id &lt;- paste("id",id,sep="")
  allout &lt;- rbind(allout, out)
}

library(Hmisc)
allout &lt;- upData(allout
                 , id = ordered(id, levels=paste("id",1:sim$N,sep=""))
                 , units=c(Prol="cells/mm^3", Tx.1="cells/mm^3",
                           Tx.2="cells/mm^3", Tx.3="cells/mm^3",
                           Circ="cells/mm^3",
                           Cc="ng/mL", Cp="ng/mL",
                           time="hours"), print=FALSE)

library(tidyr)
cout &lt;- gather(allout, key="Series", value="Concentration"
, Cc, Cp
, factor_key = TRUE)

label(cout$Concentration) &lt;- "Drug Concentration"

# Figure 1 from reference [3]:
library(RColorBrewer)
xYplot(Concentration ~ time | id, group=Series
       , data=cout, subset=time&lt;6
       , layout=c(5,NA)
       , type='l', as.table=TRUE
       , label.curves=FALSE
       , par.settings=list(superpose.line=list(lwd=2,col=brewer.pal(4,"PRGn")[c(1,4)]))
       , scales=list(y=list(log=TRUE, lim=c(10^-3,10^1)))
       , auto.key=list(points=FALSE, lines=TRUE, columns=2))

mout &lt;- gather(allout, key="Series", value="ANC"
, Prol, Tx.1, Tx.2, Tx.3, Circ
, factor_key = TRUE)

mout &lt;- upData(mout
               , time = time/24
               , units = c(time="days")
               , print = FALSE)

# Figure 3 from citation [3]:
xYplot(ANC ~ time | id, group=Series
       , data=mout
       , layout=c(5,5)
       , type='l', as.table=TRUE
       , label.curves=FALSE
       , par.settings=list(superpose.line=list(lwd=2,col=brewer.pal(11,"RdYlBu")[c(1,3,4,8,10)]))
       , scales=list(y=list(log=TRUE, lim=c(100,15000), at=c(200, 500, 1000, 2000, 5000, 10000)))
       , auto.key=list(points=FALSE, lines=TRUE, columns=5))

</code></pre>

<hr>
<h2 id='plot+2CDE+2Cmissing-method'>Plot a DE object as an interactive htmlwidget</h2><span id='topic+plot+2CDE+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plot a DE object as an interactive htmlwidget
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'DE,missing'
plot(x, y, ..., devtree = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B2CDE+2B2Cmissing-method_+3A_x">x</code></td>
<td>
<p>An object of class <code>DE</code></p>
</td></tr>
<tr><td><code id="plot+2B2CDE+2B2Cmissing-method_+3A_y">y</code></td>
<td>
<p>Unused; included for S4 generic consistency</p>
</td></tr>
<tr><td><code id="plot+2B2CDE+2B2Cmissing-method_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="r2d3.html#topic+r2d3">r2d3</a></code>, enabling caller to (e.g.) the
override the default <code>viewer = "internal"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B2CDE+2B2Cmissing-method_+3A_devtree">devtree</code></td>
<td>
<p>Logical indicator used to select local package dir</p>
</td></tr>
</table>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+as_d3_data'></span>

<h3>Description</h3>

<p>These objects are imported from other packages.
Follow the links below to see their documentation.
</p>

<ul>
<li><p> r2d3 <code><a href="r2d3.html#topic+as_d3_data">as_d3_data</a></code>
</p>
</li></ul>


<hr>
<h2 id='runDTATapp'>Run Shiny apps included in package DTAT</h2><span id='topic+runDTATapp'></span>

<h3>Description</h3>

<p>Run Shiny apps included in package DTAT
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runDTATapp(app)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runDTATapp_+3A_app">app</code></td>
<td>
<p>Character vector of length 1. Name of app to run.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invoked for side effect. Runs the named Shiny app.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
runDTATapp("Sim33PC")
runDTATapp("TheCost")
}
</code></pre>

<hr>
<h2 id='scaled'>Power-law scaling for doses</h2><span id='topic+scaled'></span>

<h3>Description</h3>

<p>Implement an inverse power-law scaling for drug dose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaled(dose, a = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scaled_+3A_dose">dose</code></td>
<td>
<p>A numeric vector of doses</p>
</td></tr>
<tr><td><code id="scaled_+3A_a">a</code></td>
<td>
<p>A numeric exponent for power-law rescaling</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A rescaled vector of doses
</p>


<h3>Author(s)</h3>

<p>David C. Norris
</p>

<hr>
<h2 id='seq.function'>A seq method supporting custom-scaled plot axes.</h2><span id='topic+seq.function'></span>

<h3>Description</h3>

<p>This provides a <code>seq</code> method for class <code>function</code>, supporting a
natural axis scaling idiom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class ''function''
seq(scalefun, from, to, length.out, digits = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seq.function_+3A_scalefun">scalefun</code></td>
<td>
<p>A numeric function that will be invoked componentwise, and
so need not be vectorized)</p>
</td></tr>
<tr><td><code id="seq.function_+3A_from">from</code>, <code id="seq.function_+3A_to">to</code></td>
<td>
<p>The starting and ending values of the sequence returned</p>
</td></tr>
<tr><td><code id="seq.function_+3A_length.out">length.out</code></td>
<td>
<p>Desired length of the sequence</p>
</td></tr>
<tr><td><code id="seq.function_+3A_digits">digits</code></td>
<td>
<p>If non-NULL, returned value is rounded accordingly</p>
</td></tr>
<tr><td><code id="seq.function_+3A_...">...</code></td>
<td>
<p>Unused; included for S3 generic/method consistency.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector that (not considering the effect of any rounding
applied), becomes an arithmetic sequence after application of
<code>scalefun</code> to it. The initial and final elements of that vector are
<code>from</code> and <code>to</code>.
</p>


<h3>Author(s)</h3>

<p>David C. Norris
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Provide evenly-spaced length-6 sequence from 100 to 1000,
# evenly spaced on a fourth-root scale:
seq(function(dose, a=4.0) dose^(1/a), from=100, to=1000, length.out=6, digits=0)

</code></pre>

<hr>
<h2 id='sim'>Environment for simulation global variables.</h2><span id='topic+sim'></span>

<h3>Description</h3>

<p>To simplify the code of package DTAT, as well as client tasks, this exported
environment contains a handful of global variables useful for the
simulations.
</p>


<h3>Details</h3>

<p>Global variables maintained within environment <code>sim</code> are:
</p>

<ol>
<li> <p><code>pkpd</code>: The population PK/PD model to be simulated.
</p>
</li>
<li> <p><code>pop</code>: A sample drawn from the population model.
</p>
</li>
<li> <p><code>N</code>: Restricts simulation to first <code>N</code> subjects in
<code>pop</code>.
</p>
</li>
<li> <p><code>params.default</code>: Default parameters.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>
# Even when nrow(pop) is large, one may easily restrict
# time-consuming simulations to pop[1:N,], as follows:
sim$N &lt;- 25
# Now perform simulation work
## Not run: 
titrate(...)

## End(Not run)

</code></pre>

<hr>
<h2 id='titrate'>Perform neutrophil-guided dose titration of a chemotherapy drug.</h2><span id='topic+titrate'></span>

<h3>Description</h3>

<p>This is included in package DTAT mainly for archival purposes, with the aim
to document a reproduction of Figure 5 from the 2017 <em>F1000Research</em>
paper (referenced below), using a clearer and more general software design
than is found in the online code supplement available at https://osf.io/vwnqz/.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>titrate(draw.days = NULL, Ncycles = 10, doserange = c(50, 500), dta = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="titrate_+3A_draw.days">draw.days</code></td>
<td>
<p>Integer days on which ANC is to be measured</p>
</td></tr>
<tr><td><code id="titrate_+3A_ncycles">Ncycles</code></td>
<td>
<p>Number of chemo cycles through which to simulate titration</p>
</td></tr>
<tr><td><code id="titrate_+3A_doserange">doserange</code></td>
<td>
<p>Range of doses to consider</p>
</td></tr>
<tr><td><code id="titrate_+3A_dta">dta</code></td>
<td>
<p>A Dose Titration Algorithm (DTA) to drive the titration</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with 2 components:
</p>
<table>
<tr><td><code>course</code></td>
<td>
<p>A data frame containing cycle-wise measures
of each id's titration course</p>
</td></tr>
<tr><td><code>anc.ts</code></td>
<td>
<p>A data frame detailing high-frequency ANC measures for each id</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David C. Norris
</p>


<h3>References</h3>

<p>Norris DC. Dose Titration Algorithm Tuning (DTAT) should
supersede &lsquo;the&rsquo; Maximum Tolerated Dose (MTD) in oncology dose-finding
trials. <em>F1000Research</em>. 2017;6:112. doi:10.12688/f1000research.10624.3.
<a href="https://f1000research.com/articles/6-112/v3">https://f1000research.com/articles/6-112/v3</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
# Reproduce Figure 5 from the F1000Research paper (run time &gt; 10 s).
# 1. Set up sim$pop &amp; sim$pkpd by running the repro for Figures 1 &amp; 3:
example(topic="Onoue.Friberg", package="DTAT", ask=FALSE)
# 2. Do the neutrophil-nadir-guided dose titration:
chemo &lt;- titrate(doserange = c(50, 3000),
                 dta=newton.raphson(dose1 = 50,
                                    omega = 0.75,
                                    slope1 = -2.0,
                                    slopeU = -0.2)
                 )
library(latticeExtra)
newton &lt;- chemo$course
new.ts &lt;- chemo$anc.ts
anc.tics &lt;- c(200,500,1500,4000,10000)
right &lt;- xYplot(ANC ~ time | id, data=new.ts
                , as.table=TRUE, type="l"
                , layout=c(5,5)
                , scales=list(y=list(log=TRUE, lim=c(100,1.5e4)
                                     , at=anc.tics
                                     , lab=as.character(anc.tics)),
                              x=list(at=seq(0,30,3)))
)
newton &lt;- upData(newton
                 , time = 3*(cycle-1)
                 , labels = c(time="Time")
                 , units = c(time="weeks")
                 , print = FALSE)
dose.tics &lt;- c(50, 200, 600, 1500, 3000)
left &lt;- xYplot(scaled.dose ~ time | id, data=newton
               , as.table=TRUE, type='p', pch='+', cex=1.5
               , layout=c(5,5)
               , scales=list(y=list(lim=DTAT:::scaled(c(30,3200))
                                    , at=DTAT:::scaled(dose.tics)
                                    , lab=as.character(dose.tics)),
                             x=list(lim=c(-1,31)
                                    , at=seq(0,30,3)
                                    , lab=c('0','','6','','12','','18','','24','','30')))
)
update(doubleYScale(left, right, add.ylab2=TRUE)
       , par.settings = simpleTheme(col=brewer.pal(4,"PRGn")[c(4,1)])
)
}

</code></pre>

<hr>
<h2 id='titration'>Simulate a &lsquo;3+3/PC&rsquo; dose-titration trial</h2><span id='topic+titration'></span><span id='topic+titration+2CDE+2Cnumeric-method'></span>

<h3>Description</h3>

<p>Simulate a &lsquo;3+3/PC&rsquo; dose-titration trial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>titration(x, periods, ...)

## S4 method for signature 'DE,numeric'
titration(x, periods, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="titration_+3A_x">x</code></td>
<td>
<p>An object of S4 class <code><a href="#topic+DE-class">DE</a></code></p>
</td></tr>
<tr><td><code id="titration_+3A_periods">periods</code></td>
<td>
<p>The number of DLT assessment periods to titrate over.
Should be a positive integer.</p>
</td></tr>
<tr><td><code id="titration_+3A_...">...</code></td>
<td>
<p>May be used to pass <code>verbatim = 'TRUE'</code> to internal
<code>step_time</code> method.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Norris DC. Precautionary Coherence Unravels Dose Escalation Designs.
<em>bioRxiv</em>. December 2017:240846. doi:10.1101/240846.
<a href="https://www.biorxiv.org/content/10.1101/240846v1">https://www.biorxiv.org/content/10.1101/240846v1</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
