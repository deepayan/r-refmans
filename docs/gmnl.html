<!DOCTYPE html><html><head><title>Help for package gmnl</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gmnl}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC.gmnl'><p>Akaike's Information Criterion</p></a></li>
<li><a href='#bread.gmnl'><p>Bread for Sandwiches</p></a></li>
<li><a href='#cov.gmnl'><p>Functions for Correlated Random Parameters</p></a></li>
<li><a href='#effect.gmnl'><p>Get the Conditional Individual Coefficients</p></a></li>
<li><a href='#estfun.gmnl'><p>Gradient for Observations</p></a></li>
<li><a href='#getSummary.gmnl'><p>Get Model Summaries for Use with &quot;mtable&quot;</p></a></li>
<li><a href='#gFormula'><p>Model Formula for Multinomial Logit Models</p></a></li>
<li><a href='#gmnl'><p>Estimate Multinomial Logit Models with Observed and Unobserved Individual Heterogeneity.</p></a></li>
<li><a href='#plot.gmnl'><p>Plot of the Distribution of the Conditional Expectation of Random Parameters</p></a></li>
<li><a href='#vcov.gmnl'><p>vcov method for gmnl objects</p></a></li>
<li><a href='#wtp.gmnl'><p>Compute Willingness-to-pay</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multinomial Logit Models with Random Parameters</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-27</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of maximum simulated likelihood method for the
    estimation of multinomial logit models with random coefficients as presented by Sarrias and Daziano (2017) &lt;<a href="https://doi.org/10.18637%2Fjss.v079.i02">doi:10.18637/jss.v079.i02</a>&gt;.
    Specifically, it allows estimating models with continuous heterogeneity
    such as the mixed multinomial logit and the generalized multinomial logit.
    It also allows estimating models with discrete heterogeneity such as the
    latent class and the mixed-mixed multinomial logit model.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0), maxLik, Formula</td>
</tr>
<tr>
<td>Imports:</td>
<td>plotrix, msm, mlogit, truncnorm, stats, graphics, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>AER, lmtest, car, memisc, testthat</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://msarrias.com/description.html">https://msarrias.com/description.html</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-27 15:29:15 UTC; mauriciosarrias</td>
</tr>
<tr>
<td>Author:</td>
<td>Mauricio Sarrias <a href="https://orcid.org/0000-0001-5932-4817"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Ricardo Daziano [aut],
  Yves Croissant [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mauricio Sarrias &lt;msarrias86@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-27 17:00:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC.gmnl'>Akaike's Information Criterion</h2><span id='topic+AIC.gmnl'></span><span id='topic+BIC.gmnl'></span>

<h3>Description</h3>

<p>Calculate the Akaike's information Criterion (AIC) or the Bayesian
information Criterion (BIC) for an object of class <code>gmnl</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gmnl'
AIC(object, ..., k = 2)

## S3 method for class 'gmnl'
BIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC.gmnl_+3A_object">object</code></td>
<td>
<p>a fitted model of class <code>gmnl</code>.</p>
</td></tr>
<tr><td><code id="AIC.gmnl_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to or from other functions.</p>
</td></tr>
<tr><td><code id="AIC.gmnl_+3A_k">k</code></td>
<td>
<p>a numeric value, use as penalty coefficient for number of parameters
in the fitted model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more information see <code><a href="stats.html#topic+AIC">AIC</a></code> or <code><a href="stats.html#topic+BIC">BIC</a></code>
</p>


<h3>Value</h3>

<p>A numeric value with the corresponding AIC or BIC value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gmnl">gmnl</a></code> for the estimation of multinomial logit models with observed and unobserved individual heterogeneity.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Estimate MNL model
data("TravelMode", package = "AER")
library(mlogit)
TM &lt;- mlogit.data(TravelMode, choice = "choice", shape = "long", 
                 alt.levels = c("air", "train", "bus", "car"), chid.var = "individual")
                 
mnl &lt;- gmnl(choice ~ wait + vcost + travel + gcost | 0 , data = TM)
AIC(mnl)
BIC(mnl)
</code></pre>

<hr>
<h2 id='bread.gmnl'>Bread for Sandwiches</h2><span id='topic+bread.gmnl'></span>

<h3>Description</h3>

<p>Computes the &ldquo;bread&rdquo; of the sandwich covariance matrix for objects of class <code>gmnl</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gmnl'
bread(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bread.gmnl_+3A_x">x</code></td>
<td>
<p>a fitted model of class <code>gmnl</code>.</p>
</td></tr>
<tr><td><code id="bread.gmnl_+3A_...">...</code></td>
<td>
<p>other arguments when <code>bread</code> is applied to another
class object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more information see <code><a href="sandwich.html#topic+bread">bread</a></code> from the package <span class="pkg">sandwich</span>.
</p>


<h3>Value</h3>

<p>The covariance matrix times observations
</p>


<h3>References</h3>

<p>Zeileis A (2006), Object-oriented Computation of Sandwich 
Estimators. Journal of Statistical Software, 16(9), 1&ndash;16.
</p>

<hr>
<h2 id='cov.gmnl'>Functions for Correlated Random Parameters</h2><span id='topic+cov.gmnl'></span><span id='topic+cor.gmnl'></span><span id='topic+se.cov.gmnl'></span>

<h3>Description</h3>

<p>These are a set of functions that help to extract the variance-covariance matrix, the correlation matrix, and the standard error of the random parameters for models of class <code>gmnl</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov.gmnl(x, Q = NULL)

cor.gmnl(x, Q = NULL)

se.cov.gmnl(x, sd = FALSE, Q = NULL, digits = max(3, getOption("digits") - 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cov.gmnl_+3A_x">x</code></td>
<td>
<p>an object of class <code>gmnl</code> where <code>ranp</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="cov.gmnl_+3A_q">Q</code></td>
<td>
<p>this argument is only valid if the &quot;<code>mm</code>&quot; (MM-MNL) model is estimated. It indicates the class for which the variance-covariance matrix is computed.</p>
</td></tr>
<tr><td><code id="cov.gmnl_+3A_sd">sd</code></td>
<td>
<p>if <code>TRUE</code>, then the standard deviations of the random parameters along with their standard errors are computed.</p>
</td></tr>
<tr><td><code id="cov.gmnl_+3A_digits">digits</code></td>
<td>
<p>the number of digits.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variance-covariance matrix is computed using the Cholesky decomposition <code class="reqn">LL'=\Sigma</code>.
</p>
<p><code>se.cov.gmnl</code> function is a wrapper for the <code><a href="msm.html#topic+deltamethod">deltamethod</a></code> function of the <span class="pkg">msm</span> package.
</p>


<h3>Value</h3>

<p><code>cov.gmnl</code> returns a matrix with the variance of the random parameters if the model is fitted with random coefficients. If the model is fitted with <code>correlation = TRUE</code>, then the variance-covariance matrix is returned. 
</p>
<p>If <code>correlation = TRUE</code> in the fitted model, then  <code>se.cov.gmnl</code> returns a coefficient matrix for the elements of the variance-covariance matrix or the standard deviations if <code>sd = TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Mauricio Sarrias <a href="mailto:msarrias86@gmail.com">msarrias86@gmail.com</a>
</p>


<h3>References</h3>


<ul>
<li><p> Greene, W. H. (2012). Econometric Analysis, Seventh Edition. Pearson Hall.
</p>
</li>
<li><p> Train, K. (2009). Discrete Choice Methods with Simulation. Cambridge University Press.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+gmnl">gmnl</a></code> for the estimation of different multinomial models with individual heterogeneity.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Examples using Electricity data set from mlogit package
library(mlogit)
data("Electricity", package = "mlogit")
Electr &lt;- mlogit.data(Electricity, id.var = "id", choice = "choice",
                     varying = 3:26, shape = "wide", sep = "")
                     
## Estimate a MIXL model with correlated random parameters
Elec.cor &lt;- gmnl(choice ~ pf + cl + loc + wk + tod + seas| 0, data = Electr,
                 subset = 1:3000,
                 model = 'mixl',
                 R = 10,
                 panel = TRUE,
                 ranp = c(cl = "n", loc = "n", wk = "n", tod = "n", seas = "n"),
                 correlation = TRUE)
                 
## Use functions for correlated random parameters
cov.gmnl(Elec.cor)
se.cov.gmnl(Elec.cor)
se.cov.gmnl(Elec.cor, sd = TRUE)
cor.gmnl(Elec.cor)

## End(Not run)
</code></pre>

<hr>
<h2 id='effect.gmnl'>Get the Conditional Individual Coefficients</h2><span id='topic+effect.gmnl'></span>

<h3>Description</h3>

<p>This a helper function to obtain the individuals' conditional estimate of the either random parameters or willingness-to-pay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effect.gmnl(x, par = NULL, effect = c("ce", "wtp"), wrt = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="effect.gmnl_+3A_x">x</code></td>
<td>
<p>an object of class <code>gmnl</code>.</p>
</td></tr>
<tr><td><code id="effect.gmnl_+3A_par">par</code></td>
<td>
<p>a string giving the name of the variable with a random parameter.</p>
</td></tr>
<tr><td><code id="effect.gmnl_+3A_effect">effect</code></td>
<td>
<p>a string indicating what should be computed: the conditional expectation of the individual coefficients &quot;<code>ce</code>&quot;, or the conditional expectation of the willingness-to-pay &quot;<code>wtp</code>&quot;.</p>
</td></tr>
<tr><td><code id="effect.gmnl_+3A_wrt">wrt</code></td>
<td>
<p>a string indicating with respect to which variable the willingness-to-pay should be computed.</p>
</td></tr>
<tr><td><code id="effect.gmnl_+3A_...">...</code></td>
<td>
<p>further arguments. Ignorred.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list where &quot;<code>mean</code>&quot; contains the individuals' conditional mean for the random parameter or willingness-to-pay, and where &quot;<code>sd.est</code>&quot; contains standard errors.
</p>


<h3>Author(s)</h3>

<p>Mauricio Sarrias.
</p>


<h3>References</h3>


<ul>
<li><p> Greene, W. H. (2012). Econometric Analysis, Seventh Edition. Pearson Hall.
</p>
</li>
<li><p> Train, K. (2009). Discrete Choice Methods with Simulation. Cambridge University Press.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+gmnl">gmnl</a></code> for the estimation of multinomial Logit models with individual parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Data
data("TravelMode", package = "AER")
library(mlogit)
TM &lt;- mlogit.data(TravelMode, choice = "choice", shape = "long", 
                 alt.levels = c("air", "train", "bus", "car"), chid.var = "individual")
                 
## MIXL model with observed heterogeneity
mixl.hier &lt;- gmnl(choice ~ vcost + gcost + travel + wait | 1 | 0 | income + size - 1,
                 data = TM,
                 model = "mixl",
                 ranp = c(travel = "t", wait = "n"),
                 mvar = list(travel = c("income","size"), wait = c("income")),
                 R = 30,
                 haltons = list("primes"= c(2, 17), "drop" = rep(19, 2)))
                 
## Get the individuals' conditional mean and their standard errors for lwage
bi.travel &lt;- effect.gmnl(mixl.hier, par = "travel", effect = "ce")
summary(bi.travel$mean)
summary(bi.travel$sd.est)

## Get the individuals' conditional WTP of travel with respect to gcost
wtp.travel &lt;- effect.gmnl(mixl.hier, par = "travel", effect = "wtp", wrt = "gcost")
summary(wtp.travel$mean)
summary(wtp.travel$sd.est)

## End(Not run) 
</code></pre>

<hr>
<h2 id='estfun.gmnl'>Gradient for Observations</h2><span id='topic+estfun.gmnl'></span>

<h3>Description</h3>

<p>It extracts the gradient for each observation evaluated at the estimated parameters for an object of class <code>gmnl</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gmnl'
estfun(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estfun.gmnl_+3A_x">x</code></td>
<td>
<p>a fitted model of class <code>gmnl</code>.</p>
</td></tr>
<tr><td><code id="estfun.gmnl_+3A_...">...</code></td>
<td>
<p>other arguments. Ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more information see <code><a href="sandwich.html#topic+estfun">estfun</a></code> from package <span class="pkg">sandwich</span>.
</p>


<h3>Value</h3>

<p>The gradient matrix of dimension <code class="reqn">n \times K</code>
</p>


<h3>References</h3>

<p>Zeileis A (2006), Object-oriented Computation of Sandwich 
Estimators. Journal of Statistical Software, 16(9), 1&ndash;16.
</p>

<hr>
<h2 id='getSummary.gmnl'>Get Model Summaries for Use with &quot;mtable&quot;</h2><span id='topic+getSummary.gmnl'></span>

<h3>Description</h3>

<p>A generic function to collect coefficients and summary statistics from a <code>gmnl</code> object. It is used in <code>mtable</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSummary.gmnl(obj, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSummary.gmnl_+3A_obj">obj</code></td>
<td>
<p>a <code>gmnl</code> object,</p>
</td></tr>
<tr><td><code id="getSummary.gmnl_+3A_alpha">alpha</code></td>
<td>
<p>level of the confidence intervals,</p>
</td></tr>
<tr><td><code id="getSummary.gmnl_+3A_...">...</code></td>
<td>
<p>further arguments,</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details see package <span class="pkg">memisc</span>
</p>

<hr>
<h2 id='gFormula'>Model Formula for Multinomial Logit Models</h2><span id='topic+gFormula'></span><span id='topic+is.gFormula'></span><span id='topic+model.frame.gFormula'></span><span id='topic+model.matrix.gFormula'></span>

<h3>Description</h3>

<p>Four kind of variables are used in multinomial choice models with individual heterogeneity: alternative
specific and individual specific variables; variables for the mean of the random parameters (deterministic taste variations), and variables
for the scale function. <code>gFormula</code> deals with this type of models using suitable methods to extract
the elements of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gFormula(object)

is.gFormula(object)

## S3 method for class 'gFormula'
model.frame(formula, data, ..., lhs = NULL, rhs = NULL)

## S3 method for class 'gFormula'
model.matrix(object, data, rhs = NULL, Q = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gFormula_+3A_object">object</code></td>
<td>
<p>a formula for the <code>gFormula</code> function, for the model.matrix method, a <code>gFormula</code> object,</p>
</td></tr>
<tr><td><code id="gFormula_+3A_formula">formula</code></td>
<td>
<p>a <code>gFormula</code> object,</p>
</td></tr>
<tr><td><code id="gFormula_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code>,</p>
</td></tr>
<tr><td><code id="gFormula_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
<tr><td><code id="gFormula_+3A_lhs">lhs</code></td>
<td>
<p>see <code><a href="Formula.html#topic+Formula">Formula</a></code>,</p>
</td></tr>
<tr><td><code id="gFormula_+3A_rhs">rhs</code></td>
<td>
<p>see <code><a href="Formula.html#topic+Formula">Formula</a></code>,</p>
</td></tr>
<tr><td><code id="gFormula_+3A_q">Q</code></td>
<td>
<p>number of classes for the latent class model,</p>
</td></tr>
</table>

<hr>
<h2 id='gmnl'>Estimate Multinomial Logit Models with Observed and Unobserved Individual Heterogeneity.</h2><span id='topic+gmnl'></span><span id='topic+print.gmnl'></span><span id='topic+summary.gmnl'></span><span id='topic+print.summary.gmnl'></span><span id='topic+update.gmnl'></span><span id='topic+coef.gmnl'></span><span id='topic+model.matrix.gmnl'></span><span id='topic+residuals.gmnl'></span><span id='topic+df.residual.gmnl'></span><span id='topic+fitted.gmnl'></span><span id='topic+logLik.gmnl'></span><span id='topic+nObs.gmnl'></span>

<h3>Description</h3>

<p>Estimate different types of multinomial logit models with observed and unobserved individual heterogneity, such as
MIXL, S-MNL, G-MNL, LC and MM-MNL models. These models are estimated using  Maximum Simulated Likelihood. It supports both cross-sectional and panel data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmnl(
  formula,
  data,
  subset,
  weights,
  na.action,
  model = c("mnl", "mixl", "smnl", "gmnl", "lc", "mm"),
  start = NULL,
  ranp = NULL,
  R = 40,
  Q = 2,
  haltons = NA,
  mvar = NULL,
  seed = 12345,
  correlation = FALSE,
  bound.err = 2,
  panel = FALSE,
  hgamma = c("direct", "indirect"),
  reflevel = NULL,
  init.tau = 0.1,
  init.gamma = 0.1,
  notscale = NULL,
  print.init = FALSE,
  gradient = TRUE,
  typeR = TRUE,
  ...
)

## S3 method for class 'gmnl'
print(
  x,
  digits = max(3, getOption("digits") - 3),
  width = getOption("width"),
  ...
)

## S3 method for class 'gmnl'
summary(object, ...)

## S3 method for class 'summary.gmnl'
print(
  x,
  digits = max(3, getOption("digits") - 2),
  width = getOption("width"),
  ...
)

## S3 method for class 'gmnl'
update(object, new, ...)

## S3 method for class 'gmnl'
coef(object, ...)

## S3 method for class 'gmnl'
model.matrix(object, ...)

## S3 method for class 'gmnl'
residuals(object, outcome = TRUE, ...)

## S3 method for class 'gmnl'
df.residual(object, ...)

## S3 method for class 'gmnl'
fitted(object, outcome = TRUE, ...)

## S3 method for class 'gmnl'
logLik(object, ...)

## S3 method for class 'gmnl'
nObs(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gmnl_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be estimated. The formula is divided in five parts, each of them separated by the symbol <code>|</code>. The first part is reserved for alternative-specific variables with a generic coefficient. The second part corresponds to individual-specific variables with an alternative specific coefficients. The third part corresponds to alternative-specific variables with an alternative-specific coefficident. The fourth part is reserved for time-invariant variables that modify the mean of the random parameters. Finally, the fifth part is reserved for time-invariant variables that enter in the scale coefficient or in the probability assignment in models with latent classes.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_data">data</code></td>
<td>
<p>the data of class <code><a href="mlogit.html#topic+mlogit.data">mlogit.data</a></code>.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights. Default to 1.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_na.action">na.action</code></td>
<td>
<p>a function wich indicated what should happen when the data
contains <code>NA</code>'s.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_model">model</code></td>
<td>
<p>a string indicating which model is estimated. The options are &quot;<code>mnl</code>&quot; for the Multinomial Logit Model, &quot;<code>mixl</code>&quot; for the Mixed Logit Model, &quot;<code>smnl</code>&quot; for the Scaled Multinomial Logit Model, &quot;<code>gmnl</code>&quot; for the Generalized Multinomial Logit Model, &quot;<code>lc</code>&quot; for the Latent Class Multinomial Logit Model, and &quot;<code>mm</code>&quot; for the Mixed-Mixed Multinomial Logit Model.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_start">start</code></td>
<td>
<p>a vector of starting values.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_ranp">ranp</code></td>
<td>
<p>a named vector whose names are the random parameters and values the distribution:
&quot;<code>n</code>&quot; for normal, &quot;<code>ln</code>&quot; for log-normal, &quot;<code>cn</code>&quot; for truncated normal, &quot;<code>u</code>&quot; for uniform, &quot;<code>t</code>&quot; for triangular, &quot;<code>sb</code>&quot; for Sb Johnson.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_r">R</code></td>
<td>
<p>the number of draws of pseudo-random numbers if <code>ranp</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_q">Q</code></td>
<td>
<p>number of classes for LC or MM-MNL models.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_haltons">haltons</code></td>
<td>
<p>only relevant if <code>ranp</code> is not <code>NULL</code>. If <code>haltons = NULL</code>, pseudo-random numbers are used instead of Halton sequences. If <code>haltons=NA</code>, the first <code class="reqn">K</code> primes are used to generates the Halton draws, where <code class="reqn">K</code> is the number of random parameters, and 15 of the initial sequence of elements are dropped. Otherwise, <code>haltons</code> should be a list with elements <code>prime</code> and <code>drop</code>.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_mvar">mvar</code></td>
<td>
<p>only valid if <code>ranp</code> is not <code>NULL</code>. This is a named list, where the names correspond to the variables with random parameters, and the values correspond to the variables that enter in the mean of each random parameters.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_seed">seed</code></td>
<td>
<p>seed for the random number generator. Default is <code>seed = 12345</code>.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_correlation">correlation</code></td>
<td>
<p>only relevant if <code>ranp</code> is not <code>NULL</code>. If true, the correlation across random parameters is taken into account.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_bound.err">bound.err</code></td>
<td>
<p>only relevenat if model is <code>smnl</code> or <code>gmnl</code>. It indicates at which values the draws for the scale parameter are truncated. By default <code>bound.err = 2</code>, therefore a truncated normal distribution with truncation at -2 and +2 is used.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_panel">panel</code></td>
<td>
<p>if <code>TRUE</code> a panel data model is estimated.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_hgamma">hgamma</code></td>
<td>
<p>a string indicated how to estimate the parameter gamma. If &quot;<code>direct</code>&quot;, then <code class="reqn">\gamma</code> is estimated directly, if &quot;<code>indirect</code>&quot; then <code class="reqn">\gamma ^*</code> is estimated, where <code class="reqn">\gamma = \exp(\gamma^*)/(1 + \exp(\gamma^*))</code>.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_reflevel">reflevel</code></td>
<td>
<p>the base alternative.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_init.tau">init.tau</code></td>
<td>
<p>initial value for the <code class="reqn">\tau</code> parameter.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_init.gamma">init.gamma</code></td>
<td>
<p>initial value  for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_notscale">notscale</code></td>
<td>
<p>only relevant if model is <code>smnl</code> or <code>gmnl</code>. It is a vector indicating which variables should not be scaled.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_print.init">print.init</code></td>
<td>
<p>if <code>TRUE</code>, the initial values for the optimization procedure are printed.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_gradient">gradient</code></td>
<td>
<p>if <code>TRUE</code>, analytical gradients are used for the optimization procedure.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_typer">typeR</code></td>
<td>
<p>if <code>TRUE</code>, truncated normal draws are used for the scale parameter, if <code>FALSE</code> the procedure suggested by Greene (2010) is used.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="maxLik.html#topic+maxLik">maxLik</a></code>, which depend in the maximization routine.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_x">x</code>, <code id="gmnl_+3A_object">object</code></td>
<td>
<p>and object of class <code>gmnl</code>.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_digits">digits</code></td>
<td>
<p>the number of digits.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_width">width</code></td>
<td>
<p>width.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_new">new</code></td>
<td>
<p>an updated formula for the <code>update</code> method.</p>
</td></tr>
<tr><td><code id="gmnl_+3A_outcome">outcome</code></td>
<td>
<p>if <code>TRUE</code>, then the <code>fitted</code> and <code>residuals</code> methods return a vector that corresponds to the chosen alternative, otherwise it returns a matrix where each column corresponds to each alternative.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let the utility to person <code class="reqn">i</code> from choosing alternative <code class="reqn">j</code> on choice occasion <code class="reqn">t</code> be: </p>
<p style="text-align: center;"><code class="reqn">U_{ijt} = \beta_{i}x_{ijt} + \epsilon_{ijt}</code>
</p>
<p> where <code class="reqn">\epsilon_{ijt}</code> is i.i.d extreme value, and <code class="reqn">\beta_i</code> vary across individuals. Each model estimated by <code>gmnl</code> depends on how <code class="reqn">\beta_i</code> is specified. The options are the following:
</p>

<ol>
<li><p> S-MNL if <code class="reqn">\beta_i=\sigma_i\beta</code>, where the scale <code class="reqn">\sigma_i</code> varies across individuals.
</p>
</li>
<li><p> MIXL  if <code class="reqn">\beta_i=\beta + s\eta_i</code>, where <code class="reqn">\eta_i</code> is a draw from some distribution. For example, if <code class="reqn">\beta_i\sim N(\beta, s^2)</code>, then <code class="reqn">\eta_i\sim N(0, 1)</code>.
</p>
</li>
<li><p> GMNL if <code class="reqn">\beta_i=\sigma_i\beta + \gamma s\eta_i + \sigma_i(1-\gamma)s\eta_i</code>, where <code class="reqn">\sigma_i</code> is the scale parameter, and <code class="reqn">\gamma</code> is a parameter that controls how the variance of residual taste heterogeneity varies with scale.
</p>
</li>
<li><p> LC if <code class="reqn">\beta_i=\beta_q</code> with probability <code class="reqn">w_{iq}</code> for <code class="reqn">q = 1,...,Q</code>, where <code class="reqn">Q</code> is the total number of classes.
</p>
</li>
<li><p> MM-MIXL if  <code class="reqn">\beta_i\sim f(\beta_q, \Sigma_q)</code> with probability <code class="reqn">w_{iq}</code> for <code class="reqn">q = 1,...,Q</code>, where <code class="reqn">Q</code> is the total number of classes.
</p>
</li></ol>

<p>Observed heterogeneity can be also accommodated in the random parameters when the MIXL is estimated by including individual-specific covariates. Specifically, the vector of random coefficients is </p>
<p style="text-align: center;"><code class="reqn">\beta_i=\beta +\Pi z_i + L\eta_i</code>
</p>
<p> where <code class="reqn">z_i</code> is a set of characteristics of individual <code class="reqn">i</code> that influence the mean of the taste parameters; and <code class="reqn">\Pi</code> is matrix of parameters. To estimate this model, the fourth part of the <code>formula</code> should be specified along with the <code>mvar</code> argument.
</p>
<p>One can also allow the mean of the scale to differ across individuals by including individual-specific characteristics. Thus, the scale parameters can be written as </p>
<p style="text-align: center;"><code class="reqn">\exp(\bar{\sigma} + \delta h_i + \tau \upsilon_i)</code>
</p>
<p> where <code class="reqn">h_i</code> is a vector of attributes of individual <code class="reqn">i</code>. To estimate this model, the fifth part of the <code>formula</code> should include the variables that enter <code class="reqn">h_i</code>.
</p>
<p>For models with latent classes,  the class assignment is modeled as a semi-parametric multinomial logit format </p>
<p style="text-align: center;"><code class="reqn">w_{iq}= \frac{\exp(\gamma_q)}{\sum_{q=1}^Q\exp(\gamma_q)}</code>
</p>
<p> for <code class="reqn">q = 1,...,Q, \gamma_1 = 0</code>. Latent class models (LC and MM-MIXL) requires at least that a constant should be specified in the fifth part of the <code>formula</code>. If the class assignment, <code class="reqn">w_{iq}</code>, is also determined by socio-economic characteristics, these variables can be also included in the fifth part.  
</p>
<p>Models that involve random parameters are estimated using Maximum Simulated Likelihood using the <code>maxLik</code> function of <code><a href="maxLik.html#topic+maxLik">maxLik</a></code> package.
</p>


<h3>Value</h3>

<p>An object of class &ldquo;<code>gmnl</code>&rdquo; with the following elements
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>the named vector of coefficients,</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>a set of values of the maximum likelihood procedure,</p>
</td></tr>   
<tr><td><code>mf</code></td>
<td>
<p>the model framed used,</p>
</td></tr> 
<tr><td><code>formula</code></td>
<td>
<p>the formula (a <code>gFormula</code> object),</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p><code>proc.time()</code> minus the start time,</p>
</td></tr>
<tr><td><code>freq</code></td>
<td>
<p>frequency of dependent variable,</p>
</td></tr>
<tr><td><code>draws</code></td>
<td>
<p>type of draws used,</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the fitted model,</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>number of draws used,</p>
</td></tr>
<tr><td><code>ranp</code></td>
<td>
<p>vector indicating the variables with random parameters and their distribution,</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals,</p>
</td></tr>
<tr><td><code>correlation</code></td>
<td>
<p>whether the model is fitted assuming that the random parameters are correlated,</p>
</td></tr>
<tr><td><code>bi</code></td>
<td>
<p>matrix of conditional expectation of random parameters,</p>
</td></tr>
<tr><td><code>Q</code></td>
<td>
<p>number of classes,</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mauricio Sarrias <a href="mailto:msarrias86@gmail.com">msarrias86@gmail.com</a>
</p>


<h3>References</h3>


<ul>
<li><p> Keane, M., &amp; Wasi, N. (2013). Comparing alternative models of heterogeneity in consumer choice behavior. Journal of Applied Econometrics, 28(6), 1018-1045.
</p>
</li>
<li><p> Fiebig, D. G., Keane, M. P., Louviere, J., &amp; Wasi, N. (2010). The generalized multinomial logit model: accounting for scale and coefficient heterogeneity. Marketing Science, 29(3), 393-421.
</p>
</li>
<li><p> Greene, W. H., &amp; Hensher, D. A. (2010). Does scale heterogeneity across individuals matter? An empirical assessment of alternative logit models. Transportation, 37(3), 413-428.
</p>
</li>
<li><p> Train, K. (2009). Discrete choice methods with simulation. Cambridge University Press.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="mlogit.html#topic+mlogit">mlogit</a></code>, <code><a href="mlogit.html#topic+mlogit.data">mlogit.data</a></code>,  <code><a href="maxLik.html#topic+maxLik">maxLik</a></code>, <code>Rchoice</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Examples using the Fishing data set from the AER package
data("TravelMode", package = "AER")
library(mlogit)
TM &lt;- mlogit.data(TravelMode, choice = "choice", shape = "long", 
                 alt.levels = c("air", "train", "bus", "car"), chid.var = "individual")
## Not run: 
## S-MNL model, ASCs not scaled
smnl &lt;- gmnl(choice ~ wait + vcost + travel + gcost| 1, data = TM, 
             model = "smnl", R = 100, 
             notscale = c(1, 1, 1, rep(0, 4)))
summary(smnl)

## MIXL model with observed heterogeneity
mixl.hier &lt;- gmnl(choice ~ vcost + gcost + travel + wait | 1 | 0 | income + size - 1,
                 data = TM,
                 model = "mixl",
                 ranp = c(travel = "t", wait = "n"),
                 mvar = list(travel = c("income","size"), wait = c("income")),
                 R = 30,
                 haltons = list("primes"= c(2, 17), "drop" = rep(19, 2)))
summary(mixl.hier)

## Examples using the Electricity data set from the mlogit package
data("Electricity", package = "mlogit")
Electr &lt;- mlogit.data(Electricity, id.var = "id", choice = "choice",
                     varying = 3:26, shape = "wide", sep = "")
                     
## Estimate a MIXL model with correlated random parameters
Elec.cor &lt;- gmnl(choice ~ pf + cl + loc + wk + tod + seas| 0, data = Electr,
                 subset = 1:3000,
                 model = 'mixl',
                 R = 10,
                 panel = TRUE,
                 ranp = c(cl = "n", loc = "n", wk = "n", tod = "n", seas = "n"),
                 correlation = TRUE)
summary(Elec.cor)
cov.gmnl(Elec.cor)
se.cov.gmnl(Elec.cor)
se.cov.gmnl(Elec.cor, sd = TRUE)
cor.gmnl(Elec.cor)

## Estimate a G-MNL model, where ASCs are also random
Electr$asc2 &lt;- as.numeric(Electr$alt == 2)
Electr$asc3 &lt;- as.numeric(Electr$alt == 3)
Electr$asc4 &lt;- as.numeric(Electr$alt == 4)

Elec.gmnl &lt;- gmnl(choice ~ pf + cl + loc + wk + tod + seas + asc2 + asc3 + asc4 | 0,
                 data = Electr,
                 subset = 1:3000,
                 model = 'gmnl',
                 R = 30,
                 panel = TRUE,
                 notscale = c(rep(0, 6), 1, 1, 1),
                 ranp = c(cl = "n", loc = "n", wk = "n", tod = "n", seas = "n",
                 asc2 = "n", asc3 = "n", asc4 = "n"))
summary(Elec.gmnl)

## Estimate a LC model with 2 classes
Elec.lc &lt;- gmnl(choice ~ pf + cl + loc + wk + tod + seas| 0 | 0 | 0 | 1,
               data = Electr,
               subset = 1:3000,
               model = 'lc',
               panel = TRUE,
               Q = 2)
summary(Elec.lc)

## Estimate a MM-MIXL model
Elec.mm &lt;- gmnl(choice ~ pf + cl + loc + wk + tod + seas| 0 | 0 | 0 | 1,
                 data = Electr,
                 subset = 1:3000,
                 model = 'mm',
                 R = 30,
                 panel = TRUE,
                 ranp = c(pf = "n", cl = "n", loc = "n", wk = "n", tod = "n",
                 seas = "n"),
                 Q = 2,
                 iterlim = 500)
summary(Elec.mm)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.gmnl'>Plot of the Distribution of the Conditional Expectation of Random Parameters</h2><span id='topic+plot.gmnl'></span>

<h3>Description</h3>

<p>Methods for <code>gmnl</code> objects which provide a plot of the distribution of the conditional expectation of the random parameters or the distribution of the conditional willigness-to-pay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gmnl'
plot(
  x,
  par = NULL,
  effect = c("ce", "wtp"),
  wrt = NULL,
  type = c("density", "histogram"),
  adjust = 1,
  main = NULL,
  col = "indianred1",
  breaks = 10,
  ylab = NULL,
  xlab = NULL,
  ind = FALSE,
  id = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gmnl_+3A_x">x</code></td>
<td>
<p>an object of class <code>gmnl</code>.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_par">par</code></td>
<td>
<p>a string giving the name of the variable with random parameter.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_effect">effect</code></td>
<td>
<p>a string indicating whether the conditional expectation, &quot;<code>ce</code>&quot;, or the WTP, &quot;<code>wtp</code>&quot; should be plotted.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_wrt">wrt</code></td>
<td>
<p>a string indicating with respect to which variable the WTP should be computed if <code>effect = "wtp"</code>.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_type">type</code></td>
<td>
<p>a string indicating the type of distribution: it can be a <code>histogram</code> or a <code>density</code> of the conditional expectation of the random coefficients or WTP.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_adjust">adjust</code></td>
<td>
<p>bandwidth for the kernel density.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_main">main</code></td>
<td>
<p>an overall title for the plot.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_col">col</code></td>
<td>
<p>color for the graph.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_breaks">breaks</code></td>
<td>
<p>number of breaks for the histrogram if <code>type = "histogram"</code>.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_ylab">ylab</code></td>
<td>
<p>a title for the y axis.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_xlab">xlab</code></td>
<td>
<p>a title for the x axis.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_ind">ind</code></td>
<td>
<p>a boolean. If <code>TRUE</code>, a 95% interval of conditional distribution for each individual is plotted. As default, the conditional expectation of <code>par</code> for the first 10 individual is plotted.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_id">id</code></td>
<td>
<p>only relevant if <code>ind</code> is not <code>NULL</code>. This is a vector indicating the individuals for whom the user want to plot the conditional coefficients.</p>
</td></tr>
<tr><td><code id="plot.gmnl_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>plot</code> or <code>plotCI</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mauricio Sarrias
</p>


<h3>References</h3>


<ul>
<li><p> Greene, W. H. (2012). Econometric Analysis, Seventh Edition. Pearson Hall.
</p>
</li>
<li><p> Train, K. (2009). Discrete Choice Methods with Simulation. Cambridge University Press.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+gmnl">gmnl</a></code> for the estimation of different multinomial models with individual heterogeneity and <code><a href="#topic+effect.gmnl">effect.gmnl</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Examples using the Electricity data set from the mlogit package
library(mlogit)
data("Electricity", package = "mlogit")
Electr &lt;- mlogit.data(Electricity, id.var = "id", choice = "choice",
                     varying = 3:26, shape = "wide", sep = "")
                     
## Estimate a MIXL model with correlated random parameters
Elec.cor &lt;- gmnl(choice ~ pf + cl + loc + wk + tod + seas| 0, data = Electr,
                 subset = 1:3000,
                 model = 'mixl',
                 R = 10,
                 panel = TRUE,
                 ranp = c(cl = "n", loc = "n", wk = "n", tod = "n", seas = "n"),
                 correlation = TRUE)
                 
## Plot the density of the conditional expectation distribution of loc
plot(Elec.cor, par = "loc", effect = "ce", type = "density", col = "grey")

## Plot the conditional expectation of loc for each individual
plot(Elec.cor, par = "loc", effect = "ce", ind = TRUE, id = 1:30)

## Plot the WTP for cl
plot(Elec.cor, par = "loc", effect = "wtp", wrt = "pf")                  

## End(Not run) 
</code></pre>

<hr>
<h2 id='vcov.gmnl'>vcov method for gmnl objects</h2><span id='topic+vcov.gmnl'></span>

<h3>Description</h3>

<p>The <code>vcov</code> method for <code>gmnl</code> objects extracts the covariance matrix of the coefficients or the random parameters. It also allows to get the standard errors for the variance-covariance matrix of the random parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gmnl'
vcov(
  object,
  what = c("coefficient", "ranp"),
  type = c("cov", "cor", "sd"),
  se = FALSE,
  Q = NULL,
  digits = max(3, getOption("digits") - 2),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.gmnl_+3A_object">object</code></td>
<td>
<p>a fitted model of class <code>gmnl</code>,</p>
</td></tr>
<tr><td><code id="vcov.gmnl_+3A_what">what</code></td>
<td>
<p>indicates which covariance matrix has to be extracted. The default is <code>coefficient</code>, in this case the <code>vcov</code> behaves as usual. If <code>what = "ranp"</code> the covariance matrix of the random parameters is returned as default,</p>
</td></tr>
<tr><td><code id="vcov.gmnl_+3A_type">type</code></td>
<td>
<p>if the model is estimated with random parameters, then this argument indicates what matrix should be returned. If <code>type = "cov"</code>, then the covariance matrix of the random parameters is returned; if <code>type = "cor"</code> then the correlation matrix of the random parameters is returned; if <code>type = "sd"</code> then the standard deviation of the random parameters is returned,</p>
</td></tr>
<tr><td><code id="vcov.gmnl_+3A_se">se</code></td>
<td>
<p>if <code>TRUE</code> <code>type = "cov"</code> then the standard error of the covariance matrix of the random parameters is returned; if <code>TRUE</code> <code>type = "sd"</code> the standard error of the standard deviation of the random parameter is returned. This argument if valid only if the model is estimated using correlated random parameters,</p>
</td></tr>
<tr><td><code id="vcov.gmnl_+3A_q">Q</code></td>
<td>
<p>this argument is only valid if the &quot;<code>mm</code>&quot; (MM-MNL) model is estimated. It indicates the class for which the variance-covariance matrix is computed,</p>
</td></tr>
<tr><td><code id="vcov.gmnl_+3A_digits">digits</code></td>
<td>
<p>number of digits,</p>
</td></tr>
<tr><td><code id="vcov.gmnl_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This new interface replaces the <code>cor.gmnl</code>, <code>cov.gmnl</code> and <code>se.cov.gmnl</code> functions which are deprecated.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gmnl">gmnl</a></code> for the estimation of multinomial logit models with random parameters.
</p>

<hr>
<h2 id='wtp.gmnl'>Compute Willingness-to-pay</h2><span id='topic+wtp.gmnl'></span>

<h3>Description</h3>

<p>Compute the willingness-to-pay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wtp.gmnl(object, wrt = NULL, digits = max(3, getOption("digits") - 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wtp.gmnl_+3A_object">object</code></td>
<td>
<p>an object of class <code>gmnl</code>.</p>
</td></tr>
<tr><td><code id="wtp.gmnl_+3A_wrt">wrt</code></td>
<td>
<p>a string indicating the variable with respect to which the WTP is computed,</p>
</td></tr>
<tr><td><code id="wtp.gmnl_+3A_digits">digits</code></td>
<td>
<p>number of significant digits to be used for most numbers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each coefficient, this function computes both the point estimate and standard error of WTP with respect to the variable specified in the argument <code>wrt</code>. Specifically, let <code class="reqn">\beta_k</code> be the coefficient for variable <code class="reqn">k</code>, then </p>
<p style="text-align: center;"><code class="reqn">WTP_{k}=-\beta_k/\beta_p</code>
</p>

<p>where <code class="reqn">\beta_p</code> is the coefficient for the variable specified with the argument <code>wrt</code>. Note that, <code>wtp.gmnl</code> does not include the negative sign. 
</p>
<p><code>wtp.gmnl</code> function is a wrapper for the <code><a href="msm.html#topic+deltamethod">deltamethod</a></code> function of the <span class="pkg">msm</span> package.
</p>


<h3>Value</h3>

<p>A coefficient matrix with the WTP point estimates and standard errors.
</p>


<h3>Author(s)</h3>

<p>Mauricio Sarrias.
</p>


<h3>References</h3>


<ul>
<li><p> Greene, W. H. (2012). Econometric Analysis, Seventh Edition. Pearson Hall.
</p>
</li>
<li><p> Train, K. (2009). Discrete Choice Methods with Simulation. Cambridge University Press.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="msm.html#topic+deltamethod">deltamethod</a></code> for the estimation of the standard errors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Examples using the Electricity data set from the mlogit package
library(mlogit)
data("Electricity", package = "mlogit")
Electr &lt;- mlogit.data(Electricity, id.var = "id", choice = "choice",
                     varying = 3:26, shape = "wide", sep = "")
                     
## Estimate a conditional logit model
clogit &lt;- gmnl(choice ~ pf + cl + loc + wk + tod + seas| 0,
               data = Electr)
wtp.gmnl(clogit, wrt = "pf")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
