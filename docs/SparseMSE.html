<!DOCTYPE html><html><head><title>Help for package SparseMSE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SparseMSE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Artificial_3'><p>Artificial data set to demonstrate possible instabilities</p></a></li>
<li><a href='#bcaconfvalues'><p>BCa confidence intervals</p></a></li>
<li><a href='#BICandbootstrapsim'><p>Comparison of BIC approach and BCa approach</p></a></li>
<li><a href='#buildmodel'><p>Build model for multiple systems estimation</p></a></li>
<li><a href='#buildmodelmatrix'><p>Build the model matrix based on particular data, as required to check for identifiability and existence of the maximum likelihood estimate</p></a></li>
<li><a href='#checkallmodels'><p>Check all possible models for existence and identifiability</p></a></li>
<li><a href='#checkident'><p>Check a model for the existence and identifiability of the maximum likelihood estimate</p></a></li>
<li><a href='#checkthetasubset'><p>Check a subset of the parameter set theta</p></a></li>
<li><a href='#count_triples'><p>Count number of triples of overlapping lists</p></a></li>
<li><a href='#estimatepopulation'><p>Bootstrapping to evaluate confidence intervals using BCa methods</p></a></li>
<li><a href='#estimatepopulation.0'><p>Estimate the total population including the dark figure.</p>
If the user wishes to find bootstrap confidence intervals then the routine <code>estimatepopulation</code> should be used instead.</a></li>
<li><a href='#investigateAIC'><p>Plot of simulation study</p></a></li>
<li><a href='#modelfit'><p>Fit a specified model to multiple systems estimation data</p></a></li>
<li><a href='#Ned'><p>The Netherlands data</p></a></li>
<li><a href='#Ned_5'><p>Netherlands data five list version</p></a></li>
<li><a href='#NewOrl'><p>New Orleans data</p></a></li>
<li><a href='#NewOrl_5'><p>New Orleans data five list version</p></a></li>
<li><a href='#ordercaptures'><p>Order capture histories</p></a></li>
<li><a href='#removenoninformativelists'><p>Remove non-informative list</p></a></li>
<li><a href='#stepwisefit'><p>Stepwise fit using Poisson p-values.</p></a></li>
<li><a href='#subsetsearch'><p>Search subsets for a property which is inherited in a particular way</p></a></li>
<li><a href='#tidylists'><p>Produce a data matrix with a unique row for each capture history</p></a></li>
<li><a href='#UKdat'><p>UK data</p></a></li>
<li><a href='#UKdat_5'><p>UK data five list version</p></a></li>
<li><a href='#Western'><p>Victims related to sex trafficking in a U.S. Western site</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>'Multiple Systems Estimation for Sparse Capture Data'</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Lax Chan [aut, cre],
  Bernard Silverman [aut],
  Kyle Vincent [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lax Chan &lt;laxchan77@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the routines and algorithms developed and analysed in "Multiple Systems Estimation for Sparse Capture Data: Inferential Challenges when there are Non-Overlapping Lists" Chan, L, Silverman, B. W., Vincent, K (2019) &lt;<a href="https://doi.org/10.48550/arXiv.1902.05156">doi:10.48550/arXiv.1902.05156</a>&gt;. This package explicitly handles situations where there are pairs of lists which have no observed individuals in common.  It deals correctly with parameters whose estimated values can be considered as being negative infinity.  It also addresses other possible issues of non-existence and non-identifiability of maximum likelihood estimates.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://arxiv.org/abs/1902.05156">https://arxiv.org/abs/1902.05156</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Imports:</td>
<td>lpSolve, Rcapture</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-15 12:17:40 UTC; Lax</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-15 12:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Artificial_3'>Artificial data set to demonstrate possible instabilities</h2><span id='topic+Artificial_3'></span>

<h3>Description</h3>

<p>This is a simple data set based on three lists, which gives examples of models that
fail on one or the other of the criteria tested by <code><a href="#topic+checkident">checkident</a></code>. This is Table 2 in Chan, Silverman and Vincent (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Artificial_3
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 4 rows and 4 columns.</p>


<h3>Details</h3>

<p>If all three two-list effects are included in the fitted model then the linear program
in <code><a href="#topic+checkident">checkident</a></code> yields a strictly positive value but the matrix A is not of full column rank, so the parameters are not identifiable.
If the model contains AB either alone or in conjunction with one of AC and BC, then the linear program result is zero, so the MLE does not exist.
If only main effects are considered, or if either or both of AC and BC, but not AB are included,
then the model passes both tests.
</p>


<h3>References</h3>

<p>Chan, L., Silverman, B. W., and Vincent, K. (2019).
Multiple Systems Estimation for Sparse Capture Data: Inferential Challenges when there are Non-Overlapping Lists. Available from <a href="https://arxiv.org/abs/1902.05156">https://arxiv.org/abs/1902.05156</a>.
</p>

<hr>
<h2 id='bcaconfvalues'>BCa confidence intervals</h2><span id='topic+bcaconfvalues'></span>

<h3>Description</h3>

<p>The BCa confidence intervals use percentiles of the bootstrap distribution of the population size
, but adjust the percentile actually used. The adjusted percentiles depend on an
estimated bias parameter, and the quantile function of the estimated bias parameter is the proportion
of the bootstrap estimates that fall below the estimate from the original data, and an
estimated acceleration factor, which derivation depends on a jackknife approach. This routine is called internally
by <code>estimatepopulation</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcaconfvalues(bootreps, popest, ahat, alpha = c(0.025, 0.05, 0.1, 0.16,
  0.84, 0.9, 0.95, 0.975))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bcaconfvalues_+3A_bootreps">bootreps</code></td>
<td>
<p>Point estimates of total population sizes from each bootstrap sample.</p>
</td></tr>
<tr><td><code id="bcaconfvalues_+3A_popest">popest</code></td>
<td>
<p>A point estimate of the total population of the original data set.</p>
</td></tr>
<tr><td><code id="bcaconfvalues_+3A_ahat">ahat</code></td>
<td>
<p>the estimated acceleration factor</p>
</td></tr>
<tr><td><code id="bcaconfvalues_+3A_alpha">alpha</code></td>
<td>
<p>Bootstrap quantiles of interests</p>
</td></tr>
</table>


<h3>Value</h3>

<p>BCa confidence intervals
</p>


<h3>References</h3>

<p>Chan, L., Silverman, B. W., and Vincent, K. (2019).
Multiple Systems Estimation for Sparse Capture Data: Inferential Challenges when there are Non-Overlapping Lists.
Available from <a href="https://arxiv.org/abs/1902.05156">https://arxiv.org/abs/1902.05156</a>.
</p>
<p>DiCiccio, T. J. and Efron, B. (1996). Bootstrap Confidence Intervals. <em>Statistical Science</em>, <strong>40(3)</strong>, 189-228.
</p>

<hr>
<h2 id='BICandbootstrapsim'>Comparison of BIC approach and BCa approach</h2><span id='topic+BICandbootstrapsim'></span>

<h3>Description</h3>

<p>This routine carries out the simulation study as detailed in Section 3.4 of Chan, Silverman and Vincent (2019).
If the original data set has low counts, so that there is a possibility of a simulated data set containing empty lists, then it
may be advisable to use the option <code>noninformativelist=TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BICandbootstrapsim(zdat, nsims = 100, nboot = 100, pthresh = 0.02,
  iseed = 1234, alpha = c(0.025, 0.05, 0.1, 0.16, 0.5, 0.84, 0.9, 0.95,
  0.975), noninformativelist = F, verbose = F, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BICandbootstrapsim_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero count.</p>
</td></tr>
<tr><td><code id="BICandbootstrapsim_+3A_nsims">nsims</code></td>
<td>
<p>Number of simulations to be carried out.</p>
</td></tr>
<tr><td><code id="BICandbootstrapsim_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap replications for each simulation</p>
</td></tr>
<tr><td><code id="BICandbootstrapsim_+3A_pthresh">pthresh</code></td>
<td>
<p>p-value threshold used in <code><a href="#topic+estimatepopulation.0">estimatepopulation.0</a></code>.</p>
</td></tr>
<tr><td><code id="BICandbootstrapsim_+3A_iseed">iseed</code></td>
<td>
<p>seed for initialization.</p>
</td></tr>
<tr><td><code id="BICandbootstrapsim_+3A_alpha">alpha</code></td>
<td>
<p>bootstrap quantiles of interests.</p>
</td></tr>
<tr><td><code id="BICandbootstrapsim_+3A_noninformativelist">noninformativelist</code></td>
<td>
<p>if <code>noninformativelist=TRUE</code> then each generated data set in the simulation study (including all bootstrap replications)
will be passed to <code><a href="#topic+removenoninformativelists">removenoninformativelists</a></code>.</p>
</td></tr>
<tr><td><code id="BICandbootstrapsim_+3A_verbose">verbose</code></td>
<td>
<p>If <code>verbose=FALSE</code>, then the progress of the simulation will not show.
If <code>verbose=TRUE</code>, then the progress of the simulation will be shown.</p>
</td></tr>
<tr><td><code id="BICandbootstrapsim_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components as below
</p>
<p><code>popest</code> Total population point estimate from the original data using
<code>estimatepopulation.0</code> with default threshold.
</p>
<p><code>BICmodels</code> The best model chosen by the BIC at each simulation.
</p>
<p><code>BICvals</code> Point estimates of the total population and standard error of the best model chosen by the BIC at each simulation.
</p>
<p><code>simreps</code> Counts associated to each capture history at each simulation.
</p>
<p><code>modelmat</code> A full capture history matrix excluding the row corresponding to the dark figure.
</p>
<p><code>popestsim</code> Total population estimate given by the BCa method in each simulation.
</p>
<p><code>BCaquantiles</code> bootstrap confidence intervals given by the BCa method.
</p>
<p><code>BICconf</code> confidence interval given by the BIC method.
</p>


<h3>References</h3>

<p>Chan, L., Silverman, B. W., and Vincent, K. (2019).
Multiple Systems Estimation for Sparse Capture Data: Inferential Challenges when there are Non-Overlapping Lists.
Available from <a href="https://arxiv.org/abs/1902.05156">https://arxiv.org/abs/1902.05156</a>.
</p>
<p>DiCiccio, T. J. and Efron, B. (1996). Bootstrap Confidence Intervals. <em>Statistical Science</em>, <strong>40(3)</strong>, 189-228.
</p>
<p>Rivest, L-P. and Baillargeon, S. (2014) Rcapture. CRAN package. Available from Available from <a href="https://CRAN.R-project.org/package=Rcapture">https://CRAN.R-project.org/package=Rcapture</a>.
</p>

<hr>
<h2 id='buildmodel'>Build model for multiple systems estimation</h2><span id='topic+buildmodel'></span>

<h3>Description</h3>

<p>For multiple systems estimation model corresponding to a specified set of two-list effects,
set up the GLM model formula and data matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildmodel(zdat, mX)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="buildmodel_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero counts.</p>
</td></tr>
<tr><td><code id="buildmodel_+3A_mx">mX</code></td>
<td>
<p>A <code class="reqn">2 \times k</code> matrix giving the <code class="reqn">k</code> two-list effects to be included in the model.
Each column of <code>mX</code> contains the numbers of the corresponding pair of lists.
If <code>mX = 0</code>, then all two-list effects are included. If <code>mX = NULL</code>, no such effects are included and
the main effects model is fitted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components as below.
</p>
<p><code>datamatrix</code> A matrix with all possible capture histories, other than those equal to or containing non-overlapping pairs
indexed by parameters
that are within the model specified by <code>mX</code>.  A non-overlapping pair is a pair of lists <code class="reqn">(i,j)</code> such that
no case is observed in both lists,
regardless of whether it is present on any other lists.   If <code class="reqn">(i,j)</code> is within the model specified by <code>mX</code>,
all capture histories containing both <code class="reqn">i</code> and <code class="reqn">j</code> are
then excluded.
</p>
<p><code>modelform</code> The model formula suitable to be called by the Generalized Linear Model function <code>glm</code>. Model terms corresponding to
non-overlapping pairs are not included, because they are handled by removing appropriate rows from the data matrix supplied to glm. The list
of non-overlapping pairs are provided in <code>emptyoverlaps</code>. See Chan, Silverman and Vincent (2019) for details.
</p>
<p><code>emptyoverlaps</code> A matrix with two rows, whose columns give the indices of non-overlapping pairs of lists where the parameter indexed by
the pair is within the specified model. The column names give the names of the lists
corresponding to each pair.
</p>


<h3>References</h3>

<p>Chan, L., Silverman, B. W., and Vincent, K. (2019).
Multiple Systems Estimation for Sparse Capture Data: Inferential Challenges when there are Non-Overlapping Lists. Available from <a href="https://arxiv.org/abs/1902.05156">https://arxiv.org/abs/1902.05156</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NewOrl)
buildmodel(NewOrl, mX=NULL)
#Build a matrix that contains all two-list effects
m=dim(Artificial_3)[2]-1
mX = t(expand.grid(1:m, 1:m)); mX = mX[ , mX[1,]&lt;mX[2,]]
# With one two-list effect
buildmodel(NewOrl, mX=mX[,1])
#With three two-list effects
buildmodel(NewOrl, mX=mX[,1:3])

</code></pre>

<hr>
<h2 id='buildmodelmatrix'>Build the model matrix based on particular data, as required to check for identifiability and existence of the maximum likelihood estimate</h2><span id='topic+buildmodelmatrix'></span>

<h3>Description</h3>

<p>This routine builds a model matrix as required by the linear program check <code><a href="#topic+checkident">checkident</a></code> and checks if the matrix is of full rank.
In addition, for each individual list, and for each pair of lists included in the model,
it returns the total count of individuals appearing on the specific list or lists whether or not in combination with other lists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>buildmodelmatrix(zdat, mX = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="buildmodelmatrix_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero count.</p>
</td></tr>
<tr><td><code id="buildmodelmatrix_+3A_mx">mX</code></td>
<td>
<p>A <code class="reqn">2 \times k</code> matrix giving the <code class="reqn">k</code> two-list parameters to be included in the model.
Each column of <code>mX</code> contains the numbers of the corresponding pair of lists.
If <code>mX = 0</code>, then all two-list parameters are included. If <code>mX = NULL</code>, no such parameters are included and
the main effects model is fitted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components as below
</p>
<p><code>modmat</code> The matrix that maps the parameters in the model (excluding any corresponding to non-overlapping lists) to the log expected value
of the counts of capture histories that do not contain non-overlapping pairs in the data.
</p>
<p><code>tvec</code> A vector indexed by the parameters in the model, excluding those corresponding to non-overlapping pairs of lists.  For each parameter
the vector contains the total count of individuals in all the capture histories that include both the lists indexed by that parameter.
</p>
<p><code>rankdef</code> The column rank deficiency of the matrix <code>modmat</code>. If <code>rankdef = 0</code>, the matrix has full column rank.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NewOrl)
buildmodelmatrix(NewOrl, mX=NULL)

</code></pre>

<hr>
<h2 id='checkallmodels'>Check all possible models for existence and identifiability</h2><span id='topic+checkallmodels'></span>

<h3>Description</h3>

<p>This routine efficiently checks whether every possible model
satisfies the conditions for the existence and identifiability of an extended maximum likelihood estimate.
For identifiability it
is only necessary to check the model containing all two-list effects.   For existence, the approach set out in Chan, Silverman and Vincent (2019)
is used. This uses the linear programming approach described in a more general and abstract context by Fienberg and Rinaldo (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkallmodels(zdat, nreport = 1024)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkallmodels_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero count.</p>
</td></tr>
<tr><td><code id="checkallmodels_+3A_nreport">nreport</code></td>
<td>
<p>A message is printed for every <code>nreport</code> models checked.
It gives the number of top level models to be checked altogether, and also the number of models found so far for which the estimate does not exist.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the extended maximum likelihood estimator exists for a particular model, then it will still exist if one or more overlapping pairs are removed from the model.   This allows the search to be carried out efficiently, as follows:
</p>
<p>1. Search over &lsquo;top-level&rsquo; models which contain all overlapping pairs.  The number of such models is <code class="reqn">2^k</code>, where <code class="reqn">k</code> is the number of non-overlapping pairs, because there are <code class="reqn">2^k</code> possible choices of the set of non-overlapping pairs to include in the model.
</p>
<p>2. For each top-level model, if the estimate exists there is no need to consider that model further.  If the estimate does not exist, then a branch search is carried out over the tree structure obtained by successively leaving out overlapping pairs.
</p>


<h3>Value</h3>

<p>The routine prints a message if the model with all two-list parameters is not identifiable.   As set out above, it gives regular progress reports in
the case where there are a large number of models to be checked.
</p>
<p>If all models give estimates which exist, then a message is printed to that effect.
</p>
<p>If there are models for which the estimate does not exist, the routine reports the number of such models and returns a
matrix whose rows give the parameters included in them.
</p>


<h3>References</h3>

<p>Chan, L., Silverman, B. W., and Vincent, K. (2019).
Multiple Systems Estimation for Sparse Capture Data: Inferential Challenges when there are Non-Overlapping Lists.
Available from <a href="https://arxiv.org/abs/1902.05156">https://arxiv.org/abs/1902.05156</a>.
</p>
<p>Fienberg, S. E. and Rinaldo, A. (2012). Maximum likelihood estimation in log-linear
models. <em>Ann. Statist.</em> <strong>40</strong>, 996-1023.  Supplementary material: Technical report, Carnegie Mellon University. Available from <a href="http://www.stat.cmu.edu/~arinaldo/Fienberg_Rinaldo_Supplementary_Material.pdf">http://www.stat.cmu.edu/~arinaldo/Fienberg_Rinaldo_Supplementary_Material.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Artificial_3)
data(Western)
checkallmodels(Artificial_3)
checkallmodels(Western)

</code></pre>

<hr>
<h2 id='checkident'>Check a model for the existence and identifiability of the maximum likelihood estimate</h2><span id='topic+checkident'></span>

<h3>Description</h3>

<p>Apply the linear programming test as derived by Fienberg and Rinaldo (2012), and a calculation of the rank of the design
matrix, to check whether a particular model yields an identifiable maximum likelihood estimate
based on the given data.  The linear programming problem is as described on page 3 of Fienberg and Rinaldo (2012), with a typographical error corrected.
Further details are given by Chan, Silverman and Vincent (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkident(zdat, mX = 0, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkident_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has observed count zero.</p>
</td></tr>
<tr><td><code id="checkident_+3A_mx">mX</code></td>
<td>
<p>A <code class="reqn">2 \times k</code> matrix giving the <code class="reqn">k</code> two-list parameters to be included in the model.
Each column of <code>mX</code> contains the numbers of the corresponding pair of lists.
If <code>mX = 0</code>, then all two-list interactions are included. If <code>mX = NULL</code>, no two-list parameters are included and
the main effects model is fitted.</p>
</td></tr>
<tr><td><code id="checkident_+3A_verbose">verbose</code></td>
<td>
<p>Specifies the output.   If <code>FALSE</code> then the error code is returned.  If <code>TRUE</code> then
in addition the routine prints an error message if the model/data fail either of the two tests, and also
returns both the error code and the <code>lp</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>verbose=FALSE</code>, then return the error code <code>ierr</code> which is 0 if there are no errors, 1 if the linear program test shows that the maximum likelihood
estimate does not exist, 2 if it is not identifiable, and 3 if both tests are failed.
</p>
<p>If <code>verbose=TRUE</code>, then return a list with components as below
</p>
<p><code>ierr</code> As described above.
</p>
<p><code>zlp</code> Linear programming object, in particular giving the value of the objective function at optimum.
</p>


<h3>References</h3>

<p>Chan, L., Silverman, B. W., and Vincent, K. (2019).
Multiple Systems Estimation for Sparse Capture Data: Inferential Challenges when there are Non-Overlapping Lists. Available from <a href="https://arxiv.org/abs/1902.05156">https://arxiv.org/abs/1902.05156</a>.
</p>
<p>Fienberg, S. E. and Rinaldo, A. (2012). Maximum likelihood estimation in log-linear
models. <em>Ann. Statist.</em> <strong>40</strong>, 996-1023.  Supplementary material: Technical report, Carnegie Mellon University. Available from <a href="http://www.stat.cmu.edu/~arinaldo/Fienberg_Rinaldo_Supplementary_Material.pdf">http://www.stat.cmu.edu/~arinaldo/Fienberg_Rinaldo_Supplementary_Material.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Artificial_3)
#Build a matrix that contains all two-list effects
m=dim(Artificial_3)[2]-1
mX = t(expand.grid(1:m, 1:m)); mX = mX[ , mX[1,]&lt;mX[2,]]
# When the model is not identifiable
checkident(Artificial_3,mX=mX, verbose=TRUE)
# When the maximum likelihood estimate does not exist
checkident(Artificial_3, mX=mX[,1],verbose=TRUE)
#Model passes both tests
checkident(Artificial_3, mX=mX[,2:3],verbose=TRUE)

</code></pre>

<hr>
<h2 id='checkthetasubset'>Check a subset of the parameter set theta</h2><span id='topic+checkthetasubset'></span>

<h3>Description</h3>

<p>This routine leaves out a particular set of parameters corresponding to the two-list effects from the parameter set theta.
For the resulting model, it constructs the linear programming
problem to check whether the extended maximum likelihood estimates of the parameters exists. It is called internally by <code>checkallmodels</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkthetasubset(zset, amat, tvec, nlists)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkthetasubset_+3A_zset">zset</code></td>
<td>
<p>set of indices that is not included, numbered among the two-list effects only</p>
</td></tr>
<tr><td><code id="checkthetasubset_+3A_amat">amat</code></td>
<td>
<p>a design matrix</p>
</td></tr>
<tr><td><code id="checkthetasubset_+3A_tvec">tvec</code></td>
<td>
<p>vector of sufficient statistics</p>
</td></tr>
<tr><td><code id="checkthetasubset_+3A_nlists">nlists</code></td>
<td>
<p>number of lists in the original capture-recapture matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the return result is <code>TRUE</code>, the linear program shows that the extended maximum likelihood estimate does not exist.
If the return result is <code>FALSE</code>, the estimate exists.
</p>

<hr>
<h2 id='count_triples'>Count number of triples of overlapping lists</h2><span id='topic+count_triples'></span>

<h3>Description</h3>

<p>The routine counts the number of subsets of size three of lists such that every pair of
lists in the triple overlaps. If the number is zero, then the model with all two-list effects
is unidentifiable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>count_triples(zdat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="count_triples_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero count.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a count of subsets of size three of lists such that every pair of lists in the triple overlaps.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Western)
data(Artificial_3)
count_triples(Western)
count_triples(Artificial_3)

</code></pre>

<hr>
<h2 id='estimatepopulation'>Bootstrapping to evaluate confidence intervals using BCa methods</h2><span id='topic+estimatepopulation'></span>

<h3>Description</h3>

<p>This routine implements the bootstrapping and jacknife approach as detailed in Section 3.3 of Chan, Silverman and Vincent (2019).
It calls the routine <code><a href="#topic+estimatepopulation.0">estimatepopulation.0</a></code> and so is the preferred routine to be called if a user wishes to estimate the
population and obtain BCa confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimatepopulation(zdat, nboot = 1000, pthresh = 0.02, iseed = 1234,
  alpha = c(0.025, 0.05, 0.1, 0.16, 0.84, 0.9, 0.95, 0.975), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimatepopulation_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero count.</p>
</td></tr>
<tr><td><code id="estimatepopulation_+3A_nboot">nboot</code></td>
<td>
<p>Number of bootstrap replications.</p>
</td></tr>
<tr><td><code id="estimatepopulation_+3A_pthresh">pthresh</code></td>
<td>
<p>p-value threshold used in <code><a href="#topic+estimatepopulation.0">estimatepopulation.0</a></code>.</p>
</td></tr>
<tr><td><code id="estimatepopulation_+3A_iseed">iseed</code></td>
<td>
<p>seed for initialisation.</p>
</td></tr>
<tr><td><code id="estimatepopulation_+3A_alpha">alpha</code></td>
<td>
<p>Bootstrap quantiles of interests.</p>
</td></tr>
<tr><td><code id="estimatepopulation_+3A_...">...</code></td>
<td>
<p>other arguments which will be passed to <code><a href="#topic+estimatepopulation.0">estimatepopulation.0</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components as below:
</p>
<p><code>popest</code>  point estimate of the total population of the original data set
</p>
<p><code>MSEfit</code> model fitted to the data, in the format described in <code><a href="#topic+modelfit">modelfit</a></code>
</p>
<p><code>bootreps</code> point estimates of total population sizes from each bootstrap sample
</p>
<p><code>ahat</code> the estimated acceleration factor
</p>
<p><code>BCaquantiles</code> BCa confidence intervals
</p>


<h3>References</h3>

<p>Chan, L., Silverman, B. W., and Vincent, K. (2019).
Multiple Systems Estimation for Sparse Capture Data: Inferential Challenges when there are Non-Overlapping Lists.
Available from <a href="https://arxiv.org/abs/1902.05156">https://arxiv.org/abs/1902.05156</a>.
</p>
<p>DiCiccio, T. J. and Efron, B. (1996). Bootstrap Confidence Intervals. <em>Statistical Science</em>, <strong>40(3)</strong>, 189-228.
</p>

<hr>
<h2 id='estimatepopulation.0'>Estimate the total population including the dark figure.
If the user wishes to find bootstrap confidence intervals then the routine <code><a href="#topic+estimatepopulation">estimatepopulation</a></code> should be used instead.</h2><span id='topic+estimatepopulation.0'></span>

<h3>Description</h3>

<p>This routine estimates the total population size, which includes the dark figure, together with confidence intervals as specified.
It also returns the details of the fitted model.  The user can choose whether to fit main effects only,
to fit a particular model containing specified two-list parameters, or
to choose the model using the stepwise approach described by Chan, Silverman and Vincent (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimatepopulation.0(zdat, method = "stepwise", quantiles = c(0.025,
  0.975), mX = NULL, pthresh = 0.02)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimatepopulation.0_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero count.</p>
</td></tr>
<tr><td><code id="estimatepopulation.0_+3A_method">method</code></td>
<td>
<p>If <code>method = "stepwise"</code> the stepwise method implemented in <code><a href="#topic+stepwisefit">stepwisefit</a></code> is used.  If <code>method = "fixed"</code> then a specified fixed model is used; the model is then given by <code>mX</code>.  If <code>method = "main"</code> then main effects only are fitted.</p>
</td></tr>
<tr><td><code id="estimatepopulation.0_+3A_quantiles">quantiles</code></td>
<td>
<p>Quantiles of interest for confidence intervals.</p>
</td></tr>
<tr><td><code id="estimatepopulation.0_+3A_mx">mX</code></td>
<td>
<p>A <code class="reqn">2 \times k</code> matrix giving the <code class="reqn">k</code> two-list parameters to be included in the model if <code>method = "fixed"</code>.
Each column of <code>mX</code> contains the numbers of the corresponding pair of lists.
If <code>mX = 0</code>, then all two-list parameters are included. If <code>mX = NULL</code>, no two-list parameters are included and
the main effects model is fitted.
If only one two-list parameter is to be fitted, it is sufficient to specify it as a vector of length 2, e.g <code>mX=c(1,3)</code>
for the parameter indexed by lists 1 and 3.   If <code>method</code> is equal to <code>"stepwise"</code> or <code>"main"</code>, then <code>mX</code> is ignored.</p>
</td></tr>
<tr><td><code id="estimatepopulation.0_+3A_pthresh">pthresh</code></td>
<td>
<p>Threshold p-value used if <code>method = "stepwise"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components as below
</p>
<p><code>estimate</code> Point estimate and confidence interval estimates corresponding to specified quantiles.
</p>
<p><code>MSEfit</code> The model fitted to the data in the format described in <code><a href="#topic+modelfit">modelfit</a></code>.
</p>


<h3>References</h3>

<p>Chan, L., Silverman, B. W., and Vincent, K. (2019).
Multiple Systems Estimation for Sparse Capture Data: Inferential Challenges when there are Non-Overlapping Lists.
Available from <a href="https://arxiv.org/abs/1902.05156">https://arxiv.org/abs/1902.05156</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NewOrl)
data(NewOrl_5)
estimatepopulation.0(NewOrl, method="stepwise", quantiles=c(0.025,0.975))
estimatepopulation.0(NewOrl_5, method="main", quantiles=c(0.01, 0.05,0.95, 0.99))

</code></pre>

<hr>
<h2 id='investigateAIC'>Plot of simulation study</h2><span id='topic+investigateAIC'></span>

<h3>Description</h3>

<p>This routine reproduces Figure 1 of Chan, Silverman and Vincent (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>investigateAIC(nsim = 10000, Nsamp = 1000, seed = 1001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="investigateAIC_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulation replications</p>
</td></tr>
<tr><td><code id="investigateAIC_+3A_nsamp">Nsamp</code></td>
<td>
<p>The expected value of the total population size within each simulation</p>
</td></tr>
<tr><td><code id="investigateAIC_+3A_seed">seed</code></td>
<td>
<p>The random number seed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulations are carried out for two different three-list models.
In one model, the probabilities of capture are 0.01, 0.04 and 0.2 for the three lists respectively, while in the other the probability
is 0.3 on all three lists.  In both cases,
captures on the lists occur independently of each other,
so there are no two-list effects.
The first model is chosen to be somewhat more typical of the sparse capture
case, of the kind which often occurs in the human trafficking context,
while the second, more reminiscent of a classical mark-recapture study.
</p>
<p>The probability of an individual having each possible capture history is first evaluated.
Then these probabilities are multiplied by <code>Nsamp = 1000</code> and, for each simulation
replicate, Poisson random values with expectations equal to these values are generated
to give a full set of observed capture histories;
together with the null capture history the expected number of counts
(population size) is equal to <code>Nsamp</code>.
Inference was carried out both for the model with main effects only, and for the model with the addition of
a correlation effect between the first two lists.
The reduction in deviance between the two models was determined. Ten thousand simulations were carried out.
</p>
<p>Checking for compliance with the conditions for existence and identifiability of the
estimates shows that a very small number of the simulations for the sparse model (two out of
ten thousand) fail the checks for existence even within the extended maximum likelihood context.
Detailed investigation shows that in neither of these cases is the dark figure itself not estimable;
although the parameters themselves cannot all be estimated, there is a maximum likelihood estimate
of the expected capture frequencies, and hence the deviance can still be calculated.
</p>
<p>The routine produces QQ-plots
of the resulting deviance reductions against quantiles of the <code class="reqn">\chi^2_1</code> distribution,
for <code>nsim</code> simulation replications.
</p>


<h3>Value</h3>

<p>An <code>nsim</code> <code class="reqn">\times</code> 2 matrix giving the changes in deviance for each replication for each of the two models.
</p>


<h3>References</h3>

<p>Chan, L., Silverman, B. W., and Vincent, K. (2019).
Multiple Systems Estimation for Sparse Capture Data: Inferential Challenges when there are Non-Overlapping Lists. Available from <a href="https://arxiv.org/abs/1902.05156">https://arxiv.org/abs/1902.05156</a>.
</p>

<hr>
<h2 id='modelfit'>Fit a specified model to multiple systems estimation data</h2><span id='topic+modelfit'></span>

<h3>Description</h3>

<p>This routine fits a specified model to multiple systems estimation data, taking account of the possibility of empty overlaps between
pairs of observed lists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelfit(zdat, mX = NULL, check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelfit_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero count.</p>
</td></tr>
<tr><td><code id="modelfit_+3A_mx">mX</code></td>
<td>
<p>A <code class="reqn">2 \times k</code> matrix giving the <code class="reqn">k</code> two-list parameters to be included in the model.
Each column of <code>mX</code> contains the numbers of the corresponding pair of lists.
If <code>mX = 0</code>, then all two-list parameters are included. If <code>mX = NULL</code>, no two-list parameters are included and
the main effects model is fitted.
If only one two-list parameter is to be fitted, it may be specified as a vector of length 2, e.g <code>mX=c(1,3)</code>
for the parameter corresponding to lists 1 and 3.</p>
</td></tr>
<tr><td><code id="modelfit_+3A_check">check</code></td>
<td>
<p>If <code>check = TRUE</code> check first of all if the maximum likelihood
estimate exists and is identifiable, using the routine <code><a href="#topic+checkident">checkident</a></code>.  If either condition fails, print an appropriate error message
and return the error code.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components as below
</p>
<p><code>fit</code> Details of the fit of the specified model as output by <code>glm</code>.  The Akaike information criterion is adjusted to take account
of the number of parameters corresponding to non-overlapping pairs.
</p>
<p><code>emptyoverlaps</code> Matrix with two rows, giving the list pairs within the model for which no cases are observed in common.
Each column gives the indices of a pair of lists, with the names of the lists in the column name.
</p>
<p><code>poisspempty</code> the Poisson p-values of the parameters corresponding to non-overlapping pairs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NewOrl)
modelfit(NewOrl,mX= c(1,3), check=TRUE)

</code></pre>

<hr>
<h2 id='Ned'>The Netherlands data</h2><span id='topic+Ned'></span>

<h3>Description</h3>

<p>Victims related to human trafficking in the Netherlands
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ned
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 24 rows and 7 columns.</p>


<h3>Details</h3>

<p>These data are collected into six lists. Full details are given in Table 2. of Silverman (2019).
</p>


<h3>References</h3>

<p>Silverman, B. W. (2019). Model fitting in Multiple Systems Analysis for the quantification of Modern Slavery: Classical and Bayesian approaches
<em>Journal of Royal Statistical Society: Series A to appear</em>.
</p>

<hr>
<h2 id='Ned_5'>Netherlands data five list version</h2><span id='topic+Ned_5'></span>

<h3>Description</h3>

<p>Netherlands data consolidated into five lists
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ned_5
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 17 rows and 6 columns.</p>


<h3>Details</h3>

<p>This reduces the Netherlands data <code><a href="#topic+Ned">Ned</a></code> into five lists, constructed by combining
the two smallest lists I and O into a single list.
</p>

<hr>
<h2 id='NewOrl'>New Orleans data</h2><span id='topic+NewOrl'></span>

<h3>Description</h3>

<p>Victims related to human trafficking in Greater New Orleans
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NewOrl
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 19 rows and 9 columns.</p>


<h3>Details</h3>

<p>These data are collected into 8 lists.  For reasons of confidentiality the lists are only labelled as A, B, ..., H.
Full details are given in Bales, Murphy and Silverman (2019).
</p>


<h3>References</h3>

<p>K. Bales, L. Murphy and B. W. Silverman (2019). How many trafficked people are there in Greater New Orleans?
<em>Journal of Human Trafficking, to appear</em>.
</p>

<hr>
<h2 id='NewOrl_5'>New Orleans data five list version</h2><span id='topic+NewOrl_5'></span>

<h3>Description</h3>

<p>New Orleans data consolidated into five lists
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NewOrl_5
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 14 rows and 6 columns.</p>


<h3>Details</h3>

<p>This reduces the New Orleans data <code><a href="#topic+NewOrl">NewOrl</a></code> into five lists, constructed by combining
the four smallest lists B, E, F and G into a single list.
</p>

<hr>
<h2 id='ordercaptures'>Order capture histories</h2><span id='topic+ordercaptures'></span>

<h3>Description</h3>

<p>Given a matrix with capture histories only, the routine orders the capture histories first by the number of
1s in the capture history and then lexicographically by columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordercaptures(zmat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ordercaptures_+3A_zmat">zmat</code></td>
<td>
<p>Data matrix with <code class="reqn">t</code> columns. The <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories observed. Where a capture history is not explicitly listed,
it is assumed that it has observed count zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data matrix that is ordered first by the number of 1s in the capture history
and then lexicographically by columns.
</p>

<hr>
<h2 id='removenoninformativelists'>Remove non-informative list</h2><span id='topic+removenoninformativelists'></span>

<h3>Description</h3>

<p>The routine cleans up the data set by removing any lists that contain no data, any lists which contain all the observed data, and
any list whose results duplicate those of another list.
If as a result the original data set has no list left, it returns a matrix with the value of the total count.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removenoninformativelists(zdat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="removenoninformativelists_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data matrix that contains no duplicate lists, no lists with no data, and no lists that contain all the observed data.
If all lists are removed, the total count is returned.
</p>

<hr>
<h2 id='stepwisefit'>Stepwise fit using Poisson p-values.</h2><span id='topic+stepwisefit'></span>

<h3>Description</h3>

<p>Starting with a model with main effects only, two-list parameters are added one by one.
At each stage the parameter with the lowest p-value is added, provided that p-value is lower than <code>pthresh</code>, and provided that the resulting
model does not fail either of the tests in <code><a href="#topic+checkident">checkident</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stepwisefit(zdat, pthresh = 0.02)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepwisefit_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero count.</p>
</td></tr>
<tr><td><code id="stepwisefit_+3A_pthresh">pthresh</code></td>
<td>
<p>this is the threshold below which the p-value of the newly added parameter needs to be in order to be included in the model.
If <code>pthresh = 0</code> then the model with main effects only is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each candidate two-list parameter for possible addition to the model, the p-value is calculated as follows.
The total of cases occurring on both lists indexed by the parameter (regardless of
whether or not they are on any other lists) is calculated.
On the null hypothesis that the effect is not included in the model, this statistic has a Poisson
distribution whose mean depends on the parameters within the model.    The one-sided Poisson p-value of the observed statistic is calculated.
</p>


<h3>Value</h3>

<p>A list with components as below
</p>
<p><code>fit</code> Details of the fit of the specified model as output by <code>glm</code>.  The Akaike information criterion is adjusted to take account
of the number of parameters corresponding to non-overlapping pairs.
</p>
<p><code>emptyoverlaps</code> Matrix with two rows, giving the list pairs within the model for which no cases are observed in common.
Each column gives the indices of a pair of lists, with the names of the lists in the column name.
</p>
<p><code>poisspempty</code> the Poisson p-values of the parameters corresponding to non-overlapping pairs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NewOrl)
stepwisefit(NewOrl, pthresh=0.02)

</code></pre>

<hr>
<h2 id='subsetsearch'>Search subsets for a property which is inherited in a particular way</h2><span id='topic+subsetsearch'></span>

<h3>Description</h3>

<p>The following routine returns a list of all subsets of a given set for which a specified property is <code>TRUE</code>.
It is assumed that if the property is <code>FALSE</code> for any particular subset, it is also <code>FALSE</code> for all supersets of that subset.
This enables a branch search strategy to be used to obviate the need to search over supersets of subsets already eliminated from consideration.
It is used within the hierarchical search step of <code><a href="#topic+checkallmodels">checkallmodels</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subsetsearch(n, checkfun, testnull = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subsetsearch_+3A_n">n</code></td>
<td>
<p>an integer such that the search is over all subsets of <code class="reqn">\{1,...,n\}</code></p>
</td></tr>
<tr><td><code id="subsetsearch_+3A_checkfun">checkfun</code></td>
<td>
<p>a function which takes arguments <code>zset</code>, a subset of <code class="reqn">\{1,...,n\}</code> and ...
The function returns the value <code>TRUE</code> or <code>FALSE</code>. It needs to have the property that if it is <code>FALSE</code> for any
particular <code>zset</code>, it is also <code>FALSE</code> for all supersets of <code>zset</code>.</p>
</td></tr>
<tr><td><code id="subsetsearch_+3A_testnull">testnull</code></td>
<td>
<p>If <code>TRUE</code>, then include the null subset in the search. If <code>FALSE</code>, do not test the
null subset.</p>
</td></tr>
<tr><td><code id="subsetsearch_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of all subsets for which the value is <code>TRUE</code>
</p>

<hr>
<h2 id='tidylists'>Produce a data matrix with a unique row for each capture history</h2><span id='topic+tidylists'></span>

<h3>Description</h3>

<p>This routine finds rows with the same capture history and consolidates them into a single row whose count is the sum of counts of
the relevant rows.  If <code>includezerocounts = TRUE</code> then it also includes rows for all the capture histories with zero count; otherwise
these are all removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tidylists(zdat, includezerocounts = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tidylists_+3A_zdat">zdat</code></td>
<td>
<p>Data matrix with <code class="reqn">t+1</code> columns. The first <code class="reqn">t</code> columns, each corresponding to a particular list,
are 0s and 1s defining the capture histories
observed. The last column is the count of cases with that particular capture history.
List names A, B, ... are constructed if not supplied. Where a capture history is not explicitly listed,
it is assumed that it has zero count.</p>
</td></tr>
<tr><td><code id="tidylists_+3A_includezerocounts">includezerocounts</code></td>
<td>
<p>If <code>FALSE</code> then remove rows corresponding to capture histories with zero count.
If <code>TRUE</code> then include all possible capture histories including those with zero count,
excluding the all-zero row corresponding to the dark figure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data matrix in the form specified above, including all capture histories with zero counts if  <code>includezerocounts=TRUE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NewOrl)
zdat&lt;-tidylists(NewOrl,includezerocounts=TRUE)

</code></pre>

<hr>
<h2 id='UKdat'>UK data</h2><span id='topic+UKdat'></span>

<h3>Description</h3>

<p>Data from the UK 2013 strategic assessment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UKdat
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 25 rows and 7 columns.</p>


<h3>Details</h3>

<p>This is a table of six lists used in the research <a href="https://tinyurl.com/ydegfjaw">published by the Home Office</a> as part of the strategy leading
to the Modern Slavery Act 2015. The data are considered in six lists, labelled as follows:  LA&ndash;Local authorities; NG&ndash;Non-government organisations;
PF&ndash;Police forces; GO&ndash;Government organisations; GP&ndash;General public; NCA&ndash;National Crime Agency.  Each of the first six columns in the data frame
corresponds to one of these lists.
Each of the rows of the data frame corresponds to a possible combination of lists, with value 1 in the relevant
column if the list is in that particular combination.
The last column of the data frame states the number of cases observed in that particular combination of lists.
Combinations of lists for which zero cases are observed are omitted.
</p>


<h3>References</h3>

<p><a href="https://www.gov.uk/government/publications/modern-slavery-an-application-of-multiple-systems-estimation">https://www.gov.uk/government/publications/modern-slavery-an-application-of-multiple-systems-estimation</a>
</p>

<hr>
<h2 id='UKdat_5'>UK data five list version</h2><span id='topic+UKdat_5'></span>

<h3>Description</h3>

<p>UK data consolidated into five lists
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UKdat_5
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 18 rows and 6 columns.</p>


<h3>Details</h3>

<p>This reduces the UK data <code><a href="#topic+UKdat">UKdat</a></code> into five lists, constructed by combining
the PF and NCA lists into a single PFNCA list
</p>

<hr>
<h2 id='Western'>Victims related to sex trafficking in a U.S. Western site</h2><span id='topic+Western'></span>

<h3>Description</h3>

<p>These data are collected into 5 lists. For reasons of confidentiality the lists are only labelled as A, B, C, D and E. Full details are
given in Farrell, Dank, Kfafian, Lockwood, Pfeffer, Hughes and Vincent (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Western
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 13 rows and 6 columns.</p>


<h3>References</h3>

<p>Farrell, A., Dank, M., Kfafian, M., Lockwood, S., Pfeffer, R., Hughes, A., and Vincent, K. (2019).
Capturing human trafficking victimization through crime reporting. Technical Report 2015-VF-GX-0105, National Institute of Justice. Available from <a href="https://www.ncjrs.gov/pdffiles1/nij/grants/252520.pdf">https://www.ncjrs.gov/pdffiles1/nij/grants/252520.pdf</a>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
