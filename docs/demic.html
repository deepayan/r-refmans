<!DOCTYPE html><html><head><title>Help for package demic</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {demic}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#compare_contig_subsets'><p>Compares contig subset x against contig subset y</p></a></li>
<li><a href='#compare_sample_subsets'><p>Compares sample subset x against sample subset y</p></a></li>
<li><a href='#consist_transfer'><p>A function for data frame integration</p></a></li>
<li><a href='#contig_pca'><p>A function to return the first dimension of PCA on an input matrix</p></a></li>
<li><a href='#ContigCluster1'><p>Contig Cluster 1</p></a></li>
<li><a href='#ContigCluster2'><p>Contig Cluster 2</p></a></li>
<li><a href='#cor_diff'><p>Determine the majority orientation of the input PTR estimates correlations</p></a></li>
<li><a href='#df_transfer'><p>A function for data frame transfer</p></a></li>
<li><a href='#est_ptr'><p>Estimate PTRs using all input data as well as using subsets of contigs and samples</p></a></li>
<li><a href='#est_ptr_on'><p>Tries up to max_attempts times to compare each permutation of removing random</p>
subsets of contigs/samples from X, and returns the PTR estimate if a valid
one comes back from the comparisons</a></li>
<li><a href='#est_ptr_on_all'><p>Estimates PTRs based on the whole input dataset</p></a></li>
<li><a href='#est_ptrs_subset'><p>Get PTR estimates for output of the core pipeline on a subset of data</p></a></li>
<li><a href='#filter_sample'><p>A function for sample filtration</p>
Input requirements: 1. have values in more than half of the contigs 2. average log2(cov) &gt; 0 in all these contigs</a></li>
<li><a href='#get_eptr_stats'><p>Generate a variety of stats on PTR estimates for a given dataset</p></a></li>
<li><a href='#iterate_pipelines'><p>A function for iteration of pipeline until convergence</p></a></li>
<li><a href='#ks'><p>A convenient function for KS test of uniform distribution</p></a></li>
<li><a href='#lm_column'><p>A convenient function for ordinary linear regression on two vectors</p></a></li>
<li><a href='#lme4_model'><p>Run mixed linear model with random effect using lme4</p></a></li>
<li><a href='#max_bin_001'><p>MaxBin2 Cluster 001</p></a></li>
<li><a href='#max_bin_002'><p>MaxBin2 Cluster 002</p></a></li>
<li><a href='#max_bin_003'><p>MaxBin2 Cluster 003</p></a></li>
<li><a href='#pipeline'><p>A function representing the pipeline of four steps</p>
including GC bias correction, sample filtration, PCA and contig filtration</a></li>
<li><a href='#reshape_filtered'><p>A function for reshape to facilitate PCA, removing all contigs with missing values for designated samples</p></a></li>
<li><a href='#select_by_ks_test'><p>A function to remove outlier contigs using KS test</p></a></li>
<li><a href='#test_reasonable'><p>A function to test whether the result is reasonable</p></a></li>
<li><a href='#verify_input'><p>Verify that the input dataframe/matrix is valid</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Dynamic Estimator of Microbial Communities</td>
</tr>
<tr>
<td>Description:</td>
<td>Multi-sample algorithm based on contigs and coverage values, to 
    infer the relative distances of contigs from the replication origin and to 
    accurately compare bacterial growth rates between samples. Yuan Gao and 
    Hongzhe Li (2018) &lt;<a href="https://doi.org/10.1038%2Fs41592-018-0182-0">doi:10.1038/s41592-018-0182-0</a>&gt;.</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4, Matrix (&ge; 1.6-2), reshape2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, lintr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Ulthran/DEMIC">https://github.com/Ulthran/DEMIC</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Ulthran/DEMIC/issues">https://github.com/Ulthran/DEMIC/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-22 21:26:39 UTC; ctbus</td>
</tr>
<tr>
<td>Author:</td>
<td>Yuan Gao [aut, cph],
  Charlie Bushman [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Charlie Bushman &lt;ctbushman@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-22 22:22:47 UTC</td>
</tr>
</table>
<hr>
<h2 id='compare_contig_subsets'>Compares contig subset x against contig subset y</h2><span id='topic+compare_contig_subsets'></span>

<h3>Description</h3>

<p>Compares contig subset x against contig subset y
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_contig_subsets(
  est_ptrs_x,
  est_ptrs_y,
  pipeline_x,
  pipeline_y,
  cor_cutoff,
  max_cor
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_contig_subsets_+3A_est_ptrs_x">est_ptrs_x</code></td>
<td>
<p>PTR estimates from contig subset x</p>
</td></tr>
<tr><td><code id="compare_contig_subsets_+3A_est_ptrs_y">est_ptrs_y</code></td>
<td>
<p>PTR estimates from contig subset y</p>
</td></tr>
<tr><td><code id="compare_contig_subsets_+3A_pipeline_x">pipeline_x</code></td>
<td>
<p>pipeline for contig subset x</p>
</td></tr>
<tr><td><code id="compare_contig_subsets_+3A_pipeline_y">pipeline_y</code></td>
<td>
<p>pipeline for contig subset y</p>
</td></tr>
<tr><td><code id="compare_contig_subsets_+3A_cor_cutoff">cor_cutoff</code></td>
<td>
<p>the correlation cutoff</p>
</td></tr>
<tr><td><code id="compare_contig_subsets_+3A_max_cor">max_cor</code></td>
<td>
<p>the max correlation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named list including the est_ptr dataframe and a max_cor value
</p>

<ul>
<li><p> sample: sample
</p>
</li>
<li><p> est_ptr: PTR estimate
</p>
</li>
<li><p> coefficient: coefficient of linear regression
</p>
</li>
<li><p> pValue: p-value of linear regression
</p>
</li>
<li><p> cor: correlation coefficient
</p>
</li>
<li><p> correctY: corrected coverage
</p>
</li></ul>

<p>max_cor: the max correlation achieved
</p>

<hr>
<h2 id='compare_sample_subsets'>Compares sample subset x against sample subset y</h2><span id='topic+compare_sample_subsets'></span>

<h3>Description</h3>

<p>Compares sample subset x against sample subset y
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_sample_subsets(
  est_ptrs_x,
  est_ptrs_y,
  pipeline_x,
  pipeline_y,
  cor_cutoff,
  max_cor
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_sample_subsets_+3A_est_ptrs_x">est_ptrs_x</code></td>
<td>
<p>PTR estimates from sample subset x</p>
</td></tr>
<tr><td><code id="compare_sample_subsets_+3A_est_ptrs_y">est_ptrs_y</code></td>
<td>
<p>PTR estimates from sample subset y</p>
</td></tr>
<tr><td><code id="compare_sample_subsets_+3A_pipeline_x">pipeline_x</code></td>
<td>
<p>pipeline for sample subset x</p>
</td></tr>
<tr><td><code id="compare_sample_subsets_+3A_pipeline_y">pipeline_y</code></td>
<td>
<p>pipeline for sample subset y</p>
</td></tr>
<tr><td><code id="compare_sample_subsets_+3A_cor_cutoff">cor_cutoff</code></td>
<td>
<p>the correlation cutoff</p>
</td></tr>
<tr><td><code id="compare_sample_subsets_+3A_max_cor">max_cor</code></td>
<td>
<p>the max correlation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named list including the est_ptr dataframe and a max_cor value
</p>

<ul>
<li><p> sample: sample
</p>
</li>
<li><p> est_ptr: PTR estimate
</p>
</li>
<li><p> coefficient: coefficient of linear regression
</p>
</li>
<li><p> pValue: p-value of linear regression
</p>
</li>
<li><p> cor: correlation coefficient
</p>
</li>
<li><p> correctY: corrected coverage
</p>
</li></ul>


<hr>
<h2 id='consist_transfer'>A function for data frame integration</h2><span id='topic+consist_transfer'></span>

<h3>Description</h3>

<p>A function for data frame integration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>consist_transfer(x, y, i)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="consist_transfer_+3A_x">x</code></td>
<td>
<p>first data frame</p>
</td></tr>
<tr><td><code id="consist_transfer_+3A_y">y</code></td>
<td>
<p>second data frame</p>
</td></tr>
<tr><td><code id="consist_transfer_+3A_i">i</code></td>
<td>
<p>'sample' column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with the other column as mean or max of that in the original two
</p>

<hr>
<h2 id='contig_pca'>A function to return the first dimension of PCA on an input matrix</h2><span id='topic+contig_pca'></span>

<h3>Description</h3>

<p>A function to return the first dimension of PCA on an input matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contig_pca(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contig_pca_+3A_x">X</code></td>
<td>
<p>a matrix to undergo PCA</p>
</td></tr>
</table>


<h3>Value</h3>

<p>first dimension of the PCA results
</p>

<hr>
<h2 id='ContigCluster1'>Contig Cluster 1</h2><span id='topic+ContigCluster1'></span>

<h3>Description</h3>

<p>Data associated with DEMIC paper (on SourceForge)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ContigCluster1
</code></pre>


<h3>Format</h3>



<h4><code>ContigCluster1</code></h4>

<p>A data frame with 120,897 rows and 5 columns:
</p>

<dl>
<dt>log_cov</dt><dd><p>Log Coverage for Sliding Windows over Contigs</p>
</dd>
<dt>GC_content</dt><dd><p>GC Content for Sliding Windows over Contigs</p>
</dd>
<dt>sample</dt><dd><p>Sample Name</p>
</dd>
<dt>contig</dt><dd><p>Contig Name</p>
</dd>
<dt>length</dt><dd><p>Length of Contig</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://sourceforge.net/projects/demic/files/">https://sourceforge.net/projects/demic/files/</a>
</p>

<hr>
<h2 id='ContigCluster2'>Contig Cluster 2</h2><span id='topic+ContigCluster2'></span>

<h3>Description</h3>

<p>Data associated with DEMIC paper (on SourceForge)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ContigCluster2
</code></pre>


<h3>Format</h3>



<h4><code>ContigCluster2</code></h4>

<p>A data frame with 66,735 rows and 5 columns:
</p>

<dl>
<dt>log_cov</dt><dd><p>Log Coverage for Sliding Windows over Contigs</p>
</dd>
<dt>GC_content</dt><dd><p>GC Content for Sliding Windows over Contigs</p>
</dd>
<dt>sample</dt><dd><p>Sample Name</p>
</dd>
<dt>contig</dt><dd><p>Contig Name</p>
</dd>
<dt>length</dt><dd><p>Length of Contig</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://sourceforge.net/projects/demic/files/">https://sourceforge.net/projects/demic/files/</a>
</p>

<hr>
<h2 id='cor_diff'>Determine the majority orientation of the input PTR estimates correlations</h2><span id='topic+cor_diff'></span>

<h3>Description</h3>

<p>Determine the majority orientation of the input PTR estimates correlations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor_diff(Z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor_diff_+3A_z">Z</code></td>
<td>
<p>a vector of values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a minor subset, where each value has the same orientation
</p>

<hr>
<h2 id='df_transfer'>A function for data frame transfer</h2><span id='topic+df_transfer'></span>

<h3>Description</h3>

<p>A function for data frame transfer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_transfer(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_transfer_+3A_x">x</code></td>
<td>
<p>first data frame with six columns</p>
</td></tr>
<tr><td><code id="df_transfer_+3A_y">y</code></td>
<td>
<p>second data frame with six columns</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with the same six columns but integrated info
</p>

<hr>
<h2 id='est_ptr'>Estimate PTRs using all input data as well as using subsets of contigs and samples</h2><span id='topic+est_ptr'></span>

<h3>Description</h3>

<p>Estimate PTRs using all input data as well as using subsets of contigs and samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_ptr(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_ptr_+3A_x">X</code></td>
<td>
<p>dataframe with coverage matrix
(column names: &quot;log_cov&quot;, &quot;GC_content&quot;, &quot;sample&quot;, &quot;contig&quot;, &quot;length&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named list with results from all three methods
all_ptr dataframe with the estimated PTRs on success, null otherwise
</p>

<ul>
<li><p> est_ptr: estimated PTR values
</p>
</li>
<li><p> coefficient: coefficient of linear regression
</p>
</li>
<li><p> pValue: p-value of linear regression
</p>
</li>
<li><p> cor: correlation coefficient
</p>
</li>
<li><p> correctY: corrected coverage
</p>
</li></ul>

<p>contigs_ptr dataframe with the estimated PTRs on success, null otherwise
</p>

<ul>
<li><p> est_ptr: estimated PTR values
</p>
</li>
<li><p> coefficient: coefficient of linear regression
</p>
</li>
<li><p> pValue: p-value of linear regression
</p>
</li>
<li><p> cor: correlation coefficient
</p>
</li>
<li><p> correctY: corrected coverage
</p>
</li></ul>

<p>samples_ptr dataframe with the estimated PTRs on success, null otherwise
</p>

<ul>
<li><p> est_ptr: estimated PTR values
</p>
</li>
<li><p> coefficient: coefficient of linear regression
</p>
</li>
<li><p> pValue: p-value of linear regression
</p>
</li>
<li><p> cor: correlation coefficient
</p>
</li>
<li><p> correctY: corrected coverage
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>est_ptrs_001 &lt;- est_ptr(max_bin_003)
est_ptrs_001

</code></pre>

<hr>
<h2 id='est_ptr_on'>Tries up to max_attempts times to compare each permutation of removing random
subsets of contigs/samples from X, and returns the PTR estimate if a valid
one comes back from the comparisons</h2><span id='topic+est_ptr_on'></span>

<h3>Description</h3>

<p>Requires a minimum of 2 * num_subsets contigs/samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_ptr_on(X, subset_on, max_attempts = 10, num_subsets = 3, cor_cutoff = 0.98)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_ptr_on_+3A_x">X</code></td>
<td>
<p>cov3 dataframe</p>
</td></tr>
<tr><td><code id="est_ptr_on_+3A_subset_on">subset_on</code></td>
<td>
<p>either &quot;contig&quot; or &quot;sample&quot;</p>
</td></tr>
<tr><td><code id="est_ptr_on_+3A_max_attempts">max_attempts</code></td>
<td>
<p>max number of attempts to find a valid ptr estimate</p>
</td></tr>
<tr><td><code id="est_ptr_on_+3A_num_subsets">num_subsets</code></td>
<td>
<p>number of subsets to split contigs/samples into</p>
</td></tr>
<tr><td><code id="est_ptr_on_+3A_cor_cutoff">cor_cutoff</code></td>
<td>
<p>minimum correlation coefficient to accept PTR estimate</p>
</td></tr>
</table>


<h3>Value</h3>

<p>est_ptrs dataframe on success, null otherwise
</p>

<ul>
<li><p> est_ptr: estimated PTR values
</p>
</li>
<li><p> coefficient: coefficient of linear regression
</p>
</li>
<li><p> pValue: p-value of linear regression
</p>
</li>
<li><p> cor: correlation coefficient
</p>
</li>
<li><p> correctY: corrected coverage
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>est_ptrs_001_on_contigs &lt;- est_ptr_on(max_bin_003, "contig", num_subsets = 5)
est_ptrs_001_on_contigs

est_ptrs_001_on_samples &lt;- est_ptr_on(max_bin_003, "sample")
is.null(est_ptrs_001_on_samples)

</code></pre>

<hr>
<h2 id='est_ptr_on_all'>Estimates PTRs based on the whole input dataset</h2><span id='topic+est_ptr_on_all'></span>

<h3>Description</h3>

<p>Estimates PTRs based on the whole input dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_ptr_on_all(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_ptr_on_all_+3A_x">X</code></td>
<td>
<p>cov3 dataframe</p>
</td></tr>
</table>


<h3>Value</h3>

<p>est_ptrs dataframe on success, null otherwise
</p>

<ul>
<li><p> est_ptr: estimated PTR values
</p>
</li>
<li><p> coefficient: coefficient of linear regression
</p>
</li>
<li><p> pValue: p-value of linear regression
</p>
</li>
<li><p> cor: correlation coefficient
</p>
</li>
<li><p> correctY: corrected coverage
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>est_ptrs_001 &lt;- est_ptr_on_all(max_bin_003)
est_ptrs_001

</code></pre>

<hr>
<h2 id='est_ptrs_subset'>Get PTR estimates for output of the core pipeline on a subset of data</h2><span id='topic+est_ptrs_subset'></span>

<h3>Description</h3>

<p>Get PTR estimates for output of the core pipeline on a subset of data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_ptrs_subset(p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_ptrs_subset_+3A_p">p</code></td>
<td>
<p>is the pipeline named list</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe
</p>

<ul>
<li><p> sample: sample
</p>
</li>
<li><p> est_ptr: PTR estimate
</p>
</li>
<li><p> coefficient: coefficient of linear regression
</p>
</li>
<li><p> pValue: p-value of linear regression
</p>
</li>
<li><p> cor: correlation coefficient
</p>
</li>
<li><p> correctY: corrected coverage
</p>
</li></ul>


<hr>
<h2 id='filter_sample'>A function for sample filtration
Input requirements: 1. have values in more than half of the contigs 2. average log2(cov) &gt; 0 in all these contigs</h2><span id='topic+filter_sample'></span>

<h3>Description</h3>

<p>A function for sample filtration
Input requirements: 1. have values in more than half of the contigs 2. average log2(cov) &gt; 0 in all these contigs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_sample(Z, avg_cutoff, cutoff_ratio)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_sample_+3A_z">Z</code></td>
<td>
<p>a matrix</p>
</td></tr>
<tr><td><code id="filter_sample_+3A_avg_cutoff">avg_cutoff</code></td>
<td>
<p>threshold of average</p>
</td></tr>
<tr><td><code id="filter_sample_+3A_cutoff_ratio">cutoff_ratio</code></td>
<td>
<p>threshold of ratio</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the coefficient and p value of linear regression
</p>

<hr>
<h2 id='get_eptr_stats'>Generate a variety of stats on PTR estimates for a given dataset</h2><span id='topic+get_eptr_stats'></span>

<h3>Description</h3>

<p>Generate a variety of stats on PTR estimates for a given dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_eptr_stats(X, iterations = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_eptr_stats_+3A_x">X</code></td>
<td>
<p>cov3 dataframe</p>
</td></tr>
<tr><td><code id="get_eptr_stats_+3A_iterations">iterations</code></td>
<td>
<p>number of iterations to run</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named list of stats on PTR estimates
</p>

<ul>
<li><p> all_sd: standard deviation of PTR estimates from all method
</p>
</li>
<li><p> all_mean: mean of PTR estimates from all method
</p>
</li>
<li><p> contigs_sd: standard deviation of PTR estimates from contigs method
</p>
</li>
<li><p> contigs_mean: mean of PTR estimates from contigs method
</p>
</li>
<li><p> samples_sd: standard deviation of PTR estimates from samples method
</p>
</li>
<li><p> samples_mean: mean of PTR estimates from samples method
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>stats &lt;- get_eptr_stats(max_bin_001[max_bin_001$sample %in% c('Akk0_001', 'Akk1_001'), ], 2)
stats

</code></pre>

<hr>
<h2 id='iterate_pipelines'>A function for iteration of pipeline until convergence</h2><span id='topic+iterate_pipelines'></span>

<h3>Description</h3>

<p>A function for iteration of pipeline until convergence
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iterate_pipelines(Z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iterate_pipelines_+3A_z">Z</code></td>
<td>
<p>a matrix of coverages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named list
</p>

<ul>
<li><p> samples: vector of final filtered samples
</p>
</li>
<li><p> correct_ys: matrix of sample, contig and corrected coverages
</p>
</li>
<li><p> pc1: matrix of contig and PC1 values
</p>
</li>
<li><p> pc1_range: vector of PC1 range
</p>
</li>
<li><p> samples_y: samples filtered for reliable coverage
</p>
</li></ul>


<hr>
<h2 id='ks'>A convenient function for KS test of uniform distribution</h2><span id='topic+ks'></span>

<h3>Description</h3>

<p>A convenient function for KS test of uniform distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ks(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ks_+3A_x">x</code></td>
<td>
<p>a vector without NA</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the p value of KS test
</p>

<hr>
<h2 id='lm_column'>A convenient function for ordinary linear regression on two vectors</h2><span id='topic+lm_column'></span>

<h3>Description</h3>

<p>A convenient function for ordinary linear regression on two vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lm_column(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lm_column_+3A_x">x</code></td>
<td>
<p>first vector</p>
</td></tr>
<tr><td><code id="lm_column_+3A_y">y</code></td>
<td>
<p>second vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the coefficient and p value of linear regression
</p>

<hr>
<h2 id='lme4_model'>Run mixed linear model with random effect using lme4</h2><span id='topic+lme4_model'></span>

<h3>Description</h3>

<p>Run mixed linear model with random effect using lme4
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lme4_model(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lme4_model_+3A_x">X</code></td>
<td>
<p>input data frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe
</p>

<hr>
<h2 id='max_bin_001'>MaxBin2 Cluster 001</h2><span id='topic+max_bin_001'></span>

<h3>Description</h3>

<p>Generated by PyCov3 on simulated test data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>max_bin_001
</code></pre>


<h3>Format</h3>



<h4><code>max_bin_001</code></h4>

<p>A data frame with 79,740 rows and 5 columns:
</p>

<dl>
<dt>log_cov</dt><dd><p>Log Coverage for Sliding Windows over Contigs</p>
</dd>
<dt>GC_content</dt><dd><p>GC Content for Sliding Windows over Contigs</p>
</dd>
<dt>sample</dt><dd><p>Sample Name</p>
</dd>
<dt>contig</dt><dd><p>Contig Name</p>
</dd>
<dt>length</dt><dd><p>Length of Contig</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://sourceforge.net/projects/demic/files/">https://sourceforge.net/projects/demic/files/</a>
</p>

<hr>
<h2 id='max_bin_002'>MaxBin2 Cluster 002</h2><span id='topic+max_bin_002'></span>

<h3>Description</h3>

<p>Generated by PyCov3 on simulated test data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>max_bin_002
</code></pre>


<h3>Format</h3>



<h4><code>max_bin_002</code></h4>

<p>A data frame with 148,638 rows and 5 columns:
</p>

<dl>
<dt>log_cov</dt><dd><p>Log Coverage for Sliding Windows over Contigs</p>
</dd>
<dt>GC_content</dt><dd><p>GC Content for Sliding Windows over Contigs</p>
</dd>
<dt>sample</dt><dd><p>Sample Name</p>
</dd>
<dt>contig</dt><dd><p>Contig Name</p>
</dd>
<dt>length</dt><dd><p>Length of Contig</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://sourceforge.net/projects/demic/files/">https://sourceforge.net/projects/demic/files/</a>
</p>

<hr>
<h2 id='max_bin_003'>MaxBin2 Cluster 003</h2><span id='topic+max_bin_003'></span>

<h3>Description</h3>

<p>Generated by PyCov3 on simulated test data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>max_bin_003
</code></pre>


<h3>Format</h3>



<h4><code>max_bin_003</code></h4>

<p>A data frame with 124,578 rows and 5 columns:
</p>

<dl>
<dt>log_cov</dt><dd><p>Log Coverage for Sliding Windows over Contigs</p>
</dd>
<dt>GC_content</dt><dd><p>GC Content for Sliding Windows over Contigs</p>
</dd>
<dt>sample</dt><dd><p>Sample Name</p>
</dd>
<dt>contig</dt><dd><p>Contig Name</p>
</dd>
<dt>length</dt><dd><p>Length of Contig</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://sourceforge.net/projects/demic/files/">https://sourceforge.net/projects/demic/files/</a>
</p>

<hr>
<h2 id='pipeline'>A function representing the pipeline of four steps
including GC bias correction, sample filtration, PCA and contig filtration</h2><span id='topic+pipeline'></span>

<h3>Description</h3>

<p>A function representing the pipeline of four steps
including GC bias correction, sample filtration, PCA and contig filtration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pipeline(Y, i)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pipeline_+3A_y">Y</code></td>
<td>
<p>a matrix of coverages</p>
</td></tr>
<tr><td><code id="pipeline_+3A_i">i</code></td>
<td>
<p>cutoff of filtering samples changes according to parameter i; i=1, cutoffRatio is 0.5; i=2, cutoffRatio is 1 as contig is clean</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named list
</p>

<ul>
<li><p> samples: final list of filtered samples
</p>
</li>
<li><p> correct_ys: dataframe with correct Y values per contig/sample
</p>
</li>
<li><p> pc1: PC1 results of PCA per contig
</p>
</li>
<li><p> pc1_range: range of PC1
</p>
</li>
<li><p> samples_y: samples filtered for reliable coverage
</p>
</li></ul>


<hr>
<h2 id='reshape_filtered'>A function for reshape to facilitate PCA, removing all contigs with missing values for designated samples</h2><span id='topic+reshape_filtered'></span>

<h3>Description</h3>

<p>A function for reshape to facilitate PCA, removing all contigs with missing values for designated samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reshape_filtered(samples_filtered, Z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reshape_filtered_+3A_samples_filtered">samples_filtered</code></td>
<td>
<p>a vector of samples</p>
</td></tr>
<tr><td><code id="reshape_filtered_+3A_z">Z</code></td>
<td>
<p>a matrix of coverage</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a reshaped matrix of coverage
</p>

<hr>
<h2 id='select_by_ks_test'>A function to remove outlier contigs using KS test</h2><span id='topic+select_by_ks_test'></span>

<h3>Description</h3>

<p>A function to remove outlier contigs using KS test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_by_ks_test(sort_values)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_by_ks_test_+3A_sort_values">sort_values</code></td>
<td>
<p>a vector of sorted values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector with all values following a uniform distribution
</p>

<hr>
<h2 id='test_reasonable'>A function to test whether the result is reasonable</h2><span id='topic+test_reasonable'></span>

<h3>Description</h3>

<p>A function to test whether the result is reasonable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_reasonable(a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_reasonable_+3A_a">a</code></td>
<td>
<p>first vector of values</p>
</td></tr>
<tr><td><code id="test_reasonable_+3A_b">b</code></td>
<td>
<p>second vector of values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the test result
</p>

<hr>
<h2 id='verify_input'>Verify that the input dataframe/matrix is valid</h2><span id='topic+verify_input'></span>

<h3>Description</h3>

<p>Verify that the input dataframe/matrix is valid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verify_input(X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="verify_input_+3A_x">X</code></td>
<td>
<p>dataframe/matrix with cov3 information</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
