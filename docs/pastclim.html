<!DOCTYPE html><html><head><title>Help for package pastclim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pastclim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.cv'><p>Coefficient of variation (expressed as percentage)</p></a></li>
<li><a href='#Barreto2023'><p>Documentation for the Barreto et al 2023 dataset</p></a></li>
<li><a href='#Beyer2020'><p>Documentation for the Beyer2020 dataset</p></a></li>
<li><a href='#bioclim_vars'><p>Compute bioclimatic variables</p></a></li>
<li><a href='#check_available_dataset'><p>Check if dataset is available.</p></a></li>
<li><a href='#check_available_variable'><p>Check if var is available for this dataset.</p></a></li>
<li><a href='#check_coords_names'><p>Check that we have a valid pair of coordinate names</p></a></li>
<li><a href='#check_dataset_path'><p>Check dataset and path_to_nc params</p></a></li>
<li><a href='#check_time_vars'><p>Check multiple time variables</p></a></li>
<li><a href='#check_var_downloaded'><p>Internal function to check whether we have downloaded a given variable</p>
for a dataset</a></li>
<li><a href='#check_var_in_nc'><p>Check whether variables exist in a netcdf file</p></a></li>
<li><a href='#clean_data_path'><p>Clean the data path</p></a></li>
<li><a href='#climate_for_locations'><p>Extract local climate for one or more locations for a given time slice.</p></a></li>
<li><a href='#climate_for_time_slice'><p>Extract a climate slice for a region</p></a></li>
<li><a href='#copy_example_data'><p>Internal function to copy the example dataset when a new data path is set</p></a></li>
<li><a href='#df_from_region_series'><p>Extract data frame from a region series</p></a></li>
<li><a href='#df_from_region_slice'><p>Extract data frame from a region slice</p></a></li>
<li><a href='#distance_from_sea'><p>Compute a raster of distances from the sea for each land pixel.</p></a></li>
<li><a href='#download_chelsa'><p>Download the CHELSA modern observations.</p></a></li>
<li><a href='#download_dataset'><p>Download palaeoclimate reconstructions.</p></a></li>
<li><a href='#download_etopo'><p>Download the ETOPO Global relief model</p></a></li>
<li><a href='#download_worldclim_future'><p>Download a WorldClim future predictions.</p></a></li>
<li><a href='#download_worldclim_present'><p>Download a WorldClim modern observations.</p></a></li>
<li><a href='#Example'><p>Documentation for the Example dataset</p></a></li>
<li><a href='#get_available_datasets'><p>Get the available datasets.</p></a></li>
<li><a href='#get_biome_classes'><p>Get the biome classes for a dataset.</p></a></li>
<li><a href='#get_data_path'><p>Get the data path where climate reconstructions are stored</p></a></li>
<li><a href='#get_dataset_info'><p>Get the information about a dataset</p></a></li>
<li><a href='#get_downloaded_datasets'><p>Get the variables downloaded for each dataset.</p></a></li>
<li><a href='#get_file_for_dataset'><p>Get the file details for a variable and dataset.</p></a></li>
<li><a href='#get_ice_mask'><p>Get the ice mask for a dataset.</p></a></li>
<li><a href='#get_land_mask'><p>Get the land mask for a dataset.</p></a></li>
<li><a href='#get_mis_time_steps'><p>Get time steps for a given MIS</p></a></li>
<li><a href='#get_sea_level'><p>Get sea level estimate</p></a></li>
<li><a href='#get_time_bp_steps'><p>Get time steps for a given dataset</p></a></li>
<li><a href='#get_varname'><p>Get a the varname for this variable</p></a></li>
<li><a href='#get_vars_for_dataset'><p>Get a list of variables for a given dataset.</p></a></li>
<li><a href='#help_console'><p>Print help to console</p></a></li>
<li><a href='#HYDE_3.3_baseline'><p>Documentation for HYDE 3.3 dataset</p></a></li>
<li><a href='#is_region_series'><p>Check the object is a valid region series</p></a></li>
<li><a href='#Krapp2021'><p>Documentation for the Krapp2021 dataset</p></a></li>
<li><a href='#list_available_datasets'><p>List all the available datasets.</p></a></li>
<li><a href='#load_dataset_list'><p>Load the dataset list</p></a></li>
<li><a href='#load_etopo'><p>Load the ETOPO global relief</p></a></li>
<li><a href='#location_series'><p>Extract a time series of bioclimatic variables for one or more locations.</p></a></li>
<li><a href='#location_slice'><p>Extract local climate for one or more locations for a given time slice.</p></a></li>
<li><a href='#location_slice_from_region_series'><p>Extract local climate for one or more locations for a given time slice.</p></a></li>
<li><a href='#make_binary_mask'><p>Create a binary mask</p></a></li>
<li><a href='#make_ice_mask'><p>Downscale an ice mask</p></a></li>
<li><a href='#make_land_mask'><p>Create a land mask</p></a></li>
<li><a href='#mis_boundaries'><p>Time boundaries of marine isotope stages (MIS).</p></a></li>
<li><a href='#mode'><p>Mode</p></a></li>
<li><a href='#pastclim'><p>pastclim</p></a></li>
<li><a href='#region_extent'><p>Region extents.</p></a></li>
<li><a href='#region_outline'><p>Region outlines.</p></a></li>
<li><a href='#region_outline_union'><p>Region outlines unioned.</p></a></li>
<li><a href='#region_series'><p>Extract a time series of climate variables for a region</p></a></li>
<li><a href='#region_slice'><p>Extract a climate slice for a region</p></a></li>
<li><a href='#sample_region_series'><p>Sample points from a region time series</p></a></li>
<li><a href='#sample_region_slice'><p>Sample points from a region time slice</p></a></li>
<li><a href='#sample_rs_fixed'><p>Sample the same locations from a region time series</p></a></li>
<li><a href='#sample_rs_variable'><p>Sample the different number of points from a region time series</p></a></li>
<li><a href='#set_data_path'><p>Set the data path where climate reconstructions will be stored</p></a></li>
<li><a href='#slice_region_series'><p>Extract a slice for a time series of climate variables for a region</p></a></li>
<li><a href='#time_bp'><p>Extract and set time in years before present for SpatRaster and SpatRasterDataset</p></a></li>
<li><a href='#time_bp_to_i_series'><p>Convert a time BP to indexes for a series</p></a></li>
<li><a href='#time_bp_to_index'><p>Find the closest index to a given time in years BP</p></a></li>
<li><a href='#time_series_for_locations'><p>Extract a time series of bioclimatic variables for one or more locations.</p></a></li>
<li><a href='#update_dataset_list'><p>Update the dataset list</p></a></li>
<li><a href='#validate_nc'><p>Validate an netcdf file for pastclim</p></a></li>
<li><a href='#var_labels'><p>Generate pretty variable labels for plotting</p></a></li>
<li><a href='#WorldClim_2.1'><p>Documentation for the WorldClim datasets</p></a></li>
<li><a href='#ybp2date'><p>Convert years BP from pastclim to lubridate date, or vice versa</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Manipulate Time Series of Palaeoclimate Reconstructions</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrea Manica &lt;am315@cam.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Methods to easily extract and manipulate palaeoclimate
  reconstructions for ecological and anthropological analyses, as described
  in Leonardi et al. (2023) &lt;<a href="https://doi.org/10.1111%2Fecog.06481">doi:10.1111/ecog.06481</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/EvolEcolGroup/pastclim">https://github.com/EvolEcolGroup/pastclim</a>,
<a href="https://evolecolgroup.github.io/pastclim/">https://evolecolgroup.github.io/pastclim/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/EvolEcolGroup/pastclim/issues">https://github.com/EvolEcolGroup/pastclim/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), terra (&ge; 1.7.18)</td>
</tr>
<tr>
<td>Imports:</td>
<td>curl, lubridate, methods, ncdf4, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, ggplot2, sf, testthat (&ge; 3.0.0), spelling</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-02 08:44:50 UTC; andrea</td>
</tr>
<tr>
<td>Author:</td>
<td>Michela Leonardi [aut],
  Emily Y. Hallet [ctb],
  Robert Beyer [ctb],
  Mario Krapp [ctb],
  Andrea Manica [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-02 14:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='.cv'>Coefficient of variation (expressed as percentage)</h2><span id='topic+.cv'></span>

<h3>Description</h3>

<p>R function to compute the coefficient of variation
(expressed as a percentage). If there is only a single value, stats::sd = NA.
However, one could argue that cv =0; and NA may break the code that
receives it. The function returns 0 if the mean is close to zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.cv(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".cv_+3A_x">x</code></td>
<td>
<p>a vector of values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is ODD: abs to avoid very small (or zero) mean with e.g. -5:5
</p>


<h3>Value</h3>

<p>the cv
</p>

<hr>
<h2 id='Barreto2023'>Documentation for the Barreto et al 2023 dataset</h2><span id='topic+Barreto2023'></span>

<h3>Description</h3>

<p>Spatio-temporal series of monthly temperature and precipitation and 17
derived bioclimatic variables covering the last 5 Ma (Pliocene–Pleistocene),
at intervals of 1,000 years, and a spatial resolution of 1
arc-degrees (see Barreto et al., 2023 for details).
</p>


<h3>Details</h3>

<p>PALEO-PGEM-Series is downscaled to 1 × 1 arc-degrees spatial resolution from the
outputs of the PALEO-PGEM emulator (Holden et al., 2019), which emulates
reasonable and extensively validated global estimates of monthly temperature
and precipitation for the Plio-Pleistocene every 1 kyr at a spatial
resolution of ~5 × 5 arc-degrees (Holden et al., 2016, 2019).
</p>
<p>PALEO-PGEM-Series includes the mean and the standard deviation (i.e.,
standard error) of the emulated climate over 10 stochastic GCM emulations
to accommodate aspects of model uncertainty. This allows users to estimate
the robustness of their results in the face of the stochastic aspects of
the emulations. For more details, see Section 2.4 in Barreto et al. (2023).
</p>
<p>Note that this is a very large dataset, with 5001 time slices. It takes
approximately 1 minute to set up each variable when creating a region_slice or
region_series. However, once the object has been created, other operations tend
to be much faster (especially if you subset the dataset to a small number
of time steps of interest).
</p>
<p>If you use this dataset, make sure to cite the original publications:
</p>
<p>Barreto, E., Holden, P. B., Edwards, N. R., &amp; Rangel, T. F. (2023).
PALEO-PGEM-Series: A spatial time series of the global climate over the
last 5 million years (Plio-Pleistocene). Global Ecology and
Biogeography, 32, 1034-1045,
<a href="https://doi.org/10.1111/geb.13683">doi:10.1111/geb.13683</a>
</p>
<p>Holden, P. B., Edwards, N. R., Rangel, T. F., Pereira, E. B., Tran, G. T.,
and Wilkinson, R. D. (2019): PALEO-PGEM v1.0: a statistical emulator of
Pliocene–Pleistocene climate, Geosci. Model Dev., 12, 5137–5155,
<a href="https://doi.org/10.5194/gmd-12-5137-2019">doi:10.5194/gmd-12-5137-2019</a>.
</p>

<hr>
<h2 id='Beyer2020'>Documentation for the Beyer2020 dataset</h2><span id='topic+Beyer2020'></span>

<h3>Description</h3>

<p>This dataset covers the last 120k years, at intervals of 1/2 k years, and a
resolution of 0.5 degrees in latitude and longitude.
</p>


<h3>Details</h3>

<p>If you use this dataset, make sure to cite the original publication:
</p>
<p>Beyer, R.M.,
Krapp, M. &amp; Manica, A. High-resolution terrestrial climate, bioclimate and
vegetation for the last 120,000 years. Sci Data 7, 236 (2020).
<a href="https://doi.org/10.1038/s41597-020-0552-1">doi:10.1038/s41597-020-0552-1</a>
</p>
<p>The version included in <code>pastclim</code> has the ice sheets masked, as well as
internal seas (Black and Caspian Sea) removed. The latter are based on:
</p>
<p><a href="https://www.marineregions.org/gazetteer.php?p=details&amp;id=4278">https://www.marineregions.org/gazetteer.php?p=details&amp;id=4278</a>
</p>
<p><a href="https://www.marineregions.org/gazetteer.php?p=details&amp;id=4282">https://www.marineregions.org/gazetteer.php?p=details&amp;id=4282</a>
</p>
<p>As there is no reconstruction of their depth through time, modern outlines
were used for all time steps.
</p>
<p>Also, for bio15, the coefficient of variation was computed after adding one
to monthly estimates, and it was multiplied by 100 following
<a href="https://pubs.usgs.gov/ds/691/ds691.pdf">https://pubs.usgs.gov/ds/691/ds691.pdf</a>
</p>
<p>Changelog
</p>
<p>v1.1.0 Added monthly variables. Files can be downloaded from:
<a href="https://zenodo.org/deposit/7062281">https://zenodo.org/deposit/7062281</a>
</p>
<p>v1.0.0 Remove ice sheets and internal seas, and use correct formula for bio15.
Files can be downloaded from:
<a href="https://doi.org/10.6084/m9.figshare.19723405.v1">doi:10.6084/m9.figshare.19723405.v1</a>
</p>

<hr>
<h2 id='bioclim_vars'>Compute bioclimatic variables</h2><span id='topic+bioclim_vars'></span><span id='topic+bioclim_vars+2Cnumeric+2Cnumeric-method'></span><span id='topic+bioclim_vars+2CSpatRaster+2CSpatRaster-method'></span><span id='topic+bioclim_vars+2CSpatRasterDataset+2CSpatRasterDataset-method'></span><span id='topic+bioclim_vars+2Cmatrix+2Cmatrix-method'></span>

<h3>Description</h3>

<p>Function to compute &quot;bioclimatic&quot; variables from
monthly average temperature and precipitation data. For modern data,
this variables are generally computed using min and maximum temperature,
but for many palaeoclimatic reconstructions only average temperature is
available. Most variables, with the exception of BIO02 and BIO03, can
be rephrased meaningfully in terms of mean temperature.
This function is a modified version of <code>predicts::bcvars</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bioclim_vars(prec, tavg, ...)

## S4 method for signature 'numeric,numeric'
bioclim_vars(prec, tavg)

## S4 method for signature 'SpatRaster,SpatRaster'
bioclim_vars(prec, tavg, filename = "", ...)

## S4 method for signature 'SpatRasterDataset,SpatRasterDataset'
bioclim_vars(prec, tavg, filename = "", ...)

## S4 method for signature 'matrix,matrix'
bioclim_vars(prec, tavg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bioclim_vars_+3A_prec">prec</code></td>
<td>
<p>monthly precipitation</p>
</td></tr>
<tr><td><code id="bioclim_vars_+3A_tavg">tavg</code></td>
<td>
<p>monthly average temperatures</p>
</td></tr>
<tr><td><code id="bioclim_vars_+3A_...">...</code></td>
<td>
<p>additional variables for specific methods</p>
</td></tr>
<tr><td><code id="bioclim_vars_+3A_filename">filename</code></td>
<td>
<p>filename where the raster can be stored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variables are:
</p>

<ul>
<li><p> BIO01 = Annual Mean Temperature
</p>
</li>
<li><p> BIO04 = Temperature Seasonality (standard deviation x 100)
</p>
</li>
<li><p> BIO05 = Max Temperature of Warmest Month
</p>
</li>
<li><p> BIO06 = Min Temperature of Coldest Month
</p>
</li>
<li><p> BIO07 = Temperature Annual Range (P5-P6)
</p>
</li>
<li><p> BIO08 = Mean Temperature of Wettest Quarter
</p>
</li>
<li><p> BIO09 = Mean Temperature of Driest Quarter
</p>
</li>
<li><p> BIO10 = Mean Temperature of Warmest Quarter
</p>
</li>
<li><p> BIO11 = Mean Temperature of Coldest Quarter
</p>
</li>
<li><p> BIO12 = Annual Precipitation
</p>
</li>
<li><p> BIO13 = Precipitation of Wettest Month
</p>
</li>
<li><p> BIO14 = Precipitation of Driest Month
</p>
</li>
<li><p> BIO15 = Precipitation Seasonality (Coefficient of Variation)
</p>
</li>
<li><p> BIO16 = Precipitation of Wettest Quarter
</p>
</li>
<li><p> BIO17 = Precipitation of Driest Quarter
</p>
</li>
<li><p> BIO18 = Precipitation of Warmest Quarter
</p>
</li>
<li><p> BIO19 = Precipitation of Coldest Quarter
</p>
</li></ul>

<p>These summary Bioclimatic variables are after:
</p>
<p>Nix, 1986. A biogeographic analysis of Australian elapid snakes. In: R. Longmore (ed.).
Atlas of elapid snakes of Australia. Australian Flora and Fauna Series 7.
Australian Government Publishing Service, Canberra.
</p>
<p>and expanded following the ANUCLIM manual
</p>


<h3>Value</h3>

<p>the bioclim variables
</p>

<hr>
<h2 id='check_available_dataset'>Check if dataset is available.</h2><span id='topic+check_available_dataset'></span>

<h3>Description</h3>

<p>Internal getter function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_available_dataset(dataset, include_custom = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_available_dataset_+3A_dataset">dataset</code></td>
<td>
<p>string defining dataset</p>
</td></tr>
<tr><td><code id="check_available_dataset_+3A_include_custom">include_custom</code></td>
<td>
<p>boolean whether a 'custom' dataset is allowed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the dataset is available
</p>

<hr>
<h2 id='check_available_variable'>Check if var is available for this dataset.</h2><span id='topic+check_available_variable'></span>

<h3>Description</h3>

<p>Internal getter function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_available_variable(variable, dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_available_variable_+3A_variable">variable</code></td>
<td>
<p>a vector of names of the variables of interest</p>
</td></tr>
<tr><td><code id="check_available_variable_+3A_dataset">dataset</code></td>
<td>
<p>dataset of interest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if var is available
</p>

<hr>
<h2 id='check_coords_names'>Check that we have a valid pair of coordinate names</h2><span id='topic+check_coords_names'></span>

<h3>Description</h3>

<p>This internal function checks that coords (as passed to functions) is a valid
set of names, or, if NULL, that we have standard variable names in data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_coords_names(data, coords)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_coords_names_+3A_data">data</code></td>
<td>
<p>a data.frame containing the locations.</p>
</td></tr>
<tr><td><code id="check_coords_names_+3A_coords">coords</code></td>
<td>
<p>a vector of length two giving the names of the &quot;x&quot; and &quot;y&quot;
coordinates, of points is a data.frame and does not use standard names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length 2 with the valid names, in the correct order
</p>

<hr>
<h2 id='check_dataset_path'>Check dataset and path_to_nc params</h2><span id='topic+check_dataset_path'></span>

<h3>Description</h3>

<p>Check that the dataset and path_to_nc parameters are valid. Specifically,
if <code>path_to_nc</code> should only be set if <code>dataset</code> is <code>custom</code> (and conversely,
<code>custom</code> datasets require a <code>path_to_nc</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_dataset_path(dataset, path_to_nc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_dataset_path_+3A_dataset">dataset</code></td>
<td>
<p>string defining the dataset to use. If set to &quot;custom&quot;,
then a single nc file is used from &quot;path_to_nc&quot;.</p>
</td></tr>
<tr><td><code id="check_dataset_path_+3A_path_to_nc">path_to_nc</code></td>
<td>
<p>the path to the custom nc file containing the palaeoclimate
reconstructions. All the variables of interest need to be included in
this file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if both dataset and path are valid.
</p>

<hr>
<h2 id='check_time_vars'>Check multiple time variables</h2><span id='topic+check_time_vars'></span>

<h3>Description</h3>

<p>Check that we only have one set of times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_time_vars(time_bp, time_ce, allow_null = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_time_vars_+3A_time_bp">time_bp</code></td>
<td>
<p>times in bp</p>
</td></tr>
<tr><td><code id="check_time_vars_+3A_time_ce">time_ce</code></td>
<td>
<p>times in ce</p>
</td></tr>
<tr><td><code id="check_time_vars_+3A_allow_null">allow_null</code></td>
<td>
<p>boolean whether both can be NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>times in bp
</p>

<hr>
<h2 id='check_var_downloaded'>Internal function to check whether we have downloaded a given variable
for a dataset</h2><span id='topic+check_var_downloaded'></span>

<h3>Description</h3>

<p>Internal function to check whether we have downloaded a given variable
for a dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_var_downloaded(variable, dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_var_downloaded_+3A_variable">variable</code></td>
<td>
<p>a vector of names of the variables of interest</p>
</td></tr>
<tr><td><code id="check_var_downloaded_+3A_dataset">dataset</code></td>
<td>
<p>dataset of interest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the variable has been downloaded.
</p>

<hr>
<h2 id='check_var_in_nc'>Check whether variables exist in a netcdf file</h2><span id='topic+check_var_in_nc'></span>

<h3>Description</h3>

<p>Internal function to test a custom nc file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_var_in_nc(bio_variables, path_to_nc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_var_in_nc_+3A_bio_variables">bio_variables</code></td>
<td>
<p>vector of names of variables to be extracted</p>
</td></tr>
<tr><td><code id="check_var_in_nc_+3A_path_to_nc">path_to_nc</code></td>
<td>
<p>the path to the custom nc file containing the palaeoclimate
reconstructions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the variable exists
</p>

<hr>
<h2 id='clean_data_path'>Clean the data path</h2><span id='topic+clean_data_path'></span>

<h3>Description</h3>

<p>This function deletes old reconstructions that have been superseded in the
data_path. It assumes that the only files in data_path are part of <code>pastclim</code>
(i.e. there are no custom datasets stored in that directory).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_data_path(ask = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_data_path_+3A_ask">ask</code></td>
<td>
<p>boolean on whether the user should be asked before deleting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if files are deleted successfully
</p>

<hr>
<h2 id='climate_for_locations'>Extract local climate for one or more locations for a given time slice.</h2><span id='topic+climate_for_locations'></span>

<h3>Description</h3>

<p>Deprecated version of <code><a href="#topic+location_slice">location_slice()</a></code>
</p>
<p>Deprecated version of <code><a href="#topic+location_slice">location_slice()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climate_for_locations(...)

climate_for_locations(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="climate_for_locations_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code><a href="#topic+location_slice">location_slice()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with the climatic variables of interest
</p>
<p>a data.frame with the climatic variables of interest
</p>

<hr>
<h2 id='climate_for_time_slice'>Extract a climate slice for a region</h2><span id='topic+climate_for_time_slice'></span>

<h3>Description</h3>

<p>Deprecated version of region_slice()]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climate_for_time_slice(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="climate_for_time_slice_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code><a href="#topic+region_slice">region_slice()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a
SpatRaster <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> object, with
each variable as a layer.
</p>

<hr>
<h2 id='copy_example_data'>Internal function to copy the example dataset when a new data path is set</h2><span id='topic+copy_example_data'></span>

<h3>Description</h3>

<p>Copy example dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copy_example_data()
</code></pre>


<h3>Value</h3>

<p>TRUE if the data were copied successfully
</p>

<hr>
<h2 id='df_from_region_series'>Extract data frame from a region series</h2><span id='topic+df_from_region_series'></span>

<h3>Description</h3>

<p>Extract the climatic information from a region series and organise them as
a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_from_region_series(x, xy = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_from_region_series_+3A_x">x</code></td>
<td>
<p>climate time series generated with <code><a href="#topic+region_series">region_series()</a></code></p>
</td></tr>
<tr><td><code id="df_from_region_series_+3A_xy">xy</code></td>
<td>
<p>a boolean whether x and y coordinates should be added
to the dataframe (default to TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To extract a data frame from a region slice, see <code><a href="#topic+df_from_region_slice">df_from_region_slice()</a></code>.
</p>


<h3>Value</h3>

<p>a data.frame where each cell each raster layer (i.e. timestep) is a
row, and the available variables are columns.
</p>

<hr>
<h2 id='df_from_region_slice'>Extract data frame from a region slice</h2><span id='topic+df_from_region_slice'></span>

<h3>Description</h3>

<p>Extract the climatic information from a region slice and organise it as
a data frame. This is just a wrapper around <code><a href="terra.html#topic+as.data.frame">terra::as.data.frame()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_from_region_slice(x, xy = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_from_region_slice_+3A_x">x</code></td>
<td>
<p>climate time slice (i.e. a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code>)
generated with <code><a href="#topic+region_slice">region_slice()</a></code></p>
</td></tr>
<tr><td><code id="df_from_region_slice_+3A_xy">xy</code></td>
<td>
<p>a boolean whether x and y coordinates should be added
to the dataframe (default to TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To extract a data frame from a region series, see <code><a href="#topic+df_from_region_series">df_from_region_series()</a></code>.
</p>


<h3>Value</h3>

<p>a data.frame where each cell the raster is a
row, and the available variables are columns.
</p>

<hr>
<h2 id='distance_from_sea'>Compute a raster of distances from the sea for each land pixel.</h2><span id='topic+distance_from_sea'></span>

<h3>Description</h3>

<p>Get the land mask for a dataset at a given time point, and compute distance
from the sea for each land pixel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance_from_sea(time_bp = NULL, time_ce = NULL, dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distance_from_sea_+3A_time_bp">time_bp</code></td>
<td>
<p>time slice in years before present (negative)</p>
</td></tr>
<tr><td><code id="distance_from_sea_+3A_time_ce">time_ce</code></td>
<td>
<p>time slice in years CE.
Only one of <code>time_bp</code> or <code>time_ce</code> should be used.</p>
</td></tr>
<tr><td><code id="distance_from_sea_+3A_dataset">dataset</code></td>
<td>
<p>string defining the dataset to use (a list of possible
values can be obtained with <code><a href="#topic+list_available_datasets">list_available_datasets()</a></code>). This function
will not work on custom datasets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> of distances from the coastline in km
</p>

<hr>
<h2 id='download_chelsa'>Download the CHELSA modern observations.</h2><span id='topic+download_chelsa'></span>

<h3>Description</h3>

<p>This function downloads monthly variables from the CHELSA 2.1 dataset.
These variables are saved in a format that can be read by
load_chelsa, and easily used for delta downscaling palaeoclimate
observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_chelsa(var, res, path = NULL, version = "2.1", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="download_chelsa_+3A_var">var</code></td>
<td>
<p>character Valid variables names are &quot;tas&quot;, &quot;tasmax&quot;,&quot;tasmin&quot;, and
&quot;prec&quot;.</p>
</td></tr>
<tr><td><code id="download_chelsa_+3A_path">path</code></td>
<td>
<p>character. Path where to download the data to. If left NULL, the data
will be downloaded from the directory returned by <code><a href="#topic+get_data_path">get_data_path()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that variables are named differently from WorldClim. &quot;tas&quot; is the mean
temperature (&quot;tavg&quot; in WorldClim), with &quot;tasmax&quot; and &quot;tasmin&quot; being equivalent
to &quot;tmax&quot; and &quot;tmin&quot;.
</p>


<h3>Value</h3>

<p>TRUE if the requested CHELSA variable was downloaded successfully.
</p>

<hr>
<h2 id='download_dataset'>Download palaeoclimate reconstructions.</h2><span id='topic+download_dataset'></span>

<h3>Description</h3>

<p>This function downloads palaeoclimate reconstructions. Files will be stored
in the data path of <code>pastclim</code>, which can be inspected with
<code><a href="#topic+get_data_path">get_data_path()</a></code> and changed with <code><a href="#topic+set_data_path">set_data_path()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_dataset(dataset, bio_variables = NULL, annual = TRUE, monthly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="download_dataset_+3A_dataset">dataset</code></td>
<td>
<p>string defining dataset to be downloaded (a list of possible
values can be obtained with <code><a href="#topic+list_available_datasets">list_available_datasets()</a></code>). This function
will not work on custom datasets.</p>
</td></tr>
<tr><td><code id="download_dataset_+3A_bio_variables">bio_variables</code></td>
<td>
<p>one or more variable names to be downloaded. If left
to NULL, all variables available for this dataset will be downloaded (the
parameters <code>annual</code> and <code>monthly</code>, see below, define which types)</p>
</td></tr>
<tr><td><code id="download_dataset_+3A_annual">annual</code></td>
<td>
<p>boolean to download annual variables</p>
</td></tr>
<tr><td><code id="download_dataset_+3A_monthly">monthly</code></td>
<td>
<p>boolean to download monthly variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the dataset(s) was downloaded correctly.
</p>

<hr>
<h2 id='download_etopo'>Download the ETOPO Global relief model</h2><span id='topic+download_etopo'></span>

<h3>Description</h3>

<p>This function downloads the ETOPO2022 global relief model at 30 or 60 arcsecs
resolution. This is a large file (&gt;1Gb).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_etopo(path = NULL, resolution = 60)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="download_etopo_+3A_path">path</code></td>
<td>
<p>character. Path where to download the data to. If left NULL, the data
will be downloaded from the directory returned by <code><a href="#topic+get_data_path">get_data_path()</a></code>, and automatically
named <code style="white-space: pre;">&#8288;etopo2022_{resolution}s_v1.nc&#8288;</code></p>
</td></tr>
<tr><td><code id="download_etopo_+3A_resolution">resolution</code></td>
<td>
<p>numeric resolution in arcsecs (one of 30, or 60).
Defaults to 60 arcsecs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe produced by <code><a href="curl.html#topic+multi_download">curl::multi_download()</a></code> with information about
the download (including error codes)
</p>

<hr>
<h2 id='download_worldclim_future'>Download a WorldClim future predictions.</h2><span id='topic+download_worldclim_future'></span>

<h3>Description</h3>

<p>This function downloads annual and monthly variables from the WorldClim 2.1
predictions for the future.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_worldclim_future(dataset, bio_var, filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="download_worldclim_future_+3A_dataset">dataset</code></td>
<td>
<p>the name of the dataset</p>
</td></tr>
<tr><td><code id="download_worldclim_future_+3A_bio_var">bio_var</code></td>
<td>
<p>the variable name</p>
</td></tr>
<tr><td><code id="download_worldclim_future_+3A_filename">filename</code></td>
<td>
<p>the file name (full path) of the file to be saved</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the requested WorldClim variable was downloaded successfully
</p>

<hr>
<h2 id='download_worldclim_present'>Download a WorldClim modern observations.</h2><span id='topic+download_worldclim_present'></span>

<h3>Description</h3>

<p>This function downloads annual and monthly variables from the WorldClim 2.1 dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_worldclim_present(dataset, bio_var, filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="download_worldclim_present_+3A_dataset">dataset</code></td>
<td>
<p>the name of the dataset</p>
</td></tr>
<tr><td><code id="download_worldclim_present_+3A_bio_var">bio_var</code></td>
<td>
<p>the variable name</p>
</td></tr>
<tr><td><code id="download_worldclim_present_+3A_filename">filename</code></td>
<td>
<p>the file name (full path) of the file to be saved</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the requested WorldClim variable was downloaded successfully
</p>

<hr>
<h2 id='Example'>Documentation for the Example dataset</h2><span id='topic+Example'></span>

<h3>Description</h3>

<p>This dataset is a subset of Beyer2020, used for the vignette of pastclim.
Do not use this dataset for any real work, as it might not reflect the most
up-to-date version of Beyer2020.
</p>

<hr>
<h2 id='get_available_datasets'>Get the available datasets.</h2><span id='topic+get_available_datasets'></span>

<h3>Description</h3>

<p>List the datasets available in pastclim, which can be passed to functions
in <code>pastclim</code> as values for the parameter <code>dataset</code>. Most functions can also be
used on custom datasets by setting <code>dataset="custom"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_available_datasets()
</code></pre>


<h3>Details</h3>

<p>This function provides a user-friendly list, summarising the many datasets
available from WorldClim. A comprehensive list of all available datasets
can be obtained with <a href="#topic+list_available_datasets">list_available_datasets</a>.
</p>


<h3>Value</h3>

<p>a character vector of the available datasets
</p>

<hr>
<h2 id='get_biome_classes'>Get the biome classes for a dataset.</h2><span id='topic+get_biome_classes'></span>

<h3>Description</h3>

<p>Get a full list of biomes and how their id as coded in the biome variable
for a given dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_biome_classes(dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_biome_classes_+3A_dataset">dataset</code></td>
<td>
<p>string defining dataset to be downloaded (a list of possible
values can be obtained with <code><a href="#topic+list_available_datasets">list_available_datasets()</a></code>). This function
will not work on custom datasets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with columns id and category.
</p>

<hr>
<h2 id='get_data_path'>Get the data path where climate reconstructions are stored</h2><span id='topic+get_data_path'></span>

<h3>Description</h3>

<p>This function returns the path where climate reconstructions are stored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data_path(silent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_data_path_+3A_silent">silent</code></td>
<td>
<p>boolean on whether a message is returned when data_path is
not set (i.e. equal to NULL)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The path is stored in an option for <code>pastclim</code> named <code>data_path</code>. If
a configuration file was saved when using <code><a href="#topic+set_data_path">set_data_path()</a></code>, the path
is retrieved from a file named &quot;pastclim_data.txt&quot;, which
is found in the directory returned by
<code>tools::R_user_dir("pastclim","config")</code> (i.e.
the default configuration directory for the package as set in R &gt;= 4.0).
</p>


<h3>Value</h3>

<p>the data path
</p>

<hr>
<h2 id='get_dataset_info'>Get the information about a dataset</h2><span id='topic+get_dataset_info'></span>

<h3>Description</h3>

<p>This function provides full information about a given dataset. A full
list of datasets available in pastclim can be obtained with
<code><a href="#topic+list_available_datasets">list_available_datasets()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_dataset_info(dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_dataset_info_+3A_dataset">dataset</code></td>
<td>
<p>A dataset in pastclim</p>
</td></tr>
</table>


<h3>Value</h3>

<p>text describing the dataset
</p>

<hr>
<h2 id='get_downloaded_datasets'>Get the variables downloaded for each dataset.</h2><span id='topic+get_downloaded_datasets'></span>

<h3>Description</h3>

<p>List the downloaded variable for each dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_downloaded_datasets(data_path = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_downloaded_datasets_+3A_data_path">data_path</code></td>
<td>
<p>leave it to NULL to use the default data_path</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of variable names per dataset.
</p>

<hr>
<h2 id='get_file_for_dataset'>Get the file details for a variable and dataset.</h2><span id='topic+get_file_for_dataset'></span>

<h3>Description</h3>

<p>Internal getter function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_file_for_dataset(variable, dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_file_for_dataset_+3A_variable">variable</code></td>
<td>
<p>one or more variable names to be downloaded</p>
</td></tr>
<tr><td><code id="get_file_for_dataset_+3A_dataset">dataset</code></td>
<td>
<p>string defining dataset to be downloaded (a list of possible
values can be obtained with <code><a href="#topic+list_available_datasets">list_available_datasets()</a></code>). This function
will not work on custom datasets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the filename for that variable and dataset
</p>

<hr>
<h2 id='get_ice_mask'>Get the ice mask for a dataset.</h2><span id='topic+get_ice_mask'></span>

<h3>Description</h3>

<p>Get the ice mask for a dataset, either for the whole series or for specific
time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ice_mask(time_bp = NULL, dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ice_mask_+3A_time_bp">time_bp</code></td>
<td>
<p>time slices in years before present (negative values represent
time before present, positive values time in the future). This parameter can
be a vector of times (the slices need
to exist in the dataset), a list with a min and max element setting the
range of values, or left to NULL to retrieve all time steps.
To check which slices are available, you can use
<code><a href="#topic+get_time_bp_steps">get_time_bp_steps()</a></code>.</p>
</td></tr>
<tr><td><code id="get_ice_mask_+3A_dataset">dataset</code></td>
<td>
<p>string defining dataset to be downloaded (a list of possible
values can be obtained with <code><a href="#topic+list_available_datasets">list_available_datasets()</a></code>). This function
will not work on custom datasets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a binary <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> with the ice mask as 1s
</p>

<hr>
<h2 id='get_land_mask'>Get the land mask for a dataset.</h2><span id='topic+get_land_mask'></span>

<h3>Description</h3>

<p>Get the land mask for a dataset, either for the whole series or for specific
time points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_land_mask(time_bp = NULL, time_ce = NULL, dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_land_mask_+3A_time_bp">time_bp</code></td>
<td>
<p>time slices in years before present (negative values represent
time before present, positive values time in the future). This parameter can
be a vector of times (the slices need
to exist in the dataset), a list with a min and max element setting the
range of values, or left to NULL to retrieve all time steps.
To check which slices are available, you can use
<code><a href="#topic+get_time_bp_steps">get_time_bp_steps()</a></code>.</p>
</td></tr>
<tr><td><code id="get_land_mask_+3A_time_ce">time_ce</code></td>
<td>
<p>time in years CE as an alternative to <code>time_bp</code>.Only one of
<code>time_bp</code> or <code>time_ce</code> should be used. For available time slices in years CE, use
<code><a href="#topic+get_time_ce_steps">get_time_ce_steps()</a></code>.</p>
</td></tr>
<tr><td><code id="get_land_mask_+3A_dataset">dataset</code></td>
<td>
<p>string defining dataset to be downloaded (a list of possible
values can be obtained with <code><a href="#topic+list_available_datasets">list_available_datasets()</a></code>). This function
will not work on custom datasets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a binary <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> with the land mask as 1s
</p>

<hr>
<h2 id='get_mis_time_steps'>Get time steps for a given MIS</h2><span id='topic+get_mis_time_steps'></span>

<h3>Description</h3>

<p>Get the time steps available in a given dataset for a MIS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mis_time_steps(mis, dataset, path_to_nc = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mis_time_steps_+3A_mis">mis</code></td>
<td>
<p>string giving the mis; it must use the same spelling as used in
<a href="#topic+mis_boundaries">mis_boundaries</a></p>
</td></tr>
<tr><td><code id="get_mis_time_steps_+3A_dataset">dataset</code></td>
<td>
<p>string defining dataset to be downloaded (a list of possible
values can be obtained with <code><a href="#topic+list_available_datasets">list_available_datasets()</a></code>). If set to
&quot;custom&quot;, then a single nc file is used from &quot;path_to_nc&quot;</p>
</td></tr>
<tr><td><code id="get_mis_time_steps_+3A_path_to_nc">path_to_nc</code></td>
<td>
<p>the path to the custom nc file containing the palaeoclimate
reconstructions. All the variables of interest need to be included in
this file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of time steps
</p>

<hr>
<h2 id='get_sea_level'>Get sea level estimate</h2><span id='topic+get_sea_level'></span>

<h3>Description</h3>

<p>This function returns the estimated sea level from Spratt et al. 2016, using
the long PC1. Sea levels are from contemporary sea level (note that the original
data are with reference to the sea level during the Holocene ~5k year ago).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_sea_level(time_bp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_sea_level_+3A_time_bp">time_bp</code></td>
<td>
<p>the time of interest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of sea levels in meters from present level
</p>

<hr>
<h2 id='get_time_bp_steps'>Get time steps for a given dataset</h2><span id='topic+get_time_bp_steps'></span><span id='topic+get_time_ce_steps'></span><span id='topic+get_time_steps'></span>

<h3>Description</h3>

<p>Get the time steps (in time_bp or time_ce) available in a given dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_time_bp_steps(dataset, path_to_nc = NULL)

get_time_ce_steps(dataset, path_to_nc = NULL)

get_time_steps(dataset, path_to_nc = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_time_bp_steps_+3A_dataset">dataset</code></td>
<td>
<p>string defining dataset to be downloaded (a list of possible
values can be obtained with <code><a href="#topic+list_available_datasets">list_available_datasets()</a></code>). If set to
&quot;custom&quot;, then a single nc file is used from &quot;path_to_nc&quot;</p>
</td></tr>
<tr><td><code id="get_time_bp_steps_+3A_path_to_nc">path_to_nc</code></td>
<td>
<p>the path to the custom nc file containing the palaeoclimate
reconstructions. All the variables of interest need to be included in
this file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of time steps (in time_bp, or time_ce)
</p>

<hr>
<h2 id='get_varname'>Get a the varname for this variable</h2><span id='topic+get_varname'></span>

<h3>Description</h3>

<p>Internal function to get the varname for this variable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_varname(variable, dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_varname_+3A_variable">variable</code></td>
<td>
<p>string defining the variable name</p>
</td></tr>
<tr><td><code id="get_varname_+3A_dataset">dataset</code></td>
<td>
<p>string defining dataset to be downloaded</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the name of the variable
</p>

<hr>
<h2 id='get_vars_for_dataset'>Get a list of variables for a given dataset.</h2><span id='topic+get_vars_for_dataset'></span>

<h3>Description</h3>

<p>This function lists the variables available for a given dataset. Note that
the spelling and use of capitals in names might differ from the original
publications, as <code>pastclim</code> harmonises the names of variables across
different reconstructions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_vars_for_dataset(
  dataset,
  path_to_nc = NULL,
  details = FALSE,
  annual = TRUE,
  monthly = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_vars_for_dataset_+3A_dataset">dataset</code></td>
<td>
<p>string defining dataset to be downloaded (a list of possible
values can be obtained with <code><a href="#topic+list_available_datasets">list_available_datasets()</a></code>).</p>
</td></tr>
<tr><td><code id="get_vars_for_dataset_+3A_path_to_nc">path_to_nc</code></td>
<td>
<p>the path to the custom nc file containing the palaeoclimate
reconstructions. If a custom nc file is given, 'details', 'annual' and 'monthly'
are ignored</p>
</td></tr>
<tr><td><code id="get_vars_for_dataset_+3A_details">details</code></td>
<td>
<p>boolean determining whether the output should include information
including long names of variables and their units.</p>
</td></tr>
<tr><td><code id="get_vars_for_dataset_+3A_annual">annual</code></td>
<td>
<p>boolean to show annual variables</p>
</td></tr>
<tr><td><code id="get_vars_for_dataset_+3A_monthly">monthly</code></td>
<td>
<p>boolean to show monthly variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of variable names
</p>

<hr>
<h2 id='help_console'>Print help to console</h2><span id='topic+help_console'></span>

<h3>Description</h3>

<p>This function prints a help file to console. It is based on a function published on
R-bloggers:
from https://www.r-bloggers.com/2013/06/printing-r-help-files-in-the-console-or-in-knitr-documents/
</p>


<h3>Usage</h3>

<pre><code class='language-R'>help_console(
  topic,
  format = c("text", "html", "latex"),
  lines = NULL,
  before = NULL,
  after = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="help_console_+3A_topic">topic</code></td>
<td>
<p>The topic of the help</p>
</td></tr>
<tr><td><code id="help_console_+3A_format">format</code></td>
<td>
<p>how the output should be formatted</p>
</td></tr>
<tr><td><code id="help_console_+3A_lines">lines</code></td>
<td>
<p>which lines should be printed</p>
</td></tr>
<tr><td><code id="help_console_+3A_before">before</code></td>
<td>
<p>string to be printed before the output</p>
</td></tr>
<tr><td><code id="help_console_+3A_after">after</code></td>
<td>
<p>string to be printed after the output</p>
</td></tr>
</table>


<h3>Value</h3>

<p>text of the help file
</p>

<hr>
<h2 id='HYDE_3.3_baseline'>Documentation for HYDE 3.3 dataset</h2><span id='topic+HYDE_3.3_baseline'></span>

<h3>Description</h3>

<p>This database presents an update and expansion of the History Database of
the Global Environment (HYDE, v 3.3) and replaces former HYDE 3.2
version from 2017. HYDE is and internally consistent combination of
updated historical population estimates and land use. Categories
include cropland, with a new distinction into irrigated and rain fed
crops (other than rice) and irrigated and rain fed rice. Also grazing
lands are provided, divided into more intensively used pasture,
converted rangeland and non-converted natural (less intensively used)
rangeland. Population is represented by maps of total, urban, rural
population and population density as well as built-up area.
</p>


<h3>Details</h3>

<p>The period covered is 10 000 BCE to 2023 CE. Spatial resolution is
5 arc minutes (approx. 85 km2 at the equator). The full HYDE 3.3 release
contains: a Baseline estimate scenario, a Lower estimate scenario and an
Upper estimate scenario. Currently only the baseline scenario is available
in <code>pastclim</code>
</p>
<p>If you use this dataset, make sure to cite the original publication
for the HYDE 3.2 (there is no current publication for 3.3):
</p>
<p>Klein Goldewijk, K., Beusen, A., Doelman, J., and Stehfest, E.:
Anthropogenic land-use estimates for the Holocene; HYDE 3.2,
Earth Syst. Sci. Data, 9, 927-953, 2017. <a href="https://doi.org/10.5194/essd-9-1-2017">doi:10.5194/essd-9-1-2017</a>
</p>

<hr>
<h2 id='is_region_series'>Check the object is a valid region series</h2><span id='topic+is_region_series'></span>

<h3>Description</h3>

<p>A region series is a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRasterDataset</a></code> for which each
sub-dataset is a variable, and all variables have the same number of
time steps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_region_series(x, strict = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_region_series_+3A_x">x</code></td>
<td>
<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRasterDataset</a></code> representing a time series of
regional reconstructions obtained from <code><a href="#topic+region_series">region_series()</a></code>.</p>
</td></tr>
<tr><td><code id="is_region_series_+3A_strict">strict</code></td>
<td>
<p>a boolean defining whether to preform a thorough test (see
description above for details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The standard test only checks that all sub-datasets (each of which is a
<code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code>) have the same number of
layers. The more thorough test (obtained with <em>strict=TRUE</em>) actually checks
that all variables have the same identical time steps by comparing the result of
<code><a href="terra.html#topic+time">terra::time()</a></code> applied to each variable.
</p>


<h3>Value</h3>

<p>TRUE if the object is a region series
</p>

<hr>
<h2 id='Krapp2021'>Documentation for the Krapp2021 dataset</h2><span id='topic+Krapp2021'></span>

<h3>Description</h3>

<p>This dataset covers the last 800k years, at intervals of 1k years, and a
resolution of 0.5 degrees in latitude and longitude.
</p>


<h3>Details</h3>

<p>The units of several variables have been changed to match what is used
in WorldClim.
</p>
<p>If you use this dataset, make sure to cite the original publication:
</p>
<p>Krapp, M., Beyer, R.M., Edmundson, S.L. et al. A statistics-based
reconstruction of high-resolution global terrestrial climate for the last
800,000 years. Sci Data 8, 228 (2021).
<a href="https://doi.org/10.1038/s41597-021-01009-3">doi:10.1038/s41597-021-01009-3</a>
</p>
<p>The version included in <code>pastclim</code> has the ice sheets masked.
</p>
<p>Note that, for bio15, we use the corrected version, which follows
<a href="https://pubs.usgs.gov/ds/691/ds691.pdf">https://pubs.usgs.gov/ds/691/ds691.pdf</a>
</p>
<p>Changelog
</p>
<p>v1.4.0 Change units to match WorldClim. Fix variable duplication found
on earlier versions of the dataset. <a href="https://zenodo.org/records/8415273">https://zenodo.org/records/8415273</a>
</p>
<p>v1.1.0 Added monthly variables. Files can be downloaded from:
<a href="https://zenodo.org/record/7065055">https://zenodo.org/record/7065055</a>
</p>
<p>v1.0.0 Remove ice sheets and use correct formula for bio15.
Files can be downloaded from:
<a href="https://doi.org/10.6084/m9.figshare.19733680.v1">doi:10.6084/m9.figshare.19733680.v1</a>
</p>

<hr>
<h2 id='list_available_datasets'>List all the available datasets.</h2><span id='topic+list_available_datasets'></span>

<h3>Description</h3>

<p>List the datasets available in pastclim. The list is comprehensive,
and includes all combinations of models and future scenarios for WorldClim.
For a more user-friendly list, use <code><a href="#topic+get_available_datasets">get_available_datasets()</a></code>. Most functions can also be
used on custom datasets by setting <code>dataset="custom"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_available_datasets()
</code></pre>


<h3>Value</h3>

<p>a character vector of the available datasets
</p>

<hr>
<h2 id='load_dataset_list'>Load the dataset list</h2><span id='topic+load_dataset_list'></span>

<h3>Description</h3>

<p>This function returns a dataframe with the details for each variable
available in every dataset. It defaults to the copy stored within the
package, but it checks in case there is an updated version stored as
'dataset_list_included.csv' in
<code>tools::R_user_dir("pastclim","config")</code>. If the latter is present, the last
column, named 'dataset_list_v', provides the version of this table, and the
most advanced table is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_dataset_list(on_cran = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_dataset_list_+3A_on_cran">on_cran</code></td>
<td>
<p>boolean to make this function run on ci tests using tempdir</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the dataset list
</p>

<hr>
<h2 id='load_etopo'>Load the ETOPO global relief</h2><span id='topic+load_etopo'></span>

<h3>Description</h3>

<p>This function loads previously downloaded ETOPO 2022 global relief dataset, at
30 or 60 arcsec resolution. To save the variables in a compatible
format, use <code><a href="#topic+download_etopo">download_etopo()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_etopo(path = NULL, resolution = 60, version = "1")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_etopo_+3A_path">path</code></td>
<td>
<p>character. Path where the dataset is stored. If left NULL, the data
will be downloaded from the directory returned by <code><a href="#topic+get_data_path">get_data_path()</a></code></p>
</td></tr>
<tr><td><code id="load_etopo_+3A_resolution">resolution</code></td>
<td>
<p>numeric resolution in arcsecs (one of 30, or 60).
Defaults to 60 arcsecs.</p>
</td></tr>
<tr><td><code id="load_etopo_+3A_version">version</code></td>
<td>
<p>character or numeric. The ETOPO2022 version number.
Only &quot;1&quot; supported at the moment</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assumes that the file name is <code style="white-space: pre;">&#8288;etopo2022_{resolution}s_v1.nc&#8288;</code>
</p>


<h3>Value</h3>

<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> of relief
</p>

<hr>
<h2 id='location_series'>Extract a time series of bioclimatic variables for one or more locations.</h2><span id='topic+location_series'></span>

<h3>Description</h3>

<p>This function extract a time series of local climate for
a set of locations. Note that this function does not apply any interpolation
(as opposed to <code><a href="#topic+location_slice">location_slice()</a></code>). If you have a coastal location that just
falls into the water for the reconstructions, you will have to amend the coordinates
to put it more firmly on land.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>location_series(
  x,
  time_bp = NULL,
  time_ce = NULL,
  coords = NULL,
  bio_variables,
  dataset,
  path_to_nc = NULL,
  nn_interpol = FALSE,
  buffer = FALSE,
  directions = 8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="location_series_+3A_x">x</code></td>
<td>
<p>a data.frame with columns of x and y coordinates (and an optional <code>name</code> column),
or a vector of cell numbers. See <code>coords</code> for standard coordinate names, or
how to use custom ones.</p>
</td></tr>
<tr><td><code id="location_series_+3A_time_bp">time_bp</code></td>
<td>
<p>time slices in years before present (negative values represent
time before present, positive values time in the future). This parameter can
be a vector of times (the slices need
to exist in the dataset), a list with a min and max element setting the
range of values, or left to NULL to retrieve all time steps.
To check which slices are available, you can use
<code><a href="#topic+get_time_bp_steps">get_time_bp_steps()</a></code>.</p>
</td></tr>
<tr><td><code id="location_series_+3A_time_ce">time_ce</code></td>
<td>
<p>time slice in years CE (see <code>time_bp</code> for options).
For available time slices in years CE, use <code><a href="#topic+get_time_ce_steps">get_time_ce_steps()</a></code>.
Only one of <code>time_bp</code> or <code>time_ce</code> should be used.</p>
</td></tr>
<tr><td><code id="location_series_+3A_coords">coords</code></td>
<td>
<p>a vector of length two giving the names of the &quot;x&quot; and &quot;y&quot;
coordinates, as found in <code>data</code>. If left to NULL, the function will
try to guess the columns based on standard names <code>c("x", "y")</code>, <code>c("X","Y")</code>,
<code>c("longitude", "latitude")</code>, or <code>c("lon", "lat")</code></p>
</td></tr>
<tr><td><code id="location_series_+3A_bio_variables">bio_variables</code></td>
<td>
<p>vector of names of variables to be extracted.</p>
</td></tr>
<tr><td><code id="location_series_+3A_dataset">dataset</code></td>
<td>
<p>string defining the dataset to use. If set to &quot;custom&quot;,
then a single nc file is used from &quot;path_to_nc&quot;</p>
</td></tr>
<tr><td><code id="location_series_+3A_path_to_nc">path_to_nc</code></td>
<td>
<p>the path to the custom nc file containing the palaeoclimate
reconstructions. All the variables of interest need to be included in
this file.</p>
</td></tr>
<tr><td><code id="location_series_+3A_nn_interpol">nn_interpol</code></td>
<td>
<p>boolean determining whether nearest neighbour
interpolation is used to estimate climate for cells that lack such
information (i.e. they are under water or ice). By default, interpolation is only
performed from the first ring of nearest neighbours; if climate is not
available, NA will be returned for that location. The number of neighbours
can be changed with the argument <code>directions</code>. <code>nn_interpol</code> defaults to FALSE
(this is DIFFERENT from <code><a href="#topic+location_slice">location_slice()</a></code>.</p>
</td></tr>
<tr><td><code id="location_series_+3A_buffer">buffer</code></td>
<td>
<p>boolean determining whether the variable will be returned
as the mean of a buffer around the focal cell. If set to TRUE, it overrides
<code>nn_interpol</code> (which provides the same estimates as <code>buffer</code> but only for
locations that are in cells with an NA). The buffer size is determined
by the argument <code>directions</code>. <code>buffer</code> defaults to FALSE.</p>
</td></tr>
<tr><td><code id="location_series_+3A_directions">directions</code></td>
<td>
<p>character or matrix to indicate the directions in which
cells are considered connected when using <code>nn_interpol</code> or <code>buffer</code>.
The following character values are allowed: &quot;rook&quot; or &quot;4&quot; for the
horizontal and vertical neighbours; &quot;bishop&quot; to get the diagonal neighbours;
&quot;queen&quot; or &quot;8&quot; to get the vertical, horizontal and diagonal neighbours;
or &quot;16&quot; for knight and one-cell queen move neighbours. If directions
is a matrix it should have odd dimensions and have logical (or 0, 1) values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with the climatic variables of interest
</p>

<hr>
<h2 id='location_slice'>Extract local climate for one or more locations for a given time slice.</h2><span id='topic+location_slice'></span>

<h3>Description</h3>

<p>This function extract local climate for a set of locations
at the appropriate times (selecting the closest time slice available for the
specific date associated with each location).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>location_slice(
  x,
  time_bp = NULL,
  time_ce = NULL,
  coords = NULL,
  bio_variables,
  dataset,
  path_to_nc = NULL,
  nn_interpol = TRUE,
  buffer = FALSE,
  directions = 8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="location_slice_+3A_x">x</code></td>
<td>
<p>a data.frame with columns x and y coordinates(see <code>coords</code> for
standard coordinate names, or
how to use custom ones), plus optional
columns <code>time_bp</code> or <code>time_ce</code> (depending on the units used) and
<code>name</code>. Alternatively, a vector of cell numbers.</p>
</td></tr>
<tr><td><code id="location_slice_+3A_time_bp">time_bp</code></td>
<td>
<p>used if no <code>time_bp</code> column is present in <code>x</code>: the dates in
years before present (negative
values represent time before present, i.e. 1950, positive values time in the future)
for each location.</p>
</td></tr>
<tr><td><code id="location_slice_+3A_time_ce">time_ce</code></td>
<td>
<p>time in years CE as an alternative to <code>time_bp</code>.Only one of
<code>time_bp</code> or <code>time_ce</code> should be used.</p>
</td></tr>
<tr><td><code id="location_slice_+3A_coords">coords</code></td>
<td>
<p>a vector of length two giving the names of the &quot;x&quot; and &quot;y&quot;
coordinates, as found in <code>data</code>. If left to NULL, the function will
try to guess the columns based on standard names <code>c("x", "y")</code>, <code>c("X","Y")</code>,
<code>c("longitude", "latitude")</code>, or <code>c("lon", "lat")</code></p>
</td></tr>
<tr><td><code id="location_slice_+3A_bio_variables">bio_variables</code></td>
<td>
<p>vector of names of variables to be extracted.</p>
</td></tr>
<tr><td><code id="location_slice_+3A_dataset">dataset</code></td>
<td>
<p>string defining the dataset to use. If set to &quot;custom&quot;,
then a single nc file is used from &quot;path_to_nc&quot;</p>
</td></tr>
<tr><td><code id="location_slice_+3A_path_to_nc">path_to_nc</code></td>
<td>
<p>the path to the custom nc file containing the palaeoclimate
reconstructions. All the variables of interest need to be included in
this file.</p>
</td></tr>
<tr><td><code id="location_slice_+3A_nn_interpol">nn_interpol</code></td>
<td>
<p>boolean determining whether nearest neighbour
interpolation is used to estimate climate for cells that lack such
information (i.e. they are under water or ice). By default, interpolation is only
performed from the first ring of nearest neighbours; if climate is not
available, NA will be returned for that location. The number of neighbours
can be changed with the argument <code>directions</code>. <code>nn_interpol</code> defaults to TRUE.</p>
</td></tr>
<tr><td><code id="location_slice_+3A_buffer">buffer</code></td>
<td>
<p>boolean determining whether the variable will be returned
as the mean of a buffer around the focal cell. If set to TRUE, it overrides
<code>nn_interpol</code> (which provides the same estimates as <code>buffer</code> but only for
locations that are in cells with an NA). The buffer size is determined
by the argument <code>directions</code>. <code>buffer</code> defaults to FALSE.</p>
</td></tr>
<tr><td><code id="location_slice_+3A_directions">directions</code></td>
<td>
<p>character or matrix to indicate the directions in which
cells are considered connected when using <code>nn_interpol</code> or <code>buffer</code>.
The following character values are allowed: &quot;rook&quot; or &quot;4&quot; for the
horizontal and vertical neighbours; &quot;bishop&quot; to get the diagonal neighbours;
&quot;queen&quot; or &quot;8&quot; to get the vertical, horizontal and diagonal neighbours;
or &quot;16&quot; for knight and one-cell queen move neighbours. If directions
is a matrix it should have odd dimensions and have logical (or 0, 1) values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with the climatic variables of interest.
</p>

<hr>
<h2 id='location_slice_from_region_series'>Extract local climate for one or more locations for a given time slice.</h2><span id='topic+location_slice_from_region_series'></span>

<h3>Description</h3>

<p>This function extract local climate for a set of locations
at the appropriate times (selecting the closest time slice available for the
specific date associated with each location).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>location_slice_from_region_series(
  x,
  time_bp = NULL,
  time_ce = NULL,
  coords = NULL,
  region_series,
  nn_interpol = TRUE,
  buffer = FALSE,
  directions = 8
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="location_slice_from_region_series_+3A_x">x</code></td>
<td>
<p>a data.frame with columns x and y coordinates(see <code>coords</code> for
standard coordinate names, or
how to use custom ones), plus optional
columns <code>time_bp</code> or <code>time_ce</code> (depending on the units used) and
<code>name</code>. Alternatively, a vector of cell numbers.</p>
</td></tr>
<tr><td><code id="location_slice_from_region_series_+3A_time_bp">time_bp</code></td>
<td>
<p>used if no <code>time_bp</code> column is present in <code>x</code>: the dates in
years before present (negative
values represent time before present, i.e. 1950, positive values time in the future)
for each location.</p>
</td></tr>
<tr><td><code id="location_slice_from_region_series_+3A_time_ce">time_ce</code></td>
<td>
<p>time in years CE as an alternative to <code>time_bp</code>. Only one of
<code>time_bp</code> or <code>time_ce</code> should be used.</p>
</td></tr>
<tr><td><code id="location_slice_from_region_series_+3A_coords">coords</code></td>
<td>
<p>a vector of length two giving the names of the &quot;x&quot; and &quot;y&quot;
coordinates, as found in <code>data</code>. If left to NULL, the function will
try to guess the columns based on standard names <code>c("x", "y")</code>, <code>c("X","Y")</code>,
<code>c("longitude", "latitude")</code>, or <code>c("lon", "lat")</code></p>
</td></tr>
<tr><td><code id="location_slice_from_region_series_+3A_region_series">region_series</code></td>
<td>
<p>a <code><a href="terra.html#topic+SpatRasterDataset">SpatRasterDataset</a></code> obtained with <code><a href="#topic+region_series">region_series()</a></code></p>
</td></tr>
<tr><td><code id="location_slice_from_region_series_+3A_nn_interpol">nn_interpol</code></td>
<td>
<p>boolean determining whether nearest neighbour
interpolation is used to estimate climate for cells that lack such
information (i.e. they are under water or ice). By default, interpolation is only
performed from the first ring of nearest neighbours; if climate is not
available, NA will be returned for that location. The number of neighbours
can be changed with the argument <code>directions</code>. <code>nn_interpol</code> defaults to TRUE.</p>
</td></tr>
<tr><td><code id="location_slice_from_region_series_+3A_buffer">buffer</code></td>
<td>
<p>boolean determining whether the variable will be returned
as the mean of a buffer around the focal cell. If set to TRUE, it overrides
<code>nn_interpol</code> (which provides the same estimates as <code>buffer</code> but only for
locations that are in cells with an NA). The buffer size is determined
by the argument <code>directions</code>. <code>buffer</code> defaults to FALSE.</p>
</td></tr>
<tr><td><code id="location_slice_from_region_series_+3A_directions">directions</code></td>
<td>
<p>character or matrix to indicate the directions in which
cells are considered connected when using <code>nn_interpol</code> or <code>buffer</code>.
The following character values are allowed: &quot;rook&quot; or &quot;4&quot; for the
horizontal and vertical neighbours; &quot;bishop&quot; to get the diagonal neighbours;
&quot;queen&quot; or &quot;8&quot; to get the vertical, horizontal and diagonal neighbours;
or &quot;16&quot; for knight and one-cell queen move neighbours. If directions
is a matrix it should have odd dimensions and have logical (or 0, 1) values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with the climatic variables of interest.
</p>

<hr>
<h2 id='make_binary_mask'>Create a binary mask</h2><span id='topic+make_binary_mask'></span>

<h3>Description</h3>

<p>Create a binary mask from a raster: NAs are converted to 0s, and
any other value to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_binary_mask(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_binary_mask_+3A_x">x</code></td>
<td>
<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> with 0s and 1s
</p>

<hr>
<h2 id='make_ice_mask'>Downscale an ice mask</h2><span id='topic+make_ice_mask'></span>

<h3>Description</h3>

<p>Downscaling the ice mask presents some issues. The mask is a binary raster,
so any standard downscaling approach will still look very blocky. We can
smooth the contour by applying a Gaussian filter. How strong that filter
should be is very much a matter of personal opinion, as we do not have any
data to compare to. This function attempts to use as sensible default value,
but it is worth exploring alternative values to find a good solution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_ice_mask(ice_mask_low_res, land_mask_high_res, d = c(0.5, 3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_ice_mask_+3A_ice_mask_low_res">ice_mask_low_res</code></td>
<td>
<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> of the low resolution ice mask
to downscale (e.g. as obtained with <code><a href="#topic+get_ice_mask">get_ice_mask()</a></code>)</p>
</td></tr>
<tr><td><code id="make_ice_mask_+3A_land_mask_high_res">land_mask_high_res</code></td>
<td>
<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> of the land masks at different
times (e.g. as obtained from <code><a href="#topic+make_land_mask">make_land_mask()</a></code>). The ice mask will be cropped
and matched for the resolution of this land mask.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> of the ice mask (1's), with the rest of the
world (sea and land) as NA's
</p>

<hr>
<h2 id='make_land_mask'>Create a land mask</h2><span id='topic+make_land_mask'></span>

<h3>Description</h3>

<p>Create a land mask for a given time step. The land mask is based on the simple
logic of moving the ocean up and down given the current relief profile (
topography+bathymetry, i.e. the elevation both above and below sea level).
Note that this approach ignores any rebound due to changing mass and distribution of
ice sheets.
LIMITATIONS: The land mask will show internal lakes/seas as land, as their level
is unrelated to the general sea level. If you have specific reconstructions
of internal lakes (or want to simply reuse their current extents), you will
have to add them onto the masks generated by this function. Also note that the
land mask does not include ice sheets. This means that some areas that are permanently
covered by ice at the two poles will show up as sea. This means that, for any
reconstruction including Greenland or Antarctica, the resulting land mask will
need to be modified to include the appropriate ice sheets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_land_mask(relief_rast, time_bp, sea_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_land_mask_+3A_relief_rast">relief_rast</code></td>
<td>
<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> with relief</p>
</td></tr>
<tr><td><code id="make_land_mask_+3A_time_bp">time_bp</code></td>
<td>
<p>the time of interest</p>
</td></tr>
<tr><td><code id="make_land_mask_+3A_sea_level">sea_level</code></td>
<td>
<p>sea level at the time of interest (if left to NULL, this is
computed using Spratt 2016)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> of the land masks (with land as 1's and sea
as NAs), where the layers are different times
</p>

<hr>
<h2 id='mis_boundaries'>Time boundaries of marine isotope stages (MIS).</h2><span id='topic+mis_boundaries'></span>

<h3>Description</h3>

<p>A dataset containing the beginning and end of MIS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mis_boundaries
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and 2 variables:
</p>

<dl>
<dt>mis</dt><dd><p>the stage, a string</p>
</dd>
<dt>start</dt><dd><p>the start of a given MIS, in kya</p>
</dd>
<dt>end</dt><dd><p>the start of a given MIS, in kya</p>
</dd>
</dl>


<hr>
<h2 id='mode'>Mode</h2><span id='topic+mode'></span>

<h3>Description</h3>

<p>Find the mode of vector x (note that, if multiple values have the same
frequency, this function simply picks the first occurring one)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mode(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mode_+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the mode
</p>

<hr>
<h2 id='pastclim'>pastclim</h2><span id='topic+pastclim'></span><span id='topic+pastclim-package'></span>

<h3>Description</h3>

<p>This <code>R</code> library is designed to provide an easy way to extract and manipulate palaeoclimate
reconstructions for ecological and anthropological analyses.
</p>


<h3>Details</h3>

<p>The functionalities of <code>pastclim</code> are described in
Leonardi et al. (2023) <a href="https://doi.org/10.1111/ecog.06481">doi:10.1111/ecog.06481</a>. Please cite it if you
use <code>pastclim</code> in your research.
</p>
<p>On its dedicated <a href="https://evolecolgroup.github.io/pastclim/">website</a>, you can find
Articles giving you a step-by-step <a href="https://evolecolgroup.github.io/pastclim/articles/a0_pastclim_overview.html">overview of the package</a>,
and a <a href="https://evolecolgroup.github.io/pastclim/pastclim_cheatsheet.pdf">cheatsheet</a>.
There is also a
<a href="https://evolecolgroup.github.io/pastclim/dev/">version</a> of the site
updated for the <code>dev</code> version (on the top left, the version number is in
red, and will be in the format x.x.x.9xxx, indicating it is a
development version).
</p>
<p><code>pastclim</code> currently includes data from Beyer et al 2020, a reconstruction of climate
based on the HadCM3
model for the last 120k years, and Krapp et al 2021, which covers the last 800k years.
The reconstructions are bias-corrected and downscaled to 0.5 degree. More details on these datasets
can be found <a href="https://evolecolgroup.github.io/pastclim/articles/a1_available_datasets.html">here</a>.
There are also instructions on how to build and use <a href="https://evolecolgroup.github.io/pastclim/articles/a2_custom_datasets.html">custom datasets</a>.
</p>

<hr>
<h2 id='region_extent'>Region extents.</h2><span id='topic+region_extent'></span>

<h3>Description</h3>

<p>A list of extents for major regions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>region_extent
</code></pre>


<h3>Format</h3>

<p>A list of vectors giving the extents.
</p>

<hr>
<h2 id='region_outline'>Region outlines.</h2><span id='topic+region_outline'></span>

<h3>Description</h3>

<p>An <code><a href="sf.html#topic+sf">sf::sf</a></code> object containing outlines for major regions. Outlines that
span the antimeridian have been split into multiple polygons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>region_outline
</code></pre>


<h3>Format</h3>

<p><code><a href="sf.html#topic+sf">sf::sf</a></code> of outlines.
</p>

<dl>
<dt>name</dt><dd><p>names of regions</p>
</dd>
</dl>


<hr>
<h2 id='region_outline_union'>Region outlines unioned.</h2><span id='topic+region_outline_union'></span>

<h3>Description</h3>

<p>An <code><a href="sf.html#topic+sf">sf::sf</a></code> object containing outlines for major regions. Each outline is
represented as a single polygon. If you want multiple polygons, use
<a href="#topic+region_outline">region_outline</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>region_outline_union
</code></pre>


<h3>Format</h3>

<p><code><a href="sf.html#topic+sf">sf::sf</a></code> of outlines.
</p>

<dl>
<dt>name</dt><dd><p>names of regions</p>
</dd>
</dl>


<hr>
<h2 id='region_series'>Extract a time series of climate variables for a region</h2><span id='topic+region_series'></span>

<h3>Description</h3>

<p>This function extracts a time series of one or more climate variables for
a given
dataset covering a region (or the whole world). The function returns a
<code><a href="terra.html#topic+SpatRaster-class">terra::SpatRasterDataset</a></code> object, with
each variable as a sub-dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>region_series(
  time_bp = NULL,
  time_ce = NULL,
  bio_variables,
  dataset,
  path_to_nc = NULL,
  ext = NULL,
  crop = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="region_series_+3A_time_bp">time_bp</code></td>
<td>
<p>time slices in years before present (negative values represent
time before present, positive values time in the future). This parameter can
be a vector of times (the slices need
to exist in the dataset), a list with a min and max element setting the
range of values, or left to NULL to retrieve all time steps.
To check which slices are available, you can use
<code><a href="#topic+get_time_bp_steps">get_time_bp_steps()</a></code>.</p>
</td></tr>
<tr><td><code id="region_series_+3A_time_ce">time_ce</code></td>
<td>
<p>time slices in years CE (see <code>time_bp</code> for options).
For available time slices in years CE, use <code><a href="#topic+get_time_ce_steps">get_time_ce_steps()</a></code>.
Only one of <code>time_bp</code> or <code>time_ce</code> should be used.</p>
</td></tr>
<tr><td><code id="region_series_+3A_bio_variables">bio_variables</code></td>
<td>
<p>vector of names of variables to be extracted</p>
</td></tr>
<tr><td><code id="region_series_+3A_dataset">dataset</code></td>
<td>
<p>string defining the dataset to use. If set to &quot;custom&quot;,
then a single nc file is used from &quot;path_to_nc&quot;</p>
</td></tr>
<tr><td><code id="region_series_+3A_path_to_nc">path_to_nc</code></td>
<td>
<p>the path to the custom nc file containing the palaeoclimate
reconstructions. All the variables of interest need to be included in
this file.</p>
</td></tr>
<tr><td><code id="region_series_+3A_ext">ext</code></td>
<td>
<p>an extent, coded as numeric vector (length=4;
order= xmin, xmax, ymin, ymax) or a <a href="terra.html#topic+SpatExtent-class">terra::SpatExtent</a> object. If NULL,
the full extent of the reconstruction is given.</p>
</td></tr>
<tr><td><code id="region_series_+3A_crop">crop</code></td>
<td>
<p>a polygon used to crop the reconstructions (e.g. the outline
of a continental mass). A <code><a href="sf.html#topic+st">sf::sfg</a></code> or a <a href="terra.html#topic+SpatVector-class">terra::SpatVector</a> object
is used to define the polygon.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a
<code><a href="terra.html#topic+SpatRaster-class">terra::SpatRasterDataset</a></code> object, with
each variable as a sub-dataset.
</p>

<hr>
<h2 id='region_slice'>Extract a climate slice for a region</h2><span id='topic+region_slice'></span>

<h3>Description</h3>

<p>This function extracts a slice of one or more climate variables for a given
dataset covering a region (or the whole world). The function returns a
SpatRaster <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> object, with
each variable as a layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>region_slice(
  time_bp = NULL,
  time_ce = NULL,
  bio_variables,
  dataset,
  path_to_nc = NULL,
  ext = NULL,
  crop = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="region_slice_+3A_time_bp">time_bp</code></td>
<td>
<p>the time slice in years before present (negative
values represent
time before present, positive values time in the future). The slice needs
to exist in the dataset. To check which slices are available, you can use
<code><a href="#topic+get_time_bp_steps">get_time_bp_steps()</a></code>.</p>
</td></tr>
<tr><td><code id="region_slice_+3A_time_ce">time_ce</code></td>
<td>
<p>time slice in years CE.
For available time slices in years CE, use <code><a href="#topic+get_time_ce_steps">get_time_ce_steps()</a></code>.
Only one of <code>time_bp</code> or <code>time_ce</code> should be used.</p>
</td></tr>
<tr><td><code id="region_slice_+3A_bio_variables">bio_variables</code></td>
<td>
<p>vector of names of variables to be extracted</p>
</td></tr>
<tr><td><code id="region_slice_+3A_dataset">dataset</code></td>
<td>
<p>string defining the dataset to use. If set to &quot;custom&quot;,
then a single nc file is used from &quot;path_to_nc&quot;</p>
</td></tr>
<tr><td><code id="region_slice_+3A_path_to_nc">path_to_nc</code></td>
<td>
<p>the path to the custom nc file containing the palaeoclimate
reconstructions. All the variables of interest need to be included
in this file.</p>
</td></tr>
<tr><td><code id="region_slice_+3A_ext">ext</code></td>
<td>
<p>an extent, coded as numeric vector (length=4;
order= xmin, xmax, ymin, ymax) or a <a href="terra.html#topic+SpatExtent-class">terra::SpatExtent</a> object. If NULL,
the full extent of the reconstruction is given.</p>
</td></tr>
<tr><td><code id="region_slice_+3A_crop">crop</code></td>
<td>
<p>a polygon used to crop the reconstructions (e.g. the outline
of a continental mass). A <code><a href="sf.html#topic+st">sf::sfg</a></code> or a <a href="terra.html#topic+SpatVector-class">terra::SpatVector</a> object
is used to define the polygon.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a
SpatRaster <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> object, with
each variable as a layer.
</p>

<hr>
<h2 id='sample_region_series'>Sample points from a region time series</h2><span id='topic+sample_region_series'></span>

<h3>Description</h3>

<p>This function samples points from a region time series. Sampling can either be
performed for the same locations at all time steps (if only one value is given
for <code>size</code>), or for different locations for each time step (if <code>size</code> is a
vector of length equal to the number of time steps). To sample the same
number of points, but different locations, for each time step, provide a vector
repeating the same value for each time step.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_region_series(x, size, method = "random", replace = FALSE, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_region_series_+3A_x">x</code></td>
<td>
<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRasterDataset</a></code> returned
by <code><a href="#topic+region_series">region_series()</a></code></p>
</td></tr>
<tr><td><code id="sample_region_series_+3A_size">size</code></td>
<td>
<p>number of points sampled. A single value is used to sample the same
locations across all time steps, a vector of values to sample different locations
at each time step.</p>
</td></tr>
<tr><td><code id="sample_region_series_+3A_method">method</code></td>
<td>
<p>one of the sampling methods from <code><a href="terra.html#topic+sample">terra::spatSample()</a></code>. It
defaults to &quot;random&quot;</p>
</td></tr>
<tr><td><code id="sample_region_series_+3A_replace">replace</code></td>
<td>
<p>boolean determining whether we sample with replacement</p>
</td></tr>
<tr><td><code id="sample_region_series_+3A_na.rm">na.rm</code></td>
<td>
<p>boolean determining whether NAs are removed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function wraps <code><a href="terra.html#topic+sample">terra::spatSample()</a></code> to appropriate sample the
<code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code>s in the <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRasterDataset</a></code> returned
by <code><a href="#topic+region_series">region_series()</a></code>.
</p>


<h3>Value</h3>

<p>a data.frame with the sampled cells and their respective values for
the climate variables.
</p>

<hr>
<h2 id='sample_region_slice'>Sample points from a region time slice</h2><span id='topic+sample_region_slice'></span>

<h3>Description</h3>

<p>This function samples points from a region time slice (i.e. a time point).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_region_slice(x, size, method = "random", replace = FALSE, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_region_slice_+3A_x">x</code></td>
<td>
<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> returned
by <code><a href="#topic+region_slice">region_slice()</a></code></p>
</td></tr>
<tr><td><code id="sample_region_slice_+3A_size">size</code></td>
<td>
<p>number of points sampled.</p>
</td></tr>
<tr><td><code id="sample_region_slice_+3A_method">method</code></td>
<td>
<p>one of the sampling methods from <code><a href="terra.html#topic+sample">terra::spatSample()</a></code>. It
defaults to &quot;random&quot;</p>
</td></tr>
<tr><td><code id="sample_region_slice_+3A_replace">replace</code></td>
<td>
<p>boolean determining whether we sample with replacement</p>
</td></tr>
<tr><td><code id="sample_region_slice_+3A_na.rm">na.rm</code></td>
<td>
<p>boolean determining whether NAs are removed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function wraps <code><a href="terra.html#topic+sample">terra::spatSample()</a></code> to appropriate sample the
<code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> returned
by <code><a href="#topic+region_slice">region_slice()</a></code>. You can also use <code><a href="terra.html#topic+sample">terra::spatSample()</a></code> directly
on a slice (which is a standard <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code>).
</p>


<h3>Value</h3>

<p>a data.frame with the sampled cells and their respective values for
the climate variables.
</p>

<hr>
<h2 id='sample_rs_fixed'>Sample the same locations from a region time series</h2><span id='topic+sample_rs_fixed'></span>

<h3>Description</h3>

<p>Internal function for fixed sampling from <code><a href="#topic+sample_region_series">sample_region_series()</a></code>,
used when a single size is given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_rs_fixed(x, size, method = "random", replace = FALSE, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_rs_fixed_+3A_x">x</code></td>
<td>
<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRasterDataset</a></code> returned
by <code><a href="#topic+region_series">region_series()</a></code></p>
</td></tr>
<tr><td><code id="sample_rs_fixed_+3A_size">size</code></td>
<td>
<p>number of points sampled; the same
locations across all time steps</p>
</td></tr>
<tr><td><code id="sample_rs_fixed_+3A_method">method</code></td>
<td>
<p>one of the sampling methods from <code><a href="terra.html#topic+sample">terra::spatSample()</a></code>. It
defaults to &quot;random&quot;</p>
</td></tr>
<tr><td><code id="sample_rs_fixed_+3A_replace">replace</code></td>
<td>
<p>boolean determining whether we sample with replacement</p>
</td></tr>
<tr><td><code id="sample_rs_fixed_+3A_na.rm">na.rm</code></td>
<td>
<p>boolean determining whether NAs are removed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with the sampled cells and their respective values for
the climate variables.
</p>

<hr>
<h2 id='sample_rs_variable'>Sample the different number of points from a region time series</h2><span id='topic+sample_rs_variable'></span>

<h3>Description</h3>

<p>Internal function for sampling different number of points for each
timestep of a region series from <code><a href="#topic+sample_region_series">sample_region_series()</a></code>,
used when size is a vector of values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_rs_variable(x, size, method = "random", replace = FALSE, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_rs_variable_+3A_x">x</code></td>
<td>
<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRasterDataset</a></code> returned
by <code><a href="#topic+region_series">region_series()</a></code></p>
</td></tr>
<tr><td><code id="sample_rs_variable_+3A_size">size</code></td>
<td>
<p>a vector of the number of points sampled for each time step</p>
</td></tr>
<tr><td><code id="sample_rs_variable_+3A_method">method</code></td>
<td>
<p>one of the sampling methods from <code><a href="terra.html#topic+sample">terra::spatSample()</a></code>. It
defaults to &quot;random&quot;</p>
</td></tr>
<tr><td><code id="sample_rs_variable_+3A_replace">replace</code></td>
<td>
<p>boolean determining whether we sample with replacement</p>
</td></tr>
<tr><td><code id="sample_rs_variable_+3A_na.rm">na.rm</code></td>
<td>
<p>boolean determining whether NAs are removed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with the sampled cells and their respective values for
the climate variables.
</p>

<hr>
<h2 id='set_data_path'>Set the data path where climate reconstructions will be stored</h2><span id='topic+set_data_path'></span>

<h3>Description</h3>

<p>This function sets the path where climate reconstructions will be stored.
This
information is stored in a file names &quot;pastclim_data.txt&quot;, which is found
in the directory returned by <code>tools::R_user_dir("pastclim","config")</code> (i.e.
the default configuration directory for the package as set in R &gt;= 4.0).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_data_path(
  path_to_nc = NULL,
  ask = TRUE,
  write_config = TRUE,
  copy_example = TRUE,
  on_CRAN = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_data_path_+3A_path_to_nc">path_to_nc</code></td>
<td>
<p>the path to the file that contains the downloaded
reconstructions. If left unset, the default location returned by
<code>tools::R_user_dir("pastclim","data")</code> will be used</p>
</td></tr>
<tr><td><code id="set_data_path_+3A_ask">ask</code></td>
<td>
<p>boolean on whether the user should be asked to confirm their
choices</p>
</td></tr>
<tr><td><code id="set_data_path_+3A_write_config">write_config</code></td>
<td>
<p>boolean on whether the path should be saved in a config
file</p>
</td></tr>
<tr><td><code id="set_data_path_+3A_copy_example">copy_example</code></td>
<td>
<p>boolean on whether the example dataset should be saved
in the data_path</p>
</td></tr>
<tr><td><code id="set_data_path_+3A_on_cran">on_CRAN</code></td>
<td>
<p>boolean; users should NOT need this parameters. It is used to set up a
data path in the temporary directory for examples and tests
to run on CRAN.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the path was set correctly
</p>

<hr>
<h2 id='slice_region_series'>Extract a slice for a time series of climate variables for a region</h2><span id='topic+slice_region_series'></span>

<h3>Description</h3>

<p>This function extracts a time slice from time series of one or more climate
variables for a given dataset covering a region (or the whole world).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slice_region_series(x, time_bp = NULL, time_ce = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slice_region_series_+3A_x">x</code></td>
<td>
<p>climate time series generated with <code><a href="#topic+region_series">region_series()</a></code></p>
</td></tr>
<tr><td><code id="slice_region_series_+3A_time_bp">time_bp</code></td>
<td>
<p>time slice
in years before present (i.e. 1950, negative integers
for values in the past). The slices
need to exist in the dataset. To check which slices are available, you
can use <code>time_bp(x)</code>.</p>
</td></tr>
<tr><td><code id="slice_region_series_+3A_time_ce">time_ce</code></td>
<td>
<p>time slice in years CE. Only one of <code>time_bp</code> or <code>time_ce</code> should
be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="terra.html#topic+SpatRaster">SpatRaster</a> of the relevant slice.
</p>

<hr>
<h2 id='time_bp'>Extract and set time in years before present for SpatRaster and SpatRasterDataset</h2><span id='topic+time_bp'></span><span id='topic+time_bp+2CSpatRaster-method'></span><span id='topic+time_bp+2CSpatRasterDataset-method'></span><span id='topic+time_bp+3C-'></span><span id='topic+time_bp+3C-+2CSpatRaster-method'></span><span id='topic+time_bp+3C-+2CSpatRasterDataset-method'></span>

<h3>Description</h3>

<p>This functions extracts and sets time in years BP (i.e. from 1950) for a
<code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> or  a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRasterDataset</a></code>. In a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> object, time is
stored with unit &quot;years&quot;, which
are years from 0AD. This means that, when a summary of the
<code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> is
inspected, the times will appear as <code>time_bp</code>+1950. The same applies when the
function <code><a href="terra.html#topic+time">terra::time()</a></code> is used instead of <code><a href="#topic+time_bp">time_bp()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_bp(x)

## S4 method for signature 'SpatRaster'
time_bp(x)

## S4 method for signature 'SpatRasterDataset'
time_bp(x)

time_bp(x) &lt;- value

## S4 replacement method for signature 'SpatRaster'
time_bp(x) &lt;- value

## S4 replacement method for signature 'SpatRasterDataset'
time_bp(x) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="time_bp_+3A_x">x</code></td>
<td>
<p>a <code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code></p>
</td></tr>
<tr><td><code id="time_bp_+3A_value">value</code></td>
<td>
<p>a numeric vector of times in years BP</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a date in years BP (where negative numbers indicate a date in the past)
</p>

<hr>
<h2 id='time_bp_to_i_series'>Convert a time BP to indexes for a series</h2><span id='topic+time_bp_to_i_series'></span>

<h3>Description</h3>

<p>Internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_bp_to_i_series(time_bp, time_steps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="time_bp_to_i_series_+3A_time_bp">time_bp</code></td>
<td>
<p>vector of times BP</p>
</td></tr>
<tr><td><code id="time_bp_to_i_series_+3A_time_steps">time_steps</code></td>
<td>
<p>time steps for which reconstructions are available</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the indeces for the relevant time steps
</p>

<hr>
<h2 id='time_bp_to_index'>Find the closest index to a given time in years BP</h2><span id='topic+time_bp_to_index'></span>

<h3>Description</h3>

<p>Internal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_bp_to_index(time_bp, time_steps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="time_bp_to_index_+3A_time_bp">time_bp</code></td>
<td>
<p>vector of times BP</p>
</td></tr>
<tr><td><code id="time_bp_to_index_+3A_time_steps">time_steps</code></td>
<td>
<p>time steps for which reconstructions are available</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the indeces for the relevant time steps
</p>

<hr>
<h2 id='time_series_for_locations'>Extract a time series of bioclimatic variables for one or more locations.</h2><span id='topic+time_series_for_locations'></span>

<h3>Description</h3>

<p>Deprecated version of <code><a href="#topic+location_series">location_series()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_series_for_locations(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="time_series_for_locations_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code><a href="#topic+location_series">location_series()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with the climatic variables of interest
</p>

<hr>
<h2 id='update_dataset_list'>Update the dataset list</h2><span id='topic+update_dataset_list'></span>

<h3>Description</h3>

<p>If a newer dataset list (which includes all the information about the files
storing the data for pastclim), download it and start using it as
'dataset_list_included.csv' in
<code>tools::R_user_dir("pastclim","config")</code>. If the latter is present, the last
column, named 'dataset_list_v', provides the version of this table, and the
most advanced table is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_dataset_list(on_cran = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_dataset_list_+3A_on_cran">on_cran</code></td>
<td>
<p>boolean to make this function run on ci tests using tempdir</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the dataset was updated
</p>

<hr>
<h2 id='validate_nc'>Validate an netcdf file for pastclim</h2><span id='topic+validate_nc'></span>

<h3>Description</h3>

<p>This function validates a netcdf file as a potential dataset for <code>pastclim</code>.
The key checks are:
a) that the dimensions (longitude, latitude and time) have been set correctly.
b) that all variables have the appropriate metadata (longname and units)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_nc(path_to_nc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_nc_+3A_path_to_nc">path_to_nc</code></td>
<td>
<p>path to the nc file of interest</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE if the file is valid.
</p>

<hr>
<h2 id='var_labels'>Generate pretty variable labels for plotting</h2><span id='topic+var_labels'></span>

<h3>Description</h3>

<p>Generate pretty labels (in the form of an <a href="base.html#topic+expression">expression</a>) that can be used
for plotting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_labels(x, dataset, with_units = TRUE, abbreviated = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="var_labels_+3A_x">x</code></td>
<td>
<p>either a character vector with the names of the variables, or a
<code><a href="terra.html#topic+SpatRaster-class">terra::SpatRaster</a></code> generated with [region_slice())]
</p>
<p>[region_slice())]: R:region_slice())</p>
</td></tr>
<tr><td><code id="var_labels_+3A_dataset">dataset</code></td>
<td>
<p>string defining dataset to be downloaded (a list of possible
values can be obtained with <code><a href="#topic+list_available_datasets">list_available_datasets()</a></code>). This function
will not work on custom datasets.</p>
</td></tr>
<tr><td><code id="var_labels_+3A_with_units">with_units</code></td>
<td>
<p>boolean defining whether the label should include units</p>
</td></tr>
<tr><td><code id="var_labels_+3A_abbreviated">abbreviated</code></td>
<td>
<p>boolean defining whether the label should use abbreviations
for the variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <a href="base.html#topic+expression">expression</a> that can be used as a label in plots
</p>


<h3>Examples</h3>

<pre><code class='language-R'>var_labels("bio01", dataset = "Example")

# set the data_path for this example to run on CRAN
# users don't need to run this line
set_data_path(on_CRAN = TRUE)

# for a SpatRaster
climate_20k &lt;- region_slice(
  time_bp = -20000,
  bio_variables = c("bio01", "bio10", "bio12"),
  dataset = "Example"
)
terra::plot(climate_20k, main = var_labels(climate_20k, dataset = "Example"))
terra::plot(climate_20k, main = var_labels(climate_20k,
  dataset = "Example",
  abbreviated = TRUE
))
</code></pre>

<hr>
<h2 id='WorldClim_2.1'>Documentation for the WorldClim datasets</h2><span id='topic+WorldClim_2.1'></span><span id='topic+WorldClim_2.1_10m'></span><span id='topic+WorldClim_2.1_5m'></span>

<h3>Description</h3>

<p>WorldClim version 2.1 is a database of high spatial resolution global weather and
climate data, covering both the present and future projections. If you use this
dataset, make sure to cite the original publication:
</p>


<h3>Details</h3>

<p>Fick, S.E. and R.J. Hijmans, 2017. WorldClim 2: new 1km spatial resolution
climate surfaces for global land areas. International Journal of Climatology 37 (12): 4302-4315.
<a href="https://doi.org/10.1002/joc.5086">doi:10.1002/joc.5086</a>
</p>
<p><strong>Present-day reconstructions</strong> are based on the mean for the period 1970-2000,
and are available at multiple resolutions of
10 arc-minutes, 5 arc-minutes, 2.5 arc-minute and 0.5 arc-minutes. The resolution
of interest can be obtained by changing the ending of the dataset name
<em>WorldClim_2.1_RESm</em>, e.g. <em>WorldClim_2.1_10m</em> or <em>WorldClim_2.1_5m</em>
(currently, only 10m and 5m are currently available in <code>pastclim</code>). In <code>pastclim</code>, the datasets are given
a date of 1985 CE (the mid-point of the period of interest), corresponding to
a time_bp of 35. There are 19 “bioclimatic” variables, as well as monthly
estimates for minimum, mean, and maximum temperature, and precipitation.
</p>
<p><strong>Future projections</strong> are based on the models in CMIP6, downscaled and de-biased
using WorldClim 2.1 for the present as a baseline. Monthly values of minimum
temperature, maximum temperature, and precipitation, as well as 19 bioclimatic
variables were processed for
23 global climate models (GCMs), and for four
Shared Socio-economic Pathways (SSPs): 126, 245, 370 and 585. Model and
SSP can be chosen by changing the ending of the dataset name
<em>WorldClim_2.1_GCM_SSP_RESm</em>.
</p>
<p>Available values for GCM are: &quot;ACCESS-CM2&quot;,
&quot;BCC-CSM2-MR&quot;, &quot;CMCC-ESM2&quot;, &quot;EC-Earth3-Veg&quot;, &quot;FIO-ESM-2-0&quot;,
&quot;GFDL-ESM4&quot;, &quot;GISS-E2-1-G&quot;, &quot;HadGEM3-GC31-LL&quot;, &quot;INM-CM5-0&quot;, &quot;IPSL-CM6A-LR&quot;,
&quot;MIROC6&quot;, &quot;MPI-ESM1-2-HR&quot;, &quot;MRI-ESM2-0&quot;, and &quot;UKESM1-0-LL&quot;. For SSP, use: &quot;ssp126&quot;,
&quot;ssp245&quot;,	&quot;ssp370&quot;,	and &quot;ssp585&quot;. RES takes the same values as for present reconstructions
(i.e. &quot;10m&quot;, &quot;5m&quot;, &quot;2.5m&quot;, and &quot;0.5m&quot;). Example dataset names are
<em>WorldClim_2.1_ACCESS-CM2_ssp245_10m</em> and <em>WorldClim_2.1_MRI-ESM2-0_ssp370_5m</em>
</p>
<p>The dataset are averages over 20 year
periods (2021-2040, 2041-2060, 2061-2080, 2081-2100).
In <code>pastclim</code>, the midpoints of the periods (2030, 2050, 2070, 2090) are used as the time stamps. All 4 periods
are automatically downloaded for each combination of GCM model and SSP, and are selected
as usual by defining the time in functions such as <code><a href="#topic+region_slice">region_slice()</a></code>.
</p>

<hr>
<h2 id='ybp2date'>Convert years BP from pastclim to lubridate date, or vice versa</h2><span id='topic+ybp2date'></span><span id='topic+date2ybp'></span>

<h3>Description</h3>

<p>These functions convert between years BP as used by pastclim (negative
numbers going into
the past, positive into the future) and standard
<code>POSIXct</code> date objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ybp2date(x)

date2ybp(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ybp2date_+3A_x">x</code></td>
<td>
<p>a time in years BP using the <code>pastclim</code> convention of
negative numbers indicating years into the past, or a <code>POSIXct</code> date object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>POSIXct</code> date object, or a vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ybp2date(-10000)
ybp2date(0)
# back and forth
date2ybp(ybp2date(-10000))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
