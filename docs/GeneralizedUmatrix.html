<!DOCTYPE html><html><head><title>Help for package GeneralizedUmatrix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GeneralizedUmatrix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#GeneralizedUmatrix-package'>
<p>Credible Visualization for Two-Dimensional Projections of Data</p></a></li>
<li><a href='#addRowWiseC'>
<p>intern function</p></a></li>
<li><a href='#CalcUstarmatrix'><p> Calculate the U*matrix for a given Umatrix and Pmatrix.</p></a></li>
<li><a href='#Chainlink'>
<p>Chainlink is part of the Fundamental Clustering Problem Suit (FCPS) [Thrun/Ultsch, 2020].</p></a></li>
<li><a href='#DefaultColorSequence'>
<p>Default color sequence for plots</p></a></li>
<li><a href='#Delta3DWeightsC'>
<p>intern function</p></a></li>
<li><a href='#EsomNeuronsAsList'><p>Converts wts data (EsomNeurons) into the list form</p></a></li>
<li><a href='#ExtendToroidalUmatrix'>
<p>Extend Toroidal Umatrix</p></a></li>
<li><a href='#GeneralizedUmatrix'><p>Generalized U-Matrix for Projection Methods published in [Thrun/Ultsch, 2020]</p></a></li>
<li><a href='#GeneratePmatrix'><p>Generates the P-matrix</p></a></li>
<li><a href='#ListAsEsomNeurons'><p>Converts List to WTS</p></a></li>
<li><a href='#LowLand'><p>LowLand</p></a></li>
<li><a href='#NormalizeUmatrix'>
<p>Normalize Umatrix</p></a></li>
<li><a href='#plotTopographicMap'>
<p>Visualizes the generalized U-matrix in 3D</p></a></li>
<li><a href='#ReduceToLowLand'><p>ReduceToLowLand</p></a></li>
<li><a href='#sESOM4BMUs'>
<p>simplified ESOM</p></a></li>
<li><a href='#setdiffMatrix'><p>setdiffMatrix shortens Matrix2Curt by those rows that are in both matrices.</p></a></li>
<li><a href='#TopviewTopographicMap'>
<p>Top view of the topographic map in 2D</p></a></li>
<li><a href='#trainstepC'>
<p>internal function for s-esom</p></a></li>
<li><a href='#Uheights4Data'><p>Uheights4Data</p></a></li>
<li><a href='#UmatrixColormap'><p>U-Matrix colors</p></a></li>
<li><a href='#UniqueBestMatchingUnits'><p>UniqueBestMatchingUnits</p></a></li>
<li><a href='#upscaleUmatrix'>
<p>Upscale a Umatrix grid</p></a></li>
<li><a href='#XYcoords2LinesColumns'><p>XYcoords2LinesColumns(X,Y) Converts points given as x(i),y(i) coordinates</p>
to integer coordinates Columns(i),Lines(i)</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Credible Visualization for Two-Dimensional Projections of Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-30</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Thrun &lt;m.thrun@gmx.net&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Projections are common dimensionality reduction methods, which represent high-dimensional data in a two-dimensional space. However, when restricting the output space to two dimensions, which results in a two dimensional scatter plot (projection) of the data, low dimensional similarities do not represent high dimensional distances coercively [Thrun, 2018] &lt;<a href="https://doi.org/10.1007%2F978-3-658-20540-9">doi:10.1007/978-3-658-20540-9</a>&gt;. This could lead to a misleading interpretation of the underlying structures [Thrun, 2018]. By means of the 3D topographic map the generalized Umatrix is able to depict errors of these two-dimensional scatter plots. The package is derived from the book of Thrun, M.C.: "Projection Based Clustering through Self-Organization and Swarm Intelligence" (2018) &lt;<a href="https://doi.org/10.1007%2F978-3-658-20540-9">doi:10.1007/978-3-658-20540-9</a>&gt; and the main algorithm called simplified self-organizing map for dimensionality reduction methods is published in &lt;<a href="https://doi.org/10.1016%2Fj.mex.2020.101093">doi:10.1016/j.mex.2020.101093</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.8), RcppParallel (&ge; 5.1.4), ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>DataVisualizations, rgl, grid, mgcv, png, reshape2, fields,
ABCanalysis, plotly, deldir, methods, knitr (&ge; 1.12),
rmarkdown (&ge; 0.9)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppParallel</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make, pandoc (&gt;=1.12.3, needed for vignettes)</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.deepbionics.org">https://www.deepbionics.org</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Mthrun/GeneralizedUmatrix/issues">https://github.com/Mthrun/GeneralizedUmatrix/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-30 07:53:53 UTC; mct_l</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Thrun <a href="https://orcid.org/0000-0001-9542-5543"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Felix Pape [ctb, ctr],
  Tim Schreier [ctb, ctr],
  Luis Winckelman [ctb, ctr],
  Quirin Stier [ctb, ctr],
  Alfred Ultsch [ths]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-30 10:20:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='GeneralizedUmatrix-package'>
Credible Visualization for Two-Dimensional Projections of Data
</h2><span id='topic+GeneralizedUmatrix-package'></span>

<h3>Description</h3>

<p>Projections are common dimensionality reduction methods, which represent high-dimensional data in a two-dimensional space. However, when restricting the output space to two dimensions, which results in a two dimensional scatter plot (projection) of the data, low dimensional similarities do not represent high dimensional distances coercively [Thrun, 2018] &lt;DOI: 10.1007/978-3-658-20540-9&gt;. This could lead to a misleading interpretation of the underlying structures [Thrun, 2018]. By means of the 3D topographic map the generalized Umatrix is able to depict errors of these two-dimensional scatter plots. The package is derived from the book of Thrun, M.C.: &quot;Projection Based Clustering through Self-Organization and Swarm Intelligence&quot; (2018) &lt;DOI:10.1007/978-3-658-20540-9&gt; and the main algorithm called simplified self-organizing map for dimensionality reduction methods is published in &lt;DOI: 10.1016/j.mex.2020.101093&gt;.
</p>


<h3>Details</h3>

<p>For a brief introduction to <span class="pkg">GeneralizedUmatrix</span> please see the vignette <a href="../doc/GeneralizedUmatrix.html">Introduction of the Generalized Umatrix Package</a>.
</p>
<p>For further details regarding the generalized Umatrix see [Thrun, 2018], chapter 4-5, or [Thrun/Ultsch, 2020].
</p>
<p>If you want to verifiy your clustering result externally, you can use <code>Heatmap</code> or <code>SilhouettePlot</code> of the CRAN package <code>DataVisualizations</code>.
</p>

<p>Index of help topics:
</p>
<pre>
CalcUstarmatrix         Calculate the U*matrix for a given Umatrix and
                        Pmatrix.
Chainlink               Chainlink is part of the Fundamental Clustering
                        Problem Suit (FCPS) [Thrun/Ultsch, 2020].
DefaultColorSequence    Default color sequence for plots
Delta3DWeightsC         intern function
EsomNeuronsAsList       Converts wts data (EsomNeurons) into the list
                        form
ExtendToroidalUmatrix   Extend Toroidal Umatrix
GeneralizedUmatrix      Generalized U-Matrix for Projection Methods
                        published in [Thrun/Ultsch, 2020]
GeneralizedUmatrix-package
                        Credible Visualization for Two-Dimensional
                        Projections of Data
GeneratePmatrix         Generates the P-matrix
ListAsEsomNeurons       Converts List to WTS
LowLand                 LowLand
NormalizeUmatrix        Normalize Umatrix
ReduceToLowLand         ReduceToLowLand
TopviewTopographicMap   Top view of the topographic map in 2D
Uheights4Data           Uheights4Data
UmatrixColormap         U-Matrix colors
UniqueBestMatchingUnits
                        UniqueBestMatchingUnits
XYcoords2LinesColumns   XYcoords2LinesColumns(X,Y) Converts points
                        given as x(i),y(i) coordinates to integer
                        coordinates Columns(i),Lines(i)
addRowWiseC             intern function
plotTopographicMap      Visualizes the generalized U-matrix in 3D
sESOM4BMUs              simplified ESOM
setdiffMatrix           setdiffMatrix shortens Matrix2Curt by those
                        rows that are in both matrices.
trainstepC              internal function for s-esom
upscaleUmatrix          Upscale a Umatrix grid
</pre>


<h3>Author(s)</h3>

<p>Michal Thrun
</p>
<p>Maintainer: Michael Thrun &lt;mthrun@informatik.uni-marburg.de&gt;
</p>


<h3>References</h3>

<p>[Thrun/Ultsch, 2020]  Thrun, M. C., &amp; Ultsch, A.: Uncovering High-Dimensional Structures of Projections from Dimensionality Reduction Methods, MethodsX, Vol. 7, pp. 101093, DOI <a href="https://doi.org/10.1016/j.mex.2020.101093">doi:10.1016/j.mex.2020.101093</a>, 2020.
</p>
<p>[Thrun, 2018]  Thrun, M. C.: Projection Based Clustering through Self-Organization and Swarm Intelligence, doctoral dissertation 2017, Springer, Heidelberg, ISBN: 978-3-658-20539-3, <a href="https://doi.org/10.1007/978-3-658-20540-9">doi:10.1007/978-3-658-20540-9</a>, 2018. 
</p>
<p>[Ultsch/Thrun, 2017]  Ultsch, A., &amp; Thrun, M. C.: Credible Visualizations for Planar Projections, in Cottrell, M. (Ed.), 12th International Workshop on Self-Organizing Maps and Learning Vector Quantization, Clustering and Data Visualization (WSOM), IEEE Xplore, France, 2017.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Chainlink")
Data=Chainlink$Data
Cls=Chainlink$Cls
InputDistances=as.matrix(dist(Data))
res=cmdscale(d=InputDistances, k = 2, eig = TRUE, add = FALSE, x.ret = FALSE)
ProjectedPoints=as.matrix(res$points)
#see also ProjectionBasedClustering package for other common projection methods
#see DatabionicSwarm for projection method without parameters or objective function
# ProjectedPoints=DatabionicSwarm::Pswarm(Data)$ProjectedPoints

resUmatrix=GeneralizedUmatrix(Data,ProjectedPoints)
plotTopographicMap(resUmatrix$Umatrix,resUmatrix$Bestmatches,Cls)

##Interactive Island Generation 
## from a tiled Umatrix (toroidal assumption)
## Not run: 
	Imx = ProjectionBasedClustering::interactiveGeneralizedUmatrixIsland(resUmatrix$Umatrix,
	resUmatrix$Bestmatches)
	plotTopographicMap(resUmatrix$Umatrix,

	resUmatrix$Bestmatches, Imx = Imx)

## End(Not run)
#External Verification
## Not run: 

 DataVisualizations::Heatmap(Data,Cls)
 #if spherical cluster strcuture
 DataVisualizations::SilhouettePlot(Data,Cls)

## End(Not run)

</code></pre>

<hr>
<h2 id='addRowWiseC'>
intern function
</h2><span id='topic+addRowWiseC'></span>

<h3>Description</h3>

<p>Adds the Vector DataPoint to every row of the matrix WeightVectors</p>


<h3>Usage</h3>

<pre><code class='language-R'>addRowWiseC(WeightVectors,DataPoint)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addRowWiseC_+3A_weightvectors">WeightVectors</code></td>
<td>
<p> WeightVectors. n weights with m components each</p>
</td></tr>
<tr><td><code id="addRowWiseC_+3A_datapoint">DataPoint</code></td>
<td>
<p>Vector with m components</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>WeightVectors</code></td>
<td>
<p>[1:m,1:n]</p>
</td></tr>
</table>

<hr>
<h2 id='CalcUstarmatrix'> Calculate the U*matrix for a given Umatrix and Pmatrix. </h2><span id='topic+CalcUstarmatrix'></span><span id='topic+calcUstarmatrix'></span>

<h3>Description</h3>

<p>Calculate the U*matrix for a given Umatrix and Pmatrix.</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcUstarmatrix_+3A_umatrix">Umatrix</code></td>
<td>
<p>[1:Lines,1:Column] Local averages of distances at each point of
the trainedGridWts[1:Lines,1:Column,1:variables] of ESOM or other SOM of same
format</p>
</td></tr>
<tr><td><code id="CalcUstarmatrix_+3A_pmatrix">Pmatrix</code></td>
<td>
<p>[1:Lines,1:Column] Local densities at each point of the
trainedGridWts[1:Lines,1:Column,1:variables] of ESOM or other SOM of same
format.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>UStarMatrix</code></td>
<td>
<p>[1:Lines,1:Column]</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>Michael Thrun</p>


<h3>References</h3>

<p>Ultsch, A. U* C: Self-organized Clustering with Emergent Feature Maps. in Lernen, Wissensentdeckung und Adaptivitaet (LWA). 2005. Saarbruecken, Germany.</p>

<hr>
<h2 id='Chainlink'>
Chainlink is part of the Fundamental Clustering Problem Suit (FCPS) [Thrun/Ultsch, 2020].
</h2><span id='topic+Chainlink'></span>

<h3>Description</h3>

<p>linear not separable dataset of two interwined chains.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Chainlink")</code></pre>


<h3>Details</h3>

<p>Size 1000, Dimensions 3, stored in <code>Chainlink$Data</code>
</p>
<p>Teo clusters, stored in <code>Chainlink$Cls</code>
</p>
<p>Published in [Ultsch et al.,1994] in German and [Ultsch 1995] in English.
</p>


<h3>References</h3>

<p>[Thrun/Ultsch, 2020]	Thrun, M. C., &amp; Ultsch, A.: Clustering Benchmark Datasets Exploiting the Fundamental Clustering Problems, Data in Brief,Vol. 30(C), pp. 105501, DOI 10.1016/j.dib.2020.105501 , 2020. 
</p>
<p>[Ultsch 1995]	Ultsch, A.: Self organizing neural networks perform different from statistical k-means clustering,
Proc. Society for Information and Classification (GFKL), Vol. 1995, Basel 8th-10th March, 1995.
</p>
<p>[Ultsch et al.,1994]	Ultsch, A., Guimaraes, G., Korus, D., &amp; Li, H.: Knowledge extraction from artificial neural
networks and applications, Parallele Datenverarbeitung mit dem Transputer, pp. 148-16Chainlink, Springer, 1994.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Chainlink)
str(Chainlink)

## Not run: 
require(DataVisualizations)
DataVisualizations::Plot3D(Chainlink$Data,Chainlink$Cls)

## End(Not run)
</code></pre>

<hr>
<h2 id='DefaultColorSequence'>
Default color sequence for plots
</h2><span id='topic+DefaultColorSequence'></span>

<h3>Description</h3>

<p>Defines the default color sequence for plots made within the Projections package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DefaultColorSequence")</code></pre>


<h3>Format</h3>

<p>A vector with 562 different strings describing colors for plots.
</p>

<hr>
<h2 id='Delta3DWeightsC'>
intern function
</h2><span id='topic+Delta3DWeightsC'></span>

<h3>Description</h3>

<p>Thr implementation of the main formula of SOM, ESOM, sESOM algorithms.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Delta3DWeightsC(vx,Datasample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Delta3DWeightsC_+3A_vx">vx</code></td>
<td>
<p>Numeric array of weights [1:Lines,1:Columns,1:Weights]</p>
</td></tr>
<tr><td><code id="Delta3DWeightsC_+3A_datasample">Datasample</code></td>
<td>
<p>Numeric vector of one datapoint[1:n]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>intern function in case of <code>ComputeInR==FALSE</code> in <code><a href="#topic+GeneralizedUmatrix">GeneralizedUmatrix</a></code>
</p>


<h3>Value</h3>

<p>modified array of weights [1:Lines,1:Columns,1:Weights]
</p>


<h3>Author(s)</h3>

<p>Michael Thrun
</p>


<h3>References</h3>

<p>[Thrun, 2018]  Thrun, M. C.: Projection Based Clustering through Self-Organization and Swarm Intelligence, doctoral dissertation 2017, Springer, Heidelberg, ISBN: 978-3-658-20539-3, <a href="https://doi.org/10.1007/978-3-658-20540-9">doi:10.1007/978-3-658-20540-9</a>, 2018. 
</p>

<hr>
<h2 id='EsomNeuronsAsList'>Converts wts data (EsomNeurons) into the list form</h2><span id='topic+EsomNeuronsAsList'></span>

<h3>Description</h3>

<p>Converts wts data into the list form</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="EsomNeuronsAsList_+3A_esomneurons">EsomNeurons</code></td>
<td>
<p>[1:Lines, 1:Columns, 1:Variables] high dimensional array with
grid positions in the first two dimensions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>One could describe this function as a transformation or a special case
of wide to long format, see also <code><a href="#topic+ListAsEsomNeurons">ListAsEsomNeurons</a></code></p>


<h3>Value</h3>

<table>
<tr><td><code>TrainedNeurons</code></td>
<td>
<p>[1:(Lines*Columns),1:Variables] List of Weights as a
matrix (not <code><a href="base.html#topic+list">list</a></code> like in R) as matrix or two dimensional array</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Thrun, Florian Lerch</p>


<h3>References</h3>

<p>Ultsch, A. Maps for the visualization of high-dimensional data spaces. in Proc. Workshop on Self organizing Maps. 2003.
</p>

<hr>
<h2 id='ExtendToroidalUmatrix'>
Extend Toroidal Umatrix
</h2><span id='topic+ExtendToroidalUmatrix'></span>

<h3>Description</h3>

<p>Extends Umatrix by toroidal continuation of the given Umatrix defined by
<code>ExtendBorders</code> in all four directions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ExtendToroidalUmatrix(Umatrix, Bestmatches, ExtendBorders)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ExtendToroidalUmatrix_+3A_umatrix">Umatrix</code></td>
<td>
<p>[1:Lines,1:Columns] Matrix of Umatrix Heights</p>
</td></tr>
<tr><td><code id="ExtendToroidalUmatrix_+3A_bestmatches">Bestmatches</code></td>
<td>
<p>[1:n, 1:2] Matrix with positions of Bestmatches for n
datapoints, first columns is the position in <code>Lines</code> and second column in
<code>Columns</code></p>
</td></tr>
<tr><td><code id="ExtendToroidalUmatrix_+3A_extendborders">ExtendBorders</code></td>
<td>

<p>number of lines and columns the umatrix should be extended with
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function assumes that U-matrix is not planaer (has no borders), i.e. is
toroidal, and not tiled. Bestmatches are moved to new positions accordingly.
Example is shown in conference talk of [Thrun et al., 2020].
</p>


<h3>Value</h3>

<table>
<tr><td><code>Umatrix</code></td>
<td>
<p>[1:Lines+2*ExtendBorders,1:Columns+2*ExtendBorders] Matrix of
U-Heights</p>
</td></tr>
<tr><td><code>Bestmatches</code></td>
<td>
<p>Array with positions of Bestmatches </p>
</td></tr>
</table>


<h3>Note</h3>

<p>Currently can be only used if untiled U-Matrix (the default) is presented, but 4-tiled U-matrix does not work.
</p>


<h3>Author(s)</h3>

<p>Michael Thrun
</p>


<h3>References</h3>

<p>[Thrun et al., 2020]  Thrun, M. C., Pape, F., &amp; Ultsch, A.: Interactive Machine Learning Tool for Clustering in Visual Analytics, 7th IEEE International Conference on Data Science and Advanced Analytics (DSAA 2020), Vol. accepted, pp. 1-9, IEEE, Sydney, Australia, 2020.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#ToDO
</code></pre>

<hr>
<h2 id='GeneralizedUmatrix'>Generalized U-Matrix for Projection Methods published in [Thrun/Ultsch, 2020]</h2><span id='topic+GeneralizedUmatrix'></span><span id='topic+getUmatrix4Projection'></span>

<h3>Description</h3>

<p>Generalized U-Matrix visualizes high-dimensional distance and density based structurs in two-dimensional scatter plots of projectios methods like CCA, MDS, PCA or NeRV [Ultsch/Thrun, 2017] with the help of a topographic map with hypsometrioc tints [Thrun et al. 2016] using a simplified emergent SOM published in [Thrun/Ultsch, 2020]. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GeneralizedUmatrix(Data,ProjectedPoints,

PlotIt=FALSE,Cls=NULL,Toroid=TRUE, Tiled=FALSE,

ComputeInR=FALSE,Parallel=TRUE,DataPerEpoch=1,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GeneralizedUmatrix_+3A_data">Data</code></td>
<td>
<p>[1:n,1:d] array of data: n cases in rows, d variables in columns</p>
</td></tr>
<tr><td><code id="GeneralizedUmatrix_+3A_projectedpoints">ProjectedPoints</code></td>
<td>
<p>[1:n,2] matrix containing coordinates of the Projection: A matrix of the fitted configuration.</p>
</td></tr>
<tr><td><code id="GeneralizedUmatrix_+3A_plotit">PlotIt</code></td>
<td>

<p>Optional,bool, defaut=FALSE, if =TRUE: U-Marix of every current Position of Databots will be shown
However, the amount of details shown will be less than in <code><a href="#topic+plotTopographicMap">plotTopographicMap</a></code>.
</p>
</td></tr>
<tr><td><code id="GeneralizedUmatrix_+3A_cls">Cls</code></td>
<td>

<p>Optional, For plotting, see <code>plotUmatrix</code> in package Umatrix
</p>
</td></tr>
<tr><td><code id="GeneralizedUmatrix_+3A_toroid">Toroid</code></td>
<td>

<p>Optional, Default=TRUE, 
</p>
<p>==FALSE planar computation with borders defined by projection method
</p>
<p>==TRUE: toroid borderless (toroidal) computation, the four borders defined by projection method are ignored.
</p>
</td></tr>
<tr><td><code id="GeneralizedUmatrix_+3A_tiled">Tiled</code></td>
<td>

<p>Optional,For plotting see <code>plotUmatrix</code> in package Umatrix
</p>
</td></tr>
<tr><td><code id="GeneralizedUmatrix_+3A_computeinr">ComputeInR</code></td>
<td>

<p>Optional,  =T: Rcode, =F Cpp Code
</p>
</td></tr>
<tr><td><code id="GeneralizedUmatrix_+3A_parallel">Parallel</code></td>
<td>

<p>Optional,  =TRUE: compute parallel Cpp Code, =FALSE do not compute parallel Cpp Code
</p>
</td></tr>
<tr><td><code id="GeneralizedUmatrix_+3A_dataperepoch">DataPerEpoch</code></td>
<td>

<p>Optional, scalar, value above zero and below 1 starts sampling and defines percentage of data points sampled in each epoch during the learning phase. Beware: Experimental!
</p>
</td></tr>
<tr><td><code id="GeneralizedUmatrix_+3A_...">...</code></td>
<td>
<p>Further parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Introduced first in the PhD thesis in [Thrun, 2018, p.46]. Furthermore the two parts of the work were peer-reviewed and published in [Ultsch/Thrun, 2017, Thrun/Ultsch, 2020].
</p>


<h3>Value</h3>

<p>List with
</p>
<table>
<tr><td><code>Umatrix</code></td>
<td>
<p>[1:Lines,1:Columns] Umatrix to be plotted, numerical matrix
storing the U-heights, see [Thrun, 2018] for definition.
</p>
</td></tr>
<tr><td><code>EsomNeurons</code></td>
<td>
<p>[1:Lines,1:Columns,1:weights] 3-dimensional numeric array
(wide format), not wts (long format).
</p>
</td></tr>
<tr><td><code>Bestmatches</code></td>
<td>
<p>[1:n,1:2] Positions of GridConverted Projected Points on the
Umatrix to the predefined Grid by Lines and Columns, First Columns has the
content of the Line No and second Column of the Column number.
</p>
</td></tr>
<tr><td><code>sESOMparamaters</code></td>
<td>
<p>internals for debugging</p>
</td></tr>
<tr><td><code>Lines</code></td>
<td>
<p>Number of Lines</p>
</td></tr>
<tr><td><code>Columns</code></td>
<td>
<p>Number of Columns</p>
</td></tr>
<tr><td><code>gplotres</code></td>
<td>
<p>output of ggplot2</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Thrun</p>


<h3>References</h3>

<p>[Thrun et al., 2016]  Thrun, M. C., Lerch, F., Loetsch, J., &amp; Ultsch, A.: Visualization and 3D Printing of Multivariate Data of Biomarkers, in Skala, V. (Ed.), International Conference in Central Europe on Computer Graphics, Visualization and Computer Vision (WSCG), Vol. 24, Plzen, http://wscg.zcu.cz/wscg2016/short/A43-full.pdf, 2016.
</p>
<p>[Thrun, 2018]  Thrun, M. C.: Projection Based Clustering through Self-Organization and Swarm Intelligence, doctoral dissertation 2017, Springer, Heidelberg, ISBN: 978-3-658-20539-3, <a href="https://doi.org/10.1007/978-3-658-20540-9">doi:10.1007/978-3-658-20540-9</a>, 2018. 
</p>
<p>[Ultsch/Thrun, 2017]  Ultsch, A., &amp; Thrun, M. C.: Credible Visualizations for Planar Projections, in Cottrell, M. (Ed.), 12th International Workshop on Self-Organizing Maps and Learning Vector Quantization, Clustering and Data Visualization (WSOM), IEEE Xplore, France, 2017.
</p>
<p>[Thrun/Ultsch, 2020]  Thrun, M. C., &amp; Ultsch, A.: Uncovering High-Dimensional Structures of Projections from Dimensionality Reduction Methods, MethodsX, Vol. 7, pp. 101093, DOI <a href="https://doi.org/10.1016/j.mex.2020.101093">doi:10.1016/j.mex.2020.101093</a>, 2020.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Chainlink")
Data=Chainlink$Data
Cls=Chainlink$Cls
InputDistances=as.matrix(dist(Data))
res=cmdscale(d=InputDistances, k = 2, eig = TRUE, add = FALSE, x.ret = FALSE)
ProjectedPoints=as.matrix(res$points)
## Not run: 
Stress = ProjectionBasedClustering::KruskalStress(InputDistances,

as.matrix(dist(ProjectedPoints)))

## End(Not run)


resUmatrix=GeneralizedUmatrix(Data,ProjectedPoints)
plotTopographicMap(resUmatrix$Umatrix,resUmatrix$Bestmatches,Cls)

</code></pre>

<hr>
<h2 id='GeneratePmatrix'>Generates the P-matrix</h2><span id='topic+GeneratePmatrix'></span>

<h3>Description</h3>

<p>Generates a P-matrix too visualize only density based structures of high-dimensional data.</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="GeneratePmatrix_+3A_data">Data</code></td>
<td>
<p>[1:n,1:d], A <code>[n,d]</code> matrix containing the data</p>
</td></tr>
<tr><td><code id="GeneratePmatrix_+3A_esomneurons">EsomNeurons</code></td>
<td>
<p>[1:Lines,Columns,1:Weights] 3D array of weights given by ESOM or sESOM algorithm.</p>
</td></tr>
<tr><td><code id="GeneratePmatrix_+3A_radius">Radius</code></td>
<td>
<p>The radius for measuring the density within the hypersphere.</p>
</td></tr>
<tr><td><code id="GeneratePmatrix_+3A_plotit">PlotIt</code></td>
<td>
<p>If set the Pmatrix will also be plotted</p>
</td></tr>
<tr><td><code id="GeneratePmatrix_+3A_...">...</code></td>
<td>
<p>If set the Pmatrix will also be plotted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To set the Radius the ABCanalysis of high-dimensional distances can be used [Ultsch/Lötsch, 2015]. For a deteailed definition and equation of automated density estimation (Radius) see Thrun et al. 2016.
</p>


<h3>Value</h3>

<p>PMatrix [1:Lines,1:Columns]</p>


<h3>Author(s)</h3>

<p>Michael Thrun</p>


<h3>References</h3>

<p>Ultsch, A.: Maps for the visualization of high-dimensional data spaces, Proc. Workshop on Self organizing Maps (WSOM), pp. 225-230, Kyushu, Japan, 2003. 
</p>
<p>Ultsch, A., Loetsch, J.: Computed ABC Analysis for Rational Selection of Most Informative Variables in Multivariate Data, PloS one, Vol. 10(6), pp. e0129767. doi 10.1371/journal.pone.0129767, 2015.
</p>
<p>Thrun, M. C., Lerch, F., Loetsch, J., Ultsch, A.: Visualization and 3D Printing of Multivariate Data of Biomarkers, in Skala, V. (Ed.), International Conference in Central Europe on Computer Graphics, Visualization and Computer Vision,Plzen, 2016. 
</p>

<hr>
<h2 id='ListAsEsomNeurons'>Converts List to WTS</h2><span id='topic+ListAsEsomNeurons'></span>

<h3>Description</h3>

<p>Converts wts data in list form into a 3 dimensional array</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="ListAsEsomNeurons_+3A_wts_list">wts_list</code></td>
<td>
<p>[1:(Lines*Columns),1:Variables] Matrix with weights in the 2nd
dimension(not list() like in R)</p>
</td></tr>
<tr><td><code id="ListAsEsomNeurons_+3A_lines">Lines</code></td>
<td>
<p>Lines/Height of the desired grid</p>
</td></tr>
<tr><td><code id="ListAsEsomNeurons_+3A_columns">Columns</code></td>
<td>
<p>Columns/Width of the desired grid</p>
</td></tr>
</table>


<h3>Details</h3>

<p>One could describe this function as a transformation or a special case
of long to wide format, see also <code><a href="#topic+EsomNeuronsAsList">EsomNeuronsAsList</a></code></p>


<h3>Value</h3>

<table>
<tr><td><code>EsomNeurons</code></td>
<td>
<p>[1:Lines, 1:Columns, 1:Variables] 3 dimensional array
containing the weights of the neural grid. For a more general explanation see
reference</p>
</td></tr></table>


<h3>Author(s)</h3>

<p>Michael Thrun, Florian Lerch</p>


<h3>References</h3>

<p>Ultsch, A.: Maps for the visualization of high-dimensional data spaces, Proc.
Workshop on Self organizing Maps (WSOM), pp. 225-230, Kyushu, Japan, 2003.</p>

<hr>
<h2 id='LowLand'>LowLand</h2><span id='topic+LowLand'></span>

<h3>Description</h3>

<p>LowLand
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LowLand(BestMatchingUnits, GeneralizedUmatrix, Data, Cls, Key, LowLimit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LowLand_+3A_bestmatchingunits">BestMatchingUnits</code></td>
<td>
<p>[1:n,1:n,1:n] BestMatchingUnits =[BMkey, BMLineCoords, BMColCoords]</p>
</td></tr>
<tr><td><code id="LowLand_+3A_generalizedumatrix">GeneralizedUmatrix</code></td>
<td>
<p>[1:l,1:c] U-Matrix heights in Matrix form</p>
</td></tr>
<tr><td><code id="LowLand_+3A_data">Data</code></td>
<td>
<p>[1:n,1:d] data cases in lines, variables in Columns or [] or 0</p>
</td></tr>
<tr><td><code id="LowLand_+3A_cls">Cls</code></td>
<td>
<p>[1:n] a possible classification of the data or [] or 0</p>
</td></tr>
<tr><td><code id="LowLand_+3A_key">Key</code></td>
<td>
<p>[1:n] the keys of the data or [] or 0</p>
</td></tr>
<tr><td><code id="LowLand_+3A_lowlimit">LowLimit</code></td>
<td>
<p>GeneralizedUmatrix heights up to this are considered to lie in
the low lands default: LowLimit = prctile(Uheights,80) nur die 80# tiefsten</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>LowLandBM</code></td>
<td>
<p>the unique BestMatchingUnits in the low lands of an u-Matrix</p>
</td></tr>
<tr><td><code>LowLandInd</code></td>
<td>
<p>index such that UniqueBM = BestMatchingUnits(UniqueInd,]</p>
</td></tr>
<tr><td><code>LowLandData</code></td>
<td>
<p>Data reduced to LowLand:   LowLandData = Data(LowLandInd,]</p>
</td></tr>
<tr><td><code>LowLandCls</code></td>
<td>
<p>Cls reduced to LowLand:   LowLandCls  = Cls(LowLandInd)</p>
</td></tr>
<tr><td><code>LowLandKey</code></td>
<td>
<p>Key reduced to LowLand:   LowLandKey  = Key(LowLandInd)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>ALU 2021 in matlab, MCT reimplemented in R
</p>

<hr>
<h2 id='NormalizeUmatrix'>
Normalize Umatrix
</h2><span id='topic+NormalizeUmatrix'></span>

<h3>Description</h3>

<p>Normalizing the U-matrix using the abstact U-Matrix concept [Loetsch/Ultsch, 2014].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NormalizeUmatrix(Data, Umatrix, BestMatches)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NormalizeUmatrix_+3A_data">Data</code></td>
<td>

<p>[1:n,1:d] numerical matrix of data with n cases and d variables
</p>
</td></tr>
<tr><td><code id="NormalizeUmatrix_+3A_umatrix">Umatrix</code></td>
<td>
<p> [1:lines,1:Columns] matrix of U-heights</p>
</td></tr>
<tr><td><code id="NormalizeUmatrix_+3A_bestmatches">BestMatches</code></td>
<td>
<p>[1:n,1:2] Bestmatching units.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>see publication [Loetsch/Ultsch, 2014]..
</p>


<h3>Value</h3>

<p>Normalized Umatrix[1:lines,1:Columns] using the abstact U-Matrix concept.
</p>


<h3>Author(s)</h3>

<p>Felix Pape, Michael Thrun
</p>


<h3>References</h3>

<p>Loetsch, J., Ultsch, A.: Exploiting the structures of the U-matrix, in Villmann, T., Schleif, F.-M., Kaden, M. &amp; Lange, M. (eds.), Proc. Advances in Self-Organizing Maps and Learning Vector Quantization, pp. 249-257, Springer International Publishing, Mittweida, Germany, 2014.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Chainlink")
Data=Chainlink$Data
Cls=Chainlink$Cls
InputDistances=as.matrix(dist(Data))
res=cmdscale(d=InputDistances, k = 2, eig = TRUE, add = FALSE, x.ret = FALSE)
ProjectedPoints=as.matrix(res$points)
#see also ProjectionBasedClustering package for other common projection methods


  resUmatrix=GeneralizedUmatrix(Data,ProjectedPoints)
  ## Normalization
  normalizedUmatrix=NormalizeUmatrix(Data,resUmatrix$Umatrix,resUmatrix$Bestmatches)
  ## visualization
  TopviewTopographicMap(GeneralizedUmatrix = normalizedUmatrix,resUmatrix$Bestmatches)



</code></pre>

<hr>
<h2 id='plotTopographicMap'>
Visualizes the generalized U-matrix in 3D
</h2><span id='topic+plotTopographicMap'></span>

<h3>Description</h3>

<p>The generalized U-matrix is visualized as the topographic map with hypsometric tints. The topographic map represents high-dimensional distance and density-based structurs in form of a 3D landscape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTopographicMap(GeneralizedUmatrix, BestMatchingUnits,

Cls=NULL,ClsColors=NULL,Imx=NULL,Names=NULL,

BmSize=0.5,RenderingContourLines=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotTopographicMap_+3A_generalizedumatrix">GeneralizedUmatrix</code></td>
<td>
<p>[1:Lines,1:Columns] U-matrix to be plotted, numerical
matrix storing the U-heights, see [Thrun, 2018] for definition.</p>
</td></tr>
<tr><td><code id="plotTopographicMap_+3A_bestmatchingunits">BestMatchingUnits</code></td>
<td>
<p>[1:n,1:2], Positions of bestmatches to be plotted as
spheres onto the topographic map</p>
</td></tr>
<tr><td><code id="plotTopographicMap_+3A_cls">Cls</code></td>
<td>
<p>[1:n], numerical vector of classification of <code>k</code> clusters, one
label for each bestmatch at that given point</p>
</td></tr>
<tr><td><code id="plotTopographicMap_+3A_clscolors">ClsColors</code></td>
<td>
<p>Vector of colors that will be used to colorize the different
clusters, default is GeneralizedUmatrix::DefaultColorSequence</p>
</td></tr>
<tr><td><code id="plotTopographicMap_+3A_imx">Imx</code></td>
<td>
<p>a mask (Imx) that will be used to cut out the U-matrix</p>
</td></tr>
<tr><td><code id="plotTopographicMap_+3A_names">Names</code></td>
<td>
<p>If set: [1:k] character vector naming the k clusters for the
legend. In this case, further parameters with the possibility to adjust are:
<code>NamesCex</code>: (size); <code>NamesPosition</code>: Legend position;
<code>NamesTitle</code>: title of legend; <code>NamesColors</code>: colors if ClsColors are
not default (NULL), etc.
</p>
</td></tr>
<tr><td><code id="plotTopographicMap_+3A_bmsize">BmSize</code></td>
<td>
<p>size(diameter) of the points in the visualizations. The points
represent the BestMatchingUnits</p>
</td></tr>
<tr><td><code id="plotTopographicMap_+3A_renderingcontourlines">RenderingContourLines</code></td>
<td>
<p>FALSE: disables plotting of contour lines resulting
in a much faster plot.</p>
</td></tr>
<tr><td><code id="plotTopographicMap_+3A_...">...</code></td>
<td>
<p>Besides the legend/names parameter the list of further parameters,
use only of you know what you are doing:
</p>

<dl>
<dt>Tiled</dt><dd><p>Should the U-matrix be drawn 4times?</p>
</dd>
<dt>ShowAxis</dt><dd><p>shall the axis be shown?</p>
</dd>
<dt>NoLevels</dt><dd><p>number of contour lines</p>
</dd>
<dt>ExtendBorders</dt><dd><p>scalar, extends U-matrix by toroidal continuation of the given U-matrix</p>
</dd>
<dt>Colormap</dt><dd><p>in the case of density p matrix...</p>
</dd>
<dt>title</dt><dd><p>same as main</p>
</dd>
<dt>main</dt><dd><p>same as title</p>
</dd>
<dt>sub</dt><dd><p>same as in <code><a href="base.html#topic+plot">plot</a></code></p>
</dd>
<dt>xlab</dt><dd><p>same as in <code><a href="base.html#topic+plot">plot</a></code></p>
</dd>   
<dt>ylab</dt><dd><p>same as in <code><a href="base.html#topic+plot">plot</a></code></p>
</dd>
<dt>zlab</dt><dd><p>same as in <code><a href="base.html#topic+plot">plot</a></code></p>
</dd>
<dt>NamesPosition</dt><dd><p>same as in <code><a href="rgl.html#topic+bgplot3d">bgplot3d</a></code></p>
</dd>
<dt>NamesColors</dt><dd><p>same as col in <code><a href="rgl.html#topic+bgplot3d">bgplot3d</a></code></p>
</dd>
<dt>NamesCex</dt><dd><p>same as cex in <code><a href="rgl.html#topic+bgplot3d">bgplot3d</a></code></p>
</dd>
<dt>NamesTitle</dt><dd><p>same as title in <code><a href="rgl.html#topic+bgplot3d">bgplot3d</a></code></p>
</dd>
<dt>NamesPch</dt><dd><p>same as pch in <code><a href="rgl.html#topic+bgplot3d">bgplot3d</a></code></p>
</dd>
</dl>

</td></tr>
</table>


<h3>Details</h3>

<p>The visualization of this function is a topographic map with hypsometric tints (Thrun, Lerch, L?tsch, &amp; Ultsch, 2016).
&quot;Hypsometric tints are surface colors that represent ranges of elevation (Patterson and Kelso 2004). Here, contour lines are combined with a specific color scale. The color scale is chosen to display various valleys, ridges, and basins: blue colors indicate small distances (sea level), green and brown colors indicate middle distances (low hills), and white colors indicate vast distances (high mountains covered with snow and ice). Valleys and basins represent clusters, and the watersheds of hills and mountains represent the borders between clusters. In this 3D landscape, the borders of the visualization are cyclically connected with a periodicity (L,C). The number of clusters can be estimated by the number of valleys of the visualization. The clustering is valid if mountains do not partition clusters indicated by colored points of the same color and colored regions of points (see examples in section 4.1 and 4.2).&quot;[Thrun/Ultsch, 2020].  
</p>
<p>A central problem in clustering is the correct estimation of the number of clusters. This is addressed by the topographic map which allows assessing the number of clusters as the number of valleys (Thrun et al., 2016). Please see chapter 5 of [Thrun, 2018] for further details.
</p>


<h3>Value</h3>

<p>An object of class &quot;htmlwidget&quot; in mode invisible, please <code><a href="rgl.html#topic+rglwidget">rglwidget</a></code> for details.
</p>


<h3>Note</h3>

<p>First version of algorithm was partly based on the U-matrix package.
</p>


<h3>Author(s)</h3>

<p>Michael Thrun
</p>


<h3>References</h3>

<p>[Thrun, 2018]  Thrun, M. C.: Projection Based Clustering through Self-Organization and Swarm Intelligence, doctoral dissertation 2017, Springer, Heidelberg, ISBN: 978-3-658-20539-3, <a href="https://doi.org/10.1007/978-3-658-20540-9">doi:10.1007/978-3-658-20540-9</a>, 2018. 
</p>
<p>[Thrun et al., 2016]  Thrun, M. C., Lerch, F., Loetsch, J., &amp; Ultsch, A.: Visualization and 3D Printing of Multivariate Data of Biomarkers, in Skala, V. (Ed.), International Conference in Central Europe on Computer Graphics, Visualization and Computer Vision (WSCG), Vol. 24, Plzen, http://wscg.zcu.cz/wscg2016/short/A43-full.pdf, 2016.
</p>
<p>[Thrun/Ultsch, 2020]  Thrun, M. C., &amp; Ultsch, A. : Using Projection based Clustering to Find Distance and Density based Clusters in High-Dimensional Data, Journal of Classification, DOI 10.1007/s00357-020-09373-2, in press, Springer, 2020. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GeneralizedUmatrix">GeneralizedUmatrix</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Chainlink")
Data=Chainlink$Data
Cls=Chainlink$Cls
InputDistances=as.matrix(dist(Data))
res=cmdscale(d=InputDistances, k = 2, eig = TRUE, add = FALSE, x.ret = FALSE)
ProjectedPoints=as.matrix(res$points)
#see also ProjectionBasedClustering package for other common projection methods

resUmatrix=GeneralizedUmatrix(Data,ProjectedPoints)
## visualization
plotTopographicMap(GeneralizedUmatrix = resUmatrix$Umatrix,resUmatrix$Bestmatches)


## Open window in specific resolution
#relevant if Names given

library(rgl)
r3dDefaults$windowRect = c(0,0,1200,1200) 
plotTopographicMap(GeneralizedUmatrix = resUmatrix$Umatrix,resUmatrix$Bestmatches)

## Not run: 
## To save as STL for 3D printing
 rgl::writeSTL("GenerelizedUmatrix_3d_model.stl")

## Save the visualization as a picture with
library(rgl)
rgl.snapshot('test.png')

## End(Not run)

## Save interactive html file
## Not run: 
widgets=plotTopographicMap(GeneralizedUmatrix = resUmatrix$Umatrix,resUmatrix$Bestmatches)
if(requireNamespace("htmlwidgets"))
  htmlwidgets::saveWidget(widgets,file = "interactiveTopographicMap.html")

## End(Not run)

</code></pre>

<hr>
<h2 id='ReduceToLowLand'>ReduceToLowLand</h2><span id='topic+ReduceToLowLand'></span>

<h3>Description</h3>

<p>ReduceToLowLand
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ReduceToLowLand(BestMatchingUnits, GeneralizedUmatrix, Data = NULL, Cls = NULL,
Key = NULL, LowLimit,Force=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ReduceToLowLand_+3A_bestmatchingunits">BestMatchingUnits</code></td>
<td>
<p>[1:n,1:n,1:n] BestMatchingUnits =[BMkey, BMLineCoords,
BMColCoords]</p>
</td></tr>
<tr><td><code id="ReduceToLowLand_+3A_generalizedumatrix">GeneralizedUmatrix</code></td>
<td>
<p>[1:l,1:c] U-Matrix heights in Matrix form</p>
</td></tr>
<tr><td><code id="ReduceToLowLand_+3A_data">Data</code></td>
<td>
<p>[1:n,1:d] data cases in lines, variables in Columns or [] or 0</p>
</td></tr>
<tr><td><code id="ReduceToLowLand_+3A_cls">Cls</code></td>
<td>
<p>[1:n] a possible classif( ication of the data or [] or 0</p>
</td></tr>
<tr><td><code id="ReduceToLowLand_+3A_key">Key</code></td>
<td>
<p>[1:n] the keys of the data or [] or 0</p>
</td></tr>
<tr><td><code id="ReduceToLowLand_+3A_lowlimit">LowLimit</code></td>
<td>
<p>GeneralizedUmatrix heights up to this are considered to lie in
the low lands default: LowLimit = prctile(Uheights,80) nur die 80# tiefsten</p>
</td></tr>
<tr><td><code id="ReduceToLowLand_+3A_force">Force</code></td>
<td>
<p>==TRUE: Always perform reduction</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>LowLandBM</code></td>
<td>
<p>the unique BestMatchingUnits in the low lands of an u-Matrix</p>
</td></tr>
<tr><td><code>LowLandInd</code></td>
<td>
<p>index such that UniqueBM = BestMatchingUnits(UniqueInd,]</p>
</td></tr>
<tr><td><code>LowLandData</code></td>
<td>
<p>Data reduced to LowLand:   LowLandData = Data(LowLandInd,]</p>
</td></tr>
<tr><td><code>LowLandCls</code></td>
<td>
<p>Cls  reduced to LowLand:   LowLandCls  = Cls(LowLandInd)</p>
</td></tr>
<tr><td><code>LowLandKey</code></td>
<td>
<p>Key  reduced to LowLand:   LowLandKey  = Key(LowLandInd)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>ALU 2021 in matlab, MCT reimplemented in R
</p>

<hr>
<h2 id='sESOM4BMUs'>
simplified ESOM
</h2><span id='topic+sESOM4BMUs'></span>

<h3>Description</h3>

<p>internfunction for the simplified ESOM Algorithmus [Thrun/Ultsch, 2020] for fixed BestMatchingUnits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sESOM4BMUs(BMUs,Data, esom, toroid, 

CurrentRadius,ComputeInR=FALSE,Parallel=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sESOM4BMUs_+3A_bmus">BMUs</code></td>
<td>
<p>[1:Lines,1:Columns], BestMAtchingUnits generated by
ProjectedPoints2Grid()</p>
</td></tr>
<tr><td><code id="sESOM4BMUs_+3A_data">Data</code></td>
<td>
<p>[1:n,1:d] array of data: n cases in rows, d variables in columns</p>
</td></tr>
<tr><td><code id="sESOM4BMUs_+3A_esom">esom</code></td>
<td>
<p>[1:Lines,1:Columns,1:weights] array of NeuronWeights, see
ListAsEsomNeurons()</p>
</td></tr>
<tr><td><code id="sESOM4BMUs_+3A_toroid">toroid</code></td>
<td>
<p>TRUE/FALSE - topology of points</p>
</td></tr>
<tr><td><code id="sESOM4BMUs_+3A_currentradius">CurrentRadius</code></td>
<td>
<p>number betweeen 1 to x</p>
</td></tr>
<tr><td><code id="sESOM4BMUs_+3A_computeinr">ComputeInR</code></td>
<td>
<p>=T: Rcode, =F Cpp Code</p>
</td></tr>
<tr><td><code id="sESOM4BMUs_+3A_parallel">Parallel</code></td>
<td>
<p>=T: Rcode, =F Cpp Code</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Algorithm is described in [Thrun, 2018, p. 48, Listing 5.1].
</p>


<h3>Value</h3>

<table>
<tr><td><code>esom</code></td>
<td>
<p>array [1:Lines,1:Columns,1:d], d is the dimension of the weights,
the same as in the ESOM algorithm. modified esomneuros regarding a predefined
neighborhood defined by a radius</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Usually not for seperated usage!</p>


<h3>Author(s)</h3>

<p>Michael Thrun
</p>


<h3>References</h3>

<p>[Thrun/Ultsch, 2020]  Thrun, M. C., &amp; Ultsch, A.: Uncovering High-Dimensional Structures of Projections from Dimensionality Reduction Methods, MethodsX, Vol. in press, pp. 101093. doi 10.1016/j.mex.2020.101093, 2020.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GeneralizedUmatrix">GeneralizedUmatrix</a></code>
</p>

<hr>
<h2 id='setdiffMatrix'>setdiffMatrix shortens Matrix2Curt by those rows that are in both matrices.</h2><span id='topic+setdiffMatrix'></span>

<h3>Description</h3>

<p>setdiffMatrix shortens Matrix2Curt by those rows that are in both matrices.</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="setdiffMatrix_+3A_matrix2curt">Matrix2Curt</code></td>
<td>
<p>[n,k] matrix, which will be shortened by x rows</p>
</td></tr>
<tr><td><code id="setdiffMatrix_+3A_matrix2compare">Matrix2compare</code></td>
<td>
<p>[m,k] matrix whose rows will be compared to those of
Matrix2Curt x rows in Matrix2compare equal rows of Matrix2Curt (order of rows is
irrelevant). Has the same number of columns as Matrix2Curt.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>V$CurtedMatrix</code></td>
<td>
<p>[n-x,k] Shortened Matrix2Curt</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Thrun with the help of Catharina Lippmann</p>

<hr>
<h2 id='TopviewTopographicMap'>
Top view of the topographic map in 2D
</h2><span id='topic+TopviewTopographicMap'></span>

<h3>Description</h3>

<p>Fast visualization of the generalized U-matrix in 2D which visualizes high-dimensional distance and density based structurs of the combination two-dimensional scatter plots (projections) with high-dimensional data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TopviewTopographicMap(GeneralizedUmatrix, BestMatchingUnits,

Cls, ClsColors = NULL, Imx = NULL,

ClsNames = NULL, BmSize = 6, DotLineWidth = 2,

alpha = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TopviewTopographicMap_+3A_generalizedumatrix">GeneralizedUmatrix</code></td>
<td>
<p>[1:Lines,1:Columns] U-matrix to be plotted, numerical
matrix storing the U-heights, see [Thrun, 2018] for definition.</p>
</td></tr>
<tr><td><code id="TopviewTopographicMap_+3A_bestmatchingunits">BestMatchingUnits</code></td>
<td>
<p>[1:n,1:2], Positions of bestmatches to be plotted onto
the U-matrix</p>
</td></tr>
<tr><td><code id="TopviewTopographicMap_+3A_cls">Cls</code></td>
<td>
<p>[1:n], numerical vector of classification of <code>k</code> classes for the
bestmatch at the given point</p>
</td></tr>
<tr><td><code id="TopviewTopographicMap_+3A_clscolors">ClsColors</code></td>
<td>
<p>Vector of colors that will be used to colorize the different
classes</p>
</td></tr>
<tr><td><code id="TopviewTopographicMap_+3A_imx">Imx</code></td>
<td>
<p>a mask (Imx) that will be used to cut out the U-matrix</p>
</td></tr>
<tr><td><code id="TopviewTopographicMap_+3A_clsnames">ClsNames</code></td>
<td>
<p>If set: [1:k] character vector naming the k classes for the
legend. In this case, further parameters with the possibility to adjust are:
<code>LegendCex</code>: (size);
<code>NamesOrientation</code>: Legend position &quot;v&quot; or &quot;h&quot;;
<code>NamesTitle</code>: title of legend.
</p>
</td></tr>
<tr><td><code id="TopviewTopographicMap_+3A_bmsize">BmSize</code></td>
<td>
<p>size(diameter) of the points in the visualizations. The points
represent the BestMatchingUnits</p>
</td></tr>
<tr><td><code id="TopviewTopographicMap_+3A_dotlinewidth">DotLineWidth</code></td>
<td>
<p>...</p>
</td></tr>
<tr><td><code id="TopviewTopographicMap_+3A_alpha">alpha</code></td>
<td>
<p>...</p>
</td></tr>
<tr><td><code id="TopviewTopographicMap_+3A_...">...</code></td>
<td>


<dl>
<dt>Tiled</dt><dd><p>Should the U-matrix be drawn 4times?</p>
</dd>
<dt>main</dt><dd><p>set specific title in plot</p>
</dd>
<dt>ExtendBorders</dt><dd><p>scalar, extends U-matrix by toroidal continuation of the given U-matrix</p>
</dd>
<dt>MainCex</dt><dd><p>scalar, magnification to be used for legend</p>
</dd>
<dt>LegendCex</dt><dd><p>scalar, magnification to be used for main titles</p>
</dd>
<dt>_</dt><dd><p>Further Arguments relevant for interactive shiny application</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Details</h3>

<p>Please see <code><a href="#topic+plotTopographicMap">plotTopographicMap</a></code>. This function is currently still experimental because not all functionallity is fully tested yet.
</p>


<h3>Value</h3>

<p>plotly handler
</p>


<h3>Note</h3>

<p>Names are currently under development, Imx in testing phase.
</p>


<h3>Author(s)</h3>

<p>Tim Schreier, Luis Winckelmann, Michael Thrun
</p>


<h3>References</h3>

<p>[Thrun, 2018]  Thrun, M. C.: Projection Based Clustering through Self-Organization and Swarm Intelligence, doctoral dissertation 2017, Springer, Heidelberg, ISBN: 978-3-658-20539-3, <a href="https://doi.org/10.1007/978-3-658-20540-9">doi:10.1007/978-3-658-20540-9</a>, 2018. 
</p>
<p>[Thrun et al., 2016]  Thrun, M. C., Lerch, F., Loetsch, J., &amp; Ultsch, A.: Visualization and 3D Printing of Multivariate Data of Biomarkers, in Skala, V. (Ed.), International Conference in Central Europe on Computer Graphics, Visualization and Computer Vision (WSCG), Vol. 24, Plzen, http://wscg.zcu.cz/wscg2016/short/A43-full.pdf, 2016.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotTopographicMap">plotTopographicMap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("Chainlink")
Data=Chainlink$Data
Cls=Chainlink$Cls
InputDistances=as.matrix(dist(Data))
res=cmdscale(d=InputDistances, k = 2, eig = TRUE, add = FALSE, x.ret = FALSE)
ProjectedPoints=as.matrix(res$points)
#see also ProjectionBasedClustering package for other common projection methods

resUmatrix=GeneralizedUmatrix(Data,ProjectedPoints)
## visualization
TopviewTopographicMap(GeneralizedUmatrix = resUmatrix$Umatrix,resUmatrix$Bestmatches)


</code></pre>

<hr>
<h2 id='trainstepC'>
internal function for s-esom
</h2><span id='topic+trainstepC'></span>

<h3>Description</h3>

<p>Does the training for fixed bestmatches in one epoch of the sESOM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trainstepC(vx,vy, DataSampled,BMUsampled,Lines,Columns, Radius, toroid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trainstepC_+3A_vx">vx</code></td>
<td>
<p>array [1:Lines,1:Columns,1:Weights], WeightVectors that will be trained, internally transformed von NumericVector to cube</p>
</td></tr>
<tr><td><code id="trainstepC_+3A_vy">vy</code></td>
<td>
<p>array [1:Lines,1:Columns,1:2], meshgrid for output distance computation</p>
</td></tr>
<tr><td><code id="trainstepC_+3A_datasampled">DataSampled</code></td>
<td>
<p>NumericMatrix, n cases shuffled Dataset[1:n,1:d] by <code>sample</code> </p>
</td></tr>
<tr><td><code id="trainstepC_+3A_bmusampled">BMUsampled</code></td>
<td>
<p>NumericMatrix, n cases shuffled BestMatches[1:n,1:2] by <code>sample</code> in the same way as <code>DataSampled</code> </p>
</td></tr>
<tr><td><code id="trainstepC_+3A_lines">Lines</code></td>
<td>
<p>double, Height of the grid</p>
</td></tr>
<tr><td><code id="trainstepC_+3A_columns">Columns</code></td>
<td>
<p>double, Width of the grid</p>
</td></tr>
<tr><td><code id="trainstepC_+3A_radius">Radius</code></td>
<td>
<p>double, The current Radius that should be used to define neighbours to the bm</p>
</td></tr>
<tr><td><code id="trainstepC_+3A_toroid">toroid</code></td>
<td>
<p>bool, Should the grid be considered with cyclically connected borders?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Algorithm is described in [Thrun, 2018, p. 48, Listing 5.1].
</p>


<h3>Value</h3>

<p>WeightVectors, array[1:Lines,1:Columns,1:weights] with the adjusted Weights</p>


<h3>Note</h3>

<p>Usually not for seperated usage!</p>


<h3>Author(s)</h3>

<p>Michael Thrun
</p>


<h3>References</h3>

<p>[Thrun, 2018]  Thrun, M. C.: Projection Based Clustering through Self-Organization and Swarm Intelligence, doctoral dissertation 2017, Springer, Heidelberg, ISBN: 978-3-658-20539-3, <a href="https://doi.org/10.1007/978-3-658-20540-9">doi:10.1007/978-3-658-20540-9</a>, 2018. 
</p>

<hr>
<h2 id='Uheights4Data'>Uheights4Data</h2><span id='topic+Uheights4Data'></span>

<h3>Description</h3>

<p>Uheights4Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Uheights4Data(BestMatchingUnits, GeneralizedUmatrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Uheights4Data_+3A_bestmatchingunits">BestMatchingUnits</code></td>
<td>
<p>[1:n,1:d] BMKey = BestMatchingUnits[,1)</p>
</td></tr>
<tr><td><code id="Uheights4Data_+3A_generalizedumatrix">GeneralizedUmatrix</code></td>
<td>
<p>[1:Lines,1:Columns] a GeneralizedUmatrix</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Uheights</code></td>
<td>
<p>Uheights</p>
</td></tr>
<tr><td><code>BMLineCoords</code></td>
<td>
<p>BMLineCoords</p>
</td></tr>
<tr><td><code>BMColCoords</code></td>
<td>
<p>BMColCoords</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>ALU 2021 in matlab, MCT reimplemented in 
</p>

<hr>
<h2 id='UmatrixColormap'>U-Matrix colors</h2><span id='topic+UmatrixColormap'></span>

<h3>Description</h3>

<p>Defines the default color sequence for plots made for Umatrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("UmatrixColormap")</code></pre>


<h3>Format</h3>

<p>Returns the vectors for a (heat) colormap.
</p>

<hr>
<h2 id='UniqueBestMatchingUnits'>UniqueBestMatchingUnits</h2><span id='topic+UniqueBestMatchingUnits'></span>

<h3>Description</h3>

<p>UniqueBestMatchingUnits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UniqueBestMatchingUnits(NonUniqueBestMatchingUnits)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UniqueBestMatchingUnits_+3A_nonuniquebestmatchingunits">NonUniqueBestMatchingUnits</code></td>
<td>
<p>[1:n,1:n,1:n] UniqueBestMatchingUnits =[BMkey, BMLineCoords, BMColCoords]</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>UniqueBM</code></td>
<td>
<p>[1:u,1:u,1:u] UniqueBM =[UBMkey, UBMLineCoords, UBMColCoords]</p>
</td></tr>
<tr><td><code>UniqueInd</code></td>
<td>
<p>Index such that UniqueBM = UniqueBestMatchingUnits(UniqeInd,:)</p>
</td></tr>
<tr><td><code>Uniq2AllInd</code></td>
<td>
<p>Index such that UniqueBestMatchingUnits    = UniqueBM(Uniq2AllInd,:)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>ALU 2021 in matlab, MCT reimplemented in R
</p>

<hr>
<h2 id='upscaleUmatrix'>
Upscale a Umatrix grid
</h2><span id='topic+upscaleUmatrix'></span>

<h3>Description</h3>

<p>Use linear interpolation to increase the size of a umatrix. This can be used to produce nicer ggplot plots in <code><a href="#topic+plotTopographicMap">plotTopographicMap</a></code> and is going to be used for further normalization of the umatrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upscaleUmatrix(Umatrix, Factor = 2,BestMatches, Imx)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="upscaleUmatrix_+3A_umatrix">Umatrix</code></td>
<td>
<p>The umatrix which should be upscaled</p>
</td></tr>
<tr><td><code id="upscaleUmatrix_+3A_bestmatches">BestMatches</code></td>
<td>
<p>The BestMatches which should be upscaled</p>
</td></tr>
<tr><td><code id="upscaleUmatrix_+3A_factor">Factor</code></td>
<td>
<p>Optional: The factor by which the axes will be scaled. Be aware
that the size of the matrix will grow by Factor squared. Default: 2</p>
</td></tr>
<tr><td><code id="upscaleUmatrix_+3A_imx">Imx</code></td>
<td>
<p>Optional: Island cutout of the umatrix. Should also be scaled to the
new size of the umatrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A List consisting of:
</p>
<table>
<tr><td><code>Umatrix</code></td>
<td>
<p>A matrix representing the upscaled umatrix.</p>
</td></tr>
<tr><td><code>BestMatches</code></td>
<td>
<p>If BestMatches was given as parameter: The rescaled
BestMatches for an island cutout. Otherwise: <code>NULL</code></p>
</td></tr>
<tr><td><code>Imx</code></td>
<td>
<p>If Imx was given as parameter: The rescaled matrix for an island
cutout. Otherwise: <code>NULL</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Felix Pape
</p>

<hr>
<h2 id='XYcoords2LinesColumns'>XYcoords2LinesColumns(X,Y) Converts points given as x(i),y(i) coordinates
to integer coordinates Columns(i),Lines(i)</h2><span id='topic+XYcoords2LinesColumns'></span>

<h3>Description</h3>

<p>XYcoords2LinesColumns(X,Y) Converts points given as x(i),y(i) coordinates to
integer coordinates Columns(i),Lines(i)
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="XYcoords2LinesColumns_+3A_x">X</code></td>
<td>
<p>[1:n] first coordinate: x(i), y(i) is the i-th point on a plane</p>
</td></tr>
<tr><td><code id="XYcoords2LinesColumns_+3A_y">Y</code></td>
<td>
<p>[1:n] second coordinate: x(i), y(i) is the i-th point on a plane</p>
</td></tr>
<tr><td><code id="XYcoords2LinesColumns_+3A_minneurons">minNeurons</code></td>
<td>
<p>minimal size of the corresponding grid i.e
max(Lines)*max(Columns)&gt;=MinGridSize , default MinGridSize = 4096 defined by the
numer of neurons</p>
</td></tr>
<tr><td><code id="XYcoords2LinesColumns_+3A_maxdifferentpoints">MaxDifferentPoints</code></td>
<td>
<p>TRUE: the discretization error is minimal FALSE:
number of Lines and Columns is minimal</p>
</td></tr>
<tr><td><code id="XYcoords2LinesColumns_+3A_plotit">PlotIt</code></td>
<td>
<p>Plots the result</p>
</td></tr>
<tr><td><code id="XYcoords2LinesColumns_+3A_na.rm">na.rm</code></td>
<td>
<p>if non finite values should be disregarded in the computation then set to TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Non finite values are not filtered out even if na.rm=TRUE, only ignored. Details are written down in [Thrun, 2018, p. 47].
</p>


<h3>Value</h3>

<p>GridConvertedPoints[1:Columns,1:Lines,2]  IntegerPositions on a grid
corresponding to x,y</p>


<h3>Author(s)</h3>

<p>Michael Thrun</p>


<h3>References</h3>

<p>[Thrun, 2018]  Thrun, M. C.: Projection Based Clustering through Self-Organization and Swarm Intelligence, doctoral dissertation 2017, Springer, Heidelberg, ISBN: 978-3-658-20539-3, <a href="https://doi.org/10.1007/978-3-658-20540-9">doi:10.1007/978-3-658-20540-9</a>, 2018. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Chainlink")
Data=Chainlink$Data
InputDistances=as.matrix(dist(Data))
res=cmdscale(d=InputDistances, k = 2, eig = TRUE, add = FALSE, x.ret = FALSE)
ProjectedPoints=as.matrix(res$points)
GridConvertedPoints=XYcoords2LinesColumns(ProjectedPoints[,1],ProjectedPoints[,2],PlotIt=FALSE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
