<!DOCTYPE html><html><head><title>Help for package pln</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pln}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pln-package'>
<p>Polytomous Logit-Normit (Graded Logistic) Model Estimation</p></a></li>
<li><a href='#item5fr'><p>5-item Test Data Set</p></a></li>
<li><a href='#item9cat5'><p>9 Item Test Data Set</p></a></li>
<li><a href='#nrmlepln'><p>Full information maximum likelihood and bivariate composite likelihood estimation for</p>
polytomous logit-normit (graded logistic) model</a></li>
<li><a href='#simulpln'><p>Simulate data from polytomous logit-normit (graded logistic) model</p></a></li>
<li><a href='#startalphas'><p>Starting values for polytomous logit-normit model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Polytomous Logit-Normit (Graded Logistic) Model Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-07-28</td>
</tr>
<tr>
<td>Author:</td>
<td>Carl F. Falk and Harry Joe</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carl F. Falk &lt;cffalk@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs bivariate composite likelihood and full
        information maximum likelihood estimation for polytomous
        logit-normit (graded logistic) item response theory (IRT)
        models.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.9.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-07-29 17:31:35 UTC; cfalk</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-07-30 00:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='pln-package'>
Polytomous Logit-Normit (Graded Logistic) Model Estimation
</h2><span id='topic+pln-package'></span><span id='topic+pln'></span>

<h3>Description</h3>

<p>Performs bivariate composite likelihood and full information maximum
likelihood estimation for polytomous logit-normit (graded logistic) item response theory (IRT) models.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> pln</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.2-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-07-28</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This package currently contains several functions performing estimation of unidimensional (single latent
trait) polytomous logit-normit models (also known graded logistic) using bivariate composite likelihood
and full information maximum likelihood estimation.
</p>


<h3>Acknowledgment</h3>

<p>Some code from the ltm package (version 0.9-7) was modified for counting the frequency of response patterns.
</p>


<h3>Author(s)</h3>

<p>Carl Falk <a href="mailto:cffalk@gmail.com">cffalk@gmail.com</a>,
Harry Joe
</p>
<p>Maintainer: Carl F. Falk <a href="mailto:cffalk@gmail.com">cffalk@gmail.com</a>
</p>


<h3>References</h3>

<p>Bartholomew, D., Knott, M., and Moustaki, I. (2011). <em>Latent Variable 
Models and Factor Analysis: A Unified Approach</em>, 3rd Edition. Wiley. 
</p>
<p>Maydeu-Olivares, A., and Joe, H. (2005). Limited and full information estimation
and goodness-of-fit testing in <code class="reqn">2^n</code> contingency tables: A unified framework.
<em>Journal of the American Statistical Association, 100</em>, 1009-1020.
</p>
<p>Maydeu-Olivares, A., and Joe, H. (2006). Limited information and goodness-of-fit
testing in multidimensional contingency tables. <em>Psychometrika, 71</em>,
713-732.
</p>
<p>Varin, C., Reid, N. and Firth, D. (2011). An overview of composite likelihood
methods. <em>Statistica Sinica, 21</em>, 5-42.
</p>

<hr>
<h2 id='item5fr'>5-item Test Data Set</h2><span id='topic+item5fr'></span>

<h3>Description</h3>

<p>A simulated data set with a 5 items, each with 3 ordinal categories labeled 
as 0,1,2. Each row corresponds to a response pattern with the sixth column containing the frequency of each response pattern.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(item5fr)</code></pre>

<hr>
<h2 id='item9cat5'>9 Item Test Data Set</h2><span id='topic+item9cat5'></span>

<h3>Description</h3>

<p>A simulated data set with a 9 items, each with 5 ordinal categories labeled 
as 0,1,2,3,4. Each row corresponds to a single individual's response on the 9 items.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(item9cat5)</code></pre>

<hr>
<h2 id='nrmlepln'>Full information maximum likelihood and bivariate composite likelihood estimation for
polytomous logit-normit (graded logistic) model</h2><span id='topic+nrmlepln'></span><span id='topic+nrmlerasch'></span><span id='topic+nrbcpln'></span>

<h3>Description</h3>

<p>Full information maximum likelihood and bivariate composite likelihood estimation for
polytomous logit-normit and Rasch models, via Newton Raphson iterations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nrmlepln(x, ncat, nitem=NULL, alphas=NULL, betas=NULL, abound=c(-10,10),
         bbound=c(-1,10), nq=48, mxiter=200, m2=TRUE, iprint=FALSE)
nrmlerasch(x, ncat, nitem=NULL, alphas=NULL, abound=c(-10,10),
         bbound=c(-1,10), nq=48, mxiter=200, m2=TRUE, iprint=FALSE)
nrbcpln(x, ncat, nitem=NULL, alphas=NULL, betas=NULL, abound=c(-10,10),
         bbound=c(-1,10), nq=48, mxiter=200, se=TRUE, iprint=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nrmlepln_+3A_x">x</code></td>
<td>
<p>A data matrix. Data can be in one of two formats: 1) raw data
where the number of rows corresponds to an individual's response and
each column represents an item, and 2) a matrix of dimensions
<code>nrec</code><code class="reqn">\times</code>(<code>nitem</code>+1) where each row corresponds to a
response pattern and the last column is the frequency of that response
pattern. A data matrix of the second type requires input for <code>nitem</code>
and <code>nrec</code>.</p>
</td></tr>
<tr><td><code id="nrmlepln_+3A_ncat">ncat</code></td>
<td>
<p>Number of ordinal categories for each item, coded as
0,...,(<code>ncat</code>-1). Currently supported are items that have the same number of categories.</p>
</td></tr>
<tr><td><code id="nrmlepln_+3A_nitem">nitem</code></td>
<td>
<p>Number of items. If omitted, it is assumed that <code>x</code> contains
a data matrix of the first type (raw data) and the number of
columns in <code>x</code> will be selected as the number of items.</p>
</td></tr>
<tr><td><code id="nrmlepln_+3A_alphas">alphas</code></td>
<td>
<p>A vector of length <code>nitem</code><code class="reqn">\times</code>(<code>ncat</code>-1)
corresponding to starting values for the (decreasing) cutpoints
for the items. If omitted, these will be computed from the function <code><a href="#topic+startalphas">startalphas</a></code>.</p>
</td></tr>
<tr><td><code id="nrmlepln_+3A_betas">betas</code></td>
<td>
<p>A vector of length <code>nitem</code> corresponding to starting values for the
beta vectors of slopes. If omitted, these will be computed from the function
<code><a href="#topic+startbetas">startbetas</a></code>. For the polytomous logit-normit, there is one slope
for each item; for the Rasch model, there is a common slope beta for
all of the items.</p>
</td></tr>
<tr><td><code id="nrmlepln_+3A_abound">abound</code></td>
<td>
<p>Vector of length 2 that sets upper and lower bounds on parameter estimation for
alphas. Currently experimental; changing defaults it not recommended. Estimation problems
are more likely solved by changing starting values.</p>
</td></tr>
<tr><td><code id="nrmlepln_+3A_bbound">bbound</code></td>
<td>
<p>Vector of length 2 that sets upper and lower bounds on parameter estimation for
betas. Currently experimental; changing defaults it not recommended. Estimation problems
are more likely solved by changing starting values.</p>
</td></tr>
<tr><td><code id="nrmlepln_+3A_nq">nq</code></td>
<td>
<p>Number of quadrature points to use during estimation. This argument is currently experimental. It is recommended to use the default of 48.</p>
</td></tr>
<tr><td><code id="nrmlepln_+3A_mxiter">mxiter</code></td>
<td>
<p>Maximum number of iterations for estimation.</p>
</td></tr>
<tr><td><code id="nrmlepln_+3A_m2">m2</code></td>
<td>
<p>Logical. If <code>TRUE</code>, computes goodness-of-fit statistics
from Maydeu-Olivares and Joe (2005, 2006; i.e., <code class="reqn">M_2</code>).</p>
</td></tr>
<tr><td><code id="nrmlepln_+3A_iprint">iprint</code></td>
<td>
<p>Logical. Enables debugging / diagnostic information from C code that conducts
estimation.</p>
</td></tr>
<tr><td><code id="nrmlepln_+3A_se">se</code></td>
<td>
<p>Logical. If <code>TRUE</code>, calculates standard errors for the bivariate composite
likelihood method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of graded logistic models is performed under the following parameterization:
</p>
<p style="text-align: center;"><code class="reqn">Pr(y_i = k_i| \eta) = \left\{
 \begin{array}{ll}
 1-\Psi (\alpha_{i,k} + \beta_i \eta) &amp; \mbox{if  } k_i = 0\\
 \Psi (\alpha_{i,k} + \beta_i \eta) - \Psi (\alpha_{i,k+1} + \beta_i \eta) &amp; \mbox{if  } 0 &lt; k_i &lt; m-1\\
 \Psi (\alpha_{i,k+1} + \beta_i \eta) &amp; \mbox{if  } k_i = m-1
 \end{array} \right. </code>
</p>

<p>Where the items are <code class="reqn">y_i, i = 1, \dots, n</code>, and response categories are <code class="reqn">k=0, \dots, m-1</code>. <code class="reqn">\eta</code> is the latent trait, <code class="reqn">\Psi</code> is the logistic distribution function, <code class="reqn">\alpha</code> is an intercept (cutpoint) parameter, and <code class="reqn">\beta</code> is a slope parameter. When the number of categories for the items is 2, this reduces to the 2PL parameterization:
</p>
<p style="text-align: center;"><code class="reqn">Pr(y_i = 1| \eta) = \Psi (\alpha_1 + \beta_i \eta)</code>
</p>

<p>Both <code>nrmlepln</code> and <code>nrbcpln</code> perform estimation under these parameterizations, via Newton Raphson iterations, using full information maximum likelihood (<code>nrmlepln</code>) and bivariate composite likelihood (<code>nrbcpln</code>). See Maydeu-Olivares and Joe (2005, 2006) for more information on bivariate composite likelihood estimation (see also Varin, Reid, and Firth, 2011). Under <code>nrmlerasch</code> a common <code class="reqn">\beta</code> parameter is estimated for all items.
</p>


<h3>Value</h3>

<p>A list containing the following slots.
</p>


<h3>Slots</h3>


<dl>
<dt><code>alphas</code></dt><dd><p>A vector of parameter estimates for alphas. Length is
<code>nitem</code><code class="reqn">\times</code>(<code>ncat</code>-1). Estimates are in order by item, e.g., all alphas
for item 1, followed by all alphas for item 2, and so on.</p>
</dd>
<dt><code>betas</code></dt><dd><p>A vector of parameter estimates for betas. Length is <code>nitem</code>.</p>
</dd>
<dt><code>nllk</code></dt><dd><p>Negative (composite) log-likelihood for polytomous 
logit-normit (or Rasch) model.</p>
</dd>
<dt><code>conv</code></dt><dd><p>Integer indicating whether estimation converged. Currently only returned for
composite likelihood estimation.</p>
</dd>
<dt><code>sealphas</code></dt><dd><p>A vector of standard errors for the alpha estimates.</p>
</dd>
<dt><code>sebetas</code></dt><dd><p>A vector of standard errors for the beta estimates.</p>
</dd>
<dt><code>invhes</code></dt><dd><p>Inverse Hessian matrix for the MLE estimates.</p>
</dd>
<dt><code>vcov</code></dt><dd><p>Asymptotic covariance matrix for the composite likelihood estimates.</p>
</dd>
<dt><code>teststat</code></dt><dd><p>Value of <code class="reqn">M_2</code>.</p>
</dd>
<dt><code>df</code></dt><dd><p>Degrees of freedom for <code class="reqn">M_2</code>.</p>
</dd>
<dt><code>pval</code></dt><dd><p>P-value for <code class="reqn">M_2</code>.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Carl F. Falk <a href="mailto:cffalk@gmail.com">cffalk@gmail.com</a>, Harry Joe
</p>


<h3>References</h3>

<p>Bartholomew, D., Knott, M., and Moustaki, I. (2011). <em>Latent Variable 
Models and Factor Analysis: A Unified Approach</em>, 3rd Edition. Wiley. 
</p>
<p>Maydeu-Olivares, A., and Joe, H. (2005). Limited and full information estimation
and goodness-of-fit testing in <code class="reqn">2^n</code> contingency tables: A unified framework.
<em>Journal of the American Statistical Association, 100</em>, 1009-1020.
</p>
<p>Maydeu-Olivares, A., and Joe, H. (2006). Limited information and goodness-of-fit
testing in multidimensional contingency tables. <em>Psychometrika, 71</em>,
713-732.
</p>
<p>Varin, C., Reid, N. and Firth, D. (2011). An overview of composite likelihood
methods. <em>Statistica Sinica, 21</em>, 5-42.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+startalphas">startalphas</a></code>
<code><a href="#topic+startbetas">startbetas</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ### Matrix of response patterns and frequencies
 data(item5fr)
 
 ## ML estimation
 nrmleplnout&lt;-nrmlepln(item5fr, ncat=3, nitem=5)
 print(nrmleplnout)
 
 ## BCL estimation
 nrbcplnout&lt;-nrbcpln(item5fr, ncat=3, nitem=5)
 print(nrbcplnout)
 
 ## ML Rasch estimation
 nrmleraschout&lt;-nrmlerasch(item5fr, ncat=3, nitem=5)
 print(nrmleraschout)
 
 
 ### Raw data
 data(item9cat5)
 
 ## ML estimation
 nrmleplnout&lt;-nrmlepln(item9cat5, ncat=5)
 print(nrmleplnout)
 
 ## BCL estimation
 nrbcplnout&lt;-nrbcpln(item9cat5, ncat=5, se=FALSE)
 print(nrbcplnout)
 
 ## ML Rasch estimation
 nrmleraschout&lt;-nrmlerasch(item9cat5, ncat=5)
 print(nrmleraschout)
 

</code></pre>

<hr>
<h2 id='simulpln'>Simulate data from polytomous logit-normit (graded logistic) model</h2><span id='topic+simulpln'></span>

<h3>Description</h3>

<p>Simulate data from polytomous logit-normit (graded logistic) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulpln(n, nitem, ncat, alphas, betas)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulpln_+3A_n">n</code></td>
<td>
<p>Number of responses to generate.</p>
</td></tr>
<tr><td><code id="simulpln_+3A_nitem">nitem</code></td>
<td>
<p>Number of items.</p>
</td></tr>
<tr><td><code id="simulpln_+3A_ncat">ncat</code></td>
<td>
<p>Number of categories for the items.</p>
</td></tr>
<tr><td><code id="simulpln_+3A_alphas">alphas</code></td>
<td>
<p>A vector of length <code>nitem</code><code class="reqn">\times</code>(<code>ncat</code>-1)
corresponding to true values for the (decreasing) cutpoints
for the items.</p>
</td></tr>
<tr><td><code id="simulpln_+3A_betas">betas</code></td>
<td>
<p>A vector of length <code>nitem</code> corresponding to values for the
beta vectors of slopes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data from graded logistic models is generated under the following parameterization:
</p>
<p style="text-align: center;"><code class="reqn">Pr(y_i = k_i| \eta) = \left\{
     \begin{array}{ll}
     1-\Psi (\alpha_{i,k} + \beta_i \eta) &amp; \mbox{if  } k_i = 0\\
     \Psi (\alpha_{i,k} + \beta_i \eta) - \Psi (\alpha_{i,k+1} + \beta_i \eta) &amp; \mbox{if  } 0 &lt; k_i &lt; m-1\\
     \Psi (\alpha_{i,k+1} + \beta_i \eta) &amp; \mbox{if  } k_i = m-1
     \end{array} \right. </code>
</p>

<p>Where the items are <code class="reqn">y_i, i = 1, \dots, n</code>, and response categories are <code class="reqn">k=0, \dots, m-1</code>. <code class="reqn">\eta</code> is the latent trait, <code class="reqn">\Psi</code> is the logistic distribution function, <code class="reqn">\alpha</code> is an intercept (cutpoint) parameter, and <code class="reqn">\beta</code> is a slope parameter. When the number of categories for the items is 2, this reduces to the 2PL parameterization:
</p>
<p style="text-align: center;"><code class="reqn">Pr(y_i = 1| \eta) = \Psi (\alpha_1 + \beta_i \eta)</code>
</p>



<h3>Value</h3>

<p>A data matrix in which each row represents a response pattern and the final column represents the frequency of each response pattern.
</p>


<h3>Author(s)</h3>

<p>Carl F. Falk <a href="mailto:cffalk@gmail.com">cffalk@gmail.com</a>, Harry Joe
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nrmlepln">nrmlepln</a></code>
<code><a href="#topic+nrmlerasch">nrmlerasch</a></code>
<code><a href="#topic+nrbcpln">nrbcpln</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   n&lt;-500;
   ncat&lt;-3;
   nitem&lt;-5
   alphas=c(0,-.5,  .2,-1,  .4,-.6,  .3,-.2,  .5,-.5)
   betas=c(1,1,1,.5,.5)
   
   set.seed(1234567)
   datfr&lt;-simulpln(n,nitem,ncat,alphas,betas)
   nrmleplnout&lt;-nrmlepln(datfr, ncat=ncat, nitem=nitem)
   nrmleplnout
</code></pre>

<hr>
<h2 id='startalphas'>Starting values for polytomous logit-normit model</h2><span id='topic+startalphas'></span><span id='topic+startbetas'></span>

<h3>Description</h3>

<p>Computes starting values for estimation of polytomous logit-normit model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startalphas(x, ncat, nitem = NULL)
startbetas(x, ncat, nitem = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="startalphas_+3A_x">x</code></td>
<td>
<p>A data matrix. Data can be in one of two formats: 1) raw data
where the number of rows corresponds to the number of raw cases and
each column represents an item, and 2) a matrix of dimensions
<code>nrec</code><code class="reqn">\times</code>(<code>nitem</code>+1) where each row corresponds to a
response pattern and the last column is the frequency of that response
pattern. A data matrix of the second type requires input for <code>nitem</code>
and <code>nrec</code>.</p>
</td></tr>
<tr><td><code id="startalphas_+3A_ncat">ncat</code></td>
<td>
<p>Number of ordinal categories for each item, coded as
0,...,(<code>ncat</code>-1). Currently supported are items that have the same number of categories.</p>
</td></tr>
<tr><td><code id="startalphas_+3A_nitem">nitem</code></td>
<td>
<p>Number of items. If omitted, it is assumed that <code>x</code> contains
a data matrix of the first type (raw data) and the number of
columns in <code>x</code> will be selected as the number of items.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>startalphas</code> computes starting values for the (decreasing) cutpoints
for the items based on logit transformed probabilities, assuming independent items.
</p>
<p><code>startbetas</code> computes starting values for slopes under the polytomous
logit-normit model, using a method based on values that are proportional to the
average correlations of each item with all other items. Starting values are
currently bounded between -.2 and 1.
</p>


<h3>Value</h3>

<p>A vector of starting values, depending on which function was called.
</p>


<h3>Author(s)</h3>

<p>Carl F. Falk <a href="mailto:cffalk@gmail.com">cffalk@gmail.com</a>, Harry Joe
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nrmlepln">nrmlepln</a></code>
<code><a href="#topic+nrmlerasch">nrmlerasch</a></code>
<code><a href="#topic+nrbcpln">nrbcpln</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Raw data
data(item9cat5)

myAlphas&lt;-startalphas(item9cat5, ncat=5)
print(myAlphas)

myBetas&lt;-startbetas(item9cat5, ncat=5)
print(myBetas)

nrbcplnout&lt;-nrbcpln(item9cat5, ncat=5, alphas=myAlphas, betas=myBetas, se=FALSE)
print(nrbcplnout)

## Matrix of response patterns and frequencies
data(item5fr)

myAlphas&lt;-startalphas(item5fr, ncat=3, nitem=5)
print(myAlphas)

myBetas&lt;-startbetas(item5fr, ncat=3, nitem=5)
print(myBetas)

nrbcplnout&lt;-nrbcpln(item5fr, ncat=3, nitem=5, alphas=myAlphas, betas=myBetas, se=FALSE)
print(nrbcplnout)
  
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
