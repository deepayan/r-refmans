<!DOCTYPE html><html lang="en"><head><title>Help for package multcomp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {multcomp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adevent'>
<p>Adverse Events Data</p></a></li>
<li><a href='#cftest'><p> Testing Estimated Coefficients</p></a></li>
<li><a href='#cholesterol'><p> Cholesterol Reduction Data Set</p></a></li>
<li><a href='#cld'><p>Set up a compact letter display of all pair-wise comparisons</p></a></li>
<li><a href='#cml'><p>Chronic Myelogenous Leukemia survival data.</p></a></li>
<li><a href='#contrMat'><p> Contrast Matrices</p></a></li>
<li><a href='#detergent'><p> Detergent Durability Data Set</p></a></li>
<li><a href='#fattyacid'><p>Fatty Acid Content of Bacillus simplex.</p></a></li>
<li><a href='#glht'><p> General Linear Hypotheses</p></a></li>
<li><a href='#glht-methods'><p> Methods for General Linear Hypotheses</p></a></li>
<li><a href='#litter'><p> Litter Weights Data Set</p></a></li>
<li><a href='#mmm'><p>Simultaneous Inference for Multiple Marginal Models</p></a></li>
<li><a href='#modelparm'><p> Generic Accessor Function for Model Parameters</p></a></li>
<li><a href='#mtept'>
<p>Multiple Endpoints Data</p></a></li>
<li><a href='#parm'><p> Model Parameters</p></a></li>
<li><a href='#plot.cld'><p>Plot a cld object</p></a></li>
<li><a href='#recovery'><p> Recovery Time Data Set</p></a></li>
<li><a href='#sbp'>
<p>Systolic Blood Pressure Data</p></a></li>
<li><a href='#trees513'><p> Frankonian Tree Damage Data</p></a></li>
<li><a href='#waste'><p> Industrial Waste Data Set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Simultaneous Inference in General Parametric Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4-28</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-29</td>
</tr>
<tr>
<td>Description:</td>
<td>Simultaneous tests and confidence intervals
  for general linear hypotheses in parametric models, including 
  linear, generalized linear, linear mixed effects, and survival models.
  The package includes demos reproducing analyzes presented
  in the book "Multiple Comparisons Using R" (Bretz, Hothorn, 
  Westfall, 2010, CRC Press).</td>
</tr>
<tr>
<td>Depends:</td>
<td>stats, graphics, mvtnorm (&ge; 1.0-10), survival (&ge; 2.39-4),
TH.data (&ge; 1.0-2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>sandwich (&ge; 2.3-0), codetools</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lme4 (&ge; 0.999375-16), nlme, robustbase, coin, MASS, foreign,
xtable, lmtest, coxme (&ge; 2.2-1), SimComp, ISwR, tram (&ge;
0.2-5), fixest (&ge; 0.10), glmmTMB, DoseFinding, HH, asd,
gsDesign, lattice</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://multcomp.R-forge.R-project.org">http://multcomp.R-forge.R-project.org</a>,
<a href="https://www.routledge.com/Multiple-Comparisons-Using-R/Bretz-Hothorn-Westfall/p/book/9781584885740">https://www.routledge.com/Multiple-Comparisons-Using-R/Bretz-Hothorn-Westfall/p/book/9781584885740</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-29 14:42:08 UTC; hothorn</td>
</tr>
<tr>
<td>Author:</td>
<td>Torsten Hothorn <a href="https://orcid.org/0000-0001-8301-0471"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Frank Bretz [aut],
  Peter Westfall [aut],
  Richard M. Heiberger [ctb],
  Andre Schuetzenmeister [ctb],
  Susan Scheibe [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Torsten Hothorn &lt;Torsten.Hothorn@R-project.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-29 15:50:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='adevent'>
Adverse Events Data
</h2><span id='topic+adevent'></span>

<h3>Description</h3>

<p>Indicators of 28 adverse events in a two-arm clinical trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(adevent)</code></pre>


<h3>Format</h3>

<p>A data frame with 160 observations on the following 29 variables.
</p>

<dl>
<dt><code>E1</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E2</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E3</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E4</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E5</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E6</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E7</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E8</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E9</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E10</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E11</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E12</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E13</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E14</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E15</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E16</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E17</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E18</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E19</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E20</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E21</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E22</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E23</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E24</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E25</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E26</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E27</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>E28</code></dt><dd><p>a factor with levels <code>no event</code> <code>event</code></p>
</dd>
<dt><code>group</code></dt><dd><p>group indicator.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data is provided by Westfall et al. (1999, p. 242) and contains binary
indicators of 28 adverse events (<code>E1</code>,..., <code>E28</code>) for
two arms (<code>group</code>).
</p>


<h3>Source</h3>

<p>P. H. Westfall, R. D. Tobias, D. Rom, R. D. Wolfinger, Y. Hochberg (1999).
<em>Multiple Comparisons and Multiple Tests Using the SAS System</em>.
Cary, NC: SAS Institute Inc.
</p>

<hr>
<h2 id='cftest'> Testing Estimated Coefficients </h2><span id='topic+cftest'></span>

<h3>Description</h3>

<p>A convenience function for univariate testing via z- and t-tests of 
estimated model coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cftest(model, parm, test = univariate(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cftest_+3A_model">model</code></td>
<td>
<p>a fitted model.</p>
</td></tr>
<tr><td><code id="cftest_+3A_parm">parm</code></td>
<td>
<p>a vector of parameters to be tested, either a character vector
of names or an integer.</p>
</td></tr>
<tr><td><code id="cftest_+3A_test">test</code></td>
<td>
<p> a function for computing p values, see <code><a href="#topic+summary.glht">summary.glht</a></code>.</p>
</td></tr>  
<tr><td><code id="cftest_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="#topic+summary.glht">summary.glht</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The usual z- or t-tests are tested without adjusting for 
multiplicity.
</p>


<h3>Value</h3>

<p>An object of class <code>summary.glht</code>.
</p>


<h3>See Also</h3>

<p><code><a href="lmtest.html#topic+coeftest">coeftest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  lmod &lt;- lm(dist ~ speed, data = cars)
  summary(lmod)
  cftest(lmod)
  
</code></pre>

<hr>
<h2 id='cholesterol'> Cholesterol Reduction Data Set </h2><span id='topic+cholesterol'></span>

<h3>Description</h3>

<p>Cholesterol reduction for five treatments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("cholesterol")</code></pre>


<h3>Format</h3>

<p>This data frame contains the following variables
</p>

<dl>
<dt>trt</dt><dd><p>treatment groups, a factor at levels <code>1time</code>, <code>2times</code>,
<code>4times</code>, <code>drugD</code> and <code>drugE</code>.</p>
</dd>
<dt>response</dt><dd><p>cholesterol reduction.</p>
</dd>
</dl>



<h3>Details</h3>

<p>A clinical study was conducted to assess the effect of three formulations
of the same drug on reducing cholesterol. The formulations were
20mg at once (<code>1time</code>), 10mg twice a day (<code>2times</code>), and 5mg
four times a day (<code>4times</code>). In addition, two competing drugs
were used as control group (<code>drugD</code> and <code>drugE</code>). The purpose of 
the study was to find which of the formulations, if any, is efficacious and how
these formulations compare with the existing drugs.
</p>


<h3>Source</h3>

<p>P. H. Westfall, R. D. Tobias, D. Rom, R. D. Wolfinger, Y. Hochberg (1999).
<em>Multiple Comparisons and Multiple Tests Using the SAS System</em>.
Cary, NC: SAS Institute Inc., page 153.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ### adjusted p-values for all-pairwise comparisons in a one-way layout 
  ### set up ANOVA model  
  amod &lt;- aov(response ~ trt, data = cholesterol)

  ### set up multiple comparisons object for all-pair comparisons
  cht &lt;- glht(amod, linfct = mcp(trt = "Tukey"))

  ### cf. Westfall et al. (1999, page 171)
  summary(cht, test = univariate())
  summary(cht, test = adjusted("Shaffer"))
  summary(cht, test = adjusted("Westfall"))

  ### use only a subset of all pairwise hypotheses
  K &lt;- contrMat(table(cholesterol$trt), type="Tukey")
  Ksub &lt;- rbind(K[c(1,2,5),],
                "D - test" = c(-1, -1, -1, 3, 0),
                "E - test" = c(-1, -1, -1, 0, 3))

  ### reproduce results in Westfall et al. (1999, page 172)
  ### note: the ordering of our estimates here is different
  amod &lt;- aov(response ~ trt - 1, data = cholesterol)
  summary(glht(amod, linfct = mcp(trt = Ksub[,5:1])), 
          test = adjusted("Westfall"))
</code></pre>

<hr>
<h2 id='cld'>Set up a compact letter display of all pair-wise comparisons</h2><span id='topic+cld'></span><span id='topic+cld.glht'></span><span id='topic+cld.summary.glht'></span><span id='topic+cld.confint.glht'></span>

<h3>Description</h3>

<p>Extract information from <code>glht</code>, <code>summary.glht</code> or
<code>confint.glht</code> objects which is required to create
and plot compact letter displays of all pair-wise comparisons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.glht'
cld(object, level = 0.05, decreasing = FALSE, ...)
## S3 method for class 'glht'
cld(object, level = 0.05, decreasing = FALSE, ...)
## S3 method for class 'confint.glht'
cld(object, decreasing = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cld_+3A_object">object</code></td>
<td>

<p>An object of class <code>glht</code>, <code>summary.glht</code> or <code>confint.glht</code>.
</p>
</td></tr>
<tr><td><code id="cld_+3A_level">level</code></td>
<td>

<p>Significance-level to be used to term a specific pair-wise
comparison significant.
</p>
</td></tr>
<tr><td><code id="cld_+3A_decreasing">decreasing</code></td>
<td>

<p>logical. Should the order of the letters be increasing or decreasing?
</p>
</td></tr>
<tr><td><code id="cld_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function extracts all the information from <code>glht</code>,
<code>summary.glht</code> or <code>confint.glht</code> objects that is required
to create a compact letter display of all pair-wise comparisons.
In case the contrast matrix is not of type <code>"Tukey"</code>, an error
is issued. In case of <code>confint.glht</code> objects, a pair-wise comparison
is termed significant whenever a particular confidence interval contains 0.
Otherwise, p-values are compared to the value of <code>"level"</code>.
Once, this information is extracted, plotting of all pair-wise
comparisons can be carried out.
</p>


<h3>Value</h3>

<p>An object of class <code>cld</code>, a list with items:
</p>
<table role = "presentation">
<tr><td><code>y</code></td>
<td>

<p>Values of the response variable of the original model.
</p>
</td></tr>
<tr><td><code>yname</code></td>
<td>

<p>Name of the response variable.
</p>
</td></tr>
<tr><td><code>x</code></td>
<td>

<p>Values of the variable used to compute Tukey contrasts.
</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>

<p>Weights used in the fitting process.
</p>
</td></tr>
<tr><td><code>lp</code></td>
<td>

<p>Predictions from the fitted model.
</p>
</td></tr>
<tr><td><code>covar</code></td>
<td>

<p>A logical indicating whether the fitted model contained covariates.
</p>
</td></tr>
<tr><td><code>signif</code></td>
<td>

<p>Vector of logicals indicating significant differences with
hyphenated names that identify pair-wise comparisons.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hans-Peter Piepho (2004), An Algorithm for a Letter-Based
Representation of All-Pairwise Comparisons, <em>Journal of
Computational and Graphical Statistics</em>, <b>13</b>(2), 456&ndash;466.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glht">glht</a></code>
<code><a href="#topic+plot.cld">plot.cld</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ### multiple comparison procedures
  ### set up a one-way ANOVA
  data(warpbreaks)
  amod &lt;- aov(breaks ~ tension, data = warpbreaks)
  ### specify all pair-wise comparisons among levels of variable "tension"
  tuk &lt;- glht(amod, linfct = mcp(tension = "Tukey"))
  ### extract information
  tuk.cld &lt;- cld(tuk)
  ### use sufficiently large upper margin
  old.par &lt;- par(mai=c(1,1,1.25,1), no.readonly = TRUE)
  ### plot
  plot(tuk.cld)
  par(old.par)
  
  ### now using covariates
  data(warpbreaks)
  amod2 &lt;- aov(breaks ~ tension + wool, data = warpbreaks)
  ### specify all pair-wise comparisons among levels of variable "tension"
  tuk2 &lt;- glht(amod2, linfct = mcp(tension = "Tukey"))
  ### extract information
  tuk.cld2 &lt;- cld(tuk2)
  ### use sufficiently large upper margin
  old.par &lt;- par(mai=c(1,1,1.25,1), no.readonly = TRUE)
  ### plot using different colors
  plot(tuk.cld2, col=c("black", "red", "blue"))
  par(old.par)

  ### set up all pair-wise comparisons for count data
  data(Titanic)
  mod &lt;- glm(Survived ~ Class, data = as.data.frame(Titanic), weights = Freq, family = binomial())
  ### specify all pair-wise comparisons among levels of variable "Class"
  glht.mod &lt;- glht(mod, mcp(Class = "Tukey"))
  ### extract information
  mod.cld &lt;- cld(glht.mod)
  ### use sufficiently large upper margin
  old.par &lt;- par(mai=c(1,1,1.5,1), no.readonly = TRUE)
  ### plot
  plot(mod.cld)
  par(old.par)
</code></pre>

<hr>
<h2 id='cml'>Chronic Myelogenous Leukemia survival data.</h2><span id='topic+cml'></span>

<h3>Description</h3>

<p>Survival in a randomised trial comparing three treatments for 
Chronic Myelogeneous Leukemia (simulated data).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("cml")</code></pre>


<h3>Format</h3>

<p>A data frame with 507 observations on the following 7 variables.
</p>

<dl>
<dt><code>center</code></dt><dd><p>a factor with 54 levels indicating the study center.</p>
</dd>
<dt><code>treatment</code></dt><dd><p>a factor with levels <code>trt1</code>, <code>trt2</code>, <code>trt3</code> indicating the treatment group.</p>
</dd>
<dt><code>sex</code></dt><dd><p>sex (0 = female, 1 = male)</p>
</dd>
<dt><code>age</code></dt><dd><p>age in years</p>
</dd>
<dt><code>riskgroup</code></dt><dd><p>risk group (0 = low, 1 = medium, 2 = high)</p>
</dd>
<dt><code>status</code></dt><dd><p>censoring status (FALSE = censored, TRUE = dead)</p>
</dd>
<dt><code>time</code></dt><dd><p>survival or censoring time in days.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are simulated according to structure of the data by the German CML 
Study Group used in Hehlmann (1994).</p>


<h3>Source</h3>

<p>R. Hehlmann, H. Heimpel, J. Hasford, H.J. Kolb, H. Pralle, D.K. Hossfeld, 
W. Queisser, H. Loeffler, A. Hochhaus, B. Heinze (1994), Randomized 
comparison of interferon-alpha with busulfan and hydroxyurea in chronic 
myelogenous leukemia. The German CML study group. <em>Blood</em>
<b>84</b>(12):4064-4077.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (require("coxme")) {
    data("cml")
    ### one-sided simultaneous confidence intervals for many-to-one 
    ### comparisons of treatment effects concerning time of survival 
    ### modeled by a frailty Cox model with adjustment for further 
    ### covariates and center-specific random effect.
    cml_coxme &lt;- coxme(Surv(time, status) ~ treatment + sex + age + riskgroup + (1|center), 
                       data = cml)
    glht_coxme &lt;- glht(model = cml_coxme, linfct = mcp(treatment = "Dunnett"), 
                       alternative = "greater")
    ci_coxme &lt;- confint(glht_coxme)
    exp(ci_coxme$confint)[1:2,]
}
</code></pre>

<hr>
<h2 id='contrMat'> Contrast Matrices </h2><span id='topic+contrMat'></span>

<h3>Description</h3>

<p>Computes contrast matrices for several multiple comparison procedures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contrMat(n, type = c("Dunnett", "Tukey", "Sequen", "AVE", 
                     "Changepoint", "Williams", "Marcus", 
                     "McDermott", "UmbrellaWilliams", "GrandMean"), 
         base = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contrMat_+3A_n">n</code></td>
<td>
<p> a (possibly named) vector of sample sizes for each group.</p>
</td></tr>
<tr><td><code id="contrMat_+3A_type">type</code></td>
<td>
<p> type of contrast. </p>
</td></tr>
<tr><td><code id="contrMat_+3A_base">base</code></td>
<td>
<p> an integer specifying which group is considered the baseline
group for Dunnett contrasts.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the requested matrix of contrasts for comparisons of mean levels.
</p>


<h3>Value</h3>

<p>The matrix of contrasts with appropriate row names is returned. 
</p>


<h3>References</h3>

<p>Frank Bretz, Torsten Hothorn and Peter Westfall (2010),
<em>Multiple Comparisons Using R</em>, CRC Press, Boca Raton.
</p>
<p>Frank Bretz, Alan Genz and Ludwig A. Hothorn (2001), On the numerical 
availability of multiple comparison procedures. <em>Biometrical Journal</em>,
<b>43</b>(5), 645&ndash;656.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> n &lt;- c(10,20,30,40)
 names(n) &lt;- paste("group", 1:4, sep="")
 contrMat(n)	# Dunnett is default
 contrMat(n, base = 2)	# use second level as baseline
 contrMat(n, type = "Tukey")
 contrMat(n, type = "Sequen")
 contrMat(n, type = "AVE")
 contrMat(n, type = "Changepoint")
 contrMat(n, type = "Williams")
 contrMat(n, type = "Marcus")
 contrMat(n, type = "McDermott")
 ### Umbrella-protected Williams contrasts, i.e. a sequence of 
 ### Williams-type contrasts with groups of higher order 
 ### stepwise omitted
 contrMat(n, type = "UmbrellaWilliams")
 ### comparison of each group with grand mean of all groups
 contrMat(n, type = "GrandMean")

</code></pre>

<hr>
<h2 id='detergent'> Detergent Durability Data Set </h2><span id='topic+detergent'></span>

<h3>Description</h3>

<p>Detergent durability in an incomplete two-way design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("detergent")</code></pre>


<h3>Format</h3>

<p>This data frame contains the following variables
</p>

<dl>
<dt>detergent</dt><dd><p>detergent, a factor at levels <code>A</code>, <code>B</code>, 
<code>C</code>, <code>D</code>, and <code>E</code>.</p>
</dd>
<dt>block</dt><dd><p>block, a factor at levels <code>B_1</code>, ..., <code>B_10</code>.</p>
</dd>
<dt>plates</dt><dd><p>response variable: number of plates washed before 
the foam disappears.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Plates were washed with five detergent varieties, in ten blocks. A complete
design would have 50 combinations, here only three detergent varieties 
in each block were applied in a balanced incomplete block design. Note that
there are six observations taken at each detergent level.
</p>


<h3>Source</h3>

<p>H. Scheffe (1959). <em>The Analysis of Variance</em>. 
New York: John Wiley &amp; Sons, page 189.
</p>
<p>P. H. Westfall, R. D. Tobias, D. Rom, R. D. Wolfinger, Y. Hochberg (1999).
<em>Multiple Comparisons and Multiple Tests Using the SAS System</em>.
Cary, NC: SAS Institute Inc., page 189.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ### set up two-way ANOVA without interactions
  amod &lt;- aov(plates ~ block + detergent, data = detergent)

  ### set up all-pair comparisons
  dht &lt;- glht(amod, linfct = mcp(detergent = "Tukey"))

  ### see Westfall et al. (1999, p. 190)
  confint(dht)

  ### see Westfall et al. (1999, p. 192)
  summary(dht, test = univariate())
  ## Not run: 
  summary(dht, test = adjusted("Shaffer"))
  summary(dht, test = adjusted("Westfall"))
  
## End(Not run)

</code></pre>

<hr>
<h2 id='fattyacid'>Fatty Acid Content of Bacillus simplex.</h2><span id='topic+fattyacid'></span>

<h3>Description</h3>

<p>Fatty acid content of different putative ecotypes of Bacillus simplex. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("fattyacid")</code></pre>


<h3>Format</h3>

<p>A data frame with 93 observations on the following 2 variables.
</p>

<dl>
<dt><code>PE</code></dt><dd><p>a factor with levels <code>PE3</code>, <code>PE4</code>, <code>PE5</code>, <code>PE6</code>, <code>PE7</code>, <code>PE9</code> indicating the putative ecotype (PE).</p>
</dd>
<dt><code>FA</code></dt><dd><p>a numeric vector indicating the content of fatty acid (FA).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data give the fatty acid content for different putative ecotypes of Bacillus simplex. 
Variances of the values of fatty acid are heterogeneous among the putative ecotypes.</p>


<h3>Source</h3>

<p>J. Sikorski, E. Brambilla, R. M. Kroppenstedt, B. J. Tindal (2008), The temperature 
adaptive fatty acid content in Bacillus simplex strains from 
&rdquo;Evolution Canyon&ldquo;, Israel. <em>Microbiology</em> <b>154</b>, 2416-2426.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (require("sandwich")) {
    data("fattyacid")
    ### all-pairwise comparisons of the means of fatty acid content 
    ### FA between different putative ecotypes PE accounting for 
    ### heteroscedasticity by using a heteroscedastic consistent 
    ### covariance estimation
    amod &lt;- aov(FA ~ PE, data = fattyacid)
    amod_glht &lt;- glht(amod, mcp(PE = "Tukey"), vcov = vcovHC)
    summary(amod_glht)

    ### simultaneous confidence intervals for the differences of 
    ### means of fatty acid content between the putative ecotypes
    confint(amod_glht)
}
</code></pre>

<hr>
<h2 id='glht'> General Linear Hypotheses </h2><span id='topic+glht'></span><span id='topic+glht.matrix'></span><span id='topic+glht.character'></span><span id='topic+glht.expression'></span><span id='topic+glht.mcp'></span><span id='topic+glht.mlf'></span><span id='topic+mcp'></span>

<h3>Description</h3>

<p>General linear hypotheses and multiple comparisons 
for parametric models, including generalized linear models, 
linear mixed effects models, and survival models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'matrix'
glht(model, linfct, 
    alternative = c("two.sided", "less", "greater"), 
    rhs = 0, ...)
## S3 method for class 'character'
glht(model, linfct, ...)
## S3 method for class 'expression'
glht(model, linfct, ...)
## S3 method for class 'mcp'
glht(model, linfct, ...)
## S3 method for class 'mlf'
glht(model, linfct, ...)
mcp(..., interaction_average = FALSE, covariate_average = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glht_+3A_model">model</code></td>
<td>
<p> a fitted model, 
for example an object returned by <code><a href="stats.html#topic+lm">lm</a></code>, 
<code><a href="stats.html#topic+glm">glm</a></code>, or <code><a href="stats.html#topic+aov">aov</a></code> etc. It is 
assumed that <code><a href="stats.html#topic+coef">coef</a></code> and 
<code><a href="stats.html#topic+vcov">vcov</a></code> methods are available for 
<code>model</code>. For multiple comparisons of
means, methods <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>, 
<code><a href="stats.html#topic+model.frame">model.frame</a></code> and <code><a href="stats.html#topic+terms">terms</a></code>
are expected to be available for <code>model</code> as well.</p>
</td></tr>
<tr><td><code id="glht_+3A_linfct">linfct</code></td>
<td>
<p> a specification of the linear hypotheses to be tested. 
Linear functions can be specified by either the matrix
of coefficients or by symbolic descriptions of 
one or more linear hypotheses. Multiple comparisons
in AN(C)OVA models are specified by objects returned from
function <code>mcp</code>.</p>
</td></tr></table>
<p>.
</p>
<table role = "presentation">
<tr><td><code id="glht_+3A_alternative">alternative</code></td>
<td>
<p> a character string specifying the alternative 
hypothesis, must be one of '&quot;two.sided&quot;' (default), '&quot;greater&quot;' or
'&quot;less&quot;'.  You can specify just the initial letter.</p>
</td></tr>
<tr><td><code id="glht_+3A_rhs">rhs</code></td>
<td>
<p> an optional numeric vector specifying the 
right hand side of the hypothesis.</p>
</td></tr>
<tr><td><code id="glht_+3A_interaction_average">interaction_average</code></td>
<td>
<p>logical indicating if comparisons are
averaging over interaction terms. Experimental!</p>
</td></tr>
<tr><td><code id="glht_+3A_covariate_average">covariate_average</code></td>
<td>
<p>logical indicating if comparisons are
averaging over additional covariates. Experimental!</p>
</td></tr>
<tr><td><code id="glht_+3A_...">...</code></td>
<td>
<p> additional arguments to function <code><a href="#topic+modelparm">modelparm</a></code> in all
<code>glht</code> methods. For function <code>mcp</code>,
multiple comparisons are defined by 
matrices or symbolic descriptions specifying contrasts
of factor levels where the arguments correspond
to factor names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A general linear hypothesis refers to null hypotheses of the form
<code class="reqn">H_0: K \theta = m</code> for some parametric model
<code>model</code> with parameter estimates <code>coef(model)</code>. 
</p>
<p>The null hypothesis is specified by a linear function <code class="reqn">K \theta</code>, 
the direction of the alternative and the right hand side <code class="reqn">m</code>.
Here, <code>alternative</code> equal to <code>"two.sided"</code> refers to 
a null hypothesis <code class="reqn">H_0: K \theta = m</code>, whereas
<code>"less"</code> corresponds to <code class="reqn">H_0: K \theta \ge m</code> and  
<code>"greater"</code> refers to 
<code class="reqn">H_0: K \theta \le m</code>. The right hand side vector <code class="reqn">m</code> can be defined
via the <code>rhs</code> argument.
</p>
<p>The generic method <code>glht</code> dispatches on its second argument
(<code>linfct</code>). There are three ways, and thus methods, 
to specify linear functions to be tested:
</p>
<p>1) The <code>matrix</code> of coefficients <code class="reqn">K</code> can be specified directly
via the <code>linfct</code> argument. In this case,
the number of columns of this matrix needs to correspond to the number of
parameters estimated by <code>model</code>. It is assumed that
appropriate <code>coef</code> and <code>vcov</code> methods are available
for <code>model</code> (<code><a href="#topic+modelparm">modelparm</a></code> deals with some exceptions). 
</p>
<p>2) A symbolic description,
either a <code>character</code> or <code>expression</code> vector passed to <code>glht</code>
via its <code>linfct</code> argument, can be used to define
the null hypothesis. A symbolic description must be interpretable as a valid
R expression consisting of both the left and right hand side 
of a linear hypothesis.
Only the names of <code>coef(model)</code> must be used as variable
names. The alternative is given by
the direction under the null hypothesis (<code>=</code> or <code>==</code>
refer to <code>"two.sided"</code>, <code>&lt;=</code> means
<code>"greater"</code> and <code>&gt;=</code> indicates 
<code>"less"</code>). Numeric vectors of length one
are valid values for the right hand side.
</p>
<p>3) Multiple comparisons of means are defined by objects
of class <code>mcp</code> as returned by the <code>mcp</code> function.
For each factor, which is included in <code>model</code> 
as independent variable,
a contrast matrix or a symbolic description of the contrasts
can be specified as arguments to <code>mcp</code>. A symbolic
description may be a <code>character</code> or <code>expression</code> 
where the factor levels
are only used as variables names. In addition,
the <code>type</code> argument to the contrast generating function
<code><a href="#topic+contrMat">contrMat</a></code> may serve as a symbolic description of 
contrasts as well.
</p>
<p>4) The <code>lsm</code> function in package <code>lsmeans</code> offers a symbolic
interface for the definition of least-squares means for factor combinations
which is very helpful when more complex contrasts are of special interest.
</p>
<p>The <code>mcp</code> function must be used with care when defining parameters
of interest in two-way ANOVA or ANCOVA models. Here, the definition
of treatment differences (such as Tukey's all-pair comparisons or Dunnett's
comparison with a control) might be problem specific. 
Because it is impossible to determine the parameters of interest
automatically in this case, <code>mcp</code> in multcomp
version 1.0-0 and higher generates comparisons for the main effects
only, ignoring covariates and interactions (older versions
automatically averaged over interaction terms). A warning is given. We refer to
Hsu (1996), Chapter 7, and Searle (1971), Chapter 7.3, 
for further discussions and examples on this
issue.
</p>
<p><code>glht</code> extracts the number of degrees of freedom
for models of class <code>lm</code> (via <code><a href="#topic+modelparm">modelparm</a></code>) and the
exact multivariate t distribution is evaluated. For all other
models, results rely on the normal approximation. Alternatively, the 
degrees of freedom to be used for the evaluation of multivariate
t distributions can be given by the additional <code>df</code> argument to
<code><a href="#topic+modelparm">modelparm</a></code> specified via <code>...</code>.
</p>
<p><code>glht</code> methods return a specification of the null hypothesis
<code class="reqn">H_0: K \theta = m</code>. The value of the linear function
<code class="reqn">K \theta</code> can be extracted using the <code><a href="stats.html#topic+coef">coef</a></code> method and
the corresponding covariance matrix is available from the 
<code><a href="stats.html#topic+vcov">vcov</a></code> method. Various simultaneous and univariate tests and 
confidence intervals are available from <code><a href="#topic+summary.glht">summary.glht</a></code>
and <code><a href="#topic+confint.glht">confint.glht</a></code> methods, respectively.
</p>
<p>A more detailed description of the underlying methodology is
available from Hothorn et al. (2008) and Bretz et al. (2010).
</p>


<h3>Value</h3>

<p>An object of class <code>glht</code>, more specifically a list with elements
</p>
<table role = "presentation">
<tr><td><code>model</code></td>
<td>
<p>a fitted model, used in the call to <code>glht</code></p>
</td></tr>
<tr><td><code>linfct</code></td>
<td>
<p> the matrix of linear functions</p>
</td></tr>
<tr><td><code>rhs</code></td>
<td>
<p> the vector of right hand side values <code class="reqn">m</code></p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p> the values of the linear functions</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p> the covariance matrix of the values of the linear functions</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p> optionally, the degrees of freedom when the exact t 
distribution is used for inference</p>
</td></tr>
<tr><td><code>alternative</code></td>
<td>
<p> a character string specifying the alternative
hypothesis</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p> optionally, a character string giving the name of the specific procedure</p>
</td></tr>
</table>
<p>with <code>print</code>, <code><a href="base.html#topic+summary">summary</a></code>, 
<code><a href="stats.html#topic+confint">confint</a></code>, <code><a href="stats.html#topic+coef">coef</a></code> and <code><a href="stats.html#topic+vcov">vcov</a></code> 
methods being available. When called with <code>linfct</code> being an
<code>mcp</code> object, an additional element <code>focus</code> is available
storing the names of the factors under test.
</p>


<h3>References</h3>

<p>Frank Bretz, Torsten Hothorn and Peter Westfall (2010),
<em>Multiple Comparisons Using R</em>, CRC Press, Boca Raton.
</p>
<p>Shayle R. Searle (1971), <em>Linear Models</em>.
John Wiley &amp; Sons, New York.
</p>
<p>Jason C. Hsu (1996), <em>Multiple Comparisons</em>.
Chapman &amp; Hall, London.
</p>
<p>Torsten Hothorn, Frank Bretz and Peter Westfall (2008),
Simultaneous Inference in General Parametric Models.
<em>Biometrical Journal</em>, <b>50</b>(3), 346&ndash;363;
See <code>vignette("generalsiminf", package = "multcomp")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ### multiple linear model, swiss data
  lmod &lt;- lm(Fertility ~ ., data = swiss)

  ### test of H_0: all regression coefficients are zero 
  ### (ignore intercept)

  ### define coefficients of linear function directly
  K &lt;- diag(length(coef(lmod)))[-1,]
  rownames(K) &lt;- names(coef(lmod))[-1]
  K

  ### set up general linear hypothesis
  glht(lmod, linfct = K)

  ### alternatively, use a symbolic description 
  ### instead of a matrix 
  glht(lmod, linfct = c("Agriculture = 0",
                        "Examination = 0",
                        "Education = 0",
                        "Catholic = 0",
                        "Infant.Mortality = 0"))


  ### multiple comparison procedures
  ### set up a one-way ANOVA
  amod &lt;- aov(breaks ~ tension, data = warpbreaks)

  ### set up all-pair comparisons for factor `tension'
  ### using a symbolic description (`type' argument 
  ### to `contrMat()')
  glht(amod, linfct = mcp(tension = "Tukey"))

  ### alternatively, describe differences symbolically
  glht(amod, linfct = mcp(tension = c("M - L = 0", 
                                      "H - L = 0",
                                      "H - M = 0")))

  ### alternatively, define contrast matrix directly
  contr &lt;- rbind("M - L" = c(-1, 1, 0),
                 "H - L" = c(-1, 0, 1), 
                 "H - M" = c(0, -1, 1))
  glht(amod, linfct = mcp(tension = contr))

  ### alternatively, define linear function for coef(amod)
  ### instead of contrasts for `tension'
  ### (take model contrasts and intercept into account)
  glht(amod, linfct = cbind(0, contr %*% contr.treatment(3)))


  ### mix of one- and two-sided alternatives
  warpbreaks.aov &lt;- aov(breaks ~ wool + tension,
                      data = warpbreaks)

  ### contrasts for `tension'
  K &lt;- rbind("L - M" = c( 1, -1,  0),     
             "M - L" = c(-1,  1,  0),       
             "L - H" = c( 1,  0, -1),     
             "M - H" = c( 0,  1, -1))

  warpbreaks.mc &lt;- glht(warpbreaks.aov, 
                        linfct = mcp(tension = K),
                        alternative = "less")

  ### correlation of first two tests is -1
  cov2cor(vcov(warpbreaks.mc))

  ### use smallest of the two one-sided
  ### p-value as two-sided p-value -&gt; 0.0232
  summary(warpbreaks.mc)

  ### more complex models: Continuous outcome logistic
  ### regression; parameters are log-odds ratios
  if (require("tram", quietly = TRUE, warn.conflicts = FALSE)) {
      confint(glht(Colr(breaks ~ wool + tension, 
                        data = warpbreaks), 
                   linfct = mcp("tension" = "Tukey")))
  }
</code></pre>

<hr>
<h2 id='glht-methods'> Methods for General Linear Hypotheses </h2><span id='topic+summary.glht'></span><span id='topic+confint.glht'></span><span id='topic+coef.glht'></span><span id='topic+vcov.glht'></span><span id='topic+plot.glht'></span><span id='topic+plot.confint.glht'></span><span id='topic+univariate'></span><span id='topic+adjusted'></span><span id='topic+Ftest'></span><span id='topic+Chisqtest'></span><span id='topic+adjusted_calpha'></span><span id='topic+univariate_calpha'></span>

<h3>Description</h3>

<p>Simultaneous tests and confidence intervals for general linear 
hypotheses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glht'
summary(object, test = adjusted(), ...)
## S3 method for class 'glht'
confint(object, parm, level = 0.95, calpha = adjusted_calpha(), 
        ...)
## S3 method for class 'glht'
coef(object, rhs = FALSE, ...)
## S3 method for class 'glht'
vcov(object, ...)
## S3 method for class 'confint.glht'
plot(x, xlim, xlab, ylim, ...)
## S3 method for class 'glht'
plot(x, ...)
univariate()
adjusted(type = c("single-step", "Shaffer", "Westfall", "free", 
         p.adjust.methods), ...)
Ftest()
Chisqtest()
adjusted_calpha(...)
univariate_calpha(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glht-methods_+3A_object">object</code></td>
<td>
<p> an object of class <code><a href="#topic+glht">glht</a></code>.</p>
</td></tr>
<tr><td><code id="glht-methods_+3A_test">test</code></td>
<td>
<p> a function for computing p values.</p>
</td></tr>
<tr><td><code id="glht-methods_+3A_parm">parm</code></td>
<td>
<p> additional parameters, currently ignored.</p>
</td></tr>
<tr><td><code id="glht-methods_+3A_level">level</code></td>
<td>
<p> the confidence level required.</p>
</td></tr>
<tr><td><code id="glht-methods_+3A_calpha">calpha</code></td>
<td>
<p> either a function computing the critical value or the critical value itself.</p>
</td></tr>
<tr><td><code id="glht-methods_+3A_rhs">rhs</code></td>
<td>
<p>logical, indicating whether the linear function
<code class="reqn">K \hat{\theta}</code> or the right hand side 
<code class="reqn">m</code> (<code>rhs = TRUE</code>) of the linear hypothesis
should be returned.</p>
</td></tr>
<tr><td><code id="glht-methods_+3A_type">type</code></td>
<td>
<p> the multiplicity adjustment (<code>adjusted</code>) 
to be applied. See below and <code><a href="stats.html#topic+p.adjust">p.adjust</a></code>.</p>
</td></tr>
<tr><td><code id="glht-methods_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+glht">glht</a></code> or <code>confint.glht</code>.</p>
</td></tr>
<tr><td><code id="glht-methods_+3A_xlim">xlim</code></td>
<td>
<p>the <code>x</code> limits <code>(x1, x2)</code> of the plot.</p>
</td></tr>
<tr><td><code id="glht-methods_+3A_ylim">ylim</code></td>
<td>
<p>the y limits of the plot.</p>
</td></tr>
<tr><td><code id="glht-methods_+3A_xlab">xlab</code></td>
<td>
<p>a label for the <code>x</code> axis.</p>
</td></tr>
<tr><td><code id="glht-methods_+3A_...">...</code></td>
<td>
<p> additional arguments, such as <code>maxpts</code>, 
<code>abseps</code> or <code>releps</code> to
<code><a href="mvtnorm.html#topic+pmvnorm">pmvnorm</a></code> in <code>adjusted</code> or 
<code><a href="mvtnorm.html#topic+qmvnorm">qmvnorm</a></code> in <code>confint</code>. Note
that additional arguments specified to <code>summary</code>,
<code>confint</code>, <code>coef</code> and <code>vcov</code> methods
are currently ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The methods for general linear hypotheses as described by objects returned
by <code><a href="#topic+glht">glht</a></code> can be used to actually test the global
null hypothesis, each of the partial hypotheses and for
simultaneous confidence intervals for the linear function <code class="reqn">K \theta</code>.
</p>
<p>The <code><a href="stats.html#topic+coef">coef</a></code> and <code><a href="stats.html#topic+vcov">vcov</a></code> methods compute the linear
function <code class="reqn">K \hat{\theta}</code> and its covariance, respectively.
</p>
<p>The <code>test</code> argument to <code>summary</code> takes a function specifying
the type of test to be applied. Classical Chisq (Wald test) or F statistics
for testing the global hypothesis <code class="reqn">H_0</code> are implemented in functions
<code>Chisqtest</code> and <code>Ftest</code>. Several approaches to multiplicity adjusted p 
values for each of the linear hypotheses are implemented 
in function <code>adjusted</code>. The <code>type</code>
argument to <code>adjusted</code> specifies the method to be applied:
<code>"single-step"</code> implements adjusted p values based on the joint
normal or t distribution of the linear function, and
<code>"Shaffer"</code> and <code>"Westfall"</code> implement logically constraint 
multiplicity adjustments (Shaffer, 1986; Westfall, 1997). 
<code>"free"</code> implements multiple testing procedures under free 
combinations (Westfall et al, 1999).
In addition, all adjustment methods
implemented in <code><a href="stats.html#topic+p.adjust">p.adjust</a></code> are available as well.
</p>
<p>Simultaneous confidence intervals for linear functions can be computed
using method <code><a href="stats.html#topic+confint">confint</a></code>. Univariate confidence intervals
can be computed by specifying <code>calpha = univariate_calpha()</code>
to <code>confint</code>. The critical value can directly be specified as a scalar 
to <code>calpha</code> as well. Note that <code>plot(a)</code> for some object <code>a</code> of class
<code>glht</code> is equivalent to <code>plot(confint(a))</code>.
</p>
<p>All simultaneous inference procedures implemented here control
the family-wise error rate (FWER). Multivariate
normal and t distributions, the latter one only for models of 
class <code><a href="stats.html#topic+lm">lm</a></code>, are evaluated using the procedures
implemented in package <code>mvtnorm</code>. Note that the default
procedure is stochastic. Reproducible p-values and confidence
intervals require appropriate settings of seeds.
</p>
<p>A more detailed description of the underlying methodology is
available from Hothorn et al. (2008) and Bretz et al. (2010).
</p>


<h3>Value</h3>

<p><code>summary</code> computes (adjusted) p values for general linear hypotheses,
<code><a href="stats.html#topic+confint">confint</a></code> computes (adjusted) confidence intervals. 
<code><a href="stats.html#topic+coef">coef</a></code> returns estimates of the linear function <code class="reqn">K \theta</code>
and <code><a href="stats.html#topic+vcov">vcov</a></code> its covariance. 
</p>


<h3>References</h3>

<p>Frank Bretz, Torsten Hothorn and Peter Westfall (2010),
<em>Multiple Comparisons Using R</em>, CRC Press, Boca Raton.
</p>
<p>Juliet P. Shaffer (1986), 
Modified sequentially rejective multiple test procedures. 
<em>Journal of the American Statistical Association</em>,
<b>81</b>, 826&ndash;831.
</p>
<p>Peter H. Westfall (1997), 
Multiple testing of general contrasts using logical constraints
and correlations. <em>Journal of the American Statistical Association</em>,
<b>92</b>, 299&ndash;306.
</p>
<p>P. H. Westfall, R. D. Tobias, D. Rom, R. D. Wolfinger, Y. Hochberg (1999).
<em>Multiple Comparisons and Multiple Tests Using the SAS System</em>.
Cary, NC: SAS Institute Inc.
</p>
<p>Torsten Hothorn, Frank Bretz and Peter Westfall (2008),
Simultaneous Inference in General Parametric Models.
<em>Biometrical Journal</em>, <b>50</b>(3), 346&ndash;363;
See <code>vignette("generalsiminf", package = "multcomp")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ### set up a two-way ANOVA 
  amod &lt;- aov(breaks ~ wool + tension, data = warpbreaks)

  ### set up all-pair comparisons for factor `tension'
  wht &lt;- glht(amod, linfct = mcp(tension = "Tukey"))

  ### 95% simultaneous confidence intervals
  plot(print(confint(wht)))

  ### the same (for balanced designs only)
  TukeyHSD(amod, "tension")

  ### corresponding adjusted p values
  summary(wht)

  ### all means for levels of `tension'
  amod &lt;- aov(breaks ~ tension, data = warpbreaks)
  glht(amod, linfct = matrix(c(1, 0, 0, 
                               1, 1, 0, 
                               1, 0, 1), byrow = TRUE, ncol = 3))

  ### confidence bands for a simple linear model, `cars' data
  plot(cars, xlab = "Speed (mph)", ylab = "Stopping distance (ft)",
       las = 1)

  ### fit linear model and add regression line to plot
  lmod &lt;- lm(dist ~ speed, data = cars)
  abline(lmod)

  ### a grid of speeds
  speeds &lt;- seq(from = min(cars$speed), to = max(cars$speed), 
                length = 10)

  ### linear hypotheses: 10 selected points on the regression line != 0
  K &lt;- cbind(1, speeds)                                                        

  ### set up linear hypotheses
  cht &lt;- glht(lmod, linfct = K)

  ### confidence intervals, i.e., confidence bands, and add them plot
  cci &lt;- confint(cht)
  lines(speeds, cci$confint[,"lwr"], col = "blue")
  lines(speeds, cci$confint[,"upr"], col = "blue")


  ### simultaneous p values for parameters in a Cox model
  if (require("survival") &amp;&amp; require("MASS")) {
      data("leuk", package = "MASS")
      leuk.cox &lt;- coxph(Surv(time) ~ ag + log(wbc), data = leuk)

      ### set up linear hypotheses
      lht &lt;- glht(leuk.cox, linfct = diag(length(coef(leuk.cox))))

      ### adjusted p values
      print(summary(lht))
  }

</code></pre>

<hr>
<h2 id='litter'> Litter Weights Data Set </h2><span id='topic+litter'></span>

<h3>Description</h3>

<p>Dose response of litter weights in rats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("litter")</code></pre>


<h3>Format</h3>

<p>This data frame contains the following variables
</p>

<dl>
<dt>dose</dt><dd><p>dosages at four levels: <code>0</code>, <code>5</code>, <code>50</code>, 
<code>500</code>.</p>
</dd>
<dt>gesttime</dt><dd><p>gestation time as covariate.</p>
</dd>
<dt>number</dt><dd><p>number of animals in litter as covariate.</p>
</dd>
<dt>weight</dt><dd><p>response variable: average post-birth weights 
in the entire litter.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Pregnant mice were divided into four groups and the compound in four
different doses was administered during pregnancy. Their litters
were evaluated for birth weights.
</p>


<h3>Source</h3>

<p>P. H. Westfall, R. D. Tobias, D. Rom, R. D. Wolfinger, Y. Hochberg (1999).
<em>Multiple Comparisons and Multiple Tests Using the SAS System</em>.
Cary, NC: SAS Institute Inc., page 109.
</p>
<p>P. H. Westfall (1997). Multiple Testing of General Contrasts Using
Logical Constraints and Correlations. <em>Journal of the American
Statistical Association</em>, <b>92</b>(437), 299&ndash;306.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ### fit ANCOVA model to data
  amod &lt;- aov(weight ~ dose + gesttime + number, data = litter)

  ### define matrix of linear hypotheses for `dose'
  doselev &lt;- as.integer(levels(litter$dose))
  K &lt;- rbind(contrMat(table(litter$dose), "Tukey"),
             otrend = c(-1.5, -0.5, 0.5, 1.5),
             atrend = doselev - mean(doselev),
             ltrend = log(1:4) - mean(log(1:4)))

  ### set up multiple comparison object
  Kht &lt;- glht(amod, linfct = mcp(dose = K), alternative = "less")

  ### cf. Westfall (1997, Table 2)
  summary(Kht, test = univariate())
  summary(Kht, test = adjusted("bonferroni"))
  summary(Kht, test = adjusted("Shaffer"))
  summary(Kht, test = adjusted("Westfall"))
  summary(Kht, test = adjusted("single-step"))

</code></pre>

<hr>
<h2 id='mmm'>Simultaneous Inference for Multiple Marginal Models</h2><span id='topic+mmm'></span><span id='topic+mlf'></span>

<h3>Description</h3>

<p>Calculation of correlation between test statistics from multiple marginal models 
using the score decomposition</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmm(...)
mlf(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mmm_+3A_...">...</code></td>
<td>
<p>A names argument list containing fitted models (<code>mmm</code>) or
definitions of linear functions (<code>mlf</code>). If
only one linear function is defined for <code>mlf</code>,
it will be applied to all models in <code>mmm</code> by
<code><a href="#topic+glht.mlf">glht.mlf</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimated correlations of the estimated parameters of interest from the
multiple marginal models are obtained using a stacked version of the
i.i.d.  decomposition of parameter estimates by means of score components
(first derivatives of the log likelihood).  The method is less
conservative than the Bonferroni correction.  The details are provided by
Pipper, Ritz and Bisgaard (2012).
</p>
<p>The implementation assumes that the model were fitted to the same data,
i.e., the rows of the matrices returned by <code>estfun</code> belong to the
same observations for each model.
</p>
<p>The reference distribution is always multivariate normal, if you want
to use the multivariate t, please specify the corresponding degrees of
freedom as an additional <code>df</code> argument to <code><a href="#topic+glht">glht</a></code>.
</p>
<p>Observations with missing values contribute zero to the score function.
Models have to be fitted using <code><a href="stats.html#topic+na.exclude">na.exclude</a></code> as <code>na.action</code>
argument.
</p>


<h3>Value</h3>

<p>An object of class <code>mmm</code> or <code>mlf</code>, basically a named list of the
arguments with a special method for <code><a href="#topic+glht">glht</a></code> being available for
the latter.  <code>vcov</code>, <code><a href="sandwich.html#topic+estfun">estfun</a></code>, and
<code><a href="sandwich.html#topic+bread">bread</a></code> methods are available for objects of class
<code>mmm</code>.
</p>


<h3>Author(s)</h3>

<p>Code for the computation of the joint covariance and 
sandwich matrices was contributed by Christian Ritz and 
Christian B. Pipper.
</p>


<h3>References</h3>

<p>Christian Bressen Pipper, Christian Ritz and Hans Bisgaard (2011),
A Versatile Method for Confirmatory Evaluation of the Effects 
of a Covariate in Multiple Models,
<em>Journal of the Royal Statistical Society, 
Series C (Applied Statistics)</em>, <b>61</b>, 315&ndash;326.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### replicate analysis of Hasler &amp; Hothorn (2011), 
### A Dunnett-Type Procedure for Multiple Endpoints,
### The International Journal of Biostatistics: Vol. 7: Iss. 1, Article 3.
### DOI: 10.2202/1557-4679.1258

library("sandwich")

### see ?coagulation
if (require("SimComp")) {
    data("coagulation", package = "SimComp")

    ### level "S" is the standard, "H" and "B" are novel procedures
    coagulation$Group &lt;- relevel(coagulation$Group, ref = "S")

    ### fit marginal models
    (m1 &lt;- lm(Thromb.count ~ Group, data = coagulation))
    (m2 &lt;- lm(ADP ~ Group, data = coagulation))
    (m3 &lt;- lm(TRAP ~ Group, data = coagulation))

    ### set-up Dunnett comparisons for H - S and B - S 
    ### for all three models
    g &lt;- glht(mmm(Thromb = m1, ADP = m2, TRAP = m3),
              mlf(mcp(Group = "Dunnett")), alternative = "greater")

    ### joint correlation
    cov2cor(vcov(g))

    ### simultaneous p-values adjusted by taking the correlation
    ### between the score contributions into account
    summary(g)
    ### simultaneous confidence intervals
    confint(g)

    ### compare with
    ## Not run: 
        library("SimComp")
        SimCiDiff(data = coagulation, grp = "Group",
                  resp = c("Thromb.count","ADP","TRAP"), 
                  type = "Dunnett", alternative = "greater",
                  covar.equal = TRUE)
    
## End(Not run)
 
    ### use sandwich variance matrix
    g &lt;- glht(mmm(Thromb = m1, ADP = m2, TRAP = m3),
              mlf(mcp(Group = "Dunnett")), 
              alternative = "greater", vcov = sandwich)
    summary(g)
    confint(g)
}

### attitude towards science data
data("mn6.9", package = "TH.data")

### one model for each item
mn6.9.y1 &lt;- glm(y1 ~ group, family = binomial(), 
                na.action = na.omit, data = mn6.9)
mn6.9.y2 &lt;- glm(y2 ~ group, family = binomial(), 
                na.action = na.omit, data = mn6.9)
mn6.9.y3 &lt;- glm(y3 ~ group, family = binomial(), 
                na.action = na.omit, data = mn6.9)
mn6.9.y4 &lt;- glm(y4 ~ group, family = binomial(), 
                na.action = na.omit, data = mn6.9)

### test all parameters simulaneously
summary(glht(mmm(mn6.9.y1, mn6.9.y2, mn6.9.y3, mn6.9.y4), 
             mlf(diag(2))))
### group differences
summary(glht(mmm(mn6.9.y1, mn6.9.y2, mn6.9.y3, mn6.9.y4), 
             mlf("group2 = 0")))

### alternative analysis of Klingenberg &amp; Satopaa (2013),
### Simultaneous Confidence Intervals for Comparing Margins of
### Multivariate Binary Data, CSDA, 64, 87-98
### http://dx.doi.org/10.1016/j.csda.2013.02.016

### see supplementary material for data description
### NOTE: this is not the real data but only a subsample
influenza &lt;- structure(list(
HEADACHE = c(1L, 0L, 0L, 1L, 0L, 0L, 1L, 1L, 1L,
0L, 0L, 1L, 0L, 1L, 0L, 1L, 1L, 1L, 1L, 1L, 1L, 0L, 0L, 0L, 0L,
1L, 1L), MALAISE = c(0L, 0L, 1L, 1L, 0L, 1L, 1L, 1L, 0L, 1L,
0L, 0L, 1L, 1L, 0L, 0L, 1L, 0L, 1L, 0L, 1L, 0L, 1L, 1L, 0L, 1L,
0L), PYREXIA = c(0L, 0L, 0L, 0L, 0L, 1L, 0L, 1L, 0L, 0L, 1L,
1L, 1L, 1L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 1L, 0L, 0L, 0L, 1L, 1L
), ARTHRALGIA = c(0L, 0L, 0L, 0L, 1L, 0L, 1L, 0L, 1L, 1L, 0L,
0L, 1L, 1L, 0L, 1L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 1L, 1L, 1L, 1L
), group = structure(c(2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L,
2L, 2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L,
1L), .Label = c("pla", "trt"), class = "factor"), Freq = c(32L,
165L, 10L, 23L, 3L, 1L, 4L, 2L, 4L, 2L, 1L, 1L, 1L, 1L, 167L,
1L, 11L, 37L, 7L, 7L, 5L, 3L, 3L, 1L, 2L, 4L, 2L)), .Names = c("HEADACHE",
"MALAISE", "PYREXIA", "ARTHRALGIA", "group", "Freq"), row.names = c(1L,
2L, 3L, 5L, 9L, 36L, 43L, 50L, 74L, 83L, 139L, 175L, 183L, 205L,
251L, 254L, 255L, 259L, 279L, 281L, 282L, 286L, 302L, 322L, 323L,
366L, 382L), class = "data.frame")
influenza &lt;- influenza[rep(1:nrow(influenza), influenza$Freq), 1:5]

### Fitting marginal logistic regression models
(head_logreg &lt;- glm(HEADACHE ~ group, data = influenza, 
                    family = binomial()))
(mala_logreg &lt;- glm(MALAISE ~ group, data = influenza, 
                    family = binomial()))
(pyre_logreg &lt;- glm(PYREXIA ~ group, data = influenza, 
                    family = binomial()))
(arth_logreg &lt;- glm(ARTHRALGIA ~ group, data = influenza, 
                    family = binomial()))

### Simultaneous inference for log-odds
xy.sim &lt;- glht(mmm(head = head_logreg,
                   mala = mala_logreg,
                   pyre = pyre_logreg,
                   arth = arth_logreg),
               mlf("grouptrt = 0"))
summary(xy.sim)
confint(xy.sim)

### Artificial examples
### Combining linear regression and logistic regression
set.seed(29)
y1 &lt;- rnorm(100)
y2 &lt;- factor(y1 + rnorm(100, sd = .1) &gt; 0)
x1 &lt;- gl(4, 25) 
x2 &lt;- runif(100, 0, 10)

m1 &lt;- lm(y1 ~ x1 + x2)
m2 &lt;- glm(y2 ~ x1 + x2, family = binomial())
### Note that the same explanatory variables are considered in both models
### but the resulting parameter estimates are on 2 different scales 
### (original and log-odds scales)

### Simultaneous inference for the same parameter in the 2 model fits
summary(glht(mmm(m1 = m1, m2 = m2), mlf("x12 = 0")))

### Simultaneous inference for different parameters in the 2 model fits
summary(glht(mmm(m1 = m1, m2 = m2),
             mlf(m1 = "x12 = 0", m2 = "x13 = 0")))

### Simultaneous inference for different and identical parameters in the 2
### model fits
summary(glht(mmm(m1 = m1, m2 = m2),
             mlf(m1 = c("x12 = 0", "x13 = 0"), m2 = "x13 = 0")))

### Examples for binomial data
### Two independent outcomes
y1.1 &lt;- rbinom(100, 1, 0.45)
y1.2 &lt;- rbinom(100, 1, 0.55)
group &lt;- factor(rep(c("A", "B"), 50))

m1 &lt;- glm(y1.1 ~ group, family = binomial)
m2 &lt;- glm(y1.2 ~ group, family = binomial)

summary(glht(mmm(m1 = m1, m2 = m2), 
             mlf("groupB = 0")))

### Two perfectly correlated outcomes
y2.1 &lt;- rbinom(100, 1, 0.45)
y2.2 &lt;- y2.1
group &lt;- factor(rep(c("A", "B"), 50))

m1 &lt;- glm(y2.1 ~ group, family = binomial)
m2 &lt;- glm(y2.2 ~ group, family = binomial)

summary(glht(mmm(m1 = m1, m2 = m2), 
             mlf("groupB = 0")))

### use sandwich covariance matrix
summary(glht(mmm(m1 = m1, m2 = m2), 
             mlf("groupB = 0"), vcov = sandwich))

</code></pre>

<hr>
<h2 id='modelparm'> Generic Accessor Function for Model Parameters </h2><span id='topic+modelparm'></span>

<h3>Description</h3>

<p>Extract model parameters and their covariance matrix as well as 
degrees of freedom (if available) from a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelparm(model, coef., vcov., df, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modelparm_+3A_model">model</code></td>
<td>
<p>a fitted model,
for example an object returned by <code><a href="stats.html#topic+lm">lm</a></code>,
<code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="stats.html#topic+aov">aov</a></code>, <code><a href="survival.html#topic+survreg">survreg</a></code>,
<code><a href="fixest.html#topic+fixest">fixest</a></code>, or <code><a href="lme4.html#topic+lmer">lmer</a></code> etc. </p>
</td></tr>
<tr><td><code id="modelparm_+3A_coef.">coef.</code></td>
<td>
<p> an accessor function for the model parameters. Alternatively, the vector of coefficients.</p>
</td></tr>
<tr><td><code id="modelparm_+3A_vcov.">vcov.</code></td>
<td>
<p> an accessor function for the covariance matrix of the
model parameters. Alternatively, the covariance matrix directly.</p>
</td></tr>
<tr><td><code id="modelparm_+3A_df">df</code></td>
<td>
<p> an optional specification of the degrees of freedom to be used in
subsequent computations. </p>
</td></tr>
<tr><td><code id="modelparm_+3A_...">...</code></td>
<td>
<p> additional arguments, currently ignored. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>One can't expect <code><a href="stats.html#topic+coef">coef</a></code> and <code><a href="stats.html#topic+vcov">vcov</a></code> methods 
for arbitrary models to
return a vector of <code class="reqn">p</code> fixed effects model parameters (<code>coef</code>)
and corresponding <code class="reqn">p \times p</code> covariance matrix (<code>vcov</code>).
</p>
<p>The <code>coef.</code> and <code>vcov.</code> arguments can be used to define
modified <code>coef</code> or <code>vcov</code> methods for a specific model.
Methods for <code><a href="lme4.html#topic+lmer">lmer</a></code>, <code><a href="fixest.html#topic+fixest">fixest</a></code>, 
and <code><a href="survival.html#topic+survreg">survreg</a></code> objects are available (internally).
</p>
<p>For objects inheriting from class <code><a href="stats.html#topic+lm">lm</a></code> the degrees of 
freedom are determined from <code>model</code> and the corresponding
multivariate t distribution is used by all methods to <code><a href="#topic+glht">glht</a></code>
objects. By default, the asymptotic multivariate normal distribution
is used in all other cases unless <code>df</code> is specified by the user.
</p>


<h3>Value</h3>

<p>An object of class <code>modelparm</code> with elements
</p>
<table role = "presentation">
<tr><td><code>coef</code></td>
<td>
<p>model parameters</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>covariance matrix of model parameters</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
</table>

<hr>
<h2 id='mtept'>
Multiple Endpoints Data
</h2><span id='topic+mtept'></span>

<h3>Description</h3>

<p>Measurements on four endpoints in a two-arm clinical trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mtept)</code></pre>


<h3>Format</h3>

<p>A data frame with 111 observations on the following 5 variables.
</p>

<dl>
<dt><code>treatment</code></dt><dd><p>a factor with levels <code>Drug</code> <code>Placebo</code></p>
</dd>
<dt><code>E1</code></dt><dd><p>endpoint 1</p>
</dd>
<dt><code>E2</code></dt><dd><p>endpoint 2</p>
</dd>
<dt><code>E3</code></dt><dd><p>endpoint 3</p>
</dd>
<dt><code>E4</code></dt><dd><p>endpoint 4</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data (from Westfall et al., 1999) contain measurements of patients
in treatment (<code>Drug</code>) and control (<code>Placebo</code>) groups, with four
outcome variables.
</p>


<h3>Source</h3>

<p>P. H. Westfall, R. D. Tobias, D. Rom, R. D. Wolfinger, Y. Hochberg (1999).
<em>Multiple Comparisons and Multiple Tests Using the SAS System</em>.
Cary, NC: SAS Institute Inc.
</p>

<hr>
<h2 id='parm'> Model Parameters </h2><span id='topic+parm'></span>

<h3>Description</h3>

<p>Directly specify estimated model parameters and their covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parm(coef, vcov, df = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="parm_+3A_coef">coef</code></td>
<td>
<p> estimated coefficients.</p>
</td></tr>
<tr><td><code id="parm_+3A_vcov">vcov</code></td>
<td>
<p> estimated covariance matrix of the coefficients.</p>
</td></tr>
<tr><td><code id="parm_+3A_df">df</code></td>
<td>
<p> an optional specification of the degrees of freedom to be used in
subsequent computations. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>When only estimated model parameters and the corresponding
covariance matrix is available for simultaneous inference
using <code><a href="#topic+glht">glht</a></code> (for example, when only the results
but not the original data are available or, even worse, when the model
has been fitted outside R), function <code>parm</code> sets up an
object <code><a href="#topic+glht">glht</a></code> is able to compute on (mainly 
by offering <code>coef</code> and <code>vcov</code> methods).
</p>
<p>Note that the linear function in <code><a href="#topic+glht">glht</a></code> can't 
be specified via <code><a href="#topic+mcp">mcp</a></code> since the model terms
are missing.
</p>


<h3>Value</h3>

<p>An object of class <code>parm</code> with elements
</p>
<table role = "presentation">
<tr><td><code>coef</code></td>
<td>
<p>model parameters</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>covariance matrix of model parameters</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## example from
## Bretz, Hothorn, and Westfall (2002). 
## On multiple comparisons in R. R News, 2(3):14-17.

beta &lt;- c(V1 = 14.8, V2 = 12.6667, V3 = 7.3333, V4 = 13.1333)
Sigma &lt;- 6.7099 * (diag(1 / c(20, 3, 3, 15)))
confint(glht(model = parm(beta, Sigma, 37),
             linfct = c("V2 - V1 &gt;= 0", 
                        "V3 - V1 &gt;= 0", 
                        "V4 - V1 &gt;= 0")), 
        level = 0.9)

</code></pre>

<hr>
<h2 id='plot.cld'>Plot a cld object</h2><span id='topic+plot.cld'></span>

<h3>Description</h3>

<p>Plot information of <code>glht</code>, <code>summary.glht</code> or <code>confint.glht</code>
objects stored as <code>cld</code> objects together with a compact
letter display of all pair-wise comparisons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cld'
plot(x, type = c("response", "lp"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cld_+3A_x">x</code></td>
<td>

<p>An object of class <code>cld</code>.
</p>
</td></tr>
<tr><td><code id="plot.cld_+3A_type">type</code></td>
<td>

<p>Should the response or the linear predictor (lp) be plotted.
If there are any covariates, the lp is automatically used. To
use the response variable, set <code>type="response"</code> and <code>covar=FALSE</code>
of the <code>cld</code> object.
</p>
</td></tr>
<tr><td><code id="plot.cld_+3A_...">...</code></td>
<td>

<p>Other optional print parameters which are passed to the plotting functions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the information stored in <code>glht</code>, <code>summary.glht</code> or
<code>confint.glht</code> objects. Prior to plotting, these objects have to be converted to
<code>cld</code> objects (see <code><a href="#topic+cld">cld</a></code> for details).
All types of plots include a compact letter display (cld) of all pair-wise comparisons.
Equal letters indicate no significant differences. Two levels are significantly
different, in case they do not have any letters in common.
If the fitted model contains any covariates, a boxplot of the linear predictor is
generated with the cld within the upper margin. Otherwise, three different types
of plots are used depending on the class of variable <code>y</code> of the <code>cld</code> object.
In case of <code>class(y) == "numeric"</code>, a boxplot is generated using the response variable,
classified according to the levels of the variable used for the Tukey contrast
matrix. Is <code>class(y) == "factor"</code>, a mosaic plot is generated, and the cld is printed
above. In case of <code>class(y) == "Surv"</code>, a plot of fitted survival functions is generated
where the cld is plotted within the legend.
The compact letter display is computed using the algorithm of Piepho (2004).
Note: The user has to provide a sufficiently large upper margin which can be used to
depict the compact letter display (see examples).
</p>


<h3>References</h3>

<p>Hans-Peter Piepho (2004), An Algorithm for a Letter-Based Representation of All-Pairwise Comparisons,
<em>Journal of Computational and Graphical Statistics</em>, <b>13</b>(2), 456&ndash;466.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+glht">glht</a></code>
<code><a href="#topic+cld">cld</a></code>
<code><a href="#topic+cld.summary.glht">cld.summary.glht</a></code>
<code><a href="#topic+cld.confint.glht">cld.confint.glht</a></code>
<code><a href="#topic+cld.glht">cld.glht</a></code>
<code><a href="graphics.html#topic+boxplot">boxplot</a></code>
<code><a href="graphics.html#topic+mosaicplot">mosaicplot</a></code>
<code><a href="survival.html#topic+plot.survfit">plot.survfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ### multiple comparison procedures
  ### set up a one-way ANOVA
  data(warpbreaks)
  amod &lt;- aov(breaks ~ tension, data = warpbreaks)
  ### specify all pair-wise comparisons among levels of variable "tension"
  tuk &lt;- glht(amod, linfct = mcp(tension = "Tukey"))
  ### extract information
  tuk.cld &lt;- cld(tuk)
  ### use sufficiently large upper margin
  old.par &lt;- par(mai=c(1,1,1.25,1), no.readonly=TRUE)
  ### plot
  plot(tuk.cld)
  par(old.par)

  ### now using covariates
  amod2 &lt;- aov(breaks ~ tension + wool, data = warpbreaks)
  tuk2 &lt;- glht(amod2, linfct = mcp(tension = "Tukey"))
  tuk.cld2 &lt;- cld(tuk2)
  old.par &lt;- par(mai=c(1,1,1.25,1), no.readonly=TRUE)
  ### use different colors for boxes
  plot(tuk.cld2, col=c("green", "red", "blue"))
  par(old.par)
  
  ### get confidence intervals
  ci.glht &lt;- confint(tuk)
  ### plot them
  plot(ci.glht)
  old.par &lt;- par(mai=c(1,1,1.25,1), no.readonly=TRUE)
  ### use 'confint.glht' object to plot all pair-wise comparisons
  plot(cld(ci.glht), col=c("white", "blue", "green"))
  par(old.par)
  
  ### set up all pair-wise comparisons for count data
  data(Titanic)
  mod &lt;- glm(Survived ~ Class, data = as.data.frame(Titanic), 
             weights = Freq, family = binomial())
  ### specify all pair-wise comparisons among levels of variable "Class"
  glht.mod &lt;- glht(mod, mcp(Class = "Tukey"))
  ### extract information
  mod.cld &lt;- cld(glht.mod)
  ### use sufficiently large upper margin
  old.par &lt;- par(mai=c(1,1,1.5,1), no.readonly=TRUE)
  ### plot
  plot(mod.cld)
  par(old.par)
  
  ### set up all pair-wise comparisons of a Cox-model
  if (require("survival") &amp;&amp; require("MASS")) {
    ### construct 4 classes of age
    Melanoma$Cage &lt;- factor(sapply(Melanoma$age, function(x){
                            if( x &lt;= 25 ) return(1)
                            if( x &gt; 25 &amp; x &lt;= 50 ) return(2)
                            if( x &gt; 50 &amp; x &lt;= 75 ) return(3)
                            if( x &gt; 75 &amp; x &lt;= 100) return(4) }
                           ))
    ### fit Cox-model
    cm &lt;- coxph(Surv(time, status == 1) ~ Cage, data = Melanoma)
    ### specify all pair-wise comparisons among levels of "Cage"
    cm.glht &lt;- glht(cm, mcp(Cage = "Tukey"))
    # extract information &amp; plot
    old.par &lt;- par(no.readonly=TRUE)
    ### use mono font family
    if (dev.interactive())
        old.par &lt;- par(family = "mono")
    plot(cld(cm.glht), col=c("black", "red", "blue", "green"))
    par(old.par)
  }

  if (require("nlme") &amp;&amp; require("lme4")) {
    data("ergoStool", package = "nlme")

    stool.lmer &lt;- lmer(effort ~ Type + (1 | Subject),
                       data = ergoStool)
    glme41 &lt;- glht(stool.lmer, mcp(Type = "Tukey"))

    old.par &lt;- par(mai=c(1,1,1.5,1), no.readonly=TRUE)
    plot(cld(glme41))
    par(old.par)
  }
</code></pre>

<hr>
<h2 id='recovery'> Recovery Time Data Set </h2><span id='topic+recovery'></span>

<h3>Description</h3>

<p>Recovery time after surgery.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("recovery")</code></pre>


<h3>Format</h3>

<p>This data frame contains the following variables
</p>

<dl>
<dt>blanket</dt><dd><p>blanket type, a factor at four levels: <code>b0</code>, <code>b1</code>,
<code>b2</code>, and <code>b3</code>.</p>
</dd>
<dt>minutes</dt><dd><p>response variable: recovery time after a surgical 
procedure.</p>
</dd>
</dl>



<h3>Details</h3>

<p>A company developed specialized heating blankets designed to help the
body heat following a surgical procedure. Four types of blankets
were tried on surgical patients with the aim of comparing the
recovery time of patients. One of the blanket was a standard blanket
that had been in use already in various hospitals. 
</p>


<h3>Source</h3>

<p>P. H. Westfall, R. D. Tobias, D. Rom, R. D. Wolfinger, Y. Hochberg (1999).
<em>Multiple Comparisons and Multiple Tests Using the SAS System</em>.
Cary, NC: SAS Institute Inc., page 66.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ### set up one-way ANOVA
  amod &lt;- aov(minutes ~ blanket, data = recovery)

  ### set up multiple comparisons: one-sided Dunnett contrasts
  rht &lt;- glht(amod, linfct = mcp(blanket = "Dunnett"), 
              alternative = "less")

  ### cf. Westfall et al. (1999, p. 80)
  confint(rht, level = 0.9)

  ### the same
  rht &lt;- glht(amod, linfct = mcp(blanket = c("b1 - b0 &gt;= 0", 
                                             "b2 - b0 &gt;= 0", 
                                             "b3 - b0 &gt;= 0")))
  confint(rht, level = 0.9)

</code></pre>

<hr>
<h2 id='sbp'>
Systolic Blood Pressure Data
</h2><span id='topic+sbp'></span>

<h3>Description</h3>

<p>Systolic blood pressure, age and gender of 69 people.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sbp")</code></pre>


<h3>Format</h3>

<p>A data frame with 69 observations on the following 3 variables.
</p>

<dl>
<dt><code>gender</code></dt><dd><p>a factor with levels <code>male</code> <code>female</code></p>
</dd>
<dt><code>sbp</code></dt><dd><p>systolic blood pressure in mmHg</p>
</dd>
<dt><code>age</code></dt><dd><p>age in years</p>
</dd>
</dl>



<h3>Source</h3>

<p>D. G. Kleinbaum, L. L. Kupper, K. E. Muller, A. Nizam, A. (1998),
<em>Applied Regression Analysis and Other Multivariable Methods</em>,
Duxbury Press, North Scituate, MA.
</p>

<hr>
<h2 id='trees513'> Frankonian Tree Damage Data </h2><span id='topic+trees513'></span>

<h3>Description</h3>

<p>Damages on young trees caused by deer browsing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("trees513")</code></pre>


<h3>Format</h3>

<p>A data frame with 2700 observations on the following 4 variables.
</p>

<dl>
<dt><code>damage</code></dt><dd><p>a factor with levels <code>yes</code> and <code>no</code>
indicating whether or not the trees has been damaged by game animals,
mostly roe deer.</p>
</dd>
<dt><code>species</code></dt><dd><p>a factor with levels <code>spruce</code>, <code>fir</code>, 
<code>pine</code>, <code>softwood (other)</code>, <code>beech</code>, <code>oak</code>, <code>ash/maple/elm/lime</code>, 
and <code>hardwood (other)</code>.</p>
</dd>
<dt><code>lattice</code></dt><dd><p>a factor with levels <code>1</code>, ..., <code>53</code>, 
essentially a number indicating the position of the sampled area.</p>
</dd>
<dt><code>plot</code></dt><dd><p>a factor with levels <code>x_1</code>, ..., <code>x_5</code> where
<code>x</code> is the lattice. <code>plot</code>
is nested within <code>lattice</code> and is a replication for each lattice point.</p>
</dd>
</dl>



<h3>Details</h3>

<p>In most parts of Germany, the natural or artificial
regeneration of forests is difficult due to a high browsing
intensity. Young trees suffer from browsing damage, mostly by roe
and red deer. In order to estimate the browsing intensity for
several tree species, the Bavarian State Ministry of Agriculture
and Foresty conducts a survey every three years. Based on
the estimated percentage of damaged trees, suggestions for
the implementation or modification of deer management plans are made.
The survey takes place in all 756 game management districts
(&lsquo;Hegegemeinschaften&rsquo;) in Bavaria. The data given here are from 
the game management district number 513 &lsquo;Unterer Aischgrund&rsquo;
(located in Frankonia between Erlangen and H\&quot;ochstadt) in 2006. The data
of 2700 trees include the species and a binary
variable indicating whether or not the tree suffers from damage caused
by deer browsing.
</p>


<h3>Source</h3>

<p>Bayerisches Staatsministerium fuer Landwirtschaft und Forsten (2006),
Forstliche Gutachten zur Situation der Waldverjuengung 2006.
<a href="https://www.stmelf.bayern.de/wald/">https://www.stmelf.bayern.de/wald/</a>
</p>
<p>Torsten Hothorn, Frank Bretz and Peter Westfall (2008),
Simultaneous Inference in General Parametric Models.   
<em>Biometrical Journal</em>, <b>50</b>(3), 346&ndash;363;
See <code>vignette("generalsiminf", package = "multcomp")</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  summary(trees513)

</code></pre>

<hr>
<h2 id='waste'> Industrial Waste Data Set </h2><span id='topic+waste'></span>

<h3>Description</h3>

<p>Industrial waste output in a manufactoring plant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("waste")</code></pre>


<h3>Format</h3>

<p>This data frame contains the following variables
</p>

<dl>
<dt>temp</dt><dd><p>temperature, a factor at three levels: <code>low</code>, <code>medium</code>, <code>high</code>.</p>
</dd>
<dt>envir</dt><dd><p>environment, a factor at five levels: <code>env1</code> ... <code>env5</code>.</p>
</dd>
<dt>waste</dt><dd><p>response variable: waste output in a manufacturing plant.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data are from an experiment designed to study the effect of temperature
(<code>temp</code>) and environment (<code>envir</code>) on waste output in a manufactoring plant.
Two replicate measurements were taken at each temperature / environment combination.
</p>


<h3>Source</h3>

<p>P. H. Westfall, R. D. Tobias, D. Rom, R. D. Wolfinger, Y. Hochberg (1999).
<em>Multiple Comparisons and Multiple Tests Using the SAS System</em>.
Cary, NC: SAS Institute Inc., page 177.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ### set up two-way ANOVA with interactions
  amod &lt;- aov(waste ~ temp * envir, data=waste)

  ### comparisons of main effects only
  K &lt;- glht(amod, linfct = mcp(temp = "Tukey"))$linfct
  K
  glht(amod, K)

  ### comparisons of means (by averaging interaction effects)
  low &lt;- grep("low:envi", colnames(K))
  med &lt;- grep("medium:envi", colnames(K))
  K[1, low] &lt;- 1 / (length(low) + 1)
  K[2, med] &lt;- 1 / (length(low) + 1)
  K[3, med] &lt;- 1 / (length(low) + 1)
  K[3, low] &lt;- - 1 / (length(low) + 1)
  K
  confint(glht(amod, K))

  ### same as TukeyHSD
  TukeyHSD(amod, "temp")

  ### set up linear hypotheses for all-pairs of both factors
  wht &lt;- glht(amod, linfct = mcp(temp = "Tukey", envir = "Tukey"))

  ### cf. Westfall et al. (1999, page 181)
  summary(wht, test = adjusted("Shaffer"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
