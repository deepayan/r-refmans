<!DOCTYPE html><html><head><title>Help for package packMBPLSDA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {packMBPLSDA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#packMBPLSDA-package'>
<p>Multi-Block Partial Least Squares Discriminant Analysis</p></a></li>
<li><a href='#boot_mbplsda'>
<p>bootstraped simulations for multi-block partial least squares discriminant analysis</p></a></li>
<li><a href='#cvpred_mbplsda'>
<p>Cross-validated predicted categories from a multi-block partial least squares discriminant model</p></a></li>
<li><a href='#disjunctive'>
<p>Disjunctive table</p></a></li>
<li><a href='#ginv'>
<p>generalized inverse of a matrix X</p></a></li>
<li><a href='#inertie'>
<p>inertia of a matrix</p></a></li>
<li><a href='#mbplsda'>
<p>Multi-block partial least squares discriminant analysis</p></a></li>
<li><a href='#medical'>
<p>medical dataset</p></a></li>
<li><a href='#nutrition'>
<p>nutritional dataset</p></a></li>
<li><a href='#omics'>
<p>metabolomic dataset</p></a></li>
<li><a href='#permut_mbplsda'>
<p>Permutation testing of a multi-block partial least squares discriminant model</p></a></li>
<li><a href='#plot_boot_mbplsda'>
<p>Plot the results of the fonction boot_mbplsda in a pdf file</p></a></li>
<li><a href='#plot_cvpred_mbplsda'>
<p>Plot the results of the fonction cvpred_mbplsda in a pdf file</p></a></li>
<li><a href='#plot_permut_mbplsda'>
<p>Plot the results of the fonction permut_mbplsda in a pdf file</p></a></li>
<li><a href='#plot_pred_mbplsda'>
<p>Plot the results of the fonction pred_mbplsda in a pdf file</p></a></li>
<li><a href='#plot_testdim_mbplsda'>
<p>Plot the results of the fonction testdim_mbplsda in a pdf file</p></a></li>
<li><a href='#pred_mbplsda'>
<p>Observed parameters and predicted categories from a multi-block partial least squares discriminant model</p></a></li>
<li><a href='#status'><p>physiopathological status data</p></a></li>
<li><a href='#testdim_mbplsda'>
<p>Test of number of components by two-fold cross-validation for a multi-block partial least squares discriminant model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multi-Block Partial Least Squares Discriminant Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Marion Brandolini-Bunlon, Stephanie Bougeard, Melanie Petera, Estelle Pujos-Guillot</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marion Brandolini-Bunlon &lt;marion.brandolini-bunlon@inra.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Several functions are provided to implement a MBPLSDA : components search, optimal model components number search, optimal model validity test by permutation tests, observed values evaluation of optimal model parameters and predicted categories, bootstrap values evaluation of optimal model parameters and predicted cross-validated categories. The use of this package is described in Brandolini-Bunlon et al (2019. Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>ade4, pROC</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, parallel, doParallel, foreach, FactoMineR</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-20 15:43:57 UTC; mbrandolini</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-20 16:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='packMBPLSDA-package'>
Multi-Block Partial Least Squares Discriminant Analysis
</h2><span id='topic+packMBPLSDA-package'></span><span id='topic+packMBPLSDA'></span>

<h3>Description</h3>

<p>Several functions are provided to implement a MBPLSDA : components search, optimal model components number search, optimal model validity test by permutation tests, observed values evaluation of optimal model parameters and predicted categories, bootstrap values evaluation of optimal model parameters and predicted cross-validated categories. The use of this package is described in Brandolini-Bunlon et al (2019. Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134).
</p>


<h3>Details</h3>


<p>Index of help topics:
</p>
<pre>
boot_mbplsda            bootstraped simulations for multi-block partial
                        least squares discriminant analysis
cvpred_mbplsda          Cross-validated predicted categories from a
                        multi-block partial least squares discriminant
                        model
disjunctive             Disjunctive table
ginv                    generalized inverse of a matrix X
inertie                 inertia of a matrix
mbplsda                 Multi-block partial least squares discriminant
                        analysis
medical                 medical dataset
nutrition               nutritional dataset
omics                   metabolomic dataset
packMBPLSDA-package     Multi-Block Partial Least Squares Discriminant
                        Analysis
permut_mbplsda          Permutation testing of a multi-block partial
                        least squares discriminant model
plot_boot_mbplsda       Plot the results of the fonction boot_mbplsda
                        in a pdf file
plot_cvpred_mbplsda     Plot the results of the fonction cvpred_mbplsda
                        in a pdf file
plot_permut_mbplsda     Plot the results of the fonction permut_mbplsda
                        in a pdf file
plot_pred_mbplsda       Plot the results of the fonction pred_mbplsda
                        in a pdf file
plot_testdim_mbplsda    Plot the results of the fonction
                        testdim_mbplsda in a pdf file
pred_mbplsda            Observed parameters and predicted categories
                        from a multi-block partial least squares
                        discriminant model
status                  physiopathological status data
testdim_mbplsda         Test of number of components by two-fold
                        cross-validation for a multi-block partial
                        least squares discriminant model
</pre>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon, Stephanie Bougeard, Melanie Petera, Estelle Pujos-Guillot
</p>
<p>Maintainer: Marion Brandolini-Bunlon &lt;marion.brandolini-bunlon@inra.fr&gt;
</p>


<h3>References</h3>

<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mbplsda">mbplsda</a></code>
<code><a href="#topic+testdim_mbplsda">testdim_mbplsda</a></code>
<code><a href="#topic+plot_testdim_mbplsda">plot_testdim_mbplsda</a></code>
<code><a href="#topic+permut_mbplsda">permut_mbplsda</a></code>
<code><a href="#topic+plot_permut_mbplsda">plot_permut_mbplsda</a></code>
<code><a href="#topic+pred_mbplsda">pred_mbplsda</a></code>
<code><a href="#topic+plot_pred_mbplsda">plot_pred_mbplsda</a></code>
<code><a href="#topic+cvpred_mbplsda">cvpred_mbplsda</a></code>
<code><a href="#topic+plot_cvpred_mbplsda">plot_cvpred_mbplsda</a></code>
<code><a href="#topic+boot_mbplsda">boot_mbplsda</a></code>
<code><a href="#topic+plot_boot_mbplsda">plot_boot_mbplsda</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical, nutrition = nutrition, omics = omics))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 2)
</code></pre>

<hr>
<h2 id='boot_mbplsda'>
bootstraped simulations for multi-block partial least squares discriminant analysis
</h2><span id='topic+boot_mbplsda'></span>

<h3>Description</h3>

<p>Function to perform bootstraped simulations for multi-block partial least squares discriminant analysis, in order to get confidence intervals for regression coefficients, variable loadings, variable and block importances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot_mbplsda(object, nrepet = 199, optdim, cpus = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot_mbplsda_+3A_object">object</code></td>
<td>

<p>an object created by mbplsda
</p>
</td></tr>
<tr><td><code id="boot_mbplsda_+3A_nrepet">nrepet</code></td>
<td>

<p>integer indicating the number of repetitions
</p>
</td></tr>
<tr><td><code id="boot_mbplsda_+3A_optdim">optdim</code></td>
<td>

<p>integer indicating the optimal number of global components to be introduced in the model
</p>
</td></tr>
<tr><td><code id="boot_mbplsda_+3A_cpus">cpus</code></td>
<td>

<p>integer indicating the number of cpus to use when running the code in parallel
</p>
</td></tr>
<tr><td><code id="boot_mbplsda_+3A_...">...</code></td>
<td>

<p>other arguments to be passed to methods
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>no details are needed
</p>


<h3>Value</h3>

<table>
<tr><td><code>XYcoef</code></td>
<td>
<p>mean, standard deviation, quantiles (0.025;0.975), 95% confidence interval, median for regression coefficients</p>
</td></tr>
<tr><td><code>faX</code></td>
<td>
<p>mean, standard deviation, quantiles (0.025;0.975), 95% confidence interval, median for variable loadings</p>
</td></tr>
<tr><td><code>vipc</code></td>
<td>
<p>mean, standard deviation, quantiles (0.025;0.975), 95% confidence interval, median for cumulated variable importances</p>
</td></tr>
<tr><td><code>bipc</code></td>
<td>
<p>mean, standard deviation, quantiles (0.025;0.975), 95% confidence interval, median for cumulated block importances</p>
</td></tr>
</table>


<h3>Note</h3>

<p>at least 30 bootstrap repetitions may be recommended, more than 100 beeing preferable
</p>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Efron, B., Tibshirani, R.J. (1994). An Introduction to the Bootstrap. Chapman and Hall-CRC Monographs on Statistics and Applied Probability, Norwell, Massachusetts, United States.
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mbplsda">mbplsda</a></code>
<code><a href="#topic+plot_boot_mbplsda">plot_boot_mbplsda</a></code>
<code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical, nutrition = nutrition, omics = omics))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
ncpopt &lt;- 1
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 2)
resboot &lt;- boot_mbplsda(modelembplsQ, optdim = ncpopt, nrepet = 30, cpus=1)
</code></pre>

<hr>
<h2 id='cvpred_mbplsda'>
Cross-validated predicted categories from a multi-block partial least squares discriminant model
</h2><span id='topic+cvpred_mbplsda'></span>

<h3>Description</h3>

<p>Function to perform 2-fold cross-validation for multi-block partial least squares discriminant analysis, in order to get for each observation the cross-validated predicted categories, and the statistical description of the predictions (mean, sd, 95
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvpred_mbplsda(object, nrepet = 100, threshold = 0.5, bloY, optdim, cpus = 1, 
algo = c("max", "gravity", "threshold"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cvpred_mbplsda_+3A_object">object</code></td>
<td>

<p>an object created by mbplsda
</p>
</td></tr>
<tr><td><code id="cvpred_mbplsda_+3A_nrepet">nrepet</code></td>
<td>

<p>integer indicating the number of repetitions
</p>
</td></tr>
<tr><td><code id="cvpred_mbplsda_+3A_threshold">threshold</code></td>
<td>

<p>numeric indicating the threshold, between 0 and 1, to consider the categories are predicted with the threshold prediction method.
</p>
</td></tr>
<tr><td><code id="cvpred_mbplsda_+3A_bloy">bloY</code></td>
<td>

<p>integer vector indicating the number of categories per variable of the Y-block.
</p>
</td></tr>
<tr><td><code id="cvpred_mbplsda_+3A_optdim">optdim</code></td>
<td>

<p>integer indicating the (optimal) number of components of the multi-block partial least squares discriminant model
</p>
</td></tr>
<tr><td><code id="cvpred_mbplsda_+3A_cpus">cpus</code></td>
<td>

<p>integer indicating the number of cpus to use when running the code in parallel
</p>
</td></tr>
<tr><td><code id="cvpred_mbplsda_+3A_algo">algo</code></td>
<td>

<p>character vector indicating the method(s) of prediction to use (see details)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three different algorithms are available to predict the categories of observations.
In the max, and respectively the threshold algorithms, numeric values are calculated from the matrix of explanatory variables and the regression coefficients. Then, the predicted categorie for each variable of the Y-block is the one which corresponds to the higher predicted value, respectively to the values higher than the indicated threshold.
In the gravity algorithm, predicted scores of the observations on the components are calculated. Then, each observation is assigned to the observed category of which it is closest to the barycentre in the component space.
</p>


<h3>Value</h3>

<table>
<tr><td><code>TRUEnrepet</code></td>
<td>
<p>number of repetitions</p>
</td></tr>
<tr><td><code>matPredYc.max</code></td>
<td>
<p>with the max algorithm, boolean matrix indicating the cross-validated predicted categories on the calibration datasets, the prediction accuracy for each categorie, each Y-block variable, and overall</p>
</td></tr>
<tr><td><code>matPredYv.max</code></td>
<td>
<p>with the max algorithm, boolean matrix indicating the cross-validated predicted categories on the validation datasets, the prediction accuracy for each  categorie, each Y-block variable, and overall</p>
</td></tr>
<tr><td><code>matPredYc.gravity</code></td>
<td>
<p>with the gravity algorithm, boolean matrix indicating the cross-validated predicted categories on the calibration datasets, the prediction accuracy for each  categorie, each Y-block variable, and overall</p>
</td></tr>
<tr><td><code>matPredYv.gravity</code></td>
<td>
<p>with the gravity algorithm, boolean matrix indicating the cross-validated predicted categories on the validation datasets, the prediction accuracy for each  categorie, each Y-block variable, and overall</p>
</td></tr>
<tr><td><code>matPredYc.threshold</code></td>
<td>
<p>with the threshold algorithm, boolean matrix indicating the cross-validated predicted categories on the calibration datasets, the prediction accuracy for each  categorie, each Y-block variable, and overall</p>
</td></tr>
<tr><td><code>matPredYv.threshold</code></td>
<td>
<p>with the threshold algorithm, boolean matrix indicating the cross-validated predicted categories on the validation datasets, the prediction accuracy for each  categorie, each Y-block variable, and overall</p>
</td></tr>
<tr><td><code>statPredYc.max</code></td>
<td>
<p>with the max algorithm, matrix indicating the statistical description of prediction categories for each observation on the calibration datasets: number of predictions as an observation of the calibration dataset, modal value, probability to be predicted with its standard deviation, 95% confidence interval, quantiles 0.025 and 0.975, median value</p>
</td></tr>
<tr><td><code>statPredYv.max</code></td>
<td>
<p>with the max algorithm, matrix indicating the statistical description of prediction categories for each observation on the validation datasets: number of predictions as an observation of the validation dataset, modal value, probability to be predicted with its standard deviation, 95% confidence interval, quantiles 0.025 and 0.975, median value</p>
</td></tr>
<tr><td><code>statPredYc.gravity</code></td>
<td>
<p>with the gravity algorithm, matrix indicating the statistical description of prediction categories for each observation on the calibration datasets: number of predictions as an observation of the calibration dataset, modal value, probability to be predicted with its standard deviation, 95% confidence interval, quantiles 0.025 and 0.975, median value</p>
</td></tr>
<tr><td><code>statPredYv.gravity</code></td>
<td>
<p>with the gravity algorithm, matrix indicating the statistical description of prediction categories for each observation on the validation datasets: number of predictions as an observation of the validation dataset, modal value, probability to be predicted with its standard deviation, 95% confidence interval, quantiles 0.025 and 0.975, median value</p>
</td></tr>
<tr><td><code>statPredYc.threshold</code></td>
<td>
<p>with the threshold algorithm, matrix indicating the statistical description of prediction categories for each observation on the calibration datasets: number of predictions as an observation of the calibration dataset, modal value, probability to be predicted with its standard deviation, 95% confidence interval, quantiles 0.025 and 0.975, median value</p>
</td></tr>
<tr><td><code>statPredYv.threshold</code></td>
<td>
<p>with the threshold algorithm, matrix indicating the statistical description of prediction categories for each observation on the validation datasets: number of predictions as an observation of the validation dataset, modal value, probability to be predicted with its standard deviation, 95% confidence interval, quantiles 0.025 and 0.975, median value</p>
</td></tr>
</table>


<h3>Note</h3>

<p>at least 90 cross-validation repetitions may be recommended
</p>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Stone, M. (1974). Cross-validatory choice and assessment of statistical predictions. Journal of the Royal Statistical Society B, 36(2), 111-147.
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mbplsda">mbplsda</a></code>
<code><a href="#topic+plot_cvpred_mbplsda">plot_cvpred_mbplsda</a></code>
<code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical[,1:10], 
nutrition = nutrition[,1:10], omics = omics[,1:20]))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
bloYobs &lt;- 2
ncpopt &lt;- 1
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 2)
CVpred &lt;- cvpred_mbplsda(modelembplsQ, nrepet = 30, threshold = 0.5, bloY = bloYobs, 
optdim = ncpopt, cpus = 1, algo = c("max"))


data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical, 
nutrition = nutrition, omics = omics))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
bloYobs &lt;- 2
ncpopt &lt;- 1
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 2)
CVpred &lt;- cvpred_mbplsda(modelembplsQ, nrepet = 90, threshold = 0.5, bloY = bloYobs, 
optdim = ncpopt, cpus = 1, algo = c("max"))


</code></pre>

<hr>
<h2 id='disjunctive'>
Disjunctive table
</h2><span id='topic+disjunctive'></span>

<h3>Description</h3>

<p>Function to transform a boolean matrix in a disjunctive table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>disjunctive(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="disjunctive_+3A_y">y</code></td>
<td>
<p>boolean matrix indicating observations categories</p>
</td></tr>
</table>


<h3>Details</h3>

<p>no details are needed
</p>


<h3>Value</h3>

<table>
<tr><td><code>ydisj</code></td>
<td>
<p>disjunctive table</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(status)
disjonctif &lt;- (disjunctive(status))
</code></pre>

<hr>
<h2 id='ginv'>
generalized inverse of a matrix X
</h2><span id='topic+ginv'></span>

<h3>Description</h3>

<p>function to calculate the generalized inverse of a matrix X
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ginv(X, tol = sqrt(.Machine$double.eps))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ginv_+3A_x">X</code></td>
<td>

<p>Matrix for which the generalized inverse is required
</p>
</td></tr>
<tr><td><code id="ginv_+3A_tol">tol</code></td>
<td>

<p>A relative tolerance to detect zero singular values
</p>
</td></tr>
</table>

<hr>
<h2 id='inertie'>
inertia of a matrix
</h2><span id='topic+inertie'></span>

<h3>Description</h3>

<p>function to calculate the inertia of a matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inertie(tab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inertie_+3A_tab">tab</code></td>
<td>

<p>a matrix
</p>
</td></tr>
</table>

<hr>
<h2 id='mbplsda'>
Multi-block partial least squares discriminant analysis
</h2><span id='topic+mbplsda'></span>

<h3>Description</h3>

<p>Function to perform a multi-block partial least squares discriminant analysis (MBPLSDA) of several explanatory blocks defined as an object of class ktab, to explain a dependent dataset (Y-block) defined as an object of class dudi, in order to get model parameters for the indicated number of components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mbplsda(dudiY, ktabX, scale = TRUE, option = c("uniform", "none"), 
scannf = TRUE, nf = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mbplsda_+3A_dudiy">dudiY</code></td>
<td>

<p>an object of class dudi containing the dependent variables
</p>
</td></tr>
<tr><td><code id="mbplsda_+3A_ktabx">ktabX</code></td>
<td>

<p>an object of class ktab containing the blocks of explanatory variables
</p>
</td></tr>
<tr><td><code id="mbplsda_+3A_scale">scale</code></td>
<td>

<p>logical value indicating whether the explanatory variables should be standardized
</p>
</td></tr>
<tr><td><code id="mbplsda_+3A_option">option</code></td>
<td>

<p>option for the block weighting. If uniform, the weight of each explanatory block is equal to 1/number of explanatory blocks, and the weight of the Y-block is eqyual to 1. If none, the block weight is equal to the block inertia.
</p>
</td></tr>
<tr><td><code id="mbplsda_+3A_scannf">scannf</code></td>
<td>

<p>logical value indicating whether the eigenvalues bar plot should be displayed
</p>
</td></tr>
<tr><td><code id="mbplsda_+3A_nf">nf</code></td>
<td>

<p>integer indicating the number of components to be calculated
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>no details are needed
</p>


<h3>Value</h3>

<table>
<tr><td><code>call</code></td>
<td>
<p>the matching call</p>
</td></tr>
<tr><td><code>tabX</code></td>
<td>
<p>data frame of explanatory variables centered, eventually scaled (if scale=TRUE)and weighted (if option=&quot;uniform&quot;)</p>
</td></tr>
<tr><td><code>tabY</code></td>
<td>
<p>data frame of dependent variables centered, eventually scaled (if scale=TRUE)and weighted (if option=&quot;uniform&quot;)</p>
</td></tr>
<tr><td><code>nf</code></td>
<td>
<p>integer indicating the number of kept dimensions</p>
</td></tr>
<tr><td><code>lw</code></td>
<td>
<p>numeric vector of row weights</p>
</td></tr>
<tr><td><code>X.cw</code></td>
<td>
<p>numeric vector of column weights for the explanalatory dataset</p>
</td></tr>
<tr><td><code>blo</code></td>
<td>
<p>vector of the numbers of variables in each explanatory dataset</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>rank of the analysis</p>
</td></tr>
<tr><td><code>eig</code></td>
<td>
<p>numeric vector containing the eigenvalues</p>
</td></tr>
<tr><td><code>TL</code></td>
<td>
<p>dataframe useful to manage graphical outputs</p>
</td></tr>
<tr><td><code>TC</code></td>
<td>
<p>dataframe useful to manage graphical outputs</p>
</td></tr>
<tr><td><code>faX</code></td>
<td>
<p>matrix containing the global variable loadings associated with the global explanatory dataset</p>
</td></tr>
<tr><td><code>Tc1</code></td>
<td>
<p>matrix containing the partial variable loadings associated with each explanatory dataset(unit norm)</p>
</td></tr>
<tr><td><code>Yc1</code></td>
<td>
<p>matrix of the variable loadings associated with the dependent dataset</p>
</td></tr>
<tr><td><code>lX</code></td>
<td>
<p>matrix of the global components associated with the whole explanatory dataset(scores of the individuals)</p>
</td></tr>
<tr><td><code>TlX</code></td>
<td>
<p>matrix containing the partial components associated with each explanatory dataset</p>
</td></tr>
<tr><td><code>lY</code></td>
<td>
<p>matrix of the components associated with the dependent dataset</p>
</td></tr>
<tr><td><code>cov2</code></td>
<td>
<p>squared covariance between lY and TlX</p>
</td></tr>
<tr><td><code>XYcoef</code></td>
<td>
<p>list of matrices of the regression coefficients of the whole explanatory dataset onto the dependent dataset</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p>intercept of the regression of the whole explanatory dataset onto the dependent dataset</p>
</td></tr>
<tr><td><code>XYcoef.raw</code></td>
<td>
<p>list of matrices of the regression coefficients of the whole raw explanatory dataset onto the raw dependent dataset</p>
</td></tr>
<tr><td><code>intercept.raw</code></td>
<td>
<p>intercept of the regression of the whole raw explanatory dataset onto the raw dependent dataset</p>
</td></tr>
<tr><td><code>bip</code></td>
<td>
<p>block importances for a given dimension</p>
</td></tr>
<tr><td><code>bipc</code></td>
<td>
<p>cumulated block importances for a given number of dimensions</p>
</td></tr>
<tr><td><code>vip</code></td>
<td>
<p>variable importances for a given dimension</p>
</td></tr>
<tr><td><code>vipc</code></td>
<td>
<p>cumulated variable importances for a given number of dimensions</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is coming from the mbpls function of the R package ade4 (application in order to explain a disjunctive table, limitation of the number of calculated components)
</p>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Bougeard, S. and Dray, S. (2018) Supervised Multiblock Analysis in R with the ade4 Package.Journal of Statistical Software,86(1), 1-17.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical, nutrition = nutrition, omics = omics))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 2)
</code></pre>

<hr>
<h2 id='medical'>
medical dataset
</h2><span id='topic+medical'></span>

<h3>Description</h3>

<p>extract of modified medical data obtained from physical examination and questionnaires in a human cohort study
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("medical")</code></pre>


<h3>Format</h3>

<p>A data frame with 40 observations on the following 18 variables.
</p>

<dl>
<dt><code>medic1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic4</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic5</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic6</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic7</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic8</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic9</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic10</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic11</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic12</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic13</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic14</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic15</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic16</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic17</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>medic18</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>no details are needed
</p>


<h3>Source</h3>

<p>non-real data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medical)
</code></pre>

<hr>
<h2 id='nutrition'>
nutritional dataset
</h2><span id='topic+nutrition'></span>

<h3>Description</h3>

<p>extract of modified nutritional data obtained by analysis of food questionnaires in a human cohort study
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("nutrition")</code></pre>


<h3>Format</h3>

<p>A data frame with 40 observations on the following 33 variables.
</p>

<dl>
<dt><code>nutri1</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri2</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri3</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri4</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri5</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri6</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri7</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri8</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri9</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri10</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri11</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri12</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri13</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri14</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri15</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri16</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri17</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri18</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri19</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri20</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri21</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri22</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri23</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri24</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri25</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri26</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri27</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri28</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri29</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri30</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri31</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri32</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>nutri33</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>no details are needed
</p>


<h3>Source</h3>

<p>non-real data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nutrition)
</code></pre>

<hr>
<h2 id='omics'>
metabolomic dataset
</h2><span id='topic+omics'></span>

<h3>Description</h3>

<p>extract of modified metabolomic data obtained by LC-MS analysis of human plasma samples in a cohort study
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("omics")</code></pre>


<h3>Format</h3>

<p>A data frame with 40 observations on the following 46 variables.
</p>

<dl>
<dt><code>omic1</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic2</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic3</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic4</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic5</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic6</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic7</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic8</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic9</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic10</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic11</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic12</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic13</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic14</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic15</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic16</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic17</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic18</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic19</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic20</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic21</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic22</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic23</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic24</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic25</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic26</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic27</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic28</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic29</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic30</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic31</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic32</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic33</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic34</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic35</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic36</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic37</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic38</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic39</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic40</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic41</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic42</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic43</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic44</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic45</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
<dt><code>omic46</code></dt><dd><p>a numeric vector of relative intensities</p>
</dd>
</dl>



<h3>Details</h3>

<p>no details are needed
</p>


<h3>Source</h3>

<p>non-real data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(omics)
</code></pre>

<hr>
<h2 id='permut_mbplsda'>
Permutation testing of a multi-block partial least squares discriminant model
</h2><span id='topic+permut_mbplsda'></span>

<h3>Description</h3>

<p>Function to perform permutation testing with 2-fold cross-validation for multi-block partial least squares discriminant analysis, in order to evaluate model validity and predictivity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permut_mbplsda(object, optdim, bloY, algo = c("max", "gravity", "threshold"), 
threshold = 0.5, nrepet = 100, npermut = 100, nbObsPermut = NULL, 
outputs = c("ER", "ConfMat", "AUC"), cpus = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="permut_mbplsda_+3A_object">object</code></td>
<td>

<p>an object created by mbplsda_nfX
</p>
</td></tr>
<tr><td><code id="permut_mbplsda_+3A_optdim">optdim</code></td>
<td>

<p>integer indicating the (optimal) number of components of the multi-block partial least squares discriminant model
</p>
</td></tr>
<tr><td><code id="permut_mbplsda_+3A_bloy">bloY</code></td>
<td>

<p>integer vector indicating the number of categories per variable of the Y-block.
</p>
</td></tr>
<tr><td><code id="permut_mbplsda_+3A_algo">algo</code></td>
<td>

<p>character vector indicating the method(s) of prediction to use (see details)
</p>
</td></tr>
<tr><td><code id="permut_mbplsda_+3A_threshold">threshold</code></td>
<td>

<p>numeric indicating the threshold, between 0 and 1, to consider the categories are predicted with the threshold prediction method.
</p>
</td></tr>
<tr><td><code id="permut_mbplsda_+3A_nrepet">nrepet</code></td>
<td>

<p>integer indicating the number of repetitions
</p>
</td></tr>
<tr><td><code id="permut_mbplsda_+3A_npermut">npermut</code></td>
<td>

<p>integer indicating the number of Y-block with switching observations
</p>
</td></tr>
<tr><td><code id="permut_mbplsda_+3A_nbobspermut">nbObsPermut</code></td>
<td>

<p>integer indicating the number of switching observations in all the modified Y-blocks
</p>
</td></tr>
<tr><td><code id="permut_mbplsda_+3A_outputs">outputs</code></td>
<td>

<p>character vector indicating the wanted outputs (see details)
</p>
</td></tr>
<tr><td><code id="permut_mbplsda_+3A_cpus">cpus</code></td>
<td>

<p>integer indicating the number of cpus to use when running the code in parallel
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three different algorithms are available to predict the categories of observations.
In the max, and respectively the threshold algorithms, numeric values are calculated from the matrix of explanatory variables and the regression coefficients. Then, the predicted categorie for each variable of the Y-block is the one which corresponds to the higher predicted value, respectively to the values higher than the indicated threshold.
In the gravity algorithm, predicted scores of the observations on the components are calculated. Then, each observation is assigned to the observed category of which it is closest to the barycentre in the component space.
</p>
<p>If nbObsPermut is not NULL, t-test are performed to compare mean cross-validated overall prediction error rates (or aera under ROC curve) evaluated on permuted Y-blocks, with the cross-validated overall prediction error rate (or aera under ROC curve) evaluated on the original Y-block.
</p>
<p>Available outputs are Error Rates (ER), Confusion Matrix (ConfMat), Aera Under Curve (AUC).
</p>


<h3>Value</h3>

<table>
<tr><td><code>RV.YYpermut.values</code></td>
<td>
<p>RV coefficient between Y-block and each Y-block with permuted values</p>
</td></tr>
<tr><td><code>cor.YYpermut.values</code></td>
<td>
<p>correlation coefficient between categories in the Y-block and each Y-block with permuted values</p>
</td></tr>
<tr><td><code>prctGlob.Ychange.values</code></td>
<td>
<p>overall percentage of modified values in each Y-block with permuted values</p>
</td></tr>
<tr><td><code>prct.Ychange.values</code></td>
<td>
<p>percentage per category of modified values in each Y-block with permuted values</p>
</td></tr>
<tr><td><code>descrYperm</code></td>
<td>
<p>statistical description of RV.YYpermut, cor.YYpermut, prctGlob.Ychange, prct.Ychange</p>
</td></tr>
<tr><td><code>TruePosC.max</code>, <code>TruePosC.gravity</code>, <code>TruePosC.threshold</code></td>
<td>
<p>statistical description of cross-validated percentages of true positive observations per category, evaluated on calibration datasets, with the different algorithms (TruePosC.max for &quot;max&quot;, TruePosC.gravity for &quot;gravity&quot;, TruePosC.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>TruePosV.max</code>, <code>TruePosV.gravity</code>, <code>TruePosV.threshold</code></td>
<td>
<p>statistical description of cross-validated percentages of true positive observations per category, evaluated on validation datasets, with the different algorithms (TruePosV.max for &quot;max&quot;, TruePosV.gravity for &quot;gravity&quot;, TruePosV.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>TrueNegC.max</code>, <code>TrueNegC.gravity</code>, <code>TrueNegC.threshold</code></td>
<td>
<p>statistical description of cross-validated percentages of true negative observations per category, evaluated on calibration datasets, with the different algorithms (TrueNegC.max for &quot;max&quot;, TrueNegC.gravity for &quot;gravity&quot;, TrueNegC.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>TrueNegV.max</code>, <code>TrueNegV.gravity</code>, <code>TrueNegV.threshold</code></td>
<td>
<p>statistical description of cross-validated percentages of true negative observations per category, evaluated on validation datasets, with the different algorithms (TrueNegV.max for &quot;max&quot;, TrueNegV.gravity for &quot;gravity&quot;, TrueNegV.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>FalsePosC.max</code>, <code>FalsePosC.gravity</code>, <code>FalsePosC.threshold</code></td>
<td>
<p>statistical description of cross-validated percentages of false positive observations per category, evaluated on calibration datasets, with the different algorithms (FalsePosC.max for &quot;max&quot;, FalsePosC.gravity for &quot;gravity&quot;, FalsePosC.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>FalsePosV.max</code>, <code>FalsePosV.gravity</code>, <code>FalsePosV.threshold</code></td>
<td>
<p>statistical description of cross-validated percentages of false positive observations per category, evaluated on validation datasets, with the different algorithms (FalsePosV.max for &quot;max&quot;, FalsePosV.gravity for &quot;gravity&quot;, FalsePosV.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>FalseNegC.max</code>, <code>FalseNegC.gravity</code>, <code>FalseNegC.threshold</code></td>
<td>
<p>statistical description of cross-validated percentages of false negative observations per category, evaluated on calibration datasets, with the different algorithms (FalseNegC.max for &quot;max&quot;, FalseNegC.gravity for &quot;gravity&quot;, FalseNegC.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>FalseNegV.max</code>, <code>FalseNegV.gravity</code>, <code>FalseNegV.threshold</code></td>
<td>
<p>statistical description of cross-validated percentages of false negative observations per category, evaluated on validation datasets, with the different algorithms (FalseNegV.max for &quot;max&quot;, FalseNegV.gravity for &quot;gravity&quot;, FalseNegV.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>ErrorRateC.max</code>, <code>ErrorRateC.gravity</code>, <code>ErrorRateC.threshold</code></td>
<td>
<p>statistical description of cross-validated prediction error rates per category, evaluated on calibration datasets, with the different algorithms (ErrorRateC.max for &quot;max&quot;, ErrorRateC.gravity for &quot;gravity&quot;, ErrorRateC.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>ErrorRateV.max</code>, <code>ErrorRateV.gravity</code>, <code>ErrorRateV.threshold</code></td>
<td>
<p>statistical description of cross-validated prediction error rates per category, evaluated on validation datasets, with the different algorithms (ErrorRateV.max for &quot;max&quot;, ErrorRateV.gravity for &quot;gravity&quot;, ErrorRateV.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>ErrorRateCglobal.max</code>, <code>ErrorRateCglobal.gravity</code>, <code>ErrorRateCglobal.threshold</code></td>
<td>
<p>statistical description of cross-validated overall prediction error rates, evaluated on calibration datasets, with the different algorithms (ErrorRateCglobal.max for &quot;max&quot;, ErrorRateCglobal.gravity for &quot;gravity&quot;, ErrorRateCglobal.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>ErrorRateVglobal.max</code>, <code>ErrorRateVglobal.gravity</code>, <code>ErrorRateVglobal.threshold</code></td>
<td>
<p>statistical description of cross-validated overall prediction error rates, evaluated on validation datasets, with the different algorithms (ErrorRateVglobal.max for &quot;max&quot;, ErrorRateVglobal.gravity for &quot;gravity&quot;, ErrorRateVglobal.threshold for &quot;threshold&quot;), for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>AUCc</code></td>
<td>
<p>if all Y-block variables are binary, statistical description of cross-validated aera under ROC curve values per category, evaluated on the validation datasets, for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>AUCv</code></td>
<td>
<p>if all Y-block variables are binary, statistical description of cross-validated aera under ROC curve values per category, evaluated on the validation datasets, for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>AUCc.global</code></td>
<td>
<p>if all Y-block variables are binary, statistical description of cross-validated overall aera under ROC curve values, evaluated on the validation datasets, for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>AUCv.global</code></td>
<td>
<p>if all Y-block variables are binary, statistical description of cross-validated overall aera under ROC curve values, evaluated on the validation datasets, for each Y-block with permuted values</p>
</td></tr>
<tr><td><code>reg.GlobalRes_prctYchange</code></td>
<td>
<p>results of linear regression of overall prediction error rates, and overall aera under ROC curve, onto percentages of modified values in Y-block</p>
</td></tr>
<tr><td><code>ttestMeanERv</code></td>
<td>
<p>if nbObsPermut is not NULL, results of the t-test comparing mean cross-validated overall prediction error rates (and eventually aera under ROC curve) evaluated on permuted Y-blocks, with the cross-validated overall prediction error rate (and eventually aera under ROC curve) evaluated on the original Y-block</p>
</td></tr>
</table>


<h3>Note</h3>

<p>at least 30 cross-validation repetitions and 100 Y-block with switching observations may be recommended
</p>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Westerhuis, J.A., Hoefsloot, H.C.J., Smit, S., Vis, D.J., Smilde, A.K., van Velzen, E.J.J., van Duijnhoven, J.P.M., van Dorsten, F.A. (2008). Assessment of PLSDA cross validation. Metabolomics, 4, 81-89.
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mbplsda">mbplsda</a></code>
<code><a href="#topic+plot_permut_mbplsda">plot_permut_mbplsda</a></code>
<code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical[1:20,], omics = omics[1:20,]))
disjonctif &lt;- (disjunctive(data.frame(status=status[1:20,], 
row.names = rownames(status)[1:20])))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
bloYobs &lt;- 2
ncpopt &lt;- 1
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", 
scannf = FALSE, nf = 1)
rtsPermut &lt;- permut_mbplsda(modelembplsQ, nrepet = 30, npermut = 100, optdim = ncpopt, 
outputs = c("ER"), bloY = bloYobs, nbObsPermut = 10, cpus=1, algo = c("max"))

</code></pre>

<hr>
<h2 id='plot_boot_mbplsda'>
Plot the results of the fonction boot_mbplsda in a pdf file
</h2><span id='topic+plot_boot_mbplsda'></span>

<h3>Description</h3>

<p>Fonction to draw the results of the fonction boot_mbplsda (2-fold cross-validated parameter values) in a pdf file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_boot_mbplsda(obj, filename = "PlotBootstrapMbplsda", propbestvar = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_boot_mbplsda_+3A_obj">obj</code></td>
<td>

<p>object type list containing the results of the fonction boot_mbplsda
</p>
</td></tr>
<tr><td><code id="plot_boot_mbplsda_+3A_filename">filename</code></td>
<td>

<p>a string of characters indicating the given pdf filename
</p>
</td></tr>
<tr><td><code id="plot_boot_mbplsda_+3A_propbestvar">propbestvar</code></td>
<td>

<p>numeric value between 0 and 1, indicating the pourcentage of variables with the best VIPc values to plot
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>no details are needed
</p>


<h3>Value</h3>

<p>no numeric result
</p>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Efron, B., Tibshirani, R.J. (1994). An Introduction to the Bootstrap. Chapman and Hall-CRC Monographs on Statistics and Applied Probability, Norwell, Massachusetts, United States.
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mbplsda">mbplsda</a></code>
<code><a href="#topic+boot_mbplsda">boot_mbplsda</a></code>
<code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical, nutrition = nutrition, omics = omics))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
ncpopt &lt;- 1
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 2)
resboot &lt;- boot_mbplsda(modelembplsQ, optdim = ncpopt, nrepet = 30, cpus=1)
plot_boot_mbplsda(resboot,"plotBoot_nf1_30rep", propbestvar=0.20)

</code></pre>

<hr>
<h2 id='plot_cvpred_mbplsda'>
Plot the results of the fonction cvpred_mbplsda in a pdf file
</h2><span id='topic+plot_cvpred_mbplsda'></span>

<h3>Description</h3>

<p>Fonction to draw the results of the fonction cvpred_mbplsda (2-fold cross-validated predictions) in a pdf file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_cvpred_mbplsda(obj, filename = "PlotCVpredMbplsda")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_cvpred_mbplsda_+3A_obj">obj</code></td>
<td>

<p>object type list containing the results of the fonction cvpred_mbplsda
</p>
</td></tr>
<tr><td><code id="plot_cvpred_mbplsda_+3A_filename">filename</code></td>
<td>

<p>a string of characters indicating the given pdf filename
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>no details are needed
</p>


<h3>Value</h3>

<p>no numeric result
</p>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Stone, M. (1974). Cross-validatory choice and assessment of statistical predictions. Journal of the Royal Statistical Society B, 36(2), 111-147.
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mbplsda">mbplsda</a></code>
<code><a href="#topic+cvpred_mbplsda">cvpred_mbplsda</a></code>
<code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical[,1:10], 
nutrition = nutrition[,1:10], omics = omics[,1:20]))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
bloYobs &lt;- 2
ncpopt &lt;- 1
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", 
scannf = FALSE, nf = 2)
CVpred &lt;- cvpred_mbplsda(modelembplsQ, nrepet = 30, threshold = 0.5, bloY=bloYobs, 
optdim=ncpopt, cpus = 1, algo = c("max"))
plot_cvpred_mbplsda(CVpred,"plotCVPred_nf1_30rep")



data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical, 
nutrition = nutrition, omics = omics))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
bloYobs &lt;- 2
ncpopt &lt;- 1
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", 
scannf = FALSE, nf = 2)
CVpred &lt;- cvpred_mbplsda(modelembplsQ, nrepet = 90, threshold = 0.5, bloY=bloYobs, 
optdim=ncpopt, cpus = 1, algo = c("max"))
plot_cvpred_mbplsda(CVpred,"plotCVPred_nf1_90rep")

</code></pre>

<hr>
<h2 id='plot_permut_mbplsda'>
Plot the results of the fonction permut_mbplsda in a pdf file
</h2><span id='topic+plot_permut_mbplsda'></span>

<h3>Description</h3>

<p>Fonction to draw the results of the fonction permut_mbplsda (plot and regression line of cross validated prediction error rates, evaluated on the validation datasets, in function of the percent of modified Y-block values) in a pdf file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_permut_mbplsda(obj, filename = "PlotPermutationTest", 
MainPlot = "Permutation test results \n (subset of validation)")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_permut_mbplsda_+3A_obj">obj</code></td>
<td>

<p>object type list containing the results of the fonction permut_mbplsda 
</p>
</td></tr>
<tr><td><code id="plot_permut_mbplsda_+3A_filename">filename</code></td>
<td>

<p>a string of characters indicating the given pdf filename
</p>
</td></tr>
<tr><td><code id="plot_permut_mbplsda_+3A_mainplot">MainPlot</code></td>
<td>

<p>a string of characters indicating the given main title
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>no details are needed
</p>


<h3>Value</h3>

<p>no numeric result
</p>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Westerhuis, J.A., Hoefsloot, H.C.J., Smit, S., Vis, D.J., Smilde, A.K., van Velzen, E.J.J., van Duijnhoven, J.P.M., van Dorsten, F.A. (2008). Assessment of PLSDA cross validation. Metabolomics, 4, 81-89.
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mbplsda">mbplsda</a></code>
<code><a href="#topic+permut_mbplsda">permut_mbplsda</a></code>
<code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical[1:20,], omics = omics[1:20,]))
disjonctif &lt;- (disjunctive(data.frame(status=status[1:20,], 
row.names = rownames(status)[1:20])))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
bloYobs &lt;- 2
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 1)
ncpopt &lt;- 1
rtsPermut &lt;- permut_mbplsda(modelembplsQ, nrepet = 30, npermut = 100, optdim = ncpopt, 
outputs = c("ER"), bloY=bloYobs, nbObsPermut = 10, cpus = 1, algo = c("max"))
plot_permut_mbplsda(rtsPermut,"plotPermut_nf1_30rep_100perm")

</code></pre>

<hr>
<h2 id='plot_pred_mbplsda'>
Plot the results of the fonction pred_mbplsda in a pdf file
</h2><span id='topic+plot_pred_mbplsda'></span>

<h3>Description</h3>

<p>Fonction to draw the results of the fonction pred_mbplsda (observed parameter values and predictions) in a pdf file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_pred_mbplsda(obj, filename = "PlotPredMbplsda", propbestvar = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_pred_mbplsda_+3A_obj">obj</code></td>
<td>

<p>object type list containing the results of the fonction pred_mbplsda
</p>
</td></tr>
<tr><td><code id="plot_pred_mbplsda_+3A_filename">filename</code></td>
<td>

<p>a string of characters indicating the given pdf filename
</p>
</td></tr>
<tr><td><code id="plot_pred_mbplsda_+3A_propbestvar">propbestvar</code></td>
<td>

<p>numeric value between 0 and 1, indicating the pourcentage of variables with the best VIPc values to plot
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>no details are needed
</p>


<h3>Value</h3>

<p>no numeric result
</p>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mbplsda">mbplsda</a></code>
<code><a href="#topic+pred_mbplsda">pred_mbplsda</a></code>
<code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical, nutrition = nutrition, omics = omics))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
bloYobs &lt;- 2
ncpopt &lt;- 1
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 2)
predictions &lt;- pred_mbplsda(modelembplsQ, optdim = ncpopt, threshold = 0.5, 
bloY=bloYobs, algo = c("max", "gravity", "threshold"))
plot_pred_mbplsda(predictions,"plotPred_nf1", propbestvar=0.20)

</code></pre>

<hr>
<h2 id='plot_testdim_mbplsda'>
Plot the results of the fonction testdim_mbplsda in a pdf file
</h2><span id='topic+plot_testdim_mbplsda'></span>

<h3>Description</h3>

<p>Fonction to draw the results of the fonction testdim_mbplsda (cross validated prediction error rates, or aera under ROC curve, in function of the number of components in the model) in a pdf file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_testdim_mbplsda(obj, filename = "PlotTestdimMbplsda")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_testdim_mbplsda_+3A_obj">obj</code></td>
<td>

<p>object type list containing the results of the fonction testdim_mbplsda
</p>
</td></tr>
<tr><td><code id="plot_testdim_mbplsda_+3A_filename">filename</code></td>
<td>

<p>a string of characters indicating the given pdf filename
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>no details are needed
</p>


<h3>Value</h3>

<p>no numeric result
</p>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Stone, M. (1974). Cross-validatory choice and assessment of statistical predictions. Journal of the Royal Statistical Society B, 36(2), 111-147.
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mbplsda">mbplsda</a></code>
<code><a href="#topic+testdim_mbplsda">testdim_mbplsda</a></code>
<code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical[,1:10], 
nutrition = nutrition[,1:10], omics = omics[,1:20]))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
bloYobs &lt;- 2
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 3)
resdim &lt;- testdim_mbplsda(object=modelembplsQ, nrepet = 30, threshold = 0.5, 
bloY=bloYobs, cpus=1, algo = c("max"), outputs = c("ER"))
plot_testdim_mbplsda(resdim, "plotTDim")

</code></pre>

<hr>
<h2 id='pred_mbplsda'>
Observed parameters and predicted categories from a multi-block partial least squares discriminant model
</h2><span id='topic+pred_mbplsda'></span>

<h3>Description</h3>

<p>Fonction to perform categories predictions from a multi-block partial least squares discriminant model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred_mbplsda(object, optdim , threshold = 0.5, bloY, 
algo = c("max", "gravity", "threshold"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pred_mbplsda_+3A_object">object</code></td>
<td>

<p>an object created by mbplsda
</p>
</td></tr>
<tr><td><code id="pred_mbplsda_+3A_optdim">optdim</code></td>
<td>

<p>integer indicating the (optimal) number of components of the multi-block partial least squares discriminant model
</p>
</td></tr>
<tr><td><code id="pred_mbplsda_+3A_threshold">threshold</code></td>
<td>

<p>numeric indicating the threshold, between 0 and 1, to consider the categories are predicted with the threshold prediction method.
</p>
</td></tr>
<tr><td><code id="pred_mbplsda_+3A_bloy">bloY</code></td>
<td>

<p>integer vector indicating the number of categories per variable of the Y-block.
</p>
</td></tr>
<tr><td><code id="pred_mbplsda_+3A_algo">algo</code></td>
<td>

<p>character vector indicating the method(s) of prediction to use (see details)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three different algorithms are available to predict the categories of observations.
In the max, and respectively the threshold algorithms, numeric values are calculated from the matrix of explanatory variables and the regression coefficients. Then, the predicted categorie for each variable of the Y-block is the one which corresponds to the higher predicted value, respectively to the values higher than the indicated threshold.
In the gravity algorithm, predicted scores of the observations on the components are calculated. Then, each observation is assigned to the observed category of which it is closest to the barycentre in the component space.
</p>


<h3>Value</h3>

<table>
<tr><td><code>XYcoef</code></td>
<td>
<p>list of matrices of the regression coefficients of the whole explanatory dataset onto the dependent dataset</p>
</td></tr>
<tr><td><code>VIPc</code></td>
<td>
<p>cumulated variable importances for a given number of dimensions</p>
</td></tr>
<tr><td><code>BIPc</code></td>
<td>
<p>cumulated block importances for a given number of dimensions</p>
</td></tr>
<tr><td><code>faX</code></td>
<td>
<p>matrix containing the global variable loadings associated with the global explanatory dataset</p>
</td></tr>
<tr><td><code>lX</code></td>
<td>
<p>matrix of the global components associated with the whole explanatory dataset(scores of the individuals)</p>
</td></tr>
<tr><td><code>ConfMat.ErrorRate</code></td>
<td>
<p>confidence matrix and prediction error rate per category</p>
</td></tr>
<tr><td><code>ErrorRate.global</code></td>
<td>
<p>confidence matrix and prediction error rate, per Y-block variable and overall</p>
</td></tr>
<tr><td><code>PredY.max</code></td>
<td>
<p>predictions and accuracy of predictions with the &quot;max&quot; algorithm</p>
</td></tr>
<tr><td><code>PredY.gravity</code></td>
<td>
<p>predictions and accuracy of predictions with the &quot;gravity&quot; algorithm</p>
</td></tr>
<tr><td><code>PredY.threshold</code></td>
<td>
<p>predictions and accuracy of predictions with the &quot;threshold&quot; algorithm</p>
</td></tr>
<tr><td><code>AUC</code></td>
<td>
<p>aera under ROC cuve value and 95% confidence interval, per category, per Y-block variable and overall</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mbplsda">mbplsda</a></code>
<code><a href="#topic+plot_pred_mbplsda">plot_pred_mbplsda</a></code>
<code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical, nutrition = nutrition, omics = omics))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
bloYobs &lt;- 2
ncpopt &lt;- 1
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 2)
predictions &lt;- pred_mbplsda(modelembplsQ, optdim = ncpopt, threshold = 0.5, bloY=bloYobs, 
algo = c("max", "gravity", "threshold"))
</code></pre>

<hr>
<h2 id='status'>physiopathological status data</h2><span id='topic+status'></span>

<h3>Description</h3>

<p>physiopathological status of men in a human cohort study</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("status")</code></pre>


<h3>Format</h3>

<p>A data frame with 40 observations on the following variable.
</p>

<dl>
<dt><code>status</code></dt><dd><p>a factor with levels <code>cas</code> <code>temoin</code></p>
</dd>
</dl>



<h3>Details</h3>

<p>no details are needed</p>


<h3>Source</h3>

<p>extract of data not yet published</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(status)
</code></pre>

<hr>
<h2 id='testdim_mbplsda'>
Test of number of components by two-fold cross-validation for a multi-block partial least squares discriminant model
</h2><span id='topic+testdim_mbplsda'></span>

<h3>Description</h3>

<p>Function to perform a two-fold cross-validation in order to select the optimal number of dimensions of a multi-block partial least squares discriminant model, according to the classification error rate or to the area under ROC curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testdim_mbplsda(object, nrepet = 100, algo = c("max", "gravity", "threshold"),
threshold = 0.5, bloY, outputs = c("ER", "ConfMat", "AUC"), cpus = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testdim_mbplsda_+3A_object">object</code></td>
<td>

<p>an object created by mbplsda_nfX
</p>
</td></tr>
<tr><td><code id="testdim_mbplsda_+3A_nrepet">nrepet</code></td>
<td>

<p>integer indicating the number of repetitions
</p>
</td></tr>
<tr><td><code id="testdim_mbplsda_+3A_algo">algo</code></td>
<td>

<p>character vector indicating the method(s) of prediction to use (see details)
</p>
</td></tr>
<tr><td><code id="testdim_mbplsda_+3A_threshold">threshold</code></td>
<td>

<p>numeric indicating the threshold, between 0 and 1, to consider the categories are predicted with the threshold prediction method.
</p>
</td></tr>
<tr><td><code id="testdim_mbplsda_+3A_bloy">bloY</code></td>
<td>

<p>integer vector indicating the number of categories per variable of the Y-block.
</p>
</td></tr>
<tr><td><code id="testdim_mbplsda_+3A_outputs">outputs</code></td>
<td>

<p>character vector indicating the wanted outputs (see details)
</p>
</td></tr>
<tr><td><code id="testdim_mbplsda_+3A_cpus">cpus</code></td>
<td>

<p>integer indicating the number of cpus to use when running the code in parallel
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three different algorithms are available to predict the categories of observations.
In the max, and respectively the threshold algorithms, numeric values are calculated from the matrix of explanatory variables and the regression coefficients. Then, the predicted categorie for each variable of the Y-block is the one which corresponds to the higher predicted value, respectively to the values higher than the indicated threshold.
In the gravity algorithm, predicted scores of the observations on the components are calculated. Then, each observation is assigned to the observed category of which it is closest to the barycentre in the component space.
</p>
<p>Available outputs are Error Rates (ER), Confusion Matrix (ConfMat), Aera Under Curve (AUC).
</p>


<h3>Value</h3>

<table>
<tr><td><code>TRUEnrepet</code></td>
<td>
<p>number of repetitions</p>
</td></tr>
<tr><td><code>TruePosC.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of percentages of true positive observations per category, evaluated on the calibration dataset, with the different algorithms (TPcM for &quot;max&quot;, TPcG for &quot;gravity&quot;, TPcT for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>TruePosV.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of percentages of true positive observations per category, evaluated on the validation dataset, with the different algorithms (TPvM for &quot;max&quot;, TPvG for &quot;gravity&quot;, TPvT for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>TrueNegC.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of percentages of true negative observations per category, evaluated on the calibration dataset, with the different algorithms (TNcM for &quot;max&quot;, TNcG for &quot;gravity&quot;, TNcT for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>TrueNegV.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of percentages of true negative observations per category, evaluated on the validation dataset, with the different algorithms (TNvM for &quot;max&quot;, TNvG for &quot;gravity&quot;, TNvT for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>FalsePosC.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of percentages of false positive observations per category, evaluated on the calibration dataset, with the different algorithms (FPcM for &quot;max&quot;, FPcG for &quot;gravity&quot;, FPcT for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>FalsePosV.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of percentages of false positive observations per category, evaluated on the validation dataset, with the different algorithms (FPvM for &quot;max&quot;, FPvG for &quot;gravity&quot;, FPvT for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>FalseNegC.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of percentages of false negative observations per category, evaluated on the calibration dataset, with the different algorithms (FNcM for &quot;max&quot;, FNcG for &quot;gravity&quot;, FNcT for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>FalseNegV.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of percentages of false negative observations per category, evaluated on the validation dataset, with the different algorithms (FNvM for &quot;max&quot;, FNvG for &quot;gravity&quot;, FNvT for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>ErrorRateC.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of prediction error rates per category, evaluated on the calibration dataset, with the different algorithms (ERcM for &quot;max&quot;, ERcG for &quot;gravity&quot;, ERcT for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>ErrorRateV.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of prediction error rates per category, evaluated on the validation dataset, with the different algorithms (ERvM for &quot;max&quot;, ERvG for &quot;gravity&quot;, ERvT for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>ErrorRateCglobal.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of global prediction error rates, evaluated on the calibration dataset, with the different algorithms (ERcM.global for &quot;max&quot;, ERcG.global for &quot;gravity&quot;, ERcT.global for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>ErrorRateVglobal.max</code>, <code>.gravity</code>, <code>.threshold</code></td>
<td>
<p>statistical description of global prediction error rates, evaluated on the validation dataset, with the different algorithms (ERvM.global for &quot;max&quot;, ERvG.global for &quot;gravity&quot;, ERvT.global for &quot;threshold&quot;), for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>AUCc</code></td>
<td>
<p>statistical description of aera under ROC curve values per category, evaluated on the calibration dataset, if all Y-block variables are binary, for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>AUCv</code></td>
<td>
<p>statistical description of aera under ROC curve values per category, evaluated on the validation dataset, if all Y-block variables are binary, for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>AUCc.global</code></td>
<td>
<p>statistical description of global aera under ROC curve values, evaluated on the calibration dataset, if all Y-block variables are binary, for a number of components ranging from 1 to its maximum value</p>
</td></tr>
<tr><td><code>AUCv.global</code></td>
<td>
<p>statistical description of global aera under ROC curve values, evaluated on the validation dataset, if all Y-block variables are binary, for a number of components ranging from 1 to its maximum value</p>
</td></tr>
</table>


<h3>Note</h3>

<p>at least 30 cross-validation repetitions may be recommended
</p>


<h3>Author(s)</h3>

<p>Marion Brandolini-Bunlon (&lt;marion.brandolini-bunlon@inra.fr&gt;) and Stephanie Bougeard (&lt;stephanie.bougeard@anses.fr&gt;)
</p>


<h3>References</h3>

<p>Stone, M. (1974). Cross-validatory choice and assessment of statistical predictions. Journal of the Royal Statistical Society B, 36(2), 111-147.
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at 12emes Journees Scientifiques RFMF, Clermont-Ferrand, FRA(05-21-2019 - 05-23-2019).
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2019). Multi-block PLS discriminant analysis for the joint analysis of metabolomic and epidemiological data. Metabolomics, 15(10):134
</p>
<p>Brandolini-Bunlon, M., Petera, M., Gaudreau, P., Comte, B., Bougeard, S., Pujos-Guillot, E.(2020). A new tool for multi-block PLS discriminant analysis of metabolomic data: application to systems epidemiology. Presented at Chimiometrie 2020, Liege, BEL(01-27-2020 - 01-29-2020).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mbplsda">mbplsda</a></code>
<code><a href="#topic+plot_testdim_mbplsda">plot_testdim_mbplsda</a></code>
<code><a href="#topic+packMBPLSDA-package">packMBPLSDA-package</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(status)
data(medical)
data(omics)
data(nutrition)
ktabX &lt;- ktab.list.df(list(medical = medical[,1:10], 
nutrition = nutrition[,1:10], omics = omics[,1:20]))
disjonctif &lt;- (disjunctive(status))
dudiY   &lt;- dudi.pca(disjonctif , center = FALSE, scale = FALSE, scannf = FALSE)
bloYobs &lt;- 2
modelembplsQ &lt;- mbplsda(dudiY, ktabX, scale = TRUE, option = "uniform", scannf = FALSE, nf = 3)
resdim &lt;- testdim_mbplsda(object = modelembplsQ, nrepet = 30, threshold = 0.5, 
bloY = bloYobs, cpus = 1, algo = c("max"), outputs = c("ER"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
