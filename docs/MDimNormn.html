<!DOCTYPE html><html><head><title>Help for package MDimNormn</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MDimNormn}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#normn MA'><p>Multi-dimensional MA normalization for plate effect</p></a></li>
<li><a href='#SBA'><p> Artificially generated data alike that of Suspension bead arrays</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Multi-Dimensional MA Normalization for Plate Effect</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Mun-Gwan Hong</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mun-Gwan Hong &lt;mun-gwan.hong@scilifelab.se&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Normalize data to minimize the difference between sample plates 
    (batch effects). For given data in a matrix and grouping variable (or
	plate), the function 'normn_MA' normalizes the data on MA coordinates. 
	More details are in the citation. The primary method is 'Multi-MA'. Other 
	fitting functions on MA coordinates can also be employed e.g. loess.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-08-12 08:26:32 UTC; mun-gwanhong</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-08-12 20:12:49</td>
</tr>
</table>
<hr>
<h2 id='normn+20MA'>Multi-dimensional MA normalization for plate effect</h2><span id='topic+normn_MA'></span>

<h3>Description</h3>

<p>Normalize data to minimize the difference among the subgroups of the samples generated by experimental factor such as multiple plates (batch effects)<br />
- the primary method is Multi-MA, but other fitting function, <em>f</em> in manuscript (e.g. loess) is available, too.<br />
This method is based on the assumptions stated below<br />
</p>

<ol>
<li><p> The geometric mean value of the samples in each subgroup (or plate) for a single target is ideally same as those from the other subgroups.
</p>
</li>
<li><p> The subgroup (or plate) effects that influence those mean values for multiple observed targets are dependent on the values themselves. (intensity dependent effects)
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>normn_MA(mD, expGroup, represent_FUN= function(x) mean(x, na.rm= T), 
        fitting_FUN= NULL, isLog= TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normn+2B20MA_+3A_md">mD</code></td>
<td>
<p> a <code>matrix</code> of measured values in which columns are the measured molecules and rows are samples </p>
</td></tr>
<tr><td><code id="normn+2B20MA_+3A_expgroup">expGroup</code></td>
<td>
<p> a <code>vector</code> of experimental grouping variable such as plate. The length of codeexpGroup must be same as the number of rows of <code>mD</code>.</p>
</td></tr>
<tr><td><code id="normn+2B20MA_+3A_represent_fun">represent_FUN</code></td>
<td>
<p> a <code>function</code> that computes representative values for each experimental group (e.g. plate). The default is mean ignoring any NA </p>
</td></tr>
<tr><td><code id="normn+2B20MA_+3A_fitting_fun">fitting_FUN</code></td>
<td>
 <p><code>NULL</code> or a <code>function</code> that fits to data in MA-coordinates. 
If it is <code>NULL</code> as the default, 'Multi-MA' method is employed. 
If a <code>function</code> is used, two arguments of <code>m_j</code> and <code>A</code> are required, which are <code class="reqn">\mathbf{m}_j</code> coordinate in <code class="reqn">M_d</code> and <code class="reqn">A</code> coordinate, respectively. </p>
</td></tr>
<tr><td><code id="normn+2B20MA_+3A_islog">isLog</code></td>
<td>
<p> TRUE or FALSE, if the normalization should be conducted after log-transformation. The affinity proteomics data from suspension bead arrays is recommended to be normalized using the default, <code>isLog = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The data after normalization in a <code>matrix</code>
</p>


<h3>Author(s)</h3>

<p>Mun-Gwan Hong &lt;<a href="mailto:mun-gwan.hong@scilifelab.se">mun-gwan.hong@scilifelab.se</a>&gt;</p>


<h3>References</h3>

<p>Hong M-G, Lee W, Pawitan Y, Schwenk JM (201?) 
Multi-dimensional normalization of plate effects for multiplexed applications
<em>unpublished</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sba)
B &lt;- normn_MA(sba$X, sba$plate)		# Multi-MA normalization

# MA-loess normalization
B &lt;- normn_MA(sba$X, sba$plate, fitting_FUN= function(m_j, A) loess(m_j ~ A)$fitted)

# weighted linear regression normalization
B &lt;- normn_MA(sba$X, sba$plate, fitting_FUN= function(m_j, A) {
	beta &lt;- lm(m_j ~ A, weights= 1/A)$coefficients
	beta[1] + beta[2] * A
})

# robust linear regression normalization
if(any(search() == "package:MASS")) {	# excutable only when MASS package was loaded.
	B &lt;- normn_MA(sba$X, sba$plate, fitting_FUN= function(m_j, A) {
		beta &lt;- rlm(m_j ~ A, maxit= 100)$coefficients
		beta[1] + beta[2] * A
	})
}
</code></pre>

<hr>
<h2 id='SBA'> Artificially generated data alike that of Suspension bead arrays</h2><span id='topic+sba'></span>

<h3>Description</h3>

<p>The data that has similarity to Suspension bead arrays data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sba)</code></pre>


<h3>Format</h3>

<p>A list that consists of <code>"plate"</code> which is a <code>factor</code> of plate number,
<code>"X"</code> that contains measured values where columns are targets and rows are samples (or observations).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sba)

# plot to check difference of geometric mean of every target between plates
sba_gm &lt;- by(sba$X, sba$plate, apply, 2, function(x) exp(mean(log(x))))	
par(mfrow= c(2, 3))
apply(combn(4, 2), 2, function(ea) {
	plot(sba_gm[[ea[1]]], sba_gm[[ea[2]]], xlab= names(sba_gm)[ea[1]], 
	     ylab= names(sba_gm)[ea[2]], log= "xy", asp= 1)
	abline(0, 1, col= "cadetblue")
})

# show first 10 observations in plate 1 and plate 2
print(sba$X[c(1:10, 97:106), 1:10])		

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
