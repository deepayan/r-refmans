<!DOCTYPE html><html lang="en"><head><title>Help for package ZIPBayes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ZIPBayes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ZIPBayes-package'>
<p>Bayesian Methods in Zero-inflated Poisson Model</p></a></li>
<li><a href='#datasim'><p>Toy example data - main study only</p></a></li>
<li><a href='#datasimExt'><p>Toy example data - main study and external validation study</p></a></li>
<li><a href='#datasimInt'><p>Toy example data - main study and internal validation study</p></a></li>
<li><a href='#summary.ZIPBayes'>
<p>Summarizing the trace output from the MCMC algorithm</p></a></li>
<li><a href='#ZIP'>
<p>zero-inflated Poisson model</p></a></li>
<li><a href='#ZIPExt'>
<p>Zero-inflated Poisson model under measurement error and external validation data are available</p></a></li>
<li><a href='#ZIPInt'>
<p>Zero-inflated Poisson model under measurement error and internal validation data are available</p></a></li>
<li><a href='#ZIPMErr'>
<p>Zero-inflated Poisson model with measurement error</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Methods in the Analysis of Zero-Inflated Poisson Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-09-27</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of zero-inflated Poisson models under Bayesian framework using data augmentation as discussed in Chapter 5 of Zhang (2020) <a href="https://hdl.handle.net/10012/16378">https://hdl.handle.net/10012/16378</a>. This package is constructed in accommodating four different scenarios: the general scenario, the scenario with measurement error in responses, the external validation scenario, and the internal validation scenario.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.11), MASS</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-24 20:11:53 UTC; qihua</td>
</tr>
<tr>
<td>Author:</td>
<td>Qihuang Zhang [aut, cre, cph],
  Grace Y. Yi [aut, ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Qihuang Zhang &lt;qihuang.zhang@uwaterloo.ca&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-25 06:30:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='ZIPBayes-package'>
Bayesian Methods in Zero-inflated Poisson Model
</h2><span id='topic+ZIPBayes-package'></span><span id='topic+ZIPBayes'></span>

<h3>Description</h3>

<p>Implementation of zero-inflated Poisson (ZIP) model in Bayesian methods with data augmentation strategy. The R package is general to different scenarios, including an ordinary scenario for zero-inflated Poisson Model, the scenario with measurement error in response, the scenario with internal or external validation data available.
</p>


<h3>Details</h3>

<p>This package implemented the zero-inflated Poisson model based on a Bayesian framework. The method is implemented with a Monte Carlo Markov Chain (MCMC) approach with a data augmentation strategy. The package is integrated with C++ to improve the computing speed. It mainly contains four main functions. The function ZIPBayes corresponds to ordinary zero-inflated count data and no measurement error is considered. The function ZIPBayes_MErr considers the case where the response is subject to measurement error as a model by Qihuang Zhang (2020). The function ZIPBayes_Int and ZIPBayes_Ext are corresponding to the case where the internal or external validation data are available, respectively. Other helper functions are also contained in this packages, such as summarizing the trace from the MCMC algorithm, plotting the trace plot, etc.
</p>


<h3>Author(s)</h3>

<p>Qihuang Zhang and Grace Y. Yi.
</p>
<p>Maintainer: Qihuang Zhang &lt;qihuang.zhang@uwaterloo.ca&gt;
</p>

<hr>
<h2 id='datasim'>Toy example data - main study only</h2><span id='topic+datasim'></span>

<h3>Description</h3>

<p>This data set gives an example data for the illustration of usage of <code><a href="#topic+ZIP">ZIP</a></code> and <code><a href="#topic+ZIPMErr">ZIPMErr</a></code> function. The dataset contains naivedata and the design matrices for the response model, measurement error model.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(datasim)
</code></pre>


<h3>Format</h3>

<p>A data.frame of 6 columns. &ldquo;Ystar&rdquo; refers to the error-prone response. &ldquo;Y&rdquo; refers to the true count response. &quot;X1&quot; and &quot;X2&quot; are covariates in the response model. &ldquo;Xplus&rdquo; and &ldquo;Xminus&rdquo; are the covariates for the measurement error model. </p>

<hr>
<h2 id='datasimExt'>Toy example data - main study and external validation study</h2><span id='topic+datasimExt'></span>

<h3>Description</h3>

<p>This data set gives an example data for the illustration of usage of <code><a href="#topic+ZIPExt">ZIPExt</a></code> function. The dataset contains a list of main data and external validation data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(datasimExt)
</code></pre>


<h3>Format</h3>

<p>A list of two data.frames. The first data.frame, named &ldquo;main&rdquo;, corresponds to the main data with 6 columns. Same as the <code><a href="#topic+datasim">datasim</a></code>, &ldquo;Ystar&rdquo; refers to the error-prone response. &ldquo;Y&rdquo; refers to the true count response. &quot;X1&quot; and &quot;X2&quot; are covariates in the response model. &ldquo;Zplus&rdquo; and &ldquo;Zplus&rdquo; are the covariates for the measurement error model. The second data.frame corresponds to the validation data with 5 columns. </p>

<hr>
<h2 id='datasimInt'>Toy example data - main study and internal validation study</h2><span id='topic+datasimInt'></span>

<h3>Description</h3>

<p>This data set gives an example data for the illustration of usage of <code><a href="#topic+ZIPInt">ZIPInt</a></code> function. The dataset contains a list of main data and internal validation data. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(datasimInt)
</code></pre>


<h3>Format</h3>

<p>A list of two data.frames. The first data.frame, named &ldquo;main&rdquo;, corresponds to the main data with 6 columns. Same as the <code><a href="#topic+datasim">datasim</a></code>, &ldquo;Ystar&rdquo; refers to the error-prone response. &ldquo;Y&rdquo; refers to the true count response. &ldquo;X1&rdquo; and &ldquo;X2&rdquo; are covariates in the response model. &ldquo;Zplus&rdquo; and &ldquo;Zplus&rdquo; are the covariates for the measurement error model. The second data.frame corresponds to the validation data with 7 columns. </p>

<hr>
<h2 id='summary.ZIPBayes'>
Summarizing the trace output from the MCMC algorithm
</h2><span id='topic+summary.ZIPBayes'></span>

<h3>Description</h3>

<p>This function is a method for <code>ZIPBayes</code> object. It summarize the trace output from the main functions into interesting summary statistics, such as mean, median, confidence interval, and highest density region (HDR),
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ZIPBayes'

## S3 method for class 'ZIPBayes'
summary(object, burnin = 1, thinperiod = 1, confidence.level = 0.95, ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.ZIPBayes_+3A_object">object</code></td>
<td>

<p>the &ldquo;ZIPBayes&rdquo; object gotten from the main function.</p>
</td></tr>
<tr><td><code id="summary.ZIPBayes_+3A_burnin">burnin</code></td>
<td>

<p>the number of records to be discarded as the early period of MCMC algorithm. Default is 1, meaning the first data point will be discarded when calculating the summary statistics.  
</p>
</td></tr>
<tr><td><code id="summary.ZIPBayes_+3A_thinperiod">thinperiod</code></td>
<td>

<p>the number of period in the thining periord. The results will be picked every this number. Default is 1, meaning no thining will be done. See details.
</p>
</td></tr>
<tr><td><code id="summary.ZIPBayes_+3A_confidence.level">confidence.level</code></td>
<td>

<p>the confidence level for the constructed confidence interval. Default is 0.95.
</p>
</td></tr>
<tr><td><code id="summary.ZIPBayes_+3A_...">...</code></td>
<td>

<p>other arguments passed to the function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function summarizes the tracing results produced by <code><a href="#topic+ZIP">ZIP</a></code>, <code><a href="#topic+ZIPMErr">ZIPMErr</a></code>, <code><a href="#topic+ZIPExt">ZIPExt</a></code>, and <code><a href="#topic+ZIPInt">ZIPInt</a></code>.
To diminish the influence of the starting values, we generally discard the first portion of each sequence and focus attention on the remaining. The argument <code>burnin</code> is set to control the number of steps to be discarded.
</p>
<p>Another issue that sometimes arises, once approximate convergence has been reached, is whether to thin the sequences by keeping every <code class="reqn">k</code>-th simulation draw from each sequence  and discarding the rest. The argument <code>thinperiod</code> is used to set <code class="reqn">k</code> here.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>ZIPBayes</code></td>
<td>
<p>a list of summary for each data set. &quot;HDR_LB&quot; and &quot;HDR_UB&quot; respectively respresents the lower and upper bound of the high density region.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qihuang Zhang and Grace Y. Yi.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ZIP">ZIP</a></code>, <code><a href="#topic+ZIPMErr">ZIPMErr</a></code>, <code><a href="#topic+ZIPExt">ZIPExt</a></code>, <code><a href="#topic+ZIPInt">ZIPInt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Please see the example in ZIP() function
</code></pre>

<hr>
<h2 id='ZIP'>
zero-inflated Poisson model
</h2><span id='topic+ZIP'></span>

<h3>Description</h3>

<p>The function implements the MCMC algorithm with data augmentation to estimate the parameters in the zero-inflated Poisson model. The function returns the trace of the sampled parameters in each interaction. To obtain the summary estimation, use <code>summary</code>().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ZIP(Y, Covarmainphi, Covarmainmu, 
                         betaphi, betamu, 
                         priorgamma, 
                         propsigmaphi,  propsigmamu = propsigmaphi,
                         seed = 1, nmcmc = 500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ZIP_+3A_y">Y</code></td>
<td>

<p>a count vector of length <code class="reqn">n</code> specifying response in the zero-inflated Poisson model.
</p>
</td></tr>
<tr><td><code id="ZIP_+3A_covarmainphi">Covarmainphi</code></td>
<td>

<p>a <code class="reqn">n \times p_1</code> dimensional data.frame or matrix of  data with respect to the probability component of the zero-inflated Poisson model. 
</p>
</td></tr>
<tr><td><code id="ZIP_+3A_covarmainmu">Covarmainmu</code></td>
<td>

<p>a <code class="reqn">n \times p_2</code> dimensional data.frame or matrix of  data with respect to the mean component of the zero-inflated Poisson model. 
</p>
</td></tr>
<tr><td><code id="ZIP_+3A_betaphi">betaphi</code></td>
<td>

<p>a vector of length <code class="reqn">p_1</code> specifying the initial values of the parameters in the probability component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIP_+3A_betamu">betamu</code></td>
<td>

<p>a vector of length <code class="reqn">p_2</code> specifying the initial values of the parameters in the probability component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIP_+3A_priorgamma">priorgamma</code></td>
<td>

<p>a vector of length <code class="reqn">2</code> specifying the two parameters of gamma prior
</p>
</td></tr>
<tr><td><code id="ZIP_+3A_propsigmaphi">propsigmaphi</code></td>
<td>

<p>a vector of length <code class="reqn">p_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the probability component. 
</p>
</td></tr>
<tr><td><code id="ZIP_+3A_propsigmamu">propsigmamu</code></td>
<td>

<p>a vector of length <code class="reqn">p_2</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the mean component. 
</p>
</td></tr>
<tr><td><code id="ZIP_+3A_seed">seed</code></td>
<td>

<p>a numeric value specifying the seed for random generator
</p>
</td></tr>
<tr><td><code id="ZIP_+3A_nmcmc">nmcmc</code></td>
<td>

<p>a integer specify the number of the generation of MCMC algorithm
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The zero-inflated Poisson model involves two components, the probability components and the mean compoenents (Zhang, 2020). Argument <code>Covarmainphi</code>, <code>betaphi</code>, <code>propsigmaphi</code> correspond to the probability compoenent; <code>Covarmainmu</code>, <code>betamu</code>, <code>propsigmamu</code> correspond to the mean compoenent.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>BayesResults</code></td>
<td>
<p>the list of trace of generated parameters for each component of the models. Data.frame &quot;betaphi_trace&quot; corresponds to the probability component of ZIP response model; &quot;betamu_trace&quot; refers to the mean component of the ZIP response model. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qihuang Zhang and Grace Y. Yi
</p>


<h3>References</h3>

<p>Zhang, Qihuang. &quot;Inference Methods for Noisy Correlated Responses with Measurement Error.&quot; (2020).</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datasim)
set.seed(0)
example_ZIP &lt;- ZIP( Y = datasim$Ystar,
                         Covarmainphi = datasim[,c("intercept","X1")],
                         Covarmainmu = datasim[,c("intercept","X2")],
                         betaphi = c(-0.7,0.7), betamu = c(1,-0.5),
                         priorgamma = rep(1,1), propsigmaphi = c(0.05,0.05),
                         nmcmc = 100)

summary(example_ZIP)
</code></pre>

<hr>
<h2 id='ZIPExt'>
Zero-inflated Poisson model under measurement error and external validation data are available
</h2><span id='topic+ZIPExt'></span>

<h3>Description</h3>

<p>The function implements the MCMC algorithm with data augmentation to estimate the parameters in the zero-inflated Poisson model while correcting for the measurement error arising from the responses. The function returns the trace of the sampled parameters in each interaction. To obtain the summary estimation, use <code>summary</code>().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ZIPExt (Ystar, Covarmainphi, Covarmainmu, Covarplus, Covarminus,
           Ystarval, Yval, Covarvalplus, Covarvalminus,
           betaphi, betamu, alphaplus, alphaminus,
           Uibound = c(7,11),
           priorgamma, priormu, priorSigma, 
           propsigmaphi,  propsigmamu = propsigmaphi, 
           propsigmaplus = propsigmaphi, propsigmaminus = propsigmaphi,
           seed = 1, nmcmc = 500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ZIPExt_+3A_ystar">Ystar</code></td>
<td>

<p>a count vector of length <code class="reqn">n</code> specifying the error-prone response in the zero-inflated Poisson model.
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_covarmainphi">Covarmainphi</code></td>
<td>

<p>a <code class="reqn">n \times p_1</code> dimensional data.frame or matrix of the covariate data with respect to the probability component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_covarmainmu">Covarmainmu</code></td>
<td>

<p>a <code class="reqn">n \times p_2</code> dimensional data.frame or matrix of the covariate data with respect to the mean component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_covarplus">Covarplus</code></td>
<td>

<p>a <code class="reqn">n \times q_1</code> dimensional data.frame or matrix of the covariate data for the measurement error model of the add-in error process
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_covarminus">Covarminus</code></td>
<td>

<p>a <code class="reqn">n \times q_2</code> dimensional data.frame or matrix of the covariate data for the measurement error model of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_ystarval">Ystarval</code></td>
<td>

<p>a count vector of length <code class="reqn">m</code> specifying the  error-prone response in the validation data.
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_yval">Yval</code></td>
<td>

<p>a count vector of length <code class="reqn">m</code> specifying the precisely measured response in the validation data.
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_covarvalplus">Covarvalplus</code></td>
<td>

<p>a <code class="reqn">m \times q_1</code> dimensional data.frame or matrix of the covariate for validation data of the add-in error process
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_covarvalminus">Covarvalminus</code></td>
<td>

<p>a <code class="reqn">m \times q_2</code> dimensional data.frame or matrix of the covariate  for validation data of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_betaphi">betaphi</code></td>
<td>

<p>a vector of length <code class="reqn">p_1</code> specifying the initial values of the parameters in the probability component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_betamu">betamu</code></td>
<td>

<p>a vector of length <code class="reqn">p_2</code> specifying the initial values of the parameters in the probability component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_alphaplus">alphaplus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the initial values of the parameters for the measurement error model of the add-in error process
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_alphaminus">alphaminus</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the initial values of the parameters in the probability component of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_uibound">Uibound</code></td>
<td>

<p>a vector of length <code class="reqn">2</code> specifying the maximum number of the count in the inverse sampling method
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_priorgamma">priorgamma</code></td>
<td>

<p>a vector of length <code class="reqn">2</code> specifying the two parameters of gamma prior
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_priormu">priormu</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the mean vector of the normal prior for the measurement error model of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_priorsigma">priorSigma</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the standard erros of the normal prior for the measurement error model of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_propsigmaphi">propsigmaphi</code></td>
<td>

<p>a vector of length <code class="reqn">p_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the probability component. 
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_propsigmamu">propsigmamu</code></td>
<td>

<p>a vector of length <code class="reqn">p_2</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the mean component. 
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_propsigmaplus">propsigmaplus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the add-in error process. 
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_propsigmaminus">propsigmaminus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the leave-out error process. 
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_seed">seed</code></td>
<td>

<p>a numeric value specifying the seed for random generator
</p>
</td></tr>
<tr><td><code id="ZIPExt_+3A_nmcmc">nmcmc</code></td>
<td>

<p>a integer specify the number of the generation of MCMC algorithm
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Comparing to the ZIPMErr function, this function has an addition component &ndash; validation data. Here, the argument &ldquo;Ystarval&rdquo;, &ldquo;Yval&rdquo;, &ldquo;Covarvalplus&rdquo;, &ldquo;Covarvalminus&rdquo;, are new for the sceanrio with external validation.  
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>BayesResults</code></td>
<td>
<p>the list of trace of generated parameters for each component of the models. Data frame &ldquo;betaphi_trace&rdquo; corresponds to the probability component of ZIP response model; &ldquo;betamu_trace&rdquo; refers to the mean component of the ZIP response model. Data frames &ldquo;alphaplus_trace&rdquo; and &ldquo;alphaminus_trace&rdquo;, respectively, correspond to the add-in error and leave-out error process in the measruement error model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qihuang Zhang and Grace Y. Yi
</p>


<h3>References</h3>

<p>Zhang, Qihuang. &ldquo;Inference Methods for Noisy Correlated Responses with Measurement Error.&rdquo; (2020).</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data
data(datasimExt)
set.seed(0)
example_ZIP_Ext &lt;-  ZIPExt (Ystar = datasimExt$main$Ystar,
                            Covarmainphi = datasimExt$main[,c("intercept","X1")],
                            Covarmainmu = datasimExt$main[,c("intercept","X2")],
                            Covarplus = datasimExt$main[,c("intercept","Zplus")],
                            Covarminus = datasimExt$main[,c("intercept","Zminus")],
                            Ystarval = datasimExt$validation$Ystar, 
                            Yval = datasimExt$validation$Y,
                            Covarvalplus = datasimExt$validation[,3:4],
                            Covarvalminus = datasimExt$validation[,3:4],
                            betaphi = c(0.7,-0.7), betamu = c(1,-1.5), 
                            alphaplus = c(0,0), alphaminus=c(0,0),
                            priorgamma = c(0.001,0.001), priormu = c(0,0),
                            priorSigma = c(1,1), propsigmaphi = c(0.05,0.05), 
                            nmcmc = 10) 

summary(example_ZIP_Ext)
</code></pre>

<hr>
<h2 id='ZIPInt'>
Zero-inflated Poisson model under measurement error and internal validation data are available
</h2><span id='topic+ZIPInt'></span>

<h3>Description</h3>

<p>The function implements the MCMC algorithm with data augmentation to estimate the parameters in the zero-inflated Poisson model while correcting for the measurement error arising from the responses. The function returns the trace of the sampled parameters in each interaction. To obtain the summary estimation, use <code>summary</code>().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ZIPInt (Ystar, Covarmainphi, Covarmainmu, Covarplus, Covarminus,
       Ystarval, Yval, Covarvalmainphi, Covarvalmainmu, Covarvalplus, Covarvalminus,
       betaphi, betamu, alphaplus, alphaminus,
       Uibound = c(7,11),
       priorgamma, priormu, priorSigma, 
       propsigmaphi,  propsigmamu = propsigmaphi, 
            propsigmaplus = propsigmaphi,  propsigmaminus = propsigmaphi,
       seed = 1, nmcmc = 500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ZIPInt_+3A_ystar">Ystar</code></td>
<td>

<p>a count vector of length <code class="reqn">n</code> specifying the error-prone response in the zero-inflated Poisson model.
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_covarmainphi">Covarmainphi</code></td>
<td>

<p>a <code class="reqn">n \times p_1</code> dimensional data.frame or matrix of the covariate data with respect to the probability component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_covarmainmu">Covarmainmu</code></td>
<td>

<p>a <code class="reqn">n \times p_2</code> dimensional data.frame or matrix of the covariate data with respect to the mean component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_covarplus">Covarplus</code></td>
<td>

<p>a <code class="reqn">n \times q_1</code> dimensional data.frame or matrix of the covariate data for the measurement error model of the add-in error process
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_covarminus">Covarminus</code></td>
<td>

<p>a <code class="reqn">n \times q_2</code> dimensional data.frame or matrix of the covariate data for the measurement error model of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_ystarval">Ystarval</code></td>
<td>

<p>a count vector of length <code class="reqn">m</code> specifying the  error-prone response in the validation data.
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_yval">Yval</code></td>
<td>

<p>a count vector of length <code class="reqn">m</code> specifying the precisely measured response in the validation data.
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_covarvalmainphi">Covarvalmainphi</code></td>
<td>

<p>a <code class="reqn">m \times p_1</code> dimensional data.frame or matrix of the covariate for validation data with respect to the probability component of ZIP model
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_covarvalmainmu">Covarvalmainmu</code></td>
<td>

<p>a <code class="reqn">m \times p_2</code> dimensional data.frame or matrix of the covariate for validation data with respect to the mean component of ZIP model
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_covarvalplus">Covarvalplus</code></td>
<td>

<p>a <code class="reqn">m \times q_1</code> dimensional data.frame or matrix of the covariate for validation data of the add-in error process
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_covarvalminus">Covarvalminus</code></td>
<td>

<p>a <code class="reqn">m \times q_2</code> dimensional data.frame or matrix of the covariate  for validation data of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_betaphi">betaphi</code></td>
<td>

<p>a vector of length <code class="reqn">p_1</code> specifying the initial values of the parameters in the probability component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_betamu">betamu</code></td>
<td>

<p>a vector of length <code class="reqn">p_2</code> specifying the initial values of the parameters in the probability component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_alphaplus">alphaplus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the initial values of the parameters for the measurement error model of the add-in error process
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_alphaminus">alphaminus</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the initial values of the parameters in the probability component of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_uibound">Uibound</code></td>
<td>

<p>a vector of length <code class="reqn">2</code> specifying the maximum number of the count in the inverse sampling method
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_priorgamma">priorgamma</code></td>
<td>

<p>a vector of length <code class="reqn">2</code> specifying the two parameters of gamma prior
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_priormu">priormu</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the mean vector of the normal prior for the measurement error model of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_priorsigma">priorSigma</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the standard erros of the normal prior for the measurement error model of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_propsigmaphi">propsigmaphi</code></td>
<td>

<p>a vector of length <code class="reqn">p_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the probability component. 
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_propsigmamu">propsigmamu</code></td>
<td>

<p>a vector of length <code class="reqn">p_2</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the mean component. 
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_propsigmaplus">propsigmaplus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the add-in error process. 
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_propsigmaminus">propsigmaminus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the leave-out error process. 
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_seed">seed</code></td>
<td>

<p>a numeric value specifying the seed for random generator
</p>
</td></tr>
<tr><td><code id="ZIPInt_+3A_nmcmc">nmcmc</code></td>
<td>

<p>a integer specify the number of the generation of MCMC algorithm
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Comparing to the ZIPExt function for the external validation study, this function has an addition component &ndash; covariates of response model in the validation data. Here, the argument &ldquo;Covarvalmainphi&rdquo; and &ldquo;Covarvalmainmu&rdquo; are new for the sceanrio with external validation.  
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>BayesResults</code></td>
<td>
<p>the list of trace of generated parameters for each component of the models. Data frame &quot;betaphi_trace&quot; corresponds to the probability component of ZIP response model; &quot;betamu_trace&quot; refers to the mean component of the ZIP response model. Data frames &quot;alphaplus_trace&quot; and &quot;alphaminus_trace&quot;, respectively, correspond to the add-in error and leave-out error process in the measruement error model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qihuang Zhang and Grace Y. Yi
</p>


<h3>References</h3>

<p>Zhang, Qihuang. &quot;Inference Methods for Noisy Correlated Responses with Measurement Error.&quot; (2020).</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(datasimInt)
set.seed(0)
result &lt;-  ZIPInt(Ystar = datasimInt$main$Ystar,
                  Covarmainphi = datasimInt$main[,c("intercept","X1")],
                  Covarmainmu = datasimInt$main[,c("intercept","X2")],
                  Covarplus = datasimInt$main[,c("intercept", "Zplus")],
                  Covarminus = datasimInt$main[,c("intercept", "Zminus")],
                  Ystarval = datasimInt$val$Ystar,
                  Yval = datasimInt$val$Y,
                  Covarvalmainphi = datasimInt$val[,c("intercept","X1")],
                  Covarvalmainmu = datasimInt$val[,c("intercept","X2")],
                  Covarvalplus = datasimInt$val[,c("intercept", "Zplus")],
                  Covarvalminus = datasimInt$val[,c("intercept", "Zminus")],
                  betamu =  c(-0.5,0.5), betaphi = c(0.5,0),
                  alphaplus = c(0,0), alphaminus= c(0,0),
                  priorgamma = c(1,1), priormu = c(0,0), priorSigma = c(1,1), 
                     propsigmaphi = c(0.05,0.05), nmcmc = 10)
                     
summary(result)
</code></pre>

<hr>
<h2 id='ZIPMErr'>
Zero-inflated Poisson model with measurement error
</h2><span id='topic+ZIPMErr'></span>

<h3>Description</h3>

<p>The function implements the MCMC algorithm with data augmentation to estimate the parameters in the zero-inflated Poisson model while correcting for the measurement error arising from the responses. The function returns the trace of the sampled parameters in each iteraction. To obtain the summary estimation, use <code>summary</code>().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ZIPMErr (Ystar, Covarmainphi, Covarmainmu, Covarplus, Covarminus,
        betaphi, betamu, alphaplus, alphaminus,
        Uibound = c(7,11),
        priorgamma, priormu, priorSigma, propsigmaphi,  propsigmamu = propsigmaphi,
        propsigmaplus = propsigmaphi,  propsigmaminus = propsigmaphi, 
        seed = 1, nmcmc = 500)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ZIPMErr_+3A_ystar">Ystar</code></td>
<td>

<p>a count vector of length <code class="reqn">n</code> specifying the error-prone response in the zero-inflated Poisson model.
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_covarmainphi">Covarmainphi</code></td>
<td>

<p>a <code class="reqn">n \times p_1</code> dimensional data.frame or matrix of the covariate data with respect to the probability component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_covarmainmu">Covarmainmu</code></td>
<td>

<p>a <code class="reqn">n \times p_2</code> dimensional data.frame or matrix of the covariate data with respect to the mean component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_covarplus">Covarplus</code></td>
<td>

<p>a <code class="reqn">n \times q_1</code> dimensional data.frame or matrix of the covariate data for the measurement error model of the add-in error process
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_covarminus">Covarminus</code></td>
<td>

<p>a <code class="reqn">n \times q_1</code> dimensional data.frame or matrix of the covariate data for the measurement error model of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_betaphi">betaphi</code></td>
<td>

<p>a vector of length <code class="reqn">p_1</code> specifying the initial values of the parameters in the probability component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_betamu">betamu</code></td>
<td>

<p>a vector of length <code class="reqn">p_2</code> specifying the initial values of the parameters in the probability component of the zero-inflated Poisson model
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_alphaplus">alphaplus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the initial values of the parameters for the measurement error model of the add-in error process
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_alphaminus">alphaminus</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the initial values of the parameters in the probability component of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_uibound">Uibound</code></td>
<td>

<p>a vector of length <code class="reqn">2</code> specifying the maximum number of the count in the inverse sampling method
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_priorgamma">priorgamma</code></td>
<td>

<p>a vector of length <code class="reqn">2</code> specifying the two parameters of gamma prior
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_priormu">priormu</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the mean vector of the normal prior for the measurement error model of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_priorsigma">priorSigma</code></td>
<td>

<p>a vector of length <code class="reqn">q_2</code> specifying the standard erros of the normal prior for the measurement error model of the leave-out error process
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_propsigmaphi">propsigmaphi</code></td>
<td>

<p>a vector of length <code class="reqn">p_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the probability component. 
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_propsigmamu">propsigmamu</code></td>
<td>

<p>a vector of length <code class="reqn">p_2</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the mean component. 
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_propsigmaplus">propsigmaplus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the add-in error process. 
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_propsigmaminus">propsigmaminus</code></td>
<td>

<p>a vector of length <code class="reqn">q_1</code> specifying the standard error of the Gaussian proposal distribution for the parameters corresponds to the leave-out error process. 
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_seed">seed</code></td>
<td>

<p>a numeric value specifying the seed for random generator
</p>
</td></tr>
<tr><td><code id="ZIPMErr_+3A_nmcmc">nmcmc</code></td>
<td>

<p>a integer specify the number of the generation of MCMC algorithm
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The zero-inflated Poisson model involves two components, the probability components and the mean compoenents (Zhang, 2020). Although there are might arugments involved in the functions, they can be summarized to four sources in the model. The response model (zero-inflated Poisson model) involves two components: the probability component and the mean count component. The measurement error models contains two process: the add-in process and leave-out process. The arguements end with &quot;-phi&quot; corresponds to the probability component of the response model. The arguements end with &quot;-mu&quot; corresponds to the mean component of the response model.  The arguements end with &quot;-plus&quot; corresponds to the add-in error process in the measurment error model.  The arguements end with &quot;-minus&quot; corresponds to the leave-out process of the measurement error model. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>BayesResults</code></td>
<td>
<p>the list of trace of generated parameters for each component of the models. Data frame &quot;betaphi_trace&quot; corresponds to the probability component of ZIP response model; &quot;betamu_trace&quot; refers to the mean component of the ZIP response model. Data frames &quot;alphaplus_trace&quot; and &quot;alphaminus_trace&quot;, respectively, correspond to the add-in error and leave-out error process in the measruement error model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qihuang Zhang and Grace Y. Yi
</p>


<h3>References</h3>

<p>Zhang, Qihuang. &quot;Inference Methods for Noisy Correlated Responses with Measurement Error.&quot; (2020).</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data
data(datasim)
set.seed(0)
example_ZIP_MErr &lt;-  ZIPMErr (Ystar = datasim$Ystar,
                         Covarmainphi = datasim[,c("intercept","X1")],
                         Covarmainmu = datasim[,c("intercept","X2")],
                         Covarplus = datasim[,c("intercept","Xplus")],
                         Covarminus = datasim[,c("intercept","Xminus")],
                         betaphi = c(0.7,-0.7), betamu = c(1,-1.5), 
                         alphaplus = c(0,0), alphaminus=c(0,0),
                         priorgamma = c(0.001,0.001), priormu = c(0,0),
                         priorSigma = c(1,1), propsigmaphi = c(0.05,0.05), 
                         nmcmc = 10) 

summary(example_ZIP_MErr)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
