<!DOCTYPE html><html><head><title>Help for package SlaPMEG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SlaPMEG}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#multslapmeg'><p>Testing multiple pathways using SLaPMEG (shared latent process mixed effects model and Globaltest) for</p>
longitudinal Omics data</a></li>
<li><a href='#pairsetinval'><p>Estimating initial values for paired slapmeg based on seperate lme models</p></a></li>
<li><a href='#pairslapmeg'><p>Testing pathways using SLaPMEG (shared latent process mixed effects model and Globaltest) for</p>
longitudinal Omics data based on pairwise estimation approach (a computational solution for
latrge pathways)</a></li>
<li><a href='#plotslapmeg'><p>Plot the estimated random effects from SLaPMEG seperated for the study groups</p></a></li>
<li><a href='#print.mslapmeg'><p>Print objects from <code>multslapmeg</code></p></a></li>
<li><a href='#print.slapmeg'><p>Print objects from <code>slapmeg</code></p></a></li>
<li><a href='#setinval'><p>Estimating initial values for slapmeg based on seperate lme models</p></a></li>
<li><a href='#simslapmeg'><p>Simulate longitudinal data based on a shared latent process mixed effects model (SlaPMEG)</p></a></li>
<li><a href='#slapGT'><p>Run step II via globaltest package</p></a></li>
<li><a href='#slapmeg'><p>Testing pathways using SLaPMEG (shared latent process mixed effects model and Globaltest) for</p>
longitudinal Omics data</a></li>
<li><a href='#summary.mslapmeg'><p>Summary of  <code>slapmeg</code> objects</p></a></li>
<li><a href='#summary.slapmeg'><p>Summary of  <code>slapmeg</code> objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Pathway Testing for Longitudinal Omics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Mitra Ebrahimpoor</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mitra Ebrahimpoor &lt;mitra.ebrahimpoor@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A self-contained hypothesis is tested for a given pathway of longitudinal omics. 'SlaPMEG' is a two-step procedure. First, a shared latent process mixed model is fitted over the longitudinal measures of omics in a pathway. This shared model allows deviation from the shared process at subject level (a random intercept, slope, or both per subject) and also at omic level (a random effect per omic). These random effects summarize the longitudinal trend of the observations which can be used to test for group differences using 'Globaltest' in the second step. If the pathway is large or the shared effect is small, the package fits a series of pairwise models and estimates the shared random effects based on them.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-07-05</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>lme4 (&ge; 1.1.21), lcmm (&ge; 1.8.1), globaltest (&ge; 5.36.0),
magic (&ge; 1.5.9), reshape2 (&ge; 1.4.3), ggplot2 (&ge; 3.2.1),
mvtnorm</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-07-05 10:12:00 UTC; mebrahimpoor</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-07-05 15:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='multslapmeg'>Testing multiple pathways using SLaPMEG (shared latent process mixed effects model and Globaltest) for
longitudinal Omics data</h2><span id='topic+multslapmeg'></span>

<h3>Description</h3>

<p>Run slapmeg simultaneously for several pathways. For each pathway a p-value is calculated based
on SLaPMEG prodcedure as in <code><a href="#topic+multslapmeg">multslapmeg</a></code>.
Then the p-values are adjusted for multiple comparisons based on the selected procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multslapmeg(pathlist, fixed, random, grouping, subject, method = "BH", data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multslapmeg_+3A_pathlist">pathlist</code></td>
<td>
<p>A list of pathways to be tested.</p>
</td></tr>
<tr><td><code id="multslapmeg_+3A_fixed">fixed</code></td>
<td>
<p>A one-sided linear formula object for specifying the
fixed-effects in the linear mixed model at the latent process level that
starts with the <code>~</code> sign.</p>
</td></tr>
<tr><td><code id="multslapmeg_+3A_random">random</code></td>
<td>
<p>A one-sided formula for the random-effects in the
latent process mixed model and starts with the <code>~</code> sign. At least one random
effect should be included. Covariates with a random-effect are separated
by <code>+</code>.</p>
</td></tr>
<tr><td><code id="multslapmeg_+3A_grouping">grouping</code></td>
<td>
<p>name of the covariate representing the grouping structure.</p>
</td></tr>
<tr><td><code id="multslapmeg_+3A_subject">subject</code></td>
<td>
<p>name of the covariate representing the repeated measures structure such as subject IDs.</p>
</td></tr>
<tr><td><code id="multslapmeg_+3A_method">method</code></td>
<td>
<p>Correction method for p-values, the default is &quot;BH&quot;. For more methods see<code>?p.adjust</code>.</p>
</td></tr>
<tr><td><code id="multslapmeg_+3A_data">data</code></td>
<td>
<p>data frame containing the variables named in list of <code>pathlist</code>, <code>fixed</code>,
<code>random</code>, <code>grouping</code> and <code>subject</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A datafram including the name of pathways and corresponding adjusted p-values.
</p>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>
<p><a href="mailto:m.ebrahimpoor@lumc.nl">m.ebrahimpoor@lumc.nl</a>
</p>


<h3>References</h3>

<p>Ebrahimpoor, Mitra, Pietro Spitali, Jelle J. Goeman, and Roula Tsonaka. &quot;Pathway testing for longitudinal metabolomics.&quot; Statistics in Medicine (2021).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+slapmeg">slapmeg</a></code>, <code><a href="#topic+pairslapmeg">pairslapmeg</a></code>, <code><a href="#topic+plotslapmeg">plotslapmeg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# simulate data with 20 omics
testdata&lt;-simslapmeg(nY=20, ntime=5, nsubj = 30, seed=123)
head(testdata)

# creat a list of 3 random pathways of different sizes
pathlist&lt;-list(path1=sample(colnames(testdata)[-c(1:3)],5),
              path2=sample(colnames(testdata)[-c(1:3)],11),
              path3=sample(colnames(testdata)[-c(1:3)],9) )


#use mult slampmeg to get test for the differential expression of all pathways
#and get adjusted p-values
mfit&lt;- multslapmeg(pathlist, ~time, ~1+time, grouping="group", subject="ID", data=testdata)
summary(mfit)


</code></pre>

<hr>
<h2 id='pairsetinval'>Estimating initial values for paired slapmeg based on seperate lme models</h2><span id='topic+pairsetinval'></span>

<h3>Description</h3>

<p>A seperate lme model is fited per omic in the pathway and the estimates are combined based on the indexes
of pairs to create initial values for the <code><a href="#topic+pairslapmeg">pairslapmeg</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairsetinval(index, fixed, random, subject, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairsetinval_+3A_index">index</code></td>
<td>
<p>Indexes of pairs used for replacing the parameters in the jopint model</p>
</td></tr>
<tr><td><code id="pairsetinval_+3A_fixed">fixed</code></td>
<td>
<p>A two-sided linear formula object for specifying the
fixed-effects in the linear mixed model at the latent process level. Names
of omics in the pathway are separated by <code>+</code> on the left of <code>~</code> and the
covariates are separated by <code>+</code> on the right of the <code>~</code>. For
identifiability purposes, the intercept should always be present in the model.</p>
</td></tr>
<tr><td><code id="pairsetinval_+3A_random">random</code></td>
<td>
<p>A one-sided formula for the random-effects in the
latent process mixed model and starts with the <code>~</code> sign. At least one random
effect should be included. Covariates with a random-effect are separated
by <code>+</code>.</p>
</td></tr>
<tr><td><code id="pairsetinval_+3A_subject">subject</code></td>
<td>
<p>name of the covariate representing the repeated measures structure such as subject IDs.</p>
</td></tr>
<tr><td><code id="pairsetinval_+3A_data">data</code></td>
<td>
<p>data frame containing the variables named in <code>fixed</code>, <code>random</code>,
<code>grouping</code> and <code>subject</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of vectors, each including vector of initial values corresponding to pairs based on the
index file. These vectors will be used as input for multlcmm function of each paired model.
</p>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
<a href="mailto:m.ebrahimpoor@lumc.nl">m.ebrahimpoor@lumc.nl</a>
</p>

<hr>
<h2 id='pairslapmeg'>Testing pathways using SLaPMEG (shared latent process mixed effects model and Globaltest) for
longitudinal Omics data based on pairwise estimation approach (a computational solution for
latrge pathways)</h2><span id='topic+pairslapmeg'></span>

<h3>Description</h3>

<p>This function performs pathway testing for longitudinal omics within a two-step framework
just as in <code><a href="#topic+slapmeg">slapmeg</a></code> but instead of using a joint shared latent model in the
first step, it uses a pairwise approach and runs much faste for larger pathways.
After estimating the random effects of the joint model using pairwise fitting, the random
effects are used within globaltest to compare the two groups at a pathway level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairslapmeg(fixed, random, grouping, subject, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairslapmeg_+3A_fixed">fixed</code></td>
<td>
<p>A two-sided linear formula object for specifying the
fixed-effects in the linear mixed model at the latent process level. Names
of omics in the pathway are separated by <code>+</code> on the left of <code>~</code> and the
covariates are separated by <code>+</code> on the right of the <code>~</code>. For
identifiability purposes, the intercept should always be present in the model.</p>
</td></tr>
<tr><td><code id="pairslapmeg_+3A_random">random</code></td>
<td>
<p>A one-sided formula for the random-effects in the
latent process mixed model and starts with the <code>~</code> sign. At least one random
effect should be included. Covariates with a random-effect are separated
by <code>+</code>.</p>
</td></tr>
<tr><td><code id="pairslapmeg_+3A_grouping">grouping</code></td>
<td>
<p>name of the covariate representing grouping by the phenotype</p>
</td></tr>
<tr><td><code id="pairslapmeg_+3A_subject">subject</code></td>
<td>
<p>name of the covariate representing the repeated measures structure such as subject IDs.</p>
</td></tr>
<tr><td><code id="pairslapmeg_+3A_data">data</code></td>
<td>
<p>data frame containing the variables named in <code>fixed</code>, <code>random</code>,
<code>grouping</code> and <code>subject</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned including: </p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr> <tr><td><code>nfix</code></td>
<td>
<p>Number
of fixed effect terms in the model, excluding the mandatory intercept</p>
</td></tr> <tr><td><code>nrand</code></td>
<td>
<p>Number of
random effect terms in the model</p>
</td></tr> <tr><td><code>nsubj</code></td>
<td>
<p>Number of subjects in the sataset</p>
</td></tr> <tr><td><code>nrep</code></td>
<td>

<p>Table of repeated measures, and number of subjects with the specified number of repeated measures</p>
</td></tr>
<tr><td><code>tgroup</code></td>
<td>
<p>Table of grouping, and number of subjects in each group</p>
</td></tr> <tr><td><code>Ynames</code></td>
<td>
<p>Name of the
Omics in the pathway</p>
</td></tr> <tr><td><code>slapconv</code></td>
<td>
<p>Status of convergence: For joint method(=1 if the convergence
criteria were satisfied, =2 if the maximum number of iterations was reached, =4 or 5 if a problem
occured during optimisation); for the pairwise method, proportion of successfully converged pairs
is reported</p>
</td></tr> <tr><td><code>fixedform</code></td>
<td>
<p>Names of Fixed effect terms</p>
</td></tr> <tr><td><code>randform</code></td>
<td>
<p>Names of random effect
terms</p>
</td></tr> <tr><td><code>slapmethod</code></td>
<td>
<p>The method which is &quot;joint&quot; if the original slapmeg approach is adopted
and pairwise for the pairwise method</p>
</td></tr> <tr><td><code>SLaP.par</code></td>
<td>
<p>Fitted values for
the parameters in the joint class mixed model in the first step</p>
</td></tr> <tr><td><code>Globaltest</code></td>
<td>
<p>The output
from Globaltest at the second step</p>
</td></tr> <tr><td><code>EB_pred</code></td>
<td>
<p>Empirical
bayes estimates for the random effects from the joint model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>
<p><a href="mailto:m.ebrahimpoor@lumc.nl">m.ebrahimpoor@lumc.nl</a>
</p>


<h3>References</h3>

<p>Ebrahimpoor, Mitra, Pietro Spitali, Jelle J. Goeman, and Roula Tsonaka. &quot;Pathway testing for longitudinal metabolomics.&quot; Statistics in Medicine (2021).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+slapmeg">slapmeg</a></code>, <code><a href="#topic+multslapmeg">multslapmeg</a></code>, <code><a href="#topic+plotslapmeg">plotslapmeg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# simulate data with 15 omics
testdata&lt;-simslapmeg(nY=25, ntime=3, nsubj = 30, seed=123)
head(testdata)

#fit slapmeg to test for the differential expression of a pathway of size 15
slapmegfit&lt;- pairslapmeg(Y1+Y2+Y6+Y7+Y8~time, ~1, grouping="group", subject="ID", data=testdata)
slapmegfit
summary(slapmegfit)

</code></pre>

<hr>
<h2 id='plotslapmeg'>Plot the estimated random effects from SLaPMEG seperated for the study groups</h2><span id='topic+plotslapmeg'></span>

<h3>Description</h3>

<p>This plot can provide a graphical insight into the source of effect (i.e. diffrential expression)
in relevent pathway.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotslapmeg(obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotslapmeg_+3A_obj">obj</code></td>
<td>
<p>An slapmeg object which is the output from <code><a href="#topic+slapmeg">slapmeg</a></code> or
<code><a href="#topic+pairslapmeg">pairslapmeg</a></code>. Note that the <code>fullreturn=TRUE</code>) must have been used.</p>
</td></tr>
<tr><td><code id="plotslapmeg_+3A_...">...</code></td>
<td>
<p>optional graphical parameters can be added with an <code>+</code> based on <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code>
structure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns NULL
</p>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>
<p><a href="mailto:m.ebrahimpoor@lumc.nl">m.ebrahimpoor@lumc.nl</a>
</p>


<h3>References</h3>

<p>Ebrahimpoor, Mitra, Pietro Spitali, Jelle J. Goeman, and Roula Tsonaka. &quot;Pathway testing for longitudinal metabolomics.&quot; Statistics in Medicine (2021).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+slapmeg">slapmeg</a></code>, <code><a href="#topic+multslapmeg">multslapmeg</a></code>, <code><a href="#topic+pairslapmeg">pairslapmeg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate data with 8 omics
testdata&lt;-simslapmeg(nY=8, ntime=5, nsubj = 30, seed=123)
head(testdata)

#fit slapmeg to test for the differential expression of a pathway of size 5
fit&lt;- slapmeg(Y1+Y2+Y6+Y7+Y8~time, ~1, grouping="group", subject="ID", data=testdata)

#Density plots for the estimated random effects
plotslapmeg(fit)

</code></pre>

<hr>
<h2 id='print.mslapmeg'>Print objects from <code>multslapmeg</code></h2><span id='topic+print.mslapmeg'></span>

<h3>Description</h3>

<p>Provides an overview of mSLaPMEG results for each pathway through <code>multslapmeg</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mslapmeg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mslapmeg_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>multslapmeg</code></p>
</td></tr>
<tr><td><code id="print.mslapmeg_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods, which will be ignored in
this function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns result summary of mSLAPMEG approach
</p>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multslapmeg">multslapmeg</a></code>,<code><a href="#topic+slapmeg">slapmeg</a></code>, <code><a href="#topic+pairslapmeg">pairslapmeg</a></code>
</p>

<hr>
<h2 id='print.slapmeg'>Print objects from <code>slapmeg</code></h2><span id='topic+print.slapmeg'></span>

<h3>Description</h3>

<p>Provides an overview of SLaPMEG approach through <code>slapmeg</code>
and <code>pairslapmeg</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slapmeg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.slapmeg_+3A_x">x</code></td>
<td>
<p>an object inheriting from class <code>slapmeg</code></p>
</td></tr>
<tr><td><code id="print.slapmeg_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods, which will be ignored in
this function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns result summaries of SLAPMEG approach
</p>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>


<h3>See Also</h3>

<p><code><a href="#topic+slapmeg">slapmeg</a></code>, <code><a href="#topic+pairslapmeg">pairslapmeg</a></code>
</p>

<hr>
<h2 id='setinval'>Estimating initial values for slapmeg based on seperate lme models</h2><span id='topic+setinval'></span>

<h3>Description</h3>

<p>A seperate lme model is fited per omic in the pathway and the estimates are combined to create
initial values for the <code><a href="#topic+slapmeg">slapmeg</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setinval(fixed, random, subject, data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setinval_+3A_fixed">fixed</code></td>
<td>
<p>A two-sided linear formula object for specifying the
fixed-effects in the linear mixed model at the latent process level. Names
of omics in the pathway are separated by <code>+</code> on the left of <code>~</code> and the
covariates are separated by <code>+</code> on the right of the <code>~</code>. For
identifiability purposes, the intercept should always be present in the model.</p>
</td></tr>
<tr><td><code id="setinval_+3A_random">random</code></td>
<td>
<p>A one-sided formula for the random-effects in the
latent process mixed model and starts with the <code>~</code> sign. At least one random
effect should be included. Covariates with a random-effect are separated
by <code>+</code>.</p>
</td></tr>
<tr><td><code id="setinval_+3A_subject">subject</code></td>
<td>
<p>name of the covariate representing the repeated measures structure such as subject IDs.</p>
</td></tr>
<tr><td><code id="setinval_+3A_data">data</code></td>
<td>
<p>data frame containing the variables named in <code>fixed</code>, <code>random</code>,
<code>grouping</code> and <code>subject</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of initial values to be used as input for multlcmm function
</p>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>
<p><a href="mailto:m.ebrahimpoor@lumc.nl">m.ebrahimpoor@lumc.nl</a>
</p>

<hr>
<h2 id='simslapmeg'>Simulate longitudinal data based on a shared latent process mixed effects model (SlaPMEG)</h2><span id='topic+simslapmeg'></span>

<h3>Description</h3>

<p>This is a simple function to simulate longitudinal data from a shared latent process mixed effects model
the data provides a good example for application of <code>slapmeg</code> and <code>pairslapmeg</code>
and <code>pairslapmeg</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simslapmeg(
  nY,
  ntime,
  nsubj,
  pDif = 1/3,
  fixed = ~1 + time,
  random = ~1 + time,
  fixedbeta = c(0, 2),
  randbeta = c(0, 2),
  group,
  groupbeta = 2,
  sigma.b,
  sigma.u,
  seed = as.integer(runif(1, 0, .Machine$integer.max)),
  returnpar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simslapmeg_+3A_ny">nY</code></td>
<td>
<p>number of omics in the data</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_ntime">ntime</code></td>
<td>
<p>number of repeated measures</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_nsubj">nsubj</code></td>
<td>
<p>number of subjects</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_pdif">pDif</code></td>
<td>
<p>proportion of differentially expressed omics in the data (the default is 1/3)</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_fixed">fixed</code></td>
<td>
<p>A one-sided formula for the fixed-effects excluding the group variable, the default includes an
intercept and time</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_random">random</code></td>
<td>
<p>A one-sided formula for the random-effects, the default includes an intercept and time</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_fixedbeta">fixedbeta</code></td>
<td>
<p>effect size of fixed terms in formula, the length should match the fixed formula,
the default is 0 (intercept) and 2 (time)</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_randbeta">randbeta</code></td>
<td>
<p>effect size of random terms in formula, the length should match the random formula,
the default is 0 (intercept) and 2 (time)</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_group">group</code></td>
<td>
<p>Vector indicating group membership, the length should match the number of subjects,
The default is random allocation of half of subjects to each group.
If use with slapmeg is intended, the group variable should have only two groups</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_groupbeta">groupbeta</code></td>
<td>
<p>effect size of group variable, the default is 2</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_sigma.b">sigma.b</code></td>
<td>
<p>variance of the omic- / subject- specific random effects, the length should math <code>nY</code>.
If not specified, <code>nY</code> values from normal distribution will be randomly assigned.</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_sigma.u">sigma.u</code></td>
<td>
<p>Variance of the subject-specific random effects, the length should math the random effects defined
in random formula. If not specified, 2 values from normal distribution will be randomly assigned.</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_seed">seed</code></td>
<td>
<p>Value of seed, if not specified a random integer will be assigned</p>
</td></tr>
<tr><td><code id="simslapmeg_+3A_returnpar">returnpar</code></td>
<td>
<p>logical if TRUE, all simulation parameters will be returned along with the simulated data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe where the rows represent the observations and the columns
represent the subject Id, time and group variable followed by the omics in pathway; if returnpar is TRUE,
a list with both data and parametrs is returned
</p>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>


<h3>See Also</h3>

<p><code><a href="#topic+slapmeg">slapmeg</a></code>, <code><a href="#topic+pairslapmeg">pairslapmeg</a></code>
</p>

<hr>
<h2 id='slapGT'>Run step II via globaltest package</h2><span id='topic+slapGT'></span>

<h3>Description</h3>

<p>Globaltest is used to test the association between phenotype variable and
estimated random effects from step I.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slapGT(EBS, data_inf, rand_nam, Ynames, grouping, Emethod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slapGT_+3A_ebs">EBS</code></td>
<td>
<p>Estimated random effects by either joint or pairwise approach</p>
</td></tr>
<tr><td><code id="slapGT_+3A_data_inf">data_inf</code></td>
<td>
<p>Dataframe with variables required for the test</p>
</td></tr>
<tr><td><code id="slapGT_+3A_rand_nam">rand_nam</code></td>
<td>
<p>Names of random effects defined in model</p>
</td></tr>
<tr><td><code id="slapGT_+3A_ynames">Ynames</code></td>
<td>
<p>Name of omics in pathway</p>
</td></tr>
<tr><td><code id="slapGT_+3A_grouping">grouping</code></td>
<td>
<p>Name of the covariate representing the grouping by the phenotype</p>
</td></tr>
<tr><td><code id="slapGT_+3A_emethod">Emethod</code></td>
<td>
<p>Estimation method for the random effects which is either joint or pairwise</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A GT object containing globaltest results
</p>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>
<p><a href="mailto:m.ebrahimpoor@lumc.nl">m.ebrahimpoor@lumc.nl</a>
</p>

<hr>
<h2 id='slapmeg'>Testing pathways using SLaPMEG (shared latent process mixed effects model and Globaltest) for
longitudinal Omics data</h2><span id='topic+slapmeg'></span>

<h3>Description</h3>

<p>A two-step procedure is adopted, first a joint latent process mixed effects model
is fitted and on the longitudinal data to summarize the temporal trend in terms of
several random effects. For computational efficacy, if the size of pathway is
larger than 10 a paired approah is used to estimate the random effects with the
<code>pairslapmeg</code> function. The random effects are the input for globaltest which
is used to compare the two groups at a pathway level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slapmeg(fixed, random, grouping, subject, data, nlimit = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slapmeg_+3A_fixed">fixed</code></td>
<td>
<p>A two-sided linear formula object for specifying the
fixed-effects in the linear mixed model at the latent process level. Names
of omics in the pathway are separated by <code>+</code> on the left of <code>~</code> and the
covariates are separated by <code>+</code> on the right of the <code>~</code>. For
identifiability purposes, the intercept should always be present in the model.</p>
</td></tr>
<tr><td><code id="slapmeg_+3A_random">random</code></td>
<td>
<p>A one-sided formula for the random-effects in the
latent process mixed model and starts with the <code>~</code> sign. At least one random
effect should be included. Covariates with a random-effect are separated
by <code>+</code>.</p>
</td></tr>
<tr><td><code id="slapmeg_+3A_grouping">grouping</code></td>
<td>
<p>name of the covariate representing grouping by the phenotype</p>
</td></tr>
<tr><td><code id="slapmeg_+3A_subject">subject</code></td>
<td>
<p>name of the covariate representing the repeated measures structure such as subject IDs.</p>
</td></tr>
<tr><td><code id="slapmeg_+3A_data">data</code></td>
<td>
<p>data frame containing the variables named in <code>fixed</code>, <code>random</code>,
<code>grouping</code> and <code>subject</code>.</p>
</td></tr>
<tr><td><code id="slapmeg_+3A_nlimit">nlimit</code></td>
<td>
<p>A controling arguments telling slapmeg to use pairwise approach for pathways larger than this value,
default is 10. Note: fitting the joint model may take long for pathways larger than 20 omics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned including: </p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr> <tr><td><code>nfix</code></td>
<td>
<p>Number
of fixed effect terms in the model, excluding the mandatory intercept</p>
</td></tr> <tr><td><code>nrand</code></td>
<td>
<p>Number of
random effect terms in the model</p>
</td></tr> <tr><td><code>nsubj</code></td>
<td>
<p>Number of subjects in the sataset</p>
</td></tr> <tr><td><code>nrep</code></td>
<td>

<p>Table of repeated measures, and number of subjects with the specified number of repeated measures</p>
</td></tr>
<tr><td><code>tgroup</code></td>
<td>
<p>Table of grouping, and number of subjects in each group</p>
</td></tr> <tr><td><code>Ynames</code></td>
<td>
<p>Name of the
Omics in the pathway</p>
</td></tr> <tr><td><code>slapconv</code></td>
<td>
<p>Status of convergence: For joint method(=1 if the convergence
criteria were satisfied, =2 if the maximum number of iterations was reached, =4 or 5 if a problem
occured during optimisation); for the pairwise method, proportion of successfully converged pairs
is reported</p>
</td></tr> <tr><td><code>fixedform</code></td>
<td>
<p>Names of Fixed effect terms</p>
</td></tr> <tr><td><code>randform</code></td>
<td>
<p>Names of random effect
terms</p>
</td></tr> <tr><td><code>slapmethod</code></td>
<td>
<p>The method which is &quot;joint&quot; if the original slapmeg approach is adopted
and pairwise for the pairwise method</p>
</td></tr> <tr><td><code>SLaP.par</code></td>
<td>
<p>Fitted values for
the parameters in the joint class mixed model in the first step</p>
</td></tr> <tr><td><code>Globaltest</code></td>
<td>
<p>The output
from Globaltest at the second step</p>
</td></tr> <tr><td><code>EB_pred</code></td>
<td>
<p>Empirical
bayes estimates for the random effects from the joint model</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>
<p><a href="mailto:m.ebrahimpoor@lumc.nl">m.ebrahimpoor@lumc.nl</a>
</p>


<h3>References</h3>

<p>Ebrahimpoor, Mitra, Pietro Spitali, Jelle J. Goeman, and Roula Tsonaka. &quot;Pathway testing for longitudinal metabolomics.&quot; Statistics in Medicine (2021).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multslapmeg">multslapmeg</a></code>, <code><a href="#topic+pairslapmeg">pairslapmeg</a></code>, <code><a href="#topic+plotslapmeg">plotslapmeg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# simulate data with 8 omics
testdata&lt;-simslapmeg(nY=8, ntime=5, nsubj = 30, seed=123)
head(testdata)

#fit slapmeg to test for the differential expression of a pathway of size 5
fit&lt;- slapmeg(Y1+Y2+Y6+Y7+Y8~time, ~1, grouping="group", subject="ID", data=testdata)
fit
summary(fit)

</code></pre>

<hr>
<h2 id='summary.mslapmeg'>Summary of  <code>slapmeg</code> objects</h2><span id='topic+summary.mslapmeg'></span>

<h3>Description</h3>

<p>Provides a table of sorted p-values for the output of multSLaPMEG approach within <code>multslapmeg</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mslapmeg'
summary(object, n = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mslapmeg_+3A_object">object</code></td>
<td>
<p>an object inheriting from classes <code>multslapmeg</code></p>
</td></tr>
<tr><td><code id="summary.mslapmeg_+3A_n">n</code></td>
<td>
<p>an integer indicating number of pathways to be printed the default is 5</p>
</td></tr>
<tr><td><code id="summary.mslapmeg_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods, which will be ignored in this
function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'Returns the fixed effect estimates and random effects variances from the model in step 1
and the details of Globaltest along with p-value from step 2.
</p>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multslapmeg">multslapmeg</a></code>, <code><a href="#topic+pairslapmeg">pairslapmeg</a></code>,
</p>

<hr>
<h2 id='summary.slapmeg'>Summary of  <code>slapmeg</code> objects</h2><span id='topic+summary.slapmeg'></span>

<h3>Description</h3>

<p>Provides a summary of values estimated with SLaPMEG approach within <code>slapmeg</code>
and <code>pairslapmeg</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slapmeg'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.slapmeg_+3A_object">object</code></td>
<td>
<p>an object inheriting from classes <code>slapmeg</code></p>
</td></tr>
<tr><td><code id="summary.slapmeg_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to or from other methods, which will be ignored in this
function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'Returns the fixed effect estimates and random effects variances from the model in step 1
and the details of Globaltest along with p-value from step 2.
</p>


<h3>Author(s)</h3>

<p>Mitra Ebrahimpoor
</p>


<h3>See Also</h3>

<p><code><a href="#topic+slapmeg">slapmeg</a></code>, <code><a href="#topic+pairslapmeg">pairslapmeg</a></code>,
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
