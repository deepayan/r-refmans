<!DOCTYPE html><html lang="en"><head><title>Help for package uclust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {uclust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bn'><p>Computes Bn Statistic.</p></a></li>
<li><a href='#bn3'><p>Computes Bn Statistic for 3 Groups.</p></a></li>
<li><a href='#is_homo'><p>U-statistic based homogeneity test</p></a></li>
<li><a href='#is_homo3'><p>U-statistic based homogeneity test for 3 groups</p></a></li>
<li><a href='#plot_uhclust'><p>Plot function for the result of uhclust</p></a></li>
<li><a href='#print.utest_classify'><p>Simple print method for utest_classify objects.</p></a></li>
<li><a href='#rep_optimBn'><p>Optimization function with multiple staring points (for local optima)</p></a></li>
<li><a href='#uclust'><p>U-statistic based significance clustering</p></a></li>
<li><a href='#uclust3'><p>U-statistic based significance clustering for three way partitions</p></a></li>
<li><a href='#uhclust'><p>U-statistic based significance hierarchical clustering</p></a></li>
<li><a href='#utest'><p>U test</p></a></li>
<li><a href='#utest_classify'><p>Test for classification of a sample in one of two groups.</p></a></li>
<li><a href='#utest3'><p>U-test for three groups</p></a></li>
<li><a href='#var_bn'><p>Variance of Bn</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Clustering and Classification Inference with U-Statistics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Clustering and classification inference for high dimension low sample size (HDLSS)
    data with U-statistics. The package contains implementations of nonparametric statistical
    tests for sample homogeneity, group separation, clustering, and classification of 
    multivariate data. The methods have high statistical power and are tailored for data
    in which the dimension L is much larger than sample size n. See Gabriela B. Cybis,
    Marcio Valk and Sílvia RC Lopes (2018) &lt;<a href="https://doi.org/10.1080%2F00949655.2017.1374387">doi:10.1080/00949655.2017.1374387</a>&gt;, Marcio 
    Valk and Gabriela B. Cybis (2020) &lt;<a href="https://doi.org/10.1080%2F10618600.2020.1796398">doi:10.1080/10618600.2020.1796398</a>&gt;, Debora Z. Bello, Marcio 
    Valk and Gabriela B. Cybis (2021) &lt;<a href="https://doi.org/10.48550/arXiv.2106.09115">doi:10.48550/arXiv.2106.09115</a>&gt;. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0),dendextend,robcor</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-06-18 17:26:56 UTC; gabrielacybis</td>
</tr>
<tr>
<td>Author:</td>
<td>Gabriela Cybis [aut, cre],
  Marcio Valk [aut],
  Kazuki Yokoyama [ctb],
  Debora Zava Bello [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gabriela Cybis &lt;gcybis@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-06-18 22:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bn'>Computes Bn Statistic.</h2><span id='topic+bn'></span>

<h3>Description</h3>

<p>Returns the value for the Bn statistic that measures the degree of separation between two groups.
The statistic is computed through the difference of average within group distances to average between
group distances. Large values of Bn indicate large group separation. Under overall sample homogeneity
we have E(Bn)=0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bn(group_id, md = NULL, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bn_+3A_group_id">group_id</code></td>
<td>
<p>A vector of 0s and 1s indicating to which group the samples belong. Must be in the same order as data or md.</p>
</td></tr>
<tr><td><code id="bn_+3A_md">md</code></td>
<td>
<p>Matrix of distances between all data points.</p>
</td></tr>
<tr><td><code id="bn_+3A_data">data</code></td>
<td>
<p>Data matrix. Each row represents an observation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either <code>data</code> OR <code>md</code> should be provided.
If data are entered directly, Bn will be computed considering the squared Euclidean distance, which is compatible with
<code><a href="#topic+is_homo">is_homo</a></code>, <code><a href="#topic+uclust">uclust</a></code> and <code><a href="#topic+uhclust">uhclust</a></code>.
</p>
<p>For more detail see Cybis, Gabriela B., Marcio Valk, and Sílvia RC Lopes. &quot;Clustering and classification problems in genetics through U-statistics.&quot;
Journal of Statistical Computation and Simulation 88.10 (2018)
and Valk, Marcio, and Gabriela Bettella Cybis. &quot;U-statistical inference for hierarchical clustering.&quot; Journal of Computational and Graphical Statistics 30(1) (2021).
</p>


<h3>Value</h3>

<p>Value of the Bn statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=5
x=matrix(rnorm(n*10),ncol=10)
bn(c(1,0,0,0,0),data=x)     # option (a) entering the data matrix directly
md=as.matrix(dist(x))^2
bn(c(0,1,1,1,1),md)         # option (b) entering the distance matrix

</code></pre>

<hr>
<h2 id='bn3'>Computes Bn Statistic for 3 Groups.</h2><span id='topic+bn3'></span>

<h3>Description</h3>

<p>Returns the value for the Bn statistic that measures the degree of separation between three groups.
The statistic is computed as a combination of differences of average within group and between group distances.
Large values of Bn indicate large group separation. Under overall sample homogeneity we have E(Bn)=0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bn3(group_id, md = NULL, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bn3_+3A_group_id">group_id</code></td>
<td>
<p>A vector of 1s, 2s and 3s indicating to which group the samples belong. Must be in the same order as data or md.</p>
</td></tr>
<tr><td><code id="bn3_+3A_md">md</code></td>
<td>
<p>Matrix of distances between all data points.</p>
</td></tr>
<tr><td><code id="bn3_+3A_data">data</code></td>
<td>
<p>Data matrix. Each row represents an observation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either <code>data</code> OR <code>md</code> should be provided.
If data are entered directly, Bn will be computed considering the squared Euclidean distance.
</p>
<p>For more detail see
Bello, Debora Zava,  Marcio Valk and Gabriela Bettella Cybis.
&quot;Clustering inference in multiple groups.&quot; arXiv preprint arXiv:2106.09115 (2021).
</p>


<h3>Value</h3>

<p>Value of the Bn3 statistic.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=7
set.seed(1234)
x=matrix(rnorm(n*10),ncol=10)
bn3(c(1,2,2,2,3,3,3),data=x)     # option (a) entering the data matrix directly
md=as.matrix(dist(x))^2
bn3(c(1,2,2,2,3,3,3),md)         # option (b) entering the distance matrix
</code></pre>

<hr>
<h2 id='is_homo'>U-statistic based homogeneity test</h2><span id='topic+is_homo'></span>

<h3>Description</h3>

<p>Homogeneity test based on the statistic <code>bn</code>. The test assesses whether there exists a data partition
for which group separation is statistically significant according to the U-test. The null hypothesis
is overall sample homogeneity, and a sample is considered homogeneous if it cannot be divided into
two statistically significant subgroups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_homo(md = NULL, data = NULL, rep = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_homo_+3A_md">md</code></td>
<td>
<p>Matrix of distances between all data points.</p>
</td></tr>
<tr><td><code id="is_homo_+3A_data">data</code></td>
<td>
<p>Data matrix. Each row represents an observation.</p>
</td></tr>
<tr><td><code id="is_homo_+3A_rep">rep</code></td>
<td>
<p>Number of times to repeat optimization procedure. Important for problems with
multiple optima.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the homogeneity test of Cybis et al. (2017) extended to account for groups of size 1.
The test is performed through two steps: an optimization procedure that finds the data partition that
maximizes the standardized Bn and a test for the resulting maximal partition. Should be used in high dimension small sample size settings.
</p>
<p>Either <code>data</code> or <code>md</code> should be provided.
If data are entered directly, Bn will be computed considering the squared Euclidean distance.
</p>
<p>Variance of <code>bn</code> is estimated through resampling, and thus, p-values may vary a bit in different runs.
</p>
<p>For more detail see Cybis, Gabriela B., Marcio Valk, and Sílvia RC Lopes. &quot;Clustering and classification problems in genetics through U-statistics.&quot;
Journal of Statistical Computation and Simulation 88.10 (2018)
and Valk, Marcio, and Gabriela Bettella Cybis. &quot;U-statistical inference for hierarchical clustering.&quot; Journal of Computational and Graphical Statistics 30(1) (2021).
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:</p>

<dl>
<dt>minFobj</dt><dd><p>Test statistic. Minimum of the objective function for optimization (-stdBn).</p>
</dd>
<dt>group1</dt><dd><p>Elements in group 1 in the maximal partition. (obs: this is not the best
partition for the data, see <code>uclust</code>)</p>
</dd>
<dt>group2</dt><dd><p>Elements in group 2 in the maximal partition.</p>
</dd>
<dt>p.MaxTest</dt><dd><p>P-value for the homogeneity test.</p>
</dd>
<dt>Rep.Fobj</dt><dd><p>Values for the minimum objective function on all <code>rep</code> optimization runs.</p>
</dd>
<dt>bootB</dt><dd><p>Resampling variance estimate for partitions with groups of size n/2 (or (n-1)/2 and (n+1)/2 if n is odd).</p>
</dd>
<dt>bootB1</dt><dd><p>Resampling variance estimate for partitions with one group of size 1.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>x = matrix(rnorm(500000),nrow=50)  #creating homogeneous Gaussian dataset
res = is_homo(data=x)

x[1:30,] = x[1:30,]+0.15   #Heterogeneous dataset (first 30 samples have different mean)
res = is_homo(data=x)

md = as.matrix(dist(x)^2)   #squared Euclidean distances for the same data
res = is_homo(md)

# Multidimensional sacling plot of distance matrix
fit &lt;- cmdscale(md, eig = TRUE, k = 2)
x &lt;- fit$points[, 1]
y &lt;- fit$points[, 2]
plot(x,y, main=paste("Homogeneity test: p-value =",res$p.MaxTest))

</code></pre>

<hr>
<h2 id='is_homo3'>U-statistic based homogeneity test for 3 groups</h2><span id='topic+is_homo3'></span>

<h3>Description</h3>

<p>Homogeneity test based on the statistic bn3. The test assesses whether there exists a data
partition for which three group separation is statistically significant according to utest3.
The null hypothesis is overall sample homogeneity, and a sample is considered homogeneous if
it cannot be divided into three groups with at least one significantly different from the others.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_homo3(md = NULL, data = NULL, rep = 20, test_max = TRUE, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_homo3_+3A_md">md</code></td>
<td>
<p>Matrix of distances between all data points.</p>
</td></tr>
<tr><td><code id="is_homo3_+3A_data">data</code></td>
<td>
<p>Data matrix. Each row represents an observation.</p>
</td></tr>
<tr><td><code id="is_homo3_+3A_rep">rep</code></td>
<td>
<p>Number of times to repeat optimization procedure. Important for problems with
multiple optima.</p>
</td></tr>
<tr><td><code id="is_homo3_+3A_test_max">test_max</code></td>
<td>
<p>Logical indicating whether to employ the max test</p>
</td></tr>
<tr><td><code id="is_homo3_+3A_alpha">alpha</code></td>
<td>
<p>Significance level</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the homogeneity test of Bello et al. (2021).
The test is performed through two steps: an optimization procedure that finds the data partition that
maximizes the standardized Bn and a test for the resulting maximal partition.
Should be used in high dimension small sample size settings.
</p>
<p>Either <code>data</code> or <code>md</code> should be provided.
If data are entered directly, Bn will be computed considering the squared Euclidean distance.
</p>
<p>Variance of <code>bn</code> is estimated through resampling, and thus, p-values may vary a bit in different runs.
</p>
<p>For more detail see
Bello, Debora Zava,  Marcio Valk and Gabriela Bettella Cybis.
&quot;Clustering inference in multiple groups.&quot; arXiv preprint arXiv:2106.09115 (2021).
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:</p>

<dl>
<dt>stdBn</dt><dd><p>Test statistic. Maximum standardized Bn.</p>
</dd>
<dt>group1</dt><dd><p>Elements in group 1 in the maximal partition. (obs: this is not the best
partition for the data, see <code>uclust3</code>)</p>
</dd>
<dt>group2</dt><dd><p>Elements in group 2 in the maximal partition.</p>
</dd>
<dt>group3</dt><dd><p>Elements in group 3 in the maximal partition.</p>
</dd>
<dt>pvalue.Bonferroni</dt><dd><p>P-value for the homogeneity test.</p>
</dd>
<dt>alpha_Bonferroni</dt><dd><p>Alpha after Bonferroni correction</p>
</dd>
<dt>bootB</dt><dd><p>Resampling variance estimate for partitions with central group sizes.</p>
</dd>
<dt>bootB1</dt><dd><p>Resampling variance estimate for partitions with one group of size 1.</p>
</dd>
<dt>varBn</dt><dd><p>Estimated variance of Bn for maximal standardized Bn configuration.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
x = matrix(rnorm(70000),nrow=7)  #creating homogeneous Gaussian dataset
res = is_homo3(data=x)
res

#uncomment to run
# x = matrix(rnorm(18000),nrow=18)
# x[1:5,] = x[1:5,]+0.5 #Heterogeneous dataset (first 5 samples have different mean)
# x[6:9,] = x[6:9,]+1.5
# res = is_homo3(data=x)
#  res
# md = as.matrix(dist(x)^2) #squared Euclidean distances for the same data
# res = is_homo3(md)       # uncomment to run

# Multidimensional sacling plot of distance matrix
#fit &lt;- cmdscale(md, eig = TRUE, k = 2)
#x &lt;- fit$points[, 1]
#y &lt;- fit$points[, 2]
#plot(x,y, main=paste("Homogeneity test: p-value =",res$p.MaxTest))

</code></pre>

<hr>
<h2 id='plot_uhclust'>Plot function for the result of uhclust</h2><span id='topic+plot_uhclust'></span>

<h3>Description</h3>

<p>This function plots the p-value annotated dendrogram resulting from <code>uhclust</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_uhclust(
  uhclust,
  pvalues_cex = 0.8,
  pvalues_dx = 2,
  pvalues_dy = 0.08,
  print_pvalues = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_uhclust_+3A_uhclust">uhclust</code></td>
<td>
<p>Result from <code>uhclust</code></p>
</td></tr>
<tr><td><code id="plot_uhclust_+3A_pvalues_cex">pvalues_cex</code></td>
<td>
<p>Graphical parameter for p-value font size.</p>
</td></tr>
<tr><td><code id="plot_uhclust_+3A_pvalues_dx">pvalues_dx</code></td>
<td>
<p>Graphical parameter for p-value position shift on x axis.</p>
</td></tr>
<tr><td><code id="plot_uhclust_+3A_pvalues_dy">pvalues_dy</code></td>
<td>
<p>Graphical parameter for p-value position shift on y axis.</p>
</td></tr>
<tr><td><code id="plot_uhclust_+3A_print_pvalues">print_pvalues</code></td>
<td>
<p>Logical. Should the p-values be printed?</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
x = matrix(rnorm(100000),nrow=50)
x[1:35,] = x[1:35,]+0.7
x[1:15,] = x[1:15,]+0.4
res = uhclust(data=x, plot=FALSE)
plot_uhclust(res)

</code></pre>

<hr>
<h2 id='print.utest_classify'>Simple print method for utest_classify objects.</h2><span id='topic+print.utest_classify'></span>

<h3>Description</h3>

<p>Simple print method for utest_classify objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'utest_classify'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.utest_classify_+3A_x">x</code></td>
<td>
<p>utest_classify object</p>
</td></tr>
<tr><td><code id="print.utest_classify_+3A_...">...</code></td>
<td>
<p>additional parameters passed to the function</p>
</td></tr>
</table>

<hr>
<h2 id='rep_optimBn'>Optimization function with multiple staring points (for local optima)</h2><span id='topic+rep_optimBn'></span>

<h3>Description</h3>

<p>Finds the configuration with max Bn among all configurations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rep_optimBn(mdm, rep = 15, bootB = -1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rep_optimBn_+3A_mdm">mdm</code></td>
<td>
<p>Matrix of squared Euclidean distances between all data points.</p>
</td></tr>
<tr><td><code id="rep_optimBn_+3A_rep">rep</code></td>
<td>
<p>Number of replications</p>
</td></tr>
<tr><td><code id="rep_optimBn_+3A_bootb">bootB</code></td>
<td>
<p>Result of previous bootstrap (if available). If, -1, a new bootstrap is performed for the variance of Bn.</p>
</td></tr>
</table>

<hr>
<h2 id='uclust'>U-statistic based significance clustering</h2><span id='topic+uclust'></span>

<h3>Description</h3>

<p>Partitions the sample into the two significant subgroups with the largest Bn statistic. If no significant
partition exists, the test will return &quot;homogeneous&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uclust(md = NULL, data = NULL, alpha = 0.05, rep = 15)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uclust_+3A_md">md</code></td>
<td>
<p>Matrix of distances between all data points.</p>
</td></tr>
<tr><td><code id="uclust_+3A_data">data</code></td>
<td>
<p>Data matrix. Each row represents an observation.</p>
</td></tr>
<tr><td><code id="uclust_+3A_alpha">alpha</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="uclust_+3A_rep">rep</code></td>
<td>
<p>Number of times to repeat optimization procedures. Important for problems with
multiple optima.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the significance clustering procedure of Valk and Cybis (2018).
The method first performs a homogeneity test to verify whether the data can be significantly
partitioned. If the hypothesis of homogeneity is rejected, then the method will search, among all
the significant partitions, for the partition that better separates the data, as measured by larger
<code>bn</code> statistic. This function should be used in high dimension small sample size settings.
</p>
<p>Either <code>data</code> or <code>md</code> should be provided.
If data are entered directly, Bn will be computed considering the squared Euclidean distance.
</p>
<p>Variance of <code>bn</code> is estimated through resampling, and thus, p-values may vary a bit in different runs.
</p>
<p>For more detail see Cybis, Gabriela B., Marcio Valk, and Sílvia RC Lopes. &quot;Clustering and classification problems in genetics through U-statistics.&quot;
Journal of Statistical Computation and Simulation 88.10 (2018)
and Valk, Marcio, and Gabriela Bettella Cybis. &quot;U-statistical inference for hierarchical clustering.&quot; Journal of Computational and Graphical Statistics 30(1) (2021).
See also <code>is_homo</code>, <code>uhclust</code>, <code>Utest_class</code>.
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:</p>

<dl>
<dt>cluster1</dt><dd><p>Elements in group 1 in the final partition. This is the significant partition with
maximal Bn, if sample is heterogeneous.</p>
</dd>
<dt>cluster2</dt><dd><p>Elements in group 2 in the final partition.</p>
</dd>
<dt>p.value</dt><dd><p>P-value for the test that renders the final partition, if heterogeneous.
Homogeneity test p-value, if homogeneous.</p>
</dd>
<dt>alpha_corrected</dt><dd><p>Bonferroni corrected significance level for the test that renders the final
partition, if heterogeneous. Homogeneity test significance level, if homogeneous.</p>
</dd>
<dt>n1</dt><dd><p>Size of the smallest cluster</p>
</dd>
<dt>ishomo</dt><dd><p>Logical, returns <code>TRUE</code> when the sample is homogeneous.</p>
</dd>
<dt>Bn</dt><dd><p>Value of Bn statistic for the final partition, if heterogeneous.
Value of Bn statistic for the maximal homogeneity test partition, if homogeneous.</p>
</dd>
<dt>varBn</dt><dd><p>Variance estimate for final partition, if heterogeneous.
Variance estimate for the maximal homogeneity test partition, if homogeneous.</p>
</dd>
<dt>ishomoResult</dt><dd><p>Result of homogeneity test (see <code>is_homo</code>).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(17161)
x = matrix(rnorm(100000),nrow=50)  #creating homogeneous Gaussian dataset
res = uclust(data=x)

x[1:30,] = x[1:30,]+0.25   #Heterogeneous dataset (first 30 samples have different mean)
res = uclust(data=x)

md = as.matrix(dist(x)^2)   #squared Euclidean distances for the same data
res = uclust(md)

# Multidimensional scaling plot of distance matrix
fit &lt;- cmdscale(md, eig = TRUE, k = 2)
x &lt;- fit$points[, 1]
y &lt;- fit$points[, 2]
col=rep(3,dim(md)[1])
col[res$cluster2]=2
plot(x,y, main=paste("Multidimensional scaling plot of data:
                    homogeneity p-value =",res$ishomoResult$p.MaxTest),col=col)


</code></pre>

<hr>
<h2 id='uclust3'>U-statistic based significance clustering for three way partitions</h2><span id='topic+uclust3'></span>

<h3>Description</h3>

<p>Partitions data into three groups only when these partitions are statistically significant.
If no significant partition exists, the test will return &quot;homogeneous&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uclust3(md = NULL, data = NULL, alpha = 0.05, rep = 15)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uclust3_+3A_md">md</code></td>
<td>
<p>Matrix of distances between all data points.</p>
</td></tr>
<tr><td><code id="uclust3_+3A_data">data</code></td>
<td>
<p>Data matrix. Each row represents an observation.</p>
</td></tr>
<tr><td><code id="uclust3_+3A_alpha">alpha</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="uclust3_+3A_rep">rep</code></td>
<td>
<p>Number of times to repeat optimization procedures. Important for problems with
multiple optima.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the significance clustering procedure of Bello et al. (2021).
The method first performs a homogeneity test to verify whether the data can be significantly
partitioned. If the hypothesis of homogeneity is rejected, then the method will search, among all
the significant partitions, for the partition that better separates the data, as measured by larger
<code>bn</code> statistic. This function should be used in high dimension small sample size settings.
</p>
<p>Either <code>data</code> or <code>md</code> should be provided.
If data are entered directly, Bn will be computed considering the squared Euclidean distance.
</p>
<p>Variance of <code>bn</code> is estimated through resampling, and thus, p-values may vary a bit in different runs.
</p>
<p>For more detail see
Bello, Debora Zava,  Marcio Valk and Gabriela Bettella Cybis.
&quot;Clustering inference in multiple groups.&quot; arXiv preprint arXiv:2106.09115 (2021).
See also <code>is_homo3</code>, <code>uclust</code>.
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:</p>

<dl>
<dt>groups</dt><dd><p>List with elements of final three groups</p>
</dd>
<dt>p.value</dt><dd><p>P-value for the test that renders the final partition, if heterogeneous.
Homogeneity test p-value, if homogeneous.</p>
</dd>
<dt>alpha_corrected</dt><dd><p>Bonferroni corrected significance level for the test that renders the final
partition, if heterogeneous. Homogeneity test significance level, if homogeneous.</p>
</dd>
<dt>ishomo</dt><dd><p>Logical, returns <code>TRUE</code> when the sample is homogeneous.</p>
</dd>
<dt>Bn</dt><dd><p>Value of Bn statistic for the final partition, if heterogeneous.
Value of Bn statistic for the maximal homogeneity test partition, if homogeneous.</p>
</dd>
<dt>varBn</dt><dd><p>Variance estimate for final partition, if heterogeneous.
Variance estimate for the maximal homogeneity test partition, if homogeneous.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
x = matrix(rnorm(70000),nrow=7)  #creating homogeneous Gaussian dataset
res = uclust3(data=x)
res

# uncomment to run
# x = matrix(rnorm(15000),nrow=15)
# x[1:6,] = x[1:6,]+1.5 #Heterogeneous dataset (first 5 samples have different mean)
# x[7:12,] = x[7:12,]+3
# res = uclust3(data=x)
# res$groups

</code></pre>

<hr>
<h2 id='uhclust'>U-statistic based significance hierarchical clustering</h2><span id='topic+uhclust'></span>

<h3>Description</h3>

<p>Hierarchical clustering method that partitions the data only when these partitions are statistically significant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uhclust(md = NULL, data = NULL, alpha = 0.05, rep = 15, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uhclust_+3A_md">md</code></td>
<td>
<p>Matrix of distances between all data points.</p>
</td></tr>
<tr><td><code id="uhclust_+3A_data">data</code></td>
<td>
<p>Data matrix. Each row represents an observation.</p>
</td></tr>
<tr><td><code id="uhclust_+3A_alpha">alpha</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="uhclust_+3A_rep">rep</code></td>
<td>
<p>Number of times to repeat optimization procedures. Important for problems with
multiple optima.</p>
</td></tr>
<tr><td><code id="uhclust_+3A_plot">plot</code></td>
<td>
<p>Logical, <code>TRUE</code> if p-value annotated dendrogram should be plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the significance hierarchical clustering procedure of Valk and Cybis (2018). The data are
repeatedly partitioned into two subgroups, through function <code>uclust</code>, according to a hierarchical scheme.
The procedure stops when resulting subgroups are homogeneous or have fewer than 3 elements.
This function should be used in high dimension small sample size settings.
</p>
<p>Either <code>data</code> or <code>md</code> should be provided.
If data are entered directly, Bn will be computed considering the squared Euclidean distance.
</p>
<p>Variance of <code>bn</code> is estimated through resampling, and thus, p-values may vary a bit in different runs.
</p>
<p>For more detail see Cybis, Gabriela B., Marcio Valk, and Sílvia RC Lopes. &quot;Clustering and classification problems in genetics through U-statistics.&quot;
Journal of Statistical Computation and Simulation 88.10 (2018)
and Valk, Marcio, and Gabriela Bettella Cybis. &quot;U-statistical inference for hierarchical clustering.&quot; Journal of Computational and Graphical Statistics 30(1) (2021).
</p>
<p>See also <code>is_homo</code>, <code>uclust</code> and <code>Utest_class</code>.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>hclust</code> with three additional attribute arrays:</p>

<dl>
<dt>Pvalues</dt><dd><p> P-values from uclust for the final data partition at each node of the dendrogram. This
array is in the same order of <code>height</code>, and only contains values for tests that were performed.</p>
</dd>
<dt>alpha</dt><dd><p> Bonferroni corrected significance levels for uclust for the data partitions at each node
of the dendrogram. This array is in the same order of <code>height</code>, and only contains values for tests that were performed.</p>
</dd>
<dt>groups</dt><dd><p> Final group assignments.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
x = matrix(rnorm(100000),nrow=50)  #creating homogeneous Gaussian dataset
res = uhclust(data=x)


x[1:30,] = x[1:30,]+0.7   #Heterogeneous dataset
x[1:10,] = x[1:10,]+0.4
res = uhclust(data=x)
res$groups

</code></pre>

<hr>
<h2 id='utest'>U test</h2><span id='topic+utest'></span>

<h3>Description</h3>

<p>Test for the separation of two groups.
The null hypothesis states that the groups are homogeneous and the alternative hypothesis states that they are separate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utest(group_id, md = NULL, data = NULL, numB = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utest_+3A_group_id">group_id</code></td>
<td>
<p>A vector of 0s and 1s indicating to which group the samples belong. Must be in the same order as data or md.</p>
</td></tr>
<tr><td><code id="utest_+3A_md">md</code></td>
<td>
<p>Matrix of distances between all data points.</p>
</td></tr>
<tr><td><code id="utest_+3A_data">data</code></td>
<td>
<p>Data matrix. Each row represents an observation.</p>
</td></tr>
<tr><td><code id="utest_+3A_numb">numB</code></td>
<td>
<p>Number of resampling iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either <code>data</code> or <code>md</code> should be provided.
If data are entered directly, Bn will be computed considering the squared Euclidean
distance, which is compatible with <code><a href="#topic+is_homo">is_homo</a></code>, <code><a href="#topic+uclust">uclust</a></code> and
<code><a href="#topic+uhclust">uhclust</a></code>.
</p>
<p>For more details see Cybis, Gabriela B., Marcio Valk, and Sílvia RC Lopes. &quot;Clustering and classification problems in genetics through U-statistics.&quot;
Journal of Statistical Computation and Simulation 88.10 (2018)
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:</p>

<dl>
<dt>Bn</dt><dd><p>Test Statistic</p>
</dd>
<dt>Pvalue</dt><dd><p>Replication based p-value</p>
</dd>
<dt>Replication</dt><dd><p>Number of replications used to compute p-value</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+bn">bn</a></code>,<code><a href="#topic+is_homo">is_homo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate a dataset with two separate groups, the first 5 rows have mean 0 and
# the last 5 rows have mean 5.
data &lt;- matrix(c(rnorm(75, 0), rnorm(75, 5)), nrow = 10, byrow=TRUE)

# U test for mixed up groups
utest(group_id=c(1,0,1,0,1,0,1,0,1,0), data=data, numB=3000)
# U test for correct group definitions
utest(group_id=c(1,1,1,1,1,0,0,0,0,0), data=data, numB=3000)


</code></pre>

<hr>
<h2 id='utest_classify'>Test for classification of a sample in one of two groups.</h2><span id='topic+utest_classify'></span>

<h3>Description</h3>

<p>The null hypothesis is that the new data is not well classified into the first group when compared to the second group. The
alternative hypothesis is that the data is well classified into the first group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utest_classify(x, data, group_id, bootstrap_iter = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utest_classify_+3A_x">x</code></td>
<td>
<p>A numeric vector to be classified.</p>
</td></tr>
<tr><td><code id="utest_classify_+3A_data">data</code></td>
<td>
<p>Data matrix. Each row represents an observation.</p>
</td></tr>
<tr><td><code id="utest_classify_+3A_group_id">group_id</code></td>
<td>
<p>A vector of 0s (first group) and 1s indicating to which group the samples belong. Must be in the same order as data.</p>
</td></tr>
<tr><td><code id="utest_classify_+3A_bootstrap_iter">bootstrap_iter</code></td>
<td>
<p>Numeric scalar. The number of bootstraps. It's recommended
<code class="reqn">1000 &lt; bootstrap_iter &lt; 10000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The test is performed considering the squared Euclidean distance.
</p>
<p>For more detail see Cybis, Gabriela B., Marcio Valk, and Sílvia RC Lopes. &quot;Clustering and classification problems in genetics through U-statistics.&quot;
Journal of Statistical Computation and Simulation 88.10 (2018)
and Valk, Marcio, and Gabriela Bettella Cybis. &quot;U-statistical inference for hierarchical clustering.&quot; arXiv preprint arXiv:1805.12179 (2018).
</p>


<h3>Value</h3>

<p>A list with class &quot;utest_classify&quot; containing the following components:
</p>
<table role = "presentation">
<tr><td><code>statistic</code></td>
<td>
<p>the value of the test statistic.</p>
</td></tr>
<tr><td><code>p_value</code></td>
<td>
<p>The p-value for the test.</p>
</td></tr>
<tr><td><code>bootstrap_iter</code></td>
<td>
<p>the number of bootstrap iterations.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
# Five observations from each group, G1 and G2. Each observation has 60 dimensions.
data &lt;- matrix(c(rnorm(300, 0), rnorm(300, 10)), ncol = 60, byrow=TRUE)
# Test data comes from G1.
x &lt;- rnorm(60, 0)
# The test correctly indicates that the test data should be classified into G1 (p &lt; 0.05).
utest_classify(x, data, group_id = c(rep(0,times=5),rep(1,times=5)))

# Example 2
# Five observations from each group, G1 and G2. Each observation has 60 dimensions.
data &lt;- matrix(c(rnorm(300, 0), rnorm(300, 10)), ncol = 60, byrow=TRUE)
# Test data comes from G2.
x &lt;- rnorm(60, 10)
# The test correctly indicates that the test data should be classified into G2 (p &gt; 0.05).
utest_classify(x, data, group_id = c(rep(1,times=5),rep(0,times=5)))
</code></pre>

<hr>
<h2 id='utest3'>U-test for three groups</h2><span id='topic+utest3'></span>

<h3>Description</h3>

<p>Test for the separation of three groups.
The null hypothesis states that the groups are homogeneous and the alternative
hypothesis states that at least one is separated from the others.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utest3(group_id, md = NULL, data = NULL, alpha = 0.05, numB = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utest3_+3A_group_id">group_id</code></td>
<td>
<p>A vector of 1s, 2s and 3s indicating to which group the samples belong.
Must be in the same order as data or md.</p>
</td></tr>
<tr><td><code id="utest3_+3A_md">md</code></td>
<td>
<p>Matrix of distances between all data points.</p>
</td></tr>
<tr><td><code id="utest3_+3A_data">data</code></td>
<td>
<p>Data matrix. Each row represents an observation.</p>
</td></tr>
<tr><td><code id="utest3_+3A_alpha">alpha</code></td>
<td>
<p>Significance level</p>
</td></tr>
<tr><td><code id="utest3_+3A_numb">numB</code></td>
<td>
<p>Number of resampling iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either <code>data</code> or <code>md</code> should be provided.
If data are entered directly, Bn will be computed considering the squared Euclidean
distance.
</p>
<p>For more detail see
Bello, Debora Zava,  Marcio Valk and Gabriela Bettella Cybis.
&quot;Clustering inference in multiple groups.&quot; arXiv preprint arXiv:2106.09115 (2021).
</p>


<h3>Value</h3>

<p>Returns a list with the following elements:</p>

<dl>
<dt>is.homo</dt><dd><p>Logical of whether test indicates that data is homogeneous</p>
</dd>
<dt>Pvalue</dt><dd><p>Replication based p-value</p>
</dd>
<dt>Bn</dt><dd><p>Test Statistic</p>
</dd>
<dt>sdBn</dt><dd><p>Standard error for Bn statistic computed through resampling</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+bn3">bn3</a></code>,<code><a href="#topic+utest">utest</a></code>,<code><a href="#topic+is_homo3">is_homo3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate a dataset with two separate groups,
# the first row has mean -4, the next 5 rows have mean 0 and the last 5 rows have mean 4.
data &lt;- matrix(c(rnorm(15, -4),rnorm(75, 0), rnorm(75, 4)), nrow = 11, byrow=TRUE)
# U test for mixed up groups
utest3(group_id=c(1,2,3,1,2,3,1,2,3,1,2), data=data, numB=3000)
# U test for correct group definitions
utest3(group_id=c(1,2,2,2,2,2,3,3,3,3,3), data=data, numB=3000)


</code></pre>

<hr>
<h2 id='var_bn'>Variance of Bn</h2><span id='topic+var_bn'></span>

<h3>Description</h3>

<p>Estimates the variance of the Bn statistic using the resampling
procedure described in Cybis, Gabriela B., Marcio Valk, and Sílvia RC Lopes. &quot;Clustering and classification problems in genetics through U-statistics.&quot;
Journal of Statistical Computation and Simulation 88.10 (2018)
and Valk, Marcio, and Gabriela Bettella Cybis. &quot;U-statistical inference for hierarchical clustering.&quot; Journal of Computational and Graphical Statistics 30(1) (2021).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var_bn(group_sizes, md = NULL, data = NULL, numB = 2000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var_bn_+3A_group_sizes">group_sizes</code></td>
<td>
<p>A vector with two entries: size of group 1 and size of group 2.</p>
</td></tr>
<tr><td><code id="var_bn_+3A_md">md</code></td>
<td>
<p>Matrix of distances between all data points.</p>
</td></tr>
<tr><td><code id="var_bn_+3A_data">data</code></td>
<td>
<p>Data matrix. Each row represents an observation.</p>
</td></tr>
<tr><td><code id="var_bn_+3A_numb">numB</code></td>
<td>
<p>Number of resampling iterations. Only used if no groups are of size 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either <code>data</code> or <code>md</code> should be provided.
If data are entered directly, Bn will be computed considering the squared Euclidean
distance, which is compatible with <code><a href="#topic+is_homo">is_homo</a></code>, <code><a href="#topic+uclust">uclust</a></code> and
<code><a href="#topic+uhclust">uhclust</a></code>.
</p>


<h3>Value</h3>

<p>Variance of Bn
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bn">bn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n=5
x=matrix(rnorm(n*20),ncol=20)
# option (a) entering the data matrix directly and considering a group of size 1
var_bn(c(1,4),data=x)

# option (b) entering the distance matrix and considering a groups of size 2 and 3
md=as.matrix(dist(x))^2
var_bn(c(2,3),md)



</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
