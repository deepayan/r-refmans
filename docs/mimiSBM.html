<!DOCTYPE html><html lang="en"><head><title>Help for package mimiSBM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mimiSBM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BayesianMixture_SBM_model'><p>mimiSBM model for fixed K and Q</p></a></li>
<li><a href='#CEM'><p>Clustering Matrix : One hot encoding</p></a></li>
<li><a href='#diag_nulle'><p>Diagonal coefficient to 0 on each slice given the 3rd dimension.</p></a></li>
<li><a href='#fit_SBM_per_layer'><p>SBM on each layer</p></a></li>
<li><a href='#fit_SBM_per_layer_parallel'><p>SBM on each layer - parallelized</p></a></li>
<li><a href='#initialisation_params_bayesian'><p>Initialization of mimiSBM parameters</p></a></li>
<li><a href='#lab_switching'><p>Label Switching</p></a></li>
<li><a href='#log_Softmax'><p>log softmax of matrices (by row)</p></a></li>
<li><a href='#Loss_BayesianMSBM'><p>mimiSBM Evidence Lower BOund</p></a></li>
<li><a href='#Mat_lien_alpha'><p>Create probality-component list for clustering per view component.</p></a></li>
<li><a href='#mimiSBM'><p>Mixture of Multilayer Integrator SBM (mimiSBM)</p></a></li>
<li><a href='#multinomial_lbeta_function'><p>Calculation of Log multinomial Beta value.</p></a></li>
<li><a href='#one_hot_errormachine'><p>One Hot Encoding with Error machine</p></a></li>
<li><a href='#partition_K_barre'><p>Create a link between final clustering and clustering per view component.</p></a></li>
<li><a href='#plot_adjacency'><p>Plot adjacency matrices</p></a></li>
<li><a href='#rMSBM'><p>Simulate data from the mimiSBM generative model.</p></a></li>
<li><a href='#rSMB_partition'><p>Simulation of mixture multilayer Stochastick block model</p></a></li>
<li><a href='#sort_Z'><p>Sort the clustering matrix</p></a></li>
<li><a href='#transpo'><p>Transposition of an array</p></a></li>
<li><a href='#trig_sup'><p>Upper triangular Matrix/Array</p></a></li>
<li><a href='#update_beta_bayesian'><p>Update of bayesian parameter beta</p></a></li>
<li><a href='#update_eta_bayesian'><p>Update of bayesian parameter eta</p></a></li>
<li><a href='#update_tau_bayesian'><p>Update of bayesian parameter tau</p></a></li>
<li><a href='#update_theta_bayesian'><p>Update of bayesian parameter theta</p></a></li>
<li><a href='#update_u_bayesian'><p>Update of bayesian parameter u</p></a></li>
<li><a href='#update_xi_bayesian'><p>Update of bayesian parameter xi</p></a></li>
<li><a href='#VBEM_step'><p>Variational Bayes Expectation Maximization</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Mixture of Multilayer Integrator Stochastic Block Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Our approach uses a  mixture of multilayer stochastic block models to group co-membership matrices with similar information into components and to partition observations into different clusters. See De Santiago (2023, ISBN: 978-2-87587-088-9).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>blockmodels, stats</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-08 10:49:46 UTC; kdesantiago</td>
</tr>
<tr>
<td>Author:</td>
<td>Kylliann De Santiago [aut, cre],
  Marie Szafranski [aut],
  Christophe Ambroise [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kylliann De Santiago &lt;kylliann.desantiago@univ-evry.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-09 08:40:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='BayesianMixture_SBM_model'>mimiSBM model for fixed K and Q</h2><span id='topic+BayesianMixture_SBM_model'></span>

<h3>Description</h3>

<p>mimiSBM model for fixed K and Q
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BayesianMixture_SBM_model(
  A,
  K,
  Q,
  beta_0 = rep(1/2, K),
  theta_0 = rep(1/2, Q),
  eta_0 = array(rep(1/2, K * K * Q), c(K, K, Q)),
  xi_0 = array(rep(1/2, K * K * Q), c(K, K, Q)),
  tol = 0.001,
  iter_max = 10,
  n_init = 1,
  alternate = TRUE,
  Verbose = TRUE,
  eps_conv = 1e-04,
  type_init = "SBM",
  nbCores = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BayesianMixture_SBM_model_+3A_a">A</code></td>
<td>
<p>an array of dim=c(N,N,V)</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_k">K</code></td>
<td>
<p>number of clusters</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_q">Q</code></td>
<td>
<p>number of components</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_beta_0">beta_0</code></td>
<td>
<p>hyperparameters for beta</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_theta_0">theta_0</code></td>
<td>
<p>hyperparameters for theta</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_eta_0">eta_0</code></td>
<td>
<p>hyperparameters for eta</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_xi_0">xi_0</code></td>
<td>
<p>hyperparameters for xi</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_tol">tol</code></td>
<td>
<p>convergence parameter on ELBO</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_iter_max">iter_max</code></td>
<td>
<p>maximal number of iteration of mimiSBM</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_n_init">n_init</code></td>
<td>
<p>number of initialization of the mimi algorithm.</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_alternate">alternate</code></td>
<td>
<p>boolean indicated if we put an M-step after each part of the E-step, after u optimization and after tau optimization. If not, we optimize u and tau and after the M-step is made.</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_verbose">Verbose</code></td>
<td>
<p>boolean for information on model fitting</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_eps_conv">eps_conv</code></td>
<td>
<p>parameter of convergence for tau.</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_type_init">type_init</code></td>
<td>
<p>select the type of initialization type_init=c(&quot;SBM&quot;,&quot;Kmeans&quot;,&quot;random&quot;)</p>
</td></tr>
<tr><td><code id="BayesianMixture_SBM_model_+3A_nbcores">nbCores</code></td>
<td>
<p>the number of cores used to parallelize the calculations
</p>
<p>See the vignette for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>model with estimation of coefficients.
</p>

<hr>
<h2 id='CEM'>Clustering Matrix : One hot encoding</h2><span id='topic+CEM'></span>

<h3>Description</h3>

<p>Clustering Matrix : One hot encoding
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CEM(Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CEM_+3A_z">Z</code></td>
<td>
<p>a matrix N x K, with probabilities to belong of a cluster in rows for each observation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Z a matrix N x K One-Hot-Encoded by rows, where K is the number of clusters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Z &lt;- matrix(rnorm(12),3,4)
Z_cem &lt;- CEM(Z)
print(Z_cem)
</code></pre>

<hr>
<h2 id='diag_nulle'>Diagonal coefficient to 0 on each slice given the 3rd dimension.</h2><span id='topic+diag_nulle'></span>

<h3>Description</h3>

<p>Diagonal coefficient to 0 on each slice given the 3rd dimension.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diag_nulle(A)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diag_nulle_+3A_a">A</code></td>
<td>
<p>a array of dimension dim=c(N,N,V)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A with 0 on each diagonal given the 3rd dimension.
</p>

<hr>
<h2 id='fit_SBM_per_layer'>SBM on each layer</h2><span id='topic+fit_SBM_per_layer'></span>

<h3>Description</h3>

<p>SBM on each layer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_SBM_per_layer(A, silent = FALSE, ncores = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_SBM_per_layer_+3A_a">A</code></td>
<td>
<p>an array of dim=c(N,N,V)</p>
</td></tr>
<tr><td><code id="fit_SBM_per_layer_+3A_silent">silent</code></td>
<td>
<p>Boolean for verbose</p>
</td></tr>
<tr><td><code id="fit_SBM_per_layer_+3A_ncores">ncores</code></td>
<td>
<p>the number of cores used to parallelize the calculations of the various SBMs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the parameters of each SBM applied to each view
</p>

<hr>
<h2 id='fit_SBM_per_layer_parallel'>SBM on each layer - parallelized</h2><span id='topic+fit_SBM_per_layer_parallel'></span>

<h3>Description</h3>

<p>SBM on each layer - parallelized
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_SBM_per_layer_parallel(A, nbCores = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_SBM_per_layer_parallel_+3A_a">A</code></td>
<td>
<p>an array of dim=c(N,N,V)</p>
</td></tr>
<tr><td><code id="fit_SBM_per_layer_parallel_+3A_nbcores">nbCores</code></td>
<td>
<p>the number of cores used to parallelize the calculations of the various SBMs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the parameters of each SBM applied to each view
</p>

<hr>
<h2 id='initialisation_params_bayesian'>Initialization of mimiSBM parameters</h2><span id='topic+initialisation_params_bayesian'></span>

<h3>Description</h3>

<p>Initialization of mimiSBM parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initialisation_params_bayesian(
  A,
  K,
  Q,
  beta_0 = rep(1/2, K),
  theta_0 = rep(1/2, Q),
  eta_0 = array(rep(1/2, K * K * Q), c(K, K, Q)),
  xi_0 = array(rep(1/2, K * K * Q), c(K, K, Q)),
  type_init = "SBM",
  nbCores = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initialisation_params_bayesian_+3A_a">A</code></td>
<td>
<p>an array of dim=c(N,N,V)</p>
</td></tr>
<tr><td><code id="initialisation_params_bayesian_+3A_k">K</code></td>
<td>
<p>Number of clusters</p>
</td></tr>
<tr><td><code id="initialisation_params_bayesian_+3A_q">Q</code></td>
<td>
<p>Number of components</p>
</td></tr>
<tr><td><code id="initialisation_params_bayesian_+3A_beta_0">beta_0</code></td>
<td>
<p>hyperparameters for beta</p>
</td></tr>
<tr><td><code id="initialisation_params_bayesian_+3A_theta_0">theta_0</code></td>
<td>
<p>hyperparameters for theta</p>
</td></tr>
<tr><td><code id="initialisation_params_bayesian_+3A_eta_0">eta_0</code></td>
<td>
<p>hyperparameters for eta</p>
</td></tr>
<tr><td><code id="initialisation_params_bayesian_+3A_xi_0">xi_0</code></td>
<td>
<p>hyperparameters for xi</p>
</td></tr>
<tr><td><code id="initialisation_params_bayesian_+3A_type_init">type_init</code></td>
<td>
<p>select the type of initialization type_init=c(&quot;SBM&quot;,&quot;Kmeans&quot;,&quot;random&quot;)</p>
</td></tr>
<tr><td><code id="initialisation_params_bayesian_+3A_nbcores">nbCores</code></td>
<td>
<p>the number of cores used to parallelize the calculations of the various SBMs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list <code>params</code> updated
</p>

<hr>
<h2 id='lab_switching'>Label Switching</h2><span id='topic+lab_switching'></span>

<h3>Description</h3>

<p>This function can be used to perturb a clustering vector in order to randomly associate certain individuals with another cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lab_switching(Z, p_out = 0.1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lab_switching_+3A_z">Z</code></td>
<td>
<p>a clustering vector</p>
</td></tr>
<tr><td><code id="lab_switching_+3A_p_out">p_out</code></td>
<td>
<p>a probability of perturbation for the clustering</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a perturbed clustering vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Z &lt;- sample(1:4,100,replace=TRUE)
p = 0.1
Z_pert &lt;- lab_switching(Z,p)
table("Initial clustering" = Z,"Perturbed clustering" = Z_pert)
</code></pre>

<hr>
<h2 id='log_Softmax'>log softmax of matrices (by row)</h2><span id='topic+log_Softmax'></span>

<h3>Description</h3>

<p>log softmax of matrices (by row)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_Softmax(log_X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="log_Softmax_+3A_log_x">log_X</code></td>
<td>
<p>a matrix of log(X)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>X with log_softmax function applied on each row
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
X &lt;- matrix(rnorm(15,mean=5),5,3)
log_X &lt;- log(X)
X_softmax &lt;-  log_Softmax(X)
</code></pre>

<hr>
<h2 id='Loss_BayesianMSBM'>mimiSBM Evidence Lower BOund</h2><span id='topic+Loss_BayesianMSBM'></span>

<h3>Description</h3>

<p>mimiSBM Evidence Lower BOund
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Loss_BayesianMSBM(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Loss_BayesianMSBM_+3A_params">params</code></td>
<td>
<p>a list of parameters of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>computation of the mimiSBM ELBO
</p>

<hr>
<h2 id='Mat_lien_alpha'>Create probality-component list for clustering per view component.</h2><span id='topic+Mat_lien_alpha'></span>

<h3>Description</h3>

<p>Create probality-component list for clustering per view component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Mat_lien_alpha(clusters, K_barre, K)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Mat_lien_alpha_+3A_clusters">clusters</code></td>
<td>
<p>list of link between final clustering and clustering per view component.</p>
</td></tr>
<tr><td><code id="Mat_lien_alpha_+3A_k_barre">K_barre</code></td>
<td>
<p>Number of clusters in the final clustering</p>
</td></tr>
<tr><td><code id="Mat_lien_alpha_+3A_k">K</code></td>
<td>
<p>Vector of size Q, indicate the number of clusters in each component.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>alpha :  probality-component list for clustering per view component.
</p>

<hr>
<h2 id='mimiSBM'>Mixture of Multilayer Integrator SBM (mimiSBM)</h2><span id='topic+mimiSBM'></span>

<h3>Description</h3>

<p>Model that allows both clustering of individuals and grouping of views by component.
This bayesian model estimates the probability of individuals belonging to each cluster (cluster crossing all views) and the membership component for all views.
In addition, the connectivity tensor between classes, conditional on the components, is also estimated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mimiSBM(
  A,
  Kset,
  Qset,
  beta_0 = 1/2,
  theta_0 = 1/2,
  eta_0 = 1/2,
  xi_0 = 1/2,
  criterion = "ILVB",
  tol = 0.001,
  iter_max = 10,
  n_init = 1,
  alternate = FALSE,
  Verbose = FALSE,
  eps_conv = 1e-04,
  type_init = "SBM"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mimiSBM_+3A_a">A</code></td>
<td>
<p>an array of dim=c(N,N,V)</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_kset">Kset</code></td>
<td>
<p>Set of number of clusters</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_qset">Qset</code></td>
<td>
<p>Set of number of components</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_beta_0">beta_0</code></td>
<td>
<p>hyperparameters for beta</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_theta_0">theta_0</code></td>
<td>
<p>hyperparameters for theta</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_eta_0">eta_0</code></td>
<td>
<p>hyperparameters for eta</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_xi_0">xi_0</code></td>
<td>
<p>hyperparameters for xi</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_criterion">criterion</code></td>
<td>
<p>model selection criterion, criterion=c(&quot;ILVB&quot;,&quot;ICL_approx&quot;,&quot;ICL_variationnel&quot;,&quot;ICL_exact&quot;)</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_tol">tol</code></td>
<td>
<p>convergence parameter on ELBO</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_iter_max">iter_max</code></td>
<td>
<p>maximal number of iteration of mimiSBM</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_n_init">n_init</code></td>
<td>
<p>number of initialization of the mimi algorithm.</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_alternate">alternate</code></td>
<td>
<p>boolean indicated if we put an M-step after each part of the E-step, after u optimization and after tau optimization. If not, we optimize u and tau and after the M-step is made.</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_verbose">Verbose</code></td>
<td>
<p>boolean for information on model fitting</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_eps_conv">eps_conv</code></td>
<td>
<p>parameter of convergence for tau.</p>
</td></tr>
<tr><td><code id="mimiSBM_+3A_type_init">type_init</code></td>
<td>
<p>select the type of initialization type_init=c(&quot;SBM&quot;,&quot;Kmeans&quot;,&quot;random&quot;)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The best model, conditionnally to the criterion, and its parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(42)
K = c(2,3); pi_k = rep(1/4,4) ; rho = rep(1/2,2)
res &lt;- rSMB_partition(N = 50,V = 5,K = K ,pi_k = pi_k ,rho = rho,p_switch = 0.1)
A = res$simulation$A ; Kset = 4 ; Qset = 2
model &lt;- mimiSBM(A,Kset,Qset,n_init = 1, Verbose=FALSE)
</code></pre>

<hr>
<h2 id='multinomial_lbeta_function'>Calculation of Log multinomial Beta value.</h2><span id='topic+multinomial_lbeta_function'></span>

<h3>Description</h3>

<p>Calculation of Log multinomial Beta value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multinomial_lbeta_function(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multinomial_lbeta_function_+3A_x">x</code></td>
<td>
<p>a vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sum(lgamma(x[j])) - lgamma(sum(x))
</p>

<hr>
<h2 id='one_hot_errormachine'>One Hot Encoding with Error machine</h2><span id='topic+one_hot_errormachine'></span>

<h3>Description</h3>

<p>One Hot Encoding with Error machine
</p>


<h3>Usage</h3>

<pre><code class='language-R'>one_hot_errormachine(Z, size = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="one_hot_errormachine_+3A_z">Z</code></td>
<td>
<p>a vector of size N, where Z[i] value indicate the cluster membership of observation i.</p>
</td></tr>
<tr><td><code id="one_hot_errormachine_+3A_size">size</code></td>
<td>
<p>optional parameter, indicating the number of classes (avoid some empty class problems).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Z a matrix N x K One-Hot-Encoded by rows, where K is the number of clusters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Z &lt;- sample(1:4,10,replace=TRUE)
Z_OHE &lt;- one_hot_errormachine(Z)
print(Z_OHE)
</code></pre>

<hr>
<h2 id='partition_K_barre'>Create a link between final clustering and clustering per view component.</h2><span id='topic+partition_K_barre'></span>

<h3>Description</h3>

<p>Create a link between final clustering and clustering per view component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partition_K_barre(K_barre, K)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="partition_K_barre_+3A_k_barre">K_barre</code></td>
<td>
<p>Number of clusters in the final clustering</p>
</td></tr>
<tr><td><code id="partition_K_barre_+3A_k">K</code></td>
<td>
<p>Vector of size Q, indicate the number of clusters in each component. K[q] &lt;= K_barre for all q</p>
</td></tr>
</table>


<h3>Value</h3>

<p>cluster : a list of link between final clustering and clustering per view component.
</p>

<hr>
<h2 id='plot_adjacency'>Plot adjacency matrices</h2><span id='topic+plot_adjacency'></span>

<h3>Description</h3>

<p>A function to plot each adjacency matrices defined by the thrid dimension of an array, and plot the sum of all theses matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_adjacency(A)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_adjacency_+3A_a">A</code></td>
<td>
<p>an array with dim=c(N,N,V).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>

<hr>
<h2 id='rMSBM'>Simulate data from the mimiSBM generative model.</h2><span id='topic+rMSBM'></span>

<h3>Description</h3>

<p>Simulate data from the mimiSBM generative model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rMSBM(N, V, alpha_klq, pi_k, rho, sorted = TRUE, p_switch = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rMSBM_+3A_n">N</code></td>
<td>
<p>Number of individuals.</p>
</td></tr>
<tr><td><code id="rMSBM_+3A_v">V</code></td>
<td>
<p>Number of views.</p>
</td></tr>
<tr><td><code id="rMSBM_+3A_alpha_klq">alpha_klq</code></td>
<td>
<p>array of component-connection probability (K,K,Q).</p>
</td></tr>
<tr><td><code id="rMSBM_+3A_pi_k">pi_k</code></td>
<td>
<p>Vector of proportions of individuals across clusters.</p>
</td></tr>
<tr><td><code id="rMSBM_+3A_rho">rho</code></td>
<td>
<p>Vector of proportion of views across components.</p>
</td></tr>
<tr><td><code id="rMSBM_+3A_sorted">sorted</code></td>
<td>
<p>Boolean for simulation reordering (clusters and components membership).</p>
</td></tr>
<tr><td><code id="rMSBM_+3A_p_switch">p_switch</code></td>
<td>
<p>probability of label-switching, if NULL no perturbation between true clustering and the connectivity of individuals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the parameters of the simulation ($params), and
the simulations ($simulation).
</p>

<hr>
<h2 id='rSMB_partition'>Simulation of mixture multilayer Stochastick block model</h2><span id='topic+rSMB_partition'></span>

<h3>Description</h3>

<p>This simulation process assumes that we have partial information on the clustering within each view component, and that the final clustering of individuals depends on a combination of the clustering on each of the views.
In addition, we take into account possible label-switching: we consider that an individual belongs with a certain probability to the wrong class, thus disturbing the adjacency matrices and making the simulation more real and complex.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rSMB_partition(N, V, K, pi_k, rho, sorted = TRUE, p_switch = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rSMB_partition_+3A_n">N</code></td>
<td>
<p>Number of observations</p>
</td></tr>
<tr><td><code id="rSMB_partition_+3A_v">V</code></td>
<td>
<p>Number of views</p>
</td></tr>
<tr><td><code id="rSMB_partition_+3A_k">K</code></td>
<td>
<p>Vector of size Q, indicate the number of clusters in each component.</p>
</td></tr>
<tr><td><code id="rSMB_partition_+3A_pi_k">pi_k</code></td>
<td>
<p>Vector of proportions of observations across clusters.</p>
</td></tr>
<tr><td><code id="rSMB_partition_+3A_rho">rho</code></td>
<td>
<p>Vector of proportion of views across components.</p>
</td></tr>
<tr><td><code id="rSMB_partition_+3A_sorted">sorted</code></td>
<td>
<p>Boolean for simulation reordering (clusters and components membership).</p>
</td></tr>
<tr><td><code id="rSMB_partition_+3A_p_switch">p_switch</code></td>
<td>
<p>probability of label-switching, if NULL no perturbation between true clustering and the connectivity of individuals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the vignette for more information.
</p>


<h3>Value</h3>

<p>list with the parameters of the simulation ($params), and the simulations ($simulation).
</p>

<hr>
<h2 id='sort_Z'>Sort the clustering matrix</h2><span id='topic+sort_Z'></span>

<h3>Description</h3>

<p>Sort the clustering matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sort_Z(Z)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sort_Z_+3A_z">Z</code></td>
<td>
<p>a matrix N x K, with probabilities to belong of a cluster in rows for each observation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a sorted matrix
</p>

<hr>
<h2 id='transpo'>Transposition of an array</h2><span id='topic+transpo'></span>

<h3>Description</h3>

<p>Transposition of an array
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transpo(A)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="transpo_+3A_a">A</code></td>
<td>
<p>a array of dim= c(.,.,V)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A_transposed, the transposed array according the third dimension
</p>

<hr>
<h2 id='trig_sup'>Upper triangular Matrix/Array</h2><span id='topic+trig_sup'></span>

<h3>Description</h3>

<p>Upper triangular Matrix/Array
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trig_sup(A, transp = FALSE, diag = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trig_sup_+3A_a">A</code></td>
<td>
<p>a array or a squared matrix</p>
</td></tr>
<tr><td><code id="trig_sup_+3A_transp">transp</code></td>
<td>
<p>boolean, indicate if we need a transposition or not.</p>
</td></tr>
<tr><td><code id="trig_sup_+3A_diag">diag</code></td>
<td>
<p>boolean,  if True, diagonal is not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a array or a squared matrix, with only upper-triangular coefficients with non-zero values
</p>

<hr>
<h2 id='update_beta_bayesian'>Update of bayesian parameter beta</h2><span id='topic+update_beta_bayesian'></span>

<h3>Description</h3>

<p>Update of bayesian parameter beta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_beta_bayesian(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_beta_bayesian_+3A_params">params</code></td>
<td>
<p>list of parameters of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>params with beta updated
</p>

<hr>
<h2 id='update_eta_bayesian'>Update of bayesian parameter eta</h2><span id='topic+update_eta_bayesian'></span>

<h3>Description</h3>

<p>Update of bayesian parameter eta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_eta_bayesian(A, params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_eta_bayesian_+3A_a">A</code></td>
<td>
<p>an array of dim=c(N,N,V)</p>
</td></tr>
<tr><td><code id="update_eta_bayesian_+3A_params">params</code></td>
<td>
<p>list of parameters of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>params with eta updated
</p>

<hr>
<h2 id='update_tau_bayesian'>Update of bayesian parameter tau</h2><span id='topic+update_tau_bayesian'></span>

<h3>Description</h3>

<p>Update of bayesian parameter tau
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_tau_bayesian(A, params, eps_conv = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_tau_bayesian_+3A_a">A</code></td>
<td>
<p>an array of dim=c(N,N,V)</p>
</td></tr>
<tr><td><code id="update_tau_bayesian_+3A_params">params</code></td>
<td>
<p>list of parameters of the model</p>
</td></tr>
<tr><td><code id="update_tau_bayesian_+3A_eps_conv">eps_conv</code></td>
<td>
<p>parameter of convergence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>params with tau updated
</p>

<hr>
<h2 id='update_theta_bayesian'>Update of bayesian parameter theta</h2><span id='topic+update_theta_bayesian'></span>

<h3>Description</h3>

<p>Update of bayesian parameter theta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_theta_bayesian(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_theta_bayesian_+3A_params">params</code></td>
<td>
<p>list of parameters of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>params with theta updated
</p>

<hr>
<h2 id='update_u_bayesian'>Update of bayesian parameter u</h2><span id='topic+update_u_bayesian'></span>

<h3>Description</h3>

<p>Update of bayesian parameter u
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_u_bayesian(A, params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_u_bayesian_+3A_a">A</code></td>
<td>
<p>an array of dim=c(N,N,V)</p>
</td></tr>
<tr><td><code id="update_u_bayesian_+3A_params">params</code></td>
<td>
<p>list of parameters of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>params with u updated
</p>

<hr>
<h2 id='update_xi_bayesian'>Update of bayesian parameter xi</h2><span id='topic+update_xi_bayesian'></span>

<h3>Description</h3>

<p>Update of bayesian parameter xi
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_xi_bayesian(A, params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_xi_bayesian_+3A_a">A</code></td>
<td>
<p>an array of dim=c(N,N,V)</p>
</td></tr>
<tr><td><code id="update_xi_bayesian_+3A_params">params</code></td>
<td>
<p>list of parameters of the model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>params with xi updated
</p>

<hr>
<h2 id='VBEM_step'>Variational Bayes Expectation Maximization</h2><span id='topic+VBEM_step'></span>

<h3>Description</h3>

<p>Variational Bayes Expectation Maximization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VBEM_step(A, params, alternate = TRUE, eps_conv = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VBEM_step_+3A_a">A</code></td>
<td>
<p>an array of dim=c(N,N,V)</p>
</td></tr>
<tr><td><code id="VBEM_step_+3A_params">params</code></td>
<td>
<p>list of parameters of the model</p>
</td></tr>
<tr><td><code id="VBEM_step_+3A_alternate">alternate</code></td>
<td>
<p>boolean indicated if we put an M-step after each part of the E-step, after u optimization and after tau optimization. If not, we optimize u and tau and after the M-step is made.</p>
</td></tr>
<tr><td><code id="VBEM_step_+3A_eps_conv">eps_conv</code></td>
<td>
<p>parameter of convergence for tau.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>params with updated parameters.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
