<!DOCTYPE html><html><head><title>Help for package cif</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cif}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#crossing'><p>computes at which observation a vector y crosses ref for the first time</p></a></li>
<li><a href='#diffe'><p>appends NA at beginning of diff(y)</p></a></li>
<li><a href='#ec.companion'><p>computes companion matrix of the VAR</p></a></li>
<li><a href='#ec.datadet1'><p>prepares deterministics D^(1)</p></a></li>
<li><a href='#ec.datadet2'><p>prepares deterministics D^(2)</p></a></li>
<li><a href='#ec.datalag'><p>prepares Dy y_1 Dy_1 ... Dy_nlag-1 for estimation</p></a></li>
<li><a href='#ec.EG1'><p>estimates the VECM with the 2-stage procedure of Engle &amp; Granger</p></a></li>
<li><a href='#ec.gfd'><p>plots forecasts of difference with confidence bars</p></a></li>
<li><a href='#ec.gfl'><p>plots level forecasts with confidence bars</p></a></li>
<li><a href='#ec.gfld'><p>ec.gfld plots forecasts of levels and difference with confidence bars</p></a></li>
<li><a href='#ec.ifp'><p>Computes Indices of Forecast Performance</p></a></li>
<li><a href='#ec.main'><p>Forecast with Vector Error Correction Model</p></a></li>
<li><a href='#ec.plotfor'><p>plots forecasts</p></a></li>
<li><a href='#ec.plotroots'><p>Companion matrix of the VAR</p></a></li>
<li><a href='#ec.predict'><p>produces predictions for the VECM via its VAR companion form</p></a></li>
<li><a href='#ec.searchbreaks'><p>search for breaks dates for given q (=1,2,3,4)</p></a></li>
<li><a href='#iculomb'><p>Data from Italian Civil Protection</p></a></li>
<li><a href='#lagn'><p>lag j of matrix or vector y</p></a></li>
<li><a href='#listsize'><p>listsize number of terms in the search for 1,2,3,4 number of breaks</p></a></li>
<li><a href='#mls'><p>Multivariate Least-Squares regression</p></a></li>
<li><a href='#summary.cif'><p>summary function for cif</p></a></li>
<li><a href='#Wald.mls'><p>Wald test for Multivariate Least-Squares regression</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Cointegrated ICU Forecasting</td>
</tr>
<tr>
<td>Description:</td>
<td>Set of forecasting tools to predict ICU beds using a Vector Error Correction model with a single cointegrating vector. Method described in  Berta, P. Lovaglio, P.G. Paruolo, P. Verzillo, S., 2020. "Real Time Forecasting of Covid-19 Intensive Care Units demand" Health, Econometrics and Data Group (HEDG) Working Papers 20/16, HEDG, Department of Economics, University of York, <a href="https://www.york.ac.uk/media/economics/documents/hedg/workingpapers/2020/2016.pdf">https://www.york.ac.uk/media/economics/documents/hedg/workingpapers/2020/2016.pdf</a>. </td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-03-01</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paolo Paruolo &lt;Paolo.PARUOLO@ec.europa.eu&gt;</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, lubridate, graphics, grDevices</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-01 10:09:19 UTC; paoloberta</td>
</tr>
<tr>
<td>Author:</td>
<td>Paolo Berta [aut],
  Paolo Paruolo <a href="https://orcid.org/0000-0002-3982-4889"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Stefano Verzillo [ctb],
  Pietro Giorgio Lovaglio [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-01 16:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='crossing'>computes at which observation a vector y crosses ref for the first time</h2><span id='topic+crossing'></span>

<h3>Description</h3>

<p>Computes at which observation vector yfor crosses yref for the first time if it is not crossed, then 0 is returned
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossing(yfor, ref = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crossing_+3A_yfor">yfor</code></td>
<td>
<p>yfor is either a vector and a matrix</p>
</td></tr>
<tr><td><code id="crossing_+3A_ref">ref</code></td>
<td>
<p>ref is the refence value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>whensign, a matrix with observation number at which there is crossing
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='diffe'>appends NA at beginning of diff(y)</h2><span id='topic+diffe'></span>

<h3>Description</h3>

<p>appends NA at beginning of diff(y) and creates column names accordingly when y is either a vector and a matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diffe(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diffe_+3A_y">y</code></td>
<td>
<p>either a vector and a matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dy contains the differences of y, with NA appended at the start
</p>


<h3>Author(s)</h3>

<p>P. Paruolo
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='ec.companion'>computes companion matrix of the VAR</h2><span id='topic+ec.companion'></span>

<h3>Description</h3>

<p>builds the companion matrix of the VAR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.companion(est, p = 2, nlag = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.companion_+3A_est">est</code></td>
<td>
<p>is the output of ec.EG1.R</p>
</td></tr>
<tr><td><code id="ec.companion_+3A_p">p</code></td>
<td>
<p>(positive integer) is the dimension of the VAR</p>
</td></tr>
<tr><td><code id="ec.companion_+3A_nlag">nlag</code></td>
<td>
<p>(positive integer) is the number of lags in the VAR</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mA companion matrix
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='ec.datadet1'>prepares deterministics D^(1)</h2><span id='topic+ec.datadet1'></span>

<h3>Description</h3>

<p>Prepares deterministic data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.datadet1(n, befpn, breaks)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.datadet1_+3A_n">n</code></td>
<td>
<p>is the number of obs in available data</p>
</td></tr>
<tr><td><code id="ec.datadet1_+3A_befpn">befpn</code></td>
<td>
<p>is a vector with (begtrim,endtrim,nforecast,npred,nhstar)</p>
</td></tr>
<tr><td><code id="ec.datadet1_+3A_breaks">breaks</code></td>
<td>
<p>is a vector of integers where the trend breaks should be</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matdet1 a matrix with the following columns (1_vec, t_vec) and (n+npred) rows
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='ec.datadet2'>prepares deterministics D^(2)</h2><span id='topic+ec.datadet2'></span>

<h3>Description</h3>

<p>Prepares deterministic dummies for de-meaned daily seasonal and difference point dummies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.datadet2(det1, booseas = NA, pntdates = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.datadet2_+3A_det1">det1</code></td>
<td>
<p>is the det term with constant and trend created by ec.datadet1.R</p>
</td></tr>
<tr><td><code id="ec.datadet2_+3A_booseas">booseas</code></td>
<td>
<p>is a boolean for daily seasonal dummies</p>
</td></tr>
<tr><td><code id="ec.datadet2_+3A_pntdates">pntdates</code></td>
<td>
<p>is a vector of integers where the point dummies should be</p>
</td></tr>
</table>


<h3>Value</h3>

<p>det2mat a matrix with the following columns (daily_seas, point_dummies) and n+npred rows
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='ec.datalag'>prepares Dy y_1 Dy_1 ... Dy_nlag-1 for estimation</h2><span id='topic+ec.datalag'></span>

<h3>Description</h3>

<p>Prepares data for estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.datalag(y, nlag = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.datalag_+3A_y">y</code></td>
<td>
<p>is the data matrix of variables in the VAR</p>
</td></tr>
<tr><td><code id="ec.datalag_+3A_nlag">nlag</code></td>
<td>
<p>is the number of lags in the VAR (min = 2)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ymat contains the folloiwing columns Dy y_1 Dy_1 ... Dy_nlag-1
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='ec.EG1'>estimates the VECM with the 2-stage procedure of Engle &amp; Granger</h2><span id='topic+ec.EG1'></span>

<h3>Description</h3>

<p>Estimates the EC with EG. Cointegration rank fixed at 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.EG1(det1, det2, ymat, npl, befpn, ndet, drop1 = NA, drop2 = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.EG1_+3A_det1">det1</code></td>
<td>
<p>deterministic matrix of constant(s) and trend(s)</p>
</td></tr>
<tr><td><code id="ec.EG1_+3A_det2">det2</code></td>
<td>
<p>deterministic matrix of seasonals and point dummies</p>
</td></tr>
<tr><td><code id="ec.EG1_+3A_ymat">ymat</code></td>
<td>
<p>matrix of lags</p>
</td></tr>
<tr><td><code id="ec.EG1_+3A_npl">npl</code></td>
<td>
<p>n, p, nlag</p>
</td></tr>
<tr><td><code id="ec.EG1_+3A_befpn">befpn</code></td>
<td>
<p>begtrim, endtrim, nforecast, npred</p>
</td></tr>
<tr><td><code id="ec.EG1_+3A_ndet">ndet</code></td>
<td>
<p>order of the model d(i,j)</p>
</td></tr>
<tr><td><code id="ec.EG1_+3A_drop1">drop1</code></td>
<td>
<p>selection of det1 regressors in first stage to drop</p>
</td></tr>
<tr><td><code id="ec.EG1_+3A_drop2">drop2</code></td>
<td>
<p>selection of det1 regressors in second stage to drop</p>
</td></tr>
</table>


<h3>Value</h3>

<p>out a list with estimates
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, P.G. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='ec.gfd'>plots forecasts of difference with confidence bars</h2><span id='topic+ec.gfd'></span>

<h3>Description</h3>

<p>plots forecasts of difference with confidence bars
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.gfd(obj, whichseries = 1, nsigma = 3, xvec, yvec, cal, lar = 0.025, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.gfd_+3A_obj">obj</code></td>
<td>
<p>output of ec.main</p>
</td></tr>
<tr><td><code id="ec.gfd_+3A_whichseries">whichseries</code></td>
<td>
<p>series number</p>
</td></tr>
<tr><td><code id="ec.gfd_+3A_nsigma">nsigma</code></td>
<td>
<p>how many standard deviations in confidence bars</p>
</td></tr>
<tr><td><code id="ec.gfd_+3A_xvec">xvec</code></td>
<td>
<p>vector of dates to place on x axis</p>
</td></tr>
<tr><td><code id="ec.gfd_+3A_yvec">yvec</code></td>
<td>
<p>vector of exp(y) values to display on y axis</p>
</td></tr>
<tr><td><code id="ec.gfd_+3A_cal">cal</code></td>
<td>
<p>calendar vector</p>
</td></tr>
<tr><td><code id="ec.gfd_+3A_lar">lar</code></td>
<td>
<p>length of arrows in error bars</p>
</td></tr>
<tr><td><code id="ec.gfd_+3A_...">...</code></td>
<td>
<p>other plot parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>does not return output, just creates a graph
</p>


<h3>Author(s)</h3>

<p>P. Paruolo,
</p>

<hr>
<h2 id='ec.gfl'>plots level forecasts with confidence bars</h2><span id='topic+ec.gfl'></span>

<h3>Description</h3>

<p>plots level forecasts with confidence bars
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.gfl(obj, whichseries = 1, nsigma = 3, xvec, yvec, cal, lar = 0.025, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.gfl_+3A_obj">obj</code></td>
<td>
<p>output of ec.main</p>
</td></tr>
<tr><td><code id="ec.gfl_+3A_whichseries">whichseries</code></td>
<td>
<p>series number</p>
</td></tr>
<tr><td><code id="ec.gfl_+3A_nsigma">nsigma</code></td>
<td>
<p>how many standard deviations in confidence bars</p>
</td></tr>
<tr><td><code id="ec.gfl_+3A_xvec">xvec</code></td>
<td>
<p>vector of dates to place on x axis</p>
</td></tr>
<tr><td><code id="ec.gfl_+3A_yvec">yvec</code></td>
<td>
<p>vector of exp(y) values to display on y axis</p>
</td></tr>
<tr><td><code id="ec.gfl_+3A_cal">cal</code></td>
<td>
<p>calendar vector</p>
</td></tr>
<tr><td><code id="ec.gfl_+3A_lar">lar</code></td>
<td>
<p>length of arrows in error bars</p>
</td></tr>
<tr><td><code id="ec.gfl_+3A_...">...</code></td>
<td>
<p>other plot parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>does not return output, just creates a graph
</p>


<h3>Author(s)</h3>

<p>P. Paruolo
</p>

<hr>
<h2 id='ec.gfld'>ec.gfld plots forecasts of levels and difference with confidence bars</h2><span id='topic+ec.gfld'></span>

<h3>Description</h3>

<p>plots forecasts of levels and difference with confidence bars
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.gfld(
  obj,
  whichseries = 1,
  nsigma = 3,
  jointboo = TRUE,
  epsboo = TRUE,
  filename = "whatever",
  xvec,
  yvec,
  cal,
  lar = 0.025,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.gfld_+3A_obj">obj</code></td>
<td>
<p>output of ec.main</p>
</td></tr>
<tr><td><code id="ec.gfld_+3A_whichseries">whichseries</code></td>
<td>
<p>series number</p>
</td></tr>
<tr><td><code id="ec.gfld_+3A_nsigma">nsigma</code></td>
<td>
<p>how many standard deviations in confidence bars</p>
</td></tr>
<tr><td><code id="ec.gfld_+3A_jointboo">jointboo</code></td>
<td>
<p>boolean: TRUE if 1x2 graph, FALSE otherwise</p>
</td></tr>
<tr><td><code id="ec.gfld_+3A_epsboo">epsboo</code></td>
<td>
<p>boolean: TRUE eps graph, FALSE pdf graph</p>
</td></tr>
<tr><td><code id="ec.gfld_+3A_filename">filename</code></td>
<td>
<p>string, name of the file (no extension)</p>
</td></tr>
<tr><td><code id="ec.gfld_+3A_xvec">xvec</code></td>
<td>
<p>vector of dates to place on x axis</p>
</td></tr>
<tr><td><code id="ec.gfld_+3A_yvec">yvec</code></td>
<td>
<p>vector of exp(y) values to display on y axis</p>
</td></tr>
<tr><td><code id="ec.gfld_+3A_cal">cal</code></td>
<td>
<p>calendar vector</p>
</td></tr>
<tr><td><code id="ec.gfld_+3A_lar">lar</code></td>
<td>
<p>length of arrows in error bars</p>
</td></tr>
<tr><td><code id="ec.gfld_+3A_...">...</code></td>
<td>
<p>other plot parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>does not return output, just creates a double graph
</p>


<h3>Author(s)</h3>

<p>P. Paruolo
</p>

<hr>
<h2 id='ec.ifp'>Computes Indices of Forecast Performance</h2><span id='topic+ec.ifp'></span>

<h3>Description</h3>

<p>indices of forecast performance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.ifp(afdlin, rwsigma, rwabsmean, kval = 1.959964)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.ifp_+3A_afdlin">afdlin</code></td>
<td>
<p>actual + forecast values + fcse</p>
</td></tr>
<tr><td><code id="ec.ifp_+3A_rwsigma">rwsigma</code></td>
<td>
<p>standard deviation of Random Walk in sample</p>
</td></tr>
<tr><td><code id="ec.ifp_+3A_rwabsmean">rwabsmean</code></td>
<td>
<p>mean absolute deviation of Random Walk in sample</p>
</td></tr>
<tr><td><code id="ec.ifp_+3A_kval">kval</code></td>
<td>
<p>how many se to use, default kval = 1.959964</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of indices of forecast performance
1: index for model forecast
0: index for Random Walk forecast
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='ec.main'>Forecast with Vector Error Correction Model</h2><span id='topic+ec.main'></span>

<h3>Description</h3>

<p>This function estimate VECM model. Selects begtrim and entrim period, define lag and run.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.main(
  y,
  ndet = c(2, 1),
  nlag,
  befpn,
  breaks = NA,
  booseas = NA,
  pntdates = NA,
  drop1 = NA,
  drop2 = NA,
  cal,
  kval = 1.959964
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.main_+3A_y">y</code></td>
<td>
<p>matrix with time across rows and variables in columns</p>
</td></tr>
<tr><td><code id="ec.main_+3A_ndet">ndet</code></td>
<td>
<p>vector of lenght 3, (i,j,q): i for EG1-st stage, j for EG-2nd stage, q number of breaks
i,j=0 no deterministics
i,j=1 constant
i,j=2 constant and trend</p>
</td></tr>
<tr><td><code id="ec.main_+3A_nlag">nlag</code></td>
<td>
<p>number of lags in the VAR</p>
</td></tr>
<tr><td><code id="ec.main_+3A_befpn">befpn</code></td>
<td>
<p>begtrim, endtrim, nforecast, npred</p>
</td></tr>
<tr><td><code id="ec.main_+3A_breaks">breaks</code></td>
<td>
<p>vector with observation numbers for T1,T2,...</p>
</td></tr>
<tr><td><code id="ec.main_+3A_booseas">booseas</code></td>
<td>
<p>boolean =T if seasonal dummies, =F otherwise</p>
</td></tr>
<tr><td><code id="ec.main_+3A_pntdates">pntdates</code></td>
<td>
<p>vector with observation numbers for point dummies</p>
</td></tr>
<tr><td><code id="ec.main_+3A_drop1">drop1</code></td>
<td>
<p>selection of det1 regressors in first stage to drop</p>
</td></tr>
<tr><td><code id="ec.main_+3A_drop2">drop2</code></td>
<td>
<p>selection of det1 regressors in second stage to drop</p>
</td></tr>
<tr><td><code id="ec.main_+3A_cal">cal</code></td>
<td>
<p>calendar for the y matrix</p>
</td></tr>
<tr><td><code id="ec.main_+3A_kval">kval</code></td>
<td>
<p>how many se to use, default kval=1.959964</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results Output contains the a set of estimates and forecasting results.
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='ec.plotfor'>plots forecasts</h2><span id='topic+ec.plotfor'></span>

<h3>Description</h3>

<p>plot actual and forecast intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.plotfor(
  y,
  x = NA,
  lcolact = NA,
  lcolfor = NA,
  ltypefor = NA,
  polycol = NA,
  myylim = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.plotfor_+3A_y">y</code></td>
<td>
<p>actual values and forecasts (point forecast, lower bound, upper bound)</p>
</td></tr>
<tr><td><code id="ec.plotfor_+3A_x">x</code></td>
<td>
<p>time calendar</p>
</td></tr>
<tr><td><code id="ec.plotfor_+3A_lcolact">lcolact</code></td>
<td>
<p>color actual (scalar)</p>
</td></tr>
<tr><td><code id="ec.plotfor_+3A_lcolfor">lcolfor</code></td>
<td>
<p>color forecasts</p>
</td></tr>
<tr><td><code id="ec.plotfor_+3A_ltypefor">ltypefor</code></td>
<td>
<p>type forecasts</p>
</td></tr>
<tr><td><code id="ec.plotfor_+3A_polycol">polycol</code></td>
<td>
<p>color polygons
if one wishes to have different lcolfor,ltypefor,polycol
by week &gt; make linecol, linetype, polycol vectors, indexed by week</p>
</td></tr>
<tr><td><code id="ec.plotfor_+3A_myylim">myylim</code></td>
<td>
<p>vector with min and max for y axis</p>
</td></tr>
<tr><td><code id="ec.plotfor_+3A_...">...</code></td>
<td>
<p>other plot parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>does not return output, just creates a graph
</p>


<h3>Author(s)</h3>

<p>P. Paruolo
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='ec.plotroots'>Companion matrix of the VAR</h2><span id='topic+ec.plotroots'></span>

<h3>Description</h3>

<p>plots roots and the unit circle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.plotroots(roots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.plotroots_+3A_roots">roots</code></td>
<td>
<p>are the roots of the companion matrix, see ec.companion.R</p>
</td></tr>
</table>


<h3>Value</h3>

<p>does not return output, just creates a graph
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='ec.predict'>produces predictions for the VECM via its VAR companion form</h2><span id='topic+ec.predict'></span>

<h3>Description</h3>

<p>Predicts both in-sample (1 step ahead) and out-of-sample (1 step ahead and dynamic forecasts)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.predict(est, det1, det2, ymat, npl, befpn, ndet, cal, kval = 1.959964)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.predict_+3A_est">est</code></td>
<td>
<p>output from estimation by ec.EG1.R</p>
</td></tr>
<tr><td><code id="ec.predict_+3A_det1">det1</code></td>
<td>
<p>deterministic matrix of constant(s) and trend(s)</p>
</td></tr>
<tr><td><code id="ec.predict_+3A_det2">det2</code></td>
<td>
<p>deterministic matrix of seasonals and point dummies</p>
</td></tr>
<tr><td><code id="ec.predict_+3A_ymat">ymat</code></td>
<td>
<p>matrix of lags</p>
</td></tr>
<tr><td><code id="ec.predict_+3A_npl">npl</code></td>
<td>
<p>n, p, nlag</p>
</td></tr>
<tr><td><code id="ec.predict_+3A_befpn">befpn</code></td>
<td>
<p>begtrim, endtrim, nforecast, npred, nhstar</p>
</td></tr>
<tr><td><code id="ec.predict_+3A_ndet">ndet</code></td>
<td>
<p>order of the model d(i,j)</p>
</td></tr>
<tr><td><code id="ec.predict_+3A_cal">cal</code></td>
<td>
<p>calendar, should match the number of rows in ymat</p>
</td></tr>
<tr><td><code id="ec.predict_+3A_kval">kval</code></td>
<td>
<p>how many se to use, default kval= 1.959964</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with contains:
afl (actual and 1 step ahead fitted levels)
afd (actual and 1 step ahead fitted differences)
fit (1 step ahead fit)
dynpred (dynamic predictions)
mAt mB (companion matrix and selection of it)
Sigmah (Sigmah for dyn forecasts)
forstartdate (starting date for dyn forecast)
outcal  (dates for the prediction)
h1star (h1star)
cspred (table with change in sign of pred for Dx_1)
indexfa (indices of forecast accuracy)
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='ec.searchbreaks'>search for breaks dates for given q (=1,2,3,4)</h2><span id='topic+ec.searchbreaks'></span>

<h3>Description</h3>

<p>Search for location of break points in 1st-stage of Engle-Granger
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ec.searchbreaks(qse, ymat, npl, befpn, ndet, gfillmin = 10, fixed = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ec.searchbreaks_+3A_qse">qse</code></td>
<td>
<p>q: number of (additional) breaks, s: start date for search, e: end date for search</p>
</td></tr>
<tr><td><code id="ec.searchbreaks_+3A_ymat">ymat</code></td>
<td>
<p>matrix of lags</p>
</td></tr>
<tr><td><code id="ec.searchbreaks_+3A_npl">npl</code></td>
<td>
<p>n, p, nlag</p>
</td></tr>
<tr><td><code id="ec.searchbreaks_+3A_befpn">befpn</code></td>
<td>
<p>begtrim, endtrim, nforecast, npred</p>
</td></tr>
<tr><td><code id="ec.searchbreaks_+3A_ndet">ndet</code></td>
<td>
<p>order of the model d(i,j)</p>
</td></tr>
<tr><td><code id="ec.searchbreaks_+3A_gfillmin">gfillmin</code></td>
<td>
<p>gfill value</p>
</td></tr>
<tr><td><code id="ec.searchbreaks_+3A_fixed">fixed</code></td>
<td>
<p>vector of breaks to be taken as fixed (not between s=start and e=end)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>out list with break dates and values of regression average sum of squares
</p>


<h3>Author(s)</h3>

<p>P. Paruolo
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='iculomb'>Data from Italian Civil Protection</h2><span id='topic+iculomb'></span>

<h3>Description</h3>

<p>Data from Italian Civil Protection
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(iculomb)
</code></pre>


<h3>Format</h3>

<p>A dataset including 324 obs and 24 columns.
</p>


<h3>Source</h3>

<p><a href="https://github.com/pcm-dpc/COVID-19/">https://github.com/pcm-dpc/COVID-19/</a>
</p>


<h3>References</h3>

<p>Italian Civil Protection
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(iculomb)

</code></pre>

<hr>
<h2 id='lagn'>lag j of matrix or vector y</h2><span id='topic+lagn'></span>

<h3>Description</h3>

<p>lagn(y,j,fill=NA) produces lag j of matrix or vector y, with fill in missing j cells
REM: alternative to &quot;lead-lag&quot; dplyr which applies to vector y
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lagn(y, j, fill = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lagn_+3A_y">y</code></td>
<td>
<p>column vector or matrix</p>
</td></tr>
<tr><td><code id="lagn_+3A_j">j</code></td>
<td>
<p>number of lags</p>
</td></tr>
<tr><td><code id="lagn_+3A_fill">fill</code></td>
<td>
<p>value to be used to fill the missing values at the beginning, default = NA</p>
</td></tr>
</table>


<h3>Value</h3>

<p>y lagged j cells, with fill in the missing j positions
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='listsize'>listsize number of terms in the search for 1,2,3,4 number of breaks</h2><span id='topic+listsize'></span>

<h3>Description</h3>

<p>computes length-4 vector with number of terms in the search for 1,2,3,4 number of breaks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listsize(myT, gfill, start)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="listsize_+3A_myt">myT</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="listsize_+3A_gfill">gfill</code></td>
<td>
<p>number of gap periods</p>
</td></tr>
<tr><td><code id="listsize_+3A_start">start</code></td>
<td>
<p>beginning</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of 4 elements, with the number of candidate models for 1,2,3,4 breaks
</p>


<h3>Author(s)</h3>

<p>P. Paruolo
</p>

<hr>
<h2 id='mls'>Multivariate Least-Squares regression</h2><span id='topic+mls'></span>

<h3>Description</h3>

<p>Multivariate Least-Squares regression y = x beta + u
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mls(y, x, df_flag = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mls_+3A_y">y</code></td>
<td>
<p>left hand side data matrix (one or more columns)</p>
</td></tr>
<tr><td><code id="mls_+3A_x">x</code></td>
<td>
<p>right hand side data matrix (one or more columns)</p>
</td></tr>
<tr><td><code id="mls_+3A_df_flag">df_flag</code></td>
<td>
<p>flag = TRUE for degrees of freedom correction for the variance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>out regression coefficients and related statistics
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='summary.cif'>summary function for cif</h2><span id='topic+summary.cif'></span>

<h3>Description</h3>

<p>Summary function for presize
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cif'
summary(object, ..., digits = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cif_+3A_object">object</code></td>
<td>
<p>is the name of the cif object created by cif</p>
</td></tr>
<tr><td><code id="summary.cif_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
<tr><td><code id="summary.cif_+3A_digits">digits</code></td>
<td>
<p>integer indicating the number of decimal places (round) or significant digits (signif) to be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns summary output from model estimation and forecasting
</p>


<h3>Author(s)</h3>

<p>P. Berta, P. Paruolo, S. Verzillo, PG. Lovaglio
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

<hr>
<h2 id='Wald.mls'>Wald test for Multivariate Least-Squares regression</h2><span id='topic+Wald.mls'></span>

<h3>Description</h3>

<p>Wald test for multivariate Least-Squares regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Wald.mls(mlsresults)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Wald.mls_+3A_mlsresults">mlsresults</code></td>
<td>
<p>output of mls, mlsresults&lt;-mls(y, x, df_flag)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>wald table of Wald tests on significance of single regressors and pvalues based on chi square distribution
</p>


<h3>Author(s)</h3>

<p>P. Paruolo
</p>


<h3>References</h3>

<p>Berta et al. 2020
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
