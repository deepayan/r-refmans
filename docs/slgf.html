<!DOCTYPE html><html lang="en"><head><title>Help for package slgf</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {slgf}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bottles'><p>Bottles data on filling amount of six bottles over five time points.</p></a></li>
<li><a href='#lymphoma'><p>Lymphoma data on genomic hybridization signal from six dogs with normal and tumor</p>
tissue samples taken.</a></li>
<li><a href='#maketall'><p>Converts a two-way layout into tall format with row and column index labels.</p></a></li>
<li><a href='#ms_slgf'><p>Bayesian Model Selection with Latent Group-Based Regression Effects and Heteroscedasticity</p></a></li>
<li><a href='#roadwear'><p>Roadwear data on four tires, each comprising three compounds,</p>
from a balanced incompleted block design.</a></li>
<li><a href='#smell'><p>Smell data on olfactory function by age group</p></a></li>
<li><a href='#textile'><p>Textile data on breaking strength by starch type and chip thickness</p></a></li>
<li><a href='#torque'><p>Locknut data on torque required to tighten a fixture by plating method</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Model Selection with Suspected Latent Grouping Factors</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-01</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the Bayesian model selection method with suspected latent 
    grouping factor methodology of Metzger and Franck (2020), 
    &lt;<a href="https://doi.org/10.1080%2F00401706.2020.1739561">doi:10.1080/00401706.2020.1739561</a>&gt;. SLGF detects latent 
    heteroscedasticity or group-based regression effects based on the levels of a 
    user-specified categorical predictor. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rdpack, numDeriv, utils</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, captioner, formatR, rcrossref, rmarkdown</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-19 21:51:26 UTC; metzger.181</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Metzger [aut, cre],
  Christopher Franck [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Metzger &lt;metzger.181@osu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-21 22:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bottles'>Bottles data on filling amount of six bottles over five time points.</h2><span id='topic+bottles'></span>

<h3>Description</h3>

<p>Ott and Snee (1973) analyzed the filled weight (weight) of bottles filled by
six machine heads (heads) over five time points (time).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bottles)
</code></pre>


<h3>Format</h3>

<p>A data frame with 30 rows and 3 variables:
</p>

<dl>
<dt>weight</dt><dd><p>the response, the weight of material filled into each bottle.</p>
</dd>
<dt>time</dt><dd><p>the time point of each filling.</p>
</dd>
<dt>heads</dt><dd><p>the head of the machine that fills the bottle.</p>
</dd>
</dl>



<h3>References</h3>

<p>Ott ER, Snee RD (1973).
&ldquo;Identifying useful differences in a multiple-head machine.&rdquo;
<em>Journal of Qualitym Technology</em>, <b>5</b>(2), 2&ndash;13.
</p>

<hr>
<h2 id='lymphoma'>Lymphoma data on genomic hybridization signal from six dogs with normal and tumor
tissue samples taken.</h2><span id='topic+lymphoma'></span>

<h3>Description</h3>

<p>Franck et. al. (2013) analyzes the genomic hybridization signal
measured from normal and tumor tissue samples taken from six dogs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lymphoma)
</code></pre>


<h3>Format</h3>

<p>A data frame with 6 rows and 2 variables:
</p>

<dl>
<dt>V1</dt><dd><p>the signals from the normal tissue samples.</p>
</dd>
<dt>V2</dt><dd><p>the signals from the tumor tissue samples.</p>
</dd>
</dl>



<h3>References</h3>

<p>Franck CT, Nielsen DM, Osborne JA (2013).
&ldquo;A method for detecting hidden additivity in two-factor unreplicated experiments.&rdquo;
<em>Computational Statistics &amp; Data Analysis</em>, <b>67</b>(Supplement C), 95 - 104.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2013.05.002">doi:10.1016/j.csda.2013.05.002</a>.
</p>

<hr>
<h2 id='maketall'>Converts a two-way layout into tall format with row and column index labels.</h2><span id='topic+maketall'></span>

<h3>Description</h3>

<p><code>maketall</code> Converts a two-way layout into tall format with row and column index labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maketall(data_matrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="maketall_+3A_data_matrix">data_matrix</code></td>
<td>
<p>an r by c data matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>maketall</code> returns a data frame containing the original observations, row labels, and column labels.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(slgf)
data(lymphoma)
maketall(lymphoma)

</code></pre>

<hr>
<h2 id='ms_slgf'>Bayesian Model Selection with Latent Group-Based Regression Effects and Heteroscedasticity</h2><span id='topic+ms_slgf'></span>

<h3>Description</h3>

<p><code>ms_slgf</code> Implements the model selection method proposed by (Metzger and Franck 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ms_slgf(
  dataf,
  response,
  lgf_beta,
  min_levels_beta = 1,
  lgf_Sigma,
  min_levels_Sigma = 1,
  same_scheme = TRUE,
  usermodels,
  het = rep(0, length(usermodels)),
  prior = "flat",
  m0 = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ms_slgf_+3A_dataf">dataf</code></td>
<td>
<p>A data frame containing a continuous response, at least one categorical predictor, and any other covariates of interest. This data frame should not contain column names with the character string <code>group</code>.</p>
</td></tr>
<tr><td><code id="ms_slgf_+3A_response">response</code></td>
<td>
<p>A character string indicating the column of <code>dataf</code> that contains the response.</p>
</td></tr>
<tr><td><code id="ms_slgf_+3A_lgf_beta">lgf_beta</code></td>
<td>
<p>An optional character string indicating the column of 'dataf' that contains the suspected latent grouping factor (SLGF) for the regression effects.</p>
</td></tr>
<tr><td><code id="ms_slgf_+3A_min_levels_beta">min_levels_beta</code></td>
<td>
<p>A numeric value indicating the minimum number of levels of 'lgf_beta' that can comprise a group. Defaults to 1.</p>
</td></tr>
<tr><td><code id="ms_slgf_+3A_lgf_sigma">lgf_Sigma</code></td>
<td>
<p>An optional character string indicating the column of 'dataf' that contains the suspected latent grouping factor (SLGF) for the residual variances.</p>
</td></tr>
<tr><td><code id="ms_slgf_+3A_min_levels_sigma">min_levels_Sigma</code></td>
<td>
<p>A numeric value indicating the minimum number of levels of 'lgf_Sigma' that can comprise a group. Defaults to 1.</p>
</td></tr>
<tr><td><code id="ms_slgf_+3A_same_scheme">same_scheme</code></td>
<td>
<p>A Boolean operator indicating whether the schemes for 'lgf_beta' and 'lgf_Sigma' must be the same.</p>
</td></tr>
<tr><td><code id="ms_slgf_+3A_usermodels">usermodels</code></td>
<td>
<p>A list of length <code>M</code> where each element contains a string of *R* class <code>formula</code> or <code>character</code> indicating the models to consider. The term <code>group</code> should be used to replace the name of the SLGF in models with group-based regression effects.</p>
</td></tr>
<tr><td><code id="ms_slgf_+3A_het">het</code></td>
<td>
<p>A vector of 0s and 1s of length <code>M</code>. If the mth element of <code>het</code> is 0, then the mth model of <code>usermodels</code> is considered in a homoscedastic context only; if the mth element of <code>het</code> is 1, the mth model of <code>usermodels</code> is considered in both homoscedastic and heteroscedastic contexts.</p>
</td></tr>
<tr><td><code id="ms_slgf_+3A_prior">prior</code></td>
<td>
<p>A character string <code>"flat"</code> or <code>"zs"</code> indicating whether to implement the flat or Zellner-Siow mixture g-prior on regression effects, respectively. Defaults to <code>"flat"</code>.</p>
</td></tr>
<tr><td><code id="ms_slgf_+3A_m0">m0</code></td>
<td>
<p>An integer value indicating the minimum training sample size. Defaults to NULL. If no value is provided, the lowest value that leads to convergence for all considered posterior model probabilities will be used. If the value provided is too low for convergence, it will be increased automatically.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ms_slgf</code> returns a list of five elements if the flat prior is used, and six elements if the Zellner-Siow mixture g-prior is used:<br />
1) <code>models</code>, an <code>M</code> by 7 matrix where columns contain the model selection results and information for each model, including: <br />
- <code>Model</code>, the formula associated with each model; <br />
- <code>Scheme.beta</code>, the grouping scheme associated with the fixed effects; <br />
- <code>Scheme.Sigma</code>, the grouping scheme associated with the variances; <br />
- <code>Log-Marginal</code>, the fractional log-marginal likelihood associated with each model; <br />
- <code>FmodProb</code>, the fractional posterior probability associated with each model; <br />
- <code>ModPrior</code>, the prior assigned to each model; <br />
- <code>Cumulative</code>, the cumulative fractional posterior probability associated with a given model and the previous models; <br />
2) <code>class_probabilities</code>, a vector containing cumulative posterior probabilities associated with each model class; <br />
3) <code>coefficients</code>, MLEs for each model's regression effects; <br />
4) <code>variances</code>, MLEs based on concentrated likelihood for each model's variance(s); <br />
5) <code>gs</code>, MLEs based on concentrated likelihood for each model's <code>g</code>; only included if <code>prior="zs"</code>.
</p>


<h3>Author(s)</h3>

<p>Thomas A. Metzger and Christopher T. Franck
</p>


<h3>References</h3>

<p>Metzger TA, Franck CT (2019).
&ldquo;Detection of latent heteroscedasticity and group-based regression effects in linear models via Bayesian model selection.&rdquo;
<em>arXiv e-prints</em>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Analyze the smell and textile data sets.

library(numDeriv)


data(smell)
out_smell &lt;- ms_slgf(dataf = smell, response = "olf", het=c(1,1),
                     lgf_beta = "agecat", lgf_Sigma = "agecat",
                     same_scheme=TRUE, min_levels_beta=1, min_levels_Sigma=1,
                     usermodels = list("olf~agecat", "olf~group"), m0=4)
out_smell$models[1:5,]
out_smell$coefficients[[46]]
out_smell$variances[[46]]

# textile data set
data(textile)
out_textile &lt;- ms_slgf(dataf = textile, response = "strength",
                     lgf_beta = "starch", lgf_Sigma = "starch",
                     same_scheme=FALSE, min_levels_beta=1, min_levels_Sigma=1,
                     usermodels = list("strength~film+starch", "strength~film*starch",
                                       "strength~film+group", "strength~film*group"),
                     het=c(1,1,1,1), prior="flat", m0=8)
out_textile$models[1:5,c(1,2,3,5)]
out_textile$class_probabilities
out_textile$coefficients[31]
out_textile$variances[31]
</code></pre>

<hr>
<h2 id='roadwear'>Roadwear data on four tires, each comprising three compounds,
from a balanced incompleted block design.</h2><span id='topic+roadwear'></span>

<h3>Description</h3>

<p>Davies (1954) analyzes the wear on four tires, where each tire comprises
three distinct compounds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(roadwear)
</code></pre>


<h3>Format</h3>

<p>A data frame with 12 rows and 3 variables:
</p>

<dl>
<dt>abrasion</dt><dd><p>the measurement of abrasion.</p>
</dd>
<dt>compound</dt><dd><p>the compound from which each measurement was taken,
either A, B, C, or D.</p>
</dd>
<dt>tire</dt><dd><p>the tire from which each measurement was taken,
either 1, 2, 3, or 4.</p>
</dd>
</dl>



<h3>References</h3>

<p>Davies OL (1954).
<em>The Design and Analysis of Industrial Experiments</em>.
Oliver and Boyd, London.
</p>

<hr>
<h2 id='smell'>Smell data on olfactory function by age group</h2><span id='topic+smell'></span>

<h3>Description</h3>

<p>O'Brien and Heft (1995) studied the University of Pennsylvania Smell
Identification Test (UPSIT). 180 subjects of different age groups were
asked to describe 40 different odors. Olfactory index was quantified by
the Freeman-Tukey modified arcsine transformation on the proportion of
correctly identified odors. Subjects were divided into five age groups:
group 1 if age 2 or younger; group 2 if between ages 26 and 40; group 3
if between ages 41 and 55; group 4 if between ages 56 and 70; and group
5 if older than 75.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(smell)
</code></pre>


<h3>Format</h3>

<p>A data frame with 180 rows and 2 variables:
</p>

<dl>
<dt>agecat</dt><dd><p>age category, from 1 to 5.</p>
</dd>
<dt>olf</dt><dd><p>olfactory function, measured as the Freeman-Tukey modified arcsine transformation on the proportion of
correctly identified odors.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://documentation.sas.com/?docsetId=statug&amp;docsetTarget=statug_glm_examples10.htm&amp;docsetVersion=15.2&amp;locale=zh-TW">SAS/STAT 15.2 User's Guide</a>
</p>


<h3>References</h3>

<p>OBrien RG, Heft MW (1995).
&ldquo;New Discrimination Indexes and Models for Studying Sensory Functioning in Aging.&rdquo;
<em>Journal of Applied Statistics</em>, <b>22</b>, 9-27.
</p>

<hr>
<h2 id='textile'>Textile data on breaking strength by starch type and chip thickness</h2><span id='topic+textile'></span>

<h3>Description</h3>

<p>Furry (1939) analyzes the breaking strength of a starch chip
as a function of the chipâ€™s thickness (measured in 10^-4 inches) and the type
of plant from which the starch was derived (corn, canna, or potato).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(textile)
</code></pre>


<h3>Format</h3>

<p>A data frame with 49 rows and 3 variables:
</p>

<dl>
<dt>strength</dt><dd><p>the response, the breaking strength.</p>
</dd>
<dt>film</dt><dd><p>the chip's film thickness, measured in 10^-4 inches.</p>
</dd>
<dt>starch</dt><dd><p>the chip's starch component: canna, corn, or potato</p>
</dd>
</dl>



<h3>References</h3>

<p>Furry MS (1939).
&ldquo;Breaking strength, elongation and folding endurance of films of starches and gelatin used in sizing.&rdquo;
<em>Technical Bulletin (United States Department of Agriculture)</em>, <b>674</b>, 1-36.
</p>

<hr>
<h2 id='torque'>Locknut data on torque required to tighten a fixture by plating method</h2><span id='topic+torque'></span>

<h3>Description</h3>

<p>Meek and Ozgur (1991) analyzes the torque required to strengthen a
fixture (bolt or mandrel) as a function of the fixture's plating method
(cadmium and wax, heat treating, and phosphate and oil, denoted CW, HT,
and PO, respectively).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(torque)
</code></pre>


<h3>Format</h3>

<p>A data frame with 60 rows and 3 variables:
</p>

<dl>
<dt>Torque</dt><dd><p>the response, the torque required to tighten the fixture.</p>
</dd>
<dt>Fixture</dt><dd><p>the type of fixture, bolt or mandrel.</p>
</dd>
<dt>Plating</dt><dd><p>the plating treatment, CW, HT, or PO.</p>
</dd>
</dl>



<h3>References</h3>

<p>Meek GE, Ozgur CO (1991).
&ldquo;Torque Variation Analysis.&rdquo;
<em>Journal of the Industrial Mathematics Society</em>, <b>41</b>, 1-16.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
