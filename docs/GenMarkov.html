<!DOCTYPE html><html><head><title>Help for package GenMarkov</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GenMarkov}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MMC_tpm'><p>Transition Probability Matrices</p></a></li>
<li><a href='#mmcx'><p>Non-homogeneous Multivariate Markov Chains</p></a></li>
<li><a href='#multi.mtd'><p>Estimation of Multivariate Markov Chains - MTD model</p></a></li>
<li><a href='#multi.mtd_probit'><p>Estimation of Multivariate Markov Chains: MTD - Probit Model</p></a></li>
<li><a href='#stockreturns'><p>Stock returns data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Markov Chains</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carolina Vasconcelos &lt;cvasconcelos@novaims.unl.pt&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides routines to estimate the Mixture Transition Distribution Model based on Raftery (1985) <a href="http://www.jstor.org/stable/2345788">http://www.jstor.org/stable/2345788</a> and Nicolau (2014) &lt;<a href="https://doi.org/10.1111%2Fsjos.12087">doi:10.1111/sjos.12087</a>&gt; specifications, for multivariate data. Additionally, provides a  function for the estimation of a new model for multivariate non-homogeneous Markov chains. This new specification, Generalized Multivariate Markov Chains (GMMC) was proposed by Carolina Vasconcelos and Bruno Damasio and considers (continuous or discrete) covariates exogenous to the Markov chain.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>alabama (&ge; 2015.3-1), fastDummies (&ge; 1.6.3), Hmisc (&ge;
4.5-0), matrixcalc (&ge; 1.0-3), maxLik (&ge; 1.4-8), nnet (&ge;
7.3-16), stats (&ge; 4.1.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-19 11:56:38 UTC; cvasconcelos</td>
</tr>
<tr>
<td>Author:</td>
<td>Carolina Vasconcelos [aut, cre],
  Bruno Damasio [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-19 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='MMC_tpm'>Transition Probability Matrices</h2><span id='topic+MMC_tpm'></span>

<h3>Description</h3>

<p>This functions allows to obtain the transition probability matrices for a specific value of x, considering the estimates obtained from <code><a href="#topic+mmcx">mmcx()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MMC_tpm(s, x, value = max(x), result)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MMC_tpm_+3A_s">s</code></td>
<td>
<p>numerical matrix with categorical data sequences</p>
</td></tr>
<tr><td><code id="MMC_tpm_+3A_x">x</code></td>
<td>
<p>exogeneous variable</p>
</td></tr>
<tr><td><code id="MMC_tpm_+3A_value">value</code></td>
<td>
<p>fixed value of x</p>
</td></tr>
<tr><td><code id="MMC_tpm_+3A_result">result</code></td>
<td>
<p>result from the function <code><a href="#topic+mmcx">mmcx()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a numerical array with the probability transition matrices for each equation
</p>


<h3>Author(s)</h3>

<p>Carolina Vasconcelos and Bruno Damásio
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stockreturns)
s &lt;- cbind(stockreturns$sp500, stockreturns$djia)
x &lt;- stockreturns$spread_1
res &lt;- mmcx(s, x, initial = c(1, 1))
tpm &lt;- MMC_tpm(s, x, value = max(x), result = res)
</code></pre>

<hr>
<h2 id='mmcx'>Non-homogeneous Multivariate Markov Chains</h2><span id='topic+mmcx'></span>

<h3>Description</h3>

<p>Estimates Multivariate Markov Chains that depend on a exogeneous variables.
The model is based on the Mixture Transition Distribution model, and considers non-homogeneous Markov Chains, instead of homogeneous Markov Chains as in Raftery (1985).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmcx(y, x, initial, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmcx_+3A_y">y</code></td>
<td>
<p>matrix of categorical data sequences</p>
</td></tr>
<tr><td><code id="mmcx_+3A_x">x</code></td>
<td>
<p>matrix of covariates</p>
</td></tr>
<tr><td><code id="mmcx_+3A_initial">initial</code></td>
<td>
<p>numerical vector of initial values.</p>
</td></tr>
<tr><td><code id="mmcx_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed down to <code><a href="alabama.html#topic+auglag">auglag()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the parameter estimates, standard-errors, z-statistics, p-values and the value of the log-likelihood function, for each equation.
</p>


<h3>Author(s)</h3>

<p>Carolina Vasconcelos and Bruno Damásio
</p>


<h3>References</h3>

<p>Raftery, A. E. (1985). A Model for High-Order Markov Chains. Journal of the Royal Statistical Society. Series B (Methodological), 47(3), 528-539. <a href="http://www.jstor.org/stable/2345788">http://www.jstor.org/stable/2345788</a>
</p>
<p>Ching, W. K., E. S. Fung, and M. K. Ng (2002). A multivariate Markov chain model for categorical data sequences and its applications in demand predictions. IMA Journal of Management Mathematics, 13(3), 187-199. <a href="https://doi.org/10.1093/imaman/13.3.187">doi:10.1093/imaman/13.3.187</a>
</p>


<h3>See Also</h3>

<p>Optimization is done through <code><a href="alabama.html#topic+auglag">auglag()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stockreturns)
s &lt;- cbind(stockreturns$sp500, stockreturns$djia)
x &lt;- stockreturns$spread_1
mmcx(s, x, initial = c(1, 1))

</code></pre>

<hr>
<h2 id='multi.mtd'>Estimation of Multivariate Markov Chains - MTD model</h2><span id='topic+multi.mtd'></span>

<h3>Description</h3>

<p>This function estimates the Mixture Distribution Model (Raftery (1985)) for Multivariate Markov Chains.
It considers Berchtold (2001) optimization algorithm for the parameters and estimates the probabilities transition matrices as proposed in Ching (2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi.mtd(y, deltaStop = 1e-04, is_constrained = TRUE, delta = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi.mtd_+3A_y">y</code></td>
<td>
<p>matrix of categorical data sequences</p>
</td></tr>
<tr><td><code id="multi.mtd_+3A_deltastop">deltaStop</code></td>
<td>
<p>value below which the optimization phases of the parameters stop</p>
</td></tr>
<tr><td><code id="multi.mtd_+3A_is_constrained">is_constrained</code></td>
<td>
<p>flag indicating whether the function will consider the usual set of constraints (usual set: <em>TRUE</em>, new set of constraints: <em>FALSE</em>).</p>
</td></tr>
<tr><td><code id="multi.mtd_+3A_delta">delta</code></td>
<td>
<p>the amount of change to increase/decrease in the parameters for each iteration of the optimization algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the parameter estimates, standard-errors, z-statistics, p-values and the value of the log-likelihood function, for each equation.
</p>


<h3>Note</h3>

<p>See details of the optimization procedure in <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/1467-9892.00231">Berchtold (2001)</a>.
</p>


<h3>References</h3>

<p>Raftery, A. E. (1985). A Model for High-Order Markov Chains. Journal of the Royal Statistical Society. Series B (Methodological), 47(3), 528-539. <a href="http://www.jstor.org/stable/2345788">http://www.jstor.org/stable/2345788</a>
</p>
<p>Berchtold, A. (2001). Estimation in the Mixture Transition Distribution Model. Journal of Time Series Analysis, 22(4), 379-397.<a href="https://doi.org/10.1111/1467-9892.00231">doi:10.1111/1467-9892.00231</a>
</p>
<p>Ching, W. K., E. S. Fung, and M. K. Ng (2002). A multivariate Markov chain model for categorical data sequences and its applications in demand predictions. IMA Journal of Management Mathematics, 13(3), 187-199. <a href="https://doi.org/10.1093/imaman/13.3.187">doi:10.1093/imaman/13.3.187</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stockreturns)
s &lt;- cbind(stockreturns$sp500, stockreturns$djia)
multi.mtd(s)
</code></pre>

<hr>
<h2 id='multi.mtd_probit'>Estimation of Multivariate Markov Chains: MTD - Probit Model</h2><span id='topic+multi.mtd_probit'></span>

<h3>Description</h3>

<p>Estimation of Multivariate Markov Chains through the proposed model by Nicolau (2014).
This model presents two attractive features: it is completely free of constraints, thereby facilitating the estimation procedure,
and it is more precise at estimating the transition probabilities of a multivariate or higher-order Markov chain than the Raftery's MTD model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi.mtd_probit(y, initial, nummethod = "bfgs")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi.mtd_probit_+3A_y">y</code></td>
<td>
<p>matrix of categorical data sequences</p>
</td></tr>
<tr><td><code id="multi.mtd_probit_+3A_initial">initial</code></td>
<td>
<p>numerical vector of initial values</p>
</td></tr>
<tr><td><code id="multi.mtd_probit_+3A_nummethod">nummethod</code></td>
<td>
<p>Numerical maximisation method, currently either &quot;NR&quot; (for Newton-Raphson), &quot;BFGS&quot; (for Broyden-Fletcher-Goldfarb-Shanno), &quot;BFGSR&quot; (for the BFGS algorithm implemented in R), &quot;BHHH&quot; (for Berndt-Hall-Hall-Hausman), &quot;SANN&quot; (for Simulated ANNealing), &quot;CG&quot; (for Conjugate Gradients), or &quot;NM&quot; (for Nelder-Mead). Lower-case letters (such as &quot;nr&quot; for Newton-Raphson) are allowed. The default method is &quot;BFGS&quot;. For more details see <code><a href="maxLik.html#topic+maxLik">maxLik()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the parameter estimates, standard-errors, z-statistics, p-values and the value of the log-likelihood function, for each equation.
</p>


<h3>Author(s)</h3>

<p>Carolina Vasconcelos and Bruno Damásio
</p>


<h3>References</h3>

<p>Nicolau, J. (2014). A new model for multivariate markov chains. Scandinavian Journal of Statistics, 41(4), 1124-1135.<a href="https://doi.org/10.1111/sjos.12087">doi:10.1111/sjos.12087</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stockreturns)
s &lt;- cbind(stockreturns$sp500, stockreturns$djia)
multi.mtd_probit(s, initial = c(1, 1, 1), nummethod = "bfgs")

</code></pre>

<hr>
<h2 id='stockreturns'>Stock returns data</h2><span id='topic+stockreturns'></span>

<h3>Description</h3>

<p>Data from 5-week-day daily stock returns (rt = 100 x log(Pt/Pt-1), where Pt is the adjusted close price) of two indexes, S&amp;P500 and DJIA, from November 11th 2011 to September 1st 2021.
The dataset also includes the interest rate spread, the 10-Year Treasury Constant Maturity Minus 3-Month Treasury Constant Maturity.
The data was retrieved from FRED.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stockreturns
</code></pre>


<h3>Format</h3>

<p>A tibble with 2,581 rows and 4 columns:
</p>

<dl>
<dt>date</dt><dd><p>yyyy-mm-dd of the closing price</p>
</dd>
<dt>sp500</dt><dd><p>S&amp;P500 returns' quantiles</p>
</dd>
<dt>djia</dt><dd><p>DJIA returns' quantiles</p>
</dd>
<dt>spread_1</dt><dd><p>Lagged 10-Year Treasury Constant Maturity Minus 3-Month Treasury Constant Maturity</p>
</dd>
<dt>returns_sp500</dt><dd><p>S&amp;P500 returns</p>
</dd>
<dt>djia</dt><dd><p>DJIA returns</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://fred.stlouisfed.org/series/SP500">https://fred.stlouisfed.org/series/SP500</a>
</p>
<p><a href="https://fred.stlouisfed.org/series/DJIA">https://fred.stlouisfed.org/series/DJIA</a>
</p>
<p><a href="https://fred.stlouisfed.org/series/T10Y3M">https://fred.stlouisfed.org/series/T10Y3M</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
