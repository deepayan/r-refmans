<!DOCTYPE html><html lang="en"><head><title>Help for package ARCensReg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ARCensReg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ARCensReg'>
<p>Censored linear regression model with autoregressive errors</p></a></li>
<li><a href='#ARtCensReg'>
<p>Censored autoregressive regression model with Student-t innovations</p></a></li>
<li><a href='#CloudCeiling'>
<p>Cloud ceiling height</p></a></li>
<li><a href='#InfDiag'>
<p>Influence diagnostic in censored linear regression model with autoregressive errors</p></a></li>
<li><a href='#phosphorus'>
<p>Phosphorus concentration data</p></a></li>
<li><a href='#plot'><p>Plot an ARpCRM or ARtpCRM object</p>
</a></li>
<li><a href='#plot.DiagARpCRM'><p>Plot influence diagnostic measures</p></a></li>
<li><a href='#plot.residARpCRM'><p>Show diagnostic residual plots</p></a></li>
<li><a href='#predict'>
<p>Forecast for Autoregressive censored models with Normal and Student-t innovations</p></a></li>
<li><a href='#print'><p>Print an ARpCRM or ARtpCRM object</p>
</a></li>
<li><a href='#rARCens'>
<p>Generating censored autoregressive data</p></a></li>
<li><a href='#residuals'>
<p>Extract model residuals from ARpCRM or ARtpCRM objects</p></a></li>
<li><a href='#summary'><p>Summary of an ARpCRM or ARtpCRM object</p>
</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fitting Univariate Censored Linear Regression Model with
Autoregressive Errors</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>It fits a univariate left, right, or interval censored linear regression model
    with autoregressive errors, considering the normal or the Student-t distribution for the 
    innovations. It provides estimates and standard errors of the parameters, predicts 
    future observations, and supports missing values on the dependent variable.
    References used for this package:
    Schumacher, F. L., Lachos, V. H., &amp; Dey, D. K. (2017). Censored regression models with 
    autoregressive errors: A likelihood-based perspective. Canadian Journal of Statistics,
    45(4), 375-392 &lt;<a href="https://doi.org/10.1002%2Fcjs.11338">doi:10.1002/cjs.11338</a>&gt;.
    Schumacher, F. L., Lachos, V. H., Vilca-Labra, F. E., &amp; Castro, L. M. (2018). Influence 
    diagnostics for censored regression models with autoregressive errors. Australian &amp; New 
    Zealand Journal of Statistics, 60(2), 209-229 &lt;<a href="https://doi.org/10.1111%2Fanzs.12229">doi:10.1111/anzs.12229</a>&gt;.
    Valeriano, K. A., Schumacher, F. L., Galarza, C. E., &amp; Matos, L. A. (2021). Censored 
    autoregressive regression models with Student-t innovations. arXiv preprint 
    &lt;<a href="https://doi.org/10.48550/arXiv.2110.00224">doi:10.48550/arXiv.2110.00224</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, gridExtra, matrixcalc, methods, msm, mvtnorm,
numDeriv, qqplotr, Rcpp, Rdpack, stats, tmvtnorm, utils</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>RcppArmadillo, Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>SMNCensReg</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-29 19:07:36 UTC; fe_fe</td>
</tr>
<tr>
<td>Author:</td>
<td>Fernanda L. Schumacher
    <a href="https://orcid.org/0000-0002-5724-8918"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Katherine A. L. Valeriano
    <a href="https://orcid.org/0000-0001-6388-4753"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Victor H. Lachos <a href="https://orcid.org/0000-0002-7239-2459"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Christian G. Morales
    <a href="https://orcid.org/0000-0002-4818-6006"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Larissa A. Matos <a href="https://orcid.org/0000-0002-2635-0901"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fernanda L. Schumacher &lt;fernandalschumacher@gmail.com&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-29 21:00:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='ARCensReg'>
Censored linear regression model with autoregressive errors
</h2><span id='topic+ARCensReg'></span>

<h3>Description</h3>

<p>It fits a univariate left, right, or interval censored linear regression model 
with autoregressive errors under the normal distribution, using the SAEM algorithm. 
It provides estimates and standard errors of the parameters, supporting missing values on the dependent variable. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARCensReg(cc, lcl = NULL, ucl = NULL, y, x, p = 1, M = 10, 
  perc = 0.25, MaxIter = 400, pc = 0.18, tol = 1e-04, 
  show_se = TRUE, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ARCensReg_+3A_cc">cc</code></td>
<td>
<p>Vector of censoring indicators of length <code class="reqn">n</code>, where <code class="reqn">n</code> is the 
total observations. For each observation: 0 if non-censored, 1 if censored/missing.</p>
</td></tr>
<tr><td><code id="ARCensReg_+3A_lcl">lcl</code>, <code id="ARCensReg_+3A_ucl">ucl</code></td>
<td>
<p>Vectors of length <code class="reqn">n</code> that represent the lower and upper bounds 
of the interval, which contains the observade value of the censored observation. 
Default=<code>NULL</code>, indicating no-censored data. See details for more information.</p>
</td></tr>
<tr><td><code id="ARCensReg_+3A_y">y</code></td>
<td>
<p>Vector of responses of length <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="ARCensReg_+3A_x">x</code></td>
<td>
<p>Matrix of covariates of dimension <code class="reqn">n \times l</code>, where <code class="reqn">l</code> is the number 
of fixed effects including the intercept, if considered (in models which include an 
intercept, <code>x</code> should contain a column of ones).</p>
</td></tr>
<tr><td><code id="ARCensReg_+3A_p">p</code></td>
<td>
<p>Order of the autoregressive process. It must be a positive integer value.</p>
</td></tr>
<tr><td><code id="ARCensReg_+3A_m">M</code></td>
<td>
<p>Size of the Monte Carlo sample generated in each step of the SAEM algorithm. 
Default=10.</p>
</td></tr>
<tr><td><code id="ARCensReg_+3A_perc">perc</code></td>
<td>
<p>Percentage of burn-in on the Monte Carlo sample. Default=0.25.</p>
</td></tr>
<tr><td><code id="ARCensReg_+3A_maxiter">MaxIter</code></td>
<td>
<p>The maximum number of iterations of the SAEM algorithm. Default=400.</p>
</td></tr>
<tr><td><code id="ARCensReg_+3A_pc">pc</code></td>
<td>
<p>Percentage of initial iterations of the SAEM algorithm with no memory. It is recommended that 
<code>50&lt;MaxIter*pc&lt;100</code>. Default=0.18.</p>
</td></tr>
<tr><td><code id="ARCensReg_+3A_tol">tol</code></td>
<td>
<p>The convergence maximum error permitted.</p>
</td></tr>
<tr><td><code id="ARCensReg_+3A_show_se">show_se</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>. Indicates if the standard errors should 
be estimated. Default=<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ARCensReg_+3A_quiet">quiet</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>. Indicates if printing information should 
be suppressed. Default=<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The linear regression model with autocorrelated errors, defined as a discrete-time autoregressive (AR) process of order <code class="reqn">p</code>, at time <code class="reqn">t</code> is given by
</p>
<p><code class="reqn">Y_t = x_t^T \beta + \xi_t,</code>
</p>
<p><code class="reqn">\xi_t = \phi_1 \xi_{t-1} + ... + \phi_p \xi_{t-p} + \eta_t, t=1, ..., n,</code>
</p>
<p>where <code class="reqn">Y_t</code> is the response variable, <code class="reqn">\beta = (\beta_1, ..., \beta_l)^T</code> is a vector 
of regression parameters of dimension <code class="reqn">l</code>, and <code class="reqn">x_t = (x_{t1}, ..., x_{tl})^T</code> is a 
vector of non-stochastic regressor variables values; <code class="reqn">\xi_t</code> is the AR error with Gaussian 
disturbance <code class="reqn">\eta_t</code>, <code class="reqn">\phi = (\phi_1, ..., \phi_p)^T</code> is the vector of AR coefficients, 
and <code class="reqn">n</code> is the sample size. 
</p>
<p>It is assumed that <code class="reqn">Y_t</code> is not fully observed for all <code class="reqn">t</code>. 
For left censored observations, we have <code>lcl=-Inf</code> and <code>ucl=</code><code class="reqn">V_t</code>, 
such that the true value <code class="reqn">Y_t \leq V_t</code>. For right censoring, <code>lcl=</code><code class="reqn">V_t</code> 
and <code>ucl=Inf</code>, such that <code class="reqn">Y_t \geq V_t</code>. For interval censoring, <code>lcl</code> and <code>ucl</code> must be finite values, such that  <code class="reqn">V_{1t} \leq Y_t \leq V_{2t}</code>. Missing data can be defined by setting <code>lcl=-Inf</code> and <code>ucl=Inf</code>.
</p>
<p>The initial values are obtained by ignoring censoring and applying maximum likelihood 
estimation with the censored data replaced by their censoring limits. Furthermore, just set <code>cc</code> as a vector of zeros to fit a regression model with autoregressive errors for non-censored data.
</p>


<h3>Value</h3>

<p>An object of class &quot;ARpCRM&quot;, representing the AR(p) censored regression normal fit. Generic functions such as print and summary have methods to show the results of the fit. The function plot provides convergence graphics for the parameters when at least one censored observation exists.
</p>
<p>Specifically, the following components are returned:
</p>
<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>Estimate of the regression parameters.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>Estimated variance of the white noise process.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>Estimate of the autoregressive parameters.</p>
</td></tr>
<tr><td><code>pi1</code></td>
<td>
<p>Estimate of the first <code class="reqn">p</code> partial autocorrelations.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>Vector of parameters estimate (<code class="reqn">\beta, \sigma^2, \phi</code>).</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>Vector of the standard errors of (<code class="reqn">\beta, \sigma^2, \phi</code>).</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Log-likelihood value.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>Bayesian information criterion.</p>
</td></tr>
<tr><td><code>AICcorr</code></td>
<td>
<p>Corrected Akaike information criterion.</p>
</td></tr>
<tr><td><code>yest</code></td>
<td>
<p>Augmented response variable based on the fitted model.</p>
</td></tr>
<tr><td><code>yyest</code></td>
<td>
<p>Final estimative of <code>E(Y%*%t(Y))</code>.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Matrix of covariates of dimension <code class="reqn">n \times l</code>.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations until convergence.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>Attained criteria value.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The <code>ARCensReg</code> call that produced the object.</p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>Table of estimates.</p>
</td></tr>
<tr><td><code>critFin</code></td>
<td>
<p>Selection criteria.</p>
</td></tr>
<tr><td><code>cens</code></td>
<td>
<p>&quot;left&quot;, &quot;right&quot;, or &quot;interval&quot; for left, right, or interval censoring, respectively.</p>
</td></tr>
<tr><td><code>nmiss</code></td>
<td>
<p>Number of missing observations.</p>
</td></tr>
<tr><td><code>ncens</code></td>
<td>
<p>Number of censored observations.</p>
</td></tr>
<tr><td><code>converge</code></td>
<td>
<p>Logical indicating convergence of the estimation algorithm.</p>
</td></tr>
<tr><td><code>MaxIter</code></td>
<td>
<p>The maximum number of iterations used for the SAEM algorithm.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>Size of the Monte Carlo sample generated in each step of the SAEM algorithm.</p>
</td></tr>
<tr><td><code>pc</code></td>
<td>
<p>Percentage of initial iterations of the SAEM algorithm with no memory.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Time elapsed in processing.</p>
</td></tr>
<tr><td><code>plot</code></td>
<td>
<p>A list containing convergence information.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Katherine L. Valeriano, Victor H. Lachos, Christian E. Galarza,
and Larissa A. Matos
</p>


<h3>References</h3>

<p>Delyon B, Lavielle M, Moulines E (1999).
&ldquo;Convergence of a stochastic approximation version of the EM algorithm.&rdquo;
<em>Annals of statistics</em>, 94&ndash;128.
</p>
<p>Schumacher FL, Lachos VH, Dey DK (2017).
&ldquo;Censored regression models with autoregressive errors: A likelihood-based perspective.&rdquo;
<em>Canadian Journal of Statistics</em>, <b>45</b>(4), 375&ndash;392.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+arima">arima</a></code>, <code><a href="#topic+ARtCensReg">ARtCensReg</a></code>, <code><a href="#topic+InfDiag">InfDiag</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: (p = l = 1)
# Generating a sample
set.seed(23451)
n = 50
x = rep(1, n)
dat = rARCens(n=n, beta=2, phi=.5, sig2=.3, x=x, cens='left', pcens=.1)

# Fitting the model (quick convergence)
fit0 = ARCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x,
                 M=5, pc=.12, tol=0.001, show_se=FALSE)
fit0

## Example 2: (p = l = 2)
# Generating a sample
n = 100
x = cbind(1, runif(n))
dat = rARCens(n=n, beta=c(2,1), phi=c(.48,-.2), sig2=.5, x=x, cens='left', 
              pcens=.05)

# Fitting the model
fit1 = ARCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x,
                 p=2, tol=0.0001)
summary(fit1)
plot(fit1)

# Plotting the augmented variable
library(ggplot2)
data.plot = data.frame(yobs=dat$data$y, yest=fit1$yest)
ggplot(data.plot) + theme_bw() +
  geom_line(aes(x=1:nrow(data.plot), y=yest), color=4, linetype="dashed") +
  geom_line(aes(x=1:nrow(data.plot), y=yobs)) + labs(x="Time", y="y")

## Example 3: Simulating missing values
miss = sample(1:n, 3)
yMISS = dat$data$y
yMISS[miss] = NA
cc = dat$data$cc
cc[miss] = 1
lcl = dat$data$lcl
ucl = dat$data$ucl
ucl[miss] = Inf

fit2 = ARCensReg(cc, lcl, ucl, yMISS, x, p=2)
plot(fit2)

# Imputed missing values
data.frame(yobs=dat$data$y[miss], yest=fit2$yest[miss])
</code></pre>

<hr>
<h2 id='ARtCensReg'>
Censored autoregressive regression model with Student-t innovations
</h2><span id='topic+ARtCensReg'></span>

<h3>Description</h3>

<p>It fits a univariate left, right, or interval censored linear regression model 
with autoregressive errors considering Student-t innovations, through the SAEM algorithm. 
It provides estimates and standard errors of the parameters, supporting missing 
values on the dependent variable. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARtCensReg(cc, lcl = NULL, ucl = NULL, y, x, p = 1, M = 10,
  perc = 0.25, MaxIter = 400, pc = 0.18, nufix = NULL, tol = 1e-04,
  show_se = TRUE, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ARtCensReg_+3A_cc">cc</code></td>
<td>
<p>Vector of censoring indicators of length <code class="reqn">n</code>, where <code class="reqn">n</code> is the 
total observations. For each observation: 0 if non-censored, 1 if censored/missing.</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_lcl">lcl</code>, <code id="ARtCensReg_+3A_ucl">ucl</code></td>
<td>
<p>Vectors of length <code class="reqn">n</code> that represent the lower and upper bounds 
of the interval, which contains the observade value of the censored observation. 
Default=<code>NULL</code>, indicating no-censored data. See details for more information.</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_y">y</code></td>
<td>
<p>Vector of responses of length <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_x">x</code></td>
<td>
<p>Matrix of covariates of dimension <code class="reqn">n \times l</code>, where <code class="reqn">l</code> is the 
number of fixed effects including the intercept, if considered (in models which 
include an intercept, <code>x</code> should contain a column of ones).</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_p">p</code></td>
<td>
<p>Order of the autoregressive process. It must be a positive integer value.</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_m">M</code></td>
<td>
<p>Size of the Monte Carlo sample generated in each step of the SAEM algorithm.
Default=10.</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_perc">perc</code></td>
<td>
<p>Percentage of burn-in on the Monte Carlo sample. Default=0.25.</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_maxiter">MaxIter</code></td>
<td>
<p>The maximum number of iterations of the SAEM algorithm. Default=400.</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_pc">pc</code></td>
<td>
<p>Percentage of initial iterations of the SAEM algorithm with no memory. It is recommended that 
<code>50&lt;MaxIter*pc&lt;100</code>. Default=0.18.</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_nufix">nufix</code></td>
<td>
<p>If the degrees of freedom (<code class="reqn">\nu</code>) are unknown, <code>nufix</code> 
should be equal to <code>NULL</code>; otherwise, it must be a number greater than 2.</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_tol">tol</code></td>
<td>
<p>The convergence maximum error permitted.</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_show_se">show_se</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>. Indicates if the standard errors should be 
estimated. Default=<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="ARtCensReg_+3A_quiet">quiet</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>. Indicates if printing information should be 
suppressed. Default=<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The linear regression model with autocorrelated errors, defined as a discrete-time autoregressive (AR) process of order <code class="reqn">p</code>, at time <code class="reqn">t</code> is given by
</p>
<p><code class="reqn">Y_t = x_t^T \beta + \xi_t,</code>
</p>
<p><code class="reqn">\xi_t = \phi_1 \xi_{t-1} + ... + \phi_p \xi_{t-p} + \eta_t, t=1,..., n,</code>
</p>
<p>where <code class="reqn">Y_t</code> is the response variable, <code class="reqn">\beta = (\beta_1,..., \beta_l)^T</code> is 
a vector of regression parameters of dimension <code class="reqn">l</code>, <code class="reqn">x_t = (x_{t1},..., x_{tl})^T</code> 
is a vector of non-stochastic regressor variables values, and <code class="reqn">\xi_t</code> is the AR 
error with <code class="reqn">\eta_t</code> being a shock of disturbance following the Student-t distribution 
with <code class="reqn">\nu</code> degrees of freedom, <code class="reqn">\phi = (\phi_1,..., \phi_p)^T</code> being the vector of AR 
coefficients, and <code class="reqn">n</code> denoting the sample size. 
</p>
<p>It is assumed that <code class="reqn">Y_t</code> is not fully observed for all <code class="reqn">t</code>. 
For left censored observations, we have <code>lcl=-Inf</code> and <code>ucl=</code><code class="reqn">V_t</code>, 
such that the true value <code class="reqn">Y_t \leq V_t</code>. For right censoring, <code>lcl=</code><code class="reqn">V_t</code> 
and <code>ucl=Inf</code>, such that <code class="reqn">Y_t \geq V_t</code>. For interval censoring, <code>lcl</code> and <code>ucl</code> must be finite values, such that <code class="reqn">V_{1t} \leq Y_t \leq V_{2t}</code>. Missing data can be defined by setting <code>lcl=-Inf</code> and <code>ucl=Inf</code>.
</p>
<p>The initial values are obtained by ignoring censoring and applying maximum likelihood 
estimation with the censored data replaced by their censoring limits. Moreover, 
just set <code>cc</code> as a vector of zeros to fit a regression model with autoregressive 
errors for non-censored data.
</p>


<h3>Value</h3>

<p>An object of class &quot;ARtpCRM&quot; representing the AR(p) censored regression Student-t fit. Generic functions such as print and summary have methods to show the results of the fit. The function plot provides convergence graphics for the parameter estimates.
</p>
<p>Specifically, the following components are returned:
</p>
<table role = "presentation">
<tr><td><code>beta</code></td>
<td>
<p>Estimate of the regression parameters.</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>Estimated scale parameter of the innovation.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>Estimate of the autoregressive parameters.</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>Estimated degrees of freedom.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>Vector of parameters estimate (<code class="reqn">\beta, \sigma^2, \phi, \nu</code>).</p>
</td></tr>
<tr><td><code>SE</code></td>
<td>
<p>Vector of the standard errors of (<code class="reqn">\beta, \sigma^2, \phi, \nu</code>).</p>
</td></tr>
<tr><td><code>yest</code></td>
<td>
<p>Augmented response variable based on the fitted model.</p>
</td></tr>
<tr><td><code>uest</code></td>
<td>
<p>Final estimated weight variables.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Matrix of covariates of dimension <code class="reqn">n \times l</code>.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations until convergence.</p>
</td></tr>
<tr><td><code>criteria</code></td>
<td>
<p>Attained criteria value.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>The <code>ARtCensReg</code> call that produced the object.</p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>Table of estimates.</p>
</td></tr>
<tr><td><code>cens</code></td>
<td>
<p>&quot;left&quot;, &quot;right&quot;, or &quot;interval&quot; for left, right, or interval censoring, respectively.</p>
</td></tr>
<tr><td><code>nmiss</code></td>
<td>
<p>Number of missing observations.</p>
</td></tr>
<tr><td><code>ncens</code></td>
<td>
<p>Number of censored observations.</p>
</td></tr>
<tr><td><code>converge</code></td>
<td>
<p>Logical indicating convergence of the estimation algorithm.</p>
</td></tr>
<tr><td><code>MaxIter</code></td>
<td>
<p>The maximum number of iterations used for the SAEM algorithm.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>Size of the Monte Carlo sample generated in each step of the SAEM algorithm.</p>
</td></tr>
<tr><td><code>pc</code></td>
<td>
<p>Percentage of initial iterations of the SAEM algorithm with no memory.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Time elapsed in processing.</p>
</td></tr>
<tr><td><code>plot</code></td>
<td>
<p>A list containing convergence information.</p>
</td></tr>
</table>


<h3>Warning </h3>

<p>This algorithm assumes that the first <code class="reqn">p</code> values in the response vector are completely observed.
</p>


<h3>Author(s)</h3>

<p>Katherine L. Valeriano, Fernanda L. Schumacher, and Larissa A. Matos
</p>


<h3>References</h3>

<p>Delyon B, Lavielle M, Moulines E (1999).
&ldquo;Convergence of a stochastic approximation version of the EM algorithm.&rdquo;
<em>Annals of statistics</em>, 94&ndash;128.
</p>
<p>Valeriano KL, Schumacher FL, Galarza CE, Matos LA (2021).
&ldquo;Censored autoregressive regression models with Student-<code class="reqn"> t </code> innovations.&rdquo;
<em>arXiv preprint arXiv:2110.00224</em>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+arima">arima</a></code>, <code><a href="#topic+ARCensReg">ARCensReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: (p = l = 1)
# Generating a sample
set.seed(1234)
n = 80
x = rep(1, n)
dat = rARCens(n=n, beta=2, phi=.6, sig2=.3, x=x, cens='right', pcens=.05, 
              innov='t', nu=4)

# Fitting the model (quick convergence)
fit0 = ARtCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x,
                 M=5, pc=.12, tol=0.001)
fit0

## Example 2: (p = l = 2)
# Generating a sample
set.seed(783796)
n = 200
x = cbind(1, runif(n))
dat = rARCens(n=n, beta=c(2,1), phi=c(.48,-.2), sig2=.5, x=x, cens='left',
              pcens=.05, innov='t', nu=5)
  
# Fitting the model with nu known
fit1 = ARtCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x,
                  p=2, M=15, pc=.20, nufix=5)
summary(fit1)
plot(fit1)

# Fitting the model with nu unknown
fit2 = ARtCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x,
                 p=2, M=15, pc=.20)
summary(fit2)
plot(fit2)
</code></pre>

<hr>
<h2 id='CloudCeiling'>
Cloud ceiling height
</h2><span id='topic+CloudCeiling'></span>

<h3>Description</h3>

<p>The cloud ceiling heights, collected by the National Center for Atmospheric Research (NCAR), 
were observed hourly in San Francisco during March 1989, consisting of n=716 observations 
(Park et al. 2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CloudCeiling)
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt><code>y</code></dt><dd><p>Logarithm of the cloud ceiling heights.</p>
</dd>
<dt><code>cc</code></dt><dd><p>Right censoring indicator (1 if the observation is right-censored and 0 otherwise).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Park JW, Genton MG, Ghosh SK (2007).
&ldquo;Censored time series analysis with autoregressive moving average models.&rdquo;
<em>Canadian Journal of Statistics</em>, <b>35</b>(1), 151&ndash;168.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ARCensReg">ARCensReg</a></code>, <code><a href="#topic+ARtCensReg">ARtCensReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

data(CloudCeiling)
ggplot(CloudCeiling) + geom_line(aes(x=1:length(y), y=y)) + 
  labs(x="Time") + theme_bw()

# Proportion of censoring
prop.table(table(CloudCeiling$cc))

## Not run: 
# A censored regression model
## This may take a long time due to the number of censored observations.
## For other examples see help(ARCensReg).

x   = as.matrix(rep(1, length(CloudCeiling$y)))
cc  = CloudCeiling$cc
lcl = CloudCeiling$y
ucl = rep(Inf, length(CloudCeiling$y))
miss =  which(is.na(CloudCeiling$y))
cc[miss]  = 1
lcl[miss] = -Inf
AR_reg = ARCensReg(cc, lcl, ucl, CloudCeiling$y, x, p=1, tol=.001)
## End(Not run)
</code></pre>

<hr>
<h2 id='InfDiag'>
Influence diagnostic in censored linear regression model with autoregressive errors
</h2><span id='topic+InfDiag'></span>

<h3>Description</h3>

<p>It performs influence diagnostic by a local influence approach (Cook 1986) with three possible 
perturbation schemes: response perturbation (y), scale matrix perturbation (Sigma), or explanatory 
variable perturbation (x). A benchmark value is calculated that depends on k.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>InfDiag(object, k = 3, indpar = rep(1, length(object$theta)), 
  indcolx = rep(1, ncol(object$x)), perturbation = "y")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="InfDiag_+3A_object">object</code></td>
<td>
<p>Object of class <code>'ARpCRM'</code> given as an output of function <code><a href="#topic+ARCensReg">ARCensReg</a></code>.</p>
</td></tr>
<tr><td><code id="InfDiag_+3A_k">k</code></td>
<td>
<p>Constant to be used in the benchmark calculation: <code>M0+k*sd(M0)</code>.</p>
</td></tr>
<tr><td><code id="InfDiag_+3A_indpar">indpar</code></td>
<td>
<p>Vector of length equal to the number of parameters, with each element 0 or 1 indicating if the 
respective parameter should be considered in the influence calculation.</p>
</td></tr>
<tr><td><code id="InfDiag_+3A_indcolx">indcolx</code></td>
<td>
<p>If <code>perturbation="x"</code>, <code>indcolx</code> must be a vector of length equal to the number of columns of x, 
with each element 0 or 1 indicating if the respective column of x should be perturbed. All columns are perturbed by default.</p>
</td></tr>
<tr><td><code id="InfDiag_+3A_perturbation">perturbation</code></td>
<td>
<p>Perturbation scheme. Possible values: &quot;y&quot; for response perturbation, &quot;Sigma&quot; for scale matrix 
perturbation, or &quot;x&quot; for explanatory variable perturbation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns a vector of length <code>n</code> with the aggregated contribution (<code>M0</code>) of all eigenvectors 
of the matrix associated with the normal curvature. For details see Schumacher et al. (2018).
</p>


<h3>Value</h3>

<p>An object of class &quot;DiagARpCRM&quot; with the following components is returned:
</p>
<table role = "presentation">
<tr><td><code>M0</code></td>
<td>
<p>Vector of length <code class="reqn">n</code> with the aggregated contribution of all eigenvectors of the matrix associated with the normal curvature.</p>
</td></tr>
<tr><td><code>perturbation</code></td>
<td>
<p>Perturbation scheme.</p>
</td></tr>
<tr><td><code>benchmark</code></td>
<td>
<p><code>M0 + k*sd(M0)</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Katherine L. Valeriano, Victor H. Lachos, Christian E. Galarza,
and Larissa A. Matos
</p>


<h3>References</h3>

<p>Cook RD (1986).
&ldquo;Assessment of local influence.&rdquo;
<em>Journal of the Royal Statistical Society: Series B (Methodological)</em>, <b>48</b>(2), 133&ndash;155.
</p>
<p>Schumacher FL, Lachos VH, Vilca-Labra FE, Castro LM (2018).
&ldquo;Influence diagnostics for censored regression models with autoregressive errors.&rdquo;
<em>Australian &amp; New Zealand Journal of Statistics</em>, <b>60</b>(2), 209&ndash;229.
</p>
<p>Zhu H, Lee S (2001).
&ldquo;Local influence for incomplete data models.&rdquo;
<em>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</em>, <b>63</b>(1), 111&ndash;126.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ARCensReg">ARCensReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ggplot2)

# Generating the data
set.seed(12341)
x = cbind(1,runif(100))
dat = rARCens(n=100, beta=c(1,-1), phi=c(.48,-.2), sig2=.5, x=x, 
              cens='left', pcens=.05)
              
# Creating an outlier
dat$data$y[40] = 5
ggplot(dat$data) + geom_line(aes(x=1:100, y=y)) + theme_bw() +
  labs(x="Time")

# Fitting the model
fit = ARCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x, 
                p=2, tol=0.001, show_se=FALSE)

# Influence diagnostic
M0y = InfDiag(fit, k=3.5, perturbation="y")
plot(M0y)
M0Sigma = InfDiag(fit, k=3.5, perturbation="Sigma")
plot(M0Sigma)
M0x = InfDiag(fit, k=3.5, indcolx=c(0,1), perturbation="x")
plot(M0x)

# Perturbation on a subset of parameters
M0y1 = InfDiag(fit, k=3.5, indpar=c(1,1,0,0,0), perturbation="y")$M0
M0y2 = InfDiag(fit, k=3.5, indpar=c(0,0,1,1,1), perturbation="y")$M0
#
ggplot(data.frame(M0y1,M0y2)) + geom_point(aes(x=M0y1, y=M0y2)) +
  geom_hline(yintercept=mean(M0y2)+3.5*sd(M0y2), linetype="dashed") +
  geom_vline(xintercept=mean(M0y1)+3.5*sd(M0y1), linetype="dashed") +
  theme_bw()
</code></pre>

<hr>
<h2 id='phosphorus'>
Phosphorus concentration data
</h2><span id='topic+phosphorus'></span>

<h3>Description</h3>

<p>The phosphorus concentration (P) data of West Fork Cedar River at Finchford, 
Iowa, USA, collected under the ambient water quality program conducted by the
Iowa Department of Natural Resources (Iowa DNR), were observed monthly from 
10/1998 to 10/2013 (n=181). The phosphorus concentration measurement was subject
to a detection limit (lcl); thereby, the P data are left-censored. The dataset
was first available in the R package carx. 
</p>
<p>The water discharge dataset was obtained from the website of the U.S. Geological Survey (site number 05458900), and it is measured in cubic feet per second.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(phosphorus)
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt><code>lP</code></dt><dd><p>Logarithm of the phosphorus concentration.</p>
</dd>
<dt><code>cc</code></dt><dd><p>Left censoring indicator (1 if the observation is left-censored and 0 otherwise).</p>
</dd>
<dt><code>lQ</code></dt><dd><p>Logarithm of the water discharge.</p>
</dd>
<dt><code>lcl</code></dt><dd><p>Censoring limit.</p>
</dd>
<dt><code>time</code></dt><dd><p>Year-Month.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://waterdata.usgs.gov/ia/nwis/monthly/">https://waterdata.usgs.gov/ia/nwis/monthly/</a>
</p>
<p><a href="https://CRAN.R-project.org/package=carx">https://CRAN.R-project.org/package=carx</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ARCensReg">ARCensReg</a></code>, <code><a href="#topic+ARtCensReg">ARtCensReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ggplot2)

data(phosphorus)
n = nrow(phosphorus)

ggplot(phosphorus) + geom_line(aes(x=1:n, y=lP)) + 
  geom_line(aes(x=1:n, y=lcl), color="red", linetype="dashed") + 
  labs(x="Time") + theme_bw()

# Proportion of censoring
prop.table(table(phosphorus$cc))

# A censored regression model
x   = cbind(1, phosphorus$lQ)
cc  = phosphorus$cc
lcl = rep(-Inf, n)
ucl = phosphorus$lcl
miss =  which(is.na(phosphorus$lP))
cc[miss]  = 1 
ucl[miss] = Inf

# Fitting a model with normal innovations
set.seed(8765)
mod1 = ARCensReg(cc, lcl, ucl, phosphorus$lP, x, p=1, tol=.001)

# Fitting a model with Student-t innovations
set.seed(287399)
mod2 = ARtCensReg(cc, lcl, ucl, phosphorus$lP, x, p=1, tol=.001)

# Plotting observed and imputed values
data.plot = data.frame(y=phosphorus$lP, ynorm=mod1$yest, yt=mod2$yest)
#
ggplot(data.plot) + geom_line(aes(x=1:n, y=ynorm), color=4) +
  geom_line(aes(x=1:n, y=yt), color="deeppink", linetype="dashed") + 
  geom_line(aes(x=1:n, y=y)) + labs(x="Time", y="lP") + theme_bw()

# Imputed values
data.plot[cc==1,]
</code></pre>

<hr>
<h2 id='plot'>Plot an ARpCRM or ARtpCRM object

</h2><span id='topic+plot.ARpCRM'></span><span id='topic+plot.ARtpCRM'></span>

<h3>Description</h3>

<p>It displays convergence graphs for the parameters estimates (for the case with at 
least one censored observation). The dashed line indicates the iteration of the 
SAEM algorithm that simulations start being smoothed. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'ARpCRM'
plot(x, ...)
  
  ## S3 method for class 'ARtpCRM'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>ARpCRM</code> or <code>ARtpCRM</code>, 
representing a fitted censored autoregressive model of order <code class="reqn">p</code>, with 
normal and Student-t innovations, respectively.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Katherine L. Valeriano, Victor H. Lachos, Christian E. Galarza, and Larissa A. Matos
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="#topic+ARCensReg">ARCensReg</a></code>, <code><a href="#topic+ARtCensReg">ARtCensReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 50; x = rep(1, n)
dat = rARCens(n=n, beta=2, phi=.5, sig2=.3, x=x, cens='left', pcens=.1)

fit = ARCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x,
                M=5, pc=.12, tol=0.001, show_se=FALSE)
plot(fit)
</code></pre>

<hr>
<h2 id='plot.DiagARpCRM'>Plot influence diagnostic measures
</h2><span id='topic+plot.DiagARpCRM'></span>

<h3>Description</h3>

<p>Plot method for objects of class &quot;DiagARpCRM&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'DiagARpCRM'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.DiagARpCRM_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>DiagARpCRM</code>. The influence diagnostic measures are calculated by function <code><a href="#topic+InfDiag">InfDiag</a></code>, with three possible perturbation schemes: response perturbation (y), scale matrix perturbation (Sigma), or explanatory variable perturbation (x).</p>
</td></tr>
<tr><td><code id="plot.DiagARpCRM_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object, plotting the index versus the influence diagnostic measure.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Katherine L. Valeriano, Victor H. Lachos, Christian E. Galarza, and Larissa A. Matos
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="#topic+InfDiag">InfDiag</a></code>, <code><a href="#topic+ARCensReg">ARCensReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ggplot2)

# Generating the data
set.seed(12341)
x = cbind(1,runif(100))
dat = rARCens(n=100, beta=c(1,-1), phi=c(.48,-.2), sig2=.5, x=x, 
              cens='left', pcens=.05)
              
# Creating an outlier
dat$data$y[40] = 5
ggplot(dat$data) + geom_line(aes(x=1:100, y=y)) + theme_bw() +
  labs(x="Time")

# Fitting the model
fit = ARCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x, 
                p=2, tol=0.001, show_se=FALSE)

# Influence diagnostic
M0y = InfDiag(fit, k=3.5, perturbation="y")
plot(M0y)
M0Sigma = InfDiag(fit, k=3.5, perturbation="Sigma")
plot(M0Sigma)
M0x = InfDiag(fit, k=3.5, indcolx=c(0,1), perturbation="x")
plot(M0x)

# Perturbation on a subset of parameters
M0y1 = InfDiag(fit, k=3.5, indpar=c(1,1,0,0,0), perturbation="y")$M0
M0y2 = InfDiag(fit, k=3.5, indpar=c(0,0,1,1,1), perturbation="y")$M0
#
ggplot(data.frame(M0y1,M0y2)) + geom_point(aes(x=M0y1, y=M0y2)) +
  geom_hline(yintercept=mean(M0y2)+3.5*sd(M0y2), linetype="dashed") +
  geom_vline(xintercept=mean(M0y1)+3.5*sd(M0y1), linetype="dashed") +
  theme_bw()
</code></pre>

<hr>
<h2 id='plot.residARpCRM'>Show diagnostic residual plots
</h2><span id='topic+plot.residARpCRM'></span>

<h3>Description</h3>

<p>It returns four plots for the quantile residuals: the time series plot of the residuals, the quantile-quantile plot, the histogram, and the ACF plot of the residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'residARpCRM'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.residARpCRM_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>residARpCRM</code> obtained as an output of function <code><a href="stats.html#topic+residuals">residuals</a></code>.</p>
</td></tr>
<tr><td><code id="plot.residARpCRM_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Katherine L. Valeriano, Victor H. Lachos, Christian E. Galarza, and Larissa A. Matos
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>, <code><a href="#topic+ARCensReg">ARCensReg</a></code>, <code><a href="#topic+ARtCensReg">ARtCensReg</a></code>, <code><a href="#topic+residuals.ARpCRM">residuals.ARpCRM</a></code>, <code><a href="#topic+residuals.ARtpCRM">residuals.ARtpCRM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1: Generating data with normal innovations
set.seed(93899)
x = cbind(1, runif(300))
dat1 = rARCens(n=300, beta=c(1,-1), phi=c(.48,-.2), sig2=.5, x=x, 
              cens='left', pcens=.05, innov="norm")

# Fitting the model with normal innovations
mod1 = ARCensReg(dat1$data$cc, dat1$data$lcl, dat1$data$ucl, dat1$data$y, 
                 x, p=2, tol=0.001)
r1 = residuals(mod1)
class(r1)
plot(r1)

# Fitting the model with Student-t innovations
mod2 = ARtCensReg(dat1$data$cc, dat1$data$lcl, dat1$data$ucl, dat1$data$y, 
                  x, p=2, tol=0.001)
r2 = residuals(mod2)
plot(r2)


## Example 2: Generating heavy-tailed data
set.seed(12341)
x = cbind(1, runif(300))
dat2 = rARCens(n=300, beta=c(1,-1), phi=c(.48,-.2), sig2=.5, x=x, 
              cens='left', pcens=.05, innov="t", nu=3)

# Fitting the model with normal innovations
mod3 = ARCensReg(dat2$data$cc, dat2$data$lcl, dat2$data$ucl, dat2$data$y,
                 x, p=2, tol=0.001)
r3 = residuals(mod3)
plot(r3)

# Fitting the model with Student-t innovations
mod4 = ARtCensReg(dat2$data$cc, dat2$data$lcl, dat2$data$ucl, dat2$data$y,
                  x, p=2, tol=0.001)
r4 = residuals(mod4)
plot(r4)
</code></pre>

<hr>
<h2 id='predict'>
Forecast for Autoregressive censored models with Normal and Student-t innovations
</h2><span id='topic+predict.ARpCRM'></span><span id='topic+predict.ARtpCRM'></span>

<h3>Description</h3>

<p>Forecast from models fitted by <code><a href="#topic+ARCensReg">ARCensReg</a></code> and <code><a href="#topic+ARtCensReg">ARtCensReg</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'ARpCRM'
predict(object, x_pred, ...)
  
  ## S3 method for class 'ARtpCRM'
predict(object, x_pred, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>ARpCRM</code> or <code>ARtpCRM</code>, representing a fitted AR(p) censored linear model.</p>
</td></tr>
<tr><td><code id="predict_+3A_x_pred">x_pred</code></td>
<td>
<p>Matrix of covariates for responses to be predicted.</p>
</td></tr> 
<tr><td><code id="predict_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A time series of predictions.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Katherine L. Valeriano, Victor H. Lachos, Christian E. Galarza,
and Larissa A. Matos
</p>


<h3>References</h3>

<p>Schumacher FL, Lachos VH, Dey DK (2017).
&ldquo;Censored regression models with autoregressive errors: A likelihood-based perspective.&rdquo;
<em>Canadian Journal of Statistics</em>, <b>45</b>(4), 375&ndash;392.
</p>
<p>Valeriano KL, Schumacher FL, Galarza CE, Matos LA (2021).
&ldquo;Censored autoregressive regression models with Student-<code class="reqn"> t </code> innovations.&rdquo;
<em>arXiv preprint arXiv:2110.00224</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ARCensReg">ARCensReg</a></code>, <code><a href="#topic+ARtCensReg">ARtCensReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generating a sample
set.seed(2839)
n = 210
x = cbind(1, rnorm(n))
dat = rARCens(n=n, beta=c(-1,2), phi=.5, sig2=.3, x=x, cens='left', pcens=.1)

# Fitting the model
data1 = dat$data[1:205,]
fit = ARCensReg(data1$cc, data1$lcl, data1$ucl, data1$y, x[1:205,],
                 M=5, pc=.12, tol=0.001)

# Forecast
y_pred = predict(fit, x[206:n,])
mean((dat$data$y[206:n] - y_pred)^2) # MSPE
</code></pre>

<hr>
<h2 id='print'>Print an ARpCRM or ARtpCRM object

</h2><span id='topic+print.ARpCRM'></span><span id='topic+print.ARtpCRM'></span>

<h3>Description</h3>

<p>Print an ARpCRM or ARtpCRM object.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'ARpCRM'
print(x, ...)

  ## S3 method for class 'ARtpCRM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print_+3A_x">x</code></td>
<td>
<p>An object inheriting from class <code>ARpCRM</code> or <code>ARtpCRM</code>, 
representing a fitted censored autoregressive model of order <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="print_+3A_...">...</code></td>
<td>
<p>Additional print arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Katherine L. Valeriano, Victor H. Lachos, Christian E. Galarza, and Larissa A. Matos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ARCensReg">ARCensReg</a></code>, <code><a href="#topic+ARtCensReg">ARtCensReg</a></code>, <code><a href="base.html#topic+summary">summary</a></code>, <code><a href="base.html#topic+plot">plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 50; x = rep(1, n)
dat = rARCens(n=n, beta=2, phi=.5, sig2=.3, x=x, cens='left', pcens=.1)

fit = ARCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x,
                M=5, pc=.12, tol=0.001, show_se=FALSE)
fit
</code></pre>

<hr>
<h2 id='rARCens'>
Generating censored autoregressive data
</h2><span id='topic+rARCens'></span>

<h3>Description</h3>

<p>It simulates a censored response variable with autoregressive errors of order <code class="reqn">p</code> following normal or Student-t innovations, with an established censoring rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rARCens(n, beta, phi, sig2 = 1, x = rep(1, n), cens = "left", 
  pcens = 0.1, innov = "norm", nu = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rARCens_+3A_n">n</code></td>
<td>
<p>Length of the desired time serie.</p>
</td></tr>
<tr><td><code id="rARCens_+3A_beta">beta</code></td>
<td>
<p>Vector of theoretical regression parameters of length <code class="reqn">l</code>.</p>
</td></tr>
<tr><td><code id="rARCens_+3A_phi">phi</code></td>
<td>
<p>Vector of theoretical autoregressive coefficients of length <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="rARCens_+3A_sig2">sig2</code></td>
<td>
<p>Theoretical variance of the error.</p>
</td></tr>
<tr><td><code id="rARCens_+3A_x">x</code></td>
<td>
<p>Matrix of covariates of dimension <code class="reqn">n</code>x<code class="reqn">l</code> (in models that include 
an intercept <code>x</code> should contain a column of ones).</p>
</td></tr>
<tr><td><code id="rARCens_+3A_cens">cens</code></td>
<td>
<p><code>'left'</code> for left censoring, <code>'right'</code> for right censoring.</p>
</td></tr>
<tr><td><code id="rARCens_+3A_pcens">pcens</code></td>
<td>
<p>Desired censoring rate.</p>
</td></tr>
<tr><td><code id="rARCens_+3A_innov">innov</code></td>
<td>
<p>Distribution of the innovation variable. The values are <code>'norm'</code> and <code>'t'</code> for normal and Student-t distribution, respectively.</p>
</td></tr>
<tr><td><code id="rARCens_+3A_nu">nu</code></td>
<td>
<p>Degrees of freedom for Student-t innovations.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>data</code></td>
<td>
<p>Generated response (y), censoring indicator (cc), and lower (lcl) and upper (ucl) bounds of the interval, which contains the true value of the censored observation.</p>
</td></tr>
<tr><td><code>param</code></td>
<td>
<p>Theoretical parameters (beta, sig2, phi).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>For data generation with Student-t innovations, the first <code class="reqn">p</code> observations are not censored.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Katherine L. Valeriano, Victor H. Lachos, Christian E. Galarza,
and Larissa A. Matos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ARCensReg">ARCensReg</a></code>, <code><a href="#topic+ARtCensReg">ARtCensReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

## Example 1: Generating a sample with normal innovations
set.seed(1234)
dat = rARCens(n=100, beta=c(1,-1), phi=c(.48,-.2), sig2=.5,
              x=cbind(1,runif(100)), cens='left', pcens=.10)

# Plotting the time serie
ggplot(data.frame(dat$data$y), aes(x=1:100, y=dat$data$y)) + geom_line() + 
  geom_line(aes(x=1:100, y=dat$data$ucl), color="red", linetype="twodash") + 
  labs(x="Time", y=bquote(y["obs"])) + theme_bw()

table(dat$data$cc)

dat$param
#[1]  1.00 -1.00  0.50  0.48 -0.20

## Example 2: Generating a sample with Student-t innovations
set.seed(8278)
dat1 = rARCens(n=100, beta=c(1,-1), phi=c(.48,-.2), sig2=.5,
               x=cbind(1,rnorm(100)), cens='right', pcens=.10, 
               innov='t', nu=3)

# Plotting the time serie
ggplot(data.frame(dat1$data$y), aes(x=1:100, y=dat1$data$y)) + geom_line() + 
  geom_line(aes(x=1:100, y=dat1$data$lcl), color="red", linetype="twodash") + 
  labs(x="Time", y=bquote(y["obs"])) + theme_bw()
  
dat1$param
#[1]  1.00 -1.00  0.50  0.48 -0.20  3.00
</code></pre>

<hr>
<h2 id='residuals'>
Extract model residuals from ARpCRM or ARtpCRM objects
</h2><span id='topic+residuals.ARpCRM'></span><span id='topic+residuals.ARtpCRM'></span>

<h3>Description</h3>

<p>The conditional residuals are obtained by subtracting the fitted values from the response vector, while the quantile residuals are obtained by inverting the estimated distribution function for each observation to obtain approximately normally distributed residuals. See, for instance, Dunn and Smyth (1996) and Kalliovirta (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ARpCRM'
residuals(object, ...)

## S3 method for class 'ARtpCRM'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>ARpCRM</code> or <code>ARtpCRM</code>, 
representing a fitted AR(p) censored linear model.</p>
</td></tr>
<tr><td><code id="residuals_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;residARpCRM&quot;, with the following components:
</p>
<table role = "presentation">
<tr><td><code>residuals</code></td>
<td>
<p>Vector with the conditional residuals of length <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code>quantile.resid</code></td>
<td>
<p>Vector with the quantile residuals of length <code class="reqn">n</code>.</p>
</td></tr>
</table>
<p>Generic function <code>plot</code> has methods to show a graphic of residual vs. time, an autocorrelation plot, a histogram, and Quantile-Quantile (Q-Q) plot for the quantile residuals.
</p>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Katherine L. Valeriano, Victor H. Lachos, Christian E. Galarza,
and Larissa A. Matos
</p>


<h3>References</h3>

<p>Dunn PK, Smyth GK (1996).
&ldquo;Randomized quantile residuals.&rdquo;
<em>Journal of Computational and Graphical Statistics</em>, <b>5</b>(3), 236&ndash;244.
</p>
<p>Kalliovirta L (2012).
&ldquo;Misspecification tests based on quantile residuals.&rdquo;
<em>The Econometrics Journal</em>, <b>15</b>(2), 358&ndash;393.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ARCensReg">ARCensReg</a></code>, <code><a href="#topic+ARtCensReg">ARtCensReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1: Generating data with normal innovations
set.seed(93899)
x = cbind(1, runif(300))
dat1 = rARCens(n=300, beta=c(1,-1), phi=c(.48,-.2), sig2=.5, x=x, 
              cens='left', pcens=.05, innov="norm")

# Fitting the model with normal innovations
mod1 = ARCensReg(dat1$data$cc, dat1$data$lcl, dat1$data$ucl, dat1$data$y, 
                 x, p=2, tol=0.001)
mod1$tab
plot(residuals(mod1))

# Fitting the model with Student-t innovations
mod2 = ARtCensReg(dat1$data$cc, dat1$data$lcl, dat1$data$ucl, dat1$data$y, 
                  x, p=2, tol=0.001)
mod2$tab
plot(residuals(mod2))


## Example 2: Generating heavy-tailed data
set.seed(12341)
x = cbind(1, runif(300))
dat2 = rARCens(n=300, beta=c(1,-1), phi=c(.48,-.2), sig2=.5, x=x, 
              cens='left', pcens=.05, innov="t", nu=3)

# Fitting the model with normal innovations
mod3 = ARCensReg(dat2$data$cc, dat2$data$lcl, dat2$data$ucl, dat2$data$y,
                 x, p=2, tol=0.001)
mod3$tab
plot(residuals(mod3))

# Fitting the model with Student-t innovations
mod4 = ARtCensReg(dat2$data$cc, dat2$data$lcl, dat2$data$ucl, dat2$data$y,
                  x, p=2, tol=0.001)
mod4$tab
plot(residuals(mod4))
</code></pre>

<hr>
<h2 id='summary'>Summary of an ARpCRM or ARtpCRM object

</h2><span id='topic+summary.ARpCRM'></span><span id='topic+summary.ARtpCRM'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;ARpCRM&quot; or &quot;ARtpCRM&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'ARpCRM'
summary(object, ...)
  
  ## S3 method for class 'ARtpCRM'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>An object inheriting from class <code>ARpCRM</code> or <code>ARtpCRM</code>,  
representing a fitted censored autoregressive model of order <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fernanda L. Schumacher, Katherine L. Valeriano, Victor H. Lachos, Christian E. Galarza, and Larissa A. Matos
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ARCensReg">ARCensReg</a></code>, <code><a href="#topic+ARtCensReg">ARtCensReg</a></code>, <code><a href="base.html#topic+print">print</a></code>, <code><a href="base.html#topic+plot">plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 80; x = rep(1, n)
dat = rARCens(n=n, beta=2, phi=.6, sig2=.3, x=x, cens='right', pcens=.05, 
              innov='t', nu=4)

fit = ARtCensReg(dat$data$cc, dat$data$lcl, dat$data$ucl, dat$data$y, x,
                 M=5, pc=.12, tol=0.001)
summary(fit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
