<!DOCTYPE html><html><head><title>Help for package bets.covid19</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bets.covid19}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#age.process'><p>Processing age to print its distribution</p></a></li>
<li><a href='#bets.covid19'><p>A package for analyzing early epidemic data</p></a></li>
<li><a href='#bets.inference'><p>Likelihood inference</p></a></li>
<li><a href='#bets.likelihood'><p>(Profile) Likelihood function</p></a></li>
<li><a href='#bets.likelihood.conditional'><p>(Profile) Conditional likelihood given B and E</p></a></li>
<li><a href='#bets.likelihood.unconditional'><p>Approximate profile likelihood</p></a></li>
<li><a href='#covid19_data'><p>Confirmed cases of COVID-19</p></a></li>
<li><a href='#date.process'><p>Transform date to numeric</p></a></li>
<li><a href='#parse.infected'><p>Parse the infected date</p></a></li>
<li><a href='#parse.one.infected'><p>Parse infected date (basic)</p></a></li>
<li><a href='#preprocess.data'><p>Prepare data frame for analysis</p></a></li>
<li><a href='#simulate.case'><p>Simulate case information from the generative BETS model</p></a></li>
<li><a href='#wuhan_exported'><p>COVID-19 exported from Wuhan</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>The BETS Model for Early Epidemic Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-05-07</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements likelihood inference for early epidemic analysis. BETS is short for the four key epidemiological events being modeled: Begin of exposure, End of exposure, time of Transmission, and time of Symptom onset. The package contains a dataset of the trajectory of confirmed cases during the coronavirus disease (COVID-19) early outbreak. More detail of the statistical methods can be found in Zhao et al. (2020) &lt;<a href="https://doi.org/10.48550/arXiv.2004.07743">doi:10.48550/arXiv.2004.07743</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0),</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, rootSolve, parallel</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/qingyuanzhao/bets.covid19">https://github.com/qingyuanzhao/bets.covid19</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-05-09 14:37:21 UTC; qyzhao</td>
</tr>
<tr>
<td>Author:</td>
<td>Qingyuan Zhao [aut, cre],
  Nianqiao Ju [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Qingyuan Zhao &lt;qyzhao@statslab.cam.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-05-12 09:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='age.process'>Processing age to print its distribution</h2><span id='topic+age.process'></span>

<h3>Description</h3>

<p>Processing age to print its distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age.process(age)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age.process_+3A_age">age</code></td>
<td>
<p>a vector of age, each entry is either a number (like 34) or age by decade (like 30s)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>each age is either repeated 10 times or expanded to 10 numbers (for example, 30s is expanded to 30, 31, ..., 39).
</p>

<hr>
<h2 id='bets.covid19'>A package for analyzing early epidemic data</h2><span id='topic+bets.covid19'></span>

<h3>Description</h3>

<p>The BETS<code>bets.covid19</code> package provides likelihood inference for early epidemic data with four key epidemiological events: Beginning of exposure, End of exposure, time of Transmission, and time of Symptom onset. It jointly estimates the epidemic doubling time and incubation period and is able to correct for different kinds of sample selection.
</p>


<h3>References</h3>

<p>Qingyuan Zhao, Nianqiao Ju, Sergio Bacallado, and Rajen Shah. &quot;BETS: The dangers of selection bias in early analyses of the coronavirus disease (COVID-19) pandemic&quot;, 2020. arXiv:2004.07743.
</p>

<hr>
<h2 id='bets.inference'>Likelihood inference</h2><span id='topic+bets.inference'></span>

<h3>Description</h3>

<p>Likelihood inference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bets.inference(
  data,
  likelihood = c("conditional", "unconditional"),
  ci = c("lrt", "point", "bootstrap"),
  M = Inf,
  r = NULL,
  L = NULL,
  level = 0.95,
  bootstrap = 1000,
  mc.cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bets.inference_+3A_data">data</code></td>
<td>
<p>A data.frame with three columns: B, E, S.</p>
</td></tr>
<tr><td><code id="bets.inference_+3A_likelihood">likelihood</code></td>
<td>
<p>Conditional on B and E?</p>
</td></tr>
<tr><td><code id="bets.inference_+3A_ci">ci</code></td>
<td>
<p>How to compute the confidence interval?</p>
</td></tr>
<tr><td><code id="bets.inference_+3A_m">M</code></td>
<td>
<p>Right truncation for symptom onset (only available for conditional likelihood)</p>
</td></tr>
<tr><td><code id="bets.inference_+3A_r">r</code></td>
<td>
<p>Parameter for epidemic growth (overrides <code>{params}, only available for conditional likelihood</code>)</p>
</td></tr>
<tr><td><code id="bets.inference_+3A_l">L</code></td>
<td>
<p>Time of travel restriction (required for unconditional likelihood)</p>
</td></tr>
<tr><td><code id="bets.inference_+3A_level">level</code></td>
<td>
<p>Level of the confidence interval (default 0.95).</p>
</td></tr>
<tr><td><code id="bets.inference_+3A_bootstrap">bootstrap</code></td>
<td>
<p>Number of bootstrap resamples.</p>
</td></tr>
<tr><td><code id="bets.inference_+3A_mc.cores">mc.cores</code></td>
<td>
<p>Number of cores used for computing the bootstrap confidence interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The confidence interval is either not computed (<code>"point"</code>), or computed by inverting the likelihood ratio test (<code>"lrt"</code>) or basic bootstrap (<code>"bootstrap"</code>)
</p>


<h3>Value</h3>

<p>Results of the likelihood inference, including maximum likelihood estimators and individual confidence intervals for the model parameters based on inverting the likelihood ratio test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(wuhan_exported)

data &lt;- subset(wuhan_exported, Location == "Hefei")
data$B &lt;- data$B - 0.75
data$E &lt;- data$E - 0.25
data$S &lt;- data$S - 0.5

# Conditional likelihood inference
bets.inference(data, "conditional")
bets.inference(data, "conditional", "bootstrap", bootstrap = 100, level = 0.5)

# Unconditional likelihood inference
bets.inference(data, "unconditional", L = 54)

# Conditional likelihood inference for data with right truncation
bets.inference(subset(data, S &lt;= 60), "conditional", M = 60)

# Conditional likelihood inference with r fixed at 0 (not recommended)
bets.inference(data, "conditional", r = 0)


</code></pre>

<hr>
<h2 id='bets.likelihood'>(Profile) Likelihood function</h2><span id='topic+bets.likelihood'></span>

<h3>Description</h3>

<p>(Profile) Likelihood function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bets.likelihood(
  params,
  data,
  likelihood = c("conditional", "unconditional"),
  M = Inf,
  r = NULL,
  L = NULL,
  params_init = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bets.likelihood_+3A_params">params</code></td>
<td>
<p>A vector of parameters (with at least one of the following entries: rho, r, ip_q50, ip_q95)</p>
</td></tr>
<tr><td><code id="bets.likelihood_+3A_data">data</code></td>
<td>
<p>A data frame with three columns: B, E, S</p>
</td></tr>
<tr><td><code id="bets.likelihood_+3A_likelihood">likelihood</code></td>
<td>
<p>Use the conditional or unconditional likelihood function</p>
</td></tr>
<tr><td><code id="bets.likelihood_+3A_m">M</code></td>
<td>
<p>Right truncation for symptom onset</p>
</td></tr>
<tr><td><code id="bets.likelihood_+3A_r">r</code></td>
<td>
<p>Parameter for epidemic growth (overrides <code>{params}</code>)</p>
</td></tr>
<tr><td><code id="bets.likelihood_+3A_l">L</code></td>
<td>
<p>Day of travel quarantine</p>
</td></tr>
<tr><td><code id="bets.likelihood_+3A_params_init">params_init</code></td>
<td>
<p>Initial parameters for computing the profile likelihood</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Non-default values of <code>M</code> and <code>r</code> are only available for conditional likelihood.
</p>


<h3>Value</h3>

<p>Log-likelihood function if <code>params</code> has all four entries, rho, r, ip_q50, ip_q95 (or three entires&mdash;r, ip_q50, ip_q95&mdash;if computing the conditional likelihood). Otherwise returns the profile likelihood for the parameters in <code>params</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(wuhan_exported)

data &lt;- wuhan_exported
data$B &lt;- data$B - 0.75
data$E &lt;- data$E - 0.25
data$S &lt;- data$S - 0.5

params &lt;- c(r = 0.2,
            ip_q50 = 5,
            ip_q95 = 12)

# Conditional likelihood
bets.likelihood(params, data)

# Conditional likelihood with right truncation
bets.likelihood(params, subset(data, S &lt;= 60), M = 60)

# Conditional likelihood with fixed r (not recommended)
bets.likelihood(params, data, r = 0)

# Unconditional likelihood
params["rho"] &lt;- 1
bets.likelihood(params, data, likelihood = "unconditional", L = 54)

# Profile conditional likelihood
bets.likelihood(c(r = 0.2), data, params_init = params)

</code></pre>

<hr>
<h2 id='bets.likelihood.conditional'>(Profile) Conditional likelihood given B and E</h2><span id='topic+bets.likelihood.conditional'></span>

<h3>Description</h3>

<p>(Profile) Conditional likelihood given B and E
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bets.likelihood.conditional(
  params,
  data,
  M = Inf,
  r = NULL,
  params_init = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bets.likelihood.conditional_+3A_params">params</code></td>
<td>
<p>A vector of parameters (names: r, ip_q50, ip_q95)</p>
</td></tr>
<tr><td><code id="bets.likelihood.conditional_+3A_data">data</code></td>
<td>
<p>A data frame with three columns: B, E, S</p>
</td></tr>
<tr><td><code id="bets.likelihood.conditional_+3A_m">M</code></td>
<td>
<p>Right truncation for symptom onset</p>
</td></tr>
<tr><td><code id="bets.likelihood.conditional_+3A_r">r</code></td>
<td>
<p>Parameter for epidemic growth (overrides <code>{params}</code>)</p>
</td></tr>
<tr><td><code id="bets.likelihood.conditional_+3A_params_init">params_init</code></td>
<td>
<p>Initial parameters for computing the profile likelihood</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Conditional log-likelihood.
</p>

<hr>
<h2 id='bets.likelihood.unconditional'>Approximate profile likelihood</h2><span id='topic+bets.likelihood.unconditional'></span>

<h3>Description</h3>

<p>Approximate profile likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bets.likelihood.unconditional(params, data, params_init = NULL, L = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bets.likelihood.unconditional_+3A_params">params</code></td>
<td>
<p>A vector of parameters (names: rho, r, ip_q50, ip_q95)</p>
</td></tr>
<tr><td><code id="bets.likelihood.unconditional_+3A_data">data</code></td>
<td>
<p>A data frame with three columns: B, E, S</p>
</td></tr>
<tr><td><code id="bets.likelihood.unconditional_+3A_params_init">params_init</code></td>
<td>
<p>Initial parameters for computing the profile likelihood</p>
</td></tr>
<tr><td><code id="bets.likelihood.unconditional_+3A_l">L</code></td>
<td>
<p>Day of travel quarantine</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>params</code> contains all the parameters (rho, r, ip_q50, ip_q95), returns the approximate log-likelihood of <code>data</code>. When <code>params</code> contains some but not all the parameters, returns the profile log-likelihood.
</p>

<hr>
<h2 id='covid19_data'>Confirmed cases of COVID-19</h2><span id='topic+covid19_data'></span>

<h3>Description</h3>

<p>A dataset containing the trajectory of cases of COVID-19.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covid19_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 1091 rows and 20 variables:
</p>

<dl>
<dt>Case</dt><dd><p>Label of the case, in the format of Country-Case number.</p>
</dd>
<dt>Nationality/Residence</dt><dd><p>Nationality or residence of the patient.</p>
</dd>
<dt>Gender</dt><dd><p>Male (M) or Female (F).</p>
</dd>
<dt>Age</dt><dd><p>Age of the patient, either an integer or age by decade (for example, 40s).</p>
</dd>
<dt>Cluster</dt><dd><p>Other confirmed cases that this patient had contacts with.</p>
</dd>
<dt>Known Contact</dt><dd><p>Whether the case has contact with earlier confirmed cases or visited Hubei province.</p>
</dd>
<dt>Outside</dt><dd><p>Was the patient infected outside Wuhan? Yes (Y), Likely (L), or No (empty string and the default).</p>
</dd>
<dt>Begin_Wuhan</dt><dd><p>Begin of stay in Wuhan.</p>
</dd>
<dt>End_Wuhan</dt><dd><p>End of Stay in Wuhan.</p>
</dd>
<dt>Infected</dt><dd><p>When was the patient infected? Can be an interval or multiple dates.</p>
</dd>
<dt>Arrived</dt><dd><p>When did the patient arrive in the country where he/she was confirmed a 2019-nCoV case?</p>
</dd>
<dt>Symptom</dt><dd><p>When did the patient first show symptoms of 2019-nCoV (cough, fever, fatigue, etc.)?</p>
</dd>
<dt>Initial</dt><dd><p>After developing symptoms, when was the patient first went to (or taken to) a medical institution?</p>
</dd>
<dt>Hospital</dt><dd><p>If the patient was not admitted to or isolated in a hospital after the initial medical visit, when was the patient finally admitted or isolated?</p>
</dd>
<dt>Confirmed</dt><dd><p>When was the patient confirmed as a case of 2019-nCoV?</p>
</dd>
<dt>Discharged</dt><dd><p>When was the patient discharged from hospital?</p>
</dd>
<dt>Death</dt><dd><p>When did the patient die?</p>
</dd>
<dt>Verified</dt><dd><p>Has this information been verified by another data collector?</p>
</dd>
<dt>Source</dt><dd><p>URLs to the information recorded (usually government websites or news reports).</p>
</dd>
</dl>

<hr>
<h2 id='date.process'>Transform date to numeric</h2><span id='topic+date.process'></span>

<h3>Description</h3>

<p>Transform date to numeric
</p>


<h3>Usage</h3>

<pre><code class='language-R'>date.process(date)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="date.process_+3A_date">date</code></td>
<td>
<p>a vector of dates of the form &quot;DD-MMM&quot; (for example, 23-Jan).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of days since December 1st, 2019 (or example, 23-Jan is converted to 23+31 = 52).
</p>

<hr>
<h2 id='parse.infected'>Parse the infected date</h2><span id='topic+parse.infected'></span>

<h3>Description</h3>

<p>Deprecated. Used in the previous analysis, now replaced by <code>preprocess.data</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse.infected(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse.infected_+3A_data">data</code></td>
<td>
<p>a data frame with the following columns: Infected, Arrived, Symptom, Initial, Confirmed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the data frame with two new columns, Infected_first and Infected_last
</p>

<hr>
<h2 id='parse.one.infected'>Parse infected date (basic)</h2><span id='topic+parse.one.infected'></span>

<h3>Description</h3>

<p>Parse infected date (basic)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse.one.infected(infected)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse.one.infected_+3A_infected">infected</code></td>
<td>
<p>A string of the form &quot;DATE1&quot; or &quot;DATE1 to DATE2&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length 2 for the infection window
</p>

<hr>
<h2 id='preprocess.data'>Prepare data frame for analysis</h2><span id='topic+preprocess.data'></span>

<h3>Description</h3>

<p>Prepare data frame for analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preprocess.data(
  data,
  infected_in = c("Wuhan", "Outside"),
  symptom_impute = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preprocess.data_+3A_data">data</code></td>
<td>
<p>A data frame</p>
</td></tr>
<tr><td><code id="preprocess.data_+3A_infected_in">infected_in</code></td>
<td>
<p>Either &quot;Wuhan&quot; or &quot;Outside&quot;</p>
</td></tr>
<tr><td><code id="preprocess.data_+3A_symptom_impute">symptom_impute</code></td>
<td>
<p>Whether to use initial medical visit and confirmation to impute missing symptom onset.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A summary of the procedures:
</p>

<ol>
<li><p> Convert all dates to number of days since 1-Dec-2019.
</p>
</li>
<li><p> Separates data into those returned from Wuhan and those infected outside of wuhan.
</p>
</li>
<li><p> Restrict to cases with a known symptom onset date.
</p>
</li>
<li><p> Parse column 'Infected' into two columns: Infected_first and Infected_last.
</p>
</li>
<li><p> For all cases, set Infected_first to 1 if it is missing.
</p>
</li>
<li><p> For outside cases, set Infected_last to be no later than symptom onset.
</p>
</li>
<li><p> For Wuhan-exported cases, set Infected_last to no later than symptom onset and end of Wuhan stay.
</p>
</li></ol>



<h3>Value</h3>

<p>A data frame
</p>


<h3>Author(s)</h3>

<p>Nianqiao Ju &lt;nju@g.harvard.edu&gt;, Qingyuan Zhao &lt;qyzhao@statslab.cam.ac.uk&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(covid19_data)
head(data &lt;- preprocess.data(covid19_data))

 ## This is how the wuhan_exported data frame is created
data &lt;- subset(data, Symptom &lt; Inf)
data &lt;- subset(data, Arrived &lt;= 54)
data$Location &lt;- do.call(rbind, strsplit(as.character(data$Case), "-"))[, 1]
wuhan_exported &lt;- data.frame(Location = data$Location,
                             B = data$Begin_Wuhan,
                             E = data$End_Wuhan,
                             S = data$Symptom)
## devtools::use_data(wuhan_exported)


</code></pre>

<hr>
<h2 id='simulate.case'>Simulate case information from the generative BETS model</h2><span id='topic+simulate.case'></span>

<h3>Description</h3>

<p>Simulate case information from the generative BETS model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'case'
simulate(
  n = 1e+07,
  params = c(pi = 0.1, lambda_w = 5e-04, lambda_v = 0.001, kappa = 4e-08, r = 0.2, alpha
    = 9, beta = 1.5, L = 53.5)
)
</code></pre>

<hr>
<h2 id='wuhan_exported'>COVID-19 exported from Wuhan</h2><span id='topic+wuhan_exported'></span>

<h3>Description</h3>

<p>Constructed from <code>covid19_data</code>, see <code>example(preprocess.data)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wuhan_exported
</code></pre>


<h3>Format</h3>

<p>A data frame with 378 rows and 4 variables:
</p>

<dl>
<dt>Location</dt><dd><p>Where the case is confirmed.</p>
</dd>
<dt>Gender</dt><dd><p>Gender of the patient.</p>
</dd>
<dt>Age</dt><dd><p>Age of the patient.</p>
</dd>
<dt>B</dt><dd><p>Beginning of stay in Wuhan.</p>
</dd>
<dt>E</dt><dd><p>End of stay in Wuhan.</p>
</dd>
<dt>S</dt><dd><p>Symptom onset.</p>
</dd>
</dl>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
