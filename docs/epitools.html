<!DOCTYPE html><html><head><title>Help for package epitools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {epitools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ageadjust.direct'><p>Age standardization by direct method, with exact confidence intervals</p></a></li>
<li><a href='#ageadjust.indirect'><p>Age standardization by indirect method, with exact confidence intervals</p></a></li>
<li><a href='#as.hour'><p>Convert date-time object into hour units</p></a></li>
<li><a href='#as.month'><p>Convert dates into months of the year for plotting epidemic curves</p></a></li>
<li><a href='#as.week'><p>Convert dates object in 'disease week' for plotting epidemic curves</p></a></li>
<li><a href='#binom.conf.int'><p>Confidence intervals for binomial counts or proportions</p></a></li>
<li><a href='#colorbrewer'><p>Display and create ColorBrewer palettes</p></a></li>
<li><a href='#colors.plot'><p>Plots R's 657 named colors for selection</p></a></li>
<li><a href='#epicurve'>
<p>Construct an epidemic curve</p></a></li>
<li><a href='#epidate'><p>Convert dates into multiple legible formats</p></a></li>
<li><a href='#epitab'><p>Epidemiologic tabulation for a cohort or case-control study</p></a></li>
<li><a href='#epitable'><p>Create r x c contigency table (exposure levels vs. binary outcome)</p></a></li>
<li><a href='#expand.table'><p>Expand contingency table into individual-level data set</p></a></li>
<li><a href='#expected'><p>Expected values in a table</p></a></li>
<li><a href='#julian2date'><p>Convert a julian date into standard a date format</p></a></li>
<li><a href='#kapmeier'><p>Implements product-limit (Kaplan-Meier) method</p></a></li>
<li><a href='#oddsratio'><p>Odds ratio estimation and confidence intervals</p></a></li>
<li><a href='#or.midp'><p>Odds ratio estimation and confidence intervals using mid-p method</p></a></li>
<li><a href='#ormidp.test'><p>odds ratio test for independence (p value) for a 2x2 table</p></a></li>
<li><a href='#oswego'><p>Outbreak of Gastrointestinal Illness in Oswego County, 1940</p></a></li>
<li><a href='#pois.conf.int'><p>Confidence intervals for Poisson counts or rates</p></a></li>
<li><a href='#probratio'><p>Obtain unbiased probability ratios from logistic regression models</p></a></li>
<li><a href='#rate2by2.test'><p>Comparative tests of independence in rx2 rate tables</p></a></li>
<li><a href='#rateratio'><p>Rate ratio estimation and confidence intervals</p></a></li>
<li><a href='#ratetable'>
<p>Create r x 2 count and person-time table for calculating rates</p></a></li>
<li><a href='#riskratio'><p>Risk ratio estimation and confidence intervals</p></a></li>
<li><a href='#tab2by2.test'><p>Comparative tests of independence in rx2 contigency tables</p></a></li>
<li><a href='#table.margins'><p>Marginal totals of a table</p></a></li>
<li><a href='#wcgs'><p>Western Collaborative Group Study data</p></a></li>
<li><a href='#wnv'><p>West Nile Virus human cases reported in California, USA, as of December 14, 2004</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.5-10.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-10-26</td>
</tr>
<tr>
<td>Title:</td>
<td>Epidemiology Tools</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for training and practicing epidemiologists including methods for two-way and multi-way contingency tables.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-22 09:25:51 UTC; hornik</td>
</tr>
<tr>
<td>Author:</td>
<td>Tomas J. Aragon [aut],
  Michael P. Fay [ctb],
  Daniel Wollschlaeger [ctb],
  Adam Omidpanah [cre, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adam Omidpanah &lt;adam.omidpanah@wsu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-22 09:46:12 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
</table>
<hr>
<h2 id='ageadjust.direct'>Age standardization by direct method, with exact confidence intervals</h2><span id='topic+ageadjust.direct'></span>

<h3>Description</h3>

<p>Calculates age standardized (adjusted) rates and &quot;exact&quot; confidence
intervals using the direct method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ageadjust.direct(count, pop, rate = NULL, stdpop, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ageadjust.direct_+3A_count">count</code></td>
<td>
<p>vector of age-specific count of events</p>
</td></tr>
<tr><td><code id="ageadjust.direct_+3A_pop">pop</code></td>
<td>
<p>vector of age-specific person-years or population estimates</p>
</td></tr>
<tr><td><code id="ageadjust.direct_+3A_rate">rate</code></td>
<td>
<p>vector of age-specific rates</p>
</td></tr>
<tr><td><code id="ageadjust.direct_+3A_stdpop">stdpop</code></td>
<td>
<p>vector of age-specific standarad population</p>
</td></tr>
<tr><td><code id="ageadjust.direct_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level (default = 0.95)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To make valid comparisons between rates from different groups (e.g.,
geographic area, ethnicity), one must often adjust for differences in
age distribution to remove the confounding affect of age. When the
number of events or rates are very small (as is often the case for
local area studies), the normal approximation  method of calculating
confidence intervals may give a negative number for the lower
confidence limit. To avoid this common pitfall, one can approximate
exact confidence intervals. This function implements this  method
(Fay 1997).
</p>
<p>Original function written by TJ Aragon, based on Anderson,
1998. Function re-written and improved by MP Fay, based on Fay 1998.
</p>


<h3>Value</h3>

<table>
<tr><td><code>crude.rate</code></td>
<td>
<p>crude (unadjusted) rate</p>
</td></tr>
<tr><td><code>adj.rate</code></td>
<td>
<p>age-adjusted rate</p>
</td></tr>
<tr><td><code>lci</code></td>
<td>
<p>lower confidence interval limit</p>
</td></tr>
<tr><td><code>uci</code></td>
<td>
<p>upper confidence interval limit</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael P. Fay, <a href="mailto:mfay@niaid.nih.gov">mfay@niaid.nih.gov</a>; Tomas Aragon,
<a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>, <a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>Fay MP, Feuer EJ. Confidence intervals for directly standardized
rates: a method based on the gamma distribution. Stat Med. 1997 Apr
15;16(7):791-801. PMID: 9131766
</p>
<p>Steve Selvin. Statistical Analysis of Epidemiologic Data (Monographs in
Epidemiology and Biostatistics, V. 35), Oxford University Press; 3rd
edition (May 1, 2004)
</p>
<p>Anderson RN, Rosenberg HM. Age Standardization of Death
Rates: Implementation of the Year 200 Standard. National Vital
Statistics Reports; Vol 47 No. 3. Hyattsville, Maryland: National
Center for Health Statistics. 1998, pp. 13-19. Available at
<a href="http://www.cdc.gov/nchs/data/nvsr/nvsr47/nvs47_03.pdf">http://www.cdc.gov/nchs/data/nvsr/nvsr47/nvs47_03.pdf</a>.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+ageadjust.indirect">ageadjust.indirect</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Data from Fleiss, 1981, p. 249 
population &lt;- c(230061, 329449, 114920, 39487, 14208, 3052,
72202, 326701, 208667, 83228, 28466, 5375, 15050, 175702,
207081, 117300, 45026, 8660, 2293, 68800, 132424, 98301, 
46075, 9834, 327, 30666, 123419, 149919, 104088, 34392, 
319933, 931318, 786511, 488235, 237863, 61313)
population &lt;- matrix(population, 6, 6, 
dimnames = list(c("Under 20", "20-24", "25-29", "30-34", "35-39",
"40 and over"), c("1", "2", "3", "4", "5+", "Total")))
population
count &lt;- c(107, 141, 60, 40, 39, 25, 25, 150, 110, 84, 82, 39,
3, 71, 114, 103, 108, 75, 1, 26, 64, 89, 137, 96, 0, 8, 63, 112,
262, 295, 136, 396, 411, 428, 628, 530)
count &lt;- matrix(count, 6, 6, 
dimnames = list(c("Under 20", "20-24", "25-29", "30-34", "35-39",
"40 and over"), c("1", "2", "3", "4", "5+", "Total")))
count

### Use average population as standard
standard&lt;-apply(population[,-6], 1, mean)
standard

### This recreates Table 1 of Fay and Feuer, 1997
birth.order1&lt;-ageadjust.direct(count[,1],population[,1],stdpop=standard)
round(10^5*birth.order1,1)

birth.order2&lt;-ageadjust.direct(count[,2],population[,2],stdpop=standard)
round(10^5*birth.order2,1)

birth.order3&lt;-ageadjust.direct(count[,3],population[,3],stdpop=standard)
round(10^5*birth.order3,1)

birth.order4&lt;-ageadjust.direct(count[,4],population[,4],stdpop=standard)
round(10^5*birth.order4,1)

birth.order5p&lt;-ageadjust.direct(count[,5],population[,5],stdpop=standard)
round(10^5*birth.order5p,1)

</code></pre>

<hr>
<h2 id='ageadjust.indirect'>Age standardization by indirect method, with exact confidence intervals</h2><span id='topic+ageadjust.indirect'></span>

<h3>Description</h3>

<p>Calculates age standardized (adjusted) rates and &quot;exact&quot; confidence
intervals using the indirect method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ageadjust.indirect(count, pop, stdcount, stdpop, stdrate = NULL,
conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ageadjust.indirect_+3A_count">count</code></td>
<td>
<p>vector of age-specific count of events</p>
</td></tr>
<tr><td><code id="ageadjust.indirect_+3A_pop">pop</code></td>
<td>
<p>vector of age-specific person-years or population estimates</p>
</td></tr>
<tr><td><code id="ageadjust.indirect_+3A_stdcount">stdcount</code></td>
<td>
<p>vector of age-specific standard counts</p>
</td></tr>
<tr><td><code id="ageadjust.indirect_+3A_stdpop">stdpop</code></td>
<td>
<p>vector of age-specific standarad population</p>
</td></tr>
<tr><td><code id="ageadjust.indirect_+3A_stdrate">stdrate</code></td>
<td>
<p>vector of age-specific standard rates</p>
</td></tr>
<tr><td><code id="ageadjust.indirect_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level (default = 0.95)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To make valid comparisons between rates from different groups (e.g.,
geographic area, ethnicity), one must often adjust for differences in
age distribution to remove the confounding affect of age. When the
number of events or rates are very small (as is often the case for
local area studies), the normal approximation  method of calculating
confidence intervals may give a negative number for the lower
confidence limit. To avoid this common pitfall, one can approximate
exact confidence intervals. This function implements this  method
(Anderson 1998).
</p>


<h3>Value</h3>

<table>
<tr><td><code>$sir</code></td>
<td>
<p>observed, expected, standardized incidence ratio, and
confidence interval</p>
</td></tr>
<tr><td><code>$rate</code></td>
<td>
<p>crude.rate, adjusted rate, and confidence interval</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Visit <a href="https://repitools.wordpress.com/">https://repitools.wordpress.com/</a> for the latest</p>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a>. Thanks to Giles Crane
(<a href="mailto:giles.crane@doh.state.nj.us">giles.crane@doh.state.nj.us</a>) for reporting error in
'ageadjust.indirect' function.</p>


<h3>References</h3>

<p>Anderson RN, Rosenberg HM. Age Standardization of Death
Rates: Implementation of the Year 200 Standard. National Vital
Statistics Reports; Vol 47 No. 3. Hyattsville, Maryland: National
Center for Health Statistics. 1998, pp. 13-19. Available at
<a href="http://www.cdc.gov/nchs/data/nvsr/nvsr47/nvs47_03.pdf">http://www.cdc.gov/nchs/data/nvsr/nvsr47/nvs47_03.pdf</a>.
</p>
<p>Steve Selvin. Statistical Analysis of Epidemiologic Data (Monographs in
Epidemiology and Biostatistics, V. 35), Oxford University Press; 3rd
edition (May 1, 2004) 
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+ageadjust.direct">ageadjust.direct</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##From Selvin (2004)
##enter data
dth60 &lt;- c(141, 926, 1253, 1080, 1869, 4891, 14956, 30888,
41725, 26501, 5928)

pop60 &lt;- c(1784033, 7065148, 15658730, 10482916, 9939972,
10563872, 9114202, 6850263, 4702482, 1874619, 330915)

dth40 &lt;- c(45, 201, 320, 670, 1126, 3160, 9723, 17935,
22179, 13461, 2238)

pop40 &lt;- c(906897, 3794573, 10003544, 10629526, 9465330,
8249558, 7294330, 5022499, 2920220, 1019504, 142532)

##calculate age-specific rates
rate60 &lt;- dth60/pop60
rate40 &lt;- dth40/pop40

#create array for display
tab &lt;- array(c(dth60, pop60, round(rate60*100000,1), dth40, pop40,
round(rate40*100000,1)),c(11,3,2))
agelabs &lt;- c("&lt;1", "1-4", "5-14", "15-24", "25-34", "35-44", "45-54",
"55-64", "65-74", "75-84", "85+")
dimnames(tab) &lt;- list(agelabs,c("Deaths", "Population", "Rate"),
c("1960", "1940"))
tab

##implement direct age standardization using 'ageadjust.direct'
dsr &lt;- ageadjust.direct(count = dth40, pop = pop40, stdpop = pop60)
round(100000*dsr, 2) ##rate per 100,000 per year

##implement indirect age standardization using 'ageadjust.indirect'
isr &lt;- ageadjust.indirect(count = dth40, pop = pop40,
                          stdcount = dth60, stdpop = pop60)
round(isr$sir, 2)         ##standarized incidence ratio
round(100000*isr$rate, 1) ##rate per 100,000 per year

</code></pre>

<hr>
<h2 id='as.hour'>Convert date-time object into hour units</h2><span id='topic+as.hour'></span>

<h3>Description</h3>

<p>Convert date-time object into hour or half-hour units
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.hour(x, mindt, maxdt, half.hour = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.hour_+3A_x">x</code></td>
<td>

<p>Date-time object in standard format: for example, &quot;2004-12-23 08:27:00&quot;, &quot;2004-12-23 08:27&quot;, &quot;2004-12-23&quot;
</p>
</td></tr>
<tr><td><code id="as.hour_+3A_mindt">mindt</code></td>
<td>

<p>[required] Date-time object in standard format that will form the lower
boundary of the hour or half-hour time categories. <code>mindt</code> must
less than or equal to the minimum value in <code>x</code>, and must be rounded
off to the nearst hour for hour categories (e.g., HH:00:00) or rounded
off to the nearest half-hour for half-hour categories (e.g., HH:30:00).
</p>
</td></tr>
<tr><td><code id="as.hour_+3A_maxdt">maxdt</code></td>
<td>

<p>[required] Date-time object in standard format that will form the upper
boundary of the hour or half-hour time categories. <code>maxdt</code> must
greater than or equal to the minimum value in <code>x</code>, and must be rounded
off to the nearst hour for hour categories (e.g., HH:00:00) or rounded
off to the nearest half-hour for half-hour categories (e.g., HH:30:00).
</p>
</td></tr>
<tr><td><code id="as.hour_+3A_half.hour">half.hour</code></td>
<td>

<p>Set to TRUE for half-hour categories.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function (1) converts standard date-time objects into 1-hour or
1/2-hour categories, and (2) generates levels for range of values that
that the new 1-hour or 1/2-hour categories can take. These levels are
use for converting x into a factor and for providing names for labeling
the x-axis in plot. This function is used by <code>epicurves.hours</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>$ct</code></td>
<td>

<p>Date-time object that contains the number of seconds since the beginning
of 1970 as a numeric vector and produced by <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. You
can use <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt</a></code> to convert this output in human legible
(already done by this function).
</p>
</td></tr>
<tr><td><code>$sec</code></td>
<td>
<p>seconds</p>
</td></tr>
<tr><td><code>$min</code></td>
<td>
<p>minutes</p>
</td></tr>
<tr><td><code>$hour</code></td>
<td>
<p>hours (0-23)</p>
</td></tr>
<tr><td><code>$hour12</code></td>
<td>
<p>hours (1-12)</p>
</td></tr>
<tr><td><code>$stratum</code></td>
<td>
<p>number of hours or 1/2 hours since beginning of 1970</p>
</td></tr>
<tr><td><code>$stratum2</code></td>
<td>

<p>factor (categorical variable) with number of hours of 1/2 hours since
beginning of 1970 using <code>$cstratum</code> as the levels
</p>
</td></tr>
<tr><td><code>$stratum3</code></td>
<td>

<p>factor (categorical variable) in standard date-time format indicating
number of hours or 1/2 hours since beginning of 1970 using
<code>$cstratum2</code> as the levels 
</p>
</td></tr>
<tr><td><code>$cstratum</code></td>
<td>
<p>levels for creating <code>$stratum2</code> factor</p>
</td></tr>
<tr><td><code>$cstratum2</code></td>
<td>
<p>levels for creating <code>$stratum3</code> factor</p>
</td></tr>
<tr><td><code>$csec</code></td>
<td>
<p>seconds from <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cmin</code></td>
<td>
<p>minutes from <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$chour</code></td>
<td>
<p>hours from <code>$cstratum2</code> in 24-hour format</p>
</td></tr>
<tr><td><code>$chour12</code></td>
<td>
<p>hours from <code>$cstratum2</code> in 12-hour format</p>
</td></tr>
<tr><td><code>$campm</code></td>
<td>
<p>corresponding 'AM' or 'PM' for <code>$chour12</code></p>
</td></tr>
<tr><td><code>$campm2</code></td>
<td>
<p>corresponding 'am' or 'pm' for <code>$chour12</code></p>
</td></tr>
<tr><td><code>$cweekday</code></td>
<td>
<p>day of the week for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cwkday</code></td>
<td>
<p>abbreviated day of the week for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cmday</code></td>
<td>
<p>day of the month for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cmonth</code></td>
<td>
<p>month for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cmon</code></td>
<td>
<p>abbreviated month for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cyear</code></td>
<td>
<p>year for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$half.hour</code></td>
<td>

<p>FALSE (default) for 1-hour categories; TRUE for
1/2-hour categories</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>none</p>


<h3>See Also</h3>

<p>epitools: <code><a href="#topic+as.month">as.month</a></code>, <code><a href="#topic+epicurve.dates">epicurve.dates</a></code>
</p>
<p><code><a href="base.html#topic+as.Date">as.Date</a></code>, <code><a href="base.html#topic+strptime">strptime</a></code>,
<code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
dates &lt;- c("1/1/04", "1/2/04", "1/3/04", "1/4/04", "1/5/04",
"1/6/04", "1/7/04", "1/8/04", "1/9/04", "1/10/04", NA, "1/12/04",
"1/14/04", "3/5/04", "5/5/04", "7/6/04", "8/18/04", "12/13/05",
"1/5/05", "4/6/05", "7/23/05", "10/3/05")
aw &lt;- as.week(dates, format = "%m/%d/%y")
aw

aw2 &lt;- as.week(dates, format = "%m/%d/%y", sunday= FALSE)
aw2

aw3 &lt;- as.week(dates, format = "%m/%d/%y", min.date="2003-01-01")
aw3

</code></pre>

<hr>
<h2 id='as.month'>Convert dates into months of the year for plotting epidemic curves</h2><span id='topic+as.month'></span>

<h3>Description</h3>

<p>Converts dates into months of the year (1-12); but also creates range
of calendar months that can be used to plot an epidemic curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.month(x, format = "%Y-%m-%d",
         min.date, max.date, before = 31, after = 31,
         origin = as.Date("1970-01-01"), abbreviate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.month_+3A_x">x</code></td>
<td>

<p>character vector of dates
</p>
</td></tr>
<tr><td><code id="as.month_+3A_format">format</code></td>
<td>

<p>date format of <code>x</code>; default is of form &quot;2004-08-10&quot; 
</p>
</td></tr>
<tr><td><code id="as.month_+3A_min.date">min.date</code></td>
<td>

<p>[optional] minimum calendar date for plotting x-axis of an epidemic
curve; should be of the form of &quot;2004-08-10&quot;; if no date is
specified, then several days are subtracted from the minimum date in
<code>x</code> as specified by the <code>before</code> option
</p>
</td></tr>
<tr><td><code id="as.month_+3A_max.date">max.date</code></td>
<td>

<p>[optional] maximum calendar date for plotting x-axis of an epidemic
curve plot; should be f the form of &quot;2004-08-10&quot;; if no date is
specified, then several days are added to the maximum date in
<code>x</code> as specified by the <code>after</code> option
</p>
</td></tr>
<tr><td><code id="as.month_+3A_before">before</code></td>
<td>

<p>if <code>min.date</code> is not specified, then these number of days are
subtracted from the minimum date in <code>x</code> for plotting minimum
calendar date for epidemic curve
</p>
</td></tr>
<tr><td><code id="as.month_+3A_after">after</code></td>
<td>

<p>if <code>max.date</code> is not specified, then these number of days are
added to the maximum date in <code>x</code> for plotting maximum calendar
date for epidemic curve 
</p>
</td></tr>
<tr><td><code id="as.month_+3A_origin">origin</code></td>
<td>

<p>allows user to specify an alternative origin for Julian dates that
are generated by this function (default = &quot;1970-01-01&quot;)
</p>
</td></tr>
<tr><td><code id="as.month_+3A_abbreviate">abbreviate</code></td>
<td>

<p>abbreviate month names to Jan, Feb, Mar, etc.; often used for
labeling plots
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function converts dates to months (1-12). In addition, a range of
calendar months are generated that can be used to plot the x-axis of
an epidemic curve. 
</p>


<h3>Value</h3>

<p>Returns a list of the following:
</p>
<table>
<tr><td><code>$dates</code></td>
<td>

<p>input dates are converted to standard calendar date format
</p>
</td></tr>
<tr><td><code>$mon</code></td>
<td>

<p>month of the year (1-12)
</p>
</td></tr>
<tr><td><code>$month</code></td>
<td>

<p>month of the year (Jan, Feb, Mar, ...)
</p>
</td></tr>
<tr><td><code>$stratum</code></td>
<td>

<p>the Julian date for the mid-month day of the <code>$mon</code> value
</p>
</td></tr>
<tr><td><code>$stratum2</code></td>
<td>

<p>the Julian date for the mid-month day of the <code>$mon</code> value
converted to a factor with levels determined by the Julian dates
(<code>$cstratum</code>)used to plot an epidemic curve
</p>
</td></tr>
<tr><td><code>$stratum3</code></td>
<td>

<p>the mid-month day of the <code>$mon</code> value converted to standard
calendar dates
</p>
</td></tr>
<tr><td><code>$cmon</code></td>
<td>

<p>the month of the year (1-12) used for plotting the x-axis of the
epidemic curve
</p>
</td></tr>
<tr><td><code>$cmonth</code></td>
<td>

<p>the months (Jan, Feb, Mar, ...) for the calendar dates used for
plotting the x-axis of an epidemic curve
</p>
</td></tr>
<tr><td><code>$cstratum</code></td>
<td>

<p>the Julian date for the mid-month day of the <code>$cmonth</code> value
used for plotting the x-axis of an epidemic curve
</p>
</td></tr>
<tr><td><code>$cstratum2</code></td>
<td>

<p>the standard calendar date for the mid-month day of the
<code>$cmonth</code> value used for plotting the x-axis of an epidemic
curve 
</p>
</td></tr>
<tr><td><code>$cmday</code></td>
<td>

<p>the day of the mon (1-31) for the calendar dates used for plotting
the x-axis of an epidemic curve
</p>
</td></tr>
<tr><td><code>$cyear</code></td>
<td>

<p>the years (e.g., 1996, 2001, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>, <a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>none</p>


<h3>See Also</h3>

<p>epitools: <code><a href="#topic+as.week">as.week</a></code>, <code><a href="#topic+epicurve.dates">epicurve.dates</a></code>
</p>
<p><code><a href="base.html#topic+as.Date">as.Date</a></code>, <code><a href="base.html#topic+strptime">strptime</a></code>,
<code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>dates &lt;- c("1/1/04", "1/2/04", "1/3/04", "1/4/04", "1/5/04", "1/6/04",
"1/7/04", "1/8/04", "1/9/04", "1/10/04", NA, "1/12/04", "1/14/04",
"3/5/04", "5/5/04", "7/6/04", "8/18/04", "12/13/05", "1/5/05",
"4/6/05", "7/23/05", "10/3/05")
aw &lt;- as.month(dates, format = "%m/%d/%y")
aw

aw2 &lt;- as.month(dates, format = "%m/%d/%y", min.date="2003-01-01")
aw2

</code></pre>

<hr>
<h2 id='as.week'>Convert dates object in 'disease week' for plotting epidemic curves</h2><span id='topic+as.week'></span>

<h3>Description</h3>

<p>Convert dates into &quot;disease week&quot; with values of 1 to 53 for plotting
epidemic curves  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.week(x, format = "%Y-%m-%d", 
        min.date, max.date, before = 7, after = 7,
        origin = as.Date("1970-01-01"), sunday = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.week_+3A_x">x</code></td>
<td>

<p>character vector of dates
</p>
</td></tr>
<tr><td><code id="as.week_+3A_format">format</code></td>
<td>

<p>date format of <code>x</code>; default is of form &quot;2004-08-10&quot; 
</p>
</td></tr>
<tr><td><code id="as.week_+3A_min.date">min.date</code></td>
<td>

<p>[optional] minimum calendar date for plotting x-axis of an epidemic
curve; should be of the form of &quot;2004-08-10&quot;; if no date is
specified, then several days are subtracted from the minimum date in
<code>x</code> as specified by the <code>before</code> option
</p>
</td></tr>
<tr><td><code id="as.week_+3A_max.date">max.date</code></td>
<td>

<p>[optional] maximum calendar date for plotting x-axis of an epidemic
curve plot; should be f the form of &quot;2004-08-10&quot;; if no date is
specified, then several days are added to the maximum date in
<code>x</code> as specified by the <code>after</code> option
</p>
</td></tr>
<tr><td><code id="as.week_+3A_before">before</code></td>
<td>

<p>if <code>min.date</code> is not specified, then these number of days are
subtracted from the minimum date in <code>x</code> for plotting minimum
calendar date for epidemic curve
</p>
</td></tr>
<tr><td><code id="as.week_+3A_after">after</code></td>
<td>

<p>if <code>max.date</code> is not specified, then these number of days are
added to the maximum date in <code>x</code> for plotting maximum calendar
date for epidemic curve 
</p>
</td></tr>
<tr><td><code id="as.week_+3A_origin">origin</code></td>
<td>

<p>allows user to specify an alternative origin for Julian dates that
are generated by this function (default = &quot;1970-01-01&quot;)
</p>
</td></tr>
<tr><td><code id="as.week_+3A_sunday">sunday</code></td>
<td>

<p>First day of the week is Sunday (default = TRUE); setting to FALSE
makes Monday the first day of the week
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In public health, reportable diseases are often reported by 'disease
week' (either week of reporting or week of symptom onset). In R, weeks
are numbered from 0 to 53 in the same year. The first day of week 1
starts with either the first Sunday or Monday of the year. Days before
week 1 are numbered as 0s.
</p>
<p>In contrast to R, the <code>as.week</code> function generates weeks numbered
from 1 to 53. The week before week 1 takes on the value (52 or 53)
from the last week of the previous year. The <code>as.week</code> functions
facilitates working with multiple years and generating epidemic curves.
</p>


<h3>Value</h3>

<p>Returns a list of the following:
</p>
<table>
<tr><td><code>$dates</code></td>
<td>

<p>input dates are converted to standard calendar date format
</p>
</td></tr>
<tr><td><code>$firstday</code></td>
<td>

<p>first day of the week is reported
</p>
</td></tr>
<tr><td><code>$week</code></td>
<td>

<p>week of the year (1-53); note that week 52 or 53 can represent both
last week of a year but also the first few days at the beginning of
the year
</p>
</td></tr>
<tr><td><code>$stratum</code></td>
<td>

<p>the Julian date for the mid-week day of the <code>$week</code> value
</p>
</td></tr>
<tr><td><code>$stratum2</code></td>
<td>

<p>the Julian date for the mid-week day of the <code>$week</code> value
converted to a factor with levels determined by the Julian dates
(<code>$cstratum</code>) used to plot the epidemic curve
</p>
</td></tr>
<tr><td><code>$stratum3</code></td>
<td>

<p>the mid-week day of the <code>$week</code> value converted to standard
calendar dates
</p>
</td></tr>
<tr><td><code>$cweek</code></td>
<td>

<p>the week of the year used for plotting the x-axis of an epidemic
curve
</p>
</td></tr>
<tr><td><code>$cstratum</code></td>
<td>

<p>the Julian date for the mid-week day of the <code>$cweek</code> value used
for plotting the x-axis of an epidemic curve
</p>
</td></tr>
<tr><td><code>$cstratum2</code></td>
<td>

<p>the standard calendar date for the mid-week day of the <code>$cweek</code>
value used for plotting the x-axis of an epidemic curve
</p>
</td></tr>
<tr><td><code>$cmday</code></td>
<td>

<p>the day of the mon (1-31) for the calendar dates used for plotting
the x-axis of an epidemic curve
</p>
</td></tr>
<tr><td><code>$cmonth</code></td>
<td>

<p>the months (Jan, Feb, Mar, ...) for the calendar dates used for
plotting the x-axis of an epidemic curve
</p>
</td></tr>  
<tr><td><code>$cyear</code></td>
<td>

<p>the years (e.g., 1996, 2001, ...) for the calendar dates used for
plotting the x-axis of an epidemic curve
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>none</p>


<h3>See Also</h3>

<p>epitools: <code><a href="#topic+as.month">as.month</a></code>, <code><a href="#topic+epicurve.dates">epicurve.dates</a></code>
</p>
<p><code><a href="base.html#topic+as.Date">as.Date</a></code>, <code><a href="base.html#topic+strptime">strptime</a></code>,
<code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>dates &lt;- c("1/1/04", "1/2/04", "1/3/04", "1/4/04", "1/5/04",
"1/6/04", "1/7/04", "1/8/04", "1/9/04", "1/10/04", NA, "1/12/04",
"1/14/04", "3/5/04", "5/5/04", "7/6/04", "8/18/04", "12/13/05",
"1/5/05", "4/6/05", "7/23/05", "10/3/05")
aw &lt;- as.week(dates, format = "%m/%d/%y")
aw

aw2 &lt;- as.week(dates, format = "%m/%d/%y", sunday= FALSE)
aw2

aw3 &lt;- as.week(dates, format = "%m/%d/%y", min.date="2003-01-01")
aw3

</code></pre>

<hr>
<h2 id='binom.conf.int'>Confidence intervals for binomial counts or proportions</h2><span id='topic+binom.exact'></span><span id='topic+binom.wilson'></span><span id='topic+binom.approx'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for binomial counts or proportions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binom.exact(x, n, conf.level = 0.95)
binom.wilson(x, n, conf.level = 0.95)
binom.approx(x, n, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binom.conf.int_+3A_x">x</code></td>
<td>
<p>number of successes in n trials, can be a vector</p>
</td></tr>
<tr><td><code id="binom.conf.int_+3A_n">n</code></td>
<td>
<p>number of Bernoulli trials, can be a vector</p>
</td></tr>
<tr><td><code id="binom.conf.int_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level (default = 0.95), can be a vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function, <code>binom.exact</code>, calculates exact confidence intervals
for binomial counts or proportions. This function uses R's
<code>binom.test</code> function; however, the arguments to this function
can be numeric vectors of any length.
</p>
<p>The function, <code>binom.wilson</code>, calculates confidence intervals for
binomial counts or proportions using Wilson's formula which
approximate the exact method. The arguments to this function
can be numeric vectors of any length (Rothman).
</p>
<p>The function, <code>binom.approx</code>, calculates confidence intervals for
binomial counts or proportions using a normal approximation to the
binomial distribution. The arguments to this function can be numeric
vectors of any length. 
</p>


<h3>Value</h3>

<p>This function returns a n x 6 matrix with the following colnames:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>number of successes in n trials</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of Bernoulli trials</p>
</td></tr>
<tr><td><code>prop</code></td>
<td>
<p>proportion = x/n</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>lower confidence interval limit</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>upper confidence interval limit</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>confidence level</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>Tomas Aragon, et al. Applied Epidemiology Using R. Available at
<a href="http://www.phdata.science">http://www.phdata.science</a>
</p>
<p>Kenneth Rothman (2002), Epidemiology: An Introduction, Oxford
University Press, 1st Edition.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pois.exact">pois.exact</a></code>, <code><a href="stats.html#topic+binom.test">binom.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>binom.exact(1:10, seq(10, 100, 10))
binom.wilson(1:10, seq(10, 100, 10))
binom.approx(1:10, seq(10, 100, 10))
</code></pre>

<hr>
<h2 id='colorbrewer'>Display and create ColorBrewer palettes</h2><span id='topic+colorbrewer.display'></span><span id='topic+colorbrewer.palette'></span><span id='topic+colorbrewer.data'></span>

<h3>Description</h3>

<p>Display and create ColorBrewer palettes based on Cindy Brewer's website
at www.colorbrewer.org. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colorbrewer.display(nclass = 5,
                    type = c("qualitative", "sequential", "diverging"),
                    col.bg = "white")
colorbrewer.palette(nclass = 5,
                    type = c("qualitative", "sequential", "diverging"),
                    palette = letters[1:18])
colorbrewer.data()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colorbrewer_+3A_nclass">nclass</code></td>
<td>
<p>number of classes or categories to be compared
graphically</p>
</td></tr> 
<tr><td><code id="colorbrewer_+3A_type">type</code></td>
<td>
<p>select either 'qualitative' (default), 'sequential', or
'diverging'</p>
</td></tr>
<tr><td><code id="colorbrewer_+3A_col.bg">col.bg</code></td>
<td>
<p>set background color (default is white)</p>
</td></tr> 
<tr><td><code id="colorbrewer_+3A_palette">palette</code></td>
<td>
<p>select palette (letter) from displayed plot</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>These R functions includes color specifications and designs developed
by Cynthia Brewer (<a href="http://www.colorbrewer.org">http://www.colorbrewer.org</a>). For more
details on color selection please visit this excellent site.
</p>
<p>First, select the number of classes or categories to be
compared (<code>nclass</code>). Second, select the <code>type</code> of comparison
(qualitative  vs. sequential vs. diverging). Third, use
<code>colorbrewer.display</code> to display the available ColorBrewer
palette for a given type and number of classes. Fourth, using the
<code>colorbrewer.palette</code> function, create a color palette for use in
R graphics functions (e.g, col = mypal, where mypal was created from
<code>colorbrewer.palette</code>).
</p>
<p>Note that you can change the background color.
</p>
<p>ColorBrewer is Copyright (c) 2002 Cynthia Brewer, Mark Harrower, and
The Pennsylvania State University. All rights reserved. The
ColorBrewer palettes have been included in this R package with
permission of the copyright holder. Copyright and license information
at <a href="http://www.colorbrewer.org">http://www.colorbrewer.org</a>.
</p>
<p>These functions for <code>epitools</code> were created to make the
ColorBrewer palettes readily  available to <code>epitools</code> users, and
to have the same 3-step selection order as the
<a href="www.colorbrewer.org">www.colorbrewer.org</a> site. A more visually appealing display of
the ColorBrewer schemes is available in the <code>RColorBrewer</code> package.
</p>


<h3>Value</h3>

<p><code>colorbrewer.display</code> displays ColorBrewer selection and invisibly
returns data that corresponds to graphical display
</p>
<p><code>colorbrewer.palette</code> returns <code>rgb</code> vector palette  
</p>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a>
</p>


<h3>References</h3>

<p>ColorBrewer, by Cynthia Brewer, Pennsylvanis State University,
<a href="mailto:cbrewer@psu.edu">cbrewer@psu.edu</a>, <a href="http://www.colorbrewer.org">http://www.colorbrewer.org</a> accessed on
2004-11-26 
</p>


<h3>See Also</h3>

<p><code>epitools</code> package: <code><a href="#topic+colors.plot">colors.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##display available palettes for given nclass and type
colorbrewer.display(9, "sequential")

##change background to blue
colorbrewer.display(9, "sequential", "blue")

##display available palettes for given nclass and type,
##but also display RGB numbers to create your own palette
cbrewer.9s &lt;- colorbrewer.display(9, "sequential")
cbrewer.9s


##Display and use ColorBrewer palette
##first, display and choose palette (letter)
colorbrewer.palette(10, "q")

##second, extract and use ColorBrewer palette
mycolors &lt;- colorbrewer.palette(nclass = 10, type = "q", palette = "b")
xx &lt;- 1:10
yy &lt;- outer(1:10, 1:10, "*")
matplot(xx,yy, type="l", col = mycolors, lty = 1, lwd = 4)

</code></pre>

<hr>
<h2 id='colors.plot'>Plots R's 657 named colors for selection</h2><span id='topic+colors.plot'></span><span id='topic+colors.matrix'></span>

<h3>Description</h3>

<p>Plots R's 657 named colors for selection
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colors.plot(locator = FALSE, cex.axis = 0.7)
colors.matrix()
</code></pre>


<h3>Arguments</h3>

<p><code>colors.plot</code>:
</p>
<table>
<tr><td><code id="colors.plot_+3A_locator">locator</code></td>
<td>
<p>activates 'locator' for interactive selection of color
names (default is FALSE)</p>
</td></tr>
<tr><td><code id="colors.plot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>change size of axes labels</p>
</td></tr>
</table>
<p><code>colors.matrix</code> has no arguments.
</p>


<h3>Details</h3>

<p>The <code>colors.plot</code> function plots R's 657 named colors. If
<code>locator=TRUE</code> then you can interactively point and click to
select the colors for which you want names. To end selection, right
click on the mouse and select 'Stop', then R returns the selected
color names.
</p>
<p>The <code>colors.matrix</code> function is used by <code>colors.plot</code> to
create the matrix of color names that corresponds to the graph created
by <code>colors.plot</code>. <code>colors.matrix</code> can be used alone to
create the matrix of name without generating a plot. To see the matrix
it must be assigned an object name and then displayed.
</p>


<h3>Value</h3>

<p><code>colors.plot</code> generates plot with R colors and, when
<code>locator=TRUE</code>, returns matrix with graph coordinates and
names of colors selected
</p>
<p><code>colors.matrix</code> quietly returns matrix of names 
</p>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>, <a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>none
</p>


<h3>See Also</h3>

<p><code><a href="#topic+colorbrewer.display">colorbrewer.display</a></code>, <code><a href="#topic+colorbrewer.palette">colorbrewer.palette</a></code>,
<code><a href="#topic+colorbrewer.data">colorbrewer.data</a></code>
</p>
<p><code><a href="grDevices.html#topic+colors">colors</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##creates matrix with color names
cm &lt;- colors.matrix()
cm[1:3, 1:3]

##generates plot
colors.plot()

##generates plot and activates 'locator'
##don't run
##colors.plot(TRUE)

</code></pre>

<hr>
<h2 id='epicurve'>
Construct an epidemic curve
</h2><span id='topic+epicurve.hours'></span><span id='topic+epicurve.dates'></span><span id='topic+epicurve.weeks'></span><span id='topic+epicurve.months'></span><span id='topic+epicurve.table'></span>

<h3>Description</h3>

<p>Construct an epidemic curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epicurve.dates(x, format = "%Y-%m-%d", strata = NULL,
               min.date, max.date, before = 7, after = 7,
               width = 1, space = 0, tick = TRUE,
               tick.offset = 0.5, segments = FALSE, ...)

epicurve.weeks(x, format = "%Y-%m-%d", strata = NULL,
               min.date, max.date, before = 7, after = 7,
               width = 1, space = 0, tick = TRUE,
               tick.offset = 0.5, segments = FALSE,
               origin = as.Date("1970-01-01"), sunday = TRUE, ...)

epicurve.months(x, format = "%Y-%m-%d", strata = NULL,
                min.date, max.date, before = 31, after = 31,
                width = 1, space = 0, tick = TRUE,
                tick.offset = 0.5, segments = FALSE,
                origin = as.Date("1970-01-01"), ...)

epicurve.hours(x, mindt, maxdt, strata = NULL, half.hour = FALSE,
               width = 1, space = 0, tick = TRUE,
               tick.offset = 0.5, segments = FALSE, ...) 

epicurve.table(x, width = 1, space = 0, tick = TRUE,
               tick.offset = 0.5, segments = FALSE, ...)
  

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epicurve_+3A_x">x</code></td>
<td>

<p>character vector of dates
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_format">format</code></td>
<td>

<p>date format of <code>x</code>; default is of form &quot;2004-08-10&quot; 
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_strata">strata</code></td>
<td>

<p>[optional] categorical vector (character or factor) for stratifying
<code>x</code> 
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_min.date">min.date</code></td>
<td>

<p>[optional] minimum calendar date for plotting x-axis of an epidemic
curve; should be of the form of &quot;2004-08-10&quot;; if no date is
specified, then several days are subtracted from the minimum date in
<code>x</code> as specified by the <code>before</code> option
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_max.date">max.date</code></td>
<td>

<p>[optional] maximum calendar date for plotting x-axis of an epidemic
curve; should be of the form of &quot;2004-08-10&quot;; if no date is
specified, then several days are added to the maximum date in
<code>x</code> as specified by the <code>after</code> option
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_before">before</code></td>
<td>

<p>if <code>min.date</code> is not specified, then these number of days are
subtracted from the minimum date in <code>x</code> for plotting minimum
calendar date for epidemic curve
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_after">after</code></td>
<td>

<p>if <code>max.date</code> is not specified, then these number of days are
added to the maximum date in <code>x</code> for plotting maximum calendar
date for epidemic curve 
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_mindt">mindt</code></td>
<td>

<p>[required] Date-time object in standard format that will form the
lower boundary of the hour or half-hour time categories. The
<code>mindt</code> option must less than or equal to the minimum value in
<code>x</code>, and must be rounded off to the nearst hour for hour
categories (e.g., HH:00:00) or rounded  off to the nearest half-hour
for half-hour categories (e.g., HH:30:00). 
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_maxdt">maxdt</code></td>
<td>

<p>[required] Date-time object in standard format that will form the
upper boundary of the hour or half-hour time categories. The
<code>maxdt</code> option must greater than or equal to the minimum value
in <code>x</code>, and must be rounded off to the nearst hour for hour
categories (e.g., HH:00:00) or rounded off to the nearest half-hour
for half-hour categories (e.g., HH:30:00). 
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_half.hour">half.hour</code></td>
<td>

<p>Set to TRUE for half-hour categories in <code>epicurve.hours</code>.
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_width">width</code></td>
<td>

<p>width of bars in the epidemic curve; this value is passed to
<code>barplot</code> function
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_space">space</code></td>
<td>

<p>space between bars in the epidemic curve; this value is passed to
<code>barplot</code> function
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_tick">tick</code></td>
<td>

<p>adds tick marks to the x-axis (default = TRUE)
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_tick.offset">tick.offset</code></td>
<td>

<p>offsets tick marks so that they plotted between the bars 
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_segments">segments</code></td>
<td>

<p>segments bars so that each box represents one case
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_origin">origin</code></td>
<td>

<p>allows user to specify an alternative origin for Julian dates that
are generated by this function (default = &quot;1970-01-01&quot;)
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_sunday">sunday</code></td>
<td>

<p>First day of the week is Sunday (default = TRUE); setting to FALSE
makes Monday the first day of the week
</p>
</td></tr>
<tr><td><code id="epicurve_+3A_...">...</code></td>
<td>

<p>options are passed to the <code>barplot</code> function
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions makes plotting epidemic curves much easier in
R. Normally, to plot an epidemic curve in R, one must do the
following: (1) have disease onset dates in some calendar date format,
(2) convert these onset dates into a factor with the levels specified
by the range of calendar dates for the x-axis of the epidemic curve,
(3) convert this factor into a table (with or without stratification),
(4) use this table as an argument in the <code>barplot</code> function to plot the
epidemic curve, and (5) make final adjustments (labels, titles, etc.).
</p>
<p>Why use the <code>barplot</code> function? Strictly speaking, an epidemic
curve is a histogram displaying the distribution of onset times which
are categorized into, for example, dates. However, histogram functions
seems to work better for measurements that our continuous (e.g.,
height, weight). In contrast, epidemic curves are constructed from
onset time data that has been categorized into days, weeks, or
months. For this type of categorical data, the <code>barplot</code> does a
better job. The caveat, however, is that we need to specify the range
of possible calendar dates, weeks, or months in order to construct an
appropriate plot. To do this we convert the data into a factor with
the levels specified by the possible calendar date values.
</p>
<p>To make this whole process much easier, and to generate additional
data that can be use for labeling your epidemic curve, the
<code>epicurve</code> functions were created.
</p>


<h3>Value</h3>

<table>
<tr><td><code>epicurve.dates</code></td>
<td>
<p>returns list:</p>
</td></tr>
<tr><td><code>$dates</code></td>
<td>

<p>input dates are converted to standard calendar date format
</p>
</td></tr>
<tr><td><code>$dates2</code></td>
<td>

<p>input dates are also converted to a factor with levels determined by
the calendar dates (<code>$cdates</code>) used to plot the epidemic curve
</p>
</td></tr>
<tr><td><code>$xvals</code></td>
<td>

<p>x-axis numeric values used for plotting the epidemic curve; this
comes from the <code>barplot</code> function
</p>
</td></tr>
<tr><td><code>$cdates</code></td>
<td>

<p>the calendar dates used for plotting the epidemic curve
</p>
</td></tr>
<tr><td><code>$cmday</code></td>
<td>

<p>the day of the mon (1-31) for the calendar dates used for plotting
the x-axis of the epidemic curve  
</p>
</td></tr>
<tr><td><code>$cmonth</code></td>
<td>

<p>the months (Jan, Feb, Mar, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td></tr>
<tr><td><code>$cyear</code></td>
<td>

<p>the years (e.g., 1996, 2001, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td></tr>
<tr><td><code>epicurve.weeks</code></td>
<td>
<p>returns list:</p>
</td></tr>
<tr><td><code>$dates</code></td>
<td>

<p>input dates are converted to standard calendar date format
</p>
</td></tr>
<tr><td><code>$firstday</code></td>
<td>

<p>first day of the week is reported
</p>
</td></tr>
<tr><td><code>$week</code></td>
<td>

<p>week of the year (1-53); note that week 52 or 53 can represent both
last week of a year but also the first few days at the beginning of
the year 
</p>
</td></tr>
<tr><td><code>$stratum</code></td>
<td>

<p>the Julian date for the mid-week day of the <code>$week</code> value
</p>
</td></tr>
<tr><td><code>$stratum2</code></td>
<td>

<p>the Julian date for the mid-week day of the <code>$week</code> value
converted to a factor with levels determined by the Julian dates
(<code>$cstratum</code>) used to plot the epidemic curve 
</p>
</td></tr>
<tr><td><code>$stratum3</code></td>
<td>

<p>the mid-week day of the <code>$week</code> value converted to standard
calendar dates  
</p>
</td></tr>
<tr><td><code>$xvals</code></td>
<td>

<p>x-axis numeric values used for plotting the epidemic curve; this
comes from the <code>barplot</code> function
</p>
</td></tr>
<tr><td><code>$cweek</code></td>
<td>

<p>the week of the year used for plotting the x-axis of the epidemic
curve    
</p>
</td></tr>
<tr><td><code>$cstratum</code></td>
<td>

<p>the Julian date for the mid-week day of the <code>$cweek</code> value used
for plotting the x-axis of the epidemic curve 
</p>
</td></tr>
<tr><td><code>$cstratum2</code></td>
<td>

<p>the standard calendar date for the mid-week day of the <code>$cweek</code>
value used for plotting the x-axis of the epidemic curve
</p>
</td></tr>
<tr><td><code>$cmday</code></td>
<td>

<p>the day of the mon (1-31) for the calendar dates used for plotting
the x-axis of the epidemic curve 
</p>
</td></tr>
<tr><td><code>$cmonth</code></td>
<td>

<p>the months (Jan, Feb, Mar, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td></tr>
<tr><td><code>$cyear</code></td>
<td>

<p>the years (e.g., 1996, 2001, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td></tr>
<tr><td><code>epicurve.months</code></td>
<td>
<p>returns list:</p>
</td></tr>
<tr><td><code>$dates</code></td>
<td>

<p>input dates are converted to standard calendar date format
</p>
</td></tr>
<tr><td><code>$mon</code></td>
<td>

<p>month of the year (1-12)
</p>
</td></tr>
<tr><td><code>$month</code></td>
<td>

<p>month of the year (Jan, Feb, Mar, ...)
</p>
</td></tr>
<tr><td><code>$stratum</code></td>
<td>

<p>the Julian date for the mid-month day of the <code>$mon</code> value
</p>
</td></tr>
<tr><td><code>$stratum2</code></td>
<td>

<p>the Julian date for the mid-month day of the <code>$mon</code> value
converted to a factor with levels determined by the Julian dates
(<code>$cstratum</code>)used to plot the epidemic curve
</p>
</td></tr>
<tr><td><code>$stratum3</code></td>
<td>

<p>the mid-month day of the <code>$mon</code> value converted to standard
calendar dates  
</p>
</td></tr>
<tr><td><code>$xvals</code></td>
<td>

<p>x-axis numeric values used for plotting the epidemic curve; this
comes from the <code>barplot</code> function
</p>
</td></tr>
<tr><td><code>$cmon</code></td>
<td>

<p>the month of the year (1-12) used for plotting the x-axis of the
epidemic curve
</p>
</td></tr>
<tr><td><code>$cmonth</code></td>
<td>

<p>the months (Jan, Feb, Mar, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td></tr>
<tr><td><code>$cstratum</code></td>
<td>

<p>the Julian date for the mid-month day of the <code>$cmonth</code> value
used for plotting the x-axis of the epidemic curve 
</p>
</td></tr>
<tr><td><code>$cstratum2</code></td>
<td>

<p>the standard calendar date for the mid-month day of the
<code>$cmonth</code> value used for plotting the x-axis of the epidemic
curve      
</p>
</td></tr>
<tr><td><code>$cmday</code></td>
<td>

<p>the day of the mon (1-31) for the calendar dates used for plotting
the x-axis of the epidemic curve 
</p>
</td></tr>
<tr><td><code>$cyear</code></td>
<td>

<p>the years (e.g., 1996, 2001, ...) for the calendar dates used for
plotting the x-axis of the epidemic curve
</p>
</td></tr>
<tr><td><code>epicurve.hours</code></td>
<td>
<p>returns list:</p>
</td></tr>
<tr><td><code>$ct</code></td>
<td>

<p>Date-time object that contains the number of seconds since the
beginning of 1970 as a numeric vector and produced by
<code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. You can use <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt</a></code> to
convert this output in human legible (already done by this
function). 
</p>
</td></tr>
<tr><td><code>$sec</code></td>
<td>
<p>seconds</p>
</td></tr>
<tr><td><code>$min</code></td>
<td>
<p>minutes</p>
</td></tr>
<tr><td><code>$hour</code></td>
<td>
<p>hours (0-23)</p>
</td></tr>
<tr><td><code>$hour12</code></td>
<td>
<p>hours (1-12)</p>
</td></tr>
<tr><td><code>$stratum</code></td>
<td>
<p>number of hours or 1/2 hours since beginning of 1970</p>
</td></tr>
<tr><td><code>$stratum2</code></td>
<td>

<p>factor (categorical variable) with number of hours of 1/2 hours
since beginning of 1970 using <code>$cstratum</code> as the levels
</p>
</td></tr>
<tr><td><code>$stratum3</code></td>
<td>

<p>factor (categorical variable) in standard date-time format
indicating number of hours or 1/2 hours since beginning of 1970
using 
</p>
</td></tr>
<tr><td><code>$xvals</code></td>
<td>
</td></tr>
<tr><td><code>$cstratum</code></td>
<td>
<p>levels for creating <code>$stratum2</code> factor</p>
</td></tr>
<tr><td><code>$cstratum2</code></td>
<td>
<p>levels for creating <code>$stratum3</code> factor</p>
</td></tr>
<tr><td><code>$csec</code></td>
<td>
<p>seconds from <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cmin</code></td>
<td>
<p>minutes from <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$chour</code></td>
<td>
<p>hours from <code>$cstratum2</code> in 24-hour format</p>
</td></tr>
<tr><td><code>$chour12</code></td>
<td>
<p>hours from <code>$cstratum2</code> in 12-hour format</p>
</td></tr>
<tr><td><code>$campm</code></td>
<td>
<p>corresponding 'AM' or 'PM' for <code>$chour12</code></p>
</td></tr>
<tr><td><code>$campm2</code></td>
<td>
<p>corresponding 'am' or 'pm' for <code>$chour12</code></p>
</td></tr>
<tr><td><code>$cweekday</code></td>
<td>
<p>day of the week for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cwkday</code></td>
<td>
<p>abbreviated day of the week for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cmday</code></td>
<td>
<p>day of the month for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cmonth</code></td>
<td>
<p>month for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cmon</code></td>
<td>
<p>abbreviated month for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$cyear</code></td>
<td>
<p>year for <code>$cstratum2</code></p>
</td></tr>
<tr><td><code>$half.hour</code></td>
<td>

<p>FALSE (default) for 1-hour categories; TRUE for 1/2-hour categories
</p>
</td></tr>
<tr><td><code>epicurve.table</code></td>
<td>
<p>returns numeric vector:</p>
</td></tr>
<tr><td><code>xvals</code></td>
<td>

<p>x-axis numeric values used for plotting the epidemic curve; this
comes from the <code>barplot</code> function 
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>none</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+barplot">barplot</a></code>, <code><a href="base.html#topic+strptime">strptime</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##epicurve.dates
sampdates &lt;- seq(as.Date("2004-07-15"), as.Date("2004-09-15"), 1)
x &lt;- sample(sampdates, 100, rep=TRUE)
xs &lt;- sample(c("Male","Female"), 100, rep=TRUE)
epicurve.dates(x)
epicurve.dates(x, strata = xs)
rr &lt;- epicurve.dates(x, strata = xs, segments = TRUE,
                     axisnames = FALSE)
axis(1, at = rr$xvals, labels = rr$cmday, tick = FALSE, line = 0)
axis(1, at = rr$xvals, labels = rr$cmonth, tick = FALSE, line = 1)

##epicurve.weeks
sampdates &lt;- seq(as.Date("2004-07-15"), as.Date("2004-09-15"), 1)
x &lt;- sample(sampdates, 100, rep=TRUE)
xs &lt;- sample(c("Male","Female"), 100, rep=TRUE)
epicurve.weeks(x)

epicurve.weeks(x, strata = xs)

rr &lt;- epicurve.weeks(x, strata = xs, segments = TRUE)
rr


##epicurve.months
dates &lt;- c("1/1/04", "1/2/04", "1/3/04", "1/4/04", "1/5/04",
"1/6/04", "1/7/04", "1/8/04", "1/9/04", "1/10/04", NA, "1/12/04",
"1/14/04", "3/5/04", "5/5/04", "7/6/04", "8/18/04", "12/13/05",
"1/5/05", "4/6/05", "7/23/05", "10/3/05")
aw &lt;- as.month(dates, format = "%m/%d/%y")
aw
aw2 &lt;- as.month(dates, format = "%m/%d/%y", min.date="2003-01-01")
aw2

##epicurve.hours
data(oswego)
## create vector with meal date and time
mdt &lt;- paste("4/18/1940", oswego$meal.time)
mdt[1:10]
## convert into standard date and time
meal.dt &lt;- strptime(mdt, "%m/%d/%Y %I:%M %p")
meal.dt[1:10]
## create vector with onset date and time
odt &lt;- paste(paste(oswego$onset.date,"/1940",sep=""), oswego$onset.time)
odt[1:10]
## convert into standard date and time
onset.dt &lt;- strptime(odt, "%m/%d/%Y %I:%M %p")
onset.dt[1:10]      

##set colors
col3seq.d &lt;- c("#43A2CA", "#A8DDB5", "#E0F3DB")

par.fin &lt;- par()$fin
par(fin=c(5,3.4))

##1-hour categories
xv &lt;- epicurve.hours(onset.dt, "1940-04-18 12:00:00", "1940-04-19 12:00:00",
                     axisnames = FALSE, axes = FALSE, ylim = c(0,11),
                     col = col3seq.d[1], segments =  TRUE,
                     strata = oswego$sex)

hh &lt;- xv$chour12==3 | xv$chour12== 6 | xv$chour12== 9
hh2 &lt;- xv$chour12==12
hh3 &lt;- xv$chour12==1
hlab &lt;- paste(xv$chour12,xv$campm2,sep="")
hlab2 &lt;- paste(xv$cmonth,xv$cmday)
axis(1, at = xv$xval[hh], labels = xv$chour12[hh], tick = FALSE, line = -.2)
axis(1, at = xv$xval[hh2], labels = hlab[hh2], tick = FALSE, line = -.2)
axis(1, at = xv$xval[hh3], labels = hlab2[hh3], tick = FALSE, line = 1.0)
axis(2, las = 1)
title(main = "Figure 1. Cases of Gastrointestinal Illness
by Time of Onset of Symptoms (Hour Category)
Oswego County, New York, April 18-19, 2004",
      xlab = "Time of Onset",
      ylab = "Cases")

##1/2-hour categories
xv &lt;- epicurve.hours(onset.dt, "1940-04-18 12:00:00", "1940-04-19 12:00:00",
                     axisnames = FALSE, axes = FALSE, ylim = c(0,11),
                     col = col3seq.d[1], segments =  TRUE,
                     half.hour = TRUE, strata = oswego$sex)
hh &lt;- xv$chour12==3 | xv$chour12== 6 | xv$chour12== 9
hh2 &lt;- xv$chour12==12
hh3 &lt;- xv$chour12==1
hlab &lt;- paste(xv$chour12,xv$campm2,sep="")
hlab2 &lt;- paste(xv$cmonth,xv$cmday)
axis(1, at = xv$xval[hh], labels = xv$chour12[hh], tick = FALSE, line = -.2)
axis(1, at = xv$xval[hh2], labels = hlab[hh2], tick = FALSE, line = -.2)
axis(1, at = xv$xval[hh3], labels = hlab2[hh3], tick = FALSE, line = 1.0)
axis(2, las = 1)
title(main = "Figure 2. Cases of Gastrointestinal Illness
by Time of Onset of Symptoms (1/2 Hour Category)
Oswego County, New York, April 18-19, 2004",
      xlab = "Time of Onset",
      ylab = "Cases")

par(fin=par.fin)


##epicurve.table
xvec &lt;- c(1,2,3,4,5,4,3,2,1)
epicurve.table(xvec)

names(xvec) &lt;- 1991:1999
epicurve.table(xvec)

xmtx &lt;- rbind(xvec, xvec)
rownames(xmtx) &lt;- c("Male", "Female")
epicurve.table(xmtx)

epicurve.table(xmtx, seg = TRUE)


</code></pre>

<hr>
<h2 id='epidate'>Convert dates into multiple legible formats</h2><span id='topic+epidate'></span>

<h3>Description</h3>

<p>Convert character vector of dates into multiple legible formats.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epidate(x, format = "%m/%d/%Y", cal.dates = FALSE,
        before = 7, after = 7, sunday = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epidate_+3A_x">x</code></td>
<td>
<p>character vector of dates to be converted</p>
</td></tr>
<tr><td><code id="epidate_+3A_format">format</code></td>
<td>
<p>format of character vector of dates</p>
</td></tr>
<tr><td><code id="epidate_+3A_cal.dates">cal.dates</code></td>
<td>
<p>Calendar dates that contains <code>x</code>, starting 7
days 'before' (default) until 7 days 'after' <code>x</code></p>
</td></tr>
<tr><td><code id="epidate_+3A_before">before</code></td>
<td>
<p>defines lower limit of <code>cal.dates</code>: default is 7
days before earliest date in <code>x</code></p>
</td></tr>
<tr><td><code id="epidate_+3A_after">after</code></td>
<td>
<p>defines upper limit of <code>cal.dates</code>: default is 7
days after latest date in <code>x</code></p>
</td></tr>
<tr><td><code id="epidate_+3A_sunday">sunday</code></td>
<td>
<p>first day of the week is either Sunday (default) or Monday</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>Dates can come in many formats (e.g., November 12, 2001, 12Nov01,
11/12/2001, 11/12/01, 2001-11-12) and need to be converted into other
formats for data analysis, graphical displays, generating reports,
etc.
</p>
<p>There is tremendous flexibility in converting any character vector
with sufficient information to be converted into a unique date. For
complete options for the <code>format</code> option see
<code><a href="base.html#topic+strptime">strptime</a></code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>dates</code></td>
<td>
<p>dates wtih date-time class</p>
</td></tr>
<tr><td><code>julian</code></td>
<td>
<p>number of days since 1970-01-01</p>
</td></tr>
<tr><td><code>mday</code></td>
<td>
<p>day of the month: 1-31</p>
</td></tr>
<tr><td><code>mon</code></td>
<td>
<p>month of the year: 0-11</p>
</td></tr>
<tr><td><code>month</code></td>
<td>
<p>month: January, February, March, ...</p>
</td></tr>
<tr><td><code>month2</code></td>
<td>
<p>month: Jan, Feb, Mar, ...</p>
</td></tr>
<tr><td><code>firstday</code></td>
<td>
<p>first day of the week: Sunday or Monday</p>
</td></tr>
<tr><td><code>week</code></td>
<td>
<p>week of the year: 0-53</p>
</td></tr>
<tr><td><code>year</code></td>
<td>
<p>year: YYYY</p>
</td></tr>
<tr><td><code>yr</code></td>
<td>
<p>year: YY</p>
</td></tr>
<tr><td><code>wday</code></td>
<td>
<p>day of the week: 0-6</p>
</td></tr>
<tr><td><code>weekday</code></td>
<td>
<p>weekday: Monday, Tuesday, Wednesday, ...</p>
</td></tr>
<tr><td><code>wkday</code></td>
<td>
<p>weekday: Mon, Tue, Wed, ...</p>
</td></tr>
<tr><td><code>yday</code></td>
<td>
<p>day of the year: 0-365</p>
</td></tr>
<tr><td><code>quarter</code></td>
<td>
<p>quarter of the year: Q1, Q2, Q3, Q4</p>
</td></tr>
<tr><td><code>cdates</code></td>
<td>
<p>Calendar dates that contains <code>dates</code></p>
</td></tr>
<tr><td><code>cjulian</code></td>
<td>
<p>Julian calendar dates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>, <a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>none</p>


<h3>See Also</h3>

<p><code>epitools</code>: <code><a href="#topic+as.week">as.week</a></code>
</p>
<p><code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code> to learn about date-time classes
</p>
<p><code><a href="base.html#topic+format.Date">format.Date</a></code> to convert character vector of dates into
calendar dates with date-time class (done by <code>epidate</code>)
</p>
<p><code><a href="base.html#topic+strptime">strptime</a></code> to convert date-time character strings
into a date-time class 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#x &lt;- c("12/1/03", "11/2/03", NA, "1/7/04", "1/14/04", "8/18/04")
#epidate(x, format = "%m/%d/%y")
#epidate(x, format = "%m/%d/%y", TRUE)
#
###convert vector of disease weeks into vector of mid-week dates
#dwk &lt;- sample(0:53, 100, replace = TRUE)
#wk2date &lt;- paste(dwk, "/", "Wed", sep="")
#wk2date[1:10]
#wk2date2 &lt;- epidate(wk2date, format = "%U/%a")
#wk2date2$dates[1:20]
</code></pre>

<hr>
<h2 id='epitab'>Epidemiologic tabulation for a cohort or case-control study</h2><span id='topic+epitab'></span>

<h3>Description</h3>

<p>Calculates risks, risk ratio, odds ratio, and confidence intervals for
epidemiologic data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epitab(x, y = NULL,
       method = c("oddsratio", "riskratio", "rateratio"),
       conf.level = 0.95,
       rev = c("neither", "rows", "columns", "both"),           
       oddsratio = c("wald", "fisher", "midp", "small"),
       riskratio = c("wald", "boot", "small"),
       rateratio = c("wald", "midp"),
       pvalue = c("fisher.exact", "midp.exact", "chi2"),
       correction = FALSE,
       verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epitab_+3A_x">x</code></td>
<td>

<p>For odds ratio or risk ratio, input data can be one of the
following: r x 2 table, vector of numbers from a contigency table
(will be transformed into r x 2 table in row-wise order), or single
factor or character vector that will be combined with <code>y</code> into
a table.
</p>
<p>For rate ratio, input data can be one of the following: r x 2 table
where first column contains disease counts and second column
contains person time at risk; a single numeric vector of counts
followed by person time at risk; a single numeric vector of counts
combined with <code>y</code> which would be a numeric vector of
corresponding person time at risk 
</p>
</td></tr>
<tr><td><code id="epitab_+3A_y">y</code></td>
<td>

<p>For odds ratio or risk ratio, a single factor or character vector
that will be combined with <code>x</code> into a table (default is NULL)
</p>
<p>For rate ratio, a numeric vector of person-time at risk; if
provided, <code>x</code> must be a numeric vector of disease counts
</p>
</td></tr>
<tr><td><code id="epitab_+3A_method">method</code></td>
<td>

<p>select measure of association: &quot;oddsratio&quot; (default), &quot;riskratio&quot;,
or &quot;rateratio&quot;
</p>
</td></tr>
<tr><td><code id="epitab_+3A_conf.level">conf.level</code></td>
<td>

<p>confidence level (default is 0.95)
</p>
</td></tr>
<tr><td><code id="epitab_+3A_rev">rev</code></td>
<td>

<p>reverse order of &quot;rows&quot;, &quot;colums&quot;, &quot;both&quot;, or &quot;neither&quot; (default)
</p>
</td></tr>
<tr><td><code id="epitab_+3A_oddsratio">oddsratio</code></td>
<td>

<p>selection estimation method: &quot;wald&quot; (default), &quot;fisher&quot;, &quot;midp&quot;,
&quot;small&quot;   
</p>
</td></tr>
<tr><td><code id="epitab_+3A_riskratio">riskratio</code></td>
<td>

<p>selection estimation method: &quot;wald&quot; (default), &quot;boot&quot;, &quot;small&quot;
</p>
</td></tr>
<tr><td><code id="epitab_+3A_rateratio">rateratio</code></td>
<td>

<p>&quot;wald&quot; (default), &quot;midp&quot;
</p>
</td></tr>
<tr><td><code id="epitab_+3A_pvalue">pvalue</code></td>
<td>

<p>&quot;fisher.exact&quot; (default), &quot;midp.exact&quot;, &quot;chi2&quot; (normal
approximation); for rate ratio, &quot;fisher.exact&quot; not calculated 
</p>
</td></tr>
<tr><td><code id="epitab_+3A_correction">correction</code></td>
<td>

<p>set to TRUE for Yate's continuity correction (default is FALSE)
</p>
</td></tr>
<tr><td><code id="epitab_+3A_verbose">verbose</code></td>
<td>

<p>set to TRUE to return more detailed results (default is
FALSE)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>epitab</code> calculates odds ratios, risk ratios, or rate
ratios for rx2 tables. The odds ratios are estimated using
unconditional maximum likelihood (Wald), conditional maximum
likelihood (Fisher), median-unbiased method (mid-p), or small-sample
adjusted. The confidence intervals are estimated using a normal
approximation (Wald), hypergeometric exact (Fisher), mid-p exact, or
small sample adjusted method.
</p>
<p>The risk ratios are estimated using unconditional maximum
likelihood (Wald), or small-sample adjusted. The confidence intervals
are estimated using a normal approximation (Wald), or bootstrap
estimation.
</p>
<p>The rate ratios are estimated using unconditional maximum likelihood
estimation (Wald), or median unbiased method (mid-p). The confidence
intervals are estimated using normal approximation, or mid-p exact
method.
</p>
<p>Notice the expected structure of the data to be given to 'epitab':
</p>
<pre>
                 Disease
  Exposure       No (ref)  Yes
   Level 1 (ref)  a         b
   Level 2        c         d
   Level 3        e         f   
   </pre>
<p>This function expects the following table struture for rate ratios:
</p>
<pre>
                    counts   person-time
    exposed=0 (ref)   n00        t01
    exposed=1         n10        t11	
    exposed=2         n20        t21
    exposed=3         n30        t31
  </pre>
<p>If the table you want to provide to this function is not in the
preferred form, just use the <code>rev</code> option to &quot;reverse&quot; the rows,
columns, or both. If you are providing categorical variables (factors
or character vectors), the first level of the &quot;exposure&quot; variable is
treated as the reference. However, you can set the reference of a
factor using the <code><a href="stats.html#topic+relevel">relevel</a></code> function.
</p>
<p>Likewise, each row of the rx2 table is compared to the exposure
reference level and test of independence two-sided p values are
calculated using fisher exact, mid-p exact, or normal approximation
method. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>tab</code></td>
<td>
<p>primary table</p>
</td></tr>
<tr><td><code>measure</code></td>
<td>
<p>odds ratio, risk ratio, or rate ratio</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>p value method</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>data input</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data with margin totals</p>
</td></tr>
<tr><td><code>p.exposed</code></td>
<td>
<p>proportion exposed</p>
</td></tr>
<tr><td><code>p.outcome</code></td>
<td>
<p>proportion outcome</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p value</p>
</td></tr>
<tr><td><code>correction</code></td>
<td>
<p>TRUE if Yate's continuity correction was used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>Nicolas P Jewell, Statistics for Epidemiology, 1st Edition, 2004,
Chapman &amp; Hall 
</p>
<p>Kenneth J. Rothman and Sander Greenland (1998), Modern Epidemiology,
Lippincott-Raven Publishers
</p>
<p>Kenneth J. Rothman (2002), Epidemiology: An Introduction, Oxford
University Press
</p>


<h3>See Also</h3>

<p><code><a href="#topic+riskratio">riskratio</a></code>, <code><a href="#topic+oddsratio">oddsratio</a></code>, <code><a href="#topic+rateratio">rateratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>r243 &lt;- matrix(c(12,2,7,9), 2, 2)
dimnames(r243) &lt;- list(Diarrhea = c("Yes", "No"),
                      "Antibody level" = c("Low", "High")
                      )
r243
r243b &lt;- t(r243)
r243b
epitab(r243, rev = "b", verbose = TRUE)
epitab(r243, method="riskratio",rev = "b", verbose = TRUE)
epitab(matrix(c(41, 15, 28010, 19017),2,2)[2:1,],
       method="rateratio", verbose = TRUE)

</code></pre>

<hr>
<h2 id='epitable'>Create r x c contigency table (exposure levels vs. binary outcome)</h2><span id='topic+epitable'></span>

<h3>Description</h3>

<p>Create r x c contigency table for r exposure levels and c outcome levels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epitable(..., ncol =2, byrow = TRUE,
         rev = c("neither", "rows", "columns", "both"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epitable_+3A_...">...</code></td>
<td>
<p>see details</p>
</td></tr>
<tr><td><code id="epitable_+3A_ncol">ncol</code></td>
<td>

<p>number of columns = 2 (default) when a table is constructed from a
vector or sequence of numbers 
</p>
</td></tr>
<tr><td><code id="epitable_+3A_byrow">byrow</code></td>
<td>
<p>Default is TRUE and single vector or collection of numbers is
read in row-wise. Set to FALSE to read in column-wise.</p>
</td></tr>
<tr><td><code id="epitable_+3A_rev">rev</code></td>
<td>

<p>reverse order of &quot;rows&quot;, &quot;colums&quot;, &quot;both&quot;, or &quot;neither&quot; (default)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates r x 2 table with r exposure levels and 2 outcome levels (No
vs. Yes). Arguments can be one of the following:
</p>
<p>(1) four or more integers that be converted into r x 2 table (the
number of integers must be even),
</p>
<p>(2) two categorical vectors (1st vector is exposure with r levels, 2nd
vector is outcome with 2 levels), 
</p>
<p>(3) r x 2 contingency table, or
</p>
<p>(4) single vector that be converted into r x 2 table (the number of
integers must be even).
</p>
<p>The contingency table created by this function is usually used for
additional analyses, for example, the <code>epitab</code> function.
</p>


<h3>Value</h3>

<p>Returns r x 2 contingency table, usually for additional analyses.
</p>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>none</p>


<h3>See Also</h3>

<p><code><a href="#topic+epitable">epitable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## single vector
dat &lt;- c(88, 20, 555, 347)
epitable(dat)

## 4 or more integers
epitable(1,2,3,4,5,6)

## single matrix
epitable(matrix(1:6, 3, 2))

## two categorical vectors
exposure &lt;- factor(sample(c("Low", "Med", "High"), 100, rep=TRUE),
                   levels=c("Low", "Med", "High"))
outcome &lt;- factor(sample(c("No", "Yes"), 100, rep=TRUE))
epitable(exposure, outcome)
epitable("Exposure"=exposure, "Disease"=outcome)

## reversing row and/or column order
zz &lt;- epitable("Exposure Level"=exposure, "Disease"=outcome)
zz
epitable(zz, rev = "r")
epitable(zz, rev = "c")
epitable(zz, rev = "b")

</code></pre>

<hr>
<h2 id='expand.table'>Expand contingency table into individual-level data set</h2><span id='topic+expand.table'></span>

<h3>Description</h3>

<p>Expands contingency table or array into individual-level data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand.table(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand.table_+3A_x">x</code></td>
<td>
<p>table or array with <code>dimnames(x)</code> and
<code>names(dimnames(x))</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For educational purposes, one may want to convert a multi-dimensional
contingency table into an individual-level data frame. In R,
multi-dimensional contigency tables are represented by arrays. An
array can be created using the <code>array</code> command, or the
<code>table</code> command with 3 or more vectors (usually fields from a data
frame).
</p>
<p>It is this array, <code>x</code>, that is processed by
<code>expand.table</code>. In order to generate a data frame,
<code>expand.table</code> needs to process the field names and the possible
values for each field. The array x must have dimension names [i.e.,
<code>dimnames(x)</code>] and field names [i.e.,
<code>names(dimnames(x))</code>]. The <code>expand.table</code> function converts 
<code>names(dimnames(x))</code> to field names and the <code>dimnames(x)</code> to
factor levels for each field. Study the examples.
</p>
<p>An <code>ftable</code> object, say <code>ftab</code>, can be expanded using
<code>expand.table(as.table(ftab))</code>.
</p>
<p>Study the Titanic example to compare how a data frame can contain
either individual-level data or group-level data.
</p>


<h3>Value</h3>

<p>Returns an individual-level data frame
</p>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a>; Daniel Wollschlaeger,
<a href="mailto:dwoll@psychologie.uni-kiel.de">dwoll@psychologie.uni-kiel.de</a>,
<a href="http://www.uni-kiel.de/psychologie/dwoll/">http://www.uni-kiel.de/psychologie/dwoll/</a>
</p>


<h3>References</h3>

<p>none</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+expand.grid">expand.grid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Creating array using 'array' function and expanding it
tab &lt;- array(1:8, c(2, 2, 2))
dimnames(tab) &lt;- list(c("No","Yes"), c("No","Yes"), c("No","Yes"))
names(dimnames(tab)) &lt;- c("Exposure", "Disease", "Confounder")
tab
df &lt;- expand.table(tab)
df

##Creating array using 'table' function and expanding it
tab2 &lt;- table(Exposure = df$Exp, Disease = df$Dis, Confounder = df$Conf)
expand.table(tab2)

##Expanding ftable object
ftab2 &lt;- ftable(tab2)
ftab2
expand.table(as.table(ftab2))

##Convert Titanic data into individual-level data frame
data(Titanic)
expand.table(Titanic)[1:20,]

##Convert Titanic data into group-level data frame
as.data.frame(Titanic)

</code></pre>

<hr>
<h2 id='expected'>Expected values in a table</h2><span id='topic+expected'></span>

<h3>Description</h3>

<p>Assuming independence, calculates expected values in a matrix or
table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expected(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expected_+3A_x">x</code></td>
<td>
<p>is a matrix or table</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assuming independence, calculates expected values in a matrix or
table.
</p>


<h3>Value</h3>

<p>expected values
</p>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>, <a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>Steve Selvin (2001), Epidemiologic Analysis: A Case-Oriented Approach,
Oxford University Press
</p>


<h3>See Also</h3>

<p>See also <code><a href="base.html#topic+margin.table">margin.table</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##From Selvin, 2001, p.2
##year = year of birth
##one+ = one or more congenital defects
##one = one congenital defect
dat &lt;- c(369, 460, 434, 434, 506, 487, 521, 518, 526, 488,
605, 481, 649, 477, 733, 395, 688, 348)

##observed
oi &lt;- matrix(dat, nrow =2)
colnames(oi) &lt;- 1983:1991
rownames(oi) &lt;- c("one+", "one")

##expected
ei &lt;- expected(oi)

##Pearson chi-square test 
chi2.T &lt;- sum((oi - ei)^2/ei)
pchisq(q = chi2.T, df = 8, lower.tail = FALSE)

</code></pre>

<hr>
<h2 id='julian2date'>Convert a julian date into standard a date format</h2><span id='topic+julian2date'></span>

<h3>Description</h3>

<p>Convert a julian date into a standard calendar date format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>julian2date(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="julian2date_+3A_x">x</code></td>
<td>
<p>julian date; that is, the number of days since day 0 (default is
1970-01-01)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In R, the <code>julian</code> function converts a date-time object into a
Julian date: the number of day since day 0 (default is
1970-01-01). However, there is no function, without loading another
package, that converts a Julian date back into a date object. The
<code>julian2date</code> function does this conversion.
</p>


<h3>Value</h3>

<p>Return standard calendar date format.
</p>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>, <a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>none</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+format.Date">format.Date</a></code>, <code><a href="base.html#topic+weekdays">weekdays</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mydates &lt;- c("1/1/04", "1/2/04", "1/7/04", "1/14/04", "8/18/04");
mydates &lt;- as.Date(mydates, format = "%m/%d/%y")
mydates
myjulian &lt;- julian(mydates)
myjulian
julian2date(myjulian)

</code></pre>

<hr>
<h2 id='kapmeier'>Implements product-limit (Kaplan-Meier) method</h2><span id='topic+kapmeier'></span>

<h3>Description</h3>

<p>Implements product-limit (Kaplan-Meier) method for time-to-event data
with censoring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kapmeier(time, status)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kapmeier_+3A_time">time</code></td>
<td>
<p>numeric vector with individual observation times</p>
</td></tr>
<tr><td><code id="kapmeier_+3A_status">status</code></td>
<td>
<p>integer vector indicating status at the end of the
observation time: 1 = event, 0 = censored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements the product-limit method for estimating
survival probability for time-to-event data with censoring:
</p>
<pre>
    S(t) = product[(nj - dj) / nj] for all tj &lt;= t,
  </pre>
<p>where <code>tj</code> are event times (i.e., times at which one or more events
occur), <code>nj</code> are the number at risk at time <code>tj</code> (by convention,
subjects censored at time <code>tj</code> are considered at-risk and included in
<code>nj</code>), and <code>dj</code> are the number of events at time <code>tj</code>.
</p>
<p>A primary purpose of this function was to demonstrate the use of
available R functions to implement a simple statistical method. For example,
<code>kapmeier</code> uses <code>sort</code>, <code>order</code>, <code>duplicated</code>,
<code>tapply</code>, <code>unique</code>, <code>cumprod</code>, <code>cbind</code>, and
<code>dimnames</code>. Studying this function carefully helps one understand
and appreciate the utility of R functions to implement simple methods.
</p>
<p>For serious survival analysis load the <code>survival</code> package. The
<code>survfit</code> function in this package implements the product-limit method
and much more. See examples.
</p>


<h3>Value</h3>

<p>Returns an individual-level data frame</p>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>, <a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>Selvin S. Statistical Analysis of Epidemiologic Data (Monographs in
Epidemiology and Biostatistics, V. 35). Oxford University Press; 3rd
edition (May 1, 2004)
</p>


<h3>See Also</h3>

<p>See also <code><a href="survival.html#topic+survfit">survfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Product-limit method using 'kapmeier' function
tt &lt;- c(1,17,20,9,24,16,2,13,10,3)
ss &lt;- c(1,1,1,1,0,0,0,1,0,1)
round(kapmeier(tt, ss), 3)
</code></pre>

<hr>
<h2 id='oddsratio'>Odds ratio estimation and confidence intervals</h2><span id='topic+oddsratio'></span><span id='topic+oddsratio.midp'></span><span id='topic+oddsratio.fisher'></span><span id='topic+oddsratio.wald'></span><span id='topic+oddsratio.small'></span>

<h3>Description</h3>

<p>Calculates odds ratio by median-unbiased estimation (mid-p),
conditional maximum likelihood estimation (Fisher), unconditional
maximum likelihood estimation (Wald), and small sample adjustment
(small). Confidence intervals are calculated using exact methods
(mid-p and Fisher), normal approximation (Wald), and normal
approximation with small sample adjustment (small).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oddsratio(x, y = NULL,
          method = c("midp", "fisher", "wald", "small"),
          conf.level = 0.95,
          rev = c("neither", "rows", "columns", "both"),
          correction = FALSE,
          verbose = FALSE)
oddsratio.midp(x, y = NULL,
               conf.level = 0.95,
               rev = c("neither", "rows", "columns", "both"),
               correction = FALSE,
               verbose = FALSE,
               interval =  c(0, 1000))
oddsratio.fisher(x, y = NULL,
                 conf.level = 0.95,
                 rev = c("neither", "rows", "columns", "both"),
                 correction = FALSE,
                 verbose = FALSE)
oddsratio.wald(x, y = NULL,
               conf.level = 0.95,
               rev = c("neither", "rows", "columns", "both"),
               correction = FALSE,
               verbose = FALSE)
oddsratio.small(x, y = NULL,
                conf.level = 0.95,
                rev = c("neither", "rows", "columns", "both"),
                correction = FALSE,
                verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oddsratio_+3A_x">x</code></td>
<td>
<p>input data can be one of the following: r x 2 table, vector
of numbers from a contigency table (will be transformed into r x 2
table in row-wise order), or single factor or character vector that
will be combined with <code>y</code> into a table.</p>
</td></tr>
<tr><td><code id="oddsratio_+3A_y">y</code></td>
<td>

<p>single factor or character vector that will be combined with
<code>x</code> into a table (default is NULL)
</p>
</td></tr>
<tr><td><code id="oddsratio_+3A_method">method</code></td>
<td>

<p>method for calculating odds ratio and confidence interval
</p>
</td></tr>
<tr><td><code id="oddsratio_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level (default is 0.95)</p>
</td></tr>
<tr><td><code id="oddsratio_+3A_rev">rev</code></td>
<td>

<p>reverse order of &quot;rows&quot;, &quot;colums&quot;, &quot;both&quot;, or &quot;neither&quot; (default)
</p>
</td></tr>
<tr><td><code id="oddsratio_+3A_correction">correction</code></td>
<td>

<p>set to TRUE for Yate's continuity correction (default is FALSE)
</p>
</td></tr>
<tr><td><code id="oddsratio_+3A_verbose">verbose</code></td>
<td>

<p>set to TRUE to return more detailed results (default is
FALSE)
</p>
</td></tr>
<tr><td><code id="oddsratio_+3A_interval">interval</code></td>
<td>

<p>interval for the <code><a href="stats.html#topic+uniroot">uniroot</a></code> that finds the
odds ratio median-unbiased estimate and mid-p exact confidence
interval for <code>oddsratio.midp</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates odds ratio by median-unbiased estimation (mid-p),
conditional maximum likelihood estimation (Fisher), unconditional
maximum likelihood estimation (Wald), and small sample adjustment
(small). Confidence intervals are calculated using 
exact methods (mid-p and Fisher), normal approximation (Wald), and
normal approximation with small sample adjustment (small). 
</p>
<p>This function expects the following table struture:
</p>
<pre>
                    disease=0   disease=1
    exposed=0 (ref)    n00         n01
    exposed=1          n10         n11	
    exposed=2          n20         n21
    exposed=3          n30         n31
  </pre>
<p>The reason for this is because each level of exposure is compared to
the reference level.
</p>
<p>If you are providing a 2x2 table the following table is preferred:
</p>
<pre>
                    disease=0   disease=1
    exposed=0 (ref)    n00         n01
    exposed=1          n10         n11	
  </pre>
<p>however, for odds ratios from 2x2 tables, the following table is
equivalent:
</p>
<pre>
                    disease=1   disease=0
    exposed=1          n11         n10
    exposed=0          n01         n00	
  </pre>
<p>If the table you want to provide to this function is not in the
preferred form, just use the <code>rev</code> option to &quot;reverse&quot; the rows,
columns, or both. If you are providing categorical variables (factors
or character vectors), the first level of the &quot;exposure&quot; variable is
treated as the reference. However, you can set the reference of a
factor using the <code><a href="stats.html#topic+relevel">relevel</a></code> function.
</p>
<p>Likewise, each row of the rx2 table is compared to the exposure
reference level and test of independence two-sided p values are
calculated using mid-p exact, Fisher's Exact, Monte Carlo simulation,
and the chi-square test. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>table that was used in analysis (verbose = TRUE)</p>
</td></tr> 
<tr><td><code>data</code></td>
<td>
<p>same table as <code>x</code> but with marginal totals</p>
</td></tr> 
<tr><td><code>p.exposed</code></td>
<td>
<p>proportions exposed (verbose = TRUE)</p>
</td></tr> 
<tr><td><code>p.outcome</code></td>
<td>
<p>proportions experienced outcome (verbose = TRUE)</p>
</td></tr> 
<tr><td><code>measure</code></td>
<td>
<p>risk ratio and confidence interval</p>
</td></tr> 
<tr><td><code>conf.level</code></td>
<td>
<p>confidence level used (verbose = TRUE)</p>
</td></tr> 
<tr><td><code>p.value</code></td>
<td>
<p>p value for test of independence</p>
</td></tr> 
<tr><td><code>replicates</code></td>
<td>
<p>number of replicates used in Monte Carlo simulation
p value (verbose = TRUE)</p>
</td></tr>
<tr><td><code>correction</code></td>
<td>
<p>logical specifying if continuity correction was used</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>Kenneth J. Rothman and Sander Greenland (1998), Modern Epidemiology,
Lippincott-Raven Publishers
</p>
<p>Kenneth J. Rothman (2002), Epidemiology: An Introduction, Oxford
University Press
</p>
<p>Nicolas P. Jewell (2004), Statistics for Epidemiology, 1st Edition,
2004, Chapman &amp; Hall, pp. 73-81 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tab2by2.test">tab2by2.test</a></code>, <code><a href="#topic+riskratio">riskratio</a></code>,
<code><a href="#topic+rateratio">rateratio</a></code>, <code><a href="#topic+ormidp.test">ormidp.test</a></code>,
<code><a href="#topic+epitab">epitab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Case-control study assessing whether exposure to tap water
##is associated with cryptosporidiosis among AIDS patients

tapw &lt;- c("Lowest", "Intermediate", "Highest")
outc &lt;- c("Case", "Control")	
dat &lt;- matrix(c(2, 29, 35, 64, 12, 6),3,2,byrow=TRUE)
dimnames(dat) &lt;- list("Tap water exposure" = tapw, "Outcome" = outc)
oddsratio(dat, rev="c")
oddsratio.midp(dat, rev="c")
oddsratio.fisher(dat, rev="c")
oddsratio.wald(dat, rev="c")
oddsratio.small(dat, rev="c")

</code></pre>

<hr>
<h2 id='or.midp'>Odds ratio estimation and confidence intervals using mid-p method</h2><span id='topic+or.midp'></span>

<h3>Description</h3>

<p>Calculates odds ratio by median-unbiased estimation and exact
confidence interval using the mid-p method (Rothman 1998).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>or.midp(x, conf.level = 0.95, byrow = TRUE, interval = c(0, 1000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="or.midp_+3A_x">x</code></td>
<td>
<p>input data can be 2x2 matrix or vector of length 4</p>
</td></tr>
<tr><td><code id="or.midp_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level (default is 0.95)</p>
</td></tr>
<tr><td><code id="or.midp_+3A_byrow">byrow</code></td>
<td>
<p>integer vectors are read in row-wise (default)</p>
</td></tr>
<tr><td><code id="or.midp_+3A_interval">interval</code></td>
<td>
<p>interval for the <code><a href="stats.html#topic+uniroot">uniroot</a></code> that finds the
odds ratio median-unbiased estimate and mid-p exact confidence
interval for <code>oddsratio.midp</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates odds ratio by median-unbiased estimation and exact
confidence interval using the mid-p method (Rothman 1998, p. 251).
</p>
<p>This function expects the following 2x2 table struture:
</p>
<pre>
              exposed   not exposed
    disease  	 a1	    a0	      			
    no disease   b1	    b0
  </pre>
<p>or a numeric vector of the form c(a1, a0, b1, b0).
</p>
<p>This function is used by <code><a href="#topic+oddsratio.midp">oddsratio.midp</a></code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>table that was used in analysis</p>
</td></tr> 
<tr><td><code>data</code></td>
<td>
<p>same table as <code>x</code> but with marginal totals</p>
</td></tr> 
<tr><td><code>estimate</code></td>
<td>
<p>median unbiased odds ratio</p>
</td></tr> 
<tr><td><code>conf.level</code></td>
<td>
<p>confidence level used</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>Kenneth J. Rothman and Sander Greenland (1998), Modern Epidemiology,
Lippincott-Raven Publishers
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oddsratio">oddsratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##rothman p. 243
z1 &lt;- matrix(c(12,2,7,9),2,2,byrow=TRUE)
z2 &lt;- z1[2:1,2:1]
##jewell p. 79
z3 &lt;- matrix(c(347,555,20,88),2,2,byrow=TRUE)
z4 &lt;- z3[2:1,2:1]
or.midp(z1)
or.midp(z2)
or.midp(z3)
or.midp(z4)
</code></pre>

<hr>
<h2 id='ormidp.test'>odds ratio test for independence (p value) for a 2x2 table</h2><span id='topic+ormidp.test'></span>

<h3>Description</h3>

<p>Test for independence using the mid-p method (Rothman 1998)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ormidp.test(a1, a0, b1, b0, or = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ormidp.test_+3A_a1">a1</code></td>
<td>

<p>number of exposed cases
</p>
</td></tr>
<tr><td><code id="ormidp.test_+3A_a0">a0</code></td>
<td>

<p>number of unexposed cases
</p>
</td></tr>
<tr><td><code id="ormidp.test_+3A_b1">b1</code></td>
<td>

<p>number of exposed noncases (controls)
</p>
</td></tr>
<tr><td><code id="ormidp.test_+3A_b0">b0</code></td>
<td>

<p>number of unexposed noncases (controls)
</p>
</td></tr>
<tr><td><code id="ormidp.test_+3A_or">or</code></td>
<td>

<p>odds ratio reference value (default is no association)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Test for independence using the mid-p method (Rothman 1998)
</p>


<h3>Value</h3>

<table>
<tr><td><code>$one.sided</code></td>
<td>
<p>one-sided p value</p>
</td></tr>
<tr><td><code>$two.sided</code></td>
<td>
<p>two-sided p value</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>Kenneth J. Rothman and Sander Greenland (1998), Modern Epidemiology,
Lippincott-Raven Publishers
</p>
<p>Kenneth J. Rothman (2002), Epidemiology: An Introduction, Oxford
University Press
</p>
<p>Nicolas P. Jewell (2004), Statistics for Epidemiology, 1st Edition,
2004, Chapman &amp; Hall, pp. 73-81 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tab2by2.test">tab2by2.test</a></code>, <code><a href="#topic+oddsratio">oddsratio</a></code>,
<code><a href="#topic+riskratio">riskratio</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##rothman p. 243
ormidp.test(12,2,7,9)

##jewell p. 79
ormidp.test(347,555,20,88)
</code></pre>

<hr>
<h2 id='oswego'>Outbreak of Gastrointestinal Illness in Oswego County, 1940</h2><span id='topic+oswego'></span>

<h3>Description</h3>

<p>On April 19, 1940, the local health officer in the village of
Lycoming, Oswego County, New York, reported the occurrence of an
outbreak of acute gastrointestinal illness to the District Health
Officer in Syracuse. Dr. A. M. Rubin, epidemiologist-in-training, was
assigned to conduct an investigation. 
</p>
<p>When Dr. Rubin arrived in the field, he learned from the health
officer that all persons known to be ill had attended a church supper
held on the previous evening, April 18. Family members who did not
attend the church supper did not become ill. Accordingly, Dr. Rubin
focused the investigation on the supper. He completed Interviews with
75 of the 80 persons known to have attended, collecting information
about the occurrence and time of onset of symptoms, and foods
consumed. Of the 75 persons interviewed, 46 persons reported
gastrointestinal illness.
</p>
<p>The onset of illness in all cases was acute, characterized chiefly by
nausea, vomiting, diarrhea, and abdominal pain. None of the ill
persons reported having an elevated temperature; all recovered within
24 to 30 hours. Approximately 20
physicians. No fecal specimens were obtained for bacteriologic
examination.
</p>
<p>The supper was held in the basement of the village church. Foods were
contributed by numerous members of the congregation. The supper began
at 6:00 p.m. and continued until 11:00 p.m. Food was spread out on a
table and consumed over a period of several hours. Data regarding
onset of illness and food eaten or water drunk by each of the 75
persons interviewed are provided in the attached line listing (Oswego
dataset). The approximate time of eating supper was collected for only
about half the persons who had gastrointestinal illness.    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>##data(oswego)
</code></pre>


<h3>Format</h3>


<ul>
<li><p><code>id</code>
subject identificaton number

</p>
</li>
<li><p><code>age</code>
age

</p>
</li>
<li><p><code>sex</code>
sex: F = Female, M = Male

</p>
</li>
<li><p><code>meal.time</code>
meal time on April 18th

</p>
</li>
<li><p><code>ill</code>
developed illness: Y = Yes N = No

</p>
</li>
<li><p><code>onset.date</code>
onset date: &quot;4/18&quot; = April 18th, &quot;4/19&quot; = April 19th

</p>
</li>
<li><p><code>onset.time</code>
onset time: HH:MM AM/PM

</p>
</li>
<li><p><code>baked.ham</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>spinach</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>mashed.potato</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>cabbage.salad</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>jello rolls</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>brown.bread</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>milk</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>coffee</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>water</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>cakes</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>vanilla.ice.cream</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>chocolate.ice.cream</code>
consumed item: Y = Yes N = No

</p>
</li>
<li><p><code>fruit.salad</code>
consumed item: Y = Yes N = No

</p>
</li></ul>



<h3>Source</h3>

<p>Center for Disease Control and Prevention, Epidemic Intelligence
Service
</p>


<h3>References</h3>

<p>Oswego: An Outbreak of Gastrointestinal Illness Following a Church
Supper (updated 2003):  S. aureus outbreak among church picnic
attendees, 1940; the classic, straightforward outbreak investigation
in a defined population. Training modules available at
<a href="https://www.cdc.gov/eis/casestudies/xoswego.401-303.student.pdf">https://www.cdc.gov/eis/casestudies/xoswego.401-303.student.pdf</a>.
</p>

<hr>
<h2 id='pois.conf.int'>Confidence intervals for Poisson counts or rates</h2><span id='topic+pois.exact'></span><span id='topic+pois.daly'></span><span id='topic+pois.byar'></span><span id='topic+pois.approx'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for Poisson counts or rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pois.exact(x, pt = 1, conf.level = 0.95)
pois.daly(x, pt = 1, conf.level = 0.95)
pois.byar(x, pt = 1, conf.level = 0.95)
pois.approx(x, pt = 1, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pois.conf.int_+3A_x">x</code></td>
<td>
<p>count or vector of counts</p>
</td></tr>
<tr><td><code id="pois.conf.int_+3A_pt">pt</code></td>
<td>
<p>person-time at risk (default = 1) or vector of person-times</p>
</td></tr>
<tr><td><code id="pois.conf.int_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level (default = 0.95) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions calculate confidence intervals for a Poisson count or
rate using an exact method (<code>pois.exact</code>), gamma distribution
(<code>pois.daly</code>), Byar's formula (<code>pois.byar</code>), or normal
approximation to the Poisson distribution (<code>pois.approx</code>).
</p>
<p>To calculate an exact confidence interval for a crude rate (count
divided by person-time at risk), set <code>pt</code> equal to the
person-time at risk. Both <code>x</code> and <code>pt</code> can be either a
number or a vector of numbers.
</p>
<p>The <code>pois.daly</code> function gives essentially identical answers to
the <code>pois.exact</code> function except when x = 0. When x = 0, for the
upper confidence limit <code>pois.exact</code> returns 3.689 and
<code>pois.daly</code> returns 2.996.
</p>


<h3>Value</h3>

<p>This function returns a n x 6 matrix with the following colnames:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>Poisson count</p>
</td></tr>
<tr><td><code>pt</code></td>
<td>
<p>person-time at risk</p>
</td></tr>
<tr><td><code>rate</code></td>
<td>
<p>crude rate = x/pt</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>lower confidence interval limit</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>upper confidence interval limit</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>confidence level</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="https://repitools.wordpress.com/">https://repitools.wordpress.com/</a>;
with contributions by Francis Dimzon, <a href="mailto:fdimzon@yahoo.com">fdimzon@yahoo.com</a>;
with contributions by Scott Nabity, <a href="mailto:scott.nabity@sfdph.org">scott.nabity@sfdph.org</a>
</p>


<h3>References</h3>

<p>Tomas Aragon, et al. Applied Epidemiology Using R. Available at
<a href="http://www.phdata.science">http://www.phdata.science</a> 
</p>
<p>Leslie Day (1992), &quot;Simple SAS macros for the calculation of exact 
binomial and Poisson confidence limits.&quot; Comput Biol Med,
22(5):351-361
</p>
<p>Kenneth Rothman (2002), Epidemiology: An Introduction, Oxford
University Press, 1st Edition.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+binom.exact">binom.exact</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pois.exact(1:10)
pois.exact(1:10, 101:110)
pois.daly(1:10)
pois.daly(1:10, 101:110)
pois.byar(1:10)
pois.byar(1:10, 101:110)
pois.approx(1:10)
pois.approx(1:10, 101:110)
</code></pre>

<hr>
<h2 id='probratio'>Obtain unbiased probability ratios from logistic regression models</h2><span id='topic+probratio'></span>

<h3>Description</h3>

<p>Estimates probability (prevalence or risk) ratios from logistic regression models using either 
maximum likelihood or marginal standardization.
When using the latter, standard errors are calculated using the delta method or bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probratio(object, parm, subset, method=c('ML', 'delta', 'bootstrap'), 
  scale=c('linear', 'log'), level=0.95, seed, NREPS=100, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="probratio_+3A_object">object</code></td>
<td>
<p> a glm object with the family attribute equal to &quot;binomial&quot; </p>
</td></tr>
<tr><td><code id="probratio_+3A_parm">parm</code></td>
<td>
<p> a specification of which parameters are to be sequentially assigned predicted responses, either a vector of numbers or a vector of names. If missing, all parameters are considered except the intercept which should not be used except when the method argument is &quot;model&quot;.</p>
</td></tr>
<tr><td><code id="probratio_+3A_subset">subset</code></td>
<td>
<p> a logical vector referring to which observations are included in the numerators and denominators of risk calculation. The default is TRUE, corresponding to a total population prediction ratios. User can supply subsets to calculate exposed population prediction ratios.</p>
</td></tr>
<tr><td><code id="probratio_+3A_method">method</code></td>
<td>
<p> One of three ways that standard errors of prediction ratios are calculate. Maximum likelihood uses relative risk regression directly. Delta-method uses asymptotically correct normal approximations to prediction ratios. </p>
</td></tr>
<tr><td><code id="probratio_+3A_scale">scale</code></td>
<td>
<p> The scale on which marginal standardization calculates normal approximations to variability. When using ML, the log scale is the efficient parameterization.</p>
</td></tr>
<tr><td><code id="probratio_+3A_level">level</code></td>
<td>
<p> The confidence level for confidence intervals.</p>
</td></tr>
<tr><td><code id="probratio_+3A_seed">seed</code></td>
<td>
<p> The random number generation seed</p>
</td></tr>
<tr><td><code id="probratio_+3A_nreps">NREPS</code></td>
<td>
<p> The number of bootstrap samples to be drawn</p>
</td></tr>
<tr><td><code id="probratio_+3A_...">...</code></td>
<td>
<p> Further arguments to glm when using maximum likelihood</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimates prevalence and risk ratios from logistic regression models using either maximum likelihood or marginal standardization.
Maximum likelihood is relative risk regression: a GLM with binomial variance structure and a log link.
Marginal standardization averages predicted probabilities from logistic regression models in the total sample or exposed sample to obtain prevalence or risk ratios.
Standard errors for marginal standardization estimates are calculated with the delta method or the normal bootstrap, which is not bias corrected.
Ratios can be estimated on the linear or log scale, which may lead to different inference due to the invariance of Wald statistics.
</p>


<h3>Value</h3>

<p>An array of ratios or log ratios, their standard errors, a z-score for a hypothesis test for the log ratio being different from 0 or the ratio being different from 1, the corresponding p-value, and the confidence interval for the estimate.
</p>


<h3>Note</h3>

<p>Maximum likelihood estimation via Newton Raphson may result in predicted probabilities greater than 1. This dominates estimating functions and leads to either false convergence or failure. Users should attempt to refit such models themselves using glms with the family argument binomial(link=log). By modifying inputs to glm.control, domination may be averted. An ideal first step is supplying starting coefficients. Input start=c(-log(p), 0,0,...,0) where p is the prevalence of the outcome.
The current implementation of bootstrap standard errors, inference, and confidence intervals are not bias corrected. This will be updated in a later version.
</p>


<h3>Author(s)</h3>

<p>Adam Omidpanah, <a href="mailto:adam.omidpanah@wsu.edu">adam.omidpanah@wsu.edu</a></p>


<h3>References</h3>

<p>Muller, Clemma J., and Richard F. MacLehose. &quot;Estimating predicted probabilities from logistic regression: different methods correspond to different target populations.&quot; International journal of epidemiology 43.3 (2014): 962-970.
</p>
<p>Lumley, Thomas, Richard Kronmal, and Shuangge Ma. &quot;Relative risk regression in medical research: models, contrasts, estimators, and algorithms.&quot; (2006).
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="stats.html#topic+deriv">deriv</a></code>,w
<code><a href="stats.html#topic+predict.glm">predict.glm</a></code>, <code><a href="stats.html#topic+family">family</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(123)
  x &lt;- rnorm(500)
  y &lt;- rbinom(500, 1, exp(-1 + .3*x))
  logreg &lt;- glm(y ~ x, family=binomial)
  confint.default(logreg) ## 95% CI over-estimates the 0.3 log-RR
  pr1 &lt;- probratio(logreg, method='ML', scale='log', start=c(log(mean(y)), 0)) 
  
  ## generally more efficient to calculate log-RR then exponentiate for non-symmetric 95% CI
  pr1 &lt;- probratio(logreg, scale='log', method='delta')
  pr2 &lt;- probratio(logreg, scale='linear', method='delta')
  exp(pr1[, 5:6])
  pr2[, 5:6]
</code></pre>

<hr>
<h2 id='rate2by2.test'>Comparative tests of independence in rx2 rate tables</h2><span id='topic+rate2by2.test'></span>

<h3>Description</h3>

<p>Tests for independence where each row of the rx2 table is compared to
the exposure reference level and test of independence two-sided p
values are calculated using mid-p xxact, and normal approximation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rate2by2.test(x, y = NULL, rr = 1, 
              rev = c("neither", "rows", "columns", "both"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rate2by2.test_+3A_x">x</code></td>
<td>

<p>input data can be one of the following: r x 2 table where first
column contains disease counts and second column contains person
time at risk; or a single numeric vector for counts followed by
person time at risk
</p>
</td></tr>
<tr><td><code id="rate2by2.test_+3A_y">y</code></td>
<td>

<p>vector of person-time at risk; if provided, x must be a
vector of disease counts
</p>
</td></tr>
<tr><td><code id="rate2by2.test_+3A_rr">rr</code></td>
<td>
<p>rate ratio reference value (default is no association)</p>
</td></tr>
<tr><td><code id="rate2by2.test_+3A_rev">rev</code></td>
<td>

<p>reverse order of &quot;rows&quot;, &quot;colums&quot;, &quot;both&quot;, or &quot;neither&quot; (default)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tests for independence where each row of the rx2 table is compared to
the exposure reference level and test of independence two-sided p
values are calculated using mid-p xxact, and normal approximation.
</p>
<p>This function expects the following table struture:
</p>
<pre>
                    counts   person-time
    exposed=0 (ref)   n00        t01
    exposed=1         n10        t11	
    exposed=2         n20        t21
    exposed=3         n30        t31
  </pre>
<p>The reason for this is because each level of exposure is compared to
the reference level.
</p>
<p>If the table you want to provide to this function is not in the
preferred form, just use the <code>rev</code> option to &quot;reverse&quot; the rows,
columns, or both. If you are providing categorical variables (factors
or character vectors), the first level of the &quot;exposure&quot; variable is
treated as the reference. However, you can set the reference of a
factor using the <code><a href="stats.html#topic+relevel">relevel</a></code> function.
</p>
<p>Likewise, each row of the rx2 table is compared to the exposure
reference level and test of independence two-sided p values are
calculated using mid-p exact method and normal approximation.
</p>
<p>This function can be used to construct a p value function
by testing the MUE to the null hypothesis (rr=1) and alternative
hypotheses (rr not equal to 1) to calculate two-side mid-p exact p
values. For more detail, see Rothman.
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>table that was used in analysis</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p value for test of independence</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>Kenneth J. Rothman and Sander Greenland (2008), Modern Epidemiology,
Lippincott Williams and Wilkins Publishers
</p>
<p>Kenneth J. Rothman (2002), Epidemiology: An Introduction, Oxford
University Press
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rateratio">rateratio</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Examples from Rothman 1998, p. 238
bc &lt;- c(Unexposed = 15, Exposed = 41)
pyears &lt;- c(Unexposed = 19017, Exposed = 28010)
dd &lt;- matrix(c(41,15,28010,19017),2,2)
dimnames(dd) &lt;- list(Exposure=c("Yes","No"), Outcome=c("BC","PYears"))
##midp
rate2by2.test(bc,pyears)
rate2by2.test(dd, rev = "r")
rate2by2.test(matrix(c(15, 41, 19017, 28010),2,2))
rate2by2.test(c(15, 41, 19017, 28010))
</code></pre>

<hr>
<h2 id='rateratio'>Rate ratio estimation and confidence intervals</h2><span id='topic+rateratio'></span><span id='topic+rateratio.midp'></span><span id='topic+rateratio.wald'></span>

<h3>Description</h3>

<p>Calculates rate ratio by median-unbiased estimation (mid-p),
and unconditional maximum likelihood estimation (Wald). Confidence
intervals are calculated using exact methods (mid-p), and
normal approximation (Wald).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rateratio(x, y = NULL,
          method = c("midp", "wald"),
          conf.level = 0.95,
          rev = c("neither", "rows", "columns", "both"),
          verbose = FALSE)
rateratio.midp(x, y = NULL,
               conf.level = 0.95,
               rev = c("neither", "rows", "columns", "both"),
               verbose = FALSE)
rateratio.wald(x, y = NULL,
               conf.level = 0.95,
               rev = c("neither", "rows", "columns", "both"),
               verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rateratio_+3A_x">x</code></td>
<td>

<p>input data can be one of the following: r x 2 table where first
column contains disease counts and second column contains person
time at risk; a single numeric vector of counts followed by
person time at risk; a single numeric vector of counts combined with
<code>y</code> which would be a numeric vector of corresponding person
time at risk
</p>
</td></tr>
<tr><td><code id="rateratio_+3A_y">y</code></td>
<td>

<p>numeric vector of person-time at risk; if provided, <code>x</code> must be
a numeric vector of disease counts  
</p>
</td></tr>
<tr><td><code id="rateratio_+3A_method">method</code></td>
<td>

<p>method for calculating rate ratio and confidence interval
</p>
</td></tr>
<tr><td><code id="rateratio_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level (default is 0.95)</p>
</td></tr>
<tr><td><code id="rateratio_+3A_rev">rev</code></td>
<td>

<p>reverse order of &quot;rows&quot;, &quot;colums&quot;, &quot;both&quot;, or &quot;neither&quot; (default)
</p>
</td></tr>
<tr><td><code id="rateratio_+3A_verbose">verbose</code></td>
<td>

<p>set to TRUE to return more detailed results (default is
FALSE)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates rate ratio by median-unbiased estimation (mid-p),
and unconditional maximum likelihood estimation (Wald). Confidence
intervals are calculated using exact methods (mid-p), and
normal approximation (Wald).
</p>
<p>This function expects the following table struture:
</p>
<pre>
                    counts   person-time
    exposed=0 (ref)   n00        t01
    exposed=1         n10        t11	
    exposed=2         n20        t21
    exposed=3         n30        t31
  </pre>
<p>The reason for this is because each level of exposure is compared to
the reference level.
</p>
<p>If the table you want to provide to this function is not in the
preferred form, just use the <code>rev</code> option to &quot;reverse&quot; the rows,
columns, or both. If you are providing categorical variables (factors
or character vectors), the first level of the &quot;exposure&quot; variable is
treated as the reference. However, you can set the reference of a
factor using the <code><a href="stats.html#topic+relevel">relevel</a></code> function.
</p>
<p>Likewise, each row of the rx2 table is compared to the exposure
reference level and test of independence two-sided p values are
calculated using mid-p exact method and normal approximation (Wald).
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>table that was used in analysis (verbose = TRUE)</p>
</td></tr> 
<tr><td><code>data</code></td>
<td>
<p>same table as <code>x</code> but with marginal totals</p>
</td></tr> 
<tr><td><code>measure</code></td>
<td>
<p>rate ratio and confidence interval</p>
</td></tr> 
<tr><td><code>conf.level</code></td>
<td>
<p>confidence level used (verbose = TRUE)</p>
</td></tr> 
<tr><td><code>p.value</code></td>
<td>
<p>p value for test of independence</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Rita Shiau (original author), <a href="mailto:rita.shiau@sfdph.org">rita.shiau@sfdph.org</a>;
Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a>;
Adam Omidpanah, <a href="mailto:adam.omidpanah@wsu.edu">adam.omidpanah@wsu.edu</a> <a href="https://repitools.wordpress.com/">https://repitools.wordpress.com/</a>
</p>


<h3>References</h3>

<p>Kenneth J. Rothman, Sander Greenland, and Timothy Lash (2008), Modern Epidemiology,
Lippincott-Raven Publishers
</p>
<p>Kenneth J. Rothman (2012), Epidemiology: An Introduction, Oxford
University Press
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rate2by2.test">rate2by2.test</a></code>, <code><a href="#topic+oddsratio">oddsratio</a></code>,
<code><a href="#topic+riskratio">riskratio</a></code>, <code><a href="#topic+epitab">epitab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Examples from Rothman 1998, p. 238
bc &lt;- c(Unexposed = 15, Exposed = 41)
pyears &lt;- c(Unexposed = 19017, Exposed = 28010)
dd &lt;- matrix(c(41,15,28010,19017),2,2)
dimnames(dd) &lt;- list(Exposure=c("Yes","No"), Outcome=c("BC","PYears"))
##midp
rateratio(bc,pyears)
rateratio(dd, rev = "r")
rateratio(matrix(c(15, 41, 19017, 28010),2,2))
rateratio(c(15, 41, 19017, 28010))

##midp
rateratio.midp(bc,pyears)
rateratio.midp(dd, rev = "r")
rateratio.midp(matrix(c(15, 41, 19017, 28010),2,2))
rateratio.midp(c(15, 41, 19017, 28010))

##wald
rateratio.wald(bc,pyears)
rateratio.wald(dd, rev = "r")
rateratio.wald(matrix(c(15, 41, 19017, 28010),2,2))
rateratio.wald(c(15, 41, 19017, 28010))
</code></pre>

<hr>
<h2 id='ratetable'>
Create r x 2 count and person-time table for calculating rates
</h2><span id='topic+ratetable'></span>

<h3>Description</h3>

<p>Create r x 2 count and person-time table for calculating rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ratetable(..., byrow = FALSE,
          rev = c("neither", "rows", "columns", "both"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ratetable_+3A_...">...</code></td>
<td>
<p>see details</p>
</td></tr>
<tr><td><code id="ratetable_+3A_byrow">byrow</code></td>
<td>
<p>Default is TRUE and single vector or collection of numbers is
read in row-wise. Set to FALSE to read in column-wise.</p>
</td></tr>  
<tr><td><code id="ratetable_+3A_rev">rev</code></td>
<td>

<p>reverse order of &quot;rows&quot;, &quot;colums&quot;, &quot;both&quot;, or &quot;neither&quot; (default)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates r x 2 table with r exposure levels and 2 columns (counts and
person-time exposed). Arguments can be one of the following:
</p>
<p>(1) r x 2 table of the following form:
</p>
<pre>
                         Outcome
	     Exposure    cases pyears
	     E = 0 (ref)   a     PT0
	     E = 1         b     PT1
	   </pre>
<p>(2) Two numeric vectors: 1st should be vector of counts, and the 2nd
vector should be vector of person-times at risk. For example,
</p>
<pre>
    cases  &lt;- c(a, b)
    pyears &lt;- c(PT0, PT1)
  </pre>
<p>(3) &gt;= 4 numbers in the following order: a, PT0, b, PT1
</p>
<p>(4) One numeric vector of the following form: c(a, PT0, b, PT1)
</p>


<h3>Value</h3>

<p>Returns r x 2 rate table, usually for additional analyses.
</p>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>none</p>


<h3>See Also</h3>

<p><code><a href="#topic+epitable">epitable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Breast cancer cases from radiation treatment for tuberculosis
##Rothman 1998, p. 238
bc0 &lt;- 15
bc1 &lt;- 41
py0 &lt;- 19017
py1 &lt;- 28010

##4 numbers
ratetable(bc0, py0, bc1, py1)

##1 vector
dat &lt;- c(bc0, py0, bc1, py1)
ratetable(dat)

##2 vectors
cases &lt;- c(bc0, bc1)
pyears &lt;- c(py0, py1)
ratetable(bc.cases = cases, person.years = pyears)

##1 matrix
r238 &lt;- matrix(c(41, 28010, 15, 19017), 2, 2)
dimnames(r238) &lt;- list(c("BC cases", "Person-years"),
                       "Radiation" = c("Yes", "No"))
r238
r238b &lt;- t(r238)
r238b
ratetable(r238b, rev = "r")

</code></pre>

<hr>
<h2 id='riskratio'>Risk ratio estimation and confidence intervals</h2><span id='topic+riskratio'></span><span id='topic+riskratio.wald'></span><span id='topic+riskratio.small'></span><span id='topic+riskratio.boot'></span>

<h3>Description</h3>

<p>Calculates risk ratio by unconditional maximum likelihood estimation
(Wald), and small sample adjustment (small). Confidence intervals are
calculated using normal approximation (Wald), and normal approximation
with small sample adjustment (small), and bootstrap method (boot). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>riskratio(x, y = NULL,
          method = c("wald", "small", "boot"),
          conf.level = 0.95,
          rev = c("neither", "rows", "columns", "both"),
          correction = FALSE,
          verbose = FALSE,
          replicates = 5000)
riskratio.wald(x, y = NULL,
               conf.level = 0.95,
               rev = c("neither", "rows", "columns", "both"),
               correction = FALSE,
               verbose = FALSE)
riskratio.small(x, y = NULL,
                conf.level = 0.95,
                rev = c("neither", "rows", "columns", "both"),
                correction = FALSE,
                verbose = FALSE)
riskratio.boot(x, y = NULL,
               conf.level = 0.95,
               rev = c("neither", "rows", "columns", "both"),
               correction = FALSE,
               verbose = FALSE,
               replicates = 5000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="riskratio_+3A_x">x</code></td>
<td>
<p>input data can be one of the following: r x 2 table, vector
of numbers from a contigency table (will be transformed into r x 2
table in row-wise order), or single factor or character vector that
will be combined with <code>y</code> into a table.</p>
</td></tr>
<tr><td><code id="riskratio_+3A_y">y</code></td>
<td>

<p>single factor or character vector that will be combined with
<code>x</code> into a table (default is NULL)
</p>
</td></tr>
<tr><td><code id="riskratio_+3A_method">method</code></td>
<td>

<p>method for calculating risk ratio and confidence interval
</p>
</td></tr>
<tr><td><code id="riskratio_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence level (default is 0.95)</p>
</td></tr>
<tr><td><code id="riskratio_+3A_rev">rev</code></td>
<td>

<p>reverse order of &quot;rows&quot;, &quot;colums&quot;, &quot;both&quot;, or &quot;neither&quot; (default)
</p>
</td></tr>
<tr><td><code id="riskratio_+3A_correction">correction</code></td>
<td>

<p>set to TRUE for Yate's continuity correction (default is FALSE)
</p>
</td></tr>  
<tr><td><code id="riskratio_+3A_verbose">verbose</code></td>
<td>

<p>set to TRUE to return more detailed results (default is
FALSE)
</p>
</td></tr>
<tr><td><code id="riskratio_+3A_replicates">replicates</code></td>
<td>

<p>Number of bootstrap replicates (default = 5000)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates risk ratio by unconditional maximum likelihood estimation
(Wald), and small sample adjustment (small). Confidence intervals are
calculated using normal approximation (Wald), and normal approximation
with small sample adjustment (small), and bootstrap method (boot). 
</p>
<p>This function expects the following table struture:
</p>
<pre>
                    disease=0   disease=1
    exposed=0 (ref)    n00         n01
    exposed=1          n10         n11	
    exposed=2          n20         n21
    exposed=3          n30         n31
  </pre>
<p>The reason for this is because each level of exposure is compared to
the reference level.
</p>
<p>If you are providing a 2x2 table the following table is preferred:
</p>
<pre>
                    disease=0   disease=1
    exposed=0 (ref)    n00         n01
    exposed=1          n10         n11	
  </pre>
<p>If the table you want to provide to this function is not in the
preferred form, just use the <code>rev</code> option to &quot;reverse&quot; the rows,
columns, or both. If you are providing categorical variables (factors
or character vectors), the first level of the &quot;exposure&quot; variable is
treated as the reference. However, you can set the reference of a
factor using the <code><a href="stats.html#topic+relevel">relevel</a></code> function.
</p>
<p>Likewise, each row of the rx2 table is compared to the exposure
reference level and test of independence two-sided p values are
calculated using Fisher's Exact, Monte Carlo simulation, and the
chi-square test.
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>table that was used in analysis (verbose = TRUE)</p>
</td></tr> 
<tr><td><code>data</code></td>
<td>
<p>same table as <code>x</code> but with marginal totals</p>
</td></tr> 
<tr><td><code>p.exposed</code></td>
<td>
<p>proportions exposed (verbose = TRUE)</p>
</td></tr> 
<tr><td><code>p.outcome</code></td>
<td>
<p>proportions experienced outcome (verbose = TRUE)</p>
</td></tr> 
<tr><td><code>measure</code></td>
<td>
<p>risk ratio and confidence interval</p>
</td></tr> 
<tr><td><code>conf.level</code></td>
<td>
<p>confidence level used (verbose = TRUE)</p>
</td></tr>
<tr><td><code>boot.replicates</code></td>
<td>
<p>number of replicates used in bootstrap estimation
of confidence intervals (verbose = TRUE)</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p value for test of independence</p>
</td></tr> 
<tr><td><code>mc.replicates</code></td>
<td>
<p>number of replicates used in Monte Carlo simulation p
value (verbose = TRUE)</p>
</td></tr>
<tr><td><code>correction</code></td>
<td>
<p>logical specifying if continuity correction was used</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>Kenneth J. Rothman and Sander Greenland (1998), Modern Epidemiology,
Lippincott-Raven Publishers
</p>
<p>Kenneth J. Rothman (2002), Epidemiology: An Introduction, Oxford
University Press
</p>
<p>Nicolas P. Jewell (2004), Statistics for Epidemiology, 1st Edition,
2004, Chapman &amp; Hall, pp. 73-81
</p>
<p>Steve Selvin (1998), Modern Applied Biostatistical Methods Using
S-Plus, 1st Edition, Oxford University Press
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tab2by2.test">tab2by2.test</a></code>, <code><a href="#topic+oddsratio">oddsratio</a></code>,
<code><a href="#topic+rateratio">rateratio</a></code>, <code><a href="#topic+epitab">epitab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Case-control study assessing whether exposure to tap water
##is associated with cryptosporidiosis among AIDS patients

tapw &lt;- c("Lowest", "Intermediate", "Highest")
outc &lt;- c("Case", "Control")	
dat &lt;- matrix(c(2, 29, 35, 64, 12, 6),3,2,byrow=TRUE)
dimnames(dat) &lt;- list("Tap water exposure" = tapw, "Outcome" = outc)
riskratio(dat, rev="c")
riskratio.wald(dat, rev="c")
riskratio.small(dat, rev="c")

##Selvin 1998, p. 289
sel &lt;- matrix(c(178, 79, 1411, 1486), 2, 2)
dimnames(sel) &lt;- list("Behavior type" = c("Type A", "Type B"),
                       "Outcome" = c("CHD", "No CHD")
                      )
riskratio.boot(sel, rev = "b")
riskratio.boot(sel, rev = "b", verbose = TRUE)
riskratio(sel, rev = "b", method = "boot")

</code></pre>

<hr>
<h2 id='tab2by2.test'>Comparative tests of independence in rx2 contigency tables</h2><span id='topic+tab2by2.test'></span>

<h3>Description</h3>

<p>Tests for independence where each row of the rx2 table is compared to
the exposure reference level and test of independence two-sided p
values are calculated using mid-p exact, Fisher's Exact, and the
chi-square test. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tab2by2.test(x, y = NULL,
             correction = FALSE,
             rev = c("neither", "rows", "columns", "both"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tab2by2.test_+3A_x">x</code></td>
<td>
<p>input data can be one of the following: r x 2 table, vector
of numbers from a contigency table (will be transformed into r x 2
table in row-wise order), or single factor or character vector that
will be combined with <code>y</code> into a table.</p>
</td></tr>
<tr><td><code id="tab2by2.test_+3A_y">y</code></td>
<td>

<p>single factor or character vector that will be combined with
<code>x</code> into a table (default is NULL)
</p>
</td></tr>
<tr><td><code id="tab2by2.test_+3A_correction">correction</code></td>
<td>

<p>set to TRUE for Yate's continuity correction (default is FALSE)
</p>
</td></tr>
<tr><td><code id="tab2by2.test_+3A_rev">rev</code></td>
<td>

<p>reverse order of &quot;rows&quot;, &quot;colums&quot;, &quot;both&quot;, or &quot;neither&quot; (default)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tests for independence where each row of the rx2 table is compared to
the exposure reference level and test of independence two-sided p
values are calculated using mid-p exact, Fisher's Exact, and the
chi-square test. 
</p>
<p>This function expects the following table struture:
</p>
<pre>
                    disease=0   disease=1
    exposed=0 (ref)    n00         n01
    exposed=1          n10         n11	
    exposed=2          n20         n21
    exposed=3          n30         n31
  </pre>
<p>The reason for this is because each level of exposure is compared to
the reference level.
</p>
<p>If you are providing a 2x2 table order does not matter:
</p>
<p>If the table you want to provide to this function is not in the
preferred form, just use the <code>rev</code> option to &quot;reverse&quot; the rows,
columns, or both. If you are providing categorical variables (factors
or character vectors), the first level of the &quot;exposure&quot; variable is
treated as the reference. However, you can set the reference of a
factor using the <code><a href="stats.html#topic+relevel">relevel</a></code> function.
</p>
<p>Likewise, each row of the rx2 table is compared to the exposure
reference level and test of independence two-sided p values are
calculated using mid-p exact, Fisher's Exact, Monte Carlo simulation,
and the chi-square test. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>table that was used in analysis</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p value for test of independence</p>
</td></tr>
<tr><td><code>correction</code></td>
<td>
<p>logical specifying if continuity correction was used</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>,
<a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>Kenneth J. Rothman and Sander Greenland (1998), Modern Epidemiology,
Lippincott-Raven Publishers
</p>
<p>Kenneth J. Rothman (2002), Epidemiology: An Introduction, Oxford
University Press
</p>
<p>Nicolas P. Jewell (2004), Statistics for Epidemiology, 1st Edition,
2004, Chapman &amp; Hall, pp. 73-81 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oddsratio">oddsratio</a></code>, <code><a href="#topic+riskratio">riskratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##Case-control study assessing whether exposure to tap water
##is associated with cryptosporidiosis among AIDS patients

tapw &lt;- c("Lowest", "Intermediate", "Highest")
outc &lt;- c("Case", "Control")	
dat &lt;- matrix(c(2, 29, 35, 64, 12, 6),3,2,byrow=TRUE)
dimnames(dat) &lt;- list("Tap water exposure" = tapw, "Outcome" = outc)
tab2by2.test(dat, rev="c")

</code></pre>

<hr>
<h2 id='table.margins'>Marginal totals of a table</h2><span id='topic+table.margins'></span>

<h3>Description</h3>

<p>Calculates marginal totals of a matrix, table, or array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>table.margins(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="table.margins_+3A_x">x</code></td>
<td>
<p>is a matrix, table, or array</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates marginal totals of a matrix, table, or array.
</p>


<h3>Value</h3>

<p>Returns original object with marginal totals
</p>


<h3>Author(s)</h3>

<p>Tomas Aragon, <a href="mailto:aragon@berkeley.edu">aragon@berkeley.edu</a>, <a href="http://www.phdata.science">http://www.phdata.science</a></p>


<h3>References</h3>

<p>none</p>


<h3>See Also</h3>

<p>See also <code><a href="base.html#topic+margin.table">margin.table</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(1:4, 2, 2)
table.margins(x)

</code></pre>

<hr>
<h2 id='wcgs'>Western Collaborative Group Study data</h2><span id='topic+wcgs'></span>

<h3>Description</h3>

<p>The Western Collaborative Group Study (WCGS), a prospective cohort
studye, recruited middle-aged men (ages 39 to 59) who were employees
of 10 California companies and collected data on 3154 individuals
during the years 1960-1961. These subjects were primarily selected to
study the relationship between behavior pattern and the risk of
coronary hearth disease (CHD). A number of other risk factors were
also measured to provide the best possible assessment of the CHD risk
associated with behavior type. Additional variables collected include
age, height, weight, systolic blood pressure, diastolic blood
pressure, cholesterol, smoking, and corneal arcus.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>##data(wcgs)
</code></pre>


<h3>Format</h3>


<ul>
<li><p><code>id</code>
Subject ID: 
  
</p>
</li>
<li><p><code>age0</code>
Age: age in years 

</p>
</li>
<li><p><code>height0</code>
Height: height in inches

</p>
</li>
<li><p><code>weight0</code>
Weight: weight in pounds 
  
</p>
</li>
<li><p><code>sbp0</code>
Systolic blood pressure: mm Hg

</p>
</li>
<li><p><code>dbp0</code>
Diastolic blood pressure: mm Hg

</p>
</li>
<li><p><code>chol0</code>
Cholesterol: mg/100 ml

</p>
</li>
<li><p><code>behpat0</code>
Behavior pattern:
  
</p>
</li>
<li><p><code>ncigs0</code>
Smoking: Cigarettes/day

</p>
</li>
<li><p><code>dibpat0</code>
Dichotomous behavior pattern: 0 = Type B; 1 = Type A

</p>
</li>
<li><p><code>chd69</code>
Coronary heart disease event: 0 = none; 1 = yes

</p>
</li>
<li><p><code>typechd</code>
to be done
  
</p>
</li>
<li><p><code>time169</code>
Observation (follow up) time: Days 

</p>
</li>
<li><p><code>arcus0</code>
Corneal arcus: 0 = none; 1 = yes

</p>
</li></ul>



<h3>Source</h3>

<p>UC Berkeley School of Public Health</p>


<h3>References</h3>

<p>pending
</p>

<hr>
<h2 id='wnv'>West Nile Virus human cases reported in California, USA, as of December 14, 2004</h2><span id='topic+wnv'></span>

<h3>Description</h3>

<p>Public Health Surveillance data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>##data(wnv)
</code></pre>


<h3>Format</h3>

<p>pending</p>


<h3>Source</h3>

<p>California Department of Health Services</p>


<h3>References</h3>

<p>pending
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
