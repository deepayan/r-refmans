<!DOCTYPE html><html><head><title>Help for package EEM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EEM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EEM'><p>EEM: A package for reading and preprocessing fluorescence</p>
excitation-emission matrix</a></li>
<li><a href='#[.EEM'><p>Subset EEM list</p></a></li>
<li><a href='#applejuice'><p>Apple juice</p></a></li>
<li><a href='#commonizeEEM'><p>Smooth out the different dimensions of EEM data</p></a></li>
<li><a href='#cutEEM'><p>Cut portions of EEM</p></a></li>
<li><a href='#delScattering'><p>Delete scattering rays</p></a></li>
<li><a href='#delScattering2'><p>Delete scattering rays</p></a></li>
<li><a href='#drawEEM'><p>Draw contour for EEM data</p></a></li>
<li><a href='#drawEEMgg'><p>Draw contour for EEM data using ggplot2</p></a></li>
<li><a href='#EEM-misc'><p>Internal functions for EEM package</p></a></li>
<li><a href='#extract'><p>Extract values from other models</p></a></li>
<li><a href='#findLocalMax'><p>Find local maximum peaks</p></a></li>
<li><a href='#fold'><p>Fold EEM matrix into a list</p></a></li>
<li><a href='#gluten'><p>Gluten</p></a></li>
<li><a href='#normalize'><p>Normalize data</p></a></li>
<li><a href='#plotLoading'><p>Plot loadings for EEM data</p></a></li>
<li><a href='#plotReg'><p>Plot regression coefficients for EEM data</p></a></li>
<li><a href='#plotScore'><p>Plot score for prcomp result</p></a></li>
<li><a href='#plotScorem'><p>Plot score matrix for prcomp result based on group</p></a></li>
<li><a href='#prcompname'><p>Create name for prcomp result</p></a></li>
<li><a href='#print.EEM'><p>Print EEM</p></a></li>
<li><a href='#readEEM'><p>Read raw files and return a list</p></a></li>
<li><a href='#summary.EEM'><p>SummarizeEEM EEM list</p></a></li>
<li><a href='#unfold'><p>Unfold EEM list into a matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Read and Preprocess Fluorescence Excitation-Emission Matrix
(EEM) Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-04-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Vipavee Trivittayasil</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vipavee Trivittayasil &lt;vipavee.tri@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Read raw EEM data and prepares them for further analysis.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>tools, reshape2, graphics, colorRamps, utils, R.utils, sp,
ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>stats, pls, knitr, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/chengvt/EEM">https://github.com/chengvt/EEM</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-04-21 06:22:35 UTC; Cheng</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-04-21 13:47:18</td>
</tr>
</table>
<hr>
<h2 id='EEM'>EEM: A package for reading and preprocessing fluorescence
excitation-emission matrix</h2><span id='topic+EEM'></span><span id='topic+EEM-package'></span>

<h3>Description</h3>

<p>EEM package can be used to import raw data files, 
visualizing data and preparing them for multivariate 
analysis
</p>


<h3>Details</h3>

<p>The latest version and documentation can be found <a href="https://github.com/chengvt/EEM">here</a>.
</p>

<hr>
<h2 id='+5B.EEM'>Subset EEM list</h2><span id='topic++5B.EEM'></span>

<h3>Description</h3>

<p>Subset EEM list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'EEM'
x[i, ...]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B.EEM_+3A_x">x</code></td>
<td>
<p>EEM class object</p>
</td></tr>
<tr><td><code id="+2B5B.EEM_+3A_i">i</code></td>
<td>
<p>indices specifying elements to extract</p>
</td></tr>
<tr><td><code id="+2B5B.EEM_+3A_...">...</code></td>
<td>
<p>arguments for <code>subset</code> function</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
selected &lt;- applejuice[1-5]

</code></pre>

<hr>
<h2 id='applejuice'>Apple juice</h2><span id='topic+applejuice'></span>

<h3>Description</h3>

<p>Apples of each of six types (Aomori&ndash;Fuji, Aomori&ndash;Jona, Aomori&ndash;Ohrin, NZ&ndash;Envy, NZ&ndash;Jazz, NZ&ndash;Fuji) 
were blended and filtered using a gauze. Fluorescence profiles of complete excitation&ndash;emission matrix 
of filtered solutions (diluted with water to 147 times) were measured using fluorescence spectroscopy machines. The sample name refers to &quot;type&ndash;fruit number&ndash;replicate&quot;. To save space, only two apples of each types were given in the dataset. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("applejuice")</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
summary(applejuice)
</code></pre>

<hr>
<h2 id='commonizeEEM'>Smooth out the different dimensions of EEM data</h2><span id='topic+commonizeEEM'></span>

<h3>Description</h3>

<p>Smooth out the difference dimensions of EEM data by finding the common variables of all data and subset
those data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>commonizeEEM(EEM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="commonizeEEM_+3A_eem">EEM</code></td>
<td>
<p>a list containing EEM data as created by <code>readEEM</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>EEM class object with only common variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gluten)
data(applejuice)
data &lt;- c(gluten, applejuice)
summary(data) # different dimensions
data_combined &lt;- commonizeEEM(data)
summary(data_combined) # same dimension, ready for unfold

</code></pre>

<hr>
<h2 id='cutEEM'>Cut portions of EEM</h2><span id='topic+cutEEM'></span><span id='topic+cutEEM.EEM'></span><span id='topic+cutEEM.EEMweight'></span>

<h3>Description</h3>

<p>Cut portions of EEM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cutEEM(x, cutEX = NULL, cutEM = NULL)

## S3 method for class 'EEM'
cutEEM(x, cutEX = NULL, cutEM = NULL)

## S3 method for class 'EEMweight'
cutEEM(x, cutEX = NULL, cutEM = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cutEEM_+3A_x">x</code></td>
<td>
<p>a list of EEM data generated by <code><a href="#topic+readEEM">readEEM</a></code> function or 
EEMweight object generated by <code><a href="#topic+extract">extract</a></code>-related functions.</p>
</td></tr>
<tr><td><code id="cutEEM_+3A_cutex">cutEX</code></td>
<td>
<p>Numeric or sequential data specifying regions to be cut for excitation wavelength. 
Examples, 200 or 200:500</p>
</td></tr>
<tr><td><code id="cutEEM_+3A_cutem">cutEM</code></td>
<td>
<p>Numeric or sequential data specifying regions to be cut for emission wavelength. 
Examples, 200 or 200:500</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list similar to input <code>EEM</code> is returned but with specified portions cut.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
applejuice_cut &lt;- cutEEM(applejuice, cutEX = 300:450)
drawEEM(applejuice_cut, 1)

</code></pre>

<hr>
<h2 id='delScattering'>Delete scattering rays</h2><span id='topic+delScattering'></span>

<h3>Description</h3>

<p>This function deletes two regions that are not related to fluorescence emission: 
(1) regions where emission wavelength is shorten than excitation light, 
(2) scattering rays and their second, third and forth order lights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delScattering(EEM, rep = 0, first = 30, second = 40, third = 40,
  forth = 40)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delScattering_+3A_eem">EEM</code></td>
<td>
<p>A list containing EEM data as created by <code><a href="#topic+readEEM">readEEM</a></code> function.</p>
</td></tr>
<tr><td><code id="delScattering_+3A_rep">rep</code></td>
<td>
<p>(optional) Regions to be deleted are to be replaced with <code>rep</code>: 0 or NA</p>
</td></tr>
<tr><td><code id="delScattering_+3A_first">first</code></td>
<td>
<p>(optional) Width of region to be deleted for first order scattering rays [nm]</p>
</td></tr>
<tr><td><code id="delScattering_+3A_second">second</code></td>
<td>
<p>(optional) Width of region to be deleted for second order scattering rays [nm]</p>
</td></tr>
<tr><td><code id="delScattering_+3A_third">third</code></td>
<td>
<p>(optional) Width of region to be deleted for third order scattering rays [nm]</p>
</td></tr>
<tr><td><code id="delScattering_+3A_forth">forth</code></td>
<td>
<p>(optional) Width of region to be deleted for forth order scattering rays [nm]</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list similar to input <code>EEM</code> is returned but with all scattering rays deleted.
</p>


<h3>References</h3>

<p>Fujita, K., Tsuta, M., Kokawa, M., and Sugiyama, J. (2010). Detection of deoxynivalenol using fluorescence excitation&ndash;emission matrix. Food and Bioprocess Technology, 3(6), 922&ndash;927.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
drawEEM(delScattering(applejuice, NA), 1)

</code></pre>

<hr>
<h2 id='delScattering2'>Delete scattering rays</h2><span id='topic+delScattering2'></span>

<h3>Description</h3>

<p>This function deletes three regions that are not related to fluorescence emission: 
(1) regions where emission wavelength is shorten than excitation light (Em &lt;= Ex), 
(2) scattering rays and their second order light,
(3) regions above second-order scattering (EM &gt;= 2*EX)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delScattering2(EEM, rep = 0, first = 30, second = 40)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delScattering2_+3A_eem">EEM</code></td>
<td>
<p>A list containing EEM data as created by <code><a href="#topic+readEEM">readEEM</a></code> function.</p>
</td></tr>
<tr><td><code id="delScattering2_+3A_rep">rep</code></td>
<td>
<p>(optional) Regions to be deleted are to be replaced with <code>rep</code>: 0 or NA</p>
</td></tr>
<tr><td><code id="delScattering2_+3A_first">first</code></td>
<td>
<p>(optional) Width of region to be deleted for first order scattering rays [nm]</p>
</td></tr>
<tr><td><code id="delScattering2_+3A_second">second</code></td>
<td>
<p>(optional) Width of region to be deleted for second order scattering rays [nm]</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list similar to input <code>EEM</code> is returned but with all scattering rays deleted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
drawEEM(delScattering2(applejuice, NA), 1)

</code></pre>

<hr>
<h2 id='drawEEM'>Draw contour for EEM data</h2><span id='topic+drawEEM'></span><span id='topic+drawEEM.EEM'></span><span id='topic+drawEEM.EEMweight'></span><span id='topic+drawEEM.data.frame'></span><span id='topic+drawEEM.matrix'></span><span id='topic+drawEEM.numeric'></span>

<h3>Description</h3>

<p>This function is a wrapper function for <code><a href="graphics.html#topic+filled.contour">filled.contour</a></code> to draw contour for EEM data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawEEM(x, ...)

## S3 method for class 'EEM'
drawEEM(x, n, exlab = "Excitation wavelength [nm]",
  emlab = "Emission wavelength [nm]", color.palette = matlab.like,
  nlevels = 50, main = NULL, flipaxis = FALSE, ...)

## S3 method for class 'EEMweight'
drawEEM(x, ncomp, exlab = "Excitation wavelength [nm]",
  emlab = "Emission wavelength [nm]", color.palette = matlab.like,
  nlevels = 50, main = NULL, flipaxis = FALSE, ...)

## S3 method for class 'matrix'
drawEEM(x, n, exlab = "Excitation wavelength [nm]",
  emlab = "Emission wavelength [nm]", color.palette = matlab.like,
  nlevels = 50, main = NULL, flipaxis = FALSE, ...)

## S3 method for class 'data.frame'
drawEEM(x, n, exlab = "Excitation wavelength [nm]",
  emlab = "Emission wavelength [nm]", color.palette = matlab.like,
  nlevels = 50, main = NULL, flipaxis = FALSE, ...)

## S3 method for class 'numeric'
drawEEM(x, exlab = "Excitation wavelength [nm]",
  emlab = "Emission wavelength [nm]", color.palette = matlab.like,
  nlevels = 50, main = NULL, flipaxis = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawEEM_+3A_x">x</code></td>
<td>
<p>a list of EEM data generated by <code><a href="#topic+readEEM">readEEM</a></code> function or 
EEMweight object generated by <code><a href="#topic+extract">extract</a></code>-related functions.</p>
</td></tr>
<tr><td><code id="drawEEM_+3A_...">...</code></td>
<td>
<p>(optional) further arguments passed to other methods of <code><a href="graphics.html#topic+filled.contour">filled.contour</a></code></p>
</td></tr>
<tr><td><code id="drawEEM_+3A_n">n</code></td>
<td>
<p>sample number. The number should not exceed <code>length(EEM)</code></p>
</td></tr>
<tr><td><code id="drawEEM_+3A_exlab">exlab</code></td>
<td>
<p>(optional) excitation-axis label</p>
</td></tr>
<tr><td><code id="drawEEM_+3A_emlab">emlab</code></td>
<td>
<p>(optional) emission-axis label</p>
</td></tr>
<tr><td><code id="drawEEM_+3A_color.palette">color.palette</code></td>
<td>
<p>(optional) contour color palette. See <code><a href="grDevices.html#topic+palette">palette</a></code> for more details</p>
</td></tr>
<tr><td><code id="drawEEM_+3A_nlevels">nlevels</code></td>
<td>
<p>(optional) number of levels used to separate range of intensity value</p>
</td></tr>
<tr><td><code id="drawEEM_+3A_main">main</code></td>
<td>
<p>(optional) plot title</p>
</td></tr>
<tr><td><code id="drawEEM_+3A_flipaxis">flipaxis</code></td>
<td>
<p>(optional) flip axis</p>
</td></tr>
<tr><td><code id="drawEEM_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure is returned on the graphic device
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>EEM</code>: draw contour of EEM data created by <code><a href="#topic+readEEM">readEEM</a></code> function
</p>
</li>
<li> <p><code>EEMweight</code>: draw contours of the output from <code><a href="#topic+getLoading">getLoading</a></code> and 
<code><a href="#topic+getReg">getReg</a></code>.
</p>
</li>
<li> <p><code>matrix</code>: draw contour of unfolded matrix which have column names in 
the format of EX...EM...
</p>
</li>
<li> <p><code>data.frame</code>: draw contour of unfolded data.frame which have column names in 
the format of EX...EM...
</p>
</li>
<li> <p><code>numeric</code>: draw contour of a vector of numeric values which have names in 
the format of EX...EM...
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+drawEEM">drawEEM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># method for class "EEM"
data(applejuice)
drawEEM(applejuice, 1) # draw contour of the first sample
drawEEM(applejuice, 1, flipaxis = TRUE) # flip the axis

# method for class "EEMweight"
applejuice_uf &lt;- unfold(applejuice) # unfold list into matrix
result &lt;- prcomp(applejuice_uf) 
drawEEM(getLoading(result), 1) # plot loading of the first PC

</code></pre>

<hr>
<h2 id='drawEEMgg'>Draw contour for EEM data using ggplot2</h2><span id='topic+drawEEMgg'></span><span id='topic+drawEEMgg.EEM'></span><span id='topic+drawEEMgg.EEMweight'></span><span id='topic+drawEEMgg_internal'></span>

<h3>Description</h3>

<p>This function draw contour for EEM data using ggplot2. Use 'ggsave' to save the contours.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawEEMgg(x, ...)

## S3 method for class 'EEM'
drawEEMgg(x, n, textsize = 20, color.palette = matlab.like,
  nlevels = 20, exlab = "Excitation wavelength [nm]",
  emlab = "Emission wavelength [nm]", main = NULL, has_legend = TRUE,
  zlim = NULL, breaks = waiver(), flipaxis = FALSE, ...)

## S3 method for class 'EEMweight'
drawEEMgg(x, ncomp, textsize = 25,
  color.palette = matlab.like, nlevels = 20,
  exlab = "Excitation wavelength [nm]", emlab = "Emission wavelength [nm]",
  main = NULL, has_legend = TRUE, zlim = NULL, breaks = waiver(),
  flipaxis = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawEEMgg_+3A_x">x</code></td>
<td>
<p>a list of EEM data generated by <code><a href="#topic+readEEM">readEEM</a></code> function or 
EEMweight object generated by <code><a href="#topic+extract">extract</a></code>-related functions.</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_...">...</code></td>
<td>
<p>arguments for other methods</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_n">n</code></td>
<td>
<p>sample number. The number should not exceed <code>length(EEM)</code></p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_textsize">textsize</code></td>
<td>
<p>(optional) text size</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_color.palette">color.palette</code></td>
<td>
<p>(optional) contour color palette. See <code><a href="grDevices.html#topic+palette">palette</a></code> for more details</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_nlevels">nlevels</code></td>
<td>
<p>(optional) number of levels used to separate range of intensity value</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_exlab">exlab</code></td>
<td>
<p>(optional) excitation-axis label</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_emlab">emlab</code></td>
<td>
<p>(optional) emission-axis label</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_main">main</code></td>
<td>
<p>(optional) plot title</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_has_legend">has_legend</code></td>
<td>
<p>logical value for legend</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_zlim">zlim</code></td>
<td>
<p>zlim = c(min, max)</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_breaks">breaks</code></td>
<td>
<p>breaks</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_flipaxis">flipaxis</code></td>
<td>
<p>(optional) flip axis</p>
</td></tr>
<tr><td><code id="drawEEMgg_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+drawEEM">drawEEM</a></code> is faster and should be used.
</p>


<h3>Value</h3>

<p>A figure is returned on the graphic device
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>EEM</code>: draw EEM of EEM data created by <code><a href="#topic+readEEM">readEEM</a></code> function
</p>
</li>
<li> <p><code>EEMweight</code>: draw contours of the output from <code><a href="#topic+getLoading">getLoading</a></code> and 
<code><a href="#topic+getReg">getReg</a></code>.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+drawEEM">drawEEM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
require(EEM)
require(ggplot2)
data(applejuice)
drawEEMgg(applejuice, 1) # draw EEM of sample no.1
drawEEMgg(applejuice, 1, color.palette = cm.colors) # draw EEM of sample no.31 with different color
drawEEMgg(applejuice, 1, nlevels = 10) # change nlevels

# manually define legend values
drawEEMgg(applejuice, 1, breaks = seq(from = 1000, to = 6000, by = 1000))

# can be combined with other ggplot2 commands
# add point to the plot
drawEEMgg(applejuice, 1) + geom_point(aes(x = 350, y = 500), pch = 17, cex = 10)

# add grid line to the plot
drawEEMgg(applejuice, 1) + theme(panel.grid = element_line(color = "grey"), 
panel.grid.major = element_line(colour = "grey"))

# add bg color
drawEEMgg(applejuice, 1, has_legend = FALSE) + geom_raster(aes(fill = value)) +
geom_contour(colour = "white")


## End(Not run)

</code></pre>

<hr>
<h2 id='EEM-misc'>Internal functions for EEM package</h2><span id='topic+EEM-misc'></span><span id='topic+generateColor'></span><span id='topic+generatePoint'></span><span id='topic+getEM'></span><span id='topic+getEX'></span>

<h3>Description</h3>

<p>Internal functions for EEM package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generatePoint(n, pch = NULL)

generateColor(n, color.palette = NULL)

getEX(string, digits = NULL)

getEM(string, digits = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EEM-misc_+3A_n">n</code></td>
<td>
<p>number</p>
</td></tr>
<tr><td><code id="EEM-misc_+3A_pch">pch</code></td>
<td>
<p>Either an integer specifying a symbol or a single character to be used as the default in plotting points.</p>
</td></tr>
<tr><td><code id="EEM-misc_+3A_color.palette">color.palette</code></td>
<td>
<p>(optional) contour color palette. See <code><a href="grDevices.html#topic+palette">palette</a></code> for more details</p>
</td></tr>
<tr><td><code id="EEM-misc_+3A_string">string</code></td>
<td>
<p>string or vector of strings</p>
</td></tr>
<tr><td><code id="EEM-misc_+3A_digits">digits</code></td>
<td>
<p>integer indicating the number of decimal places
(<code>round</code>) or significant digits (<code>signif</code>) to be used.
Negative values are allowed (see &lsquo;Details&rsquo;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>'generatePoint' and 'generateColor' are used to create point and color 
vector from specified number (n) and palette.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>generateColor</code>: generate colors
</p>
</li>
<li> <p><code>getEX</code>: get EX value
</p>
</li>
<li> <p><code>getEM</code>: get EM value
</p>
</li></ul>

<hr>
<h2 id='extract'>Extract values from other models</h2><span id='topic+extract'></span><span id='topic+getLoading'></span><span id='topic+getReg'></span>

<h3>Description</h3>

<p>Extract values from other models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLoading(x)

getReg(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_+3A_x">x</code></td>
<td>
<p>output variable from <code><a href="stats.html#topic+prcomp">prcomp</a></code> or <code><a href="pls.html#topic+plsr">plsr</a></code> functions</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'EEMweight' list containing title and value attributes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
applejuice_uf &lt;- unfold(applejuice) # unfold list into matrix
result &lt;- prcomp(applejuice_uf) 
loading &lt;- getLoading(result)
str(loading)
</code></pre>

<hr>
<h2 id='findLocalMax'>Find local maximum peaks</h2><span id='topic+findLocalMax'></span><span id='topic+findLocalMax.EEM'></span><span id='topic+findLocalMax.matrix'></span><span id='topic+findLocalMax.numeric'></span>

<h3>Description</h3>

<p>Find local maximum peaks in EEM data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findLocalMax(data, ...)

## S3 method for class 'EEM'
findLocalMax(data, n, threshold = 0.7, showprint = TRUE, ...)

## S3 method for class 'matrix'
findLocalMax(data, n, threshold = 0.7, showprint = TRUE,
  ...)

## S3 method for class 'numeric'
findLocalMax(data, threshold = 0.7, showprint = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findLocalMax_+3A_data">data</code></td>
<td>
<p>EEM data generated by <code><a href="#topic+readEEM">readEEM</a></code> function, unfolded EEM data 
generated by <code><a href="#topic+unfold">unfold</a></code> function or  a vector of numeric values which have names in 
the format of EX...EM...</p>
</td></tr>
<tr><td><code id="findLocalMax_+3A_...">...</code></td>
<td>
<p>(optional) further arguments passed to other methods</p>
</td></tr>
<tr><td><code id="findLocalMax_+3A_n">n</code></td>
<td>
<p>sample number. The number should not exceed <code>length(EEM)</code>.</p>
</td></tr>
<tr><td><code id="findLocalMax_+3A_threshold">threshold</code></td>
<td>
<p>threshold value in between 0 and 1. Lower the value to cover low peaks.</p>
</td></tr>
<tr><td><code id="findLocalMax_+3A_showprint">showprint</code></td>
<td>
<p>logical value whether to print out the results or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return a character vector of peak names. If showprint = TRUE, it will also 
print a dataframe of indicating the value of local maximum peaks.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>EEM</code>: for EEM data created by <code><a href="#topic+readEEM">readEEM</a></code> function
</p>
</li>
<li> <p><code>matrix</code>: for unfolded EEM data created by <code><a href="#topic+unfold">unfold</a></code> function
</p>
</li>
<li> <p><code>numeric</code>: for a vector of numeric values which have names in 
the format of EX...EM...
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
findLocalMax(applejuice, 1) 

applejuice_uf &lt;- unfold(applejuice)
findLocalMax(applejuice_uf, 1) 

</code></pre>

<hr>
<h2 id='fold'>Fold EEM matrix into a list</h2><span id='topic+fold'></span><span id='topic+fold.data.frame'></span><span id='topic+fold.matrix'></span><span id='topic+fold.numeric'></span>

<h3>Description</h3>

<p>Fold EEM matrix into a list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fold(EEM_uf, ...)

## S3 method for class 'matrix'
fold(EEM_uf, ...)

## S3 method for class 'data.frame'
fold(EEM_uf, name = NULL, ...)

## S3 method for class 'numeric'
fold(EEM_uf, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fold_+3A_eem_uf">EEM_uf</code></td>
<td>
<p>Unfolded EEM matrix where columns are wavelength condition and rows are samples.
It should have corresponding column names (formatted as EX###EM###) and row names.</p>
</td></tr>
<tr><td><code id="fold_+3A_...">...</code></td>
<td>
<p>arguments for other methods</p>
</td></tr>
<tr><td><code id="fold_+3A_name">name</code></td>
<td>
<p>optional for data.frame input to specify the sample names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>EEM a list containing EEM/EEM data
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>data.frame</code>: fold unfolded data.frame
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
applejuice_uf &lt;- unfold(applejuice) # unfold list into matrix
applejuice_uf_norm &lt;- normalize(applejuice_uf) # normalize matrix
drawEEM(fold(applejuice_uf_norm), 1) # visualize normalized EEM

</code></pre>

<hr>
<h2 id='gluten'>Gluten</h2><span id='topic+gluten'></span>

<h3>Description</h3>

<p>Pure wheat gluten and pure wheat starch were mixed at gluten ratios ranging from 0 to 100 %, in 20 % increments. The samples were set in a cell with a quartz glass window, and the samples were pressed against the glass to obtain a flat surface. This dataset contains fluorescence excitation-emission profiles of each samples with 8 replicates. To save space, only the data with gluten ratios ranging from 0 to 60 % was provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("gluten")</code></pre>


<h3>References</h3>

<p>Kokawa, M., Fujita, K., Sugiyama, J., Tsuta, M., Shibata, M., Araki, T., &amp; Nabetani, H. (2012). Quantification of the distributions of gluten, starch and air bubbles in dough at different mixing stages by fluorescence fingerprint imaging. Journal of Cereal Science, 55(1), 15&ndash;21.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gluten)
summary(gluten)
</code></pre>

<hr>
<h2 id='normalize'>Normalize data</h2><span id='topic+normalize'></span>

<h3>Description</h3>

<p>Normalize data (area under the curve = 1)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize(EEM_uf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_+3A_eem_uf">EEM_uf</code></td>
<td>
<p>Unfolded EEM matrix where columns are wavelength condition and rows are samples</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The unfolded EEM data can be normalized by dividing each variable by the 
sum of the absolute value of all variables in a sample, such that the summation 
of absolute values of all variables in each sample was equal to 1. This is 
can be used to reduce the scaling difference,which is common in spectroscopic 
applications. This difference is usually caused by the scattering effect, 
source/detector variation and instrumental sensitivity.
</p>


<h3>Value</h3>

<p>A matrix of normalized data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
applejuice_uf &lt;- unfold(applejuice) # unfold list into matrix
applejuice_uf_norm &lt;- normalize(applejuice_uf) # normalize data

rowSums(abs(applejuice_uf_norm), na.rm = TRUE) # the absolute sum of each row equal to 1

  
</code></pre>

<hr>
<h2 id='plotLoading'>Plot loadings for EEM data</h2><span id='topic+plotLoading'></span>

<h3>Description</h3>

<p>Plot loadings for EEM data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotLoading(x, ncomp = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotLoading_+3A_x">x</code></td>
<td>
<p>output variable from <code><a href="stats.html#topic+prcomp">prcomp</a></code> or <code><a href="pls.html#topic+plsr">plsr</a></code> functions</p>
</td></tr>
<tr><td><code id="plotLoading_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components</p>
</td></tr>
<tr><td><code id="plotLoading_+3A_...">...</code></td>
<td>
<p>(optional) arguments for <code><a href="#topic+drawEEM">drawEEM</a></code> and <code><a href="graphics.html#topic+filled.contour">filled.contour</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure is returned on the graphic device
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
applejuice_uf &lt;- unfold(applejuice) # unfold list into matrix
result &lt;- prcomp(applejuice_uf) 
plotLoading(result, ncomp = 1) # plot loading of the first PC
 
</code></pre>

<hr>
<h2 id='plotReg'>Plot regression coefficients for EEM data</h2><span id='topic+plotReg'></span>

<h3>Description</h3>

<p>Plot regression coefficients for EEM data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotReg(x, ncomp = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotReg_+3A_x">x</code></td>
<td>
<p>output variable from <code><a href="pls.html#topic+plsr">plsr</a></code> function</p>
</td></tr>
<tr><td><code id="plotReg_+3A_ncomp">ncomp</code></td>
<td>
<p>number of components</p>
</td></tr>
<tr><td><code id="plotReg_+3A_...">...</code></td>
<td>
<p>(optional) arguments for <code><a href="#topic+drawEEM">drawEEM</a></code> and <code><a href="graphics.html#topic+filled.contour">filled.contour</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure is returned on the graphic device
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gluten)
gluten_uf &lt;- unfold(gluten) # unfold list into matrix

# delete columns with NA values
index &lt;- colSums(is.na(gluten_uf)) == 0
gluten_uf &lt;- gluten_uf[, index]
gluten_ratio &lt;- as.numeric(names(gluten))

require(pls)
model &lt;- plsr(gluten_ratio ~ gluten_uf, ncomp = 3) 
plotReg(model) 
 
</code></pre>

<hr>
<h2 id='plotScore'>Plot score for prcomp result</h2><span id='topic+plotScore'></span>

<h3>Description</h3>

<p>Plot score for <code><a href="stats.html#topic+prcomp">prcomp</a></code> (PCA) result
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotScore(prcompResult, xPC = 1, yPC = 2, group = NULL, group2 = NULL,
  cex = 1.5, cex.legend = 1, label = NULL, pos = 4, col = NULL,
  pch = NULL, legendlocation = "bottomright", legendoutside = FALSE,
  rightwhitespace = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotScore_+3A_prcompresult">prcompResult</code></td>
<td>
<p>output object from <code><a href="stats.html#topic+prcomp">prcomp</a></code> function</p>
</td></tr>
<tr><td><code id="plotScore_+3A_xpc">xPC</code></td>
<td>
<p>an integer indicating PC component on x-axis</p>
</td></tr>
<tr><td><code id="plotScore_+3A_ypc">yPC</code></td>
<td>
<p>an integer indicating PC component on y-axis</p>
</td></tr>
<tr><td><code id="plotScore_+3A_group">group</code></td>
<td>
<p>a vector of numeric, character or factor class separating 
the samples into groups. Correspond to point color.</p>
</td></tr>
<tr><td><code id="plotScore_+3A_group2">group2</code></td>
<td>
<p>The second group, can be a vector of numeric, character or factor class separating 
the samples into groups. Correspond to point shape.</p>
</td></tr>
<tr><td><code id="plotScore_+3A_cex">cex</code></td>
<td>
<p>(optional) size of points on graphs</p>
</td></tr>
<tr><td><code id="plotScore_+3A_cex.legend">cex.legend</code></td>
<td>
<p>(optional) size of fonts in legend</p>
</td></tr>
<tr><td><code id="plotScore_+3A_label">label</code></td>
<td>
<p>(optional) a character vector or expression specifying the text to be written.</p>
</td></tr>
<tr><td><code id="plotScore_+3A_pos">pos</code></td>
<td>
<p>(optional, applicable when label is given) a position specifier for the text. If specified this overrides 
any adj value given. Values of 1, 2, 3 and 4, respectively indicate positions below, 
to the left of, above and to the right of the specified coordinates.</p>
</td></tr>
<tr><td><code id="plotScore_+3A_col">col</code></td>
<td>
<p>point color palette</p>
</td></tr>
<tr><td><code id="plotScore_+3A_pch">pch</code></td>
<td>
<p>point type palette</p>
</td></tr>
<tr><td><code id="plotScore_+3A_legendlocation">legendlocation</code></td>
<td>
<p>(optional)location of legend on graph. 
Look up <code><a href="graphics.html#topic+legend">legend</a></code> for more details.</p>
</td></tr>
<tr><td><code id="plotScore_+3A_legendoutside">legendoutside</code></td>
<td>
<p>(optional) set to TRUE if you want to put legend on 
the outside of the plot. The legend location is defaulted to topright.</p>
</td></tr>
<tr><td><code id="plotScore_+3A_rightwhitespace">rightwhitespace</code></td>
<td>
<p>(optional) set width for white space for legend. 
Only applicable if legendoutside = TRUE</p>
</td></tr>
<tr><td><code id="plotScore_+3A_...">...</code></td>
<td>
<p>additional arguments for <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure is returned on the graphic device
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotScorem">plotScorem</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
applejuice_uf &lt;- unfold(applejuice) # unfold list into matrix
result &lt;- prcomp(applejuice_uf) 
plotScore(result) # plot PC1 vs PC2 score
plotScore(result, pch = 3, col = "blue") # change shape and color

# get country of apple production
country &lt;- sapply(strsplit(names(applejuice), split = "-"), "[", 1) 
plotScore(result, label = country) # add label

# or plot by group
plotScore(result, xPC = 1, yPC = 3, group = country) 

# custom point types and color
plotScore(result, xPC = 1, yPC = 3, group = country, pch = c(1,2), col = c("green", "black"))

# move legend outside
plotScore(result, xPC = 1, yPC = 3, group = country, legendoutside = TRUE)

# two groups
cultivar &lt;- sapply(strsplit(names(applejuice), split = "-"), "[", 2) 
plotScore(result, group = country, group2 = cultivar)

# make the points more transparent
## Not run: 
require(scales)
plotScore(result, group = country, group2 = country, col = alpha(generateColor(2), 0.7))

## End(Not run)

</code></pre>

<hr>
<h2 id='plotScorem'>Plot score matrix for prcomp result based on group</h2><span id='topic+plotScorem'></span>

<h3>Description</h3>

<p>Plot score matrix for <code><a href="stats.html#topic+prcomp">prcomp</a></code> (PCA) result based on group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotScorem(prcompResult, ncomp = 4, group, cex = 1.5, col = NULL,
  pch = NULL, legendtitle = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotScorem_+3A_prcompresult">prcompResult</code></td>
<td>
<p>output object from <code><a href="stats.html#topic+prcomp">prcomp</a></code> function</p>
</td></tr>
<tr><td><code id="plotScorem_+3A_ncomp">ncomp</code></td>
<td>
<p>maximum number of PC score to plot</p>
</td></tr>
<tr><td><code id="plotScorem_+3A_group">group</code></td>
<td>
<p>a vector of numeric, character or factor class separating 
the samples into groups.</p>
</td></tr>
<tr><td><code id="plotScorem_+3A_cex">cex</code></td>
<td>
<p>(optional) size of points on graphs</p>
</td></tr>
<tr><td><code id="plotScorem_+3A_col">col</code></td>
<td>
<p>point color palette</p>
</td></tr>
<tr><td><code id="plotScorem_+3A_pch">pch</code></td>
<td>
<p>point type palette</p>
</td></tr>
<tr><td><code id="plotScorem_+3A_legendtitle">legendtitle</code></td>
<td>
<p>legend title</p>
</td></tr>
<tr><td><code id="plotScorem_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed on to <code><a href="graphics.html#topic+pairs">pairs</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A figure is returned on the graphic device
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+pairs">pairs</a></code>, <code><a href="#topic+plotScore">plotScore</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
# country of apple production
country &lt;- sapply(strsplit(names(applejuice), split = "-"), "[", 1)

applejuice_uf &lt;- unfold(applejuice) # unfold list into matrix
result &lt;- prcomp(applejuice_uf) 
# plot PC1 vs PC3 score based on country of production
plotScorem(result, ncomp = 4, group = country) 

# specify colours
plotScorem(result, ncomp = 4, group = country, col = c("black", "grey"))

</code></pre>

<hr>
<h2 id='prcompname'>Create name for prcomp result</h2><span id='topic+prcompname'></span>

<h3>Description</h3>

<p>Create name for <code><a href="stats.html#topic+prcomp">prcomp</a></code> result
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prcompname(prcompResult, PC, explvar = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prcompname_+3A_prcompresult">prcompResult</code></td>
<td>
<p>output value from <code><a href="stats.html#topic+prcomp">prcomp</a></code> function</p>
</td></tr>
<tr><td><code id="prcompname_+3A_pc">PC</code></td>
<td>
<p>PC number</p>
</td></tr>
<tr><td><code id="prcompname_+3A_explvar">explvar</code></td>
<td>
<p>(logical) show explained variance (%) or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
applejuice_uf &lt;- unfold(applejuice) # unfold list into matrix
result &lt;- prcomp(applejuice_uf) 
prcompname(result, 1)

</code></pre>

<hr>
<h2 id='print.EEM'>Print EEM</h2><span id='topic+print.EEM'></span>

<h3>Description</h3>

<p>Print EEM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'EEM'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.EEM_+3A_x">x</code></td>
<td>
<p>EEM class object</p>
</td></tr>
<tr><td><code id="print.EEM_+3A_...">...</code></td>
<td>
<p>arguments for <code>print</code> function</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
print(applejuice)

</code></pre>

<hr>
<h2 id='readEEM'>Read raw files and return a list</h2><span id='topic+readEEM'></span>

<h3>Description</h3>

<p>Read raw files from fluorescence spectrometer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readEEM(path = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readEEM_+3A_path">path</code></td>
<td>
<p>path to the files or folders which contains raw files (accept a vector).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The supported format is *.txt, *.csv and *.dat files from FP-8500 (JASCO), F-7000 (Hitachi Hi-tech), RF-6000 (Shimadzu) and
Aqualog (Horiba) fluorescence spectrometer. 
It is likely that outputs from different machines of the same companies are supported by this function.
Please send a word or pull request to add support for other formats.
</p>


<h3>Value</h3>

<p><code>readEEM</code> returns a list containing each raw files
</p>

<hr>
<h2 id='summary.EEM'>SummarizeEEM EEM list</h2><span id='topic+summary.EEM'></span>

<h3>Description</h3>

<p>Summarize by listing the sample number, names and their dimensions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'EEM'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.EEM_+3A_object">object</code></td>
<td>
<p>a list containing EEM data as created by <code>readEEM</code> function.</p>
</td></tr>
<tr><td><code id="summary.EEM_+3A_...">...</code></td>
<td>
<p>arguments for <code>summary</code> function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Text on console
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
summary(applejuice)

</code></pre>

<hr>
<h2 id='unfold'>Unfold EEM list into a matrix</h2><span id='topic+unfold'></span>

<h3>Description</h3>

<p>Unfold EEM list into a matrix with columns as variables (wavelength conditions) and rows as samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unfold(EEM, replaceNA = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unfold_+3A_eem">EEM</code></td>
<td>
<p>a list containing EEM data as created by <code>readEEM</code> function.</p>
</td></tr>
<tr><td><code id="unfold_+3A_replacena">replaceNA</code></td>
<td>
<p>logical value whether to replace NA with 0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Unfolded EEM matrix where columns are wavelength condition and rows are samples
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(applejuice)
applejuice_uf &lt;- unfold(applejuice) # unfold list into matrix
dim(applejuice_uf) # dimension of unfolded matrix

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
