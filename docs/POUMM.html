<!DOCTYPE html><html><head><title>Help for package POUMM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {POUMM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#analyseMCMCs'><p>Extract data from an MCMC chain</p>
This is an internal function.</a></li>
<li><a href='#chld'><p>Node indices of the direct descendants of n in the phylogeny.</p></a></li>
<li><a href='#coef.POUMM'><p>Extract maximum likelihood fitted parameters (coefficients) from a fitted</p>
POUMM  model.</a></li>
<li><a href='#covFunPOUMM'><p>A vectorized expected covariance function for a given tree and a fitted POUMM</p>
model</a></li>
<li><a href='#covHPDFunPOUMM'><p>A vectorized function returning HPD intervals of the expected covariance for</p>
a given tree and a fitted POUMM model</a></li>
<li><a href='#covPOUMM'><p>Expected covariance of two tips at given root-tip time and phylogenetic distance</p></a></li>
<li><a href='#covVTipsGivenTreePOUMM'><p>Variance covariance matrix of the values at the tips of a tree under an OU</p>
process</a></li>
<li><a href='#dVNodesGivenTreePOUMM'><p>Multivariate density of observed values along a tree given an OU process of</p>
evolution and root-value</a></li>
<li><a href='#edgesFrom'><p>Edge indices of the edges in tree starting from n</p></a></li>
<li><a href='#fitted.POUMM'><p>Extract maximum likelihood expected genotypic values at the tips of a tree,</p>
to which a POUMM model has been previously fitted</a></li>
<li><a href='#gPOUMM'><p>Distribution of the genotypic values under a POUMM fit</p></a></li>
<li><a href='#H2'><p>Phylogenetic heritability estimated at time t</p></a></li>
<li><a href='#likPOUMMGivenTreeVTips'><p>Density of observed tip-values given a tree, assuming Ornstein-Uhlenbeck</p>
process for the genetic contributions along the tree and normally distributed
environmental deviations.</a></li>
<li><a href='#likPOUMMGivenTreeVTipsC'><p>Fast (parallel) POUMM likelihood calculation using the SPLITT</p>
library</a></li>
<li><a href='#loglik_abc_g0_g0Prior'><p>Processing of the root value and calculation of the maximum log-likelihood</p>
for the given coefficients abc, and parameters theta, g0 and g0Prior. This is
an internal function.</a></li>
<li><a href='#logLik.POUMM'><p>Extract maximum likelihood and degrees of freedom from a fitted POUMM model</p></a></li>
<li><a href='#maxLikPOUMMGivenTreeVTips'><p>Find a maximum likelihood fit of the POUMM model</p></a></li>
<li><a href='#mcmcPOUMMGivenPriorTreeVTips'><p>MCMC-sampling from a posterior distribution of a P(OU)MM model given tree,</p>
values at the tips and a prior distribution</a></li>
<li><a href='#nobs.POUMM'><p>Number of tips in a phylogenetic tree, POUMM has been fit on.</p></a></li>
<li><a href='#nodeTimes'><p>Calculate the time from the root to each node of the tree</p></a></li>
<li><a href='#OU'><p>Distribution of an Ornstein-Uhlenbeck Process at Time <code class="reqn">t</code>, Given</p>
Initial State at Time <code class="reqn">0</code></a></li>
<li><a href='#PhylogeneticH2'><p>Phylogenetic Heritability</p></a></li>
<li><a href='#plot.POUMM'><p>Plots of a POUMM-fit</p></a></li>
<li><a href='#plot.summary.POUMM'><p>Plot a summary of a POUMM fit</p></a></li>
<li><a href='#POUMM'><p>The Phylogenetic (Ornstein-Uhlenbeck) Mixed Model</p></a></li>
<li><a href='#POUMMIsADevRelease'><p>Check if the POUMM version correpsonds to a dev release</p></a></li>
<li><a href='#pruneTree'><p>Extract information for fast likelihood calculation using the</p>
breadth-first pruning algorithm.</a></li>
<li><a href='#residuals.POUMM'><p>Extract maximum likelihood environmental contributions (residuals) at the tips of a tree, to which a POUMM model has been fitted.</p></a></li>
<li><a href='#rTrajectoryOU'><p>Generation of a random trajectory of an OU process starting from a given</p>
initial state</a></li>
<li><a href='#rTrajectoryOUDef'><p>Generation of a random trajectory of an OU process starting from a given</p>
initial state (only for test purpose)</a></li>
<li><a href='#rVNodesGivenTreePOUMM'><p>Random generation of values along a phylogenetic tree following a branching</p>
OU process</a></li>
<li><a href='#simulatePOUMMLikelihoodMainLoop'><p>Writes verbose messages of the order of tree traversal during likelihood calculation</p></a></li>
<li><a href='#simulateTrait'><p>Simulate a trait on a tree under a ML fit of the POUMM model</p></a></li>
<li><a href='#specPOUMM'><p>Specifying a POUMM fit</p></a></li>
<li><a href='#statistics'><p>Extract statistics from sampled or inferred parameters of a</p>
POUMM fit</a></li>
<li><a href='#summary.POUMM'><p>Summarize the results of a POUMM-fit</p></a></li>
<li><a href='#validateSpecPOUMM'><p>Validate a POUMM specification</p></a></li>
<li><a href='#validateZTree'><p>Validate phenotypic values and phylogenetic tree</p></a></li>
<li><a href='#vignetteCachedResults'><p>Cached objects for the POUMM vignettes and examples</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Phylogenetic Ornstein-Uhlenbeck Mixed Model</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-10-20</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Venelin Mitov &lt;vmitov@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The Phylogenetic Ornstein-Uhlenbeck Mixed Model (POUMM) allows to 
    estimate the phylogenetic heritability of continuous traits, to test 
    hypotheses of neutral evolution versus stabilizing selection, to quantify 
    the strength of stabilizing selection, to estimate measurement error and to
    make predictions about the evolution of a phenotype and phenotypic variation 
    in a population. The package implements combined maximum likelihood and 
    Bayesian inference of the univariate Phylogenetic Ornstein-Uhlenbeck Mixed 
    Model, fast parallel likelihood calculation, maximum likelihood 
    inference of the genotypic values at the tips, functions for summarizing and
    plotting traces and posterior samples, functions for simulation of a univariate 
    continuous trait evolution model along a phylogenetic tree. So far, the 
    package has been used for estimating the heritability of quantitative traits
    in macroevolutionary and epidemiological studies, see e.g. 
    Bertels et al. (2017) &lt;<a href="https://doi.org/10.1093%2Fmolbev%2Fmsx246">doi:10.1093/molbev/msx246</a>&gt; and 
    Mitov and Stadler (2018) &lt;<a href="https://doi.org/10.1093%2Fmolbev%2Fmsx328">doi:10.1093/molbev/msx328</a>&gt;. The algorithm for 
    parallel POUMM likelihood calculation has been published in 
    Mitov and Stadler (2019) &lt;<a href="https://doi.org/10.1111%2F2041-210X.13136">doi:10.1111/2041-210X.13136</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3.0)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), stats, Rcpp, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, data.table(&ge; 1.13.2), coda, foreach, ggplot2, lamW,
adaptMCMC, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, usethis, Rmpfr, mvtnorm, lmtest, knitr, rmarkdown,
parallel, doParallel</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>no</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://venelin.github.io/POUMM/index.html">https://venelin.github.io/POUMM/index.html</a>,
<a href="https://github.com/venelin/POUMM">https://github.com/venelin/POUMM</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/venelin/POUMM/issues">https://github.com/venelin/POUMM/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-21 08:36:29 UTC; venelin</td>
</tr>
<tr>
<td>Author:</td>
<td>Venelin Mitov [aut, cre, cph] (&lt;a
    href="https://venelin.github.io"&gt;venelin.github.io&lt;/a&gt;),
  Matt Dowle [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-27 14:00:18 UTC</td>
</tr>
</table>
<hr>
<h2 id='analyseMCMCs'>Extract data from an MCMC chain
This is an internal function.</h2><span id='topic+analyseMCMCs'></span>

<h3>Description</h3>

<p>Extract data from an MCMC chain
This is an internal function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyseMCMCs(
  chains,
  stat = NULL,
  statName = "logpost",
  start,
  end,
  thinMCMC,
  as.dt = FALSE,
  k = NA,
  N = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyseMCMCs_+3A_chains">chains</code>, <code id="analyseMCMCs_+3A_stat">stat</code>, <code id="analyseMCMCs_+3A_statname">statName</code>, <code id="analyseMCMCs_+3A_start">start</code>, <code id="analyseMCMCs_+3A_end">end</code>, <code id="analyseMCMCs_+3A_thinmcmc">thinMCMC</code>, <code id="analyseMCMCs_+3A_as.dt">as.dt</code>, <code id="analyseMCMCs_+3A_k">k</code>, <code id="analyseMCMCs_+3A_n">N</code>, <code id="analyseMCMCs_+3A_...">...</code></td>
<td>
<p>internal use.</p>
</td></tr>
</table>

<hr>
<h2 id='chld'>Node indices of the direct descendants of n in the phylogeny.</h2><span id='topic+chld'></span>

<h3>Description</h3>

<p>Node indices of the direct descendants of n in the phylogeny.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chld(tree, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chld_+3A_tree">tree</code></td>
<td>
<p>an object of class phylo</p>
</td></tr>
<tr><td><code id="chld_+3A_n">n</code></td>
<td>
<p>an index of a node (root, internal or tip) in tree</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer vector.
</p>

<hr>
<h2 id='coef.POUMM'>Extract maximum likelihood fitted parameters (coefficients) from a fitted 
POUMM  model.</h2><span id='topic+coef.POUMM'></span>

<h3>Description</h3>

<p>Extract maximum likelihood fitted parameters (coefficients) from a fitted 
POUMM  model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POUMM'
coef(object, mapped = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.POUMM_+3A_object">object</code></td>
<td>
<p>An object of class POUMM.</p>
</td></tr>
<tr><td><code id="coef.POUMM_+3A_mapped">mapped</code></td>
<td>
<p>Logical indicating whether the standard POUMM parameters should
also be extracted.</p>
</td></tr>
<tr><td><code id="coef.POUMM_+3A_...">...</code></td>
<td>
<p>Not used; added for compatibility with generic function coef.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The parameters extracted are the ones used as input to the model's
parMapping function.
</p>


<h3>Value</h3>

<p>A named vector with the fitted parameters of the model.
</p>

<hr>
<h2 id='covFunPOUMM'>A vectorized expected covariance function for a given tree and a fitted POUMM
model</h2><span id='topic+covFunPOUMM'></span>

<h3>Description</h3>

<p>A vectorized expected covariance function for a given tree and a fitted POUMM
model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covFunPOUMM(object, corr = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covFunPOUMM_+3A_object">object</code></td>
<td>
<p>an S3 object of class POUMM</p>
</td></tr>
<tr><td><code id="covFunPOUMM_+3A_corr">corr</code></td>
<td>
<p>logical indicating if an expected correlation function 
should be returned
For non-ultrametric trees, usually the mean root-tip distance is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a function of three numerical parameters:
tau - the phylogenetic distance between a two tips;
tanc - the distance from the root to their most recent common ancestor.
t - the root-tip distance (assuming that the two tips are at equal distance from the root)
</p>

<hr>
<h2 id='covHPDFunPOUMM'>A vectorized function returning HPD intervals of the expected covariance for 
a given tree and a fitted POUMM model</h2><span id='topic+covHPDFunPOUMM'></span>

<h3>Description</h3>

<p>A vectorized function returning HPD intervals of the expected covariance for 
a given tree and a fitted POUMM model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covHPDFunPOUMM(object, prob = 0.95, corr = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covHPDFunPOUMM_+3A_object">object</code></td>
<td>
<p>an S3 object of class POUMM</p>
</td></tr>
<tr><td><code id="covHPDFunPOUMM_+3A_prob">prob</code></td>
<td>
<p>a Numerical between 0 and 1</p>
</td></tr>
<tr><td><code id="covHPDFunPOUMM_+3A_corr">corr</code></td>
<td>
<p>logical indicating if an expected correlation HPD interval 
function should be returned.</p>
</td></tr>
<tr><td><code id="covHPDFunPOUMM_+3A_...">...</code></td>
<td>
<p>additional parameters passed to summary.POUMM</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a function of a numerica matrix x with 3 columns corresponding to
tau, tanc and t (see covFunPOUMM). The function reteruns a two-colun matrix
with the lower and upper limit of the HPD for each row in the input matrix.
</p>

<hr>
<h2 id='covPOUMM'>Expected covariance of two tips at given root-tip time and phylogenetic distance</h2><span id='topic+covPOUMM'></span>

<h3>Description</h3>

<p>Expected covariance of two tips at given root-tip time and phylogenetic distance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covPOUMM(
  alpha,
  sigma,
  sigmae,
  t,
  tau,
  tanc = t - tau/2,
  corr = FALSE,
  as.matrix = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covPOUMM_+3A_alpha">alpha</code>, <code id="covPOUMM_+3A_sigma">sigma</code>, <code id="covPOUMM_+3A_sigmae">sigmae</code></td>
<td>
<p>POUMM parameters</p>
</td></tr>
<tr><td><code id="covPOUMM_+3A_t">t</code></td>
<td>
<p>A non-negative number or vector time from the beginning of the POUMM
process (root-tip distance). If a vector, the evaluation is done on each 
couple (row) from cbind(t, tau).</p>
</td></tr>
<tr><td><code id="covPOUMM_+3A_tau">tau</code></td>
<td>
<p>A non-negative number or vector indicating the phylogenetic 
distance between two tips, each of them located at time t from the root. 
If a vector, the evaluation is done on each couple (row) from cbind(t, tau).</p>
</td></tr>
<tr><td><code id="covPOUMM_+3A_tanc">tanc</code></td>
<td>
<p>A non-negative number or vector indication the root-mrca distance
for a couple of tips. Defaults to t-tau/2 corresponding to an ultrametric tree.</p>
</td></tr>
<tr><td><code id="covPOUMM_+3A_corr">corr</code></td>
<td>
<p>Logical indicating whether correlation should be returned instead
of covariance.</p>
</td></tr>
<tr><td><code id="covPOUMM_+3A_as.matrix">as.matrix</code></td>
<td>
<p>Logical indicating if a variance-covariance matrix should be
returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assumes that the two tips are at equal distance t from 
the root. This implies that the root-tip distance of their mrca is t - tau/2.
</p>


<h3>Value</h3>

<p>If as.matrix == FALSE, a number. Otherwise a two by two symmetric
matrix. If t or tau is a vector of length bigger than 1, then a vector of 
numbers or a list of matrices.
</p>

<hr>
<h2 id='covVTipsGivenTreePOUMM'>Variance covariance matrix of the values at the tips of a tree under an OU 
process</h2><span id='topic+covVTipsGivenTreePOUMM'></span>

<h3>Description</h3>

<p>Variance covariance matrix of the values at the tips of a tree under an OU 
process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covVTipsGivenTreePOUMM(
  tree,
  alpha = 0,
  sigma = 1,
  sigmae = 0,
  tanc = NULL,
  tauij = NULL,
  corr = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covVTipsGivenTreePOUMM_+3A_tree">tree</code></td>
<td>
<p>A phylo object.</p>
</td></tr>
<tr><td><code id="covVTipsGivenTreePOUMM_+3A_alpha">alpha</code>, <code id="covVTipsGivenTreePOUMM_+3A_sigma">sigma</code></td>
<td>
<p>Non-negative numeric values, parameters of the OU process.</p>
</td></tr>
<tr><td><code id="covVTipsGivenTreePOUMM_+3A_sigmae">sigmae</code></td>
<td>
<p>Non-negative numeric value, environmental standard deviation at
the tips.</p>
</td></tr>
<tr><td><code id="covVTipsGivenTreePOUMM_+3A_tanc">tanc</code></td>
<td>
<p>Numerical matrix with the time-distance from the root of the tree
to the mrca of each tip-couple. If NULL it will be calculated.</p>
</td></tr>
<tr><td><code id="covVTipsGivenTreePOUMM_+3A_tauij">tauij</code></td>
<td>
<p>Numerical matrix with the time (patristic) distance between each
pair of tips. If NULL, it will be calculated.</p>
</td></tr>
<tr><td><code id="covVTipsGivenTreePOUMM_+3A_corr">corr</code></td>
<td>
<p>Logical indicating if a correlation matrix shall be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a variance covariance or a correlation matrix of the tips in tree.
</p>


<h3>References</h3>

<p>(Hansen 1997) Stabilizing selection and the comparative analysis 
of adaptation.
</p>

<hr>
<h2 id='dVNodesGivenTreePOUMM'>Multivariate density of observed values along a tree given an OU process of 
evolution and root-value</h2><span id='topic+dVNodesGivenTreePOUMM'></span>

<h3>Description</h3>

<p>Calculates the conditional probability density of observed 
values at the tips and internal nodes of a tree, given that tree, the value
at the root, z[N+1], where N is the number of tips in the tree, known 
measurement error e for each value in z, and a POUMM model of evolution. 
This function is mostly used to calculate the likelihood of simulated data
under known model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dVNodesGivenTreePOUMM(
  z,
  tree,
  alpha,
  theta,
  sigma,
  sigmae = 0,
  e = rep(0, length(z)),
  log = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dVNodesGivenTreePOUMM_+3A_z">z</code></td>
<td>
<p>A numeric vector of size length(tree$tip.label)+tree$Nnode 
representing the observed values at the tips, root and internal nodes.</p>
</td></tr>
<tr><td><code id="dVNodesGivenTreePOUMM_+3A_tree">tree</code></td>
<td>
<p>An object of class phylo.</p>
</td></tr>
<tr><td><code id="dVNodesGivenTreePOUMM_+3A_alpha">alpha</code>, <code id="dVNodesGivenTreePOUMM_+3A_theta">theta</code>, <code id="dVNodesGivenTreePOUMM_+3A_sigma">sigma</code></td>
<td>
<p>Numeric values, parameters of the OU model.</p>
</td></tr>
<tr><td><code id="dVNodesGivenTreePOUMM_+3A_sigmae">sigmae</code></td>
<td>
<p>Numeric non-negative value or vector of length(z) elements 
(default 0). Specifies the
standard deviation of random environmental contribution (and eventually 
measurement error) to be added to the values. Note that if measurement standard
error, se, is known and needs to be added to the environmental contribution,
the right way to specify the parameter would be sqrt(sigmae^2+se^2), not
sigmae+se.</p>
</td></tr>
<tr><td><code id="dVNodesGivenTreePOUMM_+3A_e">e</code></td>
<td>
<p>Numeric vector of size length(z) representing exactly known 
error (sum of environmental contribution and measurement error). 
Defaults to a vector of zeroes.</p>
</td></tr>
<tr><td><code id="dVNodesGivenTreePOUMM_+3A_log">log</code></td>
<td>
<p>Logical indicating whether a log-likelihood should be returned 
instead of a likelihood. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value, the multivariate probability density of z under the 
given parameters.
</p>

<hr>
<h2 id='edgesFrom'>Edge indices of the edges in tree starting from n</h2><span id='topic+edgesFrom'></span>

<h3>Description</h3>

<p>Edge indices of the edges in tree starting from n
</p>


<h3>Usage</h3>

<pre><code class='language-R'>edgesFrom(tree, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="edgesFrom_+3A_tree">tree</code></td>
<td>
<p>an object of class phylo</p>
</td></tr>
<tr><td><code id="edgesFrom_+3A_n">n</code></td>
<td>
<p>an index of a node (root, internal or tip) in tree</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer vector.
</p>

<hr>
<h2 id='fitted.POUMM'>Extract maximum likelihood expected genotypic values at the tips of a tree,
to which a POUMM model has been previously fitted</h2><span id='topic+fitted.POUMM'></span>

<h3>Description</h3>

<p>Extract maximum likelihood expected genotypic values at the tips of a tree,
to which a POUMM model has been previously fitted
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POUMM'
fitted(object, vCov = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.POUMM_+3A_object">object</code></td>
<td>
<p>An object of class POUMM.</p>
</td></tr>
<tr><td><code id="fitted.POUMM_+3A_vcov">vCov</code></td>
<td>
<p>A logical indicating whether a list with the genotypic values and their variance covariance matrix should be returned or only a vector of the genotypic values (default is FALSE).</p>
</td></tr>
<tr><td><code id="fitted.POUMM_+3A_...">...</code></td>
<td>
<p>Not used; added for compatibility with generic function fitted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If vCov == TRUE, a list with elements g - the genotypic values and
vCov - the variance-covariance matrix of these values for the specific tree,
observed values z and POUMM ML-fit. If vCov == FALSE, only the vector of 
genotypic values corresponding to the tip-labels in the tree is returned.
</p>

<hr>
<h2 id='gPOUMM'>Distribution of the genotypic values under a POUMM fit</h2><span id='topic+gPOUMM'></span>

<h3>Description</h3>

<p>Distribution of the genotypic values under a POUMM fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gPOUMM(z, tree, g0, alpha, theta, sigma, sigmae)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gPOUMM_+3A_z">z</code></td>
<td>
<p>A numeric vector of size length(tree$tip.label) representing the trait
values at the tip-nodes.</p>
</td></tr>
<tr><td><code id="gPOUMM_+3A_tree">tree</code></td>
<td>
<p>an object of class phylo</p>
</td></tr>
<tr><td><code id="gPOUMM_+3A_g0">g0</code></td>
<td>
<p>A numeric value at the root of the tree, genotypic contribution.</p>
</td></tr>
<tr><td><code id="gPOUMM_+3A_alpha">alpha</code>, <code id="gPOUMM_+3A_theta">theta</code>, <code id="gPOUMM_+3A_sigma">sigma</code></td>
<td>
<p>Numeric values, parameters of the OU model.</p>
</td></tr>
<tr><td><code id="gPOUMM_+3A_sigmae">sigmae</code></td>
<td>
<p>Numeric non-negative value (default 0). Specifies the standard
deviation of random environmental contribution (white noise) included in z.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with elements V.g, V.g_1, mu.g, V.e, V.e_1, mu.e, V.g.poumm, mu.g.poumm.
</p>

<hr>
<h2 id='H2'>Phylogenetic heritability estimated at time t</h2><span id='topic+H2'></span>

<h3>Description</h3>

<p>Phylogenetic heritability estimated at time t
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H2(alpha, sigma, sigmae, t = Inf, tm = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="H2_+3A_alpha">alpha</code>, <code id="H2_+3A_sigma">sigma</code></td>
<td>
<p>numeric, parameters of the OU process acting on the
genetic contributions</p>
</td></tr>
<tr><td><code id="H2_+3A_sigmae">sigmae</code></td>
<td>
<p>numeric, environmental standard deviation</p>
</td></tr>
<tr><td><code id="H2_+3A_t">t</code></td>
<td>
<p>time from the beginning of the process at which heritability should
be calculated, i.e. epidemiologic time</p>
</td></tr>
<tr><td><code id="H2_+3A_tm">tm</code></td>
<td>
<p>average time for within host evolution from getting infected until
getting measured or passing on the infection to another host</p>
</td></tr>
</table>

<hr>
<h2 id='likPOUMMGivenTreeVTips'>Density of observed tip-values given a tree, assuming Ornstein-Uhlenbeck 
process for the genetic contributions along the tree and normally distributed
environmental deviations.</h2><span id='topic+likPOUMMGivenTreeVTips'></span><span id='topic+dVTipsGivenTreePOUMM'></span>

<h3>Description</h3>

<p>Calculates the (log-)probability density of trait values at the
tip-nodes given the tree and assuming that the trait value at the tips is the
sum of a genetic contribution, g, that evolved on the tree according to an OU
process with parameters alpha, theta, sigma and an environmental deviation, 
e, that is distributed normally and independently between the tips of the 
tree. Note: Without additional assumptions for the distribution of the value
at the root of the tree, the likelihood is not defined at alpha=0, although 
this corresponds to the limiting Brownian motion process with mean value 
theta and unit time variance sigma^2. Considering the observed data and tree as
a fixed parameter and the POUMM parameters as variables, this function is
interpreted as the POUMM likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likPOUMMGivenTreeVTips(
  z,
  tree,
  alpha,
  theta,
  sigma,
  sigmae = 0,
  g0 = NA,
  g0Prior = NULL,
  log = TRUE,
  pruneInfo = pruneTree(tree, z),
  usempfr = 0,
  maxmpfr = 2,
  precbits = 128,
  debug = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_z">z</code></td>
<td>
<p>A numeric vector of size length(tree$tip.label) representing the
trait values at the tip-nodes.</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_tree">tree</code></td>
<td>
<p>an object of class phylo</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_alpha">alpha</code></td>
<td>
<p>the strength of the selection</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_theta">theta</code></td>
<td>
<p>long term mean value of the OU process</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_sigma">sigma</code></td>
<td>
<p>the unit-time standard deviation of the random component in the
OU process.</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_sigmae">sigmae</code></td>
<td>
<p>the standard deviation of the environmental deviation added to
the genetic contribution at each tip, by default 0, meaning no
environmental deviation.</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_g0">g0</code></td>
<td>
<p>Numeric, NA or NaN, either a fixed genotypic value at the root of 
tree or NA or NaN. A NA &quot;Not Available&quot; will cause to analytically
calculate the value of g0 that would maximize the conditional likelihood of
the data given g0. A NaN &quot;Not a Number&quot; will cause integration over g0
taking values in (-Inf,+Inf) assuming that g0 is normally distributed with
mean g0Prior$mean and variance g0Prior$var (see parameter g0Prior).</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_g0prior">g0Prior</code></td>
<td>
<p>Either NULL or a list with named numeric or character members
&quot;mean&quot; and &quot;var&quot;. Specifies a prior normal distribution for the parameter g0.
If characters, the members mean and var are evaluated as R-expressions.</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_log">log</code></td>
<td>
<p>Logical indicating whether log-likelihood should be returned
instead of likelihood, default is TRUE.</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_pruneinfo">pruneInfo</code></td>
<td>
<p>list returned by pruneTree(tree) to be passed in explicit
calls to dVGivenTreeOU.</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_usempfr">usempfr</code></td>
<td>
<p>integer indicating if and how mpfr should be used for small 
parameter values (any(c(alpha, sigma, sigmae) &lt; 0.01)). Using the mpfr 
package can be forced by specifying an integer greater or equal to 2. 
Setting usempfr=0 (default) causes high precision likelihood 
calculation to be done on each encounter of parameters with at least 1 bigger
log-likelihood value than any of the currently found
maximum log-likelihood or the previously calculated log-likelihood value
Requires the Rmpfr package. Note that using mpfr may increase the time for 
one likelihood calculation more than 100-fold. Set usempfr to -1 or less
to completely disable Rmpfr functionality.</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_maxmpfr">maxmpfr</code></td>
<td>
<p>integer (not used)</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_precbits">precbits</code></td>
<td>
<p>integer specifying precision bits for mpfr. Default is 512.</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTips_+3A_debug">debug</code></td>
<td>
<p>logical, if set to TRUE some debugging information is printed 
during likelihood calculation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric with attributes &quot;g0&quot; and &quot;g0LogPrior&quot;.
</p>

<hr>
<h2 id='likPOUMMGivenTreeVTipsC'>Fast (parallel) POUMM likelihood calculation using the SPLITT 
library</h2><span id='topic+likPOUMMGivenTreeVTipsC'></span>

<h3>Description</h3>

<p>Fast (log-)likelihood calculation using C++
and OpenMP based parallelization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likPOUMMGivenTreeVTipsC(
  integrator,
  alpha,
  theta,
  sigma,
  sigmae,
  g0 = NA,
  g0Prior = NULL,
  log = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="likPOUMMGivenTreeVTipsC_+3A_integrator">integrator</code></td>
<td>
<p>An Rcpp module object from the class POUMM_AbcPOUMM. This 
object is to be created using the function pruneTree (see example). 
This object contains the data and tree (arguments z and tree of the 
equivalent function dVTipsGivenTreeVTips.).</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTipsC_+3A_alpha">alpha</code></td>
<td>
<p>the strength of the selection</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTipsC_+3A_theta">theta</code></td>
<td>
<p>long term mean value of the OU process</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTipsC_+3A_sigma">sigma</code></td>
<td>
<p>the unit-time standard deviation of the random component in the
OU process.</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTipsC_+3A_sigmae">sigmae</code></td>
<td>
<p>the standard deviation of the environmental deviation added to
the genetic contribution at each tip, by default 0, meaning no
environmental deviation.</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTipsC_+3A_g0">g0</code></td>
<td>
<p>Numeric, NA or NaN, either a fixed genotypic value at the root of 
tree or NA or NaN. A NA &quot;Not Available&quot; will cause to analytically
calculate the value of g0 that would maximize the conditional likelihood of
the data given g0. A NaN &quot;Not a Number&quot; will cause integration over g0
taking values in (-Inf,+Inf) assuming that g0 is normally distributed with
mean g0Prior$mean and variance g0Prior$var (see parameter g0Prior).</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTipsC_+3A_g0prior">g0Prior</code></td>
<td>
<p>Either NULL or a list with named numeric or character members
&quot;mean&quot; and &quot;var&quot;. Specifies a prior normal distribution for the parameter
g0.
If characters, the members mean and var are evaluated as R-expressions.</p>
</td></tr>
<tr><td><code id="likPOUMMGivenTreeVTipsC_+3A_log">log</code></td>
<td>
<p>Logical indicating whether log-likelihood should be returned
instead of likelihood, default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is the C++ equivalent of dVTipsGivenTreePOUMM
(aliased also as likPOUMMGivenTreeVTips). Currently, the function does not 
support multiple precision floating point operations (supported in 
dVTipsGivenTreePOUMM). The C++ implementation is based on the library for
parallel tree traversal &quot;SPLITT&quot; 
(https://github.com/venelin/SPLITT.git).
</p>


<h3>Value</h3>

<p>A numeric with attributes &quot;g0&quot; and &quot;g0LogPrior&quot;.
</p>


<h3>References</h3>

<p>Mitov, V., and Stadler, T. (2017). Fast and Robust Inference of Phylogenetic Ornstein-Uhlenbeck Models Using Parallel Likelihood Calculation. bioRxiv, 115089. 
https://doi.org/10.1101/115089
Mitov, V., &amp; Stadler, T. (2017). Fast Bayesian Inference of Phylogenetic Models Using Parallel Likelihood Calculation and Adaptive Metropolis Sampling. Systematic Biology, 235739. http://doi.org/10.1101/235739
</p>


<h3>See Also</h3>

<p>dVTipsGivenTreePOUMM
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
N &lt;- 100
tr &lt;- ape::rtree(N)
z &lt;- rVNodesGivenTreePOUMM(tr, 0, 2, 3, 1, 1)[1:N]
pruneInfo &lt;- pruneTree(tr, z)
microbenchmark::microbenchmark(
  likCpp &lt;- likPOUMMGivenTreeVTipsC(pruneInfo$integrator, 2, 3, 1, 1),
  likR &lt;- likPOUMMGivenTreeVTips(z, tr, 2, 3, 1, 1, pruneInfo = pruneInfo))

# should be the same values
likCpp
likR

## End(Not run)

</code></pre>

<hr>
<h2 id='loglik_abc_g0_g0Prior'>Processing of the root value and calculation of the maximum log-likelihood 
for the given coefficients abc, and parameters theta, g0 and g0Prior. This is
an internal function.</h2><span id='topic+loglik_abc_g0_g0Prior'></span>

<h3>Description</h3>

<p>Processing of the root value and calculation of the maximum log-likelihood 
for the given coefficients abc, and parameters theta, g0 and g0Prior. This is
an internal function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik_abc_g0_g0Prior(abc, alpha, theta, sigma, g0, g0Prior)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik_abc_g0_g0Prior_+3A_abc">abc</code></td>
<td>
<p>a vector of 3 numerical values denoting the corresponding 
coefficients in the POUMM likelihood presented as exp(a g0^2 + b g0 + c).</p>
</td></tr>
<tr><td><code id="loglik_abc_g0_g0Prior_+3A_alpha">alpha</code>, <code id="loglik_abc_g0_g0Prior_+3A_theta">theta</code>, <code id="loglik_abc_g0_g0Prior_+3A_sigma">sigma</code></td>
<td>
<p>parameters of the OU-process.</p>
</td></tr>
<tr><td><code id="loglik_abc_g0_g0Prior_+3A_g0">g0</code></td>
<td>
<p>initial value at the root of the tree (can be NA). See argument
parMapping in ?specifyPOUMM.</p>
</td></tr>
<tr><td><code id="loglik_abc_g0_g0Prior_+3A_g0prior">g0Prior</code></td>
<td>
<p>list object. See parameter g0Prior in ?specifyPOUMM.</p>
</td></tr>
</table>

<hr>
<h2 id='logLik.POUMM'>Extract maximum likelihood and degrees of freedom from a fitted POUMM model</h2><span id='topic+logLik.POUMM'></span>

<h3>Description</h3>

<p>Extract maximum likelihood and degrees of freedom from a fitted POUMM model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POUMM'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.POUMM_+3A_object">object</code></td>
<td>
<p>An object of class POUMM.</p>
</td></tr>
<tr><td><code id="logLik.POUMM_+3A_...">...</code></td>
<td>
<p>not used; included for compliance with generic function logLik.</p>
</td></tr>
</table>

<hr>
<h2 id='maxLikPOUMMGivenTreeVTips'>Find a maximum likelihood fit of the POUMM model</h2><span id='topic+maxLikPOUMMGivenTreeVTips'></span>

<h3>Description</h3>

<p>Find a maximum likelihood fit of the POUMM model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxLikPOUMMGivenTreeVTips(
  loglik,
  pruneInfo,
  parLower,
  parUpper,
  parInitML = NULL,
  control = list(factr = 1e+08, fnscale = -1),
  verbose = FALSE,
  debug = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxLikPOUMMGivenTreeVTips_+3A_loglik">loglik</code></td>
<td>
<p>function(par, memo, parFixedNoAlpha)</p>
</td></tr>
<tr><td><code id="maxLikPOUMMGivenTreeVTips_+3A_pruneinfo">pruneInfo</code></td>
<td>
<p>a list-object returned by the pruneTree(tree, z) function.</p>
</td></tr>
<tr><td><code id="maxLikPOUMMGivenTreeVTips_+3A_parlower">parLower</code>, <code id="maxLikPOUMMGivenTreeVTips_+3A_parupper">parUpper</code></td>
<td>
<p>Two named numeric vectors indicating the boundaries of 
the search region. Default values are parLower = c(alpha = 0, theta = 0, 
sigma = 0, sigmae = 0) and parUpper = c(alpha = 100, theta = 10, sigma = 20, 
sigmae = 10).</p>
</td></tr>
<tr><td><code id="maxLikPOUMMGivenTreeVTips_+3A_parinitml">parInitML</code></td>
<td>
<p>A named vector (like parLower and parUpper) or a list of such
vectors - starting points for optim.</p>
</td></tr>
<tr><td><code id="maxLikPOUMMGivenTreeVTips_+3A_control">control</code></td>
<td>
<p>List of parameters passed on to optim, default 
list(factr = 1e8, fnscale = -1), see ?optim.</p>
</td></tr>
<tr><td><code id="maxLikPOUMMGivenTreeVTips_+3A_verbose">verbose</code></td>
<td>
<p>A logical indicating whether to print informative messages on 
the standard output.</p>
</td></tr>
<tr><td><code id="maxLikPOUMMGivenTreeVTips_+3A_debug">debug</code></td>
<td>
<p>A logical indicating whether to print debug messages 
(currently not implemented).</p>
</td></tr>
<tr><td><code id="maxLikPOUMMGivenTreeVTips_+3A_...">...</code></td>
<td>
<p>currently not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing an element par and an element value as well as the 
parameters passed
</p>

<hr>
<h2 id='mcmcPOUMMGivenPriorTreeVTips'>MCMC-sampling from a posterior distribution of a P(OU)MM model given tree, 
values at the tips and a prior distribution</h2><span id='topic+mcmcPOUMMGivenPriorTreeVTips'></span><span id='topic+mcmc.poumm'></span>

<h3>Description</h3>

<p>MCMC-sampling from a posterior distribution of a P(OU)MM model given tree, 
values at the tips and a prior distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmcPOUMMGivenPriorTreeVTips(
  loglik,
  fitML = NULL,
  parMapping,
  parInitMCMC,
  parPriorMCMC,
  parScaleMCMC,
  nSamplesMCMC,
  nAdaptMCMC,
  thinMCMC,
  accRateMCMC,
  gammaMCMC,
  nChainsMCMC,
  samplePriorMCMC,
  pruneInfo,
  ...,
  verbose = FALSE,
  parallelMCMC = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_loglik">loglik</code></td>
<td>
<p>a log-likelihood function.</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_fitml">fitML</code></td>
<td>
<p>an object returned by the maxLikPOUMMGivenTreeVTips</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_parmapping">parMapping</code></td>
<td>
<p>a function(numeric-vector) transforming a sampled vector on
the scale of the parameters alpha, theta, sigma, sigmae and g0.</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_parinitmcmc">parInitMCMC</code></td>
<td>
<p>a function(chainNumber) returning the starting point of 
the MCMC as a vector.</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_parpriormcmc">parPriorMCMC</code></td>
<td>
<p>a function(numeric-vector) returning the log-prior of the
supplied vector</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_parscalemcmc">parScaleMCMC</code></td>
<td>
<p>numeric matrix indicating the initial jump-distribution 
matrix</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_nsamplesmcmc">nSamplesMCMC</code></td>
<td>
<p>integer indicating how many iterations should the 
mcmc-chain contain</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_nadaptmcmc">nAdaptMCMC</code></td>
<td>
<p>integer indicating how many initial iterations should be 
used for adaptation of the jump-distribution matrix</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_thinmcmc">thinMCMC</code></td>
<td>
<p>integer indicating the thinning interval of the mcmc-chain</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_accratemcmc">accRateMCMC</code></td>
<td>
<p>(MCMC) numeric between 0 and 1 indicating the target 
acceptance rate Passed on to adaptMCMC::MCMC.</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_gammamcmc">gammaMCMC</code></td>
<td>
<p>(MCMC) controls the speed of adaption. Should be in the interval (0.5,1]. A lower gammaMCMC leads to faster adaption. Passed on to 
adaptMCMC::MCMC.</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_nchainsmcmc">nChainsMCMC</code></td>
<td>
<p>integer indicating the number of chains to run. Defaults 
to 1.</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_samplepriormcmc">samplePriorMCMC</code></td>
<td>
<p>logical indicating if only the prior distribution 
should be sampled. This can be useful to compare with mcmc-runs for an 
overlap between prior and posterior distributions.</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_pruneinfo">pruneInfo</code></td>
<td>
<p>a list-object returned from the pruneTree(tree, z) function.</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_...">...</code></td>
<td>
<p>Additional arguments. Currently not used except for the following:
If ... includes debug = TRUE, some debug messages will be written also
outside of the call to loglik.</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_verbose">verbose</code></td>
<td>
<p>Logical indicating if some informal messages should be written
during run. This parameter is passed to loglik.</p>
</td></tr>
<tr><td><code id="mcmcPOUMMGivenPriorTreeVTips_+3A_parallelmcmc">parallelMCMC</code></td>
<td>
<p>Logical indicating if chains should be run in parallel.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently, this function calls the MCMC function from the adaptMCMC 
package.
</p>


<h3>Value</h3>

<p>a list of coda objects
</p>

<hr>
<h2 id='nobs.POUMM'>Number of tips in a phylogenetic tree, POUMM has been fit on.</h2><span id='topic+nobs.POUMM'></span>

<h3>Description</h3>

<p>Number of tips in a phylogenetic tree, POUMM has been fit on.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POUMM'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs.POUMM_+3A_object">object</code></td>
<td>
<p>An object of class POUMM.</p>
</td></tr>
<tr><td><code id="nobs.POUMM_+3A_...">...</code></td>
<td>
<p>Not used; added for compatibility with generic function nobs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The number of tips in the tree, POUMM has been called on
</p>

<hr>
<h2 id='nodeTimes'>Calculate the time from the root to each node of the tree</h2><span id='topic+nodeTimes'></span>

<h3>Description</h3>

<p>Calculate the time from the root to each node of the tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nodeTimes(tree, tipsOnly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nodeTimes_+3A_tree">tree</code></td>
<td>
<p>An object of class phylo.</p>
</td></tr>
<tr><td><code id="nodeTimes_+3A_tipsonly">tipsOnly</code></td>
<td>
<p>Logical indicating whether the returned results should be
truncated only to the tips of the tree.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of size the number of nodes in the tree (tips, root, 
internal) containing the time from the root to the corresponding node in 
the tree.
</p>

<hr>
<h2 id='OU'>Distribution of an Ornstein-Uhlenbeck Process at Time <code class="reqn">t</code>, Given 
Initial State at Time <code class="reqn">0</code></h2><span id='topic+OU'></span><span id='topic+dOU'></span><span id='topic+rOU'></span><span id='topic+meanOU'></span><span id='topic+varOU'></span><span id='topic+sdOU'></span>

<h3>Description</h3>

<p>An Ornstein-Uhlenbeck (OU) process represents a continuous time 
Markov chain parameterized by an initial state <code class="reqn">x_0</code>, selection 
strength <code class="reqn">\alpha&gt;0</code>, long-term mean <code class="reqn">\theta</code>, and time-unit 
variance <code class="reqn">\sigma^2</code>. Given <code class="reqn">x_0</code>, at time <code class="reqn">t</code>, the state of the
process is characterized by a normal distribution with mean <code class="reqn">x_0 
  exp(-\alpha t) + \theta (1 - exp(-\alpha t))</code> and variance <code class="reqn">\sigma^2 
  (1-exp(-2 \alpha t)) / (2 \alpha)</code>. In the limit <code class="reqn">\alpha -&gt; 0</code>, the OU 
process converges to a Brownian motion process with initial state <code class="reqn">x_0</code>
and time-unit variance <code class="reqn">\sigma^2</code> (at time <code class="reqn">t</code>, this process is 
characterized by a normal distribution with mean <code class="reqn">x_0</code> and variance 
<code class="reqn">t \sigma^2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dOU(z, z0, t, alpha, theta, sigma, log = TRUE)

rOU(n, z0, t, alpha, theta, sigma)

meanOU(z0, t, alpha, theta)

varOU(t, alpha, sigma)

sdOU(t, alpha, sigma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OU_+3A_z">z</code></td>
<td>
<p>Numeric value or vector of size n.</p>
</td></tr>
<tr><td><code id="OU_+3A_z0">z0</code></td>
<td>
<p>Numeric value or vector of size n, initial value(s) to condition 
on.</p>
</td></tr>
<tr><td><code id="OU_+3A_t">t</code></td>
<td>
<p>Numeric value or vector of size n, denoting the time-step.</p>
</td></tr>
<tr><td><code id="OU_+3A_alpha">alpha</code>, <code id="OU_+3A_theta">theta</code>, <code id="OU_+3A_sigma">sigma</code></td>
<td>
<p>Numeric values or n-vectors, parameters of the OU 
process; alpha and sigma must be non-negative. A zero alpha is interpreted 
as the Brownian motion process in the limit alpha -&gt; 0.</p>
</td></tr>
<tr><td><code id="OU_+3A_log">log</code></td>
<td>
<p>Logical indicating whether the returned density should is on the logarithmic scale.</p>
</td></tr>
<tr><td><code id="OU_+3A_n">n</code></td>
<td>
<p>Integer, the number of values to sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similar to dnorm and rnorm, the functions described in this
help-page support single values as well as vectors for the parameters z,
z0, t, alpha, theta and sigma.
</p>


<h3>Value</h3>

<p>dOU returns the conditional probability density(ies) of the elements 
in z, given the initial state(s) z0, time-step(s) t and OU-parameters by
alpha, theta and sigma.
</p>
<p>rOU returns a numeric vector of length n, a random sample from the
conditional distribution(s) of one or n OU process(es) given initial
value(s) and time-step(s).
</p>
<p>meanOU returns the expected value of the OU-process at time t.
</p>
<p>varOU returns the expected variance of the OU-process at time t.
</p>
<p>sdOU returns the standard deviation of the OU-process at time t.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>dOU</code>: probability density
</p>
</li>
<li> <p><code>rOU</code>: random generator
</p>
</li>
<li> <p><code>meanOU</code>: mean value
</p>
</li>
<li> <p><code>varOU</code>: variance
</p>
</li>
<li> <p><code>sdOU</code>: standard deviation
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>z0 &lt;- 8
t &lt;- 10
n &lt;- 100000
sample &lt;- rOU(n, z0, t, 2, 3, 1)
dens &lt;- dOU(sample, z0, t, 2, 3, 1)
var(sample)  # around 1/4
varOU(t, 2, 1) 

</code></pre>

<hr>
<h2 id='PhylogeneticH2'>Phylogenetic Heritability</h2><span id='topic+PhylogeneticH2'></span><span id='topic+alpha'></span><span id='topic+sigmaOU'></span><span id='topic+sigmae'></span><span id='topic+H2e'></span>

<h3>Description</h3>

<p>The phylogenetic heritability, <code class="reqn">H^2</code>, is defined as the 
ratio of the genetic variance over the total phenotypic variance expected 
at a given evolutionary time t (measured from the root of the tree). Thus,
the phylogenetic heritability connects the parameters alpha, sigma and
sigmae of the POUMM model through a set of equations. The functions
described here provide an R-implementation of these equations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha(H2, sigma, sigmae, t = Inf)

sigmaOU(H2, alpha, sigmae, t = Inf)

sigmae(H2, alpha, sigma, t = Inf)

H2e(z, sigmae, tree = NULL, tFrom = 0, tTo = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PhylogeneticH2_+3A_h2">H2</code></td>
<td>
<p>Phylogenetic heritability at time t.</p>
</td></tr>
<tr><td><code id="PhylogeneticH2_+3A_sigmae">sigmae</code></td>
<td>
<p>Numeric, environmental phenotypic deviation at the tips.</p>
</td></tr>
<tr><td><code id="PhylogeneticH2_+3A_t">t</code></td>
<td>
<p>Numeric value denoting evolutionary time (i.e. distance from the 
root of a phylogenetic tree).</p>
</td></tr>
<tr><td><code id="PhylogeneticH2_+3A_alpha">alpha</code>, <code id="PhylogeneticH2_+3A_sigma">sigma</code></td>
<td>
<p>Numeric values or n-vectors, parameters of the OU process;
alpha and sigma must be non-negative. A zero alpha is interpreted as the 
Brownian motion process in the limit alpha -&gt; 0.</p>
</td></tr>
<tr><td><code id="PhylogeneticH2_+3A_z">z</code></td>
<td>
<p>Numerical vector of observed phenotypes.</p>
</td></tr>
<tr><td><code id="PhylogeneticH2_+3A_tree">tree</code></td>
<td>
<p>A phylo object.</p>
</td></tr>
<tr><td><code id="PhylogeneticH2_+3A_tfrom">tFrom</code>, <code id="PhylogeneticH2_+3A_tto">tTo</code></td>
<td>
<p>Numerical minimal and maximal root-tip distance to limit the
calculation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function sigmae uses the formula H2 = varOU(t, alpha, sigma) /
(varOU(t, alpha, sigma) + sigmae^2)
</p>


<h3>Value</h3>

<p>All functions return numerical values or NA, in case of invalid 
parameters
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>alpha</code>: Calculate alpha given time t, H2, sigma and sigmae
</p>
</li>
<li> <p><code>sigmaOU</code>: Calculate sigma given time t, H2 at time t, alpha
and sigmae
</p>
</li>
<li> <p><code>sigmae</code>: Calculate sigmae given alpha, sigma, and H2 at
time t
</p>
</li>
<li> <p><code>H2e</code>: &quot;Empirical&quot; phylogenetic heritability estimated
from the empirical variance of the observed phenotypes and sigmae
</p>
</li></ul>


<h3>Note</h3>

<p>This function is called sigmaOU and not simply sigma to avoid a conflict 
with a function sigma in the base R-package.
</p>


<h3>See Also</h3>

<p>OU
</p>


<h3>Examples</h3>

<pre><code class='language-R'># At POUMM stationary state (equilibrium, t=Inf)
H2 &lt;- H2(alpha = 0.75, sigma = 1, sigmae = 1, t = Inf)     # 0.4
alpha &lt;- alpha(H2 = H2, sigma = 1, sigmae = 1, t = Inf)    # 0.75
sigma &lt;- sigmaOU(H2 = H2, alpha = 0.75, sigmae = 1, t = Inf) # 1
sigmae &lt;- sigmae(H2 = H2, alpha = 0.75, sigma = 1, t = Inf) # 1

# At finite time t = 0.2
H2 &lt;- H2(alpha = 0.75, sigma = 1, sigmae = 1, t = 0.2)     # 0.1473309
alpha &lt;- alpha(H2 = H2, sigma = 1, sigmae = 1, t = 0.2)    # 0.75
sigma &lt;- sigmaOU(H2 = H2, alpha = 0.75, sigmae = 1, t = 0.2) # 1
sigmae &lt;- sigmae(H2  =  H2, alpha = 0.75, sigma = 1, t = 0.2) # 1

   
</code></pre>

<hr>
<h2 id='plot.POUMM'>Plots of a POUMM-fit</h2><span id='topic+plot.POUMM'></span>

<h3>Description</h3>

<p>Plots of a POUMM-fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POUMM'
plot(
  x,
  type = c("MCMC"),
  doPlot = TRUE,
  interactive = TRUE,
  stat = c("alpha", "theta", "sigma", "sigmae", "g0", "H2tMean"),
  chain = NULL,
  startMCMC = NA,
  endMCMC = NA,
  thinMCMC = 1000,
  statFunctions = statistics(x),
  doZoomIn = FALSE,
  zoomInFilter = paste0("(stat %in% c('H2e','H2tMean','H2tInf','H2tMax') &amp; ",
    "(value &gt;= 0 &amp; value &lt;= 1) ) |",
    "( !stat %in% c('H2e','H2tMean','H2tInf','H2tMax') &amp; ",
    "(value &lt;= median(HPDUpper) + 4 * (median(HPDUpper) - median(HPDLower)) &amp;",
    "value &gt;= median(HPDLower) - 4 * (median(HPDUpper) - median(HPDLower))))"),
  prettyNames = TRUE,
  showUnivarDensityOnDiag = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.POUMM_+3A_x">x</code></td>
<td>
<p>An object of class POUMM.</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_type">type</code></td>
<td>
<p>A character indicating the type of plot(s) to be generated.
Defaults to &quot;MCMC&quot;, resulting in a trace and density plot for the selected
statistics (see argument stat).</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_doplot">doPlot</code></td>
<td>
<p>Logical indicating whether a plot should be printed on the 
currently active graphics device or whether to return a list of ggplot 
objects for further processing. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_interactive">interactive</code></td>
<td>
<p>Logical indicating whether the user should press a key 
before generating a next plot (when needed to display two or more plots).
Defaults to TRUE. Meaningless if 
doPlot = FALSE.</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_stat">stat</code></td>
<td>
<p>A character vector with the names of statistics to be plotted.
These should be names from the stats-list (see argument statFunctions).
Defaults to c(&quot;alpha&quot;, &quot;theta&quot;, &quot;sigma&quot;, &quot;sigmae&quot;, &quot;H2tMean&quot;, &quot;H2tInf&quot;).</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_chain">chain</code></td>
<td>
<p>A vector of integers indicating the chains to be plotted.</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_startmcmc">startMCMC</code>, <code id="plot.POUMM_+3A_endmcmc">endMCMC</code>, <code id="plot.POUMM_+3A_thinmcmc">thinMCMC</code></td>
<td>
<p>Integers used to extract a sample from the 
MCMC-chain; passed to summary().</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_statfunctions">statFunctions</code></td>
<td>
<p>Named list of statistics functions; passed to summary().</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_dozoomin">doZoomIn</code></td>
<td>
<p>(type MCMC only) A logical value indicating whether the 
produced plots should have a limitation on the x-axis according to an 
expression set in zoomInFilter (see below). Default value is FALSE.</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_zoominfilter">zoomInFilter</code></td>
<td>
<p>A character string which evaluates as logical value. If 
doZoomIn is set to TRUE, this filter is applied to each point in each MCMC
chain and the data-point is filtered out if it evaluates to FALSE. This 
allows to zoomIn the x-axis of density plots but should be used with caution,
since filtering out points from the MCMC-sample can affect the kernel densities.
Unfortunately, filtering out values is currently the only way to affect the
limits of individual facets in ggplot2. The default value is a complicated 
expression involving the HPD from all MCMC chains (normally one chain from the
prior and 2 chains from the posterior):
zoomInFilter = paste0(&quot;(stat 
&quot;(value &gt;= 0 &amp; value &lt;= 1) ) |&quot;,
&quot;( !stat 
&quot;(value &lt;= median(HPDUpper) + 4 * (median(HPDUpper) - median(HPDLower)) &amp;&quot;,
&quot;value &gt;= median(HPDLower) - 4 * (median(HPDUpper) - median(HPDLower))))&quot;).
The identifiers in this expression can be any
column names found in a summary of a POUMM object.</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_prettynames">prettyNames</code></td>
<td>
<p>A logical indicating if greek letters and sub/superscripts 
should be used for the names of columns in the posterior density pairs-plot.</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_showunivardensityondiag">showUnivarDensityOnDiag</code></td>
<td>
<p>A logical indicating if univariate density 
plots should be displaied on the main diagonal in the bivariate posterior plot.
Defaults to FALSE, in which case the column names are displayed on the diagonal.</p>
</td></tr>
<tr><td><code id="plot.POUMM_+3A_...">...</code></td>
<td>
<p>not used, needed for consistency with the generic plot-function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If doPlot==FALSE, a named list containing a member called data of
class data.table and several members of class ggplot.
</p>

<hr>
<h2 id='plot.summary.POUMM'>Plot a summary of a POUMM fit</h2><span id='topic+plot.summary.POUMM'></span>

<h3>Description</h3>

<p>Plot a summary of a POUMM fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.POUMM'
plot(
  x,
  type = c("MCMC"),
  doPlot = TRUE,
  stat = c("alpha", "theta", "sigma", "sigmae", "g0", "H2tMean"),
  chain = NULL,
  doZoomIn = FALSE,
  zoomInFilter = paste0("(stat %in% c('H2e','H2tMean','H2tInf','H2tMax') &amp; ",
    "(value &gt;= 0 &amp; value &lt;= 1) ) |",
    "( !stat %in% c('H2e','H2tMean','H2tInf','H2tMax') &amp; ",
    "(value &lt;= median(HPDUpper) + 4 * (median(HPDUpper) - median(HPDLower)) &amp;",
    "value &gt;= median(HPDLower) - 4 * (median(HPDUpper) - median(HPDLower))))"),
  palette = c("#999999", "#0072B2", "#CC79A7", "#E69F00", "#D55E00", "#56B4E9",
    "#009E73", "#F0E442"),
  prettyNames = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.summary.POUMM_+3A_x">x</code></td>
<td>
<p>An object of class POUMM.</p>
</td></tr>
<tr><td><code id="plot.summary.POUMM_+3A_type">type</code></td>
<td>
<p>A character indicating the type of plot(s) to be generated.
Defaults to &quot;MCMC&quot;, resulting in a trace and density plot for the selected
statistics (see argument stat). Currently, only 'MCMC' type is supported.</p>
</td></tr>
<tr><td><code id="plot.summary.POUMM_+3A_doplot">doPlot</code></td>
<td>
<p>Logical indicating whether a plot should be printed on the 
currently active graphics device or whether only to return a list of plot- 
objects for further processing. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="plot.summary.POUMM_+3A_stat">stat</code></td>
<td>
<p>A character vector with the names of statistics to be plotted.
These should be names from the stats-list (see argument statFunctions).
Defaults to c(&quot;alpha&quot;, &quot;theta&quot;, &quot;sigma&quot;, &quot;sigmae&quot;, &quot;H2tMean&quot;, &quot;H2tInf&quot;).</p>
</td></tr>
<tr><td><code id="plot.summary.POUMM_+3A_chain">chain</code></td>
<td>
<p>A vector of integers indicating the chains to be plotted.</p>
</td></tr>
<tr><td><code id="plot.summary.POUMM_+3A_dozoomin">doZoomIn</code></td>
<td>
<p>(type MCMC only) A logical value indicating whether the 
produced plots should have a limitation on the x-axis according to an 
expression set in zoomInFilter (see below). Default value is FALSE.</p>
</td></tr>
<tr><td><code id="plot.summary.POUMM_+3A_zoominfilter">zoomInFilter</code></td>
<td>
<p>A character string which evaluates as logical value. If 
doZoomIn is set to TRUE, this filter is applied to each point in each MCMC
chain and the data-point is filtered out if it evaluates to FALSE. This 
allows to zoomIn the x-axis of density plots but should be used with caution,
since filtering out points from the MCMC-sample can affect the kernel densities.
Unfortunately, filtering out values is currently the only way to affect the
limits of individual facets in ggplot2. The default value is a complicated 
expression involving the HPD from all MCMC chains (normally one chain from the
prior and 2 chains from the posterior):
zoomInFilter = paste0(&quot;stat 
The identifiers in this expression can be any
column names found in a summary of a POUMM object.</p>
</td></tr>
<tr><td><code id="plot.summary.POUMM_+3A_palette">palette</code></td>
<td>
<p>A vector of colors (can be character strings) corresponding to the 
different chains (in their order 1 (prior), 2, 3). Defaults to c(&quot;#999999&quot;, 
&quot;#0072B2&quot;, &quot;#CC79A7&quot;, &quot;#E69F00&quot;, &quot;#D55E00&quot;, &quot;#56B4E9&quot;, &quot;#009E73&quot;, &quot;#F0E442&quot;),
which is a color-blind friendly.</p>
</td></tr>
<tr><td><code id="plot.summary.POUMM_+3A_prettynames">prettyNames</code></td>
<td>
<p>A logical indicating if greek letters and sub/superscripts 
should be used for the names of columns in the posterior density pairs-plot.</p>
</td></tr>
<tr><td><code id="plot.summary.POUMM_+3A_...">...</code></td>
<td>
<p>Not used; included for compatibility with the generic function plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If doPlot==TRUE, the function returns nothing and produces output on 
the current graphics device as a side-effect. Otherwise, the function returns
a list of plot-objects: traceplot and densplot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(POUMM)

set.seed(1)

N &lt;- 1000

# create a random non-ultrametric tree of N tips
tree &lt;- ape::rtree(N)  

# Simulate the evolution of a trait along the tree
z &lt;- rVNodesGivenTreePOUMM(
  tree, g0 = 8, alpha = 1, theta = 4, sigma = 1.2, sigmae = .8)

fit &lt;- POUMM(z[1:N], tree, spec = list(nSamplesMCMC = 4e5))

# Summarize the results from the fit in a table:
summary(fit)

# Create plots for some of the inferred parameters/statistics:
pl &lt;- plot(fit, stat = c("alpha", "theta", "sigma", "sigmae", "H2tMean"), 
           doZoomIn = TRUE, 
           zoomInFilter = paste("!(stat %in% c('alpha', 'sigma', 'sigmae')) |",
                                "(value &gt;= 0 &amp; value &lt;= 8)"),
           doPlot = FALSE)

pl$traceplot
pl$densplot

## End(Not run)

</code></pre>

<hr>
<h2 id='POUMM'>The Phylogenetic (Ornstein-Uhlenbeck) Mixed Model</h2><span id='topic+POUMM'></span>

<h3>Description</h3>

<p>This is the high-level entry point to the POUMM method. The POUMM
function fits the POUMM method to a tree and observed trait-values at its tips
and returns an object of class &quot;POUMM&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POUMM(
  z,
  tree,
  se = 0,
  zName = "z",
  treeName = "tree",
  parDigits = 6,
  usempfr = 0,
  useCpp = TRUE,
  ...,
  spec = NULL,
  doMCMC = TRUE,
  likPOUMM_lowLevelFun = likPOUMMGivenTreeVTipsC,
  verbose = FALSE,
  debug = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="POUMM_+3A_z">z</code></td>
<td>
<p>Either a numeric vector containing the phenotypic values at the tips 
of tree or a named list containing named elements z - a numeric vector and 
tree - a phylo object (it is possible to specify different element names 
using the arguments zName and treeName).</p>
</td></tr>
<tr><td><code id="POUMM_+3A_tree">tree</code></td>
<td>
<p>A phylo object or NULL in case z is a list.</p>
</td></tr>
<tr><td><code id="POUMM_+3A_se">se</code></td>
<td>
<p>A non-negative numerical vector (or single number) indicating known 
measurement standard error (defaults to 0). Note the elements of this vector 
are assumed to describe the measurement error at individual nodes independent
of the environmental contribution (described by the parameter sigmae). The total
error standard deviation is thus sqrt(sigmae2+se^2).</p>
</td></tr>
<tr><td><code id="POUMM_+3A_zname">zName</code>, <code id="POUMM_+3A_treename">treeName</code></td>
<td>
<p>Character strings used when the parameter z is a list; 
indicate the names in the list of the values-vector and the tree. Default: 
'z' and 'tree'.</p>
</td></tr>
<tr><td><code id="POUMM_+3A_pardigits">parDigits</code></td>
<td>
<p>Integer specifying rounding to be done on the parameter 
vector before likelihood calculation. Defaults to 6 decimal digits. This can
be useful during maximum likelihood optimization to prevent likelihood 
calculation on very small but positive values of alpha, but should be used 
with caution since specifying a small number of digits, i.e. 2 or 3 can
result in an infinite loop during optim. Specify a negative number
to disable rounding.</p>
</td></tr>
<tr><td><code id="POUMM_+3A_usempfr">usempfr</code></td>
<td>
<p>integer indicating if and how mpfr should be used for small 
parameter values ('any(c(alpha, sigma, sigmae) &lt; 0.01)'). Using the mpfr 
package can be forced by specifying an integer greater or equal to 2. 
Setting usempfr=0 (default) causes high precision likelihood 
calculation to be done on each encounter of parameters with at least 1 bigger
log-likelihood value than any of the currently found
maximum log-likelihood or the previously calculated log-likelihood value
Requires the Rmpfr package. Note that using mpfr may increase the time for 
one likelihood calculation more than 100-fold. Set usempfr to -1 or less
to completely disable Rmpfr functionality.</p>
</td></tr>
<tr><td><code id="POUMM_+3A_usecpp">useCpp</code></td>
<td>
<p>Logical indicating whether C++ likelihood calculation should be 
used for faster vector operations. Defaults to TRUE. Since the C++ likelihood
implementation does not support mpfr, useCpp gets disabled when usempfr is 
bigger than 0.</p>
</td></tr>
<tr><td><code id="POUMM_+3A_...">...</code></td>
<td>
<p>additional arguments passed to the 'likPOUMMGivenTreeVTips()' function 
('?dVGivenTreeOU' for details).</p>
</td></tr>
<tr><td><code id="POUMM_+3A_spec">spec</code></td>
<td>
<p>A named list specifying how the ML and MCMC fit should be done. 
See '?specifyPOUMM'.</p>
</td></tr>
<tr><td><code id="POUMM_+3A_domcmc">doMCMC</code></td>
<td>
<p>Deprecated - replaced by specifying nSamplesMCMC as a member
of spec instead (see '?specifyPOUMM'). 
logical: should a MCMC fit be performed. An MCMC fit provides a 
sample from the posterior distribution of the parameters given a prior 
distribution and the data. Unlike the ML-fit, it allows to estimate 
confidence intervals for the estimated parameters. This argument is TRUE by 
default. The current implementation uses the adaptive 
Metropolis sampler from the package 'adaptMCMC' written by Andreas 
Scheidegger. To obtain meaningful estimates MCMC may need to run for several
millions of iterations (parameter nSamplesMCMC set to 1e5 by default). See 
parameters ending at MCMC in '?specifyPOUMM' for details.</p>
</td></tr>
<tr><td><code id="POUMM_+3A_likpoumm_lowlevelfun">likPOUMM_lowLevelFun</code></td>
<td>
<p>the low-level function used for POUMM - likelihood 
calculation. Default value is likPOUMMGivenTreeVTipsC.</p>
</td></tr>
<tr><td><code id="POUMM_+3A_verbose">verbose</code>, <code id="POUMM_+3A_debug">debug</code></td>
<td>
<p>Logical flags indicating whether to print informative 
and/or debug information on the standard output (both are set to to FALSE by
default).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of S3 class 'POUMM'. This object can be analyzed using 
S3 generic functions: <code><a href="base.html#topic+summary">summary</a></code>, 
<code><a href="base.html#topic+plot">plot</a></code>, <code><a href="stats.html#topic+AIC">AIC</a></code>, <code><a href="stats.html#topic+BIC">BIC</a></code>, <code><a href="stats.html#topic+coef">coef</a></code>,
<code><a href="stats.html#topic+logLik">logLik</a></code>, <code><a href="stats.html#topic+fitted">fitted</a></code>.
</p>


<h3>References</h3>

<p>Mitov, V., and Stadler, T. (2017). Fast and Robust Inference of Phylogenetic Ornstein-Uhlenbeck Models Using Parallel Likelihood Calculation. bioRxiv, 115089. 
https://doi.org/10.1101/115089
Mitov, V., &amp; Stadler, T. (2017). Fast Bayesian Inference of Phylogenetic Models Using Parallel Likelihood Calculation and Adaptive Metropolis Sampling. Systematic Biology, 235739. http://doi.org/10.1101/235739  
Vihola, M. (2012). Robust adaptive Metropolis algorithm with coerced 
acceptance rate. Statistics and Computing, 22(5), 997-1008. 
http://doi.org/10.1007/s11222-011-9269-5 
</p>
<p>Scheidegger, A. (2012). adaptMCMC: Implementation of a generic adaptive 
Monte Carlo Markov Chain sampler. 
http://CRAN.R-project.org/package=adaptMCMC
</p>


<h3>See Also</h3>

<p><code><a href="#topic+specifyPOUMM">specifyPOUMM</a></code> for parametrizations and custom settings
of the POUMM fit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Please, read the package vignette for more detailed examples.
N &lt;- 500
tr &lt;- ape::rtree(N)
z &lt;- rVNodesGivenTreePOUMM(tr, 0, 2, 3, 1, 1)[1:N]
fit &lt;- POUMM(z, tr, spec = specifyPOUMM(nSamplesMCMC = 5e4))
plot(fit)
summary(fit)
AIC(fit)
BIC(fit)
coef(fit)
logLik(fit)
fitted(fit)
plot(resid(fit))
abline(h=0)

# fit PMM to the same data and do a likelihood ratio test
fitPMM &lt;- POUMM(z, tr, spec = specifyPMM(nSamplesMCMC = 5e4))
lmtest::lrtest(fitPMM, fit)

## End(Not run)

</code></pre>

<hr>
<h2 id='POUMMIsADevRelease'>Check if the POUMM version correpsonds to a dev release</h2><span id='topic+POUMMIsADevRelease'></span>

<h3>Description</h3>

<p>We define a dev release as having a sub-release, eg 0.9.15.5 is
one whereas 0.9.16 is not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>POUMMIsADevRelease()
</code></pre>


<h3>Value</h3>

<p>a logical
</p>

<hr>
<h2 id='pruneTree'>Extract information for fast likelihood calculation using the
breadth-first pruning algorithm.</h2><span id='topic+pruneTree'></span>

<h3>Description</h3>

<p>Extract information for fast likelihood calculation using the
breadth-first pruning algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pruneTree(tree, z, se = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pruneTree_+3A_tree">tree</code></td>
<td>
<p>a phylo object</p>
</td></tr>
<tr><td><code id="pruneTree_+3A_z">z</code></td>
<td>
<p>Numeric vector with length(tree$tip.label) values 
corresponding to tree$tip.label.</p>
</td></tr>
<tr><td><code id="pruneTree_+3A_se">se</code></td>
<td>
<p>Non-negative numerical or N-vector indicating known
standard measurement error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of objects used for likelihood evaluation
</p>

<hr>
<h2 id='residuals.POUMM'>Extract maximum likelihood environmental contributions (residuals) at the tips of a tree, to which a POUMM model has been fitted.</h2><span id='topic+residuals.POUMM'></span>

<h3>Description</h3>

<p>Extract maximum likelihood environmental contributions (residuals) at the tips of a tree, to which a POUMM model has been fitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POUMM'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.POUMM_+3A_object">object</code></td>
<td>
<p>An object of class POUMM.</p>
</td></tr>
<tr><td><code id="residuals.POUMM_+3A_...">...</code></td>
<td>
<p>Not used; added for compatibility with generic function residuals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector of e-values (residuals) corresponding to the tip-labels in
the tree.
</p>

<hr>
<h2 id='rTrajectoryOU'>Generation of a random trajectory of an OU process starting from a given
initial state</h2><span id='topic+rTrajectoryOU'></span>

<h3>Description</h3>

<p>Generates a trajectory xt given initial state z0 according to an
Ornstein-Uhlenbeck process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rTrajectoryOU(z0, t, alpha, theta, sigma, steps = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rTrajectoryOU_+3A_z0">z0</code></td>
<td>
<p>Numeric value, initial state.</p>
</td></tr>
<tr><td><code id="rTrajectoryOU_+3A_t">t</code></td>
<td>
<p>Numeric value or vector of size steps, denoting the time-step(s).</p>
</td></tr>
<tr><td><code id="rTrajectoryOU_+3A_alpha">alpha</code>, <code id="rTrajectoryOU_+3A_theta">theta</code>, <code id="rTrajectoryOU_+3A_sigma">sigma</code></td>
<td>
<p>Numeric values, parameters of the OU process.</p>
</td></tr>
<tr><td><code id="rTrajectoryOU_+3A_steps">steps</code></td>
<td>
<p>Integer, number of steps.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of length steps containing the generated values
at times 0+t, 0+2t, ..., 0+steps*t.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>z0 &lt;- 0
nSteps &lt;- 100
t &lt;- 0.01
trajectory &lt;- rTrajectoryOU(z0, t, 2, 2, 1, steps = nSteps)
plot(trajectory, type = 'l')

</code></pre>

<hr>
<h2 id='rTrajectoryOUDef'>Generation of a random trajectory of an OU process starting from a given
initial state (only for test purpose)</h2><span id='topic+rTrajectoryOUDef'></span>

<h3>Description</h3>

<p>Generation of a random trajectory of an OU process starting from a given
initial state (only for test purpose)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rTrajectoryOUDef(z0, t, alpha, theta, sigma, steps = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rTrajectoryOUDef_+3A_z0">z0</code></td>
<td>
<p>Numeric value, initial state.</p>
</td></tr>
<tr><td><code id="rTrajectoryOUDef_+3A_t">t</code></td>
<td>
<p>Numeric value or vector of size steps, denoting the time-step(s).</p>
</td></tr>
<tr><td><code id="rTrajectoryOUDef_+3A_alpha">alpha</code></td>
<td>
<p>Numeric values, parameters of the OU process.</p>
</td></tr>
<tr><td><code id="rTrajectoryOUDef_+3A_theta">theta</code></td>
<td>
<p>Numeric values, parameters of the OU process.</p>
</td></tr>
<tr><td><code id="rTrajectoryOUDef_+3A_sigma">sigma</code></td>
<td>
<p>Numeric values, parameters of the OU process.</p>
</td></tr>
<tr><td><code id="rTrajectoryOUDef_+3A_steps">steps</code></td>
<td>
<p>Integer, number of steps.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used for test purpose only. This is an internal function and is
appropriate for small time-steps only.
</p>

<hr>
<h2 id='rVNodesGivenTreePOUMM'>Random generation of values along a phylogenetic tree following a branching
OU process</h2><span id='topic+rVNodesGivenTreePOUMM'></span>

<h3>Description</h3>

<p>Random generation of values along a phylogenetic tree following a branching
OU process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rVNodesGivenTreePOUMM(tree, z0, alpha, theta, sigma, sigmae = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rVNodesGivenTreePOUMM_+3A_tree">tree</code></td>
<td>
<p>An object of class phylo (package ape).</p>
</td></tr>
<tr><td><code id="rVNodesGivenTreePOUMM_+3A_z0">z0</code></td>
<td>
<p>Numeric value indicating the initial state at the root of the tree.</p>
</td></tr>
<tr><td><code id="rVNodesGivenTreePOUMM_+3A_alpha">alpha</code>, <code id="rVNodesGivenTreePOUMM_+3A_theta">theta</code>, <code id="rVNodesGivenTreePOUMM_+3A_sigma">sigma</code></td>
<td>
<p>Numeric values, parameters of the OU process.</p>
</td></tr>
<tr><td><code id="rVNodesGivenTreePOUMM_+3A_sigmae">sigmae</code></td>
<td>
<p>Numeric non-negative value (default 0). Specifies the standard
deviation of random environmental contribution and or measurement standard 
error to be added to the values (white noise). Note that if measurement standard
error, se, is known and needs to be added to the environmental contribution,
the right way to specify the parameter would be sqrt(sigmae^2+se^2).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector containing the generated values at all nodes
(internal and tips) of the phylogenetic tree.
</p>

<hr>
<h2 id='simulatePOUMMLikelihoodMainLoop'>Writes verbose messages of the order of tree traversal during likelihood calculation</h2><span id='topic+simulatePOUMMLikelihoodMainLoop'></span>

<h3>Description</h3>

<p>Writes verbose messages of the order of tree traversal during likelihood calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulatePOUMMLikelihoodMainLoop(tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulatePOUMMLikelihoodMainLoop_+3A_tree">tree</code></td>
<td>
<p>A phylo object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>

<hr>
<h2 id='simulateTrait'>Simulate a trait on a tree under a ML fit of the POUMM model</h2><span id='topic+simulateTrait'></span>

<h3>Description</h3>

<p>Use the maximum likelihood parameters of the model to simulate
trait values on a phylogenetic tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulateTrait(object, tree = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulateTrait_+3A_object">object</code></td>
<td>
<p>an S3 object of class POUMM</p>
</td></tr>
<tr><td><code id="simulateTrait_+3A_tree">tree</code></td>
<td>
<p>a phylo object. If NULL (default) the trait is simulated on the
tree, on which the POUMM object has been fit.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a shortcut to calling
<code><a href="#topic+rVNodesGivenTreePOUMM">rVNodesGivenTreePOUMM</a></code>, which will map the inferred parameters 
of the model back to the original POUMM parameters alpha, theta, sigma, sigmae,
and g0.
</p>


<h3>Value</h3>

<p>a numerical vector containing the simulated trait value for each tip 
in the tree.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rVNodesGivenTreePOUMM">rVNodesGivenTreePOUMM</a></code>
</p>

<hr>
<h2 id='specPOUMM'>Specifying a POUMM fit</h2><span id='topic+specPOUMM'></span><span id='topic+specifyPOUMM'></span><span id='topic+specifyPOUMM_ATS'></span><span id='topic+specifyPOUMM_ATSG0'></span><span id='topic+specifyPOUMM_ATSSeG0'></span><span id='topic+specifyPMM'></span><span id='topic+specifyPMM_SSeG0'></span><span id='topic+specifyPOUMM_ATH2tMeanSe'></span><span id='topic+specifyPOUMM_ATH2tMeanSeG0'></span><span id='topic+specifyPMM_H2tMeanSe'></span><span id='topic+specifyPMM_H2tMeanSeG0'></span>

<h3>Description</h3>

<p>Specification and validation of POUMM/PMM settings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specifyPOUMM(
  z = NULL,
  tree = NULL,
  zMin = -10,
  zMean = 0,
  zMax = 10,
  zVar = 4,
  zSD = sqrt(zVar),
  tMin = 0.1,
  tMean = 2,
  tMax = 10,
  parMapping = NULL,
  parLower = NULL,
  parUpper = NULL,
  g0Prior = NULL,
  parInitML = NULL,
  control = NULL,
  parPriorMCMC = NULL,
  parInitMCMC = NULL,
  parScaleMCMC = NULL,
  nSamplesMCMC = 1e+05,
  nAdaptMCMC = nSamplesMCMC,
  thinMCMC = 100,
  accRateMCMC = 0.01,
  gammaMCMC = 0.50001,
  nChainsMCMC = 3,
  samplePriorMCMC = TRUE,
  parallelMCMC = FALSE,
  validateSpec = TRUE
)

specifyPOUMM_ATS(
  z = NULL,
  tree = NULL,
  zMin = -10,
  zMean = 0,
  zMax = 10,
  zVar = 4,
  zSD = sqrt(zVar),
  tMin = 0.1,
  tMean = 2,
  tMax = 10,
  parMapping = NULL,
  parLower = NULL,
  parUpper = NULL,
  g0Prior = NULL,
  parInitML = NULL,
  control = NULL,
  parPriorMCMC = NULL,
  parInitMCMC = NULL,
  parScaleMCMC = NULL,
  nSamplesMCMC = 1e+05,
  nAdaptMCMC = nSamplesMCMC,
  thinMCMC = 100,
  accRateMCMC = 0.01,
  gammaMCMC = 0.50001,
  nChainsMCMC = 3,
  samplePriorMCMC = TRUE,
  parallelMCMC = FALSE,
  sigmaeFixed = 0
)

specifyPOUMM_ATSG0(
  z = NULL,
  tree = NULL,
  zMin = -10,
  zMean = 0,
  zMax = 10,
  zVar = 4,
  zSD = sqrt(zVar),
  tMin = 0.1,
  tMean = 2,
  tMax = 10,
  parMapping = NULL,
  parLower = NULL,
  parUpper = NULL,
  g0Prior = NULL,
  parInitML = NULL,
  control = NULL,
  parPriorMCMC = NULL,
  parInitMCMC = NULL,
  parScaleMCMC = NULL,
  nSamplesMCMC = 1e+05,
  nAdaptMCMC = nSamplesMCMC,
  thinMCMC = 100,
  accRateMCMC = 0.01,
  gammaMCMC = 0.50001,
  nChainsMCMC = 3,
  samplePriorMCMC = TRUE,
  parallelMCMC = FALSE,
  sigmaeFixed = 0
)

specifyPOUMM_ATSSeG0(
  z = NULL,
  tree = NULL,
  zMin = -10,
  zMean = 0,
  zMax = 10,
  zVar = 4,
  zSD = sqrt(zVar),
  tMin = 0.1,
  tMean = 2,
  tMax = 10,
  parMapping = NULL,
  parLower = NULL,
  parUpper = NULL,
  g0Prior = NULL,
  parInitML = NULL,
  control = NULL,
  parPriorMCMC = NULL,
  parInitMCMC = NULL,
  parScaleMCMC = NULL,
  nSamplesMCMC = 1e+05,
  nAdaptMCMC = nSamplesMCMC,
  thinMCMC = 100,
  accRateMCMC = 0.01,
  gammaMCMC = 0.50001,
  nChainsMCMC = 3,
  samplePriorMCMC = TRUE,
  parallelMCMC = FALSE
)

specifyPMM(
  z = NULL,
  tree = NULL,
  zMin = -10,
  zMean = 0,
  zMax = 10,
  zVar = 4,
  zSD = sqrt(zVar),
  tMin = 0.1,
  tMean = 2,
  tMax = 10,
  parMapping = NULL,
  parLower = NULL,
  parUpper = NULL,
  g0Prior = NULL,
  parInitML = NULL,
  control = NULL,
  parPriorMCMC = NULL,
  parInitMCMC = NULL,
  parScaleMCMC = NULL,
  nSamplesMCMC = 1e+05,
  nAdaptMCMC = nSamplesMCMC,
  thinMCMC = 100,
  accRateMCMC = 0.01,
  gammaMCMC = 0.50001,
  nChainsMCMC = 3,
  samplePriorMCMC = TRUE,
  parallelMCMC = FALSE
)

specifyPMM_SSeG0(
  z = NULL,
  tree = NULL,
  zMin = -10,
  zMean = 0,
  zMax = 10,
  zVar = 4,
  zSD = sqrt(zVar),
  tMin = 0.1,
  tMean = 2,
  tMax = 10,
  parMapping = NULL,
  parLower = NULL,
  parUpper = NULL,
  g0Prior = NULL,
  parInitML = NULL,
  control = NULL,
  parPriorMCMC = NULL,
  parInitMCMC = NULL,
  parScaleMCMC = NULL,
  nSamplesMCMC = 1e+05,
  nAdaptMCMC = nSamplesMCMC,
  thinMCMC = 100,
  accRateMCMC = 0.01,
  gammaMCMC = 0.50001,
  nChainsMCMC = 3,
  samplePriorMCMC = TRUE,
  parallelMCMC = FALSE
)

specifyPOUMM_ATH2tMeanSe(
  z = NULL,
  tree = NULL,
  zMin = -10,
  zMean = 0,
  zMax = 10,
  zVar = 4,
  zSD = sqrt(zVar),
  tMin = 0.1,
  tMean = 2,
  tMax = 10,
  parMapping = NULL,
  parLower = NULL,
  parUpper = NULL,
  g0Prior = NULL,
  parInitML = NULL,
  control = NULL,
  parPriorMCMC = NULL,
  parInitMCMC = NULL,
  parScaleMCMC = NULL,
  nSamplesMCMC = 1e+05,
  nAdaptMCMC = nSamplesMCMC,
  thinMCMC = 100,
  accRateMCMC = 0.01,
  gammaMCMC = 0.50001,
  nChainsMCMC = 3,
  samplePriorMCMC = TRUE,
  parallelMCMC = FALSE
)

specifyPOUMM_ATH2tMeanSeG0(
  z = NULL,
  tree = NULL,
  zMin = -10,
  zMean = 0,
  zMax = 10,
  zVar = 4,
  zSD = sqrt(zVar),
  tMin = 0.1,
  tMean = 2,
  tMax = 10,
  parMapping = NULL,
  parLower = NULL,
  parUpper = NULL,
  g0Prior = NULL,
  parInitML = NULL,
  control = NULL,
  parPriorMCMC = NULL,
  parInitMCMC = NULL,
  parScaleMCMC = NULL,
  nSamplesMCMC = 1e+05,
  nAdaptMCMC = nSamplesMCMC,
  thinMCMC = 100,
  accRateMCMC = 0.01,
  gammaMCMC = 0.50001,
  nChainsMCMC = 3,
  samplePriorMCMC = TRUE,
  parallelMCMC = FALSE
)

specifyPMM_H2tMeanSe(
  z = NULL,
  tree = NULL,
  zMin = -10,
  zMean = 0,
  zMax = 10,
  zVar = 4,
  zSD = sqrt(zVar),
  tMin = 0.1,
  tMean = 2,
  tMax = 10,
  parMapping = NULL,
  parLower = NULL,
  parUpper = NULL,
  g0Prior = NULL,
  parInitML = NULL,
  control = NULL,
  parPriorMCMC = NULL,
  parInitMCMC = NULL,
  parScaleMCMC = NULL,
  nSamplesMCMC = 1e+05,
  nAdaptMCMC = nSamplesMCMC,
  thinMCMC = 100,
  accRateMCMC = 0.01,
  gammaMCMC = 0.50001,
  nChainsMCMC = 3,
  samplePriorMCMC = TRUE,
  parallelMCMC = FALSE
)

specifyPMM_H2tMeanSeG0(
  z = NULL,
  tree = NULL,
  zMin = -10,
  zMean = 0,
  zMax = 10,
  zVar = 4,
  zSD = sqrt(zVar),
  tMin = 0.1,
  tMean = 2,
  tMax = 10,
  parMapping = NULL,
  parLower = NULL,
  parUpper = NULL,
  g0Prior = NULL,
  parInitML = NULL,
  control = NULL,
  parPriorMCMC = NULL,
  parInitMCMC = NULL,
  parScaleMCMC = NULL,
  nSamplesMCMC = 1e+05,
  nAdaptMCMC = nSamplesMCMC,
  thinMCMC = 100,
  accRateMCMC = 0.01,
  gammaMCMC = 0.50001,
  nChainsMCMC = 3,
  samplePriorMCMC = TRUE,
  parallelMCMC = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="specPOUMM_+3A_z">z</code>, <code id="specPOUMM_+3A_tree">tree</code></td>
<td>
<p>a numeric vector and a phylo object on which the fit is to be done. 
These arguments are used in order to guess meaningful values for the parLower,
parUpper and parPriorMCMC arguments. See also, zMin,zMean,...,tMax below.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_zmin">zMin</code>, <code id="specPOUMM_+3A_zmean">zMean</code>, <code id="specPOUMM_+3A_zmax">zMax</code>, <code id="specPOUMM_+3A_zvar">zVar</code>, <code id="specPOUMM_+3A_zsd">zSD</code>, <code id="specPOUMM_+3A_tmin">tMin</code>, <code id="specPOUMM_+3A_tmean">tMean</code>, <code id="specPOUMM_+3A_tmax">tMax</code></td>
<td>
<p>summary statistics of the
observed tip-values (z) and root-tip distances (t). Some of these values
are used for constructing default parameter values and limits; These 
arguments are given default values which will most likely be meaningless
in your specific use-case. The default values will be overwritten with the
corresponding statistics from the z and tree arguments if these were specified.
If none of tree and z, nor these parameters are specified, then the
arguments parLower, parUpper, parPriorMCMC must be specified explicitly.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_parmapping">parMapping</code></td>
<td>
<p>An R-function that can handle, both, a numeric vector 
or a numeric matrix as argument. This function should transform the input 
vector or each row-vector (if the input is matrix) into a (row-)vector of 
the POUMM parameters alpha, theta, sigma, sigmae, g0. For a vector input 
the function should return a vector with named elements alpha, theta, 
sigma, sigmae, g0. For a matrix input the function should return a matrix 
with the same number of rows and columns alpha, theta, sigma, sigmae, g0. 
Only finite non-negative values are allowed for alpha, sigma, and sigmae. 
Returning Inf, -Inf, NA or NaN for any of these parameters will result in 
an error during likelihood calculation. Only finite numerical values are 
allowed for theta. The parameter
g0 is treated in a special way and can assume either a finite numerical 
value or one of NA or NaN. If g0 = finite value, this value is used
together
with the corresponding values of alpha, theta, sigma, and sigmae for 
likelihood calcuation. If g0 = NA (meaing value Not Avaiable), the value of
g0 is calculated analytically during likelihood calculation in order to 
maximise one of the following: <br />
</p>

<ol>
<li><p> if a normal prior for g0 was specified (see g0Prior), 
<code class="reqn">pdf(z | \alpha, \theta, \sigma, \sigma_e, g0, tree) x prior(g0)</code>. 
</p>
</li>
<li><p> otherwise, <code class="reqn">pdf(z | \alpha, \theta, \sigma, \sigma_e, g0, tree)</code>. 
</p>
</li></ol>

<p>If g0 = NaN (meaning Not a Number), then the likelihood is marginalized w.r.t. 
the g0's prior distribution (see g0Prior), i.e. the likelihood returned is:
<code class="reqn">pdf(z | \alpha, \theta, \sigma, \sigma_e, tree) = Integral(pdf(z|\alpha,\theta,\sigma,\sigma_e,g0) x pdf(g0) d g0; g0 from -\infty to +\infty) </code>
In this case (g0=NaN), if g0Prior is not specified, 
it is assumed that g0Prior is the stationary OU normal distribution with 
mean, theta, and variance, varOU(Inf, alpha, sigma). <br />
Examples: <br />
</p>
<pre> 
 # Default for POUMM: identity for alpha, theta, sigma, sigmae, NA for g0.
 parMapping = function(par) {
   if(is.matrix(par)) {
     atsseg0 &lt;- cbind(par[, 1:4, drop = FALSE], NA) 
     colnames(atsseg0) &lt;- c("alpha", "theta", "sigma", "sigmae", "g0")
   } else {
     atsseg0 &lt;- c(par[1:4], NA) 
     names(atsseg0) &lt;- c("alpha", "theta", "sigma", "sigmae", "g0")
   }
   atsseg0
 }
</pre></td></tr>
<tr><td><code id="specPOUMM_+3A_parlower">parLower</code>, <code id="specPOUMM_+3A_parupper">parUpper</code></td>
<td>
<p>two named numeric vectors of the same length
indicating the boundaries of the search region for the ML-fit. Calling
parMapping on parLower and parUpper should result in appropriate values of
the POUMM parameters alpha, theta, sigma sigmae and g0. By default, the
upper limit for alpha is set to 69.31 / tMean, which corresponds to a value
of alpha so big that the time for half-way convergence towards theta from
any initial trait value is 100 times shorter than the mean root-tip distance
in the tree. Examples: <br />
</p>
<pre>
# Default for POUMM:
parLower = c(alpha = 0, theta = zMin - 2 * (zMax - zMin), sigma = 0, sigmae = 0)
parUpper = c(alpha = 69.31 / tMean, theta = zMax + 2 * (zMax - zMin), 
             sigma = sigmaOU(H2 = .99, alpha = 69.31 / tMean, sigmae = 2 * zSD,
                                    t = tMean), 
             sigmae = 2 * zSD)
</pre></td></tr>
<tr><td><code id="specPOUMM_+3A_g0prior">g0Prior</code></td>
<td>
<p>Either NULL or a list with named numeric or character 
members &quot;mean&quot; and &quot;var&quot;. Specifies a prior normal distribution for the
parameter g0. If characters, the members &quot;mean&quot; and &quot;var&quot; are evaluated as
R-expressions - useful if these are functions of some of other parameters.
Note that if g0Prior is not NULL and g0 is not NaN (either a fixed number
or NA), then the likelihood maximization takes into account the prior for 
g0, that is, the optimization is done over the product 
p(g0) x lik(data|g0, other parameters and tree). This can be helpful to 
prevent extremely big or low estimates of g0. To avoid this behavior and
always maximize the likelihood, use g0Prior = NULL.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_parinitml">parInitML</code></td>
<td>
<p>A named vector (like parLower and parUpper) or a list of such
vectors - starting points for optim.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_control">control</code></td>
<td>
<p>List of parameters passed on to optim in the ML-fit, default 
list(factr=1e9), see ?optim.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_parpriormcmc">parPriorMCMC</code></td>
<td>
<p>A function of a numeric parameter-vector returning the 
log-prior for this parameter vector. Example: <br />
</p>
<pre>
# Default for POUMM:
 parPriorMCMC = function(par) {
   dexp(par[1], rate = tMean / 6.931, TRUE) + 
     dnorm(par[2], zMean, 10 * zSD, TRUE) +
     dexp(par[3],  rate = sqrt(tMean / (zVar * 0.6931)), TRUE) + 
     dexp(par[4], rate = 2 / zSD, TRUE)
 }
</pre></td></tr>
<tr><td><code id="specPOUMM_+3A_parinitmcmc">parInitMCMC</code></td>
<td>
<p>a function(chainNo, fitML) returning an initial state of
an MCMC as a vector. The argument fitML can be used to specify an initial 
state, close to a previously found likelihood optimum. Example: <br />
</p>
<pre> 
 # Default for POUMM:
 parInitMCMC = function(chainNo, fitML) {
   if(!is.null(fitML)) {
     parML &lt;- fitML$par
   } else {
     parML &lt;- NULL
   }
   
   init &lt;- rbind(
     c(alpha = 0, theta = 0, sigma = 1, sigmae = 0),
     parML,
     c(alpha = 0, theta = 0, sigma = 1, sigmae = 1)
   )
   
   init[(chainNo - 1) %% nrow(init) + 1, ]
 }
</pre></td></tr>
<tr><td><code id="specPOUMM_+3A_parscalemcmc">parScaleMCMC</code></td>
<td>
<p>Numeric matrix indicating the initial jump-distribution 
matrix for the MCMC fit. Default for POUMM is diag(4);</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_nsamplesmcmc">nSamplesMCMC</code></td>
<td>
<p>Integer indicating the length of each MCMC chain. 
Defaults to 1e5.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_nadaptmcmc">nAdaptMCMC</code></td>
<td>
<p>Logical indicating whether adaptation of the MCMC jump 
distribution should be done with respect to the target acceptance rate 
(accRateMCMC) or integer indicating how many initial MCMC iterations should 
be used for adaptation of the jump-distribution matrix (see details in 
?POUMM). Defaults to nSamplesMCMC meaning continuous adaptation throughout
the MCMC.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_thinmcmc">thinMCMC</code></td>
<td>
<p>Integer indicating the thinning interval of the mcmc-chains. 
Defaults to 100.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_accratemcmc">accRateMCMC</code></td>
<td>
<p>numeric between 0 and 1 indicating the target 
acceptance rate of the  adaptive Metropolis sampling (see details in ?POUMM). 
Default 0.01.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_gammamcmc">gammaMCMC</code></td>
<td>
<p>controls the speed of adaption. Should be in the interval (0.5,1]. A lower gamma leads to faster adaption. Default value is 0.50001.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_nchainsmcmc">nChainsMCMC</code></td>
<td>
<p>integer indicating the number of chains to run. 
Defaults to 3 chains, from which the first one is a sample from the prior 
distribution (see samplePriorMCMC).</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_samplepriormcmc">samplePriorMCMC</code></td>
<td>
<p>Logical indicating if sampling from the prior 
should be done for the first chain (see nChainsMCMC). This is useful to 
compare mcmc's for an overlap between prior and posterior distributions. 
Default is TRUE.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_parallelmcmc">parallelMCMC</code></td>
<td>
<p>Logical indicating whether the MCMC chains should be run 
in parallel. Setting this option to TRUE results in using 
<code>foreach::foreach() %dopar% { }</code> construct for the MCMC fit. In order for
parallel execution to be done, you should create a computing cluster and
register it as parallel back-end (see example in package vignette and the 
web-page https://github.com/tobigithub/R-parallel/wiki/R-parallel-Setups).</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_validatespec">validateSpec</code></td>
<td>
<p>Logical indicating whether the passed parameters should 
be validated. This parameter is used internally and should always be TRUE.</p>
</td></tr>
<tr><td><code id="specPOUMM_+3A_sigmaefixed">sigmaeFixed</code></td>
<td>
<p>fixed value for the sigmae parameter (used in 
specifyPOUMM_ATS and specifyPOUMM_ATSG0).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list to be passed as a spec argument to POUMM.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>specifyPOUMM</code>: Specify parameters for fitting a POUMM model. 
Parameter vector is c(alpha, theta, sigma, sigmae). Default model settings.
</p>
</li>
<li> <p><code>specifyPOUMM_ATS</code>: Fitting a POU model with fixed sigmae.
Parameter vector is c(alpha, theta, sigma).
</p>
</li>
<li> <p><code>specifyPOUMM_ATSG0</code>: Fitting a POU model with fixed sigmae.
Parameter vector is c(alpha, theta, sigma, g0).
</p>
</li>
<li> <p><code>specifyPOUMM_ATSSeG0</code>: Fitting a POUMM model with sampling of g0.
Parameter vector is c(alpha, theta, sigma, sigmae, g0).
</p>
</li>
<li> <p><code>specifyPMM</code>: Specify parameter for fitting a PMM model. 
Parameter vector is c(sigma, sigmae)
</p>
</li>
<li> <p><code>specifyPMM_SSeG0</code>: Specify parameter for fitting a PMM model with
sampling of g0. Parameter vector is c(sigma, sigmae, g0).
</p>
</li>
<li> <p><code>specifyPOUMM_ATH2tMeanSe</code>: Fitting a POUMM model with a uniform prior for
the phylogenetic heritability at mean root-tip distance. Parameter vector is
c(alpha, theta, H2tMean, sigmae).
</p>
</li>
<li> <p><code>specifyPOUMM_ATH2tMeanSeG0</code>: Fitting a POUMM model with a uniform prior for
the phylogenetic heritability at mean root-tip with sampling of g0.
Parameter vector is c(alpha, theta, H2tMean, sigmae, g0).
</p>
</li>
<li> <p><code>specifyPMM_H2tMeanSe</code>: Fitting a PMM model with a uniform prior for
the phylogenetic heritability at mean root-tip distance. Parameter vector is
c(H2tMean, sigmae).
</p>
</li>
<li> <p><code>specifyPMM_H2tMeanSeG0</code>: Fitting a PMM model with a uniform prior for
the phylogenetic heritability at mean root-tip distance with sampling of G0.
Parameter vector is c(H2tMean, sigmae, g0).
</p>
</li></ul>

<hr>
<h2 id='statistics'>Extract statistics from sampled or inferred parameters of a 
POUMM fit</h2><span id='topic+statistics'></span><span id='topic+statistics.POUMM'></span>

<h3>Description</h3>

<p>Extract statistics from sampled or inferred parameters of a 
POUMM fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>statistics(object)

## S3 method for class 'POUMM'
statistics(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="statistics_+3A_object">object</code></td>
<td>
<p>An object of class &quot;POUMM&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic method.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>POUMM</code>: Relevant statistics from the sampled parameters of a
POUMM fit
</p>
</li></ul>

<hr>
<h2 id='summary.POUMM'>Summarize the results of a POUMM-fit</h2><span id='topic+summary.POUMM'></span>

<h3>Description</h3>

<p>Summarize the results of a POUMM-fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'POUMM'
summary(
  object,
  ...,
  startMCMC = NA,
  endMCMC = NA,
  thinMCMC = 1000,
  stats = statistics(object),
  mode = c("short", "long", "expert")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.POUMM_+3A_object">object</code></td>
<td>
<p>a POUMM object returned by POUMM-function (see ?POUMM).</p>
</td></tr>
<tr><td><code id="summary.POUMM_+3A_...">...</code></td>
<td>
<p>Not used, but declared for consistency with the generic method summary.</p>
</td></tr>
<tr><td><code id="summary.POUMM_+3A_startmcmc">startMCMC</code>, <code id="summary.POUMM_+3A_endmcmc">endMCMC</code></td>
<td>
<p>integers indicating the range of the MCMC chains
to be used for the analysis (excluding the initial warm-up phase)</p>
</td></tr>
<tr><td><code id="summary.POUMM_+3A_thinmcmc">thinMCMC</code></td>
<td>
<p>thinning interval of the MCMC chain to avoid strong 
autocorrelation between sampled elements;</p>
</td></tr>
<tr><td><code id="summary.POUMM_+3A_stats">stats</code></td>
<td>
<p>a named list of functions of the form function(par)  number ,
which are called for each sample of each mcmc chain in object. Defaults to 
a call of statistics(object) returning a list of statistics functions relevant for 
the object. See also statistics.</p>
</td></tr>
<tr><td><code id="summary.POUMM_+3A_mode">mode</code></td>
<td>
<p>a character indicating the desired format of the returned summary 
as follows:
'short' - a data.table with the ML and MCMC estimates of heritability, 
model parameters, root-value and other statistics. 
'long' - same information as in 'short' but including also the samples, which
can be convenient for</p>
</td></tr>
</table>

<hr>
<h2 id='validateSpecPOUMM'>Validate a POUMM specification</h2><span id='topic+validateSpecPOUMM'></span>

<h3>Description</h3>

<p>Validate a POUMM specification
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validateSpecPOUMM(spec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validateSpecPOUMM_+3A_spec">spec</code></td>
<td>
<p>A list object returned by one of the specifyPOUMM or specifyPMM
functions with possibly modified entries afterwards.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function either returns TRUE or exits with an error message if it
finds a problem with the specificaiton.
</p>

<hr>
<h2 id='validateZTree'>Validate phenotypic values and phylogenetic tree</h2><span id='topic+validateZTree'></span>

<h3>Description</h3>

<p>Validate phenotypic values and phylogenetic tree
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validateZTree(z, tree)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validateZTree_+3A_z">z</code></td>
<td>
<p>trait (phenotypic) values at the tips of the tree</p>
</td></tr>
<tr><td><code id="validateZTree_+3A_tree">tree</code></td>
<td>
<p>A phylo object with the same number of tips as the length of z.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function either returns TRUE or exits with an error message if it
finds a problem with the specificaiton.
</p>

<hr>
<h2 id='vignetteCachedResults'>Cached objects for the POUMM vignettes and examples</h2><span id='topic+vignetteCachedResults'></span>

<h3>Description</h3>

<p>A list containing a simulated tree, trait-values and POUMM objects (model 
fits). To use these objects in examples you can load them into the global 
workspace with the command: 
'data(vignetteCachedResults); list2env(vignetteCachedResults, globalenv());'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vignetteCachedResults
</code></pre>


<h3>Format</h3>

<p>This is a list containing the following named elements:
</p>

<dl>
<dt>g, z, e </dt><dd><p> numeric vectors of simulated genotypic values, phenotypic values and measurement errors. </p>
</dd>
<dt>tree </dt><dd><p> a simulated phylogenetic tree. </p>
</dd>
<dt>fitPOUMM, fitPOUMM2, fitH2tMean </dt><dd><p> POUMM fit objects to tree and z. </p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
