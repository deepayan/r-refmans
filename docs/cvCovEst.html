<!DOCTYPE html><html lang="en-US"><head><title>Help for package cvCovEst</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cvCovEst}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adaptiveLassoEst'><p>Adaptive LASSO Estimator</p></a></li>
<li><a href='#adaptiveLassoThreshold'><p>Adaptive LASSO Thresholding Function</p></a></li>
<li><a href='#bandingEst'><p>Banding Estimator</p></a></li>
<li><a href='#bestInClass'><p>Showing Best Estimator Within Each Class of Estimators</p></a></li>
<li><a href='#checkArgs'><p>Check Arguments Passed to cvCovEst</p></a></li>
<li><a href='#checkPlotSumArgs'><p>Check Arguments Passed to plot.cvCovEst and summary.cvCovEst</p></a></li>
<li><a href='#computeC'><p>Estimate C of Spiked Covariance Matrix Estimator</p></a></li>
<li><a href='#computeEll'><p>Estimate Ell of Spiked Covariance Matrix Estimator</p></a></li>
<li><a href='#computeS'><p>Estimate S of Spiked Covariance Matrix Estimator</p></a></li>
<li><a href='#cvCovEst'><p>Cross-Validated Covariance Matrix Estimator Selector</p></a></li>
<li><a href='#cvEigenPlot'><p>Eigenvalue Plot</p></a></li>
<li><a href='#cvFrobeniusLoss'><p>Cross-Validation Function for Aggregated Frobenius Loss</p></a></li>
<li><a href='#cvMatrixFrobeniusLoss'><p>Cross-Validation Function for Matrix Frobenius Loss</p></a></li>
<li><a href='#cvMatrixMetrics'><p>Matrix Metrics for cvCovEst Object</p></a></li>
<li><a href='#cvMultiMelt'><p>Multiple Heat Map Plot</p></a></li>
<li><a href='#cvRiskByClass'><p>Summary Statistics of Cross-Validated Risk by Estimator Class</p></a></li>
<li><a href='#cvRiskPlot'><p>Cross-Validated Risk Plot</p></a></li>
<li><a href='#cvScaledMatrixFrobeniusLoss'><p>Cross-Validation Function for Scaled Matrix Frobenius Loss</p></a></li>
<li><a href='#cvSummaryPlot'><p>Summary Plot</p></a></li>
<li><a href='#denseLinearShrinkEst'><p>Linear Shrinkage Estimator, Dense Target</p></a></li>
<li><a href='#estAttributes'><p>Estimator Attributes Function</p></a></li>
<li><a href='#estimateNoise'><p>Estimate Noise in Spiked Covariance Matrix Model</p></a></li>
<li><a href='#getHypers'><p>Hyperparameter Retrieval Function</p></a></li>
<li><a href='#hyperRisk'><p>Summarize Cross-Validated Risks by Class with Hyperparameter</p></a></li>
<li><a href='#is.cvCovEst'><p>Check for cvCovEst Class</p></a></li>
<li><a href='#linearShrinkEst'><p>Linear Shrinkage Estimator</p></a></li>
<li><a href='#linearShrinkLWEst'><p>Ledoit-Wolf Linear Shrinkage Estimator</p></a></li>
<li><a href='#matrixMetrics'><p>General Matrix Metrics</p></a></li>
<li><a href='#multiHyperRisk'><p>Multi-Hyperparameter Risk Plots</p></a></li>
<li><a href='#nlShrinkLWEst'><p>Analytical Non-Linear Shrinkage Estimator</p></a></li>
<li><a href='#plot.cvCovEst'><p>Generic Plot Method for cvCovEst</p></a></li>
<li><a href='#plotAdaptiveLassoEst'><p>Plot adaptiveLassoEst</p></a></li>
<li><a href='#plotPoetEst'><p>Plot poetEst</p></a></li>
<li><a href='#plotRobustPoetEst'><p>Plot robustPoetEst</p></a></li>
<li><a href='#poetEst'><p>POET Estimator</p></a></li>
<li><a href='#robustPoetEst'><p>Robust POET Estimator for Elliptical Distributions</p></a></li>
<li><a href='#safeColScale'><p>Safe Centering and Scaling of Columns</p></a></li>
<li><a href='#sampleCovEst'><p>Sample Covariance Matrix</p></a></li>
<li><a href='#scadEst'><p>Smoothly Clipped Absolute Deviation Estimator</p></a></li>
<li><a href='#scadThreshold'><p>Smoothly Clipped Absolute Deviation Thresholding Function</p></a></li>
<li><a href='#scaleEigVals'><p>Extract Estimated Scaled Eigenvalues in Spiked Covariance Matrix Model</p></a></li>
<li><a href='#spikedFrobeniusShrinkEst'><p>Frobenius Norm Shrinkage Estimator, Spiked Covariance Model</p></a></li>
<li><a href='#spikedOperatorShrinkEst'><p>Operator Norm Shrinkage Estimator, Spiked Covariance Model</p></a></li>
<li><a href='#spikedSteinShrinkEst'><p>Stein Loss Shrinkage Estimator, Spiked Covariance Model</p></a></li>
<li><a href='#strToNumber'><p>Convert String to Numeric or Integer When Needed</p></a></li>
<li><a href='#summary.cvCovEst'><p>Generic Summary Method for cvCovEst</p></a></li>
<li><a href='#taperingEst'><p>Tapering Estimator</p></a></li>
<li><a href='#theme_cvCovEst'><p>cvCovEst Plot Theme</p></a></li>
<li><a href='#thresholdingEst'><p>Hard Thresholding Estimator</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Cross-Validated Covariance Matrix Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>An efficient cross-validated approach for covariance matrix
    estimation, particularly useful in high-dimensional settings. This
    method relies upon the theory of high-dimensional loss-based covariance
    matrix estimator selection developed by Boileau et al. (2022)
    &lt;<a href="https://doi.org/10.1080%2F10618600.2022.2110883">doi:10.1080/10618600.2022.2110883</a>&gt; to identify the optimal estimator
    from among a prespecified set of candidates.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>matrixStats, Matrix, stats, methods, origami, coop, Rdpack,
rlang, dplyr, stringr, purrr, tibble, assertthat, RSpectra,
ggplot2, ggpubr, RColorBrewer, RMTstat</td>
</tr>
<tr>
<td>Suggests:</td>
<td>future, future.apply, MASS, testthat, knitr, rmarkdown, covr,
spelling</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/PhilBoileau/cvCovEst">https://github.com/PhilBoileau/cvCovEst</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/PhilBoileau/cvCovEst/issues">https://github.com/PhilBoileau/cvCovEst/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-17 19:57:20 UTC; philippe</td>
</tr>
<tr>
<td>Author:</td>
<td>Philippe Boileau <a href="https://orcid.org/0000-0002-4850-2507"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Nima Hejazi <a href="https://orcid.org/0000-0002-7127-2789"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Brian Collica <a href="https://orcid.org/0000-0003-1127-2557"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Jamarcus Liu [ctb],
  Mark van der Laan <a href="https://orcid.org/0000-0003-1432-5511"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, ths],
  Sandrine Dudoit <a href="https://orcid.org/0000-0002-6069-8629"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb, ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philippe Boileau &lt;philippe_boileau@berkeley.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-17 20:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adaptiveLassoEst'>Adaptive LASSO Estimator</h2><span id='topic+adaptiveLassoEst'></span>

<h3>Description</h3>

<p><code>adaptiveLassoEst()</code> applied the adaptive LASSO to the
entries of the sample covariance matrix. The thresholding function is
inspired by the penalized regression introduced by
Zou (2006). The thresholding function assigns
a weight to each entry of the sample covariance matrix based on its
initial value. This weight then determines the relative size of the penalty
resulting in larger values being penalized less and reducing bias
(Rothman et al. 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adaptiveLassoEst(dat, lambda, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adaptiveLassoEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="adaptiveLassoEst_+3A_lambda">lambda</code></td>
<td>
<p>A non-negative <code>numeric</code> defining the amount of
thresholding applied to each element of <code>dat</code>'s sample covariance
matrix.</p>
</td></tr>
<tr><td><code id="adaptiveLassoEst_+3A_n">n</code></td>
<td>
<p>A non-negative <code>numeric</code> defining the exponent of the adaptive
weight applied to each element of <code>dat</code>'s sample covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.
</p>


<h3>References</h3>

<p>Rothman AJ, Levina E, Zhu J (2009).
&ldquo;Generalized Thresholding of Large Covariance Matrices.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>104</b>(485), 177-186.
<a href="https://doi.org/10.1198/jasa.2009.0101">doi:10.1198/jasa.2009.0101</a>, https://doi.org/10.1198/jasa.2009.0101.<br /><br /> Zou H (2006).
&ldquo;The Adaptive Lasso and Its Oracle Properties.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>101</b>(476), 1418-1429.
<a href="https://doi.org/10.1198/016214506000000735">doi:10.1198/016214506000000735</a>, https://doi.org/10.1198/016214506000000735.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>adaptiveLassoEst(dat = mtcars, lambda = 0.9, n = 0.9)
</code></pre>

<hr>
<h2 id='adaptiveLassoThreshold'>Adaptive LASSO Thresholding Function</h2><span id='topic+adaptiveLassoThreshold'></span>

<h3>Description</h3>

<p><code>adaptiveLassoThreshold()</code> applies the adaptive LASSO
thresholding function to the entries of a <code>matrix</code>. In particular, it
is meant to be applied to sample covariance matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adaptiveLassoThreshold(entry, lambda, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adaptiveLassoThreshold_+3A_entry">entry</code></td>
<td>
<p>A <code>numeric</code> entry in a covariance matrix estimate.</p>
</td></tr>
<tr><td><code id="adaptiveLassoThreshold_+3A_lambda">lambda</code></td>
<td>
<p>A non-negative <code>numeric</code> defining the amount of
thresholding applied to each element of <code>dat</code>'s sample covariance
matrix.</p>
</td></tr>
<tr><td><code id="adaptiveLassoThreshold_+3A_n">n</code></td>
<td>
<p>A non-negative <code>numeric</code> defining the adaptive weight
applied to each element of <code>dat</code>'s sample covariance matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A regularized <code>numeric</code>.
</p>

<hr>
<h2 id='bandingEst'>Banding Estimator</h2><span id='topic+bandingEst'></span>

<h3>Description</h3>

<p><code>bandingEst()</code> estimates the covariance matrix of data with
ordered variables by forcing off-diagonal entries to be zero for indices
that are far removed from one another. The {i, j} entry of the estimated
covariance matrix will be zero if the absolute value of {i - j} is greater
than some non-negative constant <code>k</code>. This estimator was proposed by
Bickel and Levina (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bandingEst(dat, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bandingEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="bandingEst_+3A_k">k</code></td>
<td>
<p>A non-negative, <code>numeric</code> integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.
</p>


<h3>References</h3>

<p>Bickel PJ, Levina E (2008).
&ldquo;Regularized estimation of large covariance matrices.&rdquo;
<em>Annals of Statistics</em>, <b>36</b>(1), 199&ndash;227.
<a href="https://doi.org/10.1214/009053607000000758">doi:10.1214/009053607000000758</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bandingEst(dat = mtcars, k = 2L)
</code></pre>

<hr>
<h2 id='bestInClass'>Showing Best Estimator Within Each Class of Estimators</h2><span id='topic+bestInClass'></span>

<h3>Description</h3>

<p><code>bestInClass()</code> finds the best performing estimator within
each class of estimator passed to <code><a href="#topic+cvCovEst">cvCovEst</a>()</code> and
finds the associated hyperparameters if applicable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bestInClass(dat, worst = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bestInClass_+3A_dat">dat</code></td>
<td>
<p>The <code><a href="tibble.html#topic+tibble">tibble</a></code> of cross-validated risks which is
output by <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="bestInClass_+3A_worst">worst</code></td>
<td>
<p>This facilitates the option to choose the worst performing
estimator in each class.  Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="tibble.html#topic+tibble">tibble</a></code> with rows corresponding to estimator
classes and columns for hyperparameter values, cross-validated risk, and
other summary metrics for the best (or worst) estimator in that class.
</p>

<hr>
<h2 id='checkArgs'>Check Arguments Passed to cvCovEst</h2><span id='topic+checkArgs'></span>

<h3>Description</h3>

<p><code>checkArgs()</code> verifies that all arguments
passed to <code><a href="#topic+cvCovEst">cvCovEst</a>()</code> function meet its specifications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkArgs(
  dat,
  estimators,
  estimator_params,
  cv_loss,
  cv_scheme,
  mc_split,
  v_folds,
  parallel
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkArgs_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="checkArgs_+3A_estimators">estimators</code></td>
<td>
<p>A <code>list</code> of estimator functions to be considered in
the cross-validated estimator selection procedure.</p>
</td></tr>
<tr><td><code id="checkArgs_+3A_estimator_params">estimator_params</code></td>
<td>
<p>A named <code>list</code> of arguments corresponding to
the hyperparameters of covariance matrix estimators in <code>estimators</code>.
The name of each list element should match the name of an estimator passed
to <code>estimators</code>. Each element of the <code>estimator_params</code> is itself
a named <code>list</code>, with the names corresponding to a given estimator's
hyperparameter(s). These hyperparameters may be in the form of a single
<code>numeric</code> or a <code>numeric</code> vector. If no hyperparameter is needed
for a given estimator, then the estimator need not be listed.</p>
</td></tr>
<tr><td><code id="checkArgs_+3A_cv_loss">cv_loss</code></td>
<td>
<p>A <code>function</code> indicating the loss function to be used.
This defaults to the Frobenius loss, <code><a href="#topic+cvMatrixFrobeniusLoss">cvMatrixFrobeniusLoss</a>()</code>.
An observation-based version, <code><a href="#topic+cvFrobeniusLoss">cvFrobeniusLoss</a>()</code>, is also made
available. Additionally, the <code><a href="#topic+cvScaledMatrixFrobeniusLoss">cvScaledMatrixFrobeniusLoss</a>(())</code>
is included for situations in which <code>dat</code>'s variables are of different
scales.</p>
</td></tr>
<tr><td><code id="checkArgs_+3A_cv_scheme">cv_scheme</code></td>
<td>
<p>A <code>character</code> indicating the cross-validation scheme
to be employed. There are two options: (1) V-fold cross-validation, via
<code>"v_folds"</code>; and (2) Monte Carlo cross-validation, via <code>"mc"</code>.
Defaults to Monte Carlo cross-validation.</p>
</td></tr>
<tr><td><code id="checkArgs_+3A_mc_split">mc_split</code></td>
<td>
<p>A <code>numeric</code> between 0 and 1 indicating the proportion
of observations to be included in the validation set of each Monte Carlo
cross-validation fold.</p>
</td></tr>
<tr><td><code id="checkArgs_+3A_v_folds">v_folds</code></td>
<td>
<p>An <code>integer</code> larger than or equal to 1 indicating the
number of folds to use for cross-validation. The default is 10, regardless
of the choice of cross-validation scheme.</p>
</td></tr>
<tr><td><code id="checkArgs_+3A_parallel">parallel</code></td>
<td>
<p>A <code>logical</code> option indicating whether to run the main
cross-validation loop with <code><a href="future.apply.html#topic+future_lapply">future_lapply</a>()</code>. This
is passed directly to <code><a href="origami.html#topic+cross_validate">cross_validate</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Whether all argument conditions are satisfied
</p>

<hr>
<h2 id='checkPlotSumArgs'>Check Arguments Passed to plot.cvCovEst and summary.cvCovEst</h2><span id='topic+checkPlotSumArgs'></span>

<h3>Description</h3>

<p>The <code>checkPlotSumArgs()</code> function verifies that all
arguments passed to the <code><a href="#topic+plot.cvCovEst">plot.cvCovEst</a>()</code> and
<code><a href="#topic+summary.cvCovEst">summary.cvCovEst</a>()</code> functions meet their specifications. Some
additional arguments may be checked at the individual function level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkPlotSumArgs(
  dat,
  dat_orig,
  which_fun,
  estimator,
  plot_type,
  summ_fun,
  stat,
  k,
  leading,
  abs_v
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="checkPlotSumArgs_+3A_dat">dat</code></td>
<td>
<p>An object of class <code>"cvCovEst"</code>.  Specifically, this is the
standard output of the <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="checkPlotSumArgs_+3A_dat_orig">dat_orig</code></td>
<td>
<p>The <code>numeric</code> <code>data.frame</code>, <code>matrix</code>, or
similar object originally passed to <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="checkPlotSumArgs_+3A_which_fun">which_fun</code></td>
<td>
<p>A <code>character</code> indicating a choice of <code>"plot"</code> or
<code>"summary"</code> depending on which function is being checked.</p>
</td></tr>
<tr><td><code id="checkPlotSumArgs_+3A_estimator">estimator</code></td>
<td>
<p>A <code>character</code> vector specifying one or more classes of
estimators to compare.</p>
</td></tr>
<tr><td><code id="checkPlotSumArgs_+3A_plot_type">plot_type</code></td>
<td>
<p>A <code>character</code> vector specifying one of four choices of
diagnostic plots.</p>
</td></tr>
<tr><td><code id="checkPlotSumArgs_+3A_summ_fun">summ_fun</code></td>
<td>
<p>A <code>character</code> vector specifying which summaries to
output.</p>
</td></tr>
<tr><td><code id="checkPlotSumArgs_+3A_stat">stat</code></td>
<td>
<p>A <code>character</code> vector of one or more summary statistics to
use when comparing estimators.</p>
</td></tr>
<tr><td><code id="checkPlotSumArgs_+3A_k">k</code></td>
<td>
<p>A <code>integer</code> indicating the number of leading/trailing
eigenvalues to plot.</p>
</td></tr>
<tr><td><code id="checkPlotSumArgs_+3A_leading">leading</code></td>
<td>
<p>A <code>logical</code> indicating if the leading eigenvalues should
be used.</p>
</td></tr>
<tr><td><code id="checkPlotSumArgs_+3A_abs_v">abs_v</code></td>
<td>
<p>A <code>logical</code> determining if the absolute value of the matrix
entries should be used for plotting the matrix heatmap.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Whether all argument conditions are satisfied.
</p>

<hr>
<h2 id='computeC'>Estimate C of Spiked Covariance Matrix Estimator</h2><span id='topic+computeC'></span>

<h3>Description</h3>

<p><code>computeC()</code> computes the c(ell) value described in
Donoho et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeC(ell, p_n_ratio)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeC_+3A_ell">ell</code></td>
<td>
<p>A <code>numeric</code> vector output by <code><a href="#topic+computeEll">computeEll</a>()</code>.</p>
</td></tr>
<tr><td><code id="computeC_+3A_p_n_ratio">p_n_ratio</code></td>
<td>
<p>A <code>numeric</code> indicating the asymptotic ratio of the
number of features, p, and the number of observations, n. This ratio is
assumed to be between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>numeric</code> vector.
</p>


<h3>References</h3>

<p>Donoho D, Gavish M, Johnstone I (2018).
&ldquo;Optimal shrinkage of eigenvalues in the spiked covariance model.&rdquo;
<em>The Annals of Statistics</em>, <b>46</b>(4), 1742 &ndash; 1778.
</p>

<hr>
<h2 id='computeEll'>Estimate Ell of Spiked Covariance Matrix Estimator</h2><span id='topic+computeEll'></span>

<h3>Description</h3>

<p><code>computeEll()</code> computes the ell value described in
Donoho et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeEll(scaled_eig_vals, p, p_n_ratio)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeEll_+3A_scaled_eig_vals">scaled_eig_vals</code></td>
<td>
<p>A <code>numeric</code> vector of scaled estimated
eigenvalues.</p>
</td></tr>
<tr><td><code id="computeEll_+3A_p">p</code></td>
<td>
<p>A <code>numeric</code> integer indicating the number of features in the
data.</p>
</td></tr>
<tr><td><code id="computeEll_+3A_p_n_ratio">p_n_ratio</code></td>
<td>
<p>A <code>numeric</code> indicating the asymptotic ratio of the
number of features, p, and the number of observations, n. This ratio is
assumed to be between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>numeric</code> vector.
</p>


<h3>References</h3>

<p>Donoho D, Gavish M, Johnstone I (2018).
&ldquo;Optimal shrinkage of eigenvalues in the spiked covariance model.&rdquo;
<em>The Annals of Statistics</em>, <b>46</b>(4), 1742 &ndash; 1778.
</p>

<hr>
<h2 id='computeS'>Estimate S of Spiked Covariance Matrix Estimator</h2><span id='topic+computeS'></span>

<h3>Description</h3>

<p><code>computeS()</code> computes the s(ell) value described in
Donoho et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeS(c_donoho)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeS_+3A_c_donoho">c_donoho</code></td>
<td>
<p>A <code>numeric</code> vector output by <code><a href="#topic+computeC">computeC</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>numeric</code> vector.
</p>


<h3>References</h3>

<p>Donoho D, Gavish M, Johnstone I (2018).
&ldquo;Optimal shrinkage of eigenvalues in the spiked covariance model.&rdquo;
<em>The Annals of Statistics</em>, <b>46</b>(4), 1742 &ndash; 1778.
</p>

<hr>
<h2 id='cvCovEst'>Cross-Validated Covariance Matrix Estimator Selector</h2><span id='topic+cvCovEst'></span>

<h3>Description</h3>

<p><code>cvCovEst()</code> identifies the optimal covariance matrix
estimator from among a set of candidate estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvCovEst(
  dat,
  estimators = c(linearShrinkEst, thresholdingEst, sampleCovEst),
  estimator_params = list(linearShrinkEst = list(alpha = 0), thresholdingEst = list(gamma
    = 0)),
  cv_loss = cvMatrixFrobeniusLoss,
  cv_scheme = "v_fold",
  mc_split = 0.5,
  v_folds = 10L,
  parallel = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvCovEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="cvCovEst_+3A_estimators">estimators</code></td>
<td>
<p>A <code>list</code> of estimator functions to be considered in
the cross-validated estimator selection procedure.</p>
</td></tr>
<tr><td><code id="cvCovEst_+3A_estimator_params">estimator_params</code></td>
<td>
<p>A named <code>list</code> of arguments corresponding to
the hyperparameters of covariance matrix estimators in <code>estimators</code>.
The name of each list element should match the name of an estimator passed
to <code>estimators</code>. Each element of the <code>estimator_params</code> is itself
a named <code>list</code>, with the names corresponding to a given estimator's
hyperparameter(s). The hyperparameter(s) may be in the form of a single
<code>numeric</code> or a <code>numeric</code> vector. If no hyperparameter is needed
for a given estimator, then the estimator need not be listed.</p>
</td></tr>
<tr><td><code id="cvCovEst_+3A_cv_loss">cv_loss</code></td>
<td>
<p>A <code>function</code> indicating the loss function to be used.
This defaults to the Frobenius loss, <code><a href="#topic+cvMatrixFrobeniusLoss">cvMatrixFrobeniusLoss</a>()</code>.
An observation-based version, <code><a href="#topic+cvFrobeniusLoss">cvFrobeniusLoss</a>()</code>, is also made
available. Additionally, the <code><a href="#topic+cvScaledMatrixFrobeniusLoss">cvScaledMatrixFrobeniusLoss</a>()</code> is
included for situations in which <code>dat</code>'s variables are of different
scales.</p>
</td></tr>
<tr><td><code id="cvCovEst_+3A_cv_scheme">cv_scheme</code></td>
<td>
<p>A <code>character</code> indicating the cross-validation scheme
to be employed. There are two options: (1) V-fold cross-validation, via
<code>"v_folds"</code>; and (2) Monte Carlo cross-validation, via <code>"mc"</code>.
Defaults to Monte Carlo cross-validation.</p>
</td></tr>
<tr><td><code id="cvCovEst_+3A_mc_split">mc_split</code></td>
<td>
<p>A <code>numeric</code> between 0 and 1 indicating the proportion
of observations to be included in the validation set of each Monte Carlo
cross-validation fold.</p>
</td></tr>
<tr><td><code id="cvCovEst_+3A_v_folds">v_folds</code></td>
<td>
<p>An <code>integer</code> larger than or equal to 1 indicating the
number of folds to use for cross-validation. The default is 10, regardless
of the choice of cross-validation scheme.</p>
</td></tr>
<tr><td><code id="cvCovEst_+3A_parallel">parallel</code></td>
<td>
<p>A <code>logical</code> option indicating whether to run the main
cross-validation loop with <code><a href="future.apply.html#topic+future_lapply">future_lapply</a>()</code>. This
is passed directly to <code><a href="origami.html#topic+cross_validate">cross_validate</a>()</code>.</p>
</td></tr>
<tr><td><code id="cvCovEst_+3A_...">...</code></td>
<td>
<p>Not currently used. Permits backward compatibility.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of results containing the following elements:
</p>

<ul>
<li> <p><code>estimate</code> - A <code>matrix</code> corresponding to the estimate of
the optimal covariance matrix estimator.
</p>
</li>
<li> <p><code>estimator</code> - A <code>character</code> indicating the optimal
estimator and corresponding hyperparameters, if any.
</p>
</li>
<li> <p><code>risk_df</code> - A <code><a href="tibble.html#topic+tibble">tibble</a></code> providing the
cross-validated risk estimates of each estimator.
</p>
</li>
<li> <p><code>cv_df</code> - A <code><a href="tibble.html#topic+tibble">tibble</a></code> providing each
estimators' loss over the folds of the cross-validated procedure.
</p>
</li>
<li> <p><code>args</code> - A named <code>list</code> containing arguments passed to
<code>cvCovEst</code>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>cvCovEst(
  dat = mtcars,
  estimators = c(
    linearShrinkLWEst, thresholdingEst, sampleCovEst
  ),
  estimator_params = list(
    thresholdingEst = list(gamma = seq(0.1, 0.3, 0.1))
  )
)
</code></pre>

<hr>
<h2 id='cvEigenPlot'>Eigenvalue Plot</h2><span id='topic+cvEigenPlot'></span>

<h3>Description</h3>

<p><code>cvEigenPlot()</code> plots the eigenvalues of one or more
estimators produced by <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvEigenPlot(
  dat,
  estimator,
  stat = "min",
  dat_orig,
  k,
  leading = TRUE,
  plot_type = "eigen",
  cv_details,
  has_hypers
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvEigenPlot_+3A_dat">dat</code></td>
<td>
<p>A named <code>list</code>.  Specifically, this is the standard output of
<code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="cvEigenPlot_+3A_estimator">estimator</code></td>
<td>
<p>A <code>character</code> vector specifying one or more classes of
estimators to compare.</p>
</td></tr>
<tr><td><code id="cvEigenPlot_+3A_stat">stat</code></td>
<td>
<p>A <code>character</code> vector containing the names of various
cross-validated risk summary statistics.  Within each class of estimator,
eigenvalues will be plot for the estimators corresponding to each stat.</p>
</td></tr>
<tr><td><code id="cvEigenPlot_+3A_dat_orig">dat_orig</code></td>
<td>
<p>The <code>numeric data.frame</code>, <code>matrix</code>, or similar
object originally passed to <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="cvEigenPlot_+3A_k">k</code></td>
<td>
<p>A <code>numeric</code> indicating the number of eigenvalues to plot. Must
be less than or equal to the number of columns of the original data matrix.</p>
</td></tr>
<tr><td><code id="cvEigenPlot_+3A_leading">leading</code></td>
<td>
<p>A <code>logical</code> indicating if the leading eigenvalues should
be used.  Default is <code>TRUE</code>.  If <code>FALSE</code>, the trailing
eigenvalues will be used instead.</p>
</td></tr>
<tr><td><code id="cvEigenPlot_+3A_plot_type">plot_type</code></td>
<td>
<p>A <code>character</code> detailing the type of plot. Passed to
<code>theme_cvCovEst</code>, defaults to <code>"risk"</code></p>
</td></tr>
<tr><td><code id="cvEigenPlot_+3A_cv_details">cv_details</code></td>
<td>
<p>A <code>character</code> vector summarizing key arguments passed
to <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="cvEigenPlot_+3A_has_hypers">has_hypers</code></td>
<td>
<p>A <code>character</code> vector containing the names of current
estimators with hyperparameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot, or grid of plots, showing the <code>k</code> leading or trailing
eigenvalues of the specified estimators and associated summary statistics of
the cross-validated risk.
</p>

<hr>
<h2 id='cvFrobeniusLoss'>Cross-Validation Function for Aggregated Frobenius Loss</h2><span id='topic+cvFrobeniusLoss'></span>

<h3>Description</h3>

<p><code>cvFrobeniusLoss()</code> evaluates the aggregated Frobenius loss
over a <code>fold</code> object (from '<span class="pkg">origami</span>'
(Coyle and Hejazi 2018)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvFrobeniusLoss(fold, dat, estimator_funs, estimator_params = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvFrobeniusLoss_+3A_fold">fold</code></td>
<td>
<p>A <code>fold</code> object (from <code><a href="origami.html#topic+make_folds">make_folds</a>()</code>)
over which the estimation procedure is to be performed.</p>
</td></tr>
<tr><td><code id="cvFrobeniusLoss_+3A_dat">dat</code></td>
<td>
<p>A <code>data.frame</code> containing the full (non-sample-split) data,
on which the cross-validated procedure is performed.</p>
</td></tr>
<tr><td><code id="cvFrobeniusLoss_+3A_estimator_funs">estimator_funs</code></td>
<td>
<p>An <code>expression</code> corresponding to a vector of
covariance matrix estimator functions to be applied to the training data.</p>
</td></tr>
<tr><td><code id="cvFrobeniusLoss_+3A_estimator_params">estimator_params</code></td>
<td>
<p>A named <code>list</code> of arguments corresponding to
the hyperparameters of covariance matrix estimators, <code>estimator_funs</code>.
The name of each list element should be the name of an estimator passed to
<code>estimator_funs</code>. Each element of the <code>estimator_params</code> is
itself a named <code>list</code>, with names corresponding to an estimators'
hyperparameter(s). These hyperparameters may be in the form of a single
<code>numeric</code> or a <code>numeric</code> vector. If no hyperparameter is needed
for a given estimator, then the estimator need not be listed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble</a></code> providing information on estimators,
their hyperparameters (if any), and their scaled Frobenius loss evaluated
on a given <code>fold</code>.
</p>


<h3>References</h3>

<p>Coyle J, Hejazi N (2018).
&ldquo;origami: A Generalized Framework for Cross-Validation in R.&rdquo;
<em>Journal of Open Source Software</em>, <b>3</b>(21), 512.
<a href="https://doi.org/10.21105/joss.00512">doi:10.21105/joss.00512</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
library(origami)
library(rlang)

# generate 10x10 covariance matrix with unit variances and off-diagonal
# elements equal to 0.5
Sigma &lt;- matrix(0.5, nrow = 10, ncol = 10) + diag(0.5, nrow = 10)

# sample 50 observations from multivariate normal with mean = 0, var = Sigma
dat &lt;- mvrnorm(n = 50, mu = rep(0, 10), Sigma = Sigma)

# generate a single fold using MC-cv
resub &lt;- make_folds(dat,
  fold_fun = folds_vfold,
  V = 2
)[[1]]
cvFrobeniusLoss(
  fold = resub,
  dat = dat,
  estimator_funs = rlang::quo(c(
    linearShrinkEst, thresholdingEst, sampleCovEst
  )),
  estimator_params = list(
    linearShrinkEst = list(alpha = c(0, 1)),
    thresholdingEst = list(gamma = c(0, 1))
  )
)
</code></pre>

<hr>
<h2 id='cvMatrixFrobeniusLoss'>Cross-Validation Function for Matrix Frobenius Loss</h2><span id='topic+cvMatrixFrobeniusLoss'></span>

<h3>Description</h3>

<p><code>cvMatrixFrobeniusLoss()</code> evaluates the matrix Frobenius
loss over a <code>fold</code> object (from '<span class="pkg">origami</span>'
(Coyle and Hejazi 2018)). This loss function is equivalent to that
presented in <code><a href="#topic+cvFrobeniusLoss">cvFrobeniusLoss</a>()</code> in terms of estimator
selections, but is more computationally efficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvMatrixFrobeniusLoss(fold, dat, estimator_funs, estimator_params = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvMatrixFrobeniusLoss_+3A_fold">fold</code></td>
<td>
<p>A <code>fold</code> object (from <code><a href="origami.html#topic+make_folds">make_folds</a>()</code>)
over which the estimation procedure is to be performed.</p>
</td></tr>
<tr><td><code id="cvMatrixFrobeniusLoss_+3A_dat">dat</code></td>
<td>
<p>A <code>data.frame</code> containing the full (non-sample-split) data,
on which the cross-validated procedure is performed.</p>
</td></tr>
<tr><td><code id="cvMatrixFrobeniusLoss_+3A_estimator_funs">estimator_funs</code></td>
<td>
<p>An <code>expression</code> corresponding to a vector of
covariance matrix estimator functions to be applied to the training data.</p>
</td></tr>
<tr><td><code id="cvMatrixFrobeniusLoss_+3A_estimator_params">estimator_params</code></td>
<td>
<p>A named <code>list</code> of arguments corresponding to
the hyperparameters of covariance matrix estimators, <code>estimator_funs</code>.
The name of each list element should be the name of an estimator passed to
<code>estimator_funs</code>. Each element of the <code>estimator_params</code> is
itself a named <code>list</code>, with names corresponding to an estimators'
hyperparameter(s). These hyperparameters may be in the form of a single
<code>numeric</code> or a <code>numeric</code> vector. If no hyperparameter is needed
for a given estimator, then the estimator need not be listed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble</a></code> providing information on estimators,
their hyperparameters (if any), and their matrix Frobenius loss evaluated
on a given <code>fold</code>.
</p>


<h3>References</h3>

<p>Coyle J, Hejazi N (2018).
&ldquo;origami: A Generalized Framework for Cross-Validation in R.&rdquo;
<em>Journal of Open Source Software</em>, <b>3</b>(21), 512.
<a href="https://doi.org/10.21105/joss.00512">doi:10.21105/joss.00512</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
library(origami)
library(rlang)

# generate 10x10 covariance matrix with unit variances and off-diagonal
# elements equal to 0.5
Sigma &lt;- matrix(0.5, nrow = 10, ncol = 10) + diag(0.5, nrow = 10)

# sample 50 observations from multivariate normal with mean = 0, var = Sigma
dat &lt;- mvrnorm(n = 50, mu = rep(0, 10), Sigma = Sigma)

# generate a single fold using MC-cv
resub &lt;- make_folds(dat,
  fold_fun = folds_vfold,
  V = 2
)[[1]]
cvMatrixFrobeniusLoss(
  fold = resub,
  dat = dat,
  estimator_funs = rlang::quo(c(
    linearShrinkEst, thresholdingEst, sampleCovEst
  )),
  estimator_params = list(
    linearShrinkEst = list(alpha = c(0, 1)),
    thresholdingEst = list(gamma = c(0, 1))
  )
)
</code></pre>

<hr>
<h2 id='cvMatrixMetrics'>Matrix Metrics for cvCovEst Object</h2><span id='topic+cvMatrixMetrics'></span>

<h3>Description</h3>

<p><code>cvMatrixMetrics</code> computes various metrics and properties
for each covariance matrix estimator candidate's estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvMatrixMetrics(object, dat_orig)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvMatrixMetrics_+3A_object">object</code></td>
<td>
<p>A named list of class <code>"cvCovEst"</code> containing the
cross-validated risk assessment.</p>
</td></tr>
<tr><td><code id="cvMatrixMetrics_+3A_dat_orig">dat_orig</code></td>
<td>
<p>The <code>numeric data.frame</code>, <code>matrix</code>, or similar
object originally passed to <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of class <code>"cvCovEst"</code> whose cross-validated risk
assessment is now a <code><a href="tibble.html#topic+tibble">tibble</a></code> containing the
corresponding metrics for each estimate.  The <code><a href="tibble.html#topic+tibble">tibble</a></code>
is grouped by estimator and ordered by the primary hyperparameter if
applicable.
</p>

<hr>
<h2 id='cvMultiMelt'>Multiple Heat Map Plot</h2><span id='topic+cvMultiMelt'></span>

<h3>Description</h3>

<p><code>cvMultiMelt()</code> visualizes the structure of one or more
covariance matrix estimators through a grid of heat maps, where each heat
map corresponds to a different estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvMultiMelt(
  dat,
  estimator,
  stat = "min",
  dat_orig,
  plot_type = "heatmap",
  cv_details,
  has_hypers,
  abs_v = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvMultiMelt_+3A_dat">dat</code></td>
<td>
<p>A named <code>list</code>.  Specifically, this is the standard output of
<code>cvCovEst</code>.</p>
</td></tr>
<tr><td><code id="cvMultiMelt_+3A_estimator">estimator</code></td>
<td>
<p>A <code>character</code> vector specifying one or more classes of
estimators to visualize and compare.</p>
</td></tr>
<tr><td><code id="cvMultiMelt_+3A_stat">stat</code></td>
<td>
<p>A <code>character</code> vector containing the names of various
cross-validated risk summary statistics. Estimators corresponding to each
statistics will be visualized with a different heatmap. Default is
<code>'min'</code> for minimum cross-validated risk.</p>
</td></tr>
<tr><td><code id="cvMultiMelt_+3A_dat_orig">dat_orig</code></td>
<td>
<p>The <code>numeric data.frame</code>, <code>matrix</code>, or similar
object originally passed to <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="cvMultiMelt_+3A_plot_type">plot_type</code></td>
<td>
<p>A <code>character</code> detailing the type of plot. Passed to
<code>theme_cvCovEst</code>, defaults to <code>"risk"</code></p>
</td></tr>
<tr><td><code id="cvMultiMelt_+3A_cv_details">cv_details</code></td>
<td>
<p>A <code>character</code> vector summarizing key arguments passed
to <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="cvMultiMelt_+3A_has_hypers">has_hypers</code></td>
<td>
<p>A <code>character</code> vector containing the names of current
estimators with hyperparameters.</p>
</td></tr>
<tr><td><code id="cvMultiMelt_+3A_abs_v">abs_v</code></td>
<td>
<p>A <code>logical</code> determining if the absolute value of the matrix
entries should be displayed versus the signed value. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A grid of heat map plots comparing the desired covariance matrix
estimators.
</p>

<hr>
<h2 id='cvRiskByClass'>Summary Statistics of Cross-Validated Risk by Estimator Class</h2><span id='topic+cvRiskByClass'></span>

<h3>Description</h3>

<p><code>cvRiskByClass()</code> calculates the following
summary statistics for the cross-validated risk within each class of
estimator passed to <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>: minimum, Q1, median, mean, Q3,
and maximum.  The results are output as a <code>tibble</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvRiskByClass(dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvRiskByClass_+3A_dat">dat</code></td>
<td>
<p>The <code><a href="tibble.html#topic+tibble">tibble</a></code> of cross-validated risk
calculations which is output by <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="tibble.html#topic+tibble">tibble</a></code> with rows corresponding to estimator
classes and columns corresponding to each summary statistic.
</p>

<hr>
<h2 id='cvRiskPlot'>Cross-Validated Risk Plot</h2><span id='topic+cvRiskPlot'></span>

<h3>Description</h3>

<p><code>cvRiskPlot()</code> plots the cross-validated risk for a given
estimator, or set of estimators, as a function of the hyperparameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvRiskPlot(
  dat,
  est,
  plot_type = "risk",
  cv_details,
  switch_vars = FALSE,
  min_max = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvRiskPlot_+3A_dat">dat</code></td>
<td>
<p>A named <code>list</code>.  Specifically, this is the standard output of
<code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="cvRiskPlot_+3A_est">est</code></td>
<td>
<p>A <code>character</code> vector specifying one or more classes of
estimators to compare.</p>
</td></tr>
<tr><td><code id="cvRiskPlot_+3A_plot_type">plot_type</code></td>
<td>
<p>A <code>character</code> detailing the type of plot. Passed to
<code><a href="#topic+theme_cvCovEst">theme_cvCovEst</a>()</code>, defaults to <code>"risk"</code></p>
</td></tr>
<tr><td><code id="cvRiskPlot_+3A_cv_details">cv_details</code></td>
<td>
<p>A <code>character</code> vector summarizing key arguments passed
to <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="cvRiskPlot_+3A_switch_vars">switch_vars</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>,
the hyperparameters used for the x-axis and factor variables are switched.
Only applies to estimators with more than one hyperparameter. Defaults to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cvRiskPlot_+3A_min_max">min_max</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>, only the minimum and
maximum values of the factor hyperparameter will be used.  Only applies to
estimators with more than one hyperparameter. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single plot or grid of plots for each estimator specified.
</p>

<hr>
<h2 id='cvScaledMatrixFrobeniusLoss'>Cross-Validation Function for Scaled Matrix Frobenius Loss</h2><span id='topic+cvScaledMatrixFrobeniusLoss'></span>

<h3>Description</h3>

<p><code>cvScaledMatrixFrobeniusLoss()</code> evaluates the scaled matrix
Frobenius loss over a <code>fold</code> object (from '<span class="pkg">origami</span>'
(Coyle and Hejazi 2018)). The squared error loss computed for each
entry of the estimated covariance matrix is scaled by the training set's
sample variances of the variable associated with that entry's row and
column variables. This loss should be used instead of
<code><a href="#topic+cvMatrixFrobeniusLoss">cvMatrixFrobeniusLoss</a>()</code> when a dataset's variables' values
are of different magnitudes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvScaledMatrixFrobeniusLoss(fold, dat, estimator_funs, estimator_params = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvScaledMatrixFrobeniusLoss_+3A_fold">fold</code></td>
<td>
<p>A <code>fold</code> object (from <code><a href="origami.html#topic+make_folds">make_folds</a>()</code>)
over which the estimation procedure is to be performed.</p>
</td></tr>
<tr><td><code id="cvScaledMatrixFrobeniusLoss_+3A_dat">dat</code></td>
<td>
<p>A <code>data.frame</code> containing the full (non-sample-split) data,
on which the cross-validated procedure is performed.</p>
</td></tr>
<tr><td><code id="cvScaledMatrixFrobeniusLoss_+3A_estimator_funs">estimator_funs</code></td>
<td>
<p>An <code>expression</code> corresponding to a vector of
covariance matrix estimator functions to be applied to the training data.</p>
</td></tr>
<tr><td><code id="cvScaledMatrixFrobeniusLoss_+3A_estimator_params">estimator_params</code></td>
<td>
<p>A named <code>list</code> of arguments corresponding to
the hyperparameters of covariance matrix estimators, <code>estimator_funs</code>.
The name of each list element should be the name of an estimator passed to
<code>estimator_funs</code>. Each element of the <code>estimator_params</code> is
itself a named <code>list</code>, with names corresponding to an estimators'
hyperparameter(s). These hyperparameters may be in the form of a single
<code>numeric</code> or a <code>numeric</code> vector. If no hyperparameter is needed
for a given estimator, then the estimator need not be listed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="tibble.html#topic+tibble">tibble</a></code> providing information on estimators,
their hyperparameters (if any), and their scaled matrix Frobenius loss
evaluated on a given <code>fold</code>.
</p>


<h3>References</h3>

<p>Coyle J, Hejazi N (2018).
&ldquo;origami: A Generalized Framework for Cross-Validation in R.&rdquo;
<em>Journal of Open Source Software</em>, <b>3</b>(21), 512.
<a href="https://doi.org/10.21105/joss.00512">doi:10.21105/joss.00512</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(MASS)
library(origami)
library(rlang)

# generate 10x10 covariance matrix with unit variances and off-diagonal
# elements equal to 0.5
Sigma &lt;- matrix(0.5, nrow = 10, ncol = 10) + diag(0.5, nrow = 10)

# sample 50 observations from multivariate normal with mean = 0, var = Sigma
dat &lt;- mvrnorm(n = 50, mu = rep(0, 10), Sigma = Sigma)

# generate a single fold using MC-cv
resub &lt;- make_folds(dat,
  fold_fun = folds_vfold,
  V = 2
)[[1]]
cvScaledMatrixFrobeniusLoss(
  fold = resub,
  dat = dat,
  estimator_funs = rlang::quo(c(
    linearShrinkEst, thresholdingEst, sampleCovEst
  )),
  estimator_params = list(
    linearShrinkEst = list(alpha = c(0, 1)),
    thresholdingEst = list(gamma = c(0, 1))
  )
)
</code></pre>

<hr>
<h2 id='cvSummaryPlot'>Summary Plot</h2><span id='topic+cvSummaryPlot'></span>

<h3>Description</h3>

<p><code>cvSummaryPlot()</code> combines plots of the eigenvalues and the
covariance heatmap for the optimal estimator selected by
<code><a href="#topic+cvCovEst">cvCovEst</a>()</code>, and also provides a table showing the best
estimator within each class.  A plot the risk of the optimal estimator's
class is also provided if applicable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvSummaryPlot(
  dat,
  estimator,
  dat_orig,
  stat,
  k,
  leading,
  plot_type = "summary",
  cv_details,
  has_hypers,
  multi_hypers,
  abs_v,
  switch_vars,
  min_max
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvSummaryPlot_+3A_dat">dat</code></td>
<td>
<p>A named <code>list</code>.  Specifically, this is the standard output of
<code>cvCovEst</code>.</p>
</td></tr>
<tr><td><code id="cvSummaryPlot_+3A_estimator">estimator</code></td>
<td>
<p>A <code>character</code> vector specifying which class of
estimator to plot.</p>
</td></tr>
<tr><td><code id="cvSummaryPlot_+3A_dat_orig">dat_orig</code></td>
<td>
<p>The <code>numeric data.frame</code>, <code>matrix</code>, or similar
object originally passed to <code>cvCovEst</code>.</p>
</td></tr>
<tr><td><code id="cvSummaryPlot_+3A_plot_type">plot_type</code></td>
<td>
<p>A <code>character</code> detailing the type of plot. Passed to
<code><a href="#topic+theme_cvCovEst">theme_cvCovEst</a>()</code>, defaults to <code>"risk"</code></p>
</td></tr>
<tr><td><code id="cvSummaryPlot_+3A_cv_details">cv_details</code></td>
<td>
<p>Character vector summarizing key arguments passed to
<code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="cvSummaryPlot_+3A_has_hypers">has_hypers</code></td>
<td>
<p>A <code>character</code> vector containing the names of current
estimators with hyperparameters.</p>
</td></tr>
<tr><td><code id="cvSummaryPlot_+3A_multi_hypers">multi_hypers</code></td>
<td>
<p>A <code>character</code> vector containing the names of current
estimators with multiple hyperparameters.</p>
</td></tr>
<tr><td><code id="cvSummaryPlot_+3A_abs_v">abs_v</code></td>
<td>
<p>A <code>logical</code> determining if the absolute value of the matrix
entries should be used for plotting the matrix heatmap.  Default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="cvSummaryPlot_+3A_switch_vars">switch_vars</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>,
the hyperparameters used for the x-axis and factor variables are switched.
Only applies to estimators with more than one hyperparameter. Defaults to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="cvSummaryPlot_+3A_min_max">min_max</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>, only the minimum and
maximum values of the factor hyperparameter will be used.  Only applies to
estimators with more than one hyperparameter. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A collection of plots and summary statistics for the optimal
estimator selected by <code>cvCovEst</code>.
</p>

<hr>
<h2 id='denseLinearShrinkEst'>Linear Shrinkage Estimator, Dense Target</h2><span id='topic+denseLinearShrinkEst'></span>

<h3>Description</h3>

<p><code>denseLinearShrinkEst()</code> computes the asymptotically
optimal convex combination of the sample covariance matrix and a dense
target matrix. This target matrix's diagonal elements are equal to the
average of the sample covariance matrix estimate's diagonal elements, and
its off-diagonal elements are equal to the average of the sample covariance
matrix estimate's off-diagonal elements. For information on this
estimator's derivation, see Ledoit and Wolf (2020) and
Schfer and Strimmer (2005).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>denseLinearShrinkEst(dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="denseLinearShrinkEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.
</p>


<h3>References</h3>

<p>Ledoit O, Wolf M (2020).
&ldquo;The Power of (Non-)Linear Shrinking: A Review and Guide to Covariance Matrix Estimation.&rdquo;
<em>Journal of Financial Econometrics</em>.
ISSN 1479-8409, <a href="https://doi.org/10.1093/jjfinec/nbaa007">doi:10.1093/jjfinec/nbaa007</a>, nbaa007, https://academic.oup.com/jfec/advance-article-pdf/doi/10.1093/jjfinec/nbaa007/33416890/nbaa007.pdf.<br /><br /> Schfer J, Strimmer K (2005).
&ldquo;A Shrinkage Approach to Large-Scale Covariance Matrix Estimation and Implications for Functional Genomics.&rdquo;
<em>Statistical Applications in Genetics and Molecular Biology</em>, <b>4</b>(1).
<a href="https://doi.org/10.2202/1544-6115.1175">doi:10.2202/1544-6115.1175</a>, <a href="https://www.degruyter.com/view/journals/sagmb/4/1/article-sagmb.2005.4.1.1175.xml.xml">https://www.degruyter.com/view/journals/sagmb/4/1/article-sagmb.2005.4.1.1175.xml.xml</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>denseLinearShrinkEst(dat = mtcars)
</code></pre>

<hr>
<h2 id='estAttributes'>Estimator Attributes Function</h2><span id='topic+estAttributes'></span>

<h3>Description</h3>

<p><code>estAttributes()</code> returns a named list corresponding to the
attributes of a specific estimator implemented in the <code>cvCovEst</code>
package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estAttributes(estimator)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estAttributes_+3A_estimator">estimator</code></td>
<td>
<p>A <code>character</code> vector specifying a class of estimator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code>list</code> containing the attributes of the indicated
estimator.
</p>

<hr>
<h2 id='estimateNoise'>Estimate Noise in Spiked Covariance Matrix Model</h2><span id='topic+estimateNoise'></span>

<h3>Description</h3>

<p><code>estimateNoise()</code> estimates the unknown noise term in a
Gaussian spiked covariance matrix model, where the covariance matrix is
assumed to be the identity matrix multiplied by the unknown noise, save for
a few &quot;spiked&quot; entries. This procedures is described in
Donoho et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateNoise(eig_vals, p_n_ratio)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimateNoise_+3A_eig_vals">eig_vals</code></td>
<td>
<p>A <code>numeric</code> vector of estimated eigenvalues.</p>
</td></tr>
<tr><td><code id="estimateNoise_+3A_p_n_ratio">p_n_ratio</code></td>
<td>
<p>A <code>numeric</code> indicating the asymptotic ratio of the
number of features, p, and the number of observations, n. This ratio is
assumed to be between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>numeric</code> estimate of the noise term in a spiked covariance
matrix model.
</p>


<h3>References</h3>

<p>Donoho D, Gavish M, Johnstone I (2018).
&ldquo;Optimal shrinkage of eigenvalues in the spiked covariance model.&rdquo;
<em>The Annals of Statistics</em>, <b>46</b>(4), 1742 &ndash; 1778.
</p>

<hr>
<h2 id='getHypers'>Hyperparameter Retrieval Function</h2><span id='topic+getHypers'></span>

<h3>Description</h3>

<p><code>getHypers()</code> retrieves the names and values of all
hyperparameters associated with an estimator passed to <code>cvCovEst()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getHypers(dat, summ_stat, new_df = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getHypers_+3A_dat">dat</code></td>
<td>
<p>A <code>data.frame</code> of estimators and their hyperparameter values.
Specifically, this is one of the outputs of <code>summary.cvCovEst()</code> or
<code>cvCovEst()</code>.</p>
</td></tr>
<tr><td><code id="getHypers_+3A_summ_stat">summ_stat</code></td>
<td>
<p>A character vector specifying the summary statistic of
interest.</p>
</td></tr>
<tr><td><code id="getHypers_+3A_new_df">new_df</code></td>
<td>
<p>A <code>logical</code> indicating whether a new <code>data.frame</code>
should be returned with columns for individual hyperparameters.  Default is
<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code>list</code> containing the names of all hyperparameters and
their associated values, or a new wider <code>data.frame</code>.
</p>

<hr>
<h2 id='hyperRisk'>Summarize Cross-Validated Risks by Class with Hyperparameter</h2><span id='topic+hyperRisk'></span>

<h3>Description</h3>

<p><code>hyperRisk()</code> groups together estimators of the
same class and parses the hyperparameter values over quantiles of the risk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hyperRisk(dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hyperRisk_+3A_dat">dat</code></td>
<td>
<p>The <code><a href="tibble.html#topic+tibble">tibble</a></code> of cross-validated risk calculations
which is output by <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code>list</code> of data frames. Each list element corresponds to
a <code><a href="tibble.html#topic+tibble">tibble</a></code> of summary statistics for a specific
estimator class. If no estimators have hyper-parameters, a message is
returned.
</p>

<hr>
<h2 id='is.cvCovEst'>Check for cvCovEst Class</h2><span id='topic+is.cvCovEst'></span>

<h3>Description</h3>

<p><code>is.cvCovEst()</code> provides a generic method for checking if
input is of class <code>cvCovEst</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.cvCovEst(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.cvCovEst_+3A_x">x</code></td>
<td>
<p>The specific object to test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>logical</code> indicating <code>TRUE</code> if <code>x</code> inherits from
class <code>cvCovEst</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cv_dat &lt;- cvCovEst(
  dat = mtcars,
  estimators = c(
    thresholdingEst, sampleCovEst
  ),
  estimator_params = list(
    thresholdingEst = list(gamma = seq(0.1, 0.3, 0.1))
  ),
  center = TRUE,
  scale = TRUE
)

is.cvCovEst(cv_dat)
</code></pre>

<hr>
<h2 id='linearShrinkEst'>Linear Shrinkage Estimator</h2><span id='topic+linearShrinkEst'></span>

<h3>Description</h3>

<p><code>linearShrinkEst()</code> computes the linear shrinkage estimate
of the covariance matrix for a given value of <code>alpha</code>. The linear
shrinkage estimator is defined as the convex combination of the sample
covariance matrix and the identity matrix. The choice of <code>alpha</code>
determines the bias-variance tradeoff of the estimators in this class:
values near 1 are more likely to exhibit high variance but low bias, and
values near 0 are more likely to be be very biased but have low variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linearShrinkEst(dat, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="linearShrinkEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="linearShrinkEst_+3A_alpha">alpha</code></td>
<td>
<p>A <code>numeric</code> between 0 and 1 defining convex combinations
of the sample covariance matrix and the identity. <code>alpha = 1</code> produces
the sample covariance matrix, and <code>alpha = 0</code> returns the identity.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>linearShrinkEst(dat = mtcars, alpha = 0.1)
</code></pre>

<hr>
<h2 id='linearShrinkLWEst'>Ledoit-Wolf Linear Shrinkage Estimator</h2><span id='topic+linearShrinkLWEst'></span>

<h3>Description</h3>

<p><code>linearShrinkLWEst()</code> computes an asymptotically optimal
convex combination of the sample covariance matrix and the identity matrix.
This convex combination effectively shrinks the eigenvalues of the sample
covariance matrix towards the identity. This estimator is more accurate
than the sample covariance matrix in high-dimensional settings under fairly
loose assumptions. For more information, consider reviewing the manuscript
by Ledoit and Wolf (2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linearShrinkLWEst(dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="linearShrinkLWEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the Ledoit-Wolf linear shrinkage
estimate of the covariance matrix.
</p>


<h3>References</h3>

<p>Ledoit O, Wolf M (2004).
&ldquo;A well-conditioned estimator for large-dimensional covariance matrices.&rdquo;
<em>Journal of Multivariate Analysis</em>, <b>88</b>(2), 365 - 411.
ISSN 0047-259X, <a href="https://doi.org/10.1016/S0047-259X%2803%2900096-4">doi:10.1016/S0047-259X(03)00096-4</a>, <a href="https://www.sciencedirect.com/science/article/pii/S0047259X03000964">https://www.sciencedirect.com/science/article/pii/S0047259X03000964</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>linearShrinkLWEst(dat = mtcars)
</code></pre>

<hr>
<h2 id='matrixMetrics'>General Matrix Metrics</h2><span id='topic+matrixMetrics'></span>

<h3>Description</h3>

<p><code>matrixMetrics</code> computes the condition number, sparsity,
and sign of a covariance matrix estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrixMetrics(estimate)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="matrixMetrics_+3A_estimate">estimate</code></td>
<td>
<p>A <code>matrix</code> corresponding to a covariance matrix
estimate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code>list</code> containing the three values.
</p>

<hr>
<h2 id='multiHyperRisk'>Multi-Hyperparameter Risk Plots</h2><span id='topic+multiHyperRisk'></span>

<h3>Description</h3>

<p><code>multiHyperRisk()</code> produces plots of the cross-validated
risk for estimators with more than one hyperparameter.  The function
transforms one of the hyperparameters into a factor and uses it to
distinguish between the risk of various estimators.  If one of the
hyperparameters has only one unique value, that hyperparameter is used as
the factor variable.  If all hyperparameters have only one unique value, a
plot is not generated for that estimator class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiHyperRisk(dat, estimator, switch_vars = FALSE, min_max = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiHyperRisk_+3A_dat">dat</code></td>
<td>
<p>A <code>data.frame</code> of cross-validated risks. Specifically, this
is the <code>risk_df</code> table output by <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="multiHyperRisk_+3A_estimator">estimator</code></td>
<td>
<p>A <code>character</code> vector specifying one or more classes of
estimators to compare.</p>
</td></tr>
<tr><td><code id="multiHyperRisk_+3A_switch_vars">switch_vars</code></td>
<td>
<p>A <code>logical</code> indicating if the x-axis and factor
variables should be switched.  Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="multiHyperRisk_+3A_min_max">min_max</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>, only the minimum and
maximum values of the factor hyperparameter will be used. Defaults to
<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code>list</code> of plots.
</p>

<hr>
<h2 id='nlShrinkLWEst'>Analytical Non-Linear Shrinkage Estimator</h2><span id='topic+nlShrinkLWEst'></span>

<h3>Description</h3>

<p><code>nlShrinkLWEst()</code> invokes the analytical estimator
presented by Ledoit and Wolf (2018) for applying a
nonlinear shrinkage function to the sample eigenvalues of the covariance
matrix. The shrinkage function relies on an application of the Hilbert
Transform to an estimate of the sample eigenvalues' limiting spectral
density. This estimated density is computed with the Epanechnikov kernel
using a global bandwidth parameter of <code>n^(-1/3)</code>. The resulting
shrinkage function pulls eigenvalues towards the nearest mode of their
empirical distribution, thus creating a localized shrinkage effect rather
than a global one.
</p>
<p>We do not recommend that this estimator be employed when
the estimand is the correlation matrix. The diagonal entries of the
resulting estimate are not guaranteed to be equal to one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlShrinkLWEst(dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nlShrinkLWEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.
</p>


<h3>References</h3>

<p>Ledoit O, Wolf M (2018).
&ldquo;Analytical nonlinear shrinkage of large-dimensional covariance matrices.&rdquo;
Technical Report 264, Department of Economics - University of Zurich.
<a href="https://EconPapers.repec.org/RePEc:zur:econwp:264">https://EconPapers.repec.org/RePEc:zur:econwp:264</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nlShrinkLWEst(dat = mtcars)
</code></pre>

<hr>
<h2 id='plot.cvCovEst'>Generic Plot Method for cvCovEst</h2><span id='topic+plot.cvCovEst'></span>

<h3>Description</h3>

<p>The <code>plot</code> method is a generic method for plotting objects
of class, <code>"cvCovEst"</code>.  The method is designed as a tool for diagnostic
and exploratory analysis purposes when selecting a covariance matrix
estimator using <code>cvCovEst</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cvCovEst'
plot(
  x,
  dat_orig,
  estimator = NULL,
  plot_type = c("summary"),
  stat = c("min"),
  k = NULL,
  leading = TRUE,
  abs_v = TRUE,
  switch_vars = FALSE,
  min_max = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cvCovEst_+3A_x">x</code></td>
<td>
<p>An object of class, <code>"cvCovEst"</code>.  Specifically, this is the
standard output of the function <code>cvCovEst</code>.</p>
</td></tr>
<tr><td><code id="plot.cvCovEst_+3A_dat_orig">dat_orig</code></td>
<td>
<p>The <code>numeric data.frame</code>, <code>matrix</code>, or similar
object originally passed to <code>cvCovEst</code>.</p>
</td></tr>
<tr><td><code id="plot.cvCovEst_+3A_estimator">estimator</code></td>
<td>
<p>A <code>character</code> vector specifying one or more classes of
estimators to compare.  If <code>NULL</code>, the class of estimator associated
with optimal <code>cvCovEst</code> selection is used.</p>
</td></tr>
<tr><td><code id="plot.cvCovEst_+3A_plot_type">plot_type</code></td>
<td>
<p>A <code>character</code> vector specifying one of four choices of
diagnostic plots.  Default is <code>"summary"</code>.  See Details for more about
each plotting choice.</p>
</td></tr>
<tr><td><code id="plot.cvCovEst_+3A_stat">stat</code></td>
<td>
<p>A <code>character</code> vector of one or more summary statistics to
use when comparing estimators.  Default is <code>"min"</code> for minimum
cross-validated risk.  See Details for more options.</p>
</td></tr>
<tr><td><code id="plot.cvCovEst_+3A_k">k</code></td>
<td>
<p>A <code>integer</code> indicating the number of leading/trailing
eigenvalues to plot. If <code>NULL</code>, will default to the number of columns
in <code>dat_orig</code>.</p>
</td></tr>
<tr><td><code id="plot.cvCovEst_+3A_leading">leading</code></td>
<td>
<p>A <code>logical</code> indicating if the leading eigenvalues should
be used.  Default is <code>TRUE</code>.  If <code>FALSE</code>, the trailing eigenvalues
are used instead.</p>
</td></tr>
<tr><td><code id="plot.cvCovEst_+3A_abs_v">abs_v</code></td>
<td>
<p>A <code>logical</code> determining if the absolute value of the matrix
entries should be used for plotting the matrix heat map.  Default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.cvCovEst_+3A_switch_vars">switch_vars</code></td>
<td>
<p>A <code>logical</code>. If <code>TRUE</code>, the hyperparameters used
for the x-axis and factor variables are switched in the plot of the
cross-validated risk.  Only applies to estimators with more than one
hyperparameter. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.cvCovEst_+3A_min_max">min_max</code></td>
<td>
<p>A <code>logical</code>.  If <code>TRUE</code>, only the minimum and
maximum values of the factor hyperparameter will be used.  Only applies to
estimators with more than one hyperparameter. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.cvCovEst_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the plot method.  These are not
explicitly used and should be ignored by the user.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot method is designed to aide users in understanding the
estimation procedure carried out in <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>. There are
currently four different values for <code>plot_type</code> that can be called:
</p>

<ul>
<li> <p><code>"eigen"</code> - Plots the eigenvalues associated with the
specified <code>estimator</code> and <code>stat</code> arguments in decreasing
order.
</p>
</li>
<li> <p><code>"risk"</code> - Plots the cross-validated risk of the specified
<code>estimator</code> as a function of the hyperparameter values passed to
<code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.  This type of plot is only compatible with
estimators which take hyperparameters as arguments.
</p>
</li>
<li> <p><code>"heatmap"</code> - Plots a covariance heat map associated with the
specified <code>estimator</code> and <code>stat</code> arguments.  Multiple
estimators and performance stats may be specified to produce grids of
heat maps.
</p>
</li>
<li> <p><code>"summary"</code> - Specifying this plot type will run all of the
above plots for the best performing estimator selected by
<code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.  These plots are then combined into a single
panel along with a table containing the best performing estimator
within each class.  If the optimal estimator selected by
<code><a href="#topic+cvCovEst">cvCovEst</a>()</code> does not have hyperparameters, then the risk
plot is replaced with a table displaying the minimum, first quartile,
median, third quartile, and maximum of the cross-validated risk
associated with each class of estimator.
</p>
</li></ul>

<p>The <code>stat</code> argument accepts five values.  They each correspond to a
summary statistic of the cross-validated risk distribution within a class
of estimator.  Possible values are:
</p>

<ul>
<li> <p><code>"min"</code> - minimum
</p>
</li>
<li> <p><code>"Q1"</code> - first quartile
</p>
</li>
<li> <p><code>"median"</code> - median
</p>
</li>
<li> <p><code>"Q3"</code> - third quartile
</p>
</li>
<li> <p><code>"max"</code> - maximum
</p>
</li></ul>



<h3>Value</h3>

<p>A plot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cv_dat &lt;- cvCovEst(
  dat = mtcars,
  estimators = c(
    thresholdingEst, sampleCovEst
  ),
  estimator_params = list(
    thresholdingEst = list(gamma = seq(0.1, 0.9, 0.1))
  )
)

plot(x = cv_dat, dat_orig = mtcars)
</code></pre>

<hr>
<h2 id='plotAdaptiveLassoEst'>Plot adaptiveLassoEst</h2><span id='topic+plotAdaptiveLassoEst'></span>

<h3>Description</h3>

<p><code>plotAdaptiveLassoEst()</code> performs actions specific to
plotting the cross-validated risk of the Adaptive LASSO estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAdaptiveLassoEst(dat, switch_vars = FALSE, min_max = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotAdaptiveLassoEst_+3A_dat">dat</code></td>
<td>
<p>A data table of cross-validated risks.  Specifically, this is the
<code>risk_df</code> table output by <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="plotAdaptiveLassoEst_+3A_switch_vars">switch_vars</code></td>
<td>
<p>A <code>logical</code> indicating if the x-axis and factor
variables should be switched.  Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plotAdaptiveLassoEst_+3A_min_max">min_max</code></td>
<td>
<p>A <code>logical</code>. Default is <code>FALSE</code>. If <code>TRUE</code>,
only the minimum and maximum values of the factor hyperparameter will be
used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot object
</p>

<hr>
<h2 id='plotPoetEst'>Plot poetEst</h2><span id='topic+plotPoetEst'></span>

<h3>Description</h3>

<p><code>plotPoetEst()</code> performs actions specific to plotting
the cross-validated risk of the POET estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPoetEst(dat, switch_vars = FALSE, min_max = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotPoetEst_+3A_dat">dat</code></td>
<td>
<p>A data table of cross-validated risks.  Specifically, this is the
<code>risk_df</code> table output by <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="plotPoetEst_+3A_switch_vars">switch_vars</code></td>
<td>
<p>A <code>logical</code> indicating if the x-axis and factor
variables should be switched.  Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plotPoetEst_+3A_min_max">min_max</code></td>
<td>
<p>A <code>logical</code>. Default is <code>FALSE</code>. If <code>TRUE</code>,
only the minimum and maximum values of the factor hyperparameter will be
used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot object
</p>

<hr>
<h2 id='plotRobustPoetEst'>Plot robustPoetEst</h2><span id='topic+plotRobustPoetEst'></span>

<h3>Description</h3>

<p><code>plotRobustPoetEst()</code> performs actions specific to plotting
the cross-validated risk of the Robust POET estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRobustPoetEst(dat, switch_vars = FALSE, min_max = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotRobustPoetEst_+3A_dat">dat</code></td>
<td>
<p>A data table of cross-validated risks.  Specifically, this is the
<code>risk_df</code> table output by <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="plotRobustPoetEst_+3A_switch_vars">switch_vars</code></td>
<td>
<p>A <code>logical</code> indicating if the x-axis and factor
variables should be switched.  Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plotRobustPoetEst_+3A_min_max">min_max</code></td>
<td>
<p>A <code>logical</code>. Default is <code>FALSE</code>. If <code>TRUE</code>,
only the minimum and maximum values of the factor hyperparameter will be
used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of plots
</p>

<hr>
<h2 id='poetEst'>POET Estimator</h2><span id='topic+poetEst'></span>

<h3>Description</h3>

<p><code>poetEst()</code> implements the Principal Orthogonal complEment
Thresholding (POET) estimator, a nonparametric, unobserved-factor-based
estimator of the covariance matrix (Fan et al. 2013). The
estimator is defined as the sum of the sample covariance matrix'
rank-<code>k</code> approximation and its post-thresholding principal orthogonal
complement. The hard thresholding function is used here, though others
could be used instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poetEst(dat, k, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="poetEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="poetEst_+3A_k">k</code></td>
<td>
<p>An <code>integer</code> indicating the number of unobserved latent
factors. Empirical evidence suggests that the POET estimator is robust to
overestimation of this hyperparameter (Fan et al. 2013). In
practice, it is therefore preferable to use larger values.</p>
</td></tr>
<tr><td><code id="poetEst_+3A_lambda">lambda</code></td>
<td>
<p>A non-negative <code>numeric</code> defining the amount of
thresholding applied to each element of sample covariance matrix's
orthogonal complement.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.
</p>


<h3>References</h3>

<p>Fan J, Liao Y, Mincheva M (2013).
&ldquo;Large covariance estimation by thresholding principal orthogonal complements.&rdquo;
<em>Journal of the Royal Statistical Society. Series B (Statistical Methodology)</em>, <b>75</b>(4), 603&ndash;680.
ISSN 13697412, 14679868, <a href="https://www.jstor.org/stable/24772450">https://www.jstor.org/stable/24772450</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>poetEst(dat = mtcars, k = 2L, lambda = 0.1)
</code></pre>

<hr>
<h2 id='robustPoetEst'>Robust POET Estimator for Elliptical Distributions</h2><span id='topic+robustPoetEst'></span>

<h3>Description</h3>

<p><code>robustPoetEst()</code> implements the robust version of
Principal Orthogonal complEment Thresholding (POET) estimator, a
nonparametric, unobserved-factor-based estimator of the covariance matrix
when the underlying distribution is elliptical
(Fan et al. 2018). The estimator is defined as the sum of the
sample covariance matrix's rank-<code>k</code> approximation and its
post-thresholding principal orthogonal complement. The rank-<code>k</code>
approximation is constructed from the sample covariance matrix, its leading
eigenvalues, and its leading eigenvectors.  The sample covariance matrix and
leading eigenvalues are initially estimated via an M-estimation procedure
and the marginal Kendall's tau estimator. The leading eigenvectors are
estimated using spatial Kendall's tau estimator. The hard thresholding
function is used to regularize the idiosyncratic errors' estimated
covariance matrix, though other regularization schemes could be used.
</p>
<p>We do not recommend that this estimator be employed when
the estimand is the correlation matrix. The diagonal entries of the
resulting estimate are not guaranteed to be equal to one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>robustPoetEst(dat, k, lambda, var_est = c("sample", "mad", "huber"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="robustPoetEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="robustPoetEst_+3A_k">k</code></td>
<td>
<p>An <code>integer</code> indicating the number of unobserved latent
factors. Empirical evidence suggests that the POET estimator is robust to
overestimation of this hyperparameter (Fan et al. 2013). In
practice, it is therefore preferable to use larger values.</p>
</td></tr>
<tr><td><code id="robustPoetEst_+3A_lambda">lambda</code></td>
<td>
<p>A non-negative <code>numeric</code> defining the amount of
thresholding applied to each element of sample covariance matrix's
orthogonal complement.</p>
</td></tr>
<tr><td><code id="robustPoetEst_+3A_var_est">var_est</code></td>
<td>
<p>A <code>character</code> dictating which variance estimator to
use. This must be one of the strings <code>"sample"</code>, <code>"mad"</code>, or
<code>"huber"</code>. <code>"sample"</code> uses sample variances; <code>"mad"</code>
estimates variances via median absolute deviation; <code>"huber"</code> uses an
M-estimator for variance under the Huber loss.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.
</p>


<h3>References</h3>

<p>Fan J, Liao Y, Mincheva M (2013).
&ldquo;Large covariance estimation by thresholding principal orthogonal complements.&rdquo;
<em>Journal of the Royal Statistical Society. Series B (Statistical Methodology)</em>, <b>75</b>(4), 603&ndash;680.
ISSN 13697412, 14679868, <a href="https://www.jstor.org/stable/24772450">https://www.jstor.org/stable/24772450</a>.<br /><br /> Fan J, Liu H, Wang W (2018).
&ldquo;Large covariance estimation through elliptical factor models.&rdquo;
<em>Ann. Statist.</em>, <b>46</b>(4), 1383&ndash;1414.
<a href="https://doi.org/10.1214/17-AOS1588">doi:10.1214/17-AOS1588</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>robustPoetEst(dat = mtcars, k = 2L, lambda = 0.1, var_est = "sample")
</code></pre>

<hr>
<h2 id='safeColScale'>Safe Centering and Scaling of Columns</h2><span id='topic+safeColScale'></span>

<h3>Description</h3>

<p><code>safeColScale()</code> is a safe utility for centering and
scaling an input matrix <code>X</code>. It is intended to avoid the drawback of
using <code><a href="base.html#topic+scale">scale</a>()</code> on data with constant variance by adding a
small perturbation to truncate the values in such columns. Also, this is
faster than <code><a href="base.html#topic+scale">scale</a>()</code> through relying on
'<span class="pkg">matrixStats</span> for a key internal computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safeColScale(
  X,
  center = TRUE,
  scale = TRUE,
  tol = .Machine$double.eps,
  eps = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="safeColScale_+3A_x">X</code></td>
<td>
<p>An input <code>matrix</code> to be centered and/or scaled. If <code>X</code> is
not of class <code>matrix</code>, then it must be coercible to such.</p>
</td></tr>
<tr><td><code id="safeColScale_+3A_center">center</code></td>
<td>
<p>A <code>logical</code> indicating whether to re-center the columns
of the input <code>X</code>.</p>
</td></tr>
<tr><td><code id="safeColScale_+3A_scale">scale</code></td>
<td>
<p>A <code>logical</code> indicating whether to re-scale the columns of
the input <code>X</code>.</p>
</td></tr>
<tr><td><code id="safeColScale_+3A_tol">tol</code></td>
<td>
<p>A tolerance level for the lowest column variance (or standard
deviation) value to be tolerated when scaling is desired. The default is
set to <code>double.eps</code> of machine precision <code><a href="base.html#topic+.Machine">.Machine</a></code>.</p>
</td></tr>
<tr><td><code id="safeColScale_+3A_eps">eps</code></td>
<td>
<p>The desired lower bound of the estimated variance for a given
column. When the lowest estimate falls below <code>tol</code>, it is truncated
to the value specified in this argument. The default is 0.01.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A centered and/or scaled version of the input data.
</p>


<h3>Note</h3>

<p>This is an un-exported function borrowed directly from <span class="pkg">scPCA</span>.
</p>

<hr>
<h2 id='sampleCovEst'>Sample Covariance Matrix</h2><span id='topic+sampleCovEst'></span>

<h3>Description</h3>

<p><code>sampleCovEst()</code> computes the sample covariance matrix.
This function is a simple wrapper around <code><a href="coop.html#topic+covar">covar</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleCovEst(dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sampleCovEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sampleCovEst(dat = mtcars)
</code></pre>

<hr>
<h2 id='scadEst'>Smoothly Clipped Absolute Deviation Estimator</h2><span id='topic+scadEst'></span>

<h3>Description</h3>

<p><code>scadEst()</code> applies the SCAD thresholding function of
Fan and Li (2001) to each entry of the sample
covariance matrix. This penalized estimator constitutes a compromise
between hard and soft thresholding of the sample covariance matrix: it is
a linear interpolation between soft thresholding up to <code>2 * lambda</code>
and hard thresholding after <code>3.7 * lambda</code>
(Rothman et al. 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scadEst(dat, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scadEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="scadEst_+3A_lambda">lambda</code></td>
<td>
<p>A non-negative <code>numeric</code> defining the degree of
thresholding applied to each element of <code>dat</code>'s sample covariance
matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.
</p>


<h3>References</h3>

<p>Fan J, Li R (2001).
&ldquo;Variable Selection via Nonconcave Penalized Likelihood and its Oracle Properties.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>96</b>(456), 1348-1360.
<a href="https://doi.org/10.1198/016214501753382273">doi:10.1198/016214501753382273</a>, https://doi.org/10.1198/016214501753382273.<br /><br /> Rothman AJ, Levina E, Zhu J (2009).
&ldquo;Generalized Thresholding of Large Covariance Matrices.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>104</b>(485), 177-186.
<a href="https://doi.org/10.1198/jasa.2009.0101">doi:10.1198/jasa.2009.0101</a>, https://doi.org/10.1198/jasa.2009.0101.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>scadEst(dat = mtcars, lambda = 0.2)
</code></pre>

<hr>
<h2 id='scadThreshold'>Smoothly Clipped Absolute Deviation Thresholding Function</h2><span id='topic+scadThreshold'></span>

<h3>Description</h3>

<p><code>scadThreshold()</code> applies the smoothly clipped absolute
deviation thresholding function to the entries of a <code>matrix</code>.
In particular, it is meant to be applied to the sample covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scadThreshold(entry, lambda, a)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scadThreshold_+3A_entry">entry</code></td>
<td>
<p>A <code>numeric</code> entry in a covariance matrix estimate.</p>
</td></tr>
<tr><td><code id="scadThreshold_+3A_lambda">lambda</code></td>
<td>
<p>A non-negative <code>numeric</code> defining the degree of
thresholding applied to each element of <code>dat</code>'s sample covariance
matrix.</p>
</td></tr>
<tr><td><code id="scadThreshold_+3A_a">a</code></td>
<td>
<p>A <code>numeric</code> larger than or equal to <code>2</code> defining the
point at which the SCAD thresholding functions becomes equal to the hard
thresholding function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A regularized <code>numeric</code>.
</p>

<hr>
<h2 id='scaleEigVals'>Extract Estimated Scaled Eigenvalues in Spiked Covariance Matrix Model</h2><span id='topic+scaleEigVals'></span>

<h3>Description</h3>

<p><code>scaleEigVals()</code> computes the scaled eigenvalues, and
filters out all eigenvalues that do not need to be shrunk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaleEigVals(eig_vals, noise, p_n_ratio, num_spikes)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scaleEigVals_+3A_eig_vals">eig_vals</code></td>
<td>
<p>A <code>numeric</code> vector of estimated eigenvalues.</p>
</td></tr>
<tr><td><code id="scaleEigVals_+3A_noise">noise</code></td>
<td>
<p><code>numeric</code> representing the known scalar multiple of the
identity matrix giving the approximate population covariance matrix.</p>
</td></tr>
<tr><td><code id="scaleEigVals_+3A_p_n_ratio">p_n_ratio</code></td>
<td>
<p>A <code>numeric</code> indicating the asymptotic ratio of the
number of features, p, and the number of observations, n. This ratio is
assumed to be between 0 and 1.</p>
</td></tr>
<tr><td><code id="scaleEigVals_+3A_num_spikes">num_spikes</code></td>
<td>
<p><code>numeric</code> integer equal to or larger than one which
providing the known number of spikes in the population covariance matrix.
If set to <code>NULL</code>, the number of spikes is estimated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>numeric</code> vector of the scaled eigenvalues to be shrunk.
</p>

<hr>
<h2 id='spikedFrobeniusShrinkEst'>Frobenius Norm Shrinkage Estimator, Spiked Covariance Model</h2><span id='topic+spikedFrobeniusShrinkEst'></span>

<h3>Description</h3>

<p><code>spikedFrobeniusShrinkEst()</code> implements the asymptotically
optimal shrinkage estimator with respect to the Frobenius loss in a spiked
covariance matrix model. Informally, this model admits Gaussian
data-generating processes whose covariance matrix is a scalar multiple of
the identity, save for a few number of large &quot;spikes&quot;. A thorough review of
this estimator, or more generally spiked covariance matrix estimation, is
provided in Donoho et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spikedFrobeniusShrinkEst(dat, p_n_ratio, num_spikes = NULL, noise = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spikedFrobeniusShrinkEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="spikedFrobeniusShrinkEst_+3A_p_n_ratio">p_n_ratio</code></td>
<td>
<p>A <code>numeric</code> between 0 and 1 representing the asymptotic
ratio of the number of features, p, and the number of observations, n.</p>
</td></tr>
<tr><td><code id="spikedFrobeniusShrinkEst_+3A_num_spikes">num_spikes</code></td>
<td>
<p>A <code>numeric</code> integer equal to or larger than one which
providing the known number of spikes in the population covariance matrix.
Defaults to <code>NULL</code>, indicating that this value is not known and must
be estimated.</p>
</td></tr>
<tr><td><code id="spikedFrobeniusShrinkEst_+3A_noise">noise</code></td>
<td>
<p>A <code>numeric</code> representing the known scalar multiple of the
identity matrix giving the approximate population covariance matrix.
Defaults to <code>NULL</code>, indicating that this values is not known and must
be estimated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the covariance matrix estimate.
</p>


<h3>References</h3>

<p>Donoho D, Gavish M, Johnstone I (2018).
&ldquo;Optimal shrinkage of eigenvalues in the spiked covariance model.&rdquo;
<em>The Annals of Statistics</em>, <b>46</b>(4), 1742 &ndash; 1778.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spikedFrobeniusShrinkEst(dat = mtcars, p_n_ratio = 0.1, num_spikes = 2L)

</code></pre>

<hr>
<h2 id='spikedOperatorShrinkEst'>Operator Norm Shrinkage Estimator, Spiked Covariance Model</h2><span id='topic+spikedOperatorShrinkEst'></span>

<h3>Description</h3>

<p><code>spikedOperatorShrinkEst()</code> implements the asymptotically
optimal shrinkage estimator with respect to the operator loss in a spiked
covariance matrix model. Informally, this model admits Gaussian
data-generating processes whose covariance matrix is a scalar multiple of
the identity, save for a few number of large &quot;spikes&quot;. A thorough review of
this estimator, or more generally spiked covariance matrix estimation, is
provided in Donoho et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spikedOperatorShrinkEst(dat, p_n_ratio, num_spikes = NULL, noise = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spikedOperatorShrinkEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="spikedOperatorShrinkEst_+3A_p_n_ratio">p_n_ratio</code></td>
<td>
<p>A <code>numeric</code> between 0 and 1 representing the asymptotic
ratio of the number of features, p, and the number of observations, n.</p>
</td></tr>
<tr><td><code id="spikedOperatorShrinkEst_+3A_num_spikes">num_spikes</code></td>
<td>
<p>A <code>numeric</code> integer equal to or larger than one which
providing the known number of spikes in the population covariance matrix.
Defaults to <code>NULL</code>, indicating that this value is not known and must
be estimated.</p>
</td></tr>
<tr><td><code id="spikedOperatorShrinkEst_+3A_noise">noise</code></td>
<td>
<p>A <code>numeric</code> representing the known scalar multiple of the
identity matrix giving the approximate population covariance matrix.
Defaults to <code>NULL</code>, indicating that this values is not known and must
be estimated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the covariance matrix estimate.
</p>


<h3>References</h3>

<p>Donoho D, Gavish M, Johnstone I (2018).
&ldquo;Optimal shrinkage of eigenvalues in the spiked covariance model.&rdquo;
<em>The Annals of Statistics</em>, <b>46</b>(4), 1742 &ndash; 1778.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spikedOperatorShrinkEst(dat = mtcars, p_n_ratio = 0.1, num_spikes = 2L)

</code></pre>

<hr>
<h2 id='spikedSteinShrinkEst'>Stein Loss Shrinkage Estimator, Spiked Covariance Model</h2><span id='topic+spikedSteinShrinkEst'></span>

<h3>Description</h3>

<p><code>spikedSteinShrinkEst()</code> implements the asymptotically
optimal shrinkage estimator with respect to the Stein loss in a spiked
covariance matrix model. Informally, this model admits Gaussian
data-generating processes whose covariance matrix is a scalar multiple of
the identity, save for a few number of large &quot;spikes&quot;. A thorough review of
this estimator, or more generally spiked covariance matrix estimation, is
provided in Donoho et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spikedSteinShrinkEst(dat, p_n_ratio, num_spikes = NULL, noise = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spikedSteinShrinkEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="spikedSteinShrinkEst_+3A_p_n_ratio">p_n_ratio</code></td>
<td>
<p>A <code>numeric</code> between 0 and 1 representing the asymptotic
ratio of the number of features, p, and the number of observations, n.</p>
</td></tr>
<tr><td><code id="spikedSteinShrinkEst_+3A_num_spikes">num_spikes</code></td>
<td>
<p>A <code>numeric</code> integer equal to or larger than one which
providing the known number of spikes in the population covariance matrix.
Defaults to <code>NULL</code>, indicating that this value is not known and must
be estimated.</p>
</td></tr>
<tr><td><code id="spikedSteinShrinkEst_+3A_noise">noise</code></td>
<td>
<p>A <code>numeric</code> representing the known scalar multiple of the
identity matrix giving the approximate population covariance matrix.
Defaults to <code>NULL</code>, indicating that this values is not known and must
be estimated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the covariance matrix estimate.
</p>


<h3>References</h3>

<p>Donoho D, Gavish M, Johnstone I (2018).
&ldquo;Optimal shrinkage of eigenvalues in the spiked covariance model.&rdquo;
<em>The Annals of Statistics</em>, <b>46</b>(4), 1742 &ndash; 1778.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spikedFrobeniusShrinkEst(dat = mtcars, p_n_ratio = 0.1, num_spikes = 2L)

</code></pre>

<hr>
<h2 id='strToNumber'>Convert String to Numeric or Integer When Needed</h2><span id='topic+strToNumber'></span>

<h3>Description</h3>

<p>Convert String to Numeric or Integer When Needed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strToNumber(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strToNumber_+3A_x">x</code></td>
<td>
<p>A <code>character</code> representing a number or an integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code> converted to the appropriate type.
</p>

<hr>
<h2 id='summary.cvCovEst'>Generic Summary Method for cvCovEst</h2><span id='topic+summary.cvCovEst'></span>

<h3>Description</h3>

<p><code>summary()</code> provides summary statistics regarding
the performance of <code><a href="#topic+cvCovEst">cvCovEst</a>()</code> and can be used for diagnostic
plotting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cvCovEst'
summary(
  object,
  dat_orig,
  summ_fun = c("cvRiskByClass", "bestInClass", "worstInClass", "hyperRisk"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.cvCovEst_+3A_object">object</code></td>
<td>
<p>A named <code>list</code> of class <code>"cvCovEst"</code>.</p>
</td></tr>
<tr><td><code id="summary.cvCovEst_+3A_dat_orig">dat_orig</code></td>
<td>
<p>The <code>numeric data.frame</code>, <code>matrix</code>, or similar
object originally passed to <code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.</p>
</td></tr>
<tr><td><code id="summary.cvCovEst_+3A_summ_fun">summ_fun</code></td>
<td>
<p>A <code>character</code> vector specifying which summaries to
output.  See Details for function descriptions.</p>
</td></tr>
<tr><td><code id="summary.cvCovEst_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>summary()</code>These are not
explicitly used and should be ignored by the user.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary()</code> accepts four different choices for the
<code>summ_fun</code> argument.  The choices are:
</p>

<ul>
<li> <p><code>"cvRiskByClass"</code> - Returns the minimum, first quartile,
median, third quartile, and maximum of the cross-validated risk
associated with each class of estimator passed to
<code><a href="#topic+cvCovEst">cvCovEst</a>()</code>.
</p>
</li>
<li> <p><code>"bestInClass"</code> - Returns the specific hyperparameters, if
applicable, of the best performing estimator within each class along
with other metrics.
</p>
</li>
<li> <p><code>"worstInClass"</code> - Returns the specific hyperparameters, if
applicable, of the worst performing estimator within each class along
with other metrics.
</p>
</li>
<li> <p><code>"hyperRisk"</code> - For estimators that take hyperparameters as
arguments, this function returns the hyperparameters associated with
the minimum, first quartile, median, third quartile, and maximum of the
cross-validated risk within each class of estimator. Each class has
its own <code><a href="tibble.html#topic+tibble">tibble</a></code>, which are returned as a
<code>list</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A named <code>list</code> where each element corresponds to the output of
of the requested summaries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cv_dat &lt;- cvCovEst(
  dat = mtcars,
  estimators = c(
    linearShrinkEst, thresholdingEst, sampleCovEst
  ),
  estimator_params = list(
    linearShrinkEst = list(alpha = seq(0.1, 0.9, 0.1)),
    thresholdingEst = list(gamma = seq(0.1, 0.9, 0.1))
  ),
  center = TRUE,
  scale = TRUE
)

summary(cv_dat, mtcars)
</code></pre>

<hr>
<h2 id='taperingEst'>Tapering Estimator</h2><span id='topic+taperingEst'></span>

<h3>Description</h3>

<p><code>taperingEst()</code> estimates the covariance matrix of a
<code>data.frame</code>-like object with ordered variables by gradually shrinking
the bands of the sample covariance matrix towards zero. The estimator is
defined as the Hadamard product of the sample covariance matrix and a
weight matrix. The amount of shrinkage is dictated by the weight matrix
and is specified by a hyperparameter <code>k</code>. This estimator is attributed
to Cai et al. (2010).
</p>
<p>The weight matrix is a Toeplitz matrix with entries defined as follows. Let
i and j index the rows and columns of the weight matrix, respectively. If
<code>abs(i - j) &lt;= k / 2</code>, then entry {i, j} in the weight matrix is
equal to 1. If <code>k / 2 &lt; abs(i - j) &lt; k</code>, then entry {i, j} is equal
to <code>2 - 2 * abs(i - j) / k</code>. Otherwise, entry {i, j} is equal to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taperingEst(dat, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="taperingEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="taperingEst_+3A_k">k</code></td>
<td>
<p>A non-negative, even <code>numeric</code> integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.
</p>


<h3>References</h3>

<p>Cai TT, Zhang C, Zhou HH (2010).
&ldquo;Optimal rates of convergence for covariance matrix estimation.&rdquo;
<em>Ann. Statist.</em>, <b>38</b>(4), 2118&ndash;2144.
<a href="https://doi.org/10.1214/09-AOS752">doi:10.1214/09-AOS752</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>taperingEst(dat = mtcars, k = 0.1)
</code></pre>

<hr>
<h2 id='theme_cvCovEst'>cvCovEst Plot Theme</h2><span id='topic+theme_cvCovEst'></span>

<h3>Description</h3>

<p><code>theme_cvCovEst()</code> defines the overall theme of the
<code>cvCovEst</code> package plotting functions and makes changes depending on
which plot function is being called.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_cvCovEst(plot_type, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="theme_cvCovEst_+3A_plot_type">plot_type</code></td>
<td>
<p>A <code>character</code> vector specifying which plot is to be
displayed. Can contain more than one value in the case of
<code>plot_type = c("heatmap", "summary")</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> theme.
</p>

<hr>
<h2 id='thresholdingEst'>Hard Thresholding Estimator</h2><span id='topic+thresholdingEst'></span>

<h3>Description</h3>

<p><code>thresholdingEst()</code> computes the hard thresholding estimate
of the covariance matrix for a given value of <code>gamma</code>. The threshold
estimator of the covariance matrix applies a hard thresholding operator to
each element of the sample covariance matrix. For more information on this
estimator, review Bickel and Levina (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thresholdingEst(dat, gamma)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thresholdingEst_+3A_dat">dat</code></td>
<td>
<p>A numeric <code>data.frame</code>, <code>matrix</code>, or similar object.</p>
</td></tr>
<tr><td><code id="thresholdingEst_+3A_gamma">gamma</code></td>
<td>
<p>A non-negative <code>numeric</code> defining the degree of hard
thresholding applied to each element of <code>dat</code>'s sample covariance
matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> corresponding to the estimate of the covariance
matrix.
</p>


<h3>References</h3>

<p>Bickel PJ, Levina E (2008).
&ldquo;Covariance regularization by thresholding.&rdquo;
<em>Annals of Statistics</em>, <b>36</b>(6), 2577&ndash;2604.
<a href="https://doi.org/10.1214/08-AOS600">doi:10.1214/08-AOS600</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>thresholdingEst(dat = mtcars, gamma = 0.2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
