<!DOCTYPE html><html lang="en-GB"><head><title>Help for package cusum</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cusum}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cusum'><p>Non-risk-adjusted CUSUM Charts</p></a></li>
<li><a href='#calc_cusum'><p>Calculate CUSUM</p></a></li>
<li><a href='#cusum_alpha_sim'><p>Simulate false signal probability alpha given control limit for CUSUM charts</p></a></li>
<li><a href='#cusum_example_data'><p>Non-Risk-adjusted Performance Data</p></a></li>
<li><a href='#cusum_limit_exact'><p>Calculate exact control limit given false signal probability alpha for CUSUM charts for very small sample sizes</p></a></li>
<li><a href='#cusum_limit_sim'><p>Simulate control limit given false signal probability alpha for CUSUM charts</p></a></li>
<li><a href='#gscusum'><p>Group-sequential CUSUM chart</p></a></li>
<li><a href='#gscusum_example_data'><p>Group-sequential Non-Risk-adjusted Performance Data with Block Identifier</p></a></li>
<li><a href='#make_all_outcomes'><p>Make all outcomes</p></a></li>
<li><a href='#plot.cusum'><p>Plot CUSUM chart for a cusum Object</p></a></li>
<li><a href='#racusum'><p>Risk-adjusted CUSUM Charts</p></a></li>
<li><a href='#racusum_alpha_sim'><p>Simulate false signal probability alpha given control limit for RA-CUSUM charts</p></a></li>
<li><a href='#racusum_example_data'><p>Risk-adjusted Performance Data</p></a></li>
<li><a href='#racusum_limit_dpcl'><p>Dynamic Probability Control Limits (DPCL)</p></a></li>
<li><a href='#racusum_limit_sim'><p>Simulate control limit given false signal probability alpha for RA-CUSUM charts</p></a></li>
<li><a href='#ragscusum'><p>RA-Grouped-CUSUM chart</p></a></li>
<li><a href='#ragscusum_example_data'><p>Group-sequential Risk-adjusted Performance Data with Block Identifier</p></a></li>
<li><a href='#weights_t'><p>Weights for observations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Cumulative Sum (CUSUM) Charts for Monitoring of Hospital
Performance</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-10-02</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for constructing and evaluating
    CUSUM charts and RA-CUSUM charts with focus on false signal probability. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, checkmate, data.table, Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, ggplot2, rmarkdown</td>
</tr>
<tr>
<td>Enhances:</td>
<td>vdiffr, covr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-02 08:07:45 UTC; schneiderheinze</td>
</tr>
<tr>
<td>Author:</td>
<td>Lena Hubig <a href="https://orcid.org/0000-0002-9454-1232"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lena Hubig &lt;cs@lenahubig.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-02 09:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='cusum'>Non-risk-adjusted CUSUM Charts</h2><span id='topic+cusum'></span><span id='topic+cusum-package'></span>

<h3>Description</h3>

<p>Calculate non-risk-adjusted CUSUM charts for performance data
</p>
<p>Provides functions for constructing and evaluating CUSUM charts and RA-CUSUM charts with focus on false signal probability in health care processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cusum(failure_probability, patient_outcomes, limit, weights = NULL,
  odds_multiplier = 2, reset = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cusum_+3A_failure_probability">failure_probability</code></td>
<td>
<p>Double. Baseline failure probability</p>
</td></tr>
<tr><td><code id="cusum_+3A_patient_outcomes">patient_outcomes</code></td>
<td>
<p>Integer. Vector of binary patient outcomes (0,1)</p>
</td></tr>
<tr><td><code id="cusum_+3A_limit">limit</code></td>
<td>
<p>Double. Control limit for signalling performance change</p>
</td></tr>
<tr><td><code id="cusum_+3A_weights">weights</code></td>
<td>
<p>Double. Optional vector of weights, if empty, standard CUSUM weights are calculated with weights_t</p>
</td></tr>
<tr><td><code id="cusum_+3A_odds_multiplier">odds_multiplier</code></td>
<td>
<p>Double. Odds multiplier of adverse event under the alternative hypothesis (&lt;1 looks for decreases)</p>
</td></tr>
<tr><td><code id="cusum_+3A_reset">reset</code></td>
<td>
<p>Logical. Reset the CUSUM after a signal to 0; defaults to TRUE</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Lena Hubig
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# control limit can be obtained with cusum_limit_sim(),
# here it is set to an arbitrary value (2.96)

# CUSUM of in-control process
# simulate patient outcomes
set.seed(2046)
patient_outcomes &lt;- as.logical(rbinom(n = 100, size = 1, prob = 0.05))


cs_ic &lt;- cusum(
  failure_probability = 0.05,
  patient_outcomes,
  limit = 2.96
)

# CUSUM of out-of-control process
# simulate patient outcome
set.seed(2046)
patient_outcomes &lt;- as.logical(rbinom(n = 100, size = 1, prob = 0.2))

cs_oc &lt;- cusum(
  failure_probability = 0.05,
  patient_outcomes,
  limit = 2.96
)
</code></pre>

<hr>
<h2 id='calc_cusum'>Calculate CUSUM</h2><span id='topic+calc_cusum'></span>

<h3>Description</h3>

<p>This function calculates the CUSUM chart for the given sequence of successes and failures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_cusum(x, c0, cA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_cusum_+3A_x">x</code></td>
<td>
<p>vector of outcomes</p>
</td></tr>
<tr><td><code id="calc_cusum_+3A_c0">c0</code></td>
<td>
<p>accepted failure probability</p>
</td></tr>
<tr><td><code id="calc_cusum_+3A_ca">cA</code></td>
<td>
<p>smallest detectable failure probability</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns matrix of possible sequences
</p>

<hr>
<h2 id='cusum_alpha_sim'>Simulate false signal probability alpha given control limit for CUSUM charts</h2><span id='topic+cusum_alpha_sim'></span>

<h3>Description</h3>

<p>Simulate false signal probability alpha given control limit for CUSUM charts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cusum_alpha_sim(failure_probability, n_patients, odds_multiplier,
  n_simulation, limit, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cusum_alpha_sim_+3A_failure_probability">failure_probability</code></td>
<td>
<p>Double. Baseline failure probability</p>
</td></tr>
<tr><td><code id="cusum_alpha_sim_+3A_n_patients">n_patients</code></td>
<td>
<p>Integer. Number of patients in monitoring period /sample size</p>
</td></tr>
<tr><td><code id="cusum_alpha_sim_+3A_odds_multiplier">odds_multiplier</code></td>
<td>
<p>Double. Odds multiplier of adverse event under the alternative hypothesis (&lt;1 looks for decreases)</p>
</td></tr>
<tr><td><code id="cusum_alpha_sim_+3A_n_simulation">n_simulation</code></td>
<td>
<p>Integer. Number of simulation runs</p>
</td></tr>
<tr><td><code id="cusum_alpha_sim_+3A_limit">limit</code></td>
<td>
<p>Double. Control limit for signalling performance change</p>
</td></tr>
<tr><td><code id="cusum_alpha_sim_+3A_seed">seed</code></td>
<td>
<p>Integer. Seed for RNG</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns False signal probability of specified CUSUM chart.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#
# control limit can be obtained with cusum_limit_sim(),
# here it is set to an arbitrary value (2.96)

# simulate false positive probability of CUSUM
cusum_alpha_sim(
  failure_probability = 0.05,
  n_patients = 100,
  odds_multiplier = 2,
  n_simulation = 10000,
  limit = 2.96,
  seed = 2046
)
</code></pre>

<hr>
<h2 id='cusum_example_data'>Non-Risk-adjusted Performance Data</h2><span id='topic+cusum_example_data'></span>

<h3>Description</h3>

<p>Generated performance data of indicator 17/1 54030: Preoperative stay over 24 hours for patients with proximal femur fracture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cusum_example_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 2000 rows and 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>Sequence of observations</p>
</dd>
<dt>y</dt><dd><p>Patient outcome</p>
</dd>
<dt>year</dt><dd><p>Year of treatment</p>
</dd>
</dl>


<h3>Details</h3>

<p>Patient outcomes were simulated based on average national failure rate. Two years are provided, so Phase I and Phase II can be defined.
</p>


<h3>Source</h3>

<p>Data for simulation was provided by Bavarian Agency of Quality Assurance (BAQ), Munich Germany.
</p>
<p>Description of performance indicator (in German): <a href="https://iqtig.org/downloads/auswertung/2016/17n1hftfrak/QSKH_17n1-HUEFTFRAK_2016_QIDB_V02_2017-04-26.pdf">https://iqtig.org/downloads/auswertung/2016/17n1hftfrak/QSKH_17n1-HUEFTFRAK_2016_QIDB_V02_2017-04-26.pdf</a>
</p>

<hr>
<h2 id='cusum_limit_exact'>Calculate exact control limit given false signal probability alpha for CUSUM charts for very small sample sizes</h2><span id='topic+cusum_limit_exact'></span>

<h3>Description</h3>

<p>This function only works for very small sample sizes (&lt;= 15),
as it permutes through all possible outcome sequences and estimates the percentage of runs that reach a specific CUSUM values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cusum_limit_exact(n_patients, failure_probability, odds_multiplier, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cusum_limit_exact_+3A_n_patients">n_patients</code></td>
<td>
<p>Integer. Number of patients in monitoring period /sample size</p>
</td></tr>
<tr><td><code id="cusum_limit_exact_+3A_failure_probability">failure_probability</code></td>
<td>
<p>Double. Baseline failure probability</p>
</td></tr>
<tr><td><code id="cusum_limit_exact_+3A_odds_multiplier">odds_multiplier</code></td>
<td>
<p>Double. Odds multiplier of adverse event under the alternative hypothesis (&lt;1 looks for decreases)</p>
</td></tr>
<tr><td><code id="cusum_limit_exact_+3A_alpha">alpha</code></td>
<td>
<p>Double. False signal probability of CUSUM</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the control limit for signalling performance change for small sample sizes (double)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# calculate exact control limits for alpha = 0.05
cusum_limit_exact(
  failure_probability = 0.1,
  n_patients = 10,
  odds_multiplier = 2,
  alpha = 0.05
)
</code></pre>

<hr>
<h2 id='cusum_limit_sim'>Simulate control limit given false signal probability alpha for CUSUM charts</h2><span id='topic+cusum_limit_sim'></span>

<h3>Description</h3>

<p>Simulate control limit given false signal probability alpha for CUSUM charts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cusum_limit_sim(failure_probability, n_patients, odds_multiplier,
  n_simulation, alpha, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cusum_limit_sim_+3A_failure_probability">failure_probability</code></td>
<td>
<p>Double. Baseline failure probability</p>
</td></tr>
<tr><td><code id="cusum_limit_sim_+3A_n_patients">n_patients</code></td>
<td>
<p>Integer. Number of patients in monitoring period /sample size</p>
</td></tr>
<tr><td><code id="cusum_limit_sim_+3A_odds_multiplier">odds_multiplier</code></td>
<td>
<p>Double. Odds multiplier of adverse event under the alternative hypothesis (&lt;1 looks for decreases)</p>
</td></tr>
<tr><td><code id="cusum_limit_sim_+3A_n_simulation">n_simulation</code></td>
<td>
<p>Integer. Number of simulation runs</p>
</td></tr>
<tr><td><code id="cusum_limit_sim_+3A_alpha">alpha</code></td>
<td>
<p>Double. False signal probability of CUSUM</p>
</td></tr>
<tr><td><code id="cusum_limit_sim_+3A_seed">seed</code></td>
<td>
<p>Integer. Seed for RNG</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the control limit for signalling performance change (double)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# simulate control limits for alpha = 0.05
cusum_limit_sim(
  failure_probability = 0.05,
  n_patients = 100,
  odds_multiplier = 2,
  n_simulation = 1000,
  alpha = 0.05,
  seed = 2046
)
</code></pre>

<hr>
<h2 id='gscusum'>Group-sequential CUSUM chart</h2><span id='topic+gscusum'></span>

<h3>Description</h3>

<p>Calculate GSCUSUM chart for non-risk-adjusted processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gscusum(input_outcomes, failure_probability, odds_multiplier, limit,
  quantiles, max_num_shuffles = 10000L, seed = 0L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gscusum_+3A_input_outcomes">input_outcomes</code></td>
<td>
<p>Matrix. First column are binary patient outcomes (0,1). Second column are continuous sequence of block identifier.</p>
</td></tr>
<tr><td><code id="gscusum_+3A_failure_probability">failure_probability</code></td>
<td>
<p>Double. Baseline failure probability</p>
</td></tr>
<tr><td><code id="gscusum_+3A_odds_multiplier">odds_multiplier</code></td>
<td>
<p>Double. Odds multiplier of adverse event under the alternative hypothesis (&lt;1 looks for decreases)</p>
</td></tr>
<tr><td><code id="gscusum_+3A_limit">limit</code></td>
<td>
<p>Double. Control limit for signalling performance change</p>
</td></tr>
<tr><td><code id="gscusum_+3A_quantiles">quantiles</code></td>
<td>
<p>Double. Vector of requested quantiles of GSCUSUM distribution</p>
</td></tr>
<tr><td><code id="gscusum_+3A_max_num_shuffles">max_num_shuffles</code></td>
<td>
<p>Integer. Number of shuffles (i.e. different sequences of observations)</p>
</td></tr>
<tr><td><code id="gscusum_+3A_seed">seed</code></td>
<td>
<p>Integer. Seed for RNG (if = 0 random seed is set (default))</p>
</td></tr>
</table>


<h3>Value</h3>

<p>gscusum matrix, signal probability, average CUSUM value and specified quantiles for every observation.
</p>

<hr>
<h2 id='gscusum_example_data'>Group-sequential Non-Risk-adjusted Performance Data with Block Identifier</h2><span id='topic+gscusum_example_data'></span>

<h3>Description</h3>

<p>Generated performance data of indicator 17/1 54030: Preoperative stay over 24 hours for patients with proximal femur fracture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gscusum_example_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 2000 rows and 4 variables:
</p>

<dl>
<dt>t</dt><dd><p>Sequence of observations</p>
</dd>
<dt>y</dt><dd><p>Patient outcome</p>
</dd>
<dt>year</dt><dd><p>Year of treatment</p>
</dd>
<dt>block_identifier</dt><dd><p>Continuous block identifier</p>
</dd>
</dl>


<h3>Details</h3>

<p>Patient outcomes were simulated based on average national failure rate. Two years are provided, so Phase I and Phase II can be defined.
</p>


<h3>Source</h3>

<p>Data for simulation was provided by Bavarian Agency of Quality Assurance (BAQ), Munich Germany.
</p>
<p>Description of performance indicator (in German): <a href="https://iqtig.org/downloads/auswertung/2016/17n1hftfrak/QSKH_17n1-HUEFTFRAK_2016_QIDB_V02_2017-04-26.pdf">https://iqtig.org/downloads/auswertung/2016/17n1hftfrak/QSKH_17n1-HUEFTFRAK_2016_QIDB_V02_2017-04-26.pdf</a>
</p>

<hr>
<h2 id='make_all_outcomes'>Make all outcomes</h2><span id='topic+make_all_outcomes'></span>

<h3>Description</h3>

<p>creates all possible sequences of outcomes for a sample size
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_all_outcomes(npat_outcome)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_all_outcomes_+3A_npat_outcome">npat_outcome</code></td>
<td>
<p>Number of patients (sample sizes)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns matrix of possible sequences
</p>

<hr>
<h2 id='plot.cusum'>Plot CUSUM chart for a cusum Object</h2><span id='topic+plot.cusum'></span>

<h3>Description</h3>

<p>Produces a CUSUM chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cusum' plot(x, signal = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cusum_+3A_x">x</code></td>
<td>
<p>An object of class cusum</p>
</td></tr>
<tr><td><code id="plot.cusum_+3A_signal">signal</code></td>
<td>
<p>Logical. If TRUE, signals are plotted (default)</p>
</td></tr>
</table>

<hr>
<h2 id='racusum'>Risk-adjusted CUSUM Charts</h2><span id='topic+racusum'></span>

<h3>Description</h3>

<p>Calculate risk-adjusted CUSUM charts for performance data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>racusum(patient_risks, patient_outcomes, limit, weights = NULL,
  odds_multiplier = 2, reset = TRUE, limit_method = c("constant",
  "dynamic"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="racusum_+3A_patient_risks">patient_risks</code></td>
<td>
<p>Double. Vector of patient risk scores (individual risk of adverse event)</p>
</td></tr>
<tr><td><code id="racusum_+3A_patient_outcomes">patient_outcomes</code></td>
<td>
<p>Integer. Vector of binary patient outcomes (0,1)</p>
</td></tr>
<tr><td><code id="racusum_+3A_limit">limit</code></td>
<td>
<p>Double. Control limit for signalling performance change</p>
</td></tr>
<tr><td><code id="racusum_+3A_weights">weights</code></td>
<td>
<p>Double. Optional vector of weights, if empty, standard CUSUM weights are calculated with weights_t</p>
</td></tr>
<tr><td><code id="racusum_+3A_odds_multiplier">odds_multiplier</code></td>
<td>
<p>Double. Odds multiplier of adverse event under the alternative hypothesis (&lt;1 looks for decreases)</p>
</td></tr>
<tr><td><code id="racusum_+3A_reset">reset</code></td>
<td>
<p>Logical. Reset the CUSUM after a signal to 0; defaults to TRUE</p>
</td></tr>
<tr><td><code id="racusum_+3A_limit_method">limit_method</code></td>
<td>
<p>&quot;constant&quot; or &quot;dynamic&quot;</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Patients risks are usually known from Phase I.
# If not, these risk scores can be simulated.

# define possible patient risk scores
risks &lt;- c(0.001, 0.01, 0.1, 0.002, 0.02, 0.2)

# sample risk population of size n = 100
set.seed(2046)
patient_risks &lt;- sample(x = risks, size = 100, replace = TRUE)

# control limit can be obtained with racusum_limit_sim(),
# here it is set to an arbitrary value (2.96),
# or dynamic control limits with racusum_limit_dpcl()

##### RA-CUSUM of in-control process
# simulate patient outcome for performace as expected
set.seed(2046)
patient_outcomes &lt;- as.logical(rbinom(
  n = 100,
  size = 1,
  prob = patient_risks
))

racusum(patient_risks,
  patient_outcomes,
  limit = 2.96
)

#### RA-CUSUM of out-of-control process
# simulate patient outcome for deviating performance

set.seed(2046)
patient_outcomes &lt;- as.logical(rbinom(n = 100, size = 1, prob = patient_risks * 2))
#'
racusum(patient_risks,
  patient_outcomes,
  limit = 2.96
)
</code></pre>

<hr>
<h2 id='racusum_alpha_sim'>Simulate false signal probability alpha given control limit for RA-CUSUM charts</h2><span id='topic+racusum_alpha_sim'></span>

<h3>Description</h3>

<p>Simulate false signal probability alpha given control limit for RA-CUSUM charts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>racusum_alpha_sim(patient_risks, odds_multiplier, n_simulation, limit,
  seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="racusum_alpha_sim_+3A_patient_risks">patient_risks</code></td>
<td>
<p>Double. Vector of patient risk scores (individual risk of adverse event)</p>
</td></tr>
<tr><td><code id="racusum_alpha_sim_+3A_odds_multiplier">odds_multiplier</code></td>
<td>
<p>Double. Odds multiplier of adverse event under the alternative hypothesis (&lt;1 looks for decreases)</p>
</td></tr>
<tr><td><code id="racusum_alpha_sim_+3A_n_simulation">n_simulation</code></td>
<td>
<p>Integer. Number of simulation runs</p>
</td></tr>
<tr><td><code id="racusum_alpha_sim_+3A_limit">limit</code></td>
<td>
<p>Double. Control limit for signalling performance change</p>
</td></tr>
<tr><td><code id="racusum_alpha_sim_+3A_seed">seed</code></td>
<td>
<p>Integer. Seed for RNG</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns False signal probability of specified RA-CUSUM chart.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Patients risks are usually known from Phase I.
# If not, these risk scores can be simulated.

# define possible patient risk scores
risks &lt;- c(0.001, 0.01, 0.1, 0.002, 0.02, 0.2)

# sample risk population of size n = 100
set.seed(2046)
patient_risks &lt;- sample(x = risks, size = 100, replace = TRUE)

# control limit can be obtained with racusum_limit_sim(),
# here it is set to an arbitrary value (2.96)

# simulate false positive probability of RA-CUSUM
racusum_alpha_sim(patient_risks,
  odds_multiplier = 2,
  n_simulation = 1000,
  limit = 2.96,
  seed = 2046
)
</code></pre>

<hr>
<h2 id='racusum_example_data'>Risk-adjusted Performance Data</h2><span id='topic+racusum_example_data'></span>

<h3>Description</h3>

<p>Generated performance data of indicator: Ratio of observed to expected cases of severe stroke or death under open carotid stenosis surgery.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>racusum_example_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 2000 rows and 4 variables:
</p>

<dl>
<dt>t</dt><dd><p>Sequence of observations</p>
</dd>
<dt>y</dt><dd><p>Patient outcome</p>
</dd>
<dt>score</dt><dd><p>Patient risk score</p>
</dd>
<dt>year</dt><dd><p>Year of treatment</p>
</dd>
</dl>


<h3>Details</h3>

<p>Individual patient risk scores were drawn from actual hospital data and patient outcomes were simulated. Two years are provided, so Phase I and Phase II can be defined.
</p>


<h3>Source</h3>

<p>Data for simulation was provided by Bavarian Agency of Quality Assurance (BAQ), Munich Germany.
</p>
<p>Description of performance indicator (in German): <a href="https://iqtig.org/downloads/auswertung/2016/10n2karot/QSKH_10n2-KAROT_2016_QIDB_V02_2017-04-26.pdf">https://iqtig.org/downloads/auswertung/2016/10n2karot/QSKH_10n2-KAROT_2016_QIDB_V02_2017-04-26.pdf</a>
</p>

<hr>
<h2 id='racusum_limit_dpcl'>Dynamic Probability Control Limits (DPCL)</h2><span id='topic+racusum_limit_dpcl'></span>

<h3>Description</h3>

<p>Set DPCL for risk-adjusted Bernoulli CUSUM Charts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>racusum_limit_dpcl(patient_risks, N = 1e+05, odds_multiplier = 2,
  alpha, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="racusum_limit_dpcl_+3A_patient_risks">patient_risks</code></td>
<td>
<p>Double. Vector of patient risk scores (individual risk of adverse event)</p>
</td></tr>
<tr><td><code id="racusum_limit_dpcl_+3A_n">N</code></td>
<td>
<p>Integer. Number of simulation runs</p>
</td></tr>
<tr><td><code id="racusum_limit_dpcl_+3A_odds_multiplier">odds_multiplier</code></td>
<td>
<p>Double. Odds multiplier of adverse event under the alternative hypothesis (&lt;1 looks for decreases)</p>
</td></tr>
<tr><td><code id="racusum_limit_dpcl_+3A_alpha">alpha</code></td>
<td>
<p>Double. False signal probability of RA-CUSUM</p>
</td></tr>
<tr><td><code id="racusum_limit_dpcl_+3A_seed">seed</code></td>
<td>
<p>Integer. Seed for RNG</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns vector of dynamic control limit for signalling performance change (double)
</p>


<h3>References</h3>

<p>Zhang, Xiang &amp; Woodall, William. (2016). Dynamic Probability Control Limits for Lower and Two-Sided Risk-Adjusted Bernoulli CUSUM Charts. Quality and Reliability Engineering International. 10.1002/qre.2044.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>patient_risks &lt;- runif(100, min = 0.1, max = 0.8)

dpcl &lt;- racusum_limit_dpcl(
  patient_risks = patient_risks,
  N = 1000,
  odds_multiplier = 2,
  alpha = 0.05,
  seed = 32423
)

plot(dpcl, type = "l")
</code></pre>

<hr>
<h2 id='racusum_limit_sim'>Simulate control limit given false signal probability alpha for RA-CUSUM charts</h2><span id='topic+racusum_limit_sim'></span>

<h3>Description</h3>

<p>False-signal-probability-simulation of Control Limits h for risk-adjusted CUSUM charts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>racusum_limit_sim(patient_risks, odds_multiplier, n_simulation, alpha,
  seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="racusum_limit_sim_+3A_patient_risks">patient_risks</code></td>
<td>
<p>Double. Vector of patient risk scores (individual risk of adverse event)</p>
</td></tr>
<tr><td><code id="racusum_limit_sim_+3A_odds_multiplier">odds_multiplier</code></td>
<td>
<p>Double. Odds multiplier of adverse event under the alternative hypothesis (&lt;1 looks for decreases)</p>
</td></tr>
<tr><td><code id="racusum_limit_sim_+3A_n_simulation">n_simulation</code></td>
<td>
<p>Integer. Number of simulation runs</p>
</td></tr>
<tr><td><code id="racusum_limit_sim_+3A_alpha">alpha</code></td>
<td>
<p>Double. False signal probability of RA-CUSUM</p>
</td></tr>
<tr><td><code id="racusum_limit_sim_+3A_seed">seed</code></td>
<td>
<p>Integer. Seed for RNG</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the control limit for signalling performance change (double)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Patients risks are usually known from Phase I.
# If not, these risk scores can be simulated.

# define possible patient risk scores
risks &lt;- c(0.001, 0.01, 0.1, 0.002, 0.02, 0.2)

# sample risk population of size n = 100
set.seed(2046)
patient_risks &lt;- sample(x = risks, size = 100, replace = TRUE)

# simulate control limits for alpha = 0.05
racusum_limit_sim(patient_risks,
  odds_multiplier = 2,
  n_simulation = 1000,
  alpha = 0.05,
  seed = 2046
)
</code></pre>

<hr>
<h2 id='ragscusum'>RA-Grouped-CUSUM chart</h2><span id='topic+ragscusum'></span>

<h3>Description</h3>

<p>Calculate GSCUSUM chart for risk-adjusted processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ragscusum(input_ra_outcomes, limit, quantiles, max_num_shuffles = 10000L,
  seed = 0L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ragscusum_+3A_input_ra_outcomes">input_ra_outcomes</code></td>
<td>
<p>Matrix. First column are binary patient outcomes (0,1). Second column are patient individual weight for adverse event (failure) and third column patient individual weight for no adverse event (success). Fourth column are continuous sequence of block identifier.</p>
</td></tr>
<tr><td><code id="ragscusum_+3A_limit">limit</code></td>
<td>
<p>Double. Control limit for signalling performance change</p>
</td></tr>
<tr><td><code id="ragscusum_+3A_quantiles">quantiles</code></td>
<td>
<p>Double. Vector of requested quantiles of RA-GSCUSUM distribution</p>
</td></tr>
<tr><td><code id="ragscusum_+3A_max_num_shuffles">max_num_shuffles</code></td>
<td>
<p>Integer. Number of shuffles (i.e. different sequences of observations)</p>
</td></tr>
<tr><td><code id="ragscusum_+3A_seed">seed</code></td>
<td>
<p>Integer. Seed for RNG (if = 0 random seed is set (default))</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ragscusum NumericMatix, signal probability, average CUSUM value and specified quantiles for every observation.
</p>

<hr>
<h2 id='ragscusum_example_data'>Group-sequential Risk-adjusted Performance Data with Block Identifier</h2><span id='topic+ragscusum_example_data'></span>

<h3>Description</h3>

<p>Generated performance data of indicator: Ratio of observed to expected cases of severe stroke or death under open carotid stenosis surgery.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ragscusum_example_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 2000 rows and 4 variables:
</p>

<dl>
<dt>t</dt><dd><p>Sequence of observations</p>
</dd>
<dt>y</dt><dd><p>Patient outcome</p>
</dd>
<dt>score</dt><dd><p>Patient risk score</p>
</dd>
<dt>year</dt><dd><p>Year of treatment</p>
</dd>
<dt>block_identifier</dt><dd><p>Continuous block identifier</p>
</dd>
</dl>


<h3>Details</h3>

<p>Individual patient risk scores were drawn from actual hospital data and patient outcomes were simulated. Two years are provided, so Phase I and Phase II can be defined.
</p>


<h3>Source</h3>

<p>Data for simulation was provided by Bavarian Agency of Quality Assurance (BAQ), Munich Germany.
</p>
<p>Description of performance indicator (in German): <a href="https://iqtig.org/downloads/auswertung/2016/10n2karot/QSKH_10n2-KAROT_2016_QIDB_V02_2017-04-26.pdf">https://iqtig.org/downloads/auswertung/2016/10n2karot/QSKH_10n2-KAROT_2016_QIDB_V02_2017-04-26.pdf</a>
</p>

<hr>
<h2 id='weights_t'>Weights for observations</h2><span id='topic+weights_t'></span>

<h3>Description</h3>

<p>Calculate standard CUSUM weights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weights_t(patient_outcomes, probability_ae, odds_multiplier = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weights_t_+3A_patient_outcomes">patient_outcomes</code></td>
<td>
<p>Integer. Vector of binary patient outcomes (0,1)</p>
</td></tr>
<tr><td><code id="weights_t_+3A_probability_ae">probability_ae</code></td>
<td>
<p>Double. Baseline failure probability for adverse event in non-risk-adjusted case, vector of patient risk scores for risk-adjustment.</p>
</td></tr>
<tr><td><code id="weights_t_+3A_odds_multiplier">odds_multiplier</code></td>
<td>
<p>Double. Odds multiplier of adverse event under the alternative hypothesis (&lt;1 looks for decreases)</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
