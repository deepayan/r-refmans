<!DOCTYPE html><html><head><title>Help for package l1kdeconv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {l1kdeconv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#getclusterranges'><p>Get the Cluster Ranges in a Vector of 1D Coordinates</p></a></li>
<li><a href='#gmmplot'><p>Plot the Fit Results of 2-Component Gaussian Mixture Model</p></a></li>
<li><a href='#multigmmmanydata'><p>Split the input dataset into several sub list to deconvolution.</p></a></li>
<li><a href='#multigmmplot'><p>Plot the Fit Results of aggregate 2-Component Gaussian Mixture Model</p></a></li>
<li><a href='#multigmmsamedistribu'><p>Fit Multi 2-Component Gaussian Mixture Model in same distribution with a Fixed Proportion</p></a></li>
<li><a href='#multigmmsamedistribulik'><p>The sum of Log-Likelihoods of 1D Multi Same Distribution Gaussian Mixture Model</p></a></li>
<li><a href='#multigmmsamedistribumulti'><p>Split the input dataset into several sub list to deconvolution.</p></a></li>
<li><a href='#rmoutlier1d'><p>Remove the Outliers in a Vector of 1D Coordinates</p></a></li>
<li><a href='#splitgrp'><p>Split a list with size n into groups with at least m elements</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Deconvolution for LINCS L1000 Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-07-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhao Li[aut], Peng Yu[aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhao Li &lt;lizhao.informatics@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>LINCS L1000 is a high-throughput technology that allows the gene expression measurement in a large number of assays. However, to fit the measurements of ~1000 genes in the ~500 color channels of LINCS L1000, every two landmark genes are designed to share a single channel. Thus, a deconvolution step is required to infer the expression values of each gene. Any errors in this step can be propagated adversely to the downstream analyses. We present a LINCS L1000 data peak calling R package l1kdeconv based on a new outlier detection method and an aggregate Gaussian mixture model. Upon the remove of outliers and the borrowing information among similar samples, l1kdeconv shows more stable and better performance than methods commonly used in LINCS L1000 data deconvolution.</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, mixtools, ggplot2</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-07-08 04:28:05 UTC; zhao</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-07-08 04:41:45 UTC</td>
</tr>
</table>
<hr>
<h2 id='getclusterranges'>Get the Cluster Ranges in a Vector of 1D Coordinates</h2><span id='topic+getclusterranges'></span>

<h3>Description</h3>

<p>Get the Cluster Ranges in a Vector of 1D Coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getclusterranges(x, gap)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getclusterranges_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
<tr><td><code id="getclusterranges_+3A_gap">gap</code></td>
<td>
<p>the size for the recognation of data free gaps</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x = c(1:3, 11:13)
getclusterranges(x, 3)
</code></pre>

<hr>
<h2 id='gmmplot'>Plot the Fit Results of 2-Component Gaussian Mixture Model</h2><span id='topic+gmmplot'></span>

<h3>Description</h3>

<p>Plot the Fit Results of 2-Component Gaussian Mixture Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmmplot(x, mu1, mu2, sigma, lambda, nbins = 15, xlim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gmmplot_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
<tr><td><code id="gmmplot_+3A_mu1">mu1</code></td>
<td>
<p>the mean of the 1st cluster</p>
</td></tr>
<tr><td><code id="gmmplot_+3A_mu2">mu2</code></td>
<td>
<p>the mean of the 2nd cluster</p>
</td></tr>
<tr><td><code id="gmmplot_+3A_sigma">sigma</code></td>
<td>
<p>the common variance of both clusters</p>
</td></tr>
<tr><td><code id="gmmplot_+3A_lambda">lambda</code></td>
<td>
<p>the proportion parameter</p>
</td></tr>
<tr><td><code id="gmmplot_+3A_nbins">nbins</code></td>
<td>
<p>the number of bins per cluster (6*sigma)</p>
</td></tr>
<tr><td><code id="gmmplot_+3A_xlim">xlim</code></td>
<td>
<p>the limitation of x scale</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x=list(c(
  rnorm(150, mean=0)
  , rnorm(50, mean=10)
  ))
fit_res=multigmmsamedistribu(x)

with(
  as.list(fit_res$par_conv)
  , gmmplot(x[[1]]
    , mu1=mu1
    , mu2=mu2
    , sigma=sigma
    , lambda=lambda
    , xlim=range(unlist(x))
    )
  )
</code></pre>

<hr>
<h2 id='multigmmmanydata'>Split the input dataset into several sub list to deconvolution.</h2><span id='topic+multigmmmanydata'></span>

<h3>Description</h3>

<p>Due to the limitation of optimization that too many data would dramatically slow down the speed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multigmmmanydata(x, grp_size = 3, lambda_lower = 0.1, lambda_upper = 1 -
  lambda_lower, sigma_lower = 0.01, debug = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multigmmmanydata_+3A_x">x</code></td>
<td>
<p>a list of numeric vector</p>
</td></tr>
<tr><td><code id="multigmmmanydata_+3A_grp_size">grp_size</code></td>
<td>
<p>the normal group size for each group</p>
</td></tr>
<tr><td><code id="multigmmmanydata_+3A_lambda_lower">lambda_lower</code></td>
<td>
<p>the lower bound of <code class="reqn">\lambda</code></p>
</td></tr>
<tr><td><code id="multigmmmanydata_+3A_lambda_upper">lambda_upper</code></td>
<td>
<p>the upper bound of <code class="reqn">\lambda</code></p>
</td></tr>
<tr><td><code id="multigmmmanydata_+3A_sigma_lower">sigma_lower</code></td>
<td>
<p>the lower bound of <code class="reqn">\sigma</code></p>
</td></tr>
<tr><td><code id="multigmmmanydata_+3A_debug">debug</code></td>
<td>
<p>enable the debug mode to show <code>par</code> and <code>fn</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x1=c(rnorm(150, mean=0), rnorm(50, mean=10))
x2=c(rnorm(150, mean=20), rnorm(50, mean=40))
x3=c(rnorm(150, mean=30), rnorm(50, mean=60))
x4=c(rnorm(150, mean=30), rnorm(50, mean=60))
x5=c(rnorm(150, mean=30), rnorm(50, mean=60))
x6=c(rnorm(150, mean=30), rnorm(50, mean=60))
x=list(x1, x2, x3, x4, x5, x6)
multigmmmanydata(x)
</code></pre>

<hr>
<h2 id='multigmmplot'>Plot the Fit Results of aggregate 2-Component Gaussian Mixture Model</h2><span id='topic+multigmmplot'></span>

<h3>Description</h3>

<p>Plot the Fit Results of aggregate 2-Component Gaussian Mixture Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multigmmplot(x, fit_res, nbins = 15)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multigmmplot_+3A_x">x</code></td>
<td>
<p>a list of a numeric vector</p>
</td></tr>
<tr><td><code id="multigmmplot_+3A_fit_res">fit_res</code></td>
<td>
<p>the result of AGMM</p>
</td></tr>
<tr><td><code id="multigmmplot_+3A_nbins">nbins</code></td>
<td>
<p>the number of bins per cluster</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>params=list(
 c(mu1=0, mu2=10, sd = 1)
 , c(mu1=10, mu2=20, sd = 1)
 )

set.seed(0)
x=lapply(
  params
  , function(v) {
    c(
      rnorm(100, mean=v[['mu1']], sd = v[['sd']])
      , rnorm(50, mean=v[['mu2']], sd = v[['sd']])
      )
  }
  )
multigmmplot(x, multigmmsamedistribu(x))
</code></pre>

<hr>
<h2 id='multigmmsamedistribu'>Fit Multi 2-Component Gaussian Mixture Model in same distribution with a Fixed Proportion</h2><span id='topic+multigmmsamedistribu'></span>

<h3>Description</h3>

<p>Fit Multi 2-Component Gaussian Mixture Model in same distribution with a Fixed Proportion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multigmmsamedistribu(x, lambda_lower = 0.1, lambda_upper = 1 - lambda_lower,
  sigma_lower = 0.01, debug = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multigmmsamedistribu_+3A_x">x</code></td>
<td>
<p>a list of numeric vector</p>
</td></tr>
<tr><td><code id="multigmmsamedistribu_+3A_lambda_lower">lambda_lower</code></td>
<td>
<p>the lower bound of <code class="reqn">\lambda</code></p>
</td></tr>
<tr><td><code id="multigmmsamedistribu_+3A_lambda_upper">lambda_upper</code></td>
<td>
<p>the upper bound of <code class="reqn">\lambda</code></p>
</td></tr>
<tr><td><code id="multigmmsamedistribu_+3A_sigma_lower">sigma_lower</code></td>
<td>
<p>the lower bound of <code class="reqn">\sigma</code></p>
</td></tr>
<tr><td><code id="multigmmsamedistribu_+3A_debug">debug</code></td>
<td>
<p>enable the debug mode to show <code>par</code> and <code>fn</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x1=c(rnorm(150, mean=0), rnorm(50, mean=10))
x2=c(rnorm(150, mean=20), rnorm(50, mean=40))
x3=c(rnorm(150, mean=30), rnorm(50, mean=60))
x=list(x1, x2, x3)
multigmmsamedistribu(x)
</code></pre>

<hr>
<h2 id='multigmmsamedistribulik'>The sum of Log-Likelihoods of 1D Multi Same Distribution Gaussian Mixture Model</h2><span id='topic+multigmmsamedistribulik'></span>

<h3>Description</h3>

<p>The sum of Log-Likelihoods of 1D Multi Same Distribution Gaussian Mixture Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multigmmsamedistribulik(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multigmmsamedistribulik_+3A_x">x</code></td>
<td>
<p>a list of numeric vectors</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x1=c(
 rnorm(100, mean=0)
 , rnorm(100, mean=1)
 )
x=list(x1)
multigmmsamedistribulik(x)(c(0.5, 1, 0.5, 1))
</code></pre>

<hr>
<h2 id='multigmmsamedistribumulti'>Split the input dataset into several sub list to deconvolution.</h2><span id='topic+multigmmsamedistribumulti'></span>

<h3>Description</h3>

<p>Due to the limitation of optimization that too many data would dramatically slow down the speed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multigmmsamedistribumulti(x, lambda_lower = 0.1, lambda_upper = 1 -
  lambda_lower, sigma_lower = 0.01, debug = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multigmmsamedistribumulti_+3A_x">x</code></td>
<td>
<p>a list of numeric vector</p>
</td></tr>
<tr><td><code id="multigmmsamedistribumulti_+3A_lambda_lower">lambda_lower</code></td>
<td>
<p>the lower bound of <code class="reqn">\lambda</code></p>
</td></tr>
<tr><td><code id="multigmmsamedistribumulti_+3A_lambda_upper">lambda_upper</code></td>
<td>
<p>the upper bound of <code class="reqn">\lambda</code></p>
</td></tr>
<tr><td><code id="multigmmsamedistribumulti_+3A_sigma_lower">sigma_lower</code></td>
<td>
<p>the lower bound of <code class="reqn">\sigma</code></p>
</td></tr>
<tr><td><code id="multigmmsamedistribumulti_+3A_debug">debug</code></td>
<td>
<p>enable the debug mode to show <code>par</code> and <code>fn</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(0)
x1=c(rnorm(150, mean=0), rnorm(50, mean=10))
x2=c(rnorm(150, mean=20), rnorm(50, mean=40))
x3=c(rnorm(150, mean=30), rnorm(50, mean=60))
x4=c(rnorm(150, mean=30), rnorm(50, mean=60))
x5=c(rnorm(150, mean=30), rnorm(50, mean=60))
x6=c(rnorm(150, mean=30), rnorm(50, mean=60))
x=list(x1, x2, x3, x4, x5, x6)
multigmmmanydata(x)
</code></pre>

<hr>
<h2 id='rmoutlier1d'>Remove the Outliers in a Vector of 1D Coordinates</h2><span id='topic+rmoutlier1d'></span>

<h3>Description</h3>

<p>Remove the Outliers in a Vector of 1D Coordinates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmoutlier1d(x, dy_thr = dnorm(4), clustersize_thr = 3, gapsize = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmoutlier1d_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
<tr><td><code id="rmoutlier1d_+3A_dy_thr">dy_thr</code></td>
<td>
<p>the threshold for dy</p>
</td></tr>
<tr><td><code id="rmoutlier1d_+3A_clustersize_thr">clustersize_thr</code></td>
<td>
<p>the threshold for cluster size</p>
</td></tr>
<tr><td><code id="rmoutlier1d_+3A_gapsize">gapsize</code></td>
<td>
<p>the threshold of points in recognizing data free gap</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>x=c(1,10:30,50)
par(mfrow=c(2,1))
plot(density(x))
plot(density(rmoutlier1d(x)))
</code></pre>

<hr>
<h2 id='splitgrp'>Split a list with size n into groups with at least m elements</h2><span id='topic+splitgrp'></span>

<h3>Description</h3>

<p>Split a list with size n into groups with at least m elements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splitgrp(n, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="splitgrp_+3A_n">n</code></td>
<td>
<p>an integer indicating the total length</p>
</td></tr>
<tr><td><code id="splitgrp_+3A_m">m</code></td>
<td>
<p>the min group size</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
splitgrp(1, 2)
splitgrp(2, 2)
splitgrp(3, 2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
