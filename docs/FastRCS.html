<!DOCTYPE html><html lang="en"><head><title>Help for package FastRCS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FastRCS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FastRCS-package'><p>Code to compute the FastRCS regression outlyingness index.</p></a></li>
<li><a href='#FastRCS'><p>Computes the FastRCS outlyingness index for regression.</p></a></li>
<li><a href='#FRCSnumStarts'><p>Computes the number of starting p-subsets</p></a></li>
<li><a href='#Lemons'><p>Sales Data for the Chrysler Town &amp; Country</p></a></li>
<li><a href='#plot.FastRCS'><p>Robust Diagnostic Plots For FastRCS</p></a></li>
<li><a href='#quanf'><p>Converts alpha values to h-values</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fits the FastRCS Robust Multivariable Linear Regression Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.9</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-13</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1), matrixStats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen</td>
</tr>
<tr>
<td>Description:</td>
<td>The FastRCS algorithm of Vakili and Schmitt (2014) for robust fit of the multivariable linear regression model and outliers detection.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Author:</td>
<td>Kaveh Vakili [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kaveh Vakili &lt;vakili.kaveh.email@gmail.com&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-06 15:08:24 UTC; kaveh</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-06 15:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='FastRCS-package'>Code to compute the FastRCS regression outlyingness index.</h2><span id='topic+FastRCS-package'></span>

<h3>Description</h3>

<p>Uses the FastRCS algorithm to compute the RCS outlyingness index 
of regression.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> FastRCS</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.0.9</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-02-13</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> mvtnorm</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index:
</p>
<pre>
FastRCS                 Function to compute the FastRCS regression outlyingness
                       index.
FRCSnumStarts                 Internal function used to compute the FastRCS regression
                       outlyingness index.
plot.FastRCS		Robust Diagnostic Plots For FastRCS.
quanf                     Internal function used to compute the FastRCS regression
                       outlyingness index.
</pre>


<h3>Author(s)</h3>

<p>Kaveh Vakili [aut, cre],
Maintainer: Kaveh Vakili &lt;vakili.kaveh.email@gmail.com&gt;
</p>


<h3>References</h3>

<p>Vakili, K. and Schmitt, E. (2014).
Finding Regression Outliers With FastRCS.
(http://arxiv.org/abs/1307.4834)
</p>

<hr>
<h2 id='FastRCS'>Computes the FastRCS outlyingness index for regression.</h2><span id='topic+FastRCS'></span>

<h3>Description</h3>

<p>Computes a fast and robust regression model for a n by p matrix of 
multivariate continuous regressors and a single dependent variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  FastRCS(x,y,nSamp,alpha=0.5,seed=1,intercept=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FastRCS_+3A_x">x</code></td>
<td>
<p>A numeric n (n&gt;5*p) by p (p&gt;1) matrix or data frame. Should 
not contain an intercept.</p>
</td></tr>
<tr><td><code id="FastRCS_+3A_y">y</code></td>
<td>
<p>A numeric nvector.</p>
</td></tr>
<tr><td><code id="FastRCS_+3A_nsamp">nSamp</code></td>
<td>
<p>a positive integer giving the number of resamples required;
<code>"nSamp"</code> may not be reached if too many of the p-subsamples,
chosen out of the observed vectors, are in a hyperplane.  If <code>"nSamp"</code> is
omitted, it is calculated so that the probability of getting at least one
uncontaminated starting point is always at least 99 percent when there are n/2 outliers.</p>
</td></tr>
<tr><td><code id="FastRCS_+3A_alpha">alpha</code></td>
<td>
<p>numeric parameter controlling the size of the active subsets,
i.e., <code>"h=quanf(alpha,n,p)"</code>.  Allowed
values are between 0.5 and 1 and the default is 0.5.</p>
</td></tr>
<tr><td><code id="FastRCS_+3A_seed">seed</code></td>
<td>
<p>starting value for random generator. A positive integer. Default is seed = 1</p>
</td></tr>
<tr><td><code id="FastRCS_+3A_intercept">intercept</code></td>
<td>
<p>If true, a model with constant term will be estimated; otherwise no constant term will be included. Default is intercept=TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The current version of FastRCS includes the use of a C-step procedure to improve efficiency (Rousseeuw and van Driessen (1999)). C-steps are taken after the raw subset is found and before reweighting. In experiments, we found that carrying C-Steps 
starting from the members of <code>$rawBest</code> improves the speed of convergence without increasing the bias
of the final estimates. FastRCS is regression and affine equivariant and thus consistent at the elliptical
model (Grubel and Rock (1990)). 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>nSamp</code></td>
<td>
<p>The value of nSamp used.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The value of alpha used.</p>
</td></tr>
<tr><td><code>obj</code></td>
<td>
<p>The value of the FastRCS objective function (the I-index) obtained for H*.</p>
</td></tr>
<tr><td><code>rawBest</code></td>
<td>
<p>The index of the h observation with smallest outlyingness indexes.</p>
</td></tr>
<tr><td><code>rawDist</code></td>
<td>
<p>The distances of the observations to the model defined by rawBest.</p>
</td></tr>
<tr><td><code>best</code></td>
<td>
<p>The index of the J observation with outlyingness smaller than the rejection threshold.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>The vector of coefficients of the hyperplane fitted to the members of <code>$rew$best</code>.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted mean values: <code>cbind(1,x)%*%rew$coefficients</code>.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the residuals, that is response minus fitted values.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>the numeric rank of the fitted linear model.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>(only for weighted fits) the specified weights.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the residual degrees of freedom.</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>(robust) scale estimate of the reweighted residuals.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaveh Vakili
</p>


<h3>References</h3>

<p>Grubel, R. and Rocke, D. M. (1990).
On the cumulants of affine equivariant estimators in elliptical families.
Journal of Multivariate Analysis, Vol. 35, p. 203&ndash;222. Journal of Multivariate Analysis
</p>
<p>Rousseeuw, P. J., and van Driessen, K. (2006). Computing lts regression for large data sets. 
Data mining and	Knowledge Discovery, 12, 29&ndash;45
</p>
<p>Vakili, K. and Schmitt, E. (2014).
Finding Regression Outliers With FastRCS.
(http://arxiv.org/abs/1307.4834)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## testing outlier detection
set.seed(123)
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*p),nc=p)
y0&lt;-rnorm(n)
z&lt;-c(rep(0,30),rep(1,70))
x0[1:30,]&lt;-matrix(rnorm(30*p,5,1/100),nc=p)
y0[1:30]&lt;-rnorm(30,10,1/100)
ns&lt;-FRCSnumStarts(p=p,eps=0.4);
results&lt;-FastRCS(x=x0,y=y0,alpha=0.5,nSamp=ns)
z[results$best]

## testing outlier detection, different value of alpha
set.seed(123)
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*p),nc=p)
y0&lt;-rnorm(n)
z&lt;-c(rep(0,20),rep(1,80))
x0[1:20,]&lt;-matrix(rnorm(20*p,5,1/100),nc=p)
y0[1:20]&lt;-rnorm(20,10,1/100)
ns&lt;-FRCSnumStarts(p=p,eps=0.25);
results&lt;-FastRCS(x=x0,y=y0,alpha=0.75,nSamp=ns)
z[results$best]



#testing exact fit
set.seed(123)
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*p),nc=p)
y0&lt;-rep(1,n)
z&lt;-c(rep(0,30),rep(1,70))
x0[1:30,]&lt;-matrix(rnorm(30*p,5,1/100),nc=p)
y0[1:30]&lt;-rnorm(30,10,1/100)
ns&lt;-FRCSnumStarts(p=p,eps=0.4);
results&lt;-FastRCS(x=x0,y=y0,alpha=0.5,nSamp=ns,seed=1)
z[results$rawBest]
results$obj

#testing regression equivariance
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*(p-1)),nc=p-1)
y0&lt;-rnorm(n)
ns&lt;-FRCSnumStarts(p=p,eps=0.4);
y1&lt;-y0+cbind(1,x0)%*%rep(-1,p)
results1&lt;-FastRCS(y=y0,x=x0,nSamp=ns,seed=1)$coefficients
results2&lt;-FastRCS(y=y1,x=x0,nSamp=ns,seed=1)$coefficients
results1+rep(-1,p)
#should be the same:
results2
</code></pre>

<hr>
<h2 id='FRCSnumStarts'>Computes the number of starting p-subsets</h2><span id='topic+FRCSnumStarts'></span>

<h3>Description</h3>

<p>Computes the number of starting p-subsets so that the desired probability of selecting at least one clean one is achieved.
This is an internal function not intended to be called 
by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  FRCSnumStarts(p,gamma=0.99,eps=0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FRCSnumStarts_+3A_p">p</code></td>
<td>
<p>number of dimensions of the data matrix X.</p>
</td></tr>
<tr><td><code id="FRCSnumStarts_+3A_gamma">gamma</code></td>
<td>
<p>desired probability of having at least one 
clean starting p-subset.</p>
</td></tr>
<tr><td><code id="FRCSnumStarts_+3A_eps">eps</code></td>
<td>
<p>suspected contamination rate of the sample.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer number of starting p-subsets.
</p>


<h3>Author(s)</h3>

<p>Kaveh Vakili
</p>


<h3>Examples</h3>

<pre><code class='language-R'>FRCSnumStarts(p=3,gamma=0.99,eps=0.4)
</code></pre>

<hr>
<h2 id='Lemons'>Sales Data for the Chrysler Town &amp; Country</h2><span id='topic+Lemons'></span>

<h3>Description</h3>

<p>Sales data for the Chrysler Town &amp; Country. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Lemons
</code></pre>


<h3>Format</h3>


<dl>
<dt><code>VehBCost</code></dt><dd><p>Acquisition cost paid for the vehicle at time of purchase.</p>
</dd>
<dt><code>MMRAcquisitionAuctionAveragePrice</code></dt><dd><p>Acquisition price for this vehicle in average condition at time of purchase.</p>
</dd>
<dt><code>MMRAcquisitonRetailCleanPrice</code></dt><dd><p>Acquisition price for this vehicle in the above Average condition at time of purchase.</p>
</dd>	
<dt><code>MMRAcquisitionRetailAveragePrice</code></dt><dd><p>Acquisition price for this vehicle in the retail market in average condition at time of purchase.</p>
</dd>
<dt><code>MMRAcquisitonRetailCleanPrice</code></dt><dd><p>Acquisition price for this vehicle in the retail market in above average condition at time of purchase.</p>
</dd>
<dt><code>MMRCurrentAuctionAveragePrice</code></dt><dd><p>Acquisition price for this vehicle in average condition as of current day.</p>
</dd>
<dt><code>MMRCurrentAuctionCleanPrice</code></dt><dd><p>Acquisition price for this vehicle in above condition as of current day.</p>
</dd>
<dt><code>MMRCurrentRetailAveragePrice</code></dt><dd><p>Acquisition price for this vehicle on the retail market in average condition as of current day.</p>
</dd>
<dt><code>MMRCurrentRetailCleanPrice</code></dt><dd><p>Acquisition price for this vehicle on the retail market in above average condition as of current day.</p>
</dd>
<dt><code>WarrantyCost</code></dt><dd><p>Warranty price (term=36month  and millage=36K).</p>
</dd>
<dt><code>VehOdo</code></dt><dd><p>The vehicle's odometer reading.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(Lemons)
alpha&lt;-0.5
p&lt;-ncol(Lemons)
ns&lt;-FRCSnumStarts(p=p,eps=(1-alpha)*4/5)
Fit&lt;-FastRCS(x=Lemons[,-1],y=Lemons[,1],nSamp=ns,seed=1)
plot(Fit)
</code></pre>

<hr>
<h2 id='plot.FastRCS'>Robust Diagnostic Plots For FastRCS</h2><span id='topic+plot.FastRCS'></span>

<h3>Description</h3>

<p>Shows the robust Score distances versus robust Orthogonal distances
and their respective cutoffs, for the an object of class FastRCS. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FastRCS'
plot(x,col="black",pch=16,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.FastRCS_+3A_x">x</code></td>
<td>
<p>For the <code>plot()</code> method, a <code>FastRCS</code> object, typically
result of <code><a href="#topic+FastRCS">FastRCS</a></code>.</p>
</td></tr>	
<tr><td><code id="plot.FastRCS_+3A_col">col</code></td>
<td>
<p> A specification for the default plotting color. Vector of values are recycled.</p>
</td></tr>
<tr><td><code id="plot.FastRCS_+3A_pch">pch</code></td>
<td>
<p> Either an integer specifying a symbol or a single character
to be used as the default in plotting points.   Note that only
integers and single-character strings can be set as a
graphics parameter.
Vector of values are recycled.</p>
</td></tr>
<tr><td><code id="plot.FastRCS_+3A_...">...</code></td>
<td>
<p>Further arguments passed to the plot function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function produces the robust standardized, residuals
as well as an indicative cut-off (under normal model). 
This tool is a diagnostic plot for robust regression and 
can be used used to reveal the outliers. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FastRCS">FastRCS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
n&lt;-100
p&lt;-3
x0&lt;-matrix(rnorm(n*p),nc=p)
y0&lt;-rnorm(n)
z&lt;-c(rep(0,30),rep(1,70))
x0[1:30,]&lt;-matrix(rnorm(30*p,5,1/100),nc=p)
y0[1:30]&lt;-rnorm(30,10,1/100)
ns&lt;-FRCSnumStarts(p=p,eps=0.4);
results&lt;-FastRCS(x=x0,y=y0,alpha=0.5,nSamp=ns)
plot(results)

</code></pre>

<hr>
<h2 id='quanf'>Converts alpha values to h-values</h2><span id='topic+quanf'></span>

<h3>Description</h3>

<p>FastRCS selects the subset of size h that minimizes the I-index criterion. The function <code>quanf</code> determines the size of h based on the rate of contamination the user expects is present in the data.
This is an internal function not intended to be called 
by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  quanf(n,p,alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quanf_+3A_n">n</code></td>
<td>
<p>Number of rows of the data matrix.</p>
</td></tr>
<tr><td><code id="quanf_+3A_p">p</code></td>
<td>
<p>Number of columns of the data matrix.</p>
</td></tr>
<tr><td><code id="quanf_+3A_alpha">alpha</code></td>
<td>
<p>Numeric parameter controlling the size of the active subsets,
i.e., <code>"h=quanf(alpha,n,p)"</code>.  Allowed
values are between 0.5 and 1 and the default is 0.5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer number of the size of the starting p-subsets.
</p>


<h3>Author(s)</h3>

<p>Kaveh Vakili
</p>


<h3>Examples</h3>

<pre><code class='language-R'>quanf(p=3,n=500,alpha=0.5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
