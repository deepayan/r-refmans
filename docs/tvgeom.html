<!DOCTYPE html><html><head><title>Help for package tvgeom</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tvgeom}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#tvgeom'><p>tvgeom: A package for the time-varying geometric probability distribution</p></a></li>
<li><a href='#tvgeom-moments'><p>Moments for the The Time-Varying (Right-Truncated) Geometric Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>The Time-Varying (Right-Truncated) Geometric Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Probability mass (d), distribution (p), quantile (q), and random 
    number generating (r and rt) functions for the time-varying right-truncated 
    geometric (tvgeom) distribution. Also provided are functions to calculate the first 
    and second central moments of the distribution. The tvgeom distribution
    is similar to the geometric distribution, but the probability 
    of success is allowed to vary at each time step, and there are a limited 
    number of trials. This distribution is essentially a Markov chain, and it
    is useful for modeling Markov chain systems with a set 
    number of time steps.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Copyright:</td>
<td>2019 Conservation Science Partners, Inc.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggthemes, ggplot2, dplyr, tidyr, purrr, knitr, rmarkdown,
magrittr, gridExtra, testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-04 00:47:24 UTC; tvgeom</td>
</tr>
<tr>
<td>Author:</td>
<td>Vincent Landau [aut, cre],
  Luke Zachmann [ctb],
  Conservation Science Partners, Inc. [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vincent Landau &lt;vincent@csp-inc.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-07 01:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='tvgeom'>tvgeom: A package for the time-varying geometric probability distribution</h2><span id='topic+tvgeom'></span><span id='topic+tvgeom-package'></span><span id='topic+dtvgeom'></span><span id='topic+ptvgeom'></span><span id='topic+qtvgeom'></span><span id='topic+rtvgeom'></span><span id='topic+rttvgeom'></span>

<h3>Description</h3>

<p>The tvgeom package provides two categories of important functions:
probability distribution functions (d, p, q, r) and moments (tvgeom_mean and
tvgeom_var).
</p>
<p>Density (<code>dtvgeom</code>), distribution function (<code>qtvgeom</code>), quantile
function (<code>ptvgeom</code>), and random number generation (<code>rtvgeom</code> and
<code>rttvgeom</code> for sampling from the <em>full</em> and <em>truncated</em>
distribution, respectively) for the time-varying, right-truncated geometric
distribution with parameter <code>prob</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dtvgeom(x, prob, log = FALSE)

ptvgeom(q, prob, lower.tail = TRUE, log.p = FALSE)

qtvgeom(p, prob, lower.tail = TRUE, log.p = FALSE)

rtvgeom(n, prob)

rttvgeom(n, prob, lower = 0, upper = length(prob) + 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tvgeom_+3A_x">x</code>, <code id="tvgeom_+3A_q">q</code></td>
<td>
<p>vector of quantiles representing the trial at which the first
success occurred.</p>
</td></tr>
<tr><td><code id="tvgeom_+3A_prob">prob</code></td>
<td>
<p>vector of the probability of success for each trial.</p>
</td></tr>
<tr><td><code id="tvgeom_+3A_log">log</code>, <code id="tvgeom_+3A_log.p">log.p</code></td>
<td>
<p>logical; if <code>TRUE</code>, probabilities, p, are given as
<code>log(p)</code>. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="tvgeom_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>FALSE</code>, <code>ptvgeom</code> returns</p>
</td></tr>
<tr><td><code id="tvgeom_+3A_p">p</code></td>
<td>
<p>vector of probabilities at which to evaluate the quantile function.</p>
</td></tr>
<tr><td><code id="tvgeom_+3A_n">n</code></td>
<td>
<p>number of observations to sample.</p>
</td></tr>
<tr><td><code id="tvgeom_+3A_lower">lower</code></td>
<td>
<p>lower value (exclusive) at which to truncate the distribution
for random number generation. Defaults to <code>0</code>, in which case the
distribution is not left-truncated.</p>
</td></tr>
<tr><td><code id="tvgeom_+3A_upper">upper</code></td>
<td>
<p>upper value (inclusive) at which to truncate the distribution
for random number generation. Defaults to <code>length(prob)</code>, in which case
the distribution is not right-truncated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The time-varying geometric distribution describes the number of independent
Bernoulli trials needed to obtain one success. The probability of success,
<code>prob</code>, may vary for each trial. It has mass </p>
<p style="text-align: center;"><code class="reqn">p(x) = prob[x] *
prod(1 - prob[1:(x-1)])</code>
</p>
<p> with support <code class="reqn">x = 1, 2, ..., n + 1</code>,
where <code>n</code> equals then length of <code>prob</code>. For <code class="reqn">i</code> in
<code class="reqn">prob, 0 \le i \le 1</code>. The <code>n+1</code> case represents the case that the event did not
happen in the first n trials.
</p>


<h3>Value</h3>

<p>dtvgeom gives the probability mass, qtvgeom gives the
quantile functions, ptvgeom gives the distribution function, rtvgeom
generates random numbers, and rttvgeom gives random numbers from the
distribution truncated at bounds provided by the user.
<code class="reqn">P(X &gt; x)</code> instead of <code class="reqn">P(X \le x)</code>. Defaults to <code>TRUE</code>.
</p>


<h3>Package functions</h3>

<p>The tvgeom functions ...
</p>


<h3>Examples</h3>

<pre><code class='language-R'># What's the probability that a given number of trials, n, are needed to get
# one success if `prob` = `p0`, as defined below...?
p0 &lt;- .15 # the probability of success

# Axis labels (for plotting purposes, below).
x_lab &lt;- "Number of trials, n"
y_lab &lt;- sprintf("P(success at trial n | prob = %s)", p0)

# Scenario 1: the probability of success is constant and we invoke functions
# from base R's implementation of the geometric distribution.
y1 &lt;- rgeom(1e3, p0) + 1 # '+1' b/c dgeom parameterizes in terms of failures
x1 &lt;- seq_len(max(y1))
z1 &lt;- dgeom(x1 - 1, p0)
plot(table(y1) / 1e3,
  xlab = x_lab, ylab = y_lab, col = "#00000020",
  bty = "n", ylim = c(0, p0)
)
lines(x1, z1, type = "l")

# Scenario 2: the probability of success is constant, but we use tvgeom's
# implementation of the time-varying geometric distribution. For the purposes
# of this demonstration, the length of vector `prob` (`n_p0`) is chosen to be
# arbitrarily large *relative* to the distribution of n above (`y1`) to
# ensure we don't accidentally create any censored observations!
n_p0 &lt;- max(y1) * 5
p0_vec &lt;- rep(p0, n_p0)
y2 &lt;- rtvgeom(1e3, p0_vec)
x2 &lt;- seq_len(max(max(y1), max(y2)))
z2 &lt;- dtvgeom(x2, p0_vec) # dtvgeom is parameterized in terms of successes
points(x2[x2 &lt;= max(y1)], z2[x2 &lt;= max(y1)],
  col = "red", xlim = c(1, max(y1))
)

# Scenario 3: the probability of success for each process varies over time
# (e.g., chances increase linearly by `rate` for each subsequent trial until
# chances saturate at `prob` = 1).
rate &lt;- 1.5
prob_tv &lt;- numeric(n_p0)
for (i in 1:length(p0_vec)) {
  prob_tv[i] &lt;- ifelse(i == 1, p0_vec[i], rate * prob_tv[i - 1])
}
prob_tv[prob_tv &gt; 1] &lt;- 1
y3 &lt;- rtvgeom(1e3, prob_tv)
x3 &lt;- seq_len(max(y3))
z3 &lt;- dtvgeom(x3, prob_tv)
plot(table(y3) / 1e3,
  xlab = x_lab, col = "#00000020", bty = "n",
  ylim = c(0, max(z3)),
  ylab = sprintf("P(success at trial n | prob = %s)", "`prob_tv`")
)
lines(x3, z3, type = "l")
</code></pre>

<hr>
<h2 id='tvgeom-moments'>Moments for the The Time-Varying (Right-Truncated) Geometric Distribution</h2><span id='topic+tvgeom-moments'></span><span id='topic+tvgeom_mean'></span><span id='topic+tvgeom_var'></span>

<h3>Description</h3>

<p>Functions to calculate first moment <code>tvgeom_mean()</code> and second central
moment <code>tvgeom_var()</code> for the time-varying geometric distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvgeom_mean(prob)

tvgeom_var(prob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tvgeom-moments_+3A_prob">prob</code></td>
<td>
<p>vector of the probability of success for each trial/time step.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>tvgeom_mean</code> returns the moment (the mean), and
<code>tvgeom_var</code> returns the second central moment (the variance).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tvgeom_mean(prob = rep(0.1, 5))
tvgeom_var(prob = rep(0.1, 5))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
