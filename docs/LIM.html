<!DOCTYPE html><html lang="en"><head><title>Help for package LIM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LIM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#LIM-package'>
<p>Linear Inverse Model examples and solution methods</p></a></li>
<li><a href='#FILERigaAutumn'>
<p>Input text &quot;file&quot; for gulf of Riga autumn planktonic food web</p></a></li>
<li><a href='#Flowmatrix'>
<p>Generates a flow matrix for an inverse (foodweb) problem</p></a></li>
<li><a href='#Ldei'>
<p>Solves a linear inverse model using least distance programming</p></a></li>
<li><a href='#LIMBlending'>
<p>A blending problem specification</p></a></li>
<li><a href='#LIMBrouageMudflat'>
<p>Linear inverse model specification for the Intertidal mudflat food web</p>
on the Atlantic coast of France</a></li>
<li><a href='#LIMCaliforniaSediment'>
<p>Linear inverse model specification for the Santa Monica Basin</p>
sediment food web</a></li>
<li><a href='#LIMCoralRockall'>
<p>Linear inverse model specification for the Deep-water Coral food web</p>
at Rockall Bank</a></li>
<li><a href='#LIMEcoli'>
<p>The Escherichia Coli Core Metabolism: Reaction network model specificiation</p></a></li>
<li><a href='#LIMEverglades'>
<p>Linear inverse model specification for the herpetological food web</p>
of the Everglades</a></li>
<li><a href='#LIMRigaAutumn'>
<p>Linear inverse model specification for the Gulf of Riga *autumn*</p>
planktonic food web</a></li>
<li><a href='#LIMRigaSpring'>
<p>Linear inverse model specification for the Gulf of Riga *spring*</p>
planktonic food web.</a></li>
<li><a href='#LIMRigaSummer'>
<p>Linear inverse model specification for the Gulf of Riga *summer*</p>
planktonic food web.</a></li>
<li><a href='#LIMScheldtIntertidal'>
<p>Linear inverse model specification for the Schelde Intertidal flat food web</p></a></li>
<li><a href='#LIMTakapoto'>
<p>Linear inverse model specification for the Takapoto atoll planktonic</p>
food web.</a></li>
<li><a href='#Linp'>
<p>Solves a linear inverse model using linear programming.</p></a></li>
<li><a href='#Lsei'>
<p>Solves a linear inverse model using the least squares method.</p></a></li>
<li><a href='#Plotranges'>
<p>Plots the minimum and maximum and central values</p></a></li>
<li><a href='#PrintMat'>
<p>Writes linear inverse matrices to the screen</p></a></li>
<li><a href='#Read'><p>Reads an inverse input file</p></a></li>
<li><a href='#Setup'><p>Creates linear inverse matrices</p></a></li>
<li><a href='#Variables'>
<p>Generates the values of variables for a linear inverse (foodweb) problem</p></a></li>
<li><a href='#Varranges'>
<p>Generates ranges of the variables for a linear inverse problem</p></a></li>
<li><a href='#Xranges'>
<p>Generates ranges of the unknowns of a linear inverse problem</p></a></li>
<li><a href='#Xsample'>
<p>Generates a random sample of the unknowns for a linear inverse problem</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.4.7.1</td>
</tr>
<tr>
<td>Title:</td>
<td>Linear Inverse Model Examples and Solution Methods</td>
</tr>
<tr>
<td>Author:</td>
<td>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;,
  Dick van Oevelen&lt;dick.vanoevelen@nioz.nl&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.01), limSolve, diagram</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions that read and solve linear inverse problems (food web problems, linear programming problems).
  These problems find solutions to linear or quadratic functions:
  min or max (f(x)), where f(x) = ||Ax-b||^2 or f(x) = sum(ai*xi)
  subject to equality constraints Ex=f and inequality constraints Gx&gt;=h. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-06 07:50:16 UTC; karlines</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-06 09:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='LIM-package'>
Linear Inverse Model examples and solution methods
</h2><span id='topic+LIM-package'></span><span id='topic+LIM'></span>

<h3>Description</h3>

<p>functions that read and solve linear inverse problems (food web problems,
linear programming problems, flux balance analysis).
</p>
<p>These problems find solutions to linear or quadratic functions:
min or max (f(x)), where <code class="reqn">f(x) = ||Ax-b||^2</code> or <code class="reqn">f(x) = sum(ai*xi)</code>
</p>
<p>subject to equality constraints <code class="reqn">Ex=f</code> and inequality
constraints <code class="reqn">Gx&gt;=h</code>.
</p>
<p>Uses package limSolve.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> LIM</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 1.4.3</td>
</tr>
<tr>
 <td style="text-align: left;">
    Date: </td><td style="text-align: left;"> 2011-09-05</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> GNU Public License 2 or above</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>The model problem is formulated in text files in a way that is natural and
comprehensible. Functions in <code>LIM</code> then converts this input into the
required linear equality and inequality conditions, which can be solved
either by least squares or by linear programming techniques. By
letting an algorithm formulate the mathematics, it is
simple to reformulate the model in case a parameter value changes,
or a component is added or removed.
</p>
<p>Three different types of problems are supported: 
</p>
<p>flow networks,
</p>
<p>reaction networks (e.g. flux balance analysis).
</p>
<p>and other (operations research) problems. 
</p>
<p>The first two cases are based on mass balances of the components.
</p>
<p>The package includes many examples
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert (Maintainer),
</p>
<p>Dick van Oevelen
</p>


<h3>References</h3>

<p>Description of the software:
</p>
<p>van Oevelen D, Van den Meersche K, Meysman FJR Soetaert K, Middelburg JJ, Vezina AF.,
2009. Quantifying Food Web Flows Using Linear Inverse Models.  
Ecosystems 13: 32-45
DOI: 10.1007/s10021-009-9297-6.
</p>
<p>http://www.springerlink.com/content/4q6h4011511731m5/fulltext.pdf
</p>
<p>(please use the above citation when using the software)
</p>
<p>About food web modelling:
</p>
<p>Soetaert, K., van Oevelen, D., 2009. 
Modeling food web interactions in benthic deep-sea ecosystems: a practical guide. 
Oceanography (22) 1: 130-145.
</p>
<p>Application of deep-water food web:
</p>
<p>van Oevelen, Dick, Gerard Duineveld, Marc Lavaleye, Furu Mienis,    
Karline Soetaert, and Carlo H. R. Heip, 2009.                      
The cold-water coral community as hotspot of carbon cycling on     
continental margins: A food web analysis from Rockall Bank         
(northeast Atlantic). Limnology and Oceangraphy 54:1829-1844.      
</p>
<p>http://www.aslo.org/lo/toc/vol_54/issue_6/1829.pdf
</p>
<p>A flux balance analysis application:
</p>
<p>Karline Soetaert. Escherichia coli Core Metabolism Model in LIM. 
LIM package vignette (see also below).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Read">Read</a></code>, <code><a href="#topic+Setup">Setup</a></code> for reading files and creating the model
</p>
<p><code><a href="#topic+Ldei">Ldei</a></code>, <code><a href="#topic+Lsei">Lsei</a></code>,<code><a href="#topic+Linp">Linp</a></code>,
</p>
<p><code><a href="#topic+Flowmatrix">Flowmatrix</a></code>, <code><a href="#topic+Plotranges">Plotranges</a></code>, <code><a href="#topic+Variables">Variables</a></code>,
</p>
<p><code><a href="#topic+Varranges">Varranges</a></code>, <code><a href="#topic+Xranges">Xranges</a></code>, <code><a href="#topic+Xsample">Xsample</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## show examples (see respective help pages for details)
example(Lsei)
example(LIMRigaSpring)
example(Ldei)
example(Xsample)
example(Varranges)

## run demos
demo("LIMexamples")

## open the directory with R sourcecode examples
browseURL(paste(system.file(package="LIM"), "/doc/examples/Foodweb", sep=""))
browseURL(paste(system.file(package="LIM"), "/doc/examples/LinearProg", sep=""))
browseURL(paste(system.file(package="LIM"), "/doc/examples/Reactions", sep=""))

## the deep-water coral food -web
browseURL(paste(system.file(package="LIM"), "/doc/examples/Foodweb/coral", sep=""))

## show package vignette with tutorial about how to create input files
vignette("LIM")

## E.coli example vignette - flux balance analysis
vignette("LIMecoli")

browseURL(paste(system.file(package="LIM"), "/doc", sep=""))

## End(Not run)
</code></pre>

<hr>
<h2 id='FILERigaAutumn'>
Input text &quot;file&quot; for gulf of Riga autumn planktonic food web
</h2><span id='topic+FILERigaAutumn'></span>

<h3>Description</h3>

<p>Input text &quot;file&quot; for the Carbon flux Gulf of Riga planktonic food web
in autumn as described in Donali et al. (1999).
</p>
<p>The Gulf of Riga is a highly eutrophic system in the Baltic Sea
</p>
<p>The foodweb comprises 7 functional compartments and two external
compartments, connected with 26 flows.
</p>
<p>Units of the flows are mg C/m3/day
</p>
<p>The &quot;dataset&quot; RigaAutumnFile is included to demonstrate the use of a
text input file for food web models.
</p>
<p>The original file, RigaAutumn.input can be found in subdirectory
&lsquo;<span class="file">web</span>&rsquo; of the packages directory
</p>
<p>In this subdirectory you will find many foodweb example input files
</p>

<ul>
<li><p> They can be read using <code><a href="#topic+Read">Read</a></code>(file)
</p>
</li>
<li><p> Or they can be directly solved using <code><a href="#topic+Setup">Setup</a></code>(file)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(FILERigaAutumn)
</code></pre>


<h3>Format</h3>

<p>vector of character strings as present in the original file
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Donali, E., Olli, K., Heiskanen, A.S., Andersen, T., 1999. Carbon flow
patterns in the planktonic food web of the Gulf of Riga, the Baltic Sea:
a reconstruction by the inverse method. Journal of Marine Systems 23,
251..268.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LIMRigaAutumn">LIMRigaAutumn</a></code> a list containing the linear inverse model
specification, generated from file &lsquo;<span class="file">RigaAutumn.input</span>&rsquo;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(FILERigaAutumn)

# RigaAutumnInput is a vector of text strings - 
# here it is first converted to a "File" 
# When using the example files in the LIM directory, 
# this first statement is not necessary
## Not run: 
File &lt;- textConnection(FILERigaAutumn)
RigaAutumn.input &lt;- Read(File)

## End(Not run)

</code></pre>

<hr>
<h2 id='Flowmatrix'>
Generates a flow matrix for an inverse (foodweb) problem
</h2><span id='topic+Flowmatrix'></span>

<h3>Description</h3>

<p>Given a linear inverse model food web input list, generates a flow
matrix, that contains the values of flows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Flowmatrix(lim, web = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Flowmatrix_+3A_lim">lim</code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td></tr>
<tr><td><code id="Flowmatrix_+3A_web">web</code></td>
<td>
<p>the solved (food) web problem, i.e. the values of the
unknowns; if not specified, the model is solved first, using <code>Lsei</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the flow matrix, containing the magnitude of the flows.
</p>
<p>The value on row i and column j is the flow *from* i and *to* j
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><code><a href="diagram.html#topic+plotweb">plotweb</a></code> from package <code>diagram</code>,
which takes as input the flow matrix and plots the food web
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Flowmatrix(LIMRigaAutumn)
</code></pre>

<hr>
<h2 id='Ldei'>
Solves a linear inverse model using least distance programming
</h2><span id='topic+Ldei'></span><span id='topic+Ldei.lim'></span><span id='topic+Ldei.limfile'></span><span id='topic+Ldei.character'></span><span id='topic+Ldei.double'></span>

<h3>Description</h3>

<p>Solves a linear inverse model using least distance programming,
i.e. minimizes the sum of squared unknowns.
</p>
<p>Input presented either:
</p>

<ul>
<li><p> as matrices E, F, A, B, G, H (Ldei.double)
</p>
</li>
<li><p> as a list (Ldei.lim) or
</p>
</li>
<li><p> as a lim input file (Ldei.limfile)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Ldei(...)
## S3 method for class 'lim'
Ldei(lim, ...)
## S3 method for class 'limfile'
Ldei(file, verbose = TRUE, ...)
## S3 method for class 'character'
Ldei(...)
## S3 method for class 'double'
Ldei(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Ldei_+3A_lim">lim</code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td></tr>
<tr><td><code id="Ldei_+3A_file">file</code></td>
<td>
<p>name of the inverse input file.
</p>
</td></tr>
<tr><td><code id="Ldei_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>: prints warnings and messages to the screen.
</p>
</td></tr>
<tr><td><code id="Ldei_+3A_...">...</code></td>
<td>
<p>other arguments passed to function
<code><a href="limSolve.html#topic+ldei">ldei</a></code> from package<code>limSolve</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Solves the following inverse problem:
</p>
<p style="text-align: center;"><code class="reqn">\min(\sum {Cost_i*x_i}^2)</code>
</p>
<p> subject to
</p>
<p style="text-align: center;"><code class="reqn">Ax=B</code>
</p>

<p style="text-align: center;"><code class="reqn">Gx&gt;=H</code>
</p>



<h3>Value</h3>

<p>a list containing:
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>vector containing the solution of the least distance problem.
</p>
</td></tr>
<tr><td><code>unconstrained.Solution</code></td>
<td>
<p>vector containing the unconstrained
solution of the least distance problem.
</p>
</td></tr>
<tr><td><code>residualNorm</code></td>
<td>
<p>scalar, the sum of residuals of equalities and
violated inequalities.
</p>
</td></tr>
<tr><td><code>solutionNorm</code></td>
<td>
<p>scalar, the value of the quadratic function
at the solution.
</p>
</td></tr>
<tr><td><code>IsError</code></td>
<td>
<p>logical, <code>TRUE</code>, if an error occurred.
</p>
</td></tr>
<tr><td><code>Error</code></td>
<td>
<p>ldei error text.
</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>ldei.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Lawson C.L.and Hanson R.J. 1974. SOLVING LEAST SQUARES PROBLEMS,
Prentice-Hall
</p>
<p>Lawson C.L.and Hanson R.J. 1995. Solving Least Squares Problems.
SIAM classics in applied mathematics, Philadelphia.        (reprint of book)
</p>


<h3>See Also</h3>

<p><code><a href="limSolve.html#topic+ldei">ldei</a></code>, the more general function from package limSolve.
</p>
<p><code><a href="#topic+Linp">Linp</a></code>, to solve the linear inverse problem by linear programming.
</p>
<p><code><a href="#topic+Lsei">Lsei</a></code>, to solve the linear inverse problem by lsei (least
squares with equality and inequality constraints).
</p>
<p>function <code><a href="limSolve.html#topic+ldei">ldei</a></code> from package<code>limSolve</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Ldei(LIMRigaAutumn)
</code></pre>

<hr>
<h2 id='LIMBlending'>
A blending problem specification
</h2><span id='topic+LIMinputBlending'></span><span id='topic+LIMBlending'></span>

<h3>Description</h3>

<p>A manufacturer produces a feeding mix for pet animals.
</p>
<p>The feed mix contains two nutritive ingredients and one ingredient
(filler) to provide bulk.
</p>
<p>One kg of feed mix must contain a minimum quantity of each of four
nutrients as below:
</p>

<table>
<tr>
 <td style="text-align: right;">
       </td><td style="text-align: left;"> Nutrient  </td><td style="text-align: left;"> A  </td><td style="text-align: left;"> B  </td><td style="text-align: left;"> C  </td><td style="text-align: left;"> D </td>
</tr>
<tr>
 <td style="text-align: right;">
       </td><td style="text-align: left;"> gram      </td><td style="text-align: left;"> 80 </td><td style="text-align: left;"> 50 </td><td style="text-align: left;"> 25 </td><td style="text-align: left;"> 5 </td>
</tr>
<tr>
 <td style="text-align: right;">
       </td>
</tr>

</table>

<p>The ingredients have the following nutrient values and cost
</p>

<table>
<tr>
 <td style="text-align: right;">
 </td><td style="text-align: left;">  (gram/kg)    </td><td style="text-align: left;"> A   </td><td style="text-align: left;">   B </td><td style="text-align: left;"> C  </td><td style="text-align: left;"> D    </td><td style="text-align: left;"> Cost/kg </td>
</tr>
<tr>
 <td style="text-align: right;">
 </td><td style="text-align: left;"> Ingredient 1  </td><td style="text-align: left;"> 100 </td><td style="text-align: left;">  50 </td><td style="text-align: left;"> 40 </td><td style="text-align: left;"> 10   </td><td style="text-align: left;"> 40  </td>
</tr>
<tr>
 <td style="text-align: right;">
 </td><td style="text-align: left;"> Ingredient 2  </td><td style="text-align: left;"> 200 </td><td style="text-align: left;"> 150 </td><td style="text-align: left;"> 10 </td><td style="text-align: left;">  -   </td><td style="text-align: left;"> 60  </td>
</tr>
<tr>
 <td style="text-align: right;">
 </td><td style="text-align: left;"> Filler        </td><td style="text-align: left;"> -   </td><td style="text-align: left;"> -   </td><td style="text-align: left;"> -  </td><td style="text-align: left;">  -   </td><td style="text-align: left;"> 0   </td>
</tr>
<tr>
 <td style="text-align: right;">
       </td>
</tr>

</table>

<p>The linear inverse models LIMBlending and LIMinputBlending are generated
from the file Blending.input
which can be found in subdirectory <code>/examples/LinearProg</code> of the
package directory
</p>
<p>LIMBlending is generated by function <code>Setup</code>
</p>
<p>LIMinputBlending is generated by function <code>Read</code>
</p>
<p>The problem is to find the composition of the feeding mix that minimises
the production costs subject to the constraints above.
</p>
<p>Stated otherwise: what is the optimal amount of ingredients in one kg
of feeding mix?
</p>
<p>Mathematically this can be estimated by solving a linear programming problem:
</p>
<p style="text-align: center;"><code class="reqn">\min(\sum {Cost_i*x_i})</code>
</p>
<p> subject to
</p>
<p style="text-align: center;"><code class="reqn">x_i&gt;=0</code>
</p>

<p style="text-align: center;"><code class="reqn">Ex=f</code>
</p>

<p style="text-align: center;"><code class="reqn">Gx&gt;=h</code>
</p>

<p>Where the <code>Cost</code> (to be minimised) is given by:
</p>
<p style="text-align: center;"><code class="reqn">x_1*40+x_2*60</code>
</p>

<p>The <code>equality</code> ensures that the sum of the three fractions equals 1:
</p>
<p style="text-align: center;"><code class="reqn">1 = x_1+x_2+x_3</code>
</p>

<p>And the <code>inequalities</code> enforce the nutritional constraints:
</p>
<p style="text-align: center;"><code class="reqn">100*x_1+200*x_2&gt;80</code>
</p>

<p style="text-align: center;"><code class="reqn">50*x_1+150*x_2&gt;50</code>
</p>

<p>and so on
</p>
<p>The solution is Ingredient1 (x1) = 0.5909, Ingredient2 (x2)=0.1364
and Filler (x3)=0.2727.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LIMBlending
LIMinputBlending
</code></pre>


<h3>Format</h3>

<p>LIMBlending is of type <code>lim</code>, which is a list of matrices,
vectors, names and values that specify the linear inverse model problem.
</p>
<p>see the return value of <code><a href="#topic+Setup">Setup</a></code> for more information about
this list
</p>
<p>LIMinputBlending is of type <code>liminput</code>, see the return value of
<code><a href="#topic+Read">Read</a></code> for more information.
</p>
<p>A more complete description of these structures is in vignette(&quot;LIM&quot;)
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p>browseURL(paste(system.file(package=&quot;LIM&quot;), &quot;/doc/examples/LinearProg/&quot;, sep=&quot;&quot;))
</p>
<p>contains &quot;blending.input&quot;, the input file; read this with <code>Setup</code>
</p>
<p><code><a href="#topic+LIMTakapoto">LIMTakapoto</a></code>, <code><a href="#topic+LIMEcoli">LIMEcoli</a></code> and many others
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. Solve the model with linear programming
res &lt;- Linp(LIMBlending, ispos = TRUE)

# show results
print(c(res$X, Cost = res$solutionNorm))


# 2. Possible ranges of the three ingredients
(xr &lt;- Xranges(LIMBlending, ispos = TRUE))
Nx &lt;- LIMBlending$NUnknowns

# plot
dotchart(x = as.vector(res$X), xlim = range(xr),
         labels = LIMBlending$Unknowns,
         main = "Optimal blending with ranges",
         sub = "using linp and xranges", pch = 16)
segments(xr[ ,1], 1:Nx, xr[ ,2], 1:Nx)
legend  ("topright", pch = c(16, NA), lty = c(NA, 1),
          legend = c("Minimal cost", "range"))

# 3. Random sample of the three ingredients
# The inequality that all x &gt; 0 has to be added!
blend   &lt;- LIMBlending
blend$G &lt;- rbind(blend$G, diag(3))
blend$H &lt;- c(blend$H, rep(0, 3))

xs &lt;- Xsample(blend)

pairs(xs, main = "Blending, 3000 solutions with xsample")
</code></pre>

<hr>
<h2 id='LIMBrouageMudflat'>
Linear inverse model specification for the Intertidal mudflat food web
on the Atlantic coast of France
</h2><span id='topic+LIMBrouageMudflat'></span>

<h3>Description</h3>

<p>Linear inverse model specification for the Intertidal mudflat food web
on the Atlantic coast of France as in Leguerrier et al., 2003.
</p>
<p>The foodweb comprises 16 functional compartments and 3 external
compartments, connected with 95 flows.
</p>
<p>Units of the flows are g C/m2/year
</p>
<p>The linear inverse model LIMBrouageMudflat is generated from the file
BrouageMudflat.input which can be found in subdirectory
<code>/examples/FoodWeb</code> of the package directory
</p>
<p>In this subdirectory you will find many foodweb example input files
</p>
<p>These files can be read using <code><a href="#topic+Read">Read</a></code> and their output
processed by <code><a href="#topic+Setup">Setup</a></code> which will produce a linear inverse
problem specification similar to LIMBrouageMudflat
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LIMBrouageMudflat)
</code></pre>


<h3>Format</h3>

<p>a list of matrices, vectors, names and values that specify the linear
inverse model problem.
</p>
<p>see the return value of <code><a href="#topic+Setup">Setup</a></code> for more information about
this list
</p>
<p>A more complete description of this structures is in vignette(&quot;LIM&quot;)
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
Dick van Oevelen &lt;dick.vanoevelen@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Leguerrier, D., Niquil, N., Boileau, N., Rzeznik, J., Sauriau, P.G.,
Le Moine, O., Bacher, C., 2003.
Numerical analysis of the food web of an intertidal mudflat ecosystem
on the Atlantic coast of France. Marine Ecology Progress Series 246, 17-37.
</p>


<h3>See Also</h3>

<p>browseURL(paste(system.file(package=&quot;LIM&quot;), &quot;/doc/examples/Foodweb/&quot;, sep=&quot;&quot;))
</p>
<p>contains &quot;BrouageMudflat.input&quot;, the input file; read this with <code>Setup</code>
</p>
<p><code><a href="#topic+LIMTakapoto">LIMTakapoto</a></code>, <code><a href="#topic+LIMRigaSummer">LIMRigaSummer</a></code> and many others
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Brouage &lt;- Flowmatrix(LIMBrouageMudflat)
plotweb(Brouage, main = "Brouage mudflat food web", sub = "gC/m2/yr")
# Some ranges are infinite -&gt;marked with "*
Plotranges(LIMBrouageMudflat, lab.cex = 0.7, sub = "*=unbounded",
           xlab = "gC/m2/year", main = "Brouage mudflat, Flowranges")
Plotranges(LIMBrouageMudflat, type = "V", lab.cex = 0.7, 
           sub = "*=unbounded",
           xlab = "gC/m2/year",main="Brouage mudflat, Variable ranges")
</code></pre>

<hr>
<h2 id='LIMCaliforniaSediment'>
Linear inverse model specification for the Santa Monica Basin
sediment food web
</h2><span id='topic+LIMCaliforniaSediment'></span>

<h3>Description</h3>

<p>Linear inverse model specification for the Santa Monica Basin
(California) sediment food web  as in Eldridge and Jackson (1993).
</p>
<p>The Santa Monica Basin is a hypoxic-anoxic basin located near California.
</p>
<p>The model contains both chemical and biological species.
</p>
<p>The foodweb comprises 7 functional compartments and five external
compartments, connected with 32 flows.
</p>
<p>Units of the flows are mg /m2/day
</p>
<p>The linear inverse model LIMCaliforniaSediment is generated from the file
&lsquo;<span class="file">CaliforniaSediment.input</span>&rsquo; which can be found in
subdirectory <code>/examples/FoodWeb</code> of the package directory
</p>
<p>In this subdirectory you will find many foodweb example input files
</p>
<p>These files can be read using <code><a href="#topic+Read">Read</a></code> and their output
processed by <code><a href="#topic+Setup">Setup</a></code> which will produce a linear inverse
problem specification similar to LIMCaliforniaSediment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LIMCaliforniaSediment)
</code></pre>


<h3>Format</h3>

<p>a list of matrices, vectors, names and values that specify the linear
inverse model problem.
</p>
<p>see the return value of <code><a href="#topic+Setup">Setup</a></code> for more information about
this list
</p>
<p>A more complete description of this structures is in vignette(&quot;LIM&quot;)
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
Dick van Oevelen &lt;dick.vanoevelen@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Eldridge, P.M., Jackson, G.A., 1993. Benthic trophic dynamics in
California coastal basin and continental slope communities inferred
using inverse analysis. Marine Ecology Progress Series 99, 115-135.
</p>


<h3>See Also</h3>

<p>browseURL(paste(system.file(package=&quot;LIM&quot;), &quot;/doc/examples/Foodweb/&quot;, sep=&quot;&quot;))
</p>
<p>contains &quot;CaliforniaSediment.input&quot;, the input file; read this with <code>Setup</code>
</p>
<p><code><a href="#topic+LIMTakapoto">LIMTakapoto</a></code>, <code><a href="#topic+LIMRigaSummer">LIMRigaSummer</a></code> and many others
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CaliforniaSediment &lt;- Flowmatrix(LIMCaliforniaSediment)
plotweb(CaliforniaSediment, main = "Santa Monica Basin Benthic web",
        sub = "mgN/m2/day", lab.size = 0.8)
## Not run: 
xr &lt;- LIMCaliforniaSediment$NUnknowns
i1 &lt;- 1:(xr/2)
i2 &lt;- (xr/2+1):xr
Plotranges(LIMCaliforniaSediment, index = i1, lab.cex = 0.7,
        sub = "*=unbounded",
        main = "Santa Monica Basin Benthic web, Flowranges - part1")
Plotranges(LIMCaliforniaSediment, index = i2, lab.cex = 0.7,
        sub = "*=unbounded",
        main = "Santa Monica Basin Benthic web, Flowranges - part2")
## End(Not run)
</code></pre>

<hr>
<h2 id='LIMCoralRockall'>
Linear inverse model specification for the Deep-water Coral food web
at Rockall Bank
</h2><span id='topic+LIMCoralRockall'></span>

<h3>Description</h3>

<p>Linear inverse model specification for the deep-water coral ecosystem
at Rockall Bank, North-East Atlantic. See van Oevelen et al. (2009)
</p>
<p>Units of the flows are mmol C/m2/day
</p>
<p>The linear inverse model LIMCoralRockall is generated from the file
&lsquo;<span class="file">CWCRockall.input</span>&rsquo; which can be found in
subdirectory <code>/examples/FoodWeb</code> of the package directory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LIMCoralRockall)
</code></pre>


<h3>Format</h3>

<p>a list of matrices, vectors, names and values that specify the linear
inverse model problem.
</p>
<p>see the return value of <code><a href="#topic+Setup">Setup</a></code> for more information about
this list
</p>
<p>A more complete description of this structure is in vignette(&quot;LIM&quot;)
</p>


<h3>Author(s)</h3>

<p>Dick van Oevelen &lt;dick.vanoevelen@nioz.nl&gt;
</p>
<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>van Oevelen, Dick, Gerard Duineveld, Marc Lavaleye, Furu Mienis,
Karline Soetaert, and Carlo H. R. Heip, 2009.
</p>
<p>The cold-water coral community as hotspot of carbon cycling on
continental margins: A food web analysis from Rockall Bank
(northeast Atlantic). Limnology and Oceangraphy 54 : 1829 &ndash; 1844.
</p>
<p>http://www.aslo.org/lo/toc/vol_54/issue_6/1829.pdf
</p>


<h3>See Also</h3>

<p>browseURL(paste(system.file(package=&quot;LIM&quot;), &quot;/examples/Foodweb/&quot;, sep=&quot;&quot;))
</p>
<p>contains &quot;CWCRockall.input&quot;, the input file; read this with <code>Setup</code>
</p>
<p><code><a href="#topic+LIMTakapoto">LIMTakapoto</a></code>, <code><a href="#topic+LIMRigaSummer">LIMRigaSummer</a></code> and many others
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Coral &lt;- Flowmatrix(LIMCoralRockall)

plotweb(Coral, main = "Deep Water Coral Foodweb, Rockall Bank",
        sub = "mmolC/m2/day", lab.size = 0.8)


## Not run: 
xr &lt;- LIMCoralRockall$NUnknowns
i1 &lt;- 1:(xr/2)
i2 &lt;- (xr/2+1):xr

pm &lt;- par(mfrow = c(1, 1))
Simplest &lt;- Ldei(LIMCoralRockall)$X
Ranges &lt;- Xranges(LIMCoralRockall)
Plotranges(Ranges[i1, 1], Ranges[i1, 2], Simplest[i1], lab.cex = 0.7,
        main = "Deep Water Coral - ranges part 1")

Plotranges(Ranges[i2, 1], Ranges[i2, 2], Simplest[i2], lab.cex = 0.7,
        main = "Deep Water Coral - ranges part 2")
par(mfrow = pm)

## End(Not run)
</code></pre>

<hr>
<h2 id='LIMEcoli'>
The Escherichia Coli Core Metabolism: Reaction network model specificiation
</h2><span id='topic+LIMEcoli'></span>

<h3>Description</h3>

<p>Linear inverse model specification for performing Flux Balance Analysis
of the E.coli metabolism
</p>
<p>(as from <code>http://gcrg.ucsd.edu/Downloads/Flux_Balance_Analysis</code>).
</p>
<p>The original input file can be found in the package subdirectory
<code>/examples/Reactions/E_coli.lim</code>
</p>
<p>There are 53 substances:
</p>
<p>GLC, G6P, F6P, FDP, T3P2, T3P1, 13PDG, 3PG, 2PG, PEP,
PYR, ACCOA, CIT, ICIT, AKG, SUCCOA, SUCC, FUM, MAL, OA,
ACTP, ETH, AC, LAC, FOR, D6PGL, D6PGC, RL5P, X5P,
R5P, S7P, E4P, RIB, GLX, NAD, NADH, NADP, NADPH, HEXT,
Q, FAD, FADH, AMP, ADP,
ATP, GL3P, CO2, PI, PPI, O2, COA, GL, QH2
</p>
<p>and 13 externals:
</p>
<p>Biomass, GLCxt, GLxt, RIBxt, ACxt, LACxt, FORxt, ETHxt, SUCCxt,
PYRxt, PIxt, O2xt, CO2xt
</p>
<p>There are 70 unknown reactions (named by the gene encoding for it):
</p>
<p>GLK1,  PGI1,  PFKA,  FBP, FBA, TPIA, GAPA, PGK, GPMA, ENO,
PPSA, PYKA, ACEE, ZWF, PGL, GND,
RPIA, RPE, TKTA1, TKTA2, TALA, GLTA, ACNA, ICDA, SUCA,
SUCC1, SDHA1, FRDA, FUMA, MDH,
DLD1, ADHE2, PFLA, PTA, ACKA, ACS, PCKA, PPC, MAEB, SFCA,
ACEA, ACEB, PPA, GLPK, GPSA1,
RBSK, NUOA, FDOH, GLPD, CYOA, SDHA2, PNT1A, PNT2A, ATPA,
GLCUP, GLCPTS, GLUP, RIBUP,
ACUP, LACUP, FORUP, ETHUP, SUCCUP, PYRUP, PIUP, O2TX,
CO2TX, ATPM, ADK, Growth
</p>
<p>The model contains:
</p>

<ul>
<li><p> 54 equalities (Ax=B): the 53 mass balances
(one for each substance) and one equation that sets the ATP
drain flux for constant maintenance requirements to a fixed value (5.87)
</p>
</li>
<li><p> 70 unknowns (x), the reaction rates
</p>
</li>
<li><p> 62 inequalities (Gx&gt;h). The first 28 inequalities impose
bounds on some reactions. The last 34 inequalities impose that
the reaction rates have to be positive (for unidirectional reactions
only).
</p>
</li>
<li><p> 2 functions that have to be maximised, the biomass production
(growth).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>LIMEcoli
</code></pre>


<h3>Format</h3>

<p>LIMEcoli is of type <code>lim</code>, which is a list of matrices, vectors,
names and values that specify the linear inverse model problem.
</p>
<p>see the return value of <code><a href="#topic+Setup">Setup</a></code> for more information
about this list
</p>
<p>A more complete description of this structures is in vignette(&quot;LIM&quot;)
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Edwards,J.S., Covert, M., and Palsson, B..,  (2002)
Metabolic Modeling of Microbes: the Flux Balance Approach,
Environmental Microbiology, 4(3): pp. 133-140.
</p>


<h3>See Also</h3>

<p>browseURL(paste(system.file(package=&quot;LIM&quot;), &quot;/doc/examples/Reactions/&quot;, sep=&quot;&quot;))
</p>
<p>contains &quot;E_coli.lim&quot;, the input file; read this with <code>Setup</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# 1. parsimonious (simplest) solution
pars &lt;- Ldei(LIMEcoli)

# 2. the ranges of each reaction
xr  &lt;- Xranges(LIMEcoli, central = TRUE, full = TRUE)

# 3. the optimal solution - solved with linear programming
LP  &lt;- Linp(LIMEcoli)
Optimal &lt;- t(LP$X)

# show the results
data.frame(pars = pars$X, Optimal, xr[ ,1:3])

# The central value of linear programming problem is a valid solution
# the central point is a valid solution:
X   &lt;- xr[ ,"central"]
max(abs(LIMEcoli$A%*%X - LIMEcoli$B))
min(LIMEcoli$G%*%X - LIMEcoli$H)

# 4. Sample solution space  - this takes a while - note that iter is not enough
print(system.time(
  xs &lt;- Xsample(LIMEcoli, iter = 200, type = "mirror", test = TRUE)  ))

pairs(xs[ ,1:10], pch = ".", cex = 2)

# Print results:
data.frame(pars = pars$X, Optimal = Optimal, xr[ ,1:2],
           Mean = colMeans(xs), sd = apply(xs,2,sd))

# Plot results
par(mfrow = c(1, 2))
nr &lt;- LIMEcoli$NUnknowns
ii &lt;- 1:(nr/2)
dotchart(Optimal[ii, 1], xlim = range(xr), pch = 16, cex = 0.8)
segments(xr[ii, 1], 1:nr, xr[ii, 2], 1:nr)
ii &lt;- (nr/2+1):nr
dotchart(Optimal[ii, 1], xlim = range(xr), pch = 16, cex = 0.8)
segments(xr[ii, 1], 1:nr, xr[ii, 2], 1:nr)
mtext(side = 3, cex = 1.5, outer = TRUE, line = -1.5,
      "E coli Core Metabolism, optimal solution and ranges")
</code></pre>

<hr>
<h2 id='LIMEverglades'>
Linear inverse model specification for the herpetological food web
of the Everglades
</h2><span id='topic+LIMEverglades'></span>

<h3>Description</h3>

<p>Linear inverse model specification for the herpetological wet prairie
example from the everglades.
</p>
<p>as described in Diffendorfer et al., 2001
</p>
<p>The everglades are a freshwater wetland in Florida, USA.
</p>
<p>The model contains 9 functional compartments and 3 external compartments,
connected with 402 flows.
</p>
<p>Units of the flows are gram wet weight / Ha / year
</p>
<p>The linear inverse model LIMEverglades is generated from the file
Everglades.input which can be found in subdirectory <code>/examples/FoodWeb</code>
of the package directory
</p>
<p>In this subdirectory you will find many foodweb example input files
</p>
<p>These files can be read using <code><a href="#topic+Read">Read</a></code> and their output
processed by <code><a href="#topic+Setup">Setup</a></code> which will produce a linear inverse
problem specification similar to LIMEverglades
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LIMEverglades)
</code></pre>


<h3>Format</h3>

<p>a list of matrices, vectors, names and values that specify the linear
inverse model problem.
</p>
<p>see the return value of <code><a href="#topic+Setup">Setup</a></code> for more information about
this list
</p>
<p>A more complete description of this structures is in vignette(&quot;LIM&quot;)
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
Dick van Oevelen &lt;dick.vanoevelen@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Diffendorfer, J.E., Richards, P.M., Dalrymple, G.H., DeAngelis, D.L., 2001.
Applying Linear Programming to estimate fluxes in ecosystems or food webs:
an example from the herpetological assemblage of the freshwater Everglades.
Ecol. Model. 144, 99-120.
</p>


<h3>See Also</h3>

<p>browseURL(paste(system.file(package=&quot;LIM&quot;), &quot;/doc/examples/Foodweb/&quot;, sep=&quot;&quot;))
</p>
<p>contains &quot;Everglades.input&quot;, the input file; read this with <code>Setup</code>
</p>
<p><code><a href="#topic+LIMTakapoto">LIMTakapoto</a></code>, <code><a href="#topic+LIMRigaSummer">LIMRigaSummer</a></code> and many others
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Cannot be solved, but the least squares solution is found
Flows &lt;- Lsei(LIMEverglades, parsimonious = TRUE)
Everglades &lt;- Flowmatrix(LIMEverglades)
plotweb(Everglades, main = "Everglades Herpetological Wet Prairie model",
        sub = "g WW/Ha/Yr", lab.size = 0.8)
</code></pre>

<hr>
<h2 id='LIMRigaAutumn'>
Linear inverse model specification for the Gulf of Riga *autumn*
planktonic food web
</h2><span id='topic+LIMRigaAutumn'></span>

<h3>Description</h3>

<p>Linear inverse model specification for the Gulf of Riga planktonic
food web in *autumn* as in Donali et al. (1999).
</p>
<p>The Gulf of Riga is a highly eutrophic system in the Baltic Sea.
</p>
<p>The foodweb comprises 7 functional compartments and two external compartments,
connected with 26 flows.  Units of the flows are mg C/m3/day
</p>
<p>The linear inverse model LIMRigaAutumn is generated from the file
RigaAutumn.input which can be found in subdirectory <code>/examples/FoodWeb</code>
of the package directory
</p>
<p>In this subdirectory you will find many foodweb example input files
</p>
<p>These files can be read using <code><a href="#topic+Read">Read</a></code> and their output
processed by <code><a href="#topic+Setup">Setup</a></code> which will produce a linear inverse
problem specification similar to LIMRigaAutumn
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LIMRigaAutumn)
</code></pre>


<h3>Format</h3>

<p>a list of matrices, vectors, names and values that specify the
linear inverse model problem.
</p>
<p>see the return value of <code><a href="#topic+Setup">Setup</a></code> for more information
about this list
</p>
<p>A more complete description of this structures is in vignette(&quot;LIM&quot;)
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>
<p>Dick van Oevelen&lt;dick.vanoevelen@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Donali, E., Olli, K., Heiskanen, A.S., Andersen, T., 1999. Carbon flow
patterns in the planktonic food web of the Gulf of Riga, the Baltic Sea:
a reconstruction by the inverse method. Journal of Marine Systems 23,
251..268.
</p>


<h3>See Also</h3>

<p>browseURL(paste(system.file(package=&quot;LIM&quot;), &quot;/doc/examples/Foodweb/&quot;, sep=&quot;&quot;))
</p>
<p>contains &quot;RigaAutumn.input&quot;, the input file; read this with <code>Setup</code>
</p>
<p><code><a href="#topic+LIMTakapoto">LIMTakapoto</a></code>, <code><a href="#topic+LIMRigaSummer">LIMRigaSummer</a></code>,
<code><a href="#topic+LIMRigaSpring">LIMRigaSpring</a></code> and many others
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rigaAutumn &lt;- Flowmatrix(LIMRigaAutumn)
plotweb(rigaAutumn, main = "Gulf of Riga planktonic food web, autumn",
        sub = "mgC/m3/day")
# ranges of flows
Plotranges(LIMRigaAutumn, lab.cex = 0.7, xlab = "mgC/m3/d",
        main = "Gulf of Riga planktonic food web, autumn, Flowranges")
# ranges of variables
Plotranges(LIMRigaAutumn, type="V", lab.cex = 0.7, xlab = "mgC/m3/d",
        main = "Gulf of Riga planktonic food web, autumn, variables")
</code></pre>

<hr>
<h2 id='LIMRigaSpring'>
Linear inverse model specification for the Gulf of Riga *spring*
planktonic food web.
</h2><span id='topic+LIMRigaSpring'></span>

<h3>Description</h3>

<p>Linear inverse model specification for the Gulf of Riga planktonic
food web in *spring* as in Donali et al. (1999).
</p>
<p>The Gulf of Riga is a highly eutrophic system in the Baltic Sea.
</p>
<p>The foodweb comprises 7 functional compartments and two external
compartments, connected with 26 flows.
</p>
<p>Units of the flows are mg C/m3/day
</p>
<p>The linear inverse model LIMRigaSpring is generated from the file
RigaSpring.input which can be found in subdirectory <code>/examples/FoodWeb</code>
of the package directory
</p>
<p>In this subdirectory you will find many foodweb example input files
</p>
<p>These files can be read using <code><a href="#topic+Read">Read</a></code> and their output
processed by <code><a href="#topic+Setup">Setup</a></code> which will produce a linear inverse
problem specification similar to LIMRigaSpring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LIMRigaSpring)
</code></pre>


<h3>Format</h3>

<p>a list of matrices, vectors, names and values that specify the linear
inverse model problem.
</p>
<p>see the return value of <code><a href="#topic+Setup">Setup</a></code> for more information
about this list
</p>
<p>A more complete description of this structures is in vignette(&quot;LIM&quot;)
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>
<p>Dick van Oevelen&lt;dick.vanoevelen@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Donali, E., Olli, K., Heiskanen, A.S., Andersen, T., 1999. Carbon flow
patterns in the planktonic food web of the Gulf of Riga, the Baltic Sea:
a reconstruction by the inverse method. Journal of Marine Systems 23,
251..268.
</p>


<h3>See Also</h3>

<p>browseURL(paste(system.file(package=&quot;LIM&quot;), &quot;/doc/examples/Foodweb/&quot;, sep=&quot;&quot;))
</p>
<p>contains &quot;RigaSpring.input&quot;, the input file; read this with <code>Setup</code>
</p>
<p><code><a href="#topic+LIMTakapoto">LIMTakapoto</a></code>,<code><a href="#topic+LIMRigaAutumn">LIMRigaAutumn</a></code>,
<code><a href="#topic+LIMRigaAutumn">LIMRigaAutumn</a></code> and many others
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rigaSpring &lt;- Flowmatrix(LIMRigaSpring)
plotweb(rigaSpring, main = "Gulf of Riga planktonic food web, spring",
        sub = "mgC/m3/day")
Plotranges(LIMRigaSpring, lab.cex = 0.7,
        main = "Gulf of Riga planktonic food web, spring, Flowranges")
Plotranges(LIMRigaSpring, type = "V", lab.cex = 0.7,
        main = "Gulf of Riga planktonic food web, spring, Variable ranges")
</code></pre>

<hr>
<h2 id='LIMRigaSummer'>
Linear inverse model specification for the Gulf of Riga *summer*
planktonic food web.
</h2><span id='topic+LIMRigaSummer'></span>

<h3>Description</h3>

<p>Linear inverse model specification for the Gulf of Riga planktonic
food web in *summer* as in Donali et al. (1999).
</p>
<p>The Gulf of Riga is a highly eutrophic system in the Baltic Sea.
</p>
<p>The foodweb comprises 7 functional compartments and two external
compartments, connected with 26 flows.
</p>
<p>Units of the flows are mg C/m3/day
</p>
<p>The linear inverse model LIMRigaSummer is generated from the file
RigaSummer.input which can be found in subdirectory <code>/examples/FoodWeb</code>
of the package directory
</p>
<p>In this subdirectory you will find many foodweb example input files
</p>
<p>These files can be read using <code><a href="#topic+Read">Read</a></code> and their output
processed by <code><a href="#topic+Setup">Setup</a></code> which will produce a linear inverse
problem specification similar to LIMRigaSummer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LIMRigaSummer)
</code></pre>


<h3>Format</h3>

<p>a list of matrices, vectors, names and values that specify the
linear inverse model problem.
</p>
<p>see the return value of <code><a href="#topic+Setup">Setup</a></code> for more information
about this list.
</p>
<p>A more complete description of this structures is in vignette(&quot;LIM&quot;)
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>
<p>Dick van Oevelen &lt;dick.vanoevelen@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Donali, E., Olli, K., Heiskanen, A.S., Andersen, T., 1999. Carbon flow
patterns in the planktonic food web of the Gulf of Riga, the Baltic Sea:
a reconstruction by the inverse method. Journal of Marine Systems 23,
251..268.
</p>


<h3>See Also</h3>

<p>browseURL(paste(system.file(package=&quot;LIM&quot;), &quot;/doc/examples/Foodweb/&quot;, sep=&quot;&quot;))
</p>
<p>contains &quot;RigaSummer.input&quot;, the input file; read this with <code>Setup</code>
</p>
<p><code><a href="#topic+LIMTakapoto">LIMTakapoto</a></code>,<code><a href="#topic+LIMRigaAutumn">LIMRigaAutumn</a></code>,
<code><a href="#topic+LIMRigaSpring">LIMRigaSpring</a></code> and many others
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rigaSummer &lt;- Flowmatrix(LIMRigaSummer)
plotweb(rigaSummer, sub = "mgC/m3/day",
        main = "Gulf of Riga planktonic food web, summer")
Plotranges(LIMRigaSummer, type = "V", lab.cex = 0.7,
        main = "Gulf of Riga planktonic food web, summer, Variable ranges")</code></pre>

<hr>
<h2 id='LIMScheldtIntertidal'>
Linear inverse model specification for the Schelde Intertidal flat food web
</h2><span id='topic+LIMScheldtIntertidal'></span>

<h3>Description</h3>

<p>Linear inverse model specification for the Westerschelde Intertidal
flat food web in June
</p>
<p>as in Van Oevelen et al. (2006).
</p>
<p>The Westerschelde is a highly eutrophic estuary in the Netherlands.
</p>
<p>The food web model was created for the intertidal flat called the
&quot;Molenplaat&quot;, site 2.
</p>
<p>It is the basic input model.
</p>
<p>The foodweb comprises 7 functional compartments and five external
compartments, connected with 32 flows.
</p>
<p>Units of the flows are mg C/m2/day
</p>
<p>The linear inverse model LIMScheldtIntertidal is generated from the file
<code>ScheldtIntertidal.input </code>
which can be found in subdirectory <code>/examples/FoodWeb</code> of the
package directory
</p>
<p>In this subdirectory you will find many foodweb example input files
</p>
<p>These files can be read using <code><a href="#topic+Read">Read</a></code> and their output
processed by <code><a href="#topic+Setup">Setup</a></code> which will produce a linear inverse
problem specification similar to LIMScheldtIntertidal
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LIMScheldtIntertidal)
</code></pre>


<h3>Format</h3>

<p>a list of matrices, vectors, names and values that specify the linear
inverse model problem.
</p>
<p>see the return value of <code><a href="#topic+Setup">Setup</a></code> for more information about
this list
</p>
<p>A more complete description of this structures is in vignette(&quot;LIM&quot;)
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
Dick van Oevelen&lt;dick.vanoevelen@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Van Oevelen, D., Soetaert, K., Middelburg, J.J., Herman, P.M.J., Moodley,
L., Hamels, I., Moens, T., Heip, C.H.R., 2006b.
Carbon flows through a benthic food web: Integrating biomass, isotope
and tracer data. J. Mar. Res. 64, 1-30.
</p>


<h3>See Also</h3>

<p>browseURL(paste(system.file(package=&quot;LIM&quot;), &quot;/doc/examples/Foodweb/&quot;, sep=&quot;&quot;))
</p>
<p>contains &quot;ScheldtIntertidal.input&quot;, the input file; read this with <code>Setup</code>
</p>
<p><code><a href="#topic+LIMTakapoto">LIMTakapoto</a></code>, <code><a href="#topic+LIMRigaSummer">LIMRigaSummer</a></code> and many others
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ScheldtIntertidal &lt;- Flowmatrix(LIMScheldtIntertidal)
plotweb(ScheldtIntertidal, main = "Scheldt intertidal flat food web",
        sub = "mgC/m2/day")
Plotranges(LIMScheldtIntertidal, lab.cex = 0.7,
        main = "Scheldt intertidal flat food web, Flowranges")
Plotranges(LIMScheldtIntertidal, type = "V", lab.cex = 0.7,
        main = "Scheldt intertidal flat food web, Variable ranges")
</code></pre>

<hr>
<h2 id='LIMTakapoto'>
Linear inverse model specification for the Takapoto atoll planktonic
food web.
</h2><span id='topic+LIMTakapoto'></span>

<h3>Description</h3>

<p>Linear inverse model specification for the Carbon flux model of the
Takapoto atoll planktonic food web
</p>
<p>as reconstructed by inverse modelling by Niquil et al. (1998).
</p>
<p>The Takapoto Atoll lagoon is located in the French Polynesia of the
South Pacific
</p>
<p>The food web comprises 7 functional compartments and three external
compartments/sinks connected with 32 flows.
</p>
<p>Units of the flows are mg C/m2/day
</p>
<p>The linear inverse model LIMTakapoto is generated from the file
Takapoto.input which can be found in subdirectory <code>/examples/FoodWeb</code>
of the package directory
</p>
<p>In this subdirectory you will find many foodweb example input files
</p>
<p>These files can be read using <code><a href="#topic+Read">Read</a></code> and their output
processed by <code><a href="#topic+Setup">Setup</a></code> which will produce a linear inverse
problem specification similar to LIMTakapoto
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LIMTakapoto)
</code></pre>


<h3>Format</h3>

<p>a list of matrices, vectors, names and values that specify the linear
inverse model problem.
</p>
<p>see the return value of <code><a href="#topic+Setup">Setup</a></code> for more information about
this list
</p>
<p>A more complete description of this structures is in vignette(&quot;LIM&quot;)
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
Dick van Oevelen&lt;dick.vanoevelen@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Niquil, N., Jackson, G.A., Legendre, L., Delesalle, B., 1998. Inverse
model analysis of the planktonic food web of Takapoto Atoll
(French Polynesia). Marine Ecology Progress Series 165, 17..29.
</p>


<h3>See Also</h3>

<p>browseURL(paste(system.file(package=&quot;LIM&quot;), &quot;/doc/examples/Foodweb/&quot;, sep=&quot;&quot;))
</p>
<p>contains &quot;Takapoto.input&quot;, the input file; read this with <code>Setup</code>
</p>
<p><code><a href="#topic+LIMRigaAutumn">LIMRigaAutumn</a></code> and many others
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Takapoto &lt;- Flowmatrix(LIMTakapoto)
plotweb(Takapoto, main="Takapoto atoll planktonic food web",
        sub = "mgC/m2/day", lab.size = 1)
# some ranges extend to infinity - they are marked with "*"
Plotranges(LIMTakapoto, lab.cex = 0.7, 
        sub = "*=unbounded", xlab = "mgC/m2/d",
        main = "Takapoto atoll planktonic food web, Flowranges")
# ranges of variables, exclude first
Plotranges(LIMTakapoto, type = "V", lab.cex = 0.7, 
        index = 2:23, xlab = "mgC/m2/d",
        main = "Takapoto atoll planktonic food web, Variable ranges")
</code></pre>

<hr>
<h2 id='Linp'>
Solves a linear inverse model using linear programming.
</h2><span id='topic+Linp'></span><span id='topic+Linp.lim'></span><span id='topic+Linp.limfile'></span><span id='topic+Linp.character'></span><span id='topic+Linp.double'></span>

<h3>Description</h3>

<p>Solves a linear inverse model using linear programming
</p>
<p>Input presented either as:
</p>

<ul>
<li><p> matrices E, F, A, B, G, H (Linp.double) or
</p>
</li>
<li><p> as a list (Linp.lim) or
</p>
</li>
<li><p> as a lim input file (Linp.limfile)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Linp(...)
## S3 method for class 'lim'
Linp(lim, cost = NULL, ispos = lim$ispos, ...)
## S3 method for class 'limfile'
Linp(file, verbose = TRUE,...)
## S3 method for class 'character'
Linp(...)
## S3 method for class 'double'
Linp(...) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Linp_+3A_lim">lim</code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td></tr>
<tr><td><code id="Linp_+3A_file">file</code></td>
<td>
<p>name of the inverse input file.
</p>
</td></tr>
<tr><td><code id="Linp_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>: when reading the file,
prints warnings and messages to the screen.
</p>
</td></tr>
<tr><td><code id="Linp_+3A_cost">cost</code></td>
<td>
<p>if not <code>NULL</code>, a vector with the coefficients of the
cost function (to be minimised).
</p>
</td></tr>
<tr><td><code id="Linp_+3A_ispos">ispos</code></td>
<td>
<p>if <code>TRUE</code>: all x-values have to be positive.
</p>
</td></tr>
<tr><td><code id="Linp_+3A_...">...</code></td>
<td>
<p>other arguments passed to function <a href="limSolve.html#topic+linp">linp</a>
from package<code>limSolve</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Solves the following inverse problem:
</p>
<p style="text-align: center;"><code class="reqn">\min(\sum {Cost_i*x_i})</code>
</p>
<p> or
</p>
<p style="text-align: center;"><code class="reqn">\max(\sum {Profit_i*x_i})</code>
</p>
<p> subject to
</p>
<p style="text-align: center;"><code class="reqn">x_i&gt;=0</code>
</p>

<p style="text-align: center;"><code class="reqn">Ax=B</code>
</p>

<p style="text-align: center;"><code class="reqn">Gx&gt;=H</code>
</p>

<p>and where <code class="reqn">Cost_i</code> or <code class="reqn">Profit_i</code> are weighting coefficients
</p>


<h3>Value</h3>

<p>a list containing:
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>vector containing the solution of the linear programming problem.
</p>
</td></tr>
<tr><td><code>unconstrained.solution</code></td>
<td>
<p>vector containing the unconstrained
solution of the linear programming problem.
</p>
</td></tr>
<tr><td><code>residualNorm</code></td>
<td>
<p>scalar, the sum of residuals of equalities
and violated inequalities.
</p>
</td></tr>
<tr><td><code>solutionNorm</code></td>
<td>
<p>scalar, the value of the quadratic function
at the solution.
</p>
</td></tr>
<tr><td><code>IsError</code></td>
<td>
<p>logical, <code>TRUE</code> if an error occurred.
</p>
</td></tr>
<tr><td><code>Error</code></td>
<td>
<p>linp error text.
</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>linp.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Michel Berkelaar and others (2005). lpSolve: Interface to Lpsolve v. 5
to solve linear/integer programs. R package version 1.1.9.
</p>


<h3>See Also</h3>

<p><code>linp</code>, the more general function from package <code>lpSolve</code>
</p>
<p><code><a href="#topic+Ldei">Ldei</a></code>, to solve the linear inverse problem by least
distance programming
</p>
<p><code><a href="#topic+Lsei">Lsei</a></code>, to solve the linear inverse problem by lsei
(least squares with equality and inequality constraints)
</p>
<p>function <code><a href="limSolve.html#topic+linp">linp</a></code> from package<code>limSolve</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # the Blending example
  Linp(LIMBlending)

  # the E coli example: two functions to maximimise
  Linp(LIMEcoli)
 
  # E coli example, but only first function optimised..
  Linp(LIMEcoli, cost = -LIMEcoli$Profit[1,])

  # a foodweb example: need to specify the cost function
  # here just sum of absolute values of flows...
  Linp(LIMRigaAutumn, cost = (rep(1, LIMRigaAutumn$NUnknowns)))
</code></pre>

<hr>
<h2 id='Lsei'>
Solves a linear inverse model using the least squares method.
</h2><span id='topic+Lsei'></span><span id='topic+Lsei.lim'></span><span id='topic+Lsei.limfile'></span><span id='topic+Lsei.character'></span><span id='topic+Lsei.double'></span>

<h3>Description</h3>

<p>Solves a linear inverse model using the least squares method
</p>
<p>Input presented as:
</p>

<ul>
<li><p> matrices E, F, A, B, G, H (Lsei.double) or
</p>
</li>
<li><p> a list (Lsei.lim) or
</p>
</li>
<li><p> as a lim input file (Lsei.limfile)
</p>
</li></ul>

<p>Useful for solving overdetermined lims.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Lsei(...)
## S3 method for class 'double'
Lsei(...)
## S3 method for class 'lim'
Lsei(lim, exact = NULL, parsimonious = FALSE, ...)
## S3 method for class 'limfile'
Lsei(file, exact = NULL, parsimonious = FALSE, 
             verbose = TRUE, ...)
## S3 method for class 'character'
Lsei(...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Lsei_+3A_lim">lim</code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td></tr>
<tr><td><code id="Lsei_+3A_exact">exact</code></td>
<td>
<p>if not <code>NULL</code>, a vector containing the numbers of
the equations to be solved exactly; if <code>NULL</code>, all equations
are considered exact.
</p>
</td></tr>
<tr><td><code id="Lsei_+3A_parsimonious">parsimonious</code></td>
<td>
<p>if <code>TRUE</code>, also minimises the sum of squared
unknowns.
</p>
</td></tr>
<tr><td><code id="Lsei_+3A_file">file</code></td>
<td>
<p>name of the inverse input file.
</p>
</td></tr>
<tr><td><code id="Lsei_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>: when reading the file,
prints warnings and messages to the screen.
</p>
</td></tr>
<tr><td><code id="Lsei_+3A_...">...</code></td>
<td>
<p>other arguments passed to function
<code><a href="limSolve.html#topic+lsei">lsei</a></code> from package<code>limSolve</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Solves the following inverse problem:
</p>
<p style="text-align: center;"><code class="reqn">\min(||AAx-BB||^2)</code>
</p>
<p>, the approximate equations subject to
</p>
<p style="text-align: center;"><code class="reqn">Ex=F</code>
</p>
<p>, the mass balances
</p>
<p style="text-align: center;"><code class="reqn">Gx&gt;=H</code>
</p>
<p>, the constraints.
</p>
<p>and where <code>E</code> and <code>F</code> make up the equations from <code>A</code>
and <code>B</code>, as specified by vector <code>exact</code>.
</p>
<p><code>AA</code> and <code>BB</code> are the equations from <code>A</code> and <code>B</code>,
NOT in vector <code>exact</code>.
</p>
<p>in case <code>exact</code> = <code>NULL</code>, there are no approximate equations.
</p>
<p>in case <code>parsimonious</code> = <code>TRUE</code>, then the sum of squared
unknowns is also minimised. This means that <code>AA</code> is
augmented with the unity matrix (of size Nunknowns) and <code>BB</code>
contains Nunknowns additional zeros.
</p>
<p>For overdetermined lim problems, for instance, the inverse equations
may be split up in the mass balance equations which have to be exactly met
and the other equations which have to be approximated.
</p>
<p>This is, it is assumed that the first *NComponents* equations, the mass
balances, should be met exactly and the call to the function is:
<code>Lsei(lim,exact = 1:lim$NComponents,...)</code>
</p>
<p>If the lim is underdetermined, an alternative is to use
<code><a href="#topic+Ldei">Ldei</a></code> instead.
</p>
<p>This will return the parsimonious solution.
</p>
<p>The results should be similar with <code>Lsei(...,parsimonious=TRUE)</code>.
</p>
<p>In theory both <code>Lsei.lim</code> and <code>Ldei</code> should return the same
value for underdetermined systems.
</p>


<h3>Value</h3>

<p>a list containing:
</p>
<table role = "presentation">
<tr><td><code>X</code></td>
<td>
<p>vector containing the solution of the least squares problem.
</p>
</td></tr>
<tr><td><code>residualNorm</code></td>
<td>
<p>scalar, the sum of residuals of equalities and
violated inequalities.
</p>
</td></tr>
<tr><td><code>solutionNorm</code></td>
<td>
<p>scalar, the value of the minimised quadratic
function at the solution.
</p>
</td></tr>
<tr><td><code>IsError</code></td>
<td>
<p><code>TRUE</code> if an error occurred.
</p>
</td></tr>
<tr><td><code>Error</code></td>
<td>
<p>error text.
</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>lsei.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>K. H. Haskell and R. J. Hanson, An algorithm for linear least
squares problems with equality and nonnegativity constraints,
Report SAND77-0552, Sandia Laboratories, June 1978.
</p>
<p>K. H. Haskell and R. J. Hanson, Selected algorithms for the linearly
constrained least squares problem - a users guide,
Report SAND78-1290, Sandia Laboratories,August 1979.
</p>
<p>K. H. Haskell and R. J. Hanson, An algorithm for linear least squares
problems with equality and nonnegativity constraints, Mathematical
Programming 21 (1981), pp. 98-118.
</p>
<p>R. J. Hanson and K. H. Haskell, Two algorithms for the linearly
constrained least squares problem, ACM Transactions on Mathematical
Software, September 1982.
</p>


<h3>See Also</h3>

<p><code><a href="limSolve.html#topic+lsei">lsei</a></code>, the more general function from
package limSolve
</p>
<p><code><a href="#topic+Linp">Linp</a></code>, to solve the linear inverse problem by
linear programming
</p>
<p><code><a href="#topic+Ldei">Ldei</a></code>, to solve the linear inverse problem by
least distance programming
</p>
<p>function <code><a href="limSolve.html#topic+lsei">lsei</a></code> from package<code>limSolve</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Lsei(LIMRigaAutumn, parsimonious = TRUE)
</code></pre>

<hr>
<h2 id='Plotranges'>
Plots the minimum and maximum and central values
</h2><span id='topic+Plotranges'></span><span id='topic+Plotranges.double'></span><span id='topic+Plotranges.lim'></span><span id='topic+Plotranges.character'></span>

<h3>Description</h3>

<p>Plots minimum and maximum ranges.
</p>
<p>Takes as input either a lim list, as generated by Setup or a set
of vectors specifying the minimum, maximum and the central value,
or a data.frame that contains min, max and central values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plotranges(...)
## S3 method for class 'double'
Plotranges(min, max, value = NULL, labels = NULL, log = "",
  pch = 16, pch.col = "black", line.col = "gray", 
  seg.col = "black", xlim = NULL, main = NULL, 
  xlab = NULL, ylab = NULL, lab.cex = 1.0, mark = NULL,...)

## S3 method for class 'lim'
Plotranges(lim = NULL, labels = NULL, type = "X", log = "",
  pch = 16, pch.col = "black", line.col = "gray", 
  seg.col = "black", xlim = NULL, main = NULL, 
  xlab = NULL, ylab = NULL, lab.cex = 1.0, index = NULL, ...)

## S3 method for class 'character'
Plotranges(file, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plotranges_+3A_min">min</code></td>
<td>
<p>minimum value.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_max">max</code></td>
<td>
<p>maximum value.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_value">value</code></td>
<td>
<p>median or mean value.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_lim">lim</code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_file">file</code></td>
<td>
<p>name of the inverse input file.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_labels">labels</code></td>
<td>
<p>names of each value.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_type">type</code></td>
<td>
<p>one of &quot;X&quot; or &quot;V&quot; for plotting of unknowns (X) or variables.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_log">log</code></td>
<td>
<p>if = x: logarithmic scale for x-axis.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_pch">pch</code></td>
<td>
<p>pch symbol used for mean value.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_pch.col">pch.col</code></td>
<td>
<p>pch color for mean value.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_line.col">line.col</code></td>
<td>
<p>color for each variable, spanning x-axis.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_seg.col">seg.col</code></td>
<td>
<p>color for variable range.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_xlim">xlim</code></td>
<td>
<p>limits on x-axis.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_main">main</code></td>
<td>
<p>main title.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_lab.cex">lab.cex</code></td>
<td>
<p>label expansion value.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_index">index</code></td>
<td>
<p>list of elements to be plotted, a vector of integers;
default = all elements.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_mark">mark</code></td>
<td>
<p>list of elements to be marked with a &quot;*&quot;, i.e. when range
is unbounded.
</p>
</td></tr>
<tr><td><code id="Plotranges_+3A_...">...</code></td>
<td>
<p>arguments passed to R-function &quot;text&quot; when writing labels.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Only when a lim list was inputted. A data frame with
</p>
<table role = "presentation">
<tr><td><code>min</code></td>
<td>
<p>the minimum.
</p>
</td></tr>
<tr><td><code>max</code></td>
<td>
<p>the maximum.
</p>
</td></tr>
<tr><td><code>values</code></td>
<td>
<p>the central value.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The Takapoto food web.
# some ranges extend to infinity - they are marked with "*"
Plotranges(LIMTakapoto, lab.cex = 0.7, sub = "*=unbounded",
           xlab = "mgC/m2/d",  
           main = "Takapoto atoll planktonic food web, Flowranges")
# ranges of variables, exclude first variable
Plotranges(LIMTakapoto, type = "V", lab.cex = 0.7, 
           index = 2:23, xlab = "mgC/m2/d",
           main = "Takapoto atoll planktonic food web, Variable ranges")
</code></pre>

<hr>
<h2 id='PrintMat'>
Writes linear inverse matrices to the screen
</h2><span id='topic+PrintMat'></span>

<h3>Description</h3>

<p>Prints the linear inverse problem:
</p>

<ul>
<li><p> inverse matrices and vectors <code>A</code>, <code>b</code> of the
equalities </p>
<p style="text-align: center;"><code class="reqn">Ax=b</code>
</p>

</li>
<li><p> inverse matrices and vectors <code>G</code>, <code>h</code> of the
inequalities </p>
<p style="text-align: center;"><code class="reqn">Gx&gt;=h</code>
</p>

</li>
<li><p> if present, also writes the cost/profit function
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>PrintMat(lim)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PrintMat_+3A_lim">lim</code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns nothing.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>   PrintMat(LIMBlending)
</code></pre>

<hr>
<h2 id='Read'>Reads an inverse input file</h2><span id='topic+Read'></span>

<h3>Description</h3>

<p>Reads an inverse input file and creates the inverse problem as a list,
of type &quot;liminput&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Read(file, verbose = FALSE, checkLinear = TRUE, remtabs = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Read_+3A_file">file</code></td>
<td>
<p>name of inverse input file.
</p>
</td></tr>
<tr><td><code id="Read_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>: prints warnings and messages to the screen.
</p>
</td></tr>
<tr><td><code id="Read_+3A_checklinear">checkLinear</code></td>
<td>
<p>if <code>FALSE</code>: does not check for linearity
</p>
</td></tr>
<tr><td><code id="Read_+3A_remtabs">remtabs</code></td>
<td>
<p>remove tabs.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The structure of an inverse input file is explained in vignette(&quot;LIM&quot;)
which should be consulted.
</p>
<p>In short the inverse input file contains the declaration sections enclosed
inbetween two lines starting with a ##.
</p>
<p>For instance, the following section declares two components
</p>
<p># COMP
</p>
<p>State1
</p>
<p>State2
</p>
<p># END COMP
</p>
<p>Only the first 4 characters of the section names are read
</p>
<p>The following sections are allowed:
</p>

<ul>
<li><p> Parameters   - ## PARAMETERS
</p>
</li>
<li><p> Components   - ## STOCKS or ## DECISION VARIABLES
or ## STATES or ## UNKNOWNS
</p>
</li>
<li><p> Externals    - ## EXTERNALS
</p>
</li>
<li><p> Rates        - ## RATES
</p>
</li>
<li><p> Flows        - ## FLOWS
</p>
</li>
<li><p> Variables    - ## VARIABLES
</p>
</li>
<li><p> Cost         - ## COST or ## MINIMISE
</p>
</li>
<li><p> Profit       - ## PROFIT or ## MAXIMISE
</p>
</li>
<li><p> Equalities   - ## EQUALITIES
</p>
</li>
<li><p> InEqualities - ## INEQUALITIES or ## CONSTRAINTS
</p>
</li></ul>

<p>Any (part of a) line starting with a &quot;!&quot; is considered a comment.
</p>
<p>Input is NOT case sensitive
</p>
<p>The output of this function is used as input in function <code><a href="#topic+Setup">Setup</a></code>
which creates the inverse matrices
</p>
<p>By default, only linear problems can be solved, and the function checks
whether the input is linear.
To toggle off this check, set <code>checkLinear</code> to <code>FALSE</code>.
</p>
<p>Some input files contain tabs, which are converted to spaces, unless
this logical is set to <code>FALSE</code>.
</p>


<h3>Value</h3>

<p>a list containing :
</p>
<table role = "presentation">
<tr><td><code>file</code></td>
<td>
<p>name of the inverse input file.
</p>
</td></tr>
<tr><td><code>pars</code></td>
<td>
<p>a data.frame with parameter declarations.
</p>
</td></tr>
<tr><td><code>comp</code></td>
<td>
<p>a data.frame with compartments (or states, stocks).
</p>
</td></tr>
<tr><td><code>rate</code></td>
<td>
<p>a data.frame with rate declarations.
</p>
</td></tr>
<tr><td><code>extern</code></td>
<td>
<p>a data.frame with external declarations.
</p>
</td></tr>
<tr><td><code>flows</code></td>
<td>
<p>a data.frame with flow declarations.
</p>
</td></tr>
<tr><td><code>vars</code></td>
<td>
<p>a data.frame with variable declarations.
</p>
</td></tr>
<tr><td><code>cost</code></td>
<td>
<p>a data.frame with cost declarations.
</p>
</td></tr>
<tr><td><code>profit</code></td>
<td>
<p>a data.frame with profit declarations.
</p>
</td></tr>
<tr><td><code>equations</code></td>
<td>
<p>a data.frame with equality declarations.
</p>
</td></tr>
<tr><td><code>constraints</code></td>
<td>
<p>a data.frame with constraint declarations.
</p>
</td></tr>
<tr><td><code>reactions</code></td>
<td>
<p>a data.frame with reaction declarations.
</p>
</td></tr>
<tr><td><code>posreac</code></td>
<td>
<p>a vector with <code>TRUE</code> values if reaction or flow
is unidirectional (and the unknown x is thus positive), <code>FALSE</code>
if it is two-way reaction or flow, and x can be positive or negative.
</p>
</td></tr>
<tr><td><code>marker</code></td>
<td>
<p>a data.frame with marker declarations - see vignette(&quot;LIM&quot;).
</p>
</td></tr>
<tr><td><code>parnames</code></td>
<td>
<p>a vector with parameter names.
</p>
</td></tr>
<tr><td><code>varnames</code></td>
<td>
<p>a vector with variable names.
</p>
</td></tr>
<tr><td><code>compnames</code></td>
<td>
<p>a vector with compartment names.
</p>
</td></tr>
<tr><td><code>externnames</code></td>
<td>
<p>a vector with  names of externals.
</p>
</td></tr>
<tr><td><code>Type</code></td>
<td>
<p>a string; one of &quot;web&quot; (flows are unknowns),
&quot;reaction&quot; (reaction rates unknown) and &quot;simple&quot;
(compartments are unknowns).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Setup">Setup</a></code> the function to create inverse matrices, based
on output of <code>Read</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># this input has been created with function Read:
  LIMinputBlending

## Not run: 
  wd &lt;- getwd()
  setwd(paste(system.file(package = "LIM"), "/doc/examples/Foodweb", sep = ""))
  Read("RigaAutumn.input")
  setwd(wd)

## End(Not run)
</code></pre>

<hr>
<h2 id='Setup'>Creates linear inverse matrices</h2><span id='topic+Setup'></span><span id='topic+Setup.limfile'></span><span id='topic+Setup.liminput'></span><span id='topic+Setup.character'></span>

<h3>Description</h3>

<p>Creates the linear problem with equality and inequality equations.
</p>
<p>Takes as input either a liminput list, as generated by Read or a filename
with the linear inverse model specifications. Creates:
</p>

<ul>
<li><p> inverse matrices and vectors <code>A</code>, <code>b</code>, <code>G</code>, <code>h</code> of
the equalities/inequalities:
</p>
<p style="text-align: center;"><code class="reqn">Ax=b</code>
</p>

<p style="text-align: center;"><code class="reqn">Gx&gt;=h</code>
</p>

</li>
<li><p> if present, also generates the cost/profit function which is used as:
</p>
<p style="text-align: center;"><code class="reqn">\min(cost)</code>
</p>
<p>  or
</p>
<p style="text-align: center;"><code class="reqn">\max(profit)</code>
</p>

</li>
<li><p> if the input was a flow network, <code>Setup</code> will also create
the flow matrix (see details).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Setup(...)
## S3 method for class 'limfile'
Setup(file, verbose = TRUE, ...)
## S3 method for class 'character'
Setup(...)
## S3 method for class 'liminput'
Setup(liminput,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Setup_+3A_file">file</code></td>
<td>
<p>name of the inverse input file.
</p>
</td></tr>
<tr><td><code id="Setup_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code>: prints warnings and messages to the screen.
</p>
</td></tr>
<tr><td><code id="Setup_+3A_liminput">liminput</code></td>
<td>
<p>list of elements, as returned by <code>Read</code>.
</p>
</td></tr>
<tr><td><code id="Setup_+3A_...">...</code></td>
<td>
<p>extra parameters allowing this to be a generic function.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing:
</p>
<table role = "presentation">
<tr><td><code>file</code></td>
<td>
<p>name of the inverse input file.
</p>
</td></tr>
<tr><td><code>NUnknowns</code></td>
<td>
<p>number of unknowns.
</p>
</td></tr>
<tr><td><code>NEquations</code></td>
<td>
<p>number of equations.
</p>
</td></tr>
<tr><td><code>NConstraints</code></td>
<td>
<p>number of constraints.
</p>
</td></tr>
<tr><td><code>NComponents</code></td>
<td>
<p>number of components.
</p>
</td></tr>
<tr><td><code>NExternal</code></td>
<td>
<p>number of externals.
</p>
</td></tr>
<tr><td><code>NVariables</code></td>
<td>
<p>number of variables.
</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>matrix A of equalities Ax=B.
</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>vector B of equalities Ax=B.
</p>
</td></tr>
<tr><td><code>G</code></td>
<td>
<p>matrix G of inequalities Gx&gt;h.
</p>
</td></tr>
<tr><td><code>H</code></td>
<td>
<p>vector H of inequalities Gx=h.
</p>
</td></tr>
<tr><td><code>Cost</code></td>
<td>
<p>cost vector (to minimise), the weight of each unknown;
if not specified; 1 for all unknowns.
</p>
</td></tr>
<tr><td><code>Profit</code></td>
<td>
<p>profit vector (to maximise).
</p>
</td></tr>
<tr><td><code>Flowmatrix</code></td>
<td>
<p>matrix where element ij denotes flow from
compartment i to j.
</p>
</td></tr>
<tr><td><code>VarA</code></td>
<td>
<p>matrix VarA of variable equation VarA*x=VarB.
</p>
</td></tr>
<tr><td><code>VarB</code></td>
<td>
<p>vector VarB of variable equation VarA*x=VarB.
</p>
</td></tr>
<tr><td><code>Flows</code></td>
<td>
<p>a vector with flow names.
</p>
</td></tr>
<tr><td><code>Parameters</code></td>
<td>
<p>a data.frame with parameter names and values.
</p>
</td></tr>
<tr><td><code>Components</code></td>
<td>
<p>a data.frame with state names and values.
</p>
</td></tr>
<tr><td><code>Externals</code></td>
<td>
<p>a data.frame with external names and values.
</p>
</td></tr>
<tr><td><code>rates</code></td>
<td>
<p>a data.frame with rate names and values.
</p>
</td></tr>
<tr><td><code>markers</code></td>
<td>
<p>a data.frame with marker names and values.
</p>
</td></tr>
<tr><td><code>Variables</code></td>
<td>
<p>a vector with variable names.
</p>
</td></tr>
<tr><td><code>Unknowns</code></td>
<td>
<p>a vector with names of unknowns (either states or flows).
</p>
</td></tr>
<tr><td><code>Weight</code></td>
<td>
<p>a vector with the weights of unknowns- default is 1.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Read">Read</a></code> function that reads inverse input files and
produces the input list used by Setup
</p>
<p><code><a href="#topic+Lsei">Lsei</a></code>, <code><a href="#topic+Ldei">Ldei</a></code>, <code><a href="#topic+Linp">Linp</a></code> functions
to solve inverse problem, based on output generated by <code>setup.limfile</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   LIMinputBlending
   Setup(LIMinputBlending )
</code></pre>

<hr>
<h2 id='Variables'>
Generates the values of variables for a linear inverse (foodweb) problem
</h2><span id='topic+Variables'></span>

<h3>Description</h3>

<p>Given an linear inverse model input list, generates the values of the
inverse variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Variables (lim, res, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Variables_+3A_lim">lim</code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td></tr>
<tr><td><code id="Variables_+3A_res">res</code></td>
<td>
<p>the solved linear inverse problem; if not specified,
the model is solved first, using <code>Lsei.lim&lt;</code>.
</p>
</td></tr>
<tr><td><code id="Variables_+3A_...">...</code></td>
<td>
<p>extra parameters passed to function <code>Lsei.lim</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the variables, a one-column data.frame
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Varranges">Varranges</a></code> which estimates the ranges of variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> Variables(LIMRigaAutumn)
</code></pre>

<hr>
<h2 id='Varranges'>
Generates ranges of the variables for a linear inverse problem
</h2><span id='topic+Varranges'></span>

<h3>Description</h3>

<p>Given an inverse input list, generates the minimal and maximal values of
the variables (linear combinations of unknowns).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Varranges(lim, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Varranges_+3A_lim">lim</code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td></tr>
<tr><td><code id="Varranges_+3A_...">...</code></td>
<td>
<p>extra arguments passed to function <code>varranges</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a 2-columned vector containing the minimum (column 1) and
maximum (column 2) of each variable.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Xranges">Xranges</a></code> which estimates the ranges of unknowns
</p>
<p><code><a href="#topic+Plotranges">Plotranges</a></code> to plot the ranges
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Varranges(LIMRigaAutumn)
</code></pre>

<hr>
<h2 id='Xranges'>
Generates ranges of the unknowns of a linear inverse problem
</h2><span id='topic+Xranges'></span>

<h3>Description</h3>

<p>Given an inverse input list, generates the minimal and maximal
values of the unknowns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Xranges (lim, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Xranges_+3A_lim">lim</code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td></tr>
<tr><td><code id="Xranges_+3A_...">...</code></td>
<td>
<p>extra arguments passed to function
<code><a href="limSolve.html#topic+xranges">xranges</a></code> from package<code>limSolve</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a 2-columned vector containing the minimum (column 1) and
maximum (column 2) of each unknown.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Varranges">Varranges</a></code> which estimates the ranges of inverse variables
</p>
<p><code><a href="#topic+Plotranges">Plotranges</a></code> to plot the ranges
</p>
<p>function <code><a href="limSolve.html#topic+xranges">xranges</a></code> from package<code>limSolve</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ranges
xr   &lt;- Xranges(LIMRigaAutumn)
xlim &lt;- range(xr)

# parsimonious
pars &lt;- Lsei(LIMRigaAutumn)$X

# plot
dotchart(x = pars, labels = rownames(xr), xlim = xlim,  
         main = "Riga Autumn ",
         sub = "ranges and parsimonious solution", pch = 16)
cc &lt;- 1:nrow(xr)
segments(xr[ ,1], cc, xr[ ,2], cc)</code></pre>

<hr>
<h2 id='Xsample'>
Generates a random sample of the unknowns for a linear inverse problem
</h2><span id='topic+Xsample'></span>

<h3>Description</h3>

<p>Given an inverse input list, randomly samples the unknowns,
using an MCMC method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Xsample(lim, exact = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Xsample_+3A_lim">lim</code></td>
<td>
<p>a list that contains the linear inverse model
specification, as  generated by function <code>setup.limfile</code>.
</p>
</td></tr>
<tr><td><code id="Xsample_+3A_exact">exact</code></td>
<td>
<p>if not <code>NULL</code>, a vector containing the numbers of
the equations to be solved exactly; if <code>NULL</code>, all equations
are considered exact.
</p>
</td></tr>
<tr><td><code id="Xsample_+3A_...">...</code></td>
<td>
<p>extra parameters passed to function
<code><a href="limSolve.html#topic+xsample">xsample</a></code> from package<code>limSolve</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For overdetermined LIM problems, the inverse equations may be split up
in equations which have to be exactly met and other equations which have
to be approximated.
</p>
<p><code>exact</code> is a vector with the exact equations
</p>
<p>The default settings of <code>xsample</code> will often not do.
For instance, the default consists of 3000 iterations (<code>iter</code>) and
a jump length of <code>jmp</code> of 0.1.
You may need to increase one of those to ensure that the
entire solution space has been adequately sampled.
</p>


<h3>Value</h3>

<p>a 2-columned vector containing the minimum (column 1) and
maximum (column 2) of each unknown.
</p>


<h3>Author(s)</h3>

<p>Karline Soetaert &lt;karline.soetaert@nioz.nl&gt;
</p>


<h3>References</h3>

<p>Van den Meersche K, Soetaert K, Van Oevelen D (2009). xsample(): An R
Function for Sampling Linear Inverse Problems.
Journal of Statistical Software, Code Snippets, 30(1), 1-15.
</p>
<p>http://www.jstatsoft.org/v30/c01/
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Varranges">Varranges</a></code> which estimates the ranges of inverse variables
</p>
<p><code><a href="#topic+Plotranges">Plotranges</a></code> to plot the ranges
</p>
<p>function <code><a href="limSolve.html#topic+xsample">xsample</a></code> from package<code>limSolve</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># sample solution space
  xs &lt;- Xsample(LIMRigaAutumn, iter = 500, jmp = 5)
  # remove flows that are invariable (sd=0)
  xs &lt;- xs[ ,-which(apply(xs, 2, sd) == 0 )]
  #pairs plot
  pairs(xs, gap = 0, pch = ".", upper.panel = NULL)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
