<!DOCTYPE html><html lang="EN-GB"><head><title>Help for package tgver</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tgver}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#background_run'><p>Internal helper function to run a 'plumber' instance on specific</p>
host and port.</a></li>
<li><a href='#copy_tgve'><p>Internal helper function to:</p>
1. copy the bundled zip
2. unzip
3. cleanup as required.
TODO: return a value?</a></li>
<li><a href='#explore_dir'><p>A function to read and serve at least one file from a directory.</p></a></li>
<li><a href='#explore_file'><p>A function to explore a spatial csv or geojson file</p></a></li>
<li><a href='#explore_sf'><p>Explore an sf R object using TGVE npm package.</p></a></li>
<li><a href='#file_replace'><p>Function to replace patterns in given files.</p></a></li>
<li><a href='#get_url'><p>Helper function to generate URLs</p></a></li>
<li><a href='#help'><p>Function to explore available API variables, their types and examples of</p>
using them in the TGVE</a></li>
<li><a href='#is_valid_url'><p>Good enough regex to sanitize URLs</p></a></li>
<li><a href='#list_api_files'><p>Function to find what files may contain TGVE</p>
API variables for functions like 'file_replace'
to consume.</a></li>
<li><a href='#openURL'><p>Internal helper function to &quot;browse&quot; a URL.</p></a></li>
<li><a href='#setup'><p>Setup an instance.</p></a></li>
<li><a href='#tempInstance'><p>copy the inst/tgve to a temp in an R session</p></a></li>
<li><a href='#tgve'><p>Open static TGVE instance</p></a></li>
<li><a href='#tgve_server'><p>Start a TGVE instance server</p></a></li>
<li><a href='#version'><p>Version of the tgvejs npm package bundled in 'tgver'</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Turing Geovisualization Engine R package</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Layik Hama &lt;l.hama@leeds.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Turing Geovisualization Engine R package for geospatial visualization and analysis.</td>
</tr>
<tr>
<td>Language:</td>
<td>EN-GB</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/tgve/tgver">https://github.com/tgve/tgver</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tgve/tgver/issues">https://github.com/tgve/tgver/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>plumber, callr, geojsonsf</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>igraph, covr, curl, devtools, knitr, rmarkdown, testthat (&ge;
3.0.0), edgebundle, ggplot2, maps, sf, ggraph</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-30 14:49:07 UTC; layik</td>
</tr>
<tr>
<td>Author:</td>
<td>Layik Hama <a href="https://orcid.org/0000-0003-1912-4890"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Lydia France [aut],
  Nick Barlow [aut],
  Roly Perera [aut],
  Roger Beecham <a href="https://orcid.org/0000-0001-8563-7251"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Nik Lomax <a href="https://orcid.org/0000-0001-9504-7570"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-30 15:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='background_run'>Internal helper function to run a 'plumber' instance on specific
host and port.</h2><span id='topic+background_run'></span>

<h3>Description</h3>

<p>Internal helper function to run a 'plumber' instance on specific
host and port.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>background_run(server, port = 8000, host = "127.0.0.1")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="background_run_+3A_server">server</code></td>
<td>
<p>an instance of 'plumber' class</p>
</td></tr>
<tr><td><code id="background_run_+3A_port">port</code></td>
<td>
<p>numeric port to pass to 'server' instance</p>
</td></tr>
<tr><td><code id="background_run_+3A_host">host</code></td>
<td>
<p>character host value for 'server' instance</p>
</td></tr>
</table>

<hr>
<h2 id='copy_tgve'>Internal helper function to:
1. copy the bundled zip
2. unzip
3. cleanup as required.
TODO: return a value?</h2><span id='topic+copy_tgve'></span>

<h3>Description</h3>

<p>Internal helper function to:
1. copy the bundled zip
2. unzip
3. cleanup as required.
TODO: return a value?
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copy_tgve(path, over.write = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="copy_tgve_+3A_path">path</code></td>
<td>
<p>character path of TGVE instance</p>
</td></tr>
<tr><td><code id="copy_tgve_+3A_over.write">over.write</code></td>
<td>
<p>boolean whether to cleanup the instance in 'path'</p>
</td></tr>
</table>

<hr>
<h2 id='explore_dir'>A function to read and serve at least one file from a directory.</h2><span id='topic+explore_dir'></span>

<h3>Description</h3>

<p>Current version only tries to:
Find two files, one .csv and the other .geojson and
pass them to TGVE as 'defaultURL' and 'geographyURL' respectively.
It will also look at their column names and try to find matching columns.
If there is one file, it passes it to 'explore_file' function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>explore_dir(path, background = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="explore_dir_+3A_path">path</code></td>
<td>
<p>character of a data directory.</p>
</td></tr>
<tr><td><code id="explore_dir_+3A_background">background</code></td>
<td>
<p>logical value whether to run instance in 'callr'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no value returned, depending on 'background' either a or not
blocking 'plumber::pr' instance is started. A message is displayed with
instance details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
p = file.path(tempdir(), "data")
dir.create(p)
gURL = paste0("https://raw.githubusercontent.com/saferactive/",
"tgve/main/pf-only-name.geojson")
dURL = "https://raw.githubusercontent.com/saferactive/tgve/main/ksi-pf.csv"
download.file(gURL, destfile = file.path(p, "pf.geojson"))
download.file(dURL, destfile = file.path(p, "data.csv"))

ps = explore_dir(p, background = TRUE)
ps$kill()
unlink(p, recursive = TRUE)
}
</code></pre>

<hr>
<h2 id='explore_file'>A function to explore a spatial csv or geojson file</h2><span id='topic+explore_file'></span>

<h3>Description</h3>

<p>Current version can only read geojson/csv files using the given 'file.uri'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>explore_file(file.uri, background = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="explore_file_+3A_file.uri">file.uri</code></td>
<td>
<p>character path of file to explore</p>
</td></tr>
<tr><td><code id="explore_file_+3A_background">background</code></td>
<td>
<p>Boolean to run the process in the background,
defaults to 'FALSE'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no value returned, depending on 'background' either a or not
blocking 'plumber' instance is started. A message is displayed with
instance details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
fp = file.path(tempdir(), "test.geojson")
gj = c(
'[
      {"type":"Point","coordinates":[0,0]},
      {"type":"LineString","coordinates":[[-1,-1],[1,1]]},
        {
      "type": "FeatureCollection",
      "features": [
      {
        "type": "Feature",
        "properties": {"id":1},
        "geometry": {"type": "Point", "coordinates": [100.0, 0.0]}
      }
    ]
  }
    ]'
)
write(gj, fp)
ps = tgver::explore_file(fp, background = TRUE)
ps$kill()
unlink(fp, recursive = TRUE)
}
</code></pre>

<hr>
<h2 id='explore_sf'>Explore an sf R object using TGVE npm package.</h2><span id='topic+explore_sf'></span>

<h3>Description</h3>

<p>Explore an sf R object using TGVE npm package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>explore_sf(
  sf = NULL,
  background = FALSE,
  static = FALSE,
  path = tempInstance()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="explore_sf_+3A_sf">sf</code></td>
<td>
<p>a valid sf object that can be converted to geojson</p>
</td></tr>
<tr><td><code id="explore_sf_+3A_background">background</code></td>
<td>
<p>Boolean to decide whether plumber</p>
</td></tr>
<tr><td><code id="explore_sf_+3A_static">static</code></td>
<td>
<p>boolean to decide whether data is written to disk and self
contained application is built</p>
</td></tr>
<tr><td><code id="explore_sf_+3A_path">path</code></td>
<td>
<p>path of a TGVE instance, defaults to one in 'tempdir()'
should run in the background</p>
</td></tr>
</table>


<h3>Value</h3>

<p>depending on 'background' either a or not
blocking 'plumber::pr' object is started or returned. In the case of a
'backgruond' FALSE value a message is displayed with object details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
gj = c(
'[
      {"type":"Point","coordinates":[0,0]},
      {"type":"LineString","coordinates":[[-1,-1],[1,1]]},
        {
      "type": "FeatureCollection",
      "features": [
      {
        "type": "Feature",
        "properties": {"id":1},
        "geometry": {"type": "Point", "coordinates": [100.0, 0.0]}
      }
    ]
  }
    ]'
)
sf = geojsonsf::geojson_sf(gj)
ps = tgver::explore_sf(sf, background = TRUE)
ps$kill()
}
</code></pre>

<hr>
<h2 id='file_replace'>Function to replace patterns in given files.</h2><span id='topic+file_replace'></span>

<h3>Description</h3>

<p>Function to replace patterns in given files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>file_replace(files = NULL, pattern, replacement)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="file_replace_+3A_files">files</code></td>
<td>
<p>character vector of full paths where pattern to be replaced.</p>
</td></tr>
<tr><td><code id="file_replace_+3A_pattern">pattern</code></td>
<td>
<p>character pattern to replace using 'gsub'.</p>
</td></tr>
<tr><td><code id="file_replace_+3A_replacement">replacement</code></td>
<td>
<p>character to replace pattern with using 'gsub'.</p>
</td></tr>
</table>

<hr>
<h2 id='get_url'>Helper function to generate URLs</h2><span id='topic+get_url'></span>

<h3>Description</h3>

<p>The function can generate a URL based on a base URL and as many as TGVE API
variables provided to the function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_url(base = "http://127.0.0.1:8000", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_url_+3A_base">base</code></td>
<td>
<p>character URL defaults to 'http://127.0.0.1:8000'</p>
</td></tr>
<tr><td><code id="get_url_+3A_...">...</code></td>
<td>
<p>any or all of the TGVE API variables to replace/add values to.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character URL generated from 'base' and 'tgver::'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
url = get_url(dark="false")
url == "http://127.0.0.1:8000?dark=false"
url
url = get_url()
url
}

</code></pre>

<hr>
<h2 id='help'>Function to explore available API variables, their types and examples of
using them in the TGVE</h2><span id='topic+help'></span>

<h3>Description</h3>

<p>Function to explore available API variables, their types and examples of
using them in the TGVE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>help()
</code></pre>


<h3>Value</h3>

<p>no object is returned
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
help()
}
</code></pre>

<hr>
<h2 id='is_valid_url'>Good enough regex to sanitize URLs</h2><span id='topic+is_valid_url'></span>

<h3>Description</h3>

<p>The task of checking a URL is &quot;hard&quot;, see this by J. Hester:
https://cran.r-project.org/web/packages/rex/vignettes/url_parsing.html
To avoid having a dependency for now, let us not use &quot;rex&quot;  R package.
To try and understand the regex please see this gist which includes
a breakdown of the regex:
https://gist.github.com/dperini/729294
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_valid_url(string)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_valid_url_+3A_string">string</code></td>
<td>
<p>must be valid vector of URLs</p>
</td></tr>
</table>

<hr>
<h2 id='list_api_files'>Function to find what files may contain TGVE
API variables for functions like 'file_replace'
to consume.</h2><span id='topic+list_api_files'></span>

<h3>Description</h3>

<p>Function to find what files may contain TGVE
API variables for functions like 'file_replace'
to consume.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_api_files(path = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list_api_files_+3A_path">path</code></td>
<td>
<p>where TGVE instance is located.</p>
</td></tr>
</table>

<hr>
<h2 id='openURL'>Internal helper function to &quot;browse&quot; a URL.</h2><span id='topic+openURL'></span>

<h3>Description</h3>

<p>Internal helper function to &quot;browse&quot; a URL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>openURL(
  url = NULL,
  host = "127.0.0.1",
  port = 8000,
  browser = FALSE,
  path = "",
  protocol = "http://"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="openURL_+3A_url">url</code></td>
<td>
<p>character url, if given and valid other
parameters will be ignored.</p>
</td></tr>
<tr><td><code id="openURL_+3A_host">host</code></td>
<td>
<p>character host to pass to plumber</p>
</td></tr>
<tr><td><code id="openURL_+3A_port">port</code></td>
<td>
<p>integer port to pass to plumber</p>
</td></tr>
<tr><td><code id="openURL_+3A_browser">browser</code></td>
<td>
<p>Boolean whether to specifically launch a browser</p>
</td></tr>
<tr><td><code id="openURL_+3A_path">path</code></td>
<td>
<p>character path to TGVE instance</p>
</td></tr>
<tr><td><code id="openURL_+3A_protocol">protocol</code></td>
<td>
<p>character protocol, this may change</p>
</td></tr>
</table>

<hr>
<h2 id='setup'>Setup an instance.</h2><span id='topic+setup'></span>

<h3>Description</h3>

<p>This function initializes an instance of TGVE for permanent use compared with
what <a href="#topic+tgve_server">tgve_server</a> which relies on a 'tempdir' based instance.
It requires a path.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup(path = NULL, create = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setup_+3A_path">path</code></td>
<td>
<p>Character URI to copy tgve instance in.</p>
</td></tr>
<tr><td><code id="setup_+3A_create">create</code></td>
<td>
<p>Boolean to create new directory at path, defaults to 'TRUE'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no value returned
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
p = file.path(tempdir(), "tgve")
setup(p)
}
</code></pre>

<hr>
<h2 id='tempInstance'>copy the inst/tgve to a temp in an R session</h2><span id='topic+tempInstance'></span>

<h3>Description</h3>

<p>copy the inst/tgve to a temp in an R session
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tempInstance()
</code></pre>

<hr>
<h2 id='tgve'>Open static TGVE instance</h2><span id='topic+tgve'></span>

<h3>Description</h3>

<p>This is the main and most basic function to run an instance of TGVE without
back-end. Compared to <a href="#topic+tgve_server">tgve_server</a>, this function only uses
internal functions to setup an instance then opens the entry HTML file.
If a path of an instance is provided it opens it, otherwise creates an
instance from a 'tempdir'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tgve(
  path = Sys.getenv("TEMP_path_ENV"),
  browse = TRUE,
  remote = FALSE,
  url = "https://tgve.github.io/app/"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tgve_+3A_path">path</code></td>
<td>
<p>character directory of a current instance to browse. Defaults to
'TEMP_PATH_ENV' environment variable.</p>
</td></tr>
<tr><td><code id="tgve_+3A_browse">browse</code></td>
<td>
<p>boolean to decide whether to browse the instance or not.</p>
</td></tr>
<tr><td><code id="tgve_+3A_remote">remote</code></td>
<td>
<p>boolean whether to run a remote instance of TGVE. If TRUE
the above 'path' and 'browse' parameters will be ignored. Defaults to 'FALSE'</p>
</td></tr>
<tr><td><code id="tgve_+3A_url">url</code></td>
<td>
<p>if 'remote' is true, then this will be used as the parameter
to pass to internal function 'openURL'. It defaults, for convenience,
to 'https://tgve.github.io/app/' instance.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>directory of the new instance if 'path' is not provided.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tgve()
# just get the path of the HTML
p = tgve(browse = FALSE)
file.exists(p)


</code></pre>

<hr>
<h2 id='tgve_server'>Start a TGVE instance server</h2><span id='topic+tgve_server'></span>

<h3>Description</h3>

<p>The function accepts a 'path' to get a directory containing an instance of
TGVE, by default this is done via 'TEMP_DIR_ENV' env variable. If neither
is given then the function copies a clean copy of the bundled
TGVE version into a temporary directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tgve_server(
  path = Sys.getenv("TEMP_path_ENV"),
  port = 8000,
  host = "127.0.0.1",
  background = FALSE,
  run = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tgve_server_+3A_path">path</code></td>
<td>
<p>location of TGVE path to be served by plumber.</p>
</td></tr>
<tr><td><code id="tgve_server_+3A_port">port</code></td>
<td>
<p>to serve from.</p>
</td></tr>
<tr><td><code id="tgve_server_+3A_host">host</code></td>
<td>
<p>host to pass to plumber default 'http://127.0.0.1'
to 'FALSE'.</p>
</td></tr>
<tr><td><code id="tgve_server_+3A_background">background</code></td>
<td>
<p>run the R process in the background using 'callr',
defaults to 'TRUE'.</p>
</td></tr>
<tr><td><code id="tgve_server_+3A_run">run</code></td>
<td>
<p>whether to start the server, defaults to 'TRUE'. If
not, then the created server will be returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the valude returned depends on: (1) 'run', if it is FALSE then
an instance of 'plumber::pr', (2) if 'run' is true and 'background' is TRUE
the 'plumber::pr' instance is started and its process is returned, and
(3) if 'run' is TRUE and 'background' is FALSE then a message is displayed
showing the blocking &lsquo;plumber::pr' instance&rsquo;s 'path', 'port' and 'host'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
# This will run in the background using `callr`
ps = tgve_server(background = TRUE)
Sys.sleep(2)
ps$kill()
}
</code></pre>

<hr>
<h2 id='version'>Version of the tgvejs npm package bundled in 'tgver'</h2><span id='topic+version'></span><span id='topic+tgvejsVersion'></span>

<h3>Description</h3>

<p>Version of the tgvejs npm package bundled in 'tgver'
</p>
<p>Package version included as data
</p>


<h3>Format</h3>

<p>A character vector
</p>


<h3>Note</h3>

<p>This was generated using the script in the
'data' directory ('tgver.R' file).
</p>


<h3>Author(s)</h3>

<p>L Hama <a href="mailto:l.hama@leeds.ac.uk">l.hama@leeds.ac.uk</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
tgver::version
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
