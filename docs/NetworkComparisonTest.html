<!DOCTYPE html><html><head><title>Help for package NetworkComparisonTest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NetworkComparisonTest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#NetworkComparisonTest-package'>
<p>Statistical Comparison of Two Networks Based on Several Invariance Measures</p></a></li>
<li><a href='#NCT'><p>NetworkComparisonTest: Statistical Comparison of Two Networks Based on Several Invariance Measures</p></a></li>
<li><a href='#plot.NCT'><p>Print method for NCT</p></a></li>
<li><a href='#summary.NCT'><p>Summary method for NCT</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Comparison of Two Networks Based on Several
Invariance Measures</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Don van den Bergh &lt;d.vandenbergh@uva.nl&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, utils, Matrix, methods, reshape2, qgraph,
networktools, IsingFit</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bootnet, IsingSampler, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>This permutation based hypothesis test, suited for several types of data 
    supported by the estimateNetwork function of the bootnet package (Epskamp &amp; Fried, 2018), 
    assesses the difference between two networks based on several invariance measures (network 
    structure invariance, global strength invariance, edge invariance, several centrality 
    measures, etc.). Network structures are estimated with l1-regularization. The Network 
    Comparison Test is suited for comparison of independent (e.g., two different groups) and 
    dependent samples (e.g., one group that is measured twice). See van Borkulo et al. (2021),
    available from &lt;<a href="https://doi.org/10.1037%2Fmet0000476">doi:10.1037/met0000476</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-01 13:32:16 UTC; don</td>
</tr>
<tr>
<td>Author:</td>
<td>Claudia van Borkulo [aut],
  Sacha Epskamp [aut],
  Payton Jones [aut],
  Jonas Haslbeck [ctb],
  Alex Millner [ctb],
  Karoline Huth [ctb],
  Don van den Bergh [cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-01 16:00:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='NetworkComparisonTest-package'>
Statistical Comparison of Two Networks Based on Several Invariance Measures
</h2><span id='topic+NetworkComparisonTest-package'></span>

<h3>Description</h3>

<p>This permutation based hypothesis test, suited for several types of data supported by the estimateNetwork function of the bootnet package (Epskamp &amp; Fried, 2018), assesses the difference between two networks based on several invariance measures (network structure invariance, global strength invariance, edge invariance, several centrality measures, etc.). Network structures are estimated with l1-regularization. The Network Comparison Test is suited for comparison of independent (e.g., two different groups) and dependent samples (e.g., one group that is measured twice).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> NetworkComparisonTest</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.2.2</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Claudia D. van Borkulo, with contributions from Jonas Haslbeck, Sacha Epskamp, Payton Jones and Alex Millner
</p>
<p>Maintainer: Claudia D. van Borkulo &lt;cvborkulo@gmail.com&gt;
</p>


<h3>References</h3>

<p>Epskamp, S., &amp; Fried, E. I. (2018). A tutorial on regularized partial correlation networks. Psychological Methods, 23(4), 617-634.
</p>
<p>Ernst, M.D. Permutation methods: A basis for exact inference. Stat Sci. 2004;19(4):676-685.
</p>
<p>Good, P.I. Permutation, parametric and bootstrap tests of hypotheses. Vol. 3. New York:: Springer, 2005.
</p>
<p>van Borkulo, C. D., Boschloo, L., Borsboom, D., Penninx, B. W. J. H., Waldorp, L. J., &amp; Schoevers, R.A. (2015). Association of symptom network structure with the course of depression. JAMA Psychiatry. 2015;72(12). doi:10.1001/jamapsychiatry.2015.2079
</p>
<p>van Borkulo, C. D., van Bork, R.,  Boschloo, Kossakowski, J., Tio, P., L., Schoevers, R.A., Borsboom, D., &amp; , Waldorp, L. J. (2021). Comparing network structures on three aspects: A permutation test. Psychological Methods, in press.  
</p>

<hr>
<h2 id='NCT'>NetworkComparisonTest: Statistical Comparison of Two Networks Based on Several Invariance Measures</h2><span id='topic+NCT'></span><span id='topic+NetworkComparisonTest'></span>

<h3>Description</h3>

<p>This permutation based hypothesis test, suited for several types of data supported by the estimateNetwork function of the bootnet package (Epskamp &amp; Fried, 2018), assesses the difference between two networks based on several invariance measures (network structure invariance, global strength invariance, edge invariance, several centrality measures, etc.). Network structures are estimated with l1-regularization. The Network Comparison Test is suited for comparison of independent (e.g., two different groups) and dependent samples (e.g., one group that is measured twice).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NCT(
  data1,
  data2,
  gamma,
  it = 100,
  binary.data = FALSE,
  paired = FALSE,
  weighted = TRUE,
  AND = TRUE,
  abs = TRUE,
  test.edges = FALSE,
  edges = "all",
  progressbar = TRUE,
  make.positive.definite = TRUE,
  p.adjust.methods = c("none", "holm", "hochberg", "hommel", "bonferroni", "BH", "BY",
    "fdr"),
  test.centrality = FALSE,
  centrality = c("strength", "expectedInfluence"),
  nodes = "all",
  communities = NULL,
  useCommunities = "all",
  estimator,
  estimatorArgs = list(),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NCT_+3A_data1">data1</code></td>
<td>
<p>One of two datasets. The dimension of the matrix is nobs x nvars; each row is a vector of observations of the variables. Must be cross-sectional data. Can also be the result of <code>estimateNetwork</code> from the bootnet package.</p>
</td></tr>
<tr><td><code id="NCT_+3A_data2">data2</code></td>
<td>
<p>The other of two datasets. The dimension of the matrix is nobs x nvars; each row is a vector of observations of the variables. Must be cross-sectional data.  Can also be the result of <code>estimateNetwork</code> from the bootnet package.</p>
</td></tr>
<tr><td><code id="NCT_+3A_gamma">gamma</code></td>
<td>
<p>A single value between 0 and 1. When not entered, gamma is set to 0.25 for binary data and 0.50 for gaussian data. Networks are estimated with this value for hyperparameter gamma in the extended BIC.</p>
</td></tr>
<tr><td><code id="NCT_+3A_it">it</code></td>
<td>
<p>The number of iterations (permutations).</p>
</td></tr>
<tr><td><code id="NCT_+3A_binary.data">binary.data</code></td>
<td>
<p>Logical. Can be TRUE or FALSE to indicate whether the data is binary or not. If binary.data is FALSE, the data is regarded gaussian. This argument is ignored when using estimateNetwork() output as input for NCT.</p>
</td></tr>
<tr><td><code id="NCT_+3A_paired">paired</code></td>
<td>
<p>Logical. Can be TRUE of FALSE to indicate whether the samples are dependent or not. If paired is TRUE, relabeling is performed within each pair of observations. If paired is FALSE, relabeling is not restricted to pairs of observations. Note that, currently, dependent data is assumed to entail one group measured twice.</p>
</td></tr>
<tr><td><code id="NCT_+3A_weighted">weighted</code></td>
<td>
<p>Logical. Can be TRUE of FALSE to indicate whether the networks to be compared should be weighted of not. If not, the estimated networks are dichotomized. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="NCT_+3A_and">AND</code></td>
<td>
<p>Logical. Can be TRUE of FALSE to indicate whether the AND-rule or the OR-rule should be used to define the edges in the network. Defaults to TRUE. Only necessary for binary data.</p>
</td></tr>
<tr><td><code id="NCT_+3A_abs">abs</code></td>
<td>
<p>Logical. Should global strength consider the absolute value of edge weights, or the raw value (i.e., global expected influence)?</p>
</td></tr>
<tr><td><code id="NCT_+3A_test.edges">test.edges</code></td>
<td>
<p>Logical. Can be TRUE of FALSE to indicate whether or not differences in individual edges should be tested.</p>
</td></tr>
<tr><td><code id="NCT_+3A_edges">edges</code></td>
<td>
<p>Character or list. When 'all', differences between all individual edges are tested. When provided a list with one or more pairs of indices referring to variables, the provided edges are tested.</p>
</td></tr>
<tr><td><code id="NCT_+3A_progressbar">progressbar</code></td>
<td>
<p>Logical. Should the pbar be plotted in order to see the progress of the estimation procedure? Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="NCT_+3A_make.positive.definite">make.positive.definite</code></td>
<td>
<p>If <code>make.positive.definite = TRUE</code>, the covariance matrices used for the glasso are projected to the nearest positive definite matrices, if they are not yet positive definite. This is useful for small n, for which it is very likely that at least one of the bootstrap comparisons involves a covariance matrix that is not positive definite.</p>
</td></tr>
<tr><td><code id="NCT_+3A_p.adjust.methods">p.adjust.methods</code></td>
<td>
<p>Character. Can be one of &quot;holm&quot;, &quot;hochberg&quot;, &quot;hommel&quot;, &quot;bonferroni&quot;, &quot;BH&quot;, &quot;BY&quot;, &quot;fdr&quot;, or &quot;none&quot;. To control (or not) for testing of multiple edges. Defaults to &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="NCT_+3A_test.centrality">test.centrality</code></td>
<td>
<p>Logical. Should centrality metrics be compared across networks?</p>
</td></tr>
<tr><td><code id="NCT_+3A_centrality">centrality</code></td>
<td>
<p>Type of centrality metrics to test. Can be any of c(&quot;all&quot;, &quot;closeness&quot;, &quot;betweenness&quot;, &quot;strength&quot;, &quot;expectedInfluence&quot;, &quot;bridgeStrength&quot;, &quot;bridgeCloseness&quot;, &quot;bridgeBetweenness&quot;, &quot;bridgeExpectedInfluence&quot;)</p>
</td></tr>
<tr><td><code id="NCT_+3A_nodes">nodes</code></td>
<td>
<p>Specific nodes for centrality tests. Can be character names or index numbers. Only used if test.centrality=TRUE</p>
</td></tr>
<tr><td><code id="NCT_+3A_communities">communities</code></td>
<td>
<p>Passed to bridge() if computing bridge centrality</p>
</td></tr>
<tr><td><code id="NCT_+3A_usecommunities">useCommunities</code></td>
<td>
<p>Passed to bridge() if computing bridge centrality</p>
</td></tr>
<tr><td><code id="NCT_+3A_estimator">estimator</code></td>
<td>
<p>A function that takes data as input and returns a network structure. This can be used for custom estimation algorithms. Note, supplying this function will overwrite the arguments <code>binary.data</code>, <code>AND</code>, <code>gamma</code> and <code>make.positive.definite</code>.</p>
</td></tr>
<tr><td><code id="NCT_+3A_estimatorargs">estimatorArgs</code></td>
<td>
<p>Arguments to the <code>estimator</code> function.</p>
</td></tr>
<tr><td><code id="NCT_+3A_verbose">verbose</code></td>
<td>
<p>Logical: Should some warnings and notes be printed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NCT returns a 'NCT' object that contains the following items:
</p>

<ul>
<li> <p><code>glstrinv.real </code> The difference in global strength between the networks of the observed data sets.
</p>
</li>
<li> <p><code>glstrinv.perm </code> The difference in global strength between the networks of the permutated data sets.
</p>
</li>
<li> <p><code>glstrinv.sep</code> The global strength values of the individual networks
</p>
</li>
<li> <p><code>glstrinv.pval</code> The p value resulting from the permutation test concerning difference in global strength.
</p>
</li>
<li> <p><code>nwinv.real</code> The value of the maximum difference in edge weights of the observed networks.
</p>
</li>
<li> <p><code>nwinv.perm</code> The values of the maximum difference in edge weights of the permuted networks.
</p>
</li>
<li> <p><code>nwinv.pval</code> The p value resulting from the permutation test concerning the maximum difference in edge weights.
</p>
</li>
<li> <p><code>einv.pvals</code> p-values (corrected for multiple testing or not according to 'p.adjust.methods') per edge from the permutation test concerning differences in edges weights. Only returned if test.edges = TRUE.
</p>
</li>
<li> <p><code>einv.real</code> The value of the difference in edge weight of the observed networks (multiple values if more edges are called to test). Only if test.edges = TRUE.
</p>
</li>
<li> <p><code>einv.perm</code> The values of the difference in edge weight of the permuted networks. Only if test.edges = TRUE.
</p>
</li>
<li> <p><code>diffcen.real</code> The values of the difference in centralities of the observed networks. Only if test.centrality = TRUE.
</p>
</li>
<li> <p><code>diffcen.perm</code> The values of the difference in centralities of the permuted networks. Only if test.centrality = TRUE.
</p>
</li>
<li> <p><code>diffcen.pval</code> p-values(corrected for multiple testing or not according to 'p.adjust.methods') per node from the permutation test concerning differences in centralities. Only if test.centrality = TRUE.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(IsingSampler)
library(IsingFit)
library(bootnet)

### Simulate binary datasets under null hypothesis:
### underlying network structures are similar
# Input:
N &lt;- 6 # Number of nodes
nSample &lt;- 500 # Number of samples

# Ising parameters:
set.seed(123)
Graph &lt;- matrix(sample(0:1,N^2,TRUE,prob = c(0.8, 0.2)),N,N) * runif(N^2,0.5,2)
Graph &lt;- pmax(Graph,t(Graph))
Graph[4,1] &lt;- Graph[4,1]*-1
Graph[1,4] &lt;- Graph[1,4]*-1
Graph[5,1] &lt;- Graph[5,1]*-1
Graph[1,5] &lt;- Graph[1,5]*-1
Graph[6,1] &lt;- Graph[6,1]*-1
Graph[1,6] &lt;- Graph[1,6]*-1
diag(Graph) &lt;- 0
Thresh &lt;- -rowSums(Graph) / 2

# Simulate:
data1 &lt;- IsingSampler(nSample, Graph, Thresh)
data2 &lt;- IsingSampler(nSample, Graph, Thresh)
colnames(data1) &lt;- colnames(data2) &lt;- c('V1', 'V2', 'V3', 'V4', 'V5', 'V6')

### Compare networks of data sets using NCT ###
## Networks can be compared by either (1) feeding the data directly into NCT (whereby 
## you need to specify arguments such as "gamma" and "binary.data") or (2) by using 
## estimateNetwork() (bootnet package) and feeding that output into NCT. For the latter 
## option, we refer to the help file of  estimateNetwork() for its usage. Below, both 
## options are illustrated. We recommend using estimateNetwork(), since this function 
## has implemented many network estimation methods.

## gamma = 0 (in estimateNetwork this hyperparameter is called "tuning"; to illustrate 
# how to specify a different value than the default)
## iterations (it) set to 10 to save time
## Note: Low number of iterations can give unreliable results; should be 1000 at least

## Testing whether there are differences in the three aspects that are validated 
# (network invariance, global strength, edge weight)
## 2 edges are tested here: between variable 1 and 2, and between 3 and 6 (can be 
# "list(c(2,1),c(6,3))" as well)

## (1) Feeding data directly into NCT
set.seed(123)
NCT_a &lt;- NCT(data1, data2, gamma=0, it=10, binary.data = TRUE, 
             test.edges=TRUE, edges=list(c(1,2),c(3,6)))
summary(NCT_a)
## Plot results of global strength invariance test (not reliable with only 10 
# permutations!)
plot(NCT_a, what="strength")

## (2) Feeding the estimateNetwork() output into NCT
est_1 &lt;- estimateNetwork(data1, default = "IsingFit", tuning = 0)
est_2 &lt;- estimateNetwork(data2, default = "IsingFit", tuning = 0)
## When using estimateNetwork() output, there is no need to specify gamma and binary.data 
## This yields similar output as NCT_a
set.seed(123)
NCT_b &lt;- NCT(est_1, est_2, it=10, test.edges=TRUE, 
             edges=list(c(1,2),c(3,6)))
summary(NCT_b)

## Next, an example of testing whether there are differences in node strength 
# when data is paired (e.g., a group which is measured pre- and post-treatement). 
# Also, here you can see how to specify that you want to take the sign of node strength 
# into account (by default, the absolute value is taken and, therefore, the sign is 
# ignored).
# we don't run these two examples by default as they take too long for the R CMD check
# but they are still interesting.

## Not run: 

## abs = FALSE
set.seed(123)
NCT_c = NCT(est_1, est_2, paired = TRUE, abs = FALSE, test.edges = TRUE, 
            edges = list(c(1,2),c(3,6)), test.centrality = TRUE, 
            centrality = c("strength"), nodes = "all", it=10)
summary(NCT_c)

## Finally, an example how to test for differences in centrality (e.g., expectedInfluence)

set.seed(123)
NCT_d = NCT(est_1, est_2, paired = TRUE, abs = FALSE, test.edges = TRUE, 
            edges = list(c(1,2),c(3,6)), test.centrality = TRUE, 
            centrality = c("expectedInfluence"), nodes = "all", it=10)
summary(NCT_d)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.NCT'>Print method for NCT</h2><span id='topic+plot.NCT'></span><span id='topic+print.NCT'></span>

<h3>Description</h3>

<p>Print method, prints the NCT output, plot method plots the output, summary method returns a summary of the output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NCT'
print(x, ...)

## S3 method for class 'NCT'
plot(x, what = c("strength", "network", "edge", "centrality"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.NCT_+3A_x">x</code></td>
<td>
<p>output of NCT</p>
</td></tr>
<tr><td><code id="plot.NCT_+3A_...">...</code></td>
<td>
<p>for now ignored</p>
</td></tr>
<tr><td><code id="plot.NCT_+3A_what">what</code></td>
<td>
<p>defines what has to be plotted: results pertaining to test on invariance of global strength (&quot;strength&quot;), network structure (&quot;network&quot;), edge strength (&quot;edge&quot;), or specific centrality measure (&quot;centrality&quot;)</p>
</td></tr>
</table>

<hr>
<h2 id='summary.NCT'>Summary method for NCT</h2><span id='topic+summary.NCT'></span>

<h3>Description</h3>

<p>Summary method for NCT
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NCT'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.NCT_+3A_object">object</code></td>
<td>
<p>output of NCT</p>
</td></tr>
<tr><td><code id="summary.NCT_+3A_...">...</code></td>
<td>
<p>for now ignored</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
