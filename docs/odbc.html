<!DOCTYPE html><html><head><title>Help for package odbc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {odbc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#odbc-package'><p>odbc: Connect to ODBC Compatible Databases (using the DBI Interface)</p></a></li>
<li><a href='#databricks'><p>Helper for Connecting to Databricks via ODBC</p></a></li>
<li><a href='#DBI-classes'><p>DBI classes</p></a></li>
<li><a href='#DBI-tables'><p>Convenience functions for reading/writing DBMS tables</p></a></li>
<li><a href='#dbListTables,OdbcConnection-method'><p>List remote tables and fields for an ODBC connection</p></a></li>
<li><a href='#isTempTable'><p>Helper method used to determine if a table identifier is that</p>
of a temporary table.</a></li>
<li><a href='#Microsoft SQL Server-class'><p>SQL Server</p></a></li>
<li><a href='#odbc'><p>Connect to a database via an ODBC driver</p></a></li>
<li><a href='#OdbcConnection-class'><p>Odbc Connection Methods</p></a></li>
<li><a href='#odbcConnectionActions'><p>List the actions supported for the connection</p></a></li>
<li><a href='#odbcConnectionColumns'><p>odbcConnectionColumns</p></a></li>
<li><a href='#odbcConnectionIcon'><p>Get an icon representing a connection.</p></a></li>
<li><a href='#odbcDataType'><p>Return the corresponding ODBC data type for an R object</p></a></li>
<li><a href='#OdbcDriver'><p>Odbc Driver Methods</p></a></li>
<li><a href='#odbcListColumns'><p>List columns in an object.</p></a></li>
<li><a href='#odbcListConfig'><p>List locations of ODBC configuration files</p></a></li>
<li><a href='#odbcListDataSources'><p>List Configured Data Source Names</p></a></li>
<li><a href='#odbcListDrivers'><p>List Configured ODBC Drivers</p></a></li>
<li><a href='#odbcListObjects'><p>List objects in a connection.</p></a></li>
<li><a href='#odbcListObjectTypes'><p>Return the object hierarchy supported by a connection.</p></a></li>
<li><a href='#odbcPreviewObject'><p>Preview the data in an object.</p></a></li>
<li><a href='#odbcPreviewQuery'><p>Create a preview query.</p></a></li>
<li><a href='#OdbcResult'><p>Odbc Result Methods</p></a></li>
<li><a href='#odbcSetTransactionIsolationLevel'><p>Set the Transaction Isolation Level for a Connection</p></a></li>
<li><a href='#Oracle-class'><p>Oracle</p></a></li>
<li><a href='#quote_value'><p>Quote special character when connecting</p></a></li>
<li><a href='#sqlData,OdbcConnection-method'><p>Unimportant DBI methods</p></a></li>
<li><a href='#SUPPORTED_CONNECTION_ATTRIBUTES'><p>Supported Connection Attributes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Connect to ODBC Compatible Databases (using the DBI Interface)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.2</td>
</tr>
<tr>
<td>Description:</td>
<td>A DBI-compatible interface to ODBC databases.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://odbc.r-dbi.org">https://odbc.r-dbi.org</a>, <a href="https://github.com/r-dbi/odbc">https://github.com/r-dbi/odbc</a>,
<a href="https://solutions.posit.co/connections/db/">https://solutions.posit.co/connections/db/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/r-dbi/odbc/issues">https://github.com/r-dbi/odbc/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>bit64, blob (&ge; 1.2.0), DBI (&ge; 1.0.0), hms, lifecycle,
methods, Rcpp (&ge; 0.12.11), rlang (&ge; 0.2.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, DBItest, knitr, magrittr, rmarkdown, RSQLite, testthat
(&ge; 3.0.0), tibble, withr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Config/Needs/check:</td>
<td>pkgbuild</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make, An ODBC3 driver manager and drivers.</td>
</tr>
<tr>
<td>Collate:</td>
<td>'RcppExports.R' 'connection-pane.R' 'dbi-connection.R'
'odbc-connection.R' 'db.R' 'dbi-driver.R' 'dbi-result.R'
'dbi-table.R' 'dbi.R' 'driver-access.R' 'driver-bigquery.R'
'driver-databricks.R' 'driver-db2.R' 'driver-hana.R'
'driver-hive.R' 'driver-impala.R' 'driver-mysql.R'
'driver-oracle.R' 'driver-postgres.R' 'driver-redshift.R'
'driver-snowflake.R' 'driver-spark.R' 'driver-sql-server.R'
'driver-sqlite.R' 'driver-teradata.R' 'driver-vertica.R'
'odbc-config.R' 'odbc-data-sources.R' 'odbc-data-type.R'
'odbc-drivers.R' 'odbc-package.R' 'odbc.R' 'utils.R' 'zzz.R'</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-22 22:06:13 UTC; hadleywickham</td>
</tr>
<tr>
<td>Author:</td>
<td>Jim Hester [aut],
  Hadley Wickham [aut, cre],
  Oliver Gjoneski [aut],
  lexicalunit [cph] (nanodbc library),
  Google Inc. [cph] (cctz library),
  Posit Software, PBC [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hadley Wickham &lt;hadley@posit.co&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-22 23:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='odbc-package'>odbc: Connect to ODBC Compatible Databases (using the DBI Interface)</h2><span id='topic+odbc-package'></span>

<h3>Description</h3>

<p>A DBI-compatible interface to ODBC databases.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Hadley Wickham <a href="mailto:hadley@posit.co">hadley@posit.co</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Jim Hester
</p>
</li>
<li><p> Oliver Gjoneski
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> lexicalunit (nanodbc library) [copyright holder]
</p>
</li>
<li><p> Google Inc. (cctz library) [copyright holder]
</p>
</li>
<li><p> Posit Software, PBC [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://odbc.r-dbi.org">https://odbc.r-dbi.org</a>
</p>
</li>
<li> <p><a href="https://github.com/r-dbi/odbc">https://github.com/r-dbi/odbc</a>
</p>
</li>
<li> <p><a href="https://solutions.posit.co/connections/db/">https://solutions.posit.co/connections/db/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/r-dbi/odbc/issues">https://github.com/r-dbi/odbc/issues</a>
</p>
</li></ul>


<hr>
<h2 id='databricks'>Helper for Connecting to Databricks via ODBC</h2><span id='topic+databricks'></span><span id='topic+DatabricksOdbcDriver-class'></span><span id='topic+dbConnect+2CDatabricksOdbcDriver-method'></span>

<h3>Description</h3>

<p>Connect to Databricks clusters and SQL warehouses via the <a href="https://www.databricks.com/spark/odbc-drivers-download">Databricks ODBC driver</a>.
</p>
<p>In particular, the custom <code>dbConnect()</code> method for the Databricks ODBC driver
implements a subset of the <a href="https://docs.databricks.com/en/dev-tools/auth.html#databricks-client-unified-authentication">Databricks client unified authentication</a>
model, with support for personal access tokens, OAuth machine-to-machine
credentials, and OAuth user-to-machine credentials supplied via Posit
Workbench or the Databricks CLI on desktop.
All of these credentials are detected automatically if present using
<a href="https://docs.databricks.com/en/dev-tools/auth.html#environment-variables-and-fields-for-client-unified-authentication">standard environment variables</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>databricks()

## S4 method for signature 'DatabricksOdbcDriver'
dbConnect(
  drv,
  httpPath,
  workspace = Sys.getenv("DATABRICKS_HOST"),
  useNativeQuery = TRUE,
  driver = NULL,
  HTTPPath,
  uid = NULL,
  pwd = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="databricks_+3A_drv">drv</code></td>
<td>
<p>an object that inherits from <a href="DBI.html#topic+DBIDriver-class">DBIDriver</a>,
or an existing <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a>
object (in order to clone an existing connection).</p>
</td></tr>
<tr><td><code id="databricks_+3A_httppath">httpPath</code>, <code id="databricks_+3A_httppath">HTTPPath</code></td>
<td>
<p>To query a cluster, use the HTTP Path value found
under <code style="white-space: pre;">&#8288;Advanced Options &gt; JDBC/ODBC&#8288;</code> in the Databricks UI. For SQL
warehouses, this is found under <code style="white-space: pre;">&#8288;Connection Details&#8288;</code> instead.</p>
</td></tr>
<tr><td><code id="databricks_+3A_workspace">workspace</code></td>
<td>
<p>The URL of a Databricks workspace, e.g.
<code>"https://example.cloud.databricks.com"</code>.</p>
</td></tr>
<tr><td><code id="databricks_+3A_usenativequery">useNativeQuery</code></td>
<td>
<p>Suppress the driver's conversion from ANSI SQL 92 to
HiveSQL? The default (<code>TRUE</code>), gives greater performance but means that
paramterised queries (and hence <code>dbWriteTable()</code>) do not work.</p>
</td></tr>
<tr><td><code id="databricks_+3A_driver">driver</code></td>
<td>
<p>The name of the Databricks ODBC driver, or <code>NULL</code> to use the
default name.</p>
</td></tr>
<tr><td><code id="databricks_+3A_uid">uid</code>, <code id="databricks_+3A_pwd">pwd</code></td>
<td>
<p>Manually specify a username and password for authentication.
Specifying these options will disable automated credential discovery.</p>
</td></tr>
<tr><td><code id="databricks_+3A_...">...</code></td>
<td>
<p>Further arguments passed on to <code><a href="#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>OdbcConnection</code> object with an active connection to a Databricks
cluster or SQL warehouse.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
DBI::dbConnect(
  odbc::databricks(),
  httpPath = "sql/protocolv1/o/4425955464597947/1026-023828-vn51jugj"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='DBI-classes'>DBI classes</h2><span id='topic+DBI-classes'></span><span id='topic+DB2+2FAIX64-class'></span><span id='topic+HDB-class'></span><span id='topic+Hive-class'></span><span id='topic+Spark+20SQL-class'></span><span id='topic+Teradata-class'></span>

<h3>Description</h3>

<p>DBI classes
</p>

<hr>
<h2 id='DBI-tables'>Convenience functions for reading/writing DBMS tables</h2><span id='topic+DBI-tables'></span><span id='topic+dbWriteTable+2COdbcConnection+2Ccharacter+2Cdata.frame-method'></span><span id='topic+dbWriteTable+2COdbcConnection+2CId+2Cdata.frame-method'></span><span id='topic+dbWriteTable+2COdbcConnection+2CSQL+2Cdata.frame-method'></span><span id='topic+dbAppendTable+2COdbcConnection-method'></span><span id='topic+sqlCreateTable+2COdbcConnection-method'></span>

<h3>Description</h3>

<p>Convenience functions for reading/writing DBMS tables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'OdbcConnection,character,data.frame'
dbWriteTable(
  conn,
  name,
  value,
  overwrite = FALSE,
  append = FALSE,
  temporary = FALSE,
  row.names = NULL,
  field.types = NULL,
  batch_rows = getOption("odbc.batch_rows", NA),
  ...
)

## S4 method for signature 'OdbcConnection,Id,data.frame'
dbWriteTable(
  conn,
  name,
  value,
  overwrite = FALSE,
  append = FALSE,
  temporary = FALSE,
  row.names = NULL,
  field.types = NULL,
  batch_rows = getOption("odbc.batch_rows", NA),
  ...
)

## S4 method for signature 'OdbcConnection,SQL,data.frame'
dbWriteTable(
  conn,
  name,
  value,
  overwrite = FALSE,
  append = FALSE,
  temporary = FALSE,
  row.names = NULL,
  field.types = NULL,
  batch_rows = getOption("odbc.batch_rows", NA),
  ...
)

## S4 method for signature 'OdbcConnection'
dbAppendTable(
  conn,
  name,
  value,
  batch_rows = getOption("odbc.batch_rows", NA),
  ...,
  row.names = NULL
)

## S4 method for signature 'OdbcConnection'
sqlCreateTable(
  con,
  table,
  fields,
  row.names = NA,
  temporary = FALSE,
  ...,
  field.types = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DBI-tables_+3A_conn">conn</code></td>
<td>
<p>a <code><a href="#topic+OdbcConnection-class">OdbcConnection</a></code> object, produced by
<code><a href="DBI.html#topic+dbConnect">DBI::dbConnect()</a></code></p>
</td></tr>
<tr><td><code id="DBI-tables_+3A_name">name</code></td>
<td>
<p>a character string specifying a table name. Names will be
automatically quoted so you can use any sequence of characters, not
just any valid bare table name.</p>
</td></tr>
<tr><td><code id="DBI-tables_+3A_value">value</code></td>
<td>
<p>A data.frame to write to the database.</p>
</td></tr>
<tr><td><code id="DBI-tables_+3A_overwrite">overwrite</code></td>
<td>
<p>Allow overwriting the destination table. Cannot be
<code>TRUE</code> if <code>append</code> is also <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="DBI-tables_+3A_append">append</code></td>
<td>
<p>Allow appending to the destination table. Cannot be
<code>TRUE</code> if <code>overwrite</code> is also <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="DBI-tables_+3A_temporary">temporary</code></td>
<td>
<p>If <code>TRUE</code>, will generate a temporary table.</p>
</td></tr>
<tr><td><code id="DBI-tables_+3A_row.names">row.names</code></td>
<td>
<p>Either <code>TRUE</code>, <code>FALSE</code>, <code>NA</code> or a string.
</p>
<p>If <code>TRUE</code>, always translate row names to a column called &quot;row_names&quot;.
If <code>FALSE</code>, never translate row names. If <code>NA</code>, translate
rownames only if they're a character vector.
</p>
<p>A string is equivalent to <code>TRUE</code>, but allows you to override the
default name.
</p>
<p>For backward compatibility, <code>NULL</code> is equivalent to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="DBI-tables_+3A_field.types">field.types</code></td>
<td>
<p>Additional field types used to override derived types.</p>
</td></tr>
<tr><td><code id="DBI-tables_+3A_batch_rows">batch_rows</code></td>
<td>
<p>The number of rows to retrieve. Defaults to <code>NA</code>, which
is set dynamically to the size of the input. Depending on the database,
driver, dataset and free memory setting this to a lower value may improve
performance.</p>
</td></tr>
<tr><td><code id="DBI-tables_+3A_...">...</code></td>
<td>
<p>Other arguments used by individual methods.</p>
</td></tr>
<tr><td><code id="DBI-tables_+3A_con">con</code></td>
<td>
<p>A database connection.</p>
</td></tr>
<tr><td><code id="DBI-tables_+3A_table">table</code></td>
<td>
<p>The table name, passed on to <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier()</a></code>. Options are:
</p>

<ul>
<li><p> a character string with the unquoted DBMS table name,
e.g. <code>"table_name"</code>,
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+Id">Id()</a></code> with components to the fully qualified table name,
e.g. <code>Id(schema = "my_schema", table = "table_name")</code>
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+SQL">SQL()</a></code> with the quoted and fully qualified table name
given verbatim, e.g. <code>SQL('"my_schema"."table_name"')</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="DBI-tables_+3A_fields">fields</code></td>
<td>
<p>Either a character vector or a data frame.
</p>
<p>A named character vector: Names are column names, values are types.
Names are escaped with <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier()</a></code>.
Field types are unescaped.
</p>
<p>A data frame: field types are generated using
<code><a href="DBI.html#topic+dbDataType">dbDataType()</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(DBI)
con &lt;- dbConnect(odbc::odbc())
dbListTables(con)
dbWriteTable(con, "mtcars", mtcars, temporary = TRUE)
dbReadTable(con, "mtcars")

dbListTables(con)
dbExistsTable(con, "mtcars")

# A zero row data frame just creates a table definition.
dbWriteTable(con, "mtcars2", mtcars[0, ], temporary = TRUE)
dbReadTable(con, "mtcars2")

dbDisconnect(con)

## End(Not run)
</code></pre>

<hr>
<h2 id='dbListTables+2COdbcConnection-method'>List remote tables and fields for an ODBC connection</h2><span id='topic+dbListTables+2COdbcConnection-method'></span><span id='topic+dbListFields+2COdbcConnection+2Ccharacter-method'></span>

<h3>Description</h3>

<p><code>dbListTables()</code> provides names of remote tables accessible through this
connection; <code>dbListFields()</code> provides names of columns within a table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'OdbcConnection'
dbListTables(
  conn,
  catalog_name = NULL,
  schema_name = NULL,
  table_name = NULL,
  table_type = NULL,
  ...
)

## S4 method for signature 'OdbcConnection,character'
dbListFields(
  conn,
  name,
  catalog_name = NULL,
  schema_name = NULL,
  column_name = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dbListTables+2B2COdbcConnection-method_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="dbListTables+2B2COdbcConnection-method_+3A_catalog_name">catalog_name</code>, <code id="dbListTables+2B2COdbcConnection-method_+3A_schema_name">schema_name</code>, <code id="dbListTables+2B2COdbcConnection-method_+3A_table_name">table_name</code></td>
<td>
<p>Catalog, schema, and table names.
</p>
<p>By default, <code>catalog_name</code>, <code>schema_name</code> and <code>table_name</code> will
automatically escape underscores to ensure that you match exactly one
table. If you want to search for multiple tables using wild cards, you
will need to use <code>odbcConnectionTables()</code> directly instead.</p>
</td></tr>
<tr><td><code id="dbListTables+2B2COdbcConnection-method_+3A_table_type">table_type</code></td>
<td>
<p>The type of the table to return, the default returns
all table types.</p>
</td></tr>
<tr><td><code id="dbListTables+2B2COdbcConnection-method_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
<tr><td><code id="dbListTables+2B2COdbcConnection-method_+3A_name">name</code></td>
<td>
<p>The table name, passed on to <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier()</a></code>. Options are:
</p>

<ul>
<li><p> a character string with the unquoted DBMS table name,
e.g. <code>"table_name"</code>,
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+Id">Id()</a></code> with components to the fully qualified table name,
e.g. <code>Id(schema = "my_schema", table = "table_name")</code>
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+SQL">SQL()</a></code> with the quoted and fully qualified table name
given verbatim, e.g. <code>SQL('"my_schema"."table_name"')</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="dbListTables+2B2COdbcConnection-method_+3A_column_name">column_name</code></td>
<td>
<p>The name of the column to return, the default returns all columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of table or field names respectively.
</p>

<hr>
<h2 id='isTempTable'>Helper method used to determine if a table identifier is that
of a temporary table.</h2><span id='topic+isTempTable'></span><span id='topic+isTempTable+2COdbcConnection+2CId-method'></span><span id='topic+isTempTable+2COdbcConnection+2CSQL-method'></span>

<h3>Description</h3>

<p>Currently implemented only for select back-ends where
we have a use for it (SQL Server, for example).  Generic, in case
we develop a broader use case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isTempTable(conn, name, ...)

## S4 method for signature 'OdbcConnection,Id'
isTempTable(conn, name, ...)

## S4 method for signature 'OdbcConnection,SQL'
isTempTable(conn, name, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isTempTable_+3A_conn">conn</code></td>
<td>
<p>OdbcConnection</p>
</td></tr>
<tr><td><code id="isTempTable_+3A_name">name</code></td>
<td>
<p>Table name</p>
</td></tr>
<tr><td><code id="isTempTable_+3A_...">...</code></td>
<td>
<p>additional parameters to methods</p>
</td></tr>
</table>

<hr>
<h2 id='Microsoft+20SQL+20Server-class'>SQL Server</h2><span id='topic+Microsoft+20SQL+20Server-class'></span><span id='topic+dbUnquoteIdentifier+2CMicrosoft+20SQL+20Server+2CSQL-method'></span><span id='topic+isTempTable+2CMicrosoft+20SQL+20Server+2Ccharacter-method'></span><span id='topic+isTempTable+2CMicrosoft+20SQL+20Server+2CSQL-method'></span><span id='topic+dbExistsTable+2CMicrosoft+20SQL+20Server+2Ccharacter-method'></span><span id='topic+dbListTables+2CMicrosoft+20SQL+20Server-method'></span><span id='topic+dbExistsTable+2CMicrosoft+20SQL+20Server+2CId-method'></span><span id='topic+dbExistsTable+2CMicrosoft+20SQL+20Server+2CSQL-method'></span><span id='topic+odbcConnectionSchemas+2CMicrosoft+20SQL+20Server-method'></span><span id='topic+sqlCreateTable+2CMicrosoft+20SQL+20Server-method'></span>

<h3>Description</h3>

<p>Details of SQL Server methods for odbc and DBI generics.
</p>


<h4><code>dbUnquoteIdentifier()</code></h4>

<p><code>conn@quote</code> returns the quotation mark, but quotation marks and square
brackets can be used interchangeably for delimited identifiers.
(<a href="https://learn.microsoft.com/en-us/sql/relational-databases/databases/database-identifiers">https://learn.microsoft.com/en-us/sql/relational-databases/databases/database-identifiers</a>).
This function strips the brackets first and then calls the DBI method to
strip the quotation marks.
</p>



<h4><code>isTempTable()</code></h4>

<p>Local temp tables are stored as
<code style="white-space: pre;">&#8288;[tempdb].[dbo].[#name]_____[numeric identifier]&#8288;</code>, so <code>isTempTable()</code>
returns <code>TRUE</code> if <code>catalog_name</code> is <code>"tempdb"</code> or <code>"%"</code>, or the
name starts with <code>"#"</code>.
</p>



<h4><code>dbExistsTable()</code></h4>

<p>The default implementation reports temporary tables as non-existent
since they live in a different catalog. This method provides a special
case for temporary tables, as identified by <code>isTempTable()</code>.
</p>



<h4><code>dbListTables()</code></h4>

<p>The default implementation reports temporary tables as non-existent
when a <code>catalog_name</code> isn't supplied since they live in a different catalog.
This method provides a special case for temporary tables.
</p>



<h4><code>odbcConnectionSchemas</code></h4>

<p>Method for an internal function. Calls catalog-specific <code>sp_tables</code> to make
sure we list the schemas in the appropriate database/catalog.
</p>



<h4><code>sqlCreateTable()</code></h4>

<p>Warns if <code>temporary = TRUE</code> but the <code>name</code> does not conform to temp table
naming conventions (i.e. it doesn't start with <code style="white-space: pre;">&#8288;#&#8288;</code>).
</p>


<hr>
<h2 id='odbc'>Connect to a database via an ODBC driver</h2><span id='topic+odbc'></span><span id='topic+dbConnect+2COdbcDriver-method'></span><span id='topic+dbConnect'></span>

<h3>Description</h3>

<p>The <code>dbConnect()</code> method documented here is invoked when <code><a href="DBI.html#topic+dbConnect">DBI::dbConnect()</a></code>
is called with the first argument <code>odbc()</code>. Connecting to a database via
an ODBC driver is likely the first step in analyzing data using the odbc
package; for an overview of package concepts, see the <em>Overview</em> section
below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbc()

## S4 method for signature 'OdbcDriver'
dbConnect(
  drv,
  dsn = NULL,
  ...,
  timezone = "UTC",
  timezone_out = "UTC",
  encoding = "",
  bigint = c("integer64", "integer", "numeric", "character"),
  timeout = 10,
  driver = NULL,
  server = NULL,
  database = NULL,
  uid = NULL,
  pwd = NULL,
  dbms.name = NULL,
  attributes = NULL,
  .connection_string = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbc_+3A_drv">drv</code></td>
<td>
<p>An <code>OdbcDriver</code>, from <code>odbc()</code>.</p>
</td></tr>
<tr><td><code id="odbc_+3A_dsn">dsn</code></td>
<td>
<p>The data source name. For currently available options, see the
<code>name</code> column of <code><a href="#topic+odbcListDataSources">odbcListDataSources()</a></code> output.</p>
</td></tr>
<tr><td><code id="odbc_+3A_...">...</code></td>
<td>
<p>Additional ODBC keywords. These will be joined with the other
arguments to form the final connection string.
</p>
<p>Note that ODBC parameter names are case-insensitive so that (e.g.) <code>DRV</code>
and <code>drv</code> are equivalent. Since this is different to R and a possible
source of confusion, odbc will error if you supply multiple arguments that
have the same name when case is ignored.
</p>
<p>Any values containing a leading or trailing space, a <code>=</code>, <code style="white-space: pre;">&#8288;;&#8288;</code>, <code style="white-space: pre;">&#8288;{&#8288;</code>,
or <code style="white-space: pre;">&#8288;}&#8288;</code> are likely to require quoting. Use <code><a href="#topic+quote_value">quote_value()</a></code> for a fairly
standard approach or see your driver documentation for specifics.</p>
</td></tr>
<tr><td><code id="odbc_+3A_timezone">timezone</code></td>
<td>
<p>The server time zone. Useful if the database has an internal
timezone that is <em>not</em> 'UTC'. If the database is in your local timezone,
set this argument to <code><a href="base.html#topic+Sys.timezone">Sys.timezone()</a></code>. See <code><a href="base.html#topic+OlsonNames">OlsonNames()</a></code> for a complete
list of available time zones on your system.</p>
</td></tr>
<tr><td><code id="odbc_+3A_timezone_out">timezone_out</code></td>
<td>
<p>The time zone returned to R. If you want to display
datetime values in the local timezone, set to <code><a href="base.html#topic+Sys.timezone">Sys.timezone()</a></code>.</p>
</td></tr>
<tr><td><code id="odbc_+3A_encoding">encoding</code></td>
<td>
<p>The text encoding used on the Database. If the database is
not using UTF-8 you will need to set the encoding to get accurate
re-encoding. See <code><a href="base.html#topic+iconvlist">iconvlist()</a></code> for a complete list of available encodings
on your system. Note strings are always returned <code>UTF-8</code> encoded.</p>
</td></tr>
<tr><td><code id="odbc_+3A_bigint">bigint</code></td>
<td>
<p>The R type that <code>SQL_BIGINT</code> types should be mapped to.
Default is <a href="bit64.html#topic+bit64-package">bit64::integer64</a>, which allows the full range of 64 bit
integers.</p>
</td></tr>
<tr><td><code id="odbc_+3A_timeout">timeout</code></td>
<td>
<p>Time in seconds to timeout the connection attempt. Setting a
timeout of <code>Inf</code> indicates no timeout. Defaults to 10 seconds.</p>
</td></tr>
<tr><td><code id="odbc_+3A_driver">driver</code></td>
<td>
<p>The ODBC driver name or a path to a driver. For currently
available options, see the <code>name</code> column of <code><a href="#topic+odbcListDrivers">odbcListDrivers()</a></code> output.</p>
</td></tr>
<tr><td><code id="odbc_+3A_server">server</code></td>
<td>
<p>The server hostname. Some drivers use <code>Servername</code> as the name
for this argument. Not required when configured for the supplied <code>dsn</code>.</p>
</td></tr>
<tr><td><code id="odbc_+3A_database">database</code></td>
<td>
<p>The database on the server. Not required when configured for
the supplied <code>dsn</code>.</p>
</td></tr>
<tr><td><code id="odbc_+3A_uid">uid</code></td>
<td>
<p>The user identifier. Some drivers use <code>username</code> as the name
for this argument. Not required when configured for the supplied <code>dsn</code>.</p>
</td></tr>
<tr><td><code id="odbc_+3A_pwd">pwd</code></td>
<td>
<p>The password. Some drivers use <code>password</code> as the name
for this argument. Not required when configured for the supplied <code>dsn</code>.</p>
</td></tr>
<tr><td><code id="odbc_+3A_dbms.name">dbms.name</code></td>
<td>
<p>The database management system name. This should normally
be queried automatically by the ODBC driver. This name is used as the class
name for the OdbcConnection object returned from <code><a href="#topic+dbConnect">dbConnect()</a></code>. However, if
the driver does not return a valid value, it can be set manually with this
parameter.</p>
</td></tr>
<tr><td><code id="odbc_+3A_attributes">attributes</code></td>
<td>
<p>An S4 object of connection attributes that are passed
prior to the connection being established. See <a href="#topic+ConnectionAttributes">ConnectionAttributes</a>.</p>
</td></tr>
<tr><td><code id="odbc_+3A_.connection_string">.connection_string</code></td>
<td>
<p>A complete connection string, useful if you are
copy pasting it from another source. If this argument is used, any
additional arguments will be appended to this string.</p>
</td></tr>
</table>


<h3>Connection strings</h3>

<p>Internally, <code>dbConnect()</code> creates a connection string using the supplied
arguments. Connection string keywords are driver-dependent; the arguments
documented here are common, but some drivers may not accept them.
</p>
<p>Alternatively to configuring DSNs and driver names with the driver manager,
you can pass a complete connection string directly as the
<code>.connection_string</code> argument.
<a href="https://www.connectionstrings.com">The Connection Strings Reference</a> is a
useful resource that has example connection strings for a large variety of
databases.
</p>


<h3>Overview</h3>

<p>The odbc package is one piece of the R interface to databases with support
for ODBC:
</p>
<p><img src="../help/figures/whole-game.png" width=95% alt="whole-game.png" />
</p>
<p>The package supports any <strong>Database Management System (DBMS)</strong> with ODBC
support. Support for a given DBMS is provided by an <strong>ODBC driver</strong>, which
defines how to interact with that DBMS using the standardized syntax of ODBC
and SQL. Drivers can be downloaded from the DBMS vendor or, if you're a Posit
customer, using the <a href="https://docs.posit.co/pro-drivers/">professional drivers</a>.
To manage information about each driver and the data sources they provide
access to, our computers use a <strong>driver manager</strong>. Windows is bundled with
a driver manager, while MacOS and Linux require installation of one; this
package supports the <a href="https://www.unixodbc.org/">unixODBC</a> driver manager.
</p>
<p>In the <strong>R interface</strong>, the <a href="https://dbi.r-dbi.org/">DBI package</a> provides a
front-end while odbc implements a back-end to communicate with the driver
manager. The odbc package is built on top of the
<a href="https://nanodbc.github.io/nanodbc/">nanodbc</a> C++ library.
</p>
<p>Interfacing with DBMSs using R and odbc involves three high-level steps:
</p>

<ol>
<li> <p><em>Configure drivers and data sources</em>: the functions <code><a href="#topic+odbcListDrivers">odbcListDrivers()</a></code>
and <code><a href="#topic+odbcListDataSources">odbcListDataSources()</a></code> help to interface with the driver manager.
</p>
</li>
<li> <p><em>Connect to a database</em>: The <code><a href="#topic+dbConnect">dbConnect()</a></code> function, called with the
first argument odbc(), connects to a database using the specified ODBC
driver to create a connection object.
</p>
</li>
<li> <p><em>Interface with connections</em>: The resulting connection object can be
passed to various functions to retrieve information on database
structure (<code><a href="DBI.html#topic+dbListTables">dbListTables()</a></code>), iteratively develop queries (<code><a href="DBI.html#topic+dbSendQuery">dbSendQuery()</a></code>,
<code><a href="DBI.html#topic+dbColumnInfo">dbColumnInfo()</a></code>), and query data objects (<code><a href="DBI.html#topic+dbFetch">dbFetch()</a></code>).
</p>
</li></ol>



<h3>Learn more</h3>

<p>To learn more about databases:
</p>

<ul>
<li> <p><a href="https://solutions.posit.co/connections/db/">&quot;Best Practices in Working with Databases&quot;</a>
documents how to use the odbc package with various popular databases.
</p>
</li>
<li> <p><a href="https://github.com/mkleehammer/pyodbc/wiki/Drivers-and-Driver-Managers">The pyodbc &quot;Drivers and Driver Managers&quot; Wiki</a>
provides further context on drivers and driver managers.
</p>
</li>
<li> <p><a href="https://learn.microsoft.com/en-us/sql/odbc/reference">Microsoft's &quot;Introduction to ODBC&quot;</a>
is a thorough resource on the ODBC interface.
</p>
</li></ul>


<hr>
<h2 id='OdbcConnection-class'>Odbc Connection Methods</h2><span id='topic+OdbcConnection-class'></span><span id='topic+show+2COdbcConnection-method'></span><span id='topic+dbIsValid+2COdbcConnection-method'></span><span id='topic+dbDisconnect+2COdbcConnection-method'></span><span id='topic+dbSendQuery+2COdbcConnection+2Ccharacter-method'></span><span id='topic+dbExecute+2COdbcConnection+2Ccharacter-method'></span><span id='topic+dbSendStatement+2COdbcConnection+2Ccharacter-method'></span><span id='topic+dbDataType+2COdbcConnection+2CANY-method'></span><span id='topic+dbDataType+2COdbcConnection+2Cdata.frame-method'></span><span id='topic+dbQuoteIdentifier+2COdbcConnection+2Ccharacter-method'></span><span id='topic+dbQuoteIdentifier+2COdbcConnection+2CSQL-method'></span><span id='topic+dbGetInfo+2COdbcConnection-method'></span><span id='topic+dbGetQuery+2COdbcConnection+2Ccharacter-method'></span><span id='topic+dbBegin+2COdbcConnection-method'></span><span id='topic+dbCommit+2COdbcConnection-method'></span><span id='topic+dbRollback+2COdbcConnection-method'></span><span id='topic+OdbcConnection'></span><span id='topic+dbExistsTable+2COdbcConnection+2CId-method'></span><span id='topic+dbExistsTable+2COdbcConnection+2CSQL-method'></span><span id='topic+dbExistsTable+2COdbcConnection+2Ccharacter-method'></span><span id='topic+dbRemoveTable+2COdbcConnection+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Implementations of pure virtual functions defined in the <code>DBI</code> package
for OdbcConnection objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'OdbcConnection'
show(object)

## S4 method for signature 'OdbcConnection'
dbIsValid(dbObj, ...)

## S4 method for signature 'OdbcConnection'
dbDisconnect(conn, ...)

## S4 method for signature 'OdbcConnection,character'
dbSendQuery(conn, statement, params = NULL, ..., immediate = FALSE)

## S4 method for signature 'OdbcConnection,character'
dbExecute(conn, statement, params = NULL, ..., immediate = is.null(params))

## S4 method for signature 'OdbcConnection,character'
dbSendStatement(conn, statement, params = NULL, ..., immediate = FALSE)

## S4 method for signature 'OdbcConnection,ANY'
dbDataType(dbObj, obj, ...)

## S4 method for signature 'OdbcConnection,data.frame'
dbDataType(dbObj, obj, ...)

## S4 method for signature 'OdbcConnection,character'
dbQuoteIdentifier(conn, x, ...)

## S4 method for signature 'OdbcConnection,SQL'
dbQuoteIdentifier(conn, x, ...)

## S4 method for signature 'OdbcConnection'
dbGetInfo(dbObj, ...)

## S4 method for signature 'OdbcConnection,character'
dbGetQuery(
  conn,
  statement,
  n = -1,
  params = NULL,
  immediate = is.null(params),
  ...
)

## S4 method for signature 'OdbcConnection'
dbBegin(conn, ...)

## S4 method for signature 'OdbcConnection'
dbCommit(conn, ...)

## S4 method for signature 'OdbcConnection'
dbRollback(conn, ...)

## S4 method for signature 'OdbcConnection,Id'
dbExistsTable(conn, name, ...)

## S4 method for signature 'OdbcConnection,SQL'
dbExistsTable(conn, name, ...)

## S4 method for signature 'OdbcConnection,character'
dbExistsTable(conn, name, ...)

## S4 method for signature 'OdbcConnection,character'
dbRemoveTable(conn, name, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OdbcConnection-class_+3A_object">object</code></td>
<td>
<p>Any R object</p>
</td></tr>
<tr><td><code id="OdbcConnection-class_+3A_dbobj">dbObj</code></td>
<td>
<p>An object inheriting from <a href="DBI.html#topic+DBIObject-class">DBIObject</a>,
i.e. <a href="DBI.html#topic+DBIDriver-class">DBIDriver</a>, <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a>,
or a <a href="DBI.html#topic+DBIResult-class">DBIResult</a></p>
</td></tr>
<tr><td><code id="OdbcConnection-class_+3A_...">...</code></td>
<td>
<p>Other arguments to methods.</p>
</td></tr>
<tr><td><code id="OdbcConnection-class_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="OdbcConnection-class_+3A_statement">statement</code></td>
<td>
<p>a character string containing SQL.</p>
</td></tr>
<tr><td><code id="OdbcConnection-class_+3A_params">params</code></td>
<td>
<p>Query parameters to pass to <code><a href="DBI.html#topic+dbBind">dbBind()</a></code>.
See <code><a href="DBI.html#topic+dbBind">dbBind()</a></code> for details.</p>
</td></tr>
<tr><td><code id="OdbcConnection-class_+3A_immediate">immediate</code></td>
<td>
<p>If <code>TRUE</code>, SQLExecDirect will be used instead of
SQLPrepare, and the <code>params</code> argument is ignored</p>
</td></tr>
<tr><td><code id="OdbcConnection-class_+3A_obj">obj</code></td>
<td>
<p>An R object whose SQL type we want to determine.</p>
</td></tr>
<tr><td><code id="OdbcConnection-class_+3A_x">x</code></td>
<td>
<p>A character vector, <a href="DBI.html#topic+SQL">SQL</a> or <a href="DBI.html#topic+Id">Id</a> object to quote as identifier.</p>
</td></tr>
<tr><td><code id="OdbcConnection-class_+3A_n">n</code></td>
<td>
<p>maximum number of records to retrieve per fetch. Use <code>n = -1</code>
or <code>n = Inf</code>
to retrieve all pending records.  Some implementations may recognize other
special values.</p>
</td></tr>
<tr><td><code id="OdbcConnection-class_+3A_name">name</code></td>
<td>
<p>The table name, passed on to <code><a href="DBI.html#topic+dbQuoteIdentifier">dbQuoteIdentifier()</a></code>. Options are:
</p>

<ul>
<li><p> a character string with the unquoted DBMS table name,
e.g. <code>"table_name"</code>,
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+Id">Id()</a></code> with components to the fully qualified table name,
e.g. <code>Id(schema = "my_schema", table = "table_name")</code>
</p>
</li>
<li><p> a call to <code><a href="DBI.html#topic+SQL">SQL()</a></code> with the quoted and fully qualified table name
given verbatim, e.g. <code>SQL('"my_schema"."table_name"')</code>
</p>
</li></ul>
</td></tr>
</table>

<hr>
<h2 id='odbcConnectionActions'>List the actions supported for the connection</h2><span id='topic+odbcConnectionActions'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p>Return a list of actions that can be performed on the connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcConnectionActions(connection)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbcConnectionActions_+3A_connection">connection</code></td>
<td>
<p>A connection object, as returned by <code>dbConnect()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The list returned is a named list of actions, where each action has the
following properties:
</p>

<dl>
<dt>callback</dt><dd><p>A function to be invoked to perform the action</p>
</dd>
<dt>icon</dt><dd><p>An optional path to an icon representing the action</p>
</dd>
</dl>



<h3>Value</h3>

<p>A named list of actions that can be performed on the connection.
</p>

<hr>
<h2 id='odbcConnectionColumns'>odbcConnectionColumns</h2><span id='topic+odbcConnectionColumns'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
</p>
<p>This function has been deprecated in favor of <code><a href="DBI.html#topic+dbListFields">dbListFields()</a></code>.
</p>
<p>For a given table this function returns detailed information on
all fields / columns.  The expectation is that this is a relatively thin
wrapper around the ODBC <code>SQLColumns</code> function call, with some of the field
names renamed / re-ordered according to the return specifications below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcConnectionColumns(conn, name, ..., exact = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbcConnectionColumns_+3A_conn">conn</code></td>
<td>
<p>OdbcConnection</p>
</td></tr>
<tr><td><code id="odbcConnectionColumns_+3A_name">name</code></td>
<td>
<p>Table identifiers.
By default, are interpreted as a ODBC search pattern where <code style="white-space: pre;">&#8288;_&#8288;</code> and <code style="white-space: pre;">&#8288;%&#8288;</code> are
wild cards. Set <code>exact = TRUE</code> to match <code style="white-space: pre;">&#8288;_&#8288;</code> exactly.</p>
</td></tr>
<tr><td><code id="odbcConnectionColumns_+3A_...">...</code></td>
<td>
<p>additional parameters to methods</p>
</td></tr>
<tr><td><code id="odbcConnectionColumns_+3A_exact">exact</code></td>
<td>
<p>Set to <code>TRUE</code> to escape <code style="white-space: pre;">&#8288;_&#8288;</code> in identifier names so that it
matches exactly, rather than matching any single character. <code style="white-space: pre;">&#8288;%&#8288;</code> always
matches any number of characters as this is unlikely to appear in a
table name.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In <code><a href="DBI.html#topic+dbWriteTable">dbWriteTable()</a></code> we make a call to this method
to get details on the fields of the table we are writing to.  In particular
the columns <code>data_type</code>, <code>column_size</code>, and <code>decimal_digits</code> are used.  An
implementation is not necessary for <code><a href="DBI.html#topic+dbWriteTable">dbWriteTable()</a></code> to work.
</p>
<p><code>odbcConnectionColumns</code> is routed through the <code>SQLColumns</code> ODBC
method.  This function, together with remaining catalog functions
(<code>SQLTables</code>, etc), by default ( <code>SQL_ATTR_METADATA_ID == false</code> ) expect
either ordinary arguments (OA) in the case of the catalog, or pattern value
arguments (PV) in the case of schema/table name.  For these, quoted
identifiers do not make sense, so we unquote identifiers prior to the call.
</p>


<h3>Value</h3>

<p>data.frame with columns
</p>

<ul>
<li><p> name
</p>
</li>
<li><p> field.type - equivalent to type_name in SQLColumns output
</p>
</li>
<li><p> table_name
</p>
</li>
<li><p> schema_name
</p>
</li>
<li><p> catalog_name
</p>
</li>
<li><p> data_type
</p>
</li>
<li><p> column_size
</p>
</li>
<li><p> buffer_length
</p>
</li>
<li><p> decimal_digits
</p>
</li>
<li><p> numeric_precision_radix
</p>
</li>
<li><p> remarks
</p>
</li>
<li><p> column_default
</p>
</li>
<li><p> sql_data_type
</p>
</li>
<li><p> sql_datetime_subtype
</p>
</li>
<li><p> char_octet_length
</p>
</li>
<li><p> ordinal_position
</p>
</li>
<li><p> nullable
</p>
</li></ul>



<h3>See Also</h3>

<p>The ODBC documentation on
<a href="https://docs.microsoft.com/en-us/sql/odbc/reference/syntax/sqlcolumns-function">SQLColumns</a>
for further details.
</p>

<hr>
<h2 id='odbcConnectionIcon'>Get an icon representing a connection.</h2><span id='topic+odbcConnectionIcon'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
Return the path on disk to an icon representing a connection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcConnectionIcon(connection)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbcConnectionIcon_+3A_connection">connection</code></td>
<td>
<p>A connection object, as returned by <code>dbConnect()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The icon returned should be a 32x32 square image file.
</p>


<h3>Value</h3>

<p>The path to an icon file on disk.
</p>

<hr>
<h2 id='odbcDataType'>Return the corresponding ODBC data type for an R object</h2><span id='topic+odbcDataType'></span>

<h3>Description</h3>

<p>This is used when creating a new table with <code>dbWriteTable()</code>.
Databases with default methods defined are
</p>

<ul>
<li><p> MySQL
</p>
</li>
<li><p> PostgreSQL
</p>
</li>
<li><p> SQL Server
</p>
</li>
<li><p> Oracle
</p>
</li>
<li><p> SQLite
</p>
</li>
<li><p> Spark
</p>
</li>
<li><p> Hive
</p>
</li>
<li><p> Impala
</p>
</li>
<li><p> Redshift
</p>
</li>
<li><p> Vertica
</p>
</li>
<li><p> BigQuery
</p>
</li>
<li><p> Teradata
</p>
</li>
<li><p> Access
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>odbcDataType(con, obj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbcDataType_+3A_con">con</code></td>
<td>
<p>A driver connection object, as returned by <code>dbConnect()</code>.</p>
</td></tr>
<tr><td><code id="odbcDataType_+3A_obj">obj</code></td>
<td>
<p>An R object.</p>
</td></tr>
<tr><td><code id="odbcDataType_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you are using a different database and <code>dbWriteTable()</code> fails with a SQL
parsing error the default method is not appropriate, you will need to write
a new method.
</p>


<h3>Value</h3>

<p>Corresponding SQL type for the <code>obj</code>.
</p>


<h3>Defining a new dbDataType method</h3>

<p>The object type for your connection will be the database name retrieved by
<code>dbGetInfo(con)$dbms.name</code>. Use the documentation provided with your
database to determine appropriate values for each R data type. An example
method definition of a fictional <code>foo</code> database follows.
</p>
<div class="sourceCode"><pre>con &lt;- dbConnect(odbc::odbc(), "FooConnection")
dbGetInfo(con)$dbms.name
#&gt; [1] "foo"

`odbcDataType.foo &lt;- function(con, obj, ...) {
  switch_type(obj,
    factor = "VARCHAR(255)",
    datetime = "TIMESTAMP",
    date = "DATE",
    binary = "BINARY",
    integer = "INTEGER",
    double = "DOUBLE",
    character = "VARCHAR(255)",
    logical = "BIT",
    list = "VARCHAR(255)",
    stop("Unsupported type", call. = FALSE)
  )
}
</pre></div>

<hr>
<h2 id='OdbcDriver'>Odbc Driver Methods</h2><span id='topic+OdbcDriver'></span><span id='topic+OdbcDriver-class'></span><span id='topic+show+2COdbcDriver-method'></span><span id='topic+dbDataType+2COdbcDriver+2CANY-method'></span><span id='topic+dbDataType+2COdbcDriver+2Clist-method'></span><span id='topic+dbDataType+2COdbcDriver+2Cdata.frame-method'></span><span id='topic+dbIsValid+2COdbcDriver-method'></span><span id='topic+dbGetInfo+2COdbcDriver-method'></span>

<h3>Description</h3>

<p>Implementations of pure virtual functions defined in the <code>DBI</code> package
for OdbcDriver objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'OdbcDriver'
show(object)

## S4 method for signature 'OdbcDriver,ANY'
dbDataType(dbObj, obj, ...)

## S4 method for signature 'OdbcDriver,list'
dbDataType(dbObj, obj, ...)

## S4 method for signature 'OdbcDriver,data.frame'
dbDataType(dbObj, obj, ...)

## S4 method for signature 'OdbcDriver'
dbIsValid(dbObj, ...)

## S4 method for signature 'OdbcDriver'
dbGetInfo(dbObj, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OdbcDriver_+3A_object">object</code></td>
<td>
<p>Any R object</p>
</td></tr>
<tr><td><code id="OdbcDriver_+3A_dbobj">dbObj</code></td>
<td>
<p>A object inheriting from <a href="DBI.html#topic+DBIDriver-class">DBIDriver</a>
or <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a></p>
</td></tr>
<tr><td><code id="OdbcDriver_+3A_obj">obj</code></td>
<td>
<p>An R object whose SQL type we want to determine.</p>
</td></tr>
<tr><td><code id="OdbcDriver_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods.</p>
</td></tr>
</table>

<hr>
<h2 id='odbcListColumns'>List columns in an object.</h2><span id='topic+odbcListColumns'></span>

<h3>Description</h3>

<p>Lists the names and types of each column (field) of a specified object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcListColumns(connection, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbcListColumns_+3A_connection">connection</code></td>
<td>
<p>A connection object, as returned by <code>dbConnect()</code>.</p>
</td></tr>
<tr><td><code id="odbcListColumns_+3A_...">...</code></td>
<td>
<p>Parameters specifying the object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The object to inspect must be specified as one of the arguments
(e.g. <code>table = "employees"</code>); depending on the driver and underlying
data store, additional specification arguments may be required.
</p>


<h3>Value</h3>

<p>A data frame with <code>name</code> and <code>type</code> columns, listing the
object's fields.
</p>

<hr>
<h2 id='odbcListConfig'>List locations of ODBC configuration files</h2><span id='topic+odbcListConfig'></span>

<h3>Description</h3>

<p>On MacOS and Linux, odbc uses the unixODBC driver manager to manage
information about driver and data sources. This helper returns the filepaths
where the driver manager will look for that information.
</p>
<p>This function is a wrapper around the command line call <code>odbcinst -j</code>.
</p>
<p>Windows does not use <code>.ini</code> configuration files; this function will return a
0-length vector on Windows.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcListConfig()
</code></pre>


<h3>See Also</h3>

<p>The <code><a href="#topic+odbcListDrivers">odbcListDrivers()</a></code> and <code><a href="#topic+odbcListDataSources">odbcListDataSources()</a></code> helpers return
information on the contents of <code>odbcinst.ini</code> and <code>odbc.ini</code> files,
respectively.
</p>
<p>Learn more about unixODBC and the <code>odbcinst</code> utility
<a href="https://www.unixodbc.org/odbcinst.html">here</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
configs &lt;- odbcListConfig()

file.edit(configs[1])

</code></pre>

<hr>
<h2 id='odbcListDataSources'>List Configured Data Source Names</h2><span id='topic+odbcListDataSources'></span>

<h3>Description</h3>

<p>Collect information about the available data source names (DSNs). A DSN must
be both installed and configured with the driver manager to be included in
this list. Configuring a DSN just sets up a lookup table (e.g. in
<code>odbc.ini</code>) to allow users to pass only the DSN to <code><a href="#topic+dbConnect">dbConnect()</a></code>.
</p>
<p>DSNs that are not configured with the driver manager can still be
connected to with <code><a href="#topic+dbConnect">dbConnect()</a></code> by providing DSN metadata directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcListDataSources()
</code></pre>


<h3>Value</h3>

<p>A data frame with two columns:
</p>

<dl>
<dt>name</dt><dd><p>Name of the data source. The entries in this column can be
passed to the <code>dsn</code> argument of <code><a href="#topic+dbConnect">dbConnect()</a></code>.</p>
</dd>
<dt>description</dt><dd><p>Data source description.</p>
</dd>
</dl>



<h3>Configuration</h3>

<p>This function interfaces with the driver manager to collect information
about the available data source names.
</p>
<p>For <strong>MacOS and Linux</strong>, the odbc package supports the unixODBC driver
manager. unixODBC looks to the <code>odbc.ini</code> <em>configuration file</em> for information
on DSNs. Find the location(s) of your <code>odbc.ini</code> file(s) with <code>odbcinst -j</code>.
</p>
<p>In this example <code>odbc.ini</code> file:
</p>
<div class="sourceCode"><pre>[MySQL]
Driver = MySQL Driver
Database = test
Server = 127.0.0.1
User = root
password = root
Port = 3306
</pre></div>
<p>...the data source name is <code>MySQL</code>, which will appear in the <code>name</code>
column of this function's output. To pass the DSN as the <code>dsn</code> argument to
<code><a href="#topic+dbConnect">dbConnect()</a></code>, pass it as a string, like <code>"MySQL"</code>.
<code style="white-space: pre;">&#8288;Driver = MySQL Driver&#8288;</code> references the driver <code>name</code> in <code><a href="#topic+odbcListDrivers">odbcListDrivers()</a></code>
output.
</p>
<p><strong>Windows</strong> is <a href="https://learn.microsoft.com/en-us/sql/odbc/admin/odbc-data-source-administrator">bundled</a>
with an ODBC driver manager.
</p>
<p>When a DSN is configured with a driver manager, information on the DSN will
be automatically passed on to <code><a href="#topic+dbConnect">dbConnect()</a></code> when its <code>dsn</code> argument is set.
</p>
<p>For example, with the <code>MySQL</code> data source name configured, and the driver
name <code style="white-space: pre;">&#8288;MySQL Driver&#8288;</code> appearing in <code><a href="#topic+odbcListDrivers">odbcListDrivers()</a></code> output, the code:
</p>
<div class="sourceCode"><pre>con &lt;-
  dbConnect(
    odbc::odbc(),
    Driver = "MySQL Driver",
    Database = "test",
    Server = "127.0.0.1",
    User = "root",
    password = "root",
    Port = 3306
  )
</pre></div>
<p>...can be written:
</p>
<div class="sourceCode"><pre>con &lt;- dbConnect(odbc::odbc(), dsn = "MySQL")
</pre></div>
<p>In this case, <code>dbConnect()</code> will look up the information defined for <code>MySQL</code>
in the driver manager (in our example, <code>odbc.ini</code>) and automatically
pass the needed arguments.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+odbcListDrivers">odbcListDrivers()</a></code>
</p>

<hr>
<h2 id='odbcListDrivers'>List Configured ODBC Drivers</h2><span id='topic+odbcListDrivers'></span>

<h3>Description</h3>

<p>Collect information about the configured driver names. A driver must be both
installed and configured with the driver manager to be included in this list.
Configuring a driver name just sets up a lookup table (e.g. in
<code>odbcinst.ini</code>) to allow users to pass only the driver name to <code><a href="#topic+dbConnect">dbConnect()</a></code>.
</p>
<p>Driver names that are not configured with the driver manager (and thus
do not appear in this function's output) can still be
used in <code><a href="#topic+dbConnect">dbConnect()</a></code> by providing a path to a driver directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcListDrivers(
  keep = getOption("odbc.drivers_keep"),
  filter = getOption("odbc.drivers_filter")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbcListDrivers_+3A_keep">keep</code>, <code id="odbcListDrivers_+3A_filter">filter</code></td>
<td>
<p>A character vector of driver names to keep in or remove
from the results, respectively. If <code>NULL</code>, all driver names will be kept,
or none will be removed, respectively. The <code>odbc.drivers_keep</code> and
<code>odbc.drivers_filter</code> options control the argument defaults.
</p>
<p>Driver names are first processed with <code>keep</code>, then <code>filter</code>. Thus, if a
driver name is in both <code>keep</code> and <code>filter</code>, it won't appear in output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with three columns.
</p>

<dl>
<dt>name</dt><dd><p>Name of the driver. The entries in this column can be
passed to the <code>driver</code> argument of <code><a href="#topic+dbConnect">dbConnect()</a></code> (as long as the
driver accepts the argument).</p>
</dd>
<dt>attribute</dt><dd><p>Driver attribute name.</p>
</dd>
<dt>value</dt><dd><p>Driver attribute value.</p>
</dd>
</dl>

<p>If a driver has multiple attributes, there will be one row per attribute,
each with the same driver <code>name</code>. If a given driver name does not have any
attributes, the function will return one row with the driver <code>name</code>, but
the last two columns will be <code>NA</code>.
</p>


<h3>Configuration</h3>

<p>This function interfaces with the driver manager to collect information
about the available driver names.
</p>
<p>For <strong>MacOS and Linux</strong>, the odbc package supports the unixODBC driver
manager. unixODBC looks to the <code>odbcinst.ini</code> <em>configuration file</em> for
information on driver names. Find the location(s) of your <code>odbcinst.ini</code>
file(s) with <code>odbcinst -j</code>.
</p>
<p>In this example <code>odbcinst.ini</code> file:
</p>
<div class="sourceCode"><pre>[MySQL Driver]
Driver=/opt/homebrew/Cellar/mysql/8.2.0_1/lib/libmysqlclient.dylib
</pre></div>
<p>Then the driver name is <code style="white-space: pre;">&#8288;MySQL Driver&#8288;</code>, which will appear in the <code>name</code>
column of this function's output. To pass the driver name as the <code>driver</code>
argument to <code><a href="#topic+dbConnect">dbConnect()</a></code>, pass it as a string, like <code>"MySQL Driver"</code>.
</p>
<p><strong>Windows</strong> is <a href="https://learn.microsoft.com/en-us/sql/odbc/admin/odbc-data-source-administrator">bundled</a>
with an ODBC driver manager.
</p>
<p>In this example, function output would include 1 row: the <code>name</code> column
would read <code>"MySQL Driver"</code>, <code>attribute</code> would be <code>"Driver"</code>, and <code>value</code>
would give the file path to the driver. Additional key-value pairs
under the driver name would add additional rows with the same <code>name</code> entry.
</p>
<p>When a driver is configured with a driver manager, information on the driver
will be automatically passed on to <code><a href="#topic+dbConnect">dbConnect()</a></code> when its <code>driver</code> argument
is set. For an example, see the same section in the <code><a href="#topic+odbcListDataSources">odbcListDataSources()</a></code>
help-file. Instead of configuring driver information with a driver manager,
it is also possible to provide a path to a driver directly to <code><a href="#topic+dbConnect">dbConnect()</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+odbcListDataSources">odbcListDataSources()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
odbcListDrivers()

</code></pre>

<hr>
<h2 id='odbcListObjects'>List objects in a connection.</h2><span id='topic+odbcListObjects'></span>

<h3>Description</h3>

<p>Lists all of the objects in the connection, or all the objects which have
specific attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcListObjects(connection, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbcListObjects_+3A_connection">connection</code></td>
<td>
<p>A connection object, as returned by <code>dbConnect()</code>.</p>
</td></tr>
<tr><td><code id="odbcListObjects_+3A_...">...</code></td>
<td>
<p>Attributes to filter by.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When used without parameters, this function returns all of the objects known
by the connection. Any parameters passed will filter the list to only objects
which have the given attributes; for instance, passing <code>schema = "foo"</code>
will return only objects matching the schema <code>foo</code>.
</p>


<h3>Value</h3>

<p>A data frame with <code>name</code> and <code>type</code> columns, listing the
objects.
</p>

<hr>
<h2 id='odbcListObjectTypes'>Return the object hierarchy supported by a connection.</h2><span id='topic+odbcListObjectTypes'></span>

<h3>Description</h3>

<p>Lists the object types and metadata known by the connection, and how those
object types relate to each other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcListObjectTypes(connection)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbcListObjectTypes_+3A_connection">connection</code></td>
<td>
<p>A connection object, as returned by <code>dbConnect()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The returned hierarchy takes the form of a nested list, in which each object
type supported by the connection is a named list with the following
attributes:
</p>

<dl>
<dt>contains</dt><dd><p>A list of other object types contained by the object, or
&quot;data&quot; if the object contains data</p>
</dd>
<dt>icon</dt><dd><p>An optional path to an icon representing the type</p>
</dd>
</dl>

<p>For instance, a connection in which the top-level object is a schema that
contains tables and views, the function will return a list like the
following:
</p>
<pre>list(schema = list(contains = list(
                   list(name = "table", contains = "data")
                   list(name = "view", contains = "data"))))

</pre>


<h3>Value</h3>

<p>The hierarchy of object types supported by the connection.
</p>

<hr>
<h2 id='odbcPreviewObject'>Preview the data in an object.</h2><span id='topic+odbcPreviewObject'></span>

<h3>Description</h3>

<p>Return the data inside an object as a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcPreviewObject(connection, rowLimit, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbcPreviewObject_+3A_connection">connection</code></td>
<td>
<p>A connection object, as returned by <code>dbConnect()</code>.</p>
</td></tr>
<tr><td><code id="odbcPreviewObject_+3A_rowlimit">rowLimit</code></td>
<td>
<p>The maximum number of rows to display.</p>
</td></tr>
<tr><td><code id="odbcPreviewObject_+3A_...">...</code></td>
<td>
<p>Parameters specifying the object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The object to previewed must be specified as one of the arguments
(e.g. <code>table = "employees"</code>); depending on the driver and underlying
data store, additional specification arguments may be required.
</p>


<h3>Value</h3>

<p>A data frame containing the data in the object.
</p>

<hr>
<h2 id='odbcPreviewQuery'>Create a preview query.</h2><span id='topic+odbcPreviewQuery'></span><span id='topic+odbcPreviewQuery.OdbcConnection'></span><span id='topic+odbcPreviewQuery.Microsoft+20SQL+20Server'></span><span id='topic+odbcPreviewQuery.Oracle'></span>

<h3>Description</h3>

<p>Optimize against the rowLimit argument.  S3 since some
back-ends do not parse the LIMIT syntax.  Internal, not expected that
users would interact with this method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcPreviewQuery(connection, rowLimit, name)

## S3 method for class 'OdbcConnection'
odbcPreviewQuery(connection, rowLimit, name)

## S3 method for class ''Microsoft SQL Server''
odbcPreviewQuery(connection, rowLimit, name)

## S3 method for class 'Oracle'
odbcPreviewQuery(connection, rowLimit, name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbcPreviewQuery_+3A_connection">connection</code></td>
<td>
<p>A connection object, as returned by <code>dbConnect()</code>.</p>
</td></tr>
<tr><td><code id="odbcPreviewQuery_+3A_rowlimit">rowLimit</code></td>
<td>
<p>The maximum number of rows to display.</p>
</td></tr>
<tr><td><code id="odbcPreviewQuery_+3A_name">name</code></td>
<td>
<p>Name of the object to be previewed</p>
</td></tr>
</table>

<hr>
<h2 id='OdbcResult'>Odbc Result Methods</h2><span id='topic+OdbcResult'></span><span id='topic+OdbcResult-class'></span><span id='topic+dbClearResult+2COdbcResult-method'></span><span id='topic+dbFetch+2COdbcResult-method'></span><span id='topic+dbHasCompleted+2COdbcResult-method'></span><span id='topic+dbIsValid+2COdbcResult-method'></span><span id='topic+dbGetStatement+2COdbcResult-method'></span><span id='topic+dbColumnInfo+2COdbcResult-method'></span><span id='topic+dbGetRowCount+2COdbcResult-method'></span><span id='topic+dbGetRowsAffected+2COdbcResult-method'></span><span id='topic+dbBind+2COdbcResult-method'></span>

<h3>Description</h3>

<p>Implementations of pure virtual functions defined in the <code>DBI</code> package
for OdbcResult objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'OdbcResult'
dbClearResult(res, ...)

## S4 method for signature 'OdbcResult'
dbFetch(res, n = -1, ...)

## S4 method for signature 'OdbcResult'
dbHasCompleted(res, ...)

## S4 method for signature 'OdbcResult'
dbIsValid(dbObj, ...)

## S4 method for signature 'OdbcResult'
dbGetStatement(res, ...)

## S4 method for signature 'OdbcResult'
dbColumnInfo(res, ...)

## S4 method for signature 'OdbcResult'
dbGetRowCount(res, ...)

## S4 method for signature 'OdbcResult'
dbGetRowsAffected(res, ...)

## S4 method for signature 'OdbcResult'
dbBind(res, params, ..., batch_rows = getOption("odbc.batch_rows", NA))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OdbcResult_+3A_res">res</code></td>
<td>
<p>An object inheriting from <a href="DBI.html#topic+DBIResult-class">DBIResult</a>.</p>
</td></tr>
<tr><td><code id="OdbcResult_+3A_...">...</code></td>
<td>
<p>Other arguments passed on to methods.</p>
</td></tr>
<tr><td><code id="OdbcResult_+3A_n">n</code></td>
<td>
<p>maximum number of records to retrieve per fetch. Use <code>n = -1</code>
or <code>n = Inf</code>
to retrieve all pending records.  Some implementations may recognize other
special values.</p>
</td></tr>
<tr><td><code id="OdbcResult_+3A_dbobj">dbObj</code></td>
<td>
<p>An object inheriting from <a href="DBI.html#topic+DBIObject-class">DBIObject</a>,
i.e. <a href="DBI.html#topic+DBIDriver-class">DBIDriver</a>, <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a>,
or a <a href="DBI.html#topic+DBIResult-class">DBIResult</a></p>
</td></tr>
<tr><td><code id="OdbcResult_+3A_params">params</code></td>
<td>
<p>For <code>dbBind()</code>, a list of values, named or unnamed,
or a data frame, with one element/column per query parameter.
For <code>dbBindArrow()</code>, values as a nanoarrow stream,
with one column per query parameter.</p>
</td></tr>
<tr><td><code id="OdbcResult_+3A_batch_rows">batch_rows</code></td>
<td>
<p>The number of rows to retrieve. Defaults to <code>NA</code>, which
is set dynamically to the size of the input. Depending on the database,
driver, dataset and free memory setting this to a lower value may improve
performance.</p>
</td></tr>
</table>

<hr>
<h2 id='odbcSetTransactionIsolationLevel'>Set the Transaction Isolation Level for a Connection</h2><span id='topic+odbcSetTransactionIsolationLevel'></span>

<h3>Description</h3>

<p>Set the Transaction Isolation Level for a Connection
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odbcSetTransactionIsolationLevel(conn, levels)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="odbcSetTransactionIsolationLevel_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
<tr><td><code id="odbcSetTransactionIsolationLevel_+3A_levels">levels</code></td>
<td>
<p>One or more of 'read_uncommitted', 'read_committed', 'repeatable_read', 'serializable'.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="https://docs.microsoft.com/en-us/sql/odbc/reference/develop-app/setting-the-transaction-isolation-level">https://docs.microsoft.com/en-us/sql/odbc/reference/develop-app/setting-the-transaction-isolation-level</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Can use spaces or underscores in between words.
odbcSetTransactionIsolationLevel(con, "read uncommitted")

# Can also use the full constant name.
odbcSetTransactionIsolationLevel(con, "SQL_TXN_READ_UNCOMMITTED")

## End(Not run)
</code></pre>

<hr>
<h2 id='Oracle-class'>Oracle</h2><span id='topic+Oracle-class'></span><span id='topic+sqlCreateTable+2COracle-method'></span><span id='topic+odbcConnectionTables+2COracle+2Ccharacter-method'></span><span id='topic+odbcConnectionColumns_+2COracle+2Ccharacter-method'></span>

<h3>Description</h3>

<p>Details of Oracle methods for odbc and DBI generics.
</p>


<h4><code>odbcConnectionTables()</code></h4>

<p>Method for an internal function that otherwise relies on the <code>SQLTables</code>
ODBC API. While this method is much faster than the OEM implementation, it
does not look through synonyms.
</p>



<h4><code>odbcConnectionColumns()</code></h4>

<p>Query, rather than use <code>SQLColumns</code> ODBC API, since we bind a <code>BIGINT</code> to
one of the column results and Oracle's OEM driver can't handle it.
</p>



<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Oracle'
sqlCreateTable(
  con,
  table,
  fields,
  row.names = NA,
  temporary = FALSE,
  ...,
  field.types = NULL
)

## S4 method for signature 'Oracle,character'
odbcConnectionTables(
  conn,
  name,
  catalog_name = NULL,
  schema_name = NULL,
  table_type = NULL,
  exact = FALSE
)
</code></pre>

<hr>
<h2 id='quote_value'>Quote special character when connecting</h2><span id='topic+quote_value'></span>

<h3>Description</h3>

<p>When connecting to a database using odbc, all the arguments are concatenated
into a single connection string that looks like <code style="white-space: pre;">&#8288;name1=value1;name2=value2&#8288;</code>.
That means if your value contains <code>=</code> or <code style="white-space: pre;">&#8288;;&#8288;</code> then it needs to be quoted.
Other rules mean that you need to quote any values that starts or ends with
white space, or contains <code style="white-space: pre;">&#8288;{&#8288;</code> or <code style="white-space: pre;">&#8288;}&#8288;</code>.
</p>
<p>This function quotes a string in a way that should work for most drivers,
but unfortunately there doesn't seem to be an approach that works everywhere.
If this function doesn't work for you, you'll need to carefully read the
docs for your driver.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quote_value(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quote_value_+3A_x">x</code></td>
<td>
<p>A string to quote.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A quoted string, wrapped in <code>I()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>quote_value("abc")
quote_value("ab'c")

# Real usage is more likely to look like:
## Not run: 
library(DBI)

con &lt;- dbConnect(
  odbc::odbc(),
  dsn = "reallycooldatabase"
  password = odbc::quote_value(Sys.getenv("MY_PASSWORD"))
)

## End(Not run)
</code></pre>

<hr>
<h2 id='sqlData+2COdbcConnection-method'>Unimportant DBI methods</h2><span id='topic+sqlData+2COdbcConnection-method'></span><span id='topic+DBI-methods'></span><span id='topic+sqlCreateTable+2CDB2+2FAIX64-method'></span><span id='topic+sqlCreateTable+2CHDB-method'></span><span id='topic+dbQuoteString+2CHive+2Ccharacter-method'></span><span id='topic+sqlCreateTable+2CTeradata-method'></span>

<h3>Description</h3>

<p>Unimportant DBI methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'OdbcConnection'
sqlData(con, value, row.names = NA, ...)

## S4 method for signature 'HDB'
sqlCreateTable(
  con,
  table,
  fields,
  row.names = NA,
  temporary = FALSE,
  ...,
  field.types = NULL
)

## S4 method for signature 'Hive,character'
dbQuoteString(conn, x, ...)

## S4 method for signature 'Teradata'
sqlCreateTable(
  con,
  table,
  fields,
  row.names = NA,
  temporary = FALSE,
  ...,
  field.types = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sqlData+2B2COdbcConnection-method_+3A_...">...</code></td>
<td>
<p>Other parameters passed on to methods.</p>
</td></tr>
<tr><td><code id="sqlData+2B2COdbcConnection-method_+3A_conn">conn</code></td>
<td>
<p>A <a href="DBI.html#topic+DBIConnection-class">DBIConnection</a> object, as returned by
<code><a href="DBI.html#topic+dbConnect">dbConnect()</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='SUPPORTED_CONNECTION_ATTRIBUTES'>Supported Connection Attributes</h2><span id='topic+SUPPORTED_CONNECTION_ATTRIBUTES'></span><span id='topic+ConnectionAttributes'></span>

<h3>Description</h3>

<p>These (pre) connection attributes are supported and can be passed as
part of the <code>dbConnect</code> call in the named list <code>attributes</code> parameter:
</p>


<h3>Details</h3>


<ul>
<li> <p><code>azure_token</code>: This should be a string scalar; in particular Azure Active
Directory authentication token.  Only for use with Microsoft SQL Server and
with limited support away from the OEM Microsoft driver.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
conn &lt;- dbConnect(
  odbc::odbc(),
  dsn = "my_azure_mssql_db",
  Encrypt = "yes",
  attributes = list("azure_token" = .token)
)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
