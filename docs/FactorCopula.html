<!DOCTYPE html><html><head><title>Help for package FactorCopula</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FactorCopula}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#discrepancy'>
<p>Diagnostics to detect a factor dependence structure</p></a></li>
<li><a href='#FactorCopula-package'><p>Factor, bi-factor, second-order and factor tree copula models</p></a></li>
<li><a href='#GSS'>
<p>The 1994 General Social Survey</p></a></li>
<li><a href='#M2.Factor'><p>Goodness-of-fit of factor copula models for mixed data</p></a></li>
<li><a href='#M2.StructuredFactor'><p>Goodness-of-fit of bi-factor and second-order copula models for item response data</p></a></li>
<li><a href='#mapping'>
<p>Mapping of Kendall's tau and copula parameter</p></a></li>
<li><a href='#mle.Factor'><p>Maximum likelhood estimation of factor copula models for mixed data</p></a></li>
<li><a href='#mle.FactorTree'><p>Maximum likelhood estimation of factor tree copula models</p></a></li>
<li><a href='#mle.StructuredFactor'><p>Maximum likelihood estimation of the bi-factor and second-order copula models for item response data</p></a></li>
<li><a href='#pbnorm'>
<p>Bivariate normal and Student cdfs with vectorized inputs</p></a></li>
<li><a href='#PE'>
<p>Political-economic risk of 62 countries for the year 1987</p></a></li>
<li><a href='#polychoric0'>
<p>Polychoric correlation</p></a></li>
<li><a href='#PTSD'>
<p>The Post-traumatic stress disorder (PTSD)</p></a></li>
<li><a href='#rfactor'><p>Simulation of factor copula models for mixed continuous and discrete data</p></a></li>
<li><a href='#rFactorTree'><p>Simulation of 1- and 2-factor tree copula models for item response data</p></a></li>
<li><a href='#rStructuredFactor'><p>Simulation of bi-factor and second-order copula models for item response data</p></a></li>
<li><a href='#Select.Factor'><p>Model selection of the factor copula models for mixed data</p></a></li>
<li><a href='#Select.FactorTree'><p>Model selection of the 1- and 2-factor tree copula models for item response data</p></a></li>
<li><a href='#Select.StructuredFactor'><p>Model selection of the bi-factor and second-order copula models for item response data</p></a></li>
<li><a href='#semicorr'>
<p>Diagnostics to detect tail dependence or tail asymmetry.</p></a></li>
<li><a href='#TAS'>
<p>Toronto Alexithymia Scale (TAS)</p></a></li>
<li><a href='#transformation'>
<p>Continuous/count to ordinal responses</p></a></li>
<li><a href='#Vuong.Factor'>
<p>Vuong's test for the comparison of factor  copula models</p></a></li>
<li><a href='#Vuong.FactorTree'>
<p>Vuong's test for the comparison of 1- and 2-factor tree copula models for item response data</p></a></li>
<li><a href='#Vuong.StructuredFactor'>
<p>Vuong's test for the comparison of bi-factor and second-order copula models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.9.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-03-4</td>
</tr>
<tr>
<td>Title:</td>
<td>Factor, Bi-Factor, Second-Order and Factor Tree Copula Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Sayed H. Kadhem [aut],
  Aristidis K. Nikoloulopoulos [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aristidis K. Nikoloulopoulos &lt;a.nikoloulopoulos@uea.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), statmod, abind, utils</td>
</tr>
<tr>
<td>Imports:</td>
<td>igraph, matlab, polycor, VineCopula</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation, model selection and goodness-of-fit of (1) factor copula models for mixed continuous and discrete data in Kadhem and Nikoloulopoulos (2021) &lt;<a href="https://doi.org/10.1111%2Fbmsp.12231">doi:10.1111/bmsp.12231</a>&gt;; (2) bi-factor and second-order copula models for item response data in Kadhem and Nikoloulopoulos (2023) &lt;<a href="https://doi.org/10.1007%2Fs11336-022-09894-2">doi:10.1007/s11336-022-09894-2</a>&gt;; (3) factor tree copula models for item response data in Kadhem and Nikoloulopoulos (2022) &lt;<a href="https://arxiv.org/abs/2201.00339">arXiv:2201.00339</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-04 11:03:27 UTC; aris</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-05 20:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='discrepancy'>
Diagnostics to detect a factor dependence structure 
</h2><span id='topic+discrepancy'></span>

<h3>Description</h3>

<p>The diagnostic method in Joe (2014, pages 245-246)  to show that each dataset has  a factor  structure based on linear factor analysis. The  correlation matrix <code class="reqn">\R_{\mathrm{observed}}</code>  has been obtained based on the sample correlations  from the bivariate pairs of the observed variables. 
These are the linear  (when both variables are continuous),  polychoric (when both variables are ordinal),  and polyserial (when one variable is continuous and the other is ordinal) sample correlations among the observed variables. 
The resulting <code class="reqn">\R_{\mathrm{observed}}</code>  is generally positive definite  if the sample size is not small enough; if not one has to convert it to positive definite. We calculate various measures of discrepancy between <code class="reqn">\R_{\mathrm{observed}}</code>  and <code class="reqn">\R_{\mathrm{model}}</code> (the resulting correlation matrix of linear factor analysis), such as  the maximum absolute correlation
difference <code class="reqn">D_1=\max|\R_{\mathrm{model}} - \R_{\mathrm{observed}}|</code>, the average absolute correlation
difference <code class="reqn">D_2=\mathrm{avg}| \R_{\mathrm{model}} - \R_{\mathrm{observed}}|</code>, and  the correlation matrix discrepancy measure <code class="reqn">D_3=\log\bigl( \det(\R_{\mathrm{model}}) \bigr) - \log\bigl( \det(\R_{\mathrm{observed}})\bigr) + \mathrm{tr}( \R^{-1}_{\mathrm{model}} \R_{\mathrm{observed}} ) - d</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discrepancy(cormat, n, f3)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discrepancy_+3A_cormat">cormat</code></td>
<td>
<p><code class="reqn">\R_{\mathrm{observed}}</code>.</p>
</td></tr>
<tr><td><code id="discrepancy_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="discrepancy_+3A_f3">f3</code></td>
<td>
<p>If TRUE, then the linear 3-factor analysis is fitted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the calculated discrepancy measures for different number of factors. 
</p>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Joe, H. (2014).
<em>Dependence Modelling with Copulas</em>. Chapman &amp; Hall, London.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2021)
Factor copula models for mixed data.
<em>British Journal of Mathematical and Statistical Psychology</em>, <b>74</b>, 365&ndash;403. <a href="https://doi.org/10.1111/bmsp.12231">doi:10.1111/bmsp.12231</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#------------------------------------------------
#                     PE Data
#------------------             -----------------
data(PE)
#correlation
continuous.PE1 &lt;- -PE[,1] 
continuous.PE &lt;- cbind(continuous.PE1, PE[,2])
u.PE &lt;- apply(continuous.PE, 2, rank)/(nrow(PE)+1)
z.PE &lt;- qnorm(u.PE)
categorical.PE &lt;- data.frame(apply(PE[, 3:5], 2, factor))
nPE &lt;- cbind(z.PE, categorical.PE)

#-------------------------------------------------
# Discrepancy measures----------------------------
#-------------------------------------------------
#correlation matrix for mixed data
cormat.PE &lt;- as.matrix(polycor::hetcor(nPE, std.err=FALSE))
#discrepancy measures
out.PE = discrepancy(cormat.PE, n = nrow(nPE), f3 = FALSE)

#------------------------------------------------
#------------------------------------------------
#                    GSS Data
#------------------             -----------------
data(GSS)
attach(GSS)
continuous.GSS &lt;- cbind(INCOME,AGE)
continuous.GSS &lt;- apply(continuous.GSS, 2, rank)/(nrow(GSS)+1)
z.GSS &lt;- qnorm(continuous.GSS)
ordinal.GSS &lt;- cbind(DEGREE,PINCOME,PDEGREE) 
count.GSS &lt;- cbind(CHILDREN,PCHILDREN)

# Transforming the count variables to ordinal
# count1 : CHILDREN
count1  = count.GSS[,1]
count1[count1 &gt; 3] = 3

# count2: PCHILDREN
count2  = count.GSS[,2]
count2[count2 &gt; 7] = 7

# Combining both transformed count variables
ncount.GSS = cbind(count1, count2)

# Combining ordinal and transformed count variables
categorical.GSS &lt;- cbind(ordinal.GSS, ncount.GSS)
categorical.GSS &lt;- data.frame(apply(categorical.GSS, 2, factor))

# combining continuous and categorical variables
nGSS = cbind(z.GSS, categorical.GSS)

#-------------------------------------------------
# Discrepancy measures----------------------------
#-------------------------------------------------
#correlation matrix for mixed data
cormat.GSS &lt;- as.matrix(polycor::hetcor(nGSS, std.err=FALSE))
#discrepancy measures
out.GSS = discrepancy(cormat.GSS, n = nrow(nGSS), f3 = TRUE)

</code></pre>

<hr>
<h2 id='FactorCopula-package'>Factor, bi-factor, second-order and factor tree copula models</h2><span id='topic+FactorCopula-package'></span>

<h3>Description</h3>

<p>Estimation, model selection and goodness-of-fit of (1) factor copula models for mixed continuous and discrete data in Kadhem and Nikoloulopoulos (2021); (2) bi-factor and second-order copula models for item response data in Kadhem and Nikoloulopoulos (2023); (3) factor tree copula models for item response data in Kadhem and Nikoloulopoulos (2022).
</p>


<h3>Details</h3>

<p>This package contains <span class="rlang"><b>R</b></span> functions for: 
</p>

<ul>
<li><p> diagnostics based on semi-correlations (Kadhem and Nikoloulopoulos, 2021, 2023; Joe, 2014) to detect tail dependence or tail asymmetry; 
</p>
</li>
<li><p> diagnostics  to show that a  dataset  has a factor structure based on linear factor analysis (Kadhem and Nikoloulopoulos, 2021,2023; Joe, 2014);
</p>
</li>
<li><p> estimation of the factor copula models in Krupskii and Joe (2013), Nikoloulopoulos and Joe (2015), and Kadhem and Nikoloulopoulos (2021);
</p>
</li>
<li><p> estimation of the bi-factor and second-order copula models for item response data in Kadhem and Nikoloulopoulos (2023);
</p>
</li>
<li><p> estimation of the factor tree copula models for item response data in Kadhem and Nikoloulopoulos (2022);
</p>
</li>
<li><p> model selection of the factor copula models in Krupskii and Joe (2013), Nikoloulopoulos and Joe (2015); 
</p>
</li>
<li><p> model selection of the bifactor and second-order copula models in  Kadhem and Nikoloulopoulos (2023);
</p>
</li>
<li><p> model selection of the factor tree copula models in  Kadhem and Nikoloulopoulos (2022);
</p>
</li>
<li><p> goodness-of-fit of the factor copula models in Krupskii and Joe (2013), Nikoloulopoulos and Joe (2015), and Kadhem and Nikoloulopoulos (2021) using the <code class="reqn">M_2</code> statistic (Maydeu-Olivares and Joe, 2006). Note that the continuous  and count data have to be transformed to ordinal;
</p>
</li>
<li><p>  goodness-of-fit of the bi-factor and second-order copula models in Kadhem and Nikoloulopoulos (2023) using the <code class="reqn">M_2</code> statistic (Maydeu-Olivares and Joe, 2006).  
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Sayed H. Kadhem <br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Joe, H. (2014).
<em>Dependence Modelling with Copulas</em>. Chapman &amp; Hall, London.
</p>
<p>Maydeu-Olivares, A. and Joe, H. (2006).
Limited information goodness-of-fit testing in multidimensional contingency tables.
<em>Psychometrika</em>, <b>71</b>, 713&ndash;732. <a href="https://doi.org/10.1007/s11336-005-1295-9">doi:10.1007/s11336-005-1295-9</a>.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2021)
Factor copula models for mixed data.
<em>British Journal of Mathematical and Statistical Psychology</em>, <b>74</b>, 365&ndash;403. <a href="https://doi.org/10.1111/bmsp.12231">doi:10.1111/bmsp.12231</a>.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2023)
Bi-factor and second-order copula models for item response data.
<em>Psychometrika</em>, <b>88</b>, 132&ndash;157. <a href="https://doi.org/10.1007/s11336-022-09894-2">doi:10.1007/s11336-022-09894-2</a>.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2022)
Factor tree copula models for item response data.
<em>Arxiv e-prints</em>, &lt;arXiv: 2201.00339&gt;. <a href="https://arxiv.org/abs/2201.00339">https://arxiv.org/abs/2201.00339</a>.
</p>
<p>Krupskii, P. and Joe, H. (2013)
Factor copula models for multivariate data.
<em>Journal of Multivariate Analysis</em>, <b>120</b>, 85&ndash;101. <a href="https://doi.org/10.1016/j.jmva.2013.05.001">doi:10.1016/j.jmva.2013.05.001</a>.
</p>
<p>Nikoloulopoulos, A.K. and Joe, H. (2015)
Factor copula models with item response data.
<em>Psychometrika</em>, <b>80</b>, 126&ndash;150. <a href="https://doi.org/10.1007/s11336-013-9387-4">doi:10.1007/s11336-013-9387-4</a>.
</p>

<hr>
<h2 id='GSS'>
The 1994 General Social Survey
</h2><span id='topic+GSS'></span>

<h3>Description</h3>

<p>Hoff (2007) analysed seven demographic variables of 464 male respondents to the 1994 General Social Survey. 
Of these seven, two were continuous (income and age of the respondents), three were ordinal with 5 categories (highest degree of the survey respondent, income and highest degree of  respondent's parents),  and two were count variables (number of children of the survey respondent and respondent's parents). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GSS)</code></pre>


<h3>Format</h3>

<p>A data frame with 464 observations on the following 7 variables:
</p>

<dl>
<dt><code>INCOME</code></dt><dd><p>Income of the respondent in 1000s of dollars, binned into 21 ordered categories.</p>
</dd>
<dt><code>DEGREE</code></dt><dd><p>Highest degree ever obtained (0:None, 1:HS, 2:Associates, 3:Bachelors, 4:Graduate).</p>
</dd>
<dt><code>CHILDREN</code></dt><dd><p>Number of children of the survey respondent.</p>
</dd>
<dt><code>PINCOME</code></dt><dd><p>Financial status of respondent's parents when respondent was 16 (on a 5-point scale).</p>
</dd>
<dt><code>PDEGREE</code></dt><dd><p>Highest degree of the survey respondent's parents (0:None, 1:HS, 2:Associates, 3:Bachelors, 4:Graduate).</p>
</dd>
<dt><code>PCHILDREN</code></dt><dd><p>Number of children of the survey respondent's parents - 1.</p>
</dd>
<dt><code>AGE</code></dt><dd><p>Age of the respondents in years.</p>
</dd>
</dl>
 


<h3>Source</h3>

<p>Hoff, P. D. (2007).
Extending the rank likelihood for semiparametric copula estimation.
<em>The Annals of Applied Statistics</em>, <b>1</b>, 265&ndash;283.
</p>

<hr>
<h2 id='M2.Factor'>Goodness-of-fit of factor copula models for mixed data</h2><span id='topic+M2.Factor'></span><span id='topic+M2.1F'></span><span id='topic+M2.2F'></span>

<h3>Description</h3>

<p> The limited information <code class="reqn">M_2</code> statistic (Maydeu-Olivares and Joe, 2006)  of factor copula models for mixed continuous and discrete data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>M2.1F(tcontinuous, ordinal, tcount, cpar, copF1, gl)
M2.2F(tcontinuous, ordinal, tcount, cpar, copF1, copF2, gl, SpC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="M2.Factor_+3A_tcontinuous">tcontinuous</code></td>
<td>
<p><code class="reqn">n \times d_1</code> matrix with the transformed continuous to ordinal reponse data, where <code class="reqn">n</code> and <code class="reqn">d_1</code> is the number of observations and transformed continous  variables, respectively.</p>
</td></tr>
<tr><td><code id="M2.Factor_+3A_ordinal">ordinal</code></td>
<td>
<p><code class="reqn">n \times d_2</code> matrix with the ordinal reponse data, where <code class="reqn">n</code> and <code class="reqn">d_2</code> is the number of observations and ordinal variables, respectively.</p>
</td></tr>
<tr><td><code id="M2.Factor_+3A_tcount">tcount</code></td>
<td>
<p><code class="reqn">n \times d_3</code> matrix with the transformed count to ordinal reponse data, where <code class="reqn">n</code> and <code class="reqn">d_3</code> is the number of observations and transformed count variables, respectively.</p>
</td></tr>
<tr><td><code id="M2.Factor_+3A_cpar">cpar</code></td>
<td>
<p>A list of estimated copula parameters.</p>
</td></tr>
<tr><td><code id="M2.Factor_+3A_copf1">copF1</code></td>
<td>
<p><code class="reqn">(d_1+d_2+d_3)</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the 1st factor. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel, &ldquo;joe&rdquo; for Joe, &ldquo;rjoe&rdquo; for reflected Joe, &ldquo;1rjoe&rdquo; for 1-reflected Joe, &ldquo;2rjoe&rdquo; for 2-reflected Joe, &ldquo;BB1&rdquo; for BB1, &ldquo;rBB1&rdquo; for reflected BB1, &ldquo;BB7&rdquo; for BB7, &ldquo;rBB7&rdquo; for reflected BB7,&ldquo;BB8&rdquo; for BB8, &ldquo;rBB8&rdquo; for reflected BB8, &ldquo;BB10&rdquo; for BB10, &ldquo;rBB10&rdquo; for reflected BB10.</p>
</td></tr>
<tr><td><code id="M2.Factor_+3A_copf2">copF2</code></td>
<td>
<p><code class="reqn">(d_1+d_2+d_3)</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the 2nd factor. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel, &ldquo;joe&rdquo; for Joe, &ldquo;rjoe&rdquo; for reflected Joe, &ldquo;1rjoe&rdquo; for 1-reflected Joe, &ldquo;2rjoe&rdquo; for 2-reflected Joe, &ldquo;BB1&rdquo; for BB1, &ldquo;rBB1&rdquo; for reflected BB1, &ldquo;BB7&rdquo; for BB7, &ldquo;rBB7&rdquo; for reflected BB7,&ldquo;BB8&rdquo; for BB8, &ldquo;rBB8&rdquo; for reflected BB8, &ldquo;BB10&rdquo; for BB10, &ldquo;rBB10&rdquo; for reflected BB10.</p>
</td></tr>
<tr><td><code id="M2.Factor_+3A_gl">gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td></tr>
<tr><td><code id="M2.Factor_+3A_spc">SpC</code></td>
<td>
<p>Special case for the 2-factor copula model with BVN copulas. Select a bivariate copula at the 2nd factor to be fixed to independence. e.g. &quot;SpC = 1&quot; to set the first copula at the 2nd factor to independence.  </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code class="reqn">M_2</code> statistic has been developed for goodness-of-fit testing in multidimensional contingency tables by Maydeu-Olivares and Joe (2006). 
Nikoloulopoulos and Joe (2015) have used the <code class="reqn">M_2</code> statistic to assess the goodness-of-fit of factor copula models for ordinal data. We build on the aforementioned papers and propose a methodology to assess the overall goodness-of-fit of factor copula models for mixed continuous and discrete responses. Since the <code class="reqn">M_2</code> statistic has been developed for multivariate ordinal data, we propose to first transform the continuous and count variables to ordinal and then calculate the <code class="reqn">M_2</code> statistic at the maximum likelihood estimate before transformation. 
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>M2</code></td>
<td>
<p>The <code class="reqn">M_2</code> statistic which has a null asymptotic distribution that is <code class="reqn">\chi^2</code> with <code class="reqn">s-q</code> degrees of freedom, where <code class="reqn">s</code> is the number of univariate and bivariate margins that do not include the category 0 and <code class="reqn">q</code> is the number of model parameters.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p><code class="reqn">s-q</code>.</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>The resultant <code class="reqn">p</code>-value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2021)
Factor copula models for mixed data.
<em>British Journal of Mathematical and Statistical Psychology</em>, <b>74</b>, 365&ndash;403. <a href="https://doi.org/10.1111/bmsp.12231">doi:10.1111/bmsp.12231</a>.
</p>
<p>Maydeu-Olivares, A. and Joe, H. (2006).
Limited information goodness-of-fit testing in multidimensional contingency tables.
<em>Psychometrika</em>, <b>71</b>, 713&ndash;732. <a href="https://doi.org/10.1007/s11336-005-1295-9">doi:10.1007/s11336-005-1295-9</a>.
</p>
<p>Nikoloulopoulos, A.K. and Joe, H. (2015)
Factor copula models with item response data.
<em>Psychometrika</em>, <b>80</b>, 126&ndash;150. <a href="https://doi.org/10.1007/s11336-013-9387-4">doi:10.1007/s11336-013-9387-4</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
# Setting quadreture points
nq &lt;- 25  
gl &lt;- gauss.quad.prob(nq) 
#------------------------------------------------
#                     PE Data
#------------------             -----------------
data(PE)
continuous.PE1 = -PE[,1]
continuous.PE2 = PE[,2]
continuous.PE &lt;- cbind(continuous.PE1, continuous.PE2)

categorical.PE &lt;- PE[, 3:5]
#------------------------------------------------
#                   Estimation
#------------------             -----------------
#------------------ One-factor  -----------------
# one-factor copula model
cop1f.PE &lt;- c("joe", "joe", "rjoe", "joe", "gum")
est1factor.PE &lt;- mle1factor(continuous.PE, categorical.PE, 
                            count=NULL, copF1=cop1f.PE, gl, hessian = TRUE)
#------------------------------------------------
#                       M2  
#------------------------------------------------
#Transforming the continuous to ordinal data:
ncontinuous.PE = continuous2ordinal(continuous.PE, 5)
# M2 statistic for the one-factor copula model:

m2.1f.PE &lt;- M2.1F(ncontinuous.PE, categorical.PE, tcount=NULL, 
                  cpar=est1factor.PE$cpar, copF1=cop1f.PE, gl)
                      

</code></pre>

<hr>
<h2 id='M2.StructuredFactor'>Goodness-of-fit of bi-factor and second-order copula models for item response data</h2><span id='topic+M2.StructuredFactor'></span><span id='topic+M2Bifactor'></span><span id='topic+M2Second_order'></span>

<h3>Description</h3>

<p> The limited information <code class="reqn">M_2</code> statistic (Maydeu-Olivares and Joe, 2006)  of bi-factor and second-order copula models for item response data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>M2Bifactor(y,cpar, copnames1, copnames2, gl, ngrp, grpsize)
M2Second_order(y,cpar, copnames1, copnames2, gl, ngrp, grpsize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="M2.StructuredFactor_+3A_y">y</code></td>
<td>
<p><code class="reqn">n \times d</code> matrix with the ordinal reponse data, where <code class="reqn">n</code> and <code class="reqn">d</code> is the number of observations and variables, respectively.</p>
</td></tr>
<tr><td><code id="M2.StructuredFactor_+3A_cpar">cpar</code></td>
<td>
<p>A list of estimated copula parameters.</p>
</td></tr>
<tr><td><code id="M2.StructuredFactor_+3A_copnames1">copnames1</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link each of the oberved variabels with the common factor. <b>For the second-order factor copula</b>: <code class="reqn">G</code>-vector with the names of bivariate copulas that link the each of the group-specific factors with the common factor, where <code class="reqn">G</code> is the number of groups of items. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{2, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
<tr><td><code id="M2.StructuredFactor_+3A_copnames2">copnames2</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. <b>For the second-order factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{2, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
<tr><td><code id="M2.StructuredFactor_+3A_gl">gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td></tr>
<tr><td><code id="M2.StructuredFactor_+3A_ngrp">ngrp</code></td>
<td>
<p>number of non-overlapping groups.</p>
</td></tr>
<tr><td><code id="M2.StructuredFactor_+3A_grpsize">grpsize</code></td>
<td>
<p>vector indicating the size for each group, e.g., c(4,4,4) indicating four items in all three groups.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code class="reqn">M_2</code> statistic has been developed for goodness-of-fit testing in multidimensional contingency tables by Maydeu-Olivares and Joe (2006). We use the <code class="reqn">M_2</code> to assess the overall fit for the bi-factor and second-order copula models for item resposne data (Kadhem &amp; Nikoloulopoulos, 2021).
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>M2</code></td>
<td>
<p>The <code class="reqn">M_2</code> statistic which has a null asymptotic distribution that is <code class="reqn">\chi^2</code> with <code class="reqn">s-q</code> degrees of freedom, where <code class="reqn">s</code> is the number of univariate and bivariate margins that do not include the category 0 and <code class="reqn">q</code> is the number of model parameters.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p><code class="reqn">s-q</code>.</p>
</td></tr>
<tr><td><code>p-value</code></td>
<td>
<p>The resultant <code class="reqn">p</code>-value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2023)
Bi-factor and second-order copula models for item response data.
<em>Psychometrika</em>, <b>88</b>, 132&ndash;157. <a href="https://doi.org/10.1007/s11336-022-09894-2">doi:10.1007/s11336-022-09894-2</a>.
</p>
<p>Maydeu-Olivares, A. and Joe, H. (2006).
Limited information goodness-of-fit testing in multidimensional contingency tables.
<em>Psychometrika</em>, <b>71</b>, 713&ndash;732. <a href="https://doi.org/10.1007/s11336-005-1295-9">doi:10.1007/s11336-005-1295-9</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
# Setting quadreture points
nq &lt;- 15
gl &lt;- gauss.quad.prob(nq)
#------------------------------------------------
#                     TAS Data
#------------------             -----------------
data(TAS)
#using a subset of the data
#group1: 1,3,6,7,9,13,14
grp1=c(1,3,6)
#group2: 2,4,11,12,17
grp2=c(2,4,11)
#group3: 5,8,10,15,16,18,19,20
grp3=c(5,8,10)
#Rearrange items within testlets
set.seed(123)
i=sample(1:nrow(TAS),500)
ydat=TAS[i,c(grp1,grp2,grp3)]

d=ncol(ydat);d
n=nrow(ydat);n

#size of each group
g1=length(grp1)
g2=length(grp2)
g3=length(grp3)

grpsize=c(g1,g2,g3)#group size
#number of groups
ngrp=length(grpsize)

#------------------------------------------------
#                       M2
#------------------------------------------------
#BI-FACTOR
tauX0 = c(0.49,0.16,0.29,#0.09,0.47,0.49,0.30,
          0.46,0.41,0.33,#0.29,0.24,
          0.10,0.16,0.14)#,0.12,0.03,0.03,0.10,0.10)
tauXg = c(0.09,0.37,0.23,#0.53,0.24,0.32,0.27,
          0.53,0.58,0.20,#0.23,0.25,0.34,0.33,
          0.30,0.19,0.24)#,0.29,0.43,0.26)
copX0 = rep("bvt2", d)
copXg = c(rep("rgum", g1), rep("bvt3", g2+g3))
#converting taus to cpars
cparX0=mapply(function(x,y) tau2par(x,y),x=copX0,y=tauX0)
cparXg=mapply(function(x,y) tau2par(x,y),x=copXg,y=tauXg)
cpar=c(cparX0,cparXg)

m2_Bifactor = M2Bifactor(y=ydat, cpar, copX0, copXg, gl, ngrp, grpsize)


</code></pre>

<hr>
<h2 id='mapping'>
Mapping of Kendall's tau and copula parameter
</h2><span id='topic+mapping'></span><span id='topic+par2tau'></span><span id='topic+tau2par'></span>

<h3>Description</h3>

<p>Bivariate copulas: mapping of Kendall's tau and copula parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>par2tau(copulaname, cpar)
tau2par(copulaname, tau)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mapping_+3A_copulaname">copulaname</code></td>
<td>
<p>Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel, &ldquo;joe&rdquo; for Joe, &ldquo;rjoe&rdquo; for reflected Joe, &ldquo;1rjoe&rdquo; for 1-reflected Joe, &ldquo;2rjoe&rdquo; for 2-reflected Joe, &ldquo;BB1&rdquo; for BB1, &ldquo;rBB1&rdquo; for reflected BB1, &ldquo;BB7&rdquo; for BB7, &ldquo;rBB7&rdquo; for reflected BB7, &ldquo;BB8&rdquo; for BB8, &ldquo;rBB8&rdquo; for reflected BB8, &ldquo;BB10&rdquo; for BB10, &ldquo;rBB10&rdquo; for reflected BB10.</p>
</td></tr>
<tr><td><code id="mapping_+3A_cpar">cpar</code></td>
<td>
<p>Copula parameter(s).</p>
</td></tr>
<tr><td><code id="mapping_+3A_tau">tau</code></td>
<td>
<p>Kendall's tau.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Kendall's tau or copula parameter. 
</p>


<h3>References</h3>

<p>Joe H (1997) <em>Multivariate Models and Dependence Concepts</em>. Chapman &amp; Hall, London.
</p>
<p>Joe H (2014) <em>Dependence Modeling with Copulas</em>. Chapman &amp; Hall, London.
</p>
<p>Joe H (2014) <em>CopulaModel:  Dependence Modeling with Copulas</em>. Software for book: <em>Dependence Modeling with Copulas</em>, Chapman &amp; Hall, London 2014.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# 1-param copulas
#BVN copula
cpar.bvn = tau2par("bvn", 0.5)
tau.bvn = par2tau("bvn", cpar.bvn)

#Frank copula
cpar.frk = tau2par("frk", 0.5)
tau.frk = par2tau("frk", cpar.frk)

#Gumbel copula
cpar.gum = tau2par("gum", 0.5)
tau.gum = par2tau("gum", cpar.gum)

#Joe copula
cpar.joe = tau2par("joe", 0.5)
tau.joe = par2tau("joe", cpar.joe)

# 2-param copulas
#BB1 copula
tau.bb1 = par2tau("bb1", c(0.5,1.5))

#BB7 copula
tau.bb7 = par2tau("bb7", c(1.5,1))

#BB8 copula
tau.bb8 = par2tau("bb8", c(3,0.8))

#BB10 copula
tau.bb10 = par2tau("bb10", c(3,0.8))


</code></pre>

<hr>
<h2 id='mle.Factor'>Maximum likelhood estimation of factor copula models for mixed data</h2><span id='topic+mle.Factor'></span><span id='topic+mle1factor'></span><span id='topic+mle2factor'></span><span id='topic+mle2factor.bvn'></span>

<h3>Description</h3>

<p>We use a two-stage etimation approach  toward the estimation  of  factor copula models for mixed continuous and discrete data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mle1factor(continuous, ordinal, count, copF1, gl, hessian, print.level)
mle2factor(continuous, ordinal, count, copF1, copF2, gl, hessian, print.level)
mle2factor.bvn(continuous, ordinal, count, copF1, copF2, gl, SpC, print.level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mle.Factor_+3A_continuous">continuous</code></td>
<td>
<p><code class="reqn">n \times d_1</code> matrix with the continuous reponse data, where <code class="reqn">n</code> and <code class="reqn">d_1</code> is the number of observations and continous  variables, respectively.</p>
</td></tr>
<tr><td><code id="mle.Factor_+3A_ordinal">ordinal</code></td>
<td>
<p><code class="reqn">n \times d_2</code> matrix with the ordinal reponse data, where <code class="reqn">n</code> and <code class="reqn">d_2</code> is the number of observations and ordinal variables, respectively.</p>
</td></tr>
<tr><td><code id="mle.Factor_+3A_count">count</code></td>
<td>
<p><code class="reqn">n \times d_3</code> matrix with the count reponse data, where <code class="reqn">n</code> and <code class="reqn">d_3</code> is the number of observations and count variables, respectively.</p>
</td></tr>
<tr><td><code id="mle.Factor_+3A_copf1">copF1</code></td>
<td>
<p><code class="reqn">(d_1+d_2+d_3)</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the 1st factor. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel, &ldquo;joe&rdquo; for Joe, &ldquo;rjoe&rdquo; for reflected Joe, &ldquo;1rjoe&rdquo; for 1-reflected Joe, &ldquo;2rjoe&rdquo; for 2-reflected Joe, &ldquo;BB1&rdquo; for BB1, &ldquo;rBB1&rdquo; for reflected BB1, &ldquo;BB7&rdquo; for BB7, &ldquo;rBB7&rdquo; for reflected BB7, &ldquo;BB8&rdquo; for BB8, &ldquo;rBB8&rdquo; for reflected BB8, &ldquo;BB10&rdquo; for BB10, &ldquo;rBB10&rdquo; for reflected BB10.</p>
</td></tr>
<tr><td><code id="mle.Factor_+3A_copf2">copF2</code></td>
<td>
<p><code class="reqn">(d_1+d_2+d_3)</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the 2nd factor. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel, &ldquo;joe&rdquo; for Joe, &ldquo;rjoe&rdquo; for reflected Joe, &ldquo;1rjoe&rdquo; for 1-reflected Joe, &ldquo;2rjoe&rdquo; for 2-reflected Joe, &ldquo;BB1&rdquo; for BB1, &ldquo;rBB1&rdquo; for reflected BB1, &ldquo;BB7&rdquo; for BB7, &ldquo;rBB7&rdquo; for reflected BB7, &ldquo;BB8&rdquo; for BB8, &ldquo;rBB8&rdquo; for reflected BB8, &ldquo;BB10&rdquo; for BB10, &ldquo;rBB10&rdquo; for reflected BB10.</p>
</td></tr>
<tr><td><code id="mle.Factor_+3A_gl">gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td></tr>
<tr><td><code id="mle.Factor_+3A_spc">SpC</code></td>
<td>
<p>Special case for the 2-factor copula model with BVN copulas. Select a bivariate copula at the 2nd factor to be fixed to independence. e.g. &quot;SpC = 1&quot; to set the first copula at the 2nd factor to independence.  </p>
</td></tr>
<tr><td><code id="mle.Factor_+3A_hessian">hessian</code></td>
<td>
<p>If TRUE, the hessian of the negative log-likelihood is calculated during the minimization process.</p>
</td></tr>
<tr><td><code id="mle.Factor_+3A_print.level">print.level</code></td>
<td>
<p>Determines the level of printing which is done during the minimization process; same as in <code>nlm</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation is achieved by maximizing  the joint log-likelihood 
over the copula parameters  with the univariate parameters/distributions fixed as estimated at the first step of the proposed two-step estimation approach. 
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>cutpoints</code></td>
<td>
<p>The estimated univariate cutpoints.</p>
</td></tr>
<tr><td><code>negbinest</code></td>
<td>
<p>The estimated univariate parametes for the count responses (fitting the negative binomial distribution).</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>The maximized joint log-likelihood.</p>
</td></tr>
<tr><td><code>cpar</code></td>
<td>
<p>Estimated copula parameters in a list form.</p>
</td></tr>
<tr><td><code>taus</code></td>
<td>
<p>The estimated copula parameters in Kendall's tau scale.</p>
</td></tr>
<tr><td><code>SEs</code></td>
<td>
<p>The SEs of the Kendall's tau estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2021)
Factor copula models for mixed data.
<em>British Journal of Mathematical and Statistical Psychology</em>, <b>74</b>, 365&ndash;403. <a href="https://doi.org/10.1111/bmsp.12231">doi:10.1111/bmsp.12231</a>.
</p>
<p>Krupskii, P. and Joe, H. (2013)
Factor copula models for multivariate data.
<em>Journal of Multivariate Analysis</em>, <b>120</b>, 85&ndash;101. <a href="https://doi.org/10.1016/j.jmva.2013.05.001">doi:10.1016/j.jmva.2013.05.001</a>.
</p>
<p>Nikoloulopoulos, A.K. and Joe, H. (2015)
Factor copula models with item response data.
<em>Psychometrika</em>, <b>80</b>, 126&ndash;150. <a href="https://doi.org/10.1007/s11336-013-9387-4">doi:10.1007/s11336-013-9387-4</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
# Setting quadreture points
nq &lt;- 25  
gl &lt;- gauss.quad.prob(nq) 
#------------------------------------------------
#                     PE Data
#------------------             -----------------
data(PE)
continuous.PE1 = -PE[,1]
continuous.PE2 = PE[,2]
continuous.PE &lt;- cbind(continuous.PE1, continuous.PE2)

categorical.PE &lt;- PE[, 3:5]
#------------------------------------------------
#                   Estimation
#------------------             -----------------
#------------------ One-factor  -----------------
# one-factor copula model
cop1f.PE &lt;- c("joe", "joe", "rjoe", "joe", "gum")
est1factor.PE &lt;- mle1factor(continuous.PE, categorical.PE, 
                            count=NULL, copF1=cop1f.PE, gl, hessian = TRUE)
est1factor.PE                    
#------------------------------------------------
#------------------------------------------------
#                     GSS Data
#------------------             -----------------
data(GSS)
attach(GSS)
continuous.GSS &lt;- cbind(INCOME, AGE)
ordinal.GSS &lt;- cbind(DEGREE, PINCOME, PDEGREE) 
count.GSS &lt;- cbind(CHILDREN, PCHILDREN)

#------------------------------------------------
#                   Estimation
#------------------             -----------------
#------------------ One-factor  -----------------
# one-factor copula model
cop1f.GSS &lt;- c("joe","2rjoe","bvt3","bvt3",
          "rgum","2rjoe","2rgum")
est1factor.GSS &lt;- mle1factor(continuous.GSS, ordinal.GSS, 
                        count.GSS, copF1 = cop1f.GSS, gl, hessian = TRUE)

     

</code></pre>

<hr>
<h2 id='mle.FactorTree'>Maximum likelhood estimation of factor tree copula models</h2><span id='topic+mle.FactorTree'></span><span id='topic+mle1FactorTree'></span><span id='topic+mle2FactorTree'></span>

<h3>Description</h3>

<p>We use a two-stage estimation approach  toward the estimation  of  factor tree copula models for item response data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mle1FactorTree(y, A, cop, gl, hessian, print.level) 
mle2FactorTree(y, A, cop, gl, hessian, print.level) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mle.FactorTree_+3A_y">y</code></td>
<td>
<p><code class="reqn">n \times d</code> matrix with the ordinal reponse data, where <code class="reqn">n</code> and <code class="reqn">d</code> is the number of observations and ordinal variables, respectively.</p>
</td></tr>
<tr><td><code id="mle.FactorTree_+3A_a">A</code></td>
<td>
<p><code class="reqn">d \times d</code> vine array with <code class="reqn">1,...,d</code> on diagonal, note only the first row and diagnoal values are used for the 1-truncated vine model</p>
</td></tr> 
<tr><td><code id="mle.FactorTree_+3A_cop">cop</code></td>
<td>
<p><code class="reqn">(2d-1)</code>-vector with the names of bivariate copulas that link each of the oberved variabels with the 1st factor (1-factor part of the model), and conditional dependence of variables given the latent factor (1-truncated vine tree part of the model) . Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
<tr><td><code id="mle.FactorTree_+3A_gl">gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td></tr>
<tr><td><code id="mle.FactorTree_+3A_hessian">hessian</code></td>
<td>
<p>If TRUE, the hessian of the negative log-likelihood is calculated during the minimization process.</p>
</td></tr>
<tr><td><code id="mle.FactorTree_+3A_print.level">print.level</code></td>
<td>
<p>Determines the level of printing which is done during the minimization process; same as in <code>nlm</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation is achieved by maximizing  the joint log-likelihood 
over the copula parameters  with the univariate cutpoints fixed as estimated at the first step of the proposed two-step estimation approach. 
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>cutpoints</code></td>
<td>
<p>The estimated univariate cutpoints.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>The maximized joint log-likelihood.</p>
</td></tr>
<tr><td><code>taus</code></td>
<td>
<p>The estimated copula parameters in Kendall's tau scale.</p>
</td></tr>
<tr><td><code>SEs</code></td>
<td>
<p>The SEs of the Kendall's tau estimates.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Joe, H. (2014).
<em>Dependence Modelling with Copulas</em>. Chapman &amp; Hall, London.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2022b)
Factor tree copula models for item response data.
<em>Arxiv e-prints</em>, &lt;arXiv: 2201.00339&gt;. <a href="https://arxiv.org/abs/2201.00339">https://arxiv.org/abs/2201.00339</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
# Setting quadreture points
nq &lt;- 5  
gl &lt;- gauss.quad.prob(nq) 
#------------------------------------------------
#                    PTSD Data
#------------------             -----------------
data(PTSD)
ydat=PTSD
n=nrow(ydat)
d=ncol(ydat)
#------------------------------------------------
#                   Estimation
#------------------             -----------------
#selecting vine tree based on polychoric
rmat=polychoric0(ydat)$p
A.polychoric=selectFactorTrVine(y=ydat,rmat,alg=3)

#---------------- 1-factor tree  ----------------
# 1-factor tree copula model
copf1 &lt;- rep("frk",d)
coptree &lt;- rep("frk",d-1)
cop &lt;- c(copf1,coptree)
est1factortree &lt;- mle1FactorTree(y=ydat, A=A.polychoric$VineTreeA, cop, 
gl, hessian=FALSE, print.level=2) 

#---------------- 2-factor tree  ----------------
# 2-factor tree copula model
copf1 &lt;- rep("frk",d)
copf2 &lt;- rep("frk",d)
coptree &lt;- rep("frk",d-1)
cop &lt;- c(copf1,copf2,coptree)

est2factortree &lt;- mle2FactorTree(y=ydat, A=A.polychoric$VineTreeA, 
cop, gl, hessian=FALSE, print.level=2)
     

</code></pre>

<hr>
<h2 id='mle.StructuredFactor'>Maximum likelihood estimation of the bi-factor and second-order copula models for item response data</h2><span id='topic+mle.StructuredFactor'></span><span id='topic+mleBifactor'></span><span id='topic+mleSecond_order'></span>

<h3>Description</h3>

<p>We approach the estimation  of the bi-factor and second-order copula models for item response data with the IFM method of Joe (2005).</p>


<h3>Usage</h3>

<pre><code class='language-R'>mleBifactor(y, copnames1, copnames2, gl, ngrp, grpsize,
hessian, print.level)
mleSecond_order(y, copnames1, copnames2, gl, ngrp, grpsize,
hessian, print.level)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mle.StructuredFactor_+3A_y">y</code></td>
<td>
<p><code class="reqn">n \times d</code> matrix with the item reponse data, where <code class="reqn">n</code> and <code class="reqn">d</code> is the number of observations and variables, respectively.</p>
</td></tr>
<tr><td><code id="mle.StructuredFactor_+3A_copnames1">copnames1</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the common factor. <b>For the second-order factor copula</b>: <code class="reqn">G</code>-vector with the names of bivariate copulas that link the each of the group-specific factors with the common factor, where <code class="reqn">G</code> is the number of groups of items. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
<tr><td><code id="mle.StructuredFactor_+3A_copnames2">copnames2</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. <b>For the second-order factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
<tr><td><code id="mle.StructuredFactor_+3A_gl">gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td></tr>
<tr><td><code id="mle.StructuredFactor_+3A_ngrp">ngrp</code></td>
<td>
<p>number of non-overlapping groups.</p>
</td></tr>
<tr><td><code id="mle.StructuredFactor_+3A_grpsize">grpsize</code></td>
<td>
<p>vector indicating the size for each group, e.g., c(4,4,4) indicating four items in all three groups.</p>
</td></tr>
<tr><td><code id="mle.StructuredFactor_+3A_hessian">hessian</code></td>
<td>
<p>If TRUE, the hessian of the negative log-likelihood is calculated during the minimization process.</p>
</td></tr>
<tr><td><code id="mle.StructuredFactor_+3A_print.level">print.level</code></td>
<td>
<p>Determines the level of printing which is done during the minimization process; same as in <code>nlm</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation is achieved by maximizing  the joint log-likelihood
over the copula parameters  with the univariate cutpoints fixed as estimated at the first step of the proposed two-step estimation approach.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>cutpoints</code></td>
<td>
<p>The estimated univariate cutpoints.</p>
</td></tr>
<tr><td><code>taus</code></td>
<td>
<p>The estimated copula parameters in Kendall's tau scale.</p>
</td></tr>
<tr><td><code>SEs</code></td>
<td>
<p>The SEs of the Kendall's tau estimates.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>The maximized joint log-likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Joe, H. (2005)
Asymptotic efficiency of the two-stage estimation method for copula-based models.
<em>Journal of Multivariate Analysis</em>, <b>94</b>, 401&ndash;419.
<a href="https://doi.org/10.1016/j.jmva.2004.06.003">doi:10.1016/j.jmva.2004.06.003</a>.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2023)
Bi-factor and second-order copula models for item response data.
<em>Psychometrika</em>, <b>88</b>, 132&ndash;157. <a href="https://doi.org/10.1007/s11336-022-09894-2">doi:10.1007/s11336-022-09894-2</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
# Setting quadreture points
nq &lt;- 25
gl &lt;- gauss.quad.prob(nq)
#------------------------------------------------
#                     TAS Data
#------------------             -----------------
data(TAS)
#using a subset of the data
#group1: 1,3,6,7,9,13,14
grp1=c(1,3,6)
#group2: 2,4,11,12,17
grp2=c(2,4,11)
#group3: 5,8,10,15,16,18,19,20
grp3=c(5,8,10)
#Rearrange items within testlets
set.seed(123)
i=sample(1:nrow(TAS),500)
ydat=TAS[i,c(grp1,grp2,grp3)]

d=ncol(ydat);d
n=nrow(ydat);n

#size of each group
g1=length(grp1)
g2=length(grp2)
g3=length(grp3)

grpsize=c(g1,g2,g3)#group size
#number of groups
ngrp=length(grpsize)

#BI-FACTOR
copX0 = rep("bvt2", d)
copXg = c(rep("rgum", g1), rep("bvt3", g2+g3))
mle_Bifactor =  mleBifactor(y = ydat, copX0, copXg, gl, ngrp, grpsize, hessian=FALSE, print.level=2)


</code></pre>

<hr>
<h2 id='pbnorm'>
Bivariate normal and Student cdfs with vectorized inputs  
</h2><span id='topic+pbnorm'></span><span id='topic+pbvt'></span>

<h3>Description</h3>

<p>Bivariate normal and Student cdfs with vectorized inputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pbnorm(z1,z2,rho,icheck=FALSE)
pbvt(z1,z2,param,icheck=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pbnorm_+3A_z1">z1</code></td>
<td>
<p>scalar or vector of reals </p>
</td></tr>
<tr><td><code id="pbnorm_+3A_z2">z2</code></td>
<td>
<p>scalar or vector of reals </p>
</td></tr>
<tr><td><code id="pbnorm_+3A_rho">rho</code></td>
<td>
<p>scalar or vector parameter in (-1,1);
vectors cannot have different lengths if larger than 1, each of z1,z2,rho
either has length 1 or a constant n greater than 1 </p>
</td></tr>
<tr><td><code id="pbnorm_+3A_param">param</code></td>
<td>
<p>vector of length 2, or matrix with 2 columns;
vectors and number of rows of matrix cannot be different if larger than 1;
for param, first column is rho, second column is df.</p>
</td></tr>
<tr><td><code id="pbnorm_+3A_icheck">icheck</code></td>
<td>
<p>T if checks are made for proper inputs, default of F</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Donnelly's code can be inaccurate in the tail when the tail
probability is 2.e-9 or less (it sometimes returns 0).
In the case the exchmvn code is used with dimension 2.
Alternatively a user can use vectorized function pbivnorm() in the library 
pbivnorm, and write a function pbvncop based on it.
</p>


<h3>Value</h3>

<p>cdf value(s)
</p>


<h3>References</h3>

<p>Donnelly TG (1973). Algorithm 462: bivariate normal distribution, 
Communications of the Association for Computing Machinery, 16, 638;
</p>
<p>Joe H (2014) <em>Dependence Modeling with Copulas</em>. Chapman &amp; Hall/CRC.
</p>
<p>Joe H (2014) <em>CopulaModel:  Dependence Modeling with Copulas</em>. Software for book: <em>Dependence Modeling with Copulas</em>, Chapman &amp; Hall/CRC, 2014.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cat("\n pbnorm rho changing\n")
z1=.3; z2=.4; rho=seq(-1,1,.1)
out1=pbnorm(z1,z2,rho)
print(cbind(rho,out1))

cat("\n pbnorm matrix inputs for z1, z2\n")
rho=.4
z1=c(-.5,.5,10.)
z2=c(-.4,.6,10.)
z1=matrix(z1,3,3)
z2=matrix(z2,3,3,byrow=TRUE)
out3=pbnorm(z1,z2,rho)
print(out3)
cdf2=rbind(rep(0,3),out3)
cdf2=cbind(rep(0,4),cdf2)
pmf=apply(cdf2,2,diff)
pmf2=apply(t(pmf),2,diff)
pmf2=t(pmf2)  # rectangle probabilities
print(pmf2)

cat("\n pbvt rho changing\n")
z1=.3; z2=.4; rho=seq(-.9,.9,.1); nu=2
param=cbind(rho,rep(nu,length(rho)))
out1=pbvt(z1,z2,param)
print(cbind(rho,out1))
cat("\n pbvt z1 changing\n")
z1=seq(-2,2,.4)
z2=.4; rho=.5; nu=2
out2=pbvt(z1,z2,c(rho,nu))
print(cbind(z1,out2))
</code></pre>

<hr>
<h2 id='PE'>
Political-economic risk of 62 countries for the year 1987
</h2><span id='topic+PE'></span>

<h3>Description</h3>

<p>Quinn (2004) used 5 mixed variables, namely the continuous variable black-market premium in each country (used as a proxy for illegal economic activity), the continuous variable productivity as measured by real gross domestic product per worker in 1985 international prices, the binary variable independence of the national judiciary (1 if the judiciary is judged to be independent and 0 otherwise), and the ordinal variables measuring the lack of expropriation risk and lack of corruption.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PE)</code></pre>


<h3>Format</h3>

<p>A data frame with 62 observations (countries) on the following 5 variables:
</p>

<dl>
<dt><code>BM</code></dt><dd><p>Black-market premium.</p>
</dd>
<dt><code>GDP</code></dt><dd><p>Gross domestic product.</p>
</dd>
<dt><code>IJ</code></dt><dd><p>Independent judiciary.</p>
</dd>
<dt><code>XPR</code></dt><dd><p>Lack of expropriation risk.</p>
</dd>
<dt><code>CPR</code></dt><dd><p>Lack of corruption.</p>
</dd>
</dl>
 


<h3>Source</h3>

<p>Quinn, K. M. (2004). 
Bayesian factor analysis for mixed ordinal and continuous responses. 
<em>Political Analysis</em>, <b>12</b>, 338&ndash;353.
</p>

<hr>
<h2 id='polychoric0'>
Polychoric correlation
</h2><span id='topic+polychoric0'></span>

<h3>Description</h3>

<p>Polychoric correlation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polychoric0(odat,iprint=FALSE,prlevel=0)    
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polychoric0_+3A_odat">odat</code></td>
<td>
<p>nxd matrix of ordinal responses in 0,...,(ncat-1) or 1,...,ncat</p>
</td></tr>
<tr><td><code id="polychoric0_+3A_iprint">iprint</code></td>
<td>
<p>flag for printing of intermediate results, including
bivariate tables for observed versus expected assuming discretized
bivariate Gaussian</p>
</td></tr>
<tr><td><code id="polychoric0_+3A_prlevel">prlevel</code></td>
<td>
<p>print.level for nlm for numerical optimization</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Polychoric correlation for ordinal random variables. The number of categories can vary. 
</p>


<h3>Value</h3>

<p>$polych is
a polychoric correlation matrix  based on two-stage estimate;
$iposdef is an indicator if the 2-stage correlation matrix estimate
is positive definite. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PTSD)
ydat=PTSD
rmat=polychoric0(ydat)$p
</code></pre>

<hr>
<h2 id='PTSD'>
The Post-traumatic stress disorder (PTSD)
</h2><span id='topic+PTSD'></span>

<h3>Description</h3>

<p>The measure consists of 20 categorical items divided into four domains: (1) intrusions (e.g., repeated, dis- turbing, and unwanted memories), (2) avoidance (e.g., avoiding external reminder of the stressful experience), (3) cognition and mood alterations (e.g., trouble remembering important parts of the stressful experience) and (4) reactivity alterations (e.g., taking too many risks or doing things that could cause you harm). Each item is answered in a five-point ordinal scale: &ldquo;0 = Not at all&rdquo;, &ldquo;1 = A little bit&rdquo;, &ldquo;2 = Moderately&rdquo;, &ldquo;3 = Quite a bit&rdquo;, and &ldquo;4 = Extremely&rdquo;. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PTSD)</code></pre>


<h3>Format</h3>

<p>A data frame with 221 observations and  20 items.
</p>


<h3>Source</h3>

<p>Williams, D. and Mulder, J. (2020).
<em>BGGM: Bayesian Gaussian Graphical Models</em>.
R package version 1.0.0.
</p>

<hr>
<h2 id='rfactor'>Simulation of factor copula models for mixed continuous and discrete data</h2><span id='topic+rfactor'></span><span id='topic+r1factor'></span><span id='topic+r2factor'></span>

<h3>Description</h3>

<p>Simulating standard uniform and ordinal response data from factor copula models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>r1factor(n, d1, d2, categ, theta, copF1)
r2factor(n, d1, d2, categ, theta, delta, copF1, copF2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rfactor_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="rfactor_+3A_d1">d1</code></td>
<td>
<p>Number of standard uniform variables.</p>
</td></tr>
<tr><td><code id="rfactor_+3A_d2">d2</code></td>
<td>
<p>Number of ordinal variables.</p>
</td></tr>
<tr><td><code id="rfactor_+3A_categ">categ</code></td>
<td>
<p>A vector of categories for the ordinal variables.</p>
</td></tr>
<tr><td><code id="rfactor_+3A_theta">theta</code></td>
<td>
<p>Copula parameters for the 1st factor.</p>
</td></tr>
<tr><td><code id="rfactor_+3A_delta">delta</code></td>
<td>
<p>Copula parameters for the 2nd factor.</p>
</td></tr>
<tr><td><code id="rfactor_+3A_copf1">copF1</code></td>
<td>
<p><code class="reqn">(d_1+d_2)</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the 1st factor. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel, &ldquo;joe&rdquo; for Joe, &ldquo;rjoe&rdquo; for reflected Joe, &ldquo;1rjoe&rdquo; for 1-reflected Joe, &ldquo;2rjoe&rdquo; for 2-reflected Joe, &ldquo;BB1&rdquo; for BB1, &ldquo;rBB1&rdquo; for reflected BB1, &ldquo;BB7&rdquo; for BB7, &ldquo;rBB7&rdquo; for reflected BB7, &ldquo;BB8&rdquo; for BB8, &ldquo;rBB8&rdquo; for reflected BB8, &ldquo;BB10&rdquo; for BB10, &ldquo;rBB10&rdquo; for reflected BB10.</p>
</td></tr>
<tr><td><code id="rfactor_+3A_copf2">copF2</code></td>
<td>
<p><code class="reqn">(d_1+d_2)</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the 2nd factor. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt[<code class="reqn">\nu</code>]&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel, &ldquo;joe&rdquo; for Joe, &ldquo;rjoe&rdquo; for reflected Joe, &ldquo;1rjoe&rdquo; for 1-reflected Joe, &ldquo;2rjoe&rdquo; for 2-reflected Joe, &ldquo;BB1&rdquo; for BB1, &ldquo;rBB1&rdquo; for reflected BB1, &ldquo;BB7&rdquo; for BB7, &ldquo;rBB7&rdquo; for reflected BB7, &ldquo;BB8&rdquo; for BB8, &ldquo;rBB8&rdquo; for reflected BB8, &ldquo;BB10&rdquo; for BB10, &ldquo;rBB10&rdquo; for reflected BB10.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data matrix of dimension <code class="reqn">n\times d</code>, where <code class="reqn">n</code> is the sample size, and <code class="reqn">d=d_1+d_2</code> is the total number of variables.
</p>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2021)
Factor copula models for mixed data.
<em>British Journal of Mathematical and Statistical Psychology</em>, <b>74</b>, 365&ndash;403. <a href="https://doi.org/10.1111/bmsp.12231">doi:10.1111/bmsp.12231</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# ---------------------------------------------------
# ---------------------------------------------------
#              One-factor copula model
# ---------------------------------------------------
# ---------------------------------------------------
#Sample size ----------------------------------------
n = 100

#Continuous Variables  ------------------------------
d1 = 5

#Ordinal Variables  ---------------------------------
d2 = 3

#Categories for ordinal  ----------------------------
categ = c(3,4,5)

#Copula parameters  ---------------------------------
theta = rep(2, d1+d2)

#Copula names  --------------------------------------
copnamesF1 = rep("gum", d1+d2)

#----------------- Simulating data ------------------
datF1 = r1factor(n, d1=d1, d2=d2, categ, theta, copnamesF1)

#------------  Plotting continuous data -------------
pairs(qnorm(datF1[, 1:d1]))

# ---------------------------------------------------
# ---------------------------------------------------
#              Two-factor copula model
# ---------------------------------------------------
# ---------------------------------------------------
#Sample size ----------------------------------------
n = 100

#Continuous Variables  ------------------------------
d1 = 5

#Ordinal Variables  ---------------------------------
d2 = 3

#Categories for ordinal  ----------------------------
categ = c(3,4,5)

#Copula parameters  ---------------------------------
theta = rep(2.5, d1+d2)
delta = rep(1.5, d1+d2)

#Copula names  --------------------------------------
copnamesF1 = rep("gum", d1+d2)
copnamesF2 = rep("gum", d1+d2)

#----------------- Simulating data ------------------
datF2 = r2factor(n, d1=d1, d2=d2, categ, theta, delta, 
                copnamesF1, copnamesF2)

#-----------------  Plotting  data ------------------
pairs(qnorm(datF2[,1:d1]))


</code></pre>

<hr>
<h2 id='rFactorTree'>Simulation of 1- and 2-factor tree copula models for item response data</h2><span id='topic+rFactorTree'></span><span id='topic+r1factortree'></span><span id='topic+r2factortree'></span>

<h3>Description</h3>

<p>Simulating item response data from the 1- and 2-factor tree copula models.</p>


<h3>Usage</h3>

<pre><code class='language-R'>r1factortree(n, d, A, copname1, copnametree, theta1, delta,K)
r2factortree(n, d, A, copname1, copname2, copnametree,theta1, theta2, delta,K)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rFactorTree_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="rFactorTree_+3A_d">d</code></td>
<td>
<p>Number of observed variables/items.</p>
</td></tr>
<tr><td><code id="rFactorTree_+3A_a">A</code></td>
<td>
<p><code class="reqn">d \times d</code> vine array with <code class="reqn">1,...,d</code> on diagonal, note only the first row and diagnoal values are used for the 1-truncated vine model</p>
</td></tr> 
<tr><td><code id="rFactorTree_+3A_theta1">theta1</code></td>
<td>
<p>copula parameter vector of size <code class="reqn">d</code> for items with the first factor.</p>
</td></tr>
<tr><td><code id="rFactorTree_+3A_theta2">theta2</code></td>
<td>
<p>copula parameter vector of size <code class="reqn">d</code> for items with the second factor.</p>
</td></tr>
<tr><td><code id="rFactorTree_+3A_delta">delta</code></td>
<td>
<p>copula parameter vector of size <code class="reqn">d-1</code> for the 1-truncated vine tree (conditional dependence).</p>
</td></tr>
<tr><td><code id="rFactorTree_+3A_copname1">copname1</code></td>
<td>
<p>A name of a bivariate copula that link each of the oberved variabels with the first factor (note only a single copula family for all items with the factor). Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
<tr><td><code id="rFactorTree_+3A_copname2">copname2</code></td>
<td>
<p>A name of a bivariate copula that link each of the oberved variabels with the second factor (note only a single copula family for all items with the factor). Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
<tr><td><code id="rFactorTree_+3A_copnametree">copnametree</code></td>
<td>
<p>A name of a bivariate copula that link each of the oberved variabels with one another given the factors in the 1-truncated vine (note only a single copula family for all tree). Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
<tr><td><code id="rFactorTree_+3A_k">K</code></td>
<td>
<p>Number of categories for the observed variables/items.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data matrix of dimension <code class="reqn">n \times d</code>, where <code class="reqn">n</code> is the sample size, and <code class="reqn">d</code> is the total number of observed variables/items.
</p>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Joe, H. (2014).
<em>Dependence Modelling with Copulas</em>. Chapman &amp; Hall, London.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2022b)
Factor tree copula models for item response data.
<em>Arxiv e-prints</em>, &lt;arXiv: 2201.00339&gt;. <a href="https://arxiv.org/abs/2201.00339">https://arxiv.org/abs/2201.00339</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ---------------------------------------------------
# ---------------------------------------------------
#Sample size
n = 500

#Ordinal Variables  ---------------------------------
d = 5

#Categories for ordinal  ----------------------------
K = 5
# ---------------------------------------------------
#              1-2-factor tree copula model
# ---------------------------------------------------
#Copula parameters
theta1 = rep(3, d)
theta2 = rep(2, d)
delta = rep(1.5, d-1)

#Copula names
copulaname_1f = "gum"
copulaname_2f = "gum"
copulaname_vine = "gum"

#vine array
#Dvine
d=5
A=matrix(0,d,d)
A[1,]=c(1,c(1:(d-1)))
diag(A)=1:d



#----------------- Simulating data ------------------
#1-factor tree copula
data_1ft = r1factortree(n, d, A, copulaname_1f, copulaname_vine, 
theta1, delta,K)
#2-factor tree copula
data_2ft = r2factortree(n, d, A, copulaname_1f, copulaname_2f, 
copulaname_vine, theta1,theta2, delta,K)
</code></pre>

<hr>
<h2 id='rStructuredFactor'>Simulation of bi-factor and second-order copula models for item response data</h2><span id='topic+rStructuredFactor'></span><span id='topic+rBifactor'></span><span id='topic+rSecond_order'></span>

<h3>Description</h3>

<p>Simulating item response data from the bi-factor and second-order copula models for item response data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>rBifactor(n, d, grpsize, categ, copnames1,copnames2, theta1, theta2)
rSecond_order(n, d, grpsize, categ, copnames1, copnames2, theta1, theta2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rStructuredFactor_+3A_n">n</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="rStructuredFactor_+3A_d">d</code></td>
<td>
<p>Number of observed variables/items.</p>
</td></tr>
<tr><td><code id="rStructuredFactor_+3A_grpsize">grpsize</code></td>
<td>
<p>vector indicating the size for each group, e.g., c(4,4,4) indicating four items in all three groups.</p>
</td></tr>
<tr><td><code id="rStructuredFactor_+3A_categ">categ</code></td>
<td>
<p>A vector of categories for the observed variables/items.</p>
</td></tr>
<tr><td><code id="rStructuredFactor_+3A_theta1">theta1</code></td>
<td>
<p><b>For the bi-factor model</b>: copula parameter vector of size <code class="reqn">d</code> for items with the common factor. <b>For the second-order copulas</b>: copula parameter vector of size <code class="reqn">G</code> for the common factor and group-specific factors.</p>
</td></tr>
<tr><td><code id="rStructuredFactor_+3A_theta2">theta2</code></td>
<td>
<p><b>For the bi-factor model</b>: copula parameter vector of size <code class="reqn">d</code> for items with the group-specific factor. <b>For the second-order copulas</b>: copula parameter vector of size <code class="reqn">d</code> for items with the group-specific factor. </p>
</td></tr>
<tr><td><code id="rStructuredFactor_+3A_copnames1">copnames1</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the common factor. <b>For the second-order factor copula</b>: <code class="reqn">G</code>-vector with the names of bivariate copulas that link the each of the group-specific factors with the common factor, where <code class="reqn">G</code> is the number of groups of items. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
<tr><td><code id="rStructuredFactor_+3A_copnames2">copnames2</code></td>
<td>
<p><b>For the bi-factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. <b>For the second-order factor copula</b>: <code class="reqn">d</code>-vector with the names of bivariate copulas that link the each of the oberved variabels with the group-specific factor. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data matrix of dimension <code class="reqn">n\times d</code>, where <code class="reqn">n</code> is the sample size, and <code class="reqn">d</code> is the total number of observed variables/items.
</p>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2023)
Bi-factor and second-order copula models for item response data.
<em>Psychometrika</em>, <b>88</b>, 132&ndash;157. <a href="https://doi.org/10.1007/s11336-022-09894-2">doi:10.1007/s11336-022-09894-2</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ---------------------------------------------------
# ---------------------------------------------------
#Sample size
n = 500

#Ordinal Variables  ---------------------------------
d = 9
grpsize=c(3,3,3)
ngrp=length(grpsize)

#Categories for ordinal  ----------------------------
categ = rep(3,d)

# ---------------------------------------------------
# ---------------------------------------------------
#              Bi-factor copula model
# ---------------------------------------------------
# ---------------------------------------------------
#Copula parameters
theta = rep(2.5, d)
delta = rep(1.5, d)

#Copula names
copulanames1 = rep("gum", d)
copulanames2 = rep("gum", d)

#----------------- Simulating data ------------------
data_Bifactor = rBifactor(n, d, grpsize, categ, copulanames1,
copulanames2, theta, delta)

# ---------------------------------------------------
# ---------------------------------------------------
#              Second-order copula model
# ---------------------------------------------------
# ---------------------------------------------------
#Copula parameters
theta= rep(1.5, ngrp)
delta = rep(2.5, d)

#Copula names
copulanames1 = rep("gum", ngrp)
copulanames2 = rep("gum", d)

data_Second_order = rSecond_order(n, d, grpsize, categ,
copulanames1, copulanames2, theta, delta)
</code></pre>

<hr>
<h2 id='Select.Factor'>Model selection of the factor copula models for mixed data</h2><span id='topic+Select.Factor'></span><span id='topic+select1F'></span><span id='topic+select2F'></span>

<h3>Description</h3>

<p>A heuristic algorithm that automatically selects the bivariate parametric copula families that link the observed to the latent variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>select1F(continuous, ordinal, count, copnamesF1, gl)
select2F(continuous, ordinal, count, copnamesF1, copnamesF2, gl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Select.Factor_+3A_continuous">continuous</code></td>
<td>
<p><code class="reqn">n \times d_1</code> matrix with the continuous reponse data, where <code class="reqn">n</code> and <code class="reqn">d_1</code> is the number of observations and continous  variables, respectively.</p>
</td></tr>
<tr><td><code id="Select.Factor_+3A_ordinal">ordinal</code></td>
<td>
<p><code class="reqn">n \times d_2</code> matrix with the ordinal reponse data, where <code class="reqn">n</code> and <code class="reqn">d_2</code> is the number of observations and ordinal variables, respectively.</p>
</td></tr>
<tr><td><code id="Select.Factor_+3A_count">count</code></td>
<td>
<p><code class="reqn">n \times d_3</code> matrix with the count reponse data, where <code class="reqn">n</code> and <code class="reqn">d_3</code> is the number of observations and count variables, respectively.</p>
</td></tr>
<tr><td><code id="Select.Factor_+3A_copnamesf1">copnamesF1</code></td>
<td>
<p>A vector with the names of possible candidates of bivariate copulas that link the each of the oberved variabels with the 1st factor. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel, &ldquo;joe&rdquo; for Joe, &ldquo;rjoe&rdquo; for reflected Joe, &ldquo;1rjoe&rdquo; for 1-reflected Joe, &ldquo;2rjoe&rdquo; for 2-reflected Joe, &ldquo;BB1&rdquo; for BB1, &ldquo;rBB1&rdquo; for reflected BB1, &ldquo;BB7&rdquo; for BB7, &ldquo;rBB7&rdquo; for reflected BB7, &ldquo;BB8&rdquo; for BB8, &ldquo;rBB8&rdquo; for reflected BB8, &ldquo;BB10&rdquo; for BB10, &ldquo;rBB10&rdquo; for reflected BB10.</p>
</td></tr>
<tr><td><code id="Select.Factor_+3A_copnamesf2">copnamesF2</code></td>
<td>
<p>A list with the names of possible candidates of bivariate copulas that link the each of the oberved variabels with the 1st and 2nd factors. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel, &ldquo;joe&rdquo; for Joe, &ldquo;rjoe&rdquo; for reflected Joe, &ldquo;1rjoe&rdquo; for 1-reflected Joe, &ldquo;2rjoe&rdquo; for 2-reflected Joe, &ldquo;BB1&rdquo; for BB1, &ldquo;rBB1&rdquo; for reflected BB1, &ldquo;BB7&rdquo; for BB7, &ldquo;rBB7&rdquo; for reflected BB7, &ldquo;BB8&rdquo; for BB8, &ldquo;rBB8&rdquo; for reflected BB8, &ldquo;BB10&rdquo; for BB10, &ldquo;rBB10&rdquo; for reflected BB10.</p>
</td></tr>
<tr><td><code id="Select.Factor_+3A_gl">gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The linking copulas at each factor are selected with a sequential algorithm under the initial assumption that linking copulas are Frank, and then sequentially copulas with non-tail quadrant independence are assigned to any of pairs where necessary to account for tail asymmetry (discrete data) or tail dependence (continuous data).
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>``1st factor''</code></td>
<td>
<p>The selected bivariate linking copulas for the 1st factor.</p>
</td></tr>
<tr><td><code>``2nd factor''</code></td>
<td>
<p>The selected bivariate linking copulas for the 2nd factor.</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>Akaike information criterion.</p>
</td></tr>
<tr><td><code>taus</code></td>
<td>
<p>The estimated copula parameters in Kendall's tau scale.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2021)
Factor copula models for mixed data.
<em>British Journal of Mathematical and Statistical Psychology</em>, <b>74</b>, 365&ndash;403. <a href="https://doi.org/10.1111/bmsp.12231">doi:10.1111/bmsp.12231</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
#                   Estimation
#------------------             -----------------
# Setting quadreture points
nq&lt;-25  
gl&lt;-gauss.quad.prob(nq) 
#------------------------------------------------
#                     PE Data
#------------------             -----------------
data(PE)
continuous.PE1 = -PE[,1]
continuous.PE &lt;- cbind(continuous.PE1, PE[,2])
categorical.PE &lt;- PE[, 3:5]

#------------------ One-factor  -----------------
# listing the possible copula candidates:
d &lt;- ncol(PE)
copulasF1 &lt;- rep(list(c("bvn", "bvt3", "bvt5", "frk", "gum", 
"rgum", "rjoe","joe", "1rjoe","2rjoe", "1rgum","2rgum")), d)
out1F.PE &lt;- select1F(continuous.PE, categorical.PE, 
count=NULL, copulasF1, gl)





</code></pre>

<hr>
<h2 id='Select.FactorTree'>Model selection of the 1- and 2-factor tree copula models for item response data</h2><span id='topic+Select.FactorTree'></span><span id='topic+selectFactorTrVine'></span><span id='topic+copselect1FactorTree'></span><span id='topic+copselect2FactorTree'></span>

<h3>Description</h3>

<p>Heuristic algorithms that automatically select the bivariate parametric copula families and 1-truncated vine tree structure for the 1- and 2-factor tree copula models for item response data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectFactorTrVine(y,rmat,alg)
copselect1FactorTree(y, A, copnames, gl)
copselect2FactorTree(y, A, copnames, gl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Select.FactorTree_+3A_y">y</code></td>
<td>
<p><code class="reqn">n \times d</code> matrix with the item reponse data, where <code class="reqn">n</code> and <code class="reqn">d</code> is the number of observations and variables, respectively.</p>
</td></tr>
<tr><td><code id="Select.FactorTree_+3A_rmat">rmat</code></td>
<td>
<p>Polychoric correlation matrix of y.</p>
</td></tr>
<tr><td><code id="Select.FactorTree_+3A_alg">alg</code></td>
<td>
<p>1-truncated vine selection using partial and polychoric correlations. Choose a number from (1,2,3). 
<b>1</b>: Partial correlation selection algorithm for 1-factor tree copula.
<b>2</b>: Partial correlation selection algorithm for 2-factor tree copula.
<b>3</b>: Polychoric correlation selection algorithm for 1-factor/2-factor tree copulas, here any other correlation matrix (rmat) can be used.</p>
</td></tr>
<tr><td><code id="Select.FactorTree_+3A_a">A</code></td>
<td>
<p><code class="reqn">d \times d</code> vine array with <code class="reqn">1,...,d</code> on diagonal, note only the first row and diagnoal values are used for the 1-truncated vine model</p>
</td></tr> 
<tr><td><code id="Select.FactorTree_+3A_copnames">copnames</code></td>
<td>
<p>A vector with the names of possible candidates of bivariate copulas to be selected for the 1-factor/2-factor copula models for item response data. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
<tr><td><code id="Select.FactorTree_+3A_gl">gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model selection involves two separate steps. At the first step we select the 1-truncated vine or Markov tree structure assuming our models are constructed with BVN copulas. We find the maximum spanning tree which is a tree on all nodes that maximizes the pairwise dependencies using the well-known algorithm of Prim (1957).   That is we find the tree with <code class="reqn">d-1</code> edges <code class="reqn">\mathcal{E}</code> that minimizes 
<code class="reqn">\sum_{\mathcal{E}}\log(1-r_{jk}^2).</code>
The minimum spanning tree algorithm of Prim (1957)
guarantees to find the optimal solution when edge weights between nodes  are given by <code class="reqn">\log(1-r_{jk}^2)</code>. 
We use two  different measures of pairwise dependence <code class="reqn">r_{jk}</code>. The first measure is the estimated  polychoric correlation (Olsson, 1979). The second measures of pairwise dependence is  the partial correlation which is based on the  factor copula models in   Nikoloulopoulos and Joe (2015) with BVN copulas;  for more details see Kadhem and Nikoloulopoulos (2022).  We call polychoric and partial correlation selection algorithm when the pairwise dependence is the polychoric and partial correlation, respectively.
</p>
<p>At the the second step, we sequentially select suitable bivariate copulas to account for any tail dependence/asymmetry. We start from the 1st tree that includes copulas connecting the observed variables to the first factor and then we iterate over a set of copula candidates and select suitable bivariate copulas in the subsequent trees. We select only one copula family for all the edges in each tree to ease interpretation.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>``1Factor copulas''</code></td>
<td>
<p>The selected bivariate linking copulas for the first factor.</p>
</td></tr>
<tr><td><code>``2Factor copulas''</code></td>
<td>
<p>The selected bivariate linking copulas for the second factor.</p>
</td></tr>
<tr><td><code>``Vine tree copulas''</code></td>
<td>
<p>The selected bivariate linking copulas for the 1-truncated vine tree.</p>
</td></tr>
<tr><td><code>``log-likelihood''</code></td>
<td>
<p>The maximized joint log-likelihood.</p>
</td></tr>
<tr><td><code>``estimated taus''</code></td>
<td>
<p>The estimated copula parameters in Kendall's tau scale.</p>
</td></tr>
<tr><td><code>F1treeA</code></td>
<td>
<p>Vine array for the 1-factor tree copula.</p>
</td></tr>
<tr><td><code>F2treeA</code></td>
<td>
<p>Vine array for the 2-factor tree copula.</p>
</td></tr>
<tr><td><code>pmat_f1</code></td>
<td>
<p>Partial correlation matrix for the 1-factor tree copula.</p>
</td></tr>
<tr><td><code>pmat_f2</code></td>
<td>
<p>Partial correlation matrix for the 2-factor tree copula.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Fontenla, M. (2014).
<em>optrees: Optimal Trees in Weighted Graphs</em>.
R package version 1.0.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2022)
Factor tree copula models for item response data.
<em>Arxiv e-prints</em>, &lt;arXiv: 2201.00339&gt;. <a href="https://arxiv.org/abs/2201.00339">https://arxiv.org/abs/2201.00339</a>.
</p>
<p>Nikoloulopoulos, A.K. and Joe, H. (2015)
Factor copula models with item response data.
<em>Psychometrika</em>, <b>80</b>, 126&ndash;150. <a href="https://doi.org/10.1007/s11336-013-9387-4">doi:10.1007/s11336-013-9387-4</a>.
</p>
<p>Olsson, F. (1979) Maximum likelihood estimation of the polychoric correlation coefficient. <em>Psychometrika</em>, <b>44</b>, 443&ndash;460.
</p>
<p>Prim, R. C. (1957) Shortest connection networks and some generalizations. <em>The Bell System Technical Journal</em>, <b>36</b>, 1389&ndash;1401.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
# Setting quadreture points
nq &lt;- 5
gl &lt;- gauss.quad.prob(nq)
#------------------------------------------------
#                    PTSD Data
#------------------             -----------------
data(PTSD)
ydat=PTSD

#------------------------------------------------
#vine tree structure
#selecting vine tree based on polychoric corr
rmat=polychoric0(ydat)$p
A.polychoric=selectFactorTrVine(y=ydat,rmat,alg=3)

#selecting bivariate copulas for the 1-2-factor tree
# listing the possible copula candidates:
copnames=c("gum", "rgum")

f1tree_model = copselect1FactorTree(ydat, A.polychoric$VineTreeA, 
copnames, gl)
f2tree_model = copselect2FactorTree(ydat, A.polychoric$VineTreeA, 
copnames, gl)


</code></pre>

<hr>
<h2 id='Select.StructuredFactor'>Model selection of the bi-factor and second-order copula models for item response data</h2><span id='topic+Select.StructuredFactor'></span><span id='topic+selectBifactor'></span><span id='topic+selectSecond_order'></span>

<h3>Description</h3>

<p>A heuristic algorithm that automatically selects the bivariate parametric copula families for the bi-factor and second-order copula models for item response data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectBifactor(y, grpsize, copnames, gl)
selectSecond_order(y, grpsize, copnames, gl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Select.StructuredFactor_+3A_y">y</code></td>
<td>
<p><code class="reqn">n \times d</code> matrix with the item reponse data, where <code class="reqn">n</code> and <code class="reqn">d</code> is the number of observations and variables, respectively.</p>
</td></tr>
<tr><td><code id="Select.StructuredFactor_+3A_grpsize">grpsize</code></td>
<td>
<p>vector indicating the size for each group, e.g., c(4,4,4) indicating four items in all three groups.</p>
</td></tr>
<tr><td><code id="Select.StructuredFactor_+3A_copnames">copnames</code></td>
<td>
<p>A vector with the names of possible candidates of bivariate copulas to be selected for the bi-factor and second-order copula models for item response data. Choices are &ldquo;bvn&rdquo; for BVN, &ldquo;bvt<code class="reqn">\nu</code>&rdquo; with <code class="reqn">\nu = \{1, \ldots, 9\}</code> degrees of freedom for t-copula, &ldquo;frk&rdquo; for Frank, &ldquo;gum&rdquo; for Gumbel, &ldquo;rgum&rdquo; for reflected Gumbel, &ldquo;1rgum&rdquo; for 1-reflected Gumbel, &ldquo;2rgum&rdquo; for 2-reflected Gumbel.</p>
</td></tr>
<tr><td><code id="Select.StructuredFactor_+3A_gl">gl</code></td>
<td>
<p>Gauss legendre quardrature nodes and weights.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The linking copulas at each factor are selected with a sequential algorithm under the initial assumption that linking copulas are BVN, and then sequentially copulas with tail dependence are assigned to any of pairs where necessary to account for tail asymmetry.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table>
<tr><td><code>``common factor''</code></td>
<td>
<p>The selected bivariate linking copulas for the common factor (Bi-factor: copulas link items with the common factor. Second-order: copulas link group-specific factors with the common factor).</p>
</td></tr>
<tr><td><code>``group-specific factor''</code></td>
<td>
<p>The selected bivariate linking copulas for the items with group-speicifc factors.</p>
</td></tr>
<tr><td><code>log-likelihood</code></td>
<td>
<p>The maximized joint log-likelihood.</p>
</td></tr>
<tr><td><code>taus</code></td>
<td>
<p>The estimated copula parameters in Kendall's tau scale.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2023)
Bi-factor and second-order copula models for item response data.
<em>Psychometrika</em>, <b>88</b>, 132&ndash;157. <a href="https://doi.org/10.1007/s11336-022-09894-2">doi:10.1007/s11336-022-09894-2</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
# Setting quadreture points
nq &lt;- 15
gl &lt;- gauss.quad.prob(nq)
#------------------------------------------------
#                     TAS Data
#------------------             -----------------
data(TAS)
#using a subset of the data
#group1: 1,3,6,7,9,13,14
grp1=c(1,3)
#group2: 2,4,11,12,17
grp2=c(2,4)
#group3: 5,8,10,15,16,18,19,20
grp3=c(5,8)
#Rearrange items within testlets
set.seed(123)
i=sample(1:nrow(TAS),500)
ydat=TAS[i,c(grp1,grp2,grp3)]

#size of each group
g1=length(grp1)
g2=length(grp2)
g3=length(grp3)
grpsize=c(g1,g2,g3)

# listing possible copula candidates:
copnames=c("bvt2","bvt3")

Bifactor_model = selectBifactor(ydat, grpsize, copnames, gl)

</code></pre>

<hr>
<h2 id='semicorr'>
Diagnostics to detect tail dependence or tail asymmetry.
</h2><span id='topic+semicorr'></span>

<h3>Description</h3>

<p>The sample versions of the correlation <code class="reqn">\rho_N</code>, upper semi-correlation <code class="reqn">\rho_N^+</code> (correlation in the joint upper  quadrant) and lower semi-correlation <code class="reqn">\rho_N^-</code> (correlation  in the joint lower quadrant). These  are sample linear  (when both variables are continuous),  polychoric (when both variables are ordinal),  and polyserial (when one variable is continuous and the
other is ordinal) correlations.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>semicorr(dat,type)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="semicorr_+3A_dat">dat</code></td>
<td>
<p>Data frame of mixed continuous and ordinal data. </p>
</td></tr>
<tr><td><code id="semicorr_+3A_type">type</code></td>
<td>
<p>A vector with 1's for the location of continuous data and 2's for the location of ordinal data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the following components for semicorr():
</p>
<table>
<tr><td><code>rho</code></td>
<td>
<p><code class="reqn">\rho_N</code>.</p>
</td></tr>
<tr><td><code>lrho</code></td>
<td>
<p><code class="reqn">\rho_N^-</code>.</p>
</td></tr>
<tr><td><code>urho</code></td>
<td>
<p><code class="reqn">\rho_N^+</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Joe, H. (2014).
<em>Dependence Modelling with Copulas</em>. Chapman and Hall/CRC.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2021)
Factor copula models for mixed data.
<em>British Journal of Mathematical and Statistical Psychology</em>, <b>74</b>, 365&ndash;403. <a href="https://doi.org/10.1111/bmsp.12231">doi:10.1111/bmsp.12231</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
#                     PE Data
#------------------             -----------------
data(PE)
#correlation
continuous.PE1 &lt;- -PE[,1] 
continuous.PE &lt;- cbind(continuous.PE1, PE[,2])
categorical.PE &lt;- data.frame(apply(PE[, 3:5], 2, factor))
nPE &lt;- cbind(continuous.PE, categorical.PE)

#-------------------------------------------------
# Semi-correlations-------------------------------
#-------------------------------------------------
# Exclude the dichotomous variable
sem.PE = nPE[,-3]
semicorr.PE = semicorr(dat = sem.PE, type = c(1,1,2,2)) 
#------------------------------------------------
#------------------------------------------------
#                    GSS Data
#------------------             -----------------
data(GSS)
attach(GSS)
continuous.GSS &lt;- cbind(INCOME,AGE)
ordinal.GSS &lt;- cbind(DEGREE,PINCOME,PDEGREE) 
count.GSS &lt;- cbind(CHILDREN,PCHILDREN)

# Transforming the COUNT variables to ordinal
# count1 : CHILDREN
count1  = count.GSS[,1]
count1[count1 &gt; 3] = 3

# count2: PCHILDREN
count2  = count.GSS[,2]
count2[count2 &gt; 7] = 7

# Combining both transformed count variables
ncount.GSS = cbind(count1, count2)

# Combining ordinal and transformed count variables
categorical.GSS &lt;- cbind(ordinal.GSS, ncount.GSS)
categorical.GSS &lt;- data.frame(apply(categorical.GSS, 2, factor))

# combining continuous and categorical variables
nGSS = cbind(continuous.GSS, categorical.GSS)
#-------------------------------------------------
# Semi-correlations-------------------------------
#-------------------------------------------------
semicorr.GSS = semicorr(dat = nGSS, type = c(1, 1, rep(2,5)))




</code></pre>

<hr>
<h2 id='TAS'>
Toronto Alexithymia Scale (TAS)
</h2><span id='topic+TAS'></span>

<h3>Description</h3>

<p>The Toronto Alexithymia Scale is the most utilized measure of alexithymia in empirical research and is composed of <code class="reqn">d = 20</code> items that can be subdivided into <code class="reqn">G = 3</code> non-overlapping groups: <code class="reqn">d_1 = 7</code> items to assess difficulty identifying feelings (DIF), <code class="reqn">d_2 = 5</code> items to assess difficulty describing feelings (DDF) and <code class="reqn">d_3 = 8</code> items to assess externally oriented thinking (EOT).
Students were 17 to 25 years old and 58% of them were female and 42% were male. They were asked to respond to each item using one of K = 5 categories: &ldquo;1 = completely disagree&rdquo;, &ldquo;2 = disagree&rdquo;, &ldquo;3 = neutral&rdquo;, &ldquo;4 = agree&rdquo;, &ldquo;5 = completely agree&rdquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(TAS)</code></pre>


<h3>Format</h3>

<p>A data frame with 1925 observations on the following 20 items:
</p>

<dl>
<dt><code>DIF</code></dt><dd><p>items: 1,3,6,7,9,13,14.</p>
</dd>
<dt><code>DDF</code></dt><dd><p>items: 2,4,11,12,17.</p>
</dd>
<dt><code>EOT</code></dt><dd><p>items: 5,8,10,15,16,18,19,20.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Briganti, G. and Linkowski, P. (2020).
Network approach to items and domains from the toronto alexithymia scale.
<em>Psychological Reports</em>, <b>123</b>, 2038&ndash;2052.
</p>
<p>Williams, D. and Mulder, J. (2020).
<em>BGGM: Bayesian Gaussian Graphical Models</em>.
R package version 1.0.0.
</p>

<hr>
<h2 id='transformation'>
Continuous/count to ordinal responses
</h2><span id='topic+transformation'></span><span id='topic+continuous2ordinal'></span><span id='topic+count2ordinal'></span>

<h3>Description</h3>

<p>Transforming a continuous/count to ordinal variable with <code class="reqn">K</code> categories. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>continuous2ordinal(continuous, categ)
count2ordinal(count, categ)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transformation_+3A_continuous">continuous</code></td>
<td>
<p>Matrix of continuous data.</p>
</td></tr>
<tr><td><code id="transformation_+3A_count">count</code></td>
<td>
<p>Matrix of count data.</p>
</td></tr>
<tr><td><code id="transformation_+3A_categ">categ</code></td>
<td>
<p>The number of categories <code class="reqn">K</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
#                     PE Data
#------------------             -----------------
data(PE)
continuous.PE &lt;- PE[, 1:2]

#Transforming the continuous to ordinal data :
tcontinuous = continuous2ordinal(continuous.PE, categ=5)
table(tcontinuous)

#Transforming the count to ordinal data:
set.seed(12345)
count.data = rpois(1000, 3)
tcount = count2ordinal(count.data, 5)
table(tcount)


</code></pre>

<hr>
<h2 id='Vuong.Factor'>
Vuong's test for the comparison of factor  copula models</h2><span id='topic+Vuong.Factor'></span><span id='topic+vuong.1f'></span><span id='topic+vuong.2f'></span>

<h3>Description</h3>

<p>Vuong (1989)'s test for the comparison of non-nested factor copula models for mixed data.  
We compute the Vuong's test between the factor copula model with BVN copulas (that is the standard factor  model) and a competing factor copula model to reveal if the latter provides better fit than the standard factor model.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vuong.1f(cpar.bvn, cpar, copF1, continuous, ordinal, count, gl, param)
vuong.2f(cpar.bvn, cpar, copF1, copF2, continuous, ordinal, count, gl, param)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Vuong.Factor_+3A_cpar.bvn">cpar.bvn</code></td>
<td>
<p>copula parameters of the factor copula model with BVN copulas.</p>
</td></tr>
<tr><td><code id="Vuong.Factor_+3A_cpar">cpar</code></td>
<td>
<p>copula parameters of the competing factor copula model.</p>
</td></tr>
<tr><td><code id="Vuong.Factor_+3A_copf1">copF1</code></td>
<td>
<p>copula names for the first factor of the competing factor copula model.</p>
</td></tr>
<tr><td><code id="Vuong.Factor_+3A_copf2">copF2</code></td>
<td>
<p>copula names for the second factor of the competing factor copula model.</p>
</td></tr>
<tr><td><code id="Vuong.Factor_+3A_continuous">continuous</code></td>
<td>
<p> matrix of continuous data.</p>
</td></tr>
<tr><td><code id="Vuong.Factor_+3A_ordinal">ordinal</code></td>
<td>
<p> matrix of ordinal data.</p>
</td></tr>
<tr><td><code id="Vuong.Factor_+3A_count">count</code></td>
<td>
<p> matrix of count data.</p>
</td></tr>
<tr><td><code id="Vuong.Factor_+3A_gl">gl</code></td>
<td>
<p> gauss-legendre quardature points.</p>
</td></tr>
<tr><td><code id="Vuong.Factor_+3A_param">param</code></td>
<td>
<p>parameterization of estimated copula parameters. If FALSE, then cpar are the actual copula parameters without any transformation/reparamterization.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the following components:
</p>
<table>
<tr><td><code>z</code></td>
<td>
<p>the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p> the <code class="reqn">p</code>-value.</p>
</td></tr>
<tr><td><code>CI.left</code></td>
<td>
<p> lower/left endpoint of 95% confidence interval.</p>
</td></tr>
<tr><td><code>CI.right</code></td>
<td>
<p> upper/right endpoint of 95% confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2021)
Factor copula models for mixed data.
<em>British Journal of Mathematical and Statistical Psychology</em>, <b>74</b>, 365&ndash;403. <a href="https://doi.org/10.1111/bmsp.12231">doi:10.1111/bmsp.12231</a>.
</p>
<p>Vuong, Q.H. (1989).
Likelihood ratio tests for model selection and non-nested hypotheses.
<em>Econometrica</em>, <b>57</b>, 307&ndash;333. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
# Setting quadreture points
nq &lt;- 25  
gl &lt;- gauss.quad.prob(nq) 
#------------------------------------------------
#                     PE Data
#------------------             -----------------
data(PE)
continuous.PE1 = -PE[,1]
continuous.PE2 = PE[,2]
continuous.PE &lt;- cbind(continuous.PE1, continuous.PE2)
categorical.PE &lt;- PE[, 3:5]
d &lt;- ncol(PE)
#------------------------------------------------
#                   Estimation
#------------------             -----------------
# factor copula model with BVN copulas
cop1f.PE.bvn &lt;- rep("bvn", d)
PE.bvn1f &lt;- mle1factor(continuous.PE, categorical.PE, 
count=NULL, copF1=cop1f.PE.bvn, gl, hessian = TRUE)

# Selected factor copula model
cop1f.PE &lt;- c("joe", "joe", "rjoe", "joe", "gum")
PE.selected1f &lt;- mle1factor(continuous.PE, categorical.PE, 
count=NULL, copF1=cop1f.PE, gl, hessian = TRUE)
#------------------------------------------------
#                   Vuong's test
#------------------             -----------------
v1f.PE.selected &lt;- vuong.1f(PE.bvn1f$cpar$f1,
PE.selected1f$cpar$f1,cop1f.PE, continuous.PE, 
categorical.PE, count=NULL, gl, param=FALSE)

</code></pre>

<hr>
<h2 id='Vuong.FactorTree'>
Vuong's test for the comparison of 1- and 2-factor tree copula models for item response data</h2><span id='topic+Vuong.FactorTree'></span><span id='topic+vuong_FactorTree'></span>

<h3>Description</h3>

<p>The Vuong's test (Vuong,1989) is the sample version of the difference in Kullback-Leibler divergence between two models and can be used to differentiate two  parametric models which could be non-nested. 
For the Vuong's test we provide the 95% confidence interval of the Vuong's test statistic (Joe, 2014, page 258). If the interval does not contain  0, then the best fitted model according to the AICs is better if the interval is completely above 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vuong_FactorTree(models, y, A.m1, tau.m1, copnames.m1, 
tau.m2, copnames.m2,A.m2,nq)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Vuong.FactorTree_+3A_models">models</code></td>
<td>
<p>choose a number from (1,2,3,4,5,6,7). 
<b>1</b>: Model 1 is 1-factor tree copula, Model 2 is 1-factor tree copula.
<b>2</b>: Model 1 is 2-factor tree copula, Model 2 is 2-factor tree copula.
<b>3</b>: Model 1 is 1-factor tree copula, Model 2 is 2-factor tree copula.
<b>4</b>: Model 1 is 1-factor copula, Model 2 is 1-factor tree copula.
<b>5</b>: Model 1 is 1-factor copula, Model 2 is 2-factor tree copula.
<b>6</b>: Model 1 is 2-factor copula, Model 2 is 1-factor tree copula.
<b>7</b>: Model 1 is 2-factor copula, Model 2 is 2-factor tree copula.
</p>
</td></tr>
<tr><td><code id="Vuong.FactorTree_+3A_y">y</code></td>
<td>
<p><code class="reqn">n \times d</code> matrix with the item reponse data, where <code class="reqn">n</code> and <code class="reqn">d</code> is the number of observations and variables, respectively.</p>
</td></tr>
<tr><td><code id="Vuong.FactorTree_+3A_a.m1">A.m1</code></td>
<td>
<p><code class="reqn">d \times d</code> vine array for Model 1, if it is 1-factor tree, or 2-factor tree otherwise keep as NULL.</p>
</td></tr> 
<tr><td><code id="Vuong.FactorTree_+3A_a.m2">A.m2</code></td>
<td>
<p><code class="reqn">d \times d</code> vine array for Model 2, note only the first row and diagnoal values are used for the 1-truncated vine model.</p>
</td></tr> 
<tr><td><code id="Vuong.FactorTree_+3A_tau.m1">tau.m1</code></td>
<td>
<p>vector of copula paramters in Kendall's <code class="reqn">\tau</code> for model 1.</p>
</td></tr>
<tr><td><code id="Vuong.FactorTree_+3A_tau.m2">tau.m2</code></td>
<td>
<p>vector of copula paramters in Kendall's <code class="reqn">\tau</code> for model 2.</p>
</td></tr>
<tr><td><code id="Vuong.FactorTree_+3A_copnames.m1">copnames.m1</code></td>
<td>
<p>vector of names of copula families for model 1.</p>
</td></tr>
<tr><td><code id="Vuong.FactorTree_+3A_copnames.m2">copnames.m2</code></td>
<td>
<p>vector of names of copula families for model 2.</p>
</td></tr>
<tr><td><code id="Vuong.FactorTree_+3A_nq">nq</code></td>
<td>
<p>Number of Gauss legendre quardrature points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the following components:
</p>
<table>
<tr><td><code>z</code></td>
<td>
<p>the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p> the <code class="reqn">p</code>-value.</p>
</td></tr>
<tr><td><code>CI.left</code></td>
<td>
<p> lower/left endpoint of 95% confidence interval.</p>
</td></tr>
<tr><td><code>CI.right</code></td>
<td>
<p> upper/right endpoint of 95% confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Joe, H. (2014).
<em>Dependence Modelling with Copulas</em>. Chapman and Hall/CRC.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2022b)
Factor tree copula models for item response data.
<em>Arxiv e-prints</em>, &lt;arXiv: 2201.00339&gt;. <a href="https://arxiv.org/abs/2201.00339">https://arxiv.org/abs/2201.00339</a>.
</p>
<p>Vuong, Q.H. (1989).
Likelihood ratio tests for model selection and non-nested hypotheses.
<em>Econometrica</em>, <b>57</b>, 307&ndash;333. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
# Setting quadreture points
nq &lt;- 25
#------------------------------------------------
#                    PTSD Data
#------------------             -----------------
data(PTSD)
ydat=PTSD

d=ncol(ydat);d
n=nrow(ydat);n

#vine tree structure
#selecting vine tree based on polychoric corr
rmat=polychoric0(ydat)$p
A.polychoric=selectFactorTrVine(y=ydat,rmat,alg=3)
A.polychoric=A.polychoric$VineTreeA
#------------------------------------------------
# M1 1-factor tree - M2 1-factor tree
tau.m1 = rep(0.4,d*2-1)
copnames.m1 = rep("bvn",d*2-1)
tau.m2 = rep(0.4,d*2-1)
copnames.m2 = rep("rgum",d*2-1)
vuong.1factortree = vuong_FactorTree(models=1, ydat, 
A.m1=A.polychoric, tau.m1, copnames.m1, tau.m2, 
copnames.m2,A.m2=A.polychoric,nq)
#------------------------------------------------
# M1 2-factor tree - M2 2-factor tree
tau.m1 = rep(0.4,d*3-1)
copnames.m1 = rep("bvn",d*3-1)
tau.m2 = rep(0.4,d*3-1)
copnames.m2 = rep("rgum",d*3-1)

vuong.2factortree = vuong_FactorTree(models=2, ydat, 
A.m1=A.polychoric, tau.m1, copnames.m1, tau.m2, 
copnames.m2,A.m2=A.polychoric,nq)

#------------------------------------------------
# M1 1-factor tree - M2 2-factor tree
tau.m1 = rep(0.4,d*2-1)
copnames.m1 = rep("bvn",d*2-1)

tau.m2 = rep(0.4,d*3-1)
copnames.m2 = rep("rgum",d*3-1)

vuong.12factortree = vuong_FactorTree(models=3, ydat, 
A.m1=A.polychoric, tau.m1, copnames.m1, tau.m2, 
copnames.m2,A.m2=A.polychoric,nq)
                

</code></pre>

<hr>
<h2 id='Vuong.StructuredFactor'>
Vuong's test for the comparison of bi-factor and second-order copula models</h2><span id='topic+Vuong.StructuredFactor'></span><span id='topic+vuong_structured'></span>

<h3>Description</h3>

<p>The Vuong's test (Vuong,1989) is the sample version of the difference in Kullback-Leibler divergence between two models and can be used to differentiate two  parametric models which could be non-nested. 
For the Vuong's test we provide the 95% confidence interval of the Vuong's test statistic (Joe, 2014, page 258). If the interval does not contain  0, then the best fitted model according to the AICs is better if the interval is completely above 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vuong_structured(models, cpar.m1, copnames.m1, cpar.m2, 
copnames.m2, y, grpsize)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Vuong.StructuredFactor_+3A_models">models</code></td>
<td>
<p>choose a number from (1,2,3,4). <b>1</b>: Model1 is bifactor, Model2 is bifactor. <b>2</b>: Model1 is second-order, Model2 is second-order. <b>3</b>: Model1 is second-order, Model2 is bifactor. <b>4</b>: Model1 is bifactor, Model2 is nested.</p>
</td></tr>
<tr><td><code id="Vuong.StructuredFactor_+3A_cpar.m1">cpar.m1</code></td>
<td>
<p>vector of copula paramters for model 1, starting with copula parameters that link the items with common factor (bifactor), or group factors with common factor (second-order).</p>
</td></tr>
<tr><td><code id="Vuong.StructuredFactor_+3A_cpar.m2">cpar.m2</code></td>
<td>
<p>vector of copula paramters for model 2, starting with copula parameters that link the items with common factor (bifactor), or group factors with common factor (second-order).</p>
</td></tr>
<tr><td><code id="Vuong.StructuredFactor_+3A_copnames.m1">copnames.m1</code></td>
<td>
<p>vector of names of copula families for model 1, starting with copulas that link the items with common factor (bifactor), or group factors with common factor (second-order).</p>
</td></tr>
<tr><td><code id="Vuong.StructuredFactor_+3A_copnames.m2">copnames.m2</code></td>
<td>
<p>vector of names of copula families for model 2, starting with copulas that link the items with common factor (bifactor), or group factors with common factor (second-order).</p>
</td></tr>
<tr><td><code id="Vuong.StructuredFactor_+3A_y">y</code></td>
<td>
<p>matrix of ordinal data.</p>
</td></tr>
<tr><td><code id="Vuong.StructuredFactor_+3A_grpsize">grpsize</code></td>
<td>
<p>vector indicating the size for each group, e.g., c(4,4,4) indicating four items in all three groups.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the following components:
</p>
<table>
<tr><td><code>z</code></td>
<td>
<p>the test statistic.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p> the <code class="reqn">p</code>-value.</p>
</td></tr>
<tr><td><code>CI.left</code></td>
<td>
<p> lower/left endpoint of 95% confidence interval.</p>
</td></tr>
<tr><td><code>CI.right</code></td>
<td>
<p> upper/right endpoint of 95% confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sayed H. Kadhem <a href="mailto:s.kadhem@uea.ac.uk">s.kadhem@uea.ac.uk</a><br />
Aristidis K. Nikoloulopoulos <a href="mailto:a.nikoloulopoulos@uea.ac.uk">a.nikoloulopoulos@uea.ac.uk</a>
</p>


<h3>References</h3>

<p>Joe, H. (2014).
<em>Dependence Modelling with Copulas</em>. Chapman and Hall/CRC.
</p>
<p>Kadhem, S.H. and Nikoloulopoulos, A.K. (2023)
Bi-factor and second-order copula models for item response data.
<em>Psychometrika</em>, <b>88</b>, 132&ndash;157. <a href="https://doi.org/10.1007/s11336-022-09894-2">doi:10.1007/s11336-022-09894-2</a>.
</p>
<p>Vuong, Q.H. (1989).
Likelihood ratio tests for model selection and non-nested hypotheses.
<em>Econometrica</em>, <b>57</b>, 307&ndash;333. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#------------------------------------------------
# Setting quadreture points
nq &lt;- 25
gl &lt;- gauss.quad.prob(nq)
#------------------------------------------------
#                     TAS Data
#------------------             -----------------
data(TAS)
grp1=c(1,3,6,7,9,13,14)
grp2=c(2,4,11,12,17)
grp3=c(5,8,10,15,16,18,19,20)
ydat=TAS[,c(grp1,grp2,grp3)]

d=ncol(ydat);d
n=nrow(ydat);n

#Rearrange items within testlets
g1=length(grp1)
g2=length(grp2)
g3=length(grp3)

grpsize=c(g1,g2,g3)#group size
#number of groups
ngrp=length(grpsize)
#------------------------------------------------
# M1 bifactor - M2 bifactor
cpar.m1 = rep(0.6,d*2)
copnames.m1 = rep("bvn",d*2)
cpar.m2 = rep(1.6,d*2)
copnames.m2 = rep("rgum",d*2)
vuong.bifactor = vuong_structured(models=1, cpar.m1, copnames.m1, 
                 cpar.m2, copnames.m2, 
                 y=ydat, grpsize)

# M1 seconod-order - M2 seconod-order
cpar.m1 = rep(0.6,d+ngrp)
copnames.m1 = rep("bvn",d+ngrp)
cpar.m2 = rep(1.6,d+ngrp)
copnames.m2 = rep("rgum",d+ngrp)
vuong.second_order = vuong_structured(models=2, cpar.m1, 
    copnames.m1, cpar.m2, copnames.m2, y=ydat, grpsize)
 
# M1 seconod-order - M2 bifactor
cpar.m1 = rep(0.6,d+ngrp)
copnames.m1 = rep("bvn",d+ngrp)
cpar.m2 = rep(1.6,d*2)
copnames.m2 = rep("rgum",d*2)
vuong.2ndO_bif = vuong_structured(models=3, cpar.m1, copnames.m1, 
                 cpar.m2, copnames.m2, 
                 y=ydat, grpsize)     
                 
# M1 bifactor - M2 seconod-order
cpar.m1 = rep(0.6,d*2)
copnames.m1 = rep("bvn",d*2)
cpar.m2 = rep(1.6,d+ngrp)
copnames.m2 = rep("rgum",d+ngrp)
vuong.bif_2ndO = vuong_structured(models=4, cpar.m1, copnames.m1, 
                 cpar.m2, copnames.m2, 
                 y=ydat, grpsize)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
