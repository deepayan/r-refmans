<!DOCTYPE html><html lang="en"><head><title>Help for package cotram</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cotram}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confband'>
<p>Confidence Bands</p></a></li>
<li><a href='#cotram'>
<p>Count Transformation Models</p></a></li>
<li><a href='#cotram-methods'>
<p>Methods for Count Transformation Models</p></a></li>
<li><a href='#spiders'>
<p>Bavarian Forest Spider Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Count Transformation Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-18</td>
</tr>
<tr>
<td>Description:</td>
<td>Count transformation models featuring 
        parameters interpretable as discrete hazard ratios, odds ratios,
        reverse-time discrete hazard ratios, or transformed expectations. 
        An appropriate data transformation for a count outcome and
        regression coefficients are simultaneously estimated by maximising
        the exact discrete log-likelihood using the computational framework
        provided in package 'mlt', technical details are given in
        Siegfried &amp; Hothorn (2020) &lt;<a href="https://doi.org/10.1111%2F2041-210X.13383">doi:10.1111/2041-210X.13383</a>&gt;. 
        The package also contains an experimental implementation of 
        multivariate count transformation models with an application
        to multi-species distribution models &lt;<a href="https://doi.org/10.48550%2FarXiv.2201.13095">doi:10.48550/arXiv.2201.13095</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), tram (&ge; 1.0-0), mlt (&ge; 1.4-7)</td>
</tr>
<tr>
<td>Imports:</td>
<td>variables (&ge; 1.0-2), basefun (&ge; 1.0-5), alabama, Matrix,
methods, survival, utils, qrng</td>
</tr>
<tr>
<td>Suggests:</td>
<td>TH.data, knitr, lattice, colorspace, multcomp, mvtnorm,
numDeriv</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://ctm.R-forge.R-project.org">http://ctm.R-forge.R-project.org</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-18 07:20:03 UTC; siegfried</td>
</tr>
<tr>
<td>Author:</td>
<td>Sandra Siegfried <a href="https://orcid.org/0000-0002-7312-1001"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Luisa Barbanti <a href="https://orcid.org/0000-0001-5352-5802"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Torsten Hothorn <a href="https://orcid.org/0000-0001-8301-0471"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sandra Siegfried &lt;sandra.siegfried@alumni.uzh.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-18 09:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='confband'>
Confidence Bands
</h2><span id='topic+confband'></span><span id='topic+confband.cotram'></span>

<h3>Description</h3>

<p>Confidence bands for transformation, distribution, survivor or
cumulative hazard functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cotram'
confband(object, newdata,  level = 0.95, 
       type = c("trafo", "distribution", "survivor", "cumhazard"), 
       smooth = FALSE, q = NULL, K = 20, cheat = K, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confband_+3A_object">object</code></td>
<td>
<p>an object of class <code><a href="#topic+cotram">cotram</a></code>.</p>
</td></tr>
<tr><td><code id="confband_+3A_newdata">newdata</code></td>
<td>
<p>a data frame of observations.</p>
</td></tr>
<tr><td><code id="confband_+3A_level">level</code></td>
<td>
<p>the confidence level.</p>
</td></tr>
<tr><td><code id="confband_+3A_type">type</code></td>
<td>
<p>the function to compute the confidence band for.</p>
</td></tr>
<tr><td><code id="confband_+3A_smooth">smooth</code></td>
<td>
<p>logical; if <code>TRUE</code> a smoothed function of
<code>type</code> is returned.</p>
</td></tr>
<tr><td><code id="confband_+3A_q">q</code></td>
<td>
<p>quantiles at which to evaluate the model.</p>
</td></tr>
<tr><td><code id="confband_+3A_k">K</code></td>
<td>
<p>number of grid points the function is evaluated at
(in the absence of <code>q</code> and <code>smooth = TRUE</code>).</p>
</td></tr>
<tr><td><code id="confband_+3A_cheat">cheat</code></td>
<td>
<p>number of grid points the function is evaluated at when
using the quantile obtained for <code>K</code> grid points
(in the absence of <code>q</code> and <code>smooth = TRUE</code>).</p>
</td></tr>
<tr><td><code id="confband_+3A_...">...</code></td>
<td>
<p>additional arguments to <code><a href="multcomp.html#topic+confint.glht">confint.glht</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is evaluated at the count response or at <code>K</code> grid points
and simultaneous confidence intervals are then interpolated in order to
construct the band.
</p>


<h3>Value</h3>

<p>For each row in <code>newdata</code> the function and corresponding confidence
band evaluated at the count response (or <code>K</code> or <code>cheat</code> grid points)
is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  op &lt;- options(digits = 4)

  data("birds", package = "TH.data")
  
  ### fit count transformation model with cloglog link
  m_birds &lt;- cotram(SG5 ~ AOT + AFS + GST + DBH + DWC + LOG, data = birds,
                    method = "cloglog")
  
  ### compute asymptotic confidence bands for the distribution function
  ### for the first oberservation
  confband(m_birds, newdata = birds[1, ], type = "distribution")

  options(op)

</code></pre>

<hr>
<h2 id='cotram'>
Count Transformation Models
</h2><span id='topic+cotram'></span>

<h3>Description</h3>

<p>Likelihood-based count transformation models for fully parameterised discrete conditional
distribution functions. The link function governing the interpretation of the predictor 
can be chosen and results in discrete hazard ratios, odds ratios, reverse time
hazard ratios or conditional expectation of transformed counts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cotram(formula, data, method = c("logit", "cloglog", "loglog", "probit"),
       log_first = TRUE, prob = 0.9, subset, weights, offset, cluster,
       na.action = na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cotram_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>"formula"</code>: a symbolic description 
of the model structure to be fitted.  The details of model
specification are given under <code><a href="tram.html#topic+tram">tram</a></code> and in the package vignette.
</p>
</td></tr>
<tr><td><code id="cotram_+3A_data">data</code></td>
<td>
<p>an optional data frame, list or environment (or object
coercible by <code>as.data.frame</code> to a data frame) containing the
variables in the model.  If not found in <code>data</code>, the
variables are taken from <code>environment(formula)</code>.
</p>
</td></tr>
<tr><td><code id="cotram_+3A_method">method</code></td>
<td>
<p>character specifying the choice of the link function,
mapping the transformation function into probabilities. Available choices
include the logit, complementary log-log, log-log or probit link. 
The different link functions govern the interpretation of the linear
predictor. Details of the interpretation can be found in the 
package vignette.
</p>
</td></tr>
<tr><td><code id="cotram_+3A_prob">prob</code></td>
<td>
<p>probability giving the quantile of the response defining the upper
limit of the support of a smooth Bernstein polynomial (with the lower limit
being set to 0). If a vector of two probabilites is specified, the corresponding
quantiles of the response define the lower and upper limit of the support, 
respectively. Note, that the support is rounded to integer values.
</p>
</td></tr>
<tr><td><code id="cotram_+3A_log_first">log_first</code></td>
<td>
<p>logical; if <code>TRUE</code>, a Bernstein polynomial is
defined on the log-scale for (y + 1).
</p>
</td></tr>
<tr><td><code id="cotram_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in the fitting process.
</p>
</td></tr>
<tr><td><code id="cotram_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.  Should be <code>NULL</code> or a numeric vector. If present,
the weighted log-likelihood is maximised.
</p>
</td></tr>
<tr><td><code id="cotram_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an _a priori_ known component to
be included in the linear predictor during fitting.  This
should be <code>NULL</code> or a numeric vector of length equal to the
number of cases.
</p>
</td></tr>
<tr><td><code id="cotram_+3A_cluster">cluster</code></td>
<td>
<p>optional factor with a cluster ID employed for computing
clustered covariances.
</p>
</td></tr>
<tr><td><code id="cotram_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contain <code>NA</code>s.  The default is set to <code>na.omit</code>.
</p>
</td></tr>
<tr><td><code id="cotram_+3A_...">...</code></td>
<td>
<p>additional arguments to <code><a href="tram.html#topic+tram">tram</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Likelihood-based estimation of a fully parameterised conditional discrete
distribution function for count data, while ensuring interpretability of
the linear predictors. The models are defined with a negative shift term 
relating positive predictors to larger values of the conditional mean. 
For the model with logistic or cloglog link <code>exp(-coef())</code>
is the multiplicative change of discrete odds-ratios or hazard ratios. For 
the model with loglog link <code>exp(coef())</code> is the multiplicative change of
the reverse time hazard ratios. Applying a transformation model with probit link
<code>coef()</code> gives the conditional expectation of the transformed counts,
with transformation function estimated from data.
</p>


<h3>Value</h3>

<p>An object of class <code>cotram</code> and <code>tram</code>, with corresponding <code>coef</code>,
<code>vcov</code>, <code>logLik</code>, <code>summary</code>, 
<code>print</code>, <code>plot</code> and <code>predict</code> methods.
</p>


<h3>References</h3>

<p>Sandra Siegfried, Torsten Hothorn (2020), Count Transformation Models,
<em>Methods in Ecology and Evolution</em>, <b>11</b>(7), 818&ndash;827,
<a href="https://doi.org/10.1111/2041-210X.13383">doi:10.1111/2041-210X.13383</a>.
</p>
<p>Torsten Hothorn, Lisa Möst, Peter Bühlmann (2018), Most Likely
Transformations, <em>Scandinavian Journal of Statistics</em>, <b>45</b>(1),
110&ndash;134, <a href="https://doi.org/10.1111/sjos.12291">doi:10.1111/sjos.12291</a>.
</p>
<p>Torsten Hothorn (2020), Most Likely Transformations: The mlt Package, 
<em>Journal of Statistical Software</em>, <b>92</b>(1), 1&ndash;68,
<a href="https://doi.org/10.18637/jss.v092.i01">doi:10.18637/jss.v092.i01</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  op &lt;- options(digits = 2)

  data("birds", package = "TH.data")
  cotram(SG5 ~ AOT + AFS + GST + DBH + DWC + LOG, data = birds)

  options(op)

</code></pre>

<hr>
<h2 id='cotram-methods'>
Methods for Count Transformation Models
</h2><span id='topic+predict.cotram'></span><span id='topic+plot.cotram'></span><span id='topic+as.mlt.cotram'></span><span id='topic+logLik.cotram'></span>

<h3>Description</h3>

<p>Methods for objects inheriting from class cotram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cotram'
predict(object, newdata = model.frame(object),
        type = c("lp", "trafo", "distribution", "survivor", "density", 
                 "logdensity", "hazard", "loghazard", "cumhazard", 
                 "logcumhazard", "odds", "logodds", "quantile"),
        smooth = FALSE, q = NULL, K = 20, prob = 1:(10-1)/10, ...)
## S3 method for class 'cotram'
plot(x, newdata, type = c("distribution", "survivor","density",
                          "logdensity", "cumhazard", "quantile", "trafo"),
        confidence = c("none", "band"), level = 0.95, 
        smooth = FALSE, q = NULL, K = 20, cheat = K, prob = 1:(10-1)/10,
        col = "black", fill = "lightgrey",
        lty = 1, lwd = 1, add = FALSE, ...) 
## S3 method for class 'cotram'
as.mlt(object)
## S3 method for class 'cotram'
logLik(object, parm = coef(as.mlt(object), fixed = FALSE), newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cotram-methods_+3A_object">object</code>, <code id="cotram-methods_+3A_x">x</code></td>
<td>
<p>a fitted linear count transformation model inheriting
from class <code>cotram</code>.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_newdata">newdata</code></td>
<td>
<p>an optional data frame of observations.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_parm">parm</code></td>
<td>
<p>model parameters.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_type">type</code></td>
<td>
<p>type of prediction, current options include
linear predictors (<code>"lp"</code>, of <code>x</code> variables in the
formula <code>y ~ x</code>), transformation functions
(<code>"trafo"</code>) or distribution functions on the
scale of the cdf (<code>"distribution"</code>), survivor function,
density function, log-density function, cumulative
hazard function or quantile function.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_confidence">confidence</code></td>
<td>
<p>whether to plot a confidence band (see <code><a href="#topic+confband">confband</a></code>).</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_level">level</code></td>
<td>
<p>the confidence level.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_smooth">smooth</code></td>
<td>
<p>logical; if <code>TRUE</code> a smoothed function of <code>type</code> is returned.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_q">q</code></td>
<td>
<p>quantiles at which to evaluate the model.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_prob">prob</code></td>
<td>
<p>probabilities for the evaluation of the quantile function <code>(type = "quantile")</code>.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_k">K</code></td>
<td>
<p>number of grid points the function is evaluated at
(for <code>smooth = TRUE</code> and in absence of <code>q</code>).</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_cheat">cheat</code></td>
<td>
<p>number of grid points the function is evaluated at when
using the quantile obtained for <code>K</code> grid points
(in the absence of <code>q</code> and <code>smooth = TRUE</code>).</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_col">col</code></td>
<td>
<p>color for the lines to plot.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_fill">fill</code></td>
<td>
<p>color for the confidence band.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_lty">lty</code></td>
<td>
<p>line type for the lines to plot.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_lwd">lwd</code></td>
<td>
<p>line width.</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_add">add</code></td>
<td>
<p>logical; indicating if a new plot shall be generated (the default).</p>
</td></tr>
<tr><td><code id="cotram-methods_+3A_...">...</code></td>
<td>
<p>additional arguments to the underlying methods for <code>predict</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>predict</code> and <code>plot</code> can be used to inspect the model on
different scales.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.cotram">predict.cotram</a></code>, <code><a href="#topic+confband.cotram">confband.cotram</a></code>,
<code><a href="tram.html#topic+tram-methods">tram-methods</a></code>, <code><a href="mlt.html#topic+mlt-methods">mlt-methods</a></code>, <code><a href="mlt.html#topic+plot.ctm">plot.ctm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  op &lt;- options(digits = 4)

  data("birds", package = "TH.data")
  
  ### fit count transformation model with cloglog link
  m_birds &lt;- cotram(SG5 ~ AOT + AFS + GST + DBH + DWC + LOG, data = birds,
                    method = "cloglog")
  logLik(m_birds)

  ### classical likelihood inference
  summary(m_birds)

  ### coefficients of the linear predictor (discrete hazard ratios)
  exp(-coef(m_birds))

  ### compute predicted median along with 10% and 90% quantile for the first
  ### three observations
  nd &lt;- birds[1:3,]
  round(predict(m_birds, newdata = nd, type = "quantile", prob = c(.1, .5, .9), 
                smooth = TRUE), 3)

  ### plot the predicted distribution for these observations
  plot(m_birds, newdata = nd, type = "distribution",
       col = c("skyblue", "grey", "seagreen"))
       
  options(op)
</code></pre>

<hr>
<h2 id='spiders'>
Bavarian Forest Spider Data
</h2><span id='topic+spiders'></span>

<h3>Description</h3>

<p>Abundance of six spider species on 190 plots in the Bavarian Forest
National Park
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("spiders")</code></pre>


<h3>Format</h3>

<p>A data frame with 190 observations on the following 9 variables.
</p>

<dl>
<dt><code>Plot</code></dt><dd><p>experimental plot id</p>
</dd>
<dt><code>Elevation</code></dt><dd><p>elevation of the plot</p>
</dd>
<dt><code>Canopy_openess</code></dt><dd><p>openess of canopy at plot</p>
</dd>
<dt><code>Pardosa_ferruginea</code></dt><dd><p>number of Pardosa ferruginea observed</p>
</dd>
<dt><code>Harpactea_lepida</code></dt><dd><p>number of Harpactea lepida observed</p>
</dd>
<dt><code>Callobius_claustrarius</code></dt><dd><p>number of Callobius claustrarius observed</p>
</dd>
<dt><code>Coelotes_terrestris</code></dt><dd><p>number of Coelotes terrestris observed</p>
</dd>
<dt><code>Pardosa_lugubris</code></dt><dd><p>number of Pardosa lugubris observed</p>
</dd>
<dt><code>Pardosa_riparia</code></dt><dd><p>number of Pardosa riparia observed</p>
</dd>
</dl>



<h3>Details</h3>

<p>To untangle effects of dead-wood addition and canopy openness on
non-saproxylic epigeal arthropods, Seibold et al (2016) exposed different 
amounts of logs and branches on 190 0.1-ha plots located in sunny or shady 
mixed montane forests and sampled epigeal arthropods over three years. The
data contain abundances of six spider species for all 190 plots, along with
plot elevation and canopy openess.
</p>


<h3>Source</h3>

<p>Sebastian Seibold, Claus Bässler, Petr Baldrian, Lena Reinhard, Simon Thorn,
Michael D. Ulyshen, Ingmar Weiß and Jörg Müller (2016). Dead-wood addition 
promotes non-saproxylic epigeal arthropods but effects are mediated by canopy
openness. <em>Biological Conservation</em>, <b>204</b>, 181&ndash;188,
<a href="https://doi.org/10.1016/j.biocon.2016.09.031">doi:10.1016/j.biocon.2016.09.031</a>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
