<!DOCTYPE html><html><head><title>Help for package LakeMetabolizer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LakeMetabolizer}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc.lw.net'><p>Estimate net long wave heat radiation</p></a></li>
<li><a href='#calc.zeng'><p>Estimate sensible and latent heat fluxes</p></a></li>
<li><a href='#get.Ts'><p>gets surface water temperatures</p></a></li>
<li><a href='#get.vars'><p>subsets data.frame according to header names</p></a></li>
<li><a href='#getSchmidt'><p>Returns Schmidt number for a specific gas at a given temperature</p></a></li>
<li><a href='#has.vars'><p>tests data.frame for column names</p></a></li>
<li><a href='#is.day'><p>determines if measurement was taken during the daytime</p></a></li>
<li><a href='#is.night'><p>determines if measurement was taken during the night</p></a></li>
<li><a href='#k.read'><p>Returns a timeseries of gas exchange velocity</p></a></li>
<li><a href='#k.read.base'><p>Returns a timeseries of gas exchange velocity</p></a></li>
<li><a href='#k600.2.kGAS'><p>Returns the gas exchange velocity for gas of interest w/ no unit conversions</p></a></li>
<li><a href='#load.all.data'><p>Attemps to load and merge all timeseries data for a given site name</p></a></li>
<li><a href='#load.meta'><p>Loads a metadata file from the specified path</p></a></li>
<li><a href='#metab'><p>Calculate metabolism</p></a></li>
<li><a href='#metab.bayesian'><p>Metabolism model based on a bayesian parameter estimation framework</p></a></li>
<li><a href='#metab.bookkeep'><p>Metabolism model based on simple day/night summation NEP-interpreted changes in DO.</p></a></li>
<li><a href='#metab.kalman'><p>Metabolism calculated from parameters estimated using a Kalman filter</p></a></li>
<li><a href='#metab.mle'><p>Metabolism calculated from the maximum likelihood estimates of the parameters in a standard linear regression model</p></a></li>
<li><a href='#metab.ols'><p>Metabolism model based on a ordinary least squares parameter estimation framework.</p></a></li>
<li><a href='#o2.at.sat'><p>Calculates the equilibrium saturation concentration of oxygen in water</p>
at the supplied conditions</a></li>
<li><a href='#par.to.sw'><p>Convert PAR to shortwave</p></a></li>
<li><a href='#rmv.vars'><p>subsets data.frame according to header names</p></a></li>
<li><a href='#sun.rise.set'><p>Calculates the time of sunrise and sunset</p></a></li>
<li><a href='#sw.to.par'><p>Convert shortwave radiation to PAR</p></a></li>
<li><a href='#temp.kalman'><p>Smooth temperature time series using a Kalman filter/ smoother</p></a></li>
<li><a href='#var.indx'><p>finds matching column names in data.frame</p></a></li>
<li><a href='#watts.in'>
<p>Simple estimate of energy gained by a layer of water</p></a></li>
<li><a href='#wind.scale'><p>Wind Scaling U10 - exponential conversion to 10m wind speed</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Tools for the Analysis of Ecosystem Metabolism</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jake Zwart &lt;jayzlimno@gmail.com&gt;</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.5</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of tools for the calculation of freewater metabolism
    from in situ time series of dissolved oxygen, water temperature, and,
    optionally, additional environmental variables. LakeMetabolizer implements
    5 different metabolism models with diverse statistical underpinnings:
    bookkeeping, ordinary least squares, maximum likelihood, Kalman filter,
    and Bayesian. Each of these 5 metabolism models can be combined with
    1 of 7 models for computing the coefficient of gas exchange across the
    airâ€“water interface (k). LakeMetabolizer also features a variety of
    supporting functions that compute conversions and implement calculations
    commonly applied to raw data prior to estimating metabolism (e.g., oxygen
    saturation and optical conversion models).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>plyr, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R2jags, testthat</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.0), rLakeAnalyzer (&ge; 1.4)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/GLEON/LakeMetabolizer/issues">https://github.com/GLEON/LakeMetabolizer/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.tandfonline.com/doi/abs/10.1080/IW-6.4.883">https://www.tandfonline.com/doi/abs/10.1080/IW-6.4.883</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-14 15:00:36 UTC; jzwart</td>
</tr>
<tr>
<td>Author:</td>
<td>Luke Winslow [aut],
  Jake Zwart <a href="https://orcid.org/0000-0002-3870-405X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre,
    aut],
  Ryan Batt [aut],
  Jessica Corman [aut],
  Hilary Dugan [aut],
  Paul Hanson [aut],
  Aline Jaimes [aut],
  Jordan Read [aut],
  Richard Woolway [aut]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-15 23:30:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc.lw.net'>Estimate net long wave heat radiation</h2><span id='topic+calc.lw.net'></span><span id='topic+calc.lw.net.base'></span>

<h3>Description</h3>

<p>Returns the net long wave radiation based on Crawford and Duchon, 1999.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.lw.net(ts.data, lat, atm.press)

calc.lw.net.base(dateTime, sw, Ts, lat, atm.press, airT, RH)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc.lw.net_+3A_ts.data">ts.data</code></td>
<td>
<p>Object of class <code>data.frame</code> including the required variables(see details for list of variables and their units)</p>
</td></tr>
<tr><td><code id="calc.lw.net_+3A_lat">lat</code></td>
<td>
<p>latitude in degrees north</p>
</td></tr>
<tr><td><code id="calc.lw.net_+3A_atm.press">atm.press</code></td>
<td>
<p>atmospheric pressure in mb</p>
</td></tr>
<tr><td><code id="calc.lw.net_+3A_datetime">dateTime</code></td>
<td>
<p>vector of datetime in POSIXct format</p>
</td></tr>
<tr><td><code id="calc.lw.net_+3A_sw">sw</code></td>
<td>
<p>numeric value of short wave radiation, W/m2</p>
</td></tr>
<tr><td><code id="calc.lw.net_+3A_ts">Ts</code></td>
<td>
<p>numeric value of surface water temperature, degC</p>
</td></tr>
<tr><td><code id="calc.lw.net_+3A_airt">airT</code></td>
<td>
<p>numeric value of air temperature, degC</p>
</td></tr>
<tr><td><code id="calc.lw.net_+3A_rh">RH</code></td>
<td>
<p>numeric value of relative humidity, %</p>
</td></tr>
</table>


<h3>Value</h3>

<p>## for calc.lw.net.base
</p>
<p>A numeric value of net long wave heat flux in W/m^2
</p>
<p>## for calc.lw.net
</p>
<p>A data.frame with columns <code>datetime</code> and <code>lwnet</code> in W/m^2
</p>


<h3>Author(s)</h3>

<p>R Iestyn Woolway
Jordan S. Read
Hilary Dugan
Luke Winslow
</p>


<h3>References</h3>

<p>Crawford, T.M., and Duchon, C.E. 1999. <em>An improved parameterization for 
estimating effective atmospheric emissivity for use in calculating daytime 
downwelling longwave radiation</em>. Journal of Applied Meteorology 38: 474-480.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+k.read">k.read</a></code> and <code><a href="#topic+k.macIntyre">k.macIntyre</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Base example
dateTime &lt;- as.POSIXct("2013-12-30 23:00")
Uz &lt;- 3
airT &lt;- 20
RH &lt;- 90
sw &lt;- 800
wndZ &lt;- 2
Kd &lt;- 2
lat &lt;- 54
lake.area &lt;- 5000 
atm.press &lt;- 1013
Ts &lt;- 22
calc.lw.net.base(dateTime,sw,Ts,lat,atm.press,airT,RH)

## Example using timeseries in a data frame
data.path = system.file('extdata', package="LakeMetabolizer")

sp.data = load.all.data('sparkling', data.path)

# Prep the input data
ts.data	= sp.data$data #pull out just the timeseries data
atm.press	= 1018
lat	= sp.data$metadata$latitude

lwnet = calc.lw.net(ts.data, lat, atm.press)
plot(lwnet$datetime, lwnet$lwnet)

</code></pre>

<hr>
<h2 id='calc.zeng'>Estimate sensible and latent heat fluxes</h2><span id='topic+calc.zeng'></span>

<h3>Description</h3>

<p>Returns the sensible and latent heat fluxed based on Zeng et al, 1998'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.zeng(dateTime,Ts,airT,Uz,RH,atm.press,wnd.z,airT.z,RH.z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc.zeng_+3A_datetime">dateTime</code></td>
<td>
<p>vector of datetime in POSIXct format</p>
</td></tr>
<tr><td><code id="calc.zeng_+3A_ts">Ts</code></td>
<td>
<p>numeric value of surface water temperature, degC</p>
</td></tr>
<tr><td><code id="calc.zeng_+3A_airt">airT</code></td>
<td>
<p>numeric value of air temperature, degC</p>
</td></tr>
<tr><td><code id="calc.zeng_+3A_uz">Uz</code></td>
<td>
<p>numeric value of wind speed, m/s</p>
</td></tr>
<tr><td><code id="calc.zeng_+3A_rh">RH</code></td>
<td>
<p>numeric value of relative humidity, %</p>
</td></tr>
<tr><td><code id="calc.zeng_+3A_atm.press">atm.press</code></td>
<td>
<p>atmospheric pressure in mb</p>
</td></tr>
<tr><td><code id="calc.zeng_+3A_wnd.z">wnd.z</code></td>
<td>
<p>height of wind measurement, m</p>
</td></tr>
<tr><td><code id="calc.zeng_+3A_airt.z">airT.z</code></td>
<td>
<p>height of air temperature measurement, m (optional)</p>
</td></tr>
<tr><td><code id="calc.zeng_+3A_rh.z">RH.z</code></td>
<td>
<p>height of relative humidity measurement, m (optional)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame including sensible and latent heat flux estimates, and other variables used in calculating these fluxes.
</p>


<h3>Author(s)</h3>

<p>R. Iestyn. Woolway
</p>


<h3>References</h3>

<p>Zeng, X., M. Zhao., and Dickinson, R.E. 1998. <em>Intercomparison of bulk aerodynamic algorithms 
for the computation of sea surface fluxes using TOGA COARE and TAO data</em>. Journal of Climate 11: 2628-2644.
</p>


<h3>See Also</h3>

<p><a href="#topic+k.read">k.read</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dateTime &lt;- as.POSIXct("2013-12-30 23:00")
Ts &lt;- 22.51
airT &lt;- 20
Uz &lt;- 3  
RH &lt;- 90
atm.press &lt;- 1013
wnd.z &lt;- 2
calc.zeng(dateTime,Ts,airT,Uz,RH,atm.press,wnd.z)
</code></pre>

<hr>
<h2 id='get.Ts'>gets surface water temperatures</h2><span id='topic+get.Ts'></span>

<h3>Description</h3>

<p>grabs best available data for surface water temperature
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.Ts(data, s.range = c(0, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.Ts_+3A_data">data</code></td>
<td>
<p>Object of class data.frame</p>
</td></tr>
<tr><td><code id="get.Ts_+3A_s.range">s.range</code></td>
<td>
<p>a numeric vector of length=2 with the range for depth measurements to still be considered 'surface'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class data.frame
</p>


<h3>Author(s)</h3>

<p>Jordan S. Read
</p>


<h3>See Also</h3>

<p><a href="#topic+has.vars">has.vars</a>
<a href="#topic+get.vars">get.vars</a>
<a href="#topic+rmv.vars">rmv.vars</a>
</p>

<hr>
<h2 id='get.vars'>subsets data.frame according to header names</h2><span id='topic+get.vars'></span>

<h3>Description</h3>

<p>subsets <code>data</code> according to header names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.vars(data, var.names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.vars_+3A_data">data</code></td>
<td>
<p>Object of class data.frame</p>
</td></tr>
<tr><td><code id="get.vars_+3A_var.names">var.names</code></td>
<td>
<p>A character vector of names to get from <code>data</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class data.frame
</p>


<h3>Author(s)</h3>

<p>Luke A. Winslow
</p>


<h3>See Also</h3>

<p><a href="#topic+has.vars">has.vars</a>
<a href="#topic+rmv.vars">rmv.vars</a>
</p>

<hr>
<h2 id='getSchmidt'>Returns Schmidt number for a specific gas at a given temperature</h2><span id='topic+getSchmidt'></span>

<h3>Description</h3>

<p>Schmidt number is temperature dependant, and is the ratio of the kinematic viscosity of water 
to a diffusion coefficient. Coefficients are included for He, O2, CO2, CH4, SF6, N2O, Ar, and N2.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSchmidt(temperature, gas)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSchmidt_+3A_temperature">temperature</code></td>
<td>
<p>Numeric vector of water temperatures in deg. Celsius</p>
</td></tr>
<tr><td><code id="getSchmidt_+3A_gas">gas</code></td>
<td>
<p>String for gas code. Valid inputs include: He, O2, CO2, CH4, SF6, N2O, Ar, and N2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Schmidt number (unitless)
</p>


<h3>Note</h3>

<p>Temperature range is only valid from 4-35 deg Celsius
</p>


<h3>Author(s)</h3>

<p>Jordan S. Read
</p>


<h3>References</h3>

<p>Raymond, Peter A., Christopher J. Zappa, David Butman, Thomas L. Bott, Jody Potter, Patrick Mulholland, 
Andrew E. Laursen, William H. McDowell, and Denis Newbold. <em>Scaling the gas transfer velocity and hydraulic 
geometry in streams and small rivers</em>. Limnology &amp; Oceanography: Fluids &amp; Environments 2 (2012): 41-53.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>getSchmidt(temperature=12, gas="O2")
</code></pre>

<hr>
<h2 id='has.vars'>tests data.frame for column names</h2><span id='topic+has.vars'></span>

<h3>Description</h3>

<p>tests <code>data</code> for data column names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>has.vars(data, var.names)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="has.vars_+3A_data">data</code></td>
<td>
<p>Object of class data.frame</p>
</td></tr>
<tr><td><code id="has.vars_+3A_var.names">var.names</code></td>
<td>
<p>A character vector of names to test against <code>data</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a boolean vector of same length as <code>var.names</code>
</p>


<h3>Author(s)</h3>

<p>Luke A. Winslow
</p>


<h3>See Also</h3>

<p><a href="#topic+get.vars">get.vars</a>
<a href="#topic+rmv.vars">rmv.vars</a>
</p>

<hr>
<h2 id='is.day'>determines if measurement was taken during the daytime</h2><span id='topic+is.day'></span>

<h3>Description</h3>

<p>determines if measurement was taken during the daytime
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.day(datetimes, lat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.day_+3A_datetimes">datetimes</code></td>
<td>
<p>Vector of dates as <code>POSIXct</code> or <code>POSIXlt</code> (see <code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code>) format</p>
</td></tr>
<tr><td><code id="is.day_+3A_lat">lat</code></td>
<td>
<p>Single latitude value of site. South should be negative, north positive</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a boolean vector of same length as <code>datetimes</code>
</p>


<h3>Author(s)</h3>

<p>Luke A. Winslow
</p>


<h3>See Also</h3>

<p><a href="#topic+is.night">is.night</a>
<a href="#topic+sun.rise.set">sun.rise.set</a>
</p>

<hr>
<h2 id='is.night'>determines if measurement was taken during the night</h2><span id='topic+is.night'></span>

<h3>Description</h3>

<p>determines if measurement was taken during the nighttime
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.night(datetimes, lat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.night_+3A_datetimes">datetimes</code></td>
<td>
<p>Vector of dates as <code>POSIXct</code> or <code>POSIXlt</code> (see <code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code>) format</p>
</td></tr>
<tr><td><code id="is.night_+3A_lat">lat</code></td>
<td>
<p>Single latitude value of site. South should be negative, north positive</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a boolean vector of same length as <code>datetimes</code>
</p>


<h3>Author(s)</h3>

<p>Luke A. Winslow
</p>


<h3>See Also</h3>

<p><a href="#topic+is.day">is.day</a>
<a href="#topic+sun.rise.set">sun.rise.set</a>
</p>

<hr>
<h2 id='k.read'>Returns a timeseries of gas exchange velocity</h2><span id='topic+k.read'></span><span id='topic+k.read.soloviev'></span><span id='topic+k.cole'></span><span id='topic+k.macIntyre'></span><span id='topic+k.crusius'></span><span id='topic+k.vachon'></span><span id='topic+k.heiskanen'></span>

<h3>Description</h3>

<p>Returns the gas exchange velocity based on the chosen model in units of m/day
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k.cole(ts.data)

k.crusius(ts.data, method='power')

k.read(ts.data, wnd.z, Kd, atm.press, lat, lake.area)

k.read.soloviev(ts.data, wnd.z, Kd, atm.press, lat, lake.area)

k.macIntyre(ts.data, wnd.z, Kd, atm.press,params=c(1.2,0.4872,1.4784))

k.vachon(ts.data, lake.area, params=c(2.51,1.48,0.39))

k.heiskanen(ts.data, wnd.z, Kd, atm.press)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="k.read_+3A_ts.data">ts.data</code></td>
<td>
<p>vector of datetime in POSIXct format</p>
</td></tr>
<tr><td><code id="k.read_+3A_wnd.z">wnd.z</code></td>
<td>
<p>height of wind measurement, m</p>
</td></tr>
<tr><td><code id="k.read_+3A_kd">Kd</code></td>
<td>
<p>Light attenuation coefficient (Units:m^-1)</p>
</td></tr>
<tr><td><code id="k.read_+3A_atm.press">atm.press</code></td>
<td>
<p>atmospheric pressure in mb</p>
</td></tr>
<tr><td><code id="k.read_+3A_lat">lat</code></td>
<td>
<p>Latitude, degrees north</p>
</td></tr>
<tr><td><code id="k.read_+3A_lake.area">lake.area</code></td>
<td>
<p>Lake area, m^2</p>
</td></tr>
<tr><td><code id="k.read_+3A_method">method</code></td>
<td>
<p>Only for <a href="#topic+k.crusius">k.crusius</a>. String of valid method . Either &quot;linear&quot;, &quot;bilinear&quot;, or &quot;power&quot;</p>
</td></tr>
<tr><td><code id="k.read_+3A_params">params</code></td>
<td>
<p>Only for <a href="#topic+k.vachon.base">k.vachon.base</a> and <a href="#topic+k.macIntyre">k.macIntyre</a>. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Can change default parameters of MacIntyre and Vachon models. Default for Vachon is
c(2.51,1.48,0.39). Default for MacIntyre is c(1.2,0.4872,1.4784). Heiskanen 2014 uses MacIntyre
model with c(0.5,0.77,0.3) and z.aml constant at 0.15.
</p>


<h3>Value</h3>

<p>Returns a data.frame with a datetime column and a k600 column. k600 is in units of meters per day (m/d).
</p>


<h3>Author(s)</h3>

<p>Hilary Dugan, Jake Zwart, Luke Winslow, R. Iestyn. Woolway, Jordan S. Read
</p>


<h3>References</h3>

<p>Cole, J., J. Nina, and F. Caraco. <em>Atmospheric exchange of carbon dioxide
in a low-wind oligotrophic lake measured by the addition of SF~ 6</em>.
Limnology and Oceanography 43 (1998): 647-656.
</p>
<p>MacIntyre, Sally, Anders Jonsson, Mats Jansson, Jan Aberg, Damon E. Turney,
and Scott D. Miller. <em>Buoyancy flux, turbulence, and the gas transfer
coefficient in a stratified lake</em>. Geophysical Research Letters 37, no. 24 (2010).
</p>
<p>Read, Jordan S., David P. Hamilton, Ankur R. Desai, Kevin C. Rose, Sally MacIntyre,
John D. Lenters, Robyn L. Smyth et al. <em>Lake-size dependency of wind shear and convection
as controls on gas exchange</em>. Geophysical Research Letters 39, no. 9 (2012).
</p>
<p>Crusius, John, and Rik Wanninkhof. <em>Gas transfer velocities measured at low
wind speed over a lake</em>. Limnology and Oceanography 48, no. 3 (2003): 1010-1017.
</p>
<p>Dominic Vachon and Yves T. Prairie. <em>The ecosystem size and shape dependence
of gas transfer velocity versus wind speed relationships in lakes</em>.
Can. J. Fish. Aquat. Sci. 70 (2013): 1757-1764.
</p>
<p>Jouni J. Heiskanen, Ivan Mammarella, Sami Haapanala, Jukka Pumpanen, Timo Vesala, Sally MacIntyre
Anne Ojala.<em> Effects of cooling and internal wave motions on gas
transfer coefficients in a boreal lake</em>. Tellus B 66, no.22827 (2014)
</p>
<p>Alexander Soloviev, Mark Donelan, Hans Graber, Brian Haus, Peter Schlussel.
<em>An approach to estimation of near-surface turbulence and CO2 transfer
velocity from remote sensing data</em>. Journal of Marine Systems 66, (2007): 182-194.
</p>


<h3>See Also</h3>

<p><a href="#topic+k.cole">k.cole</a>
<a href="#topic+k.crusius">k.crusius</a>
<a href="#topic+k.macIntyre">k.macIntyre</a>
<a href="#topic+k.vachon">k.vachon</a>
<a href="#topic+k.heiskanen">k.heiskanen</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data.path = system.file('extdata', package="LakeMetabolizer")

tb.data = load.all.data('sparkling', data.path)

ts.data = tb.data$data #pull out just the timeseries data

#calculate U10 and add it back onto the original

u10 = wind.scale(ts.data)
ts.data = rmv.vars(ts.data, 'wnd', ignore.offset=TRUE) #drop old wind speed column
ts.data = merge(ts.data, u10)                          #merge new u10 into big dataset


k600_cole = k.cole(ts.data)

k600_crusius = k.crusius(ts.data)

kd        = tb.data$metadata$averagekd
wnd.z      = 10   #because we converted to u10
atm.press  = 1018
lat       = tb.data$metadata$latitude
lake.area = tb.data$metadata$lakearea

#for k.read and k.macIntyre, we need LW_net.
#Calculate from the observations we have available.

lwnet = calc.lw.net(ts.data, lat, atm.press)
ts.data = merge(ts.data, lwnet)

k600_read = k.read(ts.data, wnd.z=wnd.z, Kd=kd, atm.press=atm.press,
lat=lat, lake.area=lake.area)

k600_soloviev = k.read.soloviev(ts.data, wnd.z=wnd.z, Kd=kd,
atm.press=atm.press, lat=lat, lake.area=lake.area)

k600_macIntyre = k.macIntyre(ts.data, wnd.z=wnd.z, Kd=kd, atm.press=atm.press)

</code></pre>

<hr>
<h2 id='k.read.base'>Returns a timeseries of gas exchange velocity</h2><span id='topic+k.read.base'></span><span id='topic+k.read.soloviev.base'></span><span id='topic+k.cole.base'></span><span id='topic+k.macIntyre.base'></span><span id='topic+k.crusius.base'></span><span id='topic+k.vachon.base'></span><span id='topic+k.heiskanen.base'></span>

<h3>Description</h3>

<p>Returns the gas exchange velocity based on the chosen model in units of m/day
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k.cole.base(wnd)

k.crusius.base(wnd, method='power')

k.read.base(wnd.z, Kd, lat, lake.area, atm.press, dateTime, Ts, z.aml,
airT, wnd, RH, sw, lwnet)

k.read.soloviev.base(wnd.z, Kd, lat, lake.area, atm.press, dateTime, Ts, z.aml,
airT, wnd, RH, sw, lwnet)

k.macIntyre.base(wnd.z, Kd, atm.press, dateTime, Ts, z.aml, airT, wnd, RH, sw,
lwnet, params=c(1.2,0.4872,1.4784))

k.vachon.base(wnd, lake.area, params=c(2.51,1.48,0.39))

k.heiskanen.base(wnd.z, Kd, atm.press, dateTime, Ts, z.aml, airT, wnd, RH, sw, lwnet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="k.read.base_+3A_wnd.z">wnd.z</code></td>
<td>
<p>Height of wind measurement, (Units: m)</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_kd">Kd</code></td>
<td>
<p>Light attenuation coefficient (Units: m^-1)</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_lat">lat</code></td>
<td>
<p>Latitude, degrees north</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_lake.area">lake.area</code></td>
<td>
<p>Lake area, m^2</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_atm.press">atm.press</code></td>
<td>
<p>Atmospheric pressure, (Units: millibar)</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_datetime">dateTime</code></td>
<td>
<p>datetime (Y-%m-%d %H:%M), (Format: <code><a href="base.html#topic+POSIXct">POSIXct</a></code>)</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_ts">Ts</code></td>
<td>
<p>Numeric vector of surface water temperature, (Units(deg C)</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_z.aml">z.aml</code></td>
<td>
<p>Numeric vector of actively mixed layer depths. Must be the same length as the Ts parameter</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_airt">airT</code></td>
<td>
<p>Numeric value of air temperature, Units(deg C)</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_wnd">wnd</code></td>
<td>
<p>Numeric value of wind speed, (Units:m/s)</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_rh">RH</code></td>
<td>
<p>Numeric value of relative humidity, %</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_sw">sw</code></td>
<td>
<p>Numeric value of short wave radiation, W m^-2</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_lwnet">lwnet</code></td>
<td>
<p>Numeric value net long wave radiation, W m^-2</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_method">method</code></td>
<td>
<p>Only for <a href="#topic+k.crusius.base">k.crusius.base</a>. String of valid method . Either &quot;constant&quot;, &quot;bilinear&quot;, or &quot;power&quot;</p>
</td></tr>
<tr><td><code id="k.read.base_+3A_params">params</code></td>
<td>
<p>Optional parameter input, only for <a href="#topic+k.vachon.base">k.vachon.base</a> and <a href="#topic+k.macIntyre.base">k.macIntyre.base</a>. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Can change default parameters of MacIntyre and Vachon models. Default for Vachon is
c(2.51,1.48,0.39). Default for MacIntyre is c(1.2,0.4872,1.4784). Heiskanen et al. (2014) uses MacIntyre
model with c(0.5,0.77,0.3) and z.aml constant at 0.15.
</p>


<h3>Value</h3>

<p>Numeric value of gas exchange velocity (k600) in units of m/day. Before use,
should be converted to appropriate gas using <a href="#topic+k600.2.kGAS">k600.2.kGAS</a>.
</p>


<h3>Author(s)</h3>

<p>R. Iestyn. Woolway, Hilary Dugan, Luke Winslow, Jordan S Read, GLEON fellows
</p>


<h3>References</h3>

<p>Cole, J., J. Nina, and F. Caraco. <em>Atmospheric exchange of carbon dioxide
in a low-wind oligotrophic lake measured by the addition of SF~ 6</em>.
Limnology and Oceanography 43 (1998): 647-656.
</p>
<p>MacIntyre, Sally, Anders Jonsson, Mats Jansson, Jan Aberg, Damon E. Turney,
and Scott D. Miller. <em>Buoyancy flux, turbulence, and the gas transfer
coefficient in a stratified lake</em>. Geophysical Research Letters 37, no. 24 (2010).
</p>
<p>Read, Jordan S., David P. Hamilton, Ankur R. Desai, Kevin C. Rose, Sally MacIntyre,
John D. Lenters, Robyn L. Smyth et al. <em>Lake-size dependency of wind shear and convection
as controls on gas exchange</em>. Geophysical Research Letters 39, no. 9 (2012).
</p>
<p>Crusius, John, and Rik Wanninkhof. <em>Gas transfer velocities measured at low
wind speed over a lake</em>. Limnology and Oceanography 48, no. 3 (2003): 1010-1017.
</p>
<p>Dominic Vachon and Yves T. Prairie. <em>The ecosystem size and shape dependence
of gas transfer velocity versus wind speed relationships in lakes</em>.
Can. J. Fish. Aquat. Sci. 70 (2013): 1757-1764.
</p>
<p>Jouni J. Heiskanen, Ivan Mammarella, Sami Haapanala, Jukka Pumpanen, Timo Vesala, Sally MacIntyre
Anne Ojala.<em> Effects of cooling and internal wave motions on gas
transfer coefficients in a boreal lake</em>. Tellus B 66, no.22827 (2014)
</p>
<p>Alexander Soloviev, Mark Donelan, Hans Graber, Brian Haus, Peter Schlussel.
<em>An approach to estimation of near-surface turbulence and CO2 transfer
velocity from remote sensing data</em>. Journal of Marine Systems 66, (2007): 182-194.
</p>


<h3>See Also</h3>

<p><a href="#topic+k.cole">k.cole</a>
<a href="#topic+k.read">k.read</a>
<a href="#topic+k.crusius">k.crusius</a>
<a href="#topic+k.macIntyre">k.macIntyre</a>
<a href="#topic+k.vachon">k.vachon</a>
<a href="#topic+k.heiskanen">k.heiskanen</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wnd.z &lt;- 2
Kd &lt;- 2
lat &lt;- 54
lake.area &lt;- 5000
atm.press &lt;- 1013
dateTime &lt;- as.POSIXct("2013-12-30 14:00")
Ts &lt;- 16.5
z.aml &lt;- 2.32
airT &lt;- 20
wnd &lt;- 6
RH &lt;- 90
sw &lt;- 800
lwnet &lt;- -55
timeStep &lt;- 30

U10 &lt;- wind.scale.base(wnd, wnd.z)

k600_cole &lt;- k.cole.base(U10)

k600_crusius &lt;- k.crusius.base(U10)

k600_read &lt;- k.read.base(wnd.z, Kd, lat, lake.area, atm.press,
dateTime, Ts, z.aml, airT, wnd, RH, sw, lwnet)

k600_soloviev &lt;- k.read.soloviev.base(wnd.z, Kd, lat, lake.area,
atm.press, dateTime, Ts, z.aml, airT, wnd, RH, sw, lwnet)

k600_macInytre &lt;- k.macIntyre.base(wnd.z, Kd, atm.press,
dateTime, Ts, z.aml, airT, wnd, RH, sw, lwnet)

</code></pre>

<hr>
<h2 id='k600.2.kGAS'>Returns the gas exchange velocity for gas of interest w/ no unit conversions</h2><span id='topic+k600.2.kGAS'></span><span id='topic+k600.2.kGAS.base'></span>

<h3>Description</h3>

<p>Returns the gas exchange velocity for gas of interest w/ no unit conversions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k600.2.kGAS.base(k600,temperature,gas="O2")

k600.2.kGAS(ts.data, gas="O2")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="k600.2.kGAS_+3A_k600">k600</code></td>
<td>
<p>k600 as vector array of numbers or single number</p>
</td></tr>
<tr><td><code id="k600.2.kGAS_+3A_temperature">temperature</code></td>
<td>
<p>Water temperature (deg C) as vector array of numbers or single number</p>
</td></tr>
<tr><td><code id="k600.2.kGAS_+3A_gas">gas</code></td>
<td>
<p>gas for conversion, as string (e.g., 'CO2' or 'O2')</p>
</td></tr>
<tr><td><code id="k600.2.kGAS_+3A_ts.data">ts.data</code></td>
<td>
<p>Object of class data.frame with named columns datetime and k600 and wtr (water temp in deg C). Other columns are ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric value of gas exchange velocity for gas
</p>


<h3>Author(s)</h3>

<p>Jordan S. Read
</p>


<h3>See Also</h3>

<p><a href="#topic+k.read">k.read</a> and <a href="#topic+k.read.base">k.read.base</a> for functions that calculate k600 estimates
</p>


<h3>Examples</h3>

<pre><code class='language-R'> ## single example
kO2 &lt;- k600.2.kGAS.base(k600=2.4,temperature=20.4,gas='O2')

## Timeseries example
#load data
data.path = system.file('extdata', package="LakeMetabolizer")
sp.data = load.all.data('sparkling', data.path)
ts.data = sp.data$data #pull out just the timeseries data


#calculate U10 and add it back onto the original 
u10 = wind.scale(ts.data)
ts.data = rmv.vars(ts.data, 'wnd', ignore.offset=TRUE) #drop old wind speed column
ts.data = merge(ts.data, u10)                          #merge new u10 into big dataset  

k600 = k.cole(ts.data)
ts.data = merge(k600, ts.data)

k.gas = k600.2.kGAS(ts.data, 'O2')
</code></pre>

<hr>
<h2 id='load.all.data'>Attemps to load and merge all timeseries data for a given site name</h2><span id='topic+load.all.data'></span>

<h3>Description</h3>

<p>Loads and returns all the data available in the specified directory for a given site.
All timeseries data are merged by &ldquo;datetime&rdquo; into a single <a href="base.html#topic+data.frame">data.frame</a>.
Data are identified by the column header information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load.all.data(lake.name, data.path, checkMerge=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load.all.data_+3A_lake.name">lake.name</code></td>
<td>
<p>The file prefix to be matched. For example, &ldquo;sparkling&rdquo; matches &ldquo;sparkling.wtr&rdquo; but not &ldquo;troutbog.wtr&rdquo;</p>
</td></tr>
<tr><td><code id="load.all.data_+3A_data.path">data.path</code></td>
<td>
<p>The directory to look for files</p>
</td></tr>
<tr><td><code id="load.all.data_+3A_checkmerge">checkMerge</code></td>
<td>
<p>Should check merge size before attempting to prevent potential merge problems.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two items
</p>
<table>
<tr><td><code>data</code></td>
<td>
</td></tr>
<tr><td><code>metadata</code></td>
<td>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Luke A. Winslow
</p>


<h3>See Also</h3>

<p><a href="rLakeAnalyzer.html#topic+load.ts">load.ts</a>
<a href="#topic+load.meta">load.meta</a>
</p>

<hr>
<h2 id='load.meta'>Loads a metadata file from the specified path</h2><span id='topic+load.meta'></span>

<h3>Description</h3>

<p>Parses a formatted metadata file. Useful for site-specific metadata 
that is not contained in the timeseries files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load.meta(fPath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load.meta_+3A_fpath">fPath</code></td>
<td>
<p>The file path as a string</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the metadata parsed from the file.
</p>


<h3>Author(s)</h3>

<p>Luke A Winslow
</p>


<h3>See Also</h3>

<p><a href="rLakeAnalyzer.html#topic+load.ts">load.ts</a>
<a href="#topic+load.all.data">load.all.data</a>
</p>

<hr>
<h2 id='metab'>Calculate metabolism</h2><span id='topic+metab'></span>

<h3>Description</h3>

<p>Returns daily time series of gross primary production (GPP), respiration (R), and net ecosystem production (NEP). Depending on the method used, other information may be returned as well. Calculations are made using one of 5 statistical methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metab(data, method, wtr.name="wtr", irr.name="irr", do.obs.name="do.obs", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metab_+3A_data">data</code></td>
<td>
<p>a data.frame whose columns are
</p>
<p><code>"datetime"</code> = class POSIXct vector
</p>
<p><code>"do.obs"</code> = numeric vector of oxygen concentration in mg/L
</p>
<p><code>"do.sat"</code> = numeric vector of saturated oxygen concentration in mg/L
</p>
<p><code>"k.gas"</code> = numeric vector of gas exchange coefficient values in m/day, should be 0 when depth of do.obs is deeper than z.mix
</p>
<p><code>"z.mix"</code> = numeric vector of mixing depth values in meters
</p>
<p><code>"irr"</code> = numeric vector of PAR values, arbitrary units
</p>
<p><code>"wtr"</code> = numeric vector of water temperature values, arbitrary units
</p>
<p>Columns that are not used by a particular statistical method do not need to be supplied.</p>
</td></tr>
<tr><td><code id="metab_+3A_method">method</code></td>
<td>
<p>a character string specifying one of the 5 statistical methods
(bayesian, bookkeep, kalman, ols, mle)</p>
</td></tr>
<tr><td><code id="metab_+3A_wtr.name">wtr.name</code></td>
<td>
<p>the name of the column containing temperature at the depth of do.obs (predictor variable for R)</p>
</td></tr>
<tr><td><code id="metab_+3A_irr.name">irr.name</code></td>
<td>
<p>the name of the column containing irradiance (predictor variable for GPP)</p>
</td></tr>
<tr><td><code id="metab_+3A_do.obs.name">do.obs.name</code></td>
<td>
<p>the name of the column in data containing the DO observations (in mg/L) to be used as the response variable</p>
</td></tr>
<tr><td><code id="metab_+3A_...">...</code></td>
<td>
<p>arguments to be passed on to the metabolism model specified by <code>method</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame containing columns for year, doy (day of year, julian day plus fraction of day), GPP, R, and NEP
</p>
<table>
<tr><td><code>year</code></td>
<td>
<p>integer year</p>
</td></tr>
<tr><td><code>doy</code></td>
<td>
<p>numeric, day of year + fraction of day, where the day is the julian day, and a fraction of 0.5 corresponds to noon</p>
</td></tr>
<tr><td><code>GPP</code></td>
<td>
<p>numeric, gross primary production, in units of mg O2 per liter per day. By convention, this value is positive.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>numeric, respiration, in units of mg O2 per liter per day. By convention, this value is negative</p>
</td></tr>
<tr><td><code>NEP</code></td>
<td>
<p>numeric, net ecosystem production, in units of mg O2 per liter per day. For most methods this equal GPP+R, but this is not necessarily the case for <code>"method"="bookkeep"</code></p>
</td></tr>
</table>
<p>Note that different models will have different <a href="base.html#topic+attributes">attributes</a> attached to them. See examples.
</p>


<h3>Author(s)</h3>

<p>Ryan D. Batt
</p>


<h3>See Also</h3>

<p>Metabolism models: <a href="#topic+metab.bookkeep">metab.bookkeep</a>, <a href="#topic+metab.ols">metab.ols</a>, <a href="#topic+metab.mle">metab.mle</a>, <a href="#topic+metab.kalman">metab.kalman</a>, <a href="#topic+metab.bayesian">metab.bayesian</a>
</p>
<p>For smoothing noisy temperature: <a href="#topic+temp.kalman">temp.kalman</a>
</p>
<p>To calculate do.sat: <a href="#topic+o2.at.sat">o2.at.sat</a>
</p>
<p>To calculate k.gas: <a href="#topic+k600.2.kGAS">k600.2.kGAS</a>
</p>
<p>To calculate k600 values for k.gas: <a href="#topic+k.cole">k.cole</a>, <a href="#topic+k.crusius">k.crusius</a>, <a href="#topic+k.macIntyre">k.macIntyre</a>, <a href="#topic+k.read">k.read</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# fake data
datetime &lt;- seq(as.POSIXct("2014-06-16 00:00:00", tz="GMT"),
     as.POSIXct("2014-06-17 23:55:00", tz="GMT"), length.out=288*2)
do.obs &lt;- 2*sin(2*pi*(1/288)*(1:(288*2))+1.1*pi) + 8 + rnorm(288*2, 0, 0.5)
wtr &lt;- 3*sin(2*pi*(1/288)*(1:(288*2))+pi) + 17 + rnorm(288*2, 0, 0.15)
do.sat &lt;- LakeMetabolizer::o2.at.sat.base(wtr, 960)
irr &lt;- (1500*sin(2*pi*(1/288)*(1:(288*2))+1.5*pi) +650 + rnorm(288*2, 0, 0.25)) *
     ifelse(is.day(datetime, 42.3), 1, 0)
k.gas &lt;- 0.4
z.mix &lt;- 1

# plot time series
plot(wtr, type="l", xaxt="n", yaxt="n", xlab="", ylab="")
par(new=TRUE); plot(do.obs, type="l", col="blue", xaxt="n", yaxt="n", xlab="", ylab="")
par(new=TRUE); plot(irr, type="l", col="orange", xaxt="n", yaxt="n", xlab="", ylab="")
abline(v=144, lty="dotted")
abline(v=288)
legend("topleft", legend=c("wtr", "do.obs", "irr"), lty=1,
     col=c("black", "blue", "orange"), inset=c(0.08, 0.01))

# put data in a data.frame
data &lt;- data.frame(datetime=datetime, do.obs=do.obs, do.sat=do.sat, k.gas=k.gas,
     z.mix=z.mix, irr=irr, wtr=wtr)

# run each metabolism model
m.bk &lt;- metab(data, "bookkeep", lake.lat=42.6)
 m.bk &lt;- metab(data, lake.lat=42.6) # no method defaults to "bookeep"
m.ols &lt;- metab(data, "ols", lake.lat=42.6)
m.mle &lt;- metab(data, "mle", lake.lat=42.6)
m.kal &lt;- metab(data, "kalman", lake.lat=42.6)
## Not run: m.bay &lt;- metab(data, "bayesian", lake.lat=42.6)

# example attributes
names(attributes(m.ols))
attr(m.ols, "mod")

# To get full JAGS model
# including posterior draws:
## Not run: names(attributes(m.bay))
## Not run: attr(m.bay, "model")

</code></pre>

<hr>
<h2 id='metab.bayesian'>Metabolism model based on a bayesian parameter estimation framework</h2><span id='topic+metab.bayesian'></span>

<h3>Description</h3>

<p>This function runs the bayesian metabolism model on the supplied
gas concentration and other supporting data. This allows for both estimates of
metabolism along with uncertainty around the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metab.bayesian(do.obs, do.sat, k.gas, z.mix, irr, wtr, priors, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metab.bayesian_+3A_do.obs">do.obs</code></td>
<td>
<p>Vector of dissovled oxygen concentration observations, mg L^-1</p>
</td></tr>
<tr><td><code id="metab.bayesian_+3A_do.sat">do.sat</code></td>
<td>
<p>Vector of dissolved oxygen saturation values based on water temperature. Calculate using <a href="#topic+o2.at.sat">o2.at.sat</a></p>
</td></tr>
<tr><td><code id="metab.bayesian_+3A_k.gas">k.gas</code></td>
<td>
<p>Vector of kGAS values calculated from any of the gas flux models
(e.g., <a href="#topic+k.cole">k.cole</a>) and converted to kGAS using <a href="#topic+k600.2.kGAS">k600.2.kGAS</a></p>
</td></tr>
<tr><td><code id="metab.bayesian_+3A_z.mix">z.mix</code></td>
<td>
<p>Vector of mixed-layer depths in meters. To calculate, see <a href="rLakeAnalyzer.html#topic+ts.meta.depths">ts.meta.depths</a></p>
</td></tr>
<tr><td><code id="metab.bayesian_+3A_irr">irr</code></td>
<td>
<p>Vector of photosynthetically active radiation in <code class="reqn">\mu mol\ m^{-2} s^{-1}</code></p>
</td></tr>
<tr><td><code id="metab.bayesian_+3A_wtr">wtr</code></td>
<td>
<p>Vector of water temperatures in <code class="reqn">^{\circ}C</code>. Used in scaling respiration with temperature</p>
</td></tr>
<tr><td><code id="metab.bayesian_+3A_priors">priors</code></td>
<td>
<p>Parameter priors supplied as a named numeric vector (example: c(&quot;gppMu&quot;=0, &quot;gppSig2&quot;=1E5, &quot;rMu&quot;=0, &quot;rSig2&quot;=1E5, &quot;kSig2&quot;=NA))</p>
</td></tr>
<tr><td><code id="metab.bayesian_+3A_...">...</code></td>
<td>
<p>additional arguments; currently &quot;datetime&quot; is the only recognized argument passed through <code>...</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of length 4 with components:
</p>
<table>
<tr><td><code>model</code></td>
<td>
<p>the jags model, including posterior draws (see <a href="R2jags.html#topic+jags">jags</a>)</p>
</td></tr>
<tr><td><code>params</code></td>
<td>
<p>parameter estimates of interest from model (medians)</p>
</td></tr>
<tr><td><code>metab.sd</code></td>
<td>
<p>standard deviation of metabolism estimates</p>
</td></tr>
<tr><td><code>metab</code></td>
<td>
<p>daily metabolism estimates as a data.frame with columns corresponding to
</p>

<dl>
<dt><code>GPP</code></dt><dd><p>numeric estimate of Gross Primary Production, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
<dt><code>R</code></dt><dd><p>numeric estimate of Respiration, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
<dt><code>NEP</code></dt><dd><p>numeric estimate of Net Ecosystem production, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
</dl>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ryan Batt, Luke A. Winslow
</p>


<h3>References</h3>

<p>Holtgrieve, Gordon W., Daniel E. Schindler, Trevor a. Branch, and Z. Teresa A'mar.
2010. <em>Simultaneous Quantification of Aquatic Ecosystem Metabolism and Reaeration
Using a Bayesian Statistical Model of Oxygen Dynamics</em>.
Limnology and Oceanography 55 (3): 1047-1062. doi:10.4319/lo.2010.55.3.1047.
http://www.aslo.org/lo/toc/vol_55/issue_3/1047.html.
</p>


<h3>See Also</h3>

<p><a href="#topic+metab.mle">metab.mle</a>, <a href="#topic+metab.bookkeep">metab.bookkeep</a>, <a href="#topic+metab.kalman">metab.kalman</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(rLakeAnalyzer)

doobs = load.ts(system.file('extdata',
                           'sparkling.doobs', package="LakeMetabolizer"))
wtr = load.ts(system.file('extdata',
                         'sparkling.wtr', package="LakeMetabolizer"))
wnd = load.ts(system.file('extdata',
                         'sparkling.wnd', package="LakeMetabolizer"))
irr = load.ts(system.file('extdata',
                         'sparkling.par', package="LakeMetabolizer"))

#Subset a day
mod.date = as.POSIXct('2009-07-08', 'GMT')
doobs = doobs[trunc(doobs$datetime, 'day') == mod.date, ]
wtr = wtr[trunc(wtr$datetime, 'day') == mod.date, ]
wnd = wnd[trunc(wnd$datetime, 'day') == mod.date, ]
irr = irr[trunc(irr$datetime, 'day') == mod.date, ]

k600 = k.cole.base(wnd[,2])
k.gas = k600.2.kGAS.base(k600, wtr[,3], 'O2')
do.sat = o2.at.sat(wtr[,1:2], altitude=300)

metab.bayesian(irr=irr[,2], z.mix=rep(1, length(k.gas)),
              do.sat=do.sat[,2], wtr=wtr[,2],
              k.gas=k.gas, do.obs=doobs[,2])

## End(Not run)
</code></pre>

<hr>
<h2 id='metab.bookkeep'>Metabolism model based on simple day/night summation NEP-interpreted changes in DO.</h2><span id='topic+metab.bookkeep'></span>

<h3>Description</h3>

<p>This model is a simple model based on the assumption that movements in DO during 
the day are due to NEP and gas exchange. Respiration is estimated from night-time decreases. 
GPP is calculated from the algebraic manipulation of NEP and R. Based on Cole et al 2000.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metab.bookkeep(do.obs, do.sat, k.gas, z.mix, irr, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metab.bookkeep_+3A_do.obs">do.obs</code></td>
<td>
<p>Vector of dissovled oxygen concentration observations, mg L^-1</p>
</td></tr>
<tr><td><code id="metab.bookkeep_+3A_do.sat">do.sat</code></td>
<td>
<p>Vector of dissolved oxygen saturation values based on water temperature. Calculate using <a href="#topic+o2.at.sat">o2.at.sat</a></p>
</td></tr>
<tr><td><code id="metab.bookkeep_+3A_k.gas">k.gas</code></td>
<td>
<p>Vector of kGAS values calculated from any of the gas flux models 
(e.g., <a href="#topic+k.cole">k.cole</a>) and converted to kGAS using <a href="#topic+k600.2.kGAS">k600.2.kGAS</a></p>
</td></tr>
<tr><td><code id="metab.bookkeep_+3A_z.mix">z.mix</code></td>
<td>
<p>Vector of mixed-layer depths in meters. To calculate, see <a href="rLakeAnalyzer.html#topic+ts.meta.depths">ts.meta.depths</a></p>
</td></tr>
<tr><td><code id="metab.bookkeep_+3A_irr">irr</code></td>
<td>
<p>Integer vector of 1's (daytime) and 0's (nighttime), or numeric vector of irradiance that will be converted to boolean 1's and 0's if &quot;datetime&quot; is passed via <code>...</code></p>
</td></tr>
<tr><td><code id="metab.bookkeep_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed, particularly <code>POSIXct</code> class &quot;datetime&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with columns corresponding to components of metabolism 
</p>

<dl>
<dt>GPP</dt><dd><p>numeric estimate of Gross Primary Production, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
<dt>R</dt><dd><p>numeric estimate of Respiration, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
<dt>NEP</dt><dd><p>numeric estimate of Net Ecosystem production, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>R. Iestyn Woolway, Hilary Dugan, Luke A Winslow, Ryan Batt, Jordan S Read, GLEON fellows
</p>


<h3>References</h3>

<p>Cole, Jonathan J., Michael L. Pace, Stephen R. Carpenter, and James F. Kitchell. 2000. 
<em>Persistence of Net Heterotrophy in Lakes during Nutrient Addition and Food Web Manipulations</em>. 
Limnology and Oceanography 45 (8): 1718-1730. doi:10.4319/lo.2000.45.8.1718.
</p>


<h3>See Also</h3>

<p><a href="#topic+metab.bayesian">metab.bayesian</a>, <a href="#topic+metab.mle">metab.mle</a>, <a href="#topic+metab.kalman">metab.kalman</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(rLakeAnalyzer)
Sys.setenv(TZ='GMT')

doobs = load.ts(system.file('extdata', 
                           'sparkling.doobs', package="LakeMetabolizer"))
wtr = load.ts(system.file('extdata', 
                         'sparkling.wtr', package="LakeMetabolizer"))
wnd = load.ts(system.file('extdata', 
                         'sparkling.wnd', package="LakeMetabolizer"))

#Subset a day
mod.date = as.POSIXct('2009-07-08', 'GMT')
doobs = doobs[trunc(doobs$datetime, 'day') == mod.date, ]
wtr = wtr[trunc(wtr$datetime, 'day') == mod.date, ]
wnd = wnd[trunc(wnd$datetime, 'day') == mod.date, ]

k.gas = k600.2.kGAS.base(k.cole.base(wnd[,2]), wtr[,3], 'O2')
do.sat = o2.at.sat.base(wtr[,3], altitude=300)

# Must supply 1 for daytime timesteps and 0 for nighttime timesteps
irr = as.integer(is.day(doobs[,1], 45))

metab.bookkeep(doobs[,2], do.sat, k.gas, z.mix=1, irr, datetime=doobs$datetime)
</code></pre>

<hr>
<h2 id='metab.kalman'>Metabolism calculated from parameters estimated using a Kalman filter</h2><span id='topic+metab.kalman'></span>

<h3>Description</h3>

<p>A state space model accounting for process and observation error, with the maximum likelihood of parameteres estimated using a Kalman filter.
Also provides a smoothed time series of oxygen concentration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metab.kalman(do.obs, do.sat, k.gas, z.mix, irr, wtr, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metab.kalman_+3A_do.obs">do.obs</code></td>
<td>
<p>Vector of dissovled oxygen concentration observations, <code class="reqn">mg O[2] L^{-1}</code></p>
</td></tr>
<tr><td><code id="metab.kalman_+3A_do.sat">do.sat</code></td>
<td>
<p>Vector of dissolved oxygen saturation values based on water temperature. Calculate using <a href="#topic+o2.at.sat">o2.at.sat</a></p>
</td></tr>
<tr><td><code id="metab.kalman_+3A_k.gas">k.gas</code></td>
<td>
<p>Vector of kGAS values calculated from any of the gas flux models
(e.g., <a href="#topic+k.cole">k.cole</a>) and converted to kGAS using <a href="#topic+k600.2.kGAS">k600.2.kGAS</a></p>
</td></tr>
<tr><td><code id="metab.kalman_+3A_z.mix">z.mix</code></td>
<td>
<p>Vector of mixed-layer depths in meters. To calculate, see <a href="rLakeAnalyzer.html#topic+ts.meta.depths">ts.meta.depths</a></p>
</td></tr>
<tr><td><code id="metab.kalman_+3A_irr">irr</code></td>
<td>
<p>Vector of photosynthetically active radiation in <code class="reqn">\mu mol\ m^{-2} s^{-1}</code></p>
</td></tr>
<tr><td><code id="metab.kalman_+3A_wtr">wtr</code></td>
<td>
<p>Vector of water temperatures in <code class="reqn">^{\circ}C</code>. Used in scaling respiration with temperature</p>
</td></tr>
<tr><td><code id="metab.kalman_+3A_...">...</code></td>
<td>
<p>additional arguments; currently &quot;datetime&quot; is the only recognized argument passed through <code>...</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model has four parameters, <code class="reqn">c_1, c_2, Q, H</code>, and consists of equations involving the prediction of upcoming state conditional on information of the previous state (<code class="reqn">a_{t|t-1}</code>, <code class="reqn">P_{t|t-1}</code>), as well as updates of those predictions that are conditional upon information of the current state (<code class="reqn">a_{t|t}</code>, <code class="reqn">P_{t|t}</code>). <code class="reqn">a</code> is the
</p>
<p style="text-align: center;"><code class="reqn">v=k.gas/z.mix</code>
</p>

<p style="text-align: center;"><code class="reqn">a_t = c_1*irr_{t-1} + c_2*log_e(wtr_{t-1}) + v_{t-1}*do.sat_{t-1}</code>
</p>

<p style="text-align: center;"><code class="reqn">beta = e^{-v}</code>
</p>

<p style="text-align: center;"><code class="reqn">do.obs_t = a_t/v_{t-1} + -e^{-v_{t-1}}*a_t/v_{t-1} + beta_{t-1}*do.obs_{t-1} + epsilon_t</code>
</p>

<p>The above model is used during model fitting, but if gas flux is not integrated between time steps, those equations simplify to the following:
</p>
<p style="text-align: center;"><code class="reqn">F_{t-1} = k.gas_{t-1}*(do.sat_{t-1} - do.obs_{t-1})/z.mix_{t-1}</code>
</p>

<p style="text-align: center;"><code class="reqn">do.obs_t=do.obs_{t-1}+c_1*irr_{t-1}+c_2*log_e(wtr_{t-1}) + F_{t-1} + epsilon_t</code>
</p>

<p>The parameters are fit using maximum likelihood, and the optimization (minimization of the negative log likelihood function) is performed by <code>optim</code> using default settings.
</p>
<p>GPP is then calculated as <code>mean(c1*irr, na.rm=TRUE)*freq</code>, where <code>freq</code> is the number of observations per day, as estimated from the typical size between time steps. Thus, generally <code>freq==length(do.obs)</code>.
</p>
<p>Similarly, R is calculated as <code>mean(c2*log(wtr), na.rm=TRUE)*freq</code>.
</p>
<p>NEP is the sum of GPP and R.
</p>


<h3>Value</h3>

<p>A data.frame with columns corresponding to components of metabolism
</p>

<dl>
<dt>GPP</dt><dd><p>numeric estimate of Gross Primary Production, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
<dt>R</dt><dd><p>numeric estimate of Respiration, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
<dt>NEP</dt><dd><p>numeric estimate of Net Ecosystem production, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
</dl>

<p>Use <a href="base.html#topic+attributes">attributes</a> to access more model output:
</p>
<table>
<tr><td><code>smoothDO</code></td>
<td>
<p>smoothed time series of oxygen concentration (<code class="reqn">mg O[2] L^{-1}</code>), from Kalman smoother</p>
</td></tr>
<tr><td><code>params</code></td>
<td>
<p>parameters estimated by the Kalman filter (<code class="reqn">c_1, c_2, Q, H</code>)</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If observation error is substantial, consider applying a Kalman filter to the water temperature time series by supplying
<code>wtr</code> as the output from <a href="#topic+temp.kalman">temp.kalman</a>
</p>


<h3>Author(s)</h3>

<p>Ryan Batt, Luke A. Winslow
</p>


<h3>References</h3>

<p>Batt, Ryan D. and Stephen R. Carpenter. 2012. <em>Free-water lake metabolism:
addressing noisy time series with a Kalman filter</em>. Limnology and Oceanography: Methods 10: 20-30. doi: 10.4319/lom.2012.10.20
</p>


<h3>See Also</h3>

<p><a href="#topic+temp.kalman">temp.kalman</a>, <a href="#topic+watts.in">watts.in</a>, <a href="#topic+metab">metab</a>, <a href="#topic+metab.bookkeep">metab.bookkeep</a>, <a href="#topic+metab.ols">metab.ols</a>, <a href="#topic+metab.mle">metab.mle</a>, <a href="#topic+metab.bayesian">metab.bayesian</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(rLakeAnalyzer)
doobs &lt;- load.ts(system.file('extdata',
                            'sparkling.doobs', package="LakeMetabolizer"))
wtr &lt;- load.ts(system.file('extdata',
                          'sparkling.wtr', package="LakeMetabolizer"))
wnd &lt;- load.ts(system.file('extdata',
                          'sparkling.wnd', package="LakeMetabolizer"))
irr &lt;- load.ts(system.file('extdata',
                          'sparkling.par', package="LakeMetabolizer"))

#Subset a day
Sys.setenv(TZ='GMT')
mod.date &lt;- as.POSIXct('2009-07-08', 'GMT')
doobs &lt;- doobs[trunc(doobs$datetime, 'day') == mod.date, ]
wtr &lt;- wtr[trunc(wtr$datetime, 'day') == mod.date, ]
wnd &lt;- wnd[trunc(wnd$datetime, 'day') == mod.date, ]
irr &lt;- irr[trunc(irr$datetime, 'day') == mod.date, ]

k600 &lt;- k.cole.base(wnd[,2])
k.gas &lt;- k600.2.kGAS.base(k600, wtr[,3], 'O2')
do.sat &lt;- o2.at.sat.base(wtr[,3], altitude=300)

metab.kalman(irr=irr[,2], z.mix=rep(1, length(k.gas)),
            do.sat=do.sat, wtr=wtr[,2],
            k.gas=k.gas, do.obs=doobs[,2])
</code></pre>

<hr>
<h2 id='metab.mle'>Metabolism calculated from the maximum likelihood estimates of the parameters in a standard linear regression model</h2><span id='topic+metab.mle'></span>

<h3>Description</h3>

<p>Process-error-only model with parameters fitted via maximum likelihood estimation (MLE). This function runs the maximum likelihood metabolism model on the supplied gas concentration and other supporting data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metab.mle(do.obs, do.sat, k.gas, z.mix, irr, wtr, error.type = "OE", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metab.mle_+3A_do.obs">do.obs</code></td>
<td>
<p>Vector of dissolved oxygen concentration observations, <code class="reqn">mg O[2] L^{-1}</code></p>
</td></tr>
<tr><td><code id="metab.mle_+3A_do.sat">do.sat</code></td>
<td>
<p>Vector of dissolved oxygen saturation values based on water temperature. Calculate using <a href="#topic+o2.at.sat">o2.at.sat</a></p>
</td></tr>
<tr><td><code id="metab.mle_+3A_k.gas">k.gas</code></td>
<td>
<p>Vector of kGAS values calculated from any of the gas flux models
(e.g., <a href="#topic+k.cole">k.cole</a>) and converted to kGAS using <a href="#topic+k600.2.kGAS">k600.2.kGAS</a></p>
</td></tr>
<tr><td><code id="metab.mle_+3A_z.mix">z.mix</code></td>
<td>
<p>Vector of mixed-layer depths in meters. To calculate, see <a href="rLakeAnalyzer.html#topic+ts.meta.depths">ts.meta.depths</a></p>
</td></tr>
<tr><td><code id="metab.mle_+3A_irr">irr</code></td>
<td>
<p>Vector of photosynthetically active radiation in <code class="reqn">\mu mol\ m^{-2} s^{-1}</code></p>
</td></tr>
<tr><td><code id="metab.mle_+3A_wtr">wtr</code></td>
<td>
<p>Vector of water temperatures in <code class="reqn">^{\circ}C</code>. Used in scaling respiration with temperature</p>
</td></tr>
<tr><td><code id="metab.mle_+3A_error.type">error.type</code></td>
<td>
<p>Option specifying if model should assume pure Process Error 'PE' or Observation Error 'OE'. Defaults to observation error 'OE'.</p>
</td></tr>
<tr><td><code id="metab.mle_+3A_...">...</code></td>
<td>
<p>additional arguments; currently &quot;datetime&quot; is the only recognized argument passed through <code>...</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model has the three parameters, <code class="reqn">c_1, c_2, epsilon</code>, and has the form
</p>
<p style="text-align: center;"><code class="reqn">v=k.gas/z.mix</code>
</p>

<p style="text-align: center;"><code class="reqn">a_t = c_1*irr_{t-1} + c_2*log_e(wtr_{t-1}) + v_{t-1}*do.sat_{t-1}</code>
</p>

<p style="text-align: center;"><code class="reqn">beta = e^{-v}</code>
</p>

<p style="text-align: center;"><code class="reqn">do.obs_t = a_t/v_{t-1} + -e^{-v_{t-1}}*a_t/v_{t-1} + beta_{t-1}*do.obs_{t-1} + epsilon_t</code>
</p>

<p>The above model is used during model fitting, but if gas flux is not integrated between time steps, those equations simplify to the following:
</p>
<p style="text-align: center;"><code class="reqn">F_{t-1} = k.gas_{t-1}*(do.sat_{t-1} - do.obs_{t-1})/z.mix_{t-1}</code>
</p>

<p style="text-align: center;"><code class="reqn">do.obs_t=do.obs_{t-1}+c_1*irr_{t-1}+c_2*log_e(wtr_{t-1}) + F_{t-1} + epsilon_t</code>
</p>

<p>The parameters are fit using maximum likelihood, and the optimization (minimization of the negative log likelihood function) is performed by <code>optim</code> using default settings.
</p>
<p>GPP is then calculated as <code>mean(c1*irr, na.rm=TRUE)*freq</code>, where <code>freq</code> is the number of observations per day, as estimated from the typical size between time steps. Thus, generally <code>freq==length(do.obs)</code>.
</p>
<p>Similarly, R is calculated as <code>mean(c2*log(wtr), na.rm=TRUE)*freq</code>.
</p>
<p>NEP is the sum of GPP and R.
</p>


<h3>Value</h3>

<p>A data.frame with columns corresponding to components of metabolism
</p>

<dl>
<dt>GPP</dt><dd><p>numeric estimate of Gross Primary Production, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
<dt>R</dt><dd><p>numeric estimate of Respiration, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
<dt>NEP</dt><dd><p>numeric estimate of Net Ecosystem production, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
</dl>

<p>The maximum likelihood estimates of model parameters can be accessed via <code>attributes(metab.mle(...))[["params"]]</code>
</p>


<h3>Note</h3>

<p>Currently, missing values in any arguments will result in an error, so freq must always equal nobs.
</p>


<h3>Author(s)</h3>

<p>Luke A Winslow, Ryan Batt, GLEON Fellows
</p>


<h3>References</h3>

<p>Hanson, PC, SR Carpenter, N Kimura, C Wu, SP Cornelius, TK Kratz. 2008
<em>Evaluation of metabolism models for free-water dissolved oxygen in lakes</em>.
Limnology and Oceanography: Methods 6: 454:465.
</p>
<p>Solomon CT, DA Bruesewitz, DC Richardson, KC Rose, MC Van de Bogert, PC Hanson, TK Kratz, B Larget,
R Adrian, B Leroux Babin, CY Chiu, DP Hamilton, EE Gaiser, S Hendricks, V Istvanovics, A Laas, DM O'Donnell,
ML Pace, E Ryder, PA Staehr, T Torgersen, MJ Vanni, KC Weathers, G Zhuw. 2013.
<em>Ecosystem Respiration: Drivers of Daily Variability and Background Respiration in Lakes around the Globe</em>.
Limnology and Oceanography 58 (3): 849:866. doi:10.4319/lo.2013.58.3.0849.
</p>


<h3>See Also</h3>

<p><a href="#topic+metab">metab</a>, <a href="#topic+metab.bookkeep">metab.bookkeep</a>, <a href="#topic+metab.ols">metab.ols</a>, <a href="#topic+metab.kalman">metab.kalman</a>, <a href="#topic+metab.bayesian">metab.bayesian</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(rLakeAnalyzer)
doobs = load.ts(system.file('extdata',
                           'sparkling.doobs', package="LakeMetabolizer"))
wtr = load.ts(system.file('extdata',
                         'sparkling.wtr', package="LakeMetabolizer"))
wnd = load.ts(system.file('extdata',
                         'sparkling.wnd', package="LakeMetabolizer"))
irr = load.ts(system.file('extdata',
                         'sparkling.par', package="LakeMetabolizer"))

#Subset a day
mod.date = as.POSIXct('2009-07-08', 'GMT')
doobs = doobs[trunc(doobs$datetime, 'day') == mod.date, ]
wtr = wtr[trunc(wtr$datetime, 'day') == mod.date, ]
wnd = wnd[trunc(wnd$datetime, 'day') == mod.date, ]
irr = irr[trunc(irr$datetime, 'day') == mod.date, ]
z.mix = ts.thermo.depth(wtr)

k600 = k.cole.base(wnd[,2])
k.gas = k600.2.kGAS.base(k600, wtr[,3], 'O2')
do.sat = o2.at.sat.base(wtr[,3], altitude=300)

metab.mle(doobs[,2], do.sat, k.gas, z.mix[,2], irr[,2], wtr[,3])
</code></pre>

<hr>
<h2 id='metab.ols'>Metabolism model based on a ordinary least squares parameter estimation framework.</h2><span id='topic+metab.ols'></span>

<h3>Description</h3>

<p>This function runs the ordinary least squares metabolism model on the supplied gas concentration and other supporting data. This is a 
common approach that allows for the concurrent estimation of metabolism paramters from a timeseries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metab.ols(do.obs, do.sat, k.gas, z.mix, irr, wtr, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metab.ols_+3A_do.obs">do.obs</code></td>
<td>
<p>Vector of dissolved oxygen concentration observations, mg L^-1</p>
</td></tr>
<tr><td><code id="metab.ols_+3A_do.sat">do.sat</code></td>
<td>
<p>Vector of dissolved oxygen saturation values based on water temperature. Calculate using <a href="#topic+o2.at.sat">o2.at.sat</a></p>
</td></tr>
<tr><td><code id="metab.ols_+3A_k.gas">k.gas</code></td>
<td>
<p>Vector of kGAS values calculated from any of the gas flux models 
(e.g., <a href="#topic+k.cole">k.cole</a>) and converted to kGAS using <a href="#topic+k600.2.kGAS">k600.2.kGAS</a></p>
</td></tr>
<tr><td><code id="metab.ols_+3A_z.mix">z.mix</code></td>
<td>
<p>Vector of mixed-layer depths in meters. To calculate, see <a href="rLakeAnalyzer.html#topic+ts.meta.depths">ts.meta.depths</a></p>
</td></tr>
<tr><td><code id="metab.ols_+3A_irr">irr</code></td>
<td>
<p>Vector of photosynthetically active radiation in <code class="reqn">\mu mol\ m^{-2} s^{-1}</code></p>
</td></tr>
<tr><td><code id="metab.ols_+3A_wtr">wtr</code></td>
<td>
<p>Vector of water temperatures in <code class="reqn">^{\circ}C</code>. Used in scaling respiration with temperature</p>
</td></tr>
<tr><td><code id="metab.ols_+3A_...">...</code></td>
<td>
<p>additional arguments; currently &quot;datetime&quot; is the only recognized argument passed through <code>...</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with columns corresponding to components of metabolism 
</p>

<dl>
<dt>GPP</dt><dd><p>numeric estimate of Gross Primary Production, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
<dt>R</dt><dd><p>numeric estimate of Respiration, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
<dt>NEP</dt><dd><p>numeric estimate of Net Ecosystem production, <code class="reqn">mg O_2 L^{-1} d^{-1}</code></p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Luke A Winslow, Ryan Batt, GLEON Fellows
</p>


<h3>See Also</h3>

<p><a href="#topic+metab">metab</a>, <a href="#topic+metab.bookkeep">metab.bookkeep</a>, <a href="#topic+metab.mle">metab.mle</a>, <a href="#topic+metab.kalman">metab.kalman</a>, <a href="#topic+metab.bayesian">metab.bayesian</a>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(rLakeAnalyzer)
doobs = load.ts(system.file('extdata', 
                           'sparkling.doobs', package="LakeMetabolizer"))
wtr = load.ts(system.file('extdata', 
                         'sparkling.wtr', package="LakeMetabolizer"))
wnd = load.ts(system.file('extdata', 
                         'sparkling.wnd', package="LakeMetabolizer"))
irr = load.ts(system.file('extdata', 
                         'sparkling.par', package="LakeMetabolizer"))

#Subset a day
mod.date = as.POSIXct('2009-07-08')
doobs = doobs[trunc(doobs$datetime, 'day') == mod.date, ]
wtr = wtr[trunc(wtr$datetime, 'day') == mod.date, ]
wnd = wnd[trunc(wnd$datetime, 'day') == mod.date, ]
irr = irr[trunc(irr$datetime, 'day') == mod.date, ]
z.mix = ts.thermo.depth(wtr)

k600 = k.cole.base(wnd[,2])
k.gas = k600.2.kGAS.base(k600, wtr[,3], 'O2')
do.sat = o2.at.sat.base(wtr[,3], altitude=300)

metab.ols(doobs[,2], do.sat, k.gas, z.mix[,2], irr[,2], wtr[,3])
</code></pre>

<hr>
<h2 id='o2.at.sat'>Calculates the equilibrium saturation concentration of oxygen in water
at the supplied conditions</h2><span id='topic+o2.at.sat'></span><span id='topic+o2.at.sat.base'></span>

<h3>Description</h3>

<p>Used to calculate the equilibrium concentration of oxygen in
water. The equilibration concentration of oxygen in water varies with both
temperature, salinity, and the partial pressure of oxygen in contact with
the water (calculated from supplied elevation or barometric pressure).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>o2.at.sat(ts.data, baro, altitude = 0, salinity = 0, model = "garcia-benson")

o2.at.sat.base(
  temp,
  baro,
  altitude = 0,
  salinity = rep(0, length(temp)),
  model = "garcia-benson"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="o2.at.sat_+3A_ts.data">ts.data</code></td>
<td>
<p>Object of class data.frame with two named columns
&ldquo;datetime&rdquo; and &ldquo;wtr&rdquo; (water temp in deg C).</p>
</td></tr>
<tr><td><code id="o2.at.sat_+3A_baro">baro</code></td>
<td>
<p>barometric pressure in millibars.</p>
</td></tr>
<tr><td><code id="o2.at.sat_+3A_altitude">altitude</code></td>
<td>
<p>a numeric value indicating the elevation above mean sea level
in meters. Defaults to mean sea level. An alternative to supplying
barometric pressure.</p>
</td></tr>
<tr><td><code id="o2.at.sat_+3A_salinity">salinity</code></td>
<td>
<p>a numeric vector of salinity in PSU. Defaults to zero. Length
must be one or equal to length of temperature.</p>
</td></tr>
<tr><td><code id="o2.at.sat_+3A_model">model</code></td>
<td>
<p>the empirical model to be used. <code>"garcia-benson"</code>,
<code>"garcia"</code>, <code>"weiss"</code> and <code>"benson"</code> are the available
options. <code>"garcia-benson"</code> is our current recommendation. The models
correspond to the like-named references described below, where both
<code>"garcia"</code> and <code>"garcia-benson"</code> are from Garcia &amp; Gordon (1992).</p>
</td></tr>
<tr><td><code id="o2.at.sat_+3A_temp">temp</code></td>
<td>
<p>a numeric vector of water temperature in degrees Celsius.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DO solubility is converted from mL/L to mg/L by multiplying by
1.42905, per USGS memo 2011.03. Corrections for vapor pressure are made
according to barometric pressure as in Equations 2&amp;3 of USGS memos 81.11
and 81.15. When barometric pressure is not supplied, it is estimated from
altitude by the barometric formula as in Colt (2012).
</p>


<h3>Value</h3>

<p>The equilibration concentration at the supplied conditions in mg/L of
oxygen.
</p>


<h3>Author(s)</h3>

<p>Luke A Winslow
</p>


<h3>References</h3>

<p>Colt, John. <em>1 - Solubility of Atmospheric Gases in Freshwater.</em> In
Computation of Dissolved Gas Concentration in Water as Functions of
Temperature, Salinity and Pressure (Second Edition), edited by John Colt,
1-71. London: Elsevier, 2012.
http://www.sciencedirect.com/science/article/pii/B9780124159167000012.
</p>
<p>Garcia, H., and L. Gordon (1992), <em>Oxygen solubility in seawater: Better
fitting equations</em>, Limnol. Oceanogr., 37(6).
</p>
<p>Benson, B. B. &amp; Krause, D. (1984). <em>The concentration and isotopic
fractionation of oxygen dissolved in freshwater and seawater in equilibrium
with the atmosphere.</em> Limnology and Oceanography, 29(3), 620-632.
doi:10.4319/lo.1984.29.3.0620
</p>
<p>Staehr, Peter A., Darren Bade, Matthew C. Van de Bogert, Gregory R. Koch,
Craig Williamson, Paul Hanson, Jonathan J. Cole, and Tim Kratz. <em>Lake
Metabolism and the Diel Oxygen Technique: State of the Science.</em> Limnology
and Oceanography: Methods 8, no. 11 (November 1, 2010): 628-44.
doi:10.4319/lom.2010.8.0628
</p>
<p>USGS. <em>New Tables of Dissolved Oxygen Saturation Values.</em> Quality of
Water Branch, 1981. http://water.usgs.gov/admin/memo/QW/qw81.11.html.
</p>
<p>USGS. <em>New Tables of Dissolved Oxygen Saturation Values; Amendment of
Quality of Water Technical Memorandum No. 81.11.</em> Quality of Water Branch,
1981. http://water.usgs.gov/admin/memo/QW/qw81.15.html.
</p>
<p>USGS. <em>Change to Solubility Equations for Oxygen in Water.</em> Technical
Memorandum 2011.03. USGS Office of Water Quality, 2011.
</p>
<p>Weiss, R. (1970). <em>The solubility of nitrogen, oxygen and argon in water
and seawater</em>. Deep Sea Research and Oceanographic Abstracts, 17(4), 721-735.
doi:10.1016/0011-7471(70)90037-9
</p>


<h3>See Also</h3>

<p><a href="rLakeAnalyzer.html#topic+water.density">water.density</a>, <a href="#topic+o2.at.sat.base">o2.at.sat.base</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>temp.range = 1:25
sal.range = 1:25

par(mfrow=c(1,2))
plot(temp.range, o2.at.sat.base(temp.range), xlab='Temperature (C)',
ylab='Oxygen Saturation (mg/L)')
plot(o2.at.sat.base(rep(20,25), salinity=sal.range), xlab='Salinity (PSU)', ylab='')

</code></pre>

<hr>
<h2 id='par.to.sw'>Convert PAR to shortwave</h2><span id='topic+par.to.sw'></span><span id='topic+par.to.sw.base'></span>

<h3>Description</h3>

<p>Returns incoming shortwave radiation by converting PAR measuremt.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>par.to.sw.base(par, coeff=0.473)

par.to.sw(data, par.col='par', coeff=0.473)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="par.to.sw_+3A_data">data</code></td>
<td>
<p>Object of class data.frame with column name 'par' (units umol/m^2/sec)</p>
</td></tr>
<tr><td><code id="par.to.sw_+3A_par.col">par.col</code></td>
<td>
<p>String of alternative name for PAR column</p>
</td></tr>
<tr><td><code id="par.to.sw_+3A_coeff">coeff</code></td>
<td>
<p>Numerical coefficient to convert PAR (umol/m^2/sec) to SW (W/m^2). 
Defaults to value from Britton and Dodd (1976).</p>
</td></tr>
<tr><td><code id="par.to.sw_+3A_par">par</code></td>
<td>
<p>Numeric vector of PAR values (umol/m^2/sec)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>#For par.to.sw
</p>
<p>Object of class data.frame with column name 'sw' and other values from <code>ts.data</code>
</p>
<p>#For par.to.sw.base
</p>
<p>Numeric vector of shortwave values with units W/m^2
</p>


<h3>Author(s)</h3>

<p>LakeMetabolizer
</p>


<h3>References</h3>

<p>Britton, C. M., and J. D. Dodd. <em>Relationships of photosynthetically active radiation and shortwave irradiance.</em> 
Agricultural Meteorology 17, no. 1 (1976): 1-7.
</p>


<h3>See Also</h3>

<p><a href="#topic+sw.to.par">sw.to.par</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par &lt;- 800
par.to.sw.base(par)
</code></pre>

<hr>
<h2 id='rmv.vars'>subsets data.frame according to header names</h2><span id='topic+rmv.vars'></span>

<h3>Description</h3>

<p>subsets <code>data</code> according to header names. Excludes all matches to <code>var.name</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmv.vars(data, var.name, ignore.missing=TRUE, ignore.offset=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmv.vars_+3A_data">data</code></td>
<td>
<p>Object of class data.frame</p>
</td></tr>
<tr><td><code id="rmv.vars_+3A_var.name">var.name</code></td>
<td>
<p>A character vector of names to remove from <code>data</code></p>
</td></tr>
<tr><td><code id="rmv.vars_+3A_ignore.missing">ignore.missing</code></td>
<td>
<p>Boolean, should an error be thrown if no matching data found</p>
</td></tr>
<tr><td><code id="rmv.vars_+3A_ignore.offset">ignore.offset</code></td>
<td>
<p>Should the numerical offset be ignored in the match, (e.g. all <code>wtr</code> columns removed, or <code>wtr_0</code> specifically)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class data.frame
</p>


<h3>Author(s)</h3>

<p>Luke A. Winslow
</p>


<h3>See Also</h3>

<p><a href="#topic+has.vars">has.vars</a>
<a href="#topic+get.vars">get.vars</a>
</p>

<hr>
<h2 id='sun.rise.set'>Calculates the time of sunrise and sunset</h2><span id='topic+sun.rise.set'></span>

<h3>Description</h3>

<p>Calculates the time of sunrise and sunset based on latitude and date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sun.rise.set(datetimes, lat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sun.rise.set_+3A_datetimes">datetimes</code></td>
<td>
<p>Vector of dates as <code>POSIXct</code> or <code>POSIXlt</code> (see <code><a href="base.html#topic+DateTimeClasses">DateTimeClasses</a></code>) format</p>
</td></tr>
<tr><td><code id="sun.rise.set_+3A_lat">lat</code></td>
<td>
<p>Single latitude value of site. South should be negative, north positive</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 2-column data frame, first column sunrise, second column sunset, as <a href="base.html#topic+POSIXct">POSIXct</a> format in standard time. 
Value is NA when there is no defined sunrise or sunset for that day (winter/summer at high and low latitudes).
</p>


<h3>Author(s)</h3>

<p>Luke A. Winslow
</p>


<h3>References</h3>

<p>Iqbal, Muhammad. 1983. An Introduction to Solar Radiation. Elsevier.
</p>


<h3>See Also</h3>

<p><a href="#topic+is.night">is.night</a>
<a href="#topic+is.day">is.day</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sun.rise.set(lat=40.75,datetimes=as.POSIXlt('2013-03-31'))
</code></pre>

<hr>
<h2 id='sw.to.par'>Convert shortwave radiation to PAR</h2><span id='topic+sw.to.par'></span><span id='topic+sw.to.par.base'></span>

<h3>Description</h3>

<p>Returns PAR by converting incoming shortwave radiation measuremt.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sw.to.par(data, sw.col='sw', coeff=2.114)

sw.to.par.base(sw, coeff=2.114)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sw.to.par_+3A_data">data</code></td>
<td>
<p>Object of class data.frame with column name <code>sw</code> (or specified alternate)</p>
</td></tr>
<tr><td><code id="sw.to.par_+3A_sw.col">sw.col</code></td>
<td>
<p>Name of column containing shortwave data (units must be W/m^2)</p>
</td></tr>
<tr><td><code id="sw.to.par_+3A_coeff">coeff</code></td>
<td>
<p>Numerical coefficient to convert SW (W/m^2) to PAR (umol/m^2/sec). 
Defaults to value from Britton and Dodd (1976).</p>
</td></tr>
<tr><td><code id="sw.to.par_+3A_sw">sw</code></td>
<td>
<p>Numeric shortwave value in W/m^2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>#For sw.to.par
</p>
<p>Object of class data.frame with column name 'par' and other values from <code>ts.data</code>
</p>
<p>#for sw.to.par.base
</p>
<p>Numeric vector of PAR values in units umol/m^2/sec
</p>


<h3>Author(s)</h3>

<p>Luke Winslow and others
</p>


<h3>References</h3>

<p>Britton, C. M., and J. D. Dodd. <em>Relationships of photosynthetically active radiation and shortwave irradiance.</em> 
Agricultural Meteorology 17, no. 1 (1976): 1-7.
</p>


<h3>See Also</h3>

<p><a href="#topic+par.to.sw">par.to.sw</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#For base function
sw &lt;- 800
sw.to.par.base(sw)

</code></pre>

<hr>
<h2 id='temp.kalman'>Smooth temperature time series using a Kalman filter/ smoother</h2><span id='topic+temp.kalman'></span>

<h3>Description</h3>

<p>Smoothes a temperature time series uses a Kalman filter/ smoother.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temp.kalman(wtr, watts, ampH=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="temp.kalman_+3A_wtr">wtr</code></td>
<td>
<p>Vector (regular time series) of water temperature in degrees C</p>
</td></tr>
<tr><td><code id="temp.kalman_+3A_watts">watts</code></td>
<td>
<p>estimate of watts entering the layer at each time step, from <a href="#topic+watts.in">watts.in</a></p>
</td></tr>
<tr><td><code id="temp.kalman_+3A_amph">ampH</code></td>
<td>
<p>factor by which to artificially amplify the observation error variance, H</p>
</td></tr>
<tr><td><code id="temp.kalman_+3A_...">...</code></td>
<td>
<p>parameters to be passed to <a href="stats.html#topic+optim">optim</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>basic model process is <code>x[t] = beta*x[t-1] + c1*watts[t-1]</code>
</p>


<h3>Value</h3>

<p>a smoothed temperature time series
</p>


<h3>Author(s)</h3>

<p>Ryan Batt
</p>


<h3>References</h3>

<p>Batt, Ryan D. and Stephen R. Carpenter. 2012. <em>Free-water lake metabolism: 
addressing noisy time series with a Kalman filter</em>. Limnology and 
Oceanography: Methods 10: 20-30. doi: 10.4319/lom.2012.10.20
</p>


<h3>See Also</h3>

<p><a href="#topic+watts.in">watts.in</a> <a href="#topic+metab.kalman">metab.kalman</a>
</p>

<hr>
<h2 id='var.indx'>finds matching column names in data.frame</h2><span id='topic+var.indx'></span>

<h3>Description</h3>

<p>returns index of column matches for <code>data</code> according to header names matches with <code>var.names</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var.indx(data, var.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="var.indx_+3A_data">data</code></td>
<td>
<p>Object of class data.frame</p>
</td></tr>
<tr><td><code id="var.indx_+3A_var.name">var.name</code></td>
<td>
<p>A character vector of names to find matches with <code>data</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a boolean vector with same length as <code>var.names</code>
</p>


<h3>Author(s)</h3>

<p>Luke A. Winslow
</p>


<h3>See Also</h3>

<p><a href="#topic+has.vars">has.vars</a>
<a href="#topic+get.vars">get.vars</a>
<a href="#topic+rmv.vars">rmv.vars</a>
</p>

<hr>
<h2 id='watts.in'>
Simple estimate of energy gained by a layer of water
</h2><span id='topic+watts.in'></span>

<h3>Description</h3>

<p>Estimate the amount of energy gained by a layer of water as the difference between 
energy entering from the top of the layer and energy leaving at the bottom. 
Energy gained/ lost is calculated from photosynthetically active radiation 
(PAR, which is then converted to watts) and an estimate of kd (light attenuation coefficient) 
which is derived from the depth of 1 percent surface light.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>watts.in(top, bot, irr, z1perc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="watts.in_+3A_top">top</code></td>
<td>

<p>Depth of the top of the layer, in meters
</p>
</td></tr>
<tr><td><code id="watts.in_+3A_bot">bot</code></td>
<td>

<p>Depth of the bottom of the layer, in meters
</p>
</td></tr>
<tr><td><code id="watts.in_+3A_irr">irr</code></td>
<td>

<p>PAR in uE/s (umol / m^2 / s)
</p>
</td></tr>
<tr><td><code id="watts.in_+3A_z1perc">z1perc</code></td>
<td>

<p>Depth of 1 percent of surface light, in meters
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This rough estimate is used in the Kalman filter/ smoother for water temperature.
It does not account for a variety of potentially important factors, and is made specifically for use
with temp.kalman(), which uses maximum likelihood to fit a linear coefficient that converts this heat gain estimate
into temperature change.
</p>


<h3>Value</h3>

<p>numeric vector of estimates of energy gain 
</p>


<h3>Author(s)</h3>

<p>Ryan Batt, Luke Winslow
</p>


<h3>References</h3>

<p>Batt, Ryan D. and Stephen R. Carpenter. 2012. <em>Free-water lake metabolism: 
addressing noisy time series with a Kalman filter</em>. Limnology and Oceanography: Methods
10: 20-30. doi: 10.4319/lom.2012.10.20
</p>


<h3>See Also</h3>

<p><code><a href="#topic+temp.kalman">temp.kalman</a></code>
<code><a href="#topic+metab.kalman">metab.kalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>watts.in(3.2, 4, 1200, 4.5)
</code></pre>

<hr>
<h2 id='wind.scale'>Wind Scaling U10 - exponential conversion to 10m wind speed</h2><span id='topic+wind.scale'></span><span id='topic+wind.scale.base'></span>

<h3>Description</h3>

<p>Scale wind speed to standard U10 (10 meters) based on height of observations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Used for timeseries data in a data.frame 
wind.scale(ts.data, wnd.z)

## Used for raw numeric data
wind.scale.base(wnd, wnd.z)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wind.scale_+3A_ts.data">ts.data</code></td>
<td>
<p>Object of class data.frame containing a wnd column.</p>
</td></tr>
<tr><td><code id="wind.scale_+3A_wnd.z">wnd.z</code></td>
<td>
<p>height of anemometer (Units: meters)</p>
</td></tr>
<tr><td><code id="wind.scale_+3A_wnd">wnd</code></td>
<td>
<p>measured wind speed (Units: typically m s-1, but it is unit agnostic)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function transforms wind speed to the standard U10, 
speed at 10 meters, based on the common exponential wind profile assumption. 
wind.scale defaults to using the supplied wnd.z value. If wnd.z is not supplied, 
it attempts to determine the anemometer height from the suffix of the header 
(e.g., a header of wnd_3 would mean an anemometer height of 3 meters).
</p>


<h3>Value</h3>

<p>## wind.scale
Returns a data frame with columns datetime and wnd_10 and the same number of rows as ts.data
</p>
<p>## wind.scale.base
Returns a vector with the same length as wnd
</p>


<h3>Author(s)</h3>

<p>Aline Jaimes, Luke A. Winslow
</p>


<h3>References</h3>

<p>Saucier, W. 2003. <em>Principles of Meteorological Analysis</em>. Dover Publications. New York. p433
</p>


<h3>See Also</h3>

<p>Models of gas flux <a href="#topic+k.cole">k.cole</a>, <a href="#topic+k.crusius">k.crusius</a>, <a href="#topic+k.macIntyre">k.macIntyre</a>, &amp; <a href="#topic+k.read">k.read</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wndSpeed &lt;- c(5.1,6.3,6.3,5.2,7,7.2)
wndHeight &lt;- 2

wind.scale.base(wndSpeed, wndHeight)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
