<!DOCTYPE html><html><head><title>Help for package aspi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {aspi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aspi'><p>ASPI: Analysis of Symmetry in Parasitic Infections</p></a></li>
<li><a href='#diplostomum_eyes_excl_lenses'><p>Numbers of Diplostomum metacercariae recorded from the eyes (excluding lenses)</p>
of each of 50 ruffe.</a></li>
<li><a href='#diplostomum_lenses'><p>Numbers of Diplostomum metacercariae recorded from the lenses of the eyes</p>
of each of 50 ruffe.</a></li>
<li><a href='#eb.test'><p>Exact binomial tests</p></a></li>
<li><a href='#g.test'><p>Replicated G-tests of goodness-of-fit</p></a></li>
<li><a href='#plotHistogram'><p>Plot histogram</p></a></li>
<li><a href='#plotVolcano'><p>Volcano plot</p></a></li>
<li><a href='#simulated_asymmetry_inconsistent_bias'><p>Simulated data showing bilateral asymmetry with insconsistent bias</p></a></li>
<li><a href='#simulated_left_bias_heterogeneous_proportions'><p>Simulated data showing left bias with heterogeneous proportions</p></a></li>
<li><a href='#simulated_left_bias_homogeneous_proportions'><p>Simulated data for showing left bias with homogeneous proportions</p></a></li>
<li><a href='#simulated_symmetrical_infection'><p>Simulated data showing bilateral symmetry</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Symmetry of Parasitic Infections</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-09-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Matt Wayland</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matt Wayland &lt;mw283@cam.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for the analysis and visualization of bilateral asymmetry in parasitic infections.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-09-20 15:16:03 UTC; matt</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-09-20 18:46:39</td>
</tr>
</table>
<hr>
<h2 id='aspi'>ASPI: Analysis of Symmetry in Parasitic Infections</h2><span id='topic+aspi'></span><span id='topic+aspi-package'></span>

<h3>Description</h3>

<p>Tools for the analysis and visualization of bilateral asymmetry in
parasitic infections.
</p>


<h3>Functions</h3>


<ul>
<li><p><code>g.test</code>
</p>
</li>
<li><p><code>eb.test</code>
</p>
</li>
<li><p><code>plotHistogram</code>
</p>
</li>
<li><p><code>plotVolcano</code>
</p>
</li></ul>



<h3>Data</h3>


<ul>
<li><p><code>diplostomum_eyes_excl_lenses</code>
</p>
</li>
<li><p><code>diplostomum_lenses</code>
</p>
</li>
<li><p><code>simulated_symmetrical_infection</code>
</p>
</li>
<li><p><code>simulated_left_bias_homogeneous_proportions</code>
</p>
</li>
<li><p><code>simulated_left_bias_heterogeneous_proportions</code>
</p>
</li>
<li><p><code>simulated_asymmetry_inconsistent_bias</code>
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Wayland, <a href="mailto:mw283@cam.ac.uk">mw283@cam.ac.uk</a>
</p>

<hr>
<h2 id='diplostomum_eyes_excl_lenses'>Numbers of Diplostomum metacercariae recorded from the eyes (excluding lenses) 
of each of 50 ruffe.</h2><span id='topic+diplostomum_eyes_excl_lenses'></span>

<h3>Description</h3>

<p>A dataset containing the numbers of Diplostomum metacercariae recovered from 
the eyes (excluding lenses) of each of 50 ruffe, Gymnocephalus cernuus from 
Llyn Tegid, a mesotrophic lake in north Wales.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diplostomum_eyes_excl_lenses
</code></pre>


<h3>Format</h3>

<p>A data frame with 50 rows and 2 variables (row names are host IDs):
</p>

<dl>
<dt>left</dt><dd><p>number of metacercariae in left eye</p>
</dd>
<dt>right</dt><dd><p>number of metacercariae in the right eye</p>
</dd>
</dl>

<hr>
<h2 id='diplostomum_lenses'>Numbers of Diplostomum metacercariae recorded from the lenses of the eyes
of each of 50 ruffe.</h2><span id='topic+diplostomum_lenses'></span>

<h3>Description</h3>

<p>A dataset containing the numbers of Diplostomum metacercariae recovered from 
the lenses of the eyes of each of 50 ruffe, Gymnocephalus cernuus from
Llyn Tegid, a mesotrophic lake in north Wales.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diplostomum_lenses
</code></pre>


<h3>Format</h3>

<p>A data frame with 50 rows and 2 variables (row names are host IDs):
</p>

<dl>
<dt>left</dt><dd><p>number of metacercariae in lens of left eye</p>
</dd>
<dt>right</dt><dd><p>number of metacercariae in lens of right eye</p>
</dd>
</dl>

<hr>
<h2 id='eb.test'>Exact binomial tests</h2><span id='topic+eb.test'></span>

<h3>Description</h3>

<p>Assess symmetry of parasitic infections by performing exact binomial tests on pooled data and
individual hosts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eb.test(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eb.test_+3A_x">x</code></td>
<td>
<p>a matrix or data frame with two numeric columns;
first column is for left-side and 2nd column for right-side.
Identifiers for hosts can be provided as row names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a binomial exact tests with the null hypothesis of a 1:1 ratio. It takes
as its argument a matrix or data frame with two numeric columns; first column is for left-side
and 2nd column for right-side. Identifiers for hosts can be provided as row names. Uninfected
hosts (zero count for both left and right sides) are ignored.
</p>


<h3>Value</h3>

<p>It returns a list containing two elements:
</p>
<table>
<tr><td><code>pooled</code></td>
<td>
<p>p-value for pooled binomial exact test (null hypothesis: the ratio of the total
number of parasites from each side doesn't differ from 1:1).</p>
</td></tr>
<tr><td><code>hosts</code></td>
<td>
<p>data.frame of results of binomial exact tests performed on the distribution of
parasites in each host.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>eb.test(diplostomum_lenses)
</code></pre>

<hr>
<h2 id='g.test'>Replicated G-tests of goodness-of-fit</h2><span id='topic+g.test'></span>

<h3>Description</h3>

<p>Perform replicated G-tests of goodness-of-fit to assess symmetry of parasitic infections.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>g.test(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="g.test_+3A_x">x</code></td>
<td>
<p>a matrix or data frame with two numeric columns;
first column is for left-side and 2nd column for right-side.
Identifiers for hosts can be provided as row names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements Sokal &amp; Rohlf's (1995) G-test for the specific case of an expected 1:1 ratio
The function takes as its argument a matrix or data frame with two numeric columns; first column is for
left-side and 2nd column for right-side. Identifiers for hosts can be provided as row names. Uninfected
hosts (zero count for both left and right sides) are ignored. Cannot be applied to data containing zero
counts; use eb.test instead.
</p>


<h3>Value</h3>

<p>A list containing two data.frames:
</p>
<table>
<tr><td><code>summary</code></td>
<td>
<p>results of total, heterogeneity and pooled G-tests.
Data frame has four columns: test, degrees of freedom, G-statistic and p-value.</p>
</td></tr>
<tr><td><code>hosts</code></td>
<td>
<p>results of individual G-tests on distribution of parasites in each host.
Data frame has seven columns: Host (ID), Left (count of parasites on left side),
Right (count of parasites on right side), G (G-statistic), p (p-value), BH (p-value adjusted
using Benjamini and Hochberg's procedure for controlling the false discovery rate) and Holm (p-value
adjusted using Holm's method).</p>
</td></tr>
</table>


<h3>References</h3>

<p>R.R. Sokal &amp; F.J. Rohlf (1995) Biometry. 3rd Edition. New York: W.H. Freeman and Company. 887 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>g.test(diplostomum_eyes_excl_lenses)
</code></pre>

<hr>
<h2 id='plotHistogram'>Plot histogram</h2><span id='topic+plotHistogram'></span>

<h3>Description</h3>

<p>Creates a histogram showing distribution of fold differences
in abundance of parasites between left and right sides of host.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotHistogram(x, nBreaks = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotHistogram_+3A_x">x</code></td>
<td>
<p>a matrix or data frame with two numeric columns;
first column is for left-side and 2nd column for right-side.
Identifiers for hosts can be provided as row names.</p>
</td></tr>
<tr><td><code id="plotHistogram_+3A_nbreaks">nBreaks</code></td>
<td>
<p>number of cells for the histogram. A suggestion
only; breakpoints will be set to pretty values.</p>
</td></tr>
<tr><td><code id="plotHistogram_+3A_...">...</code></td>
<td>
<p>optional further arguments and graphical parameters
passed to plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.Histogram creates a histogram showing distribution of fold differences
in abundance of parasites between left and right sides. For each infected host the
number of parasites on the right side is divided by the number of parasites
on the left side, and the result binary log transformed. The log2 ratio will
be negative if there are more parasites on the left than right and positive
if there are more parasites on the right than left. A log2 ratio of one
corresponds to a one-fold difference, i.e. double the number of parasites.
Perfect symmetry is a log2 ratio of zero.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotHistogram(diplostomum_eyes_excl_lenses)
plotHistogram(diplostomum_eyes_excl_lenses,nBreaks=20,
main="Diplostomum metacercariae in eyes of ruffe")
</code></pre>

<hr>
<h2 id='plotVolcano'>Volcano plot</h2><span id='topic+plotVolcano'></span>

<h3>Description</h3>

<p>Produces scatterplot of statistical significance vs fold difference in parasite abundance
between left and right.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotVolcano(x, test = "G", pAdj = "BH", sigThresh = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotVolcano_+3A_x">x</code></td>
<td>
<p>a matrix or data frame with two numeric columns; first column is for left-side and 2nd column
for right-side. Identifiers for hosts can be provided as row names.</p>
</td></tr>
<tr><td><code id="plotVolcano_+3A_test">test</code></td>
<td>
<p>if set to &quot;G&quot; (default) a G-test is performed; otherwise an exact binomial test is performed.</p>
</td></tr>
<tr><td><code id="plotVolcano_+3A_padj">pAdj</code></td>
<td>
<p>method for correcting p-values for multiple comparisons. If set to &quot;BH&quot; (default), Benjamini
&amp; Hochberg's procedure is used to control the false discovery rate (FDR); otherwise Holm's methos is used
to control the familywise error rate (FWER).</p>
</td></tr>
<tr><td><code id="plotVolcano_+3A_sigthresh">sigThresh</code></td>
<td>
<p>significance threshold (defaults to 0.05); p-values below this value will be called significant.</p>
</td></tr>
<tr><td><code id="plotVolcano_+3A_...">...</code></td>
<td>
<p>optional further arguments and graphical parameters passed to plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.Volcano creates a volcano plot, i.e. a scatterplot of statistical significance
(-log10(p-value)) vs fold difference (log2 ratio - as calculated for the histogram above)
in parasite abundance between left and right. Each point in the scatterplot represents the
parasite distribution in an individual host. A dashed horizontal line represents the user-defined
p-value threshold for significance. If a parasite distribution deviates significantly from symmetry
it is shown as a red square, otherwise as a blue circle.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotVolcano(diplostomum_eyes_excl_lenses)
plotVolcano(diplostomum_eyes_excl_lenses, test="G", pAdj="BH", sigThresh=0.1,
main="Diplostomum metacercariae in eyes of ruffe")
</code></pre>

<hr>
<h2 id='simulated_asymmetry_inconsistent_bias'>Simulated data showing bilateral asymmetry with insconsistent bias</h2><span id='topic+simulated_asymmetry_inconsistent_bias'></span>

<h3>Description</h3>

<p>Simulated data for 10 hosts, providing an example of bilateral asymmetry with inconsistent bias.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulated_asymmetry_inconsistent_bias
</code></pre>


<h3>Format</h3>

<p>A data frame with 10 rows and 2 variables:
</p>

<dl>
<dt>left</dt><dd><p>number of parasites on the left side</p>
</dd>
<dt>right</dt><dd><p>number of parasites on the right side</p>
</dd>
</dl>

<hr>
<h2 id='simulated_left_bias_heterogeneous_proportions'>Simulated data showing left bias with heterogeneous proportions</h2><span id='topic+simulated_left_bias_heterogeneous_proportions'></span>

<h3>Description</h3>

<p>Simulated data for 10 hosts, providing an example of bilateral asymmetry with left bias
and the left:right ratio varying between hosts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulated_left_bias_heterogeneous_proportions
</code></pre>


<h3>Format</h3>

<p>A data frame with 10 rows and 2 variables:
</p>

<dl>
<dt>left</dt><dd><p>number of parasites on the left side</p>
</dd>
<dt>right</dt><dd><p>number of parasites on the right side</p>
</dd>
</dl>

<hr>
<h2 id='simulated_left_bias_homogeneous_proportions'>Simulated data for showing left bias with homogeneous proportions</h2><span id='topic+simulated_left_bias_homogeneous_proportions'></span>

<h3>Description</h3>

<p>Simulated data for 10 hosts, providing an example of bilateral asymmetry with left bias
and a similar left:right ratio in all hosts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulated_left_bias_homogeneous_proportions
</code></pre>


<h3>Format</h3>

<p>A data frame with 10 rows and 2 variables:
</p>

<dl>
<dt>left</dt><dd><p>number of parasites on the left side</p>
</dd>
<dt>right</dt><dd><p>number of parasites on the right side</p>
</dd>
</dl>

<hr>
<h2 id='simulated_symmetrical_infection'>Simulated data showing bilateral symmetry</h2><span id='topic+simulated_symmetrical_infection'></span>

<h3>Description</h3>

<p>Simulated data for 10 hosts, providing an example of bilateral symmetry.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulated_symmetrical_infection
</code></pre>


<h3>Format</h3>

<p>A data frame with 10 rows and 2 variables:
</p>

<dl>
<dt>left</dt><dd><p>number of parasites on the left side</p>
</dd>
<dt>right</dt><dd><p>number of parasites on the right side</p>
</dd>
</dl>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
