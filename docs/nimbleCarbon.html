<!DOCTYPE html><html><head><title>Help for package nimbleCarbon</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nimbleCarbon}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#agreementIndex'><p>Calculate Agreement Indices.</p></a></li>
<li><a href='#compare.models'><p>WAIC-based model comparison</p></a></li>
<li><a href='#dAsymLaplace'><p>Asymmetric Laplace Distribution</p></a></li>
<li><a href='#dDoubleExponentialGrowth'><p>Double Exponential Growth Model</p></a></li>
<li><a href='#dExponentialGrowth'><p>Exponential Growth Model</p></a></li>
<li><a href='#dExponentialLogisticGrowth'><p>Exponential-Logistic Growth Model</p></a></li>
<li><a href='#dLogisticExponentialGrowth'><p>Logistic-Exponential Growth Model</p></a></li>
<li><a href='#dLogisticGrowth'><p>Logistic Growth Model</p></a></li>
<li><a href='#dLogisticGrowth2'><p>Logistic Growth Model (parametrisation with inflection point)</p></a></li>
<li><a href='#dTrapezoidal'><p>Trapezoidal Distribution</p></a></li>
<li><a href='#intcal20'><p>IntCal20 radiocarbon age calibration curve for the Northern hemisphere.</p></a></li>
<li><a href='#interpLin'><p>Linear interpolation function</p></a></li>
<li><a href='#marine20'><p>Marine20 radiocarbon age calibration curve.</p></a></li>
<li><a href='#modelPlot'><p>Plot Growth Models</p></a></li>
<li><a href='#plot.spdppc'><p>Plot SPD-based Posterior Predictive Check</p></a></li>
<li><a href='#postHPDplot'><p>Plot Marginal Posterior Distribution</p></a></li>
<li><a href='#postPredCor'><p>Calculates correlation between observed and posterior generated SPD.</p></a></li>
<li><a href='#postPredSPD'><p>SPD-based Posterior Predictive Check</p></a></li>
<li><a href='#shcal20'><p>IntCal20 radiocarbon age calibration curve for the Southern hemisphere.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian Analyses of Radiocarbon Dates with NIMBLE</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides utility functions and custom probability distribution for Bayesian analyses of radiocarbon dates within the 'nimble' modelling framework.  It includes various population growth models, nimbleFunction objects, as well as a suite of functions for prior and posterior predictive checks for demographic inference (Crema and Shoda (2021) &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0251695">doi:10.1371/journal.pone.0251695</a>&gt;) and other analyses.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), nimble (&ge; 0.12.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rcarbon,graphics,grDevices,utils,snow,doSNOW,foreach,coda</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-14 09:11:49 UTC; erc62</td>
</tr>
<tr>
<td>Author:</td>
<td>Enrico Crema <a href="https://orcid.org/0000-0001-6727-5138"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Robert Di Napoli <a href="https://orcid.org/0000-0003-2180-2195"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Enrico Crema &lt;enrico.crema@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-14 11:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='agreementIndex'>Calculate Agreement Indices.</h2><span id='topic+agreementIndex'></span>

<h3>Description</h3>

<p>Computes OxCal-style (Bronk-Ramsey 1995) individual and overall agreement index for evaluating model consistency.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agreementIndex(CRA, CRAError, calCurve = "intcal20", theta, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="agreementIndex_+3A_cra">CRA</code></td>
<td>
<p>vector of C14 ages.</p>
</td></tr>
<tr><td><code id="agreementIndex_+3A_craerror">CRAError</code></td>
<td>
<p>vector of C14 errors associated with <code>CRA</code>.</p>
</td></tr>
<tr><td><code id="agreementIndex_+3A_calcurve">calCurve</code></td>
<td>
<p>character string naming a calibration curve, one between 'intcal20','intcal13','shcal20','shcal13','marine13' and 'marine20'.</p>
</td></tr>
<tr><td><code id="agreementIndex_+3A_theta">theta</code></td>
<td>
<p>a Matrix containing the posterior samples of each date.</p>
</td></tr>
<tr><td><code id="agreementIndex_+3A_verbose">verbose</code></td>
<td>
<p>a logical variable indicating whether extra information on progress should be reported. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the individual and overall agreement indices.
</p>


<h3>References</h3>

<p>Bronk-Ramsey, C. (1995). Radiocarbon Calibration and Analysis of Stratigraphy: The OxCal Program. Radiocarbon, 37(2), 425–430.
</p>

<hr>
<h2 id='compare.models'>WAIC-based model comparison</h2><span id='topic+compare.models'></span>

<h3>Description</h3>

<p>Compute delta WAIC and WAIC weights for model comparison.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare.models(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare.models_+3A_...">...</code></td>
<td>
<p>MCMC output from either <code><a href="nimble.html#topic+nimbleMCMC">nimbleMCMC</a></code> or <code><a href="nimble.html#topic+runMCMC">runMCMC</a></code> functions in the <code>nimble</code> R package. Note that in argument <code>WAIC</code> should be set to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table containing WAIC, delta WAIC, and WAIC weights.
</p>

<hr>
<h2 id='dAsymLaplace'>Asymmetric Laplace Distribution</h2><span id='topic+dAsymLaplace'></span><span id='topic+dAsymLaplace+2C'></span><span id='topic+rAsymLaplace+2C'></span><span id='topic+qAsymLaplace+2C'></span><span id='topic+pAsymLaplace'></span><span id='topic+rAsymLaplace'></span><span id='topic+qAsymLaplace'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function, and random generation for a Asymmetric Laplace Distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dAsymLaplace(x, mu, sigma, tau, log)

rAsymLaplace(n, mu, sigma, tau)

pAsymLaplace(q, mu, sigma, tau, lower.tail = 1, log.p = 0)

qAsymLaplace(p, mu, sigma, tau, lower.tail = 1, log.p = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dAsymLaplace_+3A_x">x</code></td>
<td>
<p>value to be computed.</p>
</td></tr>
<tr><td><code id="dAsymLaplace_+3A_mu">mu</code></td>
<td>
<p>location parameter.</p>
</td></tr>
<tr><td><code id="dAsymLaplace_+3A_sigma">sigma</code></td>
<td>
<p>scale parameter.</p>
</td></tr>
<tr><td><code id="dAsymLaplace_+3A_tau">tau</code></td>
<td>
<p>asymmetry parameter.</p>
</td></tr>
<tr><td><code id="dAsymLaplace_+3A_log">log</code>, <code id="dAsymLaplace_+3A_log.p">log.p</code></td>
<td>
<p>TRUE or 1 to return log probability. FALSE or 0 to return probability.</p>
</td></tr>
<tr><td><code id="dAsymLaplace_+3A_n">n</code></td>
<td>
<p>number of random draws. Currently only n = 1 is supported, but the argument exists for standardization of &quot;r&quot; functions.</p>
</td></tr>
<tr><td><code id="dAsymLaplace_+3A_q">q</code></td>
<td>
<p>quantile to be computed.</p>
</td></tr>
<tr><td><code id="dAsymLaplace_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are P[X &lt;= x] otherwise, P[X &gt; x].</p>
</td></tr>
<tr><td><code id="dAsymLaplace_+3A_p">p</code></td>
<td>
<p>probability to be computed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Enrico Crema
</p>

<hr>
<h2 id='dDoubleExponentialGrowth'>Double Exponential Growth Model</h2><span id='topic+dDoubleExponentialGrowth'></span><span id='topic+rDoubleExponentialGrowth'></span>

<h3>Description</h3>

<p>Density and random generation of an exponential growth model distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dDoubleExponentialGrowth(x, a, b, r1, r2, mu, log)

rDoubleExponentialGrowth(n, a, b, r1, r2, mu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dDoubleExponentialGrowth_+3A_x">x</code></td>
<td>
<p>vector of calendar years (in BP).</p>
</td></tr>
<tr><td><code id="dDoubleExponentialGrowth_+3A_a">a</code></td>
<td>
<p>lower (earliest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dDoubleExponentialGrowth_+3A_b">b</code></td>
<td>
<p>upper (latest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dDoubleExponentialGrowth_+3A_r1">r1</code></td>
<td>
<p>growth rate before change point mu.</p>
</td></tr>
<tr><td><code id="dDoubleExponentialGrowth_+3A_r2">r2</code></td>
<td>
<p>growth rate after change point mu.</p>
</td></tr>
<tr><td><code id="dDoubleExponentialGrowth_+3A_mu">mu</code></td>
<td>
<p>change point (in BP).</p>
</td></tr>
<tr><td><code id="dDoubleExponentialGrowth_+3A_log">log</code></td>
<td>
<p>TRUE or 1 to return log probability. FALSE or 0 to return probability.</p>
</td></tr>
<tr><td><code id="dDoubleExponentialGrowth_+3A_n">n</code></td>
<td>
<p>number of random draws. Currently only n = 1 is supported, but the argument exists for standardization of &quot;r&quot; functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>dDoubleExponentialGrowth</code>: the probability (or likelihood) or log probability of an observed date x (in Cal BP). For <code>rDoubleExponentialGrowth</code> a simulated date in Cal BP.
</p>


<h3>Author(s)</h3>

<p>Enrico Crema
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = list(r1=0.003,r2=-0.001,mu=5200)
modelPlot(model = dDoubleExponentialGrowth,a=6000,b=4000,params=p,alpha = 1)
</code></pre>

<hr>
<h2 id='dExponentialGrowth'>Exponential Growth Model</h2><span id='topic+dExponentialGrowth'></span><span id='topic+rExponentialGrowth'></span>

<h3>Description</h3>

<p>Density and random generation of an exponential growth model distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dExponentialGrowth(x, a, b, r, log)

rExponentialGrowth(n, a, b, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dExponentialGrowth_+3A_x">x</code></td>
<td>
<p>vector of calendar years (in BP).</p>
</td></tr>
<tr><td><code id="dExponentialGrowth_+3A_a">a</code></td>
<td>
<p>lower (earliest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dExponentialGrowth_+3A_b">b</code></td>
<td>
<p>upper (latest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dExponentialGrowth_+3A_r">r</code></td>
<td>
<p>intrinsic growth rate.</p>
</td></tr>
<tr><td><code id="dExponentialGrowth_+3A_log">log</code></td>
<td>
<p>TRUE or 1 to return log probability. FALSE or 0 to return probability.</p>
</td></tr>
<tr><td><code id="dExponentialGrowth_+3A_n">n</code></td>
<td>
<p>number of random draws. Currently only n = 1 is supported, but the argument exists for standardization of &quot;r&quot; functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>dExponentialGrowth</code>: the probability (or likelihood) or log probability of an observed date x (in Cal BP). For <code>rExponentialGrowth</code> a simulated date in Cal BP.
</p>


<h3>Author(s)</h3>

<p>Enrico Crema
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = list(r=0.002)
modelPlot(model = dExponentialGrowth,a=6000,b=4000,params=p,alpha = 1)
</code></pre>

<hr>
<h2 id='dExponentialLogisticGrowth'>Exponential-Logistic Growth Model</h2><span id='topic+dExponentialLogisticGrowth'></span><span id='topic+rExponentialLogisticGrowth'></span>

<h3>Description</h3>

<p>Density and random generation of a exponential-logistic growth model distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dExponentialLogisticGrowth(x, a, b, k, r1, r2, mu, log)

rExponentialLogisticGrowth(n, a, b, k, r1, r2, mu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dExponentialLogisticGrowth_+3A_x">x</code></td>
<td>
<p>vector of calendar years (in BP).</p>
</td></tr>
<tr><td><code id="dExponentialLogisticGrowth_+3A_a">a</code></td>
<td>
<p>lower (earliest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dExponentialLogisticGrowth_+3A_b">b</code></td>
<td>
<p>upper (latest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dExponentialLogisticGrowth_+3A_k">k</code></td>
<td>
<p>initial proportion of the carrying capacity (must be between 0 and 1).</p>
</td></tr>
<tr><td><code id="dExponentialLogisticGrowth_+3A_r1">r1</code></td>
<td>
<p>growth rate of the exponential phase.</p>
</td></tr>
<tr><td><code id="dExponentialLogisticGrowth_+3A_r2">r2</code></td>
<td>
<p>growth rate of logistic phase.</p>
</td></tr>
<tr><td><code id="dExponentialLogisticGrowth_+3A_mu">mu</code></td>
<td>
<p>change point (in BP).</p>
</td></tr>
<tr><td><code id="dExponentialLogisticGrowth_+3A_log">log</code></td>
<td>
<p>TRUE or 1 to return log probability. FALSE or 0 to return probability.</p>
</td></tr>
<tr><td><code id="dExponentialLogisticGrowth_+3A_n">n</code></td>
<td>
<p>number of random draws. Currently only n = 1 is supported, but the argument exists for standardization of &quot;r&quot; functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>dExponentialLogisticGrowth</code>: the probability (or likelihood) or log probability of an observed date x (in Cal BP). For <code>rExponentialLogisticGrowth</code> a simulated date in Cal BP.
</p>


<h3>Author(s)</h3>

<p>Enrico Crema
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = list(r1=-0.001,r2=0.01,mu=5200,k=0.2)
modelPlot(model = dExponentialLogisticGrowth,a=6000,b=4000,params=p,alpha = 1)
</code></pre>

<hr>
<h2 id='dLogisticExponentialGrowth'>Logistic-Exponential Growth Model</h2><span id='topic+dLogisticExponentialGrowth'></span><span id='topic+rLogisticExponentialGrowth'></span>

<h3>Description</h3>

<p>Density and random generation of a logistic-exponential growth model distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dLogisticExponentialGrowth(x, a, b, r1, r2, k, mu, log)

rLogisticExponentialGrowth(n, a, b, r1, r2, k, mu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dLogisticExponentialGrowth_+3A_x">x</code></td>
<td>
<p>vector of calendar years (in BP).</p>
</td></tr>
<tr><td><code id="dLogisticExponentialGrowth_+3A_a">a</code></td>
<td>
<p>lower (earliest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dLogisticExponentialGrowth_+3A_b">b</code></td>
<td>
<p>upper (latest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dLogisticExponentialGrowth_+3A_r1">r1</code></td>
<td>
<p>growth rate of the logistic phase.</p>
</td></tr>
<tr><td><code id="dLogisticExponentialGrowth_+3A_r2">r2</code></td>
<td>
<p>growth rate of exponential phase.</p>
</td></tr>
<tr><td><code id="dLogisticExponentialGrowth_+3A_k">k</code></td>
<td>
<p>initial proportion of the carrying capacity (must be between 0 and 1).</p>
</td></tr>
<tr><td><code id="dLogisticExponentialGrowth_+3A_mu">mu</code></td>
<td>
<p>change point (in BP).</p>
</td></tr>
<tr><td><code id="dLogisticExponentialGrowth_+3A_log">log</code></td>
<td>
<p>TRUE or 1 to return log probability. FALSE or 0 to return probability.</p>
</td></tr>
<tr><td><code id="dLogisticExponentialGrowth_+3A_n">n</code></td>
<td>
<p>number of random draws. Currently only n = 1 is supported, but the argument exists for standardization of &quot;r&quot; functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>dLogisticExponentialGrowth</code>: the probability (or likelihood) or log probability of an observed date x (in Cal BP). For <code>rLogisticExponentialGrowth</code> a simulated date in Cal BP.
</p>


<h3>Author(s)</h3>

<p>Robert DiNapoli &amp; Enrico Crema
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = list(r1=0.01,r2=-0.001,k=0.001,mu=4500)
modelPlot(model = dLogisticExponentialGrowth,a=6000,b=4000,params=p,alpha = 1)
</code></pre>

<hr>
<h2 id='dLogisticGrowth'>Logistic Growth Model</h2><span id='topic+dLogisticGrowth'></span><span id='topic+rLogisticGrowth'></span>

<h3>Description</h3>

<p>Density and random generation of a logistic growth model distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dLogisticGrowth(x, a, b, k, r, log)

rLogisticGrowth(n, a, b, k, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dLogisticGrowth_+3A_x">x</code></td>
<td>
<p>vector of calendar years (in BP).</p>
</td></tr>
<tr><td><code id="dLogisticGrowth_+3A_a">a</code></td>
<td>
<p>lower (earliest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dLogisticGrowth_+3A_b">b</code></td>
<td>
<p>upper (latest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dLogisticGrowth_+3A_k">k</code></td>
<td>
<p>initial proportion of the carrying capacity (must be between 0 and 1).</p>
</td></tr>
<tr><td><code id="dLogisticGrowth_+3A_r">r</code></td>
<td>
<p>intrinsic growth rate.</p>
</td></tr>
<tr><td><code id="dLogisticGrowth_+3A_log">log</code></td>
<td>
<p>TRUE or 1 to return log probability. FALSE or 0 to return probability.</p>
</td></tr>
<tr><td><code id="dLogisticGrowth_+3A_n">n</code></td>
<td>
<p>number of random draws. Currently only n = 1 is supported, but the argument exists for standardization of &quot;r&quot; functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>dLogisticGrowth</code>: the probability (or likelihood) or log probability of an observed date x (in Cal BP). For <code>rLogisticGrowth</code> a simulated date in Cal BP.
</p>


<h3>Author(s)</h3>

<p>Enrico Crema
</p>


<h3>See Also</h3>

<p><code>dLogisticGrowth2</code> for an alternative parametrisation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = list(k=0.01,r=0.007)
modelPlot(model = dLogisticGrowth,a=6000,b=4000,params=p,alpha = 1)
</code></pre>

<hr>
<h2 id='dLogisticGrowth2'>Logistic Growth Model (parametrisation with inflection point)</h2><span id='topic+dLogisticGrowth2'></span><span id='topic+rLogisticGrowth2'></span>

<h3>Description</h3>

<p>Density and random generation of a logistic growth model distribution with alternative parametrisation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dLogisticGrowth2(x, a, b, m, r, log)

rLogisticGrowth2(n, a, b, m, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dLogisticGrowth2_+3A_x">x</code></td>
<td>
<p>vector of calendar years (in BP).</p>
</td></tr>
<tr><td><code id="dLogisticGrowth2_+3A_a">a</code></td>
<td>
<p>lower (earliest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dLogisticGrowth2_+3A_b">b</code></td>
<td>
<p>upper (latest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dLogisticGrowth2_+3A_m">m</code></td>
<td>
<p>inflection point in BP (i.e. point with the highest growth rate).</p>
</td></tr>
<tr><td><code id="dLogisticGrowth2_+3A_r">r</code></td>
<td>
<p>intrinsic growth rate.</p>
</td></tr>
<tr><td><code id="dLogisticGrowth2_+3A_log">log</code></td>
<td>
<p>TRUE or 1 to return log probability. FALSE or 0 to return probability.</p>
</td></tr>
<tr><td><code id="dLogisticGrowth2_+3A_n">n</code></td>
<td>
<p>number of random draws. Currently only n = 1 is supported, but the argument exists for standardization of &quot;r&quot; functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an alternative parametrisation of <code>dLogisiticGrowth</code>, where <code>m</code> is equal to <code>log(-(k-1)/k)/r</code>.
</p>


<h3>Value</h3>

<p>For <code>dLogisticGrowth2</code>: the probability (or likelihood) or log probability of an observed date x (in Cal BP). For <code>rLogisticGrowth2</code> a simulated date in Cal BP.
</p>


<h3>Author(s)</h3>

<p>Enrico Crema
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p = list(m=4500,r=0.007)
modelPlot(model = dLogisticGrowth2,a=6000,b=4000,params=p,alpha = 1)
</code></pre>

<hr>
<h2 id='dTrapezoidal'>Trapezoidal Distribution</h2><span id='topic+dTrapezoidal'></span><span id='topic+rTrapezoidal'></span>

<h3>Description</h3>

<p>Density and random generation of an Trapezoidal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dTrapezoidal(x, a, m1, m2, b, log)

rTrapezoidal(n, a, m1, m2, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dTrapezoidal_+3A_x">x</code></td>
<td>
<p>A calendar year (in BP).</p>
</td></tr>
<tr><td><code id="dTrapezoidal_+3A_a">a</code></td>
<td>
<p>lower (earliest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dTrapezoidal_+3A_m1">m1</code></td>
<td>
<p>lower mode (in BP)</p>
</td></tr>
<tr><td><code id="dTrapezoidal_+3A_m2">m2</code></td>
<td>
<p>upper mode (in BP).</p>
</td></tr>
<tr><td><code id="dTrapezoidal_+3A_b">b</code></td>
<td>
<p>upper (latest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="dTrapezoidal_+3A_log">log</code></td>
<td>
<p>TRUE or 1 to return log probability. FALSE or 0 to return probability.</p>
</td></tr>
<tr><td><code id="dTrapezoidal_+3A_n">n</code></td>
<td>
<p>number of random draws. Currently only n = 1 is supported, but the argument exists for standardization of &quot;r&quot; functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Enrico Crema
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a=7000
b=6700
c=4000
d=3000
x=5400
modelPlot(dTrapezoidal,a=7000,b=5000,params=c(m1=6000,m2=5300),alpha=1,col=1)

</code></pre>

<hr>
<h2 id='intcal20'>IntCal20 radiocarbon age calibration curve for the Northern hemisphere.</h2><span id='topic+intcal20'></span>

<h3>Description</h3>

<p>IntCal20 radiocarbon age calibration curve for the Northern hemisphere.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intcal20
</code></pre>


<h3>Format</h3>

<p>A data.frame with the following fields:
</p>

<dl>
<dt><code>CalBP</code></dt><dd><p>ID of each radiocarbon date</p>
</dd>
<dt><code>C14Age</code></dt><dd><p>Radiocarbon age in 14C years BP</p>
</dd>
<dt><code>C14Age.sigma</code></dt><dd><p>Radiocarbon age error</p>
</dd>
<dt><code>Delta14C</code></dt><dd><p>Labcode of the radiocarbon date</p>
</dd>
<dt><code>Delta14C.sigma</code></dt><dd><p>Material of the dated sample</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://intcal.org/curves/intcal20.14c
</p>


<h3>References</h3>

<p>Reimer, P. J., Austin, W. E. N., Bard, E., Bayliss, A., Blackwell, P. G., Ramsey, C. B., et al. (2020). The IntCal20 Northern Hemisphere Radiocarbon Age Calibration Curve (0–55 cal kBP). Radiocarbon, 62(4), 725–757. https://doi.org/10.1017/RDC.2020.41
</p>

<hr>
<h2 id='interpLin'>Linear interpolation function</h2><span id='topic+interpLin'></span>

<h3>Description</h3>

<p>A <code>nimbleFunction</code> emulating BUGS/JAGS's interp.lin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpLin(z, x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpLin_+3A_z">z</code></td>
<td>
<p>value where the interpolation take place</p>
</td></tr>
<tr><td><code id="interpLin_+3A_x">x</code></td>
<td>
<p>numeric vector giving the coordinates of the points to be interpolated.</p>
</td></tr>
<tr><td><code id="interpLin_+3A_y">y</code></td>
<td>
<p>numeric vector giving the coordinates of the points to be interpolated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>interpolated value
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(intcal20)
interpLin(4500,intcal20$CalBP,intcal20$C14Age)
# equivalent to:
approx(x=intcal20$CalBP,y=intcal20$C14Age,xout=4500)$y
</code></pre>

<hr>
<h2 id='marine20'>Marine20 radiocarbon age calibration curve.</h2><span id='topic+marine20'></span>

<h3>Description</h3>

<p>Marine20 radiocarbon age calibration curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marine20
</code></pre>


<h3>Format</h3>

<p>A data.frame with the following fields:
</p>

<dl>
<dt><code>CalBP</code></dt><dd><p>ID of each radiocarbon date</p>
</dd>
<dt><code>C14Age</code></dt><dd><p>Radiocarbon age in 14C years BP</p>
</dd>
<dt><code>C14Age.sigma</code></dt><dd><p>Radiocarbon age error</p>
</dd>
<dt><code>Delta14C</code></dt><dd><p>Labcode of the radiocarbon date</p>
</dd>
<dt><code>Delta14C.sigma</code></dt><dd><p>Material of the dated sample</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://intcal.org/curves/marine20.14c
</p>


<h3>References</h3>

<p>Heaton, T. J., Köhler, P., Butzin, M., Bard, E., Reimer, R. W., Austin, W. E. N., et al. (2020). Marine20—The Marine Radiocarbon Age Calibration Curve (0–55,000 cal BP). Radiocarbon, 62(4), 779–820. https://doi.org/10.1017/RDC.2020.68
</p>

<hr>
<h2 id='modelPlot'>Plot Growth Models</h2><span id='topic+modelPlot'></span>

<h3>Description</h3>

<p>Plots growth models based on user provided parameters for prior and posterior predictive checks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelPlot(
  model,
  a,
  b,
  params,
  type = c("spaghetti"),
  nsample = NULL,
  interval = 0.9,
  calendar = "BP",
  col = "lightgrey",
  alpha = 0.1,
  ylim = NULL,
  xlim = NULL,
  xlab = NULL,
  ylab = NULL,
  add = FALSE,
  lwd = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelPlot_+3A_model">model</code></td>
<td>
<p>growth model.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_a">a</code></td>
<td>
<p>lower (earliest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_b">b</code></td>
<td>
<p>upper (latest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_params">params</code></td>
<td>
<p>a <a href="base.html#topic+list">list</a> of vectors containing model parameters. The names attribute of each vector should match growth model parameters.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_type">type</code></td>
<td>
<p>either a 'spaghetti' plot or a quantile based 'envelope' plot. Default is 'spaghetti'.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_nsample">nsample</code></td>
<td>
<p>number of samples to be used. Default is the length of the parameter vectors supplied in the argument <code>params</code>.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_interval">interval</code></td>
<td>
<p>quantile interval used for the envelope plot. Ignored when type is set to 'spaghetti'.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_calendar">calendar</code></td>
<td>
<p>either <code>'BP'</code> or <code>'BCAD'</code>. Indicate whether the calibrated date should be displayed in BP or BC/AD. Default is  <code>'BP'</code>.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_col">col</code></td>
<td>
<p>fill color for the quantile envelope (when <code>type=='envelope'</code>) or line colour (when <code>type=='spaghetti'</code>).</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_alpha">alpha</code></td>
<td>
<p>transparency value for each line in the spaghetti plot or the fill color in the 'envelope' plot.  Default is 1.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_ylim">ylim</code></td>
<td>
<p>the y limits of the plot.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_xlim">xlim</code></td>
<td>
<p>the x limits of the plot (in Cal BP).</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis. Default is 'Years cal BP','Years BC/AD','Years BC', or 'Years AD' depending on data range and settings of <code>calendar</code>.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y axis. Default is 'Probability'.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_add">add</code></td>
<td>
<p>whether or not the new graphic should be added to an existing plot.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_lwd">lwd</code></td>
<td>
<p>line width. Default is 1.</p>
</td></tr>
<tr><td><code id="modelPlot_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
params = list(k=runif(100,0.01,0.02),r=runif(100,0.003,0.004))
modelPlot(model=dLogisticGrowth,a=5000,b=2000,params=params,type=c('spaghetti'),alpha=0.5)

</code></pre>

<hr>
<h2 id='plot.spdppc'>Plot SPD-based Posterior Predictive Check</h2><span id='topic+plot.spdppc'></span>

<h3>Description</h3>

<p>Plots <code>spdppc</code> class object for SPD-based Posterior Predictive Check.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spdppc'
plot(
  x,
  type = "envelope",
  nsample = NULL,
  interval = 0.9,
  obs.lwd = 1.5,
  obs.col = "black",
  sim.col = "lightgrey",
  alpha = 1,
  envelope.col = "lightgrey",
  positive.col = "red",
  negative.col = "blue",
  calendar = "BP",
  xlab = NULL,
  ylab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.spdppc_+3A_x">x</code></td>
<td>
<p>An <code>spdppc</code> class object.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_type">type</code></td>
<td>
<p>Either a 'spaghetti' plot or a quantile based envelope plot. Default is 'envelope'.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_nsample">nsample</code></td>
<td>
<p>Number of samples to be displayed in the 'spaghetti' plot. Default is the total number of simulations supplied in the 'spdppc' class object, ignored when <code>type</code> is set to 'envelope'.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_interval">interval</code></td>
<td>
<p>Quantile interval used for the envelope plot. Ignored when <code>type</code> is set to 'spaghetti'. Default is 0.90.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_obs.lwd">obs.lwd</code></td>
<td>
<p>Line width of the observed SPD. Default is 1.5.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_obs.col">obs.col</code></td>
<td>
<p>Line colour of the observed SPD. Default is 'black'.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_sim.col">sim.col</code></td>
<td>
<p>Line colour of simulated SPDs. Default is 'lightgrey', ignored when <code>type</code> is set to 'envelope'.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_alpha">alpha</code></td>
<td>
<p>Transparency value for each line in the spaghetti plot. Default is 1, ignored when <code>type</code> is set to 'envelope'.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_envelope.col">envelope.col</code></td>
<td>
<p>Fill colour of the simulation envelope. Default is 'lightgrey', ignored when <code>type</code> is set to 'envelope.'spaghetti'.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_positive.col">positive.col</code></td>
<td>
<p>Fill colour for the area with positive deviation from the simulation envelope.  Default is 'red', ignored when <code>type</code> is set to 'spaghetti'.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_negative.col">negative.col</code></td>
<td>
<p>Fill colour for the area with positive deviation from the simulation envelope.  Default is 'blue', ignored when <code>type</code> is set to 'spaghetti'.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_calendar">calendar</code></td>
<td>
<p>Either <code>'BP'</code> or <code>'BCAD'</code>. Indicate whether the calibrated date should be displayed in BP or BC/AD. Default is  <code>'BP'</code>.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis. Default is 'Years cal BP','Years BC/AD','Years BC', or 'Years AD' depending on data range and settings of <code>calendar</code>.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y axis. Default is 'Probability'.</p>
</td></tr>
<tr><td><code id="plot.spdppc_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>

<hr>
<h2 id='postHPDplot'>Plot Marginal Posterior Distribution</h2><span id='topic+postHPDplot'></span>

<h3>Description</h3>

<p>Plot marginal posterior distribution highlighting user-defined higher posterior density interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>postHPDplot(
  x,
  prob = 0.9,
  bw = "SJ",
  hpd.col = "lightblue",
  line.col = "darkgrey",
  rnd = 3,
  HPD = TRUE,
  show.hpd.val = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="postHPDplot_+3A_x">x</code></td>
<td>
<p>Posterior samples</p>
</td></tr>
<tr><td><code id="postHPDplot_+3A_prob">prob</code></td>
<td>
<p>Highest posterior density interval. Default is 0.9.</p>
</td></tr>
<tr><td><code id="postHPDplot_+3A_bw">bw</code></td>
<td>
<p>The smoothing bandwidth to be used. See <code><a href="stats.html#topic+density">density</a></code> for details. Default is &quot;SJ&quot;.</p>
</td></tr>
<tr><td><code id="postHPDplot_+3A_hpd.col">hpd.col</code></td>
<td>
<p>Fill colour for the highest density interval. Default is 'lightblue'. Ignored when <code>HPD</code> is set to FALSE.</p>
</td></tr>
<tr><td><code id="postHPDplot_+3A_line.col">line.col</code></td>
<td>
<p>Line color for the density plot. Default is 'darkgrey'.</p>
</td></tr>
<tr><td><code id="postHPDplot_+3A_rnd">rnd</code></td>
<td>
<p>Integer indicating the number of decimal places to be used in the reporting of the highest posterior density interval.</p>
</td></tr>
<tr><td><code id="postHPDplot_+3A_hpd">HPD</code></td>
<td>
<p>Whether the highest posterior density interval is highlighted or not. Default is TRUE.</p>
</td></tr>
<tr><td><code id="postHPDplot_+3A_show.hpd.val">show.hpd.val</code></td>
<td>
<p>Whether the highest posterior density interval is displayed as subtitle. Default is TRUE.</p>
</td></tr>
<tr><td><code id="postHPDplot_+3A_...">...</code></td>
<td>
<p>other graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>

<hr>
<h2 id='postPredCor'>Calculates correlation between observed and posterior generated SPD.</h2><span id='topic+postPredCor'></span>

<h3>Description</h3>

<p>Computes the correlation between observed SPDs and posterior generated SPD from the output of <code>postPredSPD()</code> function as an heuristic of the goodness-of-fit of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>postPredCor(x, method = "pearson")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="postPredCor_+3A_x">x</code></td>
<td>
<p>An object of class <code>spdppc</code>.</p>
</td></tr>
<tr><td><code id="postPredCor_+3A_method">method</code></td>
<td>
<p>a character string indicating which correlation coefficient is to be computed. One of &quot;pearson&quot; (default), &quot;kendall&quot;, or &quot;spearman&quot;: can be abbreviated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of correlation values.
</p>

<hr>
<h2 id='postPredSPD'>SPD-based Posterior Predictive Check</h2><span id='topic+postPredSPD'></span>

<h3>Description</h3>

<p>Generates SPDs from posterior samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>postPredSPD(
  x,
  errors,
  calCurve,
  model,
  a,
  b,
  params,
  nsim,
  method = NULL,
  spdnormalised = TRUE,
  datenormalised = TRUE,
  ncores = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="postPredSPD_+3A_x">x</code></td>
<td>
<p>a vector of observed uncalibrated radiocarbon ages.</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_errors">errors</code></td>
<td>
<p>a vector of standard deviations corresponding to each estimated radiocarbon age.</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_calcurve">calCurve</code></td>
<td>
<p>character string naming a calibration curve already provided with the rcarbon package (currently 'intcal20','intcal13','intcal13nhpine16','shcal20','shcal13','shcal13shkauri16',&rdquo;marine13','marine20').</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_model">model</code></td>
<td>
<p>growth model</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_a">a</code></td>
<td>
<p>lower (earliest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_b">b</code></td>
<td>
<p>upper (latest) limit of the distribution (in BP).</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_params">params</code></td>
<td>
<p>list of vectors containing model parameters. The names attribute of each vector should match growth model parameters.</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_nsim">nsim</code></td>
<td>
<p>number of SPDs to be generated.  Default is the length of the parameter vectors supplied in the argument <code>params</code>.</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_method">method</code></td>
<td>
<p>method for the creation of random dates from the fitted model. Either 'uncalsample' or 'calsample'.</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_spdnormalised">spdnormalised</code></td>
<td>
<p>a logical variable indicating whether the total probability mass of the SPD is normalised to sum to unity for both observed and simulated data. Default is TRUE.</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_datenormalised">datenormalised</code></td>
<td>
<p>a logical variable indicating whether dates should be normalised to sum to unity or not. Default is TRUE.</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_ncores">ncores</code></td>
<td>
<p>number of cores used for for parallel execution. Default is 1.</p>
</td></tr>
<tr><td><code id="postPredSPD_+3A_verbose">verbose</code></td>
<td>
<p>a logical variable indicating whether extra information on progress should be reported. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>spdppc</code> with the following elements
</p>

<ul>
<li><p><code>obs</code> A data.frame containing the years (in Cal BP) and the corresponding summed probability in the observed data.
</p>
</li>
<li><p><code>spdmat</code> A matrix containing the summed probability distribution of the simulated data.
</p>
</li></ul>


<hr>
<h2 id='shcal20'>IntCal20 radiocarbon age calibration curve for the Southern hemisphere.</h2><span id='topic+shcal20'></span>

<h3>Description</h3>

<p>IntCal20 radiocarbon age calibration curve for the Southern hemisphere.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shcal20
</code></pre>


<h3>Format</h3>

<p>A data.frame with the following fields:
</p>

<dl>
<dt><code>CalBP</code></dt><dd><p>ID of each radiocarbon date</p>
</dd>
<dt><code>C14Age</code></dt><dd><p>Radiocarbon age in 14C years BP</p>
</dd>
<dt><code>C14Age.sigma</code></dt><dd><p>Radiocarbon age error</p>
</dd>
<dt><code>Delta14C</code></dt><dd><p>Labcode of the radiocarbon date</p>
</dd>
<dt><code>Delta14C.sigma</code></dt><dd><p>Material of the dated sample</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://intcal.org/curves/shcal20.14c
</p>


<h3>References</h3>

<p>Reimer, P. J., Austin, W. E. N., Bard, E., Bayliss, A., Blackwell, P. G., Ramsey, C. B., et al. (2020). The IntCal20 Northern Hemisphere Radiocarbon Age Calibration Curve (0–55 cal kBP). Radiocarbon, 62(4), 725–757. https://doi.org/10.1017/RDC.2020.41
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
