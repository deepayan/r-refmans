<!DOCTYPE html><html><head><title>Help for package ThresholdROC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ThresholdROC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ThresholdROC'>
<p>Optimum threshold estimation based on cost function in a two- and three- state settings</p></a></li>
<li><a href='#AD'><p>Alzheimer's disease data</p></a></li>
<li><a href='#chemo'><p>Response to chemotherapy data set</p></a></li>
<li><a href='#diagnostic'>
<p>Diagnostic accuracy measures of binary diagnostic tests</p></a></li>
<li><a href='#lines.thres2'>
<p>Add threshold lines to a plot (two-state setting)</p></a></li>
<li><a href='#lines.thres3'>
<p>Add threshold lines to a plot (three-state setting)</p></a></li>
<li><a href='#plot.thres2'>
<p>Threshold and density plot (two-state setting)</p></a></li>
<li><a href='#plot.thres3'>
<p>Thresholds and density plot (three-state setting)</p></a></li>
<li><a href='#plotCostROC'>
<p>Plot cost function and ROC curve</p></a></li>
<li><a href='#secondDer2'>
<p>Second partial derivative of the cost function (two-state setting)</p></a></li>
<li><a href='#secondDer3'>
<p>Second partial derivative of the cost function (three-state setting)</p></a></li>
<li><a href='#SS'>
<p>Sample size estimation (two-state setting)</p></a></li>
<li><a href='#thres2'>
<p>Threshold point estimation and confidence intervals (two-state setting)</p></a></li>
<li><a href='#thres3'>
<p>Threshold point estimation and confidence intervals (three-state setting)</p></a></li>
<li><a href='#thresTH2'>
<p>Population-based threshold calculation (two-state setting)</p></a></li>
<li><a href='#thresTH3'>
<p>Population-based threshold calculation (three-state setting)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Optimum Threshold Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>2.9.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-12</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions that provide point and interval estimations of optimum thresholds for continuous diagnostic tests. The methodology used is based on minimizing an overall cost function in the two- and three-state settings. We also provide functions for sample size determination and estimation of diagnostic accuracy measures. We also include graphical tools. The statistical methodology used here can be found in Perez-Jaume et al (2017) &lt;<a href="https://doi.org/10.18637%2Fjss.v082.i04">doi:10.18637/jss.v082.i04</a>&gt; and in Skaltsa et al (2010, 2012) &lt;<a href="https://doi.org/10.1002%2Fbimj.200900294">doi:10.1002/bimj.200900294</a>&gt;, &lt;<a href="https://doi.org/10.1002%2Fsim.4369">doi:10.1002/sim.4369</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, numDeriv, pROC, ks</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-12 18:46:47 UTC; spjau</td>
</tr>
<tr>
<td>Author:</td>
<td>Sara Perez-Jaume [aut, cre],
  Natalia Pallares [aut],
  Konstantina Skaltsa [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sara Perez-Jaume &lt;spjaume@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-12 19:10:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='ThresholdROC'>
Optimum threshold estimation based on cost function in a two- and three- state settings
</h2><span id='topic+ThresholdROC'></span><span id='topic+ThresholdROC-package'></span>

<h3>Description</h3>

<p>The ThresholdROC package provides point and interval estimations of the optimum threshold as well as graphical tools for continuous diagnostic tests (two- and three- state settings). The point estimation is based on the definition of a cost function which we opt to minimise. An analytical estimator is available for the binormal and trinormal model and the empirical one is used for all settings. The interval estimation is based on the Delta method variance estimator in a binormal parametric setting and on methods on non-linear equations for the trinormal setting. Bootstrap methods are also provided for the confidence intervals.
</p>


<h3>Details</h3>

<p>The most important functions are <code>thres2</code> and <code>thres3</code>. They offer a wide range of options for threshold estimation and inference in two and three state settings. We also include the function <code>diagnostic</code>, which calculates common measures of accuracy for binary diagnostic tests involving 2x2 contingency tables of classification results.
</p>


<h3>Author(s)</h3>

<p>Sara Perez-Jaume, Natalia Pallares, Konstantina Skaltsa
</p>
<p>Maintainer: Sara Perez-Jaume &lt;spjaume@gmail.com&gt;
</p>


<h3>References</h3>

<p>Efron B, Tibshirani RJ. (1993). An introduction to the bootstrap, Chapman &amp; Hall.
</p>
<p>Perez-Jaume S, Skaltsa K, Pallares N, Carrasco JL. (2017). ThresholdROC: Optimum Threshold Estimation Tools for Continuous Diagnostic Tests in R. Journal of Statistical Software 82(4):1-21. doi: 10.18637/jss.v082.i04.
</p>
<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>
<p>Skaltsa K, Jover L, Fuster D, Carrasco JL. (2012). Optimum threshold estimation based on cost function in a multistate diagnostic setting. Statistics in Medicine, 31:1098-1109.
</p>
<p>Zhou XH, Obuchowski NA and McClish DK. (2002). Statistical methods in diagnostic medicine. John Wiley and sons.
</p>

<hr>
<h2 id='AD'>Alzheimer's disease data
</h2><span id='topic+AD'></span>

<h3>Description</h3>

<p>This dataset, obtained by Konstantina Skaltsa from Kapaki et al. 2003, contains measurements from the tau protein located in the cerebrospinal fluid (<code>Tau</code> variable) of 49 control subjects (<code>Status==0</code>) and 49 patients with Alzheimer's disease (<code>Status==1</code>). A column indicating the identifier of the subject is also included (<code>id</code> variable).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("AD")</code></pre>


<h3>References</h3>

<p>Kapaki E, Paraskevas G, Zalonis I, Zournas C. (2003). CSF Tau Protein and beta-amyloid (1-42) in Alzheimer's Disease diagnosis: Discrimination from Normal Ageing and the Other Dementias in the Greek Population. European Journal of Neurology, 10, 119-128.
</p>
<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>

<hr>
<h2 id='chemo'>Response to chemotherapy data set
</h2><span id='topic+chemo'></span>

<h3>Description</h3>

<p>This dataset contains Standardized Uptake Value (SUV) measurements (<code>SUV</code> variable) from 50 patients of breast cancer who underwent chemotherapy. After surgery, response to chemotherapy was evaluated using the pathology results in the surgical specimens, which was taken as gold standard by assigning one of the following three states: stable disease, partial remission and complete remission (<code>resp</code> variable). A column indicating the identifier of the patient is also included (<code>id</code> variable).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("chemo")</code></pre>


<h3>References</h3>

<p>Duch J, Fuster D, Munoz M, Fernandez P, Paredes P, Fontanillas M, Guzman F, Rubi S, Lomena F, Pons F. (2009). 18 F-FDG PET/CT for Early Prediction of Response to Neoadjuvant Chemotherapy in Breast Cancer. European Journal of Nuclear Molecular Imaging, 36, 1551-1557.
</p>
<p>Skaltsa K, Jover L, Fuster D, Carrasco JL. (2012). Optimum threshold estimation based on cost function in a multistate diagnostic setting. Statistics in Medicine, 31:1098-1109.
</p>

<hr>
<h2 id='diagnostic'>
Diagnostic accuracy measures of binary diagnostic tests
</h2><span id='topic+diagnostic'></span>

<h3>Description</h3>

<p>This function estimates common accuracy measures for binary diagnostic tests involving 2x2 contingency tables of classification results (usually, test outcome versus status tables).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnostic(tab, method = c("par", "exact"),
  casecontrol = FALSE, p = NULL, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="diagnostic_+3A_tab">tab</code></td>
<td>

<p>an object of class <code>table</code> or <code>matrix</code> in the following form:
</p>
<p>TP  FP
</p>
<p>FN  TN
</p>
<p>where TP=number of true positives, FP=number of false positives, FN=number of false negatives and TN=number of true negatives; that is, a table where the first row corresponds to the positive tests and the second row to the negative tests; the first column corresponds to the diseased subjects and the second one to the healthy individuals. <code>dim(tab)</code> should be <code>c(2, 2)</code>.
</p>
</td></tr>
<tr><td><code id="diagnostic_+3A_method">method</code></td>
<td>

<p>method for calculating the confidence intervals for sensitivity, specificity, predictive values, accuracy and error rate. The user can choose between <code>"par"</code> (parametric) and <code>"exact"</code> (exact). The last one is recommended for small sample sizes. Default, <code>"par"</code>. The user can specify just the initial letters. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="diagnostic_+3A_casecontrol">casecontrol</code></td>
<td>

<p>were data collected in a case-control study? Default, <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="diagnostic_+3A_p">p</code></td>
<td>

<p>disease prevalence (only when <code>casecontrol = TRUE</code>; otherwise, this parameter is ignored).
</p>
</td></tr>
<tr><td><code id="diagnostic_+3A_conf.level">conf.level</code></td>
<td>

<p>confidence level for the confidence intervals. Default, 0.95 (95%).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For details about the expressions for the statistical measures calculated by this function, see <b>References</b>.
</p>
<p>Since sensitivity, specificity, predictive values, accuracy and error rate are proportions, their confidence intervals are calculated using the functions <code>prop.test</code> (if <code>method = "par"</code>) and <code>binom.test</code> (if <code>method = "exact"</code>) from the <code>stats</code> package.
</p>
<p>Confidence intervals for the likelihood ratios are calculated using the formulas proposed in Zhou et al (2002), Section 4.1.3. Furthermore, when likelihood ratios can not be calculated due to division by 0, the following correction is applied: 0.5 units are added to <code>tab</code>.
</p>
<p>Confidence intervals for the odds ratio are calculated using the formulas proposed in Zhou et al (2002), Section 4.1.4. The same correction described before is applied when odds ratio can not be calculated due to division by 0.
</p>
<p>Confidence intervals for the Youden index are calculated using the expression
</p>
<p style="text-align: center;"><code class="reqn">CI(1-\alpha) = (Y-z_{1-\alpha/2}*Var(Y), Y+z_{1-\alpha/2}*Var(Y)),</code>
</p>

<p>where <code class="reqn">Y</code> is the Youden index estimate, <code class="reqn">z_{1-\alpha/2}</code> is the <code class="reqn">1-\alpha/2</code> quantile of a <code class="reqn">N(0, 1)</code> distribution and <code class="reqn">Var(Y)</code> is the variance of the Youden index estimator, which is calculated as <code class="reqn">Var(Sensitivity)+Var(Specificity)</code>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with ten rows and three columns containing the point estimate and confidence intervals for the following statistical measures: sensitivity, specificity, positive predictive value, negative predictive value, positive likelihood ratio, negative likelihood ratio, odds ratio, Youden index, accuracy and error rate. 
</p>


<h3>Author(s)</h3>

<p>Sara Perez-Jaume, Natalia Pallares
</p>


<h3>References</h3>

<p>Youden, WJ. (1950). Index for rating diagnostic tests. Cancer 3:32-35.
</p>
<p>Zhou XH, Obuchowski NA and McClish DK. (2002). Statistical methods in diagnostic medicine. John Wiley and sons.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thres2">thres2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1 (Zhou et al, 2002)
japan &lt;- matrix(c(56, 23, 6, 78), ncol=2, byrow=TRUE)
colnames(japan) &lt;- c("D", "nD")
rownames(japan) &lt;- c("+", "-")
japan
p &lt;- 0.196 # disease prevalence
diagnostic(japan, "par", casecontrol=TRUE, p=p)

# example 2
table &lt;- matrix(c(22, 2, 3, 3), ncol=2, byrow=TRUE)
diagnostic(table, "par")
diagnostic(table, "exact")

# example 3
table2 &lt;- matrix(c(22, 2, 0, 3), ncol=2, byrow=TRUE)
diagnostic(table2, "exact")

# example 4
# generate a random sample of diseased and non-diased subjects
n1 &lt;- 100
n2 &lt;- 100
set.seed(1234)
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
k1 &lt;- rnorm(n1, par1.1, par1.2) # non-diseased
k2 &lt;- rnorm(n2, par2.1, par2.2) # diseased
# threshold estimation
rho &lt;- 0.2 # prevalence
thres &lt;- thres2(k1, k2, rho, method="equal", ci.method="delta")$T$thres
# diagnostic test using the threshold estimate
marker &lt;- c(k1, k2) # biomarker
condition &lt;- c(rep("nD", length(k1)), rep("D", length(k2))) # condition
test &lt;- ifelse(marker&lt;thres, "-", "+") # test outcome according to thres
# build the table
table3 &lt;- table(test, condition)[2:1, ]
# diagnostic test
round(diagnostic(table3), 3)
</code></pre>

<hr>
<h2 id='lines.thres2'>
Add threshold lines to a plot (two-state setting)
</h2><span id='topic+lines.thres2'></span>

<h3>Description</h3>

<p>The function includes vertical lines for the threshold and confidence interval in a plot created with <code>plot.thres2()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'thres2'
lines(x, ci = TRUE, which.boot = c("norm", "perc"),
  col = 1, lty = c(1, 2), lwd = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lines.thres2_+3A_x">x</code></td>
<td>

<p>an object of class <code>thres2</code>.
</p>
</td></tr>
<tr><td><code id="lines.thres2_+3A_ci">ci</code></td>
<td>

<p>should the confidence interval be plotted? Default, <code>TRUE</code>. No confidence interval will be plotted if <code>x</code> does not contain one (that is, <code>x$CI</code> is <code>NULL</code>).
</p>
</td></tr>
<tr><td><code id="lines.thres2_+3A_which.boot">which.boot</code></td>
<td>

<p>in case <code>x</code> contains confidence intervals calculated by bootstrapping, which one should be printed? The user can choose between <code>"norm"</code> (based on normal distribution) or <code>"perc"</code> (based on percentiles). Default, <code>"norm"</code>. This argument is ignored if the confidence intervals were calculated by the delta method.
</p>
</td></tr>
<tr><td><code id="lines.thres2_+3A_col">col</code></td>
<td>

<p>color for the threshold and its corresponding confidence interval. Default, 1.
</p>
</td></tr>
<tr><td><code id="lines.thres2_+3A_lty">lty</code></td>
<td>

<p>a 2-dimensional vector containing:
</p>
<p><code>lty[1]</code>: line type for the threshold
</p>
<p><code>lty[2]</code>: line type for the confidence interval
</p>
<p>Default, <code>c(1, 2)</code>. If <code>length(lty)</code> is not 2, <code>lty</code> will be recycled.
</p>
</td></tr>
<tr><td><code id="lines.thres2_+3A_lwd">lwd</code></td>
<td>

<p>line width for the threshold and its corresponding confidence interval. Default, 1.
</p>
</td></tr>
<tr><td><code id="lines.thres2_+3A_...">...</code></td>
<td>

<p>further arguments to be passed to <code>abline()</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>With a <code>plot.thres2</code> open, this function adds lines for the required threshold.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thres2">thres2</a></code>, <code><a href="#topic+plot.thres2">plot.thres2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n1 &lt;- 100
n2 &lt;- 100
set.seed(1234)
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.2
k1 &lt;- rnorm(n1, par1.1, par1.2) # non-diseased
k2 &lt;- rnorm(n2, par2.1, par2.2) # diseased

thres &lt;- thres2(k1, k2, rho, method="eq", ci.method="d")
plot(thres, col=c(1, 2, 4), lwd=c(2, 2, 1), leg.pos="topright")
thresunequal &lt;- thres2(k1, k2, rho, method="unequal", ci=FALSE)
lines(thresunequal, col=3) # almost the same; no confidence interval

## Not run: 
  thresboot &lt;- thres2(k1, k2, rho, method="emp", ci.method="b")
  lines(thresboot, col=5, which.boot="norm")

## End(Not run)
</code></pre>

<hr>
<h2 id='lines.thres3'>
Add threshold lines to a plot (three-state setting)
</h2><span id='topic+lines.thres3'></span>

<h3>Description</h3>

<p>The function includes vertical lines for the thresholds and confidence intervals in a plot created with <code>plot.thres3()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'thres3'
lines(x, ci = TRUE, which.boot = c("norm", "perc"),
  col = 1, lty = c(1, 2), lwd = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lines.thres3_+3A_x">x</code></td>
<td>

<p>an object of class <code>thres3</code>.
</p>
</td></tr>
<tr><td><code id="lines.thres3_+3A_ci">ci</code></td>
<td>

<p>should the confidence intervals be plotted? Default, <code>TRUE</code>. No confidence intervals will be plotted if <code>x</code> does not contain one (that is, <code>x$CI</code> is <code>NULL</code>).
</p>
</td></tr>
<tr><td><code id="lines.thres3_+3A_which.boot">which.boot</code></td>
<td>

<p>in case <code>x</code> contains confidence intervals calculated by bootstrapping, which one should be printed? the user can choose between <code>"norm"</code> (based on normal distribution) or <code>"perc"</code> (based on percentiles). Default, <code>"norm"</code>.  This argument is ignored if parametric confidence intervals were calculated. 
</p>
</td></tr>
<tr><td><code id="lines.thres3_+3A_col">col</code></td>
<td>

<p>color for the thresholds and their corresponding confidence intervals. Default, 1.
</p>
</td></tr>
<tr><td><code id="lines.thres3_+3A_lty">lty</code></td>
<td>

<p>a 2-dimensional vector containing:
</p>
<p><code>lty[1]</code>: line type for the thresholds
</p>
<p><code>lty[2]</code>: line type for the confidence intervals
</p>
<p>Default, <code>c(1, 2)</code>. If <code>length(lty)</code> is not 2, <code>lty</code> will be recycled.
</p>
</td></tr>
<tr><td><code id="lines.thres3_+3A_lwd">lwd</code></td>
<td>

<p>line width for the thresholds and their corresponding confidence intervals. Default, 1.
</p>
</td></tr>
<tr><td><code id="lines.thres3_+3A_...">...</code></td>
<td>

<p>further arguments to be passed to <code>abline()</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>With a <code>plot.thres3</code> open, this function adds lines for the required threshold estimates.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Fuster D, Carrasco JL. (2012). Optimum threshold estimation based on cost function in a multistate diagnostic setting. Statistics in Medicine, 31:1098-1109.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thres3">thres3</a></code>, <code><a href="#topic+plot.thres3">plot.thres3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
n &lt;- 100
k1 &lt;- rlnorm(n)
k2 &lt;- rnorm(n, 3, 1)
k3 &lt;- rnorm(n, 5, 1)
rho &lt;- c(1/3, 1/3, 1/3)

# assuming trinormality
start &lt;- c(mean(k1), mean(k3))
thres1 &lt;- thres3(k1, k2, k3, rho, dist1="norm", dist2="norm",
                 dist3="norm", start=start, ci.method="param") 

# not assuming trinormality
start2 &lt;- c(0.05, 0.6, 0.5, 0.95)
set.seed(2014)
thres2 &lt;- thres3(k1, k2, k3, rho, start=start2, B=1000,
                ci.method="boot", dist1="lnorm", dist2="norm",
                dist3="norm") 
plot(thres2, leg.pos="topright", leg.cex=0.8, col=1:4)
lines(thres1, col=5)
</code></pre>

<hr>
<h2 id='plot.thres2'>
Threshold and density plot (two-state setting)
</h2><span id='topic+plot.thres2'></span>

<h3>Description</h3>

<p>This function provides a graph including the sample densities (diseased and non-diseased populations), the threshold and its confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'thres2'
plot(x, bw = c("nrd0", "nrd0"), ci = TRUE,
  which.boot = c("norm", "perc"), col = c(1, 2, 3),
  lty = c(1, 1, 1, 2), lwd = c(1, 1, 1),
  legend = TRUE, leg.pos = "topleft", leg.cex = 1,
  xlim = NULL, ylim = NULL,
  main = paste0("Threshold estimate ", ifelse(ci, "and CI ", ""),
  "(method ", x$T$method, ")"),
  xlab = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.thres2_+3A_x">x</code></td>
<td>

<p>an object of class <code>thres2</code>.
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_bw">bw</code></td>
<td>

<p>vector containing the bandwith for the non-diseased sample in the first position and the bandwith for the diseased sample in the second position (to be passed to <code>density()</code>). Default, <code>c("nrd0", "nrd0")</code>.
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_ci">ci</code></td>
<td>

<p>should the confidence interval be plotted? Default, <code>TRUE</code>. No confidence interval will be plotted if <code>x</code> does not contain one (that is, <code>x$CI</code> is <code>NULL</code>).
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_which.boot">which.boot</code></td>
<td>

<p>in case <code>x</code> contains confidence intervals calculated by bootstrapping, which one should be printed? The user can choose between <code>"norm"</code> (based on normal distribution) or <code>"perc"</code> (based on percentiles). Default, <code>"norm"</code>. This argument is ignored if the confidence intervals were calculated by the delta method.
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_col">col</code></td>
<td>

<p>a 3-dimensional vector containing:
</p>
<p><code>col[1]</code>: color for the density of the non-diseased sample
</p>
<p><code>col[2]</code>: color for the density of the diseased sample
</p>
<p><code>col[3]</code>: color for the threshold and its corresponding confidence interval
</p>
<p>Default, <code>c(1, 2, 3)</code>. If <code>length(col)</code> is not 3, <code>col</code> will be recycled.
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_lty">lty</code></td>
<td>

<p>a 4-dimensional vector containing:
</p>
<p><code>lty[1]</code>: line type for the density of the non-diseased sample
</p>
<p><code>lty[2]</code>: line type for the density of the diseased sample
</p>
<p><code>lty[3]</code>: line type for the threshold
</p>
<p><code>lty[4]</code>: line type for the confidence interval
</p>
<p>Default, <code>c(1, 1, 1, 2)</code>. If <code>length(lty)</code> is not 4, <code>lty</code> will be recycled.
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_lwd">lwd</code></td>
<td>

<p>a 3-dimensional vector containing:
</p>
<p><code>lwd[1]</code>: line width for the density of the non-diseased sample
</p>
<p><code>lwd[2]</code>: line width for the density of the diseased sample
</p>
<p><code>lwd[3]</code>: line width for the threshold and its corresponding confidence interval
</p>
<p>Default, <code>c(1, 1, 1)</code>. If <code>length(lwd)</code> is not 3, <code>lwd</code> will be recycled.
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_legend">legend</code></td>
<td>

<p>logical asking if an automatic legend should be added to the graph. Default, <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_leg.pos">leg.pos</code></td>
<td>

<p>position of the legend. Default, <code>"topleft"</code>. Ignored if <code>legend=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_leg.cex">leg.cex</code></td>
<td>

<p>number that reescales the size of the legend. Ignored if <code>legend=FALSE</code>. Default, 1.
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_xlim">xlim</code></td>
<td>

<p>2-dimensional vector indicating the lower and upper limits for x-axis. Default value (NULL) sets those limits automatically.
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_ylim">ylim</code></td>
<td>

<p>2-dimensional vector indicating the lower and upper limits for y-axis. Default value (NULL) sets those limits automatically.
</p>
</td></tr>
<tr><td><code id="plot.thres2_+3A_main">main</code>, <code id="plot.thres2_+3A_xlab">xlab</code>, <code id="plot.thres2_+3A_...">...</code></td>
<td>

<p>further arguments to be passed to <code>plot()</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimates of the density functions for both samples and vertical lines representing the threshold and its confidence limits are drawn.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thres2">thres2</a></code>, <code><a href="#topic+lines.thres2">lines.thres2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n1 &lt;- 100
n2 &lt;- 100
set.seed(1234)
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.2
k1 &lt;- rnorm(n1, par1.1, par1.2) # non-diseased
k2 &lt;- rnorm(n2, par2.1, par2.2) # diseased

thres &lt;- thres2(k1, k2, rho, method="eq", ci.method="d")
plot(thres, col=c(1, 2, 4), lwd=c(2, 2, 1), leg.pos="topright")
</code></pre>

<hr>
<h2 id='plot.thres3'>
Thresholds and density plot (three-state setting)
</h2><span id='topic+plot.thres3'></span>

<h3>Description</h3>

<p>This function provides a graph including the three sample densities, the thresholds and their confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'thres3'
plot(x, bw = c("nrd0", "nrd0", "nrd0"), ci = TRUE,
  which.boot = c("norm", "perc"), col = c(1, 2, 3, 4),
  lty = c(1, 1, 1, 1, 2), lwd = c(1, 1, 1, 1),
  legend = TRUE, leg.pos = "topleft", leg.cex = 1,
  xlim = NULL, ylim = NULL,
  main = paste0("Threshold estimates", ifelse(ci, " and CIs", "")),
  xlab = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.thres3_+3A_x">x</code></td>
<td>

<p>an object of class <code>thres3</code>.
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_bw">bw</code></td>
<td>

<p>vector containing the bandwith for the first sample in the first position, the bandwith for the second sample in the second position and the bandwith for the third sample in the third position (to be passed to <code>density()</code>). Default, <code>c("nrd0", "nrd0", "nrd0")</code>.
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_ci">ci</code></td>
<td>

<p>should the confidence intervals be plotted? Default, <code>TRUE</code>. No confidence intervals will be plotted if <code>x</code> does not contain one (that is, <code>x$CI</code> is <code>NULL</code>).
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_which.boot">which.boot</code></td>
<td>

<p>in case <code>x</code> contains confidence intervals calculated by bootstrapping, which one should be printed? The user can choose between <code>"norm"</code> (based on normal distribution) or <code>"perc"</code> (based on percentiles). Default, <code>"norm"</code>. This argument is ignored if parametric confidence intervals were calculated. 
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_col">col</code></td>
<td>

<p>a 4-dimensional vector containing:
</p>
<p><code>col[1]</code>: color for the density of the first sample
</p>
<p><code>col[2]</code>: color for the density of the second sample
</p>
<p><code>col[3]</code>: color for the density of the third sample
</p>
<p><code>col[4]</code>: color for the thresholds and their corresponding confidence intervals
</p>
<p>Default, <code>c(1, 2, 3, 4)</code>. If <code>length(col)</code> is not 4, <code>col</code> will be recycled.
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_lty">lty</code></td>
<td>

<p>a 5-dimensional vector containing:
</p>
<p><code>lty[1]</code>: line type for the density of the first sample
</p>
<p><code>lty[2]</code>: line type for the density of the second sample
</p>
<p><code>lty[3]</code>: line type for the density of the third sample
</p>
<p><code>lty[4]</code>: line type for the thresholds
</p>
<p><code>lty[5]</code>: line type for the confidence intervals
</p>
<p>Default, <code>c(1, 1, 1, 1, 2)</code>. If <code>length(lty)</code> is not 5, <code>lty</code> will be recycled.
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_lwd">lwd</code></td>
<td>

<p>a 4-dimensional vector containing:
</p>
<p><code>lwd[1]</code>: line width for the density of the first sample
</p>
<p><code>lwd[2]</code>: line width for the density of the second sample
</p>
<p><code>lwd[3]</code>: line width for the density of the third sample
</p>
<p><code>lwd[4]</code>: line width for the thresholds and their corresponding confidence intervals
</p>
<p>Default, <code>c(1, 1, 1, 1)</code>. If <code>length(lwd)</code> is not 4, <code>lwd</code> will be recycled.
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_legend">legend</code></td>
<td>

<p>logical asking if an automatic legend should be added to the graph. Default, <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_leg.pos">leg.pos</code></td>
<td>

<p>position of the legend. Default, <code>"topleft"</code>. Ignored if <code>legend=FALSE</code>.
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_leg.cex">leg.cex</code></td>
<td>

<p>number that reescales the size of the legend. Ignored if <code>legend=FALSE</code>. Default, 1.
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_xlim">xlim</code></td>
<td>

<p>2-dimensional vector indicating the lower and upper limits for x-axis. Default value (NULL) sets those limits automatically.
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_ylim">ylim</code></td>
<td>

<p>2-dimensional vector indicating the lower and upper limits for y-axis. Default value (NULL) sets those limits automatically.
</p>
</td></tr>
<tr><td><code id="plot.thres3_+3A_main">main</code>, <code id="plot.thres3_+3A_xlab">xlab</code>, <code id="plot.thres3_+3A_...">...</code></td>
<td>

<p>further arguments to be passed to <code>plot()</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimates of the density functions for the three samples and vertical lines representing the thresholds and their confidence limits are drawn.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Fuster D, Carrasco JL. (2012). Optimum threshold estimation based on cost function in a multistate diagnostic setting. Statistics in Medicine, 31:1098-1109.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thres3">thres3</a></code>, <code><a href="#topic+lines.thres3">lines.thres3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
n &lt;- 100
k1 &lt;- rlnorm(n)
k2 &lt;- rnorm(n, 3, 1)
k3 &lt;- rnorm(n, 5, 1)
rho &lt;- c(1/3, 1/3, 1/3)

# assuming trinormality
start &lt;- c(mean(k1), mean(k3)) 
thres &lt;- thres3(k1, k2, k3, rho, dist1="norm", dist2="norm",
                dist3="norm", start=start, ci.method="param") 
plot(thres, leg.pos="topright")

# not assuming trinormality
thres &lt;- thres3(k1, k2, k3, rho, dist1="lnorm", dist2="norm",
                dist3="norm", ci.method="boot") 
plot(thres, leg.pos="topright", which.boot="perc")
</code></pre>

<hr>
<h2 id='plotCostROC'>
Plot cost function and ROC curve
</h2><span id='topic+plotCostROC'></span>

<h3>Description</h3>

<p>This function plots the ROC curve and the cost function associated to the disease prevalence and costs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCostROC(x, type = "l", which.plot, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCostROC_+3A_x">x</code></td>
<td>

<p>an object of class <code>thres2</code> or <code>thres3</code>. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="plotCostROC_+3A_type">type</code></td>
<td>

<p>1-character string giving the type of plot desired. Default, <code>"l"</code>. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="plotCostROC_+3A_which.plot">which.plot</code></td>
<td>

<p>which plot should be produced? The user can choose between <code>"both"</code> (default, which plots both cost function and ROC curve), <code>"cost"</code> (only plots cost function) or <code>"roc"</code> (only plots ROC curve). It only applies to objects of class <code>thres2</code>, therefore this argument has no effect if <code>x</code> is an object of class <code>thres3</code>.
</p>
</td></tr>
<tr><td><code id="plotCostROC_+3A_...">...</code></td>
<td>

<p>other graphical parameters to be passed to <code>plot()</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the argument <code>x</code> was constructed with <code>method="empirical"</code>, the argument <code>extra.info</code> should be switched to <code>TRUE</code> (this only applies when <code>x</code> is an object of class <code>thres2</code>).
</p>
<p>For parameter <code>type</code> the following values are possible: <code>"p"</code> for points, <code>"l"</code> for lines, <code>"b"</code> for both points and lines, <code>"c"</code> for empty points joined by lines, <code>"o"</code> for overplotted points and lines, <code>"s"</code> and <code>"S"</code> for stair steps and <code>"h"</code> for histogram-like vertical lines. Finally, <code>"n"</code> does not produce any points or lines.
</p>


<h3>Value</h3>

<p>When <code>x</code> is an object of class <code>thres2</code>, two plots are produced. The first one shows the cost function with the cost minimising threshold in red. The second one is the step ROC curve with the sensitivity and specificity achieved in red. If <code>method = "empirical"</code> is used when building <code>x</code>, empirical cost function and ROC curve are plotted. If <code>method = "smooth"</code> is used when building <code>x</code>, smooth cost function and ROC curve are plotted.
</p>
<p>When <code>x</code> is an object of class <code>thres3</code>, two plots are produced. The first one shows the cost function C(T1) with the first cost minimising threshold in red. The second one shows the cost function C(T2) with the second cost minimising threshold in red.
</p>


<h3>Note</h3>

<p>This function uses the <code>plot()</code> function and further arguments can be set to customise the resulting plot.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>
<p>Skaltsa K, Jover L, Fuster D, Carrasco JL. (2012). Optimum threshold estimation based on cost function in a multistate diagnostic setting. Statistics in Medicine, 31:1098-1109.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thres2">thres2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# example 1: x is an object of class 'thres2'
n1 &lt;- 100
n2 &lt;- 100
set.seed(19998)
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.3
k1 &lt;- rnorm(n1, par1.1, par1.2) # non-diseased
k2 &lt;- rnorm(n2, par2.1, par2.2) # diseased
x &lt;- thres2(k1, k2, rho, method="emp", ci.method="boot", extra=TRUE)

par(mfrow=c(1,2))
plotCostROC(x)


# example 2: x is an object of class 'thres3'
set.seed(2015)
n &lt;- 100
k1 &lt;- rlnorm(n)
k2 &lt;- rnorm(n, 3, 1)
k3 &lt;- rnorm(n, 5, 1)
rho &lt;- c(1/3, 1/3, 1/3)
y &lt;- thres3(k1, k2, k3, rho, B=1000, ci.method="boot", dist1="lnorm", dist2="norm", dist3="norm") 

par(mfrow=c(1,2))
plotCostROC(y)

## End(Not run)
</code></pre>

<hr>
<h2 id='secondDer2'>
Second partial derivative of the cost function (two-state setting)
</h2><span id='topic+secondDer2'></span>

<h3>Description</h3>

<p>This function calculates the second partial derivative of the cost function at a given threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>secondDer2(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="secondDer2_+3A_x">x</code></td>
<td>

<p>an object of class <code>thres2</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function evaluates the second derivative of the cost function at the threshold estimate so that the user can assess if this is positive (meaning that the estimation of the threshold leads to a minimum in the cost function) or close to zero and hence the minimum of the cost function does not exist. A closed formula is given when assuming binormality, otherwise the second derivative is evaluated numerically in the threshold estimate using functions from the package <code>numDeriv</code>.
</p>


<h3>Value</h3>

<p>The value of the second derivative of the cost function at the given threshold.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thres2">thres2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n1 &lt;- 100
n2 &lt;- 100
set.seed(1234)
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.2
k1 &lt;- rnorm(n1, par1.1, par1.2) # non-diseased
k2 &lt;- rnorm(n2, par2.1, par2.2) # diseased
x &lt;- thres2(k1, k2, rho, method="equal", ci.method="delta")
secondDer2(x)
</code></pre>

<hr>
<h2 id='secondDer3'>
Second partial derivative of the cost function (three-state setting)
</h2><span id='topic+secondDer3'></span>

<h3>Description</h3>

<p>This function calculates the second partial derivatives of the cost function at a given pair of thresholds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>secondDer3(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="secondDer3_+3A_x">x</code></td>
<td>

<p>an object of class <code>thres3</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function evaluates the second partial derivatives of the cost function at the threshold estimates so that the user can assess if these are positive (meaning that the estimation of the thresholds leads to a minimum in the cost function) or close to zero and hence the minimum of the cost function does not exist. A closed formula is given when assuming trinormality, otherwise the second derivatives are evaluated numerically in the threshold estimates using functions from the package <code>numDeriv</code>.
</p>


<h3>Value</h3>

<p>The value of the second derivative of the cost function at the given thresholds.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Fuster D, Carrasco JL. (2012). Optimum threshold estimation based on cost function in a multistate diagnostic setting. Statistics in Medicine, 31:1098-1109.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thres3">thres3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
n &lt;- 100
k1 &lt;- rlnorm(n)
k2 &lt;- rnorm(n, 3, 1)
k3 &lt;- rnorm(n, 5, 1)
rho &lt;- c(1/3, 1/3, 1/3)
start &lt;- c(mean(k1), mean(k3))
x &lt;- thres3(k1, k2, k3, rho, dist1="norm", dist2="norm",
            dist3="norm", start=start, ci.method="param") 

secondDer3(x)
</code></pre>

<hr>
<h2 id='SS'>
Sample size estimation (two-state setting)
</h2><span id='topic+SS'></span>

<h3>Description</h3>

<p>Estimates the sample size and the optimum sample size ratio needed for a given width, costs, disease prevalence and significance level under the assumption of binormality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SS(par1.1, par1.2, par2.1, par2.2=NULL, rho, width,
   costs=matrix(c(0, 0, 1, (1-rho)/rho), 2, 2, byrow=TRUE),
   R=NULL, var.equal=FALSE, alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SS_+3A_par1.1">par1.1</code></td>
<td>

<p>healthy population mean.
</p>
</td></tr>
<tr><td><code id="SS_+3A_par1.2">par1.2</code></td>
<td>

<p>healthy population standard deviation.
</p>
</td></tr>
<tr><td><code id="SS_+3A_par2.1">par2.1</code></td>
<td>

<p>diseased population mean.
</p>
</td></tr>
<tr><td><code id="SS_+3A_par2.2">par2.2</code></td>
<td>

<p>diseased population standard deviation. It can be omitted when assuming equal variances (that is, when <code>var.equal=TRUE</code>) and in this situation the common variance is assumed to be equal to <code>par1.2</code>.
</p>
</td></tr>
<tr><td><code id="SS_+3A_rho">rho</code></td>
<td>

<p>disease prevalence.
</p>
</td></tr>
<tr><td><code id="SS_+3A_width">width</code></td>
<td>

<p>desired interval width.
</p>
</td></tr>
<tr><td><code id="SS_+3A_costs">costs</code></td>
<td>

<p>cost matrix. Costs should be entered as a 2x2 matrix, where the first row corresponds to the true positive and true negative costs and the second row to the false positive and false negative costs. Default cost values are a combination of costs that yields R=1, which is equivalent to the Youden index method (for details about this concept, see <b>References</b>). It must be set to <code>NULL</code> if the user prefers to set <code>R</code> (see next argument).
</p>
</td></tr>
<tr><td><code id="SS_+3A_r">R</code></td>
<td>

<p>if the cost matrix <code>costs</code> is not set, R desired (the algorithm will choose a suitable combination of costs that leads to <code>R</code>). Default, <code>NULL</code> (which leads to R=1 using the default <code>costs</code>).
</p>
</td></tr>
<tr><td><code id="SS_+3A_var.equal">var.equal</code></td>
<td>

<p>a logical variable indicating whether to use equal variances. Default, <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="SS_+3A_alpha">alpha</code></td>
<td>

<p>significance level for the confidence interval. Default, 0.05.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>SS</code> which is a list with eight components:
</p>
<table>
<tr><td><code>ss2</code></td>
<td>
<p>sample size for the diseased group</p>
</td></tr>
<tr><td><code>ss1</code></td>
<td>
<p>sample size for the healthy group</p>
</td></tr>
<tr><td><code>epsilon</code></td>
<td>
<p>sample size ratio between non-diseased and diseased subjects</p>
</td></tr>
<tr><td><code>width</code></td>
<td>
<p>width of the confidence interval provided by the user</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>significance level provided by the user</p>
</td></tr>
<tr><td><code>costs</code></td>
<td>
<p>cost matrix provided by the user</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>R term, the product of the non-disease odds and the cost ratio (for further details about this concept, see <b>References</b>)</p>
</td></tr>
<tr><td><code>prev</code></td>
<td>
<p>disease prevalence provided by the user</p>
</td></tr>
</table>


<h3>References</h3>

<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.3
width &lt;- 0.5
SS(par1.1, par1.2, par2.1, par2.2, rho, width, var.equal=TRUE)
</code></pre>

<hr>
<h2 id='thres2'>
Threshold point estimation and confidence intervals (two-state setting)
</h2><span id='topic+thres2'></span>

<h3>Description</h3>

<p>This function calculates the threshold estimate and its corresponding confidence interval in a two-state setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thres2(k1, k2, rho,
  costs = matrix(c(0, 0, 1, (1 - rho)/rho), 2, 2, byrow = TRUE),
  R=NULL,
  method = c("equal", "unequal", "empirical", "smooth", "parametric"),
  dist1 = NULL, dist2 = NULL, ci = TRUE, ci.method = c("delta", "boot"),
  B = 1000, alpha = 0.05, extra.info = FALSE, na.rm = FALSE, q1=0.05, q2=0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thres2_+3A_k1">k1</code></td>
<td>

<p>vector containing the healthy sample values.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_k2">k2</code></td>
<td>

<p>vector containing the diseased sample values.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_rho">rho</code></td>
<td>

<p>disease prevalence.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_costs">costs</code></td>
<td>

<p>cost matrix. Costs should be entered as a 2x2 matrix, where the first row corresponds to the true positive and true negative costs and the second row to the false positive and false negative costs. Default cost values are a combination of costs that yields R=1, which is equivalent to the Youden index method (for details about this concept, see <b>References</b>). It must be set to <code>NULL</code> if the user prefers to set <code>R</code> (see next argument).
</p>
</td></tr>
<tr><td><code id="thres2_+3A_r">R</code></td>
<td>

<p>if the cost matrix <code>costs</code> is not set, R desired (the algorithm will choose a suitable combination of costs that leads to <code>R</code>). Default, <code>NULL</code> (which leads to R=1 using the default <code>costs</code>).
</p>
</td></tr>
<tr><td><code id="thres2_+3A_method">method</code></td>
<td>

<p>method used in the estimation. The user can specify just the initial letters. Default, <code>"equal"</code>. See <b>Details</b> for more information about the methods available.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_dist1">dist1</code></td>
<td>

<p>distribution to be assumed for the healthy population. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_dist2">dist2</code></td>
<td>

<p>distribution to be assumed for the diseased population. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_ci">ci</code></td>
<td>

<p>should a confidence interval be calculated? Default, <code>TRUE</code>. The user can set it to <code>FALSE</code> to supress the calculation of any confidence interval (in that case, arguments <code>ci.method</code>, <code>B</code> and <code>alpha</code> are ignored).
</p>
</td></tr>
<tr><td><code id="thres2_+3A_ci.method">ci.method</code></td>
<td>

<p>method to be used for the confidence intervals calculation. The user can specify just the initial letters. Default, <code>"delta"</code>. See <b>Details</b> for more information about the methods available.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_b">B</code></td>
<td>

<p>number of bootstrap resamples when <code>ci.method = "boot"</code>. Otherwise, ignored. Default, 1000.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_alpha">alpha</code></td>
<td>

<p>significance level for the confidence interval. Default, 0.05.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_extra.info">extra.info</code></td>
<td>

<p>when using <code>method="empirical"</code>, if set to <code>TRUE</code> the function returns extra information about the calculation of the threshold. Ignored when <code>method</code> is not <code>"empirical"</code>. Default, <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_na.rm">na.rm</code></td>
<td>

<p>a logical value indicating whether <code>NA</code> values in <code>k1</code> and <code>k2</code> should be stripped before the computation proceeds. Default, <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_q1">q1</code></td>
<td>

<p>probability of the left distribution in order to determine a low quantile when <code>method="parametric"</code> (ignored otherwise). Default, 0.05.
</p>
</td></tr>
<tr><td><code id="thres2_+3A_q2">q2</code></td>
<td>

<p>probability of the right distribution in order to determine a high quantile when <code>method="parametric"</code> (ignored otherwise). Default, 0.95.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For parameter <code>method</code> the user can choose between <code>"equal"</code> (assumes binormality and equal variances), <code>"unequal"</code> (assumes binormality and unequal variances), <code>"empirical"</code> (leaves out any distributional assumption), <code>"smooth"</code> (leaves out any distributional assumption, but uses a kernel to estimate the densities) or <code>"parametric"</code> (based on the distribution assumed for the two populations).
</p>
<p>Parameters <code>dist1</code> and <code>dist2</code> can be chosen between the following 2-parameter distributions: <code>"beta"</code>, <code>"cauchy"</code>, <code>"chisq"</code> (chi-squared), <code>"gamma"</code>, <code>"lnorm"</code> (lognormal), <code>"logis"</code> (logistic), <code>"norm"</code> (normal) and <code>"weibull"</code>. Notice that <code>dist1</code> and <code>dist2</code> are only needed when <code>method = "parametric"</code>.
</p>
<p>For parameter <code>ci.method</code> the user can choose between <code>"delta"</code> (delta method is used to estimate the threshold standard error assuming a binormal underlying model) or <code>"boot"</code> (the confidence interval is calculated by bootstrap).
</p>


<h3>Value</h3>

<p>An object of class <code>thres2</code>, which is a list with two components:
</p>
<table>
<tr><td><code>T</code></td>
<td>
<p>a list of at least seven components:
</p>
<p><code>thres</code>  threshold estimate.
</p>
<p><code>prev</code>  disease prevalence provided by the user.
</p>
<p><code>costs</code>  cost matrix provided by the user.
</p>
<p><code>R</code>  R term, the product of the non-disease odds and the cost ratio (for further details about this concept, see <b>References</b>).
</p>
<p><code>method</code>  method used in the estimation.
</p>
<p><code>k1</code>  vector containing the healthy sample values provided by the user.
</p>
<p><code>k2</code>  vector containing the diseased sample values provided by the user.
</p>
<p>When <code>method = "empirical"</code>, <code>T</code> also contains:
</p>
<p><code>sens</code>  sensitivity obtained.
</p>
<p><code>spec</code>  specificity obtained.
</p>
<p><code>cost</code>  the minimum cost associated with <code>T$thres</code>.
</p>
<p><code>tot.thres</code> vector of possible thresholds. Only if <code>extra.info = TRUE</code>.
</p>
<p><code>tot.cost</code> vector of empirical costs. Only if <code>extra.info = TRUE</code>.
</p>
<p><code>tot.spec.c</code>  complementary of the vector of empirical specificities (1-spec). Only if <code>extra.info = T</code>.
</p>
<p><code>tot.sens</code>  vector of empirical sensitivities. Only if <code>extra.info = TRUE</code>.
</p>
<p>When <code>method = "parametric"</code>, <code>T</code> also contains:
</p>
<p><code>dist1</code>  distribution assumed for the healthy population.
</p>
<p><code>dist2</code>  distribution assumed for the diseased population.
</p>
<p><code>pars1</code>  a numeric vector containing the estimation of the parameters of <code>dist1</code>.
</p>
<p><code>pars2</code>  a numeric vector containing the estimation of the parameters of <code>dist2</code>.
</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>When <code>ci.method = "delta"</code>, a list of five components:
</p>
<p><code>lower</code>  the lower limit of the confidence interval.
</p>
<p><code>upper</code>  the upper limit of the confidence interval.
</p>
<p><code>se</code>  the standard error used in the calculation of the confidence interval. 
</p>
<p><code>alpha</code>  significance level provided by the user.
</p>
<p><code>ci.method</code> method used for the confidence intervals calculation.
</p>
<p>When <code>ci.method = "boot"</code>, a list of eight components:
</p>
<p><code>low.norm</code>  the lower limit of the bootstrap confidence interval based on the normal distribution.
</p>
<p><code>up.norm</code>  the upper limit of the bootstrap confidence interval based on the normal distribution.
</p>
<p><code>se</code>  the bootstrap standard error used in the calculation of the confidence interval based on the normal distribution. 
</p>
<p><code>low.perc</code> the lower limit of the bootstrap confidence interval based on percentiles.
</p>
<p><code>up.perc</code>  the upper limit of the bootstrap confidence interval based on percentiles.
</p>
<p><code>alpha</code>  significance level provided by the user.
</p>
<p><code>B</code>  number of bootstrap resamples used.
</p>
<p><code>ci.method</code>  method used for the confidence intervals calculation.
</p>
<p>When <code>ci = FALSE</code>, <code>NULL</code>.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>It is assumed that <code>k1</code> is the sample with lower values. If that is not the case, <code>k1</code> and <code>k2</code> (and the corresponding parameters) are exchanged.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani RJ. (1993). An introduction to the bootstrap, Chapman &amp; Hall.
</p>
<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thresTH2">thresTH2</a></code>, <code><a href="#topic+plot.thres2">plot.thres2</a></code>, <code><a href="#topic+lines.thres2">lines.thres2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1
n1 &lt;- 100
n2 &lt;- 100
set.seed(1234)
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.2
k1 &lt;- rnorm(n1, par1.1, par1.2) # non-diseased
k2 &lt;- rnorm(n2, par2.1, par2.2) # diseased

thres2(k1, k2, rho, method="eq", ci.method="d")
thres2(k1, k2, rho, method="uneq", ci.method="d")
# specify R instead of (default) costs
thres2(k1, k2, rho, costs=NULL, R=2, method="uneq", ci.method="d")
## Not run: 
thres2(k1, k2, rho, method="empirical", ci.method="b")

# example 2
set.seed(1234)
k1 &lt;- rnorm(50, 10, 3)
k2 &lt;- rlnorm(55)
rho &lt;- 0.3
thres2(k1, k2, rho, method="param", ci.method="boot", dist1="norm", dist2="lnorm")

## End(Not run)

# supress confidence intervals calculation
thres2(k1, k2, rho, method="equal", ci=FALSE)
thres2(k1, k2, rho, method="empirical", ci=FALSE)

# example 3
n1 &lt;- 100
n2 &lt;- 100
set.seed(1234)
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.2
k1 &lt;- rnorm(n1, par1.1, par1.2) # non-diseased
k2 &lt;- rnorm(n2, par2.1, par2.2) # diseased
## Not run: 
thres2(k1, k2, rho, method="smooth", ci.method="b")

## End(Not run)

</code></pre>

<hr>
<h2 id='thres3'>
Threshold point estimation and confidence intervals (three-state setting)
</h2><span id='topic+thres3'></span>

<h3>Description</h3>

<p>This function calculates the threshold estimates and their corresponding confidence intervals in a three-state setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thres3(k1, k2, k3, rho,
  costs = matrix(c(0, 1, 1, rho[1]/rho[2], 0, rho[3]/rho[2], 1, 1, 0),
  3, 3, byrow = TRUE), dist1 = "norm", dist2 = "norm",
  dist3 = "norm", start = NULL, ci = TRUE, ci.method = c("param", "boot"),
  B = 1000, alpha = 0.05, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thres3_+3A_k1">k1</code></td>
<td>

<p>vector containing the first sample values.
</p>
</td></tr>
<tr><td><code id="thres3_+3A_k2">k2</code></td>
<td>

<p>vector containing the second sample values.
</p>
</td></tr>
<tr><td><code id="thres3_+3A_k3">k3</code></td>
<td>

<p>vector containing the third sample values.
</p>
</td></tr>
<tr><td><code id="thres3_+3A_rho">rho</code></td>
<td>

<p>3-dimensional vector of prevalences.
</p>
</td></tr>
<tr><td><code id="thres3_+3A_costs">costs</code></td>
<td>

<p>cost matrix. Costs should be entered as a 3x3 matrix, where the first row corresponds to the costs associated with the classification of subjects in state 1 (C11, C12 and C13), second row corresponds to the costs associated with the classification of subjects in state 2 (C21, C22 and C23) and the third row corresponds to the costs associated with classification of subjects in state 3 (C31, C32, C33), where Cij is the cost of classifying an individual of class i as class j. Default cost values are a combination of costs that leads to the same thresholds as the Youden index method (see <b>References</b> for details).
</p>
</td></tr>
<tr><td><code id="thres3_+3A_dist1">dist1</code></td>
<td>

<p>distribution to be assumed for the first population. Default, <code>"norm"</code>. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thres3_+3A_dist2">dist2</code></td>
<td>

<p>distribution to be assumed for the second population. Default, <code>"norm"</code>. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thres3_+3A_dist3">dist3</code></td>
<td>

<p>distribution to be assumed for the third population. Default, <code>"norm"</code>. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thres3_+3A_start">start</code></td>
<td>

<p>when the three distributions <code>dist1</code>, <code>dist2</code> and <code>dist3</code> are <code>"norm"</code>, a 2-dimensional vector containing starting values for the thresholds. The authors recommend to use the mean of the distribution with lower values and the mean of the distribution with higher values. If any distribution is not <code>"norm"</code>, this parameter is ignored. See <b>Details</b>. 
</p>
</td></tr>
<tr><td><code id="thres3_+3A_ci">ci</code></td>
<td>

<p>should a confidence interval be calculated? Default, <code>TRUE</code>. The user can set it to <code>FALSE</code> to supress the calculation of any confidence interval (in that case, arguments <code>ci.method</code>, <code>B</code> and <code>alpha</code> are ignored).
</p>
</td></tr>
<tr><td><code id="thres3_+3A_ci.method">ci.method</code></td>
<td>

<p>method to be used for the confidence intervals calculation. The user can specify just the initial letters. Default, <code>"param"</code>. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thres3_+3A_b">B</code></td>
<td>

<p>number of bootstrap resamples when <code>ci.method = "boot"</code>. Otherwise, ignored. Default, 1000.
</p>
</td></tr>
<tr><td><code id="thres3_+3A_alpha">alpha</code></td>
<td>

<p>significance level for the confidence interval. Default, 0.05.
</p>
</td></tr>
<tr><td><code id="thres3_+3A_na.rm">na.rm</code></td>
<td>

<p>a logical value indicating whether <code>NA</code> values in <code>k1</code>, <code>k2</code> and <code>k3</code> should be stripped before the computation proceeds. Default, <code>FALSE</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters <code>dist1</code>, <code>dist2</code> and <code>dist3</code> can be chosen between the following 2-parameter distributions: <code>"beta"</code>, <code>"cauchy"</code>, <code>"chisq"</code> (chi-squared), <code>"gamma"</code>, <code>"lnorm"</code> (lognormal), <code>"logis"</code> (logistic), <code>"norm"</code> (normal) and <code>"weibull"</code>.
</p>
<p>For parameter <code>ci.method</code> the user can choose between <code>"param"</code> (parametric confidence intervals are calculated when assuming a trinormal underlying model) and <code>"boot"</code> (the confidence intervals are calculated by bootstrap).
</p>
<p>When at least one of the distributions is not <code>"norm"</code>, the function internally uses the <code>thresTH3()</code> function, which requires two intervals in which the two thresholds are expected to be found. These intervals are determined by the default values of <code>thresTH3()</code>. When all the distributions are <code>"norm"</code>, the function uses the <code>nlm()</code> function, which requires two starting values (passed through the argument <code>start</code>).
</p>


<h3>Value</h3>

<p>An object of class <code>thres3</code>, which is a list with two components:
</p>
<table>
<tr><td><code>T</code></td>
<td>
<p>a list of at least ten components:
</p>
<p><code>thres1</code>  first threshold estimate.
</p>
<p><code>thres2</code>  second threshold estimate.
</p>
<p><code>prev</code>  prevalences provided by the user.
</p>
<p><code>costs</code>  cost matrix provided by the user.
</p>
<p><code>k1</code>  vector containing the first sample values provided by the user.
</p>
<p><code>k2</code>  vector containing the second sample values provided by the user.
</p>
<p><code>k3</code>  vector containing the third sample values provided by the user.
</p>
<p><code>dist1</code>  distribution assumed for the first population.
</p>
<p><code>dist2</code>  distribution assumed for the second population.
</p>
<p><code>dist3</code>  distribution assumed for the third population.
</p>
<p>When not all distributions are normal, <code>T</code> also contains:
</p>
<p><code>pars1</code>  a numeric vector containing the estimation of the parameters of <code>dist1</code>.
</p>
<p><code>pars2</code>  a numeric vector containing the estimation of the parameters of <code>dist2</code>.
</p>
<p><code>pars3</code>  a numeric vector containing the estimation of the parameters of <code>dist3</code>.
</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>When <code>ci.method = "param"</code>, a list of six components:
</p>
<p><code>lower1</code>  the lower limit of the confidence interval for the first threshold.
</p>
<p><code>upper1</code>  the upper limit of the confidence interval for the first threshold.
</p>
<p><code>lower2</code>  the lower limit of the confidence interval for the second threshold.
</p>
<p><code>upper2</code>  the upper limit of the confidence interval for the second threshold.
</p>
<p><code>alpha</code>  significance level provided by the user.
</p>
<p><code>ci.method</code> method used for the confidence intervals calculation.
</p>
<p>When <code>ci.method = "boot"</code>, a list of eleven components:
</p>
<p><code>low.norm1</code>  the lower limit of the bootstrap confidence interval for the first threshold based on the normal distribution.
</p>
<p><code>up.norm1</code>  the upper limit of the bootstrap confidence interval for the first threshold based on the normal distribution.
</p>
<p><code>low.norm2</code>  the lower limit of the bootstrap confidence interval for the second threshold based on the normal distribution.
</p>
<p><code>up.norm2</code>  the upper limit of the bootstrap confidence interval for the second threshold based on the normal distribution.
</p>
<p><code>low.perc1</code> the lower limit of the bootstrap confidence interval for the first threshold based on percentiles.
</p>
<p><code>up.perc1</code>  the upper limit of the bootstrap confidence interval for the first threshold based on percentiles.
</p>
<p><code>low.perc2</code> the lower limit of the bootstrap confidence interval for the second threshold based on percentiles.
</p>
<p><code>up.perc2</code>  the upper limit of the bootstrap confidence interval for the second threshold based on percentiles.
</p>
<p><code>alpha</code>  significance level.
</p>
<p><code>B</code>  number of bootstrap resamples.
</p>
<p><code>ci.method</code>  method used for the confidence intervals calculation.
</p>
<p>When <code>ci = FALSE</code>, <code>NULL</code>.
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>It is assumed that <code>k1</code> is the sample with lower values and <code>k3</code> is the one taking higher values. If that is not the case, <code>k1</code>, <code>k2</code> and <code>k3</code> (and the corresponding parameters) are re-ordered as needed.
</p>


<h3>References</h3>

<p>Efron B, Tibshirani RJ. (1993). An introduction to the bootstrap, Chapman &amp; Hall.
</p>
<p>Skaltsa K, Jover L, Fuster D, Carrasco JL. (2012). Optimum threshold estimation based on cost function in a multistate diagnostic setting. Statistics in Medicine, 31:1098-1109.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+thresTH3">thresTH3</a></code>, <code><a href="#topic+plot.thres3">plot.thres3</a></code>, <code><a href="#topic+lines.thres3">lines.thres3</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
n &lt;- 100
k1 &lt;- rlnorm(n)
k2 &lt;- rnorm(n, 3, 1)
k3 &lt;- rnorm(n, 5, 1)
rho &lt;- c(1/3, 1/3, 1/3)

# assuming trinormality
start &lt;- c(mean(k1), mean(k3))
thres3(k1, k2, k3, rho, dist1="norm", dist2="norm", dist3="norm", start=start, ci.method="param") 

# not assuming trinormality
thres3(k1, k2, k3, rho, B=1000, ci.method="boot", dist1="lnorm", dist2="norm", dist3="norm")

# supress confidence intervals calculation
thres3(k1, k2, k3, rho, ci=FALSE, dist1="lnorm", dist2="norm", dist3="norm")
</code></pre>

<hr>
<h2 id='thresTH2'>
Population-based threshold calculation (two-state setting)
</h2><span id='topic+thresTH2'></span>

<h3>Description</h3>

<p>This function estimates the theoretical optimum threshold for the specific distribution parameters, decision costs and disease prevalence in a two-state setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thresTH2(dist1, dist2, par1.1, par1.2, par2.1, par2.2, rho,
  costs = matrix(c(0, 0, 1, (1 - rho)/rho), 2, 2, byrow = TRUE), 
  R=NULL, q1 = 0.05, q2 = 0.95, tol = 10^(-8))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thresTH2_+3A_dist1">dist1</code></td>
<td>

<p>distribution to be assumed for the healthy population. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thresTH2_+3A_dist2">dist2</code></td>
<td>

<p>distribution to be assumed for the diseased population. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thresTH2_+3A_par1.1">par1.1</code></td>
<td>

<p>first parameter of the distribution chosen for the healthy population.
</p>
</td></tr>
<tr><td><code id="thresTH2_+3A_par1.2">par1.2</code></td>
<td>

<p>second parameter of the distribution chosen for the healthy population.
</p>
</td></tr>
<tr><td><code id="thresTH2_+3A_par2.1">par2.1</code></td>
<td>

<p>first parameter of the distribution chosen for the diseased population.
</p>
</td></tr>
<tr><td><code id="thresTH2_+3A_par2.2">par2.2</code></td>
<td>

<p>second parameter of the distribution chosen for the diseased population.
</p>
</td></tr>
<tr><td><code id="thresTH2_+3A_rho">rho</code></td>
<td>

<p>disease prevalence.
</p>
</td></tr>
<tr><td><code id="thresTH2_+3A_costs">costs</code></td>
<td>

<p>cost matrix. Costs should be entered as a 2x2 matrix, where the first row corresponds to the true positive and true negative costs and the second row to the false positive and false negative costs. Default cost values are a combination of costs that yields R=1, which is equivalent to the Youden index method (for details about this concept, see <b>References</b>). It must be set to <code>NULL</code> if the user prefers to set <code>R</code> (see next argument).
</p>
</td></tr>
<tr><td><code id="thresTH2_+3A_r">R</code></td>
<td>

<p>if the cost matrix <code>costs</code> is not set, R desired (the algorithm will choose a suitable combination of costs that leads to <code>R</code>). Default, <code>NULL</code> (which leads to R=1 using the default <code>costs</code>).
</p>
</td></tr>
<tr><td><code id="thresTH2_+3A_q1">q1</code></td>
<td>

<p>probability of the left distribution in order to determine a low quantile. Default, 0.05.
</p>
</td></tr>
<tr><td><code id="thresTH2_+3A_q2">q2</code></td>
<td>

<p>probability of the right distribution in order to determine a high quantile. Default, 0.95.
</p>
</td></tr>
<tr><td><code id="thresTH2_+3A_tol">tol</code></td>
<td>

<p>tolerance to be used in function <code>uniroot</code>. Default, 10^(-8).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters <code>dist1</code> and <code>dist2</code> can be chosen between the following 2-parameter distributions: <code>"beta"</code>, <code>"cauchy"</code>, <code>"chisq"</code> (chi-squared), <code>"gamma"</code>, <code>"lnorm"</code> (lognormal), <code>"logis"</code> (logistic), <code>"norm"</code> (normal) and <code>"weibull"</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>thresTH2</code>, which is a list with five components:
</p>
<table>
<tr><td><code>thres</code></td>
<td>
<p>threshold estimate.</p>
</td></tr>
<tr><td><code>prev</code></td>
<td>
<p>disease prevalence provided by the user.</p>
</td></tr>
<tr><td><code>costs</code></td>
<td>
<p>cost matrix provided by the user.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>R term, the product of the non-disease odds and the cost ratio (for further details about this concept, see <b>References</b>).</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method used in the estimation. For an object of class <code>thresTH2</code> it is always equal to <code>"theoretical"</code> (meaning that the population-based method has been used).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>It is assumed that <code>dist1</code> is the distribution with lower values. If not, <code>dist1</code> and <code>dist2</code> (and the corresponding parameters) are exchanged.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Carrasco JL. (2010). Estimation of the diagnostic threshold accounting for decision costs and sampling uncertainty. Biometrical Journal 52(5):676-697.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1
dist1 &lt;- "norm"
dist2 &lt;- "norm"
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
rho &lt;- 0.1

thresTH2(dist1, dist2, par1.1, par1.2, par2.1, par2.2, rho)


# example 2
dist1 &lt;- "norm"
dist2 &lt;- "lnorm"
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 1
par2.2 &lt;- 0.5
rho &lt;- 0.3

thresTH2(dist1, dist2, par1.1, par1.2, par2.1, par2.2, rho)
</code></pre>

<hr>
<h2 id='thresTH3'>
Population-based threshold calculation (three-state setting)
</h2><span id='topic+thresTH3'></span>

<h3>Description</h3>

<p>This function estimates the theoretical optimum thresholds for the specific distribution parameters, decision costs and prevalences in a three-state setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thresTH3(dist1, dist2, dist3, par1.1, par1.2,
  par2.1, par2.2, par3.1, par3.2, rho,
  costs = matrix(c(0, 1, 1, rho[1]/rho[2], 0, rho[3]/rho[2], 1, 1, 0),
  3, 3, byrow = TRUE), q1=0.05, q2=0.5, q3=0.95, tol = 10^(-8))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thresTH3_+3A_dist1">dist1</code></td>
<td>

<p>distribution to be assumed for the first population. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_dist2">dist2</code></td>
<td>

<p>distribution to be assumed for the second population. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_dist3">dist3</code></td>
<td>

<p>distribution to be assumed for the third population. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_par1.1">par1.1</code></td>
<td>

<p>first parameter of the first distribution.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_par1.2">par1.2</code></td>
<td>

<p>second parameter of the first distribution.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_par2.1">par2.1</code></td>
<td>

<p>first parameter of the second distribution.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_par2.2">par2.2</code></td>
<td>

<p>second parameter of the second distribution.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_par3.1">par3.1</code></td>
<td>

<p>first parameter of the third distribution.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_par3.2">par3.2</code></td>
<td>

<p>second parameter of the third distribution.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_rho">rho</code></td>
<td>

<p>3-dimensional vector of prevalences.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_costs">costs</code></td>
<td>

<p>cost matrix. Costs should be entered as a 3x3 matrix, where the first row corresponds to the costs associated with the classification of subjects in state 1 (C11, C12 and C13), second row corresponds to the costs associated with the classification of subjects in state 2 (C21, C22 and C23) and the third row corresponds to the costs associated with classification of subjects in state 3 (C31, C32, C33), where Cij is the cost of classifying an individual of class i as class j. Default cost values are a combination of costs that leads to the same thresholds as the Youden index method (see <b>References</b> for details).
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_q1">q1</code></td>
<td>

<p>probability of the distribution taking lower values in order to determine a low quantile. Default, 0.05. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_q2">q2</code></td>
<td>

<p>probability of the middle distribution in order to determine a medium quantile. Default, 0.5. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_q3">q3</code></td>
<td>

<p>probability of the the distribution taking higher values in order to determine a high quantile. Default, 0.95. See <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="thresTH3_+3A_tol">tol</code></td>
<td>

<p>tolerance to be used in function <code>uniroot</code>. Default, 10^(-8).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Parameters <code>dist1</code>, <code>dist2</code> and <code>dist3</code> can be chosen between the following 2-parameter distributions: <code>"beta"</code>, <code>"cauchy"</code>, <code>"chisq"</code> (chi-squared), <code>"gamma"</code>, <code>"lnorm"</code> (lognormal), <code>"logis"</code> (logistic), <code>"norm"</code> (normal) and <code>"weibull"</code>.
</p>
<p>Parameters <code>q1</code>, <code>q2</code> and <code>q3</code> are used to determine two intervals where the <code>uniroot</code> function should look for the two threshold estimates. Thus, the first threshold is expected to be found between <code>quantile-1(q1)</code> and <code>quantile-2(q2)</code> and the second one, between <code>quantile-2(q2)</code> and <code>quantile-3(q3)</code>, being <code>quantile-i()</code> the quantile function for the i-th distribution, i=1,2,3.
</p>


<h3>Value</h3>

<p>An object of class <code>thresTH3</code>, which is a list with five components:
</p>
<table>
<tr><td><code>thres1</code></td>
<td>
<p>first threshold estimate.</p>
</td></tr>
<tr><td><code>thres2</code></td>
<td>
<p>second threshold estimate.</p>
</td></tr>
<tr><td><code>prev</code></td>
<td>
<p>prevalences provided by the user.</p>
</td></tr>
<tr><td><code>costs</code></td>
<td>
<p>cost matrix provided by the user.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>method used in the estimation. For an object of class <code>thresTH3</code> it is always equal to <code>"theoretical"</code> (meaning that the population-based method has been used).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>It is assumed that <code>dist1</code> is the distribution with lower values and <code>dist3</code> is the one taking higher values. If that is not the case, <code>dist1</code>, <code>dist2</code> and <code>dist3</code> (and the corresponding parameters) are re-ordered as needed.
</p>


<h3>References</h3>

<p>Skaltsa K, Jover L, Fuster D, Carrasco JL. (2012). Optimum threshold estimation based on cost function in a multistate diagnostic setting. Statistics in Medicine, 31:1098-1109.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example 1
dist &lt;- "norm"
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 2
par2.2 &lt;- 1
par3.1 &lt;- 4
par3.2 &lt;- 1
rho &lt;- c(1/3, 1/3, 1/3)

thresTH3(dist, dist, dist,
  par2.1, par2.2, par1.1, par1.2,
  par3.1, par3.2, rho)
  
  
# example 2
dist1 &lt;- "norm"
dist2 &lt;- "lnorm"
dist3 &lt;- "lnorm"
par1.1 &lt;- 0
par1.2 &lt;- 1
par2.1 &lt;- 1
par2.2 &lt;- 0.5
par3.1 &lt;- 2
par3.2 &lt;- 0.5
rho &lt;- rep(1/3, 3)

thresTH3(dist1, dist2, dist3, par1.1, par1.2, par2.1, par2.2, par3.1, par3.2, rho)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
