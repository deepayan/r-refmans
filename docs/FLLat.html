<!DOCTYPE html><html><head><title>Help for package FLLat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FLLat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FLLat'><p>Fused Lasso Latent Feature Model</p></a></li>
<li><a href='#FLLat.BIC'><p>Optimal Tuning Parameters for the Fused Lasso Latent Feature</p>
Model</a></li>
<li><a href='#FLLat.FDR'><p>False Discovery Rate for the Fused Lasso Latent Feature Model</p></a></li>
<li><a href='#FLLat.PVE'><p>Choosing the Number of Features for the Fused Lasso Latent Feature</p>
Model</a></li>
<li><a href='#plot.FLLat'><p>Plots Results from the Fused Lasso Latent Feature Model</p></a></li>
<li><a href='#predict.FLLat'><p>Predicted Values and Weights based on the Fused Lasso Latent</p>
Feature Model</a></li>
<li><a href='#simaCGH'><p>Simulated aCGH Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.2-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-05-23</td>
</tr>
<tr>
<td>Title:</td>
<td>Fused Lasso Latent Feature Model</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, gplots</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits the Fused Lasso Latent Feature model, which is used for modeling multi-sample aCGH data to identify regions of copy number variation (CNV).  Produces a set of features that describe the patterns of CNV and a set of weights that describe the composition of each sample.  Also provides functions for choosing the optimal tuning parameters and the appropriate number of features, and for estimating the false discovery rate.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-05-22 23:41:18 UTC; gennowak</td>
</tr>
<tr>
<td>Author:</td>
<td>Gen Nowak [aut, cre],
  Trevor Hastie [aut],
  Jonathan R. Pollack [aut],
  Robert Tibshirani [aut],
  Nicholas Johnson [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gen Nowak &lt;gen.nowak@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-05-23 03:42:21 UTC</td>
</tr>
</table>
<hr>
<h2 id='FLLat'>Fused Lasso Latent Feature Model</h2><span id='topic+FLLat'></span>

<h3>Description</h3>

<p>Fits the Fused Lasso Latent Feature (FLLat) model for given
values of <code class="reqn">J</code> (the number of features), and <code class="reqn">\lambda_1</code> and
<code class="reqn">\lambda_2</code> (the two fused lasso tuning parameters).</p>


<h3>Usage</h3>

<pre><code class='language-R'>FLLat(Y, J=min(15,floor(ncol(Y)/2)), B="pc", lam1, lam2, thresh=10^(-4),
      maxiter=100, maxiter.B=1, maxiter.T=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FLLat_+3A_y">Y</code></td>
<td>
<p>A matrix of data from an aCGH experiment (usually in the form
of log intensity ratios) or some other type of copy number data.  Rows
correspond to the probes and columns correspond to the samples.</p>
</td></tr>
<tr><td><code id="FLLat_+3A_j">J</code></td>
<td>
<p>The number of features in the FLLat model.  The default is
the smaller of either <code class="reqn">15</code> or the number of samples divided by
<code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="FLLat_+3A_b">B</code></td>
<td>
<p>The initial values for the features.  Can be one of
<code>"pc"</code> (the first <code>J</code> principal components of <code>Y</code>),
<code>"rand"</code> (a random selection of <code>J</code> columns of <code>Y</code>), or
a user specified matrix of initial values, where rows correspond to
the probes and columns correspond to the features.  The default is
<code>"pc"</code>.</p>
</td></tr>
<tr><td><code id="FLLat_+3A_lam1">lam1</code></td>
<td>
<p>The tuning parameter <code class="reqn">\lambda_1</code> in the fused lasso
penalty that controls the level of sparsity in the features.</p>
</td></tr>
<tr><td><code id="FLLat_+3A_lam2">lam2</code></td>
<td>
<p>The tuning parameter <code class="reqn">\lambda_2</code> in the fused lasso
penalty that controls the level of smoothness in the features.</p>
</td></tr>
<tr><td><code id="FLLat_+3A_thresh">thresh</code></td>
<td>
<p>The threshold for determining when the solutions have
converged.  The default is <code class="reqn">10^{-4}</code>.</p>
</td></tr>
<tr><td><code id="FLLat_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations for the outer loop of
the algorithm.  The default is <code class="reqn">100</code>.</p>
</td></tr>
<tr><td><code id="FLLat_+3A_maxiter.b">maxiter.B</code></td>
<td>
<p>The maximum number of iterations for the inner loop
of the algorithm for estimating the features <code class="reqn">B</code>.  The default is
<code class="reqn">1</code>.  Increasing this may decrease the number of iterations for the
outer loop but may still increase total run time.</p>
</td></tr>
<tr><td><code id="FLLat_+3A_maxiter.t">maxiter.T</code></td>
<td>
<p>The maximum number of iterations for the inner loop
of the algorithm for estimating the weights <code class="reqn">\Theta</code>.  The default
is <code class="reqn">1</code>.  Increasing this may decrease the number of iterations for the
outer loop but may still increase total run time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits the Fused Lasso Latent Feature model to
multi-sample aCGH data, as described in Nowak and others (2011), for
given values of <code class="reqn">J</code>, <code class="reqn">\lambda_1</code> and <code class="reqn">\lambda_2</code>.  Given
aCGH data consisting of <code class="reqn">S</code> samples and <code class="reqn">L</code> probes, the model
is given by: </p>
<p style="text-align: center;"><code class="reqn">Y=B\Theta,</code>
</p>
<p> where <code class="reqn">Y</code> is an <code class="reqn">L</code>-by-<code class="reqn">S</code>
matrix denoting the aCGH data (with samples in columns), <code class="reqn">B</code> is an
<code class="reqn">L</code>-by-<code class="reqn">J</code> matrix denoting the features (with features in
columns), and <code class="reqn">\Theta</code> is a <code class="reqn">J</code>-by-<code class="reqn">S</code> matrix denoting the
weights.  Each feature describes a pattern of copy number variation
and the weights describe the composition of each sample.
Specifically, each sample (column of <code class="reqn">Y</code>) is modeled as a
weighted sum of the features (columns of <code class="reqn">B</code>), with the weights
given by the corresponding column of <code class="reqn">\Theta</code>.
</p>
<p>The model is fitted by minimizing a penalized version of the residual
sum of squares (RSS): </p>
<p style="text-align: center;"><code class="reqn">RSS + \sum_{j=1}^J PEN_j</code>
</p>
<p> where the penalty is given by: </p>
<p style="text-align: center;"><code class="reqn">PEN_j =
  \lambda_1\sum_{l=1}^L\left|\beta_{lj}\right| +
  \lambda_2\sum_{l=2}^L\left|\beta_{lj} -
  \beta_{l-1,j}\right|.</code>
</p>

<p>Here <code class="reqn">\beta_{lj}</code> denotes the <code class="reqn">(l,j)</code>th element of <code class="reqn">B</code>.
We also constrain the <code class="reqn">L_2</code> norm of each row of <code class="reqn">\Theta</code> to be
less than or equal to <code class="reqn">1</code>.
</p>
<p>For more details, please see Nowak and others (2011) and the package
vignette.
</p>


<h3>Value</h3>

<p>An object of class <code>FLLat</code> with components:
</p>
<table>
<tr><td><code>Beta</code></td>
<td>
<p>The estimated features <code class="reqn">\hat{B}</code>.</p>
</td></tr>
<tr><td><code>Theta</code></td>
<td>
<p>The estimated weights <code class="reqn">\hat{\Theta}</code>.</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>The number of iterations taken by the algorithm (outer
loop).</p>
</td></tr>
<tr><td><code>rss</code></td>
<td>
<p>The residual sum of squares of the fitted model.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>The BIC for the fitted model.  See <code><a href="#topic+FLLat.BIC">FLLat.BIC</a></code>
for more details.</p>
</td></tr>
<tr><td><code>lam1</code></td>
<td>
<p>The value of <code class="reqn">\lambda_1</code> used in the model.</p>
</td></tr>
<tr><td><code>lam2</code></td>
<td>
<p>The value of <code class="reqn">\lambda_2</code> used in the model.</p>
</td></tr>
</table>
<p>There is a <code><a href="base.html#topic+plot">plot</a></code> method and a <code><a href="stats.html#topic+predict">predict</a></code>
method for <code>FLLat</code> objects.
</p>


<h3>Author(s)</h3>

<p>Gen Nowak <a href="mailto:gen.nowak@gmail.com">gen.nowak@gmail.com</a>, Trevor Hastie, Jonathan
R. Pollack, Robert Tibshirani and Nicholas Johnson.</p>


<h3>References</h3>

<p>G. Nowak, T. Hastie, J. R. Pollack and R. Tibshirani.  A
Fused Lasso Latent Feature Model for Analyzing Multi-Sample aCGH
Data. <em>Biostatistics</em>, 2011, doi: 10.1093/biostatistics/kxr012</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.FLLat">plot.FLLat</a></code>, <code><a href="#topic+predict.FLLat">predict.FLLat</a></code>,
<code><a href="#topic+FLLat.BIC">FLLat.BIC</a></code>, <code><a href="#topic+FLLat.PVE">FLLat.PVE</a></code>,
<code><a href="#topic+FLLat.FDR">FLLat.FDR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load simulated aCGH data.
data(simaCGH)

## Run FLLat for J = 5, lam1 = 1 and lam2 = 9.
result &lt;- FLLat(simaCGH,J=5,lam1=1,lam2=9)

## Plot the estimated features.
plot(result)

## Plot a heatmap of the estimated weights.
plot(result,type="weights")
</code></pre>

<hr>
<h2 id='FLLat.BIC'>Optimal Tuning Parameters for the Fused Lasso Latent Feature
Model</h2><span id='topic+FLLat.BIC'></span>

<h3>Description</h3>

<p>Returns the optimal values of the fused lasso tuning
parameters for the Fused Lasso Latent Feature (FLLat) model by
minimizing the BIC.  Also returns the fitted FLLat model for the
optimal values of the tuning parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>FLLat.BIC(Y, J=min(15,floor(ncol(Y)/2)), B="pc", thresh=10^(-4), maxiter=100,
          maxiter.B=1, maxiter.T=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FLLat.BIC_+3A_y">Y</code></td>
<td>
<p>A matrix of data from an aCGH experiment (usually in the form
of log intensity ratios) or some other type of copy number data.  Rows
correspond to the probes and columns correspond to the samples.</p>
</td></tr>
<tr><td><code id="FLLat.BIC_+3A_j">J</code></td>
<td>
<p>The number of features in the FLLat model.  The default is
the smaller of either <code class="reqn">15</code> or the number of samples divided by
<code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="FLLat.BIC_+3A_b">B</code></td>
<td>
<p>The initial values for the features.  Can be one of
<code>"pc"</code> (the first <code>J</code> principal components of <code>Y</code>),
<code>"rand"</code> (a random selection of <code>J</code> columns of <code>Y</code>), or
a user specified matrix of initial values, where rows correspond to
the probes and columns correspond to the features.  The default is
<code>"pc"</code>.</p>
</td></tr>
<tr><td><code id="FLLat.BIC_+3A_thresh">thresh</code></td>
<td>
<p>The threshold for determining when the solutions have
converged.  The default is <code class="reqn">10^{-4}</code>.</p>
</td></tr>
<tr><td><code id="FLLat.BIC_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations for the outer loop of
the FLLat algorithm.  The default is <code class="reqn">100</code>.</p>
</td></tr>
<tr><td><code id="FLLat.BIC_+3A_maxiter.b">maxiter.B</code></td>
<td>
<p>The maximum number of iterations for the inner loop
of the FLLat algorithm for estimating the features <code class="reqn">B</code>.  The default is
<code class="reqn">1</code>.  Increasing this may decrease the number of iterations for the
outer loop but may still increase total run time.</p>
</td></tr>
<tr><td><code id="FLLat.BIC_+3A_maxiter.t">maxiter.T</code></td>
<td>
<p>The maximum number of iterations for the inner loop
of the FLLat algorithm for estimating the weights <code class="reqn">\Theta</code>.  The default
is <code class="reqn">1</code>.  Increasing this may decrease the number of iterations for the
outer loop but may still increase total run time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns the optimal values of the fused lasso tuning
parameters, <code class="reqn">\lambda_1</code> and <code class="reqn">\lambda_2</code>, for the FLLat model.
The optimal values are chosen by first
re-parameterizing <code class="reqn">\lambda_1</code> and <code class="reqn">\lambda_2</code> in terms of
<code class="reqn">\lambda_0</code> and a proportion <code class="reqn">\alpha</code> such that
<code class="reqn">\lambda_1=\alpha\lambda_0</code> and
<code class="reqn">\lambda_2=(1-\alpha)\lambda_0</code>.
The values of <code class="reqn">\alpha</code> are fixed to be
<code class="reqn">\{0.1, 0.3, 0.5, 0.7, 0.9\}</code> and for
each value of <code class="reqn">\alpha</code> we consider a range of <code class="reqn">\lambda_0</code>
values.  The optimal values of <code class="reqn">\lambda_0</code> and <code class="reqn">\alpha</code> (and
consequently <code class="reqn">\lambda_1</code> and <code class="reqn">\lambda_2</code>) are chosen by
minimizing the following BIC-type criterion over this two dimensional grid:
</p>
<p style="text-align: center;"><code class="reqn">(SL)\times\log\left(\frac{RSS}{SL}\right) +
  k_{\alpha,\lambda_0}\log(SL),</code>
</p>
<p> where <code class="reqn">S</code> is the number of samples,
<code class="reqn">L</code> is the number probes, <code class="reqn">RSS</code> denotes the residual sum of
squares and <code class="reqn">k_{\alpha, \lambda_0}</code> denotes the sum over all the
features of the number of unique non-zero elements in each estimated
feature.
</p>
<p>Note that for extremely large data sets, this function may take some
time to run.
</p>
<p>For more details, please see Nowak and others (2011) and the package
vignette.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>lam0</code></td>
<td>
<p>The optimal value of <code class="reqn">\lambda_0</code>.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The optimal value of <code class="reqn">\alpha</code>.</p>
</td></tr>
<tr><td><code>lam1</code></td>
<td>
<p>The optimal value of <code class="reqn">\lambda_1</code>.</p>
</td></tr>
<tr><td><code>lam2</code></td>
<td>
<p>The optimal value of <code class="reqn">\lambda_2</code>.</p>
</td></tr>
<tr><td><code>opt.FLLat</code></td>
<td>
<p>The fitted FLLat model for the optimal values of the
tuning parameters.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gen Nowak <a href="mailto:gen.nowak@gmail.com">gen.nowak@gmail.com</a>, Trevor Hastie, Jonathan
R. Pollack, Robert Tibshirani and Nicholas Johnson.</p>


<h3>References</h3>

<p>G. Nowak, T. Hastie, J. R. Pollack and R. Tibshirani.  A
Fused Lasso Latent Feature Model for Analyzing Multi-Sample aCGH
Data. <em>Biostatistics</em>, 2011, doi: 10.1093/biostatistics/kxr012</p>


<h3>See Also</h3>

<p><code><a href="#topic+FLLat">FLLat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load simulated aCGH data.
data(simaCGH)

## Run FLLat.BIC to choose optimal tuning parameters for J = 5 features.
result.bic &lt;- FLLat.BIC(simaCGH,J=5)

## Plot the features for the optimal FLLat model.
plot(result.bic$opt.FLLat)

## Plot a heatmap of the weights for the optimal FLLat model.
plot(result.bic$opt.FLLat,type="weights")
</code></pre>

<hr>
<h2 id='FLLat.FDR'>False Discovery Rate for the Fused Lasso Latent Feature Model</h2><span id='topic+FLLat.FDR'></span><span id='topic+plot.FDR'></span>

<h3>Description</h3>

<p>Estimates the false discovery rate (FDR) over a range of
threshold values for a fitted Fused Lasso Latent Feature (FLLat)
model.  Also plots the FDRs against the threshold values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>FLLat.FDR(Y, Y.FLLat, n.thresh=50, fdr.control=0.05, pi0=1, n.perms=20)

## S3 method for class 'FDR'
plot(x, xlab="Threshold", ylab="FDR", ...)
</code></pre>


<h3>Arguments</h3>

  
<table>
<tr><td><code id="FLLat.FDR_+3A_y">Y</code></td>
<td>
<p>A matrix of data from an aCGH experiment (usually in the form
of log intensity ratios) or some other type of copy number data.  Rows
correspond to the probes and columns correspond to the samples.</p>
</td></tr>
<tr><td><code id="FLLat.FDR_+3A_y.fllat">Y.FLLat</code></td>
<td>
<p>A FLLat model fitted to <code>Y</code>.  That is, an object
of class <code>FLLat</code>, as returned by <code><a href="#topic+FLLat">FLLat</a></code>.</p>
</td></tr>
<tr><td><code id="FLLat.FDR_+3A_n.thresh">n.thresh</code></td>
<td>
<p>The number of threshold values at which to estimate
the FDR.  The default is <code class="reqn">50</code>.</p>
</td></tr>
<tr><td><code id="FLLat.FDR_+3A_fdr.control">fdr.control</code></td>
<td>
<p>A value at which to control the FDR.  The function
will return the smallest threshold value which controls the FDR at the
specified value.  The default is <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="FLLat.FDR_+3A_pi0">pi0</code></td>
<td>
<p>The proportion of true null hypotheses.  For probe location
<code class="reqn">l</code> in sample <code class="reqn">s</code>, the null hypothesis <code class="reqn">H_0(l,s)</code> states
that there is no copy number variation at that location.  The default
is <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="FLLat.FDR_+3A_n.perms">n.perms</code></td>
<td>
<p>The number of permutations of the aCGH data used in
estimating the FDRs.  The default is <code class="reqn">20</code>.</p>
</td></tr>
<tr><td><code id="FLLat.FDR_+3A_x">x</code></td>
<td>
<p>An object of class <code>FDR</code>, as returned by
<code><a href="#topic+FLLat.FDR">FLLat.FDR</a></code>.</p>
</td></tr>
<tr><td><code id="FLLat.FDR_+3A_xlab">xlab</code></td>
<td>
<p>The title for the <code class="reqn">x</code>-axis of the FDR plot.</p>
</td></tr>
<tr><td><code id="FLLat.FDR_+3A_ylab">ylab</code></td>
<td>
<p>The title for the <code class="reqn">y</code>-axis of the FDR plot.</p>
</td></tr>
<tr><td><code id="FLLat.FDR_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Identifying regions of copy number variation (CNV) in aCGH data
can be viewed in a multiple-testing framework.  For each probe
location <code class="reqn">l</code> within sample <code class="reqn">s</code>, we are essentially testing the
hypothesis <code class="reqn">H_0(l,s)</code> that there is no CNV at that location.
The decision to reject each hypothesis can be based on the fitted
values <code class="reqn">\hat{Y}=\hat{B}\hat{\Theta}</code> produced by the FLLat model.
Specifically, for a given threshold value <code class="reqn">T</code>, we can declare
location <code class="reqn">(l,s)</code> as exhibiting CNV if <code class="reqn">|\hat{y}_{ls}|\ge
  T</code>.  The FDR is then defined to be the expected
proportion of declared CNVs which are not true CNVs.
</p>
<p>The FDR for a fitted FLLat model is estimated in the following
manner.  Firstly, <code>n.thresh</code> threshold values are chosen, equally
spaced between <code class="reqn">0</code> and the largest absolute fitted value over all
locations <code class="reqn">(l,s)</code>.  Then, for each threshold value, the estimated
FDR is equal to </p>
<p style="text-align: center;"><code class="reqn">FDR=\frac{\pi_0\times
      V_0}{R}</code>
</p>
<p> where:
</p>

<ul>
<li><p> The quantity <code class="reqn">R</code> is the number of declared CNVs calculated
from the fitted FLLat model, as described above.
</p>
</li>
<li><p> The quantity <code class="reqn">V_0</code> is the number of declared CNVs
calculated from re-fitting the FLLat model to permuted versions of the
data <code class="reqn">Y</code>.  In each permuted data set, the probe locations
within each sample are permuted to approximate the null distribution
of the data.
</p>
</li>
<li><p> The quantity <code class="reqn">\pi_0</code> is the proportion of true null
hypotheses.  The default value of <code class="reqn">1</code> will result in conservative
estimates of the FDR.  If warranted, smaller values of <code class="reqn">\pi_0</code>
can be specified.
</p>
</li></ul>

<p>For more details, please see Nowak and others (2011) and the package
vignette.
</p>


<h3>Value</h3>

<p>An object of class <code>FDR</code> with components:
</p>
<table>
<tr><td><code>thresh.vals</code></td>
<td>
<p>The threshold values for which each FDR was
estimated.</p>
</td></tr>
<tr><td><code>FDRs</code></td>
<td>
<p>The estimated FDR for each value of <code>thresh.vals</code>.</p>
</td></tr>
<tr><td><code>thresh.control</code></td>
<td>
<p>The smallest threshold value which controls the
estimated FDR at <code>fdr.control</code>.</p>
</td></tr>
</table>
<p>There is a <code><a href="base.html#topic+plot">plot</a></code> method for <code>FDR</code> objects.
</p>


<h3>Note</h3>

<p>Due to the randomness of the permutations, for reproducibility of
results please set the random seed using <code><a href="base.html#topic+set.seed">set.seed</a></code>
before running <code><a href="#topic+FLLat.FDR">FLLat.FDR</a></code>.</p>


<h3>Author(s)</h3>

<p>Gen Nowak <a href="mailto:gen.nowak@gmail.com">gen.nowak@gmail.com</a>, Trevor Hastie, Jonathan
R. Pollack, Robert Tibshirani and Nicholas Johnson.</p>


<h3>References</h3>

<p>G. Nowak, T. Hastie, J. R. Pollack and R. Tibshirani.  A
Fused Lasso Latent Feature Model for Analyzing Multi-Sample aCGH
Data. <em>Biostatistics</em>, 2011, doi: 10.1093/biostatistics/kxr012</p>


<h3>See Also</h3>

<p><code><a href="#topic+FLLat">FLLat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load simulated aCGH data.
data(simaCGH)

## Run FLLat for J = 5, lam1 = 1 and lam2 = 9.
result &lt;- FLLat(simaCGH,J=5,lam1=1,lam2=9)

## Estimate the FDRs.
result.fdr &lt;- FLLat.FDR(simaCGH,result)

## Plotting the FDRs against the threshold values.    
plot(result.fdr)

## The threshold value which controls the FDR at 0.05.
result.fdr$thresh.control
</code></pre>

<hr>
<h2 id='FLLat.PVE'>Choosing the Number of Features for the Fused Lasso Latent Feature
Model</h2><span id='topic+FLLat.PVE'></span><span id='topic+plot.PVE'></span>

<h3>Description</h3>

<p>Calculates the percentage of variation explained (PVE) for
a range of values of <code class="reqn">J</code> (the number of features) for the Fused
Lasso Latent Feature (FLLat) model.  Also plots the PVE against <code class="reqn">J</code>,
which can be used for choosing the value of <code class="reqn">J</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>FLLat.PVE(Y, J.seq=seq(1,min(15,floor(ncol(Y)/2)),by=2), B=c("pc","rand"),
          lams=c("same","diff"), thresh=10^(-4), maxiter=100, maxiter.B=1,
          maxiter.T=1)

## S3 method for class 'PVE'
plot(x, xlab="Number of Features", ylab="PVE", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FLLat.PVE_+3A_y">Y</code></td>
<td>
<p>A matrix of data from an aCGH experiment (usually in the form
of log intensity ratios) or some other type of copy number data.  Rows
correspond to the probes and columns correspond to the samples.</p>
</td></tr>
<tr><td><code id="FLLat.PVE_+3A_j.seq">J.seq</code></td>
<td>
<p>A vector of values of <code class="reqn">J</code> (the number of features) for
which to calculate the PVE.  The default values are every second
integer between <code class="reqn">1</code> and smaller of either <code class="reqn">15</code> or the number
of samples divided by <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="FLLat.PVE_+3A_b">B</code></td>
<td>
<p>The initial values for the features to use in the FLLat
algorithm for each value of <code class="reqn">J</code>.  Can be one of <code>"pc"</code> (the
first <code class="reqn">J</code> principal components of <code>Y</code>) or <code>"rand"</code> (a
random selection of <code class="reqn">J</code> columns of <code>Y</code>).  The default is
<code>"pc"</code>.</p>
</td></tr>
<tr><td><code id="FLLat.PVE_+3A_lams">lams</code></td>
<td>
<p>The choice of whether to use the same values of the tuning
parameters in the FLLat algorithm for each value of <code class="reqn">J</code>
(<code>"same"</code>) or to calculate the optimal tuning parameters for each
value of <code class="reqn">J</code> (<code>"diff"</code>).  When using the same values, the
optimal tuning parameters are calculated once for the default value of
<code class="reqn">J</code> in the FLLat algorithm.  The default is <code>"same"</code>.</p>
</td></tr>
<tr><td><code id="FLLat.PVE_+3A_thresh">thresh</code></td>
<td>
<p>The threshold for determining when the solutions have
converged in the FLLat algorithm.  The default is <code class="reqn">10^{-4}</code>.</p>
</td></tr>
<tr><td><code id="FLLat.PVE_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations for the outer loop of
the FLLat algorithm.  The default is <code class="reqn">100</code>.</p>
</td></tr>
<tr><td><code id="FLLat.PVE_+3A_maxiter.b">maxiter.B</code></td>
<td>
<p>The maximum number of iterations for the inner loop
of the FLLat algorithm for estimating the features <code class="reqn">B</code>.  The default is
<code class="reqn">1</code>.  Increasing this may decrease the number of iterations for the
outer loop but may still increase total run time.</p>
</td></tr>
<tr><td><code id="FLLat.PVE_+3A_maxiter.t">maxiter.T</code></td>
<td>
<p>The maximum number of iterations for the inner loop
of the FLLat algorithm for estimating the weights <code class="reqn">\Theta</code>.  The default
is <code class="reqn">1</code>.  Increasing this may decrease the number of iterations for the
outer loop but may still increase total run time.</p>
</td></tr>
<tr><td><code id="FLLat.PVE_+3A_x">x</code></td>
<td>
<p>An object of class <code>PVE</code>, as returned by
<code><a href="#topic+FLLat.PVE">FLLat.PVE</a></code>.</p>
</td></tr>
<tr><td><code id="FLLat.PVE_+3A_xlab">xlab</code></td>
<td>
<p>The title for the <code class="reqn">x</code>-axis of the PVE plot.</p>
</td></tr>
<tr><td><code id="FLLat.PVE_+3A_ylab">ylab</code></td>
<td>
<p>The title for the <code class="reqn">y</code>-axis of the PVE plot.</p>
</td></tr>
<tr><td><code id="FLLat.PVE_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the PVE for each value of <code class="reqn">J</code> as
specified by <code>J.seq</code>.  The PVE is defined to be: </p>
<p style="text-align: center;"><code class="reqn">PVE = 1 -
  \frac{RSS}{TSS}</code>
</p>
<p> where RSS and TSS denote the
residual sum of squares and the total sum of squares, respectively.
For each value of <code class="reqn">J</code>, the PVE is calculated by fitting the FLLat
model with that value of <code class="reqn">J</code>.
</p>
<p>There are two choices for how the tuning parameters are chosen when
fitting the FLLat model for each value of <code class="reqn">J</code>.  The first choice,
given by <code>lams="same"</code>, applies the <code><a href="#topic+FLLat.BIC">FLLat.BIC</a></code>
function just once for the default value of <code class="reqn">J</code>.  The resulting
optimal tuning parameters are then used for all values of <code class="reqn">J</code> in
<code>J.seq</code>.  The second choice, given by <code>lams="diff"</code>, applies
the <code><a href="#topic+FLLat.BIC">FLLat.BIC</a></code> function for each value of <code class="reqn">J</code> in
<code>J.seq</code>.  Although this second choice will give a more accurate
measure of the PVE, it will take much longer to run than the first
choice.
</p>
<p>When the PVE is plotted against <code class="reqn">J</code>, as <code class="reqn">J</code> increases the PVE
will begin to plateau after a certain point, indicating that
additional features are not improving the model.  Therefore, the value
of <code class="reqn">J</code> to use in the FLLat algorithm can be chosen as the point at
which the PVE plot begins to plateau.
</p>
<p>For more details, please see Nowak and others (2011) and the package
vignette.
</p>


<h3>Value</h3>

<p>An object of class <code>PVE</code> with components:
</p>
<table>
<tr><td><code>PVEs</code></td>
<td>
<p>The PVE for each value of <code class="reqn">J</code> in <code>J.seq</code>.</p>
</td></tr>
<tr><td><code>J.seq</code></td>
<td>
<p>The sequence of <code class="reqn">J</code> values used.</p>
</td></tr>
</table>
<p>There is a <code><a href="base.html#topic+plot">plot</a></code> method for <code>PVE</code> objects.
</p>


<h3>Author(s)</h3>

<p>Gen Nowak <a href="mailto:gen.nowak@gmail.com">gen.nowak@gmail.com</a>, Trevor Hastie, Jonathan
R. Pollack, Robert Tibshirani and Nicholas Johnson.</p>


<h3>References</h3>

<p>G. Nowak, T. Hastie, J. R. Pollack and R. Tibshirani.  A
Fused Lasso Latent Feature Model for Analyzing Multi-Sample aCGH
Data. <em>Biostatistics</em>, 2011, doi: 10.1093/biostatistics/kxr012</p>


<h3>See Also</h3>

<p><code><a href="#topic+FLLat">FLLat</a></code>, <code><a href="#topic+FLLat.BIC">FLLat.BIC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load simulated aCGH data.
data(simaCGH)

## Generate PVEs for J ranging from 1 to the number of samples divided by 2.
result.pve &lt;- FLLat.PVE(simaCGH,J.seq=1:(ncol(simaCGH)/2))

## Generate PVE plot.
plot(result.pve)
</code></pre>

<hr>
<h2 id='plot.FLLat'>Plots Results from the Fused Lasso Latent Feature Model</h2><span id='topic+plot.FLLat'></span>

<h3>Description</h3>

<p>Plots either the estimated features or a heatmap of the
estimated weights from a fitted Fused Lasso Latent Feature (FLLat)
model (i.e., an object of class <code>FLLat</code>).</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FLLat'
plot(x, type=c("features","weights"), f.mar=c(5,3,4,2), f.xlab="Probe",
     w.mar=c(3,5,0,2), samp.names=1:ncol(x$Theta), hc.meth="complete", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.FLLat_+3A_x">x</code></td>
<td>
<p>A fitted FLLat model.  That is, an object of class
<code>FLLat</code>, as returned by <code><a href="#topic+FLLat">FLLat</a></code>.</p>
</td></tr>
<tr><td><code id="plot.FLLat_+3A_type">type</code></td>
<td>
<p>The choice of whether to plot the estimated features
<code class="reqn">\hat{B}</code> or a heatmap of the estimated weights
<code class="reqn">\hat{\Theta}</code>.  Default is <code>"features"</code>.</p>
</td></tr>
<tr><td><code id="plot.FLLat_+3A_f.mar">f.mar</code></td>
<td>
<p>The margins for the plot of each estimated feature.</p>
</td></tr>
<tr><td><code id="plot.FLLat_+3A_f.xlab">f.xlab</code></td>
<td>
<p>The label for the <code class="reqn">x</code>-axis for the plot of each
estimated feature.</p>
</td></tr>
<tr><td><code id="plot.FLLat_+3A_w.mar">w.mar</code></td>
<td>
<p>The margins for the heatmap of the estimated weights.</p>
</td></tr>
<tr><td><code id="plot.FLLat_+3A_samp.names">samp.names</code></td>
<td>
<p>The sample names used to label the columns in the
heatmap of the estimated weights.</p>
</td></tr>
<tr><td><code id="plot.FLLat_+3A_hc.meth">hc.meth</code></td>
<td>
<p>The agglomeration method to be used in the hierarchical
clustering of the columns of <code class="reqn">\hat{\Theta}</code>.  See <code><a href="stats.html#topic+hclust">hclust</a></code>.</p>
</td></tr>
<tr><td><code id="plot.FLLat_+3A_...">...</code></td>
<td>
<p>Further graphical parameters, for the <code><a href="base.html#topic+plot">plot</a></code>
function when <code>type="features"</code> and for the <code><a href="graphics.html#topic+image">image</a></code>
function when <code>type="weights"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the estimated features <code class="reqn">\hat{B}</code> or a heatmap
of the estimated weights <code class="reqn">\hat{\Theta}</code> from a fitted FLLat model.
The features are plotted in order of decreasing total magnitude, where
the magnitude is given by
<code class="reqn">\sum_{l=1}^L\hat{\beta}_{lj}^2</code> with <code class="reqn">\hat{\beta}_{lj}</code> for <code class="reqn">l=1,\ldots,L</code> denoting the <code class="reqn">j</code>th estimated feature (column of <code class="reqn">\hat{B}</code>).
Similarly, the rows of the heatmap of the estimated weights are
re-ordered in the same way.  The heatmap also includes a dendrogram of
a hierarchical clustering of the samples based on their estimated
weights (columns of <code class="reqn">\hat{\Theta}</code>).
</p>
<p>For more details, please see Nowak and others (2011) and the package
vignette.
</p>


<h3>Author(s)</h3>

<p>Gen Nowak <a href="mailto:gen.nowak@gmail.com">gen.nowak@gmail.com</a>, Trevor Hastie, Jonathan
R. Pollack, Robert Tibshirani and Nicholas Johnson.</p>


<h3>References</h3>

<p>G. Nowak, T. Hastie, J. R. Pollack and R. Tibshirani.  A
Fused Lasso Latent Feature Model for Analyzing Multi-Sample aCGH
Data. <em>Biostatistics</em>, 2011, doi: 10.1093/biostatistics/kxr012</p>


<h3>See Also</h3>

<p><code><a href="#topic+FLLat">FLLat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load simulated aCGH data.
data(simaCGH)

## Run FLLat for J = 5, lam1 = 1 and lam2 = 9.
result &lt;- FLLat(simaCGH,J=5,lam1=1,lam2=9)

## Plot the estimated features.
plot(result)

## Plot a heatmap of the estimated weights.
plot(result,type="weights")
</code></pre>

<hr>
<h2 id='predict.FLLat'>Predicted Values and Weights based on the Fused Lasso Latent
Feature Model</h2><span id='topic+predict.FLLat'></span>

<h3>Description</h3>

<p>Calculates predicted values and weights for a new set of
samples using the estimated features from a fitted Fused Lasso Latent
Feature (FLLat) model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FLLat'
predict(object, newY=NULL, thresh=10^(-4), maxiter.T=100, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.FLLat_+3A_object">object</code></td>
<td>
<p>A fitted FLLat model.  That is, an object of class
<code>FLLat</code>, as returned by <code><a href="#topic+FLLat">FLLat</a></code>.</p>
</td></tr>
<tr><td><code id="predict.FLLat_+3A_newy">newY</code></td>
<td>
<p>A matrix of new data from an aCGH experiment (usually in
the form of log intensity ratios) or some other type of copy number
data.  Rows correspond to the probes and columns correspond to the
samples.  The number of probes must match the number of probes in the
data used to produce the fitted FLLat model.  Note that if
<code>newY</code> is not specified, the fitted values from the fitted FLLat
model are returned.</p>
</td></tr>
<tr><td><code id="predict.FLLat_+3A_thresh">thresh</code></td>
<td>
<p>The threshold for determining when the predicted weights
have converged.  The default is <code class="reqn">10^{-4}</code>.</p>
</td></tr>
<tr><td><code id="predict.FLLat_+3A_maxiter.t">maxiter.T</code></td>
<td>
<p>The maximum number of iterations for the algorithm
for calculating the predicted weights.  The default is <code class="reqn">100</code>.</p>
</td></tr>
<tr><td><code id="predict.FLLat_+3A_...">...</code></td>
<td>
<p>Arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the estimated features <code class="reqn">\hat{B}</code> from a fitted
FLLat model, this function predicts the new weights that need to be
applied to each feature for predicting a new set of samples
<code class="reqn">Y^*</code>.  The predicted weights
<code class="reqn">\hat{\Theta}^*</code> are calculated by minimizing the
residual sum of squares: 
</p>
<p style="text-align: center;"><code class="reqn">RSS = \left\|Y^* - \hat{B}\Theta^*\right\|_F^2</code>
</p>
<p>  where the <code class="reqn">L_2</code> norm of each row of
<code class="reqn">\hat{\Theta}^*</code> is still constrained to be less
than or equal to <code class="reqn">1</code>.  From these predicted weights, the predicted
values for the new set of samples are calculated as
<code class="reqn">\hat{Y}^*=\hat{B}\hat{\Theta}^*</code>.
These predicted values can useful when performing model validation.
</p>
<p>Note that for the predictions to be meaningful and useful, the new set
of samples <code class="reqn">Y^*</code> must be similar in scale/magnitude to the
original data used in producing the fitted FLLat model.  If a
new set of samples <code class="reqn">Y^*</code> are not specified, the function
returns the fitted values <code class="reqn">\hat{Y}</code> and estimated weights
<code class="reqn">\hat{\Theta}</code> from the fitted FLLat model.
</p>
<p>For more details, please see Nowak and others (2011) and the package
vignette.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>pred.Y</code></td>
<td>
<p>The predicted values <code class="reqn">\hat{Y}^*</code> for the
new set of samples, or the fitted values <code class="reqn">\hat{Y}</code> from the fitted
FLLat model.</p>
</td></tr>
<tr><td><code>Theta</code></td>
<td>
<p>The predicted weights <code class="reqn">\hat{\Theta}^*</code>
for the new set of samples, or the estimated weights <code class="reqn">\hat{\Theta}</code> from the
fitted FLLat model.</p>
</td></tr>
<tr><td><code>niter</code></td>
<td>
<p>The number of iterations taken by the algorithm for
calculating the predicted weights, or the number of iterations taken
by the algorithm for producing the fitted FLLat model.</p>
</td></tr>
<tr><td><code>rss</code></td>
<td>
<p>The residual sum of squares based on the new set of samples, or based
on the original data used in producing the fitted FLLat model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gen Nowak <a href="mailto:gen.nowak@gmail.com">gen.nowak@gmail.com</a>, Trevor Hastie, Jonathan
R. Pollack, Robert Tibshirani and Nicholas Johnson.</p>


<h3>References</h3>

<p>G. Nowak, T. Hastie, J. R. Pollack and R. Tibshirani.  A
Fused Lasso Latent Feature Model for Analyzing Multi-Sample aCGH
Data. <em>Biostatistics</em>, 2011, doi: 10.1093/biostatistics/kxr012</p>


<h3>See Also</h3>

<p><code><a href="#topic+FLLat">FLLat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load simulated aCGH data.
data(simaCGH)

## Divide the data into a training and test set.
tr.dat &lt;- simaCGH[,1:15]
tst.dat &lt;- simaCGH[,16:20]

## Run FLLat for J = 5, lam1 = 1 and lam2 = 9 on the training set.
result.tr &lt;- FLLat(tr.dat,J=5,lam1=1,lam2=9)

## Calculate fitted values on the training set.
tr.pred &lt;- predict(result.tr)

## Calculate predicted values and weights on the test set using the FLLat
## model (i.e., the features) fitted on the training set.
tst.pred &lt;- predict(result.tr,newY=tst.dat)

## Plotting predicted values and data for the first sample in the test set.
plot(tst.dat[,1],xlab="Probe",ylab="Y")
lines(tst.pred$pred.Y[,1],col="red",lwd=3)
</code></pre>

<hr>
<h2 id='simaCGH'>Simulated aCGH Data</h2><span id='topic+simaCGH'></span>

<h3>Description</h3>

<p>These <code class="reqn">20</code> samples of aCGH data are simulated using the Fused Lasso Latent
Feature model with <code class="reqn">5</code> features, as described in Section 4 of Nowak and
others (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simaCGH)</code></pre>


<h3>Format</h3>

<p>A matrix consisting of <code class="reqn">1000</code> probes (rows) and <code class="reqn">20</code> samples (columns).
</p>


<h3>References</h3>

<p>G. Nowak, T. Hastie, J. R. Pollack and R. Tibshirani.  A
Fused Lasso Latent Feature Model for Analyzing Multi-Sample aCGH
Data. <em>Biostatistics</em>, 2011, doi: 10.1093/biostatistics/kxr012</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simaCGH)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
