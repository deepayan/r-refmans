<!DOCTYPE html><html><head><title>Help for package PICBayes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PICBayes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PICBayes-package'><p>Bayesian Models for Partly Interval-Censored Data and General Interval-Censored Data</p></a></li>
<li><a href='#C'><p>Adjacency matrix of 46 South Carolina counties</p></a></li>
<li><a href='#clusterIC_int'><p>PH model with random intercept for clustered general interval-censored data</p></a></li>
<li><a href='#clusterIC_int_DP'><p>PH model with random intercept for clustered general interval-censored data</p></a></li>
<li><a href='#clusterIC_trt'><p>PH model with random intercept and random treatment for clustered general interval-censored data</p></a></li>
<li><a href='#clusterIC_trt_DP'><p>PH model with random intercept and random treatment for clustered general interval-censored data</p></a></li>
<li><a href='#clusterIC_Z'><p>Mixed effects PH model for clustered general interval-censored data</p></a></li>
<li><a href='#clusterIC_Z_DP'><p>Mixed effects PH model for clustered general interval-censored data</p></a></li>
<li><a href='#clusterPIC_int'><p>PH model with random intercept for clustered partly interval-censored data</p></a></li>
<li><a href='#clusterPIC_int_DP'><p>PH model with random intercept for clustered partly interval-censored data data</p></a></li>
<li><a href='#clusterPIC_trt'><p>PH model with random intercept and random treatment for clustered partly interval-censored data</p></a></li>
<li><a href='#clusterPIC_trt_DP'><p>PH model with random intercept and random treatment for clustered partly interval-censored data</p></a></li>
<li><a href='#clusterPIC_Z'><p>Mixed effects PH model for clustered partly interval-censored data</p></a></li>
<li><a href='#clusterPIC_Z_DP'><p>Mixed effects PH model for clustered partly interval-censored data</p></a></li>
<li><a href='#coef.PICBayes'><p>Coef method for a PICBayes model</p></a></li>
<li><a href='#da1'><p>Partly interva-censored data</p></a></li>
<li><a href='#da2'><p>Clustered partly interva-censored data</p></a></li>
<li><a href='#da3'><p>Clustered partly interva-censored data</p></a></li>
<li><a href='#da4'><p>Clustered partly interva-censored data</p></a></li>
<li><a href='#IC'><p>PH model for general interval-censored data</p></a></li>
<li><a href='#logLik.PICBayes'><p>LogLik method for a PICBayes model</p></a></li>
<li><a href='#mCRC'><p>Colorectal cancer data</p></a></li>
<li><a href='#PIC'><p>PH model for partly interval-censored data</p></a></li>
<li><a href='#PICBayes'><p>Bayesian models for partly interval-censored data and general interval-censored data</p></a></li>
<li><a href='#plot.PICBayes'><p>Plot method for a PICBayes model</p></a></li>
<li><a href='#spatialIC'><p>PH model for spatial general interval-censored data</p></a></li>
<li><a href='#spatialPIC'><p>PH model for spatial partly interval-censored data</p></a></li>
<li><a href='#summary.PICBayes'><p>Summary method for a PICBayes model</p></a></li>
<li><a href='#SurvtoLR'><p>Transform Surv object to data matrix with L and R columns</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian Models for Partly Interval-Censored Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-08-04</td>
</tr>
<tr>
<td>Author:</td>
<td>Chun Pan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chun Pan &lt;chunpan2003@hotmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains functions to fit proportional hazards (PH) model to partly interval-censored (PIC) data (Pan et al. (2020) &lt;<a href="https://doi.org/10.1177%2F0962280220921552">doi:10.1177/0962280220921552</a>&gt;), PH model with spatial frailty to spatially dependent PIC data (Pan and Cai (2021) &lt;<a href="https://doi.org/10.1080%2F03610918.2020.1839497">doi:10.1080/03610918.2020.1839497</a>&gt;), and mixed effects PH model to clustered PIC data. Each random intercept/random effect can follow both a normal prior and a Dirichlet process mixture prior. It also includes the corresponding functions for general interval-censored data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), coda, MCMCpack, survival</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-08-04 10:16:58 UTC; Chun</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-08-05 07:50:17 UTC</td>
</tr>
</table>
<hr>
<h2 id='PICBayes-package'>Bayesian Models for Partly Interval-Censored Data and General Interval-Censored Data</h2><span id='topic+PICBayes-package'></span>

<h3>Description</h3>

<p>Contains functions to fit proportional hazards (PH) model to partly interval-censored (PIC) data (Pan et al. (2020) &lt;doi:10.1177/0962280220921552&gt;), PH model with spatial frailty to spatially dependent PIC data (Pan and Cai (2021) &lt;doi:10.1080/03610918.2020.1839497&gt;), and mixed effects PH model to clustered PIC data. Each random intercept/random effect can follow both a normal prior and a Dirichlet process mixture prior. It also includes the corresponding functions for general interval-censored data.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PICBayes</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-08-04</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL&gt;=2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Chun Pan
</p>
<p>Maintainer: Chun Pan <a href="mailto:chunpan2003@hotmail.com">chunpan2003@hotmail.com</a>
</p>

<hr>
<h2 id='C'>Adjacency matrix of 46 South Carolina counties</h2><span id='topic+C'></span>

<h3>Description</h3>

<p>The adjacency matrix of the 46 South Carolina counties. 
C[i,j] = 1 if county i and county j share boundaries; 0 if not. C[i,i] = 0.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(C)</code></pre>

<hr>
<h2 id='clusterIC_int'>PH model with random intercept for clustered general interval-censored data</h2><span id='topic+clusterIC_int'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model with random intercept for 
clustered general interval-censored data. 
Random intercept follows a normal distribution <code>N(0, tau^{-1})</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterIC_int(L, R, y, xcov, IC, scale.designX, scaled, area, binary, I, 
order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_tau, b_tau, beta_iter, phi_iter, 
beta_cand, phi_cand, beta_sig0, x_user, total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterIC_int_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_a_tau">a_tau</code></td>
<td>
<p>The shape parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_b_tau">b_tau</code></td>
<td>
<p>The rate parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The baseline cumulative hazard is approximated by a linear combination of I-splines: 
</p>
<p><code>sum_{l=1}^{K}(gamma_l*b_l(t))</code>.
</p>
<p>For a binary prdictor, we sample <code>e^{beta_r}</code>, with Gamma prior.
</p>
<p>The regression coefficient <code>beta_r</code> for a continuous predictor and random intercept <code>phi_i</code> are sampled using MH algorithm. 
During the initial <code>beta_iter</code> iterations, sd of the proposal distribution is <code>beta_cand</code>. 
Afterwards, proposal sd is set to be the sd of available MCMC draws. 
Same method for <code>phi_i</code>. 
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>parphi</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>partau</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>tau</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>

<hr>
<h2 id='clusterIC_int_DP'>PH model with random intercept for clustered general interval-censored data</h2><span id='topic+clusterIC_int_DP'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model with random intercept for 
clustered general interval-censored data. 
Random intercept follows a Dirithlet process mixture distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterIC_int_DP(L, R, y, xcov, IC, scale.designX, scaled, area, binary, I, 
order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_alpha, b_alpha, H, a_tau_star, 
b_tau_star, beta_iter, phi_iter, beta_cand, phi_cand, beta_sig0, x_user, 
total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterIC_int_DP_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_a_alpha">a_alpha</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_b_alpha">b_alpha</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_h">H</code></td>
<td>
<p>The number of distinct components in DP mixture prior under blocked Gibbs sampler.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_a_tau_star">a_tau_star</code></td>
<td>
<p>The shape parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_b_tau_star">b_tau_star</code></td>
<td>
<p>The rate parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_int_DP_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DP mixture prior:
</p>
<p><code>phi_i~N(0,tau_{i}^{-1})</code>
</p>
<p><code>tau_{i}~G</code>
</p>
<p><code>G~DP(alpha,G_{0})</code>
</p>
<p><code>G_{0}=Gamma(a_tau_star,b_tau_star)</code>
</p>
<p><code>tau_{h}^{*}~G_{0}, h=1,...,H</code>
</p>
<p>The blocked Gibbs sampler proposed by Ishwaran and James (2001) is used to sample 
from the posteriors under the DP mixture prior.
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains 
the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains 
the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>paralpha</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>alpha</code>.</p>
</td></tr>
<tr><td><code>parphi</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>partau_star</code></td>
<td>
<p>A <code>total</code> by H matrix of MCMC draws of <code>tau_star</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>

<hr>
<h2 id='clusterIC_trt'>PH model with random intercept and random treatment for clustered general interval-censored data</h2><span id='topic+clusterIC_trt'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model with random intercept 
and random treatment for clustered general interval-censored data. 
Each random effect follows a normal distribution <code>N(0, tau^{-1})</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterIC_trt(L, R, y, xcov, IC, scale.designX, scaled, xtrt, area, binary, I, 
order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_tau, b_tau, a_tau_trt, 
b_tau_trt, beta_iter, phi_iter, beta_cand, phi_cand, beta_sig0, x_user, 
total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterIC_trt_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_xtrt">xtrt</code></td>
<td>
<p>The covariate that has a random effect.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_a_tau">a_tau</code></td>
<td>
<p>The shape parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_b_tau">b_tau</code></td>
<td>
<p>The rate parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_a_tau_trt">a_tau_trt</code></td>
<td>
<p>The shape parameter of Gamma prior for random treatment precision <code>tau_trt</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_b_tau_trt">b_tau_trt</code></td>
<td>
<p>The rate parameter of Gamma prior for random treatment precision <code>tau_trt</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The baseline cumulative hazard is approximated by a linear combination of I-splines:
</p>
<p><code>sum_{l=1}^{K}(gamma_l*b_l(t))</code>.
</p>
<p>For a binary prdictor, we sample <code>e^{beta_r}</code>, with Gamma prior.
</p>
<p>The regression coefficient <code>beta_r</code> for a continuous predictor, random intercept <code>phi_i</code>, 
and random treatment <code>phi_trt_i</code> are sampled using MH algorithm. 
During the initial <code>beta_iter</code> iterations, sd of the proposal distribution is <code>beta_cand</code>. 
Afterwards, proposal sd is set to be the sd of available MCMC draws. 
Same method for <code>phi_i</code> and <code>phi_trt_i</code>. 
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>parphi</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>parphi_trt</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_trt_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>partau</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>tau</code>.</p>
</td></tr>
<tr><td><code>partau_trt</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>tau_trt</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>

<hr>
<h2 id='clusterIC_trt_DP'>PH model with random intercept and random treatment for clustered general interval-censored data</h2><span id='topic+clusterIC_trt_DP'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model with random intercept 
and random treatment for clustered general interval-censored data. 
Each random effect follows a Dirichlet process mixture distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterIC_trt_DP(L, R, y, xcov, IC, scale.designX, scaled, xtrt, area, binary, 
I, order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_alpha, b_alpha, H, 
a_tau_star, b_tau_star, a_alpha_trt, b_alpha_trt, H_trt, a_tau_trt_star, 
b_tau_trt_star, beta_iter, phi_iter, beta_cand, phi_cand, beta_sig0, x_user, 
total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterIC_trt_DP_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_xtrt">xtrt</code></td>
<td>
<p>The covariate that has a random effect.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_a_alpha">a_alpha</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_b_alpha">b_alpha</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_h">H</code></td>
<td>
<p>The number of distinct components in DP mixture prior under blocked Gibbs sampler.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_a_tau_star">a_tau_star</code></td>
<td>
<p>The shape parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_b_tau_star">b_tau_star</code></td>
<td>
<p>The rate parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_a_alpha_trt">a_alpha_trt</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>alpha_trt</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_b_alpha_trt">b_alpha_trt</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>alpha_trt</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_h_trt">H_trt</code></td>
<td>
<p>The number of distinct components in DP mixture prior under blocked Gibbs sampler for random treatment.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_a_tau_trt_star">a_tau_trt_star</code></td>
<td>
<p>The shape parameter of <code>G_0</code> in DP mixture prior for random treatment.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_b_tau_trt_star">b_tau_trt_star</code></td>
<td>
<p>The rate parameter of <code>G_0</code> in DP mixture prior for random treatment.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_trt_DP_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both random intercept and random treatment follow its own DP mixture prior. DP mixture prior:
</p>
<p><code>phi_i~N(0,tau_{i}^{-1})</code>
</p>
<p><code>tau_{i}~G</code>
</p>
<p><code>G~DP(alpha,G_{0})</code>
</p>
<p><code>G_{0}=Gamma(a_tau_star,b_tau_star)</code>
</p>
<p><code>tau_{h}^{*}~G_{0}, h=1,...,H</code>
</p>
<p>The blocked Gibbs sampler proposed by Ishwaran and James (2001) is used to sample 
from the posteriors under the DP mixture prior.
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains 
the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains 
the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>paralpha</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>alpha</code>.</p>
</td></tr>
<tr><td><code>paralpha_trt</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>alpha_trt</code>.</p>
</td></tr>
<tr><td><code>parphi</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>parphi_trt</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_trt_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>partau_star</code></td>
<td>
<p>A <code>total</code> by H matrix of MCMC draws of <code>tau_star</code>.</p>
</td></tr>
<tr><td><code>partau_trt_star</code></td>
<td>
<p>A <code>total</code> by H_trt matrix of MCMC draws of <code>tau_trt_star</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>

<hr>
<h2 id='clusterIC_Z'>Mixed effects PH model for clustered general interval-censored data</h2><span id='topic+clusterIC_Z'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric mixed effects PH model for clustered 
general interval-censored data. Each random effect follows a normal distribution <code>N(0, tau^{-1})</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterIC_Z(L, R, y, xcov, IC, scale.designX, scaled, zcov, area, binary, I, 
order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_tau, b_tau, beta_iter, phi_iter, 
beta_cand, phi_cand, beta_sig0, x_user, total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterIC_Z_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored; 0=exact.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_zcov">zcov</code></td>
<td>
<p>The design matrix for the q random effects.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_a_tau">a_tau</code></td>
<td>
<p>The shape parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_b_tau">b_tau</code></td>
<td>
<p>The rate parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mixed effects PH model is:
</p>
<p><code>h(t_{ij}|x_{ij},z_{ij})=h_{0}(t_{ij})exp(beta'x_{ij}+phi_{i}'z_{ij})</code>,
</p>
<p>for the jth subject in the ith cluster.
</p>
<p>Each of the q random effects is sampled using MH algorithm separately.
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>

<hr>
<h2 id='clusterIC_Z_DP'>Mixed effects PH model for clustered general interval-censored data</h2><span id='topic+clusterIC_Z_DP'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric mixed effects PH model for clustered 
general interval-censored data. Each random effect follows a DP mixture distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterIC_Z_DP(L, R, y, xcov, IC, scale.designX, scaled, zcov, area, binary, I, 
order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_alpha, b_alpha, H, 
a_tau_star, b_tau_star, beta_iter, phi_iter, beta_cand, phi_cand, 
beta_sig0, x_user, total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterIC_Z_DP_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_zcov">zcov</code></td>
<td>
<p>The design matrix for the q random effects.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_a_alpha">a_alpha</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_b_alpha">b_alpha</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_h">H</code></td>
<td>
<p>The number of distinct components in DP mixture prior under blocked Gibbs sampler.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_a_tau_star">a_tau_star</code></td>
<td>
<p>The shape parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_b_tau_star">b_tau_star</code></td>
<td>
<p>The rate parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterIC_Z_DP_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mixed effects PH model is:
</p>
<p><code>h(t_{ij}|x_{ij},z_{ij})=h_{0}(t_{ij})exp(beta'x_{ij}+phi_{i}'z_{ij})</code>,
</p>
<p>for the jth subject in the ith cluster.
</p>
<p>Each of the q random effects is sampled using MH algorithm separately.
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>paralpha</code></td>
<td>
<p>A <code>total</code> by <code>q</code> vector of MCMC draws of <code>alpha</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>

<hr>
<h2 id='clusterPIC_int'>PH model with random intercept for clustered partly interval-censored data</h2><span id='topic+clusterPIC_int'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model with random intercept for 
clustered partly interval-censored data. 
Random intercept follows a normal distribution <code>N(0, tau^{-1})</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterPIC_int(L, R, y, xcov, IC, scale.designX, scaled, area, binary, I, 
order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_tau, b_tau, beta_iter, 
phi_iter, beta_cand, phi_cand, beta_sig0, x_user, 
total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterPIC_int_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_a_tau">a_tau</code></td>
<td>
<p>The shape parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_b_tau">b_tau</code></td>
<td>
<p>The rate parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The baseline cumulative hazard is approximated by a linear combination of I-splines: 
</p>
<p><code>sum_{l=1}^{K}(gamma_l*b_l(t))</code>.
</p>
<p>The baseline hazard is approximated by a linear combination of basis M-splines:
</p>
<p><code>sum_{l=1}^{K}(gamma_l*M_l(t))</code>.
</p>
<p>For a binary prdictor, we sample <code>e^{beta_r}</code>, with Gamma prior.
</p>
<p>The regression coefficient <code>beta_r</code> for a continuous predictor and random intercept <code>phi_i</code> are sampled using MH algorithm. 
During the initial <code>beta_iter</code> iterations, sd of the proposal distribution is <code>beta_cand</code>. 
Afterwards, proposal sd is set to be the sd of available MCMC draws. 
Same method for <code>phi_i</code>. 
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>parphi</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>partau</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>tau</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>


<h3>Examples</h3>

<pre><code class='language-R'># Number of iterations set to very small for CRAN automatic testing
data(da3)
try3&lt;-PICBayes(formula=Surv(L,R,type='interval2')~x1+x2,data=data.frame(da3),
model='clusterPIC_int',area=da3[,6],IC=da3[,7],scale.designX=TRUE,scale=c(1,0),
binary=c(0,1),I=25,C=C,nn=nn,order=3,knots=c(0,2,6,max(da3[,1:2],na.rm=TRUE)+1),
grids=seq(0.1,10.1,by=0.1),a_eta=1,b_eta=1,a_ga=1,b_ga=1,a_tau=1,b_tau=1,
beta_iter=11,phi_iter=11,beta_cand=rep(1,2),phi_cand=1,beta_sig0=10,
x_user=NULL,total=60,burnin=10,thin=1,conf.int=0.95,seed=1)

</code></pre>

<hr>
<h2 id='clusterPIC_int_DP'>PH model with random intercept for clustered partly interval-censored data data</h2><span id='topic+clusterPIC_int_DP'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model with random intercept for 
clustered partly interval-censored data. Random intercept follows a Dirithlet process 
mixture distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterPIC_int_DP(L, R, y, xcov, IC, scale.designX, scaled, area, binary, I, 
order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_alpha, b_alpha, H, a_tau_star, 
b_tau_star, beta_iter, phi_iter, beta_cand, phi_cand, beta_sig0, x_user, 
total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterPIC_int_DP_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_a_alpha">a_alpha</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_b_alpha">b_alpha</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_h">H</code></td>
<td>
<p>The number of distinct components in DP mixture prior under blocked Gibbs sampler.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_a_tau_star">a_tau_star</code></td>
<td>
<p>The shape parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_b_tau_star">b_tau_star</code></td>
<td>
<p>The rate parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_int_DP_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DP mixture prior:
</p>
<p><code>phi_i~N(0,tau_{i}^{-1})</code>
</p>
<p><code>tau_{i}~G</code>
</p>
<p><code>G~DP(alpha,G_{0})</code>
</p>
<p><code>G_{0}=Gamma(a_tau_star,b_tau_star)</code>
</p>
<p><code>tau_{h}^{*}~G_{0}, h=1,...,H</code>
</p>
<p>The blocked Gibbs sampler proposed by Ishwaran and James (2001) is used to sample 
from the posteriors under the DP mixture prior.
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains 
the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains 
the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>paralpha</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>alpha</code>.</p>
</td></tr>
<tr><td><code>parphi</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>partau_star</code></td>
<td>
<p>A <code>total</code> by H matrix of MCMC draws of <code>tau_star</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>


<h3>Examples</h3>

<pre><code class='language-R'># Number of iterations set to very small for CRAN automatic testing
data(da3)
try4&lt;-PICBayes(formula=Surv(L,R,type='interval2')~x1+x2,data=data.frame(da3),
model='clusterPIC_int_DP',area=da3[,6],IC=da3[,7],scale.designX=TRUE,
scale=c(1,0),binary=c(0,1),I=25,C=C,order=3,
knots=c(0,2,6,max(da3[,1:2],na.rm=TRUE)+1),grids=seq(0.1,10.1,by=0.1),
a_eta=1,b_eta=1,a_ga=1,b_ga=1,a_alpha=1,b_alpha=1,H=5,a_tau_star=1,
b_tau_star=1,beta_iter=11,phi_iter=11,beta_cand=rep(1,2),phi_cand=1,
beta_sig0=10,x_user=NULL,total=60,burnin=10,thin=1,conf.int=0.95,seed=1)
</code></pre>

<hr>
<h2 id='clusterPIC_trt'>PH model with random intercept and random treatment for clustered partly interval-censored data</h2><span id='topic+clusterPIC_trt'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model with random intercept 
and random treatment for clustered partly interval-censored data. 
Each random effect follows a normal distribution <code>N(0, tau^{-1})</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterPIC_trt(L, R, y, xcov, IC, scale.designX, scaled, xtrt, area, binary, I, 
order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_tau, b_tau, a_tau_trt, 
b_tau_trt, beta_iter, phi_iter, beta_cand, phi_cand, beta_sig0, x_user, 
total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterPIC_trt_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_xtrt">xtrt</code></td>
<td>
<p>The covariate that has a random effect.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_a_tau">a_tau</code></td>
<td>
<p>The shape parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_b_tau">b_tau</code></td>
<td>
<p>The rate parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_a_tau_trt">a_tau_trt</code></td>
<td>
<p>The shape parameter of Gamma prior for random treatment precision <code>tau_trt</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_b_tau_trt">b_tau_trt</code></td>
<td>
<p>The rate parameter of Gamma prior for random treatment precision <code>tau_trt</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The baseline cumulative hazard is approximated by a linear combination of I-splines:
</p>
<p><code>sum_{l=1}^{K}(gamma_l*b_l(t))</code>.
</p>
<p>The baseline hazard is approximated by a linear combination of basis M-splines:
</p>
<p><code>sum_{l=1}^{K}(gamma_l*M_l(t))</code>.
</p>
<p>For a binary prdictor, we sample <code>e^{beta_r}</code>, with Gamma prior.
</p>
<p>The regression coefficient <code>beta_r</code> for a continuous predictor, random intercept <code>phi_i</code>, 
and random treatment <code>phi_trt_i</code> are sampled using MH algorithm. 
During the initial <code>beta_iter</code> iterations, sd of the proposal distribution is <code>beta_cand</code>. 
Afterwards, proposal sd is set to be the sd of available MCMC draws. 
Same method for <code>phi_i</code> and <code>phi_trt_i</code>. 
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>parphi</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>parphi_trt</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_trt_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>partau</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>tau</code>.</p>
</td></tr>
<tr><td><code>partau_trt</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>tau_trt</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>


<h3>Examples</h3>

<pre><code class='language-R'># Number of iterations set to very small for CRAN automatic testing
data(da4)
try5&lt;-PICBayes(formula=Surv(L,R,type='interval2')~x1+x2,data=data.frame(da4),
model='clusterPIC_trt',xtrt=da4[,5],area=da4[,6],IC=da4[,7],
scale.designX=TRUE,scaled=c(1,0),binary=c(0,1),I=25,order=3,
knots=c(0,2,6,max(da4[,1:2],na.rm=TRUE)+1),grids=seq(0.1,10.1,by=0.1),
a_eta=1,b_eta=1,a_ga=1,b_ga=1,a_tau=1,b_tau=1,a_tau_trt=1,b_tau_trt=1,
beta_iter=11,phi_iter=11,beta_cand=c(1,1),phi_cand=1,
beta_sig0=10,x_user=NULL,total=60,burnin=10,thin=1,conf.int=0.95,seed=1)
</code></pre>

<hr>
<h2 id='clusterPIC_trt_DP'>PH model with random intercept and random treatment for clustered partly interval-censored data</h2><span id='topic+clusterPIC_trt_DP'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model with random intercept 
and random treatment for clustered partly interval-censored data. 
Each random effect follows a Dirichlet process mixture distribution <code>N(0, tau^{-1})</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterPIC_trt_DP(L, R, y, xcov, IC, scale.designX, scaled, xtrt, area, binary, 
I, order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_alpha, b_alpha, H, 
a_tau_star, b_tau_star, a_alpha_trt, b_alpha_trt, H_trt, a_tau_trt_star, 
b_tau_trt_star, beta_iter, phi_iter, beta_cand, phi_cand, beta_sig0, x_user, 
total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterPIC_trt_DP_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_xtrt">xtrt</code></td>
<td>
<p>The covariate that has a random effect.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_a_alpha">a_alpha</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_b_alpha">b_alpha</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_h">H</code></td>
<td>
<p>The number of distinct components in DP mixture prior under blocked Gibbs sampler.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_a_tau_star">a_tau_star</code></td>
<td>
<p>The shape parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_b_tau_star">b_tau_star</code></td>
<td>
<p>The rate parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_a_alpha_trt">a_alpha_trt</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>alpha_trt</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_b_alpha_trt">b_alpha_trt</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>alpha_trt</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_h_trt">H_trt</code></td>
<td>
<p>The number of distinct components in DP mixture prior under blocked Gibbs sampler for random treatment.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_a_tau_trt_star">a_tau_trt_star</code></td>
<td>
<p>The shape parameter of <code>G_0</code> in DP mixture prior for random treatment.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_b_tau_trt_star">b_tau_trt_star</code></td>
<td>
<p>The rate parameter of <code>G_0</code> in DP mixture prior for random treatment.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_trt_DP_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both random intercept and random treatment follow its own DP mixture prior. DP mixture prior:
</p>
<p><code>phi_i~N(0,tau_{i}^{-1})</code>
</p>
<p><code>tau_{i}~G</code>
</p>
<p><code>G~DP(alpha,G_{0})</code>
</p>
<p><code>G_{0}=Gamma(a_tau_star,b_tau_star)</code>
</p>
<p><code>tau_{h}^{*}~G_{0}, h=1,...,H</code>
</p>
<p>The blocked Gibbs sampler proposed by Ishwaran and James (2001) is used to sample 
from the posteriors under the DP mixture prior.
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains 
the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains 
the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>paralpha</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>alpha</code>.</p>
</td></tr>
<tr><td><code>paralpha_trt</code></td>
<td>
<p>A <code>total</code> by 1 vector of MCMC draws of <code>alpha_trt</code>.</p>
</td></tr>
<tr><td><code>parphi</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>parphi_trt</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_trt_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>partau_star</code></td>
<td>
<p>A <code>total</code> by H matrix of MCMC draws of <code>tau_star</code>.</p>
</td></tr>
<tr><td><code>partau_trt_star</code></td>
<td>
<p>A <code>total</code> by H_trt matrix of MCMC draws of <code>tau_trt_star</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>


<h3>Examples</h3>

<pre><code class='language-R'># Number of iterations set to very small for CRAN automatic testing
data(da4)
try2&lt;-PICBayes(formula=Surv(L,R,type='interval2')~x1+x2,data=data.frame(da4),
model='clusterPIC_trt_DP', scale.designX=TRUE,scaled=c(1,0),IC=da4[,7],xtrt=da4[,5],
area=da4[,6],binary=c(0,1),I=25,order=3,knots=c(0,2,6,max(da4[,1:2],na.rm=TRUE)+1),
grids=seq(0.1,10.1,by=0.1),a_eta=1,b_eta=1,a_ga=1,b_ga=1,
a_alpha=1,b_alpha=1,H=5,a_alpha_trt=1,b_alpha_trt=1,H_trt=5,
a_tau_star=1,b_tau_star=1,a_tau_trt_star=1,b_tau_trt_star=1,
beta_iter=11,phi_iter=11,beta_cand=rep(1,2),phi_cand=1,beta_sig0=10,
x_user=NULL,total=60,burnin=10,thin=1,conf.int=0.95,seed=1)
</code></pre>

<hr>
<h2 id='clusterPIC_Z'>Mixed effects PH model for clustered partly interval-censored data</h2><span id='topic+clusterPIC_Z'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric mixed effects PH model for clustered partly 
interval-censored data with random effects for one or more predictors. 
Each random effect follows a normal distribution <code>N(0, tau^{-1})</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterPIC_Z(L, R, y, xcov, IC, scale.designX, scaled, zcov, area, binary, I, 
order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_tau, b_tau, beta_iter, 
phi_iter, beta_cand, phi_cand, beta_sig0, x_user, 
total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterPIC_Z_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_zcov">zcov</code></td>
<td>
<p>The design matrix for the q random effects.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_a_tau">a_tau</code></td>
<td>
<p>The shape parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_b_tau">b_tau</code></td>
<td>
<p>The rate parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mixed effects PH model is:
</p>
<p><code>h(t_{ij}|x_{ij},z_{i})=h_{0}(t_{ij})exp(beta'x_{ij}+phi_{i}'z_{i})</code>,
</p>
<p>for the jth subject in the ith cluster.
</p>
<p>Each of the q random effects is sampled using MH algorithm separately.
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival functions is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>


<h3>Examples</h3>

<pre><code class='language-R'># Number of iterations set to very small for CRAN automatic testing
data(da4)
J=rep(1,nrow(da4))
zcov=cbind(J,da4[,4]) # The 4th column of da4 is x1.
try7&lt;-PICBayes(formula=Surv(L,R,type='interval2')~x1+x2,data=data.frame(da4),
model='clusterPIC_Z',IC=da4[,7],scale.designX=TRUE,scaled=c(1,0),zcov=zcov,
area=da4[,6],binary=c(0,1),I=25,order=3,knots=c(0,2,6,max(da4[,1:2],na.rm=TRUE)+1),
grids=seq(0.1,10.1,by=0.1),a_eta=1,b_eta=1,a_ga=1,b_ga=1,a_tau=1,b_tau=1,
beta_iter=11,phi_iter=11,beta_cand=c(1,1),phi_cand=1,beta_sig0=10,
x_user=NULL,total=30,burnin=10,thin=1,conf.int=0.95,seed=1)
</code></pre>

<hr>
<h2 id='clusterPIC_Z_DP'>Mixed effects PH model for clustered partly interval-censored data</h2><span id='topic+clusterPIC_Z_DP'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric mixed effects PH model for clustered partly 
interval-censored data with random effects for one or more predictors. 
Each random effect follows a DP mixture distribution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterPIC_Z_DP(L, R, y, xcov, IC, scale.designX, scaled, zcov, area, binary, I, order, 
knots, grids, a_eta, b_eta, a_ga, b_ga, a_alpha, b_alpha, H, 
a_tau_star, b_tau_star, beta_iter, phi_iter, beta_cand, phi_cand, 
beta_sig0, x_user, total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clusterPIC_Z_DP_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_zcov">zcov</code></td>
<td>
<p>The design matrix for the q random effects.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_i">I</code></td>
<td>
<p>The number of clusters.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_a_alpha">a_alpha</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_b_alpha">b_alpha</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_h">H</code></td>
<td>
<p>The number of distinct components in DP mixture prior under blocked Gibbs sampler.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_a_tau_star">a_tau_star</code></td>
<td>
<p>The shape parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_b_tau_star">b_tau_star</code></td>
<td>
<p>The rate parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="clusterPIC_Z_DP_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mixed effects PH model is:
</p>
<p><code>h(t_{ij}|x_{ij},z_{i})=h_{0}(t_{ij})exp(beta'x_{ij}+phi_{i}'z_{i})</code>,
</p>
<p>for the jth subject in the ith cluster.
</p>
<p>Each of the q random effects is sampled using MH algorithm separately.
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>paralpha</code></td>
<td>
<p>A <code>total</code> by <code>q</code> vector of MCMC draws of <code>alpha</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival function is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>


<h3>Examples</h3>

<pre><code class='language-R'># Number of iterations set to very small for CRAN automatic testing
data(da4)
J=rep(1,nrow(da4))
zcov=cbind(J,da4[,4])
try8&lt;-PICBayes(formula=Surv(L,R,type='interval2')~x1+x2,data=data.frame(da4),
model='clusterPIC_Z_DP',IC=da4[,7],scale.designX=TRUE,scaled=c(1,0),zcov=zcov,
area=da4[,6],binary=c(0,1),I=25,order=3,knots=c(0,2,6,max(da4[,1:2],na.rm=TRUE)+1),
grids=seq(0.1,10.1,by=0.1),a_eta=1,b_eta=1,a_ga=1,b_ga=1,a_alpha=1,b_alpha=1,H=5,
a_tau_star=1,b_tau_star=1,beta_iter=11,phi_iter=11,beta_cand=1,phi_cand=1,
beta_sig0=10,x_user=NULL,total=20,burnin=10,thin=1,conf.int=0.95,seed=1)
</code></pre>

<hr>
<h2 id='coef.PICBayes'>Coef method for a PICBayes model</h2><span id='topic+coef.PICBayes'></span>

<h3>Description</h3>

<p>Extracts estimated regression coefficients.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PICBayes'
coef(object, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.PICBayes_+3A_object">object</code></td>
<td>
<p>The class PICBayes object.</p>
</td></tr>
<tr><td><code id="coef.PICBayes_+3A_...">...</code></td>
<td>
<p>Other arguments if any.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>coef</code>.</p>

<hr>
<h2 id='da1'>Partly interva-censored data</h2><span id='topic+da1'></span>

<h3>Description</h3>

<p>A simulated partly interval-censored data set based on:
</p>
<p><code>lambda(t|x)=lambda_{0}(t)exp(x1+x2)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(da1)</code></pre>


<h3>Format</h3>


<table>
<tr>
 <td style="text-align: left;">
    L:</td><td style="text-align: left;"> Left endpoints of observed time intervals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    R: </td><td style="text-align: left;"> Right endpoints of observed time intervals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    y: </td><td style="text-align: left;"> Censoring indicator: 0=left-censored, 1=interval-censored, 
	2=right-censored, 3=exact. </td>
</tr>
<tr>
 <td style="text-align: left;">
    X1:</td><td style="text-align: left;"> Covariate 1. </td>
</tr>
<tr>
 <td style="text-align: left;">
    X2:</td><td style="text-align: left;"> Covariate 2. </td>
</tr>
<tr>
 <td style="text-align: left;">
    IC:</td><td style="text-align: left;"> General interval-censored indicator: 
	1=general interval-censored, 0=exact. </td>
</tr>
<tr>
 <td style="text-align: left;">
    ID:</td><td style="text-align: left;"> Subject ID. </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>


<hr>
<h2 id='da2'>Clustered partly interva-censored data</h2><span id='topic+da2'></span>

<h3>Description</h3>

<p>A simulated clsutered partly interval-censored data set based on 
PH model with spatial frailty:
</p>
<p><code>lambda(t|x)=lambda_{0}(t)exp(x1+x2+phi)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(da2)</code></pre>


<h3>Format</h3>


<table>
<tr>
 <td style="text-align: left;">
    L:</td><td style="text-align: left;"> Left endpoints of observed time intervals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    R: </td><td style="text-align: left;"> Right endpoints of observed time intervals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    y: </td><td style="text-align: left;"> Censoring indicator: 0=left-censored, 1=interval-censored, 
	2=right-censored, 3=exact. </td>
</tr>
<tr>
 <td style="text-align: left;">
    X1:</td><td style="text-align: left;"> Covariate 1. </td>
</tr>
<tr>
 <td style="text-align: left;">
    X2:</td><td style="text-align: left;"> Covariate 2. </td>
</tr>
<tr>
 <td style="text-align: left;">
    area:</td><td style="text-align: left;"> Cluster ID. </td>
</tr>
<tr>
 <td style="text-align: left;">
    IC:</td><td style="text-align: left;"> General interval-censored indicator: 
	1=general interval-censored, 0=exact. </td>
</tr>
<tr>
 <td style="text-align: left;">
    ID:</td><td style="text-align: left;"> Subject ID. </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>


<hr>
<h2 id='da3'>Clustered partly interva-censored data</h2><span id='topic+da3'></span>

<h3>Description</h3>

<p>A simulated clsutered partly interval-censored data set based on 
PH model with random intercept:
</p>
<p><code>lambda(t|x)=lambda_{0}(t)exp(x1+x2+phi)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(da3)</code></pre>


<h3>Format</h3>


<table>
<tr>
 <td style="text-align: left;">
    L:</td><td style="text-align: left;"> Left endpoints of observed time intervals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    R: </td><td style="text-align: left;"> Right endpoints of observed time intervals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    y: </td><td style="text-align: left;"> Censoring indicator: 0=left-censored, 1=interval-censored, 
	2=right-censored, 3=exact. </td>
</tr>
<tr>
 <td style="text-align: left;">
    X1:</td><td style="text-align: left;"> Covariate 1. </td>
</tr>
<tr>
 <td style="text-align: left;">
    X2:</td><td style="text-align: left;"> Covariate 2. </td>
</tr>
<tr>
 <td style="text-align: left;">
    area:</td><td style="text-align: left;"> Cluster ID. </td>
</tr>
<tr>
 <td style="text-align: left;">
    IC:</td><td style="text-align: left;"> General interval-censored indicator: 
	1=general interval-censored, 0=exact. </td>
</tr>
<tr>
 <td style="text-align: left;">
    ID:</td><td style="text-align: left;"> Subject ID. </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>


<hr>
<h2 id='da4'>Clustered partly interva-censored data</h2><span id='topic+da4'></span>

<h3>Description</h3>

<p>A simulated clsutered partly interval-censored data set based on 
PH model with random intercept and random effect for x2:
</p>
<p><code>lambda(t|x)=lambda_{0}(t)exp(x1+x2+phi+phi_trt*x2)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(da4)</code></pre>


<h3>Format</h3>


<table>
<tr>
 <td style="text-align: left;">
    L:</td><td style="text-align: left;"> Left endpoints of observed time intervals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    R: </td><td style="text-align: left;"> Right endpoints of observed time intervals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    y: </td><td style="text-align: left;"> Censoring indicator: 0=left-censored, 1=interval-censored, 
	2=right-censored, 3=exact. </td>
</tr>
<tr>
 <td style="text-align: left;">
    X1:</td><td style="text-align: left;"> Covariate 1. </td>
</tr>
<tr>
 <td style="text-align: left;">
    X2:</td><td style="text-align: left;"> Covariate 2. </td>
</tr>
<tr>
 <td style="text-align: left;">
    area:</td><td style="text-align: left;"> Cluster ID. </td>
</tr>
<tr>
 <td style="text-align: left;">
    IC:</td><td style="text-align: left;"> General interval-censored indicator: 
	1=general interval-censored, 0=exact. </td>
</tr>
<tr>
 <td style="text-align: left;">
    ID:</td><td style="text-align: left;"> Subject ID. </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>


<hr>
<h2 id='IC'>PH model for general interval-censored data</h2><span id='topic+IC'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model to general interval-censored data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>IC(L, R, y, xcov, IC, scale.designX, scaled, binary, order, knots, grids, 
a_eta, b_eta, a_ga, b_ga, beta_iter, beta_cand, beta_sig0, x_user, 
total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IC_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="IC_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="IC_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td></tr>
<tr><td><code id="IC_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="IC_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="IC_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="IC_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="IC_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="IC_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="IC_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="IC_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="IC_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="IC_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="IC_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="IC_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="IC_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="IC_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="IC_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="IC_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="IC_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="IC_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="IC_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="IC_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="IC_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The baseline cumulative hazard is approximated by a linear combination of I-splines: 
</p>
<p><code>sum_{l=1}^{K}(gamma_l*b_l(t))</code>.
</p>
<p>For a binary prdictor, we sample <code>e^{beta_r}</code>, with Gamma prior.
</p>
<p>The regression coefficient <code>beta_r</code> for a continuous predictor is sampled 
using MH algorithm. During the initial <code>beta_iter</code> iterations, sd of the 
proposal distribution is <code>beta_cand</code>. Afterwards, proposal sd is set to be 
the sd of available MCMC draws. 
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p. </p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival functions is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>


<h3>References</h3>

<p>Pan, C., Cai, B., and Wang, L. (2020). A Bayesian approach for analyzing partly 
interval-censored data under the proportional hazards model.  
<em>Statistical Methods in Medical Research</em>, 
</p>
<p>DOI: 10.1177/0962280220921552.
</p>

<hr>
<h2 id='logLik.PICBayes'>LogLik method for a PICBayes model</h2><span id='topic+logLik.PICBayes'></span>

<h3>Description</h3>

<p>The log-likelihood of the observed partly 
interval-censored data estimated by log pseudo-marginal likelihood.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PICBayes'
logLik(object, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.PICBayes_+3A_object">object</code></td>
<td>
<p>Class PICBayes object.</p>
</td></tr>
<tr><td><code id="logLik.PICBayes_+3A_...">...</code></td>
<td>
<p>Other arguments if any.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>logLik</code>.</p>

<hr>
<h2 id='mCRC'>Colorectal cancer data</h2><span id='topic+mCRC'></span>

<h3>Description</h3>

<p>A progression-free survival data set derived by the author from 
a phase 3 metastatic colorectal cancer clinical trial.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mCRC)</code></pre>


<h3>Format</h3>


<table>
<tr>
 <td style="text-align: left;">
    L:</td><td style="text-align: left;"> Left endpoints of observed time intervals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    R: </td><td style="text-align: left;"> Right endpoints of observed time intervals. </td>
</tr>
<tr>
 <td style="text-align: left;">
    y: </td><td style="text-align: left;"> Censoring indicator: 0=left-censored, 1=interval-censored, 
	2=right-censored, 3=exact. </td>
</tr>
<tr>
 <td style="text-align: left;">
    TRT_C:</td><td style="text-align: left;"> Treatment arm: 0 = FOLFIRI alone, 1 = Panitumumab + FOLFIRI. </td>
</tr>
<tr>
 <td style="text-align: left;">
    KRAS_C:</td><td style="text-align: left;"> Tumor KRAS mutation status: 0 = wild-type, 1 = mutant. </td>
</tr>
<tr>
 <td style="text-align: left;">
    SITE:</td><td style="text-align: left;"> Clinical site where a patient is treated. </td>
</tr>
<tr>
 <td style="text-align: left;">
    IC:</td><td style="text-align: left;"> General interval-censored indicator: 1=general interval-censored, 0=exact. </td>
</tr>
<tr>
 <td style="text-align: left;">
    ID:</td><td style="text-align: left;"> Subject ID. </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>


<hr>
<h2 id='PIC'>PH model for partly interval-censored data</h2><span id='topic+PIC'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model to partly interval-censored data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>PIC(L, R, y, xcov, IC, scale.designX, scaled, binary, order, knots, grids, 
a_eta, b_eta, a_ga, b_ga, beta_iter, beta_cand, beta_sig0, x_user, 
total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PIC_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="PIC_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="PIC_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td></tr>
<tr><td><code id="PIC_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="PIC_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="PIC_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="PIC_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="PIC_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary: 1=binary, 0=not.</p>
</td></tr>
<tr><td><code id="PIC_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="PIC_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="PIC_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="PIC_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="PIC_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="PIC_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="PIC_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="PIC_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="PIC_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="PIC_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="PIC_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="PIC_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="PIC_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="PIC_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="PIC_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="PIC_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The baseline cumulative hazard is approximated by a linear combination of I-splines: 
</p>
<p><code>sum_{l=1}^{K}(gamma_l*b_l(t))</code>.
</p>
<p>The baseline hazard is approximated by a linear combination of basis M-splines:
</p>
<p><code>sum_{l=1}^{K}(gamma_l*M_l(t))</code>.
</p>
<p>For a binary prdictor, we sample <code>e^{beta_r}</code>, with Gamma prior.
</p>
<p>The regression coefficient <code>beta_r</code> for a continuous predictor is sampled 
using MH algorithm. During the initial <code>beta_iter</code> iterations, sd of the 
proposal distribution is <code>beta_cand</code>. Afterwards, proposal sd is set to be 
the sd of available MCMC draws. 
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p. </p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival functions is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>


<h3>References</h3>

<p>Pan, C., Cai, B., and Wang, L. (2020). A Bayesian approach for analyzing partly 
interval-censored data under the proportional hazards model.  
<em>Statistical Methods in Medical Research</em>, 
</p>
<p>DOI: 10.1177/0962280220921552.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Number of iterations set to very small for CRAN automatic testing
data(da1)
try1&lt;-PICBayes(formula=Surv(L,R,type='interval2')~x1+x2,data=data.frame(da1),
model='PIC',IC=da1[,6],scale.designX=TRUE,scale=c(1,0),binary=c(0,1),
order=3,knots=c(0,2,6,max(da1[,1:2],na.rm=TRUE)+1),grids=seq(0.1,10.1,by=0.1),
a_eta=1,b_eta=1,a_ga=1,b_ga=1,beta_iter=11,beta_cand=1,beta_sig0=10,
x_user=NULL,total=60,burnin=10,thin=1,conf.int=0.95,seed=1)
</code></pre>

<hr>
<h2 id='PICBayes'>Bayesian models for partly interval-censored data and general interval-censored data</h2><span id='topic+PICBayes'></span><span id='topic+PICBayes.formula'></span><span id='topic+PICBayes.default'></span>

<h3>Description</h3>

<p>Calls one of the 16 functions to fit the correspoinding model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>PICBayes(L, ...)

## Default S3 method:
PICBayes(L,R,y,xcov,IC,model,scale.designX,scaled,xtrt,zcov,
area,binary,I,C,nn,order=3,knots,grids,a_eta=1,b_eta=1,a_ga=1,b_ga=1,a_lamb=1,
b_lamb=1,a_tau=1,b_tau=1,a_tau_trt=1,b_tau_trt=1,a_alpha=1,b_alpha=1,H=5,
a_tau_star=1,b_tau_star=1,a_alpha_trt=1,b_alpha_trt=1,H_trt=5,
a_tau_trt_star=1,b_tau_trt_star=1,beta_iter=1001,phi_iter=1001,
beta_cand,phi_cand,beta_sig0=10,x_user=NULL,
total=6000,burnin=1000,thin=1,conf.int=0.95,seed=1,...)

## S3 method for class 'formula'
PICBayes(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PICBayes_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_model">model</code></td>
<td>
<p>A character string specifying the type of model. See details.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_xtrt">xtrt</code></td>
<td>
<p>The covariate that has a random effect.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_zcov">zcov</code></td>
<td>
<p>The design matrix for the q random effects.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_area">area</code></td>
<td>
<p>The vector of cluster ID.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_i">I</code></td>
<td>
<p>The number of areas.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_c">C</code></td>
<td>
<p>The adjacency matrix.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_nn">nn</code></td>
<td>
<p>The vector of number of neighbors for each area.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_a_lamb">a_lamb</code></td>
<td>
<p>The shape parameter of Gamma prior for spatial precision <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_b_lamb">b_lamb</code></td>
<td>
<p>The rate parameter of Gamma prior for spatial precision <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_a_tau">a_tau</code></td>
<td>
<p>The shape parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_b_tau">b_tau</code></td>
<td>
<p>The rate parameter of Gamma prior for random intercept precision <code>tau</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_a_tau_trt">a_tau_trt</code></td>
<td>
<p>The shape parameter of Gamma prior for random treatment precision <code>tau_trt</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_b_tau_trt">b_tau_trt</code></td>
<td>
<p>The rate parameter of Gamma prior for random treatment precision <code>tau_trt</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_a_alpha">a_alpha</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_b_alpha">b_alpha</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>alpha</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_h">H</code></td>
<td>
<p>The number of distinct components in DP mixture prior under blocked Gibbs sampler.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_a_tau_star">a_tau_star</code></td>
<td>
<p>The shape parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_b_tau_star">b_tau_star</code></td>
<td>
<p>The rate parameter of <code>G_0</code> in DP mixture prior.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_a_alpha_trt">a_alpha_trt</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>alpha_trt</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_b_alpha_trt">b_alpha_trt</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>alpha_trt</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_h_trt">H_trt</code></td>
<td>
<p>The number of distinct components in DP mixture prior under blocked Gibbs sampler for random treatment.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_a_tau_trt_star">a_tau_trt_star</code></td>
<td>
<p>The shape parameter of <code>G_0</code> in DP mixture prior for random treatment.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_b_tau_trt_star">b_tau_trt_star</code></td>
<td>
<p>The rate parameter of <code>G_0</code> in DP mixture prior for random treatment.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_phi_cand">phi_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the initial MH sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_formula">formula</code></td>
<td>
<p>A formula expression with the response returned by the Surv function in the survival package.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_data">data</code></td>
<td>
<p>A data frame that contains the variables named in the formula argument.</p>
</td></tr>
<tr><td><code id="PICBayes_+3A_...">...</code></td>
<td>
<p>Other arguments if any.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible values are &quot;PIC&quot;, &quot;spatialPIC&quot;, &quot;clusterPIC_int&quot;, &quot;clusterPIC_int_DP&quot;, 
&quot;clusterPIC_trt&quot;, &quot;clusterPIC_trt_DP&quot;, &quot;clusterPIC_Z&quot;, and &quot;clusterPIC_Z_DP&quot; 
for partly interval-censored data; and &quot;IC&quot;, &quot;spatialIC&quot;, &quot;clusterIC_int&quot;, 
&quot;clusterIC_int_DP&quot;, &quot;clusterIC_trt&quot;, &quot;clusterIC_trt_DP&quot;, &quot;clusterIC_Z&quot;, and 
&quot;clusterIC_Z_DP&quot; for general interval-censored data.
</p>


<h3>Value</h3>

<p>An object of class <code>PICBayes</code>. Refere to each specific function for its specific values.
</p>


<h3>Author(s)</h3>

<p>Chun Pan</p>

<hr>
<h2 id='plot.PICBayes'>Plot method for a PICBayes model</h2><span id='topic+plot.PICBayes'></span>

<h3>Description</h3>

<p>Plot estimated baseline survival function at <code>grids</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PICBayes'
plot(x, y, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.PICBayes_+3A_x">x</code></td>
<td>
<p>A sequence of points (<code>grids</code>) where baseline survival probabilities 
are estimated.</p>
</td></tr>
<tr><td><code id="plot.PICBayes_+3A_y">y</code></td>
<td>
<p>Estiamted baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code id="plot.PICBayes_+3A_...">...</code></td>
<td>
<p>Other arguments if any.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of baseline survival function.</p>

<hr>
<h2 id='spatialIC'>PH model for spatial general interval-censored data</h2><span id='topic+spatialIC'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model with spatial frailty for 
spatially dependent general interval-censored data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatialIC(L, R, y, xcov, IC, scale.designX, scaled, area, binary, I, C, nn, 
order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_lamb, b_lamb, beta_iter, 
phi_iter, beta_cand, beta_sig0, x_user, total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatialIC_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_area">area</code></td>
<td>
<p>The vector of area ID.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_i">I</code></td>
<td>
<p>The number of areas.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_c">C</code></td>
<td>
<p>The adjacency matrix.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_nn">nn</code></td>
<td>
<p>The vector of number of neighbors for each area.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_a_lamb">a_lamb</code></td>
<td>
<p>The shape parameter of Gamma prior for spatial precision <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_b_lamb">b_lamb</code></td>
<td>
<p>The rate parameter of Gamma prior for spatial precision <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="spatialIC_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The baseline cumulative hazard is approximated by a linear combination of I-splines: 
</p>
<p><code>sum_{l=1}^{K}(gamma_l*b_l(t))</code>.
</p>
<p>For a binary prdictor, we sample <code>e^{beta_r}</code>, with Gamma prior.
</p>
<p>The regression coefficient <code>beta_r</code> for a continuous predictor is sampled 
using MH algorithm. During the initial <code>beta_iter</code> iterations, sd of the 
proposal distribution is <code>beta_cand</code>. Afterwards, proposal sd is set to be 
the sd of available MCMC draws. 
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>parphi</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>parlamb</code></td>
<td>
<p>A <code>total</code> by 1 matrix of MCMC draws of <code>lambda</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival functions is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>


<h3>References</h3>

<p>Pan, C. and Cai, B. (2020). A Bayesian model for spatial partly interval-censored data.  
<em>Communications in Statistics - Simulation and Computation</em>, 
DOI: 10.1080/03610918.2020.1839497.
</p>

<hr>
<h2 id='spatialPIC'>PH model for spatial partly interval-censored data</h2><span id='topic+spatialPIC'></span>

<h3>Description</h3>

<p>Fit a Bayesian semiparametric PH model with spatial frailty for 
spatially dependent partly interval-censored data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>spatialPIC(L, R, y, xcov, IC, scale.designX, scaled, area, binary, I, 
C, nn, order, knots, grids, a_eta, b_eta, a_ga, b_ga, a_lamb, b_lamb, 
beta_iter, phi_iter, beta_cand, beta_sig0, x_user, 
total, burnin, thin, conf.int, seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spatialPIC_+3A_l">L</code></td>
<td>
<p>The vector of left endpoints of the observed time intervals.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_r">R</code></td>
<td>
<p>The vector of right endponts of the observed time intervals.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_y">y</code></td>
<td>
<p>The vector of censoring indicator: 0=left-censored, 1=interval-censored, 
2=right-censored, 3=exact.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_xcov">xcov</code></td>
<td>
<p>The covariate matrix for the p predictors.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_ic">IC</code></td>
<td>
<p>The vector of general interval-censored indicator: 
1=general interval-censored, 0=exact.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_scale.designx">scale.designX</code></td>
<td>
<p>The TRUE or FALSE indicator of whether or not to scale the design matrix X.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_scaled">scaled</code></td>
<td>
<p>The vector indicating whether each covariate is to be scaled: 1=to be scaled, 0=not.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_area">area</code></td>
<td>
<p>The vector of area ID.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_i">I</code></td>
<td>
<p>The number of areas.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_c">C</code></td>
<td>
<p>The adjacency matrix.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_nn">nn</code></td>
<td>
<p>The vector of number of neighbors for each area.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_binary">binary</code></td>
<td>
<p>The vector indicating whether each covariate is binary.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_order">order</code></td>
<td>
<p>The degree of basis I-splines: 1=linear, 2=quadratic, 3=cubic, etc.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_knots">knots</code></td>
<td>
<p>A sequence of knots to define the basis I-splines.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_grids">grids</code></td>
<td>
<p>A sequence of points at which baseline survival function is to be estimated.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_a_eta">a_eta</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_b_eta">b_eta</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>gamma_l</code>.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_a_ga">a_ga</code></td>
<td>
<p>The shape parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_b_ga">b_ga</code></td>
<td>
<p>The rate parameter of Gamma prior for <code>e^{beta_r}</code>.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_a_lamb">a_lamb</code></td>
<td>
<p>The shape parameter of Gamma prior for spatial precision <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_b_lamb">b_lamb</code></td>
<td>
<p>The rate parameter of Gamma prior for spatial precision <code>lambda</code>.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_beta_iter">beta_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_phi_iter">phi_iter</code></td>
<td>
<p>The number of initial iterations in the Metropolis-Hastings sampling for <code>phi_i</code>.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_beta_cand">beta_cand</code></td>
<td>
<p>The sd of the proposal normal distribution in the MH sampling for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_beta_sig0">beta_sig0</code></td>
<td>
<p>The sd of the prior normal distribution for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_x_user">x_user</code></td>
<td>
<p>The user-specified covariate vector at which to estimate survival function(s).</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_total">total</code></td>
<td>
<p>The number of total iterations.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_burnin">burnin</code></td>
<td>
<p>The number of burnin.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_thin">thin</code></td>
<td>
<p>The frequency of thinning.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_conf.int">conf.int</code></td>
<td>
<p>The confidence level of the CI for <code>beta_r</code>.</p>
</td></tr>
<tr><td><code id="spatialPIC_+3A_seed">seed</code></td>
<td>
<p>A user-specified random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The baseline cumulative hazard is approximated by a linear combination of I-splines: 
</p>
<p><code>sum_{l=1}^{K}(gamma_l*b_l(t))</code>.
</p>
<p>The baseline hazard is approximated by a linear combination of basis M-splines:
</p>
<p><code>sum_{l=1}^{K}(gamma_l*M_l(t))</code>.
</p>
<p>For a binary prdictor, we sample <code>e^{beta_r}</code>, with Gamma prior.
</p>
<p>The regression coefficient <code>beta_r</code> for a continuous predictor is sampled 
using MH algorithm. During the initial <code>beta_iter</code> iterations, sd of the 
proposal distribution is <code>beta_cand</code>. Afterwards, proposal sd is set to be 
the sd of available MCMC draws. 
</p>


<h3>Value</h3>

<p>a list containing the following elements:
</p>
<table>
<tr><td><code>N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code>parbeta</code></td>
<td>
<p>A <code>total</code> by <code>p</code> matrix of MCMC draws of <code>beta_r</code>, r=1, ..., p.</p>
</td></tr>
<tr><td><code>parsurv0</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)</code> matrix, each row contains the baseline survival at <code>grids</code> from one iteration.</p>
</td></tr>
<tr><td><code>parsurv</code></td>
<td>
<p>A <code>total</code> by <code>length(grids)*G</code> matrix, each row contains the survival at <code>grids</code> from one iteration. 
G is the number of sets of user-specified covariate values.</p>
</td></tr>
<tr><td><code>parphi</code></td>
<td>
<p>A <code>total</code> by <code>I</code> matrix of MCMC draws of <code>phi_i</code>, i=1,...,I.</p>
</td></tr>
<tr><td><code>parlamb</code></td>
<td>
<p>A <code>total</code> by 1 matrix of MCMC draws of <code>lambda</code>.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>A vector of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ssd</code></td>
<td>
<p>A vector of sample standard deviations of regression coefficient estimates.</p>
</td></tr>
<tr><td><code>coef_ci</code></td>
<td>
<p>The credible intervals for the regression coefficients.</p>
</td></tr>
<tr><td><code>S0_m</code></td>
<td>
<p>The estimated baseline survival at <code>grids</code>.</p>
</td></tr>
<tr><td><code>S_m</code></td>
<td>
<p>The estimated survival at <code>grids</code> with user-specified covariate values <code>x_user</code>.</p>
</td></tr>
<tr><td><code>grids</code></td>
<td>
<p>The sequance of points where baseline survival functions is estimated.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>Deviance information criterion.</p>
</td></tr>
<tr><td><code>NLLK</code></td>
<td>
<p>Negative log pseudo-marginal likelihood.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chun Pan</p>


<h3>References</h3>

<p>Pan, C. and Cai, B. (2020). A Bayesian model for spatial partly interval-censored data.  
<em>Communications in Statistics - Simulation and Computation</em>, 
DOI: 10.1080/03610918.2020.1839497.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(C)
data(da2)
nn&lt;-apply(C,1,sum)
# Number of iterations set to very small for CRAN automatic testing
try2&lt;-PICBayes(formula=Surv(L,R,type='interval2')~x1+x2,data=data.frame(da2),
model='spatialPIC',area=da2[,6],IC=da2[,7],scale.designX=TRUE,scale=c(1,0),
binary=c(0,1),I=46,C=C,nn=nn,order=3,knots=c(0,2,6,max(da2[,1:2],na.rm=TRUE)+1),
grids=seq(0.1,10.1,by=0.1),a_eta=1,b_eta=1,a_ga=1,b_ga=1,a_lamb=1,b_lamb=1,
beta_iter=11,phi_iter=11,beta_cand=1,beta_sig0=10,
x_user=NULL,total=50,burnin=10,thin=1,conf.int=0.95,seed=1)
</code></pre>

<hr>
<h2 id='summary.PICBayes'>Summary method for a PICBayes model</h2><span id='topic+summary.PICBayes'></span>

<h3>Description</h3>

<p>Present output from function <code><a href="#topic+PICBayes">PICBayes</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PICBayes'
summary(object, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.PICBayes_+3A_object">object</code></td>
<td>
<p>Class PICBayes object.</p>
</td></tr>
<tr><td><code id="summary.PICBayes_+3A_...">...</code></td>
<td>
<p>Other arguments if any.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>summary</code>.</p>

<hr>
<h2 id='SurvtoLR'>Transform Surv object to data matrix with L and R columns</h2><span id='topic+SurvtoLR'></span>

<h3>Description</h3>

<p>Take a <code><a href="survival.html#topic+Surv">Surv</a></code> object and transforms it into a data matrix with two columns, L and R, 
representing the left and right points of observed time intervals. For right-censored data, R = NA.</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurvtoLR(x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SurvtoLR_+3A_x">x</code></td>
<td>
<p>a <code><a href="survival.html#topic+Surv">Surv</a></code> object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The input Surv object should be in the form of <code>Surv(L,R,type='interval2')</code>, where R = NA for right-censored data.</p>


<h3>Value</h3>

<p>A data matrix with two variables:
</p>
<table>
<tr><td><code>L</code></td>
<td>
<p>left-points of observed time intervals</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>right-points of observed time intervals</p>
</td></tr>
</table>


<h3>References</h3>

<p>Michael P. Fay, Pamela A. Shaw (2010). Exact and Asymptotic Weighted Logrank Tests for Interval Censored Data: The interval R Package. 
<em>Journal of Statistical Software</em>, <b>36</b> 1-34.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(survival)
L&lt;-c(45,6,0,46)
R&lt;-c(NA,10,7,NA)
y&lt;-Surv(L,R,type='interval2')
SurvtoLR(y)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
