<!DOCTYPE html><html lang="en"><head><title>Help for package HRTnomaly</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HRTnomaly}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#HRTnomaly-package'><p>HRTnomaly</p></a></li>
<li><a href='#bayesHRT'><p>Calculate Cellwise Flags for Anomaly Detection Using Bayesian Testing</p></a></li>
<li><a href='#bayeswise'><p>Calculate Cellwise Flags for Anomaly Detection Using Robust Bayesian Methods</p></a></li>
<li><a href='#bootHRT'><p>Calculate Cellwise Flags for Anomaly Detection Using Bayesian Bootstrap</p></a></li>
<li><a href='#cellwise'><p>Calculate Cellwise Flags for Anomaly Detection</p></a></li>
<li><a href='#class_check'><p>Evaluate the Accuracy of Outlier Classification Results</p></a></li>
<li><a href='#dif'><p>Deep Isolation Forest</p></a></li>
<li><a href='#fuzzyHRT'><p>Calculate Cellwise Flags for Anomaly Detection</p>
<img src="../help/figures/fuzzyHRT.png" style='float:right;width:166px;height:192px;padding:2px;' alt="fuzzyHRT.png" /></a></li>
<li><a href='#gif'><p>Generalized Isolation Forest</p></a></li>
<li><a href='#print.checkwise'><p>A Method to Print the Accuracy of Outlier Classification Results</p></a></li>
<li><a href='#setCores'><p>Set the number of CPU cores for HPC</p></a></li>
<li><a href='#toy'><p>Toy dataset</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Classification/MSC-2010:</td>
<td>62G86</td>
</tr>
<tr>
<td>Title:</td>
<td>Historical, Relational, and Tail Anomaly-Detection Algorithms</td>
</tr>
<tr>
<td>Version:</td>
<td>25.2.25</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-02-25</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Luca Sartore &lt;drwolf85@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The presence of outliers in a dataset can substantially bias the
    results of statistical analyses. To correct for outliers, micro edits are 
    manually performed on all records. A set of constraints and decision rules
    is typically used to aid the editing process. However, straightforward
    decision rules might overlook anomalies arising from disruption of linear
    relationships. Computationally efficient methods are provided to 
    identify historical, tail, and relational anomalies at the data-entry 
    level (Sartore et al., 2024; &lt;<a href="https://doi.org/10.6339%2F24-JDS1136">doi:10.6339/24-JDS1136</a>&gt;). A score statistic
    is developed for each anomaly type, using a distribution-free approach
    motivated by the Bienaymé-Chebyshev's inequality, and fuzzy logic is used
    to detect cellwise outliers resulting from different types of anomalies.
    Each data entry is individually scored and individual scores are combined
    into a final score to determine anomalous entries. In contrast to fuzzy
    logic, Bayesian bootstrap and a Bayesian test based on empirical 
    likelihoods are also provided as studied by Sartore et 
    al. (2024; &lt;<a href="https://doi.org/10.3390%2Fstats7040073">doi:10.3390/stats7040073</a>&gt;). These algorithms allow for a more 
    nuanced approach to outlier detection, as it can identify outliers at 
    data-entry level which are not obviously distinct from the rest of the 
    data.
    &mdash;
    This research was supported in part by the U.S. Department of Agriculture,
    National Agriculture Statistics Service. The findings and conclusions in
    this publication are those of the authors and should not be construed to
    represent any official USDA, or US Government determination or policy.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, purrr, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, cellWise</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-25 23:46:06 UTC; sartore</td>
</tr>
<tr>
<td>Author:</td>
<td>Luca Sartore [aut] (ORCID = "0000-0002-0446-1328"),
  Luca Sartore [cre] (ORCID = "0000-0002-0446-1328"),
  Lu Chen [aut] (ORCID = "0000-0003-3387-3484"),
  Justin van Wart [aut],
  Andrew Dau [aut] (ORCID = "0009-0008-9482-5316"),
  Valbona Bejleri [aut] (ORCID = "0000-0001-9828-968X")</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-26 12:40:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='HRTnomaly-package'>HRTnomaly</h2><span id='topic+HRTnomaly-package'></span><span id='topic+HRTnomaly'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.svg" style='float:right;width:166px;height:192px;padding:2px;' alt="logo.svg" />
Enhanced Anomaly Detection for Historical, Relational, and Tail Cellwise Outlier
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> HRTnomaly</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> AGPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The presence of outliers in a dataset can substantially bias the results of statistical analyses. 
To correct for outliers, micro edits are manually performed on all records. A set of constraints 
and decision rules is typically used to aid the editing process. However, straightforward 
decision rules might overlook anomalies arising from disruption of linear relationships. 
This package provides a computationally efficient method to identify historical,
tail, and relational anomalies at the data-entry level. A score statistic 
is developed for each anomaly type, using a distribution-free approach motivated 
by the Bienaymé-Chebyshev's inequality, and fuzzy logic is used to detect 
cellwise outliers resulting from different types of anomalies. Each data entry 
is individually scored and individual scores are combined into a final score to 
determine anomalous entries. The HRTnomaly package has proven to be a powerful tool for identifying
outliers that are not easily detectable using other traditional methods. 
</p>
<p>For a complete list of exported functions, use <code>library(help = "HRTnomaly")</code>.
</p>
<p><em>This research was supported by the U.S. Department of Agriculture,
National Agriculture Statistics Service. The findings and conclusions in this
publication are those of the authors and should not be construed to represent
any official USDA or U.S. Government determination or policy.</em>
</p>


<h3>Author(s)</h3>

<p>Luca Sartore, Lu Chen, Justin van Wart, Andrew Dau, and Valbona Bejleri
</p>
<p>Maintainer: Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a>
</p>


<h3>References</h3>

<p>Agostinelli C, Leung A, Yohai VJ, Zamar RH (2015). Robust estimation of multivariate location and scatter in the presence of cellwise and casewise contamination. <em>Test</em>, <b>24</b>(3): 441&ndash;461.
</p>
<p>Alqallaf F, Van Aelst S, Yohai VJ, Zamar RH (2009). Propagation of outliers in multivariate data. <em>The Annals of Statistics</em>, 311&ndash;331.
</p>
<p>Bienaymé IJ (1867). Considérations à l'appui de la découverte de Laplace sur la loi de probabilité dans la méthode des moindres carrés. <em>Journal de Mathématiques Pures et Appliquées</em>, <b>2</b>(12): 158&ndash;176.
</p>
<p>Chepulis MA, Shevlyakov G (2020). On outlier detection with the Chebyshev type inequalities. <em>Journal of the Belarusian State University. Mathematics and Informatics</em>, <b>3</b>: 28&ndash;35.
</p>
<p>Filzmoser P, Gregorich M (2020). Multivariate outlier detection in applied data analysis: Global, local, compositional and cellwise outliers. <em>Mathematical Geosciences</em>, <b>52</b>(8): 1049&ndash;1066.
</p>
<p>Gupta MM, Qi J (1991). Theory of t-norms and fuzzy inference methods. <em>Fuzzy Sets and Systems</em>, <b>40</b>(3): 431&ndash;450.
</p>
<p>Huber PJ, Ronchetti EM (1981). <em>Robust statistics</em>. John Wiley &amp; Sons, New York.
</p>
<p>O'Gorman TJ (1994). The effect of cosmic rays on the soft error rate of a DRAM at ground level. <em>IEEE Transactions on Electron Devices</em>, <b>41</b>(4): 553&ndash;557.
</p>
<p>Rousseeuw PJ, Van den Bossche W (2018). Detecting deviating data cells. <em>Technometrics</em>, <b>60</b>(2): 135&ndash;145.
</p>
<p>Sandqvist AP (2016). Identifizierung von Ausreissern in eindimensionalen gewichteten Umfragedaten. <em>KOF Analysen</em>, <b>2016</b>(2): 45&ndash;56.
</p>
<p>Sartore L, Chen L, Bejleri V (2024). Empirical Inferences Under Bayesian Framework to Identify Cellwise Outliers. <em>Stats</em>, <b>7</b>: 1244&ndash;1258.
</p>
<p>Sartore L, Chen L, van Wart J, Dau A, Bejleri V (2024). Identifying Anomalous Data Entries in Repeated Surveys. <em>Journal of Data Science</em>, <b>22</b>(3): 436&ndash;455.
</p>
<p>Tchebichef P (1867). Des valeurs moyennes. <em>Journal de Mathématiques Pures et Appliquées</em>, <b>2</b>(12): 177&ndash;184.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the package
library(HRTnomaly)
set.seed(2025L)
# Load the 'toy' data
data(toy)
# Detect cellwise outliers using robust regression
res_c &lt;- cellwise(toy[sample.int(33), ], epochs = 10L)
# Detect cellwise outliers using Bayesian testing
res_g &lt;- bayesHRT(toy[sample.int(33), ], prior = 0.5)

# Detect record level outliers using Deep Isolation Forests
res_t &lt;- dif(iris)
</code></pre>

<hr>
<h2 id='bayesHRT'>Calculate Cellwise Flags for Anomaly Detection Using Bayesian Testing</h2><span id='topic+bayesHRT'></span>

<h3>Description</h3>

<p>The function uses the predictive posterior distribution based on emprical likelihoods to determine if a data entry is an outlier on not.
The function takes a long-format <code>data.frame</code> object as input and returns it with two appended vectors.
The first vector contains the posterior probabilities as numbers between zero and one, and the second vector provides 
a set of logical values indicating whether the data entry is an outlier (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayesHRT(a, prior = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bayesHRT_+3A_a">a</code></td>
<td>
<p>A long-format <code>data.frame</code> object with survey data. For details see information on the data format.</p>
</td></tr>
<tr><td><code id="bayesHRT_+3A_prior">prior</code></td>
<td>
<p>A numerical value or vector of cell-level prior probabilites of observing an outlier. It is <code>NULL</code> by default. If false, the function searchers for a column named <code>"prior"</code> within the dataset. If such column is not provided in the dataset, a <code>0.5</code> non-informative value is used for all cells.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>a</code> is proivded as an object of class <code>data.frame</code>.
This object is considered as a long-format <code>data.frame</code>, and it must have at least five columns with the following names:
</p>

<dl>
<dt><code>"strata"</code></dt><dd><p>a <code>character</code> or <code>factor</code> column containing the information on the stratification.</p>
</dd>
<dt><code>"unit_id"</code></dt><dd><p>a <code>character</code> or <code>factor</code> column containing the ID of the statistical unit in the survey sample(x, size, replace = FALSE, prob = NULL).</p>
</dd>
<dt><code>"master_varname"</code></dt><dd><p>a <code>character</code> column containing the name of the observed variable.</p>
</dd>
<dt><code>"current_value_num"</code></dt><dd><p>a <code>numeric</code> the observed value, i.e., a data entrie</p>
</dd>
<dt><code>"pred_value"</code></dt><dd><p>a <code>numeric</code> a value observed on a previous survey for the same variable if available. If not available, the value can be set to <code>NA</code> or <code>NaN</code>. When working with longitudinal data, the value can be set to a time-series forecast or a filtered value.</p>
</dd>
<dt><code>"prior"</code></dt><dd><p>a <code>numeric</code> a value of prior probabilities of observign an outlier for the cell. If this column is omitted in the dataset provided, the function will use the values provided through the argument <code>prior</code>.</p>
</dd></dl>

<p>The <code>data.frame</code> object in input can have more columns, but the extra columns would be ignored in the analyses.
However, these extra columns would be preserved in the system memory and returned along with the results from the cellwise outlier-detection analysis.
</p>
<p>The use of the R-packages <code>dplyr</code>, <code>purrr</code>, and <code>tidyr</code> is highly recommended to simplify the conversion of datasets between long and wide formats.
</p>


<h3>Value</h3>

<p>The long-format <code>data.frame</code> is provided as input data and contains extra columns i.e., anomaly flags and outlier posterior predictive distribution.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the package
library(HRTnomaly)
set.seed(2025L)
# Load the 'toy' data
data(toy)
# Detect cellwise outliers
res &lt;- bayesHRT(toy[sample.int(100), ], prior = 0.5)
</code></pre>

<hr>
<h2 id='bayeswise'>Calculate Cellwise Flags for Anomaly Detection Using Robust Bayesian Methods</h2><span id='topic+bayeswise'></span>

<h3>Description</h3>

<p>The function uses a Bayesian approach to determine if a data entry is an outlier on not.
The function takes a long-format <code>data.frame</code> object as input and returns it with two appended vectors.
The first vector contains the posterior probabilities for a cell to be anomalous, and the second vector provides 
a set of logical values indicating whether the data entry is an outlier (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayeswise(a, prior = NULL, epochs = 1000L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bayeswise_+3A_a">a</code></td>
<td>
<p>A long-format <code>data.frame</code> object with survey data. For details see information on the data format.</p>
</td></tr>
<tr><td><code id="bayeswise_+3A_prior">prior</code></td>
<td>
<p>A numerical value or vector of cell-level prior probabilites of observing an outlier. It is <code>NULL</code> by default. If false, the function searchers for a column named <code>"prior"</code> within the dataset. If such column is not provided in the dataset, a <code>0.5</code> non-informative value is used for all cells.</p>
</td></tr>
<tr><td><code id="bayeswise_+3A_epochs">epochs</code></td>
<td>
<p>Number of epochs used to train a nontrivial robust linear model via the lion algorithm. By default, the algorithm will run 1000 iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>a</code> is proivded as an object of class <code>data.frame</code>.
This object is considered as a long-format <code>data.frame</code>, and it must have at least five columns with the following names:
</p>

<dl>
<dt><code>"strata"</code></dt><dd><p>a <code>character</code> or <code>factor</code> column containing the information on the stratification.</p>
</dd>
<dt><code>"unit_id"</code></dt><dd><p>a <code>character</code> or <code>factor</code> column containing the ID of the statistical unit in the survey sample(x, size, replace = FALSE, prob = NULL).</p>
</dd>
<dt><code>"master_varname"</code></dt><dd><p>a <code>character</code> column containing the name of the observed variable.</p>
</dd>
<dt><code>"current_value_num"</code></dt><dd><p>a <code>numeric</code> the observed value, i.e., a data entrie</p>
</dd>
<dt><code>"pred_value"</code></dt><dd><p>a <code>numeric</code> a value observed on a previous survey for the same variable if available. If not available, the value can be set to <code>NA</code> or <code>NaN</code>. When working with longitudinal data, the value can be set to a time-series forecast or a filtered value.</p>
</dd>
<dt><code>"prior"</code></dt><dd><p>a <code>numeric</code> a value of prior probabilities of observign an outlier for the cell. If this column is omitted in the dataset provided, the function will use the values provided through the argument <code>prior</code>.</p>
</dd></dl>

<p>The <code>data.frame</code> object in input can have more columns, but the extra columns would be ignored in the analyses.
However, these extra columns would be preserved in the system memory and returned along with the results from the cellwise outlier-detection analysis.
</p>
<p>The use of the R-packages <code>dplyr</code>, <code>purrr</code>, and <code>tidyr</code> is highly recommended to simplify the conversion of datasets between long and wide formats.
</p>


<h3>Value</h3>

<p>The long-format <code>data.frame</code> is provided as input data and contains extra columns i.e., anomaly flags and outlier indicators columns.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the package
library(HRTnomaly)
set.seed(2025L)
# Load the 'toy' data
data(toy)
# Detect cellwise outliers using Bayesian Analysis
res &lt;- bayeswise(toy[sample.int(100), ], 0.5, 10L)
</code></pre>

<hr>
<h2 id='bootHRT'>Calculate Cellwise Flags for Anomaly Detection Using Bayesian Bootstrap</h2><span id='topic+bootHRT'></span>

<h3>Description</h3>

<p>The function uses Bayesian bootstrap to determine if a data entry is an outlier on not.
The function takes a long-format <code>data.frame</code> object as input and returns it with two appended vectors.
The first vector contains the anomaly scores as numbers between zero and one, and the second vector provides 
a set of logical values indicating whether the data entry is an outlier (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootHRT(a, contamination = 0.08, boot_max_it = 1000L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootHRT_+3A_a">a</code></td>
<td>
<p>A long-format <code>data.frame</code> object with survey data. For details see information on the data format.</p>
</td></tr>
<tr><td><code id="bootHRT_+3A_contamination">contamination</code></td>
<td>
<p>A number between zero and one used as a threshold when identifying outliers from the fuzzy scores. 
By default, the algorithm will identify approximately 8% of the data entries as anomalies.</p>
</td></tr>
<tr><td><code id="bootHRT_+3A_boot_max_it">boot_max_it</code></td>
<td>
<p>An integer number determining the iterations performed by Bayesian bootstrap algorithm. It is set to <code>1000</code> by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>a</code> is proivded as an object of class <code>data.frame</code>.
This object is considered as a long-format <code>data.frame</code>, and it must have at least five columns with the following names:
</p>

<dl>
<dt><code>"strata"</code></dt><dd><p>a <code>character</code> or <code>factor</code> column containing the information on the stratification.</p>
</dd>
<dt><code>"unit_id"</code></dt><dd><p>a <code>character</code> or <code>factor</code> column containing the ID of the statistical unit in the survey sample(x, size, replace = FALSE, prob = NULL).</p>
</dd>
<dt><code>"master_varname"</code></dt><dd><p>a <code>character</code> column containing the name of the observed variable.</p>
</dd>
<dt><code>"current_value_num"</code></dt><dd><p>a <code>numeric</code> the observed value, i.e., a data entrie</p>
</dd>
<dt><code>"pred_value"</code></dt><dd><p>a <code>numeric</code> a value observed on a previous survey for the same variable if available. If not available, the value can be set to <code>NA</code> or <code>NaN</code>. When working with longitudinal data, the value can be set to a time-series forecast or a filtered value.</p>
</dd></dl>

<p>The <code>data.frame</code> object in input can have more columns, but the extra columns would be ignored in the analyses.
However, these extra columns would be preserved in the system memory and returned along with the results from the cellwise outlier-detection analysis.
</p>
<p>The use of the R-packages <code>dplyr</code>, <code>purrr</code>, and <code>tidyr</code> is highly recommended to simplify the conversion of datasets between long and wide formats.
</p>


<h3>Value</h3>

<p>The long-format <code>data.frame</code> is provided as input data and contains extra columns i.e., anomaly flags and outlier indicators columns. The samples from the posterior distribution of the contamination threshold are attached as an attribute vector of length <code>B</code> named <code>"thresholds"</code>.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the package
library(HRTnomaly)
set.seed(2025L)
# Load the 'toy' data
data(toy)
# Detect cellwise outliers
res &lt;- bootHRT(toy, boot_max_it = 10)
</code></pre>

<hr>
<h2 id='cellwise'>Calculate Cellwise Flags for Anomaly Detection</h2><span id='topic+cellwise'></span>

<h3>Description</h3>

<p>The function uses fuzzy logic to determine if a data entry is an outlier on not.
The function takes a long-format <code>data.frame</code> object as input and returns it with two appended vectors.
The first vector contains the anomaly scores as numbers between zero and one, and the second vector provides 
a set of logical values indicating whether the data entry is an outlier (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cellwise(a, contamination = 0.08, epochs = 1000L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cellwise_+3A_a">a</code></td>
<td>
<p>A long-format <code>data.frame</code> object with survey data. For details see information on the data format.</p>
</td></tr>
<tr><td><code id="cellwise_+3A_contamination">contamination</code></td>
<td>
<p>A number between zero and one used as a threshold when identifying outliers from the fuzzy scores. 
By default, the algorithm will identify 8% of the records as anomalies.</p>
</td></tr>
<tr><td><code id="cellwise_+3A_epochs">epochs</code></td>
<td>
<p>Number of epochs used to train a nontrivial robust linear model via the lion algorithm. By default, the algorithm will run 1000 iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>a</code> is proivded as an object of class <code>data.frame</code>.
This object is considered as a long-format <code>data.frame</code>, and it must have at least five columns with the following names:
</p>

<dl>
<dt><code>"strata"</code></dt><dd><p>a <code>character</code> or <code>factor</code> column containing the information on the stratification.</p>
</dd>
<dt><code>"unit_id"</code></dt><dd><p>a <code>character</code> or <code>factor</code> column containing the ID of the statistical unit in the survey sample(x, size, replace = FALSE, prob = NULL).</p>
</dd>
<dt><code>"master_varname"</code></dt><dd><p>a <code>character</code> column containing the name of the observed variable.</p>
</dd>
<dt><code>"current_value_num"</code></dt><dd><p>a <code>numeric</code> the observed value, i.e., a data entrie</p>
</dd>
<dt><code>"pred_value"</code></dt><dd><p>a <code>numeric</code> a value observed on a previous survey for the same variable if available. If not available, the value can be set to <code>NA</code> or <code>NaN</code>. When working with longitudinal data, the value can be set to a time-series forecast or a filtered value.</p>
</dd></dl>

<p>The <code>data.frame</code> object in input can have more columns, but the extra columns would be ignored in the analyses.
However, these extra columns would be preserved in the system memory and returned along with the results from the cellwise outlier-detection analysis.
</p>
<p>The use of the R-packages <code>dplyr</code>, <code>purrr</code>, and <code>tidyr</code> is highly recommended to simplify the conversion of datasets between long and wide formats.
</p>


<h3>Value</h3>

<p>The long-format <code>data.frame</code> is provided as input data and contains extra columns i.e., anomaly flags and outlier indicators columns.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the package
library(HRTnomaly)
set.seed(2025L)
# Load the 'toy' data
data(toy)
# Detect cellwise outliers
res &lt;- cellwise(toy[sample.int(100), ], 0.05, 10L)
</code></pre>

<hr>
<h2 id='class_check'>Evaluate the Accuracy of Outlier Classification Results</h2><span id='topic+class_check'></span>

<h3>Description</h3>

<p>The function computes the confusion matrix between the logical output of an outlier detection algorithm and a reference (ground-truth) logical vector. 
The function also calculates the overal accuracy of the results from the confusion matrix, including recall, precision, and F1-scores for the two classes (regular, versus outlier). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>class_check(pred, truth)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="class_check_+3A_pred">pred</code></td>
<td>
<p>A logical vector with the classification output from an anomaly detection algorithm.</p>
</td></tr>
<tr><td><code id="class_check_+3A_truth">truth</code></td>
<td>
<p>A logical vector with the observed classification as a reference (or ground truth).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the confusion matrix using the function <code>table</code>. True positive and false negative are successively evaluated to compute overall accuracy, recall, precision, and F1-scores.
</p>


<h3>Value</h3>

<p>An S3 class named <code>checkwise</code> with the confusion matrix, and other accuracy metrices appended as attribues.
</p>

<dl>
<dt><code>attr(, "overall")</code></dt><dd><p>A numeric value between zero and one with the overall accuracy.</p>
</dd>
<dt><code>attr(, "recall")</code></dt><dd><p>A numeric vector of values between zero and one with the recall index for regular and outlier cells.</p>
</dd>
<dt><code>attr(, "precision")</code></dt><dd><p>A numeric vector of values between zero and one with the precision index for regular and outlier cells.</p>
</dd>
<dt><code>attr(, "f1-score")</code></dt><dd><p>A numeric vector of values between zero and one with the F1-scores for regular and outlier cells.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the package
library(HRTnomaly)
set.seed(2025L)
# Load the 'toy' data
data(toy)
# Detect cellwise outliers using Bayesian Analysis
res &lt;- cellwise(toy[sample.int(100), ], 0.5, 10L)
class_check(res$outlier, res$anomaly_flag != "")
</code></pre>

<hr>
<h2 id='dif'>Deep Isolation Forest</h2><span id='topic+dif'></span>

<h3>Description</h3>

<p>The function builds a deep isolation forest that uses fuzzy logic to determine if a record is anomalous on not.
The function takes a wide-format <code>data.frame</code> object as input and returns it with two appended vectors.
The first vector contains the anomaly scores as numbers between zero and one, and the second vector provides 
a set of logical values indicating whether the records are outliers (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dif(dta, nt = 100L, nss = NULL, threshold = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dif_+3A_dta">dta</code></td>
<td>
<p>A wide-format <code>data.frame</code> object with records (stored by row).</p>
</td></tr>
<tr><td><code id="dif_+3A_nt">nt</code></td>
<td>
<p>Number of deep isolation trees to build to form the forest. By default, it is set to <code>100</code>.</p>
</td></tr>
<tr><td><code id="dif_+3A_nss">nss</code></td>
<td>
<p>Number of subsamples used to build a single deep isolation tree. 
If set (by default) to <code>NULL</code>, the program will randomly select 25% of the records provided to the <code>dta</code> argument.</p>
</td></tr>
<tr><td><code id="dif_+3A_threshold">threshold</code></td>
<td>
<p>A number between zero and one used as a threshold when identifying outliers from the anomaly scores. 
By default, this argument is set to <code>0.95</code>, so that 5% of the records is going to be classified as anomalous.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>dta</code> is proivded as an object of class <code>data.frame</code>. 
This object is considered as a wide-format <code>data.frame</code>. 
The use of the R-packages <code>dplyr</code>, <code>purrr</code>, and <code>tidyr</code> is highly recommended to simplify the conversion of datasets between long and wide formats.
</p>


<h3>Value</h3>

<p>The wide-format <code>data.frame</code> is provided as input data and contains extra columns, i.e., for both anomaly scores and the outlier flags.</p>


<h3>Author(s)</h3>

<p>Luca Scellwise artore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the package
library(HRTnomaly)
set.seed(2025L)
# Detect outliers in the `iris` dataset
res &lt;- dif(iris)
</code></pre>

<hr>
<h2 id='fuzzyHRT'>Calculate Cellwise Flags for Anomaly Detection
<img src="../help/figures/fuzzyHRT.png" style='float:right;width:166px;height:192px;padding:2px;' alt="fuzzyHRT.png" />
</h2><span id='topic+fuzzyHRT'></span>

<h3>Description</h3>

<p>The function uses fuzzy logic to determine if a data entry is an outlier on not.
The function takes a long-format <code>data.frame</code> object as input and returns it with two appended vectors.
The first vector contains the anomaly scores as numbers between zero and one, and the second vector provides 
a set of logical values indicating whether the data entry is an outlier (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fuzzyHRT(a, contamination = 0.08)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fuzzyHRT_+3A_a">a</code></td>
<td>
<p>A long-format <code>data.frame</code> object with survey data. For details see information on the data format.</p>
</td></tr>
<tr><td><code id="fuzzyHRT_+3A_contamination">contamination</code></td>
<td>
<p>A number between zero and one used as a threshold when identifying outliers from the fuzzy scores. 
By default, the algorithm will identify 8% of the records as anomalies.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>a</code> is proivded as an object of class <code>data.frame</code>.
This object is considered as a long-format <code>data.frame</code>, and it must have at least five columns with the following names:
</p>

<dl>
<dt><code>"strata"</code></dt><dd><p>a <code>character</code> or <code>factor</code> column containing the information on the stratification.</p>
</dd>
<dt><code>"unit_id"</code></dt><dd><p>a <code>character</code> or <code>factor</code> column containing the ID of the statistical unit in the survey sample(x, size, replace = FALSE, prob = NULL).</p>
</dd>
<dt><code>"master_varname"</code></dt><dd><p>a <code>character</code> column containing the name of the observed variable.</p>
</dd>
<dt><code>"current_value_num"</code></dt><dd><p>a <code>numeric</code> the observed value, i.e., a data entrie</p>
</dd>
<dt><code>"pred_value"</code></dt><dd><p>a <code>numeric</code> a value observed on a previous survey for the same variable if available. If not available, the value can be set to <code>NA</code> or <code>NaN</code>. When working with longitudinal data, the value can be set to a time-series forecast or a filtered value.</p>
</dd></dl>

<p>The <code>data.frame</code> object in input can have more columns, but the extra columns would be ignored in the analyses.
However, these extra columns would be preserved in the system memory and returned along with the results from the cellwise outlier-detection analysis.
</p>
<p>The use of the R-packages <code>dplyr</code>, <code>purrr</code>, and <code>tidyr</code> is highly recommended to simplify the conversion of datasets between long and wide formats.
</p>


<h3>Value</h3>

<p>The long-format <code>data.frame</code> is provided as input data and contains extra columns i.e., anomaly flags and outlier indicators columns.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the package
library(HRTnomaly)
set.seed(2025L)
# Load the 'toy' data
data(toy)
# Detect cellwise outliers
res &lt;- fuzzyHRT(toy[sample.int(100), ])
</code></pre>

<hr>
<h2 id='gif'>Generalized Isolation Forest</h2><span id='topic+gif'></span>

<h3>Description</h3>

<p>The function builds a generalized isolation forest that uses fuzzy logic to determine if a record is anomalous on not.
The function takes a wide-format <code>data.frame</code> object as input and returns it with two appended vectors.
The first vector contains the anomaly scores as numbers between zero and one, and the second vector provides 
a set of logical values indicating whether the records are outliers (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gif(dta, nt = 100L, nss = NULL, threshold = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gif_+3A_dta">dta</code></td>
<td>
<p>A wide-format <code>data.frame</code> object with records (stored by row).</p>
</td></tr>
<tr><td><code id="gif_+3A_nt">nt</code></td>
<td>
<p>Number of generalized isolation trees to build to form the forest. By default, it is set to <code>100</code>.</p>
</td></tr>
<tr><td><code id="gif_+3A_nss">nss</code></td>
<td>
<p>Number of subsamples used to build a single generalized isolation tree. 
If set (by default) to <code>NULL</code>, the program will randomly select 25% of the records provided to the <code>dta</code> argument.</p>
</td></tr>
<tr><td><code id="gif_+3A_threshold">threshold</code></td>
<td>
<p>A number between zero and one used as a threshold when identifying outliers from the anomaly scores. 
By default, this argument is set to <code>0.95</code>, so that 5% of the records is going to be classified as anomalous.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>dta</code> is proivded as an object of class <code>data.frame</code>. 
This object is considered as a wide-format <code>data.frame</code>. 
The use of the R-packages <code>dplyr</code>, <code>purrr</code>, and <code>tidyr</code> is highly recommended to simplify the conversion of datasets between long and wide formats.
</p>


<h3>Value</h3>

<p>The wide-format <code>data.frame</code> is provided as input data and contains extra columns, i.e., for both anomaly scores and the outlier flags.</p>


<h3>Author(s)</h3>

<p>Luca Scellwise artore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the package
library(HRTnomaly)
set.seed(2025L)
# Detect outliers in the `iris` dataset
res &lt;- gif(iris)
</code></pre>

<hr>
<h2 id='print.checkwise'>A Method to Print the Accuracy of Outlier Classification Results</h2><span id='topic+print.checkwise'></span>

<h3>Description</h3>

<p>The function print the confusion matrix and accuracy results previously computed with the function <code>class_check</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'checkwise'
print(x, confusion = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.checkwise_+3A_x">x</code></td>
<td>
<p>An S3 object of the class <code>checkwise</code>, typically computed with the function <code>class_check</code>.</p>
</td></tr>
<tr><td><code id="print.checkwise_+3A_confusion">confusion</code></td>
<td>
<p>A logical value, which is <code>FALSE</code> by default. If <code>TRUE</code>, the confusion matrix is printed after showing all accuracy metrics.</p>
</td></tr>
<tr><td><code id="print.checkwise_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to the function <code>cat</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the confusion matrix using the function <code>table</code>. True positive and false negative are successively evaluated to compute overall accuracy, recall, precision, and F1-scores.
</p>


<h3>Value</h3>

<p>An S3 class named <code>checkwise</code> with the confusion matrix, and other accuracy metrics appended as attribues.
</p>

<dl>
<dt><code>attr(, "overall")</code></dt><dd><p>A numeric value between zero and one with the overall accuracy.</p>
</dd>
<dt><code>attr(, "recall")</code></dt><dd><p>A numeric vector of values between zero and one with the recall index for regular and outlier cells.</p>
</dd>
<dt><code>attr(, "precision")</code></dt><dd><p>A numeric vector of values between zero and one with the precision index for regular and outlier cells.</p>
</dd>
<dt><code>attr(, "f1-score")</code></dt><dd><p>A numeric vector of values between zero and one with the F1-scores for regular and outlier cells.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the package
library(HRTnomaly)
set.seed(2025L)
# Load the 'toy' data
data(toy)
# Detect cellwise outliers using Bayesian Analysis
res &lt;- cellwise(toy[sample.int(100), ], 0.5, 10L)
class_check(res$outlier, res$anomaly_flag != "")
</code></pre>

<hr>
<h2 id='setCores'>Set the number of CPU cores for HPC</h2><span id='topic+setCores'></span>

<h3>Description</h3>

<p>The function set the number of CPU cores for parallel computation by the use of OpenMP library (<a href="https://www.openmp.org/">https://www.openmp.org/</a>). If the package was not complied with the library OpenMP (&gt;= 3.0), this function is disabled.</p>


<h3>Usage</h3>

<pre><code class='language-R'>setCores(n)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setCores_+3A_n">n</code></td>
<td>
<p>an integer value denoting the number of CPU cores to use; if it exceeds the total number of cores, all of them will be used. If missing, the number of CPU cores in use will be displayed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the package is loaded, only one CPU core is used.
</p>


<h3>Value</h3>

<p>The total number of CPU cores in use will be returned and a message will be displayed. If the package was not complied with the library OpenMP (&gt;= 3.0), the value one will be returned.</p>


<h3>Author(s)</h3>

<p>Luca Sartore <a href="mailto:drwolf85@gmail.com">drwolf85@gmail.com</a></p>


<h3>References</h3>

<p>SunTM ONE Studio 8 (2003) <em>OpenMP API User's Guide</em>. Sun Microsystems Inc., Santa Clara, U.S.A.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Display the number of CPU cores in use
setCores()

#Set 2 CPU cores for parallel computation
setCores(2)

#Set 1 CPU core for serial computation
setCores(1)
</code></pre>

<hr>
<h2 id='toy'>Toy dataset</h2><span id='topic+toy'></span>

<h3>Description</h3>

<p>Synthetically produced data are provided to test the FuzzyHRT algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(toy)</code></pre>


<h3>Format</h3>

<p>The <code>toy</code> data is a <code>data.frame</code> object consisting of 9265 synthetic records and 5 variables:
</p>

<dl>
<dt><code>strata</code></dt><dd><p>a numeric value of the strata</p>
</dd>
<dt><code>unit_id</code></dt><dd><p>a character string with the record ID</p>
</dd>
<dt><code>master_varname</code></dt><dd><p>a character string with the names of the variables</p>
</dd>
<dt><code>current_value_num</code></dt><dd><p>a numeric value with the current synthetic observation</p>
</dd>
<dt><code>pred_value</code></dt><dd><p>a numeric value with the previously synthetic observation</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># Load the package
library(HRTnomaly)
set.seed(2025L)
# Load the toy dataset
data(toy)
# Detect cellwise outliers
res &lt;- fuzzyHRT(toy)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
