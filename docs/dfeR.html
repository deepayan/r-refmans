<!DOCTYPE html><html lang="en-GB"><head><title>Help for package dfeR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dfeR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dfeR-package'><p>dfeR: Common Department for Education Analysis Tasks</p></a></li>
<li><a href='#comma_sep'><p>Comma separate</p></a></li>
<li><a href='#countries'><p>Lookup for valid country names and codes</p></a></li>
<li><a href='#create_project'><p>Creates a pre-populated project for DfE R</p></a></li>
<li><a href='#fetch'><p>Fetch Westminster parliamentary constituencies</p></a></li>
<li><a href='#fetch_countries'><p>Fetch countries</p></a></li>
<li><a href='#fetch_lads'><p>Fetch local authority districts</p></a></li>
<li><a href='#fetch_las'><p>Fetch local authorities</p></a></li>
<li><a href='#fetch_regions'><p>Fetch regions</p></a></li>
<li><a href='#fetch_wards'><p>Fetch wards</p></a></li>
<li><a href='#format_ay'><p>Format academic year</p></a></li>
<li><a href='#format_ay_reverse'><p>Undo academic year formatting</p></a></li>
<li><a href='#format_fy'><p>Format financial year</p></a></li>
<li><a href='#format_fy_reverse'><p>Undo financial year formatting</p></a></li>
<li><a href='#geog_time_identifiers'><p>Potential names for geography and time columns</p></a></li>
<li><a href='#get_clean_sql'><p>Get a cleaned SQL script into R</p></a></li>
<li><a href='#get_ons_api_data'><p>Fetch ONS Open Geography API data</p></a></li>
<li><a href='#ons_geog_shorthands'><p>Lookup for ONS geography columns shorthands</p></a></li>
<li><a href='#pretty_filesize'><p>Pretty numbers into readable file size</p></a></li>
<li><a href='#pretty_num'><p>Prettify big numbers into a readable format</p></a></li>
<li><a href='#pretty_num_table'><p>Format a data frame with <code>dfeR::pretty_num()</code>.</p></a></li>
<li><a href='#pretty_time_taken'><p>Calculate elapsed time between two points and present prettily</p></a></li>
<li><a href='#regions'><p>Lookup for valid region names and codes</p></a></li>
<li><a href='#round_five_up'><p>Round five up</p></a></li>
<li><a href='#toggle_message'><p>Controllable console messages</p></a></li>
<li><a href='#wd_pcon_lad_la_rgn_ctry'><p>Ward to Constituency to LAD to LA to Region to Country lookup</p></a></li>
<li><a href='#z_replace'><p>Replaces <code>NA</code> values in tables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Common Department for Education Analysis Tasks</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Preferred methods for common analytical tasks that are
    undertaken across the Department, including number formatting, project
    templates and curated reference data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://dfe-analytical-services.github.io/dfeR/">https://dfe-analytical-services.github.io/dfeR/</a>,
<a href="https://github.com/dfe-analytical-services/dfeR">https://github.com/dfe-analytical-services/dfeR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dfe-analytical-services/dfeR/issues">https://github.com/dfe-analytical-services/dfeR/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, emoji, httr, jsonlite, lifecycle, magrittr, renv,
rlang, tidyselect, usethis, utils, withr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, readxl, rmarkdown, spelling, stringr, testthat (&ge;
3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-15 20:48:25 UTC; camra</td>
</tr>
<tr>
<td>Author:</td>
<td>Cam Race [aut, cre],
  Department for Education, England [cph],
  Laura Selby [aut],
  Adam Robinson [aut],
  Jen Machin [ctb],
  Jake Tufts [ctb],
  Rich Bielby <a href="https://orcid.org/0000-0001-9070-9969"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Menna Zayed [ctb],
  Lauren Snaathorst [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cam Race &lt;cameron.race@education.gov.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-15 21:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='dfeR-package'>dfeR: Common Department for Education Analysis Tasks</h2><span id='topic+dfeR'></span><span id='topic+dfeR-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Preferred methods for common analytical tasks that are undertaken across the Department, including number formatting, project templates and curated reference data.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Cam Race <a href="mailto:cameron.race@education.gov.uk">cameron.race@education.gov.uk</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Laura Selby <a href="mailto:laura.selby@education.gov.uk">laura.selby@education.gov.uk</a>
</p>
</li>
<li><p> Adam Robinson
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Department for Education, England <a href="mailto:statistics.development@education.gov.uk">statistics.development@education.gov.uk</a> [copyright holder]
</p>
</li>
<li><p> Jen Machin <a href="mailto:jen.machin@education.gov.uk">jen.machin@education.gov.uk</a> [contributor]
</p>
</li>
<li><p> Jake Tufts <a href="mailto:jake.tufts@education.gov.uk">jake.tufts@education.gov.uk</a> [contributor]
</p>
</li>
<li><p> Rich Bielby <a href="mailto:richard.bielby@education.gov.uk">richard.bielby@education.gov.uk</a> (<a href="https://orcid.org/0000-0001-9070-9969">ORCID</a>) [contributor]
</p>
</li>
<li><p> Menna Zayed <a href="mailto:menna.zayed@education.gov.uk">menna.zayed@education.gov.uk</a> [contributor]
</p>
</li>
<li><p> Lauren Snaathorst <a href="mailto:lauren.snaathorst@education.gov.uk">lauren.snaathorst@education.gov.uk</a> [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://dfe-analytical-services.github.io/dfeR/">https://dfe-analytical-services.github.io/dfeR/</a>
</p>
</li>
<li> <p><a href="https://github.com/dfe-analytical-services/dfeR">https://github.com/dfe-analytical-services/dfeR</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/dfe-analytical-services/dfeR/issues">https://github.com/dfe-analytical-services/dfeR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='comma_sep'>Comma separate</h2><span id='topic+comma_sep'></span>

<h3>Description</h3>

<p>Adds separating commas to big numbers. If a value is not numeric it will
return the value unchanged and as a string.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comma_sep(number, nsmall = 0L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="comma_sep_+3A_number">number</code></td>
<td>
<p>number to be comma separated</p>
</td></tr>
<tr><td><code id="comma_sep_+3A_nsmall">nsmall</code></td>
<td>
<p>minimum number of digits to the right of the decimal point</p>
</td></tr>
</table>


<h3>Value</h3>

<p>string
</p>


<h3>Examples</h3>

<pre><code class='language-R'>comma_sep(100)
comma_sep(1000)
comma_sep(3567000)
</code></pre>

<hr>
<h2 id='countries'>Lookup for valid country names and codes</h2><span id='topic+countries'></span>

<h3>Description</h3>

<p>A lookup of ONS geography country names and codes, as well as some custom
DfE names and codes. This is used as the definitive list for the screening
of open data before it is published by the DfE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>countries
</code></pre>


<h3>Format</h3>



<h4><code>countries</code></h4>

<p>A data frame with 10 rows and 2 columns:
</p>

<dl>
<dt>country_name</dt><dd><p>Country name</p>
</dd>
<dt>country_code</dt><dd><p>Country code</p>
</dd>
</dl>




<h3>Source</h3>

<p>curated by explore.statistics@education.gov.uk, ONS codes sourced
from
https://geoportal.statistics.gov.uk/search?q=countries%20names%20and%20codes
</p>

<hr>
<h2 id='create_project'>Creates a pre-populated project for DfE R</h2><span id='topic+create_project'></span>

<h3>Description</h3>

<p>Creates a pre-populated project for DfE R
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_project(
  path,
  init_renv = TRUE,
  include_structure_for_pkg = FALSE,
  create_publication_proj = FALSE,
  include_github_gitignore,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_project_+3A_path">path</code></td>
<td>
<p>Path of the new project</p>
</td></tr>
<tr><td><code id="create_project_+3A_init_renv">init_renv</code></td>
<td>
<p>Boolean; initiate renv in the project.
Default is set to true.</p>
</td></tr>
<tr><td><code id="create_project_+3A_include_structure_for_pkg">include_structure_for_pkg</code></td>
<td>
<p>Boolean; Additional folder structure for
package development. Default is set to false.</p>
</td></tr>
<tr><td><code id="create_project_+3A_create_publication_proj">create_publication_proj</code></td>
<td>
<p>Boolean; Should the folder structure be for a
publication project. Default is set to false.</p>
</td></tr>
<tr><td><code id="create_project_+3A_include_github_gitignore">include_github_gitignore</code></td>
<td>
<p>Boolean; Should a strict .gitignore file for
GitHub be created.</p>
</td></tr>
<tr><td><code id="create_project_+3A_...">...</code></td>
<td>
<p>Additional parameters, currently not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates a new project with a custom folder structure.
It sets up the <code style="white-space: pre;">&#8288;R/&#8288;</code> folder and template function scripts,
initializes <code>{testthat}</code> and adds tests for the function scripts,
builds the core project structure, creates a .gitignore file,
creates a readme, and optionally initializes <code>{renv}</code>.
</p>


<h3>Value</h3>

<p>No return values, the project and its contents are created
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Call the function to create a new project
dfeR::create_project(
  path = "C:/path/to/your/new/project",
  init_renv = TRUE,
  include_structure_for_pkg = FALSE,
  create_publication_proj = FALSE,
  include_github_gitignore = TRUE
)

## End(Not run)
</code></pre>

<hr>
<h2 id='fetch'>Fetch Westminster parliamentary constituencies</h2><span id='topic+fetch'></span><span id='topic+fetch_pcons'></span>

<h3>Description</h3>

<p>Fetch a data frame of all Westminster Parliamentary Constituencies for a
given year and country based on the dfeR::wd_pcon_lad_la_rgn_ctry file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_pcons(year = "All", countries = "All")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fetch_+3A_year">year</code></td>
<td>
<p>year to filter the locations to, default is &quot;All&quot;,
options of 2017, 2019, 2020, 2021, 2022&quot;, 2023, 2024</p>
</td></tr>
<tr><td><code id="fetch_+3A_countries">countries</code></td>
<td>
<p>vector of desired countries to filter the locations to,
default is &quot;All&quot;, or can be a vector with options of &quot;England&quot;, &quot;Scotland&quot;,
&quot;Wales&quot; or &quot;Northern Ireland&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of unique location names and codes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Using head() to show only top 5 rows for examples
head(fetch_wards())

head(fetch_pcons())

head(fetch_pcons(2023))

head(fetch_pcons(countries = "Scotland"))

head(fetch_pcons(year = 2023, countries = c("England", "Wales")))

fetch_lads(2024, "Wales")

fetch_las(2022, "Northern Ireland")

# The following have no specific years available and return all values
fetch_regions()
fetch_countries()
</code></pre>

<hr>
<h2 id='fetch_countries'>Fetch countries</h2><span id='topic+fetch_countries'></span>

<h3>Description</h3>

<p>Fetch countries
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_countries()
</code></pre>


<h3>Value</h3>

<p>data frame of unique location names and codes
</p>


<h3>See Also</h3>

<p>Other fetch_locations: 
<code><a href="#topic+fetch_lads">fetch_lads</a>()</code>,
<code><a href="#topic+fetch_las">fetch_las</a>()</code>,
<code><a href="#topic+fetch_regions">fetch_regions</a>()</code>,
<code><a href="#topic+fetch_wards">fetch_wards</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Using head() to show only top 5 rows for examples
head(fetch_wards())

head(fetch_pcons())

head(fetch_pcons(2023))

head(fetch_pcons(countries = "Scotland"))

head(fetch_pcons(year = 2023, countries = c("England", "Wales")))

fetch_lads(2024, "Wales")

fetch_las(2022, "Northern Ireland")

# The following have no specific years available and return all values
fetch_regions()
fetch_countries()
</code></pre>

<hr>
<h2 id='fetch_lads'>Fetch local authority districts</h2><span id='topic+fetch_lads'></span>

<h3>Description</h3>

<p>Fetch local authority districts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_lads(year = "All", countries = "All")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fetch_lads_+3A_year">year</code></td>
<td>
<p>year to filter the locations to, default is &quot;All&quot;,
options of 2017, 2019, 2020, 2021, 2022&quot;, 2023, 2024</p>
</td></tr>
<tr><td><code id="fetch_lads_+3A_countries">countries</code></td>
<td>
<p>vector of desired countries to filter the locations to,
default is &quot;All&quot;, or can be a vector with options of &quot;England&quot;, &quot;Scotland&quot;,
&quot;Wales&quot; or &quot;Northern Ireland&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of unique location names and codes
</p>


<h3>See Also</h3>

<p>Other fetch_locations: 
<code><a href="#topic+fetch_countries">fetch_countries</a>()</code>,
<code><a href="#topic+fetch_las">fetch_las</a>()</code>,
<code><a href="#topic+fetch_regions">fetch_regions</a>()</code>,
<code><a href="#topic+fetch_wards">fetch_wards</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Using head() to show only top 5 rows for examples
head(fetch_wards())

head(fetch_pcons())

head(fetch_pcons(2023))

head(fetch_pcons(countries = "Scotland"))

head(fetch_pcons(year = 2023, countries = c("England", "Wales")))

fetch_lads(2024, "Wales")

fetch_las(2022, "Northern Ireland")

# The following have no specific years available and return all values
fetch_regions()
fetch_countries()
</code></pre>

<hr>
<h2 id='fetch_las'>Fetch local authorities</h2><span id='topic+fetch_las'></span>

<h3>Description</h3>

<p>Fetch local authorities
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_las(year = "All", countries = "All")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fetch_las_+3A_year">year</code></td>
<td>
<p>year to filter the locations to, default is &quot;All&quot;,
options of 2017, 2019, 2020, 2021, 2022&quot;, 2023, 2024</p>
</td></tr>
<tr><td><code id="fetch_las_+3A_countries">countries</code></td>
<td>
<p>vector of desired countries to filter the locations to,
default is &quot;All&quot;, or can be a vector with options of &quot;England&quot;, &quot;Scotland&quot;,
&quot;Wales&quot; or &quot;Northern Ireland&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of unique location names and codes
</p>


<h3>See Also</h3>

<p>Other fetch_locations: 
<code><a href="#topic+fetch_countries">fetch_countries</a>()</code>,
<code><a href="#topic+fetch_lads">fetch_lads</a>()</code>,
<code><a href="#topic+fetch_regions">fetch_regions</a>()</code>,
<code><a href="#topic+fetch_wards">fetch_wards</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Using head() to show only top 5 rows for examples
head(fetch_wards())

head(fetch_pcons())

head(fetch_pcons(2023))

head(fetch_pcons(countries = "Scotland"))

head(fetch_pcons(year = 2023, countries = c("England", "Wales")))

fetch_lads(2024, "Wales")

fetch_las(2022, "Northern Ireland")

# The following have no specific years available and return all values
fetch_regions()
fetch_countries()
</code></pre>

<hr>
<h2 id='fetch_regions'>Fetch regions</h2><span id='topic+fetch_regions'></span>

<h3>Description</h3>

<p>Fetch regions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_regions()
</code></pre>


<h3>Value</h3>

<p>data frame of unique location names and codes
</p>


<h3>See Also</h3>

<p>Other fetch_locations: 
<code><a href="#topic+fetch_countries">fetch_countries</a>()</code>,
<code><a href="#topic+fetch_lads">fetch_lads</a>()</code>,
<code><a href="#topic+fetch_las">fetch_las</a>()</code>,
<code><a href="#topic+fetch_wards">fetch_wards</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Using head() to show only top 5 rows for examples
head(fetch_wards())

head(fetch_pcons())

head(fetch_pcons(2023))

head(fetch_pcons(countries = "Scotland"))

head(fetch_pcons(year = 2023, countries = c("England", "Wales")))

fetch_lads(2024, "Wales")

fetch_las(2022, "Northern Ireland")

# The following have no specific years available and return all values
fetch_regions()
fetch_countries()
</code></pre>

<hr>
<h2 id='fetch_wards'>Fetch wards</h2><span id='topic+fetch_wards'></span>

<h3>Description</h3>

<p>Fetch wards
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fetch_wards(year = "All", countries = "All")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fetch_wards_+3A_year">year</code></td>
<td>
<p>year to filter the locations to, default is &quot;All&quot;,
options of 2017, 2019, 2020, 2021, 2022&quot;, 2023, 2024</p>
</td></tr>
<tr><td><code id="fetch_wards_+3A_countries">countries</code></td>
<td>
<p>vector of desired countries to filter the locations to,
default is &quot;All&quot;, or can be a vector with options of &quot;England&quot;, &quot;Scotland&quot;,
&quot;Wales&quot; or &quot;Northern Ireland&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame of unique location names and codes
</p>


<h3>See Also</h3>

<p>Other fetch_locations: 
<code><a href="#topic+fetch_countries">fetch_countries</a>()</code>,
<code><a href="#topic+fetch_lads">fetch_lads</a>()</code>,
<code><a href="#topic+fetch_las">fetch_las</a>()</code>,
<code><a href="#topic+fetch_regions">fetch_regions</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Using head() to show only top 5 rows for examples
head(fetch_wards())

head(fetch_pcons())

head(fetch_pcons(2023))

head(fetch_pcons(countries = "Scotland"))

head(fetch_pcons(year = 2023, countries = c("England", "Wales")))

fetch_lads(2024, "Wales")

fetch_las(2022, "Northern Ireland")

# The following have no specific years available and return all values
fetch_regions()
fetch_countries()
</code></pre>

<hr>
<h2 id='format_ay'>Format academic year</h2><span id='topic+format_ay'></span>

<h3>Description</h3>

<p>This function formats academic year variables for reporting purposes. It
will convert an academic year input from 201516 format to 2015/16 format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_ay(year)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format_ay_+3A_year">year</code></td>
<td>
<p>Academic year</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It accepts both numerical and character arguments.
</p>


<h3>Value</h3>

<p>Character vector of formatted academic year
</p>


<h3>See Also</h3>

<p>Other format: 
<code><a href="#topic+format_ay_reverse">format_ay_reverse</a>()</code>,
<code><a href="#topic+format_fy">format_fy</a>()</code>,
<code><a href="#topic+format_fy_reverse">format_fy_reverse</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>format_ay(201617)
format_ay("201617")
</code></pre>

<hr>
<h2 id='format_ay_reverse'>Undo academic year formatting</h2><span id='topic+format_ay_reverse'></span>

<h3>Description</h3>

<p>This function converts academic year variables back into 201617 format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_ay_reverse(year)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format_ay_reverse_+3A_year">year</code></td>
<td>
<p>Academic year</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It accepts character arguments.
</p>


<h3>Value</h3>

<p>Unformatted 6 digit year as string
</p>


<h3>See Also</h3>

<p>Other format: 
<code><a href="#topic+format_ay">format_ay</a>()</code>,
<code><a href="#topic+format_fy">format_fy</a>()</code>,
<code><a href="#topic+format_fy_reverse">format_fy_reverse</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>format_ay_reverse("2016/17")
</code></pre>

<hr>
<h2 id='format_fy'>Format financial year</h2><span id='topic+format_fy'></span>

<h3>Description</h3>

<p>This function formats financial year variables for reporting purposes. It
will convert an year input from 201516 format to 2015-16 format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_fy(year)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format_fy_+3A_year">year</code></td>
<td>
<p>Financial year</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It accepts both numerical and character arguments.
</p>


<h3>Value</h3>

<p>Character vector of formatted financial year
</p>


<h3>See Also</h3>

<p>Other format: 
<code><a href="#topic+format_ay">format_ay</a>()</code>,
<code><a href="#topic+format_ay_reverse">format_ay_reverse</a>()</code>,
<code><a href="#topic+format_fy_reverse">format_fy_reverse</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>format_fy(201617)
format_fy("201617")
</code></pre>

<hr>
<h2 id='format_fy_reverse'>Undo financial year formatting</h2><span id='topic+format_fy_reverse'></span>

<h3>Description</h3>

<p>This function converts financial year variables back into 201617 format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_fy_reverse(year)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format_fy_reverse_+3A_year">year</code></td>
<td>
<p>Financial year</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It accepts character arguments.
</p>


<h3>Value</h3>

<p>Unformatted 6 digit year as string
</p>


<h3>See Also</h3>

<p>Other format: 
<code><a href="#topic+format_ay">format_ay</a>()</code>,
<code><a href="#topic+format_ay_reverse">format_ay_reverse</a>()</code>,
<code><a href="#topic+format_fy">format_fy</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>format_fy_reverse("2016-17")
</code></pre>

<hr>
<h2 id='geog_time_identifiers'>Potential names for geography and time columns</h2><span id='topic+geog_time_identifiers'></span>

<h3>Description</h3>

<p>Potential names for geography and time columns in line with the ones used for
the explore education statistics data screener.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geog_time_identifiers
</code></pre>


<h3>Format</h3>



<h4><code>geog_time_identifiers</code></h4>

<p>A character vector with 38 potential column names in snake case format.
</p>



<h3>Source</h3>

<p>curated by explore.statistics@education.gov.uk.
<a href="https://www.shorturl.at/j4532">Guidance on time and geography data.</a>
</p>

<hr>
<h2 id='get_clean_sql'>Get a cleaned SQL script into R</h2><span id='topic+get_clean_sql'></span>

<h3>Description</h3>

<p>This function cleans a SQL script, ready for using within R in the DfE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_clean_sql(filepath, additional_settings = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_clean_sql_+3A_filepath">filepath</code></td>
<td>
<p>path to a SQL script</p>
</td></tr>
<tr><td><code id="get_clean_sql_+3A_additional_settings">additional_settings</code></td>
<td>
<p>TRUE or FALSE boolean for the addition of
settings at the start of the SQL script</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cleaned string containing SQL query
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This assumes you have already set up a database connection
# and that the filepath for the function exists
# For more details see the vignette on connecting to SQL

# Pull a cleaned version of the SQL file into R
if (file.exists("your_script.sql")) {
  sql_query &lt;- get_clean_sql("your_script.sql")
}
</code></pre>

<hr>
<h2 id='get_ons_api_data'>Fetch ONS Open Geography API data</h2><span id='topic+get_ons_api_data'></span>

<h3>Description</h3>

<p>Helper function that takes a data set id and parameters to query and parse
data from the ONS Open Geography API. Technically uses a POST request rather
than a GET request.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ons_api_data(
  data_id,
  query_params = list(where = "1=1", outFields = "*", outSR = "4326", f = "json"),
  batch_size = 200,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_ons_api_data_+3A_data_id">data_id</code></td>
<td>
<p>the id of the data set to query, can be found from the Open
Geography Portal</p>
</td></tr>
<tr><td><code id="get_ons_api_data_+3A_query_params">query_params</code></td>
<td>
<p>query parameters to pass into the API, see the ESRI
documentation for more information on query parameters -
<a href="https://www.shorturl.at/5xrJT">ESRI Query (Feature Service/Layer)</a></p>
</td></tr>
<tr><td><code id="get_ons_api_data_+3A_batch_size">batch_size</code></td>
<td>
<p>the number of rows per query. This is 250 by default, if
you hit errors then try lowering this. The API has a limit of 1000 to 2000
rows per query, and in truth, the actual limit for our method is lower as
every ObjectId queried is pasted into the query URL so for every row
included in the batch, and especial if those Id's go into the 1,000s or
10,000s they will increase the size of the URL and risk hitting the limit.</p>
</td></tr>
<tr><td><code id="get_ons_api_data_+3A_verbose">verbose</code></td>
<td>
<p>TRUE or FALSE boolean. TRUE by default. FALSE will turn off
the messages to the console that update on what the function is doing</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It does a pre-query to understand the ObjectIds for the query you want, and
then does a query to retrieve those Ids directly in batches before then
stacking the whole thing back together to work around the row limits for a
single query.
</p>
<p>On the <a href="https://geoportal.statistics.gov.uk/">Open Geography Portal</a>,
find the data set you're interested in and then use the query explorer to
find the information for the query.
</p>
<p>This function has been mostly developed for ease of use for dfeR maintainers
if you're interested in getting data from the Open Geography Portal more
widely you should also look at the
<a href="https://github.com/francisbarton/boundr">boundr package</a>.
</p>


<h3>Value</h3>

<p>parsed data.frame of geographic names and codes
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fetch everything from a data set
dfeR::get_ons_api_data(data_id = "LAD23_RGN23_EN_LU")

# Specify the columns you want
dfeR::get_ons_api_data(
  "RGN_DEC_2023_EN_NC",
  query_params = list(
    where = "1=1",
    outFields = "RGN23CD,RGN23NM",
    outSR = 4326,
    f = "json"
  )
)
</code></pre>

<hr>
<h2 id='ons_geog_shorthands'>Lookup for ONS geography columns shorthands</h2><span id='topic+ons_geog_shorthands'></span>

<h3>Description</h3>

<p>A lookup of ONS geography shorthands and their respective column names in
line with DfE open data standards.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ons_geog_shorthands
</code></pre>


<h3>Format</h3>



<h4><code>ons_geog_shorthands</code></h4>

<p>A data frame with 7 rows and 3 columns:
</p>

<dl>
<dt>ons_level_shorthands</dt><dd><p>ONS shorthands used in their lookup files</p>
</dd>
<dt>name_column</dt><dd><p>DfE names for geography name columns</p>
</dd>
<dt>code_column</dt><dd><p>DfE names for geography code columns</p>
</dd>
</dl>




<h3>Details</h3>

<p>GOR (Government Office Region) was the predecessor to RGN.
</p>


<h3>Source</h3>

<p>curated by explore.statistics@education.gov.uk
</p>

<hr>
<h2 id='pretty_filesize'>Pretty numbers into readable file size</h2><span id='topic+pretty_filesize'></span>

<h3>Description</h3>

<p>Converts a raw file size from bytes to a more readable format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pretty_filesize(filesize)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pretty_filesize_+3A_filesize">filesize</code></td>
<td>
<p>file size in bytes</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Designed to be used in conjunction with the file.size()
function in base R.
</p>
<p>Presents in kilobytes, megabytes or gigabytes.
</p>
<p>Shows as bytes until 1 KB, then kilobytes up to 1 MB, then megabytes
until 1GB, then it will show as gigabytes for anything larger.
</p>
<p>Rounds the end result to 2 decimal places.
</p>
<p>Using base 10 (decimal), so 1024 bytes is 1,024 KB.
</p>


<h3>Value</h3>

<p>string containing prettified file size
</p>


<h3>See Also</h3>

<p><code><a href="#topic+comma_sep">comma_sep()</a></code> <code><a href="#topic+round_five_up">round_five_up()</a></code>
</p>
<p>Other prettying: 
<code><a href="#topic+pretty_num">pretty_num</a>()</code>,
<code><a href="#topic+pretty_num_table">pretty_num_table</a>()</code>,
<code><a href="#topic+pretty_time_taken">pretty_time_taken</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pretty_filesize(2)
pretty_filesize(549302)
pretty_filesize(9872948939)
pretty_filesize(1)
pretty_filesize(1000)
pretty_filesize(1000^2)
pretty_filesize(10^9)
</code></pre>

<hr>
<h2 id='pretty_num'>Prettify big numbers into a readable format</h2><span id='topic+pretty_num'></span>

<h3>Description</h3>

<p>Uses <code>as.numeric()</code> to force a numeric value and then formats prettily
for easy presentation in console messages, reports, or dashboards.
</p>
<p>This rounds to 0 decimal places by default, and adds in comma separators.
</p>
<p>Expect that this will commonly be used for adding the pound symbol,
the percentage symbol, or to have a +/- prefixed based on the value.
</p>
<p>If applying over multiple or unpredictable values and you want to preserve
a non-numeric symbol such as &quot;x&quot; or &quot;c&quot; for data not available, use the
<code>ignore_na = TRUE</code> argument to return those values unaffected.
</p>
<p>If you want to customise what NA values are returned as, use the <code>alt_na</code>
argument.
</p>
<p>This function silences the warning around NAs being introduced by coercion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pretty_num(
  value,
  prefix = "",
  gbp = FALSE,
  suffix = "",
  dp = 0,
  ignore_na = FALSE,
  alt_na = FALSE,
  nsmall = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pretty_num_+3A_value">value</code></td>
<td>
<p>value to be prettified</p>
</td></tr>
<tr><td><code id="pretty_num_+3A_prefix">prefix</code></td>
<td>
<p>prefix for the value, if &quot;+/-&quot; then it will automatically
assign + or - based on the value</p>
</td></tr>
<tr><td><code id="pretty_num_+3A_gbp">gbp</code></td>
<td>
<p>whether to add the pound symbol or not, defaults to not</p>
</td></tr>
<tr><td><code id="pretty_num_+3A_suffix">suffix</code></td>
<td>
<p>suffix for the value, e.g. &quot;%&quot;</p>
</td></tr>
<tr><td><code id="pretty_num_+3A_dp">dp</code></td>
<td>
<p>number of decimal places to round to, 0 by default.</p>
</td></tr>
<tr><td><code id="pretty_num_+3A_ignore_na">ignore_na</code></td>
<td>
<p>whether to skip function for strings that can't be
converted and return original value</p>
</td></tr>
<tr><td><code id="pretty_num_+3A_alt_na">alt_na</code></td>
<td>
<p>alternative value to return in place of NA, e.g. &quot;x&quot;</p>
</td></tr>
<tr><td><code id="pretty_num_+3A_nsmall">nsmall</code></td>
<td>
<p>minimum number of digits to the right of the decimal point.
If NULL, the value of <code>dp</code> will be used.
If the value of <code>dp</code> is less than 0, then <code>nsmall</code> will
automatically be set to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>string featuring prettified value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+comma_sep">comma_sep()</a></code> <code><a href="#topic+round_five_up">round_five_up()</a></code> <code><a href="base.html#topic+as.numeric">as.numeric()</a></code>
</p>
<p>Other prettying: 
<code><a href="#topic+pretty_filesize">pretty_filesize</a>()</code>,
<code><a href="#topic+pretty_num_table">pretty_num_table</a>()</code>,
<code><a href="#topic+pretty_time_taken">pretty_time_taken</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># On individual values
pretty_num(5789, gbp = TRUE)
pretty_num(564, prefix = "+/-")
pretty_num(567812343223, gbp = TRUE, prefix = "+/-")
pretty_num(11^9, gbp = TRUE, dp = 3)
pretty_num(-11^8, gbp = TRUE, dp = -1)
pretty_num(43.3, dp = 1, nsmall = 2)
pretty_num("56.089", suffix = "%")
pretty_num("x")
pretty_num("x", ignore_na = TRUE)
pretty_num("nope", alt_na = "x")

# Applied over an example vector
vector &lt;- c(3998098008, -123421421, "c", "x")
pretty_num(vector)
pretty_num(vector, prefix = "+/-", gbp = TRUE)

# Return original values if NA
pretty_num(vector, ignore_na = TRUE)

# Return alternative value in place of NA
pretty_num(vector, alt_na = "z")
</code></pre>

<hr>
<h2 id='pretty_num_table'>Format a data frame with <code>dfeR::pretty_num()</code>.</h2><span id='topic+pretty_num_table'></span>

<h3>Description</h3>

<p>You can format number and character values in a data frame
by passing arguments to <code>dfeR::pretty_num()</code>.
Use parameters <code>include_columns</code> or <code>exclude_columns</code>
to specify columns for formatting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pretty_num_table(data, include_columns = NULL, exclude_columns = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pretty_num_table_+3A_data">data</code></td>
<td>
<p>A data frame containing the columns to be formatted.</p>
</td></tr>
<tr><td><code id="pretty_num_table_+3A_include_columns">include_columns</code></td>
<td>
<p>A character vector specifying which columns to format.
If <code>NULL</code> (default), all columns will be considered for formatting.</p>
</td></tr>
<tr><td><code id="pretty_num_table_+3A_exclude_columns">exclude_columns</code></td>
<td>
<p>A character vector specifying columns to exclude
from formatting.
If <code>NULL</code> (default), no columns will be excluded.
If both <code>include_columns</code> and <code>exclude_columns</code> are provided
, <code>include_columns</code> takes precedence.</p>
</td></tr>
<tr><td><code id="pretty_num_table_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>dfeR::pretty_num()</code>
, such as <code>dp</code> (decimal places)
for controlling the number of decimal points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function first checks if any columns are specified for inclusion
via <code>include_columns</code>.
If none are provided, it checks if columns are specified for exclusion
via <code>exclude_columns</code>.
If neither is specified, all columns in the data frame are formatted.
</p>


<h3>Value</h3>

<p>A data frame with columns formatted using <code>dfeR::pretty_num()</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pretty_num">pretty_num()</a></code>
</p>
<p>Other prettying: 
<code><a href="#topic+pretty_filesize">pretty_filesize</a>()</code>,
<code><a href="#topic+pretty_num">pretty_num</a>()</code>,
<code><a href="#topic+pretty_time_taken">pretty_time_taken</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example data frame
df &lt;- data.frame(
  a = c(1.234, 5.678, 9.1011),
  b = c(10.1112, 20.1314, 30.1516),
  c = c("A", "B", "C")
)

# Apply formatting to all columns
pretty_num_table(df, dp = 2)

# Apply formatting to only selected columns
pretty_num_table(df, include_columns = c("a"), dp = 2)

# Apply formatting to all columns except specified ones
pretty_num_table(df, exclude_columns = c("b"), dp = 2)

# Apply formatting to all columns except specified ones and
# provide alternative value for NAs
pretty_num_table(df, alt_na = "[z]", exclude_columns = c("b"), dp = 2)

</code></pre>

<hr>
<h2 id='pretty_time_taken'>Calculate elapsed time between two points and present prettily</h2><span id='topic+pretty_time_taken'></span>

<h3>Description</h3>

<p>Converts a start and end value to a readable time format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pretty_time_taken(start_time, end_time)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pretty_time_taken_+3A_start_time">start_time</code></td>
<td>
<p>start time readable by as.POSIXct</p>
</td></tr>
<tr><td><code id="pretty_time_taken_+3A_end_time">end_time</code></td>
<td>
<p>end time readable by as.POSIXct</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Designed to be used with Sys.time() when tracking start and end times.
</p>
<p>Shows as seconds up until 119 seconds, then minutes until 119 minutes,
then hours for anything larger.
</p>
<p>Input start and end times must be convertible to POSIXct format.
</p>


<h3>Value</h3>

<p>string containing prettified elapsed time
</p>


<h3>See Also</h3>

<p><code><a href="#topic+comma_sep">comma_sep()</a></code> <code><a href="#topic+round_five_up">round_five_up()</a></code> <code><a href="base.html#topic+as.POSIXct">as.POSIXct()</a></code>
</p>
<p>Other prettying: 
<code><a href="#topic+pretty_filesize">pretty_filesize</a>()</code>,
<code><a href="#topic+pretty_num">pretty_num</a>()</code>,
<code><a href="#topic+pretty_num_table">pretty_num_table</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pretty_time_taken(
  "2024-03-23 07:05:53 GMT",
  "2024-03-23 12:09:56 GMT"
)

# Track the start and end time of a process
start &lt;- Sys.time()
Sys.sleep(0.1)
end &lt;- Sys.time()

# Use this function to present it prettily
pretty_time_taken(start, end)
</code></pre>

<hr>
<h2 id='regions'>Lookup for valid region names and codes</h2><span id='topic+regions'></span>

<h3>Description</h3>

<p>A lookup of ONS geography region names and codes for England. In their
lookups Northern Ireland, Scotland and Wales are regions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regions
</code></pre>


<h3>Format</h3>



<h4><code>regions</code></h4>

<p>A data frame with 16 rows and 2 columns:
</p>

<dl>
<dt>region_name</dt><dd><p>Region name</p>
</dd>
<dt>region_code</dt><dd><p>Region code</p>
</dd>
</dl>




<h3>Details</h3>

<p>Also included inner and outer London county split as DfE frequently publish
those as regions, as well as some custom DfE names and codes. This is used
as the definitive list for the screening of open data before it is published
by the DfE.
</p>


<h3>Source</h3>

<p>curated by explore.statistics@education.gov.uk, ONS codes sourced
from
https://geoportal.statistics.gov.uk/search?q=NAC_RGN
</p>

<hr>
<h2 id='round_five_up'>Round five up</h2><span id='topic+round_five_up'></span>

<h3>Description</h3>

<p>Round any number to a specified number of places, with 5's being rounded up.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>round_five_up(number, dp = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="round_five_up_+3A_number">number</code></td>
<td>
<p>number to be rounded</p>
</td></tr>
<tr><td><code id="round_five_up_+3A_dp">dp</code></td>
<td>
<p>number of decimal places to round to, default is 0</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rounds to 0 decimal places by default.
</p>
<p>You can use a negative value for the decimal places. For example:
-1 would round to the nearest 10
-2 would round to the nearest 100
and so on.
</p>
<p>This is as an alternative to round in base R, which uses a bankers round.
For more information see the
<a href="https://rdrr.io/r/base/Round.html">round() documentation</a>.
</p>


<h3>Value</h3>

<p>Rounded number
</p>


<h3>Examples</h3>

<pre><code class='language-R'># No dp set
round_five_up(2485.85)

# With dp set
round_five_up(2485.85, 2)
round_five_up(2485.85, 1)
round_five_up(2485.85, 0)
round_five_up(2485.85, -1)
round_five_up(2485.85, -2)
</code></pre>

<hr>
<h2 id='toggle_message'>Controllable console messages</h2><span id='topic+toggle_message'></span>

<h3>Description</h3>

<p>Quick expansion to the <code>message()</code> function aimed for use in functions for
an easy addition of a global verbose TRUE / FALSE argument to toggle the
messages on or off
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toggle_message(..., verbose)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="toggle_message_+3A_...">...</code></td>
<td>
<p>any message you would normally pass into <code>message()</code>. See
<code><a href="base.html#topic+message">message</a></code> for more details</p>
</td></tr>
<tr><td><code id="toggle_message_+3A_verbose">verbose</code></td>
<td>
<p>logical, usually a variable passed from the function you are
using this within</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Usually used in a function
my_function &lt;- function(count_fingers, verbose) {
  toggle_message("I have ", count_fingers, " fingers", verbose = verbose)
  fingers_thumbs &lt;- count_fingers + 2
  toggle_message("I have ", fingers_thumbs, " digits", verbose = verbose)
}

my_function(5, verbose = FALSE)
my_function(5, verbose = TRUE)

# Can be used in isolation
toggle_message("I want the world to read this!", verbose = TRUE)
toggle_message("I ain't gonna show this message!", verbose = FALSE)

count_fingers &lt;- 5
toggle_message("I have ", count_fingers, " fingers", verbose = TRUE)
</code></pre>

<hr>
<h2 id='wd_pcon_lad_la_rgn_ctry'>Ward to Constituency to LAD to LA to Region to Country lookup</h2><span id='topic+wd_pcon_lad_la_rgn_ctry'></span>

<h3>Description</h3>

<p>A lookup showing the hierarchy of ward to Westminster parliamentary
constituency to local authority district to local authority to region to
country for years 2017, 2019, 2020, 2021, 2022, 2023 and 2024.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wd_pcon_lad_la_rgn_ctry
</code></pre>


<h3>Format</h3>



<h4><code>wd_pcon_lad_la_rgn_ctry</code></h4>

<p>A data frame with 24,629 rows and 14 columns:
</p>

<dl>
<dt>first_available_year_included</dt><dd>
<p>First year in the lookups that we see this location
</p>
</dd>
<dt>most_recent_year_included</dt><dd>
<p>Last year in the lookups that we see this location
</p>
</dd>
<dt>ward_name</dt><dd><p>Ward name</p>
</dd>
<dt>pcon_name</dt><dd><p>Parliamentary constituency name</p>
</dd>
<dt>lad_name</dt><dd><p>Local authority district name</p>
</dd>
<dt>la_name</dt><dd><p>Local authority name</p>
</dd>
<dt>region_name</dt><dd><p>Region name</p>
</dd>
<dt>country_code</dt><dd><p>Country name</p>
</dd>
<dt>ward_code</dt><dd><p>9 digit ward code</p>
</dd>
<dt>pcon_code</dt><dd><p>9 digit westminster constituency code</p>
</dd>
<dt>lad_code</dt><dd><p>9 digit local authority district code</p>
</dd>
<dt>new_la_code</dt><dd><p>9 digit local authority code</p>
</dd>
<dt>region_code</dt><dd><p>9 digit region code</p>
</dd>
<dt>country_code</dt><dd><p>9 digit country code</p>
</dd>
</dl>




<h3>Details</h3>

<p>Changes we've made to the original lookup:
</p>

<ol>
<li><p> The original lookup from ONS uses the Upper Tier Local Authority, we then
update this so that where there is a metropolitan local authority we use the
local authority district as the local authority to match how
DfE publish data for local authorities.
</p>
</li>
<li><p> We have noticed that in the 2017 version, the Glasgow East constituency
had a code of S1400030 instead of the usual S14000030, we've assumed this
was an error and have change this in our data so that Glasgow East is
S14000030 in 2017.
</p>
</li>
<li><p> We have joined on regions using the Ward to LAD to County to Region file.
</p>
</li>
<li><p> We have joined on countries based on the E / N / S / W at the start of
codes.
</p>
</li>
<li><p> Scotland had no published regions in 2017, so given the rest of the years
have Scotland as the region, we've forced that in for 2017 too to complete
the data set.
</p>
</li></ol>



<h3>Source</h3>

<p>https://geoportal.statistics.gov.uk/search?tags=lup_wd_pcon_lad_utla
and https://geoportal.statistics.gov.uk/search?q=lup_wd_lad_cty_rgn_gor_ctry
</p>

<hr>
<h2 id='z_replace'>Replaces <code>NA</code> values in tables</h2><span id='topic+z_replace'></span>

<h3>Description</h3>

<p>Replaces <code>NA</code> values in tables except for ones in time and geography
columns that must be included in DfE official statistics.
<a href="https://www.shorturl.at/chy76">Guidance on our Open Data Standards.</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>z_replace(data, replacement_alt = NULL, exclude_columns = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="z_replace_+3A_data">data</code></td>
<td>
<p>name of the table that you want to replace NA values in</p>
</td></tr>
<tr><td><code id="z_replace_+3A_replacement_alt">replacement_alt</code></td>
<td>
<p>optional - if you want the NA replacement
value to be different to &quot;z&quot;</p>
</td></tr>
<tr><td><code id="z_replace_+3A_exclude_columns">exclude_columns</code></td>
<td>
<p>optional - additional columns to exclude from
NA replacement.
Column names that match ones found in <code>dfeR::geog_time_identifiers</code>
will always be excluded because any missing data for these columns
need more explicit codes to explain why data is not available.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Names of geography and time columns that are used in this function can be
found in <code>dfeR::geog_time_identifiers</code>.
</p>


<h3>Value</h3>

<p>table with &quot;z&quot; or an alternate replacement value instead of <code>NA</code>
values for columns that are not for time or geography.
</p>


<h3>See Also</h3>

<p><a href="#topic+geog_time_identifiers">geog_time_identifiers</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a table for the example

df &lt;- data.frame(
  time_period = c(2022, 2022, 2022),
  time_identifier = c("Calendar year", "Calendar year", "Calendar year"),
  geographic_level = c("National", "Regional", "Regional"),
  country_code = c("E92000001", "E92000001", "E92000001"),
  country_name = c("England", "England", "England"),
  region_code = c(NA, "E12000001", "E12000002"),
  region_name = c(NA, "North East", "North West"),
  mystery_count = c(42, 25, NA)
)

z_replace(df)

# Use a different replacement value
z_replace(df, replacement_alt = "c")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
