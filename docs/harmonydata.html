<!DOCTYPE html><html lang="en"><head><title>Help for package harmonydata</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {harmonydata}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#create_instrument_from_list'><p>Create instrument from list</p></a></li>
<li><a href='#generate_crosswalk_table'><p>Generate Crosswalk Table Function</p></a></li>
<li><a href='#get_example_instruments'><p>Retrieve Example Instruments from 'Harmony Data API'</p></a></li>
<li><a href='#load_instruments_from_file'><p>Load Instruments from File</p></a></li>
<li><a href='#match_instruments'><p>Match Instruments Function</p></a></li>
<li><a href='#set_url'><p>Set 'Harmony' URL</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>R Library for 'Harmony'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>'Harmony' is a tool using AI which allows you to compare items from questionnaires and identify similar content. You can try 'Harmony' at <a href="https://harmonydata.ac.uk/app/">https://harmonydata.ac.uk/app/</a> and you can read our blog at <a href="https://harmonydata.ac.uk/blog/">https://harmonydata.ac.uk/blog/</a> or at <a href="https://fastdatascience.com/how-does-harmony-work/">https://fastdatascience.com/how-does-harmony-work/</a>. Documentation at <a href="https://harmonydata.ac.uk/harmony-r-released/">https://harmonydata.ac.uk/harmony-r-released/</a>.</td>
</tr>
<tr>
<td>URL:</td>
<td>&lt;<a href="https://harmonydata.ac.uk&amp;gt;">https://harmonydata.ac.uk&gt;</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>httr, uuid, base64enc, jsonlite, utils, tools, assertthat,
purrr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-08 15:03:37 UTC; omarhassoun</td>
</tr>
<tr>
<td>Author:</td>
<td>Omar Hassoun [aut, cre],
  Thomas Wood [ctb],
  Alex, Nikic [ctb],
  Ulster University [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Omar Hassoun &lt;omtarful@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-08 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='create_instrument_from_list'>Create instrument from list</h2><span id='topic+create_instrument_from_list'></span>

<h3>Description</h3>

<p>This function creates an instrument from a list of questions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_instrument_from_list(
  question_texts,
  question_numbers = NULL,
  instrument_name = "My instrument"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_instrument_from_list_+3A_question_texts">question_texts</code></td>
<td>
<p>A character vector of question texts.</p>
</td></tr>
<tr><td><code id="create_instrument_from_list_+3A_question_numbers">question_numbers</code></td>
<td>
<p>A character vector of question numbers. If not provided, the question number will be the index of the question text.</p>
</td></tr>
<tr><td><code id="create_instrument_from_list_+3A_instrument_name">instrument_name</code></td>
<td>
<p>A character string of the instrument name.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alex Nikic
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
instrument = create_instrument_from_list(
  list("How old are you?",
    "What is your gender?",
    "What is your name?")
)




</code></pre>

<hr>
<h2 id='generate_crosswalk_table'>Generate Crosswalk Table Function</h2><span id='topic+generate_crosswalk_table'></span>

<h3>Description</h3>

<p>Generate a crosswalk table for a list of instruments, given the similarity matrix that came out of the match function.
A crosswalk is a list of pairs of variables from different studies that can be harmonised.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_crosswalk_table(
  instruments,
  similarity,
  threshold,
  is_allow_within_instrument_matches = FALSE,
  is_enforce_one_to_one = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_crosswalk_table_+3A_instruments">instruments</code></td>
<td>
<p>The original list of instruments, each containing a question. The sum of the number of questions in all instruments is the total number of questions which should equal both the width and height of the similarity matrix.</p>
</td></tr>
<tr><td><code id="generate_crosswalk_table_+3A_similarity">similarity</code></td>
<td>
<p>The cosine similarity matrix from Harmony</p>
</td></tr>
<tr><td><code id="generate_crosswalk_table_+3A_threshold">threshold</code></td>
<td>
<p>The minimum threshold that we consider a match. This is applied to the absolute match value. So if a question pair has similarity 0.2 and threshold = 0.5, then that question pair will be excluded. Leave as None if you don't want to apply any thresholding.</p>
</td></tr>
<tr><td><code id="generate_crosswalk_table_+3A_is_allow_within_instrument_matches">is_allow_within_instrument_matches</code></td>
<td>
<p>Defaults to False. If this is set to True, we include crosswalk items that originate from the same instrument, which would otherwise be excluded by default.</p>
</td></tr>
<tr><td><code id="generate_crosswalk_table_+3A_is_enforce_one_to_one">is_enforce_one_to_one</code></td>
<td>
<p>Defaults to False.  If this is set to True, we force all variables in the crosswalk table to be matched with exactly one other variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A crosswalk table as a DataFrame.
</p>


<h3>Author(s)</h3>

<p>Alex Nikic
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
instrument_A = create_instrument_from_list(list(
  "How old are you?",
  "What is your gender?"
))

instrument_B = create_instrument_from_list(list(
  "Do you smoke?"
))

instruments = list(instrument_A, instrument_B)

match_response = match_instruments(instruments)
instrument_list = match_response$instruments
similarity_matrix = match_response$matches

crosswalk_table.df = generate_crosswalk_table(
  instrument_list, similarity_matrix, threshold = 0.7,
  is_allow_within_instrument_matches = FALSE, is_enforce_one_to_one = TRUE
)



</code></pre>

<hr>
<h2 id='get_example_instruments'>Retrieve Example Instruments from 'Harmony Data API'</h2><span id='topic+get_example_instruments'></span>

<h3>Description</h3>

<p>This function retrieves example instruments from the 'Harmony Data API'
using an HTTP POST request.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_example_instruments()
</code></pre>


<h3>Value</h3>

<p>A list representing example instruments retrieved
from the 'Harmony Data API'.
</p>


<h3>Author(s)</h3>

<p>Ulster University [cph]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load required libraries (httr) and call the function
require(httr)
instruments &lt;- get_example_instruments()

# Print the retrieved JSON content
print(instruments)


</code></pre>

<hr>
<h2 id='load_instruments_from_file'>Load Instruments from File</h2><span id='topic+load_instruments_from_file'></span>

<h3>Description</h3>

<p>This function loads instruments from a file specified by the <code>path</code>
parameter and sends the file content to an API for further processing.
It also accepts a URL leading to a file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_instruments_from_file(path)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="load_instruments_from_file_+3A_path">path</code></td>
<td>
<p>The path to the file to load instruments from.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of instruments returned from the API.
</p>


<h3>Author(s)</h3>

<p>Ulster University [cph]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load instruments from a PDF file
pdf_file &lt;- "https://www.apa.org/depression-guideline/patient-health-questionnaire.pdf"
response &lt;- load_instruments_from_file(pdf_file)


</code></pre>

<hr>
<h2 id='match_instruments'>Match Instruments Function</h2><span id='topic+match_instruments'></span>

<h3>Description</h3>

<p>This function takes a list of instruments, converts it to a format acceptable by the database,
and matches the instruments using the 'Harmony Data API'. It returns the matched instruments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match_instruments(instruments, is_negate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="match_instruments_+3A_instruments">instruments</code></td>
<td>
<p>A list of instruments to be matched.</p>
</td></tr>
<tr><td><code id="match_instruments_+3A_is_negate">is_negate</code></td>
<td>
<p>A boolean value to toggle question negation. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of matched instruments returned from the 'Harmony Data API'.
</p>


<h3>Author(s)</h3>

<p>Ulster University [cph]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>



instrument_A &lt;- create_instrument_from_list(list(
  "How old are you?",
  "What is your gender?"
))

instrument_B &lt;- create_instrument_from_list(list(
  "Do you smoke?"
))

instruments &lt;- list(instrument_A, instrument_B)

matched_instruments &lt;- match_instruments(instruments)


</code></pre>

<hr>
<h2 id='set_url'>Set 'Harmony' URL</h2><span id='topic+set_url'></span>

<h3>Description</h3>

<p>This function sets the 'Harmony' API URL to be used in the package. By default,
it uses the production 'Harmony' API ('https://api.harmonydata.ac.uk'), but you can
override it by providing a different URL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_url(harmony_url = "https://api.harmonydata.ac.uk")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_url_+3A_harmony_url">harmony_url</code></td>
<td>
<p>The 'Harmony' API URL to be set. (default: 'https://api.harmonydata.ac.uk')</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>pkg.globals$url</code> variable is a global variable that holds the 'Harmony' API URL
to be used in the package. Once you set the URL using this function, it will be
used in all the relevant functions within the package.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Author(s)</h3>

<p>Ulster University [cph]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set_url('https://staging.harmonydata.org')
set_url() # Will set the URL back to the default 'https://api.harmonydata.ac.uk'


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
