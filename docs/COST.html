<!DOCTYPE html><html lang="en"><head><title>Help for package COST</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {COST}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Data.COST'><p>Data Generation</p></a></li>
<li><a href='#example.forecast'><p>example for one-step ahead forecast</p></a></li>
<li><a href='#example.prediction'><p>example for new location prediction</p></a></li>
<li><a href='#Forecasts.CF'><p>one-step ahead forecast by separate time series analysis</p></a></li>
<li><a href='#Forecasts.COST.G'><p>one-step ahead forecast by Gaussian copula</p></a></li>
<li><a href='#Forecasts.COST.t'><p>one-step ahead forecast by t copula</p></a></li>
<li><a href='#Forecasts.GP'><p>one-step ahead forecast by Gaussian process fitting</p></a></li>
<li><a href='#location'><p>Locations of 10 sites</p></a></li>
<li><a href='#logL.CF'><p>negtive log-likelihood for separate time series analysis</p></a></li>
<li><a href='#logL.COST.G'><p>negtive log-likelihood for Gaussian copula</p></a></li>
<li><a href='#logL.COST.t'><p>negtive log-likelihood for t copula</p></a></li>
<li><a href='#logL.GP'><p>negtive log-likelihood of Gaussian process</p></a></li>
<li><a href='#Predictions.COST.G'><p>new location prediction by Gaussian copula</p></a></li>
<li><a href='#Predictions.COST.t'><p>new location prediction by t copula</p></a></li>
<li><a href='#Predictions.GP'><p>new location prediction by Gaussian process method</p></a></li>
<li><a href='#rank.multivariate'><p>multivariate rank of a vector</p></a></li>
<li><a href='#Wind6month'><p>Wind speed data from 10 sites</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Copula-Based Semiparametric Models for Spatio-Temporal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Yanlin Tang, Huixia Judy Wang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yanlin Tang &lt;yanlintang2018@163.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Parameter estimation, one-step ahead forecast and new location
    prediction methods for spatio-temporal data.</td>
</tr>
<tr>
<td>Depends:</td>
<td>copula,mvtnorm</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-01-02 23:52:41 UTC; tangyanlin</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-01-04 11:00:24 UTC</td>
</tr>
</table>
<hr>
<h2 id='Data.COST'>Data Generation
</h2><span id='topic+Data.COST'></span>

<h3>Description</h3>

<p>Generating data from COST DGP, assuming Markov process of order one
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Data.COST(n,n.total,seed1,coord,par.t)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Data.COST_+3A_n">n</code></td>
<td>
<p>number of time points for parameter estimation
</p>
</td></tr>
<tr><td><code id="Data.COST_+3A_n.total">n.total</code></td>
<td>
<p>number of total time points, with a burning sequence</p>
</td></tr>
<tr><td><code id="Data.COST_+3A_seed1">seed1</code></td>
<td>
<p>random seed to generate a data set, for reproducibility</p>
</td></tr>
<tr><td><code id="Data.COST_+3A_coord">coord</code></td>
<td>
<p>coordinates of the locations</p>
</td></tr>
<tr><td><code id="Data.COST_+3A_par.t">par.t</code></td>
<td>
<p>the true copula parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Y.all</code></td>
<td>
<p>data from all locations and time points, may include data at time point n+1, or data from new locations</p>
</td></tr>
<tr><td><code>mean.true</code></td>
<td>
<p>true conditional mean of observed locations at time point n+1</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yanlin Tang, Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(COST)
n = 500
n.total = 1001
seed1 = 22222
coord = cbind(rep(c(1,3,5)/6,each=3),rep(c(1,3,5)/6,3))
par.t = c(0,1,1,0.5,1.5,100)
dat = Data.COST(n,n.total,seed1,coord,par.t)
#it returns a data set with dimension 501*9
</code></pre>

<hr>
<h2 id='example.forecast'>example for one-step ahead forecast
</h2><span id='topic+example.forecast'></span>

<h3>Description</h3>

<p>Example for one-step ahead forecast for Gaussian Process and our COST method with Gaussian and t copulas, where the data are generated from COST DGP, where the parameters are assumed to be known; the parameters can be obtained by the &ldquo;optim&quot; function. Assuming that data are observed at d=9 locations, and n+1 time points, where the last time point is for validation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example.forecast(n,n.total,seed1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="example.forecast_+3A_n">n</code></td>
<td>
<p>number of time points for parameter estimation</p>
</td></tr>
<tr><td><code id="example.forecast_+3A_n.total">n.total</code></td>
<td>
<p>number of total time points, with a burning sequence</p>
</td></tr>
<tr><td><code id="example.forecast_+3A_seed1">seed1</code></td>
<td>
<p>random seed to generate a data set, for reproducibility</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>COST.t.fore.ECP</code></td>
<td>
<p>a vector of length d, with value 1 or 0, 1 means the verifying value from the corresponding location lies in the 95% forecast interval, 0 means not</p>
</td></tr>
<tr><td><code>COST.t.fore.ML</code></td>
<td>
<p>a vector of length d, each element is the length of forecast interval of the corresponding location</p>
</td></tr>
<tr><td><code>COST.t.fore.rank</code></td>
<td>
<p>multivariate rank of the verifying vector by t copula</p>
</td></tr>
<tr><td><code>COST.G.fore.ECP</code></td>
<td>
<p>same as COST.t.fore.ECP</p>
</td></tr>
<tr><td><code>COST.G.fore.ML</code></td>
<td>
<p>same as COST.t.fore.ML</p>
</td></tr>
<tr><td><code>COST.G.fore.rank</code></td>
<td>
<p>multivariate rank of the verifying vector by Gaussian copula</p>
</td></tr>
<tr><td><code>GP.fore.ECP</code></td>
<td>
<p>same as COST.t.fore.ECP</p>
</td></tr>
<tr><td><code>GP.fore.ML</code></td>
<td>
<p>same as COST.t.fore.ML</p>
</td></tr>
<tr><td><code>GP.fore.rank</code></td>
<td>
<p>multivariate rank of the verifying vector by Gaussian process method</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(COST)
#settings
seed1 = 2222222
n.total = 101 #number of total time points, including the burning sequence
n = 50 #number of time points we observed
example.forecast(n,n.total,seed1)
#OUTPUTS

# $COST.t.fore.ECP #whether the forecast interval includes the true value at n+1
# [1] 1 1 1 1 1 1 1 1 1
#
# $COST.t.fore.ML #length of the forecast interval
# [1] 0.7036 4.1318 4.8749 2.7615 3.7398 5.8186 4.4532 4.9251 6.3757
#
# $COST.t.fore.rank #multivariate rank
# [1] 162
#
#
# $COST.G.fore.ECP #whether the forecast interval includes the true value at n+1
# [1] 1 1 1 1 1 1 1 1 1
#
# $COST.G.fore.ML #length of the forecast interval
# [1]  0.7035 4.1316 4.8656 2.7611 3.7388 5.7913 4.4458 4.9036 6.3727
#
# $COST.G.fore.rank #multivariate rank
# [1] 186
#

# $GP.fore.ECP #whether the forecast interval includes the true value at n+1
# [1] 1 0 0 1 1 1 1 1 1
#
# $GP.fore.ML #length of the forecast interval
# [1] 0.4879 2.0449 3.4436 2.2107 2.9170 4.4537 4.2169 5.5789 7.3689
#
# $GP.fore.rank #multivariate rank
# [1] 17
</code></pre>

<hr>
<h2 id='example.prediction'>example for new location prediction
</h2><span id='topic+example.prediction'></span>

<h3>Description</h3>

<p>Example for new location prediction, Gaussian process method, and our COST method with Gaussian and t copulas, where the parameters are assumed to be known; the parameters can be obtained by the &ldquo;optim&quot; function. Data are generated at 13 locations and n time points, and assume that 9 locations are observed, and 4 new locations need prediction at time n, conditional on 9 locations at time points n-1 and n.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example.prediction(n,n.total,seed1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="example.prediction_+3A_n">n</code></td>
<td>
<p>number of time points for parameter estimation
</p>
</td></tr>
<tr><td><code id="example.prediction_+3A_n.total">n.total</code></td>
<td>
<p>number of total time points, with a burning sequence</p>
</td></tr>
<tr><td><code id="example.prediction_+3A_seed1">seed1</code></td>
<td>
<p>random seed to generate a data set, for reproducibility</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>COST.t.pre.ECP</code></td>
<td>
<p>a vector of length K=4 (number of new locations), with value 1 or 0, 1 means the verifying value from the corresponding location lies in the 95% prediction interval, 0 means not</p>
</td></tr>
<tr><td><code>COST.t.pre.ML</code></td>
<td>
<p>a vector of length K=4, each element is the length of prediction interval of the corresponding location</p>
</td></tr>
<tr><td><code>COST.t.pre.med.error</code></td>
<td>
<p>prediction error based on conditional median</p>
</td></tr>
<tr><td><code>COST.G.pre.ECP</code></td>
<td>
<p>same as COST.t.pre.ECP</p>
</td></tr>
<tr><td><code>COST.G.pre.ML</code></td>
<td>
<p>same as COST.t.pre.ML</p>
</td></tr>
<tr><td><code>COST.G.pre.med.error</code></td>
<td>
<p>same as COST.t.pre.med.error</p>
</td></tr>
<tr><td><code>GP.pre.ECP</code></td>
<td>
<p>same as COST.t.pre.ECP</p>
</td></tr>
<tr><td><code>GP.pre.ML</code></td>
<td>
<p>same as COST.t.pre.ML</p>
</td></tr>
<tr><td><code>GP.pre.med.error</code></td>
<td>
<p>same as COST.t.pre.med.error</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(COST)
#settings
n.total = 101 #number of total time points, including the burning sequence
n = 50 #number of time points we observed
seed1 = 22222
example.prediction(n,n.total,seed1)

#OUTPUTS

# $COST.t.pre.ECP #whether the prediction interval includes the true value, time point n
# [1] 1 1 1 1
#
# $COST.t.pre.ML #length of the prediction interval
# [1] 1.445576 2.146452 2.260688 2.706681
#
# $COST.t.pre.med.error #point prediction error, using conditional median
# [1]  0.01127162 -0.03222058 -0.22081051  0.57831480
#
# $COST.G.pre.ECP #whether the prediction interval includes the true value, time point n
# [1] 1 1 1 1
#
# $COST.G.pre.ML #length of the prediction interval
# [1] 1.445576 2.432646 2.260688 2.914887
#
# $COST.G.pre.med.error #point prediction error, using conditional median
# [1] 0.01127162 -0.03222058 -0.22081051  0.57831480
#
# $GP.pre.ECP #whether the prediction interval includes the true value, time point n
# [1] 1 1 1 1
#
# $GP.pre.ML #length of the prediction interval
# [1] 0.8345359 1.4096642 1.5948724 2.3419428
#
# $GP.pre.med.error #point prediction error, using conditional median
# [1] 0.09447685 -0.05889409 -0.08923935  0.58494684
</code></pre>

<hr>
<h2 id='Forecasts.CF'>one-step ahead forecast by separate time series analysis
</h2><span id='topic+Forecasts.CF'></span>

<h3>Description</h3>

<p>one-step ahead forecast, analyzing the time series at each location separately with a t copula, including: (i) point forecast, either conditional median or mean; (ii) 95% forecast intervals, which can also be adjusted by the users; (iii) m (m=500 by default) random draws from the conditional distribution for each location, can be used for multivariate rank after combining all the locations together
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Forecasts.CF(par,Y,seed1,m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Forecasts.CF_+3A_par">par</code></td>
<td>
<p>parameters in the copula function
</p>
</td></tr>
<tr><td><code id="Forecasts.CF_+3A_y">Y</code></td>
<td>
<p>observed data</p>
</td></tr>
<tr><td><code id="Forecasts.CF_+3A_seed1">seed1</code></td>
<td>
<p>random seed used to generate random draws from the conditional distribution, for reproducibility</p>
</td></tr>
<tr><td><code id="Forecasts.CF_+3A_m">m</code></td>
<td>
<p>number of random draws to approximate the conditional distribution</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>y.qq</code></td>
<td>
<p>0.025-, 0.975- and 0.5-th conditional quantiles of the conditional distribution for each location</p>
</td></tr>
<tr><td><code>mean.est</code></td>
<td>
<p>conditional mean estimate for each location</p>
</td></tr>
<tr><td><code>y.draw.random</code></td>
<td>
<p>m random draws from the conditional distribution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='Forecasts.COST.G'>one-step ahead forecast by Gaussian copula
</h2><span id='topic+Forecasts.COST.G'></span>

<h3>Description</h3>

<p>one-step ahead forecast by Gaussian copula, including: (i) point forecast, either conditional median or mean; (ii) 95% forecast intervals, which can also be adjusted by the users; (iii) m (m=500 by default) random draws from the conditional distribution, can be used for multivariate rank
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Forecasts.COST.G(par,Y,s.ob,seed1,m,isotropic)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Forecasts.COST.G_+3A_par">par</code></td>
<td>
<p>parameters in the copula function
</p>
</td></tr>
<tr><td><code id="Forecasts.COST.G_+3A_y">Y</code></td>
<td>
<p>observed data</p>
</td></tr>
<tr><td><code id="Forecasts.COST.G_+3A_s.ob">s.ob</code></td>
<td>
<p>coordinates of observed locations</p>
</td></tr>
<tr><td><code id="Forecasts.COST.G_+3A_seed1">seed1</code></td>
<td>
<p>random seed used to generate random draws from the conditional distribution, for reproducibility</p>
</td></tr>
<tr><td><code id="Forecasts.COST.G_+3A_m">m</code></td>
<td>
<p>number of random draws to approximate the conditional distribution</p>
</td></tr>
<tr><td><code id="Forecasts.COST.G_+3A_isotropic">isotropic</code></td>
<td>
<p>indicator, True for isotropic correlation matrix, False for anisotropic correlation matrix, and we usually choose False for flexibility</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>y.qq</code></td>
<td>
<p>0.025-, 0.975- and 0.5-th conditional quantiles of the conditional distribution for each location</p>
</td></tr>
<tr><td><code>mean.est</code></td>
<td>
<p>conditional mean estimate for each location</p>
</td></tr>
<tr><td><code>y.draw.random</code></td>
<td>
<p>m random draws from the conditional distribution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='Forecasts.COST.t'>one-step ahead forecast by t copula
</h2><span id='topic+Forecasts.COST.t'></span>

<h3>Description</h3>

<p>one-step ahead forecast by t copula, including: (i) point forecast, either conditional median or mean; (ii) 95% forecast intervals, which can also be adjusted by the users; (iii) m (m=500 by default) random draws from the conditional distribution, can be used for multivariate rank
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Forecasts.COST.t(par,Y,s.ob,seed1,m,isotropic)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Forecasts.COST.t_+3A_par">par</code></td>
<td>
<p>parameters in the copula function
</p>
</td></tr>
<tr><td><code id="Forecasts.COST.t_+3A_y">Y</code></td>
<td>
<p>observed data</p>
</td></tr>
<tr><td><code id="Forecasts.COST.t_+3A_s.ob">s.ob</code></td>
<td>
<p>coordinates of observed locations</p>
</td></tr>
<tr><td><code id="Forecasts.COST.t_+3A_seed1">seed1</code></td>
<td>
<p>random seed used to generate random draws from the conditional distribution, for reproducibility</p>
</td></tr>
<tr><td><code id="Forecasts.COST.t_+3A_m">m</code></td>
<td>
<p>number of random draws to approximate the conditional distribution</p>
</td></tr>
<tr><td><code id="Forecasts.COST.t_+3A_isotropic">isotropic</code></td>
<td>
<p>indicator, True for isotropic correlation matrix, False for anisotropic correlation matrix, and we usually choose False for flexibility</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>y.qq</code></td>
<td>
<p>0.025-, 0.975- and 0.5-th conditional quantiles of the conditional distribution for each location</p>
</td></tr>
<tr><td><code>mean.est</code></td>
<td>
<p>conditional mean estimate for each location</p>
</td></tr>
<tr><td><code>y.draw.random</code></td>
<td>
<p>m random draws from the conditional distribution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='Forecasts.GP'>one-step ahead forecast by Gaussian process fitting
</h2><span id='topic+Forecasts.GP'></span>

<h3>Description</h3>

<p>one-step ahead forecast by Gaussian process fitting, including: (i) point forecast, either conditional mean; (ii) 95% forecast intervals, which can also be adjusted by the users; (iii) m (m=500 by default) random draws from the conditional distribution, can be used for multivariate rank
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Forecasts.GP(par,Y,s.ob,seed1,m,isotropic)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Forecasts.GP_+3A_par">par</code></td>
<td>
<p>parameters in the copula function
</p>
</td></tr>
<tr><td><code id="Forecasts.GP_+3A_y">Y</code></td>
<td>
<p>observed data</p>
</td></tr>
<tr><td><code id="Forecasts.GP_+3A_s.ob">s.ob</code></td>
<td>
<p>coordinates of observed locations</p>
</td></tr>
<tr><td><code id="Forecasts.GP_+3A_seed1">seed1</code></td>
<td>
<p>random seed used to generate random draws from the conditional distribution, for reproducibility</p>
</td></tr>
<tr><td><code id="Forecasts.GP_+3A_m">m</code></td>
<td>
<p>number of random draws to approximate the conditional distribution</p>
</td></tr>
<tr><td><code id="Forecasts.GP_+3A_isotropic">isotropic</code></td>
<td>
<p>indicator, True for isotropic correlation matrix, False for anisotropic correlation matrix, and we usually choose False for flexibility</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>y.qq</code></td>
<td>
<p>0.025-, 0.975- and 0.5-th conditional quantiles of the conditional distribution for each location</p>
</td></tr>
<tr><td><code>mean.est</code></td>
<td>
<p>conditional mean estimate for each location</p>
</td></tr>
<tr><td><code>y.draw.random</code></td>
<td>
<p>m random draws from the conditional distribution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='location'>Locations of 10 sites
</h2><span id='topic+location'></span>

<h3>Description</h3>

<p>Locations of 10 sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(location)
</code></pre>


<h3>Format</h3>

<p>Locations of 10 sites, 10*2 matrix in Cartesian coordinate system
</p>


<h3>Source</h3>

<p><a href="https://transmission.bpa.gov/business/operations/wind/MetData/default.aspx">https://transmission.bpa.gov/business/operations/wind/MetData/default.aspx</a>
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>s.ob = location[-3,2:3]
s.new = location[3,2:3]
</code></pre>

<hr>
<h2 id='logL.CF'>negtive log-likelihood for separate time series analysis
</h2><span id='topic+logL.CF'></span>

<h3>Description</h3>

<p>negtive log-likelihood for separate time series analysis, copula-based semiparametric method from Chen and Fan (2006), assuming t copula for each time series and Markov process of order one, with marginal distribution estimated by espirical CDF, and it is for correlation parameter estimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logL.CF(par,Yk,dfs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logL.CF_+3A_par">par</code></td>
<td>
<p>correlation parameter in the t copula function, will be obtained by minimizing the negtive log-likelihood
</p>
</td></tr>
<tr><td><code id="logL.CF_+3A_yk">Yk</code></td>
<td>
<p>observed data from k-th location</p>
</td></tr>
<tr><td><code id="logL.CF_+3A_dfs">dfs</code></td>
<td>
<p>degrees of freedom for the t copula, obtained from COST method with t copula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the negative log-likelihood
</p>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>1.Chen, X. and Fan, Y. (2006). Estimation of copula-based semiparametric time series models. Journal of Econometrics 130, 307–335.\
2.Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='logL.COST.G'>negtive log-likelihood for Gaussian copula
</h2><span id='topic+logL.COST.G'></span>

<h3>Description</h3>

<p>gives the negtive log-likelihood of the Gaussian copula, with empirical CDF plugin, and it is for parameter estimation in the correlation matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logL.COST.G(par,Y,s.ob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logL.COST.G_+3A_par">par</code></td>
<td>
<p>parameters in the copula function, will be obtained by minimizing the negtive log-likelihood
</p>
</td></tr>
<tr><td><code id="logL.COST.G_+3A_y">Y</code></td>
<td>
<p>the data set from observed locations, used for parameter estimation</p>
</td></tr>
<tr><td><code id="logL.COST.G_+3A_s.ob">s.ob</code></td>
<td>
<p>coordinates of observed locations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the negative log-likelihood
</p>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='logL.COST.t'>negtive log-likelihood for t copula
</h2><span id='topic+logL.COST.t'></span>

<h3>Description</h3>

<p>gives the negtive log-likelihood of the t copula, with empirical CDF plugin, and it is for parameter estimation in the correlation matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logL.COST.t(par,Y,s.ob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logL.COST.t_+3A_par">par</code></td>
<td>
<p>parameters in the copula function, will be obtained by minimizing the negtive log-likelihood
</p>
</td></tr>
<tr><td><code id="logL.COST.t_+3A_y">Y</code></td>
<td>
<p>the data set from observed locations, used for parameter estimation</p>
</td></tr>
<tr><td><code id="logL.COST.t_+3A_s.ob">s.ob</code></td>
<td>
<p>coordinates of observed locations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the negative log-likelihood
</p>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='logL.GP'>negtive log-likelihood of Gaussian process
</h2><span id='topic+logL.GP'></span>

<h3>Description</h3>

<p>negtive log-likelihood of Gaussian process, with mean vector and variance vector obtained by the empirical version, and it is for parameter estimation in the correlation matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logL.GP(par,Y,s.ob)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logL.GP_+3A_par">par</code></td>
<td>
<p>parameters in the copula function, will be obtained by minimizing the negtive log-likelihood
</p>
</td></tr>
<tr><td><code id="logL.GP_+3A_y">Y</code></td>
<td>
<p>the data set from observed locations, used for parameter estimation</p>
</td></tr>
<tr><td><code id="logL.GP_+3A_s.ob">s.ob</code></td>
<td>
<p>coordinates of observed locations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the negative log-likelihood
</p>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='Predictions.COST.G'>new location prediction by Gaussian copula
</h2><span id='topic+Predictions.COST.G'></span>

<h3>Description</h3>

<p>new location prediction by Gaussian copula, where the copula dimension is extended, and the marginal CDF of the new location is estimated by neighboring information; it gives 0.025-, 0.975- and 0.5-th conditional quantiles of the conditional distribution for each new location, at time n, conditional on observed locations at time n-1 and n; both point and interval predictions are provided
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Predictions.COST.G(par,Y,s.ob,s.new,isotropic)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Predictions.COST.G_+3A_par">par</code></td>
<td>
<p>parameters in the copula function
</p>
</td></tr>
<tr><td><code id="Predictions.COST.G_+3A_y">Y</code></td>
<td>
<p>observed data</p>
</td></tr>
<tr><td><code id="Predictions.COST.G_+3A_s.ob">s.ob</code></td>
<td>
<p>coordinates of observed locations</p>
</td></tr>
<tr><td><code id="Predictions.COST.G_+3A_s.new">s.new</code></td>
<td>
<p>coordinates of new locations</p>
</td></tr>
<tr><td><code id="Predictions.COST.G_+3A_isotropic">isotropic</code></td>
<td>
<p>indicator, True for isotropic correlation matrix, False for anisotropic correlation matrix, and we usually choose False for flexibility</p>
</td></tr>
</table>


<h3>Value</h3>

<p>0.025-, 0.975- and 0.5-th conditional quantiles of the conditional distribution for each new location, at time n
</p>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='Predictions.COST.t'>new location prediction by t copula
</h2><span id='topic+Predictions.COST.t'></span>

<h3>Description</h3>

<p>new location prediction by t copula, where the copula dimension is extended, and the marginal CDF of the new location is estimated by neighboring information; it gives 0.025-, 0.975- and 0.5-th conditional quantiles of the conditional distribution for each new location, at time n, conditional on observed locations at time n-1 and n; both point and interval predictions are provided
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Predictions.COST.t(par,Y,s.ob,s.new,isotropic)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Predictions.COST.t_+3A_par">par</code></td>
<td>
<p>parameters in the copula function
</p>
</td></tr>
<tr><td><code id="Predictions.COST.t_+3A_y">Y</code></td>
<td>
<p>observed data</p>
</td></tr>
<tr><td><code id="Predictions.COST.t_+3A_s.ob">s.ob</code></td>
<td>
<p>coordinates of observed locations</p>
</td></tr>
<tr><td><code id="Predictions.COST.t_+3A_s.new">s.new</code></td>
<td>
<p>coordinates of new locations</p>
</td></tr>
<tr><td><code id="Predictions.COST.t_+3A_isotropic">isotropic</code></td>
<td>
<p>indicator, True for isotropic correlation matrix, False for anisotropic correlation matrix, and we usually choose False for flexibility</p>
</td></tr>
</table>


<h3>Value</h3>

<p>0.025-, 0.975- and 0.5-th conditional quantiles of the conditional distribution for each new location, at time n
</p>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='Predictions.GP'>new location prediction by Gaussian process method
</h2><span id='topic+Predictions.GP'></span>

<h3>Description</h3>

<p>new location prediction by Gaussian process method, and the marginal mean and variance of the new location is estimated by neighboring information; it gives 0.025-, 0.975- and 0.5-th conditional quantiles of the conditional distribution for each new location, at time n, conditional on observed locations at time n-1 and n; both point and interval predictions are provided
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Predictions.GP(par,Y,s.ob,s.new,isotropic)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Predictions.GP_+3A_par">par</code></td>
<td>
<p>parameters in the copula function
</p>
</td></tr>
<tr><td><code id="Predictions.GP_+3A_y">Y</code></td>
<td>
<p>observed data</p>
</td></tr>
<tr><td><code id="Predictions.GP_+3A_s.ob">s.ob</code></td>
<td>
<p>coordinates of observed locations</p>
</td></tr>
<tr><td><code id="Predictions.GP_+3A_s.new">s.new</code></td>
<td>
<p>coordinates of new locations</p>
</td></tr>
<tr><td><code id="Predictions.GP_+3A_isotropic">isotropic</code></td>
<td>
<p>indicator, True for isotropic correlation matrix, False for anisotropic correlation matrix, and we usually choose False for flexibility</p>
</td></tr>
</table>


<h3>Value</h3>

<p>0.025-, 0.975- and 0.5-th conditional quantiles of the conditional distribution for each new location, at time n
</p>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='rank.multivariate'>multivariate rank of a vector
</h2><span id='topic+rank.multivariate'></span>

<h3>Description</h3>

<p>calculating the multivariate rank of a vector among a set of vectors, used to evaluate the performance of conditional distribution, and the rank would be uniform when the conditional distribution is estimated well
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank.multivariate(y.test,y.random,seed1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rank.multivariate_+3A_y.test">y.test</code></td>
<td>
<p>the observed (verifying) vector at time n+1
</p>
</td></tr>
<tr><td><code id="rank.multivariate_+3A_y.random">y.random</code></td>
<td>
<p>m random draws from the conditional distribution</p>
</td></tr>
<tr><td><code id="rank.multivariate_+3A_seed1">seed1</code></td>
<td>
<p>random seed to solve tie at random</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the multivariate rank of the observed (verifying) vector at time n+1
</p>


<h3>Author(s)</h3>

<p>Yanlin Tang and Huixia Judy Wang
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>

<hr>
<h2 id='Wind6month'>Wind speed data from 10 sites
</h2><span id='topic+Wind6month'></span>

<h3>Description</h3>

<p>The data set is a subset of the data we used in the paper, with 10 sites and 6-month long time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Wind6month)
</code></pre>


<h3>Format</h3>

<p>A 4320*10 matrix from 10 locations, date ranges from Sep 22, 2014 to Dec 20, 2014, 180 days
</p>

<dl>
<dt><code>BiddleButte</code></dt><dd><p>wind speed from site BiddleButte</p>
</dd>
<dt><code>ForestGrove</code></dt><dd><p>wind speed from site ForestGrove</p>
</dd>
<dt><code>HoodRiver</code></dt><dd><p>wind speed from site HoodRiver</p>
</dd>
<dt><code>HorseHeaven</code></dt><dd><p>wind speed from site HorseHeaven</p>
</dd>
<dt><code>Megler</code></dt><dd><p>wind speed from site Megler</p>
</dd>
<dt><code>NaselleRidge</code></dt><dd><p>wind speed from site NaselleRidge</p>
</dd>
<dt><code>Roosevelt</code></dt><dd><p>wind speed from site Roosevelt</p>
</dd>
<dt><code>Shaniko</code></dt><dd><p>wind speed from site Shaniko</p>
</dd>
<dt><code>Sunnyside</code></dt><dd><p>wind speed from site Sunnyside</p>
</dd>
<dt><code>Tillamook</code></dt><dd><p>wind speed from site Tillamook</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://transmission.bpa.gov/business/operations/wind/MetData/default.aspx">https://transmission.bpa.gov/business/operations/wind/MetData/default.aspx</a>
</p>


<h3>References</h3>

<p>Yanlin Tang, Huixia Judy Wang, Ying Sun, Amanda Hering. Copula-based semiparametric models for spatio-temporal data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Wind6month)
Y.ob = Wind6month[,-3]
Y.newloc = Wind6month[,3]
dim(Y.ob) #4320*9, data at 9 locations, with length 4320 (hours)
length(Y.newloc) #4320, time series at the new location
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
