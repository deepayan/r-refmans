<!DOCTYPE html><html><head><title>Help for package mtsdi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mtsdi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#edaprep'><p>Dataset Preparation for Analysis</p></a></li>
<li><a href='#elapsedtime'><p>Elapsed Time</p></a></li>
<li><a href='#getmean'><p>Row Means Estimates</p></a></li>
<li><a href='#Internal'><p>Internal function</p></a></li>
<li><a href='#miss'><p>Sample Dataset</p></a></li>
<li><a href='#mkjnw'><p>Example from Johnson \&amp; Wichern's Book</p></a></li>
<li><a href='#mnimput'><p>Multivariate Normal Imputation</p></a></li>
<li><a href='#mstats'><p>Missing Dataset Statistics</p></a></li>
<li><a href='#plot.mtsdi'><p>Plot the Imputed Matrix</p></a></li>
<li><a href='#predict.mtsdi'><p>Imputed Dataset Extraction</p></a></li>
<li><a href='#print.mtsdi'><p>Print Model Output</p></a></li>
<li><a href='#print.summary.mtsdi'><p>Print Summary</p></a></li>
<li><a href='#summary.mtsdi'><p>Summary Information</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.3.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-01-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Washington Junger &lt;wjunger@ims.uerj.br&gt; and Antonio Ponce de Leon &lt;ponce@ims.uerj.br&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Washington Junger &lt;wjunger@ims.uerj.br&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0),utils,stats,gam,splines</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Time Series Data Imputation</td>
</tr>
<tr>
<td>Description:</td>
<td>This is an EM algorithm based method for imputation of missing values in multivariate normal time series. The imputation algorithm accounts for both spatial and temporal correlation structures. Temporal patterns can be modeled using an ARIMA(p,d,q), optionally with seasonal components, a non-parametric cubic spline or generalized additive models with exogenous covariates. This algorithm is specially tailored for climate data with missing measurements from several monitors along a given region.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-01-23 20:02:24 UTC; wjunger</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-01-23 21:52:30 UTC</td>
</tr>
</table>
<hr>
<h2 id='edaprep'>Dataset Preparation for Analysis
</h2><span id='topic+edaprep'></span>

<h3>Description</h3>

<p>Prepare the dataset for exploratory data analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>edaprep(dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="edaprep_+3A_dataset">dataset</code></td>
<td>
<p>dataset with missing observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It replaces missing observation with the vector mean.
</p>


<h3>Value</h3>

<p>It returns <code>dataset</code> filled in with <code>NA</code>
</p>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mnimput">mnimput</a></code>, <code><a href="#topic+getmean">getmean</a></code>, <code><a href="#topic+edaprep">edaprep</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(miss)
c &lt;- edaprep(miss)
</code></pre>

<hr>
<h2 id='elapsedtime'>Elapsed Time</h2><span id='topic+elapsedtime'></span>

<h3>Description</h3>

<p>Compute the elapsed time between start time and end time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elapsedtime(st, et)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elapsedtime_+3A_st">st</code></td>
<td>
<p>starting time</p>
</td></tr>
<tr><td><code id="elapsedtime_+3A_et">et</code></td>
<td>
<p>ending time</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It returns the time the process took to run.
</p>


<h3>Value</h3>

<p>String of the form <code>hh:mm:ss</code>
</p>


<h3>Note</h3>

<p>It is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mnimput">mnimput</a></code></p>

<hr>
<h2 id='getmean'>Row Means Estimates
</h2><span id='topic+getmean'></span>

<h3>Description</h3>

<p>Estimate the row mean from a <code>mtsdi</code> object regarding a fixed number of imputed values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getmean(object, weighted=TRUE, mincol=1, maxconsec=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getmean_+3A_object">object</code></td>
<td>
<p>imputation object</p>
</td></tr>
<tr><td><code id="getmean_+3A_weighted">weighted</code></td>
<td>
<p>If <code>TRUE</code>, weights returned by <code><a href="#topic+mnimput">mnimput</a></code> will be used form mean computation</p>
</td></tr>
<tr><td><code id="getmean_+3A_mincol">mincol</code></td>
<td>
<p>integer for the minimun number of valid values by row</p>
</td></tr>
<tr><td><code id="getmean_+3A_maxconsec">maxconsec</code></td>
<td>
<p>integer for the maximum number of consecutive missing values in a column</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is useful just in case one wants row mean estimated. If log tranformation was used, mean is adjusted accordingly. 
</p>


<h3>Value</h3>

<p>A vector of of rows mean with length <code>n</code>, where <code>n</code> is the number of observations.
</p>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mnimput">mnimput</a></code>, <code><a href="#topic+getmean">getmean</a></code>, <code><a href="#topic+edaprep">edaprep</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(miss)
f &lt;- ~c31+c32+c33+c34+c35
i &lt;- mnimput(f,miss,eps=1e-3,ts=TRUE, method="spline",sp.control=list(df=c(7,7,7,7,7)))
m &lt;- getmean(i,2)
</code></pre>

<hr>
<h2 id='Internal'>Internal function
</h2><span id='topic+em.arima'></span><span id='topic+em.spline'></span><span id='topic+em.gam'></span><span id='topic+em.arrangemat'></span><span id='topic+em.arrangevec'></span><span id='topic+em.contribt1'></span><span id='topic+em.contribt2'></span><span id='topic+em.correctmat'></span><span id='topic+em.countmvec'></span><span id='topic+em.countmnear'></span><span id='topic+em.det'></span><span id='topic+em.dispersion'></span><span id='topic+em.existna'></span><span id='topic+em.extractcoord'></span><span id='topic+em.mean'></span><span id='topic+em.multiplyvec'></span><span id='topic+em.partmu'></span><span id='topic+em.partsigma'></span><span id='topic+em.putvalue'></span><span id='topic+em.rearrangemat'></span><span id='topic+em.rearrangevec'></span><span id='topic+em.replacewmean'></span><span id='topic+em.splitvec'></span><span id='topic+em.trace'></span><span id='topic+em.filter'></span><span id='topic+em.recursion'></span><span id='topic+em.nofilter'></span>

<h3>Description</h3>

<p>Internal functions called from within <code><a href="#topic+mnimput">mnimput</a></code>
</p>


<h3>Details</h3>

<p>These functions are not intendend for user-level call.
</p>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>

<hr>
<h2 id='miss'>Sample Dataset</h2><span id='topic+miss'></span>

<h3>Description</h3>

<p>A small sample dataset for the tutorial on data imputation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(miss)
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 observations on the following 5 variables.
</p>

<dl>
<dt><code>c31</code></dt><dd><p>a numeric vector with 1 missing observation</p>
</dd>
<dt><code>c32</code></dt><dd><p>a numeric vector with 1 missing observation</p>
</dd>
<dt><code>c33</code></dt><dd><p>a numeric vector with 6 missing observations</p>
</dd>
<dt><code>c34</code></dt><dd><p>a numeric vector with 3 missing observations</p>
</dd>
<dt><code>c35</code></dt><dd><p>a numeric vector with 3 missing observations</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(miss)
</code></pre>

<hr>
<h2 id='mkjnw'>Example from Johnson \&amp; Wichern's Book
</h2><span id='topic+mkjnw'></span>

<h3>Description</h3>

<p>Create a data matrix from the Johnson \&amp; Wichern's book
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkjnw()
</code></pre>


<h3>Details</h3>

<p>This function creates a data matrix from the Johnson &amp; Wichern's book.
</p>


<h3>Value</h3>

<p>It returns a data matrix.
</p>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Johnson, R., Wichern, D. (1998) <em>Applied Multivariate Statistical Analysis</em>. Prentice Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mnimput">mnimput</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>d &lt;- mkjnw()
</code></pre>

<hr>
<h2 id='mnimput'>Multivariate Normal Imputation
</h2><span id='topic+mnimput'></span>

<h3>Description</h3>

<p>Perform the modified EM algorithm imputation on a normal multivariate dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mnimput(formula, dataset, by = NULL, log = FALSE, log.offset = 1, 
		eps = 1e-3, maxit = 1e2, ts = TRUE, method = "spline", 
		sp.control = list(df = NULL, weights = NULL), ar.control = 
		list(order = NULL, period = NULL), ga.control = list(formula, 
		weights = NULL), f.eps = 1e-6, f.maxit = 1e3, ga.bf.eps = 1e-6, 
		ga.bf.maxit = 1e3, verbose = FALSE, digits = getOption("digits"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mnimput_+3A_formula">formula</code></td>
<td>
<p>formula indicating the missing data frame, for instance, <code>~X1+X2+X3+...+Xp</code></p>
</td></tr>
<tr><td><code id="mnimput_+3A_dataset">dataset</code></td>
<td>
<p>data with missing values to be imputated</p>
</td></tr>
<tr><td><code id="mnimput_+3A_by">by</code></td>
<td>
<p>factor for variance windows. Default is <code>NULL</code> for a single variance matrix</p>
</td></tr>
<tr><td><code id="mnimput_+3A_log">log</code></td>
<td>
<p>logical. If <code>TRUE</code> data will be transformed into <code>log</code> scale. Default is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="mnimput_+3A_log.offset">log.offset</code></td>
<td>
<p>If <code>log</code> is <code>TRUE</code>, log values will be shifted by this offset. Default is 1</p>
</td></tr>
<tr><td><code id="mnimput_+3A_eps">eps</code></td>
<td>
<p>stop criterion</p>
</td></tr>
<tr><td><code id="mnimput_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="mnimput_+3A_ts">ts</code></td>
<td>
<p>logical. <code>TRUE</code> if is time series</p>
</td></tr>
<tr><td><code id="mnimput_+3A_method">method</code></td>
<td>
<p>method for univariate time series filtering. It may be <code>smooth</code>, <code>gam</code> or <code>arima</code>. See Details</p>
</td></tr>
<tr><td><code id="mnimput_+3A_sp.control">sp.control</code></td>
<td>
<p>list for Spline smooth control. See Details</p>
</td></tr>
<tr><td><code id="mnimput_+3A_ar.control">ar.control</code></td>
<td>
<p>list for ARIMA fitting control. See Details</p>
</td></tr>
<tr><td><code id="mnimput_+3A_ga.control">ga.control</code></td>
<td>
<p>list for GAM fitting control. See Details</p>
</td></tr>
<tr><td><code id="mnimput_+3A_f.eps">f.eps</code></td>
<td>
<p>convergence criterion for the ARIMA filter. See <code><a href="stats.html#topic+arima">arima</a></code></p>
</td></tr>
<tr><td><code id="mnimput_+3A_f.maxit">f.maxit</code></td>
<td>
<p>maximum number of iterations for the ARIMA filter. See <code><a href="stats.html#topic+arima">arima</a></code></p>
</td></tr>
<tr><td><code id="mnimput_+3A_ga.bf.eps">ga.bf.eps</code></td>
<td>
<p>covergence criterion for the backfitting algorithm of GAM models. See <code><a href="mgcv.html#topic+gam">gam</a></code></p>
</td></tr>
<tr><td><code id="mnimput_+3A_ga.bf.maxit">ga.bf.maxit</code></td>
<td>
<p>maximum number of iterations for the backfitting algorithm of GAM models. See <code><a href="mgcv.html#topic+gam">gam</a></code></p>
</td></tr>
<tr><td><code id="mnimput_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code> convergence information on each iteration is printed. Default is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="mnimput_+3A_digits">digits</code></td>
<td>
<p>an integer indicating the decimal places. If not supplied, it is taken from <code><a href="base.html#topic+options">options</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a modified version of the EM algorithm for imputation of missing values. It is also applicable to time series data. When it is explicited the time series attribute through the argument <code>ts</code>, missing values are estimated accounting for both correlation between time series and time structure of the series itself.  Several filters can be used for prediction of the mean vector in the E-step.
</p>
<p>One can select the method for the univariate time series filtering by the argument <code>method</code>. The default method is <code>"spline"</code>. In this case a smooth spline is fitted to each of the time series at each iteration. Some parameters can be passed to <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> through <code>sm.control</code>. <code>df</code> is a vector as long as the number of columns in <code>dataset</code> holding fixed degrees of freedom of the splines. If <code>NULL</code>, the degrees of freedom of each spline are chosen by cross-validation. If <code>df</code> has length 1, this values is recycled for all the covariates. <code>weights</code> must be a matrix of the same size of <code>dataset</code> with the weights for <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code>. If <code>NULL</code>, all the observations will have weights equal to <code class="reqn">1</code>. 
</p>
<p>Other possibity for time series filtering is to fitting an ARIMA model for each of the time series by setting <code>method</code> to <code>"arima"</code>. The ARIMA models must be identified before using this function, nonetheless. <code><a href="stats.html#topic+arima">arima</a></code> function can be partially controlled through <code>ar.control</code>. Each column of <code>order</code> must hold the corresponding <code class="reqn">(p,d,q)</code> parameters for each univariate time series if <code>period</code> is <code>NULL</code>. If <code>period</code> is not <code>NULL</code>, <code>order</code> must also hold the multiplicative seasonality parameters, so each column of <code>order</code> takes the form <code class="reqn">(p,d,q,P,D,Q)</code>. <code>period</code> is the multiplicative seasonality period. <code>f.eps</code> and <code>f.maxit</code> control de convergence of the ARIMA fitting algorithm. Convergence problems due non stationarity may arise when using this option.
</p>
<p>Last but not least, a very interesting approach to modelling temporal patterns to use a full fledged regression model. It is possible to use generalised aditive (or linear) models with exogenous variates to proper filtering of time patterns. One must set method to <code>gam</code> and supply a vector of formulas in <code>ga.control</code>. One must supply one formula for each covariate. Using covariates that are part of the formula of the imputation model may yield some colinearity among the variates. See <code><a href="mgcv.html#topic+gam">gam</a></code> and <code><a href="stats.html#topic+glm">glm</a></code> for details. In order to use regression models for the level, set <code>method</code> to <code>"gam"</code>
</p>
<p>Simulations have shown that the algorithm is stable and yields good results on imputation of normal data.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>mtsdi</code> containing
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
<tr><td><code>dataset</code></td>
<td>
<p>imputed dataset</p>
</td></tr>
<tr><td><code>muhat</code></td>
<td>
<p>estimated mean vector</p>
</td></tr>
<tr><td><code>sigmahat</code></td>
<td>
<p>estimated covariance matrix</p>
</td></tr>
<tr><td><code>missings</code></td>
<td>
<p>vector holding the number of missing values on each row</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>number of iterations until convergence or reach <code>maxit</code></p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>convergence value. See Details</p>
</td></tr>
<tr><td><code>converged</code></td>
<td>
<p>a logical indicating if the algorithm converged</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>elapsed time of the process</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Junger, W.L. and Ponce de Leon, A. (2015) Imputation of Missing Data in Time Series for Air Pollutants. Atmospheric Environment, 102, 96-104.
</p>
<p>Johnson, R., Wichern, D. (1998) <em>Applied Multivariate Statistical Analysis</em>. Prentice Hall.
</p>
<p>Dempster, A., Laird, N., Rubin, D. (1977) Maximum Likelihood from Incomplete Data via the Algorithm EM. <em>Journal of the Royal Statistical Society</em> 39(B)), 1&ndash;38.
</p>
<p>McLachlan, G. J., Krishnan, T. (1997) <em>The EM algorithm and extensions</em>. John Wiley and Sons.
</p>
<p>Box, G., Jenkins, G., Reinsel, G. (1994) <em>Time Series Analysis: Forecasting and Control</em>. 3 ed. Prentice Hall.
</p>
<p>Hastie, T. J.; Tibshirani, R. J. (1990) <em>Generalized Additive Models</em>. Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mnimput">mnimput</a></code>, <code><a href="#topic+predict.mtsdi">predict.mtsdi</a></code>, <code><a href="#topic+edaprep">edaprep</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(miss)
f &lt;- ~c31+c32+c33+c34+c35
## one-window covariance
i &lt;- mnimput(f,miss,eps=1e-3,ts=TRUE, method="spline",sp.control=list(df=c(7,7,7,7,7)))
summary(i)

## two-window covariances
b&lt;-c(rep("year1",12),rep("year2",12))
ii &lt;- mnimput(f,miss,by=b,eps=1e-3,ts=TRUE, method="spline",sp.control=list(df=c(7,7,7,7,7)))
summary(ii)
</code></pre>

<hr>
<h2 id='mstats'>Missing Dataset Statistics
</h2><span id='topic+mstats'></span>

<h3>Description</h3>

<p>Carry out some statistics from the incomplete dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mstats(dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mstats_+3A_dataset">dataset</code></td>
<td>
<p>dataset with missing for description</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the proportion of missing observations in a given dataset by rows and columns.
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>rows</code></td>
<td>
<p>number of missing in each row</p>
</td></tr>
<tr><td><code>columns</code></td>
<td>
<p>number of missing in each column</p>
</td></tr>
<tr><td><code>pattern</code></td>
<td>
<p>the pattern of the missing values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mnimput">mnimput</a></code>, <code><a href="#topic+getmean">getmean</a></code>, <code><a href="#topic+edaprep">edaprep</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(miss)
mstats(miss)
</code></pre>

<hr>
<h2 id='plot.mtsdi'>Plot the Imputed Matrix</h2><span id='topic+plot.mtsdi'></span>

<h3>Description</h3>

<p>This function produces a plot with imputed values and the estimated level for each of the columns in the imputed matrix.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mtsdi'
plot(x, vars = "all", overlay = TRUE, level = TRUE, 
	points = FALSE, leg.loc = "topright", horiz = FALSE, at.once = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mtsdi_+3A_x">x</code></td>
<td>
<p>an object of the class <code>mtsdi</code></p>
</td></tr>
<tr><td><code id="plot.mtsdi_+3A_vars">vars</code></td>
<td>
<p>a vector with de variables to plot</p>
</td></tr>
<tr><td><code id="plot.mtsdi_+3A_overlay">overlay</code></td>
<td>
<p>logical. If <code>TRUE</code>, observed values are plot over the imputed ones</p>
</td></tr>
<tr><td><code id="plot.mtsdi_+3A_level">level</code></td>
<td>
<p>logical. If <code>TRUE</code>, the level is plot</p>
</td></tr>
<tr><td><code id="plot.mtsdi_+3A_points">points</code></td>
<td>
<p>logical. If <code>TRUE</code>, points on the observed and imputed values are plot</p>
</td></tr>
<tr><td><code id="plot.mtsdi_+3A_leg.loc">leg.loc</code></td>
<td>
<p>a list with <code>x</code> and <code>y</code> coordinates for the legend or a quoted string. Default is &quot;topright&quot;. See Details</p>
</td></tr>
<tr><td><code id="plot.mtsdi_+3A_horiz">horiz</code></td>
<td>
<p>logical. If <code>TRUE</code>, the legend will horizontal oriented</p>
</td></tr>
<tr><td><code id="plot.mtsdi_+3A_at.once">at.once</code></td>
<td>
<p>logical. If <code>TRUE</code>, all the variables are plot in separate windows at once</p>
</td></tr>
<tr><td><code id="plot.mtsdi_+3A_...">...</code></td>
<td>
<p>further options for function <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>leg.loc</code> option may also be specified by setting one of the following quoted strings <code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code>, or <code>"center"</code>. This places the legend on the inside of the plot frame at the given location with the orietation set by <code>horiz</code>. See <code><a href="graphics.html#topic+legend">legend</a></code> for further details.
</p>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mnimput">mnimput</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(miss)
f &lt;- ~c31+c32+c33+c34+c35
i &lt;- mnimput(f,miss,eps=1e-3,ts=TRUE, method="spline",sp.control=list(df=c(7,7,7,7,7)))
plot(i)
</code></pre>

<hr>
<h2 id='predict.mtsdi'>Imputed Dataset Extraction
</h2><span id='topic+predict.mtsdi'></span>

<h3>Description</h3>

<p>Extract imputed dataset from a <code>mtsdi</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mtsdi'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.mtsdi_+3A_object">object</code></td>
<td>
<p>imputation object</p>
</td></tr>
<tr><td><code id="predict.mtsdi_+3A_...">...</code></td>
<td>
<p>further options passed to the generic function <code><a href="stats.html#topic+predict">predict</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>If log tranformation was used, dataset is back transformed accordingly. 
</p>


<h3>Value</h3>

<p>A vector of of rows mean with lenght <code class="reqn">n</code>, where <code class="reqn">n</code> is the number of observations.
</p>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Junger, W.L. and Ponce de Leon, A. (2015) Imputation of Missing Data in Time Series for Air Pollutants. Atmospheric Environment, 102, 96-104.
</p>
<p>Johnson, R., Wichern, D. (1998) <em>Applied Multivariate Statistical Analysis</em>. Prentice Hall.
</p>
<p>Dempster, A., Laird, N., Rubin, D. (1977) Maximum Likelihood from Incomplete Data via the Algorithm EM. <em>Journal of the Royal Statistical Society</em> 39(B)), 1&ndash;38.
</p>
<p>McLachlan, G. J., Krishnan, T. (1997) <em>The EM algorithm and extensions</em>. John Wiley and Sons.
</p>
<p>Box, G., Jenkins, G., Reinsel, G. (1994) <em>Time Series Analysis: Forecasting and Control</em>. 3 ed. Prentice Hall.
</p>
<p>Hastie, T. J.; Tibshirani, R. J. (1990) <em>Generalized Additive Models</em>. Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mnimput">mnimput</a></code>, <code><a href="#topic+getmean">getmean</a></code>, <code><a href="#topic+edaprep">edaprep</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(miss)
f &lt;- ~c31+c32+c33+c34+c35
i &lt;- mnimput(f,miss,eps=1e-3,ts=TRUE, method="spline",sp.control=list(df=c(7,7,7,7,7)))
predict(i)
</code></pre>

<hr>
<h2 id='print.mtsdi'>Print Model Output</h2><span id='topic+print.mtsdi'></span>

<h3>Description</h3>

<p>Printing method for the imputation model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mtsdi'
print(x, digits = getOption("digits"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mtsdi_+3A_x">x</code></td>
<td>
<p>an object of class <code>summary.mtsdi</code></p>
</td></tr>
<tr><td><code id="print.mtsdi_+3A_digits">digits</code></td>
<td>
<p>an integer indicating the decimal places. If not supplied, it is taken from <code><a href="base.html#topic+options">options</a></code></p>
</td></tr>
<tr><td><code id="print.mtsdi_+3A_...">...</code></td>
<td>
<p>further options passed to <code><a href="base.html#topic+print">print</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function does not return a value.
</p>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mnimput">mnimput</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(miss)
f &lt;- ~c31+c32+c33+c34+c35
i &lt;- mnimput(f,miss,eps=1e-3,ts=TRUE, method="spline",sp.control=list(df=c(7,7,7,7,7)))
print(i)
</code></pre>

<hr>
<h2 id='print.summary.mtsdi'>Print Summary</h2><span id='topic+print.summary.mtsdi'></span>

<h3>Description</h3>

<p>Printing method for the summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.mtsdi'
print(x, digits = getOption("digits"),  print.models = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.mtsdi_+3A_x">x</code></td>
<td>
<p>an object of class <code>summary.mtsdi</code></p>
</td></tr>
<tr><td><code id="print.summary.mtsdi_+3A_print.models">print.models</code></td>
<td>
<p>a logical indicating that time filtering models should also be printed</p>
</td></tr>
<tr><td><code id="print.summary.mtsdi_+3A_digits">digits</code></td>
<td>
<p>an integer indicating the decimal places. If not supplied, it is taken from <code><a href="base.html#topic+options">options</a></code></p>
</td></tr>
<tr><td><code id="print.summary.mtsdi_+3A_...">...</code></td>
<td>
<p>further options passed from <code><a href="#topic+summary.mtsdi">summary.mtsdi</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function does not return a value.
</p>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mnimput">mnimput</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(miss)
f &lt;- ~c31+c32+c33+c34+c35
i &lt;- mnimput(f,miss,eps=1e-3,ts=TRUE, method="spline",sp.control=list(df=c(7,7,7,7,7)))
summary(i)
</code></pre>

<hr>
<h2 id='summary.mtsdi'>Summary Information</h2><span id='topic+summary.mtsdi'></span>

<h3>Description</h3>

<p>Print summary information on the imputation object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mtsdi'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mtsdi_+3A_object">object</code></td>
<td>
<p>an object of class <code>mtsdi</code></p>
</td></tr>
<tr><td><code id="summary.mtsdi_+3A_...">...</code></td>
<td>
<p>further options passed to <code><a href="#topic+print.summary.mtsdi">print.summary.mtsdi</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

   
<p>The function resturns a list containing
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>function call</p>
</td></tr>
<tr><td><code>muhat</code></td>
<td>
<p>estimated mean vector</p>
</td></tr>
<tr><td><code>sigmahat</code></td>
<td>
<p>estimated covariance matrix</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>number of iterations used</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>relative difference of covariance determinant reached</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>time used in the process</p>
</td></tr>
<tr><td><code>models</code></td>
<td>
<p>details on the models used for time filtering</p>
</td></tr>
<tr><td><code>log</code></td>
<td>
<p>a logical indicating that data are log transformed</p>
</td></tr>
<tr><td><code>log.offset</code></td>
<td>
<p>offset used in the log transformation in order to avoid zeros</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Washington Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Junger, W.L. and Ponce de Leon, A. (2015) Imputation of Missing Data in Time Series for Air Pollutants. Atmospheric Environment, 102, 96-104.
</p>
<p>Johnson, R., Wichern, D. (1998) <em>Applied Multivariate Statistical Analysis</em>. Prentice Hall.
</p>
<p>Dempster, A., Laird, N., Rubin, D. (1977) Maximum Likelihood from Incomplete Data via the Algorithm EM. <em>Journal of the Royal Statistical Society</em> 39(B)), 1&ndash;38.
</p>
<p>McLachlan, G. J., Krishnan, T. (1997) <em>The EM algorithm and extensions</em>. John Wiley and Sons.
</p>
<p>Box, G., Jenkins, G., Reinsel, G. (1994) <em>Time Series Analysis: Forecasting and Control</em>. 3 ed. Prentice Hall.
</p>
<p>Hastie, T. J.; Tibshirani, R. J. (1990) <em>Generalized Additive Models</em>. Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mnimput">mnimput</a></code>, <code><a href="stats.html#topic+predict">predict</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(miss)
f &lt;- ~c31+c32+c33+c34+c35
i &lt;- mnimput(f,miss,eps=1e-3,ts=TRUE, method="spline",sp.control=list(df=c(7,7,7,7,7)))
summary(i)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
