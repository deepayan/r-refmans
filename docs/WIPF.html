<!DOCTYPE html><html lang="en"><head><title>Help for package WIPF</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {WIPF}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#WIPF1'><p>Weighted Iterative Proportional Fitting (WIPF) in one dimension</p></a></li>
<li><a href='#WIPF2'><p>Weighted Iterative Proportional Fitting (WIPF) in two dimensions</p></a></li>
<li><a href='#WIPF3'><p>Weighted Iterative Proportional Fitting (WIPF) in three dimensions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Weighted Iterative Proportional Fitting</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0-1</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of the weighted iterative proportional fitting (WIPF) procedure for updating/adjusting a N-dimensional array (currently N&lt;=3) given a weight structure and some target marginals.
   Acknowledgements:
   The author wish to thank Ministerio de Ciencia, Innovación y Universidades (grant PID2021-128228NB-I00) and Fundación Mapfre (grant 'Modelización espacial e intra-anual de la mortalidad en España. Una herramienta automática para el cálculo de productos de vida') for supporting this research.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-07 14:22:04 UTC; pavia</td>
</tr>
<tr>
<td>Author:</td>
<td>Jose M. Pavía <a href="https://orcid.org/0000-0002-0129-726X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jose M. Pavía &lt;jose.m.pavia@uv.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-07 16:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='WIPF1'>Weighted Iterative Proportional Fitting (WIPF) in one dimension</h2><span id='topic+WIPF1'></span>

<h3>Description</h3>

<p>Implements WIPF in one dimension. This function updates, using a set of weights,
an initial 1-dimensional array, a vector (referred as the seed), to match a given value
(referred as the margin), in such as way that the weighted sum of the updated values coincide with the margin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WIPF1(
  seed,
  weights,
  margin = 1,
  normalize = TRUE,
  tol = 10^-6,
  maxit = 1000,
  full = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WIPF1_+3A_seed">seed</code></td>
<td>
<p>A vector of non-negative values with the initial values.</p>
</td></tr>
<tr><td><code id="WIPF1_+3A_weights">weights</code></td>
<td>
<p>A vector of non-negative values with the weights associated to each component of <code>seed</code>and with the same length as <code>seed</code>.</p>
</td></tr>
<tr><td><code id="WIPF1_+3A_margin">margin</code></td>
<td>
<p>A non-negative scalar with the (weighted) marginal total to be fitted. Default, <code>1</code>.</p>
</td></tr>
<tr><td><code id="WIPF1_+3A_normalize">normalize</code></td>
<td>
<p><code>TRUE</code>/<code>FALSE</code> argument indicating if weights should be normalized
to sum 1 before building the weighted sum to be compared with the margin value.
Default, <code>TRUE</code>. Normalization is necessary when we want to adjust a set of indexes
for which the margin correspond to other index that is a theoretical convex
combination of the inner indexes. This characterizes a typical context where WIPF could be of value.</p>
</td></tr>
<tr><td><code id="WIPF1_+3A_tol">tol</code></td>
<td>
<p>Stopping criterion. The algorithm stops when the maximum absolute difference between
the solutions obtained in two consecutive iteration is lower than the value specified by <code>tol</code>.
Default, <code>0.000001</code>.</p>
</td></tr>
<tr><td><code id="WIPF1_+3A_maxit">maxit</code></td>
<td>
<p>Stopping criterion. A positive integer number indicating the maximum number of iterations
allowed. Default, <code>1000</code>. The algorithm will stop if the values to be fitted still has not
converged after this many iterations.</p>
</td></tr>
<tr><td><code id="WIPF1_+3A_full">full</code></td>
<td>
<p><code>TRUE</code>/<code>FALSE</code> argument indicating if either only the solution should be shown or
a more complete output.</p>
</td></tr>
<tr><td><code id="WIPF1_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the function. Not currently used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>full = FALSE</code> an object similar to <code>seed</code> with the solution reached when the algorithm stops.
When <code>full = TRUE</code> a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>sol</code></td>
<td>
<p> An object similar to <code>seed</code> with the solution reached at convergence (or when the maximum number of iterations is reached).</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p> Number of iterations when the algorithm stops.</p>
</td></tr>
<tr><td><code>error.margins</code></td>
<td>
<p> An object similar to <code>margin</code> with the absolute differences between the values in <code>margin</code> and
the weighted sum(s) of the values in <code>sol</code>.</p>
</td></tr>
<tr><td><code>inputs</code></td>
<td>
<p> A list containing all the objects with the values used as arguments by the function.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Weighted Iterative proportional fitting is an extension of IPF.
WIPF produces the same solutions than IPF with all weights being ones
and when they are not normalized. IPF is also known as RAS in economics,
raking in survey research or matrix scaling in computer science.
</p>


<h3>Author(s)</h3>

<p>Jose M. Pavia, <a href="mailto:pavia@uv.es">pavia@uv.es</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>s &lt;- c(1.0595723, 0.9754876, 0.8589494, 0.8589123)
w &lt;- c(651301.9, 581185.1, 555610.8, 602595.6)
example &lt;- WIPF1(seed = s, weights = w)

</code></pre>

<hr>
<h2 id='WIPF2'>Weighted Iterative Proportional Fitting (WIPF) in two dimensions</h2><span id='topic+WIPF2'></span>

<h3>Description</h3>

<p>Implements WIPF in two dimensions. This function updates an initial
2-dimensional array (a matrix, referred to as the seed) using a matrix
of weights to align with a set of two vectors (referred to as the margins),
where one of them can be missing. When <code>margin1</code> and <code>margin2</code> are compatible
given the weights, the updated values ensure that the weighted sum
across columns matches <code>margin1</code> and the weighted sum across rows
matches <code>margin2</code>.
If the margins are incompatible given the weights, the function <code>WIPF1</code>
is applied to the initial margins to make the margins compatible
with the weights. In those cases, margins are updated (are made compatible)
in increasing order of sub-indices (i.e., <code>margin2</code> is adjusted
to be compatible with <code>margin1</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WIPF2(
  seed,
  weights,
  margin1,
  margin2,
  normalize = TRUE,
  tol = 10^-6,
  maxit = 1000,
  full = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WIPF2_+3A_seed">seed</code></td>
<td>
<p>A (RxC) matrix of non-negative values with the initial values.</p>
</td></tr>
<tr><td><code id="WIPF2_+3A_weights">weights</code></td>
<td>
<p>A (RxC) matrix of non-negative values with the weights associated to each entry of the matrix.</p>
</td></tr>
<tr><td><code id="WIPF2_+3A_margin1">margin1</code></td>
<td>
<p>A R-length vector of positive values with the target (weighted) marginal sums across columns to be fitted.</p>
</td></tr>
<tr><td><code id="WIPF2_+3A_margin2">margin2</code></td>
<td>
<p>A C-length vector of positive values with the target (weighted) marginal sums across rows to be fitted.</p>
</td></tr>
<tr><td><code id="WIPF2_+3A_normalize">normalize</code></td>
<td>
<p>Logical (<code>TRUE</code>/<code>FALSE</code>) argument indicating whether the weights should be normalized
(across all dimensions, for either row or column weights to sum 1)  before constructing
the weighted sums for comparison with the margin values. Default, <code>TRUE</code>. Normalization is essential when adjusting
a set of indexes where the margins represent theoretical convex combinations of the inner indexes.
This characterizes a typical context where WIPF could be of value.</p>
</td></tr>
<tr><td><code id="WIPF2_+3A_tol">tol</code></td>
<td>
<p>Stopping criterion. The algorithm stops when the maximum difference between the weighted sum(s) of
the values to be fitted and the margin(s) is lower than the value specified by <code>tol</code>.
Default, <code>0.000001</code>.</p>
</td></tr>
<tr><td><code id="WIPF2_+3A_maxit">maxit</code></td>
<td>
<p>Stopping criterion. A positive integer number indicating the maximum number of iterations
allowed. Default, <code>1000</code>. The algorithm will stop if the values to be fitted still has not
converged after this many iterations.</p>
</td></tr>
<tr><td><code id="WIPF2_+3A_full">full</code></td>
<td>
<p><code>TRUE</code>/<code>FALSE</code> argument indicating if either only the solution should be shown or
a more complete output.</p>
</td></tr>
<tr><td><code id="WIPF2_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the function. Not currently used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>full = FALSE</code> an object similar to <code>seed</code> with the solution reached when the algorithm stops.
When <code>full = TRUE</code> a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>sol</code></td>
<td>
<p> An object similar to <code>seed</code> with the solution reached at convergence (or when the maximum number of iterations is reached).</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p> Number of iterations when the algorithm stops.</p>
</td></tr>
<tr><td><code>dev.margins</code></td>
<td>
<p> A list with a set of objects similar to the margins with absolute maximum deviations
between the values in margins and the corresponding weighted sums of the values in <code>sol</code>.</p>
</td></tr>
<tr><td><code>margin1</code></td>
<td>
<p> A R-length vector of positive values with the actual margin1 object used to reach the solution.
This coincides with <code>margin1</code> when all the margins are compatible given the weights.</p>
</td></tr>
<tr><td><code>margin2</code></td>
<td>
<p> A C-length vector of positive values with the actual margin2 object used to reach the solution.
This coincides with <code>margin2</code> when all the margins are compatible given the weights.</p>
</td></tr>
<tr><td><code>inputs</code></td>
<td>
<p> A list containing all the objects with the values used as arguments by the function.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Weighted Iterative proportional fitting is an extension of IPF.
WIPF produces the same solutions than IPF with all weights being ones
and when they are not normalized. IPF is also known as RAS in economics,
raking in survey research or matrix scaling in computer science.
</p>


<h3>Author(s)</h3>

<p>Jose M. Pavia, <a href="mailto:pavia@uv.es">pavia@uv.es</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>s &lt;- structure(c(1.1279, 1.1304, 1.0304, 0.8554, 1.5606, 1.4171, 1.2862,
                 1.2472, 1.0746, 1.0796, 0.9806, 0.928, 1.1607, 1.2436, 1.2191,
                 1.0786, 1.0194, 1.1716, 0.9937, 0.8611, 1.0172, 1.2511, 1.1606,
                 1.1959), .Dim = c(4L, 6L))
w &lt;- structure(c(72161.97, 93725.94, 84408.83, 172774.13, 52875.08,
                 31936.92, 14191.44, 12595.46, 291698.94, 231408.32,
                 221763.43, 235217.74, 42028.56, 64458.09, 93443.13,
                 60348.74, 222482.04, 103695.94, 57066.82, 48657.48,
                 9572.75, 75745.02, 83912.38, 94019.92), .Dim = c(4L, 6L))
m1 &lt;- c(1.110737, 1.029947, 0.934799, 0.906475)
m2 &lt;- c(0.810992, 1.375921, 1.071519, 1.045006, 0.949938, 0.915762)
example &lt;- WIPF2(seed = s, weights = w, margin1 = m1, margin2 = m2, full = TRUE)

</code></pre>

<hr>
<h2 id='WIPF3'>Weighted Iterative Proportional Fitting (WIPF) in three dimensions</h2><span id='topic+WIPF3'></span>

<h3>Description</h3>

<p>Implements WIPF in three dimensions. This function updates an
initial 3D-array (referred to as the seed)
using a 3D-array of weights to align with a set of three vectors
(referred to as 1D-margins) and three matrices (referred to as 2D-margins),
where some of them can be missing.
When all provided margins are compatible given the weights, the updated
values ensure that the weighted sums across rows, columns, layers, and
combinations of (row, column), (row, layer), and (column, layer) coincide
with the provided margins.
If the provided margins are incompatible given the weights, the functions <code>WIPF1</code>
and <code>WIPF2</code> are applied to the initial margins to make the margins compatible with the weights.
In those cases, the margins are updated (are made compatible) in increasing order
of sub-indices and with the second sub-indices running faster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WIPF3(
  seed,
  weights,
  margin1,
  margin2,
  margin3,
  margin12,
  margin13,
  margin23,
  normalize = TRUE,
  tol = 10^-6,
  maxit = 1000,
  full = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WIPF3_+3A_seed">seed</code></td>
<td>
<p>A (RxCxL) array of non-negative values with the initial values.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_weights">weights</code></td>
<td>
<p>A (RxCxL) array of non-negative values with the weights associated to each entry of the <code>seed</code> array.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_margin1">margin1</code></td>
<td>
<p>A R-length vector of positive values with the target (weighted) marginal sum across both layers and columns to be fitted.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_margin2">margin2</code></td>
<td>
<p>A C-length vector of positive values with the target (weighted) marginal sum across both rows and layers to be fitted.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_margin3">margin3</code></td>
<td>
<p>A L-length vector of positive values with the target (weighted) marginal sum across both rows and columns to be fitted.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_margin12">margin12</code></td>
<td>
<p>A RxC matrix of positive values with the target (weighted) marginal sum across layers to be fitted.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_margin13">margin13</code></td>
<td>
<p>A RxL matrix of positive values with the target (weighted) marginal sum across columns to be fitted.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_margin23">margin23</code></td>
<td>
<p>A CxL matrix of positive values with the target (weighted) marginal sum across both rows to be fitted.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_normalize">normalize</code></td>
<td>
<p>Logical (<code>TRUE</code>/<code>FALSE</code>) argument indicating whether the weights should be normalized
across all dimensions (for either row, column, layer, row-column, row-layer or column-layer weights to sum 1)
before constructing the weighted sums for comparison with the margin values.
Default, <code>TRUE</code>. Normalization is essential when adjusting a set of indexes where the margins represent
theoretical convex combinations of the inner indexes.
This characterizes a typical context where WIPF could be of value.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_tol">tol</code></td>
<td>
<p>Stopping criterion. The algorithm stops when the maximum difference between the weighted sum(s) of
the values to be fitted and the margin(s) is lower than the value specified by <code>tol</code>.
Default, <code>0.000001</code>.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_maxit">maxit</code></td>
<td>
<p>Stopping criterion. A positive integer number indicating the maximum number of iterations
allowed. Default, <code>1000</code>. The algorithm will stop if the values to be fitted still has not
converged after this many iterations.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_full">full</code></td>
<td>
<p><code>TRUE</code>/<code>FALSE</code> argument indicating if either only the solution should be shown or
a more complete output.</p>
</td></tr>
<tr><td><code id="WIPF3_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the function. Not currently used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>full = FALSE</code> an object similar to <code>seed</code> with the solution reached when the algorithm stops.
When <code>full = TRUE</code> a list with the following components:
</p>
<table role = "presentation">
<tr><td><code>sol</code></td>
<td>
<p> An object similar to <code>seed</code> with the solution reached at convergence (or when the maximum number of iterations is reached).</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p> Number of iterations when the algorithm stops.</p>
</td></tr>
<tr><td><code>dev.margins</code></td>
<td>
<p> A list with a set of objects similar to the margins with absolute maximum deviations
between the values in margins and the corresponding weighted sums of the values in <code>sol</code>.</p>
</td></tr>
<tr><td><code>margin1</code></td>
<td>
<p> A R-length vector of positive values with the actual margin1 object used to reach the solution.
This coincides with <code>margin1</code> when all the margins are compatible given the weights.</p>
</td></tr>
<tr><td><code>margin2</code></td>
<td>
<p> A C-length vector of positive values with the actual margin2 object used to reach the solution.
This coincides with <code>margin2</code> when all the margins are compatible given the weights.</p>
</td></tr>
<tr><td><code>margin3</code></td>
<td>
<p> A L-length vector of positive values with the actual margin3 object used to reach the solution.
This coincides with <code>margin2</code> when all the margins are compatible given the weights.</p>
</td></tr>
<tr><td><code>margin12</code></td>
<td>
<p> A RxC matrix of positive values with the actual margin12 object used to reach the solution.
This coincides with <code>margin2</code> when all the margins are compatible given the weights.</p>
</td></tr>
<tr><td><code>margin13</code></td>
<td>
<p> A RxL matrix of positive values with the actual margin13 object used to reach the solution.
This coincides with <code>margin2</code> when all the margins are compatible given the weights.</p>
</td></tr>
<tr><td><code>margin23</code></td>
<td>
<p> A CxL matrix of positive values with the actual margin23 object used to reach the solution.
This coincides with <code>margin2</code> when all the margins are compatible given the weights.</p>
</td></tr>
<tr><td><code>inputs</code></td>
<td>
<p> A list containing all the objects with the values used as arguments by the function.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Weighted Iterative proportional fitting is an extension of IPF.
WIPF produces the same solutions than IPF with all weights being ones
and when they are not normalized. IPF is also known as RAS in economics,
raking in survey research or matrix scaling in computer science.
</p>


<h3>Author(s)</h3>

<p>Jose M. Pavia, <a href="mailto:pavia@uv.es">pavia@uv.es</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>s &lt;- structure(c(0.9297, 0.9446, 0.8763, 0.92, 0.8655, 0.8583, 0.8132,
                 0.8679, 0.7968, 0.7834, 0.721, 0.7859, 0.7747, 0.7851, 0.8632,
                 1.041, 1.5617, 1.5642, 1.4847, 1.5176, 1.4157, 1.3851, 1.3456,
                 1.4012, 1.3017, 1.2626, 1.1904, 1.2668, 1.3203, 1.3181, 1.1965,
                 1.1654, 1.2219, 1.3863, 1.306, 1.1963, 1.1376, 1.35, 1.2595,
                 1.1289, 1.0456, 1.2863, 1.1274, 1.0208, 1.0542, 1.1272, 1.1594,
                 1.1668, 1.1931, 1.1328, 1.1221, 1.1011, 1.1298, 1.0454, 1.0573,
                 1.0557, 1.0599, 0.973, 0.9545, 0.9721, 1.0489, 0.9934, 0.9382,
                 0.876, 1.339, 1.1939, 1.0229, 1.0378, 1.0402, 0.9554, 0.9794,
                 1.0089, 0.9422, 0.8584, 0.8563, 0.9013, 0.9252, 0.8706, 0.8354,
                 0.8071, 0.9737, 1.0008, 0.9593, 0.9257, 0.9556, 0.9534, 0.9313,
                 0.9151, 0.883, 0.8731, 0.8285, 0.8309, 0.9131, 0.9258, 0.8467,
                 0.7785), .Dim = c(4L, 4L, 6L))
w &lt;- structure(c(18520.3, 11776.3, 19479.5, 22497.6, 18968.7, 17263.7,
                 36494.7, 21707, 13406.3, 13570.4, 37746.1, 20593.2, 6595.6, 25444.6,
                 59868.2, 81777.2, 3380.4, 20610.7, 22247.3, 6800.9, 5236.3, 14877.8,
                 7205, 5028.4, 1130.7, 6603.2, 4007.4, 2620.5, 374.8, 1624.3,
                 4963.7, 9551.3, 31806, 93615.9, 121986.6, 44640.3, 32110.6, 95814.4,
                 72827.9, 30922.5, 43197.3, 72050.8, 66673.4, 40370.1, 31488.2,
                 55014.9, 69457.2, 80021.2, 17701.7, 8765.2, 11790.9, 3872.8,
                 30544.5, 12141.2, 12415.2, 9471.9, 36138.6, 19198.1, 23120.1,
                 15597.9, 12140.2, 8058.3, 20948.3, 19380.2, 78543.9, 86503.6,
                 28727.8, 29208.7, 26300.6, 42363, 20786.6, 14380.3, 9493.5, 17816.2,
                 19844.1, 10898.2, 1419, 4211.5, 20615, 22748.2, 3365.8, 2639.8,
                 2433.3, 930.5, 22119.6, 31022.7, 12748.5, 10161.4, 15450.2, 32747.1,
                 22596.4, 13228.1, 17289.2, 30189.2, 31476.6, 15338.7),
                .Dim = c(4L, 4L, 6L))
m1 &lt;- c(1.025527, 1.018229, 0.969744, 0.994998)
m2 &lt;- c(1.111023, 1.030213, 0.935041, 0.906709)
m3 &lt;- c(0.810568, 1.375203, 1.07096, 1.044461, 0.949441, 0.915284)
m12 &lt;- structure(c(1.061059, 1.120345, 1.097519, 1.188501, 1.017091,
                   0.967245, 1.03447, 1.18867, 0.9797, 0.900885, 0.85575, 1.070772,
                   1.041953, 1.074653, 0.887316, 0.791906), .Dim = c(4L, 4L))
m13 &lt;- structure(c(0.779029, 0.865343, 0.757887, 0.852708, 1.351367,
                   1.409585, 1.350907, 1.361528, 1.091867, 1.107661, 0.99364, 1.127478,
                   1.13439, 0.948428, 1.075919, 0.916096, 1.031958, 0.835103, 1.006321,
                   0.982888, 0.86109, 0.976673, 0.961731, 0.764211), .Dim = c(4L, 6L))
m23 &lt;- structure(c(0.962955, 0.880973, 0.798545, 0.714783, 1.547556,
                   1.277098, 1.149491, 1.210108, 1.186342, 1.084436, 0.976822, 1.003611,
                   1.092564, 1.066306, 1.038601, 0.996779, 0.971751, 1.016173, 0.867197,
                   0.803929, 0.831913, 0.933863, 0.857392, 0.960169), .Dim = c(4L, 6L))

example &lt;- WIPF3(seed = s, weights = w, margin3 = m3, margin12 = m12, margin13 = m13)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
