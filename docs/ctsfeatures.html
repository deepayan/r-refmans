<!DOCTYPE html><html lang="en"><head><title>Help for package ctsfeatures</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ctsfeatures}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#binarization'><p>Constructs the binarized time series associated with a given</p>
categorical time series</a></li>
<li><a href='#calculate_features'><p>Computes several features associated with a categorical time series</p></a></li>
<li><a href='#calculate_motifs'><p>Computes the relative frequency of motifs in a categorical time series</p></a></li>
<li><a href='#calculate_subfeatures'><p>Computes several subfeatures associated with a categorical time series</p></a></li>
<li><a href='#conditional_probabilities'><p>Computes the conditional probabilities of a categorical time series</p></a></li>
<li><a href='#GeneticSequences'><p>GeneticSequences</p></a></li>
<li><a href='#joint_probabilities'><p>Computes the joint probabilities of a categorical time series</p></a></li>
<li><a href='#marginal_probabilities'><p>Computes the marginal probabilities of a categorical time series</p></a></li>
<li><a href='#plot_ccc'><p>Constructs a control chart for the cycle lengths of a categorical series</p></a></li>
<li><a href='#plot_cohen'><p>Constructs a serial dependence plot based on Cohen's kappa</p></a></li>
<li><a href='#plot_cramer'><p>Constructs a serial dependence plot based on Cramer's vi</p></a></li>
<li><a href='#plot_cts'><p>Constructs a categorical time series plot</p></a></li>
<li><a href='#plot_ifsct'><p>Constructs the IFS circle transformation of a</p>
categorical time series</a></li>
<li><a href='#plot_mcc'><p>Constructs a control chart for the marginal distribution of a categorical</p>
series</a></li>
<li><a href='#plot_ph'><p>Constructs the pattern histogram associated with a given category of a</p>
categorical time series</a></li>
<li><a href='#plot_reg'><p>Constructs the rate evolution graph for a categorical time series</p></a></li>
<li><a href='#plot_se'><p>Represents the spectral envelope of a categorical time series</p></a></li>
<li><a href='#ProteinSequences'><p>ProteinSequences</p></a></li>
<li><a href='#SleepStages'><p>SleepStages</p></a></li>
<li><a href='#SyntheticData1'><p>SyntheticData1</p></a></li>
<li><a href='#SyntheticData2'><p>SyntheticData2</p></a></li>
<li><a href='#SyntheticData3'><p>SyntheticData3</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analyzing Categorical Time Series</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of several functions for feature extraction in 
    categorical time series datasets. Specifically, some features related to 
    marginal distributions and serial dependence patterns can be computed. These 
    features can be used to feed clustering and classification algorithms for
    categorical time series, among others. The package also includes some
    interesting datasets containing biological sequences. Practitioners from a 
    broad variety of fields could benefit from the general framework provided 
    by 'ctsfeatures'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, astsa, latex2exp, Rdpack, Bolstad2, tsibble</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-29 05:34:41 UTC; lopezoa</td>
</tr>
<tr>
<td>Author:</td>
<td>Angel Lopez-Oriona [aut, cre],
  Jose A. Vilar [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Angel Lopez-Oriona &lt;oriona38@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-29 13:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='binarization'>Constructs the binarized time series associated with a given
categorical time series</h2><span id='topic+binarization'></span>

<h3>Description</h3>

<p><code>binarization</code> constructs the binarized time series associated with a given
categorical time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binarization(series)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binarization_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a CTS of length <code class="reqn">T</code> with range <code class="reqn">\mathcal{V}=\{1, 2, \ldots, r\}</code>,
<code class="reqn">\overline{X}_t=\{\overline{X}_1,\ldots, \overline{X}_T\}</code>, the function
constructs the binarized time series, which is defined as
<code class="reqn">\overline{\boldsymbol Y}_t=\{\overline{\boldsymbol Y}_1, \ldots, \overline{\boldsymbol Y}_T\}</code>,
with <code class="reqn">\overline{\boldsymbol Y}_k=(\overline{Y}_{k,1}, \ldots, \overline{Y}_{k,r})^\top</code>
such that <code class="reqn">\overline{Y}_{k,i}=1</code> if <code class="reqn">\overline{X}_k=i</code> (<code class="reqn">k=1,\ldots,T,
, i=1,\ldots,r</code>). The binarized series is constructed in the form of a matrix
whose rows represent time observations and whose columns represent the
categories in the original series
</p>


<h3>Value</h3>

<p>The binarized time series.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>López-Oriona Á, Vilar JA, D’Urso P (2023).
&ldquo;Hard and soft clustering of categorical time series based on two novel distances with an application to biological sequences.&rdquo;
<em>Information Sciences</em>, <b>624</b>, 467&ndash;492.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
binarized_series &lt;- binarization(sequence_1) # Constructing the binarized
# time series for the first CTS in dataset GeneticSequences
</code></pre>

<hr>
<h2 id='calculate_features'>Computes several features associated with a categorical time series</h2><span id='topic+calculate_features'></span>

<h3>Description</h3>

<p><code>calculate_features</code> computes several features associated with a
categorical time series or between a categorical and a real-valued time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_features(series, n_series = NULL, lag = 1, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_features_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="calculate_features_+3A_n_series">n_series</code></td>
<td>
<p>A real-valued time series.</p>
</td></tr>
<tr><td><code id="calculate_features_+3A_lag">lag</code></td>
<td>
<p>The considered lag (default is 1).</p>
</td></tr>
<tr><td><code id="calculate_features_+3A_type">type</code></td>
<td>
<p>String indicating the feature one wishes to compute.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assume we have a CTS of length <code class="reqn">T</code> with range <code class="reqn">\mathcal{V}=\{1, 2, \ldots, r\}</code>,
<code class="reqn">\overline{X}_t=\{\overline{X}_1,\ldots, \overline{X}_T\}</code>, with <code class="reqn">\widehat{p}_i</code>
being the natural estimate of the marginal probability of the <code class="reqn">i</code>th
category, and <code class="reqn">\widehat{p}_{ij}(l)</code> being the natural estimate of the joint probability
for categories <code class="reqn">i</code> and <code class="reqn">j</code> at lag l, <code class="reqn">i,j=1, \ldots, r</code>. Assume also that
we have a real-valued time series of length <code class="reqn">T</code>, <code class="reqn">\overline{Z}_t=\{\overline{Z}_1,\ldots, \overline{Z}_T\}</code>.
The function computes the following quantities depending on the argument
<code>type</code>:
</p>

<ul>
<li><p>If <code>type=gini_index</code>, the function computes the
estimated gini index, <code class="reqn">\widehat{g}=\frac{r}{r-1}(1-\sum_{i=1}^{r}\widehat{p}_i^2)</code>.
</p>
</li>
<li><p>If <code>type=entropy</code>, the function computes the
estimated entropy, <code class="reqn">\widehat{e}=\frac{-1}{\ln(r)}\sum_{i=1}^{r}\widehat{p}_i\ln \widehat{p}_i</code>.
</p>
</li>
<li><p>If <code>type=chebycheff_dispersion</code>, the function computes the
estimated chebycheff dispersion, <code class="reqn">\widehat{c}=\frac{r}{r-1}(1-\max_i\widehat{p}_i)</code>.
</p>
</li>
<li><p>If <code>type=gk_tau</code>, the function computes the
estimated Goodman and Kruskal's tau, <code class="reqn">\widehat{\tau}(l)=\frac{\sum_{i,j=1}^{r}\frac{\widehat{p}_{ij}(l)^2}{\widehat{p}_j}-\sum_{i=1}^r\widehat{p}_i^2}{1-\sum_{i=1}^r\widehat{p}_i^2}</code>.
</p>
</li>
<li><p>If <code>type=gk_lambda</code>, the function computes the
estimated Goodman and Kruskal's lambda, <code class="reqn">\widehat{\lambda}(l)=\frac{\sum_{j=1}^{r}\max_i\widehat{p}_{ij}(l)-\max_i\widehat{p}_i}{1-\max_i\widehat{p}_i}</code>.
</p>
</li>
<li><p>If <code>type=uncertainty_coefficient</code>, the function computes the
estimated uncertainty coefficient, <code class="reqn">\widehat{u}(l)=-\frac{\sum_{i, j=1}^{r}\widehat{p}_{ij}(l)\ln\big(\frac{\widehat{p}_{ij}(l)}{\widehat{p}_i\widehat{p}_j}\big)}{\sum_{i=1}^{r}\widehat{p}_i\ln \widehat{p}_i}</code>.
</p>
</li>
<li><p>If <code>type=pearson_measure</code>, the function computes the
estimated Pearson measure, <code class="reqn">\widehat{X}_T^2(l)=T\sum_{i,j=1}^{r}\frac{(\widehat{p}_{ij}(l)-\widehat{p}_i\widehat{p}_j)^2}{\widehat{p}_i\widehat{p}_j}</code>.
</p>
</li>
<li><p>If <code>type=phi2_measure</code>, the function computes the
estimated Phi2 measure, <code class="reqn">\widehat{\Phi}^2(l)=\frac{\widehat{X}_T^2(l)}{T}</code>.
</p>
</li>
<li><p>If <code>type=sakoda_measure</code>, the function computes the
estimated Sakoda measure, <code class="reqn">\widehat{p}^*(l)=\sqrt{\frac{r\widehat{\Phi}^2(l)}{(r-1)(1+\widehat{\Phi}^2(l))}}</code>.
</p>
</li>
<li><p>If <code>type=cramers_vi</code>, the function computes the
estimated Cramer's vi, <code class="reqn">\widehat{v}(l)=\sqrt{\frac{1}{r-1}\sum_{i,j=1}^r\frac{(\widehat{p}_{ij}(l)-\widehat{p}_i\widehat{p}_j)^2}{\widehat{p}_i\widehat{p}_j}}</code>.
</p>
</li>
<li><p>If <code>type=cohens_kappa</code>, the function computes the
estimated Cohen's kappa, <code class="reqn">\widehat{\kappa}(l)=\frac{\sum_{j=1}^{r}(\widehat{p}_{jj}(l)-\widehat{p}_j^2)}{1-\sum_{i=1}^r\widehat{p}_i^2}</code>.
</p>
</li>
<li><p>If <code>type=total_correlation</code>, the function computes the
the estimated sum <code class="reqn">\widehat{\Psi}(l)=\frac{1}{r^2}\sum_{i,j=1}^{r}\widehat{\psi}_{ij}(l)^2</code>,
where <code class="reqn">\widehat{\psi}_{ij}(l)</code> is the estimated correlation
<code class="reqn">\widehat{Corr}(Y_{t, i}, Y_{t-l, j})</code>, <code class="reqn">i,j=1,\ldots,r</code>, being <code class="reqn">\overline{\boldsymbol Y}_t=\{\overline{\boldsymbol Y}_1, \ldots, \overline{\boldsymbol Y}_T\}</code>,
with <code class="reqn">\overline{\boldsymbol Y}_k=(\overline{Y}_{k,1}, \ldots, \overline{Y}_{k,r})^\top</code>, the
binarized time series of <code class="reqn">\overline{X}_t</code>.
</p>
</li>
<li><p>If <code>type=spectral_envelope</code>, the function computes the
estimated spectral envelope.
</p>
</li>
<li><p>If <code>type=total_mixed_correlation_1</code>, the function computes the
estimated total mixed l-correlation given by
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\Psi}_1(l)=\frac{1}{r}\sum_{i=1}^{r}\widehat{\psi}_{i}(l)^2,</code>
</p>
<p> where
<code class="reqn">\widehat{\psi}_{i}(l)=\widehat{Corr}(Y_{t,i}, Z_{t-l})</code>, being <code class="reqn">\overline{\boldsymbol Y}_t=\{\overline{\boldsymbol Y}_1, \ldots, \overline{\boldsymbol Y}_T\}</code>,
with <code class="reqn">\overline{\boldsymbol Y}_k=(\overline{Y}_{k,1}, \ldots, \overline{Y}_{k,r})^\top</code>, the
binarized time series of <code class="reqn">\overline{X}_t</code>.
</p>
</li>
<li><p>If <code>type=total_mixed_correlation_2</code>, the function computes the
estimated total mixed q-correlation given by
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\Psi}_2(l)=\frac{1}{r}\sum_{i=1}^{r}\int_{0}^{1}\widehat{\psi}^\rho_{i}(l)^2d\rho,</code>
</p>
<p> where
<code class="reqn">\widehat{\psi}_{i}^\rho(l)=\widehat{Corr}\big(Y_{t,i}, I(Z_{t-l}\leq q_{Z_t}(\rho)) \big)</code>, being <code class="reqn">\overline{\boldsymbol Y}_t=\{\overline{\boldsymbol Y}_1, \ldots, \overline{\boldsymbol Y}_T\}</code>,
with <code class="reqn">\overline{\boldsymbol Y}_k=(\overline{Y}_{k,1}, \ldots, \overline{Y}_{k,r})^\top</code>, the
binarized time series of <code class="reqn">\overline{X}_t</code>, <code class="reqn">\rho \in (0, 1)</code> a probability
level, <code class="reqn">I(\cdot)</code> the indicator function and <code class="reqn">q_{Z_t}</code> the quantile
function of the corresponding real-valued process.
</p>
</li></ul>



<h3>Value</h3>

<p>The corresponding feature.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH, Göb R (2008).
&ldquo;Measuring serial dependence in categorical time series.&rdquo;
<em>AStA Advances in Statistical Analysis</em>, <b>92</b>, 71&ndash;89.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
uc &lt;- calculate_features(series = sequence_1, type = 'uncertainty_coefficient' )
# Computing the uncertainty coefficient
# for the first series in dataset GeneticSequences
se &lt;- calculate_features(series = sequence_1, type = 'spectral_envelope' )
# Computing the spectral envelope
# for the first series in dataset GeneticSequences
</code></pre>

<hr>
<h2 id='calculate_motifs'>Computes the relative frequency of motifs in a categorical time series</h2><span id='topic+calculate_motifs'></span>

<h3>Description</h3>

<p><code>calculate_motifs</code> computes the motifs of a categorical time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_motifs(series, motif_length)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_motifs_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="calculate_motifs_+3A_motif_length">motif_length</code></td>
<td>
<p>The length of the motif.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a CTS of length <code class="reqn">T</code> with range <code class="reqn">\mathcal{V}=\{1, 2, \ldots, r\}</code>,
<code class="reqn">\overline{X}_t=\{\overline{X}_1,\ldots, \overline{X}_T\}</code>, and a motif length <code class="reqn">L</code>,
the function returns an array of <code class="reqn">r^L</code> elements, with the element
in the position <code class="reqn">(i_1, i_2, \ldots, i_r)</code> being the relative frequency
of the motif &ldquo;<code class="reqn">i_1i_2 \cdots i_r</code>&rdquo; in the corresponding time series.
</p>


<h3>Value</h3>

<p>Returns an array with the relative frequency of motifs in a
categorical time series.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Lonardi JLEKS, Patel P (2002).
&ldquo;Finding motifs in time series.&rdquo;
In <em>Proc. of the 2nd Workshop on Temporal Data Mining</em>, 53&ndash;68.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
calculate_motifs(sequence_1, motif_length = 3)
# Computing the relative frequencies of motifs of length 3 for the first
# series in dataset GeneticSequences
</code></pre>

<hr>
<h2 id='calculate_subfeatures'>Computes several subfeatures associated with a categorical time series</h2><span id='topic+calculate_subfeatures'></span>

<h3>Description</h3>

<p><code>calculate_features</code> computes several subfeatures associated with a
categorical time series or between a categorical and a real-valued time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculate_subfeatures(series, n_series, lag = 1, type = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calculate_subfeatures_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="calculate_subfeatures_+3A_n_series">n_series</code></td>
<td>
<p>A real-valued time series.</p>
</td></tr>
<tr><td><code id="calculate_subfeatures_+3A_lag">lag</code></td>
<td>
<p>The considered lag (default is 1).</p>
</td></tr>
<tr><td><code id="calculate_subfeatures_+3A_type">type</code></td>
<td>
<p>String indicating the subfeature one wishes to compute.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assume we have a CTS of length <code class="reqn">T</code> with range <code class="reqn">\mathcal{V}=\{1, 2, \ldots, r\}</code>,
<code class="reqn">\overline{X}_t=\{\overline{X}_1,\ldots, \overline{X}_T\}</code>, with <code class="reqn">\widehat{p}_i</code>
being the natural estimate of the marginal probability of the <code class="reqn">i</code>th
category, and <code class="reqn">\widehat{p}_{ij}(l)</code> being the natural estimate of the joint probability
for categories <code class="reqn">i</code> and <code class="reqn">j</code> at lag l, <code class="reqn">i,j=1, \ldots, r</code>. Assume also that
we have a real-valued time series of length <code class="reqn">T</code>, <code class="reqn">\overline{Z}_t=\{\overline{Z}_1,\ldots, \overline{Z}_T\}</code>.
The function computes the following subfeatures depending on the argument
<code>type</code>:
</p>

<ul>
<li><p>If <code>type=entropy</code>, the function computes the
subfeatures associated with the estimated entropy, <code class="reqn">\widehat{p}_i\ln(\widehat{p}_i)</code>,
<code class="reqn">i=1,2, \ldots,r</code>.
</p>
</li>
<li><p>If <code>type=gk_tau</code>, the function computes the
subfeatures associated with the estimated Goodman and Kruskal's tau, <code class="reqn">\frac{\widehat{p}_{ij}(l)^2}{\widehat{p}_j}</code>,
<code class="reqn">i,j=1,2, \ldots,r</code>.
</p>
</li>
<li><p>If <code>type=gk_lambda</code>, the function computes the
subfeatures associated with the estimated Goodman and Kruskal's lambda, <code class="reqn">\max_i\widehat{p}_{ij}(l)</code>,
<code class="reqn">i=1,2, \ldots,r</code>.
</p>
</li>
<li><p>If <code>type=uncertainty_coefficient</code>, the function computes the
subfeatures associated with the estimated uncertainty coefficient, <code class="reqn">\widehat{p}_{ij}(l)\ln\Big(\frac{\widehat{p}_{ij}(l)}{\widehat{p}_i\widehat{p}_j}\Big)</code>,
<code class="reqn">i,j=1,2, \ldots,r</code>.
</p>
</li>
<li><p>If <code>type=pearson_measure</code>, the function computes the
subfeatures associated with the estimated Pearson measure, <code class="reqn">\frac{(\widehat{p}_{ij}(l)-\widehat{p}_i\widehat{p}_j)^2}{\widehat{p}_i\widehat{p}_j}</code>,
<code class="reqn">i,j=1,2, \ldots,r</code>.
</p>
</li>
<li><p>If <code>type=phi2_measure</code>, the function computes the
subfeatures associated with the estimated Phi2 measure, <code class="reqn">\frac{(\widehat{p}_{ij}(l)-\widehat{p}_i\widehat{p}_j)^2}{\widehat{p}_i\widehat{p}_j}</code>,
<code class="reqn">i,j=1,2, \ldots,r</code>.
</p>
</li>
<li><p>If <code>type=sakoda_measure</code>, the function computes the
subfeatures associated with the estimated Sakoda measure, <code class="reqn">\frac{(\widehat{p}_{ij}(l)-\widehat{p}_i\widehat{p}_j)^2}{\widehat{p}_i\widehat{p}_j}</code>,
<code class="reqn">i,j=1,2, \ldots,r</code>.
</p>
</li>
<li><p>If <code>type=cramers_vi</code>, the function computes the
subfeatures associated with the estimated Cramer's vi, <code class="reqn">\frac{(\widehat{p}_{ij}(l)-\widehat{p}_i\widehat{p}_j)^2}{\widehat{p}_i\widehat{p}_j}</code>,
<code class="reqn">i,j=1,2, \ldots,r</code>.
</p>
</li>
<li><p>If <code>type=cohens_kappa</code>, the function computes the
subfeatures associated with the estimated Cohen's kappa, <code class="reqn">\widehat{p}_{ii}(l)-\widehat{p}_i^2</code>,
<code class="reqn">i=1,2, \ldots,r</code>.
</p>
</li>
<li><p>If <code>type=total_correlation</code>, the function computes the
subfeatures associated with the total correlation, <code class="reqn">\widehat{\psi}_{ij}(l)</code>,
<code class="reqn">i,j=1,2, \ldots,r</code> (see <code>type='total_mixed_cor'</code> in the function <code>calculate_features</code>).
</p>
</li>
<li><p>If <code>type=total_mixed_correlation_1</code>, the function computes the
subfeatures associated with the total mixed l-correlation, <code class="reqn">\widehat{\psi}_{i}(l)</code>,
<code class="reqn">i=1,2, \ldots,r</code> (see <code>type='total_mixed_correlation_1'</code> in the function <code>calculate_features</code>).
</p>
</li>
<li><p>If <code>type=total_mixed_correlation_2</code>, the function computes the
subfeatures associated with the total mixed q-correlation, <code class="reqn">\int_{0}^{1}\widehat{\psi}^\rho_{i}(l)^2d\rho</code>,
<code class="reqn">i=1,2, \ldots,r</code> (see <code>type='total_mixed_correlation_2'</code> in the function <code>calculate_features</code>).
</p>
</li></ul>



<h3>Value</h3>

<p>The corresponding subfeature
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH, Göb R (2008).
&ldquo;Measuring serial dependence in categorical time series.&rdquo;
<em>AStA Advances in Statistical Analysis</em>, <b>92</b>, 71&ndash;89.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
suc &lt;- calculate_subfeatures(series = sequence_1, type = 'uncertainty_coefficient')
# Computing the subfeatures associated with the uncertainty coefficient
# for the first series in dataset GeneticSequences
scv &lt;- calculate_subfeatures(series = sequence_1, type = 'cramers_vi' )
# Computing the subfeatures associated with the cramers vi
# for the first series in dataset GeneticSequences
</code></pre>

<hr>
<h2 id='conditional_probabilities'>Computes the conditional probabilities of a categorical time series</h2><span id='topic+conditional_probabilities'></span>

<h3>Description</h3>

<p><code>conditional_probabilities</code> returns a matrix with the conditional
probabilities of a categorical time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conditional_probabilities(series, lag = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conditional_probabilities_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="conditional_probabilities_+3A_lag">lag</code></td>
<td>
<p>The considered lag (default is 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a CTS of length <code class="reqn">T</code> with range <code class="reqn">\mathcal{V}=\{1, 2, \ldots, r\}</code>,
<code class="reqn">\overline{X}_t=\{\overline{X}_1,\ldots, \overline{X}_T\}</code>, the function computes the
matrix <code class="reqn">\widehat{\boldsymbol P}^c(l) = \big(\widehat{p}^c_{ij}(l)\big)_{1 \le i, j \le r}</code>,
with <code class="reqn">\widehat{p}^c_{ij}(l)=\frac{TN_{ij}(l)}{(T-l)N_i}</code>, where
<code class="reqn">N_i</code> is the number of elements equal to <code class="reqn">i</code> in the realization <code class="reqn">\overline{X}_t</code> and <code class="reqn">N_{ij}(l)</code> is the number
of pairs <code class="reqn">(\overline{X}_t, \overline{X}_{t-l})=(i,j)</code> in the realization <code class="reqn">\overline{X}_t</code>.
</p>


<h3>Value</h3>

<p>A matrix with the conditional probabilities.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH, Göb R (2008).
&ldquo;Measuring serial dependence in categorical time series.&rdquo;
<em>AStA Advances in Statistical Analysis</em>, <b>92</b>, 71&ndash;89.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
matrix_cp &lt;- conditional_probabilities(series = sequence_1) # Computing the matrix of
# joint probabilities for the first series in dataset GeneticSequences
</code></pre>

<hr>
<h2 id='GeneticSequences'>GeneticSequences</h2><span id='topic+GeneticSequences'></span>

<h3>Description</h3>

<p>Categorical time series (CTS) of DNA sequences from different
viruses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GeneticSequences)
</code></pre>


<h3>Format</h3>

<p>A <code>tsibble</code> with four columns, which are:
</p>

<dl>
<dt><code>Value</code></dt><dd><p>The categorical values of the time series in the dataset.</p>
</dd>
<dt><code>Series</code></dt><dd><p>Integer values indicating the considered time series (there are 32 time series in the dataset).</p>
</dd>
<dt><code>Time</code></dt><dd><p>Integer values indicating the temporal indexes of the observations.</p>
</dd>
<dt><code>Class</code></dt><dd><p>Integer values indicating the class of each time series.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The column <code>Value</code> is the concatenation of 32 time series
taking four categorical values (DNA bases). The column <code>Class</code> is formed
by integers from 1 to 4, indicating that there are 4 different classes in the database. Each class is associated with a different
family of viruses. For more information, see López-Oriona et al. (2023).
</p>


<h3>References</h3>


<p>López-Oriona Á, Vilar JA, D’Urso P (2023).
&ldquo;Hard and soft clustering of categorical time series based on two novel distances with an application to biological sequences.&rdquo;
<em>Information Sciences</em>, <b>624</b>, 467&ndash;492.
</p>


<hr>
<h2 id='joint_probabilities'>Computes the joint probabilities of a categorical time series</h2><span id='topic+joint_probabilities'></span>

<h3>Description</h3>

<p><code>joint_probabilities</code> returns a matrix with the joint
probabilities of a categorical time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>joint_probabilities(series, lag = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="joint_probabilities_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="joint_probabilities_+3A_lag">lag</code></td>
<td>
<p>The considered lag (default is 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a CTS of length <code class="reqn">T</code> with range <code class="reqn">\mathcal{V}=\{1, 2, \ldots, r\}</code>,
<code class="reqn">\overline{X}_t=\{\overline{X}_1,\ldots, \overline{X}_T\}</code>, the function computes the
matrix <code class="reqn">\widehat{\boldsymbol P}(l) = \big(\widehat{p}_{ij}(l)\big)_{1 \le i, j \le r}</code>,
with <code class="reqn">\widehat{p}_{ij}(l)=\frac{N_{ij}(l)}{T-l}</code>, where <code class="reqn">N_{ij}(l)</code> is the number
of pairs <code class="reqn">(\overline{X}_t, \overline{X}_{t-l})=(i,j)</code> in the realization <code class="reqn">\overline{X}_t</code>.
</p>


<h3>Value</h3>

<p>A matrix with the joint probabilities.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH, Göb R (2008).
&ldquo;Measuring serial dependence in categorical time series.&rdquo;
<em>AStA Advances in Statistical Analysis</em>, <b>92</b>, 71&ndash;89.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
matrix_jp &lt;- joint_probabilities(series = sequence_1) # Computing the matrix of
# joint probabilities for the first series in dataset GeneticSequences
</code></pre>

<hr>
<h2 id='marginal_probabilities'>Computes the marginal probabilities of a categorical time series</h2><span id='topic+marginal_probabilities'></span>

<h3>Description</h3>

<p><code>marginal_probabilities</code> returns a vector with the marginal
probabilities of a categorical time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marginal_probabilities(series)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="marginal_probabilities_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a CTS of length <code class="reqn">T</code> with range <code class="reqn">\mathcal{V}=\{1, 2, \ldots, r\}</code>,
<code class="reqn">\overline{X}_t=\{\overline{X}_1,\ldots, \overline{X}_T\}</code>, the function computes the
vector <code class="reqn">\widehat{\boldsymbol p} =(\widehat{p}_1, \ldots, \widehat{p}_r)</code>,
with <code class="reqn">\widehat{p}_i=\frac{N_i}{T}</code>, where <code class="reqn">N_i</code> is the number
of elements equal to <code class="reqn">i</code> in the realization <code class="reqn">\overline{X}_t</code>.
</p>


<h3>Value</h3>

<p>A vector with the marginal probabilities.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH, Göb R (2008).
&ldquo;Measuring serial dependence in categorical time series.&rdquo;
<em>AStA Advances in Statistical Analysis</em>, <b>92</b>, 71&ndash;89.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
vector_mp &lt;- marginal_probabilities(series = sequence_1) # Computing the vector of
# marginal probabilities for the first series in dataset GeneticSequences
</code></pre>

<hr>
<h2 id='plot_ccc'>Constructs a control chart for the cycle lengths of a categorical series</h2><span id='topic+plot_ccc'></span>

<h3>Description</h3>

<p><code>plot_ccc</code> constructs a control chart for the cycle lengths of a categorical series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ccc(
  series,
  mu_t,
  lcl_t,
  ucl_t,
  plot = TRUE,
  title = "Control chart (cycles)",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ccc_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="plot_ccc_+3A_mu_t">mu_t</code></td>
<td>
<p>The mean of the process measuring the cycle lengths.</p>
</td></tr>
<tr><td><code id="plot_ccc_+3A_lcl_t">lcl_t</code></td>
<td>
<p>The lower control limit.</p>
</td></tr>
<tr><td><code id="plot_ccc_+3A_ucl_t">ucl_t</code></td>
<td>
<p>The upper control limit.</p>
</td></tr>
<tr><td><code id="plot_ccc_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>plot = TRUE</code> (default), returns the control
chart. Otherwise, returns the standardized statistic.</p>
</td></tr>
<tr><td><code id="plot_ccc_+3A_title">title</code></td>
<td>
<p>The title of the graph.</p>
</td></tr>
<tr><td><code id="plot_ccc_+3A_...">...</code></td>
<td>
<p>Additional parameters for the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Constructs a control chart of a CTS based on cycle lengths. The chart is based on the
standardized statistic <code class="reqn">T_t=T_t^{(L)}+T_t^{(U)}</code>, with <code class="reqn">T_t^{(L)}=\min \left(0, \frac{C_t-\mu_t}{\left|L C L_t-\mu_t\right|}\right)</code>
and <code class="reqn">T_t^{(U)}=\max \left(0, \frac{C_t-\mu_t}{\left|U C L_t-\mu_t\right|}\right)</code>,
where <code class="reqn">Z_t</code> expresses the length of a cycle ending with a specific category,
<code class="reqn">\mu_t</code> denotes the mean of <code class="reqn">Z_t</code> and <code class="reqn">LCL_t</code> and <code class="reqn">UCL_t</code> are
lower and upper individual control limits, respectively. Note that an
out-of-control alarm is signalled if <code class="reqn">T_t&lt;-1</code> or <code class="reqn">T_t&gt;1</code>.
</p>


<h3>Value</h3>

<p>If <code>plot = TRUE</code> (default), represents the control chart for the cycle lengths. Otherwise, the function
returns a matrix with the values of the standardized statistic for each time t
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH (2008).
&ldquo;Visual analysis of categorical time series.&rdquo;
<em>Statistical Methodology</em>, <b>5</b>(1), 56&ndash;71.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- SyntheticData1[which(SyntheticData1$Series==1),]
cycle_cc &lt;- plot_ccc(series = sequence_1, mu_t = c(1, 1.5, 1),
lcl_t = rep(10, 600), ucl_t = rep(10, 600)) # Representing
# a control chart for the cycle lengths
cycle_cc &lt;- plot_ccc(series = sequence_1, mu_t = c(1, 1.5, 1),
lcl_t = rep(10, 600), ucl_t = rep(10, 600), plot = FALSE) # Computing the
# corresponding standardized statistic
</code></pre>

<hr>
<h2 id='plot_cohen'>Constructs a serial dependence plot based on Cohen's kappa</h2><span id='topic+plot_cohen'></span>

<h3>Description</h3>

<p><code>plot_cohen</code> constructs a serial dependence plot of a categorical
time series based on Cohen's kappa
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_cohen(
  series,
  max_lag = 10,
  alpha = 0.05,
  plot = TRUE,
  title = "Serial dependence plot",
  bar_width = 0.12,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_cohen_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="plot_cohen_+3A_max_lag">max_lag</code></td>
<td>
<p>The maximum lag represented in the plot (default is 10).</p>
</td></tr>
<tr><td><code id="plot_cohen_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for the corresponding hypothesis test (default is 0.05).</p>
</td></tr>
<tr><td><code id="plot_cohen_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>plot = TRUE</code> (default), returns the serial dependence
plot. Otherwise, returns a list with the values of Cohens's kappa, the critical
value and the corresponding p-values.</p>
</td></tr>
<tr><td><code id="plot_cohen_+3A_title">title</code></td>
<td>
<p>The title of the graph.</p>
</td></tr>
<tr><td><code id="plot_cohen_+3A_bar_width">bar_width</code></td>
<td>
<p>The width of the corresponding bars.</p>
</td></tr>
<tr><td><code id="plot_cohen_+3A_...">...</code></td>
<td>
<p>Additional parameters for the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Constructs a serial dependence plot based on Cohens's kappa, <code class="reqn">\widehat{\kappa}(l)</code>,
for several lags. A dashed lined is incorporated indicating the critical value
of the test based on the following asymptotic approximation (under the i.i.d. assumption):
</p>
<p style="text-align: center;"><code class="reqn">\sqrt{\frac{T}{V(\widehat{\boldsymbol p})}}\bigg(\widehat{\kappa}(l)+\frac{1}{T}\bigg)\sim N\big(0, 1\big),</code>
</p>
<p> where <code class="reqn">T</code> is the series length,
<code class="reqn">\widehat{\boldsymbol p}=(\widehat{p}_1, \ldots, \widehat{p}_r)</code> is the vector of estimated marginal probabilities for the <code class="reqn">r</code> categories of
the series and <code class="reqn">V(\boldsymbol {\widehat{p}})=1-\frac{1+2\sum_{i=1}^{r}\widehat{p}_i^3-3\sum_{i=1}^{r}\widehat{p}_i^2}{(1-\sum_{i=1}^{r}\widehat{p}_i^2)^2}</code>.
</p>


<h3>Value</h3>

<p>If <code>plot = TRUE</code> (default), returns the serial dependence plot based on Cohens's kappa. Otherwise, the function
returns a list with the values of Cohens's kappa, the critical
value and the corresponding p-values.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH (2011).
&ldquo;Empirical measures of signed serial dependence in categorical time series.&rdquo;
<em>Journal of Statistical Computation and Simulation</em>, <b>81</b>(4), 411&ndash;429.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
plot_ck &lt;- plot_cohen(series = sequence_1, max_lag = 3) # Representing
# the serial dependence plot
list_ck &lt;- plot_cohen(series = sequence_1, max_lag = 3, plot = FALSE) # Obtaining
# the values of Cohens's kappa, the critical value and the p-values
</code></pre>

<hr>
<h2 id='plot_cramer'>Constructs a serial dependence plot based on Cramer's vi</h2><span id='topic+plot_cramer'></span>

<h3>Description</h3>

<p><code>plot_cramer</code> constructs a serial dependence plot of a categorical
time series based on Cramer's vi
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_cramer(
  series,
  max_lag = 10,
  alpha = 0.05,
  plot = TRUE,
  title = "Serial dependence plot",
  bar_width = 0.12,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_cramer_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="plot_cramer_+3A_max_lag">max_lag</code></td>
<td>
<p>The maximum lag represented in the plot (default is 10).</p>
</td></tr>
<tr><td><code id="plot_cramer_+3A_alpha">alpha</code></td>
<td>
<p>The significance level for the corresponding hypothesis test (default is 0.05).</p>
</td></tr>
<tr><td><code id="plot_cramer_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>plot = TRUE</code> (default), returns the serial dependence
plot. Otherwise, returns a list with the values of Cramer's vi, the critical
value and the corresponding p-values.</p>
</td></tr>
<tr><td><code id="plot_cramer_+3A_title">title</code></td>
<td>
<p>The title of the graph.</p>
</td></tr>
<tr><td><code id="plot_cramer_+3A_bar_width">bar_width</code></td>
<td>
<p>The width of the corresponding bars.</p>
</td></tr>
<tr><td><code id="plot_cramer_+3A_...">...</code></td>
<td>
<p>Additional parameters for the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Constructs a serial dependence plot based on Cramer's vi, <code class="reqn">\widehat{v}(l)</code>,
for several lags. A dashed lined is incorporated indicating the critical value
of the test based on the following asymptotic approximation (under the i.i.d. assumption):
</p>
<p style="text-align: center;"><code class="reqn">T(r-1)\widehat{v}(l)^2 \sim\chi^2_{(r-1)^2},</code>
</p>
<p> where <code class="reqn">T</code> is the series length
and <code class="reqn">r</code> is the number of categories in the time series.
</p>


<h3>Value</h3>

<p>If <code>plot = TRUE</code> (default), returns the serial dependence plot based on Cramer's vi. Otherwise, the function
returns a list with the values of Cramer's vi, the critical
value and the corresponding p-values.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH (2013).
&ldquo;Serial dependence of NDARMA processes.&rdquo;
<em>Computational Statistics and Data Analysis</em>, <b>68</b>, 213&ndash;238.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- SyntheticData1[which(SyntheticData1$Series==1),]
plot_cv &lt;- plot_cramer(series = sequence_1, max_lag = 3) # Representing
# the serial dependence plot
list_cv &lt;- plot_cramer(series = sequence_1, max_lag = 3, plot = FALSE) # Obtaining
# the values of Cramer's vi, the critical value and the p-values
</code></pre>

<hr>
<h2 id='plot_cts'>Constructs a categorical time series plot</h2><span id='topic+plot_cts'></span>

<h3>Description</h3>

<p><code>plot_cts</code> constructs a categorical time series plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_cts(series, title = "Time series plot")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_cts_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="plot_cts_+3A_title">title</code></td>
<td>
<p>The title of the graph.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Constructs a categorial time series plot for a given CTS.
</p>


<h3>Value</h3>

<p>The categorical time series plot.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH (2018).
<em>An introduction to discrete-valued time series</em>.
John Wiley and Sons.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
time_series_plot &lt;- plot_cts(series = sequence_1) # Constructs a categorical
# time series plot for the first 50 observations of the first  time series in
# dataset GeneticSequences
</code></pre>

<hr>
<h2 id='plot_ifsct'>Constructs the IFS circle transformation of a
categorical time series</h2><span id='topic+plot_ifsct'></span>

<h3>Description</h3>

<p><code>plot_ifsct</code> constructs the IFS circle transformation of
a categorical time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ifsct(series, alpha, beta, title = "IFS circle transformation", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ifsct_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="plot_ifsct_+3A_alpha">alpha</code></td>
<td>
<p>Parameter alpha in the circle transformation.</p>
</td></tr>
<tr><td><code id="plot_ifsct_+3A_beta">beta</code></td>
<td>
<p>Parameter beta in the circle transformation.</p>
</td></tr>
<tr><td><code id="plot_ifsct_+3A_title">title</code></td>
<td>
<p>The title of the graph.</p>
</td></tr>
<tr><td><code id="plot_ifsct_+3A_...">...</code></td>
<td>
<p>Additional parameters for the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Constructs the IFS circle transformation for a given CTS, which is
useful to identify cycles of arbitrary length.
</p>


<h3>Value</h3>

<p>The IFS circle transformation.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH (2008).
&ldquo;Visual analysis of categorical time series.&rdquo;
<em>Statistical Methodology</em>, <b>5</b>(1), 56&ndash;71.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
ct &lt;- plot_ifsct(sequence_1, alpha = 0.1, beta = 0.1) # Constructing the IFS circle transformation
# for the first CTS in dataset GeneticSequences
</code></pre>

<hr>
<h2 id='plot_mcc'>Constructs a control chart for the marginal distribution of a categorical
series</h2><span id='topic+plot_mcc'></span>

<h3>Description</h3>

<p><code>plot_mcc</code> constructs a control chart for the marginal distribution
of a categorical series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_mcc(
  series,
  c,
  sigma,
  lambda = 0.99,
  k = 3.3,
  min_max = FALSE,
  plot = TRUE,
  title = "Control chart (marginal)",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_mcc_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="plot_mcc_+3A_c">c</code></td>
<td>
<p>The hypothetical marginal distribution.</p>
</td></tr>
<tr><td><code id="plot_mcc_+3A_sigma">sigma</code></td>
<td>
<p>A matrix containing the variances for each category (columns)
and each time t (rows).</p>
</td></tr>
<tr><td><code id="plot_mcc_+3A_lambda">lambda</code></td>
<td>
<p>The constant lambda to construct the EWMA estimator.</p>
</td></tr>
<tr><td><code id="plot_mcc_+3A_k">k</code></td>
<td>
<p>The constant k to construct the k sigma limits.</p>
</td></tr>
<tr><td><code id="plot_mcc_+3A_min_max">min_max</code></td>
<td>
<p>Logical. If <code>min_max = FALSE</code> (default), the standard
control chart for the marginal distribution is plotted. Otherwise, the
reduced control chart is plotted, i.e., only the minimum and maximum values
of the standardized statistics (with respect to the set of categories) are considered.</p>
</td></tr>
<tr><td><code id="plot_mcc_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>plot = TRUE</code> (default), returns the control
chart. Otherwise, returns the standardized statistics or their maximum and
minimum value for each time t.</p>
</td></tr>
<tr><td><code id="plot_mcc_+3A_title">title</code></td>
<td>
<p>The title of the graph.</p>
</td></tr>
<tr><td><code id="plot_mcc_+3A_...">...</code></td>
<td>
<p>Additional parameters for the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Constructs a control chart of a CTS with range <code class="reqn">\mathcal{V}=\{1, \ldots, r\}</code> based on the marginal distribution. The chart relies on the
standardized statistic <code class="reqn">T_{t, i}=\frac{\hat{\pi}_{t, i}^{(\lambda)}-p_i}{k \cdot \sigma_{t, i}}</code>, where the <code class="reqn">\hat{\pi}_{t, i}^{(\lambda)}</code>,
<code class="reqn">i=1,\ldots,r</code>, are the components of the EWMA estimator of the marginal
distribution, <code class="reqn">p_i</code> is the marginal probability of category <code class="reqn">i</code>,
<code class="reqn">\sigma_{t,i}</code> is the variance of <code class="reqn">\hat{\pi}_{t, i}^{(\lambda)}</code> and <code class="reqn">k</code>
is a constant set by the user. If <code>min_max = FALSE</code>, then only the
statistics <code class="reqn">T_t^{\min }=\min_{i \in \mathcal{V}} T_{t, i}</code> and
<code class="reqn">T_t^{\max }=\max_{i \in \mathcal{V}} T_{t, i}</code> are plotted.
An out-of-control alarm is signalled if the statistics are below -1 or
above 1.
</p>


<h3>Value</h3>

<p>If <code>plot = TRUE</code> (default), represents the control chart for the marginal distribution. Otherwise, the function
returns a matrix with the values of the standardized statistics for each time t
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH (2008).
&ldquo;Visual analysis of categorical time series.&rdquo;
<em>Statistical Methodology</em>, <b>5</b>(1), 56&ndash;71.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- SyntheticData1[which(SyntheticData1$Series==1),]
cycle_cc &lt;- plot_ccc(series = sequence_1, mu_t = c(1, 1.5, 1),
lcl_t = rep(10, 600), ucl_t = rep(10, 600))
cycle_md &lt;- plot_mcc(series = sequence_1, c = c(0.3, 0.3, 0.4),
sigma = matrix(rep(c(1, 1, 1), 600), nrow = 600)) # Representing
# a control chart for the marginal distribution
cycle_md &lt;- plot_mcc(series = sequence_1, c = c(0.3, 0.3, 0.4),
sigma = matrix(rep(c(1, 1, 1), 600), nrow = 600), plot = FALSE) # Computing the
# corresponding standardized statistic
</code></pre>

<hr>
<h2 id='plot_ph'>Constructs the pattern histogram associated with a given category of a
categorical time series</h2><span id='topic+plot_ph'></span>

<h3>Description</h3>

<p><code>plot_ph</code> constructs the pattern histogram associated with a given category of a
categorical time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ph(
  series,
  category,
  plot = TRUE,
  title = paste0("Pattern histogram (", category, ")"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_ph_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="plot_ph_+3A_category">category</code></td>
<td>
<p>The selected category.</p>
</td></tr>
<tr><td><code id="plot_ph_+3A_plot">plot</code></td>
<td>
<p>Logical. If <code>plot = TRUE</code> (default), returns the pattern
histogram. Otherwise, returns the frequencies of cycle lengths associated
with the corresponding category.</p>
</td></tr>
<tr><td><code id="plot_ph_+3A_title">title</code></td>
<td>
<p>The title of the graph.</p>
</td></tr>
<tr><td><code id="plot_ph_+3A_...">...</code></td>
<td>
<p>Additional parameters for the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Constructs the pattern histogram for a specific category of a CTS. This graph
represents the frequencies of the cycles for the corresponding category according
to their length.
</p>


<h3>Value</h3>

<p>The pattern histogram.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Weiß CH (2008).
&ldquo;Visual analysis of categorical time series.&rdquo;
<em>Statistical Methodology</em>, <b>5</b>(1), 56&ndash;71.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
ph &lt;- plot_ph(sequence_1,
category = 'a') # Constructing the pattern histogram
# for the first CTS in dataset GeneticSequences concerning the category 'a'
cycle_lengths &lt;- plot_ph(sequence_1,
category = 'a', plot = FALSE) # Obtaining the frequencies of cycle lengths
</code></pre>

<hr>
<h2 id='plot_reg'>Constructs the rate evolution graph for a categorical time series</h2><span id='topic+plot_reg'></span>

<h3>Description</h3>

<p><code>plot_reg</code> constructs the rate evolution graph
proposed by Ribler (1997).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_reg(
  series,
  title = "Rate evolution graph",
  linear_fit = FALSE,
  cat_res = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_reg_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
<tr><td><code id="plot_reg_+3A_title">title</code></td>
<td>
<p>The title of the graph.</p>
</td></tr>
<tr><td><code id="plot_reg_+3A_linear_fit">linear_fit</code></td>
<td>
<p>Logical. I <code>TRUE</code>, the corresponding least squares
lines are incorporated to the graph</p>
</td></tr>
<tr><td><code id="plot_reg_+3A_cat_res">cat_res</code></td>
<td>
<p>If this parameter is set to any of the categories of the
series, then the function returns a graph of residuals for the linear model
associated with the corresponding category</p>
</td></tr>
<tr><td><code id="plot_reg_+3A_...">...</code></td>
<td>
<p>Additional parameters for the function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a CTS of length <code class="reqn">T</code> with range <code class="reqn">\mathcal{V}=\{1, 2, \ldots, r\}</code>,
<code class="reqn">\overline{X}_t=\{\overline{X}_1,\ldots, \overline{X}_T\}</code>, and the
corresponding binarized time series, <code class="reqn">\overline{\boldsymbol Y}_t=\{\overline{\boldsymbol Y}_1, \ldots, \overline{\boldsymbol Y}_T\}</code>,
the function constructs the rate evolution graph. Specifically, consider the
series of cumulated sums given by <code class="reqn">\overline{\boldsymbol C}_t=\{\overline{\boldsymbol C}_1, \ldots, \overline{\boldsymbol C}_T\}</code>, with
<code class="reqn">\overline{\boldsymbol C}_k=\sum_{s=1}^{k}\overline{\boldsymbol Y}_s</code>,
<code class="reqn">k=1,\ldots,T</code>. The rate evolution graph displays a standard time series
plot for each one of the components of <code class="reqn">\overline{\boldsymbol C}_t</code>
simultaneously in one graph.
</p>


<h3>Value</h3>

<p>The rate evolution graph.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Ribler RL (1997).
<em>Visualizing categorical time series data with applications to computer and communications network traces</em>.
Ph.D. thesis, Virginia Polytechnic Institute and State University.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
reg &lt;- plot_reg(sequence_1) # Constructing the rate
# evolution graph for the first time series in dataset GeneticSequences
</code></pre>

<hr>
<h2 id='plot_se'>Represents the spectral envelope of a categorical time series</h2><span id='topic+plot_se'></span>

<h3>Description</h3>

<p><code>plot_se</code> represents the spectral envelope of
a categorical time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_se(series)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_se_+3A_series">series</code></td>
<td>
<p>An object of type <code>tsibble</code> (see R package <code>tsibble</code>), whose column named Value
contains the values of the corresponding CTS. This column must be of class <code>factor</code> and its levels
must be determined by the range of the CTS.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function represents the spectral envelope of a categorical time series
</p>


<h3>Value</h3>

<p>Returns returns a plot of the spectral envelope.
</p>


<h3>Author(s)</h3>

<p>Ángel López-Oriona, José A. Vilar
</p>


<h3>References</h3>


<p>Stoffer DS, Tyler DE, McDougall AJ (1993).
&ldquo;Spectral analysis for categorical time series: Scaling and the spectral envelope.&rdquo;
<em>Biometrika</em>, <b>80</b>(3), 611&ndash;622.
</p>



<h3>Examples</h3>

<pre><code class='language-R'>sequence_1 &lt;- GeneticSequences[which(GeneticSequences$Series==1),]
plot_se(sequence_1)
# Representing the spectral envelope for the first series in dataset
# GeneticSequences
</code></pre>

<hr>
<h2 id='ProteinSequences'>ProteinSequences</h2><span id='topic+ProteinSequences'></span>

<h3>Description</h3>

<p>Categorical time series (CTS) of protein sequences from different
species
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ProteinSequences)
</code></pre>


<h3>Format</h3>

<p>A <code>tsibble</code> with four columns, which are:
</p>

<dl>
<dt><code>Value</code></dt><dd><p>The categorical values of the time series in the dataset.</p>
</dd>
<dt><code>Series</code></dt><dd><p>Integer values indicating the considered time series (there are 40 time series in the dataset).</p>
</dd>
<dt><code>Time</code></dt><dd><p>Integer values indicating the temporal indexes of the observations.</p>
</dd>
<dt><code>Class</code></dt><dd><p>Integer values indicating the class of each time series.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The column <code>Value</code> is the concatenation of 40 time series
taking four categorical values (amino-acids). The column <code>Class</code> is formed
by integers from 1 to 4, indicating that there are 4 different classes in the database. Each class is associated with a different
family of viruses. For more information, see López-Oriona et al. (2023).
</p>


<h3>References</h3>


<p>López-Oriona Á, Vilar JA, D’Urso P (2023).
&ldquo;Hard and soft clustering of categorical time series based on two novel distances with an application to biological sequences.&rdquo;
<em>Information Sciences</em>, <b>624</b>, 467&ndash;492.
</p>


<hr>
<h2 id='SleepStages'>SleepStages</h2><span id='topic+SleepStages'></span>

<h3>Description</h3>

<p>Categorical time series (CTS) of sleep stages from different
subjects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SleepStages)
</code></pre>


<h3>Format</h3>

<p>A <code>tsibble</code> with four columns, which are:
</p>

<dl>
<dt><code>Value</code></dt><dd><p>The categorical values of the time series in the dataset.</p>
</dd>
<dt><code>Series</code></dt><dd><p>Integer values indicating the considered time series (there are 62 time series in the dataset).</p>
</dd>
<dt><code>Time</code></dt><dd><p>Integer values indicating the temporal indexes of the observations.</p>
</dd>
<dt><code>Class</code></dt><dd><p>Integer values indicating the class of each time series.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The column <code>Value</code> is the concatenation of 62 time series
taking six categorical values (sleep stages). The column <code>Class</code> is formed
by the integers 1 and 2 indicating that there are 2 different classes in the database. Each class is associated with a sleep
disorder (class 1 refers to nocturnal frontal lobe epilepsy, while class refers 2 to REM behavior disorder).
For more information, see López-Oriona et al. (2023).
</p>


<h3>References</h3>


<p>López-Oriona Á, Vilar JA, D’Urso P (2023).
&ldquo;Hard and soft clustering of categorical time series based on two novel distances with an application to biological sequences.&rdquo;
<em>Information Sciences</em>, <b>624</b>, 467&ndash;492.
</p>


<hr>
<h2 id='SyntheticData1'>SyntheticData1</h2><span id='topic+SyntheticData1'></span>

<h3>Description</h3>

<p>Synthetic dataset containing 80 CTS generated from four
different generating processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SyntheticData1)
</code></pre>


<h3>Format</h3>

<p>A <code>tsibble</code> with four columns, which are:
</p>

<dl>
<dt><code>Value</code></dt><dd><p>The categorical values of the time series in the dataset.</p>
</dd>
<dt><code>Series</code></dt><dd><p>Integer values indicating the considered time series (there are 80 time series in the dataset).</p>
</dd>
<dt><code>Time</code></dt><dd><p>Integer values indicating the temporal indexes of the observations.</p>
</dd>
<dt><code>Class</code></dt><dd><p>Integer values indicating the class of each time series.</p>
</dd>
</dl>

<p>@details The column <code>Value</code> is the concatenation of 80 time series of length 600
taking three categorical values. Series 1-20, 21-40, 41-60 and 61-80 were generated from
Markov Chains with different matrices of transition probabilities (see Scenario 1 in López-Oriona et al. (2023)).
Therefore, there are 4 different classes in the dataset.
</p>


<h3>References</h3>


<p>López-Oriona Á, Vilar JA, D’Urso P (2023).
&ldquo;Hard and soft clustering of categorical time series based on two novel distances with an application to biological sequences.&rdquo;
<em>Information Sciences</em>, <b>624</b>, 467&ndash;492.
</p>


<hr>
<h2 id='SyntheticData2'>SyntheticData2</h2><span id='topic+SyntheticData2'></span>

<h3>Description</h3>

<p>Synthetic dataset containing 80 CTS generated from four
different generating processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SyntheticData2)
</code></pre>


<h3>Format</h3>

<p>A <code>tsibble</code> with four columns, which are:
</p>

<dl>
<dt><code>Value</code></dt><dd><p>The categorical values of the time series in the dataset.</p>
</dd>
<dt><code>Series</code></dt><dd><p>Integer values indicating the considered time series (there are 80 time series in the dataset).</p>
</dd>
<dt><code>Time</code></dt><dd><p>Integer values indicating the temporal indexes of the observations.</p>
</dd>
<dt><code>Class</code></dt><dd><p>Integer values indicating the class of each time series.</p>
</dd>
</dl>

<p>@details The column <code>Value</code> is the concatenation of 80 time series of length 600
taking three categorical values. Series 1-20, 21-40, 41-60 and 61-80 were generated from
Hidden Markov Models with different matrices of transition and emission probabilities (see Scenario 2 in López-Oriona et al. (2023)).
Therefore, there are 4 different classes in the dataset.
</p>


<h3>References</h3>


<p>López-Oriona Á, Vilar JA, D’Urso P (2023).
&ldquo;Hard and soft clustering of categorical time series based on two novel distances with an application to biological sequences.&rdquo;
<em>Information Sciences</em>, <b>624</b>, 467&ndash;492.
</p>


<hr>
<h2 id='SyntheticData3'>SyntheticData3</h2><span id='topic+SyntheticData3'></span>

<h3>Description</h3>

<p>Synthetic dataset containing 80 CTS generated from four
different generating processes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SyntheticData3)
</code></pre>


<h3>Format</h3>

<p>A <code>tsibble</code> with four columns, which are:
</p>

<dl>
<dt><code>Value</code></dt><dd><p>The categorical values of the time series in the dataset.</p>
</dd>
<dt><code>Series</code></dt><dd><p>Integer values indicating the considered time series (there are 80 time series in the dataset).</p>
</dd>
<dt><code>Time</code></dt><dd><p>Integer values indicating the temporal indexes of the observations.</p>
</dd>
<dt><code>Class</code></dt><dd><p>Integer values indicating the class of each time series.</p>
</dd>
</dl>

<p>@details The column <code>Value</code> is the concatenation of 80 time series of length 600
taking three categorical values. Series 1-20, 21-40, 41-60 and 61-80 were generated from
NDARMA processes with different orders and vectors of coefficients (see Scenario 3 in López-Oriona et al. (2023)).
Therefore, there are 4 different classes in the dataset.
</p>


<h3>References</h3>


<p>López-Oriona Á, Vilar JA, D’Urso P (2023).
&ldquo;Hard and soft clustering of categorical time series based on two novel distances with an application to biological sequences.&rdquo;
<em>Information Sciences</em>, <b>624</b>, 467&ndash;492.
</p>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
