<!DOCTYPE html><html lang="en-US"><head><title>Help for package rconfig</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rconfig}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rconfig'><p>Manage R Configuration at the Command Line</p></a></li>
<li><a href='#read_ini'><p>Read INI Files</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Manage R Configuration at the Command Line</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-26</td>
</tr>
<tr>
<td>Description:</td>
<td>Configuration management using files (YAML, JSON, INI, TXT),
  JSON strings, and command line arguments. Command line arguments
  can be used to override configuration. Period-separated command line
  flags are parsed as hierarchical lists. Environment variables, R global variables,
  and configuration values can be substituted.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>yaml, jsonlite</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/analythium/rconfig/issues">https://github.com/analythium/rconfig/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/analythium/rconfig">https://github.com/analythium/rconfig</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-27 04:34:09 UTC; Peter</td>
</tr>
<tr>
<td>Author:</td>
<td>Peter Solymos <a href="https://orcid.org/0000-0001-7337-1740"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Analythium Solutions Inc. [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter Solymos &lt;peter@analythium.io&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-27 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rconfig'>Manage R Configuration at the Command Line</h2><span id='topic+rconfig'></span><span id='topic+value'></span><span id='topic+value.default'></span><span id='topic+command'></span><span id='topic+command.default'></span>

<h3>Description</h3>

<p>Manage R configuration using files (YAML, JSON, INI, TXT)
JSON strings and command line arguments. Command line arguments
can be used to provide commands and to override configuration.
Period-separated command line flags are parsed as hierarchical
lists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rconfig(
  file = NULL,
  list = NULL,
  eval = NULL,
  flatten = NULL,
  debug = NULL,
  sep = NULL,
  sub = NULL,
  ...
)

value(x, ...)

## Default S3 method:
value(x, default = NULL, coerce = TRUE, ...)

command(x, ...)

## Default S3 method:
command(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rconfig_+3A_file">file</code></td>
<td>
<p>Configuration file name or URL (<code>NULL</code> to not use
this configuration file to override the default behavior).
Can be a vector, in which case each element will be treated
as a configuration file, and these will be parsed and applied
in the order they appear.</p>
</td></tr>
<tr><td><code id="rconfig_+3A_list">list</code></td>
<td>
<p>A list to override other configs (<code>NULL</code> to not use
this list to override the default behavior). This argument is treated
as a single configuration (as opposed to <code>file</code>). List names need
to be unique.</p>
</td></tr>
<tr><td><code id="rconfig_+3A_eval">eval</code></td>
<td>
<p>Logical, evaluate <code>!expr</code> R expressions.</p>
</td></tr>
<tr><td><code id="rconfig_+3A_flatten">flatten</code></td>
<td>
<p>Logical, should config contain nested lists or should
results be flat, i.e. <code>a$b$c</code> to flattened into the key <code>a.b.c</code>;
like <code><a href="base.html#topic+unlist">unlist()</a></code> but returning a list and preserving the value types.</p>
</td></tr>
<tr><td><code id="rconfig_+3A_debug">debug</code></td>
<td>
<p>Logical, when debug mode is on the configuration
source information are attached as the <code>"trace"</code> attribute.</p>
</td></tr>
<tr><td><code id="rconfig_+3A_sep">sep</code></td>
<td>
<p>Character, separator for text files.</p>
</td></tr>
<tr><td><code id="rconfig_+3A_sub">sub</code></td>
<td>
<p>Logical, substitute environment variables (see Details).</p>
</td></tr>
<tr><td><code id="rconfig_+3A_...">...</code></td>
<td>
<p>Other arguments passed to file parsers:
<code><a href="yaml.html#topic+yaml.load">yaml::yaml.load_file()</a></code> for YAML,
<code><a href="jsonlite.html#topic+fromJSON">jsonlite::fromJSON()</a></code> for JSON, and
<code><a href="utils.html#topic+read.table">utils::read.table()</a></code> for text files.</p>
</td></tr>
<tr><td><code id="rconfig_+3A_x">x</code></td>
<td>
<p>A list, e.g. the <code>rconfig()</code> output.</p>
</td></tr>
<tr><td><code id="rconfig_+3A_default">default</code></td>
<td>
<p>A default value to be used when a configuration
entry is not set.</p>
</td></tr>
<tr><td><code id="rconfig_+3A_coerce">coerce</code></td>
<td>
<p>Logical, should values of <code>x</code> coerced to the same
type as <code style="white-space: pre;">&#8288;storage.mode(default).&#8288;</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Merges configuration after parsing files, JSON strings,
and command line arguments. Note that rconfig only considers
trailing command line arguments from Rscript.
rconfig differentiates verb/noun syntax, where
verbs are sub-commands following the R script file name
and preceding the command line flags (starting with <code>-</code> or <code style="white-space: pre;">&#8288;--&#8288;</code>).
Configurations are merged in the following order
(key-values from last element override previous values for the same key):
</p>

<ol>
<li> <p><code>R_RCONFIG_FILE</code> value or <code>"rconfig.yml"</code> from working directory
</p>
</li>
<li><p> JSON strings (following <code>-j</code> and <code>--json</code> flags)
and files (following <code>-f</code> and <code>--file</code> flags)
provided as command line arguments are parsed and applied
in the order they appear (key-value pairs are separated by space,
only atomic values considered, i.e. file name or string)
for each flag, but multiple file/JSON flags are accepted in sequence
</p>
</li>
<li><p> the remaining other command line arguments, that can be
sub-commands or command line flags
(starting with <code>-</code> or <code style="white-space: pre;">&#8288;--&#8288;</code>), period-separated
command line flags are parsed as hierarchical lists
(key-value pairs are separated by space, flags must begin
with <code style="white-space: pre;">&#8288;--&#8288;</code>, values are treated as vectors when contain spaces,
i.e. <code style="white-space: pre;">&#8288;--key 1 2 3&#8288;</code>)
</p>
</li>
<li><p> configuration from the <code>file</code> argument (one or multiple files,
parsed and applied in the order they appear)
</p>
</li>
<li><p> configuration from the <code>list</code> argument
</p>
</li></ol>

<p>The following environment variables and options can be set to
modify the default behavior:
</p>

<ul>
<li> <p><code>R_RCONFIG_FILE</code>: location of the default configuration file,
it is assumed to be <code>rconfig.yml</code> in the current working directory.
The file name can be an URL or it can can be missing.
</p>
</li>
<li> <p><code>R_RCONFIG_EVAL</code>: coerced to logical, indicating whether
R expressions starting with <code>!expr</code> should be evaluated in the
namespace environment for the base package
(overrides the value of <code>getOption("rconfig.eval")</code>).
When not set the value assumed is <code>TRUE</code>.
</p>
</li>
<li> <p><code>R_RCONFIG_SUB</code>: coerced to logical, indicating whether
environment variables should be substituted
(overrides the value of <code>getOption("rconfig.sub")</code>).
When not set the value assumed is <code>TRUE</code>.
</p>
</li>
<li> <p><code>R_RCONFIG_FLATTEN</code>: coerced to logical, flatten nested lists,
i.e. <code>a$b$c</code> becomes the key <code>a.b.c</code>
(overrides the value of <code>getOption("rconfig.flatten")</code>).
When not set the value assumed is <code>FALSE</code>.
</p>
</li>
<li> <p><code>R_RCONFIG_DEBUG</code>: coerced to logical, to turn on debug mode
(overrides the value of <code>getOption("rconfig.debug")</code>).
When not set the value assumed is <code>FALSE</code>.
</p>
</li>
<li> <p><code>R_RCONFIG_SEP</code>: separator for text file parser,
(overrides the value of <code>getOption("rconfig.sep")</code>).
When not set the value assumed is <code>"="</code>.
</p>
</li></ul>

<p>When the configuration is a file (file name can also be a URL),
it can be nested structure in JSON or YAML format.
Other text files are parsed using the
separator (<code>R_RCONFIG_SEP</code> or <code>getOption("rconfig.sep")</code>) and
period-separated keys are parsed as hierarchical lists
(i.e. <code>a.b.c=12</code> is treated as <code>a$b$c = 12</code>) by default.
</p>
<p>When the configuration is a file or a JSON string,
values starting with <code>!expr</code> will be evaluated depending on the
settings <code>R_RCONFIG_EVAL</code> and <code>getOption("rconfig.eval")</code>.
E.g. <code style="white-space: pre;">&#8288;cores: !expr getOption("mc.cores")&#8288;</code>, etc.
</p>
<p>The rconfig package interprets 3 kinds of substitution patterns:
</p>

<ul>
<li><p> environment variables (<code style="white-space: pre;">&#8288;${VALUE}&#8288;</code>): these variables are already present when the configurations is read from the calling environment or from <code>.Renviron</code> file in the project specific or home folder, set variables can be null or not-null
</p>
</li>
<li><p> R global variables (<code style="white-space: pre;">&#8288;@{VALUE}&#8288;</code>): the rconfig package looks for variables in the global environment at the time of configuration evaluation, however, expressions are not evaluated (unlike the <code>!expr</code> option for values)
</p>
</li>
<li><p> configuration values (<code style="white-space: pre;">&#8288;#{VALUE}&#8288;</code>): the configuration level variables are evaluated last, thus these values can refer to existing keys that are already substituted
</p>
</li></ul>

<p>For additional details see the package website at
<a href="https://github.com/analythium/rconfig">https://github.com/analythium/rconfig</a>.
</p>


<h3>Value</h3>

<p>The configuration value (a named list, or an empty list).
When debug mode is on, the <code>"trace"</code> attribute traces the
merged configurations. The <code>value()</code> method returns the value
of a given argument or the default value when it is not found
(i.e. <code>NULL</code>). The <code>command()</code> method returns a character vector
with command line sub-commands (can be of length 0).
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+modifyList">utils::modifyList()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cfile &lt;- function(file) {
    system.file("examples", file, package = "rconfig")
}

rconfig::rconfig()

rconfig::rconfig(
    file = cfile("rconfig.yml"))

rconfig::rconfig(
    file = c(cfile("rconfig.json"),
             cfile("rconfig-prod.txt")),
    list = list(user = list(name = "Jack")))

rconfig::rconfig(
    file = c(cfile("rconfig.json"),
             cfile("rconfig-prod.txt")),
    list = list(user = list(name = "Jack")),
    flatten = TRUE)

CONFIG &lt;- rconfig::rconfig(
    file = cfile("rconfig.yml"))
value(CONFIG$cores, 2L)   # set to 1L
value(CONFIG$test, FALSE) # unset

</code></pre>

<hr>
<h2 id='read_ini'>Read INI Files</h2><span id='topic+read_ini'></span>

<h3>Description</h3>

<p>Read INI (<code>.ini</code> file extension) configuration files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ini(file, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_ini_+3A_file">file</code></td>
<td>
<p>The name and path of the INI configuration file.</p>
</td></tr>
<tr><td><code id="read_ini_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the function (currently there is none).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An INI configuration file consists of sections, each led by a <code style="white-space: pre;">&#8288;[section]&#8288;</code> header,
followed by key/value entries separated by a specific string (<code>=</code> or <code>:</code> by default).
By default, section names are case sensitive but keys are not.
Leading and trailing whitespace is removed from keys and values.
Values can be omitted if the parser is configured to allow it,
in which case the key/value delimiter may also be left out.
Values can also span multiple lines, as long as they are indented deeper than the first line of the value.
Blank lines may be treated as parts of multiline values or ignored.
By default, a valid section name can be any string that does not contain <code style="white-space: pre;">&#8288;\n&#8288;</code> or <code style="white-space: pre;">&#8288;]&#8288;</code>.
Configuration files may include comments, prefixed by specific characters (<code style="white-space: pre;">&#8288;#&#8288;</code> and <code style="white-space: pre;">&#8288;;&#8288;</code> by default).
Comments may appear on their own on an otherwise empty line, possibly indented.
</p>


<h3>Value</h3>

<p>The configuration value a named list,
each element of the list being a section of the INI file.
Each element (section) containing the key-value pairs from the INI file.
When no value is provided in the file, the value is <code>""</code>.
By convention, all values returned by the function are of character type.
R expressions following <code>!expr</code> are evaluated according to the settings of
the <code>R_RCONFIG_EVAL</code> environment variable or the option <code>"rconfig.eval"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>inifile &lt;- system.file("examples", "example.ini", package = "rconfig")

## not evaluating R expressions
op &lt;- options("rconfig.eval" = FALSE)
ini &lt;- rconfig::read_ini(file = inifile)
str(ini)

## evaluating R expressions
options("rconfig.eval" = TRUE)
ini &lt;- rconfig::read_ini(file = inifile)
str(ini)

# reset options
options(op)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
