<!DOCTYPE html><html lang="en"><head><title>Help for package DetR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {DetR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DetR-package'><p> Deterministic and Robust Algorithms for Regression.</p></a></li>
<li><a href='#chis2009'>
<p>CHIS 2009 Adult Health Survey Data</p></a></li>
<li><a href='#DetLTS'><p>Robust and Deterministic Linear Regression via DetLTS</p></a></li>
<li><a href='#DetMM'><p>Robust and Deterministic Linear Regression via DetMM</p></a></li>
<li><a href='#inQn'><p>Test function for the qn</p></a></li>
<li><a href='#inUMCD'><p>Test function for unimcd</p></a></li>
<li><a href='#OGKCStep'><p>Robust and Deterministic Linear Regression via OGKCStep</p></a></li>
<li><a href='#quanf'><p>Converts alpha values to h-values</p></a></li>
<li><a href='#test_function'><p>Test functions for DetR</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Suite of Deterministic and Robust Algorithms for Linear
Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-05-13</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>Imports:</td>
<td>robustbase, MASS, pcaPP</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1),</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp (&ge; 0.10.5), RcppEigen (&ge; 0.3.2.2)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>Description:</td>
<td>DetLTS, DetMM (and DetS) Algorithms for Deterministic, Robust
    Linear Regression.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-19 11:15:53 UTC; kaveh</td>
</tr>
<tr>
<td>Author:</td>
<td>Kaveh Vakili [aut, cre],
  Valentin Todorov [ctb] (modified code originally from the R package
    robustbase: function ltscheckout, LTScnp2 and LTScnp2.rew and from
    robustbase:::.detmcd()),
  Peter Filzmoser [ctb] (translations of the code for computing the Qn
    found in package pcaPP),
  Heinrich Fritz [ctb] (translations of the code for computing the Qn
    found in package pcaPP),
  Klaudius Kalcher [ctb] (translations of the code for computing the Qn
    found in package pcaPP),
  Kjell Konis [ctb] (translations of the code scaleTau2 found in package
    robustbase),
  Martin Maechler [ctb] (translations of the code scaleTau2 found in
    package robustbase),
  Matias Salibian-Barrera [ctb] (modified code for the FastS from the
    authors's website),
  Peter Rousseeuw [ctb] (modified code originally from the R package
    robustbase: function ltscheckout, LTScnp2 and LTScnp2.rew and from
    robustbase:::.detmcd()),
  Katrien van Driessen [ctb] (modified code originally from the R package
    robustbase: function ltscheckout, LTScnp2 and LTScnp2.rew and from
    robustbase:::.detmcd())</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kaveh Vakili &lt;vakili.kaveh.email@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-19 11:35:38 UTC</td>
</tr>
</table>
<hr>
<h2 id='DetR-package'> Deterministic and Robust Algorithms for Regression.</h2><span id='topic+DetR-package'></span>

<h3>Description</h3>

<p>This packages contains various robust and deterministic algorithms
for linear regression.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> DetR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.0.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2012-09-19</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> matrixStats, robustbase, MASS</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index:
</p>
<pre>
DetR-package           Robust and Deterministic Algothms for Linear 
                        Regression
DetLTS                  DetLTS algorithm (deterministic counterpart of FastLTS).
OGKCStep               Tests of OGK+Csteps.
DetMM                  DetMM algorithm (deterministic counterpart of FastMM).
test_function		unit test functions.
</pre>


<h3>Author(s)</h3>

<p>Kaveh Vakili [aut, cre], using translation and modifications of codes
from other packages (see Desrciption and the individual fuctions' helpfiles)
</p>
<p>Maintainer: Kaveh Vakili &lt;vakili.kaveh.email@gmail.com&gt;
</p>

<hr>
<h2 id='chis2009'>
CHIS 2009 Adult Health Survey Data
</h2><span id='topic+chis2009'></span>

<h3>Description</h3>

<p>The <code>chis2009</code> data frame has 17179 rows and 26 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chis2009
</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt><code>ab1</code></dt><dd>
<p>GENERAL HEALTH CONDITION
</p>
</dd>
<dt><code>ac13</code></dt><dd>
<p>NUMBER OF TIMES DRANK FRUIT-FLAV LAST MONTH - UNIT
</p>
</dd>
<dt><code>ac14</code></dt><dd>
<p>NUMBER OF TIMES ATE ICE CREAM/FROZEN DESSERTS LAST MONTH
</p>
</dd>
<dt><code>ad41w</code></dt><dd>
<p>NUMBER OF TIMES WALKED AT LEAST 10 MIN FOR LEISURE PAST 7 DAYS     
</p>
</dd>
<dt><code>ad42w</code></dt><dd>
<p>AVERAGE LENGTH OF TIME WALKED FOR LEISURE
</p>
</dd>
<dt><code>ae2</code></dt><dd>
<p>NUMBER OF TIMES ATE FRUIT IN PAST MO
</p>
</dd>
<dt><code>ae27</code></dt><dd>
<p>NUMBER OF DAYS MODERATE PHYSICAL ACTIVITY IN PAST WEEK
</p>
</dd>
<dt><code>ae27a</code></dt><dd>
<p>TIME PER DAY OF MODERATE PHYSICAL ACTIVITY
</p>
</dd>
<dt><code>ae3</code></dt><dd>
<p>NUMBER OF TIMES ATE FRNCH FRIES, HME FRIES, HSH BRWNS IN PAST
MO
</p>
</dd>
<dt><code>ae7</code></dt><dd>
<p>NUMBER OF TIMES ATE VEGETABLES IN PAST MO
</p>
</dd>
<dt><code>ah5</code></dt><dd>
<p>NUMBER OF TIMES SAW MD IN PAST 12 MOS
</p>
</dd>
<dt><code>ak3</code></dt><dd>
<p>NUMBER OF  USUAL HRS WORKED PER WEEK
</p>
</dd>
<dt><code>ak7</code></dt><dd>
<p>LENGTH OF TIME WORKING AT MAIN JOB
</p>
</dd>
<dt><code>distress</code></dt><dd>
<p>SERIOUS PSYCHOLOGICAL DISTRESS
</p>
</dd>
<dt><code>aheduc</code></dt><dd>
<p>EDUCATIONAL ATTAINMENT
</p>
</dd>
<dt><code>timead</code></dt><dd>
<p>LENGTH OF TIME LIVED AT CURRENT ADDRESS (IN MONTHS)
</p>
</dd>
<dt><code>ak10_p</code></dt><dd>
<p>RESPONDENT'S EARNINGS LAST MONTH
</p>
</dd>
<dt><code>ak22_p</code></dt><dd>
<p>HOUSEHOLD'S TOTAL ANNUAL INC
</p>
</dd>
<dt><code>heighm_p</code></dt><dd>
<p>HEIGHT: METERS
</p>
</dd>
<dt><code>srage_p</code></dt><dd>
<p>AGE
</p>
</dd>
<dt><code>wt18k_p</code></dt><dd>
<p>WEIGHT AT 18: KILOS
</p>
</dd>
<dt><code>sug_past</code></dt><dd>
<p>UNADJUSTED DAILY TEASPOONS OF ADDED SUGAR IN PASTRIES
</p>
</dd>
<dt><code>sug_bev</code></dt><dd>
<p>UNADJUSTED DAILY TEASPOONS OF ADDED SUGAR IN ALL
BEVERAGES
</p>
</dd>
<dt><code>fv_nobns</code></dt><dd>
<p>DAILY CUP EQUIVALENTS OF FRUITS AND VEGETABLES EXCLUDING
BEANS
</p>
</dd>
<dt><code>sugar2</code></dt><dd>
<p>DAILY TEASPOONS OF ADDED SUGAR
</p>
</dd>
<dt><code>Weight</code></dt><dd>
<p>WEIGHT: KG
</p>
</dd>
</dl>



<h3>Details</h3>

<p>The 2009 California Health Interview Survey
(CHIS 2009). The CHIS is a population based telephone survey of California's population.
The survey aims to collect extensive information on health status, health conditions, health 
related behaviors, health insurance coverage as well as access to health care services. Within
each household, separate interviews are conducted with a randomly selected adult (age 18
and over). The dataset consists of 536 features measured for 47614 respondents.
</p>


<h3>Source</h3>

<p>CHIS California Health Interview Survey. Los Angeles (CA). 
UCLA Center for Health Policy Research. <a href="http://www.chis.ucla.edu/">http://www.chis.ucla.edu/</a>.  
</p>

<hr>
<h2 id='DetLTS'>Robust and Deterministic Linear Regression via DetLTS</h2><span id='topic+DetLTS'></span>

<h3>Description</h3>

<p>Function to compute the DetLTS estimates of regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  DetLTS(x, y, intercept = 1, alpha = 0.75, h = NULL, scale_est = "scaleTau2")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DetLTS_+3A_x">x</code></td>
<td>
<p>Matrix of design variables. Never contains an intercept.</p>
</td></tr>
<tr><td><code id="DetLTS_+3A_y">y</code></td>
<td>
<p>Vector of responses.</p>
</td></tr>
<tr><td><code id="DetLTS_+3A_intercept">intercept</code></td>
<td>
<p>A boolean indicating whether the regression contains an intercept.</p>
</td></tr>
<tr><td><code id="DetLTS_+3A_alpha">alpha</code></td>
<td>
<p>numeric parameter controlling the size of the subsets over which the determinant is minimized, i.e., alpha*n observations are used for computing the determinant. Allowed values are between 0.5 and 1 and the default is 0.75. Can be a vector.</p>
</td></tr>
<tr><td><code id="DetLTS_+3A_h">h</code></td>
<td>
<p>Integer in [<code>ceiling((n+p+1)/2)</code>,n) which determines the number of observations which 
are awarded weight in the fitting process. Can be a vector. If both <code>h</code> and <code>alpha</code> are set to non default values,
<code>alpha</code> will be ignored.</p>
</td></tr>
<tr><td><code id="DetLTS_+3A_scale_est">scale_est</code></td>
<td>
<p>A character string specifying the
variance functional.  Possible values are &quot;Qn&quot; or &quot;scaleTau2&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>DetLTS</code> returns a list with as many components as 
there are elements in the <code>h</code>. Each of the entries is a list
containing  the following components:
</p>
<table role = "presentation">
<tr><td><code>crit</code></td>
<td>

<p>the value of the objective function of the LTS regression method,
i.e., the sum of the <code class="reqn">h</code> smallest squared raw residuals.
</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>

<p>vector of coefficient estimates (including the intercept by default when
<code>intercept=TRUE</code>), obtained after reweighting.
</p>
</td></tr>
<tr><td><code>best</code></td>
<td>

<p>the best subset found and used for computing the raw estimates, with
<code><a href="base.html#topic+length">length</a>(best) == quan = <a href="robustbase.html#topic+h.alpha.n">h.alpha.n</a>(alpha,n,p)</code>.
</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>vector like <code>y</code> containing the fitted values
of the response after reweighting.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>vector like <code>y</code> containing the residuals from
the weighted least squares regression.</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>scale estimate of the reweighted residuals.  </p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>same as the input parameter <code>alpha</code>.</p>
</td></tr>
<tr><td><code>quan</code></td>
<td>
<p>the number <code class="reqn">h</code> of observations which have determined
the least trimmed squares estimator.</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p>same as the input parameter <code>intercept</code>.</p>
</td></tr>
<tr><td><code>cnp2</code></td>
<td>
<p>a vector of length two containing the consistency
correction factor and the finite sample correction factor of
the final estimate of the error scale.</p>
</td></tr>
<tr><td><code>raw.coefficients</code></td>
<td>
<p>vector of raw coefficient estimates (including
the intercept, when <code>intercept=TRUE</code>).</p>
</td></tr>
<tr><td><code>raw.scale</code></td>
<td>
<p>scale estimate of the raw residuals.</p>
</td></tr>
<tr><td><code>raw.resid</code></td>
<td>
<p>vector like <code>y</code> containing the raw residuals
from the regression.</p>
</td></tr>
<tr><td><code>raw.cnp2</code></td>
<td>
<p>a vector of length two containing the consistency
correction factor and the finite sample correction factor of the
raw estimate of the error scale.</p>
</td></tr>
<tr><td><code>lts.wt</code></td>
<td>

<p>vector like y containing weights that can be used in a weighted
least squares.  These weights are 1 for points with reasonably
small residuals, and 0 for points with large residuals.
</p>
</td></tr>
<tr><td><code>raw.weights</code></td>
<td>

<p>vector containing the raw weights based on the raw residuals and raw scale.
</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character string naming the method (Least Trimmed Squares).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vakili Kaveh using translation of the C code from pcaPP (by Peter Filzmoser, Heinrich Fritz, Klaudius Kalcher, see citation(&quot;pcaPP&quot;)) for 
the Qn and scaleTau2 (Original by Kjell Konis with substantial modifications by Martin Maechler)  from robustbase
(see citation(&quot;scaleTau2&quot;))
as well as R code from function ltsReg in package robustbase (originally written by Valentin Todorov valentin.todorov@chello.at, based on work written for S-plus by Peter Rousseeuw and Katrien van Driessen from
University of Antwerp, see citation(&quot;ltsReg&quot;)).
</p>


<h3>References</h3>

<p>Vakili K. (2016). A study and implementation of robust estimators for 
multivariate and functional data (Doctoral dissertation). 	
</p>
<p>Maronna, R.A. and Zamar, R.H. (2002) Robust estimates of location
and dispersion of high-dimensional datasets; <em>Technometrics</em>
<b>44</b>(4), 307&ndash;317.
</p>
<p>Rousseeuw, P.J. and Croux, C. (1993) Alternatives to the Median Absolute Deviation; 
<em>Journal of the American Statistical Association</em> , <b>88</b>(424), 1273&ndash;1283.
</p>
<p>Peter J. Rousseeuw (1984), Least Median of Squares Regression.
<em>Journal of the American Statistical Association</em> <b>79</b>, 871&ndash;881.
</p>
<p>P. J. Rousseeuw and A. M. Leroy (1987)
<em>Robust Regression and Outlier Detection.</em> Wiley.
</p>
<p>P. J. Rousseeuw and K. van Driessen (1999)
A fast algorithm for the minimum covariance determinant estimator.
<em>Technometrics</em> <b>41</b>, 212&ndash;223.
</p>
<p>Pison, G., Van Aelst, S., and Willems, G. (2002)
Small Sample Corrections for LTS and MCD.
<em>Metrika</em> <b>55</b>, 111-123.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-100
h&lt;-c(55,76,89)
set.seed(123)# for reproducibility
x0&lt;-matrix(rnorm(n*2),nc=2)
y0&lt;-rnorm(n)
out1&lt;-DetLTS(x0,y0,h=h)
</code></pre>

<hr>
<h2 id='DetMM'>Robust and Deterministic Linear Regression via DetMM</h2><span id='topic+DetMM'></span>

<h3>Description</h3>

<p>Function to compute the DetMM estimates of regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  DetMM(x,y,intercept=1,alpha=0.75,h=NULL,scale_est="scaleTau2",tuning.chi=1.54764,
tuning.psi=4.685061)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DetMM_+3A_x">x</code></td>
<td>
<p>Matrix of design variables. Never contains an intercept.</p>
</td></tr>
<tr><td><code id="DetMM_+3A_y">y</code></td>
<td>
<p>Vector of responses.</p>
</td></tr>
<tr><td><code id="DetMM_+3A_intercept">intercept</code></td>
<td>
<p>A boolean indicating whether the regression contains an intercept.</p>
</td></tr>
<tr><td><code id="DetMM_+3A_alpha">alpha</code></td>
<td>
<p>numeric parameter controlling the size of the subsets over which the determinant is minimized, i.e., alpha*n observations are used for computing the determinant. Allowed values are between 0.5 and 1 and the default is 0.75. Can be a vector.</p>
</td></tr>
<tr><td><code id="DetMM_+3A_h">h</code></td>
<td>
<p>Integer in [<code>ceiling((n+p+1)/2)</code>,n) which determines the number of observations which 
are awarded weight in the fitting process. Can be a vector. If both <code>h</code> and <code>alpha</code> are set to non default values,
<code>alpha</code> will be ignored.</p>
</td></tr>
<tr><td><code id="DetMM_+3A_scale_est">scale_est</code></td>
<td>
<p>A character string specifying the
variance functional.  Possible values are &quot;Qn&quot; or &quot;scaleTau2&quot;.</p>
</td></tr>
<tr><td><code id="DetMM_+3A_tuning.chi">tuning.chi</code></td>
<td>
<p>tuning constant vector for the bi-weight chi used for the ISteps.</p>
</td></tr>
<tr><td><code id="DetMM_+3A_tuning.psi">tuning.psi</code></td>
<td>
<p>tuning constant vector for the bi-weight psi used for the MSteps.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code>DetLTS</code> returns a list with as many components as 
there are elements in the <code>h</code>. Each of the entries is a list
containing  the following components:
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>The estimate of the coefficient vector</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p>The scale as used in the M steps.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>Residuals associated with the estimator.</p>
</td></tr>

<tr><td><code>converged</code></td>
<td>
<p><code>TRUE</code> if the IRWLS iterations have converged.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>number of IRWLS iterations</p>
</td></tr>
<tr><td><code>rweights</code></td>
<td>
<p>the &ldquo;robustness weights&rdquo; <code class="reqn">\psi(r_i/S) / (r_i/S)</code>.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>Fitted values associated with the estimator.</p>
</td></tr>
<tr><td><code>DetS</code></td>
<td>
<p>A similar list that contains the results of (initial) returned by DetS</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vakili Kaveh using translation of the C code from pcaPP (by Peter Filzmoser, Heinrich Fritz, Klaudius Kalcher, see citation(&quot;pcaPP&quot;)) for 
the Qn and scaleTau2 (Original by Kjell Konis with substantial modifications by Martin Maechler)  from robustbase
(see citation(&quot;scaleTau2&quot;)). This function calls lmrob in package robustbase.
</p>


<h3>References</h3>

<p>Maronna, R.A. and Zamar, R.H. (2002) Robust estimates of location
and dispersion of high-dimensional datasets; <em>Technometrics</em>
<b>44</b>(4), 307&ndash;317.
</p>
<p>Rousseeuw, P.J. and Croux, C. (1993) Alternatives to the Median Absolute Deviation; 
<em>Journal of the American Statistical Association</em> , <b>88</b>(424), 1273&ndash;1283.
</p>
<p>Croux, C., Dhaene, G. and Hoorelbeke, D. (2003)
<em>Robust standard errors for robust estimators</em>,
Discussion Papers Series 03.16, K.U. Leuven, CES.
</p>
<p>Koller, M. (2012), Nonsingular subsampling for S-estimators with
categorical predictors, <em>ArXiv e-prints</em>, arXiv:1208.5595v1.
</p>
<p>Koller, M. and Stahel, W.A. (2011), Sharpening Wald-type inference in
robust regression for small samples, <em>Computational Statistics &amp;
Data Analysis</em> <b>55</b>(8), 2504&ndash;2515.
</p>
<p>Maronna, R. A., and Yohai, V. J. (2000).
Robust regression with both continuous and categorical predictors.
<em>Journal of Statistical Planning and Inference</em> <b>89</b>, 197&ndash;214.
</p>
<p>Rousseeuw, P.J. and Yohai, V.J. (1984)
Robust regression by means of S-estimators,
In <em>Robust and Nonlinear Time Series</em>,
J. Franke, W. Hardle and R. D. Martin (eds.).
Lectures Notes in Statistics 26, 256&ndash;272,
Springer Verlag, New York.
</p>
<p>Salibian-Barrera, M. and Yohai, V.J. (2006)
A fast algorithm for S-regression estimates,
<em>Journal of Computational and Graphical Statistics</em>,
<b>15</b>(2), 414&ndash;427.
</p>
<p>Yohai, V.J. (1987)
High breakdown-point and high efficiency estimates for regression.
<em>The Annals of Statistics</em> <b>15</b>, 642&ndash;65.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## generate data
set.seed(1234)  # for reproducibility
n&lt;-100
h&lt;-c(55,76,89)
set.seed(123)
x0&lt;-matrix(rnorm(n*2),nc=2)
y0&lt;-rnorm(n)
out1&lt;-DetMM(x0,y0,h=h)
</code></pre>

<hr>
<h2 id='inQn'>Test function for the qn</h2><span id='topic+inQn'></span>

<h3>Description</h3>

<p>Test function for the qn used in DetR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  inQn(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inQn_+3A_x">x</code></td>
<td>
<p>Vector of 2 or more numbers. Should contain no ties.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the value of the qn estimator of scale.
</p>


<h3>Author(s)</h3>

<p>Kaveh Vakili. Calls code translated from the cde for computing the Qn found in 
package pcaPP (by  Peter Filzmoser, Heinrich Fritz, Klaudius Kalcher , see citation(&quot;pcaPP&quot;)).
</p>


<h3>References</h3>

<p>see <code>pcaPP::qn</code> and citation(&quot;pcaPP&quot;).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)	#for reproductibility
x&lt;-rnorm(101)
inQn(x)
#should be the same:
pcaPP::qn(x)
</code></pre>

<hr>
<h2 id='inUMCD'>Test function for unimcd</h2><span id='topic+inUMCD'></span>

<h3>Description</h3>

<p>Test function for the unimcd used in DetR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  inUMCD(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inUMCD_+3A_x">x</code></td>
<td>
<p>Vector of 2 or more numbers. Should contain no ties.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the value of the unimcd estimator of scale.
</p>


<h3>Author(s)</h3>

<p>Kaveh Vakili
</p>


<h3>References</h3>

<p>Rousseeuw, P. J. (1984), Least Median of Squares Regression, Journal of the American Statistical Association,79,
871&ndash;880. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)	#for reproductibility
x&lt;-rnorm(101)
inUMCD(x)
</code></pre>

<hr>
<h2 id='OGKCStep'>Robust and Deterministic Linear Regression via OGKCStep</h2><span id='topic+OGKCStep'></span>

<h3>Description</h3>

<p>Function to find the OGKCStep ('best') H-subset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  OGKCStep(x0, scale_est, alpha=0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="OGKCStep_+3A_x0">x0</code></td>
<td>
<p>Matrix of continuous variables. </p>
</td></tr>
<tr><td><code id="OGKCStep_+3A_alpha">alpha</code></td>
<td>
<p>numeric parameter controlling the size of the subsets over which the determinant is minimized, i.e., alpha*n observations are used for computing the determinant. Allowed values are between 0.5 and 1 and the default is 0.5.</p>
</td></tr>
<tr><td><code id="OGKCStep_+3A_scale_est">scale_est</code></td>
<td>
<p>A character string specifying the
variance functional.  Possible values are Qn or scaleTau2.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>best</code></td>
<td>

<p>the best subset found and used for computing the raw estimates, with
<code><a href="base.html#topic+length">length</a>(best) == quan = <a href="robustbase.html#topic+h.alpha.n">h.alpha.n</a>(alpha,n,p)</code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Large part of the the code are from function <code>.detmcd</code> in package robustbase , 
, see citation(&quot;robustbase&quot;)
</p>


<h3>References</h3>

<p>Maronna, R.A. and Zamar, R.H. (2002) Robust estimates of location
and dispersion of high-dimensional datasets; <em>Technometrics</em>
<b>44</b>(4), 307&ndash;317.
</p>
<p>Rousseeuw, P.J. and Croux, C. (1993) Alternatives to the Median Absolute Deviation; 
<em>Journal of the American Statistical Association</em> , <b>88</b>(424), 1273&ndash;1283.
</p>
<p>Peter J. Rousseeuw (1984), Least Median of Squares Regression.
<em>Journal of the American Statistical Association</em> <b>79</b>, 871&ndash;881.
</p>
<p>P. J. Rousseeuw and A. M. Leroy (1987)
<em>Robust Regression and Outlier Detection.</em> Wiley.
</p>
<p>P. J. Rousseeuw and K. van Driessen (1999)
A fast algorithm for the minimum covariance determinant estimator.
<em>Technometrics</em> <b>41</b>, 212&ndash;223.
</p>
<p>Pison, G., Van Aelst, S., and Willems, G. (2002)
Small Sample Corrections for LTS and MCD.
<em>Metrika</em> <b>55</b>, 111&ndash;123.
</p>
<p>Hubert, M., Rousseeuw, P. J. and Verdonck, T. (2012) A deterministic algorithm for robust location
and scatter. <em>Journal of Computational and Graphical Statistics</em>
<b>21</b>, 618&ndash;637.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-100
set.seed(123)# for reproducibility
x0&lt;-matrix(rnorm(n*2),nc=2)
out1&lt;-OGKCStep(x0,alpha=0.5,scale_est=pcaPP::qn)

#comparaison with DetMCD:

#a) create data

set.seed(123456)
Simulation&lt;-DetR:::fx01()
#should be \approx 10
sqrt(min(mahalanobis(Simulation$Data[Simulation$label==0,],rep(0,ncol(Simulation$Data)),
Simulation$Sigma_u))/qchisq(0.975,df=ncol(Simulation$Data)))
a0&lt;-eigen(Simulation$Sigma_u)
Su_ih&lt;-(a0$vector)%*%diag(1/sqrt(a0$values))%*%t(a0$vector)
#run algorithms 
A0&lt;-robustbase::covMcd(Simulation$Data,nsamp='deterministic',scalefn=pcaPP::qn,alpha=0.5)
A1&lt;-OGKCStep(Simulation$Data,alpha=0.5,scale_est=pcaPP::qn)
#getbiases algorithms 
SB&lt;-eigen(Su_ih%*%var(Simulation$Data[A1,])%*%Su_ih)$values
log10(SB[1]/SB[ncol(Simulation$Data)-1])
SB&lt;-eigen(Su_ih%*%var(Simulation$Data[A0$best,])%*%Su_ih)$values
log10(SB[1]/SB[ncol(Simulation$Data)-1])
</code></pre>

<hr>
<h2 id='quanf'>Converts alpha values to h-values</h2><span id='topic+quanf'></span>

<h3>Description</h3>

<p>DetLTS selects the subset of size h that minimizes the log-determinant criterion. 
The function <code>quanf</code> determines the size of h based on the rate of contamination
the user expects is present in the data.
This is an internal function not intended to be called 
by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  quanf(n,p,alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quanf_+3A_n">n</code></td>
<td>
<p>Number of rows of the data matrix.</p>
</td></tr>
<tr><td><code id="quanf_+3A_p">p</code></td>
<td>
<p>Number of columns of the data matrix.</p>
</td></tr>
<tr><td><code id="quanf_+3A_alpha">alpha</code></td>
<td>
<p>Numeric parameter controlling the size of the active subsets,
i.e., <code>"h=quanf(alpha,n,p)"</code>.  Allowed
values are between 0.5 and 1 and the default is 0.5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer number of the size of the starting p-subsets.
</p>


<h3>Author(s)</h3>

<p>Kaveh Vakili
</p>


<h3>Examples</h3>

<pre><code class='language-R'>quanf(p=3,n=500,alpha=0.5)
</code></pre>

<hr>
<h2 id='test_function'>Test functions for DetR</h2><span id='topic+test_function'></span>

<h3>Description</h3>

<p>Functions to test the <code>cpp</code> codes in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  test_function()
</code></pre>


<h3>Details</h3>

<p>This is a series of <code>R</code> functions that, together, implement the <code>c++</code> codes used 
in the package and which can be used to test those.
</p>


<h3>Author(s)</h3>

<p>Vakili Kaveh.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-100
p&lt;-5
#set.seed(123) #for repoducibility.
Z&lt;-matrix(rnorm(n*(p+1)),nc=p+1)
x&lt;-Z[,1:p]
y&lt;-Z[,p+1]
datao&lt;-cbind(x,y)
alpha&lt;-0.6;
test_R_0&lt;-DetR:::test_fxOGK(x0=x,y0=y,cent_est='scaleTau2_test',scal_est='scaleTau2_test',
alpha=alpha)
h&lt;-DetR:::quanf(alpha,n=n,p=p+1)	#intercept=1
test_cpp&lt;-DetR:::fxOGK(Data=datao,scale_est="scaleTau2",intercept=1,h=h,doCsteps=1)
####should be the same
sort(test_cpp$bestRaw)
sort(as.numeric(test_R_0$bestRaw))
#############
test_R_1&lt;-DetR:::test_Cstep(x=x,y=y,h=h,z0=test_R_0$bestRaw)
####should be the same
sort(test_R_1$bestCStep)
sort(test_cpp$bestCStep[1:h])




####################################
n&lt;-100
p&lt;-5
set.seed(123) #for repoducibility.
Z&lt;-matrix(rnorm(n*(p+1)),nc=p+1)
x&lt;-Z[,1:p]
y&lt;-Z[,p+1]
datao&lt;-cbind(x,y)
alpha&lt;-0.6;
test_R_0&lt;-DetR:::test_fxOGK(x0=x,y0=y,cent_est='median',scal_est='qn',
alpha=alpha)
h&lt;-DetR:::quanf(alpha,n=n,p=p+1)	#intercept=1
test_cpp&lt;-DetR:::fxOGK(Data=datao,scale_est="qn",intercept=1,h=h,doCsteps=1)
####should be the same
sort(test_cpp$bestRaw)
sort(as.numeric(test_R_0$bestRaw))
#############
test_R_1&lt;-DetR:::test_Cstep(x=x,y=y,h=h,z0=test_R_0$bestRaw)
####should be the same
sort(test_R_1$bestCStep)
sort(test_cpp$bestCStep[1:h])
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
