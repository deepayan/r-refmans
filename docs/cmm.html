<!DOCTYPE html><html><head><title>Help for package cmm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cmm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#acl'><p>Adjective Checklist Data</p></a></li>
<li><a href='#Antisemitism'><p>Change in antisemitism after seeing a movie</p></a></li>
<li><a href='#BodySatisfaction'><p>Body satisfaction for seven body parts</p></a></li>
<li><a href='#ClarenceThomas'><p>Opinion on Supreme Court nominee Clarence Thomas, two-wave panel study</p></a></li>
<li><a href='#cmm-package'>
<p>Categorical Marginal Models</p></a></li>
<li><a href='#ConstraintMatrix'><p>ConstraintMatrix</p></a></li>
<li><a href='#DesignMatrix'><p>DesignMatrix</p></a></li>
<li><a href='#DirectSum'><p>DirectSum</p></a></li>
<li><a href='#DutchConcern'><p>Concern about crime and social security in the Netherlands</p></a></li>
<li><a href='#DutchPolitics'><p>Political party and candidate preference in the Netherlands</p></a></li>
<li><a href='#ErieCounty'><p>Erie County political preference, two-wave panel</p></a></li>
<li><a href='#EVS'><p>European Values Study (EVS): attitude towards women's role in society</p></a></li>
<li><a href='#GSS93'><p>Political Orientation and Religion in the United States in 1993 (General Social Survey, 1993)</p></a></li>
<li><a href='#JoinModels'><p>JoinModels</p></a></li>
<li><a href='#LaborParticipation'><p>Women's labor participation: 1967-1971</p></a></li>
<li><a href='#MarginalMatrix'><p>MarginalMatrix</p></a></li>
<li><a href='#MarginalModelFit'><p>MarginalModelFit</p></a></li>
<li><a href='#Margins'><p>Margins</p></a></li>
<li><a href='#MarihuanaAlcohol'><p>Marihuana and alcohol use during adolescence, five-wave panel</p></a></li>
<li><a href='#ModelStatistics'><p>ModelStatistics</p></a></li>
<li><a href='#NES'><p>Political Orientation in the US, three-wave panel study</p></a></li>
<li><a href='#NKPS'><p>Attitudes on sex roles and marriage, measurements clustered in families</p></a></li>
<li><a href='#RecordsToFrequencies'><p>RecordsToFrequencies</p></a></li>
<li><a href='#SampleStatistics'><p>SampleStatistics</p></a></li>
<li><a href='#Smoking'><p>Smoking cessation after experimental intervention</p></a></li>
<li><a href='#SpecifyCoefficient'><p>SpecifyCoefficient</p></a></li>
<li><a href='#TestCronbachAlpha'><p>Testing Cronbach's alpha using marginal models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Categorical Marginal Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-08</td>
</tr>
<tr>
<td>Description:</td>
<td>Quite extensive package for maximum likelihood estimation and
    weighted least squares estimation of categorical marginal models (CMMs;
    e.g., Bergsma and Rudas, 2002, &lt;http://www.jstor.org/stable/2700006?;
    Bergsma, Croon and Hagenaars, 2009, &lt;<a href="https://doi.org/10.1007%2Fb12532">doi:10.1007/b12532</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-08 10:20:08 UTC; lvdark1</td>
</tr>
<tr>
<td>Author:</td>
<td>W. P. Bergsma [aut],
  L. A. van der Ark [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>L. A. van der Ark &lt;L.A.vanderArk@uva.nl&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-09 17:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='acl'>Adjective Checklist Data</h2><span id='topic+acl'></span>

<h3>Description</h3>

<p>Scores of 433 students on 218 items from a Dutch version of the Adjective Checklist.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(acl)</code></pre>


<h3>Format</h3>

<p>A 433 by 218 matrix containing integers. <code>dimnames(acl)[[2]]</code> are adjectives
</p>


<h3>Details</h3>

<p>Each item is an adjective with five ordered answer categories 
(0 = completely disagree, 1 = disagree, 2 = agree nor disagree, 3 = agree, 4 = completely agree).
The respondents were instructed to consider whether an adjective described their 
personality, and mark the answer category that fits best to this description.
The 218 items constitute 22 scales (see table); 
77 items of the 218 items that constitute the ten scales were negatively worded.
The negatively worded items are indicated by an asterisk in the <code>dimnames</code>
and their item scores have been reversed. The Deference scale measures in fact the opposite of Deference.
</p>

<table>
<tr>
 <td style="text-align: left;">
Communality </td><td style="text-align: left;"> Items 1-10    </td><td style="text-align: center;"> </td><td style="text-align: left;"> Change              </td><td style="text-align: left;">  Items 111-119 </td>
</tr>
<tr>
 <td style="text-align: left;">
Achievement </td><td style="text-align: left;"> Items 11-20   </td><td style="text-align: center;"> </td><td style="text-align: left;"> Succorance          </td><td style="text-align: left;">  Items 120-129 </td>
</tr>
<tr>
 <td style="text-align: left;">
Dominance   </td><td style="text-align: left;"> Items 21-30   </td><td style="text-align: center;"> </td><td style="text-align: left;"> Abasement           </td><td style="text-align: left;">  Items 130-139 </td>
</tr>
<tr>
 <td style="text-align: left;">
Endurance   </td><td style="text-align: left;"> Items 31-40   </td><td style="text-align: center;"> </td><td style="text-align: left;"> Deference*          </td><td style="text-align: left;">  Items 140-149 </td>
</tr>
<tr>
 <td style="text-align: left;">
Order       </td><td style="text-align: left;"> Items 41-50   </td><td style="text-align: center;"> </td><td style="text-align: left;"> Personal Adjustment </td><td style="text-align: left;">  Items 150-159 </td>
</tr>
<tr>
 <td style="text-align: left;">
Intraception</td><td style="text-align: left;"> Items 51-60   </td><td style="text-align: center;"> </td><td style="text-align: left;"> Ideal Self          </td><td style="text-align: left;">  Items 160-169 </td>
</tr>
<tr>
 <td style="text-align: left;">
Nurturance  </td><td style="text-align: left;"> Items 61-70   </td><td style="text-align: center;"> </td><td style="text-align: left;"> Critical parent     </td><td style="text-align: left;">  Items 170-179 </td>
</tr>
<tr>
 <td style="text-align: left;">
Affiliation </td><td style="text-align: left;"> Items 71-80   </td><td style="text-align: center;"> </td><td style="text-align: left;"> Nurturant parent    </td><td style="text-align: left;">  Items 180-189 </td>
</tr>
<tr>
 <td style="text-align: left;">
Exhibition  </td><td style="text-align: left;"> Items 81-90   </td><td style="text-align: center;"> </td><td style="text-align: left;"> Adult               </td><td style="text-align: left;">  Items 190-199 </td>
</tr>
<tr>
 <td style="text-align: left;">
Autonomy    </td><td style="text-align: left;"> Items 91-100  </td><td style="text-align: center;"> </td><td style="text-align: left;"> Free Child          </td><td style="text-align: left;">  Items 200-209 </td>
</tr>
<tr>
 <td style="text-align: left;">
Aggression  </td><td style="text-align: left;"> Items 101-110 </td><td style="text-align: center;"> </td><td style="text-align: left;"> Adapted Child       </td><td style="text-align: left;">  Items 210-218 </td>
</tr>

</table>



<h3>Source</h3>

<p>Data were kindly made available by H. C. M. Vorst from the University of Amsterdam.
The original Adjective Checklist was developed by Gough and Heilbrun (1980).
</p>


<h3>References</h3>

<p>Gough, H. G., &amp; Heilbrun,A. B. (1980) 
<em>The Adjective Check List, Manual 1980 Edition</em>.
Consulting Psychologists Press.
</p>
<p>Van der Ark, L. A. (2007) 
Mokken scale analysis in <span class="pkg">R</span>. 
<em>Journal of Statistical Software</em>.
<a href="https://doi.org/10.18637/jss.v020.i11">doi:10.18637/jss.v020.i11</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(acl)
dat &lt;- acl + 1   # CMM requires scores starting at 1.
</code></pre>

<hr>
<h2 id='Antisemitism'>Change in antisemitism after seeing a movie</h2><span id='topic+Antisemitism'></span>

<h3>Description</h3>

<p>A classical data set that has been used several times in the past, but not analyzed by means
of the methods advocated in this book (Glock, 1955; Campbell &amp; Clayton, 1961; Hagenaars, 1990,
pp. 215-233, and Hagenaars, 1990, Section 5.3). The data are from a panel study among 503
white Christians living in and around Baltimore. The study's purpose was to determine the
effect of seeing the film &lsquo;Gentleman&rsquo;s Agreement' on reducing the level of antisemitism
(Glock, 1955, p. 243). Antisemitism was measured in November 1947 (variable <code class="reqn">A</code>) prior to the
movie being locally shown and consisted of three categories : 1 = high, 2 = moderate, and
3 = low. Antisemitism was measured again in May 1948 (variable <code class="reqn">B</code>). In addition, the respondents
were asked whether or not they had (voluntary) seen the movie, which had been shown in Baltimore
theaters during the period between the two interviews (variable <code class="reqn">X</code>). The experimental group (with
<code class="reqn">X=1</code>) consisted of those respondents who saw the movie; the control group (with <code class="reqn">X=2</code>)
consisted of those who did not. The data are tabulated in Bergsma, Croon, and Hagenaars (2009, Table 5.8).
</p>
<p>Section 5.2.2 in Bergsma, Croon, and Hagenaars (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GSS93)</code></pre>


<h3>Format</h3>

<p>A data frame with 496 observations on the following three variables.
</p>

<dl>
<dt><code>X</code></dt><dd><p>Seen the film (factor):
1 = Seen;
2 = Not seen;
</p>
</dd>
<dt><code>A</code></dt><dd><p>Antisemitism at Time 1 (ordered):
1 = High;
2 = Moderate;
3 = Low.
</p>
</dd>
<dt><code>B</code></dt><dd><p>Antisemitism at Time 2 (ordered):
1 = High;
2 = Moderate;
3 = Low.
</p>
</dd>
</dl>



<h3>Source</h3>

<p>Glock (1955).
</p>


<h3>References</h3>

<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>
<p>Campell &amp; Clayton (1961)
</p>
<p>Glock (1955)
</p>
<p>Hagenaars, 1990
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Antisemitism)

## Sample marginal distributions
# at applied to data gives vectorized 2x2x3 table TXR (Time x Seen film or not x Response)
at &lt;- MarginalMatrix(c("X","A","B"), list(c("X","A"), c("X","B")), c(2,3,3));
stats = SampleStatistics(
  dat = Antisemitism, 
  coeff = at, 
  Labels = c("T","X","R"), 
  CoefficientDimensions = c(2,2,3))

## Models for table XR given T

# at1 applied to data gives vectorized conditional 2x3 table XR (XR conditional on T&lt;-1)
at1 &lt;- MarginalMatrix(c("X", "A", "B"), list(c("X", "A")), c(2, 3, 3));
# at2 applied to data gives vectorized conditional 2x3 table XR (XR conditional on T&lt;-2)
at2 &lt;- MarginalMatrix(c("X", "A", "B"), list(c("X", "B")), c(2, 3, 3));

bt1 &lt;- ConstraintMatrix(c("X", "R"), list(c("X"), c("R")), c(2, 3));
bt2 &lt;- ConstraintMatrix(c("X", "R"), list(c("X"), c("R")), c(2, 3));

model1 &lt;- list(bt1, "log", at1);
model2 &lt;- list(bt2, "log", at2);

# model1 doesn't converge, I don't know the reason and am trying to find out 
# (it does converge in the Mathematica programme).
fit = MarginalModelFit(
 dat = Antisemitism, 
 model = model2, 
 Labels = c("X","R"), 
 CoefficientDimensions = c(2,3), 
 MaxSteps=100, 
 ShowProgress=10,
 MaxStepSize=.5)
</code></pre>

<hr>
<h2 id='BodySatisfaction'>Body satisfaction for seven body parts</h2><span id='topic+BodySatisfaction'></span>

<h3>Description</h3>

<p>A group of 301 university students (204 women and 97 men) answered questions about their degrees of
satisfaction with different parts or aspects of their body by completing the Body Esteem Scale
(Franzoi &amp; Shields, 1984; Bekker, Croon, &amp; Vermaas, 2002). This scale consisted of 22 items (not counting
the items concerning gender-specific body parts), seven of which will be considered here.
These seven items loaded highest on the first unrotated principal component, with loadings higher than .70.
Principal component analysis was used to discover whether the separate expressions of satisfaction with
the different body aspects can be seen as just an expression of the general underlying satisfaction with
the body as a whole or whether more underlying dimensions are needed
(for the interested reader: two rotated factors were needed to explain the correlations among
all the 22 items, one having to do with the general appearance of the body and the other with the
satisfaction with the parts of one's face; the items chosen here all belong to the first factor.)
The data are tabulated in Bergsma, Croon, and Hagenaars (2009, Table 2.5, Table 2.7).
</p>
<p>See Sections 2.2.2 and 3.1 of Bergsma, Croon, and Hagenaars (2009).
</p>
<p>Several worked examples involving this data set are listed below but more can be found at http://stats.lse.ac.uk/bergsma/cmm/R files/BodySatisfaction.R</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BodySatisfaction)</code></pre>


<h3>Format</h3>

<p>A data frame with 301 observations on the following variables.
</p>

<dl>
<dt><code>Gender</code></dt><dd><p>(factor):
0 = Male;
1 = Female.
</p>
</dd>
<dt><code>Thighs</code></dt><dd><p>(ordered):
1 = Very dissatisfied;
2 = Moderately dissatisfied;
3 = Slightly satisfied.
4 = Moderately satisfied.
5 = Very satisfied.
</p>
</dd>
<dt><code>BodyBuild</code></dt><dd><p>(ordered): see <code>Thighs</code></p>
</dd>
<dt><code>Buttocks</code></dt><dd><p>(ordered): see <code>Thighs</code></p>
</dd>
<dt><code>Hips</code></dt><dd><p>(ordered): see <code>Thighs</code></p>
</dd>
<dt><code>Legs</code></dt><dd><p>(ordered): see <code>Thighs</code></p>
</dd>
<dt><code>Figure</code></dt><dd><p>(ordered): see <code>Thighs</code></p>
</dd>
<dt><code>Weight</code></dt><dd><p>(ordered): see <code>Thighs</code></p>
</dd>
</dl>



<h3>Source</h3>

<p>Bekker, Croon, &amp; Vermaas (2002).
</p>


<h3>References</h3>

<p>Bekker, M.H.J., Croon, M.A., &amp; Vermaas, S. (2002).
Inner body and outward appearance- the relationship between orientation toward outward appearance, body awareness and symptom perception.
<em>Personality and Individual Differences, 33</em>, 213-225.
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>
New York: Springer.
</p>
<p>Franzoi, S.L. &amp; Shields, S.A. (1984).
The Body-Esteem Scale: Multidimensional structure and sex differences in a college population.
<em>Journal of Personality Assessment, 48</em>, 173-178.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BodySatisfaction)

## Reproduction of Table 2.5 in Bergsma, Croon, &amp; Hagenaars (2009)
sapply(2:8,function(i){table(BodySatisfaction[,i])})

## Table 2.6 in Bergsma, Croon and Hagenaars (2009). 
## Loglinear parameters for marginal table IS
## We provide two to obtain the parameters

## Reproduction of Table 2.7 in Bergsma, Croon, &amp; Hagenaars (2009)
Table.2.7.male &lt;- 
 sapply(2:8,function(i){table(BodySatisfaction[BodySatisfaction[1]=="Male",i])})
Table.2.7.male
#totals
apply(Table.2.7.male,2,sum)                               
#means
apply(Table.2.7.male,2,function(x){sum(c(1:5)*x/sum(x))}) 
#standard deviations
sqrt(apply(Table.2.7.male,2,function(x){(sum(c(1:5)^2*x/sum(x)))-(sum(c(1:5)*x/sum(x)))^2}))
                                                           

## Not run: 
dat   &lt;- BodySatisfaction[,2:8]        # omit first column corresponding to gender

# matrix producing 1-way marginals, ie the 7x5 table IS
at75 &lt;- MarginalMatrix(var = c(1, 2, 3, 4, 5, 6, 7), 
  marg = list(c(1),c(2),c(3),c(4),c(5),c(6),c(7)), 
  dim = c(5, 5, 5, 5, 5, 5, 5))
# First method: the "coefficients" are the log-probabilities, 
# from which all the (loglinear) parameters are calculated
stats &lt;- SampleStatistics(dat = dat, 
  coeff = list("log", at75), 
  CoefficientDimensions=c(7, 5),
  Labels=c("I", "S"),
  ShowCoefficients = FALSE,
  ShowParameters = TRUE)

 # Second method: the "coefficients" are explicitly specified as being the 
 # (highest-order) loglinear parameters
 loglinpar75 &lt;- SpecifyCoefficient("LoglinearParameters", c(7,5) )
 stats = SampleStatistics(dat = dat, 
  coeff = list(loglinpar75, at75), 
  CoefficientDimensions = c(7, 5), 
  Labels = c("I", "S"))

## End(Not run)
#For further worked examples from the book, 
# see http://stats.lse.ac.uk/bergsma/cmm/R files/BodySatisfaction.R
</code></pre>

<hr>
<h2 id='ClarenceThomas'>Opinion on Supreme Court nominee Clarence Thomas, two-wave panel study</h2><span id='topic+ClarenceThomas'></span>

<h3>Description</h3>

<p>Clarence Thomas was nominated in 1991 as member of the U.S. Supreme Court by President George H. W. Bush.
The nomination provoked some public debate because of Clarence Thomas' race (black) and because of his
allegedly extremely conservative social and political views. A panel of U.S.citizens was interviewed
regarding their opinion on Clarence Thomas' candidacy during September 3-5 (A) and on October 9 (B).
After the first wave, more precisely on September 25, a charge of sexual harassment was brought against
Clarence Thomas by his former aide, Anita Hill. Source: CBS News and New York Times 2001.
</p>
<p>The data are tabulated in Bergsma, Croon, and Hagenaars (2009, Table 5.6) and were also used in
Bergsma &amp; Croon (2005).
</p>
<p>Section 5.2.1 in Bergsma, Croon, and Hagenaars (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ClarenceThomas)</code></pre>


<h3>Format</h3>

<p>A data frame with 991 observations on the following variables.
</p>

<dl>
<dt><code>A</code></dt><dd><p>Opinion on Clarence Thomas during first wave, Sept 3-5, 1991  (factor):
1 = Favorable;
2 = Unfavorable;
3 = Undecided;
4 = Haven't heard enough;
</p>
</dd>
<dt><code>B</code></dt><dd><p>Opinion on Clarence Thomas during second wave, Oct 9, 1991  (factor):
1 = Favorable;
2 = Unfavorable;
3 = Undecided;
4 = Haven't heard enough;
</p>
</dd>
</dl>



<h3>Source</h3>

<p>CBS News and New York Times 2001.
</p>


<h3>References</h3>

<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>
Berlin: Springer
</p>
<p>Bergsma, W. P., &amp; Croon, M. A. (2005).
Analyzing categorical data by marginal models.
In L. A. van der Ark, M. A. Croon, &amp; K. Sijtsma (Eds.),
<em>New developments in categorical data analysis for the social and behavioral sciences.</em>
Mahwah, NJ: Erlbaum.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ClarenceThomas)

################################################################
## Marginal homogeneity: O1=O2

# at24 produces vectorized 2x4 table TR (Time x Response)
at24 &lt;- MarginalMatrix(c("A", "B"), list(c("A"), c("B")), c(4, 4));

# marginal homogeneity
bt1 &lt;- ConstraintMatrix(c("T", "R"), list(c("T"), c("R")), c(2, 4));
model1 &lt;- list(bt1, "log", at24);

# only first two categories are equated
bt2 &lt;- rbind(
   c(1, 0, 0, 0,  -1, 0, 0, 0),
   c(0, 1, 0, 0,   0,-1, 0, 0));
model2 &lt;- c(bt2, "log", at24);

pi11 &lt;- MarginalModelFit(ClarenceThomas, model1,
    MaxSteps = 500,
    ShowProgress = 20,
    MaxStepSize = .5,
    CoefficientDimensions = c(2, 4),
    Labels = c("T", "R"),
    Title = "Clarence Thomas data, MH");


################################################################
## Marginal homogeneity: P1=P2
# P1 and P2 are O1 and O2 conditioned on not being in category 4

# at24 produces vectorized 2x4 table TR (Time x Response
at24 &lt;- MarginalMatrix(c("A", "B"), list(c("A"), c("B")), c(4, 4));

# specify conditional probabilities using generalized exp-log notation
at1 &lt;- rbind(c(1, 0, 0, 0), c(0, 1, 0, 0), c(0, 0, 1, 0), c(1, 1, 1, 0));
at1 &lt;- DirectSum(at1, at1);
at2 &lt;- rbind(c(1, 0, 0, -1), c(0, 1, 0, -1), c(0, 0, 1, -1));
at2 &lt;- DirectSum(at2, at2);
coeff &lt;- list(list(diag(6), at2, at1), list("exp", "log", "identity"));

# marginal homogeneity
bt1 &lt;- ConstraintMatrix(c("T", "R"), list(c("T"), c("R")), c(2, 3));

model1 &lt;- list(bt1, coeff, at24);

pi11 &lt;- MarginalModelFit(ClarenceThomas, model1,
    MaxSteps = 500,
    ShowProgress = 20,
    MaxStepSize = .5,
    CoefficientDimensions = c(2, 3),
    Labels = c("T", "R"),
    Title = "Clarence Thomas data, MH");

</code></pre>

<hr>
<h2 id='cmm-package'>
Categorical Marginal Models
</h2><span id='topic+cmm-package'></span><span id='topic+cmm'></span>

<h3>Description</h3>

<p>Quite extensive package for maximum likelihood estimation and weighted least squares estimation of categorical marginal models (CMMs; e.g., Bergsma &amp; Rudas, 2002; Bergsma, Croon and Hagenaars, 2009</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> cmm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0 </td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-08-08</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The package contains principal functions for analyzing marginal models for categorical data.
All functions are illustrated using examples from the book Marginal Models for Dependent,
Clustered, and Longitudunal Categorical Data (Bergsma, Croon, &amp; Hagenaars, 2009).
</p>
<p>The package contains the following functions
<code><a href="#topic+ConstraintMatrix">ConstraintMatrix</a></code>
<code><a href="#topic+DesignMatrix">DesignMatrix</a></code>
<code><a href="#topic+DirectSum">DirectSum</a></code>
<code><a href="#topic+JoinModels">JoinModels</a></code>
<code><a href="#topic+MarginalMatrix">MarginalMatrix</a></code>
<code><a href="#topic+MarginalModelFit">MarginalModelFit</a></code>
<code><a href="#topic+ModelStatistics">ModelStatistics</a></code>
<code><a href="#topic+SampleStatistics">SampleStatistics</a></code>
<code><a href="#topic+SpecifyCoefficient">SpecifyCoefficient</a></code>
</p>
<p>The package contains the following data sets
<code><a href="#topic+Antisemitism">Antisemitism</a></code>
<code><a href="#topic+BodySatisfaction">BodySatisfaction</a></code>
<code><a href="#topic+ClarenceThomas">ClarenceThomas</a></code>
<code><a href="#topic+DutchConcern">DutchConcern</a></code>
<code><a href="#topic+DutchPolitics">DutchPolitics</a></code>
<code><a href="#topic+ErieCounty">ErieCounty</a></code>
<code><a href="#topic+EVS">EVS</a></code>
<code><a href="#topic+GSS93">GSS93</a></code>
<code><a href="#topic+LaborParticipation">LaborParticipation</a></code>
<code><a href="#topic+MarihuanaAlcohol">MarihuanaAlcohol</a></code>
<code><a href="#topic+NES">NES</a></code>
<code><a href="#topic+NKPS">NKPS</a></code>
<code><a href="#topic+NKPS2">NKPS2</a></code>
<code><a href="#topic+Smoking">Smoking</a></code>
</p>
<p>As of version 1.0, the option of maximum augmented empirical likelihood estimation (MAEL) estimation (Van der Ark et al., 2023), which is particularly useful for large data set.
The following functions were added: 
<code><a href="#topic+Margins">Margins</a></code>
<code><a href="#topic+RecordsToFrequencies">RecordsToFrequencies</a></code>;
the following data set was added <code><a href="#topic+acl">acl</a></code>;
and the following function was updated: <code><a href="#topic+MarginalMatrix">MarginalMatrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>Wicher P. Bergsma
Maintainer: L. Andries van der Ark <a href="mailto:L.A.vanderArk@uva.nl">L.A.vanderArk@uva.nl</a>.
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer. <a href="https://doi.org/10.1007/b12532">doi:10.1007/b12532</a>
</p>
<p>Bergsma, W. P.&amp; Rudas T. (2002). Marginal models for categorical data.
<em>The Annals of Statistics, 30</em>, 1, 140-159. 
<a href="https://doi.org/10.1214/aos/1015362188">doi:10.1214/aos/1015362188</a>
</p>
<p>Van der Ark, L. A., Bergsma, W. P., &amp; Koopman L. (2023)
Maximum augmented empirical likelihood estimation of categorical marginal models for large sparse contingency tables. 
Paper submitted for publication.
</p>

<hr>
<h2 id='ConstraintMatrix'>ConstraintMatrix</h2><span id='topic+ConstraintMatrix'></span>

<h3>Description</h3>

<p>Returns hierarchical model constraint matrix, i.e., nullspace of design matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ConstraintMatrix(var, suffconfigs, dim, SubsetCoding = "Automatic")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ConstraintMatrix_+3A_var">var</code></td>
<td>
<p>character or numeric vector containing variables</p>
</td></tr>
<tr><td><code id="ConstraintMatrix_+3A_suffconfigs">suffconfigs</code></td>
<td>
<p>subvector or list of subvectors of <code>var</code> indicating the sufficient configurations or highest order interactions in model</p>
</td></tr>
<tr><td><code id="ConstraintMatrix_+3A_dim">dim</code></td>
<td>
<p>numeric vector indicating the dimension of <code>var</code> (must be same length as <code>var</code>)</p>
</td></tr>
<tr><td><code id="ConstraintMatrix_+3A_subsetcoding">SubsetCoding</code></td>
<td>
<p>allows a (character) type or a matrix to be assigned to variables for each element of <code>suffconfigs</code></p>
</td></tr></table>
<p>, see examples
</p>


<h3>Details</h3>

<p>The model <code class="reqn">\mu_{ij}=\alpha+\beta_{i}+\gamma_j</code>
has parametric form and can equivalently be described using constraints on the <code class="reqn">\mu_{ij}</code>,
by <code class="reqn">\mu_{ij}-\mu_{il}-\mu_{kj}+\mu_{kl}=0</code>.
Returns the transpose of the null space of <code>DesignMatrix(var,marg,dim)</code>. Rows normally sum to zero.
See <code><a href="#topic+DesignMatrix">DesignMatrix</a></code> for more details.
</p>


<h3>Value</h3>

<p>matrix
</p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ConstraintMatrix">ConstraintMatrix</a></code>, <code><a href="#topic+DesignMatrix">DesignMatrix</a></code>, <code><a href="#topic+DirectSum">DirectSum</a></code>, <code><a href="#topic+MarginalMatrix">MarginalMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Constraint matrix for independence model
var &lt;- c("A","B")
suffconfigs &lt;- list(c("A"),c("B"))
dim &lt;- c(3, 3)
ConstraintMatrix(var,suffconfigs,dim)
# notation in one line
ConstraintMatrix(c("A","B"),list(c("A"),c("B")),c(3,3))


# Constraint matrix for saturated model, two short specifications giving same result
ConstraintMatrix(c("A","B"),c("A","B"),c(3,3))
ConstraintMatrix(c("A","B"),list(c("A","B")),c(3,3))


# Constraint matrix for univariate quadratic regression model
var &lt;- c("A")
suffconfigs &lt;- c("A")
dim &lt;- c(5)
ConstraintMatrix(var,suffconfigs,dim,SubsetCoding=list(c("A"),"Quadratic"))
# notation in one line
ConstraintMatrix(c("A"),c("A"),c(5),SubsetCoding=list(c("A"),"Quadratic"))


# Constraint matrix for linear by nominal model, various methods:
# simplest method which assumes equidistant centered scores:
ConstraintMatrix(
 var = c("A", "B"),
 suffconfigs = c("A", "B"),
 dim = c(3, 3),
 SubsetCoding = list(c("A", "B"), list("Linear", "Nominal")))
# alternative specification with same result as above:
ConstraintMatrix(
 var = c("A", "B"),
 suffconfigs = c("A", "B"),
 dim = c(3, 3),
 SubsetCoding = list(c("A", "B"), list(rbind(c(-1, 0, 1)), rbind(c(1, 0, 0), c(0, 1, 0)))))
# specifying your own category scores
scores &lt;- c(1,2,5);
ConstraintMatrix(
 var = c("A", "B"),
 suffconfigs = c("A", "B"),
 dim = c(3, 3),
 SubsetCoding = list(c("A", "B"), list(rbind(scores), "Nominal")))


# Constraint matrix for nominal by nominal model, equating parameters of 
# last two categories of second variable:
ConstraintMatrix(var = c("A", "B"), suffconfigs = c("A", "B"), dim = c(3,3),
 SubsetCoding = list(c("A", "B"), list("Nominal", rbind(c(1, 0, 0), c(0, 1, 1)))))
</code></pre>

<hr>
<h2 id='DesignMatrix'>DesignMatrix</h2><span id='topic+DesignMatrix'></span>

<h3>Description</h3>

<p>Returns hierarchical model design matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DesignMatrix(var, suffconfigs, dim, SubsetCoding = "Automatic", MakeSubsets=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DesignMatrix_+3A_var">var</code></td>
<td>
<p>character or numeric vector containing variables</p>
</td></tr>
<tr><td><code id="DesignMatrix_+3A_suffconfigs">suffconfigs</code></td>
<td>
<p>subvector or list of subvectors of <code>var</code> indicating the sufficient configurations or highest order interactions in model</p>
</td></tr>
<tr><td><code id="DesignMatrix_+3A_dim">dim</code></td>
<td>
<p>numeric vector indicating the dimension of <code>var</code> (must be same length as <code>var</code>)</p>
</td></tr>
<tr><td><code id="DesignMatrix_+3A_subsetcoding">SubsetCoding</code></td>
<td>
<p>allows a (character) type or a matrix to be assigned to variables for each element of <code>suffconfigs</code></p>
</td></tr></table>
<p>, see examples
</p>
<table>
<tr><td><code id="DesignMatrix_+3A_makesubsets">MakeSubsets</code></td>
<td>
<p>boolean, indicates whether or not to use subsets of <code>suffconfigs</code> (used as option in <code>MarginaMatrix</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The design matrix for a model <code class="reqn">\mu_{ij}=\alpha+\beta_{i}+\gamma_j</code>, 
where <code class="reqn">i</code> and <code class="reqn">j</code> each have three possible values, would be:
<code>Designmatrix(c(1,2),list(c(1),c(2)),c(3,3))</code>.
For readability, the use of characters is recommended for variable names, e.g.,
<code>Designmatrix(c("A","B"),list(c("A"),c("B")),c(3,3))</code>.
The probability vector is assumed to be a vectorized form of the probabilities in a table, 
such that the last variable changes value fastest, then the before last variable, etc. 
For example, the cells of a <code class="reqn">2 \times 3</code> table are arranged in vector form as (11,12,13,21,22,23).
To achieve this, the appropriate way to vectorize a data frame <code>dat</code> is using <code>c(t(ftable(dat)))</code>.
</p>
<p>The optional argument <code>SubsetCoding</code> is useful for e.g.\ specifying various regression models,
a linear by nominal model, grouping categories of a variable, or
omitting a category. <code>SubsetCoding</code> has default value
<code>"Automatic"</code>, which is the same as the value <code>"Nominal"</code>.
Other options are <code>"Linear"</code>, <code>"Quadratic"</code>,
<code>"Cubic"</code>, <code>"Quartic"</code>, <code>"Quintic"</code>, <code>"Identity"</code>.\
The command <code>ConstraintMatrix</code> is often more useful than <code>DesignMatrix</code> for specification of models
for use in <code>SampleStatistics</code>, <code>ModelStatistics</code> or <code>MarginalModelFit</code>.
</p>


<h3>Value</h3>

<p>matrix
</p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ConstraintMatrix">ConstraintMatrix</a></code>, <code><a href="#topic+MarginalMatrix">MarginalMatrix</a></code>, <code><a href="#topic+DirectSum">DirectSum</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Design matrix for independence model
var &lt;- c("A","B")
suffconfigs &lt;- list(c("A"),c("B"))
dim &lt;- c(3, 3)
DesignMatrix(var,suffconfigs,dim)
# notation in one line
DesignMatrix(c("A","B"),list(c("A"),c("B")),c(3,3))


# Design matrix for saturated model, two short specifications giving same result
DesignMatrix(c("A","B"),c("A","B"),c(3,3))
DesignMatrix(c("A","B"),list(c("A","B")),c(3,3))


# Design matrix for univariate quadratic regression model
var &lt;- c("A")
suffconfigs &lt;- c("A")
dim &lt;- c(5)
DesignMatrix(var,suffconfigs,dim,SubsetCoding=list(c("A"),"Quadratic"))
# notation in one line
DesignMatrix(c("A"),c("A"),c(5),SubsetCoding=list(c("A"),"Quadratic"))


# Design matrix for linear by nominal model, various methods:
# simplest method which assumes equidistant centered scores:
DesignMatrix(
 var = c("A","B"),
 suffconfigs = c("A", "B"),
 dim = c(3,3),
 SubsetCoding = list(c("A","B"),list("Linear","Nominal")))
# alternative specification with same result as above:
DesignMatrix(
 var = c("A", "B"),
 suffconfigs = c("A", "B"),
 dim = c(3, 3),
 SubsetCoding = list(c("A","B"),list(rbind(c(-1,0,1)),rbind(c(1,0,0),c(0,1,0)))))
# specifying your own category scores
scores &lt;- c(1,2,5);
DesignMatrix(
 var = c("A","B"),
 suffconfigs = c("A","B"),
 dim = c(3, 3),
 SubsetCoding = list(c("A","B"), list(rbind(scores), "Nominal")))

# Design matrix for nominal by nominal model, equating parameters 
# of last two categories of second variable:
DesignMatrix(
 var = c("A", "B"),
 suffconfigs = c("A","B"),
 dim = c(3,3),
 SubsetCoding = list(c("A", "B"), list("Nominal", rbind(c(1, 0, 0), c(0, 1, 1)))))
</code></pre>

<hr>
<h2 id='DirectSum'>DirectSum</h2><span id='topic+DirectSum'></span>

<h3>Description</h3>

<p>Returns the direct sum of two matrices.</p>


<h3>Usage</h3>

<pre><code class='language-R'>DirectSum(...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DirectSum_+3A_...">...</code></td>
<td>
<p>List of one or more matrices</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Standard mathematical direct sum operator.
</p>


<h3>Value</h3>

<p>matrix
</p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ConstraintMatrix">ConstraintMatrix</a></code>, <code><a href="#topic+DesignMatrix">DesignMatrix</a></code>, <code><a href="#topic+DirectSum">DirectSum</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'> a &lt;- matrix(1:12,3,4)
 DirectSum(a)     #returns a
 DirectSum(a,a)   #returns direct sum of a and a
 DirectSum(a,a,a) #returns direct sum of a, a and a
</code></pre>

<hr>
<h2 id='DutchConcern'>Concern about crime and social security in the Netherlands</h2><span id='topic+DutchConcern'></span>

<h3>Description</h3>

<p>Data from a trend study where two survey questions, regarding (i) concern about crime and
(ii) concern about social security, were asked to randomly selected people in the Netherlands at
ten different time points (November 1977 to July 1981).
The data are tabulated in Bergsma, Croon, and Hagenaars (2009, Table 4.1, Table 4.2).
</p>
<p>Section 4.1 in Bergsma, Croon, and Hagenaars (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DutchConcern)</code></pre>


<h3>Format</h3>

<p>A data frame with 5742 observations on the following variables.
</p>

<dl>
<dt><code>S</code></dt><dd><p>Concern about social security (ordered):
1 = No (big) problem;
2 = big problem;
3 = Very big problem.
</p>
</dd>
<dt><code>C</code></dt><dd><p>Concern about crime (ordered):
1 = No (big) problem;
2 = big problem;
3 = Very big problem.
</p>
</dd>
<dt><code>T</code></dt><dd><p>time points (factor):
1 = Nov 1977;
2 = Jan 1978;
3 = Jun 1978;
4 = Nov 1978;
5 = Mar 1979;
6 = Oct 1979;
7 = Apr 1980;
8 = Oct 1980;
9 = Dec 1980;
10 = Jan 1981.
</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hagenaars (1990, p. 289) and Continuous survey, University of Amsterdam / Steinmetz Archives Amsterdam.
</p>


<h3>References</h3>

<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>
Berlin: Springer
</p>
<p>Hagenaars, J. A. P. (1990).
<em>Categorical longitudinal data: Log-linear panel, trend, and cohort analysis</em>.
Newbury Park, CA: Sage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DutchConcern)
n=c(t(ftable(DutchConcern)))

# Table 4.2
#NB: PLEASE REMOVE THE "#" BEFORE APPLY IN NEXT LINES, WON'T GO THROUGH R-CHECK OTHERWISE/
at1 = MarginalMatrix(c("S", "C", "T"), c("S", "T"), c(3, 3, 10));
print("Concern about social security:")
#apply(matrix(at1 %*% n, 10),1,function(x){100*x/sum(x)})
at2 = MarginalMatrix(c("S", "C", "T"), c("C", "T"), c(3, 3, 10));
print("Concern about crime:")
#apply(matrix(at2 %*% n, 10),1,function(x){100*x/sum(x)})


##############################################################################
# Define and fit models for marginal table IRT (Section 4.1.1)

# atIRT %*% n produces IRT table, dimension 2x3x10
atIRT = MarginalMatrix(c("S", "C", "T"), list(c("S", "T"), c("C", "T")), c(3, 3, 10));
# bt1.Log(atIRT.pi)=0 is marginal model for independence of IT and R \
bt1 = ConstraintMatrix(c("I", "R", "T"), list(c("I", "T"), c("R")), c(2, 3, 10));
bt2 = ConstraintMatrix(c("I", "R", "T"), list(c("I", "T"), c("R", "T")), c(2, 3, 10));
bt3 = ConstraintMatrix(c("I", "R", "T"), list(c("I", "T"), c("I", "R")), c(2, 3, 10));
bt4 = ConstraintMatrix(c("I", "R", "T"), list(c("I", "T"), 
      c("I", "R"), c("R", "T")), c(2, 3, 10));

model1 = list(bt1, "log", atIRT);
model2 = list(bt2, "log", atIRT);
model3 = list(bt3, "log", atIRT);
model4 = list(bt4, "log", atIRT);

#  change model1 to model2 etc to fit different models
pi1 = MarginalModelFit(n, model4,
   ShowProgress = 5,
   CoefficientDimensions = c(2, 3, 10),
   Labels = c("I", "R", "T"));

##############################################################################
# Simultaneous model for marginal and joint distributions (Section 4.1.2)

# define x, the design matrix for the loglinear model of Eq. 4.1
x &lt;- DesignMatrix(var = c("S","C","T"), 
                  suffconfigs = c("S","C","T"), 
                  dim = c(3,3,10), 
                  SubsetCoding = list(c("S", "C", "T"),list("Nominal","Nominal","Linear")))
# model6 is the simultaneous model
model6 &lt;- list(model4, x);

# NB: when fitting model6 Labels and CoefficientDimensions should be appropriate 
# to get the right output # for table IRT, which is different than for model5
#NB: REMOVE "#" IN NEXT LINE, WON'T GO THROUGH R-CHECK
#pi5 = MarginalModelFit(DutchConcern, model6, ShowProgress = 5, 
# CoefficientDimensions = c(2, 3, 10), Labels = c("I", "R", "T"), MaxSteps = 500, MaxStepSize=.2)
</code></pre>

<hr>
<h2 id='DutchPolitics'>Political party and candidate preference in the Netherlands</h2><span id='topic+DutchPolitics'></span>

<h3>Description</h3>

<p>The data come from a Dutch panel study (T1 = February 1977, T2 = March 1977) and concern the
questions for which party the respondent intends to vote (variables A and B, respectively) and
which candidate the respondent prefers to become the next Prime Minister (C and D). The data
have been analyzed before (Hagenaars, 1986, 1988, 1990), and more information on the panel
study and the outcomes may be obtained from these references.
</p>
<p>The data are tabulated in Bergsma, Croon, and Hagenaars (2009, Table 6.1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DutchPolitics)</code></pre>


<h3>Format</h3>

<p>A data frame with 1100 observations on the following variables.
</p>

<dl>
<dt><code>A</code></dt><dd><p>Party preference at time 1 (factor):
1 = Christian Democrats;
2 = Left wing;
3 = Other.
</p>
</dd>
<dt><code>B</code></dt><dd><p>Party preference at time 2 (factor):
1 = Christian Democrats;
2 = Left wing;
3 = Other.
</p>
</dd>
<dt><code>C</code></dt><dd><p>Candidate preference at time 1 (factor):
1 = Christian Democrats;
2 = Left wing;
3 = Other.
</p>
</dd>
<dt><code>D</code></dt><dd><p>Candidate preference at time 2 (factor):
1 = Christian Democrats;
2 = Left wing;
3 = Other.
</p>
</dd>
</dl>



<h3>Source</h3>

<p>J. A. Hagenaars (1990). <em>Categorical longitudinal data: log-linear, panel, trend, and cohort analysis</em>. Newbury Park: Sage
</p>


<h3>References</h3>

<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>
Berlin: Springer
</p>
<p>J. A. Hagenaars (1990). <em>Categorical longitudinal data: log-linear, panel, trend, and cohort analysis</em>. Newbury Park: Sage
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DutchPolitics)

# Marginal homogeneity: A=C and B=D
at2a &lt;- MarginalMatrix(c("A","B","C","D"), list(c("A"), c("C")), c(3, 3, 3, 3));
at2b &lt;- MarginalMatrix(c("A","B","C","D"), list(c("B"), c("D")), c(3, 3, 3, 3));
bt2 &lt;- ConstraintMatrix(c(1,2), list(c(1),c(2)), c(2,3));
at2 &lt;- rbind(at2a, at2b);
bt2 &lt;- DirectSum(bt2, bt2);

model &lt;- list(bt2, "identity", at2);

mpolMH &lt;- MarginalModelFit(DutchPolitics, model,
    MaxError = 10.^-25,
    MaxSteps = 200,
    MaxStepSize = .5,
    StartingPoint = "Automatic",
    CoefficientDimensions = c(2, 2, 3),
    ShowProgress = 50);

</code></pre>

<hr>
<h2 id='ErieCounty'>Erie County political preference, two-wave panel</h2><span id='topic+ErieCounty'></span>

<h3>Description</h3>

<p>These data come from the first systematic panel study on voting,
conducted by Lazarsfeld and his associates in Erie County, Ohio in 1940 (Lazersfeld et al, 1948;
Lazarsfeld, 1972, Wiggins, 1973, Hagenaars, 1993). The data are presented in
Table 6.3 and refer to the variables <code class="reqn">A</code> &ndash; <em>Party
preference at time 1</em> &ndash; August 1940 (1.\ Republican 2.\ Democrat),
<code class="reqn">B</code> &ndash; <em>Presidential Candidate preference at time 1</em> (1.\ for
Willkie 2.\ against Willkie), <code class="reqn">C</code> &ndash; <em>Party preference at
time 2</em> &ndash; October 1940, and <code class="reqn">D</code> &ndash; <em>Presidential Candidate
preference at time 2</em>. Wendell Willkie was the (defeated) 1940
Republican presidential candidate running against the Democrat
Franklin D. Roosevelt.
</p>
<p>Section 6.3 in Bergsma, Croon, and Hagenaars (2009)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ErieCounty)</code></pre>


<h3>Format</h3>

<p>A data frame with 266 observations on the following variables.
</p>

<dl>
<dt><code>A</code></dt><dd><p>Party Preference <code class="reqn">T_1</code> (August 1940):
1 = Democrat;
2 = Republican;
</p>
</dd>
<dt><code>B</code></dt><dd><p>Candidate Preference <code class="reqn">T_1</code> (August 1940):
1 = for Willkie;
2 = against Willkie;
</p>
</dd>
<dt><code>C</code></dt><dd><p>Party Preference <code class="reqn">T_2</code> (October 1940):
1 = Democrat;
2 = Republican;
</p>
</dd>
<dt><code>D</code></dt><dd><p>Candidate Preference <code class="reqn">T_2</code> (October 1940):
1 = for Willkie;
2 = against Willkie;
</p>
</dd></dl>


<h3>Source</h3>

<p>CBS News and New York Times 2001.
</p>


<h3>References</h3>

<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>
Berlin: Springer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ErieCounty)

</code></pre>

<hr>
<h2 id='EVS'>European Values Study (EVS): attitude towards women's role in society</h2><span id='topic+EVS'></span>

<h3>Description</h3>

<p>European Values Study 1999/2000, Views on Women's Roles.
</p>
<p>The data are tabulated in Bergsma, Croon, and Hagenaars (2009, Table 5.1a). 
Section 5.1.2 in Bergsma, Croon and Hagenaars (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(EVS)</code></pre>


<h3>Format</h3>

<p>A data frame with 960 observations on the following variables.
</p>

<dl>
<dt><code>S</code></dt><dd><p>Sex (factor):
1 = Male;
2 = Female.
</p>
</dd>
<dt><code>A</code></dt><dd><p>Date of Birth (ordered):
1 = Before 1945;
2 = 1945-1963;
3 = After 1963.
</p>
</dd>
<dt><code>E</code></dt><dd><p>Level of education (ordered):
1 = Lower;
2 = Intermediate;
3 = Higher.
</p>
</dd>
<dt><code>R</code></dt><dd><p>Religion (ordered):
1 = Religious person;
2 = Not a religious person;
3 = Convinced atheist.
</p>
</dd>
<dt><code>W</code></dt><dd><p>Attitude women's role in society (factor):
1 = Traditional;
2 = Nontraditional.
</p>
</dd>
</dl>



<h3>Source</h3>

<p>European Values Study 1999/2000
</p>


<h3>References</h3>

<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>
New York: Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(EVS)

# Table SAERW
var = c("S", "A", "E", "R", "W");
dim = c(2, 3, 3, 3, 2);

# matrices for table SA
at1 &lt;- MarginalMatrix(var, c("S", "A"), dim);
bt1 &lt;- ConstraintMatrix(c("S", "A"), list(c("S"), c("A")), c(2, 3));

# matrices for table SAER
at2 &lt;- MarginalMatrix(var, c("S", "A", "E", "R"), dim);
bt2 &lt;- ConstraintMatrix(var = c("S", "A", "E", "R"), 
                       suffconfigs = list(c("S", "A", "E"), c("S", "R"), c("A", "R")), 
                       dim = c(2, 3, 3, 3));

# matrices for table SAERW: constraints
at3 &lt;- MarginalMatrix(var, c("S", "A", "E", "R", "W"), dim);
bt3 &lt;- ConstraintMatrix(var = c("S", "A", "E", "R", "W"), 
 suffconfigs = list(c("S", "A", "E", "R"), c("S", "W"), c("A", "W"), c("E", "W"), c("R", "W")), 
 dim = c(2, 3, 3, 3, 2))

# matrix for table SAERW: design matrix
x &lt;- DesignMatrix(var = c("S", "A", "E", "R", "W"), 
 suffconfigs = list(c("S", "A", "E", "R"), c("S", "W"), c("A", "W"), c("E", "W"), c("R", "W")), 
 dim = c(2, 3, 3, 3, 2));

# model1: specification using only constraints
at &lt;- rbind(at1, at2, at3);
bt &lt;- DirectSum(bt1, bt2);
bt &lt;- DirectSum(bt, bt3);
model1 &lt;- list(bt, "log", at);

# model2: same as model1 but using both constraints and a design matrix 
# to specify a loglinear model for the joint distribution
at &lt;- rbind(at1, at2);
bt &lt;- DirectSum(bt1, bt2);
model2 &lt;- list(list(bt, "log", at), x);

nkps3 &lt;- MarginalModelFit(EVS, model2, MaxError = 10.^-25,
    MaxSteps = 1000,
    ShowProgress = 10,
    MaxStepSize = .3 );
</code></pre>

<hr>
<h2 id='GSS93'>Political Orientation and Religion in the United States in 1993 (General Social Survey, 1993)</h2><span id='topic+GSS93'></span>

<h3>Description</h3>

<p>Self-reported Political Orientation (<code class="reqn">P</code>), Religion (<code class="reqn">R</code>), and Opinion
of Teenage Birth-control (<code class="reqn">B</code>) of a sample of 911 US citizens in 1993.
The data stem from the General Social Survey. The data are tabulated
in Bergsma, Croon, and Hagenaars (2009, Table 2.1, Table 2.3).
See Section~2.1 in Bergsma, Croon, and Hagenaars (2009).
Several worked examples involving this data set are listed below but more can be found at http://stats.lse.ac.uk/bergsma/cmm/R files/GSS93.R</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GSS93)</code></pre>


<h3>Format</h3>

<p>A data frame with 911 observations on the following three variables.
</p>

<dl>
<dt><code>P</code></dt><dd><p>Political orientation (ordered):
1 = Extremely liberal;
2 = Liberal;
3 = Slightly liberal;
4 = Moderate;
5 = Slightly conservative;
6 = Conservative;
6 = Extremely conservative.
</p>
</dd>
<dt><code>R</code></dt><dd><p>Religion (factor):
1 = Protestant;
2 = Catholic;
3 = Other.
</p>
</dd>
<dt><code>B</code></dt><dd><p>Opinion of birth control (ordered):
1 = Strongly agree;
2 = Agree;
3 = Disagree;
4 = Strongly disagree;
</p>
</dd>
</dl>



<h3>Source</h3>

<p>General Social Survey (1993)
</p>


<h3>References</h3>

<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>
New York: Springer
</p>
<p>General Social Survey (1993).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GSS93)

## Table 2.1 of Bergsma, Croon, &amp; Hagenaars (2009)
addmargins(table(GSS93[,1:2]))

## Table 2.2 of Bergsma, Croon, &amp; Hagenaars (2009)
# Specify coefficients
coeff &lt;- list("log",diag(21))
SampleStatistics(dat = GSS93[, 1 : 2],
 coeff = coeff,
 CoefficientDimensions = c(7, 3),
 Labels = c("P","R"), 
 ShowParameters = TRUE, 
 ShowCoefficients = FALSE)

## Table 2.3 of Bergsma, Croon, &amp; Hagenaars (2009)
ftable(B + R ~ P , data = GSS93)


########################################################
## Models for table PR

#independence of P and R
bt1 &lt;- ConstraintMatrix(c("P", "R"), list(c("P"), c("R")), c(7,3));
#linear by nominal model
bt2 &lt;- ConstraintMatrix(var = c("P", "R"), 
  suffconfigs = list(c("P", "R")), 
  dim = c(7, 3), 
  SubsetCoding = list(c("P", "R"), c("Linear", "Nominal")))
#linear by nominal model with equality of first two nominal parameters
bt3 &lt;- ConstraintMatrix(var = c("P", "R"), 
 suffconfigs = list(c("P", "R")), 
 dim = c(7, 3), 
 SubsetCoding = list(c("P", "R"), list("Linear", rbind(c(1, 1, 0), c(0, 0, 1)))))
m &lt;- MarginalModelFit(dat = GSS93[,1:2],
 model = list(bt2,"log"), 
 ShowCoefficients = FALSE, 
 ShowProgress = 1, 
 ShowParameters = TRUE, 
 CoefficientDimensions = c(7, 3),
 Labels = c("P", "R"),
 ParameterCoding = list("Polynomial", "Effect"))


########################################################
## Models for table PRB

#various loglinear models
bt1 &lt;- ConstraintMatrix(c("P", "R","B"), list(c("P","R"),c("B")), c(7,3,4))
bt2 &lt;- ConstraintMatrix(c("P", "R","B"), list(c("P","R"),c("R","B")), c(7,3,4))
bt3 &lt;- ConstraintMatrix(c("P", "R","B"), list(c("P","R"),c("P","B")), c(7,3,4))
bt4 &lt;- ConstraintMatrix(c("P", "R","B"), list(c("P","R"),c("P","B"),c("R","B")), c(7,3,4))
bt5 &lt;- ConstraintMatrix(c("P", "R","B"), list(c("P","R"),c("P","B"),c("R","B")), c(7,3,4), 
 SubsetCoding = list(list(c("P", "B"), c("Linear", "Linear")), 
                list(c("R", "B"), c("Nominal", "Linear"))))

m &lt;- MarginalModelFit(dat = GSS93,
 model = list(bt2,"log"), 
 ShowCoefficients = FALSE, 
 ShowProgress = 1, 
 ShowParameters = TRUE,
 CoefficientDimensions =c(7, 3, 4),
 Labels = c("P", "R", "B"), 
 ParameterCoding = list("Polynomial", "Polynomial", "Effect"))
</code></pre>

<hr>
<h2 id='JoinModels'>JoinModels</h2><span id='topic+JoinModels'></span>

<h3>Description</h3>

<p>Returns the simultaneous specification of two models</p>


<h3>Usage</h3>

<pre><code class='language-R'>JoinModels(...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JoinModels_+3A_...">...</code></td>
<td>
<p>list of &lsquo;compatible&rsquo; models, i.e., each model is specified using the same number of functions (and matrices)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Models can be of any form allowed in CMM (see <code>MarginalModelFit</code>), eg, <code>list(bt,coeff,at)</code>, with the restriction that the number of columns of the
<code>at</code> matrices must be equal, and the list of functions in <code>coeff</code> must be identical.
</p>


<h3>Value</h3>

<p>CMM model form
</p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DirectSum">DirectSum</a></code>, <code><a href="#topic+SpecifyCoefficient">SpecifyCoefficient</a></code>, <code><a href="#topic+MarginalModelFit">MarginalModelFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simultaneously specify marginal independence in two marginal tables

bt1 = ConstraintMatrix(c("A","B"),list(c("A"),c("B")),c(3,3))
at1 = MarginalMatrix(c("A","B","C"),c("A","B"),c(3,3,3))
model1 = list(bt1,"log",at1)

bt2 = ConstraintMatrix(c("B","C"),list(c("B"),c("C")),c(3,3))
at2 = MarginalMatrix(c("A","B","C"),c("B","C"),c(3,3,3))
model2 = list(bt2,"log",at2)

model12 = JoinModels(model1,model2)

# the model can be fitted to an artificial data set
n = c(1:27)
fit=MarginalModelFit(n,model12)
</code></pre>

<hr>
<h2 id='LaborParticipation'>Women's labor participation: 1967-1971</h2><span id='topic+LaborParticipation'></span>

<h3>Description</h3>

<p>The labor participation (yes/no) of 1583 women was measured in five consecutive year, 1967-1971, 
leading to a <code class="reqn">2\times 2\times 2\times 2\times 2</code> table.
</p>
<p>The data are tabulated in Bergsma, Croon, and Hagenaars (2009, p. 128).
</p>
<p>Section 4.3 in Bergsma, Croon and Hagenaars, 2009
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LaborParticipation)</code></pre>


<h3>Format</h3>

<p>A data frame with 1583 observations on the following variables.
</p>

<dl>
<dt><code>Year1967</code></dt><dd><p>Participated in 1967 (factor):
1 = No;
2 = Yes.
</p>
</dd>
<dt><code>Year1968</code></dt><dd><p>Participated in 1968 (factor):
1 = No;
2 = Yes.
</p>
</dd>
<dt><code>Year1969</code></dt><dd><p>Participated in 1969 (factor):
1 = No;
2 = Yes.
</p>
</dd>
<dt><code>Year1970</code></dt><dd><p>Participated in 1970 (factor):
1 = No;
2 = Yes.
</p>
</dd>
<dt><code>Year1971</code></dt><dd><p>Participated in 1971 (factor):
1 = No;
2 = Yes.
</p>
</dd>
</dl>



<h3>Source</h3>

<p>Heckman &amp; Willis (1977).
</p>


<h3>References</h3>

<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>
New York: Springer.
</p>
<p>Heckman, J. J. &amp; Willis, R. J. (1977).
A beta-logistic model for the analysis of sequential labor force participation by married women.
<em>Journal of Political Economy, 85</em>, 27-58.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(LaborParticipation)
n &lt;- c(t(ftable(LaborParticipation)))

##########################################################
#Sample kappa values

#matrix for obtaining transition matrices for consecutive years
at &lt;- MarginalMatrix(var = c("67", "68", "69", "70", "71"),
  marg = list(c("67", "68") ,c("68", "69"), c("69", "70"), c("70", "71")),
  dim = c(2, 2, 2, 2, 2))

coeff &lt;- SpecifyCoefficient("CohenKappa", arg = 2, rep = 4);
stats &lt;- SampleStatistics(n, list(coeff,at), ShowParameters = FALSE)


##########################################################
#Fitting models for kappa
#matrix for obtaining transition matrices for consecutive years
at &lt;- MarginalMatrix(var = c("67", "68", "69", "70", "71"),
  marg = list(c("67", "68") ,c("68", "69"), c("69", "70"), c("70", "71")),
  dim = c(2, 2, 2, 2, 2))

coeff &lt;- SpecifyCoefficient("CohenKappa", arg = 2, rep = 4);

bt1 &lt;- ConstraintMatrix(var = c(1), suffconfigs = c(), dim = c(4)); #equal kappas
bt2 &lt;-  rbind(c(1,-2,1,0), c(0,1,-2,1));  #linear trend for kappas
model &lt;- list(bt1, coeff,at)

m = MarginalModelFit(n, model, ShowParameters = FALSE, ShowProgress = 10)
</code></pre>

<hr>
<h2 id='MarginalMatrix'>MarginalMatrix</h2><span id='topic+MarginalMatrix'></span>

<h3>Description</h3>

<p>Returns marginal matrix; i.e., matrix required to obtained marginal frequencies</p>


<h3>Usage</h3>

<pre><code class='language-R'>MarginalMatrix(var, marg, dim, SubsetCoding = "Identity", vec = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MarginalMatrix_+3A_var">var</code></td>
<td>
<p>character or numeric vector containing variables</p>
</td></tr>
<tr><td><code id="MarginalMatrix_+3A_marg">marg</code></td>
<td>
<p>list of character or numeric indicating marginals</p>
</td></tr>
<tr><td><code id="MarginalMatrix_+3A_dim">dim</code></td>
<td>
<p>numeric vector indicating the dimension of <code>var</code></p>
</td></tr>
<tr><td><code id="MarginalMatrix_+3A_subsetcoding">SubsetCoding</code></td>
<td>
<p>allows a (character) type or a matrix to be assigned to variables for each element of <code>suffconfigs</code>,
see examples and <code>DesignMatrix</code></p>
</td></tr>
<tr><td><code id="MarginalMatrix_+3A_vec">vec</code></td>
<td>
<p>Vector containing the observed frequencies of all observed cells and possibly some cells with frequency equal to zero. 
The rownames of <code>vec</code> must equal the score patterns associated with the cells. 
<code>vec</code> is typically created using <code>RecordsToFrequencies</code>, and allows maximum empirical maximum likelihood estimation or 
empirical likelihood estimation of CMMs; two estimation methods that do no require the evaluation of all cells that are useful if 
the number of score patterns  is large.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>Gives the matrix which, multiplied by a probability vector, gives the marginal probabilities.
The probability vector is assumed to be a vectorized form of the probabilities in a table, such that the last variable changes value fastest,
then the before last variable, etc. For example, the cells of a <code class="reqn">2 \times 3</code> table are arranged in vector form as (11,12,13,21,22,23).
To achieve this, the appropriate way to vectorize a data frame <code>dat</code> is using <code>c(t(ftable(dat)))</code>.
</p>
<p>Special case of transposed <code>DesignMatrix</code>:
</p>
<pre>
 MarginalMatrix &lt;- function(var,marg,dim,SubsetCoding="Identity")
 t(DesignMatrix(var,marg,dim,SubsetCoding=SubsetCoding,MakeSubsets=FALSE))
</pre>
<p>Allows weighted sums of probabilities using <code>SubsetCoding</code>
</p>


<h3>Value</h3>

<p>matrix
</p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>
<p>Van der Ark, L. A., Bergsma, W. P., &amp; Koopman L. (2023)
Maximum augmented empirical likelihood estimation of categorical marginal models for large sparse contingency tables. 
Paper submitted for publication.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ConstraintMatrix">ConstraintMatrix</a></code>, <code><a href="#topic+DesignMatrix">DesignMatrix</a></code>, <code><a href="#topic+DirectSum">DirectSum</a></code>, <code><a href="#topic+RecordsToFrequencies">RecordsToFrequencies</a></code>, <code><a href="#topic+Margins">Margins</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Computing marginal frequencies
n &lt;- c(1:6)  #example list of frequencies
var &lt;- c("A","B")
marg &lt;- list(c("A"),c("B"))
dim &lt;- c(2,3)
at &lt;- MarginalMatrix(var,marg,dim)
# list of marginal frequencies:
at 

# identitymatrix: several ways of specifying:
marg &lt;- c("A","B")
MarginalMatrix(var, marg,dim)
MarginalMatrix(var, marg, dim,
 SubsetCoding = list(c("A", "B"), list("Identity", "Identity")))
MarginalMatrix(var, marg, dim,
 SubsetCoding = list(c("A","B"), list(rbind(c(1,0),c(0,1)), rbind(c(1,0,0),c(0,1,0),c(0,0,1)))))

# omit second category of first variable
at &lt;- MarginalMatrix(var, marg, dim,
 SubsetCoding = list(c("A","B"), list(rbind(c(1,0)),"Identity")))
at 

# Example of maximum augmented empirical likelihood (MAEL) estimation 
data(acl)
dat &lt;- acl[, 1:2] + 1                                 # select 2 items from ACL 
var &lt;- 1 : ncol(dat)                                  # define the variables
marg &lt;- Margins(var, c(0, 1))                         # margins are total (0) and 1st order 
dim &lt;- rep(5, length(var))
n.obs &lt;- RecordsToFrequencies(dat, var, dim, "obs")   # frequency vector with observed cells
t(n.obs)
n.1k  &lt;- RecordsToFrequencies(dat, var, dim, "1k")    # frequency vector with observed and
                                                      # some unobserved cells
t(n.1k)
at.obs &lt;- MarginalMatrix(var, marg, dim, vec = n.obs) # marginal matrix based on n.obs 
at.obs
at.1k  &lt;- MarginalMatrix(var, marg, dim, vec = n.1k)  # marginal matrix based on n.1k
at.1k
</code></pre>

<hr>
<h2 id='MarginalModelFit'>MarginalModelFit</h2><span id='topic+MarginalModelFit'></span>

<h3>Description</h3>

<p>Fits marginal models, by default using maximum likelihood. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MarginalModelFit(dat, model, ShowSummary = TRUE, MaxSteps = 1000, MaxStepSize = 1, 
    MaxError = 1e-20, StartingPoint = "Automatic", MaxInnerSteps = 2, 
    ShowProgress = TRUE, CoefficientDimensions="Automatic", Labels="Automatic",
    ShowCoefficients = TRUE, ShowParameters = FALSE, ParameterCoding = "Effect",
    ShowCorrelations = FALSE, Method = "ML", Title = "Summary of model fit")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MarginalModelFit_+3A_dat">dat</code></td>
<td>
<p>vector of frequencies or data frame</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_model">model</code></td>
<td>
<p>list specified eg as <code>list(bt,coeff,at)</code></p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_showsummary">ShowSummary</code></td>
<td>
<p>Whether or not to execute <code>summary()</code> of the output</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_maxsteps">MaxSteps</code></td>
<td>
<p>integer: maximum number of steps of the algorithm</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_maxstepsize">MaxStepSize</code></td>
<td>
<p>number greater than 0 and at most 1: step size</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_maxerror">MaxError</code></td>
<td>
<p>numeric: maximum error term</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_startingpoint">StartingPoint</code></td>
<td>
<p>vector of starting frequencies corresponding to all cells in the manifest table</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_maxinnersteps">MaxInnerSteps</code></td>
<td>
<p>nonnegative integer: only used for latent variable models, indicates number of steps in M step of EM algorithms</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_showprogress">ShowProgress</code></td>
<td>
<p>boolean or integer: FALSE for no progress information, TRUE or 1 for information at every step, an integer k for information at every k-th step</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_coefficientdimensions">CoefficientDimensions</code></td>
<td>
<p>numeric vector of dimensions of the table in which the coefficient vector is to be arranged</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_labels">Labels</code></td>
<td>
<p>list of characters or numbers indicating labels for dimensions of table in which the coefficient vector is to be arranged</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_showcoefficients">ShowCoefficients</code></td>
<td>
<p>boolean, indicating whether or not the coefficients are to be displayed</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_showparameters">ShowParameters</code></td>
<td>
<p>boolean, indicating whether or not the parameters (computed from the coefficients) are to be displayed</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_parametercoding">ParameterCoding</code></td>
<td>
<p>Coding to be used for parameters, choice of <code>"Effect"</code>, <code>"Dummy"</code> and  <code>"Polynomial"</code></p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_showcorrelations">ShowCorrelations</code></td>
<td>
<p>boolean, indicating whether or not to show the correlation matrix for the estimated coefficients</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_method">Method</code></td>
<td>
<p>character, choice of &quot;ML&quot; for maximum likelihood or &quot;GSK&quot; for the GSK method</p>
</td></tr>
<tr><td><code id="MarginalModelFit_+3A_title">Title</code></td>
<td>
<p>title of computation to appear at top of screen output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data can be a data frame or vector of frequencies. <code>MarginalModelFit</code> converts a data frame <code>dat</code> to a vector of 
frequencies using <code>c(t(ftable(dat)))</code>.
</p>
<p>The model specification is fairly flexible. We first describe the most typical way to specify the model. 
The model itself should typically first be written in the form of a constraint vector as
<code class="reqn">B'\theta(A'\pi) = 0</code>
where <em>B'</em>  is a contrast matrix, <em>A'</em> is matrix, normally of zeroes and ones, such that <em>A'pi</em> gives a vector of marginal probabilities, and the function theta yields 
a list of (marginal) <em>coefficients</em>. The model is then specified as <code>model=list(bt,coeff,at)</code> where <code>bt</code> is the matrix <em>B'</em>, <code>at</code> is the matrix <em>A'</em>, and <code>coeff</code>
represents the vector of coefficients using the generalized exp-log notation. For most of the models in the book, <code>bt</code> can be obtained directly using <code>ConstraintMatrix</code>,  
<code>coeff</code> can be obtained directly using <code>SpecifyCoefficient</code>, and <code>at</code> can be obtained directly using <code>MarginalMatrix</code>.
</p>
<p>Note that CMM does not permit the <em>C</em> and <em>X</em> matrix in the model
<code class="reqn">C'\theta(A'\pi) = X\beta</code>
to be specified for use in the programme. The model has to be rewritten in terms of constraints as above, which is normally straightforward to do with the use of <code>ConstraintMatrix</code>. 
For many purposes, estimates and standard errors for a beta vector as in the equation above can still be obtained using the optional argument <code>ShowParameters=TRUE</code>.
</p>
<p>There are two ways to specify <code>coeff</code>. The first is using the generalized exp-log notation, in which case <code>coeff[[1]]</code> should be a list of matrices, and 
<code>coeff[[2]]</code> should be a list of predefined functions of the same length. The second is to set <code>coeff</code> equal to a predefined function; for example, marginal loglinear models 
are obtained by setting <code>coeff="log"</code>.
</p>
<p>The model can be specified in various other ways: as <code>model=list(coeff,at)</code>, <code>model=list(bt,coeff)</code>, <code>model=at</code>, or even just <code>model=coeff</code>.
Furthermore, the model
<code class="reqn">B'\theta(A'\pi) = d</code>
with <em>d</em> a nonzero vector is specified in the form <code>model=list(bt,coeff,at,d)</code>.
</p>
<p>To specify the simultaneous model
<code class="reqn">B'\theta(A'\pi) = 0\\ \log\pi=X\beta</code>
the extended model specification <code>model=list(margmodel,x)</code> should be used, where <code>margmodel</code> has one of the above forms, and <code>x</code> is a design matrix,
which can be obtained using <code>DesignMatrix</code>. Fitting is often more efficient by specifying a loglinear model for the joint distribution in this way rather than
using constraints.
</p>
<p>The default on-screen output when running <code>fit=MarginalModelFit(...)</code> is given by <code>summary(fit)</code>. Important here is the distinction between coefficients and parameters, briefly 
described above. Standard output gives the coefficients. These are that part of <code>model</code> without the <code>bt</code> matrix, eg if the model is <code>list(bt,coeff,at)</code>
then the coefficients are <code>list(coeff,at)</code>. If other coefficients are needed, <code><a href="#topic+ModelStatistics">ModelStatistics</a></code> can be used.
</p>
<p>Latent variable models can be specified: if the size of the table for which <code>model</code> is specified is a multiple of the the size of the
observed frequencies specified in <code>dat</code>, it is assumed this is due to the presence of latent variables. With respect to vectorization,
the latent variables are assumed to change their value fastest.
</p>
<p>Convergence may not always be achieved with <code>MaxStepSize=1</code> and a lower value may need to be used, but not too low or convergence is slow. If the step size is too large, 
a typical error message is &quot;system is computationally singular: reciprocal condition number = 1.35775e-19&quot;
</p>


<h3>Value</h3>

<p>Most of the following are included in any output. Use <code>summary()</code> to get a summary of output.
</p>
<table>
<tr><td><code>FittedFrequencies</code></td>
<td>
<p>Vector of fitted frequencies for the full table (including any latent variables).</p>
</td></tr>
<tr><td><code>Method</code></td>
<td>
<p>Fitting method used (currently maximum likelihood, GSK or minimum discrimination information)</p>
</td></tr>
<tr><td><code>LoglikelihoodRatio</code></td>
<td>
</td></tr>
<tr><td><code>ChiSquare</code></td>
<td>
</td></tr>
<tr><td><code>DiscriminationInformation</code></td>
<td>
</td></tr>
<tr><td><code>WaldStatistic</code></td>
<td>
</td></tr>
<tr><td><code>DegreesOfFreedom</code></td>
<td>
</td></tr>
<tr><td><code>PValue</code></td>
<td>
<p>p-value based on asymptotic chi-square approximation for likelihood ratio test statistic</p>
</td></tr>
<tr><td><code>SampleSize</code></td>
<td>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
</td></tr>
<tr><td><code>Eigenvalues</code></td>
<td>
</td></tr>
<tr><td><code>ManifestFittedFrequencies</code></td>
<td>
</td></tr>
</table>
<p>For the &ldquo;coefficients&rdquo; in the equation bt.coeff(at.pi)=d, the following statistics are available:
</p>
<table>
<tr><td><code>ObservedCoefficients</code></td>
<td>
</td></tr>
<tr><td><code>FittedCoefficients</code></td>
<td>
</td></tr>
<tr><td><code>CoefficientStandardErrors</code></td>
<td>
</td></tr>
<tr><td><code>CoefficientZScores</code></td>
<td>
</td></tr>
<tr><td><code>CoefficientAdjustedResiduals</code></td>
<td>
</td></tr>
<tr><td><code>CoefficientCovarianceMatrix</code></td>
<td>
</td></tr>
<tr><td><code>CoefficientCorrelationMatrix</code></td>
<td>
</td></tr>
<tr><td><code>CoefficientAdjustedResidualCovarianceMatrix</code></td>
<td>
</td></tr>
<tr><td><code>CoefficientDimensions</code></td>
<td>
</td></tr>
<tr><td><code>CoefficientTableVariableLabels</code></td>
<td>
</td></tr>
<tr><td><code>CoefficientTableCategoryLabels</code></td>
<td>
</td></tr>
</table>
<p>The &ldquo;parameters&rdquo; are certain linear combinations of the coefficients. For example, if the coefficients are log probabilities, then the parameters are the usual loglinear parameters. 
</p>
<table>
<tr><td><code>Parameters</code></td>
<td>
</td></tr>
</table>
<p>For the i-th subset of variables, the parameters are obtained by
</p>
<table>
<tr><td><code>Parameters[[i]]$</code></td>
<td>
</td></tr>
</table>
<p>The following statistics for the parameters belonging to each subset of variable are available.
</p>
<table>
<tr><td><code>Parameters[[i]]$ObservedCoefficients</code></td>
<td>
</td></tr>
<tr><td><code>Parameters[[i]]$FittedCoefficients</code></td>
<td>
</td></tr>
<tr><td><code>Parameters[[i]]$CoefficientStandardErrors</code></td>
<td>
</td></tr>
<tr><td><code>Parameters[[i]]$CoefficientZScores</code></td>
<td>
</td></tr>
<tr><td><code>Parameters[[i]]$CoefficientAdjustedResiduals</code></td>
<td>
</td></tr>
<tr><td><code>Parameters[[i]]$CoefficientCovarianceMatrix</code></td>
<td>
</td></tr>
<tr><td><code>Parameters[[i]]$CoefficientCorrelationMatrix</code></td>
<td>
</td></tr>
<tr><td><code>Parameters[[i]]$CoefficientAdjustedResidualCovarianceMatrix</code></td>
<td>
</td></tr>
<tr><td><code>Parameters[[i]]$CoefficientDimensions</code></td>
<td>
</td></tr>
<tr><td><code>Parameters[[i]]$CoefficientTableVariableLabels</code></td>
<td>
</td></tr>
<tr><td><code>Parameters[[i]]$CoefficientTableCategoryLabels</code></td>
<td>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SampleStatistics">SampleStatistics</a></code>, <code><a href="#topic+ModelStatistics">ModelStatistics</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see also the built-in data sets

data(NKPS)

# Fit the model asserting Goodman and Kruskal's gamma is zero for
# Child's attitude toward sex role's (NKPS[,3], three categories) and
# parent's attitude toward sex role's (NKPS[,4], three categories).

coeff = SpecifyCoefficient("GoodmanKruskalGamma",c(3,3))
fit = MarginalModelFit(NKPS[,c(3,4)], coeff )


# Marginal homogeneity (MH) in a 3x3 table AB
# Note that MH is equivalent to independence in the 2x3 table of marginals IR, in which 
# the row with I=1 gives the A marginal, and the row with I=2 gives the B marginal 
n &lt;- c(1,2,3,4,5,6,7,8,9)
at &lt;- MarginalMatrix(c("A","B"),list(c("A"),c("B")),c(3,3))
bt &lt;- ConstraintMatrix(c("I","R"),list(c("I"),c("R")),c(2,3))
model &lt;- list( bt, "log", at)
fit &lt;- MarginalModelFit(n,model)

#Output can be tidied up:
fit &lt;- MarginalModelFit(n,model,CoefficientDimensions=c(2,3))
</code></pre>

<hr>
<h2 id='Margins'>Margins</h2><span id='topic+Margins'></span>

<h3>Description</h3>

<p>Provides the required margins for selected variables</p>


<h3>Usage</h3>

<pre><code class='language-R'>Margins(var, k)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Margins_+3A_var">var</code></td>
<td>
<p>vector indicating the variables</p>
</td></tr>
<tr><td><code id="Margins_+3A_k">k</code></td>
<td>
<p>vector indicating the required margin: 0 = the total, 1 = first margin, 2 =  second margin, etc. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Particularly useful if for a large number of variables the same margins are required. The output can be used as argument for functions <code><a href="#topic+MarginalMatrix">MarginalMatrix</a></code>, 
<code><a href="#topic+DesignMatrix">DesignMatrix</a></code>, and <code><a href="#topic+ConstraintMatrix">ConstraintMatrix</a></code>
</p>


<h3>Value</h3>

<p>list
</p>


<h3>Author(s)</h3>

<p>L. A. van der Ark <a href="mailto:L.A.vanderArk@uva.nl">L.A.vanderArk@uva.nl</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ConstraintMatrix">ConstraintMatrix</a></code>, <code><a href="#topic+MarginalMatrix">MarginalMatrix</a></code>, <code><a href="#topic+RecordsToFrequencies">RecordsToFrequencies</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Margins(c(1, 2, 3, 4, 5), c(0, 1, 2)) # total, 1st, and 2nd margin for variables 1,.., 5
</code></pre>

<hr>
<h2 id='MarihuanaAlcohol'>Marihuana and alcohol use during adolescence, five-wave panel</h2><span id='topic+MarihuanaAlcohol'></span>

<h3>Description</h3>

<p>Panel study with five time points. A group of 269 youths were interviewed at ages 13, 14, 15, 16, and 17,
and asked (among other things) about their marijuana and alcohol use (Eliot, Huizinga &amp; Menard, 1989).
The data are tabulated in Bergsma, Croon, and Hagenaars (2009, p. 128).
208 observations do not have missing values.
</p>
<p>Sections 4.2 and 4.4 in Bergsma, Croon, and Hagenaars (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(MarihuanaAlcohol)</code></pre>


<h3>Format</h3>

<p>A data frame with 269 observations on the following variables.
</p>

<dl>
<dt><code>Gender</code></dt><dd><p>(factor):
1 = Male;
2 = Female.
</p>
</dd>
<dt><code>M1</code></dt><dd><p>Use of marihuana at time 1 (ordered):
1 = Never;
2 = Occasionally;
3 = Frequently.
</p>
</dd>
<dt><code>M2</code></dt><dd><p>Use of marihuana at time 2 (ordered): see <code>M1</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt><code>M3</code></dt><dd><p>Use of marihuana at time 3 (ordered): see <code>M1</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt><code>M4</code></dt><dd><p>Use of marihuana at time 4 (ordered): see <code>M1</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt><code>M5</code></dt><dd><p>Use of marihuana at time 5 (ordered): see <code>M1</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt><code>A1</code></dt><dd><p>Use of alcohol at time 1 (ordered): see <code>M1</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt><code>A2</code></dt><dd><p>Use of alcohol at time 2 (ordered): see <code>M1</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt><code>A3</code></dt><dd><p>Use of alcohol at time 3 (ordered): see <code>M1</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt><code>A4</code></dt><dd><p>Use of alcohol at time 4 (ordered): see <code>M1</code></p>
</dd></dl>
<p>.
</p>
<dl>
<dt><code>A5</code></dt><dd><p>Use of alcohol at time 5 (ordered): see <code>M1</code></p>
</dd></dl>
<p>.

</p>


<h3>Source</h3>

<p>US National Youth Survey (NYS): teenage marijuana and alcohol use (Elliot, Huizinga and Menard, 1989)
</p>


<h3>References</h3>

<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>
New York: Springer.
</p>
<p>Elliot, D. S., Huizinga, D. &amp; Menard, S. (1989).
Multiple problem youth: Delinquency, substance use, and metal health problems.
New York: Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MarihuanaAlcohol)

# Table MA: marginal loglinear analysis  (BCH Section 4.2.1)
# listwise deletion of missing values and deletion of Gender and Alcohol use
dat &lt;- MarihuanaAlcohol[-row(MarihuanaAlcohol)[is.na(MarihuanaAlcohol)],2:6]

# at yields the vectorized 5x3 table MA (marijuana use x age)
at &lt;- MarginalMatrix(var =  c("M1", "M2", "M3", "M4", "M5"), 
 marg = list(c("M1"), c("M2"), c("M3"), c("M4"), c("M5")), 
 dim = c(3, 3, 3, 3, 3))
obscoeff &lt;- SampleStatistics(dat = dat, 
 coeff = list("log", at), 
 CoefficientDimensions = c(5,3), 
 Labels = c("Age", "M"), 
 ShowCoefficients = FALSE, 
 ShowParameters = TRUE)
</code></pre>

<hr>
<h2 id='ModelStatistics'>ModelStatistics</h2><span id='topic+ModelStatistics'></span>

<h3>Description</h3>

<p>If fitted frequencies under a model have been calculated, this procedure can be used to give sample values,
fitted values, estimated standard errors, z-scores and adjusted residuals of one or more coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModelStatistics(dat, fitfreq, model, coeff, CoefficientDimensions = "Automatic",
    Labels = "Automatic", Method = "ML", ShowCoefficients = TRUE, ShowParameters = FALSE, 
    ParameterCoding = "Effect", ShowCorrelations = FALSE, Title = "")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModelStatistics_+3A_dat">dat</code></td>
<td>
<p>observed data as a list of frequencies or as a data frame</p>
</td></tr>
<tr><td><code id="ModelStatistics_+3A_fitfreq">fitfreq</code></td>
<td>
<p>vector of fitted frequencies for each cell of full table (including latent variables, if any)</p>
</td></tr>
<tr><td><code id="ModelStatistics_+3A_model">model</code></td>
<td>
<p>list specified eg as <code>list(bt,coeff,at)</code></p>
</td></tr>
<tr><td><code id="ModelStatistics_+3A_coeff">coeff</code></td>
<td>
<p>list of coefficients, can be obtained using <code><a href="#topic+SpecifyCoefficient">SpecifyCoefficient</a></code></p>
</td></tr>
<tr><td><code id="ModelStatistics_+3A_coefficientdimensions">CoefficientDimensions</code></td>
<td>
<p>numeric vector of dimensions of the table in which the coefficient vector is to be arranged</p>
</td></tr>
<tr><td><code id="ModelStatistics_+3A_labels">Labels</code></td>
<td>
<p>list of characters or numbers indicating labels for dimensions of table in which the coefficient vector is to be arranged</p>
</td></tr>
<tr><td><code id="ModelStatistics_+3A_showcoefficients">ShowCoefficients</code></td>
<td>
<p>boolean, indicating whether or not the coefficients are to be displayed</p>
</td></tr>
<tr><td><code id="ModelStatistics_+3A_showparameters">ShowParameters</code></td>
<td>
<p>boolean, indicating whether or not the parameters (computed from the coefficients) are to be displayed</p>
</td></tr>
<tr><td><code id="ModelStatistics_+3A_method">Method</code></td>
<td>
<p>character, choice of &quot;ML&quot; for maximum likelihood or &quot;GSK&quot; for the GSK method</p>
</td></tr>
<tr><td><code id="ModelStatistics_+3A_parametercoding">ParameterCoding</code></td>
<td>
<p>Coding to be used for parameters, choice of <code>"Effect"</code>, <code>"Dummy"</code> and  <code>"Polynomial"</code></p>
</td></tr>
<tr><td><code id="ModelStatistics_+3A_showcorrelations">ShowCorrelations</code></td>
<td>
<p>boolean, indicating whether or not to show the correlation matrix for the estimated coefficients</p>
</td></tr>
<tr><td><code id="ModelStatistics_+3A_title">Title</code></td>
<td>
<p>title of computation to appear at top of screen output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data can be a data frame or vector of frequencies. <code>MarginalModelFit</code> converts a data frame <code>dat</code> using <code>c(t(ftable(dat)))</code>.
</p>
<p>For <code>ParameterCoding</code>, the default for <code>"Dummy"</code>
is that the first cell in the table is the reference cell. Cell
<code class="reqn">(i,j,k,...)</code> can be made reference cell using
<code>list("Dummy",c(i,j,k,...))</code>. For <code>"Polynomial"</code> the
default is to use centralized scores based on equidistant (distance
1) linear scores, for example, if for <code class="reqn">i=1,2,3,4</code>,
<code class="reqn">\mu_i=\alpha+q_i\beta+r_i\gamma+s_i\delta</code> 
where <code class="reqn">\beta</code> is a quadratic, <code class="reqn">\gamma</code> a cubic and <code class="reqn">\delta</code> a 
quartic effect, then <code class="reqn">q_i</code> takes the values <code class="reqn">(-1.5,-.5,.5,1.5)</code>, 
<code class="reqn">r_i</code> takes the values <code class="reqn">(1,-1,-1,1)</code> 
(centralized squares of the <code class="reqn">q_i</code>), and <code class="reqn">s_i</code> takes the values 
<code class="reqn">(-3.375,-.125,.125,3.375)</code> (cubes of the <code class="reqn">q_i</code>).</p>


<h3>Value</h3>

<p> A subset of the output of <code>MarginalModelFit</code>. </p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ModelStatistics">ModelStatistics</a></code>,
<code><a href="#topic+MarginalModelFit">MarginalModelFit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Below an example where ModelStatistics can be used to get output for coefficients 
# not given by MarginalModelFit 

# Marginal homogeneity (MH) in a 3x3 table AB
# Note that MH is equivalent to independence in the 2x3 table of marginals IR, in which the 
# row with I=1 gives the A marginal, and the row with I=2 gives the B marginal 
n &lt;- 1 : 9
at &lt;- MarginalMatrix(c("A", "B"), list(c("A"), c("B")), c(3,3))
bt &lt;- ConstraintMatrix(c("I", "R"), list(c("I"), c("R")), c(2,3))
model &lt;- list( bt, "log", at)

#The "coefficients" for the model are the log marginal probabilities for table IR
fit &lt;- MarginalModelFit(dat = n, model = model, 
 CoefficientDimensions = c(2, 3), Labels = c("I", "R"))

#to get output for the marginal probabilities, ModelStatistics can be used as follows
spec &lt;-  SpecifyCoefficient("ConditionalProbabilities",list(c("I","R"),c("I"),c(2,3)))
coeff &lt;- list(spec, at)
stats &lt;- ModelStatistics(dat = n, fitfreq = fit$FittedFrequencies, 
 model = model, coeff = coeff, CoefficientDimensions = c(2, 3),
 Labels = c("I", "R"))
</code></pre>

<hr>
<h2 id='NES'>Political Orientation in the US, three-wave panel study</h2><span id='topic+NES'></span>

<h3>Description</h3>

<p>Data from the US National Election Studies. Three-wave panel study
measuring political orientation on a seven-point scale. The data are
tabulated in Bergsma, Croon, and Hagenaars (2009, 4.4).
</p>
<p>Sections 4.2.1 and 4.3 in Bergsma, Croon and Hagenaars (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(NES)</code></pre>


<h3>Format</h3>

<p>A data frame with 408 observations on the following variables.
</p>

<dl>
<dt><code>T1</code></dt><dd><p>Political orientation at time 1 (ordered):
1 = Extremely liberal
2 = Liberal
3 = Slightly liberal&quot;
4 = Moderate
5 = Slightly conservative
6 = Conservative
7 = Extremely conservative
</p>
</dd>
<dt><code>T2</code></dt><dd><p>Political orientation at time 2 (ordered): see <code>T1</code></p>
</dd>
<dt><code>T3</code></dt><dd><p>Political orientation at time 3 (ordered): see <code>T1</code></p>
</dd>
</dl>



<h3>Source</h3>

<p>US National Election Studies.
</p>


<h3>References</h3>

<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>New York: Springer.
</p>
<p>Examples in book: http://stats.lse.ac.uk/bergsma/cmm/R files/NES.R
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(NES)

####################################################################################
# Models for marginal homogeneity over time (Section 4.2.1)

# Marginal homogeneity : no change in political orientation over time

at &lt;- MarginalMatrix(c("T1", "T2", "T3"), list(c("T1"), c("T2"), c("T3")), c(7,7,7));
bt1 &lt;- ConstraintMatrix(c("T", "P"), list(c("T"), c("P")), c(3, 7));

model1 &lt;- list(bt1, "identity", at);

start &lt;- c(t(ftable(NES))) + .001;
pihat &lt;- MarginalModelFit(NES, model1,
    MaxSteps = 1000, StartingPoint = start,
    ShowProgress = 100, MaxError = 1e-28,
    CoefficientDimensions = c(3,7), ShowCoefficients = TRUE,
    ShowParameters = FALSE, Labels = c("T", "P"));
</code></pre>

<hr>
<h2 id='NKPS'>Attitudes on sex roles and marriage, measurements clustered in families</h2><span id='topic+NKPS'></span><span id='topic+NKPS2'></span><span id='topic+nkps1'></span>

<h3>Description</h3>

<p>Netherlands Kinship Panel Study (NKPS), www.nkps.nl.
Netherlands Kinship Panel Study (NKPS), a unique in-depth large-scale study into (changing) kinship relationships covering
a large number of life domains (Dykstra et al., 2004).
</p>
<p>The data are tabulated in Bergsma, Croon, and Hagenaars (2009, Table 2.8, 2.10, 2.11, 2.12).
In Sections 5.1 and 6.4.2 more variables of the same data set are used, and these have only 1797 observations with no missing values;
this set is available as <code>NKPS2</code>.
</p>
<p>Sections 2.2.3, 3.2, 5.1, 6.4.2 in Bergsma, Croon and Hagenaars (2009)
</p>


<h3>Usage</h3>

<pre><code class='language-R'> data(NKPS)
 data(NKPS2)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1884 observations on the following variables.
</p>

<dl>
<dt><code>C</code></dt><dd><p>Child's Gender (factor):
1 = Son
2 = Daughter
</p>
</dd>
<dt><code>P</code></dt><dd><p>Parent's Gender (factor):
1 = Father
2 = Mother
</p>
</dd>
<dt><code>CS</code></dt><dd><p>Child's sex role attitude (ordered):
1 = Nontrad.
2 = Mod. trad.
3 = Trad.
</p>
</dd>
<dt><code>PS</code></dt><dd><p>Parent's sex role attitude (ordered):
1 = Nontrad.
2 = Mod. trad.
3 = Trad.
</p>
</dd>
<dt><code>CM</code></dt><dd><p>Child's marriage attitude (ordered):
1 = Nontrad.
2 = Mod. trad.
3 = Trad.
</p>
</dd>
<dt><code>PM</code></dt><dd><p>Parent's marriage attitude (ordered):
1 = Nontrad.
2 = Mod. trad.
3 = Trad.
</p>
</dd>
</dl>



<h3>Source</h3>

<p>Dykstra, et al. (2004)
</p>


<h3>References</h3>

<p>Examples in book: <a href="http://stats.lse.ac.uk/bergsma/cmm/R%20files/NKPS.R">http://stats.lse.ac.uk/bergsma/cmm/R%20files/NKPS.R</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>
New York: Springer.
</p>
<p>Dykstra, P. A. Kalmijn, M., Knijn, T. C. M., Komter, A. E., Liefboer, A. C., &amp; Mulder, C. H. (2004).
<em>Codebook of the Netherlands Kinship Panel Study: A multi-actor, multi-method, panel study on solidarity, in family relationships. Wave 1</em>
(Tech. Rep. No. NKPS Working Paper 1).
The Hague, The Netherlands: NICI.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(NKPS)
attach(NKPS)

#######################################################################################
# Chapter 2

# Table 2.8
Table.2.8 &lt;- array(NA,c(4,4,4)); k &lt;- 0
for (i in levels(P)) for (j in levels(C)){
  k &lt;- k+1
  Table.2.8[,,k] &lt;- addmargins(t(table(NKPS[,c(3,4)] [C==j &amp; P==i,])))
}
dimnames(Table.2.8) &lt;- list(c(levels(PS),"Total"),c(levels(CS),"Total"),
                       c("Father-Son","Father-Daughter","Mother-Son","Mother-Daughter"))
Table.2.8

# Table 2.9
Table.2.9 &lt;- cbind(table(PS),table(CS),table(c(CS[C=="Son"],PS[P=="Father"])),
                   table(c(CS[C=="Daughter"],PS[P=="Mother"])))
dimnames(Table.2.9)[[2]] &lt;- c("Parent","Child","Men","Women")
addmargins(Table.2.9)[,-5]

# Table 2.10

# Table 2.11


########################################################
# Data
recAB = NKPS[,c(3,4)]
recPCAB = NKPS[,c(1,2,3,4)]
recA1A2B1B2 = NKPS[,c(3,4,5,6)]

# list of frequencies in table AB
nAB = c(t(ftable(recAB)))


########################################################
# table AB and GT
# at produces marginal distributions of A and B, or the 2x3 table GT; 
# G = generation and T = attititude
at &lt;- MarginalMatrix(c("A", "B"), list(c("A"), c("B")), c(3, 3));
bt &lt;- ConstraintMatrix(c("G", "T"), list(c("G"), c("T")), c(2, 3));

model1 &lt;- list(bt, "log", at);

nkps1 &lt;- MarginalModelFit(dat = recAB, model = model1, ShowParameters = TRUE, 
 Labels = list(list("G", c("men", "women")), "T"), 
 CoefficientDimensions = c(2, 3), ShowProgress = 10)

</code></pre>

<hr>
<h2 id='RecordsToFrequencies'>RecordsToFrequencies</h2><span id='topic+RecordsToFrequencies'></span>

<h3>Description</h3>

<p>Converts Records (units x variables) into a frequency vector.</p>


<h3>Usage</h3>

<pre><code class='language-R'>RecordsToFrequencies(dat, var = varDefault, dim = dimDefault, augment = "all", 
                            seed = FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RecordsToFrequencies_+3A_dat">dat</code></td>
<td>
<p>matrix or dataframe containing the scores of units (rows) on categorical variables (columns)</p>
</td></tr>
<tr><td><code id="RecordsToFrequencies_+3A_var">var</code></td>
<td>
<p>character or numeric vector containing variables. By default, all variables are selected.</p>
</td></tr>
<tr><td><code id="RecordsToFrequencies_+3A_dim">dim</code></td>
<td>
<p>numeric vector indicating the dimension of <code>var</code>. By default, the dimensions of each variable are derived from <code>dat</code></p>
</td></tr>
<tr><td><code id="RecordsToFrequencies_+3A_augment">augment</code></td>
<td>
<p>augmentation: determines the type of frequency vector. Select one of four options: 
<code>"all"</code> frequency vector contains all cells,
<code>"obs"</code> frequency vector contains only observed cells (cells with at least one observation),
<code>"1k"</code> frequency vector contains observed cells plus a selection of unobserved cells (see Van der Ark et al., 2023, for details),
<code>"2k"</code> frequency vector contains observed cells plus a wider selection of unobserved cells (see Van der Ark et al., 2023).</p>
</td></tr>
<tr><td><code id="RecordsToFrequencies_+3A_seed">seed</code></td>
<td>
<p>integer. As <code>aug</code> options <code>"1k"</code> and <code>"2k"</code> have a random components, a setting a will allow an exact replication of a CMM analysis when option <code>"1k"</code> or <code>"2k"</code> is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>matrix
</p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a> and L. A. van der Ark <a href="mailto:L.A.vanderArk@uva.nl">L.A.vanderArk@uva.nl</a>
</p>


<h3>References</h3>

<p>Van der Ark, L. A., Bergsma, W. P., &amp; Koopman L. (2023)
Maximum augmented empirical likelihood estimation of categorical marginal models for large sparse contingency tables. 
Paper submitted for publication.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MarginalMatrix">MarginalMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(acl)
dat &lt;- acl[, 1:2] + 1                                 # select 2 items from ACL 
var &lt;- 1 : ncol(dat)                                  # define the variables
marg &lt;- Margins(var, c(0, 1))                         # margins are total (0) and 1st order 
dim &lt;- rep(5, length(var))
t(RecordsToFrequencies(dat, var, dim, "obs"))         # frequency vector with observed cells
t(RecordsToFrequencies(dat, var, dim, "1k"))          # frequency vector with observed and
</code></pre>

<hr>
<h2 id='SampleStatistics'>SampleStatistics</h2><span id='topic+SampleStatistics'></span>

<h3>Description</h3>

<p>Gives sample values, standard errors and z-scores of one or more
coefficients. <code>SampleStatistics(dat,coeff)</code> gives exactly the same output as <code>ModelStatistics(dat,dat,"SaturatedModel",coeff)</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SampleStatistics(dat, coeff, CoefficientDimensions = "Automatic", 
 Labels = "Automatic", ShowCoefficients = TRUE, ParameterCoding = "Effect", 
 ShowParameters = FALSE, ShowCorrelations = FALSE, Title = "", ShowSummary = TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SampleStatistics_+3A_dat">dat</code></td>
<td>
<p>observed data as a list of frequencies or as a data frame</p>
</td></tr>
<tr><td><code id="SampleStatistics_+3A_coeff">coeff</code></td>
<td>
<p>list of coefficients, can be obtained using <code><a href="#topic+SpecifyCoefficient">SpecifyCoefficient</a></code>, or a predefined function such as <code>"log"</code></p>
</td></tr>
<tr><td><code id="SampleStatistics_+3A_coefficientdimensions">CoefficientDimensions</code></td>
<td>
<p>numeric vector of dimensions of the table in which the coefficient vector is to be arranged</p>
</td></tr>
<tr><td><code id="SampleStatistics_+3A_labels">Labels</code></td>
<td>
<p>list of characters or numbers indicating labels for dimensions of table in which the coefficient vector is to be arranged</p>
</td></tr>
<tr><td><code id="SampleStatistics_+3A_showcoefficients">ShowCoefficients</code></td>
<td>
<p>boolean, indicating whether or not the coefficients are to be displayed</p>
</td></tr>
<tr><td><code id="SampleStatistics_+3A_showparameters">ShowParameters</code></td>
<td>
<p>boolean, indicating whether or not the parameters (computed from the coefficients) are to be displayed</p>
</td></tr>
<tr><td><code id="SampleStatistics_+3A_parametercoding">ParameterCoding</code></td>
<td>
<p>Coding to be used for parameters, choice of <code>"Effect"</code>, <code>"Dummy"</code> and  <code>"Polynomial"</code></p>
</td></tr>
<tr><td><code id="SampleStatistics_+3A_showcorrelations">ShowCorrelations</code></td>
<td>
<p>boolean, indicating whether or not to show the correlation matrix for the estimated coefficients</p>
</td></tr>
<tr><td><code id="SampleStatistics_+3A_title">Title</code></td>
<td>
<p>Title of computation to appear at top of screen output</p>
</td></tr>
<tr><td><code id="SampleStatistics_+3A_showsummary">ShowSummary</code></td>
<td>
<p>Show summary on the screen</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data can be a data frame or vector of frequencies. <code>MarginalModelFit</code> converts a data frame <code>dat</code> using <code>c(t(ftable(dat)))</code>.
</p>
<p>For <code>ParameterCoding</code>, the default for <code>"Dummy"</code> is that the first cell in the table is the reference cell. Cell
<code class="reqn">(i,j,k,...)</code> can be made reference cell using <code>list("Dummy",c(i,j,k,...))</code>.
For <code>"Polynomial"</code> the default is to use centralized scores based on equidistant (distance 1)
linear scores, for example, if for <code class="reqn">i=1,2,3,4</code>,
</p>
<p style="text-align: center;"><code class="reqn">\mu_i=\alpha+q_i\beta+r_i\gamma+s_i\delta</code>
</p>
<p> where
<code class="reqn">\beta</code> is a quadratic, <code class="reqn">\gamma</code> a cubic and <code class="reqn">\delta</code> a quartic effect,
then <code class="reqn">q_i</code> takes the values <code class="reqn">(-1.5,-.5,.5,1.5)</code>, <code class="reqn">r_i</code>
takes the values <code class="reqn">(1,-1,-1,1)</code> (centralized squares of the <code class="reqn">q_i</code>),
and <code class="reqn">s_i</code> takes the values <code class="reqn">(-3.375,-.125,.125,3.375)</code> (cubes of the <code class="reqn">q_i</code>).
</p>


<h3>Value</h3>

<p>A subset of the output of <code>MarginalModelFit</code>.
</p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ModelStatistics">ModelStatistics</a></code>, <code><a href="#topic+MarginalModelFit">MarginalModelFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(BodySatisfaction)

## Table 2.6 in Bergsma, Croon and Hagenaars (2009). Loglinear parameters for marginal table IS
## We provide two to obtain the parameters

dat   &lt;- BodySatisfaction[,2:8]        # omit first column corresponding to gender

# matrix producing 1-way marginals, ie the 7x5 table IS
at75 &lt;- MarginalMatrix(var = c(1, 2, 3, 4, 5, 6, 7), 
 marg = list(c(1),c(2),c(3), c(4),c(5),c(6),c(7)), dim = c(5, 5, 5, 5, 5, 5, 5))

# First method: the "coefficients" are the log-probabilities, from which all the 
# (loglinear) parameters are calculated
stats &lt;- SampleStatistics(dat = dat, coeff = list("log",at75), CoefficientDimensions = c(7, 5),
 Labels = c("I", "S"), ShowCoefficients = FALSE, ShowParameters = TRUE)

# Second method: the "coefficients" are explicitly specified as being the 
# (highest-order) loglinear parameters
loglinpar75 &lt;- SpecifyCoefficient("LoglinearParameters", c(7, 5))
stats &lt;- SampleStatistics(dat = dat, coeff = list(loglinpar75, at75), 
 CoefficientDimensions = c(7,5), Labels = c("I","S"))

## End(Not run)
</code></pre>

<hr>
<h2 id='Smoking'>Smoking cessation after experimental intervention</h2><span id='topic+Smoking'></span>

<h3>Description</h3>

<p>Data from an experiment designed for the investigation of the
effectiveness of a particular expert system intervention to convince
people to quit smoking. <code class="reqn">N = 4,144</code> subjects
were randomly assigned to either the control (assessment only) or the
experimental condition (TTM intervention). Information was
collected on their smoking habits and their attitudes towards
smoking at the start of the study, at the sixth, twelfth, eighteenth, and twenty-fourth
month. For more detailed information see Bergsma et al. (2009) and Prochaska et al. (2001).
</p>
<p>The data are tabulated in Bergsma, Croon, and Hagenaars (2009, Tables 5.11 to 5.14).
</p>
<p>Section 5.2.3 in Bergsma, Croon and Hagenaars (2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Smoking)</code></pre>


<h3>Format</h3>

<p>A data frame with 4144 observations on the following variables.
</p>

<dl>
<dt><code>Group</code></dt><dd><p>(factor):
1 = TTM intervention;
2 = Assessment only.
</p>
</dd>
<dt><code>smst00</code></dt><dd><p>Behavior at beginning (ordered):
1 = Precontemplation;
2 = Contemplation;
3 = Preparation;
4 = Action;
5 = Maintenance.
</p>
</dd>
<dt><code>smst06</code></dt><dd><p>Behavior after 6 months (ordered): see <code>smst00</code></p>
</dd>
<dt><code>smst12</code></dt><dd><p>Behavior after 12 months (ordered): see <code>smst00</code></p>
</dd>
<dt><code>smst18</code></dt><dd><p>Behavior after 18 months (ordered): see <code>smst00</code></p>
</dd>
<dt><code>smst24</code></dt><dd><p>Behavior after 24 months (ordered): see <code>smst00</code></p>
</dd>
</dl>



<h3>Source</h3>

<p>Cancer Prevention Research Center, Univisity of Rhode Island, US.
See Prochaska, Velicer, Fave, Rossi &amp; Tosh (2001).
</p>


<h3>References</h3>

<p>Examples in book: <a href="http://stats.lse.ac.uk/bergsma/cmm/R%20files/Smoking.R">http://stats.lse.ac.uk/bergsma/cmm/R%20files/Smoking.R</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
<em>Marginal models for dependent, clustered, and longitudinal categorical data.</em>
New York: Springer.
</p>
<p>Prochaska, J. O., Velicer, W. F., Fava, J. L. Rossi, J. S., &amp; Tosh, J. Y. (2001).
Evaluating a population-based recruitment approach and a stage-based expert system intervention for smoking cessation.
<em>Addictive Behaviors, 26</em>, 583-602.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>####################################################################################
# Read data
data(Smoking)

## Not run: 

dat &lt;- Smoking

####################################################################################
# Table TXBR
# matrix producing 4x2x3x6 table TXBR

atTXBR &lt;- MarginalMatrix(var = c("X", "B", "R1", "R2", "R3", "R4"), 
 marg = list(c("X", "B", "R1"), c("X", "B", "R2"), c("X", "B", "R3"), c("X", "B", "R4")), 
 dim = c(2, 3, 5, 5, 5, 5))
bt  &lt;- ConstraintMatrix(var = c("T", "X", "B", "R"), suffconfigs = list(c("T", "X", "B"), c("R")), 
 dim = c(4, 2, 3, 5))
model = list(bt, "log", atTXBR)

fit = MarginalModelFit(dat = dat, model = model, MaxStepSize = .3, MaxSteps = 100, 
 ShowProgress = 5)

## End(Not run)

</code></pre>

<hr>
<h2 id='SpecifyCoefficient'>SpecifyCoefficient</h2><span id='topic+SpecifyCoefficient'></span>

<h3>Description</h3>

<p>Gives the generalized exp-log specification for various coefficients</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpecifyCoefficient(name, arg = NULL, rep = 1, data = NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SpecifyCoefficient_+3A_name">name</code></td>
<td>
<p>character: name of desired coefficient</p>
</td></tr>
<tr><td><code id="SpecifyCoefficient_+3A_arg">arg</code></td>
<td>
<p>an argument specific to the coefficient, e.g., a vector of scores or number of rows and colums. </p>
</td></tr>
<tr><td><code id="SpecifyCoefficient_+3A_data">data</code></td>
<td>
<p>data set. Necessary for MEL estimation</p>
</td></tr>
<tr><td><code id="SpecifyCoefficient_+3A_rep">rep</code></td>
<td>
<p>number of repetitions of the coefficient</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently the following coefficients are implemented:
</p>
<pre>
 SpecifyCoefficient("Mean",arg = scores)
 SpecifyCoefficient("Variance", arg = scores)
 SpecifyCoefficient("StandardDeviation", arg = scores)
 SpecifyCoefficient("GiniMeanDifference", arg = scores)
 SpecifyCoefficient("Entropy", arg = k)
 SpecifyCoefficient("DiversityIndex", arg = k)
 SpecifyCoefficient("Covariance",arg = list(xscores,yscores))
 SpecifyCoefficient("Correlation",arg = list(xscores,yscores))
 SpecifyCoefficient("KendallTau",arg = list(r,c))
 SpecifyCoefficient("GoodmanKruskalGammma",arg = list(r,c))
 SpecifyCoefficient("CohenKappa",r)
 SpecifyCoefficient("CronbachAlpha",arg = list(items,item.scores), data = X) 
 SpecifyCoefficient("Hij")
 SpecifyCoefficient("DifferenceInProportions",arg = m)
 SpecifyCoefficient("LogOddsRatio")
 SpecifyCoefficient("LoglinearParameters",arg = dim)
 SpecifyCoefficient("Probabilities",arg = dim)
 SpecifyCoefficient("LogProbabilities",arg = dim)
 SpecifyCoefficient("ConditionalProbabilities",arg = list(var,condvar,dim))
 SpecifyCoefficient("AllMokkenHj", arg = list(items,item.scores), data = X)
 SpecifyCoefficient("MokkenH", arg = list(items,item.scores), data = X)
 SpecifyCoefficient("OrdinalLocation-A", arg = arg)
 SpecifyCoefficient("OrdinalLocation-L", arg = arg)
 SpecifyCoefficient("OrdinalDispersion-A", arg = arg)
 SpecifyCoefficient("OrdinalDispersion-L", arg = arg)
</pre>
<p>Here,  <code>scores</code> is a score vector, e.g., <code>c(1,2,3,4,5)</code>; <code>k</code> is the number of cells in a table;
<code>r</code> is the number of rows and columns of a square table; <code>dim</code> is the dimension of the table; <code>items</code> are the columns
in the data matrix that should be used for compuing the statistic; <code>item.scores</code> is the number of item scores (e.g., 2 for dichotomous items,
or 5 for Likert items); <code>X</code> is the NxJ data matrix. <code>"LoglinearParameters"</code>
gives the highest order loglinear parameters (loglinear parameters can also be obtained as output of <code>SampleStatistics</code>,
<code>ModelStatistics</code> or <code>MarginalModelFit</code> by setting <code>ShowParameters=TRUE</code> and the coefficients equal to log probabilities.
</p>


<h3>Value</h3>

<p>output is of the form <code>list(matlist,funlist)</code> where <code>matlist</code> is a list of matrices and <code>funlist</code> is a list of function names,
which can currently be <code>"log"</code>, <code>"exp"</code>, <code>"identity"</code>, <code>"xlogx"</code> (i.e., <code class="reqn">f(x)=x\log(x)</code>), 
<code>"xbarx"</code> (i.e., <code class="reqn">f(x)=x(1-x)</code>), <code>"sqrt"</code>
</p>


<h3>Author(s)</h3>

<p>W. P. Bergsma <a href="mailto:w.p.bergsma@lse.ac.uk">w.p.bergsma@lse.ac.uk</a>
</p>


<h3>References</h3>

<p>Bergsma, W. P. (1997).
<em>Marginal models for categorical data</em>.
Tilburg, The Netherlands: Tilburg University Press.
<a href="http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf">http://stats.lse.ac.uk/bergsma/pdf/bergsma_phdthesis.pdf</a>
</p>
<p>Bergsma, W. P., Croon, M. A., &amp; Hagenaars, J. A. P. (2009).
Marginal models for dependent, clustered, and longitudunal categorical data.
Berlin: Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ConstraintMatrix">ConstraintMatrix</a></code>, <code><a href="#topic+DesignMatrix">DesignMatrix</a></code>, <code><a href="#topic+MarginalMatrix">MarginalMatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   SpecifyCoefficient("Mean",arg = c(1,2,3))
   SpecifyCoefficient("Variance",arg = c(1,2,3))
   SpecifyCoefficient("StandardDeviation",arg = c(1,2,3))
   SpecifyCoefficient("GiniMeanDifference",arg = c(1,2,3))
   SpecifyCoefficient("Entropy",arg = 5)
   SpecifyCoefficient("DiversityIndex",arg = 5)
   SpecifyCoefficient("Covariance",arg = list(c(1,2,3),c(1,2,3)))
   SpecifyCoefficient("Correlation",arg = list(c(1,2,3),c(1,2,3)))
   SpecifyCoefficient("KendallTau",arg = list(3,4))
   SpecifyCoefficient("GoodmanKruskalGammma",arg = list(3,4))
   SpecifyCoefficient("CohenKappa",arg = 3)
   SpecifyCoefficient("DifferenceInProportions",arg = 1)
   SpecifyCoefficient("LogOddsRatio",arg = 1)
   SpecifyCoefficient("LoglinearParameters",arg = c(3,3))
   SpecifyCoefficient("Probabilities",arg = 8)
   SpecifyCoefficient("LogProbabilities",arg = 8)
   # conditional probabilities for 3x3 table, conditioning on first variable
   SpecifyCoefficient("ConditionalProbabilities",arg = list(c(1,2),c(1),c(3,3)))
</code></pre>

<hr>
<h2 id='TestCronbachAlpha'>Testing Cronbach's alpha using marginal models</h2><span id='topic+TestCronbachAlpha'></span>

<h3>Description</h3>

<p>Data set <code>TestCronbachAlpha</code> is a simulated data set that is used to demonstrate 
the statistical testing of three relevant hypotheses involving Cronbach's alpha:
H01: alpha equals a particular criterion;
H02: testing the equality of two alpha coefficients for independent samples; and
H03: testing the equality of two alpha coefficients for dependent samples.
</p>
<p>This R document file may be regarded as an appendix to Kuijpers, Van der Ark, and Croon (2012) who discussed this topic.
Hence, all references to equations pertain to this paper.
The <em>Details</em> section describes the required objects for testing the three hypotheses.
The <em>Examples</em> section describes the actual code required for for testing the three hypotheses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(TestCronbachAlpha)</code></pre>


<h3>Format</h3>

<p>A 400 by 21 matrix, representing the dichotomous item scores of 400 respondents from two groups for two tests.
The first column is the grouping variable: Group <code>1</code> and Group <code>2</code> each consist of 200 observations. 
Columns 2-11 are the items score of Test 1. Columns 12-21 are the item scores of Test 2. So each test includes 
<em>J</em> = 10 items having <em>K</em> = 2 item scores.
Note that in Kuijpers et al. (2012), <em>k</em> is used rather than <em>K</em>; <em>k</em> = <em>K</em> - 1.
Data files
<code style="white-space: pre;">&#8288;TestCronbachAlphaH1 &lt;- TestCronbachAlpha[1:200,2:11]&#8288;</code>
<code style="white-space: pre;">&#8288;TestCronbachAlphaH2 &lt;- TestCronbachAlpha[1:400,1:11]&#8288;</code>
and
<code style="white-space: pre;">&#8288;TestCronbachAlphaH3 &lt;- TestCronbachAlpha[1:200,2:21]&#8288;</code>
will be used to test hypotheses H01, H02, and H03, respectively.
</p>


<h3>Details</h3>

<p>Vector <b>m</b> is estimated under the general categorical marginal model <b>g</b>(<b>m</b>) = <b>d</b>.
Objects <code>coeff</code>, <code>bt</code>, and <code>at</code> define function <b>g</b>(<b>m</b>).
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>coeff</code> </td><td style="text-align: left;"> Includes the design matrices and functions (i.e., exp and log) of the coefficients  of interest. </td>
</tr>
<tr>
 <td style="text-align: left;">      
              </td><td style="text-align: left;"> Function <a href="#topic+SpecifyCoefficient">SpecifyCoefficient</a> returns the design matrices and functions of several prespecified coefficients, including Cronbach's alpha. </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> The argument <code>arg</code> in <a href="#topic+SpecifyCoefficient">SpecifyCoefficient</a> specifies for which of the <em>J</em> marginals Cronbach's alpha should be computed, and it specifies the number of response categories <em>K</em>. </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> Furthermore, the argument <code>data</code> in <a href="#topic+SpecifyCoefficient">SpecifyCoefficient</a> specifies for which data set Cronbach's alpha should be computed (for example for data set <code>mydata</code>). </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">                                                                                                        </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> For hypothesis H01, which involves only one Cronbach's alpha, <code>coeff</code> is obtained by              </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">  <code style="white-space: pre;">&#8288;coeff = SpecifyCoefficient(name = "CronbachAlpha", arg = list(list(1 : J), K), data = mydata)&#8288;</code>  </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> For H01, object <code>coeff</code> includes the design matrices and functions in Equation 10.                </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">                                                                                                        </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> For hypothesis H02, which involves two alpha coefficients derived from two independent samples, <code>coeff</code> is obtained by </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;coeff = SpecifyCoefficient(name = "CronbachAlpha", arg = list(list(2 : (J + 1), 2 : (J + 1)), c(K, K), 1), data = mydata, )&#8288;</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> For H02, <code>coeff</code> now includes the design matrices and functions in Equation 19. </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">                                                                                                        </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> For hypothesis H03, which involves two dependent alpha coefficients, <code>coeff</code> is obtained by       </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> <code style="white-space: pre;">&#8288;coeff = SpecifyCoefficient(name="CronbachAlpha", arg=list(list(test1, test2),c(K,K)), data=mydata,)&#8288;</code></td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> For H03, object <code>coeff</code> includes the design matrices and functions in Equation 23. </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">                                                                                                        </td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>bt</code>    </td><td style="text-align: left;"> Is called the <em>constraint matrix</em> and relates the  coefficients defined in <code>coeff</code>. Hypothesis H01 pertains to one Cronbach's alpha, so <code>bt</code> is the scalar 1. For hypotheses H02 and H03 <code>bt</code> equals design matrix A6. </td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;">                                                                                                        </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>at</code>     </td><td style="text-align: left;"> Is called the <em>marginal matrix</em>. The marginal matrix was not specified for hypotheses H01 and H02, which is equivalent to including the identity matrix as the marginal matrix in Equations 10 (H01) and 18 (H02). Hence <code>at</code> = <b>I</b>.</td>
</tr>
<tr>
 <td style="text-align: left;">
              </td><td style="text-align: left;"> For hypotheses H03 the marginal matrix is equal to design matrix <b>A</b>_0 (p. 16). Function <a href="#topic+MarginalMatrix">MarginalMatrix</a> constructs the marginal matrix. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>d</code>      </td><td style="text-align: left;"> Vector <b>d</b> in Equation 9.</td>
</tr>
<tr>
 <td style="text-align: left;">               
</td>
</tr>

</table>

<p>Function  <a href="#topic+MarginalModelFit">MarginalModelFit</a> estimates the categorical marginal model (CMM), and requires the following arguments: the vector of observed frequencies, <code>n</code>, and model 
specifications in <code>coeff</code>, <code>bt</code>, <code>at</code>, and <code>d</code>.
</p>
<p>In the example for testing hypothesis H01, data set <code>TestCronbachAlphaH1</code> was used, which contained the 200 item-score vectors from the first group,
for the first test. For this data set, Cronbach's alpha is equal to 0.793. If a researcher wants to test whether this value is 
significantly above .75, the software code for the first example in the paragraph
<code>Examples</code> can be used (see below). First, the R package <code>cmm</code> needs to be invoked. Second, vector <b>n</b>,
the number of items <em>J</em>, the number of categories <em>K</em>, and criterion <em>c</em> in hypothesis H01 have to be defined. 
The fit of this marginal model
is evaluated by <em>G</em>^2, with <em>D</em> = 1 degree of freedom. In general, <em>G</em>^2 pertains to a two-sided test. However, here H01 is a one-sided hypothesis,
the value of <em>G</em>^2 at the 2 alpha level is used. For alpha = 0.05, H01 must be rejected if <em>G</em>^2 &gt; 2.71 (i.e., <em>p</em> = .10) and r_alpha &gt; c.
The results of the analysis show that <em>G</em>^2 = 3.301 with <em>p</em> = 0.069, so for this example we can conclude that the alpha of this data set (i.e.,
r_alpha = 0.793) is significantly above .75.
</p>
<p>For testing hypothesis H02, data set <code>TestCronbachAlphaH2</code> was used, which contained the item-score vectors from the two independent groups for the first 
test, and an additional variable indicating group membership.
For this data set, Cronbach's alpha for the first independent group is equal to 0.793, for the second independent group alpha is equal to 0.737. To test
whether the alphas of the two independent groups are equal, the software code for the second example in the paragraph <em>Examples</em> can be used (see below).
Note that the first item indicates group membership. Hence, for <em>J</em> items, vector <b>n</b> is based on <em>J</em>+1 patterns. <em>G</em>^2 is used to assess the 
fit of this marginal model with <em>D</em> = 1 degree of freedom, so H02 must be rejected if <em>G</em>^2 &gt; 3.84 (i.e., alpha = .05).
The results of the analysis show that <em>G</em>^2 = 2.774 with <em>p</em> = 0.096, so for this example we can conclude that the alphas of the two independent samples
(i.e., r_alpha_g1 = 0.793 and r_alpha_g1 = 0.737) are equal.
</p>
<p>For hypothesis H03, data set <code>TestCronbachAlphaH3</code> was used, which contained the 200 item-score vectors from the first group for the two tests. 
The data of each test forms one dependent group. For this data set,
Cronbach's alpha for the first dependent group is equal to 0.793, for the second dependent group alpha is equal to 0.696. For H03, the marginal matrix
is not implemented in the package as a code yet, so it has to be computed ad hoc. To test whether the alphas of the two dependent groups are equal, the
software code for the third example in the paragraph <em>Examples</em> can be used (see below). <em>G</em>^2 is used to assess the fit of this marginal model
with <em>D</em> = 1 degree of freedom. The results of the analysis show that <em>G</em>^2 = 9.898 with <em>p</em> = 0.002. Using alpha = .05, we can conclude 
that the alphas of the two dependent samples (i.e., r_alpha_t1 = 0.793 and r_alpha_t1 = 0.696) are not equal to each other.
</p>


<h3>Author(s)</h3>

<p>Renske E. Kuijpers, L. Andries van der Ark</p>


<h3>References</h3>

<p>Kuijpers, R. E., Van der Ark, L. A., &amp; Croon, M. A. (2012).
Testing hypotheses involving Cronbach's alpha using marginal models.
Manuscript submitted for publication.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cmm">cmm</a>, <a href="#topic+SpecifyCoefficient">SpecifyCoefficient</a>, <a href="#topic+MarginalMatrix">MarginalMatrix</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(TestCronbachAlpha)

#Example 1: Testing H01.
  
  # Invoke cmm
  library(cmm)

  # Data
  TestCronbachAlphaH1 &lt;- TestCronbachAlpha[1 : 200, 2 : 11]
  
  # Transform data into vector of frequencies n
  n &lt;- as.matrix(table(apply(TestCronbachAlphaH1, 1, paste, collapse = "")))

  # Specify number of items
  J &lt;- 10 
  
  # Specify number of item scores
  K &lt;- 2 
  
  # Specify criterion for Hypothesis H01
  criterion &lt;- .75

  # Compute object coeff
  coeff &lt;- SpecifyCoefficient(name = "CronbachAlpha", arg = list(list(1 : J), K),
    data = TestCronbachAlphaH1)

  # Compute object at (marginal matrix)
  L &lt;- ncol(coeff[[1]][[5]])
  at &lt;- diag(L)

  # Compute object bt (constraint matrix)
  bt &lt;- matrix(1)
  
  # Compute object d
  d &lt;- criterion

  # Compute CMM
  model &lt;- list(bt, coeff, at, d)
  fit &lt;- MarginalModelFit(n, model, MaxError = 1e-04)

#Example 2: Testing H02.
          
  # Data
  TestCronbachAlphaH2 &lt;- TestCronbachAlpha[1 : 400, 1 : 11]
  
  # Transform data into vector of frequencies n
  n &lt;- as.matrix(table(apply(TestCronbachAlphaH2, 1, paste, collapse = "")))

  # Specify number of items
  J &lt;- 10

  # Specify number of item scores
  K &lt;- 2
  
  # Compute object coeff
  coeff &lt;- SpecifyCoefficient(name = "CronbachAlpha", arg = list(list(2 : (J + 1),
    2 : (J + 1)), c(K, K), 1), data = TestCronbachAlphaH2,)

  # Compute object at (marginal matrix)
  L &lt;- ncol(coeff[[1]][[5]])
  at &lt;- diag(L)

  # Compute object bt (constraint matrix)
  bt &lt;- matrix(c(1,-1),1,2)

  # Compute object d
  d &lt;- rep(0,nrow(bt))

  # Compute CMM
  model &lt;- list(bt,coeff,at,d)
  fit &lt;- MarginalModelFit(n, model, MaxError = 1e-04)
  
#Example 3: Testing H03.
          
  # Data
  TestCronbachAlphaH3 &lt;- TestCronbachAlpha[1 : 200, 2 : 21]

  # Transform data into vector of frequencies n
  n &lt;- as.matrix(table(apply(TestCronbachAlphaH3, 1, paste, collapse = "")))

  # Specify number of items
  J &lt;- 20

  # Specify number of item scores
  K &lt;- 2
  
  # Specify which items belong to which test
  test1 &lt;-  1 : 10
  test2 &lt;- 11 : 20
  
  # Compute object coeff
  coeff &lt;- SpecifyCoefficient(name = "CronbachAlpha", arg = list(list(test1,
     test2), c(K, K)), data = TestCronbachAlphaH3,)

  # Compute object at (marginal matrix)
  x &lt;- dimnames(n)[[1]]
  p1 &lt;- sort(unique(substr(x, test1[1] ,test1[length(test1)])))
  p2 &lt;- sort(unique(substr(x, test2[1] ,test2[length(test2)])))
  U1 &lt;- matrix(NA, length(p1), length(x))
  for (h1 in 1 : length(p1))
  U1[h1, ] &lt;- as.numeric(substr(x, test1[1], test1[length(test1)]) == p1[h1])
  U2 &lt;- matrix(NA, length(p2), length(x))
  for (h2 in 1 : length(p2))
  U2[h2, ] &lt;- as.numeric(substr(x, test2[1], test2[length(test2)]) == p2[h2])
  at &lt;- rbind(U1, U2)

  # Compute object bt (constraint matrix)
  bt &lt;- matrix(c(1, -1), 1, 2)

  # Compute object d
  d &lt;- rep(0, nrow(bt))

  # Compute CMM
  model &lt;- list(bt, coeff, at, d)
  fit &lt;- MarginalModelFit(n, model, MaxError = 1e-04)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
