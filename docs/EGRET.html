<!DOCTYPE html><html><head><title>Help for package EGRET</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EGRET}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.egret'><p>Create named list for EGRET analysis</p></a></li>
<li><a href='#blankTime'><p>Deletes the computed values during periods of time when there are no sample data</p></a></li>
<li><a href='#boxConcMonth'><p>Box plot of the water quality data by month</p></a></li>
<li><a href='#boxConcThree'><p>Three box plots side-by-side</p></a></li>
<li><a href='#boxQTwice'><p>Two box plots side-by-side, discharge on sample days, and discharge on all days</p></a></li>
<li><a href='#boxResidMonth'><p>A box plot of WRTDS residuals by month</p></a></li>
<li><a href='#calculateMonthlyResults'><p>Calculates monthly mean values of Q, Conc, FNConc, Flux, and FNFlux for the entire record.  If WRTDSKalman has been run it also includes the monthly mean values of GenConc and GenFlux.</p></a></li>
<li><a href='#censoredSegments'><p>Generic plotting function to create censored line segments</p></a></li>
<li><a href='#checkStartEndDate'><p>checkStartEndDate</p></a></li>
<li><a href='#checkSurfaceSpan'><p>checkSurfaceSpan</p></a></li>
<li><a href='#Choptank_eList'><p>Example eList</p></a></li>
<li><a href='#cleanUp'><p>cleanUp eList</p></a></li>
<li><a href='#compressData'><p>Compress sample data frame</p></a></li>
<li><a href='#concUnit-class'><p>concUnit class</p></a></li>
<li><a href='#Constants'><p>Constants included with EGRET</p></a></li>
<li><a href='#cumQdate'><p>Cumulative flow calculation</p></a></li>
<li><a href='#dataOverview'><p>Data Overview for WRTDS</p></a></li>
<li><a href='#dateFormatCheck'><p>Check date format</p></a></li>
<li><a href='#decimalDate'><p>decimalDate</p></a></li>
<li><a href='#decimalHighLow'><p>decimalHighLow</p></a></li>
<li><a href='#EGRET-package'><p>EGRET package includes WRTDS and flowHistory</p></a></li>
<li><a href='#errorStats'><p>Error statistics</p></a></li>
<li><a href='#estCrossVal'><p>Jack-Knife cross validation of the WRTDS (Weighted Regressions on Time, Discharge, and Season)</p></a></li>
<li><a href='#estDailyFromSurfaces'><p>Estimates all daily values of Concentration, Flux, Flow-Normalized Concentration, and Flow Normalized Flux</p></a></li>
<li><a href='#estSurfaces'><p>Estimate the three surfaces (for yHat, SE and ConcHat) as a function of DecYear and logQ and store in the three-dimensional object called surfaces</p></a></li>
<li><a href='#fixSampleFrame'><p>Update Sample dataframe</p></a></li>
<li><a href='#flexFN'><p>Flexible Flow Normalization</p></a></li>
<li><a href='#flexPlotAddOn'><p>Flexible Flow Normalization Plot Add On</p></a></li>
<li><a href='#flowDuration'><p>Computes several values of the flow duration curve for streamflow centered on a specific date of the year</p></a></li>
<li><a href='#fluxBiasMulti'><p>Produces 8-panel plot that is useful for determining if there is a flux bias problem</p></a></li>
<li><a href='#fluxBiasStat'><p>Compute the flux bias statistic: (mean of estimated flux - mean of observed flux)  / mean of estimated flux</p></a></li>
<li><a href='#fluxUnit-class'><p>fluxUnit class</p></a></li>
<li><a href='#generalAxis'><p>Axis generation for log discharge</p></a></li>
<li><a href='#genericEGRETDotPlot'><p>Generic EGRET plotting function</p></a></li>
<li><a href='#genmissing'><p>genmissing</p></a></li>
<li><a href='#getDaily'><p>Get Daily dataframe from EGRET object</p></a></li>
<li><a href='#getInfo'><p>Get INFO dataframe from EGRET object</p></a></li>
<li><a href='#getSample'><p>Get Sample dataframe from EGRET object</p></a></li>
<li><a href='#getSurfaces'><p>Get surfaces matrix from EGRET object</p></a></li>
<li><a href='#INFOdataframe'><p>Import metadata to create INFO data frame</p></a></li>
<li><a href='#is.egret'><p>Check for EGRET object</p></a></li>
<li><a href='#jitterSam'><p>jitter Sample</p></a></li>
<li><a href='#logPretty1'><p>Sets up tick marks for an axis with a log scale, where the graph is small</p></a></li>
<li><a href='#logPretty3'><p>Sets up tick marks for an axis with a log scale</p></a></li>
<li><a href='#makeAnnualSeries'><p>Produces annual series of 8 streamflow statistics (and a lowess smooth of them) from daily streamflow data</p></a></li>
<li><a href='#makeAugmentedSample'><p>Create randomized residuals and observations for data sets that have some censored data</p></a></li>
<li><a href='#makeDateInfo'><p>makeDateInfo</p></a></li>
<li><a href='#mergeReport'><p>mergeReport</p></a></li>
<li><a href='#modelEstimation'><p>Estimation process for the WRTDS (Weighted Regressions on Time, Discharge, and Season)</p></a></li>
<li><a href='#monthLabel-class'><p>monthLabel class</p></a></li>
<li><a href='#multiPlotDataOverview'><p>Produces a 4 panel plot that gives an overview of the data set prior to any processing</p></a></li>
<li><a href='#plot15'><p>Makes 15 graphs of streamflow statistics on a single page.  These encompass the 7-day minimum, mean, and 1-day maximum for each of the following 5 Periods of Analysis: Annual, Fall, Winter, Spring and Summer.</p></a></li>
<li><a href='#plot1of15'><p>plots 1 of the 15 graphs of streamflow statistics on a single page</p></a></li>
<li><a href='#plotConcHist'><p>Graph of annual concentration and flow normalized concentration versus year</p></a></li>
<li><a href='#plotConcPred'><p>Plot of Observed Concentration versus Estimated Concentration</p></a></li>
<li><a href='#plotConcQ'><p>Plot of Observed Concentration versus Discharge</p></a></li>
<li><a href='#plotConcQSmooth'><p>Plot up to three curves representing the concentration versus discharge relationship. Each curve is a different point in time.</p></a></li>
<li><a href='#plotConcTime'><p>Plot of Observed Concentration versus Time</p></a></li>
<li><a href='#plotConcTimeDaily'><p>Plot of the time series of daily concentration estimates and the sample values for the days that were sampled</p></a></li>
<li><a href='#plotConcTimeSmooth'><p>Plot up to three curves representing the concentration versus time relationship, each curve representing a different flow.</p></a></li>
<li><a href='#plotContours'><p>Color contour plot of the estimated surfaces as a function of discharge and time (surfaces include log concentration, standard error, and concentration)</p></a></li>
<li><a href='#plotDiffContours'><p>Plots the difference between two years from a contour plot created by plotContours</p></a></li>
<li><a href='#plotFlowSingle'><p>Creates a plot of a time series of a particular flow statistic and a loess smooth of that flow statistic</p></a></li>
<li><a href='#plotFluxHist'><p>Graph of annual flux and flow normalized flux versus year</p></a></li>
<li><a href='#plotFluxPred'><p>Graph of observed versus estimated flux</p></a></li>
<li><a href='#plotFluxQ'><p>Sample data plot: observed log flux vs log discharge</p></a></li>
<li><a href='#plotFluxTimeDaily'><p>Plot of the time series of daily flux estimates and the sample values for the days that were sampled</p></a></li>
<li><a href='#plotFour'><p>Makes four graphs of streamflow statistics on a single page</p></a></li>
<li><a href='#plotFourStats'><p>Makes four graphs of annual streamflow statistics on a single page</p></a></li>
<li><a href='#plotMonthTrend'><p>Plot monthly trend result from runPairs</p></a></li>
<li><a href='#plotQTimeDaily'><p>Plot of the discharge time series</p></a></li>
<li><a href='#plotResidPred'><p>Plot of the residuals from WRTDS versus the estimated values (all in log concentration units)</p></a></li>
<li><a href='#plotResidQ'><p>Plot of the residuals from WRTDS (in log concentration units) versus the discharge</p></a></li>
<li><a href='#plotResidTime'><p>Plot of the residuals from WRTDS (in log concentration units) versus time</p></a></li>
<li><a href='#plotSDLogQ'><p>Graph of the standard deviation of the log of daily discharge versus year</p></a></li>
<li><a href='#plotTimeSlice'><p>plotTimeSlice</p></a></li>
<li><a href='#plotWRTDSKalman'><p>plotWRTDSKalman</p></a></li>
<li><a href='#populateConcentrations'><p>Populate Concentration Columns</p></a></li>
<li><a href='#populateDaily'><p>Populate Daily data frame</p></a></li>
<li><a href='#populateDailySamp'><p>Merge concentration to Daily</p></a></li>
<li><a href='#populateDateColumns'><p>Populate Date Columns</p></a></li>
<li><a href='#populateParameterINFO'><p>Populate Parameter Information Columns</p></a></li>
<li><a href='#populateSampleColumns'><p>Populate Sample Columns</p></a></li>
<li><a href='#populateSiteINFO'><p>Populate Site Information Columns</p></a></li>
<li><a href='#print.egret'><p>EGRET helper functions</p></a></li>
<li><a href='#printFluxUnitCheatSheet'><p>Reminder to user of flux unit properties  (such as kg/day, tons/year, etc).</p></a></li>
<li><a href='#printGroups'><p>Print information about group analysis</p></a></li>
<li><a href='#printPairs'><p>Print information about pairs analysis</p></a></li>
<li><a href='#printqUnitCheatSheet'><p>Reminder to user of flow Unit properties such as cubic meters per second or thousands of cubic feet per second.</p></a></li>
<li><a href='#printSeries'><p>Print annual results for a given streamflow statistic</p></a></li>
<li><a href='#processQWData'><p>Processing of Water Quality Data</p></a></li>
<li><a href='#qUnit-class'><p>qUnit class</p></a></li>
<li><a href='#randomSubset'><p>randomSubset</p></a></li>
<li><a href='#readDataFromFile'><p>Basic Data Import for Water Flow Data</p></a></li>
<li><a href='#readNWISDaily'><p>Import NWIS Daily Data for EGRET analysis</p></a></li>
<li><a href='#readNWISSample'><p>Import NWIS Sample Data for EGRET analysis</p></a></li>
<li><a href='#readUserDaily'><p>Import user daily data for EGRET analysis</p></a></li>
<li><a href='#readUserSample'><p>Import user-supplied sample data for EGRET analysis</p></a></li>
<li><a href='#readWQPSample'><p>Import Sample Data from the Water Quality Portal for WRTDS</p></a></li>
<li><a href='#removeDuplicates'><p>Remove duplicates values from Sample data frame.</p></a></li>
<li><a href='#runGroups'><p>Runs a comparison of any group of years in the record.</p></a></li>
<li><a href='#runPairs'><p>Runs a comparison of any two years in the record.</p></a></li>
<li><a href='#runSeries'><p>Annual series of flow-normalized concentration and flow-normalized flux</p></a></li>
<li><a href='#runSurvReg'><p>Run the weighted survival regression for a set of estimation points (defined by DecYear and Log(Q))</p></a></li>
<li><a href='#saveResults'><p>A utility program for saving the contents of the workspace</p>
</p>
<p>This function saves the workspace. Future versions of EGRET will not include this function,</p>
use saveRDS to save individual eList objects.
It assigns the file a name using the abbreviations for station and constituent.</a></li>
<li><a href='#selectDays'><p>Creates a subset Daily data frame that only contains daily estimates for the specified period of analysis</p></a></li>
<li><a href='#setPA'><p>Sets up the period of analysis (the portion of the year being evaluated).</p></a></li>
<li><a href='#setSeasonLabel'><p>Create a character variable that describes the period of analysis, when period of analysis has already been set in AnnualResults</p></a></li>
<li><a href='#setSeasonLabelByUser'><p>Creates a character variable that describes the period of analysis, when the period of analysis is being set by the user and not from AnnualResults</p></a></li>
<li><a href='#setUpEstimation'><p>setUpEstimation</p></a></li>
<li><a href='#setupYears'><p>Creates the AnnualResults data frame from the Daily data frame</p></a></li>
<li><a href='#startEnd'><p>startEnd</p></a></li>
<li><a href='#stitch'><p>stitch surfaces</p></a></li>
<li><a href='#surfaceIndex'><p>Compute the 6 parameters needed to lay out the grid for the surfaces computed in estSurfaces</p></a></li>
<li><a href='#surfaceStartEnd'><p>Surface date limits</p></a></li>
<li><a href='#tableChange'><p>Create a table of the changes in flow-normalized values between various points in time in the record</p></a></li>
<li><a href='#tableFlowChange'><p>Prints table of change metrics for a given streamflow statistic</p></a></li>
<li><a href='#tableResults'><p>Table of annual results for discharge, concentration and flux</p></a></li>
<li><a href='#triCube'><p>Tricube weight function</p></a></li>
<li><a href='#WRTDSKalman'><p>WRTDS-Kalman</p></a></li>
<li><a href='#yPretty'><p>Sets up tick marks for an axis for a graph with an arithmetic scale which starts at zero</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Exploration and Graphics for RivEr Trends</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0.9</td>
</tr>
<tr>
<td>Description:</td>
<td>Statistics and graphics for streamflow history,
    water quality trends, and the statistical modeling algorithm: Weighted
    Regressions on Time, Discharge, and Season (WRTDS). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dataRetrieval (&ge; 2.0.1), survival, fields, methods, utils,
grDevices, graphics, stats, truncnorm, foreach, MASS</td>
</tr>
<tr>
<td>Suggests:</td>
<td>EGRETci, knitr, rmarkdown, extrafont, testthat, rkt,
doParallel, parallel, pkgdown, png, dplyr, zyp, lubridate, covr</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/DOI-USGS/EGRET/issues">https://github.com/DOI-USGS/EGRET/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BuildVignettes:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://pubs.usgs.gov/tm/04/a10/">https://pubs.usgs.gov/tm/04/a10/</a></td>
</tr>
<tr>
<td>Copyright:</td>
<td>This software is in the public domain because it contains
materials that originally came from the United States
Geological Survey, an agency of the United States Department of
Interior. For more information, see the official USGS copyright
policy at
https://www.usgs.gov/information-policies-and-instructions/copyrights-and-credits</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-18 16:01:30 UTC; ldecicco</td>
</tr>
<tr>
<td>Author:</td>
<td>Robert Hirsch <a href="https://orcid.org/0000-0002-4534-075X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Laura DeCicco <a href="https://orcid.org/0000-0002-3915-9487"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Tim Cohn [ctb],
  David Watkins [ctb],
  Lindsay Carr [ctb],
  Jennifer Murphy <a href="https://orcid.org/0000-0002-0881-0919"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Laura DeCicco &lt;ldecicco@usgs.gov&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-18 16:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.egret'>Create named list for EGRET analysis</h2><span id='topic+as.egret'></span>

<h3>Description</h3>

<p>Create a named list with the INFO, Daily, and Sample dataframes, and surface matrix. If any of these are
not available, an NA should be
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.egret(INFO, Daily, Sample = NA, surfaces = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.egret_+3A_info">INFO</code></td>
<td>
<p>dataframe containing the INFO dataframe</p>
</td></tr>
<tr><td><code id="as.egret_+3A_daily">Daily</code></td>
<td>
<p>dataframe containing the daily data</p>
</td></tr>
<tr><td><code id="as.egret_+3A_sample">Sample</code></td>
<td>
<p>dataframe containing the sample data</p>
</td></tr>
<tr><td><code id="as.egret_+3A_surfaces">surfaces</code></td>
<td>
<p>matrix returned from <code>modelEstimation</code>. Default is NA.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>eList named list with Daily, Sample, and INFO dataframes, along with the surfaces matrix.
Any of these values can be NA, not all EGRET functions will work with missing parts of the named list eList.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readNWISDaily">readNWISDaily</a></code>, <code><a href="#topic+readNWISSample">readNWISSample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Daily &lt;- getDaily(eList)
INFO &lt;- getInfo(eList)
eList_flowHistory &lt;- as.egret(INFO, Daily)
plotFlowSingle(eList_flowHistory, 1)
Sample &lt;- getSample(eList)
surfaces &lt;- getSurfaces(eList)
eList_full &lt;- as.egret(INFO, Daily, Sample, surfaces)
plotFluxQ(eList_full)
</code></pre>

<hr>
<h2 id='blankTime'>Deletes the computed values during periods of time when there are no sample data</h2><span id='topic+blankTime'></span>

<h3>Description</h3>

<p>This function is used when the data analyst believes that a gap in the sample data record
is so long that estimates during that period are not reliable. 
This is only used for periods of several years in duration. 
For this period, the values of Conc, Flux, FNConc and FNFlux are all converted to NA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blankTime(eList, startBlank, endBlank)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blankTime_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily dataframe</p>
</td></tr>
<tr><td><code id="blankTime_+3A_startblank">startBlank</code></td>
<td>
<p>character specifying starting date of blank period, input in quotes in yyyy-mm-dd format</p>
</td></tr>
<tr><td><code id="blankTime_+3A_endblank">endBlank</code></td>
<td>
<p>character specifying the ending date of blank period, input in quotes in yyyy-mm-dd format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>eList named list with modified Daily data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>startBlank = "2004-10-01"
endBlank = "2006-09-30"
eList &lt;- Choptank_eList
eList &lt;- blankTime(eList, startBlank, endBlank)
</code></pre>

<hr>
<h2 id='boxConcMonth'>Box plot of the water quality data by month</h2><span id='topic+boxConcMonth'></span>

<h3>Description</h3>

<p>Data come from named list, which contains a Sample dataframe with the sample data, 
and an INFO dataframe with metadata.
</p>
<p>Box widths are proportional to the square root of the number of samples in the month. 
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxConcMonth(eList, printTitle = TRUE, cex = 0.8, cex.axis = 1.1,
  cex.main = 1.1, las = 1, logScale = FALSE, tcl = 0.5,
  tinyPlot = FALSE, customPar = FALSE, showYLabels = TRUE, concLab = 1,
  showXLabels = TRUE, showXAxis = TRUE, showYAxis = TRUE, monthLab = 1,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxConcMonth_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_las">las</code></td>
<td>
<p>numeric in 0,1,2,3; the style of axis labels, see ?par</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_logscale">logScale</code></td>
<td>
<p>logical if TRUE y plotted in log axis</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_tcl">tcl</code></td>
<td>
<p>number defaults to 0.5, specifies length of tick marks as fraction of height of a line of text</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small as part of a multi-plot figure, default is FALSE.</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_showylabels">showYLabels</code></td>
<td>
<p>logical defaults to TRUE. If FALSE, the y axis label is not plotted</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_showxlabels">showXLabels</code></td>
<td>
<p>logical defaults to TRUE. If FALSE, the x axis label is not plotted</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_showxaxis">showXAxis</code></td>
<td>
<p>logical defaults to TRUE. If FALSE, the x axis is not plotted</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_showyaxis">showYAxis</code></td>
<td>
<p>logical defaults to TRUE. If FALSE, the y axis is not plotted</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_monthlab">monthLab</code></td>
<td>
<p>object of monthLabel class, or numeric represented the short code, 
or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="boxConcMonth_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+boxplot">boxplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
boxConcMonth(eList)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
boxConcMonth(eList)
spanish_month &lt;- new("monthLabel",
                  monthAbbrev = c("enero",	"feb", 	"marzo", "abr",
                                  "mayo",	"jun",	"jul", "agosto", "set",
                                  "oct",	"nov", "dic"),
                  monthFull = c("enero",	"febrero", 	"marzo", "abril",
                                  "mayo",	"junio",	"julio", "agosto", "septiembre",
                                  "octubre",	"noviembre", "diciembre"),
                  monthSingle = c("E", "F", "M", "A", "M", "J", "J",
                                  "A", "S", "O", "N", "D"))
boxConcMonth(eList, monthLab = spanish_month, 
             showXLabels = FALSE, printTitle = FALSE)
</code></pre>

<hr>
<h2 id='boxConcThree'>Three box plots side-by-side</h2><span id='topic+boxConcThree'></span>

<h3>Description</h3>

<p>This function is used to compare the distribution of concentration in the 
sample and predicted data set. It shows three boxplots.  One for the sample, 
one for the predictions on days with sample values, and one for all days 
(whether or not they had sample values).  Box widths are proportional to the
square root of the number of observations represented by the box.  
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata. 
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxConcThree(eList, tinyPlot = FALSE, printTitle = TRUE,
  moreTitle = "WRTDS", customPar = FALSE, font.main = 2, cex = 0.8,
  cex.main = 1.1, cex.axis = 1.1, concLab = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxConcThree_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="boxConcThree_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small as part of a multi-plot figure, default is FALSE.</p>
</td></tr>
<tr><td><code id="boxConcThree_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="boxConcThree_+3A_moretitle">moreTitle</code></td>
<td>
<p>character specifying some additional information to go in figure title, typically some information about the specific estimation method used, default is no additional information</p>
</td></tr>
<tr><td><code id="boxConcThree_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function</p>
</td></tr>
<tr><td><code id="boxConcThree_+3A_font.main">font.main</code></td>
<td>
<p>font to be used for plot main titles</p>
</td></tr>
<tr><td><code id="boxConcThree_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="boxConcThree_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="boxConcThree_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="boxConcThree_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="boxConcThree_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+boxplot">boxplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
boxConcThree(eList)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
boxConcThree(eList)
</code></pre>

<hr>
<h2 id='boxQTwice'>Two box plots side-by-side, discharge on sample days, and discharge on all days</h2><span id='topic+boxQTwice'></span>

<h3>Description</h3>

<p>This function is used to compare the distribution of discharges in the sample data set 
and the discharges in the full daily data set.
Note that discharge is plotted on a logarithmic axis. The boxplot is created 
using the log values but the scale is presented in the original units. An 
ideal situation would show the two boxes roughly similar to each other or 
the sample boxplot having median, upper quartile, and higher values being 
slightly greater than in the boxplot of all days.
</p>
<p>Box widths are proportional to the square root of the number of observations (left box based on number of sampled days, right box based on total number of days in the record).
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata. 
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxQTwice(eList, printTitle = TRUE, qUnit = 2, cex = 0.8,
  cex.main = 1.1, logScale = TRUE, cex.axis = 1.1, tcl = 0.5,
  las = 1, tinyPlot = FALSE, usgsStyle = FALSE, customPar = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxQTwice_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_logscale">logScale</code></td>
<td>
<p>logical if TRUE y plotted in log axis. Defaults to TRUE.</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_tcl">tcl</code></td>
<td>
<p>number defaults to 0.5, specifies length of tick marks as fraction of height of a line of text</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_las">las</code></td>
<td>
<p>numeric in 0,1,2,3; the style of axis labels, see ?par</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small as part of a multi-plot figure, default is FALSE.</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels.</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function</p>
</td></tr>
<tr><td><code id="boxQTwice_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+boxplot">boxplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
boxQTwice(eList)
boxQTwice(eList, qUnit=1)
boxQTwice(eList, qUnit='cfs')
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
boxQTwice(eList)
</code></pre>

<hr>
<h2 id='boxResidMonth'>A box plot of WRTDS residuals by month</h2><span id='topic+boxResidMonth'></span>

<h3>Description</h3>

<p>This function produces a boxplot of the residuals from WRTDS, expressed in natural log concentration units. 
It provides an alternative for viewing the standardized residuals, where the each residual is divided by its estimated standard error. 
The monthly boxplot widths are proportional to the square root of the sample size. 
The residuals for a censored value are determined as the difference between the natural log of the average of the upper and lower. 
bounds on the sample value, minus the log space estimate of concentration. 
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default. 
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
and an INFO dataframe with metadata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxResidMonth(eList, stdResid = FALSE, las = 1, printTitle = TRUE,
  cex = 0.8, cex.axis = 1.1, cex.main = 1.1, font.main = 2,
  tinyPlot = FALSE, customPar = FALSE, monthLab = 1,
  randomCensored = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxResidMonth_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_stdresid">stdResid</code></td>
<td>
<p>logical variable, if TRUE it uses the standardized residual, if FALSE it uses the actual, default is FALSE</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_las">las</code></td>
<td>
<p>numeric in 0,1,2,3; the style of axis labels</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_font.main">font.main</code></td>
<td>
<p>font to be used for plot main titles</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small, as a part of a multipart figure, default is FALSE</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_monthlab">monthLab</code></td>
<td>
<p>object of monthLabel class, or numeric represented the short code, 
or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_randomcensored">randomCensored</code></td>
<td>
<p>logical. Show censored residuals as randomized. Default = FALSE.</p>
</td></tr>
<tr><td><code id="boxResidMonth_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+boxplot">boxplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
boxResidMonth(eList)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart = 6, paLong = 3)
boxResidMonth(eList)
</code></pre>

<hr>
<h2 id='calculateMonthlyResults'>Calculates monthly mean values of Q, Conc, FNConc, Flux, and FNFlux for the entire record.  If WRTDSKalman has been run it also includes the monthly mean values of GenConc and GenFlux.</h2><span id='topic+calculateMonthlyResults'></span>

<h3>Description</h3>

<p>Computes the monthly mean values of discharge, concentration, flux, flow-normalized concentration and flow-normalized flux (Q, Conc, FNConc, Flux, and FNFlux) in SI units
If WRTDSKalman has been run the outputs are averages for Q, Conc, GenConc, FNConc, Flux, GenFlux, and FNFlux. 
Note that the Flux, GenFlux, and FNFlux values are average flux values (not totals). For discharge the units are in m3/s, concentration is mg/L, and flux is kg/day.
It returns a data frame containing month, year, decimal year, and mean values of DecYear, Q, Conc, GenConc, FNConc, Flux, GenFlux, and FNFlux.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calculateMonthlyResults(eList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculateMonthlyResults_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily dataframes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>MonthlyResults data frame of numeric values describing the monthly average values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
monthlyResults &lt;- calculateMonthlyResults(eList)
</code></pre>

<hr>
<h2 id='censoredSegments'>Generic plotting function to create censored line segments</h2><span id='topic+censoredSegments'></span>

<h3>Description</h3>

<p>Basic plotting framework for EGRET dot plots. Graphical parameters default to values that work well with most plots, but all can be re-assigned.
See ?par for complete definitions of most optional input variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>censoredSegments(yBottom, yLow, yHigh, x, Uncen, col = "black", lwd = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="censoredSegments_+3A_ybottom">yBottom</code></td>
<td>
<p>number specifying minimum flux (required)</p>
</td></tr>
<tr><td><code id="censoredSegments_+3A_ylow">yLow</code></td>
<td>
<p>vector specifying the x data (required), such as ConcLow</p>
</td></tr>
<tr><td><code id="censoredSegments_+3A_yhigh">yHigh</code></td>
<td>
<p>vector specifying the x data (required), such as ConcHigh</p>
</td></tr>
<tr><td><code id="censoredSegments_+3A_x">x</code></td>
<td>
<p>vector x data (required)</p>
</td></tr>
<tr><td><code id="censoredSegments_+3A_uncen">Uncen</code></td>
<td>
<p>vector that defines whether the values are censored (0) or not (1)</p>
</td></tr>
<tr><td><code id="censoredSegments_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="censoredSegments_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+segments">segments</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(1,2,3,4,5,6)
y &lt;- c(1,3,4,3.3,4.4,7)
xlim &lt;- c(min(x)*.75,max(x)*1.25)
ylim &lt;- c(0,1.25*max(y))
xlab &lt;- "Date"
ylab &lt;- "Concentration"
xTicks &lt;- pretty(xlim)
yTicks &lt;- pretty(ylim)
genericEGRETDotPlot(x=x, y=y, 
                    xlim=xlim, ylim=ylim,
                    xlab=xlab, ylab=ylab,
                    xTicks=xTicks, yTicks=yTicks,
                    plotTitle="Test"
)
yBottom &lt;- 0
yLow &lt;- c(NA,3,4,3.3,4,7)
yHigh &lt;- c(1,3,4,3.3,5,NA)
Uncen &lt;- c(0,1,1,1,0,0)
censoredSegments(yBottom=yBottom,yLow=yLow,yHigh=yHigh,x=x,Uncen=Uncen)
</code></pre>

<hr>
<h2 id='checkStartEndDate'>checkStartEndDate</h2><span id='topic+checkStartEndDate'></span>

<h3>Description</h3>

<p>Checks that the start date is before the end date.  If not, it will give the user the opportunity to correct, otherwise will create a warning.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkStartEndDate(startDate, endDate, interactive = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkStartEndDate_+3A_startdate">startDate</code></td>
<td>
<p>character</p>
</td></tr>
<tr><td><code id="checkStartEndDate_+3A_enddate">endDate</code></td>
<td>
<p>character</p>
</td></tr>
<tr><td><code id="checkStartEndDate_+3A_interactive">interactive</code></td>
<td>
<p>logical Option for interactive mode.  If true, there is user interaction for error handling and data checks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector where first value is startDate, second is endDate
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	
startDate &lt;- '1985-01-01'		
endDate &lt;- '1990-01-01'		
checkStartEndDate(startDate, endDate)
</code></pre>

<hr>
<h2 id='checkSurfaceSpan'>checkSurfaceSpan</h2><span id='topic+checkSurfaceSpan'></span>

<h3>Description</h3>

<p>checkSurfaceSpan
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkSurfaceSpan(eList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkSurfaceSpan_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'> 
eList &lt;- Choptank_eList
checkSurfaceSpan(eList)
</code></pre>

<hr>
<h2 id='Choptank_eList'>Example eList</h2><span id='topic+Choptank_eList'></span><span id='topic+Arkansas_eList'></span>

<h3>Description</h3>

<p>Example data representing data from the Choptank River at Greensboro, MD,  USGS data
Data is a named list of the Daily, Sample, INFO dataframes, and the surface matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(Choptank_eList$Daily)
head(Arkansas_eList$Daily)
</code></pre>

<hr>
<h2 id='cleanUp'>cleanUp eList</h2><span id='topic+cleanUp'></span>

<h3>Description</h3>

<p>Takes an eList as the input. If there are duplicated dates in the Sample data frame, 
will randomly select one value for that date.  If there are censored values
in the data set they will be replaced by random censored values.  If there are no
days with duplicate samples and no censored valued then the eList returned by the function will be identical to the eList that is passed to it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cleanUp(eList, seed = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cleanUp_+3A_elist">eList</code></td>
<td>
<p>named list with the INFO, Daily, and Sample dataframes and surfaces matrix.</p>
</td></tr>
<tr><td><code id="cleanUp_+3A_seed">seed</code></td>
<td>
<p>integer value. Defaults to NA, which will not change the current seed.
Setting the seed to any given value can be used to create repeatable output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is run before each iteration of generating a random sequence in the 
<code><a href="#topic+WRTDSKalman">WRTDSKalman</a></code> function
</p>


<h3>Value</h3>

<p>eList with duplicated dates in the Sample data frame randomly sampled and censored values are replaced by random values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList

eList &lt;- cleanUp(eList)

</code></pre>

<hr>
<h2 id='compressData'>Compress sample data frame</h2><span id='topic+compressData'></span>

<h3>Description</h3>

<p>Using raw data that has at least dateTime, value, code, populates the measured data portion of the Sample dataframe used in EGRET.
ConcLow  = Lower bound for an observed concentration
ConcHigh = Upper bound for an observed concentration
Uncen    = 1 if uncensored, 0 if censored
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compressData(data, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compressData_+3A_data">data</code></td>
<td>
<p>dataframe contains at least dateTime, code, value, columns in that order. 
If there are more than the initial date, code, value...it combines the
data is combined as using interval censored concepts.</p>
</td></tr>
<tr><td><code id="compressData_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame returnDataFrame data frame containing dateTime, ConcHigh, ConcLow, Uncen
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dateTime &lt;- c('1985-01-01', '1985-01-02', '1985-01-03')
comment1 &lt;- c("","","")
value1 &lt;- c(1,2,3)
comment2 &lt;- c("","&lt;","")
value2 &lt;- c(2,3,4)
comment3 &lt;- c("","","&lt;")
value3 &lt;- c(3,4,5)
dataInput &lt;- data.frame(dateTime, comment1, value1, 
      comment2, value2, 
      comment3, value3, stringsAsFactors=FALSE)
compressData(dataInput)
</code></pre>

<hr>
<h2 id='concUnit-class'>concUnit class</h2><span id='topic+concUnit-class'></span>

<h3>Description</h3>

<p>Some details about the concUnit class
</p>


<h3>Details</h3>


<dl>
<dt>longPrefix</dt><dd><p>A character specifying the long name
for concentration labels.</p>
</dd>
<dt>shortPrefix</dt><dd><p>A character specifying the short name
for concentration labels.</p>
</dd>
</dl>


<hr>
<h2 id='Constants'>Constants included with EGRET</h2><span id='topic+Constants'></span><span id='topic+fluxConst'></span><span id='topic+qConst'></span><span id='topic+monthInfo'></span><span id='topic+concConst'></span>

<h3>Description</h3>


<ul>
<li><p>fluxConstFlux conversion object
</p>
</li>
<li><p>qConstFlow conversion object
</p>
</li>
<li><p>monthInfoMonth object
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>fluxConst
fluxConst[['kgDay']]
fluxConst[['kgDay']]@unitName
qConst
qConst[['cfs']]
qConst[['cfs']]@qUnitName
concConst[['concentration']]
concConst[['concentration']]@shortPrefix
</code></pre>

<hr>
<h2 id='cumQdate'>Cumulative flow calculation</h2><span id='topic+cumQdate'></span>

<h3>Description</h3>

<p>This function computes the first day of the calendar year
at which a specific fraction of the cumulative flow for that year
has been exceeded.  Typically one looks for the point where
half the cumulative flow has happened (fract = 0.5).
The portion of the year being considered is set by paStart and paLong.
The matrix returned has 2 columns: 
the first is the year (integer when the period of analysis ends),
the second is the day of the year when the fraction has been exceeded.
None of the rows will have any NA values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumQdate(eList, paStart = 10, paLong = 12, fract = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cumQdate_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="cumQdate_+3A_pastart">paStart</code></td>
<td>
<p>numeric integer specifying the starting month for the period of analysis, 1 &lt;= paStart &lt;= 12, default is 10</p>
</td></tr>
<tr><td><code id="cumQdate_+3A_palong">paLong</code></td>
<td>
<p>numeric integer specifying the length of the period of analysis, in months, 1 &lt;= paLong &lt;= 12, default is 12</p>
</td></tr>
<tr><td><code id="cumQdate_+3A_fract">fract</code></td>
<td>
<p>numeric fraction of the flow</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is common to use this type of analysis on the snowmelt period of the year.
If (for example) we assume that snowmelt starts with the month of March and ends in July
then we would set paStart = 3 and paLong = 5
</p>


<h3>Value</h3>

<p>annualSeries an integer matrix of two columns.
The first column is the calendar year for the end of the period 
The second column is day of the year when the flow has exceeded the specified fraction 
of the entire period being considered
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
annualFlow &lt;- cumQdate(eList)
head(annualFlow)
plot(annualFlow)
mod1 &lt;- lm(annualFlow[,2] ~ annualFlow[,1])
summary(mod1)
</code></pre>

<hr>
<h2 id='dataOverview'>Data Overview for WRTDS</h2><span id='topic+dataOverview'></span>

<h3>Description</h3>

<p>Gives a summary of data to be used for WRTDS analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataOverview(Daily, Sample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataOverview_+3A_daily">Daily</code></td>
<td>
<p>dataframe</p>
</td></tr>
<tr><td><code id="dataOverview_+3A_sample">Sample</code></td>
<td>
<p>dataframe</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+mergeReport">mergeReport</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
exDaily &lt;- getDaily(eList)
exSample &lt;- getSample(eList)
dataOverview(Daily = exDaily, Sample = exSample)
</code></pre>

<hr>
<h2 id='dateFormatCheck'>Check date format</h2><span id='topic+dateFormatCheck'></span>

<h3>Description</h3>

<p>Checks to see if format is YYYY-MM-DD. Also performs a few other date checks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dateFormatCheck(date)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dateFormatCheck_+3A_date">date</code></td>
<td>
<p>character</p>
</td></tr>
</table>


<h3>Value</h3>

<p>condition logical TRUE or FALSE if checks passed or failed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>date &lt;- '1985-01-01'
dateFormatCheck(date)
dateWrong &lt;- '1999/1/7'
dateFormatCheck(dateWrong)
</code></pre>

<hr>
<h2 id='decimalDate'>decimalDate</h2><span id='topic+decimalDate'></span>

<h3>Description</h3>

<p>Create a decimal date or date/time from a vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decimalDate(rawData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decimalDate_+3A_rawdata">rawData</code></td>
<td>
<p>vector of dates or dateTimes.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>dateTime &lt;- c('1984-02-28 13:56',
              '1984-03-01 00:00',
              '1986-03-01 00:00',
              '1986-10-15 00:00')
decimalDate(dateTime)

dateTime &lt;- c('1984-02-28', 
              '1984-03-01',
              '1986-03-01',
              '1986-10-15')
decimalDate(dateTime)
</code></pre>

<hr>
<h2 id='decimalHighLow'>decimalHighLow</h2><span id='topic+decimalHighLow'></span>

<h3>Description</h3>

<p>decimalHighLow figures out the highest and lowest decimal year based on
water year. The input is a data frame with columns Month and DecYear.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decimalHighLow(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decimalHighLow_+3A_df">df</code></td>
<td>
<p>data.frame with Month, DecYear, and Month columns</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with DecHigh and DecLow (water year high/low decimal values)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
highLow &lt;- decimalHighLow(eList$Sample)

DecHigh &lt;- highLow[["DecHigh"]]
DecLow &lt;- highLow[["DecLow"]]
</code></pre>

<hr>
<h2 id='EGRET-package'>EGRET package includes WRTDS and flowHistory</h2><span id='topic+EGRET-package'></span>

<h3>Description</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> EGRET</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> Unlimited for this package, dependencies have more restrictive licensing.</td>
</tr>
<tr>
 <td style="text-align: left;">
Copyright: </td><td style="text-align: left;"> This software is in the public domain because it contains materials
that originally came from the United States Geological Survey, an agency of
the United States Department of Interior. For more information, see the
official USGS copyright policy at
<a href="https://www.usgs.gov/information-policies-and-instructions/copyrights-and-credits">https://www.usgs.gov/information-policies-and-instructions/copyrights-and-credits</a></td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Details</h3>

<p>Collection of functions to do WRTDS and flowHistory analysis,
and produce graphs and tables of data and results from these analyses.
</p>


<h3>Author(s)</h3>

<p>Robert M. Hirsch <a href="mailto:rhirsch@usgs.gov">rhirsch@usgs.gov</a>, Laura De Cicco <a href="mailto:ldecicco@usgs.gov">ldecicco@usgs.gov</a>
</p>


<h3>References</h3>

<p>Hirsch, R.M., and De Cicco, L.A., 2014, User guide to Exploration and Graphics for RivEr Trends 
(EGRET) and dataRetrieval: R packages for hydrologic data: U.S. Geological Survey Techniques and Methods book 4, 
chap. A10, 94 p., <a href="https://doi.org/10.3133/tm4A10">doi:10.3133/tm4A10</a>
</p>

<hr>
<h2 id='errorStats'>Error statistics</h2><span id='topic+errorStats'></span>

<h3>Description</h3>

<p>This function takes a fitted WRTDS model and computes error statistics
the residuals used here are cross-validation residuals, 
which will be slightly larger than regular regression residuals
in the case of censored data, the residuals are computed from random residuals
computed from makeAugmentedSample(), the function returns a list of error statistics
and also prints them to the console
</p>


<h3>Usage</h3>

<pre><code class='language-R'>errorStats(eList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="errorStats_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>erStats a numeric vector consisting of the following statistics
RsqLC the R squared value for predictions of ln(Concentration)
RsqLF the R squared value for predictions of ln(Flux)
rmse the root mean squared error for ln(Concentration), same value would apply for Flux
sepPercent the standard error of prediction for Concentration, expressed in percent
same value would apply for Flux
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
errorStats(eList)
</code></pre>

<hr>
<h2 id='estCrossVal'>Jack-Knife cross validation of the WRTDS (Weighted Regressions on Time, Discharge, and Season)</h2><span id='topic+estCrossVal'></span>

<h3>Description</h3>

<p>This function fits the WRTDS model n times (where n is the number of observations).  
For each fit, the data value being estimated is eliminated from the record. 
This gives predictions that do not depend on knowing the actual result for that day. 
Thus it provides for a more &quot;honest&quot; estimate of model performance than a traditional 
error analysis that uses all the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estCrossVal(DecLow, DecHigh, Sample, windowY = 7, windowQ = 2,
  windowS = 0.5, minNumObs = 100, minNumUncen = 50, edgeAdjust = TRUE,
  verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estCrossVal_+3A_declow">DecLow</code></td>
<td>
<p>number specifying minimum decimal year</p>
</td></tr>
<tr><td><code id="estCrossVal_+3A_dechigh">DecHigh</code></td>
<td>
<p>number specifying maximum decimal year</p>
</td></tr>
<tr><td><code id="estCrossVal_+3A_sample">Sample</code></td>
<td>
<p>data frame containing the sample values, default is Sample</p>
</td></tr>
<tr><td><code id="estCrossVal_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p>
</td></tr>
<tr><td><code id="estCrossVal_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td></tr>
<tr><td><code id="estCrossVal_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td></tr>
<tr><td><code id="estCrossVal_+3A_minnumobs">minNumObs</code></td>
<td>
<p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p>
</td></tr>
<tr><td><code id="estCrossVal_+3A_minnumuncen">minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td></tr>
<tr><td><code id="estCrossVal_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record.  The modified method tends to reduce curvature near the start and end of record.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="estCrossVal_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SampleCrossV data frame containing the sample data augmented by the results of the cross-validation exercise
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Sample &lt;- getSample(eList)
Daily &lt;- getDaily(eList)
numDays &lt;- length(Daily$DecYear)
DecLow &lt;- Daily$DecYear[1]
DecHigh &lt;- Daily$DecYear[numDays]

SampleCrossV &lt;- estCrossVal(DecLow,DecHigh,Sample)

</code></pre>

<hr>
<h2 id='estDailyFromSurfaces'>Estimates all daily values of Concentration, Flux, Flow-Normalized Concentration, and Flow Normalized Flux</h2><span id='topic+estDailyFromSurfaces'></span><span id='topic+getConcFluxFromSurface'></span><span id='topic+getSurfaceEstimates'></span><span id='topic+bin_Qs'></span>

<h3>Description</h3>

<p>Uses the surfaces matrix estimated in estSurfaces to estimate 6 daily time series
and appends them to the Daily data frame.  The time series are (in order):
yHat, the estimated natural log of concentration, dimensionless
SE, the standard error of the natural log of concentration
ConcDay, the estimated concentration in mg/L
FluxDay, the estimated flux in kg/day
FNConc, the flow-normalized concentration in mg/L
FNFlux, the flow-normalized flux in kg/day
</p>
<p>Bin the LogQ values by day-of-year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estDailyFromSurfaces(eList, localsurfaces = NA, localDaily = NA)

getConcFluxFromSurface(eList, allLogQsByDayOfYear, localDaily,
  localsurfaces = NA)

getSurfaceEstimates(eList, localsurfaces = NA, localDaily = NA)

bin_Qs(localDaily)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estDailyFromSurfaces_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes, and the surface matrix</p>
</td></tr>
<tr><td><code id="estDailyFromSurfaces_+3A_localsurfaces">localsurfaces</code></td>
<td>
<p>surface over-riding the one stored in eList.  Default is NA.</p>
</td></tr>
<tr><td><code id="estDailyFromSurfaces_+3A_localdaily">localDaily</code></td>
<td>
<p>data frame to override eList$Daily.  Default is NA.</p>
</td></tr>
<tr><td><code id="estDailyFromSurfaces_+3A_alllogqsbydayofyear">allLogQsByDayOfYear</code></td>
<td>
<p>list</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The results are stored in an augmented version of the Daily data frame, which is returned as part of an EGRET object.
</p>


<h3>Value</h3>

<p>egret object with altered Daily dataframe
</p>
<p>Daily dataframe with yHat, SE, ConcDay and FluxDay calulated
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
#################################################
# This is usually done in modelEstimation:
Daily &lt;- getDaily(eList)
surfaceIndexParameters&lt;-surfaceIndex(Daily)
INFO &lt;- eList$INFO
INFO$bottomLogQ&lt;-surfaceIndexParameters[['bottomLogQ']]
INFO$stepLogQ&lt;-surfaceIndexParameters[['stepLogQ']]
INFO$nVectorLogQ&lt;-surfaceIndexParameters[['nVectorLogQ']]
INFO$bottomYear&lt;-surfaceIndexParameters[['bottomYear']]
INFO$stepYear&lt;-surfaceIndexParameters[['stepYear']]
INFO$nVectorYear&lt;-surfaceIndexParameters[['nVectorYear']]
eList$INFO &lt;- INFO
#################################################

Daily &lt;- estDailyFromSurfaces(eList)

</code></pre>

<hr>
<h2 id='estSurfaces'>Estimate the three surfaces (for yHat, SE and ConcHat) as a function of DecYear and logQ and store in the three-dimensional object called surfaces</h2><span id='topic+estSurfaces'></span>

<h3>Description</h3>

<p>This function uses weighted survival regression to estimate three surfaces that cover the complete range
of DecYear and log(Q) values in the Daily data set. 
These surfaces are:
(1) is the estimated log concentration (yHat), 
(2) is the estimated standard error (SE), 
(3) is the estimated concentration (ConcHat). 
They are mapped as an array that covers the complete space of daily discharge and time. 
The first index is discharge, layed out in 14 equally spaced levels of log(Q).
The second index is time, layed out as 16 increments of the calendar year, starting January 1.
It returns the 3 dimensional array called surfaces.
This array will be used to estimate these 3 quantities for any given day in the daily values record.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estSurfaces(eList, surfaceStart = NA, surfaceEnd = NA, localSample = NA,
  windowY = 7, windowQ = 2, windowS = 0.5, minNumObs = 100,
  minNumUncen = 50, edgeAdjust = TRUE, verbose = TRUE,
  interactive = NULL, run.parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estSurfaces_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and Daily dataframes</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_surfacestart">surfaceStart</code></td>
<td>
<p>Date object for start of surface slice (or character starting date for data retrieval in the form YYYY-MM-DD). Default is NA .</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_surfaceend">surfaceEnd</code></td>
<td>
<p>Date object for end of surface slice (or character starting date for data retrieval in the form YYYY-MM-DD). Default is NA .</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_localsample">localSample</code></td>
<td>
<p>data frame to override eList$Sample. Default is NA .</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_minnumobs">minNumObs</code></td>
<td>
<p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_minnumuncen">minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record. Default is TRUE.</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_interactive">interactive</code></td>
<td>
<p>logical deprecated. Use 'verbose' instead</p>
</td></tr>
<tr><td><code id="estSurfaces_+3A_run.parallel">run.parallel</code></td>
<td>
<p>logical to run bootstrapping in parallel or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>surfaces array containing the three surfaces estimated, array is 3 dimensional
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList

surfaces &lt;- estSurfaces(eList)

surfaceStart &lt;- "1984-10-01"
surfaceEnd &lt;- "1986-09-30"
surfaces_1 &lt;- estSurfaces(eList, surfaceStart, surfaceEnd)

wall_sample &lt;- head(eList$Sample, n=500)

surface_wall &lt;- estSurfaces(eList, localSample = wall_sample)


</code></pre>

<hr>
<h2 id='fixSampleFrame'>Update Sample dataframe</h2><span id='topic+fixSampleFrame'></span>

<h3>Description</h3>

<p>Used for updating the Sample dataframe if ConcLow or ConcHigh is manually adjusted. 
Adjusts ConcAve and Uncen columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixSampleFrame(eList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixSampleFrame_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample dataframes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>localSample data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Sample &lt;- eList$Sample
Sample[1,c("ConcLow","ConcHigh")] &lt;- c(NA, 0.01) # Adjusted to left-censored
Sample[2,c("ConcLow","ConcHigh")] &lt;- c(1.1, 1.3) # Adjusted to interval-censored
Sample[3,c("ConcLow","ConcHigh")] &lt;- c(1.3, 1.3) # Simple adjustment
eList$Sample &lt;- Sample
eList &lt;- fixSampleFrame(eList)
eList$Sample[1:3,]
</code></pre>

<hr>
<h2 id='flexFN'>Flexible Flow Normalization</h2><span id='topic+flexFN'></span>

<h3>Description</h3>

<p>This function implements generalized flow normalization.  This means that for 
determining the  flow normalized concentration and flow normalized flux for any 
given year, there is a specified list of years from which to create the discharge 
record used in the flow-normalization process.  That set of years is defined by 
the dateInfo object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flexFN(eList, dateInfo, localsurfaces = NA, oldSurface = FALSE,
  flowNormStartCol = "flowNormStart", flowNormEndCol = "flowNormEnd",
  flowStartCol = "flowStart", flowEndCol = "flowEnd")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flexFN_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="flexFN_+3A_dateinfo">dateInfo</code></td>
<td>
<p>data frame with 4 columns. The column names and descriptions 
are described below.  Default is NA.</p>
</td></tr>
<tr><td><code id="flexFN_+3A_localsurfaces">localsurfaces</code></td>
<td>
<p>surface  (3-dimensional matrix) over-riding the one stored in 
eList Default = NA.</p>
</td></tr>
<tr><td><code id="flexFN_+3A_oldsurface">oldSurface</code></td>
<td>
<p>logical, if TRUE, use the surface object in eList.  Default is FALSE.</p>
</td></tr>
<tr><td><code id="flexFN_+3A_flownormstartcol">flowNormStartCol</code></td>
<td>
<p>character, name of the column in dateInfo that starts the segment
for the flow normalization</p>
</td></tr>
<tr><td><code id="flexFN_+3A_flownormendcol">flowNormEndCol</code></td>
<td>
<p>character, name of the column in dateInfo that ends the segment
for the flow normalization</p>
</td></tr>
<tr><td><code id="flexFN_+3A_flowstartcol">flowStartCol</code></td>
<td>
<p>character, name of the column in dateInfo that starts the segment
for the portion of the flow to be populated with flow-normalized values.</p>
</td></tr>
<tr><td><code id="flexFN_+3A_flowendcol">flowEndCol</code></td>
<td>
<p>character, name of the column in dateInfo that ends the segment
for the portion of the flow to be populated with flow-normalized values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named list, eList, containing INFO, Daily, Sample, and surfaces objects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
eList &lt;- setUpEstimation(eList)
flowNormStart &lt;- c("1979-10-01","1990-01-01","1992-10-10")
flowNormEnd &lt;- c("1995-06-06","2004-03-03","2011-09-29")
flowStart &lt;- c("1979-10-01","1995-06-07","2004-03-04")
flowEnd &lt;- c("1995-06-06","2004-03-03","2011-09-29") 
dateInfo &lt;- data.frame(flowNormStart,
                       flowNormEnd,
                       flowStart, 
                       flowEnd, 
                       stringsAsFactors = FALSE)

newEList &lt;- flexFN(eList, dateInfo)
plotFluxHist(newEList)
flexPlotAddOn(newEList)

wallSurface &lt;- estSurfaces(eList, localSample = eList$Sample[1:500,])
wallEList &lt;- flexFN(eList, dateInfo, localsurface = wallSurface)
plotFluxHist(wallEList)

</code></pre>

<hr>
<h2 id='flexPlotAddOn'>Flexible Flow Normalization Plot Add On</h2><span id='topic+flexPlotAddOn'></span>

<h3>Description</h3>

<p>Flexible Flow Normalization Plot Add On
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flexPlotAddOn(eList, showArrows = TRUE, showRect = TRUE,
  customPalette = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flexPlotAddOn_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="flexPlotAddOn_+3A_showarrows">showArrows</code></td>
<td>
<p>logical whether or not to show arrows representing flow segments</p>
</td></tr>
<tr><td><code id="flexPlotAddOn_+3A_showrect">showRect</code></td>
<td>
<p>logical whether or not to show rectangles representing sample segments</p>
</td></tr>
<tr><td><code id="flexPlotAddOn_+3A_custompalette">customPalette</code></td>
<td>
<p>character vector of colors as a hexadecimal string of the form &quot;#rrggbb&quot;. 
Defaults to NULL, which indicates the use of a default palette (up to 21 segments).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
eList &lt;- setUpEstimation(eList)
flowNormStart &lt;- c("1979-10-01","1990-01-01","1992-10-10")
flowNormEnd &lt;- c("1995-06-06","2004-03-03","2011-09-29")
flowStart &lt;- c("1979-10-01","1995-06-07","2004-03-04")
flowEnd &lt;- c("1995-06-06","2004-03-03","2011-09-29") 
dateInfo &lt;- data.frame(flowNormStart,
                       flowNormEnd,
                       flowStart, 
                       flowEnd, 
                       stringsAsFactors = FALSE)

newEList &lt;- flexFN(eList, dateInfo)
plotFluxHist(newEList)
flexPlotAddOn(newEList)

plotFluxHist(newEList)
flexPlotAddOn(newEList, customPalette=c("#d5ce48", "#fd300f", "#3e0289"))

</code></pre>

<hr>
<h2 id='flowDuration'>Computes several values of the flow duration curve for streamflow centered on a specific date of the year</h2><span id='topic+flowDuration'></span>

<h3>Description</h3>

<p>This function is useful for helping the analyst determine the empirical probability distribution of 
streamflow for a particular part of the year or for the whole year. 
This is particularly useful in setting up discharge scales for various other plots in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flowDuration(eList, centerDate = "09-30", qUnit = 2, span = 365,
  monthLab = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flowDuration_+3A_elist">eList</code></td>
<td>
<p>named list with at least Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="flowDuration_+3A_centerdate">centerDate</code></td>
<td>
<p>character specifying the center date of the part of the year for which the flow
duration is to be calculated, it is in the form &quot;mm-dd&quot; (it must be in quotes). Default is 
&quot;09-30&quot;</p>
</td></tr>
<tr><td><code id="flowDuration_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code,
or character representing the descriptive name. Default is qUnit = 2, which corresponds to cubic meters per second.</p>
</td></tr>
<tr><td><code id="flowDuration_+3A_span">span</code></td>
<td>
<p>number this is the half-width of the window over which the discharge values are to 
be used in constructing the flow-duration curve. If the full year is desired any value greater 
than 182 will. Note that for a window of about 2-months width, a span value should 
be about 30. Default is 365.</p>
</td></tr>
<tr><td><code id="flowDuration_+3A_monthlab">monthLab</code></td>
<td>
<p>object of monthLabel class, or numeric represented the short code, 
or character representing the descriptive name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>qDuration A named vector with flow duration information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# for a window of 30 days either side of June 25 expressed in units
# of cfs:
flowDuration(eList, "06-25", qUnit = 1, span = 30) 
# for a flow-duration curve covering the whole year, 
# expressed in units of cms, and returning a data frame of results: 
qDuration &lt;- flowDuration(eList, qUnit = 2) 
</code></pre>

<hr>
<h2 id='fluxBiasMulti'>Produces 8-panel plot that is useful for determining if there is a flux bias problem</h2><span id='topic+fluxBiasMulti'></span>

<h3>Description</h3>

<p>These plots use the jack-knife estimates from WRTDS to investigate the potential flux bias problem. 
It can also be used for estimates constructed by other methods (such as LOADEST) if the results are
stored in a data frame organized like the Sample data frame.  It allows additional label information
to indicate what method is used. The use of this plot is described in Hirsch, Robert M., 2014. 
Large Biases in Regression-Based Constituent Flux Estimates: Causes and Diagnostic
Tools. Journal of the American Water Resources Association (JAWRA) 1-24. DOI: 10.1111/jawr.12195
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default. 
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
a Daily dataframe with the daily flow data, and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fluxBiasMulti(eList, qUnit = 2, fluxUnit = 3, moreTitle = "WRTDS",
  cex = 0.7, cex.axis = 1.1, cex.main = 1.1, randomCensored = FALSE,
  col = "black", lwd = 1, concLab = 1, monthLab = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fluxBiasMulti_+3A_elist">eList</code></td>
<td>
<p>named list with at least Sample, Daily, and INFO dataframes</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class. <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>object of fluxUnit class. <code><a href="#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_moretitle">moreTitle</code></td>
<td>
<p>character specifying some additional information to go in figure title, typically some information about the specific estimation method used, default is no additional information</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_randomcensored">randomCensored</code></td>
<td>
<p>logical, if TRUE plot a random value for censored data.  Default is FALSE.</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_monthlab">monthLab</code></td>
<td>
<p>object of monthLabel class, or numeric represented the short code, 
or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="fluxBiasMulti_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
fluxBiasMulti(eList)
fluxBiasMulti(eList, fluxUnit = 2)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList,paStart=6,paLong=3)
fluxBiasMulti(eList)
</code></pre>

<hr>
<h2 id='fluxBiasStat'>Compute the flux bias statistic: (mean of estimated flux - mean of observed flux)  / mean of estimated flux</h2><span id='topic+fluxBiasStat'></span>

<h3>Description</h3>

<p>Computes three versions of the flux bias: 
The first where all censored values are set to their miniumum. 
The second where all censored values are set to their maximum. 
The third which is the average of the other two. 
In practice there is rarely a noticable difference among them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fluxBiasStat(localSample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fluxBiasStat_+3A_localsample">localSample</code></td>
<td>
<p>data frame that contains the concentration data, default name is Sample</p>
</td></tr>
</table>


<h3>Value</h3>

<p>fluxBias a vector of three numerical values, a lower bound, upper bound and an average estimate of the ratio of (mean estimated flux - mean observed flux) / mean estimated flux.  Typically one should use fluxBias[3]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Sample &lt;- getSample(eList)
fluxBias &lt;- fluxBiasStat(Sample) 
</code></pre>

<hr>
<h2 id='fluxUnit-class'>fluxUnit class</h2><span id='topic+fluxUnit-class'></span>

<h3>Description</h3>

<p>Some details about the fluxUnit class
</p>


<h3>Details</h3>


<dl>
<dt>shortName</dt><dd><p>A character specifying the short name.</p>
</dd>
<dt>unitFactor</dt><dd><p>A numeric representing the conversion factor</p>
</dd>
<dt>unitName</dt><dd><p>A character specifying the full name.</p>
</dd>
<dt>unitExpress</dt><dd><p>An expression specifying the full name starting with Observed.</p>
</dd>
<dt>unitExpressTiny</dt><dd><p>An expression specifying the abbreviated name starting with Observed.</p>
</dd>
<dt>unitEstimate</dt><dd><p>An expression specifying the full name starting with Estimated.</p>
</dd>
<dt>unitEstimateTiny</dt><dd><p>An expression specifying the abbreviated name starting with Estimated.</p>
</dd>
<dt>unitUSGS</dt><dd><p>A character specifying flux with full text.</p>
</dd>
<dt>shortCode</dt><dd><p>A number for quick lookup</p>
</dd>
</dl>


<hr>
<h2 id='generalAxis'>Axis generation for log discharge</h2><span id='topic+generalAxis'></span>

<h3>Description</h3>

<p>Discharge axis tick generation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generalAxis(x, maxVal, minVal, units = NA, logScale = FALSE,
  tinyPlot = FALSE, padPercent = 5, concentration = TRUE, concLab = 1,
  usgsStyle = FALSE, prettyDate = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generalAxis_+3A_x">x</code></td>
<td>
<p>vector to create scale about</p>
</td></tr>
<tr><td><code id="generalAxis_+3A_maxval">maxVal</code></td>
<td>
<p>number maximum value on returned scale</p>
</td></tr>
<tr><td><code id="generalAxis_+3A_minval">minVal</code></td>
<td>
<p>number minimum value on returned scale</p>
</td></tr>
<tr><td><code id="generalAxis_+3A_units">units</code></td>
<td>
<p>character concentration units. Typically found in INFO$param.units.</p>
</td></tr>
<tr><td><code id="generalAxis_+3A_logscale">logScale</code></td>
<td>
<p>logical whether or not to return a log scale</p>
</td></tr>
<tr><td><code id="generalAxis_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical</p>
</td></tr>
<tr><td><code id="generalAxis_+3A_padpercent">padPercent</code></td>
<td>
<p>number used to pad the max and min if not specified</p>
</td></tr>
<tr><td><code id="generalAxis_+3A_concentration">concentration</code></td>
<td>
<p>logical if concentration=TRUE, labels returned as concentration units, otherwise flux units.</p>
</td></tr>
<tr><td><code id="generalAxis_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="generalAxis_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels</p>
</td></tr>
<tr><td><code id="generalAxis_+3A_prettydate">prettyDate</code></td>
<td>
<p>logical use 'pretty' limits for date axis if TRUE, or force the yearStart/yearEnd as limits if FALSE</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Daily &lt;- getDaily(eList)
INFO &lt;- getInfo(eList)
x &lt;- Daily$Q
max &lt;- max(x)
min &lt;- 0
units &lt;- INFO$param.units
generalAxis(x, max, min, units)
min &lt;- min(x)
generalAxis(x, max, min, units, log=TRUE)
generalAxis(Daily$ConcDay, 100, 0, concLab = "concentration")
</code></pre>

<hr>
<h2 id='genericEGRETDotPlot'>Generic EGRET plotting function</h2><span id='topic+genericEGRETDotPlot'></span>

<h3>Description</h3>

<p>Basic plotting framework for EGRET dot plots. Graphical parameters default to values that work well with most plots, but all can be re-assigned.
See ?par for complete definitions of most optional input variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genericEGRETDotPlot(x, y, xlim, ylim, xTicks = pretty(xlim),
  yTicks = pretty(ylim), printTitle = TRUE, xaxs = "i", xlab = "",
  yaxs = "i", ylab = "", plotTitle = "", pch = 20, cex = 0.7,
  cex.main = 1.3, font.main = 2, cex.lab = 1.2, tcl = 0.5,
  cex.axis = 1, las = 1, xDate = FALSE, tinyPlot = FALSE,
  hLine = FALSE, oneToOneLine = FALSE, rmSciX = FALSE, rmSciY = FALSE,
  customPar = FALSE, col = "black", lwd = 1, showXLabels = TRUE,
  showYLabels = TRUE, showXAxis = TRUE, showYAxis = TRUE,
  removeFirstX = FALSE, removeLastX = FALSE, removeFirstY = FALSE,
  removeLastY = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genericEGRETDotPlot_+3A_x">x</code></td>
<td>
<p>vector specifying the x data (required)</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_y">y</code></td>
<td>
<p>vector specifying the y data (required)</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_xlim">xlim</code></td>
<td>
<p>vector specifying the x plotting range (required)</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_ylim">ylim</code></td>
<td>
<p>vector specifying the y plotting range (required)</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_xticks">xTicks</code></td>
<td>
<p>vector specifying x axis tick placement (required)</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_yticks">yTicks</code></td>
<td>
<p>vector specifying y axis tick placement (required)</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_printtitle">printTitle</code></td>
<td>
<p>logical defaults to TRUE, plotting parameter to control whether to have title</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_xaxs">xaxs</code></td>
<td>
<p>character defaults to &quot;i&quot;, defines the style of x-axis interval calculation.  Possible values are i, r, e, s, d.</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_xlab">xlab</code></td>
<td>
<p>character defaults to &quot;&quot;, defines the x label</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_yaxs">yaxs</code></td>
<td>
<p>character defaults to &quot;i&quot;, defines the style of y-axis interval calculation.  Possible values are i, r, e, s, d.</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_ylab">ylab</code></td>
<td>
<p>character defaults to &quot;&quot;, defines the y label</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_plottitle">plotTitle</code></td>
<td>
<p>character defaults to &quot;&quot;, defines the plot title</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_pch">pch</code></td>
<td>
<p>number defaults to 20, specifies plot symbol</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_cex">cex</code></td>
<td>
<p>number defaults to 0.7, specifies plotting text magnification</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_cex.main">cex.main</code></td>
<td>
<p>number defaults to 1.3, specifies title text magnification</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_font.main">font.main</code></td>
<td>
<p>number defaults to 2, specifies which font to use for text</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_cex.lab">cex.lab</code></td>
<td>
<p>number defaults to 1.2 specifies label text magnification</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_tcl">tcl</code></td>
<td>
<p>number defaults to 0.5, specifies length of tick marks as fraction of height of a line of text.</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>number defaults to 1, specifies axis text magnification</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_las">las</code></td>
<td>
<p>number represents style of axis labels</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_xdate">xDate</code></td>
<td>
<p>logical defaults to FALSE, changes x label to &quot;year-month&quot; format if set to TRUE and total years less than 4.</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical defaults to FALSE, if TRUE, changes defaults to be appropriate for multi-plot</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_hline">hLine</code></td>
<td>
<p>logical defaults to FALSE, inserts horizontal line at zero</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_onetooneline">oneToOneLine</code></td>
<td>
<p>logical defaults to FALSE, inserts 1:1 line</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_rmscix">rmSciX</code></td>
<td>
<p>logical defaults to FALSE, changes x label from scientific to fixed</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_rmsciy">rmSciY</code></td>
<td>
<p>logical defaults to FALSE, changes y label from scientific to fixed</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_showxlabels">showXLabels</code></td>
<td>
<p>logical defaults to TRUE. If FALSE, the x axis label is not plotted</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_showylabels">showYLabels</code></td>
<td>
<p>logical defaults to TRUE. If FALSE, the y axis label is not plotted</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_showxaxis">showXAxis</code></td>
<td>
<p>logical defaults to TRUE. If FALSE, the x axis is not plotted</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_showyaxis">showYAxis</code></td>
<td>
<p>logical defaults to TRUE. If FALSE, the y axis is not plotted</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_removefirstx">removeFirstX</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, removes the first x axis label. This can be handy for plotting mutliple plots.</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_removelastx">removeLastX</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, removes the last x axis label. This can be handy for plotting mutliple plots.</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_removefirsty">removeFirstY</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, removes the first y axis label. This can be handy for plotting mutliple plots.</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_removelasty">removeLastY</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, removes the last y axis label. This can be handy for plotting mutliple plots.</p>
</td></tr>
<tr><td><code id="genericEGRETDotPlot_+3A_...">...</code></td>
<td>
<p>additional graphical parameters can be adjusted</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Daily &lt;- getDaily(eList)
x &lt;- Daily$Date
y &lt;- Daily$Q
xlim &lt;- c(min(x),max(x))
ylim &lt;- c(min(y),1.05*max(y))
xlab &lt;- "Date"
ylab &lt;- "Flow"
genericEGRETDotPlot(x=x, y=y, 
                    xlim=xlim, ylim=ylim,
                    xlab=xlab, ylab=ylab,
                    plotTitle="Test"
)
</code></pre>

<hr>
<h2 id='genmissing'>genmissing</h2><span id='topic+genmissing'></span>

<h3>Description</h3>

<p>Generates a lag one auto-regressive time series, where the first and last
values are fixed.  Marginal expected value is zero and variance is one.  
Generated values have a normal conditional distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genmissing(X1, XN, rho, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genmissing_+3A_x1">X1</code></td>
<td>
<p>value before the gap</p>
</td></tr>
<tr><td><code id="genmissing_+3A_xn">XN</code></td>
<td>
<p>value after the gap</p>
</td></tr>
<tr><td><code id="genmissing_+3A_rho">rho</code></td>
<td>
<p>the lag one autocorrelation</p>
</td></tr>
<tr><td><code id="genmissing_+3A_n">N</code></td>
<td>
<p>the length of the sequence including X1 and XN. It
is two more than the gap length</p>
</td></tr>
</table>


<h3>Value</h3>

<p>genmissing numeric vector of length N, conditioned on the
first value (X1) and last value (XN) with the specified lag one autocorrelation
in the limit (where N is large) the values are normal with mean 0 and variance 1
</p>


<h3>Author(s)</h3>

<p>Tim Cohn
</p>

<hr>
<h2 id='getDaily'>Get Daily dataframe from EGRET object</h2><span id='topic+getDaily'></span><span id='topic+getDaily.egret'></span><span id='topic+getDaily.default'></span>

<h3>Description</h3>

<p>From a named list or EGRET object, extract the Daily dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDaily(x, ...)

## S3 method for class 'egret'
getDaily(x, ...)

## Default S3 method:
getDaily(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDaily_+3A_x">x</code></td>
<td>
<p>EGRET object or named list</p>
</td></tr>
<tr><td><code id="getDaily_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Daily dataframe
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readNWISDaily">readNWISDaily</a></code>, <code><a href="#topic+readNWISSample">readNWISSample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Daily &lt;- getDaily(eList)
</code></pre>

<hr>
<h2 id='getInfo'>Get INFO dataframe from EGRET object</h2><span id='topic+getInfo'></span><span id='topic+getInfo.egret'></span><span id='topic+getInfo.default'></span>

<h3>Description</h3>

<p>From a named list or EGRET object, extract the INFO dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getInfo(x, ...)

## S3 method for class 'egret'
getInfo(x, ...)

## Default S3 method:
getInfo(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getInfo_+3A_x">x</code></td>
<td>
<p>EGRET object or named list</p>
</td></tr>
<tr><td><code id="getInfo_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>INFO dataframe
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readNWISDaily">readNWISDaily</a></code>, <code><a href="#topic+readNWISSample">readNWISSample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
INFO &lt;- getInfo(eList)
</code></pre>

<hr>
<h2 id='getSample'>Get Sample dataframe from EGRET object</h2><span id='topic+getSample'></span><span id='topic+getSample.default'></span>

<h3>Description</h3>

<p>From a named list or EGRET object, extract the Sample dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSample(x, ...)

getSample(x, ...)

getSample.default(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSample_+3A_x">x</code></td>
<td>
<p>EGRET object or named list</p>
</td></tr>
<tr><td><code id="getSample_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Sample dataframe
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readNWISDaily">readNWISDaily</a></code>, <code><a href="#topic+readNWISSample">readNWISSample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Sample &lt;- getSample(eList)
</code></pre>

<hr>
<h2 id='getSurfaces'>Get surfaces matrix from EGRET object</h2><span id='topic+getSurfaces'></span><span id='topic+getSurfaces.egret'></span><span id='topic+getSurfaces.default'></span>

<h3>Description</h3>

<p>From a named list or EGRET object, extract the surfaces matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSurfaces(x, ...)

## S3 method for class 'egret'
getSurfaces(x, ...)

## Default S3 method:
getSurfaces(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSurfaces_+3A_x">x</code></td>
<td>
<p>EGRET object or named list</p>
</td></tr>
<tr><td><code id="getSurfaces_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Sample dataframe
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readNWISDaily">readNWISDaily</a></code>, <code><a href="#topic+readNWISSample">readNWISSample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
surfaces &lt;- getSurfaces(eList)
</code></pre>

<hr>
<h2 id='INFOdataframe'>Import metadata to create INFO data frame</h2><span id='topic+INFOdataframe'></span><span id='topic+readNWISInfo'></span><span id='topic+readWQPInfo'></span><span id='topic+readUserInfo'></span>

<h3>Description</h3>

<p>Populates INFO data frame from either NWIS (<code>readNWISInfo</code>),
Water Quality Portal (<code>readWQPInfo</code>), or user-supplied files (<code>readUserInfo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readNWISInfo(siteNumber, parameterCd, interactive = TRUE)

readWQPInfo(siteNumber, parameterCd, interactive = TRUE)

readUserInfo(filePath, fileName, hasHeader = TRUE, separator = ",",
  interactive = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="INFOdataframe_+3A_sitenumber">siteNumber</code></td>
<td>
<p>character site number.  For <code>readNWISInfo</code>, this is usually an 8 digit number,
for <code>readWQPInfo</code>, it is usually a longer code. For instance, a USGS site number in the Water Quality Portal
would be in the form 'USGS-XXXXXXXX'. If the siteNumber is left blank (an empty string), the interactive
option allows users to enter required information by hand, otherwise those fields are left blank.</p>
</td></tr>
<tr><td><code id="INFOdataframe_+3A_parametercd">parameterCd</code></td>
<td>
<p>character USGS parameter code (a 5 digit number) or characteristic name (if using <code>readWQPInfo</code>). If the 
parameterCd is left blank (an empty string), the interactive
option allows users to enter required information by hand, otherwise those fields are left blank.</p>
</td></tr>
<tr><td><code id="INFOdataframe_+3A_interactive">interactive</code></td>
<td>
<p>logical Option for interactive mode.  If true, there is user interaction for error handling and data checks.</p>
</td></tr>
<tr><td><code id="INFOdataframe_+3A_filepath">filePath</code></td>
<td>
<p>character specifying the path to the file (used in <code>readUserInfo</code>)</p>
</td></tr>
<tr><td><code id="INFOdataframe_+3A_filename">fileName</code></td>
<td>
<p>character name of file to open (used in <code>readUserInfo</code>)</p>
</td></tr>
<tr><td><code id="INFOdataframe_+3A_hasheader">hasHeader</code></td>
<td>
<p>logical true if the first row of data is the column headers (used in <code>readUserInfo</code>)</p>
</td></tr>
<tr><td><code id="INFOdataframe_+3A_separator">separator</code></td>
<td>
<p>character that separates data cells (used in <code>readUserInfo</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>INFO data frame. Any metadata can be stored in INFO. However, there are 8 columns that EGRET uses by name in some functions:
</p>

<table>
<tr>
 <td style="text-align: left;">
Required column </td><td style="text-align: left;"> Used in function </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
param.units*** </td><td style="text-align: left;"> All concentration plotting functions </td><td style="text-align: left;"> The units as listed in this field are used
to create the concentration axis labels </td>
</tr>
<tr>
 <td style="text-align: left;">
shortName </td><td style="text-align: left;"> All plotting functions </td><td style="text-align: left;"> Station short name, used to label plots </td>
</tr>
<tr>
 <td style="text-align: left;">
paramShortName </td><td style="text-align: left;"> All plotting functions </td><td style="text-align: left;"> Parameter short name, used to label plots </td>
</tr>
<tr>
 <td style="text-align: left;">
drainSqKm </td><td style="text-align: left;"> <code>plotFlowSingle</code>, <code>printSeries</code> </td><td style="text-align: left;"> Calculate runoff</td>
</tr>
<tr>
 <td style="text-align: left;">
constitAbbrev </td><td style="text-align: left;"> <code>saveResults</code> </td><td style="text-align: left;"> Parameter abbrieviation, used to auto-name workspace</td>
</tr>
<tr>
 <td style="text-align: left;">
staAbbrev </td><td style="text-align: left;"> <code>saveResults</code> </td><td style="text-align: left;"> Station abbrieviation, used to auto-name workspace</td>
</tr>
<tr>
 <td style="text-align: left;">
paStart </td><td style="text-align: left;"> Most EGRET functions </td><td style="text-align: left;"> Starting month of period of analysis. Defaults to 10</td>
</tr>
<tr>
 <td style="text-align: left;">
paLong </td><td style="text-align: left;"> Most EGRET functions </td><td style="text-align: left;"> Length in number of months of period of analysis. Defaults to 12</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>*** Additionally, EGRET assumes that all concentrations are saved in mg/l. If some variation of
'mg/l' is not found in INFO$param.units, functions that calculate flux will issue a warning. This 
is because the conversion from mg/l to the user-specified flux unit (e.g., kg/day) uses hard-coded conversion factors.
</p>


<h3>See Also</h3>

<p><code><a href="dataRetrieval.html#topic+readNWISsite">readNWISsite</a></code>, <code><a href="dataRetrieval.html#topic+readNWISpCode">readNWISpCode</a></code>
</p>
<p><code><a href="dataRetrieval.html#topic+whatWQPsites">whatWQPsites</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># These examples require an internet connection to run
# Automatically gets information about site 05114000 and temperature

INFO &lt;- readNWISInfo('05114000','00010',interactive = FALSE)

# These examples require an internet connection to run
# Automatically gets information about site 01594440 and temperature, no interaction with user
nameToUse &lt;- 'Specific conductance'
pcodeToUse &lt;- '00095'

# INFO &lt;- readWQPInfo('USGS-04024315',pcodeToUse, interactive = FALSE)

# INFO2 &lt;- readWQPInfo('WIDNR_WQX-10032762',nameToUse, interactive = FALSE)
# To adjust the label names:
# INFO$shortName &lt;- "Little"
# INFO$paramShortName &lt;- "SC"

filePath &lt;- system.file("extdata", package="EGRET")
fileName &lt;- 'infoTest.csv'
INFO &lt;- readUserInfo(filePath,fileName, separator=",",interactive=FALSE)
</code></pre>

<hr>
<h2 id='is.egret'>Check for EGRET object</h2><span id='topic+is.egret'></span>

<h3>Description</h3>

<p>Checks object to see if it is an EGRET object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.egret(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.egret_+3A_x">x</code></td>
<td>
<p>object to check</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
is.egret(eList)
</code></pre>

<hr>
<h2 id='jitterSam'>jitter Sample</h2><span id='topic+jitterSam'></span>

<h3>Description</h3>

<p>This function is used in cases where there are numerical problems with 
the estimation of the WRTDS model.  This mostly happens during bootstrap 
estimation or when the data sets are very large.  In order to reduce the 
collinearity in the explanatory variables, some random noise is added to 
the time and log discharge variables in the Sample data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jitterSam(Sam, V = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jitterSam_+3A_sam">Sam</code></td>
<td>
<p>data frame with at least columns DecYear and LogQ</p>
</td></tr>
<tr><td><code id="jitterSam_+3A_v">V</code></td>
<td>
<p>a multiplier for the sd of the LogQ jitter. for example V = 0.02,
means that the sd of the LnQ jitter is 0.02*sdLQ</p>
</td></tr>
</table>


<h3>Value</h3>

<p>SamR a data frame structured like the Sam data frame but with
the time and discharge variables modified by adding random jitter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Sample_jitter &lt;- jitterSam(eList$Sample)
</code></pre>

<hr>
<h2 id='logPretty1'>Sets up tick marks for an axis with a log scale, where the graph is small</h2><span id='topic+logPretty1'></span>

<h3>Description</h3>

<p>Axis tick marks for a log scale for cases where the data cover many orders of magnitude
and the graph is small. 
These tick marks are designed to progress by factors of 10.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logPretty1(xMin, xMax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logPretty1_+3A_xmin">xMin</code></td>
<td>
<p>A numeric value for the minimum value to be plotted, it must be &gt; 0</p>
</td></tr>
<tr><td><code id="logPretty1_+3A_xmax">xMax</code></td>
<td>
<p>A numeric value for the maximum value to be plotted, it must be &gt; xMax</p>
</td></tr>
</table>


<h3>Value</h3>

<p>xTicks A vector representing the values for each of the tick marks
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xMin &lt;- 0.7
xMax &lt;- 990000
logPretty1(xMin, xMax)
xMin &lt;- 3
xMax &lt;- 15
logPretty1(xMin, xMax)
</code></pre>

<hr>
<h2 id='logPretty3'>Sets up tick marks for an axis with a log scale</h2><span id='topic+logPretty3'></span>

<h3>Description</h3>

<p>Axis tick marks for a log scale. 
These tick marks are designed to progress with 3 tick marks for every factor of 10. 
For example: 2,5,10,20,50,100,200,500.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logPretty3(xMin, xMax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logPretty3_+3A_xmin">xMin</code></td>
<td>
<p>A numeric value for the minimum value to be plotted, it must be &gt;0</p>
</td></tr>
<tr><td><code id="logPretty3_+3A_xmax">xMax</code></td>
<td>
<p>A numeric value for the maximum value to be plotted, it must be &gt;xMax</p>
</td></tr>
</table>


<h3>Value</h3>

<p>xTicks A vector representing the values for each of the tick marks
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logPretty3(0.7, 990000)
logPretty3(3, 15)
</code></pre>

<hr>
<h2 id='makeAnnualSeries'>Produces annual series of 8 streamflow statistics (and a lowess smooth of them) from daily streamflow data</h2><span id='topic+makeAnnualSeries'></span>

<h3>Description</h3>

<p>Part of the flowHistory system.  The data come from Daily and INFO data frames. 
Note that the function setPA must be run before this to establish the period of analysis (e.g. water year).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeAnnualSeries(eList, edgeAdjust = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeAnnualSeries_+3A_elist">eList</code></td>
<td>
<p>named list with at least Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="makeAnnualSeries_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for 
calculating the windows at the edge of the record.  The modified method tends to 
reduce curvature near the start and end of record.  
Default is TRUE, but a logical in INFO$edgeAdjust will override the default.</p>
</td></tr>
</table>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
istat  </td><td style="text-align: left;"> Name  </td>
</tr>
<tr>
 <td style="text-align: left;">
1 </td><td style="text-align: left;"> minimum 1-day daily mean discharge </td>
</tr>
<tr>
 <td style="text-align: left;"> 
2 </td><td style="text-align: left;"> minimum 7-day mean of the daily mean discharges </td>
</tr>
<tr>
 <td style="text-align: left;"> 
3 </td><td style="text-align: left;"> minimum 30-day mean of the daily mean discharges </td>
</tr>
<tr>
 <td style="text-align: left;"> 
4 </td><td style="text-align: left;"> median of the daily mean discharges </td>
</tr>
<tr>
 <td style="text-align: left;"> 
5 </td><td style="text-align: left;"> mean of the daily mean discharges </td>
</tr>
<tr>
 <td style="text-align: left;"> 
6 </td><td style="text-align: left;"> maximum 30-day mean of the daily mean discharges </td>
</tr>
<tr>
 <td style="text-align: left;"> 
7 </td><td style="text-align: left;"> maximum 7-day mean of the daily mean discharges </td>
</tr>
<tr>
 <td style="text-align: left;"> 
8 </td><td style="text-align: left;">  maximum 1-day daily mean discharge </td>
</tr>
<tr>
 <td style="text-align: left;">  
</td>
</tr>

</table>

<p>The smooth is a loess smooth computed on the log flow values and then transformed back to real space
Smoothing window is a fixed number of years, the window width has a default value of 20 years but can be modified by changing its value in INFO data frame (using setPA function)
</p>


<h3>Value</h3>

<p>annualSeries matrix that contains the annual series of streamflow statistics
annualSeries is a matrix 3 * 8 * numYears, where numYears is the number of years in the data set
in the first dimension 1 is the year, 2 is the actual value, 3 is the smoothed value
in the second dimension, the index is the istat value (identifying the flow statistic)
the third dimension is year
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
annualSeries &lt;- makeAnnualSeries(eList)
</code></pre>

<hr>
<h2 id='makeAugmentedSample'>Create randomized residuals and observations for data sets that have some censored data</h2><span id='topic+makeAugmentedSample'></span>

<h3>Description</h3>

<p>This function is used to add two columns to the Sample data frame: rResid and rObserved.
rResid is the randomized residual value computed in log concentration units, and rObserved
is the randomized 'observed' value of concentration in concentration units.
Both of these are computed for all censored samples (&quot;less than values&quot;).
They are created for purposes of plotting and are not used in any computations in EGRET.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeAugmentedSample(eList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeAugmentedSample_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample dataframe</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The WRTDS model must be estimated before this function can be run.  The random value that is generated lies between the reporting limit and zero and is distributed as a truncated log-normal distribution, with parameters derived from the fitted WRTDS model.
These random values are never used in any computations in EGRET but are used for purposes of plotting the data set or residuals.  When plotted in other functions they are shown as open circles.
</p>


<h3>Value</h3>

<p>eList named list with modified Sample data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>choptankAugmented &lt;- makeAugmentedSample(Choptank_eList)
</code></pre>

<hr>
<h2 id='makeDateInfo'>makeDateInfo</h2><span id='topic+makeDateInfo'></span>

<h3>Description</h3>

<p>Create a data frame that organizes date segmentations for runSeries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeDateInfo(windowSide, surfaceStart, surfaceEnd, firstQDate0, lastQDate0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeDateInfo_+3A_windowside">windowSide</code></td>
<td>
<p>integer number of automatically generated span sections, 
default is 7. If NA, code will use</p>
</td></tr>
<tr><td><code id="makeDateInfo_+3A_surfacestart">surfaceStart</code></td>
<td>
<p>character (or Date) in YYYY-MM-DD. Date on which we want the analysis to start, it must be at or after the</p>
</td></tr>
<tr><td><code id="makeDateInfo_+3A_surfaceend">surfaceEnd</code></td>
<td>
<p>character (or Date) in YYYY-MM-DD. Date on which we want the analysis to end, it must be at or before the end of</p>
</td></tr>
<tr><td><code id="makeDateInfo_+3A_firstqdate0">firstQDate0</code></td>
<td>
<p>character (or Date) in YYYY-MM-DD. The first day used in flow normalizing distributions, default is 
the start of eList$Daily</p>
</td></tr>
<tr><td><code id="makeDateInfo_+3A_lastqdate0">lastQDate0</code></td>
<td>
<p>character (or Date) in YYYY-MM-DD. The last day used in flow normalizating distributions, default is
the end of eList$Daily</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>windowSide &lt;- 7
surfaceStart &lt;- "1984-01-01"
surfaceEnd &lt;- "2012-12-31"
firstQDate0 &lt;- "1970-01-01"
lastQDate0 &lt;- "2014-06-01"
dateInfo &lt;- makeDateInfo(windowSide, 
                         surfaceStart, surfaceEnd, 
                         firstQDate0, lastQDate0)
</code></pre>

<hr>
<h2 id='mergeReport'>mergeReport</h2><span id='topic+mergeReport'></span>

<h3>Description</h3>

<p>This function does three things.  1) It transfers the daily discharge value 
from the Daily data frame to to Sample data frame for those days with samples.
2) It merges the INFO, Daily and Sample data frames to form an eList object, 
3) and it prints out a &quot;report&quot; of basic information about the Daily and 
Sample data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mergeReport(INFO, Daily, Sample = NA, surfaces = NA, verbose = TRUE,
  interactive = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mergeReport_+3A_info">INFO</code></td>
<td>
<p>dataframe metadata about the Sample and Daily data frames.</p>
</td></tr>
<tr><td><code id="mergeReport_+3A_daily">Daily</code></td>
<td>
<p>dataframe containing the daily discharge data</p>
</td></tr>
<tr><td><code id="mergeReport_+3A_sample">Sample</code></td>
<td>
<p>dataframe containing the sample data</p>
</td></tr>
<tr><td><code id="mergeReport_+3A_surfaces">surfaces</code></td>
<td>
<p>matrix returned from <code><a href="#topic+modelEstimation">modelEstimation</a></code>. Default is NA.</p>
</td></tr>
<tr><td><code id="mergeReport_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display summary information on 
the Daily and Sample dataframes.</p>
</td></tr>
<tr><td><code id="mergeReport_+3A_interactive">interactive</code></td>
<td>
<p>logical deprecated. Use 'verbose' instead</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There must be an INFO and a Daily data frame for this function to work. That would be the case for a study of flow only, with no consideration of water quality.  
If water quality is being considered then INFO, Daily, and Sample all need to be provided in the call to this function.
</p>
<p>Note that the Sample dataframe in the global environment does 
not update with the flow information.
</p>


<h3>Value</h3>

<p>eList named list with at least INFO, and Daily data frames.  It can also include a Sample data frame.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readNWISDaily">readNWISDaily</a></code>, <code><a href="#topic+readNWISSample">readNWISSample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
siteNumber &lt;- '01491000'
pCode &lt;- '00631'

Daily &lt;- readNWISDaily(siteNumber,'00060', '1984-10-01', '')
Sample &lt;- readNWISSample(siteNumber,pCode, '1984-10-01', '')
INFO &lt;- readNWISInfo(siteNumber,pCode,interactive=FALSE)
eList &lt;- mergeReport(INFO, Daily, Sample)
Sample &lt;- eList$Sample
plot(eList)

# Create eList with no water quality data:

eList &lt;- mergeReport(INFO, Daily, Sample = NA)
plotFour(eList)

</code></pre>

<hr>
<h2 id='modelEstimation'>Estimation process for the WRTDS (Weighted Regressions on Time, Discharge, and Season)</h2><span id='topic+modelEstimation'></span>

<h3>Description</h3>

<p>This one function does three things. 
1) a jack-knife cross-validation of a WRTDS model in which it augments the Sample data frame in the eList,
2) fits the WRTDS model creating the surfaces matrix and places it in the eList
(the surfaces matrix expresses the estimated concentration as a function of discharge and time), and 
3) estimates the daily values of concentration and flux, and flow normalized concentration and 
flux and places these in the Daily data frame in the eList. 
It returns a named list with the following dataframes: Daily, INFO, Sample, and the matrix: surfaces.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>modelEstimation(eList, windowY = 7, windowQ = 2, windowS = 0.5,
  minNumObs = 100, minNumUncen = 50, edgeAdjust = TRUE, verbose = TRUE,
  run.parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modelEstimation_+3A_elist">eList</code></td>
<td>
<p>named list with at least the INFO, Daily, and Sample dataframes</p>
</td></tr>
<tr><td><code id="modelEstimation_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p>
</td></tr>
<tr><td><code id="modelEstimation_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td></tr>
<tr><td><code id="modelEstimation_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td></tr>
<tr><td><code id="modelEstimation_+3A_minnumobs">minNumObs</code></td>
<td>
<p>numeric specifying the minimum number of observations required to run the weighted regression, default is 100</p>
</td></tr>
<tr><td><code id="modelEstimation_+3A_minnumuncen">minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td></tr>
<tr><td><code id="modelEstimation_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record.
The edgeAdjust method tends to reduce curvature near the start and end of record.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="modelEstimation_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
<tr><td><code id="modelEstimation_+3A_run.parallel">run.parallel</code></td>
<td>
<p>logical to run WRTDS in parallel or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>eList named list with INFO, Daily, and Sample dataframes, along with the surfaces matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList

eList &lt;- modelEstimation(eList)

</code></pre>

<hr>
<h2 id='monthLabel-class'>monthLabel class</h2><span id='topic+monthLabel-class'></span>

<h3>Description</h3>

<p>Some details about the monthLabel class
</p>


<h3>Details</h3>


<dl>
<dt>monthAbbrev</dt><dd><p>A character specifying the abbreviated month name.</p>
</dd>
<dt>monthFull</dt><dd><p>A character specifying the full month name</p>
</dd>
<dt>monthSingle</dt><dd><p>A character specifying the single letter of the month.</p>
</dd>
</dl>


<hr>
<h2 id='multiPlotDataOverview'>Produces a 4 panel plot that gives an overview of the data set prior to any processing</h2><span id='topic+multiPlotDataOverview'></span>

<h3>Description</h3>

<p>This function produces the 4 plots based only on the data stored in the eList.  
The four plots are 1) log concentration versus log discharge, 2) log concentration versus time
3) a boxplot of log concentration by month, and 
4) a side-by-side boxplot of the sampled discharges and all daily discharges. 
To save space, the graphic is labeled only at the top of the 4 graph display. 
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiPlotDataOverview(eList, qUnit = 2, cex.main = 1.2,
  randomCensored = FALSE, logScaleConc = TRUE, logScaleQ = TRUE,
  concLab = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multiPlotDataOverview_+3A_elist">eList</code></td>
<td>
<p>named list with at least Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="multiPlotDataOverview_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or 
numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="multiPlotDataOverview_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="multiPlotDataOverview_+3A_randomcensored">randomCensored</code></td>
<td>
<p>logical. Show censored values as randomized. Default is FALSE.
If TRUE, makeAugmentedSample must be run first.</p>
</td></tr>
<tr><td><code id="multiPlotDataOverview_+3A_logscaleconc">logScaleConc</code></td>
<td>
<p>logical if TRUE y in concentration graphs plotted in log axis. Default is TRUE.</p>
</td></tr>
<tr><td><code id="multiPlotDataOverview_+3A_logscaleq">logScaleQ</code></td>
<td>
<p>logical if TRUE y in streamflow graphs plotted in log axis. Default is TRUE.</p>
</td></tr>
<tr><td><code id="multiPlotDataOverview_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plotConcQ">plotConcQ</a></code>, <code><a href="#topic+boxConcMonth">boxConcMonth</a></code>, 
<code><a href="#topic+plotConcTime">plotConcTime</a></code>, <code><a href="#topic+boxQTwice">boxQTwice</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
multiPlotDataOverview(eList, qUnit=1)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
multiPlotDataOverview(eList, qUnit=1) 

# Custom axes:
eList$INFO$param.units &lt;- "ng"
qConst_precip &lt;- new("qUnit",
                     qShortName = "   mm  ",
                     qUnitFactor = 1,
                     qUnitName = "Millimeter",
                     qUnitExpress = expression(paste("Precipitation in ",mm)),
                     qUnitTiny = expression(paste("Precipitation ", "(", mm, ")")),
                     shortCode = 1,
                     unitUSGS = "Precipitation, in mm",
                     prefix = "Precipitation")

deposition &lt;- new("concUnit",
                  longPrefix = "Deposition",
                  shortPrefix = "Dep")

multiPlotDataOverview(eList, 
                      qUnit = qConst_precip, 
                      concLab = deposition)


</code></pre>

<hr>
<h2 id='plot15'>Makes 15 graphs of streamflow statistics on a single page.  These encompass the 7-day minimum, mean, and 1-day maximum for each of the following 5 Periods of Analysis: Annual, Fall, Winter, Spring and Summer.</h2><span id='topic+plot15'></span>

<h3>Description</h3>

<p>Part of flowHistory system.  All results are expressed as runoff (mm/day). The individual plots are constructed by the same method as used in <code><a href="#topic+plotFlowSingle">plotFlowSingle</a></code>.  The annual results are based on the Water Year.  The seasons are defined as the following groups of months: SON, DJF, MAM, JJA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot15(eList, yearStart, yearEnd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot15_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="plot15_+3A_yearstart">yearStart</code></td>
<td>
<p>A numeric value for year in which the graph should start, default is NA, which indicates that the graph should start with first annual value</p>
</td></tr>
<tr><td><code id="plot15_+3A_yearend">yearEnd</code></td>
<td>
<p>A numeric value for year in which the graph should end, default is NA, which indicates that the graph should end with last annual value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For formatting purposes it is best to use the following commands before calling the plot15 function (savePath is the pathname for directory to store the output)
#   plotName &lt;- paste(savePath, &quot;plot15.&quot;, eList$INFO$shortName, &quot;.ps&quot;, sep = &quot;&quot;)
#   postscript(file = plotName, width = 8, height = 10, horizontal = FALSE, family = &quot;Helvetica&quot;)
Then after running plot15, the user needs to give the command dev.off()
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot1of15">plot1of15</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList

plot15(eList, yearStart = 1980, yearEnd = 2010)
dev.off()

</code></pre>

<hr>
<h2 id='plot1of15'>plots 1 of the 15 graphs of streamflow statistics on a single page</h2><span id='topic+plot1of15'></span>

<h3>Description</h3>

<p>Part of the flowHistory system.  It is designed to create each of the component graphs for the function <code><a href="#topic+plot15">plot15</a></code>. The 15 graphs include annual and four seasonal graphs
for each of 3 flow statistics: 1-day maximum, mean, and 7-day minimum.
The computations involved are the same as the ones used in <code><a href="#topic+plotFlowSingle">plotFlowSingle</a></code> or in <code><a href="#topic+makeAnnualSeries">makeAnnualSeries</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot1of15(eList, yearStart, yearEnd, qf, istat, isBottom = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot1of15_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="plot1of15_+3A_yearstart">yearStart</code></td>
<td>
<p>A numeric value for the year in which the graph should start</p>
</td></tr>
<tr><td><code id="plot1of15_+3A_yearend">yearEnd</code></td>
<td>
<p>A numeric value for the year in which the graph should end</p>
</td></tr>
<tr><td><code id="plot1of15_+3A_qf">qf</code></td>
<td>
<p>a scale factor to convert discharge in cubic feet per second to mm/day, it is 86 / (drainage area in square kilometers)</p>
</td></tr>
<tr><td><code id="plot1of15_+3A_istat">istat</code></td>
<td>
<p>A numeric value selecting the flow statistic to be plotted, must be an integer from 1 to 8</p>
</td></tr>
<tr><td><code id="plot1of15_+3A_isbottom">isBottom</code></td>
<td>
<p>logical, if TRUE the graph is from the bottom row and thus needs x axis labels, if FALSE it does not need labels</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
plot1of15(eList, 1980, 2010, 0.2938476, 5)
</code></pre>

<hr>
<h2 id='plotConcHist'>Graph of annual concentration and flow normalized concentration versus year</h2><span id='topic+plotConcHist'></span>

<h3>Description</h3>

<p>Data come from named list (eList), which contains a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata. 
</p>
<p>The annual concentrations are &quot;time-weighted&quot; mean concentrations (as opposed to &quot;flow-weighted&quot;). 
The annual results reported are for a specified &quot;period of analysis&quot; which can be 
an entire water year, a calendar, a season or even an individual month.  
User specifies this period of analysis in the call to <code>setupYears</code>.
</p>
<p>User can specify plotting of three possible series.  All are in units of mg/L.
Annual mean concentration 
WRTDS_K version of annual mean concentration (requires that WRTDSKalman has been run)
Flow normalized mean concentration
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotConcHist(eList, yearStart = NA, yearEnd = NA, concMax = NA,
  printTitle = TRUE, tinyPlot = FALSE, usgsStyle = FALSE,
  plotFlowNorm = TRUE, plotAnnual = TRUE, plotGenConc = FALSE,
  cex = 0.8, cex.axis = 1.1, cex.main = 1.1, lwd = 2, col = "black",
  col.pred = "green", concLab = 1, col.gen = "red", customPar = FALSE,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotConcHist_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_yearstart">yearStart</code></td>
<td>
<p>numeric is the calendar year containing the first estimated annual value to be plotted, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_yearend">yearEnd</code></td>
<td>
<p>numeric is the calendar year just after the last estimated annual value to be plotted, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_concmax">concMax</code></td>
<td>
<p>numeric. Maximum value of concentration to be plotted.</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE title is
not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small, as a part of a multipart figure, default is FALSE</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_plotflownorm">plotFlowNorm</code></td>
<td>
<p>logical variable if TRUE flow normalized line is plotted, if FALSE not plotted</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_plotannual">plotAnnual</code></td>
<td>
<p>logical variable if <code>TRUE</code>, annual concentration points
from WRTDS output are plotted, if <code>FALSE</code> not plotted</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_plotgenconc">plotGenConc</code></td>
<td>
<p>logical variable. If <code>TRUE</code>, annual concentration points
from <code>WRTDSKalman</code> output are plotted, if <code>FALSE</code> not plotted</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_lwd">lwd</code></td>
<td>
<p>number magnification of line width.</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_col.pred">col.pred</code></td>
<td>
<p>color of flow normalized line on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_col.gen">col.gen</code></td>
<td>
<p>color of points for WRTDS_K output on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotConcHist_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+setupYears">setupYears</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yearStart &lt;- 2001
yearEnd &lt;- 2010
eList &lt;- Choptank_eList

plotConcHist(eList, yearStart, yearEnd)
</code></pre>

<hr>
<h2 id='plotConcPred'>Plot of Observed Concentration versus Estimated Concentration</h2><span id='topic+plotConcPred'></span>

<h3>Description</h3>

<p>Data come from named list, which contains a Sample dataframe with the sample data, 
and an INFO dataframe with metadata. 
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotConcPred(eList, concMax = NA, logScale = FALSE, printTitle = TRUE,
  tinyPlot = FALSE, cex = 0.8, cex.axis = 1.1, cex.main = 1.1,
  customPar = FALSE, col = "black", lwd = 1, randomCensored = FALSE,
  concLab = 1, usgsStyle = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotConcPred_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_concmax">concMax</code></td>
<td>
<p>number specifying the maximum value to be used on the vertical axis, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_logscale">logScale</code></td>
<td>
<p>logical, default TRUE, TRUE indicates x and y axes are on a log scale. FALSE indicates both x and y are on an arithmetic scale.</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small, as a part of a multipart figure, default is FALSE</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_randomcensored">randomCensored</code></td>
<td>
<p>logical. Show censored values as randomized.</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels</p>
</td></tr>
<tr><td><code id="plotConcPred_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotConcPred(eList)

# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
plotConcPred(eList)
</code></pre>

<hr>
<h2 id='plotConcQ'>Plot of Observed Concentration versus Discharge</h2><span id='topic+plotConcQ'></span>

<h3>Description</h3>

<p>Data come from named list, which contains a Sample dataframe with the sample data, 
and an INFO dataframe with metadata. Discharge is plotted on a log scale.
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotConcQ(eList, qUnit = 2, tinyPlot = FALSE, logScale = FALSE,
  randomCensored = FALSE, concMax = NA, concMin = NA,
  printTitle = TRUE, cex = 0.8, cex.axis = 1.1, cex.main = 1.1,
  usgsStyle = FALSE, rmSciX = FALSE, rmSciY = FALSE, customPar = FALSE,
  col = "black", lwd = 1, concLab = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotConcQ_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small as part of a multipart figure, default is FALSE.</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_logscale">logScale</code></td>
<td>
<p>logical if TRUE x and y plotted in log axis</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_randomcensored">randomCensored</code></td>
<td>
<p>logical. Show censored values as randomized.</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_concmax">concMax</code></td>
<td>
<p>number specifying the maximum value to be used on the vertical axis, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_concmin">concMin</code></td>
<td>
<p>numeric value for lower limit on concentration shown on the vertical log graph, default is NA 
(which causes the lower limit to be set automatically, based on the data). This value is ignored for linear scales, using 0 as the minimum value for the concentration axis.</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE title is not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels.</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_rmscix">rmSciX</code></td>
<td>
<p>logical defaults to FALSE, changes x label from scientific to fixed</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_rmsciy">rmSciY</code></td>
<td>
<p>logical defaults to FALSE, changes y label from scientific to fixed</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="plotConcQ_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function has two possible ways to plot censored values (e.g. &quot;less-than values&quot;).
</p>
<p>The default is to plot them as a vertical line that goes from the reporting limit down to the bottom of the graph.
</p>
<p>The alternative is to set randomCensored = TRUE.  In this case a random value is used for plotting the individual sample value.  This random value lies between the reporting limit and zero and it is distributed as a truncated log normal based on the fitted WRTDS model.
</p>
<p>The function makeAugmentedSample must be run first if randomCensored = TRUE.  Running makeAugmentedSample requires that modelEstimation has already been run.
</p>
<p>These random censored values are used to create more readable plots and are not used in any computations about the data set.  The random censored values are shown as open circles and the non-censored data are shown as filled dots.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotConcQ(eList)
plotConcQ(eList, logScale=TRUE)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
plotConcQ(eList)
</code></pre>

<hr>
<h2 id='plotConcQSmooth'>Plot up to three curves representing the concentration versus discharge relationship. Each curve is a different point in time.</h2><span id='topic+plotConcQSmooth'></span>

<h3>Description</h3>

<p>These plots are like a vertical slice of the estimated concentration surface that is seen in the plotContours function.  
These plots show how the concentration-discharge relationship is changing over time. 
Typically the time points selected would be in three years at the same time of year spaced out over the period of record.  But that is not necessary.  
Another possibility is to use this to explore seasonal differences.  In this case the three
dates would be in the same year but different times during the year.
</p>
<p>This plot can also help identify situations where the windowQ may be too small.  If there are substantial oscillations of some of the curves, then the windowQ should be increased.  Alternatively, windowQ may be too large.  This can be seen when the windowQ is reduced (say to 1.0).  A good choice of windowQ would be a value just great enough to damp out oscillations in the curves.
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default. 
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotConcQSmooth(eList, date1, date2, date3, qLow, qHigh, qUnit = 2,
  legendLeft = 0, legendTop = 0, concMax = NA, concMin = NA,
  bw = FALSE, printTitle = TRUE, printValues = FALSE, minNumObs = 100,
  minNumUncen = 50, colors = c("black", "red", "green"),
  printLegend = TRUE, windowY = 7, windowQ = 2, windowS = 0.5,
  tinyPlot = FALSE, customPar = FALSE, lwd = 2, cex = 0.8,
  cex.axis = 1.1, cex.main = 1.1, cex.legend = 1.2, lineVal = c(1, 1,
  1), logScale = FALSE, edgeAdjust = TRUE, concLab = 1,
  usgsStyle = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotConcQSmooth_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_date1">date1</code></td>
<td>
<p>character specifying the date for the first curve on the graph, it is in the form &quot;yyyy-mm-dd&quot; (must be in quotes)</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_date2">date2</code></td>
<td>
<p>character specifying the date for the second curve on the graph, it is in the form &quot;yyyy-mm-dd&quot; (must be in quotes).  If only one curve is wanted this should be NA</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_date3">date3</code></td>
<td>
<p>character specifying the date for the third curve on the graph, it is in the form &quot;yyyy-mm-dd&quot; (must be in quotes).  If a third curve is not wanted this should be NA</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_qlow">qLow</code></td>
<td>
<p>numeric value for the lowest discharge to be considered, expressed in the units of discharge that are being used (as specified in qUnit)</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_qhigh">qHigh</code></td>
<td>
<p>numeric value for the highest discharge to be considered, expressed in the units of discharge that are being used (as specified in qUnit)</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class. <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_legendleft">legendLeft</code></td>
<td>
<p>numeric which represents the left edge of the legend in the units of the plot.</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_legendtop">legendTop</code></td>
<td>
<p>numeric which represents the top edge of the legend in the units of the plot.</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_concmax">concMax</code></td>
<td>
<p>numeric value for upper limit on concentration shown on the graph, default = NA (which causes the upper limit to be set automatically, based on the data)</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_concmin">concMin</code></td>
<td>
<p>numeric value for lower limit on concentration shown on the vertical log graph, default is NA 
(which causes the lower limit to be set automatically, based on the data). This value is ignored for linear scales, using 0 as the minimum value for the concentration axis.</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_bw">bw</code></td>
<td>
<p>logical if TRUE graph is produced in black and white, default is FALSE (which means it will use color)</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_printvalues">printValues</code></td>
<td>
<p>logical variable if TRUE the results shown on the graph are also printed to the console and returned in a dataframe (this can be useful for quantifying the changes seen visually in the graph), default is FALSE (not printed)</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_minnumobs">minNumObs</code></td>
<td>
<p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_minnumuncen">minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_colors">colors</code></td>
<td>
<p>color vector of lines on plot, see ?par 'Color Specification'. Defaults to c(&quot;black&quot;,&quot;red&quot;,&quot;green&quot;)</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_printlegend">printLegend</code></td>
<td>
<p>logical if TRUE, legend is included</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small as part of a multipart figure, default is FALSE.</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_lwd">lwd</code></td>
<td>
<p>number line width, default is 2</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_cex.legend">cex.legend</code></td>
<td>
<p>magnification to be used for legend annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_lineval">lineVal</code></td>
<td>
<p>vector of line types. Defaults to c(1,1,1) which is a solid line for each line. Options: 0=blank, 1=solid (default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_logscale">logScale</code></td>
<td>
<p>logical whether or not to use a log scale in the y axis. Default is FALSE</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record.  The modified method tends to reduce curvature near the start and end of record.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels</p>
</td></tr>
<tr><td><code id="plotConcQSmooth_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>, <code><a href="#topic+runSurvReg">runSurvReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>date1 &lt;- "1982-06-01"
date2 &lt;- "1994-06-01"
date3 &lt;- "2010-06-01"
qLow &lt;- 0.5
qHigh &lt;- 50
eList &lt;- Choptank_eList

plotConcQSmooth(eList, date1, date2, date3, qLow, qHigh,
                 legendLeft = 0.6, legendTop = 0.7)
plotConcQSmooth(eList, date1, date2, date3, qLow, qHigh,
                logScale=TRUE, legendLeft = 0.6, legendTop = 0.7)

</code></pre>

<hr>
<h2 id='plotConcTime'>Plot of Observed Concentration versus Time</h2><span id='topic+plotConcTime'></span>

<h3>Description</h3>

<p>This function allows the user to plot all of the data, but also to limit it in two ways. 
The data can be limited to only those observed concentrations collected in a specified discharge range. 
The data can also be limited to only those observed in certain months of the year. 
These two selection criteria can be combined. For example, 
we may only want to plot data for discharges between 100 and 500 cubic feet per second in the months of March, April and May.
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotConcTime(eList, qUnit = 2, yearStart = NA, yearEnd = NA,
  qLower = NA, qUpper = NA, randomCensored = FALSE, tinyPlot = FALSE,
  concMax = NA, concMin = NA, printTitle = TRUE, logScale = FALSE,
  cex = 0.8, cex.axis = 1.1, cex.main = 1.1, customPar = FALSE,
  col = "black", lwd = 1, concLab = 1, usgsStyle = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotConcTime_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_yearstart">yearStart</code></td>
<td>
<p>numeric is the calendar year containing the first estimated annual value to be plotted, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_yearend">yearEnd</code></td>
<td>
<p>numeric is the calendar year just after the last estimated annual value to be plotted, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_qlower">qLower</code></td>
<td>
<p>numeric the lower bound on values of discharge used to select the data points to be plotted, units are those specified by qUnit, default = NA which is equivalent to a lower bound of zero but if the desired lower bound is zero use qLower = NA</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_qupper">qUpper</code></td>
<td>
<p>numeric the upper bound on values of discharge for selection of data points to be plotted, units are those specified by qUnit, default = NA which is equivalent to an upper bound of infinity</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_randomcensored">randomCensored</code></td>
<td>
<p>logical. Show censored values as randomized.</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small as part of a multipart figure, default is FALSE.</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_concmax">concMax</code></td>
<td>
<p>numeric value for the maximum value to be used on the vertical axis, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_concmin">concMin</code></td>
<td>
<p>numeric value for lower limit on concentration shown on the vertical log graph, default is NA 
(which causes the lower limit to be set automatically, based on the data). This value is ignored for linear scales, using 0 as the minimum value for the concentration axis.</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE title is not printed (this is best for a multi-plot figure).</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_logscale">logScale</code></td>
<td>
<p>logical. If TRUE concentration is plotted on a log axis, default FALSE.</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified.</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex.</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function.
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_lwd">lwd</code></td>
<td>
<p>number line width.</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels</p>
</td></tr>
<tr><td><code id="plotConcTime_+3A_...">...</code></td>
<td>
<p>arbitrary functions sent to the generic plotting function.  See ?par for details on possible parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function has two possible ways to plot censored values (e.g. &quot;less-than values&quot;).
</p>
<p>The default is to plot them as a vertical line that goes from the reporting limit down to the bottom of the graph.
</p>
<p>The alternative is to set randomCensored = TRUE.  In this case a random value is used for plotting the individual sample value.  This random value lies between the reporting limit and zero and it is distributed as a truncated log normal based on the fitted WRTDS model.
</p>
<p>The function makeAugmentedSample must be run first if randomCensored = TRUE.  Running makeAugmentedSample requires that modelEstimation has already been run.
</p>
<p>These random censored values are used to create more readable plots and are not used in any computations about the data set.  The random censored values are shown as open circles and the non-censored data are shown as filled dots.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotConcTime(eList)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
plotConcTime(eList, 
             qUnit = 1,
             qLower = 100,
             qUpper = 10000)
plotConcTime(eList, logScale=TRUE)
plotConcTime(eList, 
             qUnit = 1, 
             qLower = 100, qUpper = 10000,
              randomCensored = TRUE)
</code></pre>

<hr>
<h2 id='plotConcTimeDaily'>Plot of the time series of daily concentration estimates and the sample values for the days that were sampled</h2><span id='topic+plotConcTimeDaily'></span>

<h3>Description</h3>

<p>This plot is useful for visual examination of the ability of the WRTDS, or other model, to fit the 
data, seen in a time-series perspective. 
The graph is most useful when it covers a period of just a few years and not the complete record
but a complete record can be done by repeated use over a series of segments.
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default. 
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotConcTimeDaily(eList, yearStart = NA, yearEnd = NA, tinyPlot = FALSE,
  concMax = NA, printTitle = TRUE, plotGenConc = TRUE, cex = 0.8,
  cex.axis = 1.1, randomCensored = FALSE, cex.main = 1.1,
  customPar = FALSE, col = "black", lwd = 1, prettyDate = TRUE,
  usgsStyle = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotConcTimeDaily_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_yearstart">yearStart</code></td>
<td>
<p>numeric specifying the starting date (expressed as decimal years, for example 1989.0) for the plot</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_yearend">yearEnd</code></td>
<td>
<p>numeric specifying the ending date for the plot</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be short and wide, default is FALSE.</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_concmax">concMax</code></td>
<td>
<p>number specifying the maximum value to be used on the vertical axis,
default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE title is
not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_plotgenconc">plotGenConc</code></td>
<td>
<p>logical variable. If <code>TRUE</code>, annual concentration points
from <code>WRTDSKalman</code> output are plotted, if <code>FALSE</code> WRTDS concentration is plotted,</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_randomcensored">randomCensored</code></td>
<td>
<p>if TRUE plot a random value for censored data.  Default is FALSE.</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_prettydate">prettyDate</code></td>
<td>
<p>logical use 'pretty' limits for date axis if TRUE, or force the yearStart/yearEnd as limits if FALSE</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels</p>
</td></tr>
<tr><td><code id="plotConcTimeDaily_+3A_...">...</code></td>
<td>
<p>arbitrary functions sent to the generic plotting function.  See ?par for details on possible parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotConcTimeDaily(eList)
plotConcTimeDaily(eList, 
                  yearStart = 1998,
                  yearEnd = 2001,
                  plotGenConc = FALSE)
</code></pre>

<hr>
<h2 id='plotConcTimeSmooth'>Plot up to three curves representing the concentration versus time relationship, each curve representing a different flow.</h2><span id='topic+plotConcTimeSmooth'></span>

<h3>Description</h3>

<p>These plots show how the concentration-time relationship is changing over flow.
</p>
<p>This plot can also help identify situations where the windowY may be too small.  If there are substantial oscillations of some of the curves, then the windowY should be increased. Alternatively, windowY may be too large.  This can be seen when the windowY is reduced (say to 4.0).  A good choice of windowY would be a value just great enough to damp out oscillations in the curves.
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotConcTimeSmooth(eList, q1, q2, q3, centerDate, yearStart, yearEnd,
  qUnit = 2, legendLeft = 0, legendTop = 0, concMax = NA,
  concMin = NA, bw = FALSE, printTitle = TRUE, colors = c("black",
  "red", "green"), printValues = FALSE, tinyPlot = FALSE, concLab = 1,
  monthLab = 1, minNumObs = 100, minNumUncen = 50, windowY = 10,
  windowQ = 2, windowS = 0.5, cex.main = 1.1, lwd = 2,
  printLegend = TRUE, cex.legend = 1.2, cex = 0.8, cex.axis = 1.1,
  customPar = FALSE, lineVal = c(1, 1, 1), logScale = FALSE,
  edgeAdjust = TRUE, usgsStyle = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotConcTimeSmooth_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_q1">q1</code></td>
<td>
<p>numeric This is the discharge value for the first curve to be shown on the plot. It is expressed in units specified by qUnit.</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_q2">q2</code></td>
<td>
<p>numeric This is the discharge value for the second curve to be shown on the plot. It is expressed in units specified by qUnit. If you don't want a second curve then the argument must be q2=NA</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_q3">q3</code></td>
<td>
<p>numeric This is the discharge value for the third curve to be shown on the plot. It is expressed in units specified by qUnit. If you don't want a third curve then the argument must be q3=NA</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_centerdate">centerDate</code></td>
<td>
<p>character This is the time of year to be used as the center date for the smoothing. It is expressed as a month and day and must be in the form &quot;mm-dd&quot;</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_yearstart">yearStart</code></td>
<td>
<p>numeric This is the starting year for the graph. The first value plotted for each curve will be at the first instance of centerDate in the year designated by yearStart.</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_yearend">yearEnd</code></td>
<td>
<p>numeric This is the end of the sequence of values plotted on the graph.The last value will be the last instance of centerDate prior to the start of yearEnd. (Note, the number of values plotted on each curve will be yearEnd-yearStart.)</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class. <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_legendleft">legendLeft</code></td>
<td>
<p>numeric which represents the left edge of the legend in the units of the plot.</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_legendtop">legendTop</code></td>
<td>
<p>numeric which represents the top edge of the legend in the units of the plot.</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_concmax">concMax</code></td>
<td>
<p>numeric value for upper limit on concentration shown on the graph, default = NA (which causes the upper limit to be set automatically, based on the data)</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_concmin">concMin</code></td>
<td>
<p>numeric value for lower limit on concentration shown on the vertical log graph, default is NA 
(which causes the lower limit to be set automatically, based on the data). This value is ignored for linear scales, using 0 as the minimum value for the concentration axis.</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_bw">bw</code></td>
<td>
<p>logical if TRUE graph is produced in black and white, default is FALSE (which means it will use color)</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_colors">colors</code></td>
<td>
<p>color vector of lines on plot, see ?par 'Color Specification'. Defaults to c(&quot;black&quot;,&quot;red&quot;,&quot;green&quot;)</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_printvalues">printValues</code></td>
<td>
<p>logical variable if TRUE the results shown on the graph are printed to the console and returned in a dataframe (this can be useful for quantifying the changes seen visually in the graph), default is FALSE (not printed)</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small, as a part of a multipart figure, default is FALSE</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_monthlab">monthLab</code></td>
<td>
<p>object of monthLabel class, or numeric represented the short code, 
or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_minnumobs">minNumObs</code></td>
<td>
<p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_minnumuncen">minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 10</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_lwd">lwd</code></td>
<td>
<p>line width, a positive number, defaulting to 2</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_printlegend">printLegend</code></td>
<td>
<p>logical if TRUE, legend is included</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_cex.legend">cex.legend</code></td>
<td>
<p>number magnification  of legend</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_lineval">lineVal</code></td>
<td>
<p>vector of line types. Defaults to c(1,1,1) which is a solid line for each line. Options: 0=blank, 1=solid (default), 2=dashed, 3=dotted, 4=dotdash, 5=longdash, 6=twodash</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_logscale">logScale</code></td>
<td>
<p>logical whether or not to use a log scale in the y axis.</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record.  The modified method tends to reduce curvature near the start and end of record.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels</p>
</td></tr>
<tr><td><code id="plotConcTimeSmooth_+3A_...">...</code></td>
<td>
<p>arbitrary functions sent to the generic plotting function.  See ?par for details on possible parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>, <code><a href="#topic+runSurvReg">runSurvReg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q1 &lt;- 1
q2 &lt;- 10
q3 &lt;- 100
centerDate &lt;- "07-01"
yearStart &lt;- 1990
yearEnd &lt;- 2010
eList &lt;- Choptank_eList
plotConcTimeSmooth(eList, q1, q2,q3, centerDate, 
                   yearStart, yearEnd, legendLeft = 1997, 
                   legendTop = 0.44, cex.legend = 0.9)
plotConcTimeSmooth(eList, q1, q2,q3, centerDate, yearStart, 
                   yearEnd, logScale = TRUE, legendLeft = 1994, 
                   legendTop = 0.4, cex.legend = 0.9)
</code></pre>

<hr>
<h2 id='plotContours'>Color contour plot of the estimated surfaces as a function of discharge and time (surfaces include log concentration, standard error, and concentration)</h2><span id='topic+plotContours'></span>

<h3>Description</h3>

<p>These plots are normally used for plotting the estimated concentration surface (whatSurface = 3) but can be used to explore the 
estimated surfaces for the log of concentration or for the standard error (in log space) which is what determines the bias correction. 
The plots are often more interpretable when the time limits for the plot are less than a decade.
To explore changes over a long time period it is best to do this multiple times, for various time slices of 2 years (for example) or to use the function <code>plotDiffContours</code>.
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Obtaining a plot that provides good insight it is useful to experiment with several of the arguments such as yearStart, yearEnd, qBottom, qTop, and contourLevels. 
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotContours(eList, yearStart, yearEnd, qBottom = NA, qTop = NA,
  whatSurface = 3, qUnit = 2, contourLevels = NA, span = 60,
  pval = 0.05, printTitle = TRUE, vert1 = NA, vert2 = NA, horiz = NA,
  tcl = 0.03, flowDuration = TRUE, customPar = FALSE, yTicks = NA,
  tick.lwd = 1, usgsStyle = FALSE, lwd = 2, cex.main = 1,
  cex.axis = 1, concLab = 1, color.palette = colorRampPalette(c("white",
  "gray", "blue", "red")), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotContours_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes, and surfaces matrix</p>
</td></tr>
<tr><td><code id="plotContours_+3A_yearstart">yearStart</code></td>
<td>
<p>numeric value for the starting date for the graph, expressed as decimal year (typically whole number such as 1989.0)</p>
</td></tr>
<tr><td><code id="plotContours_+3A_yearend">yearEnd</code></td>
<td>
<p>numeric value for the ending date for the graph, expressed as decimal year, (for example 1993.0)</p>
</td></tr>
<tr><td><code id="plotContours_+3A_qbottom">qBottom</code></td>
<td>
<p>numeric value for the bottom edge of the graph, expressed in the units of discharge that are being used (as specified in qUnit). NA will choose a &quot;pretty&quot; lower limit nearest to the 5% of discharge.  If yTicks are specified, then the first value of yTicks becomes the lowest discharge shown on the figure.</p>
</td></tr>
<tr><td><code id="plotContours_+3A_qtop">qTop</code></td>
<td>
<p>numeric value for the top edge of the graph, expressed in the units of discharge that are being used (as specified in qUnit). NA will choose a &quot;pretty&quot; upper limit nearest to the 95% of discharge. If yTicks are specified, then the last value of yTicks becomes the highest discharge shown on the figure.</p>
</td></tr>
<tr><td><code id="plotContours_+3A_whatsurface">whatSurface</code></td>
<td>
<p>numeric value, can only accept 1, 2, or 3;  whatSurface=1 is yHat (log concentration), whatSurface=2 is SE (standard error of log concentration), and whatSurface=3 is ConcHat (unbiased estimate of concentration), default = 3.</p>
</td></tr>
<tr><td><code id="plotContours_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class. <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotContours_+3A_contourlevels">contourLevels</code></td>
<td>
<p>numeric vector containing the contour levels for the contour plot, arranged in ascending order, default is NA (which causes the contour levels to be set automatically, based on the data)</p>
</td></tr>
<tr><td><code id="plotContours_+3A_span">span</code></td>
<td>
<p>numeric, it is the half-width (in days) of the smoothing window for computing the flow duration information, default = 60</p>
</td></tr>
<tr><td><code id="plotContours_+3A_pval">pval</code></td>
<td>
<p>numeric, the probability value for the lower flow frequency line on the graph</p>
</td></tr>
<tr><td><code id="plotContours_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed</p>
</td></tr>
<tr><td><code id="plotContours_+3A_vert1">vert1</code></td>
<td>
<p>numeric, the location in time for a black vertical line on the figure, yearStart&lt;vert1&lt;yearEnd, default is NA (vertical line is not drawn)</p>
</td></tr>
<tr><td><code id="plotContours_+3A_vert2">vert2</code></td>
<td>
<p>numeric, the location in time for a black vertical line on the figure, yearStart&lt;vert2&lt;yearEnd, default is NA (vertical line is not drawn)</p>
</td></tr>
<tr><td><code id="plotContours_+3A_horiz">horiz</code></td>
<td>
<p>numeric, the location in discharge for a black horizontal line on the figure, qBottom&lt;vert1&lt;qTop, default is NA (no horizontal line is drawn)</p>
</td></tr>
<tr><td><code id="plotContours_+3A_tcl">tcl</code></td>
<td>
<p>numeric, length of tick marks in inches, default is 0.03</p>
</td></tr>
<tr><td><code id="plotContours_+3A_flowduration">flowDuration</code></td>
<td>
<p>logical variable if TRUE plot the flow duration lines (5 and 95 flow percentiles), if FALSE do not plot them, default = TRUE</p>
</td></tr>
<tr><td><code id="plotContours_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins.</p>
</td></tr>
<tr><td><code id="plotContours_+3A_yticks">yTicks</code></td>
<td>
<p>vector of yTick labels and marks that will be plotted in log space. (for example yTicks = c(3, 5, 10, 20, 50, 100, 200, 400). The first and last values determine the range of the y axis. If NA, the tick marks will be automatically generated.</p>
</td></tr>
<tr><td><code id="plotContours_+3A_tick.lwd">tick.lwd</code></td>
<td>
<p>line width for axis ticks, default is 1</p>
</td></tr>
<tr><td><code id="plotContours_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels.</p>
</td></tr>
<tr><td><code id="plotContours_+3A_lwd">lwd</code></td>
<td>
<p>numeric, line width of flowDuration curve, default is 2</p>
</td></tr>
<tr><td><code id="plotContours_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotContours_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotContours_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="plotContours_+3A_color.palette">color.palette</code></td>
<td>
<p>a function that creates a color palette for the contour plot. Default goes from white to gray to blue to red 
using the function <code>colorRampPalette(c("white","gray","blue","red"))</code>. A few preset options are heat.colors, topo.colors, and terrain.colors.</p>
</td></tr>
<tr><td><code id="plotContours_+3A_...">...</code></td>
<td>
<p>arbitrary functions sent to the generic plotting function.  See ?par for details on possible parameters</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>yearStart &lt;- 2002
yearEnd &lt;- 2010
qBottom &lt;- 0.5
qTop&lt;- 20
clevel &lt;- seq(0,2,0.25)
eList &lt;- Choptank_eList
plotContours(eList, yearStart, yearEnd, qBottom, qTop, 
             contourLevels = clevel)  
plotContours(eList, yearStart, yearEnd, qBottom, qTop = 50, 
             contourLevels = clevel, flowDuration = FALSE) 
colors &lt;- colorRampPalette(c("white","black"))
plotContours(eList, yearStart, yearEnd, qBottom, qTop = 50, 
             contourLevels = clevel, color.palette = colors, 
             flowDuration = FALSE)
</code></pre>

<hr>
<h2 id='plotDiffContours'>Plots the difference between two years from a contour plot created by plotContours</h2><span id='topic+plotDiffContours'></span>

<h3>Description</h3>

<p>These plots are normally used for plotting changes in the estimated concentration surface (whatSurface=3) but can be used to explore the 
changes in estimated surfaces for the log of concentration or for the standard error (in log space) which is what determines the bias correction.
</p>
<p>The difference can be shown either as an arithmetic difference or as a percentage difference.
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotDiffContours(eList, year0, year1, qBottom = NA, qTop = NA,
  maxDiff = NA, whatSurface = 3, tcl = 0.03, qUnit = 2, span = 60,
  pval = 0.05, printTitle = TRUE, plotPercent = FALSE, vert1 = NA,
  vert2 = NA, horiz = NA, flowDuration = TRUE, yTicks = NA,
  tick.lwd = 1, lwd = 2, cex.main = 0.95, cex.axis = 1,
  customPar = FALSE, usgsStyle = FALSE,
  color.palette = colorRampPalette(c("blue", "white", "red")), concLab = 1,
  monthLab = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotDiffContours_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes, and surfaces matrix</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_year0">year0</code></td>
<td>
<p>numeric value for the calendar year that is the first year of the pair of years for the analysis, should be a whole number</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_year1">year1</code></td>
<td>
<p>numeric value for the calendar year that is the second year of the pair of years for the analysis, should be a whole number</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_qbottom">qBottom</code></td>
<td>
<p>numeric value for the bottom edge of the graph, expressed in the units of discharge that are being used (as specified in qUnit). NA will choose a &quot;pretty&quot; lower limit nearest to the 5% of discharge. If yTicks are specified, then the first value of yTicks becomes the lowest discharge shown on the figure.</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_qtop">qTop</code></td>
<td>
<p>numeric value for the top edge of the graph, expressed in the units of discharge that are being used (as specified in qUnit). NA will choose a &quot;pretty&quot; upper limit nearest to the 95% of discharge. If yTicks are specified, then the last value of yTicks becomes the highest discharge shown on the figure.</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_maxdiff">maxDiff</code></td>
<td>
<p>numeric value which is the absolute value of the largest change in concentration that will be shown on the figure. If NA, the scale will be set from 5% to 95% of the concentration difference. If plotPercent = TRUE then maxDiff will be the maximum percentage difference.</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_whatsurface">whatSurface</code></td>
<td>
<p>numeric value, can only accept 1, 2, or 3;  whatSurface = 1 is yHat (log concentration), whatSurface = 2 is SE (standard error of log concentration), and whatSurface = 3 is ConcHat (unbiased estimate of concentration), default = 3</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_tcl">tcl</code></td>
<td>
<p>numeric, length of tick marks in inches, default is 0.1</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class. <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_span">span</code></td>
<td>
<p>numeric, it is the half-width (in days) of the smoothing window for computing the flow duration information, default = 60</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_pval">pval</code></td>
<td>
<p>numeric, the probability value for the lower flow frequency line on the graph</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_plotpercent">plotPercent</code></td>
<td>
<p>logical. If TRUE, plots percent difference, if FALSE, plots arithmetic differences. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_vert1">vert1</code></td>
<td>
<p>numeric, the location in time for a black vertical line on the figure, yearStart &lt; vert1 &lt; yearEnd, default is NA (vertical line is not drawn)</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_vert2">vert2</code></td>
<td>
<p>numeric, the location in time for a black vertical line on the figure, yearStart &lt; vert2 &lt; yearEnd, default is NA (vertical line is not drawn)</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_horiz">horiz</code></td>
<td>
<p>numeric, the location in discharge for a black horizontal line on the figure, qBottom&lt;vert1&lt;qTop, default is NA (no horizontal line is drawn)</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_flowduration">flowDuration</code></td>
<td>
<p>logical variable if TRUE plot the flow duration lines (5 and 95 flow percentiles), if FALSE do not plot them, default = TRUE</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_yticks">yTicks</code></td>
<td>
<p>vector of yTick labels and marks that will be plotted in log space. (for example yTicks = c(3, 5, 10, 20, 50, 100, 200, 400). The first and last values determine the range of the y axis. If NA, the tick marks will be automatically generated.</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_tick.lwd">tick.lwd</code></td>
<td>
<p>line width for axis ticks, default is 2</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_lwd">lwd</code></td>
<td>
<p>numeric, line width of flowDuration curve, default is 1</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins.</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels.</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_color.palette">color.palette</code></td>
<td>
<p>a function that creates a color palette for the contour plot. Default goes from blue to white to red 
using the function <code>colorRampPalette(c("blue","white","red"))</code>. A few preset options are heat.colors, topo.colors, and terrain.colors.</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_monthlab">monthLab</code></td>
<td>
<p>object of monthLabel class, or numeric represented the short code, 
or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotDiffContours_+3A_...">...</code></td>
<td>
<p>arbitrary functions sent to the generic plotting function.  See ?par for details on possible parameters</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>year0 &lt;- 1990
year1 &lt;- 2009
qBottom &lt;- 0.5
qTop &lt;- 20
maxDiff&lt;-0.5
eList &lt;- Choptank_eList
plotDiffContours(eList, year0, year1, qBottom, qTop, maxDiff = 0.5)
plotDiffContours(eList, year0, year1, qBottom, qTop, maxDiff = 50, plotPercent = TRUE)
</code></pre>

<hr>
<h2 id='plotFlowSingle'>Creates a plot of a time series of a particular flow statistic and a loess smooth of that flow statistic</h2><span id='topic+plotFlowSingle'></span>

<h3>Description</h3>

<p>A part of the flowHistory system.
The index of the flow statistics is istat.  These statistics are: 
(1) 1-day minimum, (2) 7-day minimum, (3) 30-day minimum, (4) median
(5) mean, (6) 30-day maximum, (7) 7-day maximum, and (8) 1-day maximum
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFlowSingle(eList, istat, yearStart = NA, yearEnd = NA, qMax = NA,
  printTitle = TRUE, tinyPlot = FALSE, customPar = FALSE,
  runoff = FALSE, qUnit = 1, printStaName = TRUE, printPA = TRUE,
  usgsStyle = FALSE, printIstat = TRUE, cex = 0.8, cex.axis = 1.1,
  cex.main = 1.1, lwd = 2, col = "black", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotFlowSingle_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_istat">istat</code></td>
<td>
<p>A numeric value for the flow statistic to be graphed (possible values are 1 through 8)</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_yearstart">yearStart</code></td>
<td>
<p>A numeric value for year in which the graph should start, default is NA, which indicates that the graph should start with first annual value</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_yearend">yearEnd</code></td>
<td>
<p>A numeric value for year in which the graph should end, default is NA, which indicates that the graph should end with last annual value</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_qmax">qMax</code></td>
<td>
<p>A numeric value for the maximum value to be used for y-axis of graph, default is NA means that graph is self-scaling</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable, if TRUE title is printed, if FALSE title is not printed, default is TRUE</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small, as a part of a multipart figure, default is FALSE</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_runoff">runoff</code></td>
<td>
<p>logical variable, if TRUE the streamflow data are converted to runoff values in mm/day</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_printstaname">printStaName</code></td>
<td>
<p>logical variable, if TRUE station name is printed in title, if FALSE not printed, default is TRUE</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_printpa">printPA</code></td>
<td>
<p>logical variable, if TRUE Period of Analysis information is printed in title, if FALSE not printed, default is TRUE</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels.</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_printistat">printIstat</code></td>
<td>
<p>logical variable, if TRUE print the statistic name is printed in title, if FALSE not printed, default is TRUE</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotFlowSingle_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The curve plotted on the graph is a loess smooth of the data.  
This smooth is computed on the logs of the data and then transformed back to plot.
The width of the smoothing window is 20 years on either side of the year being plotted
However, the window width can be adjusted using setPA function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+makeAnnualSeries">makeAnnualSeries</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotFlowSingle(eList, 1)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
plotFlowSingle(eList, 1)
</code></pre>

<hr>
<h2 id='plotFluxHist'>Graph of annual flux and flow normalized flux versus year</h2><span id='topic+plotFluxHist'></span>

<h3>Description</h3>

<p>The annual results reported are for a specified &quot;period of analysis&quot; which can be 
an entire water year, a calendar, a season or even an individual month. 
The user specifies this period of analysis in the call to setupYears.
Values plotted express a flux rate, such as thousand kg per year
For a period of analysis that is less than a year, this does not equal the mass transported over the period of analysis
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list (eList), which contains a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFluxHist(eList, yearStart = NA, yearEnd = NA, fluxUnit = 9,
  fluxMax = NA, printTitle = TRUE, usgsStyle = FALSE,
  plotFlowNorm = TRUE, plotAnnual = TRUE, plotGenFlux = FALSE,
  tinyPlot = FALSE, col = "black", col.pred = "green", col.gen = "red",
  cex = 0.8, cex.axis = 1.1, cex.main = 1.1, lwd = 2,
  customPar = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotFluxHist_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_yearstart">yearStart</code></td>
<td>
<p>numeric is the calendar year containing the first estimated annual value to be plotted, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_yearend">yearEnd</code></td>
<td>
<p>numeric is the calendar year just after the last estimated annual value to be plotted, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>number representing entry in pre-defined fluxUnit class array. <code><a href="#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code></p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_fluxmax">fluxMax</code></td>
<td>
<p>number specifying the maximum value to be used on the vertical axis, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE title is not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels.</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_plotflownorm">plotFlowNorm</code></td>
<td>
<p>logical variable if TRUE the flow normalized line is plotted, if FALSE not plotted</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_plotannual">plotAnnual</code></td>
<td>
<p>logical variable if TRUE annual flux points are plotted, if FALSE not plotted</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_plotgenflux">plotGenFlux</code></td>
<td>
<p>logical variable. If <code>TRUE</code>, annual flux points from 
<code>WRTDSKalman</code> output are plotted, if <code>FALSE</code> the generalized flux is not plotted.</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small, as a part of a multipart figure, default is FALSE</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_col.pred">col.pred</code></td>
<td>
<p>color of flow normalized line on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_col.gen">col.gen</code></td>
<td>
<p>color of points for WRTDS_K output on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotFluxHist_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+setupYears">setupYears</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yearStart &lt;- 2001
yearEnd &lt;- 2010
eList &lt;- Choptank_eList
# Water year:

plotFluxHist(eList)
plotFluxHist(eList, yearStart, yearEnd, fluxUnit = 1)
plotFluxHist(eList, yearStart, yearEnd, fluxUnit = 'kgDay')

</code></pre>

<hr>
<h2 id='plotFluxPred'>Graph of observed versus estimated flux</h2><span id='topic+plotFluxPred'></span>

<h3>Description</h3>

<p>Data come from named list, which contains a Sample dataframe with the sample data, 
and an INFO dataframe with metadata. 
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFluxPred(eList, fluxUnit = 3, fluxMax = NA, printTitle = TRUE,
  oneToOneLine = TRUE, customPar = FALSE, col = "black", lwd = 1,
  cex = 0.8, cex.axis = 1.1, cex.main = 1.1, tinyPlot = FALSE,
  usgsStyle = FALSE, logScale = FALSE, randomCensored = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotFluxPred_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>number representing entry in pre-defined fluxUnit class array. <code><a href="#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code></p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_fluxmax">fluxMax</code></td>
<td>
<p>number specifying the maximum value to be used on the vertical axis, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_onetooneline">oneToOneLine</code></td>
<td>
<p>inserts 1:1 line</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable if TRUE plot is designed to be small, if FALSE it is designed for page size, default is FALSE (not fully implemented yet)</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels.</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_logscale">logScale</code></td>
<td>
<p>logical if TRUE x and y plotted in log axis</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_randomcensored">randomCensored</code></td>
<td>
<p>logical. Show censored values as randomized.</p>
</td></tr>
<tr><td><code id="plotFluxPred_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotFluxPred(eList)
plotFluxPred(eList, fluxUnit = 'poundsDay')
plotFluxPred(eList, logScale=TRUE)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
plotFluxPred(eList)
</code></pre>

<hr>
<h2 id='plotFluxQ'>Sample data plot: observed log flux vs log discharge</h2><span id='topic+plotFluxQ'></span>

<h3>Description</h3>

<p>Concentration and discharge data used to compute flux come from a data frame named Sample which contains the sample data.
The metadata come from a data frame named INFO.
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFluxQ(eList, qUnit = 2, logScale = TRUE, fluxUnit = 3,
  tinyPlot = FALSE, fluxMax = NA, fluxMin = NA, col = "black",
  lwd = 1, printTitle = TRUE, usgsStyle = FALSE, cex = 0.8,
  cex.axis = 1.1, cex.main = 1.1, customPar = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotFluxQ_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class. <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_logscale">logScale</code></td>
<td>
<p>logical, default TRUE, TRUE creates a log-log scale, FALSE creates an arithmatic scale.</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>object of fluxUnit class. <code><a href="#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable if TRUE plot is designed to fit into a multi-plot array, default is FALSE</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_fluxmax">fluxMax</code></td>
<td>
<p>numeric specifying the maximum value to be used on the vertical axis, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_fluxmin">fluxMin</code></td>
<td>
<p>numeric specifying the minimum value to be used on the vertical axis, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels.</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotFluxQ_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotFluxQ(eList, qUnit = 1, fluxUnit = 1)
plotFluxQ(eList, fluxUnit = 'kgDay')
plotFluxQ(eList)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
plotFluxQ(eList)
</code></pre>

<hr>
<h2 id='plotFluxTimeDaily'>Plot of the time series of daily flux estimates and the sample values for the days that were sampled</h2><span id='topic+plotFluxTimeDaily'></span>

<h3>Description</h3>

<p>This plot is useful for visual examination of the ability of the WRTDS, or other model, to fit the 
data, as seen in a time-series perspective. 
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFluxTimeDaily(eList, yearStart = NA, yearEnd = NA, tinyPlot = FALSE,
  fluxUnit = 3, fluxMax = NA, randomCensored = FALSE,
  printTitle = TRUE, plotGenFlux = TRUE, usgsStyle = FALSE, cex = 0.8,
  cex.axis = 1.1, cex.main = 1.1, customPar = FALSE, col = "black",
  lwd = 1, prettyDate = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotFluxTimeDaily_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_yearstart">yearStart</code></td>
<td>
<p>numeric specifying the starting date (expressed as decimal years, for example 1989.0) for the plot</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_yearend">yearEnd</code></td>
<td>
<p>numeric specifying the ending date for the plot</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be short and wide, default is FALSE.</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>number representing in pre-defined fluxUnit class array. <code><a href="#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code></p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_fluxmax">fluxMax</code></td>
<td>
<p>number specifying the maximum value to be used on the vertical axis, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_randomcensored">randomCensored</code></td>
<td>
<p>logical, if TRUE plot a random value for censored data.  Default is FALSE.</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE title is not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_plotgenflux">plotGenFlux</code></td>
<td>
<p>logical variable. If <code>TRUE</code>, annual flux points from 
<code>WRTDSKalman</code> output are plotted, if <code>FALSE</code> WRTDS flux is plotted.</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels.</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_prettydate">prettyDate</code></td>
<td>
<p>logical use 'pretty' limits for date axis if TRUE, or force the yearStart/yearEnd as limits if FALSE</p>
</td></tr>
<tr><td><code id="plotFluxTimeDaily_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotFluxTimeDaily(eList)
plotFluxTimeDaily(eList, 2001,2009)
</code></pre>

<hr>
<h2 id='plotFour'>Makes four graphs of streamflow statistics on a single page</h2><span id='topic+plotFour'></span>

<h3>Description</h3>

<p>Part of the flowHistory system.  The four statistics are 1-day maximum, annual mean, annual 7-day minimum, and the running standard deviation of the log daily discharge values.
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata. Each graph shows a loess smooth of the data that are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFour(eList, yearStart = NA, yearEnd = NA, printTitle = TRUE,
  runoff = FALSE, qUnit = 1, window = 15, cex = 0.8, cex.axis = 1.2,
  cex.main = 1.2, col = "black", lwd = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotFour_+3A_elist">eList</code></td>
<td>
<p>named list with at least Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotFour_+3A_yearstart">yearStart</code></td>
<td>
<p>A numeric value for year in which the graph should start, default is NA, which indicates that the graph should start with first annual value</p>
</td></tr>
<tr><td><code id="plotFour_+3A_yearend">yearEnd</code></td>
<td>
<p>A numeric value for year in which the graph should end, default is NA, which indicates that the graph should end with last annual value</p>
</td></tr>
<tr><td><code id="plotFour_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable, if TRUE title is printed, if FALSE title is not printed, default is TRUE</p>
</td></tr>
<tr><td><code id="plotFour_+3A_runoff">runoff</code></td>
<td>
<p>logical variable, if TRUE the streamflow data are converted to runoff values in mm/day</p>
</td></tr>
<tr><td><code id="plotFour_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotFour_+3A_window">window</code></td>
<td>
<p>numeric which is the full width, in years, of the time window over which the standard deviation is computed, default = 15</p>
</td></tr>
<tr><td><code id="plotFour_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotFour_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFour_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFour_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotFour_+3A_lwd">lwd</code></td>
<td>
<p>number line width. Default is 1.</p>
</td></tr>
<tr><td><code id="plotFour_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plotFlowSingle">plotFlowSingle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList

#Water year:
plotFour(eList)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList,paStart=6,paLong=3)
plotFour(eList)
 
</code></pre>

<hr>
<h2 id='plotFourStats'>Makes four graphs of annual streamflow statistics on a single page</h2><span id='topic+plotFourStats'></span>

<h3>Description</h3>

<p>Part of the flowHistory system.  The four statistics are 1-day maximum, annual mean, annual median, and annual 7-day minimum.
Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata. Each graph shows a loess smooth of the data that are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotFourStats(eList, yearStart = NA, yearEnd = NA, printTitle = TRUE,
  runoff = FALSE, cex.main = 1.2, qUnit = 1, cex.axis = 1.2,
  cex = 0.8, col = "black", lwd = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotFourStats_+3A_elist">eList</code></td>
<td>
<p>named list with at least Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotFourStats_+3A_yearstart">yearStart</code></td>
<td>
<p>A numeric value for year in which the graph should start, default is NA, which indicates that the graph should start with first annual value</p>
</td></tr>
<tr><td><code id="plotFourStats_+3A_yearend">yearEnd</code></td>
<td>
<p>A numeric value for year in which the graph should end, default is NA, which indicates that the graph should end with last annual value</p>
</td></tr>
<tr><td><code id="plotFourStats_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable, if TRUE title is printed, if FALSE title is not printed, default is TRUE</p>
</td></tr>
<tr><td><code id="plotFourStats_+3A_runoff">runoff</code></td>
<td>
<p>logical variable, if TRUE the streamflow data are converted to runoff values in mm/day</p>
</td></tr>
<tr><td><code id="plotFourStats_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFourStats_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotFourStats_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotFourStats_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotFourStats_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotFourStats_+3A_lwd">lwd</code></td>
<td>
<p>number line width. Default is 1.</p>
</td></tr>
<tr><td><code id="plotFourStats_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plotFlowSingle">plotFlowSingle</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList

# Water year:
plotFourStats(eList)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList,paStart=6,paLong=3)
plotFourStats(eList)

</code></pre>

<hr>
<h2 id='plotMonthTrend'>Plot monthly trend result from runPairs</h2><span id='topic+plotMonthTrend'></span>

<h3>Description</h3>

<p>Plot monthly trend result from runPairs. The change in concentration
or flux is calculated from the <code>runPairs</code> function. This plotting
function shows an arrow for each month. If the trend from year1 to year2 
was increasing, the arrow is red and pointing up. If the trend was decreasing,
the arrow is black and pointing down.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotMonthTrend(pairResults, yMax = NA, arrowFactor = 0.75, flux = TRUE,
  printTitle = TRUE, concLab = 1, monthLab = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotMonthTrend_+3A_pairresults">pairResults</code></td>
<td>
<p>results from <code>runPairs</code>.</p>
</td></tr>
<tr><td><code id="plotMonthTrend_+3A_ymax">yMax</code></td>
<td>
<p>numeric. Upper limit for plot. Default is <code>NA</code>,
which will use the maximum of the data.</p>
</td></tr>
<tr><td><code id="plotMonthTrend_+3A_arrowfactor">arrowFactor</code></td>
<td>
<p>numeric. Scaling factor for the size of the arrows.
The arrows are automatically scaled to the overall trend. This scaling 
factor helps adjust how big/small they are.</p>
</td></tr>
<tr><td><code id="plotMonthTrend_+3A_flux">flux</code></td>
<td>
<p>logical. <code>TRUE</code> is flux, <code>FALSE</code> is concentration.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plotMonthTrend_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE title is not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotMonthTrend_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="plotMonthTrend_+3A_monthlab">monthLab</code></td>
<td>
<p>object of monthLabel class, or numeric represented the short code, 
or character representing the descriptive name.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The flux values for each month are flow normalized monthly watershed yields 
expressed as kg/month/km^2.  The concentrations are the mean flow normalized
concentration, expressed in whatever concentration units the raw data are
expressed as (typically mg/L).
</p>


<h3>Value</h3>

<p>Base R plot of monthly trends
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
eList &lt;- Choptank_eList
year1 &lt;- 1985
year2 &lt;- 2010



pairOut_1 &lt;- runPairs(eList, year1, year2, windowSide = 0)

plotMonthTrend(pairOut_1)
plotMonthTrend(pairOut_1, flux = FALSE)

eList &lt;- setPA(eList, paStart = 12, paLong = 3)
pairOut_2 &lt;- runPairs(eList, year1, year2, windowSide = 0)

plotMonthTrend(pairOut_2)

eList &lt;- setPA(eList, paStart = 1, paLong = 12)
pairOut_3 &lt;- runPairs(eList, year1, year2, windowSide = 0)

plotMonthTrend(pairOut_3)


 
</code></pre>

<hr>
<h2 id='plotQTimeDaily'>Plot of the discharge time series</h2><span id='topic+plotQTimeDaily'></span>

<h3>Description</h3>

<p>Part of flowHistory component.
Allows discharge record to only show those discharges above a given threshold
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotQTimeDaily(eList, yearStart = NA, yearEnd = NA, qLower = NA,
  qUnit = 1, logScale = FALSE, tinyPlot = FALSE, printTitle = TRUE,
  usgsStyle = FALSE, lwd = 3, col = "red", cex.main = 1.2,
  cex.lab = 1.2, customPar = FALSE, prettyDate = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotQTimeDaily_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_yearstart">yearStart</code></td>
<td>
<p>numeric indicating the starting year for the graph</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_yearend">yearEnd</code></td>
<td>
<p>numeric indicating the ending year for the graph (should be a time in decimal years that is after the last observations to be plotted)</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_qlower">qLower</code></td>
<td>
<p>numeric specifying the lower bound on discharges that are to be plotted, must be in the units specified by qUnit, default is NA (lower bound is zero)</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class. <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.  Default is qUnit=1 (cubic feet per second)</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_logscale">logScale</code></td>
<td>
<p>logical whether or not to use a log scale in the y axis. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be short and wide, default is FALSE.</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE title is not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels.</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_lwd">lwd</code></td>
<td>
<p>line width, a positive number, defaulting to 3</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_col">col</code></td>
<td>
<p>specification for the default plotting color</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_cex.lab">cex.lab</code></td>
<td>
<p>magnification to be used for x and y labels relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_prettydate">prettyDate</code></td>
<td>
<p>logical use 'pretty' limits for date axis if TRUE, or force the yearStart/yearEnd as limits if FALSE</p>
</td></tr>
<tr><td><code id="plotQTimeDaily_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotQTimeDaily(eList)
plotQTimeDaily(eList, yearStart=1990, yearEnd=2000,qLower=1500)
plotQTimeDaily(eList, prettyDate=FALSE)
</code></pre>

<hr>
<h2 id='plotResidPred'>Plot of the residuals from WRTDS versus the estimated values (all in log concentration units)</h2><span id='topic+plotResidPred'></span>

<h3>Description</h3>

<p>This function produces a plot of the residuals from WRTDS, expressed in natural log concentration units
versus the estimated values, also in natural log concentration units.  These estimates are
the log-space estimates prior to bias-correction.  
The function provides an alternative for viewing the standardized residuals, where the each residual is divided by its estimated standard error. 
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotResidPred(eList, stdResid = FALSE, tinyPlot = FALSE,
  printTitle = TRUE, col = "black", lwd = 1, cex = 0.8,
  cex.axis = 1.1, cex.main = 1.1, customPar = FALSE,
  randomCensored = FALSE, concLab = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotResidPred_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_stdresid">stdResid</code></td>
<td>
<p>logical variable, if TRUE it uses the standardized residual, if FALSE it uses the actual, default is FALSE</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small as part of a multipart figure, default is FALSE.</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for x and y labels relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_randomcensored">randomCensored</code></td>
<td>
<p>logical. Show censored residuals as randomized.</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_conclab">concLab</code></td>
<td>
<p>object of concUnit class, or numeric represented the short code, 
or character representing the descriptive name. By default, this argument sets
concentration labels to use either Concentration or Conc (for tiny plots). Units
are taken from the eList$INFO$param.units. To use any other words than
&quot;Concentration&quot; see <code>vignette(topic = "units", package = "EGRET")</code>.</p>
</td></tr>
<tr><td><code id="plotResidPred_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotResidPred(eList)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
plotResidPred(eList)
</code></pre>

<hr>
<h2 id='plotResidQ'>Plot of the residuals from WRTDS (in log concentration units) versus the discharge</h2><span id='topic+plotResidQ'></span>

<h3>Description</h3>

<p>This function produces a plot of the residuals from WRTDS, expressed in natural log concentration units
versus the discharge shown on a log scale. 
The function also provides an alternative for viewing the standardized residuals, where the each residual is divided by its estimated standard error
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotResidQ(eList, qUnit = 2, tinyPlot = FALSE, stdResid = FALSE,
  printTitle = TRUE, col = "black", lwd = 1, cex = 0.8,
  cex.axis = 1.1, cex.main = 1.1, rmSciX = FALSE, customPar = FALSE,
  randomCensored = FALSE, usgsStyle = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotResidQ_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small as part of a multipart figure, default is FALSE.</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_stdresid">stdResid</code></td>
<td>
<p>logical variable, if TRUE it uses the standardized residual, if FALSE it uses the actual, default is FALSE</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_rmscix">rmSciX</code></td>
<td>
<p>logical defaults to FALSE, changes x label from scientific to fixed</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_randomcensored">randomCensored</code></td>
<td>
<p>logical. Show censored residuals as randomized.</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS complience. It will only change automatically
generated labels.</p>
</td></tr>
<tr><td><code id="plotResidQ_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotResidQ(eList)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
plotResidQ(eList)
</code></pre>

<hr>
<h2 id='plotResidTime'>Plot of the residuals from WRTDS (in log concentration units) versus time</h2><span id='topic+plotResidTime'></span>

<h3>Description</h3>

<p>This function produces a plot of the residuals from WRTDS, expressed in natural log concentration units
versus time.
It also provides an alternative for viewing the standardized residuals, where the each residual is divided by its estimated standard error.
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default. 
</p>
<p>Data come from named list, which contains a Sample dataframe with the sample data, 
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotResidTime(eList, stdResid = FALSE, printTitle = TRUE, hLine = TRUE,
  tinyPlot = FALSE, col = "black", lwd = 1, cex = 0.8,
  cex.axis = 1.1, cex.main = 1.1, customPar = FALSE,
  randomCensored = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotResidTime_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Sample and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_stdresid">stdResid</code></td>
<td>
<p>logical variable, if TRUE it uses the standardized residual, if FALSE it uses the actual, default is FALSE</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE not printed (this is best for a multi-plot figure)</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_hline">hLine</code></td>
<td>
<p>inserts horizontal line at zero</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable, if TRUE plot is designed to be plotted small, as a part of a multipart figure, default is FALSE</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_col">col</code></td>
<td>
<p>color of points on plot, see ?par 'Color Specification'</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_lwd">lwd</code></td>
<td>
<p>number line width</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_randomcensored">randomCensored</code></td>
<td>
<p>logical. Show censored residuals as randomized.</p>
</td></tr>
<tr><td><code id="plotResidTime_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water year:
plotResidTime(eList)
# Graphs consisting of Jun-Aug
eList &lt;- setPA(eList, paStart=6,paLong=3)
plotResidTime(eList)
</code></pre>

<hr>
<h2 id='plotSDLogQ'>Graph of the standard deviation of the log of daily discharge versus year</h2><span id='topic+plotSDLogQ'></span>

<h3>Description</h3>

<p>Graph of the standard deviation of the log of daily discharge versus year
</p>
<p>Although there are a lot of optional arguments to this function, most are set to a logical default.
</p>
<p>Data come from named list, which contains a Daily dataframe with the daily flow data,
and an INFO dataframe with metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSDLogQ(eList, yearStart = NA, yearEnd = NA, window = 15,
  sdMax = NA, printTitle = TRUE, tinyPlot = FALSE, printStaName = TRUE,
  printPA = TRUE, cex = 0.8, cex.main = 1.1, cex.axis = 1.1, lwd = 2,
  customPar = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSDLogQ_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_yearstart">yearStart</code></td>
<td>
<p>numeric is the calendar year of the first value to be included in graph, default is NA, which plots from the start of the period of record</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_yearend">yearEnd</code></td>
<td>
<p>numeric is the calendar year of the last value to be included in graph, default is NA, which plots to the end of the period of record</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_window">window</code></td>
<td>
<p>numeric which is the full width, in years, of the time window over which the standard deviation is computed, default = 15</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_sdmax">sdMax</code></td>
<td>
<p>numeric is the maximum value to be used on the vertical axis of the graph, default is NA (which allows it to be set automatically by the data)</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_printtitle">printTitle</code></td>
<td>
<p>logical variable if TRUE title is printed, if FALSE title is not printed (this is best for a multi-plot figure), default is TRUE</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_tinyplot">tinyPlot</code></td>
<td>
<p>logical variable if TRUE plot is designed to be small, if FALSE it is designed for page size, default is FALSE (not fully implemented yet)</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_printstaname">printStaName</code></td>
<td>
<p>logical variable, if TRUE print the station name, if FALSE do not, default is TRUE</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_printpa">printPA</code></td>
<td>
<p>logical variable, if TRUE print the period of analysis information in the plot title, if FALSE leave it out, default is TRUE</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_cex">cex</code></td>
<td>
<p>numerical value giving the amount by which plotting symbols should be magnified</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_cex.main">cex.main</code></td>
<td>
<p>magnification to be used for main titles relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_cex.axis">cex.axis</code></td>
<td>
<p>magnification to be used for axis annotation relative to the current setting of cex</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_lwd">lwd</code></td>
<td>
<p>line width, a positive number, defaulting to 2</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_custompar">customPar</code></td>
<td>
<p>logical defaults to FALSE. If TRUE, par() should be set by user before calling this function 
(for example, adjusting margins with par(mar=c(5,5,5,5))). If customPar FALSE, EGRET chooses the best margins depending on tinyPlot.</p>
</td></tr>
<tr><td><code id="plotSDLogQ_+3A_...">...</code></td>
<td>
<p>arbitrary graphical parameters that will be passed to genericEGRETDotPlot function (see ?par for options)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+selectDays">selectDays</a></code>, <code><a href="#topic+genericEGRETDotPlot">genericEGRETDotPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList

# Water year:
plotSDLogQ(eList) 
plotSDLogQ(eList, 1998, 2000) 

</code></pre>

<hr>
<h2 id='plotTimeSlice'>plotTimeSlice</h2><span id='topic+plotTimeSlice'></span>

<h3>Description</h3>

<p>Plot of either concentration or flux over time showing both the WRTDS and WRTDSKalman estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotTimeSlice(eList, start = NA, end = NA, conc = TRUE, fluxUnit = 3,
  usgsStyle = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotTimeSlice_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. This
eList must be run through <code>WRTDSKalman</code>.</p>
</td></tr>
<tr><td><code id="plotTimeSlice_+3A_start">start</code></td>
<td>
<p>numeric start of DecYear for plot. If <code>NA</code>, plot will start at the earliest date in the record.</p>
</td></tr>
<tr><td><code id="plotTimeSlice_+3A_end">end</code></td>
<td>
<p>numeric end of DecYear for plot. If <code>NA</code>, plot will end at the latest date in the record.</p>
</td></tr>
<tr><td><code id="plotTimeSlice_+3A_conc">conc</code></td>
<td>
<p>logical. If <code>TRUE</code>, plot concentration, otherwise plot flux.</p>
</td></tr>
<tr><td><code id="plotTimeSlice_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>number representing entry in pre-defined fluxUnit class array. <code><a href="#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code></p>
</td></tr>
<tr><td><code id="plotTimeSlice_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the plot title, Ratio of means is mean of WRTDSKalman estimates to the WRTDS Classic estimates.  Ratio only calculated on the data shown in the figure, not the whole series.
In the plot, red dots are measured values, blue dots are plotted at the reporting limit for those values that are censored.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
eList &lt;- WRTDSKalman(eList, niter = 10)

plotTimeSlice(eList, start = 1990, end = 1991, conc = TRUE)

plotTimeSlice(eList, start = 1990, end = 1991, conc = FALSE)

plotTimeSlice(eList, start = NA, end = 1991, conc = FALSE)

</code></pre>

<hr>
<h2 id='plotWRTDSKalman'>plotWRTDSKalman</h2><span id='topic+plotWRTDSKalman'></span>

<h3>Description</h3>

<p>Two plots to check the flux estimates using the WRTDS_K vs classic WRTDS.
The first is annual flux over time, where the two fluxes are shown in different colors.
The second is WRTDS vs WRTDSKalman flux estimates. The graphs can be output
either on top of each other, or side by side using the <code>sideBySide</code> argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotWRTDSKalman(eList, sideBySide = FALSE, fluxUnit = 9,
  usgsStyle = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotWRTDSKalman_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes. This
eList must be run through <code>WRTDSKalman</code>.</p>
</td></tr>
<tr><td><code id="plotWRTDSKalman_+3A_sidebyside">sideBySide</code></td>
<td>
<p>logical. If <code>TRUE</code>, the two plots will be plotted
side by side, otherwise, one by one vertically.</p>
</td></tr>
<tr><td><code id="plotWRTDSKalman_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>number representing entry in pre-defined fluxUnit class array. <code><a href="#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code></p>
</td></tr>
<tr><td><code id="plotWRTDSKalman_+3A_usgsstyle">usgsStyle</code></td>
<td>
<p>logical option to use USGS style guidelines. Setting this option
to TRUE does NOT guarantee USGS compliance. It will only change automatically
generated labels</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
eList &lt;- Choptank_eList
eList &lt;- WRTDSKalman(eList, niter = 10)
plotWRTDSKalman(eList)

plotWRTDSKalman(eList, sideBySide = TRUE)

</code></pre>

<hr>
<h2 id='populateConcentrations'>Populate Concentration Columns</h2><span id='topic+populateConcentrations'></span>

<h3>Description</h3>

<p>Creates ConcLow, ConcHigh, Uncen (0 if censored, 1 if uncensored) columns 
for Sample data frame for WRTDS analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>populateConcentrations(rawData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="populateConcentrations_+3A_rawdata">rawData</code></td>
<td>
<p>vector with value and code columns</p>
</td></tr>
</table>


<h3>Value</h3>

<p>concentrationColumns dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>code &lt;- c("","&lt;","")
value &lt;- c(1,2,3)
dataInput &lt;- data.frame(value, code, stringsAsFactors=FALSE)
concentrationDF &lt;- populateConcentrations(dataInput)
</code></pre>

<hr>
<h2 id='populateDaily'>Populate Daily data frame</h2><span id='topic+populateDaily'></span>

<h3>Description</h3>

<p>Using raw data that has at least dateTime, value, code, populates the rest of the basic Daily data frame used in EGRET analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>populateDaily(rawData, qConvert, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="populateDaily_+3A_rawdata">rawData</code></td>
<td>
<p>dataframe contains at least dateTime, value, code columns</p>
</td></tr>
<tr><td><code id="populateDaily_+3A_qconvert">qConvert</code></td>
<td>
<p>character conversion to cubic meters per second</p>
</td></tr>
<tr><td><code id="populateDaily_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame 'Daily' with the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
Q </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Discharge in m^3/s</td>
</tr>
<tr>
 <td style="text-align: left;">
Julian </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of days since Jan. 1, 1850</td>
</tr>
<tr>
 <td style="text-align: left;">
Month </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Month of the year [1-12] </td>
</tr>
<tr>
 <td style="text-align: left;"> 
Day </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Day of the year [1-366] </td>
</tr>
<tr>
 <td style="text-align: left;">
DecYear </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Decimal year </td>
</tr>
<tr>
 <td style="text-align: left;">
MonthSeq </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of months since January 1, 1850 </td>
</tr>
<tr>
 <td style="text-align: left;">
Qualifier </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Qualifying code </td>
</tr>
<tr>
 <td style="text-align: left;">
i </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Index of days, starting with 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
LogQ </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Natural logarithm of Q  </td>
</tr>
<tr>
 <td style="text-align: left;">
Q7 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 7 day running average of Q </td>
</tr>
<tr>
 <td style="text-align: left;">
Q30 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 30 day running average of Q </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Robert M. Hirsch <a href="mailto:rhirsch@usgs.gov">rhirsch@usgs.gov</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readNWISDaily">readNWISDaily</a></code>, <code><a href="#topic+readUserDaily">readUserDaily</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dateTime &lt;- as.character(seq(as.Date("2001/1/1"), 
         as.Date("2001/12/31"), by = "day"))
value &lt;- 1:365
code &lt;- rep("",365)
dataInput &lt;- data.frame(dateTime, value, code, stringsAsFactors=FALSE)
Daily &lt;- populateDaily(dataInput, 2)
</code></pre>

<hr>
<h2 id='populateDailySamp'>Merge concentration to Daily</h2><span id='topic+populateDailySamp'></span>

<h3>Description</h3>

<p>Used for the WRTDS Kalman set of functions, this function
merges the ConcAve into the Daily data frame, renaming
it &quot;trueConc&quot;, then calculates the &quot;trueFlux&quot;, and &quot;stdResid&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>populateDailySamp(eList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="populateDailySamp_+3A_elist">eList</code></td>
<td>
<p>named list with the INFO, Daily, and Sample dataframes
and surfaces matrix</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Daily2 &lt;- populateDailySamp(eList)

</code></pre>

<hr>
<h2 id='populateDateColumns'>Populate Date Columns</h2><span id='topic+populateDateColumns'></span>

<h3>Description</h3>

<p>Creates various date columns for WRTDS study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>populateDateColumns(rawData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="populateDateColumns_+3A_rawdata">rawData</code></td>
<td>
<p>vector with dateTime</p>
</td></tr>
</table>


<h3>Value</h3>

<p>DateFrame dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dateTime &lt;- c('1984-02-28 13:56',
              '1984-03-01 00:00',
              '1986-03-01 00:00',
              '1986-10-15 00:00')
              
expandedDateDF &lt;- populateDateColumns(dateTime)
expandedDateDF

dateTime &lt;- c('1984-02-28', 
              '1984-03-01',
              '1986-03-01',
              '1986-10-15')
expandedDateDF &lt;- populateDateColumns(dateTime)
expandedDateDF
</code></pre>

<hr>
<h2 id='populateParameterINFO'>Populate Parameter Information Columns</h2><span id='topic+populateParameterINFO'></span>

<h3>Description</h3>

<p>Populates INFO data frame with additional user-supplied information concerning the measured parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>populateParameterINFO(parameterCd, INFO, interactive = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="populateParameterINFO_+3A_parametercd">parameterCd</code></td>
<td>
<p>character USGS parameter code</p>
</td></tr>
<tr><td><code id="populateParameterINFO_+3A_info">INFO</code></td>
<td>
<p>dataframe with value and code columns. Default is INFO</p>
</td></tr>
<tr><td><code id="populateParameterINFO_+3A_interactive">interactive</code></td>
<td>
<p>logical Option for interactive mode.  If TRUE, there is user interaction for error handling 
and data checks. Default is TRUE. If running in batch, should be set to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>INFO dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dataRetrieval)
INFO &lt;- readNWISsite('01594440')
parameterCd &lt;- "01075"
parameterData &lt;- readNWISpCode(parameterCd)
INFO$param.nm &lt;- parameterData$parameter_nm
INFO$param.units &lt;- parameterData$parameter_units
INFO$paramShortName &lt;- parameterData$srsname
INFO$paramNumber &lt;- parameterData$parameter_cd

INFO &lt;- populateParameterINFO(parameterCd, INFO, interactive = FALSE)

</code></pre>

<hr>
<h2 id='populateSampleColumns'>Populate Sample Columns</h2><span id='topic+populateSampleColumns'></span>

<h3>Description</h3>

<p>Creates ConcAve and ConcLow based on Uncen. Removes any samples with NA values in ConcHigh.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>populateSampleColumns(rawData)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="populateSampleColumns_+3A_rawdata">rawData</code></td>
<td>
<p>dataframe with dateTime, ConcLow, ConcHigh, Uncen</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Sample2 dataframe with columns: Date, ConcLow, ConcHigh, Uncen, ConcAve, Julian, 
Month, Day, DecYear, MonthSeq, waterYear, SinDY, and CosDY (DY = decimal year)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dateTime &lt;- c('1985-01-01', '1985-01-02', '1985-01-03')
ConcLow &lt;- c(1,2,0)
ConcHigh &lt;- c(1,2,3)
Uncen &lt;- c(1,1,0)
dataInput &lt;- data.frame(dateTime, ConcLow, ConcHigh, Uncen, stringsAsFactors=FALSE)
Sample &lt;- populateSampleColumns(dataInput)
</code></pre>

<hr>
<h2 id='populateSiteINFO'>Populate Site Information Columns</h2><span id='topic+populateSiteINFO'></span>

<h3>Description</h3>

<p>Populates INFO data frame with additional user-supplied information. Also removes fields not related to WRTDS study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>populateSiteINFO(INFO, siteNumber, interactive = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="populateSiteINFO_+3A_info">INFO</code></td>
<td>
<p>dataframe with value and code columns</p>
</td></tr>
<tr><td><code id="populateSiteINFO_+3A_sitenumber">siteNumber</code></td>
<td>
<p>character USGS site number</p>
</td></tr>
<tr><td><code id="populateSiteINFO_+3A_interactive">interactive</code></td>
<td>
<p>logical Option for interactive mode.  If TRUE, there is user interaction for error handling 
and data checks. Default is TRUE. If running in batch, should be set to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>INFO dataframe
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dataRetrieval)
INFO &lt;- readNWISsite('01594440')
siteNumber &lt;- "01594440"
siteINFO &lt;- populateSiteINFO(INFO, siteNumber, interactive = FALSE)

</code></pre>

<hr>
<h2 id='print.egret'>EGRET helper functions</h2><span id='topic+print.egret'></span><span id='topic+plot.egret'></span><span id='topic+nDischarge'></span><span id='topic+nObservations'></span><span id='topic+nCensoredVals'></span>

<h3>Description</h3>

<p>A small collection of helper functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'egret'
print(x, ...)

## S3 method for class 'egret'
plot(x, ...)

nDischarge(x)

nObservations(x)

nCensoredVals(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.egret_+3A_x">x</code></td>
<td>
<p>EGRET object</p>
</td></tr>
<tr><td><code id="print.egret_+3A_...">...</code></td>
<td>
<p>additional parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+multiPlotDataOverview">multiPlotDataOverview</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Choptank_eList
print(Arkansas_eList)
plot(Choptank_eList)
plot(Choptank_eList, cex.main=0.7)
nDischarge(Arkansas_eList)
nObservations(Arkansas_eList)
nCensoredVals(Arkansas_eList)
</code></pre>

<hr>
<h2 id='printFluxUnitCheatSheet'>Reminder to user of flux unit properties  (such as kg/day, tons/year, etc).</h2><span id='topic+printFluxUnitCheatSheet'></span>

<h3>Description</h3>

<p>Cheat sheet to print out pre-defined flux unit properties from fluxUnit class
Flux units included:
</p>

<table>
<tr>
 <td style="text-align: left;">
Number </td><td style="text-align: left;"> ObjectName </td><td style="text-align: left;"> shortName </td><td style="text-align: left;"> unitFactor </td><td style="text-align: left;"> unitName  </td>
</tr>
<tr>
 <td style="text-align: left;">
1      </td><td style="text-align: left;"> POUNDS_DAY </td><td style="text-align: left;"> lbs/day   </td><td style="text-align: left;"> 2.204623   </td><td style="text-align: left;"> pounds/day</td>
</tr>
<tr>
 <td style="text-align: left;">
2      </td><td style="text-align: left;"> TONS_DAY   </td><td style="text-align: left;"> tons/day  </td><td style="text-align: left;"> 0.001102  </td><td style="text-align: left;"> tons/day   </td>
</tr>
<tr>
 <td style="text-align: left;">
3      </td><td style="text-align: left;"> KG_DAY     </td><td style="text-align: left;"> kg/day    </td><td style="text-align: left;"> 1          </td><td style="text-align: left;"> kg/day    </td>
</tr>
<tr>
 <td style="text-align: left;">
4      </td><td style="text-align: left;"> THOUSAND_KG_DAY</td><td style="text-align: left;"> 10^3 kg/day </td><td style="text-align: left;"> 0.001 </td><td style="text-align: left;"> thousands of kg/day</td>
</tr>
<tr>
 <td style="text-align: left;">
5      </td><td style="text-align: left;"> TONS_YEAR</td><td style="text-align: left;"> tons/yr </td><td style="text-align: left;"> 0.402619 </td><td style="text-align: left;"> tons/year</td>
</tr>
<tr>
 <td style="text-align: left;">
6      </td><td style="text-align: left;"> THOUSAND_TONS_YEAR</td><td style="text-align: left;"> 10^3 tons/yr </td><td style="text-align: left;"> 0.000402619 </td><td style="text-align: left;"> thousands of tons/year </td>
</tr>
<tr>
 <td style="text-align: left;">
7      </td><td style="text-align: left;"> MILLION_TONS_YEAR</td><td style="text-align: left;"> 10^6 tons/yr </td><td style="text-align: left;"> 4.02619e-07 </td><td style="text-align: left;"> millions of tons/year</td>
</tr>
<tr>
 <td style="text-align: left;">
8      </td><td style="text-align: left;"> THOUSAND_KG_YEAR</td><td style="text-align: left;"> 10^3 kg/yr </td><td style="text-align: left;"> 0.36525 </td><td style="text-align: left;"> thousands of kg/year</td>
</tr>
<tr>
 <td style="text-align: left;">
9      </td><td style="text-align: left;"> MILLION_KG_YEAR</td><td style="text-align: left;"> 10^6 kg/yr </td><td style="text-align: left;"> 0.00036525 </td><td style="text-align: left;"> millions of kg/year</td>
</tr>
<tr>
 <td style="text-align: left;">
10     </td><td style="text-align: left;"> BILLION_KG_YEAR</td><td style="text-align: left;"> 10^9 kg/yr </td><td style="text-align: left;"> 3.6525e-07 </td><td style="text-align: left;"> billions of kg/year </td>
</tr>
<tr>
 <td style="text-align: left;">
11     </td><td style="text-align: left;"> thousandTonsDay </td><td style="text-align: left;"> 10^3 tons/day </td><td style="text-align: left;"> 1.102e-06 </td><td style="text-align: left;"> thousands of tons/day </td>
</tr>
<tr>
 <td style="text-align: left;">
12     </td><td style="text-align: left;"> millionKgDay </td><td style="text-align: left;"> 10^6 kg/day </td><td style="text-align: left;"> 1e-06 </td><td style="text-align: left;"> millions of kg/day </td>
</tr>
<tr>
 <td style="text-align: left;">
13     </td><td style="text-align: left;"> kgYear </td><td style="text-align: left;"> kg/year </td><td style="text-align: left;"> 365.25 </td><td style="text-align: left;"> kg/year </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>printFluxUnitCheatSheet()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>printFluxUnitCheatSheet()
</code></pre>

<hr>
<h2 id='printGroups'>Print information about group analysis</h2><span id='topic+printGroups'></span>

<h3>Description</h3>

<p>Prints the information from the <code>runGroups</code> function.
This could be used to save the output to a text file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printGroups(eList, groupResults)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printGroups_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="printGroups_+3A_groupresults">groupResults</code></td>
<td>
<p>output of <code>runGroups</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>text to console
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList


groupOut_1 &lt;- runGroups(eList,  windowSide = 0,
                        group1firstYear = 1980, group1lastYear = 1990,
                        group2firstYear = 1995, group2lastYear = 2005)
                       
printGroups(eList, groupOut_1)


</code></pre>

<hr>
<h2 id='printPairs'>Print information about pairs analysis</h2><span id='topic+printPairs'></span>

<h3>Description</h3>

<p>Prints the information from the <code>runPairs</code> function.
This could be used to save the output to a text file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printPairs(eList, pairResults)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printPairs_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="printPairs_+3A_pairresults">pairResults</code></td>
<td>
<p>output of <code>runGroups</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>text to console
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
year1 &lt;- 1985
year2 &lt;- 2010


pairOut_1 &lt;- runPairs(eList, 
                      year1, year2,
                      windowSide = 0)
                       
printPairs(eList, pairOut_1)


</code></pre>

<hr>
<h2 id='printqUnitCheatSheet'>Reminder to user of flow Unit properties such as cubic meters per second or thousands of cubic feet per second.</h2><span id='topic+printqUnitCheatSheet'></span>

<h3>Description</h3>

<p>Cheat sheet to print out pre-defined qUnit properties from qUnit class.
Flow units included:
</p>

<table>
<tr>
 <td style="text-align: left;">
Number </td><td style="text-align: left;"> ObjectName </td><td style="text-align: left;"> shortName </td><td style="text-align: left;"> unitFactor </td>
</tr>
<tr>
 <td style="text-align: left;">
1      </td><td style="text-align: left;"> cfs      </td><td style="text-align: left;"> Cubic Feet per Second   </td><td style="text-align: left;"> 35.31467 </td>
</tr>
<tr>
 <td style="text-align: left;">
2      </td><td style="text-align: left;"> cms      </td><td style="text-align: left;"> Cubic Meters per Second  </td><td style="text-align: left;"> 1  </td>
</tr>
<tr>
 <td style="text-align: left;">
3      </td><td style="text-align: left;"> thousandCfs </td><td style="text-align: left;"> Thousand Cubic Feet per Second   </td><td style="text-align: left;">  0.03531467 </td>
</tr>
<tr>
 <td style="text-align: left;">
4      </td><td style="text-align: left;"> thousandCms </td><td style="text-align: left;"> Thousand Cubic Meters per Second </td><td style="text-align: left;"> 0.001 </td>
</tr>
<tr>
 <td style="text-align: left;">
5      </td><td style="text-align: left;"> mmDay </td><td style="text-align: left;"> mm per day </td><td style="text-align: left;">   </td>
</tr>
<tr>
 <td style="text-align: left;">
6      </td><td style="text-align: left;"> mmYear </td><td style="text-align: left;"> mm per year </td><td style="text-align: left;">   </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>printqUnitCheatSheet()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>printqUnitCheatSheet()
</code></pre>

<hr>
<h2 id='printSeries'>Print annual results for a given streamflow statistic</h2><span id='topic+printSeries'></span>

<h3>Description</h3>

<p>Part of the flowHistory system.  
The index of the flow statistics is istat.  These statistics are: 
(1) 1-day minimum, (2) 7-day minimum, (3) 30-day minimum, (4) median
(5) mean, (6) 30-day maximum, (7) 7-day maximum, and (8) 1-day maximum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>printSeries(eList, istat, qUnit = 1, runoff = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="printSeries_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="printSeries_+3A_istat">istat</code></td>
<td>
<p>A numeric value for the flow statistic to be graphed (possible values are 1 through 8)</p>
</td></tr>
<tr><td><code id="printSeries_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented 
the short code, or character representing the descriptive name.
Default is 1, which is cubic feet per second.</p>
</td></tr>
<tr><td><code id="printSeries_+3A_runoff">runoff</code></td>
<td>
<p>logical variable, if TRUE the streamflow data are converted to runoff values in mm/day</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The smoothing algorithm is as defined in <code><a href="#topic+makeAnnualSeries">makeAnnualSeries</a></code>.  
smoothing window is defined by the eList$INFO$window value (default = 20)
</p>


<h3>Value</h3>

<p>data frame with:
</p>

<table>
<tr>
 <td style="text-align: left;">
years </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> year  </td>
</tr>
<tr>
 <td style="text-align: left;">
qActual </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Actual flow statistic (based on istat)  </td>
</tr>
<tr>
 <td style="text-align: left;">
qSmooth </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Smoothed flow statistic </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
printReturn &lt;- printSeries(eList, 5)
</code></pre>

<hr>
<h2 id='processQWData'>Processing of Water Quality Data</h2><span id='topic+processQWData'></span>

<h3>Description</h3>

<p>Processes water quality data. This function looks at detection limit and detection 
conditions to determine if a value is left censored or not. Censored values are given the qualifier
&quot;&lt;&quot;.  The dataframe is also converted from a long to wide format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>processQWData(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="processQWData_+3A_data">data</code></td>
<td>
<p>dataframe from Water Quality Portal</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data dataframe with first column dateTime, and at least one qualifier and value columns
(subsequent qualifier/value columns could follow depending on the number of parameter codes)
</p>


<h3>See Also</h3>

<p><code><a href="dataRetrieval.html#topic+readWQPqw">readWQPqw</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#library(dataRetrieval)
 
#rawWQP &lt;- readWQPqw('21FLEECO_WQX-IMPRGR80','Phosphorus', '', '')
#Sample2 &lt;- processQWData(rawWQP)

</code></pre>

<hr>
<h2 id='qUnit-class'>qUnit class</h2><span id='topic+qUnit-class'></span>

<h3>Description</h3>

<p>Some details about the qUnit class
</p>


<h3>Details</h3>


<dl>
<dt>qshortName</dt><dd><p>A character specifying the short name.</p>
</dd>
<dt>qUnitFactor</dt><dd><p>A numeric representing the conversion factor</p>
</dd>
<dt>qUnitName</dt><dd><p>A character specifying the full name.</p>
</dd>
<dt>qUnitExpress</dt><dd><p>An expression specifying the full name.</p>
</dd>
<dt>unitUSGS</dt><dd><p>A character specifying flux with full text.</p>
</dd>
<dt>qUnitTiny</dt><dd><p>An expression specifying the abbreviated name.</p>
</dd>
<dt>shortCode</dt><dd><p>A number for quick lookup</p>
</dd>
<dt>prefix</dt><dd><p>A character specifying the general type of measurement.</p>
</dd>
</dl>


<hr>
<h2 id='randomSubset'>randomSubset</h2><span id='topic+randomSubset'></span>

<h3>Description</h3>

<p>Calculates a random subset of the data based on repeated values from
a specified column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomSubset(df, colName, seed = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randomSubset_+3A_df">df</code></td>
<td>
<p>data frame. Must include a column named by the argument colName.</p>
</td></tr>
<tr><td><code id="randomSubset_+3A_colname">colName</code></td>
<td>
<p>column name to check for duplicates</p>
</td></tr>
<tr><td><code id="randomSubset_+3A_seed">seed</code></td>
<td>
<p>integer value. Defaults to NA, which will not change the current seed.
Setting the seed to any given value can be used to create repeatable output.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(Julian = c(1,2,2,3,4,4,4,6),
                 y = 1:8)
df
df_random &lt;- randomSubset(df, "Julian")
df_random
</code></pre>

<hr>
<h2 id='readDataFromFile'>Basic Data Import for Water Flow Data</h2><span id='topic+readDataFromFile'></span>

<h3>Description</h3>

<p>Imports data from user-supplied data file. Specifically used to import water flow data for use in the EGRET package.
For EGRET usage, the first column is expected to be dates. If the data is daily data, then next column is 
expected to be the measured values. If the data is sampled data, the next column is remark codes, and the third
column is values. If the date format is not automatically
detected, the format can be specified using the &quot;format&quot; argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readDataFromFile(filePath, fileName, hasHeader = TRUE, separator = ",",
  format = "%m/%d/%Y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readDataFromFile_+3A_filepath">filePath</code></td>
<td>
<p>character specifying the path to the file. If it 
is in the working directory, use &quot;.&quot;.</p>
</td></tr>
<tr><td><code id="readDataFromFile_+3A_filename">fileName</code></td>
<td>
<p>character name of file to open.</p>
</td></tr>
<tr><td><code id="readDataFromFile_+3A_hasheader">hasHeader</code></td>
<td>
<p>logical true if the first row of data is the column headers</p>
</td></tr>
<tr><td><code id="readDataFromFile_+3A_separator">separator</code></td>
<td>
<p>character character that separates data cells. The default
is &quot;,&quot; for a csv file. Tab delimited would be &quot;\t&quot;.</p>
</td></tr>
<tr><td><code id="readDataFromFile_+3A_format">format</code></td>
<td>
<p>character indicating the format of the date (which should
be in the first column). Default is &quot;%m\/%d/%Y&quot;. See <code>?strptime</code>
for options. The code will initially look for R's standard YYYY-MM-DD, and
check this format as a backup.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>retval dataframe with dateTime, value, and code columns
</p>


<h3>Examples</h3>

<pre><code class='language-R'>filePath &lt;- system.file("extdata", package="EGRET")
fileName &lt;- 'ChoptankRiverFlow.txt'
ChopData &lt;- readDataFromFile(filePath,fileName, separator="\t")
</code></pre>

<hr>
<h2 id='readNWISDaily'>Import NWIS Daily Data for EGRET analysis</h2><span id='topic+readNWISDaily'></span>

<h3>Description</h3>

<p>Imports daily data from NWIS web service. This function gets the data from here: <a href="https://waterservices.usgs.gov/">https://waterservices.usgs.gov/</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readNWISDaily(siteNumber, parameterCd = "00060", startDate = "",
  endDate = "", verbose = TRUE, convert = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readNWISDaily_+3A_sitenumber">siteNumber</code></td>
<td>
<p>character USGS site number.  This is usually an 8 digit number</p>
</td></tr>
<tr><td><code id="readNWISDaily_+3A_parametercd">parameterCd</code></td>
<td>
<p>character USGS parameter code.  This is usually an 5 digit number.</p>
</td></tr>
<tr><td><code id="readNWISDaily_+3A_startdate">startDate</code></td>
<td>
<p>character starting date for data retrieval in the form YYYY-MM-DD.</p>
</td></tr>
<tr><td><code id="readNWISDaily_+3A_enddate">endDate</code></td>
<td>
<p>character ending date for data retrieval in the form YYYY-MM-DD.</p>
</td></tr>
<tr><td><code id="readNWISDaily_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
<tr><td><code id="readNWISDaily_+3A_convert">convert</code></td>
<td>
<p>logical Option to include a conversion from cfs to cms (35.314667). The default is TRUE, 
which is appropriate for using NWIS data in the EGRET package.  Set this to FALSE to not include the conversion. If the parameter code is not 00060 (NWIS discharge),
there is no conversion applied.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame 'Daily' with the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
Date </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date </td>
</tr>
<tr>
 <td style="text-align: left;">
Q </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Discharge in m^3/s</td>
</tr>
<tr>
 <td style="text-align: left;">
Julian </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of days since Jan. 1, 1850</td>
</tr>
<tr>
 <td style="text-align: left;">
Month </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Month of the year [1-12] </td>
</tr>
<tr>
 <td style="text-align: left;"> 
Day </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Day of the year [1-366] </td>
</tr>
<tr>
 <td style="text-align: left;">
DecYear </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Decimal year </td>
</tr>
<tr>
 <td style="text-align: left;">
MonthSeq </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of months since January 1, 1850 </td>
</tr>
<tr>
 <td style="text-align: left;">
Qualifier </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Qualifying code </td>
</tr>
<tr>
 <td style="text-align: left;">
i </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Index of days, starting with 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
LogQ </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Natural logarithm of Q  </td>
</tr>
<tr>
 <td style="text-align: left;">
Q7 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 7 day running average of Q </td>
</tr>
<tr>
 <td style="text-align: left;">
Q30 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 30 day running average of Q </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="dataRetrieval.html#topic+readNWISdv">readNWISdv</a></code>, <code><a href="#topic+populateDaily">populateDaily</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

Daily &lt;- readNWISDaily('01594440','00060',
                       '1985-01-01', '1985-03-31')
DailySuspSediment &lt;- readNWISDaily('01594440','80154',
                                   '1985-01-01', '1985-03-31',
                                   convert = FALSE)

</code></pre>

<hr>
<h2 id='readNWISSample'>Import NWIS Sample Data for EGRET analysis</h2><span id='topic+readNWISSample'></span>

<h3>Description</h3>

<p>Imports data from NWIS web service. 
A list of parameter and statistic codes can be found here: <a href="https://help.waterdata.usgs.gov/codes-and-parameters">https://help.waterdata.usgs.gov/codes-and-parameters</a>
For raw data, use <code><a href="dataRetrieval.html#topic+readNWISqw">readNWISqw</a></code> from the dataRetrieval package.
This function will retrieve the raw data, and compress it (summing constituents) if 
more than 1 parameter code is supplied. See
section 3.2.4 of the vignette for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readNWISSample(siteNumber, parameterCd, startDate = "", endDate = "",
  verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readNWISSample_+3A_sitenumber">siteNumber</code></td>
<td>
<p>character USGS site number.  This is usually an 8 digit number</p>
</td></tr>
<tr><td><code id="readNWISSample_+3A_parametercd">parameterCd</code></td>
<td>
<p>character USGS parameter code.  This is usually an 5 digit number.</p>
</td></tr>
<tr><td><code id="readNWISSample_+3A_startdate">startDate</code></td>
<td>
<p>character starting date for data retrieval in the form YYYY-MM-DD.
Default is empty quotes &quot;&quot; which will retrieve the full period of record.</p>
</td></tr>
<tr><td><code id="readNWISSample_+3A_enddate">endDate</code></td>
<td>
<p>character ending date for data retrieval in the form YYYY-MM-DD.
Default is empty quotes &quot;&quot; which will retrieve the full period of record.</p>
</td></tr>
<tr><td><code id="readNWISSample_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame 'Sample' with the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
Date </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcLow </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Lower limit of concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcHigh </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Upper limit of concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
Uncen </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Uncensored data (1=TRUE, 0=FALSE) </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcAve </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Average concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
Julian </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of days since Jan. 1, 1850</td>
</tr>
<tr>
 <td style="text-align: left;">
Month </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Month of the year [1-12] </td>
</tr>
<tr>
 <td style="text-align: left;"> 
Day </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Day of the year [1-366] </td>
</tr>
<tr>
 <td style="text-align: left;">
DecYear </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Decimal year </td>
</tr>
<tr>
 <td style="text-align: left;">
MonthSeq </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of months since January 1, 1850 </td>
</tr>
<tr>
 <td style="text-align: left;">
SinDY </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Sine of the DecYear </td>
</tr>
<tr>
 <td style="text-align: left;">
CosDY </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Cosine of the DecYear
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+compressData">compressData</a></code>, <code><a href="#topic+populateSampleColumns">populateSampleColumns</a></code>,
<code><a href="dataRetrieval.html#topic+readNWISqw">readNWISqw</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# These examples require an internet connection to run

Sample_01075 &lt;- readNWISSample('01594440','01075', '1985-01-01', '1985-03-31')

</code></pre>

<hr>
<h2 id='readUserDaily'>Import user daily data for EGRET analysis</h2><span id='topic+readUserDaily'></span>

<h3>Description</h3>

<p>Imports data from a user-supplied file, and converts it to a Daily data frame,
appropriate for WRTDS calculations. The file can use most any separators
as a delimiter. The default is comma separated.
</p>
<p>The first column is expected to be dates, the second column is expected
to be discharge values. If the date format is not automatically
detected, the format can be specified using the &quot;format&quot; argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readUserDaily(filePath, fileName, hasHeader = TRUE, separator = ",",
  qUnit = 1, format = "%m/%d/%Y", verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readUserDaily_+3A_filepath">filePath</code></td>
<td>
<p>character specifying the path to the file. If it 
is in the working directory, use &quot;.&quot;.</p>
</td></tr>
<tr><td><code id="readUserDaily_+3A_filename">fileName</code></td>
<td>
<p>character name of file to open</p>
</td></tr>
<tr><td><code id="readUserDaily_+3A_hasheader">hasHeader</code></td>
<td>
<p>logical true if the first row of data is the column headers</p>
</td></tr>
<tr><td><code id="readUserDaily_+3A_separator">separator</code></td>
<td>
<p>character character that separates data cells. The default
is &quot;,&quot; for a csv file. Tab delimited would be &quot;\t&quot;.</p>
</td></tr>
<tr><td><code id="readUserDaily_+3A_qunit">qUnit</code></td>
<td>
<p>number 1 is cubic feet per second, 
2 is cubic meters per second, 
3 is 10^3 cubic feet per second,
and 4 is 10^3 cubic meters per second. The default is 1.</p>
</td></tr>
<tr><td><code id="readUserDaily_+3A_format">format</code></td>
<td>
<p>character indicating the format of the date (which should
be in the first column). Default is &quot;%m\/%d/%Y&quot;. See <code>?strptime</code>
for options. The code will initially look for R's standard YYYY-MM-DD, and
check this format as a backup.</p>
</td></tr>
<tr><td><code id="readUserDaily_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame 'Daily' with the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
Date </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date </td>
</tr>
<tr>
 <td style="text-align: left;">
Q </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Discharge in m^3/s</td>
</tr>
<tr>
 <td style="text-align: left;">
Julian </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of days since Jan. 1, 1850</td>
</tr>
<tr>
 <td style="text-align: left;">
Month </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Month of the year [1-12] </td>
</tr>
<tr>
 <td style="text-align: left;"> 
Day </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Day of the year [1-366] </td>
</tr>
<tr>
 <td style="text-align: left;">
DecYear </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Decimal year </td>
</tr>
<tr>
 <td style="text-align: left;">
MonthSeq </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of months since January 1, 1850 </td>
</tr>
<tr>
 <td style="text-align: left;">
Qualifier </td><td style="text-align: left;"> character </td><td style="text-align: left;"> Qualifying code </td>
</tr>
<tr>
 <td style="text-align: left;">
i </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Index of days, starting with 1 </td>
</tr>
<tr>
 <td style="text-align: left;">
LogQ </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Natural logarithm of Q  </td>
</tr>
<tr>
 <td style="text-align: left;">
Q7 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 7 day running average of Q </td>
</tr>
<tr>
 <td style="text-align: left;">
Q30 </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> 30 day running average of Q </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>filePath &lt;- system.file("extdata", package="EGRET")
fileName &lt;- "ChoptankRiverFlow.txt"
Daily &lt;- readUserDaily(filePath,fileName,separator="\t")
</code></pre>

<hr>
<h2 id='readUserSample'>Import user-supplied sample data for EGRET analysis</h2><span id='topic+readUserSample'></span>

<h3>Description</h3>

<p>Imports data from a user-supplied file, and converts it to a Sample data frame 
(including summing multiple constituents), appropriate for EGRET analysis. 
First column is date, second is remark code, and third is value. If multiple constituents 
are to be combined with interval censoring, additional pairs of columns can be inserted, each pair starting with
remark code (specifically looking for &lt;), followed by the values. If the date format is not automatically
detected, the format can be specified using the &quot;format&quot; argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readUserSample(filePath, fileName, hasHeader = TRUE, separator = ",",
  verbose = TRUE, format = "%m/%d/%Y")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readUserSample_+3A_filepath">filePath</code></td>
<td>
<p>character specifying the path to the file. If it 
is in the working directory, use &quot;.&quot;.</p>
</td></tr>
<tr><td><code id="readUserSample_+3A_filename">fileName</code></td>
<td>
<p>character name of file to open</p>
</td></tr>
<tr><td><code id="readUserSample_+3A_hasheader">hasHeader</code></td>
<td>
<p>logical true if the first row of data is the column headers</p>
</td></tr>
<tr><td><code id="readUserSample_+3A_separator">separator</code></td>
<td>
<p>character character that separates data cells. , default is &quot;,&quot;
which is separator used in a .csv file.</p>
</td></tr>
<tr><td><code id="readUserSample_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
<tr><td><code id="readUserSample_+3A_format">format</code></td>
<td>
<p>character indicating the format of the date (which should
be in the first column). Default is &quot;%m\/%d/%Y&quot;. See <code>?strptime</code>
for options. The code will initially look for R's standard YYYY-MM-DD, and
check this format as a backup.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame 'Sample' with the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
Date </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcLow </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Lower limit of concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcHigh </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Upper limit of concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
Uncen </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Uncensored data (1=TRUE, 0=FALSE) </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcAve </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Average concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
Julian </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of days since Jan. 1, 1850</td>
</tr>
<tr>
 <td style="text-align: left;">
Month </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Month of the year [1-12] </td>
</tr>
<tr>
 <td style="text-align: left;"> 
Day </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Day of the year [1-366] </td>
</tr>
<tr>
 <td style="text-align: left;">
DecYear </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Decimal year </td>
</tr>
<tr>
 <td style="text-align: left;">
MonthSeq </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of months since January 1, 1850 </td>
</tr>
<tr>
 <td style="text-align: left;">
SinDY </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Sine of the DecYear </td>
</tr>
<tr>
 <td style="text-align: left;">
CosDY </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Cosine of the DecYear
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+compressData">compressData</a></code>, <code><a href="#topic+populateSampleColumns">populateSampleColumns</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>filePath &lt;- system.file("extdata", package="EGRET")
fileName &lt;- 'ChoptankRiverNitrate.csv'
Sample &lt;- readUserSample(filePath,fileName, separator=";",verbose=FALSE)
</code></pre>

<hr>
<h2 id='readWQPSample'>Import Sample Data from the Water Quality Portal for WRTDS</h2><span id='topic+readWQPSample'></span>

<h3>Description</h3>

<p>Imports data from the Water Quality Portal, so it could be STORET, USGS, or USDA data. 
This function gets the data from: <a href="https://www.waterqualitydata.us">https://www.waterqualitydata.us</a>
For raw data, use readWQPdata.  This function will retrieve the raw data, 
compress it (summing constituents), then converts it to the Sample dataframe structure.
See chapter 7 of the EGRET user guide for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readWQPSample(siteNumber, characteristicName, startDate = "", endDate = "",
  verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readWQPSample_+3A_sitenumber">siteNumber</code></td>
<td>
<p>character site number.  If USGS, it should be in the form :'USGS-XXXXXXXXX...'</p>
</td></tr>
<tr><td><code id="readWQPSample_+3A_characteristicname">characteristicName</code></td>
<td>
<p>character. Either a valid characteristic name, or a 5 digit 
USGS parameter code.</p>
</td></tr>
<tr><td><code id="readWQPSample_+3A_startdate">startDate</code></td>
<td>
<p>character starting date for data retrieval in the form YYYY-MM-DD.
Default is empty quotes &quot;&quot; which will retrieve the full period of record.</p>
</td></tr>
<tr><td><code id="readWQPSample_+3A_enddate">endDate</code></td>
<td>
<p>character ending date for data retrieval in the form YYYY-MM-DD.
Default is empty quotes &quot;&quot; which will retrieve the full period of record.</p>
</td></tr>
<tr><td><code id="readWQPSample_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame 'Sample' with the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
Date </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcLow </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Lower limit of concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcHigh </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Upper limit of concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
Uncen </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Uncensored data (1=TRUE, 0=FALSE) </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcAve </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Average concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
Julian </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of days since Jan. 1, 1850</td>
</tr>
<tr>
 <td style="text-align: left;">
Month </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Month of the year [1-12] </td>
</tr>
<tr>
 <td style="text-align: left;"> 
Day </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Day of the year [1-366] </td>
</tr>
<tr>
 <td style="text-align: left;">
DecYear </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Decimal year </td>
</tr>
<tr>
 <td style="text-align: left;">
MonthSeq </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of months since January 1, 1850 </td>
</tr>
<tr>
 <td style="text-align: left;">
SinDY </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Sine of the DecYear </td>
</tr>
<tr>
 <td style="text-align: left;">
CosDY </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Cosine of the DecYear
</td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="dataRetrieval.html#topic+readWQPdata">readWQPdata</a></code>, <code>dataRetrieval::whatWQPsites</code>, 
<code><a href="dataRetrieval.html#topic+readWQPqw">readWQPqw</a></code>, <code><a href="#topic+compressData">compressData</a></code>, <code><a href="#topic+populateSampleColumns">populateSampleColumns</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># These examples require an internet connection to run

# Sample_All &lt;- readWQPSample('WIDNR_WQX-10032762','Specific conductance', '', '')

</code></pre>

<hr>
<h2 id='removeDuplicates'>Remove duplicates values from Sample data frame.</h2><span id='topic+removeDuplicates'></span>

<h3>Description</h3>

<p>Removes observations from the data frame Sample when the observation has the identical date and value as another observation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeDuplicates(Sample)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="removeDuplicates_+3A_sample">Sample</code></td>
<td>
<p>dataframe with at least DecYear and ConcHigh, default name is Sample</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame 'Sample' with the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Type </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
Date </td><td style="text-align: left;"> Date </td><td style="text-align: left;"> Date </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcLow </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Lower limit of concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcHigh </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Upper limit of concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
Uncen </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Uncensored data (1=TRUE, 0=FALSE) </td>
</tr>
<tr>
 <td style="text-align: left;">
ConcAve </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Average concentration </td>
</tr>
<tr>
 <td style="text-align: left;">
Julian </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of days since Jan. 1, 1850</td>
</tr>
<tr>
 <td style="text-align: left;">
Month </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Month of the year [1-12] </td>
</tr>
<tr>
 <td style="text-align: left;"> 
Day </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Day of the year [1-366] </td>
</tr>
<tr>
 <td style="text-align: left;">
DecYear </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Decimal year </td>
</tr>
<tr>
 <td style="text-align: left;">
MonthSeq </td><td style="text-align: left;"> integer </td><td style="text-align: left;"> Number of months since January 1, 1850 </td>
</tr>
<tr>
 <td style="text-align: left;">
SinDY </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Sine of the DecYear </td>
</tr>
<tr>
 <td style="text-align: left;">
CosDY </td><td style="text-align: left;"> numeric </td><td style="text-align: left;"> Cosine of the DecYear
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>DecYear &lt;- c('1985.01', '1985.01', '1985.02', '1985.02', '1985.03')
ConcHigh &lt;- c(1,2,3,3,5)
dataInput &lt;- data.frame(DecYear, ConcHigh, stringsAsFactors=FALSE)
Sample &lt;- removeDuplicates(dataInput)
</code></pre>

<hr>
<h2 id='runGroups'>Runs a comparison of any group of years in the record.</h2><span id='topic+runGroups'></span>

<h3>Description</h3>

<p><code>runGroups</code> provides comparisons of results, in terms of 
flow-normalized concentration and flow-normalized flux for any groups of years
of years in the water quality record.  Comparison could involve the 
use of the &quot;wall&quot; and/or use of &quot;generalized flow-normalization&quot;.  
These two concepts are described in detail in the vignette:
<code>vignette("Enhancements", package = "EGRET")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runGroups(eList, windowSide, group1firstYear, group1lastYear, group2firstYear,
  group2lastYear, surfaceStart = NA, surfaceEnd = NA, flowBreak = FALSE,
  Q1EndDate = NA, QStartDate = NA, QEndDate = NA, wall = FALSE,
  oldSurface = FALSE, fractMin = 0.75, sample1EndDate = NA,
  sampleStartDate = NA, sampleEndDate = NA, paStart = NA, paLong = NA,
  minNumObs = 100, minNumUncen = 50, windowY = 7, windowQ = 2,
  windowS = 0.5, edgeAdjust = TRUE, verbose = TRUE, saveOutput = FALSE,
  fileName = "temp.txt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runGroups_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="runGroups_+3A_windowside">windowSide</code></td>
<td>
<p>integer. The width of the flow normalization window on each side of the year being estimated.
A common value is 11, but no default is specified.  If stationary flow normalization is to be used, then windowSide = 0 (this means that 
flow-normalization period for all years is the same).</p>
</td></tr>
<tr><td><code id="runGroups_+3A_group1firstyear">group1firstYear</code></td>
<td>
<p>decimal year. Starting year of first group.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_group1lastyear">group1lastYear</code></td>
<td>
<p>decimal year. Ending year of first group.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_group2firstyear">group2firstYear</code></td>
<td>
<p>decimal year. Starting year of second group.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_group2lastyear">group2lastYear</code></td>
<td>
<p>decimal year. Ending year of second group.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_surfacestart">surfaceStart</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) that is the start of the WRTDS model to be estimated and the first of the 
daily outputs to be generated. Default is NA, which means that the surfaceStart is based on the date of the first sample.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_surfaceend">surfaceEnd</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) that is the end of the WRTDS model to be estimated and the last of the daily outputs 
to be generated.  Default is NA, which means that the surfaceEnd is based on the date of the last sample.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_flowbreak">flowBreak</code></td>
<td>
<p>logical. Is there an abrupt break in the discharge record, default is FALSE.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_q1enddate">Q1EndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) which is the last day, just before the flowBreak.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_qstartdate">QStartDate</code></td>
<td>
<p>The first Date (as character in YYYY-MM-DD) used in the  flow normalization method.  Default is 
NA, which makes the QStartDate become the first Date in eList$Daily.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_qenddate">QEndDate</code></td>
<td>
<p>The last Date (as character in YYYY-MM-DD) used in the flow normalization method.  Default is NA, 
which makes the QEndDate become the last Date in eList$Daily.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_wall">wall</code></td>
<td>
<p>logical. Whether there is an abrupt break in the concentration versus discharge relationship due to some major change in 
pollution control or water management.  Default is FALSE.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_oldsurface">oldSurface</code></td>
<td>
<p>logical specifying whether to use the original surface, or create a new one. Default is FALSE.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_fractmin">fractMin</code></td>
<td>
<p>numeric specifying the minimum fraction of the observations required to run the weighted regression, default is 0.75. The
minimum number will be the maximum of minNumObs and fractMin multiplied by total number of observations.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_sample1enddate">sample1EndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) of the last date just before the wall. Default = NA. 
A date must be specified if wall = TRUE.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_samplestartdate">sampleStartDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) of the first sample to be used. Default is NA which sets it 
to the first Date in eList$Sample.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_sampleenddate">sampleEndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) of the last sample to be used. 
Default is NA which sets it to the last Date in eList$Sample.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_pastart">paStart</code></td>
<td>
<p>numeric integer specifying the starting month for the period of analysis, 1&lt;=paStart&lt;=12.
Default is NA, which will use the paStart in the eList$INFO data frame. See also <code><a href="#topic+setPA">setPA</a></code>.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_palong">paLong</code></td>
<td>
<p>numeric integer specifying the length of the period of analysis, in months, 1&lt;=paLong&lt;=12. 
Default is NA, which will use the paLong in the eList$INFO data frame. See also <code><a href="#topic+setPA">setPA</a></code>.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_minnumobs">minNumObs</code></td>
<td>
<p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p>
</td></tr>
<tr><td><code id="runGroups_+3A_minnumuncen">minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td></tr>
<tr><td><code id="runGroups_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p>
</td></tr>
<tr><td><code id="runGroups_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td></tr>
<tr><td><code id="runGroups_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td></tr>
<tr><td><code id="runGroups_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record.
The edgeAdjust method tends to reduce curvature near the start and end of record.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
<tr><td><code id="runGroups_+3A_saveoutput">saveOutput</code></td>
<td>
<p>logical. If <code>TRUE</code>, a text file will be saved in the working directory of the printout of
what is in the console output. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="runGroups_+3A_filename">fileName</code></td>
<td>
<p>character. Name to save the output file if <code>saveOutput=TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When using generalized flow-normalization, it is best to have the Daily data frame
extend well beyond the years that are in the Sample data frame.  Ideally, 
the Daily data frame would start windowSide years before the
start of the Sample data set, if the data exist to provide for that. Generally
that isn't possible for the end of the record because the Sample data
may end very close to the present. To the extent that is possible therefore, it is better to
include more discharge data after the end of the Sample record. 
Also note that in the case run in the examples don't do that, 
because the data set needs to be appropriate for stationary flow 
normalization as well (and package size considerations make it difficult to
include specialized examples).
</p>


<h3>Value</h3>

<p>Dataframe with 7 columns and 2 rows.  The first row is about trends in concentration (mg/L), the second column is about trends in flux (million kg/year).
The data frame has a number of attributes.
</p>

<table>
<tr>
 <td style="text-align: left;">
Column Name </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
Total Change </td><td style="text-align: left;">   The difference between the results for group2 - group1 (x22 - x11). </td>
</tr>
<tr>
 <td style="text-align: left;">
CQTC </td><td style="text-align: left;"> CQTC is the "Concentration v. Q Trend Component." It is the component of total change due to the change in the CQR (Concentration Discharge Relationship). (x20 - x10). </td>
</tr>
<tr>
 <td style="text-align: left;">
QTC </td><td style="text-align: left;"> QTC is the "Q Trend Component." It is the component of total change due to the trend in the QD (Discharge Distribution). (x22 - x11 - x20 + x10). </td>
</tr>
<tr>
 <td style="text-align: left;">
x10 </td><td style="text-align: left;"> The estimated value based on the CQR computed for the years in group1, integrated over the QD for the entire timespan of the Daily data frame (or the 
period QStartDate and to QEndDate if these are specified).</td>
</tr>
<tr>
 <td style="text-align: left;">
x11 </td><td style="text-align: left;"> The estimated value based on the CQR for the years in group1, integrated over the QD specified by the user for group1. </td>
</tr>
<tr>
 <td style="text-align: left;">
x20 </td><td style="text-align: left;"> The estimated value based on the CQR computed for the years in group2, integrated over the QD for the entire period of record. </td>
</tr>
<tr>
 <td style="text-align: left;">
x22 </td><td style="text-align: left;"> The estimated value based on the CQR for the years in group2, integrated over the QD specified by the user for group2. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList


#Option 1:  Use all years for group flow normalization.
groupOut_1 &lt;- runGroups(eList,  windowSide = 0,
                       group1firstYear = 1980, group1lastYear = 1990,
                       group2firstYear = 1995, group2lastYear = 2005)

# Option 2: Use sliding window.
#                In each case it is a 23 year window (23 = 1 + 2 * 11)

groupOut_2 &lt;- runGroups(eList,  windowSide = 11,
                       group1firstYear = 1980, group1lastYear = 1990,
                       group2firstYear = 1995, group2lastYear = 2005)

# Option 3: Flow normalization is based on splitting the flow record at 1990-09-30
#                But in years before the break it uses all flow data from before the break,
#                and years after the break uses all flow data after the break

groupOut_3 &lt;- runGroups(eList,  windowSide = 0,
                       group1firstYear = 1980, group1lastYear = 1990,
                       group2firstYear = 1995, group2lastYear = 2005,
                       flowBreak = TRUE, 
                       Q1EndDate = "1990-09-30")

# Option 4: Flow normalization is based on splitting the flow record at 1990-09-30
#                but before the break uses a 23 year window of years before the break
#                after the break uses a 23 year window of years after the break
groupOut_4 &lt;- runGroups(eList,  windowSide = 11,
                       group1firstYear = 1980, group1lastYear = 1990,
                       group2firstYear = 1995, group2lastYear = 2005,
                       flowBreak = TRUE, 
                       Q1EndDate = "1990-09-30")


</code></pre>

<hr>
<h2 id='runPairs'>Runs a comparison of any two years in the record.</h2><span id='topic+runPairs'></span>

<h3>Description</h3>

<p><code>runPairs</code> provides comparisons of results, in terms of 
flow-normalized concentration and flow-normalized flux for any pair 
of years in the water quality record.  Comparison could involve the 
use of the &quot;wall&quot; and/or use of &quot;generalized flow normalization&quot;.  
These two concepts are described in detail in the vignette:
<code>vignette("Enhancements", package = "EGRET")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runPairs(eList, year1, year2, windowSide, flowBreak = FALSE,
  Q1EndDate = NA, QStartDate = NA, QEndDate = NA, wall = FALSE,
  oldSurface = FALSE, sample1EndDate = NA, sampleStartDate = NA,
  sampleEndDate = NA, paStart = NA, paLong = NA, minNumObs = 100,
  minNumUncen = 50, fractMin = 0.75, windowY = 7, windowQ = 2,
  windowS = 0.5, edgeAdjust = TRUE, saveOutput = FALSE,
  fileName = "temp.txt", verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runPairs_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="runPairs_+3A_year1">year1</code></td>
<td>
<p>integer the ending year of the first year in the pair</p>
</td></tr>
<tr><td><code id="runPairs_+3A_year2">year2</code></td>
<td>
<p>integer the ending year of the second year in the pair</p>
</td></tr>
<tr><td><code id="runPairs_+3A_windowside">windowSide</code></td>
<td>
<p>integer. The width of the flow normalization window on each side of the year being estimated.
A common value is 11, but no default is specified.  If stationary flow normalization is to be used, then windowSide = 0 (this means that 
flow-normalization period for all years is the same).</p>
</td></tr>
<tr><td><code id="runPairs_+3A_flowbreak">flowBreak</code></td>
<td>
<p>logical. Is there an abrupt break in the discharge record, default is FALSE.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_q1enddate">Q1EndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) which is the last day, just before the flowBreak.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_qstartdate">QStartDate</code></td>
<td>
<p>The first Date (as character in YYYY-MM-DD) used in the  flow normalization method.  Default is 
NA, which makes the QStartDate become the first Date in eList$Daily.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_qenddate">QEndDate</code></td>
<td>
<p>The last Date (as character in YYYY-MM-DD) used in the flow normalization method.  Default is NA, 
which makes the QEndDate become the last Date in eList$Daily.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_wall">wall</code></td>
<td>
<p>logical. Whether there is an abrupt break in the concentration versus discharge relationship due to some major change in 
pollution control or water management.  Default is FALSE.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_oldsurface">oldSurface</code></td>
<td>
<p>logical specifying whether to use the original surface, or create a new one. Default is FALSE.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_sample1enddate">sample1EndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) of the last date just before the wall. Default = NA. 
A date must be specified if wall = TRUE.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_samplestartdate">sampleStartDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) of the first sample to be used. Default is NA which sets it 
to the first Date in eList$Sample.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_sampleenddate">sampleEndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD) of the last sample to be used. 
Default is NA which sets it to the last Date in eList$Sample.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_pastart">paStart</code></td>
<td>
<p>numeric integer specifying the starting month for the period of analysis, 1&lt;=paStart&lt;=12.
Default is NA, which will use the paStart in the eList$INFO data frame. See also <code><a href="#topic+setPA">setPA</a></code>.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_palong">paLong</code></td>
<td>
<p>numeric integer specifying the length of the period of analysis, in months, 1&lt;=paLong&lt;=12. 
Default is NA, which will use the paLong in the eList$INFO data frame. See also <code><a href="#topic+setPA">setPA</a></code>.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_minnumobs">minNumObs</code></td>
<td>
<p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p>
</td></tr>
<tr><td><code id="runPairs_+3A_minnumuncen">minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td></tr>
<tr><td><code id="runPairs_+3A_fractmin">fractMin</code></td>
<td>
<p>numeric specifying the minimum fraction of the observations required to run the weighted regression, default is 0.75. The
minimum number will be the maximum of minNumObs and fractMin multiplied by total number of observations.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p>
</td></tr>
<tr><td><code id="runPairs_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td></tr>
<tr><td><code id="runPairs_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td></tr>
<tr><td><code id="runPairs_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record.
The edgeAdjust method tends to reduce curvature near the start and end of record.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_saveoutput">saveOutput</code></td>
<td>
<p>logical. If <code>TRUE</code>, a text file will be saved in the working directory of the printout of
what is in the console output. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_filename">fileName</code></td>
<td>
<p>character. Name to save the output file if <code>saveOutput=TRUE</code>.</p>
</td></tr>
<tr><td><code id="runPairs_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When using generalized flow-normalization, it is best to have the Daily data frame
extend well beyond the years that are in the Sample data frame.  Ideally, 
the Daily data frame would start windowSide years before the
start of the Sample data set, if the data exist to provide for that. Generally
that isn't possible for the end of the record because the Sample data
may end very close to the present. To the extent that is possible therefore, it is better to
include more discharge data after the end of the Sample record. 
Also note that in the case run in the examples don't do that, 
because the data set needs to be appropriate for stationary flow 
normalization as well (and package size considerations make it difficult to
include specialized examples).
</p>


<h3>Value</h3>

<p>Data frame with 7 columns and 2 rows.  The first row is about trends in concentration (mg/L), 
the second column is about trends in flux (million kg/year).  
The data frame has a number of attributes.
</p>

<table>
<tr>
 <td style="text-align: left;">
Column Name </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
Total Change </td><td style="text-align: left;">   The difference between the results for year2 - year1 (x22 - x11)</td>
</tr>
<tr>
 <td style="text-align: left;">
CQTC </td><td style="text-align: left;"> CQTC is the "Concentration v. Q Trend Component." It is the component of total 
change due to the change in the CQR (Concentration Discharge Relationship). (x20 - x10). </td>
</tr>
<tr>
 <td style="text-align: left;">
QTC </td><td style="text-align: left;">  QTC is the "Q Trend Component." It is the component of total change due to the
trend in the QD (Discharge Distribution). (x22 - x11 - x20 + x10).  </td>
</tr>
<tr>
 <td style="text-align: left;">
x10 </td><td style="text-align: left;"> The estimated value based on the CQR computed for year1, integrated over the QD for the entire 
timespan of the Daily data frame (or the period QStartDate and to QEndDate if these are specified).</td>
</tr>
<tr>
 <td style="text-align: left;">
x11 </td><td style="text-align: left;"> The estimated value based on the CQR for year1, integrated over the QD specified by the user for year1.</td>
</tr>
<tr>
 <td style="text-align: left;">
x20 </td><td style="text-align: left;"> The estimated value based on the CQR computed for year2, integrated over the QD for the entire period of record. </td>
</tr>
<tr>
 <td style="text-align: left;">
x22 </td><td style="text-align: left;"> The estimated value based on the CQR for year2, integrated over the QD specified by the user for year2. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Additionally, there is an attribute on the data frame &quot;Other&quot;, containing
a list that includes minNumObs=minNumObs, minNumUncen, windowY, windowQ, siteName,
windowS, wall, edgeAdjust, QStartDate, QEndDate, PercentChangeConc, and PercentChangeFlux.
</p>
<p>PercentChangeConc, and PercentChangeFlux are vectors where:
Total Percent Change is the Total Change divided by x11
CQTC Percent is the CQTC divided by x11
QTC Percent  is the QTC divided by x11
</p>
<p>Another attribute is &quot;byMonth&quot;.  This is a data frame of 4 columns and 14 rows.  
The columns represent the concentrations and fluxes for the starting and ending year.
The flux values for each month are flow normalized monthly watershed yields
expressed as kg/month/km^2.  The concentrations are the mean flow normalized
concentration, expressed in whatever concentration units the raw data are 
expressed as (typically mg/L).  This data frame is used as the input to the
<code>plotMonthTrend</code> function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
year1 &lt;- 1985
year2 &lt;- 2010


# Automatic calculations based on windowSide = 11
# four possible ways to do generalized flow normalization:

#Option 1: Use all years for flow normalization.

pairOut_1 &lt;- runPairs(eList, year1, year2, windowSide = 0)

# Option 2:  Use different windows for flow normalization for year1 versus year2
#            In each case it is a 23 year window (23 = 1 + 2*11)

pairOut_2 &lt;- runPairs(eList, year1, year2, windowSide = 11)

# Option 3: Flow normalization is based on splitting the flow record at 1990-09-30
#          But year1 uses all flow data from before the break, 
#          year2 uses all flow data after the break

pairOut_3 &lt;- runPairs(eList, year1, year2, 
                      windowSide = 0, flowBreak = TRUE,
                      Q1EndDate = "1990-09-30")

# Option 4: Flow normalization is based on splitting the flow record at 1990-09-30
#           but year1 uses a 23 year window before the break
#           year2 uses a 23 year window after the break

pairOut_4 &lt;- runPairs(eList, year1, year2, 
                      windowSide = 11, flowBreak = TRUE,
                      Q1EndDate = "1990-09-30")
                      
monthly_trends &lt;- attr(pairOut_4, "byMonth")  
plotMonthTrend(pairOut_4)

eList &lt;- setPA(eList, paLong = 3, paStart = 12)
pairOut_5 &lt;- runPairs(eList, year1, year2,
                      windowSide = 11)
monthly_trends &lt;- attr(pairOut_5, "byMonth") 
plotMonthTrend(pairOut_5)                      


</code></pre>

<hr>
<h2 id='runSeries'>Annual series of flow-normalized concentration and flow-normalized flux</h2><span id='topic+runSeries'></span>

<h3>Description</h3>

<p><code>runSeries</code> provides annual series of flow-normalized concentration and flow-normalized flux for the water quality record.  
Computations could involve the use of the &quot;wall&quot; and/or use of &quot;generalized flow 
normalization&quot;.  These two concepts are described in detail in the vignette:  
<code>vignette("Enhancements", package = "EGRET")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runSeries(eList, windowSide, surfaceStart = NA, surfaceEnd = NA,
  flowBreak = FALSE, Q1EndDate = NA, QStartDate = NA, QEndDate = NA,
  wall = FALSE, oldSurface = FALSE, sample1EndDate = NA,
  sampleStartDate = NA, sampleEndDate = NA, paStart = NA, paLong = NA,
  fractMin = 0.75, minNumObs = 100, minNumUncen = 50, windowY = 7,
  windowQ = 2, windowS = 0.5, edgeAdjust = TRUE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runSeries_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="runSeries_+3A_windowside">windowSide</code></td>
<td>
<p>integer. The width of the flow normalization window on each side of the year being estimated.
A common value is 11, but no default is specified.  If stationary flow normalization is to be used, then windowSide = 0 (this means that 
flow-normalization period for all years is the same).</p>
</td></tr>
<tr><td><code id="runSeries_+3A_surfacestart">surfaceStart</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) that is the start of the WRTDS model to be estimated and the first of the 
daily outputs to be generated.  Default is NA, which means that the surfaceStart is based on the date of the first sample.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_surfaceend">surfaceEnd</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) that is the end of the WRTDS model to be estimated and the last of the daily outputs 
to be generated.  Default is NA, which means that the surfaceEnd is based on the date of the last sample.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_flowbreak">flowBreak</code></td>
<td>
<p>logical, is there an abrupt break in the discharge record, default is FALSE.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_q1enddate">Q1EndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD format) which is the last day, just before the flowBreak. Required if flowBreak = TRUE.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_qstartdate">QStartDate</code></td>
<td>
<p>The first Date (as character in YYYY-MM-DD format) used in the flow normalization.  Default is NA, which makes the QStartDate become the first Date in eList$Daily.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_qenddate">QEndDate</code></td>
<td>
<p>The last Date (as character in YYYY-MM-DD format) used in the flow normalization.  Default is NA, which makes the QEndDate become the last Date in eList$Daily.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_wall">wall</code></td>
<td>
<p>logical. Whether there is an abrupt break in the concentration versus discharge relationship due to some major change in 
pollution control or water management.  Default is FALSE.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_oldsurface">oldSurface</code></td>
<td>
<p>logical, if TRUE, use surface previously estimated using modelEstimation.  Default is FALSE.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_sample1enddate">sample1EndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD format) of the last day just before the wall.  Default = NA.  A date must be specified if wall = TRUE.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_samplestartdate">sampleStartDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD format) of the first sample to be used.  Default is NA which sets it to the first Date in eList$Sample.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_sampleenddate">sampleEndDate</code></td>
<td>
<p>The Date (as character in YYYY-MM-DD format) of the last sample to be used. Default is NA which sets it to the last Date in eList$Sample.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_pastart">paStart</code></td>
<td>
<p>numeric integer specifying the starting month for the period of analysis, 1&lt;=paStart&lt;=12.
Default is NA, which will use the paStart in the eList$INFO data frame. See also <code><a href="#topic+setPA">setPA</a></code>.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_palong">paLong</code></td>
<td>
<p>numeric integer specifying the length of the period of analysis, in months, 1&lt;=paLong&lt;=12. 
Default is NA, which will use the paLong in the eList$INFO data frame. See also <code><a href="#topic+setPA">setPA</a></code>.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_fractmin">fractMin</code></td>
<td>
<p>numeric specifying the minimum fraction of the observations required to run the weighted regression, default is 0.75. The
minimum number will be the maximum of minNumObs and fractMin multiplied by total number of observations.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_minnumobs">minNumObs</code></td>
<td>
<p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p>
</td></tr>
<tr><td><code id="runSeries_+3A_minnumuncen">minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td></tr>
<tr><td><code id="runSeries_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p>
</td></tr>
<tr><td><code id="runSeries_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td></tr>
<tr><td><code id="runSeries_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td></tr>
<tr><td><code id="runSeries_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record. The edgeAdjust method tends to reduce curvature near the start and end of record.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="runSeries_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether to output status messages.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When using generalized flow-normalization, it is best to have the Daily data frame
extend well beyond the years that are in the Sample data frame.  Ideally, 
the Daily data frame would start windowSide years before the
start of the Sample data set, if the data exist to provide for that. Generally
that isn't possible for the end of the record because the Sample data
may end very close to the present. To the extent that is possible therefore, it is better to
include more discharge data after the end of the Sample record. 
Also note that in the case run in the examples don't do that, 
because the data set needs to be appropriate for stationary flow 
normalization as well (and package size considerations make it difficult to
include specialized examples).
</p>


<h3>Value</h3>

<p>eList named list with INFO, Daily, and Sample dataframes, along with the surfaces matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList


# Automatic calculations based on windowSide = 11
# four possible ways to do generalized flow normalization

#Option 1:  Use all years for flow normalization.
seriesOut_1 &lt;- runSeries(eList,  windowSide = 0)
plotConcHist(seriesOut_1)
plotFluxHist(seriesOut_1)

# Option 2: Use sliding window throughout the whole flow normalization process.
#                In each case it is a 15 year window (23 = 1 + 2*11)
seriesOut_2 &lt;- runSeries(eList, windowSide = 11)

plotConcHist(seriesOut_2)
plotFluxHist(seriesOut_2)

# Option 3: Flow normalization is based on splitting the flow record at 1990-09-30
#                But in years before the break it uses all flow data from before the break, 
#                and years after the break uses all flow data after the break
seriesOut_3 &lt;- runSeries(eList,
                       windowSide = 0, 
                       flowBreak = TRUE,
                       Q1EndDate = "1990-09-30")
                       
plotConcHist(seriesOut_3)
plotFluxHist(seriesOut_3)

# Option 4: Flow normalization is based on splitting the flow record at 1990-09-30
#                but before the break uses a 23 year window of years before the break
#                after the break uses a 23 year window of years after the break
seriesOut_4 &lt;- runSeries(eList, 
                      windowSide = 11, flowBreak = TRUE,
                      Q1EndDate = "1990-09-30")
                      
plotConcHist(seriesOut_4)
plotFluxHist(seriesOut_4)


</code></pre>

<hr>
<h2 id='runSurvReg'>Run the weighted survival regression for a set of estimation points (defined by DecYear and Log(Q))</h2><span id='topic+runSurvReg'></span><span id='topic+run_WRTDS'></span>

<h3>Description</h3>

<p>This function runs the survival regression which is the concentration estimation method of WRTDS. 
It uses sample data from the data frame Sample. 
It does the estimation for a set of data points defined by two vectors: estPtYear and estPtLQ. 
It returns an array of results for the estimation points.  
The array returned contains yHat, SE and ConcHat (in that order). yHat is the expected value of log(concentration), SE is 
the standard error of log(concentration) and ConcHat is the expected value of concentration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runSurvReg(estPtYear, estPtLQ, DecLow, DecHigh, Sample, windowY = 7,
  windowQ = 2, windowS = 0.5, minNumObs = 100, minNumUncen = 50,
  verbose = TRUE, interactive = NULL, edgeAdjust = TRUE,
  run.parallel = FALSE)

run_WRTDS(estY, estLQ, localSample, DecLow, DecHigh, minNumObs, minNumUncen,
  windowY, windowQ, windowS, edgeAdjust)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runSurvReg_+3A_estptyear">estPtYear</code></td>
<td>
<p>numeric vector of Decimal Year values at the estimation points</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_estptlq">estPtLQ</code></td>
<td>
<p>numeric vector of ln(Q) values at the estimation points, must be the same length as estPtYear</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_declow">DecLow</code></td>
<td>
<p>number specifying minimum decimal year (left edge of the estimated surfaces).</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_dechigh">DecHigh</code></td>
<td>
<p>number specifying maximum decimal year (right edge of the estimated surfaces).</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_sample">Sample</code></td>
<td>
<p>dataframe created for EGRET analysis</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_minnumobs">minNumObs</code></td>
<td>
<p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_minnumuncen">minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_interactive">interactive</code></td>
<td>
<p>logical deprecated. Use 'verbose' instead</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record.  The modified method tends to reduce curvature near the start and end of record.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_run.parallel">run.parallel</code></td>
<td>
<p>logical to run bootstrapping in parallel or not</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_esty">estY</code></td>
<td>
<p>numeric decimal year values at the estimation point</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_estlq">estLQ</code></td>
<td>
<p>numeric ln(Q) values at the estimation point</p>
</td></tr>
<tr><td><code id="runSurvReg_+3A_localsample">localSample</code></td>
<td>
<p>&quot;Sample&quot; data frame from the eList.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>resultSurvReg numeric array containing the yHat, SE, and ConcHat values array dimensions are (numEstPts,3)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
estPtYear&lt;-c(2001.0,2005.0,2009.0)
estPtLQ&lt;-c(1,1,1)
Sample &lt;- getSample(eList)
DecLow &lt;- Sample$DecYear[1]
DecHigh &lt;- Sample$DecYear[nrow(Sample)]
resultSurvReg &lt;- runSurvReg(estPtYear,estPtLQ,
                            DecLow,DecHigh,Sample,
                            run.parallel = FALSE)
</code></pre>

<hr>
<h2 id='saveResults'>A utility program for saving the contents of the workspace
This function saves the workspace. Future versions of EGRET will not include this function,
use saveRDS to save individual eList objects.
It assigns the file a name using the abbreviations for station and constituent.</h2><span id='topic+saveResults'></span>

<h3>Description</h3>

<p>A utility program for saving the contents of the workspace
</p>
<p>This function saves the workspace. Future versions of EGRET will not include this function,
use saveRDS to save individual eList objects.
It assigns the file a name using the abbreviations for station and constituent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>saveResults(savePath, eList)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="saveResults_+3A_savepath">savePath</code></td>
<td>
<p>character specifying the full pathname of the folder where the file is to be saved ending with the final slash</p>
</td></tr>
<tr><td><code id="saveResults_+3A_elist">eList</code></td>
<td>
<p>named list with at least the INFO dataframe</p>
</td></tr>
</table>

<hr>
<h2 id='selectDays'>Creates a subset Daily data frame that only contains daily estimates for the specified period of analysis</h2><span id='topic+selectDays'></span>

<h3>Description</h3>

<p>This function uses the user-defined 'period of analysis', and subsets the Daily data frame, it doesn't have 
any effect on the Sample data frame.
If you want to examine your data set as a time series of water years, 
then the period of analysis is October through September.  
If you want to examine the data set as calendar years then the period of analysis is January through December.  
You might want to examine the winter season, which you could define as December through February, 
then those 3 months become the period of analysis. The only constraints on the definition of a period of analysis 
are these: it must be defined in terms of whole months; it must be a set of contiguous months (like March-April-May), 
and have a length that is no less than 1 month and no more than 12 months.  
Define the PA by using two arguments: paLong and paStart. paLong is the length of the period of analysis,
and paStart is the starting month.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selectDays(df, paLong, paStart)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selectDays_+3A_df">df</code></td>
<td>
<p>dataframe which must contain a column named Month (for month of the calendar year, typically this 
is a Daily data frame.</p>
</td></tr>
<tr><td><code id="selectDays_+3A_palong">paLong</code></td>
<td>
<p>a numeric value for the length of the period of analysis, must be an integer from 1 to 12</p>
</td></tr>
<tr><td><code id="selectDays_+3A_pastart">paStart</code></td>
<td>
<p>a numeric value for the starting month of the period of analysis, must be an integer from 1 to 12</p>
</td></tr>
</table>


<h3>Value</h3>

<p>localDaily a data frame containing the daily data but only for the period of analysis (not all months)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Daily &lt;- getDaily(eList)
DailySubset &lt;- selectDays(Daily, 4, 11)
</code></pre>

<hr>
<h2 id='setPA'>Sets up the period of analysis (the portion of the year being evaluated).</h2><span id='topic+setPA'></span>

<h3>Description</h3>

<p>Period of analysis is defined by the starting month (paStart) and length in months (paLong).  paStart and paLong are constrained to be integers from 1 to 12. For example, a water year would be paStart = 10 and paLong = 12. For example, the winter season, defined by Dec,Jan,Feb would be paStart = 12 and paLong = 3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setPA(eList, paStart = 10, paLong = 12, window = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setPA_+3A_elist">eList</code></td>
<td>
<p>named list with at least the INFO dataframe</p>
</td></tr>
<tr><td><code id="setPA_+3A_pastart">paStart</code></td>
<td>
<p>A numeric value for the starting month of the Period of Analysis, default is 10</p>
</td></tr>
<tr><td><code id="setPA_+3A_palong">paLong</code></td>
<td>
<p>A numeric value for the length of the Period of Analysis in months, default is 12</p>
</td></tr>
<tr><td><code id="setPA_+3A_window">window</code></td>
<td>
<p>A numeric value for the half-width of a smoothing window for annual streamflow values, default is 20</p>
</td></tr>
</table>


<h3>Value</h3>

<p>eList named list with at least the INFO dataframe. 
Any of these values can be NA, but not all EGRET functions will work with missing parts of the named list eList.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
eList &lt;- setPA(eList, paStart = 12, paLong = 3)
</code></pre>

<hr>
<h2 id='setSeasonLabel'>Create a character variable that describes the period of analysis, when period of analysis has already been set in AnnualResults</h2><span id='topic+setSeasonLabel'></span>

<h3>Description</h3>

<p>The period of analysis can be of any length from 1 month to 12 months. 
The period of analysis can have any starting month from 1 (January) through 12 (December). 
This function produces a character character that describes this period of analysis. 
For example &quot;water year&quot;, &quot;calendar year&quot;, &quot;year starting with April&quot;, or 
&quot;Season consisting of April, May, June&quot;. 
There is an alternative version of this function for the case where AnnualResults does not exist. 
This might arise in a call from plotConcTime or plotLogConcTime. 
That function is called setSeasonLabelByUser.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setSeasonLabel(localAnnualResults, monthLab = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setSeasonLabel_+3A_localannualresults">localAnnualResults</code></td>
<td>
<p>data frame that contains the annual results, default is AnnualResults</p>
</td></tr>
<tr><td><code id="setSeasonLabel_+3A_monthlab">monthLab</code></td>
<td>
<p>object of monthLabel class, or numeric represented the short code, 
or character representing the descriptive name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>periodName character which describes the period of analysis
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Daily &lt;- getDaily(eList)
AnnualResults &lt;- setupYears(Daily)
setSeasonLabel(AnnualResults)

AnnualResultsWinter &lt;- setupYears(Daily, 
                                  paLong = 3,
                                  paStart = 12)
setSeasonLabel(AnnualResultsWinter)
</code></pre>

<hr>
<h2 id='setSeasonLabelByUser'>Creates a character variable that describes the period of analysis, when the period of analysis is being set by the user and not from AnnualResults</h2><span id='topic+setSeasonLabelByUser'></span>

<h3>Description</h3>

<p>The period of analysis can be of any length from 1 month to 12 months. 
The period of analysis can have any starting month from 1 (January) through 12 (December). 
This function produces a character that describes this period of analysis. 
For example &quot;water year&quot;, &quot;calendar year&quot;, &quot;year starting with April&quot;, or 
&quot;Season consisting of April, May, June&quot;. 
There is an alternative version of this function for the case where AnnualResults exists. 
And we want to use the period of analysis defined there. 
That function is called setSeasonLabel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setSeasonLabelByUser(paStartInput = 10, paLongInput = 12, monthLab = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setSeasonLabelByUser_+3A_pastartinput">paStartInput</code></td>
<td>
<p>numeric the month which is the start of the period of 
analysis, default is 10 which would be the case if the period of analysis is
the water year</p>
</td></tr>
<tr><td><code id="setSeasonLabelByUser_+3A_palonginput">paLongInput</code></td>
<td>
<p>numeric the length of the the period of analysis, 
in months, default is 12 which would be the case if the period of analysis 
is the water year</p>
</td></tr>
<tr><td><code id="setSeasonLabelByUser_+3A_monthlab">monthLab</code></td>
<td>
<p>object of monthLabel class, or numeric represented the short code, 
or character representing the descriptive name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>periodName character which describes the period of analysis
</p>


<h3>Examples</h3>

<pre><code class='language-R'>setSeasonLabelByUser(paStartInput=1,paLongInput=12)
setSeasonLabelByUser(paStartInput=4,paLongInput=3)
</code></pre>

<hr>
<h2 id='setUpEstimation'>setUpEstimation</h2><span id='topic+setUpEstimation'></span>

<h3>Description</h3>

<p>Set up the INFO data frame for a modelEstimation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setUpEstimation(eList, windowY = 7, windowQ = 2, windowS = 0.5,
  minNumObs = 100, minNumUncen = 50, edgeAdjust = TRUE, verbose = TRUE,
  interactive = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setUpEstimation_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="setUpEstimation_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p>
</td></tr>
<tr><td><code id="setUpEstimation_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td></tr>
<tr><td><code id="setUpEstimation_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td></tr>
<tr><td><code id="setUpEstimation_+3A_minnumobs">minNumObs</code></td>
<td>
<p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p>
</td></tr>
<tr><td><code id="setUpEstimation_+3A_minnumuncen">minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td></tr>
<tr><td><code id="setUpEstimation_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record.
The modified method tends to reduce curvature near the start and end of record.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="setUpEstimation_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
<tr><td><code id="setUpEstimation_+3A_interactive">interactive</code></td>
<td>
<p>logical deprecated. Use 'verbose' instead</p>
</td></tr>
</table>


<h3>Value</h3>

<p>eList named list with Daily, Sample, and INFO dataframes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
eList &lt;- setUpEstimation(eList)

</code></pre>

<hr>
<h2 id='setupYears'>Creates the AnnualResults data frame from the Daily data frame</h2><span id='topic+setupYears'></span>

<h3>Description</h3>

<p>This function aggregates the results stored on a daily basis in the Daily data frame
and stores the average values of these in the new data frame called AnnualResults.
Note that the flux values are rates (kg/day) and not a mass (kg).
The &quot;annual values&quot; can be a full 12 months, or they can be shorter. 
See manual to understand paLong and paStart arguments. 
The simplest case, a Water Year (October through September), would have
paLong=12, and paStart=10. 
A calendar year would be paLong=12 and paStart=1. 
A winter season of Dec, Jan, Feb would be paLong=3 and paStart=12
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setupYears(localDaily, paLong = 12, paStart = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setupYears_+3A_localdaily">localDaily</code></td>
<td>
<p>data frame containing the daily values, default is Daily</p>
</td></tr>
<tr><td><code id="setupYears_+3A_palong">paLong</code></td>
<td>
<p>numeric integer specifying the length of the period of analysis, in months, 1&lt;=paLong&lt;=12, default is 12</p>
</td></tr>
<tr><td><code id="setupYears_+3A_pastart">paStart</code></td>
<td>
<p>numeric integer specifying the starting month for the period of analysis, 1&lt;=paStart&lt;=12, default is 10</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame 'AnnualResults' of numeric values with the following columns
</p>

<table>
<tr>
 <td style="text-align: left;">
Name </td><td style="text-align: left;"> Description </td>
</tr>
<tr>
 <td style="text-align: left;">
DecYear </td><td style="text-align: left;"> Middle of the period in decimal years</td>
</tr>
<tr>
 <td style="text-align: left;">
Q </td><td style="text-align: left;"> Mean discharge, in m^3/s</td>
</tr>
<tr>
 <td style="text-align: left;">
Conc </td><td style="text-align: left;"> Estimated mean concentration, in mg/L</td>
</tr>
<tr>
 <td style="text-align: left;">
Flux </td><td style="text-align: left;"> Estimated mean flux, in kg/day</td>
</tr>
<tr>
 <td style="text-align: left;">
FNConc </td><td style="text-align: left;"> Flow-normalized concentration, in mg/L</td>
</tr>
<tr>
 <td style="text-align: left;">
FNFlux </td><td style="text-align: left;"> Flow-normalized flux, in kg/day</td>
</tr>
<tr>
 <td style="text-align: left;">
GenConc </td><td style="text-align: left;"> Generalized mean concentration, in mg/L. This column is only returned if the WRTDSKalman function was run, which gives the 
eList$Daily data frame a column "GenConc".</td>
</tr>
<tr>
 <td style="text-align: left;">
GenFlux </td><td style="text-align: left;"> Generalized mean flux, in kg/day. This column is only returned if the WRTDSKalman function was run, which gives the 
eList$Daily data frame a column "GenFlux".</td>
</tr>
<tr>
 <td style="text-align: left;">
PeriodLong </td><td style="text-align: left;"> Length of period of analysis (paLong), in months</td>
</tr>
<tr>
 <td style="text-align: left;">
PeriodStart </td><td style="text-align: left;"> Starting month of period of analysis (paStart), in months (1 = January)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Daily &lt;- getDaily(eList)
AnnualResults &lt;- setupYears(Daily, 4, 10)


</code></pre>

<hr>
<h2 id='startEnd'>startEnd</h2><span id='topic+startEnd'></span>

<h3>Description</h3>

<p>Returns two date variables representing the starting date and ending date for a combination of paStart, paLong, and year
</p>


<h3>Usage</h3>

<pre><code class='language-R'>startEnd(paStart, paLong, year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="startEnd_+3A_pastart">paStart</code></td>
<td>
<p>numeric integer specifying the starting month for the period of analysis, 1&lt;=paStart&lt;=12, default is 10</p>
</td></tr>
<tr><td><code id="startEnd_+3A_palong">paLong</code></td>
<td>
<p>numeric integer specifying the length of the period of analysis, in months, 1&lt;=paLong&lt;=12, default is 12</p>
</td></tr>
<tr><td><code id="startEnd_+3A_year">year</code></td>
<td>
<p>integer year, which is the calendar year in which the period ends</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Date list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>paStart &lt;- 10
paLong &lt;- 12
year &lt;- 1999
startEnd(paStart, paLong, year)
</code></pre>

<hr>
<h2 id='stitch'>stitch surfaces</h2><span id='topic+stitch'></span>

<h3>Description</h3>

<p>This function creates a continuous surfaces object that starts just before 
surfaceStart and ends just after surfaceEnd. It is made up from two surfaces 
objects created when there is a wall specified for the analysis.  The first 
surfaces object is based on data prior to the wall and the second surfaces object 
is based on data after the wall.  The wall is located just after sample1EndDate.
The Daily data frame is used only to set the minimum and maximum discharges used 
to construct the indices for discharges in the surfaces.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stitch(eList, sample1StartDate, sample1EndDate, sample2StartDate,
  sample2EndDate, surfaceStart = NA, surfaceEnd = NA, minNumObs = 100,
  minNumUncen = 50, fractMin = 0.75, windowY = 7, windowQ = 2,
  windowS = 0.5, edgeAdjust = TRUE, verbose = FALSE,
  run.parallel = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stitch_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily, Sample, and INFO dataframes</p>
</td></tr>
<tr><td><code id="stitch_+3A_sample1startdate">sample1StartDate</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) of the first sample to be used in estimating the first segment of the surfaces object.</p>
</td></tr>
<tr><td><code id="stitch_+3A_sample1enddate">sample1EndDate</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) of the last sample to be used in the first segment of the surfaces object.</p>
</td></tr>
<tr><td><code id="stitch_+3A_sample2startdate">sample2StartDate</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) of the first sample to be used in the second segment of the surfaces object.</p>
</td></tr>
<tr><td><code id="stitch_+3A_sample2enddate">sample2EndDate</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) of the last sample to be used in the second segment of the surfaces object.</p>
</td></tr>
<tr><td><code id="stitch_+3A_surfacestart">surfaceStart</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) that is the start of the WRTDS model to be estimated and the first of the 
daily outputs to be generated. Default is NA, which means that the surfaceStart is based on the date of the first sample.</p>
</td></tr>
<tr><td><code id="stitch_+3A_surfaceend">surfaceEnd</code></td>
<td>
<p>The Date (or character in YYYY-MM-DD) that is the end of the WRTDS model to be estimated and the last of the daily outputs 
to be generated.  Default is NA, which means that the surfaceEnd is based on the date of the last sample.</p>
</td></tr>
<tr><td><code id="stitch_+3A_minnumobs">minNumObs</code></td>
<td>
<p>numeric specifying the miniumum number of observations required to run the weighted regression, default is 100</p>
</td></tr>
<tr><td><code id="stitch_+3A_minnumuncen">minNumUncen</code></td>
<td>
<p>numeric specifying the minimum number of uncensored observations to run the weighted regression, default is 50</p>
</td></tr>
<tr><td><code id="stitch_+3A_fractmin">fractMin</code></td>
<td>
<p>numeric specifying the minimum fraction of the observations required to run the weighted regression, default is 0.75. The
minimum number will be the maximum of minNumObs and fractMin multiplied by total number of observations.</p>
</td></tr>
<tr><td><code id="stitch_+3A_windowy">windowY</code></td>
<td>
<p>numeric specifying the half-window width in the time dimension, in units of years, default is 7</p>
</td></tr>
<tr><td><code id="stitch_+3A_windowq">windowQ</code></td>
<td>
<p>numeric specifying the half-window width in the discharge dimension, units are natural log units, default is 2</p>
</td></tr>
<tr><td><code id="stitch_+3A_windows">windowS</code></td>
<td>
<p>numeric specifying the half-window with in the seasonal dimension, in units of years, default is 0.5</p>
</td></tr>
<tr><td><code id="stitch_+3A_edgeadjust">edgeAdjust</code></td>
<td>
<p>logical specifying whether to use the modified method for calculating the windows at the edge of the record.
The edgeAdjust method tends to reduce curvature near the start and end of record.  Default is TRUE.</p>
</td></tr>
<tr><td><code id="stitch_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
<tr><td><code id="stitch_+3A_run.parallel">run.parallel</code></td>
<td>
<p>logical to run bootstrapping in parallel or not</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList

surfaceStart &lt;- "1986-10-01"
surfaceEnd &lt;- "2010-09-30"

# Surface skips a few years:
sample1StartDate &lt;- "1986-10-01"
sample1EndDate &lt;- "1992-09-30"
sample2StartDate &lt;- "1996-10-01"
sample2EndDate &lt;- "2011-09-30"


surface_skip &lt;- stitch(eList, 
                         sample1StartDate, sample1EndDate, 
                         sample2StartDate, sample2EndDate,
                         surfaceStart, surfaceEnd)

# Surface overlaps a few years:
sample1StartDate &lt;- "1986-10-01"
sample1EndDate &lt;- "1996-09-30"
sample2StartDate &lt;- "1992-10-01"
sample2EndDate &lt;- "2011-09-30"

surface_overlap &lt;- stitch(eList, 
                         sample1StartDate, sample1EndDate, 
                         sample2StartDate, sample2EndDate)

</code></pre>

<hr>
<h2 id='surfaceIndex'>Compute the 6 parameters needed to lay out the grid for the surfaces computed in estSurfaces</h2><span id='topic+surfaceIndex'></span>

<h3>Description</h3>

<p>The code here is a repetition of the first part of the code for estSurfaces
</p>


<h3>Usage</h3>

<pre><code class='language-R'>surfaceIndex(Daily)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="surfaceIndex_+3A_daily">Daily</code></td>
<td>
<p>data frame containing the daily values, default is Daily</p>
</td></tr>
</table>


<h3>Value</h3>

<p>surfaceIndexParameters a numeric vector of length 6, defining the grid for the surfaces
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Daily &lt;- getDaily(eList)
surfaceIndex(Daily)
</code></pre>

<hr>
<h2 id='surfaceStartEnd'>Surface date limits</h2><span id='topic+surfaceStartEnd'></span>

<h3>Description</h3>

<p>Sets the Date limits to the surfaces being estimated from the Sample data set.  The start is less 
than a year prior to the first date (typically the date of the first sample) and the end is 
less than a year after the last date (typically the date of the last sample).  The start is 
constrained to be on the first day of the period of analysis and the end is constrained to 
be on the last day of the the period of analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>surfaceStartEnd(paStart, paLong, Date1, Date2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="surfaceStartEnd_+3A_pastart">paStart</code></td>
<td>
<p>numeric integer specifying the starting month for the period of analysis, 1&lt;=paStart&lt;=12, default is 10</p>
</td></tr>
<tr><td><code id="surfaceStartEnd_+3A_palong">paLong</code></td>
<td>
<p>numeric integer specifying the length of the period of analysis, in months, 1&lt;=paLong&lt;=12, default is 12</p>
</td></tr>
<tr><td><code id="surfaceStartEnd_+3A_date1">Date1</code></td>
<td>
<p>Date set to Date of earliest data in Sample.</p>
</td></tr>
<tr><td><code id="surfaceStartEnd_+3A_date2">Date2</code></td>
<td>
<p>Date set to Date of latest data in Sample.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
Date1 &lt;- eList$Sample$Date[1]
Date2 &lt;- range(eList$Sample$Date)[2]
surfaceStartEnd(10, 12, Date1, Date2)
</code></pre>

<hr>
<h2 id='tableChange'>Create a table of the changes in flow-normalized values between various points in time in the record</h2><span id='topic+tableChange'></span><span id='topic+tableChangeSingle'></span>

<h3>Description</h3>

<p>These tables describe trends in flow-normalized concentration and in flow-normalized flux. 
They are described as changes in real units or in percent and as slopes in real units per year or in percent per year.
They are computed over pairs of time points.  These time points can be user-defined or
they can be set by the program to be the final year of the record and a set of years that are multiples of 5 years prior to that.
tableChangeSingle is a version of the same code that will produce output only for flow-normalized concentration or flow-normalized flux, but not both
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableChange(eList, fluxUnit = 9, yearPoints = NA)

tableChangeSingle(eList, fluxUnit = 9, yearPoints = NA, flux = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tableChange_+3A_elist">eList</code></td>
<td>
<p>named list with at least the Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="tableChange_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>object of fluxUnit class. <code><a href="#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="tableChange_+3A_yearpoints">yearPoints</code></td>
<td>
<p>numeric vector listing the years for which the change or slope computations are made, they need to be in chronological order.  For example yearPoints=c(1975,1985,1995,2005), default is NA (which allows the program to set yearPoints automatically)</p>
</td></tr>
<tr><td><code id="tableChange_+3A_flux">flux</code></td>
<td>
<p>logical if TRUE results are returned in flux, if FALSE concentration. Default is set to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe with Year1, Year2, change[mg/L], slope[mg/L], change[percent], slope[percent] columns. The data in each row is the change or slope calculated from Year1 to Year2
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water Year:

tableChange(eList, fluxUnit = 8, yearPoints = c(1980, 1995, 2011))
tableChange(eList, fluxUnit = 5) 
# Winter:
eList &lt;- setPA(eList, paStart = 12, paLong = 3)
tableChange(eList, fluxUnit = 8, yearPoints = c(1980, 1995, 2011))

# Water Year:
eList &lt;- setPA(eList, paStart = 10, paLong = 12)
#This returns concentration ASCII table in the console:
tableChangeSingle(eList, fluxUnit = 8, yearPoints = c(1980, 1995, 2011), flux = FALSE)
#Returns a data frame:
change &lt;- tableChangeSingle(eList, fluxUnit = 8, yearPoints=c(1980, 1995, 2011), flux = FALSE) 
#This returns flux values as a data frame:
df &lt;- tableChangeSingle(eList, fluxUnit = 8, yearPoints=c(1980, 1995, 2011), flux = TRUE)  
# Winter Concentration only:
eList &lt;- setPA(eList, paStart = 12, paLong = 3)
df.winter &lt;- tableChangeSingle(eList, fluxUnit = 8, yearPoints=c(1980, 1995, 2011), flux = FALSE)


</code></pre>

<hr>
<h2 id='tableFlowChange'>Prints table of change metrics for a given streamflow statistic</h2><span id='topic+tableFlowChange'></span>

<h3>Description</h3>

<p>Part of the flowHistory system.
Provides a measure of change (in real units and as percent per year)
based on the smoothed values for various streamflow statistics.
Smoothing algorithm is the same as is used in <code><a href="#topic+plotFlowSingle">plotFlowSingle</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableFlowChange(eList, istat, qUnit = 1, runoff = FALSE, yearPoints = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tableFlowChange_+3A_elist">eList</code></td>
<td>
<p>named list with at least Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="tableFlowChange_+3A_istat">istat</code></td>
<td>
<p>A numeric value for the flow statistic to be graphed (possible values are 1 through 8)</p>
</td></tr>
<tr><td><code id="tableFlowChange_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="tableFlowChange_+3A_runoff">runoff</code></td>
<td>
<p>logical variable, if TRUE the streamflow data are converted to runoff values in mm/day</p>
</td></tr>
<tr><td><code id="tableFlowChange_+3A_yearpoints">yearPoints</code></td>
<td>
<p>A vector of numeric values, specifying the years at which change metrics are to be calculated, default is NA (which allows the function to set these automatically), yearPoints must be in ascending order</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The index of the flow statistics is istat.  These statistics are: 
(1) 1-day minimum, (2) 7-day minimum, (3) 30-day minimum, (4) median
(5) mean, (6) 30-day maximum, (7) 7-day maximum, and (8) 1-day maximum.
</p>
<p>Can also run the statistics on any Period of Analysis (individual months or sequence of months) using <code><a href="#topic+setPA">setPA</a></code>.
</p>
<p>A dataframe is returned, as well as a printout in the R console.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
tableFlowChange(eList, istat = 5, yearPoints = c(1981, 1995, 2010))
eList &lt;- setPA(eList, paStart = 4, paLong = 12)
tableFlowChange(eList, istat = 2, qUnit = 2, yearPoints = c(1981, 1995, 2010))
eList &lt;- setPA(eList, paStart = 9, paLong = 1)
df &lt;- tableFlowChange(eList, istat = 5, qUnit = 2, yearPoints = c(1981, 1995, 2010))
df 
</code></pre>

<hr>
<h2 id='tableResults'>Table of annual results for discharge, concentration and flux</h2><span id='topic+tableResults'></span>

<h3>Description</h3>

<p>Produce an ASCII table showing: year, mean discharge, mean concentration, flow-normalized concentration, 
mean flux, and flow-normalized flux. Note that the flux and flow-normalized flux are rates and not a mass.  As such a value for some period shorter than a full year 
could be larger than the value for a full year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableResults(eList, qUnit = 2, fluxUnit = 9, localDaily = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tableResults_+3A_elist">eList</code></td>
<td>
<p>named list with at least Daily and INFO dataframes</p>
</td></tr>
<tr><td><code id="tableResults_+3A_qunit">qUnit</code></td>
<td>
<p>object of qUnit class. <code><a href="#topic+printqUnitCheatSheet">printqUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="tableResults_+3A_fluxunit">fluxUnit</code></td>
<td>
<p>object of fluxUnit class. <code><a href="#topic+printFluxUnitCheatSheet">printFluxUnitCheatSheet</a></code>, or numeric represented the short code, or character representing the descriptive name.</p>
</td></tr>
<tr><td><code id="tableResults_+3A_localdaily">localDaily</code></td>
<td>
<p>data frame to override eList$Daily</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Can also procude a table for any Period of Analysis (individual months or sequence of months) using <code><a href="#topic+setPA">setPA</a></code>.
</p>


<h3>Value</h3>

<p>results dataframe, if returnDataFrame=TRUE
</p>
<p>dataframe with year, discharge, concentration,
flow-normalized concentration, flux, and flow-normalized concentration columns. 
If the eList was run through WRTDSKalman, an additional column generalized flux
is included.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
# Water Year:

tableResults(eList, fluxUnit = 8)
df &lt;- tableResults(eList, fluxUnit = 1)
df
# Spring:
eList &lt;- setPA(eList, paStart = 3, paLong = 3)
tableResults(eList, fluxUnit = 1, qUnit = "cfs")

</code></pre>

<hr>
<h2 id='triCube'>Tricube weight function</h2><span id='topic+triCube'></span>

<h3>Description</h3>

<p>Computes the tricube weight function on a vector of distance values (d),
based on a half-window width of h,
and returns a vector of weights that range from zero to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>triCube(d, h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triCube_+3A_d">d</code></td>
<td>
<p>numeric vector of distances from the point of estimation to the given sample value</p>
</td></tr>
<tr><td><code id="triCube_+3A_h">h</code></td>
<td>
<p>numeric value, the half-window width, measured in the same units as d</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Cleveland, W. S. (1979). Robust locally weighted regression and smoothing scatterplots, JASA,  74, 829-836
</p>


<h3>Value</h3>

<p>w numeric vector of weights, all 0&lt;=w&lt;=1
</p>


<h3>Examples</h3>

<pre><code class='language-R'> h&lt;-10
 d&lt;-c(-11,-10,-5,-1,-0.01,0,5,9.9,10,20)
 triCube(d,h)
</code></pre>

<hr>
<h2 id='WRTDSKalman'>WRTDS-Kalman</h2><span id='topic+WRTDSKalman'></span>

<h3>Description</h3>

<p>This function uses an autoregressive model to produce more accurate 
estimates of concentration and flux
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WRTDSKalman(eList, rho = 0.9, niter = 200, seed = NA, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WRTDSKalman_+3A_elist">eList</code></td>
<td>
<p>named list with the INFO, Daily, and Sample dataframes and surfaces matrix</p>
</td></tr>
<tr><td><code id="WRTDSKalman_+3A_rho">rho</code></td>
<td>
<p>numeric the lag one autocorrelation. Default is 0.9.</p>
</td></tr>
<tr><td><code id="WRTDSKalman_+3A_niter">niter</code></td>
<td>
<p>number of iterations. Default is 200.</p>
</td></tr>
<tr><td><code id="WRTDSKalman_+3A_seed">seed</code></td>
<td>
<p>integer value. Defaults to NA, which will not change the current seed.
Setting the seed to any given value can be used to create repeatable output.</p>
</td></tr>
<tr><td><code id="WRTDSKalman_+3A_verbose">verbose</code></td>
<td>
<p>logical specifying whether or not to display progress message</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes an existing eList 
Including the estimated model (the surfaces object in the eList)
And produces the daily WRTDSKalman estimates of concentration and flux
These generated estimates are called genConc and genFlux
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eList &lt;- Choptank_eList
eList &lt;- WRTDSKalman(eList, niter = 10)
summary(eList$Daily)

#All flux values in AnnualResults are expressed as a rate in kg/day
AnnualResults &lt;- setupYears(eList$Daily)
head(AnnualResults)
</code></pre>

<hr>
<h2 id='yPretty'>Sets up tick marks for an axis for a graph with an arithmetic scale which starts at zero</h2><span id='topic+yPretty'></span>

<h3>Description</h3>

<p>Axis tick marks that run from zero to some specified maximum, creates about 4 to 8 ticks marks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yPretty(yMax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yPretty_+3A_ymax">yMax</code></td>
<td>
<p>A numeric value for the maximum value to be plotted, it must be &gt;0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>yTicks A numeric vector representing the values for each of the tick marks
</p>


<h3>Examples</h3>

<pre><code class='language-R'>yTicks &lt;- yPretty(7.8)
yTicks &lt;- yPretty(125)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
